# StackOverflow 问答 15317000-15317999

# java - 使用 Eclipse 设置码头 8 以使用 servlet

> ID：15317000
> 
> 赞同：1
> 
> 时间：2013-03-09T23:11:17.740
> 
> 标签：java, servlets, jetty

我正在尝试使用 Jetty 与 Eclipse 一起做超级简单的“Hello World”Servlet。

我有一个正在工作的 Jetty 服务器适配器，但是当我尝试在我的服务器上启动时，出现以下错误；

小服务程序代码：

```
package My;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class My_Servlet
 */
@WebServlet("/My_Servlet")
public class My_Servlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * Default constructor. 
     */
    public My_Servlet() {
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, 
                HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, 
                HttpServletResponse response)
        throws ServletException, IOException {
        response.getWriter().println("<html><body><h1>My Servlet</h1></body></html>");
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, 
                HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, 
                HttpServletResponse response)
        throws ServletException, IOException {
        // TODO Auto-generated method stub
    }
} 
```

我得到的错误：

```
Error 404 - Not Found.
No context on this server matched or handled this request.
Contexts known to this server are:

    /My_WS ---> o.e.j.w.WebAppContext{/My_WS,file:/home/user/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/My_WS/},/home/user/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/My_WS [failed] 
```

那就是我在 localhost:8080 上看到的。

提前感谢您的帮助，盖伊

**编辑**

我注意到我想念 classVisitor（Spring 框架的一部分），并且为了支持我的简单程序变得很麻烦。我可能会切换到 tomcat 或只使用嵌入式码头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:36:41.673

对于它的价值，我使用 Jetty 和 NetBeans，我不使用 NetBeans 来运行码头服务器。相反，我使用`mvn jetty:run`.

我认为您的问题是您没有指定 servlet 来处理**web.xml**文件中的请求。Java 代码大多是无关紧要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:00:48.577

您的 webapp 在上下文中`http://localhost:8080/My_WS/`

您的 Servlet 位于`http://localhost:8080/My_WS/My_Servlet`

您看到的错误来自您的点击`http://localhost:8080/`，它没有设置为对您的简单场景执行任何操作。

# c++ - 返回指向私有成员的指针的公共方法的单元测试

> ID：15317006
> 
> 赞同：1
> 
> 时间：2013-03-09T23:12:11.203
> 
> 标签：c++, unit-testing

我有这样的代码：

```
class Foo
{
private :

    int m_nValue;

public :

    explicit Foo(const int nValue) : 
        m_nValue(nValue)
    {
    }

    const int* Pointer() const
    {
        return &m_nValue;
    }
};

void Test()
{
    Foo obj(3);

    // I want to do something like this.
    //Assert::AreEqual(&obj.m_nValue, obj.Pointer());
} 
```

我想测试`Pointer()`返回私有字段地址的方法`m_nValue`。有人可以为这种情况提供一些很好的解决方案。我可以让测试类/函数成为朋友，但我真的不喜欢它。

也许这不是应该测试的方法。但据我所知，所有公共方法都应该经过测试。

测试是用 C++ 编写的，用于 MSVS 2012 中的 C++ 代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:31:51.187

您不应该只测试类的内部结构，而只是测试其可观察到的行为。测试应该是

```
Asser::AreEqual( *obj.Pointer(), 3 ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:20:12.243

我总是建议不要测试琐碎的行为。我会将其归类为微不足道的。在 Java 世界中，这类似于（不完全但接近）测试来自 Clean Code 的 Martin 反对的吸气剂。

您可以做的最好的事情是测试指针不为空，并且它的取消引用值是您所期望的。

# php - PHP + MySql 与日期图表

> ID：15317008
> 
> 赞同：-4
> 
> 时间：2013-03-09T23:12:15.753
> 
> 标签：php, javascript, jquery, mysql

我试图从 MySql 获取值到 javascript 图表。

![价值观](../Images/b360097de1eeb48b0e06f728e10b9f6a.png)

值在 javascript 中是这样的：

0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

每个 0 表示从上午 12 点到晚上 11 点按自己小时计算的值，在这种情况下，图表将为空。

问题是，如何按当前日期从 MySql 中获取所有值到自己的时间？

在示例图片中，值应如下所示：

2.7,0,0,2.2,0,0.......

在第一个值 (2.7) 中，图片中的两个值一起计算为它在同一日期的同一小时内相加。

那么，如何获取所有值，将当天的每个小时一起计算并将它们分隔为与上面显示的相同的形式？

我不知道该怎么做。我以前没有处理过这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:17:54.333

Use the MySQL DATE_FORMAT() function to extract just the date and hour and GROUP BY the resulting string, with a SUM(value).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:20:50.853

这将为您提供按小时和日期相加的值。不过，它不会包含任何缺失小时数的值。

```
SELECT DATE(date), HOUR(date), SUM(value)
FROM table1
GROUP BY DATE(date), HOUR(date) 
```

# javascript - Ember.TextField 绑定在 Ember RC1 中更改了吗？

> ID：15317011
> 
> 赞同：1
> 
> 时间：2013-03-09T23:12:55.417
> 
> 标签：javascript, ember.js

我正在尝试构建一个最初显示文本的视图。如果用户双击，它将用输入字段替换该文本。这样用户可以轻松地更新文本（例如使用“contenteditable”属性）。

我有一种适用于 Ember pre4 的方法，但不适用于 Ember RC1。在 RC1 中，Ember.TextField 不会初始化为父视图的 value 属性。当您双击标签文本时，它会创建一个空输入字段。这里有两个小提琴：

1.  Pre4（工作）：http: [//jsfiddle.net/mattsonic/cq5yy/5](http://jsfiddle.net/mattsonic/cq5yy/5)
2.  RC1（相同的代码 - 不工作）：http: [//jsfiddle.net/mattsonic/UUac9/15](http://jsfiddle.net/mattsonic/UUac9/15)

知道 Ember 内部发生了什么变化吗？谢谢。

这是代码：

```
App.InputView = Ember.TextField.extend({
classNames: ["input-small"],
valueBinding: "parentView.value",
didInsertElement: function () {
    this.$().focus()
},
focusOut: function () {
    parent = this.get("parentView");
    parent.setLabelView();
}
});

App.LabelView = Ember.View.extend({
tagName: "span",
template: Ember.Handlebars.compile("{{view.value}}"),
valueBinding: "parentView.value",
doubleClick: function () {
    parent = this.get("parentView");
    parent.setInputView();
}
});

App.LabelEditView = Ember.ContainerView.extend({
tagName: "span",
labelView: App.LabelView.extend(),
inputView: App.InputView.extend(),
didInsertElement: function () {
    this.setLabelView();
},
setInputView: function () {
    this.set("currentView", this.get("inputView").create());
},
setLabelView: function () {
    this.set("currentView", this.get("labelView").create());
}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T18:40:55.937

我找到了一个我根本不喜欢的解决方案。但是，它解决了所描述的问题。

```
focusIn: function() {
    var val = this.get("parentView.value");
    this.set("value", "");
    this.set("value", val);
}, 
```

如果在 focusIn 事件期间将输入字段的值设置为正确的值，它仍然会失败。但是，如果您将输入字段的值设置为不同的值，然后将其切换回来，则输入字段将显示正确的值。

我很想知道解决这个问题的更好方法。Ember pre4 解决方案比这更优雅。

工作小提琴：http: [//jsfiddle.net/mattsonic/UUac9/19/](http://jsfiddle.net/mattsonic/UUac9/19/)

# ruby-on-rails - 为 rails4 安装设备时出错

> ID：15317017
> 
> 赞同：1
> 
> 时间：2013-03-09T23:13:56.987
> 
> 标签：ruby-on-rails, devise, ruby-on-rails-4

我正在尝试将现有应用程序迁移到 ruby​​ 2.0 + rails 4.0 并且到目前为止一切正常，除了当我尝试安装设计时：

```
rails generate devise:install 
```

我收到以下错误：

```
Exiting
    /home/lemur/rails_projects/delicateca/config/initializers/devise.rb:76:in `block in <top (required)>': undefined method `skip_session_storage=' for Devise:Module (NoMethodError)
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/devise-1.5.4/lib/devise.rb:252:in `setup'
        from /home/lemur/rails_projects/delicateca/config/initializers/devise.rb:3:in `<top (required)>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:222:in `load'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:222:in `block in load'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:213:in `load_dependency'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:222:in `load'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/engine.rb:608:in `block (2 levels) in <class:Engine>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/engine.rb:607:in `each'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/engine.rb:607:in `block in <class:Engine>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/initializable.rb:30:in `instance_exec'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/initializable.rb:30:in `run'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/initializable.rb:55:in `block in run_initializers'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:150:in `block in tsort_each'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:183:in `block (2 levels) in each_strongly_connected_component'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:210:in `block (2 levels) in each_strongly_connected_component_from'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:219:in `each_strongly_connected_component_from'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:209:in `block in each_strongly_connected_component_from'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/initializable.rb:44:in `each'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/initializable.rb:44:in `tsort_each_child'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:203:in `each_strongly_connected_component_from'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:182:in `block in each_strongly_connected_component'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:186:in `each'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:186:in `each_strongly_connected_component'
        from /home/lemur/.rvm/rubies/ruby-2.0.0-preview1/lib/ruby/2.0.0/tsort.rb:154:in `tsort_each'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/initializable.rb:54:in `run_initializers'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/application.rb:213:in `initialize!'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/railtie/configurable.rb:30:in `method_missing'
        from /home/lemur/rails_projects/delicateca/config/environment.rb:5:in `<top (required)>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:228:in `require'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:228:in `block in require'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:213:in `load_dependency'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/activesupport-4.0.0.beta1/lib/active_support/dependencies.rb:228:in `require'
        from /home/lemur/rails_projects/delicateca/config.ru:3:in `block in <main>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/builder.rb:55:in `instance_eval'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/builder.rb:55:in `initialize'
        from /home/lemur/rails_projects/delicateca/config.ru:in `new'
        from /home/lemur/rails_projects/delicateca/config.ru:in `<main>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/builder.rb:49:in `eval'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/builder.rb:49:in `new_from_string'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/builder.rb:40:in `parse_file'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/server.rb:277:in `build_app_and_options_from_config'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/server.rb:199:in `app'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/commands/server.rb:46:in `app'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/rack-1.5.2/lib/rack/server.rb:314:in `wrapped_app'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/commands/server.rb:71:in `start'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/commands.rb:78:in `block in <top (required)>'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/commands.rb:73:in `tap'
        from /home/lemur/.rvm/gems/ruby-2.0.0-preview1/gems/railties-4.0.0.beta1/lib/rails/commands.rb:73:in `<top (required)>'
        from script/rails:6:in `require' 
```

当我尝试运行应用程序时，我得到了同样的错误，只是执行 bundle install 然后 rails s。

任何的想法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T16:16:32.807

[更新]

rails4 分支现已合并到 master 中。所以这应该是你现在所需要的：

`gem 'devise', github: 'plataformatec/devise'`

我在下面留下了我的旧答案。

=================================================

今天最简单的解决方法是在您的 gemfile 中使用以下内容：

```
gem 'devise', github: 'plataformatec/devise', branch: 'rails4' 
```

More details can be found on the [comment](https://github.com/plataformatec/devise/pull/2172#issuecomment-13902420) of this pull request for Devise.

At the time of [Lemurido's](https://stackoverflow.com/users/476374/lemurido) response, his was the best solution to your error.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:29:16.270

正如 Aaron Paterson 所解释的，这似乎是一个依赖问题：

[http://tenderlovemaking.com/2012/12/18/rails-4-and-your-gemfile.html](http://tenderlovemaking.com/2012/12/18/rails-4-and-your-gemfile.html)

解决方案（在评论中）正在更新您的 gemfile：

宝石“设计”，github：“idl3/devise”，分支：“rails4”

# javascript - CSS3 翻译出屏幕

> ID：15317020
> 
> 赞同：19
> 
> 时间：2013-03-09T23:14:24.993
> 
> 标签：javascript, html, css

对于现在的一些项目，我在页面上有一些元素，我想将它们翻译到屏幕区域之外（让它们飞出文档）。在正确的代码中，这应该可以通过向相关元素添加一个类来实现，之后css将处理其余部分。问题在于，例如，如果

```
.block.hide{
    -webkit-transform:translateY(-10000px);
} 
```

使用该元素首先会以不必要的高速飞出屏幕不必要的距离。纯粹从美学的角度来看，还有很多不足之处（从理论上讲，例如将来有一天会引入高度为 10000 像素的屏幕）。

（更新）不能使用百分比的问题是 100% 与元素本身有关，而不是与父元素/屏幕大小有关。并且将元素包含在全尺寸的父级中是可能的，但会造成点击事件的混乱。在几个答案之后，请允许我指出我在谈论翻译，而不是`position:absolute`css3 转换（这一切都很好，但是一旦你得到足够的它们，它们就不再有趣了）。

你们能想到哪些美观的解决方案可以让元素在固定的时间内从屏幕中翻译出来？

示例代码可以在这个 jsfiddle 中找到，演示基本概念。 [http://jsfiddle.net/ATcpw/](http://jsfiddle.net/ATcpw/)

*（有关更多信息，请参阅下面我自己的答案）*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T19:35:14.617

如果你用容器包装 .block div：

```
<div class="container">
   <div class="block"></div>
</div>
<button>Click</button> 
```

您可以展开，然后在单击事件**后翻译容器本身**

```
document.querySelector("button").addEventListener("click", function () {
   document.querySelector(".container").classList.add("hide");
}); 
```

用这种风格

```
.block {
    position:absolute;
    bottom:10px;
    right:10px;
    left:10px;
    height:100px;
    background:gray;
}

.container {
    -webkit-transition: -webkit-transform ease-in-out 1s;
    -webkit-transform-origin: top;
    -webkit-transition-delay: 0.1s; /* Needed to calculate the vertical area to shift with translateY */
}

.container.hide {
    position:absolute;
    top:0;
    left:0;
    bottom:0;
    right:0;
    /* background:#f00; /* Uncomment to see the affected area */ 
    -webkit-transform: translateY(-110%);
} 
```

通过这种方式，可以应用正确的翻译百分比（略高于 100%，只是为了让它不碍事）并保持按钮可点击。

您可以在这里看到一个工作示例：http: [//jsfiddle.net/MG7bK/](http://jsfiddle.net/MG7bK/)

PS：我注意到只有transitionY属性需要过渡延迟，否则动画会失败，可能是因为它试图在获得实际高度值之前开始。如果你使用水平消失，它可以被省略，与 translateX。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-28T04:48:52.543

我所做的是使用`vh`（视图高度）单位。它总是相对于屏幕大小，而不是元素本身：

```
/* moves the element one screen height down */
translateY(calc(100vh)) 
```

因此，如果您知道元素在屏幕中的位置（例如`top:320px`），则可以将其完全移出屏幕：

```
/* moves the element down exactly off the bottom of the screen */
translateY(calc(100vh - 320px)) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-12T17:41:27.157

我知道这不是您要问的，但是...

[你会考虑在Greensock 的动画平台上](http://www.greensock.com/css3/)使用 CSS 动画吗？它非常快（它声称它比 jQuery 快 20 倍），您可以在此处查看速度测试：http: [//www.greensock.com/js/speed.html](http://www.greensock.com/js/speed.html)

我相信它会让你的代码更好，而不是试图破解 CSS 动画，你可以专注于更重要的东西。

我在这里创建了一个 JSFiddle：http: [//jsfiddle.net/ATcpw/4/](http://jsfiddle.net/ATcpw/4/)

CSS 和可能的 JS 看起来都更简单：

```
document.querySelector("button").addEventListener("click",function(){
    var toAnimate = document.querySelector(".block");
    TweenMax.to(toAnimate, 2, {y: -window.innerHeight});
}); 
```

CSS：

```
.block{
    position:absolute;
    bottom:10px;
    right:10px;
    left:10px;
    height:100px;
    background-image: url(http://lorempixel.com/800/100);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-12T14:46:57.180

我最近构建了一个应用程序，该应用程序正是使用这种技术来滑动“面板”（或页面）和应用程序的选项卡进出视图。[可以在此处看到选项卡机制的基本实现](http://jsfiddle.net/barney/EJ7ve/)。

基本上（用于说明概念的伪代码，减去前缀等）：

```
.page {
    transform: translateY(100%);
}

.page.active {
    transform: translateY(0%);
} 
```

[我遇到的问题是 Android Webkit 特别不能正确计算百分比值](https://stackoverflow.com/questions/13156805/force-correct-css3-transform-percentage-interpretation-on-android)。最后我不得不使用脚本来获取视口宽度并以像素为单位指定值，然后[使用动态样式表解析库编写规则](https://github.com/Box9/jss)。

但最终，尽管只有这些特定于平台的小问题，这对我来说非常有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-12T14:32:35.133

使用`calc`方法（[http://jsfiddle.net/ATcpw/2/](http://jsfiddle.net/ATcpw/2/)）：

```
.block{
    position:absolute;
    top: -webkit-calc(100% - 110px);
    right:10px;
    left:10px;
    height:100px;
    background:gray;
    -webkit-transition: all 2s;
    /*this adds GPU acceleration*/
    transform: translate3d(0,0,0); 
    -webkit-transform: translate3d(0,0,0);
}
.block.hide{
    top: -100px;
} 
```

由于您使用的是`-webkit`前缀，因此我也使用了它。 `calc`大多数浏览器都支持：http: [//caniuse.com/#search=calc](http://caniuse.com/#search=calc)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-09T23:14:24.993

一个非常简单但不美观的解决方案是动态定义类：

```
var stylesheet = document.styleSheets[0];
var ruleBlockHide; 
```

和

```
//onresize
if(ruleBlockHide) stylesheet.deleteRule(ruleBlockHide);
ruleBlockHide = stylesheet.insertRule('.block.hide{ -webkit-transform:translateY(-'+window.innerHeight+'px); }',stylesheet.cssRules.length); 
```

见：http: [//jsfiddle.net/PDU7T/](http://jsfiddle.net/PDU7T/)

需要保留对规则的引用的原因是，在每次调整屏幕大小后，必须删除并重新添加规则。

虽然这个解决方案完成了工作，但必须有一些 DOM/CSS 组合允许在没有 javascript 的情况下完成此操作（类似于包含此类块的 100%x100% 元素，但我无法找出任何基于变换的方式）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-13T20:23:21.583

获取文档宽度。然后使用 java 脚本触发器来触发 css3 翻译。

```
 function translate(){

       var width = document.body.Width;
        document.getElementById('whateverdiv').style='translateX(' + width + 'px)';

       } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-03-15T17:49:21.347

这很简单，将以下内容添加到您的 div

```
.myDiv {
    -webkit-transition-property: left;
    -webkit-transition-duration: 0.5s;
    -webkit-transition-timing-function: ease-in-out;
    -webkit-transition-delay: initial
} 
```

然后通过添加一个额外的类或通过 jQuery 来改变它的“left”属性

这将沿 x 轴对其进行动画处理

**注意：**您可以将 -webkit-transition-property 更改为您想要的任何属性，这将为它设置动画

# iphone - 纹理中的粒子系统未加载

> ID：15317025
> 
> 赞同：0
> 
> 时间：2013-03-09T23:14:38.450
> 
> 标签：iphone, ios, objective-c, cocos2d-iphone, particle-system

我正在尝试使用粒子系统为纹理加载粒子。由于这只是一个练习，我可以“手动”生成纹理。所以在这种情况下，我只是分配一个数据缓冲区并用红色（RGBA 32 位格式）填充它。

但问题是当程序开始运行时，我只看到黑屏并且没有我期望看到的（一些红色颗粒在移动）。

我在评论中解释了我想要做的事情：

```
if( (self=[super init]))
{
    NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];

    uint32_t mask= 255+pow(255, 4); // This is a 32 bit red pixel
    NSUInteger size=256; // The texture is 256x256
    void* buffer= malloc(size*size*4); // Here I hold the data, it will be all red
    for(NSUInteger i=0; i<size; i++)
    {
        for(NSUInteger j=0; j<size; j++)
        {
            memcpy(buffer+j+i*32, &mask, 4);
        }
    }
    NSData* data=[[[NSData alloc]initWithBytesNoCopy: buffer length: size*size*4 freeWhenDone: YES]autorelease];  // I wrap it into NSData to automatically release it later. 
    CCTexture2D* texture=[[[CCTexture2D alloc]initWithData: data.bytes pixelFormat: kCCTexture2DPixelFormat_RGBA8888 pixelsWide: size pixelsHigh: size contentSize: CGSizeMake(size, size)]autorelease];
    CCParticleSystemQuad* system=[[[CCParticleSystemQuad alloc]initWithTotalParticles: 100]autorelease];
    system.texture= texture;  // I set the texture in a way that it should be load to draw particles
    system.position= ccp(200, 200);
    system.startSize= 10;
    system.endSize= 5;
    system.duration= kCCParticleDurationInfinity;
    system.life= 1;
    [self addChild: system]; 

    [pool drain];
} 
```

**使用图像**

我尝试以使用 UIImage 而不是手动创建的纹理的方式修改代码：

```
if( (self=[super init]))
{
    // Even with glClearColor() it doesn't work
    //glClearColor(1, 0, 1, 1);
    NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];

    NSBundle* bundle=[NSBundle mainBundle];
    NSString* path=[bundle pathForResource: @"fire" ofType: @"png"];
    UIImage* image=[UIImage imageWithContentsOfFile: path];
    CCTexture2D* texture=[[[CCTexture2D alloc]initWithImage: image]autorelease];
    CCParticleSystemQuad* system=[[[CCParticleSystemQuad alloc]initWithTotalParticles: 100]autorelease];
    system.texture= texture;
    system.startSize= 10;
    system.endSize= 10;
    system.life= 1;
    system.duration= kCCParticleDurationInfinity;
    system.position= ccp(200, 200);
    // Even changing the start/end color it doesn't work
    //system.startColor= (ccColor4F){1.0,0.0,0.0,1.0};
    //system.endColor= (ccColor4F){1.0,0.0,0.0,1.0};
    system.emitterMode= kCCParticleModeGravity;
    system.gravity= ccp(200, 200);
    system.speed=1;
    [self addChild: system];

    [pool drain];
} 
```

应用程序包中的图像“fire.png”是：

![在此处输入图像描述](../Images/d03e4601560d5b5ec70eb287ab95f29d.png)

我还设置了一些其他属性，但它仍然不起作用：黑屏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T23:58:07.047

我想到了几件事（除了代码改进，请参阅我的评论）：

更改清除颜色，只是为了查看粒子系统是否可能正在运行但只生成黑色粒子：

```
glClearColor(1, 0, 1, 1); 
```

粒子系统本身可能没有正确配置（不完整的数据，使用通常只有 0 的默认值的属性）。您未修改的属性可能会导致粒子系统渲染不正确。例如，粒子系统具有 startColor 和 endColor 属性。如果它们都被初始化为黑色或透明颜色，因为您没有将它们设置为更亮（白色）的颜色，那么无论您的纹理具有什么颜色，粒子都是黑色的。我相信这很可能是这里发生的事情。

首先尝试使用图像文件中的常规纹理设置粒子系统。如果您已确认粒子系统创建了可见的非黑色粒子，则可以切换到使用自定义纹理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T18:50:04.657

我最终使用粒子薄荷创建粒子系统，然后使用工厂方法：

```
CCParticleSystemQuad* system=[[[CCParticleSystemQuad alloc]initWithDictionary: [ParticleFactory makeEffect]]autorelease]; 
```

# yammer - 在 Yammer 嵌入中登录 - 通过凭据？

> ID：15317035
> 
> 赞同：1
> 
> 时间：2013-03-09T23:15:53.600
> 
> 标签：yammer

我需要将新的嵌入 Yammer 小部件添加到页面。我通过简单地将嵌入代码添加到我的页面来管理它，但是 yammer 登录似乎一直出现。

我不得不说我没有任何使用 Yammer 的经验，但我已经阅读了[Yammer 嵌入安装指南](https://www.yammer.com/pdfs/Yammer_Embed_Install_Guide.pdf)以及其他文档。尽管如此，我仍然无法找到是否可以传递某种凭据（邮件等）以防止嵌入 yammer 向用户显示登录信息，或者至少只显示一次登录信息。

谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T18:33:12.103

来自 Yammer 支持：“即使启用了单点登录，用户仍需要登录到您的 Intranet 和 Yammer 嵌入实例。我们的产品团队有一个开放项目，允许仅单点登录，这样当用户已登录到您的 Intranet 的 SSO，它们也将自动登录到 embed。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T00:21:26.063

如果您将主机站点和 Yammer（https: *//.yammer.com 和 https:* //.assets-yammer.com）都添加到 IE 中的受信任区域，它应该在第一次登录和授权后传递 OAuth 令牌。我已经在 IE8 和 IE10 中成功测试了这个。

问候，克里斯

# testing - Test.QuickCheck：加快测试同一类型的多个属性

> ID：15317041
> 
> 赞同：4
> 
> 时间：2013-03-09T23:16:54.490
> 
> 标签：testing, haskell, quickcheck, htf

我正在测试一个随机生成器，生成我自己类型的实例。为此，我有一个自定义实例`Arbitrary`：

```
complexGenerator :: (RandomGen g) => g -> (MyType, g)

instance Arbitrary MyType where
    arbitrary = liftM (fst . complexGenerator . mkStdGen) arbitrary 
```

这适用于`Test.QuickCheck`（实际上`Test.Framework`）测试生成的值是否具有某些属性。但是，我要检查的属性很多，添加的越多，验证它们所需的时间就越多。

有没有办法使用相同的生成值来测试每个属性，而不是每次都重新生成它们？我显然仍然想看看，在失败时，*哪个*属性不成立，所以制作一个巨大的属性`and`并不是最优的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T10:36:49.867

> 我显然仍然想看看，在失败时，哪个属性不成立，所以制作一个巨大的属性`and`并不是最优的。

[`printTestCase`](http://hackage.haskell.org/packages/archive/QuickCheck/2.6/doc/html/Test-QuickCheck.html#v%3aprintTestCase)您可以在使用制作巨型属性之前使用 标记每个属性[`conjoin`](http://hackage.haskell.org/packages/archive/QuickCheck/2.6/doc/html/Test-QuickCheck.html#v%3aconjoin)。

例如，您认为这是一个坏主意：

```
prop_giant :: MyType -> Bool
prop_giant x = and [prop_one x, prop_two x, prop_three x] 
```

这将同样有效，但会给你更好的输出：

```
prop_giant :: MyType -> Property
prop_giant x = conjoin [printTestCase "one" $ prop_one x,
                        printTestCase "two" $ prop_two x,
                        printTestCase "three" $ prop_three x] 
```

（话虽如此，我自己从未使用过这种方法，只是假设它会起作用；`conjoin`可能出于某种原因在文档中标记为实验性的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T01:46:20.873

结合投票的答案，我发现有用的是使用带有 Writer monad 的 Reader 转换器：

```
type Predicate r = ReaderT r (Writer String) Bool 
```

在这种情况下，Reader “共享环境”是经过测试的输入。然后你可以像这样编写属性：

```
inv_even :: Predicate Int
inv_even = do
  lift . tell $ "this is the even invariant"
  (==) 0 . flip mod 2 <$> ask 

toLabeledProp :: r -> Predicate r -> Property
toLabeledProp cause r =
  let (effect, msg) = runWriter . (runReaderT r) $ cause in
    printTestCase ("inv: " ++ msg) . property $ effect 
```

并结合：

```
fromPredicates :: [Predicate r] -> r -> Property
fromPredicates predicates cause =
  conjoin . map (toLabeledProp cause) $ predicates 
```

我怀疑还有另一种方法涉及类似于这里的 Either 或 WriterT 的东西——它可以简洁地将不同类型的谓词组合成一个结果。但至少，这允许记录根据输入值强加不同后置条件的属性。

编辑：这个想法催生了一个图书馆：http: [//github.com/jfeltz/quickcheck-property-comb](http://github.com/jfeltz/quickcheck-property-comb)

# rest - Understanding WSDL's, SOAP, REST, etc

> ID：15317042
> 
> 赞同：0
> 
> 时间：2013-03-09T23:16:56.537
> 
> 标签：rest, grails, soap, wsdl, cxf

I'm trying to learn how to use WSDL's to call web services from a Grails project. I've been provided with the WSDL and some XML results for reference.

I've been able to generate Java code from the WSDL, and everything seems to be working correctly.

Here's the WSDL: [http://www.restfulwebservices.net/rest/USAZipCodeService.svc?wsdl](http://www.restfulwebservices.net/rest/USAZipCodeService.svc?wsdl)

And here is the XML: [http://api.geonames.org/postalCodeSearch?placename=MN&username=demo](http://api.geonames.org/postalCodeSearch?placename=MN&username=demo)

I am receiving this exception in my project:

ERROR client.WebServiceClientFactoryImpl$WSClientInvocationHandler - No namespace on "geonames" element. javax.xml.ws.soap.SOAPFaultException: No namespace on "geonames" element.

It seems like it is saying that the XML returned isn't valid for SOAP? Am I missing/misunderstanding some pieces the puzzle here? It is all pretty new to me.

Edit: I am trying to use a Grails plugin called cxf client: [https://github.com/ctoestreich/cxf-client](https://github.com/ctoestreich/cxf-client)

It is configured with the following in Config.groovy (something could be wrong/missing here?):

```
wsdl = "http://www.restfulwebservices.net/wcf/USAZipCodeService.svc?wsdl"
namespace = "cxf.client.postalcode"
clientInterface = "cxf.client.postalcode.IPostalCodeService" 
serviceEndpointAddress = "http://api.geonames.org/postalCodeSearch" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T04:03:32.550

我猜您只是将`http://api.geonames.org/postalCodeSearch?placename=MN&username=demo`作为参数返回的 XML 发送到 Web 服务。显然，从返回的 WSDL 描述中您可以看到没有名为`geonames`的元素，因此`SOAPFaultException`异常是一个相当公平的结果。

要修复它，您必须仔细参考[WSDL](http://www.w3.org/TR/wsdl20/)描述，以确保调用方法具有正确的参数，可与 USAZipCodeService WSDL 描述标签中定义的任何内容（如`<wsdl:operation>`和）配合使用`<wsdl:message>`。

另一个问题：在您的调用程序和 Config.groovy 中提到了 2 个不同的 WSDL。前者是 RESTful 服务，后者是 SOAP 服务。它们使用不同的调用方法和参数，因此请确保您的代码也具有一致的调用程序和参数。

# ruby-on-rails - 诊断视图渲染缓慢的原因

> ID：15317048
> 
> 赞同：83
> 
> 时间：2013-03-09T23:17:26.083
> 
> 标签：ruby-on-rails

我不确定这是什么时候开始的，但是我的应用程序中发生了一些不寻常的事情（在开发机器上本地运行）。突然我看到这样的消息：

```
Started GET "/" for 127.0.0.1 at 2013-03-10 12:10:24 +1300
Processing by PagesController#home as HTML
  Rendered pages/home.html.erb within layouts/application (2.4ms)
Completed 200 OK in 3242ms (Views: 3241.4ms | ActiveRecord: 0.0ms) 
```

如您所见，加载主页（一个相对简单的页面）需要 3 秒......我们不是在谈论重新加载页面的困难......只需从另一个页面再次单击“主页”链接。

不太确定从哪里开始，但这是我的 application.rb：

```
#config/boot.rb is loaded
require File.expand_path('../boot', __FILE__)

require 'rails/all'

if defined?(Bundler)
  Bundler.require(*Rails.groups(:assets => %w(development test)))
end

module Goodsounds
  class Application < Rails::Application
    config.encoding = "utf-8"
    config.filter_parameters += [:password]
    config.assets.initialize_on_precompile = false
    config.assets.enabled = true
    config.action_controller.assets_dir = "#{File.dirname(File.dirname(__FILE__))}/public"
    config.assets.version = '1.0'
    config.autoload_paths += Dir["#{Rails.root}/lib/modules"]
    config.assets.paths += Dir["#{Rails.root}/app/assets/fonts/*"]
    config.assets.precompile += %w( .svg .eot .woff .ttf ) 
  end
end 
```

...和 ​​dev.rb：

```
Goodsounds::Application.configure do
  # Settings specified here will take precedence over those in config/application.rb
    Paperclip.options[:command_path] = "/usr/bin/"

    config.action_mailer.default_url_options = { :host => 'localhost:3000' }

  config.action_mailer.raise_delivery_errors = true

  # set delivery method to :smtp, :sendmail or :test
  config.action_mailer.delivery_method = :smtp

  # these options are only needed if you choose smtp delivery

  config.action_mailer.smtp_settings = { :address => "localhost", :port => 1025 }

  # In the development environment your application's code is reloaded on
  # every request. This slows down response time but is perfect for development
  # since you don't have to restart the web server when you make code changes.
  config.cache_classes = false

  # Log error messages when you accidentally call methods on nil.
  config.whiny_nils = true

  # Show full error reports and disable caching
  config.consider_all_requests_local       = true
  config.action_controller.perform_caching = false

  # Print deprecation notices to the Rails logger
  config.active_support.deprecation = :log

  # Only use best-standards-support built into browsers
  config.action_dispatch.best_standards_support = :builtin

  # Raise exception on mass assignment protection for Active Record models
  config.active_re
cord.mass_assignment_sanitizer = :strict

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  config.active_record.auto_explain_threshold_in_seconds = 0.5

  # Do not compress assets
  config.assets.compress = false

  # Expands the lines which load the assets
  config.assets.debug = true
end 
```

编辑：

好的，这是我在新遗物上看到的。虽然并没有真正帮助我。有什么想法吗？

![在此处输入图像描述](../Images/85bfa58c84d3d6ddd1419393a92c1f76.png)

![在此处输入图像描述](../Images/ea8d999df57c298636bdefb37d7a5e5f.png)

哦，我从 Chrome 时间线中学到的东西：

```
Send Request - Details
Duration    0 (at 655 ms)
Resource    localhost
Request Method  GET

Receive Response - Details
Duration    0.043 ms (at 4.17 s)
Resource    localhost
Status Code 200
MIME Type   text/html

Receive Data - Details
Duration    176.329 ms (at 4.17 s)
Self Time   7.037 ms
CPU Time    176.329 ms
Aggregated Time 061.194 ms114.664 ms0.471 ms0
Resource    localhost
Encoded Data Length 303 Bytes
Used Heap Size  29.1 MB (+5.7 MB)

Finish Loading - Details
Duration    0 (at 4.35 s)
Resource    localhost 
```

顺便说一句，我禁用了 quiet_assets gem 以查看我可以在终端中发现什么......再次......没有帮助：

```
Started GET "/" for 127.0.0.1 at 2013-03-10 21:46:40 +1300
Processing by PagesController#home as HTML
  Rendered pages/home.html.erb within layouts/application (43.4ms)
Completed 200 OK in 3501ms (Views: 3480.9ms | ActiveRecord: 19.4ms)

Started GET "/assets/dataTables/jquery.dataTables.bootstrap.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /dataTables/jquery.dataTables.bootstrap.css - 304 Not Modified (11ms)

Started GET "/assets/chosen.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /chosen.css - 304 Not Modified (5ms)

Started GET "/assets/select2.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /select2.css - 304 Not Modified (4ms)

Started GET "/assets/autocomplete.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /autocomplete.css - 304 Not Modified (1ms)

Started GET "/assets/branches.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /branches.css - 304 Not Modified (2ms)

Started GET "/assets/bubbles.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bubbles.css - 304 Not Modified (1ms)

Started GET "/assets/business_show.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /business_show.css - 304 Not Modified (1ms)

Started GET "/assets/chunkyfive_font.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /chunkyfive_font.css - 304 Not Modified (1ms)

Started GET "/assets/consumer_show.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /consumer_show.css - 304 Not Modified (2ms)

Started GET "/assets/datatable_styling.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /datatable_styling.css - 304 Not Modified (1ms)

Started GET "/assets/datepicker.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /datepicker.css - 304 Not Modified (2ms)

Started GET "/assets/devise_links.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /devise_links.css - 304 Not Modified (1ms)

Started GET "/assets/dispenser_show.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /dispenser_show.css - 304 Not Modified (1ms)

Started GET "/assets/fonts.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /fonts.css - 304 Not Modified (1ms)

Started GET "/assets/forms.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /forms.css - 304 Not Modified (2ms)

Started GET "/assets/gmaps4rails.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /gmaps4rails.css - 304 Not Modified (1ms)

Started GET "/assets/jquery-ui-1.10.0.custom.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jquery-ui-1.10.0.custom.css - 304 Not Modified (2ms)

Started GET "/assets/jumbotrons.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jumbotrons.css - 304 Not Modified (1ms)

Started GET "/assets/layout.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /layout.css - 304 Not Modified (1ms)

Started GET "/assets/open_sans.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /open_sans.css - 304 Not Modified (2ms)

Started GET "/assets/popover.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /popover.css - 304 Not Modified (1ms)

Started GET "/assets/reviews.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /reviews.css - 304 Not Modified (1ms)

Started GET "/assets/spinner.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /spinner.css - 304 Not Modified (2ms)

Started GET "/assets/style_show.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /style_show.css - 304 Not Modified (2ms)

Started GET "/assets/style_show_reviews.css?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /style_show_reviews.css - 304 Not Modified (2ms)

Started GET "/assets/jquery.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jquery.js - 304 Not Modified (3ms)

Started GET "/assets/jquery_ujs.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jquery_ujs.js - 304 Not Modified (3ms)

Started GET "/assets/ui.custom.min.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /ui.custom.min.js - 304 Not Modified (1ms)

Started GET "/assets/bootstrap-transition.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-transition.js - 304 Not Modified (5ms)

Started GET "/assets/bootstrap-affix.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-affix.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-alert.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-alert.js - 304 Not Modified (4ms)

Started GET "/assets/bootstrap-button.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-button.js - 304 Not Modified (5ms)

Started GET "/assets/bootstrap-carousel.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-carousel.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-collapse.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-collapse.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-dropdown.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-dropdown.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-modal.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-modal.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-scrollspy.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-scrollspy.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-tab.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-tab.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap-tooltip.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-tooltip.js - 304 Not Modified (5ms)

Started GET "/assets/bootstrap-popover.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-popover.js - 304 Not Modified (52ms)

Started GET "/assets/bootstrap-typeahead.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap-typeahead.js - 304 Not Modified (3ms)

Started GET "/assets/bootstrap.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /bootstrap.js - 304 Not Modified (13ms)

Started GET "/assets/gmaps4rails/gmaps4rails.base.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /gmaps4rails/gmaps4rails.base.js - 304 Not Modified (1ms)

Started GET "/assets/gmaps4rails/gmaps4rails.bing.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /gmaps4rails/gmaps4rails.bing.js - 304 Not Modified (2ms)

Started GET "/assets/gmaps4rails/gmaps4rails.googlemaps.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /gmaps4rails/gmaps4rails.googlemaps.js - 304 Not Modified (2ms)

Started GET "/assets/gmaps4rails/gmaps4rails.mapquest.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /gmaps4rails/gmaps4rails.mapquest.js - 304 Not Modified (2ms)

Started GET "/assets/gmaps4rails/gmaps4rails.openlayers.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /gmaps4rails/gmaps4rails.openlayers.js - 304 Not Modified (2ms)

Started GET "/assets/jqueryplugins/addresspicker.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/addresspicker.js - 304 Not Modified (2ms)

Started GET "/assets/jqueryplugins/browser_detect.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/browser_detect.js - 304 Not Modified (3ms)

Started GET "/assets/jqueryplugins/charts.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/charts.js - 304 Not Modified (2ms)

Started GET "/assets/jqueryplugins/jquery.alphanumeric.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/jquery.alphanumeric.js - 304 Not Modified (1ms)

Started GET "/assets/jqueryplugins/jquery.formrestrict.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/jquery.formrestrict.js - 304 Not Modified (2ms)

Started GET "/assets/jqueryplugins/jquery.lazyload.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/jquery.lazyload.js - 304 Not Modified (1ms)

Started GET "/assets/jqueryplugins/raty.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /jqueryplugins/raty.js - 304 Not Modified (2ms)

Started GET "/assets/dataTables/jquery.dataTables.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /dataTables/jquery.dataTables.js - 304 Not Modified (13ms)

Started GET "/assets/dataTables/jquery.dataTables.bootstrap.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /dataTables/jquery.dataTables.bootstrap.js - 304 Not Modified (63ms)

Started GET "/assets/lib/abstract-chosen.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /lib/abstract-chosen.js - 304 Not Modified (12ms)

Started GET "/assets/lib/select-parser.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /lib/select-parser.js - 304 Not Modified (12ms)

Started GET "/assets/chosen.jquery.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /chosen.jquery.js - 304 Not Modified (8ms)

Started GET "/assets/chosen-jquery.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /chosen-jquery.js - 304 Not Modified (9ms)

Started GET "/assets/select2.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /select2.js - 304 Not Modified (7ms)

Started GET "/assets/highcharts.js?body=1" for 127.0.0.1 at 2013-03-10 21:46:44 +1300
Served asset /highcharts.js - 304 Not Modified (1ms) 
```

顺便说一句，根据 reddit 上的建议，我预编译了资产并运行了服务器。看到惊人的速度：

```
Processing by PagesController#home as HTML
Rendered pages/home.html.erb within layouts/application (1.1ms)
Completed 200 OK in 6ms (Views: 5.4ms | ActiveRecord: 0.0ms) 
```

好的，不确定这是否提供任何帮助，但主要延迟发生在堆栈中的这两行代码之间：

```
From: /home/funkdified/.rvm/gems/ruby-1.9.3-p392@goodsounds/gems/actionpack-3.2.13.rc1/lib/action_controller/metal/implicit_render.rb @ line 5 ActionController::ImplicitRender#send_action:

    3: def send_action(method, *args)
    4:   ret = super
 => 5:   default_render unless response_body
    6:   ret
    7: end

[2] pry(#<PagesController>)> next 
```

**重大延误**

```
From: /home/funkdified/.rvm/gems/ruby-1.9.3-p392@goodsounds/gems/actionpack-3.2.13.rc1/lib/action_controller/metal/implicit_render.rb @ line 6 ActionController::ImplicitRender#send_action:

    3: def send_action(method, *args)
    4:   ret = super
    5:   default_render unless response_body
 => 6:   ret
    7: end 
```

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-03-11T10:29:25.143

好的，我想通了（终于）。在不改变我的任何实际资产的情况下，我现在看到的是发展：

```
Started GET "/" for 127.0.0.1 at 2013-03-11 23:14:33 +1300
Processing by PagesController#home as HTML
Rendered pages/home.html.erb within layouts/application (1.3ms) 
```

事实证明，延迟是由`config.assets.debug = true`development.rb 内部引起的。设置它来`false`解决问题。

看起来 Rails 核心团队在讨论是否[**默认关闭此功能**](https://github.com/rails/rails/pull/3180)，但最终决定反对。将来，我希望看到他们在 development.rb 的评论部分中添加一些内容，以提示用户可能会出现重大延迟。

我可以建议以下几点：

```
# Expands the lines which load the assets 
# May cause significant delays in view rendering 
```

太好了，他们听到我喃喃自语并**[更新了导轨](https://github.com/rails/rails/commit/dbd8bec525ea6)**！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-10-21T16:22:49.023

我在 rails 4.1+ 中也出现了同样的问题。亚伯兰的回答只是部分完整。

您可以离开`config.assets.debug = true`，但应禁用新资产验证功能

```
# Adds additional error checking when serving assets at runtime.
# Checks for improperly declared sprockets dependencies.
# Raises helpful error messages.
config.assets.raise_runtime_errors = false 
```

禁用的解决方案`config.assets.debug`仅适用，因为它编译资产一次并且资产验证一次。资产验证是花费最多时间的地方。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-20T21:45:54.743

如果您来自 rails 3.2.13，请注意很多人都遇到过这个问题，并且恢复到 3.2.12 似乎可以解决它。[您可以在 github 上](https://github.com/rails/rails/issues/9803)找到更多信息。

在我的情况下，禁用`config.assets.debug`会加快一些速度，但恢复到 3.2.12 会将请求时间从大约 4 秒减少到大约 250 毫秒。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-10T00:21:08.737

看看[NewRelic.com](http://newrelic.com/) - 它是收费的，但免费试用可以让您彻底剖析您的应用程序并找出瓶颈所在。

除了 New Relic 运行通常的检查，例如它是什么时候开始的？你最近有什么变化？您是否升级了 Rails 和/或任何 gem？从源代码管理中检查并运行一些以前的版本，并尝试具体找出导致问题的提交。

所有浏览器都会出现这个问题吗？尝试启动 Chrome 时间线查看器，您将能够查看浏览器是否卡在特定的 JavaScript 片段上。

还可以尝试将本地开发 Web 服务器切换为瘦服务器，问题是否仍然存在？

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-10T17:03:27.673

您是否在 OSX 上并通过 .local 提供服务？

如果是这样，将我在评论中找到的帖子作为解决方案抛出：
[子域约束（Rails 3）使本地服务器（瘦）SO SLOW](https://stackoverflow.com/questions/13256485/subdomain-constraint-rails-3-makes-local-server-thin-so-slow)

# vb.net - How to determine a blinking cursor (caret) position VB.net

> ID：15317050
> 
> 赞同：2
> 
> 时间：2013-03-09T23:17:55.080
> 
> 标签：vb.net, cursor

How to determine blinking cursor position x,y on the form?

EDIT:

Okay, after many years I decided to take a look at my question. The description is very short and doesn't tell anything. I remember, was doing a desktop application for a medical device with automatic suggestions of names, while the beginning of a patient name is typed. I needed a list-control to have VS like suggestions just after the caret.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:17:55.080

For this I used `yourTextBox.GetPositionFromCharIndex(CharacterIndexAsIntegerTypeHere)`

ListBox is moving on X axis with TextBox characters:

```
Dim Lstb as new ListBox
Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged  
  With Lstb
    .size = new size(50,50)
    .BackColor = Color.aqua
    .location = New Point(TextBox1.Location.X + TextBox1.GetPositionFromCharIndex(TextBox1.Text.Length - 1).X,  TextBox1.Location.Y + 50)
  End with    
  Controls.Add(Lstb)
End Sub 
```

# java - 使用 Java 读取文件的最后 n 个字节

> ID：15317055
> 
> 赞同：7
> 
> 时间：2013-03-09T23:18:22.320
> 
> 标签：java, windows, file-processing

我有一个记录一些文件的爬虫程序。有时在服务器上，会发生一些错误，爬虫会创建大量无法解析的日志文件。出于这个原因，我想创建一个简单的程序，它在日志文件的末尾读取大约 1000 个字符并向我显示消息（即使爬虫仍在写入该文件）。这将帮助我在不关闭爬虫的情况下解决问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-09T23:36:02.140

使用[RandomAccessFile](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html)来[寻找](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html#seek%28long%29)，然后[读出](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html#read%28byte%5B%5D,%20int,%20int%29)你的字节。

```
File file = new File("DemoRandomAccessFile.out");
RandomAccessFile raf = new RandomAccessFile(file, "r");

// Seek to the end of file
raf.seek(file.length() - n);
// Read it out.
raf.read(yourbyteArray, 0, n); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T23:22:48.433

您的计算机上已经有一个方便的命令行工具。`tail -c 1000`会做你要求的。`tail -n 10`打印出最后 10 行可能更有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-09T23:25:23.130

检查文件长度，比如说 1Mb

使用[RandomAccessFile](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/RandomAccessFile.html)打开**以供读取**

定位到1024*1024-1000

读取 1000 个字节

赞成:)

# entity-framework - asp.net mvc4 entity framework 4: Unable to create a Controller, and I've tried everything

> ID：15317057
> 
> 赞同：0
> 
> 时间：2013-03-09T23:18:28.407
> 
> 标签：entity-framework, asp.net-mvc-4, visual-studio-2012

I'm building a website using Visual Studio 2012 with MVC4 and Entity Framework 4. I created all my model classes, with all their attributes (with some relationships between them). So far, my classes only have a bunch of attributes (no methods yet).

But whenever I try to create a controller for a class that has a collection in it, I get this error: **Unable to retrieve metadata for '*model name*'. Value cannot be null. Parameter name: key.**

I've googled it and found different solutions, but none of them worked: I tried renaming all my primary key attributes to "Id" (they are also all annotated with [Key]), I also tried commenting out the constructor in the Data Context class, I checked my connection is named DefaultConnection...

This is one of the classes for which I'm being unable to create a controller:

```
public class JobOffer
    {
        [Key]
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int JobOfferId { get; set; }
        public Company Company { get; set; }
        public OfferState State { get; set; }
        public virtual ICollection<OfferApplicant> Applicants { get; set; }
        public virtual ICollection<Requirement> Requirements { get; set; }
    } 
```

(I already tried without the [DatabaseGeneratedAttribute] annotation and it didn't help)

The OfferState class is an abstract class that has 2 subclasses: Open and Closed (they're there to implement a State pattern).

The OfferApplicant class maps 1 JobOffer with 1 Applicant, since that was a many-to-many relationships, so I created a new table.

The Requirement class is also an abstract class that has a few subclasses, like Age, Education, Area, etc., and also a CompositeRequirement, which has a *public virtual ICollection Requirements { get; set; }* collection (it's a Composite pattern).

The classes don't even have methods yet, all they have are their properties.

Any clues?

Thanks!!

# javascript - Send a message when pressing Enter

> ID：15317059
> 
> 赞同：-2
> 
> 时间：2013-03-09T23:18:36.127
> 
> 标签：javascript

Here is my code:

```
<input type=\"text\" id='MsgToSend" + ToClient + "t" + FromClient + "' onkeypress='ClientOnTyping();' /> 
```

where the `FromClient` and the `ToClient` are dynamically generated.

JavaScript:

```
function ClientOnTyping() {
  if(e.keyCode==13) {
     // i know i should do this but my problem is what is 'e' in my case how can i specify it ?
  }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:23:53.613

您需要在事件的元素上附加一个事件侦听器`keydown`。

```
var btn = document.getElementById('MsgToSend');
btn.addEventListerner('keydown', function (e) {
    if(e.keyCode==13) {
     // i know i should do this but my problem is what is 'e' in my case how can i specify it ?
    }
}); 
```

在传统浏览器上，您可以通过这种方式附加事件处理程序。

```
var btn = document.getElementById('MsgToSend');
btn.onkeydown = function (e) {
    e = e || window.event;
    var keyCode = e.keyCode || e.which;
    if(keyCode==13) {
     // i know i should do this but my problem is what is 'e' in my case how can i specify it ?
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:24:18.577

在处理函数的范围内，`e`是一个`event`在 DOM 中触发事件时自动创建的对象。您只需将其传递给您的处理程序。

例如：

```
<input ...onkeypress="ClientOnTyping(event);"> 
```

和

```
function ClientOnTyping(e) {
    ...
} 
```

另外，考虑使用不显眼的代码而不是显眼的代码。请参阅[突兀和不突兀的 javascript](https://stackoverflow.com/questions/8392374/difference-between-obtrusive-and-unobtrusive-javascript)和 Starx 的答案之间的区别。

# c# - C# array of properties

> ID：15317061
> 
> 赞同：2
> 
> 时间：2013-03-09T23:19:08.623
> 
> 标签：c#, arrays, properties, getter

I have several get properties that I would like to be able to loop through like an array of functions. I would like to be able to do something like this

```
public int prop1 { get; }
public string prop2 { get; }
public int[] prop3 { get; }
public int prop4 { get; }
public string prop5 { get; }
public string prop6 { get; }

Func<var> myProperties = { prop1, prop2, prop3, prop4, prop5, prop6 };

ArrayList myList = new ArrayList();
foreach( var p in myProperties)
{
    myList.Add(p);
} 
```

This code is very broken, but I think it conveys the idea of what I would like to be able to do. Anyone know how I can achieve this?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-09T23:30:50.220

您可以使用反射来访问您的类型中的属性：

```
class MyType
{
    public int prop1 { get; }
    public string prop2 { get; }
    public int[] prop3 { get; }
    public int prop4 { get; }
    public string prop5 { get; }
    public string prop6 { get; }

    public List<string> GetAllPropertyValues()
    {
        List<string> values = new List<string>();
        foreach (var pi in typeof(MyType).GetProperties())
        {
            values.Add(pi.GetValue(this, null).ToString());
        }

        return values;
    }
} 
```

请注意，反射很慢，如果有更好的方法，您不应该使用它。例如，当您知道只有 6 个属性时，只需逐个浏览它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:25:05.620

你可以尝试使用`GetProperties`

[GetProperties 文档](http://msdn.microsoft.com/en-us/library/system.type.getproperties.aspx)

例子：

```
PropertyInfo[] myPropertyInfo;
// Get the properties of 'Type' class object.
myPropertyInfo = Type.GetType("System.Type").GetProperties();
Console.WriteLine("Properties of System.Type are:");
for (int i = 0; i < myPropertyInfo.Length; i++)
{
    Console.WriteLine(myPropertyInfo[i].ToString());
} 
```

更多信息：[带有标志的 GetProperties](http://msdn.microsoft.com/en-us/library/kyaxdd3x.aspx)
示例非常好，如果您想访问特定的属性子集（仅像公共属性），它对您很有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T23:25:21.733

如果您已经知道要循环的所有属性，那么您可以试试这个

```
List<Reflection.PropertyInfo> myProperties = new List()<object>
{
    typeof(SomeType).GetProperty("prop1"), 
    typeof(SomeType).GetProperty("prop2"), 
    typeof(SomeType).GetProperty("prop3"), 
    typeof(SomeType).GetProperty("prop4"), 
    typeof(SomeType).GetProperty("prop5"), 
    typeof(SomeType).GetProperty("prop6")
};

foreach(var p in myProperties)
{
    var value = p.GetValue(someObject, new object[0]);
    myList.Add(p);
} 
```

如果没有，你可以使用这样的东西：

```
var myProperties = 
    from pi in someObject.GetType().GetProperties()
    select new 
    {
        pi.Name, 
        Value = pi.GetValue(object, new object[0])
    };

foreach(var p in myProperties)
{
    myList.Add(p.Value);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T23:36:39.510

代码离工作不远了。该`myProperties`变量应该是一个数组，您需要创建从属性读取的函数。（属性getter实际上是作为一个函数实现的，但是你不能把它作为一个函数来调用或者获取对它的引用。）然后你通过调用它们来使用它们。

```
public class MyClass {

  public int prop1 { get; set; }
  public string prop2 { get; set; }
  public int[] prop3 { get; set; }
  public int prop4 { get; set; }
  public string prop5 { get; set; }
  public string prop6 { get; set; }

  public ArrayList GetProperties() {

    Func<object>[] myProperties = {
      () => prop1, () => prop2, () => prop3,
      () => prop4, () => prop5, () => prop6
    };

    ArrayList myList = new ArrayList();
    foreach (var p in myProperties) {
      myList.Add(p());
    }

    return myList;
  }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-16T14:17:05.733

您可以使用数组缓冲区并从中获取所有道具。通过这种方式，您可以非常快速地获取和设置：

```
public object[] buf = new object[5];
public int prop1 { get => buf[0]; }
public string prop2 { get => buf[1]; }
public int[] prop3 { get => buf[2]; }
public int prop4 { get => buf[3]; }
public string prop5 { get => buf[4]; }
public string prop6 { get => buf[5]; } 
```

现在可以使用以下命令访问所有道具`buf`：

```
foreach (var item in buf) {
  myList.Add(item);
} 
```

或直接访问：

```
buf[1] = 10;
x = buf[1]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-23T05:57:26.757

如果您需要数组中的属性，因为您需要（像我一样）设置和/或获取几个相关（和相同类型）的属性，这就是您可以做的。我知道反射是“'慢'”，但对于我的用例，重复代码（以及因此错误机会）减少的好处远远超过反射带来的任何“'慢'”（微不足道）。这不处理索引属性，但可以很容易地从中创建一个版本。

` 公共课 MyClass {

```
 private string[] myBoolPropertyNames = 
    {
        nameof(MyBool1Property),
        nameof(MyBool2Property)
    }; // MyBoolPropertyNames =

    private MyClass()
    {
        foreach (var propertyName in myBoolPropertyNames)
        {

            ReflectionHelper.SetPropertyValue
            (
                parentObject: this,
                propertyName: propertyName,
                untypedPropertyValue: true
            ); // SetPropertyValue

        } // foreach (var propertyName in myBoolPropertyNames)

        foreach (var propertyName in myBoolPropertyNames)
        {

            bool boolPropertyValue = ReflectionHelper.GetPropertyValue<bool>
            (
                parentObject: this,
                propertyName: propertyName
            ); // SetPropertyValue

            Console.WriteLine($"Property '{propertyName}' value: {boolPropertyValue}");

        } // foreach (var propertyName in myBoolPropertyNames)
    }

    public bool MyBool1Property { get; set; }
    public bool MyBool2Property { get; set; }

} // MyClass 
```

`

` 公共类 ReflectionHelper {

```
 public static PropertyType GetPropertyValue<PropertyType>
    (
        object parentObject,
        string propertyName
    )
    {
        if (parentObject == null)
        {
            throw new ArgumentException
            (
                $"Missing '{nameof(parentObject)}'."
            );
        } // if (parentObject == null)

        PropertyInfo propertyInfo = parentObject.GetType().GetProperty(propertyName);
        if (propertyInfo == null)
        {
            throw new ArgumentException
            (
                "No PropertyInfo found for Property: " + propertyName
            );
        } // if (propertyInfo == null)

        object untypedPropertyValue = propertyInfo.GetValue(obj: parentObject);

        Type propertyType = 
        (
            Nullable.GetUnderlyingType(propertyInfo.PropertyType) 
            ?? propertyInfo.PropertyType
        ); // propertyType = 

        object typedPropertyValue = 
        (
            (untypedPropertyValue == null) 
            ? null 
            : Convert.ChangeType(untypedPropertyValue, propertyType)
        ); // typedPropertyValue = 

        return (PropertyType)typedPropertyValue;

    } // GetPropertyValue

    public static void SetPropertyValue
    (
        object parentObject,
        string propertyName,
        object untypedPropertyValue
    )
    {
        if (parentObject == null)
        {
            throw new ArgumentException
            (
                $"Missing '{nameof(parentObject)}'."
            );
        } // if (parentObject == null)

        PropertyInfo propertyInfo = parentObject.GetType().GetProperty(propertyName);
        if (propertyInfo == null)
        {
            throw new ArgumentException
            (
                "No PropertyInfo found for Property: " + propertyName
            );
        } // if (propertyInfo == null)

        Type propertyType = 
        (
            Nullable.GetUnderlyingType(propertyInfo.PropertyType) 
            ?? propertyInfo.PropertyType
        ); // propertyType = 

        object typedPropertyValue =
        (
            (untypedPropertyValue == null)
            ? null
            : Convert.ChangeType(untypedPropertyValue, propertyType)
        ); // typedPropertyValue = 

        propertyInfo.SetValue
        (
            obj: parentObject, 
            value: typedPropertyValue
        ); // propertyInfo.SetValue

    } // SetPropertyValue

} // ReflectionHelper 
```

`

# php - Adding seconds to mysql DateTime via php

> ID：15317063
> 
> 赞同：1
> 
> 时间：2013-03-09T23:19:38.343
> 
> 标签：php, mysql

Im trying to add 12 seconds to a mysql datetime object via php.

My php code generates the following query: "UPDATE Stats SET Usage = 1970-01-01 00:00:12" however the query fails.

My php code is as follows:

```
public function UpdateTime($diffrence)
{
    $seconds = $diffrence / 1000;

    mysql_connect('localhost','user','pass') or die("Unable to select host");

    mysql_select_db('StatDB') or die("Unable to select database");

    $query  = "SELECT * FROM Stats";

    $result=mysql_query($query);

    $retVal = mysql_result($result,0,"Usage");

    $oldTime = new DateTime($retVal);

    $oldTime->modify('+'. $seconds .' seconds');

    $from = date("Y-m-d H:i:s", strtotime($oldTime->format('Y-m-d H:i:s')));

    $query2  = "UPDATE Stats SET Usage = $from";
    echo $query2;

    $result2=mysql_query($query2);

    mysql_close();
} 
```

Does anyone how I can fix this?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:29:38.087

尝试：

```
$query2  = "UPDATE `Stats` SET `Usage` = '$from'"; 
```

'Usage' 是 MySQL 中的保留字：

[http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:34:20.977

您可以使用一个查询来完成所有这些操作：

```
UPDATE Stats SET Usage = Usage + INTERVAL $seconds SECOND 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T23:22:17.910

这可能与您的查询中缺少引号有关。查看这个[问题](https://stackoverflow.com/a/8551986/2151120)的答案。

```
UPDATE Stats SET Usage = '1970-01-01 00:00:12' 
```

您应该将传递的日期时间值括在单引号中。

# java - How to integrate a modified plugin and all of its dependency plugins in own plugin and deliver it in one thing

> ID：15317064
> 
> 赞同：0
> 
> 时间：2013-03-09T23:19:39.023
> 
> 标签：java, eclipse, deployment, eclipse-plugin

**Situation:**

I have written an Eclipse plugin which do some stuff. No I want to use an existing UML Editor plugin which works with my plugin in Eclipse. To modify the UML Editor for my purpose I downloaded the source code of the special plugin and modify some code of it. The Editor itself needs some other plugins, for example the UML2 Extender SDK, GEF etc.

**Goal:**

Is it possible to integrate the modified plugin and all of its dependency plugins in my plugin and deliver it in one thing?

How can I create a feature or a plugin which contains all necessary plugins, so I can give it to a friend who has nothing more to do than for example, put it in his plugin folder and it works without installing some of the necessary plugins in his eclipse additionally?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T06:15:36.933

您不希望您的朋友在他的系统上手动复制该插件，这不是可重现的安装。

相反，您想创建一个功能项目，其中包含您的插件和修改后的 UML 插件。您的功能项目应依赖于您已识别为依赖项的功能。

此外，您希望创建一个更新站点项目，其中包含您的功能并将依赖功能的所有更新站点列为发现站点。然后您将更新站点导出为存档或将其真正放到网上并给您的朋友存档或链接。他将使用更新管理器以正常方式安装您的插件，并且由于包含的发现站点，他的机器将找到所有依赖项并直接从 Internet 安装它们。

# regex - 排除正则表达式中的确切短语

> ID：15317071
> 
> 赞同：1
> 
> 时间：2013-03-09T23:20:54.503
> 
> 标签：regex

怎么能排除一个确切的短语？！

例如，我不想**在正则表达式代码**中匹配它：

```
a sentence with hello phrase 
```

但匹配这个

```
a sentence with oehll phrase 
```

起初我用这个：

```
^([^hello]*)$ 
```

但它唯一的问题是排除了字母“h”、“e”、“l”和“o”（不是术语“hello”）！

我阅读了很多关于此的文章，并以我能想到的任何方式使用了 \b、(?!...) 和 (...)，但我不能！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T22:00:28.963

尝试使用以下正则表达式：

```
^.*((\W|^)hello(\W|$)){0}.*$ 
```

这只是一个 hack，不幸的是，这个表达式也会排除嵌入在其他单词中的“你好”的句子。（例如，“带有**hello** out 短语的句子”）

替代方法：使用以下方法检测带有您想要的短语的句子：

```
^.*((\W|^)hello(\W|$)).*$ 
```

然后删除包含该短语的句子。

免责声明：此外，假设您正在处理文本文件中的原始行而不是英文句子，则编写此表达式。如果您想使用实际句子，我建议您首先将文本标记为单独的句子，然后使用相似的正则表达式测试每个句子。

# git - 计算机死机后 Git 存储库损坏

> ID：15317072
> 
> 赞同：101
> 
> 时间：2013-03-09T23:20:58.410
> 
> 标签：git

我的电脑死机了，现在我的一个 git 存储库坏了。当我尝试结帐大师时，它告诉我：

```
warning: ignoring broken ref refs/heads/master.
error: Your local changes to the following files would be overwritten by checkout:
        com.vainolo.jdraw2d.releng.p2/pom.xml
Please, commit your changes or stash them before you can switch branches.
Aborting 
```

当我执行时，`git stash`我得到：

```
fatal: bad revision 'HEAD'
fatal: bad revision 'HEAD'
fatal: Needed a single revision
You do not have the initial commit yet 
```

那么……我该怎么办？

**更新** 输出`git reflog`：

```
fatal: bad default revision 'HEAD' 
```

不是很有希望...输出`git fsck`：

```
error: Invalid HEAD
Checking object directories: 100% (256/256), done.
error: unable to unpack 59551f96b4e87a1c14293c19eb548ce6fa1f196f header
error: inflateEnd: stream consistency error (no message)
fatal: loose object 59551f96b4e87a1c14293c19eb548ce6fa1f196f (stored in .git/objects/59/551f96b4e87a1c14293c19eb548ce6fa1f196f) is corrupt 
```

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2016-03-10T04:47:35.777

我设法通过以下方式恢复：

```
rm .git/refs/remotes/origin/HEAD
git fetch --all 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-03-09T23:39:07.303

[按照恢复损坏的 git 存储库](https://stackoverflow.com/a/1545919/396967)中建议的步骤开始：

*   检查是否`.git/refs`仍然包含任何有用的东西
*   检查`git reflog`并失败`.git/logs/refs/heads/master`您最后所在的分支的内容或任何分支
*   运行`git fsck`，可能与`--unreachable`或`--lost-found`

这有望让您弄清楚`master`ref 应该是什么，以便您可以恢复它（即，将正确的 SHA1 放入`.git/refs/heads/master`）。

如果该提交中包含的任何对象真正损坏，您将无法恢复您的`HEAD`提交。假设您的工作树和/或索引完好无损，您可以尝试 a `git reset --soft`（或失败 a `git reset`）到上一次提交，然后重新提交。避免任何改变你的工作树 sa`git checkout -f`或`git reset --hard`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-11-04T10:18:49.960

在 Windows 8.1 蓝屏死机后，我遇到了类似的问题

我在这个位置有一个文件...

`C:\www\<project>\.git\refs\remotes\origin\<problem-branch>`

它是空的，而这个文件夹中的其他分支文件里面有很长的字符串。

注意我没有任何更改/提交

*   我备份了`<problem-branch>`文件
*   删除了文件
*   `git fetch --all`再次获得分支

然后选项卡自动完成再次开始工作

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-10T10:55:18.740

如果修改的文件不多，我认为解决这个问题的方便方法是：

1.  备份您在 repo 中修改的文件
2.  删除您现有的回购
3.  从服务器重新克隆它
4.  将步骤 1 中的文件粘贴到 repo，然后`git commit -a`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-10-04T14:16:08.590

在计算冻结和崩溃后，我的 git 分支被以下消息损坏： `git fatal: your current branch appears to be broken`. 我什么也做不了。

之后`git fsck`提到该分支有一个`error: Invalid HEAD`. `refs/heads/<branch>`有一个`invalid sha1 pointer`。

按照此处的选项，我`.git/refs/heads/<branch>`在记事本++ 编辑器中打开，每个 sha1 字符都是`NUL`.

幸运的是，我只需要将分支重置为远程状态，那是在 bitbucket 存储库中。我从远程仓库的尖端抓取了 sha1 并将其复制到`.git/refs/heads/<branch>`保存的位置，然后执行了`git reset --hard HEAD`，一切恢复正常。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-03-18T15:02:35.680

我设法通过删除 git\refs\heads 目录中的主文件来解决这个问题

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-07-19T00:16:16.147

由于无法锁定参考错误，我无法签出我的主分支。我最终删除了： `.git/refs/remotes/origin/HEAD` `.git/refs/remotes/origin/master`

并调用这个 git 命令：

```
git fetch --all 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-08-03T08:59:54.587

我太白痴了，忘了推送，我的电脑在执行提交时崩溃了。我可以通过打开 .git/logs/refs/heads/ 来恢复除最后一次提交之外的所有内容

该文件包含对分支的所有提交（及其 SHA），我所做的恢复是：

*   将最新更改备份到临时文件夹
*   改用“白板”
    *   `git checkout master`
    *   `git reset --hard`
*   签出日志中倒数第二个提交
*   从这个分离的头创建一个分支
*   *推*
*   恢复最新更改
*   再次提交

所以即使你犯了一个愚蠢的错误，你也不会立即被一整天的 git 工作所吸引:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-07T12:16:45.347

当 Android Studio 突然终止时（由于计算机断电），我遇到了同样的问题。

我通过将文件的内容复制到我的`C:\Users\myusername\AndroidStudioProjects\MyBrokenApp\.git\refs\heads\master`文件来解决它`C:\Users\myusername\AndroidStudioProjects\MyBrokenApp\.git\refs\remotes\origin\master`。

（以前，我也在 Android Studio 中打开了“强制推送”选项，但我认为这不是必要的步骤。）

**笔记：**

我通过将我的`C:\Users\myusername\AndroidStudioProjects\MyBrokenApp\.git\`目录（包括子目录）中文件的内容与另一个*健康*项目中的相应文件进行比较找到了这个解决方案 - 例如，`C:\Users\myusername\AndroidStudioProjects\MyHealthyApp\.git\`.

您可能有一个损坏的不同文件，但通过与另一个健康项目进行比较，您应该能够快速发现问题所在。

如果您没有另一个配置了 git 的健康项目，则可能值得以与创建损坏的项目相同的方式创建一个简单的项目，以便进行调查、比较和修复等。

PS - 我的错误信息（已编辑）是：`warning: ignoring broken refs/remotes/origin/master.fatal bad revision 'refs/remotes/origin/master..refs/heads/master' during executing git -c core.quotepath=false log refs/remotes/origin/master..refs/heads/master --pretty=format --encoding=UTF-8 -M --name-status -c --`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-02-20T07:56:46.067

我的电脑崩溃了两次，结果我的 git 存储库在本地被破坏了。我无法拉动我的更改，它要求设置远程来源，但它在 gitKraken 中不起作用。

在我的命令提示符下，我收到了这个错误 [![在此处输入图像描述](../Images/ee93ac4621f7ac4f8bf46dc0ae5d839b.png)](https://i.stack.imgur.com/ospi0.png)

我知道我的参考资料已损坏，需要修复。我必须做的是 git bash （在 SourceTree 点击“终端”）。然后像这样导航到引用文件夹

```
cd .git
cd refs
cd remotes
cd origin 
```

那里会有一个文件名`master`，用于`ls`查看目录中的内容。然后只需使用 rm master 删除它

bam，损坏的文件不见了。现在如果你发出 git branch 命令 -a，它会输出这个

```
$ git branch -a
* master
  remotes/origin/master (this in red color -scary :) ) 
```

然后发出这个命令，它会修复你的引用

```
$ git remote set-head origin master 
```

总而言之，如果您尝试拉遥控器，它应该显示已修复的空白遥控器名称。

[![在此处输入图像描述](../Images/cba275642dba2174106c81007d09410d.png)](https://i.stack.imgur.com/L17KC.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-13T18:39:20.033

我知道这是一个为时已晚的响应，但我收到了这个错误，因为我没有`origin/head`. 你可以通过运行找到这个`git branch -r`。如果你没有看到你`origin/head`指向一个远程源，你可以通过运行来设置它`git remote set-head origin {{your branch name}}`。

现在`git branch -r`再次运行，您应该会看到如下内容： `origin/HEAD -> origin/develop`

我希望这对遇到此问题的其他人有所帮助。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-05T14:02:16.367

检查 MSWindows 是否创建了包含 git 的 desktop.ini 文件？它对我有用。一旦我将它们全部删除到 .git 目录的子文件夹中，它就可以工作了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-17T14:13:52.670

如果我会在某人之后重复（我还没有阅读所有反馈），请原谅我。在我看来，解决问题的最简单方法是复制没有 .git 和 .idea 的项目，清理它，从 git 克隆，删除除上述目录之外的所有内容，然后将以前的副本粘贴到新创建的带有 .git 和 .idea 的仓库中. 希望它确实有意义。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-02-04T21:13:54.610

只需添加我的案例：

```
git push 
```

> 错误：无法锁定参考 'refs/heads/master'：无法解析参考 'refs/heads/master'：参考损坏

我试过了：

```
git clone <path> 
```

但得到：

```
You appear to have cloned an empty repository. 
```

我在服务器存储库上检查了这个文件：

> 裁判/负责人/大师

该文件有一个很长的空白字符字符串。

我用这个命令检查了最后一个提交标识符（幸运的是它仍然有效）：

```
git log origin/master -5 
```

**然后我将最后一个提交标识符复制到服务器文件*refs/heads/master***。

有风险，但它奏效了。克隆，推拉到现在都可以。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-02-11T16:36:32.823

如果你记得你的头指向哪个分支，那么只需转到 github/bitbucket 上的那个分支并复制分支上最新提交的哈希并将其粘贴到文件 .git\refs\remotes\origin\HEAD 中，然后相同混帐添加。git commit -m "" git 推送

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-27T15:29:31.743

面临类似的问题（计算机紧急重启，可能是由于使用 Windows bugchecker re: KB4586853 从 Sourcetree 的内存泄漏/BSOD？）我从以下位置得到以下信息`git fsck --full`：

```
error: refs/heads/merge/FEED-318: invalid sha1 pointer 0000000000000000000000000000000000000000
error: bad ref for .git/logs/HEAD
error: bad ref for .git/logs/refs/heads/<my-branch-name/with-subfolder> 
```

不确定这是不是巧合，但我的分支被命名为`merge/TICKET-NO`.

在盲目地尝试了许多这些解决方案后，**我找到了之前提交的 SHA（来自`.git/logs/HEAD`）并`--force`检查了它**，问题基本解决了。我所有的历史都回来了，能够`gitk`看到漂亮的图表等。只丢失了最后一次尝试提交的更改。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-11-12T11:32:45.753

我有同样的问题，但没有运气，无法找出问题所在。我把我的回购放在一边，从服务器重新克隆了一个，并试图在它们之间合并。当然，它显示了很多与我的分支无关的文件，但有助于隔离所需的文件。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-08-11T09:01:08.553

# 详细说明

#### 错误信息“断头”是什么意思？

在解决问题之前，我们应该先了解错误信息。

错误信息说 HEAD 坏了！哪个头？头部表示我们当前的分支。该错误基本上意味着 CURRENT BRANCH 已损坏。

假设我们有 , 之类的分支，`ab`当前分支是 分支。`bb``cb``ab`

当我们运行这个命令`ls .git/refs/heads`时，我们会看到`ab`, `bb`, `cb`，它们是包含像`392b55ccd3ba02fe236148c5264f8ef1da`.

每当我们提交时，这个哈希值就会改变。

让我们回到错误消息“Head is broken”。

这实际上意味着这个分支的哈希值是无效的！

### 如何重新生成此错误（也许）？

第 1 步：在不提交的情况下进行大量更改。

第 2 步：提交重大更改后仅 1 秒关闭计算机。

所以，git 无法更新新的哈希值，现在旧的哈希值失效了！

#### 怎么解决？

只需删除当前的哈希值！就这么简单！

这`ab`是我们当前的分支，这是我们的断头！

`rm .git/refs/heads/ab`命令将删除包含 INVALID 哈希值的 ab 文件。

如果分支是远程分支（之前被推送到仓库），那么我们应该`git pull --allow-unrelated-histories --ff origin ab`

如果分支是本地的，则继续提交。

解决了！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-02-04T19:50:50.903

因为我知道我的**本地分支是最新的**，所以一个快速的解决方法是简单地**将头部 SHA-1 复制到远程**。

* * *

*我的可能原因：电源故障。*

我收到了这个错误，但无论如何我都能推送更改。

我检查了文件`.git/refs/remotes/<branch>`，它包含所有`null`字符。

但是，`.git/refs/heads/<branch>`具有正确的 SHA1。

# java - 我的进步条件无效

> ID：15317075
> 
> 赞同：-5
> 
> 时间：2013-03-09T23:21:43.550
> 
> 标签：java, android

请帮助我完成这个项目。这个条件是为了我们的游戏进度。这里的错误是如果其中一个 if 语句是正确的，如果你按下另一个按钮并正确得到答案，结果不再添加..请帮助我..非常感谢.. :DD

```
 try
    {
        if(questonedone==true)
        {
            btl1.setBackgroundResource(R.drawable.f1);
            btl1.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questtwodone==true)
        {
            btl2.setBackgroundResource(R.drawable.f5);
            btl2.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questthreedone==true)
        {
            btl3.setBackgroundResource(R.drawable.f9);
            btl3.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questfourdone==true)
        {
            btl4.setBackgroundResource(R.drawable.f13);
            btl4.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questfivedone==true)
        {
            btl5.setBackgroundResource(R.drawable.f2);
            btl5.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questsixdone==true)
        {
            btl6.setBackgroundResource(R.drawable.f6);
            btl6.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questsevendone==true)
        {
            btl7.setBackgroundResource(R.drawable.f10);
            btl7.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questeightdone==true)
        {
            btl8.setBackgroundResource(R.drawable.f14);
            btl8.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questninedone==true)
        {
            btl9.setBackgroundResource(R.drawable.f3);
            btl9.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questtendone==true)
        {
            btl10.setBackgroundResource(R.drawable.f7);
            btl10.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questelevendone==true)
        {
            btl11.setBackgroundResource(R.drawable.f11);
            btl11.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questtwelvedone==true)
        {
            btl12.setBackgroundResource(R.drawable.f15);
            btl12.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questthirteendone==true)
        {
            btl13.setBackgroundResource(R.drawable.f4);
            btl13.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questfourteendone==true)
        {
            btl14.setBackgroundResource(R.drawable.f8);
            btl14.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questfifteendone==true)
        {
            btl15.setBackgroundResource(R.drawable.f12);
            btl15.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }
        if(questsixteendone==true)
        {
            btl16.setBackgroundResource(R.drawable.f16);
            btl16.setEnabled(false);
            counter =  percent + 6.25 ;
            counter2 = percent2 + 1;
        }

        result.setText(counter + "%");
        result2.setText(counter2 + " out of 16");
    }

    catch(Exception e)
    {

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:47:35.177

将百分比替换为计数器，将百分比 2 替换为计数器 2。

# vb.net - 如何在 Windows 关机时优雅地关闭控制台应用程序

> ID：15317082
> 
> 赞同：3
> 
> 时间：2013-03-09T23:23:16.877
> 
> 标签：vb.net, winapi, windows-console

当 Windows 关闭时，我试图优雅地关闭我的 vb.net 控制台应用程序。我找到了调用 Win32 函数 SetConsoleCtrlHandler 的示例，它们基本上看起来像这样：

```
Module Module1

Public Enum ConsoleEvent
    CTRL_C_EVENT = 0
    CTRL_BREAK_EVENT = 1
    CTRL_CLOSE_EVENT = 2
    CTRL_LOGOFF_EVENT = 5
    CTRL_SHUTDOWN_EVENT = 6
End Enum

Private Declare Function SetConsoleCtrlHandler Lib "kernel32" (ByVal handlerRoutine As ConsoleEventDelegate, ByVal add As Boolean) As Boolean
Public Delegate Function ConsoleEventDelegate(ByVal MyEvent As ConsoleEvent) As Boolean

Sub Main()

    If Not SetConsoleCtrlHandler(AddressOf Application_ConsoleEvent, True) Then
        Console.Write("Unable to install console event handler.")
    End If

    'Main loop
    Do While True
        Threading.Thread.Sleep(500)
        Console.WriteLine("Main loop executing")
    Loop

End Sub

Public Function Application_ConsoleEvent(ByVal [event] As ConsoleEvent) As Boolean

    Dim cancel As Boolean = False

    Select Case [event]

        Case ConsoleEvent.CTRL_C_EVENT
            MsgBox("CTRL+C received!")
        Case ConsoleEvent.CTRL_BREAK_EVENT
            MsgBox("CTRL+BREAK received!")
        Case ConsoleEvent.CTRL_CLOSE_EVENT
            MsgBox("Program being closed!")
        Case ConsoleEvent.CTRL_LOGOFF_EVENT
            MsgBox("User is logging off!")
        Case ConsoleEvent.CTRL_SHUTDOWN_EVENT
            MsgBox("Windows is shutting down.")
            ' My cleanup code here
    End Select

    Return cancel ' handling the event.

End Function 
```

这工作正常，直到我在收到此异常时将其合并到现有程序中：

> 检测到 CallbackOnCollectedDelegate 消息：对“AISLogger!AISLogger.Module1+ConsoleEventDelegate::Invoke”类型的垃圾收集委托进行了回调。这可能会导致应用程序崩溃、损坏和数据丢失。将委托传递给非托管代码时，托管应用程序必须使它们保持活动状态，直到保证它们永远不会被调用。

大量搜索表明问题是由未引用的委托对象引起的，因此超出了范围，因此被垃圾收集器处理掉了。这似乎可以通过在上面示例中的主循环中添加 GC.Collect 来确认，并在关闭控制台窗口或按 ctrl-C 时获得相同的异常。问题是，我不明白“引​​用代表”是什么意思？这对我来说听起来像是将变量分配给函数？？？我怎样才能在VB中做到这一点？有很多这样的 C# 示例，但我无法将它们翻译成 VB。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:53:17.030

```
 If Not SetConsoleCtrlHandler(AddressOf Application_ConsoleEvent, True) Then 
```

这是让你陷入困境的陈述。它即时创建一个委托实例并将其传递给非托管代码。但是垃圾收集器看不到该非托管代码持有的引用。您需要自己存储它，这样它就不会被垃圾收集。让它看起来像这样：

```
Private handler As ConsoleEventDelegate

Sub Main()
    handler = AddressOf Application_ConsoleEvent
    If Not SetConsoleCtrlHandler(handler, True) Then
       '' etc... 
```

*处理程序*变量现在保持它被引用，并在程序的生命周期内这样做，因为它是在模块中声明的。

顺便说一句，您无法取消关机，但这是另一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T23:54:12.147

指向函数的指针在 .Net 中表示为委托。委托是一种对象，与任何其他对象一样，如果没有对它的引用，那么它将被垃圾回收。

表达式`(AddressOf Application_ConsoleEvent)`创建委托。 `SetConsoleCtrlHandler`是一个原生函数，所以它不理解委托；它接收一个原始函数指针。所以操作顺序是：

1.  `(AddressOf Application_ConsoleEvent)`创建委托。
2.  `SetConsoleCtrlHandler`接收指向委托的原始函数指针，并存储原始指针以供以后使用。
3.  时间流逝。请注意，现在没有任何内容引用委托。
4.  发生垃圾收集并收集委托，因为它未被引用。
5.  应用程序正在关闭，因此 Windows 尝试通过调用原始函数指针来通知您。这指向一个不存在的委托，所以你崩溃了。

您需要声明一个变量以保留对委托的引用。我的 VB 很生锈，但类似于：

```
Shared keepAlive As ConsoleEventDelegate 
```

然后

```
keepAlive = AddressOf ConsoleEventDelegate
If Not SetConsoleCtrlHandler(keepAlive, True) Then
    'etc. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-06T05:00:31.720

执行此操作的最简单方法可能是处理[AppDomain.ProcessExit 事件](http://msdn.microsoft.com/en-us/library/system.appdomain.processexit.aspx)，该事件在应用程序的父进程退出时引发。

```
 For example:
        Module MyApp

        Sub Main()
            ' Attach the event handler method
            AddHandler AppDomain.CurrentDomain.ProcessExit, AddressOf MyApp_ProcessExit

            ' Do something
            ' ...

            Environment.Exit(0)
        End Sub

        Private Sub MyApp_ProcessExit(sender As Object, e As EventArgs)
            Console.WriteLine("App Is Exiting...")
        End Sub

    End Module 
```

但是调用**Environment.Exit**可能不是解决原始问题的最佳方法。通常，[唯一需要使用此方法的情况是可能有其他前台线程正在运行](https://stackoverflow.com/a/692371/366904)。在这种情况下，值得研究如何优雅地终止那些其他线程，而无需采取严厉措施来杀死整个进程。

**Environment.Exit**，尽管名字听起来有点好听，但却是一个相当残酷的措施。它不像在 Windows 任务管理器中单击“结束任务”那么糟糕（请注意，如果您这样做，不会引发**ProcessExit**事件，这意味着上述建议将不起作用），但这可能不是您的解决方案真的很想要，要么。

# android - Android opengl Tracer 不工作

> ID：15317083
> 
> 赞同：1
> 
> 时间：2013-03-09T23:23:19.013
> 
> 标签：android, opengl-es, profiling, adb, trace

我正在尝试运行 android opengl 跟踪器工具：http: [//developer.android.com/tools/help/gltracer.html](http://developer.android.com/tools/help/gltracer.html)

我正在尝试使用 Eclipse Juno 在 Galaxy Nexus (Android 4.2) 上运行它。我也尝试从独立的 tool\monitor.bat 运行它。

跟踪器提示我输入我的应用程序。当我按确定时，它会启动应用程序。

2 秒后，我收到以下消息：“设置跟踪选项时出现意外错误：软件导致连接中止：套接字写入错误。”

我还注意到设备上有很多开发人员选项，用于处理跟踪。我试过修补它们，但无济于事。

我找不到任何体面的错误文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T14:17:24.420

我使用 fastboot 和库存的 Google ROM 将我的 Galaxy Nexus 降级到 Android 4.1.2 并让它工作，所以我相信这是 4.1.2 的回归。我在这里打开了一个错误报告：[https ://code.google.com/p/android/issues/detail?id=53426](https://code.google.com/p/android/issues/detail?id=53426)

# java - OpenGL中带有四边形的奇怪条带

> ID：15317091
> 
> 赞同：0
> 
> 时间：2013-03-09T23:24:19.973
> 
> 标签：java, opengl, antialiasing, distortion

一切都在我刚刚拍摄的屏幕截图上......基本上，即使没有启用照明，它也会这样做......它是否与抗锯齿有关？

截图：http: [//i.imgur.com/Lrr29cL.png](http://i.imgur.com/Lrr29cL.png)

@Axel，这是我的单个立方体的代码：

```
glBegin(GL_QUADS);

glColor3f(r,g,b);

glNormal3f(0, 0, -1);
glVertex3f(position.x + radius, position.y + radius, position.z - radius);
glVertex3f(position.x + radius, position.y - radius, position.z - radius);
glVertex3f(position.x - radius, position.y - radius, position.z - radius);
glVertex3f(position.x - radius, position.y + radius, position.z - radius);

glNormal3f(0, 0, 1);
glVertex3f(position.x + radius, position.y + radius, position.z + radius);
glVertex3f(position.x + radius, position.y - radius, position.z + radius);
glVertex3f(position.x - radius, position.y - radius, position.z + radius);
glVertex3f(position.x - radius, position.y + radius, position.z + radius);

glNormal3f(-1, 0, 0);
glVertex3f(position.x - radius, position.y + radius, position.z + radius);
glVertex3f(position.x - radius, position.y - radius, position.z + radius);
glVertex3f(position.x - radius, position.y - radius, position.z - radius);
glVertex3f(position.x - radius, position.y + radius, position.z - radius);

glNormal3f(1, 0, 0);
glVertex3f(position.x + radius, position.y + radius, position.z + radius);
glVertex3f(position.x + radius, position.y - radius, position.z + radius);
glVertex3f(position.x + radius, position.y - radius, position.z - radius);
glVertex3f(position.x + radius, position.y + radius, position.z - radius);

glNormal3f(0, -1, 0);
glVertex3f(position.x + radius, position.y - radius, position.z + radius);
glVertex3f(position.x - radius, position.y - radius, position.z + radius);
glVertex3f(position.x - radius, position.y - radius, position.z - radius);
glVertex3f(position.x + radius, position.y - radius, position.z - radius);

glNormal3f(0, 1, 0);
glVertex3f(position.x + radius, position.y + radius, position.z + radius);
glVertex3f(position.x - radius, position.y + radius, position.z + radius);
glVertex3f(position.x - radius, position.y + radius, position.z - radius);
glVertex3f(position.x + radius, position.y + radius, position.z - radius);

glEnd(); 
```

# javascript - Javascript 画布尺寸

> ID：15317093
> 
> 赞同：1
> 
> 时间：2013-03-09T23:24:32.163
> 
> 标签：javascript, html, canvas

我在 HTML 页面上有一个画布：

```
<canvas id="canvas" class="canvas"></canvas> 
```

属性`width`并将`height`画布拉伸到某个字段，但不要调整它的大小。所以

```
var canvasElement = document.getElementById('canvas');
canvasElement.width = 400;
canvasElement.height = 400; 
```

不起作用。

如何调整画布大小（使其不等于 160*320）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:28:12.927

你可以这样做，这样。

```
var canvasElement = document.getElementById('yourCanvasElement');
canvasElement.width = 500;
canvasElement.height = 400; 
```

# c# - 我的代码的任何并发问题

> ID：15317102
> 
> 赞同：0
> 
> 时间：2013-03-09T23:25:39.410
> 
> 标签：c#, multithreading, file-io, thread-safety

我试图创建一个线程安全的方法。

有人看到以下代码有任何并发​​问题吗？

对我来说这似乎很好，**尽管我永远无法找到一种方法来测试这种方法的并发性。**任何帮助，将不胜感激。

```
 //static locker for thread synchronization
   private static readonly System.Object _object3 = new System.Object();

   //this method needs to be thread-safe
   public static void LogToTextFile(string logMessage, LogLevel logType)
    {
       //make sure only one thread executes this file writing code at a time            
       lock (_object3)
        {
            using (StreamWriter w = File.AppendText(@"c:\logs\log1.txt");
            {
                w.WriteLine("\r\n{0} logged at {1} {2} : {3}", logType.ToString().ToUpper(), DateTime.Now.ToLongTimeString(), DateTime.Now.ToLongDateString(), logMessage);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:27:56.913

此代码没有并发问题，因为由于 lock 语句，您只允许单个线程写入文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T23:31:02.883

考虑到您正在`lock`使用范围适当的对象，我认为您的代码没有并发问题。

但是，正如评论中提到的那样，您有一个潜在的性能问题。如果两个线程同时尝试`LogToTextFile`，一个会先获得锁，另一个会在文件打开、写入和关闭时阻塞。这可能是不可接受的，具体取决于您的线程在做什么。

如果我提到的是一个问题，您将不得不实现一个更复杂的线程安全记录器。通常会有一个队列，日志事件会被快速写入。然后有另一个线程定期唤醒，并将队列清空到磁盘上的文件。队列上的所有操作都使用锁完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T23:48:35.110

另一个可能更好的解决方案可能是让文件保持打开状态，并使用同步`TextWriter`来执行写入。 [`TextWriter.Synchronized`](http://msdn.microsoft.com/en-us/library/system.io.textwriter.synchronized.aspx)为 a 提供了一个线程安全的包装器`TextWriter`：

> 对返回的包装器的所有写操作都是线程安全的。您调用此方法以确保一次只有一个线程可以执行返回的 TextWriter 实例上的方法。

这是一个简单的实现。请注意，这尚未经过测试。

```
public static class MyLogger
{
    private static TextWriter s_writer;

    // Not thread-safe. Call this before other threads are allowed to call Log.
    public void Open(string filename) {
        s_writer = TextWriter.Synchronized( File.AppendText(filename) );
    }

    // Also not thread-safe.
    public void Close() {
       s_writer.Dispose();
    }

    // Thread-safe.
    public void Log(string logMessage, LogLevel logType) {
        s_writer.WriteLine("\r\n{0} logged at {1} {2} : {3}",
            logType.ToString().ToUpper(), DateTime.Now.ToLongTimeString(),
            DateTime.Now.ToLongDateString(), logMessage);
    }    
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-10T00:56:09.720

此特定函数中不存在并发问题。该`lock`语句将适当地调节对内部代码的访问。

但是，访问`@"c:\logs\log1.txt"`. 您的应用程序的另一部分或同一台机器上的另一个进程可能会尝试与您的代码同时写入文件。因此，`StreamWriter`即使使用此锁，代码也可能会失败。

没有办法解决这种类型的并发问题。文件系统是您没有真正保护能力的共享资源。相反，您的代码需要接受文件系统访问可能失败并正确处理该后果。

通常在处理日志记录函数时，我用 a 包装文件系统访问`try / catch`并吞下发生的任何异常。否则，您将面临日志记录功能失败导致应用程序瘫痪的风险。对于您的方案，这可能会或可能不会接受。

# wml - 调用时未检测到 WMLS 文件

> ID：15317103
> 
> 赞同：0
> 
> 时间：2013-03-09T23:25:41.250
> 
> 标签：wml

我在同一个目录中有一个 wml 和 wmls 文件，我正在使用 winwap 运行我的脚本。

在我的 wml 文件中，我以下列方式调用 wmls 文件中的函数

```
<a href="validateForm.wmls#validate()">Submit Form Data</a> 
```

我名为 validateForm.wmls 的 wmls 文件具有以下功能

```
extern function validate() 
```

我不断收到此错误，即找不到 wmls 的文件位置

1）我将这两个文件保存在同一个文件夹中 2）在声明中文件名似乎正确

我不确定为什么会发生此错误。任何帮助，将不胜感激 。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-08T15:12:41.020

你编译你的 WMLScript 了吗？，通常你应该从编译的版本中调用它

```
<a href="validateForm.wmls**c**#validate()">Submit Form Data</a> 
```

此外，如果您的设备支持本地存储并且您在本地下载了文件，那么指定路径（在运行 POSWEB、VERIWEB 和类似设备的设备中）很有用：

```
<a href="**f:**validateForm.wmls**c**#validate()">Submit Form Data</a> 
```

如果不是，则可能是浏览器正在从缓存或其他位置加载文件。

希望对你有帮助，我很久以前就遇到过这个问题。

# ruby-on-rails - 使用 simple_form，如何以 DRY 方式在另一个控制器的视图上呈现“新”表单？

> ID：15317107
> 
> 赞同：0
> 
> 时间：2013-03-09T23:26:00.377
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我有一个`_form.html.erb`部分，我的`DailyEntry`模型看起来像这样：

```
<%= simple_form_for(@daily_entry) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :breakfast %>
    <%= f.input :snack_1 %>
    <%= f.input :lunch %>
    <%= f.input :snack_2 %>
    <%= f.input :dinner %>
    <%= f.input :water_intake %>
    <%= f.input :workout %>
    <%= f.input :notes %>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %> 
```

每个都`DailyEntry`属于一个`User`...即每个`daily_entry`记录都有一个`user_id`列。

我希望`current_user`能够`daily_entry`从`Home#Index`页面添加一个 - 无需复制`create`我的`DailyEntry`控制器的操作。

那么如何用一块石头杀死两只鸟呢？即将新创建的`daily_entry`记录分配给当前用户，然后这一切都由我完成`views/home/index.html.erb`？

**编辑 1**

我知道如何将每条记录分配给用户......在`DailyEntry`控制器`create`操作中，我有这个：

```
def create
  @daily_entry = current_user.daily_entries.create(params[:daily_entry])

respond_to do |format|
  if @daily_entry.save
    format.html { redirect_to @daily_entry, notice: 'Daily entry was successfully created.' }
    format.json { render json: @daily_entry, status: :created, location: @daily_entry }
  else
    format.html { render action: "new" }
    format.json { render json: @daily_entry.errors, status: :unprocessable_entity }
  end
 end
end 
```

我只是不确定如何从我的`Home#Index.html.erb`. 如何在不复制控制器逻辑的情况下呈现此表单`HomeController`？

**编辑 2**

我也试过这个：

```
<%= render partial: "daily_entries/form", @daily_entry => current_user.daily_entries.build  %> 
```

但我仍然收到此错误：

```
NoMethodError at /
undefined method `model_name' for NilClass:Class 
```

在线：

```
<%= simple_form_for(@daily_entry) do |f| %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T23:48:17.513

daily_entries 控制器上的`create`操作是表单操作指向的位置，这不会改变。

要在索引页面上呈现表单，您所要做的就是`@daily_entry`在 home_controller 中构建对象：

```
# home_controller.rb
def index
    @daily_entry = DailyEntry.new
end

# home/index.html.erb
<%= render "daily_entries/form" %> 
```

# php - 为什么我不能从 event_member 表中检索数据？Facebook

> ID：15317113
> 
> 赞同：0
> 
> 时间：2013-03-09T23:27:12.067
> 
> 标签：php, facebook, facebook-fql

由于某种原因，我的代码不起作用，我不确定为什么。这种格式适用于其他表，但是当我尝试从 event_member 表中检索事件 ID 时，它没有返回任何内容。有什么我做错了吗。我知道我参加了几个活动，所以它必须返回它们。

```
require_once 'facebook.php';    //Facebook class

$Facebook = new Facebook($config);                  //Initialize Facebook
$fb = $Facebook->getUser();                             //Get the user

//Authorize the user
if ($fb)
{
    try 
    {
        $user = $Facebook->api('/me');
    } 
    catch (FacebookApiException $e) 
    {
        echo "There was an unexpected error. Please contact us.";
        $fb = null;
    }
}

try
{
    $fql = "SELECT eid FROM event_member WHERE uid = me()";
    $param = array('method' => 'fql.query', 'query' => $fql, 'callback' => '');

    $result = $Facebook->api($param);

    foreach ($result as $row)
    {
        echo $row["eid"] . "<br/>";
    }
}
catch (FacebookApiException $e) 
{
  echo $e;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:47:52.137

> 要读取 event_member 表，您需要：非公开活动的**user_events权限或查看用户正在参加的所有活动**

*来源：* [https ://developers.facebook.com/docs/reference/fql/event_member/](https://developers.facebook.com/docs/reference/fql/event_member/)

* * *

[如何在 PHP 中请求权限：](https://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/)

```
$params = array(
  'scope' => 'read_stream, friends_likes',
  'redirect_uri' => 'https://www.myapp.com/post_login_page'
);

$loginUrl = $facebook->getLoginUrl($params); 
```

# html - CSS/PHP - 用 Hover 和 If 语句覆盖图像

> ID：15317114
> 
> 赞同：-1
> 
> 时间：2013-03-09T23:27:38.930
> 
> 标签：html, css

我目前正在为客户创建一个 Minecraft 服务器列表页面。然而，我被困在一件事上，这是我以前没有做过的。请看这张图片（对不起油漆的使用。我很着急！）

![](../Images/789445e7e9748de83b578d8ac35b5240.png)

基本上，“正常”图像在悬停时会变为“悬停”图像。我可以做到这一点，但是，看到那些向上和向下箭头，以及 45/90？我将需要它们根据 PHP 查询接收到的内容进行更改。我已经准备好了所有的 PHP。它目前看起来像这样：

![](../Images/8dc5e7d7ebb9a874085de1ae6bc87ed8.png)

您可以在那里在线看到箭头和玩家，但是我希望它们位于图像之上，并且仍然可以更改 PHP 反馈的内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:25:52.103

我认为你是从一个有点*低效*的角度来处理这个问题，即使不是完全错误的。据我了解，您有图像在悬停时进行交互，但是您要做的所有事情都可以通过简单使用 CSS 和类来完成，然后混合您的 PHP 进行数据检索。

你当然可以用图像来做，如果你真的需要它，我可以告诉你怎么做；但我认为您可能会考虑其他解决方案。

`[**Here is a demo**](http://jsbin.com/uzuyok/1)`

以下是一些改进方法的建议：

1.  将您的主图像显示为一个`background-image`而不是一个`img`元素。通过这种方式，它打开了**通过 CSS 交换它**的可能性，即使我们在这个例子中不需要它。

2.  使用箭头以及*绝对定位*`background-image`的元素。也许考虑通过使用一些图像替换技术来提高可访问性。

**   在将显示在`:hover`父元素上的附加覆盖元素上显示您的附加信息，并带有`rgba background-color`. 如果你想提高浏览器的兼容性，你可以回退到通过 CSS完全改变`background-image`父级，如*(1.)*中所述。`div`

    **   通过使用简单的条件语句更改 (2.) 中描述的元素的类，通过 PHP 变量和箭头显示您的文本。** 

 **## PHP/HTML

```
<div class="server">
    <div class="overlay">
      <h1><span>Hunger games</span><small>HG1.Play-Minezone.co</small></h1>
      <div class="more-info">
        <p>Hunger games is a full-out hardcore PvP experience, with only one
           winner. The objective of the game is to be the last one standing.
           Will you team with others, go solo, and conquer the battlefield?</p>
        <p>Only you are left to decide</p>
      </div>
        <div class="arrow <?php echo $serverUp ? 'up' : 'down'; ?>"><!-- You may
            want some info here to make it more accessible, and perhaps hide it
            by using some image replacement technique --></div>
        <div class="numbers"><?php echo $numbers; ?></div>
    </div>
</div> 
```

## CSS

我在这里放了一些基本的*css*，在我的例子中我使用了更多的样式，但是你可以自由地检查一下。

```
.server {
  background: url('/yourimage.jpg') center no-repeat; // Place here your
                                                      // main image
  width:  300px;
  height: 300px;
  overflow: hidden;
  position: relative;
}

.server:hover .overlay{ 
   background-color: rgba(0,0,0,0.5); // Rgba goes here, if you prefer, use an
                                      // image with the effect already achieved
}

.server:hover .more-info{ 
  display: block;
}

.overlay{ 
  position: absolute;
  height: 100%;
  width: 100%;
}

.more-info{ 
  display: none;
  width: 100%;
}

.numbers{ 
  position: absolute;
  bottom: 10px;
  right: 5px;
}

.arrow{ 
  width: 40px;
  height: 40px;
  position: absolute;
  bottom: 10px;
  left: 5px;
}

.arrow.up{ 
  background-color: green;  // In your case you would have background-image
                            // for your green arrow image here
}

.arrow.down{ 
  background-color: red;    // See above, but for red arrow
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:55:49.117

Your image will need to be in a parent node, probably a DIV, with the position of relative. The arrow will have the position of absolute sitting on top of the image. You will need to set the x and y value of the arrow. Now the CSS should work fine based on a class. For example:

`<div class="rel-wrapper <?php $showRed ? 'show-red' : 'show-green'; ?>">`

`<img src="..." />`

`<img src="..." class="arrow" />`

`</div>`

`.rel-wrapper .arrow { display:none; }`

`.show-red:hover .arrow { display:block; }`

`.show-green:hover .arrow { display:block; }`**

# django - Django 支持多少个来自同一帐户的并发登录？

> ID：15317115
> 
> 赞同：1
> 
> 时间：2013-03-09T23:27:39.667
> 
> 标签：django, login

我发现了几个关于在 Django 中限制来自同一用户的并发多个登录的问题，但我正在寻找的是相反的。我想要一个“通用来宾”用户，几个人可以登录并访问特定功能。有实际限制吗？您认为这种方法有什么重大问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:23:22.723

如果您询问多个用户共享同一个帐户甚至会话，这是一个非常糟糕的主意。你看过[django-guest](http://code.google.com/p/django-guest/)吗？它允许来宾用户帐户，并且是您正在寻找的。它提供了两个装饰器，`guest_allowed`可以`login_required`应用于您的视图。因此，用户可以将其视为“通用访客”，而您仍然可以控制并跟踪他们。

Django 也有 `class models.AnonymousUser' 但这只是给未登录用户的状态，也许是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T01:10:10.763

这是我的做法：

创建一个多页表单。

1.  第 1 页 - 调查密码（验证器/清除方法以确保输入的密码有效）
2.  第 2 页 - 调查问题

使用 Django 的表单向导：[https ://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/](https://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/)

向导显示第 1 页，并且在用户正确回答第 1 页（即密码）之前，不会让用户进入第 2 页。这样，除非用户拥有有效密码，否则他们无法参加调查。

该解决方案不使用 django 的身份验证，应该让您了解所有阻碍您前进的会话内容。

# python - 将数据插入文本文件python

> ID：15317117
> 
> 赞同：0
> 
> 时间：2013-03-09T23:28:00.750
> 
> 标签：python, insert, text-files

我想知道如何使用 python 将变量的内容插入到文本文件中？我对此很陌生，所以我会很感激一些帮助。这是我的代码：

```
a,b = raw_input('Enter in format number^power').split('^')
a = int (a)
b = int (b)
result = a**b
with open("test34.txt", "a") as myfile:
    myfile.write("result")
print ("Done!")
raw_input() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T23:31:11.780

```
myText = 'hello python'
with open('myTextFile.txt', 'w') as myFile:
    myFile.write(myText) 
```

`myTextFile.txt`这将在与您的脚本相同的目录中创建一个名为的文件并将字符串写入`hello python`其中

你的例子有一些错误。这是它的工作版本：

```
a,b = raw_input('Enter in format number^power').split('^')
a = int (a)
b = int (b)
result = a**b
with open("test34.txt", "a") as myFile:
    myFile.write(str(result))
print ("Done!")
raw_input() 
```

我从行中删除了引号`myFile.write("result")`。此外，您已在“附加”模式下打开文件 ( `open('test34.txt', 'a')`)。这意味着程序将在文件末尾添加您的输出，而不会删除文件中之前的内容。这可能是也可能不是您所期望的。如果您希望程序先删除旧文件然后写入输出，则必须以“写入”模式打开文件：`open('test34.txt', 'w')`

# c++ - 创建库时的 GCC C++ 链接提升

> ID：15317121
> 
> 赞同：2
> 
> 时间：2013-03-09T23:28:28.843
> 
> 标签：c++, gcc, boost, static

我想我的问题是在创建档案时静态链接到 Boost 的正确方法是什么，当 Boost 刚刚编译并存储在我的主目录中，而不是在系统中？将我的程序创建为库背后的想法是，我将能够重新分发库文件以供其他人在他们的程序中链接。

我想制作一个可以在 Linux 上链接的 C++ 库文件。我真的不在乎它是静态的还是动态的，但静态可能会让我更容易。

我遇到的问题是我找到的示例没有告诉您如何链接库中的其他库。我的库使用 Boost，并且我已经构建了 Boost，但我无权将其移出我的用户区域。

我试过制作这样的静态存档：

**编译 cpp 文件：**

g++ -O3 -ffast-math -Wall -Wextra -g -I./ -I../../boost/ -c BuddyManager.cpp -o build/BuddyManager.o

**创建静态存档：**

ar rcs build/libppmi.a ../../boost/lib/libboost_system.a build/Application.o build/DataBlock.o *（等等，我的所有目标文件都在后面列出）*

但是当我稍后链接到我创建的 .a 文件时，它会给出未定义的参考错误。

我设法通过在 Mac 上构建共享库 SO 文件来创建我的库，但在该系统上，Boost 安装在标准系统位置。当我在 Linux 上构建共享库时，我收到错误“/usr/lib/crtbegin.o 中的隐藏符号 `__dso_handle' 被 DSO 引用”并且我经常遇到无法找到 Boost .SO 文件的问题。因此，我决定更改为静态链接。

该系统在 Scientific Linux SL 版本 5.3 (Boron) 上运行，我使用的是 gcc-4.6.2。但是，我希望它可以移植到几乎所有版本的 GCC。

谢谢。如果有任何不清楚或您想了解更多详细信息，请询问。

## 一些缺失的参考资料是：

对`boost::thread::interrupt()'的未定义引用

boost/boost/thread/pthread/thread_data.hpp:247: 未定义引用`boost::this_thread::hiden::sleep_until(timespec const&)'

boost/boost/archive/detail/iserializer.hpp:158: 未定义对 `boost::archive::detail::basic_iserializer::~basic_iserializer()' 的引用

他们似乎都在Boost中。它找不到应该在 Boost 档案中的参考资料。

## 有关更多信息，这是我正在编译的内容：

ar rcs build/libppmi.a ../../boost/lib/libboost_system.a ../../boost/lib/libboost_iostreams.a ../../boost/lib/libboost_serialization.a ../. ./boost/lib/libboost_thread.a build/Application.o build/DataBlock.o build/Iteration.o build/Launcher.o build/Message.o build/Network.o build/Processes.o build/DataBlockManager.o build /Communicator.o build/NetworkServer.o build/NetworkClientSession.o build/NetworkMessage.o build/NetworkConnection.o build/Threadable.o build/BuddyManager.o

这工作正常。当我使用它的存档时，它会中断。我也尝试过从 boost 库中提取 .o 文件，但这会导致其他有关 pthread 库的链接器错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T22:43:41.137

您正在创建档案档案，但是当链接器在档案中查找时，它需要目标文件。链接器将查找`libppmi.a`并跳过所有非目标文件，包括`libboost_system.a`，因为它不知道如何处理它们，因此不会找到任何 Boost 符号。您可以通过链接来确认这一点`-t`（如果您正在链接使用`gcc`或`g++`然后使用`-Wl,-t`传递`-t`到链接器），它会在链接器处理它时打印每个文件的名称，并且您会看到它不处理嵌套档案.

如果您想在存档中包含所有 Boost 代码，那么您需要列出各个对象（通过在构建 Boost 的地方直接引用它们或从 Boost 存档中提取它们然后将它们添加到新存档中。）

> 这工作正常。当我使用它的存档时，它会中断。

当然，它所做的一切都会创建一个包含您列出的文件的存档。创建存档只需将大量单独的文件放入一个大文件中，您可以将任何文件类型放入其中。它不会真的出错，但这并不意味着结果是正确的或可用的。

> 我也尝试过从 boost 库中提取 .o 文件，但这会导致其他有关 pthread 库的链接器错误。

这是正确的方法，但是您遇到了不同的问题，因此请解决该问题，而不是放弃该方法。如果您使用的是 Boost.Thread，那么您需要编译和链接`-pthread`

# android - 带有while循环的Android DB行删除（）

> ID：15317123
> 
> 赞同：0
> 
> 时间：2013-03-09T23:28:43.633
> 
> 标签：android, sqlite, boolean, delete-row

我已经拿起了我正在尝试理解并在我的应用程序中工作的这段代码，它应该从父表中删除一行，而子表上的任何行也与之相关while 循环中的一个错误，我理解这个错误，但不完全理解这个人是如何让它工作的

```
public boolean removeRow(int paramInt, String paramString)
{
  int i = 1;
  if (paramString.equals("nameTable"))
  {
   SQLiteDatabase localSQLiteDatabase1 = this.db;
    String str1 = "name_ref_ID=" + paramInt;
    int j = localSQLiteDatabase1.delete("itemTable", str1, null);
    SQLiteDatabase localSQLiteDatabase2 = this.db;
    String str2 = "names_id=" + paramInt;
    if (localSQLiteDatabase2.delete(paramString, str2, null) <= 0);
  }
  while (true)
  {
    return i;// shows errror here as its not returning a bool
    i = 0;
    continue;
    if (paramString.equals("itemTable"))
    {
      SQLiteDatabase localSQLiteDatabase3 = this.db;
      String str3 = "item_id=" + paramInt;
      if (localSQLiteDatabase3.delete(paramString, str3, null) > 0)
      continue;
      i = 0;
      continue;
    }
    i = 0;
  }
} 
```

对我来说，返回似乎不合适，并且会阻止执行循环的其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:47:09.267

我不确定代码将如何为您从那里得到它的人工作，因为他正在返回我女巫是一个 INT 并且他的函数声明他应该返回一个布尔值（这就是 eclipse 给你错误的原因）。

此外，该函数将在返回后立即停止运行。因此，当 while 循环开始时，它将立即停止。还要记住，while(true) 循环并不是很好的做法。基本上，您创建了一个无限循环并使用一些技巧再次打破它。

要删除子表的一行和所有行，我建议使用两个查询。首先对子表执行删除查询，同时对 where 语句使用[内部查询](http://www.w3resource.com/sql/subqueries/understanding-sql-subqueries.php "内部查询")。然后在您的父表上再次删除。

# google-apps-script - ScriptDb 递减查询

> ID：15317127
> 
> 赞同：0
> 
> 时间：2013-03-09T23:29:31.910
> 
> 标签：google-apps-script

我有一个存储大量数据的功能，然后在存储更多数据之前检查该数据是否重复。为每个重复检查查询数据库会导致脚本超过最大执行时间，因此查询整个数据库，然后只检查该查询。问题是，当我运行重复检查时，查询大小在第 4 次通过时减小到零，使其无效。这是存储功能和重复检查的代码：

```
function ssToScriptDb_1() {
  var spreadsheet = SpreadsheetApp.openById('0Ah1c1zmu5vU_dEZJYVMzVnF6Y211cmJGdjZBUGFLQWc');  // **** create a function to prompt for the ID
  var sheet = spreadsheet.getActiveSheet();
  var columns = spreadsheet.getLastColumn();
  var data = sheet.getDataRange().getValues();
  var keys = data[0];
  var db = ScriptDb.getMyDb();
  var allDb = db.query({});
  var items = [];
  for (var row = 1; row < data.length; row++) {
    var rowData = data[row];
    var item = {};
    for (var column = 0; column < keys.length; column++) {
      item[keys[column]] = rowData[column];  // ???? could I use this notation in place of the double for loops in timeClock?
    }
    item.visitDate = Utilities.formatDate(item.visitDate, "MST", "M/d/yyyy");

    // check to see if the item is already in the db
    if (dupCheck(db, allDb, item)) {
      items.push(item);
    }
    if (row % 1000 == 0) {
      Logger.log("row " + row + " completed at " + new Date() +"\n");
    }
  }

  var itemsLen = items.length;
  Logger.log('DB save start time ' + new Date() + '\n');
  var results = db.saveBatch(items, false);
  Logger.log('DB save end time ' + new Date() + '\n');
}

function dupCheck(db, query, item) {
  var count = 0;
  var querySize = query.getSize();
  var query2Size = db.query({}).getSize();
  while (query.hasNext()) {
    var ob = query.next();
    if (ob.ID == item.ID && ob.email == item.email && ob.visitDate == item.visitDate) {
      return false;
    }
    count++;
  }
  return true;
} 
```

调试中的第一次通过`dupCheck()`如下所示： ![dupCheck() 通过 1](../Images/d684cb8621dedb897cfcd8d0f59f7578.png)

请注意，这`querySize`是在进入之前完成的查询，`dupCheck()`并且 query2Size 是在里面完成的相同查询`dupCheck()`。

这是第二次通过`dupCheck()`： ![dupCheck() 通过 2](../Images/0f6c149e86fbfd5d487b029c6ea252ed.png)

这是第四遍： ![dupCheck() 通过 4](../Images/e8b6f53079aa47975ae4a83e5d79a076.png)

再次注意`querySize`vs `query2Size`。

我不知道是什么导致原始查询减少，但我不能为每个项目调用查询，知道是什么原因造成的或有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T05:38:37.543

我想到了。我没有意识到`query.next()`正在改变查询。为了实现我所需要的，我将查询结果放在一个数组中，并针对该数组检查重复项。

# c++ - C++ 中的字节到字节

> ID：15317130
> 
> 赞同：-1
> 
> 时间：2013-03-09T23:29:45.710
> 
> 标签：c++, byte, bits

我试着：

1.  将一组 8 个整数（均为 0 或 1）转换为一个字节
2.  反转该字节的位顺序
3.  打印该字节的值（以什么格式？）（我可以猜到，直到我在这里得到它）

另外，我不允许使用 STL 来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:03:50.253

因此，您想要反转字节中的位。也就是说，位应该这样移动：

```
from: 7 6 5 4 3 2 1 0
to:   0 1 2 3 4 5 6 7 
```

这段代码会做的很不优雅——如果你搜索的话，你会找到更好的算法。你能看到它是如何工作的吗？

```
uint8_t reverse_bits(uint8_t byte)
{
    return ((byte & 0x01) << 7)
          |((byte & 0x02) << 5)
          |((byte & 0x04) << 3)
          |((byte & 0x08) << 1)
          |((byte & 0x10) >> 1)
          |((byte & 0x20) >> 3)
          |((byte & 0x40) >> 5)
          |((byte & 0x80) >> 7);
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-09T23:36:27.117

一种简单的方法是屏蔽其余位，正如您在[读取单个位的方式中](http://www.microchip.com/forums/m287351.aspx)看到的那样。

# bash - 测试中的 BASH 错误 [[ ]]

> ID：15317132
> 
> 赞同：1
> 
> 时间：2013-03-09T23:30:00.150
> 
> 标签：bash, shell

我希望能够验证某些东西是 bash 脚本中的 IP 形式，并且我在网上找到了各种代码......它们都具有大致相同的结构..

```
#!/bin/bash

valid_ip()
{

    local  ip=$1
    echo $ip

    if [[ $ip =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
        ret=0 # is an IP
    else
        ret=1 # isn't an IP
    fi

    return $ret

}

# SCRIPT -------------------------------------

#clear the table
ipfw table 1 flush

ips=$(dig -f ./hostnames.txt +short)

# For each of the IPs check that it is a valid IP address
# then check that it does not exist in the ips file already
# if both checks pass append the IP to the file
for ip in $ips
do
    if valid_ip $ip; then 
        if grep -R "$ip" "~/Dropbox/ProxyBox Stuff/dummynet/ips.txt"; then 
                echo "$ip already exists"
            else
                echo $ip >> ips.txt

        fi
    fi

done

# get the IP's and add them to table 1
cat ips.txt | while read line; do
ipfw table 1 add $line
done 
```

无论如何，我收到以下错误

```
./script.sh: 18: ./script.sh: [[: not found 
```

我不明白为什么我不能完成这个测试......任何帮助将不胜感激。

我用

```
sudo ./script.sh 
```

我相信使用 sudo 会导致问题，但我的脚本的其他部分需要 sudo p。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:19:18.097

尽管`[[ ... ]]`自第一个版本以来的所有版本的 BASH 都进行了测试（`[[ ... ]]`取自 Kornshell），但您的 BASH 版本中可能存在一些 Bourne shell 兼容性设置。然而，我唯一能想到的就是编译没有`--enable-cond-command`. 试着输入这个：

```
$ /bin/bash -c help 
```

这将打印出一堆不同的帮助选项。旁边带有星号的那些表示您的 BASH 版本没有启用该内置命令。

最后，您可能必须找到一个替代这个内置...

尝试这个：

```
if echo "$ip" |  egrep -q "^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$" 
```

请注意，您根本不使用方括号或双方括号。

该`-q`选项确保该`egrep`命令不会打印出任何内容。相反，如果模式匹配，它将返回 0，如果不匹配，则返回 1。这将与`if`命令一起使用。这是我们在直接使用 Bourne shell 的日子里使用的方式，其中没有将正则表达式内置到 shell 中，我们不得不用石头凿出 shell 脚本，并拥有真正的 VT100 终端。

顺便说一句，在您的正则表达式中，`500.600.700.900`仍然会显示为有效的 IP 地址。

# wordpress - 更改了 Wordpress 博客的 URL，现在网站不显示页面

> ID：15317133
> 
> 赞同：0
> 
> 时间：2013-03-09T23:30:01.533
> 
> 标签：wordpress

所有，我在以下 URL 有一个 wordpress 网站：

[http://website.com/new_site/](http://website.com/new_site/)

我刚刚将所有文件上传到根文件夹，所以现在看起来像：

[http://website.com/](http://website.com/)

我阅读了 Wordpress Codex，并且已经将我的 Wordpress URI 和站点地址 URL 更新到了新站点。

我还尝试使用 Wordpress 推荐的以下脚本更新我的数据库表：http: [//interconnectit.com/products/search-and-replace-for-wordpress-databases/](http://interconnectit.com/products/search-and-replace-for-wordpress-databases/)

我对搜索字符串“/new_site/”进行了查找并替换为“/”，但我的所有页面都没有显示。有没有人对如何做到这一点有任何其他建议？我应该检查什么？

仅供参考，我的主页运行良好，只是不会显示我创建的任何其他页面。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:21:16.083

这是一个简单的修复。我只需要更新我的永久链接设置。一旦我这样做了，我的网站就很好用！

# iphone - 在后台录制时隐藏音频红条

> ID：15317135
> 
> 赞同：2
> 
> 时间：2013-03-09T23:30:14.393
> 
> 标签：iphone, ios, xcode

有没有办法在后台录音时隐藏红条？

我尝试在 plist 中添加 (key>UIBackgroundModes voip)，正如上一篇文章中提到的那样。但我的应用程序崩溃了。还有其他方法吗？

# python - 重新字符串位置列表生成器

> ID：15317138
> 
> 赞同：0
> 
> 时间：2013-03-09T23:30:22.593
> 
> 标签：python, regex, string, list, expression

所以我有一个这样的字符串：

```
'|item1|item2|item3|item4' 
```

从那个字符串，我想建立一个这样的列表：

```
['|item1','|item1|item2','|item1|item2|item3','|item1|item2|item3|item4'] 
```

它基本上寻找每个'|' 并从该位置返回前一个字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T23:32:30.370

无需使用正则表达式：

```
stack = []
result = []
for elem in inputstring.split('|'):
    if not elem: continue
    stack.append(elem)
    result.append('|' + '|'.join(stack)) 
```

产生：

```
>>> result
['|item1', '|item1|item2', '|item1|item2|item3', '|item1|item2|item3|item4'] 
```

您也可以使用生成器来执行此操作：

```
def generate_items(inputstring):
    stack = []
    for elem in inputstring.split('|'):
        if not elem: continue
        stack.append(elem)
        yield '|' + '|'.join(stack)

for item in generate_items(inputstring):
    print item 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T23:46:31.653

这个问题有一个列表解决方案：

```
out = []
for piece in items[1:].split('|'):
    out.append((out[-1] if len(out) else '') + '|' + piece) 
```

如果你喜欢生成器：

```
def generate_items(inputstring):
    curr = ''
    for item in inputstring[1:].split('|'):
        curr += '|' + item 
        yield curr 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T23:54:45.443

最简单的方法：

```
list(itertools.accumulate(re.findall('\|\w+', '|item1|item2|item3|item4'))) 
```

# android - 适用于 Android 和 Unity 的 UIToolkit

> ID：15317144
> 
> 赞同：1
> 
> 时间：2013-03-09T23:30:52.567
> 
> 标签：android, unity3d, gui-toolkit

我正在使用 UIToolkit 在 Unity 上为我的 android 游戏项目制作 GUI。示例场景（例如厨房水槽）在 Unity 编辑器上运行良好。但是当我在 android 设备上运行完全相同的示例场景时，它不起作用。Button Texture 与实际的 Touch Region 略有不同。我尝试了不同的 Android 设备，但结果是一样的。

我尝试使用类似的函数访问 Sprite Locations

```
public float getYpos(this IPositionable sprite )
{
    if(sprite == null)
        return ;
    float toRet = sprite.position.y;
    return toRet;
} 
```

但它的代码返回一个无值！

我什至尝试使用“IPositionablePositioningExtensions”并返回 Sprite 位置。但没有成功。虽然我不确定如何使用“IPositionablePositioningExtensions”，但我刚刚开始在这个领域入门。

我的按钮创建看起来像这样：

```
 playButton = UIButton.create("playUp.png", "playDown.png",0,0);
    playButton.positionCenter();
    playButton.scale = new Vector3(0.4f,0.4f,0); 
```

这是示例场景在 Android 设备上的屏幕截图。边界框是 Touch 工作的区域，而 Button 纹理正在其他地方渲染。

![在此处输入图像描述](../Images/83ac43a372b1bbcee9a54243ddc0539d.png)

Button 纹理应该位于中心位置，尽管它会移动到其他位置，而触摸区域仍保持在它应该在的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T05:35:44.993

找到了解决方案。onAwake 方法返回与实际屏幕尺寸不同的屏幕尺寸。

于是在 ui.cs 文件中的 uiCamera 中添加了如下代码

```
public static void setSize()
    {
        _uiCamera.orthographicSize = Screen.height / 2;
        // Set the camera position based on the screenResolution/orientation
        _uiCamera.transform.position = new Vector3( Screen.width / 2, -Screen.height / 2, -10.0f ); 
    } 
```

一旦设置了屏幕，就会调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T12:09:08.893

来自开发者网站上的指南：(...) 不要尝试在 Awake 中创建 UI，因为 UI 脚本可能尚未完成初始化。请改用开始。

编辑：我以为您是在 awake 方法中创建 ui，但我尝试了自己，即使我按照指南中的建议在 start 方法中创建它，我也遇到了同样的问题。现在我将测试您的解决方案。事实上，如果我更改场景并重新加载 UI 场景而不重新启动应用程序，一切正常。

# jsf - JAVA EE 6 集群和 webapp 映像

> ID：15317149
> 
> 赞同：0
> 
> 时间：2013-03-09T23:31:11.337
> 
> 标签：jsf, jakarta-ee, servlets, glassfish, java-ee-6

我正在使用 JAVA EE 6，更具体地说，Glassfish v3.1.2.2 开发应用程序。

以前，我曾经将用户上传的图像和文件放在我的数据库中。如果我想通过添加节点来集群化我的体系结构，这将更容易。

现在，我真的很想停止这样做，只需**将我上传的文件保存到我的资源文件夹**（出于多种原因[，例如 this](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)），这样一个简单的`<img>`或`<h:graphicImage>`有名字的就可以了。

我的问题是当我添加其他服务器时这是如何工作的？该文件只会保存到处理请求的服务器的资源文件夹中，其他服务器不会有它。

现在也许有人会建议使用分布式文件系统，这听起来很棒，除非您为您的应用程序租用一些托管/云服务并且您无法真正选择您的文件系统。（可能有其他原因阻止您转向此设置）

**JAVA EE 是否提供任何透明同步资源文件夹的方式？**JSF 已经处理了它的版本控制和管理库等，我是否可以设置一些配置，以便我的所有服务器通过任何文件更改/上传来保持它们的资源文件夹是最新的？

如果没有，有什么替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:38:20.853

Java EE 不提供在集群的公共文件夹中同步图像的方法，您的应用服务器可能对此提供支持，但我不知道应用服务器中有任何此类解决方案。

根据您的情况，我将使用 NFS 服务器并保留 NFS 服务器目录上的文件可从所有集群访问。

如果您不允许更改硬件设置，那么您可以创建一个 Web 服务器来托管资源，并且您可以从所有集群访问您的资源，例如，

`<h:graphicImage value="http://myimageserver.local.com/sitename/foldername/xyz.gif"/>`在您的所有集群上。

# android - 数据库锁 NPE

> ID：15317151
> 
> 赞同：0
> 
> 时间：2013-03-09T23:31:45.690
> 
> 标签：android, android-sqlite

我想知道你是否可以帮助我解决我遇到的这个错误......

## 源代码：

主.java：

```
public class Main extends Activity {
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        context = this;

        DBAdapter dbA = new DBAdapter(context);
        dbA.open();    // error at this statement
            // [....]
    }
} 
```

DBAdapter.java

```
public class DBAdapter {
    Context context;

    DatabaseHelper DBHelper;
    SQLiteDatabase db;

    public DBAdapter(Context ctx) {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }
    private static final class DatabaseHelper extends SQLiteOpenHelper {
        private static Context context;

        DatabaseHelper(Context ctx) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
            context = ctx;
        }

        onCreate(SQLiteDatabase db) //  this line of code is never reached [...]
        // {...}
        onUpgradeonUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) // neither is this one [...]
        // {...}

    }

    // ---opens the database---
    public DBAdapter open() throws SQLException {
        db = DBHelper.getWritableDatabase();  // error at this statement
        return this;
    }
        // [...]
} 
```

## 日志猫

```
03-10 00:09:15.061: E/AndroidRuntime(5668): FATAL EXCEPTION: main
03-10 00:09:15.061: E/AndroidRuntime(5668): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.akiand.wnb/com.akiand.wnb.main.Main}: java.lang.NullPointerException
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2185)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2210)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.ActivityThread.access$600(ActivityThread.java:142)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1208)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.os.Looper.loop(Looper.java:137)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.ActivityThread.main(ActivityThread.java:4931)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at java.lang.reflect.Method.invokeNative(Native Method)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at java.lang.reflect.Method.invoke(Method.java:511)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at dalvik.system.NativeStart.main(Native Method)
03-10 00:09:15.061: E/AndroidRuntime(5668): Caused by: java.lang.NullPointerException
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.database.sqlite.SQLiteOpenHelper.getDatabaseLocked(SQLiteOpenHelper.java:224)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:164)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at com.akiand.wnb.db.DBAdapter.open(DBAdapter.java:179)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at com.akiand.wnb.main.Main.onCreate(Main.java:76)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.Activity.performCreate(Activity.java:5008)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1090)
03-10 00:09:15.061: E/AndroidRuntime(5668):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2139)
03-10 00:09:15.061: E/AndroidRuntime(5668):     ... 11 more 
```

我找不到从 SQLiteOpenHelper.getDatabaseLocked(SQLiteOpenHelper.java:224) 弹出错误的任何参考

非常感激您的帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T23:57:01.300

我认为错误在

```
super(context, DATABASE_NAME, null, DATABASE_VERSION); 
```

你传递了空上下文。

将其更改为

```
super(ctx, DATABASE_NAME, null, DATABASE_VERSION); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T23:45:05.267

查看右大括号：

```
 private static final class DatabaseHelper extends SQLiteOpenHelper {
    private static Context context;

    DatabaseHelper(Context ctx) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        context = ctx;
    }

            onCreate // this line of code is never reached [...]
            onUpgrade // neither is this one [...]

    } 
```

您引用的两行在任何方法之外，永远不会被执行。

# java - SVGPath LinkedList 上的 java.lang.NullPointerException

> ID：15317153
> 
> 赞同：0
> 
> 时间：2013-03-09T23:31:54.490
> 
> 标签：java, svg, linked-list, javafx-2

我创建了一个 SVGPath LinkedList 但是，当我遍历这个列表时，我得到了`java.lang.NullPointerException`. 这是一个简单的 LinkedList，大小为 9。在这里你可以看到下面的代码。

```
public class RiskControllerClass implements Initializable {

    @FXML
    private SVGPath NA_1; // Alaska

    @FXML
    private SVGPath NA_2; // NorthWest_Ter

    @FXML
    private SVGPath NA_3; // Greenland

    @FXML
    private SVGPath NA_4; // Quebec

    @FXML
    private SVGPath NA_5; // Ontario

    @FXML
    private SVGPath NA_6; // Alberta

    @FXML
    private SVGPath NA_7; // E_America

    @FXML
    private SVGPath NA_8; // W_America

    @FXML
    private SVGPath NA_9; // C_America

    private LinkedList<SVGPath> regions = new LinkedList<>();

    private String nodeID;

    public RiskControllerClass() {

        regions.add(NA_1);
        regions.add(NA_2);
        regions.add(NA_3);
        regions.add(NA_4);
        regions.add(NA_5);
        regions.add(NA_6);
        regions.add(NA_7);
        regions.add(NA_8);
        regions.add(NA_9);

        System.out.println("Length : " + regions.size());

                for (Iterator<SVGPath> iter = regions.iterator(); iter.hasNext();) {
                    SVGPath sVGPath = iter.next();

                    System.out.println(sVGPath.getId());
                }

    } 
```

当我尝试仅打印 sVGPath 时，`System.out.print(sVGPath)`它会打印所有值`null`。但是，当我打印列表的大小时，它会给出 9 ！怎么可能？如果您能提供帮助，我将不胜感激，无论如何，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:39:08.473

简短回答：A`java.util.LinkedList`可以包含`null`条目。

详细答案：您的代码在类的构造函数中，因此某些框架（FXML）几乎不可能将值放入`NA_1`, `NA_2`, ..., `NA_9`。因此，您现在将九个未初始化的字段添加到您的`LinkedList`. Java 中未初始化的字段总是`null`. 因此，您的列表包含 9 个元素，所有这些元素都是`null`.

# html - 链接在浏览器中消失

> ID：15317156
> 
> 赞同：1
> 
> 时间：2013-03-09T23:32:36.867
> 
> 标签：html, hyperlink, firebug

你能帮忙解决这个问题吗：

```
<a target="_top" href="http://reversevincheck.com/?hop=asdas&price_type=&tid=asda">
<img src="http://reversevincheck.com/view/img/banners/160x600.gif">
</a> 
```

当我将此链接放在页面上时，它会消失！

这是火芽显示的内容：

![在此处输入图像描述](../Images/2010f5b2634c70069ffc174e7b346efb.png)

我认为图像有问题。但是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T23:57:53.347

在 Firebug 中，大多数情况下，灰色元素意味着某些东西正在将其设置为`display: none`或`visibility: hidden`。我无法在本地重现该问题。

因为“横幅”一词在您的图像路径中，并且随机的文本字符串作为类名，所以请确保您关闭了所有广告拦截器（或任何可能修改 HTML 的扩展程序）。

# android - Android 调节器第一次后无法正常工作

> ID：15317157
> 
> 赞同：45
> 
> 时间：2013-03-09T23:32:41.193
> 
> 标签：android, android-layout, android-edittext, android-softkeyboard

我的问题：从第二次在屏幕上显示软件键盘开始，它完全隐藏了我的 EditText。

android:windowSoftInputMode="adjustPan" 属性已在 AndroidManifest.xml 中指定，但仅在第一次有效。

我有以下布局：

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="464dp"
        android:gravity="top"
        android:orientation="vertical"
        android:paddingLeft="16dp"
        android:paddingRight="16dp" >

        <ListView
            android:id="@+id/list"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="10"
            android:background="#E3E3E2"
            android:gravity="top" />

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <EditText
                android:id="@+id/addListText"
                android:layout_width="0dp"
                android:layout_height="48dp"
                android:layout_weight="10"
                android:contentDescription="@string/addItemContentDescription"
                android:gravity="bottom|center_horizontal"
                android:inputType="textLongMessage"
                android:textColor="#E3E3E2"
                android:visibility="gone" />

            <ImageButton
                android:id="@+id/addTextListButton"
                android:layout_width="0dp"
                android:layout_height="48dp"
                android:layout_weight="1"
                android:layout_gravity="right"
                android:background="@android:color/transparent"
                android:contentDescription="@string/addItemButton"
                android:scaleType="fitCenter"
                android:src="@drawable/plus_add"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:gravity="bottom|center_horizontal"
        android:orientation="horizontal"
        android:paddingLeft="16dp"
        android:paddingRight="16dp" >

        <ImageButton
            android:id="@+id/syncListsButton"
            android:layout_width="64dp"
            android:layout_height="match_parent"
            android:src="@android:drawable/ic_popup_sync" />

        <ImageButton
            android:id="@+id/showOrHide"
            android:layout_width="64dp"
            android:layout_height="match_parent" />

        <ImageButton
            android:id="@+id/delListButton"
            android:layout_width="64dp"
            android:layout_height="match_parent"
            android:src="@android:drawable/ic_menu_delete" />
    </LinearLayout>
</LinearLayout> 
```

“showOrHide”按钮显示/隐藏“addListText”/“addTextListButton”组合。

当第一次显示 EditText 并且我触摸它时，屏幕上出现软键盘，并且“addListText”/“addTextListButton”组合被正确平移。当我隐藏键盘然后再次显示时，键盘完全覆盖了我的 addListText 编辑框！

知道发生了什么吗？我正在 Android 4.2.2 上对其进行测试。

请帮忙！谢谢 ：-）

**编辑：**我也尝试将第一个 LinearLayout 放在 ScrollView 中，但它不起作用！

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2014-09-24T12:34:54.133

这可能看起来有点傻，但是当我将 EditText 的属性重力设置为“center_horizo​​ntal”或“c​​enter”时遇到了这个问题。使用 textAlignment 'center' 时也会出现同样的问题。删除它，当键盘出来时，您将不会遇到键盘第二次（以及后续）隐藏 EditText 的问题。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-04-09T07:51:05.190

子类化 EditText 并重写 onKeyPreIme(int keyCode, KeyEvent event) 方法，如下所示：

```
 @Override
   public boolean onKeyPreIme(int keyCode, KeyEvent event)
   {
      if(keyCode == KeyEvent.KEYCODE_BACK)
        {
            clearFocus();
        }
   return super.onKeyPreIme(keyCode, event);
   } 
```

现在当按下返回键时，EditText 失去了焦点。然后再次点击它，调整盘将起作用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-04-12T19:09:43.823

您遇到的问题现在是一个已知的平台错误，如下所述：[https ://code.google.com/p/android/issues/detail?id=182191](https://code.google.com/p/android/issues/detail?id=182191)

该修复不会向后移植，因此在 Android N 之前不会生效。在 Android N 成为您的最低 SDK 之前，以下解决方案是一种解决方法。

您可以创建一个扩展 EditText 的自定义类并覆盖 onKeyPreIme(int keyCode, KeyEvent event) 方法，如下所示：

```
@Override
public boolean onKeyPreIme(int keyCode, KeyEvent event)
{
   if(keyCode == KeyEvent.KEYCODE_BACK)
     {
         clearFocus();
     }
return super.onKeyPreIme(keyCode, event);
} 
```

您还应该确保更高级别的布局能够获得焦点，以便可以成功清除 EditText 的焦点。以下属性可能对您有用：

```
android:descendantFocusability="beforeDescendants"
android:focusableInTouchMode="true" 
```

现在当按下返回键时，EditText 失去焦点。然后，当您再次点击该按钮时，adjustpan 将按预期工作。（由于编辑被拒绝，因此作为答案发布。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-05T16:18:12.457

对我来说，压倒一切`onKeyPreIme`是行不通的。所以我改写`dispatchKeyEventPreIme`了。

```
@Override
public boolean dispatchKeyEventPreIme(KeyEvent event) {
    if(event.getKeyCode() == KeyEvent.KEYCODE_BACK){
     clearFocus();
    }
    return super.dispatchKeyEventPreIme(event);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-07T02:55:43.410

这是我最初使用的遇到此问题的代码：

```
 <EditText
        android:layout_width="250dp"
        android:layout_height="wrap_content"
        android:gravity="center" /> 
```

当我从 EditText 中删除中心重心线时，平移工作：

```
android:gravity="center" 
```

我通过将 EditText 包装在 FrameLayout 中并将整个 EditText 居中在 FrameLayout 中来解决它。它导致的一个问题是 EditText 将至少是提示文本的宽度，因此键入的前几个字符/单词不会居中。这对我来说很好，但你的里程可能会有所不同:)

```
<FrameLayout
    android:layout_width="250dp"
    android:layout_height="wrap_content">

    <EditText
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center" />
</FrameLayout> 
```

编辑：如果用户单击编辑文本中的最后一个单词，则此解决方法会中断。我现在正在使用 onKeyPreIme 解决方法

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-03T12:11:20.167

在 EditText`android:layout_gravity="center"`中创建此类问题。如果你想文本成为中心，那么你可以这样做

Step1：布局

```
 <LinearLayout
                android:id="@+id/linerPassword"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_toRightOf="@+id/imageView2"
                android:gravity="center">

                <EditText
                    android:id="@+id/editText2"
                    android:layout_width="wrap_content"
                    android:layout_height="40dp"
                    android:background="@null"
                    android:hint="*****"
                    android:layout_marginLeft="-40dp"
                    android:paddingLeft="10dp"
                    android:paddingRight="10dp"
                    android:inputType="textPassword"
                    android:textColor="@color/white"
                    android:textColorHint="@color/white"
                    android:textSize="18sp" />
            </LinearLayout> 
```

step2：以编程方式进行一些事情

```
 linerUser.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.showSoftInput(mETUserName, 0);
            mETUserName.requestFocus();    
        }
    }); 
```

最后工作得很好。我找到了调整软键盘的解决方案

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-13T20:22:40.177

通常，当我们第一次按下后退按钮时，调整平移不起作用尝试以下方式：-（可以为 EditText、AutoCompleteTextView 或任何其他行为不端的视图实现）

```
 @Override
    public void onBackPressed() {
        editText.clearFocus();
        editText.setCursorVisible(false);
    } 
```

希望它可以帮助某人

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-25T13:14:18.457

在 Manifest 文件中尝试了许多解决方案后，我通过以下方式解决了，adjustPan 与相对布局不起作用，

您的父布局必须是 LinearLayout

希望这可以为人们节省一些时间。

# tree - 大 O 问题：一般树操作和相对复杂性

> ID：15317172
> 
> 赞同：0
> 
> 时间：2013-03-09T23:34:59.660
> 
> 标签：tree, complexity-theory, big-o

这实际上不是家庭作业，但我需要在课堂上理解这些概念。

> 在一般树中插入、查找和删除操作的最坏情况下的 Big-O 性能是什么？为什么会这样？

我不知道如何接近那个，因为一般树没有限制。

> 哪个增长更快，O(n^2*log(n)) 或 O(n^1.01)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T09:22:54.750

O(n ^(2 log n ) 比 O(n) ^(1.01) )增长得快得多。我假设对数的底是 2，就像许多树算法一样。

例如考虑 n=1024 的情况。

n ^(2 log n) = 1024 ^(2 * log 1024) =1024 ^(20) =1606938044258990275541962092341162602522202993782792835301376。

其中 n ^(1.01) =1024 ^(1.01) =1097.5

# javascript - 使用 javascript 更改页面状态

> ID：15317175
> 
> 赞同：0
> 
> 时间：2013-03-09T23:35:22.770
> 
> 标签：javascript, jsp

我正在开发一个具有图标网格的页面（想想iOS主屏幕），我想要一个按钮将整个页面设置为删除状态，这意味着，我点击的任何图标而不是他应该做的事情（在新选项卡中打开页面），删除。我不知道该怎么做

我试过这个：当按下状态更改按钮时，图标的所有“href”都会更改为带有实体 id 的删除页面（类似于 /delete?key=abcd123）。顺便说一句，我正在使用谷歌的应用引擎、java 和数据存储。

我需要一些指导方针，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T09:12:44.573

最简单的方法是创建一个 jquery 脚本来更改 onclick 属性。遍历所有要更改的类

```
$(".class_to_change").attr({onclick: "delete_function()"}); 
```

# c# - 来自 STS 的 RequestSecurityToken 并将其发布到我的网站

> ID：15317177
> 
> 赞同：3
> 
> 时间：2013-03-09T23:35:28.303
> 
> 标签：c#, wif, adfs, geneva-framework

我的网站实现了基于 AD FS 的身份验证。现在我需要通过客户端以编程方式访问我的网站。我的客户端应该使用当前登录的用户上下文从 ADFS 服务器请求安全令牌。我已经成功地`adfs/services/trust/13/usernamemixed`使用客户端的用户名和密码从端点请求安全令牌并将其发布到我的网站。

对我不起作用的是`adfs/services/trust/13/windowsmixed`使用`DefaultNetworkCredentials`. 我得到错误`The HTTP request was forbidden with client authentication scheme 'Anonymous'.`。我正在使用`Microsoft.IdentityModel`SDK（而不是`System.IdentityModel`在 .NET 4.5 中）。

这是我的代码片段。

```
 factory = new MSWSTrustChannelFactory(
  new Microsoft.IdentityModel.Protocols.WSTrust.Bindings.WindowsWSTrustBinding(SecurityMode.TransportWithMessageCredential),
                    stsUrl);

  factory.TrustVersion = TrustVersion.WSTrust13;

  factory.Credentials.Windows.ClientCredential = CredentialCache.DefaultNetworkCredentials;

  var rst = new RequestSecurityToken
  {
      RequestType = RequestTypes.Issue,
      AppliesTo = new EndpointAddress(realm),
      KeyType = KeyTypes.Bearer,
      RequestDisplayToken = true
  };

  MSIWSTrustChannelContract channel = factory.CreateChannel();
  RequestSecurityTokenResponse rstr;
  SecurityToken token = channel.Issue(rst, out rstr); 
```

我对 ADFS 服务器没有任何控制权，也无法从那里调试出了什么问题。我能做的只是来自客户端。知道我上面的代码出了什么问题吗？非常感谢任何帮助或指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-18T06:28:05.790

我认为您需要将消息安全的建立安全上下文设置为 FALSE
binding.Security.Message.EstablishSecurityContext = false;

以下代码对我有用。

```
 WS2007HttpBinding binding = new WS2007HttpBinding(SecurityMode.TransportWithMessageCredential);
            binding.Security.Message.EstablishSecurityContext = false;               
            binding.Security.Transport.ClientCredentialType = HttpClientCredentialType.None;
            if (isWindowsUser)
            {
                binding.Security.Message.ClientCredentialType = MessageCredentialType.Windows;
                ep = new EndpointAddress("https://abc.com/adfs/services/trust/13/windowsmixed");                    
            }
            else
            {
                binding.Security.Message.ClientCredentialType = MessageCredentialType.UserName;
                ep = new EndpointAddress("https://abc.com/adfs/services/trust/13/usernamemixed");                    
            }
            factory = new WSTrustChannelFactory(binding, ep);
            factory.TrustVersion = TrustVersion.WSTrust13;

                factory.Credentials.Windows.ClientCredential = CredentialCache.DefaultNetworkCredentials;                     

            var rst = new RequestSecurityToken
            {
                RequestType = RequestTypes.Issue,
                AppliesTo = new EndpointReference("urn:adfsmonitor"),
                KeyType = KeyTypes.Bearer,
            };
            IWSTrustChannelContract channel = factory.CreateChannel();
            GenericXmlSecurityToken genericToken = channel.Issue(rst)
             as GenericXmlSecurityToken;
            return genericToken.TokenXml.InnerXml.ToString(); 
```

# networking - Arduino Web 服务器和检测网络连接丢失

> ID：15317178
> 
> 赞同：1
> 
> 时间：2013-03-09T23:35:45.593
> 
> 标签：networking, webserver, arduino, ethernet

我有一个带有以太网屏蔽的 arduino，我希望能够检测到网络连接丢失（即，如果有人从 arduino 断开以太网电缆）。我在网上四处寻找，没有发现任何东西。以太网全局对象的 IP 地址保持不变，即使在拔下电缆后也是如此。非常感谢任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T03:06:35.580

我可以想到两种粗略的方法和一种艰难的方法。首先粗略的方法：

## DHCP 请求

请求一个新的 DHCP 地址并检查是否失败（假设 IP 地址是动态分配的）。故障可能意味着电缆已断开（或者您的 DHCP 服务器已被软管：）

```
if (Ethernet.maintain() % 2 == 1) {
    // Cable disconnected or DHCP server hosed
} 
```

## ping/连接

ping 一个已知地址，可能是路由器。如果它失败了，你没有连接，要么是因为电缆被拔掉了，要么是由于其他原因（路由器停机、网络停机等）。

当您没有连接到某些服务以检测电缆移除时，可以执行 ping 或 DHCP 更新方法。

## 关联

看起来虽然 W5100（以太网屏蔽的这个核心）有一个`LINKLED`信号，但它并没有通过它的寄存器让处理器可以使用这个信号。如果您愿意将电线焊接到屏蔽层上，您可以自己构建一个断线检测器。一个明显的选择是`LINKLED`，但是，它会在 TX/RX 活动期间闪烁。因此，如果您知道您在 100Mbps 网络上，您可以将一根电线焊接到`SPDLED`（RJ45 连接器正下方），但我不能完全确定您应该焊接到哪一侧。`SPDLED`低电平有效，所以你可以拿一个万用表，找出当 LED 熄灭时它的哪一侧最接近 0V 。然后，您可以将这条线连接到您的 Arduino`digitalRead()`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-21T04:49:44.287

我有一些不能容忍公共 IP 地址更改的联网硬件（如果有，则需要重新启动）。此代码将检测以太网电缆是否断开以及公共 IP 地址的变化。存根任务可用于对公共 IP 地址的获取或更改进行操作。我使用的是硬连线到 Arduino PRO（即不是屏蔽）的 W5500 板，这很好用。随意使用它。

```
    /*
        -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  重要的  -  -  -  - - -------------------------------------------

 `THIS CODE IS DEPENDENT UPON THE ETHERNET LIBRARY 2.0.0, WHICH IS AVAILABLE 
    FOR DOWNLOAD FROM <https://www.arduinolibraries.info/libraries/ethernet2>.
    ADDITIONAL DOCUMENTATION IS AVIALABLE AT <https://www.pjrc.com/arduino-ethernet-library-2-0-0/>, 
    <https://www.arduino.cc/en/Reference/> AND <https://www.arduino.cc/reference/en/language/functions/communication/stream/>.

    -------------------------------------------------------------------------------------------
*/

#include <SPI.h>
#include <TextFinder.h>
#include <Dhcp.h>
#include <Dns.h>
#include <Ethernet.h>
#include <EthernetUdp.h>

#define kBUILD_TO_DEBUG

const int   kSPI_CLK_PIN                    =   13;
const int   kSPI_MISO_PIN                   =   12;
const int   kSPI_MOSI_PIN                   =   11;
const int   kETHERNET_CS_PIN                =   10;

const int   kSPI_DEVICE_DISABLED            =   HIGH;
const int   kSPI_DEVICE_ENABLED             =   LOW;
const int   kRD382_RESET_ASSERTED           =   HIGH;
const int   kRD382_RESET_NEGATED            =   LOW;

enum {
    kPUBLIC_IP_ADDRESS,
    kLOCAL_IP_ADDRESS
} IP_ADDRESS_TYPES;

enum {
    kSTATE_POSITION_WAIT_FOR_LINK = 0,
    kSTATE_POSITION_GET_DHCP,
    kSTATE_POSITION_GET_IP,
    kSTATE_POSITION_RUN_TIMER,
    kSTATE_POSITION_PERFORM_TASK_ON_ADDRESS_CHANGE,
    kSTATE_POSITION_SEND_REPORT_ON_ADDRESS_CHANGE,
    kSTATE_POSITION_FATAL_ERROR
} STATE_POSITIONS;

typedef struct {
    IPAddress               public_ip_address;
    IPAddress               local_ip_address;
    unsigned long int       currentTime;
    unsigned long int       resetcount;
    unsigned int            millisTimer;
    int                     link_status;
    uint8_t                 secondsTimer;
    uint8_t                 minutesTimer;
    uint8_t                 state_position;
} GLOBALS;

const int   kTIMER_INIT_MILLISECONDS                    =   999;
const int   kTIMER_INIT_SECONDS                         =    59;
const int   kTIMER_INIT_MINUTES                         =     4;
const int   kMILLIS_ONE_SECOND_DELAY                    =   1000;

const int   kCONNECT_SUCCESS                            =      1;
const int   kCONNECT_TIMED_OUT                          =     -1;
const int   kCONNECT_INVALID_SERVER                     =     -2;
const int   kCONNECT_TRUNCATED                          =     -3;
const int   kCONNECT_INVALID_RESPONSE                   =     -4;

const int   kMAC_UNICAST_MULTICAST_BIT_ADDRESS          =   0;
const int   kMAC_UNICAST                                =   0;
const int   kMAC_UNICAST_AND_MASK                       =   ~( 1 << kMAC_UNICAST_MULTICAST_BIT_ADDRESS );
const int   kMAC_LOCALLY_ADMINISTERED_BIT_ADDRESS       =   1;
const int   kMAC_LOCALLY_ADMINISTERED                   =   1;
const int   kMAC_LOCALLY_ADMINISTERED_OR_MASK           =   ( kMAC_LOCALLY_ADMINISTERED << kMAC_LOCALLY_ADMINISTERED_BIT_ADDRESS );
const int   kMAC_ADDRESS_MSB                            =   '0' & kMAC_UNICAST_AND_MASK | kMAC_LOCALLY_ADMINISTERED_OR_MASK;

//  If the Ethernet adapter has a MAC address, enter that MAC address into mac_address[].
const byte  mac_address[]                               =   {kMAC_ADDRESS_MSB, 'E', 'N', 'E', 'T', '0'};

/*
    If you would prefer to use your own page to support obtaining the public IP address, the 
    following HTML5 and PHP code can be used as the source for that page:

    <html><head><title>Current IP Check</title></head><body>Current IP Address: <?php echo $_SERVER['REMOTE_ADDR']; ?></body></html>

    Then change the addressing constants below as appropriate.
*/
const char          kSERVER_DOMAIN_NAME[]               =   "checkip.dyndns.org";
const char          kSERVER_PAGE_NAME[]                 =   "/";
const char          kSERVER_PORT_NUMBER                 =   80;
const char          kIP_QUERY_PAGE[]                    =   "GET checkip.dyndns.org ";
const char          ip_search_str[]                     =   "IP Address: ";

const signed int    kENET_SUCCESS                       =    1;
const signed int    kENET_TIMED_OUT                     =   -1;
const signed int    kENET_INVALID_SERVER                =   -2;
const signed int    kENET_TRUNCATED                     =   -3;
const signed int    kENET_INVALID_RESPONSE              =   -4;

const int           kDEFAULT_CONNECTION_TIMEOUT         =   3000;
const int           kETHERNET_TIMEOUT                   =      5;
const int           kIP_QUERY_MINIMUM_SIZE              =    244;   //  Assume length for public IP of 1.1.1.1
const long          kIP_QUERY_TIMEOUT                   =   (  5 * kMILLIS_ONE_SECOND_DELAY );  // seconds, expressed in milliseconds
const int           kNOTIFICATION_RETRY_COUNT_SEED      =     10;
const int           kSIZE_OF_IPV4_ADDRESS               =      4;

EthernetClient      ethernetClient;
TextFinder          textFinder ( ethernetClient, kETHERNET_TIMEOUT );

GLOBALS             globals;

/*  --------------------------------------------------------------------------------    */

void address_changed_task ( void )
{
    //  Insert code to be executed when the public IP address changes, or upon the 
    //  initial acquisition of the public IP address.
#ifdef kBUILD_TO_DEBUG                          //  {
    if ( Serial )
    {
        Serial.println ( "STATUS: address_changed_task () completed" );
    }
#endif                                          //  }   kBUILD_TO_DEBUG
}

/*  --------------------------------------------------------------------------------    */

void send_report ( void )
{
    //  Insert code to report status after handling a change in public IP address
#ifdef kBUILD_TO_DEBUG                          //  {
    if ( Serial )
    {
        Serial.println ( "STATUS: send_report () completed" );
    }
#endif                                          //  }   kBUILD_TO_DEBUG
}

/*  --------------------------------------------------------------------------------    */

void clear_ip_address ( uint8_t ip_address_type )
{
    for ( int index = 0; index < kSIZE_OF_IPV4_ADDRESS; index++ )
    {
        switch ( ip_address_type )
        {
            case kPUBLIC_IP_ADDRESS:    globals.public_ip_address[index] = 0;   break;
            case kLOCAL_IP_ADDRESS:     globals.local_ip_address[index] = 0;    break;
        }
    }
}

//  --------------------------------------------------------------------------------

void display_ip_address ( uint8_t ip_address_type )
{
#ifdef kBUILD_TO_DEBUG                          //  {
    if ( Serial )
    {
        switch ( ip_address_type )
        {
            case kPUBLIC_IP_ADDRESS:
            {
                Serial.print ( "Public IP Address: " );
                for ( int index = 0; index < kSIZE_OF_IPV4_ADDRESS; index++ )
                {
                    Serial.print ( globals.public_ip_address[index] );
                    if ( index < ( kSIZE_OF_IPV4_ADDRESS - 1 ) )
                    {
                        Serial.print ( "." );
                    }
                }
            }
            break;

            case kLOCAL_IP_ADDRESS:
            {
                Serial.print ( "Local IP Address:  " );
                for ( int index = 0; index < kSIZE_OF_IPV4_ADDRESS; index++ )
                {
                    Serial.print ( globals.local_ip_address[index] );
                    if ( index < ( kSIZE_OF_IPV4_ADDRESS - 1 ) )
                    {
                        Serial.print ( "." );
                    }
                }
            }
            break;
        }
        Serial.println ( "" );
    }
#endif                                          //  }   kBUILD_TO_DEBUG
}

/*  --------------------------------------------------------------------------------    */

void display_mac_address ( void )
{
#ifdef kBUILD_TO_DEBUG                          //  {
    uint8_t         field_count = ( sizeof ( mac_address ) / sizeof ( mac_address[0] ) );

    if ( Serial )
    {
        Serial.print ( "MAC Address:       " );
        for ( int index = 0; index < field_count; index++ )
        {
            Serial.print ( mac_address[index] );
            if ( index < ( field_count - 1 ) )
            {
                Serial.print ( "." );
            }
        }
        Serial.println ( "" );
    }
#endif                                          //  }   kBUILD_TO_DEBUG
}

/*  --------------------------------------------------------------------------------    */
/*
    A query to http://checkip.dyndns.org will return the following:

        HTTP/1.1 200 OK
        Content-Type: text/html
        Server: DynDNS-CheckIP/1.0
        Connection: close
        Cache-Control: no-cache
        Pragma: no-cache
        Content-Length: 105

        <html><head><title>Current IP Check</title></head><body>Current IP Address: 50.37.222.230</body></html>
*/

boolean get_public_ip_address ( void )
{
    unsigned long int   temp_timer = 0;
    unsigned int        retry_count = kNOTIFICATION_RETRY_COUNT_SEED;
    signed int          client_connected_result = kENET_SUCCESS;
    byte                public_ip_address[] = {0,0,0,0};
    int                 availableDataSize;
    boolean             found_ip_address = false;
    boolean             values_matched = true;
    boolean             all_zero = true;
    boolean             result = false;

    while ( !found_ip_address && ( 0 != retry_count ) )
    {
        ethernetClient.setConnectionTimeout ( kDEFAULT_CONNECTION_TIMEOUT );
        client_connected_result = ethernetClient.connect ( (const char*)kSERVER_DOMAIN_NAME, kSERVER_PORT_NUMBER );
        if ( kCONNECT_SUCCESS == client_connected_result )
        {
            ethernetClient.println ( kIP_QUERY_PAGE );
            temp_timer = kIP_QUERY_TIMEOUT;

            availableDataSize = ethernetClient.available ();
            while ( ( kIP_QUERY_MINIMUM_SIZE > availableDataSize ) && ( 0 != temp_timer ) ) {
                availableDataSize = ethernetClient.available ();
                delay ( 1 );
                if ( 0 < temp_timer ) { temp_timer--; }
            };

            if ( 0 != availableDataSize )
            {
                if ( textFinder.find ( (char*)ip_search_str ) )
                {
                    values_matched = true;
                    all_zero = true;
                    for ( int index = 0; index < kSIZE_OF_IPV4_ADDRESS; index++ )
                    {
                        public_ip_address[index] = textFinder.getValue ();

                        if ( globals.public_ip_address[index] != public_ip_address[index] )
                        {
                            values_matched = false;
                            globals.public_ip_address[index] = public_ip_address[index];
                        }

                        if ( 0 != public_ip_address[index] )
                        {
                            all_zero = false;
                        }
                    }

                    if ( values_matched || !all_zero ) { found_ip_address = true; }
                    if ( !values_matched && !all_zero ) { result = true; }
                }
            }
            ethernetClient.stop ();
        }

        if ( 0 != retry_count ) { retry_count--; }
    }

    return result;
}

/*  --------------------------------------------------------------------------------    */

boolean ip_address_is_zero ( uint8_t ip_address_type )
{
    boolean     result = true;

    for ( int index = 0; index < kSIZE_OF_IPV4_ADDRESS; index++ )
    {
        switch ( ip_address_type )
        {
            case kPUBLIC_IP_ADDRESS:    if ( 0 != globals.public_ip_address[index] ) { result = false; }    break;
            case kLOCAL_IP_ADDRESS:     if ( 0 != globals.local_ip_address[index] ) { result = false; }     break;
        }
    }

    return result;
}

/*  --------------------------------------------------------------------------------    */

void setup ()
{
    globals.state_position = kSTATE_POSITION_WAIT_FOR_LINK;

#ifdef kBUILD_TO_DEBUG                          //  {
    Serial.begin ( 115200 );
    while ( !Serial ) {}
#endif                                          //  }   kBUILD_TO_DEBUG

    clear_ip_address ( kPUBLIC_IP_ADDRESS );
    clear_ip_address ( kLOCAL_IP_ADDRESS );

    pinMode ( kETHERNET_CS_PIN, OUTPUT );
    digitalWrite ( kETHERNET_CS_PIN, kSPI_DEVICE_DISABLED );

    display_mac_address ();

    /*
        Note that the following execution of Ethernet.begin ( mac ) will attempt to obtain 
        a local IP address via DHCP.  If the Ethernet cable is not attached, the 
        Ethernet.begin method will timeout after 60-seconds.  Aside from delaying 
        the completion of setup (), this delay imposes no bad behavior.   The 
        Ethernet.hardwareStatus () method does not function until after Ethernet.begin 
        has executed so setup () invokes Ethernet.begin regardless of any status.

        It would be desirable to invoke Ethernet.hardwareStatus () to determine if 
        Ethernet.linkStatus () is supported, and then execute Ethernet.begin ( mac ) only 
        if the LINK is active (i.e. cable is attached) when the hardware supports such a 
        determination (a value of EthernetNoHardware is returned).  The current Ethernet 
        library does not support this sequence (at least using a W5500 device).  If this 
        were possible, the invoking of Ethernet.begin ( mac ) would simply defer execution 
        to the state machine and avoid execution in setup ().
    */

    Ethernet.begin ( (byte*)mac_address );
}

/*  --------------------------------------------------------------------------------    
    The STATE MACHINE will detect attachment and detachment of the ethernet cable, 
    and initiate IP polling upon attachment of the cable.  IP Polling will be 
    suspended when the ethernet cable is detached.  For the W5100, where no link 
    (cable) detection is supported, the STATE MACHINE will act as if the ethernet 
    cable is always attached.

    Nominal state machine execution occurs at a minimum of 1-second intervals, with 
    the interval being extended by any task execution time.
*/

void    state_machine ( void )
{
    int         link_on_status = Unknown;
    uint8_t     current_state_position = globals.state_position;

    switch ( Ethernet.hardwareStatus () )
    {
        case EthernetNoHardware:    globals.state_position = kSTATE_POSITION_FATAL_ERROR;   break;
        case EthernetW5100:         link_on_status = LinkON;                                break;
        case EthernetW5200:         link_on_status = Ethernet.linkStatus ();                break;
        case EthernetW5500:         link_on_status = Ethernet.linkStatus ();                break;
    }

    switch ( globals.state_position )
    {
        case kSTATE_POSITION_WAIT_FOR_LINK:
        {
            /*
                This is the initial state position.  Global variables are initialized to prepare for proper 
                checks to occur once the ethernet link is determined to be active.
            */
            globals.minutesTimer = 0;
            globals.secondsTimer = 0;

            if ( !ip_address_is_zero ( kLOCAL_IP_ADDRESS ) )
            {
                clear_ip_address ( kPUBLIC_IP_ADDRESS );
                clear_ip_address ( kLOCAL_IP_ADDRESS );
                display_ip_address ( kPUBLIC_IP_ADDRESS );
                display_ip_address ( kLOCAL_IP_ADDRESS );
            }

            if ( LinkON == link_on_status )
            {
                globals.state_position = kSTATE_POSITION_GET_DHCP;
            }
        }
        break;

        case kSTATE_POSITION_GET_DHCP:
        {
            /*
                Upon attachment of the Ethernet cable, acquire a new DHCP address.  Execution of the 
                Ethernet.begin ( mac ) method may seem redundant, but occurs in case the cable has been 
                unplugged for sufficient time that the DHCP lease has expired.  It is possible that a 
                new address is required.
            */
            if ( LinkON == link_on_status )
            {
                Ethernet.begin ( (byte*)mac_address );
                globals.local_ip_address = Ethernet.localIP ();
                if ( !ip_address_is_zero ( kLOCAL_IP_ADDRESS ) )
                {
                    display_ip_address ( kLOCAL_IP_ADDRESS );
                    globals.state_position = kSTATE_POSITION_GET_IP;
                }
            }
            else if (  LinkOFF == link_on_status )
            {
                globals.state_position = kSTATE_POSITION_WAIT_FOR_LINK;
            }
        }
        break;

        case kSTATE_POSITION_GET_IP:
        {
            /*
                This state position obtains the public IP address by issuing a query to 'checkip.dyndns.org'.  
                The invoked function will parse the returned data to obtain the public IP address.
            */
            if ( LinkON == link_on_status )
            {
                if ( get_public_ip_address () )
                {
                    display_ip_address ( kPUBLIC_IP_ADDRESS );
                    globals.state_position = kSTATE_POSITION_PERFORM_TASK_ON_ADDRESS_CHANGE;
                }
                else
                {
                    globals.state_position = kSTATE_POSITION_RUN_TIMER;
                }
                Ethernet.maintain ();
            }
            else if (  LinkOFF == link_on_status )
            {
                globals.state_position = kSTATE_POSITION_WAIT_FOR_LINK;
            }
        }
        break;

        case kSTATE_POSITION_RUN_TIMER:
        {
            /*
                This state position checks whether it is time to check if the public IP address has changed.
            */
            if ( LinkON == link_on_status )
            {
                if ( 0 == globals.secondsTimer ) { globals.secondsTimer = kTIMER_INIT_SECONDS; }
                if ( 0 == globals.minutesTimer ) { globals.minutesTimer = kTIMER_INIT_MINUTES; }

                globals.secondsTimer--;
                if ( 0 == globals.secondsTimer )
                {
                    globals.minutesTimer--;
                    if ( 0 == globals.minutesTimer )
                    {
                        globals.state_position = kSTATE_POSITION_GET_IP;
                    }
                    globals.secondsTimer = kTIMER_INIT_SECONDS;
                }
                Ethernet.maintain ();
            }
            else if (  LinkOFF == link_on_status )
            {
                globals.state_position = kSTATE_POSITION_WAIT_FOR_LINK;
            }
        }
        break;

        case kSTATE_POSITION_PERFORM_TASK_ON_ADDRESS_CHANGE:
        {
            /*
                This state position will invoke the function to handle a change to the public IP address, 
                or upon initial acquisition of the public IP address (either on start up or when the 
                ethernet cable is attached).
            */
            if ( LinkON == link_on_status )
            {
                address_changed_task ();
                globals.state_position = kSTATE_POSITION_SEND_REPORT_ON_ADDRESS_CHANGE;
                Ethernet.maintain ();
            }
            else if (  LinkOFF == link_on_status )
            {
                globals.state_position = kSTATE_POSITION_WAIT_FOR_LINK;
            }
        }
        break;

        case kSTATE_POSITION_SEND_REPORT_ON_ADDRESS_CHANGE:
        {
            /*
                This state position will invoke the function to report completion of handling a change to 
                the public IP address.
            */
            if ( LinkON == link_on_status )
            {
                send_report ();
                globals.state_position = kSTATE_POSITION_RUN_TIMER;
                Ethernet.maintain ();
            }
            else if (  LinkOFF == link_on_status )
            {
                globals.state_position = kSTATE_POSITION_WAIT_FOR_LINK;
            }
        }
        break;

        case kSTATE_POSITION_FATAL_ERROR:
        {
            /*
                This state machine requires Ethernet hardware that can report the ethernet link status.  If the 
                hardware lacks this support, this state is entered and purposefully hangs.
            */
#ifdef kBUILD_TO_DEBUG                          //  {
            if ( Serial ) { Serial.println ( "FATAL ERROR: Ethernet hardware NOT FOUND" ); }
#endif                                          //  }   kBUILD_TO_DEBUG
            while ( true ) {};
        }
        break;
    }
}

/*  --------------------------------------------------------------------------------    */
/*
    State machine execution occurs at a minimum interval of 1000 milliseconds.
*/

void loop ()
{
    unsigned long int   currentTime = millis ();

    if ( globals.currentTime != currentTime )
    {
        globals.currentTime = currentTime;

        if ( ( 0 == globals.millisTimer ) || ( kTIMER_INIT_MILLISECONDS < globals.millisTimer ) )
        {
            globals.millisTimer = kTIMER_INIT_MILLISECONDS;
        }

        globals.millisTimer--;
        if ( 0 == globals.millisTimer ) 
        {
            state_machine ();
            globals.millisTimer = kTIMER_INIT_MILLISECONDS;
        }
    }
}` 

```

# ruby - 根据长度读取行

> ID：15317180
> 
> 赞同：1
> 
> 时间：2013-03-09T23:36:13.327
> 
> 标签：ruby, string, file, string-length

我想知道更有效的方法来仅读取基于特定长度的文件字符串。我知道这是一种天真的方法：

```
len = 3
d = Array.new
t = File.open('d.txt').read
t.each_line do |x|
    #+2 accounting for \n\r
    if x.length == (len + 2)
        d.push(x)
    end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:43:01.647

这将与您的代码相同。

```
d = File.open("d.txt").lines.select{|l| l.chomp.length == len} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T04:54:22.363

这有很多问题：

```
len = 3
d = Array.new
t = File.open('d.txt').read
t.each_line do |x|
    #+2 accounting for \n\r
    if x.length == (len + 2)
        d.push(x)
    end
end 
```

首先，由于 将整个文件读入内存`File.open('d.txt').read`，然后使用 分割成行`each_line`，最后捕获所需长度的行。如果文件由 1,000,000 行组成，并且只有一个是三个字符长，则会浪费大量内存和 CPU 时间。

相反，这样写：

```
len = 3
d = []
File.foreach('d.txt') do |x|
  d << x if (x.chomp.length == len)
end 
```

`foreach`读取每一行，保持换行符。`chomp`删除换行符，因此您可以比较实际行，由于`chomp`, 到`len`. 然后，如果长度匹配，则该行将附加到数组中。除非每一行都是所需的长度，否则整个文件都不会在内存中。这样可以节省内存，并且运行速度非常快，甚至可能比用于`read`slurp 整个文件的原始速度更快，因为如果文件足够大，该过程可能需要一段时间。

# php - 在 $_FILE 中使用我自己的照片路径（在 ajax 中上传）

> ID：15317181
> 
> 赞同：-2
> 
> 时间：2013-03-09T23:36:21.973
> 
> 标签：php, ajax, upload

在一个 php 文件中，我创建了一种上传形式，并通过 ajax 调用另一个 php 来上传照片。我将 name="file" 传递给第二个 php，这意味着我有一个字符串，它是照片的路径和名称，例如 ("C:\fakepath\xxx.JPG")，然后我把这个字符串放在一个变量中，如下所示：

$file="第一个 php 中来自上传表单的字符串"; 然后，`$_FILES["$file"]`或 `$_FILES[$file]`，`$_FILES['$file']`总是返回我一个错误，如：

```
Notice: Undefined index: C:\fakepath\xxx.JPG in C:\xampp\htdocs\project\ajax_php_files\PHPfile.php on line 111 
```

上传表单（第一个 PHP）

```
echo"
<form action='#' method='post' enctype='multipart/form-data' name='form1'  id='form1'>
<label for='file'>Filename:</label>
<input type='file' name='file' id='file'><br>
<input name='submit' type='button' id='submit' value='upload' onclick=\"SubmitData1('file')\" />
</form>"; 
```

ajax函数：

```
function SubmitData1(id1){

var file=document.getElementById(id1).value;

//var file=String(file);
alert(file);

if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
      document.getElementById("ContextPart").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","ajax_php_files/upload_file3.php?file="+file,true);
xmlhttp.send();

} 
```

第二个 php (upload_file3.php):

```
<?php
//$allowedExts = array("jpg", "jpeg", "gif", "png");
//$extension = end(explode(".", $_FILES["file"]["name"]));

$file=$_GET["file"];
// here, the variable $file is a string like:C:\fakepath\fit1.JPG

//$file="C:\Picture\Amir\fit1.JPG";
echo $file;

if ((($_FILES["file (or $file or '$file' or what?!!)"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/jpg")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 10000000))
//&& in_array($extension, $allowedExts))
  {

  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
    }
  else 
```

等等。 ...

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:51:48.683

所以，问题在于`$_FILE`数组的索引与`name`表单中的文件输入有关。在这种情况下，您正在寻找`$_FILE['file']`.

另一个问题是您正在尝试使用 AJAX 并`GET`上传文件。那根本行不通。文件上传*必须*是POST，不单方面支持AJAX中的文件上传。如果你只是在 GET 中使用表单元素的值，那么它总是类似于`C:\fakepath\xxx.JPG`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:55:24.640

发现错字`((($_FILES["fit1"]["type"] == "image/gif")`应该是`$_FILES["file"]`

# jquery - jquery滚动锚菜单项突出显示

> ID：15317185
> 
> 赞同：-2
> 
> 时间：2013-03-09T23:36:33.497
> 
> 标签：jquery

我正在使用我在这个答案中找到的代码[Change Active Menu Item on Page Scroll?](https://stackoverflow.com/questions/9979827/change-active-menu-item-on-page-scroll/15317013#15317013) 但无法让它工作......这就是我从 jsFiddle 示例中粘贴的内容。

```
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script>
// Cache selectors
var lastId,
    topMenu = $("#top-menu"),
    topMenuHeight = topMenu.outerHeight()+15,
    // All list items
    menuItems = topMenu.find("a"),
    // Anchors corresponding to menu items
    scrollItems = menuItems.map(function(){
      var item = $($(this).attr("href"));
      if (item.length) { return item; }
    });

// Bind click handler to menu items
// so we can get a fancy scroll animation
menuItems.click(function(e){
  var href = $(this).attr("href"),
      offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+1;
  $('html, body').stop().animate({ 
      scrollTop: offsetTop
  }, 300);
  e.preventDefault();
});

// Bind to scroll
$(window).scroll(function(){
   // Get container scroll position
   var fromTop = $(this).scrollTop()+topMenuHeight;

   // Get id of current scroll item
   var cur = scrollItems.map(function(){
     if ($(this).offset().top < fromTop)
       return this;
   });
   // Get the id of the current element
   cur = cur[cur.length-1];
   var id = cur && cur.length ? cur[0].id : "";

   if (lastId !== id) {
       lastId = id;
       // Set/remove active class
       menuItems
         .parent().removeClass("active")
         .end().filter("[href=#"+id+"]").parent().addClass("active");
   }                   
});
</script>
<style>
body {
    height: 6000px;
    font-family: Helvetica, Arial;
}

#top-menu {
    position: fixed;
    z-index: 1;
    background: white;
    left: 0;
    right: 0;
    top: 0;
}

#top-menu li {
    float: left;
}

#top-menu a {
    display: block;
    padding: 5px 25px 7px 25px;
    -webkit-transition: 1s all ease;
    -moz-transition: 1s all ease;
    transition: 1s all ease;
    border-top: 3px solid white;
    color: #666;
    text-decoration: none;
}

#top-menu a:hover {
    color: #000;
}

#top-menu li.active a {
    border-top: 3px solid #333;
    color: #333;
    font-weight: bold;
}

#foo {
    position: absolute;
    top: 400px;
}

#bar {
    position: absolute;
    top: 800px;
}

#baz {
    position: absolute;
    top: 1200px;
}
</style>
</head>
<body>
<ul id="top-menu">
  <li class="active">
    <a href="#">Top</a>
  </li>
  <li>
    <a href="#foo">Foo</a>
  </li>
  <li>
    <a href="#bar">Bar</a>
  </li>
  <li>
    <a href="#baz">Baz</a>
  </li>
</ul>

<a id="foo">Foo</a>

<a id="bar">Bar</a>

<a id="baz">Baz</a>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:21:24.357

将您的 Javascript 移至底部或将其包装在 document.ready 语句中：

```
$(function() {
    // Handler for .ready() called.
}); 
```

[.ready() - jQuery](http://api.jquery.com/ready/)

您正在尝试将事件附加到尚不存在的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-29T21:33:56.580

回应微风在评论中提出的新问题：

`scrollTop`必须经过锚点才能移动高光，而 1px 的额外增量并不能完全做到这一点*。*

改变这个：

```
offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+1; 
```

对此：

```
offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+2; //<== note the 2 
```

或这个：

```
offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+5; //<== note the 5 
```

# c# - 从 WebService 连接到 Visual Studio Team Services

> ID：15317191
> 
> 赞同：4
> 
> 时间：2013-03-09T23:37:51.620
> 
> 标签：c#, web-services, azure-devops, tfs-sdk

我如何提供凭据`TfsTeamProjectCollectionFactory.GetTeamProjectCollection`？
我正在尝试从女巫那里开发自己的 WCF 服务 我将向 TFS 提出请求
我需要这个 WCF 服务，因为我想在女巫中管理我的 TFS 文件我无法使用 Microsoft.TeamFoundation.* dll

我一直在尝试这种方式

```
Uri tpcAddress= new Uri("https://myserver.visualstudio.com/DefaultCollection");
TfsConnection tfsc = new TfsConfigurationServer(tpcAddress, 
        new NetworkCredential("mail@example.com", "password"));
TfsWebClient wc = new TfsWebClient(tfsc);
tfsc.Connect(ConnectOptions.IncludeServices); 
```

第二次尝试使用从 ICredentialsProvider 派生的自定义类

```
ICredentialsProvider prov = new myCredentials();
var tpc = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(tpcAddress, prov);
tpc.EnsureAuthenticated();
tpc.Authenticate();

public class myCredentials : ICredentialsProvider
{
    public ICredentials GetCredentials(Uri uri, ICredentials failedCredentials)
    {
        return new NetworkCredential("mail@example.com", "password");
    }
    public void NotifyCredentialsAuthenticated(Uri uri)
    {
    }
} 
```

但它只适用于我的机器，因为我登录到 tfs。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-04T19:10:53.453

我最近，找到了这个解决方案：

```
NetworkCredential netCred = new NetworkCredential(user,pass);

BasicAuthCredential basicCred = new BasicAuthCredential(netCred);

TfsClientCredentials tfsCred = new TfsClientCredentials(basicCred);

tfsCred.AllowInteractive = false;

TfsTeamProjectCollection tpc = new TfsTeamProjectCollection(new Uri(path), TFSCred); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T20:25:14.877

为避免提示您使用 Live ID 登录或必须已登录，您需要启用备用登录凭据并将其与您的服务一起使用。

这篇博文告诉你如何：

[http://blogs.msdn.com/b/buckh/archive/2013/01/07/how-to-connect-to-tf-service-without-a-prompt-for-liveid-credentials.aspx](http://blogs.msdn.com/b/buckh/archive/2013/01/07/how-to-connect-to-tf-service-without-a-prompt-for-liveid-credentials.aspx)

请注意，您需要安装 VS 2012 Update 1 才能使用此功能。

希望这可以帮助。

# javascript - 来自 JavaScript 的 CSS3 多个背景图像

> ID：15317200
> 
> 赞同：1
> 
> 时间：2013-03-09T23:38:38.527
> 
> 标签：javascript, css, background

如何通过 JavaScript 以编程方式在 CSS3 中定义多个背景图像？

显而易见的想法：

```
var element = document.createElement( 'div' );
element.style.backgroundImage = "url('a.png') 0 100%, url('b.png') 50px 50px "; 
```

不起作用 - 它一定很简单，但是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T23:43:32.403

`backgroundImage`仅当您在一个中设置多个背景属性时才用于背景图像，您必须使用`background`.

```
element.style.background = "url('a.png') 0 100%, url('b.png') 50px 50px "; 
```

# php - 发生错误时停止执行 if 语句后的代码

> ID：15317201
> 
> 赞同：0
> 
> 时间：2013-03-09T23:39:02.530
> 
> 标签：php

这就是我的代码的样子：

```
if($allthevaluesarenotempty) {
    if($pictureexist) {
        // upload picture code
    }
    else
    {
        $message = "error";
    }

    // sql query here
} 
```

如何在`$message`设置时停止执行 SQL 查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:43:07.770

*   如果出现 while、for 和 foreach 等循环，您可以使用它`continue;`来逃避迭代并`break;`结束循环。

*   在函数`return false;`中将停止执行。

*   在一个 PHP 文件中，`exit()`将终止脚本的进一步执行。

所以，用哪个合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T23:48:07.703

检查`$message`是否有错误：

```
if($allthevaluesarenotempty) {

    $message = '';     

    if ($pictureexist) {

        // upload picture code

    } else {

        $message = "error";

    } // if $pictureexist

} // if $allyourvalues...

// later in your code check $message

if ($message == 'error') {

   // do something, there was an error...

} // if $message 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T23:58:57.920

你可以检查变量`$message`，看看它是否是“错误”的euql：

```
if($allthevaluesarenotempty) {
    if($pictureexist){
       // upload picture code
    }
    else
    {
       $message = "error";
    }
    if (@$message != "error")) { 
       //sql query here
    }
 } 
```

或者您可以将您的 sql 查询放在`if`块中

```
 if($allthevaluesarenotempty) {
    if($pictureexist){
       // upload picture code

       //sql query here
    }
    else
    {
       $message = "error";
    }
 } 
```

# java - JMS 是否有队列窥视的概念？

> ID：15317207
> 
> 赞同：6
> 
> 时间：2013-03-09T23:39:40.590
> 
> 标签：java, queue, jms, peek

从一般计算机科学的角度来看——当我们从逻辑意义上考虑队列时——我们认为能够“窥视”队列中的第一项。

当我查看 JMS API - 它有一个`MessageListener`- 它有一个`OnMessage()`方法。这有点像“不要给我们打电话——我们会打电话给你”。

JMS 是否有队列窥视的概念？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T02:21:52.780

1）如果要同步接收消息，请使用 MessageConsumer.receive

2）基本上，队列中的“窥视”意味着返回但不删除队列的头部。为此，您可以使用[QueueBrowser](https://docs.oracle.com/cd/E19798-01/821-1841/bncey/index.html)查看队列中的消息而不删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T23:48:35.997

JMS 有一个[QueueReceiver](http://docs.oracle.com/javaee/6/api/javax/jms/QueueReceiver.html)，它可以接收消息。您可以为此 QueueReceiver 设置 MessageListener 以收到新消息的通知。

# emscripten - Emscripten全语言编译推荐环境

> ID：15317208
> 
> 赞同：0
> 
> 时间：2013-03-09T23:39:41.063
> 
> 标签：emscripten

我想使用 Emscripten将[基于 C 的语言编译成 javascript。](http://cran.r-project.org/)[此处](https://github.com/kripken/emscripten/wiki/Tutorial)和[此处](https://github.com/kripken/emscripten/wiki/Building-Projects)的文档表明成功率在一定程度上取决于环境。幸运的是，借助虚拟化，可以轻松启动工作所需的任何环境。谁能建议什么 linux 风格是编译大型项目的最佳选择？欢迎任何其他相关提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:49:43.850

使用 Ubuntu，您可以随心所欲。有关如何使用，请查看[在 Ubuntu 上安装 Emscripten](https://stackoverflow.com/questions/14902514/installing-emscripten-on-ubuntu)

# datagrid - Dojo Datagrid 在 Chrome 上不断向上滚动

> ID：15317209
> 
> 赞同：3
> 
> 时间：2013-03-09T23:39:42.027
> 
> 标签：datagrid, dojo, scroll

如何解决这个问题，每当数据网格上有一个垂直滚动条并且我向下滚动时，它就会神奇地自动向上滚动到顶部。这发生在 Chrome 中，但在 Firefox 中没有问题。我目前为此使用 Dojo 1.6

# python - Python Tkinter如何使用网格为窗口着色

> ID：15317211
> 
> 赞同：2
> 
> 时间：2013-03-09T23:39:55.183
> 
> 标签：python, tkinter

我正在尝试 Tkinter 并使用网格编写一个小窗口。

代码如下：

```
from Tkinter import *
from modules.logic import game
import options

class StartWindow:

    def __init__(self):

        data = open("myData", "w")
        data.close()
        self.master = Tk()
        self.l0 =Label (self.master, text = "W=jump", bg = "magenta", font = ("comic sans ms", 20, "bold")).grid(row=0, sticky = W)
        self.l1=Label (self.master, text = "A=left",bg = "magenta",font = ("comic sans ms", 20, "bold")).grid(row = 1, sticky = W)
        self.l2=Label(self.master, text = "D=Duck", bg = "magenta",font = ("comic sans ms", 20, "bold")).grid(row=2, sticky = W )
        self.l3=Label(self.master, text = "Mouse = Shoot", bg = "magenta",font = ("comic sans ms", 20, "bold")).grid(row=3, sticky = W)
        self.l4=Label(self.master, text = "S=Duck", bg = "magenta",font = ("comic sans ms", 20, "bold")).grid(row=4, sticky = W)
        self.l5=Label(self.master, text="Seed:", bg = "magenta",font = ("comic sans ms", 20, "bold")).grid(row=5, sticky = W)
        self.master.minsize(50, 50)
        self.master.weight = 2
        self.master.title("Fluffocalypse")
        self.master.iconify()    
        self.e1 = Entry(self.master)
        self.e1.grid(row=5, column=1, sticky = W)
        self.b1 =Button(self.master, text = "Start", command = self.startGameNormally).grid(row = 6, sticky = W)
        self.b2 = Button(self.master, text = "alten Spielstand laden", command =self.loadOldGame).grid(row = 7, sticky = W)
        mainloop() 
```

它确实有效。

好吧，首先，对我来说，文本看起来不像漫画，但这是一个小问题。

如果您尝试此代码（请执行此操作），您会看到您得到的是一个带有标签和按钮的窗口，就在我放置它们的位置，我也设置了洋红色。

但是，窗口上的空闲空间仍然是灰色的。我也想要自由空间洋红色。这可能吗？如果可以，怎么办？关于如何更改任何已打包内容的颜色有十几种解释，但我没有使用 pack() 而是使用网格，而且我找不到关于如何为整个窗口着色的解决方案，而不仅仅是我的标签和按钮是。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T00:03:27.010

我想您希望窗口的背景颜色为`magenta`：

```
self.master = Tk()                                                      
self.master.configure(bg = 'magenta') 
```

结果：

![洋红色窗口](../Images/2357bb5cabdccee89dc7355981df7d52.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:02:58.013

只需将此行添加到您的构造函数：

```
self.master.configure(background="magenta") 
```

# php - 加速 MySQL 插入性能？

> ID：15317215
> 
> 赞同：0
> 
> 时间：2013-03-09T23:40:45.797
> 
> 标签：php, mysql, database-performance, load-data-infile

需要在最短时间在索引表中插入超过 10M 的记录。这 10M 条记录是游标在存储过程中运行的结果。目前，将所有数据插入表中大约需要 50 分钟。

你会推荐什么来加速它的性能？另一种选择是 LOAD DATA INFILE，但您是否会将查询结果导出到临时文件中，以便可以足够快地插入？

由于数据量大，我们考虑将流程解耦并将责任转移给 MySQL，而不是对 PHP 连接器施加额外的压力。这是更好的方法吗？

所有建议都非常受欢迎。谢谢！

光标示例如下：

```
--- MyISAM EXAMPLE
DROP PROCEDURE IF EXISTS createSegmentMyISAM;
DELIMITER //
CREATE PROCEDURE createSegmentMyISAM(IN accountId INT(11), setId INT(11), volume INT(11))
BEGIN
DECLARE complete INT DEFAULT FALSE;

DECLARE field_a VARCHAR(256);
DECLARE field_b VARCHAR(254);
DECLARE field_c VARCHAR(35);
DECLARE field_d VARCHAR(35);

DECLARE cur CURSOR FOR
    SELECT sb.`field_a`,
           sb.`field_b`,
           sb.`field_c`,
           sb.`field_d`
    FROM   `mydb`.`mytable` sb 
    WHERE  sb.`tbl2` IN (SELECT dm.`field_e` 
                           FROM   `mydb`.`tbl3` dm 
                                  INNER JOIN `mydb`.`tbl4` st 
                                          ON dm.`set_id` = st.`set_id` 
                           WHERE  st.set_id = setId) 
    LIMIT  0, volume;

DECLARE CONTINUE HANDLER FOR NOT FOUND SET complete = TRUE; 

OPEN cur;

read_loop: LOOP

    FETCH cur INTO field_a, field_b, field_c, field_d;

    IF complete THEN
        LEAVE read_loop;
    END IF;

    INSERT INTO `mydb`.`temp` (fieldA, fieldB, fieldC, fieldD) VALUES (field_a, field_b, field_c, field_d);

END LOOP;

CLOSE cur;

END //
DELIMITER ; 
```

# android - 选择最佳 Android 布局

> ID：15317217
> 
> 赞同：0
> 
> 时间：2013-03-09T23:40:48.123
> 
> 标签：android, layout

我是 Android 新手，希望做如下布局：

1.  顶部有一个徽标。
2.  接下来是带圆角的矩形
3.  在该矩形内，我将有两个用于用户 ID 和密码的 EditText 框，以及一个登录按钮
4.  在带圆角的矩形下方（外部）我有一个指向条款和条件的 Html 链接

我尝试了各种布局方式

1.  仅使用布局。不同种类的布局。一切似乎都很难实现我所需要的
2.  使用布局+背景。背景并不是真正的背景，而是更像一个模板，它会影响你的布局，并且很难控制你想要控制的位置。
3.  使用 onDraw。灵活但担心不同的屏幕尺寸可能会出现问题。

那么，有人请启发这是实现我需要的最佳方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:07:37.867

没有人能真正告诉你什么是最好的，这完全取决于你想要什么，但我建议使用[RelatvieLayout](http://developer.android.com/reference/android/widget/RelativeLayout.html)，因为在我看来，一旦你稍微使用它们，它们通常是最简单和最有效的使用。您可以阅读[此处](https://stackoverflow.com/questions/5618402/how-to-draw-rounded-rectangle-in-android-ui)了解如何制作矩形。你基本上会使用和`shape drawable`调整`radius`.`corners`

至于顶部的 logo，如果它会在其他`Activity`s 中重用，那么您可以将其放在自己的布局中，并在您的布局中使用[include](http://developer.android.com/training/improving-layouts/reusing-layouts.html)标签来重用 logo 布局

如果您担心不同的屏幕尺寸，请阅读[文档](http://developer.android.com/guide/practices/screens_support.html)并找到适合您的方法。只需从它开始并随时调整。不要害怕搞砸并重做一些。希望这是足够的信息让你开始

使用 a`RelativeLayout`会给你更大的灵活性，并允许你使用更少的东西`Layouts`，例如嵌套`LinearLayout`的 s 和`Layout`只有一个孩子的 s，这可以提高性能

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:08:04.763

应该这样做：从垂直方向的线性布局开始：

```
<linearLayourt xmlns=............
android:orientation="vertical"
.....other stuffs goes here
......
.....
<LinearLayout ......this is the child linearlayout
.....other stuffs goes here like width and height
<ImageView ...this is where you are gonna put your logo in
/>
</LinearLayout> ....close your child linear layout
<RelativeLayout ...
.........other stuffs here
<EditText ....1st edit text
...you position your boxes here
/>
<EditText ....2nd edit text
...you position your boxes here
/>
</RelativeLayout>
<TextView 
....
...
...put yout hyperlink for this text
/>
</LinearLayout> ...this is the parent linear layout 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:42:09.303

对于您创建登录屏幕的情况，这并不重要，因为它是一个相对容易设计的屏幕。我个人喜欢使用 XML 来设计我的布局，但从未见过使用这种`onDraw`方法完成它。

正如@codeMagic 所说，我对您的建议是学习如何使用和操作`RelativeLayouts`，因为这些会阻止您创建真正不推荐并且需要很长时间才能加载的级联布局。

当我开始为 Android 编程时，我发现`LinearLayout`它是最容易理解和使用的，但使用它会使我进入复杂屏幕设计`LinearLayouts`的许多内部`LinearLayouts`，后来使用 RelativeLayout 我意识到在大多数情况下，一个`RelativeLayout`可以替换许多级联线性的。

在你的情况下，你可以做这样的事情：

```
 <RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

      <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:src="@drawable/drop_down_icon" />

   <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/imageView1" >

    </EditText>

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText1" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/editText2"
        android:layout_centerHorizontal="true"
        android:text="Button" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/button1"
        android:layout_centerHorizontal="true"
        android:text="TextView" />

</RelativeLayout> 
```

剩下的就是添加所需的填充和边距。

# c++ - 如何解决同名函数和类之间的模棱两可的情况？

> ID：15317218
> 
> 赞同：2
> 
> 时间：2013-03-09T23:40:56.800
> 
> 标签：c++, class, function, ambiguous

如果未调用 test，则此代码编译没有任何问题，因此我得出结论，c++ 允许创建具有相同名称的类和函数：

```
class test {};
void test() {}

int main() {
  test an_instance_of_test;
} 
```

错误是：

```
<stdin>: In function 'int main()':
<stdin>:5:8: error: expected ';' before 'an_instance_of_test'
<stdin>:5:27: warning: statement is a reference, not call, to function 'test' [-Waddress] 
```

而且我知道我不应该首先创建这样的明确性，但是这可能会在其他人的代码中遇到，我问是否有办法在不改变函数或类定义的情况下摆脱这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T23:42:56.723

您应该使用详细的类型说明符：

```
class test an_instance_of_test; 
```

正如标准所说（§3.4.4）：

> 详细类型说明*符*(7.1.6.3) 可用于引用先前声明*的类名*或*枚举名*，即使该名称已被非类型声明隐藏。

名称查找只是忽略任何非类型的名称：

> 根据 3.4.1 查找标识符，但忽略已声明的任何非类型名称。

# c# - 不同表的两个主键作为另一个表的外键

> ID：15317219
> 
> 赞同：0
> 
> 时间：2013-03-09T23:41:13.923
> 
> 标签：c#, .net, sql, winforms

我有一个带有 DataGridView、3 个表和一些查询的 winForms 应用程序。

假设我有表格，A，B，C。在表 AI 和表 B 中有一个自动递增的主键。表 A 和 B 都是陌生人。

表 C 是一个包含 2 列的连接表：

1) 主键

2）B主键

现在，在表单中我有一个按钮，它只是以编程方式插入表 A 和 B 的值。我要做的是将表 A 和 B 的主键插入表 C 中的右列。是否可能以编程方式进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:53:08.543

如果您使用 sql server，您可以在 buttonclick 代码中运行：

```
declare @aid int, @bid int 
insert A(col1) values(val1) 
set @aid = scope_identity()

insert B(col1) values(val1) 
set @bid = scope_identity()

insert C(aid, bid) values(@aid, @bid) 
```

# extjs - sencha cmd extjs 构建不包括 MVC 控制器

> ID：15317222
> 
> 赞同：2
> 
> 时间：2013-03-09T23:41:54.137
> 
> 标签：extjs, cmd, extjs4.1

当我“编译”我的 extjs MVC 应用程序（版本 4.1.1a，CMD 版本 3.0.2.288）时，会创建一个**all-classes.js文件，但是没有包含我的自定义代码（控制器、视图等）。**当我加载 html 页面时，它们会被动态加载。我有另一个运行良好的应用程序。我无法发布我的数百行代码。我可以寻找什么？

我在调试模式下尝试了 CMD 构建，它似乎可以处理并找到我所有的应用程序文件，它只是不包含在 all-classes.js 中。

我试过了

```
 sencha -d app build 
```

和

```
 sencha compile -classpath=app/app.js,app,ext/src  page -in=index.html -out=build/index.html 
```

我使用“sencha generate app”来创建原始目录结构等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:04:47.480

我有完全相同的问题。也许作为一个提示，我有另一个项目，我在其中生成了整个应用程序和构建。在这里，通过 build-impl.xml，我得到了所有类中所需的一切：我的控制器、模型等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T00:48:13.083

不知道为什么，但似乎如果我在我的 app.js 文件中的控制器上明确执行“要求”，那么编译工作

```
 Ext.Loader.setConfig({ enabled: true });
 Ext.require([
     'AM.controller.myController1'
   , 'AM.controller.myController2'
.
. 
```

# php - 消息：试图获取非对象的属性

> ID：15317225
> 
> 赞同：0
> 
> 时间：2013-03-09T23:42:04.427
> 
> 标签：php

我的项目有很大的延误...我试图了解问题所在，但找不到解决方案。我在我的页面上看到这些消息

> 遇到 PHP 错误 严重性：通知消息：尝试获取非对象文件名的属性：controllers/help.php 行号：243
> 
> 遇到 PHP 错误严重性：通知消息：尝试获取非对象文件名的属性：controllers/help.php 行号：244
> 
> 遇到 PHP 错误 严重性：通知消息：尝试获取非对象文件名的属性：controllers/help.php 行号：245

我的控制器上的第 243、244、245 行如下

我在第 243、244、245 行之间为张贴的图片创建了一个空格

```
$this->template->write('meta_title',$school_details->title.'-'.$data['site_setting']['site_name'].' School-'.$meta['title'], TRUE);
        $this->template->write('meta_description', $school_details->title.'-'.$data['site_setting']['site_name'].' School-'.$meta['meta_description'], TRUE);
        $this->template->write('meta_keyword', $school_details->title.'-'.$data['site_setting']['site_name'].' School-'.$meta['meta_keyword'], TRUE); 
```

在我的 URL 下方，我还收到另一个错误，即

遇到 PHP 错误

> 严重性：通知消息：试图获取非对象的属性文件名：default/school_detail.php 行号：11
> 
> 遇到 PHP 错误 严重性：通知消息：尝试获取非对象文件名的属性：default/school_detail.php 行号：14

现在第11至18页是我的观点如下

```
<div class="faq_list_div">

            <h3 class="faq_heading_title"><?php echo $school_details->title; ?></h3>

            <div style="padding-top:13px;">
            <?php $content=$school_details->description;
                $content=str_replace('KSYDOU','"',$content);
                $content=str_replace('KSYSING',"'",$content); 

                echo $content; ?>
            </div> 
```

怎么了？当我使用希腊语时，参数运行良好（英语）是另一个故事，虽然是在 UTF8 上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:44:46.140

你确定`$school_details`是一个对象？如果没有设置，或者不是对象，就会出现这个错误。

# python - Python IMAP：无法将电子邮件标记为已见

> ID：15317229
> 
> 赞同：3
> 
> 时间：2013-03-09T23:42:13.703
> 
> 标签：python, imap, imaplib

我正在尝试使用 Python IMAP 库将电子邮件设置为已读。就像在这个例子中一样： [Python、IMAP 和 GMail。将消息标记为已查看](https://stackoverflow.com/questions/2251977/python-imap-and-gmail-mark-messages-as-seen)

我选择一个 GMail 帐户的“所有电子邮件”文件夹，然后通过搜索命令获取特定电子邮件的 UID。然后我使用该 UID 尝试将其标记为已读，但失败了。

```
 result, data = mail.uid('fetch', email_uid, '(FLAGS)')

    print "RESULT: ",result,data

    mail.select(folder_name, readonly=False)
    result, data = mail.store(email_uid, '+FLAGS', '\\Seen')

    print "RESULT OF OPERATION FOR UID",email_uid,result,data 
```

无论我运行这段代码多少次，我总是获得不包含 \Seen 标志的标志。

示例执行（忽略 Django 打印）：

```
FINAL QUERY: (SENTSINCE 07-Mar-2013 SENTBEFORE 11-Mar-2013 LARGER 7508 SMALLER 7510)
RESULT:  OK ['31424 (UID 54264 FLAGS (NotJunk $NotJunk))']
RESULT OF OPERATION FOR UID 54264 OK [None]

[09/Mar/2013 17:30:37] "GET /api/mark_as_read/320/?token=8e3c057b841b75c864685786b2a9657aadf17e3bfb991b103b7c4b3ffdd2a753&refresh_mode=all&folder_mode=inbox HTTP/1.1" 200 144
FINAL QUERY: (SENTSINCE 07-Mar-2013 SENTBEFORE 11-Mar-2013 LARGER 7508 SMALLER 7510)
RESULT:  OK ['31424 (UID 54264 FLAGS (NotJunk $NotJunk))']
RESULT OF OPERATION FOR UID 54264 OK [None]

[09/Mar/2013 17:30:44] "GET /api/mark_as_read/320/?token=8e3c057b841b75c864685786b2a9657aadf17e3bfb991b103b7c4b3ffdd2a753&refresh_mode=all&folder_mode=inbox HTTP/1.1" 200 144
FINAL QUERY: (SENTSINCE 07-Mar-2013 SENTBEFORE 11-Mar-2013 LARGER 7508 SMALLER 7510)
RESULT:  OK ['31424 (UID 54264 FLAGS (NotJunk $NotJunk \\Seen))']
RESULT OF OPERATION FOR UID 54264 OK [None] 
```

我尝试了多种变体。我尝试设置标志\Seen，Seen，\Seen，SEEN，带括号，不带括号，并且不知道除此之外我可以尝试什么。

我怀疑这里可能有一些非常具体的细节 - 也许GMail“所有电子邮件”文件夹不允许将电子邮件标记为已读？

我也不知道，在 mail.store 命令返回的 (result,data) 元组中，data 变量是否应该具有“[None]”变量以正常执行，或者它是否意味着某事是错的。

如果我尝试设置像 \\Seen 之类的错误标志，则 mail.store 命令会引发错误。因此，当设置 \Seen 标志时，它是一个有效的 IMAP 标志。

我不知道接下来要尝试什么。

任何帮助都会非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T15:31:59.673

STORE 命令的[IMAP 规范](https://www.rfc-editor.org/rfc/rfc2060.html#section-6.4.6)没有通过 UID 设置标志的选项。您只能通过`message set`. *它有时*
起作用的唯一原因是您的 UID 和消息集的序列相对接近（vs ）。*`31424``54264`*

 *```
RESULT:  OK ['31424 (UID 54264 FLAGS (NotJunk $NotJunk))'] 
```

您实际上并**没有**通过 设置标志`UID`，而是通过...设置它们，`message set`这有时对应于`UID`.

* * *

但是，您**可以**设置标志`UID`（只是不使用`STORE`命令）。你可以发出一个[UID 命令](https://www.rfc-editor.org/rfc/rfc3501#section-6.4.8)，第一个参数是`store`设置标志：

```
result, data = mail.uid('store', '542648', '+FLAGS', '(\\Seen)') 
```

如果成功，服务器将使用与`message set`您使用的 UID 对应的响应 - 例如（使用您的示例）：

```
OK ['31424 (FLAGS (\\Seen))'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-09T13:14:03.903

您可以使用 imap_tools 包： [https ://pypi.org/project/imap-tools/](https://pypi.org/project/imap-tools/)

```
with MailBox('imap.mail.com').login('test@mail.com', 'pwd', initial_folder='INBOX') as mailbox:

    # SEEN: mark all messages sent at 05.03.2007 in current folder as unseen, *in bulk
    mailbox.seen(mailbox.fetch("SENTON 05-Mar-2007"), False) 
```*

# python - Python 3.2：cx_freeze 编译我的程序，但处于调试模式

> ID：15317231
> 
> 赞同：3
> 
> 时间：2013-03-09T23:42:28.830
> 
> 标签：python, debugging, python-3.x, pygame, cx-freeze

我正在使用 Python 3.2 和 Pygame 制作游戏。我已经成功地使用`cx_freeze`将所有内容捆绑到一个可执行文件中，并且它运行了。美好的。唯一的问题是，**即使我将`-OO`标志传递给 my `setup.py`，我的游戏也是在调试模式下编译的。** （我已经用确实是的`print`陈述证实了这一点。）`__debug__``True`

问题是，我的游戏具有在发布模式下自动禁用的调试功能。我不想分发我的游戏的调试功能，也不想手动从代码中删除它们。

为简洁起见，此处缩写为My `setup.py`，如下所示：

```
from cx_Freeze import setup, Executable

includes     = [<some modules>]
excludes     = [<some unwanted modules>]
include_files = [<game assets>]

build_options = {
                 'append_script_to_exe':True,
                 'bin_excludes':excludes,
                 'compressed':True,
                 'excludes': excludes,
                 'include_files': include_files,
                 'includes': includes,
                 'optimize':2,
                 'packages': ['core', 'game'],
                 }

common_exe_options = {
                      'appendScriptToExe'  : True,
                      'appendScriptToLibrary':True,
                      'compress'           : True,
                      'copyDependentFiles' : True,
                      'excludes'           : excludes,
                      'includes'           : includes, 
                      'script'             : '__init__.py',
                     }

executable = Executable(**common_exe_options)

setup(name='Invasodado',
      version='0.8',
      description='wowza!',
      options = {'build_exe': build_options,
                 'bdist_msi': build_options},
      executables=[executable]) 
```

与我的其他代码一样，完整的脚本可以在[https://github.com/CorundumGames/Invasodado/blob/master/setup.py](https://github.com/CorundumGames/Invasodado/blob/master/setup.py)找到。

在 Ubuntu 12.10 上，我正在使用`python3.2 -OO setup.py build`. 在 Windows XP 上，我正在使用`C:\Python32\python -OO setup.py build`.

任何帮助都是极好的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:45:22.220

有两件稍微不同的事情：将代码编译为字节码的优化，以及解释器运行时的优化。设置`optimize`cx_Freeze 的选项会优化它生成的字节码，但解释器仍然使用`__debug__ == True`.

似乎没有简单的方法为嵌入式解释器设置调试标志。它忽略了`PYTHONOPTIMIZE`环境变量。作为一种解决方法，您可以使用如下调试标志：

```
debug = __debug__ and not hasattr(sys, 'frozen') 
```

# css - 使用小型浏览器时，响应式设计 CSS 会填满整个屏幕

> ID：15317232
> 
> 赞同：4
> 
> 时间：2013-03-09T23:42:36.020
> 
> 标签：css, responsive-design

我正在尝试使用响应式 css 媒体查询来隐藏我的侧边栏，除非屏幕很大，或者平板电脑足够大并且处于横向模式。它似乎是基于调整我的浏览器大小来工作的，直到我达到一定的大小，它才会填满整个屏幕。我也在使用 Twitter Bootstrap 样式，但不是响应式样式，所以我不明白这可能是个问题。

我应该使用其他媒体查询吗？我还尝试了`min-width`0 和`max-width`320 的一个，但没有用。

例子： ![工作侧边栏，填充侧边并显示](../Images/4a5fd143f9a9aa1171d542a8ed46ae9d.png) ![不工作，一旦达到一定的大小，它会填满整个浏览器窗口](../Images/7511152d3330a28b0b58bf8b1e3d2fc4.png)

HTML：

```
<div class="row">
    <div class="span2 sidebar">
        <a href="@Url.Action("Index", "Home")">
            <h3>Link Home</h3>
        </a>
    </div>
    <div class="span10">
        @RenderBody()
    </div>
</div> 
```

CSS

```
html {
    height: 100%;
}

.sidebar {
    background: #333;
    margin: 0;
    padding-left: 1.5em;
    height: 100%;
    -moz-box-shadow: 0 0 5px #888;
    -webkit-box-shadow: 0 0 5px#888;
    box-shadow: 0 0 5px #888;
    min-height: 100%;
    position: absolute;
    display: none;
}

h1, h2, h3, h4, h5, h6 {
    font-family: 'Fenix', serif;
    font-weight: 400;
}

/* Smartphones (portrait and landscape) ----------- */
@media only screen and (min-device-width : 320px) and (max-device-width : 480px) {
    /* Styles */
    .sidebar {
        display: none;
    }
}

/* Smartphones (landscape) ----------- */
@media only screen and (min-width : 321px) {
    /* Styles */
    .sidebar {
        display: none;
    }
}

/* Smartphones (portrait) ----------- */
@media only screen and (max-width : 320px) {
    /* Styles */
    .sidebar {
        display: none;
    }
}

/* iPads (portrait and landscape) ----------- */
@media only screen and (min-device-width : 768px) and (max-device-width : 1024px) {
    /* Styles */
    .sidebar {
        display: none;
    }
}

/* iPads (landscape) ----------- */
@media only screen and (min-device-width : 768px) and (max-device-width : 1024px) and (orientation : landscape) {
    /* Styles */
    .sidebar {
        display: block;
    }
}

/* iPads (portrait) ----------- */
@media only screen and (min-device-width : 768px) and (max-device-width : 1024px) and (orientation : portrait) {
    /* Styles */
    .sidebar {
        display: none;
    }
}

/* Desktops and laptops ----------- */
@media only screen and (min-width : 1224px) {
    /* Styles */
    .sidebar {
        display: block;
    }
}

/* Large screens ----------- */
@media only screen and (min-width : 1824px) {
    /* Styles */
    .sidebar {
        display: block;
    }
}

/* iPhone 4 ----------- */
@media only screen and (-webkit-min-device-pixel-ratio : 1.5), only screen and (min-device-pixel-ratio : 1.5) {
    /* Styles */
    .sidebar {
        display: none;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T00:04:21.370

只需使用

```
// Landscape phone to portrait tablet
@media (max-width: 767px) {
    .sidebar {
            display: none;
    }
} 
```

为什么在使用 twitter bootstrap 时不使用响应式 css？有一个类叫`.hidden-phone`，非常有用。

最常用的媒体查询是

```
// Large desktop
@media (min-width: 1200px) {
}

// Portrait tablet to landscape and desktop
@media (min-width: 768px) and (max-width: 979px) {
}

// Everything below 1024px
@media (max-width: 979px) {
}

// Landscape phone to portrait tablet
@media (max-width: 767px) {
}

// Landscape phones and down
@media (max-width: 480px) {
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-10T00:04:07.163

Bootstrap 具有[响应式实用程序类](http://twitter.github.com/bootstrap/scaffolding.html#responsive)，可帮助您轻松完成此操作。例如 .hidden-phone、.visible-desktop

与其让你的生活复杂化并创建自定义的 CSS 类，不如尝试一些简单的事情：

```
<div class="row">
<div class="span2 sidebar hidden-phone">
    <!-- sidebar details -->
    </a>
</div>
<div class="span10">
    <!-- main body -->
</div>
</div> 
```

祝你好运！

# java - 是否可以使用 Tibco 队列客户端查看收到的队列消息？

> ID：15317233
> 
> 赞同：0
> 
> 时间：2013-03-09T23:42:43.470
> 
> 标签：java, queue, jms, tibco, inspect

我们正在使用 JMS API 的 Tibco 客户端实现。我们有`MessageListener`一个`onMessage()`实现。

Tibco 客户端有没有办法检查队列中过去（收到）的消息？（我意识到这完全忽略了队列的逻辑概念——我想知道队列实现是否提供了这种解决方法。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T10:19:26.600

客户端使用 QueueBrowser 对象来查看队列中的消息而不删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:02:01.147

@hawkeye 无法浏览过去的消息...在任何时间点，您都只能浏览待处理消息的目的地。

```
There is no way for you browse all the received messages as EMS server usually deletes the message once it has delivered ( acknowledged) for the given delivery mode.
One possible way is to a send copy of the messages to another queue (without any receivers) before actually confirming  the messages.
Also it depends on your acknowledgement mode and logic involved. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T08:59:57.100

不，不适用于“过去”消息。

接收者确认的消息将从队列中删除 - 因为它们的“功能”已经完成。

您可以将侦听器配置为将您的消息保存在某个数据库或文件中 - 但用于将来的消息。

# html - HTML 问问题

> ID：15317236
> 
> 赞同：3
> 
> 时间：
> 
> 标签：html, tags, toolbar, space

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:11:04.143

添加`padding-top`到`body`等于工具栏高度的元素（40px）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T10:14:54.433

```
:target {
     display:block;
     padding-top: 20px;
} 
```

这会将目标元素的行为更改为块并应用填充。请注意，如果您仅在块级元素（[示例](http://jsfiddle.net/g9ZMv/)）上使用，`display:block`则没有必要。`id`

另请注意，如果您链​​接到句子中间的单词，这肯定不起作用。在这种情况下，您将不得不使用 JavaScript。

# backbone.js - 如何使用嵌套属性设置主干模型 idAttribute

> ID：15317240
> 
> 赞同：3
> 
> 时间：2013-03-09T23:43:27.050
> 
> 标签：backbone.js, backbone-model

我的模型结构如下：

```
model = {
    distance: 12.05,
    widget: {
        id: 1,
        creationDate: '12/01/2012'
    }
} 
```

如何将模型的 idAttribute 设置为小部件属性上的 id？有没有语法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:56:39.890

How about rearranging/flattening your model to make id a top-level property? Override parse and you won't need to set the idAttribute:

```
var YourModel = Backbone.Model.extend({
    parse: function (response) {
        var distance = response.distance;
        response = response.widget;
        response.distance = distance;
        return response;
    }
}); 
```

Now id will be automatically picked up by Backbone as the id. If you need to persist your data back to your datastore, you'll need to overwrite methods necessary to transform the data back. If possible, it would be a better solution if your model came structured with id already at a top level.

# c# - 在 WinRT 中对依赖属性进行分类

> ID：15317250
> 
> 赞同：2
> 
> 时间：2013-03-09T23:45:10.727
> 
> 标签：c#, xaml, windows-runtime, dependency-properties, expression-blend

在 WPF 中，Silverlight 等。您可以使用[System.ComponentModel.CategoryAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.categoryattribute.aspx)类对依赖项属性进行分类。

如何在 WinRT 中对我的 DependencyProperties 进行分类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T15:01:42.387

WinRT目前不支持，可能会在以后的版本中。但目前它还不是 ComponentModel 的一部分。

# spotify - Spotify：如何使播放列表项可点击？

> ID：15317252
> 
> 赞同：1
> 
> 时间：2013-03-09T23:45:24.173
> 
> 标签：spotify

我正在制作一个 Spotify 应用程序，它会制作一个默认样式的播放列表，如 api-tutorial 中所示。

但是，列表中的元素不是像常规 Spotify 曲目列表中那样的可点击链接。

如何使播放列表“活动”，以便例如单击专辑名称将带您进入该专辑的页面。（或艺术家等）？

谢谢，鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T20:32:20.470

指向 Spotify 实体的链接与普通链接的工作方式相同，但该`href`属性具有 Spotify URI 的值。这里有一些例子：

```
<!-- link for an artist -->
<a href="spotify:artist:4F84IBURUo98rz4r61KF70">The White Stripes</a>

<!-- link for an album -->
<a href="spotify:album:748dZDqSZy6aPXKcI9H80u">good kid, m.A.A.d city</a>

<!-- link for a track -->
<a href="spotify:track:5h5tBFnbcVioFXiOixTn6E">Bitch, Don't Kill My Vibe</a>

<!-- link for a playlist -->
<a href="spotify:user:nurilla:playlist:2Uog3C32oF7px4JFHpuGtJ">Divos que son divinos</a>

<!-- link for a user -->
<a href="spotify:user:jrufi91">Julio</a> 
```

在[Spotify 应用教程](https://github.com/spotify/apps-tutorial)中有这样的示例，运行名为*[Return metadata 的示例和给定的搜索查询](https://github.com/spotify/apps-tutorial/blob/master/tutorials/search/search.html)*。

您还可以使用 Javascript 导航到某个页面，使用以下[`openURI`](https://developer.spotify.com/docs/apps/api/1.0/api-models-application.html#openURI)函数：

```
models.application.openURI('spotify:artist:4F84IBURUo98rz4r61KF70'); 
```

可以通过右键单击实体并选择“复制 Spotify URI”来获取 Spotify URI。

# java - 两种不同 JMS 队列侦听器的创造性解决方案 (Tibco)

> ID：15317255
> 
> 赞同：1
> 
> 时间：2013-03-09T23:46:07.317
> 
> 标签：java, queue, jms, listener, tibco

我们遇到了两个不同的应用程序实例间歇性地在同一个队列中侦听的情况。

合乎逻辑的解决方案是将其中一个指向其他地方或关闭其中一个。

我想知道是否有一种方法可以配置 Tibco JMS 配置以强制关闭，或者只向一个客户端发送消息事件？我一直在寻找一种“开箱即用”的方式来思考这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:04:23.970

也许EMS的“独家”功能就是您正在寻找的……

通过在队列上设置此属性，一次只能有一个侦听器在侦听。

这是一个相关链接：[https ://docs.tibco.com/pub/enterprise_message_service_central_administration/1.0.1_may_2009/html/tib_ems_users_guide/wwhelp/wwhimpl/common/html/wwhelp.htm#href=EMS.5.028.htm&single=true](https://docs.tibco.com/pub/enterprise_message_service_central_administration/1.0.1_may_2009/html/tib_ems_users_guide/wwhelp/wwhimpl/common/html/wwhelp.htm#href=EMS.5.028.htm&single=true)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T10:12:33.627

消息总是平均分布在侦听器之间。如果需要，可以使用消息选择器。如果 QueueReceiver 指定了消息选择器，则未选择的消息将保留在队列中。根据定义，消息选择器允许 QueueReceiver 跳过消息。这意味着，当最终读取跳过的消息时，读取​​的总顺序不会保留每个消息生产者定义的部分顺序。只有没有消息选择器的 QueueReceiver 才会按照消息生产者顺序读取消息。

# magento - 从模块 config.xml 中禁用核心 magento 模块

> ID：15317256
> 
> 赞同：2
> 
> 时间：2013-03-09T23:46:07.497
> 
> 标签：magento

Magento 是否可以从自定义模块 config.xml 中完全禁用核心模块（不仅仅是模块输出）？

如果有怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:50:55.827

在 /app/etc/modules 下，您有一个 Mage_Module.xml 文件在此文件中，您有一个启用的节点为 true，将其设置为 false ;)

而已

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T03:05:11.230

很少有模块可以禁用，但不是全部。例如，不应禁用 Mage Core。

此外，在禁用任何模块时，检查是否有任何其他模块依赖于该模块。因为依赖的模块也将被禁用。

例如在 Mage_Module.xml

```
<Mage_Customer>
    <active>true</active>
    <codePool>core</codePool>
    <depends>
        <Mage_Eav/>
        <Mage_Dataflow/>
        <Mage_Directory/>
    </depends>
</Mage_Customer> 
```

将其更改为

```
<Mage_Customer>
    <active>flase</active>
    <codePool>core</codePool>
    <depends>
        <Mage_Eav/>
        <Mage_Dataflow/>
        <Mage_Directory/>
    </depends>
</Mage_Customer> 
```

将禁用客户模块。

# ruby-on-rails - 使用 Rails 和 AngularJS 的嵌套表单问题

> ID：15317263
> 
> 赞同：3
> 
> 时间：2013-03-09T23:47:51.027
> 
> 标签：ruby-on-rails, json, angularjs, nested-forms

我对 js 和 Angular 还很陌生，但是在观看了 Ryan Bates 在 Rails+AngularJS 上的 railscast（[http://railscasts.com/episodes/405-angularjs?autoplay=true](http://railscasts.com/episodes/405-angularjs?autoplay=true)）之后，我试图让 Rails 应用程序正常工作。

我相信我想做的事情相当简单：我有一个 Place 模型，其中包含许多电话，并且我希望能够在创建新地点时动态添加和保存电话。这种类型的嵌套表单仅在 Rails 中相当容易（js 仅在用户添加电话时创建新的字段元素），但我想在 Angular 中执行此操作。

我想我的问题分为两个：1）在 Rails+AngularJS（甚至一般的表单）中创建嵌套表单的最佳实践是什么？现在我通过 JSON 将每个模型传递给 Angular，但这是最好的方法吗？

我的第二个问题是指以下代码。

我试图这样做，我能够以角度保存一个地方：

places_controller.rb

```
respond_to :json 
def create
  respond_with Place.create(params[:place])
end 
```

_form.html.erb

```
<div class="container-fluid" ng-controller="PlaceCtrl">
  <form ng-submit="addPlace()">
    <div class="row-fluid">
      <div class="span2"><label>Name</label></div>
      <div class="span8"><input type="text" class="input-xlarge" ng-model="newPlace.name"></div>
    </div>
    <input type="submit" class="btn" value="Add">
  </form>
</div> 
```

place.js.coffee

```
app = angular.module("test", ["ngResource"])

app.factory "Place", ($resource) ->
  $resource("/places/:id", {id: "@id"}, {update: {method: "PUT"}})

app.factory "Phone", ($resource) ->
  $resource("/phones/:id", {id: "@id"}, {update: {method: "PUT"}})

@PlaceCtrl = ($scope, Place, Phone) ->

  $scope.addPlace = ->
    place = Place.save($scope.newPlace)
    console.log place
    $scope.newPlace = {} 
```

在 place.js.coffee 中，我可以将 Place 保存到 DB 行中（place = Place.save($scope.newPlace)）。我想要地点的 id，所以我可以将它附加到所有动态构建的电话上（因为电话有一个指向地点的 place_id 的 FK）。但是，如果我在控制台中输入 place.id，我会收到一条未定义的消息。place.name 将返回该地点的名称，但 id 不起作用。但是，如果我查看 console.log 位置，我会看到返回并填充了 id 字段。

2) 如何获取地点 JSON 对象的 id 字段？我几乎肯定这是可能的，因为 Chrome 的控制台返回 id 字段但 place.id 不会给我任何东西。

预先感谢您的帮助。我非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T19:17:29.007

我会尝试这样的事情：

```
$scope.addPlace = ->
  place = Place.save($scope.newPlace) ->
    $scope.newPlaceId = place.id
  console.log place
  $scope.newPlace = {} 
```

# android - 通过表单将文件从 Android 上传到 GAE

> ID：15317270
> 
> 赞同：1
> 
> 时间：2013-03-09T23:48:30.747
> 
> 标签：android, google-app-engine, blobstore

我在 GAE 上有一个应用程序：http: [//1.myawesomecity.appspot.com/](http://1.myawesomecity.appspot.com/)

固定的：

```
 HttpPost post = new HttpPost("http://1.myawesomecity.appspot.com/");
                http_client.getParams().setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);
                String result = EntityUtils.toString( http_client.execute(post).getEntity(), "UTF-8");
                String actualURL = result.substring(result.indexOf("http://"), result.indexOf("\" method"));
                Log.w("asdf", "url " + actualURL );

                post = new HttpPost(actualURL);
                http_client.getParams().setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);                    
                MultipartEntity entity = new MultipartEntity( HttpMultipartMode.BROWSER_COMPATIBLE );
                String mime_type = "image/png";
                File file = new File( filename ); //context.getFilesDir(), 
                entity.addPart( "myFile", new FileBody( file, mime_type));
                post.setEntity( entity );

                String res = EntityUtils.toString( http_client.execute(post).getEntity(), "UTF-8");
                Log.w("asdf", res); 
```

上面从 GAE 服务器获取实际上传 URL，并按照下面正确答案的指示传入文件。

老问题：

如您所见，如果您选择一个文件并点击提交，它将 404，但该文件实际上确实被存储（只要它不是太大，< 100kb）。不要在第一个文本字段中输入任何内容。

现在，抛开这个特定的应用程序几乎没有功能，我正在尝试将一个文件从 Android 上传到这个服务器上。

该站点的上传脚本使用 blobstore，文件字段名称为“myFile”。

现在在我的 Android 应用程序中，我有：

```
 HttpClient httpclient = new DefaultHttpClient();

    HttpPost httppost = new HttpPost(<my app's url>);

    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("myFile", <path to a file selected by user> ) );
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    httpclient.execute(httppost); 
```

这会引发异常。

这与我通过浏览器访问我的网站、选择文件并点击提交有何不同？为什么通过浏览器实际上会通过上传文件，而 Android 代码却没有？

我知道我的文件路径是有效的。有什么我做错了吗？还是从不同于从 Android 执行 httpclient 的浏览器单击“提交”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T02:23:32.253

将文件上传到 GAE 上的 blobstore 是一个两步过程：

1.  首先，您需要获得一个正确的 URL 来发布您的数据，通常人们为此目的使用“/bloburl”处理程序之类的东西

2.  当您有 blob 上传 URL 时，您可以在请求中使用它。

3.  您发送的文件不作为`NameValuePair`，它应该作为`MultiPartEntity`.

这是有效的代码（您需要 apache http 库来支持 MultiPartEntry）：

```
DefaultHttpClient http_client = new DefaultHttpClient();
HttpGet http_get = new HttpGet(Config.BASE_URL + "bloburl");
HttpResponse response = http_client.execute(http_get);
BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
String first_line = reader.readLine();
Log.w(TAG, "blob_url: " + first_line);

HttpPost post = new HttpPost(first_line);
http_client.getParams().setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);
MultipartEntity entity = new MultipartEntity( HttpMultipartMode.BROWSER_COMPATIBLE );

mime_type = "application/zip";
File file = new File( context.getFilesDir(), filename );
entity.addPart( "file", new FileBody( file, mime_type));
post.setEntity( entity );

String result = EntityUtils.toString( http_client.execute(post).getEntity(), "UTF-8");
Log.i(TAG, result); 
```

# php - CakePHP：帖子类型的表组织

> ID：15317276
> 
> 赞同：0
> 
> 时间：2013-03-09T23:49:37.757
> 
> 标签：php, mysql, cakephp

我对 CakePHP 很陌生，我想我已经很快掌握了它的要点。我的问题更多地与 MySQL 有关，但最后我会将 Cake 带回它。

我正在创建一个论坛/公告板类的应用程序。目前，我的数据库中有一个帖子条目，其中包含以下内容：id、title、body 等。

**我的问题：**我想实现各种不同类型的“帖子”。像照片帖子、文字帖子、员工帖子等（类似于 tumblr 组织帖子的方式）。我是否应该为这些帖子的每种类型制作单独的表格，例如 text_posts、photo_posts 等？或者，我是否可以在常规 Post 表中包含诸如“image_url”之类的字段，如果在创建时将其留空，那么我可以让视图将其解释为文本帖子？

如果我要为每种不同类型创建单独的表，我会在公告板控制器中设置所有这些不同的帖子，以便我可以在公告视图中显示它们。但是在视图中，我如何让它们根据创建时间显示在一个不错的提要中？我不想让 for 循环显示所有文本帖子、所有照片帖子等。我希望它们将它们网格在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:00:58.090

在我看来，您的数据库结构中的继承存在问题。

> 关系数据库不支持继承

我知道如何解决这个问题的三种可能方法是：

[1.单表继承](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)（所有帖子一个表，那么会有很多NULL值。）

[2.类表继承](http://martinfowler.com/eaaCatalog/classTableInheritance.html)（尝试实现继承，但将您在 PHP 中创建的每个对象映射到表。）

[3.Concrete Table Inheritance](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)（每种帖子的单独表）

我不知道哪种解决方案更适合您。它们各有优缺点。

**编辑：PHP部分**

虽然我对 PHP 不太了解，但您可能可以这样做：

如果您选择选项 3 将帖子存储在数据库中，您仍然可以选择在 PHP 中引入继承。循环遍历父类对象（Post）并通过检查它是否是该对象类型的实例来显示特定于子对象（照片、文本等）的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T06:19:54.170

理论上，您可以为每个表创建一个不同的表并在其上编写一个视图。不幸的是，MySQL 不支持您需要插入的触发器而不是触发器。这是一个使用 sqlite3 的示例。

```
create table PhotoTable (
id     integer not null PRIMARY KEY AUTOINCREMENT,
PhotoName varchar(255),
Camera    varchar(255)
);

create table StaffTable (
  id integer not null PRIMARY KEY AUTOINCREMENT,
  StaffName varchar(255)
); 

--- Odd way of seeding AUTOINCREMENT value in SQLite3
insert into StaffTable(StaffName) values('odd');
delete from StaffTable;
update SQLITE_SEQUENCE set seq = 100000 where name ='StaffTable';

create view posts as
select id, 'Photo' as Type, PhotoName, Camera, NULL as StaffName from PhotoTable
union all 
select id, 'Staff' as Type, NULL as PhotoName, NULL as Camera,StaffName from StaffTable;

create trigger postsinsert
instead of insert on posts
for each row
begin
    insert into PhotoTable(PhotoName, Camera) select new.PhotoName, new.Camera where New.Type ='Photo';
    insert into StaffTable(StaffName) select new.StaffName where New.Type = 'Staff';
end;

insert into posts(Type, PhotoName, Camera) values('Photo','photo1','nk');
insert into posts(Type, PhotoName, Camera) values('Photo','photo2','canon');
insert into posts(Type, StaffName) values('Staff', 'spaceghost'); 
```

你得到预期的结果

```
 select * from posts;
1|Photo|photo1|nk|
2|Photo|photo2|canon|
100001|Staff|||spaceghost 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:23:43.647

我认为 2 个表应该比为每种类型创建新表更好。

您可以有posts 表和post_types 表，在posts 表中您可以有post_type_id 外键，这将帮助您增加类型，而不必每次都创建一个新表。

然后在帖子表中，使列尽可能通用，例如，您可以有一个“值”列，可用于根据帖子类型保存图像 url 或其他任何内容。

在此阶段还值得考虑的是您的帖子是否需要具有多种类型，在这种情况下，桥接表会很方便，因此一个表用于发布另一个用于类型的表，第三个用于保存帖子和类型 id 作为外键。

# highcharts - Highcharts 使用简化的 xaxis 加载所有数据

> ID：15317281
> 
> 赞同：0
> 
> 时间：2013-03-09T23:50:50.600
> 
> 标签：highcharts, graphing

当我将所有数据加载到图表中时，xaxis 会变得混乱且难以阅读。我每小时可能有 120 条记录，具有一定的价值。有没有办法在 highcharts 中加载我拥有的所有数据并让 xaxis 显示每小时的值？如下图所示：

[http://i.imgur.com/uWkKZ0c.png](http://i.imgur.com/uWkKZ0c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T09:40:45.377

您是否尝试过[http://api.highcharts.com/highcharts#plotOptions.line.pointInterval](http://api.highcharts.com/highcharts#plotOptions.line.pointInterval)？我假设将 pointInterval 设置为 3600*1000 = 1 h 会达到你想要的效果吗？默认情况下，此值为 1，因此混乱。

```
plotOptions: {
        series: {
            pointInterval:  3600 * 1000 // 1 h
        }
    }, 
```

还要检查这个小提琴；[样本/highcharts/plotoptions/series-pointstart-datetime/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-pointstart-datetime/)

# apache - 如何在 Tomcat 和 Apache 服务器中组织文件？

> ID：15317283
> 
> 赞同：1
> 
> 时间：2013-03-09T23:51:05.780
> 
> 标签：apache, jsp, tomcat

我刚刚安装了 Apache 服务器和 Tomcat，我读到我应该将静态 html 页面放在 Apache 中，并将动态页面（如 JSP、Servlet 和所有其他完整的 Java 应用程序）放在 Tomcat 中。具体来说，他们应该分别去哪里？

例如，html 文件是否应该放在 /var/www/html 下？以及 /opt/apache-tomcat-7.0.34/webapps/ 下的所有其他文件？

有这方面的教程吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T09:21:48.660

将请求从 Apache 转发到 Tomcat 的典型方法包括使用 mod_proxy、mod_proxy_ajp 或 mod_jk（可能还有更多）。所有这些都是有据可查的，并且基本上涉及命中您的 Apache 的请求，如果它们符合某些条件（如路径名），则将它们转发到 tomcat - 所有不匹配的请求都将由 Apache 处理，但是您可以配置这个。

但是，我赞同 JB Nizet 的评论：将不同内容的服务划分给 Apache 和 Tomcat 是一种优化。当您不需要时，是否应该添加这种复杂性（不是说它*太*复杂，而是这样做比不分离它更重要）是有争议的。例如，如果您的未优化网站可以处理 1000 个并发用户，但您很少有超过 10 个 - 不要打扰。

# asp.net-mvc - 使用 IQueryables 正确实现存储库模式？

> ID：15317284
> 
> 赞同：2
> 
> 时间：2013-03-09T23:51:09.593
> 
> 标签：asp.net-mvc, web-applications, asp.net-mvc-4

我正在使用 GetObject、UpdateObject、DeleteObject 等方法为我的 MVC 应用程序构建存储库层。

这就是我现在所拥有的：

```
 public List<Object> GetObjects()
        {
            return _db.Objects.Where(o => o.IsArchived == false).ToList();
        } 
```

但我想知道返回列表的 IQueryables 是否会更好，以便在 UoW 或服务层中应用过滤器时将最少量的数据发送到客户端。做这样的事情最好吗？

```
 public IQueryable<Object> GetObjects()
            {
                return _db.Objects.Where(o => o.IsArchived == false);
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T02:48:53.667

返回 IQueryable 的不利之处在于，如果您曾经有不同的存储库实现，例如使用不同的 ORM，将数据存储在非 SQL 数据库、云或 XML 文件中，则很难实现相同的接口。如果您返回更通用的域对象集合，实现起来会容易得多。例如 IEnumerable。您始终可以传递过滤条件。

返回 IQueryable 的另一个缺点是它可能会发生，当您实际运行查询时，您的对象上下文可能已经被释放（取决于您的实现）或者可能在内存中保留的时间超过所需时间。

诸如 IQueryable 之类的泄漏抽象可能会导致问题，例如，假设您想从数据库中获取一些数据并通过 Guid 对其进行排序。如果您`ToList()`在排序之前通过调用来枚举查询，那么如果您在排序之后执行此操作，您将得到不同的结果。原因是，在第一种情况下，排序将发生在 .NET 中，但在其他情况下，它将发生在使用完全不同顺序的 SQL 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T02:27:30.653

在这里返回 IQueryable 的好处是您可以继续进一步构建查询而无需访问数据库。一旦您调用 ToList ，它将访问数据库，并且您无法在不再次访问数据库的情况下进一步自定义查询。

# java - 创建java数组以将数字分数转换为字母等级

> ID：15317285
> 
> 赞同：0
> 
> 时间：2013-03-09T23:51:40.647
> 
> 标签：java, arrays

新手 java 程序员，数组新手，正在处理以下提示的分配：

编写一个程序来绘制考试分数的等级分布。一次输入一个分数，当输入 0（零）分数时循环将中断。输出将为字母等级中的每个分数打印一个 *，并将字母等级放在图表下方的水平轴上。

我的主要问题是创建一个数组，使我能够对每个等级（A、B、C...）的分数求和。我被禁止在此转换中使用 if 或 switch 语句。我想知道从哪里开始创建这个数组。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:00:57.477

Does it have to be an array? If not, a [Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html) is a good choice for this type of scenario. The keys of the map are the various grades (A, B, C, etc) and the value of each key is an integer (or long) to hold the number of grades for that key. So, the basic logic is to get the counter from the map for the grade (i.e. key), increment it and put it back into the map.

If you don't mind using external libraries, then [Guava's Multiset](http://guava-libraries.googlecode.com/svn/tags/release02/javadoc/com/google/common/collect/Multiset.html) is an even better fit.

EDIT: OK so you need to use an array, but one challenge (if I read your post correctly) is that you can't use if or switch statements (presumably to access the array). One possible way around this is to assign 'A' to index 0, 'B' to index 1, etc. Then you can use the following notation for array indexing:

```
char gradeAsChar = ...;  //I'll leave this to you to get the grade as an (uppercase) char
gradesArray[gradeAsChar - 'A'] = gradesArray[gradeAsChar - 'A'] + 1; 
```

'A' - 'A' is 0, 'B' - 'A' is 1, etc. The above, of course, is ripe for index out of bounds issues if the character is unexpected so you'll need some error handling there.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T08:59:05.820

当然，如果你不关心内存效率（在编码时你总是应该这样做！），你可以像这样创建一个新数组：

```
int[] grades = new int[101]; 
```

然后，每当用户输入输入时，您可以执行以下操作：

```
int grade = input.nextInt();
grades[grade] = grades[grade] + 1; 
```

您可以通过运行以下命令来计算等于 A 的等级数：

```
int A = 0;
for (int i = 91; i < 101; i++){
  A += grades[i];
} 
```

当您说不允许使用 if 或 switch 语句时，我就是这么想的。让我知道它是否有帮助。同样，效率非常低，但至少您可以跟踪您拥有的所有分数。这是一个优点。

这应该是 O(n) 的粗略运行时间，但我认为可能会更好。

祝你好运！

**编辑**：您可以通过使用整数除法的概念来执行上述方法的更有效版本。你可能会问什么是整数除法，当你将两个整数相除时，比如 10/3，答案可能是 3.333，但是 java 会丢弃小数部分，所以答案是 3。因此，如果你除以 10，你可以使用结果得到哪些分数是A等等。例如：92/10 = 9、97/10 = 9、83/10 = 8 等。需要注意的是，A 的分数是 91-100，所以在应用这个概念之前你必须减去 1。

这应该将数组从 101 个元素减少到 10 个，因为您只跟踪十位数中的数字，无论如何这更重要。你也许可以进一步优化它，但同样，这不是我的功课，所以我不想花太多时间在上面。我醒来时想到了这个:)。

希望这能给你一些思考！

# java - Java通知和等待异常？

> ID：15317287
> 
> 赞同：-2
> 
> 时间：2013-03-09T23:51:49.497
> 
> 标签：java, multithreading

我正在尝试编写程序以了解有关 Java 线程的更多信息。程序的逻辑很简单，当 TimeCount 类的计数变量等于 5 时，将运行第一个线程。

这是传统的等待通知问题。我不知道代码中的错误在哪里？请帮忙。

```
public class TestThread {

    public static void sleep(int time) {
        try {
            Thread.currentThread().sleep(time);
        } catch (InterruptedException ex) {
            ex.printStackTrace();
        }
    }

    public static void main(String[] args) {

        final MyTimeCount myTimeCount = new MyTimeCount();
        final ReentrantLock myLock = new ReentrantLock();
        final Condition cvar = myLock.newCondition();

        Thread t1 = new Thread(new Runnable() {
            @Override
            public void run() {
                myLock.lock();
                try {
                    while (myTimeCount.getCount() >= 5) {
                        cvar.await();
                    }
                    System.out.println("--- data is ready, so we can go --- ");

                } catch (Exception ex) {
                    ex.printStackTrace();
                } finally {
                    myLock.unlock();
                }               
            }
        });

        Thread t3 = new Thread(new Runnable() {
            @Override
            public void run() {
                while (true) {
                    int count = myTimeCount.increase();
                    if (count == 5) {
                        cvar.signalAll();
                        break;
                    }

                    sleep(6000);
                }
            }
        });

        //-----------
        t1.start();       
        t3.start();
    }
}

class MyTimeCount {
    int count;

    public int increase() {
        count++;
        System.out.println("time increase count=" + count);
        return count;
    }

    public int decrease() {
        count--;
        System.out.println("time decrease count=" + count);
        return count;
    }

    public int getCount() {
        return count;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:56:24.383

你的while循环是倒置的。条件应该是`myTimeCount.getCount() < 5`

# linux - x86 汇编 2 位键盘输入

> ID：15317291
> 
> 赞同：1
> 
> 时间：2013-03-09T23:52:42.367
> 
> 标签：linux, assembly, input, x86

它需要允许输入一个两位数的数字，用于指示名称被打印了多少次。我不知道如何分隔第二个数字并检查它以确保它在 0x30 和 0x39 之间。我也不断得到这个奇怪的盒子，里面有 0017 的名字。

```
 .data   
    input_msg_len:  .long 26
    input_msg:  .ascii "Enter a two-digit number: "
    name:       .ascii "Michael Chabon\n"
    name_len:   .long 16
    max:        .long 0
    count:      .long 0
    tmp:        .long 0
    input_str:  .ascii "??" 

    .text               
    .global _start          
    _start:     
        mov $4, %eax    
        mov $1, %ebx
        mov $input_msg, %ecx
        mov input_msg_len, %edx
        int $0x80

        mov $3, %eax    
        mov $0, %ebx    
        mov $input_str, %ecx 
        mov $2, %edx    
        int $0x80   

        mov $input_str, %eax
        add count, %eax

            mov $input_str, %eax 
        mov (%eax), %bl 
        cmp $0x30, %bl  
        jl  _start      
        cmp $0x39, %bl  
        jg  _start  

        mov count, %eax 
        inc %eax        
        mov %eax, count 

        sub $0x30, %bl
        mov %bl, max

        mov $10, %bl    
        imul    %bl
        mov %bl, max

#Not sure how to check second char in input_str.
#Want to check it then subtract $0x30 and move to tmp before adding tmp to max.

        mov $0, %edi    
    again:
        cmp max, %edi   
        je  end     

        mov $4, %eax    
        mov $1, %ebx    
        mov $name, %ecx
        mov name_len, %edx
        int $0x80       

        inc %edi        
jmp again       

    end:
        mov $1, %eax    
        int $0x80 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:06:40.967

您的代码中有一些错误。

下面，该块的前 2 行是多余的，因为无论如何都会`mov $input_str, %eax`被覆盖。`eax`

```
 mov $input_str, %eax
    add count, %eax

    mov $input_str, %eax 
```

`count`然后在这里，加载到这里是没有意义的`eax`：

```
 mov count, %eax 
    inc %eax        
    mov %eax, count 
```

您可以通过以下方式以更短更清晰的方式执行此操作：

```
 incl count 
```

然后，下一个错误是您最近加载`count`到`eax`，然后将加载到的最低 8 位乘以`count`10 `al`，在这段代码中：

```
 mov (%eax), %bl  // bl = first character
    cmp $0x30, %bl  
    jl  _start      
    cmp $0x39, %bl  
    jg  _start  

    mov count, %eax // eax = count
    inc %eax        // eax++
    mov %eax, count // count = eax

    sub $0x30, %bl  // 0 <= bl <= 9
    mov %bl, max    // max = bl <- you lose this value in the next mov %bl, max

    mov $10, %bl    // bl = 10
    imul    %bl     // ax = 10 * and(count, 0xff) // ax = al*bl (signed multiply)
    mov %bl, max    // max = 10 <- here you overwrite the value of max with 10 
```

所以，根据我的直觉，你不想做`ax = 10 * and(count, 0xff)`，但是`10 * (first number)`。在和`imul %bl`之间进行 o 有符号相乘，并将结果存储在. 所以上面的代码可以改成这样：`al``bl``ax`

```
 mov (%eax), %bl  // bl = first character
    cmp $0x30, %bl  
    jl  _start      
    cmp $0x39, %bl  
    jg  _start  

    incl count

    pushl %eax      // push eax to stack

    sub $0x30, %bl  // 0 <= bl <= 9
    mov $10, %al    // al = 10
    imul     %bl    // ax = 10 * bl (signed multiply)
    mov %al, max    // 0 <= max <= 90 
```

然后，您可以像检查第一个字符一样检查第二个字符：

```
 pop %eax        // pop eax from stack

    incl %eax

    mov (%eax), %bl  // bl = second character
    cmp $0x30, %bl  
    jl  _start      
    cmp $0x39, %bl  
    jg  _start

    sub $0x30, %bl  // 0 <= bl <= 9

    add %bl, max    // 0 <= max <= 99 
```

我强烈建议您学习使用一些调试器。gdb 有几个前端，根据我的经验，我认为 ddd 效果最好。gdbtui 也很方便。

# tomcat - OpenShift 将所有 HTTP 流量重定向到 Tomcat 7 (JBoss EWS 2.0) 上的 HTTPS

> ID：15317294
> 
> 赞同：2
> 
> 时间：2013-03-09T23:52:50.713
> 
> 标签：tomcat, openshift

我想将所有 HTTP 流量重定向到 Tomcat 7（JBoss EWS 2.0）上的 HTTPS，我还没有找到任何可行的解决方案，同时想知道有人知道解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T17:15:14.830

以下是有关 OpenShift 上该主题的知识库：[https ://openshift.redhat.com/community/kb/kb-e1044-how-to-redirect-traffic-to-https](https://openshift.redhat.com/community/kb/kb-e1044-how-to-redirect-traffic-to-https)

希望能帮助到你！

# extjs4.1 - 在 extjs4 mvc 控制器中捕获工具栏项事件

> ID：15317296
> 
> 赞同：2
> 
> 时间：2013-03-09T23:53:01.733
> 
> 标签：extjs4.1, extjs-mvc

我想通过参考从 DistrictMap 控制器的 mapPanel 工具栏中选择 Draw Polygon 按钮，为此我在 DistrictMap 控制器中使用下面的选择器！但它不起作用，我在控制台中看到未定义！

```
Ext.define('FM.controller.DistrictMap',{
extend: 'Ext.app.Controller',
refs:[
    {
        selector: 'mapPanel toolbar > #polygonButton',
        ref: 'polygon'
    }
],
init: function(){
    this.control({
        'mapPanel toolbar > button#polygonButton':{
            click: this.drawPolygon()
        }
    });
},
drawPolygon: function(){
     console.log(this.getPolygon());
} 
```

我使用以下代码将工具栏添加到 mapPanel。

```
Ext.define('FM.view.DistrictPanel',{
extend: 'Ext.panel.Panel',
initComponent: function(){
    var map = Ext.create('FM.view.MapPanel',{});
    map.setPolygonControl();
    map.setModifyControl();
    map.setSelectControl();
    map.addDocked({
            xtype: 'toolbar',
            dock: 'top',
            items:[
                {
                    xtype: 'button',
                    text: 'Draw Polygon',
                    enableToggle: true,
                    toggleGroup: "draw controls",
                    id: 'polygonButton'
                }
           ]}); 
```

上面的选择器不能选择工具栏项目！我测试`'mapPanel toolbar #polygonButton'`了选择器，但它不起作用！为什么选择器`#polygonButton`
不能选择工具栏项目？虽然如果我`#polygonButton`在选择器中只使用 id ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T18:58:13.243

在上面的问题中，因为没有加载 DistrictPanel 视图，所以选择器无法在 mapPanel 工具栏中选择多边形按钮来解决这个问题，你应该使用控制器`onLaunch`函数而不是`init`函数。所以固定代码是：

```
Ext.define('FM.controller.DistrictMap',{
extend: 'Ext.app.Controller',
refs:[
    {
        selector: 'districtPanel mapPanel toolbar #polygonButton',
        ref: 'polygon'
    }
],
onLaunch: function(){
    this.control({
        'districtPanel mapPanel toolbar #polygonButton':{
            click: this.drawPolygon
        }
});
},
drawPolygon: function(){
     console.log(this.getPolygon());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T02:03:05.780

您的选择器意味着`FM.view.MapPanel`xtype 为`mapPanel`. 真的是这样吗？

也不要忘记控制器引用和控制选择器只是组件选择器。您可以在浏览器中打开控制台并使用`Ext.ComponentQuery.query()`.

# java - 场景应该删除图层还是图层自己删除？

> ID：15317297
> 
> 赞同：0
> 
> 时间：2013-03-09T23:53:05.563
> 
> 标签：java, actionscript-3, oop, class, design-patterns

这可能是一个非常新的问题，但我有一个名为 Scene 的类，它有一个名为 Layer 的类的数组。每一层就像一个界面层或游戏画面层，场景调用层的更新和绘制函数等。

我的问题是添加或删除这些图层时，应该是 **scene.addLayer(layer);** 或 **layer.addToScene(scene);** ?

在我看来两者都很好，但是 OOP 中有什么规则吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T19:59:54.977

我不得不说@Java 写了一个可爱的答案，我将为您提供另一种观点。如果您的图层在拥有它们的场景被删除时将被垃圾收集（删除），那么我会继续这样做，`Scene.AddLayer(Layer)`因为它为场景提供了图层上的一些所有权语义。另一方面，如果这些层将由不同的场景共享，我会`Layer.AddToScene(Scene)`出于相反的原因选择。当然这只是个人风格，并不基于任何软件工程原则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:07:19.310

这不是*问题*，但我认为你想要一个意见......

我不知道有任何 OOP 规则不鼓励他们中的任何一个，但我认为`scene.addLayer(layer)`这是最好的，因为它最有意义。假设你有一个放硬币的罐子。你会说`coin.addToJar`吗？***不***，这没有意义！硬币不会自己放进罐子里！你必须告诉罐子接受硬币。即使使用 Java GUI，您也拥有`Container.add(Component)`.

（PS这个问题不一定要在Java标签中，它可以适用于任何面向对象的语言。）

# qt - 带有 Qt5 的 glewInit 返回缺少 GL 版本

> ID：15317300
> 
> 赞同：3
> 
> 时间：2013-03-09T23:53:41.553
> 
> 标签：qt, opengl, qt5, glew

我一直在尝试使用 Qt5 给我一个 OpenGL 上下文，我相信它确实如此，但是当我尝试从 initializeGL 函数中调用 glewInit() 时，错误返回“缺少 GL 版本”，这是我被引导的相信表示没有有效的上下文。我看到的解决方案是从 initializeGL 中调用 glewInit() ......但我已经这样做了。

我将清除颜色和清除设置为深红色，以验证 gl 调用是否正常工作，它们似乎是。

有什么建议么？

**主程序**

```
#define QT_NO_OPENGL_ES_2
#include <QApplication>
#include "glwidget.h"

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    GLWidget w;
    w.show();

    return a.exec();
} 
```

**glwidget.h**

```
#ifndef GLWIDGET_H
#define GLWIDGET_H

#include <GL/glew.h>
#define QT_NO_OPENGL_ES_2
#include <QGLWidget>

class GLWidget : public QGLWidget
{
    Q_OBJECT

public:
    explicit GLWidget(QGLWidget *parent = 0);
    ~GLWidget();

    QSize minimumSizeHint() const;
    QSize sizeHint() const;

protected:
    void initializeGL();
    void paintGL();
    void resizeGL(int width, int height);
};

#endif // GLWIDGET_H 
```

**glwidget.cpp**

```
#include "glwidget.h"

GLWidget::GLWidget(QGLWidget *parent) :
    QGLWidget(parent)
{
}

GLWidget::~GLWidget() {}

QSize GLWidget::minimumSizeHint() const {
    return QSize(640, 480);
}

QSize GLWidget::sizeHint() const {
    return QSize(800, 600);
}

void GLWidget::initializeGL() {
    GLenum err = glewInit();
    if (GLEW_OK != err) {
        printf("GLEW error: %s\n", glewGetErrorString(err));
    } else {
        printf("Glew loaded; using version %s\n", glewGetString(GLEW_VERSION));
    }

    glClearColor(0.2f, 0, 0, 1.0f);
}

void GLWidget::resizeGL(int w, int h) {
}

void GLWidget::paintGL() {
    glClear( GL_COLOR_BUFFER_BIT );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T05:36:41.610

有人告诉我这是因为 QGLWidget 的默认 QGLFormat 使用 OpenGL 版本 1.0（查看 GLEW 的更改日志，他们声称完全支持的最早版本似乎是 1.5）。尝试重写需要 QGLFormat 的 QGLWidget 构造函数，并将使用您所针对的版本的 QGLFormat 实例传递给它。

对您的小部件的调用应类似于：

```
QGLFormat format;
format.setVersion(3,3); // or whatever version you are targeting.
format.setDoubleBuffer(true);

GLWidget * widget = new GLWidget(format); 
```

# c++ - 使用哪种类型的指针来实现对集合元素的共享访问？

> ID：15317301
> 
> 赞同：2
> 
> 时间：2013-03-09T23:53:44.723
> 
> 标签：c++, pointers, set, immutability, shared-ptr

为了使讨论清楚，我将以非常笼统的方式描述问题，即我既不会提供真实类的名称，也不会描述域/上下文（但是，如果事实证明是紧迫的）。

想象课`A`。让这个类有 2 个**不可变**字段，例如`x`和`y`（请注意，这些可能是潜在**的大**对象，即复制效率低下）。此外，让这些`x`和`y`成为**主要**字段，即仅在`==`/`!=`运算符以及哈希计算功能的实现中使用它们。

由于在and方面`A`是**不可变**的，因此我们的想法是让具有(ie )的(say and ) 的多个实例**隐式地**共享对那些and的访问权限，这样就不会出现不必要的重复。`x``y``A``a1``a2``a1.x == a2.x` `a1.y == a2.y``a1 == a2`**`x``y`**

 **此外，现在想象在`A`:中有另一个字段`z`，它是**次要**的和**可变**的，并用作`A`. 通过设计，希望使该字段在**too的****相等**实例之间共享。因此，如果我调用此更改也会影响，因为他们的访问权限是**共享**的。`A` **`a1.setZ(...)``a2``z`**

 ****结果，我们最终得到了一个`A`具有纯**值语义**的类，但在相等的实例中**隐式地**共享其成员。AFAIK 这种模式称为[Flyweight](http://en.wikipedia.org/wiki/Flyweight_pattern)或**aliasing**。

在我们转向这个问题之前，还有一个细节。项目中的大多数类都是使用**Pimpl** idiom 实现的：

```
private:
  class Private;

  Private* p; 
```

阶级`A`不是排斥。这就是为什么提出的实施上述方案的想法如下。

1.  **在Pimpl**成语中使用**共享指针**而`A::Private`不是原始 指针；
***   拥有一组指向;的全局**共享指针**`A::Private`*   在构造函数中`A`检查集合中是否已经存在指向合适的**共享指针**（当然是利用） ，如果是，则简单地设置 它，否则创建新实例并将指向它的**共享指针**存储 在此集合中，类似地设置它;`A::Private``x``y``p``A::Private`**`p`*****   `A::Private`的析构函数应该从集合中移除共享指针**。**`this`****

 ****这看起来是最直接和直观的实现。然而，问题在于，由于这个全局集合拥有一个指向 的**共享指针**，`A::Private`这意味着即使对应的所有实例`A`都被销毁，引用计数器仍将保持在 上`1`，即永远不会到达`0`，因此永远不会释放内存。

我认为如果一些**共享指针**能够提供一种方法来设置引用计数器的下限，那将是一件好事。例如，在这种情况下，我只需将其设置为`1`这意味着当它到达时`1`会释放内存。不幸的是，我没有在流行的库（Boost、Qt、Poco 等）中找到这种行为的任何实现。当然，我可以为我的问题进行手动引用计数，但这感觉不对，而且闻起来像是重新发明轮子。

可能还有其他方法可以解决此问题。期待您的建议。

**注意：**我想立即拦截任何将问题转换为我很清楚的**指针语义的建议。**我需要完全针对上述方案的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:03:24.993

如果我正确理解您的设计问题是什么，那么我会让全局集包含*弱*的、非拥有的指针（例如`weak_ptr<>`），它们能够检查它们是否悬空，但它们不会增加引用计数。

```
std::vector<std::weak_ptr<Private>> _objects; 
```

因此，当一个对象的所有拥有的共享指针都被销毁时，**该对象也将被**销毁**。

现在你的全局集合将留下一个悬空`weak_ptr<>`，但好的是你可以*检查*该指针是否指向一个活着的对象（使用`lock`() 成员函数来获得一个可能的 null `shared_ptr<>`。如果它没有t，你不会取消引用它：

```
// A simple, hypothetical loop through the collection of objects
// which does something, but checks whether the pointers are
// dangling before doing that something on a possibly dead object
// that would be Undefined Behavior)
std::for_each(_objects.begin(), _objecs.end(), [] (std::weak_ptr<Private> p) 
{
    std::shared_ptr<Private> sp = p.lock();
    if (sp != nullptr)
    {
        sp->callMember(); // For instance...
    }
}); 
```

如果您还想`weak_ptr<>`在对象被销毁后从集合中删除对应的对象，那么您可以使用*自定义删除*程序。当对象被销毁时，您的例程将被调用，并将传递指向该对象的指针：此时，在解除分配之前，您可以从集合中擦除相应的元素。

例如，实例化新类型对象并向其`A`返回 a的函数`shared_ptr`可能如下所示：

```
static std::shared_ptr<object> make_A()
{
    std::shared_ptr<Private> sp(
        new Private(),   // Instantiate the object
        [] (Private* p)  // Set up the custom deleter...
        {
            // Remove the corresponding element from the vector...
            _objects.erase(
                // ...so let's find that element!
                std::find_if( 
                    _objects.begin(),
                    _objects.end(),
                    [p] (std::weak_ptr<priv> wp)
                    {
                        // lock() will return a null pointer if wp is dangling
                        std::shared_ptr<priv> sp = wp.lock();

                        // In case wp is not dangling, return true if and only
                        // if it points to the object we're about to delete
                        return ((sp != nullptr) && (sp.get() == p));
                    })
                );
        });
} 
```

在这里，我假设 C++11，你可以在 C++03 中通过用正确定义的函子替换`std::shared_ptr<>`with `boost::shared_ptr<>`、`std::weak_ptr<>`with`boost::weak_ptr<>`和 lambda 轻松地做同样的事情。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T14:01:50.717

你检查[过 Boost.Flyweight](http://www.boost.org/libs/flyweight/doc/index.html)了吗？**********

# javascript - 导航栏

> ID：15317302
> 
> 赞同：2
> 
> 时间：2013-03-09T23:54:09.183
> 
> 标签：javascript, html, css, drop-down-menu, navigation

我正在尝试创建一个鼠标悬停导航站点。我将此作为我的基本设计，但我希望拥有“我们的团队”、位置和患者资源的主要按钮。这是我在尝试更改为鼠标悬停方案之前所拥有的...

```
<div class="title">Division of Gastroenterology</div>
</center>
<div class="left_side">  
<p> Staff</p>
<p><b><a href="faculty.html">Faculty</a></b></p>
<p><b><a href="fellows.html">Fellows</a></b></p>

<p>Locations</p>
<p><b><a href="PCAM.html">Perelman Center for Advanced Medicine</a></b></p>
<p><b><a href="PPMC.html">Presbyterian Medical Center</a></b></p>
<p><b><a href="Radnor.html">Penn Medicine at Radnor</a></b></p>

<p>Patient Resources</p>
<p><b><a href="Preps.html"> Procedure Preps</a></b></p>
<p><b><a href="ProviderNumbers.html">Insurance Provider Numbers</a></b></p>
<p><b><a href="Lichtensteindiet.html">IBD Diet</a></b></p> 
```

我试过这个，但显然错过了一些东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:31:33.960

我过去所做的是将下拉菜单隐藏在屏幕之外，然后当用户将鼠标悬停在链接上时，将下拉菜单重新显示。

我通过使用这样的无序列表来实现这一点：

```
 <ul id="nav">
    <li>Home
         <ul>Link 1</ul>
         <ul>Link 2</ul>
         <ul>Link 3</ul>
    </li>
 ...
 </ul> 
```

并且在 CSS 中将 main`<li>`的位置设置为`relative`, 下拉列表中的`absolute`and`:hover`将`left`位置设置为 0

```
/* --- MAIN LINK --- */
#nav li{
    float:left;
    margin-right:35px;
    position:relative;
}

/*--- DROPDOWN ---*/
#nav ul{
    list-style:none;
    position:absolute;
    left:-9999px; /* Hide off-screen when not needed (this is more accessible than display:none;) */
}

#nav li:hover ul{ 
    left:0; /* Display the dropdown on hover */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:32:08.240

**我认为您正在尝试根据**您发布的信息以及您的一般问题推断出一个导航栏。

**要完全实现这一点，需要进行一些编辑和解释**——这将太长而无法完全完成。所以，我在网上改编了一个很好的解决方案，它使用**无序列表和 CSS**，并提供给您以及链接它的文章。

解决方案尝试：http: [//jsfiddle.net/zFsaF/1/](http://jsfiddle.net/zFsaF/1/)

```
<nav>
    <ul>
        <li><a href="#">Staff</a>
            <ul>
                <li><a href="faculty.html">Faculty</a></li>
                <li><a href="fellows.html">Fellows</a><li>
            </ul>
        </li>
        <li><a href="#">Locations</a>
            <ul>
                <li><a href="PCAM.html">Perelman Center for Advanced Medicine</a></li>
                <li><a href="PPMC.html">Presbyterian Medical Center</a></li>
                <li><a href="Randor.html">Penn Medicine at Randor</a></li>
            </ul>
        </li>
        <li><a href="#">Patient Resources</a>
            <ul>
                <li><a href="Preps.html">Procedure Preps</a></li>
                <li><a href="ProviderNumbers.html">Insurance Provider Numbers</a></li>
                <li><a href="Lichtensteindiet.html">IBD Diet</a></li>
            </ul>
        </li>
    </ul>
</nav> 
```

CSS：

```
nav ul ul {
    display: none;
}

nav ul li:hover > ul {
    display: block;
}

nav ul {
    background: #efefef; 
    background: linear-gradient(top, #efefef 0%, #bbbbbb 100%);  
    background: -moz-linear-gradient(top, #efefef 0%, #bbbbbb 100%); 
    background: -webkit-linear-gradient(top, #efefef 0%,#bbbbbb 100%); 
    box-shadow: 0px 0px 9px rgba(0,0,0,0.15);
    padding: 0 20px;
    border-radius: 10px;  
    list-style: none;
    position: relative;
    display: inline-table;
}
nav ul:after {
    content: ""; clear: both; display: block;
}

nav ul li {
    float: left;
}
    nav ul li:hover {
        background: #4b545f;
        background: linear-gradient(top, #4f5964 0%, #5f6975 40%);
        background: -moz-linear-gradient(top, #4f5964 0%, #5f6975 40%);
        background: -webkit-linear-gradient(top, #4f5964 0%,#5f6975 40%);
    }
nav ul li:hover a {
    color: #fff;
}

nav ul li a {
    display: block; padding: 25px 40px;
    color: #757575; text-decoration: none;
}

nav ul ul {
    background: #5f6975; border-radius: 0px; padding: 0;
    position: absolute; top: 100%;
}
nav ul ul li {
    float: none; 
    border-top: 1px solid #6b727c;
    border-bottom: 1px solid #575f6a;
    position: relative;
}
nav ul ul li a {
    padding: 15px 40px;
    color: #fff;
}   
nav ul ul li a:hover {
    background: #4b545f;
}
nav ul ul ul {
    position: absolute; left: 100%; top:0;
} 
```

文章： http: [//line25.com/tutorials/how-to-create-a-pure-css-dropdown-menu](http://line25.com/tutorials/how-to-create-a-pure-css-dropdown-menu)

您当然可以根据需要随意调整它。

**注意：如果有些事情没有意义，您可以随时参考原始文章，使用谷歌，或查阅非常好的 W3Schools 参考：**

[http://www.w3schools.com/css/css_navbar.asp](http://www.w3schools.com/css/css_navbar.asp)

祝你好运！

更新：

OP 忘了提到**解决方案必须在 Javascript 中**。

**因此，最好的起点是检查已经完成要求的教程。**这是一个很好的起点：

[http://vandelaydesign.com/blog/tools/dropdown-navigation-menus/](http://vandelaydesign.com/blog/tools/dropdown-navigation-menus/)

# php - 此代码是否创建函数的多个实例？

> ID：15317305
> 
> 赞同：1
> 
> 时间：2013-03-09T23:54:35.407
> 
> 标签：php, memory, tree, recursive-datastructures

我正在学习如何构建父/子类别列表。我找到了一个很棒的教程并实现了以下代码：

```
while($row = $tree_sth->fetch()){
    $rows[$row['id']] = array('name'=>$row['name'], 'on'=>$row['on'], 'parent'=>$row['parent']);
}

function btree($parent){

    $has_childs = false;
    global $rows;

    foreach ($rows as $key => $value){
        if($value['parent'] == $parent){
            if ($has_childs === false){
                $has_childs = true;
                echo '<ul>';
            }
            echo '<li>'.$value['name'];
            btree($key);
            echo '</li>';
        }
    }
    if($has_childs === true){
        echo'</ul>';
    }
} 
```

我难以理解的是 PHP 如何处理 foreach 和递归函数。

看来这会导致多个“实例？？” 函数和 foreach 循环同时运行...正确吗？

如果这是正在发生的事情，那么随着我的名单的增长和孩子关系的加深，这似乎可能会放缓。这是真的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:03:02.997

简短的版本是该功能以这种方式工作：

```
Begin-function (first instance):
     Begin-loop:
          Loop...
          Begin-func-again?

               Begin-function (second instance):
                   Begin-loop:
                        Loop... 
                        Begin-func-again?

                             Begin-function (third instance):
                                  Begin-loop:
                                      Loop...
                                      Begin-func-again? (NO)
                                          // termination point reached
                                  End-loop
                             End-function (third instance)

                    End-loop (from second instance)
               End-function (second instance)

     End-loop (from first instance)
End-function(first instance) 
```

并不是同时创建函数的多个版本，它们是按顺序进行的扩展和收缩，但它们都源于原始函数调用。

# arrays - 追加循环/递归/奇怪的错误

> ID：15317307
> 
> 赞同：0
> 
> 时间：2013-03-09T23:54:57.473
> 
> 标签：arrays, matlab, recursion, octave

我有一个 matlab/octave for 循环，它给我一个**inf**错误消息以及不正确的数据

我试图得到**240,120,60,30,15 ......**每个数字都除以 2 然后该数字也除以 2

但是当数字达到 30 和 5 时，下面的代码给了我错误的值，而其他几个它没有被二除。

```
ang=240;
for aa=2:2:10
    ang=[ang;ang/aa];
end

240
120
60
30
40
20
10
5
30
15
7.5
3.75
5
2.5
1.25
0.625
24
12
6
3
4
2
1
0.5
3
1.5
0.75
0.375
0.5
0.25
0.125
0.0625 
```

PS：我将从不同的数组中访问这些值，这就是我使用 for 循环的原因，因此我可以使用它们的索引访问这些值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:08:21.073

除了您开始时的除零错误（在编辑中修复）之外，您所采用的方法实际上并没有按照您的想法进行。如果你打印出每一步，你就会明白为什么。

我建议不要采用这种方法，而是采用更多的“matlab 方式”：通过使用矢量化操作来避免循环。

```
orig = 240;
divisor = 2.^(0:5); #% vector of 2 to the power of [0 1 2 3 4 5]
ans = orig./divisor;

output:
ans = [240 120 60 30 15 7.5] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:22:56.627

尝试以下操作：

```
ang=240;
for aa=1:5
  % sz=size(ang,1);
  % ang=[ang;ang(sz)/2];
    ang=[ang;ang(end)/2];
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:02:53.210

You should be getting `warning: division by zero` if you're running it in Octave. That says pretty much everything.

When you divide by zero, you get `Inf`. Because of your recursion... you see the problem.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-16T16:20:17.887

您可以使用逻辑同时进行泛化和矢量化：

```
ang=240; %Replace 240 with any positive integer you like
ang=ang*2.^-(0:log2(ang));
ang=ang(1:sum(ang==floor(ang))); 
```

这将适用于任何正整数（使其也适用于负数，将 log2(ang) 替换为 log2(abs(ang))），并将生成向量直到它变为奇数的点，此时向量结束。它也比 jitendra 的解决方案更快：

```
octave:26> tic; for i=1:100000 ang=240; ang=ang*2.^-(0:log2(ang)); ang=ang(1:sum(ang==floor(ang))); end; toc;
Elapsed time is 3.308 seconds.
octave:27> tic; for i=1:100000 ang=240; for aa=1:5 ang=[ang;ang(end)/2]; end; end; toc;
Elapsed time is 5.818 seconds. 
```

# ruby-on-rails - Rails 3 gem 用于跟踪法律协议

> ID：15317313
> 
> 赞同：1
> 
> 时间：2013-03-09T23:55:38.380
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem

对于我正在构建的应用程序，我需要用户同意我们的条款和条件，然后我们才能授权他们的帐户。不过，事情有点复杂，因为条款和条件的某些细节是动态的（例如定价），并且会因用户而异。

所以从根本上说，我需要为每个用户生成一份新协议，跟踪他们对这些条款的同意，并记录他/她同意的具体条款。此外，我需要设置某种条款版本控制，这样如果我们更新我们的条款，我们可以看到谁只同意旧条款，并专门向这些帐户发送更新。

写这个似乎并不难，但我很好奇是否有一个像样的开源 gem 已经涵盖了很多这个功能。如果我能帮上忙，我宁愿不重新发明轮子。

# c# - 多行公共覆盖字符串 toString、ArrayList 和 Listbox 输出？

> ID：15317314
> 
> 赞同：1
> 
> 时间：2013-03-09T23:55:41.240
> 
> 标签：c#, listbox, overriding, tostring

我整晚都在努力解决这个 C# 问题。

我有一个覆盖 ToString()，它工作正常，我可以将我的数据放在 ListBox 中。但是由于数据很长，有一堆类，输出变得很长。我希望能够将我的 ListBox 输出分成多行。

这是类文件中的覆盖：

```
//ToString
public override string ToString()
{
    return  "Name " + firstName + lastName + ". Nationality " + nationality + ". Lives in " + address + " " + zipCode + " " + city + " " + country + "."//
        + " Height is " + height + " meters. Hair color is " + hairColor + " and eye color is " + eyeColor + ". Specialmarkings: "//
        + specialMark + ". Is associated with " + association + ". Codename is " + codeName + "Photo (filename): " + photo;

} 
```

这是索引代码：

```
public partial class Index : System.Web.UI.Page
{
    static ArrayList personarraylist;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            personarraylist = new ArrayList();
        }
    }

    protected void ButtonCreate_Click(object sender, EventArgs e)
    {
        //create new object
        Person p = new Person(TextBox1FirstName.Text, TextBox2LastName.Text, TextBox3Nation.Text, TextBox4Address.Text, //
            TextBox5City.Text, TextBox7Country.Text, //
            TextBox10HairColor.Text, TextBox11EyeColor.Text, TextBox12SpecialMark.Text, TextBox13Asso.Text, TextBox14Codename.Text, TextBox15Photo.Text, //
            Convert.ToDouble(TextBox9Height.Text), Convert.ToInt32(TextBox6ZipCode.Text), Convert.ToInt32(TextBox8Pass.Text));
        //add object to arraylist
        personarraylist.Add(p);
    }

    protected void ButtonShow_Click(object sender, EventArgs e)
    {
        //clear list box
        ListBox1.Items.Clear();

        //loop through Arraylist
        for (int i = 0; i < personarraylist.Count; i++)
        {
            ListBox1.Items.Add(personarraylist[i].ToString());
            ListBox1.Items.Add("");
            TextBox1.Text = "";
        }
    }
} 
```

是否可以在 ListBox 中将输出拆分为多行？我试图在覆盖返回中注入一些 html 中断标签，但这些被剥离，是的，这是一个 web 应用程序。

在此先感谢您的时间。PS 我是 C# 的新手（学生），所以请善待；）

**更新：** 大家好，谢谢您的帮助，我已经尝试过 Environment.Newline 和其他解决方案，但是在 ListBox 中显示文本时这些似乎被忽略了。我可以在代码隐藏中看到断点，但在浏览器中，列表框仍将其全部保存在一行中。所以我决定改用 TextBox，它会自动中断文本以及我指出的位置。

```
//loop through Arraylist
        for (int i = 0; i < personarraylist.Count; i++)
        {
            TextBox1.Text += personarraylist[i].ToString();
        } 
```

再次感谢您的帮助:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:00:46.993

You can use [`Environment.NewLine`](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx) or simply `"\n"` to create multiple lines of text.

If that doesn't work, you can try using the [`DataList`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.aspx) control:

```
<asp:DataList id="myDataList" runat="server">
    <ItemTemplate>
        Line 1
        <br />
        Line 2
    </ItemTemplate>
</asp:DataList> 
```

# java - Android Battery information issue

> ID：15317315
> 
> 赞同：0
> 
> 时间：2013-03-09T23:55:45.470
> 
> 标签：java, android, battery

I'm using the following code to get the voltage of a battery at two different times (t1,t2). t1 is before the execution of a task and t2 is after the execution of a task. So by rule, t2 must be smaller than t1\.

However, in execution it is not true. I am getting multiple values, that are greater, smaller and equal to t1\. How could this be possible? Even in android battery monitoring tools, I have noticed that sometimes the total battery mAh value increases few points without plugging the charger.

```
public void onCreate() {
    BroadcastReceiver batteryReceiver = new BroadcastReceiver() {
        int scale = -1;
        int level = -1;
        int voltage = -1;
        int temp = -1;
        @Override
        public void onReceive(Context context, Intent intent) {
            level = intent.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
            scale = intent.getIntExtra(BatteryManager.EXTRA_SCALE, -1);
            temp = intent.getIntExtra(BatteryManager.EXTRA_TEMPERATURE, -1);
            voltage = intent.getIntExtra(BatteryManager.EXTRA_VOLTAGE, -1);
            Log.e("BatteryManager", "level is "+level+"/"+scale+", temp is "+temp+", voltage is "+voltage);
        }
    };
    IntentFilter filter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
    registerReceiver(batteryReceiver, filter);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:36:16.440

Android 框架不断从其 power_supply 子系统获取信息。所以在更新之后，它会发出一个 BATTERY_STATE_CHANGED 意图。

```
private void updateLocked() {
    if (!mUpdatesStopped) {
        // Update the values of mAcOnline, et. all.
        native_update();

        // Process the new values. Sendout the intent
        processValuesLocked();
    }
} 
```

但它只是在一段时间后更新信息。所以它可能包含一定程度的不准确。

在执行na​​tive_update。Android只是简单的读取下一些文件的内容`/sys/class/power_supply/battery`

```
setBooleanField(env, obj, gPaths.acOnlinePath, gFieldIds.mAcOnline);
setBooleanField(env, obj, gPaths.usbOnlinePath, gFieldIds.mUsbOnline);
setBooleanField(env, obj, gPaths.wirelessOnlinePath, gFieldIds.mWirelessOnline);
setBooleanField(env, obj, gPaths.batteryPresentPath, gFieldIds.mBatteryPresent);

setIntField(env, obj, gPaths.batteryCapacityPath, gFieldIds.mBatteryLevel);
setVoltageField(env, obj, gPaths.batteryVoltagePath, gFieldIds.mBatteryVoltage);
setIntField(env, obj, gPaths.batteryTemperaturePath, gFieldIds.mBatteryTemperature); 
```

因此，如果您想要电压信息，您可以简单地：

```
$cat /sys/class/power_supply/battery/voltage_now 
$cat /sys/class/power_supply/battery/batt_vol 
```

请注意，电压现在的单位是微伏，而不是毫伏。

如果需要，您也可以通过编程方式阅读它。

但是，它可能仍然不够准确，因为这些数据的内容是由操作系统更新的（可能类似于电源驱动器），因此要获得真正准确的统计数据，您可能必须尝试硬件方法。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:39:23.360

`How could this be possible?`
电池 mAh 值是作为电池电压测量的。但是这个电压会不时变化。当有高电流消耗时它会下降一点，然后在处理器空闲时恢复。它也会随着温度的变化而变化。所以总体来说是非常不准确的。

# javascript - 如何让 Html5 音频在点击时播放声音？（ogg 用于 Firefox 等浏览器，mp3 用于 chrome 等浏览器）

> ID：15317318
> 
> 赞同：2
> 
> 时间：2013-03-09T23:55:54.440
> 
> 标签：javascript, html, firefox, audio

如何让 Html5 音频在点击时播放声音？（ogg 用于 Firefox 等浏览器，mp3 用于 chrome 等浏览器）

到目前为止，onclick 我可以更改为单个文件类型，但我无法像在普通 html5 音频声明中那样拥有备份选项，即

```
<audio controls>
  <source src="horse.ogg" type="audio/ogg">
  <source src="horse.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio> 
```

代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>How do i call the javascript function and get it to play .ogg if can't play .mp3?</title>
</head>
<body>
    <audio id="Mp3Me" autoplay autobuffer controls>
  <source src="Piano.mp3">
</audio>

<a href="javascript:GuitarTrack()">Guitar</a>

<script type="text/javascript">
function GuitarTrack(){
var Mp3Me= document.getElementById('Mp3Me');
Mp3Me.src = "Guitar.mp3";
Mp3Me.src = "Guitar.ogg";
}
</script>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:05:01.350

由于您只创建一个`<source>`元素，因此您必须`<source>`在 HTML 中创建另一个元素或使用 JavaScript 创建一个。

1.  使用 HTML 创建第二个元素。[http://jsfiddle.net/PVqvC/](http://jsfiddle.net/PVqvC/)

    ```
    <audio id="Mp3Me" autoplay autobuffer controls>
    <source src="Piano.mp3">
    <source src="Piano.ogg">
    </audio>
    <a href="javascript:GuitarTrack();">Guitar</a>

    <script type="text/javascript">
    function GuitarTrack(){
        var Mp3Me= document.getElementById('Mp3Me');
        Mp3Me.children[0].src = "Guitar.mp3";
        Mp3Me.children[1].src = "Guitar.ogg";
        Mp3Me.load();
    }
    </script> 
    ```

2.  使用 JS 创建第二个元素。[http://jsfiddle.net/MBvsC/1/](http://jsfiddle.net/MBvsC/1/)

    ```
    <audio id="Mp3Me" autoplay autobuffer controls>
    <source src="Piano.mp3">
    </audio>
    <a href="javascript:GuitarTrack();">Guitar</a>

    <script type="text/javascript">
    function GuitarTrack(){
        var Mp3Me= document.getElementById('Mp3Me').getElementsByTagName('source');

        if(Mp3Me.length > 1) { //there are 2 elements
            Mp3Me[0].src = "Guitar.mp3";
            Mp3Me[1].src = "Guitar.ogg";
        }
        if(Mp3Me.length == 1) { //only one element, so we need to create the second one
            Mp3Me[0].src = "Guitar.mp3"; //changes existing element

            var node = document.getElementById('Mp3Me');
            var newelem = document.createElement('source');
            newelem.setAttribute('src', 'Guitar.ogg');
            node.appendChild(newelem); //creating new element with appropriate src                         
        }
        Mp3Me.load();
    }
    </script> 
    ```

如您所见，第一种方法更短更简洁，因此如果您可以使用它，请使用它。如果您还有其他问题 - 请随时提出。

# sql - 将 YYYYMMDD 转换为 DATE

> ID：15317321
> 
> 赞同：17
> 
> 时间：2013-03-09T23:56:22.613
> 
> 标签：sql, sql-server, sql-server-2008-r2

我有很多这样的日期`varchar`：

```
20080107
20090101
20100405
... 
```

如何将它们转换为这样的日期格式：

```
2008-01-07
2009-01-01
2010-04-05 
```

我试过用这个：

```
SELECT [FIRST_NAME]
      ,[MIDDLE_NAME]
      ,[LAST_NAME]      
      ,cast([GRADUATION_DATE] as date)      
  FROM mydb 
```

但收到此消息：

> 消息 241，级别 16，状态 1，第 2 行
> 从字符串转换日期和/或时间时转换失败。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-10T00:08:08.327

发生错误是因为您（或设计此表的人）`have a bunch of dates in VARCHAR`。为什么您（或设计此表的人）将日期存储为字符串？您（或设计此表的人）是否也将工资、价格和距离存储为字符串？

要查找导致问题的值（以便您（或设计此表的人）可以修复它们）：

```
SELECT GRADUATION_DATE FROM mydb
  WHERE ISDATE(GRADUATION_DATE) = 0; 
```

打赌你至少有一排。修复这些值，然后修复表格。或者问设计桌子的人来修理桌子。真的很好。

```
ALTER TABLE mydb ALTER COLUMN GRADUATION_DATE DATE; 
```

现在您不必担心格式 - 您始终可以在客户端`YYYYMMDD`或`YYYY-MM-DD`在客户端上进行格式化，或`CONVERT`在 SQL 中使用。当您有一个*有效*的日期作为字符串文字时，您可以使用：

```
SELECT CONVERT(CHAR(10), CONVERT(datetime, '20120101'), 120); 
```

...但这最好在客户端上完成（如果有的话）。

有一个流行的术语——垃圾进，垃圾出。如果您的数据类型选择（或设计表格的人的数据类型选择）固有地允许垃圾进入您的表格，那么您将永远无法转换为日期（更不用说转换为特定格式的*字符串）。*请修复它。或者问设计桌子的人（再次，非常好）来修复它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-03-27T10:11:01.877

采用`SELECT CONVERT(date, '20140327')`

在你的情况下，

```
SELECT [FIRST_NAME],
       [MIDDLE_NAME],
       [LAST_NAME],
       CONVERT(date, [GRADUATION_DATE])     
FROM mydb 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-09-29T17:49:38.093

在您的情况下，它应该是：

```
Select convert(datetime,convert(varchar(10),GRADUATION_DATE,120)) as
'GRADUATION_DATE' from mydb 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-23T08:45:39.433

我也遇到了同样的问题，我以 bigint 格式接收 Transaction_Date 为 YYYYMMDD。因此，我使用以下查询将其转换为日期时间格式，并以日期时间格式将其保存在新列中。我希望这对你也有帮助。

```
SELECT
convert( Datetime, STUFF(STUFF(Transaction_Date, 5, 0, '-'), 8, 0, '-'), 120) As [Transaction_Date_New]
FROM mydb 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-11T20:04:14.640

只是添加有关上述所有解决方案的更多信息：

```
SELECT [FIRST_NAME],
       [MIDDLE_NAME],
       [LAST_NAME],
       CONVERT(date, [GRADUATION_DATE])     
FROM mydb 
```

假设您没有 WHERE 子句，没关系，即使它不是像“00000000”这样的有效日期（在我的情况下），转换也会尝试返回所有日期。

但是，如果您需要 WHERE 子句，那么您可以看到如下消息： [![在此处输入图像描述](../Images/944a5785b04597ca22e7f90821efc677.png)](https://i.stack.imgur.com/SpBXk.png)

所以我测试了上面提到的一些方法的组合，比如：

```
DECLARE @DateStart datetime = '2021-02-18'
DECLARE @DateEnd datetime = '2021-02-19'
SELECT [FIRST_NAME],
       [MIDDLE_NAME],
       [LAST_NAME],
       CONVERT(date, [GRADUATION_DATE]) 
FROM mydb
WHERE 
--THIS LINE SHOULD BE ENOUGTH TO AVOID WRONG DATES, BUT IT IS NOT
ISDATE([GRADUATION_DATE]) = 1 AND
CONVERT(char(10), [GRADUATION_DATE], 120) BETWEEN @DateStart and @DateEnd 
```

最后我成功地使用了这种方式：

```
DECLARE @DateStart datetime = '2021-02-18'
DECLARE @DateEnd datetime = '2021-02-19'
SELECT [FIRST_NAME],
       [MIDDLE_NAME],
       [LAST_NAME],
       CONVERT(date, [GRADUATION_DATE]) 
FROM mydb
WHERE 
CONVERT(char(10), 
-- I ADDED THIS LINE TO IGNORE WRONG DATES
CASE WHEN ISDATE([GRADUATION_DATE]) = 1 THEN [GRADUATION_DATE] ELSE '1900-01-01' END, 120) 
BETWEEN @DateStart and @DateEnd 
```

# c++ - Serialization of boost::shared_ptr through a custom archive

ID：15317323

赞同：2

时间：2013-03-09T23:56:30.680

标签：c++, serialization, boost, shared-ptr, archive

# jquery - Ajax.ActionLink Navigates to new Page

> ID：15317326
> 
> 赞同：2
> 
> 时间：2013-03-09T23:57:02.023
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4, unobtrusive-javascript

Using ASP .NET MVC 4.5, jQuery 1.8.3 and Microsoft jQuery Unobtrusive Ajax v 2.0.30116.0\.

I have the following code in a partial view:

```
 @Ajax.ActionLink("Delete", "DeletePost", new AjaxOptions { UpdateTargetId = "post" + post.Id, InsertionMode = InsertionMode.Replace, HttpMethod = "POST" }) 
```

I see the following the page source:

```
<script src="/Scripts/jquery-1.8.3.js"></script>
<script src="/Scripts/jquery.unobtrusive-ajax.js"></script>
<script src="/Scripts/jquery.validate.js"></script>
<script src="/Scripts/jquery.validate.unobtrusive.js"></script> 
```

I have the following in the web.config

```
<add key="ClientValidationEnabled" value="true" />
<add key="UnobtrusiveJavaScriptEnabled" value="true" /> 
```

Clicking the "Delete" link navigates to the action url specified for the ActionLink:

```
http://localhost/Communities/DeletePost# 
```

instead of leaving me on the page and making the AJAX request.

What's going on here?

# php - 从 codeigniter 中的视图调用模型是否不好？

> ID：15317332
> 
> 赞同：1
> 
> 时间：2013-03-09T23:58:13.240
> 
> 标签：php, model-view-controller, codeigniter-2

好的，我一直在使用代码点火器创建一个小型测试站点，到目前为止，我已经完成了登录和注销。这些都遵循正确的 MVC，我认为控制器中的逻辑、​​模型中的实际工作和视图中的表示。但是，我在做一些事情时遇到了一个问题，比如在前端站点中包含新闻提要，不需要登录。我正在考虑只是在主页视图中调用负责显示新闻提要内容的模型。这是不好的做法吗？基本上，在登录时显示动态内容（如新闻提要甚至用户照片）的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T09:37:03.093

这是非常错误的。

在理想情况下，您的所有功能、数据调用、操作、数据插入等都将在模型中。

控制器用于决定需要来自模型的哪些调用并来回传递数据。正是在这一点上，控制器可以收集视图所需的信息并将它们向前传递。

您应该在视图中拥有的唯一逻辑是 if/else 和 for each 循环。我在所有数据进入视图之前“准备”了所有数据，因此日期格式、空值处理等也已完成，因此我的视图只不过是带有少量名称的纯 HTML；?> 类型变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T09:59:10.003

在正确实施的受 MVC 启发的设计模式中，视图负责从模型层获取信息并创建响应（如果需要，由多个模板制作）。这意味着，视图从模型层请求数据是正确的做法。

你应该避免的是改变模型层状态的操作，因为那部分是控制器的责任。

应该注意的另一件事是，这仅适用于您具有真实视图实例的情况。CodeIgniter 所谓的“视图”只不过是一堆愚蠢的模板。模板不应从任何地方请求任何数据。

# node.js - 快速错误处理 - 获取状态码

> ID：15317334
> 
> 赞同：4
> 
> 时间：2013-03-09T23:58:37.470
> 
> 标签：node.js, error-handling, express

如果我用 express 定义错误处理中间件，如下所示：

```
app.use(function(err,req,res,next){
    // Do Stuff
}); 
```

如何获取错误的 HTTP 状态代码（或者我只是假设是 500）？

谢谢，
阿里

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T01:23:09.823

简而言之，您的代码必须根据您在错误处理中间件中处理的特定错误来决定适当的错误代码。

此时不一定会生成 HTTP 状态代码。按照惯例，当我`next(error)`从中间件函数或路由器处理函数调用时，我会放置一个`code`属性，以便我的错误处理中间件可以执行`res.status(err.code || 500).render('error_page', error);`这些操作。但是，您是想将这种方法用于常见的 404 错误还是仅用于 5XX 服务器错误或其他什么，这取决于您。`next`在将错误传递给回调时，express 本身或大多数中间件中很少有东西会提供 http 状态代码。

举个具体的例子，假设有人试图在我的应用程序中使用我发现已经在数据库中注册的电子邮件地址注册一个用户帐户，我可能会这样做`return next(new AlreadyRegistered());`，AlreadyRegistered 构造函数会`this.code = 409; //Conflict`在错误实例上放置一个属性，以便错误处理中间件会发送 409 状态码。（对于这种“正常操作条件”错误，在正常路由链中使用错误处理中间件是否更好，这在设计方面是有争议的，但希望这个示例仍然是说明性的）。

仅供参考，我还推荐[httperrors npm 模块](https://www.npmjs.org/package/httperrors)，它提供了命名良好的包装类和一个`statusCode`属性。我在一些项目中使用它取得了很好的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-04-16T22:24:32.960

您可以尝试在路由中定义状态码：

```
app.get('/force-error', function(req, res) {
  res.status(400)
  next(new Error('Bad Request.'))
}) 
```

然后：

```
server.use(function serverErrorHandler (err, req, res, next) {
  const code = res.statusCode

  // if status 200 change to 500, otherwise get the defined status code
  res.status(code === 200 ? 500 : code)

  // check if it's a ajax request
  if (req.xhr)
    res.json({
      error: {
        status: res.statusCode,
        message: err.message,
        stack: err.stack,
      }
    })
  else
    next(err)
}) 
```

# c# - 带有子组的正则表达式简化

> ID：15317335
> 
> 赞同：1
> 
> 时间：2013-03-09T23:58:42.053
> 
> 标签：c#, .net, regex

这可以简化以避免重复吗？最好不要有重复的组。

这是我的正则表达式的结构化输出，具有声誉：

```
^(?<Version>(\d+)\.(\d+)\.(\d+))(?!.*[\.-]$)(?:(?<IsReleaseVersion>-)(?:(?:(?<RArea1>[\da-z][\.\da-z-]+)\.(?<RStep1>[\d]+)\.(?<RHash1>[\.\da-z]+)\.(?<RCiId1>\d{1,4}))|(?:(?<RArea2>[\da-z][\.\da-z-]+)\.(?<RStep2>[\d]+)\.(?<RId2>[\.\da-z]+))|(?:(?<RArea3>[\da-z][\.\da-z-]+)\.(?<RStep3>[\d]+))|(?:(?<RArea4>[\da-z][\.\da-z-]+))))?(?:(?<IsBuildVersion>\+)(?:(?:(?<BArea1>[\da-z][\.\da-z-]+)\.(?<BStep1>[\d]+)\.(?<BId2>[\.\da-z]+)\.(?<BCiId2>\d{1,4}))|(?:(?<BArea2>[\da-z][\.\da-z-]+)\.(?<BStep2>[\d]+)\.(?<BId2>[\.\da-z]+))|(?:(?<BArea3>[\da-z][\.\da-z-]+)\.(?<BStep3>[\d]+))|(?:(?<BArea4>[\da-z][\.\da-z-]+))))?$ 
```

这是输入文本：

```
<Version>: (A)=1.0.1 (B)=1.0.1 (C)=1.0.1 (D)=1.0.1 (E)=1.0.1 (F)=1.0.1 (1): (A)=1 (B)=1 (C)=1 (D)=1 (E)=1 (F)=1 (2): (A)=0 (B)=0 (C)=0 (D)=0 (E)=0 (F)=0 (3): (A)=1 (B)=1 (C)=1 (D)=1 (E)=1 (F)=1 <IsReleaseVersion>: (A)=null (B)=null (C)=null (D)=null (E)=null (F)=- <IsBuildVersion>: (A)=+ (B)=+ (C)=+ (D)=+ (E)=null (F)=null <Area>: (A)=beta (B)=beta (C)=beta (D)=beta (E)=null (F)=beta <Step>: (A)=1 (B)=1 (C)=1 (D)=null (E)=null (F)=1 <Id>: (A)=abcd1234 (B)=abcd1234 (C)=null (D)=null (E)=null (F)=abcd1234 <CiId>: (A)=0001 (B)=null (C)=null (D)=null (E)=null (F)=null 
```

我希望有人能帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T23:51:35.677

天哪，你搞得一团糟：）我只关注这部分：

```
((?:(?:(?<RArea1>[\da-z][\.\da-z-]+)\.(?<RStep1>[\d]+)\.(?<RHash1>[\.\da-z]+)\.(?<RCiId1>\d{1,4}))|
(?:(?<RArea2>[\da-z][\.\da-z-]+)\.(?<RStep2>[\d]+)\.(?<RId2>[\.\da-z]+))|
(?:(?<RArea3>[\da-z][\.\da-z-]+)\.(?<RStep3>[\d]+))|
(?:(?<RArea4>[\da-z][\.\da-z-]+))) 
```

这可以重写为：

```
(?:(?<Area>[\da-z]+)(?:\.(?<Step>[\d]+)(?:\.(?<Hash>[\da-z]+)(?:\.(?<CiId>\d{1,4}))?)?)?) 
```

简单地嵌套你的条件。

看到它在[行动](http://regex101.com/r/lX5vI2)。

# java - warning when i am generating .jar

> ID：15317336
> 
> 赞同：0
> 
> 时间：2013-03-09T23:58:51.897
> 
> 标签：java, persistence

I have this warning:

```
 warning: Supported source version 'RELEASE_6' from annotation processor
   org.eclipse.persistence.internal.jpa.modelgen.CanonicalModelProcessor' less than -source
   '1.7'
   Note: Creating non-static metadata factory ...
   Note: Found Option : eclipselink.canonicalmodel.use_static_factory, with value: false
   Note: Optional file was not found: META-INF/orm.xml continuing with generation.
   Note: Optional file was not found: META-INF/eclipselink-orm.xml continuing with
   generation.
   Note: Found Option : eclipselink.canonicalmodel.use_static_factory, with value: false
   Note: Optional file was not found: META-INF/orm.xml continuing with generation.
   Note: Optional file was not found: META-INF/eclipselink-orm.xml continuing with
   generation.
   warning: The following options were not recognized by any processor:
   '[eclipselink.canonicalmodel.use_static_factory]'
   Note: Some input files use unchecked or unsafe operations.
   Note: Recompile with -Xlint:unchecked for details.
   1 warning
   Copying 5 files to E:\NetBeansProjects\votaciones\build\classes
   compile:
   Created dir: E:\NetBeansProjects\votaciones\dist
   Copying 1 file to E:\NetBeansProjects\votaciones\build
   Copy libraries to E:\NetBeansProjects\votaciones\dist\lib.
   Building jar: E:\NetBeansProjects\votaciones\dist\votaciones.jar
   To run this application from the command line without Ant, try:
   java -jar "E:\NetBeansProjects\votaciones\dist\votaciones.jar"
   jar:
BUILD SUCCESSFUL (total time: 8 seconds) 
```

what happen?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:08:17.103

它说构建成功。第一个警告是说您使用 Java 7(1.7)，而源代码支持 Java 6 (1.6)。第二次waring是第一次waring的结果。如果您的应用程序有效，我认为没有任何问题。如果它不起作用，请尝试使用 java 1.6 或获取支持 java 1.7 的更新版本。

# php - Order by Date in MySQL where date is %D

> ID：15317340
> 
> 赞同：2
> 
> 时间：2013-03-09T23:59:40.473
> 
> 标签：php, mysql, date

I've been racking my brains over this one, I can't work it out. I'm trying a new way to show a date on my site (%D %W) for easier reading, but in the process it's knocked all my "ORDER by" out of sync, so instead of:

8th Friday
9th Saturday
10th Sunday
11th Monday

I'm getting

10th
11th
8th
9th

Now I understand why it's displaying it like it is, but I just don't know the correct way to implement the ORDER by statement, this is what I had before:

```
SELECT *, DATE_FORMAT(date,'%D %W') AS `Date` 
FROM employees WHERE type = 'blah' 
ORDER BY `Date` ASC, `time` ASC 
```

Any ideas? Probably an easy one for some.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:04:56.537

保留原始日期进行排序并使用“友好日期”进行显示，如下所示：

```
SELECT *, DATE_FORMAT(date,'%D %W') AS FormattedDate FROM employees WHERE type = 'blah' ORDER BY Date ASC, time ASC 
```

# ruby-on-rails - Can't run rails server after trying to install Rmagick

> ID：15317341
> 
> 赞同：0
> 
> 时间：2013-03-09T23:59:41.397
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rmagick

I'm on windows and I downloaded and installed rmagick-win32 RMagick-2.12.0-ImageMagick-6.5.6-8-Q8 from here ([http://rubyforge.org/frs/?group_id=12&release_id=42049](http://rubyforge.org/frs/?group_id=12&release_id=42049)) which I unzipped and installed using 'gem install rmagick'

When I try to run rails s, I get this error message

```
C:\Users\Me\Desktop\sample_app>rails s
←[31mCould not find gem 'rmagick (>= 0) x86-mingw32' in any of the gem sources l
isted in your Gemfile.←[0m
←[33mRun `bundle install` to install missing gems.←[0m 
```

So I try to bundle install or bundle update then I get this (I took out the full list of gems to save space):

```
C:\Users\Me\Desktop\sample_app>bundle update

Fetching source index for https://rubygems.org/
Installing rmagick (2.13.2) with native extensions
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension
.

        C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb
checking for Ruby version >= 1.8.5... yes
checking for stdint.h... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --without-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=C:/RailsInstaller/Ruby1.9.3/bin/ruby
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler
 failed to generate an executable file. (RuntimeError)
You have to install development tools first.
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:506:in `try_cpp'

        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:931:in `block in
 have_header'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:790:in `block in
 checking_for'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:284:in `block (2
 levels) in postpone'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:254:in `open'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:284:in `block in
 postpone'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:254:in `open'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:280:in `postpone
'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:789:in `checking
_for'
        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:930:in `have_hea
der'
        from extconf.rb:194:in `<main>'

Gem files will remain installed in C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9
.1/gems/rmagick-2.13.2 for inspection.
Results logged to C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rmagick-2
.13.2/ext/RMagick/gem_make.out
An error occured while installing rmagick (2.13.2), and Bundler cannot continue.

Make sure that `gem install rmagick -v '2.13.2'` succeeds before bundling. 
```

Then I downloaded rmagick 2.13.2 and put it into the same folder and ran "gem install rmagick -v '2.13.2' but I'm getting a failed ERROR: Failed to build gem native extension again

I am trying to get 2.13.2 installed but I can't find any information on this. Anyone know if that's the issue and how this can be fixed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T06:23:53.843

Windows 上的 RMagick 很棘手。在过去的两年里，当我在 Windows 上时，我设法找到了两种解决方案来解决同样的问题。

**简单的解决方案**

将以下内容添加到您的 Gemfile。它还将考虑其他平台。

```
if RUBY_PLATFORM =~ /(win|w)32$/
  gem 'rmagick', '2.12.0', :path => 'vendor/gems/rmagick-2.12.0-x86-mswin32', :require => 'RMagick'
else
  gem 'rmagick', :require => 'RMagick'
end 
```

然后，解压缩 gem 以`vendors/gems/`使用：

```
gem unpack rmagick-2.12.0-x86-mswin32.gem vendors/gems/ 
```

**更好的解决方案**

我发现可以在 Windows 上编译 RMagick gem。在遵循此解决方案之前，请确保您已安装[DevKit 。](http://rubyinstaller.org/add-ons/devkit/)

我创建[了一个批处理文件](https://gist.github.com/kramerc/1307776)，它将 ImageMagick 的目录映射到`X:\`并为命令提供参数`gem`，以了解在哪里可以找到构建 RMagick 所需的文件。这种映射是必要的，因为配置选项不知道如何处理路径中的空格。

您可以使用以下命令将 ImageMagick 的目录映射到`X:\`并编译和安装 gem。

```
subst X: "C:\Program Files (x86)\ImageMagick-6.7.6-Q16"
gem install rmagick --platform=ruby -- --with-opt-lib="X:\lib" --with-opt-include="X:\include"
subst X: /D 
```

如果您安装了 6.7.6-Q16 以外的版本，或者您不在 64 位 Windows 上，则需要编辑路径。

使用此解决方案安装 gem 后，您现在应该可以`gem 'rmagick', :require => 'RMagick'`在 Gemfile 中进行捆绑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T18:03:01.660

在 Windows 上，您需要[DevKit](http://rubyinstaller.org/add-ons/devkit/) for Ruby 来编译本机 C 扩展（一些 gem 已包含）。

# ruby-on-rails - 如何检测是否（数字+字符（不是数字））

> ID：15317343
> 
> 赞同：0
> 
> 时间：2013-03-09T23:59:55.540
> 
> 标签：ruby-on-rails, ruby, regex, ruby-on-rails-3

如果我有这种情况，我将如何检测，我会得到这个输入

```
3b => allow
4b => allow
55b => allow
1111bbbb => allow
num45 => no ! 
```

如果我确实允许，我还想删除所有不是数字的字符

```
3b => 3
555B => 555
11 => 11 
```

我试图检查给定的输入是否为数字，但这种情况超出了我的知识范围。

感谢您的时间和考虑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:09:37.553

您可以使用：

```
/\A(\d+)[a-z]*\z/i 
```

如果表达式与您想要的数字匹配，则将在第一个捕获组中。

[Rubular](http://rubular.com/r/JsVFhyGPFC)的示例。（它使用`^`/`$`而不是`\A`/`\z`只是为了演示，你应该使用`\A`/ `\z`。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:09:47.943

这将查找整数 + 字符串并将其转换为整数。它将忽略字符串 + 整数输入。

```
input = '45num'

if input.match(/\d+[a-zA-Z]+/)
  result = input.to_i
end

result => 45 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T00:25:32.743

你真的想使用：`str[/\A\d+/]`- 这会给你前导数字或零。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-10T00:07:53.443

嗯，我不是正则表达式忍者，但我认为您可以使用：`^([\d]+)`来捕获数字。[在这里](http://regexpal.com/)试一试

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-10T00:02:56.510

如果字符串以数字开头

```
!/^[0-9]/.match(@variable).nil? 
```

如果是，则仅获取数字部分

```
 @variable = @variable.gsub(/[^0-9]/, '') 
```

# javascript - 当 mouseenter 在另一个函数上时如何完成 setTimeout 函数？

> ID：15317345
> 
> 赞同：0
> 
> 时间：2013-03-10T00:00:27.383
> 
> 标签：javascript, settimeout, mouseleave

在[http://jsfiddle.net/builtbymay/Wge4n/4/](http://jsfiddle.net/builtbymay/Wge4n/4/)上，将鼠标悬停在 Basecamp 号召性用语按钮上，然后将鼠标移动到浏览器窗口的左侧。您会注意到航向会在 1000 毫秒延迟后变回来。好的！现在再次将鼠标悬停在它上面，但这次将鼠标移到 Highrise 上。不太好！

我想我需要加快鼠标悬停在 Basecamp 按钮上时发生的延迟。clearTimeout 对我不起作用。任何帮助，将不胜感激。谢谢！

```
$(document).ready(function() {
    var delay = 1000;
    $('.products .bc').on('mouseenter', function() {
        $('header').addClass('hidden');
        $('.bc:first').removeClass('hidden').css({
            'clear': 'both',
            'width': '829px',
            'height': '163px',
            'margin': '0 auto',
            'padding': '6px 0',
            'text-align': 'center',
            'font-family': '"CrimsonSemiBold", "Times New Roman", Georgia, serif',
        });
        // Added bc:first to prevent styles being added to other .bc classes.
        $('.bc:first h1, .bc:first p').css('padding', '18px 0 0');
        // Adjusting vertical layout so red arrow more closely matches location on 37signals.com.  
        $('.bc:last').css('box-shadow', '0 0 10px #333');
    });
    $('.products .bc').on('mouseleave', function() {
        setTimeout(function() {
            $('header').removeClass('hidden');
            $('.bc:first').addClass('hidden').removeAttr('style');
            $('.bc:last').removeAttr('style');
        }, delay);
    });
    $('.products .hr').on('mouseenter', function() {
        $('header').addClass('hidden');
        $('.hr:first').removeClass('hidden').css({
            'clear': 'both',
            'width': '829px',
            'height': '163px',
            'margin': '0 auto',
            'padding': '6px 0',
            'text-align': 'center',
            'font-family': '"CrimsonSemiBold", "Times New Roman", Georgia, serif',
        });
        $('.hr:first h1, .hr:first p').css('padding', '18px 0 0');
        $('.hr:last').css('box-shadow', '0 0 10px #333');
        $('.right-arrow-b').removeClass('right-arrow-b').css({
            'left': '80px',
            'position': 'relative',
            'z-index': '1'
        });
    });
    $('.products .hr').on('mouseleave', function() {
        setTimeout(function() {
            $('header').removeClass('hidden');
            $('.hr:first').addClass('hidden').removeAttr('style');
            $('.hr:last').removeAttr('style');
            $('.right-arrow-b').addClass('right-arrow-b').removeAttr('style');
        }, delay);
    });
    $('.products .cf').on('mouseenter', function() {
        $('header').addClass('hidden');
        $('.cf:first').removeClass('hidden').css({
            'clear': 'both',
            'width': '829px',
            'height': '163px',
            'margin': '0 auto',
            'padding': '6px 0',
            'text-align': 'center',
            'font-family': '"CrimsonSemiBold", "Times New Roman", Georgia, serif',
        });
        $('.cf:first h1, .cf:first p').css('padding', '18px 0 0');
        $('.cf:last').css('box-shadow', '0 0 10px #333');
        $('.left-arrow').removeClass('left-arrow').css({
            'left': '150px',
            'position': 'relative',
            'z-index': '1'
        });
    });
    $('.products .cf').on('mouseleave', function() {
        setTimeout(function() {
            $('header').removeClass('hidden');
            $('.cf:first').addClass('hidden').removeAttr('style');
            $('.cf:last').removeAttr('style');
            $('.left-arrow').addClass('left-arrow').removeAttr('style');
        }, delay);
    });
}); 
```

仅供参考：CSS 和 HTML 是从另一个同学那里借来的。我的任务是让行为反映 37signals.com 上的行为，而无需在此过程中编辑任何 HTML 和 CSS。发生了很多 css 操作——忽略它。我的最后一项任务是解决上述问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:50:58.500

定义一个保存定时器的全局变量

```
var globalTimer = null; 
```

在 之上`$(document).ready(function() ...`，重要的是这个 var 不是在方法中定义的。

现在将超时分配给这个 var 并检查它是否设置以及是否需要在所有方法中清除它。

```
if(gloabalTimer != null) window.clearTimeout(gloabalTimer);
globalTimer = window.setTimeout(function() {
    //Your actions
}), delay); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T10:15:05.960

试试这个[小提琴](http://jsfiddle.net/Wge4n/5/)。我做了一个单独的函数来执行`mouseleave`事件的功能。一个按钮的打开`mouseenter`执行`mouseleave`其他 2 个按钮的功能。此外，我保留了一组`setTimeout`. 在前面提到的功能中，我还清除了所有计时器。

# php - Error when using drop menu to change database value

> ID：15317346
> 
> 赞同：0
> 
> 时间：2013-03-10T00:00:42.740
> 
> 标签：php, javascript, sql, ajax, menu

When i select a drop menu option to change a value in my database to the selected value it gives this error:

```
SyntaxError: missing ) after argument list changeGroup("email@email.com") 
```

Basically what im trying to do is I have an app that stores contacts, in the ungrouped contacts section it has the drop menu and when u select a value from it it submits the values and uses the value to update the database. I use the:

```
action='javascript:changeGroup(".$contactDetails.") 
```

to tell the update statement which contact to update.

my code:

```
<!--Include Database connections info-->
<?php include('config.php'); ?>

<!--Links to CSS file for formatting-->
<link href="Contacts.css" rel="stylesheet" type="text/css"/>

<!--Links to Javascript file for the for action to change the group of a contact-->
<script src="ajax.js" language="javascript"></script>

<?php

$contactDetails = $_GET['contactDetails'];

    $cdquery="SELECT * FROM `contacts` WHERE `newEmail` = '$contactDetails'";
    $cdresult=mysql_query($cdquery) or die ("Query to get data from first table failed: ".mysql_error());

  while ($row = mysql_fetch_assoc($cdresult)) 
  {

    echo "" . $row['newFname'] . " " . $row['newLname'] . "'s " . "Details:";
    echo "<table>";
    echo "<tr>";
    echo "<th>Name:</th>";
    echo "<th>Email Address:</th>";
    echo "<th>Phone:</th>";
    echo "<th>Postal Address:</th>";
    echo "<th>Group:</th>";
    echo "</tr>";

        echo "<tr>";
        echo "<td>" . $row['newFname'] . " " . $row['newLname'] . "</td>";
        echo "<td>" . $row['newEmail'] . "</td>";
        echo "<td>" . $row['newPhone'] . "</td>";
        echo "<td>" . $row['newAddress'] . "</td>";
        echo "<td>" . $row['group'] . "</td>";
        echo "</tr>";
    }
    echo "</table>";

    echo "<form action='javascript:changeGroup(".$contactDetails.")' method='get'> Add contact to 
    <select id='group' name='group' onchange='this.form.submit(value=this.options[this.selectedIndex].value)'>
    <option>Select a group...</option> 
    <option value='Family'>Family</option> 
    <option value='Friends'>Friends</option> 
    <option value='Colleagues'>Colleagues</option></select>
    group.</form>";

mysql_close($link);

?> 
```

ajax function:

```
function changeGroup(str)
    {
    document.getElementById("content02").innerHTML="";
    if (str=="")
    {
    document.getElementById("content02").innerHTML="";
    return;
    } 
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("content02").innerHTML=xmlhttp.responseText;
    document.getElementById("content02").innerHTML = "";
    }
    }
    xmlhttp.open("GET",'getChangeGroup.php?contactChange='+contactChange+'&group='+group,true);
    xmlhttp.send();
    xmlhttp.onreadystatechange = changeReload;
    xmlhttp.send(null);
    } 
```

php:

```
<!--Include Database connections info-->
<?php include('config.php'); ?>

<!--Links to CSS file for formatting-->
<link href="Contacts.css" rel="stylesheet" type="text/css"/>

<?php

$contactChange = $_GET['contactChange'];
$group = $_GET['group'];

$cdquery="UPDATE `contacts` SET `group` = '$group' WHERE `newEmail` = '$contactChange'";
$cdresult=mysql_query($cdquery) or die ("Query to get data from first table failed: ".mysql_error());

mysql_close($link);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:08:18.017

我真的不知道你的代码做了什么，我也没有耐心完全复制它，但就目前而言，你在这一行将一个变量而不是字符串传递给你的函数：

```
echo "<form action='javascript:changeGroup(".$contactDetails.")' method='get'> Add contact to 
```

要解决此问题，您需要将字符串引用为实际字符串：

```
echo "<form action='javascript:changeGroup(\'".$contactDetails."\')' method='get'> Add contact to 
```

我认为这是您的主要问题。如果没有这些引号，javascript 会将您的回显变量视为 js 变量，而不是字符串。

**关于您的数据库交互...**

此外，您正在使用已弃用的.. 并且很快将被删除的数据库交互 API。我推荐 PDO 来替换它，它可以防止注入攻击，并且在不久的将来不会被删除，在[这里了解更多信息](https://stackoverflow.com/tags/pdo/info)。

# php - PHP mcrypt_encrypt/mcrypt_decrypt issue, returns a different value

> ID：15317354
> 
> 赞同：5
> 
> 时间：2013-03-10T00:02:05.113
> 
> 标签：php, encryption, hash

I was looking for an answer but could not find it here. Please excuse me if this question was already asked.

I have a simple code encrypting and decrypting a string, strings look the same, but when comparing them using == they do not appear to be the same, so hashes are different as well..

Here is my code:

```
$oppa = "rompish";
$opp_enc = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, "key", $oppa, MCRYPT_MODE_ECB);
$opp_dec = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, "key", $opp_enc, MCRYPT_MODE_ECB);

echo $oppa."<br />".$opp_dec."<br />";

if ($oppa == $opp_dec) echo "YAY"; else echo "NOPE"; 
```

On the page:

rompish rompish NOPE

Please tell me what I am doing wrong.

Thank you!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T02:17:31.677

> AES 总是以 16 字节为单位对事物进行加密。显然 `mcrypt_encrypt`用零字节填充字符串，直到它是 16 的倍数。`mcrypt_decrypt`尽职尽责地解密它，但缺乏删除填充的信息。而且您在自欺欺人，因为即使`oppa_dec` 实际上以 9 个零字节结尾，显示的值看起来也一样。请改用合理的填充方案。–[格雷格](https://stackoverflow.com/users/238704/gregs)

要删除这些空字符，您可以使用该[`rtrim`](http://php.net/manual/en/function.rtrim.php)函数。在运行解密后的输出之后，它应该是相等的。

# c++ - C++ - Compilation error with Error class that inherit from std::exception

> ID：15317355
> 
> 赞同：0
> 
> 时间：2013-03-10T00:02:10.537
> 
> 标签：c++, exception, compilation, g++

Here is my Error class to handle errors with try & catch :

```
#include <stdexcept>
#include <string>

  class Error : public std::exception
    {
    public:
      Error(const std::string&) throw();
      ~Error() throw();
      const char*   what() const throw();
    private:
      std::string           _msg;
    }; 
```

And the cpp file :

```
#include "Error.hpp"

Error::Error(const std::string& msg) throw()
  : _msg(msg)
{
}

Error::~Error() throw()
{
}

const char*     Error::what() const throw()
{
  return (_msg.c_str());
} 
```

And I have this errors while compiling:

```
main.o:(.gcc_except_table+0x34): undefined reference to `typeinfo for Error'
MailBox.o: In function `MailBox::MailBox(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':
MailBox.cpp:(.text+0x245): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x268): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x270): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x2f0): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x313): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x31b): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x3d6): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x3f9): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x401): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x452): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x475): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x47d): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x50a): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x52d): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x535): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x6af): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x6d2): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x6da): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x854): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x877): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x87f): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x923): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x946): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x94e): undefined reference to `typeinfo for Error'
MailBox.cpp:(.text+0x9b6): undefined reference to `Error::Error(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
MailBox.cpp:(.text+0x9d9): undefined reference to `Error::~Error()'
MailBox.cpp:(.text+0x9e1): undefined reference to `typeinfo for Error'
collect2: ld returned 1 exit status 
```

I've already used this Error class for another project, and it worked well. I don't understand why here it doesn't work.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:06:23.523

这**不是**编译错误，这是*链接器*错误。基本上，此错误通知您缺少某些函数的定义。

从链接器的输出中可以看出，这些函数是 class 的复制构造函数和析构函数`Error`。

这与您仅显示这些函数的声明（在类定义中）的事实兼容`Error`。您还应该为它们提供*定义*。例如，您可以简单地内联这些定义：

```
class Error : public std::exception
{
public:
    Error(const std::string& s) throw() : _msg(s) { }
    ~Error() throw() { };
    const char*   what() const throw() { return _msg.c_str(); };
private:
    std::string _msg;
}; 
```

# java - How to add increment and decrement functions to this piece of a counter?

> ID：15317356
> 
> 赞同：-1
> 
> 时间：2013-03-10T00:02:22.200
> 
> 标签：java, counter, increment, decrement

Essentially, I need help writing an increment and decrement code in my lab. I've managed to do the stuff beforehand, but I want to wrap my mind around what I'm doing with this. My first thought is creating some kind of for loop? Any ideas of how to go about this?

```
class IncreaseCount implements ActionListener {
    public void actionPerformed(ActionEvent e) {
        int counter=0;
        counter++; 
        label.setText(String.valueOf(counter));
    }   
}

class DecreaseCount implements ActionListener {
     public void actionPerformed(ActionEvent e) {
        int counter = 0;
        counter--;
        label.setText(String.valueOf(counter));
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:22:10.760

您正在增加/减少一个局部变量。所以每次执行actionPerformed，计数器都会初始化为0，然后递增或递减。计数器应该是包含这两个动作侦听器的类的字段（属性）。

# objective-c - Google Maps iOS SDK: How do I get accurate latitude and longitude coordinates from a camera's visibleRegion?

> ID：15317359
> 
> 赞同：9
> 
> 时间：2013-03-10T00:02:33.607
> 
> 标签：objective-c, google-maps, google-maps-sdk-ios

EDIT: This is now a confirmed bug with [this](https://code.google.com/p/gmaps-api-issues/issues/detail?id=5107) SDK

I'm using version 1.1.1.2311 of the Google Maps for iOS SDK, and I'm looking to find the bounding latitude and longitude coordinates for the visible map on screen.

I'm using the following code to tell me what the current projection is:

```
NSLog(@"\n%@,%@\n%@,%@\n%@,%@\n%@,%@\n",
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.farLeft.latitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.farLeft.longitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.farRight.latitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.farRight.longitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.nearLeft.latitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.nearLeft.longitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.nearRight.latitude],
    [NSNumber numberWithDouble:mapView.projection.visibleRegion.nearRight.longitude]); 
```

From reading the headers, it seems that it may not be updated when the camera moves. Fair enough...

```
/**
 * The GMSProjection currently used by this GMSMapView. This is a snapshot of
 * the current projection, and will not automatically update when the camera
 * moves. The projection may be nil while the render is not running (if the map
 * is not yet part of your UI, or is part of a hidden UIViewController, or you
 * have called stopRendering).
 */ 
```

But, it appears to update each time the delegate method is called, so I attempted to plot the coordinates to test them...

For the following on my phone:

![my app's current projection](../Images/9b267bc149fe2d98cbcf7d806efa3960.png)

The output of the NSLog from above gives me the following:

```
37.34209003645947,-122.0382353290915
37.34209003645947,-122.010769508779
37.30332095984257,-122.0382353290915
37.30332095984257,-122.010769508779 
```

When plotting those coordinates using [this](http://www.darrinward.com/lat-long/) I get a projection that seems off:

![actual projection](../Images/c0c72ebcca4ae9b3aeb4ec96c811b2bc.png)

These coordinates are consistent across app launches which leads me to believe that I'm either consistently doing something wrong, I'm misunderstanding what visibleRegion is, or I've discovered a bug. Anyone care to help me figure out which one it is?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-10T23:56:52.027

要获得边界纬度和经度，您必须执行以下步骤：

```
GMSCoordinateBounds *bounds = [[GMSCoordinateBounds alloc] initWithRegion:self.googleMapsView.projection.visibleRegion];

CLLocationCoordinate2D northEast = bounds.northEast;
CLLocationCoordinate2D northWest = CLLocationCoordinate2DMake(bounds.northEast.latitude, bounds.southWest.longitude);
CLLocationCoordinate2D southEast = CLLocationCoordinate2DMake(bounds.southWest.latitude, bounds.northEast.longitude);
CLLocationCoordinate2D southWest = bounds.southWest; 
```

最好的问候罗伯特

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-01T09:07:09.023

我在[这里](https://code.google.com/p/gmaps-api-issues/issues/detail?id=5107&q=visibleRegion&colspec=ID%20Type%20Status%20Introduced%20Fixed%20Summary%20Stars%20ApiType%20Internal)看到了你的问题。希望他们在下一次更新中解决这个问题。

但是现在我们可以像这样获取真正的可见区域：

```
 CGPoint topLeftPoint = CGPointMake(0, 0);
    CLLocationCoordinate2D topLeftLocation =
    [_mapView.projection coordinateForPoint: topLeftPoint];

    CGPoint bottomRightPoint =
    CGPointMake(_mapView.frame.size.width, _mapView.frame.size.height);
    CLLocationCoordinate2D bottomRightLocation =
    [_mapView.projection coordinateForPoint: bottomRightPoint];

    CGPoint topRightPoint = CGPointMake(_mapView.frame.size.width, 0);
    CLLocationCoordinate2D topRightLocation =
    [_mapView.projection coordinateForPoint: topRightPoint];

    CGPoint bottomLeftPoint =
    CGPointMake(0, _mapView.frame.size.height);
    CLLocationCoordinate2D bottomLeftLocation =
    [_mapView.projection coordinateForPoint: bottomLeftPoint];

    GMSVisibleRegion realVisibleRegion;
    realVisibleRegion.farLeft = topLeftLocation;
    realVisibleRegion.farRight = topRightLocation;
    realVisibleRegion.nearLeft = bottomLeftLocation;
    realVisibleRegion.nearRight = bottomRightLocation;

    [self drawPolylineWithGMSVisibleRegion:realVisibleRegion color:[UIColor redColor] width:10.0f forMap:mapView]; 
```

绘制折线方法：

```
- (void)drawPolylineWithGMSVisibleRegion:(GMSVisibleRegion)visibleRegion
                               color:(UIColor*)color
                               width:(double)width
                              forMap:(GMSMapView*)mapView{
    GMSPolylineOptions *rectangle = [GMSPolylineOptions options];
    rectangle.color = color;
    rectangle.width = width;
    GMSMutablePath *path = [GMSMutablePath path];
    [path addCoordinate:visibleRegion.nearRight];
    [path addCoordinate:visibleRegion.nearLeft];
    [path addCoordinate:visibleRegion.farLeft];
    [path addCoordinate:visibleRegion.farRight];
    [path addCoordinate:visibleRegion.nearRight];
    rectangle.path = path;
    [mapView addPolylineWithOptions:rectangle];
} 
```

它甚至适用于具有非默认方位角和角度的地图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T04:51:15.377

解决方案是下载最新版本的 SDK（撰写本文时为 1.2），因为该问题已得到修复。

从 1.2 发行说明：

> 已解决的问题： - visibleRegion 现在在 Retina 设备上报告大小正确的区域

[在这里](https://developers.google.com/maps/documentation/ios/start#getting_the_google_maps_sdk_for_ios)下载。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T19:33:42.030

看起来您正在打印并手动绘制的纬度和经度坐标可能有点偏离/被截断。%f 默认只打印到小数点后 6 位。

这是一个可能有帮助的相关问题：

[如何在 iOS 上以全精度打印双精度？](https://stackoverflow.com/questions/5729004/how-to-print-a-double-with-full-precision-on-ios)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-03-10T00:08:48.387

也许你给位置经理错误的准确性..

尝试增加它：

```
locationMgr.desiredAccuracy = kCLLocationAccuracyBest; 
```

电池越来越耗电了

# algorithm - 我有一个数字列表，如何生成所有唯一的 k 分区？

> ID：15317360
> 
> 赞同：2
> 
> 时间：2013-03-10T00:02:47.833
> 
> 标签：algorithm

因此，如果我有数字 [1,2,2,3] 并且我想要 k=2 分区，我将有 [1][2,2,3], [1,2][2,3], [2 ,2][1,3]、[2][1,2,3]、[3][1,2,2] 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:50:37.737

[在Code Review](https://codereview.stackexchange.com/questions/1526/python-finding-all-k-subset-partitions)中查看 Python 中的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:59:32.340

user3569 在[Code Review](https://codereview.stackexchange.com/questions/1526/python-finding-all-k-subset-partitions)上的解决方案为下面的测试用例生成了五个 2 元组，而不是专门的 3 元组。但是，删除对`frozenset()`返回元组的调用会导致代码仅返回 3 元组。修改后的代码如下：

```
from itertools import chain, combinations

def subsets(arr):
    """ Note this only returns non empty subsets of arr"""
    return chain(*[combinations(arr,i + 1) for i,a in enumerate(arr)])

def k_subset(arr, k):
    s_arr = sorted(arr)
    return set([i for i in combinations(subsets(arr),k) 
               if sorted(chain(*i)) == s_arr])

s = k_subset([2,2,2,2,3,3,5],3)

for ss in sorted(s):
    print(len(ss)," - ",ss) 
```

正如 user3569 所说，“它运行速度很慢，但相当简洁”。

（编辑：Knuth 的解决方案见下文）

输出是：

```
3  -  ((2,), (2,), (2, 2, 3, 3, 5))
3  -  ((2,), (2, 2), (2, 3, 3, 5))
3  -  ((2,), (2, 2, 2), (3, 3, 5))
3  -  ((2,), (2, 2, 3), (2, 3, 5))
3  -  ((2,), (2, 2, 5), (2, 3, 3))
3  -  ((2,), (2, 3), (2, 2, 3, 5))
3  -  ((2,), (2, 3, 3), (2, 2, 5))
3  -  ((2,), (2, 3, 5), (2, 2, 3))
3  -  ((2,), (2, 5), (2, 2, 3, 3))
3  -  ((2,), (3,), (2, 2, 2, 3, 5))
3  -  ((2,), (3, 3), (2, 2, 2, 5))
3  -  ((2,), (3, 5), (2, 2, 2, 3))
3  -  ((2,), (5,), (2, 2, 2, 3, 3))
3  -  ((2, 2), (2, 2), (3, 3, 5))
3  -  ((2, 2), (2, 3), (2, 3, 5))
3  -  ((2, 2), (2, 5), (2, 3, 3))
3  -  ((2, 2), (3, 3), (2, 2, 5))
3  -  ((2, 2), (3, 5), (2, 2, 3))
3  -  ((2, 3), (2, 2), (2, 3, 5))
3  -  ((2, 3), (2, 3), (2, 2, 5))
3  -  ((2, 3), (2, 5), (2, 2, 3))
3  -  ((2, 3), (3, 5), (2, 2, 2))
3  -  ((2, 5), (2, 2), (2, 3, 3))
3  -  ((2, 5), (2, 3), (2, 2, 3))
3  -  ((2, 5), (3, 3), (2, 2, 2))
3  -  ((3,), (2, 2), (2, 2, 3, 5))
3  -  ((3,), (2, 2, 2), (2, 3, 5))
3  -  ((3,), (2, 2, 3), (2, 2, 5))
3  -  ((3,), (2, 2, 5), (2, 2, 3))
3  -  ((3,), (2, 3), (2, 2, 2, 5))
3  -  ((3,), (2, 3, 5), (2, 2, 2))
3  -  ((3,), (2, 5), (2, 2, 2, 3))
3  -  ((3,), (3,), (2, 2, 2, 2, 5))
3  -  ((3,), (3, 5), (2, 2, 2, 2))
3  -  ((3,), (5,), (2, 2, 2, 2, 3))
3  -  ((5,), (2, 2), (2, 2, 3, 3))
3  -  ((5,), (2, 2, 2), (2, 3, 3))
3  -  ((5,), (2, 2, 3), (2, 2, 3))
3  -  ((5,), (2, 3), (2, 2, 2, 3))
3  -  ((5,), (2, 3, 3), (2, 2, 2))
3  -  ((5,), (3, 3), (2, 2, 2, 2)) 
```

Knuth 的解决方案，由 Adeel Zafar Soomro 在同一[Code Review](https://codereview.stackexchange.com/questions/1526/python-finding-all-k-subset-partitions)页面上实现，如果不需要重复，可以如下调用：

```
s = algorithm_u([2,2,2,2,3,3,5],3)
ss = set(tuple(sorted(tuple(tuple(y) for y in x) for x in s))) 
```

我没有计时，但 Knuth 的解决方案明显更快，即使对于这个测试用例也是如此。

但是，它返回 63 个元组，而不是 user3569 的解决方案返回的 41 个。我还没有仔细检查输出以确定哪个输出是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T06:06:24.367

这是 Haskell 中的一个版本：

```
import Data.List (nub, sort, permutations)

parts 0 = []
parts n = nub $ map sort $ [n] : [x:xs | x <- [1..n`div`2], xs <- parts(n - x)]

partition [] ys result = sort $ map sort result
partition (x:xs) ys result = 
  partition xs (drop x ys) (result ++ [take x ys])

partitions xs k = 
  let variations = filter (\x -> length x == k) $ parts (length xs)
  in nub $ concat $ map (\x -> mapVariation x (nub $ permutations xs)) variations
    where mapVariation variation = map (\x -> partition variation x [])

OUTPUT:
*Main> partitions [1,2,2,3] 2
[[[1],[2,2,3]],[[1,2,3],[2]],[[1,2,2],[3]],[[1,2],[2,3]],[[1,3],[2,2]]] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-17T16:21:52.030

Python解决方案：

```
pip install PartitionSets 
```

然后：

```
import partitionsets.partition
filter(lambda x: len(x) == k, partitionsets.partition.Partition(arr)) 
```

PartitionSets 的实现似乎非常快，但是很遗憾您不能将分区数量作为参数传递，因此您需要从所有子分区中过滤出您的 k 集分区。

您可能还想查看： [researchgate 上的类似主题](http://www.researchgate.net/post/What_is_the_fastest_algorithm_for_generating_set_partitions)。

# php - PHP snap to nearest street Google API

> ID：15317362
> 
> 赞同：1
> 
> 时间：2013-03-10T00:02:54.753
> 
> 标签：php, javascript, google-maps

I'm using javascript with the GOOGLE API, it works with snapping the point to the nearest street manually by clicking it. Example taken from ([http://econym.org.uk/gmap/snap.htm](http://econym.org.uk/gmap/snap.htm))

I have a database of coordinates I want to feed through this thing, to snap the points to the closest street, I'm using PHP, but I can't get the mysql PHP variables to "talk" with the javascript.

I want it to pretty much be close to real time, read URL variables add them to database then have it snap it on road on Google maps

I can manually do it from the URL variables, but I can't get PHP and the database coordinates to be read by the javascript GoogleAPI snap to road function

```
//Fetching from your database table.
            $query = "SELECT DISTINCT * FROM $usertable";
            $result = mysql_query($query);

            if ($result) {
                while($row = mysql_fetch_array($result)) {
                    $name = $row["$latitude_db"];
                    $name1 = $row["$longitude_db"];

  echo "var dirn = new google.maps.DirectionsService();";
  echo "var map;";
echo "
  function initialize() {
    var center = new google.maps.LatLng(40.04, -79.23);
    var myOptions = {
      zoom:10,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: center
    }
    ";
    echo "map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);";

    echo "var urllat = getUrlVars()['lat'];";

    echo "var urllong = getUrlVars()['long'];";

    echo "var combo = new google.maps.LatLng('$name', '$name1');";
    echo "alert($name1);";

    echo "var request = {";
            echo "origin: combo,";
            echo "destination: combo,";
            echo "travelMode: google.maps.DirectionsTravelMode.DRIVING";
        echo "};";
        echo "dirn.route(request, function(response, status) {";
          echo "if (status == google.maps.DirectionsStatus.OK) {";
               echo " if(response.routes && response.routes.length > 0){";
                   echo " route = response.routes[0];";
                   echo " if(route.overview_path && route.overview_path.length > 0)";
            echo "{";

                        echo "pos = route.overview_path[0];";

                            echo "new google.maps.Marker({";
                                echo "position: pos,";
                                echo "map: map";
                            echo "});";

                    echo "}";
                echo "}";
          echo "}";
        echo "});";

    echo "}";

                }
            }

}            

echo "</script>"; 
```

This code would be in a loop or on page load...

# r - 无法使用 ROauth 获取 PIN

> ID：15317370
> 
> 赞同：0
> 
> 时间：2013-03-10T00:03:24.127
> 
> 标签：r, oauth, twitter, rcurl

我想将 R 连接到 Twitter。我已按照此处设置的步骤操作：http: [//cran.r-project.org/web/packages/twitteR/vignettes/twitteR.pdf](http://cran.r-project.org/web/packages/twitteR/vignettes/twitteR.pdf)

我拥有的代码如下：

```
library(ROAuth)
cred <- OAuthFactory$new(consumerKey="xyz",
consumerSecret=xyz",
requestURL="https://api.twitter.com/oauth/request_token",
accessURL="https://api.twitter.com/oauth/authorize",
authURL="https://api.twitter.com/oauth/access_token")
cred$handshake(ssl.verifypeer = FALSE) 
```

当我获得推特链接时： [https ://api.twitter.com/oauth/access_token?oauth_token=YZZOYJ1liH1TDEY8G6Eb3YmgAWQlgGiEfAzI1ADwZ4](https://api.twitter.com/oauth/access_token?oauth_token=YZZOYJ1liH1TDEY8G6Eb3YmgAWQlgGiEfAzI1ADwZ4)

并将其加载到我的浏览器中，它会返回一个空白页面，其中没有关于 PIN 的信息。谁能告诉我为什么这个链接是空白的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T07:07:31.053

因为您访问了错误的 URL 来进行授权。交换你的`auth`和`access`网址！

```
accessURL="https://api.twitter.com/oauth/access_token",
authURL="https://api.twitter.com/oauth/authorize")

#You should get...
Cred$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl") )   
To enable the connection, please direct your web browser to: 
http://api.twitter.com/oauth/authorize?oauth_token=someaccessstokenvalue
When complete, record the PIN given to you and provide it here: 

#Final step to register connections
registerTwitterOAuth(Cred) 
```

# c++ - 纯虚方法调用终止

> ID：15317372
> 
> 赞同：1
> 
> 时间：2013-03-10T00:03:26.507
> 
> 标签：c++, winapi

我正在关注 MSDN 上的教程：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ff381400 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ff381400(v=vs.85).aspx)

其中显示了如何在 WINAPI 中创建一个类来创建窗口。

我做了与他们完全相同的事情，除了我将创建代码放在构造函数中。

运行时，它提供称为错误的纯虚方法并终止程序而没有任何解释。

```
template<typename T>
class Form
{
    public:
        Form(std::string Title, std::string Class, /*All other params*/);

    private:
        static LRESULT __stdcall WindowProcedure(HWND Hwnd, UINT Msg, WPARAM wParam, LPARAM lParam);

    protected:
        HWND WindowHandle = nullptr;
        virtual LRESULT HandleMessages(UINT Msg, WPARAM wParam, LPARAM lParam) = 0;
};

template<typename T>
Form<T>::Form(std::string Title, std::string Class, /*All Other Params*/)
{
    WNDCLASSEX WndClass = {/*Filled in with other params*/};

    RegisterClassEx(&WndClass);
    WindowHandle = CreateWindowEx(/*Other params*/, this);
}

template<typename T>
LRESULT __stdcall Form<T>::WindowProcedure(HWND Hwnd, UINT Msg, WPARAM wParam, LPARAM lParam)
{
    T* Data = nullptr;

    switch (Msg)
    {
        case WM_NCCREATE:
        {
            CREATESTRUCT* pCreate = (CREATESTRUCT*)lParam;
            Data = reinterpret_cast<T*>(pCreate->lpCreateParams);
            SetWindowLongPtr(Hwnd, GWLP_USERDATA, reinterpret_cast<LONG_PTR>(Data));
            break;
        }

        default:
        {
            Data = reinterpret_cast<T*>(GetWindowLongPtr(Hwnd, GWLP_USERDATA));
            return Data ? Data->HandleMessages(Msg, wParam, lParam) : DefWindowProc(Hwnd, Msg, wParam, lParam);
        }
    }
    return 0;
} 
```

然后我的主窗口：

```
class MainWindow : public Form<MainWindow>
{
    public:
        MainWindow(std::string Title, /*Other params*/);
        LRESULT HandleMessages(UINT Msg, WPARAM wParam, LPARAM lParam);

        HWND WindowHandle() {return Form::WindowHandle;}
};

MainWindow::MainWindow(std::string Title, std::string Class, /*Other params*/) {}

LRESULT MainWindow::HandleMessages(UINT Msg, WPARAM wParam, LPARAM lParam)
{
    switch(Msg)
    {
        case WM_CREATE:
        {
        }
        break;

        case WM_DESTROY:
            PostQuitMessage(0);
            break;

        default:
            return DefWindowProc(WindowHandle(), Msg, wParam, lParam);
    }

    return 0;
} 
```

就这些。为什么它会给我这个错误，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:06:40.973

> 我做了与他们完全相同的事情，除了我将创建代码放在构造函数中。

这就是为什么。从构造函数调用`virtual`方法不会达到您的预期 - 除非您希望它从层次结构中的当前类调用方法。当基类构造函数执行时，对象还不是派生类型。如果您`virtual`从该类的构造函数调用当前类中的纯方法，您将收到该错误。

# ios - 注释引脚作为用户位置

> ID：15317376
> 
> 赞同：2
> 
> 时间：2013-03-10T00:04:02.077
> 
> 标签：ios, mkmapview

我实现了这个：

```
 -(MKAnnotationView *)mapView:(MKMapView *)mV viewForAnnotation:(id <MKAnnotation>)annotation
{

    MKPinAnnotationView *pinView = nil;

        static NSString *defaultPinID = @"Place to be";
        pinView = (MKPinAnnotationView *)[self.myMapView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
        if ( pinView == nil ) pinView = [[MKPinAnnotationView alloc]initWithAnnotation:annotation reuseIdentifier:defaultPinID];

        pinView.pinColor = MKPinAnnotationColorRed;
        pinView.canShowCallout = YES;
        pinView.animatesDrop = YES;

        UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
        [rightButton addTarget:self action:nil forControlEvents:UIControlEventTouchUpInside];
        pinView.rightCalloutAccessoryView = rightButton;

        return pinView;   
} 
```

我现在的问题是 Userlocation 显示为一个 Pin ...我怎样才能找回蓝点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T07:02:15.400

尝试这个

```
-(MKAnnotationView *)mapView:(MKMapView *)mV viewForAnnotation:(id <MKAnnotation>)annotation
{

    if([annotation isKindOfClass: [MKUserLocation class]])
       return nil;

    MKPinAnnotationView *pinView = nil;

    static NSString *defaultPinID = @"Place to be";
    pinView = (MKPinAnnotationView *)[self.myMapView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
    if ( pinView == nil ) pinView = [[MKPinAnnotationView alloc]initWithAnnotation:annotation reuseIdentifier:defaultPinID];

    pinView.pinColor = MKPinAnnotationColorRed;
    pinView.canShowCallout = YES;
    pinView.animatesDrop = YES;

    UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    [rightButton addTarget:self action:nil forControlEvents:UIControlEventTouchUpInside];
    pinView.rightCalloutAccessoryView = rightButton;

    return pinView;   
} 
```

# ruby-on-rails - 将数据库查询保存到变量

> ID：15317378
> 
> 赞同：2
> 
> 时间：2013-03-10T00:04:08.000
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已经建立了一个简单的“设置”模型，因此我可以创建一些用户可修改的全局变量，我可以在整个应用程序中使用它们。这个模型有`var_name`和`value`列。`var_name`是主键。

我可以使用 来访问这些`Setting.find('my_variable_name')`，它可以工作，但每次都会导致数据库查询。

我希望能够“缓存”一次设置，而不是每次都查询数据库。
我不确定解决这个问题的正确方法，我还是 Rails 的新手。

我想像`settings = Setting.all`在我的应用程序控制器中将所有设置放在一个变量中，然后创建一种从中操作单个变量的方法 - 使用类似`settings.my_variable_name`...的东西调用它
......但我不知道如何:)

任何意见，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T00:41:53.130

尝试将此添加到您的设置模型中，

```
class Setting < ActiveRecord::Base
  def self.fetch(name)
    fetch_all.detect { |s| s.var_name == name }
  end

  def self.fetch_all
    @fetch_all ||= Setting.all
  end

  def self.reload_all!
    @fetch_all = Setting.all
  end
end 
```

创建一些设置，

```
Setting.create(var_name: 'domain', value: 'google.com')
Setting.create(var_name: 'subdomain', value: 'www') 
```

然后，您可以使用`Setting.fetch('domain').value #=> 'google.com'`.

```
Settings.fetch('domain')    #=> Hits the database with Settings.all
Settings.fetch('subdomain') #=> Hits the results in @fetch_all
Settings.fetch('domain')    #=> Hits the results in @fetch_all 
```

`@fetch_all ||= all`将调用`Setting.all`第一次`Setting.fetch_all`调用并将结果存储在`@fetch_all`. 后续调用将使用存储在`@fetch_all`.

# parallel-processing - 使用 GNU parallel 并行化具有各种参数的脚本

> ID：15317383
> 
> 赞同：3
> 
> 时间：2013-03-10T00:05:00.703
> 
> 标签：parallel-processing, gnu

我对并行运行脚本很感兴趣，并且我已经开始研究 GNU 并行工具，但是我遇到了一些麻烦。我的脚本`doSomething`需要 3 个参数，我想在不同的参数值上并行运行脚本。我怎样才能做到这一点？

我试过了：`parallel ./doSomething {1} {2} {3} ::: {0..5} ::: {0..5} ::: {0..5}`但它似乎只是挂起。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T20:04:56.317

请试试：

```
parallel --gnu echo ./doSomething {1} {2} {3} ::: {0..5} ::: {0..5} ::: {0..5} 
```

如果按预期工作，那么您的命令将被阻塞，因为`./doSomething`从 GNU Parallel 调用时的行为与直接调用时不同。可能发生这种情况的原因之一是`./doSomething`取决于是否连接了 tty。

# java - 插入排序、合并排序和快速排序的测试用例

> ID：15317384
> 
> 赞同：6
> 
> 时间：2013-03-10T00:05:01.477
> 
> 标签：java, algorithm, sorting, testing, code-analysis

我已经（在 Java 中）实现了插入排序、合并排序、修改合并排序和快速排序：

ModifiedMergeSort 有一个用于元素“绑定”的变量。当要排序的元素小于或等于“绑定”时，则使用插入排序对它们进行排序。

为什么版本 1 比版本 3、4 和 5 更好？

第 2 版和第 6 版的结果是否现实？

这是我的结果（以毫秒为单位）：

```
Version 1 - Insertion Sort: Run-Times over 50 test runs
Input Size      Best-Case       Worst-Case      Average-Case
N = 10000       14              19              14.96
N = 20000       59              60              59.3
N = 40000       234             277             243.1

Version 2 - Merge Sort: Run-Times over 50 test runs
Input Size      Best-Case       Worst-Case      Average-Case
N = 10000       1               15              1.78
N = 20000       3               8               3.4
N = 40000       6               9               6.7

Version 3 - Merge Sort and Insertion Sort on 15 elements: Run-Times over 50 test runs
Input Size      Best-Case       Worst-Case      Average-Case
N = 10000       41              52              45.42
N = 20000       170             176             170.56
N = 40000       712             823             728.08

Version 4 - Merge Sort and Insertion Sort on 30 elements: Run-Times over 50 test runs
Input Size      Best-Case       Worst-Case      Average-Case
N = 10000       27              33              28.04
N = 20000       113             119             114.36
N = 40000       436             497             444.2

Version 5 - Merge Sort and Insertion Sort on 45 elements: Run-Times over 50 test runs
Input Size      Best-Case       Worst-Case      Average-Case
N = 10000       20              21              20.68
N = 20000       79              82              79.7
N = 40000       321             383             325.64

Version 6 - Quick Sort: Run-Times over 50 test runs
Input Size      Best-Case       Worst-Case      Average-Case
N = 10000       1               9               1.18
N = 20000       2               3               2.06
N = 40000       4               5               4.26 
```

这是我的代码：

```
package com.testing;

import com.sorting.InsertionSort;
import com.sorting.MergeSort;
import com.sorting.ModifiedMergeSort;
import com.sorting.RandomizedQuickSort;

/**
 *
 * @author mih1406
 */
public class Main {
    private static final int R = 50; // # of tests
    private static int N = 0; // Input size
    private static int[] array; // Tests array
    private static int[] temp; // Tests array

    private static long InsertionSort_best = -1;
    private static long InsertionSort_worst = -1;
    private static double InsertionSort_average = -1.0;

    private static long MergeSort_best = -1;
    private static long MergeSort_worst = -1;
    private static double MergeSort_average = -1.0;

    private static long ModifiedMergeSort_V3_best = -1;
    private static long ModifiedMergeSort_V3_worst = -1;
    private static double ModifiedMergeSort_V3_average = -1.0;

    private static long ModifiedMergeSort_V4_best = -1;
    private static long ModifiedMergeSort_V4_worst = -1;
    private static double ModifiedMergeSort_V4_average = -1.0;

    private static long ModifiedMergeSort_V5_best = -1;
    private static long ModifiedMergeSort_V5_worst = -1;
    private static double ModifiedMergeSort_V5_average = -1.0;

    private static long RandomizedQuickSort_best = -1;
    private static long RandomizedQuickSort_worst = -1;
    private static double RandomizedQuickSort_average = -1.0;

    public static void main(String args[]) {
        StringBuilder InsertionSort_text = new StringBuilder(
                "Version 1 - Insertion Sort: Run-Times over 50 test runs\n");

        StringBuilder MergeSort_text = new StringBuilder(
                "Version 2 - Merge Sort: Run-Times over 50 test runs\n");

        StringBuilder ModifiedMergeSort_V3_text = new StringBuilder(
                "Version 3 - Merge Sort and Insertion Sort on 15 elements: Run-Times over 50 test runs\n");

        StringBuilder ModifiedMergeSort_V4_text = new StringBuilder(
                "Version 4 - Merge Sort and Insertion Sort on 30 elements: Run-Times over 50 test runs\n");

        StringBuilder ModifiedMergeSort_V5_text = new StringBuilder(
                "Version 5 - Merge Sort and Insertion Sort on 45 elements: Run-Times over 50 test runs\n");

        StringBuilder RandomizedQuickSort_text = new StringBuilder(
                "Version 6 - Quick Sort: Run-Times over 50 test runs\n");

        InsertionSort_text.append("Input Size\t\t"
                + "Best-Case\t\tWorst-Case\t\tAverage-Case\n");

        MergeSort_text.append("Input Size\t\t"
                + "Best-Case\t\tWorst-Case\t\tAverage-Case\n");

        ModifiedMergeSort_V3_text.append("Input Size\t\t"
                + "Best-Case\t\tWorst-Case\t\tAverage-Case\n");

        ModifiedMergeSort_V4_text.append("Input Size\t\t"
                + "Best-Case\t\tWorst-Case\t\tAverage-Case\n");

        ModifiedMergeSort_V5_text.append("Input Size\t\t"
                + "Best-Case\t\tWorst-Case\t\tAverage-Case\n");

        RandomizedQuickSort_text.append("Input Size\t\t"
                + "Best-Case\t\tWorst-Case\t\tAverage-Case\n");

        // Case N = 10000
        N = 10000;
        fillArray();
        testing_InsertionSort();
        testing_MergeSort();
        testing_ModifiedMergeSort(15);
        testing_ModifiedMergeSort(30);
        testing_ModifiedMergeSort(45);
        testing_RandomizedQuickSort();

        InsertionSort_text.append("N = " + N + "\t\t" + InsertionSort_best
                + "\t\t\t" + InsertionSort_worst + "\t\t\t"
                + InsertionSort_average + "\n");

        MergeSort_text.append("N = " + N + "\t\t" + MergeSort_best
                + "\t\t\t" + MergeSort_worst + "\t\t\t"
                + MergeSort_average + "\n");

        ModifiedMergeSort_V3_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V3_best
                + "\t\t\t" + ModifiedMergeSort_V3_worst + "\t\t\t"
                + ModifiedMergeSort_V3_average + "\n");

        ModifiedMergeSort_V4_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V4_best
                + "\t\t\t" + ModifiedMergeSort_V4_worst + "\t\t\t"
                + ModifiedMergeSort_V4_average + "\n");

        ModifiedMergeSort_V5_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V5_best
                + "\t\t\t" + ModifiedMergeSort_V5_worst + "\t\t\t"
                + ModifiedMergeSort_V5_average + "\n");

        RandomizedQuickSort_text.append("N = " + N + "\t\t" + RandomizedQuickSort_best
                + "\t\t\t" + RandomizedQuickSort_worst + "\t\t\t"
                + RandomizedQuickSort_average + "\n");

        // Case N = 20000
        N = 20000;
        fillArray();
        testing_InsertionSort();
        testing_MergeSort();
        testing_ModifiedMergeSort(15);
        testing_ModifiedMergeSort(30);
        testing_ModifiedMergeSort(45);
        testing_RandomizedQuickSort();

        InsertionSort_text.append("N = " + N + "\t\t" + InsertionSort_best
                + "\t\t\t" + InsertionSort_worst + "\t\t\t"
                + InsertionSort_average + "\n");

        MergeSort_text.append("N = " + N + "\t\t" + MergeSort_best
                + "\t\t\t" + MergeSort_worst + "\t\t\t"
                + MergeSort_average + "\n");

        ModifiedMergeSort_V3_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V3_best
                + "\t\t\t" + ModifiedMergeSort_V3_worst + "\t\t\t"
                + ModifiedMergeSort_V3_average + "\n");

        ModifiedMergeSort_V4_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V4_best
                + "\t\t\t" + ModifiedMergeSort_V4_worst + "\t\t\t"
                + ModifiedMergeSort_V4_average + "\n");

        ModifiedMergeSort_V5_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V5_best
                + "\t\t\t" + ModifiedMergeSort_V5_worst + "\t\t\t"
                + ModifiedMergeSort_V5_average + "\n");

        RandomizedQuickSort_text.append("N = " + N + "\t\t" + RandomizedQuickSort_best
                + "\t\t\t" + RandomizedQuickSort_worst + "\t\t\t"
                + RandomizedQuickSort_average + "\n");

        // Case N = 40000
        N = 40000;
        fillArray();
        testing_InsertionSort();
        testing_MergeSort();
        testing_ModifiedMergeSort(15);
        testing_ModifiedMergeSort(30);
        testing_ModifiedMergeSort(45);
        testing_RandomizedQuickSort();

        InsertionSort_text.append("N = " + N + "\t\t" + InsertionSort_best
                + "\t\t\t" + InsertionSort_worst + "\t\t\t"
                + InsertionSort_average + "\n");

        MergeSort_text.append("N = " + N + "\t\t" + MergeSort_best
                + "\t\t\t" + MergeSort_worst + "\t\t\t"
                + MergeSort_average + "\n");

        ModifiedMergeSort_V3_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V3_best
                + "\t\t\t" + ModifiedMergeSort_V3_worst + "\t\t\t"
                + ModifiedMergeSort_V3_average + "\n");

        ModifiedMergeSort_V4_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V4_best
                + "\t\t\t" + ModifiedMergeSort_V4_worst + "\t\t\t"
                + ModifiedMergeSort_V4_average + "\n");

        ModifiedMergeSort_V5_text.append("N = " + N + "\t\t" + ModifiedMergeSort_V5_best
                + "\t\t\t" + ModifiedMergeSort_V5_worst + "\t\t\t"
                + ModifiedMergeSort_V5_average + "\n");

        RandomizedQuickSort_text.append("N = " + N + "\t\t" + RandomizedQuickSort_best
                + "\t\t\t" + RandomizedQuickSort_worst + "\t\t\t"
                + RandomizedQuickSort_average + "\n");

        System.out.println(InsertionSort_text);
        System.out.println(MergeSort_text);
        System.out.println(ModifiedMergeSort_V3_text);
        System.out.println(ModifiedMergeSort_V4_text);
        System.out.println(ModifiedMergeSort_V5_text);
        System.out.println(RandomizedQuickSort_text);

    }

    private static void fillArray() {
        // (re)creating the array
        array = new int[N];

        // filling the array with random numbers
        // using for-loop and the given random generator instruction
        for(int i = 0; i < array.length; i++) {
            array[i] = (int)(1 + Math.random() * (N-0+1));
        }
    }

    private static void testing_InsertionSort() {
        // run-times arrays
        long [] run_times = new long[R];

        // start/finish times
        long start;
        long finish;
        for(int i = 0; i < R; i++) {
            copyArray();
            // recording start time
            start = System.currentTimeMillis();

            // testing the algorithm
            InsertionSort.sort(temp);

            // recording finish time
            finish = System.currentTimeMillis();

            run_times[i] = finish-start;
        }

        InsertionSort_best = findMin(run_times);
        InsertionSort_worst = findMax(run_times);
        InsertionSort_average = findAverage(run_times);
    }

    private static void testing_MergeSort() {
        // run-times arrays
        long [] run_times = new long[R];

        // start/finish times
        long start;
        long finish;
        for(int i = 0; i < R; i++) {
            copyArray();
            // recording start time
            start = System.currentTimeMillis();

            // testing the algorithm
            MergeSort.sort(temp);

            // recording finish time
            finish = System.currentTimeMillis();

            run_times[i] = finish-start;
        }

        MergeSort_best = findMin(run_times);
        MergeSort_worst = findMax(run_times);
        MergeSort_average = findAverage(run_times);
    }

    private static void testing_ModifiedMergeSort(int bound) {
        // run-times arrays
        long [] run_times = new long[R];

        // setting the bound
        ModifiedMergeSort.bound = bound;

        // start/finish times
        long start;
        long finish;
        for(int i = 0; i < R; i++) {
            copyArray();
            // recording start time
            start = System.currentTimeMillis();

            // testing the algorithm
            ModifiedMergeSort.sort(temp);

            // recording finish time
            finish = System.currentTimeMillis();

            run_times[i] = finish-start;
        }

        if(bound == 15) {
            ModifiedMergeSort_V3_best = findMin(run_times);
            ModifiedMergeSort_V3_worst = findMax(run_times);
            ModifiedMergeSort_V3_average = findAverage(run_times);
        }

        if(bound == 30) {
            ModifiedMergeSort_V4_best = findMin(run_times);
            ModifiedMergeSort_V4_worst = findMax(run_times);
            ModifiedMergeSort_V4_average = findAverage(run_times);
        }

        if(bound == 45) {
            ModifiedMergeSort_V5_best = findMin(run_times);
            ModifiedMergeSort_V5_worst = findMax(run_times);
            ModifiedMergeSort_V5_average = findAverage(run_times);
        }
    }

    private static void testing_RandomizedQuickSort() {
        // run-times arrays
        long [] run_times = new long[R];

        // start/finish times
        long start;
        long finish;
        for(int i = 0; i < R; i++) {
            copyArray();
            // recording start time
            start = System.currentTimeMillis();

            // testing the algorithm
            RandomizedQuickSort.sort(temp);

            // recording finish time
            finish = System.currentTimeMillis();

            run_times[i] = finish-start;
        }

        RandomizedQuickSort_best = findMin(run_times);
        RandomizedQuickSort_worst = findMax(run_times);
        RandomizedQuickSort_average = findAverage(run_times);
    }

    private static long findMax(long[] times) {
        long max = times[0];

        for(int i = 1; i < times.length; i++) {
            if(max < times[i]) {
                max = times[i];
            }
        }

        return max;
    }

    private static long findMin(long[] times) {
        long min = times[0];

        for(int i = 1; i < times.length; i++) {
            if(min > times[i]) {
                min = times[i];
            }
        }

        return min;
    }

    private static double findAverage(long[] times) {
        long sum = 0;
        double avg;

        for(int i = 0; i < times.length; i++) {
            sum += times[i];
        }

        avg = (double)sum/(double)times.length;

        return avg;
    }

    private static void copyArray() {
        temp = new int[N];
        System.arraycopy(array, 0, temp, 0, array.length);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T19:54:42.833

您当前采用的方法似乎存在一些系统性错误。我将说明您面临的一些最明显的实验问题，即使它们可能不是直接导致您的实验结果的罪魁祸首。

## JVM编译

正如我之前在评论中所说，JVM 默认会以解释模式运行您的代码。这意味着在您的方法中找到的每条字节码指令都将在现场被解释，然后运行。

这种方法的优点是它允许您的应用程序具有比在每次运行启动时编译为本机代码的 Java 程序更快的启动时间。

不利的一面是，虽然没有影响启动性能，但您会得到一个比其他情况下性能更慢的程序。

为了改善这两个问题，JVM 团队进行了权衡。最初，您的程序将被解释，但 JVM 将收集有关哪些方法（或方法的一部分）被密集使用的信息，并且只会编译那些似乎被大量使用的方法。编译时，您会受到很小的性能影响，但代码会比以前快得多。

**在进行测量时，您必须考虑到这一事实。**

标准方法是“预热 JVM”，也就是说，运行你的算法一段时间以确保 JVM 完成它需要做的所有编译。重要的是，让 JVM 升温的代码与您要进行基准测试的代码相同，否则在您对代码进行基准测试时可能会有一些编译。

## 测量时间

测量时间时，应使用`System.nanoTime()`代替`System.currentTimeMillis`。细节我就不说了，可以看[这里](https://stackoverflow.com/questions/351565/system-currenttimemillis-vs-system-nanotime)。

你也应该小心。以下代码块乍一看*可能是等效的，但大多数时候会产生不同的结果：*

```
totalDuration = 0;
for (i = 0; i < 1000; ++i)
    startMeasure = now();
    algorithm();
    endMeasure = now();
    duration = endMeasure - startMeasure;
    totalDuration += duration;
}

//...

TRIALS_COUNT = 1000;
startMeasure = now();
for (i = 0; i < TRIALS_COUNT; ++i)
    algorithm();
}
endMeasure = now();
 duration = endMeasure - startMeasure / TRIALS_COUNT; 
```

为什么？因为特别是对于更快`algorithm()`的实现，它们越快，就越难获得准确的结果。

## 大输入值

渐近符号有助于理解不同的算法将如何升级`n`. 将它们应用于小的输入值通常是荒谬的，因为在那个量级上，您通常想要计算操作的精确数量及其相关成本（类似于 Jakub 所做的事情）。大多数情况下，大 O 符号只对大 O 有意义。Big O 将告诉您该算法如何适用于难以忍受的输入值大小，而不是它对于小数字的表现。典型的例子是 QuickSort，它对于大数组来说是王道，但是对于大小为 4 或 5 的数组，它通常比选择或插入排序要慢。不过，您的输入大小似乎足够大。

## 最后一点

正如 Chang 之前所说，Jakub 所做的数学练习是完全错误的，不应考虑在内。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-10T00:51:25.233

Do the computations of the complexity by yourself. I assume 10000 samples for the following calculations:

**Insertion sort:** O(n^2), 10 000*10 000 = 100 000 000.

**Merge sort:** O(nlogn), 10 000*log10 000 = 140 000.

**Merge with insertion (15):** 15 is between 9 (arrays of sizes 20) and 10 (arrays of sizes 10) 2^10 insertion sorts (of size 10), then 2^10 * 10 000 merges: 1 024 * 10*10 (insertions) + 1 024 * 10 000 (merges) = 10 342 400

**Merge with insertion (30):** 30 is between 8 (arrays of sizes 40) and 9 (arrays of sizes 20) 2^9 insertion sorts (of size 20), then 2^9 * 10 000 merges: 512 * 20*20 (insertions) + 512 * 10 000 (merges) = 5 324 800

**Merge with insertion (45):** 45 is between 7 (arrays of sizes 80) and 8 (arrays of sizes 40) 2^8 insertion sorts (of size 40), then 2^8 * 10 000 merges: 256 * 40*40 (insertions) + * 10 000 (merges) = 2 969 600

**Quicksort:** while worst-case quicksort takes O(n^2), the worst case must be specially crafted to hit that limit. Mostly, using radomly generated algorithm, on average it is O(nlogn): 10 000*log10 000 = 140 000.

Measuring sorting algorithm performace can became quite a pain because you need to measure efficiently, on as wide range of input data as possible.

The figures you see on insertion sort can be largerly biased by the input numbers. If you are using only 0s and 1s in the array, and the array is randomly generated, then you actually have much easier problem for the algorithm to solve. For the given case, on average half of the array is already sorted, and you don't need to compare 0s and 1s with each other. The problem is reduced to transporting all 0s to the left, which on average takes only (log(n/2))!+n time. For 10 000, the actual time is 5 000!+10 000 = 133 888.

# mysql - mysql表错误中的最大列数

> ID：15317387
> 
> 赞同：-2
> 
> 时间：2013-03-10T00:05:49.830
> 
> 标签：mysql, phpmyadmin

我已达到对表的行大小设置的限制，因此我无法向表中添加更多列。

我收到以下错误：

> .#1118 - 行大小太大。所用表类型的最大行大小（不包括 BLOB）为 65535。您必须将某些列更改为 TEXT 或 BLOB

[我在MySQL 网站](http://dev.mysql.com/doc/refman/5.0/en/column-count-limit.html)上研究过这个问题，但仍然不确定如何解决这个问题。

有谁知道我该如何解决这个问题，以及我需要运行什么设置或脚本来修改设置，以便我可以向表中添加更多列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:11:24.860

为什么您的行大小一开始是 64k？那是你的问题。不是设置太低。

从：

[http://dev.mysql.com/doc/refman/5.0/en/column-count-limit.html](http://dev.mysql.com/doc/refman/5.0/en/column-count-limit.html)

> 每个表都有一个包含表定义的 .frm 文件。服务器使用以下表达式检查存储在文件中的某些表信息是否符合 64KB 的上限：

```
> if (info_length+(ulong) create_fields.elements*FCOMP+288+
>     n_length+int_length+com_length > 65535L || int_count > 255) 
```

因此，您不太可能轻松更改某些内容（修改源代码和运行自定义 MySQL。给我们您的架构，我们可能会提供更好的建议，但简短的回答似乎是您的列太多，或者需要将一些 VARCHAR 等更改为文本/blob。

如果没有看到（可能令人厌恶的）模式，很难提出建议。

# php - 错误：“注意：未定义的索引：”使用 Ajax 和 PHP

> ID：15317388
> 
> 赞同：-2
> 
> 时间：2013-03-10T00:05:51.113
> 
> 标签：php, javascript, jquery, ajax, post

这是我的 JavaScript 代码：

```
$( ".modifica_sore" ).click(function(){
var button = this;
$.ajax({
  type: "POST",
  url: "action/modifica_professori.php",

  data: {               
            nome: $(button).siblings('[name="nome"]').attr("value"),
            cognome: $(button).siblings('[name="cognome"]').attr("value"),
            id: $(button).siblings('[name="id"]').attr("value"),
            modifica_sore: $(button).siblings('[name="modifica_sore"]').attr("value"),
  },
  dataType: "html",

  success: function(msg)
  {
    alert("Aggiunto con successo");
    $("#risultato").html(msg);
  },
  error: function()
  {
    alert("Chiamata fallita, si prega di riprovare...");  callback in caso di fallimento
  }
});
  }); 
```

这是我的表格：

```
echo"<form method='POST'>";
echo"<fieldset>";
echo"<table>";
echo"<tr>";
   echo"<td>Nome</td>";
   echo"<td><input class='nome' name='nome' value='$nome'/></td>";
echo"</tr>";
echo"<tr>";
   echo"<td>Cognome</td>";
   echo"<td><input class='cognome' name='cognome' value='$cognome'/></td>";
echo"</tr>";
echo"<tr>";
   echo"<td></td>";
   echo"<td><input type='hidden' class='id' name='id' value='$id'/></td>";
echo"</tr>";
echo"<tr>";
     echo "<td> <input type='button' name='modifica_sore' class='modifica_sore'  value='Modifica' /> </td>";
    echo "<td> <input type='button' name='modifica_sore' class='modifica_sore' value='Elimina' /> </td>";
echo"</tr>";
echo"</table>";
echo"</fieldset>";
echo"</form>"; 
```

如果我不使用 Ajax，它可以工作，但是使用 Ajax 我有这个错误：

```
Notice: Undefined index: nome in C:\xampp\htdocs\xampp\action\modifica_professori.php on line 8

Notice: Undefined index: cognome in C:\xampp\htdocs\xampp\action\modifica_professori.php on line 9

Notice: Undefined index: id in C:\xampp\htdocs\xampp\action\modifica_professori.php on line 10

Notice: Undefined index: modifica_sore in C:\xampp\htdocs\xampp\action\modifica_professori.php on line 13

Notice: Undefined index: modifica_sore in C:\xampp\htdocs\xampp\action\modifica_professori.php on line 26 
```

在 modifica_professori.php 我使用这些 $_POST var：

```
$nome = $_POST['nome'];
$cognome = $_POST['cognome'];
$id = $_POST['id'];
$_POST['modifica_sore'] 
```

但如果它在没有 Ajax 的情况下工作，问题出在 javascript 中......：/ 谢谢你的帮助......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:10:30.587

发生这种情况是因为`.modifica_sore`按钮没有名称类似于或作为其兄弟的`<input>`元素。要获得价值，您应该使用以下内容：`"nome"``"cognome"``"nome"`

```
$(button).closest("table").find('[name="nome"]').val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:16:50.770

没有[兄弟姐妹（）](http://api.jquery.com/siblings/)，`.modifica_sore`因此表单元素值未正确提交。

我建议向`id`表单添加一个属性，然后使用如下选择器：

```
nome: $('#formid input[name="nome"]').attr('value')
cognome: $('#formid input[name="cognome"]').attr('value')
... 
```

在您的 ajax 数据对象中。

**编辑：**

既然您提到您无法修改表单，也许您可​​以尝试将选择器更改为以下内容：

```
var form = $(button).parents('form');

...
data: {
  nome: form.find('input[name="nome"]').attr('value'),
  cognome: form.find('input[name="cognome"]').attr('value'),
  ...
},
... 
```

# c++ - 使用 SiLab 的 Precision32 IDE 用于 SiM3L 32 位微控制器的 C++ 项目

> ID：15317393
> 
> 赞同：0
> 
> 时间：2013-03-10T00:06:32.410
> 
> 标签：c++, cortex-m3

我们是 Precision32 IDE 和 Silabs 32 位 MCU 的新手；我们尝试开发一些 C 代码没有任何问题，但我们无法构建任何 C++ 代码。Silabs 没有提供任何 C++ 示例，我们也没有从 Silabs 支持中得到任何答案。你知道这个 IDE 是否可以用 C++ 为 SIM3L uC 开发？如果是，您是否有任何带有适当工具链的“hello”世界工作项目示例？谢谢。

# ruby-on-rails - 正确的资产相关网址：rails/apache/passenger

> ID：15317399
> 
> 赞同：2
> 
> 时间：2013-03-10T00:07:39.770
> 
> 标签：ruby-on-rails, apache, passenger

我正在使用 apache2 和 phusion 乘客 4 测试 rails 应用程序部署。这是我的 apache conf：

```
 <Location /myproject>
            ProxyPass http://localhost:3000
            ProxyPassReverse http://localhost:3000
    </Location> 
```

然后我在 myproject 目录中以独立模式启动乘客：

```
passenger start -a 127.0.0.1 -p 3000 -d 
```

当我将浏览器指向[https://mydomain.com/myproject](https://mydomain.com/myproject)时，主页会正确显示，但没有加载 css 或 js，因为指向资产的链接如下：

```
<link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css"> 
```

这指向：

```
https://mydomain.com/assets/application.css 
```

但应该是：

```
https://mydomain.com/myproject/assets/application.css 
```

如何在 apache 或 rails 端解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T20:39:53.210

解决方案很简单：

```
config.relative_url_root = "/myproject" 
```

在应用程序.rb

在不禁用资产管道的情况下，资产的这个固定路径。

# ios - Cocoa 从 2 个字符之间获取多个子字符串

> ID：15317401
> 
> 赞同：1
> 
> 时间：2013-03-10T00:07:52.603
> 
> 标签：ios, objective-c, macos, cocoa

我试图让某些字符在两个字符之间是不同的颜色，`<`并且`>`. 我尝试使用这种方法来做到这一点

```
-(NSString*)stringBetweenString:(NSString*)start andString:(NSString*)end fromString:(NSString*)other{
NSScanner* scanner = [NSScanner scannerWithString:other];
[scanner setCharactersToBeSkipped:nil];
[scanner scanUpToString:start intoString:NULL];
if ([scanner scanString:start intoString:NULL]) {
    NSString* result = nil;
    if ([scanner scanUpToString:end intoString:&result]) {
        return result;
    }
}
return nil;
} 
```

这就是我想要的，但仅限于一个子字符串。我在这些字符之间有多个子字符串，并且希望它们都是不同的颜色。我用来改变颜色的方法是这样的

```
[self.tv setTextColor:[NSColor redColor] range:[s1 rangeOfString:[self stringBetweenString:@"<" andString:@">" otherString:s1] options:NSCaseInsensitiveSearch]]; 
```

哪里`self.tv`是`NSTextView`。如何获取多个子字符串的范围并更改这些子字符串的颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T07:30:08.807

对于您的情况，使用`NSScanner`不是最好的方法 - 您正在从字符串中复制一个子字符串，然后在字符串中搜索该子字符串以获取其范围，这是相当间接的。两种替代方法：

1.  `NSString`有一个有用的查找`enumerateSubstringsInRange:options:usingBlock:`方法，它可以找到各种类型的子字符串，并将它们依次呈现给要处理的块。不幸的是，没有一种是“尖括号之间的文本”，但您可以设计一个类似的方法，它接受一个字符串和一个块，然后将尖括号中的每个子字符串依次传递给它。如何找到子字符串？在这种情况下`NSString`，可以帮助您`rangeOfString:options:range:`- 这会在另一个字符串的给定范围内查找一个字符串。如果您开始寻找作为范围传递整个字符串的开放尖括号，您将获得第一个尖括号的范围（如果有）。现在再次调用它，搜索你的右尖括号传递作为范围字符串之后的开头。如果找到一个右尖括号，那么您就有了第一个子字符串 - 将它传递给您的块。重复直到您停止查找子字符串。
2.  您可以使用正则表达式搜索（参见`NSRegularExpression`）一次性查找所有子字符串，然后处理返回的列表。

HTH。

# sql - 每种活动类型的总数 - oracle - sql

> ID：15317410
> 
> 赞同：1
> 
> 时间：2013-03-10T00:08:32.313
> 
> 标签：sql, oracle, oracle-sqldeveloper

我有 3 种活动类型，需要显示有多少人参加了每个活动。因此，例如，我需要显示查询：

*   活动类型-----------总计
*   单板滑雪 --------- 9
*   滑雪 ------------------- 7
*   雪橇 ---------------- 5

到目前为止，我已经编写了以下查询：

```
SELECT type_of_activity, COUNT (DISTINCT individual_id) 
FROM activities, events, book_activity
WHERE activities.activity_code = events.activity_code 
      AND events.event_id = book_activity.event_id; 
```

这显然是错误的，并提出了错误“ `not a single group function`”

我需要它做的是计算单个 ID 的每个唯一实例，其中类型 - 每种类型的滑雪。我查看了很多资源，但找不到任何示例或帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:33:28.847

```
SELECT a.type_of_activity, COUNT(ba.individual_id)
FROM BOOK_ACTIVITY ba
JOIN EVENTS e
  ON e.event_id = ba.event_id
JOIN ACTIVITIES a
  ON a.activity_code = e.activity_code
GROUP BY a.type_of_activity; 
```

# c# - 在 Gridview 中搜索输出

> ID：15317414
> 
> 赞同：1
> 
> 时间：2013-03-10T00:09:08.933
> 
> 标签：c#, asp.net, gridview

我在 aspx 页面中有一个文本框和一个按钮。我还有一个 gridview 应该列出基于存储过程的结果。

这是我的 C# 代码示例

```
private void GetList(string EmployeeName)    
String strConnString = ConfigurationManager.ConnectionStrings["conString"].ConnectionString;
    SqlConnection con = new SqlConnection(strConnString);
    SqlCommand cmd = new SqlCommand();
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.CommandText = "GetEmployeeDetailsByName";
    cmd.Parameters.Add("@EmployeeName", SqlDbType.Text).Value = txtName.Text.Trim();        
    cmd.Connection = con;
    try
    {
        con.Open();
        GridView1.EmptyDataText = "No Records Found";
        GridView1.DataSource = cmd.ExecuteReader();
        GridView1.DataBind();
    }
    catch (Exception ex)
    {
        throw ex;
    }
    finally
    {
        con.Close();
        con.Dispose();
    } 
```

现在我在 button_click 事件中添加了以下内容

```
GetList(); 
```

它给了我“方法没有重载......”错误。

如何确保搜索文本框中的任何用户类型都传递到`GetList(**HERE**)`.cs 文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:14:42.423

你没有不`GetList`带参数的重载，所以这不会编译：

```
GetList(); 
```

我会将参数的类型更改为，`int`因为这是必需的类型：

```
private void GetList(int EmployeeID) 
```

然后传递解析的`TextBox.Text`（在你验证它可以被解析之后）：

```
int EmployeeID = int.Parse(txtID.Text.Trim());
GetList(EmployeeID); 
```

并更改此行：

```
cmd.Parameters.Add("@EmployeeID", SqlDbType.Int).Value = txtID.Text.Trim(); 
```

至

```
cmd.Parameters.Add("@EmployeeID", SqlDbType.Int).Value = EmployeeID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:14:08.653

Button.Click 事件是 System.EventHandler 事件委托类型。

您的方法 GetList() 必须接受 2 个参数：

GetList（对象发送者，EventArgs e）

希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T02:04:50.537

我使用了一种不同的方法（通过创建数据表并将其绑定到适配器..）来使其工作。感谢您尝试帮助我解决问题。

# java - 递归方法中的 StackOverflowError

> ID：15317415
> 
> 赞同：2
> 
> 时间：2013-03-10T00:09:27.077
> 
> 标签：java, string, recursion

我正在尝试使用递归方法计算字母“e”出现在给定字符串中的实例数。我的测试字符串是`Count my e's please!`. 这是到目前为止的代码：

```
public static int showE(String s, int count, int index)
{
        if (index == -1) return count;
        String e = "e";
        int i = s.indexOf(e, index);
        if (i != -1) count ++;
        return showE(s, count, i);
} 
```

当我调试代码时，`int i`将保持在 9 而不是通过每次调用增加。

我认为由于最后一行代码用作`int i`输入，它会`int index`通过每次调用测试字符串将方法的签名设置为 9、15 和 18。一旦不再检测到字母 e，我认为 `int i`会将 -1 发​​送到签名，然后`int count`返回到 main 方法。但是，调试表明，`int i`每次调用都会将其设置为 9，从而导致 StackOverflowError。如何解决这个问题？

编辑：这是响应斯蒂芬 C 的代码。对格式感到抱歉：

```
public static int showE(int count, int index)
{
        String e = "e";
        index = s.indexOf(e, 0)
        for(int i = index; i = < s.length() - 1; i++)
        {
            if (index == e) count++;
        }
        return count;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-10T00:14:22.673

[`String.indexOf`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#indexOf%28int,%20int%29)从您提供的索引开始搜索。所以它从索引 9 开始搜索，并在那里找到一个“e”，所以返回 9。

尝试从 开始 indexOf `index + 1`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:29:13.247

两点：

*   这个问题有一个更优雅的递归解决方案，只需要`showE`方法中的 2 个参数。 **提示：**考虑在递归调用的结果中添加一些东西......

*   Java中问题的递归解决方案有一个固有的问题。Java 堆栈总是有限的，Java 没有实现尾调用优化。将这两者结合起来，任何需要真正深度递归的问题都不可避免地会导致堆栈溢出。

    在这种情况下，这意味着如果您尝试在足够长的字符串中计算 E，您将得到一个异常......即使您得到正确的递归。

# excel - 如何使用excel合并和求和2个数组？

> ID：15317419
> 
> 赞同：0
> 
> 时间：2013-03-10T00:10:13.177
> 
> 标签：excel, excel-formula, vba

给定一个 .csv 数据文件如下

```
 12,green orange
  1,good egg
  ...
  5,green orange 
```

如果第二列元素相同，我想总结第一列元素。鉴于上面的例子，现在我们应该有

```
 17,green orange
   1,good egg
   ... 
```

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:43:00.687

假设您不想使用变量。

```
Count   |Color
12  |Green
1   |Blue
5   |Green 
7   |Green
3   |Blue 
```

按值“颜色”对文件进行排序

```
Count   |Color
1   |Blue
3   |Blue
12  |Green
7   |Green
5   |Green 
```

将公式放入单元格C2并粘贴下来

```
=IF(B2=B1,(C1+A2),A2) 
```

收集每种颜色末尾的总和（即蓝色 = 4，绿色 = 24）

![蓝色的](../Images/919ecb4fd6303c2e6276d88a0c1ee2d4.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T14:59:27.623

一个不错的选择是使用数据透视表（这实际上是它们的设计目的）。

在您的情况下，请查看`SUMIF`公式 -[链接](http://office.microsoft.com/en-us/excel-help/sumif-HP005209292.aspx)，因为您似乎不需要这种高级功能。

将“键”（项目）列表复制到单独的工作表中并删除重复项，然后进行`SUMIF`如下设置：

```
key   |   total sum
green |   = SUMIF(dataSheet!B:B, A2, dataSheet!A:A) 
```

您在工作表中的位置，并`dataSheet`表示您刚刚导入的 CSV 值。

# c# - SharpMap 和实体框架：动态程序集中不支持调用的成员

> ID：15317420
> 
> 赞同：3
> 
> 时间：2013-03-10T00:10:15.753
> 
> 标签：c#, entity-framework, sharpmap

我在自定义“地图小部件”组件中使用清晰的地图。为了填充地图，我想使用实体框架，它位于单独的 DLL 中。如果我创建地图然后获取数据，这很好。

```
public void loadMap() {
     var map = new MapWidget(); // Create a new widget which internally uses SharpMap
     map.AddCountriesLayer(); // Load the map background from .shp file
     var data = new IPService.GetPointsForMap(); // Gets IP address from entity framework, inside "domain.dll"
     map.AddDots(data); // Add dots
} 
```

但是，如果我先获取数据，然后制作地图，事情就会中断：

```
public void loadMap() {
     var data = new IPService.GetPointsForMap(); // Accessing entity framework before sharpmap
     var map = new MapWidget();
     map.AddCountriesLayer();
     map.AddDots(data);
} 
```

结果是

```
 System.NotSupportedException "The invoked member is not supported in a dynamic assembly."
   at System.Reflection.Emit.InternalAssemblyBuilder.GetExportedTypes()     
   at GeoAPI.GeometryServiceProvider.ReflectInstance()     
   at GeoAPI.GeometryServiceProvider.get_Instance()     
   at SharpMap.Data.Providers.ShapeFile.set_SRID(Int32 value) in C:\dev\DLLs\SharpMap Source\Trunk\SharpMap\Data\Providers\ShapeFile.cs:line 859     
   at SharpMap.Data.Providers.ShapeFile.ParseProjection() in C:\dev\DLLs\SharpMap Source\Trunk\SharpMap\Data\Providers\ShapeFile.cs:line 978     
   at SharpMap.Data.Providers.ShapeFile..ctor(String filename, Boolean fileBasedIndex) in C:\dev\DLLs\SharpMap Source\Trunk\SharpMap\Data\Providers\ShapeFile.cs:line 302     
   at Dashboard.Widgets.MapWidget.AddCountriesLayer() in c:\dev\Dashboard\v1\Dashboard\Classes\Widgets\Generic\MapWidget.cs:line 86 
```

这到底是怎么回事？为什么要先使用实体​​框架破坏它？

为了解决这个问题，我将它添加到 program.cs 中，以强制首先加载小部件。

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    // Hack to force SharpMap to register before entity framework
    var widget = new Widgets.MapWidget();
    widget.Update();

    Application.Run(new DashboardForm());
} 
```

但是，我不喜欢它——它看起来很脆弱，我不喜欢“巧合编码”。有什么我可以解决的吗？

# 笔记：

我发现这篇博文：[http ://elegantcode.com/2010/01/28/the-entity-framework-and-the-the-invoked-member-is-not-supported-in-a-dynamic-assembly-异常/](http://elegantcode.com/2010/01/28/the-entity-framework-and-the-the-invoked-member-is-not-supported-in-a-dynamic-assembly-exception/) 我将域程序集添加到 connectionString

我的项目结构是这样的：

## 仪表板.exe

*   App.Config 包含连接字符串
*   参考 SharpMap
*   引用域.dll
*   包含 MapWidget

## 域.dll

*   包含 DomainModel 和 Services
*   使用实体模型进行持久化
*   App.config 包含连接字符串、实体框架配置部分和实体框架连接工厂

* * *

所以我的问题是：

1.  为什么会这样？
2.  我能做些什么来阻止它？（如果没有，有没有比 Program.cs 更好的地方来存放 hacky 代码）

感谢阅读，如果我不清楚，请让我澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-12T17:06:06.043

我有一个非常相似的问题，但我没有使用实体框架（我使用的是 NHibernate），所以，我发现这毕竟可能不是代理对象问题。

我也不喜欢“巧合编码”，但我假设通过调用`new MapWidget()`，一些与 GeoApi 相关的初始化是在内部执行的——因为 SharpMap 在内部使用 GeoApi。

就我而言，我没有直接使用地图，我只是使用 NHibernate 在我的数据库中插入了一些地理数据，并且得到了完全相同的堆栈跟踪，所以我认为这可能是同一个问题。

尽管我很讨厌它，但我有这样的事情：

```
// my object to be persisted using NHibernate
var myObj = new MyObj();

// add polygon of type GeoAPI.Geometries.IGeometry
myObj.CoveredArea = myGeoFactory.CreatePolygonArea(/* ... */);

// use NHibernate to save my obj
sessioNScope.Save(myObj); // <- throws NotSupportedException here 
```

它给了我和你一样的例外。改成之后

```
// Ignore this line: hack to initialize GeoApi
new Map(); 

// my object to be persisted using NHibernate
var myObj = new MyObj();

// add polygon of type GeoAPI.Geometries.IGeometry
myObj.CoveredArea = myGeoFactory.CreatePolygonArea(/* ... */);

// use NHibernate to save my obj
sessioNScope.Save(myObj); 
```

它工作得很好。在我的情况下，我使用`new Map()`而不是`new MapWidget()`因为它是一个[winforms](/questions/tagged/winforms "显示标记为“winforms”的问题")应用程序。

**TLDR：**将其视为执行初始化的 hack

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T20:51:44.323

这很可能是由于 EF 生成的动态代理。我不熟悉 SharpMap，所以我无法评论它在 EF 之前初始化它有什么影响，但你应该能够通过禁用代理创建来避免异常：

```
context.Configuration.ProxyCreationEnabled = false; 
```

请注意，这将禁用延迟加载和更改跟踪，因此请先仔细阅读本文：http: [//msdn.microsoft.com/en-us/data/jj592886](http://msdn.microsoft.com/en-us/data/jj592886)

# javascript - 使用间隔小于 1 的 setTimeout

> ID：15317424
> 
> 赞同：1
> 
> 时间：2013-03-10T00:10:58.313
> 
> 标签：javascript, settimeout

我在 Javascript 中做了很多递归，为了防止堆栈溢出，我一直在使用 setTimeout。这是一个快速的理论示例：

```
go(){
    setTimeout(function(){
        x++;
        go();
    },1);
} 
```

我还有一个`x`每隔几秒就会记录到控制台的函数，但这不是问题。我所看到的是，无论我为超时设置什么值，我在示例中使用了 1，脚本每秒只能运行 1000 次。我正在做数亿级别的递归，所以这还不够快。当我将超时值设置为 0、0.1 或 1/10 时，我仍然每秒只能获得大约 1000 次。我尝试使用 32 位和 64 位浏览器（Chrome 和 Firefox）无济于事。

我怎样才能将速度提高一个档次？另外，我对这一切都比较陌生，所以如果解决方案是一个简单的解决方案，那就太棒了。

哦，忘了提：如果我完全删除 setTimeout，我每次都会溢出堆栈。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:20:21.357

您的解决方案不在于让您当前的代码运行，而是重新思考代码。

我不知道您如何在代码中使用递归，但显然您使用错误。

对于递归的任何合理使用，您都不会溢出堆栈。如果您要进行数亿级别的递归调用，那至少是一百万倍。

使用递归时的一种常见方法是将每个级别的工作分成两半。这样，您就可以处理所有可以放入内存的项目，而无需深入到大约 30 个级别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-10T20:45:23.833

我尝试了像您一样的方法并找到了解决方案！您不需要递归和函数`setTimeout`，但您所需要的只是在循环`setInterval`中以 1 个间隔重复使用您想要的函数上的函数。`for`例如，如果 for 循环重复 10 次，则 10 个计时器将每 4 毫秒执行一次相同的函数。代码将越来越快地重复执行。

例如，您的代码应如下所示：

```
function onload() {
   for (var i = 0; i < 10; i++)
      setInterval(go, 1);
}
function go() {
   x++;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T00:25:07.970

JavaScript 是单线程的，setTimeout 会将您的操作放在队列的末尾。即使您减少了延迟，您仍然必须等待之前的操作完成，然后您添加的操作才会启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-10T00:31:49.650

不可能让 setTimeout 等待少于 4 毫秒。这就是在 HTML 标准中定义[setTimeout的方式（](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)[此处](http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#timers)为官方规范）。您的问题更有可能与代码的结构有关。向我们展示您的其余代码，也许我们可以帮助解决它。

# c++ - 有人能告诉我c++中的类和结构有什么区别吗

> ID：15317427
> 
> 赞同：-1
> 
> 时间：2013-03-10T00:11:41.580
> 
> 标签：c++, class, struct

例如，有什么区别：

```
strucut Nodo{
    Nodo *siguiente,*anterior;
    char* Nombre,Curso;
    long,carnet;
    Nodo(){
        siguiente=anterior=NULL;
    } 
```

和：

```
class Nodo{
public:    
Nodo *siguiente,*anterior;
char* Nombre,Curso;
long carnet;
Nodo(){
    siguiente=anterior=NULL;
    } 
```

我想我看到的一个区别是，在课堂上你必须公开，或者另一方面，所有的陈述都是私人的，但我看不出任何重要的区别，或任何重要的区别。有一些我不知道的重要方面？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-10T00:13:29.730

`class`a和 a之间的唯一区别`struct`是默认访问说明符。A`class`的成员是`private`默认的，而 a`struct`的成员是`public`默认的。这也意味着默认情况下是`class`继承，默认情况下是继承。`private``struct``public`

如标准所述：

> 默认情况下，使用关键字定义的类的成员`class`。`private`使用关键字定义的类的成员`struct`或默认情况下`union`。`public`

对于继承：

> 在基类没有*访问说明符*`public`的情况下，当派生类使用 class-key 定义时假定，并且在使用*class-key* `struct`定义*类*`private`时假定。 *`class`*

# c# - 将 XAML 加载到 C# 以进行数据绑定

> ID：15317428
> 
> 赞同：1
> 
> 时间：2013-03-10T00:11:57.573
> 
> 标签：c#, xaml, visual-studio-2012, .net-4.5

好的，我们现在正在为我们的 GUI 尝试 XAML（并且边走边学）......我已经能够在 XAML 和 C# 中相互独立地进行数据绑定而不会出现问题，但现在是我需要的时候了来回传递值，我有点迷茫。当我编译并尝试导航到页面时，它会抛出 XamlParseException：指定的类名与实际的根实例类型不匹配。删除 Class 指令或通过 XamlObjectWriterSettings.RootObjectInstance 提供实例。第 5 行位置 2。

非常感谢任何帮助或在正确方向上轻轻推动:)

这就是我所在的位置：

```
namespace TheAirline.GraphicsModel.PageModel.PageFinancesModel
{
    /// <summary>
    /// Interaction logic for PageFinances.xaml
    /// </summary>
    public partial class PageFinances : Page
    {
        private Airline Airline;

        public PageFinances(Airline airline)
        {
            InitializeComponent();
            this.Language = XmlLanguage.GetLanguage(new   CultureInfo(AppSettings.GetInstance().getLanguage().CultureInfo, true).IetfLanguageTag);

            this.Airline = airline;
            Page page = null;
//loading the XAML
          using (FileStream fs = new FileStream("TheAirline\\GraphicsModel\\PageModel  \\PageFinancesModel\\PageFinances.xaml", FileMode.Open, FileAccess.Read))
            {
            page = (Page)XamlReader.Load(fs);
            }
//finding XAML element and trying to set the value to a variable
          string airlineCash = GameObject.GetInstance().HumanAirline.Money.ToString();
          TextBox cashValue = (TextBox)page.FindName("cashValue");
          cashValue.DataContext = airlineCash;
        }
    }
} 
```

XAML 的前几行：

```
<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"      
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"   
    xmlns:AirlineModel="clr-namespace:TheAirline.Model.AirlineModel"
    mc:Ignorable="d"
x:Class="TheAirline.GraphicsModel.PageModel.PageFinancesModel.PageFinances"
    xmlns:c="clr-namespace:TheAirline.GraphicsModel.Converters"
...>
</Page> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T14:22:19.193

[XAML 中的绑定](http://msdn.microsoft.com/en-us/library/ms750612.aspx)[`DataContext`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.datacontext.aspx)针对分配给任何给定 XAML 元素的属性的对象进行解析。该属性（以及许多其他属性）的值在任何给定的[可视树中从父元素](http://msdn.microsoft.com/en-us/library/ms753391.aspx#two_trees)[继承](http://msdn.microsoft.com/en-us/library/ms753197.aspx)到子元素。

例如，给定这个类：

```
public namespace MyNamespace
{
    public class ViewModel
    {
        public string Name {get;set;}
        public bool IsActive {get;set;}
    }
} 
```

和这个 XAML：

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MyNamespace"
        FontSize="20">
   <Window.DataContext>
       <local:ViewModel>
   </Window.DataContext>
   <StackPanel>
       <TextBox Text="{Binding Path=Name}"/>
       <CheckBox IsChecked="{Binding Path=IsActive}"/>
   <StackPanel>
</Window> 
```

XAML 中定义的所有四个对象，the `Window`、the `StackPanel`、the`TextBox`和 the `CheckBox`，都将具有`FontSize`20 的 a，并且将类的实例`ViewModel`分配给它们的`DataContext`属性。因此，所有绑定（带有指定[`ElementName`](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.elementname.aspx)、[`RelativeSource`](http://msdn.microsoft.com/en-us/library/system.windows.data.relativesource.aspx)或的绑定除外[`Source`](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.source.aspx)）都将针对该实例进行解析。

如果属性是在代码中而不是在 XAML 中分配的，那将是完全相同的：

```
public MyWindow() //Window Constructor
{
    InitializeComponent();
    this.DataContext = new ViewModel(); //Note that keyword "this" is redundant, I just explicity put it there for clarity.
} 
```

正因为如此，不需要`DataContext`显式地为每个元素设置属性，因为框架已经处理好了。

此外，请注意，在 XAML 中，大多数内置[标记扩展](http://msdn.microsoft.com/en-us/library/ee855815.aspx)都有一个默认构造函数约定，允许您缩写它们的用法。在[Binding Markup Extension](http://msdn.microsoft.com/en-us/library/ms750413.aspx)的情况下，默认构造函数具有该`Path`属性，因此：

```
<TextBox Text="{Binding Path=Name}"/> 
```

与此完全相同：

```
<TextBox Text="{Binding Name}"/> 
```

现在，为了使基础 DataContext 中的属性更改自动从绑定源 ( `ViewModel`) 传递到绑定目标（XAML 定义的对象），源对象必须实现接口并在每次属性更改时[`System.ComponentModel.INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)引发事件。`PropertyChanged`

因此，为了支持双向绑定，示例类应如下所示：

```
public namespace MyNamespace
{
    public class ViewModel: INotifyPropertyChanged
    {
        private string _name;
        public string Name 
        {
            get
            {
                return _name;
            }
            set
            {
                _name = value;
                NotifyPropertyChanged("Name");
            }
        }

        private bool _isActive;
        public bool IsActive
        {
            get
            {
                return _isActive;
            }
            set
            {
                _isActive = value;
                NotifyPropertyChanged("IsActive");
            }
        }
    }

    public void NotifyPropertyChanged (string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName);
    }
} 
```

请注意，`ViewModel`该类不依赖或直接引用任何 XAML 定义的对象，但它仍然包含将出现在 UI 中的属性的值。这允许 UI 和应用程序逻辑/数据（称为[`MVVM Pattern`](https://stackoverflow.com/questions/14381402/wpf-programming-methodology/14382137#14382137). 如果您希望在 C# + XAML 编程中取得成功，我强烈建议您研究该主题，因为与其他传统 UI 范例相比，它是一种彻底的思维转变。

例如，在基于 XAML 的应用程序中不推荐这样的事情：

```
if (myWindow.CheckBox1.IsChecked)
    //Do Something 
```

因为这意味着您正在耦合应用程序逻辑并使其依赖于 UI 元素的状态，而这正是您需要避免的。

请注意，此答案中引用的所有链接和所有概念都与 WPF 有关，但也适用于 Silverlight 和 WinRT。由于您没有指定您使用的是三个基于 XAML 的框架中的哪一个，因此我发布了 WPF 框架，这是我最熟悉的。

# java - add() 方法中的 NullPointerException

> ID：15317434
> 
> 赞同：-2
> 
> 时间：2013-03-10T00:12:42.300
> 
> 标签：java, arraylist, nullpointerexception, add

我的问题是我`add()`为我的`ArrayList`.

我得到一个`NullPointerException`. `add()`如以下代码所示，如​​何在我的类中实现方法？

这是代码：

```
public class XY{

    private List<DictEntry> dict = new ArrayList<DictEntry>();

    public void add(String word, int frequency) {
        DictEntry neu = new DictEntry(word, frequency);
        if (word == null || frequency == 0) {
            return;
        }
        if (!dict.isEmpty()) {
            for (int i = 0; i < dict.size(); i++) {
                if (dict.get(i).getWord() == word) {
                    return;
                }
            }
        }
        dict.add(neu);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:26:50.417

没有它被抛出的行号，就很难说。但无论如何，我建议不要采取你的方法。

首先：不要重新实现现有的功能：

```
public class XY{
private List<DictEntry> dict = new ArrayList<DictEntry>();

    public void add(String word, int frequency) {
       if (word == null || frequency == 0) {
            return;
        }

       DictEntry neu = new DictEntry(word, frequency);
       if (!dict.contains(word)) {
         dict.add(word);
       }
    }
} 
```

更好的是，使用更适合问题的结构。您正在将一个单词映射到一个计数 - 这就是您使用 DictEntry 所做的所有事情，在这里。那么为什么不呢：

```
public class XY{
private Map<String, Integer> dict = new HashMap<String, Integer>();

    public void add(String word, int frequency) {
       dict.put(word, frequency);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:20:49.987

你的数组中有一个`null`元素。`dict.get(i).getWord()`就好像`null.getWord()`

# java - 为什么我的号码没有记录并打印在我的数组中？

> ID：15317436
> 
> 赞同：1
> 
> 时间：2013-03-10T00:12:48.977
> 
> 标签：java

好的，所以我正在尝试制作一个非常简单的数字生成器，限制为 1 和 100。我已经阅读了我可以在网上找到的所有内容，但无法弄清楚为什么我的代码没有记录 1-100 之间的数字然后数组打印数组中的数字。当我运行代码时，数字 36 会一遍又一遍地打印出来。我究竟做错了什么？

```
import java.util.Random;
public class NumberGen
{
    public static void main(String[] args)
    {
        int numbers[]=new int[10];
        Random gen = new Random();

        for(int i=0; i<numbers.length;i++)
        {
            int number=gen.nextInt();
            while(number<1 || number>100)
            {
                number=gen.nextInt();
            }

            while(number<=100 && number >=1)
            {
                numbers[i]=number;
                System.out.println(numbers[i]);
            }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:19:43.790

第二个while不应该是if吗？我很确定这是一个无限循环。以及您为什么要使用第一个时间，所有这些：

```
int number=gen.nextInt();
            while(number<1 || number>100)
            {
                number=gen.nextInt();
            } 
```

当你可以 int number=gen.nextInt(100)+1;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:16:57.940

您应该使用另一种风格`nextInt`-> [http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt(int)](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt(int))

在你的情况下：

```
int number=gen.nextInt( 100 ) + 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:22:45.963

考虑这里发生的事情：

```
 for(int i=0; i<numbers.length;i++)
    {
        /**
        *int number=gen.nextInt();
        *while(number<1 || number>100)
        *{
        *    number=gen.nextInt();
        *}
        **/
        number = 1;

        while(number<=100 && number >=1)
        {
            numbers[i]=number;
            System.out.println(numbers[i]);
        }
    } 
```

for 循环中的 while 卡在无限循环中，因为“数字”永远不会改变

您应该尝试做的是将数字存储在单个 for/while 循环中，然后在单独的 for/while 循环中打印

```
for(int i=0; i<numbers.length;i++){
    //FYI gen.nextInt(100) generates a int from 0 to 99
    //store values
}
for(int i=0; i<numbers.length;i++){
    //print values in arr
} 
```

# ruby-on-rails - Ruby Soundcloud Gem：无法测试上传的文件

> ID：15317439
> 
> 赞同：0
> 
> 时间：2013-03-10T00:13:09.790
> 
> 标签：ruby-on-rails, ruby, testing, capybara, soundcloud

对soundcloud gem的测试还没有看到太多。大多数事情都很出色——但是我发现通过我的规范将文件上传到 SoundCloud 有点棘手。

这是问题所在：

规格：

```
file = "#{Rails.root}/spec/factories/files/sample.mp3"
title = "From the test suite"
track = @client.post('/tracks', track: {title: title, asset_data: File.new(file)}) 
```

我是否使用

```
File.new 
```

或者

```
File.expand_path 
```

错误是一样的：**NoMethodError: undefined method `map' for #String:0x007fa1ce8425c0**

控制器中成功的代码是：

```
file = params["soundcloud_file"]
title = params["title"]
track = client.post('/tracks', track: {
  title: title
  asset_data: File.new(file.tempfile, 'rb')
  }) 
```

现在我知道 params["soundcloud_file"] 是一个 ActionDispatch::Http::UploadedFile，所以这就是我过去一个小时左右一直在尝试使用的东西，但没有运气。

我愿意以任何方式成功测试上传。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-12T13:46:47.660

问题出在“webmock”gem 上。即使使用 VCR (<1.10.0) 所需的版本，它也会抛出：

```
NoMethodError: undefined method `map' for <#String: ... > 
```

用 'fakeweb' gem 替换可以纠正错误。

# javascript - “this”引用在回调中更改的解决方案？

> ID：15317444
> 
> 赞同：1
> 
> 时间：2013-03-10T00:14:20.610
> 
> 标签：javascript, node.js

我一次又一次遇到的问题之一是对`this`指针更改的引用。以下面的例子为例。我想创建一个服务器对象，并将相机的分辨率存储为一个属性。这是不可能的，因为它`this.resolution`适用于相机回调对象而不是 Server 对象中的属性。

```
function Server(options) {
    this.settings = options.settings;
    this.camera = options.camera;

    // Grab camera resolution
    this.camera.getImageResolution(function(err, data) {
        this.resolution = data;
    });
}

Server.prototype.start = function() {
    console.log(this.resolution); // This outputs an undefined variable error
} 
```

过去，我通过重命名`this`为`self`临时调用函数来解决此问题。当我存储一个值时，这不起作用。我需要传入`this`回调，这显然是我做不到的。

此外，我不能使用`apply`，因为这不允许`camera.getImageResolution`调用它自己的方法。

解决此问题的最佳途径是什么？如果我的问题含糊不清，请要求澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:42:57.327

```
function Server(options) {
    var self = this;

    self.settings = options.settings;
    self.camera = options.camera;

    // Grab camera resolution
    this.camera.getImageResolution(function(err, data) {
        self.resolution = data;
    });
}

Server.prototype.start = function () {
    return this.resolution;
}

var server = new Server({options: {...}, settings: {...}});
server.camera.getImageResolution();
// after getImageResolution's asynch method has completed
server.start()  // === data parameter from getImageResolution's asynch method callback 
```

# c++ - 了解维特比算法

> ID：15317447
> 
> 赞同：1
> 
> 时间：2013-03-10T00:14:33.797
> 
> 标签：c++, algorithm, hidden-markov-models, viterbi

我正在尝试从[这里实现一些代码](http://code.soundsoftware.ac.uk/projects/qm-dsp/repository/entry/dsp/segmentation/cluster_segmenter.c)

我已经用我的系数训练了 HMM，但不明白 Viterbi 解码器算法是如何工作的，例如：

```
 viterbi_decode(MFCC, M, model, q);
 where MFCC = coefficents 
 M = size of MFCC
 model = Model of HMM training using the MFCC coefficients 
 q = unknown (believed to be the outputted path). 
```

但这是我不明白的：我试图比较两个语音信号（训练、样本）以找出最接近的可能匹配。例如，使用 DTW 算法，返回一个整数，然后我可以在其中找到最接近的整数，但是，使用此算法，它返回 a `int* array`，因此很难区分。

以下是当前程序的工作方式：

```
vector<DIMENSIONS_2> MFCC = mfcc.transform(rawData, sample_rate);

int N = MFCC.size();
int M = 13;

double** mfcc_setup = setupHMM(MFCC, N, M);

model_t* model = hmm_init(mfcc_setup, N, M, 10);

hmm_train(mfcc_setup, N, model);

int* q = new int[N];

viterbi_decode(mfcc_setup, M, model, q); 
```

谁能告诉我维特比解码器如何解决识别从训练到输入的最佳路径的问题？我在解码路径上尝试了欧几里得距离和汉明距离，`(q)`但没有这样的运气。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T07:48:13.060

在这个例子中，在我看来 (q) 是隐藏状态序列，因此是从 0->9 的数字列表。如果你有两个音频样本，比如测试和训练，然后生成两个序列 q_test 和 q_train，那么考虑 |q_test - q_train|，其中范数是分量距离，是没有用的，因为它不代表距离的概念正确，因为 HMM 中的隐藏状态标签可能是任意的。

考虑距离的更自然的方法可能是以下，给定 q_train，您对测试样本采用相同路径的概率感兴趣，一旦您拥有转换矩阵和发射概率，您就可以计算该概率。

如果我误解了您的问题，请告诉我。

# ios - 使用 soundcloud 作为音频文件服务

> ID：15317448
> 
> 赞同：1
> 
> 时间：2013-03-10T00:14:34.010
> 
> 标签：ios, soundcloud

我想在 soundcloud 上存储我的 iPhone 应用程序的样本。这将使我能够打包一个小型二进制文件并让用户在安装后下载声音。

我会在 soundcloud 上**公开所有声音以供下载**，一旦进入应用程序，我就会连接到 soundcloud 并下载声音。

我可以使用[soundcloud api](http://developers.soundcloud.com/docs/api/reference)来执行此操作吗？应用程序用户不会登录到 soundcloud。这是否超出使用条款？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T14:33:19.730

是的，这似乎是一个合理的用途，但请注意，在免费帐户上上传的曲目每个下载次数限制为 100 次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T13:24:20.747

从技术上讲，是的，我不明白为什么这是不可能的。至于使用条款，请参考[http://developers.soundcloud.com/docs/api/terms-of-use](http://developers.soundcloud.com/docs/api/terms-of-use)或者[https://soundcloud.com/terms-of-use](https://soundcloud.com/terms-of-use)

我个人不认为这是一种滥用，但不要相信我的话，自己验证一下。

# ios - 如何沿曲线绘制图像

> ID：15317453
> 
> 赞同：1
> 
> 时间：2013-03-10T00:15:15.513
> 
> 标签：ios, core-graphics

我画了一条曲线：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextMoveToPoint(context, firstPoint.x, firstPoint.y);
CGContextAddCurveToPoint(context, cpx1, cpy1, cpx2, cpy2, finalPoint.x, finalPoint.y); 
```

现在我想沿着曲线的路径多次绘制图像。

有可能这样做吗？如果是这样，如何？

# java - 当我修改模块文件时，Netbeans 不会更新我的 Netbeans-Platform 应用程序

> ID：15317460
> 
> 赞同：0
> 
> 时间：2013-03-10T00:17:02.453
> 
> 标签：java, netbeans-platform, netbeans-plugins, netbeans-7.3

我目前在 7.3RC2 基础上开发 Netbeans 应用程序时遇到了麻烦：我有一些自己的模块，当我运行应用程序时（从 netbeans 中的模块），自昨天以来似乎没有任何变化。看起来我的“可执行”文件被冻结了，不管我在做什么。

我尝试清理模块，重新创建它们并导入源代码，拼命地重新创建完整的项目并将源代码粘贴到其中......没办法。

然后，我想知道是否有一种“执行文件夹”会包含一些开玩笑的数据。

我在 Google 和 SO 上进行了一些搜索，但没有找到任何答案。

欢迎任何想法！

[编辑 1]

看来我的 Netbeans 应用程序正在使用旧模块 JAR，尽管模块 clean&build 并没有更新它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T22:28:09.823

解决了 ！

*我所有*模块中的“公共 API”配置出乎意料地出错了，它们处于“自动加载”状态，我不知道为什么。

我的想法是手动取消选中并重新选中所有必要的复选框，现在一切正常。

# mysql - 从服务器下载图像目录并存储在 iPhone 上

> ID：15317461
> 
> 赞同：0
> 
> 时间：2013-03-10T00:17:25.867
> 
> 标签：mysql, ios

我正在尝试为我的区域创建一个业务目录应用程序，我目前正在尝试创建一个包含所有真实业务信息（名称、地址、营业时间等）的 sql DB。然后我计划有一个存储所有徽标图像的物理文件目录，该目录将存储在服务器上的某个位置。

当用户启动应用程序时，他们将被提示下载所有关于商业列表的信息（因为它是针对一个小社区的），然后我将使用 NSURLConnection 将所有数据上传到手机，数据将是 Zlib NSData 中的XML 的形式。我会将所有这些数据存储到 coredata 中（它将充当应用程序缓存）。

下一步是下载我存储在数据库中的图像目录。但我不知道最好的方法，希望得到一些指导、示例代码等。

例如，将图像存储到 sqlDB 中会更好吗？我读过这是一个坏主意，所以我正在尝试上面解释的方法。

我仍在构建 sqlDB 的过程中，但我遇到的困难是想出一种方法将图像放到设备上，并使用 id 字段或类似的东西将它们与正确的业务相关联.. 或者有更简单的怎么做？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T09:21:32.933

您可以存储 URL 以访问图像二进制文件，而不是将图像直接存储在数据库中。这将保持与图像的关系，而无需将大图像数据直接存储在数据库中。然后，您可以使用从数据库中检索到的 URL 将图像下载到设备上，并类似地将下载的缓存图像的路径存储在核心数据中。

# android - XML 错误/Android SDK

> ID：15317462
> 
> 赞同：0
> 
> 时间：2013-03-10T00:17:34.203
> 
> 标签：android, xml, google-maps-android-api-2

我正在尝试让我在 Android 中的 Google 地图向我展示我的位置。Java 没有显示错误。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

<TextView
    android:id="@+id/tv_location"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_below="@id/tv_location"
    class="com.google.android.gms.maps.SupportMapFragment" />

</RelativeLayout> 
```

错误显示`xmlns`对于片段标签显然无效。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:22:39.747

xmlns:android 属性是一个命名空间声明，并且只应位于 XML 文件的根布局中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:22:09.670

尝试将其包含在您的片段中

```
xmlns:map="http://schemas.android.com/apk/res-auto" 
```

# node.js - 如何在 node.js 中完成繁重的处理操作

> ID：15317464
> 
> 赞同：8
> 
> 时间：2013-03-10T00:17:43.093
> 
> 标签：node.js, image-processing

我有一个繁重的数据处理操作，我需要每 10-12 个同步请求完成。我已经读过，对于更高级别的并发，Node.js 是一个很好的平台，它通过非阻塞事件循环来实现它。

我所知道的是，对于查询数据库之类的事情，我可以将一个事件生成到一个单独的进程（如`mongod`, `mysqld`），然后有一个回调来处理该进程的结果。很公平。

但是，如果我想在回调中完成大量计算怎么办。在该回调中的代码完全执行之前，它不会阻止其他请求。例如，我想处理高分辨率图像，而我拥有的代码本身就在 Javascript 中（`no separate`进行图像处理的过程）。

我认为实施的方式就像

```
get_image_from_db(image_id, callback(imageBitMap) {
    heavy_operation(imageBitMap); // Can take 5 seconds.
}); 
```

是否会`heavy_operation`阻止节点在这 5 秒内接受任何请求。还是我在想错误的方式来完成这项任务。请指导，我是JS新手。

**更新**

或者是否可以像我可以处理部分图像并让事件循环返回以接收其他回调并返回处理该部分图像。（类似于优先事件）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T00:34:37.663

是的，它会阻止它，因为回调函数是在主循环中执行的。只有异步调用的函数不会阻塞循环。据我了解，如果您希望图像处理异步执行，则必须使用单独的进程来执行此操作。

请注意，您可以编写自己的异步进程来处理它。首先，您可以阅读[如何为 Node.js 编写异步函数](https://stackoverflow.com/questions/6898779/how-to-write-asynchronous-functions-for-node-js)的答案。

**更新**

[如何在 node.js 中创建非阻塞异步函数？](https://stackoverflow.com/questions/2878008/how-do-i-create-a-non-blocking-asynchronous-function-in-node-js)可能也值得一读。这个问题实际上在我链接的另一个问题中被引用，但为了简单起见，我想我会把它包括在这里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T02:00:14.493

不幸的是，我还没有足够的声望点来评论尼克的回答，但是你看过[Node 的集群 API](http://nodejs.org/api/cluster.html)吗？它目前仍处于试验阶段，但它允许您生成多个线程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-06-14T18:56:56.277

当回调中完成大量计算时，事件循环将被阻塞，直到计算完成。这意味着回调将阻塞事件循环 5 秒。

**我的解决方案**

可以使用生成器函数将控制权交还给事件循环。我将使用一个`while loop`运行 3 秒的函数作为长时间运行的回调。

**没有生成器功能**

```
let start = Date.now();

setInterval(() => console.log('resumed'), 500);
function loop() {
    while ((Date.now() - start) < 3000) { //while the difference between Date.now() and start is less than 3 seconds
        console.log('blocked')
    }
}

loop(); 
```

输出将是：

```
// blocked
// blocked
//
//  ... would not return to the event loop while the loop is running
//
// blocked
//...when the loop is over then the setInterval kicks in
// resumed
// resumed 
```

**带有生成器功能**

```
let gen;
let start = Date.now();

setInterval(() => console.log('resumed'), 500);

function *loop() {
    while ((Date.now() - start) < 3000) { //while the difference between Date.now() and start is less than 3 seconds
        console.log(yield output())
    }
}

function output() {
    setTimeout(() => gen.next('blocked'), 500)
}

gen = loop();
gen.next(); 
```

输出是：

```
// resumed
// blocked
//...returns control back to the event loop while though the loop is still running
// resumed
// blocked
//...end of the loop
// resumed
// resumed
// resumed 
```

**使用 javascript生成**器可以帮助运行繁重的计算函数，这些函数会在事件循环仍在计算时将控制权交还给事件循环。

要了解有关事件循环的更多信息，请访问 [https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*)

[https://davidwalsh.name/es6-generators](https://davidwalsh.name/es6-generators)

# vba - vba excel if函数的标准数组

> ID：15317466
> 
> 赞同：4
> 
> 时间：2013-03-10T00:18:06.490
> 
> 标签：vba, excel

我正在使用 worksheetfunction.averageifs() 和 worksheetfunction.countifs() 函数。

我有一些条件来指定应该寻找什么条件，所以我只想有一个可以添加新条件的数组，而不是一系列杂乱的条件：

```
If (dep = 0) Then
    sortspg = True
    colcount = .CountIfs(column, "<3", badCol, "1")
    If (colcount > 0) Then
        colavg = .AverageIfs(column, column, "<3", badCol, "1")
        insert = True
    Else
        insert = False
    End If
Else
    colcount = .CountIfs(column, "<3", DepColumn, dep, badCol, "1")

    If colcount > 0 Then
        colavg = .AverageIfs(column, column, "<3", DepColumn, dep, badCol, "1")
        insert = True
    Else
        insert = False
    End If
End If 
```

我可以传递一个像这样的数组：

```
CondArray(column => "<3", DepColumn => dep)
If colCount > 0 Then 
CondArray[] = (badCol => "1") 
```

接着

```
.CountIfs(CondArray)
.AverageIfs(column, CondArray) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T07:31:15.653

您可以使用`For...Next`循环构建它来设置公式和`Evaluate`函数。

```
Sub Build_Formula()
'http://stackoverflow.com/questions/15317466/vba-excel-array-of-criteria-for-if-functions
Dim i As Long, lOutput As Long
Dim strTempArr As String
Dim CondArray() As Variant
Dim StrFormulaBuildUp As String
Dim rng As Range

'Modify constant with applicable formula worksheet function
Const STRFORMULASTART As String = "CountIfs("

'Note used this for test data; edit as applicable
Set rng = Cells.CurrentRegion

'Build array holding conditions; the way the loop is structured is for
'the "COUNTIF" function; modify as necessary
CondArray = Array(rng, "<3")

StrFormulaBuildUp = STRFORMULASTART
'Begin loop to build formula
For i = LBound(CondArray) To UBound(CondArray)
    'Test if value in condition array is a range
    'if yes set the range address to a string
    If TypeName(CondArray(i)) = "Range" Then
        strTempArr = CStr(CondArray(i).Address)
    Else
        'If condtion, then add quote marks
        strTempArr = Chr(34) & CStr(CondArray(i)) & Chr(34)
    End If
    StrFormulaBuildUp = StrFormulaBuildUp & strTempArr & ","
Next i
'Remove extra "," from string and close formula
StrFormulaBuildUp = Left(StrFormulaBuildUp, Len(StrFormulaBuildUp) - 1) & ")"
'Determine forumla value
lOutput = Evaluate(StrFormulaBuildUp)
MsgBox lOutput
End Sub 
```

# java - Java对象引用问题

> ID：15317467
> 
> 赞同：0
> 
> 时间：2013-03-10T00:18:07.673
> 
> 标签：java, pointers, reference

我认为我没有正确理解 java 处理对象引用的方式。这是我意识到某些事情没有像我想象的那样工作的问题示例：

```
public void UnequipObject(int index) {

    UsableItem ui = null;

    if(index == 0) ui = item1;
    else if(index == 1) ui = item2;
    else if(index == 2) ui = item3;

    if(ui != null)
    {
        int itemId = ui.GetId();            
        State.Instance().AddItem(itemId, 1);            
        ui = null;
    }
} 
```

该功能 unequip 一个角色的对象（我正在开发一个视频游戏）。每个角色最多有三个对象。为了使其更通用，使用给定的索引，您取消装备该对象。为此，我在 ui 中复制了我想要取消装备以对其进行更改的对象。国家在这里并不重要。关键是，当我进行“ui = null”的赋值时，原来的对象也应该是null，因为我认为在你将对象分配给ui的那一刻，两者都是相同的引用，你可以编辑两者中的任何一个，更改将同时影响两者...

有人可以帮我解决这个误解吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:21:35.503

`ui`是一个局部变量。您只是*将此*变量设置为`null`. 您不会影响代码中的任何其他变量。稍后，您指定`ui`参考其他项目之一并对其进行处理。

附带说明一下，我强烈建议您使用数组或列表。这将使检索项目更容易（一行，而不是一堆 if..else if..else's）。如果您将来决定这样做，它还将使向库存中添加更多“插槽”变得更加容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:24:12.073

您不能将对象设置为 null。是的，您设置`ui`为`null`，但 ui 只是对对象的一个​​引用（可能还有其他引用原始对象）。对象本身不受此影响。

只有没有对原始对象的引用，才会被垃圾回收。

# c# - 如何在以下或类似情况下避免线程等待（如果真的有必要让线程等待）？

> ID：15317468
> 
> 赞同：1
> 
> 时间：2013-03-10T00:18:37.757
> 
> 标签：c#, .net, multithreading

请看下面的代码片段。我正在尝试执行一个长时间运行的任务，但我不想等待超过给定的超时时间。我想完全控制任务何时开始，因此产生一个新线程并完成工作，并在父线程中等待它。该模式确实有效，但父线程只是在等待。理想情况下，我不喜欢线程休眠/等待，除非它真的需要。我怎样才能做到这一点？欢迎任何建议/想法/模式。

```
/// <summary>
/// tries to execute a long running task
/// if the task is not completed in specified time, its deemed un-sccessful.
/// </summary>
/// <param name="timeout"></param>
/// <returns></returns>
bool Task(int timeout)
{
    bool workCompletedSuccessfully = false;
    //I am intentionally spawning thread as i want to have control when the thread start
    //so not using thread pool threads.
    Thread t = new Thread(() =>
    {
        //executes some long running task
        //handles all the error conditions
        //ExecuteTask();
        workCompletedSuccessfully = true;
    });
    t.Start();
    //cannot wait more "timeout"                        
    //My main thread (parent) thread simply waiting for the spawened thread to join
    //HOW CAN I AVOID THIS?ANY PATTERN TO AVOID THIS REALLY HELPS?
    t.Join(timeout);
    if (!workCompletedSuccessfully)
    {
        //deeemed un-successful
        //do the remediation by gracefully disposing the thread
        //itnentionally hidden details about disposing thread etc, to concentrate on 
        //the question - AVOIDING PARENT THREAD TO WAIT
    }
    return workCompletedSuccessfully;
} 
```

问候，梦想家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:24:30.977

使用[AutoResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)。

```
bool Task(int timeout)
{
    AutoResetEvent threadFinished = new AutoResetEvent(false);
    //I am intentionally spawning thread as i want to have control when the thread start
    //so not using thread pool threads.
    Thread t = new Thread(() =>
    {
        //executes some long running task
        //handles all the error conditions
        //ExecuteTask();
        threadFinished.Set();
    });
    t.Start();
    //Param - timeout
    bool finished = threadFinished.WaitOne(timeout);
    if (!finished)
    {
        //deeemed un-successful
        //do the remediation by gracefully disposing the thread
    }
    return finished;
} 
```

我在这里看到的唯一问题是您打算如何处理未按时完成的线程。理论上你可以调用`Thread.Abort()`，但这不是一个好主意，因为它会破坏应用程序的状态。

**编辑**：您需要了解`threadFinished.WaitOne(timeout);`仍然阻塞，但不再阻塞`timeout`。

# python - Numpy 数组切片与 for 循环结果

> ID：15317470
> 
> 赞同：2
> 
> 时间：2013-03-10T00:18:57.070
> 
> 标签：python, arrays, numpy, slice

考虑一个由不同密度的壳组成的球体。
我有两个数组，一个用于每个壳的外半径 ( `rad[]`)，一个用于每个壳的密度 ( `den[]`)。我想计算质量，直到给定的半径，称为`mass[]`。

以下 for 循环方法通过首先找到最内层壳的质量（内半径为零，因此它是一个球体），然后将每个后续壳的质量 - 添加到前一个（总和）质量来实现所需的结果：

```
mass = numpy.zeros(len(rad))                                   # create array
mass[0] = den[0]**(rad[0]**3)                                  # find inner sphere mass
for i in range(1,len(mass)):
    mass[i] = mass[i-1] + den[i]*(rad[i]**3 - rad[i-1]**3)     # Find mass out to shell i 
```

注意：我只需要缩放，所以我不担心 pi 的因素。

谁能解释为什么下面的切片结果**没有**达到相同的结果？

```
mass = numpy.zeros(len(rad))
mass[0]  = den[0]*(rad[0]**3)
mass[1:] = mass[0:-1] + den[1:]*(rad[1:]**3-rad[0:-1]**3) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:28:27.483

原因是 numpy 数组中的所有元素将同时计算。第二行中的数组`mass[0:-1]`将被评估为`den[0]*(rad[0]**3)`后跟零。*（计算线*`mass[1]`后将不再为零的事实无关紧要 - 到那时为时已晚）。

 *你注意到这个例子：

```
test = numpy.linspace(1,10,num=10)
test[1:] += test[0:-1]
# [  1\.   3\.   6\.  10\.  15\.  21\.  28\.  36\.  45\.  55.] 
```

工作方式不同，就好像添加确实是迭代发生的。您的示例中的不同之处在于在右侧添加了一个值 - 该添加使其成为内存中的新数组（`x + y`与 不同的数组`x`），因此`numpy`不再将其视为添加到自身。看这个例子

```
test = numpy.linspace(1,10,num=10)
test[1:] += test[0:-1] + 0
# [  1\.   3\.   5\.   7\.   9\.  11\.  13\.  15\.  17\.  19.] 
```

如果你想做一个矢量化版本的 for 循环，你可以这样做：

```
mass[1:] += den[1:]*(rad[1:]**3-rad[0:-1]**3)
mass[1:] += mass[0:-1] 
```*

# c# - Entity Framework 5 Code First 到现有 Informix 数据库

> ID：15317471
> 
> 赞同：2
> 
> 时间：2013-03-10T00:18:57.107
> 
> 标签：c#, entity-framework, entity-framework-5, informix

我在让实体框架 5 与 Informix 一起工作时遇到了很多麻烦。寻找我能得到的任何帮助。我遵循以下程序：

1.  安装了客户端SDK（由于与InstallAnywhere安装程序和Windows 8明显不兼容，我无法安装clientsdk.3.70.FC7DE，在同事的推荐下我安装了clientsdk.3.50.FC9）
2.  通过 ODBC 验证与数据库的连接
3.  使用 testconn40.exe 工具验证了连接性。
4.  添加了以下连接字符串：

    ```
    <add name="OpenNet"
        connectionString="Database=*****;
          Server=*****:40411;User ID=*****;Password=******;Persist Security
          Info=True;Authentication=Server;" providerName="IBM.Data.Informix"/> 
    ```

当我尝试查询数据库时，我收到带有以下消息的 System.Data.ProviderIncompatibleException：*“在‘IBM.Data.Informix.IfxFactory’类型的商店提供者实例上调用‘GetService’方法后返回了空值。商店提供商可能无法正常运行。”*

我反编译了 IBM.Data.Informix.IfxFactory 并发现以下内容：

```
Type type = Type.GetType("IBM.Data.Informix.Entity.IfxProviderServices,  
                 IBM.Data.Informix.Entity, Version=9.7.4.4, 
                 Culture=neutral, PublicKeyToken=7c307b91aa13d208", false); 
```

我在任何地方都找不到*IBM.Data.Informix.Entity*的程序集。也许它包含在我可以安装的后来的clientsdk.3.70.FC7DE版本中。谁能告诉我这是否可行，或者我是否在某个时候走错了路？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T17:25:32.237

目前，获得对 IBM 数据库服务器的 Entity Framework 支持的唯一方法是使用**IBM DB2 实体提供程序**。IBM DB2 实体提供者可以连接到 DB2 和 Informix 服务器。

IBM DB2 实体提供程序是 IBM 数据服务器驱动程序包的一部分。IBM Informix Client SDK 还将 IBM Data Server Driver 包捆绑为可选安装模块。请使用名称空间 IBM.Data.DB2 而不是 IBM.Data.Informix。

仅供参考：IBM DB2 Provider 使用 DRDA 协议；因此它无法连接到 Informix 服务器的本机 (SQLI) 端口。请在 Informix 服务器上启用 DRDA 协议并在连接中指定该端口号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T04:54:06.227

您指向的 URL 是旧版本，来自相对较新版本的文档将更新有关原因代码 7 的信息。 [http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm .db2.luw.messages.sql.doc/doc/msql01159n.html](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.db2.luw.messages.sql.doc/doc/msql01159n.html)

此错误的**原因代码 7**与“**注册表项错误**”有关。即使是这些信息也没有给我提供太多帮助的线索；但它会为 DB2 DS 驱动程序开发团队成员提供线索。我会将这个论坛发帖信息传递给 DB2 DS 驱动程序开发团队；以便他们可以帮助您解决问题。

很可能错误**SQL1159N**将通过重新安装 DS 驱动程序包得到解决，您也可以尝试。

这是 DB2 .NET 的 FAQ URL。 [http://www.ibm.com/developerworks/wikis/display/DB2/DB2%20and%20.NET%20FAQs](http://www.ibm.com/developerworks/wikis/display/DB2/DB2%20and%20.NET%20FAQs)

# php - php正则表达式转义特殊字符

> ID：15317473
> 
> 赞同：8
> 
> 时间：2013-03-10T00:19:17.007
> 
> 标签：php, regex

我编写了以下代码（是的，它确实有效）并且想知道为什么我不需要转义模式中的“<”和“>”字符，因为它们被 php 手册视为“特殊”字符。

[http://www.php.net/manual/en/function.preg-quote.php](http://www.php.net/manual/en/function.preg-quote.php)

```
var_dump(preg_match('/<[A-Za-z][A-Za-z0-9]*>/', "<html>", $matches));

echo "<pre>";
var_dump(htmlentities($matches[0]));
echo "</pre>"; 
```

输出：

```
int(1) 
string(12) "<html>" 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-10T00:26:40.767

[在 PHP 正则表达式匹配/替换中，只有此页面](http://www.php.net/manual/en/regexp.reference.meta.php)上列出的字符需要转义。

虽然`<`and`>`可以充当[delimiter](http://www.php.net/manual/en/regexp.reference.delimiters.php)，但在给定示例中不需要对其进行转义，因为您已经将`/`(slash) 作为[delimiter](http://www.php.net/manual/en/regexp.reference.delimiters.php)。

参考有问题的链接

> 该**[`preg_quote()`](http://www.php.net/manual/en/function.preg-quote.php)**函数可用于转义字符串以注入模式，其可选的第二个参数可用于指定要转义的分隔符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-10T00:25:24.563

`<`并且`>`不是元字符是大多数上下文。

然而，它们被用于：

*   命名捕获组`(?P<name>)`
*   回溯断言`(?<=...)`

所以这就是为什么要[`preg_quote`](http://php.net/preg_quote)安全并逃脱它们的原因。这可以说是多余的，因为逃避`(`并且`?`就足够了。但这也不痛。

# python - 为什么使用静态方法而不是完全不使用装饰器

> ID：15317478
> 
> 赞同：3
> 
> 时间：2013-03-10T00:19:41.933
> 
> 标签：python, oop, function, static-methods

关于为什么/何时应该使用类方法与静态方法，有几个很好的解释，但是我无法找到何时使用静态方法而不是完全没有装饰的答案。考虑这个

```
class Foo(object):        
    @staticmethod
    def f_static(x):
        print("static version of f, x={0}".format(x))

    def f_standalone(x):
        print("standalone verion of f, x={0}".format(x)) 
```

还有一些输出：

```
>>> F = Foo
>>> f = F()
>>> F.f_static(5)
static version of f, x=5
>>> F.f_standalone(5)
standalone verion of f, x=5
>>> f.f_static(5)
static version of f, x=5
>>> f.f_standalone(5)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: f_standalone() takes 1 positional argument but 2 were given 
```

从我在这里读到的内容来看，使用 staticmethod 的主要原因基本上是将概念上相似的东西放在一起。从上面的示例中，似乎两种解决方案都可以做到这一点。唯一的缺点是您似乎无法从实例调用非静态方法。也许我太习惯其他编程语言了，但这并没有让我很困扰；我可以从 Python 中的实例中调用类级别的东西总是令人惊讶。

那么，这基本上是两者之间的唯一区别吗？还是我错过了其他好处？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:28:05.057

您似乎正在使用 python 3。在 python 2 中：

```
In [1]: class Foo(object):
   ...:     def f_standalone(x):
   ...:         print("standalone version of f, x={}".format(x))
   ...:

In [2]: Foo.f_standalone(12)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-2d315c006153> in <module>()
----> 1 Foo.f_standalone(12)

TypeError: unbound method f_standalone() must be called with Foo instance as first argument (got int instance instead) 
```

在 python 3 中，您错过了另一个奇怪的用例：

```
In [1]: class Foo(object):
   ...:     def f_standalone(x):
   ...:         print("standalone version of f, x={}".format(x))
   ...:     @staticmethod
   ...:     def f_static(x):
   ...:         print("static version of f, x={}".format(x))
   ...:

In [2]: Foo().f_standalone()
standalone version of f, x=<__main__.Foo object at 0x1064daa10>

In [3]: Foo().f_static()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-addf9c3f2477> in <module>()
----> 1 Foo().f_static()

TypeError: f_static() missing 1 required positional argument: 'x' 
```

# c++ - 最大堆中第三个最小元素的索引

> ID：15317480
> 
> 赞同：3
> 
> 时间：2013-03-10T00:20:02.823
> 
> 标签：c++, algorithm, sorting, heapsort

如何在 1 到 n 个不同元素的最大堆中找到第三个最小元素的可能索引？我知道最小的元素会在叶子的任何地方。当 n 大于 3 时，第二小将在 n/2 到 n 之间，但我不知道要计算第三小。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T03:17:40.600

第三小的元素最多有两个后代，这意味着它的孩子（ren）是叶子，或者它是叶子。（为了证明这一点，你还必须证明只有一个孩子的元素不可能有一个非叶子作为孩子。简单但乏味。）

正如您几乎注意到的那样，叶子的索引范围为`[floor(n/2)+1, n]`。如果`n/2`是整数，则该元素只有一个子元素（即叶子），因此添加它会给出可能包含第二大元素的索引范围。

第一个孩子在叶子范围内的元素`[floor(n/2)+1,n]`最多有两个孩子，并且没有非叶子孩子。该范围与 [ceil(n/2),n] 范围连续，两个范围的并集提供了第三大元素的所有可能位置。

at 元素的第一个子元素`i`具有索引`2i`，因此第一个子元素至少为 的第一个元素`floor(n/2)+1`是`floor(n/4)+1`。

因此，您可以找到第三大元素的可能索引是 range: `[floor(n/4)+1,n]`。

* * *

这是另一种方法。在 index 处取一些元素`i`。它的直系孩子是`2i`and `2i+1`; 它的孙子是`4i, 4i+1, 4i+2, 4i+3`，一般来说，它的后代`k`是；总之，。当然，这些范围是不重叠的（实际上，除非is ，它们甚至都不连续）。所以如果在一个层次上至少有一个后代，那么它也有一套完整的后代，其中有。`2^ki, 2^ki+1, ..., 2^ki + 2^ki-1``[2^ki, ..., 2^k(i+1)-1 ]``i``1``i``k``k' < k``2^k-2`

综上所述，我们可以得出结论：

*   如果，则有：`n ≥ 2^ki and n < 2^k(i+1)``i`

    *   `2^ki-2`某个级别的后代小于`k`
    *   `n - 2^ki+1`级别的后代`k`；

    *   总：`n-1`子孙。

*   如果，则有：`n ≥ 2^k(i+1) and n < 2^(k+1)i``i`

    *   正是后代。`2^(k+1)-1`

粗略地说，这意味着在堆底层数组的第一部分中找不到最后一个元素。`2^k``1/2^k`

# jenkins - Cloudbees Jenkins 仪表板定制

> ID：15317481
> 
> 赞同：0
> 
> 时间：2013-03-10T00:20:04.390
> 
> 标签：jenkins, dashboard, cloudbees

我想知道如何在 Cloudbees 下自定义 Jenkins 的仪表板。在构建执行中，我生成了不同的报告（PMD、Cobertura 等），但我不知道如何在仪表板中添加/发布这些报告。

查看 Jenkins Wiki 我发现[了这个主题](https://wiki.jenkins-ci.org/display/JENKINS/Dashboard+View)。它说：

> 在创建新视图页面上，为您的视图命名并选择仪表板类型

问题是没有任何“仪表板类型”，只有以下选项可用：

*   Groovy 脚本视图
*   列表显示
*   我的观点

并且这些选项都不允许添加报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T02:23:45.680

“免费”和“基础”云计划仅提供必要的 jenkins 插件。请参考：[https](https://grandcentral.cloudbees.com/services/plans/dev) ://grandcentral.cloudbees.com/services/plans/dev 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T17:35:51.890

请尝试使用“列表视图”。您可以使用 /configure 页面将此设置为默认视图。

# php - 这个 PHP 函数会提供足够的数据散列吗？

> ID：15317483
> 
> 赞同：0
> 
> 时间：2013-03-10T00:20:19.063
> 
> 标签：php, hash, base64

我得到了一个大约 2 年前写的函数。该函数使用 base64 编码方法以及 sha1 哈希和一堆预定义值。这是功能

```
 function secure_encode($x) { 
         return strtr(base64_encode(substr($_SESSION['Cksum'],rand(0,28),4) . $x), '+/=', '-_+');
     }

     $express = array();

     $express['0'] = "58464db46ba2ea0f54.8030317175114db46ba2ea1004.65676456123564db46ba2ea10b2.4389053856-5caecd9b6220eaea81e40641caad165ad681d49c-Bh8j1kU.kAIznsh5WhHH-XO5FJFGU6cMySblUAKkpdg==/".date();

     $express['1'] = "113354db46791181958.25326465113804db46791181a07.35447338301094db46791181ab9.28188138-c5438adfef452a06fffd8a1e755322796122620d-O1dnRG.KafUv8.JcISrn-Nhab7EDL.2lkQ68WfT1Pzg==/";

     $express['2'] = "299084db46ac385b7d9.3958582716614db46ac385ba68.3911624024184db46ac385bee5.3681503764-b249050b2cc8ec9a9a24e6775fd6d679982ce35e-E7rS6jrbjYdHptZPAe4v-WNwjOR1HEEMJURn/RUN.AA==/";

     $express['3'] = "233534db46ae7c7a2d7.98941083259824db46ae7c7a390.88346488191674db46ae7c7a449.03466538-08741422c3f59599e4c170ed4871e387a921268f-L/pA2jYJ/mEjZmyjHWt5-fVSwQyCRfxsR8lCmQkw2aw==/";

     $express['4'] = "107034db46b02569962.3398546439324db46b02569a26.08097334169974db46b02569ad1.521504520-e141a88ba3299debc3abc9a04d5953a7604df28e-JGkKsXa19ZEPuasSZLC5-B8oD3S68DPUL3zrZTjELZg==/";

     $pass = $_POST['auth_pass'];
     $hash = secure_encode((sha1($express['0']."//!%$!*&^@n3.".$pass).sha1($express['2']."//!%$!*&^@n3.".$pass))); 
```

例如散列值：**123abc**将返回

> NjY1NGI0ZTIzMTc5NmViNGU5MjhiMDgyZmUyMDYwNDAzYWQzM2NjYTJmZTYzYjk2ZTg3MzVkMTRmMTc2MjI0NjdkMjY2ZDg0MjAyMGY1ZTc+

根据代码片段，这种散列是否足以散列基本用户数据，如名字/姓氏、电话号码、地址和出生日期，还是使用其他形式的散列更好？此外，如果可以改进片段，请指出可以使其更好的部分。

**编辑：**我目前使用此功能在我制作的论坛软件上散列用户密码。而且我从来没有遇到过用户帐户被破坏或密码被盗的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T00:30:34.290

你所做的被称为通过默默无闻的安全。仅仅因为有人不知道你的算法并不能保证它的安全。如果有人闯入您的网站并查看您的散列函数，您的“自定义”散列将很容易受到攻击，因为您所做的只是对加盐 SHA1 散列进行 base64 编码。

不要编写自己的函数。[使用像Bcrypt](http://www.openwall.com/articles/PHP-Users-Passwords)这样的可信散列函数，这些函数的攻击成本很高。

此外，请务必阅读[本文](http://crackstation.net/hashing-security.htm)以获得更深入的解释。

# java - 使用 android 的 2D 数组在 gridview 中动态显示文本

> ID：15317485
> 
> 赞同：1
> 
> 时间：2013-03-10T00:20:30.017
> 
> 标签：java, android, android-gridview

我目前在滚动视图中有一个网格视图，我想在其中显示来自网格视图内的二维数组的信息并使其可滚动。我为 gridView 创建了一个适配器来处理这项工作，因为我想稍后将它用于其他布局。我遇到的问题是只有数组的第一行和第二行的一部分显示在网格视图中。这是我创建的适配器的代码，我觉得问题出在其中的某个地方：

```
public class GridViewAdapter extends BaseAdapter
{
    private Context context;
    String[][] gridContent;
    int rowPosition, columnPosition, count;

    /**
     * 
     */
    public GridViewAdapter(Context c, String[][] content) 
    {
        // TODO Auto-generated constructor stub
        context = c;
        count = 0;
        gridContent = new String[content.length][content[0].length];
        for (int i = 0; i < gridContent.length; i++)
        {
            for (int j = 0; j < gridContent[i].length; j++)
            {
                gridContent[i][j] = content[i][j];
                count++;
            }
        }
        rowPosition = 0;
        columnPosition = 0;
    }

    public int getCount()
    {
        return count;
    }

    public int getRowCount()
    {
        return gridContent.length;
    }

    public int getColumnCount()
    {
        return gridContent[0].length;
    }

    public Object getItem(int rowNum, int columnNum)
    {
        return gridContent[rowNum][columnNum];
    }

    public View getView(int position, View view, ViewGroup group)
    {
        TextView textView;
        if (view == null)
        {
            textView = new TextView(context);
            //textView.setPadding(8, 8, 8, 8);
        }
        else
        {
            textView = (TextView) view;
        }
        columnPosition = position % gridContent[0].length;
        rowPosition = (position - columnPosition)/gridContent[0].length;
        textView.setText(gridContent[rowPosition][columnPosition]);
        //textView.setTextColor(000000);
        //textView.setTextSize(13);     

        return textView;
    }

    public Object getItem(int position) 
    {
        return null;
    }

    public long getItemId(int position) 
    {
        return 0;
    }

} 
```

任何帮助将不胜感激。谢谢你

我不明白为什么它在第一行和第二行的一部分工作得很好，但后来它被切断了。这是我的滚动视图和网格视图的 xml 代码：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/verticalScrollView"
        android:layout_width="fill_parent"
        android:layout_height="400dp"
        android:overScrollMode="always"
        android:isScrollContainer="true"
        android:scrollbarAlwaysDrawVerticalTrack="true"
        android:scrollbars="vertical"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/networkResults" >

        <GridView
            android:id="@+id/scheduleGrid"
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:gravity="left"
            android:horizontalSpacing="10dp"
            android:isScrollContainer="true"
            android:numColumns="5"
            android:stretchMode="columnWidth"
            android:verticalSpacing="10dp" >

        </GridView>
    </ScrollView> 
```

# t4 - T4 TextTemplatingFilePreprocessor .tt 在运行时的位置

> ID：15317489
> 
> 赞同：0
> 
> 时间：2013-03-10T00:21:22.637
> 
> 标签：t4

我正在编写一个应用程序来处理客户端机器（VS 之外）上的 T4 文件。理想情况下，我想将 .tt 文件嵌入到 dll 中。

我尝试将 Build Action 设置为 Resource，但我注意到预处理的 .cs 文件仍然包含对 .tt 文件的硬编码目录引用。

分发 .tt 文件并在运行时引用它的正确方法是什么？

为了确保我清楚，我希望能够将文件嵌入到 dll 中并作为资源访问，或者在运行时从相对于程序集路径的位置加载文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T08:13:38.840

您不需要分发 .tt 文件本身。使用 .tt 文件需要两个步骤：

1.  模板引擎将模板转换为一些可编译和可运行的代码类。
2.  此代码类运行并生成输出代码

该引擎不是 Visual Studio 的可再分发部分，因此，当您想要分发 t4 模板时，您需要使用预处理模板。这样，第 1 步中生成的代码类将呈现到 t4 模板的 .cs 文件中，并与您的程序集一起编译和交付。

当使用t4模板编写C#代码时可能会感到困惑，因为步骤1的代码类也是一个C#类（当然在ac#项目中）并且包含许多实际构建的.Write()方法调用了所需的输出代码。

预处理模板包含以 #line 开头的行，后跟 T4 模板文件的本地和绝对路径。这些行用于调试目的，当模板引擎在步骤 1 中发现错误时，允许 Visual Studio 在 .tt 文件中显示正确的行。

# gwt - 在 UIBinder 的特定 div 元素中创建 DockPanel

> ID：15317491
> 
> 赞同：0
> 
> 时间：2013-03-10T00:21:30.343
> 
> 标签：gwt

是否可以将 Panel 添加到 GWT 中的 html 元素？

我已经检查过了，它不包含 wrap 或 setElement 方法。我还尝试检查源代码，它没有以 Element 作为输入的构造函数。构造函数确实调用了 getTable() 方法，该方法返回一个表格元素，但我不知道在哪里以及如何设置它。

有任何想法吗？

=============== 编辑==================

通过查看源代码，似乎无法做到这一点。DockPanel 继承自 cellPanel，这是在构造函数中所做的。

```
 /**
   * Creates an empty dock panel.
   */
  public DockPanel() {
    DOM.setElementPropertyInt(getTable(), "cellSpacing", 0);
    DOM.setElementPropertyInt(getTable(), "cellPadding", 0);
  }

 public CellPanel() {
    table = DOM.createTable();
    body = DOM.createTBody();
    DOM.appendChild(table, body);
    setElement(table);
  }

  /**
   * Creates an empty dock panel.
   *
   * @param unit the unit to be used for layout
   */
  public DockLayoutPanel(Unit unit) {
    this.unit = unit;

    setElement(Document.get().createDivElement());
    layout = new Layout(getElement()); // private
    layoutCmd = new DockAnimateCommand(layout); // private
  } 
```

==================== 编辑2 ===========================

鉴于：

HTML

```
<html>
<body>
   <table id="dockLayoutPanel">
   </table>
</body>
</html> 
```

JAVA/JS

```
 TableElement tEle = DOM.getElementById("dockLayoutPanel");
   DockPanel panel = new DockPanel(tEle);
   // and then use the panel as usual. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T09:44:36.937

如果您正在寻找如何将 gwt 小部件添加到特定的 html 元素，那么这里是示例。

让我们考虑你想添加一个`AbsolutePanel`到 HTML div，id***为 myPanel***：然后你可以通过这样的实现来实现它：

```
AbsolutePanel aPanel = new AbsolutePAnel();
Rootpanel.get("myPanel").add(aPanel); 
```

希望这会帮助你。

# php - PHP Array 语法及操作说明

> ID：15317493
> 
> 赞同：2
> 
> 时间：2013-03-10T00:21:50.977
> 
> 标签：php, arrays

我必须将函数从 PHP 转换为 Java，并且可以对 PHP 的数组语法进行一些澄清，这与 Java 有一些不同。PHP代码是

```
$W; //array defined before and has values
$S = array();
$j = wsnum - 1; //integer value here

for ( ;  ; ){
  $S[] = $j
  $S[] = $W[$j]; 

} 
```

我对这个片段的解释是

1.  `$S`初始化为长度为 0 的数组
2.  `$j`被推到`$S[0]`
3.  的内容`$W[$j]`被推送到`$S[1]`

我的解释是正确的，还是我叫错了树？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:23:13.263

你的解释是完全正确的。

您可以查看[这篇文章](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)以了解有关 php 运算符的更多信息。

`[]`运算符是“推”运算符。它总是将分配的值放在给定数组的末尾。

# twitter-bootstrap - 如何使用 Twitter Bootstrap 将导航栏置于顶部？

> ID：15317499
> 
> 赞同：2
> 
> 时间：2013-03-10T00:22:32.617
> 
> 标签：twitter-bootstrap

我有一个导航栏，在加载时从页面顶部开始大约 50 像素。当我向下滚动时，我希望导航栏将自己“固定”到页面的最顶部，并且在我滚动浏览其余内容时可见。这类似于官方引导教程 Github 站点上的导航栏。
通过使用

```
<ul class = "nav nav-list bs-docs-sidenav affix"> 
```

但是一旦我在上面添加“-top”，它看起来像

```
<ul class = "nav nav-list bs-docs-sidenav affix-top"> 
```

当我向下滚动页面时，导航栏不再保持原位并从视图中消失。

[没有“-top”的jsfiddle](http://jsfiddle.net/t7Njg/)

[带有“-top”的jsfiddle](http://jsfiddle.net/sF4eE/)

当我向下滚动时，如何将导航栏粘贴到页面顶部？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-10T08:06:01.427

有几件事需要纠正。请参阅固定[的 jsfiddle](http://jsfiddle.net/sF4eE/2/)。

1.  Affix 在 Bootstrap 中实现为使用 jQuery 的 JavaScript 代码，并且您既不包括 BS 的 JS 也不包括 jQuery
2.  要为元素打开词缀，根据[官方文档](http://twitter.github.com/bootstrap/javascript.html#affix)，使用`data-spy="affix"`，而不是`class="affix"`. 你为什么这么做？类`affix`和`affix-top`服务于不同的目的——它们告诉你词缀当时的状态。如果此时您的元素是固定的，则类是`affix`，如果它是可滚动的，则 BS 将类更改为`affix-top`.
3.  您必须告诉 BS 何时需要修复该元素。以像素为单位的距离（您必须滚动多少）由属性设置`data-offset-top`。还要在 CSS 中指定导航固定后的外观。如果它被绑定到顶部（窗口边框和元素之间没有空间），那么`.affix { top:0; }`就会这样做。

# javascript - 加速单页应用程序 (SPA) 中的渲染

> ID：15317508
> 
> 赞同：1
> 
> 时间：2013-03-10T00:23:08.870
> 
> 标签：javascript, asp.net-mvc, json, rendering

因此，我正在开发一个应用程序，该应用程序在后端使用 Web 服务来发送 JSON 有效负载，然后通过专有的 Javascript MVC 框架在客户端呈现。

在我们的特定应用程序中，我们有一个多页表单向导。所有页面都是可定制的，因此我们必须发送所有布局信息以及填充它的数据。模板存储在 html 中，然后在客户端从 DOM 中删除并缓存以供重复使用。

这里与我通常看到的不同的是，整个表单的所有数据都在单个 Ajax 调用中加载，然后在应用程序响应之前呈现所有内容。这可能需要（取决于设置的大小）5、10、20 秒。

加载表单后，一切都很快并且运行良好。您无需等待一次即可完成整个过程。然后，当您完成并提交时，ajax 调用也可能需要 10-20 秒才能返回并显示确认。这是因为我们在进行过程中并没有真正向服务器发送任何内容，而是在最后保存了所有内容。

回顾一下：

获取巨大的 JSON 有效负载（等待）> 渲染所有内容（等待）> 用户完成表单（所有客户端）> 用户提交整个表单（等待）> 确认页面

大部分时间都花在第 2 步渲染所有内容上。

我加快速度的想法有以下几点：

1）分解ajax调用。而不是获取整个表单，而是对每个页面进行 ajax 调用，将它们全部发送出去并开始在其回调方法中呈现该页面。

2）目前一切都在客户端呈现，我正在考虑如何在我们等待数据时在服务器上预呈现一些页面（在单独的线程中？）。

作为参考，我们在 ASP.NET 环境中，后端的 ASMX Web 服务和客户端的内部框架，我们确实有可用的 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:25:20.077

我建议做的是让每个“页面”分开。当您必须获取整个页面时，我将只返回第一页，其中可能包含指向下一页的链接。所以你的 json 响应可能是这样的：

```
{
    "layout":{
        // layout information
    },
    "data": {
        // info to render
    },
    "next_page" : "link/to/next/page"
} 
```

现在，当它返回时，渲染第一个页面（可能使用 web 工作，我将在稍后讨论），并启动对“next_page”的 AJAX 调用。对每一页重复这个过程，直到没有提供“next_page”（即，它的最后一页）。

这将允许在用户完成每个页面的同时呈现后续页面。

**网络工作者**（HTML5 功能）

Web Worker 允许使用 javascript 线程，这可以让您在后台进行渲染，而不会干扰 UI 循环。为了让你开始，你可以看看这个[介绍](http://www.html5rocks.com/en/tutorials/workers/basics/)。

请注意，我个人没有将 Web Worker 用于任何事情，但您应该能够将它们用于大型渲染任务。如果您选择这样做，请记住您必须为尚不支持它们的浏览器提供某种回退。

# php - 存储和显示最近访问过另一个人页面的人的最高效的数据库方法是什么？

> ID：15317512
> 
> 赞同：2
> 
> 时间：2013-03-10T00:23:48.993
> 
> 标签：php, mysql, sql

我有一个博客程序（类似于 Twitter），我目前正在制作一个最近访问过的框，其中包含最近访问过您页面的 9 个人。

每个人都使用不同的用户名注册。

我目前拥有的是这样的数据库：

```
-----------------------------
| id | username | who_visit |
----------------------------- 
```

例如，如果有 9 个用户`foo1`访问`foo9`了`foo10`的页面，则数据库将填充一行：

```
------------------------------------------------------------------------
| id | username |                       who_visit                      |
------------------------------------------------------------------------
| 1  |  foo10   | foo1, foo2, foo3, foo4, foo5, foo6, foo7, foo8, foo9 |
------------------------------------------------------------------------ 
```

然后当`foo11`访问`foo10`的页面时，我会`foo9`从字符串的末尾删除，并添加`foo11`到前面。

但是现在的主要问题是，如果`foo1`访问过`foo10`的页面，然后`foo2`访问过`foo10`的页面，然后再次`foo1`访问过`foo10`的页面怎么办？然后我必须搜索 9 个用户，删除所有重复项，将这个放在前面，然后继续执行。但问题是，它只会显示 8 行。

我能想到的解决这个问题的唯一方法是制作一个这样的数据库：

```
-----------------------------
| id | username | who_visit |
----------------------------- 
```

而不是将它们填充在一行中，我会为每次访问添加一个新行：

```
-----------------------------
| id | username | who_visit |
-----------------------------
| 1  |  foo10   |    foo1   |
-----------------------------
| 2  |  foo10   |    foo2   |
-----------------------------
| 3  |  foo10   |    foo3   |
-----------------------------
| 4  |  foo10   |    foo4   |
-----------------------------
| 5  |  foo10   |    foo5   |
-----------------------------
| 6  |  foo10   |    foo6   |
-----------------------------
| 7  |  foo10   |    foo7   |
-----------------------------
| 8  |  foo10   |    foo8   |
-----------------------------
| 9  |  foo10   |    foo9   |
----------------------------- 
```

但这会占用大量不必要的空间。

有没有我错过的方法，它可以有效地解决这个问题，而无需为数据库中的一个用户添加 > 50000 行？

**更新：**对于那些有同样问题的人，正如下面评论中的 PM 77-1 所述，可以在插入新行时删除最早的重复行。这样，您就不会得到“数据膨胀”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:27:22.187

你的第二种方法是最好的。当我第一次开始在我的应用程序中实现数据库时，我尝试了你的第一种方法。当您想要扩展或更改数据集的处理方式时，它会产生问题。

如果索引正确，您应该可以快速排序这些数据。

您仍想从 whovisit 表中删除最旧的行。这将阻止您的 50k 条目。理论上，每个用户的 whovisit 表中只保留 9 条记录。所以你的实际表大小是 9*Number_of_users

表一用户

```
id   |  username
-----|-----------
1    |  foo1
2    |  foo2 
```

表二 whovisit

```
id   |  user(id) | visited(userId) | Date/time stamp
-----|-----------------------------|----------------
1    |  1        |  2              | 9999-12-31 23:59:59 
```

当您插入新访问的查询时，用户 id 并获得行数。如果小于 9 则罚款，如果大于 9，则删除最旧的一个，总共为用户留下 9 行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:35:18.570

添加每次访问的日期/时间戳似乎会有所帮助。

如果你这样做，逻辑可能是这样的：

*   用户已经在列表中 - 用当前日期/时间更新最早的时间/戳
*   用户尚未在列表中 - 查找总体最早访问并使用此用户的信息更新记录

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:33:31.863

我建议使用两个表：

桌子`users`

```
id | name
1  | foo1
2  | foo2
3  | foo3
4  | foo4   
  ...
10 | foo10 
```

桌子`visits`

```
host_userid | visitor_userid
    10      |     1
    10      |     2
    10      |     3
    10      |     4 
```

如有必要，该`visits`表还可能具有日期列或主键。仅存储两个整数将导致非常小的行大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-10T00:35:48.423

你的想法被称为**规范化**，实际上是一个好主意。

表**用户**：

```
-----------------
| id | name     |
-----------------
| 1  | foo1     |
-----------------
| 2  | foo2     |
-----------------
| 3  | foo3     |
----------------- 
```

餐桌**参观**：

```
-----------------------------
| id | user_id  | visit_id  |
-----------------------------
| 1  |    1     |    2      |
-----------------------------
| 2  |    2     |    3      |
----------------------------- 
```

现在您可以轻松快速地存储和检索访问数据。如果你把它放在一个领域（就像你的第一个例子），你最终会陷入程序员的地狱。

您可以在表访问中包含时间戳并删除早于 x 天的条目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-10T00:36:09.040

改用关系表...由于显而易见的原因，不建议在您的用户表中创建多个 ID...

例如：

`Users`桌子

[ `UserID`] `[UserName`]

`Visits`桌子

[ `Source_User_ID`][ `Visitor_User_ID]`[ `Visit_Count`]

然后，您的 SQL 语句变得非常简单：

```
SELECT TOP 9 [Visitor_User_ID] WHERE [Source_User_ID]=### ORDER BY [Visit_Count] DESC 
```

# twitter-bootstrap - 用于引导的最佳服务器端框架

> ID：15317517
> 
> 赞同：-1
> 
> 时间：2013-03-10T00:24:21.273
> 
> 标签：twitter-bootstrap

我对 bootstrap 非常感兴趣，想知道是否真的可以与服务器端技术（即带有特定框架的 Rails 或 Php）完美匹配，以创建数据驱动的网站。

这可能是主观的，*但是*关于这方面的信息很少，

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:34:03.827

对于 Twitter Bootstrap，没有什么比得上“最好的服务器端框架”了。您可以将它与您喜欢的任何框架一起使用。我更喜欢使用 Ruby on Rails。在 Rails 中使用 twitter bootstrap 有很多技巧，例如[https://github.com/thomas-mcdonald/bootstrap-sass](https://github.com/thomas-mcdonald/bootstrap-sass) (SASS) 或[https://github.com/seyhunak/twitter-bootstrap-rails](https://github.com/seyhunak/twitter-bootstrap-rails) (LESS)。

我还使用[https://github.com/plataformatec/simple_form](https://github.com/plataformatec/simple_form)生成表单，当涉及到呈现验证错误时，该表单与 Twitter Bootstrap 配合得非常好。

还有一个关于如何在 Ruby on Rails 上使用 Twitter Bootstrap 的免费 railscast：[http ://railscasts.com/episodes/328-twitter-bootstrap-basics](http://railscasts.com/episodes/328-twitter-bootstrap-basics)

# java - Java中类的可见性

> ID：15317518
> 
> 赞同：-8
> 
> 时间：2013-03-10T00:24:27.287
> 
> 标签：java, visibility

如何在java中定义**低可见性**和**高可见性**..？？这将是低能见度的私人或公共

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:25:04.250

低能见度 = `private`. 高能见度 = `public`. 中间还有两个可见性。从高到低的能见度：

```
public > protected > "default" > private 
```

“默认”没有关联的关键字，它是在没有明确声明可见性时应用的可见性。这是[文档](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)中的相关链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T00:35:10.947

这基本上归结为英语单词“可见”的含义。Visible的意思是“你能看到”，而“高能见度”是指比“低能见度”能*看到的更多。*

由此可见，'private' 比'public' 更不明显......即使你不理解 Java 中的含义`private`和`public`含义。

如果您再阅读[访问控制](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)的 Java 教程页面，您会发现 Java 定义访问控制规则的方式，以及它使用术语“可见性”的方式都与相应英文单词的直观含义一致。

# java - Android MediaRecorder 属性

> ID：15317520
> 
> 赞同：3
> 
> 时间：2013-03-10T00:24:39.167
> 
> 标签：java, android, video, android-mediarecorder

我正在尝试在使用 MediaRecorder 时减小视频文件的大小，因为我将通过网络传输视频。

这是我所拥有的

```
private boolean prepareMediaRecorder(){
        myCamera = getCameraInstance();
        mediaRecorder = new MediaRecorder();

        myCamera.unlock();
        mediaRecorder.setCamera(myCamera);

        mediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
        mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

        mediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_LOW));       
        mediaRecorder.setOutputFile("/sdcard/myvideo.mp4");
        mediaRecorder.setMaxDuration(60000); // Set max duration 60 sec.
        mediaRecorder.setMaxFileSize(5000000); // Set max file size 5M

        mediaRecorder.setPreviewDisplay(myCameraSurfaceView.getHolder().getSurface());

        try {
            mediaRecorder.prepare();
        } catch (IllegalStateException e) {
            releaseMediaRecorder();
            return false;
        } catch (IOException e) {
            releaseMediaRecorder();
            return false;
        }
        return true;

    } 
```

CamcorderProfile.QUALITY_LOW 代码行似乎有很大的不同，但我所做的其他任何事情都没有任何影响。我尝试使用 setVideoFrameRate 和 setCaptureRate 降低帧速率都没有影响（不确定两者之间的区别）。我试图通过注释掉 setAudioSource 行来禁用音频源（我不需要音频），但这会引发错误，提示“E/MediaRecorder(7934)：尝试设置音频编码器而不先设置音频源”。文档说“如果不调用此方法，则输出文件将不包含音轨”。

我应该设置哪些参数以使文件大小尽可能小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T20:48:51.627

弄清楚了。代码行...

```
mediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_LOW)); 
```

设置输出格式和视频编码器以及音频。删除该行代码并将视频编码器和输出格式设置为禁用音频（只需将音频内容保留）。这使您可以大大减少文件大小。

# ruby-on-rails - 无法运行 Rails 服务器

> ID：15317524
> 
> 赞同：1
> 
> 时间：2013-03-10T00:24:57.487
> 
> 标签：ruby-on-rails

当我尝试使用**rails s运行服务器时遇到问题**

我正在使用 Windows，这是回报：

```
C:\Blog\MyBlog>rails s
=> Booting WEBrick
=> Rails 3.2.12 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.5.2/lib/rack/server.rb:353:in `kill': Invalid argument (Errno::EINVAL)
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.5.2/lib/rack/server.rb:353:in `pidfile_process_status'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.5.2/lib/rack/server.rb:340:in `check_pid!'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.5.2/lib/rack/server.rb:246:in `start'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands/server.rb:70:in `start'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:55:in `block in <top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:50:in `tap'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:50:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>'

C:\Blog\MyBlog> 
```

我的宝石文件：

> 来源“ [https://rubygems.org](https://rubygems.org) ”
> 
> ```
> gem 'rails', '3.2.12'
> 
> # Bundle edge Rails instead:
> # gem 'rails', :git => 'git://github.com/rails/rails.git'
> 
> gem 'sqlite3'
> 
> # Gems used only for assets and not required
> # in production environments by default.
> group :assets do
>   gem 'sass-rails',   '~> 3.2.3'
>   gem 'coffee-rails', '~> 3.2.1'
> 
>   # See https://github.com/sstephenson/execjs#readme for more supported runtimes
>   # gem 'therubyracer', :platforms => :ruby
> 
>   gem 'uglifier', '>= 1.0.3'
> end
> 
> gem 'jquery-rails'
> 
> # To use ActiveModel has_secure_password
> # gem 'bcrypt-ruby', '~> 3.0.0'
> 
> # To use Jbuilder templates for JSON
> # gem 'jbuilder'
> 
> # Use unicorn as the app server
> # gem 'unicorn'
> 
> # Deploy with Capistrano
> # gem 'capistrano'
> 
> # To use debugger
> # gem 'debugger' 
> ```

**红宝石**1.9.3p392 (2013-02-22) [i386-mingw32]，**Rails** 3.2.12，**Gem** 1.8.25

***对不起我的英国人***

# 已编辑

我尝试使用 mongrel 但我在 cmd 中得到了下一个：

```
C:\Blog\MyBlog>rails s mongrel
Exiting
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler/mongrel.rb:1:in
`require': cannot load such file -- mongrel (LoadError)
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler/mon
grel.rb:1:in `<top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:
20:in `const_get'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:
20:in `block in get'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:
20:in `each'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:
20:in `inject'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:
20:in `get'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/server.rb:2
72:in `server'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/comma
nds/server.rb:59:in `start'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/comma
nds.rb:55:in `block in <top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/comma
nds.rb:50:in `tap'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/comma
nds.rb:50:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T13:56:02.560

尝试向 tmp/pids/server.pid 文件添加随机编号（例如 6532），然后启动 webricks

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T01:35:41.013

Windows 和 Rails 通常不能像在其他环境中那样工作。使用 Rails 在 Windows 中出现 Webbrick 问题的最佳解决方法是安装另一台服务器进行开发。Mongrel 是一个不错的选择。要安装它：

```
gem install mongrel 
```

然后启动服务器

```
rails s mongrel 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-13T16:12:08.850

我遇到了同样的问题。我发现最简单的解决方法实际上只是删除应用程序文件夹中现有的 pid 文件：

```
del tmp\pids\*.* 
```

参考此资源找到此解决方案：[ [https://github.com/rack/rack/issues/544][1]](https://github.com/rack/rack/issues/544][1])

# msbuild - 是否有必要用“.Test”命名 NUnit 测试 DLL 以与 MSBuild 一起使用

> ID：15317534
> 
> 赞同：0
> 
> 时间：2013-03-10T00:25:46.863
> 
> 标签：msbuild, nunit

在我看到的所有示例中，人们使用 MSBuildCommunityTasks 来运行 NUnit 测试运行每个示例都使用这样的命名约定作为他们的测试 DLL：.Test.dll 而不是：Test.dll

当您无法使用星号开始搜索字符串时，我已经老了并且开始使用 DOS。我知道 MSBuild 使用通配符来查找测试库（CP-M 向后兼容性）。但是，现在在 CMD 提示符下，我可以搜索 *fred.dll 并且它只会返回以 fred.dll 结尾的文件，无论 fred 之前是什么。

我的团队负责人对使用“.”这个句号非常不满。在文件名中，所以我认为值得一问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T05:56:09.213

这不是必须使用句号“.”。您的潜在客户可能坚持使用它的唯一原因可能是他们在整个项目中遵循的某些标准或类似的东西。

除此之外，NUnit 没有这样的规则可以在测试 dll 上工作。

# r - is.null 不适用于 R [可能的错误] 中的 null data.table？

> ID：15317536
> 
> 赞同：4
> 
> 时间：2013-03-10T00:25:55.083
> 
> 标签：r, data.table

我相信这可能是一个错误。如果是这样，我会报告。寻找确认：

```
> is.null(data.table(NULL))
  [1] FALSE 
```

我在常见问题解答中看到以下内容：

> 2.5 NULL data.table 和 DT[0] 一样吗？不，尽管打印方法另有说明。严格来说，is.null(data.table(NULL)) 不可能返回 FALSE。将来可能会重新访问此常见问题解答。

如果这是预期的行为：如何检查对象是否为空？特别`rbindlist`是一个NULL对象返回了一个`NULL data.table`那么如何检查呢？

```
> is.null(rbindlist(NULL))
  [1] FALSE 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T12:15:35.720

我不确定为什么FAQ 是这样表述的。但是，空数据表只是一个空列表：

```
> data.table:::null.data.table
function () 
{
    ans = list()
    setattr(ans, "class", c("data.table", "data.frame"))
    setattr(ans, "row.names", .set_row_names(0L))
    settruelength(ans, 0L)
    alloc.col(ans)
} 
```

这不是`NULL`。来自`?list`：

> 一个空的pairlist，pairlist() 与NULL 相同。这与 list() 不同。

您可以通过查看它的长度是否为 0 ( `length(DT) == 0`) 来检查它。这是`data.table:::print.data.table`决定是打印“NULL data.table”还是“Empty data table (0 rows) ...”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T10:08:53.533

好点子。现在已经改变了输出`data.table(NULL)`。来自 v1.8.9 中的新闻：

> *   `data.table(NULL)`现在打印`"Null data.table (0 rows and 0 cols)"`和常见问题解答 2.5 已得到改进。感谢：[is.null 不适用于 R [可能的错误] 中的 null data.table？](https://stackoverflow.com/questions/15317536/is-null-does-not-work-on-null-data-table-in-r-possible-bug)

FAQ 2.5 现在改为：

> FAQ 2.5 *null data.table 和 DT[0] 一样吗？*
> 不，“null data.table”是指`data.table(NULL)`or的结果`as.data.table(NULL)`；IE，

```
> data.table(NULL)
Null data.table (0 rows and 0 cols)
> as.data.table(NULL)
Null data.table (0 rows and 0 cols)
> data.frame(NULL)
data frame with 0 columns and 0 rows
> as.data.frame(NULL)
data frame with 0 columns and 0 rows 
```

> null附加了一些属性，使其 不再`data.table|frame`存在。在 R 中，只有 pure由测试。当提到“null data.table”时，我们使用小写的 null 来帮助区分大写的 NULL。要测试 null data.table，请使用 or (稍快，因为它是一个原始函数)。一个空的 data.table ( ) 有一个或多个列，所有列都是空的。那些空列仍然有名称和类型：`NULL``NULL``NULL``NULL``is.null()``length(DT)==0``ncol(DT)==0``length``DT[0]`

```
> DT = data.table(a=1:3,b=c(4,5,6),d=c(7L,8L,9L))
> DT[0]
Empty data.table (0 rows) of 3 cols: a,b,d
> sapply(DT[0],class) 
        a         b         d 
"integer" "numeric" "integer" 
```

# c - 从标准输入 c 传入文件时运行 gdb

> ID：15317538
> 
> 赞同：4
> 
> 时间：2013-03-10T00:26:13.883
> 
> 标签：c

所以，当我运行我的程序时，我会

```
./a.out < SampleData 
```

在仍然能够传入 SampleData 文件的同时，我将如何调试我的程序？

谢谢

编辑：我试着做

```
gdb ./a.out
run < SampleData 
```

当我这样做时，它会运行我的程序，输出它通常输出的内容，然后给我留下：

“[Inferior 1 (process 19460) exited with code 03]”

什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T00:29:20.410

您也可以在 gdb 中进行重定向。

```
gdb a.out
# ...
(gdb) run < SampleData 
```

根据更新编辑：

本文：

```
[Inferior 1 (process 19460) exited with code 03] 
```

是来自`gdb`自身的消息。Inferior 是给正在调试的进程的名称`gdb`。在这里，只有 1 个（但可以有多个）。退出代码是您的程序终止的代码。如果您的`main()`函数完成，它就是它返回的值。如果您调用`exit()`，则它是您传递的值。这些值通常对于将有关您的程序是成功还是失败的信息传递给调用者（例如外壳程序）很有用。

我建议在 C 中检查`EXIT_SUCCESS`和`EXIT_FAILURE`（分别表示运行成功/失败）。许多程序定义了额外的退出代码来指示特定的错误。

由于这里的值是`03`，这是一个不寻常的退出代码，我建议您`main()`最后可能缺少 return 语句？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:28:51.210

```
gdb --args ./a.out < SampleData 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:29:47.057

在 GDB 中使用`run`命令时，可以使用正常的输入重定向：

```
$ gdb ./a.out
(gdb) run < SampleData 
```

# javascript - JavaScript 按钮处理程序模式？

> ID：15317539
> 
> 赞同：0
> 
> 时间：2013-03-10T00:26:16.823
> 
> 标签：javascript, jquery, event-handling

是否有任何模式表明在 JavaScript 中将事件处理程序放在何处？我无法想象他们应该只是被转储到文档中。准备好了。

我认为它们不应该进入 MVVM，因为除了数据绑定之外，它们不应该直接与视图对话。也就是说，我经常使用按钮处理程序来启动直接与 MVVM 交互的模式弹出窗口。问题是有时弹出窗口会与多个 MVVM 交互。

我不想就这个话题展开辩论/讨论。我希望只有一个具体的答案。

**我的问题是......我在哪里放置按钮事件处理程序？**

想法？

# servicestack - 如何从 ServiceStack RequestFilter 中找到服务

> ID：15317540
> 
> 赞同：1
> 
> 时间：2013-03-10T00:26:21.557
> 
> 标签：servicestack

我正在尝试根据将被调用`RequestFilter`的信息来实现有条件地执行的。`Service`我想`RequestFilter`找到`Service`，查看它的方法/接口/属性，并根据它有条件地完成它的工作。

我知道您可以在`RequestFilterAttribute`上声明 a `Service`，但我想不出一个使它有条件的好方法。我想将委托/lambda 传递给属性，但 C# 不允许这样做。我可以在其中插入一个类型或类型名称，以便`RequestFilterAttribute`找到`Service`类/方法，但这似乎容易出现复制/粘贴错误。

所以我只需要某种方式`RequestFilter`来`RequestFilterAttribute`了解`Service`它的作用（或声明），然后想在其中查找一个方法，`Service`该方法将提供启用/禁用过滤器代码所需的逻辑。我不知道 IoC 容器的某些功能是否提供了此功能，或者是否有其他方法可以做到这一点。

然后，根据过滤器的执行方式，它可能需要返回自己的数据，从而阻止服务实际执行。这可能吗？（这[就是](https://stackoverflow.com/questions/13851112/whats-the-best-way-to-respond-with-the-correct-content-type-from-request-filter/13851277#13851277)答案吗？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T06:34:35.820

这似乎是关键：

```
var serviceType = EndpointHost.Metadata.GetServiceTypeByRequest(requestDto.GetType()); 
```

这将返回将处理请求的服务的类型。它不是一个实例（但我怀疑是否已经创建了一个服务实例）所以要执行条件逻辑，我必须定义一个静态方法然后查找它。我使用反射找到了一种声明特殊属性的方法，并且需要对其进行优化以获得最佳性能。

从那里我可以有条件地确定是否运行一些逻辑。如果我愿意，我也可以绕过调用服务并返回成功响应，如下所示：

```
var successResponse = DtoUtils.CreateSuccessResponse(successMessage);
var responseDto = DtoUtils.CreateResponseDto(requestDto, successResponse);
var contentType = req.ResponseContentType;
res.ContentType = contentType;
res.WriteToResponse(req, responseDto);
// this is the proper way to close the request; you can use Close() but it won't write out global headers
res.EndServiceStackRequest();
return; 
```

或者我可以创建一个错误响应，或者只是从 中返回`RequestFilter`并让服务正常执行。

# asp.net-mvc-3 - Ext.NET 多次使用 FormPanelFor 引发错误

> ID：15317544
> 
> 赞同：0
> 
> 时间：2013-03-10T00:27:18.967
> 
> 标签：asp.net-mvc-3, ext.net, formpanel

我有 2 个 FormPanelFor 定义：

```
.Items
(
x.FormPanelFor(m => m.SelectedSection).ID("selectedSection"),
x.FormPanelFor(m => m.SelectedGroup).ID("selectedGroup")
) 
```

并有模型定义：

```
public class Model_Section
{
    [Field(FieldLabel = "Section Name", AllowBlank = false)]
    public string Name { get; set; }

     .....
 }

public class Model_Group
{
    [Field(FieldLabel = "Group Name", AllowBlank = false)]
    public string Name { get; set; }

     .....
 } 
```

他们都有共同的“名称”属性，结果我得到了这个错误：

*ID 为“App.Name”的控件已被初始化。请确保所有控件都有唯一的 ID。以下控件与页面上的至少一个其他控件具有相同的 ID。所有控件都必须具有唯一的 ID。控制详细信息 ID：名称。ClientID：App.Name 类型：TextField 父控件详细信息 ID：selectedGroup ClientID：App.selectedGroup 类型：FormPanel*

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T08:32:05.553

此问题的解决方法是手动为表单字段提供前缀：

```
.Items
(
x.FormPanelFor(m => m.SelectedSection, htmlFieldName: "SelectedSection").ID("selectedSection"),
x.FormPanelFor(m => m.SelectedGroup, htmlFieldName: "SelectedGroup").ID("selectedGroup")
) 
```

# sql-server - 零售数据库设计

> ID：15317545
> 
> 赞同：1
> 
> 时间：2013-03-10T00:27:21.667
> 
> 标签：sql-server, database-design

我正在为某些业务开发完整的解决方案。我有一个具体的要求：系统必须能注册产品的销售量，我解释一下：如果一盒香烟包含20支，软件必须能注册一整盒或两支香烟的销售量.

但是由于该软件还必须能够管理库存，所以我有点困惑如何设计一个数据库来支持这个功能。

这是一个虚拟示例，我在几秒钟前生成了它，所以我知道这很可怕，我只是想展示一个简单的示例。

![虚拟模型](../Images/6af65f0375bbf27fe6d570589f2737a7.png)

我计划为整个商店中的每种可用产品在 ProductInventory 上添加一条记录，每当我的客户想要销售某种产品​​的某些产品时，软件将：按条形码过滤产品，按 PiecesLeft 升序排序并从中减去这些产品结果集中的顶级产品。

这是正确的方法吗？我对这种方法感到不安，因为我认为它会在 ProductInventory 上生成太多记录，你们怎么看？你会怎么做？

我正在考虑合并具有相同条形码和 PiecesLeft 的产品以减少记录，但我不知道该怎么做（也许使用触发器？）

因此，总而言之，我想要的是您可以给我的任何建议以及对我的方法的意见。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:57:22.450

当您考虑库存时，问题在于您存储的库存不一定是您销售的库存。因此，我认为正确的方法需要一个业务流程，将一种“类型”的库存准确地转换为另一种。

假设您从存储库存中的 100 箱香烟开始。有人进来要两支香烟。为了准确的库存，转换必须看起来像这样。

```
First transformation
100 cartons -> 99 cartons
               10 packs

Second transformation
99 cartons
10 packs ->     9 packs
               20 cigarettes 
```

最后，只销售两支香烟，所以您的交易结束库存看起来像这样。

```
99 cartons
 9 packs
18 cigarettes 
```

在数据库端处理它并不是特别难。除了一个普通的旧库存模式之外，您还需要一些描述有效转换的表——您不能将一包香烟转换为一瓶啤酒——并且您需要存储过程或应用程序代码来*进行*转换.

处理条码高度依赖于应用程序。在当地的苗圃（您购买植物和幼苗的地方），条形码标签*经常*脱落或丢失。收银员有一个包含所有条形码的笔记本。当植物缺少条形码时，他们会扫描书中的条形码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:54:10.123

You say you are developing a `complete solution` so I assume you are also storing the sales in the database.

In your `Product` table you could keep track what the number of pieces for that product are. In your `OrderRow` (or whatever you would be calling it) you then keep track of how many pieces are sold.

To optimize this and decrease the need for joins you could for example add a computed persisted column to `Product` that holds the total number of pieces - the number of sold pieces.

That is all I can think of with your limited information.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:37:56.977

首先，我建议摆脱自然 PK（条形码）。它可以是（并且可能应该是）条形码字段的唯一约束，但不是 PK。

关于您的香烟示例-就您的应用程序而言，我会说盒子本身就是一种产品（它可能作为产品表中的自我关系或作为一个单独的实体来实现-说它`selable_product`有自己的价格-我会希望块比 10 包便宜一点）

# c++ - extern "C" dllexport 产生奇怪的名字

> ID：15317550
> 
> 赞同：3
> 
> 时间：2013-03-10T00:28:18.583
> 
> 标签：c++, visual-c++

~~我正在尝试使用可以执行的方法编写库`rundll32.exe`，但是~~我似乎无法强制生成正确的导出名称：

在 32 位配置`DoStuff(x,x,x,x)`
上我得到 64 位配置上我得到`DoStuff`

这是为什么？

工具：Visual Studio 2012；视窗 8

代码：

```
extern "C" __declspec(dllexport) void __stdcall DoStuff(HWND hwnd, HINSTANCE hinst, LPSTR lpszCmdLine, int nCmdShow)
{
    MessageBoxA(NULL, lpszCmdLine, "Cookies", 0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T00:46:02.370

我相信这是因为您正在使用`dllexport`函数`stdcall`。x86 上的约定`stdcall`是被调用者从堆栈中删除参数。因此，参数计数作为名称的一部分包含在内。在 x64 上，标准调用约定是寄存器传递，因此不包括参数信息。

# hadoop - 我如何更改名称节点？

> ID：15317555
> 
> 赞同：2
> 
> 时间：2013-03-10T00:28:51.797
> 
> 标签：hadoop

我在 5 台机器上配置了我的 hadoop 系统。我很快就会得到新的，这台机器有更多的资源，比如内存。所以我想改变配置，新的配置是namenode。如何在不将数据保存在 HDFS 中的情况下更改它？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T21:37:11.747

1.  **关闭**您的集群。
2.  **从以前的 NameNode复制**dfs.name.dir 目录的内容，并确保它们在您的新机器上具有**正确的权限。**
3.  确保新的**NameNode**设置为指向这些目录（**检查 hdfs-site.xml 中的 dfs.name.dir 设置**- 事实上，您应该将整个配置文件集从旧 NameNode 复制到新机器，但进行完整性检查以确保它们指向的任何目录都存在于新机器上）。
4.  现在更改**从节点和客户端以指向新的 NameNode**（每台机器上的 core-site.xml 中的 fs.default.name，包括 NameNode 本身），您应该能够再次启动集群。

# inno-setup - Inno Setup 尝试为模块化 InnoSetup 依赖安装程序创建新的安装 DirectX 模板产品

> ID：15317563
> 
> 赞同：1
> 
> 时间：2013-03-10T00:29:59.407
> 
> 标签：inno-setup, pascal

我正在使用模块化 Inno 设置

[http://www.codeproject.com/Articles/20868/NET-Framework-1-1-2-0-3-5-Installer-for-InnoSetup#xx3672600xx](http://www.codeproject.com/Articles/20868/NET-Framework-1-1-2-0-3-5-Installer-for-InnoSetup#xx3672600xx)

我正在修改现有的 DirectX 检测器方法

[http://www.vincenzo.net/isxkb/index.php?title=DirectX__-_How_to_detect_DirectX_version](http://www.vincenzo.net/isxkb/index.php?title=DirectX_-_How_to_detect_DirectX_version)

我正在尝试创建一个新产品来安装 DirectX 9

这是我到目前为止所拥有的。

```
//========================================
//detectDirectX.iss
//=======================================

[CustomMessages]
directx_title=DirectX End-User Runtimes (June 2010)

en.directx_size=95.6 MB
de.directx_size=95.6 MB

[Code]
const
    directx_url = 'http://download.microsoft.com/download/8/4/A/84A35BF1-DAFE-4AE8-82AF-AD2AE20B6B14/directx_Jun2010_redist.exe';

procedure DecodeVersion( verstr: String; var verint: array of Integer );
var
  i,p: Integer; s: string;
begin
  // initialize array
  verint := [0,0,0,0];
  i := 0;
  while ( (Length(verstr) > 0) and (i < 4) ) do
  begin
    p := pos('.', verstr);
    if p > 0 then
    begin
      if p = 1 then s:= '0' else s:= Copy( verstr, 1, p - 1 );
      verint[i] := StrToInt(s);
      i := i + 1;
      verstr := Copy( verstr, p+1, Length(verstr));
    end
    else
    begin
      verint[i] := StrToInt( verstr );
      verstr := '';
    end;
  end;

end;

// This function compares version string
// return -1 if ver1 < ver2
// return  0 if ver1 = ver2
// return  1 if ver1 > ver2
function CompareVersion2( ver1, ver2: String ) : Integer;
var
  verint1, verint2: array of Integer;
  i: integer;
begin

  SetArrayLength( verint1, 4 );
  DecodeVersion( ver1, verint1 );

  SetArrayLength( verint2, 4 );
  DecodeVersion( ver2, verint2 );

  Result := 0; i := 0;
  while ( (Result = 0) and ( i < 4 ) ) do
  begin
    if verint1[i] > verint2[i] then
      Result := 1
    else
      if verint1[i] < verint2[i] then
        Result := -1
      else
        Result := 0;

    i := i + 1;
  end;

end;

// DirectX version is stored in registry as 4.majorversion.minorversion
// DirectX 8.0 is 4.8.0
// DirectX 8.1 is 4.8.1
// DirectX 9.0 is 4.9.0

function GetDirectXVersion(): String;
var
  sVersion:  String;
begin
  sVersion := '';

  RegQueryStringValue( HKLM, 'SOFTWARE\Microsoft\DirectX', 'Version', sVersion );

  Result := sVersion;
end;

procedure directX();
var ErrorCode: Integer;
begin
  // in this case program needs at least directx 9.0
  if CompareVersion2( GetDirectXVersion(), '4.9.0') < 0 then
  begin
                AddProduct('directx_Jun2010_redist.exe',
                    '/t:' + ExpandConstant('{tmp}\DirectX') + ' /q /c',
                    CustomMessage('directx_title'),
                    CustomMessage('directx_size'),
                    directx_url,
                    false, false);

          //Is there any way to wait until directx_Jun2010_redist.exe has extracted it self before calling the next line? 
         ShellExec('open', ExpandConstant('{tmp}\DirectX\DXSETUP.exe'), '/silent', '', SW_SHOW, ewWaitUntilTerminated, ErrorCode)
  end;
end; 
```

在[RUN]下的主设置文件whatever.iss

我包括了文件。

```
#include "scripts\products\custom\detectDirectX.iss" 
```

在 [CODE] 下的主设置文件whatever.iss

我包括了这个方法

```
directX(); 
```

我遇到的问题是它正在按应有的方式下载并将其放置在 Temp 文件夹中。

```
 AddProduct('directx_Jun2010_redist.exe',
            '/t:' + ExpandConstant('{tmp}\DirectX') + ' /q /c',
            CustomMessage('directx_title'),
            CustomMessage('directx_size'),
            directx_url,
            false, false); 
```

因为我使用的是额外的 par

'/t:' + ExpandConstant('{tmp}\DirectX') + ' /q /c'

下载后，它会创建一个名为 DirectX 的文件夹并将所有内容提取到其中。这需要一点时间。

似乎 directx_Jun2010_redist.exe 正在提取..

```
ShellExec('open', ExpandConstant('{tmp}\DirectX\DXSETUP.exe'), '/silent', '', SW_SHOW, ewWaitUntilTerminated, ErrorCode) 
```

被提前调用并且文件 {tmp}\DirectX\DXSETUP.exe 还不存在..所以它不会被调用。

解压完成后，用户单击已安装完成并删除 Temp 文件夹。

有没有办法解决这个问题，以便在 directx_Jun2010_redist.exe 提取它的文件后，它可以在安装程序完成之前运行 DXSETUP.exe？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T03:24:28.253

好的，我想我终于让它正常工作了..我不得不稍微移动一下..似乎有些东西在启动时被调用但实际上并没有触发它们直到稍后才被查询。考虑到这一点，我能够解决这个问题。这是代码。

**在您的主 setupfile.iss 在[RUN]**下添加以下内容

 **```
Filename: "{tmp}\DirectX\DXSETUP.exe"; WorkingDir: "{tmp}\DirectX"; Parameters: "/silent"; Check: checkDirectX; Flags: waituntilterminated;

#include "scripts\products\custom\detectDirectX.iss" 
```

**同样在您的主 setupfile.iss 在[Code]**下添加以下内容

 **```
directX(); 
```

这是detectDirectX.iss的代码

```
[CustomMessages]
directx_title=DirectX End-User Runtimes (June 2010)

en.directx_size=95.6 MB
de.directx_size=95.6 MB

[Code]
const
    directx_url = 'http://download.microsoft.com/download/8/4/A/84A35BF1-DAFE-4AE8-82AF-AD2AE20B6B14/directx_Jun2010_redist.exe';

procedure DecodeVersion( verstr: String; var verint: array of Integer );
var
  i,p: Integer; s: string;
begin
  // initialize array
  verint := [0,0,0,0];
  i := 0;
  while ( (Length(verstr) > 0) and (i < 4) ) do
  begin
    p := pos('.', verstr);
    if p > 0 then
    begin
      if p = 1 then s:= '0' else s:= Copy( verstr, 1, p - 1 );
      verint[i] := StrToInt(s);
      i := i + 1;
      verstr := Copy( verstr, p+1, Length(verstr));
    end
    else
    begin
      verint[i] := StrToInt( verstr );
      verstr := '';
    end;
  end;

end;

// This function compares version string
// return -1 if ver1 < ver2
// return  0 if ver1 = ver2
// return  1 if ver1 > ver2
function CompareDirectXVersion( ver1, ver2: String ) : Integer;
var
  verint1, verint2: array of Integer;
  i: integer;
begin

  SetArrayLength( verint1, 4 );
  DecodeVersion( ver1, verint1 );

  SetArrayLength( verint2, 4 );
  DecodeVersion( ver2, verint2 );

  Result := 0; i := 0;
  while ( (Result = 0) and ( i < 4 ) ) do
  begin
    if verint1[i] > verint2[i] then
      Result := 1
    else
      if verint1[i] < verint2[i] then
        Result := -1
      else
        Result := 0;

    i := i + 1;
  end;

end;

// DirectX version is stored in registry as 4.majorversion.minorversion
// DirectX 8.0 is 4.8.0
// DirectX 8.1 is 4.8.1
// DirectX 9.0 is 4.9.0

function GetDirectXVersion(): String;
var
  sVersion:  String;
begin
  sVersion := '';

  RegQueryStringValue( HKLM, 'SOFTWARE\Microsoft\DirectX', 'Version', sVersion );

  Result := sVersion;
end;

function checkDirectX(): boolean;
begin
  // in this case program needs at least directx 9.0
  if CompareDirectXVersion( GetDirectXVersion(), '4.9.0') < 0 then
  begin
       Result := true;
  end
  else
  begin
    Result := false;
   end;

end;

procedure directX();
begin
  // in this case program needs at least directx 9.0
  if CompareDirectXVersion( GetDirectXVersion(), '4.9.0') < 0 then
  begin
                AddProduct('directx_Jun2010_redist.exe',
                    '/t:' + ExpandConstant('{tmp}\DirectX') + ' /q /c',
                    CustomMessage('directx_title'),
                    CustomMessage('directx_size'),
                    directx_url,
                    false, false);

  end;
end; 
```

我希望这对其他人有所帮助。整个想法是我可以发布我的软件而不必担心 DirectX，至少我的软件需要 DirectX 9 一些 XP 用户可能没有更新他们的机器。或者有些人可能已经删除了它vista 或 7，Windows 8 开箱即用，更新版本，所以不用担心。****

# google-apps-script - 有没有办法将 Google 应用脚本 html 模板映射到自定义域名？

> ID：15317566
> 
> 赞同：1
> 
> 时间：2013-03-10T00:30:23.837
> 
> 标签：google-apps-script

我有兴趣在 Google Apps 脚本 html 模板上开发整个应用程序。我可以使用 Google Apps for Business 将域映射到应用脚本吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-30T11:20:36.123

这是一个**非常**迟到的回应，但是是的，你可以做到这一点！

关键步骤是将 .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL) 枚举添加到您的 HtmlServe 中，如下所示：

```
return HtmlService
     .createTemplateFromFile('login')
     .evaluate()
     .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL); 
```

然后，您可以简单地将您的 Apps 脚本 URL 嵌入到您喜欢的任何网页上。如果您在服务器上启用了 SSL，它甚至支持 SSL。

```
<iframe src="https://script.google.com/macros/s/xxxxxxxxxxxxxxxxxxxxxx/exec"></iframe> 
```

> 来源： [https ://developers.google.com/apps-script/reference/html/x-frame-options-mode](https://developers.google.com/apps-script/reference/html/x-frame-options-mode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:48:23.673

我认为最好的解决方案是将您的 Apps 脚本托管在 Google 协作平台页面（可以托管在 [subdomain].your-domain.com）中。

[以下是有关 Google 协作平台上的 GAS 小工具的一些信息](https://developers.google.com/apps-script/execution_gadgets)。

以及[您自己的子域上的 Google 协作平台](http://support.google.com/sites/answer/99448?hl=en)。点击“通过 Google Apps 建立的网站”下拉菜单。

# ruby - 宝石与中间人

> ID：15317568
> 
> 赞同：1
> 
> 时间：2013-03-10T00:30:46.597
> 
> 标签：ruby, middleman

我正在尝试学习 Middleman 来创建一个静态站点，希望类似于 RailsCasts 在这个非常聪明的基于树的导航片段[http://railscasts.com/episodes/162-tree-based-navigation-revised](http://railscasts.com/episodes/162-tree-based-navigation-revised)中构建的 CMS 。该站点的内容一旦创建就永远不会改变，因此我认为最好将其作为静态站点而不是 Rails 应用程序，尽管我想在开发中利用 ruby​​。rails 应用程序使用祖先 gem 来创建与某些页面的父子关系。

```
rails g scaffold page name content:text ancestry:string:index 
```

在 Railscast 中，随后可以动态创建父子页面，即使内容最终是静态的。我不确定中间人是否可以使用祖先 gem 完成类似的过程。虽然我阅读了文档，但我之前从未创建过 Middleman 应用程序。我已经启动了该应用程序，但现在它只是一堆空文件夹。有什么建议可以解决这个问题吗？在尝试新事物时，我通常需要很多指导，并且鉴于缺乏中间人教程，我希望您能提供尽可能多的细节。

更新

\

注意，祖先 gem 将每个条目的父子信息存储在数据库中的字符串中`ancestry: "1/2"`

更新

我看到的一个问题是，要在 Rails 中使用 Ancestry，我必须`has_ancestry`在作为 Active Record 子类的类中使用。由于中间人中没有 db，这似乎是不可能的，但我想知道数据是否包含在 yaml 文件中，有没有办法在不继承 Active Record 的类中以某种方式使用 has_ancestry

```
class Page < ActiveRecord::Base
  attr_accessible :parent_id, :content, :name

  has_ancestry
end 
```

# ios6 - 改变 AVCaptureVideoPreviewLayer 方向的问题

> ID：15317569
> 
> 赞同：4
> 
> 时间：2013-03-10T00:30:48.743
> 
> 标签：ios6, avfoundation, calayer, avcapturesession, autorotate

我正在使用 AVFoundation 创建摄像机 UI。包含的视图控制器将仅以 LandscapeRight 方向显示。通过预览层更改输出方向时，它会正确显示：

```
self.previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:self.captureSession];
self.previewLayer.orientation = AVCaptureVideoOrientationLandscapeRight;
[self.displayContainer.layer addSublayer:self.previewLayer]; 
```

但是，我意识到 AVCaptureVideoPreviewLayer 的方向属性已被弃用，取而代之的是 AVCaptureConnection.videoOrientation。当使用它时：

```
 self.previewLayer.connection.videoOrientation = AVCaptureVideoOrientationLandscapeRight; 
```

预览层似乎根本没有改变方向，即使在尝试不同的方向选项时也是如此。为了按照推荐的方式执行此操作，我是否还缺少另一个步骤？

编辑：

以下是视图控制器中存在的自动旋转方法：

```
-(BOOL)shouldAutorotate
{
    return NO;
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscapeRight;
}

-(UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationLandscapeRight;
} 
```

解决方案：

这可以通过应用@Spectravideo328 答案中的所有建议以及将预览层添加到 ViewControllers 视图层而不是 displayContainer 子视图来解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T02:58:12.970

您的问题不是 AvCaptureVideoPreviewLayer 问题，而是一般的 CALayer 问题（previewLayer 是其子类）。

所有 CALayers 都需要设置它们的框架：在您的情况下，我只想添加到您的代码中：

```
self.previewlayer.frame=self.view.bounds. 
```

使用 self.view.bounds 而不是 self.view.frame 至关重要，这样如果设备旋转，则预览层尺寸会旋转（调整）。

希望这可以帮助。

更新：这是来自supportedInterfaceOrientations 帮助描述：

> 当用户更改设备方向时，系统会在根视图控制器或填充窗口的最顶部呈现的视图控制器上调用此方法。如果视图控制器支持新方向，则窗口和视图控制器将旋转到新方向。仅当视图控制器的 shouldAutorotate 方法返回 YES 时才会调用此方法。

更新您的 shouldAutorotate 以始终返回 YES。

# ruby - SublimeLinter for Ruby：我可以禁用特定警告（即“已分配但未使用的变量”）吗？

> ID：15317575
> 
> 赞同：3
> 
> 时间：2013-03-10T00:32:21.970
> 
> 标签：ruby, sublimetext2, sublimelinter

我喜欢 SublimeLinter for Sublime Text，但我不知道如何禁用不适用的警告。我经常遇到的一个例子是 Sinatra 应用程序的“警告：已分配但未使用的变量”。分散注意力以突出显示这些行。

有没有办法根据类型抑制 lint 警告/“错误”？如何忽略特定的警告实例？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-14T01:13:46.490

使用每个 linter 的[ignore_match](https://github.com/SublimeLinter/docs/blob/master/linter_settings.rst#ignore_match)设置：

```
"ignore_match": [
  "assigned but unused variable"
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T03:33:45.570

SublimeLinter 只是各种 linting 后端和命令的插件。它本身对源代码文件的作用没有任何意见。

您应该检查底层 linting 引擎（在这种情况下似乎是 Ruby 命令本身）（[https://github.com/SublimeLinter/SublimeLinter/blob/master/sublimelinter/modules/ruby.py](https://github.com/SublimeLinter/SublimeLinter/blob/master/sublimelinter/modules/ruby.py)）如何处理警告。

在最坏的情况下，您可以就地编辑插件并为 ruby​​ linting 命令提供更多选项。

# ruby-on-rails - RSpec + 设计 + 覆盖 update_with_password

> ID：15317578
> 
> 赞同：0
> 
> 时间：2013-03-10T00:32:58.013
> 
> 标签：ruby-on-rails, rspec, devise, ruby-on-rails-3.2

我在从我在我的用户模型上覆盖的设计中测试 update_with_password 方法时遇到了一些麻烦。

我正在使用 Rails 3.2、Devise 2.2.3 和 Rspec-rails 2.13

这是我的用户模型 update_with_password 方法的样子：

```
#app/model/user.rb

def update_with_password(params, *options)
  if encrypted_password.blank?
    update_attributes(params, *options)
  else
    super
  end
end 
```

这是我的规格：

```
#spec/model/user_spec.rb

describe "#update_with_password" do
  context "when encrypted password is blank" do

    before(:each) do
      @user = FactoryGirl.build(:user_via_facebook)
      @user.save(validate: false)
      @facebook_profile = FactoryGirl.create(:facebook_profile, user: @user)
    end

    it "updates user attributes without asking current password" do
      @user.update_with_password(params: {first_name: "New First Name"})
      @user.first_name.should eql "New First Name"
    end

  end
end 
```

这是我在运行规范后遇到的错误：

```
User#update_with_password when encrypted password is blank updates user attributes without asking current password
  Failure/Error: @user.update_with_password(params: {first_name: "New First Name"})
    ActiveModel::MassAssignmentSecurity::Error:
      Can't mass-assign protected attributes: params 
```

我应该如何测试这种方法？我缺少一些东西，我无法弄清楚。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:06:17.740

我想你只是想要

```
@user.update_with_password({first_name: "New First Name"}) 
```

代替

```
@user.update_with_password(params: {first_name: "New First Name"}) 
```

# jsf-2 - Google 地图 v3 未在我的 jsf 2 网站上呈现

> ID：15317579
> 
> 赞同：1
> 
> 时间：2013-03-10T00:33:22.633
> 
> 标签：jsf-2, google-maps-api-3

我正在尝试在 wy jsf 2 和 richfaces 4 网站上嵌入谷歌地图 v3。一切似乎都正常，但我的地图没有呈现，即使当我查看控制台时我看到地图图像已下载但在我的页面中不可见。这是我在 Web 控制台上的结果

```
[00:20:33,874] GET http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js [HTTP/1.1 200 OK 4328ms]
[00:20:33,882] GET http://maps.google.com/maps/api/js?key={MYKEY}&sensor=true [HTTP/1.1 200 OK 2062ms]
...
[00:20:44,334] GET http://maps.gstatic.com/cat_js/intl/fr_ALL/mapfiles/api-3/12/2/%7Bcommon,map%7D.js [HTTP/1.1 200 OK 1437ms]
[00:20:46,052] GET http://maps.gstatic.com/mapfiles/openhand_8_8.cur [HTTP/1.1 200 OK 437ms]
[00:20:46,119] GET http://maps.gstatic.com/cat_js/intl/fr_ALL/mapfiles/api-3/12/2/%7Butil,onion%7D.js [HTTP/1.1 200 OK 2219ms]
[00:20:46,143] GET http://maps.gstatic.com/mapfiles/transparent.png [HTTP/1.1 200 OK 907ms]
[00:20:46,180] GET http://maps.googleapis.com/maps/api/js/ViewportInfoService.GetViewportInfo?1m6&1m2&1d-34.397&2d148.83125500000006&2m2&1d-34.396999&2d152.45674499999996&2u8&4sfr&5e0&6sm%40209000000&7b0&8e0&9b0&callback=_xdc_._bge38k&token=99037 [HTTP/1.1 200 OK 1000ms]
[00:20:46,199] GET http://mt0.googleapis.com/vt?lyrs=m@209000000&src=apiv3&hl=fr&x=234&y=153&z=8&s=Galileo&style=api%7Csmartmaps [HTTP/1.1 200 OK 3094ms]
[00:20:46,244] GET http://maps.gstatic.com/cat_js/intl/fr_ALL/mapfiles/api-3/12/2/%7Bcontrols,stats%7D.js [HTTP/1.1 200 OK 2656ms]
[00:20:46,283] GET http://mt0.googleapis.com/vt?lyrs=m@209000000&src=apiv3&hl=fr&x=234&y=154&z=8&s=&style=api%7Csmartmaps [HTTP/1.1 200 OK 3343ms]
[00:20:46,298] GET http://mt1.googleapis.com/vt?lyrs=m@209000000&src=apiv3&hl=fr&x=235&y=153&z=8&s=Ga&style=api%7Csmartmaps [HTTP/1.1 200 OK 4031ms]
[00:20:46,320] GET http://mt1.googleapis.com/vt?lyrs=m@209000000&src=apiv3&hl=fr&x=235&y=154&z=8&s=Gal&style=api%7Csmartmaps [HTTP/1.1 200 OK 4906ms]
[00:20:48,497] GET http://mt0.googleapis.com/mapslt/ft?hl=fr&lyrs=m%40209000000%7Csalt%3A190877606&las=wvvuwtvu,wvvuwtvw,wvvuwtwt,wvvuwtwv&z=8&src=apiv3&xc=1&style=api%7Csmartmaps&callback=_xdc_._90cyl4&token=91449 [HTTP/1.1 200 OK 1187ms]
[00:20:49,196] GET http://maps.googleapis.com/maps/api/js/AuthenticationService.Authenticate?1shttp%3A%2F%2Flocalhost%3A8080%2Fhereka%2Fhome.jsf&{MYKEY}&5e1&callback=_xdc_._isjeo3&token=31472 [HTTP/1.1 200 OK 688ms]
[00:20:49,216] GET http://maps.gstatic.com/mapfiles/google_white.png [HTTP/1.1 200 OK 1047ms]
[00:20:49,231] GET http://maps.gstatic.com/mapfiles/mv/imgs8.png [HTTP/1.1 200 OK 1781ms]
[00:20:49,263] GET http://maps.gstatic.com/mapfiles/cb/mod_cb_scout/cb_scout_sprite_api_003.png [HTTP/1.1 200 OK 1531ms]
[00:20:49,279] GET http://maps.gstatic.com/mapfiles/rotate2.png [HTTP/1.1 200 OK 1422ms]
[00:20:49,295] GET http://maps.gstatic.com/mapfiles/szc4.png [HTTP/1.1 200 OK 1312ms]
[00:20:49,310] GET http://maps.gstatic.com/mapfiles/arrow-down.png [HTTP/1.1 200 OK 1328ms]
[00:20:49,326] GET http://maps.gstatic.com/cat_js/intl/fr_ALL/mapfiles/api-3/12/2/%7Bmarker%7D.js [HTTP/1.1 200 OK 1765ms]
[00:20:49,978] GET http://maps.googleapis.com/maps/gen_204?ev=api_viewport&cad=mt:m,c:-34.397%2C150.644,sp:0.00000x1.20850,src:apiv3,ts:3ecpy0 [HTTP/1.1 204 No Content 641ms]
[00:20:52,184] GET http://csi.gstatic.com/csi?v=2&s=mapsapi3&action=apiboot&rt=jl.1604,mc.3136,mb.4730,ep.6019,vt.10080,prt.10080,plt.8548,mt.10080&size=220x0&maptype=m [HTTP/1.1 204 No Content 2266ms]
[00:20:56,231] GET http://maps.googleapis.com/maps/api/js/QuotaService.RecordEvent?1shttp%3A%2F%2Flocalhost%3A8080%2Fhereka%2Fhome.jsf&3sAIzaSyAoq4IqVvGnLj0bpMOCNxiwufA_-4zZxBc&4e1&5e0&6u1&7s3ecvhs&callback=_xdc_._lg61t8&token=39523 [HTTP/1.1 200 OK 531ms] 
```

这是我的页面模板：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

 <html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
    <h:head>
       <title><ui:insert name="windowTitle"/></title>
       <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
       <script type="text/javascript" src="http://maps.google.com/maps/api/js?key={MYKEY}&amp;sensor=true"></script>
<script src="./Scripts/gmaps.js"></script>

<script type="text/javascript">
function initialize() {
  var mapOptions = {
    center: new google.maps.LatLng(-34.397, 150.644),
    zoom: 8,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById("map"),
      mapOptions);
}
</script>

    </h:head>

    <h:body  onload="initialize()">

      <f:view locale="#{usersession.myLocale.code}">

                   <div id="advert2">
                      <ui:insert name="advert2">
                           <ui:include src="/composant/pub/pub.xhtml"/>
                      </ui:insert>
                   </div>  
    </f:view>
</h:body>
 </html> 
```

这里是地图页面：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

 <html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
    <h:head>
       <title><ui:insert name="windowTitle"/></title>

    </h:head>

<body >
    <h:form>
    <div id="map"></div>
</h:form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-10T14:55:35.473

在上面的评论部分，所有功劳都归功于 Dr.Molle，但他的回答正是我需要修复我的第一张地图，我觉得它应该被称为正确的答案。

```
<div id="map" style="height:300px" /> 
```

# valgrind - 抑制源自 valgrind 中特定库的所有错误

> ID：15317583
> 
> 赞同：1
> 
> 时间：2013-03-10T00:34:13.517
> 
> 标签：valgrind, gnutls

我有一个与网络相关的应用程序，它使用我需要调试的 gnutl，但是一些未初始化的内存错误导致整个应用程序的扩散，这使得 valgrind 几乎无用。

使用 --track-origins=yes 清楚地表明错误源自 gnutls：

```
==1369==  Uninitialised value was created by a stack allocation
==1369==    at 0x5FE39B7: ??? (in /usr/local/lib/libgnutls.so.28.15.0) 
```

我尝试使用 --gen-suppressions=all 手动抑制这些错误，但似乎我最终会在构建于 gnutls 之上的大部分应用程序中抑制错误。

我也试过：

```
{
   gnutls
   Memcheck:Cond
   obj:/usr/local/lib/libgnutls.so.28.15.0
} 
```

这似乎根本没有压制任何东西。有什么方法可以防止来自特定库的错误扩散，所以我不必拥有这么大的抑制文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:41:47.790

用你自己的类包装这个库，并在 try catch 块中做所有事情。它使您可以选择忽略错误或重试方法调用。

# linux - 如何在bash中正确执行这个while循环？

> ID：15317584
> 
> 赞同：2
> 
> 时间：2013-03-10T00:34:18.343
> 
> 标签：linux, bash

```
#!/bin/bash

f=1
c=$1
while [[ $c != 0 ]]
do
        $f=$(($c*$f))
        $c=$(($c-1))
done
echo $c 
```

我不断收到错误

```
./process.sh: line 8: 1=0: command not found
./process.sh: line 7: 5=5: command not found 
```

跑步时`./process.sh 5`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T00:36:06.430

意思是“`$`价值”，因此`$f`被评估为字符串文字`1`。所以...

```
 $f=$(($c*$f))
    $c=$(($c-1)) 
```

应该

```
 f=$(($c*$f))
    c=$(($c-1)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:36:04.887

在循环中，它应该是

```
f=$(($c*$f))
c=$(($c-1)) 
```

# android - 安卓二维数组

> ID：15317590
> 
> 赞同：0
> 
> 时间：2013-03-10T00:35:18.823
> 
> 标签：android

我正在尝试显示基于`RadioButtons`. 我使用 2 组按钮。该按钮应指向`[x, y]`我的数组。`String`应该显示数组的值（使用 a `Toast`）。

是的，我对此很陌生，但我试图挑选几个类似的例子，但运气不佳。

```
public class MainActivity extends Activity {
    String[][] tipSize = {
            {"N/A","N/A","Pink","Lt Blue","Purple","Yellow","Brown","Orange","Tan","Blue","White","Beige"},
            {"N/A","Pink","Lt Blue","Purple","Yellow","Brown","Orange","Green","Tan","Blue","White","Beige"},
            {"N/A","N/A","Pink","Purple","Turquoise","Yellow","Green","Tan","Blue","White","Red","No Tip"},
            {"Pink","Lt Blue","Purple","Yellow","Orange","Green","Tan","Blue","Red","Beige","Gray","N/A"},
            {"Pink","Lt Plue","Purple","Orange","Green","Tan","Blue","White","Beige","Black","Gray","N/A"},
            {"Pink","Lt Blue","Yellow","Brown","Orange","Green","Tan","Blue","White","Beige","Black","N/A"},
            {"Pink","Lt Blue","Yellow","Brown","Tan","Blue","White","Red","Beige","Black","No Tip","N/A"},
            {"Pink","Lt Blue","Purple","Yellow","Orange","Green","Tan","Blue","Red","Beige","Gray","N/A"},
    };

private RadioGroup dispenser,ounce_pg;
private RadioButton disp,o_pg;
String tip = "";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button finishBtn = (Button) findViewById(R.id.button1);
    finishBtn.setOnClickListener (new View.OnClickListener() {      
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            MainActivity.this.showit(); 
        }
    });     
}

protected void showit() {
    // TODO Auto-generated method stub
    disp = (RadioButton) findViewById(R.id.dispenser);
    o_pg = (RadioButton) findViewById(R.id.ounce_pg);
    tip = String tipSize [disp,o_pg];
    // tip is the displayed answer (Color of tip), tipSize[][] is the Array, disp is RadioButton 1 - o_pg is Radio Button 2 values. 

    Toast.makeText(MainActivity(),tip,Toast.LENGTH_LONG).show();
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:03:12.630

这条线有很多问题：

```
 tip = String tipSize [disp,o_pg]; 
```

1.  `[disp,o_pg]`应该是`[disp][o_pg]`因为访问二维数组是通过`array [x][y]`

2.  `String tipSize`没有意义，你不能在这里声明一个类型。如果你这样做`(String)`了，那将是一个演员，那没关系（但由于你有一个数组，这将是多余的-从 a`String`转换为 a不会做任何事情）。`String``String`

3.  `disp`并且`o_pg`应该是`int`。

这是因为在访问索引时，您不能将 Object 传递给数组，数组不会为您“搜索”。这意味着您需要弄清楚您想要访问哪些职位并将其传递出去。还要记住索引开始于`0`，而不是`1`。

一个可编译的例子是：

```
tip = tipSize [0][0]; //first element of the first array ("N/A") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:09:18.577

一种快速而肮脏的方法是创建一个简单的字符串数组，其中包含一个分隔字符串，将第二个值组合在一起，然后使用 split 函数本身返回一个字符串数组来获取各个值。

```
String [] allTips = {"a;b;c", "d;e;f"};
String [] sometips = alltips[1].split(";")
String tip = sometips[2]; 
```

会导致信`f`

# asp.net - ASP.NET Response.Redirect() 问题在错误参数下不起作用

> ID：15317597
> 
> 赞同：1
> 
> 时间：2013-03-10T00:36:12.953
> 
> 标签：asp.net, redirect, expression, response, evaluate

遇到问题`Response.Redirect()`并收到错误：

***无法评估表达式，因为代码已优化或本机框架位于调用堆栈顶部***

我用谷歌搜索并在这里找到了一些主题，例如： [无法评估表达式，因为代码已优化或本机框架位于调用堆栈之上](https://stackoverflow.com/questions/2041482/unable-to-evaluate-expression-because-the-code-is-optimized-or-a-native-frame-is)

人们提出将第二个参数设置为`false`值以使其工作的地方，例如：

```
Response.Redirect("PageName.aspx", false); 
```

但至于我的程序，它并没有重定向到新的程序......它只是继续留在这个页面上。

我在其他页面上做了一个断点，我想重定向它。但是断点没有任何事件可以捕获。看起来它只是不将请求发送到另一个页面。

我的代码相当大，所以我没有在这里发布代码，而是在 ideone：http: [//ideone.com/bQzCJd](http://ideone.com/bQzCJd)

该`Redirect()`方法在 上`57th line`，其中：

*   发生异常，如果第二个参数设置为`true`
*   什么都没有发生，如果设置为`false`

我必须做些什么来修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:45:16.993

> 发生异常，如果第二个参数设置为 true

是的，`ThreadAbortException`因为您在 a中[重定向](http://msdn.microsoft.com/en-us/library/a8wa7sdt%28v=vs.110%29.aspx)`Try-Catch`。

你为什么不使用`Response.Redirect("PageName.aspx")`但在之后`try/catch`？使用一个`bool`变量，例如`redirectCabinet`，您可以在重定向之前检查它：

```
bool redirectCabinet = false;
try
{
    // ...
    if (tmpStr != String.Empty)
    {
        if (pageHandler.Request.HttpMethod == "GET")
        {
            if (pageHandler.Request.Params["method"] == "checkAuth")
            {
                // ...
                bool userExists = Convert.ToBoolean(mysqlObject.MakeScalar(ref mysqlConn,
                if (userExists)
                {
                   // ...
                    redirectCabinet = true;
                    //Response.Redirect("Cabinet.aspx");
                }
                // ...
            }
        }
        //....
    }
} catch (Exception exc)
{
    exc.ToString();
}

if(redirectCabinet)
    Response.Redirect("Cabinet.aspx"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:46:22.827

我建议你避免 Abort Exception，并使用 true 来结束执行并转到下一页。

```
try
{
    // this is throw the ThreadAbortException exception
    Response.Redirect("SecondEndPage.aspx", true);
}
catch (ThreadAbortException)
{
    // ignore it because we know that come from the redirect
}
catch (Exception x)
{

} 
```

类似：[https ://stackoverflow.com/a/14641145/159270](https://stackoverflow.com/a/14641145/159270)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-02T13:15:31.030

即使使用评论中提供的解决方案，它也不能正常工作，但如果使用 true 重定向`endRequest`，它应该可以工作。

像这样：

```
if(redirectCabinet)
    Response.Redirect("Cabinet.aspx",true); 
```

# android - 定期更新小部件 TextView 的简单方法

> ID：15317600
> 
> 赞同：2
> 
> 时间：2013-03-10T00:36:40.060
> 
> 标签：android, android-widget, widget, textview

我有一个带有两个 TextView 的小部件，显示时间和日期。

我只是希望这批代码每秒发生一次：

```
views.setOnClickPendingIntent(R.id.rl, pendingIntent);
java.util.Date noteTS = Calendar.getInstance().getTime();
String time = "kk:mm";
String date = "dd MMMMM yyyy";

views.setTextViewText(R.id.tvTime, DateFormat.format(time, noteTS));
views.setTextViewText(R.id.tvDate, DateFormat.format(date, noteTS)); 
```

所以我需要一种简单的方法来定期在小部件中更新 TextView，以便时间变化超过标准的 30 分钟。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-10T01:33:54.343

您可以创建`Handler`and `Runnable`，然后让以指定的时间间隔`Handler`重新启动。`Runnable`您的程序可能如下所示：

```
private Handler mHandler = new Handler();

@Override
public void onResume() {
    super.onResume();
    mHandler.removeCallbacks(mUpdateClockTask);
    mHandler.postDelayed(mUpdateCLockTask, 100);
}

@Override
public void onPause() {
    super.onPause();
    mHandler.removeCallbacks(mUpdateClockTask);
}

private Runnable mUpdateClockTask = new Runnable() {
    public void run() {
        updateClock();
        mHandler.postDelayed(mUpdateClockTask, 1000);
    }
}; 
```

在`updateClock()`你内部进行所有的 UI 更新。我想所有这一切都发生在`Activity`适当的`onPause()/onResume()`调用内部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:39:27.053

你必须使用 AlarmManager，查看本教程了解详情： [http](http://www.vogella.com/articles/AndroidWidgets/article.html#widget_update) ://www.vogella.com/articles/AndroidWidgets/article.html#widget_update 不要忘记检查这部分：

**8\. 教程：通过服务更新小部件**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T00:40:30.473

另一种可能性是使用[Timer](http://developer.android.com/reference/java/util/Timer.html)和[TimerTask](http://developer.android.com/reference/java/util/TimerTask.html)类。您可以使用该`Timer.schedule(TimerTask task, long delay, long period)`方法来完成您需要的工作。

请记住，您无法从 TimerTask 中访问 UI 线程 - 因此，`Handler.postDelayed()`如果您已经打算将 a`Handler`与`Timer`类一起使用，则该方法可能是更好的选择。还有其他方法可以使用 访问 UI 线程*，*`TimerTask`例如`Activity.runOnUiThread()`.

# asp.net - 仅在表单 POST 上的视图中显示 ModelState 错误

> ID：15317602
> 
> 赞同：1
> 
> 时间：2013-03-10T00:37:03.670
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, asp.net-mvc-4

我有一个多步骤注册表单：

第 1 页（电子邮件）-> 第 2 页（姓名）-> 第 3 页（成功）

在我的第 1 页上，可以通过查询字符串预先填充电子邮件字段。

问题出在第 2 页上，如果名称字段为空并提交，我将无法显示验证错误。

如果我将所需属性应用于第 2 页模型的名称字段，则第 1 页 -> 第 2 页调用将始终失败。所以我取出了所需的属性并为第 3 页创建了一个重复的视图模型，与第 2 页相同，但名称上有所需的属性。现在第 3 页可以检测名称是否为空且模型无效，因此此时我重定向回第 2 页，但第 2 页上的视图不会显示名称字段周围的验证错误。

我能做些什么 ？

视图模型代码：

```
public Class StepOneViewModel
{
    [Required]
    public string Email{ get; set; }
}

public Class StepTwoViewModel
{
    [Required]
    public string Email{ get; set; }

    public string FirstName { get; set; }

    public string LastName { get; set; }
}

public Class StepTwoViewModelPOST
{
    [Required]
    public string Email{ get; set; }

    [Required]
    [Display(Name = "First Name")]
    public string FirstName { get; set; }

    [Required]
    [Display(Name = "Last Name")]
    public string LastName { get; set; }
} 
```

控制器代码：

```
 public ActionResult Step1(string email)
        {
           return View();
        }

        [HttpPost]
        public ActionResult Step1(StepOneViewModel viewModel)
        {
            if (!ModelState.IsValid)
                return View();
            else
                return RedirectToAction("Step2", viewModel);
        }

        public ActionResult Step2(StepTwoViewModel viewModel)
        {
            if (!ModelState.IsValid)
                return RedirectToAction("Step1", viewModel);
            else
            {
                return View(viewModel);
            }
        }

        [HttpPost]
        public ActionResult Step2(StepTwoViewModelPOST viewModel)
        {
            if (!ModelState.IsValid)
                return RedirectToAction("Step1", viewModel);
            else
            {
                return Content("Success");
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T05:33:21.963

好的，我想通了...在 Step2 的 POST 处理程序上，如果 ModeState 无效，我只需要映射 StepTwoViewModelPOST => StepTwoViewModel，然后简单地返回带有模型的 View。

```
 [HttpPost]
    public ActionResult Step2(StepTwoViewModelPOST viewModel)
    {
        if (!ModelState.IsValid)
        {
             StepTwoViewModel model = new StepTwoViewModel { 
                  Email = viewModel.Email,
                  FirstName = viewModel.FirstName,
                  LastName = viewModel.LastName
              };
            return View(model);
        }
        else
        {
            return Content("Success");
        }
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-10T10:23:22.583

## 在这里，您有“工作流程”问题。做它PRG！

什么是PRG？[发布/重定向/获取](http://en.wikipedia.org/wiki/Post/Redirect/Get)。因此，请尝试使用以下表单工作流程：

1.  获取步骤1
2.  POST step1（检查`ModelState.IsValid`是否不返回`View`）
3.  重定向到步骤 2
4.  获取步骤 2 5 ...

有道理？

当然，数据应该在步骤之间保存。您可以在客户端（cookie、[sesvars](http://www.thomasfrank.se/sessionvars.html)、本地存储...）或服务器端（会话、一些持久性）执行此操作。但是我建议您只使用 ASP.NET 会话。

# asp.net-mvc - Autofac：自定义 LifetimeScope

> ID：15317603
> 
> 赞同：2
> 
> 时间：2013-03-10T00:37:45.467
> 
> 标签：asp.net-mvc, asp.net-mvc-4, ioc-container, autofac, multi-tenant

我正在构建一个多租户 MVC 4 应用程序并使用 Autofac 作为容器。

我一直在看 Autofac MultiTenant 库，但是除非我错过了一些我认为它并不真正适合我需要的东西。这是我的情况：

*   我不知道所有的租户都预先和新的租户将在执行期间创建
*   租户没有不同的依赖关系，只有存储在实例中的数据
*   我有一些需要**每个租户**的实例，以确保不泄漏数据
*   我有一些实例将是根容器中的单个实例（不是问题）
*   我有一些实例将根据 http 请求（不是问题）
*   我根据他们访问网站的 URL 来确定租户

我找不到任何适合我需要的东西，所以我想我需要寻找一种方法来为每个租户创建自己的生命周期范围。我将如何去创造这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:01:10.913

[我之前回答并表示您无法即时注册新租户。那是不正确的，我正在相应地更新。

我认为你可以用 Autofac.Extras.Multitenant 做你想做的事，尽管你会想要彻底测试它（[如果它坏了，请告诉我们](https://code.google.com/p/autofac/issues/list)）。

*   **租户没有不同的依赖关系，只有存储在实例中的数据**：在容器级别注册公共依赖关系，但对于每个租户具有不同数据的实例，将它们注册为`InstancePerTenant`.
*   **我有一些需要每个租户的实例，以确保不泄漏数据**：使用`InstancePerTenant`注册扩展。
*   **我根据他们访问网站的 URL 来确定租户**：实现您自己的`ITenantIdentificationStrategy`，查看 URL 并转换为租户 ID。

在**执行项目期间需要注册新租户**是我以前认为行不通的事情，但现在我认为可以了。

在应用启动时创建租户时，如下所示：

```
// Configure application-level defaults.
var builder = new ContainerBuilder();
builder.RegisterType<Consumer>().As<IDependencyConsumer>().InstancePerDependency();
builder.RegisterType<BaseDependency>().As<IDependency>().SingleInstance();
var appContainer = builder.Build();

// Configure tenant identification and start the multitenant container.
var tenantIdentifier = new MyTenantIdentificationStrategy();
var mtc = new MultitenantContainer(tenantIdentifier, appContainer);

// Configure overrides for existing tenants.
mtc.ConfigureTenant('1', b => b.RegisterType<Tenant1Dependency>().As<IDependency>().InstancePerDependency());
mtc.ConfigureTenant('2', b => b.RegisterType<Tenant2Dependency>().As<IDependency>().SingleInstance());

// Set the MVC dependency resolver.
DependencyResolver.SetResolver(new AutofacDependencyResolver(mtc)); 
```

如果您需要在应用程序运行时创建租户，只要您之前没有配置过租户（没有重复的租户 ID），您应该能够做到这一点。

我认为它会像这样工作：

```
// Get the current application container.
var mtc = AutofacDependencyResolver.Current.ApplicationContainer as MultitenantContainer;

// Configure the new tenant.
mtc.ConfigureTenant('3', b => b.RegisterType<Tenant3Dependency>().As<IDependency>().InstancePerDependency()); 
```

其实我觉得就这么简单。同样，只要您不尝试*重新配置现有租户*，您应该没问题。

# php - 使用多线程改进网络爬虫/蜘蛛

> ID：15317606
> 
> 赞同：0
> 
> 时间：2013-03-10T00:38:16.337
> 
> 标签：php, web-crawler

我已经开始学习网络爬虫，并且在一篇文章的帮助下，我在下面构建了这个简单的文章。

它建议使用多线程来改进和使网络爬虫更快。

我想知道是否有人可以帮助我了解有关多线程的更多信息，甚至可以将其应用于下面的爬虫。

此外，如果您有任何其他建议或改进来改进此爬虫，请随时分享。

这是代码：

```
error_reporting( E_ERROR );

define( "CRAWL_LIMIT_PER_DOMAIN", 50 );

$domains = array();

$urls = array();

function crawl( $url )
{
    global $domains, $urls;
    $parse = parse_url( $url );
    $domains[ $parse['host'] ]++;
    $urls[] = $url;

    $content = file_get_contents( $url );
    if ( $content === FALSE )
        return;
    else {
        // do something with content.
    }

    $content = stristr( $content, "body" );
    preg_match_all( '/http:\/\/[^ "\']+/', $content, $matches );

    foreach( $matches[0] as $crawled_url ) {
        $parse = parse_url( $crawled_url );
        if ( count( $domains[ $parse['host'] ] ) < CRAWL_LIMIT_PER_DOMAIN && !in_array( $crawled_url, $urls ) ) {
            sleep( 1 );
            crawl( $crawled_url );
        }
    }
} 
```

在此先感谢您-我将不胜感激所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T02:15:36.343

幸运与否，PHP 不支持多线程。您可以做的是实现异步模式，但这意味着您必须忘记漂亮的单行功能`file_get_contents`并切换到最低级别的页面读取（`fsockopen`然后在非阻塞模式下手动执行所有写入和读取，让其他人执行他们在特定动作需要等待时工作），请参见[此处](http://phplens.com/phpeverywhere/?q=node/view/254)的示例代码。

# node.js - 在窗口 7 上安装 node-xmpp

> ID：15317607
> 
> 赞同：1
> 
> 时间：2013-03-10T00:38:21.040
> 
> 标签：node.js, xmpp, node-xmpp

我`node --version v0.8.22`在 Windows 7 上。我正在尝试`node-xmpp`使用命令安装`npm install node-xmpp`. 我已经安装了 express、log4js 和 socket.io `npm install`，但是 node-xmpp 抛出了以下错误。

```
786 info preuninstall node-xmpp@0.3.2
787 info uninstall node-xmpp@0.3.2
788 verbose true,C:\www\resume-bootstrap\src\node_modules,C:\www\resume-bootstrap\src\node_modules unbuild node-xmpp@0.3.2
789 info postuninstall node-xmpp@0.3.2
790 error node-expat@2.0.0 install: `node-gyp rebuild`
790 error `cmd "/c" "node-gyp rebuild"` failed with 1
791 error Failed at the node-expat@2.0.0 install script.
791 error This is most likely a problem with the node-expat package,
791 error not with npm itself.
791 error Tell the author that this fails on your system:
791 error     node-gyp rebuild
791 error You can get their info via:
791 error     npm owner ls node-expat
791 error There is likely additional logging output above.
792 error System Windows_NT 6.1.7601
793 error command "C:\\Program Files\\nodejs\\\\node.exe" "C:\\Program Files\\nodejs\\node_modules\\npm\\bin\\npm-cli.js" "install" "node-xmpp"
794 error cwd C:\www\resume-bootstrap\src
795 error node -v v0.8.22
796 error npm -v 1.2.14
797 error code ELIFECYCLE
798 verbose exit [ 1, true ] 
```

知道这意味着什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-03T10:50:02.857

您需要确保首先安装了先决条件。查看[https://github.com/TooTallNate/node-gyp的安装说明](https://github.com/TooTallNate/node-gyp)

由于它们有点令人困惑，我将在这里再次列出它们：

1.  卸载已安装的任何 Microsoft Visual C++ 2010 Redistributable。
2.  安装 Python 2.7.3
3.  安装 Microsoft Visual Studio C++ 2010 (Express)
4.  安装 Windows 7 64 位 SDK
5.  安装 Windows SDK 7.1 的编译器更新
6.  安装 Microsoft Visual Studio C++ 2012 for Windows Desktop (Express)
7.  [从http://sourceforge.net/projects/expat/](http://sourceforge.net/projects/expat/)安装 libexpat

这在 64 位 Win7 上非常适合我。如果您使用 32 位版本，则跳过第 4 点和第 5 点。

我希望这能解决你的问题。

# objective-c - 在 NSTableHeaderView 中右键单击了哪一列

> ID：15317612
> 
> 赞同：4
> 
> 时间：2013-03-10T00:39:31.037
> 
> 标签：objective-c, cocoa, nstableview, nstableheaderview

当我右键单击我的表格视图标题 (NSTableHeaderView) 时，我会弹出一个菜单以允许用户更改列颜色。问题是我不知道他们只是“右键单击”了哪一列。关于如何做到这一点的任何想法？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-18T15:36:14.657

最简单的方法是`-menuForEvent:`在`NSTableHeaderView`.

在我的应用程序中，我使用了更通用的解决方案。我向 NSTableHeaderView 添加了一个委托。当请求菜单时，我的班级要求代表验证菜单并将单击的表格列传递给它。然后委托自定义菜单（启用菜单项，根据单击的列设置菜单项状态），并记住在实例变量中单击了哪个列。

**PGETableViewTableHeaderView.h**

```
#import <Cocoa/Cocoa.h>

@protocol PGETableViewTableHeaderViewDelegate <NSObject>
-(void)validateMenu:(NSMenu*)menu forTableColumn:(NSTableColumn*)tableColumn;
@end

@interface PGETableViewTableHeaderView : NSTableHeaderView
@property(weak) IBOutlet id<PGETableViewTableHeaderViewDelegate> delegate;
@end 
```

**PGETableViewTableHeaderView.m**

```
#import "PGETableViewTableHeaderView.h"

@implementation PGETableViewTableHeaderView
-(NSMenu *)menuForEvent:(NSEvent *)event {
    NSInteger clickedColumn = [self columnAtPoint:[self convertPoint:event.locationInWindow fromView:nil]];
    NSTableColumn *tableColumn = clickedColumn != -1 ? self.tableView.tableColumns[clickedColumn] : nil;
    NSMenu *menu = self.menu;
    [self.delegate validateMenu:menu forTableColumn:tableColumn];
    return menu;
}
@end 
```

这很方便：将自定义子类分配给 IB 中的标题视图，然后连接`menu`和`delegate`插座。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T06:10:55.817

一种方法是在自定义 NSTableHeaderView 类中覆盖 rightMouseDown：

```
-(void)rightMouseDown:(NSEvent *)theEvent {
    NSPoint p = [self convertPoint:theEvent.locationInWindow fromView:nil];
    NSInteger selCol = [self columnAtPoint:p];
    NSLog(@"Clicked on header cell is in column: %ld",selCol);
} 
```

# php - 使用 PHP 和 Mysql 每周进行一次随机数据库查询

> ID：15317614
> 
> 赞同：0
> 
> 时间：2013-03-10T00:39:50.800
> 
> 标签：php, mysql, web-applications

我有一个关于狗品种的网站，其中有一个“每日狗”部分。我希望“每日狗”每天显示一次新狗（来自 mysql 数据库）。使用php和mysql，我想操作其实很简单。

```
$connection = mysqli_connect("localhost", "username", "password");

$randomdog = mysqli_query($connection, "SELECT * FROM dogtable WHERE id >= RAND() * (SELECT MAX(id) FROM dogtable) LIMIT 1"));

echo $randomdog 
```

当然，每次重新加载页面时，这都会给我一个随机的狗。我希望 $randomdog 每天只更改一次。

cron 工作会是答案吗？我以前从未实现过，但我在我的网站上安装了 cpanel，所以我认为它不会太麻烦。

如果我要使用 cron 作业，我假设我会保存

```
$connection = mysqli_connect("localhost", "username", "password");

$randomdog = mysqli_query($connection, "SELECT * FROM dogtable WHERE id >= RAND() * (SELECT MAX(id) FROM dogtable) LIMIT 1")); 
```

作为 .php 文件，每天由 cron 作业运行一次，每天更新一次 $randomdog。但是，我怎么能将 $randomdog 传递到一个单独的页面来回显呢？

我之前在这里问过一个类似的问题，答案通常是“存储一个 unixtimestamp，一周后执行，当当前时间 == 时间 + 1 周时再次执行”。

用php不可能吗？它只在用户请求时执行，确定吗？这意味着“时间 + 1 周”变量不可能存储在某处。

无论如何，一定要纠正我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T00:46:18.497

是的，您可以使用 rand() 来获取随机项目。您希望它被播种，以便每次调用它时返回相同的初始 rand 值。你希望它每天播种相同的种子。您可以使用 dayofyear() 来获取一年中的日期 (1-366)。格式为：

```
select * from TABLE order by rand(dayofyear(CURRENT_DATE)) limit 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:46:32.077

您可以创建另一个表，可能只包含将存储当前选择的狗的单行 - 它可能只有一个唯一的 id 指向`dogtable`。

隔夜 cron 作业将更新此表。它不必只是随机的，它可以使用更高级的技术，例如查看网站使用历史来实际选择更受欢迎的狗。

网站将使用此`dogoftheday`表显示当天的狗。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T00:58:26.883

我可以看到很多方法，最简单（不是最简单）的方法如下：

> 使用 cron 作业（你可以很容易地从 cPanel 安装它），cron 作业会随机选择并存储，我建议使用以下方法来存储它
> 
> 1.  在你的表中添加一个新的字段，不为空，默认值为 0，并且只有当天选择的狗的值为 1 *（将通过 cronjob 脚本更新）*
> 2.  如果您对更高级的内容感兴趣，例如保留每日所选狗的历史记录*（例如：每周或每月不选择相同的两次）*，请创建一个新表，您可以在其中放置选择的狗/天，如果您通过以下方式订购时间，今天的狗是最新插入的记录
> 3.  如果您对保留跟踪或任何高级内容不感兴趣，并且希望有自己的方式*（优化一些有关性能和内存的内容）*，请让 cron 作业写入文件

我希望这有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-10T01:28:29.640

1.  创建一个表来存储随机id并初始化它

IE

```
CREATE TABLE random_dog
(
     INT id
);

INSERT INTO random_dog VALUES(RAND()); 
```

1.  检查您是否有正在运行的事件 - 看到[这个](http://dev.mysql.com/doc/refman/5.1/en/events-configuration.html)

2.  创建活动

IE

```
CREATE EVENT
ON SCHEDULE EVERY DAY STARTS '00:00:00'
ON COMPLETION PRESERVE
DO UPDATE random_dog SET id = RAND(); 
```

1.  对于查询，只需使用 random_dog 表

IE

```
SELECT * FROM dogtable 
JOIN random_dog ON (random_dog.id = dogtable.id) 
```

# android - Http请求基本

> ID：15317617
> 
> 赞同：0
> 
> 时间：2013-03-10T00:41:01.417
> 
> 标签：android, mysql, json, http, request

我正在尝试制作一个小的 Android 应用程序，它应该捕获我的网站页面并在我的应用程序上显示内容（纯文本）。

我调用的网站只会发送我需要的消息，所以我必须以某种方式切断 HTTP 标头并显示正文。但我不知道该怎么做，需要你的帮助。如何从基本网站获取文本并将其显示在我的应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:28:37.760

您可以尝试使用这种方法：

```
DefaultHttpClient http_client = new DefaultHttpClient();
HttpGet http_get = new HttpGet( YOUR_SERVER_URL );
HttpResponse response = http_client.execute(http_get);
if( response.getStatusLine().getStatusCode() != 200 ) {
    return "Error: " + response.getStatusLine().getReasonPhrase();
}
BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
String first_line = reader.readLine(); 
```

然后你可以以类似的方式从类似的方式阅读其余的行`reader`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:46:20.310

您可以使用 Apache Httpcomponents 库。 [http://hc.apache.org/](http://hc.apache.org/)。

我用它来与我的 RESTful 服务进行通信。

有关于如何仅获取响应字符串的示例（忽略 http 标头和内容）

# c# - ScrollViewer 不能与 StackPanel 一起使用

> ID：15317618
> 
> 赞同：9
> 
> 时间：2013-03-10T00:41:05.040
> 
> 标签：c#, xaml, windows-runtime, winrt-xaml, scrollviewer

我的页面左侧有一个垂直 StackPanel，其中包含以下元素：

*   1 个文本块
*   1 个带有多个元素的垂直 StackPanel，可填充可用空间

我正在尝试使用**ScrollViewer元素使第二个****StackPanel 可滚动**，但没有成功。如果我将 ScrollViewer Height 定义为某个值，它可以工作，但我不想这样做，因为我希望它填充所有可用的垂直空间。

 **我正在考虑在读取 StackPanel 计算高度的代码中应用 ScrollViewer Height，但这似乎不是正确的做法。我还尝试将**Height**和**ActualHeight**绑定到 StackPanel Height 属性，但没有结果。

```
<ScrollViewer
    Grid.Row="1"
    VerticalAlignment="Top"
    VerticalScrollBarVisibility="Auto"
    HorizontalScrollBarVisibility="Disabled"
    ScrollViewer.VerticalScrollMode="Enabled"
    ScrollViewer.HorizontalScrollMode="Disabled"
    ScrollViewer.ZoomMode="Disabled">
    <StackPanel x:Name="sptest" Orientation="Vertical">
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test1</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test2</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test3</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test4</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test5</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test6</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test7</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test8</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test9</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test10</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test11</TextBlock>
        <TextBlock Style="{StaticResource PageHeaderTextStyle}">test12</TextBlock>
    </StackPanel>
</ScrollViewer> 
```

除了我还有一个 GridView 填充水平可用空间，它自动有滚动条。我没有定义它，它会在必要时出现。奇怪的是 StackPanel 的行为不像我想要的那样。我究竟做错了什么？

**编辑**

我发现了这个[问题](https://stackoverflow.com/questions/802821/how-can-i-get-scrollviewer-to-work-inside-a-stackpanel?rq=1)。它是关于**WPF**而不是 WinRT 但可能是同样的问题。它说：

> 你不能不固定 StackPanel 的高度。它旨在无限期地向一个方向增长。我建议使用不同的面板

我将 StackPanel 更改为 Grid（由于行定义，我不想这样做，因为我只想要一列）但 ScrollViewer 也不起作用。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-10T16:05:05.727

经过漫长的一夜睡眠后，我通过将**父 StackPanel**更改为**Grid**来解决它。我将第二个 StackPanel 保留在 ScrollViewer 元素中，它可以工作。

我不知道为什么当它的父级是 StackPanel 而不是 Grid 时 ScrollViewer 不起作用。如果有人知道为什么，请向我解释。我不想制作一个只有一列和两行的网格，因为这似乎是垂直 StackPanel 的目的。

即使我在不​​知道为什么的情况下解决了它，我希望这个问题可以帮助其他有同样问题的人，如果你正在阅读这篇文章并且你可以解释这个问题，请告诉我......我很想知道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-22T18:52:42.693

堆栈面板是一种容器，它可以随着您添加到其中的子项而不断增长，并为其每个子项提供相等的空间，因此滚动查看器需要一个高度来告诉父项定义空间限制；因此它可以在其指定的区域内运行。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-24T23:14:43.487

我只是给了 ScrollViewer 一个 MaxHeight。我想 ScrollViewer 需要知道它的最大高度是多少，以便确定何时显示滚动条，如果您将它们设置为自动可见性。
我只是在 ScrollViewer 的 MaxHeight 和没有 MaxHeight 的情况下进行了尝试，它只适用于 MaxHeight 属性。
如果我不得不冒险猜测，我会说 Grid 从您设置的属性中知道它的 MaxHeight，但我不确定，这只是一个猜测。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-10T18:21:12.387

我通过使 StackPanel 成为 ScrollViewer 的子级并设置 StackPanel 的高度来完成我的工作**

# ios - 我是否应该同时拥有 Iphone 4 和 Iphone 5 设备进行测试，或者 iphone 5 在 ios 开发中就足够了

> ID：15317619
> 
> 赞同：0
> 
> 时间：2013-03-10T00:41:06.477
> 
> 标签：ios

我最近拿到了 iPhone 5，我在想是否可以丢弃我的旧 iPhone 4。如果应用程序具有相同的 iOS 版本，是否有可能无法在不同的设备上运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:13:13.120

> 鉴于它们具有相同的 ios 版本，应用程序是否有可能无法在不同的设备上运行？

是的。它们有不同的硬件，这意味着它*至少*会有不同的行为，并且在特定硬件上总是存在操作系统错误的可能性。我想到了几件事：

*   **RAM：** iPhone 5 大约有 1 GB，iPhone 4 有 512 MB，3GS 有 256 MB。在 iPhone 3GS 上被杀死的内存密集型应用程序可能在 iPhone 5 上运行良好。
*   **GPU 性能：** iPhone 5 拥有更强大的 GPU；在 iPhone 5 上看起来不错的东西在 iPhone 4 上可能会慢得令人无法接受。
*   **CPU 性能：**速度有所提升，架构也有所提升（`armv7s`vs `armv7`），但最大的不同是 iPhone 5 有两个内核，这意味着它可以在后台线程上进行大量处理，而不会显着影响 UI 线程.
*   **相机：**如果您使用`AVCaptureSession`/`AVCaptureVideoDataOutput`和朋友，请期待在不同设备上的不同行为。最明显的是，iPhone 5 支持 1080p 视频，而 iPhone 4 仅支持 720p，但历史上也存在许多差异：iPhone 3G 仅正确支持`2vuy`/`BGRA`而所有较新的设备都支持`420v`/ `420f`/ `BGRA`。运行 4.1 或 4.2 的 3GS 也有一个错误（我忘记了），请求`420v`会导致挂起，但不设置格式会导致它默认为`420v`并工作。

您还应该在多个操作系统版本上进行测试（理想情况下是所有受支持的操作系统/设备组合，除非这有点贵）。

也就是说，除非您使用仅存在于设备上的功能，否则大多数情况下您都可以使用模拟器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:49:12.347

根据此处发布的问题数量，最大的可能问题是确保您的用户界面在两个不同尺寸的屏幕上正确呈现。

如果您在真正的 iPhone 5 上进行测试，并且您还使用 3.5" iPhone 模拟器测试您的用户界面，我认为您是相当安全的。

tl; dr - 如果您将模拟器用于另一个真实设备，那么您可以安全地拥有一个真实设备。

更新：我想我应该指出，正如其他人所说，更多的设备更好。这实际上取决于应用程序的类型。游戏应该在更多的硬件上进行测试。实用程序应用程序可以在不太真实的设备上进行正确测试。只要你了解你的应用程序的需求和模拟器的局限性，你就可以做你需要的。

商店中有许多从未在任何真实设备上测试过的应用程序。大多数都在一台设备上进行了测试。没有多少人拥有多个设备。每个原始 iPad 应用程序都在没有真正的 iPad 的情况下进行了测试。当时还没有人拥有。

我们都必须面对现实。如果您有设备，那就太好了。如果你不这样做，你尽你所能。

# javascript - 如何设置间隔并同时增加一个值？

> ID：15317627
> 
> 赞同：0
> 
> 时间：2013-03-10T00:42:34.777
> 
> 标签：javascript, jquery

[我尝试使用与此处](https://stackoverflow.com/questions/8366684/jqueryreplacing-images-at-time-intervals)讨论的方法不同的方法来解决问题

**所以我有这样的相关html：**

```
<div id="main-container"></div>
<div id="list-container">
    <ul id="list">
        <li class="thumb"><img src="img/thumb-image1.jpg"></li>
        <li class="thumb"><img src="img/thumb-image2.jpg"></li>
        <li class="thumb"><img src="img/thumb-image3.jpg"></li>
        <li class="thumb"><img src="img/thumb-image4.jpg"></li>
        <li class="thumb"><img src="img/thumb-image5.jpg"></li>
        <li class="thumb"><img src="img/thumb-image6.jpg"></li>
    </ul>
</div> 
```

然后某处有一个 img 文件夹，其中包含 6 个名为：

> image1.jpg image2.jpg image3.jpg image4.jpg image5.jpg image6.jpg

并且使用 jquery，我试图通过以 3 秒的时间间隔操作 css 和列表索引来基本上交换其容器 div 内的图像。所以我的第一个猜测是：

```
$('#list li').each(function(index){

$('#main-container').css({
    'background':'url("img/image'+(index+1)+'.jpg")'
    }); 
```

不幸的是，它没有按我的意愿工作。它只是吐出最后一个索引，即 5，所以显示的图像最终显示为 image6 而不是第一个 image1，然后 3 秒后，image2 和 2secs，image3 将显示，依此类推。

那么如何合并`setInterval()`索引更改以创建图像旋转的效果。

**笔记：**

`<div id="main-container"></div>`只是一个空容器，在动态调用时将用作存储在 img 文件夹中的图像的占位符。

实际上，在 js 文件中，单击缩略图时，下面的代码会起作用。

```
$('#list li').each(function(index){

    $(this).on('click', function(){
        $('#main-container').css({
        'background':'url("img/image'+(index+1)+'.jpg")'
        });
    });
}); 
```

我的目标是，即使未单击缩略图，等效的大图像也应在`#main-container`创建连续幻灯片的内部旋转。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T00:55:15.263

好的，现在您要实际执行的操作已经更清楚了，这就是我建议的方式。这将无限期运行，将`li`标签中的连续图像分配给`#main-container`.

```
(function() {
    // create local scope to isolate common variables
    // get image count and paths from the actual HTML so nothing is hard-coded
    var images = $('#list li img');
    var index = 0;
    var target = $("#main-container");

    function next() {
        var src = images.eq(index).attr("src");
        target.css("background-image", 'url(' + src + ')');
        index++;
        // if we've run out of images, start over
        if (index >= images.length) {
            index = 0;
        }
    }
    // execute the first one immediately, then subsequent ones with setInterval()
    next();
    setInterval(next, 3000);
})(); 
```

工作示例：http: [//jsfiddle.net/jfriend00/RuFBS/](http://jsfiddle.net/jfriend00/RuFBS/)

* * *

提供 HTML 之前的早期答案：

目前尚不清楚您尝试将图像设置在什么位置，但这是一种在间隔计时器上迭代各种图像并将其应用于每个图像的方法`<li>`。如果您想将图像应用于不同的东西，请披露相关的 HTML，以便我们可以看到您尝试定位的内容。这是一种使用间隔计时器循环浏览所有图像的方法：

```
(function() {
    // create local scope to isolate common variables
    var targets = $('#list li');
    var index = 0;
    var interval = setInterval(function() {
        targets.eq(index).css("background-image", "url(img/image" + index + ".jpg)");
        index++;
        if (index >= targets.length) {
            clearInterval(interval);
        }
    }, 3000);
})(); 
```

就个人而言，如果间隔有特定数量的迭代，我倾向于使用`setTimeout()`这样的代替：

```
(function() {
    // create local scope to isolate common variables
    var targets = $('#list li');
    var index = 0;
    function next() {
        targets.eq(index).css("background-image", "url(img/image" + index + ".jpg)");
        index++;
        if (index < targets.length) {
            setTimeout(next, 3000);
        }
    }
    next();
})(); 
```

如果您真的只是想旋转图像`#main-container`（与 无关`#list li`），那么您可以这样做：

```
(function() {
    // create local scope to isolate common variables
    var index = 0;
    var numImages = 6;
    var target = $("#main-container");
    function next() {
        target.css("background-image",  "url(img/image" + index + ".jpg)");
        ++index;
        if (index < numImages) {
            setTimeout(next, 3000);
        }
    }
    next();
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:45:29.757

```
var count = 0;

$('#list li').each(function(index) {
    count += 1;

    $('#main-container').css({
        'background':'url("img/image' + count + '.jpg")';
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:31:20.120

我认为这就是你想要的：

```
var count = 0;
var imgCOUNT = $('#list li').length;
$('#main-container').css({'background-image' : 'url(img/image1.jpg)','transition' : 'background-image 1s','-webkit-transition' : 'background-image 1s','-moz-transition' : 'background-image 1s'});
var interval = setInterval(function() {
    count++;
    var index = count%imgCOUNT+1;
    $('#main-container').css("background-image", "url(img/image" + index + ".jpg)");
}, 3000); 
```

**Firefox 中过渡的替代解决方案**

```
var count = 0;
var imgCOUNT = $('#list li').length;
$('#main-container').css({'background-image':'url(img/image1.jpg)'});
var interval = setInterval(function() {
    count++;
    var index = count%imgCOUNT+1;
    $('#main-container').fadeTo(350,.1,function() {
        $(this).css("background-image", "url(img/image" + index + ".jpg)");
    }).delay(350).fadeTo(350,1);
}, 3000); 
```

# java - 如何从不在包中的 jar 导入 Java 类？

> ID：15317628
> 
> 赞同：3
> 
> 时间：2013-03-10T00:42:41.217
> 
> 标签：java

我有一个 .jar ，其中包含一个我想使用的类： FooBar.class 。此类不在包中，它只是位于 .jar 的根目录中。

我已将 .jar 作为库添加到项目中，但问题是，我不知道如何导入它，因为它不在包中。

如果我只是这样做：`import FooBar;`我收到错误：`. expected`，并且我无法在`FooBar`任何地方使用 class，因为它说`Symbol not found`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:00:12.417

您不能从默认包导入。您（或编写它的人）无论如何都不应该使用默认包。除了非常小的示例程序外，您应该避免使用默认包。

如果它是您的代码，请将其放入一个包中，就像它应该的那样。如果是别人的，如果他们花时间为你装罐，他们可以把它放在一个包裹里。

或者，省略导入，但请记住在编译时将 jar 添加到类路径中。

或者，如果你很懒，并且不在乎忽略所有最佳实践（即，如果这是一个玩具程序等）

```
$ jar -xvf <whatever>.jar 
```

将文件从 jar 解压到当前目录，此时您可以正常使用它们。如果您使用的是 Windows，则可以通过任何为您处理 .zip 文件的程序来执行此操作 - .jar 只是带有清单的 .zip。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:53:05.570

我认为你可以通过反思来做到这一点。

**编辑2：**

好吧，也许你不需要反思。我做了另一个测试，我直接实例化了 Test 并且它有效。正如上面的海报所说，您所要做的就是将 jar 放在您的类路径中，而无需尝试导入类文件。

**编辑：**为什么投反对票？我完全正确。

```
// No package statement here
public class Test {
  public String getMessage() {
    return "Hello World!";
  }
}

$ javac Test.java
$ jar cvf my.jar Test.class

// No import statements needed
public class TestRefl {
  public static void main(String[] args) throws Exception {
    Class c = Class.forName("Test");
    Test t = (Test) c.newInstance();
    System.out.println(t.getMessage());
  }
}

$ javac TestRefl.java
$ java -classpath ".:my.jar" TestRefl
$ Hello World! 
```

您甚至不必从默认包中导入该类。现在你有了它的一个实例，所以你可以做任何你想做的事情。

# mysql - 使用 Codeigniter 和 MySQL 处理多对多关系的最佳方法？

> ID：15317629
> 
> 赞同：1
> 
> 时间：2013-03-10T00:42:48.433
> 
> 标签：mysql, codeigniter, many-to-many

我真的找不到任何有用的东西。我正在使用 Codeigniter 和 MySQL 制作自己的管理面板，一切都已完成，除了多对多关系。

主表是产品表。我有 5 个多对多关系（类别、材料、颜色、标签、城市）。它们每个都有 5 个表，其中包含这些列（ID 和类别/标签/城市的名称......），当然，在它们之间有一些表，它们同时具有 Product 和另一个表的 ID。

首先，我想在一个表中列出所有产品，并且在列中我想有类别、材料、标签等列，并且在对应的单元格中，所有项目都用逗号列出...

这是一排的样子。

| 身份证 | 姓名 | 说明 | 1 类，2 类，... | 材料 1，... | 标签1，标签2，标签3，标签4，... |

我希望你能理解我。接下来，希望 Add 函数看起来很简单，但我猜 Update 函数应该真的很棘手，所以任何帮助也很感激，尽可能快地解决它。我想首先我应该检查所有选定的项目以检查链接表中是否有任何新条目，然后检查链接表中是否有任何未选中的条目以将其删除。如何做到这一点最优化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T08:19:55.867

这不是直接的 codeigniter 事情，更多的是 SQL 的事情。

管理显示是简单的部分。您可以加入所有相关表格和`GROUP BY`您的表格，`product_id`因此您的结果集只显示一个产品一次。然后你可以使用[`GROUP_CONCAT`MySQL 的功能对](http://dev.mysql.com/doc/refman/5.1/en/group-by-functions.html#function_group-concat)每行的相关表文件进行分组。

其性能实际上取决于应用程序及其用法。例如，对于我们拥有的应用程序，它可以更快、更灵敏地在每行返回的每行运行多个查询`product_id`来获取其他信息，而不是运行一个查询来一次获取所有信息。因此，您必须对其进行测试。

随着更新，是的，它可能会很乱。一种方法是删除所有现有的`product_id`，然后添加所有提交的。另一种是检查现有的与提交的，只添加新的并删除不匹配的。我希望这对你有意义:)

# ruby-on-rails - 在 Rails 中缓存基于页面的路由？

> ID：15317634
> 
> 赞同：0
> 
> 时间：2013-03-10T00:43:15.593
> 
> 标签：ruby-on-rails, caching

我正在尝试在我的 Rails 应用程序中实现缓存。我的控制器中的视图会根据传入的参数生成一个非常大的项目列表。这个大列表不会经常更改，所以我想根据路由缓存它。

**例子：**

配置/路由.rb：

```
get "policies/available/:country" => 'policy#available', :format => :json 
```

策略控制器.rb：

```
class PolicyController < ApplicationController

  def available
    country = params[:country]
    @policies = VideoPolicy.available_in_country country
    respond_to do |format|
      format.html
      format.json{
        render :json => @policies.to_json
      }
    end
  end
end 
```

调用“polices/available/US”会缓存该路由的 JSON 结果，然后调用“polices/available/CA”会缓存*第二*个路由的 JSON 结果。（也就是每条路由缓存一个结果，但用于同一个视图/控制器。）

我将如何做到这一点？某种形式的[页面/动作/片段缓存](http://guides.rubyonrails.org/caching_with_rails.html)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:10:30.433

页面缓存可能是您正在寻找的。

```
class PolicyController < ApplicationController
  cache_page :available

  ...additional code...
end 
```

当可用的操作被命中时，Rails 将在公共目录中创建一个静态 JSON 文件，`policies/available/US.json`假设您的路由是`policies/available/US.json`.

因为现在公共目录中有一个与 Rails 路由匹配的文件，所以 Web 服务器将访问静态文件并丢失 Rails 应用程序。

然后，您可以`expire_page`在更新或创建操作后使缓存失效。例如

```
def update
  @policy = VideoPolicy.find(params[:id])
  if @policy.update_attributes(params[:video_policy])
    expire_page "/policies/available/#{@policy.country}.json"
  end
end 
```

# java - 两个多项式的乘法

> ID：15317636
> 
> 赞同：0
> 
> 时间：2013-03-10T00:43:33.323
> 
> 标签：java, integer, multiplication

嘿伙计们，我一直在研究这段代码，但我现在遇到的问题是它只是将多项式 1 乘以多项式 2 的第一项

所以 2x + 2 * 5x + 5 = 10x2 + 10x

而不是 10x2 + 20x + 10

这是执行乘法的代码：

```
public Polynomial multiply( )
{
    Polynomial res = clone();
    for(Monomial tmp = res.head; tmp != null; tmp = tmp.next)
        res.addTerm(tmp.coeff *= head.coeff, tmp.deg += head.deg);
    double num = 0.5;
    for(Monomial tmp = res.head; tmp != null; tmp = tmp.next)
        tmp.coeff *= num;
    return res;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:42:42.663

您的算法似乎与多项式相乘时使用的算法不太相似。如果您有两个多项式并将它们视为单项式序列（正如您似乎正在做的那样），那么您有 (A1,A2) * (B1,B2)，那么您想要的结果看起来像 (A1*B1, A1 *B2, A2*B1, A2*B2) 简化前。请注意，乘积是原始多项式的叉积，包含的单项式比任何一个多项式开始时都多。您使用简单的`for`循环永远不会产生这样的产品。

沿着嵌套`for`循环线的东西可能是有意义的，其中您迭代第一个多项式中的所有单项式，然后在该循​​环中运行一个内部`for`循环，该循环产生一个新的单项式，该单项式是该单项式和每个单项式的乘积依次来自第二个多项式的单项式。

毕竟，您可以比较度数以通过组合单项式来简化结果。

# python - 如何在两个类之间共享数据

> ID：15317637
> 
> 赞同：0
> 
> 时间：2013-03-10T00:43:44.063
> 
> 标签：python, oop, user-interface, python-2.7, tkinter

**问题**

有没有办法让两个类同时相互继承？

**背景**

我目前正在开发一个 Socket Server 项目。在这个项目中，我有两个类，一个`Server`类，一个`GUI`类。他们的目的是不言自明的。但是，我显然需要让这两个类相互通信。在程序中，我先声明`Socket_Server`类，然后再声明`GUI`类。

我问了一个类似的问题，[How to Access Functions from Methods in Python](https://stackoverflow.com/q/15139000/1993598)，但从未得到令人满意的回答。请尝试回答。

**代码和错误**

在`GUI`课堂上，我有一个名为`self.message.`It 的文本框，用于向所有客户端发送消息。我试图通过使用这种语法来继承这个类：

```
class Socket_Server(GUI.messageFun): 
```

接下来，GUI 类继承自 Socket_Server——

```
class GUI(Frame, Socket_Server): 
```

第二个继承`GUI(Socket_Server)`工作正常，但第一个继承失败。

按钮的命令是这样的

```
 self.send = Button (self.messageFrame, text = "Send",
                        command = lambda: new_server.send_cmd()) 
```

`new_server`是`Socket_Server`类的一个实例。

当前的错误消息是这样的：

```
Socket Created
Socket Bind Complete
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Python27\lib\lib-tk\Tkinter.py", line 1410, in __call__
    return self.func(*args)
  File "D:\Python Programs\Sockets\IM Project\Server\Server GUI InDev Class.py", line 129, in <lambda>
    command = lambda: new_server.send_cmd())
  File "D:\Python Programs\Sockets\IM Project\Server\Server GUI InDev Class.py", line 82, in send_cmd
    message = self.message.get("0.0",END)
AttributeError: Socket_Server instance has no attribute 'message' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T02:07:18.850

这个问题的标题与你一开始提出的问题不同（而且更准确一点），但它们都不符合你想要的。您需要的是沟通不同类的两个实例；那不是继承。

当你使用继承时，你应该问自己是否每个 X 也是一个 Y：

*   是每`Employee`一个`Person`？*是的*
*   是每`Person`一个`Employee`？*不*
*   是每`Employee`一个`Car`？*不*

考虑到这个概念，您可能会看到第三个示例与`GUI`和之间的关系最相似`Server`。这是因为你真正的问题是：

*   实例是否`GUI`使用`Server`对象？

如果答案是肯定的，那么服务器应该是你的`GUI`类的一个属性。在以下示例中，您可以看到`GUI`调用`Server`对象的方法，但反之则不然：

```
import Tkinter as tk
import threading
import socket

class Server():
    def __init__(self):
        self.addresses = [('localhost', 12345)] # All addresses to send data
    def sendtoall(self, data):
        for address in self.addresses:
            self._send(address, data)
    def _send(self, address, data):
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.connect(address)
            sock.sendall(data)
        finally:
            sock.close()

class GUI(tk.Tk):
    def __init__(self, server):
        tk.Tk.__init__(self)
        self.server = server
        self.entry = tk.Entry(self)
        self.button = tk.Button(self, text="Send", command= self.sendmessage)
        self.entry.pack()
        self.button.pack()
    def sendmessage(self):
        message = self.entry.get()
        threading.Thread(target=self.server.sendtoall, args=(message,)).start()

server = Server()
gui = GUI(server)
gui.mainloop() 
```

**编辑：**此代码看起来更像是客户端而不是服务器，因此将其重命名为更类似于您想到的概念可能是个好主意（例如，`Notifier`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:10:03.943

您遇到的问题是面向对象。你需要去看看继承是如何工作的，对象是如何交互的，所以第四个是一个有点沉重的主题，需要在一篇文章中介绍，并且需要经验来理解它。

关于 tkinter 的旁注，命令属性是 Button 需要参考。这样每次单击按钮时都会调用该函数。

```
self.send = Button (self.messageFrame, text = "Send",
                        command = new_server.send_cmd()) 
```

也就是说，命令等于 new_server.send_cmd() 的结果。

```
self.send = Button (self.messageFrame, text = "Send",
                    command = new_server.send_cmd) 
```

这是说 command 等于对 send_cmd 方法的引用。

# php - 允许发送邀请的 Facebook 选项卡

> ID：15317638
> 
> 赞同：0
> 
> 时间：2013-03-10T00:43:52.300
> 
> 标签：php, javascript, facebook

我正在尝试制作一个可以选择邀请多个朋友的 Facebook 选项卡。这一点我用 Facebook API 很容易实现

我的问题是请求中发送的 URL。我的标签的网址是以下类型： [h​​ttps ://www.facebook.com/my_fan_page/app_id_app](https://www.facebook.com/my_fan_page/app_id_app)

但邀请重定向到以下网址： [http ://apps.facebook.com/id_app/](http://apps.facebook.com/id_app/)

如果在获得“喜欢”之前没有封面 tubiese 并且在第二个网址中没有“喜欢”按钮，这将不是问题

有什么方法可以将邀请发送到第一个 URL？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T14:28:13.870

当用户接受邀请时，即通过单击应用程序请求通知进入您的应用程序画布页面，Facebook 在“request_ids”参数中发送逗号分隔的 id。

检查 request_ids 是否设置，您可以将用户重定向到所需的页面选项卡 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T13:42:20.870

# windows-8 - indexeddb 按多个索引排序

> ID：15317642
> 
> 赞同：2
> 
> 时间：2013-03-10T00:44:26.460
> 
> 标签：windows-8, indexeddb

我是 IndexedDb 的新手，我在 Windows 8 应用程序中使用它。我正在尝试按多个索引对查询结果进行排序。换句话说，我有一个对象存储，其中包含所有具有日期和姓氏属性的对象。我想先按日期排序，然后按姓氏排序。有没有办法用 IndexedDB 做到这一点？还是我必须使用 JavaScript 对查询结果进行排序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T01:03:27.947

在 indexeddb 中，复合索引（[数组 keyPath](http://www.w3.org/TR/IndexedDB/#dfn-steps-for-extracting-a-key-from-a-value-using-a-key-path)）用于如下多重排序：

```
objectStore.createIndex('date, last', ['date', 'last']); 
```

不幸的是，IE10 不支持复合索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T23:39:52.513

由于 IE10 不支持索引的数组键路径，因此您必须自己进行过滤。如果您想手动滚动它，我将专注于创建一个索引，该索引将是您最大的键（因此具有最大不同值的键）并让 IDB 对此进行查询，然后编写您自己的过滤器`onsuccess`光标行走方法内的其余项目。

或者，您可以查看第 3 方 IDB 包装器来执行此操作，[db.js](https://github.com/aaronpowell/db.js)有一个流畅的查询 API，它允许您将索引查询与自定义回调过滤结合起来（[参见此处](https://github.com/aaronpowell/db.js/blob/master/tests/specs/query.js#L580-L599)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T09:27:35.067

正如您在其他答案中看到的，IE 10（以及 Windows 8 应用程序）不支持数组 KeyPaths。这意味着您只能使用一个索引直接使用 API 对数据进行排序。

你可以试试我的库[linq2indexeddb](http://linq2indexeddb.codeplex.com)，它提供了一个类似 LINQ 的接口来查询数据。它还支持多重排序。还有一个 Windows 8 [nuget 包](http://nuget.org/packages/Linq2IndexedDBWin8/)。

# opengl - 法线贴图问题

> ID：15317646
> 
> 赞同：4
> 
> 时间：2013-03-10T00:45:04.473
> 
> 标签：opengl, glsl

我已经遵循了许多关于法线贴图的在线教程，并且在一定程度上已经让它工作了......

除非多边形垂直于视图矢量，否则我似乎无法使其正常工作。

我制作了一个视频来说明这一点，因为图片不足以说明我的意思。

[http://www.youtube.com/watch?v=9D4o_zy-61s](http://www.youtube.com/watch?v=9D4o_zy-61s)

我已经发布了我的着色器：

顶点：

```
#version 400
layout (location = 0) in vec3 attribPosition;
layout (location = 1) in vec3 attribNormal;
layout (location = 2) in vec2 attribTexCoord;
layout (location = 3) in vec3 attribTangent;
layout (location = 3) in vec3 attribBinormal;

uniform mat4 mvp;
uniform mat4 mvm;
uniform mat3 nm;
uniform vec3 lightPos_World;

out vec2 vUvs;
out vec3 lightPos_Eye;
out vec3 vertexPos_Eye;
out vec3 normalDir_Eye;
out vec3 normalDir_World;
out mat3 tbnMatrix;

void main()
{
    vUvs = attribTexCoord;
    normalDir_World = attribNormal;
    normalDir_Eye = (nm * attribNormal);
    vec3 t = nm * attribTangent;
    vec3 n = nm * attribNormal;
    vec3 b = nm * cross(n,t);

    mat3 tbnMatrix = mat3(t.x, b.x, n.x,
                          t.y, b.y, n.y,
                          t.z, b.z, n.z);

    vertexPos_Eye = (mvm * vec4(attribPosition,1.0)).xyz;
    lightPos_Eye = (mvm * vec4(lightPos_World,1.0)).xyz;

    gl_Position = mvp * vec4(attribPosition,1.0);
} 
```

分段：

```
#version 400
layout( location = 0 ) out vec4 frag_main;
struct PointLight{
    vec3 position;
    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
    float shininess;
    float intensity;
};

uniform PointLight light[2];
uniform sampler2D colorTexture;
uniform sampler2D normalTexture;
uniform mat4 mvm;
//  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//  FLAGS - all flags start false;
//  [0][0] = colour map
//  [0][1] = normal map
//  [0][2] = unused
//  [0][3] = show normal map in colour channel
//  [1][0] = use tangent space
//  [1][1] = unused
//  [1][2] = unused
//  [1][3] = unused
//  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
uniform bvec4 flags[2];

in vec3 vertexPos_Eye;
in vec3 normalDir_World;
in vec3 normalDir_Eye;
in vec2 vUvs;
in mat3 tbnMatrix;

void main(){

    uint numLights=2;

    vec3 colorFragment;
    if(flags[0][0]){
        colorFragment = texture(colorTexture,vUvs).xyz; 
    }else{
        colorFragment = vec3(0.5);  
    }

    vec3 normalMapNormal = (texture(normalTexture,vUvs).rgb * 2) - 1;
    vec3 normalDir;
    if(flags[0][1]){
        normalDir = normalize(normalDir_Eye);
    }else{
        normalDir =  normalize(normalMapNormal.rgb);
    }

    vec4 outColor = vec4(1);
    outColor.xyz = vec3(0);

    float duller = 1/numLights;
    for(int i = 0;i< numLights;i++){
        vec3 lightPos_Eye = (mvm * vec4(light[i].position,1.0)).xyz;
        vec3 lightDir_Eye = normalize(lightPos_Eye - vertexPos_Eye);
        vec3 lightDir_Tangent = lightDir_Eye * tbnMatrix;

        vec3 vertDir_Eye = normalize(-vertexPos_Eye);
        vec3 vertDir_Tangent = vertDir_Eye * tbnMatrix;

        vec3 halfDir_Eye = normalize(vertDir_Eye + lightDir_Eye);
        vec3 halfDir_Tangent = halfDir_Eye * tbnMatrix;

        vec3 Ia = colorFragment.xyz * light[i].ambient;
        vec3 Id;
        vec3 Is;

        // tangent space
        Id = (colorFragment.xyz * light[i].diffuse ) * max(dot(lightDir_Tangent, normalDir), 0);
        Is = light[i].specular * pow(max(dot(halfDir_Eye, normalDir), 0), light[i].shininess*2);
        // eye space
        //Id = (colorFragment.xyz * light[i].diffuse ) * max(dot(lightDir_Eye, normalDir), 0);
        //Is = light[i].specular * pow(max(dot(halfDir_Eye, normalDir), 0), light[i].shininess*2);

        outColor.xyz += (Ia + Id + Is);

    }

    if(flags[0][3]){
        outColor.xyz = normalDir;
    }
    frag_main = (outColor);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T11:30:51.047

我注意到这条线：

```
vec3 b = nm * cross(n,t); 
```

但应该是：

```
vec3 b = cross(n,t); 
```

无需`nm`再次乘以，因为`n`和`t`位于所需的相机空间中。

另一件事：

```
lightPos_Eye = (mvm * vec4(lightPos_World,1.0)).xyz; 
```

因为`lightPos_World`在世界空间中（顾名思义），你应该将它乘以 *world_matrix* 之类的东西，而不是*模型视图*。或者只是`lightPos_Eye`在应用程序代码中计算并将其发送到顶点着色器。

管理所有这些不同的向量并将它们放在一个适当的空间中是非常困难的。有时视觉错误非常微妙且难以发现。

# batch-file - 如何批量更改子文件夹中的文件扩展名

> ID：15317647
> 
> 赞同：10
> 
> 时间：2013-03-10T00:45:09.880
> 
> 标签：batch-file, cmd, renaming

我对命令提示符很陌生，直到 1 天前才开始使用它。

例如，我在某个位置有一个文件夹，`C:\Users\Administrator\Desktop\Images`在该文件夹内大约有 650 个子文件夹，每个子文件夹包含大约 20 张图像，混合了 JPG 和 PNG。我正在为 CMD 寻找一个命令行，它将遍历所有子文件夹并将每个`.png`文件更改为一个`.jpg`文件。

我做了一些研究并找到了一些信息，但是很难理解和理解，我仍然无法做到。我想保留文件名，但是将每个文件扩展名从 a 更改`.png`为 a `.jpg`。

我知道对于 1 个文件夹，该行类似于`ren *.png *.jpg`. 但是，这不会将更改应用于子文件夹。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-10T01:05:28.607

如果我正确理解您只想将文件从 重命名`.png`为`.jpg`，而不是转换它们，您可以使用以下批处理代码：

```
@ECHO OFF
PUSHD .
FOR /R %%d IN (.) DO (
    cd "%%d"
    IF EXIST *.png (
       REN *.png *.jpg
    )
)
POPD 
```

* * *

更新：我在[这里](https://stackoverflow.com/a/245862/1380680)找到了一个更好的解决方案，您可以直接从命令行运行（使用`%%f`而不是`%f`在批处理文件中使用它）：

```
FOR /R %f IN (*.png) DO REN "%f" *.jpg 
```

请注意，上面将处理当前目录及其子目录。如有必要，您可以指定任意目录作为根目录，如下所示：

```
FOR /R "D:\path\to\PNGs" %f IN (*.png) DO REN "%f" *.jpg 
```

# ios - 如何将 UIAlertView 添加到我的 completeTransaction 方法

> ID：15317652
> 
> 赞同：0
> 
> 时间：2013-03-10T00:45:57.233
> 
> 标签：ios, objective-c, xcode, uialertview

一旦用户完成（消耗品）IAP，我想要一种非常简单的方法来添加 UIAlertView。现在我有一个方法可以在输出中显示交易已完成。此外，他们购买的“硬币”被添加到他们的总硬币中。我想知道是否有一些简单的代码可以添加到 completeTransaction 方法中以显示 UIAlertView ，它只是通知他们他们的事务已完成，然后是“关闭”按钮。我在下面包含了我的 completeTransaction 方法和我正在使用的 provideContent 方法，以防代码应该放在哪里。如果这不是要走的路，请让我知道什么会更好。我对此很陌生，所以我通常可以遵循简单的逐步答案。任何帮助是极大的赞赏！

```
- (void)completeTransaction:(SKPaymentTransaction *)transaction {
NSLog(@"completeTransaction...");

[self provideContentForProductIdentifier:transaction.payment.productIdentifier];
[[SKPaymentQueue defaultQueue] finishTransaction:transaction];
}

- (void)provideContentForProductIdentifier:(NSString *)productIdentifier {

//Product 1
if ([productIdentifier isEqualToString:@"POC1"]) {
     // unlock product 1
    unsigned long long currentCoins = [[[NSUserDefaults standardUserDefaults] valueForKey:@"coins"] unsignedLongLongValue];
    unsigned long long newTotalCoins = currentCoins + 500;
    [[NSUserDefaults standardUserDefaults] setValue:[NSNumber numberWithUnsignedLong:newTotalCoins] forKey:@"coins"];
    [[NSUserDefaults standardUserDefaults] synchronize];

} else {
    [_purchasedProductIdentifiers addObject:productIdentifier];
    [[NSUserDefaults standardUserDefaults] setBool:YES forKey:productIdentifier];
    [[NSUserDefaults standardUserDefaults] synchronize];
}

[[NSNotificationCenter defaultCenter]
 postNotificationName:IAPHelperProductPurchasedNotification
 object:productIdentifier userInfo:nil]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:49:45.983

交易完成后，输入此代码（如果成功0

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Done" message:@"Transaction complete" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
[alert show]; 
```

# sql - 从 Microsoft Visual Studio 查询数据库 (SQL Server)

> ID：15317655
> 
> 赞同：0
> 
> 时间：2013-03-10T00:46:11.523
> 
> 标签：sql, sql-server, vb.net, linq

这里是初级程序员，我一直被这个问题困扰，即通过 Microsoft Visual Studio 查询我的数据库（SQL Server）并实际返回我想要的结果的元组。

例如..如果我想要特定项目 ID 的扇区，我会在子程序中像这样查询它，然后调用子程序

```
Public Sub testing()
    projectID = 1

    Dim sqlQueryObject = (From a In db.Project1 Where a.ProjectID = projectID
                          Select a.Sector)   'Using LINQ

    'Now have the object (works fine)
    'The Issue is getting the actual sector value from this query...in which I've tried a couple of things

End Sub 
```

1.  `dim somestring as string = Cstr(sqlQueryObject)`
2.  `dim somestring as string = Ctype(sqlqueryobject, string)`

两者都不起作用，如果`projectID`1 的扇区被命名`Zero`- 我如何对其进行编程以返回此值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:26:37.550

您给出的 LINQ 查询将返回一个列表，其中包含满足 Where 子句中条件的元素。要使查询仅返回单个值，您需要将、`.Single()`或应用于查询。`.SingleOrDefault()``.First()``.FirstOrDefault()`

例如，以下将返回单个标量值或返回类型的默认值。

```
Dim sector = (From a In db.Project1 
              Where a.ProjectID = projectID
              Select a.Sector
             ).SingleOrDefault() 
```

有关这些方法的更多信息可以在[这个](https://stackoverflow.com/questions/1544322/returning-a-single-value-with-linq-to-sql)问题中找到。

# dart - 侦听端口并使用 Web 套接字推送数据的 TCP 套接字服务器

> ID：15317659
> 
> 赞同：2
> 
> 时间：2013-03-10T00:46:31.540
> 
> 标签：dart, dart-io

我看到有一个新版本的 dart:io。如何使用新的 v2 dart:IO 创建一个套接字服务器，它侦听端口以获取新数据并通过 Web 套接字将接收到的数据推送到其订阅的客户端？

我有一个 java 和 ac# 桌面应用程序（tcpClient），我想在特定端口上向我的 dart 服务器发送一个字符串（json 或 xml）。该字符串应该回复到我的 tcpClient 并使用 Web Sockets 推送到所有其他订阅的客户端（浏览器）。

我有以下内容，但是如何访问已发送到该特定套接字的数据？

```
import 'dart:io';

main() {ServerSocket.bind("127.0.0.1", 5555).then((ServerSocket socket) {
  socket.listen((Socket clientSocket) {

    //how to access data (String) that was 
    //send to the socket from my desktop application
  });
});
} 
```

* * *

**编辑：**也许我应该把问题分成两部分。

如何在 Dart 中创建一个监听特定端口数据的服务器？

在 node.js 中，可以使用如下内容：

```
var net = require('net');

var HOST = '127.0.0.1';
var PORT = 6969;

// Create a server instance, and chain the listen function to it
// The function passed to net.createServer() becomes the event handler for the 'connection' event
// The sock object the callback function receives UNIQUE for each connection
net.createServer(function(sock) {

    // We have a connection - a socket object is assigned to the connection automatically
    console.log('CONNECTED: ' + sock.remoteAddress +':'+ sock.remotePort);

    // Add a 'data' event handler to this instance of socket
    sock.on('data', function(data) {

        console.log('DATA ' + sock.remoteAddress + ': ' + data);
        // Write the data back to the socket, the client will receive it as data from the server
        sock.write('You said "' + data + '"');

    });

    // Add a 'close' event handler to this instance of socket
    sock.on('close', function(data) {
        console.log('CLOSED: ' + sock.remoteAddress +' '+ sock.remotePort);
    });

}).listen(PORT, HOST);

console.log('Server listening on ' + HOST +':'+ PORT); 
```

*   [http://www.hacksparrow.com/tcp-socket-programming-in-node-js.html](http://www.hacksparrow.com/tcp-socket-programming-in-node-js.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T01:09:31.323

这是一个部分答案，它仅解决如何创建将侦听客户端 WebSocket 连接的服务器。

你见过 WebSocketTransformer 类吗？

[WebSocketTransformer](http://api.dartlang.org/docs/releases/latest/dart_io/WebSocketTransformer.html)

我还没有机会尝试这个 - 但我认为它是这样的：

```
HttpServer.bind(...).then((server) {
     server.transform(new WebSocketTransformer()).listen((webSocket) => ... );
}); 
```

另请参阅Dart 邮件列表上的[讨论。](https://groups.google.com/a/dartlang.org/forum/#!topic/misc/Zi7a4S6sR5o)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T01:57:43.137

您可以编写一个桥接软件来转换来自 TCP 套接字的传入数据，并在必要时处理数据。然后通过打开的 WebSocket 连接发送/广播数据。

这是一项涉及阅读[websocket 规范](https://www.rfc-editor.org/rfc/rfc6455)文档的工作。然后编码。

# android - 具有多项选择的 ListView

> ID：15317663
> 
> 赞同：1
> 
> 时间：2013-03-10T00:47:15.603
> 
> 标签：android, listview

我想实现一个`ListView`可以处理多种选择并检测点击的方法。我希望每个列表都包含一个复选框，因此如果您单击复选框，它将记住选择，如果您单击该行中的文本，它将转到另一个活动。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:49:38.877

您需要`ListView`使用自定义创建一个`Adapter`. 这是带有复选框和可单击项的列表视图的代码：

```
private class MySecondAdapter extends ArrayAdapter<MiniTask>
{   
    private ArrayList<MiniTask> list;

    public MySecondAdapter(Context context, int textViewResourceId, ArrayList<MiniTask> miniTaskList) 
    {
        super(context, textViewResourceId, miniTaskList);
         this.list = new ArrayList<MiniTask>();
         this.list.addAll(miniTaskList);
    }

    public View getView(final int position, View convertView, ViewGroup parent)
    {
        miniTask = miniTaskList.get(position);
        ViewHolder holder = new ViewHolder();
        {
            LayoutInflater inflator = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = inflator.inflate(R.layout.check_list_item_new, null);

            holder.title = (TextView) convertView.findViewById(R.id.tvItemTitle);
            holder.commentsPicturesButton = (ImageView) convertView.findViewById(R.id.iAddCommetOrPicture);
            holder.commentsPicturesButton.setTag(position);
            holder.commentsPicturesButton.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) 
                {
                     Intent intent = new Intent(getApplicationContext(), PicturesAndCommentsActivity.class);
                     intent.putExtra(TasksListActivity.KEY_ID, task.getId());
                     intent.putExtra("mini_task_text", miniTask.getTitle());
                     startActivity(intent);
                }
            });
            holder.selected = (CheckBox) convertView.findViewById(R.id.cbCheckListItem);
            holder.selected.setTag(position);
            holder.selected.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v)
                {    
                    {                               
                        Log.d(TAG, "pressed the checkbox: " + v.getId() + " in position: " + position + " tag: " +v.getTag() +" and item from array: " + miniTaskList.get(position) );
                        CheckBox checkbox = (CheckBox) v;
                        miniTaskList.get(position).setSelected(checkbox.isChecked());   
                        numOfCheckedMiniTasks = 0;
                        for(int i=0;i<miniTaskList.size();i++)
                        {
                             miniTask = miniTaskList.get(i);
                             if(miniTask.isSelected())
                             {
                                numOfCheckedMiniTasks ++;
                             }
                        }
                        int percent = (int)(numOfCheckedMiniTasks * 100.0f) / miniTaskList.size();
                        Log.d(TAG, "the percentage is: " +percent);
                        tasksRepository.get(tasksRepository.indexOf(task)).setMiniTasksPercentageComplete(percent);
                    }
                }
            });     
        }

        holder.title.setText(miniTask.getTitle());
        holder.selected.setChecked(miniTask.isSelected());
        return convertView;
    } 
```

和`ViewHolder`：

```
 static class ViewHolder 
{
     TextView title;
     CheckBox selected;
     ImageView commentsPicturesButton;
} 
```

和行布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content" 
android:background="@drawable/try2"
android:orientation="vertical" >
<LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <CheckBox 
        android:id="@+id/cbCheckListItem"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_marginLeft="10dp"
        android:layout_marginBottom="10dp"
        android:background="@drawable/checkbox_checklist_selector" 
        android:button="@drawable/checkbox_checklist_selector" />
    <TextView
        android:id="@+id/tvItemTitle"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="5dp"
        android:paddingRight="10dp"
        android:paddingTop="13dp"
        android:text="@string/checklist_item_string"
        android:textColor="@color/my_darker_gray" />
  </LinearLayout>

<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="right"
    android:paddingTop="6.5dp" >

    <ImageView
        android:id="@+id/iAddCommetOrPicture"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:clickable="true"
        android:contentDescription="@drawable/comment_or_photo_icon"
        android:src="@drawable/comment_or_photo_icon" />
</RelativeLayout> 
```

# winapi - 窗口未聚焦/活动时处理击键

> ID：15317664
> 
> 赞同：1
> 
> 时间：2013-03-10T00:47:15.713
> 
> 标签：winapi, window, focus, keystroke, accelerator

`CTRL+SHIFT+UP`即使窗口没有聚焦/活动，我也需要在 WinAPI 中处理组合键 ( )。

我该怎么做（如果可能，我更喜欢不使用[WinApi Hooks](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644960%28v=vs.85%29.aspx)的解决方案）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T08:15:30.690

[首先，您需要使用RegisterHotKey](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646309%28v=vs.85%29.aspx)函数注册一个“系统范围的”热键。即使您的应用程序被最小化、没有聚焦或隐藏，它也能正常工作。

```
RegisterHotKey(hWnd, KEY_ID, MOD_CONTROL | MOD_SHIFT, VK_UP);
// check for errors, the function will fail if the hot key is already registered 
```

`hWnd`是将接收 WM_HOTKEY 消息的窗口句柄。`KEY_ID`是热键的标识符。`MOD_CONTROL | MOD_SHIFT`对于 Ctrl+Shift。`VK_UP`向上箭头键。

其次，您需要在窗口过程中处理 WM_HOTKEY 消息。

```
LRESULT CALLBACK WndProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam) {
    switch (uMsg) {
        ...
        WM_HOTKEY:
        // handle the hot key here
        ...
    }
} 
```

如果您的应用程序没有窗口并且`hWnd`为 NULL，那么您需要在消息循环中处理 WM_HOTKEY。

```
MSG msg = {0};
while (GetMessage(&msg, NULL, 0, 0) != 0)
{
    if (msg.message == WM_HOTKEY) {
        // handle the hot key here
    }
} 
```

# c# - 使用 AE.Net.Mail 在 C# 中连接到 outlook.com

> ID：15317665
> 
> 赞同：0
> 
> 时间：2013-03-10T00:47:24.010
> 
> 标签：c#, .net, imap, outlook.com

我无法使用 AE NET Mail IMAP 库连接到任何邮件帐户来检索电子邮件。我前一阵子用过它，它很好，但我又回来了，在一个新项目中，它不适用于任何电子邮件帐户。我有以下代码：

```
 using (var client = new AE.Net.Mail.ImapClient(
            "mail.live.com",
            "myemail@outlook.com",
            "password_SV",
            ImapClient.AuthMethods.Login, 993, false
            ))
        {
            client.SelectMailbox("INBOX");
            AE.Net.Mail.MailMessage[] mailmessage = client.GetMessages(0, 5, false, true);

            foreach (AE.Net.Mail.MailMessage msg in mailmessage)
            {
                collection.Add(new Message()
                {
                    Id = msg.MessageID,
                    Sender = msg.Sender,
                    Subject = msg.Subject,
                    Content = msg.Body
                });
            }
            client.Logout();
            client.Disconnect();

            list.ItemsSource = collection; 
```

但由于某种原因，它只是继续加载（旋转加载光标）并且整个 UI 都阻塞了。等待 10 分钟后 - 绝对没有任何反应。它只是不断加载，加载和加载。我究竟做错了什么？我们如何检索邮件？我也尝试过其他帐户，例如 gmail，以及我自己的帐户，但同样的问题。我们如何从 outlook.com 检索邮件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T07:16:25.840

我无法连接到 Outlook，但我现在可以连接到我的其他邮件帐户。大多数示例的文件夹名称全部大写，但这对我不起作用。

我改为`.GetMessages("INBOX");`并且`.GetMessages("Inbox");`它起作用了。

# c - 如何初始化和使用 C11 _Atomic 变量？

> ID：15317666
> 
> 赞同：4
> 
> 时间：2013-03-10T00:47:27.320
> 
> 标签：c, atomic, c11

是否允许以下​​代码？

```
_Atomic(unsigned int) a = 1;
if (a == 0) {

} 
```

C11 规范 (n1570) 在 6.3.2.1p2 中说：

> 如果左值具有原子类型，则该值具有左值类型的非原子版本。

所以这似乎说没关系。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-10T07:49:24.630

~~不，这样的初始化是不行的。您必须使用`ATOMIC_VAR_INIT`来初始化一个原子对象。从 C11 7.17.2.1 开始：~~

 ~~> ATOMIC_VAR_INIT 宏扩展为一个标记序列，适用于初始化与值兼容的类型的原子对象。未使用 ATOMIC_VAR_INIT 显式初始化的具有自动存储持续时间的原子对象最初处于不确定状态；但是，具有静态或线程本地存储持续时间的对象的默认（零）初始化保证产生有效状态。~~ 

~~否则，该对象将处于有效状态，但“不确定”，因此您不知道它具有哪个值。~~

这个状态已经随着 C17 的变化而改变，它取消了用`ATOMIC_VAR_INIT`. 现在按照问题中的说明进行初始化是可以的，而且是正确的方法。

正如有人建议的那样，另一种可能性仍然是使用 进行动态初始化`atomic_init`，但是无论您在哪里，都肯定首选经典初始化。

# c++ - 如果瓶颈是大矩阵乘法，我可以使用 MEX 文件加速我的 MATLAB 代码吗？

> ID：15317669
> 
> 赞同：1
> 
> 时间：2013-03-10T00:47:39.527
> 
> 标签：c++, matlab

我有一个项目，需要我在 while 循环内多次设置两个大矩阵的乘法。对于较大的矩阵，代码运行速度会非常慢。

我很好奇此时使用 mex 和 .cpp 文件是否真的可以提高程序的速度。MATLAB内置的矩阵乘法不是已经很不错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T02:27:13.680

如果没有关于您的问题的更多具体信息，任何人都无法说出具体的内容。在某些情况下，MEX 函数肯定可以提高性能，而在某些情况下则不能。矩阵乘法是 Matlab 的优势之一，简单地将矩阵乘法移动到 MEX 函数中不太可能使您的代码运行得更快。

也就是说，有一些提高性能的一般策略：

1.  **[分析](http://www.mathworks.com/help/matlab/ref/profile.html)您的代码。** 确保矩阵乘法实际上是罪魁祸首。根据我自己的经验，性能问题可能来自多种来源，包括对临时变量的粗心使用。这应该永远是你的第一步。

2.  如果您的矩阵具有任何类型的结构，请利用它。[Matlab 对稀疏](http://www.mathworks.com/help/matlab/ref/sparse.html)矩阵和[带状](http://www.mathworks.com/help/matlab/ref/spdiags.html)矩阵有很好的支持。如果您的矩阵具有结构，则使用它可以大大降低矩阵运算的成本。

3.  如果您确实编写了 MEX 函数，请尝试将整个`while`循环移动到 MEX 函数中，以避免多次越过 Matlab/MEX 边界。重复调用 MEX 函数可能会非常昂贵，而且在 MEX 函数内执行整个循环通常同样容易（或更容易），尤其是在循环是简单迭代的情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T03:29:18.683

首先，我假设这些矩阵彼此相关，随着时间的推移或类似的情况而演变。如果从一个实例到下一个实例的每个矩阵完全不相关，这将无济于事。但是，如果它们是相关的，我会想到矩阵的变化可能很小甚至稀疏。给定基本方程 C(i) = A(i)*B(i) 如果创建增量矩阵 Da = A(i+1) - A(i) Db = B(i+1) - B(i)那么当然 C(i+1) = C(i) + Da*B(i) + A(i)*Db + Da*Db 其中 C(i) 是已知的。如果 Da 和 Db 很小或很稀疏，这 3 个矩阵乘法可能会快得多。它们甚至可能是正交的并且最后一项被丢弃，或者它的结果在数量级上被忽略了。只是一个想法。Matlab 矩阵问题有很多工具，不要放弃 Matlab！

# java - Java 编译器错误找不到符号。为什么会出现这种情况？

> ID：15317671
> 
> 赞同：2
> 
> 时间：2013-03-10T00:48:06.333
> 
> 标签：java

我正在尝试做出以下声明： InvertedFile.invertedFile.add(d.getAccessionNumber(), d.getWords());

它应该创建一个新的 reverseList 对象并将其添加到链表（invertedfile）中。我收到以下错误：

> 发现 2 个错误：文件：C:\Users\Name\Database.java [行：21] 错误：C:\Users\Name\Database.java:21：找不到符号符号：方法 add(int,WordList) 位置：类 java.util.LinkedList 文件：C:\Users\Name\InvertedFile.java [行：39]
> 错误：C:\Users\Name\InvertedFile.java:39：找不到符号符号：方法 add(int,java. lang.String) 位置：类 java.util.LinkedList 错误位置：

```
public int add( Document d ){
    int accessNumber = d.getAccessionNumber();

    //Stores document text in InvertedFile data structure
    InvertedFile.invertedFile.add(d.getAccessionNumber(), d.getWords());

    //Adds document to accessNumber index of LinkedList of documents
    if (documentList.size()<accessNumber){
    documentList.add(accessNumber,d);
    docNumber++;
    return accessNumber;
    }
    else return -1;
} 
```

倒置文件类

```
import java.util.*;

public class InvertedFile implements InvertedFileInterface {

  public static LinkedList<InvertedList> invertedFile = new LinkedList<InvertedList>();

  public InvertedFile(){

  }

  //Takes in docAccessionNumber and WordList and updates/creates invertedList files for each word in wordlist
  public boolean add(int docNumber, WordList w){
    String words = w.toString();
    StringTokenizer parseWords = new StringTokenizer(words);
    //Checks to see if InvertedFile already contains invertedLists for the given words, if so adds docID to existing lists
    while (parseWords.hasMoreTokens()){
      String checkWord = parseWords.nextToken();
    for (int k = 0; k<invertedFile.size()-1; k++){
      InvertedList temp = invertedFile.get(k);
      if (checkWord.equals(temp.getWord())){
        temp.add(docNumber);
      }
    }
    }
    //Checks to see if invertedFile contains lists for given words, if not, makes a new one and adds docNumber to the list
    String wordsToCheck = w.toString();
    StringTokenizer processWords = new StringTokenizer(wordsToCheck);
    while (processWords.hasMoreTokens()){
      String word = processWords.nextToken();
      Boolean notFound = true;
    for (int k = 0; k<invertedFile.size()-1; k++){
      if (word.equals(invertedFile.get(k).getWord())){
        notFound = false;
      }
    }
    if (notFound){
      InvertedFile.invertedFile.add(docNumber, word);
    }
    }
    Database.docNumber++;
    return true;
  }

  public int numLists(){
    return invertedFile.size();
  }

  public int numTokens(){
    return invertedFile.size();
  }

  public InvertedList getInvertedList( String word ){
    for (int k = 0; k<invertedFile.size()-1; k++){
      if (word.equals(invertedFile.get(k).getWord())){
        return invertedFile.get(k);
      }
  } 
```

倒排列表类：

```
import java.util.*;

public class InvertedList implements InvertedListInterface {
  public static LinkedList<Integer> documentsContainingWord = new LinkedList<Integer>();

  public String targetWord;

  public InvertedList( String word ){
    String targetWord = word;

//Scans documents in database for word
    for (int j = 1; j<=Database.documentList.size(); j++){
      Document temp = Database.documentList.get(j);
      WordList words = temp.getWords();
      //If document wordList contains word, and LinkedList doesn't already have that doc listed, add to LinkedList
      //Already sorted since processed from 1 to size
      if (words.contains(word) && !documentsContainingWord.contains(temp.getAccessionNumber())){
        documentsContainingWord.add(temp.getAccessionNumber());
      }
    }
  }

  //Creator method
  public InvertedList(int docNumber, String word){
    String targetWord = word;
    documentsContainingWord.add(docNumber);
  }

  public String getWord(){
    return targetWord;
  }

  //Adds docNumber to sorted position of LinkedList documentsContainingWord
  public boolean add( int docNumber ){
    //If document already in list, don't add
    if (!documentsContainingWord.contains(docNumber)){
      //Places number at sorted position on list
      //If document should be placed at index 0 (has smallest accessionNumber)
      if (docNumber<documentsContainingWord.get(0)){
        return documentsContainingWord.offerFirst(docNumber);
      }
      //If document should be placed in middle
      if (docNumber<documentsContainingWord.get(documentsContainingWord.size()) && docNumber>documentsContainingWord.get(0)){
      int temp = 1;
      int index = 0;
        while (temp<docNumber){
          temp = documentsContainingWord.get(index);
          index++;
        }
        documentsContainingWord.add(index+1, docNumber);
        return true;
      }

      //If document should be placed at end
      if (docNumber>documentsContainingWord.get(documentsContainingWord.size())){
        return documentsContainingWord.offerLast(docNumber);
      }

    //Else document number already in inverted list
      else {
        return false;
  }
  }
    return false;
  }

  public LinkedList getList(){
    return documentsContainingWord;
  }

 Thank you!! 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T00:52:53.887

你的静态invertedFile 变量是一个LinkedList，你试图在它上面调用一个InvertedFile 方法，这是没有意义的。您只能在 LinkedList 变量上调用 LinkedList 可用的方法（检查 API）。

我认为您的错误是使变量 reverseFile 静态。使其成为*私有*实例变量，并让任何需要使用 InvertedFile 的类创建该类的实例并调用实例上的方法。

# tcp - pyside：tcp服务器端口参数被忽略？

> ID：15317672
> 
> 赞同：0
> 
> 时间：2013-03-10T00:48:08.943
> 
> 标签：tcp, pyside

我正在尝试在端口号 502 上建立 TCP 服务器 - 但无法在 PySide 中完成。

我的代码：

```
self.tcpServer = QtNetwork.QTcpServer(self)
self.tcpServer.listen(QtNetwork.QHostAddress.Any,502) 
```

但是之后

```
self.tcpServer.serverPort() 
```

报告不是 502 的端口。PySide 似乎忽略了我的端口号 502。

有人有这方面的工作示例或任何建议吗？

在此先感谢，布莱克。

# php - 从一个表中获取 HTML 选择选项并使用 PHP 将其发布到另一个表

> ID：15317674
> 
> 赞同：0
> 
> 时间：2013-03-10T00:48:20.040
> 
> 标签：php, html, mysql, select

```
<select name="Select_Category" >
    <option value="Selected"> --- Category ---</option>
    <?php
    $Result=mysql_query("SELECT * FROM category");
    while($Row=mysql_fetch_array($Result))
    {
    $GetCategoryId=$Row['Id'];
    $GetCategoryName=$Row['Category_Name'];
    ?>
    <option value="$GetCategoryId"><?php echo $GetCategoryName; ?></option>
    <?php } ?>
    </select> 
```

这就是我从表类别中获取 html 选择值的方式...但是当我将其插入产品表中的 db 时，colum category_id 显示值 = 0，我需要所选选项的类别 id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:53:35.483

您需要在 while 循环中生成 HTML 输出 - 而不是跨单独的 php 代码片段。

```
...
while (...) {
  $id = $row['id'];
  $name = $row['name'];
  echo '<option value="' . $id . '">' . $name . '</option>';
}
.... 
```

**编辑：**

```
<select name="Select_Category" >
  <option value="Selected">--- Category ---</option>
  <?php
    $Result = mysql_query("SELECT * FROM category");
    while ($Row = mysql_fetch_array($Result)) {
      $GetCategoryId = $Row['Id'];
      $GetCategoryName = $Row['Category_Name'];
      echo '<option value="' . $GetCategoryId . '">' . $GetCategoryName . '</option>';
    }
  ?>
</select> 
```

# api - 如何使用 Site Catalyst (Omniture) 获得某个部分下最受欢迎的页面？

> ID：15317675
> 
> 赞同：1
> 
> 时间：2013-03-10T00:48:23.480
> 
> 标签：api, analytics, adobe-analytics

我想使用站点催化剂 api 来获取给定站点部分下最受欢迎的页面（具有最大浏览量的页面）？让我用一个例子更好地解释一下。

我的网站有多个频道（新闻/期刊/书籍/活动等）。每个频道下都有许多页面。我想要一个 api 调用，它将获得最受欢迎的新闻页面或期刊页面或书籍页面等。

我像这样将数据传递给sitecatalyst..

```
s.pageName = o_title;
s.channel = o_structure
s.prop1 = o_iden 
```

其中 o_title 具有新闻页面或期刊页面等的页面标题。o_structure 指的是“新闻”或“期刊”或“书籍”等。

目前我只能获得整个网站上最受欢迎的页面。如果有人可以帮助我找到每个部分最受欢迎的页面，我将不胜感激。

谢谢， 拉格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T04:22:36.863

我假设您已经知道使用 Omniture API 的基础知识，如何排队报告并查找状态并获取它等等......这是一个基本的 REST 数据字符串，用于获取按以下方式分解的站点部分（s.channel）以页面浏览量为指标的页面名称 (s.pageName)。您将使用`Report.QueueRanked`API 方法，并且需要指定 rsid(s) 以从中获取数据和日期范围。

```
{
  "reportDescription": {
    "reportSuiteID":"RSID",
    "dateFrom":"YYYY-MM-DD",
    "dateTo":"YYYY-MM-DD",
    "metrics":[   
      {
        "id":"pageViews"
      }
    ],
    "sortBy":"pageViews",
    "elements":[
      {
        "id":"siteSection"
      },
      {
        "id":"page"
      }
    ]
  }
} 
```

# python - Reorder fields in form from modelform_factory

> ID：15317677
> 
> 赞同：1
> 
> 时间：2013-03-10T00:48:27.457
> 
> 标签：python, django, django-forms

I have a base model class called `CommonInfo` with props like name, email, password etc.

Then have a `User` model (subclass of `CommonInfo`) with things like profile image, username, and integer field called reputation.

Now I want to display a form for registration without the reputation field, so my view function looks like this :

```
def reg(request):
    form = modelform_factory(User, exclude=('reputation'))
    return render(request, 'reg.html', {
        'form': form,
    }); 
```

But the thing is that fields in a form are ordered just like in models (name, email, password, profile_image, username).

I want to reorder those fields (put username on the first place, then name and email) but I don't want to create class for this form, simply because the model and the form are very to similar (only difference is the reputation field)

How can I achieve this ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:56:07.097

Quickest way to do this is :

```
class RegForm(forms.ModelForm):
    class Meta:
       model=User
       fields=['username', 'name', 'email' ...] 
```

# javascript - Customizing ShareThis message works on Twitter, but not any other method?

> ID：15317679
> 
> 赞同：3
> 
> 时间：2013-03-10T00:48:42.200
> 
> 标签：javascript, html, facebook, twitter, sharethis

I'm trying to get a custom message to post to social networks using ShareThis. I'm using the st_title tag for the custom message. I removed all og metadata, reading that that might compete with it. For some reason, the Twitter share is working as expected, while all other shares do not use the custom message.

Any ideas for things to try here? I'm not sure what else to try. Thank you -

Here's the code, whittled down for generalness to the Twitter (working) and Facebook (not working) shares, below. If it's helpful and okay to post, my actual test page is [https://critter.co/home/test](https://critter.co/home/test) (click on the 'Instant Inspiration' text to get a modal where you share inspiration).

```
<span class="st_facebook_hcount" st_url="https://critter.co" st_title="Do not overrate what you have received, nor envy others. He who envies others does not obtain peace of mind. - Buddha" displaytext="share" st_processed="yes"><span style="text-decoration:none;color:#000000;display:inline-block;cursor:pointer;" class="stButton"><span><span class="stMainServices st-facebook-counter" style="background-image: url(https://ws.sharethis.com/images/facebook_counter.png);">&nbsp;<img src="https://ws.sharethis.com/images/check-big.png" style="position: absolute; top: -7px; right: -7px; width: 19px; height: 19px; max-width: 19px; max-height: 19px; display: none;"></span><span class="stArrow"><span class="stButton_gradient stHBubble" style="display: inline-block;"><span class="stBubble_hcount">3</span></span></span></span></span></span>

<span class="st_twitter_hcount" st_url="https://critter.co" st_title="Do not overrate what you have received, nor envy others. He who envies others does not obtain peace of mind. - Buddha" st_via="CritterCoApp" displaytext="share" st_processed="yes"><span style="text-decoration:none;color:#000000;display:inline-block;cursor:pointer;" class="stButton"><span><span class="stMainServices st-twitter-counter" style="background-image: url(https://ws.sharethis.com/images/twitter_counter.png);">&nbsp;<img src="https://ws.sharethis.com/images/check-big.png" style="position: absolute; top: -7px; right: -7px; width: 19px; height: 19px; max-width: 19px; max-height: 19px; display: none;"></span><span class="stArrow"><span class="stButton_gradient stHBubble" style="display: inline-block;"><span class="stBubble_hcount">2</span></span></span></span></span></span> 
```

# php - 项目排名，使用 Reddit 排名算法按置信度排序

> ID：15317686
> 
> 赞同：8
> 
> 时间：2013-03-10T00:49:46.130
> 
> 标签：php, algorithm, sorting, ranking

我有兴趣使用这个[排名类](https://gist.github.com/91media/1478806)，根据[Evan Miller](http://www.evanmiller.org/how-not-to-sort-by-average-rating.html)的一篇文章来对我拥有的有赞成票和反对票的表格进行排名。我有一个非常类似于 Stack Overflow 上/下投票系统的系统，用于我正在开发的活动网站，通过使用这个排名类，我觉得结果会更准确。我的问题是如何按功能“热度”订购？

```
private function _hotness($upvotes = 0, $downvotes = 0, $posted = 0) {
    $s = $this->_score($upvotes, $downvotes);
    $order = log(max(abs($s), 1), 10);

    if($s > 0) {
        $sign = 1;
    } elseif($s < 0) {
        $sign = -1;
    } else {
        $sign = 0;
    }

    $seconds = $posted - 1134028003;

    return round($order + (($sign * $seconds)/45000), 7);
} 
```

我想每次用户投票时，我都可以在我的表中有一列重新计算新投票的热度数据，并在主页上按该列排序。但我有兴趣在结合上述功能时更即时地执行此操作，我不确定这是否可能。

来自 Evan Miller，他使用：

```
SELECT widget_id, ((positive + 1.9208) / (positive + negative) - 
                   1.96 * SQRT((positive * negative) / (positive + negative) + 0.9604) / 
                          (positive + negative)) / (1 + 3.8416 / (positive + negative)) 
       AS ci_lower_bound FROM widgets WHERE positive + negative > 0 
       ORDER BY ci_lower_bound DESC; 
```

但我宁愿不在 sql 中进行此计算，因为如果我在多个页面上使用此代码等，我觉得这很混乱且难以更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-18T09:45:51.490

访问任何内容（阅读、写作、排序、比较等）的相应“帖子”表非常快，因此依赖数据库是非临时数据存储的“最即时”替代方案（内存/会话仍然更快，但从逻辑上讲，不能用于存储此信息）。

您应该更担心构建一个好的排名算法来提供您想要的结果（您提出两个不同的系统，提供不同的结果）并努力使整个代码和代码-数据库通信尽可能高效。

原则上，具有迭代简单命令的小代码为这种情况提供了最快和最可靠的解决方案。例子：

1.  每次投票时都会调用排名功能（如您提出的第一个或任何其他建立在您想要的排名规则上的功能）。它写入“帖子”表中的相应列（查询越简单越好：您可以根据需要创建一个复杂的排名系统，但尝试依赖 PHP 而不是查询）。

2.  每次需要在帖子之间进行比较时，都会使用简单的 SELECT 读取“帖子”表，按排名对记录进行排序（您可以有各种“评估列”（例如，赞成票、反对票、进一步考虑）；但是最好有一个具有最终排名的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-23T07:37:12.483

你是对的，这样的查询也相当混乱和昂贵。

即时混合 PHP/MySQL 是一个坏主意，因为您必须为所有帖子选择值并计算热度，然后选择最热的列表。极其昂贵。

您应该考虑将至少部分计算保存到数据库中。绝对命令应该进入数据库。计算一些东西并在每次保存/更新时只保存一次总是更好，而不是每次显示它时都计算。尝试通过计算保存/更新的顺序而不是每次计算热度来对您将节省多少时间进行基准测试。好消息是订单永远不会改变，除非有人赞成/反对你保存到数据库中的赞成票/反对票，对于标志也是如此。

即使您将符号保存到数据库中，由于发布的时间戳参数，您仍然无法避免即时计算。

我会看看它有什么不同以及它在哪里产生了影响，并且每隔 x 时间使用 CLI 脚本计算热度，仅适用于那些至关重要的脚本，每 y 时间它所产生的影响较小。

采用这种方法，您将仅在必要时重新计算热度。这将使您的应用程序更加高效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T04:27:13.753

我不确定您的 DB 和 Schema 是否可行，但是您是否考虑编写用于自定义排序的 UDF？

stackoverflow 的一篇文章讨论了如何在[此处执行此操作。](https://stackoverflow.com/questions/9339338/mysql-creating-a-user-defined-function-for-a-custom-sort)

# sql - Combine the stored procedure and SQL query into one SQL statement

> ID：15317687
> 
> 赞同：1
> 
> 时间：2013-03-10T00:49:58.697
> 
> 标签：sql, postgresql, plpgsql

I am a beginner in SQL and I don't know how to solve this question. How to combine the following SQL query and the stored procedure into a single SQL query. This is a PostgreSQL query and function. Any help is appreciated.

The following query calls a stored procedure/function for each value of the query:

```
 SELECT t.trj_id, T2.trj_id, Similar_trj_woffset(t.trj_id, T2.trj_id) 
 FROM   transitions T1, 
        transitions T2 
 WHERE  T1.w_s = T2.w_s 
 AND T1.w_e = T2.w_e 
 AND T1.trans_id <> T2.trans_id 
```

The stored procedure/function is:

```
create or replace function similar_trj_woffset(
  IN t1 as integer,
  IN t2 as integer,
  OUT score as integer,
  OUT offset as integer
) AS $$
declare 
off_set integer :=0;
score  integer := 0;
cou    integer;
time1  integer;
time2  integer;
dist   integer;
begin
for off_set in 0..10 LOOP
       time1 := 0;
       time2 := 0 + off_set;
       cou := 0;
       while time2 < 100 Loop 
          select vec_length(P.x-P2.x,P.y-P2.y,P.z-P2.z) into dist
          from AtomPositions P, AtomPositions P2
          where P.trj_id  = t1
            and   P2.trj_id = t2
            and   P.t = time1
            and   P2.t = time2;
        if dist < cuto`enter code here`ff then
            cou : = cou + 1;
        time1 := time1 + 1;
        time2 := time2 + 1;
    end loop
    if cou > score then
       score := cou ;
       offset := off_set;
    end if;
    off_set := off_set + 1;
end loop;

end $$ language plpgsql; 
```

Can some one tell me how to merge the query and the stored procedure into one single SQL query.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T07:38:23.047

要调用此函数，将返回的记录拆分为单独的列：

```
SELECT t.trj_id, t2.trj_id, (similar_trj_woffset(t.trj_id, t2.trj_id)).*
FROM   transitions t1
JOIN   transitions t2 USING (w_s, w_e)
WHERE  t1.trans_id <> t2.trans_id 
```

请注意函数调用周围的括号。
我还重写了查询以使用正确的 ANSI JOIN 语法和简化的等值连接条件 ( `USING`)，并删除了虚假的大写字母。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:53:08.477

你不应该合并它们是你的基本答案。代码在函数中的一个目的是可以从多个查询中调用它并在一个地方进行维护。当查询已经在每次迭代中调用函数时，合并两者没有意义。

您期望从这样做中获得什么，因为简单地移动代码不会有任何积极意义？

实际上，如果任何其他查询使用它，如果您删除它，它们就会中断。

# list - style specific unordered list without affecting other ul's

> ID：15317688
> 
> 赞同：0
> 
> 时间：2013-03-10T00:50:00.837
> 
> 标签：list, unordered

This is doing my nut in and ruining my weekend.

I found this great expandable jquery vertical navigation menu. The problem is on other pages i have unordered lists and the unordered list style for the jquery vertical menu effects all the other unordered lists and i dont want that. The html and inline css etc is this..........

```
ul{list-style: none; padding: 0; margin: 0;}
#nav {float: left; width: 280px; border-top: 1px solid #999; border-right: 1px solid #999; border-left: 1px solid #999; margin: 15px 0;}
#nav li a {display: block; padding: 10px 15px; background: #ccc; border-top: 1px solid #eee; border-bottom: 1px solid #999; text-decoration: none; color: #000;}
#nav li a:hover, #nav li a.active {background: #999; color: #fff;}
#nav li ul {display: none;}
#nav li ul li a {padding: 10px 25px; background: #ececec; border-bottom: 1px dotted #ccc;}
      <ul id="nav">
    <li><a href="#">Item 1</a>
      <ul>
        <li><a href="#">Sub-Item 1 a</a></li>
        <li><a href="#">Sub-Item 1 b</a></li>
        <li><a href="#">Sub-Item 1 c</a></li>
      </ul>
    </li>
    <li><a href="#">Item 2</a>
      <ul>
        <li><a href="#">Sub-Item 2 a</a></li>
        <li><a href="#">Sub-Item 2 b</a></li>
      </ul>
    </li>
    <li><a href="#">Item 3</a>
      <ul>
        <li><a href="#">Sub-Item 3 a</a></li>
        <li><a href="#">Sub-Item 3 b</a></li>
        <li><a href="#">Sub-Item 3 c</a></li>
        <li><a href="#">Sub-Item 3 d</a></li>
      </ul>
    </li>
    <li><a href="#">Item 4</a>
      <ul>
        <li><a href="#">Sub-Item 4 a</a></li>
        <li><a href="#">Sub-Item 4 b</a></li>
        <li><a href="#">Sub-Item 4 c</a></li>
      </ul>
    </li>
  </ul> 
```

i tried changing the css ul to `#nav ul{list-style: none; padding: 0; margin: 0;}` but this doesnt seem to work. please help this me out someone. cheers.

teddy

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T00:58:15.613

通常，当您下载 JQuery 小部件或 thingamabob 时，它会出现在一个文件夹中，并附有有关如何使用它的示例！但我只是在这里猜测你没有直接从 JQuery UI 得到这个？

在任何情况下，尝试将您的菜单包装到一个 DIV 中，ID = "Nav"...

然后，您页面内的其他 UL 应继承您在上面声明的默认 ul 样式。

# ios - iOS iPhone looking for a fast logging of timestamped integers to data file implementation

> ID：15317689
> 
> 赞同：0
> 
> 时间：2013-03-10T00:50:07.320
> 
> 标签：ios, objective-c, multithreading, logging, file-io

I'm looking for suggestions/implementations of how to create a comma separated log file on an iPhone when my data comes at a relatively fast rate (200 times per second). I expect to capture the timestamp and 2-3 integer numbers for each data point. Over a 15 minute period, there would be 15*60*200 = 180,000 rows of data, each one having a timestamp, a few integers and a newline character.

I want to make sure that writing of this data to disk happens in the correct sequential order.

My current implementation has been optimized for data coming in at 1 data point per second, and may not be very efficient for "fast" data. **How can I tweak my code** to make sure that it can run in a background thread without taking too much resources for each write? Alternatively, **is there a fast "log to data file" implementation out there that I can just give numbers to and ask it for a log file at a later point?**

```
 NSString *appDataFile ;
    NSFileHandle *aFileHandle;

-(NSString*)dataFilePath
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];

    appDataFile = [documentsDirectory stringByAppendingPathComponent:@"Data"];
    aFileHandle = [NSFileHandle fileHandleForWritingAtPath:appDataFile];
    return appDataFile;
}

//creates a new log file for each app run, or appends to existing log
-(void)writeStringToDataFile:(NSString *)csvLine
{

    if(aFileHandle)
    {
        //telling aFilehandle what file write to
        [aFileHandle truncateFileAtOffset:[aFileHandle seekToEndOfFile]]; //setting aFileHandle to write at the end of the file
        [aFileHandle writeData:[csvLine dataUsingEncoding:NSUTF8StringEncoding]];

    }else{
        NSData* headers = [@"timestamp,waveform amplitude,score, connection, event\n" dataUsingEncoding:NSUTF8StringEncoding];

        //clear the old log file
        NSError *error = nil;
        NSFileManager* fileManager =  [NSFileManager defaultManager];
        [fileManager removeItemAtPath:[self dataFilePath] error:&error];

        //create CSV headers
        aFileHandle = [NSFileHandle fileHandleForWritingAtPath:appDataFile];
        [headers writeToFile:appDataFile atomically:YES];

        aFileHandle = [NSFileHandle fileHandleForWritingAtPath:appDataFile];
        //telling aFilehandle what file write to
        [aFileHandle truncateFileAtOffset:[aFileHandle seekToEndOfFile]]; //setting aFileHandle to write at the end of the file
        [aFileHandle writeData:[csvLine dataUsingEncoding:NSUTF8StringEncoding]];

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T01:28:15.323

一个明显的变化是删除不必要的调用来截断您要编写的每一行的文件。打开文件时，只需将句柄移到末尾一次。

下一轮更改将是使用 C 代码而不是 Objective-C。用于`fopen`打开文件。用于`fputs`编写 C 字符串。

另一个要检查的地方是您如何构建`csvLine`. 使用`stringWithFormat`很慢。使用 . 获取低级别并将每个单独的值写入 C 字符串`fputs`。无需格式化。无需转换为 NSData。

还要看看你是如何做时间戳的。如果你把一个转换成一个`NSDate`，`NSString`你会浪费很多时间。

这是一个重要的建议 - 如果时间如此紧迫，请在内存中构建一个大的可变字符串，然后在完成后将整个内容一次性写入文件。这将在时间关键阶段切断文件 I/O。

利用 Instruments 找出真正的瓶颈在哪里。没有它，您可能会优化错误的代码。

# python - Python 的 NLTK 文档

> ID：15317690
> 
> 赞同：1
> 
> 时间：2013-03-10T00:50:09.023
> 
> 标签：python, nltk

我在哪里可以找到 NLTK 的离线文档？它不在 usr/share/doc 中，我主要在其中找到 Python 模块的文档。并且没有可以安装的 nltk-doc 包。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T01:55:44.723

好的，所以它绝对没有任何包装。然而它可以被建造。所以首先：

```
sudo apt-get install python-epydoc 
```

这是构建文档所必需的。然后我制作了这个脚本来为你自动化构建过程：

```
#!/bin/bash

NLTK_VERSION=$(python -c 'import nltk; print nltk.__version__')
NLTK_URL=$(python -c 'import nltk; print nltk.__url__')
EPYDOC_OPTS = --name=nltk --navlink="nltk ${NLTK_VERSION}"\
              --url=${NLTK_URL} --inheritance=listed --debug

# Rebuild from scratch
[[ -e ~/python-nltk-docs ]] && rm -rf ~/python-nltk-docs

mkdir ~/python-nltk-docs
epydoc ${EPYDOC_OPTS} -o ~/python-nltk-docs /usr/share/pyshared/nltk 
```

这会将 html 文档放入`~/python-nltk-docs`以供您查看。我基本上是从他们的[文档 Makefile](https://code.google.com/p/nltk/source/browse/trunk/nltk/doc/Makefile)中提取出来的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T10:53:34.343

这是我所做的，从他们的 Github 获取 NLTK 网站代码。这样我也可以在 API 文档上进行“搜索”。

[https://github.com/nltk/nltk.github.com](https://github.com/nltk/nltk.github.com)

# java - Adding data from a SQLite column

> ID：15317692
> 
> 赞同：0
> 
> 时间：2013-03-10T00:50:18.320
> 
> 标签：java, android, sqlite, android-sqlite

I'm, trying to add a credit score from multiple records of an SQLite table.

Each record has a column called credit score, I want to add them all together but I'm having trouble.

Here is the code:

```
String[] projection2 = { BorrowMeTable.COLUMN_CREDIT_SCORE };
Cursor databaseCursor2 = getContentResolver().query(uri, projection2,
        null, null, null);
int number  = 0;
if (databaseCursor2 != null) {
    databaseCursor2.moveToFirst();
    while (databaseCursor2.moveToNext()) { 
        number = number + databaseCursor2.getInt(
                databaseCursor2.getColumnIndexOrThrow(
                        BorrowMeTable.COLUMN_CREDIT_SCORE));
    }
}
Log.d("SCORE", Integer.toString(number)); 
```

The problem is the `while` statement, when it is in place it doesn't pull any data. When I remove it, it pulls the correct data but only from one record.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T00:58:33.853

在 SQLite 中使用 sum 函数

```
Cursor cursor = sqliteDatabase2.rawQuery(
    "SELECT SUM(COLUMN_CREDIT_SCORE) FROM BorrowMeTable", null); 
```

您可以在 ContentProvider 中将 URI 匹配为不同的 URI

然后简单地获取标量值：

```
if(cursor.moveToFirst()) {
    return cursor.getInt(0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T03:09:55.197

使用 do->while 从第一条记录开始

```
 do{
    number = number + databaseCursor2.getInt(
            databaseCursor2.getColumnIndexOrThrow(
                    BorrowMeTable.COLUMN_CREDIT_SCORE));
}while (databaseCursor2.moveToNext()); 
```

# python - 迭代一系列值的子集的Pythonic方法？

> ID：15317697
> 
> 赞同：0
> 
> 时间：2013-03-10T00:51:45.150
> 
> 标签：python, celery

我有一个类似于：

```
def long_running_with_more_values(start, stop):
    headers = get_headers.delay(start, stop)
    insert_to_db.delay(headers) 
```

该功能是对从网络并行请求的数据进行批处理。get_headers + insert_to_db 正在向消息堆栈触发，并最终由 celery 工作人员处理，因此不会阻塞执行。

它必须处理开始和停止之间的每个数字，但可以将其拆分为部分（范围）。

我发现当范围为 ~20000 时，操作 get_headers 是最佳的，其中 range = (stop - start)

我想知道如何将任意范围拆分为 20000 个组并通过该函数运行每个组，因此我最终会以不同的开始和停止值多次调用该函数，但仍总体覆盖前一个范围。

因此，对于 1 和 100000 的 start 和 stop 的起始值，我希望 get_headers 被调用 5 次，如下所示：

```
[1,20000][20001,40000][40001,60000][60001,80000][80001,100000] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:03:59.593

```
def long_running_with_more_values(start, stop):
    while start < stop:
        if stop - start < 20000:
            headers = get_headers.delay(start, stop)
            break
        else:
            headers = get_headers.delay(start, start + 20000)
            start += 20000
    insert_to_db.delay(headers) 
```

请注意，它`headers`只会存储最后一次调用的返回值`get_headers.delay()`。您可能需要将代码更改为`headers += get_headers.delay(start, stop)`. 如果不知道该`get_headers.delay()`方法的返回值是什么，我真的无法判断。

# php - Looking for a PHP Template Engine similar to the phpBB3.0 Template System

> ID：15317699
> 
> 赞同：-1
> 
> 时间：2013-03-10T00:52:21.640
> 
> 标签：php, xml, json, template-engine, phpbb3

There are so many template engines out there. However, I am looking for something simple, fast and easy like the the phpBB3.0 Template System. Something simple like

```
$template->set_filenames(array(
'body' => 'your_template_file.html' 
```

));

With similar templates using {L_SOME_VARIABLE} like output. I do not want to install phpbb because of the overhead. I need it to be simple but smart enough to where if I want to output json it will recognize when the last attribute is done not to output the leading ';'

I will be using it to output data in json, xml, txt, AOML and others pointing to its respective template, depending on the choice the user makes for desired data input.

I have looked at things like Smarty, but it seems a little much for me and there doesn't seem to be any easy json solutions.

If anyone has any simple solutions please let me know. I am unable to find this exact question on here.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:21:48.360

PHP 本身是一个模板引擎（目前您可以使用它做更多事情，但基本上它是模板引擎） - 恕我直言，在模板引擎中创建和使用模板引擎有点愚蠢；）

我的建议是这样的：

```
function renderTemplate($_file_, $_args_ = null, $_return_ = false) {
    if (is_array($_args_)) {
        extract($_args_, EXTR_SKIP);
    }
    if ($_return_) {
        ob_start();
        ob_implicit_flush(false);
        require('/mypath/to/templates/'.$_file_.'.php');
        return ob_get_clean();
    } else {
        require('/mypath/to/templates/'.$_file_.'.php');
    }
} 
```

# java - 从一个字段中提取字母并将其放在另一个字段中

> ID：15317700
> 
> 赞同：-2
> 
> 时间：2013-03-10T00:52:39.283
> 
> 标签：java

```
public class Driver {
    // fields

    private String Id;

    Id = name.substring(0, 3);

    public Driver(String f1, String f2, int f3, String f4) {
        // constructor
    }
} 
```

好吧，我已经更改了代码。这很清楚。我想从 nomC 中提取前三个字母，从 prenomC 中提取第一个字母，从 anneeEC 中提取最后两位数字，并将它们放在一个新字段中。为什么它在 « private String numId; 行显示错误 »：令牌“;”上的语法错误，预期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T00:54:14.327

> 为什么它在第 2 行显示错误？

因为声明必须包含变量名，而不仅仅是它的类型：

```
String firstThree = nomC.substring(0, 3); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T00:56:01.090

你应该把

```
 firstThree = nomC.substring(0, 3); 
```

在构造函数内部。

# ruby - bundle install WITH production after installing without production

> ID：15317704
> 
> 赞同：1
> 
> 时间：2013-03-10T00:53:24.480
> 
> 标签：ruby, bundler

After having installed my application's gems by executing:

```
bundle install --without production 
```

Now I want to install the production group gems. However, when I issue:

```
bundle install 
```

bundle seems to remember the previous setting and none of the production group gems are installed. How can I clean this bundle 'cache' and force it to reinstall all the gems in the Gemfile?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T03:15:09.587

最快的选择是简单地删除位于以下位置的捆绑配置文件：

```
.bundle/config 
```

然后在 Rails 项目中发出命令：

```
bundle update
bundle install 
```

来源[here](https://stackoverflow.com/a/11198495/1698058)和[here](https://stackoverflow.com/a/5040507/1698058)。

# php - 即时调整图像大小

> ID：15317705
> 
> 赞同：0
> 
> 时间：2013-03-10T00:53:28.153
> 
> 标签：php, codeigniter, gd

我已经使用 ci 建立了一个画廊，只要上传的图像在 3000x5000 像素范围内，它就会保持相同的大小。在显示它们并且由于我没有裁剪缩略图时，我如何在需要时调整它们的大小所以说我想将它们的列表重新调整为 150x150 我该怎么做？

我按照指南 [http://ellislab.com/codeigniter/user-guide/libraries/image_lib.html](http://ellislab.com/codeigniter/user-guide/libraries/image_lib.html)

问题是在加载库时，它希望我指定每个图像的完整配置信息。所以假设我将变量加载到控制器中以显示在视图中，加载时它看起来像这样：

```
foreach($gallery as $img)
{
   echo "<div>";
   echo "<img src='" . $this->img_lib->resize($img->imagepath, 150, 150) . "'>";
   echo "</div>";

} 
```

ps：调整大小时图像会保存吗？因为我不想要那个。

更好的解决方案：http: [//www.matmoo.com/digital-dribble/codeigniter/image_moo/](http://www.matmoo.com/digital-dribble/codeigniter/image_moo/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T02:33:47.137

我知道如何在 ci 之外做到这一点。本质上，img“src”需要等于一个 php 脚本，或者被 htaccess 拦截，然后将其重定向到一个 php 脚本。

你可以尝试这样的事情：

```
foreach($gallery as $img)
{
   echo "<div>";
   echo "<img src='/imageResize.php?path=" . $img->imagepath . "'>";
   echo "</div>";

} 
```

文件：imageResize.php

```
$path = $_REQUEST['path'];
$this->img_lib->resize($path, 150, 150); 
```

根据您网站的文件夹结构，最好只传递文件名而不是完整路径。更好的是使用 .htaccess（我在我们的 CMS 中使用）来截取图像并即时调整大小/裁剪。例如`<img src="/path/to/image.jpg?w=150&h=150" />`

这是否有助于提供一些方向？

在您的另一个问题上，除非您指定它，否则不会将物理文件保存在服务器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T03:44:29.817

@SaRiD 的答案是正确的。但是，它不一定必须在 CI 之外。您可以将图像源指向负责调整大小并提供图像的控制器方法。

在此方法中，您还需要使用正确的[标头](http://php.net/manual/en/function.header.php)向浏览器识别图像资源。

您声明您不想保存缩略图。这显然取决于应用程序的需要。您可以将其设置为向浏览器提供先前裁剪和保存的缩略图（如果存在）（来自先前的请求），而不是每次都创建和提供缩略图 - 这将为您节省一些 CPU 周期。

# python - Game Library with Support for RPython

> ID：15317707
> 
> 赞同：1
> 
> 时间：2013-03-10T00:53:52.620
> 
> 标签：python, game-engine, pypy, rpython

Are there any Python game libraries (Pygame, Pyglet, etc.) with support for RPython? Or game libraries specifically made for RPython? Or bindings for a game library for RPython?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T07:19:14.683

RPython 不是 Python。它们是*不同*的语言，尽管您可以使用 Python 解释器执行 RPython 代码并获得与运行已编译的 RPython 程序类似的效果（慢得多）。极不可能有任何合理的 Python 库（游戏库或任何其他类型）也适用于 RPython **。**它必须是专门为 RPython 编写的，如果它在 RPython 中工作，那么当它被视为一个常规 Python 库时会非常不灵活，以至于没有人会在这种情况下使用它。

如果您想使用游戏库以较低级别的编译语言进行编程，请使用 C# 或 Java。RPython 不是一个好的竞争对手（很大程度上是因为它的库很少，甚至没有太多的标准库）。

如果您想用 Python 编程，请使用 Python（可能使用 Python 的 PyPy 实现，如果它支持您正在使用的所有库，它可能比标准 Python 解释器更快）。RPython 不会帮助您编写运行速度更快的 Python 代码。

如果你的目标不是专门制作一款游戏，而是因为你想专门学习 RPython 而用 RPython 做一些项目，那么这是一个完全合理的目标。但是编写游戏可能不是学习编写 RPython 最有帮助的项目；您可能应该考虑编写某种解释器，因为这就是 RPython 的设计目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T05:03:12.393

是的，请查看用 RPython 编写的 gameboy 解释器 pygirl。[https://bitbucket.org/pypy/lang-gameboy](https://bitbucket.org/pypy/lang-gameboy)

# c++ - C++ Qt - Get Physical Disk Size (Win32)

> ID：15317709
> 
> 赞同：0
> 
> 时间：2013-03-10T00:54:03.543
> 
> 标签：c++, qt, winapi, hard-drive

How can I get the physical size of all hard disks on the current computer using C++ / Qt framework on Windows? Just to be clear, if I have a 640 GB HDD, I want to the application to show 640 GB, not 596 GB of available space.

I know that Qt probably doesn't have a function I could use, because it has to be platform-specific, so I guess in this case something from the Win32 API. Unfortunately I can't use GetDiskFreeSpaceEx(), because I would only get the free/available disk space. I've read about using WMI, but I can't seem to find any usable code examples for this purpose.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:12:54.767

我认为这个问题主要是由于操作系统和硬盘制造商使用的测量不一致造成的。查看[此维基百科页面](http://en.wikipedia.org/wiki/Megabyte#Definition)以获取更多信息。也许找到一种方法来进行数学运算，同时将 1 千字节视为 1000 字节（而不是 1024），将 1 兆字节视为 1000 * 1000 等等 - 而不是将 1 千字节视为 1024 字节等。

# c++ - File cannot be read in when using Visual Studio 2010 Debugger

> ID：15317710
> 
> 赞同：1
> 
> 时间：2013-03-10T00:54:05.760
> 
> 标签：c++, visual-studio-2010, debugging

So, I am using [https://stackoverflow.com/a/298713/1472828](https://stackoverflow.com/a/298713/1472828) to put an argument "hands.txt" (my agrv[1], which is a file I wanna open) in my command arguments. I have tried both hands.txt and "hands.txt", neither of them worked.

```
int FileParsing(vector<Card> & v, char * FileName) {
    ifstream ifs;
    ifs.open(FileName);
    if (!ifs.is_open()){
        cout << "file cannot be opened." << endl;
    } else { 
```

So I use debugger to step through my main:

```
int main(int argc, char * argv[]){
    if (argc !=2 ){
        //ErrorMessage();
    } else {
         ... 
```

Debugger tells me that my argc is 2, which is right, but how come every time the debugger just goes to

```
cout << "file cannot be opened." << endl; 
```

which means the argument just fails at reading it

```
ifstream ifs;
ifs.open(FileName); 
```

Is there something I missed or I passed the argument in a wrong way?

**p.s.** The text file was read perfectly from cmd, so it's not the problem of code.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T16:44:07.030

从@WhozCraig 得到这个想法，在 cmd 中运行程序时，文本文件放在调试目录下。但是如果使用调试器运行它，则必须将文本文件与其他 cpp 和 h 文件放在同一目录中。

# ruby - Remove sequence from string if preceded by same sequence

> ID：15317713
> 
> 赞同：1
> 
> 时间：2013-03-10T00:54:10.367
> 
> 标签：ruby, regex

I have some sequences in a string denoted by "@number" (/@\d/) I want to remove any redundant sequences, where @2 is followed by @2, I only want to remove them if another identical @number sequence is found directly after somewhere in the text, so for `@2lorem@2ipsum` the 2nd @2 is removed, but for `@2lorem@1ipsum@2dolor` nothing is removed because @1 is between the two @2 sequences.

```
"@2randomtext@2randomtext@2randomtext@1bla@2bla2@2bla2" 
```

becomes:

```
"@2randomtextrandomtextrandomtext@1bla@2bla2bla2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T07:58:02.370

您可以将其拆分为令牌：

```
my_string = "@2randomtext@2randomtext@2randomtext@1bla@2bla2@2bla2"
tokens = my_string.scan /(@\d+)?((?:(?!@\d+).)*)/
#=> [["@2", "randomtext"], ["@2", "randomtext"], ["@2", "randomtext"], ["@1", "bla"], ["@2", "bla2"], ["@2", "bla2"]] 
```

然后分块、映射和连接：

```
tokens.chunk{|x| x[0].to_s}.map{|n, v| [n, v.map(&:last)]}.join
#=> "@2randomtextrandomtextrandomtext@1bla@2bla2bla2" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T14:53:36.307

```
"@2randomtext@2randomtext@2randomtext@1bla@2bla2@2bla2".gsub /(?<=(@\d))([^@]*)\1/,'\2'
=> "@2randomtextrandomtextrandomtext@1bla@2bla2bla2" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:41:10.467

```
my_string = "@2randomtext@2randomtext@2randomtext@1bla@2bla2@2bla2"

prev_sequence = String.new
penultimate_index = my_string.length - 2

for i in 0..penultimate_index
  if my_string[i] == '@'
    new_sequence = "@#{my_string[i+1]}"
    if new_sequence == prev_sequence
      my_string.slice!( i, 2 )
    else 
      prev_sequence = new_sequence
    end
  end
end

puts my_string 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-10T01:28:56.917

容易...将您的字符串拆分为一个数组，然后比较紧随其后的数字。如果相同，请删除它/它们。复杂的（通过不是那么多）是你不能在循环遍历它们时从数组中删除条目......所以你需要做的是制作一个递归函数......这是伪：

-= 全局值 =-
Decalre StringArray 并将其设置为 OriginalString.SplitOn("@")

-= Method RemoveLeadingDuplicates =-
Declare Counter 为 StringArray 中的每个字符串
声明 RemoveIndex循环   if previous lead == current lead     Set RemoveIndex     break from loop   else     previous lead = current lead 将计数器增加 1 结束循环

如果 RemoveIndex 不为 null
  从数组中删除指定索引处的项目
  调用 RemoveLeadingDuplicates

返回

# c# - 正则表达式持续时间

> ID：15317717
> 
> 赞同：0
> 
> 时间：2013-03-10T00:54:57.610
> 
> 标签：c#, .net, regex

我试图在文件中的任何日期查找 strText 的匹配项，而不是我想在该时间添加 50 到 60 秒的范围，然后查看该 strText 是否再次出现在该行上。以下正则表达式工作正常。但是在第二个日期，它正在检查 strText 再次出现的任何时间，而不是 4o 到 50 秒。

```
string regex =
        @"(\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2})[^\n\r]+?strText.+?(\d{4}-\d{2}-\d{2}\s+\d{2}:\d  {2}:\d{2})[^\n\r]+?strText"; 
```

所以在第二次约会时，我需要添加 40 到 50 秒的范围。任何想法如何做到这一点。它不一定是正则表达式，但我认为使用它可能会更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T02:39:52.097

正则表达式没有数字的概念，因此动态更改表达式以查找您正在寻找的确切时间的麻烦将是不必要的复杂。

相反，我认为没有理由不这样做：

*   使用正则表达式检索字符串后手动解析字符串
*   [使用datetime](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)运行数字运算（添加时间）。
*   存储预期时间并在第二次检查时比较它是否匹配。

# c++ - What are flags and bitfields?

> ID：15317723
> 
> 赞同：-6
> 
> 时间：2013-03-10T00:55:57.517
> 
> 标签：c++, flags, bit-fields

Can someone explain to me what flags and bitfields are. They seems to be related to each other, or mabye i got the wrong idea. I kinda grasp bits and pieces of what they do and are but I would like to get them fully explain and I can't really find any good tutorials or guides.

I would be really thankful if someone could give some good examples on how to use them etc... For instance i see these kinds of expressions all the time and I dont fully understand them. Just that they are some kind of logical operators or something

```
 VARIABLE1 | VARIABLE2 
```

Thanks in advance!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:18:21.203

可以在这里找到按位运算的介绍：http: [//www.codeproject.com/Articles/2247/An-introduction-to-bitwise-operators](http://www.codeproject.com/Articles/2247/An-introduction-to-bitwise-operators)

当它们应用于标志时，按位运算的优势在于它们非常快并且节省空间。您可以使用互斥位将对象的许多不同状态存储在单个变量中。IE

```
0001 // property 1 (== 1, 0x01)
0010 // property 2 (== 2, 0x02)
0100 // property 3 (== 4, 0x04)
1000 // property 4 (== 8, 0x08) 
```

这些可以代表对象的四个不同属性（这些是“掩码”）。我们可以使用以下方法将属性添加到对象的标志状态`or`：

```
short objState = 0; // initialize to 0
objState |= 0010; 
```

这通过“或”将 0010 与 0000 添加到 objState 中，结果为 0010。如果我们像这样添加另一个标志/属性：

```
objState |= 0100; 
```

我们最终得到 objState = 0110。

现在我们可以检查对象是否设置了属性 2 的标志，例如，使用`and`：

```
if (objState & 0010) // do something 
```

`and`当且仅当两个位都为 1 时为 1，因此如果位 2 为 1，则上述操作保证为非零。

正如我所提到的，这种处理对象属性/标志的方式的优点是速度和效率。可以这样想：您可以使用此方法将一组属性存储在单个变量中。

例如，假设您有一个文件类型，并且您希望使用位掩码跟踪属性（我将使用音频文件）。也许位 0 - 3 可以存储文件的位深度，位 4 - 7 可以存储文件类型（Wav、Aif 等），等等。然后，您只需要将这个变量传递给不同的函数，并可以使用您定义的位掩码进行测试，而不必跟踪可能的几十个变量。

希望至少能对按位运算的这一应用有所了解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:57:53.287

整数值的位可以用作布尔值。

[http://msdn.microsoft.com/en-us/library/yszfawxh(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/yszfawxh(v=vs.80).aspx)

用 制作`|`和检索`&`。

```
enum { ENHANCED_AUDIO = 1, BIG_SPEAKERS = 2, LONG_ANTENNA = 4};

foo(HAS_CAR | HAS_SHOE); // equiv to foo(3);

void processExtraFeatures(flags) {
    BOOLEAN enhancedAudio = flags & ENHANCED_AUDIO; // true
    BOOLEAN bigSpeakers = flags & BIG_SPEAKERS; // true
    BOOLEAN longAntenna = flags & LONG_ANTENNA; // false
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:09:56.070

“标志”是一个可以设置或不设置的概念对象，但不是 c++ 语言的一部分。

位域是一种语言结构，用于使用可能不构成可寻址对象的位集。单个位的字段是一种——通常非常好的——实现标志的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-10T01:16:12.327

“双域”是“字”（即，一个 或 ）中的一组一个或多个位`int`，`long`它们`char`一起存储在一个变量中。

例如，您可以在某些动物身上有“无”、“斑点”和/或“条纹”，它也可以有“无、短、中或长”尾巴。

所以，我们需要两个位来表示尾巴的长度：

```
enum tail
{
   tail_none = 0,
   tail_short = 1, 
   tail_medium = 2, 
   tail_long = 3
}; 
```

然后我们将这些作为位存储在“属性”中：

```
enum bits_shifts
{
   tail_shift = 0,    // Uses bits 0..1
   spots_shift = 2,   // Uses bit 2
   stripes_shift = 3
};

enum bits_counts
{
   tail_bits = 2,    // Uses bits 0..1
   spots_bits = 1,   // Uses bit 2
   stripes_bits = 1
}; 
```

我们现在假设我们已经从某个输入中获取了 tail_size 和 has_stripes、has_spots 变量。

```
int attributes;

attributes = tail_length << tail_shift;

if (has_spots)
{
   attributes |= 1 << spots_shift;
}

if (has_stripes)
{
   attributes |= 1 << stripes_shift;
} 
```

稍后我们想弄清楚属性是什么：

```
switch((attributes >> tail_shift) & (1 << tail_bits)-1))
{
   case tail_none:
     cout << "no tail";
     break;

   case tail_short:
     cout << "short tail";
     break;

   case tail_medium:
     cout << "medium tail";
     break;

   case tail_short:
     cout << "long tail";
     break;
 }

 if (attributes & (1 << stripes_shift))
 {
    cout << "has stripes";
 }

 if (attributes & (1 << spots_shift))
 {
    cout << "has spots";
 } 
```

现在，我们将所有这些存储在一个整数中，然后再次“捞出”。

你当然也可以这样做：

```
enum bitfields
{
    has_widget1 = 1,
    has_widget2 = 2,
    has_widget3 = 4, 
    has_widget4 = 8, 
    has_widget5 = 16,
    ...
    has_widget25 = 16777216, 
    ...
}

int widgets = has_widget1 | has_widget5;

... 

if (widgets & has_widget1)
{
  ... 
} 
```

这实际上只是将几个东西打包到一个变量中的一种简单方法。

# symfony - Symfony KnpMenuBundle 跨包配置

> ID：15317724
> 
> 赞同：2
> 
> 时间：2013-03-10T00:55:58.880
> 
> 标签：symfony, configuration, knpmenubundle

我在同一应用程序的两个不同包中使用 KnpMenuBudle。在一个包中，我还使用了 BraincraftedBootstrapBundle，因此在我的 app/config/config.yml 中，我将这个特定的配置用于使用引导程序设置菜单样式：

```
knp_menu:
  twig:
    template: "BraincraftedBootstrapBundle:Menu:menu.html.twig" 
```

问题是配置是全局设置的，所以当我尝试在不需要引导的捆绑包中使用 KnpMenu 时，我得到一个错误。

如何仅为一个捆绑包设置此特定配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T16:31:12.067

我相信您可以在布局中调用 knp_menu_render twig 方法时指定所需的模板：

```
{{ knp_menu_render('main', {'template': 'BraincraftedBootstrapBundle:Menu:menu.html.twig'}, 'custom') }} 
```

# c# - ac# 静态变量在非静态类实例中的行为是什么？

> ID：15317738
> 
> 赞同：-4
> 
> 时间：2013-03-10T00:58:18.857
> 
> 标签：c#, class, static

当我在一个类中声明一个静态变量然后多次实例化该类时会发生什么？

静态变量会在所有实例之间共享吗？还是会为每个类实例创建多个静态变量？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T00:59:19.000

C# 中的`static`字段在一个类型的所有实例之间共享。无论您实例化该类型多少次，每个静态字段都只有一个实例`AppDomain`（通常`AppDomain`每个进程一个）。

一个例外是泛型类型。当您在泛型类型中有一个静态字段时，每个泛型实例化都会有一个静态字段实例。

```
class Container<T> {
  internal static T Field;
} 
```

现在`Container<int>`和`Container<string>`将会有不同的实例`Field`

# java - Java中多个值的乘积和因子

> ID：15317743
> 
> 赞同：0
> 
> 时间：2013-03-10T00:59:12.807
> 
> 标签：java, do-while, factorization

我正在尝试编写的程序需要输入用户定义的 Int 值数量并产生这些值的乘积，然后确定该乘积的所有因素。这些值将通过一个 Do-While 循环输入，直到用户输入一个负数，然后所有的正数将相乘，形成一个 Double 形式的乘积。我相当肯定我可以弄清楚如何获得产品的因素，但是在找到实际产品时，我完全不知所措。这是我到目前为止编写的代码，减去我在生产产品方面的失败尝试。

```
public static void main(String[] args)
{
    Scanner in = new Scanner(System.in);
    int Value;
    double Product;

    do
    {
        System.out.print("Value: ");
        Value = in.nextInt();
    }
    while (Value>=0);
} 
```

这就是我能够弄清楚的全部，循环 Value 提示直到输入负 Int 。就获得产品而言，我在循环内部和外部都尝试过 If-Statements，但要么我的代码错误，要么我的语句错误，或者更有可能我只是尝试了错误的方法。**我不是要求任何人为我编写代码**，但如果有人能指出我正确的方向，我将非常感激。

您建议从未知数量的用户定义值中确定产品的建议是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:05:52.193

您应该将`product`变量设置为最初等于**1**`product` ，并在用户每次写入数字时将 的值乘以输入数字。

```
public static void main(String[] args)
{
    Scanner in = new Scanner(System.in);
    int value;
    double product=1;

    do
    {
        System.out.print("Value: ");
        value = in.nextInt();
        product *= value //product= product * value;
    }
    while (value>=0);

    System.out.println("Product is: "+product);
} 
```

# java - 零宽度高度 jPanel 开始

> ID：15317745
> 
> 赞同：4
> 
> 时间：2013-03-10T00:59:24.537
> 
> 标签：java, swing

为什么 jPanel 在启动时返回 0 的高度和宽度以及如何在启动时获得正确的值。

```
import javax.swing.JPanel;

class ZeroJPanel extends JPanel {

    /**
     * Creates new form ZeroJPanel
     */
    ZeroJPanel() {
        initComponents();

        System.out.println( this.getHeight() );
    }

    public static void main(String Args[]) {
        new ZeroJPanel();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(0, 400, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(0, 300, Short.MAX_VALUE)
        );
    }// </editor-fold>
    // Variables declaration - do not modify
    // End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T02:04:21.440

面板返回`0, 0`，因为很简单，这是默认值。

当您将面板添加到框架并调用`pack()`框架时，它将计算正确的（首选）尺寸并进行设置。在那之前，您将无法找到大小，因为它尚未计算。

为什么需要这些值？如果您能用更广泛的术语解释问题，我们或许可以为您提供帮助。

# ruby-on-rails - Rails：如何将 OR 语句传递给 current_page 方法？

> ID：15317749
> 
> 赞同：0
> 
> 时间：2013-03-10T01:01:15.363
> 
> 标签：ruby-on-rails, twitter-bootstrap

当用户在某个子页面上时，我有以下代码表示一个活动选项卡，在这种情况下是用户索引视图。

```
 <li class="<%='active' if current_page?(users_path) %>">
    <%= link_to 'Users',      users_path %></li> 
```

我希望这样当用户在任何显示、编辑或索引页面上时，选项卡都会显示为“活动”。

我试过这样的事情：

```
 <li class="<%='active' if current_page?(users_path || edit_user_path || user_path) %>">
    <%= link_to 'Users',      users_path %></li> 
```

但只有 users_path 被识别。

在 current_page 方法中构建 OR 语句的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:24:04.187

这是我在以前的应用程序中使用的一些代码。

```
def nav_item(copy, link)                             
  content_tag :li, class: nav_class(link) do         
    link_to copy, link                             
  end                                                
end

def nav_class(page)
  case page
  when :users     then 'active' if request.path.match(/^\/users/)
  when :projects  then 'active' if request.path.match(/^\/projects/)       
  else                                               
    nil                                              
  end                                                
end 
```

如果路由匹配当前路径，上面的两个辅助方法将在`li`标记内呈现链接。`class="active"`

不在 UsersController 操作上：

```
<%= nav_item('Users', :users) %>  #=> <li><a href="/users">Users</a></li> 
```

在 UsersController 动作上：

```
<%= nav_item('Users', :users) %>  #=> <li class="active"><a href="/users">Users</a></li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:03:15.530

那应该是

```
<li class="<%='active' if current_page?(users_path) || current_page?(edit_user_path) || current_page?(user_path) %>"> 
```

如果您对很多页面执行此操作，这将很难维护。您最好使用 gem 进行语义导航。

# java - 如何使用 java 在 libvirt 中填充具有活动域的组合框

> ID：15317750
> 
> 赞同：1
> 
> 时间：2013-03-10T01:01:19.213
> 
> 标签：java, arraylist, virtual-machine, jcombobox, libvirt

我正在尝试使用 libVirt 创建一个活动虚拟机列表并用它们填充一个组合框不幸的是，有些东西不好

```
public ArrayList<String> getActiveVirtualMachines() throws LibvirtException
{
    int[] vmsOn = connect.listDomains();
    Domain array=null;
    vmsWl.clear();

    System.out.println("List of running vms: ");
    for (int i = 0; i < vmsOn.length; i++) 
    {
        array = connect.domainLookupByID(vmsOn[i]);
        vmsWl.add(array.getName());
    }   

    for (int i = 0; i < vmsWl.size(); i++) {
        System.out.println(vmsWl);
    }

    return vmsWl;
} 
```

该列表如下所示：

正在运行的虚拟机列表：

[Ubuntu，testNew2]

[Ubuntu，testNew2]

相对于：正在运行的虚拟机列表：

Ubuntu

测试新2

组合框也是如此，有两个相同的条目：

[Ubuntu，testNew2] [Ubuntu，testNew2]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-16T15:15:13.827

似乎当您遍历列表时，您正在打印整个列表，而不仅仅是您需要的特定元素，因此请考虑替换

```
for (int i = 0; i < vmsWl.size(); i++) {
    System.out.println(vmsWl);
} 
```

和

```
for (int i = 0; i < vmsWl.size(); i++) {
    System.out.println(vmsWl.get(i));
} 
```

甚至更好：

```
for (String name : vmsWl) {
    System.out.println(name);
} 
```

# android - 使用处理程序更新 UI 会冻结我的应用程序

> ID：15317760
> 
> 赞同：0
> 
> 时间：2013-03-10T01:03:50.610
> 
> 标签：android, android-ui, android-handler

我正在尝试使用`TextView`:)制作时钟

这里有人告诉我，我不能使用普通线程来更改 UI，但是`Handler`或者`AsyncTask`. 几天前我设法让它工作，但不是一个一致的线程。

现在我想要的是一个始终如一的线程，它总是在改变我的`Textview`. 我试过用这个，但没有用，有什么帮助吗？

```
private void startClock() {
    new Handler().postDelayed(new Runnable(){

        @Override
        public void run() {
            while (true) {
                final long millis = System.currentTimeMillis() - MainActivity.startedAt;
                clock.setText("" + millis);
                runOnUiThread (new Runnable() {

                    @Override
                    public void run() {
                        clock.setText("" + millis);
                    }
                });

                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        }
    }, 2000);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:22:05.917

你应该摆脱：

```
while(true) {
    ....
    sleep(1000);
    ...
} 
```

因为这会让你的线程永远卡住。你的程序应该像这样工作：

```
private Handler mHandler = new Handler();

@Override
public void onResume() {
    super.onResume();
    mHandler.removeCallbacks(mUpdateClockTask);
    mHandler.postDelayed(mUpdateCLockTask, 100);
}

@Override
public void onPause() {
    super.onPause();
    mHandler.removeCallbacks(mUpdateClockTask);
}

private Runnable mUpdateClockTask = new Runnable() {
    public void run() {
        updateClock();
        mHandler.postDelayed(mUpdateClockTask, 2000);
    }
}; 
```

在`updateClock()`你内部进行所有的 UI 更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T01:22:51.443

在此处查看示例[https://stackoverflow.com/a/11140429/808940](https://stackoverflow.com/a/11140429/808940)

另请注意，您的代码中有重复的行：

```
clock.setText(""+millis); 
```

It appears both in the runOnUiThread and in the main handler, it should only appear in the runOnUiThread runnable

# java - Java 7 JDK 自动更新

> ID：15317766
> 
> 赞同：3
> 
> 时间：2013-03-10T01:04:26.987
> 
> 标签：java, java-7, auto-update

有没有办法设置 Java 7 让它自动更新？我在 Windows 7、64 位上使用 JDK 标准版。Java 6 会自动检查更新并提示您安装它们。但是，Java 7 似乎没有任何更新机制。甚至 Java 控制面板中的“更新”选项卡也不见了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-10T01:15:29.510

我认为这可能是问题所在。从[Oracle 下载帮助页面](http://www.java.com/en/download/help/java_update.xml)：

> 问：为什么 Java 控制面板中缺少更新选项卡？
> 
> 答：Java 自动更新目前不适用于 64 位版本的 Java。64 位版本的 Java 不包括 Java 控制面板中的更新选项卡。

也可以看看：

*   superuser.com[上的“Java 控制面板不显示 windows-7-x64 上的更新选项卡” 。](https://superuser.com/questions/275700/java-control-panel-does-not-show-update-tab-on-windows-7-x64)

# actionscript-3 - AS3在draw（）之后调整bitmapData的大小丢失了alpha通道

> ID：15317769
> 
> 赞同：1
> 
> 时间：2013-03-10T01:04:43.337
> 
> 标签：actionscript-3, bitmap, image-resizing

我正在使用矩阵以通常的方式调整 bitmapData 的大小。bitmapData 有一个 alpha 通道（它来自 PNG），并且 alpha 通道被忽略...

```
var m:Matrix = new Matrix();
m.scale(.5, .5);

var bmp:BitmapData = new BitmapData(bitmapData.width * .5, bitmapData.height * .5,true);
bmp.draw(bitmapData,m);

var resizedBitmap = new Bitmap(bmp); 
```

我已将第三个参数 true 添加到 BitmapData() 构造函数以支持 alpha 通道，但在 draw() 调用之后我仍然失去了所有透明度。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:04:43.337

解决这个问题的方法是在 BitmapData 构造函数中添加第四个参数（fillColor）。

```
var bmp:BitmapData = new BitmapData(bitmapData.width * .5, bitmapData.height * .5,true,0x00000000); 
```

从文档中：

> 要创建完全透明的位图，请将 transparent 参数的值设置为 true，并将 fillColor 参数的值设置为 0x00000000（或 0）。

# php - 通过 id 获取 MYSQL 行并在表单中编辑和更新？

> ID：15317777
> 
> 赞同：0
> 
> 时间：2013-03-10T01:06:01.187
> 
> 标签：php, mysql, forms, function

我有一个 MYSQL 表，每行都有编辑链接和删除按钮。编辑链接转到具有表单的 edit_movie.php。我的问题是表单没有显示任何要更新/编辑的数据。如何从单击的行中获取 id 或编写什么函数来获取它。表格是空白的，没有填写任何字段。

有人可以帮忙吗，我会很高兴的！这个问题已经坐了 3 天了，只是无法让它工作。我是PHP初学者...

我知道我正在使用过时的 mysql 函数，我需要查看 SQL 注入，一旦我得到它，我就会这样做。

**表信息：**

表1名称：电影
字段：id（主键，AI），title，release_year，genre_id，director

表2名称：类别
字段：genre_id（主键，AI），genre

他们在genre_id 之间有外来关系。

**这是 index.php 文件中的代码**

```
 <?php

require('movie.inc.php');

if ( isset($_GET['delete']) && isset($_GET['id']) ){
   if ( delete_movie_by_id($_GET['id']) ){ //it's 100% safe
       die('Movie has been removed. Refresh the page now'); // or the like
   } else {
      echo 'Sorry movie could not be deleted'; // could not - handle here
   }
}
    include 'add_movie.php';
?>
<!DOCTYPE html>
<html>
<head>

<title>My movie library</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="mall.css" />

</head>
<body>

<table>
 <tr>
  <th>Title</th>
  <th>Release year</th>
  <th>Genre</th><th>Director</th>
  <th>Update</th>
  <th>Delete</th>
 </tr>

  <?php  foreach (get_all_movies() as $index => $row) : ?>
   <tr>
     <td><?php echo $row['title'];?></td>
     <td><?php echo $row['release_year']; ?></td>
     <td><?php echo $row['genre'];?></td>
     <td><?php echo $row['director'];?></td>
     <td><a href='<?php printf('edit_movie.php?edit=%s', $row['id']);?>'>Edit</a></td>
     <td>
      <form action="index.php" method="GET">
              <input type="hidden" name="delete" value="yes" />
              <input type="hidden" name="id" value="<?php echo $row['id'];?>" /> 
              <input type="submit" value="Delete" />
      </form>
      </td>
    </tr>
    <?php endforeach; ?>
    </table>

</body>
</html> 
```

**这是 edit_movie.php 代码：**

```
 <?php

    require 'connect.inc.php';
    require_once('movie.inc.php');

    ?>

    <!DOCTYPE html>

    <html>

    <head>

    <title>My movie library</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="mall.css" />

    </head>

    <body>

    <h1>Edit movie</h1>
    <div id="form_column">
    <form action="edit_movie.php" method="post">
    <input type="hidden" name="id" value="<?php if (isset($row["id"])) ?>" /> <br>
    Title:<br> <input type="text" name="title" value="<?php if (isset($row["title"])) { echo $row["title"];} ?>" /> <br>
    Release Year:<br> <input type="text" name="release_year" value="<?php if (isset($row["release_year"])) { echo $row["release_year"];} ?>" /> <br>
    Director:<br> <input type="text" name="director" value="<?php if (isset($row["director"])) { echo $row["director"];} ?>" /> <br><br>
    Select genre:
    <br>
    <br> <input type="radio" name="genre_id" value="1" checked />Action<br>
    <br> <input type="radio" name="genre_id" value="2" />Comedy<br>
    <br> <input type="radio" name="genre_id" value="3" />Drama<br>
    <br> <input type="radio" name="genre_id" value="4" />Horror<br>
    <br> <input type="radio" name="genre_id" value="5" />Romance<br>
    <br> <input type="radio" name="genre_id" value="6" />Thriller<br><br>
    <input type="submit" value="Update movie" />
    </form>
    </div>

    </body>

    </html> 
```

**这是movie.inc.php文件**

```
<?php

require_once('connect.inc.php');

function get_all_movies(){

   $query = "SELECT * FROM movies m INNER JOIN categories c ON m.genre_id = c.genre_id";

   $result = mysql_query($query);

   if ( ! $result ){ 
     return false;
   } else {
     $return = array();

     while ($row = mysql_fetch_assoc($result)){

        $return[] = array('director' => $row['director'], 'genre' => $row['genre'], 'release_year' => $row['release_year'], 'title' => $row['title'], 'id' => $row['id']); 
     }
       return $return;
   }
}

function delete_movie_by_id($id){
   return mysql_unbuffered_query(sprintf("DELETE FROM `movies` WHERE id='%s' LIMIT 1", mysql_real_escape_string($id)));
}

if ( isset($_POST['delete'], $_POST['id']) ){

   delete_movie_by_id($_POST['id']); 
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:18:04.870

在`edit_movie.php`它看起来你实际上并没有让电影通过查看表单。你需要这样的东西`movie.inc.php`：

```
function get_movie_to_edit($id) {

     $query = "SELECT * FROM movies m INNER JOIN categories c ON m.genre_id = c.genre_id WHERE id = $id";

     $result = mysql_query($query);

     if ( ! $result ){ 
         return false;
     } else {

         while ($row = mysql_fetch_assoc($result)){

                $return = array('director' => $row['director'], 'genre' => $row['genre'], 'release_year' => $row['release_year'], 'title' => $row['title'], 'id' => $row['id']); 
         }
             return $return;
     }
} 
```

然后在 edit_movie.php 中你需要调用这个函数。就像是...

```
if(isset($_GET['edit'])) {
    $movie = get_movie_to_edit($_GET['edit']);
} 
```

当然，正如您所提到的，您需要清理大量代码以防止注入并检查例如您到达`edit_movie.php`并且 ID ro 编辑不存在的情况，但这是基本要点。

然后，您还可以编辑表单中的值`edit_movie.php`以反映新数组，例如：

```
<form action="edit_movie.php" method="post">
<input type="hidden" name="id" value="<?php echo $movie['id']; ?>" /> <br>
Title:<br> <input type="text" name="title" value="<?php echo $movie['title']; ?>" /> <br>
.... the rest of your form inputs
</form> 
```

**Updated** For the genre radio buttons...

```
<input type="radio" name="genre_id" value="1"<?php if($movie['genre'] == 1) { echo ' checked'; } ?> />Action<br>
<input type="radio" name="genre_id" value="2"<?php if($movie['genre'] == 2) { echo ' checked'; } ?> />Comedy<br>
.... and so on 
```

# java - 如何计算Java中字符串中每个字母中的字母？

> ID：15317778
> 
> 赞同：-5
> 
> 时间：2013-03-10T01:06:02.943
> 
> 标签：java, count, split, words

我已经使用此代码进行了尝试：

```
String st="Hello world have a nice day";
String arr=st.Split(" ");
for (int i=0; i < arr.length; i++) {
    ???
} 
```

但它不起作用。

我希望它输出如下内容：

```
Hello=5
World=5
have=4
a=1
nice=4
day=3 
```

请问有人知道正确的代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:07:07.807

你可以使用这样的东西：

```
String[] words = yourString.split(" ");

for (String word : words) {
  System.out.println(word + " length is: " + word.length());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T01:19:18.547

`word.length()`返回字符串的长度。

但是，该`split()`方法只会用空格分割字符串，将所有内容留在结果分割中。我的意思是标点符号、制表符、换行符等，所有这些都将计入长度。`word.length()`因此，您可能想做的不仅仅是做，而是：

`word.replaceAll("\p{Punct}", "").trim().length()`.

*   `replaceAll("\p{Punct}", "")`从字符串中删除所有标点符号。

*   `trim()`删除所有前导和尾随空格。

例如，一个句子：

> 我看到了一个鬼火。\n

(`\n`表示行尾字符，例如，如果您从文件中读取字符串，您可能会得到该字符)。

该句子将拆分为：

```
"I"  
"saw"  
"a"  
"will-o'-the-wisp.\n" 
```

最后一个字符串

> 将-o'-the-wisp。\n

有 18 个字符，但这超过了单词中的字符数。在该`replaceAll()`方法之后，字符串将如下所示：

> 柳树妖\n

在该`trim()`方法之后，字符串将如下所示：

> 威洛威斯普

它的长度为 12，即单词的长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:11:23.593

使用增强的 for 循环并打印出单词及其长度。

```
foreach(String w : st.split()) {
    System.out.println(w + ": " + w.length());
} 
```

# actionscript - Actionscript：自动一个接一个地定位元素

> ID：15317781
> 
> 赞同：0
> 
> 时间：2013-03-10T01:06:22.817
> 
> 标签：actionscript

是否可以让精灵一个接一个地自动定位。与`display:display-block`CSS 中的类似。

例如，我将 Sprites 添加到连续的某个父级，它们在 xml 皮肤文件中的方式，它们会自动将自己定位在彼此旁边。

是否有一个事件告诉父级添加了一个子级？

我可以实现一些扩展的 Sprite，通过计算最后一个元素的位置来自动定位推送的元素？

为什么 Actionscipt 里面没有 CSS 之类的东西？与 HTML 相比，在其中构建 UI 是一件很痛苦的事……

疯狂...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T03:46:32.103

如果是“原始”ActionScript，您应该搜索适当的库或自己动手。ActionScript 没有定义任何类似 CSS 的逻辑。

另一方面，Flex 可以，但您不会找到任何可以让您定义布局的 CSS。CSS 用于修改 Flex 中容器和组件的视觉外观。布局通常使用`layout`Flex 提供的容器类的属性来完成。例如，您可以使用 a`Group`并将其布局属性设置为`HorizontalLayout`or的实例`VerticalLayout`。这将自动将组的所有子组件定位在 x 或 y 方向。在使用 Flex 的情况下，您不能直接使用 sprite，但是您可以使用许多组件。也许有一个适合您的目的。

请参阅 Flex API 文档。[spark.components](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/package-detail.html)包将是一个很好的起点。

# c++ - 如何在 C++ 中调用函数

> ID：15317787
> 
> 赞同：-8
> 
> 时间：2013-03-10T01:08:30.477
> 
> 标签：c++, function, main

```
#include <iostream>
using namespace std;
struct Nodo{
    Nodo *siguiente,*anterior;
    char* Nombre,*Curso;
    int carnet;
    Nodo(){
        siguiente=anterior=NULL;
    }
};
struct ListaCircular{
    Nodo *PrimerNodo,*UltimoNodo;
    ListaCircular(){
        PrimerNodo->siguiente=PrimerNodo->anterior=UltimoNodo;
        UltimoNodo->siguiente=UltimoNodo->anterior=PrimerNodo;
    }
    void RegistrarUnaInclusion();
    void BuscarInclusion();
    void EliminarInclusion();
    void RechazarAprobarInclusion();
    void MostrarInclusiones();

};
    void ListaCircular::RegistrarUnaInclusion(){
    ListaCircular *Lista=new ListaCircular();
    PrimerNodo->Curso="EstructurasDeDatos";
    PrimerNodo->Nombre="Roberto";
    PrimerNodo->carnet=201243031;
    UltimoNodo->Curso="POO"; 
    UltimoNodo->Nombre="Luis";
    UltimoNodo->carnet=201233212;
    Nodo *Nuevo;
    char *Nom,*Cur;
    long Car;
    cout<<"Ingrese el nombre del estudiante que va a registrar"<<endl;
    cin>>Nom;
    Nuevo->Nombre=Nom;
    cout<<"Ingrese el care del estudiante "<<Nuevo->Nombre<<endl;
    cin>>Car;
    Nuevo->carnet=Car;
    cout<<"Ingrese el curso al que desea hacer la inclusion"<<endl;
    cin>>Cur;
    Nuevo->Curso=Cur;
} 
```

当我尝试运行我的代码时，它会向我发送一条错误消息，并说类似这样的话：

未定义对“_WinMain@16”collect2 的引用：ld 返回 1 个退出状态

我不知道是否可能是因为没有“主要”功能，以及另一件事，我如何调用该功能“RegistrarUnaInclusion”来使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T01:11:33.063

> 我不知道是不是因为没有“主要”功能

嗯，是的，这有点问题。每个程序都*必须*有一个`main()`功能。执行将从哪里开始？

> 我如何调用函数“RegistrarUnaInclusion”来使其工作？

`RegistrarUnaInclusion`是类的*成员函数*`ListaCircular`。因此，您需要该类的实例（对象）来调用该成员函数：

```
ListaCircular l;
l.RegistrarUnaInclusion(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:17:17.207

您是否尝试在 Google 中搜索您的错误？我建议您在开始编写下一个 C++ 程序之前先阅读[本教程。](http://www.cplusplus.com/doc/tutorial/)因为我认为您缺少编程的一般知识。

简而言之，您必须需要一个 main 方法才能运行任何程序。编译器使用 main 方法来识别程序的入口点。（不仅 C++ 还有大多数其他语言）所以这里的错误是你的程序**没有 main 方法**。并推荐阅读这个关于 main 方法的[wiki](http://en.wikipedia.org/wiki/Main_function)

# facebook - 如何计算特定用户的共享数量？

> ID：15317791
> 
> 赞同：1
> 
> 时间：2013-03-10T01:09:30.067
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我想在我的 Facebook 应用程序的用户之间举办一场比赛，并为分享时间最多的用户提供奖品。

如何获取每个用户对我的 FB 应用执行的分享次数？我可能会通过 PHP 来完成，但我对其他平台非常灵活。

我知道我可以使用类似的东西：[http://graph.facebook.com/?id=YOUR_URL](http://graph.facebook.com/?id=YOUR_URL)，但我想要每个用户的共享数，而不是我的应用程序的总共享数。

谢谢

# php - PHP / AJAX 并发会话仅在 Chrome 中行为不端

> ID：15317792
> 
> 赞同：3
> 
> 时间：2013-03-10T01:09:30.370
> 
> 标签：php, javascript, ajax, google-chrome, session

TL;博士。无需先涉足 JS 的有趣部分：我正在递增会话计数器，但不同的请求看到相同的值。这只是 Chrome 中的一个问题。在 Firefox 和 Internet Explorer 中，每个请求都会看到一个唯一值。

我试图多次访问网页（处理数据），直到获得 204 HTTP 代码。我可以一次做一个 ajax 调用，方法是让 ajax 在成功时调用自身，然后在 204 处停止。

因为我想更快地完成它们，所以我在 js 中有多个“线程”都在这样做。我的意思是创建了多个相同的 ajax 调用，并且它们在完成时都会启动另一个调用，并在 204 代码处停止。

我的相关 js 如下所示：

```
$(function() {
    // "thread" id
    var counter = 1;

    // run 3 "threads"
    generateThreads(3);

    function generateThreads(num) {
        if (num <= 0)
            return;

        doNextItem(counter++);

        // Pause before starting the next thread
        setTimeout(function() {
                generateThreads(num-1);
            },
            50);
    }

    function doNextItem(thread) {
        $.ajax({
            url: URL,
            statusCode: {
                200: function(data) {
                    logItem(data, thread);
                    doNextItem(thread); // call itself on the same thread

                },
                204: function(data) {
                    finished(); // done, don't recurse, end the thread
                }
            }
        });
    }
}); 
```

然后在 PHP 中，我递增存储在 Session 中的整数，并在超过截止值时返回 204。

```
if (!isset($_SESSION["nums"]))
{
    $_SESSION["nums"] = 0;
}
else if ($_SESSION["nums"] > 10) {
    http_response_code(204);
    die();
}
echo json_encode(array("num" => $_SESSION["nums"]++)); 
```

然后当我运行它时，奇怪的部分就来了。javascript 中的 logItem() 只是将线程 ID 打印到控制台，然后是来自 php.ini 的数字。

**铬合金：**

```
1: 0 
2: 0 
2: 1 
1: 1 
3: 1 
2: 2 
1: 2 
3: 2 
1: 3 
2: 3 
3: 3 
3: 4 
1: 4 
2: 4 
3: 5 
2: 5 
1: 5 
2: 6 
3: 6 
1: 6 
1: 7 
2: 7 
3: 7 
1: 8 
3: 8 
2: 8 
1: 9 
2: 9 
3: 9 
2: 10
1: 10
3: 10 
```

**火狐/IE**

```
1: 0
2: 1
3: 2
1: 3
2: 4
3: 5
1: 6
2: 7
3: 8
1: 9
2: 10
3: 11
1: 12
2: 13
3: 14
1: 15
2: 16 
3: 17 
1: 18  
2: 19 
3: 20 
```

为什么 chrome 会给我重复的值？

**更新**

真正可疑的是，每个数字的重复数完全等于同时进行的 ajax 调用的数量。永远不会更少，永远不会更多，但正是如此。如果我同时运行 6 个 ajax 调用，它们都会得到相同的数量。如果这是一个时间问题，它就不会那么一致，特别是因为我抵消了彼此不同的 ajax 调用。这对我来说意味着这是一个 javascript 问题，不一定只是一个 php 问题，因为它以前出现过。

**更新的巨大游戏改变** 这只是 Chrome 中的一个问题。在 Firefox 或 Internet Explorer 中不会发生。在 Firefox 和 IE 中，每个请求都会获得一个新的计数器值。显然这是一个客户端问题。对这些信息进行更多研究会发现很多关于无效请求执行重定向会终止会话的事情。特别是 favicon.ico 的常见场景。我所有的请求都成功了，我的 favicon.ico 也成功加载了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T10:45:53.340

Chrome 正在缓存响应，因为您在短时间内多次发送相同的请求。强制 ajax 调用不缓存响应应该可以解决您的问题。尝试这个：

```
$.ajax({
    url: URL,
    cache: false,
    statusCode: {
... 
```

# mysql - 如何使用 Codeigniter 从数据库中读取多语言站点的不同条目？

> ID：15317794
> 
> 赞同：0
> 
> 时间：2013-03-10T01:09:53.787
> 
> 标签：mysql, database, codeigniter, multilingual

我找不到这个问题的答案......我正在制作一个基于 Codeigniter 和 MySQL 数据库的多语言网站。对于静态语言文本，我使用内置 lang 函数并根据 URL /en/ /fr/... 的第一段我正在加载适当的语言文件，但是如何加载和显示相应的数据从数据库？我什至如何将数据保存在数据库中？我有产品表，其中一半条目是数值，但另一半是应该以 2 或 3 种语言保存的文本。

我有我的逻辑来保持 name_en 和 name_fr、description_en 和 description_fr...所有这些都在同一个表中，所以当我添加新语言时，我会将这些行加倍。当我将进行 Select 查询时，我会将段“en”传递给查询并连接到 name_ 或 description_ 的末尾，因此它将成为 name_en 或 description_fr 或 category_es。

我希望有更好的方法，你们中的一些已经使用过的人会帮助我完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T20:16:47.527

我正在使用两个表来支持多语言。第一个表包括项目字段。例如日期、投票等。语言字段的第二个表。

```
CREATE TABLE `item` (
  `item_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `nested_category_id` int(11) DEFAULT NULL,
  `image_file` varchar(100) NOT NULL,
  `date` varchar(0) DEFAULT NULL,
  PRIMARY KEY (`item_id`)
);

CREATE TABLE `item_lang` (
  `item_lang_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `lang_id` varchar(2) NOT NULL,
  `item_id` int(11) unsigned NOT NULL,
  `url_name` varchar(255) NOT NULL DEFAULT '',
  `meta_title` varchar(255) DEFAULT NULL,
  `meta_description` text,
  `meta_keywords` varchar(255) DEFAULT NULL,
  `name` varchar(255) NOT NULL,
  `title` varchar(255) DEFAULT NULL,
  `description` text,
  PRIMARY KEY (`item_lang_id`)
); 
```

如果你需要一行试试这样。

```
function get_row( $id, $lg='tr'){

        $arr = array($id, $lg);

        $sql    = " SELECT ".$this->_table.".*, ".$this->_table_lang.".*
                     FROM ".$this->_table." 
                LEFT JOIN ".$this->_table_lang." 
                       ON ".$this->_table.".".$this->_table."_id = ".$this->_table_lang.".".$this->_table."_id 
                    WHERE ".$this->_table.".".$this->_table."_id = ? 
                      AND ".$this->_table_lang.".lang_id=?";

        $data   = $this->db->query($sql, $arr); 

        return ($data->row());
    } 
```

# google-maps-api-3 - 当 Google Maps API v3 信息窗口关闭时，Knockout 失去绑定

> ID：15317796
> 
> 赞同：1
> 
> 时间：2013-03-10T01:09:58.663
> 
> 标签：google-maps-api-3, knockout.js

我将数据绑定到一个 div，然后将其设置为 InfoWindow 的内容。单击地图上的标记时，我正在更改绑定的 observable，这会更新信息窗口中的内容。在关闭信息窗口之前，所有这些都可以正常工作。谷歌地图从 DOM 中删除了信息窗口，以及我的绑定了它的 div。重新打开信息窗口会导致其内容被冻结在关闭时的状态。

对 observable 的任何更改都不再更新 ui，包括使用 valueHasMutated。我试过只是重置信息窗口的内容并重新绑定，但 JQuery 元素仍然存在并且我得到了重复的内容。我也尝试过使用 cleanNode 和重新绑定，但也得到了重复的内容。

我也绑定的div：

```
<div id="placeTmpl" data-bind="with: place">
        <h3>
            <a data-bind="text: name, attr: { 'href': detailsUrl($data) }"></a>
        </h3>
</div> 
```

谷歌地图信息窗口：

```
window.infoWindow = new window.google.maps.InfoWindow({
    content: ''
});
window.infoWindow.setContent($('#placeTmpl')[0]); 
```

事件监听器和更新 observable

```
window.google.maps.event.addListener(marker, "click", function() {
    window.viewModel.openInfoWindow(marker, data);
});

self.openInfoWindow = function (marker, data) {
   for (var i = 0; i < self.places().length; i++) {
        if (self.places()[i].placeId == data.PlaceId) {
            self.place(self.places()[i]);
        }
    }
    window.infoWindow.open(map, marker);
}; 
```

就像我说的，这一切都很好，直到信息窗口关闭。我只是在寻找一种方法来强制淘汰赛再次开始更新 ui 或在信息窗口关闭时清除并重新绑定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:59:13.200

我可以通过将 InfoWindow 内容设置为 html 字符串而不是 DOM 节点来解决这个问题。

IE：

```
window.infoWindow.setContent($('#placeTmpl').html()); 
```

而不是：

```
window.infoWindow.setContent($('#placeTmpl')[0]); 
```

通过这样做，带有敲除绑定的 html 保持在原位，而不是被转移到随后在关闭时被销毁的信息窗口中。Knockout 现在像往常一样更新有界 DOM 元素，我只是在每次点击时使用 html 字符串更新信息窗口。

如果您尝试将淘汰赛绑定放在 Google Maps InfoWindow 中，那么您将度过一段糟糕的时光。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-12T22:08:30.773

我能够解决这个问题，而不必在调用时使用字符串`setContent`。在我的例子中，信息窗口具有在信息窗口打开时会更新的动态元素，因此字符串解决方案不会考虑到这一点。

我添加了一个`closeclick`处理程序，在该处理程序中我跟踪传递给信息窗口的原始 DOM 元素，并在信息窗口取出后将元素添加回正文。这使淘汰赛感到高兴，并且信息窗口不在乎。

```
var $node = $('#placeTmpl');

var infoWindow = new google.maps.InfoWindow({
    content: $node[0]
});

google.maps.event.addListener(infoWindow, "closeclick", function () {
    //google maps will destroy this node and knockout will stop updating it
    //add it back to the body so knockout will take care of it
    $("body").append($node);
}); 
```

# android - 覆盖 onCreateDialog() 时的类型不兼容

> ID：15317800
> 
> 赞同：1
> 
> 时间：2013-03-10T01:10:31.923
> 
> 标签：android, scala, compiler-errors

我正在尝试使用 Scala 2.9.2 创建一个 Android 应用程序。到目前为止，我已经完成了所有要编译的工作。

但是，当我在活动中执行以下操作时遇到问题：

```
override def onCreateDialog(id: Int) { 
```

编译器抱怨一个不兼容的类型，因为`Activity.onCreateDialog()`它需要一个原语`int`，但我正在传递一个`scala.Int`.

以下是编译错误：

```
error: overriding method onCreateDialog in class Activity of type (x$1: Int)android.app.Dialog;
[INFO]  method onCreateDialog has incompatible type
[INFO]   override def onCreateDialog(id: Int) {
[INFO]                ^
[ERROR] one error found 
```

我认为这些将是兼容的。

谁能建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T08:26:49.080

以下是针对 Scala 2.10 的，但我*认为*错误的原因与 Scala 2.9.x 完全相同。

顺便说一句，`onCreateDialog(int)`该类型的方法`Activity`已被弃用，但它不是重点。

现在，无论如何我都不是 Scala 专家，但据我所知，不返回任何内容的函数看起来确实`def fun(arg) {}`像`def fun(arg) = {}`. 注意**=**。如果需要，您还可以拼出返回类型。

所以我试图覆盖你提到的方法，这是（简单的）实现：

```
override def onCreateDialog(id : Int) = {
    super.onCreateDialog(id)
} 
```

它编译并运行得很好。当你删除**=**时，你会得到你现在遇到的错误：

> 类型方法`onCreateDialog`类中的覆盖方法具有不兼容的类型`Activity``(x$1: Int)android.app.Dialog;``onCreateDialog`

整体`MainActivity`：

```
class MainActivity extends Activity {
    override def onCreate(savedInstanceState : Bundle) {
      super.onCreate(savedInstanceState)
      setContentView(R.layout.activity_main_activity)
    }

    override def onCreateDialog(id : Int) = {
        super.onCreateDialog(id)
    }   
} 
```

*注意：我使用 ADT 和捆绑的 Eclipse（Juno），创建了一个默认的 Android 项目，包括 Scala-IDE（Scala 特性）和 AndroidProguardScala（AndroidProguardScala 特性）*

# python - Python NonExistentTimeError

> ID：15317803
> 
> 赞同：6
> 
> 时间：2013-03-10T01:11:16.367
> 
> 标签：python, django, python-datetime

我正在创建一个使用访问令牌的简单 Django API。这个想法是，当用户请求令牌时，所述令牌在接下来的 7 小时内有效。

但是，在生成令牌时，我获得了 Python NonExistentTimeError。代码是：

```
 #Django view
 ...
 expires = datetime.datetime.now() + datetime.timedelta(hours=7)

 token = APIMasterToken.objects.create(
     token=token,
     expiration_date=expires
 ) 
```

但是，我获得了一个异常，生成了具有所述日期的令牌：

```
NonExistentTimeError at /api/obtain_master_token/
2013-03-10 02:05:12.179508 
```

这个错误是什么意思，我该如何解决？

编辑：我刚刚阅读了文档，当发生在 DST 之后时钟发生变化的一天时，会出现此错误。但是，我不知道如何解决这个问题。timedelta 函数不应该解决这个问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T02:57:22.893

Django 期望使用[时区感知的日期时间对象](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/#naive-and-aware-datetime-objects)。

从 Django 文档中，`now()`调用将变为：

```
import datetime
from django.utils.timezone import utc

now = datetime.datetime.utcnow().replace(tzinfo=utc)
expires = now + datetime.timedelta(hours=7) 
```

更好的是，`now()`使用`django.utils.timezone`.

两者都`datetime.now()`返回`datetime.utcnow()`天真`datetime`的对象，这不是 Django 需要的。将时区应用到 后`expires`，Django 就能够转换回 UTC，以便在数据库后端存储为 UTC。

`NonExistentTimeError`实际上是由`pytz`模块中的代码抛出的。pytz[文档](http://pytz.sourceforge.net/)绝对值得一读，因为在处理时区时有很多陷阱。

# java - 转换字符串时出现数字格式异常

> ID：15317806
> 
> 赞同：0
> 
> 时间：2013-03-10T01:12:14.470
> 
> 标签：java, runtime-error, numberformatexception, string-conversion

以下代码将不会运行并继续在错误是“线程中的异常“main”java.lang.NumberFormatException：对于输入字符串：“SAN 1905 1808+24 1512+17 1209+10 1708 -06 2016-16 211831 211941 192652"""

```
intAlt = Integer.parseInt(strAlt); 
```

我不确定为什么会发生这种情况，并希望就此事提供任何建议

```
private int getPos(String strAlt)
{
 int intAlt;
 int intPos =0;
 intAlt = Integer.parseInt(strAlt);
 switch (intAlt)
 {
  case 3:
   intPos = 4;
   break;
  case 6:
   intPos = 9;
   break;
  case 9:
   intPos = 17;
   break;   
  case 12:
   intPos = 25;
   break;
  case 18:
   intPos = 33;
   break;   
  case 24:
   intPos = 41;
   break; 
  case 30:
   intPos = 49;
   break;   
  case 34:
   intPos = 56;
   break;   
  case 39:
   intPos = 63;
   break;  
 }
 return intPos;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:34:52.557

如果将“SAN 1905 1808+24 1512+17 1209+10 1708-06 2016-16 211831 211941 192652”传递给 getPos(String strAlt)，它将执行：

```
intAlt = Integer.parseInt(strAlt); 
```

当然会抛出异常。 [请参阅此文档](http://www.tutorialspoint.com/java/number_parseint.htm)

# sql - 在 PostgreSQL 中是否有一个需要一年、一个月和一天才能创建日期的函数？

> ID：15317807
> 
> 赞同：31
> 
> 时间：2013-03-10T01:12:16.710
> 
> 标签：sql, postgresql, sql-date-functions

在文档中，我只能找到一种从字符串创建日期的方法，例如`DATE '2000-01-02'`. 这完全令人困惑和烦人。我想要的是一个接受三个参数的函数，所以我可以`make_date(2000, 1, 2)`使用整数而不是字符串，并返回一个日期（不是字符串）。PostgreSQL有这样的内置功能吗？

我问这个的原因是因为我不喜欢将字符串用于不是字符串的东西。日期不是字符串；他们是约会。

我使用的客户端库是用于 Haskell 的 HDBC-PostgreSQL。我正在使用 PostgreSQL 9.2.2。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2016-02-03T18:35:00.477

在 PostgreSQL 9.4 及更高版本中，实际上有一个`make_date(year int, month int, day int)`函数可以创建日期。

[http://www.postgresql.org/docs/9.5/static/functions-datetime.html](http://www.postgresql.org/docs/9.5/static/functions-datetime.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-10T01:45:52.573

通常需要在 SQL 中执行此操作通常表示您的数据模型存在问题，您将日期拆分为数据库中的字段而不是真实日期或时间戳字段，或者您有严重的转义和 SQL 注入问题。请参阅下面的说明。

以下任何一项都可以解决您的直接问题：

```
CREATE OR REPLACE FUNCTION make_date(year integer, month integer, day integer) AS $$
SELECT year * INTERVAL '1' YEAR + month * INTERVAL '1' MONTH + day * INTERVAL '1' DAY;
$$ LANGUAGE sql STRICT IMMUTABLE; 
```

或者

```
CREATE OR REPLACE FUNCTION make_date(year integer, month integer, day integer) AS $$
SELECT format('%s-%s-%s', year, month, day)::date;
$$ LANGUAGE sql STRICT IMMUTABLE; 
```

但请继续阅读。

* * *

你问这个的事实让我觉得你可能正在尝试在你的应用程序中构建 SQL，如下所示：

```
$sql = "SELECT date'" + year + '-' + month + '-' + day + "';"; 
```

这通常是*危险*和*错误*的（尽管 if 可能不是直接不安全的`year`，`month`并且`day`是整数数据类型）。如果您这样做是为了避免[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)并为自己省去很多转义和文字格式的麻烦，那么您应该使用*参数化查询。*请参阅[http://bobby-tables.com/](http://bobby-tables.com/)。

以下是在 Python 中使用带有 psycopg2 的参数化语句查询日期的方法（因为您没有指定语言或工具）：

```
import datetime
import psycopg2
conn = psycopg2.connect('')
curs = conn.cursor()
curs.execute('SELECT %s;', ( datetime.date(2000,10,05), ))
print repr(curs.fetchall()); 
```

这将打印：

```
[(datetime.date(2000, 10, 5),)] 
```

即一个包含单个 Python 日期的数组。您可以看到它一直在通过数据库进行往返，而且您不必担心 PostgreSQL 的日期格式或表示，因为当您使用参数化语句时，psycopg2 和 PostgreSQL 会为您处理这些问题。请参阅[此较早的相关答案](https://stackoverflow.com/a/12317363/398670)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-05-18T15:10:33.137

其他值得尝试的是`to_date()`功能。它类似于上面提到的绑定，不需要创建用户定义的函数。

[http://www.postgresql.org/docs/current/static/functions-formatting.html](http://www.postgresql.org/docs/current/static/functions-formatting.html)

我以这种形式使用它：

```
to_Date(month::varchar ||' '|| year::varchar, 'mm YYYY') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-01T14:13:20.767

你可以使用 date(concat())

```
select date(concat(2000::varchar, '-01-01')) 
```

# xcode - xCode 快照似乎不起作用

> ID：15317812
> 
> 赞同：2
> 
> 时间：2013-03-10T01:13:22.170
> 
> 标签：xcode, restore, snapshot

似乎和这个人有同样的问题：

[Xcode 恢复快照什么都不做](https://stackoverflow.com/questions/12078373/xcode-restoring-snapshot-does-nothing)

在尝试某些事情之前，我一直在创建快照，并且从未需要恢复快照。

几天前我尝试过，xCode 向我展示了代码之间的差异，太好了。

我点击恢复，它说它已经完成了任务，但是代码和以前一样！我现在再次单击恢复，xCode 说没有代码差异！如果我确实需要修复，非常令人沮丧和担忧！

帮助！

我正在使用 xCode 4.6

# linux - 如何计算平面文件单列中每个术语的出现次数？

> ID：15317813
> 
> 赞同：1
> 
> 时间：2013-03-10T01:13:32.397
> 
> 标签：linux, bash, awk

我有以下平面文件`employees.txt`

```
100  Thomas  Manager    Sales       $5,000
200  Jason   Developer  Technology  $5,500
300  Sanjay  Sysadmin   Technology  $7,000
400  Nisha   Manager    Marketing   $9,500
500  Randy   DBA        Technology  $6,000 
```

我想统计每个部门的人数。我知道有更短的方法可以使用类似的命令来执行此操作，`awk '{print $4}' employees.txt | sort | uniq -c`但我想学习 while 循环的机制，逐行读取输入

```
#!/bin/bash
awk '{print $4}' employees.txt > temp_file

array=[]
while read line
do
        if [[ $array[$line] ]]
        then
                $array[$line]=$(($array[$line]+1))
        else
                $array[$line]=0
        fi
done < temp_file 
```

当我运行这个脚本时，我得到了错误`./process.sh: line 9: [][Sales]+1: syntax error: operand expected (error token is "[][Sales]+1")`

另外-在关键字之后是否可以使用语法`done`来获取第四列中的条目？我试过`done < awk '{print $4}' employees.txt`了，但这是不正确的。

另外-有没有办法可以将输出存储`awk '{print $4}' employees.txt > temp_file`在变量而不是临时文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:30:52.293

```
#!/bin/bash

awk '{print $4}' employees.txt > temp_file
declare -A array
while read line
do
        if [[ ${array["$line"]} ]]; then
          array["$line"]=$(( ${array["$line"]} + 1 ))
        else
          array["$line"]=1
        fi
done < temp_file

for k in "${!array[@]}"; do
  echo "$k ${array[$k]}"
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T07:56:53.443

不需要使用 awk。你可以尝试这样的事情：

```
#!/bin/bash       # bash 4
declare -A DEPARTMENT
while read -a field
do
  (( DEPARTMENT[${field[3]}]++ ))
done < employees.txt

for dep in "${!DEPARTMENT[@]}"
do
  printf "%s\n" "$dep ${DEPARTMENT[$dep]}"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:16:55.030

```
array=[] 
```

是不正确的。Bash 数组是这样声明的

```
declare -A array=() 
```

或者也许只是

```
array=() 
```

> 另外-在 done 关键字之后是否可以使用语法来获取第四列中的条目？我试过`done < awk '{print $4}' employees.txt`

您可以尝试进程替换

```
done < <(awk '{print $4}' employees.txt) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-10T19:33:04.110

两个解决方案，第一个 in `bash`（类似于，但比其他给定解决方案更简洁 - 消除使用`awk`拉出第四列，而不是使用`read`）。

一、`bash`实现：

```
#!/usr/bin/bash

declare -A dept
while read -r _ _ _ d _; do
   ((dept[$d]++))
done <<-'!'
100  Thomas  Manager    Sales       $5,000
200  Jason   Developer  Technology  $5,500
300  Sanjay  Sysadmin   Technology  $7,000
400  Nisha   Manager    Marketing   $9,500
500  Randy   DBA        Technology  $6,000
!

for d in "${!dept[@]}"; do
   printf '%s %d\n' "$d" "${dept[$d]}"
done 
```

`awk`实现非常相似：

```
awk '
   {
      dept[$4]++;
   }
   END {
      for (d in dept)
         print d, dept[d]
   }
' <<'!'
100  Thomas  Manager    Sales       $5,000
200  Jason   Developer  Technology  $5,500
300  Sanjay  Sysadmin   Technology  $7,000
400  Nisha   Manager    Marketing   $9,500
500  Randy   DBA        Technology  $6,000
! 
```

# javascript - 如何在 javascript 中调用未命名的实例？

> ID：15317815
> 
> 赞同：2
> 
> 时间：2013-03-10T01:13:45.123
> 
> 标签：javascript, class, object, instance

因此，如果我创建一个类，然后在不命名它们的情况下创建该类的新实例 - 也许使用创建一堆实例的循环 - 我如何调用特定（或非特定）实例？例如，如果我正在生成一堆正方形，但我想将一个特定的移动到某个地方，我该怎么做？

对不起，如果这是一个完全的菜鸟问题，或者我错过了一些术语，但我对编程很陌生。

示例代码：

```
function example(x){
    this.x = x;
}

for(var i=0; i<10; i++){
    new example(1);
}
//now how would I get a specific instance of examples to have x = say, 10. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:28:33.470

您可以将每个正方形放在一个数组中并以这种方式访问​​它们：

```
function Square(i){
    this.index = i;
}
Square.prototype = {
    constructor: Square,
    intro: function(){
        console.log("I'm square number "+this.index);   
    }
}

var squares = [];

for(var i = 0;i < 10;i++){
    squares.push(new Square(i));
}

squares.forEach(function(square){
    // do something with each square
    square.intro();
}); 
```

演示：http: [//jsfiddle.net/louisbros/MpcrT/1/](http://jsfiddle.net/louisbros/MpcrT/1/)

# paypal - sandbox.paypal.com返回tomcat错误HTTP Status 404正常吗

> ID：15317816
> 
> 赞同：1
> 
> 时间：2013-03-10T01:13:46.363
> 
> 标签：paypal

我第一次尝试设置 Paypal PDT 并希望针对沙箱对其进行测试。

当我尝试访问[http://sandbox.paypal.com](http://sandbox.paypal.com)时，我被转发到[https://www.sandbox.paypal.com/hk/webapps/mpp/home](https://www.sandbox.paypal.com/hk/webapps/mpp/home)，然后我收到 Tomcat 生成的错误（ 404）。

这正常吗？这个网站是否只能通过 API 使用？直接在浏览器中打开它时我做错了吗？

在常见问题解答下，我可以阅读

> 我是非美国开发人员。网站重新设计对我有何影响？
> 
> 当前新的 REST API 和 PayPal 移动 SDK 目前仅针对美国市场。我们将在今年剩余时间内在所有地区推出。

这是一个原因吗？沙盒是 REST API 的一部分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:35:19.280

我带来的不便表示歉意。我们正在努力尽快解决此问题。同时，请尝试使用[https://www.sandbox.paypal.com/webapps/mpp/home](https://www.sandbox.paypal.com/webapps/mpp/home)作为登录的解决方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T03:52:44.610

只是想跟进并让您知道 404 问题已解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T11:45:04.790

不，在英国对我来说已经坏了。我尝试使用美国代理，无论您身在何处，似乎每个人都无法使用它。

最好只是坐下来等待，尽管与此同时我将使用其他东西。好样的，贝宝。

# python - 使用 pyrsvg 和 Cairo 在 Python 中渲染 SVG

> ID：15317817
> 
> 赞同：1
> 
> 时间：2013-03-10T01:13:56.347
> 
> 标签：python, rsvg

我在使用以下代码将一些 SVG 渲染为 PNG 数据时遇到了一些问题。使用 StringIO 编写器是因为图像最终旨在用作 HTTP 响应的主体。

结果是正确尺寸的 PNG，但它是完全透明的。

```
import rsvg
import cairo
import StringIO

def render_svg_to_png(svg_data):
    # Render
    svg = rsvg.Handle()
    svg.write(buffer=svg_data)

    img = cairo.ImageSurface(cairo.FORMAT_ARGB32,
                             svg.props.width,
                             svg.props.height)
    ctx = cairo.Context(img)
    svg.render_cairo(ctx)

    # Write to StringIO
    png_io = StringIO.StringIO()
    img.write_to_png(png_io)
    img.finish()

    return png_io.getvalue() 
```

被渲染的 SVG 数据如下：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
    <!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:cc="http://creativecommons.org/ns#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:svg="http://www.w3.org/2000/svg"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    version="1.1"
    width="40"
    height="40"
    id="svg2">
    <defs
        id="defs4">
        <linearGradient
        id="linearGradient3769">
        <stop
            id="stop3771"
            style="stop-color:#ffffff;stop-opacity:1"
            offset="0" />
        <stop
            id="stop3773"
            style="stop-color:#000000;stop-opacity:1"
            offset="1" />
        </linearGradient>
        <radialGradient
        cx="13.895907"
        cy="15.277355"
        r="19.6875"
        fx="13.895907"
        fy="15.277355"
        id="radialGradient3775"
        xlink:href="#linearGradient3769"
        gradientUnits="userSpaceOnUse"
        gradientTransform="matrix(0.96746783,-0.96746783,0.95701248,0.95701249,-12.884457,12.690532)" />
    </defs>
    <metadata
        id="metadata7">
        <rdf:RDF>
        <cc:Work
            rdf:about="">
            <dc:format>image/svg+xml</dc:format>
            <dc:type
            rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
            <dc:title></dc:title>
        </cc:Work>
        </rdf:RDF>
    </metadata>
    <g
        transform="translate(0,-1012.3622)"
        id="layer1">
        <path
            d="m 39.375,19.776785 a 19.6875,19.6875 0 1 1 -39.375,0 19.6875,19.6875 0 1 1 39.375,0 z"
            transform="matrix(1.015873,0,0,1.015873,0,1012.2715)"
            id="path2991"
            style="fill:url(#radialGradient3775);fill-opacity:1;fill-rule:nonzero;stroke:none" />
    </g>
</svg> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T02:35:05.610

在这里对我来说没问题：

```
import rsvg
import cairo
import StringIO

def render_svg_to_png(svg_data):
    # Render
    svg = rsvg.Handle(data=svg_data)
    img = cairo.ImageSurface(cairo.FORMAT_ARGB32, 
      svg.props.width, 
      svg.props.height)
    ctx = cairo.Context(img)
    svg.render_cairo(ctx)

    # Write to StringIO
    png_io = StringIO.StringIO()
    img.write_to_png(png_io)

    return png_io.getvalue()

svg_data = open('test.svg', 'r').read()
print render_svg_to_png(svg_data) 
```

通过将输出重定向到`.png`文件来运行它，并确认它在图像查看程序中正常运行。

# python - 用 Python 和 Numpy 计算协方差

> ID：15317822
> 
> 赞同：70
> 
> 时间：2013-03-10T01:14:44.480
> 
> 标签：python, numpy, covariance

我试图弄清楚如何使用 Python Numpy 函数 cov 计算协方差。当我将两个一维数组传递给它时，我会得到一个 2x2 的结果矩阵。我不知道该怎么办。我不擅长统计，但我相信这种情况下的协方差应该是一个数字。 [这](http://i.investopedia.com/inv/articles/site/Proper%20Covariance.gif)就是我要找的。我自己写了：

```
def cov(a, b):

    if len(a) != len(b):
        return

    a_mean = np.mean(a)
    b_mean = np.mean(b)

    sum = 0

    for i in range(0, len(a)):
        sum += ((a[i] - a_mean) * (b[i] - b_mean))

    return sum/(len(a)-1) 
```

那行得通，但我认为 Numpy 版本效率更高，如果我能弄清楚如何使用它的话。

有人知道如何使 Numpy cov 函数像我写的那样执行吗？

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-03-10T01:40:55.607

当`a`和`b`是一维序列时，`numpy.cov(a,b)[0][1]`等价于您的`cov(a,b)`.

返回的 2x2 数组的`np.cov(a,b)`元素等于

```
cov(a,a)  cov(a,b)

cov(a,b)  cov(b,b) 
```

（同样，`cov`您在上面定义的函数。）

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2016-08-23T10:12:25.097

感谢 unutbu 的解释。默认情况下 numpy.cov 计算样本协方差。要获得总体协方差，您可以通过总 N 个样本指定归一化，如下所示：

```
numpy.cov(a, b, bias=True)[0][1] 
```

或像这样：

```
numpy.cov(a, b, ddof=0)[0][1] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-05-13T16:35:07.340

请注意，从 开始`Python 3.10`，可以直接从标准库中获取协方差。

使用[`statistics.covariance`](https://docs.python.org/3.10/library/statistics.html?highlight=statistics#statistics.covariance)which 是两个输入的联合可变性的度量（您正在寻找的数字）：

```
from statistics import covariance

# x = [1, 2, 3, 4, 5, 6, 7, 8, 9]
# y = [1, 2, 3, 1, 2, 3, 1, 2, 3]
covariance(x, y)
# 0.75 
```

# html - 如何在 CSS 中显示/隐藏 3 级菜单导航？

> ID：15317823
> 
> 赞同：0
> 
> 时间：2013-03-10T01:14:58.073
> 
> 标签：html, css

我有这个html：

```
<ul>
  <li class="current"> level 1 </a>
    <ul>
      <li><a class="children">level 2</a>
        <ul>
          <li><a> level 3 </a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul> 
```

如何使用 css display none/block 创建一个简单的显示/隐藏？

目前正在这样做，但只能让我进入第二级，我在逻辑上有点卡住：

```
ul ul,
ul ul ul {
   display: none;
}

.current .children {
   display: block;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T01:21:07.180

很简单，到处都有几十个例子。稍微搜索一下可能会有所帮助。

```
ul ul {
    display: none;
}

ul > li:hover > ul {
    display: block;
}

ul > li > ul > li:hover ul {
    display: block;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T01:26:46.343

如果你想使用 jQuery，你可以查看[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

```
$('#yourlinkID').click(function() {
     $('#yourbodyID').toggle()
}); 
```

上面的代码在单击带有#yourlinkID 的元素时切换带有#yourbodyID 的元素的可见性。

希望这可以帮助 ：）

# python - PySide、信号和插槽 [NameError: globale name 'methodName' is not defined]

> ID：15317825
> 
> 赞同：0
> 
> 时间：2013-03-10T01:15:01.267
> 
> 标签：python, pyside, signals-slots

我是 Python 编程的新手，由于这个问题，我无法继续前进。

我的代码在上面：

```
#!/usr/bin/python3
# -*- coding: utf-8 -*-
"""
spike 1
9.03.2012
Kevin
"""

import sys

from PySide.QtCore import *
from PySide.QtGui import *

class GuiRenamator(QWidget):

    def __init__(self): # constructeur

        super(GuiRenamator, self).__init__() # je ne sais pas ce que c'est
        self.contenuGui()

    def dialogTest(self):
        dial_1 = QDialog()
        dial_1.setWindowTitle("Voici ce qui est écrit")
        text_dial_1 = QTextEdit()

        vblay_dial = QVBoxLayout()
        vblay_dial.addWidget(text_dial_1)

        self.setLayout(vblay_dial)

        # a bit of code
        if contenuGui.chk_ancienNom.isChecked():
            text_dial_1.append("- ajouter ancien nom")

        if contenuGui.chk_increment.isChecked():
            text_dial_1.append("- ajouter incrément")

        if contenuGui.chk_dateCreation.isChecked():
            text_dial_1.append("- ajouter date de création")

        dial_1.show()

    def contenuGui(self):

        lbl_nomDossier = QLabel("Nom du dossier: ")
        txt_nomDossier = QTextEdit()
        btn_selecDossier = QPushButton("+")
        chk_ancienNom = QCheckBox()
        chk_increment = QCheckBox()
        chk_dateCreation = QCheckBox()
        btn_ok = QPushButton("OK")
        **btn_ok.clicked.connect(dialogTest)**
        lbl_log = QLabel("Logs")
        txt_log = QTextEdit()

        # Layouts
        hblay_1 = QHBoxLayout()
        hblay_1.addWidget(btn_selecDossier)
        hblay_1.addWidget(lbl_nomDossier)
        hblay_1.addWidget(txt_nomDossier)

        flay_2 = QFormLayout()
        flay_2.addRow("Ancien nom", chk_ancienNom)
        flay_2.addRow("Incrément", chk_increment)
        flay_2.addRow("Date de création", chk_dateCreation)

        vblay_main = QVBoxLayout()
        vblay_main.addLayout(hblay_1)
        vblay_main.addLayout(flay_2)
        vblay_main.addWidget(btn_ok)
        vblay_main.addWidget(lbl_log)
        vblay_main.addWidget(txt_log)

        self.setLayout(vblay_main)

        self.setGeometry(300, 300, 300, 150)
        self.setWindowTitle("Ranamator")
        self.show()

def main():

    app = QApplication(sys.argv)
    gui = GuiRenamator()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

当我运行脚本时，会出现以下消息：

```
Traceback (most recent call last):
  File "./layout_spike_1.py", line 90, in <module>
    main()
  File "./layout_spike_1.py", line 86, in main
    gui = GuiRenamator()
  File "./layout_spike_1.py", line 20, in __init__
    self.contenuGui()
  File "./layout_spike_1.py", line 54, in contenuGui
    btn_ok.clicked.connect(dialogTest)
NameError: global name 'dialogTest' is not defined 
```

当我评论该行时：`btn_ok.clicked.connect(dialogTest)` 它工作正常，但我无法连接`QPushButton`到该`dialogTest`方法。

我提前谢谢你。

干杯，

凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:18:03.590

将该行替换为`btn_ok.clicked.connect(self.dialogTest)`

# f# - 定义一个 F# 函数并避免返回值

> ID：15317832
> 
> 赞同：3
> 
> 时间：2013-03-10T01:16:30.533
> 
> 标签：f#

定义一个函数，该函数具有一个字符串类型的参数，该参数显示在控制台上。调用传递消息的函数。确保函数忽略任何返回值

```
open System    
let NoReturnFunction msg =
    Console.WriteLine(string(msg))

NoReturnFunction "Hello World" 
```

我在如何避免函数返回值方面遇到麻烦

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T01:18:39.287

在这种情况下，没有工作可做，因为该`WriteLine`方法不返回任何值。这是一个`void`返回函数。通常，尽管在 F# 中忽略返回值的方法是使用该`ignore`函数。

```
1 + 2 |> ignore 
```

对您的代码示例进行了一些次要的挑剔。首先是您可以`string`通过简单地键入参数来避免强制转换。`printfn`第二在 F# 中使用函数而不是更惯用`Console.WriteLine`

```
let NoReturnFunction (msg : string) = 
    printfn "%s" msg 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:58:05.657

为了完整起见，您还可以让 F# 推断参数类型和返回类型——如下所示：

```
let NoReturnFunction st = printfn "%s" st 
```

这会推断 s 的类型和 NoReturnFunction 的返回类型（本例中为单位）。

# c++ - OpenGL中的多个视口和文本......也许是相机？

> ID：15317833
> 
> 赞同：2
> 
> 时间：2013-03-10T01:16:40.170
> 
> 标签：c++, opengl, camera, viewport

我必须有一个使用两个视口的 OpenGL 程序。在其中一个中，我必须有一个直升机模型，它带有一个工作摄像机，可以绕着它旋转。在我决定进行视口拆分之前，我让相机在模型上工作，因为它具有更高的优先级。另一个视口应该显示 FPS 计数器，但由于某种原因，我只能从特定角度看到文本。

我的代码如下：

```
 //sets up the viewports
    void setView(int option)
    {
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();

        switch (option)
        {
            case 1: 
                glViewport(0,height-150,width,150);
                break;
            case 2:
                glViewport(0,0,width,height-150);
                break;
        }
        if(persp)
            gluPerspective(fovy, (GLfloat) width /(GLfloat) height , near, far);
        else
            glOrtho(left,right,bottom,top,-10,10);  

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
        myCam.updateLook();
    }

    void writeBitmapString(void *font, char *string)
    {  
       char *c;
       for (c = string; *c != '\0'; c++) glutBitmapCharacter(font, *c);
    } 

    //main draw function
    void display(void)
    {   
        //Text portion of the window
        setView(1);
        glColor3f(1.0, 0.0, 0.0);
        glRasterPos3f(0, 0, 0.0);
        writeBitmapString((void*)font, "Test text");
        glutSwapBuffers();

        //Viewport for heli
        setView(2);
        glEnable(GL_DEPTH_TEST);
        glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);                
        glPushMatrix();
    //....The rest is just the modelling stuff
    glPopMatrix(); // final pop clause
    glFlush();
    glutSwapBuffers(); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T02:15:25.237

听起来你真的想要一个HUD（请原谅我对你的意图有双重猜测）。渲染您的场景，然后在模型视图和投影矩阵上执行 glLoadIdentity。然后加载你的 glOrtho。最后，为文本和渲染设置光栅位置。

# python - Object-C 中的 MD5 与结果不匹配

> ID：15317836
> 
> 赞同：1
> 
> 时间：2013-03-10T01:17:00.763
> 
> 标签：python, objective-c, hash, md5

我尝试使用 md5 散列一个字符串（十六进制）。然而，输出字符串与我在 python 或 javascript (node.js) 中创建的类似输出不匹配。

输入字符串：

```
NSString *input = @"001856413a840871624d6c6f553885b5b16fae345c6bdd44afb26141483bff629df47dbd9ad0";

- (NSString *)md5:(NSString *)input {
// b2b22e766b849b8eb41b22ae85dc49b1
unsigned char md5Buffer[CC_MD5_DIGEST_LENGTH];
const char *cStr = [input UTF8String];
CC_MD5_CTX ctx;
CC_MD5_Init(&ctx);
CC_MD5_Update(&ctx, cStr, [input length]);
CC_MD5_Final(md5Buffer, &ctx);

NSMutableString *output = [NSMutableString stringWithCapacity:CC_MD5_DIGEST_LENGTH * 2];
for(int i = 0; i < CC_MD5_DIGEST_LENGTH; i++)
    [output appendFormat:@"%02x",md5Buffer[i]];

return output; 
```

}

在python中我做：

```
binaryCredentialString = binascii.unhexlify(input)
# Now MD5 hash the binary string    
m = hashlib.md5()
m.update(binaryCredentialString)
# Hex encode the hash to obtain the final credential string
credential = m.hexdigest() 
```

Python 给了我正确的 md5 输出，object-C 没有。为什么是这样？

任何帮助都非常感谢 - 帕斯卡

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:20:50.563

在 Python 中，您将十六进制解码回二进制，但在 Objective-C 中，您不是。将您的字符串解码为一个`NSMutableData`实例，然后将`[data bytes]`（和`[data length]`）提供给摘要函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-10T02:56:34.823

这与dreamlax的答案基本相同，但您显然没有理解他的答案。希望我能提供帮助（但如果是这样，您应该接受他的回答）。

您的问题是您正在执行 76 字符字符串的 MD5，`@"001856413a840871624d6c6f553885b5b16fae345c6bdd44afb26141483bff629df47dbd9ad0"`而不是字符串编码的 38 字节二进制数据。

在 Python 中，输入`md5`函数的内容如下：

```
binaryCredentialString = binascii.unhexlify(input) 
```

但在 ObjC 中，是这样的：

```
const char *cStr = [input UTF8String]; 
```

所以，你需要一个等价的`unhexlify`.

我会通过向类别添加方法来处理这个`-(NSString *)hexlify`问题。然后你可以只写这段代码，它和 Python 一样可读：`NSData``-(NSData *)unhexlify``NSString`

```
- (NSString *)md5:(NSString *)input {
    NSData *binaryCredentialString = [input unhexlify];
    NSMutableData *result = [NSMutableData dataWithLength:CC_MD5_DIGEST_LENGTH];
    CC_MD5([binaryCredentialString bytes],
           [binaryCredentialString length],
           [m mutableBytes]);
    return [result hexlify];
} 
```

那么，您如何编写这些类别？使用你的代码，以及它的反面，像这样（未经测试，需要一些验证和错误处理，但你应该明白）：

```
@implementation NSData(hexlify)
- (NSString *)hexlify {
    unsigned char *buf = [self bytes];
    size_t len = [self length];
    NSMutableString *output = [NSMutableString stringWithCapacity:len * 2];
    for(int i = 0; i < len; i++)
        [output appendFormat:@"%02x",buf[i]];
    return [NSData dataWithData:output];
}
@end

static unsigned char unhexchar(char c) {
    if (c <= '9') return c - '0';
    if (c <= 'F') return c - 'A' + 10;
    return c - 'a' + 10;
}

@implementation NSString(hexlify)
- (NSData *)unhexlify {
    const char *cStr = [self UTF8String];
    size_t len = [self length];
    NSMutableData *output = [NSMutableData dataWithLength:len / 2];
    unsigned char *buf = [output mutableBytes];
    for(int i = 0; i < len / 2; i++)
        buf[i] = unhexchar(cStr[i*2]) * 16 + unhexchar(cStr[i*2+1]);
    return [NSString stringWithString:output];
}
@end 
```

但我确信通过一些搜索，您可以找到这两种方法的干净、经过测试和优化的实现，而不是自己编写它们。例如，在 SO 上查看[这个问题](https://stackoverflow.com/questions/2338975/convert-hex-data-string-to-nsdata-in-objective-c-cocoa)、[这个问题以及其他各种问题。](https://stackoverflow.com/questions/1305225/best-way-to-serialize-a-nsdata-into-an-hexadeximal-string)

# ruby-on-rails - 将记录批量插入 Active Record 表

> ID：15317837
> 
> 赞同：19
> 
> 时间：2013-03-10T01:17:10.810
> 
> 标签：ruby-on-rails, activerecord, bulkinsert

`Model.create!`当我一次添加大量记录时，我发现我的语句需要很长时间才能运行。查看了[ActiveRecord-Import](https://github.com/zdennis/activerecord-import/wiki)，但它不适用于哈希数组（这是我所拥有的，我认为这很常见）。我怎样才能提高性能？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-10T02:21:44.090

使用[activerecord-import](https://github.com/zdennis/activerecord-import) gem。假设您正在读取 CSV 文件并生成`Product`目录，并且您希望以 1000 条为一组插入记录：

```
batch,batch_size = [], 1_000 
CSV.foreach("/data/new_products.csv", :headers => true) do |row|
  batch << Product.new(row)

  if batch.size >= batch_size
    Product.import batch
    batch = []
  end
end
Product.import batch 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-10T01:17:10.810

感谢 Chris Heald @cheald 的 2009 年[文章](http://www.coffeepowered.net/2009/01/23/mass-inserting-data-in-rails-without-killing-your-performance/)，向我展示了最好的方法是多行插入命令。

将以下代码添加到我的`initializers/active_record.rb`文件中，将我的`Model.create!(...)`调用更改为`Model.import!(...)`然后消失。几个警告：

1）它不验证数据。
2) 它使用 SQL INSERT 命令的形式，读起来像 ...

```
INSERT INTO <table> (field-1, field-2, ...) 
       VALUES (value-1-1, value-1-2, ...), (value-2-1, value-2-2, ...), ...` 
```

...这可能不是所有数据库的正确语法，但它适用于 Postgres。为您的 SQL 版本更改适当语法的代码并不难。

在我的特殊情况下，使用“model.create！”将 19K+ 记录插入我的开发机器（配备 8GB RAM、2.4GHz Intel Core i5 和 SSD 的 MacBook Pro）上的一个简单表中，从 223 秒开始。使用 'model.import!' 到 7.2 秒。

```
class ActiveRecord::Base

  def self.import!(record_list)
    raise ArgumentError "record_list not an Array of Hashes" unless record_list.is_a?(Array) && record_list.all? {|rec| rec.is_a? Hash }
    key_list, value_list = convert_record_list(record_list)        
    sql = "INSERT INTO #{self.table_name} (#{key_list.join(", ")}) VALUES #{value_list.map {|rec| "(#{rec.join(", ")})" }.join(" ,")}"
    self.connection.insert_sql(sql)
  end

  def self.convert_record_list(record_list)
    key_list = record_list.map(&:keys).flatten.uniq.sort

    value_list = record_list.map do |rec|
      list = []
      key_list.each {|key| list <<  ActiveRecord::Base.connection.quote(rec[key]) }
      list
    end

    return [key_list, value_list]
  end
end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-16T18:16:19.237

我开始遇到大量记录（> 10000）的问题，因此我修改了代码以一次处理 1000 条记录。这是新代码的链接：

[https://gist.github.com/jackrg/76ade1724bd816292e4e](https://gist.github.com/jackrg/76ade1724bd816292e4e)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-22T23:11:48.630

对于 Rails 6.x 使用[insert_all](https://edgeapi.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html#method-i-insert_all)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-18T15:46:05.607

您还可以使用[activerecord-insert_many](https://github.com/concordia-publishing-house/activerecord-insert_many) gem。只需制作一组对象！

```
events = [{name: "Movie Night", time: "10:00"}, {name: "Tutoring", time: "7:00"}, ...]

Event.insert_many(events) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-11T17:17:12.660

使用事务可以大大加快批量插入的速度！

```
Model.transaction do
    many.times{ Model.create! }
end 
```

如果涉及多个模型，为每个模型做一个 Model.transaction ，这会受到影响：

```
Model1.transaction do
    Model2.transaction do
        many.times do
            m1 = Model1.create!
            m1.add_model2
        end
    end
end 
```

# python - 正则表达式不匹配括号中的任何内容，仅匹配字母、数字和空格，点后不匹配

> ID：15317841
> 
> 赞同：0
> 
> 时间：2013-03-10T01:17:43.580
> 
> 标签：python, regex

例如，我有一个文件名`[foo] FooBar[!].bar`

如何使用正则表达式匹配`FooBar`但不匹配`[foo]`，`[!]`或`.bar`

顺便说一句，我正在使用 Python Regex，如果这有任何影响的话。

基本上，我想匹配不在点之后或不在括号中的任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T01:28:40.270

```
fileName = '[abc][def]Real Name[!].exe'
name = re.search('(\[[^]]*\])*([\w\s]+)', fileName).group(2)
print name 
```

这应该打印“真实姓名”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:30:26.437

```
(?:^|])(?!\.)([\w\s]+)(?:\[|$)' 
```

`]`这应该匹配任何由and或开始和结束字符串包围的单词+空格组合，并且`[`前面没有点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:33:24.717

你可以全部替换：

```
>>> re.sub(r'\[.*?\]|\..*', '', '[foo] FooBar[!].bar')
    ' FooBar' 
```

# facebook - 像框“查看更多”不起作用

> ID：15317845
> 
> 赞同：2
> 
> 时间：2013-03-10T01:18:18.443
> 
> 标签：facebook, facebook-like

我在我们的网站上放了一个 Like Box 并且工作正常，但有一个例外......在较长的帖子中，它为您提供了一个可点击的“查看更多”选项来扩展框中的帖子。当我单击“查看更多”时，没有任何反应。

我已将所有内容移至 www.cucharavillage.com/test.html 的测试页面，以便我可以使用不同的代码选项并尝试找出答案。

它不适用于 Firefox 或 IE。有什么建议么？

# django - 在 Windows 上运行 django-celery。EOF错误

> ID：15317850
> 
> 赞同：1
> 
> 时间：2013-03-10T01:18:41.827
> 
> 标签：django, windows, python-2.7, pickle, django-celery

我正在使用 Windows 7 64 位。我安装了最新版本的台球、django-celery 和 kombu。包括我：

```
import djcelery
djcelery.setup_loader() 
```

到我的项目setting.py

当我从项目的根目录运行以下命令时：

```
python manage.py celeryd -l info 
```

我收到以下消息（这是消息的最后一部分）：

```
File "c:\python27\lib\pickle.py", line 562, in save_tuple
    save(element)
  File "c:\python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "c:\python27\lib\pickle.py", line 548, in save_tuple
    save(element)
  File "c:\python27\lib\pickle.py", line 306, in save
    rv = reduce(self.proto)
  File "c:\python27\lib\site-packages\celery\app\base.py", line 412, in __reduce__
    (self.__class__, self.Pickler) + self.__reduce_args__(),
  File "c:\python27\lib\site-packages\celery\app\base.py", line 422, in __reduce_args__
    else self.conf._pickleable_changes())
  File "c:\python27\lib\site-packages\celery\app\utils.py", line 77, in _pickleable_changes
    R.update(d)
TypeError: 'LazySettings' object is not iterable

C:\sources\tourtle>Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "c:\python27\lib\site-packages\billiard\forking.py", line 530, in main
    self = load(from_parent)
  File "c:\python27\lib\pickle.py", line 1378, in load
    return Unpickler(file).load()
  File "c:\python27\lib\pickle.py", line 858, in load
    dispatch[key](self)
  File "c:\python27\lib\pickle.py", line 880, in load_eof
    raise EOFError
EOFError 
```

我安装了 MinGW 并将 distutils.cfg 添加到 c:\MinGW\bin 但它没有帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T07:50:54.927

在 github 上查看这个讨论：

[https://github.com/celery/django-celery/issues/228](https://github.com/celery/django-celery/issues/228)

一种解决方法是您按照 asksol 建议的方式更改 celery/app/base.py（第 418-419 行）：

从：

```
conf = (self.conf.changes if _forking._forking_is_enabled
        else self.conf._pickleable_changes())' 
```

至：

```
conf = (self.conf.changes if _forking._forking_is_enabled
        else {}) 
```

然后它应该可以正常工作

# python - Cython：numpy 数组的无符号整数索引给出不同的结果

> ID：15317851
> 
> 赞同：7
> 
> 时间：2013-03-10T01:18:44.400
> 
> 标签：python, numpy, cython

我通过添加一些类型并编译它来转换为 cython 一个 python 函数。我在 python 和 cython 函数的结果之间得到了小的数值差异。经过一些工作，我发现差异来自使用 unsigned int 而不是 int 访问 numpy 数组。

我正在使用无符号整数索引来加快访问速度：http: [//docs.cython.org/src/userguide/numpy_tutorial.html#tuning-indexing-further](http://docs.cython.org/src/userguide/numpy_tutorial.html#tuning-indexing-further)

无论如何，我认为使用无符号整数是无害的。

请参阅此代码：

```
cpdef function(np.ndarray[np.float32_t, ndim=2] response, max_loc):
    cdef unsigned int x, y   
    x, y = int(max_loc[0]), int(max_loc[1])
    x2, y2 = int(max_loc[0]), int(max_loc[1])
    print response[y,x], type(response[y,x]), response.dtype
    print response[y2,x2], type(response[y2,x2]), response.dtype   
    print 2*(response[y,x] - min(response[y,x-1], response[y,x+1]))
    print 2*(response[y2,x2] - min(response[y2,x2-1], response[y2,x2+1])) 
```

印刷：

```
0.959878861904 <type 'float'> float32
0.959879 <type 'numpy.float32'> float32
1.04306024313
1.04306030273 
```

为什么会出现这种情况？！！！这是一个错误吗？

好的，这里要求的是一个 SSCCE，其类型和值与我在原始函数中使用的相同

```
cpdef function():
    cdef unsigned int x, y  
    max_loc2 = np.asarray([ 15., 25.], dtype=float) 
    cdef np.ndarray[np.float32_t, ndim=2] response2 = np.zeros((49,49), dtype=np.float32)    
    x, y = int(max_loc2[0]), int(max_loc2[1])
    x2, y2 = int(max_loc2[0]), int(max_loc2[1])

    response2[y,x] = 0.959878861904  
    response2[y,x-1] = 0.438348740339
    response2[y,x+1] = 0.753262758255  

    print response2[y,x], type(response2[y,x]), response2.dtype
    print response2[y2,x2], type(response2[y2,x2]), response2.dtype
    print 2*(response2[y,x] - min(response2[y,x-1], response2[y,x+1]))
    print 2*(response2[y2,x2] - min(response2[y2,x2-1], response2[y2,x2+1])) 
```

印刷

```
0.959878861904 <type 'float'> float32
0.959879 <type 'numpy.float32'> float32
1.04306024313
1.04306030273 
```

我使用 python 2.7.3 cython 0.18 和 msvc9 express

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-10T12:28:00.377

我修改了问题中的示例，以便更轻松地阅读为模块生成的 C 源代码。我只对查看创建 Python对象而不是从数组`float`中获取对象的逻辑感兴趣。`np.float32``response`

我`pyximport`用来编译扩展模块。`~/.pyxbld`它将生成的 C 文件保存在（可能`%userprofile%\.pyxbld`在 Windows 上）的子目录中。

```
import numpy as np
import pyximport
pyximport.install(setup_args={'include_dirs': [np.get_include()]})

open('_tmp.pyx', 'w').write('''
cimport numpy as np
cpdef function(np.ndarray[np.float32_t, ndim=2] response, max_loc):
    cdef unsigned int p_one, q_one
    p_one = int(max_loc[0])
    q_one = int(max_loc[1])
    p_two = int(max_loc[0])
    q_two = int(max_loc[1])
    r_one = response[q_one, p_one]
    r_two = response[q_two, p_two]
''')

import _tmp
assert(hasattr(_tmp, 'function')) 
```

这是为感兴趣的部分生成的 C 代码（重新格式化以使其更易于阅读）。事实证明，当您使用 C`unsigned int`索引变量时，生成的代码会直接从数组缓冲区中获取数据并调用`PyFloat_FromDouble`，这会将其强制转换为`double`. 另一方面，当您使用 Python`int`索引变量时，它采用通用方法。它形成一个元组并调用`PyObject_GetItem`. 这种方式允许`ndarray`正确地尊重`np.float32`dtype。

```
#define __Pyx_BufPtrStrided2d(type, buf, i0, s0, i1, s1) \
    (type)((char*)buf + i0 * s0 + i1 * s1)

  /* "_tmp.pyx":9
 *     p_two = int(max_loc[0])
 *     q_two = int(max_loc[1])
 *     r_one = response[q_one, p_one]             # <<<<<<<<<<<<<<
 *     r_two = response[q_two, p_two]
 */
  __pyx_t_3 = __pyx_v_q_one;
  __pyx_t_4 = __pyx_v_p_one;
  __pyx_t_5 = -1;

  if (unlikely(__pyx_t_3 >= (size_t)__pyx_bshape_0_response))
    __pyx_t_5 = 0;
  if (unlikely(__pyx_t_4 >= (size_t)__pyx_bshape_1_response))
    __pyx_t_5 = 1;

  if (unlikely(__pyx_t_5 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_5);
    {
      __pyx_filename = __pyx_f[0];
      __pyx_lineno = 9;
      __pyx_clineno = __LINE__;
      goto __pyx_L1_error;
    }
  }

  __pyx_t_1 = PyFloat_FromDouble((
    *__Pyx_BufPtrStrided2d(
      __pyx_t_5numpy_float32_t *,
      __pyx_bstruct_response.buf,
      __pyx_t_3, __pyx_bstride_0_response,
      __pyx_t_4, __pyx_bstride_1_response)));

  if (unlikely(!__pyx_t_1)) {
    __pyx_filename = __pyx_f[0];
    __pyx_lineno = 9;
    __pyx_clineno = __LINE__;
    goto __pyx_L1_error;
  }

  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_r_one = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_tmp.pyx":10
 *     q_two = int(max_loc[1])
 *     r_one = response[q_one, p_one]
 *     r_two = response[q_two, p_two]             # <<<<<<<<<<<<<<
 */
  __pyx_t_1 = PyTuple_New(2);

  if (unlikely(!__pyx_t_1)) {
    __pyx_filename = __pyx_f[0];
    __pyx_lineno = 10;
    __pyx_clineno = __LINE__;
    goto __pyx_L1_error;
  }

  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_q_two);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_q_two);
  __Pyx_GIVEREF(__pyx_v_q_two);
  __Pyx_INCREF(__pyx_v_p_two);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_p_two);
  __Pyx_GIVEREF(__pyx_v_p_two);

  __pyx_t_2 = PyObject_GetItem(
    ((PyObject *)__pyx_v_response),
    ((PyObject *)__pyx_t_1));

  if (!__pyx_t_2) {
    __pyx_filename = __pyx_f[0];
    __pyx_lineno = 10;
    __pyx_clineno = __LINE__;
    goto __pyx_L1_error;
  }

  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1));
  __pyx_t_1 = 0;
  __pyx_v_r_two = __pyx_t_2;
  __pyx_t_2 = 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T01:50:20.683

在我的机器上玩这个，我看不出有什么不同。我正在使用带有 cython 魔法的 ipython 笔记本：

```
In [1]:

%load_ext cythonmagic

In [12]:

%%cython

import numpy as np
cimport numpy as np

cpdef function(np.ndarray[np.float32_t, ndim=2] response, max_loc):
    cdef unsigned int x, y   
    x, y = int(max_loc[0]), int(max_loc[1])
    x2, y2 = int(max_loc[0]), int(max_loc[1])
    #return 2*(response[y,x] - min(response[y,x-1], response[y,x+1])), 2*(response[y2,x2] - min(response[y2,x2-1], response[y2,x2+1]))
    print response[y,x], type(response[y,x]), response.dtype
    print response[y2,x2], type(response[y2,x2]), response.dtype   
    print 2*(response[y,x] - min(response[y,x-1], response[y,x+1]))
    print 2*(response[y2,x2] - min(response[y2,x2-1], response[y2,x2+1])) 

In [13]:

a = np.random.normal(size=(10,10)).astype(np.float32)
m = [3,2]
function(a,m)

0.586090564728 <type 'float'> float32
0.586091 <type 'numpy.float32'> float32
4.39655685425
4.39655685425 
```

第一对结果，区别只是打印语句的输出精度。你使用的是什么版本的 Cython？索引极不可能影响答案，因为它只是访问 numpy 数组的数据属性正在存储的固定长度的内存。

# c# - 如何将 JSON 文件发布到 ASP.NET MVC 操作？

> ID：15317856
> 
> 赞同：12
> 
> 时间：2013-03-10T01:20:00.127
> 
> 标签：c#, asp.net, asp.net-mvc

我的 iphone 客户端将以下 json 发布到我的 mvc 服务。当从 html 表单发布数据时，它会自动将表单数据转换为 UserModel 并将对象传递给我的 Create 方法，但是当我从 iphone 在我的请求正文中发送 JSON 字符串时，它会返回为 null。

将 JSON 转换为 Object 的最干净的解决方案是什么？

**我宁愿不为不同的客户端创建多种方法，所以我试图让相同的方法在 iphone 和 mvc 客户端上工作。**

我的请求正文：

```
{
   "firstName" : "Some Name",
   "lastName" : "Some Last Name",
   "age" : "age"
} 
```

我的模型和行动结果

```
public class UserModel
{
   public int Id { get; set; }
   public string FirstName { get; set; }
   public string LastName { get; set; }
   public int Age { get; set; }
}

[HttpPost]
public Create ActionResult(UserModel user)
{
   // user is null
   userStorage.create(user);
   return SuccessResultForModel(user);
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-10T03:34:35.107

您需要将 HTTP 标头接受设置为“应用程序/json”，以便 MVC 知道您正在传递 JSON 并执行解释它的工作。

```
accept: application/json 
```

在此处查看更多信息：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

**更新：**使用 MVC3 和 jQuery 的工作示例代码

*控制器代码*

```
namespace MvcApplication1.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            return View();
        }

        [HttpPost]
        public JsonResult PostUser(UserModel data)
        {
            // test here!
            Debug.Assert(data != null);
            return Json(data);
        }
    }

    public class UserModel
    {
        public int Id { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int Age { get; set; }
    }
} 
```

*查看代码*

```
@{ ViewBag.Title = "Index"; }
<script src="../../Scripts/jquery-1.9.1.min.js"></script>
<script type="text/javascript">
    var sample = {};
    sample.postData = function () {
        $.ajax({
            type: "POST", url: "@Url.Action("PostUser")",
            success: function (data) { alert('data: ' + data); },
            data: JSON.stringify({ "firstName": "Some Name", "lastName": "Some Last Name", "age": "30" }),
            accept: 'application/json'
        });
    };
    $(document).ready(function () {
        sample.postData();
    });
</script>

<h2>Index</h2> 
```

** 更新 ** 我`JSON.stringify`在将 JS 对象传递给`data`AJAX 请求中的元素之前添加了它。这只会使有效负载更具可读性，但是控制器将解释`data`类似的两种格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-20T06:51:40.487

我最近想出了一种更简单的方法来发布 JSON，并增加了从我的应用程序中的模型转换的额外步骤。请注意，您必须为控制器创建模型 [JsonObject] 才能获取值并进行转换。

**要求：**

```
 var model = new MyModel(); 

 using (var client = new HttpClient())
 {
     var uri = new Uri("XXXXXXXXX"); 
     var json = new JavaScriptSerializer().Serialize(model);
     var stringContent = new StringContent(json, Encoding.UTF8, "application/json");
     var response = await Client.PutAsync(uri,stringContent).Result;
     ...
     ...
  } 
```

**模型：**

```
[JsonObject]
[Serializable]
public class MyModel
{
    public Decimal Value { get; set; }
    public string Project { get; set; }
    public string FilePath { get; set; }
    public string FileName { get; set; }
} 
```

**服务器端：**

```
[HttpPut]     
public async Task<HttpResponseMessage> PutApi([FromBody]MyModel model)
{
    ...
    ... 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-28T14:06:56.130

晚了，但希望它可以帮助某人。

**从 JSON 到 Object 的转换最干净的解决方案是什么？**

```
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>

$.post("http://localhost:52161/Default/PostRawJson/", { json: {
   "firstName" : "Some Name",
   "lastName" : "Some Last Name",
   "age" : "age"
}});

public void PostRawJson(string json)
{
    var person = System.Web.Helpers.Json.Decode(json);
    person.firstname...
} 
```

这样，您就可以根据要求在控制器中使用纯 JSON 对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-06T13:27:35.970

根据 Glenn Ferries 的回答，在我查看实际发送到控制器的内容之前，这似乎有效 - 它不是 JSON。

因此在下面进行了一些调整：

这是 MVC 4 和 jQuery 1.7 ish

控制器操作方法（有问题的 UserModel 对象）：

```
[HttpPost]
public ActionResult Create(UserModel user)
{
    Debug.Assert(data != null);
    return Json(data);
} 
```

发送请求的 jQuery 代码：

```
<script>
    $(function () {
        $.ajax({
            type: "POST",
            url: "@Url.Action("Create")",
            /* jQuery will not send JSON unless you explicitly tell it to */
            data: JSON.stringify({ "firstName": "Some Name", "lastName": "Some Last Name", "age": "30" }),
            /* contentType is important for MVC to be able to unpack the json */
            contentType: 'application/json'
            accept: 'application/json',
        }).done( function(data) {
            /* this callback gets used when successful */
            console.log("response: " + data);
        }).fail(function (jqxhr, status, error) {
            /* for debugging: this callback gets used in case of errors */
            console.log("error :" + error);
        }).always(function () {
            /* for debugging: this callback always gets called at the end either way*/
            console.log("complete");
        });
    });

</script> 
```

MVC 控制器操作很简单。

困难在于确保您实际上正在向它发送 JSON 以对其进行测试。

与 POST 一起使用时，jQuery ajax() 方法通常会使用请求正文中的查询字符串格式对参数进行编码。MVC 可以愉快地解压它。

要使用 ajax() 实际发送 JSON，您必须使用 JSON.stringify()。

为了让 MVC 正确解释该请求，您需要设置 contentType

# php - PHP图像上传不起作用？

> ID：15317858
> 
> 赞同：0
> 
> 时间：2013-03-10T01:20:13.757
> 
> 标签：php, mysql, image, file-upload

以下是提交文本和/或上传图片的表单代码

```
<form id="comments" action="insertcomment.php" method="POST" enctype="multipart/form-data">
    Comment: <input type="text" name="comment" id="commentfield">
    <br>
<input type="hidden" name="MAX_FILE_SIZE" value="30000" />
    Image URL (Limit: 1MB): <input type="file" name="image">
    <br>
    <input type="submit" name="submit" value="Post comment" class="btn btn-primary">
    </form> 
```

当用户点击提交按钮时，它会转到这个 php 脚本

```
<?php

include('../c_database.php');

$timeSet = date_default_timezone_set("Europe/London");

$User = $_COOKIE['username'];
$comments = mysqli_real_escape_string($dbc, $_REQUEST['comment']);
$time = date(DATE_RFC822);

        if($_FILES['image']['size'] <= 1048576){

$allowedExts = array("jpg", "jpeg", "gif", "png", "bmp", "tiff", "xtiff");

$extension = end(explode(".", $_FILES["image"]["name"]));

        if ((($_FILES["image"]["type"] == "image/gif")

        || ($_FILES["image"]["type"] == "image/jpeg")

        || ($_FILES["new_image"]["type"] == "image/png")

        || ($_FILES["image"]["type"] == "image/pjpeg"))

        || ($_FILES["image"]["type"] == "image/bmp"))

        && in_array($extension, $allowedExts))

{

if ($_FILES["image"]["error"] > 0) {

$error_message = $_FILES["image"]["error"];

} else {

if (file_exists("images/" . $_FILES["image"]["name"]))

{

$error_message = $_FILES["image"]["name"] . " " . $LANG['image_exist'];

} else {

if(move_uploaded_file($_FILES["image"]["tmp_name"], "images/" . $_FILES["image"]["name"])) {

// success
$image_name = $_FILES["image"]["name"];

} else {

$error_message = "Upload Failed!";

}

}

}

} else {

$error_message = "Error: May be different ext or size";

}

}

$imagepath = 'images/'. $_FILES["image"]["name"];

$commentQuery = "INSERT INTO comments (username, comments, time_added, imagepath) VALUES ('$User' ,'$comments' ,'$time' ,'$imagepath')";
$executeCommentQuery = mysqli_query($dbc, $commentQuery);

if($executeCommentQuery){

$user = $_COOKIE['username'];

$commentsMadeUpdate = "UPDATE login SET Comments_Made = Comments_Made +1 WHERE Username='$user'";
$executeUpdateQuery = mysqli_query($dbc, $commentsMadeUpdate);

 echo '<!DOCTYPE html> 
 <html>
 <head>
<title>Comment</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js">      </script>
</head>

<body>';
  echo 'Comment and/or image uploaded successfully';

  echo '<script>location.href="comments.php"</script>';

  echo '
 </body>
 </html>';

 } else {

echo '<!DOCTYPE html> 
<html>
<head>
    <title>Comment</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js">    </script>
</head>

<body>';
  printf("Errormessage: %s\n", mysqli_error($dbc));
echo '
</body>
</html>';
}

?> 
```

此代码应插入评论，并将上传的图像移动到图像文件夹并将图像路径存储在数据库中，但是当用户单击提交时，他们的评论被插入但不是图像路径，并且图像不在临时文件夹或图片文件夹，谁能告诉我怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:30:33.157

由于可能的拼写错误，您正在检查文件类型的最高级别条件可能永远不会被触发：$_FILES["new_image"]["type"]

那应该是： $_FILES['image']['type'] 吗？

您还应该考虑捕获数据库操作的异常：

```
mysqli_query(..) or trigger_error(mysqli_error($dbc)); 
```

# c# - 两个 dll 中都存在“Microsoft.Phone.Controls.LongListSelector”类型

> ID：15317861
> 
> 赞同：3
> 
> 时间：2013-03-10T01:21:39.550
> 
> 标签：c#, silverlight, dll, windows-phone-8, silverlight-toolkit

错误消息如下：

> “Microsoft.Phone.Controls.LongListSelector”类型存在于“...\Microsoft SDKs\Windows Phone\v8.0\Libraries\Microsoft.Phone.Controls.Toolkit.dll”和“...\Reference Assemblies\ Microsoft\Framework\WindowsPhone\v8.0\Microsoft.Phone.dll'

我正在使用最新版本的工具包（12 年 10 月），它是一个 Windows Phone 8 项目。

我不确定为什么会发生这种情况，所以我不知道哪些附加信息可能是相关的，但如果您有任何问题，请提出。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-24T12:14:42.120

1.  从 Visual Studio 更新安装 Nuget Packet Manager

2.  在解决方案资源管理器中右键单击引用，然后转到管理 nuget 数据包

3.  在左侧面板上转到在线 => nuget 官方包源

4.  在右侧面板上搜索“windows phone toolkit”

5.  安装和享受..

原因是，早在 wp7 中 longlistselector 不存在，所以他们在工具包中制作，但在 wp8 中，longlistselector 被包括在内 - 这导致与 wp7 过时的工具包发生冲突，因此更新工具包可以解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T13:57:55.547

我仍然不知道为什么会这样，但是通过 NuGet 卸载工具包并再次安装似乎已经解决了这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-10T13:34:45.363

那是一个命名问题。WP8 SDK 包含[LongListSelector](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.controls.longlistselector%28v=vs.105%29.aspx)类，WP Toolkit 也有同名的类。

[这里](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/c5a54f98-e3d6-4239-97e4-f42343934fb9/)有类似的讨论。

您需要更新 NuGet 并安装最新版本的 Windows Phone Toolkit。

官方FAQ解决方案：

> Q - 我有 WP8 SDK 并且我安装了 NuGet 包，它仍在安装 7.1 版本的工具包程序集，或者我收到错误消息 - “您正在尝试将此包安装到针对 'WindowsPhone,Version=v8 的项目中.0'，但包不包含任何与该框架兼容的程序集引用。”</p>
> 
> A – 您有旧版本的 NuGet。从 www.NuGet.org 安装最新的 NuGet。关闭并重新启动 Visual Studio 的所有实例。现在安装软件包。它将正确安装。从 Nuget 2.1 开始支持 WP8 项目。

# zend-framework - Zend Framework 在尝试启用模块时抛出错误

> ID：15317866
> 
> 赞同：0
> 
> 时间：2013-03-10T01:22:30.300
> 
> 标签：zend-framework, frameworks

我是 zend 框架的新手。我正在尝试启用模块功能，但是当我尝试使用命令行执行此操作时，我收到以下错误消息：

发生错误
调度程序错误 - 找不到可操作的方法

我使用的命令如下：/zf.sh enable module

如果有人可以提供帮助，我将非常感激。

谢谢你。米格尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:00:33.010

您是否在 application.ini 中添加了以下行

（resources.frontController.moduleDirectory = APPLICATION_PATH "/modules" resources.modules = ""）

# java - 如何编写递归方法以返回包含令牌字符串的文件中的所有行

> ID：15317869
> 
> 赞同：0
> 
> 时间：2013-03-10T01:23:04.390
> 
> 标签：java, recursion

我的教授给了我们一个任务，让我们编写一个可以做很多事情的程序。该程序要做的一件事是浏览一个`.txt`文件，并返回您指定的单词的所有实例以及它们所在的行。例如，如果这是文本文件：

> 这是一个测试。
> 测试word文件。
> 这将被视为测试。

运行该方法并搜索单词“test”后，您应该会收到类似以下内容：

```
1: This is a test.       
3: This will be considered a test. 
```

现在这是我的问题。他希望我们用递归的方法来做，我不知道如何启动这个方法。我知道对于递归方法，您必须在每次调用它时调用自身并减少，但是，此方法的参数是一个单词。说我有：

```
String getTheWord (String word) {     
    if (word == 0){    //which still wouldn't compile, so I think I should use word == null     
        // something    
    }

    //something smart here      

    return getTheWord(word - 1); // which wouldn't compile
} 
```

那么我该怎么写呢？我想我必须为参数使用一个字符串，因为我怎么知道我要找的词是什么？或者也许我错了，任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:54:40.623

尝试类似：

```
public String getTheWord(String textToSearch, String searchingFor,
  int currentLineNumber) {

    // Separate the text into lines.
    String[] lines = textToSearch.split('\n');

    // Get the first line of the (remaining) text.
    String firstLine = lines[0];

    // We're going to have some result from this method call: either
    // an empty string or a message indicating that we found the word.
    String resultFromThisLine = "";        

    // Now, look for the word.
    if (firstLine.contains(searchingFor)) {
        // We found it.
        resultFromThisLine = currentLineNumber + ": " + firstLine + "\n";
    }

    // Now we check to see if there are any lines left.
    if (lines.length == 1) {
        // This was the last line.
        return resultFromThisLine;
    } else {
        // There are more line(s).
        // Create a string with all lines but the first one.
        String remainingLines = "";
        for (int i=1; i<lines.length; i++) {
            remainingLines += lines[i] + "\n";
        }

        // Here's the key part.
        // Take the result from this line, add it to the result from the
        // next line, and return *that*.

        return resultFromThisLine + getTheWord(remainingLines, searchingFor,
          currentLine + 1);

     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T02:12:58.127

首先我们应该问，为什么我们要使用递归来解决这个问题。在[Introduction to Computer Science - Java](http://danzig.jct.ac.il/java_class/recursion.html)页面中，我们可以找到一些描述递归解决方案的特征：

1.  一个简单的基本案例，我们有一个解决方案和一个返回值。
2.  一种使我们的问题更接近基本情况的方法。即一种切掉部分问题以获得更简单的问题的方法。
3.  将更简单的问题传递回方法的递归调用。

对我来说，你的问题根本不符合这个特征。

但是好吧，你不想这样做——你必须这样做。

首先你应该考虑模型，它可以代表你的问题。我创建了简单的`Line`类，它存储行号和行。

```
class Line {

    private int number;
    private String text;

    public Line(int number, String text) {
        this.number = number;
        this.text = text;
    }

    public int getNumber() {
        return number;
    }

    public String getText() {
        return text;
    }

    @Override
    public String toString() {
        return number + " : " + text;
    }
} 
```

然后，您应该在使用简单循环的地方创建解决方案。

```
class LoopSearcher {

    public List<Line> findLines(String text, List<String> lines) {
        List<Line> matchLines = new ArrayList<Line>();
        int index = 0;
        for (String line : lines) {
            index++;
            if (line.contains(text)) {
                matchLines.add(new Line(index, line));
            }
        }
        return matchLines;
    }
} 
```

您可以通过以下方式对其进行测试：

```
List<String> lines = IOUtils.readLines(new FileInputStream(new File(
        "D:/test.txt")));

List<Line> loopLines = new LoopSearcher().findLines("test", lines);

for (Line line : loopLines) {
    System.out.println(line);
} 
```

现在，如果我们有循环解决方案，我们可以将其修改为递归解决方案：

```
class RecursiveSearcher {

    LinkedList<Line> matchLines = new LinkedList<Line>();

    public List<Line> findLines(String text, List<String> lines) {
        if (lines.isEmpty()) {
            return matchLines;
        }

        int number = lines.size() - 1;
        String line = lines.remove(number);
        if (line.contains(text)) {
            matchLines.addFirst(new Line(number + 1, line));
        }
        return findLines(text, lines);
    }
} 
```

您可以通过以下方式对其进行测试：

```
List<String> lines = IOUtils.readLines(new FileInputStream(new File(
        "D:/test.txt")));

List<Line> recursiveLines = new RecursiveSearcher().findLines("test",
        lines);
for (Line line : recursiveLines) {
    System.out.println(line);
} 
```

如您所见，我创建了带有 to 参数的方法：

1.  text - 我们要在每一行中找到的文本
2.  行 - 文件中所有行的列表。当然，你可以提供 raw `String`，它可以代表所有文件内容。

# asp.net-mvc - 将淘汰赛翻译成剃刀以保持其验证工作

> ID：15317871
> 
> 赞同：0
> 
> 时间：2013-03-10T01:23:12.137
> 
> 标签：asp.net-mvc, razor, knockout.js, knockout-mvc

这是我面临的问题，甚至不知道如何解决它：

[我在ASP.NET MVC 4](http://www.asp.net/mvc)中创建了模型、控制器和视图。有一次我不得不创建动态列表，所以我选择了[KnockoutJS](http://knockoutjs.com/)，这非常容易解决这个问题。到目前为止，一切都很好。然后我意识到我使用[Fluent Validation](http://fluentvalidation.codeplex.com/)在 MVC 模型上定义的验证在淘汰视图中不再起作用。

我搜索了 SO，发现几个可行的解决方案：

*   [淘汰赛验证](https://github.com/ericmbarnard/Knockout-Validation)
*   [jQuery 验证](https://github.com/jzaefferer/jquery-validation)
*   可能用剃刀来表达 Knockout 语法

由于几个原因，我倾向于使用后一种。主要是因为它让我有机会*不*介绍（学习、测试、本地化、花时间）另一个库。

我对 MVC 非常熟悉，并且喜欢它支持本地化的方式，可以完全控制消息、标签等。我也喜欢 Fluent Validation 并且不想用其他人替换它（更静态，更难本地化，更不灵活我的喜好）

当 data-bind 必须变为 data_bind 等时，我发现了一些关于敲除到剃刀转换的示例。

我找不到用和 in 来表达 foreach 循环的方法。

MVC 视图模型

```
 public class ContactEmail
  {
    public string SelectedLabel { get; set; }
    public string Name { get; set; }
  }

 public class User
 {
   public IList<ContactEmail> Emails { get; set; }
 }

ViewBag.EmailLabels = new string[] { "label1", "label2", ... }; 
```

淘汰赛模型

```
 var viewModel = {
    EmailLabels: ko.observableArray(@Html.Json(ViewBag.EmailLabels as string[]) || []),
    Emails: ko.observableArray(@Html.Json(@Model.Emails) || []),
  } 
```

淘汰赛观点（我想改造）

```
 <table>
    <tbody data-bind="foreach: Emails">
      <tr>
        <td>
        @* How to make razor below work instead of knockout syntax below it? *@
        @*Html.DropDownListFor(m => ????, new { data_bind="options: $root.EmailLabels, value: SelectedLabel, optionsCaption: 'Choose...'" } )
          <select data-bind="options: $root.EmailLabels, value: SelectedLabel, optionsCaption: 'Choose...'"></select></td>
          <td>
            @* How to make razor below work as well instead of knockout syntax below ?!?!? *@
            @Html.TextBoxFor(m => ????, new { data_bind="value: Name, uniqueName: true" } )
              <input type="text" data-bind="value: Name, uniqueName: true" class="required email" />
          </td>
          <td>
              <a href="#" data-bind="click: function() { viewModel.removeEmail(this); }">Delete</a>
          </td>
      </tr>
    </tbody>
    </table> 
```

我查看了[MVC Controls 工具包](http://mvccontrolstoolkit.codeplex.com/)，一个人无情地宣传它将解决我所有的验证和本地化以及所有问题。我发现它无法使用，非常专有且极难理解。就像买核弹杀鸟一样。

因此，请那些有过将 MVC 与淘汰赛结合的经验的人，请站出来分享您的经验。

任何帮助将不胜感激，并在此先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T21:35:29.333

我认为这有点骇人听闻，但它确实有效。

控制器将返回 User.Emails 属性内的电子邮件集合，其中包含需要呈现的列表。Razor 视图生成的是只有一行的表格的 HTML，并且验证基于 Emails IEnumerable 的第一个元素（必须检查是否为 null 或可能导致异常）。

当客户端发生 ko.applyBindings() 时，tbody 标记上的 foreach 将生成所有行，并且由于 ko ViewModel 已将整个集合初始化为映射的 JsonString，因此将呈现整个列表。removeEmail 和 addEmail 方法也可以工作（我刚刚测试了 removeEmail 选项，它可以工作 =D）

```
@using Newtonsoft.Json
@model Stackoverflow5.Models.User

    <table>
        @{var tempdropdownlist = new List<SelectListItem>();}

        <tbody data-bind="foreach: Emails">
            <tr>
                <td>
                    @Html.DropDownListFor(m => m.Emails.First().SelectedLabel, tempdropdownlist,
                                      new { data_bind="options: $root.EmailLabels, value: SelectedLabel, optionsCaption: 'Choose...'" })

                <td>
                    @Html.TextBoxFor(m => m.Emails.First().Name, new { data_bind="value: Name, uniqueName: true" } )
                </td>
                <td>
                    <a href="#" data-bind="click: function () { viewModel.removeEmail(this); }">Delete</a>
                </td>
            </tr>
        </tbody>
    </table>

@section scripts
{
    <script src="~/Scripts/knockout-2.2.1.js"></script>
    <script src="~/Scripts/knockout.mapping-latest.js"></script>

    <script>
        //Model definition
        var viewModel,
            ModelDefinition = function (data) {
            //Object definition
            var self = this;

            //Mapping from ajax request
            ko.mapping.fromJS(data, {}, self);

            self.removeEmail = function(row) {
                self.Emails.remove(row);
            };

            self.addEmail = function() {
                //Method for adding new rows here
            };
        };

        $(function() {
            viewModel = new ModelDefinition(@Html.Raw(JsonConvert.SerializeObject(Model)));
            ko.applyBindings(viewModel);
        });
    </script>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T14:01:41.887

编辑：更新以包括明确的淘汰赛绑定

**索引.cshtml**

```
@model Stackoverflow5.Models.User

<form>
    <table>
        <tbody>

            @{
                var tempdropdownlist = new List<SelectListItem>();
            }
            @for (var i = 0; i < @Model.Emails.Count; i++)
            {
                <tr>
                    <td>
                        @Html.DropDownListFor(m => m.Emails[i], tempdropdownlist,
                            new { data_bind = String.Format("options: $root.EmailLabels, value: Emails()[{0}].SelectedLabel, optionsCaption: 'Choose...'", i)})
                    </td>
                    <td>
                        @Html.TextBoxFor(m => m.Emails[i].Name, 
                            new { data_bind = String.Format("value: Emails()[{0}].Name(), uniqueName: true", i) })
                    </td>
                </tr>
            }

        </tbody>
    </table>

    <button type="submit">Test</button>
</form> 
```

** 模型（验证工作）**

```
public class ContactEmail
    {
        public string SelectedLabel { get; set; }

        [Required]
        [StringLength(20, MinimumLength = 2)]
        public string Name { get; set; }

    }

    public class User
    {
        public User()
        {
            Emails = new List<ContactEmail>();
            EmailLabels = new List<string> {"Important", "Spam", "Family"};
        }

        public List<ContactEmail> Emails { get; set; }
        public List<string> EmailLabels { get; set; }
    } 
```

# user-interface - Tcl/Tk 中的交互式图表

> ID：15317874
> 
> 赞同：5
> 
> 时间：2013-03-10T01:23:27.223
> 
> 标签：user-interface, charts, tcl, tk

[BLT](http://blt.sourceforge.net/)是我所知道的最佳选择。它有效，但风格有点过时。我想它已经停止维护了？由于最新的[2.4z](http://sourceforge.net/projects/blt/files/BLT/BLT%202.4z/)是在 2002 年发布的。

[Plotchart](http://tcllib.sourceforge.net/doc/plotchart.html)是另一个很棒的图表库，它是[tklib](http://www.tcl.tk/software/tklib/)的一部分，并且已经在 tcl 8.5 中内置。[我尝试了一些tklib](http://www.tcl.tk/software/tklib/)附带的示例，但它看起来只能显示静态图表。

有没有可用的替代库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T10:46:13.850

目前，这里有一个分叉的 2.5 版本的 BLT， http: [//pdqi.com/w/pw/pdqi/Wize/Blt](http://pdqi.com/w/pw/pdqi/Wize/Blt)。

您还可以尝试与Tcl8.5/8.6 兼容的[Refactored BLT Components 。](http://wiki.tcl.tk/24533)

最后，关于[BLT](http://wiki.tcl.tk/199)的 Tcl wiki 页面引用了 3.0 版本，但我找不到在哪里获取它。

# java - TreeUI 的自定义 ui 委托

> ID：15317875
> 
> 赞同：0
> 
> 时间：2013-03-10T01:23:28.563
> 
> 标签：java, swing, path, jtree, uimanager

出于某种原因，我的 TreeUI 没有得到应用。我正在使用 MetalTheme 并想自定义 TreeUI。因此，我首先复制 TreeUI 代码并重命名类 EzTreeUI。我这样做对吗？以下命令均无效。当我调试并跳过下面的语句时，`UIManager.getDefaults().get("TreeUI");`仍然返回`javax.swing.plaf.metal.MetalTreeUI`.

```
UIManager.getDefaults().put("TreeUI", EzTreeUI.class.getName());
UIManager.put("TreeUI", EzTreeUI.class.getName()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:44:39.097

```
UIManager.put("TreeUI", "EzTreeUI"); 
```

# c++ - 顺时针排序算法的优化

> ID：15317876
> 
> 赞同：5
> 
> 时间：2013-03-10T01:23:54.233
> 
> 标签：c++, performance, sorting

所以这是一个优化问题，我找不到答案。

我编写了一些代码来计算给定随机点集的凸包。出于比较的目的，我制作了自己的慢 O(n³) 算法，使用一些旧的 OpenGL 东西来可视化它。由于慢凸包算法的性质，点根本没有排序。所以排序发生在计算 CH 之后。

我的问题是，直到 1000 分，我在不到一秒的时间内就有了视觉结果。但是对于 10000 点，需要 15-20 分钟（我还没有等过）。*但是*，如果我跳过排序代码并让 opengl 显示未排序的凸包顶点，则只需不到一分钟。所以一直以来都是顺时针排序。检查代码（有些名称没有意义，因为它们是在别处定义的）：

```
// This code actually compares every pair iteratively with respect to the center point
// Consider a given vector "convex", which contains all the convex hull points unsorted

.
..
...
....

int avgx,avgy,sumx=0,sumy=0;

for (int i=0;i<convex.size();i++){
    sumx+=convex.at(i).at(0);
    sumy+=convex.at(i).at(1);
}

avgx=sumx/(convex.size()/2.0); //something like an internal point
avgy=sumy/(convex.size()/2.0);

sort(convex.begin(),convex.end()); //x-sort 
int det,tempx,tempy;
for (int i=0;i<convex.size()-1;i++){
    x1=convex.at(i).at(0);
    y1=convex.at(i).at(1);
    x2=convex.at(i+1).at(0);
    y2=convex.at(i+1).at(1);
    det=(x1-avgx)*(y2-avgy)-(x2-avgx)*(y1-avgy); 
    if (det<0){ //on which side of O-X1 lies X2?
        tempx=convex.at(i).at(0); //swapping points 
        tempy=convex.at(i).at(1);
        convex.at(i).at(0)=convex.at(i+1).at(0);
        convex.at(i).at(1)=convex.at(i+1).at(1);
        convex.at(i+1).at(0)=tempx;
        convex.at(i+1).at(1)=tempy;
        i=-1; //check again the new vector from the beginning
    }
    }
return convex; 
```

展示部分：

```
glColor3f(0.8, 0.2, 0.2);
glPointSize(3);
glBegin(GL_LINE_LOOP);
    for (int i=0;i<count;i++){
        glVertex2f(convexHull.at(i).at(0),convexHull.at(i).at(1));
    }
glEnd(); 
```

从我所见，这种方法（通过比较交叉产品）是最有效的。然而，在此之前我写了一些实际上更快的肮脏代码，因为它在 8 分钟内给了我一个视觉结果。我不想保留它，因为它太脏太长了，这个更干净但很慢（如果它真的有效的话......）。那么，我是否一定要等待 CW 类型的 10000 个凸点，或者我缺少什么？

我很感激任何想法，让我知道是否需要包含其他内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T02:32:36.173

总的来说，这个问题有点奇怪。大多数 2D 凸包算法（据我所知）以顺时针或逆时针顺序给出点（顶点）列表，或者可以对其进行简单修改。

在任何情况下，由于有几种良好的 2D 凸包确定方法可以在**O(N^2)**或更快的时间内运行，因此您可以使用其中一种方法将数据“排序”为顺时针顺序。我的意思是你可以对你的数据运行一个 CH 算法并按照你想要的顺序得到结果。

这是我周围的示例代码，我认为它可以满足您的要求：

```
#define TURN_DIR(p1,p2,p3)  (p1.x * p2.y - p1.y * p2.x + \
                             p2.x * p3.y - p2.y * p3.x + \
                             p3.x * p1.y - p3.y * p1.x)
#define LAST(cntnr)         (cntnr).back()
#define BEFORE_LAST(cntnr)  (cntnr)[(cntnr).size() - 2]

void ConvexHull (std::vector<Point> & pts)
{
    std::sort (pts.begin(), pts.end());

    std::vector<Point> lower, upper;
    for (unsigned i = 0; i < pts.size(); ++i)
    {
        while (lower.size() > 1 && TURN_DIR(BEFORE_LAST(lower), LAST(lower), pts[i]) <= 0)
            lower.pop_back ();
        while (upper.size() > 1 && TURN_DIR(BEFORE_LAST(upper), LAST(upper), pts[i]) >= 0)
            upper.pop_back ();

        lower.push_back (pts[i]);
        upper.push_back (pts[i]);
    }

    upper.insert (upper.end(), lower.rbegin() + 1, lower.rend() - 1);
    pts.swap (upper);
} 
```

有几点需要考虑：

1.  上面的代码接收它的输入并在同一个参数中返回它的输出：`pts`.
2.  该`Point`结构是一个简单的结构（或类），具有两个公共成员`x`and`y`和一个小于运算符 (an `operator <`)，它非常简单地基于`x`first 和 then比较它们`y`。
3.  我相信上述代码的运行时间是**O(N*log(N))**，但它肯定不比**O(N^2)**差。
4.  返回的点将按*顺时针*顺序排列。如果你想逆时针，你只需要改变最后两行。
5.  此代码不会处理所有点具有相同 X 坐标的情况（我认为！）
6.  除此之外，这是一个功能强大且快速简单的 2D 凸包实现。
7.  如果输入中有位于同一行上的连续点，则此实现将它们删除。如果你不想这样，你可以分别用and替换循环中的`<= 0`and`>= 0`测试。`while``< 0``> 0`

让我强调一下：虽然上面的代码是一个 CH 实现，但您可以使用它来按顺时针缠绕顺序对您的点进行排序（如果它们已经形成了一个凸包。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-10T03:23:35.030

您已经实现了[冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)，即 O(n ² )。`sort`您可以通过使用带有适当比较函子的 STL 来获得 O(n log(n)) 。

这是第一次尝试；它使用非传递比较器，但它似乎在我的测试用例中工作，我*认为*它通常是正确的：

```
struct clockwise : public binary_function<vector<int>, vector<int>, bool>
{
  bool operator()(vector<int> A, vector<int> B)
  {
    int det=(A[0]-avgx)*(B[1]-avgy)-(B[0]-avgx)*(A[1]-avgy);
    return(det<0);
  }

  static int avgx, avgy;
};

int clockwise::avgx = 0;
int clockwise::avgy = 0;

...

int clockwise::avgx=sumx/(convex.size()/2.0);
int clockwise::avgy=sumy/(convex.size()/2.0);
sort(convex.begin(),convex.end(), clockwise()); //clockwise-sort 
```

**编辑：**

非传递比较器不是一个好主意。这个比较靠谱：

```
#include <math.h>

...

struct clockwise : public binary_function<vector<int>, vector<int>, bool>
{
  bool operator()(vector<int> A, vector<int> B)
  {
    return(atan2(A[0]-avgx, A[1]-avgy) < atan2(B[0]-avgx, B[1]-avgy));
  }
} 
```

# php - 如果 PHP 中存在特定键，则获取数组值

> ID：15317879
> 
> 赞同：0
> 
> 时间：2013-03-10T01:24:31.913
> 
> 标签：php, arrays

我有一个看起来像这样的数组：

```
Array
(
    [100] => Array
        (
            [room_id] => 100
            [name] => Town Center
        )

    [110] => Array
        (
            [room_id] => 110
            [name] => Coffee Shop
            [pin_id] => 7146
            [pin_x] => 570
            [pin_y] => 150
        )
) 
```

我想知道是否有一种方法可以获得特定值，如果“pin_id”键在那里。例如：

```
Array
(
    [100] => Array
        (
            [room_id] => 100
            [name] => Town Center     <-- No "pin_id" so I DON'T need this value
        )

    [110] => Array
        (
            [room_id] => 110
            [name] => Coffee Shop     <-- I want to OBTAIN this value
            [pin_id] => 7146          <-- Since the "pin_id" key is here
            [pin_x] => 570
            [pin_y] => 150
        )
) 
```

我试过使用foreach，但它对我来说变得很复杂。我对数组还是很陌生，对术语/函数不太熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:26:29.877

轻松使用`PHP`功能[`array_key_exists`](https://www.php.net/manual/en/function.array-key-exists.php)

`foreach`由于您使用的是多维数组，因此您可能必须经历一个循环：

```
$names = [];
foreach($array as $e)
{
  if(array_key_exists('pin_id', $e)) {
        echo "The 'pin_id' element is in the array";
      $names[] = $e['name'];
  }
} 
```

现在`$names`包括所有你的名字值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T02:40:30.753

```
foreach ($your_big_array as $arr) {
    if ($arr['pin_id'] == 'some_value') $i_need_this = $arr['name'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-28T12:39:45.090

```
function search_key( $array, $key ) {
    $results = array();
    if ( is_array( $array ) ) {
        if ( isset( $array[$key] ) && $array[$key] == $key )
            $results[] = $array;
        foreach ( $array as $subarray )
            $results = array_merge( $results, tm_search_key_value( $subarray, $key ) );
    }
    return $results;
} 
```

用法：

search_key($array, 'pin_id');

从 Multidimentional 中搜索特定的 KEY，它将返回该特定键的数组。

# php - 如何即时反映不断变化的排名？

> ID：15317880
> 
> 赞同：0
> 
> 时间：2013-03-10T01:24:47.117
> 
> 标签：php, html, css, sorting, web

基本上正在发生的事情是我一直在尝试开发一个评级系统来存储用户的总评级并根据他们的评级按顺序显示项目。但是现在我遇到了一个错误，它只会在评级两次后改变评级/显示，而不是显然只改变一次。

这是代码：

```
<?php
include ("sql.php");

function getTotal($name) {
$query = "SELECT total FROM items WHERE name = '$name'";
// echo $query;
// echo "<br />";
$result = mysql_query($query);
$row = mysql_fetch_row($result);
return $row[0];
}

display();
function display($items) {
    $video = getTotal(video);
    // echo "video total: ".$video;
    // echo "<br />";
    $Music = getTotal(Music);
    // echo "Music total: ".$Music;
    // echo "<br />";
    $football = getTotal(football);
    // echo "football total: ".$football;
    // echo "<br />";

    $items = array($video => 'video', $Music => 'Music', $football=>'football');
    // echo "<br />";
    krsort($items);
    // print_r($items);
foreach ($items as $key => $val) {
    print ("<form method = 'post'>
    $val
    <button name ='upvote' type = 'submit' value ='$val' />Upvote</button>
    <button name ='downvote' type ='submit' value ='$val' />Downvote</button>
    </form> TOTAL: ".$key."
        ");
    }
}

if (isset($_POST['upvote']) || isset($_POST['downvote'])) {

$ip = 23;
//$ip = ip2long($_SERVER['REMOTE_footballDR']);

if ($_POST['upvote'] != null) {
$item = $_REQUEST['upvote'];
}
else {
$item = $_REQUEST['downvote'];
}

//see if person has voted before, for this item
$q = "SELECT count(*) FROM tracker".$item." WHERE ip = $ip";
$check = mysql_query($q);
$row = mysql_fetch_row($check);
$bool = ($row[0] > 0);

    if (!$bool) {
        echo "User has not voted before for this item <br />";

    }

    else {
        echo "user has voted for this item before";
        //then the user has voted before
        //row[0] = ip, row[1] = value
        $d = "SELECT * FROM tracker".$item." WHERE ip = '$ip'";
        $e = mysql_query($d);
        $row = mysql_fetch_row($e);
        $value = -$row[1];
        echo "<br /> value: ".$value;
        $qry = "UPDATE items SET total = total + $value WHERE name = '$item'";
        echo "<br /> qry: ".$qry;
        $result = mysql_query($qry);

        if (!$result) {
            echo "problem with result".mysql_error();

        }

        $q = "DELETE FROM tracker".$item." WHERE ip = '$ip'";
        echo "<br /> Delete query".$q; 
        $r = mysql_query($q);
        if (!$r) {
            echo "problem with r".mysql_error();
        }

    }

if ($item == $_POST['upvote']) {
    echo "<br /> item has been upvoted";
    $qry = "UPDATE items SET total = total + 1 WHERE name = '$item'";
    echo "<br /> qry: ".$qry;
    mysql_query($qry);

//also get the ip footballdress and footballd to the who's voted table
    $d = "INSERT INTO tracker".$item." VALUES ('$ip', '1')";
    mysql_query($d);
    }

elseif ($item == $_POST['downvote']) {
    echo "<br /> item has been downvoted";
    $qry = "UPDATE items SET total = total - 1 WHERE name = '$item'";
    mysql_query($qry);

//also get the ip footballdress and footballd to the who's voted table
    $d = "INSERT INTO tracker".$item." VALUES ('$ip', '-1')";
    mysql_query($d);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T02:00:07.707

我在那里详细说明了一些错误：

1.  使用[PDO](http://www.php.net/manual/en/book.pdo.php)或[mysqli_*](http://www.php.net/manual/en/book.mysqli.php)函数
2.  记得清理 SQL 中的任何输入以防止[SQL 注入](http://www.php.net/manual/en/security.database.sql-injection.php)
3.  始终检查变量`queries`

    $check = 查询($sql); if (!$check) { // 如果需要，显示或返回错误消息 } $row = mysql_fetch_row($check);

4.  使用`try`和`catch`阻塞来防止非托管异常

5.  要显示新的更新投票，您可以在从表格更新后检索投票

# python - 图片 web2py python

> ID：15317882
> 
> 赞同：0
> 
> 时间：2013-03-10T01:25:03.477
> 
> 标签：python, web2py

您好，我在 web2py 中显示图片时遇到问题。我知道它类似于编写 HTML 代码，出于某种原因图片没有出现。也许它是一个语法错误，或者也许我一直在看代码很长时间才知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T03:49:12.200

web2py 不提供这样的 URL。请参阅有关[调度](http://web2py.com/books/default/chapter/29/04#Dispatching)的书籍部分。URL 必须指定应用程序、控制器和函数（以及可选的 args 和/或 vars），并且函数应该检索并返回请求的文件。有关详细信息，请参阅有关[上传](http://web2py.com/books/default/chapter/29/07?search=def+download#SQLFORM-and-uploads)的书籍部分以及脚手架应用程序中的[`download()`功能](https://code.google.com/p/web2py/source/browse/applications/welcome/controllers/default.py#42)。

唯一的例外是应用程序中`/static`文件夹中的文件——它们可以通过 URL 直接提供，例如`/myapp/static/path/to/file.ext`. 如果 pic.png 是一个静态文件，那么你应该把它放在`/static`文件夹中。

# xna - 使用 VS2012 Shader Designer 创建 XNA 着色器

> ID：15317883
> 
> 赞同：3
> 
> 时间：2013-03-10T01:25:05.997
> 
> 标签：xna, shader, direct3d, hlsl

我创建了一个似乎在 VS2012 着色器设计器中运行良好的着色器。它以 DGSL 格式保存它，然后我将其导出到 HLSL。

我以为我可以在 XNA 项目中使用它，但是有两件事对我来说非常新，我希望有人能指出我正确的方向：

1）到目前为止我见过的每个着色器都有这样的部分

```
technique RibbonShader
{
    pass Pass0
    {   
        VertexShader = compile vs_2_0 VertexShader();
        PixelShader  = compile ps_2_0 PixelShader();
    }
} 
```

不幸的是，由 VS2012 导出功能生成的 HLSL 只有一个 main 函数，如下所示：

```
P2F main(V2P pixel)
{
    // lots of stuff
    return result;
} 
```

有人可以温和地解释我需要做什么才能让我的着色器（具有“主要”功能的着色器）在设计器中运行良好，以采用具有上述技术/通道格式的格式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T13:40:16.403

```
technique RibbonShader
{
    pass Pass0
    {   
        VertexShader = compile vs_2_0 VertexShader();
        PixelShader  = compile ps_2_0 PixelShader();
    }
} 
```

是用于使用效果框架的着色器的格式。Visual Studio 生成的着色器只是一个具有单一主要功能的顶点或像素着色器。

要将其转换为效果文件，您必须添加技术部分并使用效果框架。就像是

```
V2P mainVS(...)
{
   // vertex shader
}

P2F mainPS(V2P pixel)
{
    // lots of stuff
    return result;
}

technique YourTechniqueName // can be anything you choose.
{
    pass Pass0
    {   
        VertexShader = compile vs_2_0 mainVS();
        PixelShader  = compile ps_2_0 mainPS();
    }
    // can have other passes
} 
```

如果你不使用效果框架，你仍然可以使用单独的顶点/像素着色器文件，里面只有一个主文件，让 Visual Studio 将它们编译成二进制着色器文件，然后你可以将它们加载到你的应用程序中。

在 Visual Studio 2012 中，这是在您将着色器文件添加到项目时自动完成的。此外，当您右键单击并转到着色器文件的属性时，您可以更改它是 *.fx（效果文件）还是顶点/像素着色器及其着色器模型版本。

希望有帮助。

# c# - 为什么在比较中使用 IComparable 比使用字符串慢？

> ID：15317894
> 
> 赞同：2
> 
> 时间：2013-03-10T01:27:11.020
> 
> 标签：c#, .net, string, performance

我正在使用 Mergesort 订购 50.000.000 个字符串，根据我使用的参数类型，有两种不同的结果。

**使用接口 IComparable：**

*   20226 毫秒

**直接使用字符串：**

*   10912 毫秒

合并排序代码：

```
public class Mergesort2
{
    static private StringComparer comparer1 = StringComparer.Ordinal;
    public static void merge(IComparable[] a, IComparable[] aux, int lo, int mid, int hi)
    {

        for (int k = lo; k <= hi; k++)
        {
            aux[k] = a[k];
        }

        // merge back to a[]
        int i = lo, j = mid + 1;
        for (int k = lo; k <= hi; k++)
        {
            if (i > mid)
            {
                a[k] = aux[j++];
            }
            else if (j > hi)
            {
                a[k] = aux[i++];
            }
            else if (less(aux[j], aux[i]))
            {
                a[k] = aux[j++];
            }
            else
            {
                a[k] = aux[i++];
            }
        }

    }

    private static void sort(IComparable[] a, IComparable[] aux, int lo, int hi)
    {
        if (hi <= lo)
        {
            return;
        }
        int mid = lo + (hi - lo) / 2;
        sort(a, aux, lo, mid);
        sort(a, aux, mid + 1, hi);
        merge(a, aux, lo, mid, hi);
    }

    public static void sort(IComparable[] a)
    {
        IComparable[] aux = new IComparable[a.Length];
        sort(a, aux, 0, a.Length - 1);
    }

    ///*********************************************************************
    ///  Helper sorting functions
    /// **********************************************************************

    // is v < w ?
    private static bool less(IComparable v, IComparable w)
    {
        return (comparer1.Compare(v, w) < 0);
    }

    // exchange a[i] and a[j]
    private static void exch(Object[] a, int i, int j)
    {
        Object swap = a[i];
        a[i] = a[j];
        a[j] = swap;
    }

    /// <summary>
    ///*********************************************************************
    ///  Index mergesort
    /// **********************************************************************
    /// </summary>
    // stably merge a[lo .. mid] with a[mid+1 .. hi] using aux[lo .. hi]
    private static void merge(IComparable[] a, int[] index, int[] aux, int lo, int mid, int hi)
    {

        // copy to aux[]
        for (int k = lo; k <= hi; k++)
        {
            aux[k] = index[k];
        }

        // merge back to a[]
        int i = lo, j = mid + 1;
        for (int k = lo; k <= hi; k++)
        {
            if (i > mid)
            {
                index[k] = aux[j++];
            }
            else if (j > hi)
            {
                index[k] = aux[i++];
            }
            else if (less(a[aux[j]], a[aux[i]]))
            {
                index[k] = aux[j++];
            }
            else
            {
                index[k] = aux[i++];
            }
        }
    }

    // return a permutation that gives the elements in a[] in ascending order
    // do not change the original array a[]
    public static int[] indexSort(IComparable[] a)
    {
        int N = a.Length;
        int[] index = new int[N];
        for (int i = 0; i < N; i++)
        {
            index[i] = i;
        }

        int[] aux = new int[N];
        sort(a, index, aux, 0, N - 1);
        return index;
    }

    // mergesort a[lo..hi] using auxiliary array aux[lo..hi]
    private static void sort(IComparable[] a, int[] index, int[] aux, int lo, int hi)
    {
        if (hi <= lo)
        {
            return;
        }
        int mid = lo + (hi - lo) / 2;
        sort(a, index, aux, lo, mid);
        sort(a, index, aux, mid + 1, hi);
        merge(a, index, aux, lo, mid, hi);
    }
} 
```

此代码产生缓慢的运行时。

如果我将所有**IComparable**类型更改为**String**，性能将会提高。为什么使用不同类型会有如此巨大的性能差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T04:44:31.730

要回答有关性能的问题：您的测试使用的字符串足够小，以至于使用非泛型`IComparable`接口需要额外的类型检查，以及使用 interface-dispatch 而不是 virtual-dispatch（virtual .NET 和 Java VM 等机器）比字符串比较更昂贵。如果您使用具有长公共前缀的字符串，比较操作将成为主要的性能成本，并且两种形式之间的差距将缩小。**编辑：**在代码的发布版本上运行测试也可以缩小差距（没有在本地运行测试，我不确定用于测试的 OP 是什么版本）。

现在对整个实验更重要的是，***忽略代码的所有其他问题***，我将特别指出在 .NET 中以通用方式支持“可比较”项目的常见做法。

1.  不要限制泛型类型`T`（可能是也可能不是`string`，如果事实上它可能实现也可能不实现`IComparable`）。
2.  使用 an`IComparer<T>`来比较元素。如果用户将`null`for`comparer`参数传递给其中一个公共方法，则默认为`Comparer<T>.Default`.

这是更新的代码：

```
public class Mergesort2
{
    public static void merge<T>(T[] a, T[] aux, int lo, int mid, int hi, IComparer<T> comparer)
    {
        comparer = comparer ?? Comparer<T>.Default;

        for (int k = lo; k <= hi; k++)
        {
            aux[k] = a[k];
        }

        // merge back to a[]
        int i = lo, j = mid + 1;
        for (int k = lo; k <= hi; k++)
        {
            if (i > mid)
            {
                a[k] = aux[j++];
            }
            else if (j > hi)
            {
                a[k] = aux[i++];
            }
            else if (less(aux[j], aux[i], comparer))
            {
                a[k] = aux[j++];
            }
            else
            {
                a[k] = aux[i++];
            }
        }

    }

    private static void sort<T>(T[] a, T[] aux, int lo, int hi, IComparer<T> comparer)
    {
        if (hi <= lo)
        {
            return;
        }
        int mid = lo + (hi - lo) / 2;
        sort(a, aux, lo, mid, comparer);
        sort(a, aux, mid + 1, hi, comparer);
        merge(a, aux, lo, mid, hi, comparer);
    }

    public static void sort<T>(T[] a, IComparer<T> comparer)
    {
        comparer = comparer ?? Comparer<T>.Default;
        T[] aux = new T[a.Length];
        sort(a, aux, 0, a.Length - 1, comparer);
    }

    ///*********************************************************************
    ///  Helper sorting functions
    /// **********************************************************************

    // is v < w ?
    private static bool less<T>(T v, T w, IComparer<T> comparer)
    {
        return (comparer.Compare(v, w) < 0);
    }

    // exchange a[i] and a[j]
    private static void exch<T>(T[] a, int i, int j)
    {
        T swap = a[i];
        a[i] = a[j];
        a[j] = swap;
    }

    /// <summary>
    ///*********************************************************************
    ///  Index mergesort
    /// **********************************************************************
    /// </summary>
    // stably merge a[lo .. mid] with a[mid+1 .. hi] using aux[lo .. hi]
    private static void merge<T>(T[] a, int[] index, int[] aux, int lo, int mid, int hi, IComparer<T> comparer)
    {

        // copy to aux[]
        for (int k = lo; k <= hi; k++)
        {
            aux[k] = index[k];
        }

        // merge back to a[]
        int i = lo, j = mid + 1;
        for (int k = lo; k <= hi; k++)
        {
            if (i > mid)
            {
                index[k] = aux[j++];
            }
            else if (j > hi)
            {
                index[k] = aux[i++];
            }
            else if (less(a[aux[j]], a[aux[i]], comparer))
            {
                index[k] = aux[j++];
            }
            else
            {
                index[k] = aux[i++];
            }
        }
    }

    // return a permutation that gives the elements in a[] in ascending order
    // do not change the original array a[]
    public static int[] indexSort<T>(T[] a, IComparer<T> comparer)
    {
        comparer = comparer ?? Comparer<T>.Default;
        int N = a.Length;
        int[] index = new int[N];
        for (int i = 0; i < N; i++)
        {
            index[i] = i;
        }

        int[] aux = new int[N];
        sort(a, index, aux, 0, N - 1, comparer);
        return index;
    }

    // mergesort a[lo..hi] using auxiliary array aux[lo..hi]
    private static void sort<T>(T[] a, int[] index, int[] aux, int lo, int hi, IComparer<T> comparer)
    {
        if (hi <= lo)
        {
            return;
        }
        int mid = lo + (hi - lo) / 2;
        sort(a, index, aux, lo, mid, comparer);
        sort(a, index, aux, mid + 1, hi, comparer);
        merge(a, index, aux, lo, mid, hi, comparer);
    }
} 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-10T01:32:26.090

恕我直言，我不得不简单地说：对象本身的大小......所以每次你声明一个 ICompare，它包含一堆额外的属性、方法等，它需要更多的时间，而不是你声明较小的细绳...

# haskell - Haskell 中 if 语句的正确语法

> ID：15317895
> 
> 赞同：12
> 
> 时间：2013-03-10T01:27:16.583
> 
> 标签：haskell, if-statement

您需要的唯一输入是您获得的年级编号。这就是我到目前为止所拥有的。

```
myScore x = if x > 90
    then let x = "You got a A"
if 80 < x < 90 
    then let x = "you got a B"
if 70 < x < 80
    then let x = "You got a C"
if 60 < x < 90
    then let x = "you got a D"
else let x = "You got a F" 
```

这给了我一个错误“输入'if'上的解析错误”，我也尝试过：

```
myScore x = (if x > 90 then "You got an A" | if 80 < x < 90 then "You got a B" | if 70 < x < 80 then "You got a D" | if 60 < x < 70 then "You got a D"  else "You got a F") 
```

但这也没有用。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-10T01:46:47.710

您不能`let`在条件句中使用，否则该变量`x`在需要它的以下表达式中将不可用。

在您的情况下，您甚至不需要 let-binding 因为您只想立即返回字符串，所以您可以这样做：

```
myScore x = 
    if x > 90 then "You got a A"
    else if 80 < x && x < 90 then "you got a B"
    else if 70 < x && x < 80 then "You got a C"
    else if 60 < x && x < 70 then "you got a D"
    else "You got a F" 
```

另请注意，您不能这样做`80<x<90`- 您必须将两个表达式与`&&`运算符结合起来。

以上可以在语法上进一步简化，使用警卫：

```
myScore x
    | x > 90 = "You got a A"
    | x > 80 = "you got a B"
    | x > 70 = "You got a C"
    | x > 60 = "you got a D"
    | otherwise = "You got a F" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-10T01:31:03.130

您需要`else`在每个`if`. 回想一下，在 Haskell 中，每个表达式都必须计算为一个值。这意味着每个`if`表达式都必须有一个匹配`then`子句和一个匹配`else`子句。您的代码只有一个`else`带有四个`if`s。编译器因为缺少`else`s 而抱怨。当你修复它时，你的 Haskell 代码看起来很像`if...else if...else`来自其他编程语言的链。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-10T01:54:54.413

为了完整起见，这里是@hammar 建议的保护语法：

```
myScore x
   | x > 90 = "A"
   | x > 80 = "B"
   | x > 70 = "C"
   | x > 60 = "D"
   | otherwise = "F" 
```

（“E”呢？）

注意这里不需要检查`x > 80 && x < 90`，因为当它通过第一个守卫时，它必须是那个`x <= 90`。对于以下所有守卫也是如此：无论何时尝试使用守卫，所有前面的守卫都保证为假。

如果 x == 90，这也更正了逻辑错误以得分“F”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-10T01:50:46.237

定义`x`不会将其定义在其词法范围之外——在这种情况下，`x`任何东西都无法访问。相反，使用语法

```
let x = 
      if 5 < 4
      then "Hmm"
      else "Better"
in "Here's what x is: " ++ x 
```

此外，使用所有这些`if`s 并不是 Haskell 中的最佳方式。相反，您可以使用保护语法：

```
insideText x
   | elem x [2,3,7] = "Best"
   | elem x [8,9,0] = "Better"
   | otherwise      = "Ok." 
```

# node.js - Node JS：自动选择`http.get`与`https.get`

> ID：15317902
> 
> 赞同：47
> 
> 时间：2013-03-10T01:28:39.757
> 
> 标签：node.js, get

我有一个需要下载文件的 Node JS 应用程序，在运行时给定一个 URL。

URL 可以是`http://`或`https://`。

我如何最好地满足不同的协议？

目前我有：

```
var http = require('http');
var https = require('https');

var protocol = (parsedUrl.protocol == 'https:' ? https : http);
protocol.get(parsedUrl, function(res) {
  ...
}); 
```

……但感觉很笨拙。

谢谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2016-07-19T18:26:47.993

我有类似的需求，但不需要完整的请求或针库，我有以下代码（略有不同）

```
var adapterFor = (function() {
  var url = require('url'),
    adapters = {
      'http:': require('http'),
      'https:': require('https'),
    };

  return function(inputUrl) {
    return adapters[url.parse(inputUrl).protocol]
  }
}());
//.. and when I need it
adapterFor(url).get(url, ...) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-12T11:36:08.800

您可以使用一堆模块，例如[request](https://github.com/mikeal/request)或[needle](https://github.com/tomas/needle)。他们会弄清楚要使用哪个协议，以及如何处理重定向（如果需要）等等。

# node.js - 带有 nodejs 和 express 的静态文件夹

> ID：15317904
> 
> 赞同：4
> 
> 时间：2013-03-10T01:28:51.013
> 
> 标签：node.js

```
var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server);

server.use(app.static('public'));
server.listen(3000);

app.get('/', function (req, res) {
  res.sendfile('index.html');
});

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
}); 
```

我只是想启动一个非常小的工作项目，但在涉及静态内容时我被卡住了。我检查了其他类似的线程，但我不知道为什么它对我不起作用。我只是得到这个错误：

```
server.use(app.static('public'));
                     ^
TypeError: Object function app(req, res){ app.handle(req, res); } has no method 'static' 
```

我想我做错了什么，但我真的想不出是什么。也许我应该尽快上床睡觉:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T01:38:03.303

从 express 3 开始的 API 是您需要将普通 express 模块与您的应用程序实例分开。

```
var express = require('express'); //do NOT invoke the function here
var app = express(); //DO invoke it here to get app
app.use(express.static(__dirname + '/public')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T01:38:34.897

问题是你需要使用`express.static()`，而不是`app.static()`。在您的示例中，应用程序是由

```
var express = require('express');
var app = express(); 
```

但是，您将其缩短为

```
var app = require('express')(); 
```

因为您这样做了，所以除了再次使用之外，您没有对基本 express 对象的任何引用`require('express')`，这是您需要使用静态的引用。

您可以通过两种方式解决此问题。

1）将您的开始代码更改为

```
var express = require('express')
    , app = express()
    , server = require('http').createServer(app)
    , io = require('socket.io').listen(server); 
```

并且您的配置为

```
app.use(express.static(path.join(__dirname, 'public'))); 
```

2）只需将配置更改为

```
app.use(require('express').static(path.join(__dirname, 'public'))); 
```

但是，每当您引用 Express 时，您都必须这样做。请注意，我没有尝试过此选项，但我假设它会起作用。

我肯定会推荐选项一。此外，您可能应该在为应用程序进行配置等之后创建服务器。

# cordova - $.mobile.changePage 不能跳转到 phonegap 中的另一个页面

> ID：15317905
> 
> 赞同：0
> 
> 时间：2013-03-10T01:28:52.580
> 
> 标签：cordova, jquery-mobile

当我使用PhoneGap和jmq开发app时，`$.mobile.changePage`无法切换到其他页面，代码片段如下：</p>

```
$('#travel_img').bind("click", function () {
  $(this).attr("src", "img/travel_highlight.png");
  $.mobile.changePage("views/main.html", "slide", false, true);
}); 
```

这段代码有什么问题？

# java - 运算符 || 未定义参数类型 boolean, String

> ID：15317912
> 
> 赞同：4
> 
> 时间：2013-03-10T01:29:26.800
> 
> 标签：java, android

我通过以下 IF 语句不断收到上述错误消息。任何帮助表示赞赏。

```
public void sendMessage(View button) {
        String mName = Name.getText().toString();
        String mGuess = Guess.getText().toString();
        if (mGuess != "1" || "2" || "3" || "4" || "5" || "6" || "7" || "8" || "9" || "10") {
            Toast.makeText(MainActivity.this,
                    "The number you entered was invalid. Please try again.", Toast.LENGTH_LONG).show();
        } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-10T01:31:17.010

首先，您通常不应该使用`!=`来比较字符串；改为使用`equals()`。`==`and`!=`运算符只会测试字符串是否是相同的对象；他们不测试相等的值。其次，您需要像这样扩展表达式：

```
if (!mGuess.equals("1") || !mGuess.equals("2") || /* etc */) { . . . 
```

最后，这个逻辑实际上没有任何意义。条件将始终为真（`mGuess`将始终“不等于”至少除一个测试字符串之外的所有字符串）。你可能想要：

```
if (!mGuess.equals("1") && !mGuess.equals("2") && /* etc */) { . . . 
```

一个更简洁的方法是：

```
List<String> validStrings = Arrays.asList("1", "2", ...);
if (!validStrings.contains(mGuess)) { ... 
```

（您可以声明`validStrings`为`static`类成员，以保存每次通过该方法创建一个。另外，请参阅[assylias 的答案，](https://stackoverflow.com/a/15317932/535871)了解如何使用 a`HashSet`而不是 an`ArrayList`进行查找；它会更快地进行查找。）

PS 正如 assylias 和 kcoppock 在评论中提到的，您应该考虑将输入解析为一个`int`值，然后进行数值测试。不同之处在于，解析为 an`int`会将“07”视为与“7”相同。如果您想允许这样做，那么此代码将完成这项工作：

```
boolean ok = false;
try {
    int guess = Integer.parseInt(mGuess);
    ok = guess >= 1 && guess <= 10;
} catch (NumberFormatException ignored) {
}
if (!ok) { . . . 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-10T01:31:51.217

如前所述，您需要明确说明每个条件。一种更紧凑的编写方式是：

```
Set<String> oneToTen = new HashSet<String> (Arrays.asList("1", "2", "3", "4", "5", "6", "7", "8", "9", "10");

if (!oneToTen.contains(mGuess)) { 
```

或者，如果您知道 mGuess 是一个数字，您可以先将其解析为整数：

```
int guess = Integer.parseInt(mGuess);
if (guess < 0 || guess > 10) {
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-10T01:56:56.240

编译器错误¹的*原因*是表达式

```
mGuess != "1" || "2" || .. 
```

等效地解析为

```
((mGuess != "1") || "2") || .. 
```

然而，类型`myGuess != "1"`是`boolean`，所以上面的表达式被键入为

```
((boolean) || String) || String) || .. 
```

但`boolean || String`无效，根据编译器错误：

> 运算符 || 未定义参数类型 boolean, String

* * *

¹请参阅其他答案之一以获取解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-10T01:31:40.187

您需要使用`&&`来评估否定表达式，`.equals`用于`String`比较，并在`if`语句中使用语法正确的表达式：

```
if (!mGuess.equals("1") && !mGuess.equals("2") && ... 
```

另请参阅：[Java String.equals 与 ==](https://stackoverflow.com/questions/767372/java-string-equals-versus)

# c# - System.Web.HttpPostedFileWrapper 字符串被保存而不是文件路径名

> ID：15317913
> 
> 赞同：0
> 
> 时间：2013-03-10T01:29:28.413
> 
> 标签：c#, asp.net, asp.net-mvc

这曾经可以正常工作，但现在代码没有将路径名保存到`SitePlan`and`SiteImage`字段。如果我调试一切看起来都很好并且`SitePlan`包含`SiteImage`上传文件的路径名（即~/UploadedFiles/20110210104108SiteImage77.jpg）。但是一旦保存在`SitePlan`and`SiteImage`字段中就是字符串值“System.Web.HttpPostedFileWrapper”。

努力解决这个问题，因为它保存得很好，观察和调试保存的值是路径名，所以没有错误，一切似乎都可以工作，只是数据库没有路径，只有这个字符串“System.Web.HttpPostedFileWrapper”。任何评论都非常感谢

这是我的控制器代码：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult SiteLocationEdit(int id, FormCollection collection)
{
    SiteLocation siteLocation = this._siteRepository.GetSite(Convert.ToInt16(collection["SiteId"])).SiteLocation;           

    if (Request.Files.Count > 0 && Request.Files["SitePlan"].ContentLength > 0)
    {
        DeleteFile(siteLocation.SitePlan);
        siteLocation.SitePlan = SaveFile(Request.Files["SitePlan"], @"~/UploadedFiles", "SitePlan" + siteLocation.SiteId.ToString());
    }

    if (Request.Files.Count > 0 && Request.Files["SiteImage"].ContentLength > 0)
    {
        DeleteFile(siteLocation.SiteImage);
        siteLocation.SiteImage = SaveFile(Request.Files["SiteImage"], @"~/UploadedFiles", "SiteImage" + siteLocation.SiteId.ToString());
    }

    TryUpdateModel(siteLocation);

    if (!ModelState.IsValid)
        return View(siteLocation);  

    this._siteRepository.Save(User.Identity.Name);
    return RedirectToAction("SiteLocationDetails", new { id = siteLocation.SiteId });                                   
} 
```

这是我的包含部分视图的视图（在本文后面显示）

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<Lms.Model.SiteLocation>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    <%= Html.Encode(Model.Site.SiteDescription) %>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<%=Html.Script("~/Scripts/jquery.textarea-expander.js")%>

    <%= Html.ValidationSummary("Location Create was unsuccessful. Please correct the errors and try again.\n If you uploaded images during this update please upload again.")%>
    <% using (

        Html.BeginForm
        (
            "SiteLocationEdit",
            "Site",
            FormMethod.Post,
           // add an encoding type attribute
           // that is required for file upload
            new { enctype = "multipart/form-data" }
        )

           )
       {%>
        <% Html.RenderPartial("SiteTabs", Model.Site); %>
        <div class="clear">
        </div>
        <% Html.RenderPartial("SiteLocationForm", Model); %>

    <% } %>

        <script type="text/javascript">
            /* jQuery textarea resizer plugin usage */
            $(document).ready(function() {
                jQuery("textarea[class*=expand]").TextAreaExpander(); // initialize all expanding textareas, new code, john s 10/08/2010
            });
        </script>

</asp:Content> 
```

**这是部分视图：**

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<Lms.Model.SiteLocation>" %>
<fieldset>
    <div>
        <h3>
            <label id="Label2" style="text-align: left">
                <%= "Site Location: " + Html.Encode(Model.Site.SiteDescription) %></label>
        </h3>
    </div>
    <div class="formFields">
        <ul>
            <%--This is used to identify the site object to update when the model is returned to the controller--%>
            <%= Html.Hidden("SiteId", Model.SiteId)%>
            <li>
                <label for="Latitude">
                    <strong>Latitude:</strong></label>
                <%= Html.TextBox("Latitude")%>
                <%= Html.ValidationMessage("Latitude", "*")%>
            </li>
            <li>
                <label for="Longitude">
                    <strong>Longitude:</strong></label>
                <%= Html.TextBox("Longitude") %>
                <%= Html.ValidationMessage("Longitude", "*") %>
            </li>
            <li>
                <label for="Location">
                    <strong>Location Address:</strong></label>
                <label><%= Html.TextArea("Location", Model.Location, new { @class = "expand50-200"}) %></label>
                <%= Html.ValidationMessage("Location", "*") %>
            </li>
            <li>
                <label for="NearestPostcode">
                    <strong>Nearest Postcode:</strong></label>
                <%= Html.TextBox("NearestPostcode") %>
                <%= Html.ValidationMessage("NearestPostcode", "*") %>
            </li>
            <li>
                <label for="TimeFromOfficeToTurbine">
                    <strong>Office to Windfarm (Time):</strong></label>
                <%= Html.TextBox("TimeFromOfficeToTurbine") %>
                <%= Html.ValidationMessage("TimeFromOfficeToTurbine", "*") %>
            </li>
            <li>
                <label for="Directions">
                    <strong>Comments:</strong></label>
                <label><%= Html.TextArea("Directions", Model.Directions, new { @class = "expand50-200" })%> </label>
                <%= Html.ValidationMessage("Directions", "*") %>
            </li>

            <li>
            <h5><strong>For Image Uploads:</strong> Please use only JPG,JPEG or GIF formats.
            Image size should be appropriate for the webpage to display, approximately 500x375 (WidthxHeight)
            </h5>
            </li>

            <li>
                <label for="Site Plan">
                    <strong>Site Plan:</strong></label>
                <input id="SitePlan" name="SitePlan" type="file" />
            </li>

            <li>
                <label for="Site Image">
                    <strong>Site Image:</strong></label>
                <%--            <%//= Html.TextBox("SiteImage", Model.SiteImage)%>
            <%//= Html.ValidationMessage("SiteImage", "*") %>--%>
                <input id="SiteImage" name="SiteImage" type="file" />
            </li>

        </ul>
    </div>
</fieldset>
 <div class='demo'>
    <%=Html.ActionLink("< Back to List", "Index") %><input type="submit" value="Save" />
</div> 
```

这是控制器代码中的保存文件过程：

```
protected String SaveFile(HttpPostedFileBase file, String path, string name)
{
    if (file != null && file.ContentLength > 0)
    {
        if (path == null)
        {
            throw new ArgumentNullException("path cannot be null");
        }

        string fileType = file.FileName.Substring(file.FileName.LastIndexOf("."), file.FileName.Length - file.FileName.LastIndexOf("."));

        String relpath = String.Format("{0}/{1}", path, PrefixFName(name + fileType));
        try
        {
            file.SaveAs(Server.MapPath(relpath));
            return relpath;
        }
        catch (HttpException e)
        {
            throw new ApplicationException("Cannot save uploaded file", e);
        }
    }
    return null;
} 
```

这是 SiteLocationCreate() THIS WORKS，只是没有的编辑：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult SiteLocationCreate(SiteLocation siteLocation, FormCollection collection)
{
    // TODO CF: Look into this line.  Is there a better way to do it?  I would think so.
    // It uses a hidden field in the object form
    Site site = this._siteRepository.GetSite(Convert.ToInt16(collection["SiteId"]));                        
    site.SiteLocation = siteLocation;

    if (Request.Files.Count > 0 && Request.Files["SitePlan"].ContentLength > 0)
    {
        DeleteFile(siteLocation.SitePlan);
        siteLocation.SitePlan = SaveFile(Request.Files["SitePlan"], @"~/UploadedFiles", "SitePlan" + siteLocation.SiteId.ToString());
    }

    if (Request.Files.Count > 0 && Request.Files["SiteImage"].ContentLength > 0)
    {
        DeleteFile(siteLocation.SiteImage);
        siteLocation.SiteImage = SaveFile(Request.Files["SiteImage"], @"~/UploadedFiles", "SiteImage" + siteLocation.SiteId.ToString());
    }

    if (!ModelState.IsValid)              
        return View(siteLocation);                            

    this._siteRepository.Save(User.Identity.Name);
    return RedirectToAction("SiteLocationDetails", new { id = site.SiteId });                                   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T04:41:29.313

删除了 TryUpdateModel() 行及其工作。但是必须为每个字段更新逐行指定，即 siteLocation.Location = collection["Location"]; 等等等等。由于 TryUpdateModel 已被取出

# linux - 这是什么汇编语言？

> ID：15317914
> 
> 赞同：-3
> 
> 时间：2013-03-10T01:29:30.160
> 
> 标签：linux, gcc, assembly, gdb

这是什么汇编语言？

```
(gdb) disass bar
Dump of assembler code for function bar:
0x08048374 <bar+0>:  push   %ebp
0x08048375 <bar+1>:  mov    %esp,%ebp
0x08048377 <bar+3>:  sub    $0x10,%esp
0x0804837a <bar+6>:  mov    0x8(%ebp),%eax
0x0804837d <bar+9>:  add    $0x1,%eax
0x08048380 <bar+12>: mov    %eax,-0x4(%ebp)
0x08048383 <bar+15>: mov    -0x4(%ebp),%eax
0x08048386 <bar+18>: leave  
0x08048387 <bar+19>: ret    
End of assembler dump.
(gdb) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:30:49.813

[它显然是AT&T 语法](http://www.imada.sdu.dk/Courses/DM18/Litteratur/IntelnATT.htm)中的 32 位 x86 程序集。

# mysql - 当生日在 MySQL 中存储为“日期”类型时，如何找到年龄在 25 到 30 之间的用户？

> ID：15317916
> 
> 赞同：1
> 
> 时间：2013-03-10T01:30:18.583
> 
> 标签：mysql, date

[在此之前](https://stackoverflow.com/questions/9788542/how-to-store-birthdate-and-age-so-that-age-can-be-updated-daily-in-php-mysql)，我已被告知 SO的正确方法是：

```
WHERE birth_date BETWEEN date_sub(curdate(), INTERVAL 25 YEAR) 
                     AND date_sub(curdate(), INTERVAL 30 YEAR) 
```

但是，这实际上并不包括 30 岁以上和 31 岁以下的用户。当我们通常所说的人的年龄时，我们将 30 岁 11 个月的人仍然是“30”。

考虑到这一点，简单地设置第二个间隔`31`（比您预期的多一年）似乎是一个明显的解决方案，但这包括今天年满 31 岁的用户，所以这不好。

那么，在 MySQL中将生日存储为 type 时，找到年龄**大于或等于**25 岁且**小于31 岁的用户的****明确**且**最快的方法是什么？******`date`****

 ***** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:32:39.387

您只需要切换两个日期，在第一个日期添加另一天，如下所示：

```
WHERE birth_date 
BETWEEN 
    date_add(
        date_sub(curdate(), INTERVAL 31 YEAR), 
        INTERVAL 1 DAY
    )
AND date_sub(curdate(), INTERVAL 25 YEAR) 
```

查看其他建议的答案，实际上有一个更简单的解决方案。

```
WHERE birth_date <= date_sub(curdate(), INTERVAL 25 YEAR) 
      AND birth_date > date_sub(curdate(), INTERVAL 31 YEAR) 
```

请注意`>`第二次比较，这节省了添加 1 天间隔，但您仍然需要使用 31 年，而不是 30 年。`BETWEEN AND`表达式将执行`>=`and `<=`。

（当它被证明是正确的并且他/你编辑了比较并将 30 更改为 31 时，请接受他的答案 - 他指出我正确的方向）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T01:34:55.807

当进行正常比较时，您不必*使用*`BETWEEN`日期，尤其是在具有奇怪边缘行为的情况下。

```
WHERE birth_date <= date_sub(curdate(), INTERVAL 25 YEAR) 
      AND birth_date >= date_sub(curdate(), INTERVAL 30 YEAR) 
```****

# wordpress - WooCommerce 插件 - 在产品上显示除最低价格以外的价格

> ID：15317921
> 
> 赞同：1
> 
> 时间：2013-03-10T01:30:47.313
> 
> 标签：wordpress, woocommerce

我有一个销售面料的电子商务网站。在设置产品变体时，我知道默认设置是在字符串中显示最低价格。我不想显示最低价格，而是需要从我的变体字符串中的第四行/价格中获取价格。例如，如果我有一个每码 20 美元的产品，我希望产品帖子显示“每码价格：20 美元”而不是“起价：5 美元”，因为客户可以以 1/4 码的增量购买产品，1/ 2 码、3/4 码、1 码等。我还想将文本从“从”更改为“每码价格”。请指出正确的方向，以在 WooCommerce 中进行此更改。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:22:51.833

查看 woocommerce.css 并找到价格部分。

您可以右键单击 chrome 中的项目并检查元素以确定价格来自何处，在此处发布该部分代码，我会帮助您。

# javascript - JavaScript 中的浏览器事件是异步的吗？

> ID：15317924
> 
> 赞同：13
> 
> 时间：2013-03-10T01:30:59.393
> 
> 标签：javascript, browser, asynchronous

在[John Resig](http://ejohn.org/)的《Javascript Ninja 的秘密》一书中，他做出了以下断言：

> 浏览器编程没有什么不同，只是我们的代码不负责运行事件循环和调度事件；浏览器为我们处理。
> 
> 我们的职责是为浏览器中可能发生的各种事件设置处理程序。这些事件在发生时被放置在一个事件队列（一个 FIFO 列表；稍后会详细介绍）中，并且浏览器通过调用为它们建立的任何处理程序来调度这些事件。
> 
> **因为这些事件发生在不可预知的时间和不可预知的顺序，我们说事件的处理，以及它们的处理函数的调用，是异步的。**

我很难接受这里使用异步这个术语。他真的不是说按时间顺序排列的吗？它们也可能是异步的，但不是出于支持此声明的原因。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T02:19:25.433

> 因为这些事件发生在不可预知的时间和不可预知的顺序，我们说事件的处理，以及它们的处理函数的调用，是异步的。

这是一个善意的谎言；也许有点夸张。然而;

*   *没有*明确顺序的事件可能会以不可预知的顺序发生。

    示例：AJAX 请求 - 哪个响应先到达？

*   *具有*明确顺序的事件以可预测的顺序发生。

    示例：`setTimeout(a); setTimeout(b);`-`a`将在 之前调用`b`。

和一粒盐一起吃，不要做得太多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-05T20:18:17.803

您的问题标题和问题正文似乎在问两个不同的问题。我会尝试解决这两个问题。

**身体问题**

异步不是 John 创造的术语，甚至不是 JavaScript 特定的术语。它在计算机科学中具有既定的含义。尽管约翰所说的是准确的，但我认为它是不完整的。他正确地解释了为什么我们使用术语异步（词源），但没有解释什么是异步编程。

在计算机科学中，异步意味着暂停执行代码，允许其他（任意）代码在同一线程中运行，并最终恢复暂停的代码。有很多技术可以实现这一点，也有很多方法可以为程序员抽象出来，但它们都具有暂停代码而不是阻塞的特征。这用于避免在等待一些慢速资源（如 HTTP 请求、文件或数据库）时阻塞整个线程。

例如，如果您要发出一个*同步*HTTP 请求，那么在请求完成之前没有其他 JavaScript 可以运行。因此，任何依赖于 JavaScript 的网页部分都会被冻结。但是，如果您发出*异步*HTTP 请求，则发出请求的代码可以在等待请求时暂停。这允许其他代码执行。并且在 HTTP 请求完成后，请求代码可以恢复。

John 说异步代码可以发生的原因是任何顺序，因为我们不知道外部资源何时可用。例如，如果您发出两个或多个异步 HTTP 请求，则无法知道请求将以什么顺序完成（因此，代码将恢复的顺序）。

**标题问题**

浏览器事件是异步的，就像我们的示例 HTTP 请求一样。事实上，在很多方面用户只是作为其他外部资源。用户将在自己的时间做事，与当前正在执行的代码异步。

例如，如果您的代码为页面上按钮的单击事件定义了一个处理程序。您的 JavaScript 代码不会等待用户单击按钮。它为单击处理程序挂起该代码，并在用户单击按钮时稍后执行它。这就是为什么异步编程在 JavaScript 中如此重要的核心。如果您的代码只是阻塞（等待）直到该 HTTP 请求完成，则用户无法单击该按钮。如果您的代码在等待用户单击某些内容时被阻塞，那么您的 HTTP 请求将超时。

**最后的想法**

在 JavaScript 中，我们通常不会考虑暂停和恢复代码。事实上，您不能只是在正在运行的代码块中间暂停。该块将始终在执行其他任何操作之前完成。相反，我们将回调从我们的代码块中传递出来，以便稍后执行。这些回调可以同时访问原始代码块中的资源（范围）。回调是从原始上下文恢复的内容。

如果您想深入了解 JavaScript 如何管理[并发模型和事件循环，](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop)这是一个很好的资源。此外，除了回调之外，JavaScript 还为事件循环添加了一些强大的抽象，例如[Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)和[Generators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*)。这些值得花一些时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-10T01:49:41.290

ajax 请求的事件处理与用户发起的事件相同。当您调用 时`xhmlhttprequest.open`，您将启动一个异步调用，该调用在请求完成时由`onreadystatechange`事件处理（可能随时发生）。同样，用户可以随时在 DOM 元素上发起事件。

事件的*处理及其回调的**调用*是异步的，但不一定是回调本身。

我也发现这是一个定义：

> 属于或需要某种形式的计算机控制定时协议，其中特定操作在收到指示（信号）时开始

该信号可能是单击事件或 xmlhttprequest 就绪状态更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-20T13:38:08.663

它的措辞方式，我认为它在技术上是正确的（你可能不同意）尽管令人困惑。我会用不同的措辞，因为它似乎表明你的 JavaScript 执行调用被抢占了。

> 它们的处理函数的调用是异步的。

处理程序的调用（由浏览器本身完成，可能是 C 或 C++，而不是 JavaScript）确实是异步发生的，也就是说，还有其他线程将事件添加到队列中，这意味着事件循环被抢占。

他没有说处理程序的执行是异步的。这些保证运行完成并且不会被抢占（被其他 JavaScript）。

我认为困扰你的另一件事是

> 因为这些事件发生在不可预测的时间和不可预测的顺序，

这并不是说没有事件以可预测的顺序运行，但有些事件确实如此，因此它在技术上也是正确的，但正如您在`setTimeout`示例中所展示的那样具有误导性。例如：

*   XHR 请求
*   同一节点上的多个处理程序过去没有保证顺序，[但现在有](https://stackoverflow.com/a/25016769/227299)

另请注意，如果您确实触发了合成事件或调用`click()`元素，则将立即调用其所有处理程序（跳过队列），新事件不会进入队列。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-10T01:50:05.130

我相信 Resig 的意思是，UI 事件必须由浏览器异步处理，否则如果在处理其他内容时执行单击，UI 会阻塞。通常，桌面软件通过多线程来解决这个问题。Web 应用程序依赖于 JavaScript，它使用事件循环来实现异步。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-09T01:29:15.480

只是偶然发现了这个非常古老的线程，具有非常现代的含义。尽管普遍认为“JavaScript 是单线程的”，但事件触发确实是异步的。

在任何运行 jQuery 的浏览器中测试：

```
$('body').click(function () { setTimeout(f => alert('foo'), 1000); });
function calltrigger() { $('body').click(); alert('bar'); }
calltrigger(); 
```

这做了三件事并证明了这一点：

1.  将 onClick 事件添加到`body`, alert('foo') 延迟 1 秒。
2.  定义一个匿名函数，该函数首先触发 onClick 事件，然后调用 alert('bar')。
3.  调用匿名函数。

如果函数中的 onClick 事件被阻塞（同步），您会在“bar”警报之前看到“foo”警报。但你没有。onClick 事件是异步触发的，先触发 alert('bar')，然后触发 alert('foo')。

相反，onClick 事件会触发，并且代码会在事件代码完成之前转到第二个警报。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-10T01:35:33.673

JavaScript 是异步的……它会继续处理代码，即使你调用的方法还没有返回……所以是的，那是正确的。这就是异步的定义：不同步......

我得到了你的查询……因为 FIFO……但我认为使用的术语是合适的……因为它的定义与他们所说的完全一致。

# sqlite - 将文本文件中的内容加载到 sqlite 表？

> ID：15317929
> 
> 赞同：12
> 
> 时间：2013-03-10T01:31:26.430
> 
> 标签：sqlite

我有只包含普通文本的简单文本文件。

我想知道是否有办法将文本内容加载到 sqlite 中的表中。

所以也许我可以创建表 myTable(nameOfText TEXT, contents TEXT);

然后将文本名称放入第一列，将内容放入第二列。

如果输入文件名很困难，将内容加载到一个列表中就可以了。

任何建议将不胜感激。

谢谢 ！！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-10T06:26:05.483

假设您有一个 CSV 格式的文件 text.txt：

```
name1,content1
name2,content2 
```

尝试以下命令将 test.txt 中的数据导入表中

```
D:\test>sqlite3 test.db
SQLite version 3.6.23
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> create table myTable(nameOfText TEXT, contents TEXT);
sqlite> .separator ","
sqlite> .import test.txt myTable
sqlite> select * from myTable;
name1,content1
name2,content2
sqlite> 
```

在导入数据之前，使用**.separator**命令更改文本文件中使用的分隔符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-01T21:49:17.473

termsql 是一个工具，可以将文件中的文本或程序（stdin）的输出即时转换为 sqlite 数据库。

```
termsql -c nameOfText,contents -i input.txt -o myDB.db 
```

这将创建一个包含列 nameOfText 和内容的表。对于 input.txt 中的每一行，将在 myDB.db 中插入一行。

您没有告诉我们分隔符 nameOfText 和上下文是由分隔的。默认情况下，termsql 假定空格是分隔符。但是如果它是'，'，那么你会做这样的事情：

```
termsql -d ',' -c nameOfText,contents -i input.txt -o myDB.db 
```

您可以在这里获取 termsql： [https ://github.com/tobimensch/termsql](https://github.com/tobimensch/termsql)

Termsql 也有其他用例。您可以在一个命令中对新数据库执行 SQL 语句。下面的示例将创建您的数据库并在命令行上为内容列包含字符串“test”的所有行返回 nameOfText 列。

```
termsql -d ',' -c nameOfText,contents -i input.txt -o myDB.db "select nameOfText from tbl where contents like '%test'" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-19T11:53:57.127

该函数`readfile`读取文件的内容并将该内容作为 BLOB 返回。此功能在使用命令行 shell 时可用。例如：

```
sqlite> CREATE TABLE files(name TEXT, content TEXT);
sqlite> INSERT INTO files(name,content) VALUES('a.txt',readfile('a.txt')); 
```

此函数的文档`writefile`可在[http://www.sqlite.org/cli.html](http://www.sqlite.org/cli.html)获得。

# java - 扫描外部文件进行匹配后，如何仅打印一次“NO MATCH FOUND”？

> ID：15317935
> 
> 赞同：1
> 
> 时间：2013-03-10T01:32:29.273
> 
> 标签：java

我有一个快速的问题。我正在尝试使用该程序读取我写入桌面的外部文件。我可以正确搜索匹配项，但是当我找不到匹配项时，我希望它打印“NO MATCH FOUND”。但是，它会为在我的外部文件中找不到匹配项的每一行打印“NO MATCH FOUND”。我将如何解决它，所以它只打印一次“NO MATCH FOUND”？

```
 System.out.println("Enter the email "
        + "address to search for: ");
    String searchterm = reader.next();

    // Open the file as a buffered reader
    BufferedReader bf = new BufferedReader(new FileReader(
        "/home/damanibrown/Desktop/contactlist.txt"));

    // Start a line count and declare a string to hold our current line.
    int linecount = 0;
    String line;

    // Let the user know what we are searching for
    System.out.println("Searching for " + searchterm
        + " in file...");

    // Loop through each line, put the line into our line variable.
    while ((line = bf.readLine()) != null) {

        // Increment the count and find the index of the word
        linecount++;
        int indexfound = line.indexOf(searchterm);

        // If greater than -1, means we found a match
        if (indexfound > -1) {
            System.out.println("Contact was FOUND\n"
                + "Contact " + linecount + ": " + line);
        }
    }
    // Close the file after done searching
    bf.close();
} 

catch (IOException e) {
    System.out.println("IO Error Occurred: " + e.toString());
}

break; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:40:28.803

我注意到您的循环将为匹配的每一行打印出“找到联系人”部分（我假设因为可能不止一个）...既然是这种情况，您需要使用另一个标志来确定是否进行了任何匹配，如果没有匹配则输出。

在你的 while 循环中试试这个：

```
 // Loop through each line, put the line into our line variable.
    boolean noMatches = true;
    while ((line = bf.readLine()) != null) {

        // Increment the count and find the index of the word
        linecount++;
        int indexfound = line.indexOf(searchterm);

        // If greater than -1, means we found a match
        if (indexfound > -1) {
            System.out.println("Contact was FOUND\n"
                    + "Contact " + linecount + ": " + line);
            noMatches = false;
        }
    }
    // Close the file after done searching
    bf.close();
    if ( noMatches ) {
        System.out.println( "NO MATCH FOUND.\n" );
    } 
```

# javascript - 确认框，然后用输入框验证内容

> ID：15317938
> 
> 赞同：0
> 
> 时间：2013-03-10T01:32:41.173
> 
> 标签：javascript, jsp

是否可以通过简单的确认，在jsp中提示并获取值并返回主页进行下一步操作来实现以下操作序列？

顺序操作：单击取消链接->确认弹出框->提示框以获取更多信息->单击确定按钮，主页获取输入文本并传递给取消功能。

这是我到目前为止所拥有的，但它似乎有问题，但我不知道我是否必须为此使用 div 。

非常感激！

```
<a class="action" href="manualCancel?obj={{objectId}}&cancel={{cancelInfo}}" onclick="return createCancel('cancel this ({{ objectId }})')">Cancel</a>

function createCancel(action) {
    ret = confirm('Are you sure you want to ' + action + '?')
    if (ret) {
        var cancelInfo;
        do {
            cancelInfo = prompt('Please provide valid cancel reason', '');
        }
        while(cancelInfo.length < 4){
            dim()
            return true;
        }
        return false;
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T17:53:34.810

利用`location.href`

```
<a class="action" href="#" onclick="createCancel('cancel this ({{ objectId }})')">Cancel</a>

function createCancel(action) {
    ret = confirm('Are you sure you want to ' + action + '?')
    if (ret) {
        var cancelInfo;
        do {
            cancelInfo = prompt('Please provide valid cancel reason', '');
        }
        while(cancelInfo.length < 4){
            dim()
        }
        location.href = 'manualCancel?obj={{objectId}}&cancel=' + cancelInfo;
    }
} 
```

# c# - 在 c# 中使用枚举类型键获取相同的值

> ID：15317943
> 
> 赞同：0
> 
> 时间：2013-03-10T01:34:24.070
> 
> 标签：c#, enums

如何`enum`在 ac# 应用程序中将 2 个值关联到单个类型值？例如，我有这样的`enum`类型：

```
public enum person 
{ 
    soccerPlayer, 
    tennisPlayer, 
    athlete, 
    coach
} 
```

足球运动员和网球运动员是运动员，但教练不是运动员。

如果我以一个人为例，如下所示：

```
person p = person.soccerPlayer; 
```

我该如何做这个测试？

```
if (p == person.athlete) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T01:38:14.690

在这种特殊情况下，您最好通过函数检查来查看该`enum`值是否为运动员

```
static bool IsAthlete(person p) { 
  switch (p) { 
    case person.soccerPlayer:
    case person.tennisPlayer:
    case person.athlete:
      return true;
    default:
      return false;
  }
} 
```

总的来说，虽然我不相信一种`enum`类型在这里能很好地为你服务。An`enum`通常用于表示互斥值（可以是 A 或 B 但不能同时是两者）或用于位标志情况。您可以操纵位标志在这里工作，但我觉得这不是最好的方法。

这种情况似乎更适合成熟的类型。

```
class Person { 
  public bool IsAthlete { get; private set; } 
  public bool IsSoccerPlayer { get; private set; } 
  public bool IsTennisPlayer { get; private set; }

  public static readonly TennisPlayer = new Person { 
    IsTennisPlayer = true, 
    IsAthelete = true
  }

  public static readonly SoccerPlayer = new Person { 
    IsSoccerPlayer = true, 
    IsAthelete = true
  }      
} 
```

# c# - 如何加快对 ASP.NET Web 服务的首次调用？

> ID：15317947
> 
> 赞同：0
> 
> 时间：2013-03-10T01:35:35.297
> 
> 标签：c#, asp.net, web-services, mono

我有一个非常基本的 ASP.NET Web 服务。

它可以工作，但是第一次调用需要 10 秒 - 而后续调用会立即发生。

我意识到它是 JIT 编译的，因此我试图了解如何预编译事物以加快第一次调用。

到目前为止，这是我所做的。

网络服务文件是：*HelloWorldService.cs*：

```
using System.Web.Services;
namespace MyService
{
  public class HelloWorldService: WebService
  {
    [WebMethod]
    public string HelloWorld()
    {
      return "Hello World";
    }
  }
} 
```

我已经编译了这个使用`gmcs -target:library HelloWorldService.cs -r:System.Web.Services`

我已将生成的`HelloWorldService.dll`文件放在 webroot 的 /bin 目录中。

接下来，我创建了`HelloWorld.asmx`-stub 文件，如下所示：

```
<%@WebService Language="C#" Class="MyService.HelloWorldService"%> 
```

这可行，但如前所述，第一次调用需要 10-15 秒才能完成......尽管后续调用工作正常。

在研究过程中，我看到了您需要使用该`sgen`实用程序来创建序列化 XML 文件的参考资料。

我通过运行使用了该文件：

```
sgen HelloWorldService.dll 
```

它创建一个文件名`HelloWorldService.XmlSerializers.dll`并将其也放入`/bin`目录中。

然而，这些都没有帮助。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:45:02.827

通常，您要确保您的生产服务几乎永不停止。那么就没有“第一个”请求，因为只有在需要更改时才会重新编译。当您确实需要对生产进行更改（或重新启动服务器）时，您可以将其安排在低使用时间。如果没有可接受的低使用时间，您可以使用网络场，并在更新期间从场中删除服务器，并在更新期间向更新的服务器发出“第一个”请求，然后再将其返回场。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T01:46:50.527

我已经使用 .Net 多年了，但我还没有找到任何东西来加速对 Web 服务或 Web 应用程序的第一次调用（另一方面，网站很棒，因为它们编译页面它们被称为一个接一个，这使事情变得更快）...

第一次调用总是编译所有内容，是的，这需要时间......但在那之后，如果你将 IIS 设置为不“在 X 时间后休眠应用程序池”，那很好。

我已经习惯自己做的是，每次我发布网站或网络服务时，我都会在浏览器中自己调用它，然后向相关人员发出“全部清除”消息......这样他们就可以获得即时服务从那时起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T04:11:25.000

我什至不知道它是否适用于 ASP.NET，但既然你用#mono 标记了这个问题，也许你应该看看这个（如果你还没有的话）：[http://www.mono- project.com/AOT](http://www.mono-project.com/AOT)

# php - 在这种特定情况下如何使用 POST 而不是 GET

> ID：15317950
> 
> 赞同：2
> 
> 时间：2013-03-10T01:36:09.543
> 
> 标签：php, http-headers

我有一个名为 insert_comment.php 的表单，它包含以下功能：

```
function died($error) { // if something is incorect, send to given url with error msg
  header("Location: http://mydomain.com/post/error.php?error=" . urlencode($error));
  die();
} 
```

在代码的下方，$error_message 被发送到函数 die，然后函数 die 将用户重定向到 mydomain.com/post/error.php，我从 URL 获得错误消息：

```
$error = $_GET["error"];

echo 'some text '. $error .' sometext'; 
```

有没有办法使用 POST 重定向来做同样的事情？我不喜欢在 URL 中显示整个错误消息，它看起来很丑陋。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T01:40:12.410

虽然使用 POST 可能会很复杂，但这是错误的策略，而不是 POST 请求的目的。

正确的策略是将此信息[放入 session](http://www.php.net/manual/en/book.session.php)中，并从那里显示它，然后在显示时删除 session 密钥。

```
// session_start() must have been called already, before any output:
// Best to do this at the very top of your script
session_start();

function died($error) {
  // Place the error into the session
  $_SESSION['error'] = $error;
  header("Location: http://mydomain.com/post/error.php");
  die();
} 
```

### 错误.php

```
// Read the error from the session, and then unset it
session_start();

if (isset($_SESSION['error'])) {
  echo "some text {$_SESSION['error']} sometext";

  // Remove the error so it doesn't display again.
  unset($_SESSION['error']);
} 
```

完全相同的策略可用于在重定向后向用户显示其他消息，例如操作成功。根据需要在数组中使用尽可能多的不同键`$_SESSION`，并在向用户显示消息时取消设置它们。

# jquery - 将值传递给 jquery 对话框表单

> ID：15317953
> 
> 赞同：2
> 
> 时间：2013-03-10T01:36:40.653
> 
> 标签：jquery, forms, jquery-ui-dialog

我需要一个对话框窗口来弹出一个表单并将一个值传递给这个表单。我尝试了几种方法来解决这个问题，但我一直无法这样做。我已经搜遍了，似乎没有任何效果。

这是我最近的尝试：

```
 var message="variable";

 .click(function() {
 $( "#dialog-form" ).dialog( "open" );
 $('<input>').attr({
    type: 'text',
    id: 'hidden-input",
    value: message,
    name: 'bar'
 }).appendTo("#dialog-form"); 
```

如果我将追加内容放在对话框中，弹出窗口将停止工作（我想我不知道如何正确执行此操作）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-10T12:21:54.293

我完全使用脚本进行对话处理（我认为它更干净）：

[http://jsfiddle.net/fE6q2/](http://jsfiddle.net/fE6q2/)

html:

```
Default firstname:<br>
<input type='text' id="default_firstname"/>
<br><br>
<button onclick='on_create_form_clicked()'>create form</button> 
```

javascript:

```
function on_create_form_clicked()
{
    var html =
       "<div>" +
          "Firstname:<br>" +
          "<input type='text' class='firstname'/>" +
          "<br/><br/>" +
          "Lastname:<br>" +
          "<input type='text' class='lastname'/>" +
          "<br/><br/>" +
          "<button class='ok'>ok</button>" +    
       "</div>";

    var div = $(html);

    var default_firstname = $('#default_firstname').val();
    div.find('.firstname').val(default_firstname);        

    div.find('.ok').click(function()
    {
        div.dialog('close');

        var firstname = div.find('.firstname').val();
        var lastname = div.find('.lastname').val();

        alert("firstname was " + firstname
            + " and lastname was " + lastname);        
    });

    div.dialog(
    {
        title:"Enter firstname and lastname",
        close: destroy_this_dialog
    });
}

function destroy_this_dialog(event, ui)
{
  $(this).dialog("destroy");
  $(this).remove();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-10T01:44:06.307

我*想*你正在寻找这样的东西：

```
<script>
$(function(){
   var message = "variable";

   $("#showDialog").click(function() {
      $("#hidden-input").val(message);

      $("#dialogForm").dialog("open");
   });
});
</script>

<button id="showDialog">Show Dialog</button>

<div id="dialogForm">
<input type="text" id="hidden-input" name="bar"/>
</div> 
```

# delphi - 复合组件的错误

> ID：15317954
> 
> 赞同：1
> 
> 时间：2013-03-10T01:36:46.640
> 
> 标签：delphi, delphi-7, delphi-2010, vcl

我正在尝试创建一个具有 TScrollBox 的复合组件，我可以在其上创建多个 TPanel。TPanel 将对它们进行控制，但最重要的是 TImages。Columns 属性确定何时拖放到新行。请参阅下面的代码。目前，我可以添加一个 TPanel，但是当我添加另一个时，它会出现 StackOverflow 错误

面板是通过 Images 属性 (TStringList) 添加的。Stringlists ListChanged 事件清除面板并重新更新它。

从应用程序中，我可以这样添加图像：

```
if OpenPictureDialog1.Execute then
 TViewer1.Images.Add(OpenPictureDialog1.FileName) 
```

我对组件很陌生，所以请放轻松:)

```
unit TViewer;

type
  TViewer = class(TCustomPanel)
  private
    { Private declarations }
    fScrollBox: TScrollBox;
    fColumns: Integer;
    fImages : TStrings;
    fThumbWidth: Integer;
    fThumbHeight: Integer;
    procedure SetColumns(Value: Integer);
    procedure SetImages(Value: TStrings);
    procedure SetThumbWidth(Value: Integer);
    procedure SetThumbHeight(Value: Integer);
    function GetColumns: Integer;
    function GetThumbWidth: Integer;
    function GetThumbHeight: Integer;
  protected
    { Protected declarations }
    procedure LinesChanged(Sender: TObject);
    procedure UpdateViewer;
    procedure ClearViewer;
  public
    { Public declarations }
    constructor Create(AOwner: TComponent);override;
    destructor Destroy;override;
  published
    { Published declarations }
     property Align;
     property Columns : Integer read GetColumns write SetColumns default 5;
     property Images  : TStrings read fImages write SetImages;
     property ThumbHeight: Integer read GetThumbHeight write SetThumbHeight default 100;
     property ThumbWidth: Integer read GetThumbWidth write SetThumbWidth default 100;
  end;

procedure Register;

implementation

procedure TViewer.ClearViewer;
var
 I: Integer;
begin
 for I := fScrollBox.ComponentCount-1 downTo 0 do
   TPanel(self.Components[I]).Free;
end;

procedure TViewer.UpdateViewer;
var
 I,X,Y,C, D: Integer;
 Thumb: TPanel;
 img: TImage;
 begin
 ClearViewer;
  //update thumnails
  X:= 0;
  Y:= 0;
  C:= 0;
  D:= 5;
  Thumb:= nil;
  for I := 0 to fimages.Count - 1 do
  begin
   if fileExists(fimages[I]) then
   begin
     //create a panel
     Thumb:= TPanel.Create(fScrollBox);
     Thumb.Parent:= fScrollBox;
     Thumb.Caption:= '';
     Thumb.Left:= X + D;
     Thumb.Top:= Y + D;
     Thumb.Width:= fThumbWidth;
     Thumb.Height:= fThumbHeight;

     //create Image
     img:= TImage.Create(Thumb);
     img.Parent:= Thumb;
     img.Align:= alClient;
     img.Stretch:= true;
     img.Picture.LoadFromFile(fImages[I]);
   end;
   X:= X + Thumb.Width + D;
   if C = fColumns then
   begin
     X:= 0;
     Y:= Y + Thumb.Height + D;
   end;
   inc(C);
  end;
end;

procedure TViewer.SetImages(Value: TStrings);
begin
  fImages.Assign(Value);
  // update viewer
  UpdateViewer;
end;

procedure TViewer.SetColumns(Value: Integer);
begin
 if fColumns <> value then
  fColumns:= Value;
end;

procedure TViewer.SetThumbWidth(Value: Integer);
begin
 if fThumbWidth <> Value  then
  fThumbWidth:= Value;
end;
procedure TViewer.SetThumbHeight(Value: Integer);
begin
 if fThumbHeight <> Value  then
  fThumbHeight:= Value;
end;

function TViewer.GetColumns: Integer;
begin
 result:= fColumns;
end;

function TViewer.GetThumbWidth: Integer;
begin
  result:= fThumbWidth;
end;

function TViewer.GetThumbHeight: Integer;
begin
  result:= fThumbHeight;
end;

procedure TViewer.LinesChanged(Sender: TObject);
begin
  //update viewer
  UpdateViewer;
end;

constructor TViewer.Create(AOwner: TComponent);
begin
  inherited Create(aOwner);
  ControlStyle := ControlStyle - [csSetCaption];
  fImages := TStringList.Create;
  TStringList(fImages).OnChange := LinesChanged;
  fThumbHeight:= 100;
  fThumbWidth:= 100;
  fColumns:= 5;
  //add scrollbar
  fScrollBox:= TScrollBox.Create(self);
  fScrollBox.Parent:= self;
  fScrollBox.Align:= alClient;
  fScrollBox.VertScrollBar.Visible:= True;
  fScrollBox.HorzScrollBar.Visible:= True;
end;

destructor TViewer.Destroy;
begin
  fImages.Free;
  inherited;
end;

procedure Register;
begin
  RegisterComponents('Custom', [TViewer]);
end;

end. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T13:02:30.117

您正在改变错误的列表`ClearViewer()`，`Self`不是`fScrollBox`：

```
for I := fScrollBox.ComponentCount-1 downTo 0 do
  TPanel(self.Components[I]).Free; 
```

# python - Python：正好 $n$ [?o] 的正则表达式，至少有一个 [o]

> ID：15317955
> 
> 赞同：2
> 
> 时间：2013-03-10T01:36:47.033
> 
> 标签：python, regex

我正在尝试找到正确的 python 正则表达式来解决这个问题：

给定一个由字符`?`,`_`和组成的字符串`o`，找到一个长度`n`为仅包含`?`and`o`和*至少一个* `o`的子字符串。

这是我想出的，但它似乎不起作用：

```
n = 3
r = re.compile("
  (?=[o?]{"+str(n)+","+str(n)+"})  # first find a block of n characters that are either 'o' or '?'
  [o?]*o[o?]*                      # then check if that block has at least one 'o'
, re.VERBOSE") 
```

我认为上面的问题是前瞻正确地找到了一个潜在的块，但是随后`[o?]*o[o?]*`贪婪地消耗了超出第一部分找到的块限制的字符。我希望先行将后续表达式限制在先行匹配的范围内，但我想这不是它的工作原理。

我最终可能会以另一种方式这样做，因为这对于正则表达式来说可能是最好的方法，但我想知道如何在单个正则表达式中做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T02:01:40.510

你甚至不需要正则表达式。

```
pieces = s.split('_') # pieces are composed of only ? and o
for piece in pieces:
    if 'o' in piece and len(piece) >= n: # piece must have a substring of length n with o in it somewhere
        print "found it"
        break
else:
    print "didn't find it" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T01:54:24.853

您不能使用前瞻来限制输入，因为它所做的只是（显然）对输入进行前瞻。如果在您在前瞻中指定的内容之后还有更多输入，仍然可以找到它。您可以使用前瞻来确保有一个 o （因为这是必要的）并使正则表达式更简单。

```
re.compile("(?=.{0," + str(n - 1) + "}o)[o?]{" + str(n) + "}") 
```

# java - 用于提取第一个单词和计数的java正则表达式操作

> ID：15317958
> 
> 赞同：0
> 
> 时间：2013-03-10T01:37:52.600
> 
> 标签：java, regex

我正在寻找在 Java 中使用的正则表达式操作，它将提取第一个单词，计算行中的数字数量，并将两者连接在一起，用逗号分隔。

因此，例如：

```
"GAMESTATS  1(foul) 4(goals) 2(assists)" 
```

将转换为：

```
"GAMESTATS , 3" 
```

因为第一个单词是“GAMESTATS”，一行上有三个数字（“1”、“4”和“2”）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T01:42:06.040

像这样的东西会起作用：

```
String s = "GAMESTATS 1(foul) 4(goals) 2(assists)";
String output = s.split(" ")[0] + "," + (s.split("\\d+").length - 1); 
```

或者，可能更有效：

```
String output = s.substring(0, s.indexOf(" ")) + "," + (s.split("\\d+").length - 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:42:51.643

```
String[] srt = line.split()
StringBuffer sb = new StringBuffer();
sb.append(srt[0]);
sb.append(",");
int sum =0;
for(int i=1;i<srt.length;i++){
  sum += // You will need to use a pattern like this [0-9]+ to extract the num
} 
```

# c# - 将覆盖的成员更改为异步

> ID：15317961
> 
> 赞同：14
> 
> 时间：2013-03-10T01:38:07.157
> 
> 标签：c#, async-await

我正在覆盖基类库中的方法。但是，在我重写的实现中，我使用了新的 HttpClient，它全部基于异步方法。因此，我必须将我的方法标记为异步，这意味着我需要将方法的返回参数从字符串更改为任务。然而，编译器给出了一个错误：“返回类型必须是'字符串'才能匹配被覆盖的成员......”

```
 public class BaseClass
    {
        public virtual string GetName()
        {
            ...
        }
    }

    public class MyClass : BaseClass
    {
        public override async Task<string> GetName()
        {
            HttpClient httpClient = new HttpClient();
            var response = await httpClient.GetAsync("");
            if (response.IsSuccessStatusCode)
            {
                var responseContent = response.Content;

                return await responseContent.ReadAsStringAsync();
            }

            return null;
        }
    } 
```

当然，显而易见的解决方案是将 BaseClass 中 GetName() 的返回类型更改为 Task<string>，但我无法控制 BaseClass，因为它是一个外部库；

我当前的解决方案是以同步方式使用 HttpClient 类，即按如下方式更改 MyClass：

```
 public class MyClass : BaseClass
    {
        public override string GetName()
        {
            HttpClient httpClient = new HttpClient();
            var response = httpClient.GetAsync("");
            if (response.Result.IsSuccessStatusCode)
            {
                var responseContent = response.Result.Content;

                return responseContent.ReadAsStringAsync()
                                                       .Result;
            }

            return null;
        }
    } 
```

有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-10T01:44:15.587

不幸的是，这里没有一个好的解决方案。没有`override`异步方法的非异步方法。我认为你最好的选择是有一个`async`非覆盖方法并从非异步方法中调用它：

```
public class MyClass : BaseClass 
{
    public override string GetName() 
    {
        return GetNameAsync().Value;
    }

    public async Task<string> GetNameAsync() 
    { 
        ...
    }
} 
```

请注意，这可能会导致问题。如果原始代码不期望任何`async`代码正在执行，则引入此模式可能会打破预期。如果可能的话，我会避免它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-22T12:13:31.710

幸运的`ReadAsStringAsync().Result`是，它没有造成僵局，因为它很可能在`ConfigureAwait(false)`内部。

为了防止死锁，您可以使用以下方法之一：

```
public static T GetResult<T>(Func<Task<T>> func)
{
    var httpContext = HttpContext.Context;

    var proxyTask = Task.Run(() =>
    {
        HttpContext.Context = httpContext;
        return func();
    });

    return proxyTask.Result;
}

// or

public static T GetResult<T>(Func<Task<T>> func)
{
    var syncContext = SynchronizationContext.Current;
    SynchronizationContext.SetSynchronizationContext(null);

    var task = func();

    SynchronizationContext.SetSynchronizationContext(syncContext);

    return task.Result;
} 
```

这样你会打电话

```
public override string GetName()
{
    ...
    return GetResult(() => responseContent.ReadAsStringAsync());
    ...
} 
```

前者通过产生一个新线程而具有性能开销，而后者则受到中`SynchronizationContext`断流的影响，这使得绑定到它的任何上下文在被调用的任务中都不可用，例如`HttpContext.Current`.

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-05-31T13:52:32.910

我也遇到过这个问题，解决方案是使用一个接口，其中“异步”不是方法签名的一部分。

```
public abstract class Base : IInvokable {
    /* Other properties ... */

    public virtual async Task Invoke() {
        /*...*/
    }
}

public interface IInvokable {
    Task Invoke();
}

public class Derived 
{
    public override async Task Invoke() {
        // Your code here
    }
} 
```

# ios - 气球状 UI 元素

> ID：15317964
> 
> 赞同：1
> 
> 时间：2013-03-10T01:38:35.783
> 
> 标签：ios, xamarin.ios

我想在我的应用程序中创建一个按钮，当用户点击它时，它会显示某种带有一些 UI 元素的气球（它可以是按钮、表格、标签等）。类似于 iPad 版 Dropbox 应用程序中的添加按钮 (+)（如下截图）：

![](../Images/fbf698aa413102a509db64f973c2d65e.png)

或者我在另一个应用程序中找到的另一个“按钮”（实际上是一个组合框）：

![](../Images/0aae376038868abf8fbfc4262fab3b5b.png)

用 Monotouch 创建这样的东西有多难？有人知道这个 UI 元素的正确名称是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T01:40:39.650

看起来您要创建的是[" `UIActionSheet`"](https://developer.apple.com/documentation/uikit/uiactionsheet)。

例如

[![谷歌的一个例子](../Images/dbb04c5a3da82a590d6d8a69144b4a63.png)](https://i.stack.imgur.com/iFDKL.png)
[（来源：[techfirm.co.jp](http://labs.techfirm.co.jp/ipad/wp-content/uploads/2010/04/dd2b56b3d488fd88de8d3906c66b5913.png)）]

[您可以从 Apple 中查看和构建；这是 UICatalog 示例](https://developer.apple.com/documentation/uikit/views_and_controls/uikit_catalog_creating_and_customizing_views_and_controls)。

这里[是 Monotouch 的目录](http://github.com/xamarin/monotouch-samples/tree/master/MonoCatalogSample)，应该会告诉你如何在那里做。

# ios - Twitter、FaceBook 和 Composer Sheet 与 Kamcord ViewController - cocos2d ios

> ID：15317981
> 
> 赞同：1
> 
> 时间：2013-03-10T01:42:40.877
> 
> 标签：ios, cocos2d-iphone

我最近在我的游戏中集成了 Kamcord。在此之前，我的 twitter、facebook 和电子邮件按钮运行良好。

我的问题是我已经将所有这些方法都放在了我的默认 rootViewController 中。现在 Kamcord 强迫我用它自己的 rvc 替换我的 rvc`window.rootViewController = [[KCViewController alloc] initWithNibName:nil bundle:nil];`

现在我自己的 rvc 不在场景中，所以我看不到我的 facebook、twitter 和电子邮件共享表。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T02:31:43.483

通过使我的根视图控制器成为 KamcordViewController 的子类来修复它。

# java - 字段宽度和字符串

> ID：15317986
> 
> 赞同：0
> 
> 时间：2013-03-10T01:43:13.733
> 
> 标签：java

我正在尝试打印一些字符串。它看起来像这样：

```
c.println("Item"+"Price"); 
```

我希望有字段宽度，而不是自己打印出空格，因为有更多这样的行，我希望尽可能高效。

我在一个程序调用java中使用java准备编程。任何答案都会有很大帮助，因为我刚刚开始学习 java。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T03:42:24.887

使用 de println 是不可能的，但您可以使用字符串格式功能

```
System.out.println(String.format("%-20s= %s" , "label", "content" )); 
```

参见同一篇文章：[字符串的 Java 输出格式](https://stackoverflow.com/questions/4418308/java-output-formatting-for-strings)

# angularjs - 动态旋转木马角度

> ID：15317988
> 
> 赞同：-3
> 
> 时间：2013-03-10T01:43:55.010
> 
> 标签：angularjs, angularjs-directive, angular-ui

我从后端获取一个数组，我想使用 angular 将它显示为轮播。

*   组件必须是响应式的。
*   每张幻灯片将包含多个项目。

关于如何实现这一点的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-10T17:59:17.850

Jcarousel 解决了我的问题：

```
<div class="jcarousel-skin-default">
    <div id="class1" class="jcarousel">
        <ul>
            <li>
                <div ng-repeat="object in objects" id="ribbon-item">{{object.name}}</div>
            </li>
        </ul>
    </div>
    <a class="btn" href="#" onclick="$('#class1').jcarousel('scroll', '-=1'); return false;"><i class="icon-step-backward"></i></a>
    <a class="btn" href="#" onclick="$('#class1').jcarousel('scroll', '+=1'); return false;"><i class="icon-step-forward"></i></a>
</div> 
```

和一个 JQUERY 调用：

```
 $('#class1').jcarousel(); 
```

解决我的痛苦。

# ruby - 宝石安装错误

> ID：15317989
> 
> 赞同：2
> 
> 时间：2013-03-10T01:44:02.043
> 
> 标签：ruby, linux, gem, tweetstream

不会安装这个 gem，我得到了这个响应。

```
greg@greg-VirtualBox:~$ gem install tweetstream
Building native extensions.  This could take a while...
ERROR:  Error installing tweetstream:
ERROR: Failed to build gem native extension.

/home/greg/.rvm/rubies/ruby-1.9.3-p362/bin/ruby extconf.rb
checking for main() in -lssl... yes
checking for main() in -lcrypto... yes
checking for openssl/ssl.h... yes
checking for openssl/err.h... yes
checking for rb_trap_immediate in ruby.h,rubysig.h... no
checking for rb_thread_blocking_region()... yes
checking for inotify_init() in sys/inotify.h... yes
checking for writev() in sys/uio.h... yes
checking for rb_wait_for_single_fd()... yes
checking for rb_enable_interrupt()... yes
checking for rb_time_new()... yes
checking for sys/event.h... no
checking for epoll_create() in sys/epoll.h... yes
creating Makefile

make
compiling ssl.cpp
make: g++: Command not found
make: *** [ssl.o] Error 127

Gem files will remain installed in /home/greg/.rvm/gems/ruby-1.9.3-       p362/gems/eventmachine-1.0.3 for inspection.
Results logged to /home/greg/.rvm/gems/ruby-1.9.3-p362/gems/eventmachine-      1.0.3/ext/gem_make.out 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-10T06:13:07.903

> make: g++: Command not found 阅读输出应该是你应该学会做的事情。尤其是当事情没有按计划进行时。

取决于你的 Linux 风格。使用包管理器并安装 gcc 包。

**拱Linux**：`pacman -Syu gcc`

**Ubuntu/Debian/Mint**：（`apt-get install gcc`您可能还需要安装`build-essential`）

**Fedora**：`yum install gcc gcc-c++`或`yum groupinstall "Development Tools"`（适用于所有开发工具）

安装编译器后重新运行 gem 安装应该没问题，除非您缺少其他依赖项

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-06-11T14:04:52.580

您需要安装 gcc。运行这一行：

```
sudo apt-get install build-essential 
```

它对我有用（使用ubuntu）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T01:57:14.073

刚刚在 tweetstream 的 github 上看到构建失败。

```
sudo install g++ 
```

固定的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-03T20:35:29.760

对于亚马逊 Linux：`sudo yum install gcc-c++`

# silverlight-4.0 - ListBoxItem 在绑定时不可用

> ID：15317997
> 
> 赞同：0
> 
> 时间：2013-03-10T01:45:09.060
> 
> 标签：silverlight-4.0, silverlight-5.0

我需要按顺序加载 3 个列表框（LB）。它们通过加载`WCF RIA services`，在设置第一个之后，我需要使用第一个元素中的第一个 LB 文本来加载第二个，以查询第二个列表，第三个列表也是如此。这就像一个叮当响的效果：第 1 次更改然后更新 2 和 3，如果第 2 次更改然后更新 3。`ListBoxItem`在已完成的事件中为 null，但稍后可用。`CollectionViewSource`那么在绑定之后我需要等待多长时间才能准备好物品？我什至可以看到 Selection_Changed 事件触发到 -1（加载期间），然后返回 0（加载后），但 ListBoxItem 还没有准备好。我可以使用其他任何事件吗？

第一个 LB 加载，使用第一个元素的文本加载第二个 LB，使用第一个元素的文本加载第三个 LB。我已经检查了这个[链接](https://stackoverflow.com/questions/3674451/how-to-get-the-listboxitem-for-an-item-in-listbox-on-bind-time)，但还没有找到一个`StatusChanged`事件。该`ItemsChanged`事件没有帮助。

活动地图：

```
Load1stLsbAsync
(bind items in Completed event & Load2ndLsbAsync)
(bind items in Completed event & Load3rdLsbasync) 
```