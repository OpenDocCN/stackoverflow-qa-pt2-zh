# StackOverflow 问答 13556000-13556999

# jquery - 在 Google App Engine 平台中从 jQuery 调用 Python

> ID：13556001
> 
> 赞同：1
> 
> 时间：2012-11-25T22:01:34.313
> 
> 标签：jquery, python, google-app-engine

更新：更改为更简单的 python 脚本

我有一个托管在 Google App Engine 中的网站，该网站大部分是静态的。现在我有一个 python 脚本，它将返回服务器中特定文件夹下的文件列表。我需要这个 JavaScript 文件列表。

你好世界.py

```
import webapp2

class MainPage(webapp2.RequestHandler):
    def get(self):
        self.response.headers['Content-Type'] = 'text/plain'
        self.response.write('Hello, webapp2 World!')
app = webapp2.WSGIApplication([('/GetImages', MainPage)], debug=True) 
```

`<script>`我使用 jQuery 在 index.html的标签中调用这个 Python 脚本

```
$.ajax({
    type: "GET",
    url: "/GetImages",
    dataType: "text",
    success: function(data) {
        alert(data);
    }
}); 
```

在我的 app.yaml 中，我定义了这个处理程序以及静态文件的其他处理程序

```
- url: /GetImages
  script: helloworld.app 
```

我已经启动了 Google App Engine 启动器，当我在 localhost:8080/GetImages 中打开我的网站时，我没有看到 hello world 字符串。

我认为问题出在我的 app.yaml 上。如果我在处理程序中添加以下内容，则会收到服务器错误。这是不允许的吗？

```
- url: /static
  static_dir: static 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:48:29.950

解决它。问题是 python 脚本中的一些不正确的缩进。愚蠢的错误:)

# java - 为什么 TextureIO 不接受 newTexture(BufferedImage, Boolean?

> ID：13556007
> 
> 赞同：0
> 
> 时间：2012-11-25T22:02:09.107
> 
> 标签：java, opengl, jogl

我正在尝试创建一个新纹理：

```
BufferedImage image = ImageIO.read(new File("firstImage.jpg"));
Texture t = TextureIO.newTexture(image,true); 
```

但是得到

`newTexture(File, boolean)`类型中的方法`TextureIO`不适用于`arguments (BufferedImage, boolean)`.

我在进口

```
import com.jogamp.opengl.util.texture.TextureIO; 
```

根据Javadoc应该阅读哪个`newTexture(BufferedImage, Boolean)`

那么我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T06:13:26.380

最后我决定把图片直接扔到newTexture中。

我的代码看起来像

`//BufferedImage im = ImageIO.read(new File("image.jpg"));`

`Texture t = TextureIO.newTexture(new File("image.jpg"),true);`

感谢所有看过的人。

JC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-05T17:30:33.693

实际上，该线程有点旧，但我的回答可能对其他人有所帮助。在 JOGL2（与 JOGL1.1 相反）中，您必须使用 AWTTextureIO 来加载 BufferedImages，即`Texture t = AWTTextureIO.newTexture(profile, image,true);`，`profile`您当前的 GLProfile 在哪里。

# javascript - ReferenceError: _ 未定义

> ID：13556010
> 
> 赞同：43
> 
> 时间：2012-11-25T22:02:13.707
> 
> 标签：javascript, jquery

我正在使用基于 jQuery 的 WordPress Twitter 小部件并收到错误“ `ReferenceError: _ is not defined`”。

我不确定如何声明变量“_”。

这是小部件：

```
<script type="text/javascript">
    <!--//--><![CDATA[//><!--

        function twitterCallback2(twitters) {

            var statusHTML = [];
            for (var i=0; i<twitters.length; i++){
                var username = twitters[i].user.screen_name;
                var status = twitters[i].text.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!])/g, function(url) {
                    return '<a href="'+url+'">'+url+'</a>';
                }).replace(/\B@([_a-z0-9]+)/ig, function(reply) {
                    return  reply.charAt(0)+'<a href="http://twitter.com/'+reply.substring(1)+'">'+reply.substring(1)+'</a>';
                });
                statusHTML.push( '\
                <li class="tweet">\
                    <span class="content">'+status+'\
                    <a style="font-size:85%" class="time" href="http://twitter.com/'+username+'/statuses/'+twitters[i].id_str+'">('+relative_time(twitters[i].created_at)+')</a></span>\
                <div class="clearfix"></div></li>' );
          }
          document.getElementById('twitter_update_list_<?php echo $unique_id; ?>').innerHTML = statusHTML.join('');

          var template = '\
            <span class="author">\
                <img src="<%= user.profile_image_url %>">&nbsp;\
                <a class="username" href="http://twitter.com/<%= user.screen_name %>">\
                    <strong><%= user.screen_name %></strong>\
                </a>\
            </span>';
          jQuery( _.template( template, { user: twitters[0].user } )).insertAfter('.bizsteam_twitter ul');
        }

        function relative_time(time_value) {
          var values = time_value.split( " " );
          time_value = values[1] + " " + values[2] + ", " + values[5] + " " + values[3];
          var parsed_date = Date.parse(time_value);
          var relative_to = (arguments.length > 1) ? arguments[1] : new Date();
          var delta = parseInt((relative_to.getTime() - parsed_date) / 1000);
          delta = delta + (relative_to.getTimezoneOffset() * 60);

          if (delta < 60) {
            return 'less than a minute ago';
          } else if(delta < 120) {
            return 'about a minute ago';
          } else if(delta < (60*60)) {
            return (parseInt(delta / 60)).toString() + ' minutes ago';
          } else if(delta < (120*60)) {
            return 'about an hour ago';
          } else if(delta < (24*60*60)) {
            return 'about ' + (parseInt(delta / 3600)).toString() + ' hours ago';
          } else if(delta < (48*60*60)) {
            return '1 day ago';
          } else {
            return (parseInt(delta / 86400)).toString() + ' days ago';
          }
        }
    //-->!]]>

    </script>
    <?php
        if($exclude_replies != ''){ $exclude_replies_str = '&amp;exclude_replies='.$exclude_replies; } else { $exclude_replies_str = ''; }
    ?>
    <script type="text/javascript" src="http://api.twitter.com/1/statuses/user_timeline/<?php echo $twitter_username; ?>.json?callback=twitterCallback2&amp;count=<?php echo $twitter_count; ?>&amp;include_rts=t<?php echo $exclude_replies_str; ?>"></script> 
```

Firebug 指出有错误的代码行是：

```
jQuery( _.template( template, { user: twitters[0].user } )).insertAfter('.bizsteam_twitter ul'); 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-11-25T22:04:36.867

您的小部件具有 Underscore.js/LoDash.js 作为依赖项。

你可以在这里得到它们：[下划线](http://underscorejs.org/)，[lodash](http://lodash.com/)

尝试将此添加到您的代码中，以便您查看它是否有效：

```
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-28T18:33:06.617

我在网站的 wp-admin 部分遇到了同样的问题。我将下划线脚本 cdn 排入队列，它解决了问题。

```
function kk_admin_scripts() {
    wp_enqueue_script('underscore', '//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js' );
}
add_action( 'admin_enqueue_scripts', 'kk_admin_scripts' ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-18T18:28:43.647

您可以通过凉亭安装它：

```
Node.js npm install underscore
Meteor.js meteor add underscore
Require.js require(["underscore"], ...
Bower bower install underscore
Component component install jashkenas/underscore 
```

这是官方页面的链接[http://underscorejs.org/](http://underscorejs.org/)

# c# - XNA C# 相机和型号

> ID：13556012
> 
> 赞同：1
> 
> 时间：2012-11-25T22:02:53.447
> 
> 标签：c#, xna, camera, 3d-model

我创建了 3 个类：一个用于游戏，一个用于模型，一个用于相机。我希望我的相机跟随我的模型移动，但我的模型不再出现。有谁知道我在相机和/或游戏课上做错了什么？

* * *

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace test1
{
/// <summary>
/// This is the main type for your game
/// </summary>
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;

    //Visual components
    Ship ship = new Ship();
    Cam cam1 = new Cam();        

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
    }      

    protected override void LoadContent()
    {
        ship.Model = Content.Load<Model>("Models/p1_wedge");
        ship.Transforms = cam1.SetupEffectDefaults(ship.Model);            
    }

    protected override void Update(GameTime gameTime)
    {

        // Allows the game to exit
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed ||
            Keyboard.GetState().IsKeyDown(Keys.Escape))
            this.Exit();

        // Get some input.
        UpdateInput();

        // Add velocity to the current position.
        ship.Position += ship.Velocity;
        cam1.cameraPosition += cam1.cameraTarget;
        // Bleed off velocity over time.
        ship.Velocity *= 0.95f;
        cam1.cameraTarget *= 0.95f;

        base.Update(gameTime);
    }

    protected void UpdateInput()
    {
        // Get the game pad state.
        GamePadState currentState = GamePad.GetState(PlayerIndex.One);
        KeyboardState currentKeyState = Keyboard.GetState();

            ship.Update(currentState);
            cam1.Update(currentState);

            // In case you get lost, press A to warp back to the center.
            if (currentState.Buttons.A == ButtonState.Pressed || currentKeyState.IsKeyDown(Keys.Enter))
            {
                ship.Position = Vector3.Zero;
                ship.Velocity = Vector3.Zero;
                ship.Rotation = 0.0f;                  
            }            
    }

    protected override void Draw(GameTime gameTime)
    {
        graphics.GraphicsDevice.Clear(Color.CornflowerBlue);

        Matrix shipTransformMatrix = ship.RotationMatrix
                * Matrix.CreateTranslation(ship.Position);
        DrawModel(ship.Model, shipTransformMatrix, ship.Transforms);
        base.Draw(gameTime);
    }

    public static void DrawModel(Model model, Matrix modelTransform,
Matrix[] absoluteBoneTransforms)
    {
        //Draw the model, a model can have multiple meshes, so loop
        foreach (ModelMesh mesh in model.Meshes)
        {
            //This is where the mesh orientation is set
            foreach (BasicEffect effect in mesh.Effects)
            {
                effect.World =
                    absoluteBoneTransforms[mesh.ParentBone.Index] *
                    modelTransform;
            }
            //Draw the mesh, will use the effects set above.
            mesh.Draw();
        }
    }
}
} 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;

namespace test1
{
class Ship
{
    public Model Model;
    public Matrix[] Transforms;

    //Position of the model in world space
    public Vector3 Position = Vector3.Zero;

    //Velocity of the model, applied each frame to the model's position
    public Vector3 Velocity = Vector3.Zero;
    private const float VelocityScale = 5.0f;

    public Matrix RotationMatrix =
 Matrix.CreateRotationX(MathHelper.PiOver2);

    private float rotation;

    public float Rotation
    {
        get { return rotation; }
        set
        {
            float newVal = value;
            while (newVal >= MathHelper.TwoPi)
            {
                newVal -= MathHelper.TwoPi;
            }
            while (newVal < 0)
            {
                newVal += MathHelper.TwoPi;
            }

            if (rotation != value)
            {
                rotation = value;
                RotationMatrix =
                    Matrix.CreateRotationX(MathHelper.PiOver2) *
                    Matrix.CreateRotationZ(rotation);
            }

        }
    }

    public void Update(GamePadState controllerState)
    {

        KeyboardState currentKeyState = Keyboard.GetState();
        if (currentKeyState.IsKeyDown(Keys.A))
            Rotation += 0.10f;
        else
        // Rotate the model using the left thumbstick, and scale it down.
        Rotation -= controllerState.ThumbSticks.Left.X * 0.10f;

        if (currentKeyState.IsKeyDown(Keys.D))
            Rotation -= 0.10f;

        if (currentKeyState.IsKeyDown(Keys.W))
            Velocity += RotationMatrix.Forward * VelocityScale;
        else
        // Finally, add this vector to our velocity.
        Velocity += RotationMatrix.Forward * VelocityScale *
         controllerState.Triggers.Right;
    }  

}
} 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;

namespace test1
{
class Cam : Microsoft.Xna.Framework.Game
{
    public Vector3 cameraPosition = new Vector3(0.0f, 2000.0f, 25000.0f);
    public Vector3 cameraTarget = Vector3.Zero;

   Matrix projectionMatrix;
    Matrix viewMatrix;

    protected override void Initialize(){

            projectionMatrix = Matrix.CreatePerspectiveFieldOfView(
       MathHelper.ToRadians(45.0f),
       GraphicsDevice.DisplayMode.AspectRatio,
       20000.0f, 30000.0f);

        viewMatrix = Matrix.CreateLookAt(cameraPosition,
            cameraTarget, Vector3.Up);

        base.Initialize();            
    }

    public Matrix[] SetupEffectDefaults(Model myModel)
    {
        Matrix[] absoluteTransforms = new Matrix[myModel.Bones.Count];
        myModel.CopyAbsoluteBoneTransformsTo(absoluteTransforms);

        foreach (ModelMesh mesh in myModel.Meshes)
        {
            foreach (BasicEffect effect in mesh.Effects)
            {
                effect.EnableDefaultLighting();
                effect.Projection = projectionMatrix;
                effect.View = viewMatrix;
            }
        }
        return absoluteTransforms;
    }

    private const float VelocityScale = 5.0f;

    public Matrix RotationMatrix =
 Matrix.CreateRotationX(MathHelper.PiOver2);

    private float rotation;

    public float Rotation
    {
        get { return rotation; }
        set
        {
            float newVal = value;
            while (newVal >= MathHelper.TwoPi)
            {
                newVal -= MathHelper.TwoPi;
            }
            while (newVal < 0)
            {
                newVal += MathHelper.TwoPi;
            }

            if (rotation != value)
            {
                rotation = value;
                RotationMatrix =
                    Matrix.CreateRotationX(MathHelper.PiOver2) *
                    Matrix.CreateRotationZ(rotation);
            }
        }
    }

    public void Update(GamePadState controllerState)
    {
        KeyboardState currentKeyState = Keyboard.GetState();
        if (currentKeyState.IsKeyDown(Keys.A))
            Rotation += 0.10f;
        else
            // Rotate the model using the left thumbstick, and scale it down.
            Rotation -= controllerState.ThumbSticks.Left.X * 0.10f;

        if (currentKeyState.IsKeyDown(Keys.D))
            Rotation -= 0.10f;

        if (currentKeyState.IsKeyDown(Keys.W))
            cameraTarget += RotationMatrix.Forward * VelocityScale;
        else
            // Finally, add this vector to our velocity.
            cameraTarget += RotationMatrix.Forward * VelocityScale *
             controllerState.Triggers.Right;
    }
}
} 
```

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:18:40.467

首先，你应该学习如何组织你的代码，你为每个对象创建了类，但你仍然在每个对象和游戏中进行一些处理，这非常混乱！

为什么你的相机不工作的简短答案只是因为你没有使用它！

您应该遵循有关在 XNA 中创建相机的适当教程，例如[这个](http://gamecamp.no/blogs/tutorials/archive/2008/01/29/creating-a-simple-xna-camera-class.aspx)，但是通过简要查看您的代码，在您的代码中添加类似`cam1.SetupEffectDefaults(model);`的内容`DrawModel`可能足以让您的`ViewMatrix`应用`ProjectionMatrix`。在初始化阶段调用它不会有太大作用，因为这些矩阵在游戏过程中会更新。

# hibernate - 哪个版本的 slf4j-log4j12 与 hibernate 3.6.0.Final 一起使用（具有 slf4j-api 1.5.8 的内部依赖性）

> ID：13556020
> 
> 赞同：0
> 
> 时间：2012-11-25T22:03:50.703
> 
> 标签：hibernate, maven-2, struts2

我正在使用休眠核心 3.6.0.Final 和休眠注释 3.5.6-Final。

Hibernate 具有 slf4j-api 1.5.8 的依赖项，因此它会自动添加到我的 maven 项目依赖项中。

但是当我尝试运行该项目时，出现以下错误：

```
java.lang.IllegalAccessError: tried to access field org.slf4j.impl.StaticLoggerBinder.SINGLETON from class org.slf4j.LoggerFactory 
```

谷歌搜索说这是由于 slf4j 和 slf4j-log4j12 的版本不同，主要是使用 hibernate 3.3

我补充说：

```
 <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>1.5.8</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-simple</artifactId>
            <version>1.5.8</version>
        </dependency> 
```

或者，两个和一个一个，但没有一个选项可以解决问题。我仍然得到`IllegalAccessError`. 如果有人能指出我做错了什么，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T07:19:10.840

我的 pom.xml 中有以下 log4j 和 slf4j 的依赖项。它对我来说很好，希望这对你也有帮助

```
 <properties>
      <slf4j.version>1.6.4</slf4j.version>
      <log4j.version>1.2.16</log4j.version>
    </properties>

    <dependencies>
      <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>${slf4j.version}</version>
      </dependency>

      <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${slf4j.version}</version>
      </dependency>

      <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>${log4j.version}</version>
      </dependency>

    </dependencies> 
```

# bash - 从目录运行 bash 命令

> ID：13556026
> 
> 赞同：0
> 
> 时间：2012-11-25T22:04:13.030
> 
> 标签：bash, drupal, drush

我遇到了需要在创建的目录中自动运行命令（确切地说是 drush 配置文件）的问题。我在将其作为参数运行的脚本本身中找不到太多建议，而我的上级指示我的逻辑似乎表明这是最好的方法。

这是 bash 脚本的作用：

*   它为 Drupal 安装创建目录结构和一些 Apache2 文件
*   它创建一个基本的 Drush 配置文件，然后由实用程序用于
*   通过在包含此配置文件的目录中运行别名“standardprofile”来自动安装 Drupal 和模块

我用来从 Bash 运行脚本的实际命令（下面的完整脚本）是

```
cd /var/www/$DOMAINNAME-dev.$URL
eval "standardprofile" 
```

上面的行不运行脚本（或超过第一行的任何内容，然后 bash 脚本恢复）是否有更好的方法来指示 bash 脚本从指定目录运行命令，然后在任何其他实用程序后恢复正在前台运行完成？

```
#!/bin/bash
# Creates the proper staging and development environment for a site

# Init
URL=example.com         #URL used in creating directories
OMIT_STAGING="n"        #Set to true if omitting staging
DOMAINNAME=""

###
# FUNCTIONS
###
function generate_empty_dirs {
    mkdir /var/www/$1-staging.$URL
    mkdir /var/www/$1-dev.$URL
    mkdir /var/www/$1-staging.$URL/logs
    mkdir /var/www/$1-staging.$URL/public_html
    mkdir /var/www/$1-dev.$URL/logs
    mkdir /var/www/$1-dev.$URL/public_html
}

function generate_drupal_staging_apacheconf {
    echo "<VirtualHost *:80>
            ServerAdmin webmaster@example.com
            ServerName $1-staging.$URL

            DocumentRoot /var/www/$1-staging.$URL/public_html
            <Directory /var/www/$1-staging.$URL/public_html>
                Options -MultiViews +ExecCGI
                Order allow,deny
                Allow from all

                RewriteEngine On
                RewriteBase /
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule ^(.*)$ index.php?q=\$1 [L,QSA]

            </Directory>

            LogLevel warn
            ErrorLog /var/www/$1-staging.$URL/logs/error.log
            CustomLog /var/www/$1-staging.$URL/logs/access.log combined
            # enable PHP error logging
            php_flag  log_errors on
            php_value error_log  /var/www/$1-staging.$URL/logs/php_errors.log
            # Possible LogLevel values include: debug, info, notice, warn, error, crit,
            # alert, emerg.

    </VirtualHost>" > /etc/apache2/sites-available/$1-staging.$URL
}

function generate_drupal_dev_apacheconf {
    echo "<VirtualHost *:80>
            ServerAdmin webmaster@example.com
            ServerName $1-dev.$URL

            DocumentRoot /var/www/$1-dev.$URL/public_html
            <Directory /var/www/$1-dev.$URL/public_html>
                Options -MultiViews +ExecCGI
                Order allow,deny
                Allow from all

                RewriteEngine On
                RewriteBase /
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule ^(.*)$ index.php?q=\$1 [L,QSA]

            </Directory>

            LogLevel warn
            ErrorLog /var/www/$1-dev.$URL/logs/error.log
            CustomLog /var/www/$1-dev.$URL/logs/access.log combined
            # enable PHP error logging
            php_flag  log_errors on
            php_value error_log  /var/www/$1-dev.$URL/logs/php_errors.log
            # Possible LogLevel values include: debug, info, notice, warn, error, crit,
            # alert, emerg.

    </VirtualHost>" > /etc/apache2/sites-available/$1-dev.$URL
}

function generate_wordpress_staging_apacheconf {
    echo "<VirtualHost *:80>
            ServerAdmin webmaster@example.com
            ServerName $1-staging.$URL

            DocumentRoot /var/www/$1-staging.$URL/public_html
            <Directory /var/www/$1-staging.$URL/public_html>
                Options -MultiViews +ExecCGI
                Order allow,deny
                Allow from all

                RewriteEngine On
                RewriteBase /
                RewriteRule ^index\.php$ - [L]
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule . /index.php [L]

            </Directory>

            LogLevel warn
            ErrorLog /var/www/$1-staging.$URL/logs/error.log
            CustomLog /var/www/$1-staging.$URL/logs/access.log combined
            # enable PHP error logging
            php_flag  log_errors on
            php_value error_log  /var/www/$1-staging.$URL/logs/php_errors.log
            # Possible LogLevel values include: debug, info, notice, warn, error, crit,
            # alert, emerg.

    </VirtualHost>" > /etc/apache2/sites-available/$1-staging.$URL
}

function generate_wordpress_dev_apacheconf {
    echo "<VirtualHost *:80>
            ServerAdmin webmaster@example.com
            ServerName $1-dev.$URL

            DocumentRoot /var/www/$1-dev.$URL/public_html
            <Directory /var/www/$1-dev.$URL/public_html>
                Options -MultiViews +ExecCGI
                Order allow,deny
                Allow from all

                RewriteEngine On
                RewriteBase /
                RewriteRule ^index\.php$ - [L]
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule . /index.php [L]

            </Directory>

            LogLevel warn
            ErrorLog /var/www/$1-dev.$URL/logs/error.log
            CustomLog /var/www/$1-dev.$URL/logs/access.log combined
            # enable PHP error logging
            php_flag  log_errors on
            php_value error_log  /var/www/$1-dev.$URL/logs/php_errors.log
            # Possible LogLevel values include: debug, info, notice, warn, error, crit,
            # alert, emerg.

    </VirtualHost>" > /etc/apache2/sites-available/$1-dev.$URL
}

function generate_drupal_drush_dev_profile {
    # Dev
    echo " <?php
    \$db_engine = 'mysql';
    \$db_name = '$1_db';
    \$db_user = '$1_user';
    \$db_pw = '1password';
    \$db_su = 'root';
    \$db_su_pw = '';
    \$site_name = '$1';
    \$account_name = 'admin';
    \$account_pw = 'example';
    \$account_mail = 'example@example.com';
    \$site_mail = \$account_mail;" > /var/www/$1-dev.$URL/installsettings.php
}

function generate_drupal_drush_staging_profile {
    #Staging
    echo " <?php
    \$db_engine = 'mysql';
    \$db_name = '$1_db';
    \$db_user = '$1_user';
    \$db_pw = '1password';
    \$db_su = 'root';
    \$db_su_pw = '';
    \$site_name = '$1';
    \$account_name = 'admin';
    \$account_pw = 'example';
    \$account_mail = 'example@example.com';
    \$site_mail = \$account_mail;" > /var/www/$1-staging.$URL/installsettings.php
}

function alter_group_owner {
    chown -R www-data /var/www/$1-staging.$URL
    chgrp -R www-data /var/www/$1-staging.$URL
    chown -R www-data /var/www/$1-dev.$URL
    chgrp -R www-data /var/www/$1-dev.$URL
    chown -R www-data /etc/apache2/sites-available/$1-staging.$URL
    chgrp -R www-data /etc/apache2/sites-available/$1-staging.$URL
    chown -R www-data /etc/apache2/sites-available/$1-dev.$URL
    chgrp -R www-data /etc/apache2/sites-available/$1-dev.$URL
}

###
# BEGIN MAIN LOGIC
###

# Checks to see if user is Root or is using Sudo, otherwise exit

if [ $(id -u) != 0 ]
then
    echo "You must have elevation to run this script."
    exit 1
fi

# Prompts for name of site
if [ -z "$1" ]
then
    read -p "Domain for the new site: " DOMAINNAME

    if [ ! -z $DOMAINNAME ]
    then
        echo "Generating the empty directories now..."
        generate_empty_dirs $DOMAINNAME
    else
        echo "You must provide a valid domain name"
        exit 1
    fi
else
    generate_empty_dirs $1
    DOMAINNAME=$1
fi

# Determine the kind of site being generated
read -p "Is this a (D)rupal or a (W)ordPress site? " SITETYPE
read -p "Do you need both the dev and staging sites? [Y/N] (case sensitive): " NEEDDIRS

    if [ -n "$SITETYPE" ]
    then
        if [ "$SITETYPE" == "D" ]
        then
            generate_drupal_dev_apacheconf $DOMAINNAME
            generate_drupal_drush_dev_profile $DOMAINNAME

            rm /var/www/$DOMAINNAME-dev.$URL/public_html
            rm /var/www/$DOMAINNAME-dev.$URL/logs

            cd /var/www/$DOMAINNAME-dev.$URL
            eval "standardprofile"

            if [ "$NEEDDIRS" == "Y" ] 
            then
                generate_drupal_staging_apacheconf $DOMAINNAME
                generate_drupal_drush_staging_profile $DOMAINNAME
                cd /var/www/$DOMAINNAME-staging.$URL
                eval "standardprofile"
                OMIT_STAGING="n"
            else
                OMIT_STAGING="y"
            fi
        elif [ "$SITETYPE" == "W" ]
        then
            generate_wordpress_dev_apacheconf $DOMAINNAME
            if [ "$NEEDDIRS" == "Y" ] 
            then
                generate_wordpress_staging_apacheconf $DOMAINNAME
                OMIT_STAGING="n"
            else
                OMIT_STAGING="y"
            fi
        else 
            echo "Invalid option provided"
            exit 1
        fi
    else
        echo "No option provided"
        exit 1 
    fi

alter_group_owner $DOMAINNAME

# Load the new confs into Apache

if [ "$OMIT_STAGING" == "y" ]
then
    a2ensite $DOMAINNAME-dev.$URL
    rm -rf /var/www/$DOMAINNAME-staging.$URL
else
    a2ensite $DOMAINNAME-dev.$URL
    a2ensite $DOMAINNAME-staging.$URL
fi

# Reload apache
service apache2 reload

# All done

echo "Sites created at domains:"
if [ "$OMIT_STAGING" == "y" ]
then
    echo $DOMAINNAME-dev.$URL
else
    echo $DOMAINNAME-dev.$URL
    echo $DOMAINNAME-staging.$URL
fi

exit
#End of script 
```

还有 drush 脚本

```
#!/usr/bin/env drush
$a = drush_get_arguments();
$current_directory = getcwd();
$profiles = substr($a[1], 0, strlen($a[1])-15) . 'standard.make';
if(file_exists($current_directory . '/installsettings.php')) {
  require_once($current_directory . '/installsettings.php');
}
drush_print("Time to prepare our site install...");

if(!file_exists('logs')) {
  drush_op_system('mkdir logs');
}

if(!file_exists('public_html')) {
  $prev = drush_get_context('DRUSH_AFFIRMATIVE');
  drush_set_context('DRUSH_AFFIRMATIVE', TRUE);
  drush_invoke('make', array($profiles, 'public_html'));
  drush_op_system('cp public_html/sites/all/modules/services/servers/rest_server/lib/spyc/spyc.php public_html/sites/all/modules/services/servers/rest_server/lib/spyc.php');
  #drush_shell_exec('cd public_html');
  #shell_exec('cd public_html');
  chdir('public_html');
  drush_invoke_process("@self","site-install",null,array(
    'db-url' => $db_engine . "://" . $db_user . ":" . $db_pw . "@localhost/" . $db_name,
    'account-name' => $account_name,
    'account-pass' => $account_pw,
    'account-email' => $account_mail,
    'db-su' => $db_su,
    'db-su-pw' => $db_su_pw,
    'site-mail' => $site_mail,
    'site-name' => $site_name,
    'clean-url' => FALSE,
  ));
    drush_invoke_process("@self","pm-enable",
        array('ctools', 'views', 'views_ui', 'features', 'strongarm', 'fe_block',
            'entity', 'token', 'module_filter', 'pathauto', 'devel', 'simplehtmldom',
            'services', 'rest_server', 'entity_token', 'date', 'date_api', 'date_tools',
            'date_views', 'date_popup','rules', 'rules_admin', 'views_slideshow',
            'views_slideshow_cycle', 'strongarm', 'diff', 'auto_nodetitle', 'libraries',
            'realname', 'views_php'),
        array('root' => $current_directory . '/public_html'));
  drush_set_context('DRUSH_AFFIRMATIVE', $prev);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:16:04.043

*是否有更好的方法来指示 bash 脚本从指定目录运行命令，然后在前台运行的任何其他实用程序完成后恢复？*

当然：

```
( cd $dir && cmd ) 
```

将从指定目录运行 cmd。由于这两个命令在子shell 中运行，因此当子shell 完成时，脚本将在其当前目录中恢复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:14:43.470

这应该有效：

```
cd /var/www/$DOMAINNAME-dev.$URL
/usr/bin/env drush "standardprofile" 
```

# google-app-engine - 如何生成客户端库

> ID：13556028
> 
> 赞同：3
> 
> 时间：2012-11-25T22:04:14.887
> 
> 标签：google-app-engine, google-cloud-endpoints, google-plugin-eclipse

我正在尝试为我现有的 Web 应用程序生成 java 客户端库，但每次选择“生成云端点客户端库”时，eclipse 都会显示进度对话框并冻结。

是否有可用于生成客户端库的命令行工具（类似于 bin/endpoints.sh）？

提前致谢。

**编辑** 谢谢丹，我设法通过使用此命令生成客户端库：

`$SDK/endpoints.sh get-client-lib com.test.MyEndpoint`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T19:31:38.077

通过查看 Eclipse 错误日志，您应该能够至少找到更多关于生成库时的错误的信息。但是，我猜该错误是通用的，例如`503`生成库的服务中的错误。

这些类型错误的最常见原因是您在实体类中使用了不兼容的类型。在这种情况下，使用命令行工具无济于事。

但是，在某些情况下，命令行工具在 GPE 失败时也成功了。要在没有 GPE 的情况下生成库，请从应用程序的根目录运行以下命令：

```
$SDK/bin/endpoints.sh get-java-client-lib helloworld.endpoint.HelloWorldEndpoint 
```

替换`helloworld.endpoint.HelloWorldEndpoint`为 Endpoint 类的空格分隔名称。

# dns - 如何获得域名国家？

> ID：13556029
> 
> 赞同：-2
> 
> 时间：2012-11-25T22:04:26.833
> 
> 标签：dns, country

我无法理解某些网站如何为每个网站使用不同的域。简而言之，例如 myspace 有 uk.myspace.com、fr.myspace.com 等怎么说？

他们是否将主文件放在上述根目录中，然后为每个国家/地区提供单独的子域，或者他们在国家/地区检测方面是否发生了一些奇怪的事情？

我在网上什么地方都找不到？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:09:16.547

不太可能涉及单个服务器，因此谈论“根目录之上的文件”是没有意义的。您将谈论某种相当先进的路由基础设施，它在许多不同的位置隐藏了数十个不同的服务器。路由逻辑是决定哪组机器负责处理给定请求的部分。

转发部分确实是“奇怪的国家检测”，从某种意义上说，某些机器负责执行 IP 查找并将用户重定向到适当的（可能是地理上更接近的）主机。这可能是出于性能原因，也可能是出于内容本地化和 SEO 原因（例如，默认语言）。

# php - call_user_func_array vs ReflectionMethod

> ID：13556031
> 
> 赞同：1
> 
> 时间：2012-11-25T22:04:43.027
> 
> 标签：php

我想知道使用上述函数调用类方法以使用数组动态填充方法调用时的最佳实践是什么！

我有什么优点和缺点？我的意思是，在某些情况下，RefelectionMethod + invokeArgs 选项似乎比 call_user_funcion 快 40%……但我错过了什么吗？

谢谢。

根据要求，我将在我需要通过裁判的情况下添加一个小基准......我知道这是一个非常具体的案例，这与上述问题没有严格的关系！

```
class foo { public function bar(&$a, &$b, &$c) { /* */ } }
$t1 = microtime(true);
$arr = array(1,2,3);
$foo = new foo;
$rfl = new ReflectionMethod('foo', 'bar');
for ($i=0; $i < 10000; ++$i)
{   
    $rfl->invokeArgs($foo, $arr);   
}

$t2 = microtime(true);
echo sprintf("\nElapsed reflectionmethod  : %f", $t2 - $t1);
$t1 = microtime(true);
$arr = array(1,2,3);
$foo = new foo;

for ($i=0; $i < 10000; ++$i)
{
    foreach( $arr as $k => $v ) $ref[$k] = &$arr[$k];       
    call_user_func_array( array($foo, 'bar'), $arr);
}

$t2 = microtime(true);
echo sprintf("\nElapsed calluserfuncarray : %f", $t2 - $t1); 
```

结果

```
Elapsed reflectionmethod  : 0.025099
Elapsed calluserfuncarray : 0.051189 
```

**我真的很想知道什么时候使用一个比另一个更好，为什么！虽然它与速度没有严格的关系！**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T22:32:40.617

不知道你从哪里得到你的测试结果，但`RefelectionMethod + invokeArgs option is up to 40% faster than the call_user_funcion`似乎牵强附会它只能通过单实例多次调用才有可能

简单基准

```
set_time_limit(0);
echo "<pre>";
class Foo {

    public function bar($arg1, $arg2) {
    }
}

$globalRefection = new ReflectionMethod('Foo', 'bar');
$globalFoo = new Foo();

// Using call_user_func_array
function m1($args) {
    $foo = new Foo();
    call_user_func_array(array($foo,"bar"), $args);
}

// Using ReflectionMethod:invoke
function m2($args) {
    $foo = new ReflectionMethod('Foo', 'bar');
    $foo->invoke(new Foo(), $args[0], $args[1]);
}

// Using ReflectionMethod:invokeArgs
function m3($args) {
    $foo = new ReflectionMethod('Foo', 'bar');
    $foo->invokeArgs(new Foo(), $args);
}

// Using Global Reflection
function m4($args) {
    global $globalRefection;
    $globalRefection->invokeArgs(new Foo(), $args);
}

// Using Global Reflection + Glbal foo
function m5($args) {
    global $globalRefection, $globalFoo;
    $globalRefection->invokeArgs($globalFoo, $args);
}

$result = array('m1' => 0,'m2' => 0,'m3' => 0,'m4' => 0,'m5' => 0);
$args = array("arg1","arg2");

for($i = 0; $i < 10000; ++ $i) {
    foreach ( array_keys($result) as $key ) {
        $alpha = microtime(true);
        $key($args);
        $result[$key] += microtime(true) - $alpha;
    }
}

echo '<pre>';
echo "Single Run\n";
print_r($result);
echo '</pre>'; 
```

输出

```
Single Run
Array
(
    [m1] => 0.018314599990845   <----- call_user_func_array 
    [m2] => 0.024132013320923   <----- ReflectionMethod:invoke
    [m3] => 0.021934270858765   <----- ReflectionMethod:invokeArgs
    [m4] => 0.012894868850708   <----- Global Relection
    [m5] => 0.01132345199585    <----- Global Reflection + Global Foo
) 
```

[看真人秀](http://codepad.viper-7.com/sBaFAO)

# spring - 将请求范围的 bean 自动装配到应用程序范围的 bean 中

> ID：13556037
> 
> 赞同：10
> 
> 时间：2012-11-25T22:05:10.253
> 
> 标签：spring, scopes

是否可以将请求范围的 bean 自动装配到应用程序范围的 bean 中。IE

我有一个类 RequestScopedBean：

```
class RequestScopedBean {
   ....
   ....
   ....
} 
```

和一个类应用程序范围的 bean，其中请求范围的 bean 是自动装配的。

```
class ApplicationScopedBean {
   @Autowire
   private RequestScopedBean requestScopedBean;
   ....
   ....
   ....
} 
```

spring-config xml如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="
              http://www.springframework.org/schema/beans  http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/util  http://www.springframework.org/schema/util/spring-util-3.0.xsd
">
<bean id="applicationScopedBeans" class="ApplicationScopedBean" />
<bean id="requestScopedBean" class="RequestScopedBean" scope="request">  
</bean>
</beans> 
```

当我尝试运行此应用程序时，applicationScopedBean 的 bean 创建失败并出现以下错误：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'ApplicationScopedBean': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not       autowire field: private RequestScopedBean requestScopedBean; nested exception is java.lang.IllegalStateException: No Scope registered for scope 'request'
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:288)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1074)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:192)
    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1075)
    at com.amazon.coral.reflect.instantiate.SpringInstantiatorFactory$1.newInstance(SpringInstantiatorFactory.java:168)
    ... 19 more 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-25T22:14:04.660

您还必须将您的标记`requestScopedBean`为范围代理，这样 Spring 将为 requestScopedBean 注入代理并在后台适当地管理范围。

```
<bean id="requestScopedBean" class="RequestScopedBean" scope="request">  
    <aop:scoped-proxy/>
</bean> 
```

更多[在这里](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-factory-scopes-other-injection)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-25T22:10:58.127

上面的异常表明您没有正确配置 Spring 以提供请求范围的 bean。

[您需要按照此处](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-scopes-other)文档中的说明将其添加到您的 web.xml 中：

```
<listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
  </listener> 
```

但是，您的问题不仅仅是配置。您正在尝试将请求范围的 bean 注入单例范围的 bean。Spring 在 DI 容器启动时解决依赖关系并实例化单例。这意味着 ApplicationScopedBean 只会被创建一次（此时不会有任何请求在运行，因此自动装配很可能会失败）。

如果您使用的是原型作用域 bean 而不是请求作用域，则必须考虑一种方法，每次使用时为单例作用域 bean 提供一个新实例。[Spring 文档的方法注入](https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-factory-method-injection)章节中描述了这种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-15T13:07:02.250

@Airwavezx 等价的注解如下：

```
@Scope( value = SCOPE_REQUEST, proxyMode = ScopedProxyMode.TARGET_CLASS ) 
```

# javascript - JavaScript 原型和封装

> ID：13556040
> 
> 赞同：1
> 
> 时间：2012-11-25T22:05:19.940
> 
> 标签：javascript

抱歉，我可能在这里是个菜鸟……但是：

我有以下 javascript 对象：

```
jeeni.TextField = (function(){

    var tagId;

    privateMethod = function(){
        console.log("IN: privateMethod");
    }

    publicMethod = function(){
        console.log("IN: publicMethod: " + this.tagId);
    }

    jeeni.TextField = function(id){
        console.log("Constructor");
        this.tagId = id;
    }

    jeeni.TextField.prototype = {
            constructor: jeeni.TextField,
            foo: publicMethod
    };

    return jeeni.TextField;
 }()); 
```

现在，当我运行以下代码时，我得到了相应的结果：

```
var textField1 = new jeeni.TextField(21); // Outputs: Constructor
textField1.foo();           // Outputs: IN: publicMethod: 21
console.log(textField1.tagId); // Outputs: 21
console.log(textField1.privateMethod); // Outputs: undefined 
```

所以我的问题是为什么是`privateMethod`隐藏的而`tagId`不是隐藏的。我希望它们都是私有范围。

请帮助一个菜鸟。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:29:43.803

您混合了两种创建模块的方法。问题是私人`var tagId`不是一回事`this.tagId`

让我从一个有效的版本开始，它与我通常使用 AMD 模块所做的类似：

```
jeeni.TextField = (function(){
//here you can put a variable common to all instances
  return {
  init:function(id){
    var tagId = id;
    console.log("Constructor");

    function privateMethod(){
        console.log("IN: privateMethod");
    }

    function publicMethod(){
        console.log("IN: publicMethod: " + tagId);
    }

    return {
       foo:publicMethod
    };
  }
})();

var textField1 = jeeni.TextField.init(21); //creates instance
textField1.foo();           // Outputs: IN: publicMethod: 21
console.log(textField1.tagId); // Outputs: undefined
console.log(textField1.privateMethod); // Outputs: undefined 
```

这有一个缺点：对于每个对象实例，函数都被复制到内存中。这是使用原型的唯一原因。但是如果你想要私有变量，你可能会浪费一些内存。

在您的代码中，如果您替换`this.tagId`为 just`tagId`您将使用私有变量，但它只是一个，对于所有实例都是通用的。

如果我找到一种方法，我会考虑让你的代码工作和编辑。

[编辑]

Stephen 所做的与您期望的代码所做的非常接近。不过，我不想向同事解释它是如何工作的以及为什么。

[编辑]

顺便提一句。看看 require.js 和 AMD（模块定义）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:53:11.147

您的代码几乎是正确的。`this`访问tagId时就输了。`this.tagId`正在该特定 TextField 上设置属性，而不是`var tagId`您在顶部声明的属性。

如果您`x`不使用设置变量`var`，如在 中`x = 2`，它会找到最近`x`的作用域链；如果没有找到，它最终会成为全局对象 ( `window`) 的一个属性。在您的情况下，您可以`tagId`从任何这些功能进行修改，因为它们可以达到上一层。这就是为什么它被用作“私有”变量的原因，`privateMethod`可以达到同样的方式。

而且由于`jeeni.TextField`被设置为整个函数的返回值，所以你不要`jeeni`在里面引用。

```
jeeni.TextField = (function(){

    var tagId;

    var privateMethod = function(){
        console.log("IN: privateMethod");
    }

    var publicMethod = function(){
        console.log("IN: publicMethod: " + tagId);
    }

    function TextField(id){
        // this === the new instance of TextField
        console.log("Constructor", this);
        // set the tagId variable which is in scope here
        tagId = id;
    }

    TextField.prototype.foo = publicMethod

    return TextField

 }()); 
```

请注意，我还在`var`公共/私有方法之前添加了，否则您会将它们泄漏到全局范围内。您也可以使用`function publicMethod(){ ... }`，这通常更适合调试。

如果您感到困惑，`x = function(){}...`则与`function x(){}`. [请参阅“揭秘命名函数表达式”](http://kangax.github.com/nfe/)的第 2 章。

清除后，这可能仍然不是您想要的，因为此代码**`tagId`将在 TextField 的所有实例之间共享**。每个实例都有一个的通常方法是`tagId`将其设为“公共”属性，这正是您所做的（我认为这没有任何问题，因为`id`它本身来自外部）：

```
...

// var tagId -> drop this

publicMethod = function(){
    console.log("IN: publicMethod: " + this.tagId);
}

function TextField(id){
    console.log("Constructor");
    this.tagId = id;
} 
```

现在让我们`tagId`为每个实例设置私有且特定的。无需每次都创建新函数的最简单方法是创建一个私有对象（我们称之为它`tags`）来保存所有数据，并为每个实例提供它自己的 ID（`tf_id`）。ID 是可见的，但由于该`tags`对象是私有的，因此您只能使用以下一种公共方法访问数据：

```
jeeni.TextField = (function(){

    var tags = {}
      , uid = 0;

    privateMethod = function(){
        console.log("IN: privateMethod");
    }

    publicMethod = function(){
        console.log("IN: publicMethod: " + tags[this.tf_id].tagId);
    }

    function TextField(id){
        this.tf_id = uid++
        tags[this.tf_id] = id
    }

    TextField.prototype.foo = publicMethod

    return TextField

 }()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:07:52.910

显然我读错了这个问题。

如果您设置某物的属性（即 this.tagId），它会立即可供全世界访问。您将构造函数包装在错误的位置 - 改为将其更改为：

```
jeeni.TextField = (function(){
    var TextField = function(id){
        console.log("Constructor");
        var tagId = id;
        privateMethod = function(){
            console.log("IN: privateMethod");
        }

        this.publicMethod = function(){
            console.log("IN: publicMethod: " + tagId);
        }
    }

    TextField.prototype = {
            constructor: TextField
    };

    return TextField;
}()); 
```

基本上，您将无法在原型上放置任何需要访问这些受保护变量的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T22:36:52.477

这里有几个问题。首先是您以不正常的方式处理全局变量。实际上你有这个：

```
var globalVar;

globalVar = function() {
    globalVar = function() {
        //... stuff
    }
    return globalVar;
} 
```

你希望它能做什么？正常的写法是：

```
function myObj(id) {
    // in javascript the function *is* the constructor
    tagId = id;
    function someMethod() {
        //...
    }
}
var globalVar = new myObj(someId); 
```

尽管最好避免使用全局变量。

在您给出的示例中，这是您要返回的实际对象：

```
 function(id){
    console.log("Constructor");
    this.tagId = id;
} 
```

所以不，它没有`privateMethod`or `publicMethod`。由于此函数对象是在封闭函数的范围内构造的，因此构造函数可以访问`privateMethod`，这就是它的隐私来自何处。

要了解如何在 javascript 中执行私有变量和方法，请自行前往向导：

[http://javascript.crockford.com/private.html](http://javascript.crockford.com/private.html)

# c++ - 使用 BitBlt 遮罩位图 C++ 的背景

> ID：13556050
> 
> 赞同：2
> 
> 时间：2012-11-25T22:06:22.460
> 
> 标签：c++, winapi, bitmap, bitblt

我正在制作一个带有表示对象的位图的小游戏，并且我正在尝试使用位图蒙版来掩盖背景。我在google上查了一下，做了两张位图。一艘船和一个作为面具。对于面具，我把我想要的所有东西都涂上了黑色和背景白色。（如果这应该相反，请告诉我）。我这样加载位图：

```
HBITMAP bmpShip = (HBITMAP)LoadImage(NULL,
                                     "C:\\Users\\Owner\\Desktop\\Asteroids\\Starship.bmp",
                                     IMAGE_BITMAP,
                                     0,
                                     0,
                                     LR_LOADFROMFILE);

HBITMAP hShipMask = (HBITMAP)LoadImage(NULL,
                                       "C:\\Users\\Owner\\Desktop\\Asteroids\\StarshipMask.bmp",
                                       IMAGE_BITMAP,
                                       0,
                                       0,
                                       LR_LOADFROMFILE); 
```

现在如何使用 BitBlt 光栅操作在特定位置的屏幕上显示没有背景的位图。在不掩盖背景的情况下，这就是我一直在做的事情：

```
Ship = CreateWindowEx(0,
                      "STATIC","",
                      SS_CENTERIMAGE | SS_REALSIZEIMAGE | SS_BITMAP | WS_CHILD | WS_VISIBLE,
                      10,
                      shipPos,
                      294,
                      86,
                      Background,
                      (HMENU)-1,
                      NULL, NULL);
SendMessage(Ship, STM_SETIMAGE,  (WPARAM)IMAGE_BITMAP, (LPARAM)bmpShip);
UpdateWindow(hWnd);

//And moving the window with MoveWindow() 
```

谁能告诉我如何掩盖背景然后将窗口移动到新位置

编辑：顺便说一句，背景只是另一个位图，其加载方式与显示船舶顶部的其他位图相同。

# windows - OpenCV - cv.h、core.hpp、highgui.hpp 和其他文件包括在哪里？

> ID：13556054
> 
> 赞同：1
> 
> 时间：2012-11-25T22:07:35.637
> 
> 标签：windows, opencv

OpenCV 中的大多数示例代码都以这些行（或类似内容）开头：

```
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp" 
```

然而，这些文件不在 opencv 安装包中？我已经安装了几次 opencv，但在我的计算机上找不到这些文件。这是怎么回事？如此基本的东西怎么会丢失？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:12:36.927

在 Windows 上，它们通常位于`build/include/opencv`目录中。

# javascript - 同时执行 JS 函数

> ID：13556056
> 
> 赞同：4
> 
> 时间：2012-11-25T22:07:46.870
> 
> 标签：javascript, function, time, execute

我正在尝试同时执行两个不同的*功能*。

我有一排图像，它们一个接一个地通过改变不透明度来点亮，使其看起来像是在眨眼。问题是时间需要准确，并且有几毫秒的差异，一两分钟后它看起来就像一团糟。

```
 <img src="img1" class="1" /><img src="img2" class="2" /><img src="img3" class="3" />

    <script type="javascript">
    setTimeout(function blinkone(){$('.1').delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, blinkone);},1000)

    setTimeout(function blinktwo() {$('.2').delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, blinktwo);},2000)

    setTimeout(function blinkthree() {$('.3').delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, blinkthree);},3000)
    </script> 
```

如何同时执行多个功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T22:20:14.940

Javascript 是单线程的，所以你不能同时执行许多函数，从字面上看。您可以通过对 setTimeout 调用进行分组来解决此问题，例如：

```
var iterationCount = 0;
setTimeout(function(){
   iterationCount++;
   $('.1').delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, blinkone);
   if (iterationCount % 2 == 0) {
      $('.2').delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, blinktwo);
   }
   if (iterationCount % 3 == 0) {
      $('.3').delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, blinkthree);
   }
},1000); 
```

这样，您可以避免失去动画之间的同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T22:23:09.140

只需给他们所有相同的课程并影响该课程。[http://jsfiddle.net/popnoodles/amD8T/2/](http://jsfiddle.net/popnoodles/amD8T/2/)

```
<img src="img1" class="blink" />
<img src="img2" class="blink" />
<img src="img3" class="blink" />

<script>
$(function(){

    offon();

});

function offon()
{
    $('.blink').animate({opacity:0},1000)
        .animate({opacity:1},1000, function(){
            offon();
        });
}
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:26:20.000

您还可以递归地链接回调，这在 IMO 中要干净得多：

```
function display(number){
    number = number || 1
    $('.'+ (number % 3 + 1)).delay(1000).fadeTo(0,0.5).delay(2000).fadeTo(0,1, function(){display(++number);});
} 
```

这也可以很好地扩展，因此您不必添加 100 行代码即可将效果添加到 100 个图像。

这是一个演示：http: [//jsfiddle.net/8cwA6/1/](http://jsfiddle.net/8cwA6/1/)

我不完全确定，但也许你想要的效果更像这个小提琴：http: [//jsfiddle.net/8cwA6/2/](http://jsfiddle.net/8cwA6/2/)

# xml - xml可以获取剪贴板文本吗？

> ID：13556059
> 
> 赞同：0
> 
> 时间：2012-11-25T22:08:01.147
> 
> 标签：xml, variables, clipboard

我需要在 xml 中的变量中获取剪贴板文本，是否有任何函数可以连接到剪贴板并使用这些值，是否可以这样做？

我想这样做的原因是为了帮助我在 delphi（或 c++ builder）中更快地编程，而 xml 只是模板。

这是示例

```
<?xml version="1.0" encoding="utf-8" ?>

<codetemplate   xmlns="http://schemas.borland.com/Delphi/2005/codetemplates"
                version="1.0.0">
    <template name="if" surround="true" invoke="auto">
        <point name="expr">
            <script language="C">
                invoke_code_completion();
            </script>
            <hint>
                conditional expression
            </hint>
            <text>
                true
            </text>
        </point>
        <description>
            if statement
        </description>
        <author>
            Embarcadero
        </author>
        <code language="C" context="methodbody"><![CDATA[if ($expr$) {
$selected$$*$$end$
}
]]>
        </code>
    </template>
</codetemplate> 
```

这将产生**if (true) { }**专注于**true**，我需要的是你使用一些剪贴板文本而不是 word true 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T22:15:38.167

XML 是一种数据格式。它不能“做”任何事情，也没有变量。

根据修改后的问题更新：

代码模板似乎是一段代码（在某些编程语言中），它作为数据出现在 XML 文档中，其中包括有关它的元数据（大概是为了可以在代码库中存储和搜索它）。

XML 似乎与问题无关。您将编写代码，[使用常用的 API 以](https://www.google.co.uk/search?hl=en&source=hp&q=delphi%20read%20clipboard&aq=f&aqi=&aql=&oq=&gs_rfai=)`<code>`您想要的任何语言访问元素中的剪贴板。

# deserialization - Weka 类对反序列化无效

> ID：13556062
> 
> 赞同：1
> 
> 时间：2012-11-25T22:09:00.427
> 
> 标签：deserialization, cluster-analysis, weka

我在 Weka Explorer 中训练了一个 SimpleKMeans 聚类器，并将模型保存到我的计算机上。现在我想在我的 Java 代码中使用它来集群我创建的实例，但是当我尝试反序列化它时出现以下错误：

> java.io.InvalidClassException: weka.core.Instance; weka.core.Instance；在 java.io.ObjectInputStream.readOrdinaryObject(Unknown Source) 在 java.io.ObjectInputStream.readObject0(Unknown Source) 在 java.io.ObjectInputStream.readArray(Unknown) 的 java.io.ObjectStreamClass.checkDeserialize(Unknown Source) 的反序列化类无效Source) at java.io.ObjectInputStream.readObject0(Unknown Source) at java.io.ObjectInputStream.defaultReadFields(Unknown Source) at java.io.ObjectInputStream.readSerialData(Unknown Source) at java.io.ObjectInputStream.readOrdinaryObject(Unknown Source)在 java.io.ObjectInputStream.readObject0(Unknown Source) 在 java.io.ObjectInputStream.defaultReadFields(Unknown Source) 在 java.io.ObjectInputStream.readSerialData(Unknown Source) 在 java.io.ObjectInputStream。

我的 Test 课程的第 32 行在哪里

```
Clusterer kmeans_temp = (Clusterer) weka.core.SerializationHelper.read("path/to/model/myclusterermodel.model"); 
```

我做对了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:39:19.480

问题是因为我使用了两个不同版本的 WEKA 来创建模型并反序列化模型。我下载了用于 WEKA 资源管理器的版本的源代码并解决了问题。

# javascript - JavaScript 音频不能在 jQuery 函数之外播放

> ID：13556064
> 
> 赞同：0
> 
> 时间：2012-11-25T22:09:04.007
> 
> 标签：javascript, jquery, audio, html5-audio

我知道问题标题没有多大意义，但我想不出更好的表达方式。我是 jQuery 的新手，我正在使用这段代码淡入`<div>`并播放声音：

```
$(document).ready(function(){

    $('#speech').fadeIn('medium', function() {

        play('msg_appear');

        var sptx = $('<p class="stext">').text('There is nothing here.');

        $('#speech').append(sptx);
        $('.stext').typeOut({marker: '', delay: 22});

    });

}); 
```

此代码运行良好，但是在淡入完成*后会播放声音。*我希望它在淡入时播放，所以我尝试将`play()`调用放在淡入函数之外，如下所示：

```
$(document).ready(function(){

    play('msg_appear');

    $('#speech').fadeIn('medium', function() { 
```

但是，现在根本不玩了。JavaScript 控制台上没有错误，所以我不确定这是否是语法错误，并且可能很明显，但我不知道是什么。

`play()`是我发现播放音频的功能，如果它很重要的话。我把它放在上面代码的同一个文件中；就在`$(document).ready()`.

```
function play(sound) {

    if (window.HTMLAudioElement) {
      var snd = new Audio('');

      if(snd.canPlayType('audio/ogg')) {
        snd = new Audio(sound + '.ogg');
      }
      else if(snd.canPlayType('audio/mp3')) {
        snd = new Audio(sound + '.mp3');
      }

      snd.play();
    }
    else {
      alert('HTML5 Audio is not supported by your browser!');
    }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:02:56.443

根据评论，我建议修改`play()`您找到的功能：

```
function play(sound, callback) {
    if (window.HTMLAudioElement) {
        var snd = new Audio('');
        if(snd.canPlayType('audio/ogg')) {
            snd = new Audio(sound + '.ogg');
        }
        else if(snd.canPlayType('audio/mp3')) {
            snd = new Audio(sound + '.mp3');
        }
        if(typeof(callback)=="function"){
            snd.addEventListener("canplay", function(){
                snd.play();
                callback();
            });
        } else {
            snd.addEventListener("canplay", function(){
                snd.play();
            });
        }
        snd.load();
    }
    else {
        alert('HTML5 Audio is not supported by your browser!');
    }
} 
```

然后这样称呼它：

```
play('msg_appear', function(){
    $('#speech').fadeIn('medium', function() {

        var sptx = $('<p class="stext">').text('There is nothing here.');

        $('#speech').append(sptx);
        $('.stext').typeOut({marker: '', delay: 22});

    });
}); 
```

这样，`play();`在音频开始播放之前，音频不会触发，并且`fadeIn()`会与音频同时启动。
当然，回调不是必需的；它只是在不同的网络条件下提供更强大的时序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:25:35.467

我只能认为`$(document).ready`在没有被`fadeIn`.

尝试 ：

```
$(window).on('load', function(){
    play('msg_appear');
    $('#speech').fadeIn('medium', function() {
        var sptx = $('<p class="stext">').text('There is nothing here.');
        $('#speech').append(sptx);
        $('.stext').typeOut({marker: '', delay: 22});
    });
}); 
```

## 编辑：

如有必要，您可以引入进一步的延迟，如下所示：

```
$(window).on('load', function(){
    setTimeout(function() {
        play('msg_appear');
        $('#speech').fadeIn('medium', function() {
            var sptx = $('<p class="stext">').text('There is nothing here.');
            $('#speech').append(sptx);
            $('.stext').typeOut({marker: '', delay: 22});
        });
    }, 1000);//adjust up/down to the minimum reliable value
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:03:34.223

首先看：[HTML5 Audio onLoad](https://stackoverflow.com/questions/5335064/html5-audio-onload) 有一些处理加载状态的方法。不过，接受的答案看起来很奇怪。

我推荐这样的代码：

```
function makePlayer(sound){
  if (window.HTMLAudioElement) {
      var snd = new Audio('');

      if(snd.canPlayType('audio/ogg')) {
        snd = new Audio(sound + '.ogg');
      }
      else if(snd.canPlayType('audio/mp3')) {
        snd = new Audio(sound + '.mp3');
      }

      return function(){
        snd.play();
      };
    }

};

var play = makePlayer('msg_appear');

$(document).ready(function(){

    $('#speech').fadeIn('medium', function() {

        play();

        var sptx = $('<p class="stext">').text('There is nothing here.');

        $('#speech').append(sptx);
        $('.stext').typeOut({marker: '', delay: 22});

    });

}); 
```

# java - 如何为spring配置web.xml

> ID：13556068
> 
> 赞同：2
> 
> 时间：2012-11-25T22:09:16.920
> 
> 标签：java, spring, spring-mvc, web.xml, classnotfoundexception

我是 spring 框架的新手，并且在通过 web.xml 链接/配置 springframework 时遇到问题。运行我的应用程序时出现以下错误。

错误：

```
HTTP Status 500 - Error instantiating servlet class org.springframework.web.servlet.DispatcherServlet

    type Exception report

    message Error instantiating servlet class org.springframework.web.servlet.DispatcherServlet

    description The server encountered an internal error (Error instantiating servlet class org.springframework.web.servlet.DispatcherServlet) that prevented it from fulfilling this request.

    exception 

    javax.servlet.ServletException: Error instantiating servlet class org.springframework.web.servlet.DispatcherServlet
        org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
        org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
        org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
        org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
        org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
        org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
        java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        java.lang.Thread.run(Unknown Source)

    root cause 

    java.lang.ClassNotFoundException: org.springframework.web.servlet.DispatcherServlet
        org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
        org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
        org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
        org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
        org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
        org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
        org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
        org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
        java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        java.lang.Thread.run(Unknown Source) 
```

显然，它在库中找不到类 org.springframework.web.servlet.DispatcherServlet。但是，我不知道如何告诉 web.xml 在哪里寻找这个类。

web.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
    <web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
             xmlns="http://java.sun.com/xml/ns/javaee" 
             xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
             xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">

        <servlet>
            <servlet-name>DispatcherSample</servlet-name>
            <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        </servlet>

        <servlet-mapping>
            <servlet-name>DispatcherSample</servlet-name>
            <url-pattern>/PlayField.html</url-pattern>
        </servlet-mapping>

      <welcome-file-list>
        <welcome-file>index.html</welcome-file>
        <welcome-file>Welcome.html</welcome-file>
      </welcome-file-list>

    </web-app> 
```

DispatcherSample-servlet.xml

```
 <?xml version="1.0" encoding="UTF-8"?>

    <beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

        <bean id="handlerMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">  
            <property name="mappings">
                <props>
                    <prop key="/PlayField.html">playfieldController</prop>
                </props>    
            </property>
        </bean>

        <bean id="playfieldController" class="demos.PlayfieldController"/>

    </beans> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:11:12.673

> java.lang.ClassNotFoundException：org.springframework.web.servlet.DispatcherServlet

您必须添加[`spring-webmvc.jar`](http://repo1.maven.org/maven2/org/springframework/spring-webmvc/3.1.3.RELEASE/spring-webmvc-3.1.3.RELEASE.jar)到您的 CLASSPATH（很可能是`/WEB-INF/lib`目录）。您的其余配置似乎很好。

# c++ - 在 cpp 中快速将 1D 数组复制到 3D 数组

> ID：13556075
> 
> 赞同：1
> 
> 时间：2012-11-25T22:10:02.427
> 
> 标签：c++, arrays, performance, 3d, copy

是否可以使用 memcpy 的某些功能从 1D 数组复制到 3D？

现在我正在使用一种缓慢的方法：

```
for(int loop1 = 0; loop1 < numberAgents; loop1++)
    for(int loop2 = 0; loop2 < fieldWidth; loop2++)
        for(int loop3 = 0; loop3 < fieldWidth; loop3++)
            potentialField[loop1][loop2][loop3] = cpuPotentialField[loop1 * fieldWidth * fieldWidth + loop2 * fieldWidth + loop3]; 
```

这不起作用：

```
memPotentialField = numberAgents * fieldWidth * fieldWidth * sizeof(float);
memcpy(potentialField, cpuPotentialField, memPotentialField); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:27:29.107

多维数组按行存储（第 8.3.4/9 节），所以基本上你的方法`memcpy`很好（因为浮点数是 POD）。

```
memcpy(&potentialField[0][0][0], cpuPotentialField,
       sizeof(potentialField)/sizeof(***potentialField)); 
```

使用 std::copy 更好，因为它也适用于非 PODS。所以我会写

```
std::copy(&potentialField[0][0][0],
          &potentialField[0][0][0] + sizeof(potentialField)/sizeof(potentialField[0][0][0]),
          cpuPotentialField); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:14:29.603

除非你有一个特别糟糕的编译器或者你忘记开启优化（例如`-O3`），那么第一种方法在性能方面应该很好。但是，您可以通过提升一些乘法来对其进行一些优化：

```
for (int loop1 = 0; loop1 < numberAgents; loop1++)
{
    const int index1 = loop1 * fieldWidth * fieldwidth;

    for (int loop2 = 0; loop2 < fieldWidth; loop2++)
    {
        const int index2 = index1 + loop2 * fieldWidth;

        for (int loop3 = 0; loop3 < fieldWidth; loop3++)
        {
            potentialField[loop1][loop2][loop3] = cpuPotentialField[index2 + loop3];
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:47:10.780

您可以通过展开循环获得一些性能。在某些处理器中，分支或跳转指令会导致指令流水线重新加载，从而浪费时间。

```
//...
unsigned int items_remaining = fieldWidth;
for (unsigned int loop3 = 0; loop3 < fieldWidth; ++loop3)
{
    unsigned int copy_count = 4 - (items_remaining % 4);
    switch (copy_count)
    {
        // The fall-through of these cases is intentional.
        case 4:
          potentialField[loop1][loop2][loop3] = cpuPotentialField[loop1 * fieldWidth * fieldWidth + loop2 * fieldWidth + loop3];
          ++loop3;
          --items_remaining;
        case 3:
          potentialField[loop1][loop2][loop3] = cpuPotentialField[loop1 * fieldWidth * fieldWidth + loop2 * fieldWidth + loop3];
          ++loop3;
          --items_remaining;
        case 2:
          potentialField[loop1][loop2][loop3] = cpuPotentialField[loop1 * fieldWidth * fieldWidth + loop2 * fieldWidth + loop3];
          ++loop3;
          --items_remaining;
        case 1:
          potentialField[loop1][loop2][loop3] = cpuPotentialField[loop1 * fieldWidth * fieldWidth + loop2 * fieldWidth + loop3];
          ++loop3;
          --items_remaining;
    } // End: switch
} // End: for 
```

这仅针对 4 个项目展开。循环中的项目越多，循环的效率就越高。正如 Paul R 所说，预先计算一些索引也会有所帮助。

某些处理器可能具有编译器可以利用的专用复制指令，具体取决于编译器。

# php - mysql查询最近15天每天的记录数

> ID：13556077
> 
> 赞同：1
> 
> 时间：2012-11-25T22:10:46.730
> 
> 标签：php, mysql, database

我有一个包含用户注册记录的数据库表。`Table: [USER]` 我的专栏之一以`created_on`int 类型命名，并保存`timestamp`注册日期和时间。

我应该如何编写查询以便获得每天的注册用户数？

我想要这样的结果：

```
21/11 : 150 users
22/11 : 200 users
23/11 : 50 users
24/11 : 150 users 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:16:11.973

使用`FROM_UNIXTIME()`简单的日期函数。

```
SELECT MONTH(FROM_UNIXTIME(created_on)) AS "month", 
    DAY(FROM_UNIXTIME(created_on)) AS "day", COUNT(created_on)
FROM `user`
WHERE YEAR(FROM_UNIXTIME(created_on)) = 2012
GROUP BY MONTH(FROM_UNIXTIME(created_on)), DAY(FROM_UNIXTIME(created_on)) 
```

您可以使用 PHP 进行字符串格式化。

# actionscript-3 - 使用 as3wavsound 播放声音时的延迟

> ID：13556083
> 
> 赞同：2
> 
> 时间：2012-11-25T22:11:19.497
> 
> 标签：actionscript-3, wav, audio

我正在使用[as3wavsound](http://code.google.com/p/as3wavsound/)类从我的 ActionScript 3 项目中的文件中播放 .wav 声音。但是，即使我正在预加载声音，每次播放时我都会延迟大约 1 秒。无论 .wav 长度或比特率如何，延迟都是相同的。

我该如何解决这个延迟？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:11:19.497

这是由于[as3wavsound](http://code.google.com/p/as3wavsound/)中的缓冲区大小。要解决这个问题...

1) 打开 WavSoundPlayer.as

2）替换以下代码：

```
public static var MAX_BUFFERSIZE:Number = 8192; 
```

和...

```
public static var MAX_BUFFERSIZE:Number = 2048;// 8192; 
```

保存并关闭 WavSoundPlayer.as，然后再次运行您的项目。这应该可以解决延迟问题。

* * *

**（答案归功于[morskoyz](http://code.google.com/u/117516888526039724360/)）**

**（[as3wavsound 错误报告上的原始问答。](http://code.google.com/p/as3wavsound/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary&groupby=&sort=&id=17)）**

# ios - 获取静态 UITableView 的 UITableViewHeaderFooterView

> ID：13556086
> 
> 赞同：2
> 
> 时间：2012-11-25T22:12:00.087
> 
> 标签：ios, static, interface-builder, uitableview

我有一个包含`UITableViewController`. 表格视图是静态的，包含两个部分。表视图完全在 IB 中设置（包括表视图部分的页眉和页脚文本）——我没有在我的视图控制器中实现任何表视图委托方法。

如果我尝试获取对`UITableViewHeaderFooterView`给定部分的引用，它总是返回 nil。

```
UITableViewHeaderFooterView* header =[self.tableView headerViewForSection:0]; 
```

当我运行应用程序时，我可以看到我在 IB 中设置的页眉和页脚文本，所以我知道这些视图在那里。我只是不知道如何以编程方式访问它们。

任何帮助将不胜感激，CS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:20:21.937

实际上，您需要指定表格页脚视图，并使用其委托将其传递给表格视图。

例如，假设您定义了一个名为 tableFooterView 的 IBOutlet UIView。然后在下面的委托方法中，您可以将您的 tableFooterView 传递给您的表格视图：

```
- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section;   // custom view for footer. will be adjusted to default or specified footer height
{
    return self.tableFooterView;
} 
```

您还需要实现以下方法来设置表格页脚视图的高度：

```
 -(CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
 {
    return self.tableFooterView.frame.size.height;
 } 
```

# android - 将触摸处理从父视图更改为子视图

> ID：13556091
> 
> 赞同：0
> 
> 时间：2012-11-25T22:13:18.197
> 
> 标签：android

我打算将触摸事件从父视图转移到其子视图。我尝试了一些结构，但到目前为止，我还没有成功地将触摸处理分配给另一个视图，而只是将触摸处理从父视图委托给子视图，这并不完全相同。

这就是我想要实现的目标：

![绿点是父级上的 Touch Down 事件，然后我拖动到另一个视图，然后在蓝点上拾取（在子视图上触发 Touch Down），从这一点开始不再涉及父视图。](../Images/23544dd84077bc4b324e391451febc9d.png)

绿点是父级上的 Touch Down 事件，然后我拖动到另一个视图，然后在蓝点上拾取（在子视图上触发 Touch-Down），从这一点开始不再涉及父视图，就像我一开始会碰孩子一样。

我可以通过扩展父母的 onTouchEvent 方法来委托触摸事件，然后在进入孩子的视图边界时调用 child.dispatchTouchEvent()，但我想避免父母的参与。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:17:26.750

从[View.OnTouchListener](http://developer.android.com/reference/android/view/View.OnTouchListener.html#onTouch%28android.view.View,%20android.view.MotionEvent%29)文档中， OnTouch() 的返回是：

> 退货
> 
> ```
> True if the listener has consumed the event, false otherwise. 
> ```

基本上，如果您希望父级对 onTouchListener 做出反应，请返回 false。如果您希望它不做出反应，请返回 true。

# java - java - 如何将一个java bean的属性传递给另一个java bean？

> ID：13556093
> 
> 赞同：2
> 
> 时间：2012-11-25T22:13:36.497
> 
> 标签：java, jsf, managed-bean

我正在尝试从一个托管 bean 到另一个托管 bean。我有一个获取用户名的 loginbean，我需要获取该值并将其放入另一个托管 bean sidebarbean。我正在使用 JSF，并认为我可以这样 `#{sidebarbean.setUserName(loginbean.username)}`做，但这不起作用。有什么建议么？

按照你的建议

```
@ManagedBean(name = "sidebarbean")
@SessionScoped
public class SideBarBean {
    private ArrayList myContacts = new ArrayList();
    private String user;
    @PersistenceContext
    private EntityManager em;
    @Resource
    private UserTransaction utx;

    public SideBarBean() {

    }

    public ArrayList getMyContacts() {
        myContacts.clear();
        List<Contacts> list = em.createNamedQuery("Contacts.findByUsername")
            .setParameter("username", user).getResultList();
        for (Contacts c : list) {
            myContacts.add(c.getContact());
        }
        return myContacts;
    }

    public void setMyContacts(ArrayList myContacts) {
        this.myContacts = myContacts;
    }

    public String getUser() {
        return user;
    }

    public void setUser(String user) {
        this.user = user;
    }
}

@ManagedBean(name = "loginbean")
@SessionScoped
public class LoginBean {
    @PersistenceContext
    private EntityManager em;
    @Resource
    private UserTransaction utx;
    @ManagedProperty(value="#{sidebarbean}")
    private SideBarBean sbb;
    private String username;
    private String password;
    private Boolean verified = false;
    private Boolean authFail = false;

    public LoginBean() {
    }

    public void update(){
        sbb.setUser(username);
    } 
```

我得到“无法创建托管 bean loginbean。发现以下问题：-托管 bean loginbean 的属性 sbb 不存在。检查是否存在适当的 getter 和/或 setter 方法。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:21:51.610

您可以使用[@ManagedProperty](http://docs.oracle.com/javaee/6/api/javax/faces/bean/ManagedProperty.html)注释，然后您可以访问`SideBarBean`.

```
@ManagedBean(name="loginbean")
public class LoginBean{

 @ManagedProperty(value="#{sidebarbean}")
 private SideBarBean sidebarbean;

 public void update(){

  sidebarbean.setUserName("xxxx");

 }

} 
```

# c++ - 添加具有 size_t 类型值的指针

> ID：13556094
> 
> 赞同：1
> 
> 时间：2012-11-25T22:13:44.153
> 
> 标签：c++, pointers, types, size-t

```
class CheckPointer {
public:
    CheckPointer(int * mbeg, int * mend) :
        beg(mbeg), end(mend), curr(mbeg) {}

    // subscript operator
    int & operator[] (const size_t pos) {
        if (beg + pos < beg) {
            throw out_of_range("ERR: before beg!");
        }
        if (beg + pos >= end)
            throw out_of_range("ERR: end or past end!");
        return *(const_cast<int *>(beg + pos));
    }
private:
    const int * beg;
    const int * end;
    int * curr;
}; 
```

我为 CheckPointer 类定义了一个下标运算符。由于@param pos 是 size_t 类型，我无法检查用户是否传递了正值或负值。但是，我尝试编写代码来进行边界检查，并且它可以工作：

```
 if (beg + pos < beg) {
            throw out_of_range("ERR: before beg!");
        } 
```

我不知道它为什么会起作用......任何人都可以帮助我吗？

谢谢你考虑我的问题！

* * *

了解更多信息：

环境：eclipse CDT，Ubuntu 10.04

测试代码：

```
int iarr[6] = {1, 2, 3, 4, 5, 6};
CheckPointer cp(iarr, iarr+6);
// subscript
cout << cp[2] << endl;
cout << cp[5] << endl;
cout << cp[-2] << endl; // error: before beg 
```

测试代码输出：

```
terminate called after throwing an instance of 'std::out_of_range'
  what():  ERR: before beg!
3
6 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:23:06.353

这是有效的，因为负值被转换为无符号值。您的机器架构可能对负值使用二进制补码，因此值 -2 会导致：

```
0xfffffffe (assuming 32-bit) 
```

当您将此添加到 时`beg`，它会环绕并提供`beg`大于或等于 2 的值，具有从中减去 2 的效果。因此，尽管索引非常大，但它基本上执行了减法。如果值为或，`beg`则错误将是“过去的结尾”。`1``0`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:05:20.123

形式上，如果在开始的数组之外，`beg + pos`比较`beg`具有未定义的行为（这稍微简化了，但对于本次讨论来说已经足够了）。对坏索引的更好检查是：`beg + pos``beg`

```
if (end - beg <= pos) 
```

但这并不能回答问题。将小的负值转换为`size_t`产生大的正值；将它们视为偏移量会产生一个远远超出数组末尾的指针，因此检查结果是否在边界内会发现这个问题以及简单超出末尾的“普通”值。

# android - 如何在地图上询问叠加项目

> ID：13556095
> 
> 赞同：0
> 
> 时间：2012-11-25T22:13:46.637
> 
> 标签：android, google-maps, itemizedoverlay, overlayitem

我为我的活动创建了一个覆盖项列表。但是我想在运行应用程序并在地图上显示项目后将项目添加到列表中（例如，我创建一个按钮来触发事件）。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:25:43.633

看看[MapView 教程](https://developers.google.com/maps/documentation/android/hello-mapview)，那里有一个例子。

# ruby-on-rails - 如何用关联编写范围？

> ID：13556103
> 
> 赞同：0
> 
> 时间：2012-11-25T22:14:14.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3, scope

你能帮我写下以下范围吗：

`Cv`belongs_to`Student`并且我想写一个范围，它给我所有的 cvs，其中学生至少有一个教育（`student.edcuations.any?`）并且学生是有效的（所有属性都被填充）

我想为`Cv`.

*楷模*

```
#cv.rb
belongs_to :student

#student.rb
has_many :cvs
has_many :educations 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:49:03.483

我想我误解了你的模型的布局。

我觉得它应该看起来更像这样，因为每个简历都会列出一个教育（否则，数据库中的相互连接如何）

```
#cv.rb
belongs_to :student
has_many :educations

#student.rb
has_many :cvs

#education.rb
belongs_to :cvs 
```

不过，我可能只是使用类方法。

```
#student.rb
def cvs_with_education
   self.cvs.reject {|cv| cv.educations.empty?}
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:26:40.170

查看[ActieRecord 查询接口指南](http://guides.rubyonrails.org/active_record_querying.html#joining-tables "ActiveRecord 查询接口")的第 11.2.3 节，了解如何加入嵌套关联。

就像是

```
scope :with_education, joins(:student => :educations).where("some conditions") 
```

您可能想要定义一个`:valid_student`范围，然后在其中利用它。

# c# - 无法访问按钮单击c#上的复选框的值

> ID：13556106
> 
> 赞同：0
> 
> 时间：2012-11-25T22:14:32.193
> 
> 标签：c#, asp.net

我将数据绑定到 Page_Load 中的网格视图，然后在同一个 Page_Load 中添加一列不属于数据绑定的复选框。

然后，当按下按钮时，我想检查是否选中了任何框。但是，当我在 button_click 方法中查找复选框时，复选框似乎完全消失了。

我正在寻找他们

```
foreach (GridViewRow gvr in GridView1.Rows)
{
   CheckBox cb = (CheckBox)gvr.FindControl("check" + gvr.Cells[2].Text);
   ...
} 
```

我有一种预感，它们可能会在回发时被破坏，但我不确定如何确保这不会发生。

我的 Page_Load 方法中的所有内容都包含在 if(!IsPostBack) 语句中。

有些人要求我的 page_load：

`foreach (GridViewRow gvr in GridView1.Rows) {`

 ````
 TableCell tc = new TableCell();

                CheckBox cb = new CheckBox();

                cb.ID = "check" + gvr.Cells[2].Text;

                tc.Controls.AddAt(0, cb);

                gvr.Cells.AddAt(0, tc);

            } 
````  `我认为是相关的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T07:48:35.540

创建动态控件时，将创建它们的代码（即复选框）`Page_Init`放在`Page_Load`.
您还应该仔细检查复选框的创建**顺序**和它们收到的**id在每个回发中是否相同。**
如果由于某种原因`gvr.Cells[2].Text`在回发之间发生了变化，您可能应该考虑一个更好的逻辑来标识您的复选框。`

# cryptography - 为什么盐会阻止彩虹表？

> ID：13556108
> 
> 赞同：0
> 
> 时间：2012-11-25T22:14:38.413
> 
> 标签：cryptography, salt, rainbowtable

> **可能重复：**
> [密码盐如何帮助抵御彩虹表攻击？](https://stackoverflow.com/questions/420843/how-does-password-salt-help-against-a-rainbow-table-attack)

在你提到它之前，我已经阅读[了这个问题。](https://stackoverflow.com/questions/3566504/why-do-salts-make-dictionary-attacks-impossible)我没有跟上。

这是我对盐/彩虹表的理解。请纠正我哪里错了。

1.  用户输入 raw `password`。

2.  `password`与`salt`给出`passwordsalt`或连接`saltpassword`。

3.  `passwordsalt`/`saltpassword`被散列为 value `hash`。

4.  进入黑客。

5.  黑客使用彩虹表反转`hash`成`passwordsalt`/ `saltpassword`。

6.  黑客手中有（示例）字符串`letmein1horse`。

鉴于`letmein1horse`，这不只是意味着有两种选择：

1.  密码是`letmein1`，盐是`horse`。

2.  密码是`horse`，盐是`letmein1`。

所以你明白我为什么感到困惑。我的理解显然是有缺陷的，因为如果它是这样工作的，显然盐是无用的。

或者：我的理解是否正确，是整个迭代方案完全消除了这个明显的弱点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:19:05.200

彩虹表可以帮助您从散列到具有有限字符集的短序列。例如，彩虹表可能支持所有长度小于 10 个字符的字母数字序列。

A salt is much longer and uses a wider character set. If you use a 128-bit random salt, creating a rainbow table becomes physically intractable.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:18:42.377

攻击者将无法创建散列值（密码+盐）的预计算查找表（即彩虹表），因为它需要对每个盐进行大量计算。一个简单的字典攻击仍然是很有可能的，虽然速度要慢得多，因为它不能被预先计算。[来源](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)

# c# - 使用 AutoMapper 映射层次结构对象

> ID：13556112
> 
> 赞同：1
> 
> 时间：2012-11-25T22:15:09.743
> 
> 标签：c#, automapper

如何映射名为 Unit 的 ac# 类，该类又具有`List<Unit>`.

具体场景是一个 rootUnit 对象，其中包含一个作为第一级子级的 List。

第一级子单元对象将不包含任何其他单元，因此层次结构中不会有递归。

```
public class Unit
    {
        public Unit()
        {
            // Explicitly set the default value for the first unit in a hierarchy
            HierarchyIndex = 0;
            Units = new List<Unit>();
        }

        public List<Unit> Units { get; set; }

        public int UnitId { get; set; }
        public string Name { get; set; }       
        public Nullable<int> ParentId { get; set; }
        public int TemplateId { get; set; }       
        public bool HasChildren { get; set; }
        public bool IsFolder { get; set; }
        public DateTime CreatedAt { get; set; }
        public int HierarchyIndex { get; set; }
    } 
```

将上面的单元映射到这个视图模型：

```
public class UnitTreeViewModel
{
    [JsonProperty("key")]
    public int UnitId { get; set; }
    [JsonProperty("title")]
    public string Name { get; set; }
    [JsonProperty("isLazy")]
    public bool HasChildren { get; set; } 
    [JsonProperty("isFolder")]
    public bool IsFolder { get; set; } 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:35:57.477

假设上面评论中我的问题的答案是肯定的，那么您需要多次应用映射 - 类似于这个问题：[AutoMapper and flattening nested arrays](https://stackoverflow.com/questions/13338262/automapper-and-flattening-nested-arrays)

像这样的东西可能会起作用：

**AutoMapperConfigurator.cs**

```
namespace StackOverflow.ListUnit
{
    using AutoMapper;

    public class MyProfile : Profile
    {
        public override string ProfileName
        {
            get
            {
                return "MyProfile";
            }
        }

        protected override void Configure()
        {
            Mapper.CreateMap<Unit, UnitTreeViewModel>();
        }
    }
} 
```

**映射测试.cs**

```
namespace StackOverflow.ListUnit
{
    using System.Collections.Generic;
    using System.Linq;

    using AutoMapper;

    using NUnit.Framework;

    [TestFixture]
    public class MappingTests
    {
        [Test]
        public void AutoMapper_Configuration_IsValid()
        {
            Mapper.Initialize(m => m.AddProfile<MyProfile>());
            Mapper.AssertConfigurationIsValid();
        }

        [Test]
        public void AutoMapper_Mapping_IsValid()
        {
            Mapper.Initialize(m => m.AddProfile<MyProfile>());
            Mapper.AssertConfigurationIsValid();

            var unit = new Unit
                {
                    UnitId = 123,
                    Name = "Stack Overflow Rocks",
                    HasChildren = true,
                    IsFolder = true,
                    Units =
                        new List<Unit>
                            {
                                new Unit
                                    {
                                        UnitId = 123123,
                                        Name = "I'm the first baby",
                                        HasChildren = false,
                                        IsFolder = false,
                                    },
                                new Unit
                                    {
                                        UnitId = 123321,
                                        Name = "I'm the second baby",
                                        HasChildren = false,
                                        IsFolder = false,
                                    }
                            }
                };

            var unitViewModels = new List<UnitTreeViewModel>
                {
                    Mapper.Map<Unit, UnitTreeViewModel>(unit)
                };
            unitViewModels.AddRange(
                unit.Units.Select(Mapper.Map<Unit, UnitTreeViewModel>));

            Assert.That(unitViewModels, Is.Not.Null);
            Assert.That(unitViewModels.Count(), Is.EqualTo(3));
            var unitViewModel = unitViewModels.First(x => x.UnitId == 123);
            Assert.That(unitViewModel, Is.Not.Null);
            Assert.That(unitViewModel.Name, Is.EqualTo("Stack Overflow Rocks"));
            unitViewModel = unitViewModels.First(x => x.UnitId == 123123);
            Assert.That(unitViewModel, Is.Not.Null);
            Assert.That(unitViewModel.Name, Is.EqualTo("I'm the first baby"));
            unitViewModel = unitViewModels.First(x => x.UnitId == 123321);
            Assert.That(unitViewModel, Is.Not.Null);
            Assert.That(unitViewModel.Name, Is.EqualTo("I'm the second baby"));
        }
    }
} 
```

# ios - 在调用 viewDidAppear 之前不显示视图？什么时候显示视图？

> ID：13556114
> 
> 赞同：2
> 
> 时间：2012-11-25T22:15:35.357
> 
> 标签：ios, iphone-sdk-3.0

我正在尝试在 iOS 屏幕上出现视图之后立即制作动画 - 对用户可见。我原以为我可以把它放在 viewDidAppear 中；文档听起来像是在视图可见后立即调用它。但是，情况似乎并非如此—— viewDidAppear 在视图实际可见之前被调用。视图是以编程方式创建的，而不是从 nib 中创建的。这是一个抽象的例子：

```
sampleviewcontroller.m
@implementation sampleViewController
// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView {

    // setup a generic view 
    self.view = [[UIView alloc] initWithFrame:[UIScreen mainScreen].applicationFrame];
    self.view.backgroundColor = [UIColor blueColor];
}    

// View should be shown by now?
- (void)viewDidAppear:(BOOL)animated {

    [super viewDidAppear:animated];
    return; // set breakpoint here, but view is NOT visible in simulator at this point
} 
```

这将创建一个纯蓝色视图。但是，如果我在 viewDidAppear 中的返回行设置断点，则在到达断点时，该蓝色视图将不可见。它稍后会变得可见。

这是预期的吗？视图何时真正对用户可见？App Delegate 代码是股票 pregen 的东西：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

    // Override point for customization after app launch    
    [window addSubview:viewController.view];
    [window makeKeyAndVisible];

    return YES;
} 
```

如果这很重要，我正在使用较旧的 SDK（在 Snow Leopard 上）......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:41:19.143

我认为这都是关于应用程序循环的，当你在那个断点上时你将无法看到视图。确实，viewDidAppear 在视图可见时被调用，但在您将它与代码断点一起使用时不会调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:51:11.357

正如 user1851930 所说，运行循环被你的断点“停止”并且绘图还没有发生。如果您需要这种情况发生一次，请将动画延迟 0.0f（循环的一次迭代）

利用：

```
- (void)viewDidAppear {
    [self performSelector:@selector(delayedAppear) withObject:nil afterDelay:0.0f];
}

- (void)delayedAppear {
    //view has been drawn 
    // do stuff
} 
```

# javascript - 根据 getDay 和 getHours + getMinutes 显示 div

> ID：13556126
> 
> 赞同：2
> 
> 时间：2012-11-25T22:16:34.540
> 
> 标签：javascript, html, datetime

我正在为广播电台建立一个网站，并想显示当前正在播出的主持人。我已经构建了一个 Web 应用程序，其中包含有关演示者的数据：姓名、照片、简历和每个工作日的开始/结束时间。

```
<div id="presenter1">
    <div class="slot">
        <div id="sunday-off"> - </div>
        <div id="monday-afternoon">12:00 - 15:59</div>
        <div id="tuesday-afternoon">12:00 - 15:59</div>
        <div id="wednesday-afternoon">12:00 - 15:59</div>
        <div id="thursday-afternoon">12:00 - 15:59</div>
        <div id="friday-afternoon">12:00 - 15:59</div>
        <div id="saturday-morning">06:00 - 08:59</div>
    </div>
</div> 
```

我想做的是使用 Javascript 函数 getDay() 和 getHours() + getMinutes() 来仅显示根据应用程序中指定的时间安排播出的演示者。

我遇到困难的主要部分是确定此演示者是否在当前时间范围内，然后根据需要显示/隐藏 div。

任何有关我如何实现这一目标的帮助或指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:47:57.700

您可以按如下方式与 getHours 和 getDay 函数进行比较，您不必担心分钟函数，因为它们都位于小时的边界上。请记住那一天是从星期日开始索引的 0

```
//Hide all the divs up here
var d = new Date();
var weekday = d.getDay();
var hours = d.getHours();
//    between 12 and 6pm           From monday  to friday
if (hours >= 12 && hours < 18 && weekday > 0 && weekday < 6) {
   switch(weekday) {
      case 1:
          //Show monday
          break;
      case 2:
          //Show tuesday
          break;
      case 3:
          //Show wed
          break;
      case 4:
          //Show thur
          break;
      case 5:
          //Show fri
          break;
    }
//          Saturday         between 6 and 9
} else if (weekday == 6 && hours >=6 && hours < 9) {
  //Show saturday
} else if (weekday == 0) {
  //Show sunday
} 
```

编辑：根据您的要求，这是一个简单的模块化实现

```
var schedule = [
    {"starthour":12, "endhour":18, "weekday":1, "div":"div1"},
    {"starthour":18, "endhour":20, "weekday":1, "div":"div2"}
]
var d = new Date();
var weekday = d.getDay();
var hours = d.getHours();
var i;
for (i = 0; i < schedule.length; i++) {
    if (schedule[i].starthour >= hours && schedule[i].endhour < hours && schedule[i].weekday == weekday) {
        //Show schedule[i].div
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:25:48.127

如果您已经在使用 jQuery 库。我建议您使用日期库来更容易阅读代码并且更易于维护 [http://archive.plugins.jquery.com/project/jquery-dateFormat](http://archive.plugins.jquery.com/project/jquery-dateFormat)

```
timenow = $.format.date( new Date(), 'ddd h:mm a')
// returns Monday 6:22 AM

switch(timenow){
case 'Monday 1:00 PM':
    //do something
    break;
case 'Tuesday 3:00 PM':
    //do something
    break;
} 
```

那么如果它总是在一小时内，只需省略分钟。使用格式**'ddd h a'** 所以你可以用 SWITCH 编写你的 JavaScript

```
timenow = $.format.date( new Date(), 'ddd h a')
// returns Monday 6 AM

switch(timenow){
case 'Monday 1 PM':
case 'Monday 2 PM':
    //do something
    break;
case 'Tuesday 3 PM':
    //do something
    break;
} 
```

但是如果你不使用 jquery，而你只想使用 getDay()，纯 javascript

```
var days =["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
var d = new Date();
var hr = d.getHours() % 12;

timenow = days[d.getDay()] + ' ' + hr + (d.getHours() > 12?'PM':'AM')

// returns "Monday 2PM" 
```

注意事项：通过 AJAX 获取您当前的演示者来处理数据库

# encoding - 使用 FFMPEG 进行 H.264 编码 - 某些视频无法正常工作

> ID：13556129
> 
> 赞同：1
> 
> 时间：2012-11-25T22:16:43.073
> 
> 标签：encoding, ffmpeg, h.264

任何人都可以提供他们“最强大”的 FFMPEG 命令行来编码到 H.264 吗？我们尝试了一些，但有些视频不想打球。对不起，我手头没有确切的错误 - 只是希望得到别人的命令行，然后我花时间试图弄清楚哪种类型的视频没有编码，或者为什么。

多谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T06:14:14.593

这是我用于将视频编码为基线的 ffmpeg 命令行，以便它们在所有各种 iOS 硬件上播放：

```
ffmpeg -y -i $INPUT -c:v libx264 -pix_fmt yuv420p -preset:v slow -profile:v baseline -crf 20 $OUTPUT 
```

INPUT 通常是使用无损动画编解码器编码的 .mov 文件。输出就像“xyz.m4v”

# android - 管理 iphone 和 android 项目

> ID：13556130
> 
> 赞同：-2
> 
> 时间：2012-11-25T22:16:44.857
> 
> 标签：android, iphone

有哪些远程工具可以用来管理android和iphone/ipad？我应该使用自己的服务器来远程管理项目，还是购买特定的软件来远程管理项目？我还希望我的客户能够 24/7 全天候查看我的项目状态，并让我的小团队将当前版本的代码存储在服务器或远程软件上，以防开发人员离开项目。提前感谢大家的帮助！我知道这是一些很长的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:26:24.250

If you can live with using a hosting service then a cloud service like GitHub might be worth investigating. If you want full controll the you could set up a git repository on your server. If your developers use AIDE on Android devices then it supports git version controll. This will only provide you with source control though.

Br,
Arne

# javascript - 更好更快的评估方法？

> ID：13556136
> 
> 赞同：0
> 
> 时间：2012-11-25T22:17:35.063
> 
> 标签：javascript, performance, node.js

我想动态构建我的查询并使用以下代码段：

```
--snip--
module.exports = {

get : function(req, res, next) {
  var queryStr = "req.database.table('locations').get(parseInt(req.params.id))";

  if (req.params.id) {
    if (req.fields) {
      queryStr += '.pick(' + req.fieldsStr + ')';
    }

    console.log(queryStr);
    eval(queryStr).run(function(result) { 
      console.log(result);
      res.send(result);
    });
  } else if (!req.params.id) {
--snip-- 
```

但是引入 eval 会打开我的代码进行注入（req.fields 填充有 url 参数），我看到我的应用程序的响应时间从 7 毫秒增加到 11 毫秒

有没有更聪明的方法来完成我在这里所做的事情？

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T22:42:52.187

如果我理解正确，您应该使用以下内容：

```
--snip--
module.exports = {

get : function(req, res, next) {

  var queryResult = req.database.table('locations').get(parseInt(req.params.id));

  if (req.params.id) {
    if (req.fields) {
      queryResult = queryResult.pick.apply(queryResult, getFields(req.fieldsStr));
    }

    queryResult.run(function(result) { 
      console.log(result);
      res.send(result);
    });
  } else if (!req.params.id) {
--snip-- 
```

`getFields`类似的东西在哪里：

```
var fields = {
        'name': name,
        'address': address,
        'zipcode': zipcode
        // ...
    };

function getFields(str) {
    return str.split(',').map(function(u) {
        return fields[u];
    });
} 
```

当然，如果`req.fields`是一个字符串数组本身，你可以使用它而不是 split `req.fieldsStr`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:51:59.103

与每次（或大多数）注入一样，最好的解决方案是预先定义可能的字段列表。例如：

```
var predefined_fields = [ "id", "name", "age" ];

if (predefined_fields.indexOf( req.fieldsStr ) !== 0) {
    // do something
} 
```

此外，您可以将其推送到：`parseInt(req.params.id)`外部`queryStr`：

```
var id = parseInt(req.params.id);
var queryStr = "req.database.table('locations').get("+id+")"; 
```

这解决了第二次注入问题。

当然，将来它可能会变得有点复杂，所以我建议编写（或使用）某种查询生成器。

我不知道您正在使用的库，但它看起来就像您可以在没有字符串连接和 eval 的情况下简单地进行查询。毕竟这种`.run`方法代表着某种东西，对吧？这肯定会提高性能和安全性。

**编辑**看来您根本不需要这些字符串。这应该有效：

```
var query = req.database.table('locations').get(parseInt(req.params.id));
if (req.params.id) {
    if (req.fields) {
      query = query.pick( req.fieldsStr );
    }

    console.log(queryStr);
    query.run(function(result) { 
       console.log(result);
       res.send(result);
    });
} 
```

安全高效。:)

# jquery - chrome 扩展问题

> ID：13556137
> 
> 赞同：0
> 
> 时间：2012-11-25T22:17:53.397
> 
> 标签：jquery, google-chrome-extension

我的清单代码是

```
 {
  "name": "Sample",
  "description": "Sample demonstration",
  "version": "0.1",
  "minimum_chrome_version": "16.0.884",
  "permissions": [
    "experimental", "tabs","<all_urls>"
  ],
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
  "manifest_version": 2
} 
```

我的 popup.html 的代码是

```
<html>
<head>
<script src='popup.js'></script>
<script src='jquery.js'></script>
</head>
<body>
</body>
</html> 
```

popup.js 代码

```
$(document).ready(function() {
     $.post('http://localhost/LinkBook/index.php', {}, function(res){
                       console.log('res');
                    });   
    }); 
```

但它不起作用。帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T02:20:32.890

我已经为所有发布请求编写了一个示例框架，该框架经过了良好的测试并且工作了多年；您可以将其用作参考并更正您的代码

***清单.json***

```
{
  "name": "Sample",
  "description": "Sample demonstration",
  "version": "0.1",
  "minimum_chrome_version": "16.0.884",
  "permissions": [
    "experimental", "tabs","<all_urls>"
  ],
  "browser_action": {
    "default_icon": "icon.jpg",
    "default_popup": "popup.html"
  },
  "manifest_version": 2
} 
```

***popup.html***

```
<html>
<head>
<script src='transaction.js'></script>
</head>
<body>
</body>
</html> 
```

***popup.js***

```
function searchquotes(){

var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function(data) {
    if (xhr.readyState == 4) {
      if (xhr.status == 200) {
            console.log("Response is recieved");
        }
      } else {
        //callback(null);
      }
    }

var url = 'https://'+'somedomain.com/sompage.php';
xhr.open('POST', url, true);
xhr.send();

}
window.onload = searchquotes; 
```

**jQuery版本**

IMP：你不能`<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"> </script>`在你的代码中下载 jquery 并将它放在你的根文件夹中，有关更多信息，请检查[这个](https://developer.chrome.com/extensions/contentSecurityPolicy.html)（https://developer.chrome.com/extensions/contentSecurityPolicy.html）

***清单.json***

```
{
  "name": "Sample",
  "description": "Sample demonstration",
  "version": "0.1",
  "minimum_chrome_version": "16.0.884",
  "permissions": [
    "experimental", "tabs","<all_urls>"
  ],
  "browser_action": {
    "default_icon": "icon.jpg",
    "default_popup": "popup.html"
  },
  "manifest_version": 2
} 
```

***popup.html***

```
<html>
<head>
<script src='transaction.js'></script>
<script src='jquery.js'></script>
</head>
<body>
</body>
</html> 
```

***交易.js***

```
$(document).ready(function() {
     $.post("http://somedomain.com/sompage.php', {}, function(res){
                       console.log(res);
                    });   
    }); 
```

# html - css 将元素向右对齐

> ID：13556145
> 
> 赞同：1
> 
> 时间：2012-11-25T22:18:47.627
> 
> 标签：html, css

假设我有一个 div，其中有一个滑块和一个文本字段，例如：

```
<div>
    <!-- my slider -->
    <!-- my text field -->
</div> 
```

正如你在这里看到的：http: [//jsfiddle.net/rW24a/6/](http://jsfiddle.net/rW24a/6/)

如何将滑块对齐到我的 div 的右侧，以使其右侧与我的 textarea 右侧处于同一水平

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T22:33:29.120

添加这个CSS：

```
.slider
{
    float: right;
}
textarea
{
    width: 100%;
} 
```

[更新小提琴](http://jsfiddle.net/rW24a/9/)

# c# - 在 C# 中打开/读取/写入原始 USB 端口

> ID：13556146
> 
> 赞同：0
> 
> 时间：2012-11-25T22:18:54.707
> 
> 标签：c#, usb

我需要打开一个原始 USB 设备。我知道如何枚举 USB 设备，但是，我如何打开设备并读取/写入数据（最好是异步）？我看过其他帖子，但是，我真的不需要类库吗？

# symfony - Symfony 2 文件上传：guessExtension() 不适用于 .docx 文件

> ID：13556150
> 
> 赞同：3
> 
> 时间：2012-11-25T22:19:10.660
> 
> 标签：symfony

```
public function preUpload()
{
    if (null !== $this->file) {
        $this->path = $this->file->guessExtension();

    }
} 
```

这不适用于 .docx 文件。

我得到一个名为“myfile”的文件。-> 没有扩展名。

如何处理？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-05-08T12:25:07.367

我认为你必须使用：

getClientOriginalExtension()

因为您想获取原始名称的扩展名，而不是文件在服务器中的临时名称。

[http://api.symfony.com/2.4/Symfony/Component/HttpFoundation/File/UploadedFile.html](http://api.symfony.com/2.4/Symfony/Component/HttpFoundation/File/UploadedFile.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T00:18:39.230

采用

```
 getExtension() 
```

作为后备？

[Symfony API](http://api.symfony.com/2.0/Symfony/Component/HttpFoundation/File/File.html#method_getExtension)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-05T20:01:34.993

我在 symfony 核心文件中发现了一个错误，它缺少 .xls 文件的 mimeType。

我们有相同的行为：GuessExtension 将返回 null。

我和我的团队将其缩小到一个列出 symfony 的 mime 类型的数组。

这是我在另一个问题上回答的相同解决方案的链接： [https ://stackoverflow.com/a/36435844/3980097](https://stackoverflow.com/a/36435844/3980097)

您将找到 MimeTypeExtensionGuesse.php 的确切路径

在您的情况下，缺少的 mime 类型可能是：

```
'application/vnd.openxmlformats-officedocument.wordprocessingml.document' => 'docx', 
```

我希望这有帮助！

# php - PHP替换多维数组键

> ID：13556151
> 
> 赞同：0
> 
> 时间：2012-11-25T22:19:21.823
> 
> 标签：php, multidimensional-array, array-key

我想替换一些键，我的数组是：

```
Array
(
    [0] => Array
        (
            [0] => test1
            [1] => test2
            [2] => test3
            [3] => test4
            [4] => test5
            [5] => test6
        )

    [1] => Array
        (
            [0] => test7
            [1] => test8
            [2] => test9
            [3] => test10
            [4] => test11
            [5] => test12
        )

) 
```

我的希望：

```
Array
(
    [45] => Array
        (
            [0] => test1
            [1] => test2
            [2] => test3
            [3] => test4
            [4] => test5
            [5] => test6
        )

    [51] => Array
        (
            [0] => test7
            [1] => test8
            [2] => test9
            [3] => test10
            [4] => test11
            [5] => test12
        )

) 
```

图 45 和 51 是示例。

我怎样才能做到这一点？我尝试了 array_flip() 然后 array_search() 但 PHP 说：“只能翻转 STRING 和 INTEGER 值！”

不管怎么说，还是要谢谢你。问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T22:27:11.670

```
$old_array = array(
    0 => array(0=>'test1',1=>'test2',2=>'test3',3=>'test4',4=>'test5',5=>'test6'),
    1 => array(0=>'test1',1=>'test2',2=>'test3',3=>'test4',4=>'test5',5=>'test6')
);
$new_array = array(
    45=>$old_array[0],
    51=>$old_array[1]
);
var_dump($new_array); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:28:11.650

可以通过将新键设置为旧键的值然后取消设置旧键来修改数组中的键。

```
$myArray = array(
    "0" => array("0" => "test1", "1" => "test2"),
    "1" => array("0" => "test3", "1" => "test4"));

echo "original array:\n";
var_dump($myArray);

// modify keys
$myArray["45"] = $myArray["0"];
unset($myArray["0"]);
$myArray["51"] = $myArray["1"];
unset($myArray["1"]);

echo "modified array:\n";
var_dump($myArray); 
```

生成：

```
original array:
array(2) {
  [0]=>
  array(2) {
    [0]=>
    string(5) "test1"
    [1]=>
    string(5) "test2"
  }
  [1]=>
  array(2) {
    [0]=>
    string(5) "test3"
    [1]=>
    string(5) "test4"
  }
}

modified array:
array(2) {
  [45]=>
  array(2) {
    [0]=>
    string(5) "test1"
    [1]=>
    string(5) "test2"
  }
  [51]=>
  array(2) {
    [0]=>
    string(5) "test3"
    [1]=>
    string(5) "test4"
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:39:56.893

```
$keys = array('45','51');
$count = 6 ;
$i = 0;
foreach($keys as $key){
   for($l = 0;$l<$count;$l++){
      $last[$key][$l] = 'test'.$l+$i+1 ;
   }
  $i += $count;
}
print_r($last); 
```

将 $count 设置为您想要的任意数量的数组。

# jquery - Adobe Edge：从 html 页面控制特定符号

> ID：13556152
> 
> 赞同：1
> 
> 时间：2012-11-25T22:19:25.493
> 
> 标签：jquery, adobe-edge

**我需要从我的HTML 页面**（index.html - 而不是 edgeActions.js 页面）控制我的边缘符号之一

例如，我有一个图像符号：“sym1”，我想从主 html 页面中隐藏它。我试过：

sym.$("sym1").hide();

但它不起作用..

这是我可以使它工作的唯一方法（仅在 edgeActions 页面中）：

```
 Symbol.bindElementAction(compId, symbolName, "document", "compositionReady", function(sym, e) {
         var ex1 = sym.$( "sym1" );         

         yepnope({
            both: [
                "libs/jquery-ui.min.js",
                "libs/jquery-ui.css",
            ],
            callback: function() {

         ( ex1 ).hide();
            }
         });

      }); 
```

我需要了解如何使用 JQuery 从主 html 页面控制符号。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T09:16:03.297

在边缘程序之外抓取符号需要您做的不仅仅是调用“符号”。因此，让我向您介绍如何获取符号：

`1st`- 您必须获得对特定组成的参考。这通常是#Stage 元素上的类。如果您没有在 Edge Animate 中为其指定特定名称，则默认名称将类似于 EDGE-1230930194 之类的奇怪名称。

```
var myAnim = AdobeEdge.getComposition("nameOfComposition"); 
```

`2nd`- 你需要抓住特定的符号

```
var mySymbol = myAnim.getSymbols("nameOfSymbol")[0]; // Because it's in an array 
```

那里有它！你得到了自己的象征。例如，如果您想反向播放它，那么您可以这样做：

```
mySymbol.playReverse(); 
```

为了更精细的操作，更有趣的事情是像这样抓取底层元素：

```
var mySymbolElem = mySymbol.getSymbolElement(); 
```

然后当然你可以使用任何 jQuery 方法来解决它：

```
mySymbolElem.fadeOut(5000, function(){alert("alerts rox")}); 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T07:14:19.430

Edge 渲染到 html 页面后，所有符号将与新的 id 名称合并，并由“_”连接。例如，如果您要更改名为“thumb01”的符号的图像：

```
$('#Stage_thumb01').css('background-image',  'url('thumb_img_02.jpg')'); 
```

“Stage”是 Edge html 的根默认容器

# php - 从 imap 获取电子邮件并转换为 UTF-8

> ID：13556153
> 
> 赞同：0
> 
> 时间：2012-11-25T22:19:54.460
> 
> 标签：php, encoding, utf-8, imap, pop3

我在使用 php 和 imap 获取电子邮件时遇到了一些问题。每个发件人都会发送以不同字符集编码的电子邮件，因此很难为我制定一个通用的解决方案。

如果我想在不丢失数据的情况下将 from、to、subject 和 body/html 提取到 UT​​F-8 字符串中，如何最简单地完成？

我已经尝试了几个小时寻找解决方案，但我当前的代码并没有解决问题。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:25:44.950

您不能只说“从 imap 获取电子邮件并将其转换为 utf-8”。您需要使用以下方式获取电子邮件部分：

```
$struct = $this->imap_fetchstructure($this->mbox, $mId, FT_UID); 
```

然后从该电子邮件中选择您要做什么。在你决定了你需要什么之后，然后像这样说 converto to that 和 that：

```
if($partStruct->encoding == 1) {
    $data = $this->imap_utf8($data);
}
elseif($partStruct->encoding == 2) {
    $data = $this->imap_binary($data);
}
elseif($partStruct->encoding == 3) {
    $data = $this->imap_base64($data);
}
elseif($partStruct->encoding == 4) {
    $data = $this->imap_qprint($data);
} 
//etc..... 
```

我只是从我的课堂上复制/粘贴其他部分，你必须自己弄清楚！如果您正在为此寻找简单的解决方案，让我告诉您没有。您可以随时从 Internet 下载一些 imap php 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:23:30.800

您可以尝试使用该`mb_detect_encoding()`功能： http: [//php.net/manual/en/function.mb-detect-encoding.php](http://php.net/manual/en/function.mb-detect-encoding.php)

然后`mb_convert_encoding()`： http: [//php.net/manual/en/function.mb-convert-encoding.php](http://php.net/manual/en/function.mb-convert-encoding.php)到 UTF-8。

您还可以检查电子邮件标头，查找 Content-Type 标头，请参见示例：

```
Content-Type: text/html; charset="UTF-8" 
```

# javascript - 如何在 Grails 资源插件中指定通配符资源模式？

> ID：13556159
> 
> 赞同：2
> 
> 时间：2012-11-25T22:20:50.010
> 
> 标签：javascript, grails, resources, bundle

Grails 资源插件允许您定义模块，并将一堆文件捆绑到一个模块中。

假设我想要一个模块来收集我的 /js/models 文件夹中的所有文件，并将它们放在一个名为 model 的模块包中

我将如何指定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:26:43.727

我偶然发现了同样的事情......

SO上有一个公认的答案：[Link](https://stackoverflow.com/questions/10520693/resources-plugin-how-to-include-all-contents-in-a-directory)

以及对资源插件的功能请求，其中包含一些好的想法：[链接](http://jira.grails.org/browse/GPRESOURCES-90)

# objective-c - 调用 makeViewWithIdentifier:owner: 导致 ARC 重新创建 ivar

> ID：13556165
> 
> 赞同：2
> 
> 时间：2012-11-25T22:21:28.060
> 
> 标签：objective-c, automatic-ref-counting, nstableview

我正在编写一个带有基于视图的 NSTableView 的沙盒 ARC 应用程序，该应用程序接受拖放文件（`NSURL`s）。`NSTableViewDelegate`我在以下方法中遇到了一些重大的奇怪现象：

```
- (NSView *)tableView:(NSTableView *)tv
   viewForTableColumn:(NSTableColumn *)tc
                  row:(NSInteger)row
{
    // `files' is an NSMutableArray* ivar containing NSURLs
    // that have been dropped into this table
    NSURL *url = [files objectAtIndex:row];
    NSString *fileName = [url lastPathComponent];
    NSImage *icon = [self iconForURL:url];

    NSTableCellView *view = [tv makeViewWithIdentifier:[tc identifier] owner:self];
    [[view textField] setStringValue:fileName];
    [[view imageView] setImage:icon];

    return view;
} 
```

我可以将一个文件拖到表格视图中，它可以正确显示。当我拖动第二个文件时，出现此错误：

```
*** 取消拖动，因为在拖动会话期间引发了异常 'NSRangeException'（原因 '*** -[__NSArrayM insertObject:atIndex:]: index 1 beyond bounds for empty array'）
```

通过调试器，我发现`files`在调用`makeViewWithIdentifier:owner:`. 我认为这是我不理解的 ARC 的某些方面，但在我看来，该对象强烈引用了它自己的 ivar（默认情况下）；它怎么能从我下面被释放和重新创造出来？

我想出了两个技巧来解决这个问题：

1.  将 ivar 作为表格单元格视图的所有者传递（希望在未来的版本中它将继续保持强引用）；或者
2.  创建一个局部变量以指向 ivar 的对象并将 ivar 重新分配给旧对象（这显然是浪费，因为它同时创建了一个替换数组）。

我在这里想念什么？这些变通方法应该不是必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T12:09:51.737

调用 -makeViewWithIdentifier:owner: 将导致向所有者发送 -awakeFromNib 消息。这已记录在案，但仅在头文件中（编辑：主文档已更新以引用此文件）。

我想你的文件数组只是在 -awakeFromNib 中重新初始化。

给定情况下的解决方案（加载视图原型而不是 nib）只是将 nil 作为所有者传递。加载已注册 nib 的其他实现（请参阅 -registerNib:forIdentifier:）可能需要所有者，该所有者可能是委托人（或不是委托人）。`-awakeFromNib`因此，可能必须检测和捕获多个调用。设置一个属性来标记 nib 加载并且只执行一次所需的初始化是微不足道的。

请注意，此方法的 Apple 文档已更新以反映这一点：

> 请注意，每次调用此方法时都会调用 awakeFromNib，这意味着即使所有者已经醒来，也会在所有者上调用 awakeFromNib。

# java - 服务器抛出 java.lang.OutOfMemoryError

> ID：13556170
> 
> 赞同：-4
> 
> 时间：2012-11-25T22:21:44.903
> 
> 标签：java, out-of-memory

我有一个基于 java 的服务器，它假设**不是**内存密集型的。服务器正在调试模式下运行（使用 jvm -Xdebug 标志）。

我只是想知道在这种（调试）模式下运行 java 应用程序是否会导致 OutOfMemoryError？

谢了，兄弟们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:32:03.417

你用那个标志做什么？远程调试？好吧，可能会附加一个调试器，它会保留内存对象，这样做可能会产生额外的内存和 cpu 开销，但通常不会超出它创建 OutOfMemoryErrors 的程度。

对于第一次 stab，激活 -XX:+HeapDumpOnOutOfMemoryError 并查看使用 Eclipse MAT 生成的转储文件。然后你会看到是什么在消耗内存，并可以计划你的下一步。

# julius-speech - 在 Julius 语音识别上触发脚本或外部程序

> ID：13556171
> 
> 赞同：1
> 
> 时间：2012-11-25T22:21:45.710
> 
> 标签：julius-speech

我正在尝试在 ubuntu 上使用 Julius。几个小时后，我终于开始工作了。

基本上，我唯一需要它做的就是在它识别出某个单词（例如“计算机”）时触发脚本。这是主要问题。最好的方法是什么？

此外，我似乎无法以“安静”模式运行 Julius

```
$ julius -quiet -input mic -C julian.jconf 2>/dev/null 
```

仍然输出太多信息：

```
 ..........
          reject short input = off

----------------------- System Information end -----------------------

    *************************************************************
    * NOTICE: The first input may not be recognized, since      *
    *         no initial CMN parameter is available on startup. *
    * for MFCC01*
    ************************************************************* 
```

> Stat：以 16000Hz 捕获音频
> 
> 统计：adin_alsa：延迟设置为 32 毫秒（块 = 512 字节）
> 
> 错误：adin_alsa：无法从卡控制中获取 pcm 信息
> 
> 警告：adin_alsa：跳过详细音频设备信息的输出
> 
> STAT：已创建 AD-in 线程
> 
> 警告：剥离：样本 0-27 的值为零，已剥离
> 
> pass1_best: ~~DOWarning: strip: sample 192-444 has zero value, stripped~~
> 
> pass1_best：~~玩~~
> 
> 句子1：~~玩~~
> 
> pass1_best：
> 
>  ~~~~句子1：玩~~
> 
> pass1_best:Warning: strip: sample 406-436 has zero value, stripped~~

 ~~```
 .... 
```

等等。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-23T09:45:04.367

通常我们会从脚本中调用 Julius，将 Julius 的输出读取到一个变量中，我们可以在其中隐藏所有内容并使用子字符串和切片仅提取所需的内容。通过这种方式，您可以使用适合您目的的任何应用程序（例如 PHP、Julia、Python 等）构建所谓的“对话管理器”，并根据 Julius 认为它​​从 a `switch`or`if .. then .. else`结构中听到的内容采取行动。

一个简单的方法是使用一个无限循环，它只在诸如“COMPUTER QUIT”或类似的命令上退出。

如果您收到大量警告，该`julius`选项会很有帮助。`-nostrip``nostrip`

一旦你有一些经验，在服务器模式下`julius`运行真的很有帮助`julius`（在文档中描述 [在[https://github.com/julius-speech/julius](https://github.com/julius-speech/julius)上提供的多个链接以及示例应用程序），它允许你更有效地控制`julius`，而无需在识别事件之间重新加载。此外`julius`，将以 XML 格式发送响应，以便您可以在对话管理器中使用经过测试的 XML 阅读器可靠地读取输出。~~

# c - 使用头文件修复 GCC 中的编译器错误

> ID：13556175
> 
> 赞同：0
> 
> 时间：2012-11-25T22:22:17.787
> 
> 标签：c, pointers, header-files

我在课堂上收到的关于创建头文件的解释有些不清楚。我的教授说，创建一个头文件，你要包含函数原型。我不断收到包含指针标记的函数原型的错误。我的头文件：

```
#ifndef A3_H
#define A3_H

void list_init(record_list*);
void list_destroy(record_list*);
int  list_insert(record_list*, const record*);
int input_record(record*);

#endif 
```

我收到的错误是：

```
$ gcc -ansi -W -Wall -pedantic -c a3.c
In file included from a3.c:4:0:
a3.h:4:27: error: expected ‘)’ before ‘*’ token
a3.h:5:30: error: expected ‘)’ before ‘*’ token
a3.h:6:29: error: expected ‘)’ before ‘*’ token
a3.h:7:24: error: expected ‘)’ before ‘*’ token 
```

我不能在头文件的函数原型中包含指针吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T22:23:15.957

是的，你可以在头文件中有指针，但看起来你还没有定义`record`或`record_list`任何地方。

# java - Java FileWriter() 与 createNewFile()？

> ID：13556176
> 
> 赞同：1
> 
> 时间：2012-11-25T22:22:26.710
> 
> 标签：java, api, java-7, filewriter

使用 FileWriter() 类和构造函数而不是 File 类中的 createNewFile() 方法是否有优势？

我无法弄清楚差异或优势。createNewFile() 似乎更简单、更直观，所以我正在考虑放弃使用 FileWriter，但我想检查一下。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T22:24:47.993

[File.createNewFile()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#createNewFile%28%29)只创建一个空文件。A`FileWriter`还允许您将基于字符的数据写入文件。

使用最直接和最明显的方法。如果你想要一个空的新文件，前者可以正常工作。任何更复杂的事情通常都会涉及某种`Writer`或`OutputStream`某种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:32:48.267

如果您只需要创建一个空文件，请使用[`File.createNewFile()`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#createNewFile%28%29). 如果您需要写入文件，请使用[`FileWriter`](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html). 构造函数[`FileWriter(String fileName, boolean append)`](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.lang.String,%20boolean%29)具有`append`布尔参数，这在大多数情况下很有用。

但是，我建议使用[`PrintWriter`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html)而不是使用[`FileWriter`](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html)将基于字符的数据写入文件，因为它有用的方法，例如[`println()`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html#println%28%29).

# mysql - MySQL 唯一列字符串

> ID：13556177
> 
> 赞同：5
> 
> 时间：2012-11-25T22:22:37.437
> 
> 标签：mysql, sql, primary-key, unique, unique-key

目前我的数据库中有这个表：

```
CREATE TABLE `twMCUserDB` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `mc_userName` text NOT NULL,
  `mc_userPass` text NOT NULL,
  `tw_userName` text NOT NULL,
  `tw_userPass` text NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1; 
```

我希望该列`mc_userName`也是唯一的（就像`id`），但`mc_userName`必须是一个字符串。

我试图使它也成为主键，但这没有用。

当我向表中添加数据时，我是否首先必须检查是否`mc_userName`已经存在？或者我可以使用 MySQL 中的任何内置函数（在插入查询中或其他地方）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T22:56:13.050

只需添加`UNIQUE`

```
`mc_userName` text NOT NULL UNIQUE, 
```

或者

```
CREATE TABLE `twMCUserDB` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `mc_userName` text NOT NULL,
  `mc_userPass` text NOT NULL,
  `tw_userName` text NOT NULL,
  `tw_userPass` text NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT tb_uq UNIQUE (mc_userName)
) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:31:09.507

你为什么不把'mc_userName'作为主键而不是id？您必须将 mc_userName 的数据类型更改为 VARCHAR，如本文所述：[MySQL 错误：没有密钥长度的密钥规范](https://stackoverflow.com/questions/1827063/mysql-error-key-specification-without-a-key-length)。或者，创建一个包含 id 和用户名的复合主键。

如果由于数据库的设计而无法执行此操作，请在查询中使用 EXISTS 关键字。在这里查看更多信息：[http ://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html](http://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html)

# image-processing - 获取 pnp 或 posit 的 2d-3d 点对应关系

> ID：13556183
> 
> 赞同：1
> 
> 时间：2012-11-25T22:23:11.750
> 
> 标签：image-processing, pattern-matching, pose-estimation

我正在尝试在给定卫星图像的情况下估计卫星的姿势和位置。我有卫星的 3D 模型。当我自己挑选点对应关系时，使用 PnP 求解器或 POSIT 效果很好，但是我需要找到一种方法来自动匹配点。使用角点检测器（目前我发现的最好的检测器是基于轮廓的）我可以找到图像中的所有相关点以及一些虚假点。但是，我需要将图像中的给定点与 3D 模型中的正确点相匹配。我读过的关于这个主题的文章似乎总是假设我们已经找到了点对，而没有详细说明如何做到这一点。

通常有没有什么方法可以根据一些不变的特征来确定这些对应关系？还是我应该采用不基于角点的不同方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T14:05:00.757

You can have a look at the SoftPOSIT algorithm, which determines 3D-2D correspondences and then executes POSIT algorithm. As far as I know Matlab code is available for SoftPOSIT.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T19:48:23.190

您必须使用 RANSAC 进行 PnP，请参阅 openCV 代码[solvePnPRansac()](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=calib#solvepnp)。这种方法可以容忍高百分比的不匹配，因此您不需要对所有匹配都精确，而只需要一定百分比的正确匹配（甚至低至 30%）。当然，正确对应的最小数量是 4。

说到不变特征——如果相邻帧之间的旋转量很小，则不需要使用不变特征。即使是一小块带有灰色强度的补丁也足以找到匹配项。唯一的问题是您必须更新描述符，甚至根据模型旋转在模型上选择不同的特征点。后者可能很难做到，因为您必须知道每个要素的 3D 坐标。

# ios - 显示 tesseract 版本 (iOS)

> ID：13556188
> 
> 赞同：1
> 
> 时间：2012-11-25T22:23:19.053
> 
> 标签：ios, tesseract

我终于设法为 iOS 编译了一个 tesseract 库。我已经用 3.02.02 替换了 3.01，并且想知道是否有人知道如何显示 tesseract 版本（我只是想确保它真的更新了）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T00:47:28.727

`TessBaseAPI`有一个方法，`static const char* Version()`“[r] 将版本标识符作为静态字符串返回”。因此，您只需要记录它，将其放入`UILabel`via eg `[NSString stringWithFormat:@"%s", yourTesseractInstance->Version()]`，或通过任何其他方式输出即可。

# java - 如果只给出事件点，如何绘制图表？

> ID：13556189
> 
> 赞同：1
> 
> 时间：2012-11-25T22:23:19.803
> 
> 标签：java, excel, graph, d3.js, diagram

我正在尝试绘制节点（机器）的可用性。为了节省收集到的数据的存储空间，而不是按固定间隔记录数据，我根据事件（添加、删除）记录它们。ADDED 表示“向上”，REMOVED 表示“向下/无法访问”

这是我拥有的示例数据：

```
2012-11-25 11:11:11.1234 - node added.
2012-11-25 15:01:20.1234 - node removed.
2012-11-25 18:12:12.1234 - node added. 
```

假设，我想从时间范围内绘制图表：2012-11-24 到 2012-11-25（x 轴），向上/向下（y 轴），我该如何绘制图表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T02:58:38.003

如果您将所有数据存储在一个数组中，只需使用 JavaScript 的内置[`Array.filter`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)方法，并使用 JavaScript 的[`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象将时间戳转换为毫秒（请注意，它将四舍五入到最接近的千分之一秒 - 只有 3 个小数位）。

```
var startTime = Date.parse("2012-11-24"),
    endTime = Date.parse("2012-11-25") + 86400000; /* Add one day */

filteredData = data.filter(function(d) {
    var time = Date.parse(d.time);
    return (time >= startTime && time < endTime);
}); 
```

您可能需要使用日期范围，我假设您的意思是您想要介于 2012-11-24 和 2012-11-25 之间的数据。

* * *

如果您的数据在数据库中，另一种方法是简单地查询数据库以仅显示存在于时间范围内的数据（您可以调用一些 PHP 脚本 - 使用[`d3.text`](https://github.com/mbostock/d3/wiki/Requests#wiki-d3_text)- 输出 JSON 并接受两个 GET 参数 startTime 和 endTime ）。

```
d3.text("getNodes.php?startTime=" + startTime + "&endTime=" + endTime, function(json) {
    filteredData = JSON.parse(json);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:03:20.060

我认为在 d3 工具（http://d3js.org）中有一些例子（我不记得是哪一个）

如果您浏览示例，您可以选择要使用的可视化类型。我认为您拥有的数据集将与您尝试执行的操作相匹配（您可能需要编写一个小运算符来将向上/向下注释转换为整数）。

# javascript - Window.open 如果窗口未打开，则调用另一个函数 + 计时器

> ID：13556191
> 
> 赞同：0
> 
> 时间：2012-11-25T22:23:38.350
> 
> 标签：javascript

我使用以下代码使用 window.open 打开一个新窗口，如果有人手动关闭窗口，它将调用 pause() 函数。

```
 <script type="text/javascript">

        var win = window.open("link.html", "thePopUp", "");
            var pollTimer = window.setInterval(function() {
if (win.closed !== false) { // !== is required for compatibility with Opera
    window.clearInterval(pollTimer);
    pause();
}
}, 200);

    </script> 
```

但是要使该 pause() 功能正常工作，用户将需要允许窗口的弹出窗口首先打开然后手动关闭它。

如果窗口从未打开过，我希望调用 pause() 函数，即使它们不允许弹出窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:36:08.657

我建议不要使用弹出窗口，而是使用 javascript 模式弹出窗口。

这是一个演示：

*   [http://www.jacklmoore.com/demo/modal/modal2.html](http://www.jacklmoore.com/demo/modal/modal2.html)
*   [http://www.jacklmoore.com/colorbox/example1/](http://www.jacklmoore.com/colorbox/example1/)
    *   `Outside HTML (Ajax)`将是你最好的例子。查看源代码以了解如何调用它，如果这是您想要的。

有很多选择。这里有几个 jquery 选项：

*   [http://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)
*   [http://jqueryui.com/dialog/#modal](http://jqueryui.com/dialog/#modal)

我希望这有帮助。如果您需要更多帮助，请告诉我。

# java - Android 振动器（不工作）

> ID：13556192
> 
> 赞同：1
> 
> 时间：2012-11-25T22:23:41.403
> 
> 标签：java, android, android-activity

当用户按住图像一秒钟左右时，我试图让 Android 振动器脉冲一次。

我已经在我的清单文件中添加了它的权限。

我认为问题在于我没有从活动内部调用代码，我正在创建一个游戏，因此代码是从 onTouch 函数中运行的。

我已经尝试过（以及以下的一些组合）：

```
Vibrator v  = (Vibrator) Context.getSystemService(VIBRATOR_SERVICE); 
```

那就是说它不能从 String 转换为 Vibrator 类，我不明白为什么！我认为这与在活动之外调用的代码有关 - 解释为什么这是一个问题的奖励积分！

谢谢。

# java - 我的 Android 单例被破坏了

> ID：13556197
> 
> 赞同：0
> 
> 时间：2012-11-25T22:24:08.823
> 
> 标签：java, android, singleton

对于以下问题，我会很感激。我正在编写一个与远程服务器通信的android应用程序，该应用程序带有登录屏幕，在用户登录后，我希望通过整个应用程序、用户信息、用户工作的部门等可以访问一些重要的信息，
在阅读了最好的实现之后，我决定通过扩展应用程序类来使用单例。这是一个例子。

```
public class UsuarioCustom extends Application {

 private Usuario usuario;
 private Location posicionActual;   
 private Delegacion department;
 private RutaCustom rutaActual;          

     //getters and setters ....
} 
```

应用程序的要求之一是必须每 10 分钟发送一次用户的当前位置，因此该应用程序需要保持运行一段时间。

我正在测试应用程序，并且不时崩溃，显示应用程序已停止的窗口。

我调试了de应用程序，我意识到在某些时候android将我的单例类设置为null。我在网上读到这是android中的一个常见问题......

例如，如果我启动我的应用程序，然后将手机调到飞行模式，然后回到我的应用程序，你可以看到我的单例是如何为空的。

我在网上阅读了有关 android 上的单例类的信息，有人说最好使用 servive，但似乎官方的 android sdk 文档在这里缺少一些有用的信息。

**我正在考虑将信息保存在 sqllite 上，所以每次我想使用我的单例类时，我都会检查是否为空，如果是，我会从 sql litte 重新加载它。**

有人可以就处理该问题的最佳方法提供一些不错的提示吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:15:07.560

After searching the web , I finally decided to save the important imformation on the sqllite. Seems like in an Android enviroment u can not trust that u can save data on memory for a long time, soon or later Android will delete the informatión even if you create a singleton by extending the Application class.

# javascript - 如何在没有 jQuery 的情况下设置属性

> ID：13556200
> 
> 赞同：3
> 
> 时间：2012-11-25T22:24:25.793
> 
> 标签：javascript

我想在没有 jQuery 的情况下将属性设置为标记。

我必须动态设置它。

我知道在 jQuery 中你只是做 $('html') 但没有 jQuery，我试过`Document.getElementById('html')`但不起作用。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T22:26:19.713

在一般情况下，标准 DOM 等价`jQuery('element_name');`于`document.getElementsByTagName('element_name');`. 请注意，它返回一个*NodeList*（就像一个数组）而不仅仅是一个*HTMLElementNode*。

HTML 元素作为根元素，可以通过`document.documentElement`.

可以使用*HTMLElementNode*`setAttribute('attribute_name', 'attribute_value');`上的方法设置属性值。该方法在旧版本的 Internet Explorer 中存在缺陷，因此您可能希望使用等效的 DOM 属性。

 *例如，要替换`class`属性的值：

```
document.documentElement.className = "foo bar baz"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T22:33:49.560

```
document.getElementsByTagName('html')[0].setAttribute('name','value'); 
```*

# c - 计算字符串中的单词？

> ID：13556203
> 
> 赞同：1
> 
> 时间：2012-11-25T22:24:31.080
> 
> 标签：c, parsing

您好，对于这个程序，我应该计算字符串中的单词数。到目前为止，我已经找到了如何查找字符串中的字符数，但无法弄清楚如何将组成单词的字母转换为 1 个单词。

我的功能是：

```
int wordcount( char word[MAX] ){

    int i, num, counter, j;

    num = strlen( word );
    counter = 0;

    for (i = 0; i < num; i++)
    {
        if (word[i] != ' ' || word[i] != '\t' || word[i] != '\v' || word[i] != '\f')
        {

        }

    }

    return counter;
} 
```

我尝试了一些变体，但 if 语句的中间部分是我感到困惑的地方。如何计算字符串中的单词数？测试这个测试字符串是否有多个空格，比如“你好，这是一个字符串”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:28:40.917

仅提示，因为这可能是家庭作业。

您要计算的是“单词”字符和空格之间的转换次数。这将需要记住最后一个字符并将其与当前字符进行比较。

如果一个是空白而另一个不是，则您有一个过渡。

有了更多细节，初始化`lastchar`为空白，然后遍历输入中的每个字符。如果`lastchar`是空格而当前字符不是，则增加字数。

不要忘记`lastchar`在每次循环迭代结束时将当前字符复制到。并且希望不用说字数应该初始化为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T22:34:19.273

有一个可以计算单词的 linux util 'wc'。

看看（它包括一些解释和示例）：

[http://en.literateprograms.org/Word_count_(C)](http://en.literateprograms.org/Word_count_(C))

和源链接

[http://en.literateprograms.org/index.php?title=Special:DownloadCode/Word_count_(C)&oldid=15634](http://en.literateprograms.org/index.php?title=Special:DownloadCode/Word_count_(C)&oldid=15634)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:31:00.217

当你在 if 部分时，这意味着你在一个单词中。因此，您可以标记它`inword`并查看您是否从字外（这将是您的 else 部分）更改为`inword`和返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T23:00:03.580

这是一个快速的建议——可能有更好的方法，但我喜欢这个。

首先，一定要“知道”一个词是由什么组成的。让我们假设它仅由字母组成。所有其余的，标点符号或“空格”，都可以视为分隔符。

然后，您的“系统”有两种状态：1）完成一个单词，2）跳过分隔符。

您以自由运行跳过分隔符代码开始您的代码。然后您进入“完成一个单词”状态，您将一直保持到下一个分隔符或整个字符串的结尾（在这种情况下，您退出）。当它发生时，您已经完成了一个单词，因此您将单词计数器增加 1，然后进入“跳过分隔符”状态。循环继续。

伪类 C 代码：

```
char *str;

/* someone will assign str correctly */

word_count = 0;
state = SKIPPING;

for(c = *str; *str != '\0'; str++)
{
    if (state == SKIPPING && can_be_part_of_a_word(c)) {
        state = CONSUMING;
        /* if you need to accumulate the letters, 
           here you have to push c somewhere */
    }
    else if (state == SKIPPING) continue; // unneeded - just to show the logic
    else if (state == CONSUMING && can_be_part_of_a_word(c)) {
        /* continue accumulating pushing c somewhere 
           or, if you don't need, ... else if kept as placeholder */
    }
    else if (state == CONSUMING) {
        /* separator found while consuming a word: 
           the word ended. If you accumulated chars, you can ship
           them out as "the word" */
        word_count++;
        state = SKIPPING;
    }
}
// if the state on exit is CONSUMING you need to increment word_count:
// you can rearrange things to avoid this when the loop ends, 
// if you don't like it
if (state == CONSUMING) { word_count++; /* plus ship out last word */ } 
```

例如，如果读取的字符在 [A-Za-z_] 中，则函数 can_be_part_of_a_word 返回 true，否则返回 false。

（如果我没有在疲劳的教唆上犯下一些严重的错误，它应该可以工作）

# eclipse - eclipse m2e：导入maven项目后无法打开声明

> ID：13556205
> 
> 赞同：5
> 
> 时间：2012-11-25T22:24:42.930
> 
> 标签：eclipse, import, m2e

好的，情况很简单，所以我不确定问题出在哪里，我已经花了三个多小时的调试，但没有运气！

我从 GitHub（使用 git）克隆了一个 maven 项目到 ~/workspace/MyCompany/MyProject。

然后我做了`File`-> `Import...`->`Existing Maven Projects`然后选择 MyProject 作为根目录。

看起来导入是成功的，但 eclipse 不识别任何类，`String`甚至`ArrayList`! 每当我右键单击并选择`Open Declaration`时，都会收到以下错误消息：

> 打开编辑器时出现问题。原因：project_name 不存在。

我正在使用 eclipse Juno 和 m2e 1.2.0。m2e 是通过 Help->Install New Software... 安装的

# matlab - CPLEX + YALMIP——“未找到求解器”？

> ID：13556208
> 
> 赞同：5
> 
> 时间：2012-11-25T22:24:51.417
> 
> 标签：matlab, ubuntu, mathematical-optimization, linear-programming, cplex

我正在尝试开始使用[YALMIP](http://users.isy.liu.se/johanl/yalmip/pmwiki.php?n=Tutorials.Installation)，它是优化求解器（如[CPLEX](http://www-01.ibm.com/software/integration/optimization/cplex-optimizer/) ）的 Matlab 接口。我有一个目标函数`obj`和约束`cons`，我已经将它们插入 Yalmip ......

```
options=sdpsettings('solver','Cplex'); %windows needs uppercase 'Cplex' and unix is ok with 'cplex' or 'Cplex'
solvesdp(cons,obj,options); %prints 'Warning: Solver not found' 
```

在上面的代码中，`solvesdp`打印出**警告：未找到求解器**。`.m`包含`obj`、`cons`和对 Yalmip 的调用可以在我朋友的计算机上运行，​​我们很困惑为什么它不能在我的计算机上运行。

* * *

以下是我在**Ubuntu 12.04**机器上使用**Matlab R2012b**进行的 CPLEX 和 Yalmip 的设置步骤：

1.  在此处安装 IBM CPLEX：`/home/user/ibm/ILOG/CPLEX_Studio125/cplex`
2.  在这里安装 Yalmip：`home/user/yalmip`
3.  在我的 Matlab 路径中添加了 CPLEX 和 Yalmip（并确认所有目录都存在）：

 **```
 addpath(genpath('/home/user/yalmip'))
    addpath(genpath('/home/user/ibm/ILOG/CPLEX_Studio125/cplex/matlab'))
    addpath(genpath('/home/user/ibm/ILOG/CPLEX_Studio125/cplex/examples/src/matlab')) 
```

* * *

**下面，我将解释我是如何尝试*诊断*问题的。很明显，Matlab 可以看到 CPLEX，Matlab 可以看到 Yalmip，但是 Yalmip 看不到 CPLEX。**

确认 Yalmip 和 CPLEX 在我的 matlab 路径中：

```
MATLAB> path
    /home/user/ibm/ILOG/CPLEX_Studio125/cplex/examples/src/matlab
    /home/user/ibm/ILOG/CPLEX_Studio125/cplex/matlab
    /home/forrest/ibm/ILOG/CPLEX_Studio125/cplex/matlab/help
    /home/forrest/ibm/ILOG/CPLEX_Studio125/cplex/matlab/help/helpsearch
    /home/forrest/ibm/ILOG/CPLEX_Studio125/cplex/matlab/help/topics
    /home/user/yalmip
    /home/user/yalmip/demos
    /home/user/yalmip/extras
    /home/user/yalmip/modules
    /home/user/yalmip/modules/bilevel
    /home/user/yalmip/modules/global
    /home/user/yalmip/modules/moment
    /home/user/yalmip/modules/parametric
    /home/user/yalmip/modules/robust
    /home/user/yalmip/modules/sos
    /home/user/yalmip/operators
    /home/user/yalmip/solvers
    ... 
```

为了验证 Matlab 确实可以找到 CPLEX，我运行了`help cplexlp`. 它给出了有效的输出：

```
MATLAB> help cplexlp
cplexlp
Solve linear programming problems.
x = cplexlp(f,Aineq,bineq) solves the linear programming problem min f*x such that Aineq*x <= bineq.
... 
```

另外，`which cplex`给出这个输出：`/home/user/ibm/ILOG/CPLEX_Studio125/cplex/matlab/@Cplex/Cplex.p`

并`which yalmip`给出这个输出：`/home/user/yalmip/extras/yalmip.m`

我`yalmiptest`在 Matlab 命令提示符下运行。输出验证 Matlab 可以找到 Yalmip，但 Yalmip 找不到 CPLEX：

```
MATLAB> yalmiptest
+++++++++++++++++++++++++++++++++++++++++++++++
|       Searching for installed solvers       |
+++++++++++++++++++++++++++++++++++++++++++++++
|        Solver|   Version/module|      Status|
+++++++++++++++++++++++++++++++++++++++++++++++
|       LINPROG|                 |       found|
|      QUADPROG|                 |       found|
|        LMILAB|                 |       found|
|       FMINCON|        geometric|       found|
|       FMINCON|         standard|       found|
|    FMINSEARCH|                 |       found|
|           BNB|                 |       found|
|      BINTPROG|                 |       found|
|        CUTSDP|                 |       found|
|        BMIBNB|                 |       found|
|         KKTQP|                 |       found|
|          NONE|                 |       found|
|     LSQNONNEG|                 |       found|
|        LSQLIN|                 |       found|
|        GUROBI|           GUROBI|   not found|
|        GUROBI|              MEX|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|         CPLEXINT|   not found|
|           CBC|                 |   not found|
|          GLPK|       GLPKMEX-CC|   not found| 
```

* * *

我还查看了 IBM 论坛以寻找答案。一位朋友向我指出[了 IBM 论坛中](http://www.ibm.com/developerworks/forums/message.jspa?messageID=14611925)关于诊断 CPLEX/Yalmip 的这篇文章，但这篇文章更侧重于 Windows，并没有真正解决我的问题。

* * *

更多细节：

*   Yalmip 版本 2012-09-26
*   CPLEX 版本 12.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T01:00:29.497

在深入研究了 Yalmip 源代码后，我最终发现了问题所在。

在 Yalmip 源代码中，有一个名为`yalmip/solvers/definesolvers.m`. 在`definesolvers.m`中，有一堆这样的语句：

```
solver(i) = lpsolver;
solver(i).tag     = 'CPLEX';
solver(i).version = 'IBM';
solver(i).subversion = '12.4';
solver(i).checkfor = {'cplexlp.m','cplexlink124'};
... 
```

这些语句适用于 CPLEX 12.0、12.1、12.2、12.3 和 12.4。但是，我使用的是 CPLEX 12.5，并且对于 CPLEX 12.5 没有这样的声明。

我替换了 with 的所有实例`12.4`并`12.5`替换了`cplexlink124`with的实例`cplexlink125`。我的优化代码现在可以工作了！

这是新的输出`yalmiptest`：

```
>> yalmiptest
+++++++++++++++++++++++++++++++++++++++++++++++
|       Searching for installed solvers       |
+++++++++++++++++++++++++++++++++++++++++++++++
|        Solver|   Version/module|      Status|
+++++++++++++++++++++++++++++++++++++++++++++++
|         CPLEX|              IBM|       found|
|         CPLEX|              IBM|       found|
|         CPLEX|              IBM|       found|
|       LINPROG|                 |       found|
|      QUADPROG|                 |       found|
|        LMILAB|                 |       found|
|       FMINCON|        geometric|       found|
|       FMINCON|         standard|       found|
|    FMINSEARCH|                 |       found|
|           BNB|                 |       found|
|      BINTPROG|                 |       found|
|        CUTSDP|                 |       found|
|        BMIBNB|                 |       found|
|         KKTQP|                 |       found|
|          NONE|                 |       found|
|     LSQNONNEG|                 |       found|
|        LSQLIN|                 |       found|
|        GUROBI|           GUROBI|   not found|
|        GUROBI|              MEX|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
|         CPLEX|              IBM|   not found|
... 
```

我猜剩余的`CPLEX| IBM| not found|`行意味着找不到 CPLEX 12.0、12.1、12.2 和 12.3。**

# java - 用于网络摄像头图像的 ocr api

> ID：13556209
> 
> 赞同：0
> 
> 时间：2012-11-25T22:24:58.930
> 
> 标签：java, ocr, tesseract

是否有任何 java ocr api 可以从网络摄像头的非扫描图像中检测文本。我使用了 tess4j 。它可以从扫描的图像中检测文本。但它无法从非扫描图像（例如网络摄像头的图像）中检测到文本。

# iphone - NSDateComponents 无法正确更改小时组件

> ID：13556216
> 
> 赞同：3
> 
> 时间：2012-11-25T22:25:55.990
> 
> 标签：iphone, ios, nsdate, nsdatecomponents

我不明白为什么我不能正确更改 NSDate 的时间，使用 NSDateComponents，我会这样做：

```
NSDateComponent components = [calendar components:  (NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit) fromDate:today];

[components setMinute:myMinute];
[components setHour:7];

NSDate *myNewDate = [calendar dateFromComponents:components];
NSLog(@"%@",myNewDate); 
```

但 NSLog 是这样的：

```
2012-12-08 06:00:00 +0000 
```

有一个小时的差异，我设置了 7，但是 6 有人可以帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T22:38:45.027

它的时区 - NSDate 使用 GMT 时间打印，因为它没有时区的概念

利用

```
[components setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]]; 
```

使组件 GMT 并反映您的时间设置

* * *

工作示例

```
int main(int argc, char *argv[]) {
@autoreleasepool {
    NSDate *today = [NSDate date];
    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSDateComponents *components = [calendar components:  (NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit) fromDate:today];

    [components setMinute:50];
    [components setHour:7];
    [components setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];

    NSDate *myNewDate = [calendar dateFromComponents:components];
    NSLog(@"%@",myNewDate);
}
} 
```

# actionscript-3 - 使用 AS3 AIR 3.2 进行补间

> ID：13556217
> 
> 赞同：1
> 
> 时间：2012-11-25T22:25:56.450
> 
> 标签：actionscript-3, air, tween

所以，我试图在我的 AIR for android 应用程序中做一个简单的补间，

我的目标是适用于 android 的 Air 3.2，在我尝试对对象进行 Tween 之前，一切正常。

如果我尝试导入`flash.event.TweenEvent`，如果失败。

当针对 Android 的 AIR 时，你可以做补间吗？

编辑

这是我的类文件

```
package {

import flash.display.*;
import flash.events.*;

public class AppName extends MovieClip {

    var a:MovieClip = new MovieClip();

    public function AppName() {
        addEventListener(Event.ADDED, added);
    }

    public function added(e:Event):void {
        removeEventListener(Event.ADDED, added);
        with(a.graphics){
            beginFill(0xff9900,1);
            drawRect(0,0,100,100);
            endFill();
        }
        addChild(a);
        var b:Tween = new Tween(a,"x",null,a.x,200,1,true);
        b.addEventListener(TweenEvent.MOTION_FINISHED, process);
    }

    public function process(e:TweenEvent):void {
        var c:MovieClip = new MovieClip();
        with(c.graphics){
            beginFill(0xff9900,1);
            drawRect(0,0,100,100);
            endFill();
        }
        addChild(c);
    }
}
} 
```

只有当我添加事件侦听器和函数来处理闪存吐出它的虚拟事件的事件时。它说包含“公共函数进程（e：TweenEvent）：void {”的行中有错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T12:56:15.780

你当然可以。我建议使用补间库[TweenMax](http://greensock.com)。因为它比 Flash 的默认补间引擎更快、更容易。您使用什么工具来开发您的应用程序？这可能会为您的问题来源提供线索。

# c# - 将 JSON 文件解析为 ListBox

> ID：13556218
> 
> 赞同：1
> 
> 时间：2012-11-25T22:26:03.927
> 
> 标签：c#, json, windows-phone-7, parsing, listbox

我正在尝试将 JSON 文件解析为 ListBox，但我不知道该怎么做，并且难以理解此处和其他地方的示例。

目前，我有以下内容：

**XAML**

```
<controls:Pivot Title="Episode Guide">
        <!--Pivot item one-->
        <controls:PivotItem Header="season 1">
            <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
                <ListBox x:Name="Season1Box" Margin="0,0,0,0" VerticalAlignment="Top" Height="607" SelectionChanged="Season1Box_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                <Image Source="{Binding Path=image1}"/>
                                <TextBlock Text="{Binding Path=title1}" TextWrapping="Wrap" Margin="10,10,0,0" FontSize="25" Foreground="White" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </controls:PivotItem>

        <!--Pivot item two-->
        <controls:PivotItem Header="season 2">
            <Grid x:Name="ContentPanel2" Grid.Row="1" Margin="12,0,12,0">
                <ListBox x:Name="Season2Box" Margin="0,0,0,0" VerticalAlignment="Top" Height="607" SelectionChanged="Season2Box_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                <Image Source="{Binding Path=image2}"/>
                                <TextBlock Text="{Binding Path=title2}" TextWrapping="Wrap" Margin="10,10,0,0" FontSize="25" Foreground="White" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </controls:PivotItem>

        <controls:PivotItem Header="season 3">
            <Grid x:Name="ContentPanel3" Grid.Row="1" Margin="12,0,12,0">
                <ListBox x:Name="Season3Box" Margin="0,0,0,0" VerticalAlignment="Top" Height="607" SelectionChanged="Season3Box_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                <Image Source="{Binding Path=image3}"/>
                                <TextBlock Text="{Binding Path=title3}" TextWrapping="Wrap" Margin="10,10,0,0" FontSize="25" Foreground="White" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </controls:PivotItem>
    </controls:Pivot> 
```

**C＃**

```
private void EpisodeGuideStream()
    {
        var client = new WebClient();
        client.OpenReadCompleted +=
            (s, eargs) =>
            {
                var serializer = new DataContractJsonSerializer(typeof(RootObject));
                if (eargs.Error != null)
                {
                    if (eargs.Error.Message.Contains("NotFound"))
                    {
                        MessageBox.Show("Could not retrieve episode guide", "Error", MessageBoxButton.OK);
                    }
                    else
                    {
                        MessageBox.Show("Could not retrieve episode guide", "Error", MessageBoxButton.OK);
                    }
                }
                else
                {
                    var episodeGuide = (RootObject)serializer.ReadObject(eargs.Result);

                    //I have no idea what I'm doing (Part 1)
                    List<string> episode1 = new List<string>();
                    List<string> title1 = new List<string>();
                    List<string> director1 = new List<string>();
                    List<string> writer1 = new List<string>();
                    List<string> airdate1 = new List<string>();
                    List<string> sypnosis1 = new List<string>();
                    List<string> image1 = new List<string>();

                    foreach (var obj in episodeGuide.SEASON1)
                    {
                        //I have no idea what I'm doing (Part 2)
                        episode1.Add(obj.EPISODE);
                        title1.Add(obj.TITLE);
                        director1.Add(obj.DIRECTOR);
                        writer1.Add(obj.WRITER);
                        airdate1.Add(obj.AIRDATE);
                        sypnosis1.Add(obj.SYPNOSIS);
                        image1.Add(obj.IMAGE);

                  //      Season1Box.ItemsSource = figure out what goes here;
                    }
                    foreach (var obj2 in episodeGuide.SEASON2)
                    {
                        //          populate Season2Box
                    }
                    foreach (var obj3 in episodeGuide.SEASON3)
                    {
                        //          populate Season3Box
                    }

                }
            };
        var uri = new Uri(jsonfile);
        client.OpenReadAsync(uri);
    }

    public class SEASON1
    {
        public string EPISODE { get; set; }
        public string TITLE { get; set; }
        public string DIRECTOR { get; set; }
        public string WRITER { get; set; }
        public string AIRDATE { get; set; }
        public string SYPNOSIS { get; set; }
        public string IMAGE { get; set; }
    }

    public class SEASON2
    {
        public string EPISODE { get; set; }
        public string TITLE { get; set; }
        public string DIRECTOR { get; set; }
        public string WRITER { get; set; }
        public string AIRDATE { get; set; }
        public string SYPNOSIS { get; set; }
        public string IMAGE { get; set; }
    }

    public class SEASON3
    {
        public string EPISODE { get; set; }
        public string TITLE { get; set; }
        public string DIRECTOR { get; set; }
        public string WRITER { get; set; }
        public string AIRDATE { get; set; }
        public string SYPNOSIS { get; set; }
        public string IMAGE { get; set; }
    }

    public class RootObject
    {
        public List<SEASON1> SEASON1 { get; set; }
        public List<SEASON2> SEASON2 { get; set; }
        public List<SEASON3> SEASON3 { get; set; }
    }

    private void Season1Box_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        //To eventually navigate to another page
    }

    private void Season2Box_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        //To eventually navigate to another page
    }

    private void Season3Box_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        //To eventually navigate to another page
    } 
```

JSON 文件被正确解析，我可以在这里和那里检索一些数据，但我不知道如何将它们全部放在一个 ListBox 中。

我正在尝试做的是有一个 ListBox 显示来自 JSON 的“IMAGE”，旁边是来自 JSON 的“TITLE”。单击它们最终应该导航到包含所有其他信息的新页面，一旦我弄清楚这一点，我可能会通过 QueryStrings 或其他东西传递所有的点点滴滴。

如果有人可以检查我的最后一点是否有意义，并为我指出 ListBox 的正确方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:04:21.793

1.  您应该摆脱`SEASON2`和`SEASON3`类，并重命名`SEASON1`为`Episode`. 序列化中不使用类名。您还应该将`IMAGE`-property 更改为 type `Uri`，以便将其绑定到图像。

    ```
    public class Episode
    {
        public string EPISODE { get; set; }
        public string TITLE { get; set; }
        public string DIRECTOR { get; set; }
        public string WRITER { get; set; }
        public string AIRDATE { get; set; }
        public string SYPNOSIS { get; set; }
        public Uri IMAGE { get; set; }
    }

    public class RootObject
    {
        public List<Episode> SEASON1 { get; set; }
        public List<Episode> SEASON2 { get; set; }
        public List<Episode> SEASON3 { get; set; }
    } 
    ```

2.  您可以将列表绑定（或分配）到 ListBox 的`ItemsSource`属性，它将根据列表中的对象填充行。每个列表项都使用它们对应的对象作为 DataContext，您可以绑定到它们的属性。

    ```
    Season1Box.ItemsSource = root.SEASON1;
    Season2Box.ItemsSource = root.SEASON2;
    Season3Box.ItemsSource = root.SEASON3; 
    ```

3.  要将控件的属性绑定到对象属性，可以使用语法`Text="{Binding Path=MyProperty}"`. 您甚至可以处理嵌套属性，例如`MyProperty.OtherProperty`.

    ```
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                <Image Source="{Binding Path=IMAGE}"/>
                <TextBlock Text="{Binding Path=TITLE}" TextWrapping="Wrap" Margin="10,10,0,0" FontSize="25" Foreground="White" />
             </StackPanel>
         </DataTemplate>
     </ListBox.ItemTemplate> 
    ```

# sql - SQL 优化查询以获取建议的产品

> ID：13556219
> 
> 赞同：0
> 
> 时间：2012-11-25T22:26:06.553
> 
> 标签：sql, optimization

> **可能重复：**
> [SQL 查询优化建议产品](https://stackoverflow.com/questions/13552044/sql-query-optimization-suggested-products)

这是一个根据客户的订单历史记录表检索“推荐”产品的查询。

```
SELECT 
   A.id_product, COUNT( A.id_product ) AS num
FROM  
   orders A, orders B
WHERE 
   A.id_order = B.id_order
   AND B.id_product IN  (-**COMMA-SEPARETED-IDs**-)
   AND A.id_product NOT IN (-**COMMA-SEPARETED-IDs**-)
GROUP BY 
   A.id_product 
```

这是表定义：

```
ORDERS (id_order, id_product, quantity); 
```

示例：T1(1, 1, 2); T2(1, 2, 2); T3(1, 3, 2); T4(2, 2, 2); T5(2, 1, 2);

给定一个 id_product （假设是 2），我想做的是检索所有 id_prodect ，这些 id_prodect 存在于其中一个订单产品是给定产品的订单中。使用给定的示例，我将向我的客户建议产品 1 和 3，因为 id_product=2 存在于订单 1 和订单 2 中。这些订单中的其他产品是 3 和 1。所以我将建议产品 3 和产品 1。

我正在寻找的是实现最佳优化查询。原谅我糟糕的英语。

# php - 如何停止出现 javascript 和 php 消息

> ID：13556220
> 
> 赞同：0
> 
> 时间：2012-11-25T22:26:10.280
> 
> 标签：php, javascript

在下面的代码中，我有两种类型的验证。我使用 javascript 验证，当用户没有从“课程”下拉菜单中选择课程时，它会显示错误消息。

然后我有一个 php 验证，如果它不包含查询结果的行，那么它会显示一条消息，指出没有找到任何评估。

我遇到的问题是，如果用户没有从“课程”下拉菜单中选择课程并且他们点击提交按钮，它会同时显示 javascript 验证和 php 验证。

这是不正确的，应该发生的是：

*   如果用户没有选择课程，那么它应该只显示 javascript 验证而不是 php 验证。

    *   如果用户从下拉菜单中选择了一门课程并提交了表单，但随后无法从查询中找到任何结果，那么它应该显示 php 验证。

我的问题是我需要在代码中进行哪些更改才能不能同时显示两个验证消息，并且在应该显示正确的验证消息时只显示它们？

**Javascript**

```
function validation() {

    var isDataValid = true;

    var courseTextO = document.getElementById("coursesDrop");
    var moduleTextO = document.getElementById("modulesDrop");

    var errModuleMsgO = document.getElementById("moduleAlert");

    if (courseTextO.value == "") {
        $('#targetdiv').hide();
        $('#assessmentForm').hide();
        $('#updateForm').hide();
        $('#submitupdatebtn').hide();
        errModuleMsgO.innerHTML = "Please Select a Course";
        isDataValid = false;
    } else {
        errModuleMsgO.innerHTML = "";
    }
    return isDataValid;

}​ 
```

**PHP/HTML**

```
<?php

// connect to the database
include('connect.php');

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    die();
}

$sql = "SELECT CourseId, CourseNo, CourseName FROM Course ORDER BY CourseId"; 

$sqlstmt=$mysqli->prepare($sql);

$sqlstmt->execute(); 

$sqlstmt->bind_result($dbCourseId, $dbCourseNo, $dbCourseName);

$courses = array(); // easier if you don't use generic names for data 

$courseHTML = "";  
$courseHTML .= '<select name="courses" id="coursesDrop">' . PHP_EOL; 
$courseHTML .= '<option value="">Please Select</option>' . PHP_EOL;  

$outputcourse = "";

while($sqlstmt->fetch()) 
{

    $course = $dbCourseId;
    $courseno = $dbCourseNo;
    $coursename = $dbCourseName; 

    $courseHTML .= "<option value='" . $course . "'>" . $courseno . " - " . $coursename . "</option>" . PHP_EOL;  

    if (isset($_POST['courses']) && ($_POST['courses'] == $course)) {
        $outputcourse = "<p><strong>Course:</strong> " . $courseno .  " - "  . $coursename . "</p>";
    }

} 

$courseHTML .= '</select>'; 

?>

<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post" onsubmit="return validation();">
    <table>
        <tr>
            <th>Course: <?php echo $courseHTML; ?></th>
        </tr>
    </table>
    <p>
        <input id="moduleSubmit" type="submit" value="Submit Course and Module" name="moduleSubmit" />
    </p>
    <div id="moduleAlert"></div>
    <div id="targetdiv"></div>
</form>

<?php

if (isset($_POST['moduleSubmit'])) {    

    $sessionquery = "
    SELECT SessionId, SessionName, SessionDate, SessionTime, CourseId, SessionActive
    FROM Session
    WHERE (CourseId = ? AND SessionActive = ?)
    ORDER BY SessionName 
    ";

    $active = 1;

    $sessionqrystmt=$mysqli->prepare($sessionquery);
    // You only need to call bind_param once
    $sessionqrystmt->bind_param("si",$course, $active);
    // get result and assign variables (prefix with db)

    $sessionqrystmt->execute(); 

    $sessionqrystmt->bind_result($dbSessionId,$dbSessionName,$dbSessionDate,$dbSessionTime, $dbCourseId, $dbSessionActive);

    $sessionqrystmt->store_result();

    $sessionnum = $sessionqrystmt->num_rows();   

    if($sessionnum == 0) {
        echo "<p><span style='color: red'>Sorry, You have No Assessments under this Module</span></p>";
    } 
    else 
    { 
        echo "";
    }

    ...

}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:31:18.370

你可以替换

```
if (isset($_POST['moduleSubmit'])) 
```

经过

```
if (isset($_POST['coursesDrop']) && $_POST['coursesDrop']!="") 
```

这样你就可以防止 php 在不需要时发出请求，那就是如果你想做验证服务器端。

如果您想阻止单击提交按钮时提交表单（客户端），

您可以在提交按钮上替换`onsubmit="return validation();"`为。`onclick="validation();"`如果数据通过验证调用`$("#yourForm").submit()`。

**编辑**在这里，您将根据要求找到完整的代码

JAVASCRIPT

```
function validation() {

    var isDataValid = true;

    var courseTextO = document.getElementById("coursesDrop");
    var moduleTextO = document.getElementById("modulesDrop");

    var errModuleMsgO = document.getElementById("moduleAlert");

    if (courseTextO.value == "") {
        $('#targetdiv').hide();
        $('#assessmentForm').hide();
        $('#updateForm').hide();
        $('#submitupdatebtn').hide();
        errModuleMsgO.innerHTML = "Please Select a Course";
        isDataValid = false;
    } else {
        errModuleMsgO.innerHTML = "";
    }

    if(isDataValid){
        $("#myForm").submit();
    }

}​ 
```

PHP HTML

```
// connect to the database
include('connect.php');

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    die();
}

$sql = "SELECT CourseId, CourseNo, CourseName FROM Course ORDER BY CourseId"; 

$sqlstmt=$mysqli->prepare($sql);

$sqlstmt->execute(); 

$sqlstmt->bind_result($dbCourseId, $dbCourseNo, $dbCourseName);

$courses = array(); // easier if you don't use generic names for data 

$courseHTML = "";  
$courseHTML .= '<select name="courses" id="coursesDrop">' . PHP_EOL; 
$courseHTML .= '<option value="">Please Select</option>' . PHP_EOL;  

$outputcourse = "";

while($sqlstmt->fetch()) 
{

    $course = $dbCourseId;
    $courseno = $dbCourseNo;
    $coursename = $dbCourseName; 

    $courseHTML .= "<option value='" . $course . "'>" . $courseno . " - " . $coursename . "</option>" . PHP_EOL;  

    if (isset($_POST['courses']) && ($_POST['courses'] == $course)) {
        $outputcourse = "<p><strong>Course:</strong> " . $courseno .  " - "  . $coursename . "</p>";
    }

} 

$courseHTML .= '</select>'; 

?>

<form id="myForm" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
    <table>
        <tr>
            <th>Course: <?php echo $courseHTML; ?></th>
        </tr>
    </table>
    <p>
        <input id="moduleSubmit" type="button" value="Submit Course and Module" name="moduleSubmit" onclick="validation();" />
    </p>
    <div id="moduleAlert"></div>
    <div id="targetdiv"></div>
</form>

<?php

if (isset($_POST['moduleSubmit'])) {    

    $sessionquery = "
    SELECT SessionId, SessionName, SessionDate, SessionTime, CourseId, SessionActive
    FROM Session
    WHERE (CourseId = ? AND SessionActive = ?)
    ORDER BY SessionName 
    ";

    $active = 1;

    $sessionqrystmt=$mysqli->prepare($sessionquery);
    // You only need to call bind_param once
    $sessionqrystmt->bind_param("si",$course, $active);
    // get result and assign variables (prefix with db)

    $sessionqrystmt->execute(); 

    $sessionqrystmt->bind_result($dbSessionId,$dbSessionName,$dbSessionDate,$dbSessionTime, $dbCourseId, $dbSessionActive);

    $sessionqrystmt->store_result();

    $sessionnum = $sessionqrystmt->num_rows();   

    if($sessionnum == 0) {
        echo "<p><span style='color: red'>Sorry, You have No Assessments under this Module</span></p>";
    } 
    else 
    { 
        echo "";
    }

    ...

}
?> 
```

# android - Android xhdpi 密度和分辨率

> ID：13556226
> 
> 赞同：4
> 
> 时间：2012-11-25T22:27:07.067
> 
> 标签：android, layout, screen, resolution

我有点困惑，希望你能帮助我。我正在为智能手机开发一个应用程序，我使用的前缀是`mdpi`：`hdpi`和`xhpi`. 前两个我没有任何问题。

根据这个：

*   [http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)
*   而这个 [http://developer.android.com/about/dashboards/index.html](http://developer.android.com/about/dashboards/index.html)

`xhdpi`是 640x960 像素的屏幕尺寸，我已经为这个分辨率准备了我的图形。但我找不到任何具有此分辨率的设备。取而代之的是，在 android 布局编辑器中，我有例如标记为`xhdpi`设备的 Galaxy Nexus，但它的屏幕尺寸为 720p。

所以我的问题是，我应该从文档中查看这些表格，并相信 25% 的设备的屏幕尺寸为 640x960 像素，或者我应该将我的图形更改为 720p 屏幕尺寸？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:37:18.880

如果您只为手机和平板电脑开发是不必要的，您可能不会使用 xhdpi 文件夹作为您的资源。如果您希望您的应用程序在 Galaxy Nexus、Nuxus 4 等现代设备上正常运行，您应该支持 xhdpi 屏幕。

```
large screens are at least 640dp x 480dp (hdpi)
xlarge screens are at least 960dp x 720dp (xhdpi) 
```

# c - 在 C 中的列表末尾添加新结构

> ID：13556228
> 
> 赞同：0
> 
> 时间：2012-11-25T22:27:18.270
> 
> 标签：c

我想在列表末尾插入结构，但无法编译代码。这是我为 insert() 函数编写的一些伪代码。他们其余的代码应该保持不变。

```
 (check it succeeded)
 set the data for the new person
 if the current list is empty (i.e. NULL)
   do the same as insert_start i.e.
   set the new person's "next" link to point to the current list (i.e. NULL)
   return the (start of the) new list i.e. a pointer to the new person
 otherwise
   use a loop to find the last item in the list
     (i.e. the one which has a "next" link of NULL)
   set the "next" link of this item to point to the new person
     so the new person becomes the last item in the list
     (i.e. the new person should have a "next" link of NULL)
       return the (start of the) list 
```

编译错误：

```
error: 'true' undeclared (first use in this function)
insert_end.c:47:13: note: each undeclared identifier is reported only once for each function it    appears in
insert_end.c:57:3: warning: 'return' with a value, in function returning void
make: *** [insert_end] Error 1

#include <stdio.h>
#include <stdlib.h>

/* these arrays are just used to give the parameters to 'insert',
 to create the 'people' array */
char names[][10]= {"Simon", "Suzie", "Alfred", "Chip", "John", "Tim",
      "Harriet"};
int ages[7]= {22, 24, 106, 6, 18, 32, 24};

/* declare your struct for a person here */
typedef struct Record{
  char *name;
  int age;
  struct Record *next;
}  Record;

//set the head pointer at the start of the list
Record *headptr = NULL;

static void insert (Record *p, char *s, int n) {

  /* allocate heap space for a record */
  Record *ptr =(Record*) malloc(sizeof(Record));

  if(ptr == NULL){  
    abort();
    printf("memory allocation fail"); 
    exit(1);  
  }else{
    printf("memory allocation to person  - %s - \n", s);      
  }

  ptr->name=s;
  ptr->age=n;
  ptr->next = NULL;

  if(p->next==NULL)
  {
     p->next= ptr;

  }else{
      Record *current = p;
      while(true){

    if(current->next ==NULL)
{
  current->next = ptr;
  break;
}
current= current->next;
  }
  }
  return 0;

}  

int main(int argc, char **argv) {

      /* declare the people array here */
  Record *p;
  headptr = NULL;

   //insert the members and age into the unusage array. 
  for (int i=0; i < 7; i++) {
    insert (p, names[i], ages[i]);
    /* do not dereference the pointer */
  }

  /* print out a line before printing the names and ages */
  printf("\n");

  //set the pointer at the start of the list 
  p = headptr;

  /* print the people array here*/
  for (int i=0; i < 7; i++, p = p->next) {
    printf("The name is: %s, the age is:%i\n", p->name, p->age);
  }

  /* This is the third loop for call free to release the memory allocated by malloc */
  /* the free()function deallocate the space pointed by ptr. */
  for(int i=0; i<7;i++){
    free(p);
  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:34:33.873

'true' 和 'false' 需要在 c 中定义。否则使用 1 和 0 代替。return 0 将不起作用，因为该函数被定义为 void。从声明中删除 'void 或使用 'return;'

# php - CURL 通过 php 设置日期

> ID：13556231
> 
> 赞同：0
> 
> 时间：2012-11-25T22:27:32.647
> 
> 标签：php, date, curl, header

我一直在寻找一段时间没有任何运气。我想知道是否可以使用 curl() 设置服务器的日期？

我目前有这个代码来登录和检索数据

```
 $ch = curl_init(); 
curl_setopt ($ch, CURLOPT_URL, $loginURL); 
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE); 
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6"); 
curl_setopt ($ch, CURLOPT_TIMEOUT, 60); 
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1); 
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, TRUE); 
curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookieFile); 
curl_setopt ($ch, CURLOPT_COOKIEFILE, $cookieFile); 
curl_setopt ($ch, CURLOPT_REFERER, $loginURL); 

curl_setopt ($ch, CURLOPT_POSTFIELDS, $postData); 
curl_setopt ($ch, CURLOPT_POST, 1); 
```

但有时我从服务器获取数据，认为这是另一个日期。我知道我可以使用另一个 curl“分区”通过 url 在特定日期从特定日期获取数据，但我认为只调用远程服务器一次会更快，所以是否可以设置标题或其他内容？

**我特别不会这样做：欺骗服务器，我通过 CURL 调用它认为它是在未来的日子里**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:54:38.320

您应该详细了解以下内容：

[PHP.net setopt 手册](http://www.php.net/manual/en/function.curl-setopt.php)

使用 curl，您可以使用 curl_setopt($handle, CURLOPT_HTTPHEADER, $header) 设置完整的标头。我不完全理解你在你的具体情况下试图做什么，但希望这个例子可能有用：

```
 $agent = 'Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US)';
    $header[0] = "Accept: text/xml,application/xml,application/xhtml+xml,";
    $header[0] .= "text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5";
    $header[] = "Cache-Control: max-age=0";
    $header[] = "Connection: keep-alive";
    $header[] = "Keep-Alive: 300";
    $header[] = "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7";
    $header[] = "Accept-Language: en-us,en;q=0.5";
    $header[] = "Pragma: ";
    $ch = curl_init();
    curl_setopt ($ch, CURLOPT_URL, $url);
    curl_setopt($ch,CURLOPT_USERAGENT, $agent);//s[array_rand($agents)]);
    curl_setopt ($ch, CURLOPT_HTTPHEADER, $header);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, 0);
    $fileContents = curl_exec($ch);
    curl_close($ch); 
```

此外，如果您正在处理多个 curl 请求，您可能会考虑由 Josh Frasier 编写的一个很棒的库，称为[Rolling_Curl](http://code.google.com/p/rolling-curl/)。

# list - 列出 Dart 中 Map 的 AS 值

> ID：13556233
> 
> 赞同：1
> 
> 时间：2012-11-25T22:27:58.503
> 
> 标签：list, maps, dart

我想创建一个成员地图，但每个成员都有 3 个属性：名字、姓氏和用户名。如何创建像列表一样的列表，但使用地图。

所以我想要类似的东西：

```
var membres= {['lastname': 'Bonneau',
              'firstname': 'Pierre',
              'username': 'mariobross'],
              ['lastname': 'Hamel',
               'firstname': 'Alex',
               'username': 'Queenlatifa'],
            }; 
```

如您所知，此代码不起作用。但它很好地解释了我想要做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T06:50:47.723

我认为您在这里混淆了这两个结构。

阅读此语言介绍：[http ://www.dartlang.org/docs/dart-up-and-running/ch02.html#lists](http://www.dartlang.org/docs/dart-up-and-running/ch02.html#lists)

列表是可以用简写`[...]`语法表示的元素列表：

```
var list = [1, 2, "foo", 3, new Date.now(), 4]; 
```

而地图可以用大括号简写语法表示：

```
var gifts = {                         // A map literal
// Keys       Values
  'first'  : 'partridge',
  'second' : 'turtledoves',
  'fifth'  : 'golden rings'
}; 
```

因此，让我们修改您的代码以使其正常工作：

```
var members = [
  {
    'lastname': 'Bonneau',
    'firstname': 'Pierre',
    'username': 'mariobross'
  },
  {
    'lastname': 'Hamel',
    'firstname': 'Alex',
    'username': 'Queenlatifa'
  }
]; 
```

例如，您可以像这样打印信息：

```
members.forEach((e) {
  print(e['firstname']);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T04:34:51.097

如果我正确理解你的意图，你想要一张地图列表。你所拥有的是正确的，除了你感到困惑`[`和`{`。以下作品：

```
var membres = [
          {'lastname': 'Bonneau',
           'firstname': 'Pierre',
           'username': 'mariobross'},
          {'lastname': 'Hamel',
           'firstname': 'Alex',
           'username': 'Queenlatifa'}
        ]; 
```

例如，要获取所有用户名的列表：

```
print(membres.map((v) => v['username'])); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T10:44:22.080

If you don't really need a `Map`, what about using a class to improve the structure of your code :

```
class Member {
  String firstname;
  String lastname;
  String username;
  Member(this.firstname, this.lastname, this.username);
}

main() {
  final members = new List<Member>();
  members.add(new Member('Pierre', 'Bonneau', 'mariobross'));
  members.add(new Member('Alex', 'Hamel', 'Queenlatifa'));
  // use members
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T08:52:38.737

你的意思是这样吗？

```
// FirstName => LastName => Value
var lookup = new Map<String, Map<String, String>>();

// get / set values like this
void setValue(String firstName, String lastName, String value) {
   if (!lookUp.containsKey(firstName)) 
       lookUp[firstName] = new Map<String, String>();
   lookUp[firstName][lastName] = value;
}

String getValue(String firstName, String lastName) {
   if (!lookUp.containsKey(firstName)) return "";
   return lookUp[firstName][lastName];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-16T10:25:21.103

首先，您需要创建一个值作为列表的地图。不要忘记初始化它，然后如果要填充它，首先需要使用内置函数（如`putIfAbsent`dart）在列表中添加第一个对象，然后使用`update`在列表中添加项目。因此您将需要两个数组。首先放置元素，然后使用相同的键在列表中添加元素。您也可以使用 try catch 来确定密钥是否存在，以便在一个循环中执行此操作

```
for (var item in days) {
    var date_time = DateTime.parse(item["date"] + " 00:00:00");
    _events[date_time] = _events.putIfAbsent(
        date_time,
        () => [
              {
                "title": item["title"],
                "date": item["date"],
                "time": reUse.get_time_am_pm_format(item["time"]),
                "feature": item["feature"],
              }
            ]);
  }
  for (var item in days) {
    var date_time = DateTime.parse(item["date"] + " 00:00:00");
    _events[date_time] = _events.update(date_time, (value) {
      value.add({
        "title": item["title"],
        "date": item["date"],
        "time": reUse.get_time_am_pm_format(item["time"]),
        "feature": item["feature"],
      });
      return value;
    });
  } 
```

# c#-4.0 - 实体框架 5 为表指定了多个标识列。每个表只允许一个标识列

> ID：13556243
> 
> 赞同：22
> 
> 时间：2012-11-25T22:28:50.670
> 
> 标签：c#-4.0, entity-framework-5

我正在创建这个模型作为我的代码优先实体框架的一部分

```
public class NewUserRegistration
{
    [Key]
    public int NewUserRegistrationId { get; set; }    
} 
```

使用`Update-Database -Verbose -Force`包管理器控制台中的命令我在更新的这一位期间得到了这个异常`Applying automatic migration: 201211252223088_AutomaticMigration.`

> ALTER TABLE [dbo].[NewUserRegistration] ADD [NewUserRegistrationId] [int] NOT NULL IDENTITY System.Data.SqlClient.SqlException (0x80131904)：为表“NewUserRegistration”指定了多个标识列。每个表只允许一个标识列。在 System.Data.SqlClient.SqlConnection.OnError（SqlException 异常，布尔 breakConnection，操作`1 wrapCloseInAction) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) 在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) 在 System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject state&Obj, Boolean dataReady) 在 System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout) 在 System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource `1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite) at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() at System.Data.Entity.Migrations.DbMigrator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement) at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement) at System.Data.Entity.Migrations.DbMigrator.ExecuteStatements(IEnumerable`1 migrationStatements) 在 System.Data.Entity.Migrations.Infrastructure.MigratorBase。 ExecuteStatements（IEnumerable`1 migrationStatements) at System.Data.Entity.Migrations.DbMigrator.ExecuteOperations(String migrationId, XDocument targetModel, IEnumerable`System.Data.Entity.Migrations.DbMigrator.AutoMigrate(String migrationId, XDocument sourceModel, XDocument targetModel, Boolean downgrading) at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.AutoMigrate(String migrationId, XDocument sourceModel, XDocument targetModel, Boolean downgrading) at System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable 1 pendingMigrations, String targetMigrationId, String lastMigrationId)`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
> at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.Upgrade(IEnumerable`
> 在 System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration) 在 System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update(String targetMigration) 在 System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.RunCore () 在 System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.Run() ClientConnectionId:a39395da-5f2b-48e0-bdac-b48d75a68c68 为表“NewUserRegistration”指定了多个标识列。每个表只允许一个标识列。

显然只指定了一个身份列。那么为什么会这样呢？

当我这样做时，我没有例外。

```
public class NewUserRegistration
{
    [Key]
    public int Id { get; set; }    
} 
```

关于为什么会这样的任何想法？

***编辑***

我应该说我正在更改密钥的名称。评论说你不能这样做。如何删除和重新创建？

最好从 SQL 中删除数据库，然后`Update-Database`再次运行该命令？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-02-04T07:15:52.620

尝试重命名键列时遇到了同样的错误。为了使迁移工作，我必须在我的脚手架迁移脚本中重新排序操作顺序。

在这里，我确保先订购 Drop 操作，然后再添加新的 Key 字段。

```
public partial class RenameKey : DbMigration
{
    public override void Up()
    {
        DropPrimaryKey("dbo.GameSummary", new[] { "OldId" });
        DropColumn("dbo.GameSummary", "OldId");
        AddColumn("dbo.GameSummary", "Id", c => c.Int(nullable: false, identity: true));
        AddPrimaryKey("dbo.GameSummary", "Id");
    } 
```

希望对你的案子有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-13T16:46:37.867

我也没有任何问题，只需用命令替换相关的`DropPrimaryKey`,`DropColumn`和`AddColumn`命令，例如`AddPrimaryKey``RenameColumn`

```
public partial class RenameKey : DbMigration
{
    public override void Up()
    {    
        RenameColumn("dbo.GameSummary", "OldId", "Id");
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-20T22:41:40.870

首先`Add-Migration -Name` 然后

```
public override void Up()
{    
    RenameColumn("dbo.Department", "OldId", "NewId");
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-19T13:07:44.073

第一次迁移后，我也遇到了类似的问题。我意识到，在我删除了第一次迁移创建的数据库，然后也删除了在我的 mvc 应用程序中创建的迁移文件夹后，问题没有再次出现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-19T20:58:34.447

您可以使用以下内容直接从类中更改列的名称：

```
[Column("ProductID")] 
```

例子：

```
namespace Z_Market.Models
{
    public  class Product
    {
        [Key, Column("ProductID")]  //This change the name of the column when you are using migration.  If you have a form created already, you have to change the connection in the for to aim the new column name.  
        public int ID { get; set; }
        public string Description { get; set; }
        public decimal Price { get; set; }
        public DateTime LastBuy { get; set; }
        public float Stock { get; set; }
        public string remarks { get; set; }
        public string deleteme { get; set; }

        public ICollection<SupplierProduct> SupplierProducts { get; set; }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-28T14:50:31.287

最好的实现是：

```
/*Replace*/
DropPrimaryKey("dbo.GameSummary", new[] { "OldId" });
DropColumn("dbo.GameSummary", "OldId");
AddColumn("dbo.GameSummary", "Id", c => c.Int(nullable: false, identity: true));
AddPrimaryKey("dbo.GameSummary", "Id");
/*For*/
RenameColumn("dbo.GameSummary", "OldId", "Id"); 
```

# c++ - 面试算法查询

> ID：13556244
> 
> 赞同：2
> 
> 时间：2012-11-25T22:28:53.170
> 
> 标签：c++, algorithm, pseudocode

> 给定常量整数 x 和 t，编写一个不带参数的函数，如果该函数在最后 t 秒内被调用了 x 次，则返回 true。

这是我对可能算法的伪代码/C++ 实现，但我不确定它是否正确/有效：

```
const int x;
const int t;
vector<long> v;
boolean countNumberOfTimesBeenCalled(){
    int numberOfCallsInLastTSeconds=0;
    v.push_back(System.currentTimeInMillis());
    for(int x=0; x<v.size();x++){
        if((v.at(x)>=(System.currentTimeInMillis()-1000*t))&&(v.at(x)<=System.currentTimeInMillis())
            numberOfCallsInLastTSeconds++;
    }
    if(numberOfCallsInLastTSeconds==x)
        return true;
    else
        return false;
} 
```

任何人都可以提出替代方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:36:57.867

您不需要保留所有先前通话的完整日志；您只需要知道最后 x 个调用跨越了多长时间。

```
const int x;
const int t;
bool have_we_made_enough_calls_lately() {
    static deque<int> times;
    times.push_back(current_time_in_msec());
    if (times.size() > x)
        times.pop_front();
    return times.back() - times.front() <= 1000 * t;
} 
```

编辑：在检查其他答案时，我意识到这个问题是模棱两可的。**如果至少有**x 个调用（我假设的）或**恰好**x 个调用（其他人假设的），您是否要返回 true 尚不清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:37:16.587

```
bool calledXTimesInLastTSeconds() {
   static deque<long> last_calls;
   long time = currentTimeInMillis();

   // clear last calls
   long last_call_to_consider = time - 1000*t;
   while (last_calls.front() < last_call_to_consider)
      last_calls.pop_front()

  last_calls.push_back(time);
  return last_calls.size() == x;
} 
```

时间复杂度是摊销常数。

编辑：这是如何*准确*检查x 调用。即使您可以简单地将其更改为至少 x 个调用（通过更改`==x`为`>=x`），但 Ross Smith 的答案会更好，因为内存使用量具有恒定的上限。

# matlab - 在matlab中使用阶乘函数时出错？

> ID：13556248
> 
> 赞同：1
> 
> 时间：2012-11-25T22:29:17.873
> 
> 标签：matlab, math, factorial, symbolic-math

尝试计算此序列时出现错误

```
syms n
limit(((-3)^n)/factorial(n),inf) 
```

使用阶乘时出错（第 17 行） N 必须是非负整数矩阵。错误（第 9 行）

你如何解决这个问题或指定他们想要的矩阵？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T22:36:46.003

阶乘函数不是为使用符号引用而设计的，并且经常会阻塞它们。如果您有足够新的版本（2012b 声称它可以工作），它可能会起作用，但我认为它不一定适用于旧版本，我发现一些文件声称它实际上不会。[建议](http://users.aims.ac.za/~yibeltal/Academic/A%20Guide%20to%20MATLAB%20-%20For%20Beginners%20and%20Experienced%20Users,%20Second%20Edition.pdf)使用以下两种方法来解决此问题。

```
limit((-3)^n/sym('n!'),n,inf)
limit((-3)^n/gamma(n+1),n,inf) 
```

# http - Noir 的基本 HTTP 身份验证

> ID：13556254
> 
> 赞同：3
> 
> 时间：2012-11-25T22:30:57.057
> 
> 标签：http, clojure, basic-authentication, ring, noir

我已经开始弄清楚如何使用 noir，现在我想使用 http 基本身份验证。

我偶然发现了[https://github.com/adeel/ring-http-basic-auth](https://github.com/adeel/ring-http-basic-auth)。不过，给定的例子似乎适用于 compojure 而不是 noir。

我想知道 noir 的抽象级别是否太高而无法允许不同页面的不同身份验证？！

我也知道这可能是可行的方法：[http](http://webnoir.org/tutorials/others) ://webnoir.org/tutorials/others ，不过，我对整个 clojure 生态系统还不够满意，无法了解如何适应这些环处理程序作为特定路由的http认证。

有没有人可以给我一个关于我应该如何思考这个问题的提示？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T13:23:13.043

查看朋友：[https ://github.com/cemerick/friend](https://github.com/cemerick/friend)

它是一个授权/身份验证库，用作环中间件。很容易起床和去。

# c - c/c++ strptime() 不解析 %Z 时区名称

> ID：13556260
> 
> 赞同：5
> 
> 时间：2012-11-25T22:31:20.790
> 
> 标签：c, timezone, strptime, timestamp-with-timezone

我是 C 的新手。当我练习 C 来隐蔽时间刺痛来回构造 tm 时。我注意到了一些不同。请指教我做错了什么。

```
#include <string.h>
#include <stdio.h>
#include <time.h>

/* 
test different format string to strptime
" %A, %b %d, %X %z %Y "
" %A, %b %d, %X %Z %Y "
*/
int main(int argc,char *argv[])
{

   char date[] = "6 Mar 2001 12:33:45";
   char fmt[80];
   struct tm tm;

   if (argc==1) return 0;
   strcpy(fmt,argv[1]);
   memset(&tm, 0, sizeof(struct tm));
   if (strptime(date,"%d %b %Y %H:%M:%S",&tm)==NULL) printf("error\n");
   char buf[128];
   strftime(buf, sizeof(buf), fmt, &tm);
   printf("%s\n", buf);
   printf("%d\n", tm.tm_isdst);
   if (strptime(buf,fmt,&tm)==NULL) printf("error\n");
   else {
   printf("year: %d; month: %d; day: %d;\n",
         tm.tm_year, tm.tm_mon, tm.tm_mday);
   printf("hour: %d; minute: %d; second: %d\n",
         tm.tm_hour, tm.tm_min, tm.tm_sec);
   printf("week day: %d; year day: %d\n", tm.tm_wday, tm.tm_yday);
   }
   return 0;
} 
```

当我使用“ %A, %b %d, %X %z %Y ”作为转换格式参数时，代码提供了一些结果如下：

```
 ~/user$ ./test_time " %A, %b %d, %X %z %Y "
 Tuesday, Mar 06, 12:33:45 +0000 2001 
 0
 year: 101; month: 2; day: 6;
 hour: 12; minute: 33; second: 45
 week day: 2; year day: 64 
```

当我将参数更改为“ %A, %b %d, %X %Z %Y ”时，代码无法解析 strftime 生成的格式完全相同的时间字符串。

```
 ~/user$ ./test_time " %A, %b %d, %X %Z %Y "
  Tuesday, Mar 06, 12:33:45 EET 2001 
 0
 error 
```

我是否错过了让 strptime 正确解析时区名称的内容？

提前致谢，

阿尔伯特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-25T22:45:05.513

我不确定你在做什么会奏效。github 上的[glibc 源代码](https://github.com/andikleen/glibc/blob/master/time/strptime_l.c)对此事有这样的说法：

```
case 'Z':
    /* XXX How to handle this? */
    break 
```

其次是对小写内容的一些更“肉”的处理`'z'`:-)

所以这里最有可能发生的是字符串指针没有超过`EET`格式字符串的时间`%Z`，因此当它尝试处理时`%Y`，它会抱怨，正确的是，那`EET`不是一个有效的年份。`"%%"`代码实际上*确实*推进了输入字符串指针的简单案例证实了这一点`rp`：

```
case '%':
    /* Match the `%' character itself.  */
    match_char ('%', *rp++);
    break; 
```

Linux 手册页还说明了扩展（其中`'Z'`之一）：

> 出于对称的原因，glibc 尝试支持 strptime() 与 strftime(3) 相同的格式字符。（大多数情况下会解析相应的字段，但不会更改 tm 中的字段。）

此外[GNU 文档](http://www.gnu.org/software/libc/manual/html_node/Low_002dLevel-Time-String-Parsing.html)状态（我的斜体）：

> **%Z：**时区名称。注意：目前，这还没有完全实现。格式被识别，*输入被消耗*，但没有设置 tm 中的字段。

所以我实际上认为这是一个错误，尽管可以通过更改文档轻松修复它以停止假装它可以处理`Z`-type 时区。

我在 bugzilla 中找不到任何相关的错误，所以我在 glibc 上提出了一个错误。你可以[在这里](http://sourceware.org/bugzilla/show_bug.cgi?id=14876)追踪它。

* * *

> 附录：根据上一段中的错误报告链接和[glibc 2.19 发布通知](https://sourceware.org/ml/libc-alpha/2014-02/msg00224.html)，我建议的更改已进行，以使代码与文档保持一致。希望它没有错误，否则我看起来很傻，因为它只有五行代码。

# javascript - 为用户获取网站的 Cookie

> ID：13556262
> 
> 赞同：0
> 
> 时间：2012-11-25T22:31:30.063
> 
> 标签：javascript, cookies

是否可以在网页的 cookie 文件中搜索与特定用户对应的 cookie？例如，给定[此处](https://stackoverflow.com/q/4003823/807223)定义的任何函数，我希望能够传入一个网站 URL，一个名称和函数返回该用户的 cookie（如果有）；这一切都是在我运行脚本时发生的。

或者，如何从收集的 cookie 中获取用户名？

此外，当我运行 document.cookie 之类的命令时，它会返回一个包含一些变量和值的对话框。localle、c_user、csm、sub、act等变量……这些变量的含义是什么？是否可以在给定用户名的情况下唯一标识 cookie？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:34:44.487

JavaScript 在嵌入 HTML 文档时，可以访问浏览器为该页面设置的 cookie。

它不能访问不同页面的 cookie（除非 cookie 在它们之间共享）。

它无法访问其他浏览器的 cookie（因为 cookie 没有存储在运行 JS 的浏览器中）。

更新重新编辑（顺便说一句，这应该是一个新问题）：

`document.cookie`给你一个包含文档 cookie 的字符串。cookie 名称由设置它们的代码的作者确定。他们的意思是那个人想要他们表达的意思。

Cookie 可以通过它们的名称来识别。Cookie 没有用户名（尽管设置 cookie 的代码的作者可能将用户名存储在 cookie 中）。

# audio - 如何计算音频文件大小？

> ID：13556265
> 
> 赞同：11
> 
> 时间：2012-11-25T22:31:41.153
> 
> 标签：audio, bitrate, quantization, sample-rate

您有 30 秒的音频文件以 44.1 KHz 的速率采样并使用 8 位进行量化；计算此文件的单声道和立体声版本的比特率和大小 ؟؟

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-26T07:18:34.233

比特率是每秒的比特数。

```
bitrate = bitsPerSample * samplesPerSecond * channels 
```

所以在这种情况下，立体声比特率为 8 * 44100 * 2 = 705,600kbps

要获得文件大小，请将比特率乘以持续时间（以秒为单位），然后除以 8（从位到字节）：

```
fileSize = (bitsPerSample * samplesPerSecond * channels * duration) / 8; 
```

所以在这种情况下，30 秒的立体声将占用 (8 * 44100 * 2 * 30) / 8 = 2,646,000 字节

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-25T22:42:25.220

假设未压缩的 PCM 音频...

`time * sampleRate * bitsPerSample * channelCount`

对于 44.1kHz、8bps 的 30 秒单声道音频，即 1,323,000 字节。对于立体声，这是两个通道，所以加倍。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-27T10:02:31.670

公式 = 采样率 x 采样位 x 通道数 x 时间（以秒为单位）/8x1024

CD 质量（采样率）= 44.1Khz

```
Size of mono = (44 100 x 8 x 1 x 30) / 8 x 1024
             = 1291.99KB
             = 1.26 MB

Size of Stereo = (44 100 x 8 x 2 x 30) / 8 x 1024
               = 2583.98 KB
               = 2.52 MB
               ≈ 2.5 MB 
```

# objective-c - 如何防止 NSWindow 在 windowWillClose 方法上关闭？

> ID：13556275
> 
> 赞同：0
> 
> 时间：2012-11-25T22:33:17.660
> 
> 标签：objective-c, xcode, macos, cocoa, nswindow

`windowWillClose`调用该方法时，如何防止我的 NSWindow 被关闭？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T22:37:19.613

你不能。等到`windowWillClose:`叫到的时候，已经晚了。您需要在此之前使用 停止它`windowShouldClose:`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-31T05:09:35.670

快速示例：

您需要设置的委托`NSWindow`和实施`NSWindowDelegate`

```
func windowShouldClose(_ sender: NSWindow) -> Bool {
     return false
} 
```

# ruby-on-rails - Rails 以非英语语言显示通知

> ID：13556279
> 
> 赞同：0
> 
> 时间：2012-11-25T22:33:59.913
> 
> 标签：ruby-on-rails, notice

我有这个代码：

```
 if @art.save
    flash[:notice] = "Successfully saved!"
  end 
```

但我需要这样的东西（俄语）：

```
 if @art.save
    flash[:notice] = "Успешно сохранено в бд!"
  end 
```

当然它给了我错误，但是有什么方法可以在 RoR 中使用非英语通知？还是我必须使用语言环境？那我怎么只翻译那个通知呢？（在 html 中属于 .n1 类）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:38:51.577

我认为您缺少魔术编码注释。将此添加到文件顶部

```
# encoding: utf-8 
```

此外，更好的**方法**是使用内置的[国际化 api](http://guides.rubyonrails.org/i18n.html)。有了它，您的代码将如下所示：

```
flash[:notice] = I18n.t(:successful_save) 
```

并且您所有的俄语字符串都将包含在其中`config/locales/ru.yml`，并且不会在源代码中造成任何麻烦。

# haskell - Haskell中的合并排序进入无限循环

> ID：13556287
> 
> 赞同：0
> 
> 时间：2012-11-25T22:35:06.977
> 
> 标签：haskell

大家好，我正在尝试在 haskel 中重现合并排序，这是我的代码：

```
-- merge
merge :: (Ord a) => [a] -> [a] -> [a]
merge [] [] = []
merge xs [] = xs
merge [] ys = ys
merge (x:xs) (y:ys)
  | x <= y = x:(merge xs (y:ys))
  | otherwise = y:(merge (x:xs) ys)

-- split
splitIn2 :: (Ord a) => [a] -> ([a],[a])
splitIn2 [] = ([],[])
splitIn2 xs = splitAt ((length xs `div` 2)+1) xs

-- msort
msort :: (Ord a) => [a] -> [a]
msort [] = []
msort [x] = [x]
msort (xs) = merge (msort as) (msort bs)
    where (as,bs) = splitIn2 xs 
```

它在 ghc 上编译，适用于：

```
*Main> msort([])
[]
*Main> msort([1])
[1] 
```

然而它不能正确地完成它的工作，因为它开始无限循环（至少这是我的想法）并且它不打印任何东西。

我认为这是因为我没有像在其他递归实验中那样从列表中删除元素，有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-25T22:52:15.433

问题是当`length xs == 2`,

```
(length xs `div` 2) + 1
= (2 `div` 2) + 1
= 1 + 1
= 2 
```

并`splitAt 2 xs`返回`(xs, [])`。由于第一个列表仍然是 length `2`， 将在无限循环中再次`msort`尝试向下。`splitIn2`

要解决这个问题，您可以简单地摆脱`+1`; 这是完全没有必要的。您还可以消除空列表的特殊情况，因为`splitAt 0 [] = ([], [])`.

```
splitIn2 xs = splitAt (length xs `div` 2) xs 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T22:42:51.663

```
*Main> splitIn2 [1, 2, 3, 0, 5, 6]
([1,2,3,0],[5,6]) 
```

并经过小改动（删除`+1`）：

```
splitIn2 xs = splitAt ((length xs `div` 2)) xs 
```

有用：

```
*Main> splitIn2 [1, 2, 3, 0, 5, 6]
([1,2,3],[0,5,6])
*Main> msort [1, 2, 3, 0, 5, 6]
[0,1,2,3,5,6] 
```

# html - Textarea 文本对齐

> ID：13556288
> 
> 赞同：3
> 
> 时间：2012-11-25T22:35:07.973
> 
> 标签：html, textarea

在我的 HTML 表单中，我有以下内容

```
Title: <textarea cols="50" id="title" name="title" rows="4"></textarea> 
```

结果是“标题：”这个词与文本区域底部的高度相同。我可以让它位于中间吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T22:40:21.627

将垂直对齐设置为中间。

```
textarea {vertical-align:middle}​ 
```

[**演示**](http://jsfiddle.net/mowglisanu/TSJkL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:51:08.557

`<label>Title: <textarea cols="50" id="title" name="title" rows="4"></textarea></label>`

然后设置标签元素的样式。

# ruby - 升级到 Mountain Lion 后，Rails 应用程序无法运行（Heroku + Git）

> ID：13556289
> 
> 赞同：0
> 
> 时间：2012-11-25T22:35:16.883
> 
> 标签：ruby, macos, git, heroku, osx-lion

今天我从 Snow Leopard 升级到 Mountain Lion，当我尝试检查 Heroku 上托管的 Rails 应用程序时， `heroku open` 我会收到以下错误消息：

```
 !    Heroku client internal error.
 !    Search for help at: https://help.heroku.com
 !    Or report a bug at: https://github.com/heroku/heroku/issues/new

    Error:       No such file or directory -  git --version  (Errno::ENOENT)
    Backtrace:   /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/helpers.rb:105:in ``'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/helpers.rb:105:in `has_git?'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/helpers.rb:110:in `git'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/command/base.rb:206:in `git_remotes'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/command/base.rb:179:in `extract_app_in_dir'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/command/base.rb:31:in `app'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/command/apps.rb:269:in `open'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/command.rb:193:in `run'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/lib/heroku/cli.rb:25:in `start'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.4/bin/heroku:16:in `<top (required)>'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/bin/heroku:19:in `load'
                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/bin/heroku:19:in `<main>'

    Command:     heroku open
    Plugins:     heroku-sql-console
    Version:     heroku-gem/2.30.4 (x86_64-darwin10.8.0) ruby/1.9.2 
```

当我尝试检查**git**时： `git status` 我会得到：

```
-bash: git: command not found 
```

发生了什么事？升级到新版**OS X**移除**Git 和 Heroku**？

**编辑：**好的，所以关于`git`解决 Hombrew 安装的问题。但是，当我运行应用程序 - 时`rails s`，我得到了：

```
Unable to load the EventMachine C extension; To use the pure-ruby reactor, require 'em/pure_ruby'
/Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require': dlopen(/Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/eventmachine-1.0.0/lib/rubyeventmachine.bundle, 9): Library not loaded: /opt/local/lib/libssl.1.0.0.dylib (LoadError)
  Referenced from: /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/eventmachine-1.0.0/lib/rubyeventmachine.bundle
  Reason: image not found - /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/eventmachine-1.0.0/lib/rubyeventmachine.bundle
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/eventmachine-1.0.0/lib/eventmachine.rb:8:in `<top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/thin-1.5.0/lib/thin.rb:7:in `<top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:68:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:66:in `each'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:66:in `block in require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:55:in `each'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:55:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler.rb:122:in `require'
    from /Users/adam/rubydev/future_computers/config/application.rb:7:in `<top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:53:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

我还尝试在声明中添加提到的 gem `gem "eventmachine"`- 即使我没有在我的应用程序中使用它，但没有帮助我。仍然是相同的错误消息。

谁能帮助我，请，如何解决这个问题？

提前谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:50:06.670

转到[http://mxcl.github.com/homebrew/](http://mxcl.github.com/homebrew/)并安装 homebrew 并运行

```
$ brew install git 
```

它似乎`git`丢失了，你需要它。过渡过程中一定有什么问题——你可能需要再次安装它，并且可能需要 rvm + ruby​​——但是因为它们存储在你的主目录中，所以你应该没问题。以防万一：

```
$ rvm get stable
$ rvm install 1.9.3 
```

如果您的 rails 和 heroku gem 丢失，您可能还需要再次下载它们。

该错误似乎来自在系统目录中安装 git，并且在您升级时它被覆盖 - 使用自制软件，这样您就安全了，它不会再次发生。

# java - Android 中的 RSA 加密

> ID：13556295
> 
> 赞同：6
> 
> 时间：2012-11-25T22:36:22.453
> 
> 标签：java, android, encryption, rsa

我正在编写一个在 Android 中使用 RSA 的程序。我有以下问题：我正在获取 RSA 密钥：

```
KeyPair kp = kpg.genKeyPair();
publicKey = kp.getPublic();
privateKey = kp.getPrivate(); 
```

使用加密函数加密测试字符串：

```
String test ="test";
byte[] testbytes = test.getBytes();
Cipher cipher = Cipher.getInstance("RSA");
cipher.init(Cipher.ENCRYPT_MODE, publicKey);
byte[] cipherData = cipher.doFinal(testbytes);
String s = new String(cipherData);
Log.d("testbytes after encryption",s); 
```

在解密函数中，我将数据解密回来以获取原始字符串

```
Cipher cipher2 = Cipher.getInstance("RSA");
cipher2.init(Cipher.DECRYPT_MODE, privateKey);
byte[] plainData = cipher.doFinal(cipherData);
String p  = new String(plainData);
Log.d("decrypted data is:",p); 
```

日志中打印出来的 'p' 中的数据与原始字符串 "test" 不匹配。我在哪里错了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T18:43:43.133

这是一个关于如何做到这一点的例子，**但**在实践中，

> 仅使用 RSA 无法真正加密和解密整个文件。RSA算法只能加密单个块，做整个文件比较慢。
> 您可以使用 3DES 或 AES 加密文件，然后使用预期收件人的 RSA 公钥加密 AES 密钥。

一些代码：

```
public static void main(String[] args) throws Exception {
    KeyPairGenerator kpg = KeyPairGenerator.getInstance("RSA");
    Cipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");

    kpg.initialize(1024);
    KeyPair keyPair = kpg.generateKeyPair();
    PrivateKey privKey = keyPair.getPrivate();
    PublicKey pubKey = keyPair.getPublic();

    // Encrypt
    cipher.init(Cipher.ENCRYPT_MODE, pubKey);

    String test = "My test string";
    String ciphertextFile = "ciphertextRSA.txt";
    InputStream fis = new ByteArrayInputStream(test.getBytes("UTF-8"));

    FileOutputStream fos = new FileOutputStream(ciphertextFile);
    CipherOutputStream cos = new CipherOutputStream(fos, cipher);

    byte[] block = new byte[32];
    int i;
    while ((i = fis.read(block)) != -1) {
        cos.write(block, 0, i);
    }
    cos.close();

    // Decrypt
    String cleartextAgainFile = "cleartextAgainRSA.txt";

    cipher.init(Cipher.DECRYPT_MODE, privKey);

    fis = new FileInputStream(ciphertextFile);
    CipherInputStream cis = new CipherInputStream(fis, cipher);
    fos = new FileOutputStream(cleartextAgainFile);

    while ((i = cis.read(block)) != -1) {
        fos.write(block, 0, i);
    }
    fos.close();
} 
```

# python - 改进代码 - Python

> ID：13556298
> 
> 赞同：0
> 
> 时间：2012-11-25T22:36:57.533
> 
> 标签：python

此代码有效，但不是尽可能有效。你能告诉我如何使它更有效吗？我相信没有这么多功能是不可能的，但我忘记了如何。该脚本是一个多选测验。我已将每个问题定义为一个新功能。这是最好的方法吗？

```
def firstq (): # 1st Question
    global q1list,answer1
    q1list = ["Wellington","Auckland","Motueka","Masterton"]
    q1count = 0
    print ("Question 1")
    print ("From which of the following Towns is the suburb NEWLANDS located?")
    while q1count < 4:
        print (q1count,"  ",q1list[q1count])
        q1count = q1count + 1
    answer1 = int(input("What number answer do you choose?"))
    if answer1 == 0: print ("Correct answer!")
    elif answer1 != 0: print ("Sorry! Incorrect Answer. Better luck with the next Question.")
    print("Next Question below:")
    print(" ")
    print(" ")

def secq (): #Second Question
    global q2list,answer2 # Makes answer2 and q2list avalible anywhere on the page.
    q2list = ["Wellington","Christchurch","Pairoa","Dunedin"] # List of answers to choose from.
    q2count = 0 # defines what the q2 count is. SEE BELOW
    print ("Question 2")# prints "question 2"
    print ("What NZ town is known for L&P?") # Prints the question
    while q2count < 4:
        print (q2count,"  ",q2list[q2count]) # Whilst the number of answers (q2list) is below 4 it will print the next answer.
        q2count = q2count + 1
    answer2 = int(input("What number answer do you choose?")) # asks for answer
    if answer2 == 2: print ("Correct answer!") # If answer is correct, prints "Correct answer"
    elif answer2 != 2: print ("Sorry! Incorrect Answer. Better luck with the next Question.") # If answer is correct, prints "Sorry! Incorrect Answer. Better luck with the next Question."
    print("Next Question below:") # prints "Next Question
    # these provide spacing!
    print(" ")
    print(" ")

def thrq ():
    global q3list,answer3
    q3list = ["Lewis Carroll","J.K. Rowling","Louis Carroll","Other"]
    q3count = 0
    print ("Question 3")
    print ("Who wrote the book Alice In Wonderland?")
    while q3count < 4:
        print (q3count,"  ",q3list[q3count])
        q3count = q3count + 1
    answer3 = int(input("What number answer do you choose?"))
    if answer3 == 0: print ("Correct answer!")
    elif answer3 != 0: print ("Sorry! Incorrect Answer. Better luck with the next Question.")
    print("Next Question below:")
    print(" ")
    print(" ")

def fouq ():
    global q4list,answer4
    q4list = ["WA","DC","WD","WC"]
    q4count = 0
    print ("Question 4")
    print ("What is the abbreviation for Washington?")
    while q4count < 4:
        print (q4count,"  ",q4list[q4count])
        q4count = q4count + 1
    answer4 = int(input("What number answer do you choose?"))    
    if answer4 == 1: print ("Correct answer!")
    elif answer4 != 1: print ("Sorry! Incorrect Answer. Better luck with the next Question.")
    print("Next Question below:")
    print(" ")
    print(" ")

def fivq ():
    global q5list,answer5
    q5list = ["Yes","No, they're found around New Zealand","No","No, they're found around the UK"]
    q5count = 0
    print ("Question 5")
    print ("Are walruses found in the South Pole?")
    while q5count < 4:
        print (q5count,"  ",q5list[q5count])
        q5count = q5count + 1
    answer5 = int(input("What number answer do you choose?"))
    if answer5 == 2: print ("Correct answer!")
    elif answer5 != 2: print ("Sorry! Incorrect Answer. Better luck with the next Question.")
    print("Next Question below:")
    print(" ")
    print(" ")

def sixq ():
    global q6list,answer6
    q6list = ["G.M.","General M's","G Motors","Grand Motors"]
    q6count = 0
    print ("Question 6")
    print ("What is the other name for General Motors?")
    while q6count < 4:
        print (q6count,"  ",q6list[q6count])
        q6count = q6count + 1
    answer6 = int(input("What number answer do you choose?"))    
    if answer6 == 0: print ("Correct answer!")
    elif answer6 != 0: print ("Sorry! Incorrect Answer. Better luck with the next Question.")
    print("Next Question below:")
    print(" ")
    print(" ")

def sevq ():
    global q7list,answer7
    q7list = ["Greece","USA","Egypt","Italy"]
    q7count = 0
    print ("Question 7")
    print ("Which of the following countries were cats most honored in?")
    while q7count < 4:
        print (q7count,"  ",q7list[q7count])
        q7count = q7count + 1
    answer7 = int(input("What number answer do you choose?"))
    if answer7 == 2: print ("Correct answer!")
    elif answer7 != 2: print ("Sorry! Incorrect Answer. Better luck with the next Question.")
    print("Next Question below:")
    print(" ")
    print(" ")

def eigq ():
    global q8list,answer8
    q8list = ["I find","I see","I presume","I am"]
    q8count = 0
    print ("Question 8")
    print ("Complete this phrase-Dr. Livingstone,")
    while q8count < 4:
        print (q8count,"  ",q8list[q8count])
        q8count = q8count + 1
    answer8 = int(input("What number answer do you choose?"))       
    if answer8 == 2: print ("Correct answer!")
    elif answer8 != 2: print ("Sorry! Incorrect Answer. Better luck with the next Question.")

    print(" ")
    print(" ")

def end():
    if answer1 == 0 and answer2 == 2 and answer3 == 0 and answer4 ==1 and answer5 ==2 and answer6 ==0 and answer7 == 2 and answer8 == 2: print("YAY, all questions correct! You have won the 1 million!")
    else: print("Sorry you have some incorrect questions! You have not won any money! :(") # If all answers are correct, this will display YAY, all questions correct! You have won the 1 million! If not it will print Sorry you have some incorrect questions! You have not won any money! :(.

def printorder ():
    # Defines ther order that it will be printed in
    firstq()
    secq()
    thrq()
    fouq()
    fivq()
    sixq()
    sevq()
    eigq()
    end()

name = l" " # while name is blank it will continue
while name != "quit": #While the name is not quit it will continue. If name is quit it will stop.
    print ("The $1,000,000 Quiz! Can you win the 1 Million?")#Prints Welcome Message
    name = input("Lets Get Started! What is your name: ")# asks for name
    if name == "quit": 
       break # if the name is quit it will stop if not....
    printorder()# ....prints printorder 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:42:28.637

这只是一个指针。

代替

```
def sixq():
    global q6list, answer6
    ... 
```

创建一个函数

```
def question(qlist, qanswer):
    ... 
```

`qlist`并作为参数传入和传递`qanswer`，许多代码是重复的，可以通过这种方式消除。同时你也消除了`global`s 的使用。您可以使用在此函数末尾返回调用代码所需的任何值`return`。（注意 Python 允许你返回多个值）

根据需要调整上面的内容，即如果您需要提供另一个参数等。本质上，您希望将重复的代码分解为*单个*函数，并提供使其独特的必要参数。

***最后***，使用单个函数代替八个函数，将使您的代码更容易*维护。*如果你发现你的代码有问题，或者只是想改变一些东西，你只需要在一个地方更正它，而不是在 8 个不同的函数中。这是一个主要的好处。

# c - 了解Linux中的堆栈

> ID：13556302
> 
> 赞同：3
> 
> 时间：2012-11-25T22:37:10.347
> 
> 标签：c, linux, assembly, disassembly

我有一个小的（易受攻击的）C 样本：

```
#include <unistd.h>

int main(int argc, char *argv[])
{
    char buff[100];

    if(argc < 2)
    {
        printf("Syntax: %s <input string>\n", argv[0]);
        exit (0);
    }

    strcpy(buff, argv[1]);
    return 0;
} 
```

我编译它：

```
gcc -o basic_overflow basic_overflow.c -fno-stack-protector -fno-builtin 
```

当我用 gdb 打开这个程序时，反汇编是这样的：

```
Dump of assembler code for function main:
   0x08048424 <+0>: push   ebp
   0x08048425 <+1>: mov    ebp,esp
   0x08048427 <+3>: and    esp,0xfffffff0
   0x0804842a <+6>: add    esp,0xffffff80
... 
```

在 main 中设置断点（在序言之后）。由于我们有一个本地缓冲区，我希望我的堆栈帧大小为 100 字节。但是，当我执行 $ebp-$esp 时，我可以看到结果实际上是 136。

平台：`Linux user-VirtualBox 2.6.38-8-generic #42-Ubuntu SMP Mon Apr 11 03:31:50 UTC 2011 i686 i686 i386 GNU/Linux`

编译器：`gcc (Ubuntu/Linaro 4.5.2-8ubuntu4) 4.5.2` 调试器：`GNU gdb (Ubuntu/Linaro 7.2-1ubuntu11) 7.2` 我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:16:41.387

这不仅仅是局部变量的大小——一般来说，还有填充到平台 ABI 指定的大小、损坏的寄存器、`alloca()`区域……——例如查看[这张漂亮的图片](http://docs.huihoo.com/embedded-devkit/1.0/getting-started-guide/gstools.html#11645)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:57:32.777

缓冲区地址很难获得。我也有这个问题。有一篇很好的文章教你如何[粉碎堆栈。](http://insecure.org/stf/smashstack.html) 但在我的电脑上，ubuntu 12.04，gcc 4.6 或 4.4.7，我测试了最新的 eggshell.c，结果是核心转储。他将shellcode放在环境变量中。但是必须找到环境变量地址。我还发现smash the stack有时没有效果。任何人都可以帮助让它运行吗？

# c++ - 优化 C++ 向量以进行搜索

> ID：13556307
> 
> 赞同：3
> 
> 时间：2012-11-25T22:37:43.553
> 
> 标签：c++, optimization

在我目前的项目中，我尽最大努力坚持过早优化是万恶之源的原则。但是，现在代码已经过测试，是时候进行优化了。我做了一些分析，结果发现我的代码将近 20% 的时间都花在了一个函数中，在这个函数中它找到了所有可能的孩子，把它们放在一个向量中，然后返回它们。请注意，我正在优化速度，内存限制不是一个因素。

现在函数看起来像这样：

```
void Board::GetBoardChildren(std::vector<Board> &children)
{
    children.reserve(open_columns_.size()); // only reserve max number of children

    UpdateOpenColumns();

    for (auto i : open_columns_)
    {
        short position_adding_to = ColumnToPosition(i);
        MakeMove(position_adding_to); // make the possible move
        children.push_back(*this); // add to vector of children
        ReverseMove(); // undo move
    }
} 
```

根据分析，我的代码花费了大约 40% 的时间就在`children.push_back(*this);`我这样调用函数的行上：

```
std::vector<Board> current_children;
current_state.GetBoardChildren(current_children); 
```

我在想，由于可能的孩子的最大数量很小（7），只使用一个数组会更好吗？还是我不能做很多事情来优化这个功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:44:36.077

从您对我的评论的回复来看，似乎大部分时间都花在了抄板

```
children.push_back(*this); 
```

您需要找到一种方法来避免制作所有这些副本，或者找到一种使它们更便宜的方法。

简单地将向量更改为数组或列表可能不会对性能产生任何影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:02:24.113

最重要的问题是：你真的需要同时在 current_state 中的所有状态吗？如果您只是按默认顺序对它们进行一次或两次迭代，则不需要向量，只需按需生成它们即可。

如果你真的需要它，这是下一步。由于`Board`复制成本很高，`DifferenceBoard`因此只跟踪差异可能会更好。伪代码：

```
struct DifferenceBoard { // or maybe inherit from Board that a DifferenceBoard
                         // can be built from another DifferenceBoard
  Board *original;
  int fromposition, toposition;
  State state_at_position;

  State get(int y, int x) const {
    if ((x,y) == fromposition) return Empty;
    if ((x,y) == toposition  ) return state_at_position;
    return original->get();
  }
}; 
```

# android - 如何将通知灯用作一次性通知？

> ID：13556311
> 
> 赞同：0
> 
> 时间：2012-11-25T22:38:28.053
> 
> 标签：android, notifications, android-notifications

我有一个应用程序需要在显示器关闭时进行调试。有没有办法使用通知灯来显示个别中断？

我正在测量 GPS 的变化，并希望在每次 GPS 变化（约 1 秒）时闪光。

我可以让它经常闪烁吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:05:09.770

像这样的东西：

```
Notification notification = new Notification(iconId, text, when);
notification.defaults |= Notification.DEFAULT_LIGHTS;
notification.flags |= Notification.FLAG_SHOW_LIGHTS;
notification.ledOnMS = 1000;
notification.ledOffMS = 1000; 
```

请注意，某些设备需要关闭屏幕才能显示 LED 通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:00:21.897

你可以试试这个。创建带有标志 FLAG_SHOW_LIGHTS 的通知

notification.ledARGB = 颜色.白色；

然后每秒更新您的通知并更改通知 LED 的颜色。

# iphone - 带有 int64_t 的简单数学函数不起作用

> ID：13556313
> 
> 赞同：-1
> 
> 时间：2012-11-25T22:38:42.767
> 
> 标签：iphone, ios, ipad, integer

> **可能重复：**
> [如何将两个整数相除并得到十进制答案？](https://stackoverflow.com/questions/2976011/how-do-you-divide-two-integers-and-get-a-decimal-answer)

这可能真的很容易，但我找不到解决方案。我不是一个“真正的”程序员......

我正在使用 int_64 在我的应用程序中存储数字和分数。

```
 .h

 int64_t score;

 @property (nonatomic, assign) int64_t score;

.m

 @synthesize score; 
```

这是数学：

```
self.score = 7/3; 
```

结果是“2”，而不是“2.33333...”。我应该使用与 int_64 不同的东西，但是什么？

我希望结果是“2,33”，逗号后有两位数。任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:51:16.527

`int`存储整数，也称为整数。对于带有小数部分的计算，请使用`double`.

此外，最好在格式化显示时固定位数。例如：

```
double score = 7.0/3.0;
NSString *strScore = [NSString stringWithFormat:@"%.2f", score]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:40:56.067

您应该使用`double`来存储十进制数字而不是`int`. 如果您尝试将十进制数存储在 int 中，它将被四舍五入。

> @property (nonatomic, assign) 双倍分数；

# haskell - Biapplicative 和 Bimonad？

> ID：13556314
> 
> 赞同：32
> 
> 时间：2012-11-25T22:38:44.503
> 
> 标签：haskell, monads

Haskell的`Data.Bifunctor`基本上是：

```
class Bifunctor f where
  bimap :: (a -> c) -> (b -> d) -> f a b -> f c d 
```

我也能找到一个`Biapply`。我的问题是，为什么没有完整的双层次结构（层次结构？），例如：

```
class Bifunctor f => Biapplicative f where
  bipure :: a -> b -> f a b
  biap :: f (a -> b) (c -> d) -> f a c -> f b d 

class Biapplicative m => Bimonad m where
  bibind :: m a b -> (a -> b -> m c d) -> m c d

  bireturn :: a -> b -> m a b
  bireturn = bipure

bilift :: Biapplicative f => (a -> b) -> (c -> d) -> f a c -> f b d
bilift f g = biap $ bipure f g 

bilift2 :: Biapplicative f => (a -> b -> c) -> (x -> y -> z) -> f a x -> f b y -> f c z
bilift2 f g = biap . biap (bipure f g) 
```

Pair 是其中的一个实例：

```
instance Bifunctor (,) where
  bimap f g (x,y) = (f x, g y)

instance Biapplicative (,) where
  bipure x y = (x,y)
  biap (f,g) (x,y) = (f x, g y)

instance Bimonad (,) where
  bibind (x,y) f = f x y 
```

和类型如...

```
data Maybe2 a b = Fst a | Snd b | None
--or 
data Or a b = Both a b | This a | That b | Nope 
```

...国际海事组织也会有实例。

没有足够的匹配类型？还是我的代码存在严重缺陷？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-26T16:24:44.773

范畴论中的单子是内函子，即域和余域是同一类别的函子。但是 a`Bifunctor`是从产品类别`Hask x Hask`到的函子`Hask`。但我们可以尝试找出该`Hask x Hask`类别中的 monad 是什么样的。它是一个类别，其中对象是成对的类型，即，而箭头是成对的函数，即从到`(a, b)`的箭头具有类型。此类别中的内函子将类型对映射到类型对，即到，并将箭头对映射到箭头对，即`(a, b)``(c, d)``(a -> c, b -> d)``(a, b)``(l a b, r a b)`

```
(a -> c, b -> d) -> (l a b -> l c d, r a b -> r c d) 
```

如果你把这个 map 函数拆分成 2，你会看到一个 endofunctor和两个s`Hask x Hask`是一样的，并且。`Bifunctor``l``r`

现在对于 monad:`return`和`join`是箭头，所以在这种情况下两者都是 2 个函数。`return`是从`(a, b)`到的箭头`(l a b, r a b)`，是从到`join`的箭头。这是它的样子：`(l (l a b) (r a b), r (l a b) (r a b))``(l a b, r a b)`

```
class (Bifunctor l, Bifunctor r) => Bimonad l r where
  bireturn :: (a -> l a b, b -> r a b)
  bijoin :: (l (l a b) (r a b) -> l a b, r (l a b) (r a b) -> r a b) 
```

或分离出来：

```
class (Bifunctor l, Bifunctor r) => Bimonad l r where
  bireturnl :: a -> l a b
  bireturnr :: b -> r a b
  bijoinl :: l (l a b) (r a b) -> l a b
  bijoinr :: r (l a b) (r a b) -> r a b 
```

类似于`m >>= f = join (fmap f m)`我们可以定义：

```
 bibindl :: l a b -> (a -> l c d) -> (b -> r c d) -> l c d
  bibindl lab l r = bijoinl (bimap l r lab)
  bibindr :: r a b -> (a -> l c d) -> (b -> r c d) -> r c d
  bibindr rab l r = bijoinr (bimap l r rab) 
```

## 相对单子

最近，已经开发了[相关单子。](http://www.cs.nott.ac.uk/~psztxa/publ/Relative_Monads.pdf)相对单子不需要是内函子！如果我们将论文翻译成`Bifunctor`Haskell 中的 s，你会得到：

```
class RelativeBimonad j m where
  bireturn :: j a b -> m a b
  bibind :: m a b -> (j a b -> m c d) -> m c d 
```

它定义了一个相对于双函子的单子`j`。如果你选择`j`成为`(,)`你的定义。

定律与单子定律相同：

```
bireturn jab `bibind` k = k jab
m `bibind` bireturn = m
m `bibind` (\jab -> k jab `bibind` h) = (m `bibind` k) `bibind` h 
```

第一定律防止`Maybe2`成为实例，因为`bibind`必须能够从 的结果中提取两个值`bireturn`。

# python - 在 Pyramid 中渲染模板和 JSON

> ID：13556319
> 
> 赞同：0
> 
> 时间：2012-11-25T22:39:14.043
> 
> 标签：python, json, pyramid

我正在使用远端将 JSON 值从会话加载到 Web 应用程序中。但是，当我最初使用 Chameleon 模板渲染页面时，我想加载一些任意 JSON 值来填充结构。做这个的最好方式是什么？

我目前正在做的是使用模板呈现页面，然后在文档准备好时使用 javascript 请求 JSON。但是，这会导致加载中的卡顿。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:44:08.343

您可以在几个视图之间共享相同的数据。如果请求是通过 AJAX 进行的，您将返回数据的 json 编码版本 ( `some_data_route`)。如果您还想在呈现初始 html 页面时呈现此数据，那么只需将其传递到您的模板并在那里处理它。

```
@view_config(route_name='some_data_route', renderer='json')
def data_view(request):
    data = load_data(request) # find the data somewhere
    return {'data': data}

@view_config(route_name='some_route', renderer='some_route.html.mako')
def view(request):
    data = load_data(request)
    return {'data': data} 
```

现在，如果您愿意，您可以做一些技巧来使模板中的呈现代码更类似于 ajax 处理代码。例如，也许您想进行 JSON 编码`data`，然后在您的变色龙模板中，您可以将该数据传递到您的 AJAX 回调中。在加载 javascript 之前不会调用它，但至少它不需要初始 HTTP 请求。

在 Pyramid 1.4 中有一个很酷的技巧，可以在 mako 中嵌入一些 html 渲染`def`，您可以直接从 Python 调用它。这允许您使用相同的 HTML 片段作为 AJAX 响应或直接在您的模板中。我认为变色龙也存在此功能，但我不确定。

# .net - 尝试从指定的行索引返回列表视图中单词的第一个实例

> ID：13556326
> 
> 赞同：0
> 
> 时间：2012-11-25T22:41:12.653
> 
> 标签：.net, vb.net, visual-studio-2010, function, listview

就像标题说的那样，我试图从指定的索引返回列表视图中单词的第一个实例。所以这意味着它不会从列表视图的开头搜索它实际上会从我添加到参数中的任何行返回。我似乎无法让它工作，我可以让它与所选项目一起工作，但不能与参数中的变量输入一起工作。

```
 Private Function FindLogic(ByVal LV As ListView, ByVal CIndex As Integer, ByVal SearchFor As String) As Integer
    Dim idx As Integer
    Dim It = From i In LV.Items Where i.index > LV.Items(CIndex).Index And i.Text = SearchFor
    If It.Count > 0 Then
        idx = It(0).Index
    Else
        idx = -1
    End If
    Return idx
    End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T05:53:34.053

您的查询存在一些问题：例如，您缺少 Select 部分。这似乎可以解决问题：

```
Dim It As List(Of ListViewItem)
It = (From i As ListViewItem In lvwMain.Items Where i.Index > CIndex And i.Text = SearchFor Select i).ToList 
```

我假设 CIndex 是您要开始搜索的 ListView 项目的索引。如果是这样，则无需查找该项目只是为了获取其索引值（它将与 CIndex 相同）。

# ruby - 如何“忽略”捕获的异常？

> ID：13556327
> 
> 赞同：11
> 
> 时间：2012-11-25T22:41:12.620
> 
> 标签：ruby, exception-handling

我使用[rufus 调度程序](https://github.com/jmettraux/rufus-scheduler)通过调用我的函数来运行夜间测试脚本。

有时我会看到“调度程序捕获异常：”一条消息，它抛出了我的一些函数。然后调度程序停止执行以下测试用例。

我怎样才能让调度程序运行所有测试用例而不管捕获到任何异常？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-25T22:46:22.140

这称为“异常吞咽”。你拦截了一个异常并且不做任何事情。

```
begin
  # do some dangerous stuff, like running test scripts
rescue => ex
  # do nothing here, except for logging, maybe
end 
```

* * *

如果您不需要对异常执行任何操作，则可以省略`=> ex`：

```
begin
  # do some dangerous stuff, like running test scripts
rescue; end 
```

如果您需要救援[不从子类化的异常`StandardError`](https://stackoverflow.com/a/5120214/405017)，您需要更加明确：

```
begin
  # do some dangerous stuff, like running test scripts
rescue Exception
  # catches EVERY exception
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T23:11:11.527

我有时会使用这样一个事实，即您可以将块传递给方法，并且我有方法救援错误，并且我的代码可以继续执行。

```
def check_block                                
  yield                                        
rescue NoMethodError => e                      
   <<-EOR
     Error raised with message "#{e}".        
     Backtrace would be #{e.backtrace.join('')}
   EOR
end    

puts check_block {"some string".sort.inspect}
puts check_block {['some', 'array'].sort.inspect} 
```

第一个区块将通过救援并返回报告，第二个区块将正常运行。

此救援仅`NoMethodError`在您可能需要救援其他错误时进行救援。

# html - 在 XQuery HTML 输出中保留空格

> ID：13556328
> 
> 赞同：1
> 
> 时间：2012-11-25T22:41:15.723
> 
> 标签：html, formatting, xquery

当我运行 galax-run a.xq 时，a.xq 是

```
<html>
<body>
<ul>
{
    for $x in doc("books.xml")/bookstore/book
    return <li>{data($x/title)}</li>
}
</ul>
</body>
</html> 
```

输出全部在一行上。如何保持 a.xq 中的格式（新行和其他空格）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T13:50:25.243

结果 xmllint --format a.xml 将打印一个格式整齐的 a.xml 版本。这就是我所需要的。您还可以通过管道传输到 xmllint，如下所示：

```
galax-run a.xq | xmllint --format - 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T08:41:09.930

您的问题是关于“[边界空白](http://www.w3.org/TR/xquery/#id-whitespace)”，它被剥离或保留，具有实现定义的默认行为。但是，您可以通过使用边界空间声明来覆盖默认值。为了保留边界空白，请使用

```
declare boundary-space preserve; 
```

在查询序言中。有关详细信息，请参阅[http://www.w3.org/TR/xquery/#id-boundary-space-decls](http://www.w3.org/TR/xquery/#id-boundary-space-decls)。

请注意，这决定了构造节点的布局。它们的外观也可能受到序列化设置的影响。序列化程序可以选择重新引入边界空间，即使它在构建时被剥离。您必须查阅特定于实现的文档才能找到答案。

# iphone - 2 个视图控制器，一个带有项目列表 - 传递给第一个 VC

> ID：13556331
> 
> 赞同：1
> 
> 时间：2012-11-25T22:41:39.070
> 
> 标签：iphone, core-data, viewcontroller

我有一个标签栏控制器界面，其主要概念是创建一个 ID，通过文本字段添加名称，然后通过推送 segue 将多个用户选择的属性添加到视图控制器。

我已经解决了主要添加 ID 视图控制器和推送 segue 以从详细视图控制器添加单个属性，但现在我想修改场景......

1.  在详细视图控制器上，我有一个程序列表，用户可以选择一个传递回主视图的程序...如何将其设置为“复选框”或多选方法并拥有所有程序选择传回主视图而不仅仅是一个？

2.  我使用核心数据作为我的存储模型以及主要实体“MedRec”与构成 MedRec 数据的其他实体之间的关系——“程序”、“级别”、“日期”等。

    ```
    #import "MedRecTVC.h"

    #import "MedRec.h"

    @implementation MedRecTVC

    @synthesize fetchedResultsController = _fetchedResultsController;
    @synthesize managedObjectContext = _managedObjectContext;
    @synthesize selectedMedRec;

    -(void)setupFetchedResultsController

    {
    // 1 - Decide what Entity you want

    NSString *entityName = @"MedRec"; //Put your entity name here
    NSLog(@"Setting up a Fetched Results Controller for the Entity named %@", entityName);

    // 2 - Request the Entity

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:entityName];

    // 3 - Filter it if you want

    //request.predicate = [NSPredicate predicateWithFormat:@"Level.name = Blah"];

    // 4 - Sort it if you want

    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor            sortDescriptorWithKey:@"number" ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)]];

    // 5 - Fetch it

    self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:nil];

    [self performFetch];

    }

    - (void)viewWillAppear:(BOOL)animated
    {
    [super viewWillAppear:animated];
    [self setupFetchedResultsController];
    }

    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
    static NSString *CellIdentifier = @"MedRec Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    //configure the cell

    //decide the order of table cell text and detail text

    MedRec *medrec = [self.fetchedResultsController objectAtIndexPath:indexPath];
    NSString *number = [NSString stringWithFormat:@"%@", medrec.number];
    cell.textLabel.text = number;
    cell.detailTextLabel.text = medrec.inLevel.level1;

    return cell;
    }

    - (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

    if (editingStyle == UITableViewCellEditingStyleDelete) {

    [self.tableView beginUpdates]; // Avoid  NSInternalInconsistencyException

    // Delete the role object that was swiped
    MedRec *medrecToDelete = [self.fetchedResultsController objectAtIndexPath:indexPath];
    NSLog(@"Deleting (%@)", medrecToDelete.number);
    [self.managedObjectContext deleteObject:medrecToDelete];
    [self.managedObjectContext save:nil];

    // Delete the (now empty) row on the table
    [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    [self performFetch];

    [self.tableView endUpdates];
    }
    }

    - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
    {
    if ([segue.identifier isEqualToString:@"Add MedRec Segue"])
    {
    NSLog(@"Setting MedRecTVC as a delegate of AddMedRecTVC");

    AddMedRecTVC *addMedRecTVC = segue.destinationViewController;
    addMedRecTVC.delegate = self;
    addMedRecTVC.managedObjectContext = self.managedObjectContext;
    }

    else if ([segue.identifier isEqualToString:@"MedRec Detail Segue"])
    {
    NSLog(@"Setting MEdRecTVC as a delegate of MedRecDetailTVC");
    MedRecDetailTVC *medrecDetailTVC = segue.destinationViewController;
    medrecDetailTVC.delegate = self;
    medrecDetailTVC.managedObjectContext = self.managedObjectContext;

    NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
    self.selectedMedRec = [self.fetchedResultsController objectAtIndexPath:indexPath];

    NSLog(@"Passing selected medrec (%@) to MedRecDetailTVC", self.selectedMedRec.number);
    medrecDetailTVC.medrec = self.selectedMedRec;
    }

    else {
    NSLog(@"Unidentified Segue Attempted!");
    }

    }

    - (void)theSaveButtonOnTheAddMedRecTVCWasTapped:(MedRecDetailTVC *)controller
    {
    //refresh the table
    //close delegated view
    [controller.navigationController popViewControllerAnimated:YES];

    }

    - (void)theSaveButtonOnTheMedRecDetailTVCWasTapped:(MedRecDetailTVC *)controller
    {
    [controller.navigationController popViewControllerAnimated:YES];
    }

    @end 
    ```

# windows-phone-7 - 显示地理坐标对象的折线

> ID：13556334
> 
> 赞同：4
> 
> 时间：2012-11-25T22:41:52.810
> 
> 标签：windows-phone-7, windows-phone-8, windows-phone, here-api

我有一堆 GeoCoordinate 对象，我希望将它们显示为折线（以显示一个人所走的路径）。

我不成功的尝试（不显示任何行）：

```
var map = new Map(); // Nokia Maps
var layer = new MapLayer();
var overlay = new MapOverlay();
var polyline = new MapPolyline();

var gc = new GeoCoordinateCollection();
foreach(var geo in MyGeoCoordinateList) {
  gc.Add(geo);
}

polyline.Path = gc;
polyline.StrokeColors = Colors.Red;
polyline.StrokeThickness = 3;

overlay.Content = polyline;

layer.Add(overlay);
map.Layers.Add(layer);
LayoutRoot.Children.Add(map); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T16:44:04.217

事实证明，要显示路径（它只是连接点而不像 Mike Brown 的示例中那样遵循道路），您需要将折线添加到 MapElements 对象，即：

```
var map = new Map(); // Nokia Maps 
var polyline = new MapPolyline();

var gc = new GeoCoordinateCollection();
foreach(var geo in MyGeoCoordinateList) {
  gc.Add(geo);
}

polyline.Path = gc;
polyline.StrokeColors = Colors.Red;
polyline.StrokeThickness = 3;

map.MapElements.Add(polyline);
LayoutRoot.Children.Add(map); 
```

作为奖励，这里是如何设置地图，使其包含视口中的点（带有漂亮的动画）：

```
map.SetView(LocationRectangle.CreateBoundingRectangle(MyGeoCoordinateList, MapAnimationKind.Parabolic); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T03:49:09.253

我想做同样的事情，我使用了一个 GeoQuery 传递所有的航点。该查询生成了一条路线，然后我将其显示在 UI 上。

```
var query = new RouteQuery();
query.Waypoints = new[]
{
   new GeoCoordinate(40.7840553533410,-73.9764425910787),
   new GeoCoordinate(40.7833068308611,-73.9745997113487),
   new GeoCoordinate(40.7826229881351,-73.9730985576614),
   new GeoCoordinate(40.7821147220884,-73.9719513345183),
   new GeoCoordinate(40.7809503161196,-73.9724639235822),
   new GeoCoordinate(40.7803311395532,-73.9721954245488),
   new GeoCoordinate(40.7795640919224,-73.9729398991417),
};
query.TravelMode = TravelMode.Walking;
var result = await query.GetRouteAsync();
var mapRoute = new MapRoute(result);
mapRoute.Color = Colors.Magenta;
mainMap.AddRoute(mapRoute); 
```

mainMap 是我的 UI 中的地图控件。该查询创建了一条遵循可用路径的路线（因为我将其标记为步行路径，所以它使用了中央公园的人行道）。

# eclipse - 谷歌应用引擎 -

> ID：13556338
> 
> 赞同：1
> 
> 时间：2012-11-25T22:42:09.747
> 
> 标签：eclipse, google-app-engine, jaxb, jax-rs, eclipse-juno

我正在努力在 Eclipse Juno 中配置 JAX-RS 以部署到 Google App Engine，事实上，我还没有让本地部署工作（Jetty）。

这是我遇到的堆栈跟踪，但我不明白为什么当我包含所有球衣 jar 文件时它仍然无法找到类 com.sun.jersey.spi.container.servlet.ServletContainer（过度杀伤我知道）和所有 JAXB JAR 文件（我什至还没那么关心！）。

```
2012-11-25 22:22:50.622 java[5703:707] [Java CocoaComponent compatibility mode]: Enabled
2012-11-25 22:22:50.623 java[5703:707] [Java CocoaComponent compatibility mode]: Setting timeout for SWT to 0.100000
Nov 25, 2012 10:22:51 PM com.google.apphosting.utils.jetty.JettyLogger info
INFO: Logging to JettyLogger(null) via com.google.apphosting.utils.jetty.JettyLogger
Nov 25, 2012 10:22:51 PM com.google.apphosting.utils.config.AppEngineWebXmlReader readAppEngineWebXml
INFO: Successfully processed /Users/Rob/Development/HillingarIncidentReporting/HillingarGaeServer/war/WEB-INF/appengine-web.xml
Nov 25, 2012 10:22:51 PM com.google.apphosting.utils.config.AbstractConfigXmlReader readConfigXml
INFO: Successfully processed /Users/Rob/Development/HillingarIncidentReporting/HillingarGaeServer/war/WEB-INF/web.xml
Nov 25, 2012 10:22:52 PM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: EXCEPTION 
java.lang.ClassNotFoundException: com.sun.jersey.spi.container.servlet.ServletContainer
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:207)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at org.mortbay.util.Loader.loadClass(Loader.java:91)
    at org.mortbay.util.Loader.loadClass(Loader.java:71)
    at org.mortbay.jetty.servlet.Holder.doStart(Holder.java:73)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:242)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.appengine.tools.development.JettyContainerService.startContainer(JettyContainerService.java:205)
    at com.google.appengine.tools.development.AbstractContainerService.startup(AbstractContainerService.java:249)
    at com.google.appengine.tools.development.DevAppServerImpl.start(DevAppServerImpl.java:157)
    at com.google.appengine.tools.development.DevAppServerMain$StartAction.apply(DevAppServerMain.java:333)
    at com.google.appengine.tools.util.Parser$ParseResult.applyArgs(Parser.java:48)
    at com.google.appengine.tools.development.DevAppServerMain.<init>(DevAppServerMain.java:269)
    at com.google.appengine.tools.development.DevAppServerMain.main(DevAppServerMain.java:245)
Nov 25, 2012 10:22:52 PM com.google.appengine.tools.development.ApiProxyLocalImpl log
SEVERE: javax.servlet.ServletContext log: unavailable
javax.servlet.UnavailableException: com.sun.jersey.spi.container.servlet.ServletContainer
    at org.mortbay.jetty.servlet.Holder.doStart(Holder.java:79)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:242)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.appengine.tools.development.JettyContainerService.startContainer(JettyContainerService.java:205)
    at com.google.appengine.tools.development.AbstractContainerService.startup(AbstractContainerService.java:249)
    at com.google.appengine.tools.development.DevAppServerImpl.start(DevAppServerImpl.java:157)
    at com.google.appengine.tools.development.DevAppServerMain$StartAction.apply(DevAppServerMain.java:333)
    at com.google.appengine.tools.util.Parser$ParseResult.applyArgs(Parser.java:48)
    at com.google.appengine.tools.development.DevAppServerMain.<init>(DevAppServerMain.java:269)
    at com.google.appengine.tools.development.DevAppServerMain.main(DevAppServerMain.java:245)

Nov 25, 2012 10:22:52 PM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: failed Jersey Web Application: java.lang.NullPointerException
Nov 25, 2012 10:22:52 PM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: Failed startup of context com.google.appengine.tools.development.DevAppEngineWebAppContext@798baf36{/,/Users/Rob/Development/HillingarIncidentReporting/HillingarGaeServer/war}
java.lang.NullPointerException
    at java.lang.Class.isAssignableFrom(Native Method)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:256)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.appengine.tools.development.JettyContainerService.startContainer(JettyContainerService.java:205)
    at com.google.appengine.tools.development.AbstractContainerService.startup(AbstractContainerService.java:249)
    at com.google.appengine.tools.development.DevAppServerImpl.start(DevAppServerImpl.java:157)
    at com.google.appengine.tools.development.DevAppServerMain$StartAction.apply(DevAppServerMain.java:333)
    at com.google.appengine.tools.util.Parser$ParseResult.applyArgs(Parser.java:48)
    at com.google.appengine.tools.development.DevAppServerMain.<init>(DevAppServerMain.java:269)
    at com.google.appengine.tools.development.DevAppServerMain.main(DevAppServerMain.java:245)
Nov 25, 2012 10:22:52 PM com.google.appengine.tools.development.DevAppServerImpl start
INFO: The server is running at http://localhost:8888/
Nov 25, 2012 10:22:52 PM com.google.appengine.tools.development.DevAppServerImpl start
INFO: The admin console is running at http://localhost:8888/_ah/admin
2012-11-25 22:22:55.378 java[5703:6c03] Unable to obtain JNIEnv for context: 0x0 
```

这是 Eclipse 项目中指定的所有 JAR 文件的屏幕截图 - 我假设 Jetty 将其用于本地部署？

![构建路径中引用的 JAR - 配置构建路径](../Images/be699a296513aa02dfaad70e51067b43.png)

此外，这是 /war/WEB-INF/lib 文件夹中的 SAME Jersey 和 JAXB jar 文件的副本，正如许多其他论坛所建议的那样，它最终部署在 Google App Engine 中时

![部署的战争库文件](../Images/568259d3a9f20ea0f2eb5ad2bb9eb747.png)

**问题 1** 首先，我需要解决 JAR 未加载的原因。我试图更改它们的加载顺序（我似乎只能在构建路径 - 配置构建路径中这样做），所以在这里我首先设置 jersey-servlet-1.15.jar 文件（因为它有违规类当下）。

每次尝试解决此问题后，我都会清理我的项目。有谁知道我可能会错过什么？

**问题 2** 此外，在较低优先级上，我还想知道 Jersey 和 JAXB 罐子实际上需要什么，我怀疑我只需要一个非常小的子集。也许所有的罐子都是冲突的，虽然我试过只有 jersey-servley-1.15.jar 并且它仍然抱怨！

**问题 3** 我注意到 Jersey 包含 asm-3.1.jar - 但 GAE 已经包含 asm-4.0.jar，我是否应该不包含 3.1，因为新版本已经存在？

**问题 4** 当我尝试创建一个扩展 ServletContextListener 的类时，Eclipse 没有在类列表中提供“ServletContextListener”，但在类路径中我可以清楚地看到“App Engine SDK”版本 1.7.3 包含 servlet-api。 jar，我怀疑它在运行时默认也包含在 Jetty 中。

请，您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:16:37.513

也许您需要在 web.xml 中添加 servlet 映射？例如（使用 Spring，但应该类似）：

```
<servlet>
    <servlet-name>REST Service</servlet-name>
    <servlet-class>com.sun.jersey.spi.spring.container.servlet.SpringServlet</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>com.evogro</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.spi.container.ContainerRequestFilters</param-name>
        <param-value>com.sun.jersey.api.container.filter.LoggingFilter</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.spi.container.ContainerResponseFilters</param-name>
        <param-value>com.sun.jersey.api.container.filter.LoggingFilter</param-value>
    </init-param>
        <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>REST Service</servlet-name>
    <url-pattern>/api/*</url-pattern>
</servlet-mapping> 
```

Q2：您的列表与我的匹配（通过 maven 包含）。我正在使用球衣 1.13。我不知道这是否是您可以逃脱的最低限度

Q3：我已将 ASM-3.3.1 作为 datanucleus-enhancer 的依赖项包含在内。它在要部署的 jar 列表中。GAE 将换掉它不喜欢的任何罐子

Q4：ServletContextListener 是一个接口，你自己实现。在新类向导中，Eclipse 应该在添加接口部分向您提供它。

我希望其中一些可以解决您的一些问题。我对这些东西很陌生！

# html - CSS三角形边与左边的圆形？

> ID：13556341
> 
> 赞同：5
> 
> 时间：2012-11-25T22:42:32.257
> 
> 标签：html, css

我正在尝试如下创建它并且无法完成它。

我只能设法在左侧创建一个圆角，但不能在右侧创建一个斜角。

[![对齐顶部](../Images/a7abe41610530c9d228287ed34037906.png "工具提示")](https://i.stack.imgur.com/M0W66.png "工具提示")
[（来源：[kerrydeaf.com](http://www.kerrydeaf.com/arrow.png)）]

```
#talkbubble
 {
width: 100px;
height: 35px;
background: #FFCC05;
position: relative;
-moz-border-radius:8px 0 0 8px;
-webkit-border-radius:8px 0 0 8px;
border-radius:8px 0 0 8px;
margin-right:50px;
 } 
```

或者这里是 [http://jsfiddle.net/alma/USezL/23/](http://jsfiddle.net/alma/USezL/23/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:58:43.753

我认为这就是你正在寻找的[http://css-tricks.com/snippets/css/css-triangle/](http://css-tricks.com/snippets/css/css-triangle/)

[http://jsfiddle.net/zQKhb/](http://jsfiddle.net/zQKhb/)

```
#talkbubble 
{ 
    width: 100px;
    height: 36px;
    background: #FFCC05;
    position: relative;
    -moz-border-radius:8px 0 0 8px;
    -webkit-border-radius:8px 0 0 8px;
    border-radius:8px 0 0 8px;
    margin-right:50px;

} 

#talkbubble:before
{
    content:"";
    display:block;
    position: absolute;
    right: -36px;
    top:0;
    width: 0;
    height: 0;
    border: 18px solid transparent;

    border-color: transparent transparent #FFCC05 #FFCC05;
}
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T22:59:05.477

您在右侧的三角形中遗漏了一些关键点。首先，默认情况下 :before 元素是`display: inline`，因此要创建您正在寻找的效果，您需要`display: block`代替。

其次，`right: 120px`将其从原始位置的右侧移动了 120 像素。也就是说，它被推到左边，看不见了。相反，您需要 100%（对话气泡的宽度）的负右位置（向右移动*）*。这样，它最终会在它的右边。

第三，不确定你想要什么形状，但它几乎是除了三角形之外的所有形状；）。

我改为这样做：

```
#talkbubble:before
{
    content:" ";
    display: block;
    position: relative;
    right: -100%;

    width: 0; 
    height: 0; 
    border-left: 0 solid transparent;
    border-right: 20px solid transparent;    
    border-bottom: 35px solid #FFCC05;
} 
```

​第一部分是定位，第二部分是创建实际的三角形（参见[http://css-tricks.com/snippets/css/css-triangle/](http://css-tricks.com/snippets/css/css-triangle/)）。

在 jsfiddle 中，我将三角形设为蓝色，以便您可以准确地看到它的位置。更改右边框宽度以使角度更大。[http://jsfiddle.net/USezL/31/](http://jsfiddle.net/USezL/31/)

# php - 我应该如何在注册前保存访客的帖子？

> ID：13556342
> 
> 赞同：0
> 
> 时间：2012-11-25T22:42:39.987
> 
> 标签：php, mysql, database

我网站的访问者可以填写表格，将其存储在浏览器会话中，然后在访问者注册并确认他的电子邮件时被激活为实时帖子。问题是当浏览器在注册和确认电子邮件之间关闭时，帖子信息会丢失。我无法将作业存储在数据库中，因为那时没有将其链接到的用户 ID。我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T22:50:21.520

有一个匿名帖子表和一个帐户激活密钥作为 ID。当用户激活帐户时，找到他的激活 id 的帖子，将其添加到 post 表并从 tmp 表中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:48:34.887

将表单信息和随机哈希存储在数据库中，然后将哈希链接发送到用户的电子邮件。
如果用户单击该链接，您可以获得哈希并使用数据库信息进行检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:45:01.480

您可以有一个访问者用户，这是访问该站点的任何用户的默认用户 - 您可以将其设置为 sql 表中的默认用户 ID。

或者，您可以将信息存储在 cookie 中，有效期为一个月左右，因此如果用户再次访问并在一个月内注册，则帖子将链接到它们。

# c# - 跨云服务的 Azure（共存或专用）缓存

> ID：13556346
> 
> 赞同：0
> 
> 时间：2012-11-25T22:42:57.790
> 
> 标签：c#, caching, azure, azure-caching

是否可以将某些角色定义为云服务 A 上的并置\专用缓存角色，并从云服务 B 中的角色访问它们？

（不使用 Azure 共享缓存解决方案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:13:08.967

我很确定答案是否定的。我相信缓存角色只公开内部端点，这些端点只能从同一个云服务中访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T02:02:17.333

如果您谈论的是 Azure IaaS 虚拟机并具有与 Windows 应用程序结构缓存共同定位/混合缓存......您可以使用虚拟网络功能来组合端点。

# android - Expandablelistview 自定义组视图到高

> ID：13556347
> 
> 赞同：0
> 
> 时间：2012-11-25T22:43:00.210
> 
> 标签：android, expandablelistview

我有带有自定义 UI 的 Expandablelistview。我定义了从 BaseExpandableListAdapter 扩展的适配器。我希望我的 groupviews 的高度正好是 25dp，但它们更高

我的xml是`

```
<TextView
    android:id="@+id/product_name"
    android:layout_width="0dp"
    android:layout_height="25dp"
    android:layout_weight="2"
    android:gravity="center_vertical"
    android:paddingLeft="15dp"
    android:text="@string/products"
    android:textSize="12sp"
    android:textStyle="bold" />

<TextView
    android:layout_width="0dp"
    android:layout_height="25dp"
    android:layout_marginLeft="25dp"
    android:layout_weight="1"
    android:gravity="center"
    android:text="@string/weight_g"
    android:textSize="12sp"
    android:textStyle="bold" />

<TextView
    android:layout_width="0dp"
    android:layout_height="25dp"
    android:layout_weight="1.6"
    android:gravity="center"
    android:text="@string/measure"
    android:textSize="12sp"
    android:textStyle="bold" /> 
```

`

和我的代码

```
@Override
    public View getGroupView(final int groupPosition,
            final boolean isExpanded, final View convertView,
            final ViewGroup parent) {
        final View view = View.inflate(context,
                R.layout.header_measurements, null);

        final TextView title = (TextView) view
                .findViewById(R.id.product_name);
        title.setText(data.get(groupPosition).categoryName);

        return view;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:04:58.413

你漏掉了最重要的部分。xml 中 textviews 的容器（LinearLayout 或 RelativeLayout 等）是什么意思？布局高度应该说`android:layout_height="25dp"`或 `android:layout_height="wrap_content"`

# spring - 使用 Spring Security 存储登录用户的其他详细信息

> ID：13556349
> 
> 赞同：2
> 
> 时间：2012-11-25T22:43:12.020
> 
> 标签：spring, spring-mvc, spring-security, spring-webflow

我正在寻找正确的方法来使用 Spring Security 在我的应用程序中存储和显示登录用户的其他详细信息。

例如，我想在每一页的顶部显示*Welcome:Mr.Smith (Administrator, Math Dept) 。*为此，我想获取登录用户的前缀、姓氏、名称和部门。

我正在使用自定义`UserDetails`服务从数据库中获取用户。浏览时发现`Authentication`has`getDetails()`可以存储与身份验证相关的其他详细信息，我可以使用该方法存储其他详细信息吗？

如果是，你能举一个简单的例子吗？我可以`AuthenticationSuccessHanlder`用来做这项工作，还是我以完全错误的方式看待问题？我不应该在 spring 安全层中处理这个吗？我应该在哪里照顾它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-10T12:54:38.570

除了需要您已经确定的自定义身份验证提供程序（的实现`UserDetailsService`）之外，还可以通过**自定义框架**进一步提供的默认值来完成。

该框架提供了一个`UserDetails`接口和它的一些实现，如`User`类和其他。

# 例子

在我的一个应用程序中，我需要一个人，但不一定是该应用程序的用户。

我的方法是扩展已经提供的**Spring Security** `User`并让我的`UserDetailsService`实现返回它。

```
public class RequestUserDetails 
        extends org.springframework.security.core.userdetails.User {
    private static final long serialVersionUID = -6411988532329234916L;
    private Integer personId;

    public RequestUserDetails(String username, String password, Integer personId,
            Collection<? extends GrantedAuthority> authorities) {
        super(username, password, authorities);
        this.personId = personId;
    }

    public Integer getPersonId() {
        return personId;
    }
} 
```

+

```
@Service
public class UserSecurityService
    implements org.springframework.security.core.userdetails.UserDetailsService {
    [...]
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        [...]
        return new RequestUserDetails(
                userCreds.getLogin(), 
                userCreds.getPassword(),
                person.getId(),
                getAuthorities(domainUser.getRoles())
        );
    }
} 
```

简单的**用法**：

*   在带有`javax.security.Principal`参数的控制器级别（不绑定到 Spring MVC）：

    ```
    ( (RequestUserDetails) ((Authentication)principal).getPrincipal() ).getPersonId() 
    ```

*   在与 Spring MVC`@Controller`注释相关的控制器级别，带有一个`Authentication`参数：

    ```
    ( (RequestUserDetails)authentication.getPrincipal() ).getPersonId() 
    ```

如果您需要有关 Spring Security 的进一步参考，`UserDetails`请转到[API javadocs](http://docs.spring.io/spring-security/site/docs/current/apidocs/org/springframework/security/core/userdetails/UserDetails.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-25T23:03:53.367

额外的详细信息应该是您的自定义 UserDetailsS​​ervice 从其 loadUserByName 方法返回的自定义 UserDetails 类的属性。

# java - 在双向链表中按字母顺序排列

> ID：13556352
> 
> 赞同：1
> 
> 时间：2012-11-25T22:44:19.870
> 
> 标签：java, doubly-linked-list

我有个疑问：

我创建了以下程序，允许您介绍有关自行车的不同数据。我想做的是，当您介绍自行车的名称然后您想阅读介绍的数据时，程序会按字母顺序显示自行车的名称

这是我的代码

**NodoL.java**

```
package listaligadoble;

public class NodoL {
  String nombre;
  String estilo;
  int rodada;
  NodoL sig;
  NodoL ante;

public NodoL ()
{ nombre = "Bennoto";
  estilo = "Montana";
  rodada = 26;
  sig = null;
  ante = null;
}
public NodoL (String n,String d,int t)
{ nombre = n;
  estilo = d;
  rodada = t;
  sig = null;
  ante = null;
}
public String datos()
{return "Nombre:  " + nombre + " Estilo:  " + estilo + " Rodada:  "+rodada;
}

} 
```

**ListaLigadaD.java**

```
 package listaligadoble;
import javax.swing.*;

public class ListaLigadaD 
{ NodoL inicio;

  public ListaLigadaD()
  {inicio=null;
  }

  public void insertarIncio(String n, String d, int t)
  { NodoL ap = new NodoL (n,d,t);
    if (inicio==null)
       {ap.sig=inicio;
        inicio=ap;
       }
    else {inicio.ante=ap;
          ap.sig=inicio;
          inicio=ap;
        }
  }
  public void insertarFinal(String n, String d, int t)
   { NodoL ap = new NodoL (n,d,t);
     if (inicio == null)
        { ap.sig=inicio;
          inicio=ap;
        }
     else { NodoL aux = new NodoL();
            NodoL ultimo = new NodoL ();
             aux=inicio;
             while (aux != null)
             { if (aux.sig == null)
               { ultimo=aux;
                 aux=aux.sig;
             }
               else aux=aux.sig;
          }
          ultimo.sig=ap;
          ap.ante = ultimo;
          //ap.ante=ultimo;
          //ap.sig=null;
        }
    }

    public void recorrer()
    {if (inicio == null)
        System.out.println("Lista vacía");

     else 
    {NodoL aux;
        aux=inicio;
        while(aux!=null)
            {System.out.println(aux.datos()+"\n");
            aux=aux.sig;
            }
    }
    }

    public void borrarRodada(int dato)
    {NodoL aux=null;
    NodoL posicion=null;
    //aux=inicio;
    boolean flag=true;
    if (inicio==null)
        {System.out.println("Lista vacía");
        return;
        }
    else{aux=inicio;;
        }
    if(aux.rodada == dato)
        {inicio=aux.sig;
         System.out.println("Dato sacado:"+aux.datos());
        }
    else {while (aux!=null && flag == true)
            {if(aux.rodada == dato)
                { posicion = aux;
                  flag=false;
                }
            else aux=aux.sig;       
            }
        }
    if (aux==null)
            System.out.println("Dato no encontrado");
    else{
        try {System.out.println("Dato sacado:"+posicion.datos());
            //posicion.sig=posicion.sig.sig;
            posicion.ante.sig=posicion.sig;
            posicion.sig.ante=posicion.ante;
            }
        catch(Exception ex){}
        }
    }

    public void borrarNombre(String dato)
    {NodoL aux=null;
    NodoL posicion=null;
    //aux=inicio;
    boolean flag=true;
    if (inicio==null)
        {System.out.println("Lista vacía");
        return;
        }
    else{aux=inicio;;
        }
    if(aux.nombre.equalsIgnoreCase(dato))
        {inicio=aux.sig;
         System.out.println("Dato sacado:"+aux.datos());
        }
    else {while (aux!=null && flag==true)
            {if(aux.nombre.equalsIgnoreCase(dato))
                {posicion=aux;
                flag=false;
                }
            else aux=aux.sig;       
            }
        }
    if (aux==null)
            System.out.println("Dato no encontrado");
    else{
        try {System.out.println("Dato sacado:"+posicion.datos());
            //posicion.sig=posicion.sig.sig;
            posicion.ante.sig=posicion.sig;
            posicion.sig.ante=posicion.ante;
            }
        catch(Exception ex){}
        }
    }
    public void menu()
    {System.out.println("Opción 1: Insertar inicio");
    System.out.println("Opción 2: Insertar final");
    System.out.println("Opción 3: Recorrer");
    System.out.println("Opción 4: Eliminar por nombre");
    System.out.println("Opción 5: Eliminar por rodada");
    System.out.println("Opción 6: Salir");
    System.out.println("Elija usted una opción");
    }
    public static void main(String[] args) {
    ListaLigadaD alfa=new ListaLigadaD ();
    String n,d;
    int t;
    int opcion=0;
    boolean control=true;
    do{alfa.menu();
        opcion=Integer.parseInt(JOptionPane.showInputDialog("Escriba la opción"));
        switch (opcion)
        {case 1:n=JOptionPane.showInputDialog("Introduzca el nombre:");          
               d=JOptionPane.showInputDialog("Introduzca el estilo:");
               t=Integer.parseInt(JOptionPane.showInputDialog("Introduzca el rodada:"));
               alfa.insertarIncio(n, d,t);
               break;
        case 2:n=JOptionPane.showInputDialog("Introduzca el nombre:");          
               d=JOptionPane.showInputDialog("Introduzca el estilo:");
               t=Integer.parseInt(JOptionPane.showInputDialog("Introduzca el rodada:"));
               alfa.insertarFinal(n, d, t);
               break;
        case 3:alfa.recorrer();
               break;
        case 4:n=JOptionPane.showInputDialog("Introduzca el nombre:");
               alfa.borrarNombre(n);     
               break;
        case 5:t=Integer.parseInt(JOptionPane.showInputDialog("Introduzca el rodada:"));
               alfa.borrarRodada(t);  
               break;
        case 6: control=false;
                break;
        default:System.out.println("Opción no válida, intente otra vez");
              break; 
        }
      }
      while (control==true)  ;
    }
} 
```

因此，假设我选择选项 #1，即在列表开头插入节点。所以程序要求我介绍一个名字、一种风格和更多的东西。如果没有，我决定按 #2 并在列表末尾插入一个节点，程序会要求我提供与上述相同的信息。

Fianlly 如果我按#3，我可以看到我刚刚介绍的两种自行车，没有按字母顺序排列...

**然后我的问题是：如何使用一种方法来订购自行车的名称，以便如果我首先介绍 BMX，然后是 Benotto 作为名称，当我按 #3 显示数据时，我必须先看到 Benoto，然后是 BMX，然后依名称按字母顺序排列？**

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:56:31.710

您应该更改代码，删除 ListaLigada.java 的部分并将其替换为`ArrayList<NodoL>`or 或 a `TreeMap<NodoL>`，或者如果您还想要 a`LinkedList<NodoL>.`

无需重新实现 Java 中已经存在的集合

# css - 在 IE 中删除网站块

> ID：13556353
> 
> 赞同：2
> 
> 时间：2012-11-25T22:44:24.190
> 
> 标签：css, internet-explorer

您好，我最近将我的主题从流体宽度更改为固定宽度。我认为它进展顺利，直到我在 Internet Explorer 上注意到它，我发现它没有。当您在浏览器窗口未全屏的情况下查看它时可以，但正如您从全屏上的链接中看到的那样，一切都在 [我的网站上](http://onlinebanter.com/latest)

我一直在尝试对其进行排序，但缺少萤火虫等，即我有点挣扎。

有没有对这些事情有很好了解的人知道我的解决方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:48:30.973

从#center 中删除宽度。好的，您应该在#center 上放置 500px 的最大宽度。

# java - 为什么下面的正则表达式 [^0-9!a-zA-z#\\$%&'\\*\\+\\-/=\\?\\^_`\\{\\|\\} ~@\\.]+ for String.split 不起作用？

> ID：13556357
> 
> 赞同：4
> 
> 时间：2012-11-25T22:44:35.797
> 
> 标签：java, regex

我有这个正则表达式：

```
[^0-9!a-zA-z#\\$%&'\\*\\+\\-/=\\?\\^_`\\{\\|\\}~@\\.]+ 
```

我正在尝试使用拆分电子邮件地址

```
[Email]info@emerycommunications.com 
```

但是java中的以下代码：

```
String fileStr = "[Email]info@emerycommunications.com";

String invalidCharacters = "[^0-9!a-zA-z#\\$%&'\\*\\+\\-/=\\?\\^_`\\{\\|\\}~@\\.]+";

String[] tokens = fileStr.split(invalidCharacters);

for (String token:tokens) {
    if (token.contains("@")) {
        System.out.println(token);
    }
} 
```

给出这个输出：

```
[Email]info@emerycommunications.com 
```

我对`invalidCharacters`可变覆盖物`[`和`]`也完全一无所知。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T22:49:54.723

你有`A-z`你的字符类，方括号字符按 ASCII（和 Unicode）顺序位于大写 Z 和小写 a 之间。因此`]`被认为是一个有效而不是无效的字符 - 大概你的意思是`A-Z`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-25T22:50:19.153

这个正则表达式：

```
[^0-9!a-zA-z#\$%&'\*\+\-/=\?\^_`\{\|\}~@\.]+ 
```

匹配除方括号*之间*的字符之外的任何字符，至少匹配一个字符。方括号本身不是字符集的一部分。而且大多数反斜杠都是不必要的；除了连字符之外，没有任何反斜杠字符在字符类中是特殊的。

但是，由于您有从大写到小写的范围*，**因此*您`A-z`不仅有两次小写字母，而且还有介于and之间的所有字符，即, , , ,和。这就是方括号进入否定字符类的方式。 *`A` *`z``Z``a``[``\``]``^``_````**

 **如果这不是你想要的，这个正则表达式可能就是你要找的：

```
[^0-9!a-zA-Z#$%&'*+=?^_`{|}~@.-]+ 
```

（将连字符移到末尾意味着它不需要反斜杠）**

# android - 当 dex.force.jumbo=true 时，Dexopt 在一个非常大的 APK（乱序 method_idx）上失败

> ID：13556360
> 
> 赞同：10
> 
> 时间：2012-11-25T22:44:43.727
> 
> 标签：android, adt, dex, dexopt

我有一个非常大的 Android 项目，其中包含多个大型 3rd 方 jar（作为 Android 库）。
我相信我已经达到了 Dex 的最大方法数限制（通过 eclipse 编译）：

> [2012-11-18 02:28:45 - 在文件中查找] Dx 处理 classes.dex ...
> [2012-11-18 02:28:48 - Dex Loader] 无法执行 dex：无法将新索引 66774 合并到非巨型指令！
> [2012-11-18 02:28:48 - 在文件中查找] 转换为 Dalvik 格式失败：无法执行 dex：无法将新索引 66774 合并到非巨型指令中！

因此，我利用 SDK 工具 21（平台工具 16）将我的主项目 project.properties 编辑为 set `dex.force.jumbo=true`。
该标志允许我生成 APK。但我无法正确安装它（在物理和模拟器上）。似乎有一个 dex 优化器故障：

> 11-18 20:11:05.338: I/PackageManager(103): 运行 dexopt: com.mypackage.myapp
> 11-18 20:11:08.577: E/dalvikvm(868): 无序 method_idx: 0x2ae0 然后0x1
> 11-18 20:11:08.577: E/dalvikvm(868): 项目 1544 出现问题@偏移量 0xf7ae24
> 11-18 20:11:08.577: E/dalvikvm(868): 部分类型 2006 的交换失败
> 11-18 20 ：11：08.577：E / dalvikvm（868）：错误：字节交换+验证失败
> 11-18 20：11：08.597：E / dalvikvm（868）：优化失败
> 11-18 20：11：08.597：W / installd（ 39): DexInv: --- END '/data/app/com.mypackage.myapp-1.apk' --- status=0xff00, 进程失败
> 11-18 20:11:08.597: E/installd(39): dexopt 在“/data/dalvik-cache/data@app@com.mypackage.myapp-1.apk@classes.dex”上失败 res = 65280
> 11-18 20:11:08.697: W/PackageManager(103): 包无法安装在 /data/app/com.mypackage.myapp-1.apk
> 11-18 20:11:09.018: D/dalvikvm( 103): GC_EXPLICIT 释放 1698K, 13% 释放 17034K/19463K, 暂停 7ms+135ms
> 11-18 20:11:09.068: D/AndroidRuntime(780): 关闭 VM

我是否试图将`dex.force.jumbo`标志用于它不打算用于的目的，或者这个错误是不可预测的？
如果是这样，是否有更好的策略来生成包含大量类/方法的项目？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T21:13:02.930

64K 方法限制是 Dex 格式限制（它使用 2 个字节来查找方法）。
Nandeesh 评论指出 jumbo 只解决字符串，而不是方法。

**我尝试/考虑过的替代方案**（振作起来，它们都很烂）：
1.**自己动手**- 扔掉最胖的 3rd 方库，自己编写其功能的确切部分。这是我最终采用的方法，因为我意识到我为一个小功能包含了很多代码。
2\. [**Dalvik 中的自定义类加载**](http://android-developers.blogspot.co.il/2011/07/custom-class-loading-in-dalvik.html)- 编译一个单独的 Dex 并在运行时加载它。缺点：麻烦，需要反思。
3.**代码修剪**- 打开详细的类加载，运行应用程序并尝试删除第 3 方库，或未真正使用的库部分。缺点：由于类是动态加载的，因此耗时且容易出错。
4.**分歧和同意**- 在单独的进程（服务）中打包 3rd 方库。该服务将提供第 3 方库功能。从您的主程序执行此服务的调用。

我相信对于任何人来说，640k 的外壳应该*足够了，*否则Dalvik 的早期设计团队 *不可能在地球上的每一部第二部手机上都有这个。*

如果您想阅读更多内容或只是向 Google 大声喊叫，我已经创建了这个缺陷：[http ://code.google.com/p/android/issues/detail?id=40409](http://code.google.com/p/android/issues/detail?id=40409)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T12:39:58.947

我遇到了同样的问题。最后我发现它可能是由同名的多个方法引起的，例如doSomething(List list); 和doSomething（列表列表）；编译器说没有错误，但它无法安装到我的设备上。所以请检查你的同名方法。

# core-data - 如何预填充数据库并在核心数据中设置标志以保证每次安装应用程序时我只将对象插入数据库一次

> ID：13556363
> 
> 赞同：0
> 
> 时间：2012-11-25T22:45:04.543
> 
> 标签：core-data, nsfetchrequest, nspersistentstore

我需要使用核心数据预填充我的数据库，但需要设置一个标志来指示应用程序是否在安装后首次启动。我不知道该怎么做？

这是我在 appDelegate.m 文件中所做的

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

NSManagedObjectContext *context = [self managedObjectContext];

DJ *djsInfo = [NSEntityDescription
 insertNewObjectForEntityForName:@"DJ"
 inManagedObjectContext:context];

    /*DJ *djsInfo = [NSEntityDescription
                                  insertNewObjectForEntityForName:@"DJ"
                                  inManagedObjectContext:context];*/

djsInfo.name = @"DJ Smoke";
djsInfo.city = @"Chicago";
djsInfo.state = @"Illinois";
DJDetails *failedBankDetails = [NSEntityDescription
                                        insertNewObjectForEntityForName:@"DJDetails"
                                        inManagedObjectContext:context];
//failedBankDetails.closeDate = [NSDate date];
//failedBankDetails.updateDate = [NSDate date];
failedBankDetails.zip = [NSNumber numberWithInt:12345];
failedBankDetails.info = djsInfo;
djsInfo.details = failedBankDetails;

NSError *error;
if (![context save:&error]) {
    NSLog(@"Whoops, couldn't save: %@", [error localizedDescription]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:34:43.420

尝试使用标准的用户默认机制。

```
if (![[NSUserDefaults standardUserDefaults] 
                         objectForKey:@"ThisAppWasLaunchedBefore"]) {
   [[NSUserDefaults standardUserDefaults] setBool:YES 
                                           forKey:@"ThisAppWasLaunchedBefore"];
  // do one-time setup stuff
 } 
```

# c++ - 如何将char数组解析为double

> ID：13556368
> 
> 赞同：1
> 
> 时间：2012-11-25T22:45:46.260
> 
> 标签：c++

这是我的问题，我创建了 char temp[100] 来将数字存储在文件中，这`temp_i`是当前位置的索引（数字有`temp_i`数字）

如何将 char 数组 temp 从 0`temp_i`转换为`value`我创建的？

有谁能够帮我？

```
stack<int> first;
char temp[10]={'0','0','0','0','0','0','0','0','0','0'};
int temp_i = 0;
bool isDouble = false;
for(int index = 0; index< strlen(str); index++){
    if(str[index] != ' '){
      temp[temp_i++] = str[index];
    } 
    else if(str[index] == '.') {
      isDouble = true;
     } else {
       double value = *(double*)temp;
       cout<<value<<endl;
       first.push(value);
      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:57:52.710

如果您在数组中再分配一个插槽并将其分配给“\0”，则可以将字符数组视为 C 样式字符串。

C 风格的字符串打开了一大堆库例程，例如[`std::strtod`](http://en.cppreference.com/w/cpp/string/byte/strtof)可以[`std::sscanf`](http://en.cppreference.com/w/cpp/io/c/fscanf)帮助您。

你也可以[`std::istringstream`](http://en.cppreference.com/w/cpp/io/basic_stringstream)用来得到你的双倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:21:10.910

使用流。

```
#include<sstream>
#include<iostream>
using namespace std;

int main()
{
    char * str = "123.4567 813.333   999.11";
    stringstream converter;

    converter<<str<<str<<str;

    double number0;
    double number1;
    double number2;

    converter>>number0;
    cout<<number0<<endl;

    converter>>number1;
    cout<<number1<<endl;

    converter>>number2;
    cout<<number2<<endl;

    cin.ignore('\n', 100000);

    return 0;
} 
```

返回：

```
123.4567
813.333
999.11 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:04:06.207

[Atof](http://www.cplusplus.com/reference/cstdlib/atof/)（ascii to float）几乎完全符合您的要求。

它接受一个指向以空结尾的字符串的指针并返回一个浮点数。

您只需要将所有数字的主字符串切割成每个数字一个字符串，但是使用[stringstream](http://www.cplusplus.com/reference/sstream/stringstream/)之类的东西应该很容易。

# c++ - 绿屏图像处理色度键实时视频

> ID：13556375
> 
> 赞同：2
> 
> 时间：2012-11-25T22:47:00.253
> 
> 标签：c++, xcode, image-processing, chromakey

> **可能重复：**
> [带有绿屏或色键的avassetwriter](https://stackoverflow.com/questions/9756554/avassetwriter-with-greenscreen-or-chromakey)

我正在尝试制作一个 IOS 应用程序，该应用程序能够从摄像头获取实时视频并实现绿屏/色度键效果。我见过一些方法，但它们似乎总是在我的计算机上引发一些错误，它表明它只适用于 IOS 5 或更高版本，我想要一个也能适用于较低版本的方法。总而言之，我不知道该怎么做，我想要一些能够从相机获取实时视频，然后在其上添加具有绿屏背景的图像的东西。先感谢您！

# php - 从 Windows 7 直接 url 访问我在 vmWare/Debian 6 / Apache2 上的项目

> ID：13556376
> 
> 赞同：0
> 
> 时间：2012-11-25T22:47:09.067
> 
> 标签：php, apache2, virtualhost

我是一名网络程序员，我正在寻找一种解决方案来在 Linux 上托管我的本地项目，从 Windows 7 开始工作。

所以我安装了 VMWare Workstation，并使用 OS Debian 6 Squeeze 创建了一个虚拟机。之后我用 NAT 配置了互联网连接，设置了 apache2、mysql 和 php。

现在我可以通过 IP“ [http://192.168.195.222/somepoject](http://192.168.195.222/somepoject) ”或主机名（我在 Windows 中编辑主机文件）“ [http://myvirt/somepoject](http://myvirt/somepoject) ”从 Windows 访问我的站点，一切看起来都很棒。但问题是我想直接通过其主机名（虚拟主机的主机名）访问每个项目（我在 Debian 中为其创建了一个虚拟主机），例如“ [http://someproject.local](http://someproject.local) ”而不是“ [http:/ /192.168.195.222/someproject](http://192.168.195.222/someproject) ”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:13:59.777

我认为您希望本地主机上的每个项目都有一个绝对 URL。如果为 true，您可以在特定端口上设置任何项目。为此，请在您的 httpd.conf 中输入此代码：

对于项目一：

```
<VirtualHost 127.0.0.1:8080>
DocumentRoot /home/poject1
</VirtualHost>
Listen 127.0.0.1:8080 
```

对于项目二：

```
<VirtualHost 127.0.0.1:9090>
DocumentRoot /home/poject2
</VirtualHost>
Listen 127.0.0.1:9090 
```

最后，您可以使用 /home/poject1 根路径访问项目一，使用以下 URL：

```
http://127.0.0.1:8080/ 
```

您可以使用 /home/poject2 根路径访问项目二，使用以下 URL：

```
http://127.0.0.1:9090/ 
```

谢谢

# jquery - 设置 div 的左侧位置，之后的每个 div 都加倍

> ID：13556379
> 
> 赞同：1
> 
> 时间：2012-11-25T22:47:37.697
> 
> 标签：jquery, css, position

我有一组宽度为 960 像素的 div。我需要绝对定位这些，但将它们分开 960 像素。

所以，例如。第一个 div 的左侧位置为 0，然后是第二个 div 960px，然后是第三个 div 1920px，然后是第三个 2880px，依此类推。

这可能吗？我正在考虑使用 jQuery 和 each(); 功能，但无法解决。

非常感谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T22:49:58.367

**[jsBin 演示](http://jsbin.com/irejoh/1/edit)**

```
$('.div').each(function( i ){
  $(this).css({ left: 960 * i });
}); 
```

简单使用`.each()`回调（indexInArray）
[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

# ios - MKMapView 不改变区域

> ID：13556390
> 
> 赞同：1
> 
> 时间：2012-11-25T22:48:48.263
> 
> 标签：ios, mkmapview, zooming, segue, region

我有一个应用程序，其中有一个表格，单击一个单元格后，导航控制器会转到 MKMapView。我想手动设置地图区域，以便用户看到特定区域的缩放视图。为此，在 viewWillAppear 中我这样做：

```
CLLocationCoordinate2D coord = CLLocationCoordinate2DMake(53.345305, -6.2721597);
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(coord, 3000, 3000);
self.map.region = region; 
```

问题是，我第一次使用地图视图时，它似乎对地图没有任何影响。只有当我回到表格视图并再次切换到地图时，MKMapView 实际上才会移动到给定的坐标并放大。有没有人遇到过这种奇怪的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T09:07:03.607

会不会是 viewWillAppear 太早了，地图还没有准备好？尝试将您的代码移动到 viewDidAppear 看看是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T01:29:32.903

试试这个`viewWillAppear`

```
CLLocationCoordinate2D coord = CLLocationCoordinate2DMake(53.345305, -6.2721597);
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(coord, 3000, 3000);
MKCoordinateRegion adjustedRegion = [self.map regionThatFits:region];  
[self.map setRegion:adjustedRegion animated:YES]; 
```

# html - 如何精确定位谷歌地图控件？

> ID：13556396
> 
> 赞同：0
> 
> 时间：2012-11-25T22:49:26.503
> 
> 标签：html, css, google-maps

为了精确定制，我们如何定位谷歌地图控件？

这对于 css 来说似乎很复杂，因为它们没有特定的 id 或类。

他们都有课程：

```
.gmnoprint 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T22:49:26.503

使用 :nth-child()[选择器](http://www.w3schools.com/cssref/sel_nth-child.asp)

左控件（箭头、缩放和街景）

```
 #map .gmnoprint:nth-child(7) {
    //position:absolute; --> default
    top: whatever pt !important;
 } 
```

“地图/卫星”按钮

```
 #map .gmnoprint:nth-child(8) {
    top: whatever pt !important;
 } 
```

# php - 如何删除\"

> ID：13556398
> 
> 赞同：0
> 
> 时间：2012-11-25T22:49:39.413
> 
> 标签：php, str-replace

字符串（JSON）：`{"title":"\"Copper\""}`

我试过了

```
$output = str_replace('\\"', "", $output); 
```

但我得到了

```
{"title":""      Copper""} 
```

我的期望

```
{"title":"Copper"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:58:38.910

您的示例代码不完整，因为您提供的内容确实有效：

```
php > $s='{"title":"\"Copper\""}';
php > echo $s;
{"title":"\"Copper\""}
php > echo str_replace('\\"',"",$s);
{"title":"Copper"} 
```

（即来自`php -a`交互式会话）

换句话说，您的输入数据不是您认为的那样。

顺便说一句，正如其他人所说，最好`json_decode`在 JSON 上使用。然后只对感兴趣的字段进行字符串操作。然后使用`json_encode`将其转回 JSON。使用`str_replace`or 正则表达式可能适用于简单的情况，但一旦你得到意外的数据，它可能会出现可怕的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T22:52:49.420

您是否使用自己的代码生成 JSON 字符串（而不是从第三方获取）？如果是这样，请发布生成 JSON 字符串的代码并详细说明您为尝试解决问题所做的工作。

如果您无法控制 JSON 字符串（和/或 JSON 字符串的创建者不会/无法修复它），那么修复它的一个 hacky 方法是：

```
$output = str_replace( '\"' , '' , $output ); 
```

# tcp - netfilter 传入钩子：struct tcphdr -> dest 指针没有指向正确的位置？

> ID：13556399
> 
> 赞同：2
> 
> 时间：2012-11-25T22:49:40.380
> 
> 标签：tcp, linux-kernel, nat, netfilter

我们正在尝试为 linux 内核实现一个 NAT 模块。面临的问题是，对于传入挂钩的 TCP 数据包，预期指向目标端口的指针不这样做。传出钩子的片段：

```
unsigned int incoming_hook(unsigned int hooknum,
        struct sk_buff *skb,
        const struct net_device *in,
        const struct net_device *out,
        int (*okfn)(struct sk_buff*))
{
struct iphdr *iph;
struct tcphdr *tcph;
unsigned int dst_addr;
unsigned short dst_port;
unsigned short *dpptr;

printk(KERN_ALERT "****Incoming hook starts****\n");

if (!skb)return NF_ACCEPT;

iph = ip_hdr(skb);
if (!iph)return NF_ACCEPT;

dst_addr = ntohl(iph->daddr);     // works correct

printk(KERN_ALERT " dst addr is %d \n", dst_addr);  

if (iph->protocol==IPPROTO_TCP)
{ 
    tcph = tcp_hdr(skb);
    if (!tcph)return NF_ACCEPT;

    dst_port = ntohs(tcph->dest);   // gives incorrect result (unexpected.)
    // dpptr = (unsigned short *)((char *)iph + 22); // just a try. does not work either

    printk(KERN_ALERT " dst port is  %d  \n", *dpptr);
    dst_port = ntohs(*dpptr);

// continues with the NAT code 
```

然而，同样的事情也适用于改变源地址和源端口的传出钩子上的数据包。以下适用于传出数据包

```
tcph = tcp_hdr(skb);
  if (!tcph)return NF_ACCEPT;

  src_port = ntohs(tcph->source); 
```

传入数据包的 IP 标头大小是否有问题，或者 struct tcphdr 有错误或 tcphdr->dest 指针有问题？还是可能出了问题？

需要帮忙。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-04-19T06:23:23.207

我遇到了同样的问题，感谢一些同学和[班主任解决了。](https://stackoverflow.com/users/5720507/reuven-plevinsky)

**对于通过 netfilter 的传入**钩子到达的数据包，您应该使用`+20`（您当前有 +22 代替）。

示例代码：

```
skb_linearize(skb);
struct tcphdr* tcp_header;
tcp_header = (struct tcphdr *)(skb_transport_header(skb)+20); 
```

# c++ - Visual Studio 调试器将“true”显示为“0”

> ID：13556404
> 
> 赞同：4
> 
> 时间：2012-11-25T22:50:06.183
> 
> 标签：c++, visual-studio-2010, visual-c++

一个非常奇怪的案例刚刚发生在我身上——在使用调试器时，它向我显示某个布尔变量的值为`true`，但是当我打印它（或对其进行任何其他操作）时，它的行为为`0`（即 false）。

我能做些什么来修复这个错误？恐怕这是环境错误，因此发布代码示例将毫无意义。（一个隐藏的、烦人的内存管理错误不可能是原因，对吧？），在这种情况下，我想指出，我会惊讶地发现我的环境没有配置好（我在这个项目上工作环境一年多）。

到目前为止我：

*   仔细检查编译器在我的项目属性中没有对代码进行任何优化。
*   试图重新打开视觉工作室并清理并重新构建项目
*   在网上搜索解决方案（没有找到任何解决方案）。我使用 Visual Studio 2010，我的编程语言是 C++

关于代码共享请求：

很抱歉，我无法发布代码（我的老板不会很高兴看到它在网络上运行）......如果你能就问题的可能原因给出一些想法，那就太好了，我会自己在代码中寻找线索，检查这些原因是否真的导致了问题。然而，为了清楚起见，这里有几行代码让我很苦恼：

```
 bool dir = getNode(location)->getNext()->getDirection(); //dir is displayed as "true" in the debbuger
    int toPush = (dir == 1) ? 1 : 0; //"toPush" is displayed as "0" in the debbugger
    cout<<dir<<endl; //both output 0.
    cout<<(dir == true)<<endl; 
```

根据您的要求，我附上屏幕截图。注意屏幕右下角的“dir”值是“true”，右边的程序输出以 0 结尾（对应于“cout<< dir”命令）。

[截屏](http://i.stack.imgur.com/Qlv18.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:08:07.217

您不应该使用`==`运算符来测试`bool`值的真实性。任何非零值都为真。你有两`cout`行，控制台窗口中的最后两行说 240 和 0。我写这个是为了演示我认为正在发生的事情：

```
#include <iostream>

using namespace std;

static bool getDirection()
{
    union forceBoolValue
    {
        unsigned int iValue;
        bool bValue;
    };
    forceBoolValue retValue;
    retValue.iValue = 0xFFFFFFFF;
    return retValue.bValue;
}

int _tmain(int argc, _TCHAR* argv[])
{
    bool dir = getDirection();  //dir is now 255*, which is non-zero and therefore "true"
    int toPush = (dir == 1) ? 1 : 0;  //dir may be true but it is not one, so toPush is 0
    int toPush2 = dir ? 1 : 0;  //dir is true, so toPush2 is 1
    cout << "Dir: " << dir << endl;
    cout << "toPush: " << toPush << endl;
    cout << "toPush2: " << toPush2 << endl;
    return 0;
} 
```

类似的事情发生`dir == true`在它可能再次测试 one 的值的地方。我不知道为什么`dir`在你的代码中得到一个不寻常的值（240），但如果你删除比较并只测试值（`toPush2`如上）它应该可以解决问题。

我知道您说该`toPush`行只是为了演示问题，但是您是否在任何真实代码中进行比较？如果是这样，请删除它们。

*`dir`可能不是 255，取决于`bool`您环境中的大小。

# scala - 首先初始化匿名类型的 Scala 语法

> ID：13556410
> 
> 赞同：3
> 
> 时间：2012-11-25T22:50:26.373
> 
> 标签：scala, initialization, anonymous-types, traits

我有一个匿名类，需要在它混合的特征之前进行初始化。早期初始化不起作用，因为它们不允许使用“this”引用。如果我将类声明为具有 self 类型的内部特征，我可以使它工作，但这似乎不必要地冗长，因为该类型仅在代码中的一个地方使用，并且作为匿名类内联是直观的。但是，我似乎找到了 scala 将接受并满足我的初始化顺序要求的语法。这是一个没有多余细节的简化示例（假设我这样做是有原因的）。

```
trait WaitCondition[+T] {
...
}

trait EventWaitCondition[+T] extends WaitCondition[T] {
...
}

trait Event { outer =>
    private[this] var _cachedWaitCondition : Option[WaitCondition[T]]

    def next() : WaitCondition[T] =
        //Is there a way to "inline" the defintion of NextWaitCondition
        //without screwing up the initialization order?
        _cachedWaitCondition.getOrElse{ new NextWaitCondition with EventWaitCondition[T] }

    private[this] trait NextWaitCondition { this : WaitCondition[T] =>
        outer._cache = Some(this)
        ....
    }
    ....
} 
```

所以，基本上，我的问题是，有没有办法将 NextWaitCondition 的定义内联为匿名类型，而不改变 NextWaitCondition 和 WaitCondition 之间的初始化顺序（即，让 NextWaitCondition 仍然首先初始化）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T08:25:15.523

不确定这是你想要的，但也许这个`DelayedInit`特征会对你有所帮助。

```
trait WaitCondition[+T]

trait EventWaitCondition[+T] extends WaitCondition[T] with DelayedInit{
  def delayedInit(body: => Unit) = {
    body
    println("Initializing EventWaitCondition...")
  }
}

trait Event[T] { outer =>
  var _cachedWaitCondition: Option[WaitCondition[T]] = None
  var _cache: Option[WaitCondition[T]] = None

  def next(): WaitCondition[T] = _cachedWaitCondition.getOrElse(new EventWaitCondition[T] {
        println("Initializing NextWaitCondition...")
        outer._cache = Some(this)
      })
}

new Event[Int]{} next                           

//> Initializing NextWaitCondition...
//| Initializing EventWaitCondition... 
```

这种方法的缺点是放入之后的初始化代码`body`总是`delayedInit`被延迟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T17:32:08.020

简短的回答：当然不是。

我们必须相信你的话，弯曲初始化顺序的规律是有正当理由的。想一想那些尊重法律但仍然在法律之下受苦的灵魂。

@xiefei 的回答并不笨拙；它的结构足以影响您寻求的kludge。

有人谈论弃用 DelayedInit 以支持 postConstructor 钩子；但是您确实需要一个 preConstructor 钩子，那么为什么不使用模板方法将其形式化呢？

并且根据您的 Foo 和 SubFoo 之间的依赖关系，这可能是优先组合而不是继承的问题。然后没有具有初始化顺序的游戏。

在下文中，首先使用模板方法概括您的命名解决方案。它的优点是只有使用站点知道或关心它。

```
trait Second {
  println("I must happen after first.")
}
trait SecondDelayed extends DelayedInit {
  println("SecondDelayed neutral stuff")
  def delayedInit(body: =>Unit) {
    body // body first
    println("I must be delayed after first.")
  }
}
trait Firstly {
  def firstly
  firstly
}

object Test extends App {
  def trial(t: =>Unit) {
    println("----")
    t
  }
  // candidate for least obnoxious
  trial {
    new Firstly with Second {
      def firstly {
        println("Do this firstly.")
      }
      println("Don't care when this happens.")
    }
  }
  trial {
    // current solution
    new Something with Second
    trait Something { this: Second =>
      println("First code.")
    }
  }
  trial {
    // prefer anon
    new Second {
      println("Anon first?") // nope
    }
  }
  trial {
    // DelayedInit solution
    new SecondDelayed {
      println("Anon first, then other delayed.")
    }
  }
  trial {
    // the "delayed" code must be idempotent,
    // or find a useful way to trigger execution;
    // here, the delayed code happens twice.
    class Foo extends SecondDelayed {
      println("Foo wants init, too")
    }
    new Foo {
      println("Anon first, then other delayed.")
    }
  }
  /* early defs are only for defs, with no this
  new {
    println("Anon first.")
  } with Second
  */
  trial {
    // trait code doesn't participate
    new DelayedInit with Second {
      def delayedInit(body: =>Unit) {
        println("My crucial early init business")
        body
      }
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-18T07:03:55.667

请让我知道这是否完全错误/不合适，但这样的事情不会起作用吗？

```
def next() : WaitCondition[T] = _cachedWaitCondition.getOrElse{ 
    new {
      outer._cache = Some(this)
    } with NextWaitCondition with EventWaitCondition[T]
  } 
```

`outer._cache`据我在这里了解，只要在任何东西使用它之前进行初始化，您就不必乱搞初始化顺序。

# java - 如何仅使用命令行在 Jar 和项目之间创建依赖关系？

> ID：13556412
> 
> 赞同：0
> 
> 时间：2012-11-25T22:50:47.010
> 
> 标签：java

我在 Eclipse IDE 中创建了两个项目 P1 和 P2。P2 取决于 P1。我没有在 P1 和 P2 之间创建任何依赖关系。我想将 P1 转换为 Jar，然后让 P2 使用该 Jar。

如何使用命令行执行此操作？eclipse 中是否有我可以使用的命令行？如果没有，我将使用旧的命令行。

**编辑 -** p1 和 p2 都有一个主要方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T22:57:06.930

您需要确保 P1 和 P2 都在类路径中。通常从命令行执行程序：

> java -cp P1.jar:P2.jar -jar P2.jar

或者

> java -cp P1.jar:P2.jar xyzMyProg

有关更多信息，请参阅有关[java的](http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/java.html)[Java 工具](http://docs.oracle.com/javase/7/docs/technotes/tools/)文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T04:33:29.233

好的 -

1）看这个教程：

*   [http://www.skylit.com/javamethods/faqs/createjar.html](http://www.skylit.com/javamethods/faqs/createjar.html)

2) 假设您的整个程序由*一个*Eclipse 项目组成。

要创建 .jar 文件，您通常会使用 Eclipse IDE：`Project, <right-click>, Export, Export as .jar file`

3) 假设您想手动导出 .jar 文件，无论出于何种原因。

没问题 - 上面的教程告诉你怎么做。只是：

3a) "cd" 到你的 .class 文件所在的目录

3b) 使用记事本 (Windows) 或 vi (Linux) 创建“manifest.txt”文件

```
 EXAMPLE CONTENTS: Main-Class: MyClass 
```

3c) 使用“jar”将清单和 .class 文件放入 .jar 文件中：

```
 EXAMPLE: jar cvfm MyClass.jar manifest.txt *.class 
```

4) 您可以通过这种方式从尽可能多的不同项目中创建尽可能多的不同 .jar 文件。

5）您实际上会调用您的 .jar 文件，如 DJ 的回复中所示。

这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:57:41.660

我建议你找出你真正需要做的事情。您正在围绕该主题提出多个问题。

我假设您需要设置多个项目并在它们之间设置适当的依赖关系，以便于设置和自动构建。

查看 Maven 或 Gradle 以创建有关项目结构、依赖项外观以及如何构建的描述。

# c# - 等待/执行一个功能？

> ID：13556413
> 
> 赞同：1
> 
> 时间：2012-11-25T22:50:53.253
> 
> 标签：c#, task

我的 Start() 有一些非常慢的串行代码，所以我想我会把它扔到一个任务中并等待它。

```
await new Task(() => { c.Start(); }); 
```

这会编译，但它似乎不会运行任务，除非我调用 Start()。现在，我有 3 条线，而不是简单的一条线。有没有办法可以在一行中写下以下内容？

```
var t = new Task(() => { c.Start(); });
t.Start();
await t; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T22:59:28.560

你正在寻找`await Task.Run(c.Start)`. 如果您使用的是 .NET 4.0（而不是 4.5），则可以使用`await Task.Factory.StartNew(c.Start)`.

更喜欢`Task.Factory.StartNew`手动构建/启动a`Task`和`Task.Run`. `Task.Factory.StartNew`每个都使用更优化的实现，而不是简单的速记。

# xslt-2.0 - 根据查询字符串上传递的参数创建新的 XML

> ID：13556417
> 
> 赞同：0
> 
> 时间：2012-11-25T22:51:22.223
> 
> 标签：xslt-2.0

**问题：**

我正在尝试根据查询字符串上传递的参数创建一个新的 XML（过滤的 XML）。

**URL 示例：search_advanced.xhtml?department=CHEM&offered=Y&level=P**

例如，如果上面的查询字符串被传递，我希望过滤后的 XML 只显示那些包含

*   等于 CHEM 的部门 (fas_courses/course/department/@code)
*   提供的代码等于 Y (fas_course/course/@offered)
*   一个级别代码等于 P (fas_course/course/@offered)

下面是我一直在处理的原始 XML 文件和 XSLT 文件。感谢您的任何建议。

**原始 XML**

```
<fas_courses>
    <course acad_year="2012" cat_num="85749" offered="N" next_year_offered="2013">
        <term term_pattern_code="4" fall_term="Y" spring_term="Y">full year</term>
        <department code="VES">
            <dept_long_name>Department of Visual and Environmental Studies</dept_long_name>
            <dept_short_name>Visual and Environmental Studies</dept_short_name>
        </department>
        <course_group code="VES">Visual and Environmental Studies</course_group>
        <title>Critical Media Practice: Non Fiction Filmmaking Workshop</title>
        <course_type>Studio</course_type>
        <course_level code="G">Graduate Course</course_level>
        <description>A graduate workshop for Film Study Center non-fiction film and video projects.</description>
    </course>
    <course>
        .....
    </course>
    <course>
        .....
    </course>
</fas_courses> 
```

**XSL 文件**

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0"> 
   <xsl:param name="url"/>
   <xsl:param name="querystring"/>
   <xsl:param name="baselink"/>
   <xsl:param name="department" select="'All'"/>
   <xsl:param name="course_group" select="'All'"/>
   <xsl:param name="description" select="'All'"/>
   <xsl:param name="level" select="'All'"/>
   <xsl:param name="term" select="'All'"/>
   <xsl:param name="offered" select="'All'"/>

    <xsl:template match="/">
      <fas_courses>
         <xsl:apply-templates />
      </fas_courses>          
    </xsl:template>

   <xsl:template match="//course
      [
      ($department = '' or $department = 'All' or department/@code = $department) 
      and 
      ($course_group = '' or $course_group = 'All' or course_group/@code = $course_group)
      and 
      ($description = '' or $description = 'All' or description = $description)
      and 
      ($level = '' or $level = 'All' or course_level/@code = $level)
      and 
      ($term = '' or $term = 'All' or term/@term_pattern_code = $term)  
      and 
      ($offered = '' or $offered = 'All' or @offered = $offered)
      ]">
      <xsl:copy-of select="."/>    
   </xsl:template>  
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:28:00.267

如果您可以预处理查询字符串，则可以将这些部分作为参数传递给转换。

根据您设置的参数，我假设您不能这样做，因此下面的代码解析一个传入的参数（URL）以派生每个参数。请注意，我使用的方法假设您的查询字符串有一个更改：它可以以 & 符号结尾。如果不能，您将需要一个稍微复杂的字符串解析方法。FunctX 有一个应该可以工作的：[substring-before-if-contains](http://www.xsltfunctions.com/xsl/functx_substring-before-if-contains.html)。否则，查询中的最后一项将作为空字符串结束。

当使用作为 url 参数传入的示例 URL 片段（添加了最后的 & 符号）运行时，以下 XSL 在以下 XML 上提供所需的结果（仅返回目录号 85753）。

注意最后的空课程模板，它允许跳过不匹配的课程。没有它，您将看到那些不匹配课程的文本节点。

**XML:**

```
 <fas_courses>
    <course acad_year="2012" cat_num="85749" offered="N" next_year_offered="2013">
        <term term_pattern_code="4" fall_term="Y" spring_term="Y">full year</term>
        <department code="CHEM">
            <dept_long_name>Department of Visual and Environmental Studies</dept_long_name>
            <dept_short_name>Visual and Environmental Studies</dept_short_name>
        </department>
        <course_group code="VES">Visual and Environmental Studies</course_group>
        <title>Critical Media Practice: Non Fiction Filmmaking Workshop</title>
        <course_type>Studio</course_type>
        <course_level code="G">Graduate Course</course_level>
        <description>A graduate workshop for Film Study Center non-fiction film and video projects.</description>
    </course>
    <course acad_year="2012" cat_num="85751" offered="Y" next_year_offered="2013">
        <term term_pattern_code="4" fall_term="Y" spring_term="Y">full year</term>
        <department code="CHEM">
            <dept_long_name>Department of Visual and Environmental Studies</dept_long_name>
            <dept_short_name>Visual and Environmental Studies</dept_short_name>
        </department>
        <course_group code="VES">Visual and Environmental Studies</course_group>
        <title>Critical Media Practice: Non Fiction Filmmaking Workshop</title>
        <course_type>Studio</course_type>
        <course_level code="G">Graduate Course</course_level>
        <description>A graduate workshop for Film Study Center non-fiction film and video projects.</description>
    </course>
    <course acad_year="2012" cat_num="85753" offered="Y" next_year_offered="2013">
        <term term_pattern_code="4" fall_term="Y" spring_term="Y">full year</term>
        <department code="CHEM">
            <dept_long_name>Department of Visual and Environmental Studies</dept_long_name>
            <dept_short_name>Visual and Environmental Studies</dept_short_name>
        </department>
        <course_group code="VES">Visual and Environmental Studies</course_group>
        <title>Critical Media Practice: Non Fiction Filmmaking Workshop</title>
        <course_type>Studio</course_type>
        <course_level code="P">Graduate Course</course_level>
        <description>A graduate workshop for Film Study Center non-fiction film and video projects.</description>
    </course>
    <course acad_year="2012" cat_num="85755" offered="N" next_year_offered="2013">
        <term term_pattern_code="4" fall_term="Y" spring_term="Y">full year</term>
        <department code="CHEM">
            <dept_long_name>Department of Visual and Environmental Studies</dept_long_name>
            <dept_short_name>Visual and Environmental Studies</dept_short_name>
        </department>
        <course_group code="VES">Visual and Environmental Studies</course_group>
        <title>Critical Media Practice: Non Fiction Filmmaking Workshop</title>
        <course_type>Studio</course_type>
        <course_level code="G">Graduate Course</course_level>
        <description>A graduate workshop for Film Study Center non-fiction film and video projects.</description>
    </course>
</fas_courses> 
```

**XSL：**

```
<?xml version="1.0" encoding="UTF-8"?>
 <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0"> 
   <xsl:param name="url"/>
   <xsl:param name="querystring" select="substring-after($url, '?')"/>
   <xsl:param name="baselink" select="substring-before($url, '?')"/>
   <xsl:param name="department" select="substring-before(substring-after($querystring, 'department='), '&amp;')"/>
   <xsl:param name="course_group" select="substring-before(substring-after($querystring, 'course_group='), '&amp;')"/>
   <xsl:param name="description" select="substring-before(substring-after($querystring, 'description='), '&amp;')"/>
   <xsl:param name="level" select="substring-before(substring-after($querystring, 'level='), '&amp;')"/>
   <xsl:param name="term" select="substring-before(substring-after($querystring, 'term='), '&amp;')"/>
   <xsl:param name="offered" select="substring-before(substring-after($querystring, 'offered='), '&amp;')"/>

    <xsl:template match="/">
        <xsl:apply-templates select="fas_courses"/>
    </xsl:template>

    <xsl:template match="fas_courses">
        <xsl:copy>
             <xsl:apply-templates select="course"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="course
      [
      ($department = '' or $department = 'All' or department/@code = $department) 
      and 
      ($course_group = '' or $course_group = 'All' or course_group/@code = $course_group)
      and 
      ($description = '' or $description = 'All' or description = $description)
      and 
      ($level = '' or $level = 'All' or course_level/@code = $level)
      and 
      ($term = '' or $term = 'All' or term/@term_pattern_code = $term)  
      and 
      ($offered = '' or $offered = 'All' or @offered = $offered)
      ]">
        <xsl:copy-of select="."/>    
      </xsl:template>
      <xsl:template match="course"/> 
    </xsl:stylesheet> 
```

希望这会有所帮助。

# python - 从云存储读取，压缩到 BlobStore

> ID：13556421
> 
> 赞同：2
> 
> 时间：2012-11-25T22:52:13.033
> 
> 标签：python, google-app-engine, google-cloud-storage

我正在尝试从我的云存储桶中读取 5 个基本文本文件，将它们压缩，然后写入 BlobStore。

```
from google.appengine.api import files
from google.appengine.ext import blobstore
from google.appengine.ext.webapp import blobstore_handlers
import StringIO
import zipfile

class FactoryHandler(blobstore_handlers.BlobstoreDownloadHandler):
   def get(self):
       """ SERVE THE BLOB, IF KEY AVAILABLE """
       k = self.request.get('key')
       if k:
           self.send_blob(k)
           return

       """ TAKES FROM CLOUD STORAGE , ZIPS IT """
       zipstream = StringIO.StringIO()
       zfile = zipfile.ZipFile(file=zipstream, mode='w')
       objects = files.listdir('/gs/test-bucket')

       for o in objects:
           with files.open(o, 'r') as f:
               data = f.read(1)

               while data != "":
                   zfile.writestr(o.encode('utf-8'),data)
                   data = f.read(1)

       zfile.close()
       zipstream.seek()

       """ NOW, ADD ZIP TO BLOBSTORE """
       zip_file = files.blobstore.create(mime_type='application/zip',_blobinfo_uploaded_filename='test.zip')
       zip_data = zipstream.getvalue()
       with files.open(zip_file, 'a') as f:
           f.write(zip_data)

       files.finalize(zip_file)
       blob_key = files.blobstore.get_blob_key(zip_file)
       self.response.out.write(blob_key) 
```

不知何故，我总是只得到每个文本文件中的最后一个字符。我怀疑这是因为我在调用`f.read(1)`，但代码基本上是遍历每个字节，然后将其写入`zfile`对象。

我尝试连接数据：

```
for o in objects:
    with files.open(o, 'r') as f:
        data = f.read(1)

        while data != "":
            data += f.read(1)

        """ once completed, write """
        zfile.writestr(o.encode('utf-8'),data) 
```

但 App Engine 开发服务器挂起。可能是因为我们无法连接数据。

任何解决方案，这是否适用于非文本文件？（图像、mp3 等）

编辑：

所以我在我的生产应用程序 + Google Storage 帐户上运行了答案。

得到这个错误

```
ApplicationError: 8 
Traceback (most recent call last):
File "/base/python_runtime/python_lib/versions/1/google/appengine/ext/webapp/_webapp25.py", line       
710, in __call__
handler.get(*groups)
File "/base/data/home/apps/s~app-name/v1-55-app- 
proto.363439297871242967/factory.py", line 98, in get
with files.open(o, 'r') as f:
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/files/file.py", line 520, 
in open
exclusive_lock=exclusive_lock)
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/files/file.py", line 276,  
in __init__
self._open()

File "/base/python_runtime/python_lib/versions/1/google/appengine/api/files/file.py", line 423,    
in _open
self._make_rpc_call_with_retry('Open', request, response)
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/files/file.py", line 427,   
in _make_rpc_call_with_retry
_make_call(method, request, response)
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/files/file.py", line 252, 
in _make_call
_raise_app_error(e)

File "/base/python_runtime/python_lib/versions/1/google/appengine/api/files/file.py", line 210,  
in _raise_app_error
raise PermissionDeniedError(e)

PermissionDeniedError: ApplicationError: 8 
```

我的 ACL 设置是正确的（我之前收到了 ACL 访问被拒绝错误并修复了它）

ACL 设置添加到原始设置，特定于存储桶

```
 <Entry>
        <Scope type="UserByEmail">
            <EmailAddress>
                app-name@appspot.gserviceaccount.com
            </EmailAddress>
        </Scope>
        <Permission>
            FULL_CONTROL
        </Permission>
    </Entry> 
```

任何提示？根据来自[https://developers.google.com/appengine/docs/python/googlestorage/exceptions的文档](https://developers.google.com/appengine/docs/python/googlestorage/exceptions)

```
exception PermissionDeniedError()
The application does not have permission to perform this operation. 
```

更新 - 我注意到当我将文件设置为 public_read 时，我可以通过我的应用程序读取它们。这意味着我的应用程序未正确配置为以私有模式访问。有什么提示吗？修复它的唯一方法（我知道）是通过 ACL，我已经配置了该部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:42:51.377

本0,

函数[ZipFile.writestr()](http://docs.python.org/2/library/zipfile#zipfile.ZipFile.writestr)将整个文件写入 zipfile。您需要读取文件的所有数据，然后每个文件调用一次 writestr()。

您的第二个代码块在正确的轨道上，但需要更新 while 检查以避免无限循环。这段代码中的“数据”永远不会为空，因此需要进行一些小的更改来检查最后读取的块。像这样的东西应该工作：

```
for o in objects:
    with files.open(o, 'r') as f:
        data_list = []

        chunk = f.read(1000)

        while chunk != "":
            data_list.append(chunk)
            chunk = f.read(1000)

        data = "".join(data_list)

        """ once completed, write """
        zfile.writestr(o.encode('utf-8'),data) 
```

此外，读取大于 1 个字节的块可能会更快一些，但由于您使用的是小型文本文件，所以这并不重要。

# objective-c - 清除导航栏中的背景图像

> ID：13556423
> 
> 赞同：0
> 
> 时间：2012-11-25T22:52:34.610
> 
> 标签：objective-c, ios, cocoa-touch, ios5, ios4

我的视图控制器的 viewWillAppear 中有以下代码。

```
- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    UIImage *image = [UIImage imageNamed:@"navbar.png"];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    [self.navigationController.navigationBar addSubview:imageView];
} 
```

如何在添加新的导航栏图像之前清除已经存在的导航栏背景图像，如上面的代码中所示？

另外，如何以最有效的方式为每个不同的控制器设置不同的导航栏背景图像？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:14:21.033

在您的 viewWillAppear 方法中，使用以下调用设置导航栏的背景图像。

```
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"navbar.png"] forBarMetrics:UIBarMetricsDefault]; 
```

如果您的应用也支持横向，您还需要为横向导航栏设置不同高度的背景图片：

```
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"navbar_landscape.png"] forBarMetrics:UIBarMetricsLandscapePhone]; 
```

# jquery - Jquery帮助，单击时隐藏其他元素

> ID：13556425
> 
> 赞同：0
> 
> 时间：2012-11-25T22:52:39.087
> 
> 标签：jquery, html

任何人都可以帮我解决这个问题，基本上我想让我的 div 在单击另一个 div 时隐藏，因为我在同一个地方使用了 2 个 div，但是当我点击它们时它们都相互打开。我在想是否有可能做到这一点，所以当您单击另一个隐藏时

我的代码：

```
$(document).ready(function(){

    $('#click').click(function() {
        $('#map').toggle('slow', function() { 

        });
    });

    $('#rubinez').click(function() {
        $('#css3droppanel').toggle('slow', function() { 

        });
    });

    $('#galleryy').click(function() {
        $('#rubb').toggle('1000',function() {

        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:54:46.830

.next() 也许可以帮助你，

```
$('.box').live('click',function(){
  $(this).fadeOut(500,function(){
  $(this).next().css('display','block');
}); 
```

我不明白你的情况所以我做了这个 [http://jsfiddle.net/sejXA/](http://jsfiddle.net/sejXA/)

# javascript - 分离元素上的敲除绑定

> ID：13556432
> 
> 赞同：1
> 
> 时间：2012-11-25T22:53:41.013
> 
> 标签：javascript, knockout.js

似乎淘汰赛破坏了分离元素的绑定。因此，如果我应用绑定并分离该元素，则不仅在分离元素时不会计算该绑定，而且在将元素重新插入文档后它仍然会被破坏。

所以像：

```
ko.applyBindings(items, $list[0]);

items.push('one');

$list.detach();

items.push('two');

$container.append($list);

items.push('three'); 
```

这是一个小提琴：http: [//jsfiddle.net/nicholasstephan/KejYc/2/](http://jsfiddle.net/nicholasstephan/KejYc/2/)

$list 中的绑定应该读取一、二、三，而是不计算分离后的每次更新。

我应该在这里做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:56:25.920

最后应用绑定[使您的小提琴工作](http://jsfiddle.net/katowulf/7ZLWQ/1/)。但我不认为这就是你的目标：

```
var $container = $("#container");
var $list = $('#list');
var items = ko.observableArray([]);

items.push('one');
$list.detach();
items.push('two');
$container.append($list);
items.push('three');
ko.applyBindings(items, $list[0]); 
```

[这个 SO 线程](https://stackoverflow.com/questions/10436842/using-knockoutjs-with-detached-nodes)建议您在每次分离后重新应用绑定，或者只是隐藏元素而不是分离它们。还有一些评论建议在这种情况下重新考虑该方法，这似乎是最好的答案。

也许您可以提供所需的行为而不是人为的示例？这可能会对建议替代模型大有帮助。假设您的目标是创建可拖动的元素（即兴发挥，这是我需要分离/重新插入元素的唯一真正可能的情况），您可以采用如下方法：

1.  拖动启动
2.  拖动元素的副本（在文档中保留原件）
3.  拖动停止
4.  将任何必要的数据从原件复制到副本
5.  在新/有效位置插入复制的元素
6.  删除旧元素
7.  在新元素上调用 ko.applyBindings

# node.js - Nodejs ember-precompile 抛出 TypeError

> ID：13556433
> 
> 赞同：1
> 
> 时间：2012-11-25T22:53:42.310
> 
> 标签：node.js, ember.js, precompile

对于我的 emberjs 应用程序，我希望预编译我的 Handlebar 模板，但从终端运行 Nodejs ember-precompile 模块：

```
ember-precompile src/templates/*.handlebars -f public/js/templates.js 
```

抛出此 TypeError 错误：

```
node.js:201
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
TypeError: Object #<Object> has no method 'appendFileSync'
    at write (/usr/local/lib/node_modules/ember-precompile/bin/ember-precompile:25:10)
    at /usr/local/lib/node_modules/ember-precompile/bin/ember-precompile:32:5
    at Array.forEach (native)
    at main (/usr/local/lib/node_modules/ember-precompile/bin/ember-precompile:31:14)
    at Object.<anonymous> (/usr/local/lib/node_modules/ember-precompile/bin/ember-precompile:36:1)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:31)
    at Function._load (module.js:308:12)
    at Array.0 (module.js:479:10) 
```

什么可能导致： TypeError: Object # has no method 'appendFileSync' ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:23:44.623

我也遇到了同样的问题，当我尝试将 Handlebars 更新到最新版本时，我执行了以下步骤。

*   第 1 步：将您的节点服务器更新到最新版本。
*   第 2 步：重新启动系统。

这对我有用。

# python - App-Engine 解析 UrlFetch UTF-8 编码流

> ID：13556434
> 
> 赞同：3
> 
> 时间：2012-11-25T22:53:59.873
> 
> 标签：python, google-app-engine, parsing, encoding, streaming

我正在尝试使用解析器解析`XML`a 。我知道还有其他库可以使用，但来自这个库是我最熟悉的，对我来说似乎最不复杂。`URL``xml.sax``Java`

我用来解析的代码如下：

```
parser = xml.sax.make_parser()
handler = MangaHandler()
parser.setContentHandler(handler)
url = urlfetch.Fetch('http://www.mangapanda.com/alphabetical', allow_truncated = False, follow_redirects = False, deadline = False)
xml.sax.parseString(url.content, handler) 
```

一旦解析器到达第一个`&`符号，这将返回 SaxException（无效标记）：

```
SAXParseException: <unknown>:582:34: not well-formed (invalid token) 
```

因为`urlfetch`返回一个字符串而不是一个流，所以我不能使用`parse()`（它只适用于流），而是留给它使用`parseString()`。要查看解析为流是否可以解决此问题，我尝试了：

```
parser.parse(io.StringIO(url.content).encode('utf-8')) 
```

但这会返回：

```
TypeError: initial_value must be unicode or None, not str 
```

我还尝试使用`urllib2`返回流而不是返回流的库，`urlfetch`但文件太大并且被自动截断，从而使我丢失了数据。

任何解决此问题的方法都将不胜感激，因为我花了几天时间绕过一个障碍，只是为了被另一个障碍阻止。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-20T23:46:52.440

在 python 2.X 中，`str`类型实际上是一个字节数组，可以包含任何编码字符串。

下载编码为 UTF8 的内容时，您通常会将其作为**编码** `str`（如果未编码，则不能是`str`，因为`str`是单字节字符数组）。在这种情况下，您应该使用`decode('utf8')`将编码转换`str`为 (decoded) `unicode`，它基本上是一个两字节字符数组。

然后您可以将`unicode`实例放入`io.StringIO`实例中以创建类似对象的文件。

# android - Android MapView覆盖，绘制时缓存位图

> ID：13556435
> 
> 赞同：1
> 
> 时间：2012-11-25T22:54:18.783
> 
> 标签：android, caching, overlay, android-mapview, android-canvas

我有一个用于在我的`MapView`. 因为在`draw`我绘制路径的每一段的方法中，这很容易成为一个效率问题。

出于这个原因，我决定缓存叠加层的内容，并在必要时重新绘制它，即路径发生变化、地图中心移动或缩放级别发生变化时。

`draw`现在，该方法的参数之一是`Canvas`绘图。我知道如何在上面绘制缓存的位图，问题是我不知道如何在位图上缓存画布的内容。
我不能实例化一个新的画布，也不能调用`setBitmap`，因为画布在 a 中，如果调用该方法`HardwareCanvas`，它会抛出一个。`UnsupportedOperationException`

所以，回顾一下，我有一个画布和一个位图，我如何将画布的内容复制到位图？

**为清楚起见，编辑**
这是我的绘制方法，我不手动调用它，但即使地图根本没有移动，它仍然会被重复调用

```
public void draw(Canvas canvas, MapView map, boolean shadow) {
    if (shadow) {  
        // this overlay doesn't need to draw shadows  
        return;
    }
    if (paths.isEmpty()) {
        // nothing to draw
        return;
    }
    center = map.getMapCenter();
    zoomLevel = map.getZoomLevel();
    map.getDrawingRect(bounds);
    projection = map.getProjection();
    maxLevel = map.getMaxZoomLevel();
    for (MapPath mp : paths) {
        // adjust path width to current zoom
        adjustedWidth = mp.getWidth() * zoomLevel / maxLevel;
        if (adjustedWidth < MIN_WIDTH_TO_DRAW) {
            // path is too thin, avoid drawing it
            continue;
        }
        paint.setStrokeWidth(adjustedWidth);
        paint.setColor(mp.getColor());
        state = PathState.FIRST_POINT;
        path.reset();
        for (PathPoint pp : mp.getPoints()) {
            if (!pp.shoudAppearAtZoomLevel(zoomLevel)) {
                // do not draw this point at this zoom level
                continue;
            }
            // project a geopoint to a pixel
            projection.toPixels(pp.getGeoPoint(), point);
            inside = isInsideBounds(point, map);
            switch (state) {
            case FIRST_POINT:
                // move to starting point
                firstX = point.x;
                firstY = point.y;
                path.moveTo(firstX, firstY);
                break;
            case WAS_INSIDE:
                // segment is completely or partially on map
                path.lineTo(point.x, point.y);
                break;
            case WAS_OUTSIDE:
                if (inside) {
                    // segment is partially on map
                    path.lineTo(point.x, point.y);
                } else {
                    // segment is completely off map
                    path.moveTo(point.x, point.y);
                }
                break;
            }
            // update state
            state = inside ? PathState.WAS_INSIDE : PathState.WAS_OUTSIDE;
        }
        // workaround to avoid canvas becoming too big when path is mostly off screen
        path.moveTo(firstX, firstY);
        // draw this path to canvas
        canvas.drawPath(path, paint);
    }
    super.draw(canvas, map, shadow);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:13:08.430

您无法将位图显示到`Mapview`画布正在绘制的位置。

方法应该如下：

*   首先，您创建自己的（空的和透明的）位图，与`MapView`画布大小相同
*   然后为您的位图创建您赢得的画布（此画布是您用来绘制位图的绘图工具）并使用它绘制路径。
*   最后，将位图（已绘制路径）绘制到`MapView`画布上。

但是，您所指的性能/效率问题可能是由于您现有解决方案的设计不正确。在中型设备中，我可以在大约 3 毫秒内绘制具有 10.000 个点的路径，而无需使用位图（并且有一些不使用它们的充分理由）。

在我对这篇文章的回答中，有一些关于如何处理它的提示：[Overlay.draw() calls many times](https://stackoverflow.com/questions/12931564/overlay-draw-calls-many-times/12936520#12936520)。还要检查@shkschneider 在同一篇文章中的答案。

--已编辑--

仅通过查看代码，我无法弄清楚您为什么会收到此警告……但是使它变得比需要的复杂得多。

按以下方式组织您的代码：

**画**

该`draw()`方法仅检查是否有缩放变化（如果是，则要求重建路径）以及地图是否已移动（如果是偏移路径）并最终绘制路径。

```
@Override
public void draw(Canvas canvas, MapView mapview, boolean shadow) {
    super.draw(canvas, mapview, shadow);
    if(shadow) return;
    if(mp.getPoints() == null || mp.getPoints().size() < 2) return;

    Projection projection = mapview.getProjection();
    int lonSpanNew = projection.fromPixels(0,mapview.getHeight()/2).getLongitudeE6() - 
            projection.fromPixels(mapview.getWidth(),mapview.getHeight()/2).getLongitudeE6();
    if(lonSpanNew != pathInitialLonSpan)
        pathBuild();
    else{ //check if path need to be offset
        projection.toPixels(mp.getPoints().get(0), p1);
        if(p1.x != pathInitialPoint.x || p1.y != pathInitialPoint.y){
            path.offset(p1.x - pathInitialPoint.x, p1.y - pathInitialPoint.y);
            pathInitialPoint.x = p1.x;
            pathInitialPoint.y = p1.y;
        }

    }
    canvas.drawPath(path, paint); 
} 
```

**路径构建**

每次缩放更改时都必须构建路径。缩放变化检测是使用`pathInitialLonSpan`as `getZoomLevel()`is not syncronous 与地图缩放动画完成的。

```
private void pathBuild(){
    path.rewind(); 
    if(mp.getPoints() == null || mp.getPoints().size() < 2) return;

    Projection projection = mapView.getProjection();
    pathInitialLonSpan = projection.fromPixels(0,mapView.getHeight()/2).getLongitudeE6() - 
            projection.fromPixels(mapView.getWidth(),mapView.getHeight()/2).getLongitudeE6();

    projection.toPixels(mp.getPoints().get(0), pathInitialPoint);
    path.moveTo(pathInitialPoint.x,pathInitialPoint.y); 

    for(int i=1; i<mp.getPoints().size(); i++){
        projection.toPixels(mp.getPoints().get(i), p1);
        int distance2 = (pPrev.x - p1.x) * (pPrev.x - p1.x) + (pPrev.y - p1.y) * (pPrev.y - p1.y); 
        if(distance2 > 9){
            path.lineTo(p1.x,p1.y);
            pPrev.set(p1.x, p1.y);
        }
    } 
```

一些对象（即 p1、pPrev 等）是在类级别定义的，以避免在每次运行方法时创建新对象。

`Note:`我已经更改了变量名称以适合您正在使用的名称。我希望我没有犯任何错误，但你应该能够弄清楚这一点。

问候。

# clojure - 在 clojure 中使用 i 作为虚数的快速简单技巧

> ID：13556436
> 
> 赞同：2
> 
> 时间：2012-11-25T22:54:23.243
> 
> 标签：clojure

我只需要`i`在算法中使用。对于这样的任务，我觉得导入`clojure.math`是矫枉过正的。

为什么？

我不需要复杂的结果，实际上不需要带有虚部的实部。在我的实现中，我一次只使用一个值，并且从不将两者结合起来，除了乘法。输出最终没有参考`i`，虚部只需要查看计算中符号的变化。

简而言之，如果有一种方法可以定义`i`为：

```
(def i (....) ) 
```

这样`(* i i)`等于`-1`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T11:13:15.920

如果你想`(* i i)`评估，`-1`我们需要准备一个宏。

```
(ns user)
(defmacro *
  [& args]
  (let [i-count (count (filter #(= % 'i) args))
        error #(throw (Exception. "Illegal number of imaginary units."))
        i-factor (case (mod i-count 4)
                   0 1
                   2 -1
                   (error))]
    `(clojure.core/* ~@(conj (filter #(not= % 'i) args) i-factor)))) 
```

宏扩展为普通乘法，它不应该干扰实数的乘法。

```
user=> (macroexpand '(* i i))
(clojure.core/* -1)
user=> (macroexpand '(* i i 5 i 6 i))
(clojure.core/* 1 5 6)
user=> (macroexpand '(* 1.3 3.7))
(clojure.core/* 1 1.3 3.7)
user=> (macroexpand '(* i (+ 2 3) i))
(clojure.core/* -1 (+ 2 3)) 
```

Is a macro necessary? Without a macro `i`s present in `(* i i`) would get evaluated. Since they weren't defined it would cause a compile-time error. As suggested in the question, we could define `i` as a value which `*` knows how to handle. Despite that being possible, it would still be evaluated at runtime. A clear advantage of a macro is the fact that it's evaluated during compilation and replaced with an ordinary call to `clojure.core/*` as shown in examples above. Simply put, it's fast.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T17:22:43.257

像这样的东西很快就被黑了*？

```
(defn hacked-* [& args]
  (let [[i-amount product] 
        ((juxt (comp count filter) 
               (comp #(apply * %) remove)) 
         #{:i} args)]
    (if (and (> i-amount 0) (even? i-amount)) 
      (- product)
      product)))

(hacked-* 1 2 3) => 6
(hacked-* 1 2 3 :i :i) => -6
(hacked-* 1 2 3 :i :i :i) => 6 
```

您可以在词法上将 * 重新绑定到被破解的版本以评估复杂的表达式：

```
(let [* hacked-*]
 (* 1 :i 2 :i 3 :i (* :i :i))) => -6 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T01:23:15.877

这是我的技巧，假设参数都是虚构的：

```
(defn im* [& i] ((fn [q n] (([* str * str] q) ([1 'i -1 '-i] q) n)) (mod (count i) 4) (reduce * i))) 
```

...可怕！[但是如果没有例如破解Numbers.java](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Numbers.java)以调度到 java.lang.Number 的新子类型，您所要求的实际上是不可能的。实际上，使用 Java 或 Clojure 复数库会更有意义。

# actionscript-3 - AS3 StageOrientationEvent.ORIENTATION_CHANGING 在 iPad3 iOS6 上不起作用

> ID：13556437
> 
> 赞同：1
> 
> 时间：2012-11-25T22:54:27.917
> 
> 标签：actionscript-3, air

知道为什么我的代码无法在 iPad3 iOS6 上运行，还是 Adob​​e air 的错误？

以下代码适用于 iOS5 的 iPad1 和 iPad2

```
 if (startOrientation == StageOrientation.DEFAULT || startOrientation == StageOrientation.UPSIDE_DOWN){
                stage.setOrientation(StageOrientation.ROTATED_RIGHT);}
            else{
                stage.setOrientation(startOrientation);
            }           

            stage.addEventListener(StageOrientationEvent.ORIENTATION_CHANGING, orientationChangeListener);

private function orientationChangeListener(e:StageOrientationEvent):void{
            txt_rotate.text = 'Camed' + StageOrientation.ROTATED_LEFT;
           if (e.afterOrientation == StageOrientation.DEFAULT || e.afterOrientation ==  StageOrientation.UPSIDE_DOWN){
                e.preventDefault();
           }else if(e.afterOrientation ==  StageOrientation.ROTATED_LEFT){
               _stageOrientation = 'ROTATED_LEFT';
               txt_rotate.text = _stageOrientation;
           }else if(e.afterOrientation ==  StageOrientation.ROTATED_RIGHT){
               _stageOrientation = 'ROTATED_RIGHT';
               txt_rotate.text = _stageOrientation;
           }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T02:47:50.297

Apple 对 iOS6 SDK 中的方向回调进行了一些修改，因此不推荐使用某些功能。

preventDefault 函数对 StageOrientationEvent 不起作用。建议在需要时使用 Stage.autoOrients 为 false。

[http://blogs.adobe.com/airodynamics/2012/09/28/orientation-changes-in-air/](http://blogs.adobe.com/airodynamics/2012/09/28/orientation-changes-in-air/)

# c++ - 在 Visual Studio 中使用 Google 测试框架对应用程序进行单元测试

> ID：13556439
> 
> 赞同：1
> 
> 时间：2012-11-25T22:54:45.073
> 
> 标签：c++, visual-studio, unit-testing, googletest

我正在尝试在我的应用程序中组织类的单元测试。

首先，它是一个应用程序，所以它有自己的主要功能。据我了解，我需要创建一个单独的应用程序来包含和运行测试，因为 GoogleTest 需要一个特殊的 main 函数来运行测试。我创建了它，但如果我从我的目标项目中调用任何内容，则测试项目不会链接。

使其工作的唯一方法是创建三个项目 - 测试项目，具有所有类的 Lib 项目和运行项目，它只运行来自 Lib 项目的函数调用？

# javascript - Google Drive API 示例应用程序“DrEdit”javascript 错误（Angular JS？）

> ID：13556442
> 
> 赞同：4
> 
> 时间：2012-11-25T22:55:09.150
> 
> 标签：javascript, google-app-engine, angularjs, google-drive-api

我正在尝试在 Google App Engine 上为 Python 设置由 Google 生成的名为“Dredit”的示例应用程序。此处的文档： [https ://developers.google.com/drive/examples/python](https://developers.google.com/drive/examples/python)

该应用程序应该能够从用户的 Google Drive 文件夹中打开、创建和编辑文件。

除了主页控制台中出现的一些 JavaScript 错误外，几乎所有东西似乎都在工作。此外，当我尝试创建新文档时，我无法更改文档的标题，也无法编辑现有文档的名称。但是，它确实允许我编辑任何文档的内容。要亲自查看，该应用程序在这里： [http](http://www.dredit-python-0515.appspot.com) ://www.dredit-python-0515.appspot.com 。您需要一个 Google 帐户才能登录。

Chrome 的 JS 控制台和 Firebug 中的错误是不同的，但它们似乎以我的项目目录中的 angularJS 文件为中心。

Chrome中的错误是：

> TypeError：无法 在 http://dredit-python-
> 
> 的 Object.service.state (http://dredit-python-0515.appspot.com/js/services.js:135:37)处读取未定义的属性“可编辑”-
> 
> 0515.appspot.com/lib/angular-1.0.0/angular-1.0.0.js:6128:19
> 
> 在操作员处。| (http://dredit-python-0515.appspot.com/lib/angular-1.0.0/angular-1.0.0.js:5560:74)
> 
> 在 http://dredit-python-0515.appspot.com/ lib/angular-1.0.0/angular-1.0.0.js:5879:14
> 
> 在 Object.fn (http://dredit-python-0515.appspot.com/lib/angular-1.0.0/angular-1.0\. 0.js:4788:22)
> 
> 在 Object.Scope.$digest (http://dredit-python-0515.appspot.com/lib/angular-1.0.0/angular-1.0.0.js:7654:38)
> 
> 在 Object.Scope.$apply (http://dredit-python-0515.appspot.com/lib/angular-1.0.0/angular-1.0.0.js:7855:24)
> 
> 在完成请求 (http://dredit-python-0515.appspot.com/lib/angular-1.0.0/angular-1.0.0.js:8844:20)
> 
> 完成请求 (http://dredit-python-0515\. appspot.com/lib/angular-1.0.0/angular-1.0.0.js:8984:7)
> 
> 在 XMLHttpRequest.xhr.onreadystatechange (http://dredit-python-0515.appspot.com/lib/angular-1.0 .0/angular-1.0.0.js:8954:11)

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T16:25:11.960

我也无法让您的应用程序运行，但查看堆栈跟踪：

错误来自线路

```
} else if (!doc.info.editable) {
   return EditorState.READONLY;
} 
```

在[http://dredit-python-0515.appspot.com/js/services.js](http://dredit-python-0515.appspot.com/js/services.js)

调用此代码时，未定义 doc.info。

无论出于何种原因，在设置 doc.info 对象的“createEditor”函数之前调用“state”函数。

最简单的解决方法是将第 135 行的“else if”替换为

```
} else if (doc.info && !doc.info.editable) { 
```

# haskell - 使用haskell的collat z-list实现

> ID：13556443
> 
> 赞同：2
> 
> 时间：2012-11-25T22:55:13.950
> 
> 标签：haskell

我正在尝试使用 Haskel 实现 collat​​z-list：这是我的代码：

```
collatz n
     | mod n 2 == 0 = div n 2
     | otherwise =  3 * n + 1

collatzList n
        | n < 1 = error "Cannot have negative number"
collatzList
        | n == 1 = [n]
        | otherwise = n:collatzList (collatz n) 
```

我收到的错误消息是：输入 `collat​​zList' [1 of 1] 解析错误 编译 Main (exer.hs，解释) 失败，加载模块：无。

谁能告诉我为什么我会收到这条消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:04:04.697

我得到不同的错误（使用 GHC 7.4.1）：

```
> :load "/tmp/C.hs"
[1 of 1] Compiling Main             ( /tmp/C.hs, interpreted )

/tmp/C.hs:9:11: Not in scope: `n'

/tmp/C.hs:9:21: Not in scope: `n'

/tmp/C.hs:10:23: Not in scope: `n'

/tmp/C.hs:10:46: Not in scope: `n'
Failed, modules loaded: none. 
```

这是因为您忘记了`n`第二个等式中的参数`collatzList`。您可以添加此参数

```
collatzList n
        | n < 1 = error "Cannot have negative number"
collatzList n -- the n was missing here
        | n == 1 = [n]
        | otherwise = n:collatzList (collatz n) 
```

或者，由于左侧现在相同，您可以简单地将其与第一个连接：

```
collatzList n
        | n < 1 = error "Cannot have negative number"
        | n == 1 = [n]
        | otherwise = n:collatzList (collatz n) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T22:57:43.063

你正在重新定义`collatzList`.

```
collatzList
        | n == 1 = [n]
        | otherwise = n:collatzList (collatz n) 
```

做这个：

```
collatz n
     | mod n 2 == 0 = div n 2
     | otherwise =  3 * n + 1

collatzList n
        | n < 1 = error "Cannot have negative number"
        | n == 1 = [n]
        | otherwise = n:collatzList (collatz n) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:56:40.097

生成仅依赖于前一个值的值列表是`unfoldr`函数 ( `Data.List.unfoldr`) 的典型应用：

```
import Data.List (unfoldr)
collatzList = unfoldr nextCollatz
      where nextCollatz n | n <= 0    = Nothing
                          | n == 1    = Just (1,0)
                          | even n    = Just (n, n `quot` 2)
                          | otherwise = Just (n, 3*n+1) 
```

`unfoldr f x0`取一个起始值`x0`，并对其应用一个函数`f`。如果`f x0`是`Nothing`，算法终止；如果是`Just (push, next)`，则添加`push`到结果列表中，并`next`用作 的新值`x0`。另一个例子，使用展开器生成最多 100 个正方形：

```
import Data.List (unfoldr)
squareList = unfoldr pow2
      where pow2 n | n > 100   = Nothing
                   | otherwise = Just (n, 2*n)
                   -- "Add n to the result list,
                   -- start next step at 2*n." 
```

（关于 的强制性说明`error`：通常最好让函数返回一些虚拟值。例如，在我上面的 Collat​​z 函数中，非正整数的结果是空列表而不是异常。）

# sqlite - 使用 * ' 等字符在 sqllite 中存储/读取数据的最佳方法？

> ID：13556446
> 
> 赞同：1
> 
> 时间：2012-11-25T22:55:58.257
> 
> 标签：sqlite, escaping, symbols

我正在使用 SQLite，我需要使用任何类型的符号来保存和读取数据。有没有办法逃避这个符号？

我正在尝试 replaceAll("\'","\'") 但可能有更多我不知道的符号可能有问题，有什么方法可以为我做这件事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T09:05:08.247

理论上，`'`是唯一需要在 SQL 字符串中引用的字符。*但是，您可以完全避免这个问题，并通过使用参数*来防止程序转义然后 SQLite 取消转义字符串的开销，这些参数是被替换到 SQL 中的文字值。

具体如何工作取决于您使用的语言和驱动程序，但通常如下所示：

```
db.execute("INSERT INTO Users(Name, Passwd, Expired) VALUES(?, ?, 0)",
           ["Bob", "!*\\$%&:?"]) 
```

# hibernate - Spring Hibernate 两个不同的 DAO 连接

> ID：13556447
> 
> 赞同：0
> 
> 时间：2012-11-25T22:56:05.220
> 
> 标签：hibernate

我有一个公共项目，它依赖于一个名为 application1 的应用程序。我以这种方式配置了每个项目都有一个不同的 jdbc 属性文件（不同的文件名）的 xml，该文件指向不同的数据库。Postgres 和 MySQL。我创建了以下代码段：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = {"/applicationContext.xml", "/common-applicationContext.xml"})
@Transactional
public class AppTest extends AbstractTransactionalJUnit4SpringContextTests{
    static Logger log = Logger.getLogger(App.class.getName());
    @Resource(name = "testDao")
    private IDAO dao;//Traces testDao, which originates in common package
    @Resource(name = "testApplication1Dao")
    private IDAO daoApplication1;//Traces dao from application1 package
    @Test
    public void AppContextTest(){
        SessionFactory sf1 = dao.getHibernateTemplate().getSessionFactory();
        SessionFactory sf2 = daoApplication1.getHibernateTemplate().getSessionFactory(); 
```

1.  TestDao 和 TestApplication1Dao 类是对 IDAO 的扩展。通用接口。
2.  testApplication1Dao->Postgres，在applicationContext.xml和pgsql.jdbc.properties中配置
3.  testDao->Mysql，配置在common-applicationContext.xml和mysql.jdbc.properties中。

为什么用eclipse调试，我看到dao和daoApplicatio1是同一个对象？他们应该吗？如何在屏幕上打印每个 dao 对象背后的连接和属性？

提前致谢

**编辑(1)**

来自普通项目：

```
import org.springframework.stereotype.Repository;
@Repository("testDao")
public class TestDao extends AbstractDao {} 
```

从 application1 项目：

```
import org.springframework.stereotype.Repository;
import gr.org.infrastructure.common.db.AbstractDao;
@Repository("testApplication1Dao")
public class TestApplication1Dao extends AbstractDao {} 
```

AbstractDao 是 IDAO 的扩展（接口），没什么奇怪的......：

```
@Transactional(propagation=Propagation.REQUIRED)
public abstract class AbstractDao implements IDAO {
    private HibernateTemplate hibernateTemplate;
    private boolean rollbacked;

    public AbstractDao() {
        super();
        this.rollbacked = false;
        // TODO Auto-generated constructor stub
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:39:35.750

显然解决了这个问题，我可以在 spring/hibernate 应用程序中同时拥有两个单独的连接。如果有人有兴趣给我留言。

# html - IE 7/6 中的菜单栏无法正确呈现

> ID：13556455
> 
> 赞同：1
> 
> 时间：2012-11-25T22:57:42.640
> 
> 标签：html, css, internet-explorer

我不习惯需要支持旧版浏览器，所以这个让我不知所措-

出于某种原因，我的菜单在 IE7/6 中呈现这样的效果。

![在此处输入图像描述](../Images/b5f63a6ec217040e3b313313e8a1a6ca.png)

...但在所有其他浏览器中看起来都是这样

![在此处输入图像描述](../Images/0dc01589eac4759a0f5decc5523b4ef5.png)

有任何想法吗？

这是我的代码

**HTML**

```
<nav class="main-nav-bar">
  <div class="wrapper cf">
    <img class="title" src="./images/title.png" alt="">
    <ul class="main-nav cf">
      <li><a href="#" title="home page" class="home"><img src="./images/home.png" alt="home button"/></a></li>
      <li class="about"><a href="#" title="learn about us" class="about"><img src="./images/about.png" alt="about button"/></a></li>
      <li><a href="#" title="latest news" class="news"><img src="./images/news.png" alt="news button"/></a></li>
      <li><a href="#" title="contact us" class="contact"><img src="./images/contact.png" alt="contact button"/></a></li>
    </ul><!--End .main-nav-->
  </div><!--End .wrapper-->
</nav><!--End .main-nav-bar--> 
```

**CSS**

```
.main-nav-bar{ 
  background-color: #00653a;
  line-height: 0; 
}

.main-nav{
  float: right;
  max-width: 50%;
}

.main-nav li {
  float: left;  
  border-right: #00824c 1px solid;
}

.main-nav li:nth-of-type(1){
  border-left: #00824c 1px solid;
}

.main-nav a{
  display: block;
  text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:03:02.210

试试这个： **html**

```
<nav class="main-nav-bar">
  <div class="wrapper cf">
    <ul class="main-nav cf">
      <li><a href="#" title="home page" class="home"><img src="./images/home.png" alt="home button"/></a></li>
      <li class="about"><a href="#" title="learn about us" class="about"><img src="./images/about.png" alt="about button"/></a></li>
      <li><a href="#" title="latest news" class="news"><img src="./images/news.png" alt="news button"/></a></li>
      <li><a href="#" title="contact us" class="contact"><img src="./images/contact.png" alt="contact button"/></a></li>
    </ul><!--End .main-nav-->
    <img class="title" src="./images/title.png" alt="">
  <div style="clear:both;"></div>
  </div><!--End .wrapper-->
</nav><!--End .main-nav-bar-->
</nav><!--End .main-nav-bar--> 
```

**样式.css**

```
.main-nav-bar{ 
  background-color: #00653a;
  line-height: 0; 
}
.wrapper img{float:left;}
.main-nav{
  float: right;
  max-width: 50%;
}

.main-nav li {
  float: left;  
  border-right: #00824c 1px solid;
}

.main-nav li:nth-of-type(1){
  border-left: #00824c 1px solid;
}

.main-nav a{
  display: block;
  text-decoration: none;
} 
```

# java - 本地主机上的 Java 和 SSL

> ID：13556459
> 
> 赞同：0
> 
> 时间：2012-11-25T22:58:13.193
> 
> 标签：java, sockets, ssl

我正在尝试在我的本地计算机上试用 SSLServerSocket 程序 - （该程序旨在使用基于服务器对象构造函数的单个参数的普通套接字或 SSL 套接字）。在纯数据中，该程序完全按预期工作，但使用 SSL：

```
socket.getInputStream().read(); 
```

始终返回 65535（即 0xFFFF），即使远程端已关闭。知道有什么问题吗？如果有帮助，我可以发布代码。

提前致谢

编辑：好的，现在我醒了 - 正如下面的人正确指出的那样，它是一种“断开连接”排序（isClosed 仍然返回 false 等，但输入流只有-1）。

查看 SSL 的调试信息，我注意到了这个 gem：

```
***
pool-2-thread-1, WRITE: TLSv1.1 Handshake, length = 36
%% Cached server session: [Session-3, TLS_ECDHE_RSA_WITH_RC4_128_SHA]
pool-2-thread-1, received EOFException: ignored
pool-2-thread-1, called closeInternal(false)
pool-2-thread-1, SEND TLSv1.1 ALERT:  warning, description = close_notify
pool-2-thread-1, WRITE: TLSv1.1 Alert, length = 22
pool-2-thread-1, called closeSocket(selfInitiated)
After use 
```

从代码：

```
final SSLSocket socket = (SSLSocket) ((SSLServerSocket)_ServerSocket).accept();
System.out.println("Before use");
socket.getInputStream().read();
System.out.println("After use"); 
```

所以，我 - 认为 - 客户端（在这种情况下，浏览器）没有正确地说“再见”就挂断了。

鉴于我的预期用途是 SSL/TLS 上的 websocket（wss://localhost:/），我尝试添加证书设置并将其添加到 Windows 7 的受信任证书中，但它似乎仍然不想工作（ html 文件在我的本地系统上，并且连接到上面的 wss: URL，那么 keygen.exe 的服务器别名应该是 localhost 吗？）。

知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T02:49:30.660

你误会了。read() 从不返回 0xFFFF。但是，当对等方关闭时，它会返回*-1 (0xFFFFFFFF)。*请参阅 Javadoc。您需要将结果存储在 int 中，而不是字节中，因此您可以将 -1 表示 EOS 与 0xFF 区分为数据字节。

# android - 如何在 android 的对话框中拥有 2 组无线电组

> ID：13556460
> 
> 赞同：0
> 
> 时间：2012-11-25T22:58:22.143
> 
> 标签：android, radio-button, dialog, radio-group

除了通过布局创建自定义对话框之外，还有什么方法可以创建具有 2 组单选组的对话框。

我的意思是我想在一个对话框中有 2 个独立的单选组（每个有 3 个单选按钮）而不创建布局。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:07:43.353

不，没有办法让 2 组具有默认对话框的无线电组。您唯一的方法是使用自定义布局创建自定义对话框。带有单选按钮的唯一功能是 setSingleChoiceItems 并且没有其他方法。setMultipleChoiceItems 仅使用复选框并且没有组

对不起

# jquery - 带有 attr() 更改对象的 JQuery 问题

> ID：13556461
> 
> 赞同：0
> 
> 时间：2012-11-25T22:58:28.697
> 
> 标签：jquery, object

我正在尝试使用将更改属性数据的 JQuery 按钮菜单，因此将自动重新加载对象参数内部的内容，但它不想工作:(

带有 CSS、HTML 和 JQuery 的代码在下面的链接中

[http://jsbin.com/iqukak/2/edit](http://jsbin.com/iqukak/2/edit)

任何人都可以帮忙吗？

```
$('button#1').attr("id"){
      $("object#cgi").attr('data','http://www.google.com')};
   $('button#2').attr("id"){
      $("object#cgi").attr('data','http://www.bing.com')};
    $('button#3').attr("id"){
      $("object#cgi").attr('data','http://www.yahoo.com')};
}); 
```

更新：

我已将所有文件上传到[http://szary.eu/panel/](http://szary.eu/panel/)
我想要实现的是：
- 当我点击 1 时，我需要 1.html 内`<object>`可见
- 当我点击 2 时，我需要 2.html 内`<object>`可见

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:11:31.713

```
$(function(){

    $('td.mleft button').click(function(){
      $('#cgi').attr( 'data',   'http://'+ $(this).text().toLowerCase() +'.com' );  
    });

}); 
```

顺便说一句：google 永远不会出现，例如，如果您指向 stackoverflow，您将被重新路由。所以三思而后行，你想达到什么目的：
为了防止*“点击劫持”*，他们发送了一个名为“X-Frame-Options”的 HTTP 响应标头，以防止页面被“陷害”

**编辑** 我不鼓励您`<object>`为此目的使用标签，请`.load()`改用：

```
$('#cgi').load( $(this).text() +'.html'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:08:09.197

你可以试试这段代码：

```
$(document).ready(function(){
    $('button#1').click(function() {
      $("object#cgi").attr('data','http://www.google.com')});
   $('button#2').click(function() {
      $("object#cgi").attr('data','http://www.bing.com')});
    $('button#3').click(function() {
      $("object#cgi").attr('data','http://www.yahoo.com')});
}); 
```

虽然我不相信谷歌无论如何都会让你这样做（必应和雅虎都很好） [http://jsbin.com/iqukak/15/edit](http://jsbin.com/iqukak/15/edit)

请参阅此问题，了解为什么它不适用于 Google：[如何在 iframe 中打开 google 链接？](https://stackoverflow.com/questions/7800370/how-to-open-google-links-inside-iframe)

# android - 如何保存动态创建的editTexts的状态

> ID：13556463
> 
> 赞同：0
> 
> 时间：2012-11-25T22:58:39.177
> 
> 标签：android, android-edittext, screen-orientation, savestate

我被困在如何在屏幕方向上保存我的 EditTexts 的状态。目前，如果将文本输入到 EditTexts 并且屏幕被定向，则字段将被擦除（如预期的那样）。

我已经在调用 onSaveInstanceState 并保存一个字符串，但我不知道如何保存在代码中创建的 EditTexts，然后在重绘活动时检索它们并将它们添加到 EditTexts。

我的代码片段：

我的主要活动如下：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    // get the multidim array
    b = getIntent().getBundleExtra("obj");
    m = (Methods) b.getSerializable("Methods"); 

            // method to draw the layout
    InitialiseUI();

    // Restore UI state from the savedInstanceState.
    if (savedInstanceState != null) {
        String strValue = savedInstanceState.getString("light");
        if (strValue != null) {
            FLight = strValue;
        }
    }
    try {
        mCamera = Camera.open();
        if (FLight.equals("true")) {
            flashLight();
        }
    } catch (Exception e) {
        Log.d(TAG, "Thrown exception onCreate() camera: " + e);
    }

} // end onCreate

/** Called when the back button is pressed. */
@Override
public void onResume() {
    super.onResume();
    try {
        mCamera = Camera.open();
        if (FLight.equals("true")) {
            flashLight();
        }
    } catch (Exception e) {
        Log.d(TAG, "Thrown exception onCreate() camera: " + e);
    }
} // end onCreate

/** saves data before leaving the screen */
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putString("light", FLight);
}

/** called when exiting / leaving the screen */
@Override
protected void onPause() {
    super.onPause();
    Log.d(TAG, "onPause()");
    if (mCamera != null) {
        mCamera.stopPreview();
        mCamera.release();
        mCamera = null;
    }
}

/*
 * set up the UI elements - add click listeners to buttons used in
 * onCreate() and onConfigurationChanged() 
 * 
 * Set the editTexts fields to show the previous readings as Hints
 */
public void InitialiseUI() {
    Log.d(TAG, "Start of InitialiseUI, Main activity"); 

    // get a reference to the TableLayout
    final TableLayout myTLreads = (TableLayout) findViewById(R.id.myTLreads);

    // Create arrays to hold the TVs and ETs
    final TextView[] myTextViews = new TextView[m.getNoRows()]; // create an empty array;
    final EditText[] myEditTexts = new EditText[m.getNoRows()]; // create an empty array;

    for(int i =0; i<=m.getNoRows()-1;i++ ){
        TableRow tr=new TableRow(this);
        tr.setLayoutParams(new LayoutParams(
                LayoutParams.MATCH_PARENT,
                LayoutParams.WRAP_CONTENT));

        // create a new textview / editText
        final TextView rowTextView = new TextView(this);
        final EditText rowEditText = new EditText(this);

        // setWidth is needed otherwise my landscape layout is OFF
        rowEditText.setWidth(400);

        // this stops the keyboard taking up the whole screen in landscape layout
        rowEditText.setImeOptions(EditorInfo.IME_FLAG_NO_EXTRACT_UI);

        // add some padding to the right of the TV
        rowTextView.setPadding(0,0,10,0);

        // set colors to white
        rowTextView.setTextColor(Color.parseColor("#FFFFFF"));
        rowEditText.setTextColor(Color.parseColor("#FFFFFF"));

        // if readings already sent today set color to yellow
        if(m.getTransmit(i+1)==false){
            rowEditText.setEnabled(false);
            rowEditText.setHintTextColor(Color.parseColor("#FFFF00"));
        }

        // set the text of the TV to the meter name
        rowTextView.setText(m.getMeterName(i+1));
        // set the hint of the ET to the last submitted reading
        rowEditText.setHint(m.getLastReadString(i+1));

        // add the textview to the linearlayout
        rowEditText.setInputType(InputType.TYPE_CLASS_PHONE);//InputType.TYPE_NUMBER_FLAG_DECIMAL);
        tr.addView(rowTextView);
        tr.addView(rowEditText);
        myTLreads.addView(tr);

        // add a reference to the textView
        myTextViews[i] = rowTextView;
        myEditTexts[i] = rowEditText;

    }

    final Button submit = (Button) findViewById(R.id.submitReadings);
    // add a click listener to the button

    try {
        submit.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Log.d(TAG, "Submit button clicked, Main activity");

                preSubmitCheck(m.getAccNo(), m.getPostCode(), myEditTexts); // method to do HTML getting and sending

            }
        });
    } catch (Exception e) {
        Log.d(TAG, "Exceptions (submit button)" + e.toString());
    }

}// end of InitialiseUI 
```

在单击按钮之前，我不需要对这些值做任何事情。如果它们是 ListView 会更容易吗？我猜我仍然会遇到保存它们并在旋转时检索它们的问题。如果它有帮助我有一个对象 m 这是一个字符串 [] [] 我可以暂时以某种方式将它们存储在

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T07:24:36.113

我需要做的就是在我的编辑文本中添加一个 id：

```
 rowEditText.setId(i) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:02:52.900

> 如何保存在代码中创建的 EditText

如果您的意思是在运行时将对象添加到布局中，请使用[onRetainNonConfigurationInstance()](http://developer.android.com/reference/android/app/Activity.html#onRetainNonConfigurationInstance%28%29)或[setRetainInstance()](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)如果使用 Fragments

# php - 在 CI 中加载库

> ID：13556465
> 
> 赞同：0
> 
> 时间：2012-11-25T22:58:43.547
> 
> 标签：php, codeigniter

我正在尝试加载名为 Single_column 的库。我创建了这个库并将其设置到库文件夹中。在这一点上我必须提到我正在使用代码 Igniter 框架。Sinle_column 类包含以下代码：

```
 <?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); 

class Single_column
{
    public function render( $id )
    {
        $CI =& get_instance();

        // DB calls
        // search for uri in db
        $CI->load->model('m_single_column');
        $image = $CI->m_single_column->getImageURI( $id );
        $text = $CI->m_single_column->getText( $id );

        // ==== HEADER
        // eventually, this will be loaded from the db
        $header_data['title'] = "Single Column Demo";
        $header_data['css'][] = "single_column";
        $CI->load->view('v_header', $header_data);

        // ==== CONTENT
        $content_data['content'] = '<div class="content-block">';
        $content_data['content'] .= '<div class="image">';
        $content_data['content'] .= '<img src="' . base_url() . $image . '" width="200" height="133" alt="my tractor"/>';
        $content_data['content'] .= '</div>';
        $content_data['content'] .= $text;
        $content_data['content'] .= '</div><!-- end content-block-->';

        $CI->load->view('v_content', $content_data);

        // ==== FOOTER
        $CI->load->view('v_footer');
    }
  }

 ?> 
```

现在进入控制器文件夹，我有一个名称为：

```
 <?php

 if (!defined('BASEPATH'))
    exit('No direct script access allowed');

 class Master extends CI_Controller {

    function __construct() {
       parent::__construct();

     }

public function _remap($method) {
    // remap overrides function calls 
    // search for uri in db

    $this->load->model('m_master');

    $uri_id = $this->m_master->findURI(uri_string());
    $page;
    if ($uri_id != false) {       
        $this->{$page->controller}->render( $page->id );
    } else {
        show_404(uri_string());
    }
}

}

?> 
```

上述代码来自教程，我的问题在以下行：

```
 $this->{$page->controller}->render( $page->id ); 
```

显示的错误如下：

```
 Fatal error: Cannot access empty property in C:\xampp\htdocs\PhpProject1\application\controllers\master.php on line 24 
```

实际上我意识到它无法识别“渲染”方法。所以，我在 if 语句中尝试了以下代码行

```
 $library= Single_column::$uri_id['id'];;
  $this->load->library($library); 
```

但我收到以下错误：致命错误：第 22 行的 C:\xampp\htdocs\PhpProject1\application\controllers\master.php 中未找到 Class 'Single_column'

此外，$uri_id 返回一个 sql 对象。但我只想传递对象的 id 属性。

问题：如何调用库？以及如何将值传递给类的方法（渲染方法）？为什么上述行不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:36:07.267

不确定为什么要将模型加载到库中。

确保您的库也存储在`application/libraries`

```
$this->load->library('your_library_name');
$this->your_library_name->render($page->id); 
```

这类似于加载 CodeIgniter 库。

# php - 将 modx 站点从子文件夹移动到根文件夹

> ID：13556466
> 
> 赞同：0
> 
> 时间：2012-11-25T22:58:51.157
> 
> 标签：php, mysql, modx

我在根文件夹（即公共/www/）的共享服务器上运行了一个MODX 站点。
我还在子文件夹（public/www/modxtest）中运行了一个 MODX 测试站点。

我想将此测试站点移动到根目录中，以使根文件夹中的 modx 站点在迁移结束之前不会受到影响。

我以前没有接触过MODX，也不知道迁移过程。

一种方法可能是使用 htaccess 文件并将请求重定向到根 MODX 站点到子文件夹 MODX 站点，如[https://my.bluehost.com/cgi/help/347](https://my.bluehost.com/cgi/help/347)

这种方法可能会让其他人感到困惑，因为他们不知道发生了这种重定向，并且可能碰巧删除了前缀为“test”的子目录。

从子文件夹完全迁移到根文件夹的更好和可靠的方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T10:52:02.047

您没有指定您使用的是哪个版本的 Modx，但我认为它是 Revo。

移动 Revo 站点可能很困难，但我已经做过好几次了，所以我对我必须做的事情做了一个简单的列表。

1.  将所有文件移动到正确的目录。
2.  `config.core.php`在 modx-root 中打开。在此处输入您的新路径
3.  打开`core/config/config.inc.php`并更改所有路径和相对 url 以匹配您的新文件夹/url。
4.  将 -folder 上传`setup`到您的 modx-root。如果您没有此文件夹，请从 modx.com 下载：*注意：请记住上传您的 Modx 版本的 setup-folder，因为这些可能包含更改。上传错误的设置可能会导致您的 Modx 崩溃*。您可以在管理器面板中检查您当前的 Modx 版本。在移动所有文件之前执行此操作。
5.  运行设置（选择现有站点）。
6.  全部完成。

要找到您的完整路径，这个 PHP 脚本应该可以发挥作用：

```
<?php
echo dirname(__FILE__);
?> 
```

将它放在 Modx 根目录中。这将是您的根路径。

这应该是一种非常安全的方法，但请记住备份所有文件并在更改路径和 URL 时要小心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T18:32:58.633

感谢您的回答 OptimusCrime。只需按照步骤操作，除了 .htaccess 文件中的 RewriteBase 之外，一切都很好。

要解决此问题：

3（一）。打开 .htaccess 并将 RewriteBase（如果存在）从旧根更改为新根。

例如：更改`RewriteBase /old-modx-root/`为`RewriteBase /new-modx-root/`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-01T07:11:33.857

仅在删除文件`core/cache`夹中的所有文件之后，这对我来说效果很好。

# php - PHP、Wordpress - 函数和 mySQL

> ID：13556471
> 
> 赞同：0
> 
> 时间：2012-11-25T22:59:42.323
> 
> 标签：php, mysql, wordpress

好的，所以我正在尝试创建一个函数来查找和替换 wordpress 帖子中的某些单词（短语）。我正在使用 mySQL 数据库来存储所需的数据（搜索和查找）。然后用数据库中的相关单词（短语）替换它们。

它们不止一个相关的词（短语），因此它必须从数据库中的表中随机选择一个。我不确定这可以通过 mySQL 完成多少？..

另一件事是只应替换 4 个单词（短语）。（随机，所以它可以在帖子的任何地方）。

我最终让这个过程陷入了一个循环，看起来我可能走错了路。一些指导会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T08:49:13.297

我的猜测是，`$KeywordRowsArray`当您在 try-catch 块中使用它时，您是空的，因为查询数据库以填充它的 SQL 字符串中的语法错误：

```
 SELECT DISTINCT KeywordPhrase FROM SearchArticalesWith 
```

不应该`SearchArticlesWith`和不应该`SearchArticalesWith`吗？...

# c++ - 确定可以分解为素数的下一个最大数 {2,3,5,7}

> ID：13556475
> 
> 赞同：3
> 
> 时间：2012-11-25T23:00:06.140
> 
> 标签：c++, modulus

我想编写一个函数，它给定一个无符号整数作为输入参数，并返回可以分解为素数 {2、3、5、7} 的下一个最高数字。这是一个简短的代码片段，显示了我想要做什么。

```
unsigned int getHigherNumber(unsigned int x)
{
    // obtain the next highest number that can be factored into
    // prime numbers (2, 3, 5, and 7)
    if (~(x % 2 || x % 3 || x % 5 || x % 7))
        return  x;
    else
    {
         // ???
    }  
} // end 
```

此函数的目的是查找应填充数组的零的数量，以确保 FFTW ( [link](http://www.fftw.org/doc/Introduction.html) ) 等算法能够以有效的方式运行。给定的链接讨论了该算法对于可以分解为小素数的长度的输入是最佳的。

正如对该问题的评论中所建议的，如果 FFTW 算法是最优的，那么似乎只允许 2^a * 3^b * 5^c * 7^d 形式的数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T23:19:21.100

> 例如，标准 FFTW 分布对于大小可以分解为小素数（2、3、5 和 7）的数组最有效，否则它使用较慢的通用例程。

真的，你不需要下一个最高的，而只是相当接近的东西。最简单的方法是选择最接近的 2 的幂。这最多会浪费原始数组的大小。

为此，找到最高有效位并将其乘以 2。

[找到最高有效位的明显方法：](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious)

```
 unsigned int v; // 32-bit word to find the log base 2 of  
    unsigned int r = 0; // r will be most significant bit

    while (v >>= 1)   
    {  
        r++;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T23:39:31.173

基于先前的答案，如果数组将非常大 ~ 2 ^ 10，并且您希望在保持简单的同时尽可能少地使用额外空间，您还可以选择 7 的最大幂次于 x，相乘5的最大幂，以此类推。那是

```
unsigned int getHigherNumber(unsigned int x)
{
    unsigned int ans=1;
    unsigned int primes[4]={2,3,5,7};
    for(int i=3; i>=0; i--)
    {
        for(int j=0; ; j++)
        {
            if(pow(primes[i],j)>x)
            {
                ans*=pow(7,j-1);
                if(i==0)
                    ans*=2;
                break;
            }
        }
    }
    return ans;
} 
```

（未经测试）。我认为这应该让你得到一个比最接近的 2 次方更小的数字，但会牺牲一些速度。但这绝对不是最佳的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T03:01:53.877

以下算法和源代码可能没有经过高度优化以找到一般形式的下一个最高数（2^a * 3^b * 5^c * 7^d），但它很有用，因为代码将返回具有这些权力之一的最高人数。

该算法首先检查数字是否是 {2,3,5,7} 的幂。如果是，则简单地返回该数字。如果不是，则算法找到高于输入数的最小功率。

更复杂的方法将使用素数分解算法和搜索/排序，或者可能是硬编码的查找表，但这些解决方案对于此应用程序可能过于复杂。

```
#include <iostream>
#include <cmath>
#include <vector>
#include <algorithm>

// http://stackoverflow.com/questions/1804311/how-to-check-if-an-integer-is-power-of-3
// Checks if n^x
int powerOf(int n, int x)
{
    while (n % x == 0) 
    {
        n /= x;
    }
return n == 1;
}

unsigned int hN(unsigned int x, unsigned int base)
{
    double exponent = std::ceil( std::log(x) / std::log(base) );
    double num = std::pow(base, exponent);
return static_cast<unsigned int>(num);
}

unsigned int getHigherNumber(unsigned int n)
{
    unsigned int rv = n;
    const int pnum = 4;

    // 1) Is the number a power of {2,3,5,7}?
    // If it is, then simply return it
    if(powerOf(n,2)) return rv;
    if(powerOf(n,3)) return rv;
    if(powerOf(n,5)) return rv;
    if(powerOf(n,7)) return rv;

    // 2) If not, then find next highest power of {2,3,5,7} that is the smallest
    // number higher than n
    unsigned int num0 = hN(n, 2);
    unsigned int num1 = hN(n, 3);
    unsigned int num2 = hN(n, 5);
    unsigned int num3 = hN(n, 7);

    std::vector<unsigned int>v(pnum);
    v[0] = num0;
    v[1] = num1;
    v[2] = num2;
    v[3] = num3;
    rv = *std::min_element(v.begin(),v.end());

    // 3) TODO: More sophisticated methods would use prime-factorization
    // algorithms and searching/sorting, or perhaps a look-up table, 
    // but these may be too complex for this application

 return rv;
} // end

int main()
{
    // const unsigned int num = 64;
    // const unsigned int num = 18;
    const unsigned int num = 2234;
    std::cout << "num = " << num << std::endl;
    std::cout << "higher number = " << getHigherNumber( num ) << std::endl;

} // end 
```

# ios - 带有多选的 UICollectionView 不会选择十几个项目

> ID：13556476
> 
> 赞同：7
> 
> 时间：2012-11-25T23:00:07.047
> 
> 标签：ios, ios6, uicollectionview, uicollectionviewcell

当使用`UICollectionView`设置`allowsMultipleSelection`为 YES 时，只有十几个项目是可选的。`UICollectionViewDelegate`停止呼叫`collectionView:didSelectItemAtIndexPath:`。

看起来很随意。您可以选择一些项目，向下滚动，选择更多，在某些时候您无法选择更多项目。

当单元格较小时，您似乎可以选择更多项目。单元格越大，在它停止工作之前您可以选择的项目就越少。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-25T23:00:07.047

我发现虽然我之前的答案有效，但可能是由于没有调用 super. 虽然 的文档`UICollectionReusableView`没有提到这一点，`UITableViewCell`但具有相同方法的 的文档却提到了这一点。

```
- (void)prepareForReuse
{
    [super prepareForReuse]
    // Your code here.
} 
```

**老答案：**

* * *

这可能是`UICollectionView`.

发生的情况是先前选择的单元格正在被重用并保持选定状态。集合视图未设置`selected`为“否”。

解决方案是重置`prepareForReuse`单元格的选定状态：

```
- (void)prepareForReuse
{
    self.selected = NO;
} 
```

如果选择了重用单元格，则集合视图在调用后将设置`selected`为“YES” `prepareForReuse`。

这是`UICollectionView`应该自己做的事情。幸运的是，解决方案很简单。不幸的是，我花了很多时间通过跟踪我自己的选择状态来解决这个错误。直到我在另一个具有较小单元的项目上工作时，我才意识到*为什么会发生这种情况。*

# css - 字体平滑不适用于按钮

> ID：13556481
> 
> 赞同：17
> 
> 时间：2012-11-25T23:01:03.673
> 
> 标签：css, button, twitter-bootstrap, webkit, antialiasing

我已使用此代码段来防止 webkit 在使用 CSS 转换时更改抗锯齿：

```
html{ -webkit-font-smoothing: antialiased; } 
```

这在大多数情况下都可以正常工作，但是在使用以下 HTML 玩 Bootstrap 时，我注意到 chrome 中有些奇怪：

```
<button class="btn btn-inverse">John Doe</button>
<a class="btn btn-inverse">John Doe</a>​ 
```

这是它在 OSX/Chrome 中的外观：

![在此处输入图像描述](../Images/a718ab5e81d16ad8719480553d65e287.png)

小提琴：http: [//jsfiddle.net/hY2J7/](http://jsfiddle.net/hY2J7/)。事实上，它似乎根本不适用于按钮。是否有更安全的技术可以在 webkit 中为所有元素触发相同的抗锯齿？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-03T00:33:42.727

[你的答案](http://jsfiddle.net/qrsf2/)是：

```
* {-webkit-font-smoothing: antialiased;}​ 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-30T03:15:53.863

由于 -webkit-font-smoothing 不是标准属性，它的继承规则没有正确定义。

在这种情况下，对于按钮元素，-webkit-font-smoothing 的默认值是 'auto' 而不是 'inherit'。

您可以通过添加此 css 规则来解决此问题：

```
button {
    -webkit-font-smoothing: inherit;
} 
```

现在，按钮元素应该继承您设置的任何值。

您可能还想运行一些其他测试以查看是否有任何其他元素也表现出相同的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T02:56:13.223

试试这个代码：

```
.btn{
  text-shadow: 0 0.3px 2px rgba(255,255,255, 0.9);
}​ 
```

​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T07:58:01.560

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T16:43:00.693

你试过这个吗？

`-webkit-backface-visibility: hidden;`

[在您的 jsfiddle 更新中，](http://jsfiddle.net/hY2J7/8/)我让它在 OS X 上的 Chrome 中工作

# objective-c - 尝试将对象添加到可变数组时发送到实例的无法识别的选择器

> ID：13556482
> 
> 赞同：0
> 
> 时间：2012-11-25T23:01:04.673
> 
> 标签：objective-c, ios6

我正在关注“[你的第二个 iOS 应用程序](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html)”，我决定使用代码来很好地理解 Objective C ......

我要做的只是将一个对象添加到类中的可变数组中。以下是课程：

**BirdSighting.h**

```
#import <Foundation/Foundation.h>

@interface BirdSighting : NSObject
@property (nonatomic, copy) NSString *name;
@property (nonatomic, copy) NSString *location;
@property (nonatomic, copy) NSDate *date;

-(id) initWithName: (NSString *) name location:(NSString *) location date:(NSDate *) date;
@end 
```

**BirdSighting.m**

```
#import "BirdSighting.h"

@implementation BirdSighting
-(id) initWithName:(NSString *)name location:(NSString *)location date:(NSDate *)date
{
    self = [super init];

    if(self) {
        _name = name;
        _location = location;
        _date = date;

        return self;
    }

    return nil;
}

@end 
```

**BirdSightingDataController.h**

```
#import <Foundation/Foundation.h>
@class BirdSighting;

@interface BirdSightingDataController : NSObject
@property (nonatomic, copy) NSMutableArray *masterBirdSightingList;

- (NSUInteger) countOfList;
- (BirdSighting *) objectInListAtIndex: (NSUInteger) theIndex;
- (void) addBirdSightingWithSighting: (BirdSighting *) sighting;
@end 
```

**BirdSightingDataController.m**

```
#import "BirdSightingDataController.h"

@implementation BirdSightingDataController
- (id) init {
    if(self = [super init]) {
        NSMutableArray *sightingList = [[NSMutableArray alloc] init];
        self.masterBirdSightingList = sightingList;
        return self;
    }

    return nil;
}

-(NSUInteger) countOfList 
{
    return [self.masterBirdSightingList count];
}

- (BirdSighting *) objectInListAtIndex: (NSUInteger) theIndex
{
    return [self.masterBirdSightingList objectAtIndex:theIndex];
}

- (void) addBirdSightingWithSighting: (BirdSighting *) sighting
{
    [self.masterBirdSightingList addObject:sighting];
}
@end 
```

这就是我尝试将 BirdSighting 实例添加到可变数组的地方：

```
#import "BirdsMasterViewController.h"
#import "BirdsDetailViewController.h"

#import "BirdSightingDataController.h"
#import "BirdSighting.h"

@implementation BirdsMasterViewController

- (void)awakeFromNib
{
    [super awakeFromNib];

    BirdSightingDataController *dataController = [[BirdSightingDataController alloc] init];

    NSDate *date = [NSDate date];
    BirdSighting *sighting = [[[BirdSighting alloc] init] initWithName:@"Ebabil" location:@"Ankara" date: date];

    [dataController addBirdSightingWithSighting: sighting];
    NSLog(@"dataController: %@", dataController.masterBirdSightingList);

    self.dataController = dataController;

}
..........
@end 
```

它在 BirdSightingDataController addBirdSightingWithSighting 方法中抛出 NSInvalidArgumentException ...

我究竟做错了什么？

这是完整的调试输出： 2012-11-26 01:22:38.495 BirdWatching[4597:c07] -[__NSArrayI addObject:]: unrecognized selector sent to instance 0x71899d0 2012-11-26 01:22:38.496 BirdWatching[4597: c07] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSArrayI addObject:]：无法识别的选择器发送到实例 0x71899d0”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:13:34.833

这一行：

```
BirdSighting *sighting = [[[BirdSighting alloc] init] initWithName:@"Ebabil" location:@"Ankara" date: date]; 
```

应该：

```
BirdSighting *sighting = [[BirdSighting alloc] initWithName:@"Ebabil" location:@"Ankara" date: date]; 
```

您不能调用两个初始化程序。

更新：

根据完整的错误消息，我现在看到了问题。您认为您拥有的`NSMutableArray`财产确实是一个`NSArray`. 这是由使用 定义属性引起的`copy`。

当您`copy`为属性定义时，它会生成对象的不可变副本。因此，当您分配您的 时`NSMutableArray`，会制作一个不可变的副本，然后将其分配给实例变量。所以你最终分配了一个`NSArray`，而不是一个`NSMutableArray`。

解决方法是将属性定义从：

```
@property (nonatomic, copy) NSMutableArray *masterBirdSightingList; 
```

至：

```
@property (nonatomic, strong) NSMutableArray *masterBirdSightingList; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:35:43.383

如果您阅读错误消息，它会说“addObject”已“发送”到 NSArray，这是无效的。这是真的。如果您查看 NSArray 的规范，您将找不到方法“addObject”。

在某个地方，您有一个 NSArray，您正在尝试在其上执行“addObject”。很难说在哪里，因为您显然没有列出发生错误的代码部分，或者您在将“masterBirdSightingList”设置为 NSArray 之后，首先将其设置为 NSMutableArray。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-23T14:03:30.480

0

我有类似的错误说：无法识别的选择器发送到 NSMutable 数组的实例。在经历了很多事情之后，我发现我正在使用我的可变数组作为属性

@property (assign, nonatomic) NSMutableArray *myMutableArray;

复制粘贴时不注意，这导致了问题。

我将其更改为强类型的解决方案（您可以将其更改为任何其他类型，如强/弱等。根据您的要求）。所以我的解决方案是：

@property（强，非原子）NSMutableArray *myMutableArray; 所以，复制粘贴时要小心！做一次检查。

# php - jqplot ajax请求

> ID：13556484
> 
> 赞同：0
> 
> 时间：2012-11-25T23:01:51.773
> 
> 标签：php, jquery, ajax, jqplot

我正在尝试为 JQplot 图表进行动态内容加载，但出了点问题：这是我的 javascript 代码：

```
$(document).ready(function(){

var ajaxDataRenderer = function(url, plot, options) {
var ret = null;
$.ajax({
  // have to use synchronous here, else the function
  // will return before the data is fetched
  async: false,
  url: url,
  dataType:"json",
  success: function(data) {
    ret = data;
    console.warn(data);
  }
});
return ret;

 };

 // The url for our json data   var jsonurl = "getData.php";
     var plot1 = $.jqplot('chart1', jsonurl, {
      title:'Data Point Highlighting', 
 dataRenderer: ajaxDataRenderer,  
  dataRendererOptions: {  
      unusedOptionalUrl: jsonurl
    },

      axes:{
        xaxis: {
                    renderer:$.jqplot.DateAxisRenderer,
                    min: '11/01/2012',
                    max:   '11/30/2012',

                    tickOptions:{formatString:'%b %#d'},
                    tickInterval:'5 days'
                },
        yaxis:{
          tickOptions:{
            formatString:'%.2f'
            }
        }
      },
      highlighter: {
        show: true,
        sizeAdjust: 7.5
      },
      cursor: {
        show: false
      }   }); }); </script> 
```

它正在显示图表，但没有显示值，看起来它没有获取我的数据。

输出：

```
console.warn(data); 
```

是：

```
[["11-01-2012",0],["11-02-2012",0],["11-03-2012",0],["11-04-2012",0],["11-05-2012",0],["11-06-2012",0],["11-07-2012",0],["11-08-2012",0],["11-09-2012",0],["11-10-2012",0],["11-11-2012",0],["11-12-2012",0],["11-13-2012",0],["11-14-2012",0],["11-15-2012",2],["11-16-2012",5],["11-17-2012",0],["11-18-2012",1],["11-19-2012",0],["11-20-2012",0],["11-21-2012",0],["11-22-2012",0],["11-23-2012",0],["11-24-2012",0],["11-25-2012",1],["11-26-2012",0],["11-27-2012",0],["11-28-2012",0],["11-29-2012",0],["11-30-2012",0]] 
```

但是，如果我使用这样的静态变量，它就可以工作：

```
 var s1 = [["11-01-2012",0],["11-02-2012",0],["11-03-2012",0],["11-04-2012",0],["11-05-2012",0],["11-06-2012",0],["11-07-2012",0],["11-08-2012",0],["11-09-2012",0],["11-10-2012",0],["11-11-2012",0],["11-12-2012",0],["11-13-2012",0],["11-14-2012",0],["11-15-2012",2],["11-16-2012",5],["11-17-2012",0],["11-18-2012",1],["11-19-2012",0],["11-20-2012",0],["11-21-2012",0],["11-22-2012",0],["11-23-2012",0],["11-24-2012",0],["11-25-2012",1],["11-26-2012",0],["11-27-2012",0],["11-28-2012",0],["11-29-2012",0],["11-30-2012",0]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T07:53:42.427

我的 PHP 没有返回正确的数组格式。

# javascript - 如何禁用点击事件

> ID：13556485
> 
> 赞同：0
> 
> 时间：2012-11-25T23:02:02.870
> 
> 标签：javascript, jquery, html

```
function insertQuestion(form) {
    var x = "<img src='Images/plussigndisabled.jpg' width='30' height='30' alt='Look Up Previous Question' class='plusimage' name='plusbuttonrow'/><span id='plussignmsg'>(Click Plus Sign to look <br/> up Previous Questions)</span>";
    if (qnum == <? php echo(int) $_SESSION['textQuestion']; ?> ) {
        $('#mainPlusbutton').replaceWith(x);
    }
    //append rows into a table code, not needed for this question
}....
$('.plusimage').live('click', function () {
    plusbutton($(this));
});

function plusbutton(plus_id) {
    // Set global info
    plusbutton_clicked = plus_id;
    // Display an external page using an iframe
    var src = "previousquestions.php";
    $.modal('<iframe src="' + src + '" style="border:0;width:100%;height:100%;">');
    return false;
} 
```

```
<form id="QandA" action="<?php echo htmlentities($action); ?>" method="post">
<table id="question">
  <tr>
    <td colspan="2">
      <a onclick="return plusbutton();">
        <img src="Images/plussign.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage" id="mainPlusbutton" name="plusbuttonrow"/>
      </a>
      <span id="plussignmsg">
        (Click Plus Sign to look up Previous Questions)
      </span>        
    </td>
  </tr>
</table>
<table id="questionBtn" align="center">
  <tr>
    <th>
      <input id="addQuestionBtn" name="addQuestion" type="button" value="Add Question" onClick="insertQuestion(this.form)" />
    </th>
  </tr>
</table>
</form> 
```

在上面的代码中，当满足 if 语句时，我可以用另一个图像替换一个图像。但我的问题是，当图像被替换时，它不会禁用点击事件。我的问题是，当图像被替换时，如何禁用 onclick 事件`onclick="return plusbutton();`？

在这种情况下可以取消绑定点击工作。我不想使用`href=#`，因为我不想在 url 末尾包含 #

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:12:49.967

您应该使用`$('.plusimage').off('click');`禁用单击事件（取消绑定和 live 在 jQuery < 1.7 上已弃用，但仍受支持）。

如果您正在寻找一种仅允许单击元素的方法，则可以使用以下方法：

```
function insertQuestion(form) {   

    var x = "<img src='Images/plussigndisabled.jpg' width='30' height='30' alt='Look Up Previous Question' class='plusimage' name='plusbuttonrow'/><span id='plussignmsg'>(Click Plus Sign to look <br/> up Previous Questions)</span>" ;

    if (qnum == <?php echo (int)$_SESSION['textQuestion']; ?>) {
       $('#mainPlusbutton').replaceWith(x);
       //If the condition hold, then deactivate the click event!
       $('form table a').addClass('disabled');
    }
    else{
       //If the condition is false, click event is activated removing the disabled class
       $('.form table a').removeClass('disabled');
    }
    //append rows into a table code, not needed for this question
} 
```

添加此单击事件并删除`onclick="return plusbutton();`内部链接元素：

```
//Click event activated only if the disabled class is not set
$('form table a:not(.disabled)').on('click', function() {
   plusbutton($(this));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T01:14:10.727

也许它并不完全正确，因为它没有在 JsFiddle 中运行，但如果你将它与汤姆的问题一起加入，它应该会给你一些提示。

[http://jsfiddle.net/jeanpaul1982/38hjZ/15/](http://jsfiddle.net/jeanpaul1982/38hjZ/15/)

也许原因是我删除了一些 php，因为没有办法回显或检查 session 变量，尽管我认为你应该首先检查 $_SESSION 变量是否存在。

@add Tom：对 PHP 回显做了一些小的修改

```
function insertQuestion(form) {   

    var x = "<img src='Images/plussigndisabled.jpg' width='30' height='30' alt='Look Up Previous Question' class='plusimage' name='plusbuttonrow'/><span id='plussignmsg'>(Click Plus Sign to look <br/> up Previous Questions)</span>" ;

 <?
 //to avoid typecasting just declare the variable as a number
 $text_question_res=0;

session_start(); //If session has not started previously
if(isset($_SESSION['textQuestion']) ) $text_question_res.=$_SESSION['textQuestion'];
echo <<<EOD

if (qnum == $text_question_res) //expected to be a number

EOD;

//    if (qnum == <?php echo (int)$_SESSION['textQuestion']; ?>) {

       $('#mainPlusbutton').replaceWith(x);
       //If the condition hold, then deactivate the click event!
       $('.plusimage').addClass('disabled');
    }
    else{
       //If the condition is false, click event is activated removing the disabled class
       $('.plusimage').removeClass('disabled');
    }
    //append rows into a table code, not needed for this question
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:06:57.870

```
$('.plusimage').live('click', function() {
  if (qnum != <?php echo (int)$_SESSION['textQuestion']; ?>) {
    plusbutton($(this));
  }
}); 
```

# iphone - 在异步调用之前调用同步调用

> ID：13556494
> 
> 赞同：0
> 
> 时间：2012-11-25T23:03:15.633
> 
> 标签：iphone, objective-c, ios, ipad, cocoa

我这里有某种情况，想看看使用设计模式和 OOPS 概念的方法的最佳结果。

我有一个“网络服务”调用，如果使用不同的参数调用，可以说“床”、“汽车”和“玩具”。现在让我们将这些参数保留为 const，并且在调用时它们永远不会改变。

因此，基于这三个参数，它只能选择一个，并通过 Web 服务调用传递。

Web 服务调用最初被构造为“类方法”。因为，整个想法只是获取值，发出 nsurlRequest，获取数据，解析并以 NSDictionary 形式返回。

现在，业务需求发生了变化，“汽车”和“床”需要额外的“网络服务”调用，根据他们需要的“配件”，并选择客户是否需要，继续第一个网络- 服务电话。

因此，如果您注意到这有点像瀑布方法，因为第二个服务调用需要在第一个服务调用之前完成才能继续。

基于上述情况，处理这种情况的更好方法是什么？

我曾考虑过使用“类代表”，而不改变类的大部分结构，但只是想更清楚地了解是否有更好的方法。

我不能在这里使用 GCD，因为它也用于 iOS 3.0。

我现在使用 NSRunloop 机制，延迟 10 秒，但感觉这不是一个好方法。

谢谢。

# c# - System.Speech.dll 是否有 .NET 2.0 版本？

> ID：13556496
> 
> 赞同：1
> 
> 时间：2012-11-25T23:03:28.047
> 
> 标签：c#, .net, speech-recognition, text-to-speech, speech

我想知道是否有 System.Speech.dll 的 .NET 2.0 版本

我的`dlls`项目中有很多针对 .NET 2.0 的项目，我注意到一个项目引用`System.Speech.dll`；我尝试在 Google 上查找是否有任何`.Net 2.0`内容但无法弄清楚，以下是我如何计算目录中 .NET 版本的 dll 的代码。

```
 [TestMethod]
    public void TestDotNetVersion()
    {
        foreach (var file in Directory.EnumerateFiles(@"path to all dlls"))
        {
            Assembly assembly = null;
            string version = null;
            try
            {
                assembly = Assembly.ReflectionOnlyLoadFrom(file);
                version = assembly.ImageRuntimeVersion;
            }
            catch
            {
            }
        }
    } 
```

都是 .NET v2.0.50727 当我使用 .NET Reflector 时，我发现了一个引用 System.Speech.dll 的 dll。.NET 2.0 dll 是否可以引用针对 .NET 3.0 或 3.5 或 4 版本的 dll？（据我所知，我知道它不可能）如果没有，我在哪里可以找到 System.Speech.dll 的 .NET 2.0 版本？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T13:52:39.527

我很确定 System.Speech 是在 .Net 3.0 中引入的 - [http://msdn.microsoft.com/en-us/library/system.speech.recognition(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/system.speech.recognition(v=vs.85).aspx)。它确实在 Windows Vista 中首次亮相 - [http://msdn.microsoft.com/en-us/magazine/cc163663.asp](http://msdn.microsoft.com/en-us/magazine/cc163663.asp)。

不要忘记，如果您针对的是旧系统，则必须安装识别引擎。XP 和 Server 操作系统默认没有安装识别引擎。这可能会有所帮助 - [System.Speech.Recognition 和 Microsoft.Speech.Recognition 有什么区别？](https://stackoverflow.com/questions/2977338/what-is-the-difference-between-system-speech-recognition-and-microsoft-speech-re/2998963#2998963)

# php - mysqli_fetch_array 在某一行开始查询

> ID：13556497
> 
> 赞同：0
> 
> 时间：2012-11-25T23:03:32.543
> 
> 标签：php, mysqli, while-loop, fetch

我正在尝试在一些显示 MySQL 表中的行的页面上创建分页。每页显示表格中的六个项目。我正在使用一个while循环：

```
$row_users = mysqli_fetch_array($result_users, MYSQL_NUM); 
```

它只是不断循环遍历结果，直到不再有（我会包含完整的代码，但它是大量元素的一部分）。我有一个来自页面 id 的 GET 变量：

```
$page = $_GET['page']; 
```

基本上我想在每一页的特定行上启动 fetch 数组。例如在[http://www.example.com?page=2](http://www.example.com?page=2)我希望它从表的第 13 行开始 (($page*6)+1)。

我的问题是，如何让 fetch_array 从某一行开始？我看到了这篇文章：[Mysqli fetch array nth row](https://stackoverflow.com/questions/12126333/mysqli-fetch-array-nth-row)但这只是处理获取特定行，而不是开始循环并继续过去该行。我似乎无法在任何地方找到这样做的方法。也许我在谷歌搜索错误的东西......感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:07:16.817

与其在获取不需要的行时尝试跳过它们，不如告诉 MySQL 不要生成这些行更有效。在 SELECT 查询末尾使用 LIMIT 子句让 MySQL 只生成您需要的行：

[http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)

# javascript - jquery，javascript：调整谷歌地图api的中心/窗口位置

> ID：13556504
> 
> 赞同：1
> 
> 时间：2012-11-25T23:03:56.300
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我试图弄清楚如何调整谷歌地图 api 的窗口视图或中心位置。我有一个宽度为 100% 和高度为 100% 的谷歌地图 api，因此它覆盖了整个屏幕，并且它应该用作信息的背景，这样我就可以有一个要显示的项目列表。[例如， foursquare](https://foursquare.com/explore?near=Los%20Angeles,%20CA&q=food)是如何做到的。我希望能够做类似的事情，在旁边显示一个项目列表，并让窗口区域在它旁边。

我希望我解释清楚？

谢谢！

# c++ - Boost::Mpi 是否支持并行 IO

> ID：13556510
> 
> 赞同：1
> 
> 时间：2012-11-25T23:04:36.647
> 
> 标签：c++, boost, parallel-processing, mpi, boost-mpl

Boost::Mpi 是否支持并行 I/O？我找不到任何关于它的信息，当然，boost 文档（甚至关于链接器标志）已经完全过时了......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T01:01:41.090

不，Boost::MPI 仅支持 MPI 1.1 的功能（而[不是全部](http://www.boost.org/doc/libs/1_52_0/doc/html/mpi/tutorial.html#mpi.c_mapping)），而 MPI-IO 是 MPI 2.0 的一部分。很遗憾 Boost::MPI 的东西已经过时了，因为它是 MPI 最好的 C++ 接口之一。

# sql - SQLite，如何找到？

> ID：13556511
> 
> 赞同：1
> 
> 时间：2012-11-25T23:04:38.573
> 
> 标签：sql, sqlite

SQL新手在这里，只是学习如何做一些基础知识。在 SQLite 中工作，如果我有一组条件，我可以使用 搜索任何匹配项`IN`，如下所示：

```
SELECT * FROM people WHERE job_id IN (1,2,3) 
```

在这个人为的例子中，这会给我任何工作 ID 为 1、2 或 3 的人。但是，在不同的情况下，我怎么能把它变成一个 ALL 条件？IE。选择`job_id`匹配数组中所有术语的人？

我认为在某些数据库中你可以这样做：

```
SELECT * FROM people WHERE job_id IN ALL (1,2,3) 
```

但是当我在 SQLite 中尝试这个时，我得到了`syntax error near ALL`. 那么，你如何在 SQLite 中做到这一点，并且，为了奖励积分，有没有办法编写这种也与 PostgreSQL 兼容的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:06:09.653

```
SELECT columName          -- fetch only single column
FROM people 
WHERE job_id IN (1,2,3)
GROUP BY job_id
HAVING COUNT(*) = 3 
```

`GROUP BY`and后面`HAVING`是统计所有匹配的记录数`job_id`

# c# - XNA 中的碰撞检查，如果语句不起作用

> ID：13556512
> 
> 赞同：0
> 
> 时间：2012-11-25T23:04:50.670
> 
> 标签：c#, xna, collision-detection

所以我正在尝试使用我当前的代码来检测我的玩家精灵是否与静止物体接触。我已经完成了边界框教程，他们使用的语法对我不起作用，因为我的精灵变量设置不同。

这是我正在使用的 if 语句。

```
if (spritePosition.Equals(Booksposition))
{
   spritePosition.X = 0;
   spritePosition.Y = 0;
} 
```

我所需要的只是 C# 中用于检查两者是否发生冲突的语法。

这就是我的纹理设置的方式......

```
Texture2D myTexture;
Vector2 spritePosition = new Vector2(600,300);
Vector2 spriteSpeed = new Vector2(50.0f, 50.0f);
Texture2D Books;
Vector2 Booksposition = new Vector2(100, 300);
Vector2 BooksSpeed = new Vector2(50.0f, 50.0f); 
```

当我运行这段代码时，它什么也不做，尽管它确实编译和运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:11:58.173

而不是这个

```
if(spritePosition.Equals(Booksposition))
{
   spritePosition.X = 0;
   spritePosition.Y = 0;
} 
```

你应该尝试这样的事情

```
if(spritePosition.x >= Booksposition.x || spritePosition.y >= Booksposition.y)   
{
   spritePosition.X = 0;
   spritePosition.Y = 0;
} 
```

`>=`操作员可能不适合您，但我认为您明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-07T14:46:35.247

我看到这是一个迟到的回应，但为了向其他人提供信息，边界框怎么样？

在 2D 中很容易做到，只需使用：

BoundingBox myCollider = new BoundingBox((new Vector3(spritePosition.X, spritePosition.Y, 0), (new Vector3(spriteWidth, spriteHeight, 0));

在每个对象周围绘制其中一个，然后使用以下命令进行测试：

if (collider1.intersects(collider2)) { 从那里去 }

您可以使用矩形而不是边界框，但是当我学习碰撞时，每个人都告诉我使用 3D 工具并通过将 z 轴值设置为零来将它们压扁为 2D。

我希望这对（某人）有所帮助，安德鲁。

# java - 在不使用 javascript 的情况下在 html 页面上调用 java webservice

> ID：13556513
> 
> 赞同：-1
> 
> 时间：2012-11-25T23:04:54.490
> 
> 标签：java, html, web-services

我想知道如何在不使用 javascript 的情况下在 html 页面上调用 java webservice？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:08:43.500

要调用 Web 服务，您需要发出 HTTP 请求。

如果服务接受格式化为`application/x-www-form-urlencoded`数据的输入，并返回可由浏览器以人类可读形式呈现的内容，则可以使用 a `<form>`（尽管这确实意味着离开页面或使用框架）。

否则，您需要使用编程语言。

JavaScript 是在网页中执行此操作的标准方法，但由于您在问题中拒绝该方法，我将列出一些（支持较少的）替代方案。

*   Flash（需要插件）
*   Java 小程序（需要插件）
*   VBScript（需要 IE，甚至可能需要旧版 IE）
*   ActiveX 控件（需要 IE 和低安全设置）
*   PerlScript（需要 IE（可能是旧 IE）和插件（可能不再由编写它的 ActiveState 分发））。

并非所有平台都支持需要插件的选项。您当然可以为其中任何一个告别 iOS。

我强烈建议放弃“无 JavaScript”的要求。

# ruby-on-rails - 在 Rails 模型中创建“一”到“一或二”关系的最佳方法是什么？

> ID：13556515
> 
> 赞同：1
> 
> 时间：2012-11-25T23:05:10.933
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, ruby-on-rails-3.1

假设我们有一名足球运动员，这名球员只能拥有一两支球队，我的意思是他可能在俱乐部球队和/或国家队，或者什么都不是。在 Rails 关系中做到这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:18:36.067

我会`has_one`为每种团队类型创建关系。也许你打电话`club_team`给另一个`national_team`。不要使这些关系成为必需。这将实现您的目标，即允许玩家和团队之间存在 0、1 或 2 个关系。

您可以通过重命名模型中的关系来完成此操作。例如，如果你有一个名为的模型，`FootballTeam`那么你可以有两个这样的关系：

```
has_one club_team, :class_name => "FootballTeam"
has_one national_team, :class_name => "FootballTeam" 
```

这还将为您提供类似的方法`player.club_team`，`player.national_team`如果`player`是您的播放器模型的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:17:02.523

您所需要的只是表格中的一`:teams`列，该列`Players`接受一串代表团队的 ID。一个数字表示一个团队，两个（逗号分隔或其他）数字表示两个，无表示没有。

# php - 如何使用河豚为 crypt 方法自动生成盐

> ID：13556516
> 
> 赞同：5
> 
> 时间：2012-11-25T23:05:12.090
> 
> 标签：php, passwords, blowfish, crypt

我刚刚开始学习 PHP，我想为我最后一年的大学项目创建一个登录网站。我读过河豚是在许多地方进行散列的最佳方法，例如：[openssl_digest vs hash vs hash_hmac？盐和 HMAC 的区别？](https://stackoverflow.com/questions/8952807/openssl-digest-vs-hash-vs-hash-hmac-difference-between-salt-hmac/11195855#11195855)

我读到的关于 crypt 方法的所有地方都包含一个字符串，比如`$2y$07$usesomesillystringforsalt$`我的主要问题是：我如何随机生成这个？我读过时间戳和 mt_rand() 不安全的地方。

此外，我听说 AES 是最近的首选技术，但据我所知，在 PHP 中实现似乎相当棘手！河豚仍然是一种可以接受的方法来保护存储的密码吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T09:05:34.463

盐应该是**唯一的**（对于每个密码）并且**不可预测**。这两个标准对于确定性计算机来说有点难以满足，所以你能做的最好的事情就是使用操作系统的随机源来生成盐。

时间戳以及[`mt_rand()`](//php.net/mt_rand)功能并不理想，因为人们可能会争辩说它们是可预测的。至少攻击者可以缩小（并因此预先计算）特定时期的可能组合。虽然这在实践中可能不会产生很大的影响，但为什么不尽力而为呢？

从 PHP 5.3 开始，您可以安全地使用该[`mcrypt_create_iv()`](//php.net/mcrypt_create_iv)函数从随机源中读取数据，然后您必须将二进制字符串编码为允许的字母表。这是一种[可能的实现方式](http://www.martinstoeckli.ch/php/php.html#bcrypt)。

PHP 5.5 将拥有自己的功能[`password_hash()`](//php.net/password_hash)并[`password_verify()`](//php.net/password_verify)准备就绪，以简化此任务。还有一个适用于 PHP 5.3/5.4 的[兼容包](https://wiki.php.net/rfc/password_hash)，可在[password_compat](https://github.com/ircmaxell/password_compat)下载。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-22T19:01:52.700

对于 PHP 5.3.7 或更高版本，我相信这是最好的：

```
$blowfish_salt = "$2y$10$".bin2hex(openssl_random_pseudo_bytes(22)); 
```

对于 PHP 5.5 或更高版本，只需使用带有自动盐创建的新`password_hash()` [功能。](http://www.php.net/manual/en/function.password-hash.php)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-25T23:32:36.640

河豚仍然是可以接受的，并且比快速散列方法更受欢迎。

盐的目的是防止预先计算的表攻击。只要你有一个非平凡的盐，比如微时间，你就会阻止任何没有碰巧使用精确盐的预先计算的表。

# c# - 静态字典内容不变

> ID：13556518
> 
> 赞同：0
> 
> 时间：2012-11-25T23:05:21.210
> 
> 标签：c#, dictionary, thread-safety, threadpool

我有一个问题，我希望很容易解决。在过去的几天里，我一直在寻找答案，但还没有运气。我想要做的是有一个静态字典来表示连接的客户端，最终目标是发送所有连接的客户端数据，例如其他玩家位置。无论如何，到目前为止我所做的是当客户端第一次连接时，我将它们添加到静态字典中，如下所示：

```
RegionServer.RegionClients.Add(UserId, this);
Log.DebugFormat("Added peer to region list");

foreach (var client in RegionServer.RegionClients)
{
     Log.DebugFormat("Client id in list : {0}", client.Key);
} 
```

我在调试语句中添加了以确保客户端确实被添加到列表中，它就是。

然后在我的主文件中，我有：

```
public override  void InitBackgroundThreads()
    {
        ThreadPool.QueueUserWorkItem(SendUpdatesToAll);
    }

public void SendUpdatesToAll(object threadContext)
    {
        Stopwatch timer = new Stopwatch();
        timer.Start();
        isRunning = true;

        while (isRunning)
        {
            if (timer.Elapsed < TimeSpan.FromMilliseconds(100))
                continue;

            Update(timer.Elapsed);
            timer.Restart();
        }
    }

public void Update(TimeSpan elapsed)
    {

        foreach (KeyValuePair<Guid, Unity3dPeer> peer in RegionClients)
                {
                    Log.DebugFormat("Inside the foreach statement");
                } 
```

在我的调试日志中，我可以看到循环确实在循环，但 RegionClients 字典值从未更新。foreach 循环从不迭代，因为字典中似乎没有客户端。任何帮助将不胜感激，这个问题一直让我发疯！提前致谢。

-贾里德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:10:50.437

事实证明这很简单。我有一个集群服务器正在运行，我试图从不同的进程中引用这本字典......呃。感谢您的想法，事实证明它比尝试线程安全更简单。

# php - 意外的 T_STRING，找不到语法错误

> ID：13556521
> 
> 赞同：0
> 
> 时间：2012-11-25T23:05:48.033
> 
> 标签：php

我收到错误消息：

```
Parse error: syntax error, unexpected T_STRING in /mysite/my_library.php on line 43 
```

但是，我在它建议的代码中找不到任何语法错误：

```
/*
 * Get Full Filter Name from Abbreviation
 */
function getFilterName ($filterAbbreviation) {
    $filters = array(
        "R" => "Restuarant",
        "B" => "Bar",
        "S" => "Store",
        "L" => "Lodging",
        "Q" => "Recreation",
        "G" => "Gas Station",
        "E" => "Entertainment",
        "C" => "Club"
    );
    return $filters[$filterAbbreviation];
}
/*
 * Parse Filterstring 
 */
function parseFilterString($filterString) {
    $returnVal = "";
    $filterLetters = str_split($filterString, 1);
    for($x = 0; $x < strlen($filterString); $x++) {
        $returnVal .= "(type <=> '" . getFilterName($filterLetters[$x]) . "') OR ";
    }    
    if (strlen($returnVal) > 0) $returnVal =  substr($returnVal,0,-4); //remove final " OR " from filterstring
    else $returnVal = "type = 'VOID'";  //if everything is filtered, make sure to set type to something not available
    return $returnVal;
} 
```

请注意，此代码是从用户正在使用查询的页面中引用的`require()`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:26:56.100

原因（在您的情况下）是您的编辑器在文本中插入了一个隐藏字符。（编辑器是一个计算机程序，有时所有的计算机程序都会出错！）。线索是它似乎在抱怨一个空格，但除非用引号括起来，否则空格不是字符串，所以出了点问题。问题是它不是一个空间，而是别的东西......

解决方案是删除这个隐藏的字符。最安全的方法是删除该行并重新键入它 - 但如果隐藏字符位于结束行 (CR/CRLF) 标记内，最好也删除上面和下面的行。

所以，选择上面的行，有问题的行和下面的行（一口气，三行一起）。点击“删除”。然后键入（不要剪切和粘贴），但使用键盘重新键入有问题的行。

（注意 - 这不起作用，错误行可能只是移动。这是 delete 无法看到隐藏字符并且只删除它期望的测试的地方。这样做的诀窍是复制/粘贴所有内容 execpt 有问题的行 +/ - 1 到另一个文件中，然后在那个新文件中输入有问题的行 +/-1。在你的情况下，你不需要它，我只是为了回答的完整性而添加）。

# ruby-on-rails - 无法更改 simple_form 中文本字段的高度

> ID：13556522
> 
> 赞同：16
> 
> 时间：2012-11-25T23:05:56.470
> 
> 标签：ruby-on-rails, height, simple-form, textfield

我试过了

```
 #Default size for text inputs.  
  config.default_input_size = 10 
```

来自 config/initializers/simple_form.rb

我也试过`<%= f.input :message, :input_html => {:size => 10} %>`

但是这些都没有改变我的文本字段的显示方式。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-26T15:33:15.573

你需要这样做

```
<%= f.input :message, :input_html => {:rows => 10} %> 
```

Html 文本区域标签属性有两个属性`rows`，即`cols`允许您指定文本区域的行数和列数（即宽度）。如果这不起作用，请打开控制台并查看您的 css 是否覆盖了高度。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-20T13:19:22.490

传递 :input_html 选项会覆盖默认值。您必须检查可以修改其行为的 css 类的属性值。

```
<%= f.input : message, :as => :text, :input_html => { 'rows' => 10} %> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-06-04T07:54:45.373

我设法通过添加 `:as => :text`到输入字段属性然后将样式和行添加到输入 html 来做到这一点：

```
<%= f.input :message, label: "Message: ", :as => :text, input_html: { :style=> 'width: 100%;', :rows => 4} %> 
```

对我来说，正是`:as => :text`它让“行”属性起作用，100% 的宽度使它变得流畅而不是固定宽度。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-25T23:20:31.020

如果要更改“高度”，则需要修改 css 属性：

```
<%= f.input :message, input_html: {style: 'height:10px;'} %> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-16T03:31:21.830

老问题，我知道。这就是 SimpleForm 3.2.0 和 Rails 4.2.3 对我有用的：

```
<%= f.input_field :field_name, as: :text, class: "my-custom-class", rows: 5 %> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-25T23:35:36.387

你可以做

```
<%= f.input :message, :size => "10x10" %> 
```

对于高度和宽度。

它可能适用于文本字段，但绝对适用于[text_area](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-text_area)。无论如何，您可能都希望使用 text_area 作为消息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-25T23:15:39.183

尝试使用 Google Chrome 中的 Firebug 或 Code Inspector 来检查`text_field`元素，查看确切的类名并直接在样式表文件中进行更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-08T13:54:17.167

我刚刚在 Rails 5.1 和 Bootstrap4 上遇到了同样的问题。我做了以下事情：

`<%= f.input :bio, input_html: {style: 'height:200px !important;'} %>`

它有效。

# ruby-on-rails - 无法将 nil 转换为字符串 - 正则表达式问题？“\n\n”

> ID：13556523
> 
> 赞同：0
> 
> 时间：2012-11-25T23:06:04.200
> 
> 标签：ruby-on-rails, ruby, regex

我正在关注本教程 - [http://communityguides.heroku.com/articles/9](http://communityguides.heroku.com/articles/9) -app/controllers/admin_controller.rb

使用以下代码块遇到“无法将 nil 转换为字符串”错误。

```
# freeze state 
@article.freezebody = @article.title + "\n\n" + @article.teaser + "\n\n" + @article.body + "\n\n" + @article.version + "\n\n" + @article.changelog 
@article.accepted = Time.now 
```

这是一个正则表达式问题吗？我什至不知道从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:11:51.913

您的一个或多个属性是`nil`，并且：

```
nil + '' 
```

会给你你看到的异常。

要连接这些属性，减去任何可能为 nil 的属性（为便于阅读而缩短）：

```
[@article.title, @article.teaster].compact.join("\n\n") 
```

`compact``nil`从数组中删除所有对象。

# javascript - JavaScript 检测图像是否在缓存中

> ID：13556527
> 
> 赞同：3
> 
> 时间：2012-11-25T23:06:35.347
> 
> 标签：javascript, jquery, html, css

我目前正在使用 jQuery 加载图像并在完全加载后将其淡入。但是，**我现在想检测我尝试加载的图像是否已经在浏览器缓存中 - 如果是，则在 3 秒后将其淡入**。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:15:03.197

没有浏览器功能可以提前告诉您缓存中是否有内容。

如果你想缓存它，你可以预加载它，这样当你下次想使用它时它很可能会被缓存，但是没有办法知道它是否已经被缓存了。

您可以加载图像，然后确定是否立即加载，如果图像加载时间少于 1 秒（可能来自缓存）与更长（可能来自网络）加载，则采取不同的操作过程。`setTimeout()`这将涉及在短时间内设置 onload 处理程序和 a并根据先发生的情况采取行动。

与往常一样，如果您向我们描述您真正想要解决的问题，我们可能会给您更好的建议。

如果您想要做的（这只是阅读您的问题的猜测）是在 3 秒内（如果已缓存）或在加载时（如果未缓存）淡入图像，那么您可以使用代码像这样这样做：

工作演示：http: [//jsfiddle.net/jfriend00/XqJpT/](http://jsfiddle.net/jfriend00/XqJpT/)

```
function now() {
    return (new Date()).getTime();
}

function fadeMe(img, always) {
    var self = $(img);
    if (!self.data("faded") && (always || (now() - self.data("baseTime") >= 3000))) {
        self.fadeIn();
        self.data("faded", true);
    }
}

var img = $('<img class="initiallyHidden">')
    .data({
        baseTime: now(),
        faded: false,
        loaded: false
    })
    .appendTo(document.body)
    .load(function() {
        $(this).data("loaded", true);
        fadeMe(this, false);
    })
    .attr("src", "http://photos.smugmug.com/photos/344291068_HdnTo-S.jpg");

setTimeout(function() {
    if (img.data("loaded")) {
        fadeMe(img, true);
    }
}, 3000); 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T01:14:22.860

图像具有“完整”属性，如果图像从缓存中出来，它可能会立即为真。

[http://www.w3.org/TR/html5/the-img-element.html#dom-img-complete](http://www.w3.org/TR/html5/the-img-element.html#dom-img-complete)

# sql - 跨多个列过滤数据库，尝试将 null 包含在内

> ID：13556528
> 
> 赞同：1
> 
> 时间：2012-11-25T23:06:40.507
> 
> 标签：sql

```
SELECT [columns]  
FROM [db] 
WHERE [c1] IN 'A' 
  AND [c2] IN 'B, C' 
  AND [c3] LIKE (X and Null)... 
```

c3 目前是一个数组，虽然可以转换为二进制标志，但我需要包含空条目以及 LIKE 匹配项。

本质上，我正在尝试跨多个值（11 列）过滤现有表。当我对 [c3] 使用 OR 语句时，我得到了超出其他过滤条件的额外结果。将 AND 语句与 LIKE 一起使用过于严格，除非它还可以在 [c3] 中包含空条目。除了这个之外，所有其他元素都有效，因为由于标志重叠，我不得不将 [c3] 作为数组保留。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T23:44:44.280

This could have been accomplished without adding the strings (and more storage).

```
SELECT [columns] 
From [db] 
WHERE [c1] IN 'A' 
  AND [c2] IN 'B, C' 
  AND ([c3] LIKE 'X' OR [c3] IS NULL) 
```

# iphone - 音量问题 - AVAudioPlayer 与 AudioServices 系统声音混合

> ID：13556529
> 
> 赞同：1
> 
> 时间：2012-11-25T23:06:53.993
> 
> 标签：iphone, xcode, ipad, audio, avaudioplayer

我在处理游戏中的声音时遇到了很大的问题。我使用 AVAudioPlayer 播放 BG 音乐，使用 AudioServices 系统声音播放短音效。音量有问题。

在游戏中降低音量会影响背景音乐和 SFX 音量。如果静音，则全部静音。但是音量增大只会正确影响背景音乐，但 SFX 会在主要音效音量设置方面达到最大。如果音效音量设置为 0，我没有 SFX，但音乐播放正常。希望很清楚。

怎么在游戏里调节两个音量？？

请帮助我，因为截止日期快到了：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T23:47:48.017

解决了，我写了一篇简短的博客文章：[https ://coderwall.com/p/jslwrg](https://coderwall.com/p/jslwrg)

# jquery - 循环具有固定位置的水平滚动div

> ID：13556533
> 
> 赞同：2
> 
> 时间：2012-11-25T23:07:06.027
> 
> 标签：jquery, css

我有一个 div `.project-container`，其中包含一组具有设定高度和宽度的 div。我已经将它设置为滑动到一个位置，该位置增加，点击使用一些 jQuery。

```
$("#right").click(function() {
    $(".project-container").animate(
            {"left": "+=1060px"},
            "slow");
});
$("#left").click(function() {
    $(".project-container").animate(
            {"left": "-=1060px"},
            "slow");
}); 
```

中的每个 div`.project-container`使用以下 jQuery 彼此绝对定位

```
$('.one-project').each(function(i){
  $(this).css({ left: 1060 * i });
}); 
```

我单击右键，它会滑到下一个 div，当我单击它时，它会继续移动。

我的问题是，在 div 集的末尾，我正在尝试确定它是否可以再次跳回开始的 div（位置）。此外，这是否有可能总是回到第二个 div，并且总是从第二个 div 开始？

这是我到目前为止所拥有的：http: [//goo.gl/Cbr8R](http://goo.gl/Cbr8R)

任何帮助都会很好。尝试自定义构建并陷入困境。我相信这对你们来说很容易；）

谢谢，R

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:24:44.733

永远不要弄乱画廊的方向。如果您单击 RIGHT，每个人都希望画廊向左滑动，显示“RIGHT”内容。

这是任何画廊逻辑的基础：

*   创建一个计数器`C`
*   单击时增加/减少该计数器
*   动画`minus left`只是做`- C * OneSlideWidth`
*   将计数器**if** `-1` (LEFT -1 行为) 固定为`numberOfSlides-1`
*   对于任何其他点击做`counter % numberOfSlides`

这是逻辑：

```
var W = $('.slide').width(); // one slide width
var N = $('.slide').length;  // number of slides
var C = 0;                   // counter

$('#slider').width( W*N );   // (if needed) to make space for left floated images

$('#left, #right').click(function(){
     var myID = this.id == 'right' ? C++ : C-- ;
     C= C===-1 ? N-1 : C%N ;
     $('#slider').stop().animate({left: -C*W }, 1000 );
}); 
```

## *[带有画廊要领的 jsBin 演示](http://jsbin.com/itimoq/1/edit)*

代码说明：

1.  `var myID = this.id=='right' ? C++ : C-- ;`
    一个虚拟变量，只是为了使用三元运算符 (?:) 进行我们的`C`de/incrementations

    > [陈述] ？[如果为真]：[如果为假]

2.  `C= C===-1 ? N-1 : C%N ;`
    再次使用三元操作：如果`C==0`（初始状态）并在**左键**单击后：`C=== -1`将其重置为最后一张幻灯片（`N-1`）
    对于所有其他**左键**和**右键**单击，`C % N`将应用：
    `%`是模运算符，它将返回一个提醒`C`和`N`的划分 For`C`几乎总是小于`N`它会在最后一张幻灯片中返回当前的`C` **UNLESS** ，如果我们单击**RIGHT** than`C===N`并将`%`其转换为`0`.

    应用于我们的动画逻辑`left: -C*W`的实际上是`left: -0`（第一张幻灯片）。

# html - 如何在我的图片库中解决此问题？

> ID：13556537
> 
> 赞同：0
> 
> 时间：2012-11-25T23:07:16.450
> 
> 标签：html, class, gallery, image

这就是我的画廊中图像的 HTML：

```
<p class="crop">
<img src="image1.jpg" alt="image1.jpg" /></p>
<p class="crop">
<img src="image2.jpg" alt="image2.jpg" /></p> 
```

但是，使用这样的 p 类会使它们分开图像而不是一组图像，因此我的下一个/上一个箭头不起作用。

我需要为它们制作一组图像，以便画廊中的箭头可以再次正常工作，但我想保留 p 类，因为我需要它来裁剪图像。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:10:28.323

将 p 替换为 1 div，使其看起来像：

```
<div class="crop">
<img>
<img>
</div> 
```

根据需要添加更多图片（填写图片数据）

然后，您可以在 CSS 中使用：

```
.crop img {} 
```

裁剪图像！

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:13:13.500

将裁剪逻辑移动到 img 标签

```
<img class="crop" src="image1.jpg" alt="image1.jpg" />
<img class="crop" src="image2.jpg" alt="image2.jpg" /> 
```

# ember.js - 显示索引/排序的 DS.hasMany

> ID：13556538
> 
> 赞同：0
> 
> 时间：2012-11-25T23:07:40.543
> 
> 标签：ember.js, ember-data

我试图找出显示对象数组的正确方法，这些对象数组由对象的唯一“categoryName”属性索引，但我目前尝试这样做的方式并没有像我期望的那样表现。

```
LO.List = DS.Model.extend({
  name: DS.attr('string'),
  items: DS.hasMany('LO.Item'),

  categoryNames: function() {
     // return an array of all unique item.categoryNames
  }.property('items.@each.isLoaded')
});

LO.Item = DS.Model.extend({
  name: DS.attr('string'),
  categoryName: DS.attr('string')
}); 
```

在我的模板中，我试图遍历每个 categoryName，渲染它，然后渲染该类别中的所有项目。

```
<ul>
    {{#each content.categoryNames}}
        <li>
          Category: {{this}}

          Items: {{view LO.ItemsInCategoryView categoryNameBinding="" itemsBinding=""}}
        </li>
    {{/each}}
</ul> 
```

我对 ItemsInCategoryView 的绑定有问题，因为我无法获取当前上下文 categoryName 或该视图中的整个 Items 数组。

摆弄：http: [//jsfiddle.net/6ph42/2/](http://jsfiddle.net/6ph42/1/)

我应该这样做有不同的方式吗？如果没有，我应该将哪些绑定传递给这里的视图？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:07:50.870

可能有更优雅的方式，但我认为你必须创建一个新的数据结构来完成你想要的。

您可以即时创建它：

```
categories: function() {
  var categories = [],
      items = this.get('items');

  items.forEach(function(item) {
    var categoryName = item.get('categoryName');

    var category = categories.filterProperty('name', categoryName);
    if(category.length === 0) {
        category = Ember.Object.create({name: categoryName, items: []})
        categories.addObject(category);
    }else{
         category = category.get('firstObject');   
    }
    category.get('items').addObject(item);
  });

  return categories;
}.property('items.@each.isLoaded') 
```

我相应地更新了你的jsfiddle：

[http://jsfiddle.net/6ph42/3/](http://jsfiddle.net/6ph42/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T19:41:27.423

我开始研究一个更优雅的解决方案，使用 ArrayController 用于类别（可能应该是它自己的模型）和这个新的 CategoriesController 上的 sortProperties（来自[Ember.SortableMixin](http://emberjs.com/api/classes/Ember.SortableMixin.html)，它内置在 ArrayControllers 中。）

```
LO.CategoriesController = Em.ArrayController.extend({
  sortProperties: ['categoryName'],
  sortAscending: true,
}); 
```

我还演示了如何在列表视图中使用插座将列表类别与列表模板本身分开。这里还有更多工作要做，但总的来说，您会发现越能分离关注点并将视图和模型分解为尽可能小的组件，Ember 就会开始变得更有意义。

[http://jsfiddle.net/hNmBF/1/](http://jsfiddle.net/hNmBF/1/)

抱歉，我无法完成，我认为我们要么需要查看您的真实应用程序，要么需要一个更简洁的示例（尽管我知道说起来容易做起来难，所以我不会处理你的情况，我真的很想帮忙）。在不到 20 分钟的时间里，这有点太多了。

# php - Zend_db 仅在我的主模块中出现错误，并且仅当我使用 'woningen' 作为表名时

> ID：13556543
> 
> 赞同：3
> 
> 时间：2012-11-25T23:07:44.773
> 
> 标签：php, zend-framework, zend-db, zend-db-table

这是我用来在数据库中更新/插入数据的代码。

```
public function saveItem($post, $table)
    {
        unset($post['submit']);
        $this->_table = new Zend_Db_Table($table); exit;

        if (isset($post['id'])) {
            $where = $this->_table->getAdapter()->quoteInto('id = ?', $post['id']);
            $this->_table->update($post, $where);
            return $post['id'];
        } else {
            return $this->_table->insert($post);
        }
    } 
```

由于某些原因

```
$this->_table = new Zend_Db_Table($table); 
```

给我一个错误，但只有在 $table = 'woningen' 并且仅在我的主模块中。

## 这是错误：

```
APPLICATION ERROR
EXCEPTION INFORMATION:
Message: Argument must be of type Zend_Db_Adapter_Abstract, or a Registry key where a Zend_Db_Adapter_Abstract object is stored
STACK TRACE:
#0 D:\xampp\htdocs\makeltrent.website\library\Zend\Db\Table\Abstract.php(581): Zend_Db_Table_Abstract::_setupAdapter('woningen')
#1 D:\xampp\htdocs\makeltrent.website\library\Zend\Db\Table\Abstract.php(283): Zend_Db_Table_Abstract->_setAdapter('woningen')
#2 D:\xampp\htdocs\makeltrent.website\library\Zend\Db\Table\Abstract.php(265): Zend_Db_Table_Abstract->setOptions(Array)
#3 D:\xampp\htdocs\makeltrent.website\library\Zend\Db\Table.php(77): Zend_Db_Table_Abstract->__construct(Array)
#4 D:\xampp\htdocs\makeltrent.website\application\models\Inlog.php(109): Zend_Db_Table->__construct('woningen')
#5 D:\xampp\htdocs\makeltrent.website\application\modules\default\controllers\WoningmandjeController.php(157): Application_Model_Inlog->saveItem(Array, 'woningen')
#6 D:\xampp\htdocs\makeltrent.website\library\Zend\Controller\Action.php(516): WoningmandjeController->sendAction()
#7 D:\xampp\htdocs\makeltrent.website\library\Zend\Controller\Dispatcher\Standard.php(295): Zend_Controller_Action->dispatch('sendAction')
#8 D:\xampp\htdocs\makeltrent.website\library\Zend\Controller\Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#9 D:\xampp\htdocs\makeltrent.website\library\Zend\Application\Bootstrap\Bootstrap.php(97): Zend_Controller_Front->dispatch()
#10 D:\xampp\htdocs\makeltrent.website\library\Zend\Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#11 D:\xampp\htdocs\makeltrent.website\public\index.php(26): Zend_Application->run()
#12 {main} 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T13:53:34.940

正如错误消息所解释的那样，我的第一个想法是，您有一个 Zend_Registry 键，名称为该名称，但不是 a 之类的对象`Zend_Db_Adapter_Pdo_Mysql`，这是它所期望的。由于这个原因，随机字符串不会失败，因为它最终会返回`false`, 或`null`- 它只是简单地从`_setupAdapter`函数中返回而不做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T08:15:41.450

我认为这是您的班级设置的问题。

Zend_Db_Table**需要 DB Adapter**来初始化而不是表名。您可以在 application.ini 中将您的适配器定义为默认数据库适配器。

```
resources.db.adapter = "PDO_MYSQL"
resources.db.params.host = "host"
resources.db.params.dbname = "database"
resources.db.params.username = "user"
resources.db.params.password = "password"
resources.db.isDefaultTableAdapter = true 
```

# php - 获取从 PHP ADO 连接返回到 MS-Access DB 的 JSON

> ID：13556544
> 
> 赞同：0
> 
> 时间：2012-11-25T23:07:49.103
> 
> 标签：php, json, ms-access

我正在尝试从 MS-Access 数据库查询返回 JSON 字符串。我得到了记录集（$rs），但试图循环返回 JSON，却不知道记录集中的所有字段。以下返回我想要的，但`[["aaa":"bbb","ccc":"ddd"]]`不是`[{ ... }]`我正在寻找的。

```
 $num_columns = $rs->Fields->Count ();
//echo $num_columns . "<br>";

$arrColumns = array();
for ($i=0; $i < $num_columns; $i++) {
    $arrColumns[] = $rs->Fields($i);
}

$arrResult = array();

while (!$rs->EOF) {
    $arrRow = array();
    for ($i=0; $i < $num_columns; $i++) {
        $arrRow[] = $arrColumns[$i]->value;
    }
    $arrResult[] = $arrRow;
    $rs->MoveNext();
}
//var_dump($arrResult);
echo json_encode($arrResult);
//print_r($arrResult); 
```

[更新]：

完成了动态部分，但仍然存在结果问题。因为我 `json_encode($Array)`无法使用我的 JQuery 获得我想要的结果。

```
$num_columns = $rs->Fields->Count ();
$arrColumns = array();

for ($i=0; $i < $num_columns; $i++) {
    $arrColumns[] = $rs->Fields($i);
    $newArr[] = $rs->Fields($i)->name; 
}

$arrResult = array();

while (!$rs->EOF) {
    $arrRow = array();
    for ($i=0; $i < $num_columns; $i++) {
       $arrRow[$newArr[$i]] = $arrColumns[$i]->value;
    }
    $arrResult[] = $arrRow;

    $rs->MoveNext();
}

echo $_GET['callback'] . '(' . json_encode($arrResult) . ')'; 
```

我的 JSON 返回如下：`[{"First":"John"},{"Last":"Doe"}]` 一个包含在对象中的数组。我需要返回一个对象或一个数组，以便我可以在客户端处理，例如：`{"First":"John"},{"Last":"Doe"}`

```
 <script>
        $.getJSON('http://remote.domain.com/json.php?callback=?',function(res){
            alert('Results: '+res.Last);
        });
    </script> 
```

我认为这可能是我的方式`json_encode($Array);`而不是使用课程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:21:50.470

如果要以`[{...}]`格式返回，则需要将`$arrRow`值从数组更改为类。为简单起见，您可以利用[`stdClass()`](http://php.net/manual/en/language.types.object.php)

尝试这样的事情：

```
while (!$rs->EOF) {
    $arrRow = array();

    $class = new stdClass();
    $class->field1 = $arrColumns[1]->value;
    $class->field2 = $arrColumns[2]->value;

    $arrRow[] = $arrColumns[$i]->value;

    $arrResult[] = $arrRow;
    $rs->MoveNext();
}

echo json_encode($arrResult); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:31:28.027

您没有它，`[["aaa":"bbb","ccc":"ddd"]]` 因为它不是有效的`json`数组格式……请参阅[JSON.ORG](http://www.json.org/)以了解规范

数组应表示为

![在此处输入图像描述](../Images/434de6243d0af29b76360a5bbfb35563.png)

而对象

![在此处输入图像描述](../Images/c5dda3ab1b87ff8ab76720536bd729ea.png)

你可以拥有的壁橱有阵列是

```
[["aaa","bbb"]["ccc","ddd"]] 
```

# mysql - MySql 查询示例

> ID：13556546
> 
> 赞同：0
> 
> 时间：2012-11-25T23:08:07.583
> 
> 标签：mysql

我使用了这个查询，我认为 mysql 服务器崩溃了。现在无法到达。这是巧合还是我的查询太糟糕了？如果它不好我该如何解决它

处理 400.000 行 2 个表，一个是 scorelisting，另一个是用户

```
SELECT a.* 
from 
(
    SELECT @curRank := @curRank +1 AS ROW , s.UserId,
       s.AverageScore As Score, u.UserName 
    FROM  scorelisting s, (SELECT @curRank :=0) r, Users u 
    where u.UserId=s.UserId 
    order by AverageScore desc
) a 
where UserId = 95890 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T01:22:24.337

我不知道我是否过度简化了这一点，但是......如果您正在寻找特定用户在其他人中的位置，我会找出那个人的“平均得分”是什么，然后得到一个 COUNT (*) 所有平均比你想要的更好的记录，然后得到那个人的名字......有意义吗？然后尝试以下。

**[修订和测试——SQL FIDDLE SQLFiddle](http://sqlfiddle.com/#!2/78ee9/1)** 上的示例有 6 个条目，用户 af 和 averageScores 分别为 10-60。该查询选择用户 3 (avgScore)，因此 3 (d, e 和 f) 具有更高的平均值 (40, 50, 60)，这将用户“c”(id 3) 放在第 4 位。

```
SELECT 
      u.UserName,
      PreQuery.AverageHigherThanYou +1 as UserRank
   from
      users u,
      ( select
              COUNT(*) as AverageHigherThanYou
           from 
              scoreListing s,
              ( select @MyAvg := s2.AverageScore
                   from scoreListing s2 
                   where s2.UserID = 95890 ) sqlvars
            where
               s.AverageScore > @MyAvg ) PreQuery
    where
       u.userid = 95890 
```

“PreQuery”只是为您的特定用户获取所有这些 LESS 的计数，而不是静态连接到 scoreListing 并放入单个列值中。

然后逗号用户表（旧的 ANSI，无连接条件）将始终返回一条记录...然后，仅在 USER 表上应用 WHERE 子句，以获取他们的姓名信息。

现在，如果您想要有多少是较高、相同或较低的平均值，您可以调整查询，例如

```
 ( SELECT 
          sum( if( s.averageScore < s2.averageScore, 1, 0 )) as LowerAverageThanYou,
          sum( if( s.averageScore = s2.averageScore, 1, 0 )) as SameAverageAsYou,
          sum( if( s.averageScore > s2.averageScore, 1, 0 )) as HigherAverageThanYou
       from 
          scoreListing s
             join scoreListing s2
                ON s2.UserID = 95890 ) PreQuery, 
```

你显然必须等到你的机器被释放后再试一次。

I would also have two indexes on the scoreListing table. One on just the ID to jump to UserID = 95890 record for comparing that person's average, and another on the averageScore, so if you did HIGHER THAN only, your WHERE clause would only have to scan through those records and not the entire 400,000 records.

# inheritance - SQLAlchemy 和带有 backrefs 的多态继承

> ID：13556549
> 
> 赞同：1
> 
> 时间：2012-11-25T23:08:23.943
> 
> 标签：inheritance, sqlalchemy, flask-sqlalchemy, polymorphism, backreference

我有类`Node`，`Leaf (Node)`如下所示： 它工作正常，但我更愿意将`leafs`and`subleafs`定义转移到`Leaf (Node)`类。我该如何做到这一点？

```
class Node (db.Model):
    __mapper_args__ = {'polymorphic_identity':'node', 'polymorphic_on':'type'}
    id = db.Column (db.Integer, primary_key=True)
    type = db.Column ('type', db.String (16))

    root_id = db.Column (db.Integer, db.ForeignKey (id))
    nodes = db.relationship ('Node',
        cascade='all', lazy='dynamic',
        primaryjoin='Node.root_id==Node.id',
        backref=db.backref('root', remote_side=id))
    leafs = db.relationship ('Leaf',
        cascade='all', lazy='dynamic',
        primaryjoin='Leaf.root_id==Node.id')

    base_id = db.Column (db.Integer, db.ForeignKey (id))
    subnodes = db.relationship ('Node',
        cascade='all', lazy='dynamic',
        primaryjoin='Node.base_id==Node.id',
        backref=db.backref('base', remote_side=id))
    subleafs = db.relationship ('Leaf',
        cascade='all', lazy='dynamic',
        primaryjoin='Leaf.base_id==Node.id')

    def __init__ (self, root):
        self.base = root.base if root and root.base else root
        self.root = root 
```

和

```
class Leaf (Node):
    __mapper_args__ = {'polymorphic_identity': 'leaf'}
    leaf_id = db.Column (db.Integer, db.ForeignKey ('node.id'), primary_key=True)

    def __init__ (self, root):
        super (Leaf, self).__init__ (root) 
```

我试过这个，但失败了（部分）：

```
class Leaf (Node):
    __mapper_args__ = {'polymorphic_identity': 'leaf'}
    leaf_id = db.Column (db.Integer, db.ForeignKey ('node.id'), primary_key=True)

    _x = db.relationship ('Node', backref=db.backref ('leafs',
        cascade='all', lazy='dynamic', primaryjoin='Leaf.root_id==Node.id'))
    _y = db.relationship ('Node', backref=db.backref ('subleafs',
        cascade='all', lazy='dynamic', primaryjoin='Leaf.base_id==Node.id'))

    def __init__ (self, root):
        super (Leaf, self).__init__ (root) 
```

我的**删除**测试用例不喜欢这样（只是删除树中的基本/根节点并依赖`cascade='all'`），并抱怨：

```
CircularDependencyError: Circular dependency detected. Cycles: set([DeleteState(<Leaf at 0x22789d0>)]) all edges: set([(DeleteState(<Leaf at 0x22789d0>), DeleteState(<Leaf at 0x22789d0>))]) 
```

我想改变定义的**原因**是，因为我不想扩展`Node`的每个子类的定义，`Leaf (Node)`稍后我可能会介绍。此外，我绝对不需要`_x`and `_y`，因为我已经有了`Leaf.root`and `Leaf.base`（由 提供`Node`）；但是**省略**它们（`_x =`& `_y =`）会带来麻烦，例如：

```
AttributeError: 'Node' object has no attribute 'leafs' 
```

我想我需要使用*一些东西*来`Leaf (Node)`附加关系，即使我不需要在我的原始定义中使用任何反向引用 for`leafs`和`subleafs`in `Node`。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:56:23.143

好吧，经过一番尝试，我找到了一个不完美的解决方案，但确实有效：我只是将`Node.leafs`and`Node.subleafs`定义移到了已定义的文件`leaf.py`中，`class Leaf (node)`并附加了以前的定义，如下所示：

```
class Leaf (Node):
    __mapper_args__ = {'polymorphic_identity': 'leaf'}
    leaf_id = db.Column (db.Integer, db.ForeignKey ('node.id'), primary_key=True)

    def __init__ (self, root):
        super (Leaf, self).__init__ (root)

Node.leafs = db.relationship (Leaf, cascade='all', lazy='dynamic',
    primaryjoin=Node.id==Leaf.root_id)

Node.subleafs = db.relationship (Leaf, cascade='all', lazy='dynamic',
    primaryjoin=Node.id==Leaf.base_id) 
```

这样做的一个缺点是人们`from models import Leaf`如果想要访问`Node.leafs`and`Node.subleafs`就必须这样做，但是因为无论如何他们都必须这样做（即使`Node.leafs`and`Node.subleafs`已被定义为 内的反向引用`class Leaf (Node)`），这没关系。

如果有人找到解决方案，其中关系被定义为 backrefs `class Leaf (Node)`，我很高兴收到您的来信；谢谢。

# ios - 在不同的设备方向上更改 UICollectionViewCell 大小

> ID：13556554
> 
> 赞同：100
> 
> 时间：2012-11-25T23:09:05.583
> 
> 标签：ios, uicollectionview, uicollectionviewcell

我正在使用`UICollectionView`with `UICollectionViewFlowLayout`。

我通过设置每个单元格的大小

```
collectionView:layout:sizeForItemAtIndexPath: 
```

从纵向切换到横向时，我想调整每个单元格的大小以完全适合 CollectionView 的大小，而不会在单元格之间留下填充空间。

问题：

1）如何在旋转事件后更改单元格的大小？

2）而且，更好的是，如何使单元格始终适合整个屏幕大小的布局？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2012-12-01T05:10:24.567

1）您可以维护和交换多个布局对象，但有一种更简单的方法。只需将以下内容添加到您的`UICollectionViewController`子类并根据需要调整大小：

```
- (CGSize)collectionView:(UICollectionView *)collectionView
                  layout:(UICollectionViewLayout *)collectionViewLayout
  sizeForItemAtIndexPath:(NSIndexPath *)indexPath
{    
    // Adjust cell size for orientation
    if (UIDeviceOrientationIsLandscape([[UIApplication sharedApplication] statusBarOrientation])) {
        return CGSizeMake(170.f, 170.f);
    }
    return CGSizeMake(192.f, 192.f);
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
    [self.collectionView performBatchUpdates:nil completion:nil];
} 
```

调用`-performBatchUpdates:completion:`将使布局无效并使用动画调整单元格的大小（如果您没有要执行的额外调整，您可以将 nil 传递给两个块参数）。

2) 无需在 中硬编码项目大小`-collectionView:layout:sizeForItemAtIndexPath`，只需将 collectionView 边界的高度或宽度除以您希望在屏幕上显示的单元格数即可。如果您的 collectionView 水平滚动，则使用高度；如果垂直滚动，则使用宽度。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-02-08T16:20:31.773

如果不希望 带来额外的动画`performBatchUpdates:completion:`，只需使用`invalidateLayout`强制 collectionViewLayout 重新加载即可。

```
- (void)viewWillLayoutSubviews
{
    [super viewWillLayoutSubviews];
    [self.collectionView.collectionViewLayout invalidateLayout];
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-11-28T13:38:21.120

我使用两个 UICollectionViewFlowLayout 解决了。一张是纵向的，一张是横向的。我在 -viewDidLoad 中动态地将它们分配给我的 collectionView

```
self.portraitLayout = [[UICollectionViewFlowLayout alloc] init];
self.landscapeLayout = [[UICollectionViewFlowLayout alloc] init];

UIInterfaceOrientation orientationOnLunch = [[UIApplication sharedApplication] statusBarOrientation];

if (UIInterfaceOrientationIsPortrait(orientationOnLunch)) {
    [self.menuCollectionView setCollectionViewLayout:self.portraitLayout];
} else {
    [self.menuCollectionView setCollectionViewLayout:self.landscapeLayout];
} 
```

然后我像这样简单地修改了我的 collectionViewFlowLayoutDelgate 方法

```
- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath{
    CGSize returnSize = CGSizeZero;

    if (collectionViewLayout == self.portraitLayout) {
        returnSize = CGSizeMake(230.0, 120.0);
    } else {
        returnSize = CGSizeMake(315.0, 120.0);
    }

    return returnSize;
} 
```

最后我在旋转时从一个布局切换到另一个

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation{
    if (UIInterfaceOrientationIsPortrait(fromInterfaceOrientation)) {
        [self.menuCollectionView setCollectionViewLayout:self.landscapeLayout animated:YES];
    } else {
        [self.menuCollectionView setCollectionViewLayout:self.portraitLayout animated:YES];
    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-05-31T15:21:24.100

有一种设置集合视图单元格大小的简单方法：

```
UICollectionViewFlowLayout *layout = (id) self.collectionView.collectionViewLayout;
layout.itemSize = CGSizeMake(cellSize, cellSize); 
```

不确定它是否是可动画的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-11-07T23:23:36.753

**Swift：集合视图单元格是屏幕高度的 n%**

我需要的是一个占视图高度一定百分比的单元格，并且会随着设备旋转而调整大小。

在上面的帮助下，这是解决方案

```
override func viewDidLoad() {
    super.viewDidLoad()
    automaticallyAdjustsScrollViewInsets = false
    // if inside nav controller set to true
}

override func willRotateToInterfaceOrientation(toInterfaceOrientation: UIInterfaceOrientation, duration: NSTimeInterval) {
    collectionViewLayout.invalidateLayout()
}

func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAtIndexPath indexPath: NSIndexPath) -> CGSize {
    return CGSize(width: 100, height: collectionView.frame.height * 0.9)
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-16T11:43:40.350

如果您正在使用`autolayout`。您只需要`invalidate layout`在您的视图控制器中旋转和调整`offset`您的流布局子类。

所以，在你的视图控制器中 -

```
override func willRotateToInterfaceOrientation(toInterfaceOrientation:     UIInterfaceOrientation, duration: NSTimeInterval) {
    self.galleryCollectionView.collectionViewLayout.invalidateLayout()
} 
```

在你的`FlowLayout Subclass`

```
override func prepareLayout() {
    if self.collectionView!.indexPathsForVisibleItems().count > 0{
    var currentIndex : CGFloat!
    currentIndex = CGFloat((self.collectionView!.indexPathsForVisibleItems()[0] as! NSIndexPath).row)
    if let currentVal = currentIndex{
        self.collectionView!.contentOffset = CGPointMake(currentIndex * self.collectionView!.frame.width, self.collectionView!.contentOffset.y);
    }   
    }     
} 
```

# ruby - 在 Ruby 中使用许多“gsub”实例

> ID：13556555
> 
> 赞同：6
> 
> 时间：2012-11-25T23:09:17.143
> 
> 标签：ruby

我正在用 Ruby (1.9.3) 制作一个基本的翻译器。我从本地测试文件（'a.txt'）中提取并使用 gsub 替换某些匹配项以模仿从当代英语到中/早期现代英语的翻译。我遇到了一个可读性问题：

如何使大量 gsub 的使用更易于阅读？我尝试使用以开头的多行

```
def translate 
  @text.gsub(/my/, 'mine')
  @text.gsub(/\sis\s/, ' be ')
end 
```

但这只会打印最终的 gsub。我只能假设第二个请求会覆盖第一个请求。我想避免创建一大堆 gsub 请求，但我似乎找不到合适的答案。

这是我当前程序的示例：

```
lines = File.readlines('a.txt')
@text = lines.join

def translate 
  @text.gsub(/my/, 'mine').gsub(/\sis\s/, ' be ').gsub(/y\s/, 'ye ').gsub(/t\s/, 'te ').gsub(/t\,/, 'te,').gsub(/t\./, 'te.')
end

puts translate 
```

如果这个要求看起来非常基本，我提前道歉。干杯!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T23:17:18.433

该`String#gsub`方法返回完成替换的字符串的新副本，而原始字符串保持不变。您的第一个示例中的两个替换都已完成，但第一个的结果被丢弃，因为它没有分配给任何东西。第二个的结果作为方法的结果返回。

如果您改为使用该`#gsub!`方法，则会使用替换结果修改原始字符串，从而可以更轻松地进行多次替换。

```
def translate 
  @text.gsub!(/my/, 'mine')
  @text.gsub!(/\sis\s/, ' be ')
  @text
end 
```

如果您不想修改对象的属性，您可以使用 开始方法`text = @text.dup`，然后在方法的其余部分使用`text`变量代替`@text`属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-25T23:49:14.623

第二个调用不会覆盖第一个。第一次调用返回一个带有替换的副本`@text`，但您没有对该返回值做任何事情。如果要修改`@text`，则需要改为使用`gsub!`。如果您不想修改`@text`，则需要链接`gsub`调用。例如，如果你有来自[slivu's answer](https://stackoverflow.com/a/13556720/1507392)的映射哈希，这将返回翻译后的文本，而无需实际修改`@text`实例变量：

```
def translate
  RegexMap.inject(@text) do |string, mapping|
    string.gsub(*mapping)
  end
end 
```

传递给的块在`inject`每个映射（中的键/值对`RegexMap`）中调用一次。第一次`string`是传递给`inject`- 的值，即`@text`。之后，每个后续调用都将传入的前一个调用的返回值作为其`string`值。所以就好像你这样做了，但是使用一组映射更容易配置：

```
@text.gsub(/my/,'mine').gsub(/\sis\s/, ' be ').gsub(/y\s/,'ye ').gsub.... 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-25T23:30:54.743

更具可读性？

然后您会考虑构建地图并在其上使用循环吗？

```
RegexMap = {
  /my/     => 'mine',
  /\sis\s/ => ' be ',
  /y\s/    => 'ye ',
  /t\s/    => 'te ',
  /t\,/    => 'te,',
  /t\./    => 'te.',
}
text = '123 my 456 is 123y 456t 123t, 456t.'
RegexMap.each_pair {|f,t| text = text.gsub(f, t)}
puts text

#=> 123 mine 456 be 123ye 456te 123te, 456te. 
```

**更新：**正如马克所建议的，使用`gsub!`将避免多余的复制/分配操作：

```
RegexMap.each_pair {|f,t| text.gsub! f, t} 
```

### [这是一个工作演示](http://cibox.org/slivu/stackoverflow?lang=ruby&file=using-many-instances-of-gsub-in-ruby.rb&run=true)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T05:55:43.587

如果您总是在转换一个特定的模式，即单词，那么您可以有一个简单的匹配模式，然后根据单词替换`gsub`每个匹配模式的一次运行。

```
def translate 
  @text
  .gsub(/[ \t]+/, " ")
  .gsub(/\w+/,
    "my" => "mine",
    "is" => "be",
    "y" => "ye",
    "t" => "te"
  )
end 
```

这比多次迭代要快得多`gsub`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T01:00:11.277

基于 slivu 的想法，这里有一个类似 Perl 的替代方案：

```
@text = '123 my 456 is 123y 456t 123t, 456t.'

def s(regex, string)
   @text.gsub!(regex, string)
end

s /my/, 'mine'
s /\sis\s/, ' be '
s /y\s/, 'ye '
s /t\s/, 'te '
s /t\,/, 'te,'
s /t\./, 'te.'

puts @text 
```

# mysql - 如何按 DATE 在 MySQL GROUP BY 中返回第一条记录？

> ID：13556557
> 
> 赞同：1
> 
> 时间：2012-11-25T23:09:35.643
> 
> 标签：mysql, sql

我在表中有 30 条标题相同但 ID 和日期不同的记录。如何在查询中按日期返回最新的？

该表如下所示：

```
Id - Title - Date
-----------------
1 - africa - 2012-11-27
2 - africa - 2012-11-26
3 - africa - 2012-11-25 
```

我需要一个返回 ID 为 3 的记录的查询，即该日期最近的记录。到目前为止，我使用 GROUP BY 所尝试的只是返回 ID 为 1 的记录。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T23:11:56.590

您想获得第一条记录，但那不是*最近*的. 子查询背后的想法是，它获取每个标题的第一个日期，并将其与自身连接起来，前提是它与标题和日期匹配。

```
SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT  title, MIN(DATE) minDate
            FROM tableName
            GROUP BY title
        ) b ON a.title = b.title AND
                a.date = b.maxDate 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-25T23:11:57.907

你想要[分组最大值](http://dev.mysql.com/doc/en/example-maximum-column-group-row.html)：

```
SELECT * FROM my_table NATURAL JOIN (
  SELECT   Title, MAX(Date) Date
  FROM     my_table
  GROUP BY Title
) t 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/52a73/1/0)上查看。

如果你用最高的而不是最新的来定义“*最近*的” ：`id``Date`

```
SELECT * FROM my_table NATURAL JOIN (
  SELECT   Title, MAX(id) id
  FROM     my_table
  GROUP BY Title
) t 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/52a73/2/0)上查看。

# c# - 是否可以保留 C# 列表中的先前值

> ID：13556559
> 
> 赞同：0
> 
> 时间：2012-11-25T23:09:57.660
> 
> 标签：c#, list

这是我的示例代码：

```
private void button1_Click(object sender, EventArgs e)
    {
        listBox1.Items.Clear();
        foreach (var i in numbers())
        {
            listBox1.Items.Add(i);
        }
    }

    private List<int> numbers()
    {
        List<int> counts = new List<int>();
        for (int i = 1; i <= 5; i++)
        {
            counts.Add(i);
        }
        return counts;
    } 
```

我想知道是否可以不覆盖并保留 a 中的先前值`List<>`。在我的示例中，如果我单击该按钮，它将在列表框中填充 1、2、3、4、5，当我再次单击该按钮时，我期望输出 1、2、3、4、5、1、2， 3,4,5 这个值是我对我的期望我`List<>`怎么可能做到这一点？顺便说一句，那里的列表框仅用于显示目的。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:11:59.017

您只需要删除`listBox1.Items.Clear();`因此。

除此之外，您可以使用`Enumerable.Concat`附加项目：

```
var num1 = numbers();
var num2 = numbers();
foreach(var num in num1.Concat(num2))
{
    //  ...
} 
```

或者可能`Enumerable.Range`从一开始就使用，假设您总是想添加相同的 5 个项目：

```
int currentCount = listBox1.Items.Count;
int groupSize = 5;
var allItems = Enumerable.Range(0, currentCount + groupSize)
                         .Select(i => 1 + i % groupSize);
foreach(var item in allItems)
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:15:12.227

在类级别声明 numbers() 方法之外的计数。每次调用此方法都会将 1,2,3,4,5 添加到列表中。

```
private List<int> _counts = new List<int>();

private void button1_Click(object sender, EventArgs e)
{
    listBox1.Items.Clear();
    foreach (var i in numbers())
    {
        listBox1.Items.Add(i);
    }
}

private List<int> numbers()
{
    for (int i = 1; i <= 5; i++)
    {
        _counts.Add(i);
    }
    return counts;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T23:15:45.033

使用`List<int> counts = new List<int>();`，您可以创建一个新的空列表。每次调用`numbers()`.

如果我正确理解您的问题，您希望`numbers()`将这五个数字添加到现有列表中，因此每次调用`numbers()`.

为了实现这一点，不要`List<int>`在每次调用时创建一个新的`numbers()`作为结果值返回的；而是为该列表创建一个私有字段，并在每次调用时对其进行修改`numbers()`：

```
private List<int> counts = new List<int>();

private List<int> numbers()
{
    for (int i = 1; i <= 5; i++)
    {
        counts.Add(i);
    }
    return counts;
} 
```

请注意，它`numbers()`仍然会返回列表，但它不是新列表；每次都是相同的列表实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-25T23:11:34.973

`Clear`删除列表中的所有项目。如果您只是想将新列表中的所有项目附加到旧列表中，请使用[`AddRange`](http://msdn.microsoft.com/en-us/library/z018s5az.aspx)：

```
 listBox1.Items.AddRange(numbers()); 
```

# c - C中的小写到大写和大写到小写

> ID：13556561
> 
> 赞同：1
> 
> 时间：2012-11-25T23:10:17.207
> 
> 标签：c, uppercase, lowercase

有人会帮我处理这段代码吗？编写主题中需要做的函数。可以吗？我还需要计算所做更改的数量。如何实现这一点？

```
int change(char *path){

FILE *f = fopen(path, "r");
if(f==NULL){
    printf("Error...");
    return -1;
}
int text, length;

    fscanf(f, "%s", &text);
    length = strlen(text);

 for(i = 0; i < length; ++i){
    if(islower(text[i]))
          {
          text[i] = toupper(text[i]);
          }
    if(isupper(text[i]))
    {
        text[i] = toslower(text[i]);
    }
fprintf(f,"%s",text);
fclose(f); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:18:33.970

现在，您的代码将首先尝试将文本从小写更改为大写，然后如果成功将其更改回小写。我认为这不是您想要的，因为您现在有两个案例，要么从低到高再回到低，要么根本没有变化。

为了跟踪更改，我们添加了一个变量“更改”，我们将其初始化为零。

相反，如果您想将字符更改为大写，如果它是小写，如果它是大写则改写为小写，如下所示：

```
if(islower(text[i])) {
    text[i] = toupper(text[i]);
    changes++;
} else if(isupper(text[i])) { 
    text[i] = tolower(text[i]);
    changes++;
} 
```

还有一个拼写错误， toslower(text[i]) 但我认为你的意思是 tolower(text[i])

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:12:31.980

要计算更改的数量，只需创建一个变量 ( `int count = 0`) 并随着每次更改 ( `count++`) 递增它。

```
int change(char *path){

    FILE *f = fopen(path, "r");

    if(f==NULL){
        printf("Error...");
        return -1;
    }

    int text, length;
    int count = 0;

    fscanf(f, "%s", &text);
    length = strlen(text);

    for(i = 0; i < length; ++i){
        if(islower(text[i]))
        {
            text[i] = toupper(text[i]);
            count++;
        }
        if(isupper(text[i]))
        {
            text[i] = tolower(text[i]);
            count++;

        }
    }

    fprintf(f,"%s",text);
    fclose(f);
 } 
```

# cocoa-touch - UIScrollView、UIButton 与 UIControl 以及触摸事件

> ID：13556564
> 
> 赞同：2
> 
> 时间：2012-11-25T23:10:39.207
> 
> 标签：cocoa-touch, uiscrollview, uibutton, ios6, uicontrol

我有一个`UIScrollView`包含一个`UIButton`和一个[渐变按钮](https://github.com/nverinaud/NVUIGradientButton)，它是一个`UIControl`子类。渐变按钮根据用户是否点击它（表示突出显示）以不同的方式绘制。

该按钮在滚动视图内有规律地表现，而渐变按钮则没有：每当我点击该按钮时，它会立即重绘以表明它已被突出显示。但是，渐变按钮不会立即响应。只有当我按住水龙头半秒钟左右时，它才会重绘。

应该注意的是，在滚动视图之外，渐变按钮的行为与预期相同。

这似乎与 a`UIScrollView`在转发事件之前等待一段时间以决定是否应该滚动的事实有关。

我的问题是 - 有什么`UIButton`不同？如何在渐变按钮中模仿这种行为？或者，也许是它的特殊待遇`UIScrollView`？

**编辑：**问题似乎与绘图有关。触摸事件被正确调用，但不是两次调用`drawRect:`我只得到一个。强制 runloop 处理事件以及调用`[CATransacation flush]`会导致进行两次调用`drawRect:`，但没有可见的变化。

# c++ - 克隆向量时出现奇怪的数据

> ID：13556566
> 
> 赞同：1
> 
> 时间：2012-11-25T23:10:55.323
> 
> 标签：c++, vector

我有一个 Matrix 类，我重叠了基本操作

```
template<class T>
Matrix<T>::Matrix(unsigned rows, unsigned cols) :
        rows_(rows), cols_(cols) {
    index = 0;
    data_.reserve(rows * cols);
}
template<class T>
Matrix<T> Matrix<T>::operator=(const Matrix<T>& m) {

    rows_ = m.rows();
    cols_ = m.cols();
    index = 0;

    data_ =  m.data_;
    return *this;
} 
```

但是当我使用等号运算符时，我得到了奇怪的值：

```
Matrix<double> a(5, 5);
Matrix<double> b(2, 2);
a << 5, 2, 4, 5, 6, 1, 3, 1, 2, 5, 2, 5, 2, 7, 2, 9, 2, 1, 0.1, 0.43, 1, 0, 0, 0, 1;
a.print("a");
b = a;
b.print("B"); 
```

输出：

```
a
5   2   4   5   6   
1   3   1   2   5   
2   5   2   7   2   
9   2   1   0.1 0.43    
1   0   0   0   1   
B
0   0   0   0   0   
2.42092e-322    4.94066e-324    4.94066e-324    0   3.26083e-322    
0   6.66322e-319    0   0   0   
0   0   0   0   0   
0   0   0   0   0 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:15:55.640

看起来好像你打算使用`resize()`而不是`reserve()`：前者实际上改变了后者的大小，`std::vector<double>`而后者只是安排了足够的空间存在，但它没有在里面放置任何对象，也没有复制内容。

# python - 用 Beautiful Soup 和 Python 解析元标记

> ID：13556567
> 
> 赞同：1
> 
> 时间：2012-11-25T23:11:00.860
> 
> 标签：python, beautifulsoup

我无法使用 Beautiful Soup 3 和 python 2.6 解析 HTML 页面。

HTML 内容是这样的：

```
content='<div class="egV2_EventReportCardLeftBlockShortWidth">
<span class="egV2_EventReportCardTitle">When</span>
<span class="egV2_EventReportCardBody">
<meta itemprop="startDate" content="2012-11-23T10:00:00.0000000">
<span class='egV2_archivedDateEnded'>STARTS</span>Fri 23 Nov,10:00AM<br/>
<meta itemprop="endDate" content="2012-12-03T18:00:00.0000000">
<span class='egV2_archivedDateEnded'>ENDS</span>Mon 03 Dec,6:00PM</span>
<span class="egV2_EventReportCardBody"></span>
<div class="egV2_div_cal" onclick=" showExportEvent()">
<div class="egV2_div_cal_outerFix">
<div class="egV2_div_cal_InnerAdjust"> Cal </div>
</div></div></div>' 
```

我想将字符串 'Fri 23 Nov,10:00AM' 从中间取出到一个变量中，用于连接并发送回 PHP 页面。

要阅读此内容，我使用以下代码：（上面的内容来自阅读的 html 页面（http://everguide.com.au/melbourne/event/2012-nov-23/life-with-bird-spring -仓库销售/)

```
import urllib2
req = urllib2.Request(URL)
response = urllib2.urlopen(req)
html = response.read()
from BeautifulSoup import BeautifulSoup
soup = BeautifulSoup(html.decode('utf-8'))
soup.prettify()
import re
for node in soup.findAll(itemprop="name"):
    n = ''.join(node.findAll(text=True)) 
for node in soup.findAll("div", { "class" : "egV2_EventReportCardLeftBlockShortWidth" }):
    d = ''.join(node.findAll(text=True))
print n,"|", d 
```

返回：

```
[(ssh user)]# python testscrape.py

LIFE with BIRD Spring Warehouse Sale | 
When
<span class="egV2_EventReportCardDateTitle">STARTS</span>
STARTSFri 23 Nov,10:00AMENDSMon 03 Dec,6:00PM
<span class="egV2_EventReportCardDateTitle">ENDS</span>

 Cal 

[(ssh user)]# 
```

（它包括所有这些换行符等）。

所以你可以在最后看到，我将这两个剥离的字符串组合成一个打印输出，中间有一个分隔符，PHP 可以将字符串读回一个，然后将其分开。

问题是 - python 代码可以读取该页面并存储文本，但它包括所有那些让 PHP 应用程序混淆的垃圾和标签等。

我真的只想退货：

```
Fri 23 Nov,10:00AM 
```

是因为我使用 findAll(text=True) 方法吗？

如何向下钻取并仅获取该 div 中的文本 - 而不是 span 标签？

任何帮助将不胜感激，谢谢。

里克-墨尔本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:32:25.837

为什么不尝试类似的东西

```
In [95]: soup = BeautifulSoup(content)

In [96]: soup.find("span", {"class": "egV2_archivedDateEnded"})
Out[96]: <span class="egV2_archivedDateEnded">STARTS</span>

In [97]: soup.find("span", {"class": "egV2_archivedDateEnded"}).next
Out[97]: u'STARTS'

In [98]: soup.find("span", {"class": "egV2_archivedDateEnded"}).next.next
Out[98]: u'Fri 23 Nov,10:00AM' 
```

甚至

```
In [99]: soup.find("span", {"class": "egV2_archivedDateEnded"}).nextSibling
Out[99]: u'Fri 23 Nov,10:00AM' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-23T02:38:06.680

如果您只是想提取一个很容易用特定属性识别的单个标签，pyparsing 使这非常简单（我会使用它的 ISO8601 时间字符串值跟踪元标签）：

```
from pyparsing import makeHTMLTags,withAttribute

meta = makeHTMLTags('meta')[0]
# only want matching <meta> tags if they have the attribute itemprop="startDate"
meta.setParseAction(withAttribute(itemprop="startDate"))

# scanString is a generator that yields (tokens,startloc,endloc) triples, we just 
# want the tokens
firstmatch = next(meta.scanString(content))[0] 
```

现在转换为 datetime 对象，它可以按您喜欢的方式进行格式化、写入数据库、用于计算经过的时间等：

```
from datetime import datetime
dt = datetime.strptime(firstmatch.content[:19], "%Y-%m-%dT%H:%M:%S")

print (firstmatch.content)
print (dt) 
```

印刷：

```
2012-11-23T10:00:00.0000000
2012-11-23 10:00:00 
```

# .net - .NET RegEx 在任何双引号字符串中查找反斜杠

> ID：13556571
> 
> 赞同：1
> 
> 时间：2012-11-25T23:11:16.690
> 
> 标签：.net, regex, visual-studio

我想要一个正则表达式，它将匹配在我的代码中的双引号字符串中找到的任何反斜杠。例如，以下内容应全部匹配：

```
Dim testStr As String = "This is \ text"
Dim testStr2 As String = "\" 
```

我想使用 VS 中的 Find 功能进行解决方案范围的搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:13:30.740

这似乎有效：

```
\\~([^"]*("[^"]*"[^"]*)*$) 
```

`\\`匹配文字反斜杠。接下来的内容相当于[否定的前瞻](http://www.regular-expressions.info/lookaround.html)。`~(...)`断言，此时`...`无法匹配（在实际匹配中不包含更多内容）*。*我们使用它来确保反斜杠在字符串中。`"`如果它在一个字符串内，它和行尾之间会有奇数个。因此，如果反斜杠和行尾（用 表示）之间`[^"]*("[^"]*"[^"]*)*$`有偶数个，则匹配。`"``$`

这会导致多行字符串或转义为 的引号出现问题`\"`，但幸运的是在 VB.NET 中都不存在，因此您应该安全地使用此解决方案。

请注意，这**不是**.NET 正则表达式。Visual Studio 有[自己相当奇怪的正则表达式语法](http://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.80%29.aspx)。

# ios - 图像序列的反向动画？

> ID：13556575
> 
> 赞同：0
> 
> 时间：2012-11-25T23:11:32.367
> 
> 标签：ios, xcode

我有一个按钮，我想给它一些动画。一切正常，但我试图找出一种方法来反转动画的图像序列顺序，以便按钮似乎恢复它的先前状态。我在文档中找不到任何内容，似乎无法反转图像序列？如果无法颠倒顺序，我怎样才能给按钮一个不同的图像序列？我应该用一个新的阵列把它收起来吗？

代码：

```
 animatedButton = [[UIImageView alloc] initWithFrame:animButtonRect];
[animatedButton setImage:[UIImage imageNamed:@"messaging_00014.png"]];
[animatedButton setUserInteractionEnabled:YES];

animatedButton.animationImages = [NSArray arrayWithObjects:
                            [UIImage imageNamed:@"mov_00000.png"],
                            [UIImage imageNamed:@"mov_00001.png"],
                            [UIImage imageNamed:@"mov_00002.png"],
                            [UIImage imageNamed:@"mov_00003.png"],
                            [UIImage imageNamed:@"mov_00004.png"],
                            [UIImage imageNamed:@"mov_00005.png"],
                            [UIImage imageNamed:@"mov_00006.png"],
                            [UIImage imageNamed:@"mov_00007.png"],
                            [UIImage imageNamed:@"mov_00008.png"],
                            [UIImage imageNamed:@"mov_00009.png"],
                            [UIImage imageNamed:@"mov_00010.png"],
                            [UIImage imageNamed:@"mov_00011.png"],
                            [UIImage imageNamed:@"mov_00012.png"],
                            [UIImage imageNamed:@"mov_00013.png"],
                            [UIImage imageNamed:@"mov_00014.png"],
 nil];

 animatedButton.animationDuration = 1.0;
 animatedButton.animationRepeatCount = 1;
[self.view addSubview:animatedButton]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T02:21:04.447

I know this reply is a little late but I have been working on reverse animations and thought Id share a nice little piece of code.

Note: This code is for an animation sequence of 30 images with the image names being 4 digits long. eg. image_0001.jpg

```
-(void)animation
{
 NSMutableArray *animationArray = [[NSMutableArray alloc] init];

    int animationSizeTwo = 30;

    for (int i=0; i< animationSizeTwo; i++) {

        NSString *zeros = @"000";

        if ( i >= 1000 ) {

            zeros = @"";

        }
        else if ( i >= 100 ) {

            zeros = @"0";

        }
        else if ( i >= 10 ) {

            zeros = @"00";
        }
        NSString *animationNameTwo = [NSString stringWithFormat:@"(name)"];

        NSString *imageName = [NSString stringWithFormat:@"%@%@%d.jpg", animationNameTwo, zeros, i];

        [animationArrayTwo addObject:[UIImage imageNamed:imageName]];

    }

    _imageView.animationImages = animationArrayTwo;
    _imageView.animationDuration = 1;
    _imageView.animationRepeatCount = 1;
    _imageView.image = [_imageView.animationImages lastObject];
    [_imageView startAnimating];
} 
```

Then to reverse the animation your simply use this bit of code inplace of the image count:

int animationSizeTwo = 0;

```
 for (int i=30; i> animationSizeTwo; i--) { 
```

As I said it might be too late to answer your question but could always come in handy in the future, Best of luck

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-20T08:04:33.490

我知道这是一个老问题，但由于这里从来没有回答过，所以这是一个解决方案。只需将相同的图像反向放置并跳过序列中的第一个和最后一个。

```
animatedButton.animationImages = [NSArray arrayWithObjects:
                            [UIImage imageNamed:@"mov_00000.png"],
                            [UIImage imageNamed:@"mov_00001.png"],
                            [UIImage imageNamed:@"mov_00002.png"],
                            [UIImage imageNamed:@"mov_00003.png"],
                            [UIImage imageNamed:@"mov_00004.png"],
                            [UIImage imageNamed:@"mov_00005.png"],
                            [UIImage imageNamed:@"mov_00006.png"],
                            [UIImage imageNamed:@"mov_00007.png"],
                            [UIImage imageNamed:@"mov_00008.png"],
                            [UIImage imageNamed:@"mov_00009.png"],
                            [UIImage imageNamed:@"mov_00010.png"],
                            [UIImage imageNamed:@"mov_00011.png"],
                            [UIImage imageNamed:@"mov_00012.png"],
                            [UIImage imageNamed:@"mov_00013.png"],
                            [UIImage imageNamed:@"mov_00014.png"],
                            [UIImage imageNamed:@"mov_00013.png"],
                            [UIImage imageNamed:@"mov_00012.png"],
                            [UIImage imageNamed:@"mov_00011.png"],
                            [UIImage imageNamed:@"mov_00010.png"],
                            [UIImage imageNamed:@"mov_00009.png"],
                            [UIImage imageNamed:@"mov_00008.png"],
                            [UIImage imageNamed:@"mov_00007.png"],
                            [UIImage imageNamed:@"mov_00006.png"],
                            [UIImage imageNamed:@"mov_00005.png"],
                            [UIImage imageNamed:@"mov_00004.png"],
                            [UIImage imageNamed:@"mov_00003.png"],
                            [UIImage imageNamed:@"mov_00002.png"],
                            [UIImage imageNamed:@"mov_00001.png"],
 nil]; 
```

# html - HTML：fontawesome 图标出现两次

> ID：13556577
> 
> 赞同：2
> 
> 时间：2012-11-25T23:11:42.010
> 
> 标签：html, font-awesome

我正在尝试使用 HTML5 和 FontAwesome 制作网页。我的问题是：如果我包含一个 FontAwesome 图标，它会出现两次，并且两个副本都相互堆叠（见那里：[图片](http://s7.directupload.net/file/d/3086/jdd3e3ks_jpg.htm)）

我更改了一些 fontawesome.css，但在我认识到问题后，我再次从下载中复制了文件以重置我的所有更改：问题仍然存在。所以我的 .css 部分说：

```
[class^="icon-"]:before, [class*=" icon-"]:before {
  font-family: FontAwesome;
  font-weight: normal;
  font-style: normal;
  display: inline-block;
  text-decoration: inherit;
} 
```

我把它包括在标题中

```
<h3><i class="icon-star-empty"></i>&nbsp;Angebote</h3> 
```

不幸的是，我并没有真正看到问题所在。

我尝试删除 .css 中的“:before”（它到底有什么作用？），玩“display:”，添加“vertical-alignment”，因为星星有点在天空中......没有任何帮助。

有人遇到过类似的事情吗？该问题出现在 Firefox、Opera 和 IE 上。

最好的问候，安娜

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2020-07-27T22:21:38.760

如果您忘记`<i>`正确关闭标签，您可能会得到类似的行为 我有多个图标

```
<i class="fa fa-user-circle"> 
```

代替

```
<i class="fa fa-user-circle"></i> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T13:47:39.943

我自己也遇到了这个问题，我想出了我需要解决的问题。在 bootstrap.css 中删除

> ```
> .icon-star-empty {   background-position: -144px 0; } 
> ```

基本上css在两个地方，一次在bootstrap.css，一次在font-awesome.css，所以它显示了两次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T01:42:20.780

我可以进一步详细说明，但基本上这个问题不应该出现在 3.0（几周前发布）中。

这来自 Bootstrap 在其 sprites.less 中图标类的设置类。说明说要注释掉 sprites.less，但很多人都忽略了这一点。在新版本中，有解决此问题的替代方案。

另外，如果你想让 Font Awesome 的使用变得非常简单，你可以使用 Bootstrap CDN：[http ://www.bootstrapcdn.com/?v=01042013155511#tab_fontawesome](http://www.bootstrapcdn.com/?v=01042013155511#tab_fontawesome)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-30T17:02:22.947

只需这样做

```
.fa-heart:before{content: '';} 
```

# macos - 如何给一个平面包 (.pkg) 一个在不同计算机上看到的图标？

> ID：13556585
> 
> 赞同：4
> 
> 时间：2012-11-25T23:12:06.610
> 
> 标签：macos, installation, icons, package, packagemaker

我知道可以为 .pkg 文件提供一个图标，该图标可以在我的 Mac 上看到，但我想制作它，以便可能获得此软件包的每个人都能看到它。

我以前见过这个，所以我知道这是可能的，但是当打开一个确实有我想要的图标设置的 .pkg 时，我看不到任何指向图标的东西，所以我很难过。苹果对这种东西并不完全有帮助。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T02:40:56.570

文件的自定义图标位于`icns`-16455 资源中。您可以简单地复制并粘贴到 Finder 的信息窗口中以设置图标，或者您可以`.icns`使用 Rez 自动合并文件的过程，如下所示：

```
echo "read 'icns' (-16455) \"foo.icns\";" | Rez -o foo.pkg ; SetFile -a C foo.pkg 
```

请注意，在较新的 Xcode 版本中，Rez 和 SetFile 位于 Xcode 包中的`Contents/Developer/Tools`; 您还可以使用 xcrun 找到它们。

要分发带有完整图标的平面包，您需要使用包含其资源分支的工具对其进行压缩/编码，例如 Apple 的 tar、CPIO 或 Zip 实现（后两者可以通过 Archive Utility`ditto`或它在磁盘映像中。

# java - 在小程序中选择自定义颜色

> ID：13556586
> 
> 赞同：2
> 
> 时间：2012-11-25T23:12:12.367
> 
> 标签：java, swing, colors, applet, slider

我正在用java为类创建一个绘画程序。用户需要能够定义要使用的自定义颜色。我认为解决此问题的最佳方法是让用户单击一个图标，从而弹出一个带有滑块的选择窗口，以定义一种颜色的三个 RGB 值。解决此问题的最佳方法是什么？我发现`JSlider`但由于单击图标而无法弄清楚如何将其实现为弹出窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:14:26.350

使用`JColorChooser`. 有关详细信息，请参阅[如何使用颜色选择](http://docs.oracle.com/javase/tutorial/uiswing/components/colorchooser.html)器。

![颜色选择器](../Images/5fc4ac1ded462e3d2a4e436750d6b9a2.png)

# python - Python 无法识别 unicode

> ID：13556587
> 
> 赞同：3
> 
> 时间：2012-11-25T23:12:20.697
> 
> 标签：python, unicode

我正在尝试制作一个将日文片假名转换为罗马字（“シ”为“shi”）的脚本。这是我正在尝试的：

```
x = u''
x = raw_input('Enter katakana: ')
x = x.replace(u'\u30B7', u'shi') 
```

> 输入片假名：シ<br> UnicodeDecodeError: 'ascii' codec can't decode byte 0xe3 in position 0: ordinal not in range(128)

只要我的脚本中的 unicode 写为 u'\u30B7' 而不是 シ，它应该能够处理它，对吧？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-25T23:16:21.523

`raw_input`以字节编码形式返回输入的字符串，该形式因使用的终端而异。尝试首先将输入显式解码为 Unicode：

```
import sys
x = raw_input('Enter katakana: ').decode(sys.stdin.encoding) 
```

您得到的错误是由于替换试图`x`通过默认`ascii`编解码器天真地将字节编码转换为 Unicode。

# c++ - 在 Windows 平台上测量原生 C++ 的亚秒级经过时间

> ID：13556593
> 
> 赞同：2
> 
> 时间：2012-11-25T23:13:04.320
> 
> 标签：c++, cpu-usage, timing

什么是测量 Windows 平台上本机 C++ 代码的亚秒级经过时间的好方法（我正在使用 Windows Vista，Visual Studio 2010）

我试过使用

```
#include <ctime>

int main()
{    
    clock_t start = clock();
    ... some code
    clock_t end = clock();
    double cpu_time = static_cast<double>(end - start)/CLOCKS_PER_SEC;
} 
```

但`cpu_time`总是`0`。

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:18:01.773

您可以使用`QueryPerformanceFrequency`和`QueryPerformanceCounter`WinAPI 函数。[例子](https://stackoverflow.com/a/1739265/600135)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T02:27:01.913

您的代码全部有效且有效。如果您尝试为特定代码的执行计时，您应该按照 Xymotech 的建议通过循环运行它。主要原因是：

*   您的代码片段将执行得非常快。在某些情况下，执行计时器的开始、代码片段和结束时间相同。这将导致`start`保持与 相同的值`end`，导致 `cpu_time`等于零。

然而，还有一个额外的好处是能够计算多次迭代的平均执行时间

# android - 接收时来自类的 Android 意图

> ID：13556597
> 
> 赞同：2
> 
> 时间：2012-11-25T23:13:25.583
> 
> 标签：android, android-intent, android-activity

我有一个扩展 BroadCastReceiever 的类，并且 onReceive 方法如下：

```
public class Alarm extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        String message = intent.getStringExtra("message2");
        Toast.makeText(context, message, Toast.LENGTH_SHORT).show();
        Intent intent1 = new Intent(context, AlarmShow.class);
        context.startActivity(intent1);

    }
} 
```

但是它每次运行 onReceive 方法而不是在意图中启动活动时都会崩溃。

我几乎什么都试过了。

任何帮助，将不胜感激。

谢谢

编辑：LogCat 错误：

```
11-25 18:24:00.511: D/AndroidRuntime(2158): Shutting down VM
11-25 18:24:00.511: W/dalvikvm(2158): threadid=1: thread exiting with uncaught exception (group=0x40015560)
11-25 18:24:00.521: E/AndroidRuntime(2158): FATAL EXCEPTION: main
11-25 18:24:00.521: E/AndroidRuntime(2158): java.lang.RuntimeException: Unable to start receiver com.example.androidalarm.Alarm: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.app.ActivityThread.handleReceiver(ActivityThread.java:1805)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.app.ActivityThread.access$2400(ActivityThread.java:117)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:981)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.os.Looper.loop(Looper.java:123)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.app.ActivityThread.main(ActivityThread.java:3683)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at java.lang.reflect.Method.invokeNative(Native Method)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at java.lang.reflect.Method.invoke(Method.java:507)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at dalvik.system.NativeStart.main(Native Method)
11-25 18:24:00.521: E/AndroidRuntime(2158): Caused by: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.app.ContextImpl.startActivity(ContextImpl.java:621)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.content.ContextWrapper.startActivity(ContextWrapper.java:258)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.content.ContextWrapper.startActivity(ContextWrapper.java:258)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at com.example.androidalarm.Alarm.onReceive(Alarm.java:20)
11-25 18:24:00.521: E/AndroidRuntime(2158):     at android.app.ActivityThread.handleReceiver(ActivityThread.java:1794)
11-25 18:24:00.521: E/AndroidRuntime(2158):     ... 10 more
11-25 18:24:02.611: I/Process(2158): Sending signal. PID: 2158 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:24:07.920

测试消息不为空，否则您将遇到 nullPointerException。此外，如果您没有在活动中使用它，您需要：

```
intent.addFlag(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

否则你也会遇到崩溃。

# c# - 适用于 WinRT Windows 8 C# 的 SFTP 库

> ID：13556601
> 
> 赞同：0
> 
> 时间：2012-11-25T23:13:55.427
> 
> 标签：c#, windows-8, windows-runtime, windows-store-apps

我一直在我现有的应用程序中使用 Chilkat 进行 SFTP。下一个项目是 WinRT 前端。

是否有适用于 WinRT C# 的 SFTP 库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T05:55:26.133

在多次尝试为 WinRT 寻找 SFTP 库后，答案肯定是否定的，但很快。

搜索引擎没有找到任何库，目前 StackOverflow 上也没有其他答案。

Chilkat 已承诺在未来提供一个版本，请参阅：[sftp-c-library-for-winrt](http://www.chilkatforum.com/questions/1681/sftp-c-library-for-winrt)

# html - 如何在没有鼠标的情况下使我的按钮（超链接）可访问？(FF)

> ID：13556602
> 
> 赞同：0
> 
> 时间：2012-11-25T23:13:56.547
> 
> 标签：html, css, accessibility

**这是一个火狐问题**

我在超链接上有一个带有 tabindex 和 accesslink 属性的按钮，但我仍然无法使用 tab 键。

```
<a class="ENVnextButton nextBackBtn rightBtn buttonBig"  href="slide-02.html" id="beginCourse" accesskey="1" tabindex="1">Begin Course</a> 
```

这是我正在构建的模式。

[http://corfro.com/modal/](http://corfro.com/modal/)

我正在使用 jQuery UI Modal 拉入此页面： [http ://corfro.com/modal/test-layout.html](http://corfro.com/modal/test-layout.html)

如何在没有鼠标的情况下使此按钮可访问？

*在操作系统上使用 FF*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T18:23:30.843

有一个很棒的 JavaScript 插件，叫做[Mousetrap](https://github.com/ccampbell/mousetrap)，它可以让你将行为分配给自定义键盘快捷键。尝试将捕鼠器事件绑定到锚点的单击事件。

# c# - 查询 XML 的实体框架

> ID：13556604
> 
> 赞同：4
> 
> 时间：2012-11-25T23:14:00.637
> 
> 标签：c#, .net, entity-framework-4, sqlxml

我有一个问题。也许你们中的一位专家可以在这里提供帮助。我正在查询的表有 2 个 xml 列。我也需要对这些列中的 xml 数据执行查询（在我的高级搜索功能中）。问题是我正在使用实体框架，它不支持。即使我尝试执行“ObjectQuery.Execute”，它也会导致语法错误。那么我在这里有什么选择？

1.  修改表并为我需要查询的 XML 中的数据添加列，以便我可以使用实体框架执行操作？
2.  只是为了高级搜索使用 ODBC 并在我可以使用 SQLXml 的地方进行常规查询？这里的潜在威胁是什么[例如多个连接、太多连接、设计/架构师的可憎性等]？
3.  或者任何人都可以提出更好的解决方案吗？

谢谢，

阿里纳希德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T02:22:06.187

EF 将 SQL Server XML 类型列映射到字符串。所以对于这个定义：

```
CREATE TABLE [dbo].[XmlData](
[ID] [int] IDENTITY(1,1) NOT NULL,
[XmlTestColumn] [xml] NOT NULL
) 
```

您将拥有以下实体：

```
public partial class XmlData
{
    public int ID { get; set; }
    public string XmlTestColumn { get; set; }
} 
```

并且能够将字符串加载到 XmlDocument 等中。这是一种方法。

如果您希望针对 SQL Server 发出本机 XML 查询，则需要

1.  定义或选择合适的实体类型；
2.  `Database.SqlQuery`与您的 XML 查询一起使用：

    var query = context.Database.SqlQuery(@"SELECT it.Id, it.Name, it.SomeData, t2.someotherdata FROM Table1 as it CROSS APPLY ...");

`ObjectQuery`针对概念模型工作，不支持本机查询。

# listview - 如何去掉 ListView 的添加项动画？

> ID：13556605
> 
> 赞同：11
> 
> 时间：2012-11-25T23:14:11.470
> 
> 标签：listview, animation, windows-runtime

我有一个`ListView`，我编辑了它`ItemContainerStyle`以修改一些样式，但我不知道如何在添加项目时删除那个烦人的动画。

使用`ItemsControl`，当您添加一个新项目时，它会立即出现，没有任何动画。

使用`ListView`，该项目需要一段时间，然后它开始显示动画。

我只想删除它`add animation`，当我点击`Add item`它时，它会立即出现，没有额外的东西。

我认为它应该属于`ItemContainerStyle`但即使我注释掉了所有的视觉状态动画并且仍然存在。我错过了一些东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-26T05:57:41.807

这些动画称为过渡，它们是`ListViewStyle`. 要更改它，请右键单击`ListView`设计器中的控件并选择`Edit Template`> `Edit a Copy...`。这会将内置样式添加到您的 XAML。

您对样式的以下部分感兴趣：

```
<Setter Property="ItemContainerTransitions">
    <Setter.Value>
        <TransitionCollection>
            <AddDeleteThemeTransition/>
            <ContentThemeTransition/>
            <ReorderThemeTransition/>
            <EntranceThemeTransition IsStaggeringEnabled="False"/>
        </TransitionCollection>
    </Setter.Value>
</Setter> 
```

我不确定您到底不喜欢哪个动画，但请`AddDeleteThemeTransition`尝试`EntranceThemeTransition`从`TransitionCollection`. 它应该可以解决问题。

不要忘记确保将修改后的样式应用于所需的`ListView`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T05:53:40.477

它可能在默认的 ItemsPanel 中。

你可以尝试这样的事情：

```
<ListView.ItemsPanel>
    <ItemsPanelTemplate>
        <VirtualizingStackPanel>
            <VirtualizingStackPanel.ChildrenTransitions>
                <TransitionCollection/>
            </VirtualizingStackPanel.ChildrenTransitions>
        </VirtualizingStackPanel>
    </ItemsPanelTemplate>
</ListView.ItemsPanel> 
```

为什么你要反对设计语言的快速和流畅的东西的流畅部分？您是在尝试实现比模板更平淡的东西，还是计划添加自己的过渡？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-10-07T13:09:01.093

正如其中提到的评论之一，简单地添加它对我来说就是诀窍：

```
<ListView.ItemContainerTransitions> 
    <TransitionCollection/> 
</ListView.ItemContainerTransitions> 
```

不需要所有其他代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-15T16:30:31.550

感谢达米尔的回答，我就是这样做的。只需将其添加到您的**App.xaml**

```
<Application...>
    <Application.Resources>
        <ResourceDictionary>
            ...
            <Style TargetType="ListView">
                <Setter Property="ItemContainerTransitions">
                    <Setter.Value>
                        <TransitionCollection/>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Application.Resources>
</Application> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-12T14:28:27.447

这将起作用 -

```
listView.ItemContainerTransitions = null; 
```

您必须为该`ItemContainerTransitions`属性分配一个新的引用（或 null）。更改此属性已引用的集合中的值将不起作用。

这行不通——

```
listView.ItemContainerTransitions.Clear(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-19T07:48:46.983

除了建议的 ItemContainerTransitions 删除之外，还有一个您可能想要删除的附加动画。

在 ListViewItem 模板中有一个名为 ContentPresenterTranslateTransform 的变换动画，它将项目内容滑动到位。您可以从模板的故事板中删除该动画。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-10-14T11:15:17.603

在 UWP 中，我创建了以下代码来删除动画：

```
// Remove Add/Delete animations
TransitionCollection tc = _listView.ItemContainerTransitions;
for (int i = tc.Count - 1; i >= 0; i--) if (tc[i] is AddDeleteThemeTransition) tc.RemoveAt(i); 
```

# java - 如何在 Scala Seq[T] 或 Option[T] 中获取原始类型参数的实际类型？

> ID：13556609
> 
> 赞同：0
> 
> 时间：2012-11-25T23:14:35.067
> 
> 标签：java, scala, reflection

例如，如果我有 a `class NewClass(val a: Seq[String])`，我可以通过`classOf[NewClass].getDeclaredFields.head.getGenericType.asInstanceOf[java.lang.reflect.ParameterizedType].getActualTypeArguments.head.asInstanceOf[Class[_]]`它获取类型参数的实际类型 a `java.lang.String`。

但是，如果类型参数是原始类型（Java 中不允许，但 Scala 中允许），例如`class NewClass(val a: Seq[Int])`，使用相同的方法只会产生`java.lang.Object`. 有什么办法让我知道它实际上是 a`Int`而不是 general `java.lang.Object`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:40:06.383

你可以使用清单吗？

```
scala> class NewClass[T](val a: Seq[T])(implicit m: Manifest[T])
defined class NewClass

scala> class NewClass[T](val a: Seq[T])(implicit m: Manifest[T]) {
     |   def typeOfA = m.erasure
     | }
defined class NewClass

scala> val newClass = new NewClass(Seq(1, 2, 3))
newClass: NewClass[Int] = NewClass@494e1df7

scala> newClass.typeOfA
res17: java.lang.Class[_] = int 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T04:24:16.227

如果您定义如下所示的版本，它将适用于具有一个类型参数的所有类。

```
scala> def f[F[_],A](a: F[A])(implicit m:Manifest[A]) = m.erasure
f: [F[_], A](a: F[A])(implicit m: Manifest[A])java.lang.Class[_]

scala> f(Option(1))
res4: java.lang.Class[_] = int

scala> f(List(1,2,3))
res5: java.lang.Class[_] = int

scala> f(new NewClass(Seq(1, 2, 3)))
res6: java.lang.Class[_] = int

scala> f(new NewClass(Seq(1, 2, 3)).a)
res8: java.lang.Class[_] = int 
```

# c# - ASP.net c# - 重定向用户编辑和添加新的不同模式

> ID：13556616
> 
> 赞同：0
> 
> 时间：2012-11-25T23:15:55.673
> 
> 标签：c#, asp.net, sql

我有一个表格可以带回数据库中的客户列表。还有一个添加客户按钮来添加一个新客户和一个用户可以编辑现有客户的超链接。单击编辑链接时，我可以为该客户恢复正确的数据，但如果我进行更改并单击“更新”按钮，它不会编辑现有数据。另一个问题是重定向添加新客户时也会出现“更新”按钮（用户输入新客户的数据并单击“更新”）。是否可以为不同的操作（添加新或编辑）/查询引用不同的代码？这是我到目前为止所拥有的。感谢您的任何帮助。

```
<asp:Content ID="Content1" ContentPlaceHolderID="chpContent" runat="server">
<div>
    <h2>Customer Listing</h2>
    <br />
</div>
<p style="text-align:center">
    <asp:Button ID="btnCustomer" class="button" runat="server" Text="Add New Customer" onclick="btnCustomer_Click" />
</p>

<asp:ListView ID="lv" runat="server" 
    onselectedindexchanged="lv_SelectedIndexChanged">
<LayoutTemplate>
  <table width="110%" class="TableListing">
  <tbody>
    <thead>
    <th width="150">Customer Name</th>
      <th width="150">Email</th>
      <th width="150">City</th>
      <th width="40">State</th>
      <th width="110">Phone</th>
      <th width="80">Modify</th>
    </thead>
    <tr id="itemPlaceholder" runat="server"></tr>
     </tbody>
    </table>  

    <asp:DataPager ID="ItemDataPager" runat="server" PageSize="20">
        <Fields>
            <asp:NumericPagerField ButtonCount="5" />
        </Fields>
    </asp:DataPager>

</LayoutTemplate>

<ItemTemplate>
    <tr>
     <td><%# Eval ("LastName") %>, <%# Eval ("FirstName") %></td>
     <td><%# Eval ("Email") %></td>
     <td><%# Eval ("City") %></td>
     <td><%# Eval ("State") %></td>
     <td><%# Eval ("Phone") %></td>
     <td>
        <asp:HyperLink ID="lnkEdit" runat="server" NavigateUrl='<%# "CustomerEdit.aspx?ID=" + Eval("CustomerID") %>' Text="Edit" />
    </td>
    </tr>
</ItemTemplate> 
```

这是我的 CustomerEdit.aspx 页面：

```
public partial class CustomerEdit : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        this.Master.HighlightNavItem("Customers");

        int CustomerID = Int32.Parse(Request.QueryString["ID"]);

        //Declare the connection object
        SqlConnection Conn = new SqlConnection();
        Conn.ConnectionString = ConfigurationManager.ConnectionStrings["MyDatabase"].ConnectionString;

        //Connect to the db
        Conn.Open();

        //Define query
        string sql = "SELECT * FROM Customer where CustomerID=@CustomerID";

        //Declare the Command
        SqlCommand cmd = new SqlCommand(sql, Conn);

        //Add the parameters needed for the SQL query
        cmd.Parameters.AddWithValue("@CustomerID", CustomerID);

        //Declare the DataReader
        SqlDataReader dr = null;

        //Fill the DataReader
        dr = cmd.ExecuteReader();

        //Get the data
        if (dr.Read() == false)
            {
                //No Records
                dr.Close();
                Conn.Close();
                return;
            }

    txtFirstName.Text = dr["FirstName"].ToString();
    txtLastName.Text = dr["LastName"].ToString();
    txtEmail1.Text = dr["Email"].ToString();
    txtEmail2.Text = dr["Email"].ToString();
    txtPassword1.Text = dr["Password"].ToString();
    txtPassword2.Text = dr["Password"].ToString();
    txtAddress1.Text = dr["Address1"].ToString();
    txtAddress2.Text = dr["Address2"].ToString();
    txtCity.Text = dr["City"].ToString();
    txtState.Text = dr["State"].ToString();
    txtZip.Text = dr["Zip"].ToString();
    txtPhone.Text = dr["Phone"].ToString();
    txtFax.Text = dr["Fax"].ToString();

    dr.Close();
    Conn.Close();

    }

    protected void btnCancel_Click1(object sender, EventArgs e)
    {
        Response.Redirect("Customers.aspx");
    }

    protected void btnUpdate_Click(object sender, EventArgs e)
    {

        int CustomerID = Int32.Parse(Request.QueryString["ID"]);

        //Declare the connection object
        SqlConnection Conn = new SqlConnection();
        Conn.ConnectionString = ConfigurationManager.ConnectionStrings["MyDatabase"].ConnectionString;

        //Connect to the db
        Conn.Open();

        //Define query
        string sql = "UPDATE Customer SET Fax=@Fax Where CustomerID=@CustomerID";

        //Declare the Command
        SqlCommand cmd = new SqlCommand(sql, Conn);

        //Add the parameters needed for the SQL query
        cmd.Parameters.AddWithValue("@FirstName", txtFirstName.Text);
        cmd.Parameters.AddWithValue("@LastName", txtLastName.Text);
        cmd.Parameters.AddWithValue("@Email", txtEmail1.Text);
        cmd.Parameters.AddWithValue("@Password", txtPassword1.Text);
        cmd.Parameters.AddWithValue("@Address1", txtAddress1.Text);
        cmd.Parameters.AddWithValue("@Address2", txtAddress2.Text);
        cmd.Parameters.AddWithValue("@City", txtCity.Text);
        cmd.Parameters.AddWithValue("@State", txtState.Text);
        cmd.Parameters.AddWithValue("@Zip", txtZip.Text);
        cmd.Parameters.AddWithValue("@Phone", txtPhone.Text);
        cmd.Parameters.AddWithValue("@Fax", txtFax.Text);

        //Execute the query
        int NumRows = 0;
        NumRows = cmd.ExecuteNonQuery();

        Conn.Close();

        lblUpdate.Text = "Updated " + NumRows.ToString() + " record";

    }

} 
```

}

以及重定向用户的Customers.aspx.cs 页面。

```
 public partial class Customers : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {      
          this.Master.HighlightNavItem("Customers");

        //Declare the connection object
        SqlConnection Conn = new SqlConnection();
        Conn.ConnectionString = ConfigurationManager.ConnectionStrings["MyDatabase"].ConnectionString;

        //Connect to the db
        Conn.Open();

        //Define query
        string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer";

        //Declare a SQL Adapter
        SqlDataAdapter da = new SqlDataAdapter(sql, Conn);

        //Declare a DataTable
        DataTable dt = new DataTable();

        //Populate the DataTable
        da.Fill(dt);

        //Bind the Listview
        lv.DataSource = dt;
        lv.DataBind();

        dt.Dispose();
        da.Dispose();
        Conn.Close();

    }

            protected void btnCustomer_Click(object sender, EventArgs e)
         {
              Response.Redirect("CustomerEdit.aspx");                

          }

            protected void lv_SelectedIndexChanged(object sender, EventArgs e)
            {
                Response.Redirect("CustomerEdit.aspx");
            }

}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:35:14.920

更新不起作用，因为您覆盖了 PageLoad 上的数据。使用`IsPostBack`来避免这种情况：

```
protected void Page_Load(object sender, EventArgs e)
{
    this.Master.HighlightNavItem("Customers");

    if(!IsPostBack)
    {
        int CustomerID = Int32.Parse(Request.QueryString["ID"]);

        //Declare the connection object
        SqlConnection Conn = new SqlConnection();
        Conn.ConnectionString = ConfigurationManager.ConnectionStrings["MyDatabase"].ConnectionString;

        //Connect to the db
        Conn.Open();

        //Define query
        string sql = "SELECT * FROM Customer where CustomerID=@CustomerID";

        //Declare the Command
        SqlCommand cmd = new SqlCommand(sql, Conn);

        //Add the parameters needed for the SQL query
        cmd.Parameters.AddWithValue("@CustomerID", CustomerID);

        //Declare the DataReader
        SqlDataReader dr = null;

        //Fill the DataReader
        dr = cmd.ExecuteReader();

        //Get the data
        if (dr.Read() == false)
            {
                //No Records
                dr.Close();
                Conn.Close();
                return;
            }

        txtFirstName.Text = dr["FirstName"].ToString();
        txtLastName.Text = dr["LastName"].ToString();
        txtEmail1.Text = dr["Email"].ToString();
        txtEmail2.Text = dr["Email"].ToString();
        txtPassword1.Text = dr["Password"].ToString();
        txtPassword2.Text = dr["Password"].ToString();
        txtAddress1.Text = dr["Address1"].ToString();
        txtAddress2.Text = dr["Address2"].ToString();
        txtCity.Text = dr["City"].ToString();
        txtState.Text = dr["State"].ToString();
        txtZip.Text = dr["Zip"].ToString();
        txtPhone.Text = dr["Phone"].ToString();
        txtFax.Text = dr["Fax"].ToString();

        dr.Close();
        Conn.Close();
    }

} 
```

# r - 在 ggplot2 中的数据点处绘制带有黑点的粗线

> ID：13556617
> 
> 赞同：1
> 
> 时间：2012-11-25T23:16:16.900
> 
> 标签：r, ggplot2, appearance

我想绘制一条路径并显示数据点的位置。

[使用 ggplot2](https://stackoverflow.com/questions/8592585/combine-points-with-lines-with-ggplot2) 将点与线结合起来，`geom_point() + geom_line()`但我不喜欢这些点更厚而且线条看起来不连续`- x - x ----- x ---`，因此我决定

### 创建我自己的虚线：

```
mya <- data.frame(a=1:20)

ggplot() +
  geom_path(data=mya, aes(x=a, y=a, colour=2, size=1)) +
  geom_point(data=mya, aes(x=a, y=a, colour=1, size=1)) +
  theme_bw() +
  theme(text=element_text(size=11)) 
```

![好线的例子](../Images/2586ee6ae0f58e38c516be34a764fabf.png)

我喜欢点和线的大小相同。我没有使用 alpha 通道，因为当我将文件包含在其他程序中时，我担心 alpha 通道会出现问题。

### 开放的问题：

*   R不应该创造那些传说
*   R可以计算“深色”本身吗？`darker(FF0000) = AA0000`
*   我怎样才能操纵线厚？该`size=`参数未按预期工作`R 2.15`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:29:52.747

美学可以在 ggplot 调用中设置或映射。

*   从数据映射 aes(...) 中定义的美学，并创建图例。
*   通过在 aes() 之外定义美学，也可以将其设置为单个值。

在您的情况下，您似乎想将大小设置为单个值。您还可以使用`scale_..._manual(values = ..., guide = 'none')`来禁止创建图例。这似乎是您想要的`colour`。

然后，您可以使用命名颜色，例如`lightblue`和`darkblue`（`?colors`有关详细信息，请参阅）

```
ggplot() +
 geom_line(data=mya, aes(x=a, y=a, colour='light'), size = 2) +
 geom_point(data=mya, aes(x=a, y=a, colour='dark'), size = 2) + 
 scale_colour_manual(values = setNames(c('darkblue','lightblue'), 
                                       c('dark','light')), guide = 'none') +
 theme_bw() 
```

![在此处输入图像描述](../Images/55ead18b3db017cf581e343b5a1d4d21.png)

# plupload - plupload 表单提交上的队列检查文件有问题

> ID：13556623
> 
> 赞同：3
> 
> 时间：2012-11-25T23:16:51.627
> 
> 标签：plupload

如果没有单击开始按钮进行文件上传，我在触发 uploader.start() 时遇到问题，我使用的是最新版本的 Plupload。这是完整的代码，我想找到在提交单击时上传的每个文件的临时名称，以便我可以转到服务器并使用参考 ID 重命名文件，这样可以轻松识别属于的文件。

```
 <html xmlns="http://www.w3.org/1999/xhtml">
    <head runat="server">
    <link href="Styles/jquery.plupload.queue.css" rel="stylesheet" type="text/css" />
    <script src="Script/jquery-1.8.2.js" type="text/javascript"></script>
    <script src="Script/FileUpload/plupload.full.js" type="text/javascript"></script>
    <script src="Script/FileUpload/jquery.plupload.queue.js" type="text/javascript"></script>
    <title>Test Page</title>
    <script type="text/javascript">
        $(document).ready(function () { 
          $("#Testloader").pluploadQueue({
              runtimes: 'flash',
              url: 'FileUpload.ashx',
              max_file_size: '100mb',
              urlstream_upload: true,
              chunk_size: '5MB',
              //unique_names: false,
              multiple_queues: true,

              filters: [
            { title: "Document files", extensions: "pdf,doc,docx,tiff" },
            { title: "Image files", extensions: "jpg,png" }
        ],
              // Flash settings
              flash_swf_url: 'Images/plupload.flash.swf',

              //                    // Silverlight settings
              //                    silverlight_xap_url: 'assets/resources/plupload.silverlight.xap',

              init: {
                  FileUploaded: function (up, file, info) {
                  },                 
                  FilesRemoved: function (up, files) {
                      plupload.each(files, function (file) {

                      });
                  }
              }

          });
      });
      $('form').submit(function (e) {
          alert("clicked me");
          var uploader = $("#Testloader").pluploadQueue();
          // Files in queue upload them first
          if (uploader.files.length > 0) {
              // When all files are uploaded submit form
              uploader.bind('StateChanged', function () {
                  if (uploader.files.length === (uploader.total.uploaded + uploader.total.failed)) {
                      // $('form')[0].submit();
                      alert("Form submitted");
                  }
              });
              uploader.start();

          } else {

              alert('You must queue at least one file.');

          }
          return false;
      });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div id="Testloader">      
    </div>
   <input type="submit" value="send" />
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:00:21.840

首先，您应该在 $(document).ready 中移动提交绑定，以确保 DOM 已准备好提交绑定。

我想您应该尝试依靠闭包来确保在 StateChanged 期间正确绑定“上传程序”（您也可以使用 var uploader = $("#Testloader").pluploadQueue();) 开始您的 StateChanged 处理程序：

```
 $('form').submit(function (e) {
      alert("clicked me");
      var uploader = $("#Testloader").pluploadQueue();
      // Files in queue upload them first
      if (uploader.files.length > 0) {
          // When all files are uploaded submit form
          uploader.bind('StateChanged', (function(closedUploader){return function () {
              if (closedUploader.files.length === (closedUploader.total.uploaded + closedUploader.total.failed)) {
                  // $('form')[0].submit();
                  alert("Form submitted");
              }
          };})(uploader)
          );
          uploader.start();

      } else {

          alert('You must queue at least one file.');

      }
      return false;
  }); 
```

希望这会有所帮助

# ruby-on-rails - Amazon S3 映像即将过期

> ID：13556624
> 
> 赞同：0
> 
> 时间：2012-11-25T23:16:53.077
> 
> 标签：ruby-on-rails, backbone.js, amazon-s3, amazon-web-services

Amazon S3 上的图像即将过期，因此当用户发帖时不会显示在页面上。

我正在使用 Backbone + Rails，所以我在页面加载时加载每个用户的图片 url。这存储在 Backbone 模型中，该模型位于用户的浏览器中。当用户发布新帖子时，我想在帖子旁边显示他/她的图像。当页面第一次加载时，这工作正常，但是在图像过期后，如果用户发帖，图像不会显示，并且我在控制台中收到错误，该图像所在的 URL 在 S3 上被禁止.

我在 S3 管理控制台中，但看不到在哪里可以将过期时间更改为更长，或者完全摆脱过期时间。任何人都知道如何做到这一点，或者知道这个问题的另一种解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T07:47:32.393

您如何将图像上传到 S3？上传图片时应该公开图片。

# sql - Group By 和 Have 子句描述

> ID：13556627
> 
> 赞同：1
> 
> 时间：2012-11-25T23:17:30.497
> 
> 标签：sql, ms-access, group-by, nested-queries

我试图弄清楚这段代码是怎么回事：

```
SELECT EMP_ID, SUM(INV_PRICE) AS TOTAL_SALES
FROM INVOICE
GROUP BY EMP_ID
HAVING SUM(INV_PRICE) <= AVG(INV_PRICE); 
```

我写了它，或者建议在不久前写它，现在我不确定它是否在做我最初想要它做的事情。

我想要什么：我有一张包含价格和员工的发票表。我想获得每个员工的总销售额，并将其与所有员工的平均总销售额进行比较。从那里我希望结果显示哪些员工的销售额低于平均水平。

我上面的内容正确吗？

**这是我运行 <= 平均时得到的结果：**

![在此处输入图像描述](../Images/879cafcd6f2f8bf4ceb6f518cbc2c63d.png)

**这是我运行>平均时得到的结果：**

![在此处输入图像描述](../Images/88854ff62b4d71c14153175cb36cbdc9.png)

我认为我主要关心的是确保它正在计算正确的平均值。这是每个员工总和的平均值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:25:59.200

我上面的内容正确吗？

不，您的查询可能没有返回任何记录（只有一次销售的记录）。sum(inv_price) 在大多数情况下大于或等于任何给定组的 avg(inv_price)。

您想预先计算另一个查询中的平均值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T23:30:47.973

你想要的是这样的：

```
SELECT EMP_ID, SUM(INV_PRICE) AS TOTAL_SALES
FROM INVOICE
GROUP BY EMP_ID
HAVING SUM(INV_PRICE) <= (
    SELECT AVG(INV_SUM)
    FROM (
        SELECT SUM(INV_PRICE) AS INV_SUM
        FROM INVOICE
        GROUP BY EMP_ID) x) ; 
```

此处计算的平均值是针对*所有*员工的，而您是针对每个组计算的，这是没有意义的：总和不能超过任何给定组的平均值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T23:35:14.970

不，这不对。将为您提供员工的`SUM(INV_PRICE)`总销售额，但`AVG(INV_PRICE)`将为您提供每位员工的平均销售额，而不是他们总销售额的平均值（对于所有员工）。

试试这个，你想要为所有员工计算总销售额的平均值——即使是那些根本没有销售额的员工：

```
SELECT EMP_ID, SUM(INV_PRICE) AS TOTAL_SALES
FROM INVOICE
GROUP BY EMP_ID
HAVING SUM(INV_PRICE) <= 
         ( SELECT SUM(INV_PRICE) FROM INVOICE )
       / ( SELECT COUNT(*) FROM EMPLOYEE )
  ; 
```

或者如果你想要所有有销售的员工的平均值：

```
SELECT EMP_ID, SUM(INV_PRICE) AS TOTAL_SALES
FROM INVOICE
GROUP BY EMP_ID
HAVING SUM(INV_PRICE) <= 
         ( SELECT SUM(INV_PRICE) / COUNT(DISTINCT EMP_ID) 
           FROM INVOICE )
  ; 
```

跳过那个，Access 没有`COUNT(DISTINCT )`：

```
SELECT EMP_ID, SUM(INV_PRICE) AS TOTAL_SALES
FROM INVOICE
GROUP BY EMP_ID
HAVING SUM(INV_PRICE) <=
         ( SELECT AVG(TOTAL_SALES)
           FROM
             ( SELECT SUM(INV_PRICE) AS TOTAL_SALES
               FROM INVOICE
               GROUP BY EMP_ID 
             ) tmp
         ) ; 
```

# sql - 带有可选参数 SQL 的 IN 子句

> ID：13556628
> 
> 赞同：0
> 
> 时间：2012-11-25T23:17:39.290
> 
> 标签：sql, stored-procedures

我有一个存储过程，它根据 2 个输入参数返回一组数据。其中一个参数是可选的，所以我正在使用

```
WHERE 
(tbl_Process.ProjectID = @ProjectID)
AND 
(tbl_AnalysisLookup.AnalysisCodeID = 7)
AND
(tbl_ProcessSubStep.ProcessID = ISNULL(@ProcessID,tbl_ProcessSubStep.ProcessID)) 
```

@ProcessID 是可选参数，因此用户可能/可能不提供它。现在我需要更改我的存储过程以适应多个 ProcessId，即用户现在可以选择多个 ProcessId、Single ProcessID 或 No ProcessID 的列表，并且存储过程应该处理所有这些情况。除非绝对需要，否则在不使用动态查询的情况下实现此目的的最佳方法是什么。 **简而言之，我希望我的存储过程能够处理具有多个值的可选参数（WHERE IN Clause）**。下面提供了我从中获得的网页的解决方案和相关链接。这是一篇非常好的文章，将帮助您根据您的要求选择正确的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:26:07.993

我终于想出了如何实现这一目标。有几种方法可以做到这一点，我现在使用的是一个函数，用于根据分隔符拆分 ProcessID 字符串，然后将它们插入表中。然后在我的存储过程中使用该表。这是代码和网页链接。

**[http://www.codeproject.com/Articles/58780/Techniques-for-In-Clause-and-SQL-Server](http://www.codeproject.com/Articles/58780/Techniques-for-In-Clause-and-SQL-Server)**

```
CREATE FUNCTION [dbo].[ufnDelimitedBigIntToTable]
(
@List varchar(max), @Delimiter varchar(10)
)
RETURNS @Ids TABLE
(Id bigint) AS
BEGIN
DECLARE @list1 VARCHAR(MAX), @Pos INT, @rList VARCHAR(MAX)
SET @List = LTRIM(RTRIM(@List)) + @Delimiter
SET @pos = CHARINDEX(@Delimiter, @List, 1)
WHILE @pos > 0
    BEGIN
    SET @list1 = LTRIM(RTRIM(LEFT(@List, @pos - 1)))
    IF @list1 <> ''
        INSERT INTO @Ids(Id) VALUES (CAST(@list1 AS bigint))
    SET @List = SUBSTRING(@List, @pos+1, LEN(@List))
    SET @pos = CHARINDEX(@Delimiter, @list, 1)
END
RETURN 
END 
```

完成后，表函数可以在查询中使用：

```
 Collapse | Copy Code
CREATE PROCEDURE [dbo].[GetUsingDelimitedFunctionTable]
@Ids varchar(max)
AS
BEGIN
SET NOCOUNT ON
SELECT s.Id,s.SomeString 
FROM SomeString s (NOLOCK)
WHERE EXISTS ( SELECT *
               FROM ufnDelimitedBigIntToTable(@Ids,',') Ids
               WHERE s.Id = Ids.id )
END 
```

Link 还提供了更多实现此目的的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:51:48.073

您没有在问题中指定您的数据库产品，但我将从*@Pararemter*命名样式中猜测您正在使用 SQL Server。

除了将空输入解释为“全部”的特殊要求外，这是对[*SQL 中的数组*](http://www.sommarskog.se/arrays-in-sql.html)问题的重述，由 Erland Sommarskog 彻底探索。阅读他关于该主题的所有文章，以对您可以使用的所有技术进行很好的分析。

在这里，我将解释如何使用表值参数来解决您的问题。

一起执行以下脚本，以幂等方式设置测试环境。

### 创建示例解决方案

首先创建一个新的空测试数据库`StackOverFlow13556628`：

```
USE master;
GO

IF DB_ID('StackOverFlow13556628') IS NOT NULL
BEGIN
  ALTER DATABASE StackOverFlow13556628 SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
  DROP DATABASE StackOverFlow13556628;
END;
GO

CREATE DATABASE StackOverFlow13556628;
GO

USE StackOverFlow13556628;
GO 
```

接下来，创建一个`PrinciapalList`包含一列的用户定义表类型`principal_id`。此类型包含用于查询系统表的输入值`sys.database_principals`。

```
CREATE TYPE PrincipalList AS TABLE (
  principal_id INT NOT NULL PRIMARY KEY
);
GO 
```

之后，创建`GetPrincipals`以`PrincipalList`表值参数为输入的存储过程，并从`sys.database_principals`.

```
CREATE PROCEDURE GetPrincipals (
  @principal_ids PrincipalList READONLY
)
AS
BEGIN
  IF EXISTS(SELECT * FROM @principal_ids)
  BEGIN
    SELECT *
    FROM sys.database_principals
    WHERE principal_id IN (
      SELECT principal_id
      FROM @principal_ids
    );
  END
  ELSE
  BEGIN
    SELECT *
  FROM sys.database_principals;
  END;
END;
GO 
```

如果表值参数包含行，则该过程将返回`sys.database_principals`其中具有匹配`principal_id`值的所有行。如果表值参数为空，则返回所有行。

### 测试解决方案

您可以像这样查询多个主体：

```
DECLARE @principals PrincipalList;

INSERT INTO @principals (principal_id) VALUES (1);
INSERT INTO @principals (principal_id) VALUES (2); 
INSERT INTO @principals (principal_id) VALUES (3);

EXECUTE GetPrincipals
  @principal_ids = @principals;
GO 
```

结果：

```
principal_id    name
1   dbo
2   guest
3   INFORMATION_SCHEMA 
```

您可以像这样查询单个主体：

```
DECLARE @principals PrincipalList;

INSERT INTO @principals (principal_id) VALUES (1);

EXECUTE GetPrincipals
  @principal_ids = @principals;
GO 
```

结果：

```
principal_id    name
1   dbo 
```

您可以像这样查询所有主体：

```
EXECUTE GetPrincipals; 
```

结果：

```
principal_id    name
0   public
1   dbo
2   guest
3   INFORMATION_SCHEMA
4   sys
16384   db_owner
16385   db_accessadmin
16386   db_securityadmin
16387   db_ddladmin
16389   db_backupoperator
16390   db_datareader
16391   db_datawriter
16392   db_denydatareader
16393   db_denydatawriter 
```

### 评论

此解决方案效率低下，因为您总是必须从表值参数中读取两次。实际上，除非您的表值参数有数百万行，否则它可能不会成为主要瓶颈。

以这种方式使用空表值参数感觉不直观。一个更明显的设计可能只是有两个存储过程——一个返回所有行，一个只返回具有匹配 id 的行。由调用应用程序选择调用哪个应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:23:26.113

不是最好的，但一种方法是将双方转换为`"varchar"`并使用`"Like"`运算符进行比较。它不需要任何大的修改，只需将参数的数据类型更改为`"varchar"`. 类似于下面**的**代码：

```
'%[,]' + Convert(varchar(10), tbl_ProcessSubStep.ProcessID) + '[,]%' Like @ProcessIDs 
```

希望能帮助到你。

# jquery - 使用 dialog() 更新动态创建的输入

> ID：13556633
> 
> 赞同：2
> 
> 时间：2012-11-25T23:18:47.697
> 
> 标签：jquery, dynamic, clone, modal-dialog, jquery-ui-dialog

我通过克隆行动态地将行添加到表中。一个单元格有一个输入元素。克隆行时，输入元素的 ID 值更改为唯一，但所有输入都具有相同的类。我有一个单击函数分配给分配给打开 jQuery 模态对话框（）的输入元素的类。dialog() 有一个文本区域，用户可以在其中输入评论。
**当用户在对话框（）中单击“接受”时，我希望将对话框的 textarea 元素的值写入被单击的输入元素的值。**

这仅在单击第一个原始输入元素时有效。添加行并单击输入元素会打开 dialog() 但输入元素不会更新。

*确实会发生一种奇怪的行为......* 使用“添加行”按钮添加行后，如果更改原始行的输入元素，所有输入元素都会更改为该文本。（注意：我没有包含日期​​选择器代码）

它必须与 IE7 兼容。（我知道它是旧的！）

我正在使用以下 jquery 脚本：（jquery-1.8.2.js）和（jquery-ui-1.9.1.custom.min.js）

这里是简化的 HTML：

```
<form id="frmTask">
<div id="popupDialog" title="Enter your comments for this IDPM Task here.">
    <p>
<div>characters left: <span id="txt-length-left"></span></div>
<textarea cols="50" rows="30" name="CommentsDialog" id="CommentsDialog" class="txtComments"></textarea>
</p>
</div>
<table style="" id="tblInput" border="0" name="tblInput" cellspacing="0" cellpadding="0" width="600" summary="Formatting table for output display">
<thead>
<tr>
<th scope="col"><div width="24px">&nbsp;</div></th>
<th scope="col">Suspense Date</th>
<th scope="col">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tdTop">&nbsp;</td>
<td class="tdTop"><input name="SuspenseDate1" id="SuspenseDate1" value="" class="DatePick" /></td>
<td class="tdTop"><input cols="25" rows="1" name="Comments1" id="Comments1" class="popComments"></input></td>
</tr>
</tbody>
</table>
<button id="AddNew">Add Row</button>
</form> 
```

这是代码：

```
 // Copy/Clone the last row and append it to the TABLE ID referenced in the function call
    $("#AddNew").click(function() {
    addTableRow("#tblInput");
    }); 

    function addTableRow(table) {
                                                //$('input.DatePick').removeClass('hasDatepicker').datepicker();
    var tbody = $(table + ' tbody');
    var rows = tbody.find('tr').length;
    var newRow = tbody.find('tr:first').clone(true).appendTo(tbody);
    newRow.find(':input').val('').each(function() {
    var id = this.id
    if (id) {
    this.id = this.id.split('_')[0] + '_' + rows;
    }
    }).end().find('.DatePick').removeClass('hasDatepicker').datepicker();
    // set variable to the last row in the table    
    newRow = $(table + ' tr:last');
    // Remove the delete icon from the previous row before creating the new row.
    $('a.remove').remove();
    // insert a remove link in the last cell
    $('td:first-child', newRow).html('<a href="" class="remove" alt="Delete This Row" title="Delete This Row"><img src="/images/Delete_Icon_48x48.jpg" height="24px" width="24px" border="0"><\/a>');
    var addRow = $(this).parent().parent();
    return true;
    } 
```

这是模态对话框代码：

```
 var inputID;
    $('.popComments').on('click', function(event) {
    inputID = event.target.id;
    alert(event.target.id + ' <- event.target.id : inputID -> ' + inputID);          
    $("#popupDialog").data("id", inputID);
    var $stuff = "Comments1";
    $('#popupDialog').dialog('open');
    $('textarea.txtComments').text("");
    });          
    // This is the popUp dialog for entering user Comments
    $("#popupDialog").dialog({
    modal: true,
    autoOpen: false,
    width:"600",
    position:{ my: "top", at: "top", of: "#Comments1" },
    buttons: {
    'Cancel': function() {
    $(this).dialog('close');
    },
    'Accept': function() {
    var helpMe  = $("#popupDialog").data("id");
    var txtComments = $(this).find('textarea.txtComments').val();
    $('#frmTask input#' + helpMe).val(txtComments);
    $(this).dialog('close');
    }
    }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:27:51.493

Manic，我认为你在这里跳过了一些不必要的箍。

*   避免使用 id - 在复制表行时它们通常是不必要的，即使涉及复杂的事件处理也是如此。
*   在您的原始原型行中硬编码一个删除按钮并`display:none`在您的样式表中设置它的样式。

然后，javascript将简化如下：

```
$("#AddNew").on('click', function() {
    var tbody = $('#tblInput tbody');
    var newRow = tbody.find('tr').eq(0).clone(true).appendTo(tbody);
    newRow.find('input').val('').end().find('.DatePick').removeClass('hasDatepicker').datepicker();
    tbody.find('a.remove').hide().filter(":last").show();
}); 
```

您需要修改对话代码以在没有输入 ID 的情况下工作，但这应该不是问题。您只需要在打开对话框时保留对 javascript 中“活动”输入元素的引用，以便将文本放回正确的位置。这实际上比记住一个 id 然后使用它来重新发现 DOM 中的正确输入元素（这可能是您当前所做的）更简单、更经济。

如果您仍然对对话框等有疑问，请编辑您的问题以包含代码，我会看看它。

## 编辑：

下面是一些处理注释的代码，避免了输入字段 id 的需要：

```
var $$ = {}; //cache of reusable jQuery objects
$$.popComments = $('.popComments');
$$.popupDialog = $('#popupDialog');
$$.popupComments = $popupDialog.find('textarea.txtComments');
$$.activeInput = null;

$$.popComments.on('click', function() {
    $$.activeInput = $(this);
    $$.popupComments.empty();
    $$.popupDialog.dialog('open');
});
// This is the popUp dialog for entering user Comments
$$.popupDialog.dialog({
    modal: true,
    autoOpen: false,
    width: "600",
    position:{ my: "top", at: "top", of: "#Comments1" },
    buttons: {
        'Cancel': function() {
            $(this).dialog('close');
        },
        'Accept': function() {
            $$.activeInput.val( $$.popupComments.val() );
            $(this).dialog('close');
        }
    }
}); 
```

笔记：

*   未经测试。
*   每次需要处理 DOM 中的元素时，不重新发现它们对处理能力来说是经济的。缓存在这里有所帮助，并通过充当其自己的内部命名空间来`$$`避免阻塞主命名空间。`$.function(){...}`
*   大概对话框已经在工作，所以我没有检查`.dialog()`选项（除了“接受”功能）。

# mysql - MySQL初学者查询

> ID：13556636
> 
> 赞同：1
> 
> 时间：2012-11-25T23:18:53.603
> 
> 标签：mysql

我在找出查询时遇到了一些麻烦。我有 2 个表 COMPANY，其中包含一个公司 ID 列、comp_id 和一个名称列。第二个表 SOURCE 有一列是 comp_id，一列是公司销售的零件，parts。

如何编写查询以查找生产所有零件的公司的名称？我认为这使用了不存在的语句，但我不知道如何。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:22:46.137

```
Select name
from company, source
where company.comp_id=source.comp_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:23:38.413

尝试这个...

```
SELECT c.name from company join source s on (s.comp_id = c.comp_id) where parts = [:part_id]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T23:56:19.510

```
SELECT name, count(*) AS parts_count
FROM company, source
WHERE company.comp_id = source.comp_id
GROUP BY name
HAVING parts_count = (select count(*) from source) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T23:22:27.440

很简单和命令，假设一个部分是“875”

```
SELECT name FROM company WHERE comp_id IN(SELECT comp_id FROM parts
WHERE parts = 875) 
```

这允许您在不同的公司中拥有相同的部分

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-25T23:25:56.017

从公司中选择名称，source where Companies.comp_id=source.comp_id;

# java - 如何在 Java 桌面应用程序中拥有菜单（网站样式导航链接）

> ID：13556637
> 
> 赞同：10
> 
> 时间：2012-11-25T23:18:52.657
> 
> 标签：java, user-interface, menu

我正在使用 Netbeans，我想开发一个 Java 桌面应用程序。该应用程序应该以某种方式类似于一个网站，我的意思是我想在我的 Java 桌面应用程序中有一些菜单，通过单击这些菜单中的每一个，我应该能够访问一些具有不同内容的不同页面（比如拥有主菜单，报告菜单……）。任何想法都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T22:27:06.170

这是一个基于[JavaFX](http://www.oracle.com/technetwork/java/javafx/overview/index.html)的示例，它基于一组指向不同内容项的[超链接生成菜单。](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Hyperlink.html)这与许多网页的工作方式非常相似。该示例通过[css](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html)设置样式，类似于网页。

该示例使用 Java 代码创建场景内容，但您可以根据需要在 SceneBuilder 工具生成的 fxml 中构建布局并[定义](http://docs.oracle.com/javafx/2/get_started/fxml_tutorial.htm)内容[项](http://www.oracle.com/technetwork/java/javafx/tools/index.html)。

JavaFX 也有传统的应用程序[菜单栏](http://docs.oracle.com/javafx/2/ui_controls/menu_controls.htm)（本示例中未演示）。

*示例程序输出，点击了一些不同的链接：*

[![糖](../Images/b6156793a1d36fbc9258cba36dae91b6.png)](https://i.stack.imgur.com/mJbm5.png) [![咖啡](../Images/faadedbac14ce78cea21690df80880d0.png)](https://i.stack.imgur.com/kdAKv.png)

*示例代码：*

```
import javafx.application.Application;
import javafx.scene.*;
import javafx.scene.control.*;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.layout.*;
import javafx.stage.Stage;

/**
 * Displays content panes activated by a hyper-link based navigation bar
 */
public class HyperlinkedNavMenu extends Application {
    private LinkContent[] linkContent;

    private final StackPane content = new StackPane();

    public static void main(String[] args) {
        launch(args);
    }

    @Override
    public void start(Stage stage) {
        linkContent = createLinkContent();

        content.setPrefWidth(200);
        HBox.setHgrow(content, Priority.ALWAYS);

        stage.setTitle("Capello Pazzo");
        stage.setScene(new Scene(createLayout()));
        stage.show();
    }

    private Pane createLayout() {
        HBox layout = new HBox(
                10,
                createNavBar(), 
                content
        );

        layout.getStylesheets().add(
                getClass().getResource("nav.css").toExternalForm()
        );

        return layout;
    }

    private VBox createNavBar() {
        VBox nav = new VBox();
        nav.setMinWidth(100);
        nav.getStyleClass().add("navbar");

        for (int i = 0; i < linkContent.length; i++) {
            Hyperlink link = createLink(
                    linkContent[i].linkText, 
                    createContentNode(linkContent[i])
            );
            nav.getChildren().add(link);
            if (i == 0) {
                link.fire();
            }
        }

        return nav;
    }

    private Node createContentNode(LinkContent linkContent) {
        Label label = new Label(linkContent.contentText);
        label.setWrapText(true);

        VBox contentNode = new VBox(
                10,
                new ImageView(linkContent.image),
                label
        );
        contentNode.getStyleClass().add("contentnode");

        return contentNode;
    }

    private Hyperlink createLink(final String linkText, final Node contentNode) {
        Hyperlink link = new Hyperlink(linkText);
        link.setOnAction(t -> content.getChildren().setAll(
                contentNode
        ));

        return link;
    }

    private static class LinkContent {
        final String linkText, contentText;
        final Image image;

        LinkContent(String linkText, String contentText, String imageLoc) {
            this.linkText = linkText;
            this.contentText = contentText;
            this.image = new Image(imageLoc);
        }
    }

    // icon license:     http://creativecommons.org/licenses/by-nc-nd/3.0/
    // icon attribution: http://www.iconarchive.com/artist/archigraphs.html
    private LinkContent[] createLinkContent() {
        return new LinkContent[] {
                new LinkContent(
                        "Lorem",
                        "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
                        "http://icons.iconarchive.com/icons/archigraphs/tea-party/128/Sugar-Cubes-icon.png"
                ),
                new LinkContent(
                        "Vestibulum",
                        "Vestibulum a dui et massa laoreet vehicula.",
                        "http://icons.iconarchive.com/icons/archigraphs/tea-party/128/Tea-Cake-icon.png"
                ),
                new LinkContent(
                        "Donec",
                        "Donec sed euismod risus.",
                        "http://icons.iconarchive.com/icons/archigraphs/tea-party/128/Tea-Cup-icon.png"
                ),
                new LinkContent(
                        "Duis",
                        "Duis semper porttitor leo ac posuere.",
                        "http://icons.iconarchive.com/icons/archigraphs/tea-party/128/Tea-Pot-icon.png"
                )
        };
    }
} 
```

*示例 CSS：*

```
/** file: nav.css
 * place in same directory as HyperlinkedNavMenu.java and have your build system copy it
 * to the same location as HyperlinkedNavMenu.java.class */

.root {
    -fx-background-image: url("http://images.all-free-download.com/images/graphiclarge/linen_fabric_background_04_hd_picture_169825.jpg");
    -fx-padding: 15; 
    -fx-font-size: 15;
}

.navbar {
    -fx-background-color: burlywood, peachpuff; 
    -fx-background-radius: 10, 10; 
    -fx-background-insets: 0, 2; 
    -fx-font-style: italic; 
    -fx-padding: 10 15 15 10; 
}

.contentnode {
    -fx-background-color: aliceblue; 
    -fx-padding: 15 20 20 15;
    -fx-effect: dropshadow(gaussian, slategrey, 10, 0, 5, 5);  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-07T12:00:26.247

如果您使用的 IDE`Netbeans`提供了 IDE 的功能`menu bar`，您可以将其拖放到`menu`上面并添加菜单和菜单项。`menu item``menu bar``JFrame`

或者

您可以使用卡片布局在一个位置显示多个框架。

# java - gwt-google-apis 调用导致“无法调用未定义的方法‘newHttpRequest’”

> ID：13556641
> 
> 赞同：2
> 
> 时间：2012-11-25T23:19:53.753
> 
> 标签：java, gwt, google-plus

我正在使用 gwt-plus-v1-0.2-alpha API 来：

1.  允许谷歌登录
2.  获取已登录用户的信息

谷歌登录有效，但获取用户信息失败

```
Cannot call method 'newHttpRequest' of undefined 
```

错误。

以下是我的`GoogleApi`助手类：

```
public final class GoogleApi {
    private static final Plus plus = GWT.create(Plus.class);

    private final String clientId;

    private final ClientOAuth2Login oAuth2Login;
    private ClientGoogleApiRequestTransport requestTransport;

    /**
     * @param clientId
     *            This app's personal client ID assigned by the Google APIs
     *            Console (http://code.google.com/apis/console)
     */
    public GoogleApi(EventBus eventBus, String clientId) {
        this.clientId = clientId;
        requestTransport = new ClientGoogleApiRequestTransport();
        requestTransport.setApplicationName(MY_APP_NAME)
                .setApiAccessKey(MY_API_KEY);
        plus.initialize(eventBus, requestTransport);
        oAuth2Login = new ClientOAuth2Login(clientId);
        oAuth2Login.withScopes(PlusAuthScope.PLUS_ME);
    }

    public void login(final Receiver<String> callback) {
        oAuth2Login.login(new Receiver<String>() {
            @Override
            public void onSuccess(String response) {
                requestTransport.setAccessToken(response);
                callback.onSuccess(response);
            }

            @Override
            public void onFailure(ServerFailure error) {
                Window.alert(error.getMessage());
            }
        });
    }

    public void getUserInfo(Receiver<Person> receiver) {
        plus.people().get("me").to(receiver).fire();
    }
} 
```

下面显示了发生故障的位置：

```
GoogleApi googleApi = new GoogleApi(eventBus, MY_CLIENT_ID);

googleApi.login(new Receiver<String>() {
    @Override
    public void onSuccess(final String token) {
        // login is successful and access token is received

        // but the following call fails with "Cannot call method 'newHttpRequest'
        // of undefined" error
        googleApi.getUserInfo(new Receiver<Person>() {
            @Override
            public void onSuccess(Person person) {
                // never gets here
            }

            @Override
            public void onFailure(ServerFailure error) {
                // nor here
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T09:40:17.907

尝试更新您的 gwt-google-apis 库，早在 6 月份就有一个更改，将调用替换为`$wnd.googleapis.newHttpRequest()`调用`$wnd.gapi.client.rpcRequest()`：[https ://code.google.com/p/gwt-google-apis/source/detail?r=2041](https://code.google.com/p/gwt-google-apis/source/detail?r=2041)

身份验证起作用的原因是它不使用相同的代码与服务器对话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T12:46:20.513

我玩过代码（仍然使用 1.0.2-alpha 版）并让它工作！以下是更新后的代码：

```
public final class GoogleApi {
    private static final Plus plus = GWT.create(Plus.class);

    private final String clientId;

    private EventBus eventBus;

    private final ClientOAuth2Login oAuth2Login;
    private ClientGoogleApiRequestTransport requestTransport;

    private String accessToken;

    /**
     * @param clientId
     *            This app's personal client ID assigned by the Google APIs
     *            Console (http://code.google.com/apis/console)
     */
    public GoogleApi(final EventBus eventBus, String clientId) {
        this.eventBus = eventBus;
        this.clientId = clientId;
        oAuth2Login = new ClientOAuth2Login(clientId);
        oAuth2Login.withScopes(PlusAuthScope.PLUS_ME);
    }

    public void login(final Receiver<String> callback) {
        oAuth2Login.login(new Receiver<String>() {
            @Override
            public void onSuccess(String response) {
                accessToken = response;
                callback.onSuccess(response);
            }

            @Override
            public void onFailure(ServerFailure error) {
                Window.alert(error.getMessage());
            }
        });
    }

    public void getUserInfo(final Receiver<Person> receiver) {
        requestTransport = new ClientGoogleApiRequestTransport();
        requestTransport.setApplicationName(ClientConstants.GOOGLE_APP_NAME)
                .setApiAccessKey(ClientConstants.GOOGLE_API_KEY)
                .setAccessToken(accessToken);
        requestTransport.create(new Receiver<GoogleApiRequestTransport>() {
            @Override
            public void onSuccess(GoogleApiRequestTransport transport) {
                plus.initialize(eventBus, transport);
                plus.people().get("me").to(receiver).fire();
            }
        });
    }
} 
```

不过，我不知道这有多有效。每次调用 getUserInfo() 时都会调用 Plus 的 initialize() 方法。

我的下一步是使用最新版本的 API 手动构建一个 jar 并相应地调整我的代码：/ 祝我好运！

# image - 在 WordPress 中从静态图像更改为 Google Map onhover 或鼠标

> ID：13556644
> 
> 赞同：1
> 
> 时间：2012-11-25T23:20:38.473
> 
> 标签：image, wordpress, google-maps, onmouseover, onhover

我想要一个静态图像，在悬停或鼠标悬停时被谷歌地图取代。我正在尝试使用插件 Hover Image 但我认为您不能在其中使用 Google Map 代码，因为它不起作用。还有其他方法吗？非常感谢您！

这是我尝试使用 Hover Image Plugin 并将短代码 [himage] [/himage] 放在下面的代码周围，但它只显示第一张图像并且不拾取谷歌地图。我如何让它拿起谷歌地图？

```
[himage]
<img class="" title="" src="http://tafe404.cccit.info/loosh2/wp-content/themes/newtheme/images/loosh_map.png" alt="Map showing location of LOOSH" width="463" height="463" align="center" />

[google-map-v3 width="463" height="463" zoom="16" maptype="roadmap" mapalign="center" directionhint="false" language="default" poweredby="false" maptypecontrol="true" pancontrol="true" zoomcontrol="true" scalecontrol="true" streetviewcontrol="true" scrollwheelcontrol="true" draggable="true" tiltfourtyfive="false" addmarkermashupbubble="false" addmarkermashupbubble="false" addmarkerlist="Explorers Rd, Lapstone NSW 2773{}4-default.png{}Lapstone Public School Grounds" bubbleautopan="true" showbike="false" showtraffic="false" showpanoramio="false"]

 [/himage] 
```

这是插件的代码：

```
<?php
/**
 * @package Akismet
 */
/*
Plugin Name: Akismet
Plugin URI: http://akismet.com/?return=true
Description: Used by millions, Akismet is quite possibly the best way in the world to <strong>protect your blog from comment and trackback spam</strong>. It keeps your site protected from spam even while you sleep. To get started: 1) Click the "Activate" link to the left of this description, 2) <a href="http://akismet.com/get/?return=true">Sign up for an Akismet API key</a>, and 3) Go to your <a href="admin.php?page=akismet-key-config">Akismet configuration</a> page, and save your API key.
Version: 2.5.6
Author: Automattic
Author URI: http://automattic.com/wordpress-plugins/
License: GPLv2 or later
*/

/*
This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
*/

define('AKISMET_VERSION', '2.5.6');
define('AKISMET_PLUGIN_URL', plugin_dir_url( __FILE__ ));

/** If you hardcode a WP.com API key here, all key config screens will be hidden */
if ( defined('WPCOM_API_KEY') )
    $wpcom_api_key = constant('WPCOM_API_KEY');
else
    $wpcom_api_key = '';

// Make sure we don't expose any info if called directly
if ( !function_exists( 'add_action' ) ) {
    echo "Hi there!  I'm just a plugin, not much I can do when called directly.";
    exit;
}

if ( isset($wp_db_version) && $wp_db_version <= 9872 )
    include_once dirname( __FILE__ ) . '/legacy.php';

include_once dirname( __FILE__ ) . '/widget.php';

if ( is_admin() )
    require_once dirname( __FILE__ ) . '/admin.php';

function akismet_init() {
    global $wpcom_api_key, $akismet_api_host, $akismet_api_port;

    if ( $wpcom_api_key )
        $akismet_api_host = $wpcom_api_key . '.rest.akismet.com';
    else
        $akismet_api_host = get_option('wordpress_api_key') . '.rest.akismet.com';

    $akismet_api_port = 80;
}
add_action('init', 'akismet_init');

function akismet_get_key() {
    global $wpcom_api_key;
    if ( !empty($wpcom_api_key) )
        return $wpcom_api_key;
    return get_option('wordpress_api_key');
}

function akismet_check_key_status( $key, $ip = null ) {
    global $akismet_api_host, $akismet_api_port, $wpcom_api_key;
    $blog = urlencode( get_option('home') );
    if ( $wpcom_api_key )
        $key = $wpcom_api_key;
    $response = akismet_http_post("key=$key&blog=$blog", 'rest.akismet.com', '/1.1/verify-key', $akismet_api_port, $ip);
    return $response;
}

// given a response from an API call like akismet_check_key_status(), update the alert code options if an alert is present.
function akismet_update_alert( $response ) {
    $code = $msg = null;
    if ( isset($response[0]['x-akismet-alert-code']) ) {
        $code = $response[0]['x-akismet-alert-code'];
        $msg = $response[0]['x-akismet-alert-msg'];
    }

    // only call update_option() if the value has changed
    if ( $code != get_option( 'akismet_alert_code' ) ) {
        update_option( 'akismet_alert_code', $code );
        update_option( 'akismet_alert_msg', $msg );
    }
}

function akismet_verify_key( $key, $ip = null ) {
    $response = akismet_check_key_status( $key, $ip );
    akismet_update_alert( $response );
    if ( !is_array($response) || !isset($response[1]) || $response[1] != 'valid' && $response[1] != 'invalid' )
        return 'failed';
    return $response[1];
}

// if we're in debug or test modes, use a reduced service level so as not to polute training or stats data
function akismet_test_mode() {
    if ( defined('AKISMET_TEST_MODE') && AKISMET_TEST_MODE )
        return true;
    return false;
}

// return a comma-separated list of role names for the given user
function akismet_get_user_roles($user_id ) {
    $roles = false;

    if ( !class_exists('WP_User') )
        return false;

    if ( $user_id > 0 ) {
        $comment_user = new WP_User($user_id);
        if ( isset($comment_user->roles) )
            $roles = join(',', $comment_user->roles);
    }

    if ( is_multisite() && is_super_admin( $user_id ) ) {
        if ( empty( $roles ) ) {
            $roles = 'super_admin';
        } else {
            $comment_user->roles[] = 'super_admin';
            $roles = join( ',', $comment_user->roles );
        }
    }

    return $roles;
}

// Returns array with headers in $response[0] and body in $response[1]
function akismet_http_post($request, $host, $path, $port = 80, $ip=null) {
    global $wp_version;

    $akismet_ua = "WordPress/{$wp_version} | ";
    $akismet_ua .= 'Akismet/' . constant( 'AKISMET_VERSION' );

    $akismet_ua = apply_filters( 'akismet_ua', $akismet_ua );

    $content_length = strlen( $request );

    $http_host = $host;
    // use a specific IP if provided
    // needed by akismet_check_server_connectivity()
    if ( $ip && long2ip( ip2long( $ip ) ) ) {
        $http_host = $ip;
    } else {
        $http_host = $host;
    }

    // use the WP HTTP class if it is available
    if ( function_exists( 'wp_remote_post' ) ) {
        $http_args = array(
            'body'          => $request,
            'headers'       => array(
                'Content-Type'  => 'application/x-www-form-urlencoded; ' .
                                    'charset=' . get_option( 'blog_charset' ),
                'Host'          => $host,
                'User-Agent'    => $akismet_ua
            ),
            'httpversion'   => '1.0',
            'timeout'       => 15
        );
        $akismet_url = "http://{$http_host}{$path}";
        $response = wp_remote_post( $akismet_url, $http_args );
        if ( is_wp_error( $response ) )
            return '';

        return array( $response['headers'], $response['body'] );
    } else {
        $http_request  = "POST $path HTTP/1.0\r\n";
        $http_request .= "Host: $host\r\n";
        $http_request .= 'Content-Type: application/x-www-form-urlencoded; charset=' . get_option('blog_charset') . "\r\n";
        $http_request .= "Content-Length: {$content_length}\r\n";
        $http_request .= "User-Agent: {$akismet_ua}\r\n";
        $http_request .= "\r\n";
        $http_request .= $request;

        $response = '';
        if( false != ( $fs = @fsockopen( $http_host, $port, $errno, $errstr, 10 ) ) ) {
            fwrite( $fs, $http_request );

            while ( !feof( $fs ) )
                $response .= fgets( $fs, 1160 ); // One TCP-IP packet
            fclose( $fs );
            $response = explode( "\r\n\r\n", $response, 2 );
        }
        return $response;
    }
}

// filter handler used to return a spam result to pre_comment_approved
function akismet_result_spam( $approved ) {
    // bump the counter here instead of when the filter is added to reduce the possibility of overcounting
    if ( $incr = apply_filters('akismet_spam_count_incr', 1) )
        update_option( 'akismet_spam_count', get_option('akismet_spam_count') + $incr );
    // this is a one-shot deal
    remove_filter( 'pre_comment_approved', 'akismet_result_spam' );
    return 'spam';
}

function akismet_result_hold( $approved ) {
    // once only
    remove_filter( 'pre_comment_approved', 'akismet_result_hold' );
    return '0';
}

// how many approved comments does this author have?
function akismet_get_user_comments_approved( $user_id, $comment_author_email, $comment_author, $comment_author_url ) {
    global $wpdb;

    if ( !empty($user_id) )
        return $wpdb->get_var( $wpdb->prepare( "SELECT COUNT(*) FROM $wpdb->comments WHERE user_id = %d AND comment_approved = 1", $user_id ) );

    if ( !empty($comment_author_email) )
        return $wpdb->get_var( $wpdb->prepare( "SELECT COUNT(*) FROM $wpdb->comments WHERE comment_author_email = %s AND comment_author = %s AND comment_author_url = %s AND comment_approved = 1", $comment_author_email, $comment_author, $comment_author_url ) );

    return 0;
}

function akismet_microtime() {
    $mtime = explode( ' ', microtime() );
    return $mtime[1] + $mtime[0];
}

// log an event for a given comment, storing it in comment_meta
function akismet_update_comment_history( $comment_id, $message, $event=null ) {
    global $current_user;

    // failsafe for old WP versions
    if ( !function_exists('add_comment_meta') )
        return false;

    $user = '';
    if ( is_object($current_user) && isset($current_user->user_login) )
        $user = $current_user->user_login;

    $event = array(
        'time' => akismet_microtime(),
        'message' => $message,
        'event' => $event,
        'user' => $user,
    );

    // $unique = false so as to allow multiple values per comment
    $r = add_comment_meta( $comment_id, 'akismet_history', $event, false );
}

// get the full comment history for a given comment, as an array in reverse chronological order
function akismet_get_comment_history( $comment_id ) {

    // failsafe for old WP versions
    if ( !function_exists('add_comment_meta') )
        return false;

    $history = get_comment_meta( $comment_id, 'akismet_history', false );
    usort( $history, 'akismet_cmp_time' );
    return $history;
}

function akismet_cmp_time( $a, $b ) {
    return $a['time'] > $b['time'] ? -1 : 1;
}

// this fires on wp_insert_comment.  we can't update comment_meta when akismet_auto_check_comment() runs
// because we don't know the comment ID at that point.
function akismet_auto_check_update_meta( $id, $comment ) {
    global $akismet_last_comment;

    // failsafe for old WP versions
    if ( !function_exists('add_comment_meta') )
        return false;

    // wp_insert_comment() might be called in other contexts, so make sure this is the same comment
    // as was checked by akismet_auto_check_comment
    if ( is_object($comment) && !empty($akismet_last_comment) && is_array($akismet_last_comment) ) {
        if ( intval($akismet_last_comment['comment_post_ID']) == intval($comment->comment_post_ID)
            && $akismet_last_comment['comment_author'] == $comment->comment_author
            && $akismet_last_comment['comment_author_email'] == $comment->comment_author_email ) {
                // normal result: true or false
                if ( $akismet_last_comment['akismet_result'] == 'true' ) {
                    update_comment_meta( $comment->comment_ID, 'akismet_result', 'true' );
                    akismet_update_comment_history( $comment->comment_ID, __('Akismet caught this comment as spam'), 'check-spam' );
                    if ( $comment->comment_approved != 'spam' )
                        akismet_update_comment_history( $comment->comment_ID, sprintf( __('Comment status was changed to %s'), $comment->comment_approved), 'status-changed'.$comment->comment_approved );
                } elseif ( $akismet_last_comment['akismet_result'] == 'false' ) {
                    update_comment_meta( $comment->comment_ID, 'akismet_result', 'false' );
                    akismet_update_comment_history( $comment->comment_ID, __('Akismet cleared this comment'), 'check-ham' );
                    if ( $comment->comment_approved == 'spam' ) {
                        if ( wp_blacklist_check($comment->comment_author, $comment->comment_author_email, $comment->comment_author_url, $comment->comment_content, $comment->comment_author_IP, $comment->comment_agent) )
                            akismet_update_comment_history( $comment->comment_ID, __('Comment was caught by wp_blacklist_check'), 'wp-blacklisted' );
                        else
                            akismet_update_comment_history( $comment->comment_ID, sprintf( __('Comment status was changed to %s'), $comment->comment_approved), 'status-changed-'.$comment->comment_approved );
                    }
                // abnormal result: error
                } else {
                    update_comment_meta( $comment->comment_ID, 'akismet_error', time() );
                    akismet_update_comment_history( $comment->comment_ID, sprintf( __('Akismet was unable to check this comment (response: %s), will automatically retry again later.'), substr($akismet_last_comment['akismet_result'], 0, 50)), 'check-error' );
                }

                // record the complete original data as submitted for checking
                if ( isset($akismet_last_comment['comment_as_submitted']) )
                    update_comment_meta( $comment->comment_ID, 'akismet_as_submitted', $akismet_last_comment['comment_as_submitted'] );
        }
    }
}

add_action( 'wp_insert_comment', 'akismet_auto_check_update_meta', 10, 2 );

function akismet_auto_check_comment( $commentdata ) {
    global $akismet_api_host, $akismet_api_port, $akismet_last_comment;

    $comment = $commentdata;
    $comment['user_ip']    = $_SERVER['REMOTE_ADDR'];
    $comment['user_agent'] = $_SERVER['HTTP_USER_AGENT'];
    $comment['referrer']   = $_SERVER['HTTP_REFERER'];
    $comment['blog']       = get_option('home');
    $comment['blog_lang']  = get_locale();
    $comment['blog_charset'] = get_option('blog_charset');
    $comment['permalink']  = get_permalink($comment['comment_post_ID']);

    if ( !empty( $comment['user_ID'] ) ) {
        $comment['user_role'] = akismet_get_user_roles($comment['user_ID']);
    }

    $akismet_nonce_option = apply_filters( 'akismet_comment_nonce', get_option( 'akismet_comment_nonce' ) );
    $comment['akismet_comment_nonce'] = 'inactive';
    if ( $akismet_nonce_option == 'true' || $akismet_nonce_option == '' ) {
        $comment['akismet_comment_nonce'] = 'failed';
        if ( isset( $_POST['akismet_comment_nonce'] ) && wp_verify_nonce( $_POST['akismet_comment_nonce'], 'akismet_comment_nonce_' . $comment['comment_post_ID'] ) )
            $comment['akismet_comment_nonce'] = 'passed';

        // comment reply in wp-admin
        if ( isset( $_POST['_ajax_nonce-replyto-comment'] ) && check_ajax_referer( 'replyto-comment', '_ajax_nonce-replyto-comment' ) )
            $comment['akismet_comment_nonce'] = 'passed';

    }

    if ( akismet_test_mode() )
        $comment['is_test'] = 'true';

    foreach ($_POST as $key => $value ) {
        if ( is_string($value) )
            $comment["POST_{$key}"] = $value;
    }

    $ignore = array( 'HTTP_COOKIE', 'HTTP_COOKIE2', 'PHP_AUTH_PW' );

    foreach ( $_SERVER as $key => $value ) {
        if ( !in_array( $key, $ignore ) && is_string($value) )
            $comment["$key"] = $value;
        else
            $comment["$key"] = '';
    }

    $post = get_post( $comment['comment_post_ID'] );
    $comment[ 'comment_post_modified_gmt' ] = $post->post_modified_gmt;

    $query_string = '';
    foreach ( $comment as $key => $data )
        $query_string .= $key . '=' . urlencode( stripslashes($data) ) . '&';

    $commentdata['comment_as_submitted'] = $comment;

    $response = akismet_http_post($query_string, $akismet_api_host, '/1.1/comment-check', $akismet_api_port);
    akismet_update_alert( $response );
    $commentdata['akismet_result'] = $response[1];
    if ( 'true' == $response[1] ) {
        // akismet_spam_count will be incremented later by akismet_result_spam()
        add_filter('pre_comment_approved', 'akismet_result_spam');

        do_action( 'akismet_spam_caught' );

        $last_updated = strtotime( $post->post_modified_gmt );
        $diff = time() - $last_updated;
        $diff = $diff / 86400;

        if ( $post->post_type == 'post' && $diff > 30 && get_option( 'akismet_discard_month' ) == 'true' && empty($comment['user_ID']) ) {
            // akismet_result_spam() won't be called so bump the counter here
            if ( $incr = apply_filters('akismet_spam_count_incr', 1) )
                update_option( 'akismet_spam_count', get_option('akismet_spam_count') + $incr );
            wp_safe_redirect( $_SERVER['HTTP_REFERER'] );
            die();
        }
    }

    // if the response is neither true nor false, hold the comment for moderation and schedule a recheck
    if ( 'true' != $response[1] && 'false' != $response[1] ) {
        if ( !current_user_can('moderate_comments') ) {
            add_filter('pre_comment_approved', 'akismet_result_hold');
        }
        if ( !wp_next_scheduled( 'akismet_schedule_cron_recheck' ) ) {
            wp_schedule_single_event( time() + 1200, 'akismet_schedule_cron_recheck' );
        }
    }

    if ( function_exists('wp_next_scheduled') && function_exists('wp_schedule_event') ) {
        // WP 2.1+: delete old comments daily
        if ( !wp_next_scheduled('akismet_scheduled_delete') )
            wp_schedule_event(time(), 'daily', 'akismet_scheduled_delete');
    } elseif ( (mt_rand(1, 10) == 3) ) {
        // WP 2.0: run this one time in ten
        akismet_delete_old();
    }
    $akismet_last_comment = $commentdata;

    akismet_fix_scheduled_recheck();
    return $commentdata;
}

add_action('preprocess_comment', 'akismet_auto_check_comment', 1);

function akismet_delete_old() {
    global $wpdb;
    $now_gmt = current_time('mysql', 1);
    $comment_ids = $wpdb->get_col("SELECT comment_id FROM $wpdb->comments WHERE DATE_SUB('$now_gmt', INTERVAL 15 DAY) > comment_date_gmt AND comment_approved = 'spam'");
    if ( empty( $comment_ids ) )
        return;

    $comma_comment_ids = implode( ', ', array_map('intval', $comment_ids) );

    do_action( 'delete_comment', $comment_ids );
    $wpdb->query("DELETE FROM $wpdb->comments WHERE comment_id IN ( $comma_comment_ids )");
    $wpdb->query("DELETE FROM $wpdb->commentmeta WHERE comment_id IN ( $comma_comment_ids )");
    clean_comment_cache( $comment_ids );
    $n = mt_rand(1, 5000);
    if ( apply_filters('akismet_optimize_table', ($n == 11)) ) // lucky number
        $wpdb->query("OPTIMIZE TABLE $wpdb->comments");

}

function akismet_delete_old_metadata() { 
    global $wpdb; 

    $now_gmt = current_time( 'mysql', 1 ); 
    $interval = apply_filters( 'akismet_delete_commentmeta_interval', 15 );

    # enfore a minimum of 1 day
    $interval = absint( $interval );
    if ( $interval < 1 ) {
        return;
    }

    // akismet_as_submitted meta values are large, so expire them 
    // after $interval days regardless of the comment status 
    while ( TRUE ) {
        $comment_ids = $wpdb->get_col( "SELECT $wpdb->comments.comment_id FROM $wpdb->commentmeta INNER JOIN $wpdb->comments USING(comment_id) WHERE meta_key = 'akismet_as_submitted' AND DATE_SUB('$now_gmt', INTERVAL {$interval} DAY) > comment_date_gmt LIMIT 10000" ); 

        if ( empty( $comment_ids ) ) {
            return; 
        }

        foreach ( $comment_ids as $comment_id ) {
            delete_comment_meta( $comment_id, 'akismet_as_submitted' );
        }
    }

    /*
    $n = mt_rand( 1, 5000 ); 
    if ( apply_filters( 'akismet_optimize_table', ( $n == 11 ), 'commentmeta' ) ) { // lucky number 
        $wpdb->query( "OPTIMIZE TABLE $wpdb->commentmeta" ); 
    }
    */
} 

add_action('akismet_scheduled_delete', 'akismet_delete_old');
add_action('akismet_scheduled_delete', 'akismet_delete_old_metadata'); 

function akismet_check_db_comment( $id, $recheck_reason = 'recheck_queue' ) {
    global $wpdb, $akismet_api_host, $akismet_api_port;

    $id = (int) $id;
    $c = $wpdb->get_row( "SELECT * FROM $wpdb->comments WHERE comment_ID = '$id'", ARRAY_A );
    if ( !$c )
        return;

    $c['user_ip']    = $c['comment_author_IP'];
    $c['user_agent'] = $c['comment_agent'];
    $c['referrer']   = '';
    $c['blog']       = get_option('home');
    $c['blog_lang']  = get_locale();
    $c['blog_charset'] = get_option('blog_charset');
    $c['permalink']  = get_permalink($c['comment_post_ID']);
    $id = $c['comment_ID'];
    if ( akismet_test_mode() )
        $c['is_test'] = 'true';
    $c['recheck_reason'] = $recheck_reason;

    $query_string = '';
    foreach ( $c as $key => $data )
    $query_string .= $key . '=' . urlencode( stripslashes($data) ) . '&';

    $response = akismet_http_post($query_string, $akismet_api_host, '/1.1/comment-check', $akismet_api_port);
    return $response[1];
}

function akismet_cron_recheck() {
    global $wpdb;

    $status = akismet_verify_key( akismet_get_key() );
    if ( get_option( 'akismet_alert_code' ) || $status == 'invalid' ) {
        // since there is currently a problem with the key, reschedule a check for 6 hours hence
        wp_schedule_single_event( time() + 21600, 'akismet_schedule_cron_recheck' );
        return false;
    }

    delete_option('akismet_available_servers');

    $comment_errors = $wpdb->get_col( "
        SELECT comment_id
        FROM {$wpdb->prefix}commentmeta
        WHERE meta_key = 'akismet_error'
        LIMIT 100
    " );

    foreach ( (array) $comment_errors as $comment_id ) {
        // if the comment no longer exists, or is too old, remove the meta entry from the queue to avoid getting stuck
        $comment = get_comment( $comment_id );
        if ( !$comment || strtotime( $comment->comment_date_gmt ) < strtotime( "-15 days" ) ) {
            delete_comment_meta( $comment_id, 'akismet_error' );
            continue;
        }

        add_comment_meta( $comment_id, 'akismet_rechecking', true );
        $status = akismet_check_db_comment( $comment_id, 'retry' );

        $msg = '';
        if ( $status == 'true' ) {
            $msg = __( 'Akismet caught this comment as spam during an automatic retry.' );
        } elseif ( $status == 'false' ) {
            $msg = __( 'Akismet cleared this comment during an automatic retry.' );
        }

        // If we got back a legit response then update the comment history
        // other wise just bail now and try again later.  No point in
        // re-trying all the comments once we hit one failure.
        if ( !empty( $msg ) ) {
            delete_comment_meta( $comment_id, 'akismet_error' );
            akismet_update_comment_history( $comment_id, $msg, 'cron-retry' );
            update_comment_meta( $comment_id, 'akismet_result', $status );
            // make sure the comment status is still pending.  if it isn't, that means the user has already moved it elsewhere.
            $comment = get_comment( $comment_id );
            if ( $comment && 'unapproved' == wp_get_comment_status( $comment_id ) ) {
                if ( $status == 'true' ) {
                    wp_spam_comment( $comment_id );
                } elseif ( $status == 'false' ) {
                    // comment is good, but it's still in the pending queue.  depending on the moderation settings
                    // we may need to change it to approved.
                    if ( check_comment($comment->comment_author, $comment->comment_author_email, $comment->comment_author_url, $comment->comment_content, $comment->comment_author_IP, $comment->comment_agent, $comment->comment_type) )
                        wp_set_comment_status( $comment_id, 1 );
                }
            }
        } else {
            delete_comment_meta( $comment_id, 'akismet_rechecking' );
            wp_schedule_single_event( time() + 1200, 'akismet_schedule_cron_recheck' );
            return;
        }
        delete_comment_meta( $comment_id, 'akismet_rechecking' );
    }

    $remaining = $wpdb->get_var( $wpdb->prepare( "SELECT COUNT(*) FROM $wpdb->commentmeta WHERE meta_key = 'akismet_error'" ) );
    if ( $remaining && !wp_next_scheduled('akismet_schedule_cron_recheck') ) {
        wp_schedule_single_event( time() + 1200, 'akismet_schedule_cron_recheck' );
    }
}
add_action( 'akismet_schedule_cron_recheck', 'akismet_cron_recheck' );

function akismet_add_comment_nonce( $post_id ) {
    echo '<p style="display: none;">';
    wp_nonce_field( 'akismet_comment_nonce_' . $post_id, 'akismet_comment_nonce', FALSE );
    echo '</p>';
}

$akismet_comment_nonce_option = apply_filters( 'akismet_comment_nonce', get_option( 'akismet_comment_nonce' ) );

if ( $akismet_comment_nonce_option == 'true' || $akismet_comment_nonce_option == '' )
    add_action( 'comment_form', 'akismet_add_comment_nonce' );

global $wp_version;
if ( '3.0.5' == $wp_version ) { 
    remove_filter( 'comment_text', 'wp_kses_data' ); 
    if ( is_admin() ) 
        add_filter( 'comment_text', 'wp_kses_post' ); 
}

function akismet_fix_scheduled_recheck() {
    $future_check = wp_next_scheduled( 'akismet_schedule_cron_recheck' );
    if ( !$future_check ) {
        return;
    }

    if ( get_option( 'akismet_alert_code' ) > 0 ) {
        return;
    }

    $check_range = time() + 1200;
    if ( $future_check > $check_range ) {
        wp_clear_scheduled_hook( 'akismet_schedule_cron_recheck' );
        wp_schedule_single_event( time() + 300, 'akismet_schedule_cron_recheck' );
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:28:01.410

这可以通过一些非常简单的 html 和 css 来完成。

**HTML：**

```
<div class="map">
    <div class="map-image">
        <img src="map.png" alt="" />
    </div>
    <div class="map-google">
        // code for map goes here
    </div>
</div> 
```

**CSS：**

```
.map {position:relative;width:400px;height:400px;}

.map-image {position:absolute;width:100%;height:100%;top:0;left:0;z-index:1;}

.map-google {position:absolute;width:100%;height:100%;top:0;left:0;z-index:0;}

.map-image:hover {display:none;} 
```

# python - Python 对象标识

> ID：13556645
> 
> 赞同：1
> 
> 时间：2012-11-25T23:20:40.473
> 
> 标签：python

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

我有以下 Python 代码：

```
class Node(object):
    def __init__(self, name, children = []):
        self.name = name
        self.children = children

    def add_child(self, child):
        self.children.append(child)

    def __str__(self):
        return self.name

def create_tree(num_vertices):
    vs = [Node(str(i)) for i in range(num_vertices)]
    for i in range(num_vertices):
        if 2 * i + 1 < num_vertices:
            vs[i].add_child(vs[2 * i + 1])
        if 2 * i + 2 < num_vertices:
            vs[i].add_child(vs[2 * i + 2])

    return vs[0]

def bfs(top_node, visit):
    """Breadth-first search on a graph, starting at top_node."""
    visited = set()
    queue = [top_node]
    while len(queue):
        curr_node = queue.pop(0)   # Dequeue
        visit(curr_node)           # Visit the node
        visited.add(curr_node)

        # Enqueue non-visited and non-enqueued children
        queue.extend(c for c in curr_node.children
                     if c not in visited and c not in queue)

def visit(tree):
    print tree 
```

现在我在 IDLE 中进行以下调用：

```
>>> bfs(create_tree(3), visit)
0
1
2
>>> bfs(create_tree(3), visit)
0
1
2
1
2 
```

即使我每次都尝试创建一棵新树，但我似乎每次都以相同的树结束（每次都添加新节点）。这是为什么？在 create_tree 中，我正在为每个函数调用创建一个新列表。

（顺便说一句，这不是作业。这是*Think Complexity*中的练习 4.2 ，我正在阅读它是为了好玩，而练习不是为了弄清楚为什么“[e]即使我正在尝试创建一棵新树每次，我似乎每次都以相同的树结束”。（问题是找出 bfs 代码效率低下的原因，我知道答案。））

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:25:45.283

那是因为如果您在 init 中设置`children = []`它不会每次都创建一个新列表，它会第一次创建一个列表，其他时间使用相同的列表；这解释了这种行为。在这些情况下，最好的办法是写

```
def __init__(self, ..., children = None):
    if children is None: children = [] 
```

# recursion - 堆栈递归程序问题

> ID：13556646
> 
> 赞同：1
> 
> 时间：2012-11-25T23:21:02.160
> 
> 标签：recursion, compiler-errors, stack

我是一个新手 C++ 编码器，显然不是很擅长。我在这个程序上遇到了很多麻烦。

*   我的函数的左括号和右括号出现语法错误，`<`头 cpp 文件中的“”出现语法错误，以及缺少括号的错误。
*   我的第一个堆栈无法识别（主驱动程序文件），并且在我的 StackType.cpp 文件中 -`original`是“未声明的标识符”。
*   最后，左边`Push`必须有类/结构/联合 - 在我的`for`循环中，当用环填充第一个堆栈时。

我提前为所有这些问题道歉。您能给我的任何帮助将不胜感激！谢谢你。

======================堆栈头========================== ======

```
// File: StackType.h
// Stack template class definition.
// Dynamic array implementation

#ifndef StackType
#define StackType

template <class ItemType>
class StackType

{
private:
    int ItemType;
    ItemType *myStack;  // pointer to dynamic array
    int _top, _maxSize; // using underscores to remind that it's private

    public:

    StackType(int numRings = 50);       // Constructor
    StackType (const StackType<ItemType>&); // Copy Constructor

    // Member Functions
    void Push(ItemType);            // Push
    void Pop(ItemType &);           // Pop
    void stackTop(ItemType &) const;    // retrieve top
    bool stackIsEmpty() const;          // Test for Empty stack
    bool stackIsFull() const;       // Test for Full stack

    ~StackType();       // Destructor
};
#endif 
```

=====================堆栈cpp文件========================== ========

```
#include "StackType.h"

#include "stdafx.h"
#include <iostream> 
#include <stdio.h>

// Constructor with argument, size is numRings, limit is 50 (set in .h header)
template <class ItemType>
StackType<ItemType>::StackType()
{  
    _maxSize = numRings; 
    _top = -1; 
}

// Copy Constructor
template <class ItemType>
StackType<ItemType>::StackType(const StackType<ItemType>& original :  
                                       _maxSize(original._maxSize), top(original._top)
{
    myStack = new ItemType[_maxSize];
    for (int i = 0; i <= top; i++) myStack[i] = original.myStack[i];
}

// Destructor
template <class ItemType>
StackType<ItemType>::~StackType()
{ 
    delete [] myStack;
}

// Push
template <class ItemType>
void StackType<ItemType>::Push(StackType<ItemType> ringVal)
{
    if(stackIsFull()) cout << "\t There is not enough available memory = the stack is 
                                  full!" << endl;
    else myStack[++_top] = ringVal;
}

// Pop
template <class ItemType>
void StackType<ItemType>::Pop(StackType<ItemType> &ringVal)
{
    if(stackIsEmpty()) cout << "\t The stack is empty!" << endl;
    else ringVal = myStack[_top--];
}

// Retrieve stack top without removing it
template <class ItemType>
void StackType<ItemType>::stackTop(StackType<ItemType> &ringVal) const
{
    if(stackIsEmpty()) cout << "The stack is empty!";
    else ringVal = myStack[_top];
}

// Test for Empty stack
template <class ItemType>
bool StackType<ItemType>::stackIsEmpty() const
{ 
    return (_top < 0); 
}

// Test for Full stack
template <class ItemType>
bool StackType<class ItemType>::stackIsFull() const
{ 
    return (_top >= (_maxSize - 1)); 
}
 // end StackType.cpp 
```

==========================主驱动文件====================== ==================

```
#include "StackType.h"
#ifdef _DEBUG
#include "StackType.cpp"
#endif // _DEBUG

#include <stack>
#include "StdAfx.h"
#include <iostream>
using namespace std;

//  Global Variable - Counter to display the number of moves.
int count = 0; 

class StackType;

//  Functions Prototypes
void MoveRings(StackType<ItemType>&, StackType<ItemType>&);
//  Function to move the rings
void Pegs(int D,StackType<ItemType>& b,StackType<ItemType>& e, StackType<ItemType>& h);
//  This is a recursive function.  
void Display (int, StackType <ItemType>& , StackType<ItemType>&, StackType<ItemType>&); 
//  Function to display the pegs  

//  Main - Driver File
int main()
{

    // create 3 empty stacks
    StackType<ItemType> FirstPeg;   // Receiving an error that this is not identified
    StackType<ItemType> EndPeg;
    StackType<ItemType> HelperPeg;

    // Number of rings.
    int numRings;

    cout << "\n\t *********** Rings to Pegs (Towers of Hanoi) ***********\n" << endl;
    cout << "\t Please Enter the number of rings you want to play with: ";
    //  Input number of rings
    cin >> numRings;    
    cout << endl;
    while(numRings < 0 || isalpha(numRings))  //  To make sure that the user did not 
                                              //  enter an invalid number
    {
        cout << "  Your entry is invalid. Please use only integers. Please re-
                                                                              enter: ";
        cin >> numRings;
        cout << endl;
    }

    for(int i = 1; i <= numRings; i++)
     // Fill the first peg with the number of rings.
    {
        FirstPeg.Push(i);
    }

    Pegs(int, StackType<ItemType>&, StackType<ItemType>&, StackType<ItemType>&); 
    //  To call the recursive function that will move the rings
    Display (int, StackType<ItemType>&, StackType<ItemType>&, StackType<ItemType>&); 
    //  To call the display function

    cin.clear();
    cin.ignore('\n');
    cin.get();
    return 0;

}

//  This function will move an ring from first peg to the second peg
void MoveRings(StackType<ItemType>& beg, StackType<ItemType>& theEnd) //End
{
    int r; // disk will be removed from one stack and added to the other

    beg.Pop(r);//pop from source

    theEnd.Push(r);//and move to target

}

//  This function displays the moves
void Display(int R, StackType<ItemType>& toBegin , StackType<ItemType>& toEnd,  
             StackType<ItemType>& toHelp) 

{
    StackType<int> B;// create temporarily first stack 
    StackType<int> E;// create temporarily End(End) stack 
    StackType<int> H;// create temporarily helper stack 
    for(int i = 1; i <= R; i++)
    {
        toBegin.Pop(i);//moves the ring from source
        B.Push(i);//to the temporarily stack to display it
        cout << "Beginning Peg:" << &B << endl;

        toEnd.Pop(i);//moves the ring from source
        E.Push(i);//to the temporarily stack to display it
        cout << "  End(Final) Peg: " << &E << endl;

        toHelp.Pop(i);//moves the ring from source
        H.Push(i);//to the temporarily stack to display it
        cout << "  Helper Peg:" << &H << endl;
    }
}

//-------------------------------------------------------------------

void Pegs(int D,StackType<ItemType>& b,StackType<ItemType>& e,StackType<ItemType>& h) 
//  This is a recursive function. 
{
    if (D == 0) // The base 
    {
        return 1;
    }

    else if(D == 1)              //  If there is only one ring, move this ring from the 
                                 //  first peg to the end(final) peg
    {
        MoveRings(b, e); // moves the ring from the first to the end(final) peg 
        cout<<"  Really? You have entered one ring..." << endl;
        cout<<"  It moves directly from the first peg to the End peg." << endl;

        count++; // increment the number of moves

        cout << "There has been " << count << " move. "<< endl;// display the          
                                                                   // number of moves
        Display (D, b, e, h);

    }
    else if (D > 1) // a recursive function in order to move the rings
    {

            Pegs(D - 1, b, e, h);    //  to move N-1 rings from the first peg to the
                                     //  end(final) peg by using the helper peg

        MoveRings(b, e);//  to move the last ring to the end(final) peg 
        count++; //  increment the number of steps before displaying
        cout << "There has been " << count << " moves. "<< endl;

Pegs(D - 1, b, e, h); 
    //  to move N-1 rings from the helper peg to the end(final) peg with the help of                    
    //  first peg

    //Display ( D(rings), First Peg, End(Final) Peg, Helper Peg );
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:39:21.357

我可以立即看到的一个问题是您的头文件定义`StackType`为防止双重包含，这也用作类名。之后`#define StackType`，它最终成为一个扩展为空的宏，因此您的代码看起来像`class { ... }`.

您应该使用一个符号来防止不用于其他任何内容的双重包含。对于名为 StackType.h 的文件，典型使用的是 STACKTYPE_H。

解决此问题后，您遇到的其他一些问题可能会消失。如果您遇到更多问题，请返回更新，如果有，请发布确切的编译器错误。

# c# - 二进制排序逻辑：未正确排序数字

> ID：13556649
> 
> 赞同：2
> 
> 时间：2012-11-25T23:21:37.260
> 
> 标签：c#

我目前正在尝试实现二进制排序逻辑。我首先生成随机数。然后创建该数组的副本，然后使用二进制排序方法对其进行排序。问题是排序不能正常工作。我不确定我的比较是否正确。任何想法为什么不能正确排序？

```
namespace binarySort
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        Stopwatch sw = new Stopwatch();
        Random r = new Random();
        OpenFileDialog open1 = new OpenFileDialog();

        long operations = 0;
        int size;
        int max;
        int[] createArray;
        int[] sortArray;
        int[] copyArray;

 public void RandomNumber()
        {
            size = Convert.ToInt32(textBoxSize.Text);
            max = Convert.ToInt32(textBoxMax.Text);
            createArray = new int[size];
            copyArray = new int[size];
            sortArray = new int[size];

            for (int i = 0; i < size; i++)
            {
                createArray[i] = r.Next(1, max);
            }

            textBoxResults.AppendText("-------------------------------------------------------------------------------" + Environment.NewLine + "Random" + Environment.NewLine + Environment.NewLine);

            DisplayArrays();
        }

public void BinarySort()
        {
            operations = 0;
            sw.Reset();
            sw.Start();

            int low = 0;
            int high = 0;
            int temp = 0;
            int mid = 0;

            for (int i = 0; i < size; i++)
            {
                copyArray[i] = createArray[i];
            }

            for (int i = 1; i < size; i++)
            {
                high = i - 1;
                temp = copyArray[i];

                while (low <= high)
                {
                    operations++;

                    mid = (low + high) / 2;

                    if (temp < copyArray[mid])
                    {
                        high = mid - 1;
                    }
                    else
                    {
                        low = mid + 1;
                    }
                }

                operations++;

                for (int j = i - 1; j >= low; j--)
                {
                    copyArray[j + 1] = copyArray[j];
                }

                copyArray[low] = temp;
            }

            for (int i = 0; i < size; i++)
            {
                sortArray[i] = copyArray[i];
            }

            textBoxResults.AppendText("-------------------------------------------------------------------------------" + Environment.NewLine + "Binary Insertion" + Environment.NewLine + Environment.NewLine);
            DisplaySorted();

        }

 private void buttonSortArray_Click(object sender, EventArgs e)
        {

    BinarySort();

    }

}

} 
```

**例如：**

![在此处输入图像描述](../Images/52dd81d75a80b249624dcf8ed588a9f8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:31:28.363

**编辑：**对不起，你的原始代码是好的，你只需要在后面添加这一行`low = 0;`，`high = i - 1;`它应该是

```
for (int i = 1; i < size; i++)
 {
        high = i - 1;
        low = 0;
        temp = copyArray[i]; 
```

# asp.net - 我的必填字段验证器无法处理带水印的输入

> ID：13556654
> 
> 赞同：0
> 
> 时间：2012-11-25T23:22:35.827
> 
> 标签：asp.net

我在一个带有水印的文本框中有一个必填字段验证器。我正在使用 Ajax Toolkit ValidatorCalloutExtender。用户仍然可以单击提交按钮而无需进行任何验证。我在网上搜索过，但找不到有用的信息。我不确定我在这里缺少什么。

```
 <EditItemTemplate>
                            <asp:TextBox ID="TextBox6" runat="server" Width="403px"
                                Text='<%# Bind("Email") %>'></asp:TextBox>

                            <asp:RequiredFieldValidator ID="RequiredFieldEmail" runat="server" 
                            ErrorMessage="*** This is a required field ***" ControlToValidate="TextBox6" Display="None" 
                                Font-Bold="True" ForeColor="#FF3300"></asp:RequiredFieldValidator>
                                <ajaxToolkit:ValidatorCalloutExtender ID="ValidatorCalloutExtenderEmail" runat="server" TargetControlID="RequiredFieldEmail" HighlightCssClass="validatorCalloutHighlight">
                            </ajaxToolkit:ValidatorCalloutExtender>

                               <ajaxToolkit:TextBoxWatermarkExtender ID="AuthorEmail_TextBoxWatermarkExtender" runat="server"
                                    Enabled="True" WatermarkText="<<Type the first 4 letters of the first name to autopopulate>>"
                                    TargetControlID="TextBox6">
                                </ajaxToolkit:TextBoxWatermarkExtender>

                                <ajaxToolkit:AutoCompleteExtender ID="autoComplete00" runat="server" EnableCaching="true"
                                    BehaviorID="AutoCompleteExa" MinimumPrefixLength="3" TargetControlID="TextBox6"
                                    ServicePath="../AutoComplete.asmx" ServiceMethod="GetCompletionList" CompletionInterval="1000"
                                    CompletionSetCount="10" CompletionListCssClass="autocomplete_completionListElement"
                                    CompletionListItemCssClass="autocomplete_listItem" CompletionListHighlightedItemCssClass="autocomplete_highlightedListItem"
                                    DelimiterCharacters=";, :" ShowOnlyCurrentWordInCompletionListItem="true">
                                </ajaxToolkit:AutoCompleteExtender>
                        </EditItemTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:07:32.897

将RequiredFieldValidator 的InitialValue 设置为WatermarkText。修改你的 requiredfieldvalidator 的标记，如下所示，看看它是否有帮助。

```
<asp:RequiredFieldValidator ID="RequiredFieldEmail" runat="server" ErrorMessage="*** This is a required field ***" ControlToValidate="TextBox6" Display="None" InitialValue="<<Type the first 4 letters of the first name to autopopulate>>" Font-Bold="True" ForeColor="#FF3300"></asp:RequiredFieldValidator> 
```

# c# - 如果不相等，Interlocked.CompareExchange？

> ID：13556658
> 
> 赞同：1
> 
> 时间：2012-11-25T23:22:51.673
> 
> 标签：c#, multithreading, atomic, interlocked

> **可能重复：**
> [Interlocked.CompareExchange<Int> 使用 GreaterThan 或 LessThan 而不是相等](https://stackoverflow.com/questions/13042045/interlocked-compareexchangeint-using-greaterthan-or-lessthan-instead-of-equali)

我知道 Interlocked.CompareExchange 仅在值和比较值相等时交换值，
如果它们不相等如何交换它们以实现这样的目标？

```
if (Interlocked.CompareExchange(ref count, count + 1, max) != max)
    // i want it to increment as long as it is not equal to max
        {
           //count should equal to count + 1
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T23:46:50.570

Marc 发布的更高效（更少的总线锁定和更少的读取）和简化的实现：

```
static int InterlockedIncrementAndClamp(ref int count, int max)
{
    int oldval = Volatile.Read(ref count), val = ~oldval;

    while(oldval != max && oldval != val)
    {   
        val = oldval;
        oldval = Interlocked.CompareExchange(ref count, oldval + 1, oldval);
    }

    return oldval + 1;
} 
```

如果您的争用非常高，我们可以通过将常见情况减少为单个原子增量指令来进一步提高可伸缩性：与 CompareExchange 的开销相同，但不会出现循环。

```
static int InterlockedIncrementAndClamp(ref int count, int max, int drift)
{
    int v = Interlocked.Increment(ref count);

    while(v > (max + drift))
    {
        // try to adjust value.
        v = Interlocked.CompareExchange(ref count, max, v);
    }

    return Math.Min(v, max);
} 
```

`count`在这里，我们允许`drift`超过`max`. 但我们仍然只返回`max`. 这允许我们在大多数情况下将整个操作折叠成单个原子增量，这将允许最大的可扩展性。如果我们的价值超过我们的`drift`价值，我们只需要一个以上的操作，您可能可以将其做得足够大以使其非常稀有。

**为了回应 Marc 对 Interlocked 和 non-Interlocked 内存访问一起工作的担忧：**

关于具体`volatile`vs Interlocked:`volatile`只是一个普通的内存操作，但一个没有优化掉，一个没有相对于其他内存操作重新排序。这个特定问题并不围绕这些特定属性中的任何一个，所以我们实际上是在谈论非互锁与互锁互操作性。

.NET 内存模型保证基本整数类型的读取和写入（直到机器的本机字大小），并且引用是原子的。Interlocked 方法也是原子的。因为 .NET 只有一个“原子”定义，所以它们不需要明确的特殊情况说明它们相互兼容。

有一件事`Volatile.Read`不能*保证*可见性：您将始终获得加载指令，但 CPU 可能会从其本地缓存中读取旧值，而不是由不同 CPU 放入内存中的新值。x86 在大多数情况下不需要担心这一点（特殊指令，例如`MOVNTPS`例外），但对于其他架构来说这是非常可能的事情。

总而言之，这描述了两个可能影响 的问题`Volatile.Read`：首先，我们可能在 16 位 CPU 上运行，在这种情况下读取 an`int`不会是原子的，我们读取的可能不是其他人正在写入的值。其次，即使它是原子的，由于可见性，我们可能正在读取一个旧值。

但是影响`Volatile.Read`并不意味着它们会影响整个算法，这是完全安全的。

如果您以非原子方式同时**写入**，第一种情况只会咬我们。`count`这是因为最终可能发生的是（写 A[0]；CAS A[0:1]；写 A[1]）。因为我们所有的写入都`count`发生在保证原子的 CAS 中，所以这不是问题。当我们只是在阅读时，如果我们读取了错误的值，它将被即将到来的 CAS 捕获。

如果你仔细想想，第二种情况实际上只是普通情况的一种特殊情况，即读取和写入之间的值发生变化——读取发生在我们请求它之前。在这种情况下，第一次`Interlocked.CompareExchange`调用将报告与给出的值不同的值`Volatile.Read`，并且您将开始循环直到它成功。

如果您愿意，可以将`Volatile.Read`视为针对低争用情况的纯粹优化。`oldval`我们可以使用它进行初始化，`0`它仍然可以正常工作。使用`Volatile.Read`它很有可能只执行一个 CAS（按照说明，这非常昂贵，尤其是在多 CPU 配置中）而不是两个。

但是，是的，正如 Marc 所说——有时锁更简单！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-25T23:28:11.747

但是，没有“如果不相等则进行比较”：您可以先自己测试该值，然后仅在没有线程竞赛时才进行更新；这通常意味着如果第二次测试失败，您可能需要循环。在伪代码中：

```
bool retry;
do {
    retry = false;
    // get current value
    var val = Interlocked.CompareExchange(ref field, 0, 0);
    if(val != max) { // if not maxed
        // increment; if the value isn't what it was above: redo from start
        retry = Interlocked.CompareExchange(ref field, val + 1, val) != val;
    }        
} while (retry); 
```

但坦率地说，锁会更简单。

# c - c 组合文本文件中每一行的数字

> ID：13556660
> 
> 赞同：0
> 
> 时间：2012-11-25T23:23:09.413
> 
> 标签：c, text-files, scanf

我有一个包含很多行的文本文件，我在这里复制粘贴其中的一些，以向您展示我正在处理的内容。

1 16.07.2011 吉隆坡。17.00 OB - FCN 2 - 0 6.965
1 17.07.2011 kl。14.00 FCM - SIF 1 - 2 5.370

2 23.07.2011 吉隆坡。17.00 SIF - BIF 0 - 1 4.173
2 23.07.2011 kl。19.00 FCK - 产科 2 - 2
14.774 3 30.07.2011 kl。17.00 AGF - OB 2 - 2 11.312
3 30.07.2011 kl。19.00 FCK - FCN 2 - 0 11.076

```
while (fscanf(ifp, "%d %d.%d.%d kl. %lf %4s - %4s %d - %d %lf\n", &runde, &dag, &month, &year, &clock, team1, team2, &goal1, &goal2, &attendance) == 10)
    int prev_goal = goal1 + goal2;
    int current;
    if(prev_goal > current) {
    printf("Runde %d var den mest målrige med %d mål\n", runde, prev_goal);
   } 
```

我将这些值放入不同的变量中，但是如何将每一轮的结果相加，看看哪一个的目标最多？任何建议都会被采纳！谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:42:01.697

我会假设您只关心哪一轮的目标最多，并且您不需要像@Ben 建议的那样将文本文件存储在内存中。

如果是这种情况，您可以执行以下操作：

```
int i, maxGoals = 0, roundWithMostGoals = 0;

for (i = 0; fscanf(ifp, "%d %d.%d.%d kl. %lf %4s - %4s %d - %d %lf\n", &runde, &dag, &month, &year, &clock, team1, team2, &goal1, &goal2, &attendance) == 10; ++i)
{
    if (maxGoals < goal1 + goal2)
    {
        roundWithMostGoals = runde;
        maxGoals = goal1 + goal2;
    }
}

// Edit:
printf("The largest number of goals was %d, scored in round %d", maxGoals, roundWithMostGoals); 
```

**这段代码确实有问题**。如果有两轮进球数最多，则只打印第一轮。

为了避免这种情况，我们需要循环两次，这并不理想，我建议使用其他建议的方法之一，将所有这些数据加载到内存中。

但是，这是一个修改后的解决方案，即使我认为它不是最佳的：

```
int i, maxGoals = 0, roundWithMostGoals = 0;

// Find the maximum number of goals that was scored in any one round.
for (i = 0; fscanf(ifp, "%d %d.%d.%d kl. %lf %4s - %4s %d - %d %lf\n", &runde, &dag, &month, &year, &clock, team1, team2, &goal1, &goal2, &attendance) == 10; ++i)
{
    if (maxGoals < goal1 + goal2)
    {
        maxGoals = goal1 + goal2;
    }
}

printf("The largest number of goals scored was %d.\n", maxGoals);
printf("The largest number of goals was scored in\n");

// TODO: Reposition the file stream back to the beginning or close it and then reopen it again.
// XXX Code Here XXX

// Loop through again getting all the rounds with the maximum number of goals.

for (i = 0; fscanf(ifp, "%d %d.%d.%d kl. %lf %4s - %4s %d - %d %lf\n", &runde, &dag, &month, &year, &clock, team1, team2, &goal1, &goal2, &attendance) == 10; ++i)
{
    if (maxGoals == goal1 + goal2)
    {
        printf("\tRound %d\n", runde);
    }
} 
```

但这现在循环了两次，绝对不是解决问题的最佳方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:35:00.823

你应该做一些数组：

```
int goal1Array[]
int goal2Array[]
int listLength = 0; 
```

然后，当您阅读目标时，您可以将它们添加到数组中（确保记录您要添加的数量）：

```
goal1Array[9] = goal1;
listLength++; 
```

注意：您需要进行一些动态内存管理。查找 c 数组等。

最后，您可以遍历此列表以比较它们：

```
for (i = 0; i < listLength; i++) {
    /*compare stuff*/
} 
```

这只是一些一般性建议，您需要付出一些努力才能使其编译而不会出现内存错误。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:46:49.427

Make an array of ints with an int for each team. They will be your sums for each team.

Then, [strcmp](http://www.cplusplus.com/reference/cstring/strcmp/) the names of team1 and team2 with the names of your teams. Then, add the goals to their associated goalSum.

```
int goalSum[3];
goalSum[0] = 0;goalSum[1] = 0;goalSum[2] = 0

while (fscanf(ifp, "%d %d.%d.%d kl. %lf %4s - %4s %d - %d %lf\n", &runde, &dag, &month, &year, &clock, team1, team2, &goal1, &goal2, &attendance) == 10)
{

    //comparisions for the first team
    if(strcmp(team1,"nameofteam0")==0)
    {
            ++goalSum[0];
    }
    if(strcmp(team1,"nameofteam1")==0)
    {
            ++goalSum[1];
    }
    if(strcmp(team1,"nameofteam2")==0)
    {
            ++goalSum[2];
    }
    //comparisions for the second team
    if(strcmp(team2,"nameofteam0")==0)
    {
            ++goalSum[0];
    }
    if(strcmp(team2,"nameofteam1")==0)
    {
            ++goalSum[1];
    }
    if(strcmp(team2,"nameofteam2")==0)
    {
            ++goalSum[2];
    }
} 
```

Then, compare the goals of each team.

```
 const int numberOfTeams = 3;
    int winningTeam=0;

//You'll have to do the support for draws yourself.
    for(int i = 0; i<numberOfTeams; ++i)
    {
        if(sumOfGoal[i]>sumOfGoal[i+1])
        {
                winningTeam = i+1;
        }
        else
        {
                winningTeam = i+2;
        }
    }
    printf("Team%i wins!\n", winningTeam); 
```

# html - 如何对齐里面的东西？

> ID：13556665
> 
> 赞同：0
> 
> 时间：2012-11-25T23:24:00.940
> 
> 标签：html, css

 我这里有一个很好的菜单： 

[http://jsfiddle.net/y9jbQ/](http://jsfiddle.net/y9jbQ/)

```
<ul id="nav">
    <li>Menu 1
        <ul class="nav first">
            <li>Menu 1</li>
            <li>Menu 2</li>
            <li>Menu 3</li>
            <li>Menu 4
            <ul class="nav">
                <li>Menu 1</li>
                <li>Menu 2</li>
                <li>Menu 3</li>
                <li>Menu 4</li>
            </ul>
        </li>
        </ul>
    </li>
    <li>Menu 2</li>
    <li>Menu 3</li>
    <li>Menu 4</li>
</ul> 
```

现在的问题是，假设我想要一个右箭头图像，在有其他子菜单时对齐到右。放在里面不是健康的事情。我不想创造任何东西来复制 的行为。所以，

```
<li><a href="/something"><div float left><div float right></a></li> 
```

不是一个好办法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:27:19.107

Use a *[CSS Child Selector](http://www.w3.org/TR/CSS2/selector.html#child-selectors)*:

```
ul.root > li > a { /* css declarations */ } 
```

This will only apply the rules to the direct descendants of the root `ul` element.

* * *

**Illustration:**

```
<ul class="root">
    <li>
        <a href="#"><!-- MATCH --></a>
    </li>
    <li>
        <a href="#"><!-- MATCH --></a>
        <ul>
            <li>
                <a href="#"><!-- NO MATCH --></a>
            </li>
        </ul>
    </li>
</ul> 
```

# java - 为什么我没有从加速度计传感器获取数据？

> ID：13556668
> 
> 赞同：0
> 
> 时间：2012-11-25T23:24:28.303
> 
> 标签：java, android, accelerometer

**问题描述：**

我和我的朋友正在自学安卓开发。我们调试了其他类，比如游戏物理和手动更新的值，这使得大理石在我们的板上对角线。当我们将其改回读取加速度计数据时，弹珠停止移动。因此，我们将包括我们认为发生问题的类。基本上，我们在android开发中的视图类。

我们正在自学安卓开发，我们无法理解为什么来自加速度计的数据（我们称之为 mSensorX 和 mSensorY）没有更新。我们下面包含的是我们的视图类。请注意，我们正在为 android 3.1 开发。但是，我们在 Eclipse 中使用了来自 android 的所有最新功能。

```
package com.example.marblez;

import com.example.marblez.R;
import android.app.Activity;
import android.content.Context;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.util.Log;
import android.view.Display;
import android.view.KeyEvent;
import android.view.MotionEvent;
import android.view.Surface;
import android.view.View;
import android.view.WindowManager;

public class MarblezView extends View implements SensorEventListener{

//Sensor Stuff
private SensorManager mSensorManager;
private Display mDisplay;

//Accelerometer sensor stuff 
 private Sensor mAccelerometer;
 private float mSensorX;
 private float mSensorY;

 //Variables related to time 
 private long mCpuTimeStamp;
 private long mSensorTimeStamp;
 private WindowManager mWindowManager;

//Accelerometer buffer, such that slight movement will roll the marble 
private float sensor_buffer = 0;

//Create the canvas 
private Canvas mCanvas; 
private MarblezBackground background;

//Create the marble
private Marblez ball;

//Constructor for Marblez View 
@SuppressWarnings("deprecation")
public MarblezView(Context context, Activity activity){
    super(context);

    //Setup sensor stuff
    mSensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mWindowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
    mDisplay = mWindowManager.getDefaultDisplay();

    //Set up Maze 
    background = new MarblezBackground(activity);

    //Create our rolling little friend :-) 
    ball = new Marblez(activity);

}

 @Override
 public void onSensorChanged(SensorEvent event) {
     if (event.sensor.getType() != Sensor.TYPE_ACCELEROMETER)
         return;
     /*
      * record the accelerometer data, the event's timestamp as well as
      * the current time. The latter is needed so we can calculate the
      * "present" time during rendering. In this application, we need to
      * take into account how the screen is rotated with respect to the
      * sensors (which always return data in a coordinate space aligned
      * to with the screen in its native orientation).
      */

     switch (mDisplay.getRotation()) {
         case Surface.ROTATION_0:
             mSensorX = event.values[0];
             mSensorY = event.values[1];
             break;
         case Surface.ROTATION_90:
             mSensorX = -event.values[1];
             mSensorY = event.values[0];
             break;
         case Surface.ROTATION_180:
             mSensorX = -event.values[0];
             mSensorY = -event.values[1];
             break;
         case Surface.ROTATION_270:
             mSensorX = event.values[1];
             mSensorY = -event.values[0];
             break;
     }

     mSensorTimeStamp = event.timestamp;
     mCpuTimeStamp = System.nanoTime();
 }

//Automatic call
@Override
public void onDraw(Canvas canvas){
    mCanvas = canvas;

    //Draw the maze
    background.drawMaze(canvas);

    //Get the x and y sensor data and other goodies
    final long now = mSensorTimeStamp + (System.nanoTime() - mCpuTimeStamp);

    //Draw the marble 
    ball.drawMarble(canvas, mSensorX, mSensorY, now);

    //Invalidate so it draws again 
    invalidate();

}

@Override
public void onAccuracyChanged(Sensor sensor, int accuracy) {
}

} 
```

我们从一个名为 accelerometer play 的开源谷歌项目中获得了很多想法和方法。但是，熟悉该代码的人可以看到，我们竭尽全力尝试简化命名约定、方法和调用。

基本上，我们将感谢您的帮助。就像传感器“在那里”一样，但出于实际目的，它从未使用过。例如，当我们向它添加调试标记时，视图永远不会调用**onSensorChanged 方法，这很能说明问题。**因此，我们的加速度计确实无法正常工作的另一种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:29:56.380

您需要像这样在传感器管理器中注册您的实例：

```
mSensorManager.registerListener(this, mAccelerometer,
                                SensorManager.SENSOR_DELAY_NORMAL); 
```

# objective-c - 核心数据 NSTableView 不匹配

> ID：13556669
> 
> 赞同：0
> 
> 时间：2012-11-25T23:24:31.393
> 
> 标签：objective-c, core-data, nstableview, osx-mountain-lion

我在使用 Core Data 时遇到问题。我有一个将数据链接到 NSTableView 的数组控制器设置。

我有一个每隔几秒钟运行一次代码的函数，并在其中显示文件列表

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"File"
                                          inManagedObjectContext:[self managedObjectContext]];

[request setEntity:entity];
NSError *error = nil;

NSArray *fetchedObjects =[_managedObjectContext executeFetchRequest:request
                                                              error:&error];

for (NSManagedObject *objectt in fetchedObjects) {
    NSLog(@"Object Name: %@", [objectt valueForKey:@"filename"]);
}
NSManagedObject *object = [fetchedObjects objectAtIndex:index];

NSLog(@"Filename: %@, Index: %ld", [object valueForKey:@"filename"], index);
NSString *imageName = [object valueForKey:@"imageName"];
NSImage *image = [object valueForKey:@"taggedImage"]; 
```

第一次运行此代码时，列表与表列匹配。当它再次运行时，从数组控制器获取的内容发生了变化，但 tableview 没有。所以它不再同步。

表和数组的同一索引处的值不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:54:08.650

您是否手动检查`NSArrayController`过它是否同步？这会将问题缩小到`NSArrayController`配置错误或 NSTableView 配置错误。您的声明声称您正在查看，`NSArrayController`但是当您使用 fetched 这个词时，我担心您会混淆这些对象。

此外，数据是处于已保存状态还是仍处于未保存状态？该问题也会影响`NSArrayController`和的显示`NSTableView`。

# bash - 如何将文本块添加到所有子目录中的所有 PHP 文件？

> ID：13556671
> 
> 赞同：1
> 
> 时间：2012-11-25T23:25:04.240
> 
> 标签：bash, shell, command-line, command

我有一个 PHP 脚本，我需要在顶部添加我的版权。我只是希望它出现在之后

以下是需要添加的内容：

```
/**
 * MySoftware
 *
 * This file is part of MySoftware.
 *
 * MySoftware is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MySoftware is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with MySoftware.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright   Copyright MySoftware
 * @license     GNU Public License V3.0
*/ 
```

如果可以在上述消息之前和之后添加一个空行，那将是很棒的，这样如果可能的话，它会在每个文件中更加突出。

将它添加到我所有 php 文件顶部的最快方法是什么？有几百个，我已经将它们全部移动到一个主文件夹/子文件夹中，所以我认为可以使用命令行递归运行某些东西，将其添加到每个文件夹的顶部。

如果有人可以通过命令行或任何其他方法发布如何执行此操作的示例脚本/代码，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T03:22:58.977

将您的文本保存到文件中，例如`/tmp/header`，然后运行以下脚本。

```
DIR=/your/php/files/dir
for f in $(find ${DIR} -iname "*.php" -type f 2>/dev/null) ; do
    cat /tmp/header "${f}" > /tmp/tmp_file || continue
    /bin/mv /tmp/tmp_file "${f}"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:28:14.937

```
#!/bin/bash
text="Hello world
What's up?"

exec 3<> $1 && awk -v TEXT="$text" 'BEGIN {print TEXT}{print}' $1 >&3 
```

试试看。

# php - PHP 分页 fetchAll() 和 LIMIT

> ID：13556676
> 
> 赞同：1
> 
> 时间：2012-11-25T23:25:54.627
> 
> 标签：php, mysql, pagination, limit, fetchall

此代码在第一页上运行良好，但似乎 LIMIT 不会影响 FetchAll()。所以我的问题是： fetchAll() 是否有一些限制行数的可选参数？或者建议我解决这个问题的更好方法。

```
<html>
<body>
<?php
require_once('connection.php');
$rowsCount = $connection->query('SELECT COUNT(*) FROM test')->fetchColumn();
$page = 1;
$perPage = 10;
if ( isset( $_GET["page"] ) and $_GET["page"] >= 1 and $_GET["page"] <= 10 ) {
    $page = (int) $_GET["page"];
  }
$beginning = ($page-1) * $perPage;
$end = $page * $perPage;
$sql = "SELECT * FROM test LIMIT $beginning, $end";

?>
<table border = '2'>
<tr>
    <th width="30%">ID</th>
    <th width="70%">TEXT</th>
</tr>
<?php
// echo '<pre>';
// print_r($connection->query($sql)->fetch());
// echo $sql;
// echo '<pre>';
foreach ($connection->query($sql) as $value) {
    echo '<tr height ="50px"><td>' . $value['id'] . '</td><td>' .   $value['text'] . '</td></tr>';
}
?>
</table>
    <p>
    <?php if($page > 1){ ?>
        <a href="pagination.php?page=<?php echo $page-1;?>" >Previous</a>
    <?php } ?>
        <a href="pagination.php?page=<?php if($page < ceil($rowsCount/$perPage)){ echo $page+1;} else {echo 1;}?>" >Next</a>
    </p>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:30:12.233

语法不是`LIMIT beginning, end`，而是`LIMIT beginning, maxrows`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:44:19.573

更正这一行：

```
$end = $page * $perPage; 
```

和：

```
$end = $perPage; 
```

或将您的 sql 字符串更改为：

```
$sql = "SELECT * FROM test LIMIT $beginning, $perPage"; 
```

# java - 从 netbeans 中的 appletviewer 与另一个项目中的 serlet 通信

> ID：13556681
> 
> 赞同：1
> 
> 时间：2012-11-25T23:26:22.803
> 
> 标签：java, servlets, netbeans, web, applet

我在netbeans中有两个项目。一个与我的 web 和我的 servlet 一起使用。第二个项目名为 Applet，包含我的小程序（自签名小程序）和他需要工作的类。小程序通过打包选项添加到 Web 项目中，并且在浏览器中运行良好。我有一个方法可以打开 URLconnection 到 servlet 并发送 GET 请求，servlet 发送响应，然后我将 aplet 中的 inputStream 获取到 jLabel 文本。在浏览器中一切正常，但是当我在 Appletviewer 中尝试它时，它会触发异常，并且在 HTTP 服务器监视器中没有出现对服务器的新 GET 请求，这应该在 UrlConnection.getInputstream() 完成时发生。那是我的问题吗？那么是否存在从 Appletviewer 连接到 servlet 的任何解决方案？

这是我从servlet获取文本的方法

```
 URL url = null;
        try {
            url = new URL("http://localhost:8084/Rozhlas_jsf/SoundServlet?name=startSounds");
        } catch (MalformedURLException ex) {
            Logger.getLogger(SoundApplet.class.getName()).log(Level.SEVERE, null, ex);
        }

// open a connection to the servlet
URLConnection servletConnection=null;
        try {
            servletConnection = url.openConnection();
            servletConnection.setDoInput(true);
            servletConnection.setDoOutput(true);
        } catch (IOException ex) {
            Logger.getLogger(SoundApplet.class.getName()).log(Level.SEVERE, null, ex);
        }

        try {
            // get the input stream from the servlet
            InputStream in = servletConnection.getInputStream();
           jLabel1.setText(convertStreamToString(in)) ;

        } catch (IOException ex) {
            Logger.getLogger(SoundApplet.class.getName()).log(Level.SEVERE, null, ex);
        } 
```

这是我在小程序查看器中尝试时发生的情况

```
 compile-single:
run-applet:
Exception in thread "AWT-EventQueue-1" java.security.AccessControlException: access denied ("java.net.SocketPermission" "localhost:8084" "connect,resolve")
    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)
    at java.security.AccessController.checkPermission(AccessController.java:555)
    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
    at java.lang.SecurityManager.checkConnect(SecurityManager.java:1051)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:466)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:213)
    at sun.net.www.http.HttpClient.New(HttpClient.java:300)
    at sun.net.www.http.HttpClient.New(HttpClient.java:316)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:992)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:928)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:846)
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1296)
    at SoundApplet.SoundApplet.jButton5ActionPerformed(SoundApplet.java:683)
    at SoundApplet.SoundApplet.access$200(SoundApplet.java:44)
    at SoundApplet.SoundApplet$3.actionPerformed(SoundApplet.java:184)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6505)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6270)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4861)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90) 
```

问题解决了！！！

我今天早上尝试更改 applet.policy 文件，因为我试图解决这个问题 [我的另一个问题](https://stackoverflow.com/questions/13547986/self-signed-applet-running-in-browser-cant-copy-files-write-by-writer-encode)

我覆盖了这个

```
grant {

permission java.security.AllPermission;
}; 
```

这样

```
 grant {

    permission java.io.FilePermission "<<ALL FILES>>","write";
    }; 
```

通过它，我失去了从 appletviewer 连接我的 Servlet 的权限。我只是将其重写回来，一切都很好。对不起，不必要的话题，但我真的很生气。

# php - Codeigniter 更新表单

> ID：13556685
> 
> 赞同：0
> 
> 时间：2012-11-25T23:26:50.637
> 
> 标签：php, codeigniter, expressionengine

我真的是 CI 新手，今天一直在尝试创建一个更新表单类，但我遇到了死胡同。我已经设置了创建表单并将数据发布到数据库的功能，我现在需要能够更新它。

我的编辑表单功能如下：

```
public function edit_event()
{

    $vars = array();

    $data['form_url'] = $this->form_url;

    if ($form_id = $this->EE->input->get('form_id'))
    {
        $data['form_id'] = $form_id;
    }

    return $this->EE->load->view('edit_event', $data, TRUE);
} 
```

并且函数中加载的edit_event文件是：

```
<?php

    $this->EE=& get_instance();

    $this->load->helper('form');

        $attributes = array('class' => 'event_form', 'id' => 'my_event_form');

    echo form_open($form_url.AMP.'method=update_form', $attributes);

        $this->EE->load->library('table');
        $this->EE->table->set_heading(
            'Preference',
            'Setting'
        );

        $query = $this->EE->db->query("SELECT * FROM exp_events WHERE id = '$form_id'");

        foreach($query->result_array() as $row)
            {

                $this->EE->table->add_row(
                    form_label('Application Key', 'app_key'),
                    form_input('app_key',$row['app_key'])
                );

                $this->EE->table->add_row(
                    form_label('Access Token', 'access_token'),
                    form_input('access_token',$row['access_token'])
                );

                $this->EE->table->add_row(
                    form_label('User Key', 'user_key'),
                    form_input('user_key',$row['user_key'])
                );

            }

        echo $this->EE->table->generate();

        echo form_reset('reset', 'Clear Form');
        echo form_submit('mysubmit', 'Submit Post!');

    echo form_close();

?> 
```

然后我有我的更新表单功能：

```
public function update_form()

{

    $form_id = $this->EE->input->get('form_id');

    $data['form_id'] = $form_id;

    $form_data = array(
        'app_key'        => $this->EE->input->post('app_key'),
        'access_token'   => $this->EE->input->post('access_token'),
        'user_key'       => $this->EE->input->post('user_key')
    );

    $this->EE->db->where('id', $form_id);       
    $this->EE->db->update('exp_events', $form_data);

    $this->EE->functions->redirect($this->base_url);

} 
```

删除 $form_if 选项时，我可以获得要更新的数据，但它会针对数据库中的每个项目进行更新。我显然需要这个来仅使用正在编辑的表单的表单 ID 更新数据。

就目前而言，当我提交更新表单时，我被重定向到我的 $base_url 这是正确的，但没有数据得到更新，因此我在定义表单 ID 时显然做错了什么？

正如我所说，我是新手，所以如果有人注意到任何首选方法，请随时告诉我:)。

任何指针表示赞赏。

提前致谢。

本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T03:00:24.023

您需要在表单中包含一个带有 form_id 的“隐藏”字段。目前你的'form_id'不是你输入的一部分，所以当你去获取form_id时它失败了。

改变

```
 echo $this->EE->table->generate();
    echo form_reset('reset', 'Clear Form');
    echo form_submit('mysubmit', 'Submit Post!'); 
```

到

```
 echo $this->EE->table->generate();
    echo form_hidden('form_id', $form_id);
    echo form_reset('reset', 'Clear Form');
    echo form_submit('mysubmit', 'Submit Post!'); 
```

# vb.net - 使用文件名过滤器查找文件

> ID：13556690
> 
> 赞同：0
> 
> 时间：2012-11-25T23:27:36.660
> 
> 标签：vb.net, list, search, visual-studio-2012, filtering

我正在使用 VB.net VS2012 并且无法获取带有过滤器的文件列表。

这是我的代码：

```
Public Function SearchAndAddToListWithFilter(ByVal path As String, ByVal Recursive As Boolean, arrayListOfFilters As ArrayList, ByRef listOfFiles As List(Of FileInfo))
    If Not Directory.Exists(path) Then Exit Function

    Dim initDirInfo As New DirectoryInfo(path)

    For Each oFileInfo In initDirInfo.GetFiles
        Application.DoEvents()
        For x = 0 To arrayListOfFilters.Count - 1
            If (oFileInfo.Name Like arrayListOfFilters(x)) Then
                listOfFiles.Add(oFileInfo)
            End If
        Next
    Next

    If Recursive Then
        For Each oDirInfo In initDirInfo.GetDirectories
            SearchAndAddToListWithFilter(oDirInfo.FullName, True, arrayListOfFilters, listOfFiles)
        Next
    End If

End Function 
```

这是一个如何使用它的示例：

```
 Dim stringFilterList As String = "*.mp3, *.docx, *.mp3, *.txt"
    Dim arrayListOfFilenameFilters As New ArrayList(stringFilterList.Split(","))
    Dim stringFolderPath As String = "C:\temp\folder\"
    Dim booleanSearchSubFolders As Boolean = True

    Dim listOfFilesFoundViaSearch As New List(Of FileInfo)
    SearchAndAddToListWithFilter(stringFolderPath, booleanSearchSubFolders, arrayListOfFilenameFilters, listOfFilesFoundViaSearch)

    For x = 0 To listOfFilesFoundViaSearch.Count - 1
        MsgBox(listOfFilesFoundViaSearch(x).FullName)
    Next 
```

出于某种原因，代码仅将文件添加到满足过滤器列表中第一个条件的列表中。

我可以请一些帮助以使此代码正常工作吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T07:31:28.287

函数返回值，传递值 ByRef 不是这样做的方法。

以下功能将起作用：

```
Private Function SearchAndAddToListWithFilter(ByVal path As String, ByVal filters As String(), ByVal searchSubFolders As Boolean) As List(Of IO.FileInfo)
    If Not IO.Directory.Exists(path) Then
        Throw New Exception("Path not found")
    End If

    Dim searchOptions As IO.SearchOption
    If searchSubFolders Then
        searchOptions = IO.SearchOption.AllDirectories
    Else
        searchOptions = IO.SearchOption.TopDirectoryOnly
    End If

    Return filters.SelectMany(Function(filter) New IO.DirectoryInfo(path).GetFiles(filter, searchOptions)).ToList
End Function 
```

并使用此功能：

```
Dim filters As String() = {"*.mp3", "*.docx", "*.bmp", "*.txt"}
Dim path As String = "C:\temp\folder\"

Dim foundFiles As List(Of IO.FileInfo) = SearchAndAddToListWithFilter(path, filters, True) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-13T15:19:15.490

@Steve 提供的解决方案真正展示了 .NET 完成任务的方式。但是，我使用了可能定义最大深度和/或持续时间的递归解决方案。为了这个主题的完整性，我想发布代码：

```
''' <summary>
''' Search files in directory and subdirectories 
''' </summary>
''' <param name="searchDir">Start Directory</param>
''' <param name="searchPattern">Search Pattern</param>
''' <param name="maxDepth">maximum depth; 0 for unlimited depth</param>
''' <param name="maxDurationMS">maximum duration; 0 for unlimited duration</param>
''' <returns>a list of filenames including the path</returns>
''' <remarks>
''' recursive use of   Sub dirS
''' 
''' wallner-novak@bemessung.at
''' </remarks>
Public Shared Function dirRecursively(searchDir As String, searchPattern As String, _
                                    Optional maxDepth As Integer = 0, _
                                    Optional maxDurationMS As Long = 0) As List(Of String)
    Dim fileList As New List(Of String)
    Dim depth As Integer = 0
    Dim sw As New Stopwatch

    dirS(searchDir, searchPattern, maxDepth, maxDurationMS, fileList, depth, sw)

    Return fileList

End Function

''' <summary>
''' Recursive file search
''' </summary>
''' <param name="searchDir">Start Directory</param>
''' <param name="searchPattern">Search Pattern</param>
''' <param name="maxDepth">maximum depth; 0 for unlimited depth</param>
''' <param name="maxDurationMS">maximum duration; 0 for unlimited duration</param>
''' <param name="fileList">Filelist to append to</param>
''' <param name="depth">current depth</param>
''' <param name="sw">stopwatch</param>
''' <param name="quit">boolean value to quit early (at given depth or duration)</param>
''' <remarks>
''' wallner-novak@bemessung.at
''' </remarks>
Private Shared Sub dirS(searchDir As String, searchPattern As String, _
                            Optional maxDepth As Integer = 0, _
                            Optional maxDurationMS As Long = 0, _
                            Optional ByRef fileList As List(Of String) = Nothing, _
                            Optional ByRef depth As Integer = 0, _
                            Optional ByRef sw As Stopwatch = Nothing, _
                            Optional ByRef quit As Boolean = False)

    If maxDurationMS > 0 Then
        If depth = 0 Then
            sw = New Stopwatch
            sw.Start()
        Else
            If sw.ElapsedMilliseconds > maxDurationMS Then
                quit = True
                Exit Sub
            End If
        End If
    End If

    If maxDepth > 0 Then
        If depth > maxDepth Then
            quit = True
            Exit Sub
        End If
    End If

    ' check if directory exists
    If Not Directory.Exists(searchDir) Then
        Exit Sub
    End If

    ' find files
    For Each myFile As String In Directory.GetFiles(searchDir, searchPattern)
        fileList.Add(myFile)
    Next

    ' recursively scan subdirectories 
    For Each myDir In Directory.GetDirectories(searchDir)
        depth += 1
        dirS(myDir, searchPattern, maxDepth, maxDurationMS, fileList, depth, sw, quit)
        If quit Then Exit For
        depth -= 1
    Next

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-24T04:02:00.577

ListView1.Items.Clear()

```
 For Each files As String In System.IO.Directory.GetFiles(cmb_Drives.SelectedItem.ToString, txtSearch.Text)

            Dim ico As Icon = System.Drawing.Icon.ExtractAssociatedIcon(files)
            ImageList1.Images.Add(ico)

            Dim list As ListViewItem = New ListViewItem(My.Computer.FileSystem.GetFileInfo(files).FullName, ImageList1.Images.Count - 1)
            ListView1.Items.Add(list)

        Next 
```

# javascript - jQuery - 如何根据具有“选定”类的项目更改背景颜色

> ID：13556691
> 
> 赞同：1
> 
> 时间：2012-11-25T23:27:42.807
> 
> 标签：javascript, jquery, class, background, navigation

我有这个带有颜色选项列表的菜单。其中一种颜色是“蓝色”并且有一类“选定”，我的背景颜色是“蓝色”。我想根据选择的颜色类别来更改背景颜色。我已经知道如何更改类，但现在我想知道如何用协调颜色识别“选定”类。

这是我的代码：

**jQuery** :

```
var coorColor;
$(".item").click(function() {
    $(".item").removeClass("selected");
    $(this).addClass("selected");
    $("body").css("background", coorColor);
});

// THIS IS THE PART I NEED HELP WITH

if($(".item.red.selected")) {
    coorColor = "red";
}

if($(".item.green.selected")) {
    coorColor = "green";
}

etc... 
```

**HTML：**

```
<ul>
    <li class="item blue selected">Blue</li>
    <li class="item red">Red</li>
    <li class="item green">Green</li>
</ul> 
```

**CSS：**

```
/* because the item "blue" is selected by default the body's bg-color is blue by default but will change according to jQuery */

body {
    background: blue;
}

.selected {
    text-shadow: 1px 1px 10px #565756;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:31:47.200

您可以检查所选元素中的类：

```
$(".item").click(function() {
  $(".item").removeClass("selected");
  $(this).addClass("selected");

  if ($(this).hasclass("blue")) {
    coorColor = "blue";
  } else if ($(this).hasclass("red") {
    coorColor = "red";
  }

  $("body").css("background", coorColor);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:35:32.197

一个稍微简单的方法是使用`data-`属性：

```
<ul>
    <li data-color="blue"  class="item blue selected">Blue</li>
    <li data-color="red"   class="item red">Red</li>
    <li data-color="green" class="item green">Green</li>
</ul> 
```

您的代码将变为：

```
var coorColor = $('.item.selected').data('color'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:47:37.310

如果你打算只为项目提供这些类，你可以这样做

```
$(".item").click(function() {
    $(".item").removeClass("selected");

    /* this will eliminate the unwanted classes leaving just the color class */
    var coorColor = $(this).attr('class').replace(new RegExp('item|anotherClass| ', 'g'), '');

    $(this).addClass("selected");
    $("body").css("background", coorColor);
}); 
```

# wpf - WPF 在 ModelVisual3D 中绘制文本

> ID：13556697
> 
> 赞同：0
> 
> 时间：2012-11-25T23:28:33.283
> 
> 标签：wpf, text, 3d

我正在创建 WPF 应用程序，我在其中绘制点云。点被制成小立方体。我想用每个“立方体点”附近的数字（例如 1、2、3、...）对索引进行签名，所以我想将文本添加到我的 3D 视图中。

这是我的 xaml 部分：

```
 <ModelVisual3D x:Name="model">
            <ModelVisual3D.Content>
                <Model3DGroup x:Name="group">
                    <AmbientLight Color="DarkGray" />
                    <DirectionalLight Color="White" Direction="-5,-5,-7" />
                </Model3DGroup>
            </ModelVisual3D.Content>
        </ModelVisual3D> 
```

在代码隐藏中，我将 GeometryModel3D（使用网格立方体点构建）添加到 Model3DGroup（命名为“组”）。

我尝试使用此代码：[http](http://www.ericsink.com/wpf3d/4_Text.html) ://www.ericsink.com/wpf3d/4_Text.html 但这是非常低效的方式，当我生成并显示大约 7000 个（立方体点数）这样的文本块时，一切都运行缓慢。

您知道如何以更有效的方式添加一些文本吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-20T00:59:12.303

当然！关于大多数 WPF 3D 功能的最佳资源位于 1\. Petzold Ch。书：Windows 2 的 3D 编程。Jack Xu。实用的 WPF 图形编程

采用 WPF 3D 文本功能的最简单方法是使用第一本检测到的书 [http://www.microsoft.com/mspress/companion/9780735623941/中的代码](http://www.microsoft.com/mspress/companion/9780735623941/)

# javascript - 带有javascript_include_tag的rails 3.2.8引擎中的ExecJS :: RuntimeError

> ID：13556699
> 
> 赞同：0
> 
> 时间：2012-11-25T23:28:34.883
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3, execjs

我们将两个 rails 3.2.8 引擎放在一个 rails 应用程序中。问题是 ExecJS 不喜欢布局文件中 javascript_inclide_tag 的命名空间。这是导致错误的标签：

```
<%= javascript_include_tag 'authentify/application' %> 
```

这里 authentify 是 rails 引擎名称。错误是：

```
ExecJS::RuntimeError in Authentify/sessions#new 
Showing C:/D/code/rails_proj/engines/authentify/app/views/layouts/sessions.html.erb where line #6 raised: 

  (in C:/D/code/rails_proj/engines/authentify/app/assets/javascripts/authentify/sessions.js.coffee)
Extracted source (around line #6): 
3: <head>
4:   <title>Login</title>
5:   <%= stylesheet_link_tag    "authentify/application" %>
6:   <%= javascript_include_tag "authentify/application" %>
7:   <%= csrf_meta_tags %>
8: </head>
9: 
```

如果我们删除命名空间 authentify ( `<%= javascript_include_tag "application" %>`)，那么 ExecJS 错误就会消失，rails 应用程序可以正常工作。另一个带有 js 标签的 rails 引擎也有同样的错误。

我们使用的是windows环境。什么可能导致错误？谢谢您的帮助。

更新：

在用于身份验证的 engine.rb 中，每个 js 库都被列为：

```
initializer "Authentify precompile hook", :group => :all do |app|
      app.config.assets.precompile += [
        'authentify/application.css.scss', 'authentify/layout.css.scss', 'authentify/login.css.scss', 
        'authentify/paginate.css.scss', 'authentify/sessions.css.scss', 'authentify/sys_logs.css.scss', 
        'authentify/toolbar.css.scss', 'authentify/user_level_group_map.css', 'authentify/user_menus.css.scss', 
        'authentify/users.css.scss', 'authentify/application.js', 'authentify/sessions.js.coffee', 
        'authentify/sys_logs.js.coffee', 'authentify/user_level_group_map.js', 'authentify/user_menus.js.coffee', 
        'authentify/users.js']

    end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T10:33:54.530

看到这个问题：[Using javascript_include_tag with a Subfolder full of JS](https://stackoverflow.com/questions/6948182/using-javascript-include-tag-with-a-subfolder-full-of-js)

您可以为每个引擎设置一个初始化程序吗？在这种情况下，您可以：

一个初始化器（称为它`authentify`） - 例如 authentify.rb 作为引擎 A 的一个初始化器：

```
ActionView::Helpers::AssetTagHelper.register_javascript_expansion :authentify => Dir["#{Rails.root.to_s}/public/javascripts/authentify/*.js"].each {|js| js.gsub!("#{Rails.root.to_s}/public/javascripts/",'')} 
```

另一个的初始化器（称为它`authentify2`） - 例如 authentify2.rb 作为引擎 B 的一个初始化器：

```
ActionView::Helpers::AssetTagHelper.register_javascript_expansion :authentify2 => Dir["#{Rails.root.to_s}/public/javascripts/authentify2/*.js"].each {|js| js.gsub!("#{Rails.root.to_s}/public/javascripts/",'')} 
```

然后你可以拥有：

```
<%= javascript_include_tag :authentify %> 
```

在一个布局中，并且：

```
<%= javascript_include_tag :authentify2 %> 
```

在另一个中，只需删除`<%= javascript_include_tag 'authentify/application' %>`布局中的 以及`javascript_include_tag`其他引擎的其他标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T00:48:54.227

问题是 execjs 在 Windows 8 上不起作用。这是一篇[关于](https://github.com/sstephenson/execjs/issues/81)如何进入 execjs 运行时并在 Windows 8 上修复它的帖子。

# java - Java 要求覆盖 jfilechooser

> ID：13556700
> 
> 赞同：1
> 
> 时间：2012-11-25T23:28:36.777
> 
> 标签：java, swing, file, jfilechooser, overwrite

我有一个函数应该获取在 a 的文本输入中键入的文件的路径`jfilechooser`并将其传递给 a `String`。问题是如果文件已经存在，我想检查是否覆盖。我确实知道如何执行此操作，但我的问题是，如果对 回答不，**无论如何**都会关闭，因为保存按钮已经被操作。现在，我需要的是，如果答案是**否定**的，程序返回到，仍然提示输入名称。 `JOptionPane``JFileChooser`**`JFileChooser`**

 **请注意，我正在寻找一个有效的解决方案，我已经考虑过再次执行该功能，但是由于我的程序很大，因此这种解决问题的方法会花费时间并且效率不高。

这是我的函数的代码，尚未完成，因为我不知道如何处理它。

```
`public String FileSavePath()throws NullPointerException
    {
        File f=null;
        String theFilepath=null;
        JFileChooser FileChooser = new JFileChooser();
        if(FileChooser.showSaveDialog(null)==JFileChooser.APPROVE_OPTION)
        {
            theFilepath=FileChooser.getSelectedFile().getAbsolutePath();
            f=FileChooser.getSelectedFile();
            //System.out.println(theFile);
            if(f.exists())
            {
                int result = JOptionPane.showConfirmDialog(this,"The file exists, overwrite?",
                        "Existing file",JOptionPane.YES_NO_CANCEL_OPTION);
                if(result==JOptionPane.YES_OPTION)
                           {
                   return theFilepath;

                  }
          else // here is what I should do if the user answers 'no' or cancels/closes the JOptionPane
        }
        else return null;
        return theFilepath;

    }` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:42:04.467

您需要将查询放入循环中，直到用户可以为您提供可接受的响应...

```
public String FileSavePath() throws NullPointerException {

    boolean acceptable = false;
    String theFilepath = null;

    do {
        theFilepath = null
        File f = null;
        JFileChooser FileChooser = new JFileChooser();
        if (FileChooser.showSaveDialog(null) == JFileChooser.APPROVE_OPTION) {
            theFilepath = FileChooser.getSelectedFile().getAbsolutePath();
            f = FileChooser.getSelectedFile();
            //System.out.println(theFile);
            if (f.exists()) {
                int result = JOptionPane.showConfirmDialog(this, "The file exists, overwrite?",
                        "Existing file", JOptionPane.YES_NO_CANCEL_OPTION);
                if (result == JOptionPane.YES_OPTION) {
                    acceptable = true;
                }
            } else {
                acceptable = true;
            }
        } else {
            acceptable = true;
        }
    } while (!acceptable);

    return theFilepath;

} 
```**

# sockets - ConnectAsync 阻塞 UI 线程

> ID：13556701
> 
> 赞同：2
> 
> 时间：2012-11-25T23:28:43.827
> 
> 标签：sockets, tcp, windows-runtime, block, async-await

我有一个简单的 WinRT 应用程序，它将通过 TCP 与远程服务器通信。

为了做到这一点，我正在创建新的 StreamSocket 对象，并在单击适当的按钮后连接到远程服务器，如下所示：

```
private async void ConnectButtonClick(object sender, RoutedEventArgs e)
{
    StreamSocket socket = new StreamSocket();
    HostName host = new HostName("192.168.1.15");
    await socket.ConnectAsync(host, "12121");
} 
```

问题是这段代码阻塞了 UI 线程。我创建了简单的动画，使用在屏幕上连续运行的 MonoGame（几个移动的精灵），以检查 UI 是否被阻塞。

问题是，单击连接按钮后，动画会冻结一秒钟，所以我假设连接到服务器是在 UI 线程中进行的。

我应该把我的整个网络代码放到一个单独的线程中，还是这个 async/await 就足够了？

我想实现一个循环，它将处理传入的数据（在 DataReader 的帮助下），如下所示：

```
private async void ReceiveLoop()
{
    bool running = true;

    while (running)
    {
        try
        {
            uint numStrBytes = await _reader.LoadAsync(BufferSize);

            if (numStrBytes == 0)
            {
                Disconnect();
                return;
            }

            string msg = _reader.ReadString(numStrBytes);

            OnLog(string.Format("Received: {0}", msg));
            OnDataReceived(msg);
        }
        catch (Exception exception)
        {
            OnLog("Receive failed with error: " + exception.Message);

            Disconnect();
            running = false;
        }
    }
} 
```

发送数据将使用 DataWriter 中的 StoreAsync 完成。

那么我应该将这些函数放入单独的线程中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-04T19:40:03.160

对于普通 .net 库中的任何异步调用，一般规则是使用 ConfigureAwait(false)，这有助于防止出现您所看到的问题。因此，例如在 WinRT 的东西中，它将是：

await socket.ConnectAsync(host, "12121").AsTask().ConfigureAwait(false);

这有一些很好的信息：http: [//blogs.msdn.com/b/windowsappdev/archive/2012/04/24/diving-deep-with-winrt-and-await.aspx](http://blogs.msdn.com/b/windowsappdev/archive/2012/04/24/diving-deep-with-winrt-and-await.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T06:32:28.130

您不能尝试在后台线程上执行此操作以查看是否有帮助吗？像这样的东西：

```
Task.Run(
    async () =>
    {
        StreamSocket socket = new StreamSocket();
        HostName host = new HostName("192.168.1.15");
        await socket.ConnectAsync(host, "12121");
    }); 
```

# ruby-on-rails - rails导入数据文件..讨论话题

> ID：13556702
> 
> 赞同：0
> 
> 时间：2012-11-25T23:29:07.630
> 
> 标签：ruby-on-rails, csv, import

讨论问题：

我有一个 CSV 文件，我通过 rails 应用程序将其导入到我的数据库中。

如果由于某种原因导入在中途停止，文件已被标记为正在导入，因此它不会再次导入，但它并不完整。

有人建议我采取的第一步是将文件数据导入表中，然后我可以处理记录，如果过程停止，我可以从中断的地方继续。我看到的问题是当前存储为 zip 的文件数据将被分解到数据库中，占用的空间比它需要的要多。我目前还为每次导入生成一个文件 (response.csv)，其中包含原始数据，但带有响应。

我想知道其他人是如何处理这个问题的。导入大量数据的“rails”方式是什么？什么是最佳做法..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T20:00:59.877

任何一个：

*   分别导入每一行，以便您可以从离开的地方拿起
*   使用事务，以便在操作完成之前不会将更改提交到数据库

# python - 数组元素操作

> ID：13556703
> 
> 赞同：17
> 
> 时间：2012-11-25T23:29:10.487
> 
> 标签：python, arrays, numpy, elementwise-operations

我有两个相同形状的输入数组 x 和 y。我需要通过函数运行具有匹配索引的每个元素，然后将结果存储在第三个数组 z 中的这些索引处。完成此任务的最蟒蛇方式是什么？现在我有四个四个循环 - 我确信有一个更简单的方法。

```
x = [[2, 2, 2],
     [2, 2, 2],
     [2, 2, 2]]

y = [[3, 3, 3],
     [3, 3, 3],
     [3, 3, 1]]

def elementwise_function(element_1,element_2):
    return (element_1 + element_2)

z = [[5, 5, 5],
     [5, 5, 5],
     [5, 5, 3]] 
```

我很困惑，因为我的函数只适用于单个数据对。我不能简单地将 x 和 y 数组传递给函数。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-25T23:45:10.353

一种“更简单的方法”是使用[`numpy.vectorize`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.vectorize.html). “ufunc”是元素函数的 NumPy 术语（请参阅[此处](http://docs.scipy.org/doc/numpy/reference/ufuncs.html)的文档）。Using`numpy.vectorize`允许您使用逐个元素的函数来创建自己的 ufunc，其工作方式与其他 NumPy ufunc（如标准添加等）相同：ufunc 将接受数组并将您的函数应用于每对元素，它将像标准 NumPy 函数等一样进行数组形状广播。[文档页面](http://docs.scipy.org/doc/numpy/reference/generated/numpy.vectorize.html)有一些可能有用的使用示例。

```
In [1]: import numpy as np
   ...: def myfunc(a, b):
   ...:     "Return 1 if a>b, otherwise return 0"
   ...:     if a > b:
   ...:         return 1
   ...:     else:
   ...:         return 0
   ...: vfunc = np.vectorize(myfunc)
   ...: 

In [2]: vfunc([1, 2, 3, 4], [4, 3, 2, 1])
   ...: 
Out[2]: array([0, 0, 1, 1])
In [3]: vfunc([1, 2, 3, 4], 2)
   ...: 
Out[3]: array([0, 0, 1, 1]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-25T23:48:54.530

（我猜你在谈论简单的python `list`，而不是`numpy.array`）

递归总是让我们的生活更轻松：

```
def operate_on_Narray(A, B, function):
    try:
        return [operate_on_Narray(a, b, function) for a, b in zip(A, B)]
    except TypeError as e:
        # Not iterable
        return function(A, B) 
```

用法：

```
>>> x = [[2, 2, 2],
...      [2, 2, 2],
...      [2, 2, 2]]
>>> 
>>> y = [[3, 3, 3],
...      [3, 3, 3],
...      [3, 3, 1]]
>>> operate_on_Narray(x, y, lambda a, b: a+b)
[[5, 5, 5], [5, 5, 5], [5, 5, 3]] 
```

它适用于任何其他类型的维度数组：

```
>>> operate_on_Narray([1, 2, 3], [4, 5, 6], lambda a, b: a*b)
[4, 10, 18] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T00:02:08.240

以下来自 python 2.7.3 解释器会话的记录说明了使用内置函数`map`将元素操作应用于 2D 矩阵元素。（注：`operator.add`等同于`elementwise_function`指定的问题，也等同于第二次使用中的lambda表达式`applier`。）

```
>>> import operator
>>> def applier(a, b, op):
...     return map(lambda ro: map(op, ro[0], ro[1]), zip(a,b))
... 
>>> applier(x, y, operator.add)
[[5, 5, 2], [5, 4, 5], [6, 5, 5]]
>>> x; y
[[2, 2, 1], [2, 2, 2], [3, 2, 2]]
[[3, 3, 1], [3, 2, 3], [3, 3, 3]]
>>> applier(x, y, lambda p,q: p+q)
[[5, 5, 2], [5, 4, 5], [6, 5, 5]]
>>> applier(x, y, lambda p,q: p-q)
[[-1, -1, 0], [-1, 0, -1], [0, -1, -1]]
>>> applier(x, y, lambda p,q: p*q)
[[6, 6, 1], [6, 4, 6], [9, 6, 6]] 
```

注意，上面有x，y如下：

```
x=[[2, 2, 1], [2, 2, 2], [3, 2, 2]]
y=[[3, 3, 1], [3, 2, 3], [3, 3, 3]] 
```

如前所述，上面的文字记录来自 python 2.7.3 解释器会话。如果此代码在 python 3 中运行，它将改为返回地图对象。可以使用如下函数来查看数字：

```
def itemize(m):
    return [itemize(e) for e in m] if hasattr(m, '__iter__') else m 
```

有了这个功能，声明

```
itemize(applier(x, y, operator.add)) 
```

返回

```
[[5, 5, 2], [5, 4, 5], [6, 5, 5]] 
```

# java - 使用优先队列的 Prims 算法的复杂性？

> ID：13556705
> 
> 赞同：8
> 
> 时间：2012-11-25T23:29:22.920
> 
> 标签：java, algorithm, minimum-spanning-tree, prims-algorithm

我正在使用邻接矩阵，优先级队列是数据结构。

根据我的计算，复杂度是`V^3 log V`：

*   While循环：`V`
*   检查相邻顶点：`V`
*   如果条目已经存在，则检查队列并更新：`V log v`

但是，我到处都读到复杂性是`V^2`

请解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T00:13:30.163

如果您使用斐波那契堆，则提取最小值是`O(lg V)`摊销成本，更新其中的条目是`O(1)`摊销的。

如果我们使用这个伪代码

```
while priorityQueue not empty
    u = priorityQueue.exractMin()
    for each v in u.adjacencies
        if priorityQueue.contains(v) and needsWeightReduction(u, v)
            priorityQueue.updateKeyWeight(u, v) 
```

假设实现对于`priorityQueue.contains(v)`和都有恒定的时间`needsWeightReduction(u, v)`。

需要注意的是，您可以稍微更紧地检查邻接关系。虽然外部循环运行`V`时间，并且检查任何单个节点的邻接是最糟糕的`V`操作，但您可以使用聚合分析来意识到您永远不会检查超过`E`邻接（因为只有 E 边）。并且`E <= V^2`，所以这是一个稍微好一点的界限。

所以，你有外循环 V 次，内循环 E 次。提取最小运行`V`时间，并更新堆运行`E`时间中的条目。

```
 V*lgV + E*1
= O(V lgV + E) 
```

同样，因为 `E <= V^2`您可以使用这个事实来替代并得到

```
 O(V lgV + V^2)
= O(V^2) 
```

但在考虑稀疏图时，这是一个更宽松的界限（尽管是正确的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-30T23:31:57.313

使用基于最小堆的优先级队列，时间复杂度为 O(ElogV)。

正如您所说，外部 while 循环是 O(V)，因为它遍历每个顶点，因为每个顶点都需要添加到 MST 一次。

对于 while 循环中考虑的每个顶点，需要执行以下两个步骤：

1.  选择下一条边添加到 MST。根据基于最小堆的优先级队列的属性，根元素总是最小的元素。因此，选择下一个边，即成本最低的边，将是对根元素的 O(1) 提取。提取后剩余的值需要以维持优先级队列的方式移动。由于队列表示平衡二叉树，因此在最坏的情况下，这种偏移可能会在 O(logV) 内发生。

2.  更新优先级队列。与新顶点相关的边可能需要在队列中更新它们的成本，因为我们现在将考虑与新添加的顶点及其邻居之间的边相关的成本（但是，如果它们通过一条边与先前添加的顶点相邻）成本低于新引入的边缘，成本不会更新，因为我们正在寻找最低成本）。这也是 O(logV)，因为在最坏的情况下，一个顶点需要在代表队列的平衡二叉树的整个长度上移动。

步骤 1 发生 V 次，因为它在 while 循环中发生一次，所以总共是 O(VlogV)，步骤 2 在最坏的情况下发生 E 次，其中每条边都连接到当前顶点，因此它们都需要更新，这意味着它是 O(ElogV) 总数。设置是 O(E)，因为它需要将优先级队列中的每个边成本初始化为无穷大。

使用基于最小堆的优先级队列的总时间复杂度 = O(E + VlogV + ElogV) = O(ElogV)

当您阅读复杂度为 O(V^2) 时，您可能正在查看不使用堆的实现。在这种情况下，外部 while 循环仍然是 O(V)。瓶颈在于选择要添加到 MST 的下一个顶点的步骤，即 O(V)，因为您需要检查与每个相邻节点相关的成本以找到最低成本，这在最坏的情况下意味着检查所有其他节点。因此复杂度为 O(V*V) = O(V^2)。

此外，在非常密集的图中，O(ElogV) 变为 O(V^2)，因为在任何图中，最多可以有 E = V^2 个总边。

# java - 我可以简化这三个 catch 块吗？

> ID：13556706
> 
> 赞同：1
> 
> 时间：2012-11-25T23:29:29.057
> 
> 标签：java, exception, exception-handling

我可以以某种方式在方法中包含这段代码吗

```
 if (!printStackTrace_printed) {
            ex.printStackTrace();
            printStackTrace_printed=true;
        }
        logStoreException(ex);
        throw new Exception(ex.getMessage()); 
```

并在每个 catch 块内调用它并传递正确的参数**ex**或**npe**

```
 catch (RationalTestException ex) {
        if (!printStackTrace_printed) {
            ex.printStackTrace();
            printStackTrace_printed=true;
        }
        logStoreException(ex);
        throw new Exception(ex.getMessage());

    } 
    catch (NullPointerException npe) {
        if (!printStackTrace_printed) {
            npe.printStackTrace();
            printStackTrace_printed=true;
        }
        logStoreException(npe);
        throw new Exception(npe.getMessage());

    }   
    catch (Exception ex) {
        if (!printStackTrace_printed) {
            ex.printStackTrace();
            printStackTrace_printed=true;
        }
        logStoreException(ex);
        throw new Exception(ex.getMessage());
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:35:31.200

由于您`Exception`在最后一个 catch 中进行捕获，并且所有 catch 块都是相同的，因此您可以完全删除其他两个 catch 块而不会影响程序。

它没有任何区别的原因是它`NullPointerException`是 的子类`Exception`，因此捕获`Exception`也将捕获`NullPointerException`以及在 try 块中抛出的任何其他异常。

请注意，一般来说，捕获`Exception`被认为是一种反模式，除非在服务器调用的最顶层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T03:20:59.007

您只能输入其中一个 catch 块，而不是全部，因此您根本不需要 'printStackTrace_printed' 布尔值。通常捕获一个异常并抛出另一个异常也是不好的做法，但是如果您有理由这样做，您只需要捕获异常，而不是其他两个。所以你的问题大部分都消失了。

# java - java UTC时间可以放在双精度内吗？

> ID：13556709
> 
> 赞同：5
> 
> 时间：2012-11-25T23:29:52.340
> 
> 标签：java, utc

我有一个需要双精度的方法，我想存储 UTC 时间，我传递给这个方法的变量很长。

我在用：

```
Date now = new Date();
now.getTime() 
```

获取UTC时间。

这个值不能放入双精度数吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-25T23:42:15.147

`double`从可以代表任何价值的意义上说，它将“适合”，`long`但是对于遥远的未来（从现在起的 100,000 年）的日期来说，精度会有所下降。

双重使用的[IEEE 754](http://en.m.wikipedia.org/wiki/Double-precision_floating-point_format#section_1)规范最多仅使用 53 位来表示数字的非指数部分。`long`由于 long 是 64 位，粗略地说，如果值超过 53 位，您可能会失去精度。

但是 53 位可以准确地表示当前[纪元毫秒时间](http://en.wikipedia.org/wiki/Unix_time) `long`值，只需要 41 位。

直到纪元时间超过 2 ^(53)才会发生精度损失，直到`Oct 12 287396`.

即使在最坏的情况下，11 位“不准确”仍会转换为精度约为 ±1 秒的时间值（`2 ^ 11 = 2048`以毫秒为单位，范围为 2 秒）。

简而言之，将纪元时间转换为`double`就可以了。

# java - Android BasicCookieStore、Cookies 和 HttpGet

> ID：13556712
> 
> 赞同：1
> 
> 时间：2012-11-25T23:30:09.610
> 
> 标签：java, android, cookies, http-get, cookiestore

我有一个应用程序应该向 URL 发送 GET 请求并发送一些 cookie。我一直在查看 BasicCookieStore 和 Cookie 类的一些代码示例，但我无法弄清楚如何使用它们。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:40:14.417

要使用 cookie，您需要以下内容：

```
CookieStore cookieStore = new BasicCookieStore();
DefaultHttpClient httpclient = new DefaultHttpClient();

HttpContext ctx = new BasicHttpContext();
ctx.setAttribute(ClientContext.COOKIE_STORE, cookieStore);
HttpGet get = new HttpGet("your URL here");

HttpResponse response = httpclient.execute(get,ctx); 
```

如果你想在请求之间保留 cookie，你必须为每个请求重用`cookieStore`和`ctx`。

此外，您可以阅读您的`cookieStore`内容以查看里面的内容：

```
List<Cookie> cookies = cookieStore.getCookies();
if( !cookies.isEmpty() ){
    for (Cookie cookie : cookies){
        String cookieString = cookie.getName() + " : " + cookie.getValue();
        Log.info(TAG, cookieString);
    }
} 
```

# android - Android 4.2 RadioButton android:drawableLeft 错误？

> ID：13556716
> 
> 赞同：8
> 
> 时间：2012-11-25T23:30:33.403
> 
> 标签：android, radio-button

使用 android:drawableLeft 时，Android 4.2 无法正确显示 RadioButton。drawableRight 没问题。

左侧的可绘制对象与单选按钮图形重叠。而且至少 Android 2.2-4.1 似乎可以使用 drawableLeft。

您知道解决方法吗？以编程方式设置 drawableLeft 无法解决此问题。

4.2 安卓问题

![4.2 问题](../Images/25ff40fe2a79aff530205ee373f96009.png)

4.1 Android 正确渲染（至少 Android 2.2-4.0 也正确渲染）

![4.1 正确](../Images/06fbfa43599926f786ba31b5d8deca06.png)

用于此的 Android XML 布局代码：

```
<RadioButton
    android:id="@+id/radio_cloud_dropbox"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginBottom="10dp"
    android:drawableLeft="@drawable/dropbox_logo"
    android:checked="true"
    android:text="@string/lbl_cloud_dropbox" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-03T10:20:48.817

您可以在单选按钮处使用：

设置按钮 @null 和可绘制的左侧设置您的按钮：

```
 <RadioGroup
        android:id="@+id/hn_radio_group"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <RadioButton
            android:id="@+id/rb_Select_by_proposal"
            style="@style/RadioButtonText"
            android:checked="true"
            android:tag="1"
            android:text="@string/select_by_proposal" />

        <RadioButton
            android:id="@+id/rb_Select_by_first_letter"
            style="@style/RadioButtonText"
            android:tag="2"
            android:text="@string/select_by_first_letter" />
    </RadioGroup> 
```

这是风格：

```
<style name="RadioButtonText">
    <item name="android:layout_width">match_parent</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:button">@null</item>
    <item name="android:drawableLeft">@drawable/radio_selector</item>
    <item name="android:drawablePadding">10dp</item>
</style> 
```

对于按钮和文本之间的空间，请使用：

```
 <item name="android:drawablePadding">10dp</item> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:24:23.883

它很可能是在 Android 4.2 中添加到平台的新布局方向支持的产物（即支持从左到右或从右到左的布局）。这也会影响他们放置左右可绘制内容的方式。您的`android:targetSdkVersion`清单属性设置为什么？从技术上讲，我相信，如果将其设置为 16 或更低，则默认情况下应该禁用这些布局更改，即使您的语言环境会启用它们。

我建议在[http://b.android.com](http://b.android.com)提交一个错误，因为在 RTL 模式下，我希望可绘制按钮也位于另一侧。同时，您可以尝试通过向`layoutDirection`您添加一个属性`TextView`并将其强制为 LTR 来强制布局方向，以使其看起来符合您的预期。您也可以从 Java 代码中调用它`setLayoutDirection()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T21:14:21.660

我对这个错误的临时解决方案是用包含和的（s）替换父`RadioGroup`布局。尽管还有其他解决方案。`TableLayout``TableRow``RadioButton``TextView`

```
<TableLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TableRow android:onClick="onDropboxClick" >
        <RadioButton
            android:id="@+id/radio_cloud_dropbox"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:onClick="onDropboxClick" />

        <TextView
            android:drawableLeft="@drawable/cloud_logo_dropbox"
            android:gravity="center_vertical"
            android:text="Dropbox" />
    </TableRow>

    <TableRow android:onClick="onGoogleDriveClick" >
        <RadioButton
            android:id="@+id/radio_cloud_google_drive"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:onClick="onGoogleDriveClick" />

        <TextView
            android:drawableLeft="@drawable/cloud_logo_google_drive"
            android:gravity="center_vertical"
            android:text="Google Drive" />
    </TableRow>

</TableLayout> 
```

然而，由于`RadioGroup`不能与嵌套布局一起使用，选择/取消选中状态必须在事件处理方法的关联活动中手动完成：

```
public void onDropboxClick(View view) {
    checkRadio(R.id.radio_cloud_dropbox);
}

public void onGoogleDriveClick(View view) {
    checkRadio(R.id.radio_cloud_google_drive);
}

private void checkRadio(int radioId) {
    if (radioId == R.id.radio_cloud_dropbox) {
        dropboxRadio.setChecked(true);
        googleDriveRadio.setChecked(false);
    } else if (radioId == R.id.radio_cloud_google_drive) {
        dropboxRadio.setChecked(false);
        googleDriveRadio.setChecked(true);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T11:07:11.760

这似乎已在 Android 4.2.2 中修复。

# jquery - 未在 FullCalendar 议程周视图中呈现事件

> ID：13556719
> 
> 赞同：0
> 
> 时间：2012-11-25T23:30:49.567
> 
> 标签：jquery, fullcalendar

我试图在“议程周”视图中呈现事件，但没有运气。我在 document.ready 中声明 FullCalendar，如下所示：

```
$("#calview").fullCalendar({
    theme: false,
    header: false,
    weekends: false,
    allDaySlot: false,
    minTime: 8,
    maxTime: 20,
    height: 800,
    defaultView: 'agendaWeek',
    editable: false,
    columnFormat: {
        month: 'dddd',
        week: 'dddd',
        day: 'dddd'
    },
    events: MyEvents
}); 
```

而且无论我给“事件”选项什么，无论是数组、回调函数还是简单的单个事件对象，它都不会呈现。但是，如果我注释掉“defaultView”选项并让它默认为月视图，我的事件就会呈现。

我尝试按照建议将“allDay”设置为false，或者空字符串等，都无济于事。

有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T16:51:09.193

Your example works for me, if i remove the "allDaySlot" parameter. Did you give that a try?

# php - OSX 本地环境中的 Symfony2 权限问题

> ID：13556721
> 
> 赞同：2
> 
> 时间：2012-11-25T23:31:15.087
> 
> 标签：php, macos, apache, symfony, permissions

我想尝试一下 OSX Mountain Lion 附带的本地 apache 环境。

我做了基本设置并在根目录中放置了一个项目

```
/Library/WebServer/Documents/ 
```

在我的浏览器中跳过了 localhost ，一切都按预期工作。

然而，为了简单起见，我决定按照本指南使用我的主目录中的 Sites 文件夹。

[http://osxdaily.com/2012/09/02/start-apache-web-server-mac-os-x/](http://osxdaily.com/2012/09/02/start-apache-web-server-mac-os-x/)

然后我重置 apache 并将其添加到我的浏览器

```
http://127.0.0.1/~bengibson/PracTest/ 
```

浏览器显示项目文件夹中的一些文件和目录的列表，但不是全部：S。

我试图导航到丢失的文件夹之一

```
http://127.0.0.1/~bengibson/PracTest/web/app_dev.php 
```

但我收到一条禁止消息:(

有谁知道这需要什么？

仅供参考这里是项目文件夹

![在此处输入图像描述](../Images/7021b198a4568908c721a0fa8a34275d.png)

这是终端中文件夹的详细视图

![在此处输入图像描述](../Images/901ffffa0e266ce2241ea925ec033163.png)

这是浏览器中显示的内容

![在此处输入图像描述](../Images/9a35f1766b9241aebb68cea7844f8caa.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T23:59:03.203

我之前在 OS X 上直接在浏览器中下载 Symfony 2 标准版的存档文件时遇到了这个问题。

`@`权限表末尾的符号表示该文件具有附加属性。您可以通过在终端中键入以下命令作为示例来查看这些附加属性，在[此处](http://blog.anselmbradford.com/2008/12/24/what-is-the-significance-of-plus-and-at-in-mac-os-x-file-permission-tables/)进行了说明。

```
$ xattr -l ~/Sites/PracTest/web/app_dev.php 
```

返回的结果是`com.apple.quarantine`。这是 OS X 保护从 Internet 下载的潜在恶意文件不被随时可用的方式，这就是为什么在 Finder 中您会收到警告框，提醒您打开从 Internet 下载的文件。

在您的情况下，要删除这些扩展属性，请运行

```
$ xattr -rd com.apple.quarantine ~/Sites/PracTest 
```

如果您想知道此命令的作用：

该`-d`标志删除其后指定的扩展属性，后跟路径。该`-r`标志以递归方式作用于所有子文件夹和文件。

您现在应该能够在浏览器中访问 app.php 和 app_dev.php。

我也想借此机会推荐使用 Composer 创建一个新的 Symfony2 项目，而不是直接下载它。很难回头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-04T23:38:26.780

对于可能在此博客上发生的其他任何人，我遇到了类似的问题，经过一番环顾后，我发现我忘记了 username.conf 文件中的“FollowSymLinks”选项

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T01:12:11.340

听起来像权限。

右键文件夹，获取信息，用右下角的管理员密码解锁，让所有用户都能读写。然后单击它下面的齿轮查找菜单，并告诉它也适用于其中的所有内容。

# java - 在java中使用递归

> ID：13556723
> 
> 赞同：2
> 
> 时间：2012-11-25T23:31:24.167
> 
> 标签：java

我正在研究康威的生命游戏计划。我打印了前两代细胞，但我无法再打印了。所以我决定使用递归，这样可以打印多批单元格。我的 NewCells 方法创建了第二代。我想如果我通过返回 NewCells(c) 而不是 c 来重复上述方法，它会打印出不同的结果，但它会一遍又一遍地打印出同一批单元格。

```
public class Life {

public static boolean[][] NewCells(boolean[][] c)
{
    int N = 5;
    int o=0;
    int p=0;
    int livecnt = 0; //keeps track of the alive cells surrounding cell
    int store = 0; //amount of surrounding cells for each individual cell
    int livestore[] = new int[N*N];

     System.out.println("Next Generation");
     // Checks for the amount of "*" surrounding (o,p)

      for (o=0; o < N; o++)
      { 
         for (p=0; p<N; p++)
         {
             for (int k=(o-1); k <= o+1; k++)
             {

                 for (int l =(p-1); l <=p+1; l++)
                 {
                     if ( k >= 0 && k < N && l >= 0 && l < N) //for the border indexes.
                     { 

                         if (!(k== o && l==p)) //so livecnt won't include the index being checked.
                         {
                             if (c[k][l] == true)
                             {
                                livecnt++;
                             }
                    }

                 }

                 }
             }
             livestore[store]= livecnt;
             livecnt = 0;
             store++;
         }
      }

      //Prints the next batch of cells
      int counter= 0;
      for (int i2 = 0; i2 <N; i2++)
      {
          for (int j2 = 0; j2 < N; j2++)
          {

          if (c[i2][j2] == false)
                 {
                     if (livestore[counter] ==3)
                     {
                        c[i2][j2]=true;
                         System.out.print("* ");
                     }
                     else
                    System.out.print("- ");
                 }

              else if (c[i2][j2] == true)
                 {
                     if (livestore[counter] ==1)
                     {
                        c[i2][j2]= false;
                        System.out.print("- ");
                     }
                     else if (livestore[counter] >3)
                     {
                         c[i2][j2]= false;
                         System.out.print("- ");
                     } 

                     else
                         System.out.print("* ");
                 }
                 counter++;
          }
          System.out.println();
      }

    return NewCell(c);  
}
/*************************************************************************************************************************************************/
public static void main(String[] args)
{
    int N = 5;
    boolean[][] b = new boolean[N][N];
    double cellmaker = Math.random();

    int i = 0;
    int j = 0;

    int o=0;
    int p=0;
    int livecnt = 0; //keeps track of the alive cells surrounding cell
    int store = 0; //amount of surrounding cells for each individual cell
    int livestore[] = new int[N*N];

     System.out.println("First Generation:");
     // Makes the first batch of cells
     for ( i = 0; i < N ; i++)
     {

         for ( j = 0; j< N; j++)
         {
              cellmaker = Math.random();

             if (cellmaker > 0.5) // * = alive; - = dead
             {
                 b[i][j]=true;

                 System.out.print( "* ");

             }

             if (cellmaker < 0.5)
            { b[i][j] = false;

             System.out.print("- ");

            }

         }
         System.out.println();

     }       

     boolean[][] newcells = new boolean[N][N];
     newcells = NewCells(b);

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:56:03.963

我不认为递归对于这个应用程序是一个好主意。它会导致 StackOverflowError，因为每一代都会推送另一个调用堆栈帧。递归，正如这个程序使用的那样，与迭代相比没有优势。

相反，将对 NewCells 的 main 方法调用放在一个循环中。这样，无论堆栈大小如何，您都可以运行尽可能多的迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T00:01:11.097

您不是`NewCell`从内部调用`NewCell`，这就是递归的工作方式。

我假设这不是您的问题中的错字，而是对它是什么以及它是如何工作的缺乏了解，我建议阅读一些关于[Java 中递归的](http://www.java-samples.com/showtutorial.php?tutorialid=151)内容。

了解基础知识后，请回到这里寻求更多帮助！

# ruby-on-rails - Capybara 与 RSpec 返回页面对象的空正文

> ID：13556734
> 
> 赞同：0
> 
> 时间：2012-11-25T23:32:30.733
> 
> 标签：ruby-on-rails, ruby, testing, rspec, capybara

在我的功能规范中使用 Capybara 和 Rspec 时，调用“visit”后，page.body 返回：“<html><head></head><body></body></html>” 当然，导致我所有的“发现”都失败了，因为那里什么都没有。launchy 的 save_and_open_page 向我展示了完整、准确的页面，充满了 HTML 标记。

关于为什么 Capybara 没有正确设置页面元素的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:14:32.263

原来这是由于webrat和capybara之间的冲突。深入研究引用“访问”和“页面”的来源，我发现访问在 Webrat 和 Capybara 中都声明了；但是，每个“访问”的效果不同。Capybara 设置页面变量，而 webrat 设置响应变量。我还不太了解如何使用它们，因为它们似乎对不同的目的都有用 - 如果有人想用一些资源留下一些评论，我当然会很感激！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T11:54:49.097

我也得到了这个。当我从访问调用中发出标记时，我发现页面实际上抛出了 404，但我没有收到 Capybara 404 错误。

如果您运行以下内容，它将打印出标记，以便您可以更轻松地调试：

```
When /^I view the front page$/ do
  @visit = get "#{host}/frontpage"
  puts @visit
end 
```

希望对某人有所帮助。

# cakephp - Cakephp HABTM关联条件导致Column not found SQL错误

> ID：13556735
> 
> 赞同：0
> 
> 时间：2012-11-25T23:32:33.560
> 
> 标签：cakephp, associations, has-and-belongs-to-many

我在 Cakephp 中有问题，当我定义

```
public $hasAndBelongsToMany = array(
    'User' => array(
        'className' => 'User',
        'joinTable' => 'groups_users',
        'foreignKey' => 'group_id',
        'associationForeignKey' => 'user_id',
        'unique' => 'keepExisting',
        'conditions' => 'User.active=1',
        'fields' => '',
        'order' => '',
        'limit' => '',
        'offset' => '',
        'finderQuery' => '',
        'deleteQuery' => '',
        'insertQuery' => ''
    )
); 
```

设置了条件字段，以便仅从数据库中获取活动的用户，我收到错误：SQLSTATE [42S22]：找不到列：1054 SQL 的“where 子句”中的未知列“User.active”询问：

```
SELECT `GroupsUser`.`user_id` FROM `groups_users` AS `GroupsUser` WHERE  `GroupsUser`.`group_id` = 123 AND `User`.`active`=1 
```

因为显然它只从连接表中获取结果。所以我在这里找到：http: [//book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm)在条件描述中。

> 条件：一组 find() 兼容条件或 SQL 字符串。如果您对关联表有条件，则应使用“with”模型，并在其上定义必要的 belongsTo 关联。

什么是“with”模型，我将如何实现它？

提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T08:47:34.880

尽管这个问题已经很老了，但我最近遇到了同样的问题并想记录我的解决方案。在上面的示例中，我必须执行一个简单的子查询来获取关联字段，而不是引用用户，如下所示：

```
public $hasAndBelongsToMany = array(
    'User' => array(
        'className' => 'User',
        'joinTable' => 'groups_users',
        'foreignKey' => 'group_id',
        'associationForeignKey' => 'user_id',
        'unique' => 'keepExisting',
        //'conditions' => 'User.active=1',
        'conditions' => array('(SELECT active FROM users WHERE users.id = GroupsUser.user_id)'=>1),
        'fields' => '',
        'order' => '',
        'limit' => '',
        'offset' => '',
        'finderQuery' => '',
        'deleteQuery' => '',
        'insertQuery' => ''
    )
); 
```

在我的类似示例中，查找和保存现在可以工作。

# javascript - 如何使用 javascript 保存最近的搜索？

> ID：13556744
> 
> 赞同：5
> 
> 时间：2012-11-25T23:33:24.527
> 
> 标签：javascript, jquery, json, forms

当用户执行搜索时，应保存这些搜索设置以供将来使用。

用户应填写一些表单字段，然后执行搜索。当他执行新的搜索时，旧的应该可以，等等。

我使用 javascript，jQuery。

我怎么能这样做？

我的意思是将其保存在本地机器中，而不是数据库中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:45:12.667

使用 HTML5 本地存储来存储和读取保存的搜索。：

```
// Write a local item..
localStorage.setItem("myKey", "myValue");

// Read a local item..
var theItemValue = localStorage.getItem("myKey");

// Check for changes in the local item and log them..
window.addEventListener('storage', function(event) {
    console.log('The value for ' + event.key + ' was changed from' + event.oldValue + ' to ' + event.newValue);
}, false);

// Check for HTML5 Storage..
function supports_html5_storage() {
    try {
        return 'localStorage' in window && window['localStorage'] !== null;
    } catch (e) {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:36:34.920

你可以试试这个插件[https://sites.google.com/site/daveschindler/jquery-html5-storage-plugin](https://sites.google.com/site/daveschindler/jquery-html5-storage-plugin)

您的目标是保存搜索，一旦他们在您执行操作之前输入它们，因此在提交表单时，使用插件将其保存到本地存储，然后执行搜索。

每次用户访问页面时，您还需要从存储中加载，以获取最后几次搜索。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T23:42:33.150

您可以使用 cookie 或网络存储。更多浏览器支持 Cookie，但 Web Storage 更易于使用。如果你使用 cookie，我推荐这个 jQuery 插件[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

保存设置`$.cookie('key', 'value');`

读取设置`$.cookie('key');`

使用所有主流浏览器最新版本支持的 Web 存储：

```
localStorage.setItem(key, value);
localStorage.getItem(key, value); 
```

您可以使用 Google 查找有关 API 的更多详细信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-03T06:53:32.593

**TL;DR 我已经编写了一个库来处理这个 + 它的边缘情况，请参阅[https://github.com/JonasBa/recent-searches#readme](https://github.com/JonasBa/recent-searches#readme)了解用法。**

尽管所有示例在技术上都可以，但它们并未涵盖存储最近搜索的任何边缘情况，例如实现 LocalStorage 空间的到期、排名或限制。

**示例** 过期：假设有人搜索查询`iPhone`，但已在`repairing iPhone`1 个月前查找查询，则修复 iPhone 查询可能已过时。

**最近搜索** 的排名 在进行前缀搜索时，排名也是如此，如果用户在 3 小时前查询“Apple TV”和在 8 小时前查询“电视电缆”，他们现在搜索“电视”，您可能想要实现两者的排名系统。

*安全处理存储* 仅写入 LocalStorage 将导致您每次都需要解析大量 JSON，从而逐渐减慢您的应用程序，直到您达到限制并失去此功能。

正是因为这个问题，我建立了一个最近搜索库来帮助你解决所有这些问题。您可以通过 npm 使用它并在[此处](https://github.com/JonasBa/recent-searches#readme)找到它。它将帮助您解决上述所有问题，并允许您非常快速地建立最近的搜索！

# java - 为什么这会给我一个边界错误？

> ID：13556745
> 
> 赞同：0
> 
> 时间：2012-11-25T23:33:44.760
> 
> 标签：java

我有一个自定义的“堆”类：

```
public class Heap<T extends Comparable<T>>
{
    ArrayList<T> heapList;

    public Heap()
    {
        heapList = new ArrayList<T>();

    } 
```

和一个自定义的“进程”类：

```
public class Process {
    private int processID, timeUnitsRequired, priority, timeOfArrival;

    public Process(int processID, int timeUnitsRequired, int priority, int timeOfArrival) {
        this.processID = processID;
        this.timeUnitsRequired = timeUnitsRequired;
        this.priority = priority;
        this.timeOfArrival = timeOfArrival;
    } 
```

但是如果我尝试创建一个新的进程堆，就像`Heap<Process> processHeap = new Heap<Process>();`我得到以下错误一样：

> 绑定不匹配：类型 Process 不是 Heap 类型的有界参数的有效替代品

为什么是这样？我似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:34:44.717

流程未实现 Comparable

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:37:15.990

进程对象需要实现`Comparable`接口。

**示例实现按优先级进行比较**

```
public class Process implements Comparable<Process>{

    @Override
    public int compareTo(Object o) {
        Process p2 = (Process) o;
        if(this.priority > p2.priority){
          return 1;
        }else if(this.priority < p2.priority){
          return -1;
        }
        return 0;
    }
} 
```

[可比较的 API 文档](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)

# algorithm - NLP - 在全文搜索中使用语义通配符进行查询，也许使用 Lucene？

> ID：13556746
> 
> 赞同：0
> 
> 时间：2012-11-25T23:33:48.247
> 
> 标签：algorithm, lucene, full-text-search, nlp, wildcard

假设我有一个很大的语料库（例如英语或任意语言），我想对其执行一些语义搜索。例如我有一个查询：

*“小心：[sg]的[art]舰队要来[do sg]！”*

语料库包含以下句子：

*“小心：一支外星舰队即将摧毁我们的星球！”*

可以看出我的查询字符串可能包含“语义占位符”，例如：

*   [art] - 文章的一些占位符（例如英文中的 a / an）
*   [sg], [do sg] - NPs 和 VPs（主语和谓语）的一些占位符

我想开发一个能够有效处理这些查询的库。我怀疑解析文本需要某种 POS 标记，但因为我不想完全重新实现已经存在的全文搜索引擎以使其工作，我正在考虑如何集成这个行为进入像 Lucene 这样的搜索引擎？

我知道有 SpanQueries 在某些情况下可能表现类似，但正如我所见，Lucene 不会对存储的文本做任何语义处理。

有可能实现这样的行为吗？还是我必须编写自己的搜索引擎？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:43:23.260

使用 Lucene，您可以向 TokenStream 中的单个项目添加额外的标记，但我不知道如何处理跨越多个单词的标签。

# ajax - 将 JSON 作为 HTML 元素文本传递

> ID：13556748
> 
> 赞同：2
> 
> 时间：2012-11-25T23:34:20.777
> 
> 标签：ajax, json, jquery

像这样在 HTML 中传输 JSON 是否会产生不良后果：

```
<div id="json" style="display: none;">{"foo": "bar"}</div> 
```

假设 HTML 字符如在元素文本中`<`被转义？`&lt;`

JSON 可以被严格解析：

```
var blah = $.parseJSON($('#json').html()) 
```

例如，在 try/catch 语句中。基本原理是当脚本标签被剥离**而不**执行时，允许在 Ajax 的 HTML 响应中传递 JSON。一个例子是使用 jQuery .load()[特殊选择器语法](http://api.jquery.com/load/#script-execution)发出的 Ajax 请求：

```
$('#here').load('some.html #fragment') 
```

...它抛弃了所有脚本标签，从而阻止了使用：

```
<script>var blah = {"foo":"bar"}</script> 
```

我已经看到 JSON 在 HTML 属性中被传递，我猜这是等价的 - wrt 怪异、安全等 - 但由于所有额外的引号转义，可读性要差得多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:07:11.880

在 HTML 中传递 JS 数据的自然方式是通过 JavaScript 代码（如果是实际 JavaScript 代码的一部分，例如在初始值/配置的情况下）或通过`data-`HTML5 属性（当不需要 JS 代码时；总是在需要数据时以某种方式附加到 DOM 元素）。

在您的示例中，这可能是最好的：

```
<div id="json" style="display: none;"
    data-something="{&quot;foo&quot;:&quot;bar&quot;}">
</div> 
```

但重新组织您的数据以实际遵循 HTML 结构：

```
<div class="profile-container"
    data-profile="{&quot;name&quot;:&quot;John Doe&quot;,&quot;id&quot;:123}">
    ... profile 123 ...
</div>
<div class="profile-container"
    data-profile="{&quot;name&quot;:&quot;Jane Doe&quot;,&quot;id&quot;:321}">
    ... profile 321 ...
</div> 
```

（引用应该在服务器端完成，例如使用[PHP`htmlspecialchars(...)`](http://php.net/manual/en/function.htmlspecialchars.php)或[Python`cgi.escape(..., True)`](http://docs.python.org/2/library/cgi.html#cgi.escape)）。

然后您可以通过多种方式之一获取数据，例如。使用[jQuery 的`.data()`方法](http://api.jquery.com/data/)。

**编辑：**

是的，您将 JSON 作为 HTML 标记的内容嵌入并使用 CSS 样式隐藏它的方法有问题。正如我所说，如果您想以 HTML 格式传递数据，唯一的“最佳实践”方法是将其附加到 HTML 元素之一（无论如何您都在这样做，但您使用 CSS 来隐藏它，而您可以使用**现有的**解决方案来传递 JSON/数据，而不影响可能覆盖您的样式的客户端）。缺点之一的证明在这里：http: [//jsfiddle.net/NY7Bs/](http://jsfiddle.net/NY7Bs/)（数据是双向传递的，但是一种简单的外部样式会覆盖您的内联样式并显示内容 - 更不用说对文档*语义*的影响） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:57:25.100

那么为什么不简单地使用 .ajax() 函数，你只会得到带有 json 的字符串。然后你可以按照你的建议解析它。

# python - 如何在python中实现增量搜索（类似vim或man page）

> ID：13556749
> 
> 赞同：0
> 
> 时间：2012-11-25T23:34:20.790
> 
> 标签：python, search, incremental-search

我用python curse库做了一个文本框，现在我想给它添加增量搜索功能。在大多数 linux 软件（如 vim、手册页）中，您可以通过按“/”进行增量搜索。有人知道如何在 Python 中做到这一点吗？我一直在研究一段时间，但没有任何提示。谢谢你。

# string - 在 r 中编辑（即删除字符）矩阵的列名时，是否有与 paste() 相反的函数？

> ID：13556750
> 
> 赞同：1
> 
> 时间：2012-11-25T23:34:25.783
> 
> 标签：string, r, substring, paste, substr

我正在寻找删除矩阵中每个列名的第一个字符。

```
mat1 <- matrix(seq(1:6), 2)
dimnames(mat1)[[2]] <- c("bA", "bB", "bC")

bA    bB    bC
1     2     3
4     5     6 
```

进入这个：

```
A     B     C
1     2     3
4     5     6 
```

我知道这个`paste()`函数，你可以附加到列名；有没有相反的功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-25T23:39:30.220

substring 是适当的函数：

```
 dimnames(mat1)[[2]] <- substring(dimnames(mat1)[[2]], first=2)

 mat1
     A B C
[1,] 1 3 5
[2,] 2 4 6 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T07:55:32.487

除了`substring`方法之外，您还可以使用正则表达式方法：

```
?regex
  colnames(mat1) <- sub('^\\.', "", colnames(mat1) ) # removes first letter
  # the next one removes lower-case letters which for some reason Jilber has already posted but  deleted
  colnames(mat1) <- sub("[a-z]", "", colnames(mat1) ) 
```

如果有“分隔符”，您还可以使用`strsplit`：

```
?strsplit
 colnames(mat1) <- sapply( strsplit( c("b_A", "b_B", "b_C"), "_"), "[", 2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-12T10:41:51.767

`stri_sub`包中的功能`stringi`。

```
require(stringi)
stri_sub(c("aA","bB","aC"),2)
## [1] "A" "B" "C" 
```

# inheritance - SQLAlchemy 和过滤多态查询

> ID：13556753
> 
> 赞同：2
> 
> 时间：2012-11-25T23:34:52.497
> 
> 标签：inheritance, sqlalchemy, polymorphic-associations, flask-sqlalchemy

我有课程`Node`，`Leaf (Node)`如下所示：

```
class Node (db.Model):
    __mapper_args__ = {'polymorphic_identity':'node', 'polymorphic_on':'type'}
    id = db.Column (db.Integer, primary_key=True)
    type = db.Column ('type', db.String (16))

    root_id = db.Column (db.Integer, db.ForeignKey (id))
    nodes = db.relationship ('Node',
        cascade='all', lazy='dynamic',
        primaryjoin='Node.root_id==Node.id',
        backref=db.backref('root', remote_side=id))
    leafs = db.relationship ('Leaf',
        cascade='all', lazy='dynamic',
        primaryjoin='Leaf.root_id==Node.id')

    def __init__ (self, root):
        self.root = root 
```

和

```
class Leaf (Node):
    __mapper_args__ = {'polymorphic_identity': 'leaf'}
    leaf_id = db.Column (db.Integer, db.ForeignKey ('node.id'), primary_key=True)

    def __init__ (self, root):
        super (Leaf, self).__init__ (root) 
```

具有以下属性（摘自我的测试）：

```
def test_polymorphic (self):
    base_node, leaf_of_base, node_of_base, leaf_of_node = self.create ()
    self.commit ([base_node, leaf_of_base, node_of_base, leaf_of_node])

    leaf, node = base_node.nodes.all ()

    self.assertEqual (type (leaf), Leaf)
    self.assertTrue (isinstance (leaf, Node))
    self.assertTrue (isinstance (leaf, Leaf))

    self.assertEqual (type (node), Node)
    self.assertTrue (isinstance (node, Node))
    self.assertFalse (isinstance (node, Leaf)) 
```

所以`Node.nodes` **包括**叶子对象（这是我想要的），并且**只**`Node.leafs`产生叶子对象（这也很好）。

 **现在，我想介绍一下`Node.nodes_except_leafs`，我确实喜欢：

```
class Node (db.Model):
    ...
    nodes_except_leafs = property (lambda self: self.nodes.filter_by (type='node')) 
```

这实际上可行，但我认为这不是最好的解决方案，因为使用这种方法，我会错过例如以下类型的节点：

```
class NodeEx (Node):
    __mapper_args__ = {'polymorphic_identity': 'nodeex'}
    nodex_id = db.Column (db.Integer, db.ForeignKey ('node.id'), primary_key=True)

    def __init__ (self, root):
        super (NodeEx, self).__init__ (root) 
```

因为`Node.nodes.filter_by (type='node')`会错过所有`NodeEx`带有`NodeEx.type == 'nodeex'`.

`Node.nodes_except_leafs`对于返回所有非叶或叶派生对象（可能从 的子类派生），有什么更好的解决方案`Node`？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T11:44:28.363

下面怎么样：

```
class Node (db.Model):
    ...
    # original
    nodes_except_leafs = property (lambda self: self.nodes.filter(Node.type != 'leaf'))

    # use outer join (to class) to filter out the Leaf(++)
    nodes_except_leafs = property (lambda self: self.nodes.outerjoin(Leaf, Node.id == Leaf.leaf_id).filter(Leaf.id == None)) 
```**

# android - Android 中已弃用选项卡的特殊用例

> ID：13556754
> 
> 赞同：1
> 
> 时间：2012-11-25T23:34:56.563
> 
> 标签：android, tabs, deprecated

我正在开发一个 Android 应用程序，我希望拥有像旧的 YouTube 应用程序一样的标签。应用程序布局的概念是这样的：

![](../Images/8c979274add6a0b7d0ea676d6e66ab01.png)

这里的想法是您可以使用选项卡在不同类型的输入窗格之间快速切换，并且输入预览在它们上方。现在，我刚刚发现在操作栏中引入选项卡已经同时弃用了这些类型的选项卡。

这是可以理解的，但我认为更改这部分布局将极大地影响我的应用程序的功能，因为没有真正的替代方案。

在这种情况下仍然可以使用已弃用的选项卡工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:43:44.077

**不推荐使用**选项卡，您应该阅读*“旧代码仍然可以工作，但对于新代码，**请勿**触摸它”*。使用片段来模拟选项卡功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T00:18:51.167

与选项卡相关的功能可能已被弃用（并且该功能可能有一天会停止工作），但这不会阻止您以一种将继续工作的方式手动实现选项卡，只要您构建它们的功能继续大致相同事物。

也许更令人担忧的是摆脱这种界面风格 - 但这是一种推动，而不是强制要求。

# c++ - boost::condition::notify_all 是否保证侦听器线程在返回之前将获取锁？

> ID：13556763
> 
> 赞同：1
> 
> 时间：2012-11-25T23:35:32.783
> 
> 标签：c++, multithreading, boost, synchronization

```
boost::condition cond;
boost::mutex access;
void listener_thread()
{
  boost::mutex::scoped_lock lock(access);

  while (true) {
      while (!condition_check_var) {
          cond.wait(lock);
      }
      do_some_work();
  }
}

/// ... Main thread ...
cond.notify_all();
check_work:
{
    boost::mutex::scoped_lock lock(access);
    function_relies_on_work_been_done();
} 
```

这是正确的设计吗？假设一旦`notify_all()`返回，listener_thread 将已经获得锁是否安全？并且当`check_work`块运行时（因为它锁定了与 相同的互斥锁`listener_thread()`），一些“工作”已经由`listener_thread()`?

如果不是，那么实现这种行为的首选方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:57:17.717

无法保证任何其他线程已根据通知采取行动，甚至尚未收到通知。事实上，甚至不能保证当前有一个线程在等待它的接收，尽管在您的设置中看起来很可能有线程在等待。如果你想确保接收线程已经完成了它们的工作，你需要建立一个反向通信通道，例如，使用另一个条件变量和一个合适的条件。

我意识到您的问题是关于 Boost 的，但这是标准对此的看法（30.5.1 [thread.condition.condvar] 第 8 段）：

> `void notify_all() noexcept;` 效果：解除所有被阻塞等待的线程`*this`。

它不保证线程和/或任何涉及的互斥锁会发生什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:50:05.067

一般没问题，虽然典型的写法是这样的：

```
while (true)
{
    cond.wait(lock, [&]() -> bool { return condition_check_var; });
    do_some_work();
} 
```

你不能说 call`notify_all()`和 return 的同时性`wait()`，因为两者之间没有正式的因果关系。对于同步，您只需要知道当`wait()`返回时您将获得锁。由于您的`check_work`块还锁定了互斥锁，因此保证仅在其他线程阻塞条件变量时才执行。

# python - 检查我对哈希表的理解

> ID：13556765
> 
> 赞同：1
> 
> 时间：2012-11-25T23:35:37.360
> 
> 标签：python, hashtable, implementation

我是一年级计算机科学专业的学生。我正在尝试自学哈希表以进行面试。在阅读了几篇关于它们的文章后，我想看看我是否得到它的最好方法是在 Python 中实现我自己的哈希表。这就是我所做的。请有人看看它，让我知道你的想法吗？我是否正确理解了我要使用哈希表做什么？

```
storage_array = []

def show_menu():
    menu_option = int(raw_input("Enter 1 to store data, Enter 2 to retrieve data: "))
    if (menu_option == 1):
        store_data()
    elif (menu_option == 2):
        retrieve_data()

def store_data():
    key_for_data = raw_input("Please enter the key for the data you want to store: ")
    actual_data = raw_input("Please enter the data you want to store: ")
    ascii_count = generate_hash(key_for_data)
    print ascii_count
    storage_array[ascii_count] = actual_data
    print "The data:'", actual_data, "'has been stored at index:'", ascii_count, "' which is the ascii count of:'", key_for_data, "'"
    show_menu()

def retrieve_data():
    key_for_data = raw_input("Enter the key for the data you want to retrieve: ")
    ascii_count = generate_hash(key_for_data)
    if (storage_array[ascii_count] == None):
        print "No data was stored under this key"
    else:
        print "The data you requested for key:'", key_for_data, "'with ASCII count:'", ascii_count, "' is:'", storage_array[ascii_count], "'"
    show_menu()

def generate_hash(input):
    character_list = list(input)
    ascii_count = 0
    for character_index in range(0,len(character_list)):
        ascii_count += ord(character_list[character_index])
    return ascii_count

def initiate_list():
    for repeat_index in range(0,1000):
        storage_array.append(None)
    print "List initiated with index's to 1000"

initiate_list()
show_menu()

##Or is it meant to hash the key like a dictionary and then store
##the value for that key in the hashed value in the hash table? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:52:52.460

看起来你的一般概念是正确的。哈希表采用任意键并通过某种特殊方法将其转换为数组的索引。

几点：

**首先**，也是最重要的：如果键的 ord() 之和大于 1000，您的 generate_hash 函数可能会返回一个无效的索引。

要解决此问题，请使用 generate_hash return `ascii_count % 1000`。如果您不知道是什么`%`意思，请阅读模数运算符（别担心，它并不太复杂）。

**其次**，同样重要的是：想想如果你使用以下两个键会发生什么：`ab`和`ba`。您所做的不一定是错误的，但是当不同的键发生冲突时，了解哈希表的行为很重要。

**第三**，不太重要：您的 for 循环不必像在 C/C++ 中那样工作。你可以改变

```
for character_index in range(0,len(character_list)):
        ascii_count += ord(character_list[character_index]) 
```

到

```
for character in character_list:
        ascii_count += ord(character) 
```

Python for 循环非常漂亮:)

总而言之，它看起来很棒！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:46:35.470

你有一个散列函数（我假设它为相同的输入产生相同的散列）并且你使用你的键上的散列函数产生的散列作为你的数组的索引来访问与键关联的数据，所以是的你有哈希表的要点。

要记住的一件好事是，您应该选择一个在输入上快速运行并且编写得足够好以合理避免冲突的散列函数（两个键产生相同散列的情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:46:40.680

您的`generate_hash()`函数可以返回不在您的表范围内的哈希值。

您还应该制定处理碰撞的策略。您最终总是会与哈希表发生冲突。

您的 generate_hash 函数可以更简单地编写

```
def generate_hash(s):
    return sum(ord(c) for c in s) 
```

如果使用模数1000，可以避免散列值落在表外的问题

```
def generate_hash(s):
    return sum(ord(c) for c in s)%1000 
```

`retrieve_data()`有一个错误。因为您没有考虑过冲突，所以如果我使用键“ad”存储某些内容，我可以使用键“cb”检索它

# jquery - jQuery ajax 不会发出 HTTPS 请求

> ID：13556772
> 
> 赞同：8
> 
> 时间：2012-11-25T23:36:56.310
> 
> 标签：jquery, ajax, https, nginx

我在我的网站上做一些非常基本的 jQuery ajax 东西，但我遇到了很多麻烦。

以下是相关代码：

```
$(document).ready( function() {
    $("#getdatabutton").click( function() {
        $.ajax({
            url: "/jsontest/randomdata",
            type: "get",
            data: [{name:"ymax", value:$("#randomgraph").height()},
                   {name:"count", value:$("#countinput").val()},
                   {name:"t", value:Math.random()}],       
            success: function(response, textStatus, jqXHR) {
                data = JSON.parse(response);
                updateGraph(data);
                $("#result").html(response);

                if(data["error"] == "") {
                    $("#errorbox").html("None");
                }
                else {
                    $("#errorbox").html(data["error"]);
                }
            },
            error: function(jqXHR, textStatus, errorThrown) {
                $("#errorbox").html(textStatus + " " + errorThrown);
            }
        });
    });
}); 
```

该页面是通过 HTTPS 加载的，但 XMLHttpRequests 似乎是通过 HTTP 发出的。

我什至尝试将 url 更改为绝对 url ( [https://larsendt.com/jsontest/randomdata](https://larsendt.com/jsontest/randomdata) )，它 *仍然*将请求发送到我网站的 HTTP 版本。

自然，由于请求将发送到不同的协议，ajax 调用会失败（跨域等等）。

据 Chrome 报道：

```
The page at https://larsendt.com/jsontest/ displayed insecure content from http://larsendt.com/jsontest/randomdata/?ymax=500&count=32&t=0.08111811126582325. 
```

我能想到的唯一其他相关信息是我让 Nginx 执行从[http://larsendt.com](http://larsendt.com)到[https://larsendt.com](https://larsendt.com)的 301 重定向，但我看不出这会如何破坏任何东西（我相信这是相当标准的做法）。

如果您想要现场演示，损坏的版本仍在[https://larsendt.com/jsontest](https://larsendt.com/jsontest)上。

无论如何，提前谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-25T23:49:11.413

尝试修复 URL，这样您的服务器就不必重定向

```
url: "/jsontest/randomdata/" // there was a missing trailing /

// i.e.  https://larsendt.com/jsontest/randomdata?ymax=500&count=32&t=0.9604179110508643
// was going to https://larsendt.com/jsontest/randomdata/?ymax=500&count=32&t=0.9604179110508643 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-24T00:30:04.393

301 永久重定向可能正在发生。要检查运行 Fiddler 并观察 Result 列。通常是 200 个代码，但我发现了一个 301 代码。

**https** jquery ajax 调用重定向到**http**，导致混合内容错误。

# java - 是否有同时兼容 Android 和 Java 的 Base64 库

> ID：13556782
> 
> 赞同：11
> 
> 时间：2012-11-25T23:38:33.760
> 
> 标签：java, android, base64

我有一个用于 Java 和 Android 项目的通用库，它需要一个 base64 编码器/解码器。问题是，Apache commons 库不适用于 Android，至少我无法成功实现 - 由于 Android 已经实现和早期版本，因此每当我尝试编码或解码时都会在运行时导致错误：

```
Base64.decodeBase64 
```

返回错误：

```
AndroidRuntime(1420): java.lang.NoSuchMethodError: org.apache.commons.codec.binary.Base64.decodeBase64 
```

如果有人知道与 Java 和 Android 兼容的 base64 库，或者可以向我解释如何解决 Apache 公共问题，我将不胜感激。:^)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-25T23:40:48.023

只有“base64”。它是如此微不足道，您可以搜索任何“java base64”并使用任何实现。

**编辑**

如果您以 API8 为目标，只需从 API8 中获取 Base64 实现的源代码（它是[android/util/Base64.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/util/Base64.java)）并复制到您的项目中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T23:41:19.783

自己滚。

下面是解码：

```
 static private int FromBase64Char(int c)
{
    if(c >= 'A' && c <= 'Z')
        return c - 'A';
    else if(c >= 'a' && c <= 'z')
        return c - 'a' + 26;
    else if(c >= '0' && c <= '9')
        return c - '0' + 52;
    else if(c == '+')
        return 62;
    else if(c == '/')
        return 63;
    else
        throw new IllegalArgumentException(); //Depends on how do you want to handle invalid characters
}

static public byte[] FromBase64(String s) throws IllegalArgumentException
{
    if(s == null)
        return null;

    int l = s.length();
    if(l == 0)
        return new byte[0];

    if(l % 4 != 0)
        throw new IllegalArgumentException();

    boolean Padded = (s.charAt(l-1) == '=');
    boolean Padded2 = (s.charAt(l-2) == '=');
    int ll = (Padded ? l-4 : l);
    int triad;

    byte [] b = new byte[(ll*3)/4 + (Padded ? (Padded2 ? 1 : 2) : 0)];

    int i, j = 0;
    for(i=0; i<ll; i+=4)
    {
        triad = 
            (FromBase64Char(s.charAt(i)) << 18) |
            (FromBase64Char(s.charAt(i+1)) << 12) |
            (FromBase64Char(s.charAt(i+2)) << 6) |
            FromBase64Char(s.charAt(i+3));

        b[j++] = (byte)((triad >> 16) & 0xff); 
        b[j++] = (byte)((triad >> 8) & 0xff);
        b[j++] = (byte)(triad & 0xff);
    }
    //The final chunk
    if(Padded)
    {
        if(Padded2) //Padded with two ='s
        {
            triad = (FromBase64Char(s.charAt(ll)) <<2 ) | (FromBase64Char(s.charAt(ll+1)) >> 4);
            b[j++] = (byte)triad;
        }
        else //Padded with one =
        {
            triad =
                (FromBase64Char(s.charAt(ll)) << 10) |
                (FromBase64Char(s.charAt(ll+1)) << 4) |
                (FromBase64Char(s.charAt(ll+2)) >> 2);  
            b[j++] = (byte)((triad >> 8) & 0xff);
            b[j++] = (byte)(triad & 0xff);
        }
    }
    return b;
} 
```

这是编码：

```
private final static String BASE64_ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
        PAD1 = "=", PAD2 = "==";

static public String ToBase64(final byte [] a)
{
    int l = a.length;
    StringBuilder sb = new StringBuilder((l+3)*4/3);
    int i;
    int mod = l % 3;
    int ll = l - mod;
    int triad;
    for(i=0;i<ll;i+=3)
    {
        triad = (a[i]<<16) | (a[i+1]<<8) | a[i+2];
        sb.append(BASE64_ALPHABET.charAt((triad >> 18) & 0x3f));
        sb.append(BASE64_ALPHABET.charAt((triad >> 12) & 0x3f));
        sb.append(BASE64_ALPHABET.charAt((triad >> 6) & 0x3f));
        sb.append(BASE64_ALPHABET.charAt(triad & 0x3f));
    }
    if(mod == 1)
    {
        sb.append(BASE64_ALPHABET.charAt((a[i] >> 2) & 0x3f));
        sb.append(BASE64_ALPHABET.charAt((a[i] << 4) & 0x3f));
        sb.append(PAD2);
    }
    if(mod == 2)
    {
        triad = (a[i]<<8) | a[i+1];
        sb.append(BASE64_ALPHABET.charAt((triad >> 10) & 0x3ff));
        sb.append(BASE64_ALPHABET.charAt((triad >> 4) & 0x3f));
        sb.append(BASE64_ALPHABET.charAt((triad << 2) & 0x3f));
        sb.append(PAD1);        
    }
    return sb.toString();   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-22T16:36:32.510

在我的应用程序中，我使用了 jackson，它提供了 base64 编码器/解码器，如果您的应用程序也使用 Jackson，则可以使用它。

```
import com.fasterxml.jackson.core.Base64Variants;

public class Foo {
    String encodeBase64(byte[] string) {
        return Base64Variants.getDefaultVariant().encode(string.getBytes());
    }
} 
```

# google-chrome-extension - “下载”需要 Google Chrome 开发频道或更新版本，这是稳定频道

> ID：13556783
> 
> 赞同：9
> 
> 时间：2012-11-25T23:38:35.713
> 
> 标签：google-chrome-extension

我正在制作一个 Chrome 扩展程序，以便在单击时自动提供一个另存为框。我在 API 上找到了[这个](http://developer.chrome.com/extensions/downloads.html#method-download)，但是一旦我将“下载”添加到权限中，我就会收到警告：

> 尝试安装此扩展时出现警告：
> 
> * “下载”需要 Google Chrome 开发频道或更新的频道，这是稳定频道。

我不知道什么是渠道，以及我如何改变它们。

那是什么？这是否意味着任何下载此扩展程序的人也会为更换频道而头疼？

我的示例代码：

```
window.onload = function(){
    alert(chrome);
    alert(chrome.downloads);
    chrome.downloads.download(
        {url: 'http://www.iana.org/_img/iana-logo-pageheader.png',
         saveAs: true
        },
        function(res){alert(res);});
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T00:30:19.363

大多数用户都在稳定频道上，因为这是默认设置。

如果您想使用前沿功能，请获取 Dev 或 Canary 版本。有关使用不同发布渠道的更多信息，请访问 chromium.org 的[Chrome 发布渠道](http://www.chromium.org/getting-involved/dev-channel)。

# iphone - 带有按钮和错误处理的 MWPhotoBrowser

> ID：13556787
> 
> 赞同：0
> 
> 时间：2012-11-25T23:39:20.623
> 
> 标签：iphone, objective-c, ios, xcode, ios6

我正在尝试制作一个使用照片浏览器的应用程序决定使用 MWPhotoBrowser。

这是代码，但我似乎无法使其工作：

视图控制器.h

```
#import <UIKit/UIKit.h>
#import "MWPhotoBrowser.h"

@interface ViewController : UIViewController<MWPhotoBrowserDelegate> {
    NSArray *_photos;
    UISegmentedControl *_segmentedControl;
}
@property (nonatomic, retain) NSArray *photos;
- (IBAction)billede:(id)sender;

@end 
```

视图控制器.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize photos = _photos;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        UIBarButtonItem *item = [[[UIBarButtonItem alloc] initWithCustomView:_segmentedControl] autorelease];
        self.navigationItem.rightBarButtonItem = item;
        self.navigationItem.backBarButtonItem = [[[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStyleBordered target:nil action:nil] autorelease];
    }
    return self;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}
- (IBAction)billede:(id)sender {

    //show your photo whit url
    NSMutableArray *photos = [[NSMutableArray alloc] init];
    MWPhoto *photo;
    {
    photo = [MWPhoto photoWithFilePath:[[NSBundle mainBundle] pathForResource:@"photo2l" ofType:@"jpg"]];
    photo.caption = @"The London Eye is a giant Ferris wheel situated on the banks of the River Thames, in London, England.";
    [photos addObject:photo];
    }

    self.photos = photos;

    // Create browser
    MWPhotoBrowser *browser = [[MWPhotoBrowser alloc] initWithDelegate:self];
    browser.displayActionButton = YES;

    //browser.wantsFullScreenLayout = NO;
    //[browser setInitialPageIndex:2];

    // Show
    if (_segmentedControl.selectedSegmentIndex == 0) {
        // Push
        [self.navigationController pushViewController:browser animated:YES];
    } else {
        // Modal
        UINavigationController *nc = [[UINavigationController alloc] initWithRootViewController:browser];
        nc.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
        [self presentModalViewController:nc animated:YES];
        [nc release];
    }

}

#pragma mark - MWPhotoBrowserDelegate

- (NSUInteger)numberOfPhotosInPhotoBrowser:(MWPhotoBrowser *)photoBrowser {

    return _photos.count;

}

- (MWPhoto *)photoBrowser:(MWPhotoBrowser *)photoBrowser photoAtIndex:   (NSUInteger)index {

    if (index < _photos.count)

        return [_photos objectAtIndex:index];

    return nil;

}

@end 
```

我已经尝试过使用 ARC 和 wothout ARC

如果没有 ARC，我会得到 3 个错误：

> 架构 i386 的未定义符号： **“_OBJC_CLASS_$_MWPhoto”**，引用自：ViewController.o 中的 objc-class-ref **“_OBJC_CLASS_$_MWPhotoBrowser”**，引用自：ViewController.old 中的 objc-class-ref：未找到符号对于架构 i386 clang：错误：**链接器命令失败，退出代码为 1（使用 -v 查看调用）**

使用 ARC 我得到 2 个错误

问题 1 [http://i.imgur.com/pT7qW.png](http://i.imgur.com/pT7qW.png)

问题 2 [http://i.imgur.com/E0X1m.png](http://i.imgur.com/E0X1m.png)

我还没有在这里完成，但我希望它被包裹在一个按钮中，这样我就可以单击它并在 MWPhotoBrowser 中显示图像

**编辑**

我已经升级了我的代码，从我的文件中删除了 ARC，现在我已经正确设置了目标。它现在会编译，但每次我尝试单击按钮时：“billede”我得到：

```
 2012-11-26 23:32:10.955 MWPhotoBrowserTest[10405:c07] -[ViewController galleri:]: unrecognized selector sent to instance 0x947fb20
2012-11-26 23:32:10.957 MWPhotoBrowserTest[10405:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[ViewController galleri:]: unrecognized selector sent to instance 0x947fb20'
*** First throw call stack:
(0x1d34012 0x14e9e7e 0x1dbf4bd 0x1d23bbc 0x1d2394e 0x14fd705 0x434920 0x4348b8 0x4f5671 0x4f5bcf 0x4f4d38 0x46433f 0x464552 0x4423aa 0x433cf8 0x1f6ddf9 0x1f6dad0 0x1ca9bf5 0x1ca9962 0x1cdabb6 0x1cd9f44 0x1cd9e1b 0x1f6c7e3 0x1f6c668 0x43165c 0x1e2d 0x1d55)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:51:52.540

附件 1：不能向 NSArray 添加对象，请改用 NSMutableArray。

附件 2：UIView 没有“reloadData”方法，但例如 UITableView 有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:46:32.470

实际上解决了这个问题。我苦苦挣扎了4天，终于搞定了。我通读了[https://github.com/mwaterfall/MWPhotoBrowser#method-1-static-library](https://github.com/mwaterfall/MWPhotoBrowser#method-1-static-library)并理解了它，但最后我遇到了用户标题搜索路径的问题。我终于明白了，将 MWPhotoBrowser 文件夹导入到我的 MWPhotoBrowser“项目”文件夹中，然后将用户标题搜索路径设置为“..”而不是“../ **”，因为“../** ”给了我“../ **../** ”

希望这可以帮助任何可能与我遇到同样问题的人！

顺便说一句，感谢您的帮助！:-)

# sql - 当前派生贷款项目

> ID：13556791
> 
> 赞同：0
> 
> 时间：2012-11-25T23:39:35.700
> 
> 标签：sql, linq, database-design, deriving

我有一张贷款信息表。

例子：

```
_________________________________________________________________
|id|LoanDate|EquipmentId|FromUser|FromLocation|ToUser|ToLocation|
|---------------------------------------------------------------|
|1 |2012-1-1| 100       | NULL   |  219       | 605  | NULL     |
|2 |2012-1-2| 100       | 605    |  NULL      | NULL | 219      |
|3 |2012-1-3| 100       | NULL   |  219       | 509  | NULL     |
----------------------------------------------------------------- 
```

如您所见，用户 605 被借了一天设备，然后在第二天归还。然后设备在之后的第二天被借给了另一个用户。

考虑到该表具有跟踪移动的条目（包括跨日期的退货），我将如何尝试查找当前有哪些设备当前借给他们的用户。

任何有关如何解决此问题的想法将不胜感激。伪代码、SQL 或 LINQ 也可以。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:02:05.743

如果您按 LoanDate 降序排列贷款然后分组`EquipmentId`，则每个组中的第一个元素将是其最近的贷款`EquipmentId`。如果`userId`不为空，则为当前拥有该设备的用户的 ID。

```
var items = from loan in loans
            orderby loan.LoanDate desc
            group loan by loan.EquipmentId into grp
            let userId = grp.First().ToUser
            where userId != null
            select new { EquipmentId = grp.Key, UserId = userId }; 
```

# magento - 谷歌分析自定义变量脚本不起作用

> ID：13556796
> 
> 赞同：0
> 
> 时间：2012-11-25T23:40:34.743
> 
> 标签：magento, variables, google-analytics

我的网站中有以下脚本可以将自定义变量推送到 Google 分析。但即使 5 天后，这些数据也不会出现在分析中。谁能注意到我在这里做错了什么？

```
<!-- BEGIN GOOGLE ANALYTICS CODE -->
<script type="text/javascript">
//<![CDATA[
(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
                })();

    var _gaq = _gaq || [];

    _gaq.push(['_setAccount', 'xxxxxxxxxx']);
    _gaq.push(['_trackPageview']);

    _gaq.push(['_setCustomVar', 1, 'Product SKU','Test Data', 3]);
        //]]>

</script>
<!-- END GOOGLE ANALYTICS CODE --> 
```

附加信息：此脚本来自 Magento 的 Google Analytis 模块，我在 GA.php 中编写了 _toHTML 方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T04:16:36.170

实际设置自定义变量的行出现在您的 _trackPageview() 调用之后，因此自定义变量永远不会真正发送到 Analytics 服务器。设置自定义变量后，您需要添加 _trackPageview() 或 _trackEvent() 调用。

```
_gaq.push(['_setAccount', 'xxxxxxxxxx']);
_gaq.push(['_trackPageview']);
_gaq.push(['_setCustomVar', 1, 'Product SKU','Test Data', 3]);
_gaq.push(['_trackEvent', 'Tow Truck', 'go', '-', 0, true]); 
```

这里有一些额外的参考资料：[http ://www.lunametrics.com/blog/2011/12/30/google-analytics-custom-variables-working/](http://www.lunametrics.com/blog/2011/12/30/google-analytics-custom-variables-working/)

# php - 在 PHP 中发布“*”SQL 的结果

> ID：13556797
> 
> 赞同：-3
> 
> 时间：2012-11-25T23:40:37.750
> 
> 标签：php, mysql

这是我的代码片段：

```
 if (!($stmt = $mysqli->prepare("SELECT * FROM CUSTOMER"))) {
            echo "Prepare failed: (" . $mysqli->errno . ") " . $mysqli->error;
    }
    if (!$stmt->execute()) {
        echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    }
    $stmt->store_result();

        echo "<table border=2 cellpadding=4>
        <tr bgcolor=white>
        <th>Name</th>
        <th>Lname</th>
        <th>Phone</th>
        <th>Address</th>
        <th>Discount</th>
        <th>email</th>
        </tr>";
        while ($row = mysql_fetch_array($stmt)){
            echo "<tr>
            <td>".$row['Name']."</td>
            <td>".$row['Lname']."</td>
            <td>".$row['Phone']."</td>
            <td>".$row['Address']."</td>
            <td>".$row['Discount']."</td>
            <td>".$row['email']."</td>
            </tr>";
        }
        echo "</table>";

    $stmt->free_result();

$mysqli->close();
?> 
```

意思是 mysql_fetch_array() 期望参数 1 是资源。我检查了 myPHPadmin 中的查询，它运行良好。我不明白为什么这不会发布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:49:01.880

`mysql_fetch_array`来自“mysql”扩展，它不同于其余代码使用的“mysqli”扩展。有关 mysqli 中准备好的语句的完整示例，请参见[http://php.net/manual/en/mysqli.prepare.php](http://php.net/manual/en/mysqli.prepare.php)。

我想你想要这样的东西（用 标记的更改`***`）：

```
if (!($stmt = $mysqli->prepare("SELECT * FROM CUSTOMER"))) {
        echo "Prepare failed: (" . $mysqli->errno . ") " . $mysqli->error;
}
if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
}

$result = $stmt->get_result(); //***

    echo "<table border=2 cellpadding=4>
    <tr bgcolor=white>
    <th>Name</th>
    <th>Lname</th>
    <th>Phone</th>
    <th>Address</th>
    <th>Discount</th>
    <th>email</th>
    </tr>";

    while ($row = $result->fetch_assoc()){  //***
        echo "<tr>
        <td>".$row['Name']."</td>
        <td>".$row['Lname']."</td>
        <td>".$row['Phone']."</td>
        <td>".$row['Address']."</td>
        <td>".$row['Discount']."</td>
        <td>".$row['email']."</td>
        </tr>";
    }
    echo "</table>";

$stmt->close(); //***

$mysqli->close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T23:48:37.183

您在`mysqli`对象上使用 mysql_* 函数，您需要使用[`mysqli_result::fetch_row`](http://php.net/manual/en/mysqli-result.fetch-row.php).

```
while ($row = $stmt->fetch_row()){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T00:18:54.723

我能够基于此回答我自己的问题：

[http://www.php.net/manual/en/mysqli-result.fetch-array.php](http://www.php.net/manual/en/mysqli-result.fetch-array.php)

不确定这是否是最好的风格，但它确实有效。下面是完整的php

```
 <?php
    ini_set('display_errors', 'On');
    $mysqli = new mysqli("***", "***", "***", "***");
    if ($mysqli->connect_errno) {
        echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
    }
        $stmt = "SELECT * FROM CUSTOMER";

        if (!$result = $mysqli->query($stmt)) {
            echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
        }

            echo "<table border=2 cellpadding=4>
            <tr bgcolor=white>
            <th>Name</th>
            <th>Lname</th>
            <th>Phone</th>
            <th>Address</th>
            <th>Discount</th>
            <th>email</th>
            </tr>";
            while ($row = $result->fetch_array(MYSQLI_ASSOC)){
                echo "<tr>
                <td>".$row['Name']."</td>
                <td>".$row['Lname']."</td>
                <td>".$row['Phone']."</td>
                <td>".$row['Address']."</td>
                <td>".$row['Discount']."</td>
                <td>".$row['email']."</td>
                </tr>";
            }
            echo "</table>";

        $result->free();

    $mysqli->close();
    ?> 
```

# c# - 构建时控制可见性自动更改

> ID：13556803
> 
> 赞同：0
> 
> 时间：2012-11-25T23:41:46.590
> 
> 标签：c#, winforms, properties, user-controls

亲爱的 Stackoverflow 用户您好。

我有一个在 Winforms 中制作的项目，我创建的用户控件有问题。用户控件由一些布局面板、控件等组成。它旨在用作设置控制器。它具有一些用于更改用户控件的设计/布局的属性，例如“ShowTitle”属性和“ShowDefault”属性，默认设置为“true”。属性 get/set 直接引用底层 control.visibility。

用户控件被放置在选项卡控件中以提供设置概述，但是（几乎）每次我重建解决方案时，设计器中当前未显示的选项卡页面中的用户控件都将其所有“显示...”属性更改为'错误的'。

如果我删除设计器中的设置： this.SpawnRate.ShowDefaultButton = false; 如果我重建时再次弹出。

我真的不知道出了什么问题，我已经找了好几个小时的代码。有谁知道问题可能出在哪里？

//淘气

**编辑：**只有引用 control.visibility 属性的属性才会改变它们的值

**更新：**

发现问题了......显然我不能像这样直接返回 Control.Visible 值：

```
bool ShowBtn
{
get{ return Btn_Default.Visible; }
set{ Btn_Default.Visible = value; }
} 
```

但必须有一个局部变量：

```
bool ShowBtn
{
get{ return _ShowDefault; }
set{ Btn_Default.Visible = value;
     _ShowDefault = value; }
}
bool _ShowDefault = true; 
```

更改后，问题不再出现。

有谁知道为什么会出现问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T10:12:02.053

发现问题了......显然我不能像这样直接返回 Control.Visible 值：

```
bool ShowBtn
{
    get{ return Btn_Default.Visible; }
    set{ Btn_Default.Visible = value; }
} 
```

但必须有一个局部变量：

```
bool ShowBtn
{
    get{ return _ShowDefault; }
    set
    {
        Btn_Default.Visible = value;
        _ShowDefault = value; 
    }
}
bool _ShowDefault = true; 
```

更改后，问题不再出现。

# android - 如何在andengine中移动线的终点

> ID：13556804
> 
> 赞同：1
> 
> 时间：2012-11-25T23:41:58.780
> 
> 标签：android, andengine

我遇到了问题，希望你们中的某个人可以帮助我。我正在使用**Andengine**在 Android 游戏中工作。现在我遇到了一个需要花费我很多时间但我无法解决的问题

我在场景中画了一条线，我想在 1 或 2 秒内将终点 (x2, y2) 移动到另一个点作为动画。例如，线**(x1 = 5, y1 = 0) 和 (x2 = 5, y2 = 10)**，我希望这条线更高，但在动画中为**(x1 = 5, y1 = 0) 和 (x2 = 5, y2 = 100)**

请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T19:59:54.477

我找到了一个解决方案，而且非常简单。我创建了继承自`MoveModifier class`并覆盖 update 方法的新修饰符：

```
public class LineMoveModifier extends MoveModifier{

public LineMoveModifier(float pDuration, float pFromX, float pToX,
        float pFromY, float pToY) {
    super(pDuration, pFromX, pToX, pFromY, pToY);
    // TODO Auto-generated constructor stub
}
public LineMoveModifier(final float pDuration, final float pFromX, final float pToX, final float pFromY, final float pToY, final IEntityModifierListener pEntityModifierListener, final IEaseFunction pEaseFunction) {
    super(pDuration, pFromX, pToX, pFromY, pToY, pEntityModifierListener, pEaseFunction);
}

@Override
protected void onSetValues(final IEntity pEntity, final float pPercentageDone, final float pX, final float pY) {
    Line x = (Line)pEntity;
    x.setPosition(x.getX1(), x.getY1(), pX, pY);
} 
```

}

现在使用它时，例如：

```
x = new Line(0, 0, 5, 5, 5, getVertexBufferObjectManager(), DrawType.DYNAMIC);
     LineMoveModifier lmm = new LineMoveModifier(5, 5, 400, 5, 700);
     mainScene.attachChild(x); 
```

希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T05:55:44.210

您可以使用[移动修改器](http://code.google.com/p/andengine/source/browse/src/org/anddev/andengine/entity/modifier/MoveModifier.java?r=ea4ff643a0e58857e92738a6e5449b6a362190cd)

```
MoveModifier modifier = new MoveModifier(1.5f, point.x, point.x, point.y, point.y + 30) 
```

而不是使用 registerEntityModifier 来表达你的观点：

```
point.registerEntityModifier(modifier); 
```

并在您的 updateHandler 画线中：

```
scene.registerUpdateHandler(new IUpdateHandler() {

    @Override
    public void reset() {}

    @Override
    public void onUpdate(float pSecondsElapsed) {
           //draw line between 2 points
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T13:46:35.297

我认为，分离当前行并创建一个包含所需元素的新行会更容易。我认为它会比使用修饰符更快更容易。

# wpf - 从 Windows 7 WPF 访问 Live SDK Skydrive

> ID：13556805
> 
> 赞同：3
> 
> 时间：2012-11-25T23:42:00.653
> 
> 标签：wpf, onedrive

我正在尝试开发一个在 Skydrive 上存储用户文件的应用程序。我正在尝试使用 Live SDK，但是使用 Visual Studio 2012 Professional 的适用于 Windows 7 的 Live SDK 似乎并不多。我目前通过 NuGet 安装了 Live SDK，我可以从 .dll 访问类等。唯一的问题是，由于缺乏文档，我不知道如何使用它。如果有人有一个关于如何至少登录 Skydrive 和/或从那里访问文件的快速示例，那就太好了！即使有人可以将我链接到详细说明上述内容的文章！

如果您需要更多信息，请告诉我。

编辑：代码

```
Try
    Dim auth As New LiveAuthClient("XXXXXXXXXXXXXXXXXX")
    Dim loginresult As LiveLoginResult = Await auth.IntializeAsync(New String(0) {"wl.skydrive"})
    MsgBox(loginresult.Status.ToString, MsgBoxStyle.OkOnly)
    If loginresult.Status = LiveConnectSessionStatus.Connected Then
        MsgBox("Signed In", MsgBoxStyle.OkOnly)
    End If
Catch ex As Exception
    MsgBox("Error signing in: " + ex.Message, MsgBoxStyle.OkOnly)
End Try 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T07:46:46.410

目前似乎没有用于 VB.net 的官方 Live SDK。如果有人确实找到了 SDK，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T00:08:59.070

首先搜索 Google [SkyDrive API](http://msdn.microsoft.com/en-us/library/live/hh826521.aspx)和[SkyDrive Core Concepts](http://msdn.microsoft.com/en-us/library/live/hh826545.aspx)。

完整的示例可通过前两个链接[Folders 和 files](http://msdn.microsoft.com/en-us/library/live/hh826531.aspx)获得。

对于登录，有 Live SDK，[Signing users in](http://msdn.microsoft.com/en-us/library/live/hh826543.aspx#csharp)。

# jquery - 使用 $(this) 和 FileReader() 来定位结果

> ID：13556812
> 
> 赞同：4
> 
> 时间：2012-11-25T23:42:22.803
> 
> 标签：jquery, file-upload, filereader

我正在尝试显示来自文件输入的图像的 ajax 预览。使用 FileReader() 很容易，但我将它与循环一起使用，所以当我需要将结果放在图像源中时，我需要使用 $(this) 来定位输入的循环项。这对我来说甚至没有意义，所以我们开始吧。

我们有一个循环..

```
<li>
  <input type="file" class="image" />
  <img src="" class="preview" />
</li>
<li>
  <input type="file" class="image" />
  <img src="" class="preview" />
</li>
<li>
  <input type="file" class="image" />
  <img src="" class="preview" />
</li> 
```

所以现在假设选择了第二个输入，现在我需要将 FileReader 的结果添加到它的图像 src。我如何定位第二个循环项目及其内容来做事？

```
 function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
               // Here I need to use $(this) to target only the second list item's img.preview
               $('.preview').attr('src', e.target.result);
            };

            reader.readAsDataURL(input.files[0]);
        }
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-26T01:00:57.497

我以前从未使用过这个 API。有趣的东西。

此版本循环遍历所有文件输入并加载其预览图像。该功能由单击按钮触发。

```
$(function(){
    $("#btnLoadPreviews").click(loadPreviews_click);
})

function loadPreviews_click(e) {
    $(".image").each(function() {
        var $input = $(this);
        var inputFiles = this.files;
        if(inputFiles == undefined || inputFiles.length == 0) return;
        var inputFile = inputFiles[0];

        var reader = new FileReader();
        reader.onload = function(event) {
            $input.next().attr("src", event.target.result);
        };
        reader.onerror = function(event) {
            alert("I AM ERROR: " + event.target.error.code);
        };
        reader.readAsDataURL(inputFile);
    });
} 
```

如果您希望在选择预览图像时加载它们，您可以改用此版本。

```
$(function(){
    $(".image").change(showPreviewImage_click);
})

function showPreviewImage_click(e) {
    var $input = $(this);
    var inputFiles = this.files;
    if(inputFiles == undefined || inputFiles.length == 0) return;
    var inputFile = inputFiles[0];

    var reader = new FileReader();
    reader.onload = function(event) {
        $input.next().attr("src", event.target.result);
    };
    reader.onerror = function(event) {
        alert("I AM ERROR: " + event.target.error.code);
    };
    reader.readAsDataURL(inputFile);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T08:08:55.693

我就是这样做的。将目标分配给阅读器对象本身并稍后使用。

```
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        // set where you want to attach the preview
        reader.target_elem = $(input).parent().find('preview');
        reader.onload = function (e) {
           // Attach the preview
           $(reader.target_elem).attr('src', e.target.result);
        };

        reader.readAsDataURL(input.files[0]);
    }
 } 
```

# javascript - jQuery javascript 检查页面上是否存在某些 html 的方法

> ID：13556813
> 
> 赞同：1
> 
> 时间：2012-11-25T23:42:22.683
> 
> 标签：javascript, jquery

在添加更多代码之前，我想确保：

```
<a href='index.php?option=com_content&view=article&id=36'>Hello</a> 
```

尚未在 id='faqs' 的 div 内的 html 页面上

```
<div id='faqs'>
<a href='index.php?option=com_content&view=article&id=36'>Hello</a>
</div> 
```

使用 jquery 或 javascript 执行此操作的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:07:03.883

```
if (!$('a[href$="view=article&id=36"]', '#faqs').length) {
    //does'nt exist
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:48:55.937

如果目标是在 div 标签中以 a 标签作为子标签结束，就是这样，那么不要费心检查，只需重新添加它，如下所示：

```
$('#faqs').html('');
$('<a />')
  .attr('href', 'index.php?option=com_content&view=article&id=36')
  .html('hello')
  .appendTo($('#faqs'))​;​ 
```

但是，如果您真的需要检查它是否存在，那么您可以执行以下操作：

```
var exists = $('#faqs a[href="index.php?option=com_content&view=article&id=36"]').length > 0; 
```

更新

在 html 中查找字符串可以按如下方式完成，但这不是推荐的解决方案。您可能会遇到以不同方式编码 html 的不同浏览器等问题（在 chrome 中测试）：

```
var stringToFind = '<a href="index.php?option=com_content&view=article&id=36">Hello</a>';

// need to replace the & ...
stringToFind = stringToFind.replace(/&/g, '&amp;');

var exists = $('#faqs').html().indexOf(stringToFind) > -1;
if (exists) {
  // do something            
} else {
  // do something else
} 
```

这是一个工作示例-> [http://jsfiddle.net/Uzef8/2/](http://jsfiddle.net/Uzef8/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:58:24.057

您可以使用 indexOf 进行搜索

```
var inBlock = $('#faqs').html();
if (inBlock.indexOf("<a href='index.php?option=com_content&view=article&id=36'>Hello</a>") == -1) {
    $('#faqs').append ("<a href='index.php?option=com_content&view=article&id=36'>Hello</a>");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T23:44:52.137

最简单的方法是使用 jQuery 选择元素，并检查`length`结果对象的属性：

```
var anchor = $('#faqs a[href="index.php?option=com_content&view=article&id=36"]')
if(anchor.length == 0) {
    // element isn't on the page
} 
```

# java - 为霍夫曼编码分配位

> ID：13556815
> 
> 赞同：0
> 
> 时间：2012-11-25T23:42:38.453
> 
> 标签：java, traversal, huffman-code

我很难找到一种方法来为字母分配 0 和 1。我修复了我的优先级队列，以便它将所有节点首先变成具有最高优先级的树。我对如何分配每个字母的价值一无所知。我正在考虑使用中序遍历，但在将位添加到字母时，我被困在该代码的外观上。非常感谢所有帮助！我的节点类如下：

```
private class Node{
    Node right;
    Node left;
    Node parent;
    char letter;
    int value;
    String binaryValue = "";
    private Node(char c, int in, Node parent, Node left, Node right){
        letter = c;
        value = in;
        this.left = left;
        this.right = right;
        this.parent = parent;
    }
    @SuppressWarnings("unused")
    private void setRight(Node right){
        this.right = right;
    }
    @SuppressWarnings("unused")
    private void setLeft(Node left){
        this.left = left;
    }
    private void setParent(Node parent){
        this.parent = parent;
    }
    private Node getParent(){
        return parent;
    }
    @SuppressWarnings("unused")
    private void setWeight(int weight){
        this.value += weight;
    }
    private void setBinary(String binary){
        binaryValue = binary;
    }
    private String getBinary(){
        return binaryValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T01:20:43.497

不确定您的确切要求，但这可能是您问题的一种解决方案

```
char letter = c;
  byte[] bytes = letter.getBytes();
  StringBuilder binary = new StringBuilder();
  for (byte b : bytes)
  {
     int val = b;
     for (int i = 0; i < 8; i++)
     {
        binary.append((val & 128) == 0 ? 0 : 1);
        val <<= 1;
     }
     binary.append(' ');
  }
  System.out.println(binary); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T02:33:22.663

从顶部到一个字母的分支数是位数。只需将 0 分配给左分支，将 1 分配给右分支。从上到下的遍历就是那个字母的二进制代码。

# excel - Excel 宏打开链接，然后返回工作表

> ID：13556816
> 
> 赞同：0
> 
> 时间：2012-11-25T23:43:34.063
> 
> 标签：excel, cell, vba

我无法记录访问相关单元格的 excel 宏，在该单元格中打开一个链接，然后返回到 excel。

例如，我需要在单元格 A1 中描述一个图像，该图像的链接在单元格 A3 中。我想使用键盘快捷键运行一个宏，该宏在单元格 A3 中打开链接，然后返回到单元格 A1，以便我可以输入说明。

我猜这真的很简单，但我几乎没有使用 Excel 的经验，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:50:55.733

您可以合并使用`HYPERLINK`Excel 中可用的功能吗？

# flash - actionscript3 ArgumentError：错误 #2015：位图数据无效

> ID：13556817
> 
> 赞同：3
> 
> 时间：2012-11-25T23:43:33.990
> 
> 标签：flash, class, actionscript, bitmap

我是一名设计师，在代码世界中尝试我的双手。到目前为止，我已经能够弄清楚事情，但我终于碰壁了。我在这里使用 Flash 工作，所以我无法逃脱它可能不是代码，而是设置的可能性。另外，作为新手，答案可能一直摆在我面前，而我只是陷入了困境。

无论如何，我正在开发一个简单的游戏，当角色在其下方时墙壁会消失，然后在他离开后重新出现。我为此寻求帮助，并且能够以单独的类文件的形式获得一些代码。这太棒了，而且很糟糕

- 太棒了，因为我有可以工作的代码，但是...... - 作为编码新手，我从来没有使用过类，现在我已经将它应用到我自己的项目中，它不起作用。故障排除现在变得更加困难。

在努力寻找答案之后，我想它终于到了我必须寻求帮助的地步。

一切都编译得很好，但我立即收到以下输出错误：

```
"Attempting to launch and connect to Player using URL ""\flashDemoCS5.5-47.swf
[SWF] ""\flashDemoCS5.5-47.swf - 8512188 bytes after decompression
ArgumentError: Error #2015: Invalid BitmapData.
    at flash.display::BitmapData/ctor()
    at flash.display::BitmapData()
    at Wall()[""\Wall.as:15]
    at wall_003()
    at flash.display::Sprite/constructChildren()
    at flash.display::Sprite()
    at flash.display::MovieClip()
    at Wall()[""\Wall.as:13]
    at wall()
    at flash.display::Sprite/constructChildren()
    at flash.display::Sprite()
    at flash.display::MovieClip()
    at flash.display::Sprite/constructChildren()
    at flash.display::Sprite()
    at flash.display::MovieClip()
    at flash.display::Sprite/constructChildren()
    at flash.display::Sprite()
    at flash.display::MovieClip()
    at flashDemoCS5_fla::MainTimeline()
Cannot display source code at this location.
" 
```

给我的代码在一个演示中工作，它本身只是附加的。演示功能的 .fla 中没有任何编码。我先发一下。它是 Wall.as，它与主 .fla 文件位于同一文件夹中：

```
 package  {

    import flash.display.MovieClip;
    import flash.display.BitmapData;
    import flash.events.Event;
    import flash.geom.Point;

    public class Wall extends MovieClip {

        var bmp:BitmapData;

        public function Wall() {
            this.addEventListener(Event.ENTER_FRAME, hideWall, false, 0, false);
            bmp = new BitmapData (this.width, this.height, true, 0);
            bmp.draw(this);
        }

        public function hideWall(e:Event){
            if(bmp.hitTest(new Point(0, 0), 0, this.globalToLocal(new Point(stage.mouseX, stage.mouseY)))) {
                this.visible = false;
            }else{
                this.visible = true;
            }
        }

    }

} 
```

附加到主 .fla 文件的代码位于第一帧的自己的层中：

```
 stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);
stage.addEventListener(KeyboardEvent.KEY_UP, keyUpHandler);
stage.addEventListener(Event.ENTER_FRAME, loop);

stage.scaleMode = StageScaleMode.NO_SCALE; // or other scale modes...
stage.align = StageAlign.TOP_LEFT;

stage.addEventListener(Event.RESIZE, resizeHandler);

function resizeHandler(e:Event):void{
            trace(stage.stageWidth + "x" + stage.stageHeight);
}

;
var animationState:String = "idle";
var mirrorState:String = "walk";
var keyCollected:Boolean = false;
var doorOpen:Boolean = false;

//collisions
var leftBumping:Boolean = false;
var rightBumping:Boolean = false;
var upBumping:Boolean = false;
var downBumping:Boolean = false;

//player collision points (relative to anchor point)
var leftBumpPoint:Point = new Point(-50,100);
var rightBumpPoint:Point = new Point(50,100);
var upBumpPoint:Point = new Point(0,75);
var downBumpPoint:Point = new Point(0,150);

//button press
var leftPressed:Boolean = false;
var rightPressed:Boolean = false;
var upPressed:Boolean = false;
var downPressed:Boolean = false;

//scrollspeed
var xSpeed:int = 0;
var ySpeed:int = 0;

var speedConstant:int = 5;

var friction:Number = 0.80;

//identify player location
var scrollX:int = 0;
var scrollY:int = 0;

//identify current level
var currentLevel:int = 1;

//next level function
function nextLevel():void{
     currentLevel++;
     //trace("Next Level: " + currentLevel);
     if(currentLevel == 2){
          gotoLevel2();
     }
     if(currentLevel == 3){
          gotoLevel1();
     }
}

//level 3 is the same as level 1\.  3 will go back to 1 in the code so level 2 can be accessed agin.
function gotoLevel1():void{
    back.other.gotoAndStop(1);
    back.visuals.gotoAndStop(1);
    back.collisions.gotoAndStop(1);
    scrollX = 0;
    scrollY = 0;
    keyCollected = false;
    back.other.doorKey.visible = true;
    doorOpen = false;
    back.other.lockedDoor.gotoAndStop(1);
    currentLevel = 1;
}

function gotoLevel2():void{
     back.other.gotoAndStop(2); //updates door and key
     back.visuals.gotoAndStop(2); //updates the visuals
     back.collisions.gotoAndStop(2); //updates the collisions
     scrollX = 0; //resets the player's x position in the new level
     scrollY = 500; //resets the player's y position in the new level
     keyCollected = false; //resets the keyCollected variable
     back.other.doorKey.visible = true; //makes the key visible again
     doorOpen = false; //resets the doorOpen variable
     back.other.lockedDoor.gotoAndStop(1); //makes the door return to its locked image
}

function loop(e:Event):void
{

    if (back.collisions.hitTestPoint(player.x + leftBumpPoint.x,player.y + leftBumpPoint.y,true))
    {
        //trace("leftBumping");
        leftBumping = true;
    }
    else
    {
        leftBumping = false;
    }

    if (back.collisions.hitTestPoint(player.x + rightBumpPoint.x,player.y + rightBumpPoint.y,true))
    {
        //trace("rightBumping");
        rightBumping = true;
    }
    else
    {
        rightBumping = false;
    }

    if (back.collisions.hitTestPoint(player.x + upBumpPoint.x,player.y + upBumpPoint.y,true))
    {
        //trace("upBumping");
        upBumping = true;
    }
    else
    {
        upBumping = false;
    }

    if (back.collisions.hitTestPoint(player.x + downBumpPoint.x,player.y + downBumpPoint.y,true))
    {
        //trace("downBumping");
        downBumping = true;
    }
    else
    {
        downBumping = false;
    }

    if (leftPressed)
    {
        xSpeed -=  speedConstant;

    }
    else if (rightPressed)
    {
        xSpeed +=  speedConstant;

    }

    if (upPressed)
    {
        ySpeed -=  speedConstant;

    }
    else if (downPressed)
    {
        ySpeed +=  speedConstant;

    }

    //colision react
    if (leftBumping)
    {
        if (xSpeed < 0)
        {
            xSpeed *=  -0.5;
        }
    }

    if (rightBumping)
    {
        if (xSpeed > 0)
        {
            xSpeed *=  -0.5;
        }
    }

    if (upBumping)
    {
        if (ySpeed < 0)
        {
            ySpeed *=  -0.5;
        }
    }

    if (downBumping)
    {
        if (ySpeed > 0)
        {
            ySpeed *=  -0.5;
        }
    }
    if (ySpeed && xSpeed || xSpeed || ySpeed> 10){
        (ySpeed + xSpeed)/2;
        trace(ySpeed + xSpeed);
        trace(ySpeed);
        trace(xSpeed);
    }
    else if(ySpeed && xSpeed || xSpeed || ySpeed < -10){
        (ySpeed + xSpeed)/2;
        trace(ySpeed + xSpeed);
        trace(ySpeed);
        trace(xSpeed);
    }
    //smoothes scrolling
    xSpeed *=  friction;
    ySpeed *=  friction;

    scrollX -=  xSpeed;
    scrollY -=  ySpeed;

    back.x = scrollX;
    back.y = scrollY;

        //key controls
    if(keyCollected == false){ // if we still haven't collected the key
if(player.hitTestObject(back.other.doorKey)){ // and if the player collides with the key
back.other.doorKey.visible = false; // hide the key from view
keyCollected = true; // set our Boolean to true
}
}
    if(doorOpen == false){ // if the door hasn't been opened yet
     if(keyCollected == true){ // and if the player has already collected the key
          if(player.hitTestObject(back.other.lockedDoor)){ // check if the door and the player are touching
               // if all of these conditions are met...
               back.other.lockedDoor.gotoAndStop(2); // ...switch the door's image to its 2nd frame
               doorOpen = true; // ...set the variable to true//level change.  Move this later.
if(doorOpen && player.hitTestObject(back.other.lockedDoor)){
          //proceed to the next level if the player is touching an open door
          nextLevel();
     }
          }
     }

    if(doorOpen || player.hitTestObject(back.other.openDoor)){
        nextLevel();
    }
    }

    //animation
    if (leftPressed || rightPressed || downPressed || xSpeed > speedConstant || xSpeed < ( speedConstant *-1 ) ){
        animationState = "walk";
    }else if(upPressed || upPressed && rightPressed || upPressed && leftPressed){
        animationState = "walk_up";
    }else{ 
        player.prevFrame();
    }

    //makse player face direction he/she is going;
    if (leftPressed && !rightPressed)
    {
        player.scaleX = -.7;
    }
    else if (rightPressed && !leftPressed)
    {
        player.scaleX = .7;
    }
    //stop animation
    if (player.currentLabel != animationState)
    {
        player.gotoAndStop(animationState);
    }

}

function keyDownHandler(e:KeyboardEvent):void
{
    if (e.keyCode == Keyboard.LEFT)
    {
        leftPressed = true;

    }
    else if (e.keyCode == Keyboard.RIGHT)
    {
        rightPressed = true;

    }
    else if (e.keyCode == Keyboard.UP)
    {
        upPressed = true;

    }

    else if (e.keyCode == Keyboard.DOWN)
    {
        downPressed = true;
    }
}

function keyUpHandler(e:KeyboardEvent):void
{
    if (e.keyCode == Keyboard.LEFT)
    {
        leftPressed = false;

    }
    else if (e.keyCode == Keyboard.RIGHT)
    {
        rightPressed = false;

    }
    else if (e.keyCode == Keyboard.UP)
    {
        upPressed = false;

    }
    else if (e.keyCode == Keyboard.DOWN)
    {
        downPressed = false;
    }
} 
```

希望我已经提供了所需的一切。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T14:09:45.190

当您创建一个新的 MovieClip 时，它没有内容并且它的尺寸为零。由于 Wall 扩展了 MovieClip，这就是您正在做的事情（扩展一个类意味着您使用它作为模板来添加额外的功能，简单地说） - 然后您根据父 MovieClip 的尺寸创建一个位图（ 0x0) 并尝试将其绘制到它。这就是破坏您的代码的原因。

我假设您使用的是 Flash，而不是 Flex/Flash Builder，如果是，您是否有要用于墙的图形？如果将其转换为 MovieClip，请右键单击并在库中选择“属性”，然后选择“为 ActionScript 导出”，它将为您创建一个自定义类。当您创建此对象的新实例时，它包含图形数据。

如果您想添加自定义功能，请创建一个扩展 this*而不是 MovieClip*的类，但请确保在构造函数（与该类同名的函数）中调用**super( )。**

让我知道这是否有帮助...

# c++ - QCommandLinkBut ton 底部截断

> ID：13556822
> 
> 赞同：2
> 
> 时间：2012-11-25T23:44:22.897
> 
> 标签：c++, qt, user-interface, qt-creator

在 Qt/QtCreator 中，我遇到了一个似乎无法解决的问题。我在垂直布局中有 3 个 QCommandLinkBut​​tons。在设计师中，一切似乎都很好，我按照我想要的方式拥有它，就像这样：

![](../Images/b6754c9cce452b806310268468071e2d.png)

当我运行应用程序时，它看起来非常不同。

![](../Images/3c939eec209883a3e92c6b1436f00c15.png)

乍一看它可能看起来不错，但经过​​进一步检查，您会发现图标和描述都被切断了。我尝试在这些按钮上设置最小尺寸，并将它们放在不同类型的布局中，但都没有奏效。任何帮助将不胜感激，谢谢。

编辑：只有当我在 QWizard 中有这些时才会发生这种情况。刚刚尝试了一个常规对话，它工作正常。

# c# - WPF 中心网格内容

> ID：13556823
> 
> 赞同：1
> 
> 时间：2012-11-25T23:44:27.027
> 
> 标签：c#, wpf, xaml, layout, grid

我需要创建一条线，第一个点以它所在的网格为中心（无需手动设置网格的宽度/高度）。这是我要更新的非常简单的代码示例，因此我在“Grid1”内有一个“Line1”点。

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Class="SimpleLine.MainWindow"
    x:Name="Window"
    Title="MainWindow"
    Width="640" Height="480">
    <Grid x:Name="LayoutRoot">
        <Grid Name="Grid1">
            <Line Name="Line1" X2="200" Y2="100" Stroke="Black"></Line>
        </Grid>
    </Grid>
</Window> 
```

当我尝试后面的代码时：

```
Line1.X1 = Grid1.Widht/2; Line1.Y1 = Grid1.Height/2; 
```

我收到一个错误（未捕获的异常） - “不是数字”不是 X1(Y1) 的有效值。

感谢您的任何努力。

PS：我是一个WPF初学者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:22:56.230

如果您没有明确设置宽度/高度，则必须在后面的代码中使用 ActualWidth 和 ActualHeight。

```
Line1.X1 = Grid1.ActualWidth / 2; Line1.Y1 = Grid1.ActualHeight / 2; 
```

如果你想在 XAML 中做，你可以让 BindingConverters 对绑定的值执行逻辑。

xml:

```
<Window x:Class="WpfApplication6.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication6"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:DivideByConverter x:Key="Divider" />
    </Window.Resources>
    <Grid x:Name="LayoutRoot">
        <Line Name="Line1" X2="{Binding ElementName=LayoutRoot, Path=ActualWidth, Converter={StaticResource ResourceKey=Divider}}" Y2="{Binding ElementName=LayoutRoot, Path=ActualHeight, Converter={StaticResource ResourceKey=Divider}}" Stroke="Black"/>
    </Grid>
</Window> 
```

绑定转换器：

```
 public class DivideByConverter : IValueConverter
    {
        /// <summary>
        /// Converts a value.
        /// </summary>
        /// <param name="value">The value produced by the binding source.</param>
        /// <param name="targetType">The type of the binding target property.</param>
        /// <param name="parameter">The xmlentry to the language value</param>
        /// <param name="culture">The culture to use in the converter.</param>
        /// <returns>
        /// A converted value. If the method returns null, the valid null value is used.
        /// </returns>
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            int divider = 2;
            if (value is double)
            {
                return (double)value / divider;
            }
            return value;
        }

        /// <summary>
        /// Converts a value.
        /// </summary>
        /// <param name="value">The value that is produced by the binding target.</param>
        /// <param name="targetType">The type to convert to.</param>
        /// <param name="parameter">The converter parameter to use.</param>
        /// <param name="culture">The culture to use in the converter.</param>
        /// <returns>
        /// A converted value. If the method returns null, the valid null value is used.
        /// </returns>
        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new Exception("The method or operation is not implemented.");
        }
    } 
```

这将采用 Binded 值 (ActualWidth) 并将其除以 2，ActualHeight 相同。因此，即使您的 from 已调整大小，该行也将保持在中心

# reporting-services - SSRS 文本框隐藏项目符号点

> ID：13556824
> 
> 赞同：0
> 
> 时间：2012-11-25T23:44:34.920
> 
> 标签：reporting-services, reportingservices-2005

我有一个带有项目符号列表的文本框。除最后一个之外的所有项目符号点都是始终出现的静态文本。

最后一个要点也是静态文本，但它仅在参数为真时出现。

所以当它是真的我想看到：

> 1.  一些文字
> 2.  其他一些文字
> 3.  还有一些文字
> 4.  最后一行文字

当它是假的时，我想看看：

> 1.  一些文字
> 2.  其他一些文字
> 3.  还有一些文字

我尝试将最后一个项目符号点的值设置为一个表达式，如果参数为假，则隐藏文本，但这给了我：

> 1.  一些文字
> 2.  其他一些文字
> 3.  还有一些文字

我觉得我错过了一些简单的东西，但是如何隐藏最后一个要点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:58:28.200

不是答案，而是解决方法：

最终完全摆脱了项目符号并手动为列表中的项目编号。然后将最后一个转换为仅在某些条件为真时才显示的表达式。

Feel there should be a better way but not able to find one (if you can provide a better answer I'm still very interested)

# php - 将 PHP 值放入 HTML

> ID：13556826
> 
> 赞同：-1
> 
> 时间：2012-11-25T23:44:38.967
> 
> 标签：php, html, sql

我有一个 PHP 页面，我在其中回显所有 HTML。在被告知这是不好的做法之后，我应该写出 HTML 并且只在需要时切换到 PHP，我正在尝试重写我的表单以遵守这一点。

我尝试了以下方法，但是包含我的 SQL 查询结果的 $row 数组没有被正确调用，

```
<?php while($row = $sth->fetch()){ ?>
<p>
<input type = "hidden" name ="id" value="<?php $row["id"] ?>"/>';
<p>
<input type = "text" name ="firstName" size ="30" value=" <?php $row["firstName"]?>"/>';</p>
<p>
<input type = "text" name ="lastName" size ="30" value="<?php $row["lastName"]?>"/>';
</p>";
<input type="submit" value="Update" />';
<?php } ?> 
```

据我了解，只要开始和结束括号的顺序仍然正确，上面的代码应该可以工作，但它不能。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T23:47:56.937

```
<?php while($row = $sth->fetch()){ ?>
<p>
<input type = "hidden" name ="id" value="<?php echo $row["id"]; ?>"/>';
<p>
<input type = "text" name ="firstName" size ="30" value=" <?php echo $row["firstName"]; ?>"/>';</p>
<p>
<input type = "text" name ="lastName" size ="30" value="<?php echo $row["lastName"]; ?>"/>';
</p>";
<input type="submit" value="Update" />';
<?php } ?> 
```

你忘了把`echo`，没有回声它不会打印任何东西。

您还有另一种选择，即：

```
<?php while($row = $sth->fetch()){
echo<<<HTML
<p>
<input type = "hidden" name ="id" value="{$row['id']}"/>';
<p>
<input type = "text" name ="firstName" size ="30" value=" {$row['firstName']}"/>';</p>
<p>
<input type = "text" name ="lastName" size ="30" value="{$row['lastName']}"/>';
</p>";
<input type="submit" value="Update" />';
HTML;
} ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:48:19.443

你需要使用回声

```
<input type = "hidden" name ="id" value="<?php echo $row["id"]; ?>"/> 
```

另外，不要忘记为 HTML 转义：

```
<input type = "hidden" name ="id" value="<?php echo htmlspecialchars($row["id"]); ?>"/> 
```

从 PHP 5.4 开始，short 方法始终可用，即使 short_open_tag 配置关闭：

```
<input type = "hidden" name ="id" value="<?= htmlspecialchars($row["id"]); ?>"/> 
```

# javascript - 重置节点顺序和隐藏 event.srcElement

> ID：13556835
> 
> 赞同：1
> 
> 时间：2012-11-25T23:45:10.950
> 
> 标签：javascript, dom-events, swap, autoresetevent

我正在建立一个自定义公司层次结构，需要能够“提升”一个 Div 在公司图表中的排名。我将触发器作为跨度放置在每个 div 内。点击事件设置为找到父div并与前一个div交换。我的工作正常，问题是：

1.  在此之后，我需要“重置”文档中节点的顺序，以便后续交换脱离新顺序，而不是加载时存在的顺序。

2.  我需要查找交换的 div 在组内的位置，如果它是隐藏包含向上按钮的跨度的系列中的第一个。我会用这个逻辑想象一些东西：

    ```
    if(event.srcElement.parent().prev() = Null { 
        event.srcElement.parent().hide() 
    }; else { 
        return false;
    }; 
    ```

我知道语法是错误的，但我是 js 新手，所以请指出我正确的方向。

这是我现在正在使用的代码。就目前而言，如果我将 3 个元素的顺序从 1、2、3 交换到 2、1、3，您会认为单击 3 上的交换会将其切换为现在之前的 1，但它会将其与 2 交换，页面加载时它之前的元素。

```
<script type="text/javascript">

$(document).ready(function() {  

    $(".go-swap").click(function() {  
        $(this).parent().parent().prev().swap({  
            target: (this).parentNode.parentNode.id, 
            opacity: "0.5", 
            speed: 1000, 
            callback: function() { 
            event.srcElement.parent().hide()
            } 
        });  
    });  
});  
</script>

<div class="known" id="A101">
    Contact 1
    <span class="plus">
        <a href="javascript://" class="go-swap"><img src="images/uparrow.gif" border="0" /></a>
    </span>
 </div>
 <div class="known" id="A102">
    Contact 2
    <span class="plus">
        <a href="javascript://" class="go-swap"><img src="images/uparrow.gif" border="0" /></a>
    </span>
 </div>
 <div class="known" id="A103">
    Contact 3
    <span class="plus">
        <a href="javascript://" class="go-swap"><img src="images/uparrow.gif" border="0" /></a>
    </span>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T01:48:45.913

这是您的选择

1）服务器端代码+d​​b：

如果您希望整个组织查看“新结构”，您将不得不使用数据库和服务器端代码。您无法使用客户端 javascript 编辑实际文件。

2）本地存储：

如果只是你使用它，你可以将数据保存在 localstorage 中，并在每次加载页面时访问该结构。

# c# - 哪些做法可以防止使用 IEnumerable 的意外延迟执行 作为论据？

> ID：13556837
> 
> 赞同：6
> 
> 时间：2012-11-25T23:45:38.347
> 
> 标签：c#, linq, parameters, ienumerable, design-principles

有一些与此类似的问题涉及正确的输入和输出[类型](https://stackoverflow.com/questions/613652/should-i-use-an-interface-like-ienumerable-or-a-concrete-class-like-list)。我的问题是什么好的做法、方法命名、选择参数类型或类似的东西可以防止延迟执行事故？

这些是最普遍的，`IEnumerable`这是一种非常常见的参数类型，因为：

*   遵循[稳健性原则](https://en.wikipedia.org/wiki/Robustness_principle) *“在你所做的事情上保守，在你接受别人的事情上自由”*

*   广泛用于`Linq`

*   `IEnumerable`在集合层次结构中处于较高位置并且早于[较新的集合类型](https://visualstudiomagazine.com/articles/2012/08/07/new-read-only-collection-interfaces-for-net.aspx)

但是，它也引入了*延迟执行*。现在我们可能在设计方法（尤其是扩展方法）时出错了，因为我们认为最好的想法是采用最基本的类型。所以我们的方法看起来像：

```
public static IEnumerable<T> Shuffle<T>(this IEnumerable<T> lstObject)
{
    foreach (T t in lstObject)
       //some fisher-yates may be
} 
```

危险显然是当我们将上述函数与惰性混合在一起时`Linq`，它*非常容易受到影响。*

```
var query = foos.Select(p => p).Where(p => p).OrderBy(p => p); //doesn't execute
//but
var query = foos.Select(p => p).Where(p => p).Shuffle().OrderBy(p => p);
//the second line executes up to a point. 
```

# 更大的编辑：

重新打开这个：对语言功能的批评没有建设性 - 但是要求良好的实践是 StackOverflow 的亮点。更新了问题以反映这一点。

# 这里有一个很大的编辑：

**澄清上述行 - 我的问题不是关于第二个表达式没有得到评估，严重的是没有。程序员都知道。我担心的是`Shuffle`到目前为止实际执行查询的方法。查看第一个查询，没有执行任何操作。现在类似地，在构造另一个 Linq 表达式（应该稍后执行）时，我们的自定义函数正在玩破坏游戏。换句话说，如何让调用者知道`Shuffle`并不是他们在 Linq 表达式的那个点想要的那种功能。我希望重点是回家。道歉！:)**虽然它就像检查方法一样简单，但我在问你们通常如何进行防御性编程..

上面的例子可能没有那么危险，但你明白了。那是某些（自定义）函数不适合`Linq`延迟执行的想法。问题不仅与性能有关，还与意想不到的副作用有关。

但是像这样的函数可以通过以下方式发挥作用`Linq`：

```
public static IEnumerable<S> DistinctBy<S, T>(this IEnumerable<S> source, 
                                              Func<S, T> keySelector)
{
    HashSet<T> seenKeys = new HashSet<T>(); //credits Jon Skeet
    foreach (var element in source)
        if (seenKeys.Add(keySelector(element)))
            yield return element;
} 
```

如您所见，这两个函数都 take `IEnumerable<>`，但调用者不知道这些函数是如何反应的。那么你们在这里采取的一般警告措施是什么？

1.  适当地命名我们的自定义方法，以便它为调用者提供一个好兆头或不好的想法`Linq`？

2.  将*惰性*方法移动到不同的名称空间，并将`Linq`-ish 保留到另一个名称空间，以便它至少给出某种想法？

3.  不接受`IEnumerable`as 参数来`immediately`执行方法，而是采用更派生的类型或具体类型本身，从而`IEnumerable`单独留给惰性方法？这给调用者增加了执行可能未执行的表达式的负担？这对我们来说是很有可能的，因为外部`Linq`世界我们几乎不处理`IEnumerable`s，而且大多数基本的集合类`ICollection`都至少实现了。

还是别的什么？我特别喜欢第三个选项，这就是我想要的，但我想在此之前得到你的想法。即使是优秀的程序员，我也看到了很多代码（有点像扩展方法！） ，他们在方法`Linq`中接受`IEnumerable`并对其执行或类似的操作。`ToList()`我不知道他们如何应对副作用。

**编辑：**在投反对票和回答之后，我想澄清一下，这不是程序员不知道 Linq 是如何工作的（我们的熟练程度可能在某种程度上，但那是另一回事），而是很多函数都是写的那时linq算进去了。现在将立即执行的方法与 Linq 扩展方法链接起来很危险。所以我的问题是，程序员是否遵循一般准则，让调用者知道从 Linq 端使用什么，不使用什么？*它更多的是关于防御性编程，而不是如果你不知道使用它，那么我们就无能为力！*（或者至少我相信）..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T06:57:43.240

> 如您所见，这两个函数都 take `IEnumerable<>`，但调用者不知道这些函数是如何反应的。

这只是一个文档问题。查看[`DistinctBy`MoreLINQ](https://code.google.com/p/morelinq/source/browse/MoreLinq/DistinctBy.cs)中的文档，其中包括：

> 尽管保留了一组已经看到的键，但该运算符使用延迟执行并流式传输结果。如果多次看到一个键，则只返回具有该键的第一个元素。

是的，在使用之前了解成员的用途很重要，对于接受/返回*任何*类型的集合的事情，有很多重要的事情需要了解：

*   集合会立即阅读，还是推迟阅读？
*   返回结果时是否会流式传输集合？
*   如果接受的声明集合类型是可变的，该方法会尝试对其进行变异吗？
*   如果返回的声明的集合类型是可变的，它实际上是一个可变的实现吗？
*   返回的集合是否会被其他操作更改（例如，它是一个可以在类中修改的集合的只读视图）
*   是`null`可接受的输入值吗？
*   是`null`可接受的*元素*值吗？
*   该方法会返回`null`吗？

*所有*这些都值得考虑——其中大部分在 LINQ 之前很久就值得考虑。

真正的寓意是，“在你调用它之前，确保你知道它的行为方式。” 在 LINQ 之前确实如此，而 LINQ 并没有改变它。它只是介绍了以前很少出现的两种可能性（延迟执行和流式传输结果）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T00:13:02.623

**在任何有意义的地方**使用 IEnumerable ，并进行****防御性编码**。**

 **正如 SLaks 在评论中指出的那样，延迟执行`IEnumerable`从一开始就成为可能，并且自从 C# 2.0 引入了该`yield`语句以来，自己实现延迟执行非常容易。例如，此方法返回一个使用延迟执行返回一些随机数的 IEnumerable：

```
public static IEnumerable<int> RandomSequence(int length)
{
    Random rng = new Random();
    for (int i = 0; i < length; i++) {
        Console.WriteLine("deferred execution!");
        yield return rng.Next();
    }
} 
```

因此，每当您使用`foreach`循环遍历 IEnumerable 时，您必须假设在迭代之间可能发生任何事情。它甚至可能引发异常，因此您可能希望将 foreach 循环放在`try/finally`.

如果调用者传入一个 IEnumerable，它做了一些危险的事情或永远不会停止返回数字（无限序列），这**不是你的错**。您不必检测它并抛出错误；只需添加足够的异常处理程序，以便您的方法可以在出现问题时自行清理。对于像这样简单的事情`Shuffle`，没有什么可做的；让调用者处理异常。

在极少数情况下，您的方法确实无法处理无限序列，请考虑接受不同的类型，例如`IList`. 但即使**IList 也无法保护您免受延迟执行的**影响——您不知道哪个类正在实现 IList，也不知道它为每个元素做了什么伏都教！在*非常罕见的*情况下，您在迭代时确实不允许*任何*意外代码运行，您应该接受一个**数组**，而不是任何类型的接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T00:07:37.457

延迟执行与类型无关。如果您以这种方式编写代码，则任何使用迭代器的 linq 方法都有可能延迟执行。`Select()`, `Where()`,`OrderByDescending()`例如所有使用迭代器并因此延迟执行。是的，这些方法需要一个`IEnumerable<T>`，但这并不意味着这`IEnumerable<T>`是问题所在。

> 那是某些（自定义）函数不适合 Linq 的延迟执行理念。问题不仅与性能有关，还与意想不到的副作用有关。
> 
> 那么你们在这里采取的一般警告措施是什么？

没有任何。老实说，我们`IEnumerable` *到处*都在使用，不存在人们不了解“副作用”的问题。“延迟执行的 Linq 理念”是其在 Linq-to-SQL 之类的用途中的核心。在我看来，自定义功能的设计并没有想象中那么清晰。如果人们正在编写代码以使用 LINQ 并且他们不了解它在做什么，那么这就是问题所在，而不是`IEnumerable`恰好是基类型的事实。

您所有的想法都只是对这样一个事实的包装，即听起来您的程序员只是不了解 linq 查询。如果您不需要延迟执行（听起来好像不需要），那么只需在函数退出之前强制所有内容进行评估。对您的结果调用 ToList() 并在消费者希望使用的一致 API 中返回它们 - 列表、数组、集合或 IEnumerables。**

# python - 杀死一个无限循环的线程应用程序

> ID：13556841
> 
> 赞同：2
> 
> 时间：2012-11-25T23:46:20.633
> 
> 标签：python, signals

考虑一个假设的线程 Python 应用程序，它在无限循环中运行每个线程：

```
import signal                                                          
import sys 
import threading
import time

class CallSomebody (threading.Thread):
        def __init__(self, target, *args):
                self._target = target
                self._args = args
                threading.Thread.__init__(self)

        def run (self):
                self._target(*self._args)

def call (who):
        while True:
                print "Who you gonna call? %s" % (str(who))

def signal_handler(signal, frame):
    sys.exit(0)

signal.signal(signal.SIGINT, signal_handler)

a=CallSomebody(call, 'Ghostbusters!')
a.daemon=True

b=CallSomebody(call, 'The Exorcist!')
b.daemon=True

a.start()
b.start()

a.join()
b.join() 
```

运行应用程序时，通过按下发送 SIGINT`Ctrl``C`不会停止应用程序。我尝试删除这些`daemon`陈述，但这没有帮助。我缺少什么基本思想？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T00:14:53.657

当你`join`一个线程时，活动线程会阻塞，直到加入的线程返回。你的从来没有。你不会想以这种方式加入他们。

通常，作为守护线程并执行无限循环的后台线程应标记为守护线程，从不加入，然后在主线程这样做时允许过期。`wx`例如，如果您碰巧正在使用，您会`AppInstance.MainLoop()`在启动守护线程后调用 to，然后当您的 Frame 或您拥有的任何其他顶级实例关闭时，程序执行将结束，并且守护进程将被处理适当地。

# c - 在C中的scanf中禁用数字以外的字符

> ID：13556846
> 
> 赞同：2
> 
> 时间：2012-11-25T23:46:45.323
> 
> 标签：c, char, character, scanf

我遇到的问题是我想禁止用户在我的程序中放置字符而不是数字，并可选择打印消息“它已禁用”。它应该询问相同变量的值。我试图用这个来做到这一点：

```
scanf(" %[0-9]d",&x); 
```

还有这个：

```
else
       result = scanf("%*s"); 
```

但它仍然不起作用。我应该寻找什么？我搜索了互联网，但我只找到了使用 C++ 的解决方案，`cin`不幸的是它在 C 中根本不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:05:59.280

你可以尝试这样的事情：

```
char c[SIZE];
int i;    

// While the string is not a number
while(fgets(c, SIZE , stdin) && !isAllDigit(c)); 
```

其中 isAllDigit 是：

```
int isAllDigit(char *c){
    int i;
    for(i = 0; c[i] != '\0' && c[i] != '\n'; i++) // Verify if each char is a digit
       if(!isdigit(c[i]))         // if it this char is not a digit
           return 0;              // return "false"

    return 1; // This means that the string is a number       
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T00:08:18.603

scanf 不再使用太多，因为它完全不适合键盘输入。这些天的基本方案是循环执行 fgets() + validate + sscanf() 。

# node.js - nodejs 在启动时使用 nvm $HOME/nvm/nvm.sh 处于活动状态

> ID：13556847
> 
> 赞同：2
> 
> 时间：2012-11-25T23:46:46.213
> 
> 标签：node.js, nvm

我用 nvm 安装了节点，它工作正常，但是我需要执行每个新会话`source $HOME/nvm/nvm.sh`才能使节点处于活动状态

我该如何做才能在启动时处于活动状态，因此无需`source $HOME/nvm/nvm.sh`在每个 sssh 会话中输入

我尝试将此命令添加`source $HOME/nvm/nvm.sh`到，`/etc/rc.local`但出现以下错误

```
>  /etc/init.d/node_start.sh: 13: root/nvm/nvm.sh: Bad substitution
>     /etc/init.d/node_start.sh: 78: root/nvm/nvm.sh: [[: not found
>     /etc/init.d/node_start.sh: 78: root/nvm/nvm.sh: [[: not found
>     /etc/init.d/node_start.sh: 129: root/nvm/nvm.sh: [[: not found
>     /etc/rc.local: 14: /etc/rc.local: source: not found 
```

但是，如果我在 shell 上执行该命令可以正常工作

欢迎任何帮助

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-23T20:23:56.677

您应该将下面的行添加到 ~/.bashrc 文件的末尾：

```
[[ -s /home/$USER/.nvm/nvm.sh ]] && . /home/$USER/.nvm/nvm.sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-22T22:19:39.733

我希望您的 init 脚本`#!/bin/sh`在需要以`#!/bin/bash`. 当然，不使用 Bash 编写 init 脚本可能有很多很好的理由......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T00:01:51.807

init 脚本以 root 身份运行，而不是您的用户。如果你想自己获取`nvm.sh`，你不应该使用`$HOME`，而应该使用绝对路径，比如`/home/vitor/nvm/nvm.sh`. 此外，init 脚本可能正在运行，`dash`因此您不应使用该`[[`构造。只需`[`按照此破折号中的描述使用[/bin/sh 文章](https://wiki.ubuntu.com/DashAsBinSh#A.5B.5B)

所以我去阅读了来自[https://github.com/creationix/nvm/blob/master/nvm.sh的 nvm.sh 源代码](https://github.com/creationix/nvm/blob/master/nvm.sh)

我认为这与破折号不兼容。所以我建议你把 nvm.sh 留在文件系统的其他地方，然后在你的初始化脚本中做

```
exec /bin/bash /root/nvm/nvm.sh 
```

开始可能也足够`node_start.sh`了。`#!/bin/bash`

您可能还想[在 github 上为 nvm 订阅 issue 168](https://github.com/creationix/nvm/issues/168)，其他人遇到此错误。

# java - 如何使用 Java2D 在 GUI 中使用 ActionListener 调用方法

> ID：13556852
> 
> 赞同：2
> 
> 时间：2012-11-25T23:47:12.210
> 
> 标签：java, user-interface, graphics, actionlistener

我正在用 Java 编写一个实现 ActionListener 的图形用户界面程序。该程序是一个使用 2D 图形的吉他和弦可视化器。我有一个工具栏，用户可以在其中选择要显示的和弦。因此在 actionPerformed(ActionEvent e) 方法中，当用户选择某个和弦时，该选择会调用显示该和弦的方法。然而，当我测试程序时，我得到了大量的错误。这是错误消息

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at fretboard.displayAMajor(fretboard.java:493)
    at fretboard.actionPerformed(fretboard.java:74)
    at java.awt.MenuItem.processActionEvent(MenuItem.java:650)
    at java.awt.MenuItem.processEvent(MenuItem.java:609)
    at java.awt.MenuComponent.dispatchEventImpl(MenuComponent.java:343)
    at java.awt.MenuComponent.dispatchEvent(MenuComponent.java:331)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$400(EventQueue.java:82)
    at java.awt.EventQueue$2.run(EventQueue.java:663)
    at java.awt.EventQueue$2.run(EventQueue.java:661)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:98)
    at java.awt.EventQueue$3.run(EventQueue.java:677)
    at java.awt.EventQueue$3.run(EventQueue.java:675)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:674)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:201)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:196)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:188)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

另外，我没有使用 JPanel 或 JFrame。我只是使用框架。我的程序有什么问题？谢谢！

这是我的一些代码（截至目前，该程序已超过 500 行）。

```
public class fretboard extends Frame implements ActionListener{
    public static void main(String[] args) {
        Frame frame = new fretboard();
        frame.setSize(1280, 960);
        frame.setVisible(true);
    }

    /**
     * Create the menu bar and set title
     */

    public fretboard() {
        // Change the title of the window
        setTitle("Fretboard");
        // Create a menu bar where user will be given choice of chords
        MenuBar mb = new MenuBar();
        setMenuBar(mb);
        Menu menu = new Menu("Chords");
        mb.add(menu);
     }

    public void actionPerformed(ActionEvent e) {
        String command = e.getActionCommand();
        if("A Major".equals(command)) {
            displayAMajor();
        }
This method contains the bulk of my program. Here are just a few lines.

    public void paint(Graphics g) {
        // Declare local variables
        int h = 40, w = 26, x = 695, y = 230;
        Graphics2D g2 = (Graphics2D) g;
        Font font = new Font("SansSerif", Font.BOLD, 28);
        Font font1 = new Font("SansSerif", Font.BOLD, 18);          
        // Declare the note variables
        // First string
        Ellipse2D E1 = new Ellipse2D.Double(x, y-110, w, h);
        // Open the image
        File fretBoardFile = new File("/Users/macbook/desktop/Gibson_Fretboard.jpg");
        BufferedImage bi = null;
        try {
            bi = ImageIO.read(fretBoardFile);
            g.drawImage(bi, 25, 25, null);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        // Draw notes
        // Draw the E note on the open 1st string
        // Change color to blue
        g2.setColor(Color.blue);
        g2.draw(E1);
        g2.fill(E1);
        g2.setColor(Color.white);
        g2.setFont(font);
        g2.drawString("E", x+5, y-80);
        // Change color back to blue
        g2.setColor(Color.blue);

public void displayAMajor() {
    // Declare local variables
    int h = 40, w = 26, x = 695, y = 230;
    Graphics g = null;
    Graphics2D g2 = (Graphics2D) g;
    //Graphics2D g2 = new Graphics();
    Font font = new Font("SansSerif", Font.BOLD, 28);
    // Declare notes
    Ellipse2D E1 = new Ellipse2D.Double(x, y-110, w, h);
    // Display notes for the A Major chord
    // Draw the E note on the open 1st string
    // Change color to red
    g2.setColor(Color.red);
    g2.draw(E1);
    g2.fill(E1);
    g2.setColor(Color.white);
    g2.setFont(font);
    g2.drawString("E", x+5, y-80);
    // Change color back to blue
    g2.setColor(Color.blue);
    repaint();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:56:16.160

啊哈，强制转换变量，null，图形，我来猜一猜——你试图将 Graphics 对象保存为类字段，你将它强制转换为 Graphics2D，它是 null。如果是这样，您将需要阅读如何使用 Swing 进行绘图，因为它不是这样做的。您必须使用 JVM 提供的 Graphics 对象并传递给 JComponent（例如 JPanel）的`paintComponent(Graphics g)`方法。这是开始学习在 Swing 中[执行自定义绘画的一个不错的链接。](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)

再一次，你会想要重构你的代码，因为你的类听起来*太大*了。此外，您还需要学习和使用 Java 命名约定。例如，类名应以大写字母开头。

哎呀，更糟糕的是：

```
Graphics g = null;  // *******  this is null!!!!
Graphics2D g2 = (Graphics2D) g;  // ***** it's *STILL* null!!
//Graphics2D g2 = new Graphics();
Font font = new Font("SansSerif", Font.BOLD, 28);
Ellipse2D E1 = new Ellipse2D.Double(x, y-110, w, h);
g2.setColor(Color.red);   // ***** it's *STILL* null!!
g2.draw(E1);   // ***** it's *STILL* null!!
g2.fill(E1); // **** etc... 
```

您正在使用一个为空的变量，因此它引发 NPE 也就不足为奇了。请阅读我链接到的教程。

您将希望在`paintComponent(...)`JPanel 或其他 JComponent 派生类的方法覆盖中进行绘图，或者在 BufferedImage 中通过提取其 Graphics 对象并使用它进行绘图。如果您正在创建静态图像，例如和弦选项卡，那么 BufferedImages 可能是您的选择，然后将它们显示在 JLabel 中保存的 ImageIcon 或 paintComponent 方法中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T00:03:47.147

正是您所期望的：

```
Graphics g = null;
Graphics2D g2 = (Graphics2D) g; 
```

此外，您的`paint`方法违反了自定义绘画最重要的规则之一，它未能调用`super.paint`这会产生更多问题，因此值得列出。

执行自定义绘画时优先覆盖的方法是`paintComponent`，但是，因为您要覆盖`Frame`(??) 它没有`paintComponent`方法。

这里有一些想法......

1.  在 AWT 上使用 Swing 组件。它们更容易使用。
2.  从类似的东西扩展`JPanel`并在其上执行您的自定义绘画。这为您提供了更灵活的设计选择并减少了问题。
3.  总是打电话`super.paintXxx`，如果你不打电话，预计事情会在你的脸上爆炸。
4.  所有绘画都必须通过 a`paint`方法完成。您无法控制油漆过程，只需接受它并继续前进。您可以鼓励重新绘制，但您只能在`paint`方法的上下文中进行绘制。
5.  `Graphics`上下文由系统控制。如果你想在上面画画，你必须等待一个可用，见前一点。这个上下文可以改变，所以你永远不应该保持对它的引用。上下文是共享的`Graphics`，未能遵守绘画链将导致出现绘画伪影

您可能想抽出时间阅读

*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)
*   [在 AWT 和 Swing 中绘画](http://www.oracle.com/technetwork/java/painting-140037.html)
*   [2D 图形](http://docs.oracle.com/javase/tutorial/2d/index.html)

# php - Sperate PHP include files - opening and closing brackets/braces { } for if's and while loop nd closing curly brackets/braces in between files

> ID：13556855
> 
> 赞同：1
> 
> 时间：2012-11-25T23:47:45.883
> 
> 标签：php, include, curly-braces, curly-brackets

I am working with PHP includes i.e:

```
include_once("somephpfile.php"); 
```

And a CSS/HTML designer that is very problematic. I am trying to keep all PHP away from the designer, as they become very panicked : \ and they create many problems, deleting code and things and messing up everything.

So I have been using the PHP includes to add the PHP where necessary between their HTML.

The PHP works fine and there are zero bugs.

It is the separation of the PHP into multiple include files that is causing my some problems.

Following is an example of what I am trying to separate.

The PHP to be separated:

* * *

```
<?php
$foo = 0;
$bar = 0;

if($foo == 0){

    $foo++;
    $bar++;
    // more php code

    while($foo < 20){

        $foo++;
        $bar++;
        // more php code

    // Now write the designers HTML here in this loop
    ?>  

        <BR /> Some HTML 
        <?php echo $foo; ?>
         more html 
        <?php echo $bar; ?>
        <BR /> More HTML <BR /> <BR />

    <?php
    // Done with the designers code -Now close my PHP here

   }// END while($foo < 5)

}// END if($foo == 0)
?> 
```

* * *

I want to separate this into 2 includes - include1.php and include2.php

And I want to have the designers code between the while loop. So what I did was this:

* * *

include1.php

```
 if($foo == 0){

    $foo++;
    $bar++;
    // more php code

      while($foo < 20){

        $foo++;
        $bar++;
       // more php code
   ?> 
```

* * *

DESIGNERS HTML and a little mixed PHP

```
 <BR /> Some HTML 
    <?php echo $foo; ?>
     more html 
    <?php echo $bar; ?>
    <BR /> More HTML <BR /> <BR /> 
```

* * *

include2.php

```
 <?php
   // Done with the designers code -Now close my PHP here

  }// END while($foo < 5)

}// END if($foo == 0)
?> 
```

I get an error **("Parse error: syntax error, unexpected $end in)**

I have multiple if's and while's and loops.

**My question is: How do I separate these braces / brackets without an error?**

**Thank you**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:52:47.033

你想做什么是错的。您不能将 PHP 控制结构分解`if`为`while`多个文件。如果您需要将 PHP 与 HTML 分开，您最好的选择可能是[Smarty 模板](http://www.smarty.net/)。它们将使您的 HTML 保持稳定和干净，与 PHP 相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:53:55.473

我认为您与包含中的开头`<?php`和结尾`?>`位不一致，如果它们与发布的一样。它们需要像往常一样在 PHP 代码之前和之后。即使那样，我也不确定它是否会起作用。

相反，您应该颠倒这个想法，为“设计者的 HTML”创建一个单独的 .php 文件，您可以将其包含到您的 PHP 中。这样，设计者就有了一个只有简单的 PHP 用于回显的文件。对于您的目的，这可能是逻辑和设计的合适分离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T01:34:23.643

使用[智能](http://www.smarty.net/about_smarty)。这将有助于将表示方面与 PHP 分开。

# python - python 我如何调试这个 ImportError 没有模块

> ID：13556858
> 
> 赞同：2
> 
> 时间：2012-11-25T23:48:11.067
> 
> 标签：python

我从特定模块导入时遇到问题，但一般不从模块导入。我的项目结构：

```
project-folder
  aaa-folder
    __init__.py
    a.py
  bbb-folder
    __init__.py
    b.py
  ccc-folder
    __init__.py
    c.py 
```

所有的**init** .py 文件都是空白的。项目文件夹在我的 sys.path 中。

模块 b：

```
from aaa.a import a_method
from ccc.c import c_method

def b_method(): print 'bye'
print 'hi' 
```

模块 c：

```
from aaa.a import a_method
from bbb.b import b_method

def c_method(): print 'bye'
print 'hi' 
```

模块一：

```
from bbb.b import b_method
from ccc.c import c_method

def a_method(): print 'bye'
print 'hi' 
```

我可以从 python shell 导入每个方法。模块 b 和 c 都从命令行运行并简单地返回“hi”。当我运行模块 a 时，我得到 ImportError: No module named b

我在哪里可以找到我的问题的线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:06:27.877

正如评论中多次提到的，您正在设计您的项目以使用循环导入：

> 循环导入很好，两个模块都使用“import”形式的导入。当第二个模块想要从第一个模块中获取一个名称（“从模块导入名称”）并且导入位于顶层时，它们会失败。那是因为第一个模块中的名称尚不可用，因为第一个模块正忙于导入第二个模块。

如果您在每个模块的最顶部放置一个打印语句，您将看到正在发生的事情......

示例 a、b、c： `print "inside aaa" # bbb, ccc`

当你执行 module`a`时，你会得到这个：

```
$ python aaa/a.py 
inside aaa
inside bbb
inside aaa
Traceback (most recent call last):
  File "aaa/a.py", line 2, in <module>
    from bbb.b import b_method
  File "/Users/user/Desktop/project/bbb/b.py", line 2, in <module>
    from aaa.a import a_method
  File "/Users/user/Desktop/project/aaa/a.py", line 2, in <module>
    from bbb.b import b_method
ImportError: cannot import name b_method 
```

`a.py`去 import `b.py`，但`b`需要`a`，所以它回到那个模块，在那里它看到了`bbb`导入的其余部分。好吧`b`，此时仅部分加载，因此`b_method`尚未定义。所以你会崩溃。

What you should do is avoid having your modules import each other in circles. There should be a set of common modules for which others all import the shared functionality. But as stated in the python faq, it can be worked around by only importing the module namespace (`import bbb`).

# c# - How to load referenced script libraries from a Roslyn script file?

> ID：13556859
> 
> 赞同：5
> 
> 时间：2012-11-25T23:48:15.033
> 
> 标签：c#, roslyn

I figured out I cannot load one script library from another easily:

module.csx

```
string SomeFunction() {
   return "something";
} 
```

script.csx

```
ExecuteFile("module.csx");
SomeFunction() <-- causes compile error "SomeFunction" does not exist 
```

This is because the compiler does not know of module.csx at the time it compiles script.csx afaiu. I can add another script to load the two files from that one, and that will work. However thats not that pretty.

Instead I like to make my scripthost check for a special syntax "load module" within my scripts, and execute those modules before actual script execution.

script.csx

```
// load "module.csx"
SomeFunction() 
```

Now, with some basic string handling, I can figure out which modules to load (lines that contains // load ...) and load that files (gist here [https://gist.github.com/4147064](https://gist.github.com/4147064)):

```
foreach(var module in scriptModules) {
   session.ExecuteFile(module);
}
return session.Execute(script) 
```

But - since we're talking Roslyn, there should be some nice way to parse the script for the syntax I'm looking for, right?

And it might even exist a way to handle module libraries of code?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T15:51:55.440

目前在 Roslyn 中没有办法引用另一个脚本文件。我们正在考虑`#load`从交互式窗口的宿主命令转变为语言的一部分（如`#r`），但目前尚未实现。

至于如何处理字符串，你可以正常解析它，然后寻找未知类型的预处理器指令并深入研究结构。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-11-19T20:01:23.687

[自https://github.com/dotnet/roslyn/commit/f1702c](https://github.com/dotnet/roslyn/commit/f1702c)`#load`起已添加对 in 脚本文件的支持。

此功能将在 Visual Studio 2015 Update 1 中提供。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-21T19:44:40.670

包括脚本：

```
#load "common.csx"
... 
```

并在运行脚本时配置*源解析器：*

```
Script<object> script = CSharpScript.Create(code, ...);
var options = ScriptOptions.Default.WithSourceResolver(new SourceFileResolver(new string[] { }, baseDirectory));
var func = script.WithOptions(options).CreateDelegate()
... 
```

# php - Removing Semaphore after last sem_release in PHP

> ID：13556860
> 
> 赞同：1
> 
> 时间：2012-11-25T23:48:16.900
> 
> 标签：php, multithreading

I have an operation in PHP that checks if an object with an ID is in a DB and creates an entry for it if it isn't. A request for the same ID can happen concurrently, so I want to prevent the ID from being inserted twice.

I am currently using the following code to lock/unlock access to the DB for that particular key:

```
$semaphore = sem_get($keyForID, 1);

sem_acquire($semaphore);

// 1.) check for id
// 2.) insert object if it doesn't exist

sem_release($semaphore); 
```

**My question is:** Since I'm creating an individual semaphore for every object-ID, do I explicitly have to remove those semaphores with `sem_remove` or does PHP do that automatically after `sem_release`?

If I do have to remove the semaphore explicitly, is there an easy and reliable way of checking if that semaphore is currently acquired by another thread so that latter doesn't crash on `sem_release`? Using shared memory comes to mind, but that would require yet another semaphore to read/write the number of threads.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T09:16:04.980

`sem_remove`显式销毁给定的信号量，这将使其无法用于任何其他正在运行的进程或线程的进一步计算，直到使用`sem_get`. 例如，如果 3 个进程试图访问同一个信号量（只有 1 个并发访问），并且第一个进程在其他两个进程设法获取它之前将其销毁，则后两个进程可能最终并发运行，而不是顺序运行（正如预期的那样）。

您真的不想调用`sem_remove`，除非您知道所有其他正在运行的进程将不再使用它。

无论如何，在您的情况下，我建议您依靠数据库本身进行并发访问。如果您只需要在数据库中创建一个条目，请使用事务。如果您使用的数据库不支持事务，例如 MySQL 上的 MyISAM 引擎，请切换到支持事务的引擎，或者在 MyISAM 的特定情况下，尝试使用[原子操作](https://dev.mysql.com/doc/refman/5.0/en/ansi-diff-transactions.html)。

# windows-phone-7 - 将 Windows Phone WIde Tiles 与 Cordova 一起使用

> ID：13556863
> 
> 赞同：2
> 
> 时间：2012-11-25T23:48:39.603
> 
> 标签：windows-phone-7, cordova, cordova-2.0.0

使用 Cordova 时如何在 Windows Phone 上为 WideTile 指定图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:39:43.627

遗憾的是，目前不支持此选项 [Wide Live Tile]。我将为 WP8 和 WP7.8 创建一个功能请求。LiveTiles 插件的更新版本最有可能登陆到以下位置

[https://github.com/apache/incubator-cordova-wp8/tree/master/plugins/www/plugins/LiveTiles](https://github.com/apache/incubator-cordova-wp8/tree/master/plugins/www/plugins/LiveTiles)

**更新**

更新版本可以在这里找到

[https://github.com/sgrebnov/incubator-cordova-wp8/tree/master/plugins/www/plugins/LiveTiles](https://github.com/sgrebnov/incubator-cordova-wp8/tree/master/plugins/www/plugins/LiveTiles)

示例使用

```
 navigator.plugins.liveTiles.updateAppTile(success, fail, {
            title: document.getElementById('title').value,
            image: 'Images/appbar.next.rest.png',
            count: document.getElementById('count').value,
            backTitle: 'Back title',
            backContent: 'Back side',
            backImage: 'Images/appbar.close.rest.png',
            smallImage: 'Images/appbar.save.rest.png',
            wideContent: 'This is wide content',
            wideImage: 'Images/appbar.stop.rest.png',
            wideBackImage: 'Images/appbar.feature.video.rest.png'
        }); 
```

# algorithm - 逻辑表达式的交叉算法？

> ID：13556865
> 
> 赞同：4
> 
> 时间：2012-11-25T23:48:53.427
> 
> 标签：algorithm, math, logic, boolean-logic

给定一组 n 个元素`U`和一组 m 个属性`P`，其中 P 的每个元素定义一个从 U 到布尔值的函数。

给定以下形式的两个复合逻辑表达式（递归定义）：

```
p1 : true iff p1(x) is true
e1 and e2 : means e1 and e2 are both true
e1 or e2 : means e1 and e2 are not both false
not e1 : true iff e1 is false
(e1) : true iff e1 
```

这些逻辑表达式被解析为表达式语句（解析树）。

假设对于任何 p1、p2：所有四个集合（p1 和 p2）、（p1 和非 p2）、（非 p1 和 p2）、（非 p1 和非 p2）都是非空的。

我想确定逻辑表达式 L1 是否是 L2 的子集。即对于 U 中的每个元素 x，如果 L1(x) 为真，则 L2(x) 为真。

例如：

```
is_subset(not not p1, p1) is true
is_subset(p1, p2) is false
is_subset(p1 and p2 and p3, (p1 and p2) or p3) is true 
```

我想我需要以某种方式“规范化”解析树，然后比较它们。任何人都可以概述一种方法或勾勒出一个架构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T06:36:11.093

由于您不对对象 (x) 做任何事情，因此您似乎需要命题逻辑，其中`p1`to的所有真值组合`pn`都是可能的。

所以本质上你想在命题逻辑中做定理证明。

Your`is_subset(e1,e2)`转换为逻辑运算符`e1 implies e2`，与`not e1 or e2`. 要知道这些是否普遍适用，您可以使用诸如[DPLL](https://en.wikipedia.org/wiki/DPLL_algorithm)之类的可满足性检查算法来检查否定是否不可满足。

这只是一个起点，还有许多其他选项可以证明命题逻辑中的定理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T00:04:27.443

我认为您的讲师本质上是希望您实施[Quine-McCluskey 算法](http://en.wikipedia.org/wiki/Quine%E2%80%93McCluskey_algorithm) 请注意，正如另一个答案所暗示的那样，执行时间增长得非常快，因为问题是-NP Hard。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:56:39.320

您可以将每个公式转换为[析取范式](http://en.wikipedia.org/wiki/Disjunctive_normal_form)，并查找其中一个是否包含另一个中的连接子句的子集。这种方法的复杂性随着提到的 pn 数量的指数而增加。

# c# - 如何重构此 if 语句以添加或更新字典？

> ID：13556872
> 
> 赞同：1
> 
> 时间：2012-11-25T23:50:01.177
> 
> 标签：c#, dictionary, delegates, refactoring

这是我的代码：

```
var messageHandlers = new Dictionary<Type, Action<T>>();

public static void Subscribe(Action<T> message)
{
    if (messageHandlers.ContainsKey(typeof(T)))
    {
        messageHandlers[typeof(T)] += message;
    }
    else
    {
        messageHandlers.Add(typeof(T), message);
    }
} 
```

有什么办法可以使这成为一个单行列吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:52:41.183

你不能让它成为一个单线，但你可以让它更快：

```
Action<T> current;
messageHandlers.TryGetValue(typeof(T), out current);
messageHandlers[typeof(T)] = current + message; 
```

索引器将`Dictionary<>`添加不存在的键。

如果切换到 a `ConcurrentDictionary<>`，则可以将其设为单线：

```
dict.AddOrUpdate(typeof(T), message, (key, current) => current + message); 
```

# c# - 我应该如何设置子类中属性的默认值？

> ID：13556874
> 
> 赞同：2
> 
> 时间：2012-11-25T23:50:07.043
> 
> 标签：c#, .net-3.5, windows-forms-designer

给定一个我无法更改的超类，它定义了某个属性，我最好如何在子类中设置它的默认值？

例如，假设我正在子类`System.Windows.Forms.ToolStripButton`化并希望为该`Text`属性设置一个默认值。（对于更复杂的示例，我还想定义点击处理程序，例如 `Click += new EventHandler(click)`。）我最好如何做到这一点？

我有的一些想法：

*   在构造函数中设置它。但是有多个构造函数，这可行吗？（我还没有完全掌握构造函数是如何相互配合的。我可以只更新一个并让它们全部为 Just Work™ 吗？）

*   将其设置为字段，即`public string Text = "foo";`如我所料，这是行不通的。

*   总是调用某个方法来设置这些值（我可能会命名它，例如，`InitializeComponent`）。

理想情况下，我将进一步对此类进行子类化，并希望在其中定义默认值。我想对于那方面我会有受保护的字段并让构造函数或方法读取这些值并分配它们。

还有其他我没有想到的方法吗？

或者我的设计似乎不正确？我还可以使用不同的类并在其中使用一个`ToolStripButton`实例——聚合而不是继承。（我想得越多，就越觉得这可能是正确的答案。）

这是我确切知道如何在 Python 中做的事情，但在 C# 中看起来不太优雅（我知道：不同风格的语言、权衡等；我不是在批评 C#）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:59:21.280

构造函数可能是最简单的路线。如果有问题，您总是可以菊花链式连接构造函数，例如：

```
public Foo() : this(12, "abc") {}
public Foo(int bar, string name) {
    this.bar = bar;
    this.name = name;
} 
```

另一个选项是显式属性（不是自动属性）和字段初始化器：

```
private int bar = 12;
public int Bar {
     get { return bar; }
     set { bar = value; }
} 
```

在任何一种情况下，您都应该考虑添加`[DefaultValue(...)]`到属性中，以便绑定（UI、序列化程序等）知道它。在这种情况下，`[DefaultValue(12)]`。

# c++ - 在 C++ 和 eof 中读取文件

> ID：13556875
> 
> 赞同：1
> 
> 时间：2012-11-25T23:50:25.643
> 
> 标签：c++, file-io, eof

如果我正在读取这样的 C++ 文件：

```
//Begin to read a file
  FILE *f = fopen("vids/18.dat", "rb");
  fseek(f, 0, SEEK_END);
  long pos = ftell(f);
  fseek(f, 0, SEEK_SET);

  char *m_sendingStream = (char*)malloc(pos);
  fread(m_sendingStream, pos, 1, f);
  fclose(f);
  //Finish reading a file 
```

我首先有两个问题：这是在读取整个文件吗？（我希望它这样做），第二我如何创建一个持续到文件末尾的时间？我有：

`while(i < sizeof(m_sendingStream))`

但我不确定这是否有效，我一直在阅读（我以前从未用 C++ 编程过），我认为我可以使用`eof()`，但显然这是不好的做法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:55:03.603

从文件中读取时不需要循环，因为您将一次性使用代码获取全部内容。当然，您仍然应该记录并检查返回值：

```
size_t const n = fread(buf, pos /*bytes in a record*/, 1 /*max number of records to read*/, f);

if (n != 1) { /* error! */ } 
```

您还可以编写一个循环，在不知道文件大小的情况下读取到文件末尾（例如，从管道读取或增长的文件）：

```
#define CHUNKSIZE 65536
char * buf = malloc(CHUNKSIZE);
{
   size_t n = 0, r = 0;

   while ((r = fread(buf + n, 1 /*bytes in a record*/, CHUNKSIZE /*max records*/, f)) != 0)
   {
      n += r;

      char * tmp = realloc(buf, n + CHUNKSIZE);

      if (tmp) { buf = tmp; }
      else     { /* big fatal error */ }
   }

   if (!feof(f))
   {
      perror("Error reading file");
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T00:00:54.733

这是处理文件的 C 风格，C++ 风格将使用[`fstream`](http://www.cplusplus.com/doc/tutorial/files/)库。

关于您的第二个问题，检查您是否在文件末尾的一个好方法是使用该[`feof`](http://www.cplusplus.com/reference/cstdio/feof/)功能。

# ruby-on-rails - 带有 ruby 1.9.3-p194 和 rvm 的 linecache19

> ID：13556876
> 
> 赞同：0
> 
> 时间：2012-11-25T23:50:38.653
> 
> 标签：ruby-on-rails, ruby, rubymine, linecache

我一直在尝试`linecache19`按照这些[说明进行安装](https://gist.github.com/2435951)

```
curl -OL http://rubyforge.org/frs/download.php/75414/linecache19-0.5.13.gem
gem install linecache19-0.5.13.gem -- --with-ruby-include=$rvm_path/src/ruby-1.9.3-p194/ 
```

我似乎能够运行`curl -OL http://rubyforge.org/frs/download.php/75414/linecache19-0.5.13.gem`得很好，但是当我运行时，`gem install linecache19-0.5.13.gem -- --with-ruby-include=$rvm_path/src/ruby-1.9.3-p194/`我得到了这个输出：

```
ERROR:  Could not find a valid gem 'linecache19-0.5.13.gem' (>= 0) in any repository
ERROR:  Possible alternatives: linecache193 
```

我在我的 rails 应用程序的根目录中运行所有这些命令。

**编辑** 我正在使用 RubyMine，所以我认为我必须坚持使用较旧的调试工具

**编辑 2** 我通过访问 ruby​​gems 页面并从那里下载 linecache19，然后`gem install`从下载目录运行来实现这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:07:33.077

`curl`当我尝试宝石时，有些不对劲。当我访问 ruby​​forge 站点并手动下载 gem 时，一切正常。

# ios - iOS 从 RSS Feed 获取日期字符串

> ID：13556884
> 
> 赞同：0
> 
> 时间：2012-11-25T23:51:18.013
> 
> 标签：ios, xcode, rss, ios6, nsattributedstring

我有一个 XML 解析器，它使用 RaptureXML 来抓取每个项目并将其显示在表格单元格中。我已经可以得到标题和描述，但我似乎无法弄清楚如何得到日期。

这是我到目前为止的日期：

```
NSString* dateString;

NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"EEEE MMMM d, YYYY"];
dateString = [formatter stringFromDate:self.pubDate];

[articleAbstract appendAttributedString:
 [[NSAttributedString alloc] initWithString: dateString]
 ]; 
```

我一直在调试器中显示这个：

```
'NSInvalidArgumentException', reason: 'NSConcreteAttributedString initWithString:: nil value' 
```

我不知道我做错了什么。这是完整的代码：

**RSSItem.h**

```
#import <Foundation/Foundation.h>

@interface RSSItem : NSObject

@property (strong, nonatomic) NSString* title;
@property (strong, nonatomic) NSString* description;
@property (strong, nonatomic) NSURL* link;
@property (strong, nonatomic) NSAttributedString* cellMessage;
@property (strong, nonatomic) NSDate* pubDate;
@property (strong, nonatomic) NSString* dateString;

@end 
```

**RSSItem.m**

```
#import "RSSItem.h"
#import "GTMNSString+HTML.h"

@implementation RSSItem

-(NSAttributedString*)cellMessage 
```

{ if (_cellMessage!=nil) return _cellMessage;

```
NSDictionary* boldStyle = @{NSFontAttributeName: [UIFont fontWithName:@"Helvetica-Bold" size:16.0]};
NSDictionary* normalStyle = @{NSFontAttributeName: [UIFont fontWithName:@"Helvetica" size:16.0]};

NSMutableAttributedString* articleAbstract = [[NSMutableAttributedString alloc] initWithString:self.title];

[articleAbstract setAttributes:boldStyle
                         range:NSMakeRange(0, self.title.length)];

[articleAbstract appendAttributedString:
 [[NSAttributedString alloc] initWithString:@"\n\n"]
 ];

// Parse for date

NSString* dateString;

NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"EEEE MMMM d, YYYY"];
dateString = [formatter stringFromDate:self.pubDate];

[articleAbstract appendAttributedString:
 [[NSAttributedString alloc] initWithString: dateString]
 ];

[articleAbstract appendAttributedString:
 [[NSAttributedString alloc] initWithString:@"\n\n"]
 ];

int startIndex = [articleAbstract length];

NSString* description = [NSString stringWithFormat:@"%@...", [self.description substringToIndex:100]];
description = [description gtm_stringByUnescapingFromHTML];

[articleAbstract appendAttributedString:
 [[NSAttributedString alloc] initWithString: description]
 ];

[articleAbstract setAttributes:normalStyle
                         range:NSMakeRange(startIndex, articleAbstract.length - startIndex)];

_cellMessage = articleAbstract;
return _cellMessage;

}

@end 
```

**编辑：这是我的 RSS 加载器**

```
#import "RSSItem.h"

#define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)

@implementation RSSLoader

-(void)fetchRssWithURL:(NSURL*)url complete:(RSSLoaderCompleteBlock)c
{
dispatch_async(kBgQueue, ^{

    //work in the background
    RXMLElement *rss = [RXMLElement elementFromURL: url];
    RXMLElement* title = [[rss child:@"channel"] child:@"title"];        
    RXMLElement* pubDate = [[rss child:@"channel"] child:@"pubDate"];

    NSString *usableDate = [pubDate];       

    NSArray* items = [[rss child:@"channel"] children:@"item"];

    NSMutableArray* result = [NSMutableArray arrayWithCapacity:items.count];

    //more code
    for (RXMLElement *e in items) {

        //iterate over the articles
        RSSItem* item = [[RSSItem alloc] init];
        item.title = [[e child:@"title"] text];            
        item.pubDate = usableDate
        item.description = [[e child:@"description"] text];
        item.link = [NSURL URLWithString: [[e child:@"link"] text]];
        [result addObject: item];
    }

    c([title text], result);
});

} 
```

有人可以帮我正确解析我的日期吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:55:54.740

看起来 stringFromDate 返回 nil。

如果您的意思是 YYYY 是年份，那是不正确的，您应该改用 yyyy。但我认为日期格式不存在这个问题。也许 pubDate 为零？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T00:18:08.153

根据您添加到问题中的代码，问题与您如何设置`pubDate`属性有关。您将属性定义为 an，`NSDate`但您`NSString`在 RSS 加载器代码中为该属性设置了一个值。

您需要将从 XML 文件获得的字符串转换为 NSDate 或将您的`pubDate`属性从更改`NSDate`为`NSString`. 如果您执行后者，则需要更新您之前的代码以反映此更改。

该决定实际上取决于您需要对日期做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-17T04:49:33.710

您必须保留日期对象。每当您将日期对象分配给另一个字符串或日期格式化程序时，只需给出 [日期保留]。它可以工作

# c++ - 如何在 CMake 中更改 Win32 构建的可执行输出目录？

> ID：13556885
> 
> 赞同：16
> 
> 时间：2012-11-25T23:51:38.090
> 
> 标签：c++, visual-studio, cmake

我的问题是这样的：我正在使用 Visual Studio 2010 开发一个小型解析器。我使用 CMake 作为构建配置工具。

但是我发现默认的可执行构建行为很不方便。我想要的是，让我的最终程序位于：

```
E:/parsec/bin/<exe-name>.<build-type>.exe 
```

而不是

```
E:/parsec/bin/<build-type>/<exe-name>.exe 
```

你将如何使用 CMake 做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-26T09:47:04.657

有几种选择：

1.  构建后复制可执行文件
2.  自定义可执行文件的输出目录

## 构建后复制可执行文件

成功构建后，您可以复制可执行文件（请参阅初学者答案），但使用安装目标可能会更好：

使用[install](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:install)命令指定将被复制到[CMAKE_INSTALL_PREFIX](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_INSTALL_PREFIX)目录的目标（可执行文件、库、头文件等）。您可以在 cmake 的命令行上（或在 cmake GUI 中）指定 CMAKE_INSTALL_PREFIX。

## 自定义可执行文件的输出目录

**警告：**不建议直接在 cmakelists.txt 中设置绝对路径。

使用[set_target_properties](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:set_target_properties)自定义[RUNTIME_OUTPUT_DIRECTORY](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#prop_tgt:RUNTIME_OUTPUT_DIRECTORY)

```
set_target_properties( yourexe PROPERTIES RUNTIME_OUTPUT_DIRECTORY E:/parsec/bin/ ) 
```

作为替代方案，修改[CMAKE_RUNTIME_OUTPUT_DIRECTORY](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_RUNTIME_OUTPUT_DIRECTORY)允许您为cmake 项目中的**所有目标指定此项。**在构建 dll 时，请注意修改[CMAKE_LIBRARY_OUTPUT_DIRECTORY 。](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_LIBRARY_OUTPUT_DIRECTORY)

```
set( CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin )
set( CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib ) 
```

**附加信息**：看看这些问题：

*   [在 CMake 中，如何解决 Visual Studio 2010 尝试添加的调试和发布目录？](https://stackoverflow.com/questions/7747857/in-cmake-how-do-i-work-around-the-debug-and-release-directories-visual-studio-2)

*   [CMake：根据 CMake 生成的项目中的配置更改 Visual Studio 和 Xcode 可执行文件的名称](https://stackoverflow.com/questions/6561754/cmake-changing-name-of-visual-studio-and-xcode-exectuables-depending-on-config)

*   [如何不将发布或调试添加到输出路径？](https://stackoverflow.com/questions/8848268/how-to-not-add-release-or-debug-to-output-path)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T00:12:27.240

很可能您需要使用一个单独的自定义命令来复制您的二进制文件，该命令看起来类似于以下命令：

```
add_custom_command(target your_target_name
          POST_BUILD
          COMMAND ${CMAKE_COMMAND} -E copy ${EXAMPLE_BIN_NAME} ${PROJECT_BINARY_DIR}/.
) 
```

# c# - 与 C# 的接口序言

> ID：13556887
> 
> 赞同：4
> 
> 时间：2012-11-25T23:51:58.897
> 
> 标签：c#, prolog

我尝试将 C# 与 prolog 接口我已使用此链接： [在此处输入链接描述](http://www.swi-prolog.org/contrib/CSharp.html)

我已添加 SwiPlCs.dll 作为对我的项目的引用，然后使用文档中的第一个代码

```
using System;
using SbsSW.SwiPlCs;

namespace HelloWorldDemo

{

class Program
{
    static void Main(string[] args)
    {
        //Environment.SetEnvironmentVariable("SWI_HOME_DIR", @"the_PATH_to_boot32.prc");
        if (!PlEngine.IsInitialized)
        {
            String[] param = { "-q" };  // suppressing informational and banner messages
            PlEngine.Initialize(param);
            PlQuery.PlCall("assert(father(martin, inka))");
            PlQuery.PlCall("assert(father(uwe, gloria))");
            PlQuery.PlCall("assert(father(uwe, melanie))");
            PlQuery.PlCall("assert(father(uwe, ayala))");
            using (PlQuery q = new PlQuery("father(P, C), atomic_list_concat([P,' is_father_of ',C], L)"))
            {
                foreach (PlQueryVariables v in q.SolutionVariables)
                    Console.WriteLine(v["L"].ToString());

                Console.WriteLine("all child's from uwe:");
                q.Variables["P"].Unify("uwe");
                foreach (PlQueryVariables v in q.SolutionVariables)
                    Console.WriteLine(v["C"].ToString());
            }
            PlEngine.PlCleanup();
            Console.WriteLine("finshed!");
        }
    }
}

} 
```

但总是有一个例外..据说：

> 指定的模块无法找到。（来自 HRESULT 的异常：0x8007007E

他们在 SWI-prolog 中谈到了这个错误：

> 如果找不到 libswipl.dll 或其依赖项之一，您将收到类似 System.IO.FileNotFoundException: Das angegebene Modul wurde nicht gefunden 的错误。（Ausnahme von HRESULT：0x8007007E）

我已将 libswipl.dll 从程序 bin 复制到我项目中的 bin/debug 文件夹中，但它仍然是同样的问题。

我该怎么办？？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T08:13:31.180

您是否已声明 SWI_HOME_DIR ？应该指向 c`\Program Files\pl

C# 接口不适用于 Windows 7 64 位、Visual Studio 2010 专业版。似乎是一个错误，Uwe Lesta 应该尽快修复这个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T18:32:51.053

我有同样的错误，所以我下载了 SwiPlCs_1.1.60301.0 并且我将 SwiPlCs64.dll 的名称更改为 SwiPlCs.dll 并且我将它添加为 Visual Studio 中的参考并且它有效:) PS：我正在使用 Visual Studio 2010 和 Windows 7 64 位。希望这可以帮助 ：）

# c# - Windows Phone 资源密集型任务退出

> ID：13556889
> 
> 赞同：0
> 
> 时间：2012-11-25T23:52:05.620
> 
> 标签：c#, silverlight, windows-phone-7, scheduled-tasks, background-agents

我正在编写一个 Windows Phone 应用程序，它需要下载非常大的 mp3 文件，并将它们保存到独立的存储中。我已经得到了所有的代码，我用较小的文件对其进行了测试，但是现在使用实际的文件并使用调试输出监视代码正在做什么，我意识到线程实际上在中途退出下载，并且文件从未真正完成下载。

发生这种情况是否有原因，如果有，我能做些什么来防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:10:49.313

多久后超时？如果您使用 HttpWebRequest 下载文件，则默认超时为 100,000 毫秒（100 秒）。这可以像插入一样简单地更改：

```
HttpWebRequest.Timeout = 10; 
```

显然设置您自己的超时（以毫秒为单位！）并将其附加到您的 WebRequest :)

如果您不使用 HttpWebRequest，请告诉我您在使用什么，我会尽力帮助您:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T00:13:56.707

WP 的内部存储器和进程管理负责这一点。如果您从您的应用程序中生成了一个线程，该线程在后台操作系统中下载了大量数据，那么当其他进程需要这些资源（大多数情况下是内存）时，会将其丢弃。

您可以做两件事，具体取决于您的下载方法：

1.  当缓冲区达到一定大小时，定期将缓冲区块保存在隔离存储中，从而限制线程的内存使用。
2.  将下载线程实现为 BackgroundTask，它应该允许“无休止”的执行。

# c++ - 为什么我必须按两次回车？

> ID：13556890
> 
> 赞同：2
> 
> 时间：2012-11-25T23:52:14.170
> 
> 标签：c++, iostream

出于某种原因，当我到达某个位置时，我必须按`Enter`两次才能提交。我添加了 clear 以防止它跳过输入，并添加了 ignore() 以防止它在缓冲区中保留任何额外的字符。我输入我的输入，然后它下降到一个新行，我`Enter`再次点击它输入输入并继续程序没问题，但我想知道为什么。这是一个代码片段：

```
 cin.ignore();
    cout << "Enter Student Major (ex. COSC): ";
    cin.getline(student.major, 6);

    for(int i = 0; i < sizeof(student.major); i++)
        student.major[i] = toupper(student.major[i]);

    cin.clear();
    cin.ignore(numeric_limits<streamsize>::max(), '\n'); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T00:04:27.367

在我看来，你折腾太多了[`cin.ignore()`](http://en.cppreference.com/w/cpp/io/basic_istream/ignore)，不知道为什么需要它们以及何时将它们放在那里。

有两种常见情况`cin.ignore()`需要“使输入正常工作”：

1.  混合格式化和未格式化输入时；
2.  从格式化的输入错误中恢复。

在这两种情况下，您都希望从输入缓冲区中删除虚假字符；如果没有任何这样的字符（这可能是您的程序中发生的情况），`cin.ignore()`将暂停执行并等待用户输入 - 毕竟，您要求它忽略某些字符，该死的，它会服从它的命令。

（尽管`ignore()`默认情况下只会“吃掉”一个字符，无论它可能是什么，执行都会暂停，直到找到换行符，因为默认情况下`cin`是行缓冲的 - 在收到换行符之前不会检查新输入）

### 情况1：

`cin.ignore()`*如果您在执行格式化的输入*操作（即使用运算符）之后执行*未格式化的输入*操作（如），则通常需要调用。`getline`*`>>`*

 *发生这种情况是因为`>>`操作员将换行符留在输入缓冲区中；如果您只执行格式化的输入操作，这不是问题（默认情况下，它们会在尝试解释输入之前跳过所有空格），但如果之后您执行未格式化的输入，则会出现问题：`getline`默认情况下会读取直到找到换行符，所以留下“虚假换行符”将使其立即停止阅读。

因此，在这里您通常会在您`cin.ignore(...)`连续执行的最后一个格式化输入操作之后调用 call 以摆脱换行符，从而保证输入缓冲区为空。之后，您可以放心`getline`地直接调用，因为您知道缓冲区是空的。

相反，将它放在any*之前*`getline`是一个坏主意，就像您在代码中所做的那样，因为可能存在导致`getline`输入缓冲区干净的代码路径，因此`ignore`调用将阻塞。

### 案例二：

当`istream`在格式化输入操作中遇到错误时，它会将“坏”字符留在缓冲区中，因此如果您重试该操作，您将无休止地卡住，因为违规者仍然存在。通常的`clear()/ignore()`习语来拯救，从输入缓冲区中删除整个违规行。

同样，您不会`clear()/ignore()`随机放置序列，而是仅在您从格式化输入操作（设置流的失败位）中获得输入错误之后。

* * *

现在，除了这些情况之外，它并不常见`cin.ignore()`（除非你真的想跳过字符）；不要随意散布它“只是为了安全”，否则你会遇到你描述的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:58:49.807

我认为在输入`cin.ignore(numeric_limits<streamsize>::max(), '\n');`中期待 a`\n`但它没有找到它，所以你必须`Enter`再次按下它才能找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T00:01:06.457

答案可以在[这里](http://www.cplusplus.com/reference/istream/istream/ignore/)找到。

> 当 n 个字符被提取并丢弃或找到字符分隔符时，提取结束，以先到者为准。在后一种情况下，delim 字符本身也被提取。

`'\n'`因此，在您的情况下，该程序将在收到字符之前不会继续。*

# php - PHP：使用 curl 向 .php 文件发送 POST 请求时遇到困难

> ID：13556891
> 
> 赞同：1
> 
> 时间：2012-11-25T23:52:20.120
> 
> 标签：php, curl, http-post

我有一个 php 文件，假设`A.php`它通过方法获取一些变量`$_POST`并更新本地数据库。

另一个具有该名称的 php 文件以`dataGather.php`正确的形式收集数据，然后尝试使用该`A.php`文件将数据发送到本地数据库。请注意，这两个文件都在同一个目录中。

我使用 curl 函数执行`POST`请求的代码如下：

```
 $url = "A.php";
    $ch = curl_init();
    $curlConfig = array(
        CURLOPT_URL            => $url,
        CURLOPT_POST           => true,
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_POSTFIELDS     => $datatopost
    );
    curl_setopt_array($ch, $curlConfig);
    $result = curl_exec($ch);
    curl_close($ch);
    echo $result; 
```

`$datatopost`

是一个数组，如下所示：

```
$datatopost = array (
       "value1" => $val1,
       "value2" => $val2,
        etc
 } 
```

问题是当我运行我的程序时，我得到以下结果：

```
Fatal error: Maximum execution time of 30 seconds exceeded in 
        C:\xampp\htdocs\dataGather.php on line 97 
```

有谁知道为什么会这样？提前致谢

PS：该文件`A.php`是 100% 正确的，因为我已经通过收集 javascript 所需的信息对其进行了测试。它以我想要的方式通知数据库。该数组`$datatopost`还具有正确形式的所有信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:00:16.200

我怀疑你直接运行你的 php 脚本而不使用 web 服务器，而是简单地将脚本作为可执行文件启动。错误消息中有绝对路径这一事实表明了这一点。虽然运行这样的 php 脚本绝对没问题，但您必须问自己：该 cURL 调用实际上是做什么的？它不会*打开*并运行`A.php`您尝试引用的 php 文件。为什么不？因为 cURL 打开的是*URL*，而不是文件。如果不使用可以对 url 请求做出反应的服务器（例如 http 服务器），您期望会发生什么？

您得到的错误是超时，因为 cURL 尝试联系 http 服务器。由于您没有指定有效的 URL，它很可能会退回到“localhost”。但是那里没有服务器在听...

# ruby-on-rails - ActiveRecord：从主键数组中加载相应的记录数组（保持顺序、重复、最大化性能）

> ID：13556898
> 
> 赞同：2
> 
> 时间：2012-11-25T23:53:15.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, eager-loading

（原为：*ActiveRecord 中的反向急切加载*）

我有一个奇怪的问题，我知道我需要使用急切加载，但由于这是一个如此奇怪的用例，它不能很好地工作。

**代码**：

```
class Task < ActiveRecord::Base
 belongs_to :project

class Project < ActiveRecord::Base
 has_many :tasks 
```

**问题**：

我知道在您拥有一个项目并想要渲染任务的传统设置中，您使用即时加载来加载任务一次，而不是按顺序迭代它们。但是，就我而言，我有一个任务列表，并且对于每个任务，我都需要获取适当的项目。顺序渲染时，Rails SQL 缓存会有所帮助，但我有很多任务，所以我最终会一遍又一遍地加载同一个项目。

我能做些什么来避免这种混乱的局面？

**编辑**：

我试图澄清情况。我有多个任务 ID 数组。IE

```
type_a_tasks = [1,2,3,1,2,3]
type_b_tasks = [1,2,2,3,3] 
```

请注意，可以有相同的任务。现在我想，就像在函数式编程中一样，映射列表，以便我得到实际任务及其关联，而不是 id

```
type_a_tasks = [Task #1, Task #2, etc.]
type_b_tasks = [Task #1, Task #2, etc.] 
```

我知道我可以通过

```
Task.includes(:project).find(task_a_tasks.concat(task_b_tasks)) 
```

但后来我将它减少到任务集并丢失了我的集合的顺序。这更清楚吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T03:53:33.230

让我们先从最明显的方法开始：

```
type_a_task_ids = [1,2,3,1,2,3]
type_b_task_ids = [1,2,2,3,3] 
type_a_tasks = type_a_task_ids.map { |task_id| Task.includes(:project).find(task_id) }
type_b_tasks = type_b_task_ids.map { |task_id| Task.includes(:project).find(task_id) } 
```

以上内容很简单，可读但可能**很慢**：它将为给定任务中的每个不同执行一次数据库往返，`task_id` *并为每个不同执行一次数据库往返。*`project_id`所有的延迟加起来，所以你想批量加载任务（和相应的项目）。

如果您可以让 Rails**批量加载（预取）并**在两次往返中预先缓存这些相同的记录（一次用于所有不同的任务，一次用于所有不同的关联项目），然后只需准确与上面相同的代码——除了`find`总是命中缓存而不是数据库。

不幸的是，在 Rails 中，事情并不是这样（默认情况下）工作的，因为`ActiveRecord` [它使用了*查询缓存*](http://guides.rubyonrails.org/caching_with_rails.html#sql-caching)。在( ) 之后运行`Task.find(1)`( ) 将不会利用查询缓存，因为第一个查询与第二个查询不同。（不过，运行第二次、第三次等时间*将*利用查询缓存，因为 Rails 将多次看到完全相同的查询并返回缓存的结果集。）`SELECT * FROM tasks WHERE id=1``Task.find([1,2,3])``SELECT * FROM tasks WHERE id IN (1,2,3)``Task.find(1)`*`SELECT`*

 *进入[`IdentityMap`](http://api.rubyonrails.org/classes/ActiveRecord/IdentityMap.html)缓存。Identity Map Caching 的不同之处在于它在每个表和主键的基础上缓存记录，而不是查询。因此，running`Task.find([1,2,3])`将填写 Identity Map Cache for table 中的三个记录（分别具有 ID 和ID`tasks`的条目），随后将立即返回 table和 ID的缓存记录。`1``2``3``Task.find(1)``tasks``1`

```
# with IdentityMap turned on (see IdentityMap documentation)
# prefetch all distinct tasks and their associated projects
# throw away the result, we only want to prep the cache
Task.includes(:project).find(type_a_task_ids & type_b_task_ids)
# proceed with regular logic
type_a_task_ids = [1,2,3,1,2,3]
type_b_task_ids = [1,2,2,3,3] 
type_a_tasks = type_a_task_ids.map { |task_id| Task.includes(:project).find(task_id) }
type_b_tasks = type_b_task_ids.map { |task_id| Task.includes(:project).find(task_id) } 
```

但是，`IdentityMap` [默认情况下从未处于活动状态（有充分的理由）](https://stackoverflow.com/questions/6905891/rails-3-1-identity-map-issues)，并[最终从 Rails 中删除](https://github.com/rails/rails/pull/5261)。

如果没有 ，您如何获得相同的结果`IdentityMap`？简单的：

```
# prefetch all distinct tasks and their associated projects
# store the result in our own identity cache
my_tasks_identity_map = \
  Hash[Task.includes(:project).find(type_a_task_ids & type_b_task_ids).map { |task|
    [ task.id, task ]
  }]
# proceed with cache-centric logic
type_a_task_ids = [1,2,3,1,2,3]
type_b_task_ids = [1,2,2,3,3] 
type_a_tasks = type_a_task_ids.map { |task_id| my_tasks_identity_map[task_id] }
type_b_tasks = type_b_task_ids.map { |task_id| my_tasks_identity_map[task_id] } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T06:06:38.013

我想我看到了你的问题，那就是如果你有一堆任务都属于同一个项目，你将多次加载该项目。

假设您已经有一个 Task 对象数组，那么这个怎么样？

```
project_ids = @tasks.map{|task| task.project_id}.uniq
@projects = Project.find(project_ids) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T17:44:34.597

如果您通过以下行在 Rails 中启用 IdentityMap `config/application.rb`：

`config.active_record.identity_map = true`

然后 ActiveRecord 实际上不会返回数据库来加载`Project`它之前已经加载的数据——它只会引用内存中的同一个对象。*

# python - Python用'self'调用map()

> ID：13556902
> 
> 赞同：1
> 
> 时间：2012-11-25T23:53:47.300
> 
> 标签：python, self

我有这个功能（包括描述）：

```
def deep_list(x):
    """fully copies trees of tuples to a tree of lists.
    deep_list( (1,2,(3,4)) ) returns [1,2,[3,4]]"""
    if type(x)!=type( () ):
        return x
    return map(deep_list,x) 
```

我想将该函数插入到我制作的函数类中，所以我需要`self`在开头添加函数参数。

我的问题是这样的：如何以正确的方式`self`在 'map' 函数的末尾插入`deep_list`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T23:58:34.727

取决于`x`与您的班级的关系。

一种方法是使函数成为静态方法。这可能是最不可能的

```
@staticmethod
def deep_list(x):
    """fully copies trees of tuples to a tree of lists.
       deep_list( (1,2,(3,4)) ) returns [1,2,[3,4]]"""
    if type(x)!=type( () ):
        return x
    return map(deep_list,x) 
```

如果你的意思是对一个属性进行操作，那么就这样做吧

```
def deep_list(self):
    """fully copies trees of tuples to a tree of lists.
       deep_list( (1,2,(3,4)) ) returns [1,2,[3,4]]"""
    if type(self.x)!=type( () ):
        return self.x
    return map(deep_list, self.x) 
```

最后，如果您要继承`list`或制作类似类的序列，您可以只使用`self`

```
def deep_list(self):
    """fully copies trees of tuples to a tree of lists.
       deep_list( (1,2,(3,4)) ) returns [1,2,[3,4]]"""
    if type(self)!=type( () ):
        return self
    return map(deep_list, self) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T23:56:20.840

我不确定我是否理解您的要求，但是如果您映射绑定方法，则 self 将已包含在内：

```
>>> class Foo(object):
...     def func(self, x):
...         return x + 2
>>> f = Foo()
>>> map(f.func, [1, 2, 3])
[3, 4, 5] 
```

# sharepoint-2010 - 自定义 Web 部件如何读取显示/编辑表单中的列表项字段？

> ID：13556905
> 
> 赞同：1
> 
> 时间：2012-11-25T23:54:30.840
> 
> 标签：sharepoint-2010

我需要创建一个自定义 Web 部件并以编程方式附加到列表的显示和编辑表单。Web 部件旨在显示有关表单上显示的列表项的一些信息（来自另一个列表）。

我知道如何以编程方式将 Web 部件添加到列表中，但我在尝试让 Web 部件读取正在显示的列表项时遇到问题。我知道 SPForm 对象公开了它的父列表，但我不能或不知道如何将表单转换为 SPForm 对象。Web 部件的父级是 Web 部件管理器，其父级是 HTML 表单对象。但是当我尝试将其转换为 SPForm 对象时，它会引发错误。

此外，即使我设法掌握了 SPForm 及其父列表，我如何才能掌握正在显示的列表项？

请记住，我需要避免覆盖默认表单，因为它会显着增加开发时间。

任何帮助或想法表示赞赏。

问候

# http - HTTP，始终使用持久连接？

> ID：13556906
> 
> 赞同：0
> 
> 时间：2012-11-25T23:54:38.703
> 
> 标签：http, persistent-connection

我可以理解，持久连接与 HTML-Webobject 结合使用。但据我所知，几乎每个请求都使用持久连接。对图片、Javascript、HTML...等的请求。你能解释一下这个用法以及这些连接打开了多长时间？浏览器会关闭它们还是关闭 Web 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T23:57:32.123

有一篇非常好的维基百科文章：[http ://en.wikipedia.org/wiki/HTTP_persistent_connection#HTTP_1.1](http://en.wikipedia.org/wiki/HTTP_persistent_connection#HTTP_1.1)

# kinect - 如何将 Kinect 骨架对象复制到另一个 Kinect 骨架对象

> ID：13556910
> 
> 赞同：1
> 
> 时间：2012-11-25T23:55:54.430
> 
> 标签：kinect, kinect-sdk, kinect.toolbox

我正在使用 Kinect 工具箱，所以我手上有一个列表`ReplaySkeletonFrames`。我正在遍历这个列表，获取第一个跟踪的骨架并修改一些属性。

众所周知，当我们改变一个对象时，我们也改变了原来的对象。

我需要复制一个骨架。

注意：我不能使用`CopySkeletonDataTo()`，因为我的框架是 a`ReplaySkeletonFrame`而不是`ReplayFrame`“正常”Kinect 的框架。

我尝试制作自己的方法来逐个复制属性，但是无法复制某些属性。看...

```
 public static Skeleton Clone(this Skeleton actualSkeleton)
    {
        if (actualSkeleton != null)
        {
            Skeleton newOne = new Skeleton();

 // doesn't work - The property or indexer 'Microsoft.Kinect.SkeletonJoints'
 // cannot be used in this context because the set accessor is inaccessible
            newOne.Joints = actualSkeleton.Joints;

 // doesn't work - The property or indexer 'Microsoft.Kinect.SkeletonJoints' 
 // cannot be used in this context because the set accessor is inaccessible
            JointCollection jc = new JointCollection();
            jc = actualSkeleton.Joints;
            newOne.Joints = jc;

            //...

        }

        return newOne;

    } 
```

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T18:04:46.997

通过更多搜索，我最终得到了以下解决方案：将骨架序列化到内存，反序列化到新对象

这是代码

```
 public static Skeleton Clone(this Skeleton skOrigin)
    {
        // isso serializa o skeleton para a memoria e recupera novamente, fazendo uma cópia do objeto
        MemoryStream ms = new MemoryStream();
        BinaryFormatter bf = new BinaryFormatter();

        bf.Serialize(ms, skOrigin);

        ms.Position = 0;
        object obj = bf.Deserialize(ms);
        ms.Close();

        return obj as Skeleton;
    } 
```

# html - 如何在http地址中传递图像

> ID：13556911
> 
> 赞同：0
> 
> 时间：2012-11-25T23:55:57.260
> 
> 标签：html, input

在`<input type="file">`我想传递一个指向图像而不是我计算机中图像的http地址。

有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:01:10.673

一般来说，你不能这样做。如果您希望用户能够通过上传或通过 URL 指定文件，则必须在表单（`<input type="text">`字段）中提供替代方案。

看起来好像 Windows 上的某些 Web 浏览器允许您将 URL 键入显示用于上传本地文件的文件选择器中。这是 Windows 文件选择器的内置功能，它的工作原理是将文件下载到用户的计算机上，然后将其上传到您的 Web 服务器。它不会导致发送 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T00:09:36.910

我找到了解决方案 =)

你只需要在弹出窗口中写下完整的 html 地址，然后vouila =)

无论如何感谢您的评论！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T23:58:46.000

简单的回答：不可能。改用 a `type="text"`。

# iphone - UIActivityViewController 背景颜色

> ID：13556915
> 
> 赞同：1
> 
> 时间：2012-11-25T23:56:53.260
> 
> 标签：iphone, ios, xcode, ipad, social-networking

![在此处输入图像描述](../Images/6b475c6250ad574262338dac6fd51f89.png)所以我的`UIActivityViewController`应用程序中有一个。如何更改背景颜色。而且我还有一个快速如何将 Facebook 和 twitter 添加到我的`UIActivityViewController`.

**编码：**

```
 - (IBAction)Social:(id)sender {
            UIActivityViewController *social = [[UIActivityViewController alloc]initWithActivityItems:[NSArray arrayWithObjects:@"Travel+ Rocks",nil] applicationActivities:nil];
            social.excludedActivityTypes = @[UIActivityTypeCopyToPasteboard,UIActivityTypeAssignToContact,UIActivityTypePostToWeibo,UIActivityTypePrint];   
            [self presentViewController:social animated:YES completion:nil];
            [social setCompletionHandler:^(NSString *activityType, BOOL completed)
             {
                 NSLog(@"Activity = %@",activityType);
                 NSLog(@"Completed Status = %d",completed);

                 if (completed)
                 {
                    // UIAlertView *objalert = [[UIAlertView alloc]initWithTitle:@"Alert" message:@"Your Posts were sucessful" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
                    // [objalert show];
                    // objalert = nil;
                 }else
                 {
                    // UIAlertView *objalert = [[UIAlertView alloc]initWithTitle:@"Alert" message:@"Your Posts weren't sucessful" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
                    // [objalert show];
                    // objalert = nil;

                 }
             }];
        } 
```

这些代码修复了背景错误：

```
NSString *message = [NSString stringWithFormat:@""];
    NSString *textToShare = message;
    UIImage *imageToShare = [UIImage imageNamed:@""];
    NSArray *activityItems = [[NSArray alloc]  initWithObjects:textToShare, imageToShare,nil];
    UIActivity *activity = [[UIActivity alloc] init];
    NSArray *applicationActivities = [[NSArray alloc] initWithObjects:activity, nil];
    UIActivityViewController *activityVC =
    [[UIActivityViewController alloc] initWithActivityItems:activityItems
    applicationActivities:applicationActivities];
    [self presentViewController:activityVC animated:YES completion:nil]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T04:36:05.820

查看以下链接的示例代码，您可能会有所了解...

[https://github.com/coryalder/DMActivityInstagram/downloads](https://github.com/coryalder/DMActivityInstagram/downloads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:10:59.907

如果您设置目标 -> 摘要 -> 状态栏样式，则共享视图的颜色将跟随。最好的 iv 发现了.....

![在此处输入图像描述](../Images/2f75ee293c60ab1c09025c4ac70d67d8.png)

希望能帮助到你

# objective-c - JSON 数据以错误的顺序添加到 NSArray

> ID：13556917
> 
> 赞同：1
> 
> 时间：2012-11-25T23:57:05.333
> 
> 标签：objective-c, json, nsarray

我正在向 NSArray 添加键值字符串，但它们的添加顺序错误，这让我相信这是错误的做事方式 -

我的 json 采用以下格式：

```
[{
    "story1":
        {data in here}
    "story2":
                {data in here}.... 
```

在我的代码中，我希望在 NSArray 中获取story1和story2（以及更多）的字符串值，我实现了但它们的顺序相反-story2，story1：

```
NSArray *jsonArr = [NSJSONSerialization JSONObjectWithData:theData options:kNilOptions error:&error];

for (NSString *pItem in [jsonArr objectAtIndex:0]) {
  NSLog(@"Product: %@", pItem);
} 
```

有没有更好的方法来做到这一点，如果没有，我该如何反转数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T12:49:32.353

```
// Instead Normal NSArray user NSOrderedSet which preserves the order of objects
NSOrderedSet *orderSet = [NSOrderedSet orderedSetWithArray:jsonArr];

// Access your value From NSOrderedSet same as NSArray
NSDictionary *dict = [orderSet objectAtIndex:0];
NSLog(@"%@",dict); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T13:05:45.333

您的 JSON 在 JSON 数组中定义了一个 JSON 对象。当您反序列化它时，您将获得一个包含 NSDictionary 的 NSArray，该 NSDictionary 又包含键值对，但 NSDictionary 没有定义键的顺序（JSON 对象也没有）。IE

```
{ "story1" : "foo", "story2" : "bar" } 
```

和

```
{ "story2" : "bar", "story1" : "foo" } 
```

是同一对象的表示。

如果您需要排序，则需要重组 JSON 数据。以下将做的伎俩

```
[
    { "story1" : { ... } },
    { "story2" : { ... } }
] 
```

或者，当您访问对象中的数据时，您可以先对键进行排序。使用您的示例：

```
NSArray *jsonArr = [NSJSONSerialization JSONObjectWithData:theData ...];
NSDictionary *jsonDictionary = [jsonArr objectAtIndex: 0];

NSArray* sortedKeys = [[jsonDictionary allKeys] sortedArrayUsingComparator: (^NSComparator)(id obj1, id obj2) { /* a comparator */ }];
for (NSString *key in [sortedKeys]) 
{
    NSLog(@"Product: %@", [jsonDictionary objectForKey: key]);
} 
```

# php - 仅当我单击它时才打开页面

> ID：13556920
> 
> 赞同：0
> 
> 时间：2012-11-25T23:57:21.813
> 
> 标签：php, javascript, jquery

我想防止我网站上的某些子页面（带有游戏）在每个浏览器的多个选项卡中打开。我希望每个浏览器只打开 1 个子页面。我使用 PHP 作为服务器端语言，游戏是 SWF 格式。

用户转到游戏列表，然后单击游戏图标，然后打开一个弹出窗口。href 属性已被禁用，并且每个游戏图标都添加了 onclick 事件。

但这并不妨碍用户复制游戏 URL，然后手动打开一个新选项卡并粘贴 URL。

有什么方法可以实现我的目标吗？我在想，当用户单击游戏图像时，使用 ajax 并在我的服务器上调用 PHP 来设置安全令牌。游戏嵌入完成后，销毁令牌。如果用户将 URL 复制粘贴到另一个选项卡中，它将不起作用。

但是如果用户刷新游戏页面会发生什么呢？对此有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:28:15.993

编辑：最初误解了。每个用户只允许一页

点击时

*   删除该用户的其他令牌
*   为该用户创建和存储令牌
*   交付页面（在 URL 中使用该令牌）
*   在页面加载时，它会检查令牌
*   在页面上生成时间戳（不是服务器，即在JS中）
*   该页面使用令牌和时间戳定期轮询服务器（或使用长轮询/推送）
*   民意调查：
    *   令牌存在并且（ timestamp >= stored_timestamp 或 stored_timestamp =NULL ）
        *   是：如果更大或stored_timestamp =NULL，则将时间戳设置为当前，不做任何其他事情
        *   否：杀死这个游戏
    *   令牌不存在
        *   杀了这个游戏

如果他们刷新它将设置一个新的时间戳，杀死他们的旧游戏。如果他们在新浏览器中打开，它将刷新时间戳，从而终止他们的旧游戏。

# c# - MySQL 连接器/ODBC 5.2.2 中服务器端准备好的语句的问题

> ID：13556924
> 
> 赞同：4
> 
> 时间：2012-11-25T23:57:41.290
> 
> 标签：c#, mysql, odbc

**背景**

我收到了一位客户的报告，他抱怨说，在他们的服务器上执行了一些更新后，他们的日志文件中出现了以下错误消息：

`ERROR [HY000] [MySQL][ODBC 5.2(w) Driver][mysqld-5.1.49]Can't create more than max_prepared_stmt_count statements (current value: 16382)`

**我的发现**

谷歌给了我以下[有趣的结果](http://iammysql.wordpress.com/2012/05/04/cant-create-more-than-max_prepared_stmt_count-statements/)。

在阅读了上面的博客文章后，我开始进行实验，果然 - 当更新到新的 ODBC 驱动程序（5.2.2，又名“MySQL ODBC 5.2w 驱动程序”）时，所有语句现在默认情况下都是服务器端准备的。[（另请参阅此处](http://lists.mysql.com/announce/803)的公告）。

这是使用 5.2.2 的全局日志中的两行：

```
[192.168.0.150]|134302|0|Prepare|INSERT INTO `a1gt6` (`TimeStamp`, `Temperature`) VALUES (?, ? )
[192.168.0.150]|134302|0|Execute|INSERT INTO `a1gt6` (`TimeStamp`, `Temperature`) VALUES ('2012-11-25 12:40:27', '7.03750000000000000e+001' ) 
```

**问题**

如果不是因为它们显然没有被服务器关闭（及时，请参阅下面的更新），我的语句被转换为准备好的语句，我不会有什么大问题，如上述错误所示消息和命令的结果`show global status like "com_stmt%";`

```
Com_stmt_close  0
Com_stmt_execute    1
Com_stmt_fetch  0
Com_stmt_prepare    1
Com_stmt_reprepare  0
Com_stmt_reset  0
Com_stmt_send_long_data 0 
```

上表显示了使用 Connector/ODBC 5.2.2 单次运行语句后的结果。下面是`show global status like "com_stmt%";`使用 Connector/ODBC/5.1.11的输出

```
Com_stmt_close  0
Com_stmt_execute    0
Com_stmt_fetch  0
Com_stmt_prepare    0
Com_stmt_reprepare  0
Com_stmt_reset  0
Com_stmt_send_long_data 0 
```

下面是我用来确定问题原因的 C# 测试方法。

```
[TestMethod]
public void TestOldfashion()
{
    int option = 16 + /*FLAG_MULTI_STATEMENTS*/ 67108864;
    string odbcString = @"DRIVER={{{0}}};SERVER={1};UID={2};PWD={3};OPTION=" + option + ";CharSet=utf8;";
    using( System.Data.Odbc.OdbcConnection con = new System.Data.Odbc.OdbcConnection( string.Format( odbcString, new object[] { "MySQL ODBC 5.1 Driver", "server", "user", "password" } ) ) ) {
        con.Open();
        con.ChangeDatabase( "fooDB" );
        using( System.Data.Odbc.OdbcCommand cmd = con.CreateCommand() ) {
            cmd.CommandText = "INSERT INTO myTable ( foo, value ) VALUES ( ?, ? );";
            cmd.Parameters.AddWithValue( "foo", 2 );
            cmd.Parameters.AddWithValue( "value", "asf" );
            int i = cmd.ExecuteNonQuery();
        }
    }
} 
```

这是表的 CREATE 语句：

```
delimiter $$

CREATE TABLE `mytable` (
  `index` int(11) NOT NULL AUTO_INCREMENT,
  `foo` float DEFAULT NULL,
  `value` text,
  PRIMARY KEY (`index`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8$$ 
```

**发布前更新**

就在提出这个之前，我`show global status like "com_stmt%";`再次执行了，现在它给出了以下结果，所以看起来服务器*确实*清理了语句，但为时已晚（考虑到上述错误消息）。`Com_stmt_reset`即使在 30 分钟后，最后一个仍然未关闭（in ）。

```
Com_stmt_close  6
Com_stmt_execute    7
Com_stmt_fetch  0
Com_stmt_prepare    7
Com_stmt_reprepare  0
Com_stmt_reset  1
Com_stmt_send_long_data 0 
```

该[公告](http://lists.mysql.com/announce/803)提到可以通过将`no_ssps=1`选项添加到连接字符串来禁用服务器端准备。这似乎有效（仅对其进行了简要测试），但感觉不像是一个可靠的解决方案。我宁愿尽可能地使用默认值，因为我希望 MySQL 开发人员知道最佳实践是什么。可能我做错了什么或没有正确理解事情。

**问题**

如果服务器现在将我的常规语句转换为准备好的语句（与旧的客户端仿真相反），为什么不及时清理它以避免上述错误？

我希望在 OdbcCommand 的使用范围结束时关闭/释放该语句，但这显然不正确？

如果有人能对此有所了解，我将不胜感激。不幸的是，现在是 00:55，所以我现在不能熬夜回答/澄清事情，但明天早上会再次检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:08:28.670

这是一个[已知的错误](http://bugs.mysql.com/bug.php?id=67340)，补丁已提交并获得批准。你可以：

*   等待固定版本；
*   自己应用补丁并重新编译；
*   降级到 5.1；或者
*   使用`no_ssps=1`.

# c - 指针指针指针

> ID：13556925
> 
> 赞同：4
> 
> 时间：2012-11-25T23:58:00.567
> 
> 标签：c, pointers

我正在涉足 c 指针，但无法解释以下代码：

```
int main()
{
    int i = -3; 
    int *ptr;
    int **ptr2;
    int ***ptr3;
    ptr = &i; 
    ptr2 = &ptr;
    ptr3 = &ptr2;
    printf("ptr = %p\n",(void *)ptr);
    printf("&ptr = %p\n",(void *)&ptr);
    printAddr(&ptr);
    printAddr2(&ptr2);
    printAddr3(&ptr3);
    return 0;
}

void printAddr(int **num)
{
    printf("address of int ** = %p\n", (void *)&num);
}

void printAddr2(int ***num)
{
    printf("address of int *** = %p\n", (void *)&num);
}
void printAddr3(int ****num)
{
    printf("address of int **** = %p\n", (void *)&num);
} 
```

输出如下：

```
ptr = 0xbf9d64a0 
&ptr = 0xbf9d64a4
address of int ** = 0xbf9d6490
address of int *** = 0xbf9d6490
address of int **** = 0xbf9d6490 
```

我的疑问是为什么要解决`(address(int)) == address(address(address(int)))`？

非常感谢您的澄清。

我发现这个问题是相关的：

[递归指针](https://stackoverflow.com/questions/8940252/recursive-pointers)

但是作者明确指定它们是平等的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T00:00:15.050

```
void printAddr(int **num)
{
   printf("address of int ** = %p\n",(void *)&num);
} 
```

这将打印出函数接收到的传入值的副本的地址。这些很可能都分配在堆栈上的同一个位置，因为所有这些函数都只接受一个参数，并且在调用之间不会发生分配。

如果要查看 in 中的指针地址`main`，应直接将它们打印在中`main`或使用函数

```
void printAddress(void* p) {
    printf("%p\n", p);
} 
```

并用

```
printAddress(&ptr3); 
```

等等

# symfony - 使 FosUserBundle 在更改密码对话框中不接受相同的密码

> ID：13556929
> 
> 赞同：0
> 
> 时间：2012-11-25T23:58:35.167
> 
> 标签：symfony, fosuserbundle

我正在使用 FOSUserBundle 来管理我的用户。每个用户必须至少每 30 天更改一次密码。这是有效的 - 对话框显示并且用户可以更改密码。

但不幸的是，用户可以输入与以前相同的密码，FosUserBundle 会接受它。如何让 FUB 在更改密码对话框中不接受相同的密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T08:08:30.510

您必须修改 FOSUser 用户实体（像往常一样扩展用户实体并添加一个带有先前密码字段的额外字段，或类似的内容）和超出此范围的逻辑（在控制器中或“核心”中）

# java - Java Spring - 尝试调用时出现 JDBCTemplate BadSqlGrammarException

> ID：13556932
> 
> 赞同：-1
> 
> 时间：2012-11-25T23:59:01.250
> 
> 标签：java, mysql, spring

例外

```
Exception in thread "main" org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [\. D:\Documents\workspace-sts-3.0.0.RELEASE\groupbased\src\test\resources\stress\storedProcedures.sql]; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\. D:\Documents\workspace-sts-3.0.0.RELEASE\groupbased\src\test\resources\stress' at line 1 
```

Java 代码

```
template.execute("USE example_db;");
template.execute("\\. D:\\Documents\\workspace-sts-3.0.0.RELEASE\\groupbased\\src\\test\\resources\\stress\\storedProcedures.sql"); 
```

（模板是一个 JDBCTemplate）

我可以通过 mysql 控制台很好地运行该命令，但是每当我尝试通过 JDBCTemplate 执行时都会收到此错误。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:01:35.137

是的。尝试将文件的内容读入字符串并将其传递给模板。

javadocs说参数应该是实际的SQL，而不是文件路径。

[http://static.springsource.org/spring/docs/3.0.6.RELEASE/api/org/springframework/jdbc/core/JdbcTemplate.html](http://static.springsource.org/spring/docs/3.0.6.RELEASE/api/org/springframework/jdbc/core/JdbcTemplate.html)

# sql - 如何在sql查询中根据ID将行值设置为一个字段

> ID：13556934
> 
> 赞同：0
> 
> 时间：2012-11-25T23:59:23.097
> 
> 标签：sql, sql-server-2008

我有一张名为“PERSON”的桌子

```
GROUP_ID  PERSON_NAME
1001       ALEX
1002       MATHEW
1001       GEORGE
1002       THOMAS
1001       JAMES 
```

我需要像下面这样的输出`"|"`

```
GROUP_ID   PERSON_NAME
1001       ALEX|GEORGE|JAMES
1002       THOMAS|MATHEW 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:01:18.077

```
SELECT  a.[GROUP_ID], 
        SUBSTRING(d.Names,1, LEN(d.Names) - 1) NamesList
FROM
        (
            SELECT DISTINCT [GROUP_ID]
            FROM Table1
        ) a
        CROSS APPLY
        (
            SELECT [PERSON_NAME] + '|' 
            FROM table1 AS B 
            WHERE A.[GROUP_ID] = B.[GROUP_ID] 
            FOR XML PATH('')
        ) D (Names) 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/c3e7a/2)

或者

```
SELECT [GROUP_ID],
       STUFF(
           (SELECT '|' + [PERSON_NAME]
            FROM Table1
            WHERE [GROUP_ID] = a.[GROUP_ID]
            FOR XML PATH (''))
            , 1, 1, '')  AS NamesList
FROM Table1 AS a
GROUP BY [GROUP_ID] 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/c3e7a/5)

# google-app-engine - GoogleAppEngine：Python 文件被缓存，HTML 没问题

> ID：13556935
> 
> 赞同：1
> 
> 时间：2012-11-26T00:00:13.777
> 
> 标签：google-app-engine

我已经阅读了 GAE 文档和其他 Stack Overflow 问题，但没有看到任何与我的问题相似的内容，这让我发疯了。

当我启动应用程序引擎并对我的 report.py 文件进行一些更改时，然后我转到我的浏览器并使用 URL 变量加载 /r，一切正常。

然后我回到我的 report.py 并进行更改，但没有任何显示。我尝试添加一个未显示在 GAE 的日志记录区域中的 logging.info()，然后甚至尝试对我传递给 HTML 的变量进行硬编码。没有更新。然后我直接将python文件移动到reportKEEP.py，请求仍然运行良好。即 GAE 正在缓存我的 .py 文件，除了停止应用程序然后再次运行之外，我无法取消缓存。当我通过启动器重置应用程序时，更改显示正常（或未找到 report.py 的错误）。

我还尝试更新 html 文件并且更新正常，所以我知道它正在工作，它只是 .py 文件被缓存。

请让我知道我还能提供什么来帮助您帮助我。

我在文档中读到的关于缓存的所有内容都是关于静态文件的，而 py 不是其中之一。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T02:54:25.657

好吧，我不知道是什么原因造成的，但至少我想出了一个解决方法。

我确实查看了来自 vlad 的链接，我知道这不是时间戳问题。我基本上从头开始重建了我的整个应用程序引擎环境，包括卸载和重新安装 GAE 启动器，从命令行运行，甚至最终得到了我妻子的 macbook pro 并进行了全新的安装。仍然没有运气，每次我编辑该死的 report.py 文件时，更改都不会反映在前端。甚至可以删除文件并且请求会生成正常，这意味着文件被缓存在 GAE 深处的某个地方。

最后我只是说把它搞砸，将 .py 复制到一个新文件（reports.py）中并编辑 main.py 以指向新文件。维奥拉！完美运行，使用新数据更新前端并立即打印输出。

如果我不得不猜测这可能是因为在我的 main.py 中，我有一个 /r 和 /report 的转发处理程序指向同一个 report.py 文件，但我太害怕弄乱它。

# .htaccess - FastCGI - 重写 - 使用 Nginx 定位

> ID：13556938
> 
> 赞同：0
> 
> 时间：2012-11-26T00:00:22.250
> 
> 标签：.htaccess, url-rewriting, nginx, rewrite

我刚切换到 nginx，但我的 URL 重写遇到了问题

我用了

```
location /id/ {
       rewrite ^/id/(.*) /index.php?id=$1 break;
} 
```

但是php代码没有被解释，最糟糕的是它是原始下载的。然而 .php 文件配置如下：

```
 location ~ \.php$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_param  SCRIPT_FILENAME  /var/www/my_app$fastcgi_script_name;
            include /etc/nginx/fastcgi_params;
    } 
```

我的虚拟主机有什么问题？

编辑：这是整个虚拟主机服务器 {

```
 listen   80; ## listen for ipv4
    server_name  viditx.com www.viditx.com; ## change this to your own domain name

   # I find it really useful for each domain & subdomain to have
   # its own error and access log
    error_log /var/log/nginx/viditx.com.error.log;
    access_log  /var/log/nginx/viditx.com.access.log;
root /var/www/viditx;   

location / {
        # Change this to the folder where you want to store your website
        index  index.html index.htm index.php;
}
location /phpmyadmin {
           root /usr/share/;
           index index.php index.html index.htm;
           location ~ ^/phpmyadmin/(.+\.php)$ {
                   try_files $uri =404;
                   root /usr/share/;
                   fastcgi_pass 127.0.0.1:9000;
                   fastcgi_index index.php;
                   fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                   include /etc/nginx/fastcgi_params;
           }
           location ~* ^/phpmyadmin/(.+\.(jpg|jpeg|gif|css|png|js|ico|html|xml|txt))$ {
                   root /usr/share/;
           }
    }
    location /phpMyAdmin {
           rewrite ^/* /phpmyadmin last;
    }

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;

    location = /50x.html {
            root   /var/www/nginx-default;
    }

    location ~ \.php$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            # again, change the directory here to your website's root directory
            # make sure to leave $fastcgi_script_name; on the end!
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            include /etc/nginx/fastcgi_params;
    } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T07:51:56.997

你应该试试 ：

```
location /id/ {
       rewrite '^/id/(.*)$' /index.php?id=$1 break;
} 
```

和 ：

```
location ~ \.php$ {
    fastcgi_pass 127.0.0.1:9000;
    fastcgi_index   index.php;
    fastcgi_param   SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    include     /etc/nginx/fastcgi_params;
} 
```

玩得开心 ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T19:48:38.850

[你读过文档吗？](http://nginx.org/r/rewrite)

**休息**->**最后**：

```
location /id/ {
    rewrite ^/id/(.*)$ /index.php?id=$1 last;
} 
```

# mysql - 尝试构造一个类似选择的 MySQL 查询失败

> ID：13556939
> 
> 赞同：1
> 
> 时间：2012-11-26T00:00:22.217
> 
> 标签：mysql, voting-system

# 背景资料

## 系统

操作系统：

```
bash$ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 6.0.5 (squeeze)
Release:        6.0.5
Codename:       squeeze 
```

MySQL：

```
bash$ mysql --version
mysql  Ver 14.14 Distrib 5.1.63, for debian-linux-gnu (x86_64) using readline 6.1 
```

## 数据库

引擎：`MyISAM`

表：post_votes

```
mysql> describe post_votes;
+-----------+---------------------+------+-----+---------+----------------+
| Field     | Type                | Null | Key | Default | Extra          |
+-----------+---------------------+------+-----+---------+----------------+
| id        | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| post_uuid | binary(16)          | YES  |     | NULL    |                |
| user_uuid | binary(16)          | YES  |     | NULL    |                |
| vote      | tinyint(4)          | YES  |     | 0       |                |
+-----------+---------------------+------+-----+---------+----------------+
4 rows in set (0.00 sec) 
```

表：帖子

```
mysql> describe posts;
+-------------+---------------------+------+-----+----------------------+----------------+
| Field       | Type                | Null | Key | Default              | Extra          |
+-------------+---------------------+------+-----+----------------------+----------------+
| id          | bigint(20) unsigned | NO   | PRI | NULL                 | auto_increment |
| post_uuid   | binary(16)          | YES  | UNI | NULL                 |                |
| owner_uuid  | binary(16)          | YES  |     | NULL                 |                |
| created     | int(10) unsigned    | YES  |     | NULL                 |                |
| edited      | int(10) unsigned    | YES  |     | NULL                 |                |
| title       | varchar(50)         | YES  |     | NULL                 |                |
| description | varchar(150)        | YES  |     | NULL                 |                |
| link        | varchar(100)        | YES  |     | NULL                 |                |
| properties  | varchar(20)         | YES  |     | 00000000000000000000 |                |
+-------------+---------------------+------+-----+----------------------+----------------+
9 rows in set (0.00 sec) 
```

# 问题

我想根据他们的赞成/反对比率来选择帖子。我想出了一个计算赞成票和反对票但似乎无法将其加入实际帖子的查询。

## 工作（不完整）查询

```
(
    SELECT COUNT(*), post_uuid, 'upvotes' AS 'mode'
    FROM post_votes a
    WHERE a.vote = 1
    GROUP BY post_uuid
)
UNION
(
    SELECT COUNT(*), post_uuid, 'downvotes' AS 'mode'
    FROM post_votes a
    WHERE a.vote = -1
    GROUP BY post_uuid
) 
```

## 损坏的查询

```
(
    (
        SELECT COUNT(*), post_uuid, 'upvotes' AS 'mode'
        FROM post_votes a
        WHERE a.vote = 1
        GROUP BY post_uuid
    )
    UNION
    (
        SELECT COUNT(*), post_uuid, 'downvotes' AS 'mode'
        FROM post_votes a
        WHERE a.vote = -1
        GROUP BY post_uuid
    )
)
a
LEFT JOIN posts b ON a.post_uuid = b.post_uuid 
```

我究竟做错了什么？我得到的错误信息是：

```
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use near 'UNION
(
SELECT COUNT(*), post_uuid, 'downvotes' AS 'mode' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:03:56.833

该`UNION`对实际上是一个派生表，并且必须出现在`FROM`子句中才能参与`JOIN`. 由于它现在在`FROM`子句中，因此您必须使用`SELECT`它的列，否则您的查询根本没有`SELECT`子句。MySQL 的语法是宽松的，但不会宽松到允许缺少`SELECT`子句。

```
/* SELECT the cols produced by the UNION */
SELECT 
   a.`num`, 
   a.`post_uuid`,
   a.`mode`,
  /* And other columns from `posts` if needed */
   b.`something`,
   b.`something_else`,
   b.`some_other_thing`
/* UNIONs are a derived table, belonging in FROM */
FROM (
    (
        SELECT COUNT(*) as num, post_uuid, 'upvotes' AS 'mode'
        FROM post_votes a
        WHERE a.vote = 1
        GROUP BY post_uuid
    )
    UNION
    (
        SELECT COUNT(*) num, post_uuid, 'downvotes' AS 'mode'
        FROM post_votes a
        WHERE a.vote = 1
        GROUP BY post_uuid
    )
) a
LEFT JOIN posts b ON a.post_uuid = b.post_uuid 
```

回顾一下，我相信您可以`UNION`通过使用`SUM(CASE)`聚合模式来简化：

```
SELECT 
  b.post_uuid,
  SUM(CASE WHEN a.vote = 1 THEN 1 ELSE 0 END) AS upvotes,
  /* Assume -1 for downvotes? */
  SUM(CASE WHEN a.vote = -1 THEN 1 ELSE 0 END) AS downvotes
FROM
  posts b
  LEFT JOIN post_votes a ON a.post_uuid = b.post_uuid
GROUP BY b.post_uuid 
```

# jquery - 使用 jQuery 获取所选选项的索引

> ID：13556941
> 
> 赞同：195
> 
> 时间：2012-11-26T00:00:48.287
> 
> 标签：jquery, html, select, indexing

`<select>`我对如何从 HTML项目中获取所选选项的索引有点困惑。

在[此](http://www.theextremewebdesigns.com/blog/jquery-get-selected-index-jquery-get-selected-option-index-2-ways/)页面上，描述了两种方法。但是，两者总是返回`-1`。这是我的 jQuery 代码：

```
$(document).ready(function(){
    $("#dropDownMenuKategorie").change(function(){
        alert($("#dropDownMenuKategorie option:selected").index());
        alert($("select[name='dropDownMenuKategorie'] option:selected").index());
    });
}); 
```

并在 html

```
(...)
<select id="dropDownMenuKategorie">
    <option value="gastronomie">Gastronomie</option>
    <option value="finanzen">Finanzen</option>
    <option value="lebensmittel">Lebensmittel</option>
    <option value="gewerbe">Gewerbe</option>
    <option value="shopping">Shopping</option>
    <option value="bildung">Bildung</option>
</select>
(...) 
```

为什么会有这种行为？在分配其方法时是否有可能`select`没有“准备好” `change()`？此外，更改`.index()`为`.val()`返回正确的值，这让我更加困惑。

* * *

## 回答 #1

> 赞同：382
> 
> 时间：2012-11-26T00:05:24.903

第一种方法似乎在我测试的浏览器中工作，但选项标签并不真正对应于所有浏览器中的实际元素，因此结果可能会有所不同。

只需使用`selectedIndex`DOM 元素的属性：

```
alert($("#dropDownMenuKategorie")[0].selectedIndex); 
```

### 更新：

自 1.6 版以来，jQuery 具有`prop`可用于读取属性的方法：

```
alert($("#dropDownMenuKategorie").prop('selectedIndex')); 
```

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2014-06-24T17:48:55.233

用 Jquery 方式解决这个问题的好方法

```
$("#dropDownMenuKategorie option:selected").index() 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-07-03T04:44:29.953

您可以使用该[`.prop(propertyName)`](http://api.jquery.com/prop/)函数从 jQuery 对象的第一个元素中获取属性。

```
var savedIndex = $(selectElement).prop('selectedIndex'); 
```

这使您的代码保持在 jQuery 领域内，并且还避免了使用选择器来查找所选选项的其他选项。然后，您可以使用重载恢复它：

```
$(selectElement).prop('selectedIndex', savedIndex); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-08-20T04:59:07.183

根据 user167517 的回答，我有一个稍微不同的解决方案。在我的函数中，我使用一个变量作为我要定位的选择框的 id。

```
var vOptionSelect = "#productcodeSelect1"; 
```

索引返回：

```
$(vOptionSelect).find(":selected").index(); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-11-26T06:59:54.803

尝试这个

```
 alert(document.getElementById("dropDownMenuKategorie").selectedIndex); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-01-23T10:49:37.400

[selectedIndex](http://www.w3schools.com/jsref/prop_select_selectedindex.asp)是一个 JavaScript 选择属性。对于 jQuery，您可以使用以下代码：

```
jQuery(document).ready(function($) {
  $("#dropDownMenuKategorie").change(function() {
    // I personally prefer using console.log(), but if you want you can still go with the alert().
    console.log($(this).children('option:selected').index());
  });
}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-02-15T06:52:52.470

您可以使用 JQuery 的 .prop() 方法获取选择框的索引

检查这个：

```
<!doctype html>
<html>
<head>
<script type="text/javascript" src = "http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){

});

function check(){
    alert($("#NumberSelector").prop('selectedIndex'));
    alert(document.getElementById("NumberSelector").value);
}
</script>
</head>

<body bgcolor="yellow">
<div>
<select id="NumberSelector" onchange="check()">
    <option value="Its Zero">Zero</option>
    <option value="Its One">One</option>
    <option value="Its Two">Two</option>
    <option value="Its Three">Three</option>
    <option value="Its Four">Four</option>
    <option value="Its Five">Five</option>
    <option value="Its Six">Six</option>
    <option value="Its Seven">Seven</option>
</select>
</div>
</body>
</html> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-08T12:22:23.843

```
<select id="dropDownMenuKategorie">
    <option value="gastronomie">Gastronomie</option>
    <option value="finanzen">Finanzen</option>
    <option value="lebensmittel">Lebensmittel</option>
    <option value="gewerbe">Gewerbe</option>
   <option value="shopping">Shopping</option>
   <option value="bildung">Bildung</option>
</select>

$(document).ready(function(){
    $("#dropDownMenuKategorie").change(function(){
       var selIndex = $(this).prop('selectedIndex');
       var selVal = $("#dropDownMenuKategorie option:selected").val();
       var selText = $("#dropDownMenuKategorie option:selected").text();
       console.log(selIndex + selVal + selText );
    });
}); 
```

# gcc - std::map 在 gcc4.4.6 x86_64 中生成分段错误

> ID：13556942
> 
> 赞同：0
> 
> 时间：2012-11-26T00:00:49.037
> 
> 标签：gcc, segmentation-fault, stdmap

错误是

```
Program terminated with signal 11, Segmentation fault.
#0  _M_lower_bound (this=0x7fff4982ad00, __k=<value optimized out>) at /usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_tree.h:986
986             if (!_M_impl._M_key_compare(_S_key(__x), __k))
Missing separate debuginfos, use: debuginfo-install glibc-2.12-1.80.el6_3.6.x86_64 libgcc-4.4.6-4.el6.x86_64 libstdc++-4.4.6-4.el6.x86_64
(gdb) bt
#0  _M_lower_bound (this=0x7fff4982ad00, __k=<value optimized out>) at /usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_tree.h:986
#1  lower_bound (this=0x7fff4982ad00, __k=<value optimized out>) at /usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_tree.h:745
#2  lower_bound (this=0x7fff4982ad00, __k=<value optimized out>) at /usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_map.h:701
#3  std::map<int, int, std::less<int>, std::allocator<std::pair<int const, int> > >::operator[] (this=0x7fff4982ad00, __k=<value optimized out>)
    at /usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_map.h:447
#4  0x0000000000405148 in do_trace_loop () at main.cc:375
#5  0x0000000000407011 in main (argc=<value optimized out>, argv=<value optimized out>) at main.cc:727
(gdb) 
```

但是源码很正常

```
 pid_t retpid;
  map<int, int,less<int> > incall;
  map<int, int,less<int> > last;
  int status = 0;

  struct pstate_t ps;

  int nsyscalls = 0, nfiltered = 0, child_cored = 0, child_exit = 0;
  gettimeofday(&initTime,0);
  for(;;) {
#ifdef TIMED
    timeval init;
    gettimeofday(&init,0);    
#endif
    retpid = wait4(-1, &status, __WALL, &ru);
#ifdef TIMED
    getelapsed(init, 1000000, "wait");
#endif

    if(retpid == -1) {
      FATAL("wait");

    } else if(retpid == 0) {
      FATAL("wait was not passed WNOHANG but returned 0");

    } else {
#ifndef DEBUG
    {
    stringstream s;
    s << "PID: " << retpid <<"-----------" ;      
    logger->log(s.str());
    }
#endif
      if(WIFEXITED(status)) {
          if(retpid == child) {
                stringstream s;
                s << "child exited with status " << WEXITSTATUS(status);
                logger->log(s.str());
                break;
          } else {
                stringstream s;
                s << "child thread " << retpid  << " exited with status " << WEXITSTATUS(status);
                debug(s.str());
                continue;
          }
      }

      //this was below
      if(WIFSIGNALED(status)) {
        for(int i = 0; i < initModulePlugins.size(); i++) {
              Initializer* c = initModulePlugins[i];
              c->signaled(WTERMSIG(status), signame(WTERMSIG(status)));
        }

        if(child == retpid) {

            break;
        }
        continue;
      }

      if(WIFSTOPPED(status)) {
        int sig = WSTOPSIG(status);

        /* stopped due to entering or leaving a system call? */
        if(sig == SIGTRAP) {

          /* note that my structure has extra fields and this doesn't fill them */
          if(ptrace(PTRACE_GETREGS, retpid, 0, &ps)) {
            //FATAL("ptrace(PTRACE_GETREGS, ...)");

            stringstream s;
            s << "PTRACE_GETREGS  " << retpid << " failed";
            logger->log(s.str());

            continue;
          }

          if(incall[(int)retpid] && ps.scno != last[(int)retpid]) {
            /* this can potentially happen if we get confused by a signal or if we see nested system calls...
               it also happens after a successful exec */
            stringstream s;
            s << "not in syscall " << scname(last[retpid]) << " as expected";
            logger->log(s.str());
            incall[retpid] = 0;
          }

          /* becomes true if entering, false if leaving */
          incall[retpid] = !incall[retpid];

          if(incall[retpid]) {
            nsyscalls++;
          } 
```

# php - 是否可以在用户端的谷歌地图 api 中添加覆盖，例如使用 rmb 点击？

> ID：13556949
> 
> 赞同：1
> 
> 时间：2012-11-26T00:01:25.817
> 
> 标签：php, javascript, api, overlay

我正在开发我的一个项目，这将要求用户在谷歌地图 api 地图上添加标记，稍后将其传递给数据库，该数据库将存储所有覆盖坐标，并且一旦加载地图（以防万一用户当然具有所需的权限），for 循环会将数据库中的所有标记添加到页面中，并将它们可视化（具有静态半径的圆，但有各种坐标）。长话短说，我需要一种方法让用户自己将这些标记放在那里，以及一种读取 LatLng 坐标并将它们传递给脚本的方法，该脚本会将它们刷新到数据库中。一种方法（当然，如果可能的话）是使用上下文菜单并添加一个选项，如“在此处设置标记”，这会将坐标传递给将它们刷新到数据库的函数。当然解决方法是人民币->这里有什么，

那么有没有办法以某种方式自动化我可以使用的 api 中覆盖元素的添加过程？我用谷歌搜索了几天，也试图在 v3 帮助中找到一些东西，但到目前为止还没有找到任何真正有用的东西..

提前致谢！所有评论和帮助将不胜感激！

干杯，vlex

# ruby - 从 html 字符串中截断字符串

> ID：13556954
> 
> 赞同：-1
> 
> 时间：2012-11-26T00:02:05.560
> 
> 标签：ruby, rubygems

我需要截断从 URI:PARSE 接收到的一些数据......它充满了 html 代码和数据，最后的结果就是我需要的。

这是字符串（缩写）' **junk** "Result">Q8:0; **垃圾**

截断字符串中多余内容的最佳方法是什么，以便我可以将所需的数据拆分为变量。

在此先感谢 Philip pabbott@cpak.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:59:18.077

我建议使用`Nokogiri`从`Result`跨度中提取您的价值：

```
require 'nokogiri'

response = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">;
<html xmlns="w3.org/1999/xhtml"><head><title>;
</title></head><body>
<form name="form1" method="post" action="tenHSServer.aspx?t=34&amp;f=DeviceValue&amp;d=R10" id="form1">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTkzNDcxNzcwM2RkM4AHUDZdWZytDdspzLq7+FOXRfQ=" />
</div>
<span id="Result">R10:100;</span>
</form></body>
</html>'

result = nil
if doc = Nokogiri::HTML(response) rescue nil
  if span = doc.css('#Result')
    result = span.text
  end
end

puts result
#=> R10:100; 
```

但是，如果您不能/不想安装`Nokogiri`，请改用此正则表达式：

```
result = response.scan(/id=["|']Result["|']>([^<]*)<\//m).flatten.first
puts result
#=> R10:100; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T01:00:19.917

删除第一次调用 sub() 之前的`<span id=\"Result\">`所有内容，包括`</span>`第二次调用 sub() 之后的所有内容

假设您将 html 存储在变量 mystring 中

```
result = mystring.sub(/.*<span id=\"Result\">/,'').sub(/<\/span>.*/,'') 
```

如果您不能总是依赖跨度元素，您可以使用以下内容：

```
result = mystring.sub(/.*id=\"Result\">/,'').sub(/<\/.*/,'') 
```

# java - 想要在代码中打开一个 eclipse xml 文件并参考它的 IFile 导航到一个特定的行号

> ID：13556957
> 
> 赞同：1
> 
> 时间：2012-11-26T00:02:32.640
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-pde

我通过其 IFile 实例引用了 Eclipse IDE 中的 xml 文件。我知道想在我的视图上添加一个操作，在 xml 编辑器中打开文件并导航到特定的行号。有人对如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T11:54:19.587

假设您知道文件的 URL：

```
IWorkbenchPage page = activeWorkbenchPage();
if (page == null) {
    throw new RuntimeException();
}

IFile file;
IFile[] files = ResourcesPlugin.getWorkspace().getRoot()
            .findFilesForLocationURI(url.toURI());
file = files[0];

IMarker marker;
marker = file.createMarker(IMarker.TEXT);
HashMap<String, Object> map = new HashMap<String, Object>();
map.put(IMarker.LINE_NUMBER, lineNumber);
marker.setAttributes(map);
IDE.openEditor(page, marker);
marker.delete(); 
```

当然，您还需要捕获/抛出一些异常，但为了简单起见，我在这里省略了这一点。

# pointers - 输入字符串上的小指针

> ID：13556959
> 
> 赞同：2
> 
> 时间：2012-11-26T00:02:56.023
> 
> 标签：pointers, arduino

目前是一名大学学生，决定跳到我的编程课之前，用指针来找点乐子。这应该采用特定的串行输入并更改我连接到 Teensy++2.0 的三个 LED 的状态。然而，它似乎只是给了我第一个输入。
[http://arduino.cc/en/Serial/ReadBytesUntil](http://arduino.cc/en/Serial/ReadBytesUntil)
这是我对 ReadBytesUntil() 的参考 输入是 #,#,### （1,1,255 是一个例子）
我想基本上我的问题是，ReadBytesUntil( ) 处理逗号？如果是这样，这里发生了什么？

编辑——我问过我的老师，甚至他也不知道为什么它不起作用。

```
char *dataFinder(char *str){
  while (*str != ','){
    str++;
  }
  str++;
  return str;
}

void inputDecoder(){
  str = incomingText;
  whichLED = *str;
  dataFinder(str);
  onoff = *str;
  dataFinder(str);
  powerLevel = *str;
}

void loop(){
  int length;
  if (Serial.available() > 0 ){      //this is basically: if something is typed in, do       something.
length = Serial.readBytesUntil(13,incomingText, 10);  //reads what is typed in, and stores it in incomingVar
incomingText[length]=0;  ///swapping out cr with null 
inputDecoder();
//ledControl();
Serial.print("Entered:");
//incomingText[9]=0;
Serial.println(incomingText);  //Here for testing, to show what values I'm getting back.
Serial.println(whichLED);
Serial.println(onoff);
Serial.println(powerLevel);
}
  delay(1000);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T15:08:28.527

`str`in`inputDecoder()`来自全局范围，与具有本地范围的`str`in不同。`dataFinder()`

想象一下这张 ASCII 图片是内存的布局：

```
 str
+-----+-----+-----+-----+     +-----+-----+-----+-----+-----+-----+-----+-----+
|  *  |     |     |     | ... |  1  |  ,  |  1  |  ,  |  2  |  5  |  5  | \n  |
+--|--+-----+-----+-----+     +-----+-----+-----+-----+-----+-----+-----+-----+
   | 
   |
   \-----------------------------^ 
```

当你传递`str`给`dataFinder()`它时，它会创建一个指针的副本，我称之为`str'`

```
 str         str'
+-----+-----+-----+-----+     +-----+-----+-----+-----+-----+-----+-----+-----+
|  *  |     |  *  |     | ... |  1  |  ,  |  1  |  ,  |  2  |  5  |  5  | \n  |
+--|--+-----+--|--+-----+     +-----+-----+-----+-----+-----+-----+-----+-----+
   |           \-----------------^
   |
   \-----------------------------^ 
```

当`dataFinder()`增量`str`时，它确实在改变`str'`

```
 str         str'
+-----+-----+-----+-----+     +-----+-----+-----+-----+-----+-----+-----+-----+
|  *  |     |  *  |     | ... |  1  |  ,  |  1  |  ,  |  2  |  5  |  5  | \n  |
+--|--+-----+--|--+-----+     +-----+-----+-----+-----+-----+-----+-----+-----+
   |           \-----------------------------^
   |
   \-----------------------------^ 
```

然后，当您返回时，`inputDecoder()`取消引用`str`仍指向字符串的开头。

您可以使用以下方法将值分配`str'`回全局`str`：

```
str = dataFinder(str); 
```

或更改`dataFinder()`，使其不带参数，因此不复制变量。

# c# - DateTimePicker 日历按钮宽度

> ID：13556960
> 
> 赞同：2
> 
> 时间：2012-11-26T00:02:58.037
> 
> 标签：c#, winforms, datetimepicker

我试图创建一个可为空的 DateTimePicker，当控件被标记为具有空日期时，它可以选择性地显示一些提示文本。为了实现这一点，我从 DateTimePicker 继承并添加了一个带有提示文本的 Label 控件，该控件在控件时覆盖了文本部分被标记为具有空日期.. 问题是如果 DateTimePicker 设置为显示通常的日历图标，则此按钮的宽度是 VARIABLE..

下面的图像显示了具有不同大小的相同 DateTimePicker 控件。一旦日历图标按钮开始与文本重叠，它就会更改为更小、更简单的下拉图标按钮。

![在此处输入图像描述](../Images/d4db44c762eb2e545d67ae4ca0347e09.png) ![在此处输入图像描述](../Images/2ea9d7675c1fc7dc4bcf741dadb405b4.png) ![在此处输入图像描述](../Images/a1d59340632b4dd15985c36331cbc6ad.png) ![在此处输入图像描述](../Images/ebdcd391dc23bb925d186344f180dc6a.png)

我可以尝试使用反射来读/写私有字段，但我不知道要读什么..

我的问题..我如何正确找出 DateTimePicker 控件中显示的日历图标的宽度..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T05:30:32.130

我自己找到了一种方法.. =)..`DateTimePicker`当控件比显示的文本宽时显示日历图标按钮.. 当按钮开始剪辑文本时，控件会自动回退到显示较小的下拉按钮（可见在原始问题中图像的第二行）..所以我们找出文本的宽度、日历图标按钮、下拉按钮和控件本身..接下来的数学很简单..

```
const int C_BUTTONICON_WIDTH = 34;
const int C_BUTTONARROW_WIDTH = 17;

protected int GetLabelWidth()
{
    int iControlW = this.Width;
    int iTextW = TextRenderer.MeasureString(this.Text, this.Font).Width;

    int iLabelW = 0;
    if (iTextW <= iControlW - C_BUTTONICON_WIDTH)
    {
        iLabelW = iControlW - C_BUTTONICON_WIDTH;
    }
    else
    {
        iLabelW = iControlW - C_BUTTONARROW_WIDTH;
    }
    return iLabelW;
} 
```

您可能需要根据`Label`自身的位置调整几个像素.. =).. 达到我的目的.. =)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T00:20:49.430

无需重新发明轮子。看一下这个：

[CodeProject 上的可为空的 DateTimePicker](http://www.codeproject.com/Articles/5428/Nullable-DateTimePicker)

和这个：

[另一个可为空的 DateTimePicker 控件](http://www.codeproject.com/Articles/10155/Yet-another-nullable-DateTimePicker-control)

![在此处输入图像描述](../Images/36819801c49faf08345075ac2964636c.png)

# php - PHP GetResponse API 和 CF7 连接

> ID：13556963
> 
> 赞同：0
> 
> 时间：2012-11-26T00:03:55.510
> 
> 标签：php, json, wordpress, contact-form-7, getresponse

我试图从[`Contact Form 7`](http://wordpress.org/extend/plugins/contact-form-7/)WordPress 插件中获取数据并将其与 json 一起传递给[`GetResponse API`](https://github.com/GetResponse/DevZone/tree/master/API)

我有一个提取数据并发送它的 php 文件，它看起来像这样我收到了 CF7 确认电子邮件，但我没有收到时事通讯的 GetResponse 电子邮件确认，我不明白为什么，我试图做一些调试并且没有错误

```
add_action('wpcf7_before_send_mail', 'mytheme_save_to_getresponse', 10, 1);
function mytheme_save_to_getresponse($form)
{
include 'ChromePhp.php';

    require_once 'jsonRPCClient.php';
    $api_key = 'some_api_key';
    $api_url = 'http://api2.getresponse.com';
    $client = new jsonRPCClient($api_url);
    $result = NULL;

try {
    $result = $client->get_campaigns(
        $api_key,
        array (
            # find by name literally
            'name' => array ( 'EQUALS' => 'testcase_001' )
        )
    );
}
catch (Exception $e) {
    # check for communication and response errors
    # implement handling if needed
    die($e->getMessage());
}

$campaigns = array_keys($result);
$CAMPAIGN_ID = array_pop($campaigns);

   $subscriberName =  $_POST['name'];
    $subscriberEmail =  $_POST['email'];
    $subscriberPhone =  $_POST['c_phone'];
    $subscriberCellphone =  $_POST['c_cellphone'];
    $subscriberArea =  $_POST['c_area'];
    $subscriberInsuranceType =  $_POST['c_type'];
    $subscriberCarType =  $_POST['c_cartype'];
    $subscriberManifacture =  $_POST['c_manifacture'];
    $subscriberManifacturemodel =  $_POST['c_manifacturemodel'];
    $subscriberManifactureYear =  $_POST['c_manifactureyear'];
    $subscriberDriverAge =  $_POST['c_driversage'];
    $subscriberPrevent =  $_POST['c_prevent'];
    $subscriberClaim =  $_POST['c_claim'];

try {
    $result = $client->add_contact(
        $api_key,
        array (
            'campaign'  => $CAMPAIGN_ID,
            'name'      => $subscriberName,
            'email'     =>  $subscriberEmail,
            'cycle_day' => '0',
            'customs' => array(
                array(
                    'name'       => 'home_phone',
                    'content'    => $subscriberPhone
                ),
                array(
                    'name'       => 'cell_phone',
                    'content'    => $subscriberCellphone
                ),
                array(
                    'name'       => 'living_area',
                    'content'    => $subscriberArea
                ),
                array(
                    'name'       => 'drivers_age',
                    'content'    => $subscriberDriverAge
                ),
                array(
                    'name'       => 'insurance_type',
                    'content'    => $subscriberInsuranceType
                ),
                array(
                    'name'       => 'car_type',
                    'content'    => $subscriberCarType
                ),
                array(
                    'name'       => 'manifacture_type',
                    'content'    => $subscriberManifacture
                ),
                array(
                    'name'       => 'manifacture_model',
                    'content'    => $subscriberManifacturemodel
                ),
                array(
                    'name'       => 'manifacture_year',
                    'content'    => $subscriberManifactureYear
                ),
                array(
                    'name'       => 'license_loss',
                    'content'    => $subscriberPrevent
                ),
                array(
                    'name'       => 'claims_number',
                    'content'    => $subscriberClaim
                )
            )
        )
    );
}
catch (Exception $e) {
    # check for communication and response errors
    # implement handling if needed
    die($e->getMessage());
}
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T18:36:54.563

这段代码一切正常，我 GetResponse 不会在同一封电子邮件上多次发送确认请求..

# php - 缩放时间线的最佳 javascript 图表..

> ID：13556966
> 
> 赞同：3
> 
> 时间：2012-11-26T00:04:06.553
> 
> 标签：php, javascript, graph

我对 php 图形框架 aswel 或任何可以输出具有漂亮透明画布背景的 .png 的东西都持开放态度。

无论如何，我拥有的数据就像

```
-Time in format:: 25/11/12 - 11:20:01 PM +0000  
-Total Players online:: 29  
-And a list of player names:: Player1, Player2, Player3 
```

对于我可以转换为纪元的时间格式，如果它能让事情变得很容易绘制图表？

我已经看到了一些图表，您可以在其中放大和缩小时间线。因为我每 5 分钟获取一次结果，在 24 小时内大约有 288 个结果。所以只是寻找一些相当容易设置的东西。

我想知道的额外幻想是，如果在 mouseOver 特定结果上，它可以在那个时候显示玩家姓名？

因此，任何熟悉所有不同 javascript 图形脚本的人都知道一个可以轻松做到这一点的人，而我这边不需要太多额外的脚本，因为我根本不熟悉 javascript。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:14:24.287

**Javascript：**

试试[Highcharts](http://www.highcharts.com) - 我最近使用的一个很好的库，因为它有很多功能并且非常灵活/可配置。

你也可以试试[Rgraph](http://www.rgraph.net)，它是一个用 Javascript 编写的 HTML5 图表库，它使用 HTML5`canvas`标签来呈现/绘制。

**PHP：**

[JpGraph](http://www.jpgraph.net)是一个可靠的 PHP 驱动的图表库，已经存在多年并且不断改进。

# xslt - 这是做什么的？ 和

> ID：13556967
> 
> 赞同：5
> 
> 时间：2012-11-26T00:04:22.577
> 
> 标签：xslt, xslt-2.0

我对 XSL 很陌生，我对以下代码中的选择将选择什么感到困惑。

```
<xsl:apply-templates select="."/>

<xsl:apply-templates select="*|@*"/> 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-26T00:38:02.437

查看[XPath 2.0 的 Abbreviated Syntax 部分](http://www.w3.org/TR/xpath20/#abbrev)。

在`<xsl:apply-templates select="."/>`示例中，`.`评估为[上下文 item](http://www.w3.org/TR/xpath20/#id-context-item-expression)。在大多数情况下，这与当前正在处理的节点相同。所以这个例子将选择上下文节点。

在`<xsl:apply-templates select="*|@*"/>`示例中，`*`将选择上下文节点的所有子元素。`@*`将选择上下文节点的所有属性。`|`是[联合运算符](http://www.w3.org/TR/xpath20/#combining_seq)。所以这个例子将选择上下文节点的所有子元素以及上下文节点的所有属性。

`<xsl:apply-templates select="."/>`经常用于对上下文节点进行进一步处理。

`<xsl:apply-templates select="*|@*"/>`常用于处理当前节点的所有子元素及其属性。当您处理完一个元素并希望将其子元素/属性交给任何其他适用的模板时，通常会使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T05:30:53.320

```
<xsl:apply-templates select="."/> 
```

处理当前节点的内容！点`.`表示内容。如果当前节点没有子节点但有数据（例如：），`<foo>Sample Data</foo>`则解析器处理数据`Sample Data`

```
<xsl:apply-templates select="@*|*"/> 
```

处理属性和子节点或当前节点下的数据..不同的是..这个处理上下文节点的所有属性..

我使用这个词`process`而不是`copy`，因为 ..与其他模板`apply-template`不同`copy-of`并`value-of`评估其他模板，例如，如果我还有一个如下模板，则与上面的代码一起使用：

```
 <xsl:template match="text()[.='Sample Data']"/> 
```

然后它将从您的输出 XML 中删除文本。`copy-of select="node_name"`尽管在我们的 XSL 文件中是这个模板，但在哪里`value-of select="node-name"`复制数据..

# android - onReceive 中的对话框抛出异常：无法添加窗口——令牌 null 不是

> ID：13556970
> 
> 赞同：1
> 
> 时间：2012-11-26T00:04:34.777
> 
> 标签：android, broadcastreceiver, android-dialog

我有在启动完成后激活的广播接收器。原因是我想在设备重启后重新安排所有警报。但是，我想显示一个对话框，询问用户是否要继续。这是代码

```
public class StartupAlarmReceiver extends BroadcastReceiver{

    Context con;
    @Override
    public void onReceive(Context context, Intent intent) {

        if(intent.getAction().equals("android.intent.action.BOOT_COMPLETED"))
        {
            con = context;
            AlertDialog.Builder actionBuilder = new AlertDialog.Builder(context);
            actionBuilder.setTitle("test");
            actionBuilder.setMessage("Do you want to restart alarms?"); 
            actionBuilder.setCancelable(false);
            actionBuilder.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                   new MyAsyncTask().execute();
                }
            })
            .setNegativeButton("No" , new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                   dialog.cancel();
                }
            });
            AlertDialog alert = actionBuilder.create();

            alert.show();

        }
}       

} 
```

但是我得到了例外：

```
11-25 18:51:31.906: E/AndroidRuntime(1949): Caused by: android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
11-25 18:51:31.906: E/AndroidRuntime(1949):     at android.view.ViewRootImpl.setView(ViewRootImpl.java:693)
11-25 18:51:31.906: E/AndroidRuntime(1949):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:313)
11-25 18:51:31.906: E/AndroidRuntime(1949):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:215) 
```

我想我知道原因，但我不知道如何解决。我认为（从 SO 中阅读）原因是对话框需要一个活动，因此可以显示它，并且由于我不在我的应用程序中，所以我没有活动。那么有没有办法在重启后显示对话框？我可以显示 Toast，但对话框失败

除非我的理论是错误的并且我错过了一个重点。请帮忙，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:09:45.587

您必须启动一个活动（具有透明背景），然后将您的对话框放在 onCreate 函数上。比关闭对话框时关闭您的活动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-07T14:43:05.273

无需启动具有透明背景的新活动。我知道没有开始活动就干净的解决方案。添加这行额外的代码

```
alertDialog.getWindow().setType(WindowManager.LayoutParams.TYPE_SYSTEM_ALERT); 
```

并在您的清单文件中添加以下权限。

```
<uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" /> 
```

就是这样，现在 AlertDialog 将在 BroadcastReceiver 中正常工作而不会出现任何错误。如果您不明白，请访问[此链接以获取完整教程...](http://myonlinestay.com/how-to-create-android-alertdialog-in-broadcastreceiver-or-service/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T00:10:35.047

您的理论很好，您只能通过 Activity 创建 AlertDialog。我认为你应该从你的广播接收器（startActivity）调用一个活动，然后这个活动会显示这个对话框。

# sockets - 如何在非阻塞套接字上设置发送超时？

> ID：13556972
> 
> 赞同：8
> 
> 时间：2012-11-26T00:04:56.463
> 
> 标签：sockets, network-programming, setsockopt

我在理解 Linux 中套接字的工作时遇到了一些问题。

```
setsockopt(sockfd, SOL_SOCKET, SO_SNDTIMEO, &timeout, sizeof(int));
write = write(sockfd, buf, len); 
```

在上面的代码中，由于写入被缓冲，发送超时没有任何意义（当用户空间缓冲区被复制到内核缓冲区时，写入系统调用将立即返回）。发送缓冲区大小是更重要的参数，但发送超时似乎没有任何价值。但我肯定错了，因为我见过很多使用 SO_SNDTIMEO 的代码。假设接收器非常慢，如何使用 SO_SNDTIMEO 用户空间代码超时？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-26T01:25:15.643

> 如何在非阻塞套接字上设置发送超时？

它不是。超时用于阻塞模式。非阻塞`recv()`不会阻塞，因此也不会超时。

> 我见过很多使用 SO_SNDTIMEO 的代码。

除非相关代码是无意义的，否则不在非阻塞模式下。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-26T01:05:50.173

SO_SNDTIMEO 对于阻塞套接字很有用。如果套接字的缓冲区已满，则 send() 可以阻塞，在这种情况下，使用 SO_SNDTIMEO 套接字选项可能很有用。对于非阻塞套接字，如果套接字的缓冲区已满，发送将立即失败，因此将 SO_SNDTIMEO 设置为非阻塞套接字是没有意义的。

# nfc - NFC - 新 Ntag21X

> ID：13556975
> 
> 赞同：2
> 
> 时间：2012-11-26T00:05:02.343
> 
> 标签：nfc

我正在尝试为将于今年年底发布的新 NTAG21X 进行编码。关于新标签的可用信息非常有限。只发布给合作伙伴:-(

我试图弄清楚如何使用：

*   标签上的密码保护。这将是存储在其中一个扇区中的密钥吗？您将如何阅读 NDEF？你传递密码来阅读吗？

*   原创签名。它会是 Mifare 上的一个扇区，您可以在其中编写密钥并锁定要保护的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:07:47.680

NTAG21x 是（将是）NFC 论坛类型 2 标签 (T2T) 设备，如 NTAG203（因此名称中的“2”）。您可以预期访问功能将类似于标准 T2T（和 MIFARE Ultralight）读/写命令（因此没有 MIFARE Classic 扇区）。NDEF 的读取应符合 T2T 规范，因此无需密码。可以进行写保护（类似于 MIFARE Ultralight C）。

# arrays - 为什么我的 array.IndexOf 一直返回 -1 (Visual Basic)

> ID：13556977
> 
> 赞同：1
> 
> 时间：2012-11-26T00:05:08.597
> 
> 标签：arrays, vb.net, indexof

我有一个 Visual Basic 的家庭作业程序。它以并行数组的形式存储 7 个朋友的 7 个电话号码。我正在使用 array.indexof 查看我的输入字符串是否在名称数组中，然后返回完整名称和相应的数字。我不是在寻找海报的答案，只是一些指导或指出我的过度网站。提前致谢。抱歉，如果我的帖子出现乱码或格式不正确，第一次发帖 Robert

```
 Dim intCounter As Integer
    Dim strNames() As String = {"BILLY", "JILLY", "MILLY", "PHILLY", "LARRY", "CURLY", "MOE"}
    Dim strNumbers() As String = {"313-213-1234", "248-123-3452", "123-321-1234", "987-986-3456", "567-635-7632", "524-456-6782", "918-872-3452"}
    Dim strLookFor As String
    Dim found As Boolean

    strLookFor = InputBox("Type in the person you want to call", "Phone a Friend") 'prompt from user
    strLookFor.TrimEnd()  'trim whitespace after entry
    strLookFor = strLookFor.ToUpper  'convert to upper case to match

    txtResults.Clear() 'clear text box
    found = False  'set boolean to false
    intCounter = 0  'set intCounter to 0
    Do While Not found And intCounter < strNames.Length

        Dim intIndex As Integer = Array.IndexOf(strNames, strLookFor) 'SHOULD return a value of 0 or higher if found
        If intIndex >= 0 Then  'if loop for value of 0 or higher
            found = True
        End If

        intCounter += 1 'add 1 to intCounter

    Loop

    If found Then  'display phone match up results
        txtResults.Text = ((strNames(intCounter - 1)) & " " & (strNumbers(intCounter - 1)))
    Else
        txtResults.Text = ("Match not found.")
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T06:30:06.787

我建议使用字典（字符串，字符串），它非常适合这种类型的东西：

```
Dim dic As New Dictionary(Of String, String)
    dic.Add("BILLY", "123-456-888")
    dic.Add("JILLY", "333-555-222")
    dic.Add("MILLY", "777-334-667")
    dic.Add("PHILLY", "122-665-333")

    Dim strLookFor As String = InputBox("Type in the person you want to call", "Phone a Friend").ToUpper

    If dic.ContainsKey(strLookFor) Then
        MessageBox.Show(dic(strLookFor))
    Else
        MessageBox.Show("Match not found.")
    End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T04:06:06.473

你说你不想要答案，只想要提示，所以这是我的：

您不需要循环，也不需要`intCounter`or `found`。

`IndexOf`如果不匹配则返回 -1，如果匹配则返回数组元素的索引。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-26T11:38:47.270

我今天早上使用搜索数组而不是 array.indexof 让它工作。抱歉，如果发布不正确，我正在 Visual Basic Express 上运行它。感谢人们的帮助。我所做的修订是（供将来参考）strNames (intCounter).IndexOf (strLookFor)

# javascript - 如果没有 __proto__ 我将如何重写

> ID：13556980
> 
> 赞同：1
> 
> 时间：2012-11-26T00:05:26.520
> 
> 标签：javascript, node.js, express

我正在使用**Node.JS**和**ExpressJS**。以下代码用于使用我自己的消息扩展 Errors 对象并且运行良好，但我知道这`__proto__`是非标准的。

**如果没有 ? ，我将如何重写以下代码`__proto__`？**

```
var AccessDenied = exports.AccessDenied = function(message) {
    this.name = 'AccessDenied';
    this.message = message;
    Error.call(this, message);
    Error.captureStackTrace(this, arguments.callee);
};
AccessDenied.prototype.__proto__ = Error.prototype; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T00:08:52.793

用于`Object.create()`创建新的原型对象，并添加一个不可枚举的`construtor`属性。

```
AccessDenied.prototype = Object.create(Error.prototype, {
    constructor: {
        value: AccessDenied,
        writeable: true,
        configurable: true,
        enumerable: false
    }
}); 
```

* * *

或者，如果您不关心该`constructor`属性：

```
AccessDenied.prototype = Object.create(Error.prototype); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T09:01:52.650

```
"use strict";

/**
 * Module dependencies.
*/
var sys = require("sys");

var CustomException = function() {
    Error.call(this, arguments);    
};
sys.inherits(CustomException, Error);

exports = module.exports = CustomException; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T00:08:44.643

```
var AccessDenied = exports.AccessDenied = function ( message ) { /*...*/ };
var F = function ( ) { };
F.prototype = Error.prototype;
AccessDenied.prototype = new F(); 
```

# c# - SQLDataSource FilterExpressions：如何获取具有相似值而不相等的数据？

> ID：13556985
> 
> 赞同：-1
> 
> 时间：2012-11-26T00:06:38.477
> 
> 标签：c#, asp.net, gridview, sqldatasource

我有一个带有地址列的 GridView，我添加了一个按钮，该按钮调用一个过滤器表达式，假设在该列中查找任何地址，但是如果地址不等于该过滤器表达式，则 GridView 将返回空白。

我需要的是一个过滤表达式来查找一个单词，这样如果用户知道街道或大道，他就可以进行正确的搜索。

这是在事件中调用过滤器表达式的代码：

```
 protected void Button2_Click(object sender, EventArgs e)
    {
        SqlDataSource1.FilterExpression = "Address like '" + TextBox16.Text + "'";
        GridView1.DataBind();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T08:16:11.500

```
SqlDataSource1.FilterExpression = "Address like '%" + TextBox16.Text + "%'"; 
```

# asp.net - ASP.NET MVC4 + HttpPost 提交后获取下拉值

> ID：13556987
> 
> 赞同：0
> 
> 时间：2012-11-26T00:07:06.177
> 
> 标签：asp.net, model, asp.net-mvc-4, html.dropdownlistfor

因此，我想获取下拉列表的值（== 帐户 ID）以插入新交易，您可以在下面找到我的视图：

```
 <div id="content">
        <h2>Overschrijving</h2>
        <p id="topmsg">velden met een * zijn verplicht</p><p>&nbsp;</p>
        <dl class="clearfix form">
            @using (Html.BeginForm(new { ReturnUrl = ViewBag.ReturnUrl })) {
                @Html.ValidationSummary(true, "Gelieve alles correct in te vullen.")

                <dt>@Html.Label("Rekening: *")</dt>
                <dd>@Html.DropDownList("ddlAccounts")</dd>
                <dt>@Html.Label("Begunstigde: *")</dt>
                <dd>@Html.TextBox("ToAccountNumber")</dd>
                <dt>@Html.Label("Bedrag: *")</dt>
                <dd>@Html.TextBox("Amount", null, new { @class = "inpshort" })</dd>
                <dt>@Html.Label("Mededeling: ")</dt>
                <dd>@Html.TextBox("Message", null, new { @class = "inplong" })</dd>

                <dd class="buttons">
                    <input type="submit" value="Bevestigen" />
                    <input type="submit" value="Annuleren" />
                </dd>
            }
        </dl>
    </div> 
```

这是控制器代码：

```
 public ActionResult Transfer(int? id) {
            Holder h = Holder.GetHolderByHolderId(Convert.ToInt32(User.Identity.Name));

            List<Account> holderAccounts = Account.GetAccountsByHolderId(h.Id);

            List<SelectListItem> ddlHolderAccounts = new List<SelectListItem>();
            ddlHolderAccounts.Add(new SelectListItem { Text = "selecteer...", Value = "-1", Selected = true });

            foreach (Account acc in holderAccounts) {
                if (acc.Id == id) {
                    ddlHolderAccounts.Add(new SelectListItem { Text = acc.Name, Value = acc.Id.ToString(), Selected = true });
                } else {
                    ddlHolderAccounts.Add(new SelectListItem { Text = acc.Name, Value = acc.Id.ToString() });
                }
            }

            ViewData["ddlAccounts"] = ddlHolderAccounts;

            return View();
        }

        [HttpPost]
        public ActionResult Transfer(Transaction tra) {
            if (ModelState.IsValid) {
                Transaction.InsertTransaction(tra.Amount, tra.Message, tra.FromAccountId, tra.ToAccountNumber);
            }

            return View(tra);
        } 
```

现在我用谷歌搜索了很多，使用 DropDownListFor 填充你的下拉列表可能会更好？但是谁能给我举个例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:13:19.310

通过查看您的代码，我可以看到您没有将 SelectListItems 列表传递给 DropDownList 助手。您可以通过以下两种方式之一执行此操作。

1-将其绑定到模型上的属性：

```
@Html.DropDownListFor(x=>Model.Property, new List<SelectListItem> { new SelectListItem { Text = "Item1", Value = "Value1" }) 
```

或者

2-您可以在不绑定到模型属性的情况下执行此操作，例如：

```
 @Html.DropDownList("propertyName", new List<SelectListItem> { new SelectListItem { Text = "Item1", Value = "Value1" } }) 
```

如果您使用第二种方法，那么您的控制器操作在提交时必须接受“propertyName”作为参数。

And don't forget to provide a list of SelectListItems to select from (which you're not doing in your code).

Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T16:58:08.503

should be @Html.DropDownListFor(x=>Model.Property, new List { new SelectListItem { Text = "Item1", Value = "Value1" }})

# javascript - 单击外部链接时的警告以及如何将其添加到链接类

> ID：13556990
> 
> 赞同：2
> 
> 时间：2012-11-26T00:07:19.290
> 
> 标签：javascript, html

我不确定如何使用 javascript 在单击外部链接时弹出警告。

我认为在我的外部链接上放一个类也会很方便，但我不太确定它是否像现在这样正确。这是我目前使用的 HTML：

```
 <div id="commercial-container">
        <a href="http://www.link1.com" class="external" target="_blank"> <img src="picture1.jpg" /> </a>
        <a href="http://www.link2.com" class="external" target="_blank"> <img src="pciture2.jpg" /> </a>
        <a href="http://www.link3.com" class="external" target="_blank"> <img src="picture3.jpg" /> </a>
        <a href="http://www.link4.com" class="external" target="_blank"> <img src="picture4" /> </a>
        </div> 
```

我对 javascript 非常陌生，并且非常不确定如何解决我的问题。到目前为止，我几乎唯一想到的是我将不得不使用 window.onbeforeload 但我不知道如何弄清楚如何编写我需要的函数。

我想将我的 javascript 保存在单独的 .js 文档中，而不是 HTML 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:20:47.700

从 onClick 属性调用 confirm() 函数。如果用户单击确定，则此函数返回 true，这将打开链接，否则返回 false。

```
<a href="http://www.link1.com" onClick="return confirm('Do you want to leave')" class="external" target="_blank"> <img src="picture1.jpg"/> </a> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T00:29:10.787

您可以通过向每个链接添加单击事件处理程序来实现。这样就不必使用类名了。即使用户只是试图关闭您的站点，window.onunload 也会运行，您可能不希望这样做。

```
 <a href="yourwebsitedomain.com">staying in site</a>
    <a href="two">going external</a>

    <script>
    var a = document.getElementsByTagName('a');
    var b = a.length;

    while(b--){
        a[b].onclick = function(){
            if(this.href.indexOf('yourwebsitedomain.com')<0){
                //They have clicked an external domain
                alert('going external');
            }
            else{
                alert('staying in your site');
            }
        };
    }
    </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-26T09:25:29.933

如果用户单击图像，div，.. 您需要寻找父节点。! 可能有几个元素用 a-tag 包裹。

```
document.addEventListener('click',function(event){
    var eT=(event.target||event.srcElement); 

    if((eT.tagName.toLowerCase()==='a' && eT.href.indexOf('<mydomain>')<0)
    || (eT.parentNode!==null && eT.parentNode.tagName.toLowerCase()==='a' 
    && eT.parentNode.href.indexOf('<mydomay>')<0))
    {
    //do someting
    }

    else if(eT...){
      ...
    }
},false); 
```

两个旁注：

*   如果您想通过 cookie 或类似的方式跟踪用户，最好检查外部链接、设置超时并发出同步获取请求以更新。
*   最好将事件添加到文档或包含所有事件的 div 并确定目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T00:56:55.717

由于您是 Javascript 新手，我建议您使用 javascript 框架为您完成所有“繁重的工作”。

例如，使用[JQuery](http://jquery.com/)，您可以通过执行以下操作轻松地将 onClick 事件绑定到所有外部链接：

```
$(".external").click(function(event) {
   var confirmation = confirmation("Are you sure you want to leave ?");
   if (!confirmation) {
     // prevents the default event for the click
     // which means that in this case it won't follow the link
     event.preventDefault();
   }
 }); 
```

这样，每次用户单击与外部类的链接时，都会提示用户确认离开的弹出消息框，并且只有在用户说“是”时才会跟随链接。如果您只想通知而不采取任何操作，您可以通过简单的警报调用替换确认：

```
$(".external").click(function(event) {
   alert("You are leaving the site");
 }); 
```

# javascript - 将打字机 jQuery 效果从逐个字母更改为逐个单词

> ID：13556991
> 
> 赞同：0
> 
> 时间：2012-11-26T00:07:27.690
> 
> 标签：javascript, jquery

这个 jQuery 函数一个字母一个字母地工作得很好，但我似乎不能让它一个字一个字地去。

任何想法，这里是功能：

```
//Typewriter Effect
$.fn.Typewriter = function(opts){
    var $this = this,
        defaults = { animDelay: 50 },
        settings = $.extend(defaults, opts);
    $.each(settings.text, function(i, letter){
        setTimeout(function(){
            $this.html($this.html() + (letter!='\n'?letter:'<br />'));
        }, settings.animDelay * i);
    });
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:43:16.090

不要`$.each`用于迭代字符串，`.text`而是用于设置文本而不是`.html`.

要将效果从单个字符更改为整个单词，只需将输入文本[拆分为单词：](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)

```
$.fn.Typewriter = function(opts){
    var $this = this,
        defaults = { animDelay: 50 },
        settings = $.extend(defaults, opts),
        words = settings.text.split(/(?=\s)/), // split before every whitespace
        i = 0;
    function animate() {
        if (i==words.length) return;
        $this.text(words.slice(0, i++).join(''));
        setTimeout(animate, settings.animDelay);
    }
    animate();
} 
```

# apache - 带有 % 字符的 Apache 重写规则

> ID：13556995
> 
> 赞同：1
> 
> 时间：2012-11-26T00:07:43.007
> 
> 标签：apache, rewrite

我有一个需要重写的网址。

[http://aplus-carpetcleaning.com/home.php%3Fcity%3DGainesville%2520VA](http://aplus-carpetcleaning.com/home.php%3Fcity%3DGainesville%2520VA)

我试过这个：

```
^home\.php%3Fcity%3DGainesville%2520VA$ "http://aplus-carpetcleaning.com/home.php?city=Gainevilles%20VA" 
```

这是不被认可的。尝试了各种替代方案，但没有骰子。

**笔记：**

*   `%3F`是 '？'
*   `%3D`是'='，
*   `%2520`谁知道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:17:12.663

重写模块将您的正则表达式模式应用于解码的 url，而不是您在浏览器 url 字段中看到的 urlencoded 字符串。

因此，请改用非转义字符创建您的正则表达式模式。就像是：

```
^home.php\?city=Gainesville&20VA$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T01:43:59.767

修复它：

```
RewriteRule ^home\.php(.*)city(.*)Gainesville(.*)VA$ "http:\/\/aplus\-carpetcleaning\.com\/home\.php?city=Gainesville VA" [R=301,L] 
```