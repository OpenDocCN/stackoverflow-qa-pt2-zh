# StackOverflow 问答 13240000-13240999

# html - 在 div 中对齐输入

> ID：13240002
> 
> 赞同：0
> 
> 时间：2012-11-05T20:39:30.753
> 
> 标签：html, css, input

我有这样的html代码：

```
<div class="one1">
<div class="one">
<input class="two" name="user[email]" placeholder="Ваш e-mail" required="required" type="email">
</div>
</div>​ 
```

和CSS

```
.one1{
    background-color: #000;
    width:200px;
    height: 200px;
}
.one{
    margin: 0 auto;
    background-color: #cecece;
    width:180px;
    height: 200px;
}
.two{
    width: 100%;
    margin: 0;
    padding: 0;
}
​ 
```

但是为什么输入在右边框上有点大？由于它是一个 div，如何清楚？（也会有圆角边框和阴影）

这里：

> [关联](http://jsfiddle.net/7fXhv/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T20:44:27.757

你去掉`margin`and`padding`但输入也有`border`。所以尝试添加`border:none`.`input`

[演示](http://jsfiddle.net/7fXhv/16/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T20:45:05.883

因为它包括边框宽度。尝试：

```
.two{
    width: 100%;
    margin: 0;
    padding: 0;
    border: 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T20:45:14.367

它是由用户代理样式表添加的边框引起的。添加`border: 0;`到`two`班级。

```
.two{
    width: 100%;
    margin: 0;
    padding: 0;
    border:0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T20:53:24.290

最好是在您输入的左右两侧删除 1px 并手动设置它而不是 100%

```
.two{
    width: 178px;
    margin: 0;
    padding: 0;
    border:1px solid black;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T07:34:55.907

如果您想将边框保持在 1 px，请执行以下操作：

```
.two {
  width: 100%;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -moz-box-sizing: border-box; /* Firefox */
  -webkit-box-sizing: border-box; /* Safari */
} 
```

浏览器正在根据内容+填充计算输入的宽度（100％），您希望指示浏览器也包括边框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T07:58:19.127

你可以使用这个 CSS 属性

```
input.two{
  box-sizing: border-box;
  -moz-box-sizing: border-box; /* Firefox */
  -webkit-box-sizing: border-box; /* Safari */
} 
```

# javascript - JavaScript 重新映射数据空数组

> ID：13240005
> 
> 赞同：-2
> 
> 时间：2012-11-05T20:39:40.080
> 
> 标签：javascript

我正在尝试使用 JavaScript 重新映射数据

```
data[year].map(function(val1,index1){
    for(var prop in val1){
        if (plotdata[prop] === undefined)
            plotdata[prop] = new Array();
        if (plotdata[prop][year] === undefined)
            plotdata[prop][year] = new Array();
        plotdata[prop][year][index1] = val1[prop];
    }
}); 
```

`data`是一个带有 key 的数组`"2012"`。

`plotdata`也是一个数组。

`data['2012']`包含 12 个月，索引从 0 到 11。我正在尝试重新映射数据，以便我可以访问它`plotdata[property][year][month]`，但问题是`plotdata`映射后为空。

我已经检查过，`val1[prop]`确实有价值。这里可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T20:53:59.413

根据上面的评论线程。. . 这个：

```
 plotdata[prop] = new Array(); 
```

应该是这样的：

```
 plotdata[prop] = {}; 
```

因为您想要一个以年为键的关联数组，而不是长度为 2,013 的常规数组。

# google-app-engine - 如何在每个浏览器上运行 gwt gae 应用程序？

> ID：13240006
> 
> 赞同：0
> 
> 时间：2012-11-05T20:39:46.353
> 
> 标签：google-app-engine, gwt

如何在所有浏览器上运行 gwt 应用程序？

当我输入我的 app_name.gwt.xml

```
<set-property name="user.agent" value="gecko1_8" /> 
```

该应用程序仅在 Firefox 上运行

如果我把

```
<set-property name="user.agent" value="safari" /> 
```

它在谷歌浏览器上运行。

如果我把

```
<set-property name="user.agent" value="safari" />
<set-property name="user.agent" value="gecko1_8" /> 
```

他取最后一个值，因此该应用程序仅在 Firefox 上运行。

我试过这样的事情

```
<set-property name="user.agent" value="gecko1_8, safari" /> 
```

或者

```
 <set-property name="user.agent" value="safari" value="gecko1_8"/> 
```

但没有任何效果。如何在每个浏览器上运行 gwt 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:48:56.140

只需删除 set-property 标记或将其注释掉：

```
<!--set-property name="user.agent" value="gecko1_8" /--> 
```

然后编译器将构建所有可能的排列（# of language x 6）。

# sitecore - Sitecore 6 WFFM：如何自定义报告？

> ID：13240014
> 
> 赞同：1
> 
> 时间：2012-11-05T20:40:16.463
> 
> 标签：sitecore, sitecore6, web-forms-for-marketers

我有一些字段不想出现在报告中。有没有办法完全隐藏它们（甚至不显示这些字段的列标题）？

我尝试创建自己的 ISaveAction，目的是在将这些字段保存到数据库之前过滤掉它们，但即使它们没有出现在发送到 DataManager.InsertForm 的 AdaptedResultList 中，与这些字段关联的列仍然会出现在报告中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T01:48:41.257

开箱即用的功能，答案是如果您指的是 WFFM 表单报告区域中的报告之一，您很可能可以，具体取决于报告。如果您的意思是您在查看时可以在顶部看到“设计”按钮的报告之一，那么您知道它正在使用此路径中网站目录中的 .mrt 文件之一中配置的报告：

Website\sitecore modules\Shell\Web Forms for Marketing\Reports

通过点击“设计”按钮编辑其中一份报告将打开 Sitecore 内置的 Stimulsoft 设计器，您可以进行更改。您还可以从 Stimulsoft 网站下载一个试用客户端，然后直接打开 .mrt 文件并以这种方式编辑它们（界面比内置的 Sitecore 更好）。

但是请注意，请先备份文件！！！Stimulsoft 界面很挑剔，很容易破解，而且它有一个学习曲线。一旦你弄清楚了基础知识，删除一个字段就是小菜一碟。

# c++ - C++11 可重入类锁定策略

> ID：13240015
> 
> 赞同：8
> 
> 时间：2012-11-05T20:40:20.417
> 
> 标签：c++, design-patterns, boost, c++11, locking

我有一个使用`pimpl`成语的界面，但是该界面需要是可重入的。然而，调用线程不需要知道锁定。这是一个由四部分组成的问题和一部分无偿设计的 C++11 示例（包含示例以解决我遇到的几个类似常见问题的问题 re: `locking`、和 C++11 `pimpl`，`rvalue`其中答案的质量有些可疑） .

在标题中，example.hpp：

```
#ifndef EXAMPLE_HPP
#define EXAMPLE_HPP

#include <memory>
#include <string>

#ifndef BOOST_THREAD_SHARED_MUTEX_HPP
# include <boost/thread/shared_mutex.hpp>
#endif

namespace stackoverflow {

class Example final {
public:
  typedef ::boost::shared_mutex shared_mtx_t;
  typedef ::boost::shared_lock< shared_mtx_t > shared_lock_t;
  typedef ::boost::unique_lock< shared_mtx_t > unique_lock_t;

  Example();
  Example(const std::string& initial_foo);

  ~Example();
  Example(const Example&) = delete;             // Prevent copying
  Example& operator=(const Example&) = delete;  // Prevent assignment

  // Example getter method that supports rvalues
  std::string foo() const;

  // Example setter method using perfect forwarding & move semantics. Anything
  // that's std::string-like will work as a parameter.
  template<typename T>
  bool foo_set(T&& new_val);

  // Begin foo_set() variants required to deal with C types (e.g. char[],
  // char*). The rest of the foo_set() methods here are *NOT* required under
  // normal circumstances.

  // Setup a specialization for const char[] that simply forwards along a
  // std::string. This is preferred over having to explicitly instantiate a
  // bunch of const char[N] templates or possibly std::decay a char[] to a
  // char* (i.e. using a std::string as a container is a Good Thing(tm)).
  //
  // Also, without this, it is required to explicitly instantiate the required
  // variants of const char[N] someplace. For example, in example.cpp:
  //
  // template bool Example::foo_set<const char(&)[6]>(char const (&)[6]);
  // template bool Example::foo_set<const char(&)[7]>(char const (&)[7]);
  // template bool Example::foo_set<const char(&)[8]>(char const (&)[8]);
  // ...
  //
  // Eww. Best to just forward to wrap new_val in a std::string and proxy
  // along the call to foo_set<std::string>().
  template<std::size_t N>
  bool foo_set(const char (&new_val)[N]) { return foo_set(std::string(new_val, N)); }

  // Inline function overloads to support null terminated char* && const
  // char* arguments. If there's a way to reduce this duplication with
  // templates, I'm all ears because I wasn't able to generate a templated
  // versions that didn't conflict with foo_set<T&&>().
  bool foo_set(char* new_val)       { return foo_set(std::string(new_val)); }
  bool foo_set(const char* new_val) { return foo_set(std::string(new_val)); }

  // End of the foo_set() overloads.

  // Example getter method for a POD data type
  bool bar(const std::size_t len, char* dst) const;
  std::size_t bar_capacity() const;

  // Example setter that uses a unique lock to access foo()
  bool bar_set(const std::size_t len, const char* src);

  // Question #1: I can't find any harm in making Impl public because the
  // definition is opaque. Making Impl public, however, greatly helps with
  // implementing Example, which does have access to Example::Impl's
  // interface. This is also preferre, IMO, over using friend.
  class Impl;

private:
  mutable shared_mtx_t rw_mtx_;
  std::unique_ptr<Impl> impl_;
};

} // namespace stackoverflow

#endif // EXAMPLE_HPP 
```

然后在实现中：

```
#include "example.hpp"

#include <algorithm>
#include <cstring>
#include <utility>

namespace stackoverflow {

class Example;
class Example::Impl;

#if !defined(_MSC_VER) || _MSC_VER > 1600
// Congratulations!, you're using a compiler that isn't broken

// Explicitly instantiate std::string variants
template bool Example::foo_set<std::string>(std::string&& src);
template bool Example::foo_set<std::string&>(std::string& src);
template bool Example::foo_set<const std::string&>(const std::string& src);

// The following isn't required because of the array Example::foo_set()
// specialization, but I'm leaving it here for reference.
//
// template bool Example::foo_set<const char(&)[7]>(char const (&)[7]);
#else
// MSVC workaround: msvc_rage_hate() isn't ever called, but use it to
// instantiate all of the required templates.
namespace {
  void msvc_rage_hate() {
    Example e;
    const std::string a_const_str("a");
    std::string a_str("b");
    e.foo_set(a_const_str);
    e.foo_set(a_str);
    e.foo_set("c");
    e.foo_set(std::string("d"));
  }
} // anon namespace
#endif // _MSC_VER

// Example Private Implementation

class Example::Impl final {
public:
  // ctors && obj boilerplate
  Impl();
  Impl(const std::string& init_foo);
  ~Impl() = default;
  Impl(const Impl&) = delete;
  Impl& operator=(const Impl&) = delete;

  // Use a template because we don't care which Lockable concept or LockType
  // is being used, just so long as a lock is held.
  template <typename LockType>
  bool bar(LockType& lk, std::size_t len, char* dst) const;

  template <typename LockType>
  std::size_t bar_capacity(LockType& lk) const;

  // bar_set() requires a unique lock
  bool bar_set(unique_lock_t& lk, const std::size_t len, const char* src);

  template <typename LockType>
  std::string foo(LockType& lk) const;

  template <typename T>
  bool foo_set(unique_lock_t& lk, T&& src);

private:
  // Example datatype that supports rvalue references
  std::string foo_;

  // Example POD datatype that doesn't support rvalue
  static const std::size_t bar_capacity_ = 16;
  char bar_[bar_capacity_ + 1];
};

// Example delegating ctor
Example::Impl::Impl() : Impl("default foo value") {}

Example::Impl::Impl(const std::string& init_foo) : foo_{init_foo} {
  std::memset(bar_, 99 /* ASCII 'c' */, bar_capacity_);
  bar_[bar_capacity_] = '\0'; // null padding
}

template <typename LockType>
bool
Example::Impl::bar(LockType& lk, const std::size_t len, char* dst) const {
  BOOST_ASSERT(lk.owns_lock());
  if (len != bar_capacity(lk))
    return false;
  std::memcpy(dst, bar_, len);

  return true;
}

template <typename LockType>
std::size_t
Example::Impl::bar_capacity(LockType& lk) const {
  BOOST_ASSERT(lk.owns_lock());
  return Impl::bar_capacity_;
}

bool
Example::Impl::bar_set(unique_lock_t &lk, const std::size_t len, const char* src) {
  BOOST_ASSERT(lk.owns_lock());

  // Return false if len is bigger than bar_capacity or the values are
  // identical
  if (len > bar_capacity(lk) || foo(lk) == src)
    return false;

  // Copy src to bar_, a side effect of updating foo_ if they're different
  std::memcpy(bar_, src, std::min(len, bar_capacity(lk)));
  foo_set(lk, std::string(src, len));
  return true;
}

template <typename LockType>
std::string
Example::Impl::foo(LockType& lk) const {
  BOOST_ASSERT(lk.owns_lock());
  return foo_;
}

template <typename T>
bool
Example::Impl::foo_set(unique_lock_t &lk, T&& src) {
  BOOST_ASSERT(lk.owns_lock());
  if (foo_ == src) return false;
  foo_ = std::move(src);
  return true;
}

// Example Public Interface

Example::Example() : impl_(new Impl{}) {}
Example::Example(const std::string& init_foo) : impl_(new Impl{init_foo}) {}
Example::~Example() = default;

bool
Example::bar(const std::size_t len, char* dst) const {
  shared_lock_t lk(rw_mtx_);
  return impl_->bar(lk, len , dst);
}

std::size_t
Example::bar_capacity() const {
  shared_lock_t lk(rw_mtx_);
  return impl_->bar_capacity(lk);
}

bool
Example::bar_set(const std::size_t len, const char* src) {
  unique_lock_t lk(rw_mtx_);
  return impl_->bar_set(lk, len, src);
}

std::string
Example::foo() const {
  shared_lock_t lk(rw_mtx_);
  return impl_->foo(lk);
}

template<typename T>
bool
Example::foo_set(T&& src) {
  unique_lock_t lk(rw_mtx_);
  return impl_->foo_set(lk, std::forward<T>(src));
}

} // namespace stackoverflow 
```

我的问题是：

1.  有没有更好的方法来处理私有实现内部的锁定？
2.  鉴于定义不透明，公开 Impl 是否有任何实际危害？
3.  当使用 clang`-O4`启用[Link-Time Optimization](http://llvm.org/docs/LinkTimeOptimization.html)时，链接器应该可以绕过`std::unique_ptr`. 有人验证过吗？
4.  有没有办法`foo_set("asdf")`正确调用并拥有示例链接？我们在弄清楚正确的显式模板实例化的用途时遇到了问题`const char[6]`。现在我已经设置了一个模板特化，它创建一个`std::string`对象并代理对 foo_set() 的调用。考虑到所有因素，这似乎是最好的前进方式，但我想知道如何传递“asdf”和`std::decay`结果。

关于锁定策略，出于以下几个原因，我对此产生了明显的偏见：

*   我可以在适当的情况下将互斥锁更改为独占互斥锁
*   通过设计 Impl API 以包含所需的锁，锁定语义有非常强大的编译时保证
*   很难忘记锁定某些东西（当这种情况发生时，一个“简单的 API”错误，一旦 API 被修复，编译器将再次捕获这个错误）
*   由于 RAII 和 Impl 没有对互斥锁的引用，很难将某些东西锁定或创建死锁
*   使用模板无需从唯一锁降级为共享锁
*   由于此锁定策略涵盖的代码比实际需要的多，因此需要显式努力将锁从唯一降级为共享，这可以处理非常常见的场景，其中使用共享锁做出的假设需要在进入唯一锁定时重新测试区域
*   错误修复或 Impl API 更改不需要重新编译整个应用程序，因为 example.hpp 的 API 是外部修复的。

我读过[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)也使用这种类型的锁定策略，但我欢迎ACE用户或其他人对现实世界的批评：将锁定作为接口的必需部分传递。

为了完整起见，这里有一个 example_main.cpp 供人们参考。

```
#include <sysexits.h>

#include <cassert>
#include <iostream>
#include <memory>
#include <stdexcept>

#include "example.hpp"

int
main(const int /*argc*/, const char** /*argv*/) {
  using std::cout;
  using std::endl;
  using stackoverflow::Example;

  {
    Example e;
    cout << "Example's foo w/ empty ctor arg: " << e.foo() << endl;
  }

  {
    Example e("foo");
    cout << "Example's foo w/ ctor arg: " << e.foo() << endl;
  }

  try {
    Example e;
    { // Test assignment from std::string
      std::string str("cccccccc");
      e.foo_set(str);
      assert(e.foo() == "cccccccc");  // Value is the same
      assert(str.empty());            // Stole the contents of a_str
    }
    { // Test assignment from a const std::string
      const std::string const_str("bbbbbbb");
      e.foo_set(const_str);
      assert(const_str == "bbbbbbb");               // Value is the same
      assert(const_str.c_str() != e.foo().c_str()); // Made a copy
    }
    {
      // Test a const char[7] and a temporary std::string
      e.foo_set("foobar");
      e.foo_set(std::string("ddddd"));
    }
    { // Test char[7]
      char buf[7] = {"foobar"};
      e.foo_set(buf);
      assert(e.foo() == "foobar");
    }
    { //// And a *char[] & const *char[]
      // Use unique_ptr to automatically free buf
      std::unique_ptr<char[]> buf(new char[7]);
      std::memcpy(buf.get(), "foobar", 6);
      buf[6] = '\0';
      e.foo_set(buf.get());
      const char* const_ptr = buf.get();
      e.foo_set(const_ptr);
      assert(e.foo() == "foobar");
    }

    cout << "Example's bar capacity: " << e.bar_capacity() << endl;
    const std::size_t len = e.bar_capacity();

    std::unique_ptr<char[]> buf(new char[len +1]);

    // Copy bar in to buf
    if (!e.bar(len, buf.get()))
      throw std::runtime_error("Unable to get bar");
    buf[len] = '\0'; // Null terminate the C string
    cout << endl << "foo and bar (a.k.a.) have different values:" << endl;
    cout << "Example's foo value: " << e.foo() << endl;
    cout << "Example's bar value: " << buf.get() << endl;

    // Set bar, which has a side effect of calling foo_set()
    buf[0] = 'c'; buf[1] = buf[2] = '+'; buf[3] = '\0';
    if (!e.bar_set(sizeof("c++") - 1, buf.get()))
      throw std::runtime_error("Unable to set bar");

    cout << endl << "foo and bar now have identical values but only one lock was acquired when setting:" << endl;
    cout << "Example's foo value: " << e.foo() << endl;
    cout << "Example's bar value: " << buf.get() << endl;
  } catch (...) {
    return EX_SOFTWARE;
  }

  return EX_OK;
} 
```

并构建使用说明`C++11`和`libc++`：

```
clang++ -O4 -std=c++11 -stdlib=libc++ -I/path/to/boost/include -o example.cpp.o -c example.cpp
clang++ -O4 -std=c++11 -stdlib=libc++ -I/path/to/boost/include -o example_main.cpp.o -c example_main.cpp
clang++ -O4 -stdlib=libc++ -o example example.cpp.o example_main.cpp.o /path/to/boost/lib/libboost_exception-mt.dylib /path/to/boost/lib/libboost_system-mt.dylib /path/to/boost/lib/libboost_thread-mt.dylib 
```

* * *

`foo_set()`作为一个小小的奖励，我更新了这个例子，在方法中使用右值引用包含完美转发。虽然并不完美，但获得正确的模板实例化所需的时间比我预期的要长，这是链接时的一个问题。这还包括 C 基本类型的适当重载，包括：`char*`、`const char*`、`char[N]`和`const char[N]`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T18:59:21.610

对于问题 1，我想做的一件事是使用 SFINAE 将传入的锁类型限制为`LockType`允许`shared_lock_t`或`unique_lock_t`.

IE：

```
template <typename LockType>
typename std::enable_if<
  std::is_same< LockType, shared_lock_t > || std::is_same< LockType, unique_lock_t >,
  size_t
>::type 
bar_capacity(LockType& lk) const; 
```

...但这确实有点冗长。

这意味着传入错误类型的 Lock 会给您一个“没有匹配项”错误。另一种方法是有两个不同`bar_capacity`的接受`shared_lock_t`和`unique_lock_t`暴露，以及他们接受模板的私有 bar_capacity `LockType`。

如所写，任何具有`.owns_lock()`返回可转换类型的方法的类型`bool`都是有效的参数......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T17:19:56.227

使用 Pimpl 习惯用法，互斥锁应该是实现的一部分。这将让您掌握何时启动锁。

顺便说一句，为什么在 lock_guard 就足够的情况下使用 unique_lock ？

我认为公开 impl 没有任何优势。

对于大多数现代编译器来说，std::unique_ptr 应该和指针一样高效。不过没有验证。

我会转发 const char[N] foo_set 而不是

```
 template<std::size_t N>
  bool foo_set(const char (&new_val)[N]) { return foo_set(std::string(new_val, N)); } 
```

但喜欢

```
 template<std::size_t N>
  bool foo_set(const char (&new_val)[N]) { return foo_set(N, new_val); } 
```

这避免了在头文件上创建字符串并让实现做任何需要的事情。

# python - Django 模型类装饰器

> ID：13240016
> 
> 赞同：3
> 
> 时间：2012-11-05T20:40:21.530
> 
> 标签：python, django

我需要跟踪 Django 模型实例的更改。我知道像 django-reversion 这样的解决方案，但它们对我的事业来说太过分了。

我想创建一个参数化的类装饰器来满足这个目的。参数是字段名称和回调函数。这是我此时的代码：

```
def audit_fields(fields, callback_fx):
    def __init__(self, *args, **kwargs):
        self.__old_init(*args, **kwargs)
        self.__old_state = self.__get_state_helper()

    def save(self, *args, **kwargs):
        new_state = self.__get_state_helper()

        for k,v in new_state.items():
            if (self.__old_state[k] != v):
                callback_fx(self, k, self.__old_state[k], v)

        val = self.__old_save(*args, **kwargs)
        self.__old_state = self.__get_state_helper()
        return val

    def __get_state_helper(self):
        # make a list of field/values.
        state_dict = dict()
        for k,v in [(field.name, field.value_to_string(self)) for field in self._meta.fields if field.name in fields]:
            state_dict[k] = v
        return state_dict

    def fx(clazz):
        # Stash originals
        clazz.__old_init = clazz.__init__
        clazz.__old_save = clazz.save

        # Override (and add helper)
        clazz.__init__ = __init__
        clazz.__get_state_helper = __get_state_helper
        clazz.save = save
        return clazz

    return fx 
```

并按如下方式使用（仅相关部分）：

```
@audit_fields(["status"], fx)
class Order(models.Model):
    BASKET = "BASKET"
    OPEN = "OPEN"
    PAID = "PAID"
    SHIPPED = "SHIPPED"
    CANCELED = "CANCELED"
    ORDER_STATES = ( (BASKET, 'BASKET'),
                 (OPEN, 'OPEN'),
                 (PAID, 'PAID'),
                 (SHIPPED, 'SHIPPED'),
                 (CANCELED, 'CANCELED') )
    status = models.CharField(max_length=16, choices=ORDER_STATES, default=BASKET) 
```

并在 Django shell 上进行测试：

```
from store.models import Order
o=Order()
o.status=Order.OPEN
o.save() 
```

我收到的错误是：

```
TypeError: int() argument must be a string or a number, not 'Order' 
```

完整的堆栈跟踪在这里：[https ://gist.github.com/4020212](https://gist.github.com/4020212)

提前致谢，如果您需要更多信息，请告诉我！

**编辑：**由 randomhuman 回答的问题，代码编辑和可用，如图所示！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T21:38:26.167

您不需要在此行显式传递对*self的引用：*

```
val = self.__old_save(self, *args, **kwargs) 
```

它是在对象引用上调用的方法。以这种方式显式传递它会导致它被视为保存方法的其他参数之一，该参数应为字符串或数字。

# firefox - 使内容可在 Addon SDK 上访问

> ID：13240017
> 
> 赞同：4
> 
> 时间：2012-11-05T20:40:27.580
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我正在使用 Firefox 的 Addon SDK (v. 1.11) 开发一个插件。我的扩展在每个网站上动态创建一个 iframe，然后从插件的本地目录加载一个 html 文件，其中包括其他资源，例如图像、字体文件等。

**问题**

当加载任何此类本地资源（即：“ *resource://* ”模式）时，iframe 无法显示它们并抛出一条消息：

> 安全错误：http://www.XXX 的内容可能无法加载或链接到资源：//XXX

[这是Firefox 3 引入](https://developer.mozilla.org/en-US/docs/Chrome_Registration#contentaccessible)的安全措施。在没有插件 SDK 的情况下进行开发时，解决方法是声明一个带有“contentaccessible=yes”的目录，使任何人都可以访问该目录的内容，包括我的插件。但是，我无法使用 Addon SDK 找到类似的功能。有没有更好的方法在我的插件创建并插入页面的 iframe 上使用本地数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-14T07:53:38.220

我认为您不能直接加载指向 URL 内资源的 iFrame。浏览器抱怨是因为它违反了同源策略或跨站点脚本策略。我现在不记得是哪一个了。

如果它是您要加载的 html 内容，您可以随时将其注入 DOM，然后使用事件 API 向文档对象发送消息以显示您的自定义 html。我过去做过这个，它有效。

所以从 main.js 向内容脚本发送一条消息，然后将您的 iframe html 注入 DOM，然后您可以向文档对象发送一条消息以显示它。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-31T02:24:43.137

不确定您发布问题时是否是这种情况，但似乎“resource://”不应再与 Addon SDK 一起使用。

如果您在扩展中使用 HTML 文件内的资源，则可以在本地引用它，否则您应该使用 data.url('whatever.jpg') 并根据需要传递该值。

完整信息在这里：[http ://blog.mozilla.org/addons/2012/01/11/sdk-1-4-known-issue-with-hard-coding-resource-uris/](http://blog.mozilla.org/addons/2012/01/11/sdk-1-4-known-issue-with-hard-coding-resource-uris/)

# c# - 使用任务对象和监视器线程的长时间运行进程

> ID：13240024
> 
> 赞同：0
> 
> 时间：2012-11-05T20:41:04.693
> 
> 标签：c#, .net, c#-4.0, task-parallel-library

我正在尝试监视一个长时间运行的进程。现在，该过程为所有小块创建了新的任务对象，但我需要一些方法来监控它们的进度以将状态发送到 UI。

```
ExecutionContext ctx = new ExecutionContext()
        {
            Result = result,
            LastCount = result.Values.Count
        };

        Task t = Task.Factory.StartNew(() =>
            {
                foreach (var dataSlice in dataObjects)
                {
                   Task.Factory.StartNew(() =>
                   {
                       // Do Some Work
                   }, TaskCreationOptions.AttachedToParent);
                }
            });

        ctx.ParentTask = t;

        Task monitor = Task.Factory.StartNew( () =>
            {
                ctx.LastCount = ctx.Result.Values.Count;

            }, TaskCreationOptions.LongRunning); 
```

我的问题，或者也许问题是，如果我强制我的监视器任务等待（通过 SpinWait 或睡眠）它可能会锁定在它上面创建的部分任务吗？我需要监视器不时检查状态，但我不希望它的等待条件杀死另一个需要运行的任务。

编辑：

所以我发现了一种有趣的方法，它与 Hans 在下面的评论中建议的方法非常相似。它分为两部分。一项任务在中间多次发生，一项完成任务进行最后的清理。仍在测试中，但看起来很有希望。

这是它的样子：

```
 Task t = new Task(() =>
            {
                int i = 0;
                for (int j = 0; j < 200; j++)
                {

                    foreach (var session in sessions)
                    {
                        Task work = action.Invoke(SomeParameter);
                        if (i == 50 || i == 0)
                        {
                            work.ContinueWith(task => Task.Factory.StartNew(UpdateAction));
                            i = 1;
                        }
                        else
                        {
                            i++;
                        }
                    }
                }
            });

        ctx.ParentTask = t;

        t.ContinueWith(CompletionAction => Task.Factory.StartNew(() => CompleteExecution(SomeParameter)));

        t.Start(); 
```

# objective-c - 第二次从 nib 加载 UIViewController 会弄乱 UIImageView 的帧

> ID：13240027
> 
> 赞同：0
> 
> 时间：2012-11-05T20:41:18.677
> 
> 标签：objective-c, ios, cocoa-touch, uiviewcontroller

好吧，这很奇怪。我以前从未遇到过这样的事情：

我正在加载`LoadVC`这样调用的 UIViewController：

```
self.window.rootViewController = [[LoadVC alloc] init]; 
```

我第一次这样做时，有问题的 UIImageView 是完美的，就像我在 IB 中设置的一样：

```
<UIImageView: 0x1ed689c0; frame = (0 -20; 320 480); clipsToBounds = YES; opaque = NO; autoresize = W+RM+H; layer = <CALayer: 0x1ed68a20>> 
```

负 y 偏移是有意的。我第二次加载这个视图控制器时，图像视图变得疯狂：

```
 <UIImageView: 0x1eda3160; frame = (0 -20; 320 436); clipsToBounds = YES; opaque = NO; autoresize = W+RM+H; layer = <CALayer: 0x1eda28d0>> 
```

wutup 与 dat？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T20:47:22.357

视图的框架不是静态的，并且可以根据其大小调整蒙版进行更改以适应环境。第一次加载它时，它可能是在一个清晰的屏幕上。第二次看起来像导航栏之类的东西占用了空间，所以它被垂直挤压了。除非您的意思是您在相同的条件下从同一地点加载了两次，并且每次都得到不同的帧。

# vba - VBA 将公式（在多行中）拖到使用的最后一行

> ID：13240030
> 
> 赞同：4
> 
> 时间：2012-11-05T20:41:43.150
> 
> 标签：vba, excel, excel-2007

我有来自 O -> X 列的公式，需要它们将它们拖到使用的最后一行。以下是我正在使用的当前代码：

```
Dim wkb As Workbook
Dim wkbFrom As Workbook
Dim wks As Worksheet
Dim rng As Range
Dim path As String, FilePart As String
Dim TheFile
Dim loc As String
Dim Lastrow As Long

Set wkb = ThisWorkbook
loc = shPivot.Range("E11").Value
path = shPivot.Range("E12").Value
FilePart = Trim(shPivot.Range("E13").Value)
TheFile = Dir(path & "*" & FilePart & ".xls")
Set wkbFrom = Workbooks.Open(loc & path & TheFile & FilePart)
Set wks = wkbFrom.Sheets("SUPPLIER_01_00028257_KIK CUSTOM")
Set rng = wks.Range("A2:N500")

'Copies range from report generated to share drive and pastes into the current week tab of open order report
rng.Copy wkb.Sheets("Current Week").Range("A4")

With ActiveSheet

    Lastrow = .Cells(.Rows.Count, "A").End(xlUp).Row
    .Range("O4:X4").AutoFill .Range("O4:X4").Resize(Lastrow)

End With 
```

代码 Lastrow 没有将公式拖下来

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-05T21:16:35.643

您可以在 VBA 中进行这样的自动填充（使用宏录制验证）

```
Range("O1:X1").Select
Selection.AutoFill Destination:=Range("O1:X25"), Type:=xlFillDefault 
```

现在您有了此代码作为使用的基础，您可以在语法中使用您喜欢的任何变量，如下所示：

```
Range("O1:X1").Select
Selection.AutoFill Destination:=Range("O1:X" & Lastrow), Type:=xlFillDefault 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-20T11:08:04.427

我用这个：

```
Sub sum_1to10_fill()
Sheets("13").Activate
Range("EG12").Copy
Range("EG12:FT36").PasteSpecial xlPasteFormulas 
```

结束子

...并在上下左右填满了我的整个标签。

# django - 限制用户使用特定域注册：django

> ID：13240032
> 
> 赞同：2
> 
> 时间：2012-11-05T20:41:46.733
> 
> 标签：django, django-forms, django-templates

我是 Django 新手。

我想限制用户使用特定域（例如 @gmail.com ）来注册我的 Django 网站，但是如何在我的注册表单中自定义 EmailField 来做到这一点？

仅供参考，这是我的代码。

表格.py

```
class RegistrationForm(ModelForm):
    username = forms.CharField(label=(u'User Name'))
    email = forms.EmailField(label = (u'Email Adress'))

    class Meta:
        model = UserProfile
        exclude = ('user',) 
```

注册.html

```
{% extends "base.html" %}
{% block content %}
<form action = "" method ="post">
{% csrf_token%}
{% if form.errors %}  <p>Please correct the following fields</p> {% endif %}
<div class  ="register_div">
    {% if form.username.errors %}<p class="error">{{ form.username.errors }}</p>{% endif %}
    <p><label for="username"{% if form.username.errors %} class="error"{% endif %}>Username:</label></p>
    <p>{{ form.username }}</p>
</div>
<div class  ="register_div">
    {% if form.email.errors %}<p class = "error">{{ form.email.errors }}</p>{% endif %}
     <p><label for ="email"{% if form.email.errors %} class="error"{% endif %}>Email:<label><p>
    <p>{{ form.email }}</p>
</div>

<p><input type="submit" alt="register" /></p>
</form>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-05T21:34:15.987

您可以为表单编写自己的干净函数：

```
class RegistrationForm(ModelForm):
    username = forms.CharField(label=(u'User Name'))
    email = forms.EmailField(label = (u'Email Adress'))

    def clean_email(self):
        data = self.cleaned_data['email']
        if "@gmail.com" not in data:   # any check you need
            raise forms.ValidationError("Must be a gmail address")
        return data

    class Meta:
        model = UserProfile
        exclude = ('user',) 
```

更多信息：[https ://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-17T06:01:37.893

您可以通过 HTML5 输入标签属性（模式）实现相同的目的。例如，您的域是 foo.com，那么代码将是：

```
<input id="email" type="email" pattern="[a-z.]*[@]\bfoo.com" required> 
```

您还可以使用 DOM 元素的 setCustomValidity 更改错误消息。

```
document.getElementById('email').setCustomValidity("Please use an @foo.com email address."); 
```

# c# - C# 远程 Powershell SharePoint 2010

> ID：13240033
> 
> 赞同：0
> 
> 时间：2012-11-05T20:41:50.453
> 
> 标签：c#, sharepoint, powershell, sharepoint-2010, powershell-2.0

我正在尝试从 ac# 控制台应用程序在远程共享点服务器上运行 powershell 命令。这是我到目前为止的代码。它运行没有错误，但什么也不做。我究竟做错了什么？

谢谢

服务器名、用户名密码、url被取出

```
 public static string RunScript()
    {

       Runspace remoteRunspace = null;
       openRunspace("http://server/wsman",
            "http://schemas.microsoft.com/powershell/Microsoft.PowerShell",
            @"domain\user",
            "password",
            ref remoteRunspace);
       try
       {
           StringBuilder stringBuilder = new StringBuilder();
           using (PowerShell powershell = PowerShell.Create())
           {

               powershell.Runspace = remoteRunspace;
               powershell.AddScript("Add-PsSnapin Microsoft.SharePoint.PowerShell");
               powershell.AddScript("enable-SPFeature -identity \"2dfc204b-e9da-4c6c-8b4f-c2f7c593ad4e\" -url sharepointsite -Confirm:$False");
               powershell.Invoke();
               Collection<PSObject> results = powershell.Invoke();
               remoteRunspace.Close();
               foreach (PSObject obj in results)
               {
                   stringBuilder.AppendLine(obj.ToString());
               }
           }

           return stringBuilder.ToString();
       }
       catch (Exception e)
       {

           return "";

       }

     }

    public static void  openRunspace(string uri, string schema, string username, string livePass, ref Runspace remoteRunspace)
    {
        System.Security.SecureString password = new System.Security.SecureString();
        foreach (char c in livePass.ToCharArray())
        {
            password.AppendChar(c);
        }
        PSCredential psc = new PSCredential(username, password);
        WSManConnectionInfo rri = new WSManConnectionInfo(new Uri(uri), schema, psc);
        rri.AuthenticationMechanism = AuthenticationMechanism.Kerberos;
        rri.ProxyAuthentication = AuthenticationMechanism.Negotiate;
        remoteRunspace = RunspaceFactory.CreateRunspace(rri);
        remoteRunspace.Open();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:35:48.197

您可以尝试检查您是否有权访问 SharePoint 数据库，要正确添加管理单元，您需要对 Configuration 数据库具有 ShellAccess 权限，因为我记得和场管理员权限。可能您的脚本无法添加管理单元，因此无法对 SharePoint 对象模型执行任何操作。

# templates - PlayFramework 2.0 - 无法从其他模板调用函数

> ID：13240035
> 
> 赞同：2
> 
> 时间：2012-11-05T20:41:57.210
> 
> 标签：templates, scala, playframework, playframework-2.0

我想将一些辅助函数放在另一个文件中，因为它们会被过度重用。我拿了 Computer-Databse 样本的列表文件：

[https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/views/list.scala.html](https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/views/list.scala.html)

我在 app/views 包下创建了一个名为“listing.scala.html”的新文件，并将@link 函数从原始文件移到其中。这个新文件如下所示：

```
@(currentSortBy: String, currentOrder: String, currentFilter: String)

@****************************************
* Helper generating navigation links    *
****************************************@
@link(newPage:Int, newSortBy:String) = @{

    var sortBy = currentSortBy
    var order = currentOrder

    if(newSortBy != null) {
        sortBy = newSortBy
        if(currentSortBy == newSortBy) {
            if(currentOrder == "asc") {
                order = "desc"
            } else {
                order = "asc"
            }
        } else {
            order = "asc"
        }
    }

    // Generate the link
    routes.Application.listPerfil(newPage, sortBy, order, currentFilter)

} 
```

所以，在我的原始文件中，我用这个替换了@link 调用：

```
<a href="@listing(currentSortBy, currentOrder, currentFilter).link(0, key)">@title</a> 
```

问题是，当我尝试编译时出现此错误：

```
value link is not a member of play.api.templates.Html 
```

但根据文档（http://www.playframework.org/documentation/2.0.4/ScalaTemplateUseCases），它似乎没问题。

有什么猜测吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:28:34.803

Play's templates aren't the best place for placing advanced conditions, most probably you'll get better flexibility by processing it in some controller (or other method) which will return you only required link

ie.:

```
 <a href="@controllers.Application.link(currentSortBy, currentOrder, currentFilter, 0, key)">@title</a> 
```

In your case proposed `link(...)` function of `Application` controller can also return a reverse-route.

Keep in mind that including other templates is best option for repeating blocks of HTML but sometimes it's hard to get specified string (mainly because of not trimmed spaces). As you can see there is also problem with calling nested functions. Most probably you can generate whole `A` tag in the `listing.scala.html` however using it isn't comfortable enough (IMHO).

# ruby-on-rails - 为什么将条目重新保存到数据库后，我的 textarea 不能通过 Ajax 更新？

> ID：13240036
> 
> 赞同：0
> 
> 时间：2012-11-05T20:41:59.500
> 
> 标签：ruby-on-rails, ruby, ajax, ruby-on-rails-3, jquery

我正在`text_area`使用 Ajax 在 Rails 中更新一个简单的内容：

**应用程序.js**：

```
$("#invoice_project_id").change(function() {
    var value=$(this).val();
    $.get('/invoices/get_recipient', {project_id= : value}  function(response) {
        $('#invoice_recipient').val(response);
    })
});​ 
```

**get_recipient.js**：

```
$('#invoice_recipient').val("<%= @recipient.to_s.gsub!(/\n/, '\n') %>"); 
```

**invoices_controller.rb**：

```
def get_recipient
  project = Project.find(params[:project_id])
  @recipient = project.person.address
end 
```

该代码运行良好，并将`recipient`text_area 的值替换为正确的地址，具体取决于在`project`选择菜单中选择的内容。

问题是它只适用`addresses`于数据库中已经存在的。（我正在使用[**Rails Faker gem**](http://faker.rubyforge.org)来填充我的数据库。）当我在我的 Safari 浏览器中手动**重新保存**a时，当我尝试使用上面的代码进行更新时，text_area 将不再通过 Ajax 进行更新。`person``address`

这怎么可能？

我已经使用上面的方法转义了换行符`gsub!`，所以我想不出我还能做什么。

有人可以帮忙吗？

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:19:55.810

好的，原来是地址中的回车导致了问题。

这些回车仅在通过 . 更新浏览器中的地址时创建`textarea`。上面提到的 Faker gem 创建换行符但没有回车。

我只有在控制台上检查我的数据库记录时才看到这一点，因为`\r`在`\n`我查看的其他任何地方都看不到字符。

**所以在我的特殊情况下，我只需要像这样删除模型**中的回车：

```
address.gsub!("\r", "") 
```

我无法在我的任何 javascript 文件中执行此操作。

只是一行简单的代码，但对我来说需要几个**小时**的工作。所以希望其他人会从中受益。

# sql-server-2008 - 如何在存储过程中只返回一个结果集

> ID：13240037
> 
> 赞同：2
> 
> 时间：2012-11-05T20:42:01.657
> 
> 标签：sql-server-2008, tsql

考虑以下存储过程：

```
create procedure [dbo].[MyTest] ( @p_SqlStatement nvarchar(max) )
as
begin

    exec sp_executesql @p_SqlStatement

    if @@ROWCOUNT = 1
    begin
      select 1;
    end
    else if @@ROWCOUNT <> 1
    begin
      select 0;
    end

end 
```

此存储过程当前返回 2 个数据集，一个包含`exec sp_executesql @p_SqlStatement`数据，另一个为 1 或 0。有没有办法抑制第一个数据集？我的意思是，这个存储过程是否有可能只返回 1 或 0 ？

我尝试在 catch 块`RAISERROR( 'MyError', 18, 1 )`之后添加一个权利`exec sp_executesql @p_SqlStatement`，然后在 catch 块中选择其他内容，但第一个结果集总是返回给我的存储过程调用者......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:26:47.847

You can embed the query in an `if exists(`.

```
alter procedure [dbo].[MyTest] ( @p_SqlStatement nvarchar(max) )
as
begin
    set @p_SqlStatement = 'if exists('+@p_SqlStatement+') select 1 else select 0'

    exec sp_executesql @p_SqlStatement
end 
```

There are however some queries where this won't fly.

*   Multiple statements
*   Queries terminated with `;`
*   Queries that uses [CTE's](http://msdn.microsoft.com/en-us/library/ms175972%28v=sql.105%29.aspx)

There might be more but these are the ones I can think of right now.

**Update:**

You could try to use [openrowset](http://msdn.microsoft.com/en-us/library/ms190312.aspx).

```
alter procedure [dbo].[MyTest] ( @p_SqlStatement nvarchar(max) )
as
begin
  declare @S nvarchar(max)
  set @S = 
    'if exists(
              select *
              from openrowset(
                              ''SQLNCLI'',
                              ''Server=localhost;Trusted_Connection=yes;'',
                              '+quotename(@p_SqlStatement, '''')+'
                             ) as T
              )
      select 1
    else
      select 0'

  exec (@S)
end 
```

I have never used this in productions but from the tests I made i looks like it should work with SP's, CTE's and multiple lines.

You have to allow [ad hoc distributed queries](http://msdn.microsoft.com/en-us/library/ms187569.aspx).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T20:53:50.417

您可以尝试 NOCOUNT 语句（[http://msdn.microsoft.com/en-us/library/ms189837.aspx](http://msdn.microsoft.com/en-us/library/ms189837.aspx)）

```
create procedure [dbo].[MyTest] ( @p_SqlStatement nvarchar(max) )
as
begin

SET NOCOUNT ON;

    exec sp_executesql @p_SqlStatement

    if @@ROWCOUNT = 1
    begin
      select 1;
    end
    else if @@ROWCOUNT <> 1
    begin
      select 0;
    end

SET NOCOUNT OFF;

end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T10:50:13.907

试试这个方法：

```
declare @mycount bigint

exec sp_executesql N'select @mycount = count(name) from Page where name like ''P%''', N'@mycount bigint OUTPUT', @mycount OUTPUT

select @mycount 
```

重要的是您的语句 @p_SqlStatement 包含一个计数。

如果不是这种情况，这意味着您想为遇到的任何 SQL 运行此 sp，那么这将无济于事。我认为您不能抑制 sp_executesql 的输出。

编辑：你也可以试试这个：

```
declare @mycount bigint

exec sp_executesql N'SELECT * INTO ##MyTempTable from Page where name like ''P%'''

select count(*) from ##MyTempTable 
drop table ##MyTempTable 
```

这意味着您必须在每个查询中添加以下内容（不知道这是否适用于 sp？）“SELECT * INTO ##MyTempTable FROM” - 这应该不难。

“##temptables”是全局范围的临时表。这意味着它们在 sp_executesql sp 之外也可用。您必须显式删除该表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T13:23:14.683

除了使用建议的 OPENROWSET 之外，我找不到任何其他解决方法。但是，我找到了一种独立于服务器名/实例的方法。我仍然需要重新配置服务器以接受临时分布式查询。这是最终结果：

```
create procedure [dbo].[MyTest] ( @p_SqlStatement nvarchar(max) )
as
begin

    declare @sql nvarchar(max) = N'SELECT * INTO ##TMP FROM OPENROWSET(''SQLOLEDB'',''Server=' + @@SERVERNAME + ';Trusted_Connection=Yes;'',''' + @p_SqlStatement + ''')';
    exec sp_executesql @sql

    if ( select COUNT(1) from ##TMP ) = 1
    begin
      select 1;
    end
    else
    begin
      select 0;
    end

    drop table ##TMP;

end 
```

此解决方案有其局限性：

1.  @p_SqlStatement 中的每一列都必须有一个名称
2.  我必须在我的服务器上启用 Ad Hoc 分布式查询。
3.  我必须与on`@sql`一起使用变量，因为我无法以另一种方式在内部使用变量，因此这会在 an 上生成动态 SQL，这在性能方面非常糟糕。`sp_executesql``OPENROWSET``OPENROWSET``OPENROWSET`

我确实使用以下脚本重新配置服务器：

```
sp_configure 'Ad Hoc Distributed Queries', 1;
RECONFIGURE;
GO 
```

# mongodb - 使用聚合框架使用 MongoDB 进行组计数

> ID：13240039
> 
> 赞同：45
> 
> 时间：2012-11-05T20:42:27.513
> 
> 标签：mongodb, aggregation-framework

假设我的 MongoDB 架构如下所示：

```
{car_id: "...", owner_id: "..."} 
```

这是一个多对多的关系。例如，数据可能如下所示：

```
+-----+----------+--------+
| _id | owner_id | car_id |
+-----+----------+--------+
|   1 |        1 |      1 |
|   2 |        1 |      2 |
|   3 |        1 |      3 |
|   4 |        2 |      1 |
|   5 |        2 |      2 |
|   6 |        3 |      4 |
|   7 |        3 |      5 |
|   8 |        3 |      6 |
|   9 |        3 |      7 |
|  10 |        1 |      1 | <-- not unique
+-----+----------+--------+ 
```

我想得到每个车主拥有的汽车数量。在 SQL 中，这可能看起来像：

```
SELECT owner_id, COUNT(*) AS cars_owned
FROM (SELECT owner_id FROM car_owners GROUP BY owner_id, car_id) AS t
GROUP BY owner_id; 
```

在这种情况下，结果将如下所示：

```
+----------+------------+
| owner_id | cars_owned |
+----------+------------+
|        1 |          3 |
|        2 |          2 |
|        3 |          4 |
+----------+------------+ 
```

如何使用聚合框架使用 MongoDB 完成同样的事情？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-11-05T22:09:56.323

为了适应潜在的重复，您需要使用两个`$group`操作：

```
db.test.aggregate([
    { $group: {
        _id: { owner_id: '$owner_id', car_id: '$car_id' }
    }},
    { $group: {
        _id: '$_id.owner_id',
        cars_owned: { $sum: 1 }
    }},
    { $project: {
        _id: 0,
        owner_id: '$_id',
        cars_owned: 1
    }}]
    , function(err, result){
        console.log(result);
    }
); 
```

给出格式为：

```
[ { cars_owned: 2, owner_id: 10 },
  { cars_owned: 1, owner_id: 11 } ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-23T23:41:22.810

`$group`类似于 SQL Group by command。在下面的示例中，我们将根据公司成立的年份汇总公司。并计算每家公司的平均员工人数。

```
 db.companies.aggregate([{
    $group: {
      _id: {
        founded_year: "$founded_year"
      },
      average_number_of_employees: {
        $avg: "$number_of_employees"
      }
    }
  }, {
    $sort: {
      average_number_of_employees: -1
    }
  }
])
```

![$avg 运算符 MongoDB](../Images/c74a97b3e047a5721ddd553532ea4fb7.png)

此聚合管道有 2 个阶段

1.  `$group`
2.  `$sort`

现在，`$group`舞台的基础是`_id`我们指定为文档一部分的字段。这就是`$group`运算符本身的值，它使用了对代理框架语法的非常严格的解释。`_id`是我们如何定义、如何控制、如何调整小组赛阶段用来组织它看到的文档的方式。

以下查询使用`$sum`运算符查找人员与公司的关系：

```
 db.companies.aggregate([{
  $match: {
    "relationships.person": {
      $ne: null
    }
  }
}, {
  $project: {
    relationships: 1,
    _id: 0
  }
}, {
  $unwind: "$relationships"
}, {
  $group: {
    _id: "$relationships.person",
    count: {
      $sum: 1
    }
  }
}, {
  $sort: {
    count: -1
  }
}])
```

![MongoDB 中的 $sum](../Images/da49234265eb8214e6e982d7636314c2.png)

# android - Android：将数据从 jni 线程传递到 java 程序

> ID：13240040
> 
> 赞同：3
> 
> 时间：2012-11-05T20:42:29.800
> 
> 标签：android, java-native-interface

我正在开发一个 jni-client-software，它应该与服务器通信。我可以建立连接，可以读出我需要的信息并将其返回给我的 java 程序。现在我想无限连接，这意味着连接已经建立，并且应该在无限循环中读取信息（我不想断开连接并重新连接每个 jni 函数调用）。是否可以将字节数组从工作的 jni 踏板传递给我的 java 程序？

非常感谢。

亲切的问候

托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T23:00:50.340

“是否可以将字节数组从工作的 jni 踏板传递给我的 java 程序？”

您可以在其中一个 java 类中创建静态方法，然后使用 jni 代码中的参数调用此方法。这是一些代码：

java端：

```
package com.mysuper.game;
public class MyApp {
    public static void callMeFromJNI(byte[] data) {
        // ...
    }
} 
```

和 c++ 代码在工作线程上运行：

```
JavaVM *vm;
// use vm->AttachCurrentThread(&env, 0); in thread function to get valid JNI interface pointer, on thread end use DetachCurrentThread().
JNIEnv *env;

void myFunc() {

    // some test data to send
    const int len = 32;
    char data[len] = {0,1,2,3,4};

    jclass app = env->FindClass("com/mysuper/game/MyApp");
    jmethodID sendDataToJava = env->GetStaticMethodID(app, "callMeFromJNI", "([B)V");
    jbyteArray bArray = env->NewByteArray(len);
    char *bytes = (char *)env->GetByteArrayElements(bArray, 0);
    memcpy( bytes, data, len);
    env->ReleaseByteArrayElements(bArray, bytes, JNI_ABORT);
    env->CallStaticVoidMethod(app, sendDataToJava, bArray);
} 
```

有关其工作原理的更多信息，请查看：

[Java 原生接口 6.0 规范](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/)

# django - django memcahed 密钥生成

> ID：13240045
> 
> 赞同：0
> 
> 时间：2012-11-05T20:42:58.073
> 
> 标签：django, memcached

默认 django 缓存密钥生成器：

```
def make_key(key, key_prefix, version):
    return ':'.join([key_prefix, str(version), key]) 
```

我想改变：

在 settings.py

```
def make_key(key, key_prefix, version):
    return key

CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',
        'LOCATION': '127.0.0.1:11211',
        'KEY_FUNCTION' : 'settings.make_key',
        }
} 
```

但是 django 使用旧的本机功能生成密钥（前缀版本密钥）如何更改它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T21:26:53.197

尝试：

```
def make_key(key, key_prefix, version):
    return key

CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',
        'LOCATION': '127.0.0.1:11211',
        'KEY_FUNCTION' : make_key
        }
} 
```

我知道在文档中是“包含虚线路径的字符串”，但我在 Django[源代码](https://github.com/django/django/blob/master/django/core/cache/backends/base.py#L28)中看到您也可以传递可调用对象（例如函数）。

如果您确实需要将其作为字符串传递，则应将此函数移至另一个模块并设置`yourproject.module.make_key`为`KEY_FUNCTION`.

# javascript - 使用 jQuery Select2 清除下拉列表

> ID：13240047
> 
> 赞同：57
> 
> 时间：2012-11-05T20:43:02.717
> 
> 标签：javascript, jquery, jquery-select2

[我正在尝试使用出色的Select2](http://ivaynberg.github.com/select2/)库以编程方式清除下拉列表。下拉列表使用 Select2`query`选项动态填充远程 ajax 调用。

HTML：

```
<input id="remote" type="hidden" data-placeholder="Choose Something" /> 
```

Javascript：

```
 var $remote = $('#remote');

        $remote.select2({
            allowClear: true,
            minimumInputLength: 2,
            query: function(options){
                $.ajax({
                    dataType: 'json',
                    url: myURL + options.term,
                    error: function(jqXHR, textStatus, errorThrown){
                        smoke.alert(textStatus + ": server returned error on parsing arguments starting with " + options.term);
                    },
                    success: function(data, textStatus, jqXHR){
                        var results = [];
                        for(var i = 0; i < data.length; ++i){
                            results.push({id: data[i].id, text: data[i].name});
                        }

                        options.callback({results: results, more: false});
                    }
                });
            }
        }); 
```

不幸的是，调用`$remove.select2('val', '')`引发以下异常：

```
 Uncaught Error: cannot call val() if initSelection() is not defined 
```

我尝试设置`attr`、`val`和`text`Select2 特定`data`功能。似乎无法让这个人清楚并以单选按钮的方式工作。有人有建议吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-11-22T20:24:28.667

这对我有用：

```
 $remote.select2('data', {id: null, text: null}) 
```

当您以这种方式清除它时，它也适用于 jQuery 验证。

-- 编辑 2013-04-09

在撰写此回复时，这是唯一的方法。使用最近的补丁，现在可以使用适当且更好的方法。

```
$remote.select2('data', null) 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2015-05-10T09:26:13.533

如果是 Select2 版本 4+

它已经改变了语法，你需要这样写：

```
// clear all option
$('#select_with_blank_data').html('').select2({data: [{id: '', text: ''}]});

// clear and add new option
$("#select_with_data").html('').select2({data: [
 {id: '', text: ''},
 {id: '1', text: 'Facebook'},
 {id: '2', text: 'Youtube'},
 {id: '3', text: 'Instagram'},
 {id: '4', text: 'Pinterest'}]}); 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-02-16T19:16:15.367

这是正确的， select2 将清除所选值并显示占位符 back 。

```
$remote.select2('data', null) 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-11-16T07:19:29.147

对于 select2 版本 4，可以轻松使用：

```
$('#remote').empty(); 
```

使用 ajax 调用填充 select 元素后，您可能需要成功部分中的这行代码来更新内容：

```
 success: function(data, textStatus, jqXHR){
  $('#remote').change();
                } 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-08-20T10:28:55.387

使用 select2 版本 4，您可以使用以下短符号：

```
$('#remote').html('').select2({data: {id:null, text: null}}); 
```

这会在创建时将具有空 id 和文本的 json 数组传递给 select2，但首先`.html('')`会清空先前存储的结果。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-08-05T08:08:28.430

你应该使用这个：

```
 $('#remote').val(null).trigger("change"); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-01-29T15:14:43.813

这解决了我在版本 3.5.2 中的问题。

```
$remote.empty().append(new Option()).trigger('change'); 
```

根据[这个问题](https://github.com/select2/select2/issues/3553)，您需要在选择标签内有一个空选项才能显示占位符。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-06-16T15:33:55.887

建议的方法@Lelio Faieta 对我有用，但因为我使用[引导主题](https://github.com/select2/select2-bootstrap-theme)，它删除了 select2 的所有引导设置。所以我使用了以下代码：

```
$("#remote option").remove(); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-08-17T14:31:10.723

我有点晚了，但这是最新版本（4.0.3）中的工作：

```
$('#select_id').val('').trigger('change'); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-01-22T00:15:07.010

这些都可以帮助我清除下拉列表：

```
.select2('data', null)
.select2('val', null) 
```

但重要说明： value 不会被重置， .val() 将返回第一个选项，即使它没有被选中。我正在使用 Select2 3.5.3

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-12-28T19:32:14.693

对于 Ajax，使用 $(".select2").val("").trigger("change")。那应该可以解决问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-12-21T21:58:21.183

I found the answer (compliments to **user780178**) I was looking for in this other question:

[Reset select2 value and show placeholdler](https://stackoverflow.com/questions/17957040/reset-select2-value-and-show-placeholdler)

```
$("#customers_select").select2("val", ""); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-06-15T12:21:58.810

从 >4.0 开始，为了真正清理 select2，您需要执行以下操作：

```
$remote.select2.val('');
$remote.select2.html('');
selectedValues = []; // if you have some variable where you store the values
$remote.select2.trigger("change"); 
```

请注意，我们根据最初的问题选择 select2。在您的情况下，您很可能会以不同的方式选择 select2 。

希望能帮助到你。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-05-24T10:53:59.677

如果您需要，此代码会删除所有结果以显示新列表：

```
$('#select2Elem').data('select2').$results.children().remove() 
```

比如在省市列表中，当省份发生变化，我们点击城市输入时，仍然会显示旧城市列表，直到加载新列表。

使用我写的代码，你可以在调用ajax之前删除旧列表

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-04-04T11:14:13.060

这就是我的做法：

```
$('#my_input').select2('destroy').val('').select2(); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-04T04:52:19.840

您可以使用这个或进一步参考这个[https://select2.org/programmatic-control/add-select-clear-items](https://select2.org/programmatic-control/add-select-clear-items)

```
$('#mySelect2').val(null).trigger('change'); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-05-19T08:09:57.433

由于它们都没有为我工作（select2 4.0.3）是std select方式。

```
for(var i = selectbox.options.length - 1 ; i >= 0 ; i--)
    selectbox.remove(i); 
```

# deployment - 部署 LocalDb 需要哪些二进制文件？

> ID：13240049
> 
> 赞同：2
> 
> 时间：2012-11-05T20:43:08.367
> 
> 标签：deployment, localdb

许多文章指出 LocalDb 易于安装，有些文章指出不需要 SQL Express 来部署使用 LocalDb 的应用程序。但是，我没有找到说明在安装使用 LocalDb 的应用程序时应包含哪些二进制文件的参考资料。

我是否只需将“\Program Files\Microsoft SQL Server\110\LocalDb\Binn”的内容添加到应用程序文件夹？

有这方面的参考吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:04:43.157

您仍然应该使用 LocalDB MSI 来安装它。只是 LocalDB MSI 非常简单，在受支持的平台上没有先决条件，安装速度快，不问您任何问题。

此外，如果您的应用程序使用 ClickOnce 安装，并且您使用的是 Visual Studio 2012，则只需在部署向导中将 LocalDB 标记为链式依赖项。

否则，您需要确保您的安装程序安装了 LocalDB MSI。

# android - Android 在 TextView 中显示文本

> ID：13240053
> 
> 赞同：0
> 
> 时间：2012-11-05T20:43:19.173
> 
> 标签：android

大家好，

我正在用一个对我来说似乎难以解决的问题（也许是我的无知 x）。

我`TextView`在写的时候有一个字符串，我计算可用空间，如有必要，我将字体大小减小到最小大小设置，然后添加一行并继续写。

问题：

编写按钮 2 和 3 的字符串，显示`TextView`正确填写的行：第一行已完成，字符串的其余部分在第二行。西：

```
56688+(555556565555566
555555

56688x(555556565555566
555555 
```

编写按钮 1 和 4 的字符串时，显示的行`TextView`填充不正确：第一行已填充到“/”或“-”大部分为空，字符后的文本位于第二行。西：

```
 56688/
(555556565555566555555

                56688-
(555556565555566555555 
```

预期的行为是按钮 2 和 3 的字符串的行为。

我不明白为什么它在字符“/”和“-”存在的情况下表现异常，以及如何纠正这种异常。

我附上代码：

在文件“activity_main.xml”中，我有一个自定义组件，我在下面报告：

```
<LinearLayout android:id="@+id/mainLayout" 
android:layout_width="fill_parent"         
android:layout_height="wrap_content" 
androidrientation="vertical"  
android:layout_alignParentTop="true">

<com.example.component.NumTextView
 android:id="@+id/textViewInput"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:focusable="true"
 android:gravity="right"
 android:maxHeight="64dp"
 android:minHeight="64dp"
 app:lines="1"
 app:maxLines="3"
 app:mintextsize="16"
 app:maxtextsize="48"
 androidadding="0dp"
 android:scrollbars="vertical"
 android:singleLine="false" android:text="" />

<View android:layout_width="fill_parent" 
 android:layout_height="1dp"  
 android:background="#000000" /> 
```

在从“TextView”继承的“NumTextView”类中，我有以下代码：

```
private void refitText(String text, int textWidth)
{
 float trySize = 23;
if( textWidth > 0 )
{
int lineCount = this.getLineCount();
this.setLines(lineCount + 1);
this.setVerticalScrollBarEnabled(true);
this.setMovementMethod(ScrollingMovementMethod.get Instance());
this.setTextSize(trySize);
}
}

@Override
protected void onTextChanged(final CharSequence text, final int start, final int before, final int after)
{
refitText( text.toString(), this.getWidth() );
} 
```

最后，在“MainActivity”中，我有以下代码：

```
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);
textInput = (NumTextView) findViewById(R.id.textViewInput);
}

public void onClick1(View v)
{
String stringa ="56688-(555556565555566555555";
textInput.setText(stringa);
}

public void onClick2(View v)
{
String stringa ="56688+(555556565555566555555";
textInput.setText(stringa);
}

public void onClick3(View v)
{
String stringa ="56688x(555556565555566555555";
textInput.setText(stringa);
}

public void onClick4(View v)
{
String stringa ="56688/(555556565555566555555";
textInput.setText(stringa);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:06:41.773

**原因：** 斜线（/）和连字符（-）是*断字符*，所以它自然会在这些点处断行。这就是自动换行的工作方式，通过寻找中断字符并在最后一个适合的中断点插入换行符。

**使固定？** 如果您可以测量行以查看每行可以容纳多少个字符，则可以插入一个[零宽度空格](http://en.wikipedia.org/wiki/Zero-width_space)(U+200B) 以在该位置强制换行。但是，并非所有字体都支持此字符，因此这可能不适用于所有设备。

如果您无法使用 zw-space，或者您一般对自动调整大小感兴趣，则[此问题](https://stackoverflow.com/questions/5033012/auto-scale-textview-text-to-fit-within-bounds)的各种答案可能会对您有所帮助。

# mongodb - 在服务器上查找流星用户

> ID：13240055
> 
> 赞同：7
> 
> 时间：2012-11-05T20:43:33.357
> 
> 标签：mongodb, meteor

由于未找到用户，以下服务器方法引发重复键错误。一个典型的查询是：{services: {facebook: {id: 'XXXX'}}}

```
Meteor.methods
  getUser: (query, data = {}) ->
    user = Meteor.users.findOne(query)
    return user if user?
    user = _.extend(data, query)
    user._id = Meteor.users.insert user
    return user 
```

据我了解，服务器方法可以访问集合中的所有文档，那么为什么找不到用户但由于重复的 facebook id 而插入失败？

这在我的 osx 开发环境中完美运行，但在我的 ubuntu 服务器（捆绑）上失败并使用 NODE_ENV=production 运行。

这是日志输出：

```
data:    { services: { facebook: { id: 'xxxx' } } } (the query provided to getUser)
data:    undefined (the result of findOne)
data:    Exception while invoking method 'getUser' MongoError: E11000 duplicate key error index: thunderstruck.users.$services.facebook.id_1  dup key: { : "xxxx" }
data:        at Db.wrap (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/db.js:1904:11)
data:        at null.<anonymous> (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/collection.js:320:26)
data:        at g (events.js:192:14)
data:        at EventEmitter.emit (events.js:126:20)
data:        at Db._callHandler (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/db.js:1439:25)
data:        at Server.connect.connectionPool.on.server._serverState (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/connection/server.js:425:30)
data:        at MongoReply.parseBody (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/responses/mongo_reply.js:127:5)
data:        at Server.connect.connectionPool.on.server._serverState (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/connection/server.js:384:22)
data:        at EventEmitter.emit (events.js:96:17)
data:        at _connect (/home/jeremy/deploy/thunderstruck/releases/20121105202012/bundle/server/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:136:13) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-09T17:02:29.260

这些是不同的 MongoDB 查询，您肯定想要切换到的点样式。请参阅[Mongo Dot Notation](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29)文档。

```
Meteor.users.find({"services.facebook.id": "foo"}) 
```

将返回具有您正在查找的嵌入属性的任何文档 value `foo`。

```
Meteor.users.find({services: {facebook: {id: "foo"}}}) 
```

仅匹配具有*该*结构的文档。如果嵌入的 facebook 文档有其他字段，它将不匹配。您的生产数据库中的文档可能有更多字段，因此您没有得到匹配。

# javafx - 如何正确制作嵌套的 JavaFX GridPanes 布局？

> ID：13240063
> 
> 赞同：2
> 
> 时间：2012-11-05T20:44:08.190
> 
> 标签：javafx, gridpanel

**上下文：**我正在使用 java1.7.0_07 和 Jython 构建 JavaFX 应用程序。我的应用程序有一个 ScrollPane，其中包含一个 GridPane，该 GridPane 包含可变数量的 GridPane。每次 TreeView 选择更改时，我的应用程序*都会丢弃并重建最里面的 GridPanes 。*

**问题：**当我在 TreeView 中选择某些内容时，最里面的 GridPane 是*巨大的*，将除了第一个最里面的 GridPane 之外的所有内容都推到了 ScrollPane 的可视区域之外。无论如何，ScrollPane 不显示滚动条，给人的印象是只有一个最里面的 GridPane 对象。手动调整包含 ScrollPane '修复' 的窗口的大小！从我添加它们的那一刻起，如何让最里面的 GridPanes 成为那个大小？

当然，我尝试的第一件事是`requestLayout()`从 Jython 解释器调用外部 GridPane，这与调整包含窗口的大小一样有效。这也是我发现最里面的 GridPanes 很大的原因——我调用`getBoundsInParent()`了每个最里面的 GridPanes。

然而，在我的`ChangeListener.changed()`实现中，一切都不同了。调用`requestLayout()`似乎没有任何作用。此外，我每个最里面的 GridPanes 的边界是`[0,0,0,0]`！看起来这里发生了一些异步操作，但我是 JavaFX 的新手，我不知道是什么。

**更新：**越来越近了！每个最里面的 GridPanes 都包含一个`Label`，我正在调用`setWrapText(true)`每个标签。 *如果我没有在标签上启用换行，则布局行为正确！* 如果我调用`setPrefHeight(40)`每个标签，即使启用了文本换行，布局也会正确运行，但我真的不喜欢尝试猜测一个合适的首选高度来分配给我的每个标签的想法。我只希望标签以我“摆动”包含窗口时它们假设的边界开始。但是怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T18:46:10.123

每个最里面的`GridPane`对象都有一个`ColumnConstraints`带有 a`percentWidth`的对象`100`。删除将这个（不必要的）`ColumnConstraints`对象添加到最里面的对象的代码修复了仅在包含的对象设置`GridPane`为时出现的布局错误行为 。`Label``wrapText``true`

# ruby-on-rails - 如何在 Rails 中另一个模型的“显示”页面中部分呈现“编辑”表单

> ID：13240064
> 
> 赞同：8
> 
> 时间：2012-11-05T20:44:13.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想在父对象的“显示”视图中显示“编辑”表单。

我的模型如下所示：一次旅行有很多天，其中有很多活动。Trip 接受 Days 的嵌套属性。Days 接受活动的嵌套属性。

当我在旅行的“显示”视图中时，如何为“活动”呈现部分“编辑”表单？

我知道我需要以某种方式向编辑表单部分指定要编辑的活动 ID，但我不确定如何从“旅行”的“显示”视图传递该信息。

```
 <% @trip.days.each do |day| %>
    <div id="daydiv_<%= day.id %>">
      <b><%= day.summary %></b>
        <%= content_tag_for :ol, day do %>
          <% day.activities.each do |activity| %>
                <li id="activity_<%= activity.id %>"><%= link_to activity.address, edit_activity_path(activity) %></li>
          <% end %>
      <% end %>
    </div>
    <% end %>

<div id="activity_form">
  <%= render :partial => "/activities/form", :activity => @activity  %>
</div> 
```

我的 /activities/form 部分看起来像这样：

```
<%= form_for(@activity) do |f| %>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-10T21:53:13.613

这就是我最终做的事情并且它有效。

在我的“Trip”的 show.html.erb 中。

**显示.html.erb**

```
<div id="activity_form">
<h2>Activities</h2>
</div> 
```

链接到“编辑”一个活动。注意 :remote => true 告诉 Rails 控制器这将是一个 AJAX 请求，以便呈现 edit.js.erb

```
<%= link_to activity.location[0, 20], edit_day_activity_path(day, activity), :class=>"btn btn-info fixedwidthbtn", method: :get, :remote => true 
```

**_form.html.erb**此表单部分位于活动视图目录 (../views/activities/_form.html.erb) 下。

```
<%= form_for([@day, @activity], :remote => true) do |f| %>
<fieldset>
  <%= f.label :title, "Activity" %>
  <%= f.text_field :title, :rows => 1 %> 
</fieldset>
  <div class="actions">
    <%= f.submit %>
  </div>
</form>
   <%= link_to 'Delete', [@day, @activity], method: :delete, data: { confirm: 'Are you sure?' } %>
<% end %> 
```

**edit.js.erb**这是活动视图目录 (../views/activities/edit.js.erb) 下的一个文件。说要抓取 ID 为“activity_form”的 DOM 元素并渲染部分“表单”

```
$("#activity_form").html("<%= escape_javascript(render(:partial => "form"))%>"); 
```

**update.js.erb**在编辑表单上点击更新以呈现活动列表的更新部分后，我包含了这个 javascript。这样我就不必重新加载页面来查看更新。

```
$("#activities_list").html("<%= escape_javascript( render(:partial => "/trips/activities") ) %>"); 
```

**routes.rb**这就是我嵌套路由的方式。仅按照最佳实践进行 1 级。

```
resources :trips do 
  resources :days 
end

resources :days do 
  resources :activities 
end 
```

# python - 图形（pyqtgraph）未在 QML 生成的窗口中绘制

> ID：13240066
> 
> 赞同：3
> 
> 时间：2012-11-05T20:44:26.070
> 
> 标签：python, qt, pyqt, pyside, pyqtgraph

我正在尝试在 qml 生成的窗口内绘制图表。因为我需要将 QML 用于 GUI（客户端要求）。我设法在 QML 中获取图形窗口，但它什么也没画。我不知道我的代码是否正确，请建议，指出我正确的方向。

主要.py：

```
#! /usr/bin/python

import os
import sys
from PySide import QtGui 
from PySide import QtCore
from PySide import QtDeclarative
import numpy as np
import pyqtgraph as pg

class Graph (QtDeclarative.QDeclarativeItem):
    def __init__(self, parent = None):
        QtDeclarative.QDeclarativeItem.__init__(self, parent)

        #----------- self.setFlag(QtGui.QGraphicsItem.ItemHasNoContents, False )

        self.dataPlot = np.cos(np.linspace(0, 5 *np.pi , 1000))

        self.graph = pg.PlotItem()
        self.graph.plot( self.dataPlot, pen=(0,255,0))
        self.graph.showGrid(x=True, y=True)

        self.view = pg.GraphicsView()
        self.view.setCentralItem(self.graph)
        #-------------------------------------- self.setCentralWidget(self.view)

        mProxy = QtGui.QGraphicsProxyWidget(self)
        mProxy.setWidget(self.view)

if __name__ == '__main__':    
    app = QtGui.QApplication(sys.argv)

    QtDeclarative.qmlRegisterType(Graph, 'myPyQtGraph', 1, 0, 'PyQtGraph')

    view = QtDeclarative.QDeclarativeView()    
    view.setSource(QtCore.QUrl('main.qml'))
    view.setResizeMode(QtDeclarative.QDeclarativeView.SizeRootObjectToView)

    rootObject = view.rootObject() 
    view.connect(view.engine() , QtCore.SIGNAL('quit()') ,app.instance( ) , QtCore.SLOT('quit()') )

    view.show()    
    sys.exit(app.exec_()) 
```

main.qml：

```
import QtQuick 1.1
import myPyQtGraph 1.0

Rectangle {
    id : page
    width: 900
    height: 400
    color:  "#343434"

    PyQtGraph {
        id: angleGraphID
        anchors{
            top: parent.top
            left: parent.left
            topMargin: 50
            leftMargin: 50
        }
        width: 800
        height: 300
        //color: "#f5deb3"
    }

    Text {
        id: text_Heading
        anchors{
            top: parent.top
            left: parent.left
            topMargin: 20
            leftMargin: 50
        }
        text: qsTr("PyqtGraph QML Test")
        font.pixelSize: 12
    }
} 
```

这就是我现在得到的： ![在此处输入图像描述](../Images/7093a9c629a48c2d94e47c029e9e237e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T22:13:13.810

我最好的猜测是这个问题与这个错误有关： [http ://srinikom.github.com/pyside-bz-archive/932.html](http://srinikom.github.com/pyside-bz-archive/932.html)

然而，这似乎只是 QML 上下文中的问题，因为 PySide 在 QML 之外可以正常工作。您可以通过注释掉 pyqtgraph/graphicsItems/GraphicsObject.py 中的 'itemChange' 方法来解决此问题。

# eclipse - 压缩打包前的Maven maven-exec-plugin执行

> ID：13240075
> 
> 赞同：1
> 
> 时间：2012-11-05T20:45:10.330
> 
> 标签：eclipse, maven, rcp, tycho, exec-maven-plugin

我正在构建一个 Maven+Tycho Eclipse RCP 应用程序，我想在将产品压缩为 zip 之前以及在二进制文件被压缩以在存储库/二进制文件中分发之前在 OS X 上运行我的 codesign maven-exec-plugin。

所以我认为这一步应该在编译和打包之间，但我很难通过反复试验。它应该绑定到哪个生命周期构建阶段？

我的 maven-exec-plugin 目前看起来像这样（应用程序得到了代码签名，但在 zip 已经创建之后）：

```
 <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <version>1.2.1</version>
                <executions>
                  <execution>
            <id>exec</id>
            <phase>package</phase>
                    <goals>
                      <goal>exec</goal>
                    </goals>
                  </execution>
                </executions>
                <configuration>
                  <executable>codesign</executable>
                  <workingDirectory>/tmp</workingDirectory>
                  <arguments>
                    <argument>-s</argument>
                    <argument>"My Developer ID"</argument>
                    <argument>-vvv</argument>
                    <argument>${project.build.directory}/products/${product-id}/macosx/cocoa/x86/MyApp/MyApp.app"</argument>
                  </arguments>
                </configuration>
              </plugin> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:15:16.610

在执行块中使用准备包生命周期阶段，而不是包生命周期阶段。

# c++ - c++ - #ifdef 宏

> ID：13240081
> 
> 赞同：2
> 
> 时间：2012-11-05T20:45:41.123
> 
> 标签：c++

我可以看到

```
#ifdef <token>
code;
#endif 
```

要包含在内，但我在它包含的任何标题中都找不到它。是否有任何其他机制可以定义令牌？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T20:47:02.153

首先，有些宏是由编译器隐式定义的（例如，`__cplusplus`）。其中一些是标准的，一些是特定于编译器的扩展。有关完整列表，请参阅您的[编译器手册](http://gcc.gnu.org/onlinedocs/cpp/Predefined-Macros.html#Predefined-Macros)。

此外，大多数编译器允许在命令行上定义宏。确切的机制取决于编译器，但通常采用命令行选项`-D`或`/D`命令行选项的形式。例如，参见[`gcc`手册](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Preprocessor-Options.html#Preprocessor-Options)：

> `-D name`
> 
> 将名称预定义为宏，定义为 1。
> 
> `-D name=definition`
> 
> 定义的内容被标记和处理，就好像它们出现在“#define”指令中的第三阶段一样。特别是，定义将被嵌入的换行符截断。如果您从 shell 或类似 shell 的程序调用预处理器，您可能需要使用 shell 的引用语法来保护字符，例如在 shell 语法中有意义的空格。
> 
> 如果您希望在命令行上定义类似函数的宏，请在等号（如果有）之前用括号括住其参数列表。括号对大多数 shell 都有意义，因此您需要引用该选项。使用 sh 和 csh，-D'name(args...)=definition' 有效。

对于 Microsoft Visual C++，请参阅[http://msdn.microsoft.com/en-us/library/hhzbb5c8(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/hhzbb5c8(v=vs.80).aspx)

一些编译器提供了方便的工具来确定特定预处理器宏的定义位置。例如，请参阅[如何知道（在 GCC 中）何时声明了给定的宏/预处理器符号？](https://stackoverflow.com/questions/290952/how-to-know-in-gcc-when-given-macro-preprocessor-symbol-gets-declared)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T20:47:31.170

大多数（全部？）编译器允许使用标志定义值（gcc中的-D），也有一些可能由编译器本身设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T20:46:43.197

是的，当然，可以使用编译器设置预处理器指令。例如，gcc 允许您在命令行中添加指令，您可以在 Visual Studio 的项目设置中指定指令。也想想`__cplusplus`，还是`_LINE_`的`_FILE_`。这些没有在任何地方定义，但它们存在。也`_DEBUG`或`UNICODE`哪些是由 MSVS 环境设置的。

# google-chrome - 为什么 Chrome 每次都对该 SVG 图像提出新请求，但对 PNG 却没有？

> ID：13240082
> 
> 赞同：7
> 
> 时间：2012-11-05T20:45:41.483
> 
> 标签：google-chrome, svg

我有一个应用程序在多个位置显示相同的图像，并且可能会更改图像的 src。

当我指向我之前已经使用过的 PNG 图像时，浏览器不会费心提出新请求，它只是使用已经在缓存中的 PNG 图像。但是，当我指向我以前使用过的 SVG 图像时，浏览器 (Chrome 22) 会发出一个新请求。服务器返回 304（未修改），因此不需要下载新图像，但这仍然需要一些额外的处理。

这可以在这个 jsFiddle 中轻松测试：http: [//jsfiddle.net/jtmuw/1/](http://jsfiddle.net/jtmuw/1/)

```
$('button').click( function() {
  $('#a').attr('src', "myImage.svg");

  $('#b').attr('src', "myImage.png");
}); 
```

​</p>

如果您使用 Chrome（或至少 Chrome v.22.0.1229.94）打开小提琴并打开您的网络选项卡，您将看到两个图像已被请求。如果您随后多次点击“重新加载图像”，您的网络选项卡将显示对 SVG 图像的多个请求，但不会显示对 PNG 图像的进一步请求。

据我所知，服务器正在返回相同的标头，因此我看不出有任何差异的原因。

我在 FF 或 Safari 上没有看到这个，所以这可能是 Chrome 的问题。但是，我仍然觉得我缺少的标头中可能存在一些潜在的差异，而且不仅仅是 Chrome 对 SVG 图像进行了奇怪的处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T19:24:31.200

您也许可以强制 Chrome 缓存文件。w3schools 对此有一个很好的概述，如下所示：[http ://www.w3schools.com/html/html5_app_cache.asp](http://www.w3schools.com/html/html5_app_cache.asp)

本质上，您需要创建一个清单文件（称其为...“myCache.appcache”或其他任何内容）

```
CACHE MANIFEST
/path/to/svg/file.svg 
```

然后在你的html文件中指向这个：

```
<html manifest="myCache.appcache"> 
```

这将告诉 Chrome，即使您无法访问互联网，该文件也应该被缓存并可以访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-30T12:35:56.433

在文档顶部包含 SVG 图像。

```
<html>
<head>
    ...
</head>
<body>
    <img style="display:none" src="cached.svg">
    ....
</body>
<html> 
```

# c# - 如何只分析一个类库？

> ID：13240084
> 
> 赞同：6
> 
> 时间：2012-11-05T20:45:59.283
> 
> 标签：c#, dll, profiling, visual-studio-2012

我想分析一个用 VS2012 编译成 dll 的类库项目的 CPU 使用率。

当我进入分析 - > 启动性能向导时，我可以选择要分析的项目，但它只允许我分析可执行文件，因此我无法分析我的库。

如果我分析我的两个项目（一个是一个非常简单的表单，它运行我的库中的函数并显示一些输出）然后`System.Windows.Forms.Application.Run`占用我 97% 的样本 - 我并不真正关心表单的性能成本，它压倒一切。

如何查看我的 dll 的性能数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-18T06:51:08.627

您需要创建一个单元测试来练习您对分析感兴趣的各种库函数。

然后，您可以在“测试资源管理器”中右键单击测试，然后选择“配置文件测试”。

[![截屏](../Images/381b0dfbc6542ccda30d906e2a5be93d.png)](http://richard.smith-sa.com/2014/02/18/profiling_a_unit_test_in_vs2012.html)

这应该启动所选测试的性能分析会话。我不知道他们为什么把这个非常有用的功能隐藏得这么好！

在 VS2012 中，这个选项可能是灰色的。在这种情况下，您可以通过删除`%localappdata%\Microsoft\VisualStudio\11.0\ComponentModelCache`文件夹并重新启动 Visual Studio 来启用它。（[来源](http://www.hjerpbakk.com/blog/2013/7/11/enable-profile-test-in-visual-studio-2012s-test-explorer-1.html)）

# java - 使用 Ajax 和 JSP 使用 Multiselect 级联下拉菜单

> ID：13240087
> 
> 赞同：1
> 
> 时间：2012-11-05T20:46:13.663
> 
> 标签：java, ajax, jsp, jquery

我将多选下拉值发送到 JSP PAGE。下面是发送多选值的 AJAX 代码。JSP 页包括 SQL 查询以从数据库中读取并在另一个下拉列表中显示其值。下面的代码仅显示基于选择而不是多选的级联下拉值。似乎只有一个值被发送到 apps.jsp，而不是所有值。我尝试了一些更改，但没有成功。以下是我可用的最佳工作代码。根据第一个下拉列表中的多选获得第二个下拉显示值有什么帮助吗？单个下拉菜单适用于以下代码。谢谢你。

```
<select multiple="multiple" name="RequirementFor" id="RequirementFor" onchange="showState(this.value);">

 <option value="1">Test1</option>
    <option value="2">Test2</option>
<option value="3">Test3</option>
<option value="4">Test4</option>
</select>
<div id="plat"><select name="Platform" id="Platform"  multiple="multiple"     onchange='showState2(this.value)'>

    </select></div>
//AJAX Code
var xmlHttp ; 
var xmlHttp;
function showState(str){

if (typeof XMLHttpRequest != "undefined"){
xmlHttp= new XMLHttpRequest();
}
else if (window.ActiveXObject){
xmlHttp= new ActiveXObject("Microsoft.XMLHTTP");
}
if (xmlHttp==null){
alert("Browser does not support XMLHTTP Request");
return;
} 
var url="apps.jsp";
url +="?value=" +str;
xmlHttp.onreadystatechange = stateChange;
xmlHttp.open("GET", url, true);
xmlHttp.send(null);
}

function stateChange(){   
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){   
document.getElementById("plat").innerHTML=xmlHttp.responseText   ;
}
} 
```

下面是来自 JSP 查询（apps.jsp）页面的代码。

```
Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();
Connection con = DriverManager.getConnection("jdbc:sqlserver://localhost", "username", "password"); 
Statement stmt;
ResultSet rs;
String[] funID=  request.getParameterValues("value");  
String conCat = "";
try{
if(funID.length>0)
{
for(int i=0;i<funID.length; i++)
{
    conCat =    funID[i] +" "+ "OR" + " "+ "FU_DEPARTMENT_ID= " + conCat;
} 
conCat = conCat.substring(0, conCat.length() - 22);
}
}
 catch(Exception e)
 {out.println(e);}

 String buffer="<select name='state' multiple='multiple'><option value='-1'>Select</option>";

 try
 {

        String sqlSelect1="Select FU_ID, FU_NAME from UNIT where FU_DEPARTMENT_ID ="+conCat+" ORDER BY FU_NAME ASC";

  stmt = con.createStatement();  
 rs = stmt.executeQuery(sqlSelect1);  
   while(rs.next()){
   buffer=buffer+"<option value='"+rs.getString("FU_ID")+"'>"+rs.getString("FU_NAME")+"</option>";  
   }  
 buffer=buffer+"</select>";  
 response.getWriter().println(buffer); 
 stmt.close();
 rs.close();
 con.close();
 }
 catch(Exception e){
     System.out.println(e);
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:34:20.003

我认为你应该改变你获得多值的方式。有些事情是这样的：

```
 <select multiple="multiple" name="RequirementFor" id="RequirementFor" onchange='getMultiple(this);'>
    <option value="1">Test1</option>
    <option value="2">Test2</option>
    <option value="3">Test3</option>
    <option value="4">Test4</option>
</select>

<script>
    var selected; 
    function getMultiple(ob) { 
        selected = new Array();
        for (var i = 0; i < ob.options.length; i++) {
            if (ob.options[ i ].selected) {
                selected.push(ob.options[ i ].value);
            }
        }
        var str = "";
    for (var i = 0; i < selected.length; i++) {
        str += "&value=" + selected[i];
    }
    console.log(str);

            // --> your ajax code

    }

</script> 
```

# php - 空标签 xml + php + dom

> ID：13240096
> 
> 赞同：-1
> 
> 时间：2012-11-05T20:46:48.670
> 
> 标签：php, xml, dom

如何将标签引用分配给文本？

```
$xml =<<<EOT
<?xml version="1.0"?>
<root>
<section name="Section2">
  <category id="category1_of_section2" name="msn">
  teste
   <arti name="article2">value1</arti>
   <arti name="article3">value2 <sref ref="article6" />value6 <sref ref="article7" />value7</arti>
   <arti name="article4">value3 <sref ref="article8" />value8</arti>
  </category>
  <category id="Category2_of_section2" name="webcare">
    <arti name="param3">value4</arti>
  </category>
</section>
</root>
EOT;

$dom = new DomDocument;
$dom->preserveWhiteSpace = FALSE;
$dom->loadXML($xml);

$params = $dom->getElementsByTagName('section'); // Find Sections 
$k=0;
$numero2=0;
$roomStr3="";
foreach ($params as $param)
{
         echo "Section Attribute :-> ".$params->item($k)->getAttribute('name')."<br>";
         $params2 = $params->item($k)->getElementsByTagName('category');
      $i=0;
        foreach ($params2 as $p) 
        {
            echo "&nbsp;&nbsp;- Category Attribute Name :-> ".$params2->item($i)->getAttribute('name')."<br>";
            $params3 = $params2->item($i)->getElementsByTagName('arti');
                $j=0;

                    foreach ($params3 as $p2)
                    {

                    echo "&nbsp;&nbsp;&nbsp;- Article Attribute Name : ".$params3->item($j)->getAttribute('name')."";
                    echo "&nbsp;&nbsp; Value : ".$params3->item($j)->nodeValue."<br>";

                    var_dump($params3->item($j));
                    $elems3 = $params3->item($j)->getElementsByTagName('sref');

                    $j++;
                    }
        $i++;
      }
$k++;
}
//Print
    Section Attribute :-> Section2
      - Category Attribute Name :-> msn
       - Article Attribute Name : article2   Value : value1
       - Article Attribute Name : article3   Value : value2 value6 value7
       - Article Attribute Name : article4   Value : value3 value8
      - Category Attribute Name :-> webcare
       - Article Attribute Name : param3   Value : value 
```

如何显示参考？

前任：

*   文章属性名称：article3 值：value2 **ref="article6":** value6 **ref="article7":** value7

*   文章属性名称：article4 值：value3 **ref="article8":** value8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:48:57.227

好吧，你需要这个`getAttribute`函数来做到这一点。

您已经使用过它：

```
echo "&nbsp;&nbsp;&nbsp;- Article Attribute Name : ".$params3->item($j)->getAttribute('name').""; 
```

只需对`<sref>`-element 执行相同操作：

```
$elems3 = $params3->item($j)->getElementsByTagName('sref');
$elems3Attribute = $elems3->getAttribute('ref'); 
```

# wordpress - 使用 codeigniter 重建 wordpress 网站

> ID：13240099
> 
> 赞同：1
> 
> 时间：2012-11-05T20:46:54.880
> 
> 标签：wordpress, codeigniter, url, seo, rebuild

我有一个客户端，它有一个使用 WordPress 构建的网站。他们希望扩展站点以添加新功能。对我来说，最好重建网站，这样 WP 就不会被使用。我喜欢使用 codeigniter，但一个问题是我们如何保持 SEO 排名。

WP 中的网址类似于 www.foo.com/test-this-site.html

有没有办法在 Codeigniter 中构建网站但使用该 URL 结构？我基本上需要保持所有当前页面在同一个 url 上工作。

有谁知道 Codeigniter 是否可以做到这一点，以及这会如何影响搜索排名？或者有没有更好的方法来解决这个问题。任何方向都会有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T20:52:46.970

通过使用 Code Igniter 中的[URI Routing](http://codeigniter.com/user_guide/general/routing.html)，您可以以任何您想要的方式自定义您想要的所有链接结构。

您只需要确保您支持所有与 WordPress 相同的链接，就可以了。

# javascript - javascript中的递归

> ID：13240101
> 
> 赞同：1
> 
> 时间：2012-11-05T20:47:01.887
> 
> 标签：javascript

我试图了解递归是如何工作的。下面的代码遍历 HTML 文档的节点。它调用一个函数，依次传递每个节点。有人可以解释一下它是如何分步完成的吗？谢谢。

```
var walk_the_DOM = function walk(node, func) {
    func(node);
    node = node.firstChild;
    while (node) {
        walk(node, func);
        node = node.nextSibling;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:04:03.333

第一条语句是函数定义：

```
var walk_the_DOM = function walk(node, func) {
    ...
}; 
```

这将函数分配给`walk_the_DOM`。这个函数有两个参数：`node`和`func`。`node`是您要处理的节点，`func`也是您要应用的功能`node`。

函数的第一行是`func(node);`. 这实质上意味着您正在对`node`. 例如，如果您`walk_the_DOM`这样调用：

```
walk_the_DOM(root, function(node) {
    console.log(node);
}); 
```

你会打电话

```
function(node) {
    console.log(node);
} 
```

在每个节点上，作为打印出树中每个节点的效果。

下一行`node = node.firstChild;`基本上将 重新分配`node`给它的第一个孩子。您需要这样做的原因是因为您需要查看当前节点的每个子节点。当然，您还需要查看*这些*孩子的孩子，但我们稍后会谈到那部分。

现在我们进入`while`循环。这个`while`循环的条件是 just `while(node)`，这只是意味着只要未定义或未定义，循环就会`node`运行`null`。在我们之前的声明中，我们做到了`node = node.firstChild`。如果当前节点没有子节点怎么办？然后`node.firstChild`将为空，因此我们甚至不会进入循环。我们将退出它并退出函数（*记住这部分；如果当前节点没有子节点，我们将退出函数。这被称为递归函数的**停止条件***）。

现在在`while`循环内部，我们进行递归调用：`walk(node, func);`. 让我们暂时忽略这里发生的事情，然后转到下一行：`node = node.nextSibling;`. 在这里，我们将节点的下一个兄弟节点分配回变量`node`。实际上，我们正在迭代这个节点的兄弟姐妹。现在如果节点没有其他兄弟节点（即父节点只有一个子节点）怎么办？然后`node`将为空，我们将退出循环。

现在让我们回到递归调用`walk(node, func)`。在递归调用中，我们调用函数本身，这意味着函数的行为与本次迭代完全相同。此时您可能会想“但这不意味着这将永远执行吗？”。但它不会！为什么？还记得我前面提到的**停止条件吗？**在某些时候，您将传入一个没有子节点的节点，这意味着递归调用将退出并返回到下一行（`node = node.nextSibling`) 并且执行将正常进行。现在，如果您将 DOM 视为一棵树（它确实如此），这意味着您将尽可能地沿着一个分支向下移动，一旦到达终点，您就会回退一层，并检查以查看如果还有其他兄弟姐妹。如果有，你就尽可能地沿着那个分支走下去。如果没有，您会再退回一级并再次进行检查。这样，您就可以遍历整个 DOM 树。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T20:50:24.697

这段代码的作用是在子树的每个元素上执行`func`函数。

您将一个节点传递给 walk 函数。它获取该节点的所有子节点，并在它们上调用 walk 方法。

每个节点都可以看作是一棵子树，并且`walk`函数的每次调用只解决一个较小的子树解决方案。因为它`walks`实际上并没有做任何事情。

最终`node.firstChild`将是`null`，并且由于`null`与`false`javascript 相比，它不会进入循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:01:32.007

```
// 1\. you define a function
var walk_the_DOM = function walk(node, func) { 

    // 4\. you call your callback
    func(node);
    // func.call(node); // inside func, 'this' will be node

    // 5\. you get the first child
    node = node.firstChild;

    // 6\. as long as 'node' is, so not false, 0, null, undefined or '',
    while (node) {

        // 7\. recurse the function, jumps to step 4 (in a new closure of walk)
        walk(node, func);
        // walk_the_DOM(node, func);

        // 8\. get the next child, going to step 6
        node = node.nextSibling;
    }

    // 9\. no more siblings, current walk returns

}; // 2\. the function is defined, by name 'walk' and in var 'walk_the_DOM'!

// 3\. you call the function once, with an anonymous callback
walk(document, function (currentNode) { });
// walk_the_DOM(document, function (currentNode) { }); 
```

# ruby - 无限枚举器倒带

> ID：13240104
> 
> 赞同：4
> 
> 时间：2012-11-05T20:47:07.973
> 
> 标签：ruby, enumerator

我有一个以下列方式生成枚举器的函数：

```
def create_example_enumerator(starting_value)
  current = starting_value
  e = Enumerator.new do |y|
    loop do
      current += 1
      y << current
    end
  end
end 
```

当前的行为非常简单。

```
> e = create_example_enumerator(0)
#<Enumerator: details>
> e.next
1
> e.next
2
> e.rewind
#<Enumerator: details>
> e.next
3 
```

我想将`e.rewind`枚举器重置回它的起始值。有没有一种很好的方法可以在仍然使用无限枚举器的同时做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T20:58:35.003

这应该有效：

```
n = Enumerator.new do |y|
  number = 1
  loop do
    y.yield number
    number += 1
  end
end

n.next #=> 1
n.next #=> 2
n.next #=> 3
n.rewind
n.next #=> 1 
```

# wsdl - 在 IDL 中从 wsdl 生成代理类

> ID：13240105
> 
> 赞同：0
> 
> 时间：2012-11-05T20:47:10.280
> 
> 标签：wsdl, idl

我想从[IDL](http://en.wikipedia.org/wiki/IDL_%28programming_language%29)的 WSDL 生成代理类/代码。这样我就可以与[SOAP 服务](http://api.echo.nasa.gov/echo/ws/v10/index.html)进行通信。

任何人都知道任何教程或对如何完成它有任何线索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T04:04:19.067

尝试使用 WseWsdl3 - 请参阅[http://msdn.microsoft.com/en-us/library/aa529578.aspx](http://msdn.microsoft.com/en-us/library/aa529578.aspx)。

如果 WseWsdl3.exe 无法创建代理类，还是有办法的。

如果您可以在 IIS 中将您的服务作为常规 ASP.NET Web 应用程序运行，它会创建临时 ASP.NET 文件，其中会为您很好地生成代理类。

您可以在文件夹中找到它：

C:\Windows\Microsoft.NET\Framework\vMAJOR.MINOR.BUILD\Temporary ASP.NET Files\YOUR_WEB_APP。有一些随机名称的子文件夹，转到最近的一个，看起来像“App_WebReferences.XXXX.0.cs”。

# ruby-on-rails-3 - 在 Rails 3 和 4 中实现“添加到收藏夹”

> ID：13240109
> 
> 赞同：30
> 
> 时间：2012-11-05T20:47:23.287
> 
> 标签：ruby-on-rails-3

我正在构建一个应用程序，用户可以在其中创建食谱，查看创建的所有食谱，在会员区查看他们自己的食谱，最后我希望用户将“收藏夹”添加到他们的帐户中。

我是 Rails 的新手，但已经阅读了文档，这是我对后端应该是什么样子的理解。有人可以确认这看起来正确或建议任何错误，如果我做错了什么（可能是这种情况），请提供解释？

所以这是我的代码：

用户模型

```
has_many :recipes
has_many_favorites, :through => :recipes 
```

配方模型

```
belongs_to :user
has_many :ingredients #created seperate db for ingredients
has_many :prepererations #created seperate db for prep steps 
```

最喜欢的模特

```
belongs_to :user
has_many :recipes, :through => :user
#this model has one column for the FK, :user_id 
```

收藏夹控制器

```
def create
  @favrecipes =current_user.favorites.create(params[:user_id])
end 
```

然后我想要一个按钮来发布到数据库，所以我有这个：

```
<%= button_to("Add to Favorites" :action => "create", :controller => "favorites" %> 
```

我想我可能在我的路线中遗漏了一些东西，但我不确定。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-11-05T21:10:43.283

您描述的特定设置混合了几种类型的关联。

### A) 用户和配方

首先，我们有一个 User 模型，然后是一个 Recipe 模型。每个配方属于一个用户，因此我们有一个 User :has_many recipes，Recipe belongs_to :user 关联。这种关系存储在配方的 user_id 字段中。

```
$ rails g model Recipe user_id:integer ...
$ rails g model User ...

class Recipe < ActiveRecord::Base
  belongs_to :user
end

class User < ActiveRecord::Base
  has_many :recipes
end 
```

### B) 最喜欢的食谱

接下来我们需要决定如何实现用户应该能够标记最喜欢的食谱的故事。

这可以通过使用连接模型来完成 - 我们称之为 FavoriteRecipe - 具有列：user_id 和 :recipe_id。我们在这里建立的关联是一个**has_many :through**关联。

```
A User  
  - has_many :favorite_recipes  
  - has_many :favorites, through: :favorite_recipes, source: :recipe

A Recipe
  - has_many :favorite_recipes  
  - has_many :favorited_by, through: :favorite_recipes, source: :user 
      # returns the users that favorite a recipe 
```

添加这个收藏夹 has_many :通过与模型的关联，我们得到最终结果。

```
$ rails g model FavoriteRecipe recipe_id:integer user_id:integer

# Join model connecting user and favorites
class FavoriteRecipe < ActiveRecord::Base
  belongs_to :recipe
  belongs_to :user
end

---

class User < ActiveRecord::Base
  has_many :recipes

  # Favorite recipes of user
  has_many :favorite_recipes # just the 'relationships'
  has_many :favorites, through: :favorite_recipes, source: :recipe # the actual recipes a user favorites
end

class Recipe < ActiveRecord::Base
  belongs_to :user

  # Favorited by users
  has_many :favorite_recipes # just the 'relationships'
  has_many :favorited_by, through: :favorite_recipes, source: :user # the actual users favoriting a recipe
end 
```

### C) 与协会互动

```
##
# Association "A"

# Find recipes the current_user created
current_user.recipes

# Create recipe for current_user
current_user.recipes.create!(...)

# Load user that created a recipe
@recipe = Recipe.find(1)
@recipe.user

##
#  Association "B"

# Find favorites for current_user
current_user.favorites

# Find which users favorite @recipe
@recipe = Recipe.find(1)
@recipe.favorited_by # Retrieves users that have favorited this recipe

# Add an existing recipe to current_user's favorites
@recipe = Recipe.find(1)
current_user.favorites << @recipe

# Remove a recipe from current_user's favorites
@recipe = Recipe.find(1)
current_user.favorites.delete(@recipe)  # (Validate) 
```

### D) 控制器动作

关于如何实现控制器动作和路由，可能有几种方法。我非常喜欢 Ryan Bates 在[Railscast #364](http://railscasts.com/episodes/364-active-record-reputation-system) on ActiveRecord Reputation System 中展示的那个。下面描述的解决方案部分是按照那里的上下投票机制构建的。

在我们的 Routes 文件中，我们在名为 favorite 的食谱上添加了一个成员路由。它应该响应发布请求。这将为我们的视图添加一个 favorite_recipe_path(@recipe) url helper。

```
# config/routes.rb
resources :recipes do
  put :favorite, on: :member
end 
```

在我们的 RecipesController 中，我们现在可以添加相应的收藏动作。在那里，我们需要确定用户想要做什么，喜欢或不喜欢。为此，可以引入一个名为 eg type 的请求参数，稍后我们也必须将其传递给我们的链接助手。

```
class RecipesController < ...

  # Add and remove favorite recipes
  # for current_user
  def favorite
    type = params[:type]
    if type == "favorite"
      current_user.favorites << @recipe
      redirect_to :back, notice: 'You favorited #{@recipe.name}'

    elsif type == "unfavorite"
      current_user.favorites.delete(@recipe)
      redirect_to :back, notice: 'Unfavorited #{@recipe.name}'

    else
      # Type missing, nothing happens
      redirect_to :back, notice: 'Nothing happened.'
    end
  end

end 
```

在您看来，您可以将相应的链接添加到收藏和不收藏的食谱。

```
<% if current_user %>
  <%= link_to "favorite",   favorite_recipe_path(@recipe, type: "favorite"), method: :put %>
  <%= link_to "unfavorite", favorite_recipe_path(@recipe, type: "unfavorite"), method: :put %>
<% end %> 
```

而已。如果用户单击食谱旁边的“收藏夹”链接，则此食谱将添加到 current_user 的收藏夹中。

希望对您有所帮助，有任何问题欢迎提出。

关于关联的[**Rails 指南**](http://guides.rubyonrails.org/association_basics.html)非常全面，在您入门时会为您提供很多帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-23T00:19:53.373

感谢您的指导，托马斯！它工作得很好。

只是想补充一点，为了让您最喜欢的方法正常工作，您需要将文本用双引号而不是单引号括起来，以便字符串插值起作用。

```
redirect_to :back, notice: 'You favorited #{@recipe.name}' 
```

->

```
redirect_to :back, notice: "You favorited #{@recipe.name}" 
```

[https://rubymonk.com/learning/books/1-ruby-primer/chapters/5-strings/lessons/31-string-basics](https://rubymonk.com/learning/books/1-ruby-primer/chapters/5-strings/lessons/31-string-basics)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-11T15:17:15.840

这个线程非常有帮助！

谢谢！

不要忘记在表单标签中包含**= 。**

```
<% if current_user %>
  <%=link_to "favorite",   favorite_recipe_path(@recipe, type: "favorite"), method: :put %>
  <%=link_to "unfavorite", favorite_recipe_path(@recipe, type: "unfavorite"), method: :put %>
<% end %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-30T20:50:40.133

选择的答案非常好，但是我无法发表评论，而且我确实对上述内容有疑问。你怎么能限制用户拥有一个最喜欢的食谱？使用上述答案，用户可以继续按收藏夹，并且将在数据库中创建许多条目...

# codeigniter - CodeIgniter 2 不允许控制器使用多级子文件夹

> ID：13240111
> 
> 赞同：4
> 
> 时间：2012-11-05T20:47:26.177
> 
> 标签：codeigniter

当我阅读[文档](http://ellislab.com/codeigniter/user_guide/general/controllers.html)时，CodeIgniter 中的控制器应该支持多级子文件夹，但据我测试，在第一级文件夹之后无法工作。

举例：

`mysite.dev/`（索引页面，默认控制器 home.php，有效）

`mysite.dev/admin/`（管理部分，在 admin/home.php 中，有效）

`mysite.dev/admin/manage/`（在 admin/manage/home.php 中，不工作）

我想知道为什么以及如何使它在多级子文件夹上工作？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:09:18.600

CI 只允许一个子目录级别。但是，您可以使用路由文件来模拟这种模式，正如@Brendan 所说：

控制器：

```
welcome.php
admin/admin.php
admin/manage.php 
```

路由文件：

```
$route['admin/manage/:any'] = "admin/manage/$1";
$route['admin/admin'] = 'admin/home.php'; 
```

您可以对硬代码进行一些更改以按预期工作：[http ://codeigniter.com/forums/viewthread/190563/](http://codeigniter.com/forums/viewthread/190563/)

# extjs - 获取文本字段的输入

> ID：13240113
> 
> 赞同：4
> 
> 时间：2012-11-05T20:47:43.897
> 
> 标签：extjs, sencha-touch-2, textfield

我在*Sencha Touch 2中有一个**文本字段*和一个按钮。我想在按下按钮时获取*文本字段的输入。*我用 Ext.ComponentQuery 试过，但没有用。有人举个例子怎么做？

 **```
{
    xtype: 'textfield',
    cls: 'inputfields',
    id: 'title',
},
{
    xtype: 'button',
    ui: 'action',
    name: 'textfieldButton',
    handler : function(){
        // what should go here ?
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T17:49:03.830

我的做法是`Ext.getCmp('title').getValue();`

另请参阅文档（[Docs API](http://docs.sencha.com/touch/2-0/#!/api/Ext.field.Text-method-getValue)）。他们真的很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T20:52:36.790

你可以这样做：

```
var value = Ext.ComponentQuery.query('#title')[0].getValue();
// test by writing in console
console.log(value); 
```

**提示 1：**当您使用此框架时，始终打开 Sencha 的[API 参考](http://docs.sencha.com/touch/2-0/#!/api)很有帮助（对于任何其他框架、编程语言等也是如此）。为了速度，我建议下载它。
**提示 2：**在Chrome `Ctrl`++中用于开发者工具；您可以在那里访问控制台。`Shift``I`**

# mysql - MySql 在三个表中的任何一个中查找匹配项？

> ID：13240115
> 
> 赞同：0
> 
> 时间：2012-11-05T20:47:53.680
> 
> 标签：mysql, count

我试图在三个表中的任何一个表中查找 IP 地址的匹配项，但我的查询告诉我我正在查看的列不明确？

```
SELECT COUNT(*) 
FROM `zz_tview`,`zz_tview1`,`zz_tview3` 
WHERE `ipaddress` ="192.168.01.01" 
```

因此，我收到此消息“where 子句中的列 'ipaddress' 不明确”，我将如何首先构造它以使其工作，其次使查询不会太重，因为表有数千行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:49:57.560

听起来你想要这个，但这会产生一个笛卡尔结果，这很可能不是你想要的结果：

```
SELECT COUNT(*) 
FROM `zz_tview`,`zz_tview1`,`zz_tview3` 
WHERE `zz_tview`.`ipaddress` ="192.168.01.01"
  OR `zz_tview1`.`ipaddress` ="192.168.01.01"
  OR `zz_tview3`.`ipaddress` ="192.168.01.01" 
```

您应该真正将其构造为`JOIN`：

```
SELECT COUNT(*) 
FROM `zz_tview` v
INNER JOIN `zz_tview1` v1
    ON v.id = v1.id  --- use the column that would join these values
INNER JOIN `zz_tview3` v3
    ON v.id = v3.id  --- use the column that would join these values
WHERE v.`ipaddress` ="192.168.01.01"
      OR v1.`ipaddress` ="192.168.01.01"
      OR v3.`ipaddress` ="192.168.01.01" 
```

如果您`JOIN`无法使用表格，那么您可以使用类似于以下内容的内容：

```
select sum(total)
from
(
    SELECT count(*) as `total`
    FROM `zz_tview` v
    where v.`ipaddress` ="192.168.01.01"
    union all
    SELECT count(*) as `total`
    FROM `zz_tview1` v1
    where v1.`ipaddress` ="192.168.01.01"
    union all
    SELECT count(*) as `total`
    FROM `zz_tview3` v3
    where v3.`ipaddress` ="192.168.01.01"
) src 
```

# python - 反转ndarray中的任意维度

> ID：13240117
> 
> 赞同：11
> 
> 时间：2012-11-05T20:47:56.923
> 
> 标签：python, multidimensional-array, numpy

我正在使用一个 n 维数组，我想要一种反转编号维度的方法。所以而不是

```
rev = a[:,:,::-1] 
```

我希望能够写作

```
rev = a.reverse(dimension=2) 
```

或类似的东西。我似乎找不到不依赖前一种语法的示例。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-05T20:57:20.203

如果您浏览 numpy (python) 源代码，您会发现他们用来编写在特定轴上操作的函数的技巧是用来`np.swapaxes`将目标轴放在该`axis = 0`位置。然后他们编写对 进行操作的代码，`0-axis`然后他们`np.swapaxes`再次使用将`0-axis`背面置于其原始位置。

你可以在这里这样做：

```
import numpy as np
def rev(a, axis = -1):
    a = np.asarray(a).swapaxes(axis, 0)
    a = a[::-1,...]
    a = a.swapaxes(0, axis)
    return a

a = np.arange(24).reshape(2,3,4)

print(rev(a, axis = 2)) 
```

产量

```
[[[ 3  2  1  0]
  [ 7  6  5  4]
  [11 10  9  8]]

 [[15 14 13 12]
  [19 18 17 16]
  [23 22 21 20]]] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-20T18:00:27.980

事实证明，这可以用 来完成`slice`，在某些情况下它`:`是简写。诀窍是将索引对象构建为切片元组：

```
import numpy as np

def reverse(a, axis=0): 
    idx = [slice(None)]*len(a.shape)
    idx[axis] = slice(None, None, -1)
    return a[idx]

a = np.arange(24).reshape(2,3,4)
print reverse(a, axis=2) 
```

有了`Ellipsis`这个可以折叠成一个单行：

```
a[[slice(None)]*axis + [slice(None, None, -1)] + [Ellipsis]] 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-02-28T19:27:39.603

对于将来遇到此问题的任何人：

Numpy 1.12+ 具有功能[`np.flip(array, dimension)`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.flip.html)，它完全按照要求进行。更好的是，它返回的是数据视图而不是副本，因此它会在恒定时间内发生。

# python - 解析单引号或双引号并允许使用正则表达式转义字符（在 Python 中）

> ID：13240119
> 
> 赞同：5
> 
> 时间：2012-11-05T20:48:02.947
> 
> 标签：python, regex, parsing

我的输入看起来像一个参数列表：

```
input1 = '''
title="My First Blog" author='John Doe'
''' 
```

这些值可以用单引号或双引号括起来，但是也允许转义：

```
input2 = '''
title='John\'s First Blog' author="John Doe"
''' 
```

有没有办法使用正则表达式来提取单引号或双引号以及转义引号的键值对？

使用 python，我可以使用以下正则表达式并处理非转义引号：

```
rex = r"(\w+)\=(?P<quote>['\"])(.*?)(?P=quote)" 
```

那么回报是：

```
import re
re.findall(rex, input1)
[('title', '"', 'My First Blog'), ('author', "'", 'John Doe')] 
```

和

```
import re
re.findall(rex, input2)
[('title', "'", 'John'), ('author', '"', 'John Doe')] 
```

后者不正确。我不知道如何处理转义的引号——假设在 (.*?) 部分。我一直在使用[Python 正则表达式上发布的答案中的解决方案来匹配单引号中的文本，忽略转义引号（和制表符/换行符）](https://stackoverflow.com/questions/5452655/python-regex-to-match-text-in-single-quotes-ignoring-escaped-quotes-and-tabs-n)无济于事。

从技术上讲，我不需要 findall 来返回引号字符——而只是键/值对——但这很容易处理。

任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T22:06:52.443

我认为 Tim 对反向引用的使用使表达式过于复杂，并且（在这里猜测）也使它变慢。标准方法（在 owl book 中使用）是分别匹配单引号和双引号字符串：

```
rx = r'''(?x)
    (\w+) = (
        ' (?: \\. | [^'] )* '
        |
        " (?: \\. | [^"] )* "
        |
        [^'"\s]+
    )
''' 
```

添加一些后处理就可以了：

```
input2 = r'''
title='John\'s First Blog' author="John Doe"
'''

data = {k:v.strip("\"\'").decode('string-escape') for k, v in re.findall(rx, input2)}
print data
# {'author': 'John Doe', 'title': "John's First Blog"} 
```

作为奖励，这也匹配未引用的属性，例如`weight=150`.

添加：这是一种没有正则表达式的更简洁的方法：

```
input2 = r'''
title='John\'s First Blog' author="John Doe"
'''

import shlex

lex = shlex.shlex(input2, posix=True)
lex.escapedquotes = '\"\''
lex.whitespace = ' \n\t='
for token in lex:
    print token

# title
# John's First Blog
# author
# John Doe 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-05T20:57:54.377

**编辑**

我的初始正则表达式解决方案中有一个错误。该错误掩盖了您输入字符串中的错误：`input2`不是您认为的那样：

```
>>> input2 = '''
... title='John\'s First Blog' author="John Doe"
... '''
>>> input2      # See - the apostrophe is not correctly escaped!
'\ntitle=\'John\'s First Blog\' author="John Doe"\n' 
```

您需要制作`input2`一个原始字符串（或使用双反斜杠）：

```
>>> input2 = r'''
... title='John\'s First Blog' author="John Doe"
... '''
>>> input2
'\ntitle=\'John\\\'s First Blog\' author="John Doe"\n' 
```

现在您可以使用正确处理转义引号的正则表达式：

```
>>> rex = re.compile(
    r"""(\w+)# Match an identifier (group 1)
    =        # Match =
    (['"])   # Match an opening quote (group 2)
    (        # Match and capture into group 3:
     (?:     # the following regex:
      \\.    # Either an escaped character
     |       # or
      (?!\2) # (as long as we're not right at the matching quote)
      .      # any other character.
     )*      # Repeat as needed
    )        # End of capturing group
    \2       # Match the corresponding closing quote.""", 
    re.DOTALL | re.VERBOSE)
>>> rex.findall(input2)
[('title', "'", "John\\'s First Blog"), ('author', '"', 'John Doe')] 
```

# c++ - 为 C++ 模拟和洗牌？

> ID：13240123
> 
> 赞同：1
> 
> 时间：2012-11-05T20:48:21.380
> 
> 标签：c++, shuffle

我是 C++ 新手，我需要模拟一副纸牌并能够从纸牌中随机抽出一张牌。但是我的编码有问题：

```
 #include <iostream>
#include <cstdlib> //for rand and srand
#include <cstdio>
using namespace std;

string suit[] = {"Diamonds", "Hearts", "Spades", "Clubs"};
string facevalue[] = {"Two", "Three", "Four","Five", "Six", "Seven", "Eight", "Nine", "Ten", "Jack", "King", "Ace"};

string getcard()
{string card;
int cardvalue = rand()%12;
int cardsuit = rand()%4;
card += facevalue[cardvalue];
card += "of";
card += suit[cardsuit];
return card;
}

int main ()
{int numberofcards = 0;
for (int = 0; i < numberofcards; i++)
{cout << "You drew a" << getcard() << endl;}

} 
```

当我尝试编译时，它说：

```
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
warning C4244: 'argument' : conversion from 'time_t' to 'unsigned int', possible loss of data 
```

我不确定我做错了什么。

另外我不知道如何制作我的程序，所以它只画一次而不是无限次。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T20:49:47.903

你忘了

```
#include <string> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:08:55.567

正如其他答案所说，您需要通过在文件顶部添加“#include”来包含“字符串”库。您也忘记在 for 循环中声明“i”。您的 facevalue 数组缺少“Queen”，添加“Queen”后，您还需要更改生成 cardvalue 的方式，使其为 rand()%13。此外，为了确保您不会两次发同一张牌，您需要跟踪已发过哪些牌，然后在 getcard() 中包含一个检查，该检查将抽取当前牌的一张新牌。已抽牌（您可能需要抽牌多次才能获得未抽牌）。

这是一种快速简单的检查方法（我已经修改并更正了您的代码以显示它，但请记住这不是最好的方法）：

```
#include <iostream>
#include <string>
#include <cstdlib> //for rand and srand
#include <cstdio>
using namespace std;

string suit[] = {"Diamonds", "Hearts", "Spades", "Clubs"};
string facevalue[] = {"Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Jack", "Queen", "King", "Ace"};
int numberOfCardsDrawn = 0;
string drawnCards[52];

string drawCard () {
    string card;
    int cardvalue = rand()%13;
    int cardsuit = rand()%4;
    card += facevalue[cardvalue];
    card += " of ";
    card += suit[cardsuit];
    return card;
}

bool isMyCardAlreadyDrawn (string card) {
    for(int i = 0; i < 52; i++) {
        if(card.compare(drawnCards[i]) == 0) { // if this is true, then both strings are the same
            return true;
        }
    }
    return false; // if the code reaches this point, then the card has not been drawn yet
}

string getCard () {
    string card = drawCard();
    while (isMyCardAlreadyDrawn(card) == true) { // keep drawing until an undrawn card is found
        card = drawCard(); // draw a new card
    }
    drawnCards[numberOfCardsDrawn] = card;
    numberOfCardsDrawn++;
    return card;
}

int main () {
    int numberOfCards = 52;
    for (int i = 0; i < numberOfCards; i++){
        cout << "You drew a " << getCard() << endl;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T20:54:18.467

string 不是 c++ 的内置类型，您需要手动包含库才能使用数据类型*string*。您的编译器无法识别关键字 string，因为您从未包含该库，因此它认为 string 是变量名。该库将包含在：

```
#include <string> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-22T06:42:05.623

```
#include<iostream.h>
#include<conio.h>
#include<stdlib.h>
#include<time.h>
enum Suit{clubs,diamonds,hearts,spades};
const int jack=11;
const int queen=12;
const int king=13;
const int ace=14;
////////////////////////////////////////////////////////////////////////////////
class card
{
private:
int number;
Suit suit;
public:
card()
{}
void set(int n,Suit s)
{suit = s; number =n;}
void display();
};
//------------------------------------------------------------------------------
void card::display()

{
if(number>=2 && number<=10)
cout<<number;
else
switch(number)
{case jack: cout<<"J";break;
case queen: cout<<"Q";break;
case king: cout<<"K";break;
case ace: cout<<"A";break;
}
switch(suit)
{
case clubs:cout<< static_cast<char>(5);break;
case diamonds:cout<< static_cast<char>(4);break;
case hearts:cout<< static_cast<char>(3);break;
case spades:cout<< static_cast<char>(6);break;
}
}
////////////////////////////////////////////////////////////////////////////////
int main()  
{card deck[52];
int j;
cout<<endl;
for (j=0;j<52;j++)
{
int num=(j%13)+2;
Suit su=Suit(j/13);
deck[j].set(num,su);
}
cout<<"\nOrdered Deck: \n";
for(j=0;j<52;j++)
{
deck[j].display();
cout<<" ";
if(!((j+1)%13))
cout<<endl;
}
srand(time(NULL)); 
for(j=0;j<52;j++)
{
int k=rand()%52;
card temp= deck[j];
deck[j]=deck[k];
deck[k]=temp;
}
cout<<"\nShuffled Deck: \n";
for(j=0;j<52;j++)
{
deck[j].display();
cout<<",";
if(!((j+1)%13))
cout<<endl;
}
getch();
return 0;
} 
```

该程序将帮助您洗牌，其余的由您自己完成。

# c# - 为什么在 ajax 调用完成后这个值为零（asp.net mvc 3 和 jQuery）？

> ID：13240128
> 
> 赞同：2
> 
> 时间：2012-11-05T20:48:37.203
> 
> 标签：c#, jquery, ajax, asp.net-mvc-3

这是我的ajax调用：

```
 var totalCost = 0;
    function GetTotalCost(start, end, rID) 
    {
        $.ajax({
            url: '@Url.Action("CalculateTotalcost")',
            type: 'POST',
            data: JSON.stringify({ start:start, end:end, rID:rID}),
            dataType: 'json',
            processdata: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) { totalCost = data; }
//            error: function (xhr, ajaxOptions, thrownError) { $('.datepicker1').datepicker("hide"); },
//            complete: function (x, y) { $('.datepicker1').datepicker("refresh"); }
        });
    } 
```

这是我调用ajax的函数：

```
 $('.datepicker2').datepicker({
            dateFormat: 'dd/mm/yy',
            firstDay: 1,
            yearRange: '2012:2100',
            beforeShowDay: function (date) {
                var day = date.getDate();
                if (day in alreadyTakenDays) {
                    return [false, '', alreadyTakenDays[day]];
                }
                else return [true, 'IsActive'];
            },
            onChangeMonthYear: function (year, month, inst) {
                alreadyTakenDays = {};
                getEvents(month, year);
            },

            onSelect: function (dateText, inst) {
                var end = dateText.substring(0, 2);
                console.log(end);
                var rID = $('#RoomID').val();
                console.log(rID);
                var startingHole = $('#DateOne').val();
                var start = startingHole.substring(0, 2);
                console.log(start);
                GetTotalCost(start, end, rID);

                document.getElementById('TotalCost').value = totalCost.toFixed(2);

            }
        }); 
```

**执行 jQuery 脚本后，totalCount**总是得到0？ 为什么会这样？我该怎么办？我想在 ASP.NET MVC 3 中将 totalCount 指定给 Html.TextBoxFor，这就是我需要 totalCount 的原因。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T20:52:53.433

当您在“TotalCost”文本框中设置值时，ajax 调用是异步的并且尚未完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:00:27.137

你应该有这样的成功函数处理程序来获得正确的总成本值：

```
function GetTotalCost(start, end, rID) 
    {
        $.ajax({
            url: '@Url.Action("CalculateTotalcost")',
            type: 'POST',
            data: JSON.stringify({ start:start, end:end, rID:rID}),
            dataType: 'json',
            processdata: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) { totalCost = data;
                                       document.getElementById('TotalCost').value = totalCost.toFixed(2); 
                                     }
        });
    } 
```

在这样的代码中：

```
GetTotalCost(start, end, rID); 
document.getElementById('TotalCost').value = totalCost.toFixed(2); 
```

第一行导致 ajax 调用，但它不等待响应，第二行立即执行。稍后，服务器响应后，`success`执行回调函数。它将在第二行之后执行。这就是您的总值错误的原因 -`totalCost`在您更新 TotalCost 输入后设置正确的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T20:53:26.860

因为您的帖子是异步的，并且您正在尝试设置一个对页面全局的 js 变量。创建一个设置变量的函数并从回调中调用它，然后您将看到结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T20:53:37.267

那是因为**异步ajax**请求..

在您处理事件时，请求尚未完成。

欢迎来到 AJAX 的精彩世界。

# java - 如何在java中处理击键事件，但传递它以使其具有“自然”效果？

> ID：13240132
> 
> 赞同：1
> 
> 时间：2012-11-05T20:48:53.633
> 
> 标签：java, jtextarea, keystroke

我有这段代码，当用户在 textArea （JTextArea 实例）中并按下“输入”时执行一些操作：

```
textArea.getInputMap().put(
            KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), actionMapKey);
    textArea.getActionMap().put(actionMapKey, new AbstractAction() {

        int numLines, lineStart, lineEnd;
        Element lineElem;
        String lineText;

        @Override
        public void actionPerformed(ActionEvent e) {

                         //all the things to be done when enter is pressed
                    }
    }); 
```

它工作正常，但在处理操作后，textArea 中不会出现换行符。有没有办法传递“输入”键击，以便它实际创建换行符？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:45:09.537

如果我没记错的话，您应该能够在所有自定义操作之后调用您正在重载的超级方法。

# php - 如何使用 Slim 接受所有 REST URI 中的排序和分页参数？

> ID：13240138
> 
> 赞同：3
> 
> 时间：2012-11-05T20:49:17.290
> 
> 标签：php, api, rest, url-routing, slim

我正在使用 Slim PHP 框架为我的应用程序创建一个 RESTful API。我希望所有 URL 都能够接受用于排序和分页的参数。有人能告诉我最好的方法吗？

另外，有人可以为我提供一些适当的 REST URI 吗？（即[http://domain.com/api/category/fruit/?sort=DESC&results=25&page=2](http://domain.com/api/category/fruit/?sort=DESC&results=25&page=2)）

```
<?php

require 'Slim/Slim.php';

$sort = "ASC";
$results = 10;
$page = 1;

$app = new Slim();

$app->get('/wines',  function () use ($app) {
  $sort = $app->request()->params('sort');
  $results = $app->request()->params('results');
  $page = $app->request()->params('page');

  getWines();
});

$app->get('/categories',  function () use ($app) {
  $sort = $app->request()->params('sort');
  $results = $app->request()->params('results');
  $page = $app->request()->params('page');

  getCategories();
});

$app->get('/sub-categories',  function () use ($app) {
  $sort = $app->request()->params('sort');
  $results = $app->request()->params('results');
  $page = $app->request()->params('page');

  getSubCategories();
});

$app->run();

function getWines() {
  $sql = "select * FROM wine ORDER BY name " . $sort . " LIMIT " . $page . " , $results";
  try {
    $db = getConnection();
    $stmt = $db->query($sql);  
    $wines = $stmt->fetchAll(PDO::FETCH_OBJ);
    $db = null;
    echo '{"wine": ' . json_encode($wines) . '}';
  } catch(PDOException $e) {
    echo '{"error":{"text":'. $e->getMessage() .'}}'; 
  }
}

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T16:49:54.193

有很多方法可以解决这个问题，我建议使用[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)，这样你就可以在父类中定义一个共同的行为，并在子类中处理具体的细节。

```
abstract class SortPageHandler {
  public function getUrlHandler($app) 
  {
    $me = $this;
    return function () use ($app, $me) {
      $sort = $app->request()->params('sort');
      $results = $app->request()->params('results');
      $page = $app->request()->params('page');

      $app->response()->write($me->getItems($sort, $results, $page));
    };
  }

  abstract public function getItems($sort, $results, $page);
}

class WineHandler extends SortPageHandler {
  public function getItems($sort, $results, $page) 
  {
    //return wines
  }

}

class CategoryHandler extends SortPageHandler {
  public function getItems($sort, $results, $page) 
  {
    //return categories
  }
}

class SubCategoryHandler extends SortPageHandler {
  public function getItems($sort, $results, $page) 
  {
    //return sub-categories
  }
} 
```

所以父类`SortPageHandler`使用 Slim 所需的功能以及分页和排序来处理公共部分。每种`getItems()`方法都特定于每个实体。通过在 in 中声明此方法`abstract`，`SortPageHandler`我们强制所有子类实现此功能。

现在 Slim 代码看起来很干净：

```
$app = new \Slim\Slim();

$wineHandler = new WineHandler();
$categoryHandler = new CategoryHandler();
$subCategoryHandler = new SubCategoryHandler();

$app->get('/wines', $wineHandler->getUrlHandler($app));
$app->get('/categories', $categoryHandler->getUrlHandler($app));
$app->get('/sub-categories', $subCategoryHandler->getUrlHandler($app));

$app->run(); 
```

与往常一样，您可以进一步重构此代码，但这是为了让您了解如何解决此问题。

# c++ - 在头文件中包含（STL）头文件

> ID：13240141
> 
> 赞同：3
> 
> 时间：2012-11-05T20:49:29.397
> 
> 标签：c++

> **可能重复：**
> [在实现中重新包含标头](https://stackoverflow.com/questions/4416765/reincluding-header-in-implementation)

我想知道的是，通常的做法是不在`using namespace xxx`头文件中使用，以免污染全局命名空间。这是`#includes`怎么回事？

如果我有`foo.h`和`foo.cpp`.:

```
//Foo.h
#ifndef FOO_H_
#define FOO_H_

#include <string>

class Foo
{
  public:
    Foo(std::string * a, std::string * b);
    virtual ~Foo();
};

#endif /* FOO_H_ */

//Foo.cpp
#include <string>
#include <Foo.h>
Foo::Foo(std::string * a, std::string * b)
{
  // TODO Auto-generated constructor stub

}

Foo::~Foo()
{
  // TODO Auto-generated destructor stub
} 
```

我真的需要`#include <string>`在这两个文件中吗？仅将其包含在 .h 或 .cpp 中就足够了吗？（我知道两者都可以，但是什么是可取的？）

* * *

编辑，关于我的问题的更多背景信息。
如果我要在我的头文件中使用某些类（作为变量或方法参数），我会在头文件中转发声明它们，并且只在源文件中包含头文件本身。但这不适用于大多数 STL 库，因为您不能转发声明类模板？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:30:41.933

> ...因为你不能转发声明类模板？

类模板可以前向声明 - 像非模板类：

```
// forward declaration
template <typename T>
class C; 
```

然而，正如@AlexandreC 在评论中所说，因为`std::string`它会非常复杂，因为`std::string`typedef 来自`template <typename,typename,typename> basic_string;`.

如果允许的话，我写它会很复杂。这是不允许的，请参阅：

*   [http://www.gotw.ca/gotw/034.htm](http://www.gotw.ca/gotw/034.htm)
*   [https://stackoverflow.com/a/10290176/1463922](https://stackoverflow.com/a/10290176/1463922)

根据 C++11 标准，17.6.4.2.1：

> 如果 C++ 程序将声明或定义添加到命名空间 std 或命名空间 std 内的命名空间，则 C++ 程序的行为是未定义的，除非另有说明。

所以，别无选择，只能包含`<string>`在`std::string`.

* * *

对于您的主要问题-我会包含在源文件和头文件中，除非我很确定它会始终包含在头文件中并且永远不会被删除...

# actionscript-3 - 在点击处理程序中访问 .name 属性

> ID：13240143
> 
> 赞同：3
> 
> 时间：2012-11-05T20:49:37.587
> 
> 标签：actionscript-3, flash, actionscript, addeventlistener, instances

我正在尝试通过 flash + actionscript 制作一个简单的卡片匹配游戏，并且在分配事件侦听器和名称时遇到了很大的麻烦。我已经准备好所有卡片生成语句，它们都绘制到我的舞台上，但即使我用 newCard.name 分配它们的实例名称，我在跟踪点击时得到的名称始终是每个按钮上的“root1”，我不知道为什么。

```
package  {
import flash.display.MovieClip;
import flash.events.MouseEvent;

public dynamic class cardGameMain extends MovieClip {

    public function cardGameMain() {
        addCards();
    }
    public function addCards() {
        var lastCard:int;
        for (var i = 1; i < 17; i++) {
            var newCard:MovieClip;
            newCard = new cardBackSymbol();
            newCard.name = "card" + i;
            addChild(newCard);
            newCard.addEventListener(MouseEvent.MOUSE_UP, decideCard);
            if (i == 1 || i == 5 || i == 9 || i == 13) {
                newCard.x = 20;
                if (i == 1) {
                    newCard.y = 20;
                }
                else if (i == 5) {
                    newCard.y = 240;
                }
                else if (i == 9) {
                    newCard.y = 460;
                }
                else if (i == 13) {
                    newCard.y = 680;
                }
                lastCard = 20;
            } else if (i > 1 && i < 5) {
                newCard.x = lastCard + 145;
                newCard.y = 20;
                lastCard = lastCard + 145;
            } else if (i > 5 && i < 9) {
                newCard.x = lastCard + 145;
                newCard.y = 240;
                lastCard = lastCard + 145;
            } else if (i > 9 && i < 13) {
                newCard.x = lastCard + 145;
                newCard.y = 460;
                lastCard = lastCard + 145;
            } else {
                newCard.x = lastCard + 145;
                newCard.y = 680;
                lastCard = lastCard + 145;
            }
            trace(newCard.name + " position is " + newCard.x + ", " + newCard.y);
        }
    }

    public function decideCard(e:MouseEvent):void {
        trace(this.name)
    }
} 
```

}

非常感谢您对此事的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:32:19.800

您使用的`this`是引用包含类的关键字，而不是单击的对象。

试试这个：

```
public function decideCard(e:MouseEvent):void {
    trace(DisplayObject(e.currentTarget).name)
} 
```

# c# - c#中的自增字典键

> ID：13240156
> 
> 赞同：-1
> 
> 时间：2012-11-05T20:50:32.907
> 
> 标签：c#, dictionary, thread-safety, auto-increment, pool

我正在尝试在 c# 中创建特定的对象池。我有两种基本方法，getObject 和 putObject 以及一个线程安全集合 - concurrentDictionary（因为需要一些键来识别池中的对象）。

但是当我从字典中删除并返回对象时，我需要重新组织这个集合，并且当我想将新对象放入集合时，我想自动递增键。有什么解决方案可以实现这一目标吗？或者任何其他可以帮助我达到相同效果并可以帮助我创建对象池的集合？（我有两个池，一个用于创建对象，但对象可以包含数据，所以我还有一些“数据池”和“数据”应该是具有一些非常量大小的对象，我需要这个“数据池”解决方案） .

或者，您是否有一些诀窍，如何使用对象制作对象池（内存池）而**不是可以包含不同大小的不同数据**？

一些示例代码

-> Foreach 在那里，因为我想找到“数据对象”大小最接近的匹配，然后，如果有任何合适的对象，我想返回它。如果没有，我创建新的。

```
namespace MPool
{
    public class DataPool<T>
    {
        private ConcurrentDictionary<int,T> _objects;
        private Func<T> _objectGenerator;

        public DataPool(Func<T> objectGenerator)
        {
            if (objectGenerator == null)
                throw new ArgumentNullException("Chyba metoda objectGenerator");
            _objects = new ConcurrentDictionary<int,T>();
            _objectGenerator = objectGenerator;
        }

        public T GetObject(int size)
        {
            int diverse = Int32.MaxValue;
            T item = default(T);
            int key = -1;
            foreach (KeyValuePair<int,T> obj in _objects) {
                if (GetObjectSize(obj.Value) == size) {
                    //item = obj.Value;
                    key = obj.Key;
                    break;
                } else {
                    if (Math.Abs((GetObjectSize(obj.Value) - size)) < diverse) {
                        diverse = Math.Abs((GetObjectSize(obj.Value) - size));
                        if (diverse < (2 * GetObjectSize(obj.Value))) {
                            //item = obj.Value;
                            key = obj.Key;
                        }
                    }
                }
            }
            if (key==-1) {
                return _objectGenerator();
            } else {
                _objects.TryRemove(key, out item);
                return item;
            }
        }

        public void PutObject(T item)
        {
            //_objects.AddOrUpdate
        }

        public void Free()
        {
            while (!_objects.IsEmpty) {
                _objects.Clear();
            }
        }

        private int GetObjectSize(T TestObject)
        {
            BinaryFormatter bf = new BinaryFormatter();
            MemoryStream ms = new MemoryStream();
            byte[] Array;
            bf.Serialize(ms, TestObject);
            Array = ms.ToArray();
            return Array.Length;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:32:02.180

我对发布的代码有一个评论，它与你正在尝试做的事情没有直接关系（因为我仍然有点不确定你想要做什么），但我觉得应该解决这个问题。

在每次循环迭代中，您可能会计算对象的大小 4 次。由于您一次将这些对象添加到您的集合中，我建议您在此类中创建一个帮助类，该类可以存储对象及其大小，并在创建时计算它，然后将这些对象存储在集合中。

```
public DataPool<T>
{
        internal class DataStructHelper<T>
        {
            public T DataObject { get; private set; }
            public int Size { get; private set; }
            public DataStructHelper(T dataObject)
            {
                DataObject = dataObject;
                Size = GetObjectSize(dataObject);
            }

            private int GetObjectSize(T TestObject)
            {
                BinaryFormatter bf = new BinaryFormatter();
                using (MemoryStream ms = new MemoryStream())
                {
                    byte[] Array;
                    bf.Serialize(ms, TestObject);
                    return ms.ToArray().Length;
                }
            }
        }
    }
// Other code here
} 
```

不知道您的课程将如何使用以及您计划使用多少线程等。我会考虑仅使用常规列表并锁定访问权限。您可以按排序顺序存储项目，并使用 BinarySearch 根据大小插入和搜索项目（您需要提供比较功能）。

# jquery - XML Jquery 问题

> ID：13240159
> 
> 赞同：0
> 
> 时间：2012-11-05T20:50:43.680
> 
> 标签：jquery, xml

一切正常，但我在最后一期。我想创建包含 2 列数据的表，现在。我知道我可以轻松地在我的 xml 中设置它而不会出现问题。但是我宁愿在我的 jquery 中而不是在我的 XML 中设置它。这就是我想要做的。使用我当前的 Jquery，它需要项目并将它们放入一个表中移动到下一条记录，然后创建一个新表。现在。我希望一张表在单独的行中包含 2 条记录。有没有一种简单的方法可以在我的 jquery 中而不是在我的 XML 中执行此操作。我再次知道如何在我的 XML 中执行此操作，但我想学习如何在 Jquery 中执行此操作。这是我的脚本。

```
$(document).ready(function() {
    $('.con-mid').animate({
        "opacity": ".8"
    });
    $('.midcontent p').animate({
    opacity: 'toggle'
}, 3000);
    $.get('menu/menu-1a.xml', function(data) {
        $(data).find('main').each(function() {
           var $main = $(this);
            $main.find('menu').each(function() {
            var $menu = $(this);
            var id = $menu.attr('id');
            var head = $menu.find('menuhead').text();

            var html = '<div class="mainmen" id="main_' + id + '">';
            html += '<table class="menus"><th colspan="5"><h1>' + head + '</h1></th>';
            $menu.find('menuitem').each(function() {
                var $menuitem = $(this);
                var name = $menuitem.find('menuname').text();
                var desc = $menuitem.find('menudesc').text();
                var price = $menuitem.find('price').text();
                var desprice = $menuitem.find('price2des').text();
                var price2 = $menuitem.find('price2').text();

                html += '<tr class="menu_item">';
                html += '<td class="h-menu">' + name + '</td>';
                html += '<td class="d-menu">' + desc + '</td>';
                html += '<td class="price">' + price + '</td>';
                html += '<td class="desprice">' + desprice + '</td>';
                html += '<td class="price2">' + price2 + '</td>' + '</tr>';

                });
                $('#menuitem').append($(html));
            });
        });
    });

--XML--
            <?xml version="1.0" encoding="iso-8859-1"?>
              <main>
            <menu id="appet">
            <menuhead>
            Appetizers
            </menuhead>
    <menuitem>
        <menuname>
        Cheese Stick
        </menuname>
        <menudesc>
        (6 Sticks)
        </menudesc>
        <price>
        $7
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
        </menuitem>
        <menuitem>
        <menuname>
        Fried Mushrooms
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $7
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
        </menuitem>
        <menuitem>
        <menuname>
        Fried Calamari
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $9
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
        </menuitem>
        <menuitem>
        <menuname>
        Bruchetta
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $10
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
    </menuitem>
    <menuitem>
        <menuname>
        Shrimp Bruchetta
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $10
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
    </menuitem>
    <menuitem>
        <menuname>
        Garlic Bread
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $3
        </price>
        <price2des>
        With Cheese
        </price2des>
        <price2>
        $4
        </price2>
    </menuitem>

    <menuitem>
        <menuname>
        Soups
        </menuname>
        <menudesc>
        (Minestrone or Pasta Fagioli) Cup
        </menudesc>
        <price>
        $4
        </price>
        <price2des>
        Bowl
        </price2des>
        <price2>
        $6
        </price2>
    </menuitem>

    <menuitem>
        <menuname>
        Zupa de Mussels
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $7
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
    </menuitem>

    <menuitem>
        <menuname>
        Side Meatballs or Sausage or Alfredo Sauce
        </menuname>
        <menudesc>
        </menudesc>
        <price>
        $4
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
    </menuitem>
</menu> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:03:26.577

我想你只是忘了关闭你的桌子和你的 div：

```
html += '</table></div>';
$('#menuitem').append($(html)); 
```

顺便说一句 .append(html) 也应该工作。

[更新]您还缺少一个 tr：

```
html += '<table class="menus"><tr><th colspan="5"><h1>' + head + '</h1></th></tr>'; 
```

# android - 在 Android 中创建游戏重力（续）？

> ID：13240160
> 
> 赞同：3
> 
> 时间：2012-11-05T20:50:46.790
> 
> 标签：android, eclipse, logcat, gravity

编辑：我看了看 LogCat，它说它不能膨胀 com.example.playground。然后我意识到它需要我 com.game.myapp.Playground。在我改变它之后它工作了。

我最近问为什么重力在我的 Android 应用程序（[链接](https://stackoverflow.com/questions/13215917/creating-game-gravity-in-android)）中不起作用，但我仍然遇到问题。我将视图更改为“游乐场”类，但现在它只是强制关闭。我究竟做错了什么？

```
package com.game.myapp;

import android.app.Activity;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.os.Bundle;

public class InGame extends Activity{

Playground v;

private int radius;
    private int xPosition;
    private int yPosition;
    private Paint paint;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Rewrite this, it sucks. Seriously.
        super.onCreate(savedInstanceState);
        v = new Playground(this);
        setContentView(v);
    }

    public InGame(int x, int y, int radius, int color)
    { 
        this.xPosition = x; this.yPosition = y; this.radius = radius;
        paint = new Paint(color);
    }

    void moveBall(int x, int y){
         xPosition = x; yPosition =y;        
    } 

    void onDraw(Canvas canvas){
          canvas.drawCircle(xPosition, yPosition, radius, paint);
    }    
} 
```

游乐场类：

```
package com.game.myapp;

import android.content.Context;
import android.graphics.Canvas;
import android.view.View;

public class Playground extends View{

public static InGame ball;

public Playground(Context context) {
    super(context);
    // TODO Auto-generated constructor stub
} 

   @Override
   public void onDraw(Canvas canvas)
   {
       super.onDraw(canvas);
       if (ball != null ){
           ball.onDraw(canvas);
       }
   }

} 
```

这是 LogCat：

```
11-04 16:36:33.945: D/dalvikvm(13177): newInstance failed: no <init>()

11-04 16:36:33.949: D/AndroidRuntime(13177): Shutting down VM

11-04 16:36:33.949: W/dalvikvm(13177): threadid=1: thread exiting with uncaught exception (group=0x4001e578)

11-04 16:36:33.953: E/AndroidRuntime(13177): FATAL EXCEPTION: main

11-04 16:36:33.953: E/AndroidRuntime(13177): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.game.myapp/com.game.myapp.InGame}: java.lang.InstantiationException: com.game.myapp.InGame

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1573)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.os.Handler.dispatchMessage(Handler.java:99)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.os.Looper.loop(Looper.java:130)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.ActivityThread.main(ActivityThread.java:3687)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at java.lang.reflect.Method.invokeNative(Native Method)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at java.lang.reflect.Method.invoke(Method.java:507)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at dalvik.system.NativeStart.main(Native Method)

11-04 16:36:33.953: E/AndroidRuntime(13177): Caused by: java.lang.InstantiationException: com.game.myapp.InGame

11-04 16:36:33.953: E/AndroidRuntime(13177):    at java.lang.Class.newInstanceImpl(Native Method)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at java.lang.Class.newInstance(Class.java:1409)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)

11-04 16:36:33.953: E/AndroidRuntime(13177):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1565)

11-04 16:36:33.953: E/AndroidRuntime(13177):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:41:26.770

这是完整的代码。我刚刚写了这个并测试了它。有用。我在活动中添加了一个计时器，以每秒将球向右和向下移动 10 个像素。请研究它，从中学习并使其适应您的需求。

球类。

```
package com.example;

import android.graphics.Canvas;
import android.graphics.Paint;

public class Ball{

    private int radius;
    private int xPosition;
    private int yPosition;
    private int color;
    private Paint paint;

    public Ball(int x, int y, int radius, int color)
    {
        this.xPosition = x; this.yPosition = y; this.radius = radius;
        paint = new Paint();
        paint.setColor(color);
    }

    int getX(){return this.xPosition;}
    int getY(){return this.yPosition;}

    void moveBall(int x, int y){
        xPosition = x; yPosition =y;
    }

    void onDraw(Canvas canvas){
        canvas.drawCircle(xPosition, yPosition, radius, paint);
    }

} 
```

游乐场课

```
package com.example;

import android.content.Context;
import android.graphics.Canvas;
import android.util.AttributeSet;
import android.widget.ImageView;

public class Playground extends ImageView {

    private Ball ball;

    public Playground(Context context) {
        this(context,null);
    }

    public Playground(Context context, AttributeSet attrs) {
        this(context, attrs,0);
    }

    public Playground(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public void setBall(Ball ball){
        this.ball = ball;
    }

    @Override
    public void onDraw(Canvas canvas)
    {
        super.onDraw(canvas);
        if (ball != null ){
            ball.onDraw(canvas);
        }
    }

} 
```

活动课

```
package com.example;

import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;

import java.util.Timer;
import java.util.TimerTask;

public class MyActivity extends Activity {
    /**
     * Called when the activity is first created.
     */

    Playground playground;
    Ball ball;
    Timer myTimer;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        playground = (Playground) findViewById(R.id.playground);

        ball = new Ball(100, 100, 20, Color.RED);

        playground.setBall(ball);

        myTimer = new Timer();
        myTimer.schedule(new TimerTask() {
            @Override
            public void run() {
                Update();
            }

        }, 0, 1000);
    }

    private void Update() {
        this.runOnUiThread(moveBall);
    }

    private Runnable moveBall = new Runnable() {
        public void run() {
            ball.moveBall(ball.getX() + 10, ball.getY() + 10);
            playground.invalidate();
        }
    };

} 
```

[编辑] XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">
    <com.example.Playground
            android:id="@+id/playground"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"/>
</LinearLayout> 
```

OOP 的关键点。

球不知道操场或活动。它有一个方法*可能*会被一些要求它在画布上绘制的东西调用，但据它所知，它可能是一个不可见的画布，或者一个按钮的画布，或者一个位图的画布——它不知道或需要知道。这是调用该方法的任何人的工作来担心这一点。

操场对活动或球一无所知。它知道它*可能*有一个 Ball 类的实例，如果有，它应该调用它的 onDraw 方法，但它不知道球是什么或它画了什么。球对此感到担忧。

Activity 不知道 Ball 或 Playground，只知道其中之一，然后调用 Ball move 方法，然后告诉 Playground 重绘自己。

关键是，您可以更改绘图方法、移动方法和其他所有内容，而无需重新编码（一般来说，好的）。例如，您可以更改 Ball 类中的 onDraw 以绘制一个矩形。当然，类的名称现在是一个糟糕的选择，但你明白了......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T20:52:07.110

您的 中没有默认构造函数`InGame` `Activity`，这是 Android 能够实例化它所必需的。

显式构造函数的存在将导致不定义隐式无参数构造函数。您可能需要提供自己的无参数构造函数，将其成员初始化为默认值。

我会删除显式构造函数并将初始化放入`onCreate(Bundle)`方法中。

# symfony - 在控制器中使用什么代替 getRequest()->get(...)

> ID：13240165
> 
> 赞同：8
> 
> 时间：2012-11-05T20:51:11.570
> 
> 标签：symfony

最近我浏览了 symfony2 api 文档，这是我在 Request 的[get](http://api.symfony.com/2.0/Symfony/Component/HttpFoundation/Request.html#method_get)方法的文档中找到的内容：

> 避免在控制器中使用此方法：
> 
> *   慢的
> *   更喜欢从“命名”来源获取

那么`"named" source`我应该使用什么来代替`get`方法呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-05T20:59:27.220

“命名”源将是适当的参数包：

*   `$request->query`对于 GET 参数
*   `$request->attributes`请求属性（从 PATH_INFO 解析）
*   `$request->request`对于 POST 参数

`get`方法简单地遍历所有这些，直到它通过名称找到一个参数。因此它很慢。请参阅[实施](https://github.com/symfony/symfony/blob/53fad04f3e7cdcd37a0a4b0c225c3e8c25078b78/src/Symfony/Component/HttpFoundation/Request.php#L527)。

# php - 无法根据 SQL 输出创建单独的论坛类别

> ID：13240168
> 
> 赞同：0
> 
> 时间：2012-11-05T20:51:18.333
> 
> 标签：php, mysql, forum, webbbs

我面临一些问题，我真的不确定我可能做错了什么。我想做的是创建一个专有论坛，我可以为我的客户和我自己的项目使用。我同意尝试重新发明轮子而不是仅仅将 phpBB 撕开是很愚蠢的，但这也是我学习错误的好方法。

**问题** 问题在于 PHP 脚本循环的类别。例如，我们在 SQL 中有 3 个类别。Cookies、Cakes 和 Coffee 现在我们有 2 个论坛，每个论坛都可以在适当的论坛上说喜欢和不喜欢，它们看起来像这样

**饼干**

*   像
*   不喜欢

**蛋糕**

*   像
*   不喜欢

等等。但是在我的情况下，它看起来像这样：

**饼干**

*   像

**饼干**

*   不喜欢

**代码**Ok 这里是 StackOverflow 人员撕掉 appart 并向我解释我做错了什么或者我可能错过了什么或者我应该做些什么来使其按预期运行的代码。

```
<?php
//create_cat.php
include 'connect.php';
include 'header.php';

$sql = "SELECT
            categories.cat_id,
            categories.cat_name,
            forums.forum_id,
            forums.forum_cat,
            forums.forum_name,
            forums.forum_desc,
            forums.forum_admin,
            COUNT(forums.forum_id) AS forums
        FROM
            categories
        LEFT JOIN
            forums
        ON
            forums.forum_cat = categories.cat_id
        GROUP BY
            forums.forum_name, forums.forum_desc, forums.forum_id
        ORDER BY
            categories.cat_id ASC
        ";

$result = mysql_query($sql);

if(!$result)
{
    echo 'The categories could not be displayed, please try again later.';
}
else
{
    if(mysql_num_rows($result) == 0)
    {
        echo 'No categories defined yet.';
    }
    else
    {
        //prepare the table         
        while($row = mysql_fetch_assoc($result))
        {       

        echo '<table border="1">
              <tr>
                <th>' . $row['cat_name'] . '</th><th></th>
                </tr>';     
            echo '<tr>';

                if ($_SESSION['user_level'] != 9 AND $row['forum_admin'] == 1) { 

                echo "<div style='padding:8px;background-color:#fae7af;'>Sorry but you this is for Admins only.</div><br>";

                } else {

                echo '<td class="leftpart">';
                    echo '<h3><a href="viewforum.php?f=' . $row['forum_id'] . '">' . $row['forum_name'] . '</a></h3>' . $row['forum_desc'];
                echo '</td>';
                echo '<td class="rightpart">';

                //fetch last topic for each cat
                    $topicsql = "SELECT
                                    topic_id,
                                    topic_subject,
                                    topic_date,
                                    topic_cat
                                FROM
                                    topics
                                WHERE
                                    topic_cat = " . $row['forum_id'] . "
                                ORDER BY
                                    topic_date
                                DESC
                                LIMIT
                                    1";

                    $topicsresult = mysql_query($topicsql);

                    if(!$topicsresult)
                    {
                        echo 'Last topic could not be displayed.';
                    }
                    else
                    {
                        if(mysql_num_rows($topicsresult) == 0)
                        {
                            echo 'no topics';
                        }
                        else
                        {
                            while($topicrow = mysql_fetch_array($topicsresult))
                            echo '<a href="viewtopic.php?t=' . $topicrow['topic_id'] . '">' . $topicrow['topic_subject'] . '</a> at ' . date('d-m-Y', strtotime($topicrow['topic_date']));
                        }
                    }
                echo '</td>';

                }

            echo '</tr>';
            echo '</br>';
        }
    }
}

include 'footer.php';
?> 
```

SQL

```
**Category**
cat_id     | int(8) | primary | auto incr
cat_name   | var(255)

|2|Test 2
|3|Test 3
|1|Test 1

**Forum**
forum_id   | int(8) | primary | auto_incr
forum_cat  | int(8) <-- forum cat "category" is just ID of category it belongs to
forum_name | var(255)
forum_desc | var(255)

|1|1|Test|Just a simple forum test
|2|3|More Test | Just a 2nd test forum
|3|1|Bugs|Bugs and related go here 
```

![这就是我所说的循环类别的意思](../Images/e9bf3a007cacc65d56d19e6a4a506e92.png)

就是这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:41:46.707

在我看来，每个类别（饼干、蛋糕等）都有两个论坛（喜欢、不喜欢）。我读对了吗？

如果这是真的，您应该执行 OUTER JOIN 而不是 LEFT JOIN 来生成综合列表，如下所示：

```
 ...
        FROM categories
        JOIN forums
    GROUP BY forums.forum_name, forums.forum_desc, forums.forum_id
    ORDER BY categories.cat_id, forums.forum_id 
```

请注意，ON 子句已消失。这意味着您将获得每个论坛行加入到每个类别行。

另请注意，如果您希望论坛保证在每个类别下以相同的顺序显示，则需要按类别和论坛进行排序。

*如果没有*为每个类别显示所有论坛，而是每个类别都有您的论坛的子集，那么您向我们展示的架构不适合这项工作。论坛和类别表之间存在多对多关系。要完成这项工作，您将需要另一个表，如下所示：

```
 forums_categories
        cat_id int(8) not null
        forum_id int(8) not null
        PRIMARY KEY (cat_id, forum_id) 
```

对于每个允许的论坛和类别组合，此表将需要一行。您的原因变为：

```
 ...
        FROM forums_categories fc
        JOIN categories ON (fc.cat_id = categories.cat_id)
        JOIN forums     ON (fc.forum_id = forums.forum_id)
    GROUP BY forums.forum_name, forums.forum_desc, forums.forum_id
    ORDER BY categories.cat_id, forums.forum_id 
```

希望这可以帮助。

# c# - MVC4 捆绑（基于设备类型）

> ID：13240169
> 
> 赞同：2
> 
> 时间：2012-11-05T20:51:21.350
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, bundling-and-minification

因此，查看 bundleconfig.cs 它应该允许根据设备类型进行捆绑。唯一的问题是因为它在 App_Start 中，它不允许我访问 Request 对象。任何想法如何使基于设备的捆绑成为可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:04:19.220

显然，您无法访问 中的请求`App_Start`，因为此时没有向您的应用发出请求。`BundleConfig.cs`仅声明*可用*的捆绑包，您应该在视图中选择正确的捆绑包。

您可以查看[此 MVC 4 教程](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)中的示例代码：

### BundleMobileConfig.cs

```
public class BundleMobileConfig {
    public static void RegisterBundles(BundleCollection bundles) {
        bundles.Add(new ScriptBundle("~/bundles/jquerymobile").
            Include("~/Scripts/jquery.mobile-{version}.js"));

        bundles.Add(new StyleBundle("~/Content/Mobile/css").
            Include("~/Content/Site.Mobile.css"));

        bundles.Add(new StyleBundle("~/Content/jquerymobile/css").
            Include("~/Content/jquery.mobile-{version}.css"));
    }
} 
```

### _Layout.Mobile.cshtml

```
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title </title>
    <meta name="viewport" content="width=device-width" />

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Styles.Render("~/Content/Mobile/css", "~/Content/jquerymobile/css")    
</head>
<!-- etc --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:03:11.353

为您想要支持的所有设备创建捆绑包`BundleConfig`。然后，在您看来，使用基于从`Request.Browser`.

# mongoose - Mongoose.js 排除不在模式中的属性

> ID：13240170
> 
> 赞同：0
> 
> 时间：2012-11-05T20:51:23.617
> 
> 标签：mongoose

我有猫鼬 Shcema：

Track = new Schema({ title: 'string', 艺术家: 'string' })

在我的数据库集合中，我有 object: { title: 'title1', artist: 'artist1', status: '1' }

状态不在模式中，但仍由 find 方法检索。我认为架构应该能够限制这一点。

是否可以通过 findOne 或 findById 等检索此对象，而无需自动排除状态属性而无需通过 {status: 0} 明确指出它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:20:06.637

您可以通过将`status`字段添加到架构中来做到这一点，但将其选择默认设置为`false`：

```
Track = new Schema({
    title: 'string', 
    artist: 'string', 
    status: { type: String, select: false }
}); 
```

# python - Python 图像库中的模板匹配（图像搜索）功能

> ID：13240176
> 
> 赞同：0
> 
> 时间：2012-11-05T20:51:36.050
> 
> 标签：python, image-processing, numpy, python-imaging-library, template-matching

我遇到了一个问题，我需要在另一个图像（也作为 numpy ndarray 出现）中搜索模式（作为 numpy ndarray 出现）并计算模板匹配（图像中的最小差异位置）。我的问题是......是否有任何内置图像可以在 Python Imaging Library 或 Numpy 中使用，或者任何可以做到这一点的东西，而无需我手动编写函数来做到这一点？？？

谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T20:59:23.783

这可能最好作为逆卷积或相关来完成。Numpy/scipy 有代码可以做到这两点。

编辑：包括一个小例子。

到这里查看 ipython 笔记本文件： [http ://nbviewer.ipython.org/4020770/](http://nbviewer.ipython.org/4020770/)

我做了一点高斯，然后将 scipy.signal.correlate2d 与原始图像和一个小子集一起使用。

您可以看到相关性的最高值以图像子集的拍摄位置为中心。请注意，对于大型内核或图像，此代码可能需要一段时间（因为相关性很昂贵）

# ruby-on-rails - 贝宝即时，链式支付

> ID：13240179
> 
> 赞同：0
> 
> 时间：2012-11-05T20:51:43.553
> 
> 标签：ruby-on-rails, paypal, activemerchant

我有一个使用贝宝的数字商品应用程序。我需要解决以下情况：

买家（德国贝宝账户）购买商品，应用程序本身（德国贝宝账户）应收取费用，另一方（德国贝宝账户）应收取款项。所以我开始使用自适应支付（在 Rails 中我确实使用了 active_paypal_adaptive_payment gem），效果很好。

但只要买家位于美国（我们卖家的贝宝沙盒账户），我就有一个未经验证的支票账户。因此，在接收方接受付款之前，付款一直处于未决状态。

但这不是想要的，因为我只想接受可以立即处理的付款。那么是否可以将贝宝的即时支付与自适应支付结合使用（最好是用于 reils 的 active_merchant gem）？

最好的，菲利普

# prolog - 矩阵作为矩阵行序言的列表

> ID：13240180
> 
> 赞同：0
> 
> 时间：2012-11-05T20:51:49.157
> 
> 标签：prolog, successor-arithmetics

我必须用这样的术语将矩阵表示为矩阵行的列表，并`[[a,b],[c,d]]`用 Peano 表示法表示数字。

我必须获得一行矩阵

`ow(X,N,C)`：C是矩阵X的第N行和矩阵的列

`column(X,N,C)`: C 是矩阵 X 的第 N 列。

也这个 One 分解第一列中的矩阵和矩阵的其余部分（这是完全相同的矩阵，但没有第一列）：

```
first_column(X,C,R): matrix X is formed by a first column C in
                     front of matrix R. 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:50:54.460

Peano 符号简化了递归算法的表达。我假设矩阵索引是基于 0 的，并将向您展示如何获得最简单的任务任务。

```
row([Row|_], 0, Row).
row([_|Rows], succ(N), Row) :- row(Rows, N, Row). 
```

测试（获取*第二*行，索引为 1）：

```
?- row([[a,b], [c,d]], succ(0), R).
R = [c, d] ;
false. 
```

这显示了您将用于回答其他两项任务的基本要素。

# java - PowerMock - IllegalStateException：必须重播 Class XXX 以获得配置的期望

> ID：13240186
> 
> 赞同：2
> 
> 时间：2012-11-05T20:52:19.300
> 
> 标签：java, unit-testing, junit, powermock

```
@PrepareForTest({...,..., XXX.class})
...
@Test
public void testMethodToBeTested(){
    XXX mockInstance = PowerMock.createMock(XXX.class); 
    ...
    PowerMock.expectNew(XXX.class, p1, p2, p3, p4, p5).andReturn(mockInstance);
    mockInstance.methodWithNoReturnVal();
    expect(mockInstance.getSearchVal()).andReturn(1);
    PowerMock.replay(mockInstance);
    Whitebox.invokeMethod(objInstance, "methodToBeTested");

    PowerMock.verify(mockInstance);
} 
```

本质上，我想测试一个私有方法：methodToBeTested()。该方法实例化一个 XXX.class 类型的对象（使用 new 运算符）并将其存储到一个实例变量中；我嘲笑了这个对象。然后，它通过模拟调用 methodWithNoReturnVal()，然后是我配置为返回 1 的 getter 方法。

我收到错误“IllegalStateException：必须重播类 XXX.class 以获得配置的期望。”

任何帮助表示赞赏。我还是 PowerMock 和 EasyMock 的新手；因为我需要使用 expectNew(...) 方法，所以我确保在测试方法中使用所有 PowerMock api。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T17:50:39.593

您需要`PowerMock.replay(XXX.class);`在 Powermock 的方法中有一个拦截对象的构造。见下文。

```
@PrepareForTest({...,..., XXX.class})
...
@Test
public void testMethodToBeTested(){
    XXX mockInstance = PowerMock.createMock(XXX.class); 
    ...
    PowerMock.expectNew(XXX.class, p1, p2, p3, p4, p5).andReturn(mockInstance);
    mockInstance.methodWithNoReturnVal();
    expect(mockInstance.getSearchVal()).andReturn(1);
    PowerMock.replay(mockInstance, XXX.class);
    Whitebox.invokeMethod(objInstance, "methodToBeTested");

    PowerMock.verify(mockInstance);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T20:59:28.527

这可能是 PowerMock 中的一个未解决问题。

查看[http://code.google.com/p/powermock/issues/detail?id=271&q=IllegalStateException](http://code.google.com/p/powermock/issues/detail?id=271&q=IllegalStateException)了解更多详情。

# java - 我的文字没有改变。我不明白为什么

> ID：13240189
> 
> 赞同：2
> 
> 时间：2012-11-05T20:52:35.073
> 
> 标签：java, user-interface

我不明白为什么这个 Java 代码不起作用。这是我正在处理的一个 GUI 项目，我正在尝试通过一些复选框将 JLabel 更改为粗体、斜体等：

```
import java.awt.BorderLayout;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ButtonGroup;
import javax.swing.JCheckBox;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JRadioButton;

public class FontViewer {
static JCheckBox checkBoxBold;
static JCheckBox checkBoxItalic;
static JCheckBox checkBoxCenter;
static JPanel textPanel;
static JLabel textLabel;
static JComboBox fontName;
static JComboBox fontSize;

static ActionListener listener;

public static void main(String[] args) {
    final int FRAME_SIZE_X = 250;
    final int FRAME_SIZE_Y = 400;

    JFrame frame = new JFrame();
    frame.setSize(FRAME_SIZE_X, FRAME_SIZE_Y);

    JPanel face = new JPanel();
    face.setLayout(new GridLayout(2, 1));

    JPanel bottomFace = new JPanel();
    bottomFace.setLayout(new GridLayout(3, 1));

    textPanel = createTextPanel();

    JPanel checkBoxPanel = createCheckBoxPanel();

    JPanel comboPanel = createComboPanel();

    JPanel radioButtonsPanel = createButtonsPanel();

    face.add(textPanel);

    bottomFace.add(checkBoxPanel);
    bottomFace.add(comboPanel);
    bottomFace.add(radioButtonsPanel);

    face.add(bottomFace);

    frame.add(face);

    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

    class FontListener implements ActionListener {
        public void actionPerformed(ActionEvent event) {
            int fontStyle = 0;
            if (checkBoxBold.isSelected())
                fontStyle = fontStyle + Font.BOLD;
            if (checkBoxItalic.isSelected())
                fontStyle = fontStyle + Font.ITALIC;
            if (checkBoxCenter.isSelected())
                textPanel.add(textLabel, BorderLayout.CENTER);

            String textFont = (String) fontName.getSelectedItem();

            int textSize = Integer.parseInt((String) fontSize
                    .getSelectedItem());

            textLabel.setFont(new Font(textFont, fontStyle, textSize));
            textLabel.repaint();
        }
    }

    listener = new FontListener();
}

private static JPanel createTextPanel() {
    textPanel = new JPanel();

    textPanel.setLayout(new BorderLayout());
    textLabel = new JLabel("Java Text");
    textPanel.add(textLabel, BorderLayout.WEST);

    return textPanel;
}

private static JPanel createCheckBoxPanel() {
    JPanel checkBoxPanel = new JPanel();

    checkBoxBold = new JCheckBox("Bold");
    checkBoxItalic = new JCheckBox("Italic");
    checkBoxCenter = new JCheckBox("Center");

    checkBoxBold.addActionListener(listener);
    checkBoxItalic.addActionListener(listener);
    checkBoxCenter.addActionListener(listener);

    checkBoxPanel.add(checkBoxBold);
    checkBoxPanel.add(checkBoxItalic);
    checkBoxPanel.add(checkBoxCenter);

    return checkBoxPanel;
}

private static JPanel createComboPanel() {
    JPanel comboPanel = new JPanel();

    fontName = new JComboBox();
    fontName.addItem("Serif");
    fontName.addItem("Courier");

    fontSize = new JComboBox();
    fontSize.addItem("12");
    fontSize.addItem("24");
    fontSize.addItem("36");

    comboPanel.add(fontName);
    comboPanel.add(fontSize);

    return comboPanel;
}

private static JPanel createButtonsPanel() {
    JPanel radioButtonsPanel = new JPanel();

    JRadioButton redButton = new JRadioButton("Red");
    JRadioButton whiteButton = new JRadioButton("White");
    JRadioButton blueButton = new JRadioButton("Blue");

    ButtonGroup colors = new ButtonGroup();
    colors.add(redButton);
    colors.add(whiteButton);
    colors.add(blueButton);

    radioButtonsPanel.add(redButton);
    radioButtonsPanel.add(whiteButton);
    radioButtonsPanel.add(blueButton);

    return radioButtonsPanel;
} 
```

}

当我按下任何复选框时，JLabel 对象不会改变。非常感谢您的任何帮助，并提前非常感谢您。

注意：到目前为止，我只想知道为什么复选框不起作用。这段代码不完整，我知道这一点。再一次感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:01:50.207

在您将侦听器添加到复选框时，值为`listener`was `null`。 `listener`直到 main 方法的最后才被初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:07:36.703

尝试在创建之前初始化侦听器`JFrame`。它对我有用。当然，`FontListener`类的定义必须相应地放在`listener`声明之前。

```
//...
listener = new FontListener();
JFrame frame = new JFrame();
//... 
```

# .net - Chrome、FireFox、Opera 上的 PowerBuilder .net Web 表单

> ID：13240196
> 
> 赞同：0
> 
> 时间：2012-11-05T20:52:59.880
> 
> 标签：.net, firefox, google-chrome, powerbuilder, datawindow

我正在使用 PowerBuilder 12.5 开发一个 .net Web 表单，我设法在 IE 上工作，但它在 Chrome、FireFox 或 Opera 上不起作用

问题在于下拉数据窗口 * 在 Chrome 中，单击箭头时不显示列表 * 在 FireFox 中，ItemChanged 事件不会触发！

有什么方法或工具可以让 PowerBuilder .net Web Forms 在 Chrome、FireFox、Opera 上运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:40:55.227

正如 Sybase 在[Web 表单 FAQ](http://www.sybase.com/detail?id=1061922)中所述，他们并没有过多关注跨浏览器兼容性：

> 我们正在评估 Firefox 和 Safari 是否支持多浏览器。菜单是使用第三方菜单 web 控件实现的，该控件将菜单项呈现为超链接。

# html - 在画布上绘图之前操作像素

> ID：13240205
> 
> 赞同：1
> 
> 时间：2012-11-05T20:53:26.327
> 
> 标签：html, canvas, alpha

我正在使用以下代码在画布上绘制 base64 图像。我从 PHP 中的查询中获取 base64 字符串。使用 globalAlpha，我可以将整个图像的 alpha 设置为 0。我需要使用表单来操作随机像素的 alpha。所以当我用表单提交 7 时，需要将 7 个随机像素设置为从 alpha 0 到 255。

是否可以操纵此图像的 alpha，然后将其绘制到画布上？原始图像保持机密非常重要。

```
var complex = "<?php echo str_replace("\n", "", $DBimage); ?>";
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");
var image = new Image();
image.src = "data:image/png;base64," + complex;
image.onload= function(){
ctx.drawImage(image, 0, 0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T06:15:40.670

我不确定您的意思是“保密”，但我认为您的意思是：

1.  一次只显示几个像素
2.  使人们无法查看源代码和发现图像（使用一点 JavaScript）

如果这些是唯一的要求（如果它们是要求），那么您必须：

1.  解码服务器上的图像
2.  在服务器上选择一些随机像素并将这些像素的数据（RGB 值）发送到客户端
3.  使用画布显示接收到的那几个像素

这种方法的好处是您根本不需要使用 ImageData。您可以只为收到的每个像素`fillRect`使用一个`fillStyle`RGB 值。

这种方法不太好的地方在于它意味着您必须在服务器上做更多的工作，**但是如果您希望图像对客户端完全隐藏，这是唯一的方法。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:30:33.613

```
<canvas id="rectangle" width="300" height="300" style="border:solid black 1px; </canvas>
​ 
```

javascript

```
var canvas = document.getElementById('rectangle');
//replace this rectangle drawing by your image
if (canvas.getContext) {
    var context = canvas.getContext('2d');

    context.fillStyle = "rgb(150,29,28)";
    context.fillRect(10, 10, 280, 280);
}

var imgd = context.getImageData(0, 0, canvas.width, canvas.height);
var numberOfAlphaPix = 10000; //this is the number of pixel for which you want to change the alpha channel, I let you do the job to retrieve this number as you wish

//fill an array with numbers that we'll pop to get unique random values
var rand = [];

// Loop over each pixel with step of 4 to store only alpha channel in array ( R=0 ,G=1 , B=2, A=3 )
for (var i = 3; i < imgd.data.length; i += 4) {
    rand.push(i);
}

//shuffle the array
for (var i = rand.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var tmp = rand[i];
        rand[i] = rand[j];
        rand[j] = tmp;
}

for (var i = 0; i < numberOfAlphaPix; i++) {
    imgd.data[rand.pop()] = 255; //set alpha channel to 255
}

// Draw the ImageData object at the given (x,y) coordinates.
context.putImageData(imgd, 0, 0);​ 
```

在这里试试[http://jsfiddle.net/LuEzG/5/](http://jsfiddle.net/LuEzG/5/)

# ssrs-2008 - 从 Visual Studio 设置快照选项

> ID：13240218
> 
> 赞同：0
> 
> 时间：2012-11-05T20:54:21.263
> 
> 标签：ssrs-2008, reporting-services, reportingservices-2005

我现在正在处理一个大约 25 多个报告的项目，并且我非常厌倦在报告管理器中设置每个报告的所有缓存/快照/处理选项...是否可以设置处理/快照/缓存选项例如视觉工作室 2010？是否有任何工具可以自动化此过程？

我正在寻找为一系列报告设置这些选项的选项.....有没有人知道任何可能帮助我减轻这项任务的工具/提示/技巧？

感谢您与我一起思考！

亨罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:11:18.700

您可以使用 Reporting Services Web 服务方法，参考：

[http://msdn.microsoft.com/en-us/library/ms152787.aspx](http://msdn.microsoft.com/en-us/library/ms152787.aspx)

例如 SetCacheOptions：

[http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.setcacheoptions.aspx](http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.setcacheoptions.aspx)

我不建议入侵 Reporting Services 数据库。

# winapi - 为客户端证书添加 CA 证书

> ID：13240220
> 
> 赞同：1
> 
> 时间：2012-11-05T20:54:24.723
> 
> 标签：winapi, cryptography, cryptoapi

我正在编写一个服务器应用程序，它使用 CryptoAPI 和 Schannel 来设置与客户端的安全 SSL 连接。服务器要求客户端提交证书进行验证（通过在中设置`ASC_REQ_MUTUAL_AUTH`标志`AcceptSecurityContext`）。

我遇到的问题是某些客户端（即使用 的客户端`javax.net.ssl`）没有传递他们的客户端证书（即使它已被配置为这样做）。我怀疑这是因为用于签署客户端证书的 CA 证书不在握手期间传递给客户端的 CA 列表中。

我尝试对以下内容进行变体以将 CA 证书添加到此列表中：

```
PCERT_CONTEXT caCertContext = ...; /* Imported from a DER formatted file */

HCERTSTORE systemStore = CertOpenStore(
                CERT_STORE_PROV_SYSTEM,
                0,
                0,
                CERT_STORE_OPEN_EXISTING_FLAG |
                    CERT_SYSTEM_STORE_LOCAL_MACHINE,
                L"ROOT");

bool ok = CertAddCertificateContextToStore(
                systemStore,
                caCertContext,
                CERT_STORE_ADD_USE_EXISTING,
                NULL);

if (!ok)
{
    std::cerr << "Could not add certificate to system store!" << std::endl;
} 
```

在上面的例子中`CertAddCertificateContextToStore`总是失败。如果我更改`CERT_SYSTEM_STORE_LOCAL_MACHINE`为，`CERT_SYSTEM_STORE_CURRENT_USER`我会看到一个弹出窗口，要求我确认证书，但即使我接受 CA 证书也不会出现在发送给客户端的列表中。

我还尝试使用临时内存存储（我从[这里](https://stackoverflow.com/questions/1557710/winhttp-how-to-use-a-temporary-certificate-store)获取的东西）扩展系统存储集合，但无济于事。

有人知道解决这个问题的方法吗？理想情况下以编程方式不使用任何 GUI 或外部工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T22:01:01.690

您收到该错误是因为您无权以读写方式访问存储，您只能以读取方式访问它。所以你需要做的是添加 CERT_STORE_READONLY_FLAG 所以它将是：

```
HCERTSTORE systemStore = CertOpenStore(
            CERT_STORE_PROV_SYSTEM,
            0,
            0,
            CERT_STORE_OPEN_EXISTING_FLAG |
                CERT_SYSTEM_STORE_LOCAL_MACHINE | CERT_STORE_READONLY_FLAG ,
            L"ROOT"); 
```

如果您要对商店进行更改而不是只读，这意味着您在运行 C++ 应用程序时将需要管理提升。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-20T10:47:52.760

如果您不想在系统范围内添加它（正如您在评论中提到的），您可以使用[`CERT_SYSTEM_STORE_CURRENT_USER`](https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-certopenstore)标志打开。

```
CertOpenStore(CERT_STORE_PROV_SYSTEM, 0, 0, CERT_STORE_OPEN_EXISTING_FLAG |
              CERT_SYSTEM_STORE_CURRENT_USER, L"MY"); 
```

# jquery - jQuery：向 AJAX 加载的分页添加类

> ID：13240222
> 
> 赞同：0
> 
> 时间：2012-11-05T20:54:42.673
> 
> 标签：jquery, ajax, pagination

```
$(".paginate li").click(function(){
    $(this).attr('class','current');    
    $("#ajax_results").load("test.php?page=" + $(this).attr('rel')).fadeIn();
}); 
```

上面的代码是一个分页脚本。当用户单击分页 <li> 时，AJAX 脚本会根据 rel 值触发请求。我遇到的问题是：

```
$(this).attr('class','current'); 
```

它适用于短暂的一秒钟，然后消失。理想情况下，它将对单击的 <li> 应用一类“当前”并保留。我不确定为什么在应用后立即将其删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T13:54:25.330

我已经解决了自己的问题，并认为我会发布解决方案。在查看代码之后，很明显添加类的问题在于，`$(this)`一旦进行 AJAX 调用，就不再定义该类了。可能有一个更优雅的解决方法，但我所做的如下：

```
$(".paginate li").click(function(){
    var rel = $(this).attr('rel');

    $("#ajax_results").load("/ajax.php?id=" + $(this).attr('rel'), function(response, status, xhr) {
        if (status == "success") {
            $("li[rel="+rel+"]").addClass('current');
        }
    });
}); 
```

我声明`rel`为的值，`$(this).attr('rel')`然后在成功时将`addClass()`函数传递给相关项。完美运行。

# git - 在 bitbucket 上使用 git 部署到 Heroku

> ID：13240227
> 
> 赞同：86
> 
> 时间：2012-11-05T20:55:04.833
> 
> 标签：git, heroku, github, bitbucket, heroku-toolbelt

我想使用 git 在 bitbucket 上托管我的源代码，因为我显然获得了一个免费的私人仓库，并且我想使用来自 bitbucket 的源代码在 heroku 上托管我的应用程序。

我可以使用 github 客户端和 heroku 工具带吗？它会起作用吗？Github 很棒，但我不希望每个人都看到我的代码，而且我不想为私人仓库付费，因为它是一个小项目。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-11-05T23:37:42.187

无论您将代码托管在何处，部署到 Heroku 都应该可以工作，因为 Heroku CLI 为了部署而添加了自己的 git 远程。事实上，您甚至可以`git pull`从 Heroku 中使用，因此从技术上讲，您可以将 Heroku 用作私有 git 存储库（尽管不推荐）。至于使用 GitHub 客户端连接 bitbucket，只需在客户端的设置选项卡中将远程仓库更改为 bitbucket 提供的 URL。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-11-08T22:52:07.747

只是为了增加 zeiv 的回答，谁说它应该有效：我可以确认它确实有效。我们使用 bitbucket 进行 git 托管并部署到 heroku。您似乎无法将您的 bitbucket 存储库添加到您的 heroku 帐户以显示提交历史记录，此功能目前似乎仅限于 github（heroku 的错 ;-)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-02-22T17:01:29.197

Bitbucket 现在支持[Pipelines](https://bitbucket.org/product/features/pipelines)，这应该可以很容易地部署在 Heroku 上。只需遵循本教程：[https ://confluence.atlassian.com/bitbucket/deploy-to-heroku-872013667.html](https://confluence.atlassian.com/bitbucket/deploy-to-heroku-872013667.html)

我`bitbucket-pipelines.yml`只是将主分支推送到 Heroku 看起来像这样：

```
image: node:6
clone:
  depth: full
pipelines:
  branches:
    master:
      - step:
          script:
            - git push -f https://heroku:$HEROKU_API_KEY@git.heroku.com/$HEROKU_APP_NAME.git $BITBUCKET_BRANCH 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-11-07T13:26:58.540

与 Stefan 合作——这非常有效。这是我所做的：

1.  对我的 WP 博客每天重置的方式感到非常沮丧，因为没有 wp-config.php，所以任何导航到[http://blog.example.com的人都会看到设置屏幕。](http://blog.example.com)
2.  登录到 bitbucket.org。
3.  链接了我的 bitbucket 和 github 帐户。
4.  从 github 分叉了我的“wp-blog”存储库，我之前已将其链接到我的 heroku 遥控器。
5.  克隆到这个新的分叉中（“git clone [https://myname@bitbucket.org/myname/wp-blog_config.git](https://myname@bitbucket.org/myname/wp-blog_config.git) ”）。
6.  添加了适当的 wp-config.php。
7.  从这个新的 fork 中添加了我的 heroku 远程（“git remote add heroku git@heroku.com:adjective-noun-1234.git”）
8.  提交并部署到 heroku ("git push heroku master:master")

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-03T07:28:12.343

如果您不想在命令行中工作并一直推送到 heroku 并担心维护 SSH 密钥（如果您在不同的机器上工作，这很烦人），那么请按照本指南了解如何使用 codeship 设置持续集成。它是heroku 上的一个免费插件。

[http://blog.codeship.io/2014/04/29/continuous-deployment-heroku-bitbucket-nodejs.html](http://blog.codeship.io/2014/04/29/continuous-deployment-heroku-bitbucket-nodejs.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-08-12T11:31:46.673

我发现这个[页面](https://dashboard.heroku.com/apps/places-view/deploy/heroku-git "页")很有帮助

安装[Heroku 工具带](https://toolbelt.heroku.com/)

如果您还没有，请登录您的 Heroku 帐户并按照提示创建新的 SSH 公钥。

```
$ heroku login 
```

创建一个新的 Git 存储库

在新目录或现有目录中初始化 git 存储库

```
$ cd my-project/
$ git init
$ heroku git:remote -a PROJECTNAME 
```

部署您的应用程序

将代码提交到存储库并使用 Git 将其部署到 Heroku。

```
$ git add .
$ git commit -am "make it better"
$ git push heroku master 
```

现有的 Git 存储库

对于现有存储库，只需添加 heroku 远程

```
$ heroku git:remote -a PROJECTNAME 
```

# c++ - Valgrind 在定义 char* 数组时报告内存泄漏

> ID：13240230
> 
> 赞同：1
> 
> 时间：2012-11-05T20:55:51.357
> 
> 标签：c++, arrays, memory, memory-leaks, valgrind

我还有另一个我似乎无法弄清楚的 valgrind 错误。我有一些加载脚本的代码，然后使用 strtok() 来标记已加载到缓冲区中的所述脚本中的数据。我使用以下方法在堆上为缓冲区分配内存：

```
char *pPngStr = new char[4096]; 
```

然后在函数结束时，我使用以下方法释放内存：

```
delete[] pPngStr; 
```

Valgrind 报告分配如下：

```
173 bytes in 1 blocks are definitely lost in loss record 3,753 of 4,627 
```

Valgrind 还将我释放内存的行报告为：

```
Invalid free() / delete / delete[] / realloc() 
```

这都在同一个函数中，变量只对那个函数而不是类是本地的。我不知道 valgrind 如何认为这是内存泄漏。我正在分配我需要的所有内存，然后在完成后释放它。我不明白问题是什么。

这是完整的功能（可能有点乱）：

```
void CSprite::LoadSprite()
{
FILE *pF = fopen("Data/Art/coin/coin.sprite", "rb");

if(!pF)
{
    return;
}

fseek(pF, 0, SEEK_END);
int length = ftell(pF);
fseek(pF, 0, SEEK_SET);

char *aData = new char[length];

fread(aData, 1, length, pF);

CheckGLError();

/**
  * The scripts are setup like so:
  ***********************************************
  * Pngs:
  * 4; // This is the number of frames.
  * <pngname>_001.png;
  * <pngname>_002.png;
  * <pngname>_003.png;
  * <pngname>_004.png;
  *
  * Properties:
  * name=<obj name>;
  * width=###;
  * height=###;
  * framerate=0.### // rate in seconds
  ************************************************
  */

mpSprite = new SGfxSprite;

char *pPngStr = new char[4096];
pPngStr = strtok(aData, "\n");

pPngStr = strtok(NULL, "\n");
int iNumFrames = atoi(pPngStr);
mpSprite->numFrames = iNumFrames;

mpSprite->textures = new GLuint[iNumFrames];
glGenTextures(iNumFrames, mpSprite->textures);

int i = 0; // used for loop only!
while(pPngStr != NULL)
{
    pPngStr = strtok(NULL, "\n");

    if(!strcmp(pPngStr, "Properties:") || i >= iNumFrames)
    {
        break;
    }

    if(mpPng->LoadPng(pPngStr))
    {
        CheckGLError();

        glBindTexture(GL_TEXTURE_2D, mpSprite->textures[i]);
        CheckGLError();

        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
        CheckGLError();

        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
        CheckGLError();

        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP);
        CheckGLError();

        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP);
        CheckGLError();

        glTexParameteri(GL_TEXTURE_2D, GL_GENERATE_MIPMAP, GL_TRUE);
        CheckGLError();

        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, mpPng->miWidth, mpPng->miHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, mpPng->mpData);
        CheckGLError();
    }

    ++i;
}

pPngStr = strtok(NULL, "=\n");
pPngStr = strtok(NULL, "\n");
mpSprite->name = pPngStr;

pPngStr = strtok(NULL, "=\n");
pPngStr = strtok(NULL, "\n");
mpSprite->width = atoi(pPngStr);

pPngStr = strtok(NULL, "=\n");
pPngStr = strtok(NULL, "\n");
mpSprite->height = atoi(pPngStr);

pPngStr = strtok(NULL, "=\n");
pPngStr = strtok(NULL, "\n");
mpSprite->framerate = (atof(pPngStr) * 1000);

mpSprite->x = 0;
mpSprite->y = 0;

mpSprite->currentFrame = 0;
mpSprite->paintTimer = 0;

fclose(pF);

delete[] pPngStr, aData; 
```

}

*请注意：此函数包含 OpenGL 代码，还从此处未定义的数据结构中调用成员。该代码还在使用 Qt Creator 2.4.1 的带有 g++ (gcc 4.6) 的 Xubuntu 12.04 中编译，没有任何警告或错误

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-05T20:59:16.223

```
char *pPngStr = new char[4096];
pPngStr = strtok(aData, "\n"); 
```

就在 new 之后的行中，你忘记了你去的指针并使用变量来存储其他数据。毫无疑问，存在内存泄漏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-05T20:58:27.423

您拥有的行：

> > ```
> > delete[] pPngStr, aData; 
> > ```

不做你认为它做的事。

试试这个：

```
delete[] pPngStr;
delete[] aData; 
```

**注意**：在您修复 SJuan76 识别的错误之前，我的回答是没有实际意义的。

# php - 即使用户离开页面也执行 php 脚本

> ID：13240235
> 
> 赞同：0
> 
> 时间：2012-11-05T20:56:21.560
> 
> 标签：php, background-process

我想运行一个 php 脚本，该脚本在用户指定的时间内从其他站点（类似于爬虫）收集数据。前任。如果用户选择爬取 5 分钟，即使用户离开页面，php 也会启动并运行 5 分钟。然后他回来，可以看到结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:59:57.597

ignore_user_abort — 设置客户端断开连接是否应该中止脚本执行

[http://php.net/manual/en/function.ignore-user-abort.php](http://php.net/manual/en/function.ignore-user-abort.php)

还有更多的事情需要考虑，比如脚本执行超时。一种更“企业化”的方法是将工作卸载到作业或消息队列中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:43:05.267

我认为您应该查看 crontab /cronjob （如果您使用 linux 网络服务器）。

然后，您可以创建一个关于应该抓取什么以及为谁抓取的数据库。

如果您没有登录系统，您应该将抓取结果链接到来自用户浏览器的会话或 cookie。

创建脚本和数据库后，您可以使用 SSH/Telnet 中的以下命令使收集数据的 php 脚本每分钟运行一次：

```
* * * * * php /path/to/script.php
```

如果您无法访问 SSH/Telnet shell，大多数控制面板都有 crontab 功能。

# javascript - 使用 JQuery 根据窗口大小调整容器大小

> ID：13240238
> 
> 赞同：4
> 
> 时间：2012-11-05T20:56:33.933
> 
> 标签：javascript, jquery

我正在尝试根据窗口的尺寸调整容器 div 的大小。高度与宽度的比例是这里最重要的方面，我想在给定比例的任何方向（高度或宽度）上最大化容器的大小。我已经尝试了一些不成功的事情，这是最近的：

```
$(window).load(function() {
    var h = $(window).height();
    var w = $(window).width();

    If((h/w)>0.61){
        $('#container').css({'height': h, 'width':h*1.64}); }
        else{ $('#container').css({'height': w/1.64, 'width':w}); }
}) 
```

我需要更改什么来调整窗口大小？有没有更好的方法来解决这个问题？

提前感谢您的任何帮助。我对 javascript/JQuery 一点也不熟悉，也找不到任何有用的信息……这件事让我发疯了……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:04:24.470

您想捕获调整大小事件，因此假设您当前的代码符合您的喜好

```
$(document).ready(function() {
    $(window).resize(function() {
        var h = $(window).height();
        var w = $(window).width();

        if((h/w)>0.61) {
            $('#container').css({'height': h, 'width':h*1.64});
        }
        else { 
            $('#container').css({'height': w/1.64, 'width':w});
        }
    });

}); 
```

让我们避免 if 上的大写 I

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:01:58.110

我通常使用这个：

```
function resize () {
var w = $(window);
var containerWrap = $('#container-wrap');
containerWrap.css({ width:w.width(), height:w.height()}); 
```

}

我不确定这是否回答了您的比率问题。

编辑：

这可能更有帮助：

```
$(document).ready(function () {
var missionWrap = $('#mission-wrap');
var w = $(window);
w.on('load resize',function() {
    missionWrap.css({ width:w.width(), height:w.height()});
}); 
```

});

# java - 循环方法

> ID：13240240
> 
> 赞同：2
> 
> 时间：2012-11-05T20:56:42.510
> 
> 标签：java, loops, while-loop, calculator

我试图编写一个通过相同方法的循环方法。应该循环的次数取决于用户输入的字符串的长度。例如，如果字符串是 1+2-3/4*3+2。该程序应该存储前 3 个数字和前 2 个运算符。然后执行操作顺序，对于这个，它将是 1+2-3 = 3-3。然后它应该从字符串中获取下一个运算符和下一个数字。这是我到目前为止的循环，它没有循环整个字符串并用新的数字和运算符更新它

```
public static double solveExpresion(String e) {
    double answer = 0;

    for (int i = 0; i < e.length(); i++) {
        String operand1;
        String operand2;
        String operand3;

        operand1 = getOperand(e);
        o1 = Double.parseDouble(operand1);

        operator1 = getOperator(expression);

        operand2 = getOperand(expression);
        o2 = Double.parseDouble(operand2);

        operator2 = getOperator(expression);

        operand3 = getOperand(expression);
        o3 = Double.parseDouble(operand3);

        answer = orderOfOperation(operator1, operator2);

    /*  operator2 = getOperator(expression);

        operand3 = getOperand(expression);
        o3 = Double.parseDouble(operand3);

        answer = orderOfOperation(operator1, operator2);*/
    }

    return (answer);
} 
```

注意：我不允许使用任何类型的数组。

这些是我的 getOperand 和 getOperator 方法

```
public static String getOperand(String s) {
    s = s.trim();
    String num = "";

    while (s.length() > 0 && s.charAt(0) >= '0' && s.charAt(0) <= '9') {

        num = num + s.charAt(0);
        s = s.substring(1);

    }
    expression = s;

    return (num);
}

public static char getOperator(String s) {

    char r = 0;

    if (s.length() > 0) {

        r = s.charAt(0);
        s = s.substring(1);

    }

    expression = s;
    return (r);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:08:45.007

你的逻辑不完整。这是我将如何解决您的问题的大纲（伪代码）：

```
double answer = getOperand(e);
while (not at end) {
    String operator = getOperator(e);
    double operand2 = getOperand(e);
    answer = orderOfOperation(answer, operator, operand2);
}
return answer; 
```

`answer`这会随着下一个运算符/操作数不断更新。您想要这样做的原因是，在您评估了表达式的一部分（例如“1+2”）之后，字符串中的下一个内容（如果有的话）是一个运算符和下一个操作数。没有要读取的左操作数；相反，您应该使用到目前为止的答案。

另请注意，要使循环正常工作，第一个操作数必须已被使用（并分配给`answer`）。

请注意，您当前的测试`(not at end)`假设每个运算符和操作数都是一个字符长。当其中一个操作数大于 9 时，这不会很好地工作。

# c# - 如何在存储库模式中处理对象上下文

> ID：13240242
> 
> 赞同：0
> 
> 时间：2012-11-05T20:56:48.817
> 
> 标签：c#, asp.net, .net, entity-framework-4

我为我的应用程序 dat 实现了一个存储库模式。

我有 ：

```
public class EFRepository<T>
{
    DbContext // My db context

    public IQureable<T> GetQuery()
    {
        DataContext.CreateQuery(...);
    }
} 
```

现在假设我有用户存储库：

公共类 UserRepository : EFRepository { public UserGetUserDetails(int userId) { GetQuery().Where(u=>u.Id = userId).First(); } }

`DbContext`我的问题是当我在派生存储库中使用 EF 存储库时如何发布。可以说 : `UserRepository: EFRepository`，它使用`GetQuery`然后我必须处理上下文。

任何好主意如何在通用存储库中进行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T07:16:07.433

你应该考虑你有什么[工作单元](http://blogs.msdn.com/b/adonet/archive/2009/06/16/using-repository-and-unit-of-work-patterns-with-entity-framework-4-0.aspx)。（互联网上有许多其他教程）。这个想法是保持*相同*的dbcontext 并在同一工作单元中重复使用它。这样，实体将在需要时已经附加到上下文等。

现在，这是一个 Web 应用程序，在这种情况下，您的工作单元将是一个请求。在同一个请求中，重用您的 DBContext。有很多方法可以做到这一点，而且就在我的脑海中——你会想要像“OnActionExecuting”这样的东西来处理你的上下文。

但更好的是使用控制反转模式（有很多框架使用它，我主要使用[NInject](http://www.ninject.org/)。这将在需要时自动创建某个类的新实例，具体取决于您建议的范围 -在这种情况下是“onRequestScope”。关于 IoC 的内容还有很多，但不是问题的范围

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:54:56.517

我过去使用过类似的模式，在我的情况下，我实际上继承自`DbContext`，它本身实现了`IDisposable`. 如果您`EFRepository`在一个块中使用或从它派生的类，`using`您应该没问题。

如果您更喜欢`DbContext`成员变量，则`EFRepository`需要实现`IDisposable`并`DbContext.Dispose()`从其`Dispose`方法调用。

# sql-server-2008 - 如何处理与 SSAS 多维数据集中的退化/事实维度相关的场景？

> ID：13240245
> 
> 赞同：0
> 
> 时间：2012-11-05T20:57:00.747
> 
> 标签：sql-server-2008, ssis, ssas, data-warehouse, degenerate-dimension

我有一个要发布的 SQL Server 2008 SSIS/SSAS 数据仓库多维数据集，在这个多维数据集中我有以下内容：

```
Dimensions
----------
Company
Product
Sales Person
Shipped Date (time dimension)

Facts
-----  
Total Income
Total Revenue 
Gross 
```

对于上述内容，我为维度/事实数据引用设置了主 (PK) / 代理 (SK) 键。

我还想包括诸如`Order Number`或`Transaction Number`在我看来适合事实表的内容，因为每条记录的订单号都不同。如果我要创建一个订单号维度，它没有多大意义，因为我将拥有与事实一样多的订单号。

现在，当我加载我的事实数据时，我在维度上进行了多次查找以获取代理键，然后我传入事实数据并在我加载我的事实数据**时还**包括这些订单号和交易号`varchar`列，但它们无法使用因为它们不是你可以聚合的东西，所以它们不会出现在我的 SSAS 中，只有数字数据类型的列用于事实表（总收入、总收入等）。

我可以做些什么来让使用 Cube 进行过滤的任何人都可以使用这些内容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T00:17:50.617

发票编号是退化维度的完美候选者。它可以包含在您的事实表中，但不链接到任何维度。这些数字在分析中没有用，除非您想深入调查并需要将记录追溯到源系统，并且它们没有任何合理的“维度”。Kimball 称它们为退化维度。在 SSAS 中，它们被称为“事实维度” [http://msdn.microsoft.com/en-us/library/ms175669(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms175669%28v=sql.90%29.aspx "维度关系 MSDN 文章")

您实际上是将属性列放入事实表，而不是维度表。

一个重要提示。在维度建模中，是的，您正在尝试使用完美形成维度的星型模式，但在实际实现中不要害怕忽略理想。Kimball 甚至这样说，有时你需要打破规则，但需要注意的是你测试你的解决方案。如果它很快，那就去做吧！如果符合 Kimball 理想会使其变慢或增加不必要的复杂性，请避免使用它。

# javascript - Kindle忽略所有jquery

> ID：13240250
> 
> 赞同：3
> 
> 时间：2012-11-05T20:57:26.087
> 
> 标签：javascript, jquery, kindle-fire

Kindle 会自动阻止所有 JQuery 和 Javascript 吗？设置允许 javascript，但我无法触发最简单的 javascript - 甚至没有警报 - 任何人都可以对此事有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:58:33.990

据说有一个设置可以打开 JavaScript。

资料来源：[http ://www.amazon.com/forum/kindle?_encoding=UTF8&cdForum=Fx1D7SY3BVSESG&cdThread=Tx3HX0DT8W2SG5J](http://www.amazon.com/forum/kindle?_encoding=UTF8&cdForum=Fx1D7SY3BVSESG&cdThread=Tx3HX0DT8W2SG5J)

# c# - 从列表中查找最大值

> ID：13240254
> 
> 赞同：6
> 
> 时间：2012-11-05T20:57:52.183
> 
> 标签：c#, list, c#-4.0, generic-list

我定义了许多对象，每个对象都有一个名为“CreateDate”的属性。

是否可以编写一个通用的方法来从我指定的对象中选择最高日期？

我试图对此使用通用方法，但是当我尝试指定属性名称时编译器不喜欢它。

我试图在这些方面取得一些成就......

```
private static DateTime GetLastDate<T>(List<T> data)
{
    // Unfortunately, this is not allowed...
    return
        (from d in data
        orderby d.CreateDate
        select d.CreateDate).FirstOrDefault();
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-05T21:01:47.787

最好的方法是创建一个具有特定功能的接口，并让所有类都实现该接口：

```
public interface ICreated
{
  public DateTime CreateDate {get;}
} 
```

然后您可以确保所有接受的项目都实现该接口：

```
private static DateTime GetLastDate<T>(IEnumerable<T> input) where T : ICreated
{
    return input.Max(d=>d.CreateDate);
} 
```

如果这真的不是一个选项（可能是因为您无法修改类以使其实现接口或集合来包装基础类型），您可以使用`dynamic`. 我非常不鼓励你这样做，因为它真的不是好的设计，它会慢得多，而且很容易被破坏，但它可以工作：

```
private static DateTime GetLastDate(IEnumerable<dynamic> input)
{
    return input.Max(d=>d.CreateDate);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T23:31:31.340

您可以使用反射通过字符串值获取属性名称，如下所示：

您将需要此方法通过字符串值获取实际属性，如果您计划使用分配的通用内容，您可能有兴趣将其放在可以重用它的地方。

```
// Add ' using System.Reflection; ' on top
public static object GetPropertyValue(object o, string propertyName)
        {
            Type type = o.GetType();
            PropertyInfo info = type.GetProperty(propertyName);
            object value = info.GetValue(o, null);
            return value;
        } 
```

使用该方法，您可以执行此操作，而不是不适合您的代码：

```
private static DateTime GetLastDate<T>(List<T> data)
    {
        object value = (from d in data
             orderby GetPropertyValue(d, "CreateDate")
             select GetPropertyValue(d, "CreateDate")).FirstOrDefault();

        return DateTime.Parse(value.ToString());
    } 
```

它现在应该可以正常工作了，而且它会按照你想要的方式保持通用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:02:15.180

您可以将 CreateDate 属性封装在基类（例如 BaseClass）中，然后像这样

```
private static DateTime GetLastDate<T>(List<T> data) where T : BaseClass
{
     ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-08T07:38:36.013

我只是这样做并在我的扩展类中创建了一个通用方法

```
 public static object GetPropertyValue(this object o, string propertyName)
    {
        Type type = o.GetType();

        try
        {
            PropertyInfo info = (from x in  type.GetProperties() where x.Name.ToLower() == propertyName.ToLower() select x).First();
            object value = info.GetValue(o, null);
            return value;
        }
        catch (Exception ex)
        {
            return default(object);
        }
    }

    public static T GetFieldValue<T>(this object o, string propertyName) where T : struct, IComparable, IFormattable, IConvertible, IComparable<T>, IEquatable<T>
    {
        try
        {
            var val = GetPropertyValue(o, propertyName);
            return (T)val;
        }
        catch (Exception ex)
        {
            return default(T);
        }
    } 
```

这就是我使用它的方式......

```
var max_cust_id = (string)(from m in final_list.Skip((int)offset)
                                   orderby m.GetPropertyValue(identityField)
                                   select m.GetPropertyValue(identityField)).Max(); 
```

# winforms - 表单上独立模式下的 DevExpress DateEdit：有什么方法可以消除月份名称的突出显示？

> ID：13240257
> 
> 赞同：0
> 
> 时间：2012-11-05T20:57:55.427
> 
> 标签：winforms, devexpress, text-editor

当用户从日历视图下拉列表中选择一个日期时，编辑器会显示如下内容：Monday, `November`5, 2012

中带有“November” `reverse highlight`，就好像选中了文本一样。有没有一种简单的方法来显示没有高亮显示的纯文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T11:53:47.493

[TextEditStyle](http://documentation.devexpress.com/#WindowsForms/DevExpressXtraEditorsRepositoryRepositoryItemButtonEdit_TextEditStyletopic)属性允许您控制文本在编辑器中的显示方式以及文本的编辑方式。要显示文本而不进行任何选择和编辑，您可以为此属性使用[TextEditStyles.DisableTextEditor值：](http://documentation.devexpress.com/#WindowsForms/DevExpressXtraEditorsControlsTextEditStylesEnumtopic)

```
this.textEdit1.Properties.Mask.EditMask = "dddd, MMMM dd, yyyy";
this.textEdit1.Properties.Mask.UseMaskAsDisplayFormat = true;
this.textEdit1.Properties.TextEditStyle = DevExpress.XtraEditors.Controls.TextEditStyles.DisableTextEditor; 
```

# css - Chrome 和 Firefox 之间的 2px 不同

> ID：13240258
> 
> 赞同：0
> 
> 时间：2012-11-05T20:57:56.670
> 
> 标签：css, firefox, google-chrome, height

Chrome 和 Firefox 的输入高度相差 2px，为什么？（我不想指定输入元素的高度）

```
<html>
<head>
<title></title>
<style type="text/css">
p {
font-size: 11px;
font-family : Verdana;
}
input {
border: 1px solid #ccc;
font-size: 11px;
font-family : Verdana;
}
</style>
</head>
<body>    
<p>
<label>Text</label>
<input type="text" />
</p>
</body>
</html> 
```

顺便说一句，如果我用 Arial 字体代替 Verdana，尺寸是正确的。为什么？

谢谢你。

![例子](../Images/4d87afadff4c0ac9b6684525ebb1aa66.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:10:23.603

我遇到了与 Firefox 没有呈现与 Chrome 相同的搜索框的类似问题。我使用了以下 css 行并修复了它：

```
input::-moz-focus-inner {
    border: 0;
    padding: 0; 
    } 
```

让我知道它是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:15:34.480

调整[`line-height`](http://www.w3.org/TR/CSS21/visudet.html#propdef-line-height)

```
input { line-height:17px; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-14T09:53:13.997

将[行高](http://www.w3.org/TR/CSS21/visudet.html#propdef-line-height)设置为 1em：

```
input {line-height: 1em;} 
```

# unit-testing - DBUnit 重复行删除

> ID：13240260
> 
> 赞同：1
> 
> 时间：2012-11-05T20:58:14.583
> 
> 标签：unit-testing, testng, dbunit

需要知道如何删除数据集中的重复行。我正在从两个不同的数据库中收集数据（它们的所有列都相同）并且它们有一些相同的行。

我用`QueryDataSet`了两次。我通过使用合并它们`CompositeDataSet`。我得到的是所有行的列表，其中一些是重复的。

有没有一种简单的方法可以删除这些重复项并以某种方式对其进行排序？提前致谢。

# c++ - 重载 operator== 但它没有被调用（比较指针？）

> ID：13240263
> 
> 赞同：0
> 
> 时间：2012-11-05T20:58:22.243
> 
> 标签：c++

我正在尝试重载 == 运算符以在两个对象之间进行比较。由于某种原因，重载的处理程序永远不会被调用。

```
class gxCallback
{
public:
    virtual bool operator==(const gxCallback &aOther) const
    {
        // This is never called
        return true;
    } 
};

typedef std::vector < gxCallback* > CallbackList;

void gxObservable::Fire( gxCallback *aCallback )
{
    CallbackList::iterator iCallback;

    for ( iCallback = mCallbacks.begin(); iCallback != mCallbacks.end(); ++iCallback )
    {
        if ( aCallback == *iCallback ) // The comparison is never made via the overloaded ==
        {
            // Do something
        }
    }  
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T20:59:51.513

您是在指针上调用它，而不是在对象上。您必须将对象与迭代器引用的对象进行比较：

```
if (*aCallback == **iCallback) 
```

在取消引用它们之前，您还必须确保“指针”持有一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T20:59:58.260

您正在比较指针而不是对象本身。

# php - 为什么在我的 POST 中呈现此 html 错误？

> ID：13240269
> 
> 赞同：3
> 
> 时间：2012-11-05T20:58:32.917
> 
> 标签：php, laravel, eloquent

我有一个可用性日历，我正在尝试使用 Laravel 将其发布到我的数据库中。当我倾倒我的帖子时，我得到了这个..

```
string(1440) "s:1430:"2012-11-06;;1;;888,2012-11-07;;1;;888,2012-11-08;;
1;;888,2012-11-09;;1;;888,2012-11-10;;1;;888,2012-11-11;;1;;888,2012-11-12;;
1;;888,2012-11 13;;1;;888,2012-11-14;;1;;888,2012-11-15;;1;;888,2012-11-16;;1;;
888,2012-11-17;;1;;888,2012-11-18;;1;;888,2012-11-19;;1;;888,2012-11-20;;1;;888,
2012-11-21;;1;;888,2012-11-22;;1;;888,2012-11-23;;1;;888,2012-11-24;;1;;888,
2012-11-25;;1;;888,2012-11-26;;1;;888,2012-11-27;;1;;888,2012-11-28;;2;;0,array(1)
{["availability"]=>string(973) "s:964:"2012-11-05;;1;;888,2012-11-29;;1;;
888,2012-11-30;;1;;888,array(1) {["availability"]=>string(12) "availability"}

<html><h2>Unhandled Exception</h2><h3>Message:</h3><pre>Error rendering view:   
[layouts.admin] Undefined variable: title</pre><h3>Location:</h3>               
<pre>/Users/corymjacik/Sites/shipwatch_v2.1/storage/views/33f72cb6519c7f146dc8d6af4b948300 on line 5</pre><h3>Stack Trace:</h3>
<pre>#0 /Users/corymjacik/Sites/shipwatch_v2.1/laravel/laravel.php(40): 
Laravel\Error::native(8";"}  
<html><h2>Unhandled Exception</h2><h3>Message:</h3> 
<pre>Error rendering view: [layouts.admin]Undefined variable: title</pre> 
<h3>Location:</h3>
              <pre>/Users/corymjacik/Sites/shipwatch_v2.1/storage/views/33f72cb6519c7f146dc8d6af4b948300 
on line 5</pre><h3>Stack Trace:</h3> <pre>#0 /Users/corymjacik/Sites/shipwatch_v2.1/laravel/laravel.php(40): 
Laravel\Error::native(8";" 
```

什么可能导致此错误，为什么它包含在我对数据库的 POST 中？下面是我的控制器代码。一切正常，就像这样。我可以将该字符串发布到数据库（我使用 serialize() 从数组中转换为字符串），并且还可以从数据库中获取它，它可以很好地显示在前端。这些错误似乎没有什么区别，但我只是觉得我做错了什么。

```
public function post_availability_save()
  {
$availability = serialize(Input::get('dop_booking_calendar'));
//var_dump($availability);die;

$id = Auth::user()->id;

Availability::update($id, array(
  'user_id' => Auth::user()->id,
  'availability' => $availability
  ));
return Redirect::to('admin');
}

  public function get_availability_load()
  {
$id = Auth::user()->id;

$availability = array(
  'availability' => Availability::find($id)->availability
);

var_dump($availability);

} 
```

**编辑** 再弄乱它，它也倾倒了我的 html 布局的开头......有人知道是什么原因造成的吗？我会深入一点。 ***编辑***2012 年 11 月 13 日

```
//*This is what ends up in my database (Type:TEXT) //
,2012-11-13;;1;;1,2012-11-14;;1;;1,2012-11-15;;1;;1,2012-11-16;;1;;1,2012-11- 
17;;1;;1,2012-11-18;;1;;1,2012-11-19;;1;;1,2012-11-20;;1;;1,2012-11-21;;1;;1,2012
-11-22;;1;;1,2012-11-23;;1;;1,2012-11-24;;1;;1,2012-11-25;;1;;1,2012-11-26;;1;;1,
2012-11-27;;1;;1,2012-11-28;;1;;1,Array
(
    [availability] => 1
)
<html><h2>Unhandled Exception</h2>
<h3>Message:</h3>
<pre>Error rendering view: [layouts.admin] Undefined variable: title</pre>
<h3>Location:</h3>
             <pre>/Users/cory/Sites/shipwatchpoint_v2.1/storage/views/e2b30637bfaa9d210e31baf35870d230 on line 5</pre>
<h3>Stack Trace:</h3>
<pre>#0 /Users/corymjacik/Sites/shipwatchpoint_v2.1/laravel/laravel.php(40): Laravel\Error::native(8

// *layouts.admin.blade.php //
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{{ $title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- CSS -->
    {{ HTML::style('css/bootstrap.css') }}
    {{ HTML::style('css/jquery.dop.BookingCalendar.css') }}
    {{ HTML::style('css/app.css') }}

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="shortcut icon" href="/img/ico/favicon.ico">

  </head>
  <body>

    <div class="container-fluid">
      {{ $content }}
    </div>

    <!-- JS -->
    <!-- Placed at the end of the document so the pages load faster -->
    {{ HTML::script('http://code.jquery.com/jquery-1.8.2.min.js') }}
    {{ HTML::script('js/bootstrap.js') }}
    {{ HTML::script('js/app.js') }}
    {{ HTML::script('js/jquery.dop.BookingCalendar.js') }}

  </body>
</html>

//*admin controller (public restful is set to true)//
public function get_index()
  {
    $id = Auth::user()->id;
    $unit = array(
      'unit' => Unit::find($id),
      'unit_admin' => Unit::find($id)->user,
      //'availability' => Availability::all() added this and it still showed errors
    );

    //var_dump($unit);die;

    $this->layout->title = 'Admin Profile';
    $this->layout->nest('content', 'admin.index', $unit);
  }

public function post_availability_save()
  {
    //$availability = serialize(Input::get('dop_booking_calendar'));
    $availability = Input::get('dop_booking_calendar');
    //var_dump($availability);die;

    $id = Auth::user()->id;

    Availability::update($id, array(
      'user_id' => Auth::user()->id,
      'availability' => $availability
      ));
    return Redirect::to('admin');
  }

  public function get_availability_load()
  {
    $id = Auth::user()->id;

    $availability = array(
      'availability' => Availability::find($id)->availability
    );

    var_dump($availability);

  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:06:07.670

```
返回重定向::to('admin');
```

发送 $title 中的“标题”或在布局中设置它，就像您在 action_index() 中所做的一样

```
return Redirect::to('admin')->with('title','supercooltitle');
```

或者

```
return Redirect::to('admin')->with_title('supercooltitle');
```

然后您的视图可以获取 $title 并退出显示未定义的引用。

其他选项将在布局上设置它，类似于您对索引所做的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:14:15.460

好的。所以，我终于想通了。错误是在帖子中发送的，因为我正在 var_dump'ing 我们被选中的结果。我用'die'和'json_encode'修复了它。感谢所有帮助过的人！

# smalltalk - 为什么我需要像 Pharo 这样的 smalltalk 方言中的共享源文件？

> ID：13240273
> 
> 赞同：8
> 
> 时间：2012-11-05T20:58:38.640
> 
> 标签：smalltalk, pharo

通常的安装[说明](http://www.pharo-project.org/pharo-download)告诉我，我需要运行 Pharo 至少三个文件：

1.  图像文件
2.  更改文件
3.  源文件（例如 PharoV10.sources）

我已经在没有源文件的情况下运行了 Pharo 2，但没有发现任何问题。所有来源似乎都是可用的。

**那么，为什么我需要源文件（例如 PharoV10.sources）？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T05:32:48.860

镜像文件只包含编译后的代码，不包含原始源代码。更改文件包含您自己添加到系统中的内容的源代码，但不包含现有系统类的源代码。要获取现有系统类的源代码，您需要源文件。

话虽如此，如果源文件不可用，Smalltalk 可以反编译代码并生成看起来像源代码的内容。此代码将缺少正确的变量名称、注释和间距。您真的不想使用反编译的源代码，因此您需要访问源文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-05T21:40:36.183

3 种可能的解释，试着找出这个笑话：

1.  浏览器足够智能，可以向您显示从 CompiledMethod 字节码重构（反编译）的源代码。提示：在这种情况下，您会丢失所有评论
2.  有一个源文件的搜索路径，并且可以在磁盘的某个位置找到一个
3.  Pharo 变化如此之快，以至于现在可以在 .changes 文件中找到每个源

为了验证 1.，您可以尝试浏览对 Decompiler 的引用（我自己的口味有点太多用途）。

为了验证 2.，您可以开始浏览 #openSourceFiles 的实现者

为了验证 3.，您可以评估此​​代码段：

```
| nSources nChanges |
nSources := nChanges := 0.
SystemNavigation default allBehaviorsDo: [:b |
    b selectorsDo: [:s |
        (b compiledMethodAt: s) fileIndex = 1
            ifTrue: [nSources := nSources+1]
            ifFalse: [nChanges := nChanges+1]]].
^{nSources. nChanges} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-06T08:37:17.913

Pharo 也有可能自动下载 PharoV10.sources。

# objective-c - 添加 mainTableView 来表示 self.tableView 而不是 searchResultsTableView

> ID：13240274
> 
> 赞同：1
> 
> 时间：2012-11-05T20:58:54.307
> 
> 标签：objective-c, ios, xcode, uitableview

我隐藏了 searchViewController.searchResultsTableView 以在主 UITableView 中显示结果。但是 self.tableView = searchDisplayController.searchResultsTableView 所以 mainTableView 在输入搜索文本或点击“搜索”后不可滚动。如何让 self.tableView 代表 mainTableView？

```
- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
[self filterContentForSearchText:searchString scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:[self.searchDisplayController.searchBar selectedScopeButtonIndex]]];
self.searchDisplayController.searchResultsTableView.hidden=YES;
return YES;
} 
```

# objective-c - 没有遮罩层的 UIView 圆角

> ID：13240280
> 
> 赞同：0
> 
> 时间：2012-11-05T20:59:17.937
> 
> 标签：objective-c, ios, uiview, core-animation, core-graphics

我正在构建一个 iPad 应用程序，其中包括多个条形图（每个图表 30 多个条形图）和屏幕底部的上拉菜单。该设计要求这些条在左上角和右上角有圆角，但在左下角和右下角有方角。

现在，我正在使用遮罩层将每个单独的图表栏的顶角四舍五入：

```
#import "UIView+RoundedCorners.h"
#import <QuartzCore/QuartzCore.h>

@implementation UIView (RoundedCorners)

-(void)setRoundedCorners:(UIRectCorner)corners radius:(CGFloat)radius {
    CGRect rect = self.bounds;

    // Create the path 
    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:rect 
                                                   byRoundingCorners:corners
                                                         cornerRadii:CGSizeMake(radius, radius)];

    // Create the shape layer and set its path
    CAShapeLayer *maskLayer = [CAShapeLayer layer];
    maskLayer.frame = rect;
    maskLayer.path = maskPath.CGPath;

    // Set the newly created shape layer as the mask for the view's layer
    self.layer.mask = maskLayer;
    self.layer.shouldRasterize = YES;
}

@end 
```

这可行，但是当我拉起上拉菜单时会出现严重的帧丢失/滞后（请注意，菜单重叠，出现在图表顶部）。当我去掉圆角时，菜单很漂亮。据我所知，我需要一种通过直接修改视图而不是使用遮罩层来圆角的方法。有谁知道我该如何解决这个问题或有其他可能的解决方案？非常感谢任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:03:54.113

> 据我所知，我需要一种通过直接修改视图而不是使用遮罩层来圆角的方法。有谁知道我该如何解决这个问题或有其他可能的解决方案？

通常的方法是获取视图的图层并设置`cornerRadius`属性：

```
myView.layer.cornerRadius = 10.0; 
```

这样就不需要遮罩层或贝塞尔路径。在您的方法的上下文中，它将是：

```
-(void)setRoundedCorners:(UIRectCorner)corners radius:(CGFloat)radius
{
    self.layer.cornerRadius = radius;
} 
```

**更新：**对不起 - 我错过了这部分：

> 设计要求这些条在左上角和右上角有圆角，但在左下角和右下角有方角

如果你只想要*一些*圆角，你不能通过设置图层的`cornerRadius`属性来做到这一点。您可以采取两种方法：

*   创建一个有两个圆角和两个正方形的贝塞尔路径，然后填充它。不需要遮罩层来做到这一点。

*   使用可调整大小的图像。请参阅 UIImage 的`-resizableImageWithCapInsets:`和`-resizableImageWithCapInsets:resizingMode:`方法。甚至还有一些方法可以为可调整的图像设置动画，因此您可以轻松地将条形增长到正确的长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:38:45.903

尝试`shouldRasterize`在您的图层上设置。应该有帮助。

# expressionengine - CartThrob 中的优惠券代码字段在哪里？

> ID：13240282
> 
> 赞同：0
> 
> 时间：2012-11-05T20:59:26.013
> 
> 标签：expressionengine, cartthrob

CartThrob 文档的此页面上列出了一个 coupon_code 变量： [http ://cartthrob.com/docs/tags_detail/coupon_info/index.html#coupon_code](http://cartthrob.com/docs/tags_detail/coupon_info/index.html#coupon_code)

这个变量的数据究竟来自哪里？默认优惠券频道上没有设置“优惠券代码”字段。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T21:13:31.880

在折扣下的 CT 设置中，您可以定义要使用的渠道和该渠道中的自定义字段。IE。优惠券代码 = 标题和优惠券设置 = CT 折扣 FT

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:12:20.423

优惠券代码来自标题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:08:06.567

当您发布优惠券代码时，它看起来像是来自 url_title 字段。

# javascript - 如何将加载图标添加到仅处理 javascript 代码的页面？

> ID：13240286
> 
> 赞同：0
> 
> 时间：2012-11-05T20:59:32.613
> 
> 标签：javascript, jquery, ajax, browser, loading

当我执行 ajax 请求时，我一直使用 Ajax 加载图标。

我想知道是否有可能只用普通的 javascript 代码来完成同样的事情。例如：

```
$('button').on('click', function(){
    showLoadingBar();
    longProcess();
    hideLoadingBar();
}); 
```

longProcess() 只是一个可能需要 1-3 秒来处理的函数（它进行大量计算并操作 DOM，但不执行任何 ajax 请求）。

现在，浏览器在这 1-3 秒内停止/冻结，所以我宁愿在这段时间内显示一个加载图标。这可能吗？我上面的代码几乎忽略了 showLoadingBar()。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:03:33.710

在当前的 Javascript 进程结束之前，DOM 不会更新，所以你不能那样做。但是，您可以使用`setTimeout`来解决这个问题：

```
showLoadingBar();
setTimeout(function() {longProcess(); hideLoadingBar(); }, 1); 
```

如果不清楚，上面发生的事情`showLoadingBar`是执行，然后设置超时。当前进程将结束并允许 DOM 在调用超时之前使用加载条进行更新，不久之后。处理程序执行您的繁重功能，完成后，再次隐藏加载栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:12:40.903

以下将让您控制点击操作。这意味着您可以禁用点击功能，直到它完成运行。但我也包括了 setTimeout ，它将控制权返回给浏览器（从而消除了那种烦人的“锁定”感觉），并且在超时功能中，我们执行了漫长的过程，然后重新启用按钮！维奥拉！

```
function startProc() {
    var $this = $(this);
    $this.off("click", startProc);
    showLoadingBar();
    setTimeout(function() {
        longProcess();
        hideLoadingBar();
        $('button').on('click', startProc);
    });
}

$('button').on('click', startProc); 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-05T21:08:51.370

老兄，

使用 .bind 方法，在这种情况下执行如下：

```
$('button').bind('click', function(){
    showLoadingBar();
    longProcess();
    hideLoadingBar();
}); 
```

# javascript - 将值从 JSP 页面传递到 javascript 函数

> ID：13240294
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:00:29.530
> 
> 标签：javascript, jsp, servlets

我有一个 jsp 页面，它根据框中的选择更新列出的内容。

```
<form:select path="Value" id="select" onchange="update()" items="${Values}" /> 
```

在另一个文件中，根据您选择的内容和项目填充相应的更新函数。这适用于一个盒子，但我需要有多个盒子，但是将代码复制到for循环中会生成多个盒子，但更新函数只指向对象“select”的id。我想创建一种让 select 成为变量的方法，以便它生成多个具有不同值的对象，这样它们就不会指向同一事物。

我的想法是只创建一个 var 然后让它计数，以便在 id="select" 可以强制它创建不同的对象......但是更新函数从 jsp 读取

```
var Val = $('#select option:selected').val(); 
```

为了使它们匹配，我需要将参数传递给 update() 函数，但是当我用参数填充更新方法时，JSP 无法再调用它。我试过 Update(var n) { //code here}
和 Update(int n) {//Code here}

但是当JSP语句运行update(//ValueIwant)时，总是抛出找不到方法的错误。

所以我的问题是，如何在不硬编码所有值的情况下将参数从 jsp 页面动态传递给 javascript 函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T15:02:19.560

我想到了。这很简单。只需从 JSP 调用函数（参数），但在 javascript 中，该方法只是用没有类型的参数声明的。

```
Function Myfunction (N)
{
//code
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T15:07:37.920

在**这种特定情况下**，可以使用 javascript 关键字`this`来传递元素的引用。

尽可能接近提供的代码（包括使用 jQuery），这将是：

```
<form:select path="Value" id="select" onchange="update(this)" items="${Values}" />
<!-- 3 more times; id should be changed and kept unique -->
<!-- ... -->
<script type="text/javascript">
  function update(srcElement) {
    var Val = $(srcElement).find('option:selected').val();
    // want to make sure it's OK so far?
    console.log(Val);
  }
</script> 
```

* * *

现在，**在一般情况下**，正如其他人所提到的，这本质上是一个问题，即如何使用 JSP 标记以生成执行您希望它执行的 HTML（这里是嵌入的 javascript）。

我没有练习过 Spring MVC（我假设这就是这里使用的），但在**伪代码**中，这可能看起来像：

```
<!-- remember? this is *pseudo-code*, 
     for I ignore the form:select capabilities,
     specifically towards runtime expressions like ${i} 
-->
<% for(int i= 0; i<4 ; i++) { %>
  <%-- maybe the following line is not 100% OK; 
       fix it according to your taglib documentation --%>
  <form:select path="Value" id="select${i}" 
               onchange="update(${i})" items="${Values}" />
<% } %>
<script type="text/javascript">
  function update(index) {
    var Val = $('#select' + index + ' option:selected').val();
    // want to make sure it's OK so far?
    console.log(Val);
  }
</script> 
```

# sql - 从字符串 sql server 中删除数字

> ID：13240298
> 
> 赞同：28
> 
> 时间：2012-11-05T21:00:37.763
> 
> 标签：sql, sql-server, sql-server-2008

我有一个大型数据库，我想在其中进行部分字符串搜索。用户将输入字符：`JoeBloggs.`

`Joe 23 Blo Ggs 4`如果我在数据库中有一个名字，为了争论。我想删除除 AZ 以外的名称中的所有内容。

我具有`REPLACE(Name, ' ','')`删除空格的`UPPER()`功能和将名称大写的功能。

是否有更有效的快速方法可能通过正则表达式来替换 AZ 以外的任何内容。我无法更改数据库中的值。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-05T21:19:15.257

第一个选项 -

您可以嵌套`REPLACE()`最多 32 层的函数。它跑得很快。

```
REPLACE
(REPLACE
(REPLACE
(REPLACE
(REPLACE
(REPLACE
(REPLACE
(REPLACE
(REPLACE
(REPLACE (@str, '0', ''),
'1', ''),
'2', ''),
'3', ''),
'4', ''),
'5', ''),
'6', ''),
'7', ''),
'8', ''),
'9', '') 
```

第二个选项 - 做相反的 -

[从数字中删除非数字数据+ SQL](https://stackoverflow.com/questions/630472/removing-nonnumerical-data-out-of-a-number-sql)

第三个选项 - 如果你想使用正则表达式

然后 [http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=27205](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=27205)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-25T16:40:56.237

这个对我有用

```
CREATE Function [dbo].[RemoveNumericCharacters](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    Declare @NumRange as varchar(50) = '%[0-9]%'
    While PatIndex(@NumRange, @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex(@NumRange, @Temp), 1, '')

    Return @Temp
End 
```

你可以像这样使用它

```
SELECT dbo.[RemoveNumericCharacters](Name) FROM TARGET_TABLE 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-01-02T10:02:40.390

试试下面的查询。其中 val 是您的字符串或列名。

```
CASE WHEN PATINDEX('%[a-z]%', REVERSE(val)) > 1
                THEN LEFT(val, LEN(val) - PATINDEX('%[a-z]%', REVERSE(val)) + 1)
            ELSE '' END 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-17T13:20:44.357

使用递归 CTE 的另一种方法..

```
declare @string varchar(100)
set @string ='te165st1230004616161616'

;With cte
as
(
select @string as string,0  as n
union all
select cast(replace(string,n,'') as varchar(100)),n+1
from cte
where n<9
)
select top 1 string from cte
order by n desc

**Output:**   
  test 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-20T08:28:28.070

引用@Jatin 的部分答案并进行一些修改，

在您的`where`声明中使用它：

```
 SELECT * FROM .... etc.
        Where 
         REPLACE
        (REPLACE
        (REPLACE
        (REPLACE
        (REPLACE
        (REPLACE
        (REPLACE
        (REPLACE
        (REPLACE
        (REPLACE (Name, '0', ''),
        '1', ''),
        '2', ''),
        '3', ''),
        '4', ''),
        '5', ''),
        '6', ''),
        '7', ''),
        '8', ''),
        '9', '') = P_SEARCH_KEY 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-11T17:11:18.420

```
DecLARE @input varchar(50)= 'Joe 23 Blo Ggs 4'
    SELECT TRANSLATE(@input,'0123456789','          ') As output1,
            REPLACE
            (
                TRANSLATE(@input,'0123456789','          ') /*10 spaces here*/
                , ' '
                ,''
            ) as output2 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-12T00:09:38.683

删除第一个数字之后的所有内容（对于我的用例来说已经足够了）： LEFT(field,PATINDEX('%[0-9]%',field+'0')-1)

删除尾随数字： LEFT(field,len(field)+1-PATINDEX('%[^0-9]%',reverse('0'+field))

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-23T23:36:57.070

我刚开始重新学习 SQL ......我在某处读到了这个：

```
SELECT TRIM('0123456789' FROM customername ) 
```

您也可以使用它来删除空格或其他符号。只需将其包含在引号内的第一个参数中即可`''`。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-11-05T21:24:48.457

未经测试，但您可以执行以下操作：

```
Create Function dbo.AlphasOnly(@s as varchar(max)) Returns varchar(max) As
Begin
  Declare @Pos int = 1
  Declare @Ret varchar(max) = null
  If @s Is Not Null
  Begin
    Set @Ret = ''
    While @Pos <= Len(@s)
    Begin
      If SubString(@s, @Pos, 1) Like '[A-Za-z]'
      Begin
        Set @Ret = @Ret + SubString(@s, @Pos, 1)
      End
      Set @Pos = @Pos + 1
    End
  End
  Return @Ret
End 
```

关键是将其用作计算列并为其编制索引。如果每次运行查询时数据库都必须针对大表中的每一行执行此函数，那么执行此函数的速度并不重要。

# php - PHP 管理和编辑 CSS 或其他文件

> ID：13240299
> 
> 赞同：0
> 
> 时间：2012-11-05T21:00:42.477
> 
> 标签：php, file, textarea

我正在寻找一种打开文档的方法，在这种情况下，下面的代码是我编写的函数的输出。在这个输出中，我可以访问一些我想编辑的其他文件，在这种情况下是 css 文件。

单击它们后，我可以了解如何打开/编辑它们吗？

```
<tr>
      <td class="form_select"><input id="select_all_form15" name="select_all_form15" type="checkbox" value="Forms" class="case" /></td>
      <td class="form_id">1334261250</td>
      <td class="form_url"><a href="/forms/hatternet/deland/email/index.php" target="_blank">Lifetime Email Request</a></td>
      <td class="form_autofill">HATTERNET</td>
      <td class="form_save">form.css</td>
      <td class="form_save"></td>
      <td class="form_save"></td>
      <td class="form_save"></td>
      <td class="form_dates"></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:19:48.163

您将需要一个额外的脚本来处理这个问题，但是您正在寻找从磁盘读取整个文件到变量的函数是：

```
file_get_contents(); // Reads the contents of a file into a variable
file_put_contents(); // Writes a variable to a file 
```

文档在这里：[http](http://ca3.php.net/manual/en/function.file-get-contents.php) ://ca3.php.net/manual/en/function.file-get-contents.php 和：[http ://ca3.php.net/manual/en/function.file-put-contents .php](http://ca3.php.net/manual/en/function.file-put-contents.php)

然后，您必须将正在编辑的文件的内容输出到 textarea 以便您可以对其进行编辑，然后当您将更改发回时，您必须再次将它们写入文件。

但是，使用这种技术，你必须非常小心，有可能完全把自己搞砸。您需要将文件编辑限制为您实际希望用户编辑的文件。因此，如果只有 style.css 应该是可编辑的，请确保您的脚本只能读取和写入该文件而不能写入其他文件。

您还需要确保此脚本前面有某种身份验证，以便其他人无法更改您的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:21:06.577

您可以使用`file_get_contents()`来获取文件的内容。您可以将此数据回显到文本区域或其他任何内容中并用于`file_put_contents()`更新文件。

编辑：哎呀，被打败了！:)

# actionscript-3 - 每帧计算与预渲染位图

> ID：13240302
> 
> 赞同：-2
> 
> 时间：2012-11-05T21:00:48.670
> 
> 标签：actionscript-3, optimization

1.  我们创建一些 MovieClips 并使用 Motion Tween 为它们设置动画。
2.  我们创建一些 MovieClip 并使用 Motion Tween 对其进行动画处理，然后将所有帧渲染为 .png 并使用所有这些渲染的 .png 创建 MovieClip。

我想第二种方法花费的时间更少，因为你跳过了补间计算步骤。哪种动画方式更合适/更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:50:07.607

这当然是第一个。也许您的意图是好的，但从长远来看不会有回报，而且它也是微优化，被认为是不好的。它不会使代码可读，并且会减慢您的加载时间。通常计算也更快，因为您不需要更改整个屏幕。所以这真的取决于第二个版本是否使用例如动画的增量包装。

# javascript - 如何在jsdom中执行外部脚本

> ID：13240303
> 
> 赞同：0
> 
> 时间：2012-11-05T21:00:47.673
> 
> 标签：javascript, node.js, jsdom

我在 products.js 文件中有一个方法，如下所示：

```
var handler = function(errors, window) {...} 
```

并希望在 jsdom env 回调中执行它：

```
jsdom.env({
    html : "http://dev.mysite.com:3000/products.html",
    scripts : [ "http://code.jquery.com/jquery.js", "page-scrapers/products.js" ],
    done : function(errors, window) {
        handler(errors, window)
        }  
}); 
```

执行时，它告诉我“未定义处理程序”。我接近了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:04:22.160

如果您希望另一个文件可以访问变量，则必须将其导出。[http://nodejs.org/api/modules.html](http://nodejs.org/api/modules.html)

```
//products.js
exports.handler = function(window, error) {...}

// another.file.js
var products = require('products.js');
jsdom.env({
    html : "http://dev.mysite.com:3000/products.html",
    scripts : [ "http://code.jquery.com/jquery.js", "page-scrapers/products.js" ],
    // This can be simplified as follows 
    done : products.handler
}); 
```

但这听起来是个坏主意，为什么要将处理程序变成全局处理程序？我认为你应该重组你的代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:20:12.513

问题的背景是从现有网站上抓取数据。我们希望为每个页面关联一个 javascript 抓取器，并通过 node.js 服务器提供的 URL 访问抓取的数据。

正如 Juan 所建议的，关键是使用 node.js 模块。大部分hander方法是从product.js中导出的​​：

```
exports.handler = function(errors, window, resp) {... 
```

然后在基于 node.js 的服务器实例中导入：

```
//note: subdir paths must start with './' :
var products = require('./page-scrapers/products.js'); 
```

这会通过名称“products.handler”创建对该方法的引用，然后可以在请求处理程序中调用该方法：

```
var router = new director.http.Router({
'/floop' : {
    get : funkyFunc
}
})

var funkyFunc = function() {
var resp = this.res

jsdom.env({
    html : "http://dev.mySite.com:3000/products.html",
    scripts : [ "http://code.jquery.com/jquery.js"],
    done : function(errors, window) {products.handler(errors, window, resp)}
});
} 
```

那行得通。

# objective-c - 多个可滚动的子视图/表格视图

> ID：13240305
> 
> 赞同：2
> 
> 时间：2012-11-05T21:00:55.050
> 
> 标签：objective-c, ios, ipad, uiviewcontroller, uiscrollview

我正在开发一个 ipad 应用程序，我需要与此应用程序中的 ipad 屏幕截图类似的功能：

[TSN：iPad版](https://itunes.apple.com/ca/app/tsn-ipad-edition/id428290993?mt=8&s=143455&ign-mpt=uo=4)

基本上我可以在一个屏幕上滚动浏览许多子视图，甚至一些子视图也可以相互叠加然后关闭。

想到的第一个想法是在 UIScrollView 中插入多个子视图，然后做一个简单的滚动，但是它们如何相互滚动等等。 ![看中间的图片，它打开了 2 个子视图，它们可以相互滚动](../Images/3796458e9d6acfddc5fffd77a80f26b1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:22:20.180

您的屏幕截图似乎与 CLCascade 库非常相似。你可以在 github 中找到它的地址：[https](https://github.com/appunite/CLCascade) ://github.com/appunite/CLCascade 。在链接的图像中有示例的屏幕截图。

![在此处输入图像描述](../Images/4d5b7b601844ac16415b07fa6f6a47ac.png)

请注意，主干不是最新的，请查看分支以了解更适合您的需求。

# asp.net - ASP.Net Webforms 的值转换器

> ID：13240306
> 
> 赞同：1
> 
> 时间：2012-11-05T21:01:05.910
> 
> 标签：asp.net, webforms, model-binding, asp.net-4.5, webformsmvp

我正在组合一个使用[WebFormsMvp 库](http://webformsmvp.com/)的 Web 表单应用程序。在示例中，它在 ASPX 标记中显示如下内容：

```
Name:
<asp:TextBox runat="server" 
             ID="txtName" 
             Text="<%# Model.Name %>" 
             Visible="<%# Model.ShowName %>" /> 
```

这在绑定容器（例如网格、中继器等）之外是允许的。它让我想起了 WPF 中的 MVVM 风格编程。我缺少的是一个值转换器，因此我可以设置应该如何转换值。我想我可以使用模型上的类型的扩展方法来做到这一点，但这似乎在视图和代码之间没有很好的分离。

最后我有两个问题：

*   ASP.Net WebForms 4.5 是否支持这种类型的行为而无需额外的库？
*   WebForms绑定中是否有类似于值转换器的概念？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T23:42:04.633

我可能想太多了，因为以下似乎效果很好：

```
Name:
<asp:TextBox runat="server" 
         ID="txtName" 
         Text="<%# Model.Name %>" 
         Visible="<%# !String.IsNullOrEmpty(Model.Name) %>" /> 
```

这几乎和价值转换器一样好。

# html - 如何在内容可编辑的 UL 中强制执行 LI 格式

> ID：13240310
> 
> 赞同：5
> 
> 时间：2012-11-05T21:01:23.663
> 
> 标签：html, contenteditable

我正在尝试允许用户编辑列表 (UL)。在我的尝试中，似乎 contenteditable 并没有做任何特别的事情（比如强制执行幕后标记）——它只是为用户提供了一个进入 innerHTML 的窗口。

这会导致问题，如果还没有 LI，并且用户添加了一些东西，它不会被 LI 化。类似地，如果有列表项，但用户删除了它们，则 LI 将被删除，并且添加的任何新文本都没有 LI。请参阅[http://jsfiddle.net/JTWSC/](http://jsfiddle.net/JTWSC/)。我还发现光标有时可能会“离开”确实存在的 LI，但我无法始终如一地重现。

我必须包含代码，所以这就是“结果”的样子：

```
<ul>whatever the user typed in</ul> 
```

我该如何解决？我开始使用 $('ul').keyup() 处理程序的路径，该处理程序检查 html 并根据需要进行包装，但我遇到了一些陷阱，比如计时、失去对元素的关注、不得不重新关注正确的地方，等等。我相信如果我在这方面工作是可能的，但我希望有一个更简单的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T01:01:16.963

我构建了以下 keyup/down 处理程序，以使我的 contenteditable <UL>s 白痴证明。*

它做了两件事：

1.  当 <UL> 为空时，将 <LI> 添加到 <UL>。我使用在 SO（来自 Tim Down）上找到的一些代码将插入符号放在预期的位置
2.  清除所有非 LI/非 BR 标记。这基本上是一种快速又脏的膏状清洁剂。

这提高了我对 jquery 和 DOM 操作的舒适度，所以可能有几件事我可以做得更好，但它按原样工作得很好。

```
//keyup prevented the user from deleting the bullet (by adding one back right after delete), but didn't add in li's on empty ul's, thus keydown added to check
$('ul').on('keyup keydown', function() {
  var $this = $(this);
    if (! $this.html()) {
        var $li = $('&lt;li&gt;&lt;/li&gt;');
        var sel = window.getSelection();
       var range = sel.getRangeAt(0);
        range.collapse(false);
        range.insertNode($li.get(0));
        range = range.cloneRange();
        range.selectNodeContents($li.get(0));
        range.collapse(false);
        sel.removeAllRanges();
        sel.addRange(range);

    } else {
        //are there any tags that AREN'T LIs?
        //this should only occur on a paste
        var $nonLI = $this.find(':not(li, br)');

        if ($nonLI.length) {
            $this.contents().replaceWith(function() {
    //we create a fake div, add the text, then get the html in order to strip out html code. we then clean up a bit by replacing nbsp's with real spaces
return '&lt;li&gt;' + $('&lt;div /&gt;').text($(this).text()).html().replace(/&nbsp;/g, ' ') + '</li>';
            });
            //we could make this better by putting the caret at the end of the last LI, or something similar
        }                   
    }
}); 
```

jsfiddle 在[http://jsfiddle.net/aVuEk/5/](http://jsfiddle.net/aVuEk/5/)

*我非常不同意 Diodeus 的观点，即培训是所有情况下最好/最简单的解决方案。在我的情况下，我在一个页面上有几个可内容编辑的 <UL>，它们*非常*内嵌 WYSIWYG（即，tinymce 风格的 chrome 没有太多空间），并且被临时的、初次使用的非高级用户使用。

# javafx - 卡住事件处理 Java FX - 控制器 - 场景构建器

> ID：13240314
> 
> 赞同：3
> 
> 时间：2012-11-05T21:01:45.953
> 
> 标签：javafx, scenebuilder

我想将 Netbeans Java FX 与 Scene builder 一起用于测量应用程序。我设计了一个带有控件的场景。我可以处理来自“...Controller.java”中的 UI 控件的事件。

“控制器”是在 XML 文件中引用并由系统初始化的标准代码段：

```
public void initialize(URL url, ResourceBundle rb) { .. 
```

我的问题：如何从控制器内访问我的中心、持久的“模型”对象？或者，更准确地说，来自控制器初始化函数中创建的事件处理程序。

“模型”对象将在应用程序对象中创建。

解决方案一定是微不足道的，但我还没有找到办法

*   从控制器访问应用程序
*   或从应用程序中访问控制器。我错过了什么？

（下一个问题是如何访问由屏幕生成器创建的对象层次结构中的窗格树，例如用于输出图形操作。由于对象不是由自己的代码创建的，我无法存储对其中一些的引用。好的，它们也许可以通过 tree-walking 找到和引用，但一定有更好的方法！）

感谢所有的见解！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:29:33.170

不久前我使用了第二种方法（从应用程序中访问控制器），类似于以下内容。在应用程序类中：

```
//..
private FooController fooController;
private Pane fooPage;
private Model myModel;

@Override
public void start(Stage stage) {
    //..
    myModel = new Model();
    getFooController().updateModel(myModel);
    //..
    Button button = new Button("Update model with new one");
    button.setOnAction(new EventHandler<ActionEvent>() {
            @Override
            public void handle(ActionEvent event) {
                Model myNewModel = new Model();
                getFooController().updateModel(myNewModel);
            }
    }
    // create scene, add fooPage to it and show.
}

private FooController getFooController() {
    if (fooController == null) {
       FXMLLoader fxmlLoader = new FXMLLoader();
       fooPage = fxmlLoader.load(getClass().getResource("foo.fxml").openStream());
       fooController = (FooController) fxmlLoader.getController();
    }
    return fooController;
} 
```

实际上，您问题的第一部分和第二部分已回答[JavaFX 2.0 + FXML。将不同任务](https://stackoverflow.com/a/10108788/682495)中的场景值更新为您的类似问题。

# iphone - 如何在 for() 循环中增加属性名称的数字部分？

> ID：13240324
> 
> 赞同：0
> 
> 时间：2012-11-05T21:02:17.130
> 
> 标签：iphone, xcode, properties, for-loop

我有 10 个泛识别器并想分配给类属性。如何在 for() 循环中增加属性名称的数字部分？

```
for (int i=0; i < [_myArray count]; i++)
{
    myClassInstance.recognizer = pangesture + i ?? // doesn't work of course. but how??
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:12:16.957

> 我有 10 个泛识别器并想分配给类属性。如何在 for() 循环中增加属性名称的数字部分？

我不确定我是否完全理解你的问题，但假设你有 10 个手势识别器`g1`通过`g10`你想使用循环分配给 10 个对象来命名，一个好的方法是将这 10 个手势识别器放入一个数组中并然后使用当前索引进行分配：

```
NSArray *recognizers = @[g1, g2, g3, g4, g5, g6, g7, g8, g9, g10];
if ([recognizers count < [_myArray count]) {
    NSLog("Houston, we have a problem! Not enough gesture recognizers to go around.");
}
for (int i=0; i < [_myArray count]; i++)
{
    myClassInstance.recognizer = recognizers[i]; // note the fancy "new" array access syntax!
} 
```

如果您没有单独分配手势识别器，那么您可以每次通过循环创建一个：

```
for (MyClass *instance in _myArray) {
    instance.recognizer = [[UIGestureRecognizer alloc] init...];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:47:57.677

这不是一种奇妙的形式——尽可能地遵循 Caleb 的评论——但如果你真的陷入困境：

```
for(int i = 0; i < [_myArray count]; i++)
{
    NSString *nameOfProperty = [NSString stringWithFormat:@"pangesture%d", i];
    UIPanGestureRecognizer *recogniser = [self valueForKey:nameOfProperty];
} 
```

那是使用[键值编码](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/KeyValueCoding.html)；`IBOutlet`s 必须符合 KVC，否则将无法加载 NIB。

# java - 我应该@Deprecate 超类方法吗？

> ID：13240325
> 
> 赞同：4
> 
> 时间：2012-11-05T21:02:28.357
> 
> 标签：java, oop, inheritance, overriding, deprecated

假设我正在扩展`JFileChooser`并制作一个易于使用的版本，我称之为`SimpleFileChooser`.

它的结构使得它可以是`DIALOG_TYPE_OPEN`或`DIALOG_TYPE_SAVE`——因此，`JFileChooser`'s`showOpenDialog()`和`showSaveDialog()`方法是多余的。我用一个`showDialog()`返回布尔值的方法替换它们，但这是我发现自己陷入困境的地方：

> 我是否应该覆盖打开/保存方法`@Deprecated`并向它们添加标签，以便 API 用户知道它们已被取代？这会违反注释的[最初目的](http://docs.oracle.com/javase/1.5.0/docs/guide/javadoc/deprecation/deprecation.html#what)吗？
> 
> 或者文档中的通知就足够了？如果是这样，这个通知应该放在哪里：在类摘要中还是在被覆盖的方法之上？我什至应该首先覆盖这些方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T21:07:35.970

我认为您实际上是在构建一个[外观](/questions/tagged/facade "显示标记为“外观”的问题")，即现有 API 的简化版本。因此，您应该使用组合而不是继承。将原始内容隐藏在`JFileChooser`新类中并提供更简单的 API。

作为最后的手段，`public JFileChooser getRaw()`如果其他代码需要它，您可以提供访问包装对象的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:08:21.660

@Deprecated 表示您不应再使用该特定类或方法，因为将来它将被删除。该注释就是为此而设计的。因此，简短地回答一下，如果您不希望 API 用户再使用该方法，您应该使用 @Deprecated。因为否则您最终会得到仍然使用您在未来构建中删除的方法/类的用户，并且他们的项目在更新时将被破坏。

# php - 如何处理mysql表的每一行？

> ID：13240327
> 
> 赞同：0
> 
> 时间：2012-11-05T21:02:34.663
> 
> 标签：php, html, mysql, database

为了在 php 中创建动态表，我`$count`从查询中设置变量，该变量计算特定表中的行数。然后我想创建一个具有确切行数的表作为 html 表：

```
for($i=1;$i=<$count;$i++){
    echo"<tr><td>$name</td><td>$rights</td></tr>";
} 
```

这就是我希望表格显示的方式。但是每次调用 for 循环时，应该从数据库表中获取`$name`和的值。`$rights`但是我应该如何处理呢？我想到了一个简单的查询，从 ID 等于 i 的行中选择名称。但后来我记得，当我从表中删除一个条目时，总会有间隙。例如，当有 3 个条目并且我删除了第二个条目时。只有2个条目；所以第二行的名称，ID 为 3，永远不会被选中。有没有办法以适当的方式处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:05:16.177

您不会使用 a`for`而是将 a`while`或 a`foreach`用于查询的结果。

```
<?php
$db = new PDO($dsn, $user, $pass);
$stmt = $db->query('SELECT id, rights FROM the_table');
?>

<table>
<thead>
<tr>
  <th>Id</th>
  <th>Rights</th>
</tr>
</thead>
<tbody>
<?php if($stmt !== false): ?>
<?php foreach( $stmt as $row): ?>
  <tr>
    <td><?php echo $row['id'] ?></td>
    <td><?php echo $row['rights'] ?></td>
  </tr>
<?php endforeach; ?>
<?php endif; ?>
</tbody>
</table> 
```

# objective-c - 计算时间并获得状态

> ID：13240329
> 
> 赞同：1
> 
> 时间：2012-11-05T21:03:00.343
> 
> 标签：objective-c, ios, xcode, cocoa-touch

我希望你能帮我解决这个问题：

我正在编写一个应用程序，该应用程序应显示商店是否实际营业。为此，我为每一天和每个开放时间声明了不同的变量/NSDate-Objects，例如（设置我之前做过的 dateformatter）：

```
 NSDate *mondayMorningOpening = [dateFormatter dateFromString:@"08:00"];
    NSDate *montagMorningClosing = [dateFormatter dateFromString:@"12:30"];
    NSDate *mondayNoonOpening = [dateFormatter dateFromString:@"15:00"];
    NSDate *montagNoonClosing = [dateFormatter dateFromString:@"21:30"]; 
```

我还为实际时间设置了 NSDate：

```
 NSString *tempDate1 = [dateFormatter stringFromDate:date];
    NSDate *actualTime = [dateFormatter dateFromString:tempDate1]; 
```

现在我想计算实际时间是在商店开放时间的时间范围之前还是之后。我已经这样做了：

```
 if ([actualTime earlierDate: mondayMorningClosing && [aktuelleZeit laterDate: mondayMorningOpening])
        {
         NSLog (@"The shop is open!");
        }
    else if ([actualTime earlierDate: mondayNoonClosing]&& [actualTime laterDate: mondayNoonOpening])
        {
         NSLog (@"The shop is open!");
        }
    else
        {
         NSLog (@"The shop is closed!");
        } 
```

但无论是什么时候，它总是显示“商店开门了！”。

也许您知道该怎么做，我可以正确显示开放状态...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:27:13.523

If you have 2 dates you can determine if an `NSDate` is between those two like this:

```
- (BOOL)isDate:(NSDate *)date betweenFirstDate:(NSDate *)firstDate andSecondDate:(NSDate *)secondDate
{
    BOOL isEqualToFirstOrSecond = [date compare:firstDate] == NSOrderedSame || [date compare:secondDate] == NSOrderedSame;
    BOOL isBetweenFirstAndSecond = [date compare:firstDate] == NSOrderedDescending && [date compare:secondDate] == NSOrderedAscending;

    return isEqualToFirstOrSecond || isBetweenFirstAndSecond;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:16:28.627

你可以比较两个日期，但结果你会得到一个 NSDate：

```
if ([date1 compare:date2] == NSOrderedDescending) {
    NSLog(@"date1 is later than date2");        

} else if ([date1 compare:date2] == NSOrderedAscending) {
    NSLog(@"date1 is earlier than date2");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:10:48.883

您误解了 earlyDate 和 laterDate 的含义。这些方法不是“isEarlierDate”和“isLaterDate”，它们不返回 BOOL。这些方法返回一个 NSDate 对象，即两个日期中较早（或较晚）的日期。它们不是nil 对象，所以它们总是被评估为真。

比较两个日期的时间间隔：

```
if ([actualTime timeIntervalSinceDate: mondayMorningClosing]<0 && [aktuelleZeit timeIntervalSinceDate: mondayMorningOpening]>0)
{
    NSLog (@"The shop is open!");
} 
```

# c++ - 数组中 3 个长度 AP 的最快算法计数数

> ID：13240330
> 
> 赞同：1
> 
> 时间：2012-11-05T21:03:05.733
> 
> 标签：c++, algorithm

我想解决[这个](http://www.codechef.com/NOV12/problems/COUNTARI/)CodeChef 挑战：

假设我们有一个包含 N（范围为 100,000）个元素的数组 A。我们要找到所有 3 个这样的元素对的计数 1<=Ai,Aj,Ak<=30,000 使得

`Aj-Ai = Ak- Aj and i < j < k`

换句话说 Ai,Aj,Ak 在算术级数中。例如对于 Array ：

```
9 4 2 3 6 10 3 3 10 
```

所以AP是：

```
{2,6,10},{9,6,3},{9,6,3},{3,3,3},{2,6,10} 
```

所以要求的答案是 5。

## 我的方法

我尝试的是取 30,000 个名为过去和正确的长数组。最初 right 包含每个 1-30,000 元素的计数。

如果我们在第 i 个位置，则过去存储 i 之前的数组值的计数，而 right 存储 i 之后的数组的计数。我只是循环查找数组中所有可能的共同差异。这是代码：

```
right[arr[1]]--;

for(i=2;i<=n-1;i++)
{
    past[arr[i-1]]++;
    right[arr[i]]--;
    k=30000 - arr[i];
    if(arr[i] <= 15000)
        k=arr[i];
    for(d=1;d<=k;d++)
    {
        ans+= right[arr[i] + d]*past[arr[i]-d] + past[arr[i] + d]*right[arr[i]-d];
    }
    ans+=past[arr[i]]*right[arr[i]];
} 
```

但这让我超过了时间限制。请帮助更好的算法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:10:55.013

如果您对列表进行第一次遍历，并且只提取可能有 3 项 AP 之间的数字对（差异为 0 mod 2），则可以大大缩短执行时间。然后在这些对之间迭代。

伪 C++-y 代码：

```
// Contains information about each beginning point
struct BeginNode {
  int value;
  size_t offset;
  SortedList<EndNode> ends;  //sorted by EndNode.value
};

// Contains information about each class of end point
struct EndNode {
  int value;
  List<size_t> offsets; // will be sorted without effort due to how we collect offsets
};

struct Result {
  size_t begin;
  size_t middle;
  size_t end;
};

SortedList<BeginNode> nodeList;
foreach (auto i : baseList) {
  BeginNode begin;
  node.value = i;
  node.offset = i's offset; //you'll need to use old school for (i=0;etc;i++) with this
  // baseList is the list between begin and end-2 (inclusive)
  foreach (auto j : restList) { 
    // restList is the list between iterator i+2 and end (inclusive)
    // we do not need to consider i+1, because not enough space for AP
    if ((i-j)%2 == 0) { //if it's possible to have a 3 term AP between these two nodes
      size_t listOffset = binarySearch(begin.ends);
      if (listOffset is valid) {
        begin.ends[listOffset].offsets.push_back(offsets);
      } else {
        EndNode end;
        end.value = j;
        end.offsets.push_back(j's offset);
        begin.ends.sorted_insert(end);
      }
    }
  }
  if (begin has shit in it) {
    nodeList.sorted_insert(begin);
  }
}
// Collection done, now iterate over collection

List<Result> res;
foreach (auto node : nodeList) {
  foreach (auto endNode : node.ends) {
    foreach (value : sublist from node.offset until endNode.offsets.last()) {
      if (value == average(node.value, endNode.value)) {
        // binary_search here to determine how many offsets in "endNode.offsets" "value's offset" is less than.
        do this that many times:
          res.push_back({node.value, value, endNode.value});
      }
    }
  }
}

return res; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T23:01:13.820

这是一个简单的 C 版本的解决方案，它利用了 Ai + Ak must be even test：

```
#include <stdio.h>

static int arr[] = {9, 4, 2, 3, 6, 10, 3, 3, 10};

int main ()
{
    int i, j, k;
    int sz = sizeof(arr)/sizeof(arr[0]);
    int count = 0;

    for (i = 0; i < sz - 2; i++)
    {
        for (k = i + 2; k < sz; k++)
        {
            int ik = arr[i] + arr[k];
            int ikdb2 = ik / 2;

            if ((ikdb2 * 2) == ik) // if ik is even
            {
                for (j = i + 1; j < k; j++)
                {
                    if (arr[j] == ikdb2)
                    {
                        count += 1;
                        printf("{%d, %d, %d}\n", arr[i], arr[j], arr[k]);
                    }
                }
            }
        }
    }
    printf("Count is: %d\n", count);
} 
```

和控制台运球：

```
tmp e$ cc -o triples triples.c
tmp e$ ./triples
{9, 6, 3}
{9, 6, 3}
{2, 6, 10}
{2, 6, 10}
{3, 3, 3}
Count is: 5
tmp e$ 
```

这个更复杂的版本保留了一个按值索引的 Aj 列表，从 n 立方到 n 平方（有点）。

```
#include <stdio.h>
#include <stdint.h>

static uint32_t arr[] = {9, 4, 2, 3, 6, 10, 3, 3, 10};

#define MAX_VALUE 100000u
#define MAX_ASIZE  30000u

static uint16_t index[MAX_VALUE+1];
static uint16_t list[MAX_ASIZE+1];

static inline void remove_from_index (int subscript)
{
    list[subscript] = 0u; // it is guaranteed to be the last element

    uint32_t value = arr[subscript];

    if (value <= MAX_VALUE && subscript == index[value])
    {
        index[value] = 0u; // list now empty
    }
}

static inline void add_to_index (int subscript)
{
    uint32_t value = arr[subscript];

    if (value <= MAX_VALUE)
    {
        list[subscript] = index[value]; // cons
        index[value] = subscript;
    }
}

int main ()
{
    int i, k;
    int sz = sizeof(arr)/sizeof(arr[0]);
    int count = 0;

    for (i = 0; i < sz - 2; i++)
    {
        for (k = i; k < sz; k++) remove_from_index(k);

        for (k = i + 2; k < sz; k++)
        {
            uint32_t ik = arr[i] + arr[k];
            uint32_t ikdb2 = ik / 2;

            add_to_index(k-1); // A(k-1) is now a legal middle value 

            if ((ikdb2 * 2) == ik) // if ik is even
            {
                uint16_t rover = index[ikdb2];

                while (rover != 0u)
                {
                    count += 1;
                    printf("{%d, %d, %d}\n", arr[i], arr[rover], arr[k]);

                    rover = list[rover];
                }
            }
        }
    }
    printf("Count is: %d\n", count);
} 
```

和运球：

```
tmp e$ cc -o triples triples.c
tmp e$ ./triples
{9, 6, 3}
{9, 6, 3}
{2, 6, 10}
{2, 6, 10}
{3, 3, 3}
Count is: 5
tmp e$ 
```

# list - 打印有序链表

> ID：13240332
> 
> 赞同：1
> 
> 时间：2012-11-05T21:03:20.323
> 
> 标签：list, linked-list, sorted

刚刚对其进行了一些编辑，我尝试了您所说的但它没有用，所以我尝试了一些我更熟悉的东西，但它似乎无法正常工作。它奇怪地打印信息然后崩溃.. 例如：当我输入 9-8-7-6-5-4-3-2-1 然后 0 打印时，它会打印回我 0-0-0-9- 1-2-3-4-5-6-7-8 然后崩溃？当我输入 1-2-3-4-5-6-7-8-9 然后 0 打印时，它会打印回我 0-0-0-1-2-3-4-5-6-7- 8-9然后崩溃。

```
#include <stdio.h>
#include <stdlib.h>

struct listNode{
  int data;    //ordered field
  struct listNode *next;
};

//prototypes
void insertNode(struct listNode *Head, int x);
int printList(struct listNode *Head);
int freeList(struct listNode *Head, int x);

//main
int main(){
     struct listNode Head = {0, NULL};
     int x = 1;
     int ret = 0;
     printf("This program will create an odered linked list of numbers greater"
     " than 0 until the user inputs 0 or a negative number.\n");
     while (x > 0){
           printf("Please input a value to store into the list.\n");
           scanf("%d", &x);
           insertNode(&Head, x);
     }
     ret = printList(&Head);
     }
void insertNode(struct listNode * Head, int x){
     struct listNode *newNode, *current;
     newNode = malloc(sizeof(struct listNode));
     newNode->data = x;
     newNode->next = NULL;
     current = Head;
     while (current->next != NULL && current->data < x) 
     {
        current = current->next;
        }

        if(current->next == NULL){
             current->next = newNode;
        }
        else{
             newNode->next = current->next;
             current->next = newNode;
        }
}
int printList(struct listNode * Head){
    struct listNode *current = Head;
    while (Head != NULL){
          printf("%d \n", *current);
          current = current->next;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T00:38:48.957

```
int printList(struct listNode * Head){
struct listNode *current = Head;
while (Head != NULL){
      printf("%d \n", *current);
      current = current->next;
} 
```

你很接近。

看看你的while循环的条件——你的程序崩溃的原因是'Head'永远不会更新，所以条件总是正确的。所以程序只是保持设置 'current' 等于 'current->next' 而不会停止，直到你到达列表的末尾，此时 'current->next' 为 NULL 并且程序崩溃。

如果您更改 while 循环以检查 'current' 是否为 NULL 而不是 'Head'，它将在到达列表末尾时停止并且您的程序不会崩溃。

编辑：添加一些关于修复显示链接列表的额外零的指针。

```
struct listNode Head = {0, NULL}; 
```

在程序开始时，您在链表中创建一个值为 0 的节点。因此，无论您的输入是什么，您总是至少得到一个 0。您可能会考虑将 Head 初始化为 NULL。如果这样做，则必须在 insertNode 函数中检查该条件。

您还会得到一些额外的零，因为您在获得用于做出该决定的输入*之前*检查您的循环条件 ('while(x > 0)') ('scanf("%d", &x); '）。您可能需要考虑通过使用“do...while”而不是“while”来更改该顺序。请查看[http://www.cprogramming.com/tutorial/c/lesson3.html](http://www.cprogramming.com/tutorial/c/lesson3.html)以了解“do...while”的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:10:05.507

我建议创建一个从第一个节点开始并转到下一个节点的迭代器，直到下一个节点为空，并建议使用类似的下一个而不是列表的结尾（或有下一个）。

然后通过迭代器简单地打印您并打印出值。要插入您从头项目和迭代器开始并比较值。

添加了一些伪代码，因为我不是真正的 C++ 程序员。

```
class iterator
{
    //provide a construction method for this
    listNode current = Head;
    listNode getValue() 
    {
        return current;
    }

    void next()
    {
        //probably want to include some checks for validity here
        current = current->next;
    }

    boolean hasNext()
    {
        return current->next != null;
    }
} 
```

# c# - C#从重写的url获取url参数namevaluecollection

> ID：13240338
> 
> 赞同：0
> 
> 时间：2012-11-05T21:03:53.540
> 
> 标签：c#, url-rewriting, uri, url-parameters, url-parsing

如果 url 没有被重写，这样说

```
&tag=sql&page=3 
```

我会得到这样的参数集合

```
var parameters = HttpUtility.ParseQueryString(uri.Query); 
```

但是如果我有这样的东西

```
/tag/sql-i/page/3/ 
```

那是行不通的。

使用重写的 url 实现相同结果的最佳方法是什么？

谢谢

# joomla - Joomla Community Builder 将字段从 jos_comprofiler 更改为 jos_users

> ID：13240342
> 
> 赞同：0
> 
> 时间：2012-11-05T21:04:10.187
> 
> 标签：joomla

我正在尝试使用 Joomla 的 Community Builder 扩展向用户的个人资料添加一个字段。当我添加该字段时，它会自动将其放入 jos_comprofiler 表中，但我希望该字段位于 jos_users 表中。有没有办法做到这一点？

谢谢！

# php - 将 alt 添加到 imagecopy

> ID：13240347
> 
> 赞同：0
> 
> 时间：2012-11-05T21:04:19.840
> 
> 标签：php, alt

我正在为一个显示锦标赛成就等的游戏部落制作丝带。我生成图像的代码如下...

```
<?php
// Image Variables
$image = imagecreatefrompng("ribbons/ribbonBack.png");
$rib1 = imagecreatefrompng("ribbons/oneYear.png");
// Turn off alpha blending and set alpha flag for png
imagealphablending($image, true);
imagesavealpha($image, true);
// Set ribbons
imagecopy($image, $rib1, 0, 0, 0, 0, 95, 30);
// display ribbons
imagepng($image);
imagedestroy($image);
imagedestroy($rib1);
?> 
```

我的问题是，如何向其中添加替代文本，以便当用户将鼠标悬停在 $rib1 上时，它会给他们一个替代文本来解释该功能区是什么？任何帮助将不胜感激。非常感谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:06:43.273

您正在输出图像的原始二进制文件。这里没有 html，因此没有在哪里设置 alt 属性。解决方案是在图像标签的 src 属性中引用您的脚本：

```
<img src="ribbons.php" alt="Title" /> 
```

# regex - 如何从 bash 中的字符串中提取域名？

> ID：13240348
> 
> 赞同：1
> 
> 时间：2012-11-05T21:04:20.420
> 
> 标签：regex, string, bash, parsing

我正在编写一个 bash 脚本以从以下形式的字符串中提取域：

> ....域名 example.com...

我想输出*example.com*。

如何使用匹配来输出此域名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:11:34.157

您应该更好地定义域的模式，以便在字符串中更好地匹配它。之后，您可以使用 grep 匹配描述您的域模式的正则表达式：

```
domain=`echo "....domain name xxx.com..." | grep -om 1 -G "[^ ]*\.com"` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T03:07:22.390

不假设域名以“.com”结尾

```
grep -oP '(?<=domain name )\S+' 
```

含义：查找字符串“域名”后面的非空白字符序列

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:20:48.320

使用 GNU`grep`

```
 echo "random words domain name example.com random words" | grep -oP  "domain name \K[^ ]+\.com" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T21:12:19.673

如果格式与您所说的完全一样，那么这就足够了：

```
awk '/domain name/{print $3}' 
```

如果字符串存储在变量中，您可以按如下方式使用它：

```
awk '/domain name/{print $3}' <<< $string_name 
```

如果字符串与其他字符串一起存储在文件中，则每行一个：

```
awk '/domain name/{print $3}' < input_file > output_file 
```

# maven - 每个项目多个源文件夹和 jars - maven vs gradle

> ID：13240351
> 
> 赞同：0
> 
> 时间：2012-11-05T21:04:27.530
> 
> 标签：maven, jar, gradle

我需要调查 Maven 和 Gradle 是否提供相同的灵活性来为每个项目为多个源文件夹生成多个 jar 文件。

我知道这通常是不推荐的，但是当涉及到这个要求时，我需要比较两个构建工具的功能/灵活性（多模块 maven 项目结构目前不是一个选项）。

**摇篮**

在 gradle 中，这非常简单：

```
sourceSets {
  main {
    java {
      srcDir 'src'
    }
  }
  other {
    java {
      srcDir 'other'
    }
  }
}
task otherJar(type: Jar) {
    from sourceSets.other.output
    classifier = 'other'
    customName = 'other.jar'
} 
```

使用 gradle 构建它时，类文件的组织方式如下：

```
build
 > classes
     > main
       > com
     > other
       > com 
```

这非常好，因为它可以“回溯”相应类的源文件夹。因此，每个 sourceSet 可能具有相同的包名称，并且仍然可以获得具有正确类的单独 jar 文件。

**马文**

在 Maven 中，这似乎是不可能的。即使可以使用[build-helper-maven-plugin](http://mojo.codehaus.org/build-helper-maven-plugin/usage.html)（用于指定多个源文件夹）和[maven-jar-plugin](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)（用于构建多个 jar 文件）的组合，也只能在包级别拆分源，请参阅[排除，包括](http://www.sonatype.com/people/2010/01/how-to-create-two-jars-from-one-project-and-why-you-shouldnt/)在[maven-jar-plugin](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)中。

据我了解，这是因为编译的类没有根据它们在 maven 中的原始源文件夹组织在**target/classes文件夹中。**

因此，如果需要：

1.  一个项目有多个源文件夹，源文件夹之间可能有同名的包。
2.  为每个源文件夹生成一个 jarfile。

需要使用 gradle（或任何其他提供这种灵活性的构建工具）。还是我错过了 Maven 中提供相同灵活性的一些秘密后门？

# php - Sonata Admin Bundle - 自定义嵌套集的选择字段显示值

> ID：13240355
> 
> 赞同：0
> 
> 时间：2012-11-05T21:04:59.983
> 
> 标签：php, symfony, sonata-admin

我有一个使用嵌套集扩展的实体类型。当我在 Sonata Admin 表单中访问它时，它只是显示为一个基本的选择框，没有级别之间的区别。

如何强制每个选项使用附加的“-”符号显示其级别，以帮助识别嵌套元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:20:47.077

我在 Sonata Admin Bundle 中看不到直接执行此操作的方法，但通过编辑模型的 toString 方法解决了它：

```
public function __toString() {
    return str_repeat('-', $this->lvl).' '.$this->getTitle();
} 
```

# java - Mac jre/jdk 1.7 不工作

> ID：13240356
> 
> 赞同：0
> 
> 时间：2012-11-05T21:05:00.840
> 
> 标签：java, jdk1.6

请耐心等待，因为我不知道所有的技术术语，但这是我的问题：我正在尝试使用从另一个人那里下载到我的计算机（Mac OS X Lion）上的代码。它来自使用 JRE 1.7 的计算机，当我尝试在我的 java 版本（JRE 1.6）上运行它时，它会引发错误。

我已经多次下载并安装了 JRE 1.7，当我尝试从“已安装的 JRE”菜单（系统/库/Java/JavaVirtualMachines）中添加它时，它甚至都不存在。

^ 可能措辞不好，但基本上我无法将 JRE 1.7 添加为我当前的 java 运行时环境。

作为最后的手段，我只想知道如何在 1.6 中使用 1.7 代码（直接复制它仍然会出错）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:08:48.200

如果您使用 DMG 安装了 JDK 7，请检查此位置是否存在？

/Library/Java/JavaVirtualMachines/jdk1.7..jdk/Contents/Home

如果是，请在此位置添加一个新的 JRE，它应该可以工作。

它对我有用，我的 Macbook 中同时安装了 Java 6 和 Java 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:35:51.513

我不知道您如何在 Mac 上安装 JDK 7，但是...

> 作为最后的手段，我只想知道如何在 1.6 中使用 1.7 代码（直接复制它仍然会出错）。

您很可能会收到异常，告诉您类文件版本号不正确。类文件版本号在 Java 6 和 Java 7 之间递增，这意味着为 Java 7 编译的应用程序不会在 Java 6 上运行。

一个可行的选择是让其他人使用“-source 1.6 -target 1.6”编译代码*。*但是，这仅在以下情况下有效：

*   该代码不使用任何新的 Java 7 语法扩展，并且
*   该代码不使用任何 Java 7 特定的类或方法。

# javascript - Facebook UI 提要大小未调整

> ID：13240357
> 
> 赞同：2
> 
> 时间：2012-11-05T21:05:02.257
> 
> 标签：javascript, facebook, sdk, sencha-touch-2

Fb.UI 提要没有以正确的宽度显示，当对话框呈现时它不会调整到屏幕大小，除了 iphone 4 和 4s。用我的 ipod touch，和 android 它比屏幕还大。我正在使用 sencha touch 框架。有没有办法调整对话框的大小。我尝试使用 FB.UIServer.Methods["fbml.dialog"].size = {width:300, height:555}; 但它说 FB.UIServer 未定义。

任何帮助将不胜感激

```
function publishStory() {
    FB.ui({
        access_token:accsstkn,
        method: 'feed',
        name: 'APP',
        caption: 'caption',
        display: 'touch',
        description: description,
        link: 'https://',
        picture: img,
    }, 

    function(response) {
        if (response && response.post_id) {
            alert('Successfully Saved');
            var postid = response.post_id;
            return response.post_id;
        } else {
            alert('Try Again');
        }
    }
    );

    return false;
}

publishStory(); 
```

# grails - grails 2.1.1 自定义验证器的命令对象服务注入

> ID：13240358
> 
> 赞同：0
> 
> 时间：2012-11-05T21:05:09.887
> 
> 标签：grails, customvalidator, command-objects

圣杯 2.1.1

我似乎无法获得要注入服务的命令对象，以便我可以使用自定义验证器。我已经尝试了几件事，包括 [Grails 命令对象数据绑定](https://stackoverflow.com/questions/5677623/grails-command-object-data-binding)和自定义验证器上的 2.1.1 文档所建议的内容，我只是想不通这个..

相关代码：

```
class RegistrationCommand {

    String username

    def registrationService
    static constraints = {

        username validator: { val, obj ->
            obj.registrationService.isUsernameUnique(val) }
    }
}

class RegistrationService {

    def isUsernameUnique(username){
        def user = new User(username:username)
        user.validate()
        if(user.errors.hasFieldErrors("username")){
            return false
        }else{
            return true
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:04:49.003

**已解决..问题是由于插件。** 我正在使用一个插件进行客户端 jquery 验证（jquery-validation-ui-1.4.2）。插件控制器创建的命令对象没有被注入服务。报告了该问题[https://github.com/limcheekin/jquery-validation-ui/issues/17](https://github.com/limcheekin/jquery-validation-ui/issues/17)。该修复确实有效，但尚未推送到上游。

# android - 如何将基于存储在 MySQL 数据库中的文件名的图像加载到 Android App 中

> ID：13240363
> 
> 赞同：0
> 
> 时间：2012-11-05T21:05:28.370
> 
> 标签：android

所以，我有一个 Android 应用程序，它本质上是一个`ListView`（**MainActivity**，`fill_parent`）。并详细说明活动（**DetailsActivity**），其中`TextViews`包含**Name**、**Phone**和**Email**。

**您点击MainActivity**中的列表项以启动**DetailsActivity**以查看有关列表中所选项目的更多信息。

有一个**MySQL**数据库，其中包含一个表，其中包含每个人的**ID**、**Name**、**Phone**、**Email**和**Image**列。**图像**列只是一个`VARCHAR`包含每个记录的相应图像的文件名。

数据库和安卓应用程序之间是**PHP**网络服务。它用于获取所有人（**get_all.php**，用于`ListView`填充），还用于根据传递给特定人员的**ID** （填充）获取有关特定人员的详细信息（ **get_details.php**）。**`DetailsActivity`**

 **我假设`ImageView`必须使用小部件（DetailsActivity 布局）来显示图像，所以这不是问题。

我遇到的问题是我应该在哪里存储实际图像以便在`DetailsActivity`为一个人启动时将它们拉入应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:13:23.450

您应该使用缓存您的图片到 SDCard。

这是一个很棒的库，可以帮助您实现它：

[http://androidimageloader.com/](http://androidimageloader.com/)

因此，您将在 SDCard 上拥有所有缩略图。

当您打开 DetailActivity 时，您将在 SDCard 上复制全尺寸图片。**

# iphone - 在 RemoteViewControllers 上禁用 UIAppearance-API

> ID：13240364
> 
> 赞同：3
> 
> 时间：2012-11-05T21:05:36.323
> 
> 标签：iphone, objective-c, ios, ios6, uiappearance

所以我使用apprearance api来设计我所有的观点。菲我风格我的`UINavigationBar`使用：

```
[[UINavigationBar appearance] setBackgroundImage:navigationBarBgImage forBarMetrics:UIBarMetricsDefault]; 
```

我想利用外观 api 的优势，`UINavigationBar`在一个地方设计我的所有 s（因为我有多个），所以我不想仅仅因为造型原因而做一些子类化。

我还弹出一些`MFMessageComposeViewController`s 和 a`SLComposeViewController`以发布到 imessage 或 facebook。

我的问题是，如果我尝试在 facebook 上选择相册或在 imessage modalview 上选择联系人，则会发生这种情况：

![在此处输入图像描述](../Images/131723f892368e8c660b84ecb0ca4eb3.png)

查看 imessage 模态视图的递归描述：

```
$0 = 0x1f1f1320 <UIWindow: 0x1e5c8900; frame = (0 0; 320 568); layer = <UIWindowLayer: 0x1e5c8a00>>
   | <UILayoutContainerView: 0x1e592860; frame = (0 0; 320 568); autoresize = W+H; layer = <CALayer: 0x1e592910>>
   |    | <UINavigationTransitionView: 0x1f1c88a0; frame = (0 0; 320 568); clipsToBounds = YES; autoresize = W+H; layer = <CALayer: 0x1f1c8960>>
   |    |    | <UIViewControllerWrapperView: 0x1f1ee090; frame = (0 20; 320 548); autoresize = W+H; layer = <CALayer: 0x1f2f9560>>
   |    |    |    | <UIView: 0x1f2f3d20; frame = (0 0; 320 548); autoresize = W+H; layer = <CALayer: 0x1f2f3d80>>
   |    |    |    |    | <_UISizeTrackingView: 0x1f2effd0; frame = (0 0; 320 548); clipsToBounds = YES; autoresize = W+H; layer = <CALayer: 0x1f2f00b0>>
   |    |    |    |    |    | <_UIRemoteView: 0x1f2f01e0; frame = (0 0; 320 568); transform = [0.5, -0, 0, 0.5, -0, 0]; userInteractionEnabled = NO; layer = <CALayerHost: 0x1f2f0330>> 
```

有什么想法最好切换回默认模式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T11:18:02.990

您最好的选择实际上是对一件事或另一件事进行子类化。否则，您将在任何地方撤消样式。我将通过以下两种方式之一进行：

一种是对该类`UINavigationController`所包含的内容进行子类化和样式化`UINavigationBar`：

```
UINavigationBar *navigationBarProxy = [UINavigationBar appearanceWhenContainedIn:[MyNavigationController class], nil]; // 
[navigationBarProxy setBackgroundImage:navigationBarBackgroundImage forBarMetrics:UIBarMetricsDefault];
// and so on 
```

另一种方法是子类`UINavigationBar`化，设置该类的外观，并以`UINavigationController`这种方式实例化你：

```
UINavigationController *navigationController = [[UINavigationController alloc] initWithNavigationBarClass:[MyNavigationBar class] toolbarClass:nil];
// navigationController now has a navigationBar of your preferred type 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:12:19.107

好吧，可能的解决方案是将导航栏设置为它们的原始色调`[UINavigationBar appearanceWhenContainedIn:[SLComposeViewController class]] ...`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T06:21:40.733

我遇到了同样的问题，更糟糕的是，它导致我的应用程序在任何基于 XPC/UIRemoteView 的控制器上崩溃，包括 SLComposeViewController 和 MFMailComposeViewController。

我的解决方案是使用这个：

```
[[UINavigationBar appearanceWhenContainedIn:[RootViewController class], nil] setBackgroundImage:[UIImage imageNamed:@"navbar.png"] forBarMetrics:UIBarMetricsDefault]; 
```

代替：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"navbar.png"] forBarMetrics:UIBarMetricsDefault]; 
```

其中 RootViewController 是您命名的 UIViewController，它包含您应用的所有子视图。

它并不适用于所有事情（取决于控制器在层次结构中的结束方式），但是，嘿，它是某种东西。

# c# - 使用 memorystream 接收内存不足异常

> ID：13240365
> 
> 赞同：1
> 
> 时间：2012-11-05T21:05:40.450
> 
> 标签：c#, memory-management, kaltura

我正在尝试编写一个可以与开源媒体管理平台 Kaltura 一起使用的应用程序。Kaltura 提供了一些与他们的 Web API 对话的 C# 客户端库，我已经能够与服务器对话并成功上传视频。我遇到的问题是，一旦文件达到一定大小，我就会收到内存不足异常并且程序崩溃。我想尝试解决这个问题并将改进的代码提交回开源项目，但是对于 C# 来说是新手，我不知道从哪里开始。有没有比 memorystream 更好的方法来做他们正在做的事情？

提前致谢。

```
//Problematic code

private void PostMultiPartWithFiles(HttpWebRequest request, KalturaParams kparams, KalturaFiles kfiles)
    {
        string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
        request.ContentType = "multipart/form-data; boundary=" + boundary;

        // use a memory stream because we don't know the content length of the request when we have multiple files
        MemoryStream memStream = new MemoryStream();

        byte[] buffer;
        int bytesRead = 0;

        StringBuilder sb = new StringBuilder();
        sb.Append("--" + boundary + "\r\n");
        foreach (KeyValuePair<string, string> param in kparams)
        {
            sb.Append("Content-Disposition: form-data; name=\"" + param.Key + "\"" + "\r\n");
            sb.Append("\r\n");
            sb.Append(param.Value);
            sb.Append("\r\n--" + boundary + "\r\n");
        }

        buffer = Encoding.UTF8.GetBytes(sb.ToString());
        memStream.Write(buffer, 0, buffer.Length);

        foreach (KeyValuePair<string, FileStream> file in kfiles)
        {
            sb = new StringBuilder();
            FileStream fileStream = file.Value;
            sb.Append("Content-Disposition: form-data; name=\"" + file.Key + "\"; filename=\"" + Path.GetFileName(fileStream.Name) + "\"" + "\r\n");
            sb.Append("Content-Type: application/octet-stream" + "\r\n");
            sb.Append("\r\n");

            // write the current string builder content
            buffer = Encoding.UTF8.GetBytes(sb.ToString());
            memStream.Write(buffer, 0, buffer.Length);

            // write the file content
            buffer = new Byte[checked((uint)Math.Min(4096, (int)fileStream.Length))];
            bytesRead = 0;
            while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
                memStream.Write(buffer, 0, bytesRead);

            buffer = Encoding.UTF8.GetBytes("\r\n--" + boundary + "\r\n");
            memStream.Write(buffer, 0, buffer.Length);
        }

        request.ContentLength = memStream.Length;

        Stream requestStream = request.GetRequestStream();
        // write the memorty stream to the request stream
        memStream.Seek(0, SeekOrigin.Begin);
        buffer = new Byte[checked((uint)Math.Min(4096, (int)memStream.Length))];
        bytesRead = 0;
        while ((bytesRead = memStream.Read(buffer, 0, buffer.Length)) != 0)
            requestStream.Write(buffer, 0, bytesRead);

        requestStream.Close();
        memStream.Close();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:42:57.687

这是一个或多或少的版本，我将如何编写它。它只编译，但我还没有测试过。注意使用 StreamWriter 和直接使用请求流...

```
public class SendStuff
    {
        private readonly HttpWebRequest _request;
        private readonly Dictionary<string, string> _kparams;
        private readonly Dictionary<string, FileStream> _kfiles;
        readonly string _boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");

        public SendStuff(
            HttpWebRequest request, 
            Dictionary<string, string> kparams, 
            Dictionary<string, FileStream> kfiles)
        {
            _request = request;
            _kparams = kparams;
            _kfiles = kfiles;
            _request.ContentType = "multipart/form-data; boundary=" + _boundary;
        }

        public void Do()
        {

            // Based on HTTP 1.1, if the server can determine the content length, it need not insist on
            // us sending one. If you are talking
            // to a "special" server, construct the headers beforehand, measure their length
            // and identify the file lengths of the files to be sent.

            using (var reqStream = _request.GetRequestStream())
            using (var writer = new StreamWriter(reqStream))
            {
                writer.NewLine = "\r\n";
                WriteBoundary(writer);
                WriteParams(writer);

                foreach (var file in _kfiles)
                {
                    writer.WriteLine("Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"", 
                        file.Key, 
                        Path.GetFileName(file.Value.Name));
                    writer.WriteLine("Content-Type: application/octet-stream");
                    writer.WriteLine();

                    WriteTheFileContent(reqStream, file.Value);

                    WriteBoundary(writer);
                }
            }
        }

        private static void WriteTheFileContent(Stream reqStream, Stream fileStream)
        {
            int bytesRead;
            var buffer = new byte[4096];
            while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
                reqStream.Write(buffer, 0, bytesRead);
        }

        private void WriteParams(StreamWriter writer)
        {
            foreach (var param in _kparams)
            {
                writer.WriteLine("Content-Disposition: form-data; name=\"{0}\"", param.Key);
                writer.WriteLine();
                writer.WriteLine(param.Value);
                WriteBoundary(writer);
            }
        }

        private void WriteBoundary(TextWriter writer)
        {
            writer.WriteLine("\r\n--{0}\r\n", _boundary);
        }
    } 
```

# objective-c - 将浮点数从一个视图控制器传递到另一个视图控制器

> ID：13240369
> 
> 赞同：0
> 
> 时间：2012-11-05T21:06:12.580
> 
> 标签：objective-c, ios6, floating-point, xcode4.5, primitive-types

确实是一个非常愚蠢的问题，但我对编程世界很陌生，遇到了这个问题，我试图将浮点变量从一个视图控制器传递到另一个视图控制器。我找到了一种使用字符串的好方法，但我无法让它与浮点数一起使用。有什么建议么？

非常感谢您的帮助！

```
//Passing the data in first view controller
float savedAudioLevel = _slAudioVolume.value;
NSUserDefaults *defaultsAudio = [NSUserDefaults standardUserDefaults];
[defaultsAudio setFloat:savedAudioLevel forKey:@"currentAudioLevel"];
[defaultsAudio synchronize];

//Receiving the data in second
NSUserDefaults *defaultsAudio = [NSUserDefaults standardUserDefaults];
float loadfloatAudio = [defaultsAudio valueForKey:@"currentAudioLevel"]; //Getting an error here
_currentAudioVolume = loadfloatAudio; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:07:41.097

如果[将 " `float`" 嵌入到 " `NSNumber`" 对象](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/clm/NSNumber/numberWithFloat%3a)中，您可能会更轻松，这是一个可以更轻松地传递的原生 Objective C 对象。

[“ `valueForKey`”，至少在“ `NSDictionary`”对象](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDictionary/valueForKey%3a)上调用时，仅在执行 KVC 时适用于 NSStrings。

# c++ - Eclipse - 项目得到不存在的错误

> ID：13240371
> 
> 赞同：1
> 
> 时间：2012-11-05T21:06:17.260
> 
> 标签：c++, eclipse

我目前正在使用 Eclipse 和 C/C++，直接从 Eclipse 网站安装。出于某种原因，我的项目（“DDSAssign2”）由于项目中的错误而无法运行，尽管我的一个源代码文件没有任何错误。它只是显示在 Project Explorer 中的项目图标上。今年夏天我偶尔会在使用 Eclipse Juno 和 Android 开发工具时遇到这个问题，但这似乎总是意味着 Manifest 文件中存在错误，我知道 C++ 不应该存在这个问题，尽管我认为这可能意味着存在可能是一些有错误的文件，但我只有源文件，MinGW 包括，以及可执行二进制文件和可执行文件进行调试。

这是代码。代码本身的编辑器没有给出任何错误，而且它运行得更早。红色错误图标仅显示在整个项目的项目资源管理器中。

```
#include <iostream>
#include <stdlib.h>
#include <time.h>

using namespace std;

struct stud
{
int id;
double gpa;
char className;
struct stud *next;
};

struct stud *add(struct stud *top);
void show(struct stud *top);

int main()
{
struct stud *top = NULL;
srand(time(NULL));

int x = 0;
while (x == 0)
{
    top = add(top);
    cout << "Press [0] to continue, any other integer to quit.";
    cin >> x;
}
show(top);
return 0;
}

struct stud *add(struct stud *top)
{
struct stud *dum;
dum = (struct stud *)malloc(sizeof(struct stud));
cout << "What is the student's ID?" << endl;
cin >> dum->id;
cout << "What is the their GPA?" << endl;
cin >> dum->gpa;
cout << "What is their class?" << endl;
cin >> dum->className;

if (top == NULL)
{
    top = dum;
}
else
{
    while (top != NULL)
    {
        if (top->next == NULL)
                        top->next = dum;
        if (dum->id < top->id)
        {
            struct stud *dum2 = top->next;
            if (dum->id < dum2->id)
            {
                dum->next = top->next;
                top->next = dum;
            }
        }
        top = top->next;
    }
}
return top;
}

void show(struct stud *top)
{
if (top == NULL)
{
    cout << "Stack is empty.";
}
while (top != NULL)
{
    cout << "ID: " << top->id << endl;
    cout << "GPA: " << top->gpa << endl;
    cout << "Class: " << top->className << endl;
    top = top->next;
}
} 
```

我想知道的另一件事是是否是因为项目的名称。我已经重新制作了这个“DDSAssign2”项目几次，试图摆脱这个问题，最后一次我无法从 Eclipse 中删除工作区中的内容，所以我只需要手动完成。

# css - 以相对方式绝对定位一个部门

> ID：13240372
> 
> 赞同：0
> 
> 时间：2012-11-05T21:06:17.727
> 
> 标签：css, position, positioning, css-position

我不太确定如何表达我的问题，但这些是我的想法：

**我的理解：**鉴于 div-B 嵌套在 div-A 中...

我可以在 div-A 上设置相对定位，以便 div-A 中的任何元素都将相对于 div-A 定位。然后，如果我在 div-B 上设置绝对定位，我可以将它移动到 div-A 的右上角。

```
#div-A {
 position:relative;
}
#div-B {
 position:absolute;
 top:0;
 right:0;
} 
```

此外，如果我删除 div-A 部分并留下...

```
#div-B {
 position:absolute;
 top:0;
 right:0;
} 
```

div-B 将自己定位在窗口的右上角或它包含在其中的第一个相对定位的容器中。

**我的问题：**看到相对定位的容器内的分区可以使用绝对定位放置在该容器边界处，有没有办法绝对定位一个分区但相同的分区以相对方式处理其中包含的元素？也就是说，是否可以对容器进行绝对定位并使其包含的元素相对于自身进行绝对定位？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:22:44.510

恐怕定位并不像你想象的那样工作。`position: relative;`与元素本身有关，与嵌套元素的定位无关（除非您`position: inherit;`在子元素中使用）。请参阅W3.org 上的[CSS2.1](http://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html#choose-position)。

# rails-engines - 已安装的 Rails 引擎中的 HttpHelpers 路由方法导致未初始化的常量“控制器名称”

> ID：13240377
> 
> 赞同：1
> 
> 时间：2012-11-05T21:06:47.097
> 
> 标签：rails-engines, uninitialized-constant

我的环境：

*   导轨 3.2.8
*   红宝石 1.9.3p194
*   Fedora 16 x86_64

这个问题似乎是 Rails 引擎特有的。

似乎`HttpHelpers`在 Rails 引擎的路由文件中使用时，我在通过浏览器访问路由时得到“未初始化的常量控制器”。但是，如果我在引擎的路由文件中使用 URL 匹配器，它会正确路由。

以下是我创建失败示例的方法：

```
$ rails plugin new my_engine --mountable
$ cd my_engine
$ rails g controller things index
$ rails s -p 3005 
```

控制器生成器`HttpHelpers#get`默认使用该方法，因此此时 Rails 引擎的`config/routes.rb`文件如下所示：

```
MyEngine::Engine.routes.draw do
  get "things/index"

end 
```

而且，`test/dummy`应用程序的`config/routes.rb`文件如下所示：

```
Rails.application.routes.draw do

  mount MyEngine::Engine => "/my_engine"
end 
```

所以，我应该能够从引擎中点击`http://locahost:3005/my_engine/things/index`并查看**Things#index视图。**但是，我在浏览器中看到：

> 路由错误
> 
> 未初始化的常量 ThingsController

如果我手动将引擎的`config/routes.rb`文件更改为：

```
MyEngine::Engine.routes.draw do
  #get "things/index"
  match "things/index" => "things#index"

end 
```

...然后点击`http://locahost:3005/my_engine/things/index`，我看到了正确的**Things#index**视图。

我注意到，当我使用`HttpHelpers#get`引擎`config/routes.rb`文件中的方法并`rake routes`从`test/dummy`目录运行时，我看到：

```
$ rake routes
my_engine  /my_engine MyEngine::Engine

Routes for MyEngine::Engine:
things_index GET /things/index(.:format) things#index 
```

但是，如果我更改引擎的`config/routes.rb`文件以使用 URL 匹配器方法，我会看到：

```
$ rake routes
my_engine  /my_engine MyEngine::Engine

Routes for MyEngine::Engine:
things_index  /things/index(.:format) my_engine/things#index 
```

请注意，当使用 URL 匹配器时，控制器和操作在引擎下正确命名。而在使用 时`HttpHelpers#get`，控制器和操作似乎是非命名空间的。

所以，我的问题是：我在这里做错了吗？或者，这是一个错误？

注意：我搜索了 rails 问题，没有看到任何与此直接相关的内容。虽然我确实看到了其他几个引擎和路由问题。

# iis-7.5 - 尝试访问存在的文件时出现 404

> ID：13240380
> 
> 赞同：0
> 
> 时间：2012-11-05T21:07:12.960
> 
> 标签：iis-7.5, mime-types, windows-server-2008-r2

我在尝试访问浏览器中的文件时遇到问题，它显示“404 - 找不到文件”，但我知道该文件确实存在。我只能访问它一次，然后当我刷新它时再次进入 404 模式。

当我删除文件时，当文件存在时会出现不同类型的 404 消息。有谁知道我做错了什么？

*   服务器操作系统：Windows Server 2008 R2
*   IIS 版本：7.5
*   文件名：loop.mp4

我确实在服务器上将 .mp4 扩展名的 mime 类型设置为 video/mp4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T21:47:35.207

今天有人提示我做一些请求跟踪并查看完整的状态码，即 404.3。这意味着我没有在服务器上设置正确的 mime 地图。我在服务器级别而不是在站点级别添加了 mime 类型，现在它就像一个魅力。无论如何，谢谢你试图帮助我:)

# ruby-on-rails - JSON 渲染：如何包含左括号描述？

> ID：13240383
> 
> 赞同：1
> 
> 时间：2012-11-05T21:07:33.270
> 
> 标签：ruby-on-rails

我有一些像这样输出 JSON 的 Ruby 代码：

```
def nearby
  #@bathrooms = Bathroom.geo_scope(:origin =>[params[:lat],[params[:lon]]], :within => 5)
  lat = params[:lat]
  lon = params[:lon]
  #@bathrooms = Bathroom.geo_scope(:within => 5, :origin => [45.580639,-122.677682], :order=>'distance')
  @bathrooms = Bathroom.geo_scope(:within => 3, :origin => [lat,lon], :order=>'distance')
  respond_to do |format|
    format.json  { render :json => @bathrooms }
    format.js   { render :nothing => true } 
  end   
end 
```

结果是这样的：

```
 [{"ID":129,"access":"1","avail":"0","bathroomtype":"0","city":"PORTLAND","comment":"","country":"US","created":"0000-00-00 00:00:00","directions":"The two bathrooms are in the long hallway at the back of the restaurant, past the bar.","distance":"2.94986114636676","lat":"45.539217","lon":"-122.661795","modifed":"0000-00-00","name":"Echo","postal":"97212-3727","slug":"echo-portland170","source":"","state":"OR","street":"2225 NE Martin Luther King Jr. Blvd"}, 
```

我不知道该怎么做就是给集合命名？例如，在第一个封闭括号之后，我想命名设置的浴室。我怎么能做到这一点是Rails？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:20:44.633

尝试：

```
render json: { bathrooms: @bathrooms } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:24:10.830

看起来@bathrooms 是一个列表，因此您不能将键分配给列表中的元素。您需要先制作地图。例如，如果您只想要第一个元素：

```
format.json { render :json => {:bathrooms => @bathrooms[0]} } 
```

设置所有列表元素：

```
format.json { render :json => {:bathrooms => @bathrooms} } 
```

# java - Java，扫描大文件，findWithinHorizo n(p, 0) 抛出异常 java.lang.StackOverflowError

> ID：13240385
> 
> 赞同：0
> 
> 时间：2012-11-05T21:07:33.800
> 
> 标签：java, regex, exception, java.util.scanner

以下是我的代码的快照，输入文件大小为 45 Mb

```
Scanner fileScanner = new Scanner(file);
String scannedFarm;
try{

    Pattern p = Pattern.compile("^(?:.+(?:\\r?\\n|\\Z)){2,}",Pattern.MULTILINE);

    while((scannedFarm = fileScanner.findWithinHorizon(p, 0)) != null){ // Throws Exception
    ...
    ... 
```

我将添加任何其他信息，以阐明引发异常的原因。描述文件格式的相关问题可能会有所帮助：[Java，正则表达式 HasNext 以空行开头，多平台支持](https://stackoverflow.com/questions/13232689/java-regular-expression-hasnext-starts-with-empty-line-multi-platform-support)。

顺便说一句：这适用于像魅力这样的小文件，在较大的文件中失败，字符串是否具有从 findWithinHorizo​​n 返回的最大大小？

**更新**

根据要求，一个小的堆栈跟踪：

[http://pastebin.com/dcJ1jdkf](http://pastebin.com/dcJ1jdkf)

还有一个文件快照的小例子：

[http://pastebin.com/EYMsbrKj](http://pastebin.com/EYMsbrKj)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:16:37.020

我不知道`Scanner`该类的工作原理，但是无论`.findwithinHorizon()`对正则表达式做什么，该正则表达式都非常奇怪。

只要每一行至少有一个字符长，这个正则表达式就会一次匹配整个文件。如果有空行，那么它将匹配跨越至少两行的空行之间的所有块。如果这就是你真正打算做的，有一个更好的方法来做到这一点：

```
Pattern p = Pattern.compile("(?:^.+$(?:\\r?\\n)?){2,}", Pattern.MULTILINE); 
```

为了避免对正则表达式引擎进行不必要的回溯，您可以使所有量词都[具有所有格](http://www.regular-expressions.info/possessive.html)：

```
Pattern p = Pattern.compile("(?:^.++$(?:\\r?+\\n)?+){2,}+", Pattern.MULTILINE); 
```

有或没有所有格量词，这个正则表达式匹配如下：

![屏幕截图 RegexBuddy](../Images/acbf00585fc2127551a71f5b1de32a84.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:48:18.117

我认为你会更容易匹配标记本身而不是分隔符。这就是该`findWithinHorizon()`方法的真正用途：Scanner 首选操作模式的替代方案，由`hasNextXXX()`and`nextXXX()`方法表示。

```
"(?m)^\\w+;\\w+$(?:\r?\n\\w+(?:;\\w+)+$)+" 
```

您没有详细说明您的数据格式，所以我只使用了与您的示例匹配的最简单的正则表达式。

# regex - Perl - 收集所有 STDIN 直到空白行或 EOF

> ID：13240389
> 
> 赞同：1
> 
> 时间：2012-11-05T21:07:46.253
> 
> 标签：regex, arrays, perl, stdin

如何从 STDIN 行中收集所有行，直到出现空白行或 EOF，以先到者为准。它看起来像：

```
 my @lines;

 while(<> ne EOF || <> not blank) {
      chomp;
      push(@lines, $_);
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-05T21:28:08.610

要停止读取 EOF 或空行上的输入，我更喜欢这个解决方案：

```
while (<>) {
    last unless /\S/;
    # do something with $_ here...
} 
```

与 mob 的解决方案不同，这不会在 EOF 上发出有关“*在模式匹配 (m//) 中使用未初始化值 $_ ”的警告。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:10:15.410

如果“空白”行表示里面没有字符，只有换行符`\n`（Unix）或`\r\n`（Windows），那么使用

```
my @lines;
/^$/ && last, s/\r?\n$//, push(@lines, $_) while <>; 
```

（见[这个演示](http://ideone.com/rNhpPF)）

* * *

如果“空白”行内部应该有任意数量的空格，例如`"         "`，则使用

```
my @lines;
/^\s*$/ && last, s/\r?\n$//, push(@lines, $_) while <>; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:30:39.420

这只会检查EOF：

```
while (<>) {
    s/\s+\z//;
    push @lines, $_;
} 
```

所以你需要添加一个空行检查：

```
while (<>) {
    s/\s+\z//;
    last if $_ eq "";
    push @lines, $_;
} 
```

* * *

或者，

```
while (<>) {
    s/\s+\z//;
    push @lines, $_;
} 
```

简称

```
while (defined( $_ = <> )) {
    s/\s+\z//;
    push @lines, $_;
} 
```

所以如果你想要条件中的整个`while`条件，你会使用

```
while (defined( $_ = <> ) && /\S/) {
    s/\s+\z//;
    push @lines, $_;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T21:20:15.303

要在 EOF 或空行上中断：

```
while ( ($_ = <>) =~ /\S/ ) {
   chomp;
   push @lines, $_;
} 
```

`/\S/`测试输入是否包含任何非空格。

# ios - 如何截取 iPhone5 应用程序的屏幕截图？

> ID：13240393
> 
> 赞同：4
> 
> 时间：2012-11-05T21:08:06.910
> 
> 标签：ios

应用商店需要 iPhone5 截图：

“为了保存您的更改，所有 iPhone 5 和 iPod touch（第 5 代）屏幕截图必须是 1136x640、1136x600、640x1136 或 640x1096 像素的 .jpeg、.jpg、.tif、.tiff 或 .png 文件，在至少 72 DPI，并且在 RGB 颜色空间中。”

我试过使用 iOS 模拟器并使用屏幕截图选项，但是这个文件太小了。

有谁知道如何拍摄更高分辨率的照片？

我会使用设计文件，但其中没有真实数据，这会使我的应用程序看起来很傻！

任何帮助将不胜感激 - 论坛和大约三个小时的谷歌搜索让我失望:(

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:42:32.907

我使用[iOS-Simulator Cropper](http://www.curioustimes.de/iphonesimulatorcropper/)来捕获屏幕截图。它会自动从顶部删除运营商信息；状态栏。

![在 OSX 上运行的应用程序的屏幕截图](../Images/0c2dc892606d91704b645de1e001305a.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-05T21:20:05.933

使用您的模拟器并使用 control + command + C。这将仅复制模拟器的屏幕。打开预览，然后从剪贴板文件->新建。这远远优于尝试使用 command-shift-4 进行猜测。

希望有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T13:38:27.717

1.  从 xCode 4.x 启动 iOS 模拟器
2.  在模拟器中，选择设备类型。
3.  在顶部菜单“文件”>“保存屏幕截图”中
4.  在 Finder 'iOS Simulator Screen .....' 中找到文件

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-05T23:39:14.827

使用此代码截取任何视图的屏幕截图。我已经用过了。

```
- (void)mapViewDidFinishLoadingMap:myMapView
{
    [self captureScreenInRect:CGRectMake(0, 0, 320, 480)];
}

- (UIImage *)captureScreenInRect:(CGRect)captureFrame
{
    CALayer *layer;
    layer = myMapView.layer;
    UIGraphicsBeginImageContext(myMapView.frame.size); 
    CGContextClipToRect (UIGraphicsGetCurrentContext(),captureFrame);
    [layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *screenImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    UIImageWriteToSavedPhotosAlbum(screenImage, nil, nil, nil);
    return screenImage;
} 
```

# iphone - 如何检查设备是 iPhone 5？

> ID：13240404
> 
> 赞同：8
> 
> 时间：2012-11-05T21:08:53.820
> 
> 标签：iphone, ios

如何检查应用程序是否在 iPhone 5 上运行然后执行某些操作？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-05T21:13:34.070

```
#define IS_IPHONE_5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON ) 
```

然后在代码中：

```
if (IS_IPHONE_5) { 
   //is iphone 5
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-05T21:12:36.413

您可能关心窗口大小，而不是品牌/型号，这会：

```
CGRect screenRect = [[UIScreen mainScreen] applicationFrame];
if (screenRect.size.height == 568)
{
 // this is an iPhone 5+
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-05T21:47:11.640

您可以通过检查屏幕分辨率来做到这一点，也可以使用以下方法来做到这一点：

```
#import "sys/utsname.h" 
```

它为您提供每个设备的标识符。只需在此处查看我的答案：[识别设备](https://stackoverflow.com/questions/13046338/best-way-to-detect-hardware-type-iphone4-or-iphone5/13046400#13046400)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-19T14:06:02.287

使用屏幕很好。

```
#define IS_IPAD (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
#define IS_IPHONE (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
#define IS_IPHONE_5 (IS_IPHONE && [[UIScreen mainScreen] bounds].size.height == 568.0f) 
```

不需要进行 epsilon 检查

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T10:21:15.787

我们可以直接将此方法放在常量文件中，并且可以在任何使用define的地方使用

```
#define ISIPHONE5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON )
#define HEIGHT (ISIPHONE5 ? 60:145) 
```

或者可以使用

```
 #define IS_IPHONE5 (([[UIScreen mainScreen] bounds].size.height-568)?NO:YES) 
```

我们也可以通过以下方式检查 IOS

```
#define IOS_OLDER_THAN_6 ([[[UIDevice currentDevice] systemVersion] floatValue] < 6.0 )
#define IOS_NEWER_OR_EQUAL_TO_6 ([[[UIDevice currentDevice] systemVersion] floatValue] >= 6.0 ) 
```

* * *

## 回答 #6

> 赞同：-11
> 
> 时间：2012-11-05T23:35:22.737

您可以检查您设备的 iOS 版本，如果是 6.0，那么它是 iPhone 5 .....

这是代码..

```
double osVersion = [[[UIDevice currentDevice] systemVersion] doubleValue];
NSLog(@"OSVersion: %f", osVersion);
if (osVersion == 6.0) 
{
  //Paste your code here.....
} 
```

# algorithm - 短路前缀布尔表达式

> ID：13240408
> 
> 赞同：0
> 
> 时间：2012-11-05T21:09:02.057
> 
> 标签：algorithm, language-agnostic, short-circuiting, postfix-notation

我有一堆用前缀表示法（也称为[波兰表示法](http://en.wikipedia.org/wiki/Polish_notation)）编写的布尔表达式。这种格式的嵌套表达式很容易计算（参见维基百科文章中的算法）。

但是，Wikipedia 页面上给出的算法不会进行短路（当它评估 时`and f() g()`，它不会跳过`g()`if`f()`为 false 的评估）。有没有办法修改算法以包括短路？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-17T18:10:05.970

我最近需要这样做，并想出了一个似乎可行的算法：

1.  使用调车场解析表达式，生成后缀术语系列。

2.  找到每个术语的父运算符并存储偏移量。

    ```
    for term in terms:
        count = 0
        for next in remaining terms:
            if next type is function:
                count = count - (argument count - 1)
            else if next type is operator:
                count = count - 1
            else:
                count = count + 1
            if count is 0:
                next is term's parent
                offset = next - term 
    ```

3.  评估通常的方法并在每次操作后检查是否短路。如果适用，在父学期之后跳到学期。

    ```
    for term in terms:
        if term is operator:
            pop 2 values
            evaluate (in reverse order)
            push result value
            if short-circuit (result is 0 and parent is AND, or result is non-zero and parent is OR):
                term = term + offset
        else if term is function:
            pop arguments
            evaluate (in reverse order)
            push result value
        else:
            push term value 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:32:40.273

您可以使用相同的算法来构建表达式树：而不是评估`operand1 operator operand2`，创建一个以`operand1`和`operand2`作为子节点和`operator`作为父节点的节点。

一旦你有了树，你就可以评估它（从上到下）。您可以通过不评估其中一个孩子来缩短评估（例如，如果左孩子评估为`False`并且运算符为`and`）。

您会注意到给定的算法等效于从下到上的评估。虽然这很简单（并且可以节省内存），但您不能应用短路，因为您永远不知道是否应该评估您所在的分支。

# hadoop - 映射步骤后的 Hadoop EOF 异常

> ID：13240409
> 
> 赞同：0
> 
> 时间：2012-11-05T21:09:04.137
> 
> 标签：hadoop, eof

我在伪分布式模式下运行 Hadoop。在 DataInputStream.readFully() 方法中完成 Map 步骤后，我的新 MR 作业引发 EOF 异常。输入/输出格式相同 - SequenceFile。类似的工作运行良好，但新的工作失败了。

堆栈跟踪：

`java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:180) at java.io.DataInputStream.readFully(DataInputStream.java:152) at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:1520) at org.apache.hadoop.io.SequenceFile$Reader.<init>(SequenceFile.java:1492) at org.apache.hadoop.io.SequenceFile$Reader.<init>(SequenceFile.java:1479) at org.apache.hadoop.io.SequenceFile$Reader.<init>(SequenceFile.java:1474) at org.apache.hadoop.mapreduce.lib.input.SequenceFileRecordReader.initialize(SequenceFileRecordReader.java:50) at org.apache.hadoop.mapred.MapTask$NewTrackingRecordReader.initialize(MapTask.java:451) at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:646) at org.apache.hadoop.mapred.MapTask.run(MapTask.java:323) at org.apache.hadoop.mapred.Child$4.run(Child.java:266) at java.security.AccessController.doPrivileged(Native Method) at javax.security.auth.Subject.doAs(Subject.java:396) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInf`

我已经解决了这个问题，它是由 HDFS 输入文件夹中的几个损坏的序列文件调用的

# java - JFreeChart - 将图表线的 SeriesStroke 从实线更改为虚线

> ID：13240410
> 
> 赞同：9
> 
> 时间：2012-11-05T21:09:06.630
> 
> 标签：java, charts, jfreechart, time-series, timeserieschart

此处接受的答案（[JFreechart(Java) - 如何绘制部分虚线和部分实线的线条？](https://stackoverflow.com/questions/7797353/jfreechartjava-how-to-draw-lines-that-is-partially-dashed-lines-and-partiall)）帮助我开始改变图表上的系列笔划线。在单步执行我的代码并观察更改后，我看到我的系列笔画实际上在它应该更改为“dashedStroke”时（在某个日期“dashedAfter”之后），但是当图表被渲染时，整个系列线是虚线. 我怎样才能让系列线一开始是实心的，在设定的日期之后是虚线？

```
/* series line modifications */
final Number dashedAfter = timeNowDate.getTime();

XYLineAndShapeRenderer render = new XYLineAndShapeRenderer() {
  Stroke regularStroke = new BasicStroke();
  Stroke dashedStroke = new BasicStroke(
                            1.0f, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND,
                            1.0f, new float[] {10.0f, 6.0f}, 0.0f );
  @Override
  public Stroke getItemStroke(int row, int column) {
    Number xVal = cd.getXValue(row, column);
    if (xVal.doubleValue() > dashedAfter.doubleValue()) { 
      return dashedStroke; 
    } else { 
      return regularStroke; 
    }
  }
};
render.setBaseShapesVisible(false);
render.setBaseShapesFilled(true);
render.setDrawSeriesLineAsPath(true);
plot.setRenderer(render); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T09:02:55.023

您是否尝试过实施`AbstractRenderer#getItemStroke`？

![在此处输入图像描述](../Images/e5ecf649b8155363f52932144ec2d02e.png)

在此示例中，我对系列​​ 2 使用 x > 4 的虚线：

```
XYLineAndShapeRenderer renderer = new XYLineAndShapeRenderer(){
    Stroke soild = new BasicStroke(2.0f);
    Stroke dashed =  new BasicStroke(1.0f,BasicStroke.CAP_BUTT, BasicStroke.JOIN_MITER, 10.0f, new float[] {10.0f}, 0.0f);
    @Override
    public Stroke getItemStroke(int row, int column) {
if (row == 2){
  double x = dataset.getXValue(row, column);
  if ( x > 4){
    return dashed;
  } else {
    return soild;
  } 
} else
  return super.getItemStroke(row, column);
    }
  };
  renderer.setBaseShapesVisible(true);
  renderer.setBaseShapesFilled(true);
  renderer.setBaseStroke(new BasicStroke(3));
  plot.setRenderer(renderer); 
```

尽管此示例使用的是`XYSeries`日期而不是日期，但您应该能够根据需要对其进行修改。

这是完整的例子

```
import java.awt.BasicStroke;
import java.awt.Stroke;

import javax.swing.JPanel;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.chart.plot.XYPlot;
import org.jfree.chart.renderer.xy.XYLineAndShapeRenderer;
import org.jfree.data.xy.XYDataset;
import org.jfree.data.xy.XYSeries;
import org.jfree.data.xy.XYSeriesCollection;
import org.jfree.ui.ApplicationFrame;
import org.jfree.ui.RefineryUtilities;

public class LineChartDemo2 extends ApplicationFrame {

    public LineChartDemo2(String title) {
        super(title);
        JPanel chartPanel = createDemoPanel();
        chartPanel.setPreferredSize(new java.awt.Dimension(500, 270));
        setContentPane(chartPanel);
    }

    private static JFreeChart createChart(final XYDataset dataset) {

        JFreeChart chart = ChartFactory.createXYLineChart(
            "Line Chart Demo: XYLineAndShapeRenderer",     
            "X",                     
            "Y",                     
            dataset,              
            PlotOrientation.VERTICAL,
            false,                     
            false,                 
            false             
        );

        XYPlot plot = (XYPlot) chart.getPlot();
        plot.setDomainPannable(true);
        plot.setRangePannable(true);

        XYLineAndShapeRenderer renderer = new XYLineAndShapeRenderer(){
            Stroke soild = new BasicStroke(2.0f);
            Stroke dashed =  new BasicStroke(1.0f,BasicStroke.CAP_BUTT, BasicStroke.JOIN_MITER, 10.0f, new float[] {10.0f}, 0.0f);
            @Override
            public Stroke getItemStroke(int row, int column) {
                if (row == 2){
                    double x = dataset.getXValue(row, column);
                    if ( x > 4){
                        return dashed;
                    } else {
                        return soild;
                    } 
                } else
                    return super.getItemStroke(row, column);
            }
        };

        renderer.setBaseShapesVisible(true);
        renderer.setBaseShapesFilled(true);
        renderer.setBaseStroke(new BasicStroke(3));
        plot.setRenderer(renderer);
        return chart;
    }

    public static JPanel createDemoPanel() {
        JFreeChart chart = createChart(createDataset());
        ChartPanel panel = new ChartPanel(chart);
        panel.setMouseWheelEnabled(true);
        return panel;
    }

    public static void main(String[] args) {
        LineChartDemo2 demo = new LineChartDemo2(
                "JFreeChart");
        demo.pack();
        RefineryUtilities.centerFrameOnScreen(demo);
        demo.setVisible(true);
    }

    private static XYDataset createDataset() {

        XYSeries series1 = new XYSeries("First");
        series1.add(1.0, 1.0);
        series1.add(2.0, 4.0);
        series1.add(3.0, 3.0);
        series1.add(4.0, 5.0);
        series1.add(5.0, 5.0);
        series1.add(6.0, 7.0);
        series1.add(7.0, 7.0);
        series1.add(8.0, 8.0);

        XYSeries series2 = new XYSeries("Second");
        series2.add(1.0, 5.0);
        series2.add(2.0, 7.0);
        series2.add(3.0, 6.0);
        series2.add(4.0, 8.0);
        series2.add(5.0, 4.0);
        series2.add(6.0, 4.0);
        series2.add(7.0, 2.0);
        series2.add(8.0, 1.0);

        XYSeries series3 = new XYSeries("Third");
        series3.add(3.0, 4.0);
        series3.add(4.0, 3.0);
        series3.add(5.0, 2.0);
        series3.add(6.0, 3.0);
        series3.add(7.0, 6.0);
        series3.add(8.0, 3.0);
        series3.add(9.0, 4.0);
        series3.add(10.0, 3.0);

        XYSeriesCollection dataset = new XYSeriesCollection();
        dataset.addSeries(series1);
        dataset.addSeries(series2);
        dataset.addSeries(series3);

        return dataset;

    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:29:45.027

> 我仍然遇到同样的问题，即线条没有从实线变为虚线，而是其中之一。

该`setDrawSeriesLineAsPath()`方法“控制是否将每个系列绘制为单个路径”。这排除了`Stroke`动态更改，因为`getItemStroke()`每个系列仅调用一次。

附录：验证这一点的一种简单方法是`setDrawSeriesLineAsPath()`在@GrahamA 的示例中调用并`drawFirstPassShape()`在调试器中插入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:18:54.727

我认为你做对了，如果它不起作用，也许它不可能？我只是在这里猜测，但你可以画 2 条线而不是 1 条线。你的第二条线将从你的第一条线结束的地方开始。如果您想大量更改笔画并且您想根据条件在循环的每次迭代中更改它，那可能会变得混乱，您的代码可能会变得更加复杂。或者只是为每个画一条新线。

# jquery - 垂直 3d 翻转效果

> ID：13240411
> 
> 赞同：0
> 
> 时间：2012-11-05T21:09:09.420
> 
> 标签：jquery, html, css

我需要创建一个像[“flipclock”](http://jquery-countdown.googlecode.com/svn/trunk/index.html)这样的垂直 3d 效果。

我没有数字，而是有一张图片：上半部分必须通过下半部分的 3d 过渡翻转，反之亦然。
背面包含新图片的一半，所以结果是当动画结束时我有一个全新的图像，就像时钟从包含数字“3”的图像的两半翻转到两半包含数字“4”的图像。
![在此处输入图像描述](../Images/23b90e21fb35340a0c96203322bf521c.png)
我只需要一次翻转，从图片 1 到图片 2，不像时钟那样一遍又一遍。
您知道任何可用于此问题的代码吗？jquery 插件最适合我的需要。
我用谷歌搜索了很多，但只发现了具有卷曲效果的水平翻转，比如翻书页，这不是我的情况。
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:13:12.450

看看这是不是你需要的：[Apple style counter revisited](http://cnanney.com/journal/code/apple-style-counter-revisited/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:16:25.313

我从这个页面开始解决： http: [//css3playground.com/flip-card.php](http://css3playground.com/flip-card.php)

# c# - 使用 C# 或 PowerShell 将联系人添加到 Exchange 公用文件夹

> ID：13240412
> 
> 赞同：0
> 
> 时间：2012-11-05T21:09:10.247
> 
> 标签：c#, powershell, exchange-server, exchange-server-2010

如何使用 C# 或 PowerShell 将联系人添加到 Exchange Server 2010 公用文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:31:48.157

我使用 Microsoft Exchange 网络服务

[http://msdn.microsoft.com/en-us/library/exchange/bb204119%28v=exchg.140%29.aspx](http://msdn.microsoft.com/en-us/library/exchange/bb204119%28v=exchg.140%29.aspx)

# android - 如何使用 AndEngine 构建多层场景？

> ID：13240420
> 
> 赞同：1
> 
> 时间：2012-11-05T21:09:34.867
> 
> 标签：android, android-layout, andengine, game-engine, scene

我是 android 开发的菜鸟，我正在尝试学习如何使用 AndEngine。我想构建一个场景，其中一个精灵从前景中的一个物体后面出现，然后以一种鼹鼠的方式消失。我已经查看了每个示例项目，但找不到任何显示如何执行此操作的代码。任何帮助是极大的赞赏。

目前，我正在尝试使用精灵来设置前景场景无济于事。

```
@Override
    public Scene onCreateScene() {
        this.mEngine.registerUpdateHandler(new FPSLogger());

        final Scene scene = new Scene();
        final AutoParallaxBackground autoParallaxBackground = new AutoParallaxBackground(0, 0, 0, 5);
        final VertexBufferObjectManager vertexBufferObjectManager = this.getVertexBufferObjectManager();
        autoParallaxBackground.attachParallaxEntity(new ParallaxEntity(0.0f, new Sprite(0, CAMERA_HEIGHT - this.mParallaxLayerBack.getHeight(), this.mParallaxLayerBack, vertexBufferObjectManager)));
        autoParallaxBackground.attachParallaxEntity(new ParallaxEntity(-5.0f, new Sprite(0, 80, this.mParallaxLayerMid, vertexBufferObjectManager)));
        autoParallaxBackground.attachParallaxEntity(new ParallaxEntity(-10.0f, new Sprite(0, CAMERA_HEIGHT - this.mParallaxLayerFront.getHeight(), this.mParallaxLayerFront, vertexBufferObjectManager)));
        scene.setBackground(autoParallaxBackground);

        final float centerX = (CAMERA_WIDTH - this.mFaceTextureRegion.getWidth()) / 2;
        final float centerY = (CAMERA_HEIGHT - this.mFaceTextureRegion.getHeight()) / 2;
        final Sprite face = new Sprite(centerX, centerY, this.mFaceTextureRegion, this.getVertexBufferObjectManager());
        final PhysicsHandler physicsHandler = new PhysicsHandler(face);
        face.registerUpdateHandler(physicsHandler);

        scene.attachChild(face);

        final Sprite foreground = new Sprite(centerX, centerY, this.mFaceTextureRegion2, this.getVertexBufferObjectManager());
        final PhysicsHandler physicsHandler2 = new PhysicsHandler(foreground);
        face.registerUpdateHandler(physicsHandler2);

        scene.setChildScene(foreground); //<--Gives me error
    return scene;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T05:51:08.210

如果我理解正确，您需要图层。您可以将实体用作图层：

```
Entity backgroundLayer = new Entity();
backgroundLayer.attachChild(face);

Entity foregroundLayer= new Entity();
foregroundLayer.attach(foreground);

scene.attachChild(backgroundLayer);
scene.attachChild(foregroundLayer); 
```

我希望这能帮到您。

# powershell - 在 powershell 命令行中将 accountExpires 转换为 DateTime（最后一步，需要帮助）

> ID：13240421
> 
> 赞同：4
> 
> 时间：2012-11-05T21:09:36.823
> 
> 标签：powershell, command-line

我有以下代码可以很好地从 AD 输出用户的显示名称和 accountExpires 属性。由于工作模式受限，我在命令行上运行它们：

```
$objSearch.findall() | %{" " + $_.properties.displayname + "| " + $_.properties.accountexpires} 
```

现在我需要将此输出，特别是 accountExpires 属性转换为人类可读的日期。谷歌搜索后，我发现我可以使用类似下面的东西在 accountExpires 和 datetime 之间进行转换。

```
[datetime]::fromfiletime(129138320987173880) 
```

但是我在将两者结合起来时遇到了问题。我尝试了以下方法：

```
$objSearch.findall() | %{" "+ $_.properties.displayname + " " + [datetime]::fromfiletime($_.properties.accountexpires)} 
```

无法将参数“0”，值为：“System.DirectoryServices.ResultPropertyValueCollection”，将“FromFileTime”类型转换为“System.Int64”：“无法转换类型为“System.DirectoryServices.ResultPropertyValueCollection”的“System.DirectoryServices.ResultPropertyValueCollection”值" 键入 "System.Int64"。" 在 line:1 char:96 + $objSearch.findall() | %{" "+ $ *.properties.displayname + " " + [datetime]::fromfiletime <<<< ($* .properties.accountexpires)} + CategoryInfo : NotSpecified: (:) [], MethodException + FullyQualifiedErrorId : MethodArgumentConversionInvalidCastArgument

```
$objSearch.findall() | %{" "+ $_.properties.displayname + " " + [datetime]::fromfiletime $_.properties.accountexpires} 
```

表达式或语句中出现意外的标记“ *”。在 line:1 char:99 + $objSearch.findall() | %{"这是 "+ $* .properties.displayname + " " + [datetime]::fromfiletime $_ <<<< .properties.accountexpires} + CategoryInfo : ParserError: (_:String) [], ParentContainsErrorRecordException + FullyQualifiedErrorId :意外的标记

如何将 accountExpires 转换为人类可读的日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T04:56:24.507

您只是错过了底层 ADSI COM 对象将属性显示为数组，这是一种获取`accountexpires`属性的方法，只需使用`$_.properties.accountexpires[0]`.

```
$search = [ADSISearcher]"OU=MonOu,DC=dom,DC=fr"
$search.Filter = "(cn=Jean Paul Blanc)"
$user = $search.FindOne()
$user | %{" "+ $_.properties.displayname + " " + [datetime]::fromfiletime($_.properties.accountexpires[0])} 
```

这给了我：

```
 Jean Paul Blanc 12/07/2012 00:00:00 
```

# ruby - Ruby C 扩展不能是“必需的”

> ID：13240425
> 
> 赞同：0
> 
> 时间：2012-11-05T21:09:47.687
> 
> 标签：ruby, ruby-c-extension

我有一个 ruby​​ 扩展，我正在构建一个 gem。它有这个目录结构

```
|-ext
  \-cowboy
    \- extconf.rb
    |- cowboy.c
|-lib
  \- cowboy.rb
  |- cowboy
    \- version.rb
|- test
  \- test_cowboy.rb 
```

当我构建并安装它时，没有错误，并且'需要'gem（例如需要'cowboy'）在irb中工作正常。

但是，当我运行“ruby test/test_cowboy.rb”时，我从 require 中得到一个加载错误（它实际上是在抱怨 lib/cowboy.rb 中的“require 'cowboy/cowboy'”。

有谁知道为什么？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:36:05.787

我怀疑：

1.  在 irb 中，当 you 时`require 'cowboy'`，它告诉 ruby​​gems 自动设置加载路径以指向当前安装的 gem 目录。
2.  当你运行`test/test_cowboy.rb`它时不会`require 'cowboy'`。这是有道理的，因为在开发过程中，您不想加载已安装的 gem 版本，这可能与工作目录中的代码不同。

我认为您应该创建一个`test/test_helper.rb`设置加载路径的文件：

```
$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__) 
```

如果编译的共享对象文件（`.so`或`.bundle`）没有放在`lib`.

然后在每个测试文件（例如`test/test_cowboy.rb`）中，要求`test/test_helper.rb`：

```
require File.expand_path('../test_helper.rb', __FILE__) 
```

如果您有子目录，则需要调整该相对路径。例如，如果你有一个文件`test/shoes/spur.rb`，你会使用：

```
require File.expand_path('../../test_helper.rb', __FILE__) 
```

# windows-runtime - WP8：不能使用原生组件

> ID：13240426
> 
> 赞同：3
> 
> 时间：2012-11-05T21:09:52.040
> 
> 标签：windows-runtime, windows-phone-8

Windows Phone 8 C# 项目 ( `MyApp`)，从 WP7.1 迁移而来。我已将本机 Windows 运行时组件库 ( `AppLib`) 添加到解决方案中，并创建了一个参考。其中有一个公共密封的参考类（`MyClass`）。`OnLoaded`在 C# 代码（在XAML 主页面中）中有对它的引用。整个事情都编译了——这意味着正在生成组件的元数据。

当我尝试运行时，项目失败并出现异常或键入`TypeLoadException`以下消息：

> 在元数据文件中找不到类型名称或命名空间。（来自 HRESULT 的异常：0x8000000F）

AppLib.DLL 和 AppLib.winmd 都可以在 XAP 中找到。winmd 包含有关类型的信息，并且也在正确的命名空间中。我还应该检查什么？

在异常时，调试器的模块窗口中未列出 AppLib.dll。就好像 DLL 加载由于某种原因失败了。

我已经尝试在任意命名空间中使用全新的类 - 同样的问题。看起来问题出在 DLL 级别，而不是类级别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:38:09.727

WinMD 文件的名称必须是声明任何公共和可激活类型的命名空间名称的前缀。例如，如果您的 WinMD 名为**AppLib.winmd**，则您的`MyClass`类型必须在命名空间`AppLib`或嵌套在该命名空间内的其他命名空间中定义，例如`AppLib::Something`.

它还必须在“最佳匹配”WinMD 中声明，因此如果您的类型已命名`A.B.MyClass`并且您的包中同时包含**A.winmd**和**ABwinmd**，则该类型必须在**ABwinmd**中定义。

Windows 运行时使用类型的名称来确定哪个 WinMD 文件定义了该类型。另请参阅我对[“XAML 无法在本地命名空间中找到引用”的回答。](https://stackoverflow.com/a/11005217/151292)

# apache-flex - Flex LineChart - 如何从 ArrayCollection 中的唯一值创建 LineSeries

> ID：13240436
> 
> 赞同：0
> 
> 时间：2012-11-05T21:10:28.823
> 
> 标签：apache-flex, arraycollection, linechart, lineseries

我一直在试图找出一种方法来创建一个 LineChart，该 LineChart 包含许多基于 ArrayCollection 中数据的 LineSeries。

更具体地说，假设我们有一个这样的 ArrayCollection：

public var myArray:ArrayCollection=new ArrayCollection([{State: "Georgia", Year: "2011", Percent: 18}, {State: "Georgia", Year: "2010", Percent: 10}, {State: "马里兰州”，年份：“2009”，百分比：15}，{州：“马里兰州”，年份：“2008”，百分比：15}]）；

我想创建一个包含两条线的 LineChart：一条用于乔治亚州，一条用于马里兰州。格鲁吉亚的行将在单行上包含 2011 年和 2010 年的数据。马里兰线将在单行上包含 2009 年和 2008 年的数据。

我在想我可能必须动态创建 LineSeries，但不确定如何让 ArrayCollection 根据状态对数据进行分组。

任何的意见都将会有帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:03:32.303

看看[这个例子](http://flexdiary.blogspot.com/2008/08/charting-example.html)。简而言之，您需要在创建每个系列时为其指定一个 dataFunction。

编辑：实际上，您的数据很简单，您可能可以使用 xField/yField。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T13:46:41.700

不确定这是否是最干净的方法，但这是我想出的：

```
<fx:Script>
    <![CDATA[
        import mx.charts.series.LineSeries;
        import mx.collections.ArrayCollection;

        [Bindable]
        private var appData:ArrayCollection=new ArrayCollection([{State: "Georgia", Year: 2000, Percent: 15}, {State: "Georgia", Year: 2001, Percent: 12}, {State: "Georgia", Year: 2002, Percent: 5}, {State: "Maryland", Year: 1999, Percent: 12}, {State: "Maryland", Year: 2000, Percent: 7}]);

        protected function creationComplete(event:Event):void
        {
            var states:Array=new Array("Georgia", "Maryland");
            var series:Array=new Array();

            for each (var state:Object in states)
            {
                var data:ArrayCollection=new ArrayCollection();
                var ls:LineSeries=new LineSeries();

                for (var i:int=0; i < appData.length; i++)
                {
                    var currItem:String=appData.getItemAt(i).State;

                    if (currItem == state)
                    {
                        data.addItem(appData.getItemAt(i));
                    }
                }

                ls.yField="Percent";
                ls.xField="Year";
                ls.displayName=state.toString();
                ls.dataProvider=data;
                series.push(ls);
            }

            linechart.series=series;
        }
    ]]>
</fx:Script>

<mx:Panel title="US States Data"
          height="100%"
          width="100%"
          layout="horizontal">

    <mx:LineChart id="linechart"
                  height="100%"
                  width="100%"
                  paddingLeft="5"
                  paddingRight="5"
                  showDataTips="true"
                  dataProvider="{appData}">

        <mx:horizontalAxis>
            <mx:CategoryAxis categoryField="Year"/>
        </mx:horizontalAxis>

    </mx:LineChart>

    <mx:Legend dataProvider="{linechart}"/>

</mx:Panel> 
```

# javascript - 将图像放在画布上与鼠标 onclick 相同的 x,y 位置

> ID：13240437
> 
> 赞同：1
> 
> 时间：2012-11-05T21:10:34.123
> 
> 标签：javascript, image, canvas, onclick, coordinates

我正在尝试制作一个 Web 应用程序，让用户在 html 画布上插入小字符图像。计划是让用户单击虚拟键盘上的按钮，然后在画布上单击以使相应的字符出现在用户单击的任何位置。现在我只是想让一个图像在点击时出现在画布上，但到目前为止它没有做任何事情。这是我现在拥有的代码，它嵌入在 html 文件中。

```
<script type="text/javascript">
            var mathCanvas = document.getElementById("matharea");
            var ctx = mathCanvas.getContext("2d");
            var el = mathCanvas;
            var xPos = 0;
            var yPos = 0;
            while(el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)){
                xPos += el.offsetLeft - el.scrollLeft;
                yPos += el.offsetTop - el.scrollTop;
                el = el.parentNode;
            }
            var img = new Image();
            img.src = "five.png";
            mathCanvas.onclick = function(event){
                var x = event.clientX - xPos;
                var y = event.clientY - yPos;
                ctx.drawImage(img,x,y);
            };
</script> 
```

我已经测试了 onclick 事件，它返回坐标，但图像不会出现。这里出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:26:58.050

This should work since the click event will be firing on the canvas itself:

```
 var mathCanvas = document.getElementById("matharea");
        var ctx = mathCanvas.getContext("2d");

        var img = new Image();
        img.src = "five.png";
        mathCanvas.onclick = function(event){
            var x = event.offsetX;
            var y = event.offsetY;
            ctx.drawImage(img,x,y);
        }; 
```

To center the image on the point:

```
 var mathCanvas = document.getElementById("matharea");
        var ctx = mathCanvas.getContext("2d");

        var img = new Image();
        img.src = "five.png";
        mathCanvas.onclick = function(event){
            var x = Math.round(event.offsetX - img.width/2);
            var y = Math.round(event.offsetY - img.height/2);
            ctx.drawImage(img,x,y);
        }; 
```

# windows - Windows 8 应用程序中 Numericbox 的替代品？

> ID：13240442
> 
> 赞同：8
> 
> 时间：2012-11-05T21:11:00.560
> 
> 标签：windows, windows-8, numeric, tile

我正在尝试在 Windows 8 磁贴应用程序中找到一个很好的替代 Numericbox 的方法。我尝试使用与 Windows 窗体相同的数字框，但收到错误消息，提示 Windows 8 应用程序不支持这些数字框（？）。我注意到平铺应用程序的 TextBox 元素有一个可以设置为“数字”的 InputScope，但它仍然允许用户输入他想要输入的任何字符。我假设 InputScope 没有做我认为它做的事情。

我目前正在使用文本框进行管理，但是因为我正在进行计算，所以当我想更新界面时，必须不断地将文本转换为十进制，然后再返回文本，此外还必须执行多项检查以确保用户这样做不输入非数字字符。这变得非常乏味并且非常熟悉 Windows 窗体，这似乎是朝着错误方向迈出的一步。我一定遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-15T02:07:13.890

我不熟悉`NumericTextBox`，但这是一个简单的 C#/XAML 实现，它只允许数字和十进制字符。

它所做的只是覆盖`OnKeyDown`事件；根据被按下的键，它允许或不允许事件到达基`TextBox`类。

我应该注意，此实现适用于 Windows 应用商店应用程序 - 我相信您的问题是关于该类型的应用程序，但我不是 100% 确定。

```
public class MyNumericTextBox : TextBox
{
    protected override void OnKeyDown(KeyRoutedEventArgs e)
    {
        HandleKey(e);

        if (!e.Handled)
            base.OnKeyDown(e);
    }

    bool _hasDecimal = false;
    private void HandleKey(KeyRoutedEventArgs e)
    {
        switch (e.Key)
        {
            // allow digits
            // TODO: keypad numeric digits here
            case Windows.System.VirtualKey.Number0:
            case Windows.System.VirtualKey.Number1:
            case Windows.System.VirtualKey.Number2:
            case Windows.System.VirtualKey.Number3:
            case Windows.System.VirtualKey.Number4:
            case Windows.System.VirtualKey.Number5:
            case Windows.System.VirtualKey.Number6:
            case Windows.System.VirtualKey.Number7:
            case Windows.System.VirtualKey.Number8:
            case Windows.System.VirtualKey.Number9:
                e.Handled = false;
                break;

            // only allow one decimal
            // TODO: handle deletion of decimal...
            case (Windows.System.VirtualKey)190:    // decimal (next to comma)
            case Windows.System.VirtualKey.Decimal: // decimal on key pad
                e.Handled = (_hasDecimal == true);
                _hasDecimal = true;
                break;

            // pass various control keys to base
            case Windows.System.VirtualKey.Up:
            case Windows.System.VirtualKey.Down:
            case Windows.System.VirtualKey.Left:
            case Windows.System.VirtualKey.Right:
            case Windows.System.VirtualKey.Delete:
            case Windows.System.VirtualKey.Back:
            case Windows.System.VirtualKey.Tab:
                e.Handled = false;
                break;

            default:
                // default is to not pass key to base
                e.Handled = true;
                break;
        }
    }
} 
```

这是一些示例 XAML。请注意，它假定`MyNumericTextBox`位于项目名称空间中。

```
<StackPanel Background="Black">
    <!-- custom numeric textbox -->
    <local:MyNumericTextBox />
    <!-- normal textbox -->
    <TextBox />
</StackPanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T19:02:32.640

[WinRT XAML 工具包](http://winrtxamltoolkit.codeplex.com/)的 NumericUpDown 控件可能就是您要找的。

# java - 如何抽象 Robotium Setup 来运行多个测试文件

> ID：13240444
> 
> 赞同：0
> 
> 时间：2012-11-05T21:11:02.830
> 
> 标签：java, android, eclipse, robotium

在 Blackbox 测试环境中，我需要包含**CODE 1**并以**CODE 2**结尾，以通过运行 Android JUnit Test 来执行测试（如 Robotium 网站所述）：

**代码 1：**

```
public class ConnectApp extends ActivityInstrumentationTestCase2 {
private static final String LAUNCHER_ACTIVITY_FULL_CLASSNAME="com.example.android.notepad.NotesList";
private static Class<?> launcherActivityClass;
private Solo solo;
static { 
    try { launcherActivityClass=Class.forName(LAUNCHER_ACTIVITY_FULL_CLASSNAME); }
    catch (ClassNotFoundException e) { throw new RuntimeException(e); }
}
public ConnectApp() throws ClassNotFoundException {
    super(launcherActivityClass);
}
public void setUp() throws Exception {
    this.solo = new Solo(getInstrumentation(), getActivity());
} 
```

**代码 2：**

```
public void testNumberOne() { … }
public void testNumberTwo() { … }

} 
```

但是，我想抽象代码的**CODE 1**（包括 getInstrumentation() 和 getAcitvity()），以便我可以简单地在单独的测试文件中调用它们，然后运行**​​CODE 2**。这是因为我想在单独的文件中进行测试，并且不想继续添加相同数量的**CODE 1**代码，而只是调用方法/构造函数来启动该过程。

有没有办法做到这一点？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T13:55:55.583

是的，有办法做到这一点。您需要做的是创建一个空的测试类，例如：

```
public class TestTemplate extends ActivityInstrumentationTestCase2 {

    private static final String LAUNCHER_ACTIVITY_FULL_CLASSNAME="com.example.android.notepad.NotesList";
    private static Class<?> launcherActivityClass;
    private Solo solo;

    static { 
        try { launcherActivityClass=Class.forName(LAUNCHER_ACTIVITY_FULL_CLASSNAME); }
        catch (ClassNotFoundException e) { throw new RuntimeException(e); }
    }
    public ConnectApp() throws ClassNotFoundException {
        super(launcherActivityClass);
    }

    public void setUp() throws Exception {
        super.setUp();//I added this line in, you need it otherwise things might go wrong
        this.solo = new Solo(getInstrumentation(), getActivity());
    }

    public Solo getSolo(){
        return solo;
    }
} 
```

然后对于您将来想要的每个测试类，而不是扩展 ActivityInstrumentationTestCase2，您将扩展 TestTemplate。

例如：

```
public class ActualTest extends TestTemplate {
    public ActualTest() throws ClassNotFoundException {
    super();
}

    public void setUp() throws Exception {
        super.setUp();
        //anything specific to setting up for this test
    }

    public void testNumberOne() { … }
    public void testNumberTwo() { … }
} 
```

# .net - 当前 VB.NET 2012 MVC4 中“asp:label”的等效控件？

> ID：13240448
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:11:17.723
> 
> 标签：.net, vb.net

我的背景是 PHP 和 MySQL - 我确实认为我可能正在寻找一个“回声”等价物。

目的是要有一个`text field`，然后用例如和`submitted text`打印在屏幕上。`IsPostBack``on page load`

问题是针对控件`asp:label`来了解VB.NET 2012中使用什么具有等效功能的。

**不同的公式来指定预期的内容：**

基本上，通过“文本框”提交文本并在“页面加载”之后将其打印在屏幕上，也许是“页面加载”。然后通过将文本保存在数据库中继续你。（博客应用程序的第一步。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:34:29.167

我认为[web 标签组件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.label.aspx#Y300)仍然存在，并且在当前版本的 .NET 框架中得到支持，包括 VB.NET。您应该能够在回发时填充它。

# android - AlertDialog 在覆盖单击时关闭

> ID：13240452
> 
> 赞同：1
> 
> 时间：2012-11-05T21:11:47.243
> 
> 标签：android

尝试调试一些代码。我有一个带有正面和负面听众集的 AlertDialog。在 Android 2.3.3 设备上，一切都按预期工作。用户必须在两个选项之间进行选择才能继续。但是，在我的 4.1.1 设备上，用户可以单击屏幕上的任意位置来关闭对话框。不知道什么被称为是关闭对话框。我查看了[Android AlertDialog](http://developer.android.com/guide/topics/ui/dialogs.html#AlertDialog)和[AlertDialog.Builder](http://developer.android.com/reference/android/app/AlertDialog.Builder.html)但我找不到任何有用的信息。任何有关为什么会发生这种情况的帮助将不胜感激。对话框的代码如下

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setMessage(getString(R.string.titleString));

builder.setPositiveButton(this.getResources().getString(R.string.option1),
    new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
        // Things Happen Here
        dialog.cancel();
        }
    });

builder.setNegativeButton(this.getResources().getString(R.string.option2),
    new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
        // Things Happen Here
        dialog.cancel();
        }
    });

AlertDialog demoAlert = builder.create();
demoAlert.show(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:17:58.583

尝试设置`cancelable`为false：

```
builder.setCancelable(false); 
```

# c - 在多个文件中使用结构

> ID：13240462
> 
> 赞同：1
> 
> 时间：2012-11-05T21:12:24.740
> 
> 标签：c

我试图从 io.h 调用 main.c 中的一个函数，该函数从文件中读取数据，将该数据存储到多个结构中，然后以某种方式让我将不同的结构作为参数传递给 main 中的后续函数。后面的函数将在其他文件中定义，例如 alg.h。

我该怎么做呢？我是否使用 extern 并使结构全局化并将它们放在单独的文件中？是否可以让 alg.h 中的函数具有其中一个结构的返回类型？这取决于我的包含顺序吗？

下面粘贴的代码符合并有效，但任何移动任何结构的尝试都会导致程序无法编译。

此外，是否可以在 alg.h 中声明一个结构，然后在 alg.h 中声明具有该结构作为参数的函数。然后在 main.c 中，初始化该结构并将其传递给在 io.h 中声明的函数，给该结构一些值，将其返回给 main.c，然后将其传递给在 alg.h 中声明的函数？我知道这听起来像一个类，但我需要一个 C 解决方案，而且我只需要一个浮动的结构实例。

谢谢。

io.h

```
struct s1 {
    int num1;
    double num2;
};

struct s2 {
    int num3;
    double num4;
};

void io_init(struct s1*, struct s2*); 
```

io.c

```
#include <stdio.h>
#include <stdlib.h>

#include "io.h"

void io_init(struct s1* s1i, struct s2* s2i)
{
    s1i->num1 = 5;
    s1i->num2 = 2.4;

    FILE *fp;
    char line[80];

    fp = fopen("input.txt","rt");

    fgets(line, 80, fp);
    sscanf(line,"%i",&s2i->num3);
    fgets(line, 80, fp);
    sscanf(line,"%i",&s2i->num4);

    fclose(fp);
} 
```

算法

```
void ga_init(struct s1); 
```

算法

```
#include <stdio.h>

#include "io.h"
#include "ga.h"

void ga_init(struct s1 s1i)
{
    printf("%i", s1i.val1);
} 
```

主.c：

```
#include <stdio.h>

#include "io.h"
#include "ga.h"

int main() {
    struct s1 s1i;
    struct s2 s2i;

    io_init(&s1i, &s2i);
    ga_init(s1i);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:17:44.230

每个需要声明类型（即，想要使用它们）的文件都必须包含你的头文件（好的，所以前向声明和指针可以工作，但是如果没有定义它们就不能被取消引用，无论如何这在这里并不适用.)

所以，详细地说，如果文件 X 需要使用，`struct Y`那么它需要包含包含其声明的头文件，就是这样。

```
/* X.c */
#include "Y.h"  /* <-- that's it! */

void foo(Y *obj) {
    /* ... */
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:23:10.123

这里有一些建议。

*   您的`.h`文件没有定义结构对象。它只是定义类型。它的方式很好。每个接触这些类型结构的人都应该包含这个文件。

*   很少需要像在调用`ga_init`. 您基本上总是希望通过引用进行调用，就像您使用`io_init`.

*   是的，您可以返回一个结构，但同样，返回对结构的引用几乎总是更好。

*   `extern`您当然可以共享全局定义的结构，除非您的链接器很糟糕，否则您不需要。但是共享对分配的结构的引用`main()`大致相同。

# java - 克隆新对象以传递给 ArrayList？

> ID：13240465
> 
> 赞同：2
> 
> 时间：2012-11-05T21:12:30.097
> 
> 标签：java, android, events

我正在构建一个 android 应用程序，我试图将对象添加到`ArrayList`. 我认为这会在其中创建对象的副本，`ArrayList`然后我可以重用该对象。我意识到情况并非如此，`ArryList`实际上是在引用原始对象。

我不太确定如何使用循环在`onCreate`函数中创建新对象，所以我是否需要以某种方式克隆对象并将其传递给`ArrayList`?

无论如何，这是我的代码：

```
 public class Main extends Activity {
  private Item myItem = new Item();

  btnSave.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            alItems.add(myItem);
            arrayAdapter.notifyDataSetChanged(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:13:45.690

您可以[`copy constructor`](https://stackoverflow.com/questions/5749218/building-a-copy-constructor-in-java)在您的`Item`类中创建一个，并使用它来创建您的对象的副本。

```
public class Item {
    private int field1;
    public Item() { }

    public Item(Item item) {
       this.field1 = item.field1;
    }
} 
```

并使用以下方法将您的对象添加到列表中： -

```
alItems.add(new Item(myItem)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:17:14.937

然后制作你的`Item`工具`Clonable`

```
public void onClick(View v) {
        alItems.add(myItem.clone());
        arrayAdapter.notifyDataSetChanged(); 
```

# android - Android：多渐变形状

> ID：13240466
> 
> 赞同：2
> 
> 时间：2012-11-05T21:12:31.097
> 
> 标签：android, gradient, android-xml, shapes

您好，我尝试创建一个具有多渐变形状的可绘制 XML 文件。

我想要这样的东西，左上角是红色，右上角是黄色，底部是蓝色，如 3 个区域。 ![在此处输入图像描述](../Images/a992630157efd5b75c16e7bacbb70cb3.png)

我能找到的最接近的事情是这里的其他问题。 [多渐变形状](https://stackoverflow.com/questions/4381033/multi-gradient-shapes) 用户已通过使用修复它`layer-list`。我已经尝试过了，但这不起作用，我能理解的是我会这样做但不起作用。（这是`button_real_world.xml`文件）

```
<layer-list
    xmlns:android="http://schemas.android.com/apk/res/android"
>
    <item>
        <shape
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:shape="rectangle"
        >
            <stroke android:width="4dp" android:color="#FFFF7700" /> 
            <padding android:left="7dp" android:top="7dp" 
                     android:right="7dp" android:bottom="7dp" /> 
            <corners android:radius="15dp" /> 

            <gradient
                android:angle="45"
                android:startColor="#FF63a34a"
                android:endColor="#FF477b36"
                android:type="linear"
                />    
        </shape>
    </item>
    <item>
        <shape
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:shape="rectangle"
        >
            <stroke android:width="4dp" android:color="#FFFF7700" /> 
            <padding android:left="7dp" android:top="7dp" 
                     android:right="7dp" android:bottom="7dp" /> 
            <corners android:radius="15dp" /> 
            <gradient
                android:angle="250"
                android:startColor="#FF63a34a"
                android:endColor="#ff477b36"
                android:type="linear"
                />    
        </shape>            
    </item>
</layer-list> 
```

但这只会给我一个运行时错误，（在模拟器中运行，Windows）

```
W/dalvikvm( 1075): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
E/AndroidRuntime( 1075): Uncaught handler: thread main exiting due to uncaught exception
E/AndroidRuntime( 1075): android.view.InflateException: Binary XML file line #8: Error inflating class <unknown>
E/AndroidRuntime( 1075):        at android.view.LayoutInflater.createView(LayoutInflater.java:513)
E/AndroidRuntime( 1075):        at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
E/AndroidRuntime( 1075):        at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:563)
E/AndroidRuntime( 1075):        at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
E/AndroidRuntime( 1075):        at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
E/AndroidRuntime( 1075):        at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
E/AndroidRuntime( 1075):        at se.evigfilosofi.transportmanagement.util.ui.AdvancedArrayAdapter.createViewFromResource(AdvancedArrayAdapter.java:224)
E/AndroidRuntime( 1075):        at se.evigfilosofi.transportmanagement.util.ui.AdvancedArrayAdapter.getView(AdvancedArrayAdapter.java:213)
E/AndroidRuntime( 1075):        at android.widget.AbsListView.obtainView(AbsListView.java:1274)
E/AndroidRuntime( 1075):        at android.widget.ListView.makeAndAddView(ListView.java:1668)
E/AndroidRuntime( 1075):        at android.widget.ListView.fillDown(ListView.java:637)
E/AndroidRuntime( 1075):        at android.widget.ListView.fillFromTop(ListView.java:694)
E/AndroidRuntime( 1075):        at android.widget.ListView.layoutChildren(ListView.java:1521)
E/AndroidRuntime( 1075):        at android.widget.AbsListView.onLayout(AbsListView.java:1113)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1119)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.layoutVertical(LinearLayout.java:998)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.onLayout(LinearLayout.java:918)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1119)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.layoutHorizontal(LinearLayout.java:1108)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.onLayout(LinearLayout.java:920)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.support.v4.view.ViewPager.onLayout(ViewPager.java:1388)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1119)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.layoutHorizontal(LinearLayout.java:1108)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.onLayout(LinearLayout.java:920)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1119)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.layoutVertical(LinearLayout.java:998)
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.onLayout(LinearLayout.java:918)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
E/AndroidRuntime( 1075):        at android.view.View.layout(View.java:6830)
E/AndroidRuntime( 1075):        at android.view.ViewRoot.performTraversals(ViewRoot.java:996)
E/AndroidRuntime( 1075):        at android.view.ViewRoot.handleMessage(ViewRoot.java:1633)
E/AndroidRuntime( 1075):        at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 1075):        at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime( 1075):        at android.app.ActivityThread.main(ActivityThread.java:4363)
E/AndroidRuntime( 1075):        at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 1075):        at java.lang.reflect.Method.invoke(Method.java:521)
E/AndroidRuntime( 1075):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
E/AndroidRuntime( 1075):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
E/AndroidRuntime( 1075):        at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime( 1075): Caused by: java.lang.reflect.InvocationTargetException
E/AndroidRuntime( 1075):        at android.widget.LinearLayout.<init>(LinearLayout.java:92)
E/AndroidRuntime( 1075):        at java.lang.reflect.Constructor.constructNative(Native Method)
E/AndroidRuntime( 1075):        at java.lang.reflect.Constructor.newInstance(Constructor.java:446)
E/AndroidRuntime( 1075):        at android.view.LayoutInflater.createView(LayoutInflater.java:500)
E/AndroidRuntime( 1075):        ... 52 more
E/AndroidRuntime( 1075): Caused by: android.content.res.Resources$NotFoundException: File res/drawable/button_real_world.xml from drawable resource ID #0x7f020002
E/AndroidRuntime( 1075):        at android.content.res.Resources.loadDrawable(Resources.java:1693)
E/AndroidRuntime( 1075):        at android.content.res.TypedArray.getDrawable(TypedArray.java:548)
E/AndroidRuntime( 1075):        at android.view.View.<init>(View.java:1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-07-15T03:38:00.407

尝试使用这个。提示：设置角度时，请使用 45 的倍数。

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item>
        <shape android:shape="rectangle" >
            <gradient
                android:type="radial"
                android:gradientRadius="150%"
                android:centerX="50%"
                android:centerY="100%"
                android:startColor="#78ffd6" />
        </shape>
    </item>
    <item>
        <shape  android:shape="rectangle" >
             <gradient
                android:type="radial"
                android:gradientRadius="125%"
                android:centerX="10%"
                android:centerY="0%"
                android:startColor="#f64f59"
                android:centerColor="#7df64f59"/>
        </shape>
    </item>
    <item>
        <shape android:shape="rectangle" >
             <gradient
                 android:type="radial"
                 android:gradientRadius="100%"
                 android:centerX="100%"
                 android:centerY="0%"
                 android:startColor="#F3F9A7"
                 android:centerColor="#7df3f9a7"/>
        </shape>
    </item>
</layer-list> 
```

# jquery - 获取div的父ID

> ID：13240467
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:12:35.847
> 
> 标签：jquery, html

我在这里发现了很多关于查找父母身份的文章，我都尝试了但没有成功。

这是我的代码：

```
<html>
<head>
<title>a</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.0/themes/base/jquery-    ui.css" />
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>
<script type="text/javascript" src="http://www.appelsiini.net/download/jquery.jeditable.js"></script>
<script type="text/javascript">
$(document).ready(function() {
$('.edit_area').editable('edit.php', { 
submitdata : {pid : $(this).parents('div:eq(0)').attr('id')},
//submitdata : {pid : $(this).closest("div").attr("id")},
//submitdata : {pid : $(this).parent().attr('id')},
//submitdata : {pid : this.parentNode.id},
//submitdata : {pid : $(this).parent().get(0).id},
//submitdata : {pid : $(this).parent()[0].id},

type      : 'textarea',
cancel    : 'Cancel',
submit    : 'OK',
//indicator : '<img src="img/indicator.gif">',
tooltip   : 'Click to edit...'
});
});
</script>
</head>
<body>
<div id="b112233">
<div class="edit_area" id="k123">hi</div>
</div>
</body>
</html> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:50:13.907

使用函数创建额外参数：

```
submitdata : function() {
       return {pid:$(this).parent('div').attr('id')};
   } 
```

# css - 在 Internet Explorer 7 中绕过缓存或将缓存设置为零？

> ID：13240470
> 
> 赞同：1
> 
> 时间：2012-11-05T21:12:45.853
> 
> 标签：css, html, internet-explorer-7

我一直在Internet选项中删除缓存，使用微软开发者工具中的删除缓存选项，当然事先关闭了服务器缓存，添加

```
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1"> 
```

到我的 html5 页面并使用页面 Ctrl-F5 重新加载。

然而，唯一能可靠地帮助 IE7 让我更新我的 css 文件的是更改它的名称。这当然是一件麻烦事。

有没有办法在 Internet Explorer 中将缓存设置为零或可靠地绕过它？更好的方法是像在 Firefox 中那样实时编辑 css，但现在所有支持的东西似乎都消失了。

# javascript - Google Maps API v3：MarkerWithLabel 直到缩放才显示

> ID：13240471
> 
> 赞同：2
> 
> 时间：2012-11-05T21:12:47.803
> 
> 标签：javascript, google-maps-api-3, google-maps-markers, markermanager

我正在将使用 google maps api v2 的应用程序转换为 v3。作为其中的一部分，我也不得不将 MarkerManager 升级到 v3 版本。

我有一个奇怪的问题，即标记直到用户缩放地图才会显示，然后它们才会出现。

如果我然后缩放回原始缩放级别，标记仍然存在，所以这不是最小\最大缩放问题。firebug\javascript 控制台中没有报告错误，如果我在添加标记的位置放置断点或 console.log，则肯定会添加它。

应用程序比较大，所以我不能把所有的源码放在这里，但是添加标记的代码如下：

```
 console.log("Adding Marker");
    markerManager.addMarker(marker, 1, 19);
    markerManager.refresh(); 
```

创建的代码`marker`与此类似：

```
 var latLng = new google.maps.LatLng(y, x);
        var marker = new MarkerWithLabel({
            position: latLng,
            title: "title",
            labelClass: "marker",
            labelContent: "Test",
            icon: icon,
            labelAnchor: new google.maps.Point(26, 32)
        }); 
```

并且`icon`只是一个`google.maps.MarkerImage`. MarkerManager 和 MarkerWithLabel 记录在这里：

[http://google-maps-utility-library-v3.googlecode.com/svn/tags/markermanager/1.0/docs/reference.html](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markermanager/1.0/docs/reference.html)

[http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.1.7/docs/reference.html](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.1.7/docs/reference.html)

编辑：我应该在创建标记管理器后对它进行任何操作之前添加它，我有以下内容，所以在加载之前我不会尝试添加任何东西：

```
google.maps.event.addListenerOnce(markerManager, 'loaded', function () { 
```

有人对我的错误可能在哪里有任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T20:31:54.463

我已经找到了解决这个问题的方法，但我不确定这可能会产生什么其他后果。基本上在markermanager.js中我替换了以下（~第130行）

```
google.maps.event.addListener(map, 'dragend', function () {
    me.onMapMoveEnd_();
});
google.maps.event.addListener(map, 'zoom_changed', function () {
    me.onMapMoveEnd_();
}); 
```

有了这个，标记就会按预期出现。我仍然对其他想法持开放态度，因为我不想编辑 markermanager 文件，而且我不确定这样做的性能（或其他）影响

```
google.maps.event.addListener(map, 'idle', function () {
    me.onMapMoveEnd_();
}); 
```

编辑：查看 markermanager.js 开发版本，其中包含所有 3 个事件。因此，如果其他人有此问题，则可能值得使用 v1.1：

[http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markermanager/src/markermanager.js](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markermanager/src/markermanager.js)

# symfony - MopaBootstrapBundle 添加导航栏反向选项

> ID：13240472
> 
> 赞同：1
> 
> 时间：2012-11-05T21:12:50.220
> 
> 标签：symfony, twitter-bootstrap, bundle, symfony-2.1

我在我的 Symfony 项目中使用 MopaBootstrapBundle。

我当前在 config.yml 中的配置是：

```
mopa_bootstrap:
    navbar: ~ 
```

如何使用 config.yml 添加逆属性以使导航栏变暗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T13:34:36.190

好吧，您应该创建一个服务来做到这一点。

//服务.yml

```
services:
    mopa_bootstrap.example.navbar:
        class: %mopa_bootstrap.navbar.generic%
        arguments:
            # first argument: a named array of menues:
            - { leftmenu: @mopa_bootstrap.examplemenu=, rightmenu: @mopa_bootstrap.exampledropdown= }
            # second argument: a named array of FormType Classes
            - { searchform: Mopa\Bundle\BootstrapSandboxBundle\Form\Type\ExampleSearchFormType }
            # third argument: a named array of options
            - { title: "BootstrapSandbox", titleRoute: "mopa_bootstrap_welcome", fixedTop: true, isFluid: false, inverse: true }
        tags:
            # The alias is used to retrieve the navbar in templates
            - { name: mopa_bootstrap.navbar, alias: sandboxFrontendNavbar } 
```

您可以在第三个参数中看到反向选项。

仅供参考： [https ://github.com/phiamo/MopaBootstrapSandboxBundle/blob/master/Resources/config/examples/example_navbar.yml](https://github.com/phiamo/MopaBootstrapSandboxBundle/blob/master/Resources/config/examples/example_navbar.yml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T13:14:36.480

尝试：

```
mopa_bootstrap:
    navbar:
        inverse: true 
```

参见：[https ://github.com/phiamo/MopaBootstrapBundle/blob/master/Resources/views/Navbar/navbar.html.twig](https://github.com/phiamo/MopaBootstrapBundle/blob/master/Resources/views/Navbar/navbar.html.twig)

# php - 比较 $_POST 数组和数据库

> ID：13240473
> 
> 赞同：5
> 
> 时间：2012-11-05T21:12:52.750
> 
> 标签：php, database, post

好的，我很确定我不是第一个遇到这种情况的人，我只是不知道寻找解决方案的正确词。考虑以下数据库表（针对此问题进行了简化）：

[数据库表 http://www.nth-root.nl/public/images/wolf/cat_attr.png](http://www.nth-root.nl/public/images/wolf/cat_attr.png)

正如您在图片中看到的，有一个包含产品类别的类别表和一个包含不同属性的属性表。例如：颜色（用于服装）、容量（用于 mp3 播放器）等。

第三个表格，位于图片的中心，将属性链接到类别。

现在在后端我有一个“编辑类别”页面，其中包含一个用于编辑（或添加）类别的表单。在同一页面上，我想显示一个下拉列表列表，以管理哪些属性链接到当前产品类别。

[后端 http://www.nth-root.nl/public/images/wolf-commerce/edit_category.png](http://www.nth-root.nl/public/images/wolf-commerce/edit_category.png)

它使用 jquery 添加/删除下拉菜单。

问题是：如何使用表单的 $_POST 数据来操作 category_attribute 表中的数据。

懒惰的解决方案是（是的，我过去曾这样做过）：
1\. 删除给定类别的 category_attribute 中的所有当前行
2\. 然后将所有选定的属性插入到 category_attribute

但这不是很有效，即使有人只更改了类别的标题，它也会删除并重新添加所有行。

所以我正在寻找一种方法来进行正确的插入、更新和删除：
1\. 删除 $_POST 中没有出现的行（下拉列表已被删除）
2\. 更新已更改的行（另一个选项来自已选择下拉菜单）
3\. 插入新行（已添加新下拉菜单）

我只是不知道该怎么做或在哪里可以找到一个很好的例子。使用一些 ajax 可能很容易，但我正在寻找一个纯 php 的解决方案，将 $_POST 值与数据库中的值进行比较。

如果有人知道一篇解释最佳（和最有效）解决方案的好文章，请告诉我，我将不胜感激。

-edit-
我已经包含了一些图片来澄清我的问题，但是由于我的声誉太低，堆栈溢出拒绝包含它们，所以我希望我的问题在没有图片的情况下足够清楚。

-edit2- 现在我有足够的声誉，我已经添加了图像。

提前致谢，

网卡

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:50:31.737

**插入和更新：**
您可以插入带有 ID 记录的隐藏输入。
那些新人将重置此 ID，因此您进行插入。
已填写您的 ID 进行更新。如果您只想执行更新真的改变了项目，您可以创建一个隐藏输入“UPDATED”，值为“0”。通过javascript，您可以检查组合是否已更改，以便将输入标记为“1”。

**排除：**
同样你可以做排除，创建一个隐藏的输入评分记录，当用户点击删除时应该删除。

*不知道这是否适合您，或者您是否期望更实际的解决方案。*

# css - HTML 背景尺寸：覆盖浮动对象

> ID：13240474
> 
> 赞同：1
> 
> 时间：2012-11-05T16:36:04.830
> 
> 标签：css

我有一个简单的页面，其正文具有图像背景，带有`background-size:cover`. 无论内容量如何，我都设置`html { height:100% }`为填满整个页面。到目前为止，一切都按预期工作。

我添加了一个`div`并设置了`position:absolute; right:0; width:200px;`This，再次按预期工作，直到我添加内容。

当这个 div 被填充太多以至于内容占用的空间超过页面的高度时，就会出现滚动条。向下滚动显示背景图像实际上并未覆盖整个页面。

这是因为我的 div 高于 HTML 高度的 100%。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T17:32:02.897

您可以添加`background-attachment:fixed;`到您的`body`元素。

这种方法的注意事项是背景现在固定在视口中并且不会随着文档滚动。

[https://developer.mozilla.org/en-US/docs/CSS/background-attachment](https://developer.mozilla.org/en-US/docs/CSS/background-attachment)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T17:15:49.953

像我在[这个 codepen](http://codepen.io/anon/pen/HwvJm)中那样做，它应该可以正常工作。

**更新**：（使用一些 JS）

有关更完整的解决方案，请参阅[此 codepen](http://codepen.io/anon/pen/Auqks)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:52:46.710

而不是通过`position:absolute`我`float`尽可能多地使用定位任何项目。

我还`<div>`为其中的全部内容添加了一个包装器，`<body>`这有助于正确格式化并`<div>`相应地扩展包含内容。标记及其背景属性现在`body`可以正常运行！

# crash - 在 python 3 idle 中使用特殊字符 ^ 或 ¨ 会使程序崩溃

> ID：13240479
> 
> 赞同：2
> 
> 时间：2012-11-05T21:13:18.690
> 
> 标签：crash, python-3.x, character, special-characters, python-idle

当我使用这些特殊字符`^`或`¨`在 python IDLE 版本 3 中时，它会使程序崩溃。

我是法国人，所以我在代码中的描述或注释中使用这些特殊字符。有没有办法在不使程序崩溃的情况下使用它？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:38:24.150

由于此类问题，许多语言规范和大多数编译器都特别建议不要使用特殊字符。

但是，来自[http://docs.python.org/2/reference/lexical_analysis.html](http://docs.python.org/2/reference/lexical_analysis.html)

> 2.3 版新功能：编码声明可用于指示字符串文字和注释使用不同于 ASCII 的编码。

所以包括那个声明，它*应该可以*工作。

如果您已经有这样的声明，那么问题可能不是因为字符本身，而是因为您的设置将 ^ 和 ¨ 重音符号与其他字符组合在一起的方式。虽然那时，我真的只是在黑暗中拍摄。

# php - 从数据库填充 HTML Dropbox 值的问题

> ID：13240492
> 
> 赞同：0
> 
> 时间：2012-11-05T21:14:15.853
> 
> 标签：php, mysql

我正在尝试通过使用 PHP 从 mysql 数据库中获取数据来填充 Dropbox 值。这是我尝试使用的代码

```
 <?php
       $con = mysql_connect("localhost","root","");
      if (!$con)
       {
        die('Could not connect: ' . mysql_error());
       }
       mysql_select_db("rumi", $con);
       $resultList = mysql_query("SELECT item FROM items");  
       while ($row = mysql_fetch_array($resultList))
       {
         echo "<option value='" . $row['item'] . "'>" . $row['item'] . "</option>";
        }
       echo "</select>";
       mysql_close($con);
     ?> 
```

但我遇到以下错误：警告：mysql_fetch_array() 期望参数 1 是资源，在第 22 行的 C:\wamp\www\Lst\index.php 中给出的布尔值你能租借让我知道为什么会这样吗？你也可以让我知道如何列出我的 HTML 无序列表中的项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:17:03.407

HTML 无序列表的工作方式如下：

```
<ul>
    <li>Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
    <li>Item 4</li>
</ul> 
```

至于错误，您的连接/查询似乎有问题。试试看`echo mysql_error();`是`mysql_query(...)`什么原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:17:39.880

尝试这样的事情：

```
$query= mysqli_query($con,"
     SELECT item FROM items") or die("Could not connect: 2".mysql_error()); 
```

这将告诉您遇到什么样的 SQL 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:46:10.407

尝试添加到您的 php 页面顶部：

```
error_reporting(E_ALL); 
ini_set( 'display_errors','1'); 
```

在页面上没有得到任何东西可能表示 php 错误。此代码将为您显示该错误。另外，我注意到没有打开的选择标签。只是一个 /select

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T21:19:38.923

您需要多次检查 MySQL 错误 - 您应该在尝试选择数据库和运行查询后检查：

```
if (!mysql_select_db("rumi", $con)) die(mysql_error());
if ($resultList === false) die(mysql_error()); 
```

此外，您应该使用已折旧的`mysqli_*`功能：http: [//us2.php.net/manual/en/intro.mysql.php](http://us2.php.net/manual/en/intro.mysql.php)`mysql`

# php - 创建数据库连接类 (PDO) 并获取数据

> ID：13240500
> 
> 赞同：6
> 
> 时间：2012-11-05T21:14:45.827
> 
> 标签：php

我是 OOP 的新手，所以我正在尝试学习如何创建类和使用它们。目前我正在尝试从我的 MySQL 表中获取数据。

要创建与 MySQL 的连接，我使用的是 PDO。我为数据库连接创建了一个单独的类。我已经在我的 show.php 文件中包含了这个类。现在我想从 MySQL 数据库中获取数据。问题是当我运行我的 show.php 文件时，它会显示此错误消息

> 致命错误：在第 10 行调用 C:\xampp\htdocs\jm\show.php 中未定义的方法 DBConnection::prepare()`

但它应该只显示`array`.

这个问题的解决方案是什么？

### 文件*db.class.php*

```
<?php
    class DBConnection {

        function DBConnection(){

            $host = 'localhost';
            $dbname = 'srijon';
            $user = 'root';
            $pass = '';

            try {
                $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
                $DBH->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

                return $DBH;
            }
            catch(PDOException $e) {

                echo 'ERROR: ' . $e->getMessage();
            }

        } // function ends

    } // class ends
?> 
```

### 文件*show.php*

```
<?php
    require_once 'db.class.php';

    function get_all(){

        $db = new DBConnection();

        $sql = "SELECT * FROM information";
        $STH = $db->prepare($sql);
        $STH->execute();
        $STH->setFetchMode(PDO::FETCH_ASSOC);

        return $STH;
    }

    echo get_all();
?> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-05T21:31:56.643

恕我直言，您可以将 PDO 连接注入需要它的函数中：

```
<?php

$dbHandle = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
$dbHandle->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
// always disable emulated prepared statement when using the MySQL driver
$dbHandle->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

function get_all($dbHandle) {
    $sql = "SELECT * FROM information";
    $stmt = $dbHandle->prepare($sql);
    $stmt->execute();
    $stmt->setFetchMode(PDO::FETCH_ASSOC);

    return $stmt;
}

get_all($dbHandle); 
```

如果你真的认为你需要一些类来访问数据库（除了 PDO）（你不需要），你将不得不扩展 PDO：

```
<?php

class DBConnection extends PDO
{
    public function __construct()
    {
        parent::__construct("mysql:host=$host;dbname=$dbname", $user, $pass);
        $this->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        // always disable emulated prepared statement when using the MySQL driver
        $this->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    }
}

$dbHandle = new DBConnection();

function get_all($dbHandle) {
    $sql  = "SELECT * FROM information";
    $stmt = $dbHandle->prepare($sql);
    $stmt->execute();
    $stmt->setFetchMode(PDO::FETCH_ASSOC);

    return $stmt;
}

get_all($dbHandle); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:24:55.287

也许将 DBConnections FUNCTION 更改为 __contstruct() 函数。此外，您需要扩展 PDO 类以使用其中的所有方法。

# c# - 保存表单属性

> ID：13240501
> 
> 赞同：1
> 
> 时间：2012-11-05T21:14:48.967
> 
> 标签：c#, .net, visual-studio-2010

我编写了 .net 代码并希望任何人帮助我并判断这是否正确:)。我制作了一个带有两个复选框和两个图片框和一个按钮的表单，并希望在关闭表单时保存复选框和图片框的值，并在重新运行后再次重新加载这些值。

我写的代码：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        //this.BackColor = Properties.Settings.Default.UserBackColor;

        Properties.Settings.Default.Reload();

    }

    private void checkBox1_CheckedChanged(object sender, EventArgs e)
    {
        if (checkBox1.Checked == true)
        {
            pictureBox1.Image = Image.FromFile("C:\\red.jpg");
            Properties.Settings.Default.Upgrade();

        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Properties.Settings.Default.Save();
        Application.Exit();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:06:29.240

这里的使用`Upgrade()`不正确。它用于在应用程序升级后更新设置。

删除那条线，一切都应该正常工作。

有一篇关于 CodeProject 的简短文章解释了应用程序设置的使用：http: [//www.codeproject.com/Articles/17659/How-To-Use-the-Settings-Class-in-C](http://www.codeproject.com/Articles/17659/How-To-Use-the-Settings-Class-in-C)

# c# - 我们什么时候应该使用 Action 并且不创建自定义委托

> ID：13240503
> 
> 赞同：2
> 
> 时间：2012-11-05T21:15:10.600
> 
> 标签：c#, delegates, design-choices

我们什么时候应该使用`Action<T>`而不是明确定义委托？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:22:14.797

这完全是一个偏好问题，但如果 Action 或 Func 的重载之一可以工作，我认为没有理由定义你自己的委托。如果您有 ref/out/params 参数、可选参数或其他一些此类边缘情况，您别无选择，只能定义自己的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:17:39.473

出色地...

```
Action<T> is almost the same as delegate void (T t)
and
Func<T> is almost the same as delegate T () 
```

Action 和 Func（和 lambdas）只是“语法糖”和使用委托的便利。

所以这实际上只是一个偏好问题。

# c - C中的链表堆栈

> ID：13240504
> 
> 赞同：2
> 
> 时间：2012-11-05T21:15:15.250
> 
> 标签：c, linked-list, stack

我正在查看“Programming Interviews Exposed”一书中的以下段落，参考了 C 中链表堆栈的实现：

```
typedef struct Element {
   struct Element *next;
   void *data; 
} Element;

void push( Element *stack, void *data ); 
void *pop( Element *stack ); 
```

> 现在考虑在适当的功能和错误处理方面在这些例程中会发生什么。这两个操作都会更改列表的第一个元素。必须修改调用例程的堆栈指针以反映此更改，但您对传递给这些函数的指针所做的任何更改都不会传播回调用例程。您可以通过让两个例程都获取指向堆栈指针的指针来解决此问题。这样，您可以更改调用例程的指针，使其继续指向列表的第一个元素。实施此更改会导致以下结果：

```
void push( Element **stack, void *data ); 
void *pop( Element **stack); 
```

有人可以用不同的语言解释为什么我们需要在这里使用双指针吗？我对所提供的解释有点不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:26:26.137

It is similar to the famous swap() function in C.

Case 1:

```
void swapFails(int x, int y) {
    int temp = x;
    x = y;
    y = temp;
} 
```

Case 2:

```
void swapOk(int *x, int *y) {
    int temp = *x;
    *x = *y;
    *y = temp;
} 
```

and we invoke swap like this:

```
int x = 10;
int y = 20; 
```

Case 1:

```
swapFails(x, y); 
```

Case 2:

```
swapOk(&x, &y); 
```

Remember, we wanted to CHANGE the values of x and y. For CHANGING values of a datatype, we need pointers. Take this to the next level for pointers. For CHANGING values of a pointer, we would need double pointers.

For Stack using linked list: If you push values 10, 20 and 30, they are stored like this:

```
top --- bottom
30 -> 20 -> 10 
```

So you see every time you push or pop values from the stack, which is a linked list, the top or the first node of the linked list changes. Hence you need double pointers.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:20:31.080

使用单指针签名，您可以想象使用如下代码

```
Element *myStack = NULL ;

.... bla bla bla ....

push(myStack, something); 
```

然后在`push`调用中，您将告诉堆栈实现堆栈的*旧*头元素在哪里，但是实现`push`无法告诉您*新*头在哪里。它不能更改您的`myStack`变量，因为在 C 中传递的参数始终是按值传递的——即，`push`函数被告知恰好是什么*值*，`myStack`但没有机会更改调用者的变量。

为了使事情正常工作，您需要告诉 push 原语它需要更改的局部变量的*地址：*

```
....
push(&myStack, something); 
```

并且由于`myStack`它本身具有 type `Element *`，*指向*`myStack`变量的指针具有type `Element **`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:17:32.220

第一个版本发送一个`copy`指针，如果它在函数内部被改变，那么*本地*副本只会被改变，当函数返回给*调用者*时，调用者仍然有一个指向*旧*地址的指针。

```
Element *stack =...
push (stack)
void push( Element *stack, void *data ) {
  stack = ... // this changes the local pointer allocated on the function's stack
}
//call returns
stack //still points to old memory 
```

然而，第二个版本将一个指针传递给堆栈指针，因此当它更改时，它会更改调用函数中的堆栈指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T21:19:48.483

In C everything is passed by value, let's say that I have this function:

```
void foo(void* ptr)
{
    ptr=NULL;
} 
```

If you call this method in the main, the pointer that you pass will not be NULL (unless it wat already NULL).Because a copy of the pointer is made before passing it to the function.So if you want to modify it's value, you have to pass a double pointer:

```
void foo(void** ptr)
{
    *ptr=NULL;
} 
```

The same is valid for the stack, of which you want to modify the value.

# highcharts - 缩放高图后执行功能

> ID：13240510
> 
> 赞同：6
> 
> 时间：2012-11-05T21:15:40.220
> 
> 标签：highcharts

放大 Highcharts 中的图表后是否可以执行功能？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-06T06:09:38.723

使用**afterSetExtremes**事件：

```
 xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
            'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        events: {
            afterSetExtremes: function(event){
                if (this.getExtremes().dataMin < event.min)
                    alert("Zoomed in!");
            }
        }
    } 
```

这是一个工作示例：http: [//jsfiddle.net/RcdfW/](http://jsfiddle.net/RcdfW/)

# javascript - 根据数值对嵌套数组进行排名

> ID：13240511
> 
> 赞同：1
> 
> 时间：2012-11-05T21:15:48.200
> 
> 标签：javascript, jquery, arrays, multidimensional-array

我关于这个主题的第一个问题得到了回答，它帮助我前进，所以如果这看起来是重复的，我深表歉意。我已经从第一个示例向前推进，现在正在尝试根据嵌套数组的每个元素中位置 (1) 的值对嵌套数组中的元素进行排名。以下适用于数字数组。

```
function mySorting(a, b) {
    return a == b ? 0 : (b < a ? -1 : 1)
}

var myArray = [28, 92, 12, 12, 2];
myArray.sort(mySorting);

var ranks = $.grep(myArray, function(item, idx) {
    return item != myArray[idx - 1];
}).reverse();

$.each(myArray, function(idx, item) {
    var rank= $.inArray( item, ranks)+1;
    $('body').append('Rank of '+item+ ' is '+ rank+'<br>')

})​ 
```

我的问题是当我将数组更改为：

```
var myArray = [["textA",28], ["textB",92], ["textC",12], ["textD",12], ["textE",2]]; 
```

我的排序功能不再起作用。任何人都可以帮助我或指出我正确的方向吗？我想根据每个嵌套元素中的数值对“myArray”进行排序。

再次非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:18:28.820

传递给排序函数的参数是要排序的数组中包含的任何内容。您的新数组包含两个元素的数组，因此当您对数组进行排序时，排序函数将收到该数组。

你说你想根据他们的第二个元素对双元素数组进行排序。为此，您应该将排序函数更改为如下所示：

```
function mySorting(a, b) {
    return a[1] == b[1] ? 0 : (b[1] < a[1] ? -1 : 1)
} 
```

* * *

**编辑：**如果您想为具有相同第二个元素的所有数组分配相同的排名，您还需要修改其余代码以在比较数组时仅考虑第二个元素。实际上，保持排序不变可能是最简单的，但在对数组进行排序之前，只需丢弃除第二个元素之外的所有内容：

```
function toSortKey(item) {
    return item[1];
}

function mySorting(a, b) {
    return a == b ? 0 : ( b < a ? -1 : 1 );
}

var myArray = [["textA",28], ["textB",92], ["textC",12], ["textD",12], ["textE",2]];

var sortKeys = $.map(myArray, toSortKey);
sortKeys.sort(mySorting);

var ranks = $.grep(sortKeys, function(item, idx) {
    return item != sortKeys[idx - 1];
}).reverse();

$.each(myArray, function(idx, item) {
    var rank = $.inArray( toSortKey(item), ranks ) + 1;
    $('body').append('Rank of ' + item + ' is ' + rank + '<br>')
})​; 
```

# java - 使用 JAXB 编组活动对象？

> ID：13240512
> 
> 赞同：1
> 
> 时间：2012-11-05T21:15:49.663
> 
> 标签：java, jaxb, marshalling, active-objects

我正在尝试编组一个将 Thread 扩展为 XML 的类，代码如下：

```
@XmlRootElement
public class TransitionXML extends Thread {

ArcXML[] preArcs;
ArcXML[] postArcs;
int[] preArcTokens;
int[] postArcTokens;
int leastTime;
int longestTime;
String name;

//some methods 

//a lot of get-set

@Override
public void run() {
    while (true) {
        if (this.postTransition() & this.preTransition()) {
            //We take out the tokens.
            this.executePreTranstion();
            this.checkPreTransition();

            try {
                this.sleep(1000 * this.getTimeToPass());
            } catch (InterruptedException ex) {
                Logger.getLogger(TransitionXML.class.getName()).log(Level.SEVERE, null, ex);
            }

            //We see if we can put them in.
            if (this.postTransition()) {
                this.executePostTranstion();
                this.checkPostTransition();
            }

        } else {
            try {
                this.sleep(2000);
            } catch (InterruptedException ex) {
                Logger.getLogger(TransitionXML.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }
}

}

public TransitionXML()
{

}

} 
```

}

这导致我出现这个错误：`com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException: 2 counts of IllegalAnnotationExceptions java.lang.Thread$UncaughtExceptionHandler is an interface, and JAXB can't handle interfaces. ... java.lang.Thread$UncaughtExceptionHandler does not have a no-arg default constructor.`

如果我正确理解这一点，它扩展 Thread 的事实会导致这个问题，但我还没有在网上看到解决方案。

除了使类成为实现可运行的对象之外，有没有人知道解决方案或解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:36:55.500

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

如果您使用 MOXy 作为您的 JAXB 提供程序，那么您可以`TransitionXML`按原样使用您的类。这是因为 MOXy 不会尝试为类`java`或`javax`包中的类创建元数据，例如`java.lang.Thread`.

您可以从以下位置获取 MOXy 二进制文件：

*   [http://www.eclipse.org/eclipselink/downloads/](http://www.eclipse.org/eclipselink/downloads/)

要将 MOXy 指定为您的 JAXB 提供程序，您需要`jaxb.properties`使用以下条目将调用的文件与域类放在同一包中（请参阅：[http ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as -your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html) )。

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

# .net - 开发类似于 .NET 的 SQL 框架的价值

> ID：13240513
> 
> 赞同：0
> 
> 时间：2012-11-05T21:15:59.220
> 
> 标签：.net, sql, frameworks

在微软的 .NET Framework 对 C#、Visual Basic、F#、PowerShell 等的广泛支持下，我一直想知道为什么没有创建任何类似的数据库开发框架（我一直找不到至少）。

这导致我考虑开发自己的框架，但我不禁想到，如果对这样的东西有很大的需求，那么肯定有人已经开始了这样的项目，无论是商业上的还是开源的项目。

我对技术方面的初步想法是：

*   该框架将尽可能模仿 Microsoft .NET Framework。就个人而言，我有点偏向于 .NET 和 T-SQL，但我认为通过提供与 .NET 类似的功能也有助于简化新开发人员的学习曲线。
*   会有某种类型的安装程序可以选择将框架对象部署在单独的专用数据库中，或者将对象包含在另一个数据库的模式中。此外，还可以选择简单地生成脚本来创建对象。
*   能够选择要安装的对象（类似于 jQuery UI 如何让您在[自定义下载包](http://jqueryui.com/download/)中选择所需的组件）以防止数据库变得臃肿。
*   支持严格的 ANSI SQL，以及特定于供应商的版本（例如 SQL Server、Oracle、MySQL）。

我想我真正想要的是：

1.  有没有人遇到过这样的已经开发的东西？
2.  你有什么相关的见解，为什么这是一个好主意或坏主意，无论是一般来说还是关于我在这里提到的事情？

**编辑**

基本上，我将框架设想为提供一组通用的辅助函数/过程、计数/数字表等......

一个典型的例子是将日期格式化为可用于 SQL Server 2012 之前版本的字符串的函数（SQL Server 2012 将此作为内置函数引入）。

而且，通过框架，我正在考虑数据库内的开发（即编程函数、存储过程、临时脚本等）与外部交互或连接到数据库（例如 Ling2Sql、ORM ）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T23:11:09.197

假设这些对象/帮助器存在于数据库中，而不是某种 .Net 库中，是的，有很多这些数据库帮助器函数四处飘荡，将它们收集到一个一致的库中肯定会有所帮助。

我认为最大的问题是性能。出于性能原因，有时需要使用一些可怕的内联表达式，而不是将其很好地包装到 UDF 中。或者优化您的 SQL 代码可能是有益的，因为您知道某个表有很多行或没有很多行，或者某个字段是否具有选择性。

这与安全问题一起可能意味着您的普通 DBA 不会想要安装您的帮助函数，因为他们不知道性能或安全影响。这与 DBA 不喜欢安装 CLR 函数的思路相同。

但我当然从未遇到过中央可安装的 SQL 辅助函数库，我想你可以看看 Codeplex 或许多其他开源代码库之一，看看是否存在这样的东西。

去吧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:19:25.997

我不确定您在说什么，但自 2005 年以来 .NET 已集成到 SQL Server 本身中。也许您正在考虑[CLR 集成](http://msdn.microsoft.com/en-us/library/ms254498%28v=vs.80%29.aspx)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:28:18.947

您应该调查[实体框架](http://msdn.microsoft.com/en-us/data/ef.aspx)和 [lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)。

# node.js - 如何写入 Windows Azure 网站中的 tmp/temp 目录

> ID：13240514
> 
> 赞同：0
> 
> 时间：2012-11-05T21:16:04.197
> 
> 标签：node.js, azure

我将如何写入 Windows azure 网站中的 tmp/temp 目录？我可以写入 blob，但我使用的 NPM 需要我为其提供文件名，以便它可以直接写入这些文件名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:28:00.340

Are you using Cloud Services (PaaS) or Virtual Machines (IaaS).

If PaaS, look at [Windows Azure Local Storage](http://msdn.microsoft.com/en-us/library/windowsazure/ee758708.aspx). This option gives you up to 250gb of disk space per core. Its a great location for temporary storage of information in a way that traditional apps will be familiar with. However, its not persistent so if you put anything there you need to make sure will be available if the VM instance gets repaved, then copy it to Blob storage. Also, this storage is specific to a given role instance. So if you have two instances of the same role, they each have their own local storage buckets.

Alternatively, you can use Azure Drive, which allows you to keep the information persisted, but still doesn't allow multiple parallel writes.

If IaaS, then you can just mount a data disk to the VM and write to it directly. Data disks are already persisted to blob storage so there's little risk of data loss.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T04:08:26.090

仅根据我的理解，如果有任何问题，请纠正我。

在 Windows Azure 网站中，您网站的内容将存储在 blob 存储中并作为驱动器安装，该驱动器将用于您的网站正在使用的所有实例。而且由于它在 blob 存储中，因此它是持久的。因此，如果您需要本地文件系统，我认为您可以使用网站根路径下的文件夹。但我不认为你可以使用系统`tmp`或`temp`文件夹。

# c - 如何将两个 gmpz_t 转换为一个 mpq_t？

> ID：13240516
> 
> 赞同：1
> 
> 时间：2012-11-05T21:16:10.437
> 
> 标签：c, type-conversion, gmp

我有两个整数（gmpz_t），我需要将它们表示为分数（一个是分子，另一个是分母）。我发现的唯一解决方案是使用`char* mpz_get_str (char *str, int base, mpz_t op)`将它们都转换为`char*`，然后用中间的“/”连接它们，然后使用 `int mpq_set_str (mpq_t rop, char *str, int base)`将值放入有理数。但这似乎需要付出很多努力，我想一定有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:20:32.847

为什么不将每个转换为`mpq_t`via `mpq_set_z`，然后划分？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-23T08:19:42.873

从[文档](https://gmplib.org/manual/Applying-Integer-Functions.html)`mpq_set_num`中，有一些函数`mpq_set_den`允许您从一些函数中单独设置分子和分母`mpz_t`。更一般地说，`mpq_numref`(resp. `mpq_denref`) 让您可以处理 an 的分子（分别是分母），`mpq_t`就好像它是 an 一样`mpz_t`，因此您可以调用`mpz_set(mpq_numref(q),z)`. 为了安全起见，我会在[`mpq_canonicalize`](https://gmplib.org/manual/Rational-Number-Functions.html)之后打电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-23T07:47:52.017

具体来说，如果你有`mpz_t rn, rd`（分子，分母），这将是我的解决方案：

```
mpq_t ratn, ratd, t;
mpq_init(ratn);
mpq_init(ratd);
mpq_set_z(ratn, rn);
mpq_set_z(ratd, rd);
mpq_init(t);
mpq_div(t, ratn, ratd);
mpq_clear(ratn);
mpq_clear(ratd);
...
do something with t
...
mpq_clear(t); 
```

# java - Jersey 服务器日志记录 /w Logback

> ID：13240520
> 
> 赞同：3
> 
> 时间：2012-11-05T21:16:45.293
> 
> 标签：java, tomcat, logging, jersey, logback

我将如何让 Jersey LoggingFilter 与 logback 一起工作？我看到了这个帖子：

[如何在服务器上获取球衣日志？](https://stackoverflow.com/questions/2332515/how-to-get-jersey-logs-at-server)

但不幸的是，它依赖于`java.util.Logger`. 当谈到 web.xml 配置时，我不是很精通，所以我不知道如何去提供`init-param`不同的记录器。

请注意，我使用 Spring 3 进行依赖注入，但我使用以下代码为每个类创建记录器：

`Logger logger = LoggerFactory.getLogger(MyClass.class);`

希望这是足够的信息。如果没有，请告诉我。

我的 Web 容器是 Tomcat 7.0.12。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-09-22T09:08:14.913

我尝试将 Jersey-Spring4 与 logback 一起使用，但无法通过 将访问日志重定向`LoggingFeature`到我的 logback-logger。logback-logger 的配置类似于`<logger name="org.glassfish.jersey" level="INFO"/>`，我认为这应该可以解决问题。

在得知 Jersey 使用 JUL 后，我难过几分钟，继续使用`org.slf4j:jul-to-slf4j`. 为了让它工作，我必须

```
private void registerLogback(final ServletContext servletContext) {
    servletContext.addListener(new LogbackConfigListener());

    //this is only necessary if you externalise logback.xml from resources     
    try { LogbackConfigurer.initLogging(servletContext.getRealPath("/WEB-INF/logback.xml")); }
    catch (FileNotFoundException | JoranException e) { e.printStackTrace(); }

    LogManager.getLogManager().reset();
    SLF4JBridgeHandler.removeHandlersForRootLogger();
    SLF4JBridgeHandler.install();
} 
```

在我的`WebApplicationInitializer.onStartup(ServletContext servletContext)`.

我的`ResourceConfig`样子

```
register(new LoggingFeature(createLogger(), Level.ALL, LoggingFeature.DEFAULT_VERBOSITY, 0)); 

private Logger createLogger() {
    final ConsoleHandler consoleHandler = new ConsoleHandler();
    consoleHandler.setLevel(Level.ALL);

    final Logger logger = Logger.getLogger(Logger.GLOBAL_LOGGER_NAME);
    logger.setLevel(Level.ALL);
    logger.addHandler(consoleHandler);

    return logger;
} 
```

什么记录了对控制台的访问。可悲的是，删除`ConsoleHandler`日志并没有最终导致日志被记录到 logback-logger，只是被吞了。**但是**控制台上的*红色*日志语句给了我暗示，这可能是`STDERR`，尽管他们是`INFO`。

最后[LoggingFeature 没有根据构造函数的配置正确记录](https://github.com/jersey/jersey/issues/3527 "LoggingFeature 未根据构造函数的配置正确记录")给了我缺失的部分。

我的期末和工作`ResourceConfig`结束了

```
register(new LoggingFeature(Logger.getLogger(LoggingFeature.DEFAULT_LOGGER_NAME), Level.INFO, LoggingFeature.DEFAULT_VERBOSITY, 0)); 
```

哪里`LoggingFeature.DEFAULT_LOGGER_NAME`和`Level.INFO`似乎是关键部分。

最后我不知道到底出错了，但这是我猜测的结果，它有效。如果这对任何人有帮助，我很高兴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:25:29.187

您可以`java.util.Logger`使用[jul-to-slf4j](http://www.slf4j.org/legacy.html#jul-to-slf4j)桥接对 Logback 的调用。安装后，您可以使用 logback.xml 控制 Jersey 日志记录（和任何其他 JUL）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-20T01:43:12.460

**`Slf4jLogger`**从`org.apache.cxf:cxf-core`包装是另一种选择。它实现`java.util.logging.Logger`了 cals 并将其委托给 slf4J。

泽西服务器：

```
ResourceConfig config = new ResourceConfig(HelloWorldResource.class);
config.register(
    new Slf4jLogger(this.getClass().getName(), null)); 
```

泽西岛客户：

```
ClientBuilder
    .newClient()
    .register(
        new LoggingFeature(
                new Slf4jLogger(this.getClass().getName(), null))); 
```

# php - 如何在 HTML 表格的不同行中显示答案

> ID：13240521
> 
> 赞同：0
> 
> 时间：2012-11-05T21:16:47.420
> 
> 标签：php, html, sql, mysqli

我在下面有这个查询：

```
SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, q.QuestionMarks
FROM Session s
INNER JOIN Question q ON s.SessionId = q.SessionId
JOIN Answer an ON q.QuestionId = an.QuestionId
AND an.SessionId = q.SessionId
WHERE s.SessionName =  "GHWSW1" AND q.QuestionId = 1
GROUP BY an.SessionId, an.QuestionId
ORDER BY q.QuestionId, an.Answer 
```

上面的查询在下面输出这个结果：

```
SessionId   SessionName QuestionId  QuestionContent         Answer  QuestionMarks
1           GHWSW1       1          Here are 2 answers      BD      5 
```

所以我在下面的代码中包含了查询并设置了一个 html 表：

```
$assessment = "GHWSW1";
$number = 1;

$query = "SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, 
GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, q.QuestionMarks 
   FROM Session s 
   INNER JOIN Question q ON s.SessionId = q.SessionId
   JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId
   WHERE s.SessionName = ? AND q.QuestionId = ?
   GROUP BY an.SessionId, an.QuestionId
   ORDER BY q.QuestionId, an.Answer
   ";

   // prepare query
   $stmt=$mysqli->prepare($query);
   // You only need to call bind_param once
   $stmt->bind_param("si", $assessment, $number);
   // execute query
   $stmt->execute(); 

       // This will hold the search results
    $searchQuestionId = array();
    $searchQuestionContent = array();
    $searchAnswer = array();
    $searchMarks = array();

    // Fetch the results into an array

   // get result and assign variables (prefix with db)
   $stmt->bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionContent, $dbAnswer, $dbQuestionMarks);
      while ($stmt->fetch()) {
        $searchQuestionId[] = $dbQuestionId;
        $searchQuestionContent[] = $dbQuestionContent;
        $searchAnswer[] = $dbAnswer;
        $searchMarks[] = $dbQuestionMarks;
      } 

?>      

</head>

<body>

<form id="QandA" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
<?php 

echo "<table border='1' id='markstbl'>
      <tr>
      <th class='questionth'>Question No.</th>
      <th class='questionth'>Question</th>
      <th class='answerth'>Answer</th>
      <th class='noofmarksth'>Total Marks</th>
      </tr>\n";

          foreach ($searchQuestionContent as $key=>$question) {

        echo '<tr class="questiontd">'.PHP_EOL;
        echo '<td class="optiontypetd">'.htmlspecialchars($searchQuestionId[$key]).'</td>' . PHP_EOL;
        echo '<td>'.htmlspecialchars($question).'</td>' . PHP_EOL;
        echo '<td class="answertd">'.htmlspecialchars($searchAnswer[$key]).'</td>' ;
        echo '<td class="noofmarkstd">'.htmlspecialchars($searchMarks[$key]).'</td>' . PHP_EOL;
}
        echo "</table>" . PHP_EOL;

        ?> 
```

所以 HTML 表显示如下：

```
QuestionId  QuestionContent         Answer  QuestionMarks
1           Here are 2 answers      BD      5 
```

但我希望它在 html 表中是这样的：

```
QuestionId  QuestionContent         Answer  QuestionMarks
1           Here are 2 answers      B       5
                                    D 
```

第二个答案`D`应该在单独的行中，其他行应该有一个行跨度。但是如何才能做到这一点呢？

会话表：

```
SessionId (auto)  SessionName
1                 AAA 
```

问题表：

```
SessionId  QuestionId (auto)  QuestionContent
1          1                  What is 2+2? 
```

答案表：

```
AnswerId (auto) SessionId  QuestionId   Answer
1               1          1           B   
2               1          1           D 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:06:59.727

尝试这个

```
 foreach ($searchQuestionContent as $key=>$question) {

    echo '<tr class="questiontd">'.PHP_EOL;
    echo '<td class="optiontypetd">'.htmlspecialchars($searchQuestionId[$key]).'</td>' . PHP_EOL;
    echo '<td>'.htmlspecialchars($question).'</td>' . PHP_EOL;
    echo '<td class="answertd">'.htmlspecialchars($searchAnswer[$key]).'</td>' ;
    echo '<td class="noofmarkstd">'.htmlspecialchars($searchMarks[$key]).'</td>' . PHP_EOL;
    echo '</tr>';
} 
```

你忘记关闭 tr 标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:14:08.757

删除 GROUP BY 子句并添加使 foreach 循环如下所示：

```
echo "<table border='1' id='markstbl'>
      <tr>
      <th class='questionth'>Question No.</th>
      <th class='questionth'>Question</th>
      <th class='answerth'>Answer</th>
      <th class='answermarksth'>Marks per Answer</th>
      <th class='noofmarksth'>Total Marks</th>
      </tr>\n";
                $previous_question_id = null;
          foreach ($searchQuestionContent as $key=>$question) {
            if ($previous_question_id == $searchQuestionId[$key]) {
          $searchQuestionId[$key] = '';
          $question = '';
          $searchMarks[$key] = '';
      }else{
          $previous_question_id = $searchQuestionId[$key];
      }
        echo '<tr class="questiontd">'.PHP_EOL;
        echo '<td class="optiontypetd">'.htmlspecialchars($searchQuestionId[$key]).'</td>' . PHP_EOL;
        echo '<td>'.htmlspecialchars($question).'</td>' . PHP_EOL;
        echo '<td class="answertd">';
        echo $searchAnswer[$key];
        echo '</td>' ;
        echo '<td class="answermarkstd"><input class="individualMarks" name="answerMarks[]" id="individualtext" type="text" "/></td>' . PHP_EOL;
        echo '<td class="noofmarkstd">'.htmlspecialchars($searchMarks[$key]).'</td>' . PHP_EOL;
}      
        echo '</tr>';
        echo "</table>" . PHP_EOL; 
```

# ios - 你如何让键盘出现没有 UITextField

> ID：13240525
> 
> 赞同：2
> 
> 时间：2012-11-05T21:16:57.570
> 
> 标签：ios, ios5

viewDidLoad 时如何让键盘自动出现？我也不想使用 UITextField 使键盘出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:43:45.563

将 UITextField 添加到您的视图并调用它`[myTextfield becomeFirstResponder];`然后将其设置为隐藏`myTextfield.hidden = true`- 这样用户将永远不会看到文本字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T15:22:42.583

你可以这样做：

*   子类化 UIView（它是 UIResponder 的子类）

*   使您的 UIView 子类符合协议 UIKeyInput。为此，在类声明中添加 < UIKeyInput > 并将此代码添加到 .m 文件

添加此代码：

```
-(BOOL)hasText;
{
    return YES;
}
-(void)insertText:(NSString *)text;
{
    // what to do when a text is inserted
}

-(void)deleteBackward;
{
    // what to do when delete is pressed
}

-(BOOL)canBecomeFirstResponder
{
    // return yes if your control can become first responder and show the keyboard
    return YES;
} 
```

*   创建此自定义视图的新实例并将其添加为当前窗口的子视图（否则将不起作用）

然后，要显示键盘，您只需调用 [myView becomeFirstResponder]; 刚试过，效果很好。

**编辑：没有尝试过，但它应该不仅可以继承 uiview，还可以继承所有类型的 UIView 子类并且可以添加到窗口层次结构中的对象，只是它必须符合 UIKeyInput 协议**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:43:18.897

我知道没有 UITextField 的唯一方法是创建和添加（**私有，未记录**）`UIKeyBoard`类的实例。你可以在[这里](https://github.com/H2CO3/FileTransfer/blob/master/FTViewController.m)找到一个实现，在`showKeyboard:animated:`方法中。

# java - Java 与 SourceDataLine 同时播放 2 字节缓冲区

> ID：13240527
> 
> 赞同：1
> 
> 时间：2012-11-05T21:17:03.253
> 
> 标签：java, audio, playback, synchronize

我正在尝试使用 SourceDataLine 编写 2 个不同的缓冲区（缓冲区 A 和 B），以同时播放声音。但它不断在缓冲区 A 和缓冲区 B 之间切换，我是否需要在将缓冲区写入我的 SourceDataLine 之前将它们合并在一起，或者有没有办法同步播放它们？

```
class PlayThread extends Thread {
    byte[] buffer = new byte[2 * 1024];

    @Override
    public void run() {
        try {
            while (true) {
                DatagramPacket receive = new DatagramPacket(buffer, buffer.length);
                mDatagramSocket.receive(receive);
                mSourceDataLine.write(receive.getData(), 0, receive.getData().length);

                System.out.println("Received!");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

我有 2 个带有不同传入缓冲区的 PlayThread 实例。下面是初始化 SourceDataLine 的函数。

```
private void init() {
    try {
        DataLine.Info sourceDataLineInfo = new DataLine.Info(
                SourceDataLine.class, audioFormat);
        DataLine.Info targetDataLineInfo = new DataLine.Info(
                TargetDataLine.class, audioFormat);

        Mixer.Info[] mixerInfo = AudioSystem.getMixerInfo();

        Mixer mixer = AudioSystem.getMixer(mixerInfo[3]);
        mSourceDataLine = (SourceDataLine) AudioSystem
                .getLine(sourceDataLineInfo);
        mTargetDataLine = (TargetDataLine) mixer.getLine(targetDataLineInfo);

        mSourceDataLine.open(audioFormat, 2 * 1024);
        mSourceDataLine.start();

        mTargetDataLine.open(audioFormat, 2 * 1024);
        mTargetDataLine.start();
    } catch (LineUnavailableException ex) {
        ex.printStackTrace();
    }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:32:46.900

你绝对必须合并它们。想象一下从两个线程将数字写入文件：

```
123456...
123456... 
```

可能变成

```
11234235656... 
```

这是发生在你身上的事情。

另一个问题是您需要在数据从网络传入时对其进行缓冲，否则您可能会丢弃它。您至少需要两个线程——一个用于阅读，一个用于播放以使其正常工作。但是，在您的情况下，每个输入数据包流使用一个读取器线程可能会更好。（请参阅我的演讲幻灯片：[http](http://blog.bjornroche.com/2011/11/slides-from-fundamentals-of-audio.html) ://blog.bjornroche.com/2011/11/slides-from-fundamentals-of-audio.html我特别有一张关于从 http 流式传输的幻灯片，这也与此处相关）

因此，不要使用多个 PlayThreads，而是创建多个 ReaderThreads，它们等待数据然后写入某种类型的缓冲区（`PipedInput`并且`PipedOutputStream`适用于 Java）。然后您需要另一个线程从缓冲区读取数据，然后将组合数据写入流。

这留下了如何组合数据的原始问题。答案是没有单一的答案，但通常最简单的正确方法是逐个样本对数据进行平均。但是，具体如何执行取决于您的数据格式，您的代码不包含该格式。假设它是 big-endian 16 位整数，您需要将传入的原始数据转换为 short，平均 short，然后将平均 short 转换回字节。

使用and最容易完成`byte`to`short`转换。`DataInputStream``DataOutputStream`

# rest - 免费 Rest API 以字符串形式检索当前日期时间（与时区无关）

> ID：13240530
> 
> 赞同：47
> 
> 时间：2012-11-05T21:17:17.887
> 
> 标签：rest, api, time, timer, timezone-offset

我正在寻找一个可靠的**REST API**，它可以跨平台提供**世界时间和时区信息**。

我需要当前时间作为字符串。无论用户在全球的位置如何，我都希望它**在一秒钟内返回结果。**

在其他实现中，我想将它用于一致的倒数计时器，比用户的[可能不准确的]计算机时间更准确。它可以是 GMT 或其他时区，只要指定了时区和偏移量，例如`2012-11-05 16:16:50 EST`.

我会自己构建这个 API，但在通过**像**Rails 这样的整个大型软件堆栈过滤某人只是为了返回一个简单的`String`.

远离美国东海岸的用户的过度延迟将抵消任务所需的准确性带来的好处。

感谢任何建议和/或示例。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-05T21:19:24.390

TimezoneDb 提供免费 API：[http ://timezonedb.com/api](http://timezonedb.com/api)

GenoNames 还有一个 RESTful API 可用于获取给定位置的当前时间：[http](http://www.geonames.org/export/ws-overview.html) ://www.geonames.org/export/ws-overview.html 。

如果您喜欢 GMT，您可以使用英国格林威治。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-06T01:56:26.243

此 API 为您提供当前时间和 JSON 格式的多种格式 - [https://market.mashape.com/parsify/format#time](https://market.mashape.com/parsify/format#time)。这是一个示例响应：

```
{
  "time": {
    "daysInMonth": 31,
    "millisecond": 283,
    "second": 42,
    "minute": 55,
    "hour": 1,
    "date": 6,
    "day": 3,
    "week": 10,
    "month": 2,
    "year": 2013,
    "zone": "+0000"
  },
  "formatted": {
    "weekday": "Wednesday",
    "month": "March",
    "ago": "a few seconds",
    "calendar": "Today at 1:55 AM",
    "generic": "2013-03-06T01:55:42+00:00",
    "time": "1:55 AM",
    "short": "03/06/2013",
    "slim": "3/6/2013",
    "hand": "Mar 6 2013",
    "handTime": "Mar 6 2013 1:55 AM",
    "longhand": "March 6 2013",
    "longhandTime": "March 6 2013 1:55 AM",
    "full": "Wednesday, March 6 2013 1:55 AM",
    "fullSlim": "Wed, Mar 6 2013 1:55 AM"
  },
  "array": [
    2013,
    2,
    6,
    1,
    55,
    42,
    283
  ],
  "offset": 1362534942283,
  "unix": 1362534942,
  "utc": "2013-03-06T01:55:42.283Z",
  "valid": true,
  "integer": false,
  "zone": 0
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-06T15:43:01.827

如果您使用的是 Rails，您可以在公共文件夹中创建一个空文件并使用 ajax 来获取它。然后[解析](https://stackoverflow.com/questions/220231/accessing-http-headers-in-javascript)Date 标头的标头。Public 文件夹中的文件绕过 Rails 堆栈，因此延迟较低。

# c++ - 具有可见边缘的 C++ OpenGL 空立方体

> ID：13240533
> 
> 赞同：3
> 
> 时间：2012-11-05T21:17:23.283
> 
> 标签：c++, opengl

我正在尝试创建一个立方体。我希望立方体本身清晰（黑色，因为背景是黑色），但我希望 12 条线是细的和白色的。这样做是创建线条并将它们放在边缘之上的唯一方法吗？还是有不同的方法来处理它？

原因是我必须创造在盒子内弹跳的球。

也许我应该只做 glBegin(GL_LINES) 甚至不用担心表面会发生碰撞，因为我可以用数学方法创建它？

我只是像这样创造我的一面：

```
glBegin(GL_POLYGON);
glVertex3f( -0.5, -0.5,  0.5 );
glVertex3f( -0.5,  0.5,  0.5 );
glVertex3f( -0.5,  0.5, -0.5 );
glVertex3f( -0.5, -0.5, -0.5 );
glEnd(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T21:25:25.597

您可以只绘制“线框”立方体。您将看到边缘但看不到面。将填充模式设置为连线和渲染线而不是多边形。

```
glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);  // this tells it to only render lines

glBegin(GL_LINES);

// endpoints of 1 line/edge
glVertex3f( ... 
glVertex3f( ...

// endpoints of second line/edge
glVertex3f( 
glVertex3f( 

// on up thru all 12 lines/edges

glEnd(); 
```

现在，这不是最有效的。您也许可以使用线条，或者只绘制 6 个四边形。但由于这是“第一天”，这可能是一个简单的开始。

最终，您将根本不想使用固定功能 - 它已被弃用。但这将为您提供一个熟悉矩阵和光照等的环境。当您有严肃的几何图形要渲染时，您会将其放入缓冲区并大块发送到 GPU，让您的 GLSL 着色器处理显卡上的数据。

欢迎来到图形！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:24:58.607

> 也许我应该只做 glBegin(GL_LINES) 甚至不用担心表面会发生碰撞，因为我可以用数学方法创建它？

正确的。您已经知道立方体的边界。

做一些线条，然后反弹你的球。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:27:13.213

You could set the polygon mode (glPolygonMode, read here) to GL_LINE to achieve the same thing.

> > Maybe I should just do glBegin(GL_LINES) and not even worry about surfaces to collide against since I can just create that mathematically?

OpenGL isn't going to help you with collisions of any sort.

As a somewhat off topic note, consider using a more modern approach. Immediate mode drawing is effectively deprecated, even if you aren't using the newer OpenGL versions.

[This](http://www.arcsynthesis.org/gltut/) is a decent place to start

# excel - 需要 VBA 协助根据表 1 中的值将数据复制到表 2 中的一行，并从表 1 中删除原始数据

> ID：13240536
> 
> 赞同：2
> 
> 时间：2012-11-05T21:17:35.073
> 
> 标签：excel, vba

我在 VBA 代码方面相对缺乏经验，但是有一个我试图根据行中列出的项目的“状态”来组织的工作簿。

我在“M”列中有一个下拉框，允许用户选择“HOLD”或“RELEASED”...根据此值，需要将行项目复制并粘贴到工作表 2 中的同一行中，如果value = "RELEASED"（行项目范围示例为 ("B7:N7")（工作表格式完全相同）。我有这方面的代码，但我需要从工作表中删除 "RELEASED" 行项目1 复制并粘贴到工作表 2 后。

这是我所拥有的...（零件暂存日志 = 表 1 ...已发布的零件日志 = 表 2）

```
Public Sub CopyPasteRows()

Sheets("Parts Staging Log").Select
' Find the last row of data
FinalRow = Range("B828").End(xlUp).Row
' Loop through each row
For x = 7 To FinalRow
' Decide to copy based on column M value "RELEASED"
ThisValue = Range("M" & x).Value
If ThisValue = "RELEASED" Then
Range("B" & x & ":BM" & x).Copy
Sheets("Released Parts Log").Select
NextRow = Range("B828").End(xlUp).Row + 1
Range("B" & NextRow).Select
ActiveSheet.Paste
Sheets("Parts Staging Log").Select
End If
Next x

End Sub 
```

如果有人可以帮助我删除原始订单项，那就太好了。其他意见也接受！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:30:24.380

我对此的看法：删除循环（太慢）并用自动过滤器替换

```
Public Sub CopyPasteRows()
Dim FinalRow As Long

With Sheets("Parts Staging Log")
' Find the last row of data
    FinalRow = .Range("B828").End(xlUp).Row
    .Range("B6:BM" & FinalRow).AutoFilter
    .Range("B6:BM" & FinalRow).AutoFilter field:=12, Criteria1:="RELEASED"
    .Range("B7:BM" & FinalRow).SpecialCells(xlCellTypeVisible).Copy Sheets("Released Parts Log").Range("B828").End(xlUp).Offset(1)
    .Range("B7:BM" & FinalRow).SpecialCells(xlCellTypeVisible).EntireRow.Delete
    .Range("B6:BM" & FinalRow).AutoFilter    
End With

End Sub 
```

# c++ - 查找最接近当前时间的时间

> ID：13240542
> 
> 赞同：2
> 
> 时间：2012-11-05T21:17:43.767
> 
> 标签：c++, time, systemtime

我想我的大脑只是抛出了一个内存不足异常并崩溃了，我的问题是我有一个`SYSTEMTIME`大小为 3 的类成员数组，它是用户定义的（从 .lua 读取）

```
SYSTEMTIME m_MatchTime[3]; 
```

然后从文件中以这种方式读取：

```
m_MatchTime[0].wDayOfWeek = static_cast<WORD>( m_Lua.GetGlobalNumber( "FirstDay" ) );
m_MatchTime[0].wHour = static_cast<WORD>( m_Lua.GetGlobalNumber( "FirstHour" ) );
m_MatchTime[0].wMinute  = static_cast<WORD>( m_Lua.GetGlobalNumber( "FirstMinute" ) );

m_MatchTime[1].wDayOfWeek = static_cast<WORD>( m_Lua.GetGlobalNumber( "SecondDay" ) );
m_MatchTime[1].wHour = static_cast<WORD>( m_Lua.GetGlobalNumber( "SecondHour" ) );
m_MatchTime[1].wMinute  = static_cast<WORD>( m_Lua.GetGlobalNumber( "SecondMinute" ) );

m_MatchTime[2].wDayOfWeek = static_cast<WORD>( m_Lua.GetGlobalNumber( "ThirdDay" ) );
m_MatchTime[2].wHour = static_cast<WORD>( m_Lua.GetGlobalNumber( "ThirdHour" ) );
m_MatchTime[2].wMinute  = static_cast<WORD>( m_Lua.GetGlobalNumber( "ThirdMinute" ) ); 
```

现在我有一个方法：

```
SYSTEMTIME cTime;
GetLocalTime( &cTime ); 
```

我必须从三个用户定义的时间中计算出哪个是 BEFORE 和更接近当前时间，然后计算到它的剩余时间，（请注意 Sunday = 0，Saturday = 6，还请注意，只有 wDayOfWeek、wHour 和 wMinute 必须是与到达最近的位置相比）

**编辑：现在我奖励*500 赏金*以获得解决方案，请注意我想要的示例，**

**今天：第 4 天，第 3 小时，第 0 分钟，
日期：第 5 天，第 5 小时，第 30 分钟
距离日期的剩余时间为：1 天 2 小时 30 分钟**。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T21:30:55.020

鉴于问题域，似乎没有必要（甚至不希望）强制执行严格的时间排序，您只想找到一组时间中最接近给定标记值的时间。这将需要线性复杂性，但很容易实现。

我建议计算与已知纪元的时间差，在本例中为周日 00:00:00（以秒为单位），然后比较从该点开始的每个时间的差异，看看哪个最接近。

```
#include <Windows.h>
#include <algorithm>
#include <iostream>

long seconds_from_sunday_epoch(const SYSTEMTIME& t)
{
   size_t seconds = t.wDayOfWeek * 86400;
   seconds += t.wHour * 3600;
   seconds += t.wMinute * 60;
   return seconds;
}

size_t timediff_2(const SYSTEMTIME& t0, const SYSTEMTIME& t1)
{
   size_t seconds_diff = std::abs(
      seconds_from_sunday_epoch(t0) -
      seconds_from_sunday_epoch(t1));

   return seconds_diff;
}

int main()
{
   SYSTEMTIME m_MatchTime[3];

   // Monday: 00:00
   m_MatchTime[0].wDayOfWeek = 1;
   m_MatchTime[0].wHour = 0;
   m_MatchTime[0].wMinute = 0;

   // Sunday: 01:00
   m_MatchTime[1].wDayOfWeek = 0;
   m_MatchTime[1].wHour = 1;
   m_MatchTime[1].wMinute = 0;

   // Wednesday: 15:30
   m_MatchTime[2].wDayOfWeek = 3;
   m_MatchTime[2].wHour = 15;
   m_MatchTime[2].wMinute = 30;

   // Sunday 23:00
   SYSTEMTIME cTime;
   cTime.wDayOfWeek = 0;
   cTime.wHour = 23;
   cTime.wMinute = 0;

   std::cout << timediff_2(cTime, m_MatchTime[0]) << "\n";
   std::cout << timediff_2(cTime, m_MatchTime[1]) << "\n";
   std::cout << timediff_2(cTime, m_MatchTime[2]) << "\n";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-05T22:08:52.360

所以问题是你坐在一个圆圈上，想知道从 d1 到 d2 的距离是向右（保持在同一周内）还是向左（一个值到下一个星期天）更短。

首先，您应该使用公式 min+hour*60+weekday*60*24 将日期转换为值。这将为您提供一周的时间。

```
#include <stdlib.h>
int minOfWeek (int d, int h, int m) {
  return d*60*24+h*60+m;
} 
```

接下来找到最小距离：

```
const int minutesInWeek=60*24*7;
int bestDistance (int minutes1, int minutes2) {
  int d=abs (minutes1-minutes2);
  int dNext=minutesInWeek-d;
  return d<dNext?d:dNext;
} 
```

因此，从您的实际时间计算 minOfWeek，将您一周内的所有 3 次喂给 bestDistance 并取最小的数字...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T19:00:30.277

标准 C++ 库通过将比较日期的“魔法”转移到仿函数并使用[`std::sort`](http://www.cplusplus.com/reference/algorithm/sort/)采用自定义比较器的重载，让您可以相当优雅地解决这个问题。

以下是您可以使用很少几行代码的方法（[链接到 ideone 上的快速测试](http://ideone.com/VFxpGJ)）：

```
class ClosestTo {
    int minute_now;
    int abs_minute(const SYSTEMTIME& t) const {
        return 60 * (24 * t.wDayOfWeek + t.wHour) + t.wMinute;
    }
    int diff_to_now(const SYSTEMTIME& t) const {
        int res = abs_minute(t) - minute_now;
        // Has the date passed this week?
       if (res < 0) {
            // Yes, the date has passed - move to next week:
            res += 7*24*60;
       }
        return res;
    }
public:
    ClosestTo(const SYSTEMTIME& now)
    :   minute_now(abs_minute(now)) {
    }
    // This is the operator the std::sort is going to call to determine ordering
    bool operator() (const SYSTEMTIME& lhs, const SYSTEMTIME& rhs) const {
        // Pick the date implying the shortest difference to minute_now
        return diff_to_now(lhs) < diff_to_now(rhs);
    }
}; 
```

就是这样，真的！有了这个比较器，您可以像这样对三个日期进行排序：

```
ClosestTo cmp(cTime);
sort(m_MatchTime, m_MatchTime+3, cmp); 
```

现在最近的日期在索引零处：

```
SYSTEMTIME &nearest = m_MatchTime[0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T22:05:01.110

我为解决方案提供了一个算法，我知道它远非最专业的方法，但到目前为止它完美无缺。

```
int main()
{
SYSTEMTIME m_MatchTime[3];

// Monday: 00:00
m_MatchTime[0].wDayOfWeek = 1;
m_MatchTime[0].wHour = 22;
m_MatchTime[0].wMinute = 4;

// Sunday: 01:00
m_MatchTime[1].wDayOfWeek = 4;
m_MatchTime[1].wHour = 1;
m_MatchTime[1].wMinute = 0;

// Wednesday: 15:30
m_MatchTime[2].wDayOfWeek = 6;
m_MatchTime[2].wHour = 15;
m_MatchTime[2].wMinute = 30;

// Sunday 23:00
SYSTEMTIME cTime;
cTime.wDayOfWeek = 3;
cTime.wHour = 14;
cTime.wMinute = 5;

/*  std::cout << timediff_2(cTime, m_MatchTime[0]) << "\n";
std::cout << timediff_2(cTime, m_MatchTime[1]) << "\n";
std::cout << timediff_2(cTime, m_MatchTime[2]) << "\n";*/

vector<size_t>m_Time;
if( cTime.wDayOfWeek == 0 )
{
    for( int i =0; i<3; i++ )
    {
        if( cTime.wDayOfWeek >= m_MatchTime[i].wDayOfWeek )
            m_Time.push_back( timediff_2(cTime, m_MatchTime[i]) );
    }

    if( m_Time.size() == 0 ) //trim right
    {
        for( int i =0; i<3; i++ )
        {
            if( cTime.wDayOfWeek <= m_MatchTime[i].wDayOfWeek )
                m_Time.push_back( timediff_2(cTime, m_MatchTime[i]) );
        }
    }
}
else
{
    for( int i =0; i<3; i++ )
    {
        if( cTime.wDayOfWeek <= m_MatchTime[i].wDayOfWeek )
            m_Time.push_back( timediff_2(cTime, m_MatchTime[i]) );
    }

    if( m_Time.size() == 0 ) //trim right
    {
        for( int i =0; i<3; i++ )
        {
            if( cTime.wDayOfWeek >= m_MatchTime[i].wDayOfWeek )
                m_Time.push_back( timediff_2(cTime, m_MatchTime[i]) );
        }
    }
}

std::sort( m_Time.begin(), m_Time.end() );

SYSTEMTIME nearest;
if( m_Time.size() > 0 )
{
    for( int l=0; l<3; l++ )
    {
        if( timediff_2( cTime, m_MatchTime[l] ) == m_Time.at(0) )
        {
            nearest = m_MatchTime[l];
            break;
        }
    }
}

unsigned int manydaysleft = howmanydaysuntil(  nearest.wDayOfWeek , cTime.wDayOfWeek );
unsigned int manyhoursleft = howmanyhoursuntil(  nearest.wHour, cTime.wHour );
if( nearest.wHour < cTime.wHour ) //manydaysleft will always be > 0
    manydaysleft--;
unsigned int manyminutesleft = howmanyminutesuntil( nearest.wMinute, cTime.wMinute );
if( nearest.wMinute < cTime.wMinute )
    manyhoursleft--;

/*cout 
    << manydaysleft << endl
    << manyhoursleft << endl
    << manyminutesleft << endl;*/

cout << "CurrentTime\n"  
    << "Day:" << cTime.wDayOfWeek
    << "Hour:" << cTime.wHour
    << "Min:" << cTime.wMinute 

    << "\nDay:" << nearest.wDayOfWeek
    << "Hour:" << nearest.wHour
    << "Min:" << nearest.wMinute

    << "\nDay:" << manydaysleft
    << "Hour:" << manyhoursleft
    << "Min:" << manyminutesleft;

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-09T05:33:03.960

`const unsigned n=3; //replace with actual array size`

```
auto packtime = [](const SYSTEMTIME& t)->unsigned
{
    return t.wDayOfWeek*24*60 + t.wHour*60 + t.wMinute;
};
auto unpacktime = [](unsigned total)->SYSTEMTIME
{
    SYSTEMTIME ret;

    ret.wDayOfWeek = total/(60*24);
    total %= (60*24);
    ret.wHour = total/60;
    ret.wMinute = total%60;

    return ret;
};

unsigned const wraptime = 7*24*60;
unsigned targettime = packtime(cTime);

unsigned mintimedif = wraptime + 1;
unsigned mindifidx;
unsigned timedif;

for(unsigned i=0; i<n; ++i)
{
    timedif = packtime(m_MatchTime[i]);

    if(timedif < targettime)
        timedif = targettime - timedif;
    else
        timedif = wraptime - timedif + targettime;

    if(timedif < mintimedif)
    {
        mintimedif = timedif;
        mindifidx = i;
    }
}

SYSTEMTIME dif = unpacktime(mintimedif);

std::cout<<"Today: Day "<<cTime.wDayOfWeek<<" Hour "<<cTime.wHour<<" Minute "<<cTime.wMinute<<std::endl;
std::cout<<"Nearest day: Day "<<m_MatchTime[mindifidx].wDayOfWeek<<" Hour "<<m_MatchTime[mindifidx].wHour<<" Minute "<<m_MatchTime[mindifidx].wMinute<<std::endl;
std::cout<<"Difference: "<<dif.wDayOfWeek<<" days "<<dif.wHour<<" hours "<<dif.wMinute<<" minutes"<<std::endl;</code> 
```

# sql - 交易价值大于或小于零的发票分组

> ID：13240543
> 
> 赞同：1
> 
> 时间：2012-11-05T21:17:47.633
> 
> 标签：sql, join

我试图对此进行查询，但我还没有运气。表格如下：

```
INVOICE
ID | INVOICENUMBER | CUSTOMER | VALUE
1 | 999 | 8 | 9000
2 | 999 | 8 | 1000

INVOICE_TRANSACTION
InvoiceID | TYPE | VALUE
1 | cust | 5000
1 | cust | 2000
2 | cust | 1000
2 | cust | -1000

INVOICE_DETAIL
InvoiceID | PURCHASEORDERID
1 | 7777

PURCHASE_ORDER
PURCHASEORDERID | ORDERTYPE
7777 | gross

PURCASE_ORDER_DETAILS
PURCHASEORDERID | ROW | STATUS
7777 | 1 | 1
7777 | 2 | 2
7777 | 3 | 3 
```

我想要的结果是这样的：

```
INVOICE VALUE TRANSACTION VALUE PURCHASEORDERID ORDERTYPE HIGH STATUS LOW STATUS
------- ----- ----------------- --------------- --------- ----------- ----------
1       9000  7000              7777            gross     3           1 
```

换句话说，我希望结果对总`invoice_transaction.value`大于或小于 0 的所有发票编号进行分组。我是这一切的新手，谁能帮我开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:35:17.900

看起来你想要这样的东西：

```
select i.id,
  sum(i.value) value,
  it.value TransValue,
  p.purchaseorderid,
  p.ordertype,
  pd.highstatus,
  pd.lowstatus
from invoice i
left join 
(
  select sum(value) value, invoiceid
  from invoice_transaction
  group by invoiceid
) it
  on i.id = it.invoiceid
left join invoice_detail id
  on i.id = id.invoiceid
left join purchase_order p
  on id.purchaseorderid = p.purchaseorderid
left join
(
  select max(status) highStatus, min(status) LowStatus,
    purchaseorderid
  from purcase_order_details
  group by purchaseorderid
) pd
  on p.purchaseorderid = pd.purchaseorderid
where it.value <> 0
group by i.id, p.purchaseorderid, p.ordertype; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/613c0/23)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:23:43.867

要从值不为零的 INVOICE_TRANSACTION 获取发票 ID，

```
SELECT InvoiceID
FROM INVOICE_TRANSACTION
GROUP BY InvoiceID
HAVING SUM(VALUE) <> 0 
```

# javascript - 提交表单之前的 Ajax 调用

> ID：13240548
> 
> 赞同：3
> 
> 时间：2012-11-05T21:18:16.213
> 
> 标签：javascript, asp.net-mvc-3, jquery, razor

在使用ajax提交表单之前，我需要检查数据是否已经存在于数据库中。最常见的情况是检查用户名和电子邮件的可用性。

它不起作用，但我在不使用 from 控件的情况下测试了 ajax 函数，它工作正常。该项目是在 MVC 3 VB 中创建的。

Javascript：

```
$('#addSalesPeople').click(function () {
   $.post("ajax_functions/checkDuplicate.cshtml",
   {
      extension: document.getElementById('Extension').value,
      initials: document.getElementById('Initials').value
   },
      function (data, status) {
      alert("Data: " + data + "\nStatus: " + status);
   });
}); 
```

HTML：

```
@Using Html.BeginForm("Create", "SalesPeople", FormMethod.Post)
@Html.ValidationSummary(True)
@<fieldset>  
    ............................
    ..............................  

    @Html.TextBoxFor(Function(model) model.Extension, New With {.onkeyup = "javascript: charCounter(this,4);", .onblur = "javascript: zeroPad(this, 4)"})

    @Html.TextBoxFor(Function(model) model.Initials)

    <input id="addSalesPeople" class="btn span2" type="submit" value="Add" />

</fieldset> 
```

-谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-05T21:28:11.837

您需要观察`submit`表单的事件。

代替

```
$('#addSalesPeople').click(function () { 
```

采用

```
$('#theFormId').submit(function () { 
```

见：[http ://api.jquery.com/submit/](http://api.jquery.com/submit/)

您还可以[禁用表单提交](http://api.jquery.com/event.preventDefault/)并稍后手动发送：

```
$( '#theFormId' ).submit( function ( event ) {

    event.preventDefault();

    /* your AJAX code */

    $( '#theFormId' ).submit();
} ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-03T05:39:42.583

我正在发布一个经过实际测试的代码。

HTML：@using 中的简单表单发布按钮

```
(Html.BeginForm())
{

//use your text box or other control here 
<input type="submit" id="Create" value="Create" class="btn btn-primary" />

} 
```

JavaScript：

```
<script>

    $(document).ready(function () {

        $("form").submit(function (e) {
            e.preventDefault(); //prevent default form submit

            if ($(this).valid()) {

                var UserId= $('#UserId').val();

                $.ajax({
                    url: '/Home/CheckUserExist/',        //ControllerName/ActionName/
                    data: {
                        UserId: UserId                      
                    },
                    success: function (data) {
                        showMsg(data);
                    },
                    cache: false
                });
            }
        });

    });

    function showMsg(hasCurrentJob) {
        if (hasCurrentJob != "OK") {

            alert(hasCurrentJob);
            return false;
        } else {

    //if check is ok than from post to controller 

            $("form").unbind('submit').submit();
        }
    }

</script>

MVC Controller:

 public async Task<JsonResult> CheckUserExist(int UserId)
    {
            //condition for user check 

        if (UserExist==true)
        {
            return Json("User Exist Please choose another user name or etc", JsonRequestBehavior.AllowGet);         
    }

        return Json("OK", JsonRequestBehavior.AllowGet);
    } 
```

如果您有任何疑问，请给我发邮件 vishalroxx7@gmail.com。

# css - WebDriver - ":nth-of-type()" 选择器是否适用于 IE 9？

> ID：13240549
> 
> 赞同：0
> 
> 时间：2012-11-05T21:18:23.823
> 
> 标签：css, internet-explorer, selenium, css-selectors, webdriver

SeleniumHQ 表示每个驱动程序都支持其浏览器支持的任何 CSS 选择器。根据[这个站点](http://www.quirksmode.org/css/contents.html)，IE 9 应该支持**:nth-of-type()**选择器。但是，当我在这个选择器上执行时，我似乎`NullPointerException`从类的深处得到了一个。我的样子是这样的：`RemoteWebDriver``findElements``By.cssSelector`

```
table#ucsp_dgMultiSelect tr:nth-of-type(2) input#cbPres 
```

这在 Chrome 上运行良好。也许 IE 9 将选择器放在中间有问题，我不知道，但这会破坏我的很多代码。: **nth-of-type()**选择器已成为我在表中识别 WebElement 定位器的首选。有没有其他人成功使用**:nth-of-type()**选择器作为 WebDriver 和 IE 9 的定位器？

我正在使用**IEDriverServer.exe.2.25.2.0**，我的 IE 版本是**9.0.8112.16421 64 位**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:15:43.450

事实上，WebDriver 支持浏览器支持的 CSS 选择器，如果 IE9 支持`:nth-of-type()`选择器，那么 IE 驱动程序也应该支持。然而，这并不是故事的全部。如果`DOCTYPE`您的页面中`<!DOCTYPE html>`的以前版本的引擎。

由于您使用的是 IE9，因此有一种非常简单的方法可以查看 WebDriver 是否应该能够使用您尝试使用的选择器找到元素。在您感兴趣的页面上按功能键 F12 打开“F12 开发人员工具”。转到“开发人员工具”中的“脚本”选项卡，然后键入

```
document.querySelector('table#ucsp_dgMultiSelect tr:nth-of-type(2) input#cbPres') 
```

如果控制台显示元素信息，那么 WebDriver 应该可以找到它。如果没有，那么 IE 就找不到它，WebDriver 也永远不会。

这种调试技术将在您尝试使用 IE9 中的 CSS 选择器查找元素的任何时候起作用，并且对于帮助找出问题是 IE 还是驱动程序非常有用。此外，F12 开发人员工具还会告诉您 IE 尝试以何种模式呈现页面，这也很有指导意义。

# mysql - RESTeasy 数据库连接：NullPointer

> ID：13240552
> 
> 赞同：0
> 
> 时间：2012-11-05T21:18:48.550
> 
> 标签：mysql, jboss, nullpointerexception, resteasy

我有一个在 JBOSS AS 7 上运行的 RESTeasy 服务，它试图创建与本地数据库（mysql 服务器）的连接。

数据源在 JBOSS 管理中正确定义并且连接良好（JSF 应用程序可以很好地连接它并且它可以修改数据库），但是当我尝试在我的 RESTeasy 服务中连接时，它给了我一个 nullPointerException 我可以' t似乎弄清楚为什么。kumonobs 是有问题的数据库。错误发生在通过post请求调用的persist方法中。任何帮助将不胜感激，如果需要任何其他信息，请询问！

```
@Path("/RSAndroid")
@ApplicationScoped
public class HelloWorldResource implements Serializable{
@Resource(mappedName = "java:jboss/datasources/kumonobs")
private static DataSource dataSource;

private static ArrayList<Student> students = new ArrayList<Student>();

@GET()
@Produces("text/plain")
public String sayHello() {
    return stringStudents(students);
}

@POST()
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
public String postStudent(@FormParam("Student ID") String student){
    Date date = new Date();
    Student kumonstudent = new Student(student, date);
    studentCheck(kumonstudent); 
    System.out.println(kumonstudent.toString());
    return "OK";
}

public String stringStudents(ArrayList<Student> s){
    String students = "";
    for(Student student : s){
        students += student.toString();
    }   
    return students;
}

public void studentCheck(Student student){
    boolean checkIn = true;
    int count = 0;

    for(Student s : students){
        count++;
        //If Student has been found in the list.
        if(s.getStudentID().equals(student.getStudentID())){
            //remove the student from the list.
            students.remove(count-1);
            // ** DO DATABASE STUFF HERE FOR REMOVING STUDENT **
            checkIn = false;
            break;
        }
    }
    //If student needs to be checked in, add to list.
    if(checkIn){
        System.out.println(student.getDate());
        students.add(student);
        // ** DO DATABASE STUFF HERE FOR ADDING STUDENT **
        persist(student);

    }
}
//Insert student into database table.
public void persist(Student student) {
     PreparedStatement stmt = null;
       Connection connection = null;
       try {
           try {
               connection = dataSource.getConnection(); //ERROR OCCURS HERE NULLPOINTER
            try {
                 System.out.println("Fourth");
                stmt = connection.prepareStatement(
                        "INSERT INTO checkin VALUES (?, ?)");
                stmt.setString(1, "A00105010");
                stmt.setString(2, "Sample Name");
                stmt.executeUpdate();
            } finally {
                if (stmt != null) {
                    stmt.close();
                }
            }
        } finally {
            if (connection != null) {
                connection.close();
            }
        }
    } catch (SQLException ex) {
        System.out.println("Error in persist ");
        ex.printStackTrace();
    }
}
} 
```

堆

```
14:29:22,040 INFO  [stdout] (http--0.0.0.0-8080-1) 2012-11-06
14:29:22,040 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].    [/AndroidRS].[Resteasy]] (http--0.0.0.0-8080-1) Servlet.service() for servlet R
esteasy threw exception: org.jboss.resteasy.spi.UnhandledException:    java.lang.NullPointerException
        at         org.jboss.resteasy.core.SynchronousDispatcher.handleApplicationException(SynchronousDispatcher.java:340) [resteasy-jaxrs-2.3.2.Final.jar:]
        at     org.jboss.resteasy.core.SynchronousDispatcher.handleException(SynchronousDispatcher.java:214)     [resteasy-jaxrs-2.3.2.Final.jar:]
        at org.jboss.resteasy.core.SynchronousDispatcher.handleInvokerException(SynchronousDispatcher.java:190) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:540) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:502) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:119) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:208) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:50) [resteasy-jaxrs-2.3.2.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_27]
Caused by: java.lang.NullPointerException
    at org.jboss.samples.rs.webservices.HelloWorldResource.persist(HelloWorldResource.java:92) [classes:]
    at org.jboss.samples.rs.webservices.HelloWorldResource.studentCheck(HelloWorldResource.java:81) [classes:]
    at org.jboss.samples.rs.webservices.HelloWorldResource.postStudent(HelloWorldResource.java:44) [classes:]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_27]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_27]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_27]
    at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_27]
    at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:155) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:257) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:222) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:211) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:525) [resteasy-jaxrs-2.3.2.Final.jar:]
    ... 19 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T17:46:23.583

找到了解决方案，而不是使用数据源的注释：

```
String strDSName = "java:jboss/datasources/thenamehere";
ctx = new InitialContext();
dataSource = (javax.sql.DataSource) ctx.lookup(strDSName); 
```

# arrays - 如何使用bash或python从一组数字中搜索连续数字

> ID：13240564
> 
> 赞同：2
> 
> 时间：2012-11-05T21:19:43.540
> 
> 标签：arrays, bash

我有一个如下数字列表：

```
1  0/1
2  1/1
3  1/1
4  1/1
5  1/1
6  1/1
7  0/1
8  0/1 
```

如果连续行的第 2 列是“1/1”，我想报告位置的开始和结束，比如在这里，应该是：2-6

如果需要，我应该如何应用一些简单的 bash 代码或 python 来做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:40:29.083

如果您能够在 python 中编码，则可以通过以下方式解决它：

1.  阅读您的文件。
2.  仅当第二个数字为 时，才使用正则表达式创建包含第一个数字的列表`1/1`。
3.  按范围对列表进行分组。（[提示](https://stackoverflow.com/questions/4628333/converting-a-list-of-integers-into-range-in-python)）

所以代码看起来像：

```
import re

# step 1
with open('filename') as f:
    data = f.read()

# step 2
list = re.findall(r'(\d+)\s+1/1', data)

# step 3
# Check the link in the description of the algorithm 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:01:44.533

重击解决方案：

```
#! /bin/bash
unset in                                 # Flag: are we inside an interval?
unset last                               # Remember the last position.
while read p f ; do
    if [[ $f = 1/1 && ! $in ]] ; then    # Beginning of an interval.
        echo -n $p-
        in=1
    elif [[ $f = 1/1 && $in ]] ; then    # Inside of an interval.
        last=$p
    elif [[ $f != 1/1 && $in ]] ; then   # End of an interval.
        echo $last
        unset in
    fi
done 
```

# php - Yii 简单 rbac - checkAccess 未执行

> ID：13240565
> 
> 赞同：0
> 
> 时间：2012-11-05T21:19:46.507
> 
> 标签：php, yii, rbac

我是 Yii 的新手。我使用本教程：[http](http://www.yiiframework.com/wiki/328/simple-rbac/) ://www.yiiframework.com/wiki/328/simple-rbac/使管理员角色工作。我在控制器中的 accessRules 函数如下所示：

```
 public function accessRules() {
        return array(
            array('allow', // allow all users to perform 'index' and 'view' actions
                'actions' => array('index', 'view', 'create'),
                'users' => array('*'),
            ),
            array('allow', // allow authenticated user to perform 'create' and 'update' actions
                'actions' => array('update'),
                'users' => array('@'),
            ),
            array('allow', // allow admin user to perform 'admin' and 'delete' actions
                'actions' => array('delete', 'admin'),
                'users' => array('admin'),
            ),
            array('deny', // deny all users
                'users' => array('*'),
            ),
        );
    } 
```

如果我理解 - 当我尝试查看管理或删除操作时，它应该从 WebUser 类执行 checkAccess 函数。我的 checkAccess 函数如下所示：

```
public function checkAccess($operation,$params=array(),$allowCaching=true) {
    die("it works!");
    if (empty($this->id)) {
        // Not identified => no rights
        return false;
    }
    $admin = $this->getState("admin");

    return ($operation === 'admin' && $admin == ROLE_ADMIN || $operation !== 'admin');
} 
```

所以它应该查看“它有效！” 但我明白了

> 错误 403
> 
> 您无权执行此操作。

我做错什么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T22:23:24.570

```
Try changing 'users'=>array('admin') to 'roles'=>array('admin') 
```

# javascript - 根据标签名称单击复选框

> ID：13240589
> 
> 赞同：1
> 
> 时间：2012-11-05T21:21:18.777
> 
> 标签：javascript, jquery

我有两个带有名为标题 A 和标题 B 的标签的复选框。如果选中标题 A 的复选框，我试图想出一种方法来激活标题 B 的复选框 - 反之亦然。

```
<input type="checkbox">
<label>HEADLINE A</label>

<input type="checkbox">
<label>HEADLINE B</label> 
```

这是我开始的，但恐怕它还没有接近。

```
if($("label:contains('HEADLINE A')").closest('input').is(':checked')){
$("label:contains('HEADLINE B')").closest('input').is(':checked')
} 
```

我是否使用正则表达式匹配“标题”一词，然后提出适当的操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:28:03.450

`closest`选择元素的最近父元素而不是最近的兄弟元素，如果要修改`checked`输入的属性，则应使用`prop`method 而不是`is`.

```
if ( $("label:contains('HEADLINE A')").prev('input').is(':checked') ) {
    $("label:contains('HEADLINE B')").prev('input').prop('checked', true)
} 
```

或者：

```
var state = $("label:contains('HEADLINE A')").prev('input').is(':checked');
$("label:contains('HEADLINE B')").prev('input').prop('checked', state); 
```

如果您想`checked`根据更改事件修改属性，您可以尝试：

```
$('input[type=checkbox]').filter(function() {
    return $(this).next().text() === 'HEADLINE A'
}).change(function() {
    $("label:contains('HEADLINE B')").prev('input').prop('checked', this.checked)
}) 
```

[http://jsfiddle.net/FvLyJ/](http://jsfiddle.net/FvLyJ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:39:00.460

我相信应用程序必须将html的输入设置为标记或不标记，对吗？根据这个前提，我相信解决方案是这样的：

```
var headlineA = $("label:contains('HEADLINE A')").prev('input');
var headlineB = $("label:contains('HEADLINE B')").prev('input');

headlineA.attr('disabled', true);
headlineB.attr('disabled', true);

if(headlineA.is(':checked')){
    headlineB.attr('disabled', false);
}
if(headlineB.is(':checked')){
    headlineA.attr('disabled', false);
} 
```

你[**看这里**](http://jsfiddle.net/JeBbE/)。只需将其中一个输入设置为 html 检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:28:16.423

如果这些是仅有的两个复选框，那么您可以使用类似这样的东西

```
$('input[type="checkbox"]').on('click', function() {

    var $this = $(this);

    if( $this.is(':checked')){
        $('input[type="checkbox"]').not($this).prop('checked' , true);
    }

});​ 
```

**[小提琴](http://jsfiddle.net/sushanth009/Cnepa/1/)**

如果选中/取消选中

```
$('input[type="checkbox"]').on('click', function() {

    var $this = $(this);
    $('input[type="checkbox"]').not($this).prop('checked' , this.checked);
});​ 
```

# html - 如何让 Google Chrome 使用较大的图标作为应用程序快捷方式？

> ID：13240593
> 
> 赞同：6
> 
> 时间：2012-11-05T21:21:41.840
> 
> 标签：html, google-chrome, desktop-shortcut

Google Chrome 允许您将网站保存为应用程序快捷方式，并在用户桌面上显示一个图标。不幸的是，它添加到桌面的图标是 16x16 版本的放大版本。图标是一个图标文件，其中包含多种分辨率的图像，并保存在网站的根目录中。网站标题中没有代码提及网站图标。图标文件本身似乎工作。IE 显示较大的图标就好了。

![图标和结果](../Images/ebcf65a6bf7a79b5cce22554ee629a80.png)

有没有人有同样的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T06:54:47.673

看起来这是由于一个错误：

*   [http://code.google.com/p/chromium/issues/detail?id=5126](http://code.google.com/p/chromium/issues/detail?id=5126)
*   [http://code.google.com/p/chromium/issues/detail?id=92954](http://code.google.com/p/chromium/issues/detail?id=92954)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T10:49:36.663

我找到了解决方法。虽然不是一个很有说服力的。可以将 Gmail、Google 搜索、Google Drive 等网站作为应用程序（它们只是快捷方式/链接）从 Chrome 网上商店添加。（其中一些默认情况下与 Google Chrome 安装一起提供）

从此处安装 chrome 启动器：[https](https://chrome.google.com/webstore/launcher) : //chrome.google.com/webstore/launcher 从 Windows 任务栏中打开 chrome 启动器。选择网站快捷方式/应用程序并将其拖到任务栏。现在你有一个更高分辨率的图标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-08T21:12:44.930

只需将此 HTML 放在您的网页中：

```
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"> 
```

这将告诉 Chrome 它应该按原样使用整个文件，而不是将 16x16 转换为更大的尺寸。

# applescript - 在 Applescript 中触发 Handler 两次导致错误

> ID：13240603
> 
> 赞同：0
> 
> 时间：2012-11-05T21:23:01.737
> 
> 标签：applescript

所以到目前为止我编写了这段代码，它工作得很好，唯一的问题是，两次调用代码导致错误«脚本»不理解 Remi 消息。(-1708)

这里有什么要指出的，我如何在触发后取消设置处理程序？

编码：

```
my Remi()

on Remi()
    set cD to (current date)

    tell application "Reminders"
        --set output to name of reminders
        if (count of (reminders whose completed is false)) > 0 then
            set output to ""
            set todoList to name of reminders whose completed is false
            repeat with itemNum from 1 to ((count of (reminders whose completed is false)))
                try
                    set Remi to item itemNum of reminders
                    set remiT to due date of Remi
                    set tim to time string of remiT
                    set dD to date string of remiT
                    set nN to name of Remi
                    if remiT ≤ cD then
                        set val to (tim & " - " & nN & " $$" & dD & "/ENDE")
                        set output to (output & val & return)
                    end if
                end try
            end repeat
        else
            set output to "No reminders available"
        end if
    end tell
    return output
end Remi 
```

谢谢帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:56:13.287

我看到是什么导致了问题。您在“Remi()”处理程序中有一个变量“Remi”。我想你不能这样做！因此，要么更改变量的名称，要么更改处理程序的名称，你应该会很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:15:09.703

问题是由将全局变量的值从处理程序更改为任何“提醒项数”结果的`set Remi to item itemNum of reminders`语句引起的。`remi`第二次，当您要求 AppleScript 调用 Remi 处理程序时，它不再是处理程序，因此调用失败。

您可以更改代码以不更改全局`Remi`变量，或者您可以`Remi`使用语句在处理程序中声明本地`local Remi`。这可以保护全球版本的 Remi 不被更改。

# java - Eclipse 调试器为空白（未找到源）

> ID：13240605
> 
> 赞同：0
> 
> 时间：2012-11-05T21:23:08.640
> 
> 标签：java, debugging

我正在尝试调试以下代码，但我已经断线`w= w+ inputString.substring(firsti,i)+"yay";`但调试器显示空白（找不到源）这是怎么回事？

```
public String translate (String inputString) 
{ 
    String w = "";
    int firsti =0;
    for(int i=0; i< inputString.length(); i++){
        if(isVowel(inputString.charAt(i))){
            firsti = i;
            while (inputString.charAt(i) != ' ' || i< inputString.length()){
                i++;
            }
            w= w+ inputString.substring(firsti,i)+"yay";
            System.out.println(w);
        }
    }
    String outputString = new String(inputString); // Copies input to output and prints it. 
    return outputString;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:24:38.220

您可能正在尝试使用`substring()`java API 中的方法。您需要附加 Java 源来调试`substring()`

如何附加源：

转到项目 > 属性 > Java 构建路径 > 库，然后展开 JRE 系统库 JRE 版本，rt.jar。选择源附件，单击编辑...。选择源代码文件（外部文件...）并按 OK

阅读此[链接](http://www.cavdar.net/2008/07/14/3-ways-of-jdk-source-code-attachment-in-eclipse/)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:32:00.603

您需要在调试配置中添加源代码：

执行以下步骤：

选项1：

```
Right Click(Java Source) -> Debug As -> Java Applications 
```

选项 2：如果选项 1 没有帮助：

```
Menu ->Run ->Debug Configurations..-> Java Applications -> RightClick & select New
In right side, 
       Enter Name
       Browse your Project and the class having `main` method
       In Classpath, add your project from workspace
Click Debug button in the bottom 
```

# php - 在一个查询中为数组中的每个元素插入一行

> ID：13240611
> 
> 赞同：1
> 
> 时间：2012-11-05T21:23:36.323
> 
> 标签：php, codeigniter, activerecord

我有一个包含多个元素的数组。数组的大小并不总是相同的。

目前我能想到的唯一方法是使用`foreach`循环并为数组中的每个元素查询一次数据库。

我正在寻找一种为数组中的一个元素插入一行但全部在一个查询中的方法。我想做的是使用codeigniter的活动记录类，这样我就不必编写代码来检查恶意数据等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T22:19:18.943

`insert_batch`如果您只需要一个查询，请使用：

```
$data = array();

// Sample data
$items = array('Value 1', 'Value 2', 'Value 3');

foreach ($items as $value)
{
    $data[] = array(
        'your_column_name'  =>  $value,

        // Populate more columns here if you need to
        'date_created'      =>  time()
    );
}

$this->db->insert_batch('mytable', $data); 
```

所有值都会自动转义。

文档：[http ://codeigniter.com/user_guide/database/active_record.html#insert](http://codeigniter.com/user_guide/database/active_record.html#insert)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:28:08.850

您可以`$sql .= 'SQL HERE; '`在一个变量中有多个查询，然后只有一个函数调用来运行查询。

# ios - 当模态视图显示在弹出框上时，未在主视图中调用 ViewDidAppear

> ID：13240612
> 
> 赞同：0
> 
> 时间：2012-11-05T21:23:40.043
> 
> 标签：ios, ipad, modal-dialog, popover, pagecontrol

我正在尝试使用弹出框作为我的主视图和模态视图控制器之间的中间菜单。我可以使用以下代码成功地从弹出窗口中显示模态视图控制器：

```
UIStoryboard *storyboardiPad = [UIStoryboard storyboardWithName:@"MainStoryboard_iPad" bundle:nil];
cbwEditControlPanel *editCP = [storyboardiPad instantiateViewControllerWithIdentifier:@"EditCP"];

UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:editCP];
[nav setToolbarHidden:NO];
[nav setModalPresentationStyle:UIModalPresentationFullScreen];
[nav setModalTransitionStyle:UIModalTransitionStyleCoverVertical];
[self presentViewController:nav animated:YES completion:nil];
self.modalInPopover = NO; 
```

我遇到的问题是当 EditCP 模式视图控制器被关闭时，主视图控制器永远不会更新。我在主视图上有一个页面控制器，应该更新它以反映在 EditCP 模式视图控制器中设置的页面数，但由于某种原因，从弹出窗口调用的模式视图控制器会阻止主视图控制器更新页面控制器。我什至尝试在弹出窗口或模式视图被关闭时调用主视图的“View Will Appear”方法，但*即使调用“viewWillAppear”方法，pageController 也不会更新！*

有什么想法阻止 pageController 更新吗？我什至将 pagecontroller 的引用传递给模态视图并尝试在那里更新它，但似乎从弹出窗口出现到它被关闭，我无法更新 PageController 上的页数。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-15T08:56:57.597

所以这是一个老问题，但我最近在使用弹出框时也遇到了类似的问题。我的解决方案是使用 unwind segue 来触发我的父视图以执行某些操作。在我的情况下，我的父视图包含联系信息，弹出框包含引用列表。一旦用户从弹出窗口中选择了新城市，我想做的就是让父视图更新为新城市。所以在我的父视图中，我创建了我的展开函数，如下所示：

在.h中：

```
- (IBAction)unwindToContactTVC:(UIStoryboardSegue *)unwindSegue; 
```

在他们中：

```
- (IBAction)unwindToContactTVC:(UIStoryboardSegue *)unwindSegue
{
    [self updateTableForOffice];
} 
```

在上面的 .m 文件中，您可以在父视图中执行您想做的任何事情的逻辑。要连接此展开 segue，请转到情节提要中的子视图并控制从视图图标拖动到退出图标。您应该会看到一个弹出窗口，其中包含您的 unwind segue 名称。

最后，为展开的 segue 命名，然后在 viewWillDisappear() 函数的子控制器中调用 segue，如下所示：

```
- (void)viewWillDisappear:(BOOL)animated
{
    [self performSegueWithIdentifier:@"unwind-to-contact-tvc" sender:self];
} 
```

我希望这会有所帮助。如果有人有更好的解决方案，请告诉我。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-05T22:02:25.750

好吧，我解决了一半的问题。当弹出框消失时获得更新功能的唯一方法是停止使用故事板并以编程方式呈现弹出框，使用主视图作为委托。然后我能够在 popoverControllerDidDismissPopover 方法中正确更新。

但是，我仍然有兴趣找到一种在模式被解除时更新 pageControl 的方法，然后再解除弹出框。

# python - 任意多边形的宽度

> ID：13240615
> 
> 赞同：3
> 
> 时间：2012-11-05T21:23:53.313
> 
> 标签：python, computational-geometry

我需要一种方法来表征二维点集的大小，因此我可以根据视口的比例确定是将它们渲染为空间中的单个点还是代表性多边形。我已经有一个算法来计算集合的凸包以产生代表性多边形，但我需要一种方法来表征它的大小。一个明显的度量是凸包上点之间的最大距离，即集合的直径。但我真的更感兴趣的是它的横截面垂直于其直径的大小，以弄清楚边界多边形有多窄。考虑到顶点的排序列表和最远点的索引（理想情况下在 Python 中），有没有一种简单的方法可以做到这一点？

或者，是否有一种简单的方法来计算一组点的最小区域边界椭圆的半径？我已经看到了一些解决这个问题的方法，但没有什么可以轻易转换为 Python，所以我真的在寻找交钥匙的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T21:42:44.053

您可以计算：

> 垂直于其直径的横截面的大小

通过以下步骤：

1.  找到凸包
2.  找到相距最远`a`的两个点`b`
3.  `d = (a - b).normalized()`找到这两者之间的方向向量
4.  使用矩阵旋转轴，使该方向向量水平放置：

    ```
    [ d.x, d.y]
    [-d.y, d.x] 
    ```

5.  在这个新坐标系中找到点的最小和最大 y 值。不同的是你的“宽度”

请注意，这不是“宽度”的一个特别好的定义——更好的定义是：

> 两条不同的平行线之间的最小垂直距离，每条线至少有一个点与多边形的边界相同，但与多边形的内部没有相同点

* * *

另一个有用的尺寸定义可能是船体上的点与中心之间的平均距离的两倍

```
center = sum(convexhullpoints) / len(convexhullpoints)
size = 2 * sum(abs(p - center) for p in convexhullpoints) / len(convexhullpoints) 
```

# android - 了解Android中游戏的启动和停止

> ID：13240616
> 
> 赞同：0
> 
> 时间：2012-11-05T21:23:58.987
> 
> 标签：android, android-activity, game-engine

我正在用 Android 开发视频游戏。为此，我使用了一个游戏循环及其包含的所有典型内容。我对 android 中的活动状态有疑问。

我需要一个活动来创建 GLSurfaceView，因此，问题是活动，当它完成其 onCreate 方法时，以这种方式继续：onCreate -> onResume -> onStart -> onStop。我猜它会通过这些状态，因为活动没有任何事情可做，而且是循环在工作。但我对这种行为有疑问：

我如何知道用户何时“最小化”或将设备置于待机状态？再次，方法 onStop -> onResume -> onStart 将触发，但是，这一次与第一个方法有何不同？

当用户将设备切换为待机时，我需要停止循环，但在第一次启动时不需要。

我希望我已经解释得很好。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:50:01.660

如果 onStop 在 onStart 之后立即运行，则说明有问题。只有当它不再对用户可见时，活动才会被置于停止状态。我猜，除非您的代码立即创建另一个将其替换为前台活动的活动，但如果该活动在屏幕上可见，则不应触发 onStop。一些代码将有助于诊断。

当活动仍然可见但有另一个活动正在恢复时，会发生 onPause。如果您在用户退出应用程序、接听电话、关闭屏幕等时尝试保存游戏数据或其他内容，我会使用 onPause，因为不能保证调用 onStop 并且您运行在您可以做您需要做的事情之前，系统在某些情况下会杀死您的活动的风险。

有关活动生命周期的更多信息，请参阅[活动指南](http://developer.android.com/guide/components/activities.html)。

# filemaker - 在 filemaker pro 11 中具有层次结构和日期的 IsEmpty 函数

> ID：13240619
> 
> 赞同：2
> 
> 时间：2012-11-05T21:24:10.573
> 
> 标签：filemaker, is-empty

我一直在使用`IsEmpty`从[该站点](https://stackoverflow.com/questions/2068139/using-isempty-function-in-a-filemaker-pro-v9-calculation-with-multiple-fields)获得的功能。

```
Case (IsEmpty(Field1 & Field2);Field3;IsEmpty(Field1);Field2;Field1) 
```

但是，我现在从 5 个字段而不是 3 个字段中提取，并且我正在尝试按访问日期排序。

我的数据库处理客户和妊娠测试，我从中提取的字段来自他们在访问 1、访问 2、...访问 5 后的退出意图。

每次访问都有不同的标题（PT、RT、CC 等）。如果来访问 PT、US、FU 和我想从 FU 中拉出意向，或者如果他们按 PT、FU、US 的顺序来，我想从 US 中拉出意向。

有人对如何做到这一点有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T12:33:09.537

我认为最简单的方法就是简单地重写你的函数，这应该比你当前的代码更容易维护：

```
Case(
    not isEmpty(Field1); Field1;
    not isEmpty(Field2); Field2;
    not isEmpty(Field3); Field3;
    not isEmpty(Field4); Field4;
    Field5
) 
```

我认为在 Filemaker 中没有内置的方法来进行这种类型的计算，*如果有很多变量，你可以考虑编写一个自定义函数循环遍历这些字段，直到有一个非空条目...... （前提是您有 Filemaker Advanced）。*

# ios - 带有 unicode NSString 的 UILabel 文本

> ID：13240620
> 
> 赞同：0
> 
> 时间：2012-11-05T21:24:23.437
> 
> 标签：ios, objective-c, cocoa-touch, unicode

此代码正确显示为`Ecole`带有重音`E`：

```
NSString *test = @"\u00c9cole";
cell.detailTextLabel.text = test; 
```

但是当我从服务器获取作为 Json 发送的字符串时，我看到的不是`E`重音而是 unicode `\u00c9`。

从服务器获取 Json 字符串的代码：

```
- (void) handleProfileDidDownload: (ASIHTTPRequest*) theRequest
{
    NSMutableString *str = [[NSMutableString alloc] init];
    [str setString:[theRequest responseString]];
    [self preprocess:str]; //NSLog here shows  str has the unicode characters \u00c9

}

- (void) preprocess: (NSMutableString*) str 
    {
    [str replaceOccurrencesOfString:@"\n" withString:@"" options:NSLiteralSearch range:NSMakeRange(0, [str length])];
    [str replaceOccurrencesOfString:@"\"" withString:@"" options:NSCaseInsensitiveSearch range:NSMakeRange(0, [str length])];
    [str replaceOccurrencesOfString:@"\\/" withString:@"/" options:NSCaseInsensitiveSearch range:NSMakeRange(0, [str length])];

} 
```

现在，如果我这样做，

```
cell.detailTextLabel.text = str; 
```

我听不懂 E 而不是 \u00c9

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:33:04.720

```
NSString *test = @"\u00c9cole"; 
```

由编译器转换为重音 E。

在您的 JSON 中，字符串 \u00c9cole 是文字反斜杠-u-zero-zero-c-nine。

您可以通过转义反斜杠来获得相同的行为。

```
NSString *test2 = @"\\u00c9cole"; 
```

这会给你同样的坏结果，\u00c9cole。

* * *

要正确转义 JSON 字符串，请参阅[使用 Objective C/Cocoa 转义 unicode 字符，即 \u1234](https://stackoverflow.com/questions/2099349/using-objective-c-cocoa-to-unescape-unicode-characters-ie-u1234)。

我提供链接而不是答案，因为有三个不错的答案。您可以根据自己的需要选择最好的一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:34:10.163

> 这里的 NSLog 显示 str 有 unicode 字符 \u00c9

由此，您可以知道您收到的 JSON 实际上里面没有字母`É`，而是转义序列`\u00c9`。因此，您需要以某种方式取消转义此字符串：

```
CFMutableStringRef mutStr = (CFMutableStringRef)[str mutableCopy];
CFRange rng = { 0, [mutStr length] };
CFStringTransform(mutStr, &rng, CFSTR("Any-Hex/Java"), YES); 
```

然后你可以`mutStr`在你的代码中使用。

# haskell - 是否无法计算 Enum 类型的 maxBound 和 minBound 之间的差异？

> ID：13240621
> 
> 赞同：8
> 
> 时间：2012-11-05T21:24:34.540
> 
> 标签：haskell

我是否可以得出结论，`maxBound - minBound`在 Haskell 中无法计算任意类型`Enum`的`Bounded`类型？还是我错过了一些技巧/黑客？这就是我所拥有的，这显然行不通：

```
difference :: (Enum a, Bounded a) => Int
difference = fromEnum maxBound - fromEnum minBound 
```

错误：

```
Foo.hs:37:1:
    Ambiguous constraint `Enum a'
      At least one of the forall'd type variables mentioned by the constraint
      must be reachable from the type after the '=>'
    In the type signature for `difference': difference :: (Enum a, Bounded a) => Int

Foo.hs:37:1:
    Ambiguous constraint `Bounded a'
      At least one of the forall'd type variables mentioned by the constraint
      must be reachable from the type after the '=>'
   In the type signature for `difference': difference :: (Enum a, Bounded a) => Int 
```

我理解为什么会出现该错误- type 中没有实际术语`a`，因此无法弄清楚是什么`a`。问题是是否有办法解决这个问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-05T21:44:43.357

```
difference :: (Enum a, Bounded a) => a -> Int
difference x = fromEnum (maxBound `asTypeOf` x) 
             - fromEnum (minBound `asTypeOf` x) 
```

称它为 eg `difference (undefined :: Char)`。

但请注意，对于某些类型（最明显`Int`的是 ），这会溢出，因此请改用`Integer`结果：

```
difference :: (Enum a, Bounded a) => a -> Integer
difference x = toEnum (fromEnum (maxBound `asTypeOf` x)) 
             - toEnum (fromEnum (minBound `asTypeOf` x)) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-05T21:26:12.897

使用 a`Proxy`指定您想要的类型，并使用`ScopedTypeVariables`该类型将该类型纳入函数定义的范围。

```
{-# LANGUAGE ScopedTypeVariables #-}

data Proxy a = Proxy

difference :: forall a . (Enum a, Bounded a) => Proxy a -> Int
difference Proxy = fromEnum (maxBound :: a) - fromEnum (minBound :: a)

>>> difference (Proxy :: Proxy Bool)
1 
```

编辑：使用丹尼尔的建议：

```
data Proxy a = Proxy

difference :: (Enum a, Bounded a) => Proxy a -> Int
difference p = fromEnum (max' p) - fromEnum (min' p) where
    max' :: (Bounded a) => Proxy a -> a
    max' Proxy = maxBound
    min' :: (Bounded a) => Proxy a -> a
    min' Proxy = minBound 
```

# visual-studio-2010 - VSDBCMD 远程

> ID：13240623
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:24:45.630
> 
> 标签：visual-studio-2010, visual-studio, vsdbcmd, db-schema

我可以远程运行 VSDBCMD 命令吗？我的意思是不将文件复制到 SQL 服务器？我正在尝试创建一个 dbschema 文件以将其用作数据库项目中的参考。

我尝试在我的机器上运行该命令，但出现以下错误：“TSD 尝试对 Microsoft.Data.Schema.Sql.SchemaModel.ISql100DatabaseEncryptionKey 类型的元素进行逆向工程时从 SQL Server 收到错误：用户没有有权执行此操作。发生意外失败：访问路径“C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Pivotal_dev_ed.dbschema”被拒绝。”

我需要对 SQl 服务器的特殊权限吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T19:42:17.083

我找到了答案，看来您可以远程运行它，您只需指定要保存架构的文件夹的路径。我收到上面提到的错误是因为我没有在服务器上写入的权限，但是指定一个可以写入的文件夹的路径解决了这个问题

# java - Android 隐式和显式意图

> ID：13240624
> 
> 赞同：3
> 
> 时间：2012-11-05T21:24:46.377
> 
> 标签：java, android

何时使用隐式意图与显式意图？

对于这个隐式意图：

> 意图 searchintent = new Intent()
> searchintent.setAction(Intent.ACTION_VIEW) searchintent.setData(Uri.parse("http://www.google.com")) startActivity (searchintent)

我将如何设置另一个操作以及如何将 setData 与 Uri 参数以外的东西一起使用？

我通常只是试图理解这两种类型的意图。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T21:35:09.813

隐式意图是当您想要执行某个操作但您不知道用户当前必须使用哪个应用程序来处理该操作时。例如发送一封电子邮件，有很多应用程序可以让用户选择他想要使用的应用程序。

显式意图用于启动应用程序中的活动，如果您有 mainactivity 和 secondActivity，并且您想启动称为显式意图的第二个活动。

```
StartActivity(new Intent(getBaseContext(), secondActivity.class)); 
```

您可以通过将额外内容添加到与 Intent 一起传递的包中来在活动之间传递数据。

```
Intent i = new Intent(getBaseContext, secondActivity.class);
i.putExtra("key",value);
startActivity(i); 
```

要在您的第二个活动中取回额外内容，只需致电：

```
getIntent().getStringExtra("key"); 
```

或者，如果您只想获取传递的“数据”uri，您可以调用

```
getIntent().getData(); 
```

额外的可以是例如 int/double/String 或 parcable 对象

[http://developer.android.com/reference/android/os/Parcelable.html](http://developer.android.com/reference/android/os/Parcelable.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:34:40.243

如果您需要完成的操作可以由多种应用程序或不属于您的应用程序完成，您将使用隐式意图。例如，条码扫描、联系人拣选、短信/电子邮件等......

当您想要控制处理意图的活动时（即为什么将类定义传递给意图），应该使用显式意图使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:36:08.987

意图只是对其他活动的调用。每个活动都以下列方式处理这个调用（作为你的）：

1) 在 OnCreate() 方法中，活动正在寻找有效的操作（如在您的调用“ACTION_VIEW”中）。如果此活动有效且可调用该操作，则会调用此活动中的一个函数并“回答”您的请求。（当使用“startActivityForResult”调用时）。

2) 将数据设置为 Intent：如果调用的操作需要一些参数，则需要这样做。这个参数可以是很多种类型，比如可以是String或者Integer。您可以将此类数据捆绑在一个“捆绑包”中，并将其放入您的 Intent 中。如果可能，具有指定操作和数据的被调用活动会处理所有这些和事情，否则它会引发错误或其他任何事情。

在您的代码示例中，您调用打开浏览器的活动（因为 android 系统知道如何使用 URL 参数处理“ACTION_VIEW”，并且它是由底层 android 系统定义的系统默认行为。

如果您编写自己的活动，则可以将公共变量定义为“动作”，并且可以在 OnCreate 方法中处理它，即使使用所需的参数也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-22T10:52:29.883

1.  显式意图用于调用特定组件。当您知道要启动哪个组件并且不想让用户自由控制要使用的组件时。例如，您有一个具有 2 个活动的应用程序。活动 A 和活动 B。您希望从活动 A 启动活动 B。在这种情况下，您定义了一个针对活动 B 的显式意图，然后使用它直接调用它。
2.  当您知道要做什么但不知道应该启动哪个组件时，可以使用隐式 Intent。或者，如果您想为用户提供在要使用的组件列表之间进行选择的选项。如果这些 Intent 被发送到 Android 系统，它会搜索为特定操作和数据类型注册的所有组件。如果只找到一个组件，Android 直接启动该组件。例如，您有一个使用相机拍照的应用程序。您的应用程序的功能之一是您可以让用户发送他拍摄的照片。你不知道用户有什么样的应用程序可以发送照片，如果用户有多个应用程序，你也想给用户一个选项来选择使用哪个外部应用程序。在这种情况下，您不会使用显式意图。

An explicit intent is always delivered to its target, no matter what it contains; the filter is not consulted. But an implicit intent is delivered to a component only if it can pass through one of the component's filters

# delphi - 如何从 EXE 文件中删除死代码？

> ID：13240627
> 
> 赞同：-2
> 
> 时间：2012-11-05T21:24:52.710
> 
> 标签：delphi, delphi-xe2, dead-code

> **可能重复：**
> [减少 exe 文件](https://stackoverflow.com/questions/7398580/reduce-exe-file)

给定一个 EXE 文件，有哪些工具可以删除所有未使用的代码并使用应用程序真正使用的代码创建一个新的 EXE 文件？我认为应该存在这样的东西。只是为了好奇；但我认为它可以作为生成较小 EXE 文件而无需未使用代码的工具非常好。

PS：Delphi 生成独立的 EXE 文件，其中包含应用程序中使用的所有对象的代码，但并非该对象的所有元素都被真正使用。这会产生大文件。我记得 Pascal 的第一个版本只包含真正使用的代码，并且没有插入未使用的代码，而且 EXE 文件更小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:26:38.547

当前的 Delphi 也排除了未使用的代码。你可以很容易地在 Delphi 中看到这一点。如果你编译，你会在代码的阴沟里得到“蓝点”。未使用的函数没有蓝点，这意味着它们被排除在外。如果您选中项目选项中的优化复选框，则会重写代码以更多地使用寄存器，从而消除某些变量。

尽管如此，Delphi 可执行文件还是会增长，尤其是在使用某些单元时。我认为您可以在 Delphi 7 中创建的最小 .exe 大约是 10Kb。在以后的版本中，这可能会更大一些。

文件大小的重要原因是

1.  资源。大量或大量图像会占用大量空间。如果您在多个表单上使用图标，请确保将它们放在中央图像列表中（在共享数据源上）。使用可用的 PngImageList 实现之一来获得更小的图像尺寸以获得更好的质量。
2.  rtti。运行时类型信息会导致类定义消耗额外的空间。这个空间部分是由于关于类的元信息，但主要是因为所有额外的代码。可以使用 RTTI 调用的任何方法都可以以一种“后期绑定”方式进行绑定。因此，编译器无法知道这些方法是否可以消除，因此需要将它们包含在可执行文件中。
3.  注册课程。与 2 类似。如果一个类被注册，则可以使用其名称作为字符串来获取和实例化它。这些类必须包含在项目中，即使它们从未使用过，只是因为编译器无法知道是否需要它们。

事实上，RTTI 在最近的 Delphi 版本中得到了扩展。我认为这也会导致关于类的 RTTI 元信息消耗更多空间。你能做的只有这么多。

总的来说，我认为 Delphi 编译器仍然做了很多优化。您不必担心 exe 文件的大小。如果你这样做，你可以试试像`upx`. 我对 upx 有很好的经验。它将可执行文件减少到其原始大小的五分之一或更少，同时保留所有功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:36:25.923

如果您的应用程序很大，请检查您是否没有编译大量调试信息。尝试发布版本并检查它是否更小。

我有时做的是将项目配置为将所有 .dcu 文件编译到一个文件夹中。这样，您可以快速查看编译到 .exe 中的所有无用单元。您经常会为单个函数包含一个单元，但反过来您会得到一整棵依赖单元树。您只需要搜索您的使用子句并尝试以某种方式摆脱这些依赖关系。

我认为 gexperts 和 cnpack 都包含显示依赖项或扫描项目中未使用单元的工具。他们可以对此有所帮助。

删除无用的依赖项后，您始终可以使用 upx 压缩已编译的 exe。这有一些缺点（巴里凯利前段时间写过），但我有很好的经验。它有时会使文件变小 4 倍，这可能很重要。

# python - Matplotlib 在 3d 中绘制脉冲传播

> ID：13240633
> 
> 赞同：5
> 
> 时间：2012-11-05T21:25:02.233
> 
> 标签：python, 3d, matplotlib

我想在每一步都以这种方式绘制脉冲传播，它绘制脉冲形状。换句话说，对于每个 y 值，我想要一系列 xz 图。像这样的东西（没有颜色）： ![脉冲传播](../Images/0befd60ab75c88759d7646a33e3aab9a.png)

如何使用 matplotlib（或 Mayavi）做到这一点？这是我到目前为止所做的：

```
def drawPropagation(beta2, C, z):
    """ beta2 in ps / km
        C is chirp
        z is an array of z positions """
    T = numpy.linspace(-10, 10, 100)
    sx = T.size
    sy = z.size

    T = numpy.tile(T, (sy, 1))
    z = numpy.tile(z, (sx, 1)).T

    U = 1 / numpy.sqrt(1 - 1j*beta2*z * (1 + 1j * C)) * numpy.exp(- 0.5 * (1 + 1j * C) * T * T / (1 - 1j*beta2*z*(1 + 1j*C)))

    fig = pyplot.figure()
    ax = fig.add_subplot(1,1,1, projection='3d')
    surf = ax.plot_wireframe(T, z, abs(U)) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T03:41:14.923

改成：

```
ax.plot_wireframe(T, z, abs(U), cstride=1000) 
```

并致电：

```
drawPropagation(1.0, 1.0, numpy.linspace(-2, 2, 10)) 
```

将创建以下图表：

![在此处输入图像描述](../Images/e9e4f40861ed3e16a4c6e8303e9feab2.png)

如果您需要用白色填充曲线：

```
import numpy
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import pyplot
from matplotlib.collections import PolyCollection

def drawPropagation(beta2, C, z):
    """ beta2 in ps / km
        C is chirp
        z is an array of z positions """
    T = numpy.linspace(-10, 10, 100)
    sx = T.size
    sy = z.size

    T = numpy.tile(T, (sy, 1))
    z = numpy.tile(z, (sx, 1)).T

    U = 1 / numpy.sqrt(1 - 1j*beta2*z * (1 + 1j * C)) * numpy.exp(- 0.5 * (1 + 1j * C) * T * T / (1 - 1j*beta2*z*(1 + 1j*C)))

    fig = pyplot.figure()
    ax = fig.add_subplot(1,1,1, projection='3d')
    U = numpy.abs(U)

    verts = []
    for i in xrange(T.shape[0]):
        verts.append(zip(T[i, :], U[i, :]))

    poly = PolyCollection(verts, facecolors=(1,1,1,1), edgecolors=(0,0,1,1))
    ax.add_collection3d(poly, zs=z[:, 0], zdir='y')
    ax.set_xlim3d(numpy.min(T), numpy.max(T))
    ax.set_ylim3d(numpy.min(z), numpy.max(z))
    ax.set_zlim3d(numpy.min(U), numpy.max(U))

drawPropagation(1.0, 1.0, numpy.linspace(-2, 2, 10))
pyplot.show() 
```

![在此处输入图像描述](../Images/c56cd50bb33b91363e586ddfeb1f9e92.png)

# java - 使用 Jersey 测试 RESTful Web 服务时的 HTTP 状态 404

> ID：13240635
> 
> 赞同：5
> 
> 时间：2012-11-05T21:25:08.033
> 
> 标签：java, web-services, rest, jersey

我一直在尝试使用 Jersey 开发和部署一个宁静的 Web 服务。我遵循了 docs.oracle.com 和其他各种来源的文档，但在测试服务时获得了 HTTP 状态 404。

以下是我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>Hello World</display-name>

  <servlet>
      <servlet-name>Hello</servlet-name>
      <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
      <init-param>
          <param-name>com.sun.jersey.config.property.packages</param-name>
          <param-value>com.rest.jersey.test</param-value>
      </init-param>
      <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
      <servlet-name>Hello</servlet-name>
      <url-pattern>/resources/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

这是我的服务。

```
package com.rest.jersey.test;

import javax.ws.rs.Path;
import javax.ws.rs.GET;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("/hello")
public class HelloWorld {
    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String response(){
            return "Hello World!";
    }
} 
```

当我尝试点击网址时

```
http://localhost:8080/TestRestWithJersey/resources/hello 
```

它给出了 HTTP 状态 404 错误。请帮助我解决这个问题。

我刚刚检查了 Eclipse 的日志文件，除此之外什么也没说：

> !MESSAGE 未找到 [/workspace/TestRestWithJersey/WebContent/WEB-INF/web.xml] 的项目

我没看懂这个消息，你能帮我吗？

此外，点击 url 时的 tomcat 日志说

```
SEVERE: Error loading WebappClassLoader
  context: /TestRestWithJersey
  delegate: false
  repositories:
    /WEB-INF/classes/
----------> Parent Classloader:
org.apache.catalina.loader.StandardClassLoader@5362ab
 com.sun.jersey.spi.container.servlet.ServletContainer
java.lang.ClassNotFoundException: com.sun.jersey.spi.container.servlet.ServletContainer 
```

我添加了 jersey-server.jar 和 jsr-311.jar

之前也尝试过使用单个 jersey-bundle.jar

问题还是一样。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T10:13:59.267

当您想使用 servlet 容器来部署应用程序时，您还需要添加[jersey-servlet](http://maven.java.net/service/local/artifact/maven/redirect?r=releases&g=com.sun.jersey&a=jersey-servlet&v=1.15&e=pom)（请参阅[用户指南](http://jersey.java.net/nonav/documentation/latest/chapter_deps.html#d4e1703)）模块作为项目的依赖项。如果您使用的是maven，只需输入

```
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-servlet</artifactId>
    <version>1.15</version>
</dependency> 
```

到你的`pom.xml`文件中。

如果你想改用[jersey-bundle](http://maven.java.net/service/local/artifact/maven/redirect?r=releases&g=com.sun.jersey&a=jersey-bundle&v=1.15&e=jar)，请确保你的类路径中有[asm](http://repo1.maven.org/maven2/asm/asm/3.1/asm-3.1.jar)，因为包扫描（由`com.sun.jersey.config.property.packages`你的 init-param触发`web.xml`）需要这个库才能正常运行。

# ios - “无效的图标路径” - Apple App Store 团队返回的错误

> ID：13240636
> 
> 赞同：3
> 
> 时间：2012-11-05T21:25:21.157
> 
> 标签：ios, app-store, icons

这是我第一次向 App Store 提交内容，我遇到了很多问题。首先，让我说应用程序是使用**PhoneGap**构建的，使用**Cordova 1.9.0 框架**。它的 Web 应用程序端很好，验证了 W3，并在浏览器中完美运行。在无法手动解决问题后，我从头开始重建了这个项目，但这也没有纠正它。以下是 Apple 发回给我的错误...

```
Invalid Icon Path - No icon found at the path referenced under key "CFBundleIcons": Default@2x.png
Invalid Icon Path - No icon found at the path referenced under key "CFBundleIcons": icon-72@2x.png
Invalid Icon Path - No icon found at the path referenced under key "CFBundleIcons": Default.png 
```

我对图标文件所做的唯一修改是通过`Application --> Summary --> App Icons`，使用文件选择器。在提交过程中我没有验证错误，并且图标在我的测试手机上显示良好。

这又是我第一次这样做。有很多信息要发布，但我不知道需要什么。如果您有任何想法，将不胜感激，我将提供您所需的任何信息以更好地帮助我。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-06T07:59:31.123

右键单击 plist 并选择“显示原始键/值”。然后删除/编辑图像图标的值。还请验证 plist 中提到的所有图像是否在您的应用程序中可用，否则您可以从 plist 中删除该条目。

请找到随附的屏幕截图，

![在此处输入图像描述](../Images/3beec605fd8260dd318a26018ffb8d7f.png)

# java - 选择Java中showMessageDialog右上角的x按钮后退出系统？

> ID：13240639
> 
> 赞同：0
> 
> 时间：2012-11-05T21:25:24.930
> 
> 标签：java, joptionpane

我想知道如何在选择 showMessageDialog 对话框的 X 按钮时使程序退出。目前，每当我这样做时，它都会继续运行代码，或者在确认或选项对话框的情况下，选择“是”选项。是否可以在对话框的代码中包含这种命令？例如：

```
JOptionPane.showMessageDialog(null, "Your message here"); 
```

我将如何编辑输出以便 X 按钮关闭程序？

我是否必须将 showMessageDialog 更改为另一种类型的对话框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:56:44.243

我不知道这是否是你想要的，但我在程序中放了一个*确认框*：

```
 (...)
    import org.eclipse.swt.widgets.MessageBox;
    (...)
    createButton(buttons, "&Exit", "Exit", new MySelectionAdapter() {
        @Override
        public void widgetSelected(SelectionEvent evt) {
            MessageBox messageBox = new MessageBox(getShell(), SWT.YES | SWT.NO | SWT.ICON_QUESTION);
            messageBox.setMessage("Are you sure?");
            messageBox.setText("Exit");
            if (messageBox.open() == SWT.YES) {
                getParent().dispose();
            }
        }
    }); 
```

并查看[在线 javadoc (java 6)](http://docs.oracle.com/javase/6/docs/api/javax/swing/JOptionPane.html)或[(java 1.4)](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JOptionPane.html)，您还有另一种选择：

> **直接使用：直接**
> 创建和使用一个JOptionPane，标准模式大致如下：

```
 JOptionPane pane = new JOptionPane(arguments);
 pane.set.Xxxx(...); // Configure
 JDialog dialog = pane.createDialog(parentComponent, title);
 dialog.show();
 Object selectedValue = pane.getValue();
 if(selectedValue == null)
   return CLOSED_OPTION;
 //If there is not an array of option buttons:
 if(options == null) {
   if(selectedValue instanceof Integer)
      return ((Integer)selectedValue).intValue();
   return CLOSED_OPTION;
 }
 //If there is an array of option buttons:
 for(int counter = 0, maxCounter = options.length;
    counter < maxCounter; counter++) {
    if(options[counter].equals(selectedValue))
    return counter;
 }
 return CLOSED_OPTION; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:28:23.490

`showMessageDialog()`没有返回值。这是一个例子`showOptionsDialog()`。

```
public class Test
{
    public static void main(String[] args){
        final JFrame frame = new JFrame();
        JPanel panel = new JPanel();
        JButton button = new JButton("Test");
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent ae) {
                int result = JOptionPane.showOptionDialog(null, 
                        "Your message here", "", JOptionPane.DEFAULT_OPTION, 
                        JOptionPane.PLAIN_MESSAGE, null, new String[] {"OK"}, "OK");
                if (result == JOptionPane.CLOSED_OPTION) {
                    frame.dispose();
                }
            }
        });

        panel.add(button);
        frame.setContentPane(panel);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

# python - 自动将 matplotlib 底图居中到数据上

> ID：13240642
> 
> 赞同：3
> 
> 时间：2012-11-05T21:25:31.233
> 
> 标签：python, matplotlib, geocoding, geospatial, matplotlib-basemap

我想要一种解决方案，可以在我的坐标数据上自动将底图图居中。

我有一些东西要自动居中，但结果区域比我的数据实际使用的区域大得多。**我希望绘图以绘图坐标为界**，而不是从纬度/经度边界绘制的区域。

我正在使用[John Cook 的代码](http://www.johndcook.com/python_longitude_latitude.html)来计算（假设的完美）球体上两点之间的距离。

**第一次尝试**

这是我开始的脚本。这导致宽度和高度对于数据区域来说太小了，并且中心纬度（lat0）太南了。

```
from mpl_toolkits.basemap import Basemap
import matplotlib.pyplot as plt
import numpy as np
import sys
import csv
import spheredistance as sd

print '\n'
if len(sys.argv) < 3:
    print >>sys.stderr,'Usage:',sys.argv[0],'<datafile> <#rows to skip>'
    sys.exit(1)
print '\n'

dataFile = sys.argv[1]
dataStream = open(dataFile, 'rb')
dataReader = csv.reader(dataStream,delimiter='\t')
numRows = sys.argv[2]

dataValues = []
dataLat = []
dataLon = []

print 'Plotting Data From: '+dataFile

dataReader.next()
for row in dataReader:
    dataValues.append(row[0])
    dataLat.append(float(row[1]))
    dataLon.append(float(row[2]))

# center and set extent of map
earthRadius = 6378100 #meters
factor = 1.00

lat0new = ((max(dataLat)-min(dataLat))/2)+min(dataLat)
lon0new = ((max(dataLon)-min(dataLon))/2)+min(dataLon)

mapH = sd.distance_on_unit_sphere(max(dataLat),lon0new,
            min(dataLat),lon0new)*earthRadius*factor

mapW = sd.distance_on_unit_sphere(lat0new,max(dataLon),
            lat0new,min(dataLon))*earthRadius*factor

# setup stereographic basemap.
# lat_ts is latitude of true scale.
# lon_0,lat_0 is central point.
m = Basemap(width=mapW,height=mapH,
            resolution='l',projection='stere',\
            lat_0=lat0new,lon_0=lon0new)

#m.shadedrelief()
m.drawcoastlines(linewidth=0.2)
m.fillcontinents(color='white', lake_color='aqua')

#plot data points (omitted due to ownership)
#x, y = m(dataLon,dataLat)
#m.scatter(x,y,2,marker='o',color='k')

# draw parallels and meridians.
m.drawparallels(np.arange(-80.,81.,20.), labels=[1,0,0,0], fontsize=10)
m.drawmeridians(np.arange(-180.,181.,20.), labels=[0,0,0,1], fontsize=10)
m.drawmapboundary(fill_color='aqua')

plt.title("Example")
plt.show() 
```

![在此处输入图像描述](../Images/b72a06346346fa116a59e52a875c68e9.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:24:47.053

生成一些随机数据后，很明显我选择的边界不适用于这个投影（红线）。使用 map.drawgreatcircle()，我首先可视化了我想要的边界，同时放大了随机数据的投影。

![红线是旧计算的宽度和高度](../Images/93ee4efdb7d1b69815ce7dfb8f47af51.png)

我通过使用最南端纬度（蓝色水平线）的经度差来校正经度。

我使用勾股定理确定纬度范围来求解垂直距离，知道最北端的纵向边界和中部最南端（蓝色三角形）之间的距离。

```
def centerMap(lats,lons,scale):
    #Assumes -90 < Lat < 90 and -180 < Lon < 180, and
    # latitude and logitude are in decimal degrees
    earthRadius = 6378100.0 #earth's radius in meters

    northLat = max(lats)
    southLat = min(lats)
    westLon = max(lons)
    eastLon = min(lons)

    # average between max and min longitude 
    lon0 = ((westLon-eastLon)/2.0)+eastLon

    # a = the height of the map
    b = sd.spheredist(northLat,westLon,northLat,eastLon)*earthRadius/2
    c = sd.spheredist(northLat,westLon,southLat,lon0)*earthRadius

    # use pythagorean theorom to determine height of plot
    mapH = pow(pow(c,2)-pow(b,2),1./2)
    arcCenter = (mapH/2)/earthRadius

    lat0 = sd.secondlat(southLat,arcCenter)

    # distance between max E and W longitude at most souther latitude
    mapW = sd.spheredist(southLat,westLon,southLat,eastLon)*earthRadius

    return lat0,lon0,mapW*scale,mapH*scale

lat0center,lon0center,mapWidth,mapHeight = centerMap(dataLat,dataLon,1.1) 
```

因此，在这种情况下，lat0（或纬度中心）是这个三角形高度的一半，我使用 John Cooks 方法解决了这个问题，但是在知道第一个坐标（在南边界）和弧长（总高度的一半）。

```
def secondlat(lat1, arc):
    degrees_to_radians = math.pi/180.0
    lat2 = (arc-((90-lat1)*degrees_to_radians))*(1./degrees_to_radians)+90
    return lat2 
```

**更新：使用**[pyproj](http://code.google.com/p/pyproj/) [Geod](http://pyproj.googlecode.com/svn/trunk/docs/pyproj.Geod-class.html)类方法[geod.fwd()](http://pyproj.googlecode.com/svn-history/r262/trunk/docs/pyproj.Geod-class.html#fwd)和[geod.inv()](http://pyproj.googlecode.com/svn-history/r262/trunk/docs/pyproj.Geod-class.html#inv) 可以更准确地实现上述功能以及两个坐标之间的距离。我在 Erik Westra 的*Python for Geospatial Development*中发现了这一点，这是一个极好的资源。

**更新：** 我现在已经验证这也适用于 Lambert Conformal Conic (lcc) 投影。

# javascript - 更新服务器上的 XML 文件

> ID：13240644
> 
> 赞同：0
> 
> 时间：2012-11-05T21:25:36.140
> 
> 标签：javascript, tomcat, filewriter

我有一个 Eclipse 项目通过 Tomcat 从我的机器本地运行。该项目是一个 Web 应用程序，患者、HCP 和管理员能够登录以执行各种任务。其中一项任务是根据特定搜索标准运行关于患者的组报告。运行组报告后，应该可以选择以 XML 格式查看组报告。

我构建项目的方式是在本地创建了一个 groupReport.xml 文件。一旦创建了这个文件，我就提交了它，这样当我在 Tomcat 服务器上运行项目时，我可以手动将我的浏览器指向我的服务器上存储 XML 文件的网站地址 (localhost:8080/project/groupReport.xml)。 xml 为例）。

每次运行组报告时，我都有一个重写 groupReport.xml 以反映新更改的 java 类。这个 java 类使用 FileWriter 将其写入我硬盘上的本地路径。这样做的问题是导航到 localhost:8080/project/groupReport.xml 将仅显示在服务器启动之前首次提交的组报告的 XML 信息。它不反映对已在本地重写的 XML 的任何更改。

我尝试使用相对路径名让 FileWriter 写入存储在服务器端的 XML 文件，但无法达到我想要的结果。每当重写本地存储的 XML 文件时，我的服务器 (localhost:8080/project/groupReport.xml) 上的 XML 有什么方法可以重写？

我不知道任何 PHP 或 Ajax，所以如果有一个仅使用 Java 和 Javascript 的类似解决方案，那将是可取的。

# php - 在 .html 或 .htm 文件中使用 php 代码

> ID：13240646
> 
> 赞同：4
> 
> 时间：2012-11-05T21:25:37.970
> 
> 标签：php, apache

我已经添加了行

```
AddType application/x-httpd-php .html 
```

到我的 Apache Config 文件，但我仍然无法在 .html 文件中解析 php 脚本。我究竟做错了什么？

这是添加此信息的错误配置文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T22:21:03.930

使用的处理程序可能会有所不同。

我建议将 PHP 文件作为最后的手段，因为这可以用更少的努力来解决，这是一种蛮力方法。

下面是一些非常常见的变体，但可能还有更多。

```
 AddType application/x-httpd-php

    AddType application/x-httpd-php5

    AddHandler application/x-httpd-php

    AddHandler application/x-httpd-php5 
```

如前所述，可能需要同时使用 AddType 和 AddHandler。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:35:56.423

您可以使用 .htaccess ：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$.html $1.php [L]
RewriteRule ^(.*)$.htm $1.php [L] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:33:15.720

我知道这并不完全是您所追求的，但是您可以像这样使用 Apache RewriteEngine 来伪造用户调用的 HTML 文件。

```
RewriteEngine ON
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^((.+)\.(html|htm))$ ($2).php [L] 
```

我也认为这是一个很好的安全点，`.html`如果你忘记了你已经配置了这个或者用户可以将 HTML 上传到你的服务器，那么不要作为 PHP 脚本运行。（不配置 apache 在文件系统上运行文件`.html`作为 PHP 文件。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T21:34:17.507

一些网络主机需要这两个指令。尝试这个：

```
AddType application/x-httpd-php .htm .html
AddHandler x-httpd-php  .htm .html 
```

如果您的 entre 站点不需要此功能，强烈建议您使用 .htaccess 在每个文件/目录的基础上执行此操作。

# javascript - 切换 Div 显示/隐藏

> ID：13240647
> 
> 赞同：0
> 
> 时间：2012-11-05T21:25:46.690
> 
> 标签：javascript, css, html, web, toggle

```
<script type="text/javascript">
    function ToggleList(IDS) {
        var CState = document.getElementById(IDS);
        if (CState.style.display != "block") { CState.style.display = "block"; }
        else { CState.style.display = "none"; }
    }

</script>
<style type="text/css">
    .divInfo
    {
        display: none;
    }
</style>

<p>Text</p>
<a onclick="ToggleList('LT3')">Show More</a>
</p>
<div id="LT3" class="divInfo">
<p>Additional Test</p>
</div> 
```

这很好用，但我希望在展开切换时将标签“显示更多”更改为“隐藏”。关于如何做到这一点的任何想法？CState.innertext = "隐藏" ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:28:44.033

要获得浏览器兼容性，请创建如下变量：

```
var text = 'textContent' in document ? 'textContent' : 'innerText'; 
```

然后像这样使用它：

```
CState[text] = "New Text Content"; 
```

* * *

但似乎您想更改 的标签，而`<a>`不是`<div>`. 所以你会对你的 HTML 这样做：

```
<a onclick="ToggleList(this, 'LT3')">Show More</a> 
```

然后这个给你的JS：

```
var text = 'textContent' in document ? 'textContent' : 'innerText';

function ToggleList(anchor, IDS) {
    var CState = document.getElementById(IDS);
    if (CState.style.display != "block") { 
        CState.style.display = "block";
        anchor[text] = "Hide";
    } else { 
        CState.style.display = "none"; 
        anchor[text] = "Show More";
    }
} 
```

***演示：http:*** [//jsfiddle.net/RRUEY/](http://jsfiddle.net/RRUEY/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-05T21:41:34.203

函数中的 CState 对象是对 DIV 的引用。您应该做的是给锚标记一个 ID，然后更改其中的文本。

```
function ToggleList(anchorID, IDS) {
    var CState = document.getElementById(IDS);
    var anchor = document.getElementByID(anchorID);

    if (CState.style.display != "block") {
        CState.style.display = "block";
        anchor.innerHTML = "Hide";
    } else {
       CState.style.display = "none";
       anchor.innerHTML = "Show more";
    }
} 
```

您的锚标记将如下所示：

```
<a id="listToggle" onclick="ToggleList('listToggle', 'LT3')">Show More</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:30:58.297

将 的引用传递`<a>`给函数，然后稍微重构函数以根据可见性重新标记它：

```
function ToggleList(anchor,IDS) {
  var CState = document.getElementById(IDS);
  var isVisible = (CState.style.display == "block");

  anchor.innerHTML = isVisible ? 'Show more' : 'Hide';
  CState.style.display = isVisible ? 'none' : 'block';
} 
```

修改后的 HTML：

```
<a onclick="ToggleList(this,'LT3')">Show More</a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T21:32:18.013

我相信您会想要在标签中添加一个 id，例如：

```
<a id='txtShowMore' onclick="ToggleList('LT3')">Show More</a> 
```

然后有这个脚本：

```
var showMoreElement = document.getElementByID('txtShowMore');
showMoreElement.innerHTML = "Hide"; 
```

当然，当你隐藏它时，将它设置回“显示更多”也是一样的。

# php - Load facebook content via ajax

> ID：13240650
> 
> 赞同：2
> 
> 时间：2012-11-05T21:26:05.413
> 
> 标签：php, facebook, jquery

Hello I have a problem with my website. I'm downloading my content via $.ajax from my php file. `(echo "My downloaded content <fb:like .....";)` In my content I have also facebook like buttons etc and the problem is that when I download content via Ajax all of facebook features are hidden (not working). When I had my content without ajax everything worked fine. I have my facebook api script in the bottom of my page.

here is my javascript and html code : [http://jsfiddle.net/FWeUT/](http://jsfiddle.net/FWeUT/)

and php is just echo.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T04:30:57.257

Facebook 仅在加载其 JS 包含后才会在页面上呈现代码。您可以在 AJAX 调用之后安全地重写 Facebook JS 包含。看到您正在使用 jQuery，请考虑以下内容：

```
if (typeof (FB) != 'undefined') {
    FB.init({ status: true, cookie: true, xfbml: true });
} else {
    $.getScript("http://connect.facebook.net/en_US/all.js#xfbml=1", function () {
        FB.init({ status: true, cookie: true, xfbml: true });
    });
} 
```

# select - 如何从 knockout.js observableArray 中获取选定的菜单选项？

> ID：13240658
> 
> 赞同：8
> 
> 时间：2012-11-05T21:26:46.640
> 
> 标签：select, drop-down-menu, knockout.js, option

我觉得我错过了一些非常基本的东西，但是我无法使用 Knockout.js 让下拉菜单像我期望的那样工作。

我有一组要在菜单中显示的对象，我需要找到选定的选项并将其发布到服务器。我可以获取要呈现的菜单，但似乎无法获取所选项目的值。我的视图模型如下所示：

```
function ProjectFilterItem( name, id ) {
    this.Name = name;
    this.Id   = id;
}

function FilterViewModel() {
    this.projectFilters = ko.observableArray([
        new ProjectFilterItem( "foo", "1" ),
        new ProjectFilterItem( "bar", "2" ),
        new ProjectFilterItem( "baz", "3" )
    ]);
    this.selectedProject = ko.observable();
}

ko.applyBindings( new FilterViewModel() ); 
```

我的视图标记如下所示：

```
<select 
    id        = "projectMenu"   
    name      = "projectMenu"
    data-bind = "
        options:        projectFilters,
        optionsText:    'Name', /* I have to enquote the value or I get a JS error */
        optionsValue:   'Id',   /* If I put 'selectedProject here, nothing is echoed in the span below */
        optionsCaption: '-- Select Project --'
    "
></select>

<b>Selected Project:</b> <span data-bind="text: selectedProject"></span> 
```

如何让选定的菜单项显示在跨度中，并发布到服务器？（我假设我在 span 中呈现的 observable 与我发布的相同。）我是否需要 , 中的另一个属性`ProjectFilterItem`，比如`this.selected = ko.observable(false);`？如果是这样，我将如何将其声明为值的目标？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-05T21:33:09.883

您只需要使用[`value`绑定](http://knockoutjs.com/documentation/value-binding.html)来绑定选定的值：

从[`options`文档](http://knockoutjs.com/documentation/options-binding.html)中：

> 注意：对于多选列表，要设置选择了哪些选项，或者读取选择了哪些选项，请使用 **selectedOptions 绑定**。**对于单选列表，您还可以使用value binding**读取和写入选定的选项。

在您的示例中：

```
<select 
    id        = "projectMenu"   
    name      = "projectMenu"
    data-bind = "
        value: selectedProject,
        options:        projectFilters,
        optionsText:    'Name',
        optionsValue:   'Id',
        optionsCaption: '-- Select Project --'
    "
></select> 
```

请参阅[演示](http://jsfiddle.net/AZ9Cn/)。

# jquery - 如何在使用带有多个文件的 jquery ajax FormData() 时在多部分/表单数据请求上设置边界

> ID：13240664
> 
> 赞同：28
> 
> 时间：2012-11-05T21:27:15.223
> 
> 标签：jquery, ajax, multipartform-data, apache-commons-fileupload

我有一个 HTML 表单，需要在一个请求中将 3 个部分上传到现有的 REST API。我似乎找不到有关如何在 FormData 提交上设置边界的文档。

我尝试按照此处给出的示例进行操作： [How to send FormData objects with Ajax-requests in jQuery?](https://stackoverflow.com/questions/6974684/how-to-send-formdata-objects-with-ajax-requests-in-jquery)

但是，当我提交数据时，它会被以下堆栈跟踪拒绝：

```
Caused by: org.apache.commons.fileupload.FileUploadException: the request was rejected because no multipart boundary was found. 
```

如何设置边界？

这是 HTML/Javascript：

```
 <script type="text/javascript">
    function handleSubmit() {

        var jsonString = "{" +
                "\"userId\":\"" + document.formSubmit.userId.value + "\"" +
                ",\"locale\":\"" + document.formSubmit.locale.value + "\"" +
                "}";

        var data = new FormData();
        data.append('Json',jsonString);
        data.append('frontImage', document.formSubmit.frontImage.files[0]);
        data.append('backImage', document.formSubmit.backImage.files[0]);

        document.getElementById("sent").innerHTML = jsonString;
        document.getElementById("results").innerHTML = "";
        $.ajax({
                   url:getFileSubmitUrl(),
                   data:data,
                   cache: false,
                   processData: false,
                   contentType: 'multipart/form-data',
                   type:'POST',
                   success:function (data, status, req) {
                       handleResults(req);
                   },
                   error:function (req, status, error) {
                       handleResults(req);
                   }
               });
    }

</script> 
```

这是表格：

```
<form name="formSubmit" action="#">
    userId: <input id="userId" name="userId" value=""/><br/>
    locale: <input name="locale" value="en_US"/><br/>
    front Image: <input type="file" name="frontImage"/><br/>
    back Image: <input type="file" name="backImage"/><br/>
    <input type="button" onclick="handleSubmit();" value="Submit"/>
</form> 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-06T02:32:56.293

穆萨的反应很好。将 contentType 设置为 false 确实正确提交了表单数据。谢谢！

这是有效的ajax调用：

```
$.ajax({
    url:getFileSubmitUrl(),
    data:data,
    cache:false,
    processData:false,
    contentType:false,
    type:'POST',
    success:function (data, status, req) {
        handleResults(req);
    },
    error:function (req, status, error) {
        handleResults(req);
    }
}); 
```

我还发现这段代码也有效：

```
 var oReq = new XMLHttpRequest();
        oReq.open("POST", getFileSubmitUrl());
        oReq.addEventListener("error", transferComplete);
        oReq.addEventListener("load", transferComplete);
        oReq.addEventListener("abort", transferComplete);
        oReq.send(data);
    }
    function transferComplete(evt) {
        handleResults(evt.target);
    } 
```

# html - CSS：溢出：隐藏删除边框底部？

> ID：13240665
> 
> 赞同：11
> 
> 时间：2012-11-05T21:27:29.557
> 
> 标签：html, css, overflow, border

我正在制作一个 HTML 页面，并尝试将`<a>`标签设置为`border-bottom`.

它**不会**显示，无论我做什么。所以我做了一个简化的测试用例，可以在这里看到：

[http://codepen.io/hwg/pen/ILKdx](http://codepen.io/hwg/pen/ILKdx)

发生在 FF beta 和 Chrome 22 中。

如果我删除`overflow:hidden;`或将其更改为`overflow:visible`，它可以工作。问题是我**需要**那套。

那么我怎样才能有一个边框底部呢？（或者是我:)）

（我不能使用文本下划线，希望它加点）

谢谢

哈雷

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-05T21:48:47.290

`display:inline-block;`在链接上似乎可以解决问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-05T21:31:47.470

`1px`在网格的顶部和底部添加填充：

```
.grid{overflow:hidden; padding: 1px 0px;} 
```

或者

使网格元素内联：

```
.grid{overflow:hidden; display: inline;} 
```

可能有一百种不同的方法可以真正解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T21:29:49.043

尝试增加行高。例如。添加`line-height:200%;`到#test css

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-27T00:48:57.127

就我而言，任何解决方案都不适合我。

我通过在最后一个麻烦的 div 之后添加空白 div 解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-15T12:33:55.573

就我而言，我必须将其添加到我的元素中： display: table; 宽度：95%；

# spring - How do I map this URL to a Spring controller method?

> ID：13240667
> 
> 赞同：2
> 
> 时间：2012-11-05T21:27:57.213
> 
> 标签：spring, controller, httpwebrequest, mapping

I'm using Spring 3.1.1.RELEASE. I'm having fits mapping URLs to controller methods. I would like to map the URL "/my-context-path/organizations/add" to the controller method below. In my controller, I have

```
@Controller
@RequestMapping("/organizations")
public class OrganizationController
{

    …
    @RequestMapping(value = "/add", method = RequestMethod.GET)
    public ModelAndView doGetadd()
    {
        … do some stuff …
        return new ModelAndView("organizations/add");
    }   // doGetadd 
```

In my web.xml I have

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
                                http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">

    <display-name>SB Admin</display-name>

    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>2</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>/organizations/*</url-pattern>
    </servlet-mapping>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/dispatcher-servlet.xml</param-value>
    </context-param> 
```

and in my dispathcer-servlet.xml I have

```
...
<!-- Enable annotation driven controllers, validation etc... -->
<mvc:annotation-driven />

<context:component-scan base-package="org.myco.subco" />

    <bean id="viewResolver"
            class="org.springframework.web.servlet.view.InternalResourceViewResolver">
            <property name="prefix">
                    <value>/WEB-INF/views/</value>
            </property>
            <property name="suffix">
                    <value>.jsp</value>
            </property>
    </bean> 
```

but requests for my desired context-path result in "No mapping found for HTTP request with URI [/myproject-1.0-SNAPSHOT/organizations/add] in DispatcherServlet with name 'dispatcher" errors (using JBoss 7). How do I map this thing properly? Note that I have multiple methods in my controller that I want to different URLs within the "/organizations" space.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T00:40:47.547

尝试这个。

将调度程序 servlet 映射更改为：

```
 <servlet-mapping>
      <servlet-name>dispatcher</servlet-name>
      <url-pattern>/</url-pattern>
    </servlet-mapping> 
```

对于 OrganizationController，映射将是

```
 @Controller
    @RequestMapping("/organizations")
    public class OrganizationController 
```

而对于 ContractsController 的映射将是

```
 @Controller
    @RequestMapping("/contracts")
    public class OrganizationController 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:35:25.157

根据[Spring Doc](http://static.springsource.org/spring/docs/1.2.9/api/org/springframework/web/servlet/ModelAndView.html)，ModelAndView 构造函数参数是视图文件的名称。

所以那个文件可能是`addView.jsp`.

以及您（就我的 Spring 知识而言）实际上将其映射到 /Application-Name/organizations/organizations/add 的事实，因为：

```
<servlet-mapping>
    <servlet-name>dispatcher</servlet-name>
    <url-pattern>/organizations/</url-pattern>
</servlet-mapping> 
```

和

```
@Controller
@RequestMapping("/organizations")
public class OrganizationController 
```

我建议将请求映射从控制器更改为

```
@Controller
@RequestMapping("/")
public class OrganizationController 
```

`<url-pattern>/organizations/</url-pattern>`基本上定义了可以访问您的站点的“虚拟路径” 。您在控制器上执行的所有映射都将附加到它，使其成为 /organizations/whateverpagecomeshere.jsp

并确保查看文件存在！

# .net - How to choose the right "network place" icon?

> ID：13240672
> 
> 赞同：5
> 
> 时间：2012-11-05T21:28:07.737
> 
> 标签：.net, powershell, environment, windows-explorer

I've got a PowerShell script that creates shortcuts to network locations at login. Unfortunately, it's using an old low-res icon. It's not a big deal by any means, but I'd like to use the updated icons in later versions of Windows.

Here's the relevant portion of the function that creates the shortcut:

```
# Create the shortcut file

$shortcut = (New-Object -ComObject WScript.Shell).Createshortcut("$shortcutFolder\target.lnk")

$shortcut.TargetPath = $targetPath
if (
$shortcut.IconLocation = "%SystemRoot%\system32\SHELL32.DLL, 275"
$shortcut.Description = $targetPath
$shortcut.WorkingDirectory = $targetPath
$shortcut.Save()

# Set attributes on the files & folders
$desktopIni | Set-ItemProperty -Name Attributes -Value ([IO.FileAttributes]::System -bxor [IO.FileAttributes]::Hidden)
$shortcutFolder | Set-ItemProperty -Name Attributes -Value ([IO.FileAttributes]::ReadOnly) 
```

As you can see, it's currently using Icon #275 in the SHELL32.DLL library. In Windows 7, the "proper" icon would be Icon #143 in imageres.dll. Is there any way to get the icon details from the OS like getting a reference to a Special folder in the Explorer namespace?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-12T12:55:51.483

我的网上邻居有 CLSID`208d2c60-3aea-1069-a2d7-08002b30309d`

知道了这一点，您可以在以下位置读取默认注册表值`HKEY_CLASSES_ROOT\CLSID\{208D2C60-3AEA-1069-A2D7-08002B30309D}\DefaultIcon`

结果将是即`%SystemRoot%\system32\imageres.dll,-25`

# reference - Referencing(copying) earlier text in a markdown.md file

> ID：13240675
> 
> 赞同：1
> 
> 时间：2012-11-05T21:28:16.483
> 
> 标签：reference, copy, markdown

In a markdown.md file, Is it possible to reference and copy earlier text in the file?

Lets say you have the following:

```
Some Type Names
-----
Type 1 - Video
Type 2 - Voice / Sound clip
Type 3 - Picture
Type 4 - Photo Booth Strip (3 | 4 | 5 sequential pictures)

Type 1 - Video
---
Type 2 - Voice / Sound clip
---
Type 3 - Picture
---
Type 4 - Photo Booth Strip (3 | 4 | 5 sequential pictures)
--- 
```

Instead of having to retype the type headers again below, is there a way to reference earlier text and have it generate in the spot you want, similar to how Excel cell referencing works? This would be beneficial to only have to worry about naming one item once.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T03:40:06.217

Markdown 没有变量[http://daringfireball.net/projects/markdown/](http://daringfireball.net/projects/markdown/)

# php - Get Response from server using curl -IsH

> ID：13240677
> 
> 赞同：0
> 
> 时间：2012-11-05T21:28:22.773
> 
> 标签：php, curl

how can I add that parameter ("-IsH) to curl using PHP?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:35:03.253

像这样取决于您要添加的标题：

-I 仅表示标题，没有正文

```
curl_setopt($ch,CURLOPT_NOBODY); 
```

-H

```
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
'X-Apple-Tz: 0',
'X-Apple-Store-Front: 143444,12'
)); 
```

-s 表示静音

# vb.net - VB.net Process Affinity

> ID：13240679
> 
> 赞同：2
> 
> 时间：2012-11-05T21:28:34.100
> 
> 标签：vb.net, process, affinity

**Goal:** My goal is to set all running processes's affinity to 1 core. Then launch a program with the affinity of all the cores.

**Skill Lvl:** My skill level in programming in general is pretty much beginner. This is my first language.

**Need:** I would like some help with this coding and maybe an article or description of the code. Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T06:53:54.927

[这里](https://stackoverflow.com/a/4219923/256431)有一个 C# 解决方案。

总之，您需要遍历所有进程 ( `Process.GetProcesses`) 并将它们设置`.ProcessorAffinity`为`New IntPtr(1)`，然后开始您的新进程。（默认已经使用所有内核，但为了完整起见，如果您希望新进程具有不同的亲和性，请在启动后以与上述相同的方式进行设置。）

所有代码：

```
Dim procs = Process.GetProcesses
For Each p In procs
 p.ProcessorAffinity = New IntPtr(1)
Next
Dim myProc = Process.Start("notepad.exe")
' Stop here to answer the OP.
' This sets the new Notepad process to be the only process running on the second CPU:
myProc.ProcessorAffinity = New IntPtr(2) 
```

# java - android: populate a spinner from strings.xml

> ID：13240682
> 
> 赞同：14
> 
> 时间：2012-11-05T21:28:41.493
> 
> 标签：java, android

I'm having a problem with populating my spinner with days of the week.

layout xml:

```
<Spinner 
    android:id="@+id/week_spinner"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:drawSelectorOnTop="true"/> 
```

strings.xml

```
<resources>
  <string-array name="days_of_week">
    <item>Monday</item>
    <item>Tuesday</item>
    <item>Wednesday</item>
    <item>Thursday</item>
    <item>Friday</item>
  </string-array>
</resources> 
```

java:

```
public class AddModule extends Activity {
    Spinner day;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        day = (Spinner)findViewById(R.id.week_spinner);

        ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.days_of_week, android.R.layout.simple_spinner_item);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        day.setAdapter(adapter);
        setContentView(R.layout.activity_add_module);
    }
} 
```

It's the setAdapter line that's causing the app to crash. I'm getting the following errors

```
11-05 21:24:31.235: W/dalvikvm(867): threadid=1: thread exiting with uncaught exception (group=0x40a9a228) 
11-05 21:24:31.245: E/AndroidRuntime(867): FATAL EXCEPTION: main 
11-05 21:24:31.245: E/AndroidRuntime(867): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.cathal.timetable/com.cathal.timetable.AddModule}: java.lang.NullPointerException 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2202) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2237) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.ActivityThread.access$600(ActivityThread.java:139) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.os.Handler.dispatchMessage(Handler.java:99) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.os.Looper.loop(Looper.java:154) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.ActivityThread.main(ActivityThread.java:4974) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at java.lang.reflect.Method.invokeNative(Native Method) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at java.lang.reflect.Method.invoke(Method.java:511) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at dalvik.system.NativeStart.main(Native Method) 11-05 21:24:31.245: E/AndroidRuntime(867): Caused by: java.lang.NullPointerException 11-05 21:24:31.245: E/AndroidRuntime(867):    at com.cathal.timetable.AddModule.onCreate(AddModule.java:18) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.Activity.performCreate(Activity.java:4538) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071) 
11-05 21:24:31.245: E/AndroidRuntime(867):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2158) 
11-05 21:24:31.245: E/AndroidRuntime(867):  ... 11 more 
```

This was working fine yesterday. I can't figure out if I maybe changed something or if I have an eclipse problem.

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-05T21:35:25.407

Nambari 解释了您收到 NullPointerException 的原因以及如何正确使用`findViewById()`.

我想指出一种更简单的方法来设置使用默认设置的 Spinner，只需将其添加到您的 XML 中：

```
android:entries="@array/days_of_week" 
```

您可以删除所有对您的适配器的引用`onCreate()`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-05T21:29:49.077

```
super.onCreate(savedInstanceState);
setContentView(yourView);
day = (Spinner)findViewById(R.id.week_spinner); 
```

在从 xml 获取微调器之前，您忘记设置视图。如果您不设置视图，则`findViewById`返回`null`.

对引用的任何操作都会`null`导致`NullPointerException`.

# spring-security - Spring Security with CAS authentication and custom authorization

> ID：13240684
> 
> 赞同：2
> 
> 时间：2012-11-05T21:28:46.253
> 
> 标签：spring-security, cas

I am a newbie to Spring Security and CAS. I got the SSO part working but am struggling with getting the authorization part working. I followed this to implement custom authorisation

[http://www.theserverside.com/tip/-Spring-Security-Customizing-Your-User-and-Authorization-in](http://www.theserverside.com/tip/-Spring-Security-Customizing-Your-User-and-Authorization-in)

When should the loadUserDetails get called. I have set a break point here and this method is never called.

Any help will be greatly appreciated. Looks like I am missing a configuration to invoke the authorization.

I want to have my custom User object populated with the authorities and reside in session so that I can check User role at any stage.

When I log in the logs here is steps that happen once I login

```
 1\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 1 of 8 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'  (FilterChainProxy:329)

No HttpSession currently exists  (HttpSessionSecurityContextRepository:127)

No SecurityContext was available from the HttpSession: null. A new one will be created.  (HttpSessionSecurityContextRepository:85)

2\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 2 of 8 in additional filter chain; firing Filter: 'CasAuthenticationFilter'  (FilterChainProxy:329)

3\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 3 of 8 in additional filter chain; firing Filter: 'RequestCacheAwareFilter'  (FilterChainProxy:329)

4\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 4 of 8 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter'  (FilterChainProxy:329)

5\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 5 of 8 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter'  (FilterChainProxy:329)

Populated SecurityContextHolder with anonymous token: 'org.springframework.security.authentication.AnonymousAuthenticationToken@6faa93c2: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@ffffe21a: RemoteIpAddress: 192.168.0.124; SessionId: null; Granted Authorities: ROLE_ANONYMOUS'  (AnonymousAuthenticationFilter:102)

6\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 6 of 8 in additional filter chain; firing Filter: 'SessionManagementFilter'  (FilterChainProxy:329)

7\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 7 of 8 in additional filter chain; firing Filter: 'ExceptionTranslationFilter'  (FilterChainProxy:329)

8\. /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas at position 8 of 8 in additional filter chain; firing Filter: 'FilterSecurityInterceptor'  (FilterChainProxy:329)

Checking match of request : '/indexcasepackoptions'; against '/login/**'  (AntPathRequestMatcher:103)

Secure object: FilterInvocation: URL: /indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas; Attributes: [ROLE_ANONYMOUS]  (FilterSecurityInterceptor:193)

Previously Authenticated: org.springframework.security.authentication.AnonymousAuthenticationToken@6faa93c2: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@ffffe21a: RemoteIpAddress: 
192.168.0.124; SessionId: null; Granted Authorities: ROLE_ANONYMOUS  (FilterSecurityInterceptor:298)

Voter: org.springframework.security.access.vote.RoleVoter@7077602d, returned: 1  (AffirmativeBased:65)

Authorization successful  (FilterSecurityInterceptor:214)

RunAsManager did not change Authentication object  (FilterSecurityInterceptor:226)

/indexCasePackOptions?ticket=ST-4295-4eFUHVziBcmVaOd3bifl-cas reached end of additional filter chain; proceeding with original chain  (FilterChainProxy:315)

No Proxy Ticket found for   (ProxyGrantingTicketStorageImpl:77)

SecurityContext is empty or contents are anonymous - context will not be stored in HttpSession.  (HttpSessionSecurityContextRepository:269)

Chain processed normally  (ExceptionTranslationFilter:115)

SecurityContextHolder now cleared, as request processing completed  (SecurityContextPersistenceFilter:97) 
```

My custom UserDetails

```
package com.creata.domain;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.GrantedAuthorityImpl;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;

public class User implements Serializable, UserDetails {

private static final long serialVersionUID = 1L;
private Collection<SimpleGrantedAuthority> authorities;
private final String username;
private String password;

public User(String username) {
    this.username=username;
}

@Override
public Collection<SimpleGrantedAuthority> getAuthorities() {
    return authorities;

}
public void setUserAuthorities(List<String> roles) {
    List<SimpleGrantedAuthority> listOfAuthorities = new ArrayList<SimpleGrantedAuthority>();
    for (String role : roles) {
        listOfAuthorities.add(new SimpleGrantedAuthority(role));
    }
    authorities = listOfAuthorities;
}

@Override
public String getPassword() {
    return this.password;
}

@Override
public String getUsername() {
    return username;
}

@Override
public boolean isAccountNonExpired() {
    return false;
}

@Override
public boolean isAccountNonLocked() {
    return false;
}

@Override
public boolean isCredentialsNonExpired() {
    return false;
}

@Override
public boolean isEnabled() {
    return true;
} 
```

}

My custom UserService

```
package com.creata.security.service;

import java.util.ArrayList;
import java.util.List;

import org.springframework.security.core.Authentication;
import org.springframework.security.core.userdetails.AuthenticationUserDetailsService;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import com.creata.domain.User;

public class CustomUserService implements UserDetailsService, AuthenticationUserDetailsService {

@Override
public UserDetails loadUserByUsername(String username)
        throws UsernameNotFoundException {
    System.out.println("loadUserByUsername called here ");
    User currentUser = new User("Reena");
    //Collection<SimpleGrantedAuthority> authorities  = currentUser.getAuthorities();
    List<String> roles = new ArrayList<String>();
    roles.add("ROLE_Admin");
    roles.add("ROLE_CPAD-Maintenance");
    currentUser.setUserAuthorities(roles);
    //authorities.add(new SimpleGrantedAuthority("PRIVILEGE_HOME"));
    return currentUser;
}

@Override
public UserDetails loadUserDetails(Authentication token) throws UsernameNotFoundException{
    User currentUser = new User("Reena");
    List<String> roles = new ArrayList<String>();
    roles.add("ROLE_Admin");
    roles.add("ROLE_CPAD-Maintenance");
    currentUser.setUserAuthorities(roles);
    //authorities.add(new SimpleGrantedAuthority("PRIVILEGE_HOME"));
    return currentUser;
}
} 
```

Here is my security configuration:

```
<beans:beans 
xmlns="http://www.springframework.org/schema/security" 
xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:p="http://www.springframework.org/schema/p"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context" 
xmlns:lang="http://www.springframework.org/schema/lang"
xmlns:tx="http://www.springframework.org/schema/tx" 
xmlns:aop="http://www.springframework.org/schema/aop"
xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/security 
    http://www.springframework.org/schema/security/spring-security-3.1.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<http entry-point-ref="casEntryPoint">   
    <custom-filter position="CAS_FILTER" ref="casFilter" />
</http>

<authentication-manager alias="authenticationManager">
    <authentication-provider ref="casAuthenticationProvider" />
</authentication-manager>   

<beans:bean id="casFilter" class="org.springframework.security.cas.web.CasAuthenticationFilter">
    <beans:property name="authenticationManager" ref="authenticationManager"/>
</beans:bean>  

<beans:bean id="casEntryPoint" class="org.springframework.security.cas.web.CasAuthenticationEntryPoint">
    <beans:property name="loginUrl" value="https://abc.com/cas/login"/>
    <beans:property name="serviceProperties" ref="serviceProperties"/>
</beans:bean>

<beans:bean id="casAuthenticationProvider"  class="org.springframework.security.cas.authentication.CasAuthenticationProvider">
    <beans:property name="authenticationUserDetailsService" ref="customUserService"/>
    <beans:property name="serviceProperties" ref="serviceProperties" />
    <beans:property name="ticketValidator">
    <beans:bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
        <beans:constructor-arg index="0" value="https://portal.creata.com/cas" />
    </beans:bean>
    </beans:property>
    <beans:property name="key" value="an_id_for_this_auth_provider_only"/>
</beans:bean>

<beans:bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties">
    <beans:property name="service"  value="https://mypc.abc.com/Spring_CPAD2/"/>
</beans:bean>

<beans:bean id="customUserService" class="com.creata.security.service.CustomUserService"/>  
</beans:beans> 
```

Here is my web.xml

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="3.0"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
metadata-complete="true">
<display-name />

 <context-param>
    <param-name>serverName</param-name>
    <param-value>https://cpaus-rsingh2.creata.com</param-value>
</context-param>
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>    
<filter>
    <filter-name>characterEncodingFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
</filter>    
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>    
<filter-mapping>
    <filter-name>characterEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<listener>
    <listener-class>
        org.springframework.web.context.request.RequestContextListener
    </listener-class>
</listener>
<listener>
    <listener-class>
        org.springframework.web.context.ContextLoaderListener
    </listener-class>
</listener> 
<filter>
    <filter-name>CAS Single Sign Out Filter</filter-name>
    <filter-class>org.jasig.cas.client.session.SingleSignOutFilter</filter-class>
</filter>
<filter>
    <filter-name>CAS Authentication Filter</filter-name>
    <filter-class>org.jasig.cas.client.authentication.AuthenticationFilter</filter-class>
    <init-param>
        <param-name>casServerLoginUrl</param-name>
        <param-value>https://abc.com/cas/login?AppName=app1</param-value>
    </init-param>
</filter>
<filter>
    <filter-name>CAS Validation Filter</filter-name>
    <filter-class>org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter</filter-class>
    <init-param>
        <param-name>casServerUrlPrefix</param-name>
        <param-value>https://abc.com/cas</param-value>
    </init-param>
</filter>
<filter>
    <filter-name>CAS HttpServletRequest Wrapper Filter</filter-name>
    <filter-class>org.jasig.cas.client.util.HttpServletRequestWrapperFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>CAS Single Sign Out Filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>CAS Authentication Filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>CAS Validation Filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>CAS HttpServletRequest Wrapper Filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<listener>
    <listener-class>org.jasig.cas.client.session.SingleSignOutHttpSessionListener</listener-class>
</listener>
<filter>
    <filter-name>ResponseOverrideFilter</filter-name>
    <filter-class>org.displaytag.filter.ResponseOverrideFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>ResponseOverrideFilter</filter-name>
    <url-pattern>*.jsp</url-pattern>
  </filter-mapping>
<filter>
    <description>generated-persistence-filter</description>
    <filter-name>com_ibm_db2_jcc_DB2DriverFilter</filter-name>
    <filter-class>
        org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter
    </filter-class>
    <init-param>
        <param-name>entityManagerFactoryBeanName</param-name>
        <param-value>com_ibm_db2_jcc_DB2Driver</param-value>
    </init-param>
</filter>
<filter>
    <description>generated-sitemesh-filter</description>
    <filter-name>Sitemesh Filter</filter-name>
    <filter-class>
        com.opensymphony.module.sitemesh.filter.PageFilter
    </filter-class>
</filter>
<!-- <filter>
    <description>generated-persistence-filter</description>
    <filter-name>MyEclipse_DerbyFilter</filter-name>
    <filter-class>
        org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter
    </filter-class>
    <init-param>
        <param-name>entityManagerFactoryBeanName</param-name>
        <param-value>MyEclipse_Derby</param-value>
    </init-param>
</filter> -->
<filter-mapping>
    <filter-name>com_ibm_db2_jcc_DB2DriverFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>Sitemesh Filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<!-- <filter-mapping>
    <filter-name>MyEclipse_DerbyFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> -->
<servlet>
    <description>generated-servlet</description>
    <servlet-name>Spring_CPAD2 Servlet</servlet-name>
    <servlet-class>
        org.springframework.web.servlet.DispatcherServlet
    </servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            classpath:Spring_CPAD2-web-context.xml
        </param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet>
    <description>generated-resources-servlet</description>
    <servlet-name>Resource Servlet</servlet-name>
    <servlet-class>
        org.springframework.js.resource.ResourceServlet
    </servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet>
    <description>generated-webflow-servlet</description>
    <servlet-name>webflow</servlet-name>
    <servlet-class>
        org.springframework.web.servlet.DispatcherServlet
    </servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/config/Spring_CPAD2-webflow-config.xml
        </param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>  
<servlet-mapping>
    <servlet-name>Resource Servlet</servlet-name>
    <url-pattern>/resources/*</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>Spring_CPAD2 Servlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>webflow</servlet-name>
    <url-pattern>*.flow</url-pattern> 
</servlet-mapping>
<welcome-file-list>
    <welcome-file>jsp/intro.jsp</welcome-file>
</welcome-file-list>
    <jsp-config>
        <taglib>
            <taglib-uri>MyCustomTags</taglib-uri>
            <taglib-location>/WEB-INF/tlds/MyCustomTags.tld</taglib-location>
        </taglib>
    </jsp-config> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T17:12:12.197

[CasAuthenticationProvider](http://www.jarvana.com/jarvana/view/org/springframework/security/spring-security-cas-client/3.0.4.RELEASE/spring-security-cas-client-3.0.4.RELEASE-sources.jar!/org/springframework/security/cas/authentication/CasAuthenticationProvider.java?format=ok)仅在身份验证为空时调用 userDetailsS​​ervice

我建议在 CasAuthenticationProvider.java 中放置一个调试点（请参阅以下代码中的我的评论）

```
 public class CasAuthenticationProvider {
 public Authentication authenticate(Authentication authentication) throws AuthenticationException {

    CasAuthenticationToken result = null;

    if (stateless) {
        // Try to obtain from cache
        result = statelessTicketCache.getByTicketId(authentication.getCredentials().toString());
    }

    if (result == null) {
        //following line calls userDetailsService. I would recommend to put a debug point here 
        ///if it is not calling userDetailsService, that means result is not null

        result = this.authenticateNow(authentication);
        result.setDetails(authentication.getDetails());
    }

    if (stateless) {
        // Add to cache
        statelessTicketCache.putTicketInCache(result);
    }

    return result;
} 
```

您可以从[http://mvnrepository.com/artifact/org.springframework.security/spring-security-cas-client](http://mvnrepository.com/artifact/org.springframework.security/spring-security-cas-client)下载源代码并将其附加到 eclipse。

# boost - Compiling the Unit Test Framework of Boost

> ID：13240685
> 
> 赞同：0
> 
> 时间：2012-11-05T21:28:46.353
> 
> 标签：boost, compilation

I am trying to follow the instructions to compile the **unit test framework** of **Boost** (see, the *Standalone Compilation* section at [http://www.boost.org/doc/libs/1_52_0/libs/test/doc/html/utf/compilation/standalone.html](http://www.boost.org/doc/libs/1_52_0/libs/test/doc/html/utf/compilation/standalone.html) ).

But I get the message **'bjam' is not recognized as an internal or external command, operable program or batch file** as entering **bjam [-sTOOLS=] {-sBUILD=boost_unit_test_framework}** into the Windows shell meanwhile this exactly is what the documentation reads.

Isn't there a trick such as now one has to use the command **b2** instead of **bjam**?

Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T20:15:09.350

您不应该运行“./bjam”来指示 bjam 的位置（即在当前目录中）吗？

错误消息似乎暗示了这一点，但我对 Windows shell 的经验很少。

# javascript - 当我的链接被点击时，如何阻止浏览器滚动到顶部？

> ID：13240691
> 
> 赞同：0
> 
> 时间：2012-11-05T21:29:23.397
> 
> 标签：javascript, scroll

我试过在这个网站上搜索数据库，但是我仍然没有找到我的问题的具体答案。

当我单击选项卡中的链接时，页面会转到顶部，我需要停止。 [http://www.pcigeomatics.com/index.php?option=com_content&view=article&id=65&Itemid=7](http://www.pcigeomatics.com/index.php?option=com_content&view=article&id=65&Itemid=7)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:43:06.823

它“滚动”到顶部的原因不是因为`return false`. 这是因为在这段代码中：

```
//On Click Event
$("ul.tabs_ip li").click(function() {

    $("ul.tabs_ip li").removeClass("active"); //Remove any "active" class
    $(this).addClass("active"); //Add "active" class to selected tab

////////////////RIGHT HERE
    $(".tab_content_ip").hide(); //Hide all tab content

    var activeTab = $(this).find("a").attr("href"); //Find the href attribute value to identify the active tab + content
    $(activeTab).fadeIn(); //Fade in the active ID content
    return false;
}); 
```

您通过隐藏它来显着缩短页面`DIV`，从而使您看起来像是在“滚动”到页面顶部。如果你给它`DIV`一个`min-height: 400px;`或类似的东西，你就不会慢跑了。将最小高度设置为您的内容的合理数字。

编辑：

将此 CSS 添加到您的 .css 文件中：

```
.tab_content_ip{
    min-height: 400px;
} 
```

# java - Hadoop 文档

> ID：13240696
> 
> 赞同：0
> 
> 时间：2012-11-05T21:29:48.563
> 
> 标签：java, hadoop, documentation, mapreduce, version

我从 Hadoop 框架开始，我的任务是为框架编写 map-reduce 应用程序并提交它。我必须使用 Hadoop 的 0.22.0 版本。我只是在学习基本概念和 API。然而，我发现学习它和编写一些原型**非常困难，因为**[官方文档](http://hadoop.apache.org/docs/mapreduce/r0.22.0/index.html)和[API javadocs](http://hadoop.apache.org/docs/r0.22.0/api/index.html)都是过时的、不完整的、通常是混乱的，甚至不存在。

以下是我不理解的几个想法：[Hadoop 0.22.0 的 MapReduce 教程](http://hadoop.apache.org/docs/mapreduce/current/mapred_tutorial.html)使用了已弃用的类的构造函数（[此处](http://hadoop.apache.org/docs/mapreduce/current/mapred_tutorial.html#Example%3A+WordCount+v2.0)，第 101 行） 。[`Job`](http://hadoop.apache.org/docs/mapreduce/current/api/index.html)所有其他构造函数也被弃用。javadocs 中没有说明要使用什么。有类的静态方法`Job`返回实例，`Job`但这些方法是未记录的，它们需要记录不良的类的实例[`Cluster`](http://hadoop.apache.org/docs/mapreduce/current/api/index.html)作为参数。因此，在阅读了所有这些混乱之后，我仍然不知道如何正确获取`Job`. 对此的任何帮助表示赞赏。

当我试图在 1.0.4 stable 等更高版本的教程中找到答案时，我发现该版本的 mapreduce 教程使用了`org.apache.hadoop.mapred`0.22.0 版中已弃用的包中的所有类。所以 0.22.0 比 1.0.4 更讨厌。请帮助我理解这一点。或者建议一些更好的资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T00:04:05.263

[Javadoc](http://hadoop.apache.org/docs/mapreduce/r0.22.0/api/index.html)可能有点混乱，因此查看 Job 类的源代码可能[会对](http://grepcode.com/file_/repo1.maven.org/maven2/org.apache.hadoop/hadoop-mapred/0.22.0/org/apache/hadoop/mapreduce/Job.java/?v=source)您有所帮助：

```
 ...
  @Deprecated
  public Job() throws IOException {
    this(new Configuration());
  }

  @Deprecated
  public Job(Configuration conf) throws IOException {
    this(new Cluster(conf), conf);
  }

  @Deprecated
  public Job(Configuration conf, String jobName) throws IOException {
    this(conf);
    setJobName(jobName);
  }

  Job(Cluster cluster) throws IOException {
    this(cluster, new Configuration());
  }

  Job(Cluster cluster, Configuration conf) throws IOException {
    super(conf, null);
    this.cluster = cluster;
  }

  ...
  public static Job getInstance(Cluster cluster, Configuration conf) 
      throws IOException {
    return new Job(cluster, conf);
  } 
```

所以你可以使用：

```
...
Configuration conf = getConf();
Job job = Job.getInstance(new Cluster(conf), conf); 
```

请注意，以这种方式实例化 Job 类将同时创建与的连接`job tracker`。

如果您想推迟这样做，您可以选择在创建 Job 对象时通过设置为 null 来*延迟初始化此连接。*`Cluster`在这种情况下，您将让 Job 类在真正需要时建立连接（请参阅[此处](https://issues.apache.org/jira/browse/MAPREDUCE-1505)的更多信息）：

```
Job job = Job.getInstance(conf); 
```

# python - python/beautifulsoup 查找所有具有特定锚文本的内容

> ID：13240700
> 
> 赞同：21
> 
> 时间：2012-11-05T21:30:19.610
> 
> 标签：python, beautifulsoup

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-05T21:35:30.960

像这样的东西会起作用吗？

```
In [39]: from bs4 import BeautifulSoup

In [40]: s = """\
   ....: <a href="http://example.com">TEXT</a>
   ....: <a href="http://example.com/link">TEXT</a>
   ....: <a href="http://example.com/page">TEXT</a>
   ....: <a href="http://dontmatchme.com/page">WRONGTEXT</a>"""

In [41]: soup = BeautifulSoup(s)

In [42]: for link in soup.findAll('a', href=True, text='TEXT'):
   ....:     print link['href']
   ....:
   ....:
http://example.com
http://example.com/link
http://example.com/page 
```

# jsf-2 - 有条件地跳过验证 JSF

> ID：13240701
> 
> 赞同：3
> 
> 时间：2012-11-05T21:30:23.567
> 
> 标签：jsf-2

要求是有条件地跳过字段验证。当用户选择添加时，应验证表单字段并将值添加到表中。如果单击编辑，则应跳过表单字段验证，但应将 bean 值复制到输入字段。

```
<composite:nameInput id="name" value="#{buyer.name}" 
  disableBeanValidation ="#{param['skipBeanValidation']}"/>
<h:commandLink action="#{buyerBacking.cancelEdit}" value="cancel"/>

 <h:dataTable value="#{bean.list}">
    <h:commandLink value="Edit" action="#{buyerBacking.edit}">
     <f:param name="skipBeanValidation" value="true" /> 
    </h:commandLink>
 </h:dataTable>

   <h:commandLink id="add" action="#{buyerBacking.add}"/> 
```

名称输入复合组件

```
<h:inputText id="fName" value="#{bean.fname}">
     <f:validateBean disabled="#{cc.attrs. disableBeanValidation}"/>
</h:inputText> 
```

如果用户输入详细信息并选择添加，则详细信息将添加到表中。如果验证错误，我们会显示错误消息。

然后用户选择编辑，将值复制到输入字段。用户选择取消编辑，值将从输入字段中删除。如果用户再次选择编辑，我们会得到一个 index out of bound 异常错误。name_firstName 的索引超出范围异常。

但是，如果用户选择添加并选择取消编辑，则不会发生这种情况。它是否与传递的视图参数有关，它以某种方式为空？

javax.faces.FacesException：为具有 id frmAddAuthBuyerBR_inpAuthBuyerBRName_prefix_input 的组件恢复状态时出现意外错误。原因：java.lang.IndexOutOfBoundsException：索引：0，大小：0。在 com.sun.faces.application.view.StateManagementStrategyImpl$2.visit(StateManagementStrategyImpl.java:272) 在 com.sun.faces.component.visit.FullVisitContext .invokeVisitCallback(FullVisitContext.java:151) 在 javax.faces.component.UIComponent.visitTree(UIComponent.java:1612) 在 javax.faces.component.UIComponent.visitTree(UIComponent.java:1626) 在 javax.faces.component。 UIComponent.visitTree(UIComponent.java:1626) 在 javax.faces.component.UINamingContainer.visitTree(UINamingContainer.java:163) 在 javax.faces.component.UIComponent.visitTree(UIComponent.java:1626) 在 javax.faces.component .UIComponent.visitTree(UIComponent.java:

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T12:23:52.810

您的代码不完整，因为您无处显示如何`disableBeanValidation`实现以及如何传递`#{param[skipBeanValidation]}`。

但它*基本上*应该归结为：

```
<f:validateBean disabled="#{param.skipBeanValidation}" />

...

<h:commandLink value="Edit" action="#{buyerBacking.edit}"/>
    <f:param name="skipBeanValidation" value="true" />
</h:commandLink> 
```

请注意，这与（但与）`#{param.skipBeanValidation}`完全不同。另请注意，跳过 bean 验证所需的请求参数作为 HTTP 请求参数传递，正如.`#{param[skipBeanValidation]}``#{param['skipBeanValidation']}``#{param}`

# linux - 如何将 file1 的每一列附加到 file2 的特定字段并创建一个新的输出文件？

> ID：13240707
> 
> 赞同：3
> 
> 时间：2012-11-05T21:30:39.113
> 
> 标签：linux, bash, loops, awk

我想将文件 1 的每一列附加为文件 2 的第 4 列，并导出为具有文件 1 中的列号或类似于输出名称的新文件。

输入文件 1 和 2 具有相同的行数：

输入文件 1 有 N 列：

```
12 23 34  .....
33 34 23
67 09 34
45 67 34
65 76 44
64 33 96 
```

输入文件 2 最初有 5 列

```
AA BB FF DD 6
AA CC HH NN 7
AA DD II RR 4
AA EE JJ PP 2
AA FF KK QQ 9
AA GG LL SS 8 
```

例如，前 3 个输出文件如下所示：

输出文件 1（第 1 列）：

```
AA BB FF 12 DD 6
AA CC HH 33 NN 7
AA DD II 67 RR 4
AA EE JJ 45 PP 2
AA FF KK 65 QQ 9
AA GG LL 64 SS 8 
```

输出文件 2（第 2 列）：

```
AA BB FF 23 DD 6
AA CC HH 34 NN 7
AA DD II 09 RR 4
AA EE JJ 67 PP 2
AA FF KK 76 QQ 9
AA GG LL 33 SS 8 
```

输出文件 3（第 3 列）：

```
AA BB FF 34 DD 6
AA CC HH 23 NN 7
AA DD II 34 RR 4
AA EE JJ 34 PP 2
AA FF KK 44 QQ 9
AA GG LL 96 SS 8 
```

新文件名可以是 file1、file2、file3...或 column1、column2、column3....或类似名称。请问我怎样才能做到这一点？（for循环、awk、粘贴等）

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:48:46.053

`cut`如果您的列是制表符分隔的，您可以轻松地从和中获利`paste`：

```
for i in {1..N} ; do  # Insert the real N here, or change to $(seq 1 $N)
    cut -f1-3 input2 | \
        paste - \
              <(cut -f$i input1) \
              <(cut -f4- input2) \
        > output$i
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T13:44:44.747

你只需要这样的东西：

```
awk '
NR==FNR { hd=$1" "$2" "$3"; tl=$4" "$5; next }
{  for (i=1;i<=NF;i++) {
      print hd, $i, tl > "file" i
   }
}
' file2 file1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T03:01:58.643

此方法只处理每个文件一次，这在文件很大时很有帮助。但是，它确实需要将第一个文件存储在内存中：

```
awk '
    NR==1 {n=NF} 
    NR==FNR {
        for (i=1; i<=n; i++) 
            file1[i, FNR]=$i
        next
    }
    {
        for (i=1; i<=n; i++) {
            filename = "merged" i
            print $1, $2, $3, file1[i, FNR], $4, $5 >> filename
        }
    }
' file1 file2 
```

# php - 从 Paypal 捐赠按钮取回捐赠价值？

> ID：13240716
> 
> 赞同：5
> 
> 时间：2012-11-05T21:31:13.290
> 
> 标签：php, paypal

我想知道贝宝是否有可能从回调函数中给我用户通过贝宝捐赠的金额？我需要这个，所以我可以更新网站上的总金额。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:33:06.327

是的——如果您在您的 PayPal 账户上设置了 IPN URL，那么对于您账户上的每笔交易，该 URL 都会收到回调。

看这里：[https ://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNSetup](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNSetup)

这是示例代码：[https ://www.x.com/developers/PayPal/documentation-tools/code-sample/216623](https://www.x.com/developers/PayPal/documentation-tools/code-sample/216623)

# java - 使用 DocumentListener 修改多个 JTextField

> ID：13240717
> 
> 赞同：3
> 
> 时间：2012-11-05T21:31:29.310
> 
> 标签：java, swing, actionlistener, jtextfield, documentlistener

这是我在学校的第一个 java swing 应用程序。我们必须做一个凯撒编码器。[(http://en.wikipedia.org/wiki/Caesar_cipher)](http://en.wikipedia.org/wiki/Caesar_cipher)

它应该知道加密和解密，即使您不按下按钮，它也应该自动执行。（焦点监听器）

它就像一个梦想，直到我只需要使用“代码！” 按钮。然后我们必须添加一个我创建的 DocumentListener，如下所示。如果我仅将其用于加密或仅用于解密，它就可以工作。当我将两个 JTextField 添加到同一个 DocumentListener 时，就会出现问题。我得到一个带有“AWT-EventQueue-0”标签的 IllegalStateException。它调用了 setText 函数两次，第二次是致命的。我认为这是因为如果我在第一个 JTextField 中键入一个字符，它就是一个插入，那么当我用 setText 设置第二个 JTextField 的内容时，它也是一个插入。我们的教授说它可以很容易地用一个标志来修复，但我失败了。你能帮我吗？

应用程序.java

```
 package javaswinglabor;

    public class Application {
        public static void main(String[] args) {
        CaesarFrame caesarFrame = new CaesarFrame();
        }
    } 
```

凯撒程序.java

```
package javaswinglabor;

public class CaesarProgram {

    /**
     * Caesar kodolo
     * @param input
     * @param offset
     * @return kod
     */
    static String caesarCoder(String input, char offset){
        input = input.toUpperCase();
        String kod="";
        for(int i=0; i < input.length(); i++){
        if(input.charAt(i) >= 'A' && input.charAt(i) <= 'Z' ) {
            kod += (char)(65 + ((input.charAt(i) - 'A' + offset - 'A')%26) );
        }
        }
        return kod;
    }

    /**
     * Caesar dekodolo
     * @param input
     * @param offset
     * @return kod
     */
    static String caesarDecoder(String input, char offset){
    input = input.toUpperCase();
    String kod="";
    for(int i=0; i < input.length(); i++){
        if(input.charAt(i) >= 'A' && input.charAt(i) <= 'Z' ) {
        kod += (char)(65 + (input.charAt(i) - offset + 26)%26 );
        }
    }
    return kod;
    }
} 
```

凯撒框架.java

```
 package javaswinglabor;

import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.HeadlessException;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.FocusEvent;
import java.awt.event.FocusListener;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.text.AbstractDocument;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.DocumentFilter;

public class CaesarFrame extends JFrame{

    //TOP JPanel
    private JComboBox cb;
    private JTextField t1;
    private JButton b;

    //DOWN JPanel
    private JTextField t2;

    //encrypt/decrypt
    private boolean encrypt;

    public CaesarFrame() throws HeadlessException {
    super("SwingLab");
    this.setDefaultCloseOperation(EXIT_ON_CLOSE);
    this.setSize(400, 110);
    this.setResizable(true);
    this.setLayout(new GridLayout(2, 3));

    JPanel pFelso = new JPanel(new FlowLayout(FlowLayout.LEFT));
    JPanel pAlso = new JPanel(new FlowLayout(FlowLayout.LEFT));
    this.add(pFelso);
    this.add(pAlso);

    //TOP Jpanel
    cb = new JComboBox(fillObject());
    t1 = new JTextField(20);
    b = new JButton("Code!");
    pFelso.add(cb);
    pFelso.add(t1);
    pFelso.add(b);

    //DOWN JPanel
    t2 = new JTextField(20);
    //t2.setEditable(false);
    pAlso.add(new JLabel("Output:"));
    pAlso.add(t2);

    //ButtonListener
    OkButtonActionListener obl = new OkButtonActionListener();
    b.addActionListener(obl);

    //DocumentListeners
    CoderDocumentFilter cdf = new CoderDocumentFilter();
    DecoderDocumentFilter ddf = new DecoderDocumentFilter();
    ((AbstractDocument)(t1.getDocument())).setDocumentFilter((cdf));
    ((AbstractDocument)(t2.getDocument())).setDocumentFilter((ddf));

    //InputFieldKeyListener ifkl = new InputFieldKeyListener();
    //t1.addKeyListener(ifkl);

    //SpecialDocumentListener t1_dl = new SpecialDocumentListener();
    //t1.getDocument().addDocumentListener(t1_dl);
    //t2.getDocument().addDocumentListener(t1_dl);

    //FocusListener
    JTextFieldFocusListener jtfl = new JTextFieldFocusListener();
    t1.addFocusListener(jtfl);
    t2.addFocusListener(jtfl);

    this.pack();
    this.setVisible(true);
    }

    private void Coder(){
    Character c = (Character)cb.getSelectedItem();
    t2.setText( CaesarProgram.caesarCoder(t1.getText(), c.charValue()) );
    }
    private void Decoder(){
    Character c = (Character)cb.getSelectedItem();
    t1.setText( CaesarProgram.caesarDecoder(t2.getText(), c.charValue()) );
    }

    private class CoderDocumentFilter extends DocumentFilter{
    @Override public void insertString(DocumentFilter.FilterBypass fb, int offset, String text, AttributeSet attr) throws BadLocationException {
        super.insertString(fb, offset, text.toUpperCase(), attr);
        if (encrypt) {Coder();}
    }
    @Override public void replace (DocumentFilter.FilterBypass fb, int offset, int length, String text, AttributeSet attr) throws BadLocationException {
        super.replace(fb, offset, length, text.toUpperCase(), attr);
        if (encrypt) {Coder();}
    }
    @Override public void remove(DocumentFilter.FilterBypass fb, int offset, int length) throws BadLocationException{
        super.remove(fb, offset, length);
        if (encrypt) {Coder();}
    }
    }

    private class DecoderDocumentFilter extends DocumentFilter{
    @Override public void insertString(DocumentFilter.FilterBypass fb, int offset, String text, AttributeSet attr) throws BadLocationException {
        super.insertString(fb, offset, text.toUpperCase(), attr);
        if (!encrypt) {Decoder();}
    }
    @Override public void replace (DocumentFilter.FilterBypass fb, int offset, int length, String text, AttributeSet attr) throws BadLocationException {
        super.replace(fb, offset, length, text.toUpperCase(), attr);
        if (!encrypt) {Decoder();}
    }
    @Override public void remove(DocumentFilter.FilterBypass fb, int offset, int length) throws BadLocationException{
        super.remove(fb, offset, length);
        if (!encrypt) {Decoder();}
    }
    }

    /**
     * Egy 26-elemu Object tombot tolt fel az angol ABC nagybetuivel.
     * @return object[]
     */
    private static Object[] fillObject() {
    Object[] object = new Object[26];
    for(int i=0; i < 26; i++){
        object[i] = (char)(i+65);
    }
    return object;
    }

    //Button listener
    private class OkButtonActionListener implements ActionListener{
    @Override
    public void actionPerformed(ActionEvent ae) {
        if(encrypt){Coder();}
        else{Decoder();}
    }
    }

    //FocusListener
    private class JTextFieldFocusListener implements FocusListener {

    @Override public void focusGained(FocusEvent fe) {
        if(t1.isFocusOwner()) {encrypt = true;}
        else if(t2.isFocusOwner()){encrypt = false;}
    }

    @Override public void focusLost(FocusEvent fe) {}
    }

    //Previous task
    /*
    private class InputFieldKeyListener extends KeyAdapter {
    @Override public void keyPressed(KeyEvent ke) {
        super.keyPressed(ke);
        Character c = (Character)cb.getSelectedItem();
        String s = String.valueOf(ke.getKeyChar());
        t2.setText(t2.getText() + CaesarProgram.caesarCoder(s, c.charValue()) );
    }
    }
    */
} 
```

我解决了这个问题，谢谢大家，您的有用帮助。我确信它不是最优雅或最快的解决方案，但它最终可以工作。如果有人想让它更有效或更容易/更清洁，我会很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:40:49.037

从[如何编写文档侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/documentlistener.html)：

> 文档监听器不应该修改文档的内容；到侦听器收到更改通知时，更改已经完成。

要解决此问题，请使用 a`DocumentFilter`而不是 a `DocumentListener`。

请参阅此示例[实现文档过滤器](http://download.oracle.com/javase/tutorial/uiswing/components/generaltext.html#filter)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-05T22:35:19.223

如前所述，您应该使用 a[`DocumentFilter`](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DocumentFilter.html)而不是尝试使用 a 来修改字段`DocumentListener`

下面的示例演示了基本思想。让你的解码/编码方法正常工作让我很开心，所以我自己写了；）

查看[MDP 的博客](http://www.jroller.com/dpmihai/entry/documentfilter)以获取更多示例和[文本组件功能](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html)以获取更多信息（有一个关于文档过滤器的部分）

```
public class TestCeaserCipher {

    public static final int OFFSET = 13;

    public static void main(String[] args) {
        new TestCeaserCipher();
    }

    public TestCeaserCipher() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new CeaserCiperPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    protected class CeaserCiperPane extends JPanel {

        private JTextField encode;
        private JTextField decode;

        public CeaserCiperPane() {
            encode = new JTextField(12);
            decode = new JTextField(12);

            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            gbc.weightx = 1;
            add(encode, gbc);
            gbc.gridy++;
            add(decode, gbc);

            ((AbstractDocument) encode.getDocument()).setDocumentFilter(new EncodeFilter());
            ((AbstractDocument) decode.getDocument()).setDocumentFilter(new DecodeFilter());
        }
    }

    public class EncodeFilter extends DocumentFilter {
        @Override
        public void replace(FilterBypass fb, int offset, int length, String text, AttributeSet attrs) throws BadLocationException {
            text = encode(text);
            super.replace(fb, offset, length, text, attrs);
        }

        @Override
        public void insertString(FilterBypass fb, int offset, String text, AttributeSet attr) throws BadLocationException {
            text = encode(text);
            super.insertString(fb, offset, text, attr);

        }
    }

    public class DecodeFilter extends DocumentFilter {
        @Override
        public void replace(FilterBypass fb, int offset, int length, String text, AttributeSet attrs) throws BadLocationException {
            text = decode(text);
            super.replace(fb, offset, length, text, attrs);
        }

        @Override
        public void insertString(FilterBypass fb, int offset, String text, AttributeSet attr) throws BadLocationException {
            text = decode(text);
            super.insertString(fb, offset, text, attr);
        }
    }

    public static String encode(String text) {
        StringBuilder ciper = new StringBuilder(text.length());
        for (int index = 0; index < text.length(); index++) {
            ciper.append(TestCeaserCipher.encode(text.charAt(index), OFFSET));
        }

        return ciper.toString();
    }

    public static String decode(String text) {
        StringBuilder ciper = new StringBuilder(text.length());
        for (int index = 0; index < text.length(); index++) {
            ciper.append(TestCeaserCipher.decdoe(text.charAt(index), OFFSET));
        }

        return ciper.toString();
    }

    public static char encode(char input, int offset) {
        char encode = Character.toUpperCase(input);
        if (encode >= 'A' && encode <= 'Z') {

            int min = (int)'A';
            int max = (int)'Z';

            int value = (encode - offset);

            if (value < min) {
                value++;
                value = min - value;
                value = max - value;
            }

            encode = (char)value;

        }
        return encode;
    }

    public static char decdoe(char input, int offset) {
        char decode = Character.toUpperCase(input);
        if (decode >= 'A' && decode <= 'Z') {

            int min = (int)'A';
            int max = (int)'Z';

            int value = decode + offset;
            if (value > max) {
                value--;
                value = value - max;
                value = min + value;
            }

            decode = (char)value;

        }
        return decode;
    }

} 
```

# magento - 修改宾客订单电子邮件地址

> ID：13240719
> 
> 赞同：3
> 
> 时间：2012-11-05T21:31:33.520
> 
> 标签：magento, phpmyadmin, magento-1.7

我的 Magneto 系统中有一个客人订单，我现在需要修改存档的电子邮件地址。提到的客户没有创建帐户，所以我相信我需要直接修改 MySQL 表。谁能指出我需要修改哪些表格的正确方向？

我在“sales_flat_order”、“sales_flat_order_address”和“sales_flat_quote”等中看到了一个电子邮件地址，但我不确定要编辑什么。在进行此类编辑时，我需要注意什么后果吗？

谢谢！

我正在使用 Magneto 社区 1.7.0.2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T23:19:59.153

为了数据一致性，您可以更改所有 3 个，sales_flat_order 应该是显示在管理员订单详细信息页面上的那个。

您也可以通过订单号更改它

```
$order = Mage::getModel('sales/order')->load($order_id);
$order->setCustomerEmail($email_address)->save(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T14:15:45.957

```
Update Customer customerwhole account : Akram Abbasi
/**
 * Create customer corporate account action
 */
public function updatePostAction()
{

    $session = $this->_getSession();
    if ($session->isLoggedIn()) {
        $this->_redirect('*/*/');
        return;
    }
    $session->setEscapeMessages(true); // prevent XSS injection in user input
    if ($this->getRequest()->isPost()) {
        $errors = array();

        if (!$customer = Mage::registry('current_customer')) {
            $customer = Mage::getModel('customer/customer')->setId(null);
        }

        /* @var $customerForm Mage_Customer_Model_Form */
        $customerForm = Mage::getModel('customer/form');
       // $customerForm->setFormCode('customer_account_create')->setEntity($customer);
        $customerForm->setFormCode('customer_account_edit')->setEntity($customer);

        $customerData = $customerForm->extractData($this->getRequest());
        $customerErrors = $customerForm->validateData($customerData);

        // get customer form value
        $firstname = $customerData['firstname'];
        $lastname = $customerData['lastname'];
        $email =    $customerData['email'];
        $password = (string) $this->getRequest()->getPost('password');
        $passwordConfirmation = (string) $this->getRequest()->getPost('confirmation');

        $customer_id = Mage::getModel('customer/customer')->getCollection()->addAttributeToFilter('customer_id',$this->getRequest()->getPost('customer_id'))->load();
        $customerprimaryid = Mage::getModel('customer/customer')->getCollection()->addAttributeToFilter('customer_id',$this->getRequest()->getPost('customer_id'))->load();
        $invoice_number = Mage::getModel('customer/customer')->getCollection()->addAttributeToFilter('invoice_number',$this->getRequest()->getPost('invoice_number'))->load();

        // fetch data of invoice_number
        foreach($invoice_number as $value){  
            $invoice_number = $value->getdata('invoice_number');  
        }

        //fetch data from existing records 
        foreach($customer_id as $value){  
            $customer_id = $value->getdata('customer_id'); // get attribute
            $customer_email = $value->getdata('email'); // get attribute
            $entity_id = $value->getdata('entity_id');     // Customer table primary key
            $entity_type_id = $value->getdata('entity_type_id'); 
        }

        // check customer_id and invoice_number with existing database records 
        if($customer_id != $this->getRequest()->getPost('customer_id') && $invoice_number  != $this->getRequest()->getPost('invoice_number')) {
            $message = $this->__('Customer id or Invoice Number is invalid or does not exist');
            $session->setEscapeMessages(false);
            $session->addError($message);
            $this->_redirectError(Mage::getUrl('customer/account/createcorporate', array('_secure' => true)));
        return;
        }

        if($password != $passwordConfirmation) {
            $message = $this->__('Please make sure your passwords match');
            $session->setEscapeMessages(false);
            $session->addError($message);
            $this->_redirectError(Mage::getUrl('customer/account/createcorporate', array('_secure' => true)));
        return;
        }

        if ($this->getRequest()->getParam('is_subscribed', false)) {
            $customer->setIsSubscribed(1);
        } 

        // due to Magneto Limitation or dependency of email inserting/editing on identical records,Magneto customer->save() function does not allow to according We use to do it with custom            
        if(isset($invoice_number) && isset($customer_id)) {
            $write = Mage::getSingleton('core/resource')->getConnection('core_write');
            $write->query("UPDATE customer_entity set email='$email' where entity_id=$entity_id");
            $write->query("UPDATE customer_entity_varchar set value='$firstname' where entity_id=$entity_id and attribute_id in (select attribute_id from eav_attribute where attribute_code='firstname' and entity_type_id=$entity_type_id)");
            $write->query("UPDATE customer_entity_varchar set value='$lastname' where entity_id=$entity_id and attribute_id in (select attribute_id from eav_attribute where attribute_code='lastname' and entity_type_id=$entity_type_id)");

        }

        // load by new updated data to avoid email conflict
        $customer = Mage::getModel("customer/customer"); 
        $customer->setWebsiteId(Mage::app()->getWebsite()->getId());
        $customer->load($entity_id); //load customer by entity id 

         if (strlen($password)) {
            /**
             * Set entered password and its confirmation - they
             * will be validated later to match each other and be of right length
             */
            $customer->setPassword($password);
            $customer->setConfirmation($passwordConfirmation);
            $customer->setConfirmation(null);
            $customer->save();

        } else {
            $errors[] = $this->__('New password field cannot be empty.');
        }

        /**
         * Initialize customer group id
         */
        $customer->getGroupId();

        if ($this->getRequest()->getPost('create_address')) {
            /* @var $address Mage_Customer_Model_Address */
            $address = Mage::getModel('customer/address');
            /* @var $addressForm Mage_Customer_Model_Form */
            $addressForm = Mage::getModel('customer/form');
            $addressForm->setFormCode('customer_register_address')->setEntity($address);

            $addressData    = $addressForm->extractData($this->getRequest(), 'address', false);
            $addressErrors  = $addressForm->validateData($addressData);
            if ($addressErrors === true) {
                $address->setId(null)
                    ->setIsDefaultBilling($this->getRequest()->getParam('default_billing', false))
                    ->setIsDefaultShipping($this->getRequest()->getParam('default_shipping', false));
                $addressForm->compactData($addressData);
                $customer->addAddress($address);

                $addressErrors = $address->validate();
                if (is_array($addressErrors)) {
                    $errors = array_merge($errors, $addressErrors);
                }
            } else {
                $errors = array_merge($errors, $addressErrors);
            }
        }

        try {
            $customerErrors = $customerForm->validateData($customerData);
            if ($customerErrors !== true) {
                $errors = array_merge($customerErrors, $errors);
            } else {
                $customerForm->compactData($customerData);
                $customer->setPassword($this->getRequest()->getPost('password'));
                $customer->setConfirmation($this->getRequest()->getPost('confirmation'));
                $customerErrors = $customer->validate();
                if (is_array($customerErrors)) {
                    $errors = array_merge($customerErrors, $errors);
                }
            }

            $validationResult = count($errors) == 0;

            if (true === $validationResult) {
                $customer->save();

                Mage::dispatchEvent('customer_register_success',
                    array('account_controller' => $this, 'customer' => $customer)
                );

                if ($customer->isConfirmationRequired()) {
                    $customer->sendNewAccountEmail(
                        'confirmation',
                        $session->getBeforeAuthUrl(),
                        Mage::app()->getStore()->getId()
                    );
                    $session->addSuccess($this->__('Account confirmation is required. Please, check your email for the confirmation link. To resend the confirmation email please <a href="%s">click here</a>.', Mage::helper('customer')->getEmailConfirmationUrl($customer->getEmail())));
                    $this->_redirectSuccess(Mage::getUrl('*/*/index', array('_secure'=>true)));
                    return;
                } else {
                    $session->setCustomerAsLoggedIn($customer);
                    $url = $this->_welcomeCustomer($customer);
                    $this->_redirectSuccess($url);
                    return;
                }
            } else {
                $session->setCustomerFormData($this->getRequest()->getPost());
                if (is_array($errors)) {
                    foreach ($errors as $errorMessage) {
                        $session->addError($errorMessage);
                    }
                } else {
                    $session->addError($this->__('Invalid customer data'));
                }
            }
        } catch (Mage_Core_Exception $e) {
            $session->setCustomerFormData($this->getRequest()->getPost());
            if ($e->getCode() === Mage_Customer_Model_Customer::EXCEPTION_EMAIL_EXISTS) {
                $url = Mage::getUrl('customer/account/forgotpassword');
                $message = $this->__('There is already an account with this email address. If you are sure that it is your email address, <a href="%s">click here</a> to get your password and access your account.', $url);
                $session->setEscapeMessages(false);
            } else {
                $message = $e->getMessage();
            }
            $session->addError($message);
        } catch (Exception $e) {
            $session->setCustomerFormData($this->getRequest()->getPost())
                ->addException($e, $this->__('Cannot save the customer.'));
        }
    }

    $this->_redirectError(Mage::getUrl('*/*/createcorporate', array('_secure' => true)));
} 
```

# sql - 在表值参数上使用带有“LIKE”的子查询进行存在性检查

> ID：13240720
> 
> 赞同：0
> 
> 时间：2012-11-05T21:31:33.133
> 
> 标签：sql, sql-server, sql-server-2008, table-valued-parameters

我正在从excel导入数据库。我正在传递一个带有一堆值的表值参数，其中一个是外键。问题是，在数据库中，键值`nvarchar`总是前面有 2 或 3 个零，但是发送 excel 文件的人没有正确格式化该列，并且那些前导零被切断。

在此过程中我需要做的第一件事是检查所有这些值是否存在于父表中`LIKE`（因为缺少前导零）。如果父表中不存在任何值，则事务不会继续。

为此，我需要一些有关 MS SQL 语法的帮助。

# sql - 解释分析中嵌套反循环的成本

> ID：13240724
> 
> 赞同：2
> 
> 时间：2012-11-05T21:31:48.310
> 
> 标签：sql, performance, postgresql, explain

我通过解释分析得到以下输出：

```
Nested Loop Anti Join  (cost=0.00..36.92 rows=83 width=3) (actual time=0.303..1 0.631 rows=83 loops=1)
->  Seq Scan on paises p  (cost=0.00..5.46 rows=246 width=3) (actual time=0.0 43..0.336 rows=246 loops=1)
->  Index Scan using ciudades_pkey on ciudades c  (cost=0.00..12.92 rows=192 width=3) (actual time=0.038..0.038 rows=1 loops=246)
      Index Cond: (c.pais_codigo = (p.pais_codigo)::bpchar)
Total runtime: 10.897 ms
(5 rows) 
```

我不明白为什么循环反连接成本为 36.92。

在其他站点中，我看到了循环的公式：上部扫描成本 + 上部行 * 内部成本。

但我的成本是 36.92，所以没办法。dbmanager 如何解决此查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T12:32:52.250

请参阅PostgreSQL 源代码中的[initial_cost_nestloop](http://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/optimizer/path/costsize.c#l1644)和 final_cost_nestloop 以了解其计算方式的确切算法。

优化器正在考虑内部关系的第一次和重复扫描之间的差异，以及对于反连接只有索引扫描的第一个匹配项可以被处理的事实。加入这两个关系的 CPU 成本被添加到子计划成本之上。

# moles - Pex 提出了一个解决 Moles 错误的解决方案

> ID：13240726
> 
> 赞同：1
> 
> 时间：2012-11-05T21:31:56.043
> 
> 标签：moles, pex

我尝试使用 Pex 来探索以下方法：

```
public float MultiplyFloat(float a, float j)
{
    if (a * a == 2)
    {
    if (j == 123)
    {
        a = 2;
    }
    }
    else
    a = 3;

    return 3;
} 
```

我知道 Z3 是一个线性算术求解器，不支持浮点，但 Visual Studio 2010 附加组件中的 Pex 向导建议我使用“Moles Type”，我使用这个建议和 Pex 向导创建：

1) Microsoft.Pex.Framework.moles 文件

```
<Moles xmlns="http://schemas.microsoft.com/moles/2010/">
  <Assembly Name="Microsoft.Pex.Framework" />
</Moles> 
```

2）一个准备好的类：__TestabilityHelperPreparation

```
using System;
using Microsoft.Pex.Framework;
using Microsoft.Pex.Engine.Symbols.Moles;
using Microsoft.Pex.Engine.Symbols;

namespace Microsoft.Pex.Engine.Symbols.Preparations
{
    /// <summary>Contains a method to prepare the type __TestabilityHelper</summary>
    public static partial class __TestabilityHelperPreparation
    {
        /// <summary>Prepares the environment (and the moles) before executing any method of the prepared type __TestabilityHelper</summary>
        [PexPreparationMethod(typeof(__TestabilityHelper))]
        public static void Prepare()
        {
            M__TestabilityHelper.BehaveAsCurrent();
            // TODO: use Moles to replace API that call into the environment
        }
    }
} 
```

但编译时出现以下错误：

```
C:\Program Files (x86)\Microsoft\Contracts\MsBuild\v4.0\Microsoft.CodeContracts.targets(274,5): error MSB3073: uscita dal comando ""C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\Bin\sn.exe" /R "o\Microsoft.Pex.Framework.Moles.dll" "m.g.snk"" con codice 9009\. [D:\BenchMarkTesterToolLib.Tests02\obj\Debug\Moles\mpf\m.g.csproj]

Moles compilation FAILED - 58,028916314783s

C:\Program Files\Microsoft Moles\bin\Microsoft.Moles.targets(79,5): error MSB3073: uscita dal comando ""C:\Program Files\Microsoft Moles\bin\moles.exe" @D:\BenchMarkTesterToolLib.Tests02\obj\Debug\Moles\moles.args" con codice -1002. 
```

那么，我是一个错误还是 Pex 建议我一个错误的解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:33:39.697

问题实际上出在代码合同上，它运行的是错误版本的`sn`. 这已在最新版本的代码合同中得到修复。因此，请尝试更新代码合同并重试。

# .net - JS 到 SQL 日期时间

> ID：13240728
> 
> 赞同：1
> 
> 时间：2012-11-05T21:32:01.020
> 
> 标签：.net, sql

我从客户那里传递了一个看起来像这样的日期时间......

“2012 年 11 月 5 日星期一 21:27:58 GMT+0000（GMT 标准时间）”

我想将其保存到 sql 日期时间字段中，同时保留尽可能多的日期数据。

目前，在将日期时间保存到数据库之前，我正在.net 后端进行这样的转换....

```
DateTime.ParseExact(date.Substring(0, 24),
                             "ddd MMM d yyyy HH:mm:ss",
                             CultureInfo.InvariantCulture); 
```

这会丢失 GMT 部分。

有没有办法可以将它保存在适合 SQL 的 ParseExact 中？

# php - 使用 mysql 查询并在 php 中产生结果？

> ID：13240734
> 
> 赞同：-4
> 
> 时间：2012-11-05T21:32:29.173
> 
> 标签：php, mysql, environment

我从 bluefleet (BF) 获得了一些关于 mysql 查询的帮助，我现在需要在 php 环境中使用该查询，这就是我想出的，首先你能告诉我它是否正确，其次是我吗在我对结果做了一些事情后需要释放查询吗？

这是查询

```
 $myquery= "select sum(total)
from
(
    SELECT count(*) as total
    FROM " .TABLE_PREFIX."tview v
    where v.ipaddress = $ips
    union all
    SELECT count(*) as total
    FROM " .TABLE_PREFIX."tview1 v1
    where v1.ipaddress = $ips
    union all
    SELECT count(*) as total
    FROM " .TABLE_PREFIX."tview3` v3
    where v3.ipaddress = $ips
) src";

while ($row = mysql_fetch_array($myquery)) {

If($row !=0){
echo "NOT EMPTY";
}else{
echo "EMPTY";
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:35:51.390

这里发生了很多事情，但请记住，进入 sql 的 php 看起来像这样：

```
 UPDATE USER SET MONEY = '$money2'
                    WHERE ID = '$uID'" 
```

注意变量周围的单个 ' ' ，然后 $ 表示您要设置的 php 变量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:38:38.477

您的查询看起来不错。使用这些语句执行查询并获取计数：

```
 $result = mysql_query($myquery);

    $rowCount = mysql_num_rows($result);

    If($rowCount !=0){
       echo "NOT EMPTY";
    }else{
      echo "EMPTY";
    } 
```

释放结果：

```
 mysql_free_result($result); 
```

# java - 发布到 ActiveMQ 上的主题

> ID：13240739
> 
> 赞同：0
> 
> 时间：2012-11-05T21:32:42.820
> 
> 标签：java, jms, activemq

我在使用 java 发布到 ActiveMQ 上的 JMS 主题时遇到问题。我的代码非常基本，但出现错误。当我尝试发送消息时似乎出现了问题：

```
ActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory(url);

ActiveMQConnection connection = (ActiveMQConnection) connectionFactory.createConnection();
connection.start();

ActiveMQSession session = (ActiveMQSession) connection.createSession(false,Session.AUTO_ACKNOWLEDGE);
Topic topic = ((TopicSession) session).createTopic(subject);
ActiveMQMessageProducer producer = (ActiveMQMessageProducer) session.createProducer(topic);

ActiveMQTextMessage txtmessage = (ActiveMQTextMessage) session.createTextMessage();
txtmessage.setText(readFileAsString("foo.txt",null));

producer.send(txtmessage); 
```

Producer.send 没有发送短信，我收到以下错误：

```
Exception in thread "main" java.lang.NoSuchMethodError: org.apache.activemq.ActiveMQMessageProducerSupport.getDestination()Ljavax/jms/Destination; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:41:26.903

```
java.lang.NoSuchMethodError: org.apache.activemq.ActiveMQMessageProducerSupport.getDestination()Ljavax/jms/Destination; 
```

`NoSuchMethodError`始终表明您的客户端类路径中有错误版本（较低版本（或）较高版本）的客户端 jar。

# upload - 如何在上传完成后立即处理上传的文件

> ID：13240741
> 
> 赞同：2
> 
> 时间：2012-11-05T21:32:54.630
> 
> 标签：upload, message-queue

我有一个系统可以获取用户上传的文件并以特定方式处理它们。我在这里唯一要问的是时间——如何在文件上传完成后*立即*处理它们？

我过去使用过排队系统——例如 beanstalkd，我很确定工作队列应该是这个解决方案的一部分，但我被困在通知部分。问题是上传本身没有连接到处理。上传由 SFTP 服务处理。处理由一组 perl 脚本处理。

如何提醒作业队列上传已完成？

我已经考虑过以下想法，但它们在某些方面都显得老套、脆弱或站不住脚。

*   以某种方式将校验和发送到作业队列，以便它知道文件已完成。不过，我想不出一个好的方法来做到这一点，因为这样做的东西可能也知道上传已经完成，并且应该直接提醒队列。
*   确保上传的文件使用其校验和作为其名称。这行不通，因为我们正在处理进行实际上传的用户。
*   让用户在上传后发送第二个文件“完成”，然后轮询该文件。再一次，对用户来说太复杂了。
*   观察文件的增长——如果文件在很长一段时间内停止增长，则认为它是完整的。不过，这并不可靠。

如果它很重要，架构是

*   Jscape SFTP 服务器
*   Perl
*   Linux (Ubuntu 10.04) 操作系统

**编辑 2012-11-06**

我做了更多的研究，发现了这一点：

*   堆栈溢出：[如何确定文件是否仍在通过 ftp 传输](https://stackoverflow.com/questions/7241978/how-to-determine-wheter-a-file-is-still-being-transferred-via-ftp)

和这个：

*   一些网络开发论坛帖子（旧，约 2004 年）：[http ://www.velocityreviews.com/forums/t136270-determing-if-ftp-process-is-finished.html](http://www.velocityreviews.com/forums/t136270-determing-if-ftp-process-is-finished.html)

（除其他外，都相似）。长话短说，答案是“**您必须以某种方式表明上传已完成；所有其他完成性测试都是不可靠的**”。

事实证明，我的 SFTP 服务器确实有一个触发系统，可以触发包括任意进程在内的操作，以响应诸如“文件上传完成”之类的事件。所以我要使用它。我仍然很好奇是否有人找到了更通用的解决方案，但我将关闭此解决方案，因为我认为问题已得到解答。

# css - IE 8 问题无法识别选择器

> ID：13240750
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:33:36.720
> 
> 标签：css, internet-explorer-8

我不知道为什么 IE 8 不能识别这个选择器“*=”

这是我用于该网站的文档类型：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

选择器适用于除 IE 8 之外的所有浏览器 - 有什么建议吗？

这是完整的选择器：

```
.contourErrorMsg[style*="display: inline;"],
.contourErrorMsg[style*="display:inline;"] {
    display: block !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T05:08:50.463

如果没有标记或 JSfiddle 演示问题，很难确定是什么导致了您的问题。 [IE8 确实支持子字符串属性选择器 (` [*=]')](http://msdn.microsoft.com/en-us/library/ie/aa358828%28v=vs.85%29.aspx)。

可能是您的文档中有*其他内容将 IE8 置于 quirks 模式；*在这种情况下，IE8 不支持此选择器。

也许您缺少 . 末尾的分号`display:none`。（请参阅[http://jsfiddle.net/vKCU3/](http://jsfiddle.net/vKCU3/)。）该选择器匹配属性中的实际字符，而不是渲染的显示样式，因此这些小事情会有所作为。

尝试从选择器中删除字符，直到看到匹配项 IE：

```
.contourErrorMsg[style*="display"]
{ color: red; } 
```

还要确保这`.contourErrorMsg`是正确的课程。

# ios - iPhone Facebook 好友选择器 预选好友

> ID：13240751
> 
> 赞同：1
> 
> 时间：2012-11-05T21:33:38.030
> 
> 标签：ios, facebook, multi-friend-selector

我正在尝试确定内置的 Facebook 好友选择器是否会成为实现我想要实现的目标的理想方式。我希望能够在用户看到朋友选择器之前选择朋友。假设我有一个朋友列表 {Bill, Susy, Earl}，当朋友选择器显示时，我希望检查每个名字。

这似乎是不可能的，因为选择的 NSArray 是只读的。

```
@property (nonatomic, retain, readonly) NSArray *selection
Description The list of friends that are currently selected in the veiw. The items in the array are FBGraphUser objects. 
```

有什么办法可以解决这个问题，还是我应该创建自己的朋友选择器？

# ruby - 如何确定调用方法的范围？

> ID：13240754
> 
> 赞同：1
> 
> 时间：2012-11-05T21:34:06.080
> 
> 标签：ruby

我正在编写某种类似于基准测试实用程序的东西，我很好奇是否有一种简单的方法可以从什么上下文中判断一个方法正在被调用。让我举例说明：

```
module Foo
  my_method
  class Foo
    my_method
    def self.foo
       my_method
    end
    def foo
      my_method
    end
  end
end
Foo::Foo.foo
Foo::Foo.new.foo 
```

理想情况下，对于上述情况，“my_method”将打印如下内容：

> 在模块“Foo”的定义中调用 在类“Foo”的定义中调用 在类方法“foo”的运行期间调用 在实例方法“foo”的运行期间调用

如果我可以获得对当前“范围”或上下文（或任何 ruby​​ 所称的）的某种引用，这将很容易，但我不知道这是否可能，更不用说如何去做了。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:39:37.637

[Kernel#set_trace_func](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-set_trace_func)允许您定义跟踪过程（用于调试/分析目的）。例如：

```
class Foo
  def self.foo
  end

  def foo
  end
end

set_trace_func proc { |event, file, line, id, binding, classname|
  printf "%8s %s:%-2d %10s %8s\n", event, file, line, id, classname
}

Foo.foo
Foo.new.foo 
```

印刷：

```
c-return foo.rb:11 set_trace_func   Kernel
    line foo.rb:13                    
    call foo.rb:2         foo      Foo
  return foo.rb:3         foo      Foo
    line foo.rb:14                    
  c-call foo.rb:14        new    Class
  c-call foo.rb:14 initialize BasicObject
c-return foo.rb:14 initialize BasicObject
c-return foo.rb:14        new    Class
    call foo.rb:5         foo      Foo
  return foo.rb:6         foo      Foo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T17:51:58.823

**解决方案**

如果您*唯一*的要求是检测模块定义、类定义和运行方法（类或实例方法）中的方法，那么您将使用以下内容：

```
def my_method
    if ( a = /^.*?:\d*:in `(.*)'$/.match( caller[0] ) )
        puts ( b = /^<(.*?):(.*?)>$/.match( a[1] ) ) ? 
            "Called in definition of #{b[1].capitalize} \"#{b[2]}\"" :
            "Called during run of #{(self.is_a? Class) ? 'class' : 'instance'} method \"#{a[1]}\""
    end
end 
```

**分析**

它使用`caller`包含堆栈跟踪的哪个。第一个正则表达式只解析调用者元素的语法，即：

```
[file]:[line]:in `<[type]:[name]>' 
```

对于模块和类和

```
[file]:[line]:in `[method]' 
```

对于方法。

因此，第一个正则表达式删除了该`[file]:[line]:in`部分。第二个检查是否有`<X:Y>`模式。

如果是，则表示`X`包含`class`或`module`可以直接大写，`Y`包含类或模块的名称。

否则，我们直接拥有方法名称，我们只需要检查它是*实例*方法还是*对象*方法。为此，我们只需检查`self`：如果它是 a 的实例，`Class`那么我们正在调用类方法，否则我们正在调用实例方法。

**测试**

在您的示例[中，它提供以下输出](http://ideone.com/VThr50)：

> 在模块“Foo”
> 的定义中调用 在类“Foo”的定义中
> 调用 在类方法“foo”
> 的运行期间调用 在实例方法“foo”的运行期间调用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T22:44:23.260

尝试这个：

```
Foo::Foo.method(:foo)
Foo::Foo.new.method(:foo) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T23:52:54.713

在方法定义中，使用`__callee__`. 直接在模块内，使用`Module.nesting`.

# javascript - 滑动包装器可防止页面上的所有点击事件

> ID：13240760
> 
> 赞同：1
> 
> 时间：2012-11-05T21:34:25.717
> 
> 标签：javascript, jquery, jquery-ui

我正在使用`http://labs.skinkers.com/touchSwipe/`插件进行触摸事件。主要问题是当我在包装元素上附加滑动事件时，会阻止所有其他事件。在桌面浏览器上工作，但不能在 ipad 上工作。

我尝试在目标元素上停止传播，但仍然有问题。

```
_pager.prototype.initialize = function () {
    "use strict";
    var base = this;
    //cursorPosition();

    base.$container.swipe({
        swipeUp   : function (e, direction, distance, duration, fingerCount) {
            if ($(event.target).hasClass('inner-wrapper')) {

                base.$container.transition({ y : -674 }, 500, 'out')
            }

        },
        swipeDown : function (e, direction, distance, duration, fingerCount) {

            if ($(event.target).hasClass('inner-wrapper')) {
                base.$container.transition({ y : 0 }, 500, 'out')
            }
        }

    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:20:05.490

使用 css 类 noSwipe 修复，该类排除了滑动元素。

# search - 在 splunk 搜索中如何获取具有没有任何值的字段的所有实例

> ID：13240766
> 
> 赞同：1
> 
> 时间：2012-11-05T21:34:44.203
> 
> 标签：search, isnull, splunk

这是我的日志文件中的行。我想获取所有没有 PAMapped 值的 searchTerms

> 2012-10-29 11:20:21,711 - searchTerm=speeding&location=Soperton%2C+GA&PAMapped=

这是我给的搜索。

> index=savvis-varnish host="dell1000a-12" source="/flocal/logs/lawyers.findlaw.com/search-mapping.log" NOT PMapped=* early=-1mon@mon

但它不会返回所有实例。它只返回一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T10:47:10.693

我假设该`PAMapped`字段已被提取...

我将使用`fillnull`命令 ( [docs](http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/fillnull) ) 为该字段中的所有空值添加一个通用值。然后，这将允许对具有 NULL 值的字段进行更简单的过滤，就像在您的用例中一样。

例如，您可能可以执行以下操作：

`index=savvis-varnish host="dell1000a-12" source="/flocal/logs/lawyers.findlaw.com/search-mapping.log" earliest=-1mon@mon | fillnull value=NULL PAMapped | search PAMapped=NULL`

这可能不是最有效的搜索，但它可能会提供更好的扩展潜力。

您也可以尝试使用`where`命令来过滤结果（[docs1](http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Where)和[docs2](http://docs.splunk.com/Documentation/Splunk/5.0/SearchReference/CommonEvalFunctions)），类似以下内容可能会起作用：

`index=savvis-varnish host="dell1000a-12" source="/flocal/logs/lawyers.findlaw.com/search-mapping.log" earliest=-1mon@mon | where isnull(PAMapped)`

希望这可以帮助。

PS 您可以在 SplunkBase 官方 Splunk 论坛上找到更多有用和及时的回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-23T18:53:42.013

试试这个查询：

`index=savvis-varnish host="dell1000a-12" source="/flocal/logs/lawyers.findlaw.com/search-mapping.log" earliest=-1mon@mon | where isnull(PAMapped)`

# javascript - 如何修复损坏的 JQueryUI Datepicker

> ID：13240776
> 
> 赞同：1
> 
> 时间：2012-11-05T21:35:32.867
> 
> 标签：javascript, ruby-on-rails-3, jquery-ui

我有一个 JQueryUI datepicker 定义如下：

```
$(function() {
  $(".visit_date").datepicker({
    changeMonth: true,
    changeYear: true,
    showButtonPanel: true,
    dateFormat: "yy-mm-dd"
  });
}); 
```

产生 Datepicker 文本框的视图代码是

```
<td><%= f.label :visit_date %></td>
<td><%= text_field_tag :visit_date, @visit.visit_date, :class => 'visit_date' 
```

并且视图在渲染时会在这样的标签之间生成：

```
<div id="action_window">
   (rendered HTML to be acted on by user) 
</div> 
```

为什么 Javascript 选择器“.visit_date”不与此视图挂钩？换句话说，没有它曾经工作的“action_window”标签。我的想法是“.visit_date”将与“visit_date”类匹配任何内容。

====================== 2012 年 11 月 7 日更新。Javascript代码：

```
$(function() {
  $("#visit_date").datepicker({
    changeMonth: true,
    changeYear: true,
    showButtonPanel: true,
    dateFormat: "yy-mm-dd"
}); 
```

});

用户按下按钮的原始位置：

```
<%= link_to "Add Visit", new_client_visit_path(@client), :remote => true, :class => "btn btn-primary btn-large" %> 
```

在访问控制器中：

```
respond_to do |format|
  format.html
  format.js { }
end 
```

在视图/访问/new.js.erb 中：

```
$('#action_window').html('<%= escape_javascript render(:partial => "new") %>');
$('#action_window').show; 
```

（#action_window 是客户端索引视图中的一个 div）

在视图/访问/_new.html.erb 中：

```
<%= render "form" %>
<%= link_to "Cancel", @client, :class => "btn btn-primary btn-large" %> 
```

在视图/访问/_form.html.erb 中：

```
%= form_for [@client, @visit] do |f| %>
<td><%= text_field_tag :visit_date, @visit.visit_date, :class => 'visit_date' %> 
```

我无法让 Datepicker 工作，大概是因为创建“新访问”视图的 HTML 被渲染，并且不知何故 JQueryUI 无法在没有将“hasDatepicker”添加到类的情况下关联它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:51:52.403

我认为您对类选择器的假设是正确的。根据我的经验，无论 div 包含什么，datepicker 都应该连接到您选择的任何类/id。我会检查这些事情：

1.  确保您没有错误地使用两个 jQuery 标签。我这样做了，日期选择器不起作用。

2.  在此代码之前是否有任何 javascript 代码被破坏？我认为只要遇到第一个错误，JS 执行就会停止。我会在 Chrome 中打开页面，右键单击检查元素，然后查看控制台以查看是否有任何 JS 错误。

这些建议基于您的 Rails 代码生成带有 class="visit_date" 的输入标签的假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T18:26:16.413

当您动态添加要成为日期选择器的元素时，原始静态页面包含说此 jquery 以使某些元素成为日期选择器：

$('.visit_date').datepicker();

当新元素被添加并且它有class='visit_date'时，它不会是一个日期选择器，除非你在它上面调用jquery的数据选择器。

因此，如果您使用 new.js.erb 添加动态 datepicker 元素，您可以这样做：

```
$('#action_window').html('<%= escape_javascript render(:partial => "new") %>');
$('.visit_date').datepicker(); 
```

# jquery - history.pushState 在浏览器后退按钮上中断

> ID：13240783
> 
> 赞同：3
> 
> 时间：2012-11-05T21:35:57.820
> 
> 标签：jquery, ajax, browser-history, pushstate

我正在开发一个单页应用程序，其中每个部分都是通过 ajax 加载的。主页是它自己的页面，然后单击“关于”，它会将您带到单页应用程序。我已经获得了要更改每个部分的 url 以及浏览器上的后退和前进按钮以使用此代码段：

```
$('.down-button').on('click', function() {
        var stateObj = { principles: "about-principles" };
        history.pushState(stateObj, null, "about-principles");
        $('#principles-wrap').scrollintoview({ duration: 1000 });
    }); 
```

但是，当您一路点击返回首页时，首页并没有刷新，您停留在“关于”页面。或者，如果您单击返回主页的链接，则会收到 404 错误。

我错过了什么？

**编辑**

这是其余的代码：

```
function button_scroll () {
// Call scrollIntoView js file into this 
$.getScript("/js/jquery.scrollintoview.min.js", function() {
    $('.down-button').on('click', function() {
        var stateObj = { principles: "about-principles" };
        history.pushState(stateObj, null, "about-principles");
        $('#principles-wrap').scrollintoview({ duration: 1000 });
    });
    $('.up-button-principles').on('click', function() {
        var stateObj = { mission: "about-mission" };
        history.pushState(stateObj, null, "about-mission");
        $('#mission-wrap').scrollintoview({ duration: 1000 });
    });
    $('.down-button-principles').on('click', function() {
        var stateObj = { snapshot: "about-snapshot" };
        history.pushState(stateObj, null, "about-snapshot");
        $('#snapshot-wrap').scrollintoview({ duration: 1000 });
    });
    $('.up-button-snapshot').on('click', function() {
        var stateObj = { principles: "about-principles" };
        history.pushState(stateObj, null, "about-principles");
        $('#principles-wrap').scrollintoview({ duration: 1000 });
    });
    $('.down-button-snapshot').on('click', function() {
        var stateObj = { people: "about-people" };
        history.pushState(stateObj, null, "about-people");
        $('#people-wrap').scrollintoview({ duration: 1000 });
    });
    $('.up-button-people').on('click', function() {
        var stateObj = { snapshot: "about-snapshot" };
        history.pushState(stateObj, null, "about-snapshot");
        $('#snapshot-wrap').scrollintoview({ duration: 1000 });
    });

}); 
```

}

```
//Dropdown
$(document).ready(function () {
$(window).on('load resize', function () {
    resize_mission();
    resize_principles();
    resize_snapshot();
    resize_people();
    button_scroll();
});
var dropDown = $('.dropdown');
$('h3.about').on('click', function() {
    dropDown.slideDown('fast', function() {
        var url = 'about2.php'
        var stateObj = { mission: "about-mission" };
        history.pushState(stateObj, null, "about-mission");
        $.get(url, function(data) {
            resize_mission();
            resize_principles();
            resize_snapshot();
            resize_people();
            button_scroll();
        });
    });
}); 
```

});

这就是我正在做的。没有插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:46:15.417

您是否在关于页面上停止点击事件到主页的默认操作？如您正在使用`preventDefault()`或`stopPropagation()`在链接上单击您的关于页面？您是否也在停止 hashchange 事件的默认行为？我们可能需要查看更多关于您的历史实现的代码。您是否使用任何历史插件？

# javascript - 使用箭头滚动 div

> ID：13240784
> 
> 赞同：1
> 
> 时间：2012-11-05T21:36:01.473
> 
> 标签：javascript, google-closure-library

我想复制带有箭头的滚动条的功能，以便您可以使用向上和向下箭头在 div 内滚动。但是，我正在寻找没有 jQuery 或任何其他库的解决方案。我已经为 jQuery 找到了 jScrollPane，但我使用的是 Google 闭包库。

如果有人可以解释它背后的原理，或者更好地提供一个 Google Closure Library 解决方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:56:26.413

我不知道使用闭包库中内置的功能来自动执行此操作的方法，但基本上，您需要将箭头覆盖在要滚动的内容之上，当单击它们时，更改`element.scrollTop`或`element.scrollLeft`. 如果您想为滚动设置动画，您甚至可以使用[https://closure-library.googlecode.com/svn/docs/class_goog_fx_dom_Scroll.html 。](https://closure-library.googlecode.com/svn/docs/class_goog_fx_dom_Scroll.html)

# javascript - 将自动滚动添加到 JavaScript 滑块

> ID：13240787
> 
> 赞同：0
> 
> 时间：2012-11-05T21:36:13.033
> 
> 标签：javascript, jquery, slider, carousel, jquery-slider

我有一个简单的问题，我似乎无法弄清楚。我正在处理的网站中有一个 JavaScript[滑块](http://www.jackedpack.com/)。您需要手动单击此滑块中的下一个图像。我想让滑块自动滚动图像。这是代码，下面是我尝试过的代码：

```
//Carousel interaction
(function() {
    if (document.getElementById('carousel-nav')) {
        var slides = document.getElementById('carousel-images'),
            slidesItems = slides.getElementsByTagName('li'),
            nav = document.getElementById('carousel-nav'),
            navItems = nav.getElementsByTagName('li'),
            current = 0;

        function showSlide(i) {
            if (i != current && slidesItems[i]) {
                slide = slidesItems[i];
                slide.className += ' show';
                setTimeout (function() {
                    slide.className = slide.className.replace('show', 'appear');                    
                }, 1);
                setTimeout(function() {
                    slidesItems[current].className = slidesItems[current].className.replace('current', '');
                    slide.className = slide.className.replace('appear', 'current');
                    current = i;
                }, 300);
                navItems[i+1].className += ' current';
                navItems[current+1].className = navItems[current+1].className.replace('current', '');
                if (i == 0) {
                    if (navItems[0].className.indexOf('disabled') == -1) {
                        navItems[0].className += ' disabled';
                    }
                } else {
                    navItems[0].className = navItems[0].className.replace(' disabled', '');
                }
                var l = navItems.length - 1;
                if (i == slidesItems.length - 1) {
                    if (navItems[l].className.indexOf('disabled') == -1) {
                        navItems[l].className += ' disabled';
                    }
                } else {
                    navItems[l].className = navItems[l].className.replace(' disabled', '');
                }
            }
        }   

        nav.onclick = function(e) {
            e = e || window.event; e = e.target || e.srcElement;
            e = getParentByTagName(e, 'A');
            if (e) {
                var action = e.getAttribute('data-action');
                if (action == 'prev') {
                    showSlide(current - 1);
                } else if (action == 'next') {
                    showSlide(current + 1);
                } else {
                    showSlide(parseInt(action));
                }
            }
            return false;
        }
    }
})(); 
```

我尝试添加`setInterval(current+1, 10000);`到代码的底部块：

```
nav.onclick = function(e) {
        e = e || window.event; e = e.target || e.srcElement;
        e = getParentByTagName(e, 'A');
        if (e) {
            var action = e.getAttribute('data-action');
            if (action == 'prev') {
                showSlide(current - 1);
            } else if (action == 'next') {
                showSlide(current + 1);
            } else {
                showSlide(parseInt(action));
            }
        }
        return false;
    }

    setInterval(current+1, 10000);
}
})(); 
```

我对 JavaScript 真的很陌生，无法弄清楚我做错了什么。我真的很感激任何帮助！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:50:58.730

您不能将值传递给 setInterval，您必须传递一个函数才能执行。试试这个：

```
setInterval('showSlide(current + 1);', 10000); 
```

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T05:42:50.040

另一个答案很接近，真的帮助我解决了这个问题。唯一的问题是语法有点偏离。

```
setInterval(function() {
            showSlide(current + 1)
        },5000); 
```

以上是最终对我有用的。所以这就是它在上面的代码中的样子：

```
nav.onclick = function(e) {
        e = e || window.event; e = e.target || e.srcElement;
        e = getParentByTagName(e, 'A');
        if (e) {
            var action = e.getAttribute('data-action');
            if (action == 'prev') {
                showSlide(current - 1);
            } else if (action == 'next') {
                showSlide(current + 1);
            } else {
                showSlide(parseInt(action));
            }
        }
        return false;
    }

}
    setInterval(function() { showSlide(current + 1) }, 5000);
})(); 
```

下一步是弄清楚如何让滑块在到达最后一张幻灯片后重复回到第一张幻灯片。

再次感谢安德里亚的帮助！

# dynamic-programming - USACO - 动态规划 - 最大递减子序列

> ID：13240789
> 
> 赞同：2
> 
> 时间：2012-11-05T21:36:16.560
> 
> 标签：dynamic-programming, lds

我对 USACO Training 的 TEXT Dynamic Programming 部分中关于经典问题（查找最大递减子序列）的代码感到困惑。这是[文章链接](http://www.dcc.fc.up.pt/~pribeiro/estagio2008/usaco/2_2_Dynamic_Programming.htm)。请帮我搞定！

这是代码：

```
 1  #include <stdio.h>
 2  #define MAXN 200000
 3  main () {
 4      FILE *in, *out;
 5      long num[MAXN], bestrun[MAXN];
 6      long n, i, j, highestrun = 0;
 7      in = fopen ("input.txt", "r");
 8      out = fopen ("output.txt", "w");
 9      fscanf(in, "%ld", &n);
10      for (i = 0; i < n; i++) fscanf(in, "%ld", &num[i]);
11      bestrun[0] = num[n-1];
12      highestrun = 1;
13      for (i = n-1-1; i >= 0; i--) {
14          if (num[i] < bestrun[0]) {
15            bestrun[0] = num[i];
16            continue;
17        }
18        for (j = highestrun - 1; j >= 0; j--) {
19            if (num[i] > bestrun[j]) {
20                if (j == highestrun - 1 || num[i] < bestrun[j+1]){
21                    bestrun[++j] = num[i];
22                    if (j == highestrun) highestrun++;
23                    break;
24                }
25            }
26        }
27      }
28      printf("best is %d\n", highestrun);
29      exit(0);
30  } 
```

我有3个问题：

1) 第 14-17 行到底是做什么的？例如对于序列 10, 2, 8, 9, 4, 6, 3 ，该代码的结果是 4 但它的子序列是 10, 8, 4, 2 是错误的，因为原始序列中的元素 2 是在 8 和 4 之前，但在结果子序列中是在 8 和 4 之后！

2）考虑序列5,10,8,9,4,6,3。根据上面的代码，最大递减子序列的长度是4，这个子序列是10,5,4,3。但是在这个子序列中相反原始序列 5 在 10 之后。

3）是否有必要检查`num[i] < bestrun[j+1]`内循环中的条件？我认为它以前满足`num[i] > bestrun[j]`条件。

我在等你有用的答案。
谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T03:07:54.920

1)`bestrun[i]`跟踪长度为 i + 1 的最长递减子序列的开始的最小整数。因此，如果遇到小于当前的值，则`bestrun[0]`需要更改`bestrun[0]`为该值，因为那将是长度为 1 的最小递减子序列。

2）我不太确定你在问什么。如果您想知道翻转序列时会发生什么，那么您可以运行最长递增子序列算法来获得相同的结果。

3）是的，这似乎是多余的，`bestrun`应该是不增加的。事实上，最长递增/递减子序列的一些实现利用这一事实通过进行二分搜索以`j`找到`num[i]`大于`bestrun[j]`.

# css - CSS 定位。（包括示例）

> ID：13240794
> 
> 赞同：0
> 
> 时间：2012-11-05T21:36:41.350
> 
> 标签：css

我的 css 代码可以在这里找到： [http ://cssdesk.com/KGUfn](http://cssdesk.com/KGUfn)

我试图让底部的框（icon1、icon2 和 icon3）彼此相邻并将它们居中，但它不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:40:47.947

Icon3 需要打开单位，`right:`而您有一个错字“背景颜色：黄色；”

```
#icon-3
    {
        position:absolute;
        bottom:0;
        right:300px;
        width:133px;
        height:152px;
        background-color: yellow;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:40:48.757

您当前定位`#icon-1`为`position: absolute; left: 0; bottom: 0;``#icon-2``position: absolute; right: 0; bottom: 0;`

要获得您所描述的效果，请尝试使用：

```
#icon-1, #icon-2, #icon-3 {
    position: absolute;
    bottom: 0;
}
#icon-1 { left: 50%; margin-left: -200px; }
#icon-2 { left: 50%; margin-left: -67px; }
#icon-3 { left: 50%; margin-left: 67px; } 
```

因为`133px`每个元素都有 3 个宽度元素，所以总共有 3 个`399px`宽度（基本上是`200px`）。因此，如果您从`50%`父元素中的位置开始（`left: 50%`在每个项目上），然后使用边距偏移每个位置 - 您将获得您所追求的布局。

的`#icon-1`设置`margin-left: -200px`占`#icon-1`的整个宽度，加上 的一半宽度`#icon-2`。`#icon-2`的偏移量`-67px`将其左边缘设置为距中心左侧其自身宽度一半的距离（使其居中）。`#icon-3`的偏移量`67px`只是将其向右移动等于宽度的一半的量`#icon-2`- 使它们不重叠。

例如，这里是对原始代码的更新： http: [//cssdesk.com/cXrsP](http://cssdesk.com/cXrsP)

另外 - 你的原件`#icon-3`没有出现，因为你的 css 说`ackground-color: yellow`而不是**`b`**`ackground-color: yellow`

# drupal - 放置多个节点并将它们格式化在另一个节点中

> ID：13240800
> 
> 赞同：1
> 
> 时间：2012-11-05T21:37:08.560
> 
> 标签：drupal, drupal-7, drupal-views

我有一种名为“文档”的节点。每个人都有一个文件，我已经把一个分类法放在文件的语言上。

现在我想创建一个视图（页面），向我展示不同语言的所有文档。

我要制作的输出示例：

Important-document.doc [英文下载] [法文下载] [瑞典文下载]

我该怎么做？做一种名为“文档容器”的新型节点或允许在“文档”节点类型中多次上传？？？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:08:56.550

我不会使用显示语言的分类术语，而是将不同的字段添加到由文档上传组成的文档内容类型。这样，每个文档节点都会附加多个文档，每个附件都是不同的语言。

使用视图将每个节点输出为一行，并将下载链接添加为字段。

如果您需要任何帮助，请告诉我。

# php - 在给定时间段后禁用 mysql 上的编辑

> ID：13240804
> 
> 赞同：2
> 
> 时间：2012-11-05T21:37:26.220
> 
> 标签：php, mysql

我使用 phprunner 开发了一个数据捕获表单，数据在 mysql 数据库上更新。

由于输入时的拼写错误，我只允许用户编辑自己的数据，并进一步将其限制为一个字段（自由文本和容易出错的字段）。

是否可以在给定时间段（例如 1 天）后锁定记录。
这里的目标是为用户“编辑”能力设置一种到期时间，因此从存储记录中提取的历史报告总是相同的。

如果是这样，如何实现？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:46:17.723

简单的方法是首先检查记录是否可以编辑。例如，当您构建编辑表单时，检查该记录是多久之前创建的。如果大于 1 天，则输出“抱歉，已禁用编辑”而不是表单。

如果您有相对聪明的用户可以伪造表单并提交数据，那么您还可以在 sql`update`级别进行过滤以禁止更改：

```
UPDATE yourtable
SET ...
WHERE (id = $id) AND ((record_created + interval 1 day) > now()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:40:17.637

您可以在表中设置一个日期输入列（使用 NOW() 表示当前时间）并在用户尝试更新他们的帖子时检查它。使用[date_add() 或 date_sub()](http://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_date-add)计算时间差。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:43:07.030

创建一个日期创建列，然后检查该日期与今天日期之间的日期差异。如果它大于一，那么您可以使用 php 或其他方式锁定它：

```
if ($timeDiff greater than a day){
    disable edit button
else
    enable edit button
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T21:57:25.940

这只会阻止数据库被更新，但不会隐藏用户“更新/提交”按钮

```
 UPDATE table
    SET  ...
 where last_update < date_sub(now(), interval 1 day)
      And id = $id 
```

要向用户隐藏按钮，您可以（在前端）

```
SELECT 
    id, 
    IF(last_update < date_sub(now(), interval 1 day), 1, 0) as show_update_button
    ..... 
```

# android - Android，如何在Widget中只使用一个MediaPlayer实例

> ID：13240806
> 
> 赞同：2
> 
> 时间：2012-11-05T21:37:26.480
> 
> 标签：android, widget, media-player

再会

我有一个小部件，我想使用我的小部件播放和停止 mp3 文件。我可以播放 mp3 文件，但我不能停止 :(

关键时刻 - 它是小部件！我的问题的原因 - 我不知道如何只使用一个媒体播放器实例

你有什么想法？

这是我的代码

```
 public class MyWidget extends AppWidgetProvider {

  public static String ACTION_WIDGET_RECEIVER = "ActionReceiverWidget";
  @Override
  public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
       RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget);
       Intent active = new Intent(context, HappyBabyWidget.class);
       active.setAction(ACTION_WIDGET_RECEIVER);
       PendingIntent actionPendingIntent = PendingIntent.getBroadcast(context, 0, active, 0);
       remoteViews.setOnClickPendingIntent(R.id.ButtonPlay, actionPendingIntent);
       appWidgetManager.updateAppWidget(appWidgetIds, remoteViews);
  }

  @Override
  public void onReceive(Context context, Intent intent)
  {
      MediaPlayer mp = MediaPlayer.create(context.getApplicationContext(), R.raw.MyMusic);
      final String action = intent.getAction();

      if (ACTION_WIDGET_RECEIVER.equals(action)) {
           if (mp.isPlaying())
               mp.stop(); 
            else
                mp.start();

       }
      super.onReceive(context, intent);
 } 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:52:34.353

只需不要`MediaPlayer`在方法中本地声明您的方法，并且仅在它还不是 null 时才对其进行初始化：

```
 public class MyWidget extends AppWidgetProvider {

  public static String ACTION_WIDGET_RECEIVER = "ActionReceiverWidget";
  private MediaPlayer mp;

  @Override
  public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
       RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget);
       Intent active = new Intent(context, HappyBabyWidget.class);
       active.setAction(ACTION_WIDGET_RECEIVER);
       PendingIntent actionPendingIntent = PendingIntent.getBroadcast(context, 0, active, 0);
       remoteViews.setOnClickPendingIntent(R.id.ButtonPlay, actionPendingIntent);
       appWidgetManager.updateAppWidget(appWidgetIds, remoteViews);
  }

  @Override
  public void onReceive(Context context, Intent intent)
  {
      if (mp == null)
          mp = MediaPlayer.create(context.getApplicationContext(), R.raw.MyMusic);
      final String action = intent.getAction();

      if (ACTION_WIDGET_RECEIVER.equals(action)) {
           if (mp.isPlaying())
               mp.stop(); 
            else
                mp.start();

       }
      super.onReceive(context, intent);
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:48:59.677

要么将 MediaPlayer 变量设为静态，要么从[服务](http://developer.android.com/reference/android/app/Service.html)播放 mp3 。后者似乎是更好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T06:59:23.113

非常感谢 ！这是我的最终代码

```
private static MediaPlayer mp;

@Override
  public void onReceive(Context context, Intent intent)
  {
      if (mp == null)
          mp = MediaPlayer.create(context.getApplicationContext(), R.raw.MyMusic);

      final String action = intent.getAction();

      if (ACTION_WIDGET_RECEIVER.equals(action)) {
           if (mp.isPlaying())
           {
               mp.stop();
               mp.release();
               mp = MediaPlayer.create(context.getApplicationContext(), R.raw.MyMusic);

           }
            else
                mp.start();

       }
      super.onReceive(context, intent);
 }
}
          super.onReceive(context, intent);
     } 
```

# mongodb - MongoDB：Map Reduce 和 REST-Api（Sleepy mongoose）

> ID：13240808
> 
> 赞同：1
> 
> 时间：2012-11-05T21:37:31.503
> 
> 标签：mongodb, rest, mapreduce

我目前正在尝试在 MongoDB 集合上使用 REST-Api (Sleepy Mongoose) 执行 MapReduce 操作。不幸的是，我还没有成功。

我的地图功能是：

```
function() {
    emit( this.id, {count: 1} );
 } 
```

我的减少功能是：

```
function(key, values) {
    var result = {count: 0};
    values.forEach(function(value) {
      result.count += value.count;
    });
    return result;
  } 
```

我试过这样请求 Sleepy Mongoose：

```
curl --data 'cmd={"mapreduce" : {"ns":MyCollection, $map="the code of my map function", $reduce="the code of my reduce function", $out="{inline:1}"}}' http://localhost:27080/myDB/_cmd 
```

不幸的是，我收到“无法解析 JSON”错误。
我想我没有正确定义不同的参数。

有人用 Sleepy Mongoose 成功地进行了 MapReduce 操作吗？

我将非常感谢任何帮助/示例！

# c++ - 对 Project Euler 的尝试在第 16 位之后失败。

> ID：13240818
> 
> 赞同：0
> 
> 时间：2012-11-05T21:38:27.917
> 
> 标签：c++, optimization

求 2^1000 的数字之和

使用函数，用户输入基数和指数，例如 4^5（基数 4，指数 5）。

如果比较向量中输出的值和数字，则从第 16 位开始失败。

我的尝试：

```
#include<iostream>
#include<cmath>
#include<vector>
using namespace std; 

double Integer() {
    double m,o;  
    double n; 

    cout<<"Enter Base: ";
    cin>>m; 
    cout<<"Enter Exponent: ";
    cin>>o; 

    n= pow(m,o);

    cout.precision(302); 

    cout << "The Answer is: " << n << endl; 

    return n;
}

void SumoftheDigits(double n) { 

    double x, q, w=0, r, d;
    int length = r = (log(n)/ log(10)) + 1;

    vector<double> v1;

    modf((n/pow(10,r)),&x);

    while (r != 0) {

        q = modf( (n/pow(10,r-1)), &x);
        n -= x*pow(10,r-1);

        r--;
        d = x;

        v1.push_back(d);

    }

    for(vector<double>::iterator it = v1.begin(); it != v1.end(); ++it){
            cout << *it << " ";
    } 

    cout << endl; 

    int i;
    long long int Sum = 0; 

    while (i != v1.size()) {
        Sum += v1[i]; 
        i++;
    } 

    cout << "The Sum of the Digits is: " << Sum << endl; 

} 

int main() {

    double n = Integer(); 

    SumoftheDigits(n); 

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:46:26.773

浮点类型（例如`float`和`double`）的精度有限，因此您不能使用它们来计算大数，例如 2^1000 左右的值。如您所见，会有不准确之处。

您将需要使用整数方法来执行此操作。普通整数不能表示2^1000这么大的数字，所以需要多做一些工作。例如，您可以在一个数组中分别表示每个数字，并像在学校学习的那样实现长乘法。

还有诸如 GMP 之类的库可以表示非常大的整数（仅受计算机内存限制），这将使这项任务变得容易。

# osgi - 在 OSGi 包中使用 JavaFX 2.2

> ID：13240822
> 
> 赞同：7
> 
> 时间：2012-11-05T21:38:38.637
> 
> 标签：osgi, javafx-2, apache-felix

如何在 OSGi 包中使用 JavaFX 2.2？我正在使用 Apache Felix，所以它不是 eclispe 项目。它必须在安装了 Java7 的 Mac OSX 上运行（Java6 会很酷但不是必需的）。

我已经阅读了一些关于重新打包 jfx 库的内容，但对于 eclispe 插件项目。

仅在 bundle Manifest 中导入 javafx 包就创建了缺少需求 osgi.wiring.package 异常。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-17T21:39:57.973

可能有点晚了，但我想记录一种在 OSGi 环境中启用 JavaFX 的简单方法，以防像我这样的任何人仍然无法做到这一点......

问题是，您需要允许 JavaFX 有可能加载和使用它想要的任何类（JavaFX 使用 JRE 的内部结构，这使得它很难捆绑），所以您真正想要的是让它访问 OSGi提升类路径...

我不是专家，但在这篇博客中，来自 SpringSource 的 Costin Leau 以 3 种不同的方式解释了如何做到这一点（对于假定完全访问系统类加载器的任何 jar，而不仅仅是 JavaFX）：

[http://blog.springsource.org/2009/01/19/exposing-the-boot-classpath-in-osgi/](http://blog.springsource.org/2009/01/19/exposing-the-boot-classpath-in-osgi/)

我选择使用选项 A，这基本上意味着在 OSGi 容器的配置文件中设置 OSGi 指定的属性（不特定于任何实现！）：

> **org.osgi.framework.system.packages.extra** =javafx.application;version=0.0.0 ...

您可以在我创建的这个 Gist 中看到该属性的全部价值：

[https://gist.github.com/renatoathaydes/5021107](https://gist.github.com/renatoathaydes/5021107)

我基本上将它设置为 JavaFX 2.2 jar 可以导出的所有包（我通过简单地将 JavaFX jar 放入我的 Apache Karaf 的部署文件夹中发现了这一点，它会自动将其打包成一个包，然后查看生成的清单）...顺便说一句，我尝试使用由 Karaf 生成的包（它使用 pax-wrap 来执行此操作），但是由于 JavaFX 尝试加载您的类的方式（这是不可见的），这将不起作用在尝试的 JavaFX 包中，更不用说 JavaFX 尝试访问的所有 JRE 包）。

我怀疑并不是我添加的所有软件包实际上都是必需的，但为了安全起见，我将它们全部保留为由 Karaf 的包装器生成的，并且由于它有效，除非有充分的理由，否则我不会更改它。

现在，只要 JRE lib 文件夹中存在 jfxrt.jar，我的任何包都可以使用 JavaFX。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-05T23:28:11.857

尝试使用 e(fx)clipse 运行时工具，其中包括允许 JavaFX 在 OSGi 环境中正常工作的库。

根据[e(fx)clipse 网站](http://efxclipse.org/#about-runtime)：

> 不幸的是，JavaFX 不是用 OSGi 编写的，所以在 OSGi 中运行时有很多地方会导致问题，从 JavaFX-Binaries 位于用户系统的某处，到由于 OSGi 的可见性规则而导致的类加载问题. e(fx)clipse 提供了帮助库来处理所有这些问题，并使在 Eclipse Equinox 上编写 JavaFX 应用程序就像使用 SWT 和 Swing 一样容易

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-13T14:58:09.510

不是与 JavaFX 捆绑在一起，而是将 javafx 类添加到引导类加载器中会起作用。Apache Felix 示例：

```
Map<String,String> properties = new HashMap<String, String>();
properties.put(Constants.FRAMEWORK_BOOTDELEGATION, "javafx.*,com.sun.javafx.*");
properties.put(Constants.FRAMEWORK_BUNDLE_PARENT, Constants.FRAMEWORK_BUNDLE_PARENT_APP);

FrameworkFactory factory = new org.apache.felix.framework.FrameworkFactory();
org.osgi.framework.launch.Framework framework = factory.newFramework(properties);
framework.init(); 
```

现在只需使用任何包中的 javafx 类（如果客户端计算机上安装了 JavaFX）。

# ruby - 从 Ruby 中的数组末尾删除 nil 项

> ID：13240823
> 
> 赞同：6
> 
> 时间：2012-11-05T21:38:39.820
> 
> 标签：ruby

给定一个数组，如：

```
[1, 2, nil, nil, 3, nil, 4, 5, 6, nil, nil, nil] 
```

id 喜欢`nil`从数组末尾删除 's。用一些丑陋的循环来解决并不难，但我希望有一种 Ruby 方法可以做到这一点。

```
Result: [1, 2, nil, nil, 3, nil, 4, 5, 6] 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-05T23:57:41.027

这个怎么样：

```
a.pop until a.last 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-05T21:43:27.450

不知道为什么你会想要 nil 介于两者之间，但我离题了！

```
array = [1, 2, nil, nil, 3, nil, 4, 5, 6, nil, nil, nil]
array.reverse.drop_while {|i| i == nil}.reverse 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-05T21:45:19.570

```
foo = [1, 2, nil, nil, 3, nil, 4, 5, 6, nil, nil, nil]
foo.reverse.drop_while(&:nil?).reverse
# [1, 2, nil, nil, 3, nil, 4, 5, 6] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-05T21:42:00.623

这是给你的单线：）

```
a =  [1, 2, nil, nil, 3, nil, 4, 5, 6, nil, nil, nil] 

a[0..a.rindex{|el| !el.nil?}] # => [1, 2, nil, nil, 3, nil, 4, 5, 6] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-05T21:41:55.320

```
while(!(a = ar.pop)){}; ar.push a 
```

仍然是一个丑陋的循环，但也许不那么丑陋？

# android - Android - 如何防止键盘按下时显示以前的视图？

> ID：13240827
> 
> 赞同：0
> 
> 时间：2012-11-05T21:38:44.217
> 
> 标签：android, android-ui

这真的让我的观点很难看。我希望有人有解决方案。

我的活动 A 导航到 B。在活动 BI 中有几个文本字段。用户可以在编辑后按 BACK 隐藏键盘。但似乎键盘总是走得太快。当它下降时，我可以看到前一个视图的一部分（A 的视图）。然后 B 的视图覆盖了它。

如何减慢关闭键盘的速度或让 B 的视野更快下降？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T01:12:55.740

如果活动的窗口没有背景，则可能会发生这种情况。意思是，主题具有属性 windowBackground="@null"。

要删除或设置背景，您可以选择一个为窗口设置了背景的主题（不是“@null”），或者通过调用 getWindow().setBackground() 在 onCreate() 方法上以编程方式定义它

有关此设置的更多信息[http://android-developers.blogspot.co.il/2009/03/window-backgrounds-ui-speed.html](http://android-developers.blogspot.co.il/2009/03/window-backgrounds-ui-speed.html)

# sql - 无法组合 3 个不同的 SQL 表项并获得总和

> ID：13240833
> 
> 赞同：6
> 
> 时间：2012-11-05T21:39:25.690
> 
> 标签：sql, asp-classic

我父亲在他的公司用于报告的系统有问题。我没有建造它，但我正在尽我最大的努力将它包裹起来。它是 ASP，我不太熟悉它（或者为此编写 sql）。

基本上，我正在使用三个表：Item、ItemHistory 和 Devices。在这些表格中，我想做的是

*   通过“项目历史”表中的“序列号”列获取用户处理过的项目
*   将该序列号与“项目”表中的“序列号”列进行比较以获取设备类型（来自设备列）
*   使用设备类型从“设备”表中的“点”列中获取预定数值
*   存储该值并将其添加到查询拉回的任何其他值，然后显示总数。

**见更新**

如您所见，如果将设备类型包含在 ItemHistory 表中会容易得多，但事实并非如此。我已经尝试加入表格，但不断收到错误（这是由于我缺乏知识，我相当确定）。查询是按日期范围和用户（来自 ItemHistory 表），但我想我已经弄清楚了。我只是无法让它引用所有表格并将“点”加在一起。

任何帮助是极大的赞赏！如果您需要更多信息，请告诉我。先感谢您。

* * *

更新

所以基本上我现在遇到的问题是查询不断返回“BOF 或 EOF 为真，或者当前记录已被删除。请求的操作需要当前记录。” 我认为这是造成的，因为它只是在点列中添加数字。

我认为我最后一个问题的问题在于，我让每个设备看起来都有“点”，但实际上有一定数量的设备（比如说五个），并且可能有多个序列号都指向一个设备. 我认为这是查询遇到麻烦的地方（但我可能是错的）。此外，我的 sql 语句看起来非常像下面发布的一个 littlebobbytables，除了添加了我自己的变量。

这是数据库的样子。

项目历史表

> ```
> Date      | SerialNumber |  DeviceType | User
> ----------|--------------|-------------|-------
> 11/1/12   | 123-456-789  |     NULL    | Bill
> 11/1/12   | 456-123-987  |     NULL    | Bill
> 11/1/12   | 987-654-321  |     NULL    | Bill
> 11/1/12   | 216-897-631  |     NULL    | Bill
> 11/1/12   | 874-547-277  |     NULL    | Bill 
> ```

项目表

> ```
>  SerialNumber |  DeviceType
>   -------------|-------------
>   123-456-789  |  Device1
>   456-123-987  |  Device2
>   987-654-321  |  Device3
>   216-897-631  |  Device1
>   874-547-277  |  Device2 
> ```

设备表

> ```
>  Device   |  Points
>  ----------|----------
>   Device1  |    20
>   Device2  |    25
>   Device3  |    40 
> ```

我希望输出是

> ```
>  User   |  Points
>  --------|----------
>   Bill   |    130 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:42:48.147

您可以将积分相加，并按用户 ID 分组：

```
SELECT [User], SUM(Points) AS Points
FROM ItemHistory IH
INNER JOIN Item I ON IH.SerialNumber = I.SerialNumber
INNER JOIN Devices D ON I.DeviceType = D.Device
WHERE IH.[Date] = @YourDateVariable
GROUP BY [User] 
```

# internet-explorer - 有没有办法在 Metro IE10 中运行兼容模式（不是桌面模式）？

> ID：13240835
> 
> 赞同：0
> 
> 时间：2012-11-05T21:39:36.187
> 
> 标签：internet-explorer, windows-8

我正在尝试让 IE 10 的“Metro”版本在兼容模式下运行。我使用的 Web 应用程序是为 IE 9 和更早版本编写的，在 IE 10 中存在一些问题。

我已经能够在“桌面”IE 10 中以兼容模式运行应用程序，但应用程序的流动性不一样（使用平板电脑，所以我们只有触摸输入）。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:20:43.600

转到... 桌面 --> IE --> 工具 --> 兼容性视图设置 --> 选中“以兼容模式显示所有网站”。

此设置应用于桌面版 IE，也适用于平铺版（或 IE Metro）。

# javascript - 如何让 JSON 成功解析 XMLHttpRequest 字符串？

> ID：13240837
> 
> 赞同：0
> 
> 时间：2012-11-05T21:39:43.703
> 
> 标签：javascript, json, xml-parsing, xmlhttprequest

我正在使用 Goo.gl URL 缩短器来缩短链接。我 sed 它一个 Json 字符串，它返回这样的结果，这些结果存储在 xmlHttp.response 中：

```
"{
 "kind": "urlshortener#url",
 "id": "http://goo.gl/mR2d",
 "longUrl": "http://google.com/"
}" 
```

发送代码后，我尝试使用 JSON 解析它：

```
 xmlHttp.send(jsonStr);
 var short_url = JSON.parse(xmlHttp.response).id ; 
```

当此代码在函数中运行时，我收到以下“输入意外结束”错误：

```
getShortURL("http://google.com");
SyntaxError: Unexpected end of input
arguments: Array[0]
get message: function () { [native code] }
get stack: function () { [native code] }
set message: function () { [native code] }
set stack: function () { [native code] }
type: "unexpected_eos"
__proto__: Error 
```

我曾认为字符串中的引号可能存在​​一些问题。什么是解决问题的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T01:39:05.067

我想我意识到出了什么问题。代码尝试在 XMLHttpRequest 实际有任何信息之前从它获取信息。需要等到 xmlHttp.onreadystatechange 和 xmlHttp.readyState == 4 再取出缩短的 URL。然后可以发送到需要的地方。

（不习惯这些异步问题...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:23:02.240

请参阅[JSON：为什么要转义正斜杠？](https://stackoverflow.com/questions/1580647/json-why-are-forward-slashes-escaped)

我的猜测是，您使用的 JSON 解析器可能期望正斜杠被转义。看看这个输入是否被接受：

```
{
    "kind": "urlshortener#url",
    "id": "http:\/\/goo.gl\/mR2d",
    "longUrl": "http:\/\/google.com\/"
} 
```

# nginx - nginx反向代理多个后端

> ID：13240840
> 
> 赞同：40
> 
> 时间：2012-11-05T21:39:54.747
> 
> 标签：nginx

这是我的情况：我将有一台运行 nginx 的前端服务器，以及运行 apache + 乘客的多台后端服务器，并使用不同的 rails 应用程序。我不想做任何负载平衡。我需要做的是设置 nginx 以根据 url 代理到特定服务器的连接。IE，client.domain.com 应该指向 xxx100:80，client2.domain.com 应该指向 xxx101:80 等等。

我对 nginx 不是很熟悉，但是我在网上找不到适合我情况的特定配置。

谢谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-05T21:56:00.803

您可以将不同的 URL 与`server {}`块匹配，然后在每个服务器块内，您将拥有反向代理设置。

下面是一个插图；

```
server { 
  server_name client.domain.com;

  # app1 reverse proxy follow
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_pass http://x.x.x.100:80;

}

server { 
  server_name client2.domain.com;

  # app2 reverse proxy settings follow
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_pass http://x.x.x.101:80;
} 
```

此外，您可以根据需要在每个块中添加更多 Nginx 设置（例如`error_page`和）。`access_log``server {}`

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-07-06T12:01:04.473

@mohamnag 的评论是正确的。`proxy_pass`只允许在一个`location`

看：

[http://wiki.nginx.org/HttpProxyModule#proxy_pass](http://wiki.nginx.org/HttpProxyModule#proxy_pass)

[https://www.nginx.com/resources/admin-guide/reverse-proxy/](https://www.nginx.com/resources/admin-guide/reverse-proxy/)

所以正确的配置是

```
server { 
    server_name client.domain.com;

    location / {
        # app1 reverse proxy follow
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://x.x.x.100:80;
    }
}

server { 
    server_name client2.domain.com;

    location / {
        # app2 reverse proxy settings follow
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://x.x.x.101:80;
    }
} 
```

# java - Android App Widget，变量正在重启

> ID：13240853
> 
> 赞同：1
> 
> 时间：2012-11-05T21:40:50.893
> 
> 标签：java, android, service, widget

我一直在为应用程序开发一个小部件，但我一直遇到问题，如果我关闭应用程序，小部件会重新启动他的所有值并继续工作。如何保留小部件的值？如果我关闭我的应用程序，我正在使用服务来读取 XML 文件并将重新启动的变量的信息设置为默认值。我从小部件的 onUpdate 调用服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T21:51:59.660

使用`SharedPreferences`. 这些使您可以将设置和持久值保存到设备的存储中。

为此，您可以执行以下操作来加载设置：

```
SharedPreferences prefs = context.getSharedPreferences("SETTINGS", 0);
int x = prefs.getInt("x", 5); // Pulls an integer with key "x", defaulting to 5 if it's not set
String y = prefs.getString("y", null); // Pulls an string with key "y", defaulting to null if it's not set 
```

您可以像这样保存设置：

```
SharedPreferences prefs = context.getSharedPreferences("SETTINGS", 0);
Editor edit = prefs.edit();
edit.putInt("x", 27);
edit.putString("y", "Some string");
edit.commit(); 
```

*注意：我在`SETTINGS`这里调用了这些项目，但是您希望稍后再次加载的任何基本类型的数据都可以存储（`String`、`int`、`float`等）。*

您可能需要阅读有关[存储选项](http://developer.android.com/guide/topics/data/data-storage.html)和[`SharedPreferences`](http://developer.android.com/reference/android/content/SharedPreferences.html).

# c# - SCOPE_INDENTITY() 不起作用是返回 null 吗？

> ID：13240854
> 
> 赞同：1
> 
> 时间：2012-11-05T21:41:10.300
> 
> 标签：c#, .net, sql, c#-4.0, ado.net

在阅读了这个网站后，我认为以下代码将返回我添加到数据库中的项目的 ID，但我试图填充的 int 值没有显示在范围内。这是我的插入语句的代码：

```
 foreach (ExOb exc in exobject)
            {

                Type type = exc.GetType();
                //Add a weight exercise
                if (type == typeof(Weights))
                {

                    Weights thisweight = (Weights)exc;
                    string InsertWeight = ("INSERT INTO WeightExercise (ExcerciseName, Duration, Sets, DiaryId) VALUES (@name, @time, @sets, @DiaryId) SET @ID = SCOPE_IDENTITY();");

                        com = new SqlCommand(InsertWeight, con);
                        com.Parameters.AddWithValue("@name", thisweight.ExcerciseName);
                        com.Parameters.AddWithValue("@time", thisweight.WeightDuration);
                        com.Parameters.AddWithValue("@sets", thisweight.TotalSets);
                        com.Parameters.AddWithValue("@DiaryId", results[0]);
                        com.Parameters.Add("@ID", SqlDbType.Int, 4).Direction = ParameterDirection.Output;
                        con.Open();
                        com.ExecuteNonQuery();
                        int ID = (int)com.Parameters["@ID"].Value;

                        con.Close();

                }
                else if (type == typeof(Cardio))
                {
                    Cardio thiscardio = (Cardio)exc;

                }

            }
        } 
```

数据库已更新为体重锻炼详细信息。我在调试时检查过，命令参数@ID 包含最新条目的ID。调试时，Int ID 不会显示在本地，如果我观看它，我会得到：

```
 ID  The name 'ID' does not exist in the current context 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:47:42.650

`SCOPE_IDENTITY`返回插入到同一范围内的标识列中的最后一个标识值。您需要使用`ExecuteScalar`而不是`ExecuteNonQuery`检索它：

所以先把你的sql改成：

> "插入到 WeightExercise (ExcerciseName, Duration, Sets, DiaryId) VALUES (@name, @time, @sets, @DiaryId); SELECT SCOPE_IDENTITY();"

那么您可以通过这种方式检索 id：

```
ID = (int)com.ExecuteScalar(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:48:59.713

> 我在调试时检查过，命令参数@ID 包含最新条目的ID。

这表明您当前使用的数据库代码运行良好。

> 调试时，Int ID 不会出现在本地，如果我观看它，我会得到......

这是你问题的根源。问题是您已将 ID 范围限定在

```
if (type == typeof(Weights)) 
```

堵塞。在该块之外，标识符`ID`没有任何意义。

`ID`在此过程的范围顶部声明，您应该能够在 Locals 中看到它或添加一个 Watch。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T21:47:28.087

我假设该表有一个 Identity 列。

尝试这样做：

```
string InsertWeight = ("INSERT INTO WeightExercise 
(ExcerciseName, Duration, Sets, DiaryId) VALUES (@name, @time, @sets, @DiaryId); SELECT SCOPE_IDENTITY()"); 
```

然后代替`com.ExecuteNonQuery()`使用`int ID = (int) com.ExecuteScalar()`;

对于您的实际问题，请尝试在您的插入语句之后和 SET 之前放置一个分号。原因是因为你在同一个语句中。当 SCOPE_IDENTITY() 被调用时，还没有插入。您需要终止语句 ( `;`) 然后调用`SCOPE_IDENTITY();`

# iphone - 平移手势后的 UIWebView 滑动手势

> ID：13240856
> 
> 赞同：1
> 
> 时间：2012-11-05T21:41:22.143
> 
> 标签：iphone, ios, ipad

我正在开发一个 IOS 应用程序，该应用程序使用导航控制器来呈现包含来自网站的文章列表的表格视图。点击此表中的一个条目会触发转入包含 UIWebView 的视图，该视图显示本文的网页。

现在，在 Web 视图中，我为向右滑动手势添加了手势识别器。这个手势触发了一个从导航控制器的堆栈中弹出当前视图的方法，因此允许用户使用这个手势导航回文章列表。但是，我遇到的问题是，如果放大网页（以便用户必须向左/向右滚动才能查看所有页面内容），UIWebView 的平移手势会覆盖我的滑动手势。

我已经阅读了很多关于如何处理这个问题的不同想法，但它们似乎都没有达到我想要的效果。我来的壁橱是通过实现 UIGestureRecognitionDelegate 协议并将以下内容添加到我的代码中：

```
- (BOOL)gestureRecognizer:(UIPanGestureRecognizer *)paner shouldRecognizeSimultaneouslyWithGestureRecognizer:(UISwipeGestureRecognizer *)swiper
{
    return YES;
} 
```

这确实允许平移手势和滑动手势，但正如方法名称所暗示的那样，它们同时发生。这意味着用户无法向右平移，因为它也会将此识别为滑动手势并因此将它们返回到文章列表。

所以，我的问题是，允许平移手势和滑动手势的最佳方式是什么？任何帮助深表感谢！

# scala - 在 Akka 中，我可以欺骗来自不同参与者的消息吗？

> ID：13240861
> 
> 赞同：6
> 
> 时间：2012-11-05T21:41:36.817
> 
> 标签：scala, akka

我正在使用 Akka 来控制对正在运行的系统进程的访问。

我有一个 CommandActor 来处理来自系统中任何 Actor 的传入命令请求（我们将其称为 RequestActor），并且对于每个新请求，CommandActor 都会生成一个单独的 CmdChildWorker Actor 来处理该特定请求。CommandActor 还限制了 CmdChildWorkers 的数量，并为每个请求分配一个唯一的 id，因此它比简单的路由器更复杂。

当命令完成时，并且在系统进程执行期间周期性地，CmdChildWorker Actor 将周期性更新发送回原始 RequestActor（例如到目前为止的进程输出）。

然而，为了保持简洁的设计，我希望能够将 CmdChildWorker 完全隐藏在原始 RequestActor 之外，它的唯一接口是单个 CommandActor。

显然，我可以通过 CommandActor 从 CmdChildWorker 发回任何回复消息，但我想知道是否可以直接从 CmdChildWorker 回复 RequestActor 而无需通过 CommandActor 路由消息，但仍然假装消息已从 CommandActor 发回。

即，我想将 CmdChildWorker 演员的发件人地址伪装成其父演员的地址。这可能吗？也许更重要的是，这是明智的，还是好的演员设计？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-05T22:04:58.277

参见`tell`actor上的方法。当 CommandActor 转发它的消息时，调用：

`childActor.tell(msg, sender)`

并且 childActor 将其发送者作为原始发送者。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T15:19:23.780

如果我正确理解您的要求，您应该使用 forward。从文档：

您可以将消息从一个参与者转发给另一个参与者。这意味着即使消息正在通过“中介”，原始发件人地址/参考也会被保留。这在编写充当路由器、负载平衡器、复制器等的actor时很有用。

> myActor.forward（消息）

# llvm - 我可以从符号创建一个常量并将其用作数组初始值设定项吗？

> ID：13240864
> 
> 赞同：1
> 
> 时间：2012-11-05T21:41:41.433
> 
> 标签：llvm, llvm-c++-api

基本上我想为以下 C 代码创建数据 IR：

```
extern int myarr1[];
int myarr2 = {(int)&myarr1, 0, 0}; 
```

所以我`llvm::GlobalVariable`为`myarr1`. 但是`llvm`断言并说它不能用作初始化程序。

> 数组元素初始值设定项中的类型错误

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T01:14:51.890

得到了答案：

llvm::Constant *cons = ConstantExpr::getCast(Instruction::PtrToInt, gvar_array_myarr1, IntegerType::get(mod->getContext(), 32));

谢谢！

# javascript - JavaScript 堆大小和 Chrome 增加

> ID：13240866
> 
> 赞同：6
> 
> 时间：2012-11-05T21:41:49.033
> 
> 标签：javascript, ajax, performance, google-chrome, heap-memory

我有一个全是 JavaScript 的网页应用程序。我注意到每个返回新视图的 AJAX 调用的 JavaScript 堆大小都会增加。我应该做些什么来清理旧视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T19:26:43.533

我建议您查看以下资源。您可以了解如何检查浏览器时间线以检测泄漏引用和性能问题。

第一个来自 Chrome 开发者今年在 Google IO 上的讲话：

[http://www.youtube.com/watch?v=3pxf3Ju2row](http://www.youtube.com/watch?v=3pxf3Ju2row)

第二个来自 Paul Irish 在第 2 集的断点处谈话：

[http://www.youtube.com/watch?v=PPXeWjWp-8Y](http://www.youtube.com/watch?v=PPXeWjWp-8Y)

相信你会找到很多线索的！！无论如何...如果您在 jsfiddle.net 上分享您的代码测试用例，我们可以看看 :)

# android - 使用 Android IP Camera (python) 在 openCv 中直播

> ID：13240868
> 
> 赞同：0
> 
> 时间：2012-11-05T21:41:58.820
> 
> 标签：android, python, opencv, stream

我想使用 Android IP Camera 在 openCv 中进行直播，我一直在尝试使用此代码，但它不起作用。我应该在这段代码中改变什么？

```
camera=cv.CaptureFromFile("http://192.168.0.10:8080/videofeed")
while True :
  img =cv.QueryFrame(camera)
  cv.ShowImage('Video',img)
  if cv.WaitKey(0):
    break   
cv.ReleaseCapture(camera) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-28T14:24:19.307

```
import cv2
import numpy as np
import urllib

url = 'http://192.168.1.183:8080/shot.jpg'

while True:
    imgResp = urllib.urlopen(url)
    img = np.array(bytearray(imgResp.read()), dtype=np.uint8)
    img1 = cv2.imdecode(img, -1)
    #hsv = cv2.cvtColor(img1, cv2.COLOR_BGR2HSV)
    #lower_red = np.array([30,150,50])
    #upper_red = np.array([255,255,180])
    #mask = cv2.inRange(hsv, lower_red, upper_red)
    #res = cv2.bitwise_and(img1, img1, mask=mask)

    cv2.imshow('img',img1)
    cv2.waitKey(10) 
```

# jquery - 随机的 加载时显示 w/jQuery 不工作

> ID：13240870
> 
> 赞同：1
> 
> 时间：2012-11-05T21:42:09.663
> 
> 标签：jquery

我使用我在[这个线程上找到的一些关于随机 div](https://stackoverflow.com/questions/4205166/showing-random-divs-using-jquery)的代码来创建一组 3 个 Facebook Like 按钮，这些按钮应该在页面加载时随机显示。

问题是，它[在 jFiddle 中运行良好，](http://jsfiddle.net/devinkoncar/RJMhT/1060/)但每当我将它投入生产时就完全失败了。

我从 Nick Craver 那里借用了这段代码并做了一些非常基本的修改，基本上只是将类名从“Image”更改为“facebookLike”：

HTML：

```
<div class="facebookLike">
    <iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2Fcsuvolleyball&amp;send=false&amp;layout=button_count&amp;width=80&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=150920871613500" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:80px; height:21px;" allowTransparency="true"></iframe>
</div>
<div class="facebookLike">
    <iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2Fcsurams&amp;send=false&amp;layout=button_count&amp;width=80&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=150920871613500" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:80px; height:21px;" allowTransparency="true"></iframe>
</div>
<div class="facebookLike">
    <iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2FCoachJimMcElwain&amp;send=false&amp;layout=button_count&amp;width=80&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=150920871613500" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:80px; height:21px;" allowTransparency="true"></iframe>
</div>​ 
```

jQuery代码：

```
var divs = $("div.facebookLike").get().sort(function() {
    return Math.round(Math.random()) - 0.5; //random so we get the right +/- combo
}).slice(0, 1)
$(divs).appendTo(divs[0].parentNode).show();​ 
```

这是该页面的链接：[http://www.csurams.com/test/facebook.html](http://www.csurams.com/test/facebook.html)如您所见，什么都没有发生。

我不知道问题是否与显示有关：无；样式规则或其他东西。但是，当我删除 display:none; 所有三个 div 都显示...

非常感谢任何帮助，现在我的头在我的桌子上敲了一段时间:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:48:10.390

由于只有 3 个元素，因此对其进行排序不会做太多事情。尝试做这样的事情：

```
var rand = $(".facebookLike").length-1 //need to -1 because :eq is zero indexed
$(".facebookLike:eq("+rand+")").show()
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:55:12.453

首先，你不应该使用 jQuery 1.3，现在是 1.8.2？

其次，你没有包装你的代码：

```
<script type="text/javascript">
    $(function() {
        var divs = $("div.Image").get().sort(function(){ 
            return Math.round(Math.random())-0.5;
        }).slice(0,1);
        $(divs).appendTo(divs[0].parentNode).show();â€‹
    });
</script> 
```

还要注意最后的奇怪字符，你必须删除它们，因为它们在你的代码中也是如此，当你从 jsFiddle 复制东西时，它们有时会像这样，我会将字符保留在那里以便你看到它们.

# wordpress - Wordpress - 如何在新帖子屏幕中添加文本区域和按钮？

> ID：13240871
> 
> 赞同：0
> 
> 时间：2012-11-05T21:42:19.110
> 
> 标签：wordpress

我想为我的 wordpress 网站写一个机器人。但我找不到那个问题的答案。如何将文本区域和按钮添加到我的 wordpress 新帖子页面？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T00:14:49.173

您需要在主题中编辑一个名为 index.php 的文件。循环之前或之后的任何地方（这样您就不会每次都创建新的文本框和按钮）。只需使用

```
<textarea>
    your text here.
</textarea>
<button>My Button</button> 
```

# r - 将数字连接到字符串输出，格式化每个数字以采用相同的字符宽度

> ID：13240879
> 
> 赞同：2
> 
> 时间：2012-11-05T21:43:01.707
> 
> 标签：r, concatenation, number-formatting, output-formatting

我有一个矢量图

```
a<-c(18.123412, 0, 1.5, 34.123, 2.1) 
```

我想从中创建一个字符串。

```
paste(round(a,3), collapse = " " ) 
```

一切都很好，但是我希望每个数字的输出都相同的问题，我的意思是以下。我现在有

```
"18.123 0 1.5 34.123 2.1" 
```

我需要

```
"18.123 0___ 1.5__ 34.123 2.1__" 
```

这里 _ 表示由于数字的位数较少，我们需要用空格替换它们。知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:49:47.137

使用`formatC`：

```
formatC(a, width=10, drop0trailing=TRUE)
[1] "     18.12" "         0" "       1.5" "     34.12" "       2.1" 
```

要`paste`输入单个字符串，请使用参数`collapse=""`：

```
paste0(formatC(a, width=10, drop0trailing=TRUE), collapse="")
[1] "     18.12         0       1.5     34.12       2.1" 
```

* * *

要左对齐，请使用参数`flag="-"`：

```
formatC(a, width=10, drop0trailing=TRUE, flag="-")
[1] "18.12     " "0         " "1.5       " "34.12     " "2.1       " 
```

* * *

`?formatC`请参阅`?prettyNum`或`?format`获取更多帮助和其他选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T21:51:49.710

如果您使用等宽字体打印，则添加正确数量的空格将解决此问题。

```
> paste(sprintf("%-8s", round(a, 3) ), collapse="")
#[1] "18.123  0       1.5     34.123  2.1     " 
```

如果这应该用于具有比例字体的绘图表达式中，您将需要其他策略。

# c# - StringComparision.Ordinal 更准确还是 IgnoreCase

> ID：13240880
> 
> 赞同：1
> 
> 时间：2012-11-05T21:43:02.227
> 
> 标签：c#, string

在也可以在非美国英语环境中使用的 WinForms 应用程序中，我有一个 String.Equals(strA, strB) 方法，但它失败了，因为我需要进行不区分大小写的比较，但默认情况下是大小写比较-敏感的。现在要解决此问题，您建议什么更好？

*   CurrentCultureIgnoreCase ?
*   StringComparision.Ordinal ?
*   StringComparision.OrdinalIgnoreCase ? *有更好的建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:46:32.950

使用`CurrentCultureIgnoreCase`. `Ordinal`比较不尊重文化使用的字母顺序。

但这当然取决于您要完成的工作。如果你想做一些忽略用户文化的事情，当然还有其他可能性，包括使用`InvariantCulture`.

**另外：**即使您没有排序/排序，而只是检查“相等”与“不相等”，和之间也可能存在`OrdinalIgnoreCase`差异`CurrentCultureIgnoreCase`。例如，对于一个序数比较，`"istanbul"`和`"Istanbul"`是否相等，取决于大小写。但是，在土耳其文化中，它们可能不等价，因为大写版本的`'i'`not `'I'`but `'İ'`。所以城市将是`"İstanbul"`。

# socket.io - 关于 socket.io 函数的问题

> ID：13240882
> 
> 赞同：1
> 
> 时间：2012-11-05T21:43:04.707
> 
> 标签：socket.io

socket.on 和 socket.emit 是什么意思？我似乎无法在 socket.io 网站上找到解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:55:05.570

`socket.on`监听特定关键字的套接字。类似于[JQuery](http://api.jquery.com/on/) `socket.emit`向该关键字“发送”一条消息

以下代码向“关键字”发送消息

```
socket.emit('keyword', 'Hello!'); 
```

以下代码侦听“关键字”上的消息

```
socket.on('keyword', function(res){
    console.log(res)//prints "Hello!"
    socket.emit('keyword', 'Got your message')
}) 
```

关键字可以是您想要的任何字符串。并且这两个代码片段都可以在客户端和服务器端使用。

# javascript - 使用 d3 中的选择框更改 json 数据值

> ID：13240885
> 
> 赞同：2
> 
> 时间：2012-11-05T21:43:12.720
> 
> 标签：javascript, d3.js

所以我试图通过我的选择中的值加载不同的数据，我将离开 choropleth 示例，我有以下内容

```
d3.json("data1.json", function (json) {
data = json;
counties.selectAll("path")    
.attr("class", quantize);        
 });

 d3.select("select").on("change", function () {
  //get value of select and replace data1.json above
    d3.selectAll("svg").json("path", this.value);

 }); 
```

但是，我就是无法加载不同的值。

# javascript - 如何使用angularjs动态添加内容

> ID：13240890
> 
> 赞同：1
> 
> 时间：2012-11-05T21:43:28.943
> 
> 标签：javascript, angularjs

我的页面上有两列。

左栏有添加按钮列表，右栏为空。

我想根据按钮单击（左侧按钮）将附加内容添加到右侧。

这些内容必须在附加到 DOM 之前使用 Angular（使用角度绑定）呈现。

我搜索了很多，但没有得到令人满意的信息。

我是[AngularJS](http://angularjs.org/)的新手。

例子：

内容是

```
 <tr>
    <td> <input type="checkbox" name="name1" value={{name}}> </td>
    <td> {{ text }} </td>
</tr> 
```

我想在右侧列中添加以上 tr （最初有空表）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:19:52.070

我建议你使用 ng-view 和 route 来实现这一点。

这是[plunker](http://plnkr.co/edit/mJvxXj?p=preview)

```
var app = angular.module('plunker', [])
.config(['$routeProvider', function ($routeProvider) {
    $routeProvider.when('/btnA', { templateUrl: 'btnA.html', controller: btnACtrl })

                            .otherwise({ redirectTo: '/btnB' });
          }]);

function btnACtrl($scope){
   $scope.text = 'Hello world !' ;
} 
```

# java - 为什么我在 Java 中无休止地附加一个字符串

> ID：13240892
> 
> 赞同：-5
> 
> 时间：2012-11-05T21:43:46.463
> 
> 标签：java

我正在编写游戏，当我尝试向服务器发送聊天消息时，我遇到了奇怪的内存泄漏。发送字符串：!chat¥Test 变成：

```
!chat¥test
!chat¥!chat¥test
!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥test
!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥!chat¥test
Ect, ect.

Sending message:

Utils.sendChat(message.getText());

public static void sendChat(String s) {
    System.out.println(s);
    sendChat("!chat"+Wrapper.commandSplit+s);
}

public static void sendTextLine(String s){
    s = s.replace(" ", "[SPACE]");
    System.out.println(s);
    Wrapper.pw.write(s);
     Wrapper.pw.flush();
} 
```

我不知道为什么会这样，有人可以帮助我吗？我使用'¥'来拆分字符串中的变量，并且之前没有给我任何问题，所以我怀疑它与它有什么关系。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-05T21:46:14.603

```
public static void sendChat(String s) {
    System.out.println(s);
    sendChat("!chat"+Wrapper.commandSplit+s);
} 
```

这是一个无限循环，每次您`sendChat`再次调用时都会构建越来越长的字符串。

你可能是想打电话给`sendTextLine`那里的二线？

# c++ - 在 Eclipse CDT 中包含来自另一个 C++ 项目的源文件

> ID：13240893
> 
> 赞同：16
> 
> 时间：2012-11-05T21:43:51.053
> 
> 标签：c++, eclipse, eclipse-cdt

我在 Eclipse CDT 中有一个 C++ 项目，它使用 OpevCV 中的一些函数，它编译成可执行文件并且工作正常。现在我想要一个新的 C++ 项目，它使用第一个中定义的一些函数。我无法将两者编译并链接在一起。

我`#include "..."`在新项目的相关文件中，我已将旧项目添加到新项目的引用项目中，并且在新项目的构建设置中，我已将旧项目的源文件夹添加为包含（`-I`gcc 选项）。

我附上了我的 Eclipse 的屏幕截图，以防它有帮助：

![在此处输入图像描述](../Images/10a41ef1daeff3350fe0ba7e8ef5427d.png)

编译器给出的错误是：

> 构建目标：OtherProject
> 调用：GCC C++ Linker
> g++ -o "OtherProject" ./src/foo.o
> ./src/foo.o：在函数`main'中：/ home/max/
> opencvjni /OtherProject/Debug/../ src/foo.cpp:13: 未定义对 threshold() 的引用
> collect2: ld 返回 1 退出状态
> make: *** [OtherProject] 错误 1

这是屏幕截图其他选项卡中其他文件中的代码：

**阈值.cpp**

```
#include <cv.h>
#include <highgui.h>
#include "Threshold.h"

using namespace cv;

int threshold(void) {
   Mat img = imread("/home/max/opencvjni/monalisa.jpg", 0);
   threshold(img, img, 127, 255, THRESH_BINARY);
   imwrite("/home/max/opencvjni/monathresh.jpg", img);
   return 0;
}

int main(void) {
  threshold();
  return 0;
} 
```

**阈值.h**

```
#ifndef THRESHOLD_H_
#define THRESHOLD_H_

int threshold(void);

#endif /* THRESHOLD_H_ */[/code] 
```

*   Eclipse 版本：3.7.2
*   CDT版本：8.0.2.201202111925
*   操作系统：Ubuntu 12.04

感谢您看我的帖子，如果没有办法做到这一点，或者以另一种方式做更明智，请不要犹豫，这样说。

问候

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-12-26T23:38:14.150

我也在寻找答案，但以前的答案并没有解决问题。（尼克的回答很有帮助）。你必须定义两件事：

1.  去`Project->Properties->C/C++ general->Paths and Symbols`。选择`Source Location`选项卡并单击`Link Folder...`，然后选择要包含的文件夹。
2.  去`Project->Properties->C/C++ general->Paths and Symbols`。选择`Includes`选项卡。确保在左侧菜单中选择正确的语言（例如：`GNU C++`）并单击`Add...`，然后选择要包含的文件夹。

**注意：**我不确定是否有必要，但是当我创建外部项目时，我在新项目向导中选择了“共享库”选项。

为确保一切正常，请转至：`Project->Properties->C/C++ Build->Settings`。选择`GCC C++ Linker`并确保`All options`包含“-L/your_folder_name”。也重复这个`GCC C++ Compiler`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-26T20:20:52.997

转到项目-> 属性-> C/C++ 通用-> 路径和符号。选择“源位置”选项卡，然后单击“链接文件夹...”按钮。您应该能够选择包含要引用的项目的目录。该项目的所有源文件都将包含在您当前的项目中。无论如何对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-06-27T14:21:35.877

作为一个新用户，我无法评论 Itay Gal 的答案，所以这是添加该答案的一种非常笨拙的方式。我的补充可能是显而易见的，但对我来说并不是那么明显。

**从 Itay Gal 你必须定义两件事：**

*来自参考项目*

**1\. 转到项目->属性->C/C++ 通用->路径和符号。选择源位置选项卡并单击链接文件夹...，然后选择要包含的文件夹。**

*要“选择要包含的文件夹”，我使用了**Link Folder->Advanced**，单击**“链接到文件系统中的文件夹”**复选框并浏览到我的文件夹位置，该位置位于我的工作区位置。“**文件夹名称”**是我的引用项目的子目录，我的引用文件将出现在其中，并在我选择引用的文件夹时自动填写。您可以编辑文件夹名称，但不能为其指定路径以使其成为子目录。*

**2\. 转到项目->属性->C/C++ 通用->路径和符号。选择包含选项卡。确保在左侧菜单中选择正确的语言（例如：GNU C++）并单击添加...，然后选择要包含的文件夹。**

*展开“选择要包含的文件夹”，从**“包含”**选项卡中，单击**Add->Workspace**，选择引用的项目并浏览到引用的文件夹并单击“确定”*

我没有将我的外部项目作为一个库，只是将一些文件保存在另一个 git 存储库中，这些文件甚至不是自己构建的。我希望它们分开，因为代码被其他几个项目共同使用。

**为确保一切正常，请转到：Project->Properties->C/C++ Build->Settings。选择 GCC C++ 链接器并确保所有选项包含“-L/your_folder_name”。对 GCC C++ 编译器也重复此操作。**

我在**“所有选项”窗口的****Project->Properties->C/C++Build->Settings->Cross ARM C++ Compiler**下找到了我的链接项目，但在**->Cross ARM C++ Linker**选项卡**“所有选项”**中没有找到窗户。无论如何，我的代码似乎可以正确构建并正确启动调试窗口。

 ******非常感谢 Itay gal 的回答。

因此，如上所述，它对我的​​第一个项目非常有效。然后我尝试对另外两个需要使用引用代码的项目做同样的事情。花了很长时间后，我得出结论，“Sources”目录中的项目包含与整个项目中的不同。如果您选择项目并应用第 2 步，您会得到与选择“源”目录并应用第 2 步不同的结果。这可能是我在学习 eclipse 时无意中打开的，但如果是我无处可关。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-05T23:50:51.180

我个人喜欢 CMake 来指定我的构建选项。CMake 项目也可以导入 Eclipse CDT。CMake 允许您在 linux 上生成 make 文件项目，也可以在 windows 上生成 VS 项目。OpenCV 网站还提供了如何将其与 CMake 一起使用的[示例。](http://docs.opencv.org/trunk/doc/tutorials/introduction/linux_gcc_cmake/linux_gcc_cmake.html)******

# facebook - 为什么应用详情页面拒绝我的所有图片？

> ID：13240895
> 
> 赞同：2
> 
> 时间：2012-11-05T21:44:00.803
> 
> 标签：facebook

我的应用详细信息页面的所有图片格式和大小都正确，但 Facebook 拒绝所有人，并给出一个通用的“*您尝试上传的图片无效。它可能已损坏，文件格式错误或大小错误*”错误。

如果需要，这是引用的应用程序：http: [//a.pgtb.me/3CTv6v](http://a.pgtb.me/3CTv6v)。虽然不确定为什么会这样。

我没有发现其他人有这些问题。什么是大问题？我正在使用最新版本的 Firefox for Mac。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:21:10.203

确保文件具有正确的扩展名（png、jpg、gif）并确保其格式正确。如果您仍然遇到问题，请在您喜欢的编辑器中打开图像，然后单击“另存为”，并将其重新保存为有效的 jpg、png 或 gif 格式。

# php - 贝宝自适应支付

> ID：13240897
> 
> 赞同：4
> 
> 时间：2012-11-05T21:44:03.503
> 
> 标签：php, paypal

当我运行 PayPal Adaptive Pay 呼叫时，我设置了大约 3 个接收方，如何获取每个接收方的状态？

因为我得到了这样的东西：

```
Array
(
    [responseEnvelope.timestamp] => 2012-11-05T13:17:48.598-08:00
    [responseEnvelope.ack] => Success
    [responseEnvelope.correlationId] => 8e31ecdad58ca
    [responseEnvelope.build] => 4110101
    [payKey] => AP-6TJ00518SC231111B
    [paymentExecStatus] => COMPLETED
) 
```

这是否通过 IPN 或我可以在沙盒区域中查看？我一直在重新阅读 PayPal 文档，我很困惑 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T05:10:52.537

只需使用[PaymentDetails](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_APPaymentDetails) api 来获取具有每个接收者状态的 PaymentInfo 元素数组。如果您有权代表每个收件人进行 GetTransactionDetails API 调用（您可以使用 Permissions API 获取），您可以使用 PaymentDetails API 响应中的 TransactionID 为每个子交易获取更多交易数据.

# c++ - 如何使用 wxThreadEvent 从线程传递数据？

> ID：13240898
> 
> 赞同：2
> 
> 时间：2012-11-05T21:44:07.827
> 
> 标签：c++, multithreading, wxwidgets

我有一个 GUI 和一个工作线程，我想将数据从工作线程发送到 GUI。我正在使用 QueueEvent 和 wxThreadEvents 来保持模型视图分离。我以某种方式遇到了 baadf00d 错误。

```
const int EvtID = 42;

MyFrame::MyFrame()
{
  ...
  // this seems to work correctly,
  //   but I'm including it in case it is part of the problem
  Bind(wxEVT_THREAD, (wxObjectEventFunction)&MyFrame::OutputData, this, EvtID);
  ...
}

MyFrame::OutputData(wxThreadEvent* event)
{
  // should get data from MyThread,
  //   but outputs 0xBA, 0xAD, 0xF0, 0x0D in successive calls
  output << event->GetInt();
}

MyThread::CreateOutputWithLocal()
{
  wxThreadEvent event(wxEVT_THREAD, EvtID);
  event.SetInt(getData());
  //pFrame is a wxEvtHandler*
  pFrame->QueueEvent(event.Clone());
}

MyThread::CreateOutputWithPointer()
{
  wxThreadEvent* event = new wxThreadEvent(wxEVT_THREAD, EvtID);
  event->SetInt(getData());
  //pFrame is a wxEvtHandler*
  pFrame->QueueEvent(event); // QueueEvent() takes control of the pointer and deletes it
} 
```

使用`wxThreadEvent`'s `SetPayload()`and`GetPayload()`或 its `SetExtraLong()`and`GetExtraLong()`似乎没有任何区别。我需要什么才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T07:18:46.483

Set/GetPayload 应该可以解决问题。可能是你做错了。您的代码将有更多帮助。但这里是一个剥离的例子，展示了这两种方法的用法。

```
Connect(wxID_ANY, wxEVT_COMMAND_DATA_SENT, wxThreadEventHandler(GMainFrame::OnAddText), NULL, this);//connect event to a method

void* MyThread::Entry(){
    wxThreadEvent e(wxEVT_COMMAND_DATA_SENT);//declared and implemented somewhere
    wxString text("I am sent!");
    e.SetPayload(wxString::Format("%s", text.c_str()));
    theParent->GetEventHandler()->AddPendingEvent(e);
    return NULL;
}

void GMainFrame::OnAddText(wxThreadEvent& event) {
    wxString t = event.GetPayload<wxString>();
    wxMessageBox(t);
} 
```

我很久以前在玩 wxThreadEvent 时写的一个示例的剥离版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T14:40:44.707

在您的情况下，我只会将有效负载存储在属于框架的线程安全队列中。

Before you queue the event, queue the data in the thread safe queue. In the OutputData function, flush the queue and read the data that is in it.

I'm using this strategy to pass `boost::function < void () >` to the UI, so it's very scallable, because I can trigger almost anything from the engine thread.

# javascript - jQuery ajax 范围内存泄漏

> ID：13240899
> 
> 赞同：5
> 
> 时间：2012-11-05T21:44:18.100
> 
> 标签：javascript, jquery, memory-leaks, closures

我想知道以下伪jQuery代码中是否会发生内存泄漏（因为成功回调总是引用_this）？

```
var _this = this;

$.ajax({
  url: "foo",
  type: "POST",
  data: data,
  success: function() {
      // Do stuff with _this
      _this.doStuffs();
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:04:14.223

此代码是否在函数中？

如果是（我猜），在 ajax 调用完成或失败后，_this 将无法被垃圾回收所识别。所以理论上没有理由担心这里的内存泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:04:03.667

我看不到那里的内存泄漏。成功回调应该在被调用后被垃圾收集（必须正确实现，你做对了 - 但它*是*由 jQuery 和浏览器正确完成的，甚至可能在 IE 中）。之后，也`_this`可以收集对象（如果没有从外部引用） - 但当然不是在此之前，这就是关闭的目的。

# javascript - 页面加载的Javascript？

> ID：13240901
> 
> 赞同：0
> 
> 时间：2012-11-05T21:44:28.100
> 
> 标签：javascript

这是我的代码：

```
var myarray=[(lots of things)];
var elem=document.getElementById('subtitle');
window.setInterval(function(){
    elem.innerHTML=myarray[Math.round((myarray.length-1)*Math.random())];
},30000); 
```

这工作正常，除了前 30 秒，没有任何反应。我必须等到它重新运行才能发生任何事情。我可以让它从`myarray`页面加载中选择一个吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:48:05.103

它必须等待 30 秒，因为当您设置间隔时，它不会立即触发它！将其分解为一个函数并调用它。如果在页面上的元素之后添加脚本，则不必担心 window.onload 或文档准备好。

```
<div id="subtitle"></div>
<script>
    (function(){
        var myarray=[(lots of things)];
        var elem=document.getElementById('subtitle');

        function dispNum() {
            elem.innerHTML=myarray[Math.round((myarray.length-1)*Math.random())];
            window.setTimeout(dispNum,30000);
        }    
        dispNum();
    })();
</script> 
```

重新运行示例：[jsFiddle](http://jsfiddle.net/yUBBG/)

# e-commerce - Magento 多店面加拿大原产地联邦快递费率

> ID：13240904
> 
> 赞同：1
> 
> 时间：2012-11-05T21:44:41.360
> 
> 标签：e-commerce, magento-1.7, magento

我到处搜索，发现其他一些用户（不在堆栈中）也遇到了和我一样的小众问题。不幸的是，我遇到的问题是 FedEx 的费率在多个店面 Magento 设置的管理用户上没有拉到加拿大。

让我澄清一下，

我正在运行 Magento 1.7.0.1 多个店面。一个店面是针对美国的，另一个是针对加拿大的。美国（前端、基于用户的方面和管理方面）的费率适当拉动，加拿大（前端、基于用户的方面）的费率也适当拉动，但行政方面却没有。

我进行了大量研究，发现无法获得汇率的原因是加拿大行政系统正试图以美元而不是 CAD 来提取汇率，而网站的前端可以正确提取 CAD。

如果可能的话，请帮忙，否则我可能会把头发扯掉。一切（应该）在可配置选项中正确设置，因为我过去做过多个店面和许多基于 Magento 的商店，并取得了巨大的成功。

非常感谢你们，托尼

# excel - 根据其中一个单元格的内容为整行着色

> ID：13240912
> 
> 赞同：0
> 
> 时间：2012-11-05T21:45:26.743
> 
> 标签：excel, vba, formatting

我正在尝试根据其中一列中给出的结果为电子表格着色。我正在使用以下代码：

```
With newSheet.Range("B:B")
    .FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, "CORRECT")
    .FormatConditions(1).Interior.ColorIndex = 4

    .FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, "INCORRECT")
    .FormatConditions(2).Interior.ColorIndex = 3
End With 
```

不幸的是，这只会给包含“正确”或“错误”的单元格着色。我希望它扩展到它们所在的行（例如，如果 B12 包含“正确”，我希望 A12:G12 全部为绿色）。有人建议我尝试使用表达式，所以我尝试了以下代码：

```
.FormatConditions.Add(Type:=XlFormatConditionType.xlExpression, Formula1:="=B" & row & "= ""CORRECT"")")
.FormatConditions(1).Interior.ColorIndex = 4 
```

但是，这会返回 E_INVALIDARG 异常。我将不胜感激有关如何解决此问题的任何提示。我还应该注意，循环遍历每一行并一次检查一个并不是真正的选择，因为有数千行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T22:15:17.403

一旦删除多余的右括号并使列成为绝对值，您的公式就应该起作用

```
.FormatConditions.Add(Type:=XlFormatConditionType.xlExpression, Formula1:="=$B1= ""CORRECT""")
.FormatConditions(1).Interior.ColorIndex = 4 
```

确保将公式`$B1`中的行设置为格式化范围的第一行（不需要循环）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:10:15.830

您可以将其粘贴到相关工作表中：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim i As Integer
    i = 1
    While Range("B" & i).Value2 <> ""
        If Range("B" & i).Value2 = "INCORRECT" Then
            Range("A" & i & ":G" & i).Interior.ColorIndex = 3
        ElseIf Range("B" & i).Value2 = "CORRECT" Then
            Range("A" & i & ":G" & i).Interior.ColorIndex = 4
        Else
            Range("A" & i & ":G" & i).Interior.ColorIndex = 0
        End If
        i = i + 1
    Wend
End Sub 
```

这假设您的数据从第 1 行开始（否则更改 的起始值`i`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T22:10:38.043

这是一个非常非常低技术的答案。但是，在您以您需要的颜色突出显示单元格之后（使用代码），复制列中的所有值并在行本身上为“格式”执行特殊粘贴。

问题在于它将是静态的，如果您的值随输入而变化，则行上的颜色将关闭。

但如果这是一次性的事情，那可能会奏效。

如果您这样做，请确保您正在评估的列具有与您要粘贴的行中的数据兼容的单元格格式类型（即：“常规”、“文本”等）。

Kludgey，但如果你绝对需要这个速度并且你只需要做一次，它可能会起作用。

编辑：很确定凯文在下面的答案是一个更好的答案，因为它实际上用代码解决了它，并且即使评估单元格中的值发生变化，它似乎也可以工作。

# database - H2数据库HTTPS连接

> ID：13240913
> 
> 赞同：0
> 
> 时间：2012-11-05T21:45:27.590
> 
> 标签：database, https, connection, h2

我正在使用 H2 数据库嵌入模式连接到本地数据库，但是，是否可以使用 HTTPS 打开位于远程服务器上的数据库文件？

目标是使用保管箱文件：[https ://dl.dropbox.com/.../database](https://dl.dropbox.com/.../database)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:58:37.657

[您可以使用H2 的文件系统抽象层](http://h2database.com/html/advanced.html#file_system)来实现 HTTP(S) 文件系统。

[H2](http://code.google.com/p/h2database/source/browse/#)中包含相当多的实现（从 Jar、Zip、内存中、NIO 等读取）

# c# - 将 WebClient 方法转换为 async / await

> ID：13240915
> 
> 赞同：42
> 
> 时间：2012-11-05T21:45:56.367
> 
> 标签：c#, microsoft-metro, async-await

我有一些现有代码要移植到 Windows 8 WinRT。代码从 URL 获取数据，异步调用传递的委托：

```
private void RequestData(string uri, Action<string> action)
{
  var client = new WebClient();
  client.DownloadStringCompleted += (s,e) => action(e.Result);
  client.DownloadStringAsync(new Uri(uri));
} 
```

转换为 WinRT 需要使用`HttpClient`异步方法。我已经阅读了一些关于 async / await 的教程，但有点困惑。如何更改上述方法，但维护方法签名以避免更改更多代码？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-11-05T21:50:33.450

```
private async void RequestData(string uri, Action<string> action)
{
    var client = new WebClient();
    string data = await client.DownloadStringTaskAsync(uri);
    action(data);
} 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/hh194294.aspx](http://msdn.microsoft.com/en-us/library/hh194294.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-05T22:19:35.480

> 如何更改上述方法，但维护方法签名以避免更改更多代码？

最好的答案是“你没有”。如果您使用`async`，则一直使用它。

```
private async Task<string> RequestData(string uri)
{
  using (var client = new HttpClient())
  {
    return await client.GetStringAsync(uri);
  }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-05T21:49:11.413

按照[此示例](http://msdn.microsoft.com/en-us/library/hh156528.aspx)，您首先使用以下命令创建异步任务，然后使用以下命令获取其结果`await`：

```
Task<string> downloadStringTask = client.DownloadStringTaskAsync(new Uri(uri));
string result = await downloadStringTask; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-05T21:48:26.917

```
var client = new WebClient();
string page = await client.DownloadStringTaskAsync("url"); 
```

或者

```
var client = new HttpClient();
string page = await client.GetStringAsync("url"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-05T21:50:54.353

`await`[HttpClient.GetStringAsync 方法](http://msdn.microsoft.com/en-us/library/hh551746.aspx)的结果：

```
var client = new HttpClient();
action(await client.GetStringAsync(uri)); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-01-10T16:04:42.393

这段代码用于 UploadValuesAsync：

```
public class WebClientAdvanced : WebClient
{
    public async Task<byte[]> UploadValuesAsync(string address, string method, IDictionary<string, string> data)
    {
        var nvc = new NameValueCollection();
        foreach (var x in data) nvc.Add(x.Key, x.Value.ToStr());

        var tcs = new TaskCompletionSource<byte[]>();
        UploadValuesCompleted += (s, e) =>
        {
            if (e.Cancelled) tcs.SetCanceled();
            else if (e.Error != null) tcs.SetException(e.Error);
            else tcs.SetResult(e.Result);
        };

        UploadValuesAsync(new Uri(address), method, nvc);
        var result = await tcs.Task;
        return result;
    }
} 
```

# javascript - 如何将我的序列化 JSON 字符串包装在“单引号”中

> ID：13240930
> 
> 赞同：19
> 
> 时间：2012-11-05T21:47:12.310
> 
> 标签：javascript, json, rest

我有一个名为的 javascript 对象`blocki`，我想使用 REST API 对其进行序列化和更新。所以我打电话：

```
JSON.stringify(blocki) 
```

这给了我这个字符串：

```
"{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}" 
```

这几乎是我需要的，除了双引号字符串应该在外面有单引号，就像这样：

```
'{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}' 
```

根据[MDN JSON.stringify](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)上的示例，它应该返回一个用单引号括起来的字符串。但是当我在该页面中尝试相同的示例时，我得到了用双引号括起来的字符串。例如，当我输入`JSON.stringify({})`Firefox 和 chrome 控制台时，我返回`"{}"`而不是`'{}'`.

如何正确序列化我的 Javascript 对象，以便外部引号是：`'`。同样，这个字符串是我想要实现的一个例子：

```
'{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}' 
```

理想情况下，我想学习一种序列化对象的好方法，而不必在序列化后修改字符串。

编辑：我认为我需要这样做的原因是，当字符串用双引号引起来时，我正在使用的 API 不知何故不高兴。例如，当我这样做时

```
curl -i -H "Accept: application/json" -H "Content-type: application/json" -X PUT -d "{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}" 'http://localhost:3000/api/blockies/17' 
```

请求失败，服务器给出解析错误。但是，当我尝试：

```
curl -i -H "Accept: application/json" -H "Content-type: application/json" -X PUT -d '{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}' 'http://localhost:3000/api/blockies/17' 
```

put 请求成功通过并更新对象。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T21:50:25.570

您不需要那些包裹字符串的单引号 - 这些仅在 MDN 页面上用于显示与输出对应的*字符串文字。*

引号不是字符串本身*内容的一部分！*

**编辑**- 自从我写了上面的内容以来，你已经编辑了这个问题。

简单的答案是，如果您绝对必须自己将字符串用单引号括起来*，*只需使用：

```
var json = "'" + JSON.stringify(obj) + "'" 
```

更长的答案仍然是您根本不应该包装字符串。将整个命令行传递给 shell 被认为是不好的做法 - 某些环境变量（尤其是`IFS`）的存在会改变命令行的解释方式，从而导致安全问题。

由于您使用的是 Javascript，我猜您可能正在使用`nodejs`和`child_process`模块？如果是这样，您应该使用`.spawn`而不是`.exec`，并将参数作为数组传递。当以这种方式传递时，参数会直接传递到 Curl 的`argv`数组中，而无需首先由 shell 解析，因此根本不需要引用，例如：

```
var child = spawn('curl', [
    '-i', '-H', 'Accept: application/json',
    '-H', 'Content-type: application/json', 
    '-X', 'PUT',
    '-d', json,
    'http://localhost:3000/api/blockies/17'
]); 
```

或者更好的是直接从 Node 进行 PUT 调用，而不使用 Curl。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-05T21:49:47.573

除了由方法自动完成的转义之外，用单引号或双引号括起来的字符串之间没有区别`JSON.stringify`。包裹字符串文字的单/双引号不是字符串本身的一部分。

双引号是 Firefox 和 Chrome 更喜欢在控制台中表示字符串文字的方式。

* * *

**编辑：**现在使用 CURL 命令它完全改变了问题的含义。

```
"{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}" 
```

上面的字符串不是有效的字符串，因为您不能在双引号包裹的字符串中包含未转义的双引号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-05T21:50:29.290

您所看到的只是控制台如何打印字符串的产物。

也就是说，在 Chrome 的控制台中试试这个以获得乐趣......

```
JSON.parse(
  JSON.stringify(
    JSON.parse(
      JSON.stringify(
        JSON.parse(
          '{"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}}'
))))).name 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-05T21:51:02.360

> 例如，当我在 Firefox 和 chrome 控制台中键入 JSON.stringify({}) 时，我会返回“{}”而不是“{}”。

这就是字符串在控制台中的显示方式。它实际上不是`"{}"`一个包含`{}`. 引号只是表示它是一个字符串。尝试在 Chrome 控制台中输入“”，您就会明白我的意思。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-05T22:00:50.217

周围的单/双引号只是表明它是一个字符串，它不是实际字符串数据的一部分并且不能存储。

```
var serializedData = JSON.stringify({"name":"Updated Blocki","bounds":{"x":"2em","y":"2em","w":"8em","h":"12em"}});
var deserializedData = JSON.parse(serializedData);  // whether console displays the serializedData String with single or double quotes is irrelevant 
```

如果您要存储字符串并将其输出到客户端，请用单引号将其包裹起来。

使用 curl 时，有什么东西可以阻止你用单引号括起来吗？

如果您坚持用双引号括起来，则必须像这样转义字符串中的双引号：

```
"{\"name\":\"Updated Blocki\",\"bounds\":{\"x\":\"2em\",\"y\":\"2em\",\"w\":\"8em\",\"h\":\"12em\"}}" 
```

# verilog - 如何在verilog中定义m * n输出

> ID：13240934
> 
> 赞同：0
> 
> 时间：2012-11-05T21:47:40.613
> 
> 标签：verilog, system-verilog

我正在为左移寄存器编写verilog代码，该代码在每次移位后存储其值到子寄存器中。我可以像这样将输出寄存器定义为数组吗，提供的代码只是一个简单的例子来展示这个概念而不是我的代码，

```
module test(a,b,c);
input a,b;
output [7:0] c [3:0];
endmodule 
```

代替

```
module test(a,b,c1,c2,c3,c4);
input a,b;
output [7:0] c1,c2,c3,c4;
endmodule 
```

第一种方法是我如何调用 c[i]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T06:30:44.290

...是的，您可以在输出中非常多地使用 2D 数组，就像在您的第一个示例中一样。查看 Stuart Sutherland 本人撰写的本文的第 5 节，这应该会给您一些信心。该部分的标题为`Module Ports`。

[http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CC4QFjAA&url=http%3A%2F%2Fwww.sutherland-hdl.com%2Fpapers%2F2006-SNUG-Europe_SystemVerilog_synthesis_paper。 pdf&ei=7KmYUNKPN6GyigKDnoHwDA&usg=AFQjCNGmr3flHrARC-w40xveo8zitcdjfg&cad=rja](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CC4QFjAA&url=http%3A%2F%2Fwww.sutherland-hdl.com%2Fpapers%2F2006-SNUG-Europe_SystemVerilog_synthesis_paper.pdf&ei=7KmYUNKPN6GyigKDnoHwDA&usg=AFQjCNGmr3flHrARC-w40xveo8zitcdjfg&cad=rja)

此外，详细说明您的第一个示例，为了清楚起见，您可以这样定义模块：

```
module lshift(clk, reset, a, c);
input wire clk, reset;
input wire [7:0] a;
output reg [7:0] c [0:3]; // <-- defining the unpacked dimension as [0:3] for clarity

always@(posedge clk) begin
   if(reset) begin
       c[0] <= 8'd0;
       ...
       c[3] <= 8'd0;
   end
   else begin
       c[0] <= a;
       c[1] <= c[0];
       c[2] <= c[1];
       c[3] <= c[2];
   end
end
endmodule 
```

...现在您可以切入您的阵列。`c[0], c[1] .. c[3]`每个代表一个字节，表示第一个字节`c[0][3:0]`的低半字节。

... 希望这可以帮助！

# android - Android UDP 入站流量

> ID：13240938
> 
> 赞同：2
> 
> 时间：2012-11-05T21:47:43.760
> 
> 标签：android, sockets, udp

我试图在 23000 上保留一个监听 UDP 端口，该**应用程序在本地环境中运行良好**。但是切换到3G没有机会，流量被阻塞。

我尝试在接收之前“打开”在同一端口上发送 4 字节数据的运营商通道：

```
 InetAddress serverAddr = InetAddress.getByName(SOULISSIP);
                DatagramChannel channel = DatagramChannel.open();
                socket = channel.socket();

                //socket = new DatagramSocket();
                socket.setReuseAddress(true);

                //InetSocketAddress ia = new InetSocketAddress("localhost", SERVERPORT);
                InetSocketAddress sa = new InetSocketAddress(SERVERPORT);
                socket.bind(sa);
                DatagramPacket holepunh = new DatagramPacket(new byte[]{0,1,2,3},4, serverAddr, SERVERPORT);
                socket.send(holepunh);

                // create a buffer to copy packet contents into
                byte[] buf = new byte[200];
                // create a packet to receive

                DatagramPacket packet = new DatagramPacket(buf, buf.length);

                Log.d("UDP", "***Waiting on packet!");
                socket.setSoTimeout((int) opzioni.getDataServiceInterval());
                // wait to receive the packet
                socket.receive(packet);
                UDPSoulissDecoder.decodevNet(packet);
                socket.close(); 
```

有没有一种简单的方法可以打开通道并在端口 23000 上接收 UDP 数据报？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:19:54.043

所以，答案就在请求中，而我正在努力接收套接字。我必须**将发送方套接字绑定到用于接收**数据报的本地端口：

```
 //send                
            serverAddr = InetAddress.getByName(SOULISSIP);

            DatagramChannel channel = DatagramChannel.open();
            sender = channel.socket();
            sender.setReuseAddress(true);

            //amateur hole punch
            InetSocketAddress sa = new InetSocketAddress(SERVERPORT);
            sender.bind(sa);
            //stuff to send
            List<Byte> macaco = new ArrayList<Byte>();
            macaco = Arrays.asList(pingpayload);
            ArrayList<Byte> buf = buildVNetFrame(macaco, prefs);
                    //someone help me here...
            byte[] merd = new byte[buf.size()];
            for (int i = 0; i < buf.size(); i++) {
                merd[i] = (byte) buf.get(i);
            }
            packet = new DatagramPacket(merd, merd.length, serverAddr, SOULISSPORT);
            sender.send(packet); 
```

接收者和发送者在不同的线程上，使用相同的本地端口。`.setReuseAddress(true)`允许这样做。

# jquery - 如果菜单项具有父页面，则它不会显示为可点击链接

> ID：13240942
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:48:07.400
> 
> 标签：jquery, html, css, drop-down-menu, xhtml

我有一个下拉菜单。在此菜单中，如果有父页面，则第一个链接将变为不可点击。它应该充当链接。检查页面

> [http://www.deletedurl.com/wp/](http://www.deletedurl.com/wp/)

正如您在“关于我们”页面上看到的那样，它是不可点击的。它有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:10:04.457

当子菜单 ul 变得可见时，它被放置在父 li 的顶部，这就是它变得不可点击的原因。修改 style.css 如下，它应该可以正常工作。

Style.css（第 67 行）

```
#navigation ul {
   padding-top: 10px;
} 
```

Style.css（第 170 行）

```
#navigation ul li ul {
  margin-top: -10px;
} 
```

**截屏**

![在此处输入图像描述](../Images/90645a068b3730b20ae2ea4ad87d363d.png)

# java - 创建吞吐量有限的 OutputStream

> ID：13240945
> 
> 赞同：2
> 
> 时间：2012-11-05T21:48:12.853
> 
> 标签：java, io

我正在通过 USB 连接将数据从我的 Java 应用程序推送到另一端的 Arduino。

Arduino 只能在其末尾缓冲 64 字节的数据，因此我必须限制从我的 Java 应用程序的每个“gulp”中发送的字节数（多余的字节将丢失）。当 Arduino 代码准备好接收更多字节时，它会发送一个简单的 ping 线路。

所以，我扩展`BufferedOutputStream`了一个类`ArduinoBufferedOutputStream`，它包装了实际的输出流。从 Java 应用程序的不同部分将任意数量的字节写入流（带有`write(byte b)`），并且流被偶尔`flush`编辑。

我需要（我猜）是覆盖`BufferedOutputStream`s flush 方法，以便在接收来自 Arduino 的 ping 之前，它不会发送超过 64 个字节，此时流应该发送 64 个更多字节（或更少）。

```
 static class ArduinoBufferedOutputStream extends BufferedOutputStream {

        public static final int WIRE_CAPACITY = 25;
        private byte[] waiting = new byte[0];
        private int onWire = 0;

        public ArduinoBufferedOutputStream(final OutputStream wrapped) throws IOException {
            super(wrapped, 500);
        }

        public void ping() {
            this.onWire = 0;
            this.flush();
        }

        @Override
        public void flush() throws IOException {
            if (this.onWire >= WIRE_CAPACITY) {
                return; // we're exceeding capacity, don't to anything before the next ping
            }
            if (this.count > WIRE_CAPACITY) {
                this.waiting = new byte[this.count - WIRE_CAPACITY];
                System.arraycopy(this.buf, WIRE_CAPACITY, waiting, 0, this.count - WIRE_CAPACITY);
                this.buf = Arrays.copyOfRange(this.buf, 0, WIRE_CAPACITY);
                this.count = WIRE_CAPACITY;
            } else {
                this.waiting = new byte[0];
            }
            onWire += this.count;
            super.flush();
            if (this.waiting.length > 0) {
                System.arraycopy(this.waiting, 0, this.buf, 0, Math.min(this.waiting.length, WIRE_CAPACITY));
                this.count = Math.min(this.waiting.length, WIRE_CAPACITY);
            }
        }
    } 
```

但是，这不能正常工作。如果缓冲区包含多个`WIRE_CAPACITY`字节，则字节会丢失，如以下测试用例所示：

```
@Test
public void testStream() throws IOException {
    final ArduinoBufferedOutputStream stream = new ArduinoDisplayOutputStream.ArduinoBufferedOutputStream(System.out);
    stream.write("This is a very, very long string, which must be made even longer to demonstrate the problem".getBytes());
    stream.flush();
    stream.ping();
    stream.ping();
    stream.ping();
    stream.ping();
    stream.ping();
    stream.ping();
    stream.ping();
    stream.ping();
    stream.ping();
} 
```

打印以下字符串：`This is a very, very long string, which must be ma`，而我显然希望打印整个字符串。

谁能看到我在这里做错了什么？或者更好的是，有人知道现有的图书馆可以满足我的要求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T22:12:42.860

诚然，我对 Arduino 没有任何经验，但我在处理 Java 输出/输入流方面有很多经验。对此持保留态度，因为我无法在真正的 Arduino 设备上实际测试它，但如果我处于你的情况，这就是我会做的。

我怀疑您的调用`stream.write("This is a very, very long string, which must be made even longer to demonstrate the problem".getBytes());`实际上是在缓冲整个字符串。当您随后调用 时`stream.flush()`，所有字符串数据都会一次全部“写入”到 Arduino 设备。我怀疑这是因为您正在调用`BufferedOutputStream`大小为 500 字节的超级构造函数。首先，我会尝试将其减少到 64 字节。但是，我怀疑这也可能无法解决问题，因为`BufferedOutputStream`不知道何时调用`ping`.

我认为您将要同时覆盖`write`and `flush`。`flush`根据 Java 规范，背后的想法`flush`是应该强制任何未写入的缓冲字节写入底层流：

[http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html#flush](http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html#flush) ()

我也可能只是扩展 plain-ole`OutputStream`并自己做任何缓冲。我将重写该`write`方法以一次缓冲多达 64 字节的数据。如果 64 字节空间不足，请调用已`super.write()`填充的 64 字节缓冲区，然后调用`super.flush()`and then `ping()`，然后再缓冲/写入更多数据。在 while 循环中重复此过程，直到您的缓冲区有足够的空间来容纳输入数据的剩余部分。然后重写`flush`以写入任何未完全填满底层 64 字节缓冲区的数据（因此实际上并没有被先前的调用写入`super.write()`）。

这样，如果您调用`write`太多数据，您的类将写入底层流，直到最多保留 64 个字节，您随后的调用`flush`将确保最后几个字节实际写入 Arduino。归根结底，您还将获得一个完全符合 Java 的`OutputStream`实现，这也很好。

***编辑***

我使用 64 字节只是因为你说你的 Arduino 一次可以处理那么多。当然，如果需要，可以减少，我只是为了方便使用“64”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T22:15:35.100

您的`flush()`写入`WIRE_CAPACITY`= 每次调用最多 25 个字节。您调用它两次，总输出为 50 个字节（假设 cp1252 编码）。我认为这没有错。

也许你应该在`flush()`里面打电话`ping()`？然后，您的测试将基本上变为：

```
@Test
public void testStream() throws IOException {
    final ArduinoDisplayOutputStream.ArduinoBufferedOutputStream stream = new ArduinoDisplayOutputStream.ArduinoBufferedOutputStream(System.out);
    stream.write("This is a very, very long string, which must be made even longer to demonstrate the problem".getBytes());
    stream.flush();
    stream.ping();
    stream.ping();
    ... // as many ping()s as written bytes / WIRE_CAPACITY
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T23:52:49.370

好吧，我想我说对了，最后。扩展`BufferedOutputStream`是一个死胡同。相反，我使用了一个单独的缓冲区，就像@ben-lawry 建议的那样。通过使用 a`ConcurrentLinkedQueue`作为该缓冲区，我可以轻松地轮询`WIRE CAPACITY`每个`flush()`.

有人可能会说效率不是很高，但与 Arduino 处理相比，Java 方面发生的事情仍然会很快。

这是我得到的：

```
 static class ArduinoBufferedOutputStream extends OutputStream {

        public static final int WIRE_CAPACITY = 25;
        private final ConcurrentLinkedQueue<Byte> buffer = new ConcurrentLinkedQueue<Byte>();
        private int onWire = 0;
        private OutputStream wrapped;

        public ArduinoBufferedOutputStream(final OutputStream wrapped) throws IOException {
            super();
            this.wrapped = wrapped;
        }

        @Override
        public void write(int i) throws IOException {
            this.buffer.add((byte) i);
        }

        @Override
        public void write(byte[] bytes) throws IOException {
            for (byte aByte : bytes) {
                this.buffer.add(aByte);
            }
        }

        @Override
        public void write(byte[] bytes, int off, int len) throws IOException {
            for (int i = off; i < len; i++) {
                this.buffer.add(bytes[i]);
            }
        }

        public void ping() throws IOException {
            synchronized (this.buffer) {
                this.onWire = 0;
            }
            this.flush();
        }

        @Override
        public void flush() throws IOException {
            synchronized (this.buffer) {
                for (; this.onWire < WIRE_CAPACITY && buffer.size() > 0; this.onWire++) {
                    wrapped.write(buffer.poll());
                }
            }
        }
    } 
```

谢谢@gpeche 和@ben-lawry - 这肯定有助于让更多人关注这个问题。

# c# - 从 COM/STA 线程向 WPF UI 线程报告进度

> ID：13240950
> 
> 赞同：0
> 
> 时间：2012-11-05T21:48:30.640
> 
> 标签：c#, wpf, com, sta, acrobat-sdk

我正在开发一个使用 COM 和 Acrobat SDK 打印 PDF 的应用程序。该应用程序是用 C#、WPF 编写的，我试图弄清楚如何在单独的线程上正确运行打印。我已经看到 BackgroundWorker 使用线程池，因此不能设置为 STA。我确实知道如何创建 STA 线程，但不确定如何从 STA 线程报告进度：

```
Thread thread = new Thread(PrintMethod);
thread.SetApartmentState(ApartmentState.STA); //Set the thread to STA
thread.Start(); 
thread.Join(); //Wait for the thread to end 
```

如何在这样创建的 STA 线程中向我的 WPF ViewModel 报告进度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:51:53.677

实际上不是，您需要报告进度，而不是来自**UI运行****的**（已经存在的）STA 线程。

您可以通过`BackgroundWorker`函数（[`ReportProgress`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)在启动的线程上传递`BackgroundWorker`——这应该是您的 UI 线程）或使用 UI 线程`Dispatcher`（通常使用`Dispatcher.BeginInvoke`）来实现这一点。

* * *

编辑：
对于您的情况，解决方案`BackgroundWorker`不起作用，因为它的线程不是 STA。所以你需要正常工作`DispatcherlInvoke`：

```
// in UI thread:
Thread thread = new Thread(PrintMethod);
thread.SetApartmentState(ApartmentState.STA); //Set the thread to STA
thread.Start();

void PrintMethod() // runs in print thread
{
    // do something
    ReportProgress(0.5);
    // do something more
    ReportProgress(1.0);
}

void ReportProgress(double p) // runs in print thread
{
    var d = this.Dispatcher;
    d.BeginInvoke((Action)(() =>
            {
                SetProgressValue(p);
            }));
}

void SetProgressValue(double p) // runs in UI thread
{
    label.Content = string.Format("{0}% ready", p * 100.0);
} 
```

如果您当前的对象没有`Dispatcher`，您可以从您的 UI 对象或视图模型（如果您使用一个）中获取它。

# php - 递归展开代码折叠

> ID：13240955
> 
> 赞同：3
> 
> 时间：2012-11-05T21:48:46.093
> 
> 标签：php, netbeans

当我折叠所有折叠（默认为`CTRL`- `SHIFT`- `-`）然后展开我正在处理的功能（`CTRL`- `+`）时，它会使任何较小的段（在 内`{...}`）折叠。

有没有办法扩展折叠以及该折叠中包含的任何折叠？

如果没有，是否可以至少选择折叠哪些类型的代码？（例如，从不折叠循环和`if..else`语句）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:16:09.763

> 有没有办法扩展折叠以及该折叠中包含的任何折叠？

默认情况下`Ctrl`++应该递归`Shift`展开`=`

# api - Zend - 为移动应用程序创建 PHP API

> ID：13240963
> 
> 赞同：0
> 
> 时间：2012-11-05T21:49:18.083
> 
> 标签：ios, android, api, zend-framework, mobile-application

我目前正在计划为[ios](/questions/tagged/ios "显示标记为“ios”的问题")和[![](../Images/dc8cb918af09925459f09f0474c9be2c.png)android](/questions/tagged/android "显示标记为“android”的问题")创建一个移动应用程序。

该应用程序将允许最终用户管理和查看其项目的进度。（网络创建公司）。

该应用程序将具有：

*   项目管理（多个）
    *   查看进度
    *   查看任务
    *   查看营业时间
    *   查看文件
    *   查看消息
*   登录/注销表单 + 个人资料/编辑个人资料部分
*   发送/回复消息
*   添加对任务和文件的评论

问题是：*使用 Zend 框架创建 API（Restful 或其他）的最佳方式是什么？*

该 API**必须**并且**将**被集成到定制的项目管理系统和 MySQL 数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T12:43:53.463

我只是在研究 PHP API（无论 API 是用于移动平台还是其他网络），在 SOAP 和 REST 之间实现之后，我选择了一个 RESTful API，我可以推荐它......

Zend Framework 具有用于上述两种方法的组件，但 REST 在 comp 中更容易且更易于理解。用肥皂...

您必须考虑的一件事是日志记录，您可以使用 HTTP Auth 或 OAuth（HTTP 认证更容易），但根据我的说法，更好的方法是为您的用户生成唯一的 API KEY（每个用户都应该有自己的 KEY），这KEY 确保您可以识别用户并且安全风险最小，因为用户不必在 HTTP 请求中发送登录名和密码（安全风险），并且如果 KEY 被 WIFI 或基础设施捕获，黑客不会让用户登录到 Web 应用程序，仅适用于可能不是主要 Web 应用程序提供的所有功能的 API。

如果你为你的 KEY 设置了一些时间期限或为 KEY 设置了 IP 限制，那么你可以让它更安全:)

最后的一些提示：将 API 实现为新的分离 ZF 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T06:14:16.443

到目前为止我注意到的最好的东西之一是[http://getfrapi.com/](http://getfrapi.com/)

它利用了从 Zend 到 Pear 的所有东西。也许您应该查看视频[http://www.youtube.com/watch?v=vJVQi7ZFSaQ](http://www.youtube.com/watch?v=vJVQi7ZFSaQ)

# c++ - 使用 select() 请求/回复服务器。无法写回客户端

> ID：13240964
> 
> 赞同：2
> 
> 时间：2012-11-05T21:49:19.370
> 
> 标签：c++, sockets, networking, nonblocking

我从[beej 指南](http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html#select)中获得了所有这些代码，因此可以从那里看到所有接受。在 Beej 的代码中，他从客户端获取消息，然后将消息发送给所有其他客户端。这可以从这里的这个片段中看出：

```
 // handle data from a client
                if ((nbytes = recv(i, buf, sizeof buf, 0)) <= 0) {
                    // got error or connection closed by client
                    if (nbytes == 0) {
                    //handle error
                    }
                } 
                else {
                    // we got some data from a client
                    for(j = 0; j <= fdmax; j++) {
                        // send to everyone!
                        if (FD_ISSET(j, &master)) {
                            // except the listener and ourselves
                            if (j != listener && j != i) {
                                if (send(j, buf, nbytes, 0) == -1) {
                                    perror("send");
                                }
                            }
                        }
                    }
                }
            } // END handle data from client 
```

我不想将相同的消息发送给所有客户端，而是将其调整为请求/回复功能，并向我收到数据的同一客户端发送回复。

这是我到目前为止所拥有的：

```
long length = 0;
string stringRead;
messagebroker broker;
read( i, &length, sizeof( length ) );
length = ntohl( length );
if(length > -1)
while ( 0 < length ) {
     char buffer[1024];
     int cread;
     cread = read( i, buffer, min( sizeof( buffer ), length ) );
     stringRead.append( buffer, cread );
     length -= cread;
 }
cout << "Got Message: " + stringRead << endl;
string response = broker.handleMessage(stringRead.c_str());

cout << "sending response" << response << endl;

//socket ready for writing
if (FD_ISSET(i, &master)) { //should i check to see if write_fds? I have this here
                                //simply because the guide has it, but i am suspicious
                                //it is there so we can not write to the master.
  length = htonl( response.length() );
  cout << "sent length" << endl;
  if(send( i, &length, sizeof(length) , 0) == 0){
     fprintf(stderr, "Error sending data %d\n", errno);
     exit(3);
  }
  if(send( i, response.data(), response.length(),0 )== 0){
          fprintf(stderr, "Error sending data %d\n", errno);
          exit(3);
      }
    }   //end if 
```

我从服务器上的客户端接收所有数据。然后我不确定问题是在服务器上写回数据，还是从客户端读取。我假设它正在从服务器写入客户端。正如我在评论中暗示的那样，我想我知道我哪里出错了，但是我已经删除了这个 if 语句，我仍然无法在客户端读取任何内容。我需要在一开始就设置一个可写标志吗？如果您需要其他任何东西，请告诉我。抱歉这篇文章太长了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:00:17.020

就写吧。如果它返回 -1/EWOULDBLOCK，或者一个表明它没有写入完整响应的值，*则将*FD 添加到 writefds，并在 FD 变为可写时继续写入。您通常没有任何 writefd，因为 FD 通常是可写的，也就是说它们通常在其套接字发送缓冲区中有空间。

# jquery - 单击时，所有 div 都被删除，而不是一个

> ID：13240965
> 
> 赞同：-1
> 
> 时间：2012-11-05T21:49:22.800
> 
> 标签：jquery

我有几个名为“albumbox”的 div。对于每个唯一元素都在“数据”中。我想删除我刚刚在确认框中单击并确认的那个。但是在取消一个并确认另一个相册框后，所有先前（已取消）的相册框也会被删除。

谁能告诉我我在这里做错了什么？

```
$('.albumbox').live('click',function(){  
    var boxID = $(this).attr('data');

    $(".confirmBox").show();
    $("#abort").live('click',function(){  $(".confirmBox").hide(); });
    $("#confirm").live('click',function(){ 
        $(".confirmBox").hide();
        $('[data^=' + boxID + ']').slideUp('3000');
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:50:50.550

在单击事件中，要隐藏被单击的事件，您可以使用`$(this).hide()`反对命名元素的类/ID。

# python - 在 python 脚本中运行 bash 命令 X 秒

> ID：13240966
> 
> 赞同：1
> 
> 时间：2012-11-05T21:49:36.700
> 
> 标签：python, raspberry-pi, gpsd

我有一个 gps 连接到我的树莓派，并试图用它来对来自传入相机的照片进行地理标记。通过发出命令“gpsd -nND2 /dev/ttyUSB0”，我可以获得连续 gps 数据的 bash 回显输出，以后可以对其进行解析。但是，我只需要平均 10 个左右的数据点（在 10 秒内收集），然后想关闭 gpsd。

我的一般延时程序是用 python 编写的，所以这是我目前所拥有的：

```
(stdout, stderr) = Popen(["gpsd","-nND2,"/dev/ttyUSB0"], stdout=PIPE).communicate() 
```

不幸的是，这将向变量*stdout 输出*我无法解析的无限数量的数据点。输出很像一个永无止境的 ping 例程。如何停止数据收集以进行合理/可解析的数据转储？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T22:05:56.530

根据[文档](http://catb.org/gpsd/gpsd.html)，您*不*应该查看控制台输出，而是将其用作**守护**进程，通过 TCP 与其通信：`gps**d**`

 **> 客户端应用程序将通过 TCP/IP 端口（默认为 2947）与 gpsd 通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T21:54:12.727

这行得通吗？我没有测试过。

```
proc = Popen(["gpsd","-nND2","/dev/ttyUSB0"], stdout=PIPE)

samples = []
for _ in range(10):
    samples.append(proc.stdout.readline())

proc.terminate() 
```**

# email - 是否有关于 EML 文件格式的 RFC？

> ID：13240987
> 
> 赞同：14
> 
> 时间：2012-11-05T21:51:03.233
> 
> 标签：email, rfc, eml, email-formats

基本上，我正在尝试使用 EML 文件，我想知道这些文件在不同的电子邮件服务器中是否相当标准......基本上，是否有关于 EML 文件的 RFC，就像有一个用于电子邮件地址和其他主题的 RFC？

* * *

我想我可以更具体一点，以更好地了解我需要什么。我正在扫描 Exchange 邮箱并从以下属性中保存 eml 文件：`Microsoft.Exchange.WebServices.Data.EmailMessage.MimeContent.Content`.

一旦我有一个 eml 文件，我想知道它是否有一种标准的格式化方式。差不多就是这样。我询问了 RFC，因为我认为该标准将在 RFC 中进行解释。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T06:15:55.393

.eml 文件*通常*以[rfc822](http://www.ietf.org/rfc/rfc0822.txt)格式存储

但是afaik，没有官方定义

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-30T22:25:05.120

这个扩展了 rfc822 并涵盖了 MIME 实体和其他内容：

[https://www.ietf.org/rfc/rfc1521.txt](https://www.ietf.org/rfc/rfc1521.txt)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-05T21:56:14.223

电子邮件和邮箱有几种传统的存储格式，但它们没有单一的标准。RFC 往往是关于通过网络传输的内容，而不是在盒子内部发生的事情。

# silverlight - 使用 RIA 服务的异步任务

> ID：13240990
> 
> 赞同：1
> 
> 时间：2012-11-05T21:51:11.600
> 
> 标签：silverlight, asynchronous, wcf-ria-services, ria, .net-4.5

我正在使用 Silverlight 与带有 WCF RIA 服务的 .net 4.5 服务器对话。

我有兴趣使用新的异步模式在服务器上获得一些性能提升。但是，当我让某些函数在服务器上返回异步任务时，它将在 Silverlight 客户端中不可见。

这对 RIA 服务来说是不可能的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T15:24:33.923

不，这是不可能的。其中，代理生成器不知道异步模式，也不会在客户端生成所需的基于任务的重载方法。

# python - 从外部 API 检索的模型的查询集

> ID：13240991
> 
> 赞同：2
> 
> 时间：2012-11-05T21:51:11.200
> 
> 标签：python, django, api, models

我目前正在开发一个使用亚马逊产品 API 来获取书籍信息的网络应用程序。我使用的 Book 模型仅包含 ASIN amazon 识别码，看起来有点像这样：

```
class Book(models.Model):
    asin = models.CharField(max_length-10, unique=True)
    def retrieve(self, **kwargs):
        kwargs['ItemId'] = self.asin
        self.xml = amazon_lookup(**kwargs) # returns BeautifulSoup
    @property
    def title(self):
        try:
            return self.xml.ItemAttriibutes.Author.text
        except AttributeError: # happens when xml has not been populated
            return None
    ...

class BookManager(models.Manager):
    def retrieve(self, **kwargs):
        kwargs['SearchIndex'] = 'Books'
        book_search = amazon_search(**kwargs)
        books = []
        for item in book_search:
            book = self.get_or_create(asin=item.ASIN.text)[0]
            book.xml = item
            books.append(book)
        return books 
```

然后我可以用

```
b = Book.objects.retrieve(Keywords="foo bar")
b.retrieve(ResponseGroup="Images,ItemAttributes,...")
t = b.title 
```

**这对于测试来说足够好，但我想要一个更强大的系统以供将来使用。**

我真正想做的是能够使用查询集执行搜索，以便可以缓存经常访问的结果。就目前而言，对图书详细视图的每个请求都会创建一个新的亚马逊 API 调用。如果所有 API 调用都在查询集中与数据库调用一起处理，我的工作会容易得多。不幸的是，我发现 Django 查询集文档在定制方面非常神秘且缺乏。这肯定不是一个罕见的用例。

**任何人都可以提供处理此类问题的惯用方式，或有关该主题的良好资源吗？**

# jquery - Jquery ui选项卡因大量数据而变慢

> ID：13240992
> 
> 赞同：5
> 
> 时间：2012-11-05T21:51:12.277
> 
> 标签：jquery, jquery-ui, tabs

我注意到，当使用 jQuery UI 选项卡布局时，我打开了一些包含大量 HTML 的选项卡。然后在选项卡之间切换有点慢。就像我点击标签标签时一样，标签打开需要 2-4 秒。我认为这是事实，如果我想在标签中显示这么长的文本，我无法更改它，但是有没有办法在标签打开之前显示一些加载指示器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-10T09:30:59.397

不是我的代码，它来自 jQuery 论坛：

[https://forum.jquery.com/topic/switching-tabs-slow-with-big-content](https://forum.jquery.com/topic/switching-tabs-slow-with-big-content)

代码位于：

[http://jsfiddle.net/7npbK/1/](http://jsfiddle.net/7npbK/1/)

```
 $("#tabs").tabs({
      beforeActivate: function () {
          // alert("switching");
          $("#loadingDiv").fadeIn('slow');
      },
      activate: function () {
          //alert("switched");
          $("#loadingDiv").fadeOut('slow');
      }
  }); 
```

基本上，您使用 jQuery UI 选项卡的**beforeActivate**和**activate**事件。但是，它并没有解决根本原因：jQuery 选项卡使用 CSS 显示/隐藏，并且带有大量 DOM 元素，导致 UI 响应缓慢。

# .htaccess - .htaccess 不可见重定向到子文件夹中的页面

> ID：13240996
> 
> 赞同：3
> 
> 时间：2012-11-05T21:51:40.600
> 
> 标签：.htaccess, redirect

我在 .htaccess 中尝试了很多选项，但都没有成功。我想做的是：

我有 Wordpress 驻留在自己的文件夹中，如下所示：`site.com/folder`

我希望所有访问 site.com 的用户都被重定向到`site.com/folder/page`但 URL 不会在浏览器中更改的方式。所有其他 URL，例如`site.com/folder`并且`site.com/folder/page1 etc`不应受到影响。

如何以尽可能对 SEO 友好的方式做到这一点？

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:00:46.767

您不能将用户从服务器端重定向到其他页面而不向用户展示。但是如果你需要，你可以使用 HTML 标签`<frame>` [http://www.w3schools.com/tags/tag_frame.asp](http://www.w3schools.com/tags/tag_frame.asp) 但是这个不好的一面是使用总是会显示“site.com”而不是真正的页面。

但我认为最好的方法是代理结果，在 Apache 中你可以通过这样的方式来做到这一点。

```
RewriteEngine ON
RewriteRule ^/$ folder/page/index.php [L] 
```