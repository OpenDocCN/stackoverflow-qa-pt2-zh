# StackOverflow 问答 15211000-15211999

# android - 没有这样的表异常 SQLite

> ID：15211004
> 
> 赞同：1
> 
> 时间：2013-03-04T20:58:27.300
> 
> 标签：android, sqlite

我的代码现在如下：

**主应用程序java：**

```
 String TAG = "DATABASES";    
    try {

        String destPath = "/data/data/" + getPackageName()
                + "/databases/data.db";

        File f = new File(destPath);
        if(!f.exists()){
            Log.v(TAG,"Dest DB doesn't exist");
            InputStream in = getAssets().open("airports.db");
            OutputStream out = new FileOutputStream(destPath);

            byte[] buffer = new byte[1024];
            int length;
            while ((length = in.read(buffer)) > 0) {
                out.write(buffer, 0, length);
            }
            in.close();
            out.close();
        } else {
            Log.v(TAG,"File exists: " + destPath);  

        }

    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        Log.v(TAG,"ioexeption");
        e.printStackTrace();
    }

    DBManager dbManager =  new DBManager(this);
    Log.v(TAG,"Database is there with version: "+dbManager.getReadableDatabase().getVersion());
    //String sql = "select * from airports where IATA='GRO' ";
    String sql = "select count(*) from airports";

    SQLiteDatabase db = dbManager.getReadableDatabase();
    Cursor cursor = db.rawQuery(sql, null);
    Log.v(TAG,"Query Result:"+cursor);

    cursor.close();
    db.close();
    dbManager.close(); 
```

**我的 DBManager.java：**

```
package com.jammo.mywidget4;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DBManager extends SQLiteOpenHelper {

private static final int DATABASE_VERSION = 1;
private static final String TAG = "DATABASES";

public DBManager(Context context) {
    super(context, "data.db", null, DATABASE_VERSION);

}

@Override
public void onCreate(SQLiteDatabase db) {
    Log.v(TAG,"On create Called:"+db.getPath());
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
}
} 
```

现在执行在“db”启动时在 main.java 中运行正常，但是在尝试执行 rawQuery() 的下一行失败

仅供参考“从机场选择计数（*）”在我的 Sqlite 数据库管理器 GUI 上运行返回 1650 行。

**错误日志说：**

```
03-04 21:54:24.200: E/AndroidRuntime(11513): FATAL EXCEPTION: main
03-04 21:54:24.200: E/AndroidRuntime(11513): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.jammo.mywidget4/com.jammo.mywidget4.SectorInfo}: android.database.sqlite.SQLiteException: no such table: airports: , while compiling: select count(*) from airports 
```

本地 /assets/airports.db “似乎”被检测到并复制到 /data/data/mypackage/databases/data.db 作为“文件被发现”

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:27:02.933

在不使用 DBManager 类的情况下尝试它。

注释掉这一行...

```
DBManager dbManager =  new DBManager(this); 
```

...然后通过替换此行显式打开数据库...

```
SQLiteDatabase db = dbManager.getReadableDatabase(); 
```

...和...

```
SQLiteDatabase db = SQLiteDatabase.openDatabase(destPath, null, SQLiteDatabase.OPEN_READONLY); 
```

`assets`然后清除应用程序数据，以便从您的目录中重新复制数据库。

**编辑：**即使我的建议有效，它实际上只是一种解决方法，而您的问题的根源是这个......

```
String destPath = "/data/data/" + getPackageName() + "/databases/data.db"; 
```

您应该避免在 Android 中使用硬编码路径 - 它们可能适用于许多设备，但不能保证它们适用于所有设备，甚至适用于所有版本的 Android。

问题是您正在创建/将数据库复制到该路径，但 DBManager 类可能正在创建一个位于文件系统中不同路径上某处的空数据库。

要为所有设备和 Android 版本修复此问题，在复制数据库之前，我会使用...

```
SQLiteDatabase.openOrCreateDatabase("data.db", null) 
```

...创建一个“虚拟”（空）数据库。那我就叫...

```
getDatabasePath("data.db") 
```

...获得`data.db`. 然后，您可以在复制操作期间覆盖该数据库，从那时起，您可以使用扩展的类，`SQLiteOpenHelper`它将找到正确的数据库。

# php - 如何根据使用 mysql 和 php 输入的值插入重复值

> ID：15211009
> 
> 赞同：2
> 
> 时间：2013-03-04T20:59:07.283
> 
> 标签：php, mysql

我试图在我的标题上对其进行总结，但让我在下面更详细地向您解释我正在尝试完成的工作。

目前我将一个数组传递给我的查询并使用一个 foreach 将每个数组插入到我的数据库中，如下所示。

```
if(is_array($myArr)){
 foreach($myArr as $userID=> $email){
  $sql = "INSERT INTO userdata (userID, email) values ('$userID', '$email')";
  mysql_query($sql) or exit(mysql_error());
 }
} 
```

目前我的数组看起来如下

```
Array
(
[39] => sessa@test.com
[54] => sessa@test.com
[55] => sessa@test.com
[56] => sessa@test.com
[57] => mark@foo.com
[58] => mark@foo.com
[59] => mark@foo.com
[60] => mark@foo.com
[61] => sam@bar.com
[62] => sam@bar.com
[63] => sam@bar.com
[64] => sam@bar.com
) 
```

'$userID' 是 [39] 和 'email' 是..well 电子邮件。

这就是我的问题所在。

我想要实现的是在我在这个“url”列中调用“url”的新列中插入一个新的 id，我希望能够增加 1 并将相同的值添加到具有相同电子邮件的行中。

所以像这样。

```
UserID |    email        | url  
===============================
  39   |  sessa@test.com |  1   
  54   | sessa@test.com  |  1  
  55   | sessa@test.com  |  1  
  56   | sessa@test.com  |  1  
  57   | mark@foo.com    |  2  
  58   | mark@foo.com    |  2  
  59   | mark@foo.com    |  2   
  60   | mark@foo.com    |  2  
  61   | sam@bar.com     |  3  
  62   | sam@bar.com     |  3  
  63   | sam@bar.com     |  3  
  64   | sam@bar.com     |  3 
```

我希望这是有道理的。感谢您的阅读。永远感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:07:45.077

我会选择 ON DUPLICATE KEY；

确保您在电子邮件上有一个唯一索引。

```
if(is_array($myArr)){
 foreach($myArr as $userID=> $email){
  $sql = "INSERT INTO userdata (userID, email) values ('$userID', '$email') 
        ON DUPLICATE KEY UPDATE url=url+1";
  mysql_query($sql) or exit(mysql_error());
 }
} 
```

编辑：

好的，这可能是解决方案：

```
$data = array();
$ids = 1;

if(is_array($myArr)){
    foreach($myArr as $userID=> $email){

       $domain = substr(strstr($email,"@"),1);

        if (! isset($data[$domain]))
        {
            $data[$domain] = $ids;
            $ids ++;
        }

        $sql = "INSERT INTO userdata (userID, email,url) 
                VALUES ('$userID', '$email','".$data[$domain]."')";
        mysql_query($sql) or exit(mysql_error());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:16:17.423

您可以通过 1 个查询来组织它。

```
if(is_array($myArr)){
 foreach($myArr as $userID=> $email){
  $sql = "INSERT INTO `userdata` (`userID`, `email`, `url`) 
         select '$userID', '$email', count(`email`) +1 from `userdata` where `email` = '$email'";
  mysql_query($sql) or exit(mysql_error());
 }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T21:06:20.470

```
 if(is_array($myArr)) : 

foreach($myArr as $userID=> $email){

    $emails[] = $email;
}

$emails = array_unique($emails);

foreach($emails as $e){
    $counter = 0;
    foreach($myArr as $userID=> $email){

        if($email == $e){

            $sql = "INSERT INTO userdata (userID, email,url) values ('$userID', '$email','$counter')";
            $counter++;
        }
    }

}

endif; 
```

您可以使用它为所有插入创建一个 SQL 语句。

```
 if(is_array($myArr)) : 

    foreach($myArr as $userID=> $email){

        $emails[] = $email;
    }

    $emails = array_unique($emails);
    $sql = '';
            $counter = 1;
    foreach($emails as $e){

        foreach($myArr as $userID=> $email){

            if($email == $e){

                $sql .= "INSERT INTO userdata (userID, email,url) values ('$userID', '$email','$counter');";

            }
        }
        $counter++;
    }

    endif;

    mysql_query($sql) or exit(mysql_error()); 
```

SQL 输出

```
 INSERT INTO userdata (userID, email,url) values ('39', 'sessa@test.com','1');INSERT INTO userdata (userID, email,url) values ('54', 'sessa@test.com','1');INSERT INTO userdata (userID, email,url) values ('55', 'sessa@test.com','1');INSERT INTO userdata (userID, email,url) values ('56', 'sessa@test.com','1');INSERT INTO userdata (userID, email,url) values ('57', 'mark@foo.com','2');INSERT INTO userdata (userID, email,url) values ('58', 'mark@foo.com','2');INSERT INTO userdata (userID, email,url) values ('59', 'mark@foo.com','2');INSERT INTO userdata (userID, email,url) values ('60', 'mark@foo.com','2');INSERT INTO userdata (userID, email,url) values ('61', 'sam@bar.com','3');INSERT INTO userdata (userID, email,url) values ('62', 'sam@bar.com','3');INSERT INTO userdata (userID, email,url) values ('63', 'sam@bar.com','3');INSERT INTO userdata (userID, email,url) values ('64', 'sam@bar.com','3'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T21:10:09.693

如果您有足够的内存 - 您可以再创建一个数组数据结构并存储电子邮件和 ID。

例如，您可以在 for 循环中执行类似的操作...

```
$data = array();
$i = 0;

if(is_array($myArr)){
    foreach($myArr as $userID=> $email){
        $url_id = '';

        if (! isset($data[$email]))
        {
            $data[$email] = ++$i;
        }

        $url_id  = $data[$email];

        $sql = "INSERT INTO userdata (userID, email,url) values ('$userID', '$email','$url_id')";
        mysql_query($sql) or exit(mysql_error());
    }
} 
```

我不认为这是最有效的解决方案..但它应该工作..

# rapidminer - RapidMiner 按顺序排列多个过滤器

> ID：15211010
> 
> 赞同：0
> 
> 时间：2013-03-04T20:59:13.853
> 
> 标签：rapidminer

我是 RapidMiner 的新手...我想做的是我有一个包含 10 个文档的列表，我使用 ProcessDocuments 运算符（子任务）-> 标记化这些文档...结果是一个**10 x 800 的**示例集，有 10 行（每个文档一个）和 800 个属性（每个令牌一个）。

现在我想按长度过滤 800 个令牌，我再次使用 ProcessDocuments 运算符（子任务）-> FilterByLength**对由前一个 ProcessDocuments 运算符生成的世界列表**...结果是一个 800 乘 700 矩阵...800 来自 800 个令牌之前的 ProcessDocuments Operator 和 700 减少的令牌集。

我想要完成的是一个**10 x 700 的示例**集，我可以将其传递给 Kmeans 聚类算子。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:19:50.680

我不确定您为什么要使用两个“处理文档”运算符，因为您可以在第一个运算符中添加“令牌化”和“过滤令牌（按长度）”，这应该会产生您需要的内容。

这是一个小例子。

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<process version="5.3.005">
  <context>
    <input/>
    <output/>
    <macros/>
  </context>
  <operator activated="true" class="process" compatibility="5.3.005" expanded="true" name="Process">
    <process expanded="true">
      <operator activated="true" class="text:create_document" compatibility="5.3.000" expanded="true" height="60" name="Create Document" width="90" x="45" y="75">
        <parameter key="text" value="This is a test with a looooooooooong word"/>
      </operator>
      <operator activated="true" class="text:create_document" compatibility="5.3.000" expanded="true" height="60" name="Create Document (2)" width="90" x="45" y="165">
        <parameter key="text" value="Again a text which has anoooooooooooooother long word."/>
      </operator>
      <operator activated="true" class="text:process_documents" compatibility="5.3.000" expanded="true" height="112" name="Process Documents" width="90" x="313" y="75">
        <process expanded="true">
          <operator activated="true" class="text:tokenize" compatibility="5.3.000" expanded="true" height="60" name="Tokenize" width="90" x="45" y="30"/>
          <operator activated="true" class="text:filter_by_length" compatibility="5.3.000" expanded="true" height="60" name="Filter Tokens (by Length)" width="90" x="179" y="30">
            <parameter key="max_chars" value="10"/>
          </operator>
          <connect from_port="document" to_op="Tokenize" to_port="document"/>
          <connect from_op="Tokenize" from_port="document" to_op="Filter Tokens (by Length)" to_port="document"/>
          <connect from_op="Filter Tokens (by Length)" from_port="document" to_port="document 1"/>
          <portSpacing port="source_document" spacing="0"/>
          <portSpacing port="sink_document 1" spacing="0"/>
          <portSpacing port="sink_document 2" spacing="0"/>
        </process>
      </operator>
      <operator activated="true" class="k_means" compatibility="5.3.005" expanded="true" height="76" name="Clustering" width="90" x="447" y="75"/>
      <connect from_op="Create Document" from_port="output" to_op="Process Documents" to_port="documents 1"/>
      <connect from_op="Create Document (2)" from_port="output" to_op="Process Documents" to_port="documents 2"/>
      <connect from_op="Process Documents" from_port="example set" to_op="Clustering" to_port="example set"/>
      <connect from_op="Clustering" from_port="cluster model" to_port="result 1"/>
      <portSpacing port="source_input 1" spacing="0"/>
      <portSpacing port="sink_result 1" spacing="0"/>
      <portSpacing port="sink_result 2" spacing="0"/>
    </process>
  </operator>
</process> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T19:42:24.020

我倾向于同意已经提供的答案；看起来它解决了问题，但是您可以执行以下操作。

*   使用 WordList to Data 运算符将 800 字列表转换为示例集。
*   使用 Nominal to Text 运算符将多项式单词属性的类型更改为文本。
*   对文本属性使用 Process Documents from Data 运算符并在其中按长度过滤。

[我在这里](http://rapidminernotes.blogspot.co.uk/2013/04/finding-needles-in-text-haystacks.html)做了一些类似的东西

700字的限制很难控制。在我看来，按长度排序的单词列表不太可能在 700 处方便地截断。

# python - Python pexpect 返回命令和命令的输出

> ID：15211011
> 
> 赞同：2
> 
> 时间：2013-03-04T20:59:21.263
> 
> 标签：python, ssh, python-2.7, stdout, pexpect

我想连接到运行 CLISH 的服务器，在给出密码提示时提供密码（有效），然后发出“shell”命令将我撞到 bash shell（有效），然后测试文件是否存在如果它丢失，则打印“true”，如果它存在（有效），则打印“”（空字符串）。

不起作用的是我正在使用“pexpect.before”读回我的脚本。我已经要求 pexpect 期待基本提示，然后给我“之前”，据我了解：“在提示匹配之前，您在屏幕上看到了什么？” 我不仅按预期获得了“true”或“”（空字符串），而且还获得了我发出的用于测试文件是否存在的命令。

例如，如果我直接通过 SSH 连接到机器，我会这样做： 密码：

我的脚本返回的是命令和响应（问题和答案）：

`[ ! -f '/etc/logrotate.d/nginx' ] && echo 'true'`

`true`

我只想要响应，要么是“真”，要么是“”。我得到了响应，但我也得到了发出的命令。

你能看出我做错了什么吗？请帮忙！我想继续使用 pexpect，因为我对 SSH 会话有更复杂的“期望”。

这是我的代码：

```
def connection(cmd):
    msg_newkey = 'Are you sure you want to continue connecting'
    p=pexpect.spawn('ssh '+user+'@'+host)
    msg = '''Super long welcome message containing your canned warning message, etc.
          myuser@'''+myhost+''''s password:'''
    i=p.expect([msg_newkey,'password:',pexpect.EOF])
    if i==0:
        print "Accepting key."
        p.sendline('yes')
        i=p.expect([msg_newkey,'password:',pexpect.EOF])
    if i==1:
        print "Supplying password"
        p.sendline(passwd)
    elif i==2:
        if "No route to host" in p.before:
            return p.before
        else:
            pass    # Add no functionality, just saying "move on"
    i=p.expect(['MYCLISHPROMPT>',pexpect.EOF])
    if i==0:
            p.sendline('shell')
    i=p.expect(['.*@.*\$',pexpect.EOF])
    if i==0:
            p.sendline(cmd)
    p.expect(['myuser@myhost:',pexpect.EOF])
    return p.before

 def look_for_file(step, filename, mytest):
    cmd = "[ ! -f '"+filename+"' ] && echo '"+mytest+"'"
    results = connection(cmd)
    print "***"+str(result)+"***"
    assert (results == '' or results == 0), "Step failed!  Error: "+results 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T14:47:08.713

有一个函数`setecho`（它是 pair `getecho`）应该控制 sendline 中的字符串是否会被回显。

```
setecho(self, state)
    This sets the terminal echo mode on or off. Note that anything the
    child sent before the echo will be lost, so you should be sure that
    your input buffer is empty before you call setecho(). 
```

但是，这显然不适用于所有情况，您需要使用一些解决方法。一个是在 bash 中打开 echo ，如[this answer](https://stackoverflow.com/questions/13464759)。另一个是使用 pexpect 的函数`readline`或`readlines`读取输出并丢弃与给定命令相呼应的第一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-21T22:20:26.640

我在需要将 pexpect 日志设置为 sys.stdout 的脚本中遇到了这个问题，如下所示：

```
 shell = pexpect.spawn("bash")
    shell.logfile = sys.stdout 
```

我在这里尝试了其他答案中建议的解决方案，但没有成功；`sendline()`无论如何，传递给的字符串都会打印到日志中。

但是，我发现暂时禁用 pexpect 日志似乎可以解决问题：

```
 shell.logfile = None
    shell.sendline(MY_STRING)
    shell.logfile = sys.stdout 
```

# matlab - 使用独立分量分析 ICA 进行图像分类

> ID：15211012
> 
> 赞同：0
> 
> 时间：2013-03-04T20:59:22.210
> 
> 标签：matlab, image-processing, signal-processing

我正在开发一个系统来对一组图像进行分类。我有 700 张图像用于训练和 300 张图像用于测试。我对每个图像应用了一个带有初始混合矩阵 A 的 FastICA 过程。我的系统的目标是将测试集中的每个图像与训练集中的每个图像进行比较，并使用独立组件从训练集中获得最近的图像。

我的问题是如何使用独立组件进行比较。我已经尝试过训练集中每个图像的独立分量与测试集中的欧几里得距离，但它不起作用。

我正在使用 MATLAB 和[FastICA](http://research.ics.aalto.fi/ica/fastica/)实现。

谢谢

# ruby-on-rails - Rails Parent.find 方法返回 Child 类型的对象

> ID：15211025
> 
> 赞同：1
> 
> 时间：2013-03-04T20:59:48.397
> 
> 标签：ruby-on-rails, inheritance, model, find

我看到了一个有趣的行为，并希望得到一些见解。

我有两个模型：个人和用户。用户继承自 Person。没有用户数据库表，只有人。

当我搜索使用 Person 的 find 模型创建的用户时，我希望看到返回的 person 类型的对象。但它的类型是用户。

```
@person = Person.find(params[:id])
@person.class 
# outputs 'User' 
```

有人可以解释为什么它不会返回一个人对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:04:40.427

这是期望的行为。找到的人员行的`type`列包含值“用户”。因此，返回的类型`User`也是 。

请记住，它`User`也是一个`Person`，因此您可以将任何`User`实例视为一个`Person`实例。

# jquery - fancybox：放大/缩小 googlemaps

> ID：15211031
> 
> 赞同：1
> 
> 时间：2013-03-04T21:00:05.843
> 
> 标签：jquery, google-maps, iframe, fancybox, fancybox-2

我使用fancybox（[http://fancyapps.com/fancybox/](http://fancyapps.com/fancybox/)）在google-maps上显示一些地方，其中一个例子如下..

```
<script type="text/javascript"> 
    $(document).ready(function() {
    $('.fancybox-media').fancybox({
        openEffect  : 'none',
        closeEffect : 'none',
        helpers : {
            media : {}
        }
    });
    });        
</script> 
```

和 html

```
Google maps
<ul>
        <li><a class="fancybox-media" href="http://maps.google.com/maps?q=Eiffel+Tower,+Avenue+Gustave+Eiffel,+Paris,+France&t=h&z=17">Search results</a></li>
        <li><a class="fancybox-media" href="http://maps.google.com/?ll=48.85796,2.295231&spn=0.003833,0.010568&t=h&z=17">Direct link</a></li>
        <li><a class="fancybox-media" href="http://maps.google.com/?ll=48.859463,2.292626&spn=0.000965,0.002642&t=m&z=19&layer=c&cbll=48.859524,2.292532&panoid=YJ0lq28OOy3VT2IqIuVY0g&cbp=12,151.58,,0,-15.56">Street view</a></li>
</ul> 
```

但是我可以用鼠标滚轮放大/缩小，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:47:18.790

当您将谷歌地图嵌入`iframe`（将它们嵌入网站的推荐方式）时，您无法使用鼠标滚轮放大/缩小地图（尽管您可以缩放街景图像）......这将是正常的行为。

检查这个**[JSFIDDLE](http://jsfiddle.net/zTgKJ/)**作为纯 html 的例子`iframe`。

当您在 fancybox 中显示 Google 地图时，它们实际上被包裹在一个 中`iframe`，因此您也不能使用鼠标滚轮放大或缩小....所以关于您的问题，我认为这是不可能的。

这不是花式问题，而是 html`iframe`限制。

**编辑**：

谷歌地图的融合表可以使用鼠标滚轮放大/缩小......在这种情况下，这些地图应该使用fancybox`iframe`模式打开，如：

```
$(".fancybox").fancybox({
    type: "iframe"
}); 
```

见**[JSFIDDLE](http://jsfiddle.net/8SM3Q/)**

**我的结论**：这完全取决于内容格式。Fancybox 没有对 html 中的内容设置任何限制`iframe`：在常规 html 中可以做的任何事情`iframe`，都是在 fancybox ( `iframe`mode) 中可以做的。

# html - 在内容旁边放置一个块

> ID：15211033
> 
> 赞同：0
> 
> 时间：2013-03-04T21:00:17.640
> 
> 标签：html, css

我将显示`title`页面的内部内容。`title`是一个 php 函数`<?php the_title(); ?>`，而 content 是另一个函数`<?php the_content(); ?>`。

正如您在图片中看到的，这里的标题是“Android 手机中最好的小部件”，内容是它旁边的内容。

我如何在内容区域之间定位这样的`div`元素来显示？`title`

图片网址：http: [//i.stack.imgur.com/lh5iC.jpg](http://i.stack.imgur.com/lh5iC.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:45:01.310

所以你所要求的不是那么可行，浮动是根据它们在页面中的顺序计算的，所以如果没有实际将标题*放在段落之间，就无法**在*一大段文本中获取标题，我知道这是在你的情况下是不可能的。但是您不能将元素浮动到比实际位置更高或更低的位置。

 *这里最接近的解决方案是使用简单的 css 将标题浮动到左侧，这会将标题放在文本的顶部，而不是中间。

```
h1 {
float: left;
display: block;
width: 250px;
} 
```

在这两种情况下，我都创建了一个带有结果的[jsFiddle](http://jsfiddle.net/2aV8u/)。

ps：我知道你说没有 PHP 但如果你真的想要你所要求的，你可以使用[excerpt](http://codex.wordpress.org/Function_Reference/the_excerpt)功能（因为我知道你正在使用 WP），并将文章分开`excerpt()`，`content()`这样你就可以将标题放在两者之间. 只是一个想法。*

# java - 连接其他数据库 postgresql JDBC

> ID：15211038
> 
> 赞同：0
> 
> 时间：2013-03-04T21:00:46.937
> 
> 标签：java, postgresql, jdbc, psql

我正在开发可以连接到 PostgreSQL 多个数据库的 Java 程序。当我想重新连接到同一服务器上的其他数据库时会出现问题。我正在使用 JDBC postgresql 驱动程序，每当我尝试关闭旧连接并创建新连接时，都会出现异常：

`org.postgresql.util.PSQLException: Something unusual has occured to cause the driver to fail. Please report this exception.`

有没有办法重新连接到其他数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:03:09.943

我建议您在需要时创建连接，并在尽可能窄的范围内完成时关闭它。

我还建议您设置连接池，为您可能连接到的每个数据库设置一个连接池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:47:45.207

我没有注意到第一个下还有另一个例外。第二个例外是真正的问题。我在主线程上运行重新连接。把它放在自己的线程中解决了这个问题。

# javascript - 使用 setInterval 测试条件，找到时清除间隔......还有其他选择吗？

> ID：15211045
> 
> 赞同：0
> 
> 时间：2013-03-04T21:01:06.363
> 
> 标签：javascript, jquery

我需要的是让 javascript 继续检查条件（类似于 while 循环）。我通过执行 setInterval 来执行此操作，如果满足条件，我会清除然后退出的间隔，或者如果它已经运行 X 次，如果我有以下情况，我将其设置为 100。

我不太喜欢这个，我把它放在一起是因为它有效。我正在检查来自服务器的数据，这很慢。我想要一个替代方案的主要原因是我有一个在 AJAX 调用启动时运行的加载 gif，我将把这段代码粘贴到底部只是为了显示。它运行缓慢，所以我相信当 javascript 在间隔中时，它无法渲染 gif，所以运动图像会停止。

有人知道做我想做的事情的替代方法吗？我希望这是有道理的？

```
function checkCondition(name,action){
    var timesRun = 0;
    var success = false;

        var interval = setInterval(function() {
            timesRun++;
            var container = {};
            container = mapSystem["desktop"];

            if(action === "delete"){
                var isExisting = name in container ;
                if ( !isExisting || (timesRun === 100)) {
                    //break out of this interval
                    clearInterval(interval);
                    renderCheckList();
                    success = true;
                } else {
                    // Update mapNodeData with fresh data
                    updateData('desktop', false); // Just updates data
                }
            }
        }, 2000);
}

// Code that I have to render a loading GIF. Works great but seems 
// to stop during the interval
$('#loading').hide().ajaxStart(function() {
                $(this).show();
             }).ajaxStop(function() {
                $(this).hide();
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:07:43.963

如果您使用[.ajax()](http://api.jquery.com/jQuery.ajax/)而不是 ajaxStart，您可以设置一个函数在操作完成时执行：

从文档：

> 完全的
> 
> 类型：函数（jqXHR jqXHR，字符串 textStatus ）
> 
> 请求完成时要调用的函数（在执行成功和错误回调之后）。该函数获得两个参数：jqXHR（在 jQuery 1.4.x 中，XMLHTTPRequest）对象和一个对请求状态进行分类的字符串（“成功”、“未修改”、“错误”、“超时”、“中止”或“解析器错误”）。从 jQuery 1.5 开始，完整的设置可以接受一个函数数组。每个函数都会被依次调用。这是一个 Ajax 事件。

您还可以使用成功和错误属性为成功或失败指定不同的函数。

# linq - 从存储在数据库字段中的数组中的列表中查找项目

> ID：15211049
> 
> 赞同：2
> 
> 时间：2013-03-04T21:01:19.017
> 
> 标签：linq, entity-framework

我有一个遗留数据库，它的数据元素以逗号分隔的列表形式存储在单个数据库字段中。（我没有设计那个，我只是坚持下去。）

我有一个字符串列表，我想与 DB 字段中“数组”中的任何单个值匹配，但不确定如何在 Linq 中执行此操作。

我的列表：

```
List<string> items= new List<string>();
items.Add("Item1");  
items.Add("Item2"); 
```

数据库字段“产品”将包含如下数据：

```
"Item1,Item3,Item4"
"Item3,Item5,Item6"
"Item2,Item7,Item6"
"Item1,Item2"
"Item1" 
```

我第一次通过 Linq 查询是：

```
var results = (from o in Order
.Where(p=> items.Contains(p.Products) 
```

但我知道那是行不通的。因为它只会返回只包含“Item1”或“Item2”的记录。因此，对于上面的示例数据，它将返回 0 条记录。我需要让它返回两条记录。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:06:32.223

搜索逗号分隔列表有一个简单的聪明技巧。`,`首先，在目标值（产品列表）和搜索值的开头和结尾添加额外内容。然后搜索那个确切的字符串。例如，您将`,Item1,Item3,Item4,`搜索`,Item1,`. 这样做的目的是防止误报，即`Item12,Item3`找到 的匹配`Item1`项，同时允许正确找到列表开头/结尾的项目。

然后，您可以使用 LINQ`.Any`方法检查列表中的任何项目是否与产品列表匹配，如下所示：

```
var results = (from o in Order
    .Where(o => items.Any(i => (","+o.Products+",").Contains(","+i+","))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:05:02.640

一种方法是解析`Products`字段中的列表：

```
var results = (from o in Order
    .Where(o => items.Any(i => o.Products.Split(',').Contains(i)) 
```

但这会为每条记录多次解析字符串。您可以尝试拉回所有记录，解析每条记录一次，然后进行比较：

```
var results = from o in Order
              let prods = o.Products.Split(',')
              where items.Any(i => prods.Contains(i))
              select o; 
```

# datetime - NodaTime 中的 System.TimeZoneInfo.IsDaylightSavingTime 等效项是什么？

> ID：15211052
> 
> 赞同：8
> 
> 时间：2013-03-04T21:01:25.797
> 
> 标签：datetime, timezone, dst, nodatime

System.TimeZoneInfo 有一个名为[IsDaylightSavingTime](http://msdn.microsoft.com/en-us/library/bb460642%28v=vs.100%29.aspx)的方法，该方法接受一个 DateTime 对象，如果指定的日期时间在该时区的 DST 中，则返回 true。[NodaTime](https://code.google.com/p/noda-time/)中是否有等效的功能或其他方式来实现相同的结果？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T23:47:53.267

您可以从`ZoneInterval`. 这是一个有用的扩展方法。

```
public static bool IsDaylightSavingsTime(this ZonedDateTime zonedDateTime)
{
    var instant = zonedDateTime.ToInstant();
    var zoneInterval = zonedDateTime.Zone.GetZoneInterval(instant);
    return zoneInterval.Savings != Offset.Zero;
} 
```

现在你可以这样做：

```
zdt.IsDaylightSavingsTime(); 
```

如果你没有 a `ZonedDateTime`，你可以从一个`DateTimeZone`plus `Instant`或 a中得到一个`LocalDateTime`。或者您可以按摩此扩展方法以将其作为参数。

**更新：** 此功能现在包含在 Noda Time v1.3 及更高版本中，因此您不再需要自己编写扩展方法。

# jquery - 书签插件，重叠图像的问题

> ID：15211057
> 
> 赞同：2
> 
> 时间：2013-03-04T21:01:42.430
> 
> 标签：jquery, css, wookmark

我正在使用 wookmark jquery 插件，它适用于除 safari 之外的所有浏览器，无论是在 PC 还是 Mac 上，图像似乎相互重叠。我该如何解决？

提前感谢亚历克斯

这是插件的代码：

```
$.fn.wookmark = function(options) {

  if(!this.wookmarkOptions) {
    this.wookmarkOptions = $.extend( {
        container: $('body'),
        offset: 2,
        autoResize: false,
        itemWidth: $(this[0]).outerWidth(),
        resizeDelay: 50
      }, options);
  } else if(options) {
    this.wookmarkOptions = $.extend(this.wookmarkOptions, options);
  }

  // Layout variables.
  if(!this.wookmarkColumns) {
    this.wookmarkColumns = null;
    this.wookmarkContainerWidth = null;
  }

  // Main layout function.
  this.wookmarkLayout = function() {
    // Calculate basic layout parameters.
    var columnWidth = this.wookmarkOptions.itemWidth + this.wookmarkOptions.offset;
    var containerWidth = this.wookmarkOptions.container.width();
    var columns = Math.floor((containerWidth+this.wookmarkOptions.offset)/columnWidth);
    var offset = Math.round((containerWidth - (columns*columnWidth-this.wookmarkOptions.offset))/2);

    // If container and column count hasn't changed, we can only update the columns.
    var bottom = 0;
    if(this.wookmarkColumns != null && this.wookmarkColumns.length == columns) {
      bottom = this.wookmarkLayoutColumns(columnWidth, offset);
    } else {
      bottom = this.wookmarkLayoutFull(columnWidth, columns, offset);
    }

    // Set container height to height of the grid.
    this.wookmarkOptions.container.css('height', bottom+'px');
  };

  /**
   * Perform a full layout update.
   */
  this.wookmarkLayoutFull = function(columnWidth, columns, offset) {
    // Prepare Array to store height of columns.
    var heights = [];
    while(heights.length < columns) {
      heights.push(0);
    }

    // Store column data.
    this.wookmarkColumns = [];
    while(this.wookmarkColumns.length < columns) {
      this.wookmarkColumns.push([]);
    }

    // Loop over items.
    var item, top, left, i=0, k=0, length=this.length, shortest=null, shortestIndex=null, bottom = 0;
    for(; i<length; i++ ) {
      item = $(this[i]);

      // Find the shortest column.
      shortest = null;
      shortestIndex = 0;
      for(k=0; k<columns; k++) {
        if(shortest == null || heights[k] < shortest) {
          shortest = heights[k];
          shortestIndex = k;
        }
      }

      // Postion the item.
      item.css({
        position: 'absolute',
        top: shortest+'px',
        left: (shortestIndex*columnWidth + offset)+'px'
      });

      // Update column height.
      heights[shortestIndex] = shortest + item.outerHeight() + this.wookmarkOptions.offset;
      bottom = Math.max(bottom, heights[shortestIndex]);

      this.wookmarkColumns[shortestIndex].push(item);
    }

    return bottom;
  };

  /**
   * This layout function only updates the vertical position of the 
   * existing column assignments.
   */
  this.wookmarkLayoutColumns = function(columnWidth, offset) {
    var heights = [];
    while(heights.length < this.wookmarkColumns.length) {
      heights.push(0);
    }

    var i=0, length = this.wookmarkColumns.length, column;
    var k=0, kLength, item;
    var bottom = 0;
    for(; i<length; i++) {
      column = this.wookmarkColumns[i];
      kLength = column.length;
      for(k=0; k<kLength; k++) {
        item = column[k];
        item.css({
          left: (i*columnWidth + offset)+'px',
          top: heights[i]+'px'
        });
        heights[i] += item.outerHeight() + this.wookmarkOptions.offset;

        bottom = Math.max(bottom, heights[i]);
      }
    }

    return bottom;
  };

  // Listen to resize event if requested.
  this.wookmarkResizeTimer = null;
  if(!this.wookmarkResizeMethod) {
    this.wookmarkResizeMethod = null;
  }
  if(this.wookmarkOptions.autoResize) {
    // This timer ensures that layout is not continuously called as window is being dragged.
    this.wookmarkOnResize = function(event) {
      if(this.wookmarkResizeTimer) {
        clearTimeout(this.wookmarkResizeTimer);
      }
      this.wookmarkResizeTimer = setTimeout($.proxy(this.wookmarkLayout, this), this.wookmarkOptions.resizeDelay)
    };

    // Bind event listener.
    if(!this.wookmarkResizeMethod) {
      this.wookmarkResizeMethod = $.proxy(this.wookmarkOnResize, this);
    }
    $(window).resize(this.wookmarkResizeMethod);
  };

  /**
   * Clear event listeners and time outs.
   */
  this.wookmarkClear = function() {
    if(this.wookmarkResizeTimer) {
      clearTimeout(this.wookmarkResizeTimer);
      this.wookmarkResizeTimer = null;
    }
    if(this.wookmarkResizeMethod) {
      $(window).unbind('resize', this.wookmarkResizeMethod);
    }
  };

  // Apply layout
  this.wookmarkLayout();

  // Display items (if hidden).
  this.show();
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-07T22:20:25.467

这里迟到了，但对于未来有问题的开发人员，这可以帮助你....

如果图像加载缓慢，可能会导致 Wookmark 在元素大小方面出现问题。解决这个问题的一种简单方法是像上面提到的 byroncorrales 那样重新调用处理程序。但是，这样做并不能确保所有内容都已加载。我们希望等待 DOM 完全加载，然后再次调用处理程序。

所以最后添加这个简单的 jQuery。

```
$(window).load(function() {
    handler.wookmark(options);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T22:27:43.183

尝试调用 handler.wookmark 两次

```
 $(document).ready(function() {
    var options = {
      autoResize: true, // This will auto-update the layout when the browser window is resized.
      container: $('#tiles'), // Optional, used for some extra CSS styling
      offset: 10, // Optional, the distance between grid items
      flexibleWidth: 210 // Optional, the maximum width of a grid item
    };
    var handler = $('#tiles li');
    $('#tiles').imagesLoaded(function() {
      // Prepare layout options.
      // Get a reference to your grid items.
      // Call the layout function.
      handler.wookmark(options);
    });
    handler.wookmark(options);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-19T19:21:29.877

或者稍后再刷新 - 只有这样它才对我有用（我正在加载图像和视频）

```
$(window).load(function() {
  setTimeout(function() {
    handler.wookmark(options);
  }, 500);
}); 
```

# ios - iOS 套接字：与 Maya 的通信

> ID：15211061
> 
> 赞同：1
> 
> 时间：2013-03-04T21:01:49.697
> 
> 标签：ios, sockets, maya

使用这个非常有用的[教程](http://www.raywenderlich.com/3932/how-to-create-a-socket-based-iphone-app-and-server)，我已经能够对 iOS 模拟器和 Maya 之间的套接字通信进行测试（[视频](https://vimeo.com/60357554)）。这与模拟器和 localhost 配合得很好。但是，当我通过相同的无线网络在我的设备上对其进行测试时，iOS 应用程序只是挂起，与 Maya 没有连接（连接后，会显示一些“提示”消息）。

我特别是 iOS 编程和套接字编程的新手，但我想知道我是否遗漏了什么。这是我按下“连接”按钮调用的方法：

```
- (void) initNetworkCommunication {

    //assign text inputs to variables
    self.ipAddress = self.inputIPAddress.text;
    self.portNumber = [self.inputPortNumber.text intValue];

    //create streams and use variables to populate connection method
    CFReadStreamRef readStream;
    CFWriteStreamRef writeStream;    
    CFStreamCreatePairWithSocketToHost(NULL, (__bridge CFStringRef)(self.ipAddress), self.portNumber, &readStream, &writeStream);
    inputStream = (__bridge NSInputStream *)readStream;
    outputStream = (__bridge NSOutputStream *)writeStream;

    [inputStream setDelegate:self];
    [outputStream setDelegate:self];

    [inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

    [inputStream open];
    [outputStream open];

    //send initial message to Maya
    NSString *initResponse = [NSString stringWithFormat:@"cmds.headsUpMessage('connected to iPhone')"];
    NSData *initData = [[NSData alloc] initWithData:[initResponse dataUsingEncoding:NSASCIIStringEncoding]];
    [outputStream write:[initData bytes] maxLength:[initData length]];

    //need some error checking or timeout mechanism
} 
```

就像我说的那样，它在 localhost 上就像一个魅力，但在无线网络上失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T05:48:54.180

好的，通过挖掘其他人的 python 脚本以在 Maya 中创建 commandPort 找到了我自己的答案。它实际上根本不是由于 iOS 代码。事实证明，在 Maya 中，我不仅需要使用端口号，还需要使用 ip 地址来创建 commandPort。我的错误是我假设 commandPort 知道本地 IP 地址或不在乎。显然它在乎。

之前（简化代码）：

```
cmds.commandPort (n=':6328', stp='python') 
```

后：

```
cmds.commandPort (n='192.168.2.7:6328', stp='python') 
```

# angularjs - 当通过 ng-click 更新支持模型时，如何刷新 ng-repeat 列表？

> ID：15211065
> 
> 赞同：0
> 
> 时间：2013-03-04T21:02:25.720
> 
> 标签：angularjs, angularjs-ng-repeat

我对 AngularJS 相当陌生，所以我认为这将是关于混淆范围的事情。

当我从 ng-click 锚链接将新项目推送到服务支持模型时，我正在尝试获取一个 ng-repeat 列表来监视范围内的服务以进行更新。

一个失败的小提琴示例在这里：http: [//jsfiddle.net/znFwY/](http://jsfiddle.net/znFwY/)

JS：

```
'use strict';

angular.module('myApp', [])
    .factory('Order', function () {
        return {
            packages: {
                theList: [],
                list: function () {
                    return this.theList;
                },
                push: function (p) {
                    if (p === undefined || !!this.theList[p.title]) return;
                    this.theList[p.title] = p;
                    console.log('pushed ' + p.title);
                },
                contains: function (p) {
                    return  !!this.theList[p.title];
                },
                print: function () {
                    console.log(this.theList);
                }
            }
        }
    })
    .controller('AppCtrl', function ($scope, $http, $location, Order) {
        $scope.order = Order;
        $scope.data = {
            packages: [
                {title: 'one'},
                {title: 'two'},
                {title: 'three'},
            ]
        };
    })
; 
```

HTML：

```
<div ng-app="myApp">
    <div ng-controller="AppCtrl">

        <ul id="package-list">
            <li ng-repeat="package in data.packages | orderBy:package.order">
                <a ng-click="order.packages.push(package)" ng-class="{selected: order.packages.contains(package)}">{{package.title}}</a>
            </li>
        </ul>

        <ul id="basket-list">
            <li ng-repeat="package in order.packages.list() | orderBy:package.order"> {{package.title}}</li>
        </ul>

        <a ng-click="order.packages.print()">print list</a>
    </div>
</div> 
```

谢谢

# actionscript-3 - 可拖动对象与复杂对象碰撞检测的最佳方法

> ID：15211066
> 
> 赞同：0
> 
> 时间：2013-03-04T21:02:29.200
> 
> 标签：actionscript-3, flash

我很难弄清楚可拖动对象具有多个边界的对象。HitTest 不起作用，因为当快速拖动时，对象将在 HitTest 触发之前重叠。我想知道是否有更有效的方法来弄清楚这种交互。

我将尝试存储每个矩形 x、y、宽度、高度，然后循环遍历这些矩形，以确定对象是否已触摸并阻止玩家朝该方向拖动。

![这是作为绘图的示例。](../Images/2fb6d208084dae74f970fddb8260134f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:05:06.863

因为您试图检测高速发生的碰撞，所以您需要使用某种形式的扫描多边形碰撞检测。在前一帧和最后一帧之间仅一次采样碰撞总是有失败的机会。

查看扫描碰撞检测的简要说明： [http ://howlingmoonsoftware.com/wordpress/?p=300](http://howlingmoonsoftware.com/wordpress/?p=300)

或者只是搜索“扫描碰撞检测”

如果您在游戏中执行此操作，您可能还会发现使用 Box2D 之类的库将是解决该问题的一个有价值的解决方案。在 Box2D 用语中，您想要的是连续的碰撞检测。 [http://www.box2d.org/manual.html](http://www.box2d.org/manual.html)

# arrays - Perl 问题将数据放入数组引用（使用 perl URI）

> ID：15211067
> 
> 赞同：0
> 
> 时间：2013-03-04T21:02:35.410
> 
> 标签：arrays, perl, multidimensional-array, uri, data-dumper

**我有以下代码：**

```
#!usr/bin/perl
use strict;
use warnings;

use URI qw( );

my @insert_words = qw( HELLO );

my $newURLs;
while ( my $baseURL = <DATA>) {
   chomp $baseURL;
   my $url = URI->new($baseURL);
   my $path = $url->path();

for (@insert_words) {
  # Use package vars to communicate with /(?{})/ blocks.
  local our $insert_word = $_;
  local our @paths;
  $path =~ m{
     ^(.*[/])([^/]*)((?:[/].*)?)\z
     (?{ 
        push @paths, "$1$insert_word$2$3";
        if (length($2)) {
           push @paths, "$1$insert_word$3";
           push @paths, "$1$2$insert_word$3";
        }
     })
     (?!)
  }x;

  for (@paths) {
     $url->path($_);
     print "$url\n";  #THIS PRINTS THE CORRECT URLS I WANT IN THE ARRAY REF
     push( @{ $newURLs->{$baseURL} }, $url );  #TO PUT EACH URL INTO AN ARRAYREF BUT ITS NOT WORKING
  }
 }
}

print "\n";               #for testing only
print Dumper($newURLs);   #for testing only
print "\n";               #for testing only

__DATA__
http://www.stackoverflow.com/dog/cat/rabbit/
http://www.superuser.co.uk/dog/cat/rabbit/hamster/
http://10.15.16.17/dog/cat/rabbit/ 
```

**我遇到的问题：**

当我`print "$url\n";`按照上面的代码所示执行操作时，它会打印我想要放入数组 ref 的正确 url，但是当我这样做时，`push( @{ $newURLs->{$baseURL} }, $url );`我会在数据结构中得到以下内容：

```
$VAR1 = {
      'http://www.stackoverflow.com/dog/cat/rabbit/' => [
                                                          bless( do{\(my $o = 'http://www.stackoverflow.com/dogHELLO/cat/rabbit/')}, 'URI::http' ),
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0],
                                                          $VAR1->{'http://www.stackoverflow.com/dog/cat/rabbit/'}[0]
                                                        ], 
```

**当我应该得到的是以下**

```
$VAR1 = {
      'http://www.stackoverflow.com/dog/cat/rabbit/' => [
                         http://www.stackoverflow.com/dog/cat/rabbit/HELLO
                         http://www.stackoverflow.com/dog/cat/HELLOrabbit/
                         http://www.stackoverflow.com/dog/cat/HELLO/
                         http://www.stackoverflow.com/dog/cat/rabbitHELLO/
                         http://www.stackoverflow.com/dog/HELLOcat/rabbit/
                         http://www.stackoverflow.com/dog/HELLO/rabbit/
                         http://www.stackoverflow.com/dog/catHELLO/rabbit/
                         http://www.stackoverflow.com/HELLOdog/cat/rabbit/
                         http://www.stackoverflow.com/HELLO/cat/rabbit/
                         http://www.stackoverflow.com/dogHELLO/cat/rabbit/
                         ], 
```

**我忽略或做错了什么明显的事情吗？**非常感谢您对此的帮助，非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:08:04.737

尝试

```
push( @{ $newURLs->{$baseURL} }, "".$url ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:10:07.670

$url 是一个对象。为了得到它的字符串化，你可以让它插值：

```
 push @{ $newURLs->{$baseURL} }, "$url"; 
```

或调用`as_string`方法：

```
push @{ $newURLs->{$baseURL} }, $url->as_string; 
```

# php - PHP 是否处理 $_GET 和 $_POST 中变量的字符编码？(PHP 5.4)

> ID：15211069
> 
> 赞同：4
> 
> 时间：2013-03-04T21:02:35.927
> 
> 标签：php, character-encoding, http-post, query-string, http-get

我的脚本是用 UTF-8 编写的，它使用的 MySQL 数据库表具有排序规则 utf8_unicode_ci。现在，如果我想将`$_GET`/`$_POST`中的字符串与脚本/数据库中的“内部”字符串进行比较，甚至将某些内容放入数据库中，我是否必须检查/修复变量的编码，或者 PHP 是否已经为我做到了？

如果是前者，我可以在脚本开头简单地执行以下操作吗？

```
function inputToUtf8($string) {
  $detectedEncoding = mb_detect_encoding($string, 'UTF-8,ISO-8859-1', true);
  if ($detectedEncoding == 'UTF-8') {
    return $string;
  } elseif ($detectedEncoding == 'ISO-8859-1') {
    return utf8_encode($string);
  }
  throw new Exception('Invalid character encoding detected.');
}

foreach ($_GET as &$v) $v = inputToUtf8($v); unset($v);
foreach ($_POST as &$v) $v = inputToUtf8($v); unset($v); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:05:45.170

PHP 不会为您这样做，但客户端浏览器通常会这样做。以您的 HTML 页面所在的编码发送 GET/POST 数据是正常的，因此如果您为 HTML 页面正确指定了字符编码，浏览器应该并且通常也会使用相同的编码。

当然，确定比假设要好——至少如果你需要确定的话。

编辑：为了明确这一点 - 通过确保我的意思是过滤掉与您期望的字符集不匹配的字符。您应该一次只设置、期望和支持一个字符集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:44:29.770

我建议不要检测编码，因为：

*   所有正常工作的 Web 浏览器都以与您的页面相同的编码发送数据。没有例外。
*   检测编码不是 100% 精确的。一个字符串可以（并且通常是）在多种编码中有效，因此可能会检测到错误的编码并且转换会造成混乱。

# mysql - 如何在 iOS 应用中存储/使用完整的英语词典？

> ID：15211070
> 
> 赞同：2
> 
> 时间：2013-03-04T21:02:36.950
> 
> 标签：mysql, ios, objective-c, xcode, dictionary

我读过自 iOS5 以来，开发人员可以访问内置的单词字典，如拼写检查器使用的（尽管我不确定这是一个“完整的”字典），并且我已经看到 Mac OSC 获取给定定义的示例带有 UIReferenceLibraryViewController 的词

我希望在我正在处理的项目中访问完整的英语词典（随机词），但我不确定这是否可以使用 iOS 的内置词典来完成（如果可以，如何？）或以某种方式与应用程序捆绑在一起（XML）或仅使用 mySQL 数据库。

如果可能的话，我更愿意弄清楚如何做到这一点而不必访问网络上的数据库。

需要明确的是，我正在寻求有关如何以最佳方式访问完整真实单词词典的帮助 - 例如，用户触摸 UIButton 并且 171,476 个（来源：牛津词典网站）英文单词中的任何一个出现在UILabel 随机。

提前非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:36:39.363

iOS 字典 API 仅适用于查找单词定义，不适用于生成随机单词。出于您的目的，您可以购买第三方库的许可证，例如 Lexicontext ( [http://www.lexicontext.com](http://www.lexicontext.com) )，或者将您自己的字典捆绑到 SQLite 数据库中。您可以使用 WordNet ( [http://wnsql.sourceforge.net/](http://wnsql.sourceforge.net/) ) 作为您的数据库源。

# c - 重定位二进制代码时出错（gcc -> objdata -> 加载二进制代码 -> 并执行）

> ID：15211072
> 
> 赞同：1
> 
> 时间：2013-03-04T21:03:00.960
> 
> 标签：c, gcc, assembly, shared-objects, objcopy

我正在实现一种遗传算法，这些生物是具有三个指针作为输入和输出的函数。都有以下形式：

```
// No need for global variables

void _start (float *i, float *o, float *m)
{
    ...
    ...
    ...
} 
```

这些生物应该有几千个，而且非常小，所以我决定不使用共享对象，而是简单地加载原始代码并运行它。

生物被编译

```
gcc -O3 -c code.c 
```

然后我这样取函数的代码

```
objcopy -O binary --only-section=.text code.o rawcode 
```

然后将代码加载到内存中并运行它

```
((void(*)(void*,void*,void*)) loaded_code) (i, o, m); 
```

这项工作直到源代码**中没有浮点文字**，例如代码：

```
void _start (int *i, int *o, int *m)
{
    i[0] = m[0] + m[1];
} 
```

编译产生这个工作代码：

```
gcc -O3 -c code.c
objdump -d code.o

code.o:     formato del file elf64-x86-64

Disassemblamento della sezione .text:

0000000000000000 <_start>:
   0:   f3 0f 10 02             movss  (%rdx),%xmm0
   4:   f3 0f 58 42 04          addss  0x4(%rdx),%xmm0
   9:   f3 0f 11 07             movss  %xmm0,(%rdi)
   d:   c3                      retq 
```

但是具有浮点文字的函数为：

```
void _start (float *i, float *o, float *m)
{
    i[0] = m[0] + 3.0f;
} 
```

生成的代码在执行时不会给出正确的结果

```
gcc -O3 -c code.c
objdump -d code.o

code.o:     formato del file elf64-x86-64

Disassemblamento della sezione .text:

0000000000000000 <_start>:
   0:   f3 0f 10 05 00 00 00    movss  0x0(%rip),%xmm0        # 8 <_start+0x8>
   7:   00 
   8:   f3 0f 58 02             addss  (%rdx),%xmm0
   c:   f3 0f 11 07             movss  %xmm0,(%rdi)
  10:   c3                      retq 
```

每次使用**%rip**生成指令时都会发生这种情况。如何将 gcc 设置为不生成此代码？理论上，插入一个浮点常量可以像[这里](https://stackoverflow.com/questions/6514537/how-do-i-specify-immediate-floating-point-numbers-with-inline-assembly)那样做吗？

你有什么建议可以避免这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:54:29.647

编译器将常量放入`.rodata`您甚至不复制的部分，因此这不仅仅是一个重定位问题。您可以使用自定义链接器脚本，根据需要合并和重新定位代码，而不是`objcopy`，如下所示：

```
OUTPUT_FORMAT(binary)

SECTIONS
{
    merged : {
        *(.text)
        *(.rodata)
    } = 0x90

    /DISCARD/ : {
        *(*) /* discard everything else */
    }
} 
```

不知道为什么要避免共享对象，那将是最简单的解决方案。你可以只是`dlopen`他们，不要打扰细节。

# eclipse - 如何在 Eclipse 中将 Spark 添加到 Maven 项目？

> ID：15211074
> 
> 赞同：7
> 
> 时间：2013-03-04T21:03:10.210
> 
> 标签：eclipse, maven, spark-java

我想使用 Maven 在 Eclipse中启动[Spark项目。](http://www.sparkjava.com/)我已经安装了 m2eclipse，并且在我的 Maven 项目中有一个可以工作的 HelloWorld Java 应用程序。

我想使用 Spark 框架，我正在按照[官方网站的](http://www.sparkjava.com/download.html)指示进行操作。我已将 Spark 存储库添加到我的`pom.xml`：

```
<repository>
      <id>Spark repository</id>
      <url>http://www.sparkjava.com/nexus/content/repositories/spark/</url>
</repository> 
```

然后是依赖：

```
<dependency>
      <groupId>spark</groupId>
      <artifactId>spark</artifactId>
      <version>0.9.9.4-SNAPSHOT</version>
</dependency> 
```

但我在 Eclipse 中遇到错误：

```
Missing artifact spark:spark:jar:0.9.9.4-SNAPSHOT 
```

我该如何解决这个问题？我不想下载 Spark 的 jar 文件并放在本地存储库中。

这是我的 pom.xml 文件：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.myproject</groupId>
  <artifactId>Spark1</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>jar</packaging>

  <name>Spark1</name>
  <url>http://maven.apache.org</url>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <repository>
      <id>Spark repository</id>
      <url>http://www.sparkjava.com/nexus/content/repositories/spark/</url>
  </repository>

  <dependencies>
<!--     (...) -->

    <dependency>
      <groupId>spark</groupId>
      <artifactId>spark</artifactId>
      <version>0.9.9.4-SNAPSHOT</version>
    </dependency>

  </dependencies>

</project> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-08-04T12:07:16.297

目前不需要为 Spark 库加载添加存储库

你只需要添加

```
<dependency>
    <groupId>com.sparkjava</groupId>
    <artifactId>spark-core</artifactId>
    <version>2.6.0</version>
</dependency> 
```

就是这样。

有用的教程在[这里](http://sparkjava.com/tutorials/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-04T22:02:11.737

该`repository`块需要包装在一个`repositories`块中：

```
<repositories>
    <repository>
        <id>Spark repository</id>
        <url>http://www.sparkjava.com/nexus/content/repositories/spark/</url>
    </repository>
</repositories> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-08-31T08:32:02.443

失败原因是 0.9.9.4-SNAPSHOT 不可用。以下是可用快照列表。根据您的要求使用其中一种。

0.9.8-SNAPSHOT/ 2011 年 5 月 21 日星期六 21:54:23 UTC
0.9.9-SNAPSHOT/ 2011 年 5 月 23 日星期一 10:57:38 UTC 2011
0.9.9.1-SNAPSHOT/ 2011 年 5 月 26 日星期四 09:47:03 UTC
0.9。 9.3-SNAPSHOT/ 2011 年 9 月 1 日星期四 07:53:59 UTC

谢谢，桑卡拉雷迪

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-24T12:37:03.597

我遇到了同样的问题，因为最初我使用不同的存储库 url 用于 spark，然后使用早期版本我更改了存储库 url。在我更改存储库 ID 之前，它似乎没有生效。尝试更改存储库 ID。
可能是 maven 中的错误，因为从控制台运行 maven 也无法在不更新 id 的情况下解决依赖关系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-27T20:27:09.093

请添加存储库，在存储库标签内添加标签，如下所示

```
<repositories>
        <repository>
            <id>Spark repository</id>
            <url>http://www.sparkjava.com/nexus/content/repositories/spark/</url>
        </repository>
    </repositories> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-18T23:38:48.323

Spark 的最新版本（2.1 和更高版本）只需要在 pom.xml 文件中定义的依赖项

```
<dependency>
    <groupId>com.sparkjava</groupId>
    <artifactId>spark-core</artifactId>
    <version>2.1</version>
</dependency> 
```

不再需要存储库定义

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-15T08:00:48.610

使用这个最新的存储库。 [http://mvnrepository.com/artifact/org.apache.spark/spark-core_2.10/1.6.0](http://mvnrepository.com/artifact/org.apache.spark/spark-core_2.10/1.6.0)

```
<dependency>
    <groupId>org.apache.spark</groupId>
    <artifactId>spark-core_2.10</artifactId>
    <version>1.6.0</version>
</dependency> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-13T16:00:17.000

使用它，并确保在 eclipse 项目构建路径中将 spark 库更改为 2.11.x 版本

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.spark-scala</groupId>
    <artifactId>spark-scala</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>${project.artifactId}</name>
    <description>Spark in Scala</description>
    <inceptionYear>2010</inceptionYear>

    <properties>
        <maven.compiler.source>1.8</maven.compiler.source>
        <maven.compiler.target>1.8</maven.compiler.target>
        <encoding>UTF-8</encoding>
        <scala.tools.version>2.10</scala.tools.version>
        <!-- Put the Scala version of the cluster -->
        <scala.version>2.10.4</scala.version>
    </properties>

    <!-- repository to add org.apache.spark -->
    <repositories>
        <repository>
            <id>cloudera-repo-releases</id>
            <url>https://repository.cloudera.com/artifactory/repo/</url>
        </repository>
    </repositories>

    <build>
        <sourceDirectory>src/main/scala</sourceDirectory>
        <testSourceDirectory>src/test/scala</testSourceDirectory>
        <plugins>
            <plugin>
                <!-- see http://davidb.github.com/scala-maven-plugin -->
                <groupId>net.alchim31.maven</groupId>
                <artifactId>scala-maven-plugin</artifactId>
                <version>3.2.1</version>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.13</version>
                <configuration>
                    <useFile>false</useFile>
                    <disableXmlReport>true</disableXmlReport>
                    <includes>
                        <include>**/*Test.*</include>
                        <include>**/*Suite.*</include>
                    </includes>
                </configuration>
            </plugin>

            <!-- "package" command plugin -->
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.4.1</version>
                <configuration>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                </configuration>
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.scala-tools</groupId>
                <artifactId>maven-scala-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

    <dependencies>
        <dependency>
            <groupId>org.apache.spark</groupId>
            <artifactId>spark-core_2.11</artifactId>
            <version>1.2.1</version>
        </dependency>
    </dependencies>
</project> 
```

# r - 如何用来自数据框另一部分的值替换 R 中数据框的值？

> ID：15211076
> 
> 赞同：0
> 
> 时间：2013-03-04T21:03:35.940
> 
> 标签：r, dataframe, substitution

我已将数据集导入 R 并发现了一个异常值。我想对这个最初导入的数据进行特定的替换。具体来说，我的数据如下所示：

```
Adhesive TestCond Lab Speci.no Sample.id Wood.fail Shear.str
1        W      BDF   A   ABW-01         1       100 707.99296
2        W      BDF   A   ABW-02         2       100 557.61752
3        W      BDF   A   ABW-03         3       100 759.13431
4        W      BDF   A   ABW-04         4       100  84.70696
5        W      BDF   A   ABW-05         5       100 519.56020
6        W      BDF   A   ABW-06         6       100 502.13246 
```

它有大约 3,000 行。此数据是使用以下命令导入的：

```
FPInnovation <- read.csv() 
```

有问题的 Wood.fail 值是以下值

```
Adhesive TestCond Lab Speci.no Sample.id Wood.fail Shear.str
6        W      BDF   D   DBW-07         7       0 23.68061 
```

Wood.fail 列中的 0 值被发现是一个错误。其他值 0 可能不是。因此，我只想在上面的行中进行替换。如何将特定的 Wood.fail 值 0（如上所述）替换为下一行中保存的值（将上面的 0 替换为下面的 90）：

```
Adhesive TestCond Lab Speci.no Sample.id Wood.fail Shear.str
31        W      BDF   D   DBW-31         31     90 237.3734 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:23:07.633

这只是索引。它是这样工作的：

```
FPInnovation$Wood.fail[LOGICAL TEST] <- updatedvalue 
```

所以专门针对 Speci.no=="DBW-07"

```
FPInnovation$Wood.fail[FPInnovation$Speci.no=="DWB-07"] <- updatedvalue 
```

这将选择并更新满足逻辑测试的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:12:21.490

```
row = .... #specify the row number

FPInnovation$Wood.fail[row] <- 90 
```

# system-calls - 在 xv6 中实现 vfork()

> ID：15211080
> 
> 赞同：1
> 
> 时间：2013-03-04T21:03:56.683
> 
> 标签：system-calls, xv6

如果我想添加我的系统调用 vfork(copy on write) 究竟需要在 syscall.c 中编辑什么？我将在哪里添加我的 vfork 代码片段。简而言之，我将如何在 xv6 中实现 vfork？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T07:05:10.670

用于在 xv6 的 shell 中添加系统调用；修改以下文件：

*   **sysproc.c**在此处添加您的方法的实际实现
*   **syscall.h**定义连接到您的实现的系统调用向量的位置
*   **user.h**定义了可以通过shell调用的函数
*   **syscall.c**外部定义连接外壳和内核的函数，使用**syscall.h**中定义的位置将函数添加到系统调用向量中
*   **ussys.S**使用宏定义连接用户调用到系统调用函数

您也可以查看以下[链接](https://stackoverflow.com/questions/8021774/how-do-i-add-a-system-call-utility-in-xv6)。

# jquery - jquery div 动画在同一地点的 3 个 div 问题

> ID：15211086
> 
> 赞同：0
> 
> 时间：2013-03-04T21:04:37.420
> 
> 标签：jquery

我不确定如何表达我的问题，所以我会尽我所能解释。

我的网站上只有主页，我正在尝试使用 jquery 动态更改主要区域内容，这就是我现在拥有的

```
$(document).ready(function(){
    $('#link1').click(function(){
        $("#div2").hide("slide", { direction: "right" }, 500);
        $("#div3").hide("slide", { direction: "left" }, 500);
        $("#div1").delay(501).show("slide", {direction: "down" }, 500);
});

    $('#link2').click(function(){
        $("#div1").hide("slide", { direction: "right" }, 500);
        $("#div3").hide("slide", { direction: "left" }, 500);
        $("#div2").delay(501).show("slide", {direction: "down" }, 500);
});
    $('#link3').click(function(){
        $("#div2").hide("slide", { direction: "right" }, 500);
        $("#div1").hide("slide", { direction: "left" }, 500);
        $("#div3").delay(501).show("slide", {direction: "down" }, 500);
}); }); 
```

我的问题是，如果我单击隐藏当前未显示的 div 的链接，它会显示 div 然后隐藏它。

我该如何对抗这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:56:01.203

我不确定这是否是您要问的。
如果你能提供一个例子，那将是最好的。

您可以简单地检查 div 是否可见，并仅在可见时运行滑动动画。

例如：

```
$('#link1').click(function(){
    if ($('#div2').is(':visible')){
        $("#div2").hide("slide", { direction: "right" }, 500);
    }

    if ($('#div3').is(':visible')){
        $("#div3").hide("slide", { direction: "left" }, 500);
    }

    $("#div1").delay(501).show("slide", {direction: "down" }, 500);
}); 
```

另一件事，我建议你使用类而不是 id。写出所有可能的组合没有多大意义。想象一下你有 10 个链接......这是很多不必要的代码

# assembly - 设置输入变量

> ID：15211090
> 
> 赞同：1
> 
> 时间：2013-03-04T21:04:44.183
> 
> 标签：assembly, mips, mars-simulator

问题问：

> 编写一段 MIPS 代码，给定 $s0 和 $s1 中的值，将以下内容放入 $t* 寄存器：
> 
> ```
> $t0 = $s0
> $t1 = $s1
> $t2 = $t0 + $t1
> $t3 = $t1 + $t2
> ...
> $t7 = $t5 + $t6 
> ```
> 
> 换句话说，对于从 $t2 到 $t7 的每个寄存器，它存储前两个 $t* 寄存器值的总和。$s0 和 $s1 寄存器包含初始值。不要在代码中设置 $s0 和 $s1 的值。相反，学习如何使用 MARS 手动设置它。将您的代码保存到 sum.s 中。

好的，这并不难：

```
move $t0 $s0 
move $t1, $s1 
add $t2, $t0, $t1    
add $t3, $t1, $t2 
```

... 等等

但是最后一部分是什么意思？“不要在代码中设置 $s0 和 $s1 的值。相反，学习如何使用 MARS 手动设置它。将代码保存到 sum.s 中。” ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:14:24.310

这意味着您不应包括输入设置操作，例如：

```
move $s0, 0xBAAD
move $s1, 0xBEEF 
```

（如果语法错误，请原谅我）

相反，您应该配置您的 MARS IDE，以便它会在运行汇编脚本进行调试或测试之前自动设置所有输入参数。当然，您必须指定这些自动设置参数将具有的值，但重点是向您展示您可以轻松（？）（重新）配置测试输入而不是硬编码它们。

我已经简要浏览了[http://courses.missouristate.edu/kenvollmar/mars/](http://courses.missouristate.edu/kenvollmar/mars/)网站，但找不到任何注释。它应该在 IDE 的文档或帮助系统中的某处进行描述（如果有的话）。

编辑：

好吧，**也许**我已经找到了。

引用[“帮助和信息”](http://courses.missouristate.edu/kenvollmar/mars/Help/MarsHelpDebugging.html)：

> **任何数据段存储器字和几乎任何 MIPS 寄存器的内容都可以通过编辑其显示的表格单元来修改。双击一个单元格进行编辑，并在完成输入新值后按 Enter 键。**如果您输入一个无效的 32 位整数，则 INVALID 字样会出现在单元格中，并且存储器/寄存器内容不受影响。可以以十进制或十六进制（前导“0x”）输入值。可以以二进制补码或有符号格式输入负十六进制值。请注意，其中三个整数寄存器（零、程序计数器、返回地址）无法编辑。

因此，例如，您可以在代码的第一条指令处设置断点，运行程序，当它到达断点时，编辑寄存器并将输入值输入到 $s0/$s1 中，而不是硬编码这些值。我希望它比那更好一点，但我找不到其他任何东西。

此 IDE中还有[“宏”功能](http://courses.missouristate.edu/kenvollmar/mars/Help/MacrosHelp.html)，因此您也许可以创建一些小脚本，将两个数字放入这两个寄存器中，或者甚至可能已经有这样的宏 - 我不知道 - 请自己挖吧，我的板子上什至没有这个软件：）

# jquery - Tablesorter 和 Bootstrap 不允许我排序

> ID：15211091
> 
> 赞同：0
> 
> 时间：2013-03-04T21:04:53.943
> 
> 标签：jquery, twitter-bootstrap, tablesorter

我在使用 tablesorter 时遇到问题。我将脚本添加到文档的头部，并确保更改表的 ID，但它不会让我排序。

表代码：

```
<table class="table tablesort" id="table1">
    <thead>  
      <tr>  
        <th>Summoner Name</th>     
        <th>Role</th>  
        <th>Type</th>  
        <th>Level</th>
        <th>Division</th>
        <th>Comment</th>
        <th>Posted</th>  
      </tr>
    </thead>  
    <tbody>  
      <?php
        $result = mysql_query("SELECT * FROM na");
        $time = floor((time()-'time') / 60);
        mysql_query("DELETE FROM na WHERE " . -'time'+time()>3600);
        while($row = mysql_fetch_array($result))
        {
        if($_SERVER['REMOTE_ADDR']==$row['ip']){
            echo "<script type='text/javascript'>
            $('#buttonop').attr('value', 'Delete Your Listing');
            $('#buttonopa').attr('href', 'delete.php');
            $('#buttonop').removeClass('btn btn-large btn-success').addClass('btnchange');
            </script>";
        }
        $time = floor((time()-$row['time']) / 60);
        {
        echo "<tr>";
        echo "<td>" . $row['summoner'] . "</td>";
        echo "<td>" . $row['role'] . "</td>";
        echo "<td>" . $row['type'] . "</td>";
        echo "<td>" . $row['level'] . "</td>";
        echo "<td>" . $row['division'] . "</td>";
        echo "<td style='width: 350px;'>" . $row['comment'] . "</td>";
        echo "<td>" . $time . " minute(s) ago </td>";
        echo "</tr>";
        }
        }
      ?>
    </tbody>  
</table> 
```

分拣机代码：

```
$(document).ready(function() 
    { 
        $("#table1").tablesorter(); 
    } 
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T01:56:10.507

您在粘贴的第一行将类命名为“tablesort”而不是“tablesorter”。尝试将其更改为“tablesorter”，看看是否有效。

# backbone.js - Backbone.js 和 CoffeeScript：如何创建可渲染的属性函数

> ID：15211092
> 
> 赞同：1
> 
> 时间：2013-03-04T21:04:58.547
> 
> 标签：backbone.js

在我遇到的任何示例中，我都没有看到这种类型的东西。我需要创建一个依赖于其他属性的属性函数。例如：

```
# coffeescript
class Person extends Backbone.Model
  fullName: -> @get('first') + ' ' + @get('last')

class MyView extends Backbone.View
  template: ...
  render: ->
    @$el.html @template(@model.toJSON())

new MyView(new Person(first:'Joe', last:'Moe)

# my template
<span><%= fullName %></span> 
```

在大多数示例中，我看到模型在传递给模板之前总是转换为 JSON，那么有没有办法设置 toJSON 方法来包含这个`fullName`属性？或者我应该将模型传递给模板吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:15:37.587

一种简单的方法是将不同的对象传递给模板函数：

```
modelData =
  data: @model.toJSON()
  fullName: @get('first') + ' ' + @get('last')
@template(modelData) 
```

然后在模板中：

```
<span><%= fullName %></span>
<span><%= data.first %></span> 
```

`toJSON`通常更多用于序列化，因此您可能不想将其更改为仅输出显示内容。您也可以按照您的建议将模型传递给模板。

还有另一种选择（javascript不是咖啡......）：

```
toDisplayJSON: function(){
    var json = this.toJSON();
    json.fullName = this.get('first') + ' ' + this.get('last');
    return json;
} 
```

我知道我已经读过另一种方法（视图模型方法）：[Dealing with non-saveable values in Backbone](https://stackoverflow.com/questions/10470844/dealing-with-non-saveable-values-in-backbone/10471303#10471303)

# javascript - jsPlumb - 每侧的动态端点锚点

> ID：15211096
> 
> 赞同：11
> 
> 时间：2013-03-04T21:05:16.790
> 
> 标签：javascript, jquery, html, jsplumb

我正在尝试找出一种如何将端点锚动态添加到 jsPlumb 容器的方法。

我希望源端点位于左侧，目标端点仅位于右侧。

问题是，我无法找到任何方法来做到这一点，而无需求助于一些黑客，就像我现在正在做的那样。

jsPlumb 支持[连续锚点](http://jsplumbtoolkit.com/doc/usage.html)，但单个锚点的位置将根据连接器之间的方向和连续锚点的数量重新计算。这意味着源端点和目标端点都可以共享容器的同一侧，这是我想避免的。

这是[我想出的 jsFiddler 代码](http://jsfiddle.net/DMINATOR/Zn8DL/)

这是我自己用来破解和重新计算锚点位置的代码的一部分（单击“添加”按钮时），结果有一些错误:(

```
 function fixEndpoints(endpoints) {

            //there are 2 types - input and output

            var inputAr = $.grep(endpoints, function (elementOfArray, indexInArray) {
                return elementOfArray.isSource; //input
            });

            var outputAr = $.grep(endpoints, function (elementOfArray, indexInArray) {
                return elementOfArray.isTarget; //output
            });

            calculateEndpoint(inputAr, true);
            calculateEndpoint(outputAr, false);
        }

        function calculateEndpoint(endpointArray, isInput) {

            //multiplyer
            var mult = 1 / endpointArray.length;

            for (var i = 0; i < endpointArray.length; i++) {

                if (isInput) {
                    endpointArray[i].anchor.x = 1;
                    endpointArray[i].anchor.y = mult * i;//, 1, 0] };
                } 
                else {
                    endpointArray[i].anchor.x = 0;
                    endpointArray[i].anchor.y = mult * i;//, -1, 0] };
                }
            }
        }

        //Add additional anchor
        $(".button_add").live("click", function () {

            var parentnode = $(this)[0].parentNode.parentNode;

            jsPlumb.addEndpoint(
                parentnode,
                anEndpointSource
            );

            jsPlumb.addEndpoint(
                parentnode,
                anEndpointDestination
            );

            //get list of current endpoints
            var endpoints = jsPlumb.getEndpoints(parentnode);

            //fix endpoints
            fixEndpoints(endpoints);

            jsPlumb.recalculateOffsets();
            jsPlumb.repaint(parentnode);
        }); 
```

![预期结果](../Images/3c1e94ee8c29b26bc8db36fc431cb8d8.png)

如上图所示，左侧只有源端点（Dot），右侧（Box）只有目标端点，一旦添加了新端点，就会根据一侧的锚点数量重新计算锚点。

这可行，但仍然有问题：只有在我移动容器并且容器之间的连接也不正确时才会更新位置。

我想要的是一种让它正确工作和连接项目的方法（最好使用正确的 jsPlumb 代码而不求助于黑客）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-19T18:56:32.967

我终于想出了怎么做。这比我想象的要容易。

代码基本相同，稍作改动，[这里是更新的提琴手示例](http://jsfiddle.net/DMINATOR/Zn8DL/4/)

```
<!DOCTYPE html>
<html>
<head>
<title>JS plumb test</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
    <script type="text/javascript" src="./include/jquery.jsPlumb-1.3.16-all-min.js"></script>

<style>
    .window { 
        background-color: #EEEEEF;
        border: 1px solid #346789;
        border-radius: 0.5em;
        box-shadow: 2px 2px 5px #AAAAAA;
        color: black;
        height: 5em;
        position: absolute;
        width: 5em;
    }

    .window:hover { 
        box-shadow: 2px 2px 19px #AAAAAA;
        cursor: pointer;
    }

    .button_add, .button_add_window, .button_remove, .button {
        background-color: deepskyblue;
        text-align: center;
        border: 1px solid;
    }

    .button_container {
        margin: 5px;
        background-color: #aaaaaa
    }
</style>

<script>

    jsPlumb.ready(function () {

        //FIX DOM:
        $(("#container1"))[0].innerHTML = $(("#container0"))[0].innerHTML;

        //all windows are draggable
        jsPlumb.draggable($(".window"));

        var anEndpointSource = {
            endpoint: "Rectangle",
            isSource: true,
            isTarget: false,
            maxConnections: 1,

            anchor: [1, 0, 1, 0]
        };

        var anEndpointDestination = {
            endpoint: "Dot",
            isSource: false,
            isTarget: true,
            maxConnections: 1,

            anchor: [0, 1, -1, 0]
        };

        //Fixes endpoints for specified target
        function fixEndpoints(parentnode) {

            //get list of current endpoints
            var endpoints = jsPlumb.getEndpoints(parentnode);

            //there are 2 types - input and output

            var inputAr = $.grep(endpoints, function (elementOfArray, indexInArray) {
                return elementOfArray.isSource; //input
            });

            var outputAr = $.grep(endpoints, function (elementOfArray, indexInArray) {
                return elementOfArray.isTarget; //output
            });

            calculateEndpoint(inputAr, true);
            calculateEndpoint(outputAr, false);

            jsPlumb.repaintEverything();
        }

        //recalculate endpoint anchor position manually
        function calculateEndpoint(endpointArray, isInput) {

            //multiplyer
            var mult = 1 / (endpointArray.length+1);

            for (var i = 0; i < endpointArray.length; i++) {

                if (isInput) {

                    //position
                    endpointArray[i].anchor.x = 1;
                    endpointArray[i].anchor.y = mult * (i + 1);
                } 
                else {

                    //position
                    endpointArray[i].anchor.x = 0;
                    endpointArray[i].anchor.y = mult * (i + 1);
                }
            }
        }

        //Add additional anchor
        $(".button_add").live("click", function () {

            var parentnode = $(this)[0].parentNode.parentNode;

            jsPlumb.addEndpoint(
                parentnode,
                anEndpointSource
            );

            jsPlumb.addEndpoint(
                parentnode,
                anEndpointDestination
            );

            fixEndpoints(parentnode);
        });

        //Remove anchor 
        $(".button_remove").live("click", function () {

            var parentnode = $(this)[0].parentNode.parentNode;

            //get list of current endpoints
            var endpoints = jsPlumb.getEndpoints(parentnode);

            //remove 2 last one

            if (endpoints.length > 1) {
                jsPlumb.deleteEndpoint(endpoints[endpoints.length - 2]);
            }

            if (endpoints.length > 0) {
                jsPlumb.deleteEndpoint(endpoints[endpoints.length - 1]);
            }

            fixEndpoints(parentnode);
        });

        //adds new window
        $(".button_add_window").click(function () {

            var id = "dynamic_" + $(".window").length;

            //create new window and add it to the body
            $('<div class="window" id="' + id + '" >').appendTo('body').html($(("#container0"))[0].innerHTML);

            //set jsplumb properties
            jsPlumb.draggable($('#' + id));
        });
    });
</script>

</head>
<body >

    <!-- Adds new windows to the page -->
    <div class="window" style="left: 600px" id="details">
        <p style="text-align: center">Window</p>
        <div class="button_container">
            <div class="button_add_window">Add</div>
        </div>
    </div>

    <!-- Primary window - used as html templated for descendants -->
    <div class="window" style="left: 20px" id="container0">
        <div class="button_container">
            <div class="button_add">Add</div>
            <div class="button_remove">Remove</div>
        </div>
    </div>

    <div class="window" style="left: 200px" id="container1">
    </div>

</body>
</html> 
```

我所做的更改：

1.  现在我在添加时指定端点锚点偏移量，我只计算锚点位置，所以偏移量永远不会改变，从一开始它总是正确的：

    ```
    var anEndpointSource = {
        endpoint: "Rectangle",
        isSource: true,
        isTarget: false,
        maxConnections: 1,

        anchor: [1, 0, 1, 0]
    }; 
    ```

2.  添加端点后，我会重新计算锚位置并调用（这将重新绘制连接）：

    `jsPlumb.repaintEverything();`

这是最终结果：

![端点正确连接](../Images/a0f82ca30f6b3dd43efb62353742b242.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T11:16:00.153

您可以通过添加双击删除状态

```
 newState.dblclick(function(e) {
                        alert("This will delete the state and its connections");
                        instance.detachAllConnections($(this));
                      $(this).remove();
                      e.stopPropagation();
                    }); 
```

函数到你的 jsPlumb.ready 函数。您可以通过添加将其添加到您的所有州

```
var windows = jsPlumb.getSelector(".statemachine-demo .state");
            windows.dblclick(function(e) {
            alert("This will delete the state and its connections");
            instance.detachAllConnections($(this));
          $(this).remove();
          e.stopPropagation();
        }); 
```

这里 statemachine-demo 是容器中 div 的 id，而 state 是状态 div 的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-07T10:11:08.910

谢谢你的解决方案，当锚点被预定义时它工作正常，就像这里的源总是在左边，目标总是在右边。

但是如果它们是动态的，我们还需要自己实现边选择吗？

作为一种解决方法，我所做的是在默认配置中设置更多可能的锚点位置。有更好的主意吗？

谢谢

# python - 显示他们输入的姓名首字母大写

> ID：15211100
> 
> 赞同：3
> 
> 时间：2013-03-04T21:05:33.133
> 
> 标签：python, python-3.x

我需要从程序中得到这个输出。

> 编写一个程序，要求用户输入他们的全名，然后以大写形式显示每个名字的首字母，并用句号分隔。

到目前为止，我编写了以下程序：

```
def main():

    name=input("Please Enter Your Name: ")
    name_split = name.split()
    print(name_split)
    for line in name_split:
        print(line[0][0].upper())

main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:22:14.390

看起来你想要一个简单的字符串连接，你可以这样写：

```
outputStr = ""
for line in name_split:
    outputStr = outputStr + line[0][0].upper() + '.'

print outputStr 
```

如果你只想要一个'。在字母之间，你可以这样写：

```
print '.'.join([c[0].upper() for c in name_split]) 
```

这只会在每个字母之间添加点。

# java - Excel 追加更新因 Apache POI 失败

> ID：15211114
> 
> 赞同：0
> 
> 时间：2013-03-04T21:06:23.440
> 
> 标签：java, excel, apache-poi

我从 URL 获取数据并尝试使用以下代码将行附加到现有的 excel 文件中。

```
 if (file.exists()) {
                in=new FileInputStream(new File(path));

                workbook = new HSSFWorkbook(in);
                sheet = workbook.getSheetAt(0);
                in.close();
            } else {
                workbook = new HSSFWorkbook();
                sheet = workbook.createSheet();
                row = sheet.createRow(0);
                row.createCell(0).setCellValue("keyTerm");
                row.createCell(1).setCellValue("username");
                row.createCell(2).setCellValue("Text");
                row.createCell(3).setCellValue("Timestamp");
            } 
```

进而

```
int count = sheet.getLastRowNum();    
for (int i = 0; i < tweets.length(); i++) {
                        tweet = tweets.getJSONObject(i);
                        count++;
                        row = sheet.createRow(count);
                        row.createCell(0).setCellValue(term);
                        row.createCell(1)
                                .setCellValue(tweet.getString("from_user"));
                        row.createCell(2).setCellValue(
                                tweets.getJSONObject(i).getString("text"));
                        row.createCell(3).setCellValue(
                                tweet.getString("created_at"));
    } 
```

该代码适用于新文件，但即使我以追加模式打开文件进行写入，现有文件也无法追加。

```
out = new FileOutputStream(file, true);
            workbook.write(out);
            out.close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:24:59.940

该`write`方法不会只写入您对电子表格所做的新添加。它将*整个*工作簿写入输出流。因此，如果您尝试将整个新工作簿附加到旧工作簿，我可以看到它不会按照您的想法进行。

在将工作簿写入文件时，我从未附加到现有文件。您应该始终以（默认）覆盖模式打开流，因此整个工作簿（除了整个工作簿之外什么都没有）进入流和目标文件。

```
out = new FileOutputStream(file);  // or new FileOutputStream(file, false); 
```

您当前的代码仅在文件尚不存在时才有效，因为没有可附加的内容。总之，不要追加；覆盖（或写入不同的文件）。

# openstack - Keystone 日志文件始终为空

> ID：15211116
> 
> 赞同：0
> 
> 时间：2013-03-04T21:06:40.367
> 
> 标签：openstack

我正在浏览安装 OpenStack 的 Ubuntu 演练。我已经过了 keystone 阶段，我发现它在 /var/log/keystone 中创建了长度始终为零的日志文件。在响应许多原本可以工作的命令时，我还会收到以下消息：

```
No handlers could be found for logger "keystoneclient.v2_0.client" 
```

——这可能有关系，也可能没有关系。对菜鸟的任何建议表示赞赏。

这是福尔松版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:31:09.957

Keystone 使用 /etc/keystone/logging.conf 来控制日志级别。默认情况下，keystone logger 只会显示 WARNING 及以上级别的消息：

```
[logger_root]
level=WARNING
handlers=file 
```

如果您将级别更改为更低的级别（例如 , `INFO`）`DEBUG`然后重新启动 keystone 服务，您应该会在 /var/log/keystone/keystone.log 中看到日志消息

# php - Laravel Eloquent 输出 c

> ID：15211120
> 
> 赞同：0
> 
> 时间：2013-03-04T21:06:53.900
> 
> 标签：php, laravel, eloquent, laravel-3

我正在使用 Laravel 的 Eloquent，大多数时候没有任何问题。但现在我遇到了一个问题，似乎无法解决它。谷歌没有提供解决方案......

```
$global_data['credentials']     = Company::find(Auth::user()->company_id)->credentials()->first();

View::share('data', $global_data); 
```

公司模型中的关系：

```
public function credentials(){
  return $this->has_one('credentials');
} 
```

凭据将“c”回显到每一页。“c”在文档类型之前输出。当我删除凭据行时，“c”消失了。

页面来源：

```
c<!DOCTYPE html>
<html lang="nl">
<head> 
```

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:45:41.417

老实说，我怀疑 Eloquent 是否与此有关，但可能是您代码中某处的不幸的“c”。这种情况经常发生，解决方案是一只讨厌的老鼠追逐（在这种情况下是“c”）。

造成这种情况的一个可能原因是文件以 开头`c<?php`或结尾`?>c`，通常是通过 Autoloader 加载的文件（模型、库和捆绑包）。

我敢打赌它在您的凭据模型文件的开头，但也可能在其他地方。如果它不在 Credential.php 中，找到它的一种可能方法是逐步添加与构建该`$global_data['credentials'] = ....`行有关的任何内容。

1.  尝试硬编码的凭证，如果没有出现“c”，它可能来自公司或身份验证文件。
2.  然后尝试做一个 Company::find($1)->credentials()，如果没有“c”出现，它可能在你的 Auth 或 User 上（它包含在 Auth 中）。
3.  继续这样做，直到找到它。

**编辑：**

发生这种情况是因为当 Autoloader 包含一个文件时，PHP 会像在旧样式 PHP 上那样解析它，或者我应该说，就像任何视图一样。

如果您的文件以非空行或它们之前或之后的字符开头`<?php`和结尾`?>`，则在 Laravel 的视图渲染之前不会输出任何内容。但是，如果这些文件中的任何一个有输出，它就会进入 PHP 的输出缓冲区并在您的视图之前呈现。

`<?php`始终在第一行使用打开那些非输出文件并且从不使用`?>`.

# xml - 将 XML 格式转换为与 Access Import 兼容

> ID：15211121
> 
> 赞同：1
> 
> 时间：2013-03-04T21:06:55.300
> 
> 标签：xml, vba, xslt

这与之前的帖子有关。我正在尝试将经济数据从 StLouisFred 导入 Access。我最终会将此数据库用于excel。我是一名学生，这项任务虽然很简单，但超出了我的经验。我也尝试将 XML 数据导入 Excel，但是，格式仍然是个问题。我知道 FRED 使用 CSV，但你不能自动更新 CSV，所以我想使用 XML。数据格式如下：

```
 <observations realtime_start="2013-02-08" realtime_end="2013-02-08"  
 observation_start="1776-07-04" observation_end="9999-12-31" units="lin"   
 output_type="2" file_type="xml" order_by="observation_date" sort_order="asc" 
 count="792" offset="0"        limit="100000">
 <observation date="1947-01-01" CPIAUCSL_20130208="21.48"/>
 <observation date="1947-02-01" CPIAUCSL_20130208="21.62"/>
 <observation date="1947-03-01" CPIAUCSL_20130208="22.0"/>
 </observations> 
```

我正在尝试将数据转换为 Access 喜欢的其他标准 xml 格式。像这样的东西：

```
<observations realtime_start="2013-02-08" realtime_end="2013-02-08"  
 observation_start="1776-07-04" observation_end="9999-12-31" units="lin"   
 output_type="2" file_type="xml" order_by="observation_date" sort_order="asc" 
 count="792" offset="0"        limit="100000">

 <observation> 
 <date> 1947-01-01 </date>
 <value> 21.48 </value> 
 <observation/>

 <observation> 
 <date>1947-02-01</date> 
 <value>21.62</value>
 </observation>

 <observation> 
 <date>1947-03-01</date> <value>22.0</value>
 </observation>

 </observations> 
```

看来这会奏效。Access 能够使用样式表，我很乐意尝试，但我需要一些简单的演练。因此，假设我有一张第一个 xml 格式的信息。有没有办法让我将数据转换为 Access，以便我可以拥有一个可以自动更新的表，或者这是一个无望的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T03:23:09.520

**这是一个简单的 XSLT 转换：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="observation/@date">
  <date><xsl:value-of select="."/></date>
 </xsl:template>

 <xsl:template match="observation/@*[starts-with(name(),'CPIAUCSL_')]">
  <value><xsl:value-of select="."/></value>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<observations realtime_start="2013-02-08"
     realtime_end="2013-02-08"
     observation_start="1776-07-04"
     observation_end="9999-12-31" units="lin"
     output_type="2" file_type="xml"
     order_by="observation_date" sort_order="asc"
     count="792" offset="0"        limit="100000">
    <observation date="1947-01-01" CPIAUCSL_20130208="21.48"/>
    <observation date="1947-02-01" CPIAUCSL_20130208="21.62"/>
    <observation date="1947-03-01" CPIAUCSL_20130208="22.0"/>
</observations> 
```

**产生了想要的正确结果：**

```
<observations realtime_start="2013-02-08"
 realtime_end="2013-02-08" observation_start="1776-07-04"
 observation_end="9999-12-31" units="lin" output_type="2"
 file_type="xml" order_by="observation_date" sort_order="asc"
 count="792" offset="0" limit="100000">
   <observation>
      <date>1947-01-01</date>
      <value>21.48</value>
   </observation>
   <observation>
      <date>1947-02-01</date>
      <value>21.62</value>
   </observation>
   <observation>
      <date>1947-03-01</date>
      <value>22.0</value>
   </observation>
</observations> 
```

# iphone - 在 Facebook 上发帖：如何识别移动/桌面用户？

> ID：15211123
> 
> 赞同：1
> 
> 时间：2013-03-04T21:07:07.590
> 
> 标签：iphone, ios, facebook

当我的应用程序在 Facebook 上的墙上发布图像时，还会发布一个链接，指向 facebook 应用程序。

如果在桌面上看到该帖子，我希望该链接将它们重定向到基于 Flash 的 Facebook 应用程序。

如果在 IOS 上看到该帖子，我希望他们在 App Store 上看到同一应用程序的下载链接。

那可能吗？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:24:15.873

尝试更改将重定向到一个页面或另一个页面的 Facebook 链接不是一个好的做法（甚至是不可能的）。只要让用户在使用 Facebook 的任何地方点击相同的链接即可。

因此，一旦用户访问了您的网页，只需捕获[用户代理](http://en.wikipedia.org/wiki/User_agent)，该代理将为您提供有关他的浏览器和设备或计算机的信息。根据这一点，您将知道他是在台式机上还是在手机上。然后，您将能够使用适当的[URL 重定向](http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx)来重定向用户。我让你在这方面搜索一些帮助：

*   [如何确定它是否是带有 PHP 的移动设备？](https://stackoverflow.com/questions/386046/how-do-i-determine-whether-its-a-mobile-device-with-php)
*   [Mobile_Detect](https://code.google.com/p/php-mobile-detect/)是一个用于检测移动设备的轻量级 PHP 类。它使用用户代理字符串结合特定的 HTTP 标头来检测移动环境。
*   例如：[你的用户代理是什么？](http://whatsmyuseragent.com/)
*   [检测移动浏览器 | 开源手机检测](http://detectmobilebrowsers.com/)
*   谷歌上的“[知道移动浏览器”](https://www.google.com/search?aq=f&oq=how%20to%20use%20user%20agents&%7Bgoogle:instantFieldTrialGroupParameter%7Dsourceid=chrome&ie=UTF-8&q=how%20to%20use%20user%20agents&hl=en#hl=en&safe=off&sclient=psy-ab&q=know%20if%20mobile%20browser&oq=know%20if%20mobile%20browser&gs_l=serp.3..0i30j0i22l2.3162.3294.1.3436.2.2.0.0.0.0.105.201.1j1.2.0.les;..0.0...1c.1.5.psy-ab.p2kcXwhzk00&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&fp=3261b7d406fa296d&biw=1422&bih=701)

# spring - @Around 建议抛出错误

> ID：15211126
> 
> 赞同：0
> 
> 时间：2013-03-04T21:07:35.483
> 
> 标签：spring, aspectj, spring-aop

我的方面有以下几点。看起来执行模式可能是原因。我希望有人可以帮助我找出以下建议的问题所在。

```
@Around(value = "execution(* com.ss.psystem..*.*(..))")
        public final Object logAround(final ProceedingJoinPoint joinPoint)
                throws Throwable {
            Signature signature = joinPoint.getSignature();
            LOGGER.trace("[{}][{}], Entering method...",
                    signature.getDeclaringTypeName(), signature.getName());
            LOGGER.trace("arguments: {}", Arrays.toString(joinPoint.getArgs()));

            Object result = joinPoint.proceed();

            LOGGER.trace("[{}][{}], Exit the method.",
                    signature.getDeclaringTypeName(), signature.getName());
            LOGGER.trace("returned value: [{}]", result);

            return result;
        } 
```

错误：在类 com.ss.psystem.conf.PaymentSystemTestContext 中创建名称为“paymentService”的 bean 时出错：找不到匹配的工厂方法：工厂 bean 'paymentSystemTestContext'；工厂方法'paymentService()'。检查具有指定名称的方法是否存在并且它是非静态的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T00:30:10.187

这似乎不是切入点模式问题，而是`Spring`定义您的一个 bean 的方式的错误。您很可能将 bean 定义为：

```
<bean class="com.ss.psystem.conf.PaymentSystemTestContext" factory-method="paymentService" /> 
```

检查方法`paymentService`确实是`static`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T02:02:50.143

我发现了这个问题，实际上问题不在于切入点或其他任何东西，其中一个 bean 的自动装配不正确，因此出现了问题。它固定在我的最后，我可以看到日志。

感谢您查看问题。

# ios - ViewDidLoad 没有被第二次调用 Xcode

> ID：15211128
> 
> 赞同：0
> 
> 时间：2013-03-04T21:07:42.967
> 
> 标签：ios, uiviewcontroller, uitableview, viewdidload

我有一个 tableViewController 从中导航到 UIViewController。为了保存 indexPath.row 的值，我使用了一个整数，并基于该整数在 UIViewController 中执行操作。问题是当我按下后退按钮并选择另一个表索引时，它导航到 UIViewContoller 但执行的操作是第一个。第二次没有调用 ViewDidLoad。这是我的代码。

表视图代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (!self.iaRecipieViewController) {
        self.iaRecipieViewController = [[[iRecipieViewController alloc] initWithNibName:@"iRecipieViewController" bundle:nil] autorelease];
    }
    if (indexPath.row == 0) {
        self.iaRecipieViewController.myLableArray =labelSoupArray ;
    }

    if (indexPath.row == 1) {
        self.iaRecipieViewController.myLableArray =labelSoupArray ;
    }

    if (indexPath.row == 2) {
        self.iaRecipieViewController.myLableArray =labelSoupArray ;
    }
    // custom string is an NSinteger
    self.iaRecipieViewController.customString = indexPath.row;
    NSLog(@"  int  %i",self.iaRecipieViewController.customString);
    NSLog(@"index path %i ", indexPath.row) ;

    [self.navigationController pushViewController:iaRecipieViewController animated:YES];

    [detailTable reloadData];
} 
```

UIViewController 代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    myLabel.text = [self.myLableArray objectAtIndex:customString];
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:11:12.717

采用`viewWillAppear:(BOOL)animated`

```
-(void)viewWillAppear:(BOOL)animated {

  [super viewWillAppear:animated];
  myLabel.text = [self.myLableArray objectAtIndex:customString];

} 
```

viewDidLoad 只会在视图加载时被调用；推送一个新的 ViewController 然后删除它不会强制重新加载视图。viewWillAppear 在视图被渲染之前被调用，所以只要它成为主视图，你就有机会做一些事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:10:50.860

ViewDidLoad 仅在实例化视图时被调用一次。根据您的代码，您将在此视图上来回移动，因此该视图不是每次都实例化（加载），而是加载一次，现在它实际上是视图在您来回移动时消失和出现看法。

将您的代码放入 ViewWillAppear 或 ViewDidAppear。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T03:25:09.917

方法

```
(void)viewDidLoad 
```

在加载视图时运行。如果您的视图已经加载（意味着它仍在内存中），可能它已经从屏幕上消失了。但这并不意味着记忆消失了；当视图应该加载到内存时重新运行。

# java - Java - 检查数组是否包含 3 个连续日期

> ID：15211132
> 
> 赞同：0
> 
> 时间：2013-03-04T21:07:49.033
> 
> 标签：java, arrays, date

您好我有一个字符串 [] 数组，其中包含格式为 YYYY/MM/DD 的日期。我想遍历这个数组，看看数组中接下来的 2 个元素是否包含连续的日期。如果他们这样做，那么只需增加计数变量。这是我到目前为止所拥有的。我基本上只需要关于检查是否有 3 个连续日期的 if 语句的帮助。

```
int count = 0;

String[] dates = { 
        "2004/1/23", "2004/1/24", "2004/1/25",
        "2004/1/26", "2004/1/29", "2004/2/11", 
        "2004/2/17", "2004/2/18", "2004/2/18", "2004/3/7"};

for(int i = 0; i < dates.length-2; i++){

    //Help needed here! If i, i+1 and i+2 are consecutive...
    if(...){
        count++;
    }
} 
```

我意识到我可能需要先将字符串日期转换为实际的 Date 对象，然后才能比较它们。进一步的指导将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:27:09.303

转换`String[]`为`Date[]`（即准备一个`Date`数组）。我想你已经知道如何做到这一点了。

现在您可以使用以下方式检查连续日期：

```
Calendar c = Calendar.getInstance();
int numConsecutive = 0;
Date last = null;

for (int i = 0; i < dates.length; i++) {
    c.setTime(dates[i]);
    c.add(Calendar.DATE, -1);
    if (c.getTime().equals(last)) {
        numConsecutive++;
    } else {
        numConsecutive = 0;
    }
    if (numConsecutive == 2) {
        numConsecutive = 0;
        count++;
    }
    last = dates[i];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-06T01:49:22.790

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:17:07.500

您好，您需要计算两个日期之间的秒数，然后转换为天数：

```
import java.util.*;  
class DateDiff  
{  
    public static void main(String [] args)  
    {  
        Calendar c1=Calendar.getInstance();  
        c1.set(2011,5, 29 );  
        Calendar c2=Calendar.getInstance();  
        c2.set(2012,5,30);  

        Date d1=c1.getTime();  
        Date d2=c2.getTime();  

        long diff=d2.getTime()-d1.getTime();  
        int noofdays=(int)(diff/(1000*24*60*60));  
        System.out.println(noofdays);  
    }  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T21:34:41.247

```
@Test
public void threeConsecutiveDates() throws ParseException {
    List<Date> consecutive = new ArrayList<>();
    consecutive.add(new Date(0));
    final SimpleDateFormat format = new SimpleDateFormat("yyyy/MM/dd");

    String[] dates = {
            "2004/1/23", "2004/1/24", "2004/1/25",
            "2004/1/26", "2004/1/29", "2004/2/11",
            "2004/2/17", "2004/2/18", "2004/2/18", "2004/3/7"};
    for (String s : dates) {
        Date previous = consecutive.get(consecutive.size()-1);
        Date current = format.parse(s);
        if(previous.before(current) && (current.getTime()-previous.getTime() == 1000 * 60 * 60 * 24)) {
            consecutive.add(current);
        } else {
            consecutive.clear();
            consecutive.add(current);
        }
        if(consecutive.size() == 3) {
            break;
        }
    }
    System.out.println("consecutive = " + consecutive);
} 
```

# ios - 如何使用引脚和间距使我的界面居中在与屏幕尺寸无关的屏幕上

> ID：15211133
> 
> 赞同：0
> 
> 时间：2013-03-04T21:07:49.253
> 
> 标签：ios, objective-c, ios6

我在上面有一个按钮，上面有“EasyPost”标志，下面有一个标签，还有四个按钮。

在 3.5 英寸显示屏上，一切看起来都很棒，但我无法在 4 英寸显示屏上控制一切。在玩了一些约束和引脚之后，我刚刚删除了所有自定义引脚并保留了默认设置。

底部的两个大按钮拖到下面，我希望一切都一样。我想要的只是在 4 英寸显示屏上稍微向下移动所有这些，因此屏幕顶部的空白和底部屏幕上的空白是相同的。

以下是一些截图：

1.  非视网膜 - 一切都很棒 - [http://i45.tinypic.com/2d7ahxk.jpg](http://i45.tinypic.com/2d7ahxk.jpg)

2.  3.5 英寸视网膜 - 一切都好 - [http://i46.tinypic.com/2jwrw1.png](http://i46.tinypic.com/2jwrw1.png)

3.  4 英寸视网膜 - 糟糕的时代 - [http://i45.tinypic.com/35bgfww.png](http://i45.tinypic.com/35bgfww.png)

我尝试将按钮固定在一起，但低按钮会伸展。而且我无法删除底部空间以进行超级查看。可以做什么？

有时会随机发生这种情况，在我尝试清除约束之后 ![在此处输入图像描述](../Images/07b4401197d5e40f96099e6995c59902.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:08:34.403

弹簧和支柱在您尝试做的“组合”中使用起来很痛苦。我的想法是将您的四个按钮放在容器 UIView 中，然后通过移除所有弹簧和支柱将整个容器定位在中心。UIView 成本的快速而轻松的解决方案:)

# java - 进度条运行时阻塞线程

> ID：15211134
> 
> 赞同：-2
> 
> 时间：2013-03-04T21:07:49.493
> 
> 标签：java, swing, concurrency, event-dispatch-thread, jprogressbar

大家好，我想制作 ProgressBar，它会一直加载到歌曲开始……我有这个代码，但是当歌曲开始时 ProgressBar 正在启动，并且它会在大约 5 秒后完成。所以请有人帮我改正...谢谢:)

```
package passwordsaver1;
import java.awt.Dimension;
import java.awt.Toolkit;
import java.net.URL;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.Clip;
import javax.swing.JOptionPane;

public final class Music extends javax.swing.JFrame {

void centreWindow() {
    Dimension dimension = Toolkit.getDefaultToolkit().getScreenSize();
    int x = (int) ((dimension.getWidth() - getWidth()) / 2);
    int y = (int) ((dimension.getHeight() - getHeight()) / 2);
    setLocation(x, y);
}

public Music(String mainAccName) {
    initComponents();
    centreWindow();
    setTitle("PasswordSaver - Music");
    this.mainAccName = mainAccName;
}
String mainAccName;

private void pitbullActionPerformed(java.awt.event.ActionEvent evt) {                                        
    try {
        URL url = new URL("http://mini-mk-market.com/music/PitBulll.wav");
        Clip clip = AudioSystem.getClip();
        AudioInputStream ais;
        ais = AudioSystem.getAudioInputStream(url);
        clip.open(ais);
        clip.loop(5);
        clip.start();
        new Thread(new Start()).start();
    } catch (Exception ex) {
        JOptionPane.showMessageDialog(null, "Can't find Internet Connection !");
    }
}

// this is just for testing does the song will stop after clicking the new... but cant..
private void afrojackActionPerformed(java.awt.event.ActionEvent evt) {
    try {
        URL url = new URL("http://mini-mk-market.com/music/PitBulll.wav");
        Clip clip = AudioSystem.getClip();
        AudioInputStream ais;
        ais = AudioSystem.getAudioInputStream(url);
        clip.open(ais);
        clip.loop(0);
        clip.start();
        new Thread(new Start()).start();
    } catch (Exception ex) {
        JOptionPane.showMessageDialog(null, "Can't find Internet Connection !");
    }
}

public static void main(String args[]) {
    try {
                for (javax.swing.UIManager.LookAndFeelInfo info:
                javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(Music.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(Music.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(Music.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(Music.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(new Runnable() {
        @Override
        public void run() {
            //new Music().setVisible(true);
        }
    });
}

private class Start implements Runnable {

    @Override
    public void run() {
        for (int x = 0; x < 101; x++) {
            ProgressBar.setValue(x);
            ProgressBar.repaint();
            try {
                Thread.sleep(50);
            } catch (Exception ex) {
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:19:24.270

您可能正在寻找[`ProgressMonitorInputStream`](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html). [*How to Use Progress Monitors*](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html#monitors)中有讨论，在[`ProgressMonitorDemo`](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html#eg).

# mysql - Mysql 2147483647 上的 Varchar 问题

> ID：15211137
> 
> 赞同：3
> 
> 时间：2013-03-04T21:07:53.947
> 
> 标签：mysql, varchar

有`2147483647`MYSQL问题。

在电话字段中插入一个 11 位数字时，我将这个号码作为回报保存在`DB: 2147483647`

TEL 设置为`VARCHAR`不难`INT`。

此外，在托管在`SERVER`1 上的数据库上，我有完全相同的数据库表，并且没有遇到同样的问题？！可能是什么？

这是 SQL 和 PHP

```
tel_no  varchar(20) utf8_general_ci  Yes    NULL
mob_no  varchar(20) utf8_general_ci  Yes    NULL 
```

那就是MYSQL。是的，我在数据库中插入一个 11 位数字作为字符串

```
$telno = GetValue($post['tel_no']);
$mobno = GetValue($post['mob_no']); 

$sql = "UPDATE ".$this->dbpre."bookings SET tel_no='$telno', mob_no='$mobno'... 
```

你能帮忙吗？我快疯了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-22T08:46:40.827

2147483647 是 mysql 的最大 int 值。只需将类型从 int 更改为 bigint。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-31T07:15:46.943

检查[整数类型（精确值） - INTEGER、INT、SMALLINT、TINYINT、MEDIUMINT、BIGINT](http://dev.mysql.com/doc/refman/5.5/en/integer-types.html)和[答案](https://stackoverflow.com/questions/10255724/incorrect-integer-2147483647-is-inserted-into-mysql#answer-17783287)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-10-09T07:01:34.870

解决方案：只需将类型从 int 更改为**bigint**或将 varchar 更改为**bigint**。

# postgresql - 将数据从事务表移动到历史表以提高插入性能，postgres

> ID：15211142
> 
> 赞同：3
> 
> 时间：2013-03-04T21:07:58.703
> 
> 标签：postgresql, postgresql-9.2

我有 3 个数据库表，每个表包含 600 万行，每年增加 300 万行。

以下是表格信息： 表 1：20 个字段，每个字段平均 50 个字符。有 2 个索引都在时间戳字段上。表 2：5 个字段，2 字节数组字段和 1 个 xml 字段 表 3：4 个字段，1 字节数组字段

用法如下： 在每个表中每秒插入 15 到 20 条记录。通过连接前 2 个表来创建视图，并且选择主要基于第一个表中的日期字段。

现在，在所有三个表中分别插入一条记录总共需要大约 100 毫秒。

我打算从 postgres 8.4 迁移到 9.2。我还想对插入性能进行一些优化。另外，我打算创建历史表并将旧记录保存到这些表中。在这方面我有以下问题

1.  创建历史表并将旧数据移动到这些表是否有助于提高插入性能？
2.  如果有帮助，我需要多久将旧记录移动到历史记录表中，每天？还是每周/每月/每年？
3.  如果我只保留一个月（220,000）的数据而不是一年的数据（300 万），是否有助于提高插入性能？

在此先感谢， 苏德希尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:32:21.457

我敢肯定，比我更了解情况的人会出现并提供更好的答案，但我的印象是：

*   插入性能主要取决于您的索引策略和硬件
*   一般来说，性能在 9.0+ 下比 8.4 好，这可能会影响插入性能，但我不确定。
*   您的任何想法都不会*直接*影响插入性能

现在，也就是说，维护小索引的成本低于大索引，因此创建历史表并将旧数据移到那里可能会通过降低索引压力来提高性能。但我希望删除您的一个索引会产生直接和更大的影响。也许您可以拥有一个包含两个索引的历史表，并在“今天”表中维护其中一个？

如果我站在你的立场上，我会在运行 8.4 且配置类似的机器上获得一份生产副本。然后升级到9.2，看看插入性能有没有变化。然后尝试这些想法并对其进行基准测试，看看哪些可以改善情况。为了产生有用的信息，让事情尽可能与生产保持相似是绝对必要的，但它肯定会比你可能得到的任何假设答案更好的信息。

现在，插入一行 IMO 100 毫秒似乎很慢。更好的硬件肯定会改善这种情况。通常的建议是带有电池后备缓存的大型条带 RAID 阵列。*PostgreSQL 9.0 High Performance*有更多关于这一切的信息。

# linux - 我们需要禁用 riak 的交换吗？

> ID：15211143
> 
> 赞同：2
> 
> 时间：2013-03-04T21:07:59.777
> 
> 标签：linux, linux-kernel, swap, ram, riak

我刚刚在 riak 文档中发现交换使服务器无响应，因此必须禁用它。如果 Riak 节点使用太多 RAM，它也可以被内核杀死。如果交换完全禁用，Riak 将直接退出。我很困惑我们是否必须禁用交换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:30:10.967

[http://docs.basho.com/riak/latest/cookbooks/Linux-Performance-Tuning/](http://docs.basho.com/riak/latest/cookbooks/Linux-Performance-Tuning/)

> 交换空间
> 
> 由于 Riak 高度关注 I/O 配置文件，swap 的使用可能会导致整个服务器变得无响应。禁用交换或以其他方式实施解决方案以确保不交换 Riak 的进程页面。
> 
> Basho 建议如果 Riak 节点使用过多的 RAM，则允许它被内核杀死。如果交换完全禁用，Riak 将在无法分配更多 RAM 时简单地退出，并在 /var/log/riak 目录中留下可用于取证的故障转储（名为 erl_crash.dump）（由 Basho 客户服务工程师提供）如果您是客户）。

*所以不，你*不必......但如果你不这样做并且你使用了所有可用的 RAM，那么机器可能会变得无响应。

对于执行繁重 I/O 的*任何*（无限制）应用程序，您可能会耗尽系统内存，这将是这种情况。通常，您会在机器上进行监控，警告您内存使用量超过阈值。

# ruby-on-rails - 在 Rails 中创建新页面（没有在 /app/layouts/* 文件中指定的布局）

> ID：15211144
> 
> 赞同：0
> 
> 时间：2013-03-04T21:08:00.140
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的大多数视图文件都具有相同的布局，因此定义`layouts/application.html.haml`（和其他文件）是合理的。`header``footer`

但现在我需要创建一个没有任何这些样式的页面。事实上，我只想要一个带有标题的普通页面。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:14:43.547

您可以像这样在控制器中指定布局：

```
class ThingsController < ApplicationController
  layout "some_layout"

  # rest of the controller
end 
```

这将寻找`app/views/layouts/some_layout.html.erb`

您还可以使用一种方法来选择布局：

```
class ThingsController < ApplicationController
  layout :choose_layout

  def choose_layout
    current_user.cat? ? "cat" : "dog"
  end
  # rest of the controller
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:27:51.707

我想你在追求。在您的控制器中，假设您的操作称为 myaction

```
 def myaction
      # do here whatever you need to do and then
      render :layout => false
    end 
```

请参阅 Rails 指南中的渲染选项[：布局和重新渲染](http://guides.rubyonrails.org/layouts_and_rendering.html)

# asp.net - RenderPartial 和 UpdatePanel 的区别？

> ID：15211147
> 
> 赞同：0
> 
> 时间：2013-03-04T21:08:11.047
> 
> 标签：asp.net, asp.net-mvc-4

是否 RenderPartial,RenderSection (MVC) 与 UpdatePanel 具有相同的概念，即进行部分回发。

# solr - Solr 4.1 未处理关于 delta-import 的添加文档

> ID：15211150
> 
> 赞同：0
> 
> 时间：2013-03-04T21:08:26.113
> 
> 标签：solr

我的 data-config.xml 中有以下内容：

```
<dataConfig>
  <dataSource dataSource info"/>
  <document>
   <entity name="item"
        pk="itemid"
        query=" SELECT itemid,start,end,item_categoryid
                FROM item"
        deltaImportQuery="  SELECT  * FROM item
                            WHERE   itemid = '${dataimporter.delta.item_id}'"
        deltaQuery="    SELECT  itemid
                        FROM    item
                        WHERE   last_mod > '${dataimporter.last_index_time}'
                            OR  create_time> '${dataimporter.last_index_time}'">
        <field column="itemid" name="item_id"/>
        <field column="start" name="start"/>
        <field column="end" name="end"/>
        <entity name="item_category" 
                pk="item_categoryid"
                query=" SELECT  item_categoryid,desc,title 
                        FROM    item_category
                        WHERE   mbpostingid='${item.item_categoryid}'"
                deltaImportQuery="  SELECT  * FROM item_category
                                    WHERE   item_categoryid= '${dataimporter.delta.id}'"
                deltaQuery="SELECT  item_categoryid
                            FROM    item_category
                            WHERE   last_mod > '${dataimporter.last_index_time}'
                                OR  create_time > '${dataimporter.last_index_time}'">
           <field column="item_categoryid" name="id"/>
           <field column="desc" name="desc"/>
           <field column="title" name="title"/>
        </entity>
    </entity>
  </document>
</dataConfig> 
```

每当我运行增量导入

`http://localhost:8983/solr/dataimport?command=delta-import`

Solr 正在更新我的数据库中已更新的行，但不会为已添加的行添加索引，也不会为已删除的行删除索引。

Solr 识别（获取）我新添加的行到我的数据库，但它不会“处理”它们

`<str name="Total Documents Processed">0</str>`

我的dataConfig有什么问题吗？有什么我可以做的吗？

谢谢， 迦勒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:48:29.127

```
query="SELECT itemid,start,end,item_categoryid
            FROM item"
deltaImportQuery="SELECT  * FROM item
                  WHERE   itemid = '${dataimporter.delta.item_id}'"
                                                         ^-----^ 
```

我们必须在变量中使用确切的列名。在我看来，列名是`itemid`（没有下划线），所以你应该试试这个：

```
query="SELECT itemid,start,end,item_categoryid
            FROM item"
deltaImportQuery="SELECT  * FROM item
                  WHERE   itemid = '${dataimporter.delta.itemid}'"
                                                         ^----^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T20:26:19.103

尝试

```
deltaImportQuery="SELECT  * FROM item
                  WHERE   itemid = '${dih.delta.item_id}'" 
```

[http://wiki.apache.org/solr/DataImportHandler](http://wiki.apache.org/solr/DataImportHandler)说：

deltaImportQuery ：（仅在 delta-import 中使用）。如果不存在，DIH 会尝试通过（在识别增量之后）修改“查询”来构造导入查询（这很容易出错）。有一个命名空间**${dih.delta.column-name}**可以在这个查询中使用。例如：select * from tbl where id=${dih.delta.id}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-01T11:54:27.260

```
<entity name="searchitemcontent" pk="itemid" 
        query="select skuid, noofsupp, membership, isnull(negotiable,0) as negotiable from searchskumaster skm "
        deltaImportQuery="select skuid, skuname, combineskuname,Category, Product, Brand, Price, discount, url, image, itemstatus , supplierid,itemid, marketprice,mwsimage, pricestatus, isservice ,suppliername, noofsupp, membership, isnull(negotiable,0) as negotiable from
        searchskumaster skm where itemid='${dih.delta.itemid}'"
        deltaQuery="select itemid  from searchskumaster where modifieddate &gt; '${dataimporter.last_index_time}'"
        deletedPkQuery="SELECT itemid FROM searchskumaster where isdeleted=1 and modifieddate &gt; '${dataimporter.last_index_time}' "> 
```

注意：选择**itemid**。在`deltaQuery`和`deltaImportQuery`查询中，**itemid** ='${dih.delta. **itemid** } ，在两个查询中 itemid 应该是相同的名称

# python - 从 OBJ 到 WebGL - Python GAE

> ID：15211153
> 
> 赞同：0
> 
> 时间：2013-03-04T21:08:38.127
> 
> 标签：python, google-app-engine, webgl

我必须编写一个应用程序，它需要一个 OBJ 文件（+MTL，+纹理）并在 Web 浏览器中显示一个 3D WebGL 对象。我使用谷歌应用引擎（Python）。

我尝试使用 PyGame 库来做到这一点，但 PyGame 使用 C 代码来提高性能，并且只有纯 Python 库可以与 Google App Engine 一起使用。

有没有其他图书馆可以帮助我做到这一点？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T09:59:13.257

谷歌应用引擎在这里无关紧要，它只是文件的来源。

PyGame 只能在你的 PC 上运行，即使它是用纯 python 编写的，也不适合这个。

您需要的唯一库是 WebGL 库本身和托管文件的地方（GAE 或 1000 个其他地方都可以），以便可以将它们传输到目标浏览器。

例如： http: [//www.chromeexperiments.com/webgl/](http://www.chromeexperiments.com/webgl/)

这些都不是托管在 GAE 上（可能），但它们都显示 3D WebGL 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:04:31.493

有几项免费服务可以为您做到这一点 - 无需编写任何代码。我会提到我们的[Verold Studio](http://studio.verold.com)，但还有其他的。如果您只想在您的页面上旋转模型，那么绝对不要浪费您的时间来构建它 - 有很多服务可以为您做到这一点。

如果您需要使用您的 3D 数据编写自定义应用程序，您可以直接使用 WebGL 或 Three.js 等渲染库之一构建它。我们在内部使用 Three.js，如果这是您选择的方式，我建议您查看我们的工具和[Verold 引擎](http://verold.com/verold-engine)。该引擎是我们的最新产品，它是一种轻松构建 3D 应用程序的极其强大的方式。我们的第一个参考应用程序是[Falling in Circles](http://labs.verold.com/falling-in-circles)，请查看。

# tsql - Sybase TSQL如何选择没有`-`字符

> ID：15211154
> 
> 赞同：2
> 
> 时间：2013-03-04T21:08:39.293
> 
> 标签：tsql, sap-ase, isql

我的问题很简单，我试图通过使用`SELECT`语句打印文本和数字的组合。但是，当我尝试使用这种方法打印文本时，会得到很多杂项`-`字符。

如何在不打印`-`字符的情况下使用 select 语句？

例如：

`SELECT "HELLO WORLD"`

会导致：

```
---------------------
HELLO WORLD 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:42:33.383

启动*isql*时，使用*-b*选项来禁止打印标题。

```
isql -Uusername -Sservername -b 
```

# css - CSS 翻转立方体

> ID：15211156
> 
> 赞同：1
> 
> 时间：2013-03-04T21:08:41.840
> 
> 标签：css, animation, rotation, css-transitions, transition

我用 CSS3 做了一些实验。我想用只有 2 个 DIV 构建一个翻转立方体。像这样： [http](http://cssdeck.com/labs/css3-flipping-cube) ://cssdeck.com/labs/css3-flipping-cube （我不喜欢这个解决方案，因为 div 必须始终居中）所以我试图找到我自己的解决方案。我的 HTML 结构如下所示：

```
<div class="outer">
  <div class="face face1">Click here !</div>
  <div class="face face2"></div>
</div> 
```

我的 CSS 文件如下所示：

```
.outer { margin-left:52px; position:relative; width:400px; perspective:500px; }
.face { width:100%; height:50px; padding:0 10px; background-color:#E5E5E5; position:absolute; }
.face.face1 { height:50px; background-color:#E5E5E5; transform:rotateX(0deg); transform-origin:0 0 0; z-index:1; top:0; }
.face.face2 { height:50px; background-color:#007CC1; transform:rotateX(-90deg); transform-origin:0 50px 0; z-index:3; top:0; }
.face.face1.start { transform:rotateX(90deg); transition:transform 1s ease-out; }
.face.face2.start { transform:rotateX(0deg); transition:transform 1s ease-out; } 
```

当我点击`face1`然后 javascript 添加类开始到 div 是动画。

```
$(function(){
    $('.outer').on('click', function(){
        $('.face1').addClass('start');
        $('.face2').addClass('start');
    });
}); 
```

我的解决方案目前看起来不太好。你对我有什么建议或想法吗？你可以在这里看到整个代码：

[http://jsfiddle.net/dAXRX/3/](http://jsfiddle.net/dAXRX/3/)

（我没有使用`-webkit`前缀。它目前仅适用于 Firefox）

# android - 如果文件存在，如何运行我的 Intent

> ID：15211158
> 
> 赞同：-5
> 
> 时间：2013-03-04T21:08:47.313
> 
> 标签：android

如果文件存在，我想运行我的 Intent，否则显示找不到文件的消息。这是我的代码

```
if (!file.exists())

 {
  Toast.makeText(MyActivity.this, " the file not found",Toast.LENGTH_LONG).show();
 }      

 {
  Intent intent = new Intent(getApplicationContext(),BooksActivity.class );
  startActivity(intent);
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:12:00.553

看起来你忘记了 else 声明，我稍微修改了你的意图：

```
if (!file.exists()) {
  Toast.makeText(MyActivity.this, " the file not found",Toast.LENGTH_LONG).show();
}      

else {
  Intent intent = new Intent(MyActivity.this,BooksActivity.class );
  startActivity(intent);
} 
```

# python - 将具有类 JSON 对象的文本文件解析为 CSV

> ID：15211160
> 
> 赞同：0
> 
> 时间：2013-03-04T21:08:59.780
> 
> 标签：python, json, csv

我有一个包含键值对的文本文件，最后两个键值对包含类似 JSON 的对象，我想将它们拆分为列并与其他值一起写入，使用键作为列标题。数据文件的前三行`input.txt`如下所示：

```
InnerDiameterOrWidth::0.1,InnerHeight::0.1,Length2dCenterToCenter::44.6743867864386,Length3dCenterToCenter::44.6768028159989,Tag::<NULL>,{StartPoint::7858.35924983374[%2C]1703.69341358077[%2C]-3.075},{EndPoint::7822.85045874375[%2C]1730.80294308742[%2C]-3.53962362760298}
InnerDiameterOrWidth::0.1,InnerHeight::0.1,Length2dCenterToCenter::57.8689351603823,Length3dCenterToCenter::57.8700464193429,Tag::<NULL>,{StartPoint::7793.52927597915[%2C]1680.91224357457[%2C]-3.075},{EndPoint::7822.85045874375[%2C]1730.80294308742[%2C]-3.43363070193163}
InnerDiameterOrWidth::0.1,InnerHeight::0.1,Length2dCenterToCenter::68.7161350545728,Length3dCenterToCenter::68.7172034962765,Tag::<NULL>,{StartPoint::7858.35924983374[%2C]1703.69341358077[%2C]-3.075},{EndPoint::7793.52927597915[%2C]1680.91224357457[%2C]-3.45819643838485} 
```

我们最终想出了一些可行的方法，但一定有更好的方法：

```
import csv
with open('input.txt', 'rb') as fin, open('output.csv', 'wb') as fout:
    reader = csv.reader(fin)
    writer = csv.writer(fout)
    for i, line in enumerate(reader):
        mysplit = [item.split('::') for item in line if item.strip()]
        if not mysplit: # blank line
            continue
        keys, vals = zip(*mysplit)
        start_vals = [item.split('[%2C]') for item in mysplit[-2]]
        end_vals = [item.split('[%2C]') for item in mysplit[-1]]
        a=list(keys[0:-2])
        a.extend(['start1','start2','start3','end1','end2','end3'])
        b=list(vals[0:-2])
        b.append(start_vals[1][0])
        b.append(start_vals[1][1])
        b.append(start_vals[1][2][:-1])
        b.append(end_vals[1][0])
        b.append(end_vals[1][1])
        b.append(end_vals[1][2][:-1])
        if i == 0:
            # if first line: write header
            writer.writerow(a)
        writer.writerow(b) 
```

`output.csv`生成如下所示的输出文件

```
InnerDiameterOrWidth,InnerHeight,Length2dCenterToCenter,Length3dCenterToCenter,Tag,start1,start2,start3,end1,end2,end3
0.1,0.1,44.6743867864386,44.6768028159989,<NULL>,7858.35924983374,1703.69341358077,-3.075,7822.85045874375,1730.80294308742,-3.53962362760298
0.1,0.1,57.8689351603823,57.8700464193429,<NULL>,7793.52927597915,1680.91224357457,-3.075,7822.85045874375,1730.80294308742,-3.43363070193163
0.1,0.1,68.7161350545728,68.7172034962765,<NULL>,7858.35924983374,1703.69341358077,-3.075,7793.52927597915,1680.91224357457,-3.45819643838485 
```

我们以后不想写这样的代码。

读取这样的数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:30:15.743

我会使用：

```
from itertools import chain
import csv

_header_translate = {
    'StartPoint': ('start1', 'start2', 'start3'),
    'EndPoint': ('end1', 'end2', 'end3')
}

def header(col):
    header = col.strip('{}').split('::', 1)[0]
    return _header_translate.get(header, (header,))

def cleancolumn(col):
    col = col.strip('{}').split('::', 1)[1]
    return col.split('[%2C]')

def chainedmap(func, row):
    return list(chain.from_iterable(map(func, row)))

with open('input.txt', 'rb') as fin, open('output.csv', 'wb') as fout:
    reader = csv.reader(fin)
    writer = csv.writer(fout)
    for i, row in enumerate(reader):
        if not i:  # first row, write header first
            writer.writerow(chainedmap(header, row))
        writer.writerow(chainedmap(cleancolumn, row)) 
```

The `cleancolumn` method takes any of your columns and returns a tuple (possibly with only one value) after removing the braces, removing everything before the first `::` and splitting on the embedded 'comma'. By using `itertools.chain.from_iterable()` we turn the series of tuples generated from the columns into one list again for the csv writer.

When handling the first line we generate one header row from the same columns, replacing the `StartPoint` and `EndPoint` headers with the 6 expanded headers.

# c# - 使用沙盒解决方案设置共享点列表项的自定义权限

> ID：15211165
> 
> 赞同：0
> 
> 时间：2013-03-04T21:09:25.440
> 
> 标签：c#, sharepoint, permissions, sandbox

看起来无法使用沙盒解决方案在 SharePoint 列表项上设置自定义权限，但无论如何都想问这个问题。

我想在沙盒解决方案中完成类似的事情： [List Item multiple users permissions programatically (sharepoint)](https://stackoverflow.com/questions/6413374/list-item-multiple-users-permissions-programatically-sharepoint)

任何帮助/建议将不胜感激。

谢谢， 普雷姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:21:52.973

基本上应该是可以的。唯一对您不可用的是`RunWithElevatedPrivileges`，因此您必须检查当前用户是否有足够的权限来运行`BreakRoleInheritance`和使用 例如`RoleAssignments`。此外，如果您只考虑沙盒解决方案（而不是 SharePoint Online），您可以移动一些功能（例如单独场解决方案`RunWithElevatedPrivileges`中的[沙盒代理](http://msdn.microsoft.com/en-us/library/ff798427.aspx)（这些代理在联机版本中不可用）。

# security - 邀请系统是否需要使用哈希而不是用户 ID？

> ID：15211168
> 
> 赞同：1
> 
> 时间：2013-03-04T21:09:33.947
> 
> 标签：security

我正在实现一个推荐系统，我想知道我是否需要使用哈希作为referrer_id，或者我是否可以只使用用户的 id？我不想教条地使用哈希值，所以你能给我一些潜在陷阱的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:25:24.230

这取决于对你来说什么是重要的。如果您需要确定referrer_id 来自提供推荐的用户，那么您将需要某种哈希值和无法猜测的令牌。如果您所做的只是散列用户 ID，那么您并没有提供任何真正的安全性，因为攻击者可以简单地猜测用户 ID 并对其进行散列以使您的服务器满意。

重要的是要知道散列不会产生任何不可预测性。对于相同的输入，它将*始终*产生相同的输出。散列很有价值，因为它可以防止篡改（输入的微小变化会导致输出的巨大变化）并且可以标准化数据的大小，但绝不应将其与加密相混淆。

您对referrer_id 的机密性、完整性和可用性有多关心？这些问题的答案将决定您需要付出多少努力来保护referrer_id。

# javascript - TypeError Object[object object] 没有方法 SubSelf，TypeError Object[object object] 没有方法 intersectsPlane

> ID：15211171
> 
> 赞同：7
> 
> 时间：2013-03-04T21:09:41.427
> 
> 标签：javascript, three.js, webgl

在使用出色的 Sim.js 和 Three.js 库处理 WebGL 项目时，我偶然发现了下一个问题：

在此过程中，它使用了 THREE.Ray 的下一个构造函数：

```
var ray = new THREE.Ray( this.camera.position, vector.subSelf( this.camera.position ).normalize() ); 
```

其中向量是向量3，

这会触发以下错误：

TypeError Object[object object] 没有方法 subSelf。

我检查了我正在使用的 Three.js 的文档以及 vector3 上最接近这个的方法

```
.sub( v ) Vector3 
```

我尝试更改此设置，并在此调用中显示一个新错误：

```
var intersects = ray.intersectScene( this.scene ); 
```

这再次引发错误，因为当我检查时，ray 没有 intersectsPlane 方法

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-04T21:22:06.073

我相信 THREE.js api 不久前发生了变化。

`Vector3`正如您所发现的，`subSelf()` [现在很简单。`sub()`](https://github.com/mrdoob/three.js/blob/master/src/math/Vector3.js#L127)

[看起来应该](https://github.com/mrdoob/three.js/blob/master/src/math/Ray.js#L130)`Ray`是这样。`intersectsPlane()` [`intersectPlane()`](https://github.com/mrdoob/three.js/blob/master/src/math/Ray.js#L130)

如果你想要复杂的场景交叉点，[你可能想要使用它`Raycaster`](https://github.com/mrdoob/three.js/blob/master/src/core/Raycaster.js)。文档： http: [//mrdoob.github.com/three.js/docs/56/#Reference/Core/Raycaster](http://mrdoob.github.com/three.js/docs/56/#Reference/Core/Raycaster)

[Three.js 文档并不是有史以来最好的东西......但是，只需检查源代码](https://github.com/mrdoob/three.js/tree/master/src)就可以收集到很多见解。

# android - 使用 OnTouchListener 重绘 GLRenderered Square？

> ID：15211177
> 
> 赞同：0
> 
> 时间：2013-03-04T21:09:52.667
> 
> 标签：android, opengl-es-2.0, ontouchlistener

我的程序是在触摸屏幕时出现一个白色方块并沿 za 轴移动。

我的目标和问题是，我还希望在一次又一次地触摸屏幕时再次发生这种情况。

出于某种原因添加 invalidate(); square.draw 后不起作用。我还尝试在活动类中创建一个线程来锁定和解锁画布。我不太确定我在做什么，如果有人能指出我正确的方向，那就太好了！

这是我的活动课程中的 GLRendering 课程

```
public class GL1Activity extends Activity implements OnTouchListener {

GLSurfaceView ourSurface;
float x,y;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    ourSurface = new GLSurfaceView(this);
    ourSurface.setOnTouchListener(this);
    x=0;
    y=0;
    ourSurface.setRenderer(new GL1Renderer()); //links to GL1Renderer
    setContentView(ourSurface);

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    ourSurface.onPause();
}

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
    ourSurface.onResume();

    }

@Override
public boolean onTouch(View v, MotionEvent event) {
    // TODO Auto-generated method stub
    x = event.getX();
    y = event.getY();

    return false;
} 

public class GL1Renderer implements Renderer {

    private GL1Square square;
    float zoomz;
    public GL1Renderer (){
        square = new GL1Square();
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig eglconfig) {
        // TODO Auto-generated method stub
    gl.glDisable(GL10.GL_DITHER);
    gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_FASTEST);
    gl.glClearColor(.1f, .1f, .1f, 1); //painting background
    gl.glClearDepthf(1f);

    }

    @Override
    public void onDrawFrame(GL10 gl) {
        // TODO Auto-generated method stub
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);

        gl.glMatrixMode(GL10.GL_MODELVIEW);
        gl.glLoadIdentity();
        GLU.gluLookAt(gl, 0, 0, -5, 0, 0, 0, 0, 3, 0);
        if (x != 0 && y != 0){  
        gl.glTranslatef(0, 0, zoomz);
        if (zoomz < 50) {
            zoomz-=.1;      
        }
        if (zoomz > 50){
            zoomz = 0;
        }
        square.draw(gl);

        };
    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        // TODO Auto-generated method stub
        gl.glViewport(0, 0, width, height);
        float ratio = (float) width/height;
        gl.glMatrixMode(GL10.GL_PROJECTION);
        gl.glLoadIdentity();
        gl.glFrustumf(-ratio, ratio, -1, 1, 1, 25); 
        }
    } 
```

这是方码；

```
public class GL1Square {

private float vertices[] = {
        -1.0f, 1.0f,
        1.0f, 1.0f,
        1.0f, -1.0f,
        -1.0f, -1.0f,
};
private short[] pIndex = { 0, 1, 2, 0, 2, 3};

private ShortBuffer pBuff;

private FloatBuffer vertBuff;

public GL1Square(){
    ByteBuffer bBuff = ByteBuffer.allocateDirect(vertices.length * 4);
    bBuff.order(ByteOrder.nativeOrder());
    vertBuff = bBuff.asFloatBuffer();
    vertBuff.put(vertices);
    vertBuff.position(0);

    ByteBuffer pbBuff = ByteBuffer.allocateDirect(pIndex.length * 2);
    pbBuff.order(ByteOrder.nativeOrder());
    pBuff = pbBuff.asShortBuffer();
    pBuff.put(pIndex);
    pBuff.position(0);
}

public void draw(GL10 gl){
    gl.glFrontFace(GL10.GL_CW);
    gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glEnable(GL10.GL_CULL_FACE);
    gl.glCullFace(GL10.GL_FRONT);
    gl.glVertexPointer(2, GL10.GL_FLOAT, 0, vertBuff);
    gl.glDrawElements(GL10.GL_TRIANGLES, pIndex.length, GL10.GL_UNSIGNED_SHORT, pBuff);
    gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glDisable(GL10.GL_CULL_FACE);
} 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-08T03:35:13.523

也许尝试从您的 Activity 类中调用 onDrawFrame() ...？无论如何，根据我的理解，这将重新绘制框架。

# ios - 忽略 ssl 认证 MKNetworkKit

> ID：15211178
> 
> 赞同：0
> 
> 时间：2013-03-04T21:09:54.427
> 
> 标签：ios, mknetworkkit

因此，似乎 ASIHTTPRequest 允许您忽略 https:// 端点上的证书。我目前正在使用 MKNetworkKit 并且已经实现了我所有的调用。不幸的是，我们的测试服务器在 https 上，但没有 SSL 证书。

我可以使用带有 -k 命令的 curl 进行正常连接。我在 MKNetworkKit 中尝试了各种方法来忽略 NSURLAuthenticationChallenge，但无济于事。我尝试的最新方法如​​下：

```
op.authHandler = ^(NSURLAuthenticationChallenge *challenge)
{
    NSURLCredential *credential = [NSURLCredential credentialWithUser:_userName password:password persistence:NSURLCredentialPersistenceNone];
    [challenge.sender useCredential:credential forAuthenticationChallenge:challenge];
}; 
```

这让我实际上得到了一个 401 错误返回（而不是空白）。查看 curl 字符串，MKNetworkKit 会在上述块命中时删除我的用户名/密码。我不确定这是否是进步。

任何人都知道如何简单地忽略 SSL 证书？

编辑：

我必须更新 MKNetwork 套件才能启用新方法`ShouldContinueWithInvalidCertificate`，`MKNetworkOperation`并且我的测试服务器修复了 certError。

但是，现在我发生了一个奇怪的错误。我仍然无法从服务器上的两个特定端点获得任何回报。我查看请求，将其作为 curl 复制到命令中，然后立即返回结果。我也没有从操作中得到错误。

这里发生了什么事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T23:44:32.967

该类`MKNetworkOperation`有一个名为的属性`shouldContinueWithInvalidCertificate`，默认为 NO。您所要做的就是将其设置为“是”，它将忽略证书。

评论：

```
/*!
 *  @abstract Boolean variable that states whether the operation should continue if the certificate is invalid.
 *  @property shouldContinueWithInvalidCertificate
 *
 *  @discussion
 *  If you set this property to YES, the operation will continue as if the certificate was valid (if you use Server Trust Auth)
 *  The default value is NO. MKNetworkKit will not run an operation with a server that is not trusted.
 */ 
```

# php - Symfony2 - 包含当前包中的模板

> ID：15211179
> 
> 赞同：0
> 
> 时间：2013-03-04T21:09:55.840
> 
> 标签：php, symfony, twig

我无法在 Twig 或 Symfony2 文档中找到任何有用的信息，所以我想在这里问一下。

有谁知道是否可以在 Symfony2 中包含一个相对于当前包的 Twig 模板，而不指定名称？这些方面的东西：

`{% include .:Foo:bar.html.twig %}`

当它们都在同一个包中时，我有点厌倦了必须输入又长又丑的包名。也意味着如果捆绑名称因任何原因而更改，我必须查找并替换每个单独的包含。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:28:03.010

早在我使用捆绑软件的时候，我就想出了一个快速的解决方案，你可以基于它：

```
{% set bundle = app.request.get('_template').get('bundle') %}
{% set controller = app.request.get('_template').get('controller') %}

{% include bundle ~ ':' ~ controller ~ ':foo.html.twig' %} 
```

# javascript - 从 get ajax 调用中获取变量

> ID：15211186
> 
> 赞同：0
> 
> 时间：2013-03-04T21:10:11.710
> 
> 标签：javascript, jquery, ajax, json

这个问题其实是我对jquery没有完全理解造成的。

我有一些代码试图放入一个函数中以多次使用。

```
function actors(query){
    $.get("websit.com?title=" + query + "&type=json", function(html){
        var result = html;
        var obj = eval ("(" + result + ")");
        var actor = obj[0].actors;
        return actor; //as far as im aware this does nothing
    });
    return 0; // gets here and returns zero, returning actor here returns undefined
} 
```

演员变量包含我需要的信息，但是我正在努力将变量从函数中取出。由于内部函数，它将贯穿并到达`return 0;`

如果我尝试将变量分配给内部函数，它将返回一个对象而不是返回变量。

任何正确方向的解决方案或指针将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:11:59.517

这个问题每月被问 1000 次。您不能使异步调用像同步调用一样。这就是回调的用途。

你也在用jQuery，没必要用eval！设置正确的内容类型，它将为您解析数据。

带有回调的基本思想

```
function actors(query, callback){
    $.getJSON("websit.com?title=" + query + "&type=json", function(data) {
        var actor = data[0].actors;
        callback(actor);
    });
}

function processResults(info){
    console.log(info);
}

actors("Something", processResults); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:18:26.533

虽然确实不能这样做，但我发现在我遇到的大多数情况下，这样的事情是一种可以接受的解决方法：

```
function getMeSomeJSON(query) {    
  return $.get("websit.com?title=" + query + "&type=json");
} 
```

这会将请求的响应返回给调用它的任何内容。

或者，您可以：

*   将响应传递给回调。
*   将 $.ajax 与 async: false 一起使用，但是，这被认为是不好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:18:13.710

[阅读文档。](http://api.jquery.com/jQuery.get/)它有一些示例，包括数据类型处理。一个简单的检查应该有助于确定返回什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T21:22:03.423

正如您自己所注意到的，您的 ajax 响应处理程序在 actor 函数返回*后*执行，因此返回值相当困难。标准解决方案是从参与者函数返回一个承诺。[您可以在jquery docs](http://api.jquery.com/category/deferred-object/)中阅读承诺或延迟对象。

这将是我的建议：

```
function actors(query){
    var actorsPromise = $.Deferred();
    $.get("websit.com?title=" + query + "&type=json", function(html){
        var result = html;
        var obj = eval ("(" + result + ")");
        var actor = obj[0].actors;
        actorsPromise.resolve(actor);
    });
    return actorsPromise;
}

actors(/* your query */).done(function(actor) {
    //do whatever you need with your actor
}); 
```

# matlab - 在matlab中在公差范围内找到长度不等的向量中的相似元素

> ID：15211198
> 
> 赞同：1
> 
> 时间：2013-03-04T21:10:43.007
> 
> 标签：matlab, vector, compare

我有两个长度不等的列向量，`calib`（75 个元素）和`nu`（1436 个元素）。我需要在 0.001 的容差内找到与元素`nu`匹配的元素`calib`，然后对结果向量执行操作。所有元素都是数字而不是字符串。

我认为 intersect 将是要走的路，但我看不到引入公差的方法。同样使用带有绝对差异语句的 for 循环似乎也不起作用。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:13:32.193

您可以将`round`其中一个向量显示为仅 0.001 的准确度，然后使用`ismember`. 或者只使用FEX 中的[ismemberf](http://www.mathworks.com/matlabcentral/fileexchange/23294-ismemberf) - 浮点 ISMEMBER（即，具有舍入容差）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:45:17.613

为此，我有另一种 Matlabic (=matrix) 方式。我不知道它的计算效率如何，但 Matlab 对矩阵应该很好。

我假设`size(nu) = [75,1]`和`size(calib) = [1436,1]`。第一步是制作两个 1436x75 的大矩阵（注意转置）：

```
calib_m = repmat(calib',size(nu))
nu_m = repmat(nu,size(calib')) 
```

然后你可以制作另一个矩阵`1436x75`，它是上面的绝对差：

```
diff_m = abs(calib_m - nu_m) 
```

现在找到每列中的最小元素：

```
min_m = min(diff_m) 
```

然后你可以引入你的阈值并进行逻辑索引（应该很快）：

```
ok_calib_elements = calib(min_m < THRESHOLD) 
```

PS：我这里没有matlab，所以代码没有测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:42:10.503

谢谢您的帮助。矩阵数学把我带到了我需要去的地方。我不知道是否有更好的方法来做到这一点，但这是我的代码有效：

```
% set tolerance for finding equal values in the data
find_tol = 1E-3; 

% make matrices of the data and clibration vectors
nu_m = repmat(nu',size(calib));
calib_m = repmat(calib,size(nu'));

% subtract the matrices
diff_m = calib_m - nu_m;

% find the minimum of each column within the tolerance and compute the
% average shift
find_min_nu = find(diff_m < find_tol & diff_m > -find_tol);
min_nu = diff_m(find_min_nu);
shift_nu = mean(min_nu);

% output calibrated values
calib_nu = nu + shift_nu; 
```

# login - 基于用户组 Symfony 1.4.20 和 sfDoctrineGuard 登录

> ID：15211201
> 
> 赞同：0
> 
> 时间：2013-03-04T21:10:52.377
> 
> 标签：login, symfony1, symfony-1.4, sfguard

我正在开发一个 Symfony1 应用程序，我正在使用 sfDoctrineGuard 插件，一切都已配置好并且工作正常！但我有一个问题，我创建了 3 个用户：

```
username              group_name
administrador         super_administrator
user1                 group1
user2                 - 
```

我还有两个应用程序站点和管理员。用户管理员可以登录和访问管理员端的所有内容，其他用户（如 user1 和 user2 不能）。user1 和属于 group1 的每个用户都可以在站点前端登录，user2 和未分配 group1 的用户不能。我尝试以这种方式保护作为站点应用程序入口点的模块仪表板：

```
default:
   is_secure: true
   credentials: group1 
```

但它不起作用我总是收到这条消息：

> 哎呀！您要求的页面是安全的，并且您没有适当的凭据。

我怎样才能做到这一点？我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:34:19.380

`sfDoctrineGuard`转换`permissions`为凭据，因此您应该创建像 group1 （或更有意义的东西）这样的权限并将它们分配给用户或组。`sfDoctrineGuard`将聚合组和用户权限。这样，您可以在需要凭证的任何地方使用权限名称。如果您想禁止特定权限的登录，您应该覆盖`sfGuardValidatorUser`或`sfGuardSecurityUser::signIn`使用`$user->hasPermission('group1')`来检查用户是否具有所需的权限。

# xquery - 一个节点中的 Xquery 多个结果

> ID：15211205
> 
> 赞同：0
> 
> 时间：2013-03-04T21:11:05.387
> 
> 标签：xquery, xquery-sql, xquery-update, xquery-3.0

当我尝试在 xml 文件上执行我的 Xquery 代码时，我在我的一个字段中得到了多个结果。

这是我的xml文件

```
<Actors>
<Actor name="NTR">
    <Movie  TITLE="Yamadonga" Director="Rajamouli"></Movie>
        <Movie TITLE="AADI" Director="VV vinayak">
    </Movie>
</Actor>
<Actor name="Rajeev">
    <Movie  TITLE="Yamadonga" Director="Rajamouli" ></Movie>

</Actor>
<Actor name="mahesh">
    <Movie  TITLE="pokiri" Director="puri">
    </Movie>
</Actor> 
```

我的 xquery 文件

```
<Director>
{
for $Movie in doc("actors.xml")/Actors/Actor/Movie
return
if($Movie/@TITLE=$title)
then
data($Movie/@Director)
else()
}
</Director> 
```

最重要的是我的结果

```
<movies>
   <movie>
       <Title>Yamadonga</Title>
       <Actor>NTR</Actor>
       <Actor>Rajeev</Actor>
       <Director>Rajamouli Rajamouli</Director>
   </movie>
</movies> 
```

如何在director字段中只获取一个值？

我的程序：- 我在 (../Movie/@TITLE) 上运行了不同的值函数，这给了我显示标题的答案。但是由于标题和导演是电影的属性，我无法使用另一个访问一个。当我迭代演员时，由于有两个演员为一部电影指定一个导演，导演的名字会被打印两次。当我遍历电影时，我不能在它上面使用不同的值，因为它不是一个属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:45:10.410

您的 XQuery 确实不是很高效或易于阅读。你可以做一个简单的xpath：

```
<Director>
{
data((doc("actors.xml")/Actors/Actor/Movie[@TITLE = $title])[1]/@Director)
}
</Director> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:42:52.707

这是因为`for`正在返回 2 部电影。为什么不直接使用 XPath`distinct-values()`呢？

```
<Director>
{
distinct-values(doc("actors.xml")/Actors/Actor/Movie[@TITLE=$title]/data(@Director))
}
</Director> 
```

# .net - 如何在 .Net DevKit V2 中启用请求和响应日志记录

> ID：15211207
> 
> 赞同：0
> 
> 时间：2013-03-04T21:11:14.030
> 
> 标签：.net, logging, quickbooks, intuit-partner-platform, devkit

如何为 XML 启用日志记录？

我尝试按照 [http://docs.developer.intuit.com/0025_Intuit_Anywhere/0200_DevKits/0100_IPP_.NET_DevKit/0600_Logging的指示进行操作](http://docs.developer.intuit.com/0025_Intuit_Anywhere/0200_DevKits/0100_IPP_.NET_DevKit/0600_Logging)

我将代码放在从 HelloIntuitAnywhere 派生的测试程序中进行事务添加

所以我把它放在我们的 InvoiceAdd 过程中的正常设置下

```
realmId = HttpContext.Current.Session["realm"].ToString();
accessToken = HttpContext.Current.Session["accessToken"].ToString();
accessTokenSecret = HttpContext.Current.Session["accessTokenSecret"].ToString();
consumerKey = ConfigurationManager.AppSettings["consumerKey"].ToString(CultureInfo.InvariantCulture);
consumerSecret = ConfigurationManager.AppSettings["consumerSecret"].ToString(CultureInfo.InvariantCulture);
intuitServiceType = (IntuitServicesType)HttpContext.Current.Session["intuitServiceType"];
oauthValidator = new OAuthRequestValidator(accessToken, accessTokenSecret, consumerKey, consumerSecret);
context = new ServiceContext(oauthValidator, realmId, intuitServiceType);
commonService = new DataServices(context);

////////////////////////////////////////////
//OAuthRequestValidator
oauthValidator = new OAuthRequestValidator("<<accessToken>>",
    "<<accessTokenSecret>>",
    "<<consumerKey>>",
    "<<consumerSecret>>");

//ServiceContext 
context = new ServiceContext(oauthValidator, realmId, IntuitServicesType.QBO);

context.EnableServiceRequestsLogging = true;
context.ServiceRequestLoggingLocation = @"c:\IPPlogs";

////////////////////////////////////////// 
```

但是得到 InvalidTokenException on

```
context = new ServiceContext(oauthValidator, realmId, IntuitServicesType.QBO); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T11:50:41.187

这里有两篇关于在 SDK 中启用 .Net 或 Java 日志的论坛帖子，还有一篇关于 Java .Net 的博文 [https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0100_IPP_.NET_DevKit/0600_Logging](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0100_IPP_.NET_DevKit/0600_Logging)

Java [http://ippblog.intuit.com/blog/2012/07/ipp-java-devkit-logger.html](http://ippblog.intuit.com/blog/2012/07/ipp-java-devkit-logger.html)

谢谢贾里德
_

# breeze - 导航属性不保存

> ID：15211209
> 
> 赞同：1
> 
> 时间：2013-03-04T21:11:19.310
> 
> 标签：breeze

我有一个简单的对象模型 public class License {

```
 [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    [ScaffoldColumn(false), StringLength(20)]
    public string CreationUserId { get; set; }

    [ScaffoldColumn(false), StringLength(20)]
    public string LastModifiedUserId { get; set; }

    public string LicenseName { get; set; }

    public LicenseType LicenseType { get; set; }

    public State State { get; set; }

    public DateTime DateIssued { get; set; }

    public int ValidFor { get; set; }

}

public class State
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    [ScaffoldColumn(false), StringLength(20)]
    public string CreationUserId { get; set; }

    [ScaffoldColumn(false), StringLength(20)]
    public string LastModifiedUserId { get; set; }

    [StringLength(2)]
    [Required]
    public string Name { get; set; }

    [Display(Name = "Long Name")]
    [Required, StringLength(25)]
    public string LongName { get; set; }
}

public class LicenseType
{

    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    [ScaffoldColumn(false), StringLength(20)]
    public string CreationUserId { get; set; }

    [ScaffoldColumn(false), StringLength(20)]
    public string LastModifiedUserId { get; set; }

    [StringLength(100), Required]
    public string Description { get; set; }
} 
```

我正在使用热毛巾模板微风，杜兰达尔，淘汰赛。我有一个简单的添加视图模型

```
var _licenseAdded = false;
var vm = {

    states: ko.observableArray(context.states),
    licenseTypes: ko.observableArray(context.licenseTypes),

    viewAttached: function () {
        var self = this;
        $('input[name^="date"]').datepicker();
        $('#validFor').spinner({
            min: 365,
            max: 3650,
            step: 30
        });
        log('add Attached', null, true);

    },

    activate: function () {
        var self = this;
        self.original = context.manager.createEntity('License', { licenseName: 'Testing321', dateIssued: moment().format('L') }, null);
        log('add Activated', null, true);

    },
    canDeactivate: function () {
        if (_licenseAdded === false) {
            return app.showMessage('Are you sure you want to leave this page?', 'Navigate', ['Yes', 'No']);
        } else {
            return true;
        }
    },
    saveChanges: function () {

        $.when(context.saveNewLicense()).done(function () {
            _licenseAdded = true;

        });
        router.navigateTo('home');
    },
    original: undefined

};
return vm; 
```

这是我的 add.html，一切都很好，并且在保存之前工作得很好。

当我调用 saveChanges 时，发送到控制器的 saveBundle 没有附加导航属性，允许存储正确的 State 和 LicenseType 我只得到： saveBundle { "entities": [ { "Id": -1, "CreationUserId": null , "LastModifiedUserId": null, "LicenseName": "new for testing", "DateIssued": "2013-03-11T04:00:00Z", "ValidFor": 0, "entityAspect": { "entityTypeName": "License :#Volt.Telecom.Licensing.Models", "entityState": "Added", "originalValuesMap": {}, "autoGeneratedKey": { "propertyName": "Id", "autoGeneratedKeyType": "身份”}}}]，“saveOptions”：{“allowConcurrentSaves”：假}}

不要以为我能得到比这更多的香草。为什么会发生这种情况？当我在客户端上调试时，状态和 licenseType 导航属性都是正确的并且具有正确的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T01:00:07.033

我认为问题在于您的 EF 模型使用“独立关联”而不是“外键关联”（外键关联是 EF 默认值）。我们确实需要更好地记录这个假设。

这个要求可以被绕过，但会导致大量功能损失，其原因是客户端上存在外键允许微风自动修复可能单独查询的实体之间的关系。

有关更多背景信息，请参阅以下 MSDN 文章：[foreign-keys-in-the-entity-framework](http://blogs.msdn.com/b/efdesign/archive/2009/03/16/foreign-keys-in-the-entity-framework.aspx)

# sharepoint - 从 Sharepoint 客户端对象模型获取 weburl

> ID：15211212
> 
> 赞同：2
> 
> 时间：2013-03-04T21:11:36.230
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-api

因此，假设我有一个共享点网站的完整网址。

过去我想获取weburl和doc url时，我使用了Front Page Server Extensions的“url to web url”方法。（[http://msdn.microsoft.com/en-us/library/ms460544.aspx](http://msdn.microsoft.com/en-us/library/ms460544.aspx)）。

```
So for example if you had a site at 
http://webapp/site1/chidsite/a.doc 
```

我想要 CSOM 中的一个方法，它将 /site1/childsite 作为 weburl 返回。

我在 CSOM 中看到了 Web.WebUrlFromPageUrlDirect() 方法，但我不确定我是否能从中得到我需要的东西。在我回来的 Uri 类中，我会为 weburl 使用“AbsolutePath”属性吗？

这样做的正确方法是什么？

我还想获取通常通过通过首页扩展调用 url 到 web url 来检索的 docURL。

fileurl 将是相对于网站的文件位置。因此，如果文档存储在名为“Documents”的文档库中，您将获得 /Documents/file.ext 的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:23:58.257

好吧，在执行 URLToWebURL 时，我已经恢复使用 FrontPage 扩展，因为我只是不确定使用 CSOM 方法会得到什么。尽管检查下面的链接以获取我在其他地方收到的答案。

[与此问题有关的信息](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/482d3633-19b0-4729-8785-fd2c6e2f79ee)

# iis - 当 ColdFusion 无响应时如何在 IIS 6 中设置超时

> ID：15211215
> 
> 赞同：2
> 
> 时间：2013-03-04T21:11:54.423
> 
> 标签：iis, coldfusion, timeout, iis-6, coldfusion-9

这可能与 ColdFusion 以外的平台有关。

IIS 6 日志报告“耗时”（30 分钟）比连接超时中为 ColdFusion 页面的多个请求设置的 120 秒长得多。

我认为 ColdFusion 目前没有反应。我希望 IIS 停止请求而不是等待这么久。

是否存在强制执行此操作的 IIS 设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T02:52:06.807

这种情况也可以认为是客户端引起的[慢速 HTTP DoS攻击。](https://community.qualys.com/blogs/securitylabs/2011/11/02/how-to-protect-against-slow-http-attacks)IIS 没有提供太多的保护（至少对于缓慢的 POST 正文），因为 Microsoft 认为它是一个协议错误，而不是 IIS 的弱点。虽然我认为在这种情况下是你的服务器自己做的。

检查事项：

*   您没有提到是请求慢还是服务器响应慢。如果响应缓慢，您可以尝试调整 [MinFileBytesPerSec参数。](http://msdn.microsoft.com/en-us/library/ms525223%28v=vs.90%29.aspx)默认情况下，如果客户端的下载速度低于每秒 240 字节，它将断开连接。

    请记住，120 秒的 IIS 超时是*空闲*超时。只要客户端在 120 秒内发送或接收几个字节，该计时器就会不断重置。

*   您没有提到这种漫长的等待是在所有页面上发生还是总是在几个特定页面上发生。您的 CF 脚本可能正在建立另一个外部连接，例如`CFQUERY`，它[不受 CF 超时](http://www.carehart.org/blog/client/index.cfm/2010/10/15/Lies_damned_lies_and_CF_timeouts)的影响，但受其连接的服务器超时的影响。在内部使用 timeout 属性`CFQUERY`可能会阻止这种情况。

*   你也没有提到你的 Coldfusion 设置是什么。可能是 Coldfusion JRUN 连接器 ISAPI 过滤器忽略了 IIS 超时设置，因此您应该检查[Coldfusion Administrator 中的设置](http://help.adobe.com/en_US/ColdFusion/9.0/Admin/WSc3ff6d0ea77859461172e0811cbf3638e6-7ffc.html#WSc3ff6d0ea77859461172e0811cbf3638e6-7ffb)。特别是检查[Timeout Requests after](http://helpx.adobe.com/coldfusion/kb/coldfusion-mx-explanation-request-timeout.html)是否已更改。如果它仍然是默认的 60 秒，请检查您的代码以查看它是否已被覆盖，例如 `<cfsetting requestTimeOut = "3600">`

*   最后，您可能不得不通过用 CFML 替换一些 cfscript 标记来解决CF 的[特殊行为问题。](https://stackoverflow.com/questions/10508534/why-doesnt-a-request-with-an-infinite-loop-get-killed-by-coldfusion-request-tim)`requestTimeout`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:34:01.830

不是真的，因为一旦将请求传递给 cf，iis 就不再处理该请求。您可以尝试使用应用程序池超时，看看是否可以引发错误。

# javascript - 删除导航和横幅之间的空白

> ID：15211218
> 
> 赞同：0
> 
> 时间：2013-03-04T21:12:10.203
> 
> 标签：javascript, html, css

如何减少导航栏和横幅之间的空白......我减少了填充和边距，但它没有受到影响......在下面提供我的代码......

```
<div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#" style="padding-top: 0px;">
            <img alt="change" class="defieLogo" src="http://www.defie.co/designerImages/defie_logo_only.png">
          </a>
          <div class="nav-collapse collapse" style="height: 0px;">
            <ul class="nav">
              <li class="active"><a href="/docs/examples/product.html">Product</a></li>
              <li><a href="/docs/examples/solution.html">Solutions</a></li>
              <li><a href="/docs/examples/service.html">Services</a></li>
              <li class="iphonePartnerLink"><a href="/docs/examples/partner.html">Partners</a></li>
              <li class="iphoneContactLink"><a href="/docs/examples/contact.html">Contact</a></li>
            </ul>

            <ul class="nav" id="navSecond">
              <li class=""><a href="/docs/examples/partners.html">Partners</a></li>
              <li><a href="/docs/examples/contact.html">Contact</a></li>
            </ul>
            <form class="navbar-form pull-right">
              <input class="span2" type="text" placeholder="Email">
              <input class="span2" type="password" placeholder="Password">
              <button type="submit" class="btn">Sign in</button>
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:15:09.177

```
navbar .navbar-inner {
background: #fff;
color: #000;
box-shadow: none;
-webkit-border-radius: 0;
-moz-border-radius: 0;
-ms-border-radius: 0;
-o-border-radius: 0;
border-radius: 0;
text-shadow: none;
padding: 20px 0 10px;    <--- remove this
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:29:16.120

将以下 CSS 规则放在 CSS 的末尾。我认为它会解决你的问题。

```
.home { padding-top: 47px !important; }
.home article.container { margin-top: 0px !important; }
.navbar { height: 47px !important; }
.navbar .brand { padding: 0 20px 10px !imporatnt; } 
```

您正在使用引导响应，请在较小的浏览器宽度中检查您的页面。Bootstrap 正在创建可折叠菜单，在当前背景下似乎不太好！

此外，我建议您不要对引导文件进行更改，这将导致无法更新您的库。相反，您可以覆盖它们。

# sql-server-2008 - SQL Server 2008 - 全文搜索不在停用词上停止

> ID：15211223
> 
> 赞同：1
> 
> 时间：2013-03-04T21:12:35.140
> 
> 标签：sql-server-2008, full-text-search, stop-words

我已经根据系统列表创建了一个停止列表，并设置了全文索引以使用它。

如果我运行代码`select unique_index_id, stoplist_id from sys.fulltext_indexes`，我可以看到我的所有索引都使用 ID 为 5 的停止列表，这是我创建的索引。

当我使用 FTS_PARTIAL 运行文本时，结果是正确的。例子：

```
SELECT special_term, display_term
FROM sys.dm_fts_parser
(' "Rua José do Patrocinio nº125, Vila América, Santo André - SP" ', 1046, 5, 0) 
```

我添加到停止列表中的单词显示为干扰词。但是由于某种原因，当我运行查询时，它也会给我带来包含停用词的寄存器。

例如：

```
SELECT *
FROM tbEndereco
WHERE CONTAINS (*, '"rua*" or "jose*"') 
```

正如我所料，给我带来了上面的寄存器。由于应该忽略“rua”这个词，但“Jose”将是匹配的。

但如果我搜索：

```
SELECT *
FROM tbEndereco
WHERE CONTAINS (*, '"rua*"') 
```

我希望找不到任何寄存器。由于 'rua' 被设置为停用词。

我使用巴西（葡萄牙语）作为停止列表语言。所以“Rua”这个词（意思是“Street”）应该被忽略（因为我将它添加到停止列表中）。解析器将其识别为噪声，但是当我运行查询时，它会给我带来包含“Rua”的寄存器。

我的搜索是地址搜索，所以它应该忽略诸如“街道”、“大道”等词。（当然是葡萄牙语，我也添加了它们）。

这是我用来查找表的查询。

```
select DISTINCT(PES.idPessoa)
, PES.Nome                   
, EN.idEndereco   
, EN.idUF     
, CID.Nome as Cidade  
, EN.Bairro    
, EN.Logradouro  
, EN.Numero   
, EN.Complemento  
, EN.CEP  
, EN.Lat  
, EN.Lng      
from tbPessoa PES  
INNER JOIN tbAdvogado ADV ON PES.idPessoa = ADV.idPessoa  
INNER JOIN tbEndereco EN ON PES.idEmpresa = EN.idEmpresa  
LEFT JOIN tbCidade CID ON CID.idCidade = EN.idCidade 
where adv.Ativo = 1  
and CONTAINS (en.*, '"rua*"')
OR EN.idCidade IN (SELECT idCidade
               FROM tbCidade 
               WHERE CONTAINS (*, '"rua*"'))
OR PES.idPessoa IN (SELECT DISTINCT (ADVC.idPessoa)
                FROM tbComarca C 
                INNER JOIN tbAdvogadoComarca ADVC 
                                    ON ADVC.idComarca = C.idComarca
                WHERE CONTAINS (Nome, '"rua*"'))
OR PES.idPessoa IN (SELECT OAB.idPessoa
                FROM tbAdvogadoOAB OAB
                WHERE CONTAINS (NROAB, '"rua*"')) 
```

我尝试了 FREETEXT 和 CONTAINS。使用更简单的东西，`WHERE CONTAINS (NROAB, 'rua'))`但它也给我带来了包含“Rua”的寄存器。

我认为我的查询可能有问题，然后我尝试了一个更简单的查询，它也给我带来了停用词“Rua”。

```
SELECT *
FROM tbEndereco
WHERE CONTAINS (*, 'rua') 
```

我注意到的一件事是，系统停止列表中的原生单词可以正常工作。例如，如果我尝试使用“do”（意思是“of”）这个词，它不会给我带来任何寄存器。

例子：

```
SELECT *
FROM tbEndereco
WHERE CONTAINS (*, '"do*"') 
```

我尝试在所有表中通过 SSMS 运行命令“开始完全填充”，以检查这是否是问题所在，但一无所获。

我在这里想念什么。这是我第一次使用全文索引，我可能会遗漏一些设置它的地方。

预先感谢您对我们的支持。

问候，

塞萨尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:29:02.693

你已经改变了你的问题，所以我会改变我的答案并尝试更好地解释它。

根据[Stopwords 和 Stoplists](http://technet.microsoft.com/en-us/library/ms142551%28v=sql.100%29.aspx)：

> 停用词可以是在特定语言中具有意义的词，也可以是没有语言意义的标记。例如，在英语语言中，诸如“a”、“and”、“is”和“the”之类的词被排除在全文索引之外，因为它们已知对搜索无用。
> 
> 尽管它忽略了停用词的包含，但全文索引确实考虑了它们的位置。例如，考虑短语“说明适用于这些 Adventure Works Cycles 模型”。下表描述了词在短语中的位置：

我不知道为什么，但我认为它只适用于使用短语搜索，如：

如果你有这样的一行：

```
Teste anything casa 
```

您将全文查询为：

```
SELECT *
FROM Address
WHERE CONTAINS (*, '"teste rua casa"') 
```

该行：

```
Teste anything casa 
```

将被退回。在这种情况下，全文会将您的查询翻译为如下内容：

```
"Search for 'teste' near any word near 'casa'" 
```

当您使用“或”运算符查询全文或仅搜索一个词时，该规则不适用。我已经测试了几次大约 3 个月，但我不明白为什么。

**编辑**

如果你有电话线

```
"Rua José do Patrocinio nº125" 
```

你查询全文

```
"WHERE CONTAINS (, '"RUA" or "Jose*" or "do*"')" 
```

它会带来这条线，因为它确实包含您正在搜索的至少一个词，而不是因为“rua”和“do”这个词被忽略了。

# ruby - Ruby on Rails, Resque

> ID：15211225
> 
> 赞同：0
> 
> 时间：2013-03-04T21:12:45.967
> 
> 标签：ruby, ruby-on-rails-3, background-process, resque

我有一个负责生成用户活动报告的 resque 作业类。该类查询数据库，然后执行大量计算/数据解析以向某些人发送电子邮件。我的问题是，像这样具有许多方法（200 行左右的代码）的 resque 作业是否应该填充所有类方法并响应单个 ResqueClass.perform 方法？或者，我应该实例化这个 resque 类的新实例来表示正在生成的单个报告吗？如果这两种方法都正确计算数据并通过电子邮件发送，是否有关于如何处理后台作业的约定或最佳实践？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:20:56.637

两种策略都有效。我通常从并发的角度来处理这个问题。当您的工作正在运行时，为您的工作提供服务的 resque 工作人员很忙，因此，如果您有 N 个工作人员并且其中有 N 个工作正在运行，那么您将不得不等到一个工作完成后，队列中的其他任何内容才会被处理。

也许没关系 - 如果您一次只有一份报告，那么您实际上将指定一名工作人员来运行报告，您的其他人可以做其他事情。但是，如果您有一堆这些并且需要一段时间，您可能会影响队列中的其他工作。

不利的一面是，如果您的报告死了，您可能需要逻辑来从中断的地方继续。如果您为每个用户实例化一次报告，您只需要重试失败的作业 - 不需要“我在哪里”逻辑。

# c++ - 我的调试器运行的代码似乎与我正在构建的不同

> ID：15211227
> 
> 赞同：1
> 
> 时间：2013-03-04T21:13:12.813
> 
> 标签：c++, windows, visual-studio-2010, debugging, dll

我在 Windows 7 上使用 Visual Studio 2010，用 C++ 编写。在我的程序中，我有一个 .dll，其中包含我在程序中经常使用的一堆函数。最近，我在更改 .dll 时遇到了很多麻烦。每当我更改在我的 DLL 中定义的函数时，当程序构建和运行时，更改似乎都不会生效。也就是说，我相信每次成功构建（或重建）我的解决方案时，我的 DLL 都没有正确更新。

如果我尝试在 .cpp 文件中的任何函数（代替 DLL 对用户隐藏的函数）中设置断点，Visual Studio 会告诉我代码不会被执行并且断点无法设置那里。然而，今天早些时候我可以在那里设置一个断点。

此外，我的一个函数将“Frame Received”打印到 Visual Studio 的调试输出中。这种情况仍在发生，因此很明显，此功能的某些版本仍在工作。所以我想尝试让它连续打印 10 次“Frame Received”，看看我的更改是否真正生效。奇怪的是，即使在构建和清理/重建之后，程序仍然只写一次“Frame Received”，就好像它只是忽略了我的更改。

我不确定是什么原因造成的，但正如我所说，我的 .dll 似乎没有被更新和/或 Visual Studio 使用的是旧版本的 .dll 而不是最新版本。无论哪种方式，我都不确定如何解决这个问题。有任何想法吗？

**编辑：**我之前忘了提到，在调试时，我试图进入其中一个我无法在其中放置断点的函数，并且我遇到了以下错误消息：

![错误](../Images/59f2ba531129f24c3c39a24ae6b32cbc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T13:24:21.613

可能，构建的输出将进入其他目录。- 检查您的 outdir 设置。

# .net - 升级到 .NET 4.0 时调用 GetTickCount64

> ID：15211228
> 
> 赞同：0
> 
> 时间：2013-03-04T21:13:14.807
> 
> 标签：.net, visual-studio-2012, windows-xp

我被迫从VS2008升级到VS2012。这意味着我的所有代码都需要更新到 .NET Framework 4.0。我的目标是通过此更新保持与 Windows XP 的兼容性。

所以我有一个包含多个项目的解决方案。大多数是用VB编写的。一个项目是用 C++ 编写的，因为我需要对 DDE 命令进行非托管调用并将其包装在托管对象周围。我能做的最好的就是在 VS2008 环境中用 .NET 3.5 编译它，这样它就可以在 Windows XP 中正常工作。我的主要项目现在是一个混合模式程序集。这可能都是多余的信息，但我声明这一点以防万一。

编译后的程序在我的 Windows 7 开发机器上运行良好。当我在 Windows XP 机器上对其进行测试时，大约 20% 的程序执行时出现错误：“找不到 GetTickCount64。” 我知道 Windows XP 不支持这个调用。主要问题是我的软件中没有一点我需要知道自上次启动以来已经过了多长时间。我假设当它被编译时，Visual Studio 添加了一些额外的东西。在该消息上单击“确定”后，该软件工作正常。拥有它只是烦人。有没有办法找到这个电话的位置并杀死它？我曾尝试通过“GetTickCount64”的解决方案进行搜索，但一无所获。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:06:54.567

听起来您可能会遇到与 Visual Studio 2012 中针对 C++ 的 Windows XP 目标相关的问题。Visual Studio 2012 Update 1 中添加了对具有 C++ 目标的 Windows XP 的支持，但仍必须在项目属性中明确选择。

[在 Visual Studio 2012 中使用 C++ 进行 Windows XP 定位](http://blogs.msdn.com/b/vcblog/archive/2012/10/08/10357555.aspx)

# php - PHP中的服务器文档根路径

> ID：15211231
> 
> 赞同：24
> 
> 时间：2013-03-04T21:13:17.893
> 
> 标签：php, absolute-path

我有一个如下的 php 代码行

```
$files = glob('myFolder/*'); 
```

我想通过使用服务器文档根目录在上面使用 myFolder 的绝对路径，如下所示

```
$_SERVER["DOCUMENT_ROOT"]."/myFolder/" 
```

它应该如下所示

```
$files = glob('$_SERVER["DOCUMENT_ROOT"]."/myFolder/*"'); 
```

但这不起作用

如何纠正这个？

实际上我正在尝试这样做：

```
<?php
//Delete All files from folder
// $files = glob('myFolder/*');

$files = glob($_SERVER["DOCUMENT_ROOT"]."/myFolder/*");

foreach($files as $file){
if(is_file($file))
unlink($file);
} 
?> 
```

下面的代码正在工作

```
$files = glob('myFolder/*'); 
```

这下面不起作用

```
$files = glob($_SERVER["DOCUMENT_ROOT"]."/myFolder/*"); 
```

我想使用 myFolder 的绝对路径

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-04T21:14:11.917

`$files = glob($_SERVER["DOCUMENT_ROOT"]."/myFolder/*");`

# html - 移动设备后退按钮 jquery mobile bug 页面未设置样式

> ID：15211233
> 
> 赞同：0
> 
> 时间：2013-03-04T21:13:22.793
> 
> 标签：html, jquery-mobile

当我使用手机测试应用程序时，我使用后退设备按钮显示上一页这适用于所有页面，除了一个页面在尝试访问上一页时显示未设置样式的页面，所以有些东西奇怪的。
这里做一个简单的解释。有 3 页 #main_menu ， #first_map ， #second_map 当我进入 #second_map 页面时，当我按下返回按钮时它应该转到 #first_page 但实际上它显示的 #main_menu 页面没有 CSS 样式。你能告诉我是什么问题以及我们如何解决它提前谢谢你。我提供源代码：这是 main_page

```
 </div>
            <h2 id="thx_msg" style="margin:0 auto;"></h2>
           <div class="grid2">
                <div class="first" id="search_btn">
                    <div>
                        <img src="images/loupe.jpg"/>
                    <div>
                    </div>Search for a Spot</div>
                </div>
                <div class="second" id="submit_spot_btn">
                    <div>
                        <img src="images/spot.jpg"/>
                    </div>
                    <div>Submit a spot</div>
                </div>
            </div>
            <ul style="margin:0 auto;" class="spaced_list" style="widht:280px;" >
                <li><input type="button" data-role="none" value="Account info" class="btn" style="margin:0 auto;" id="main_page_account_info"/></li>
                <li><input type="button" data-role="none" value="Log Out" class="btn" style="margin:0 auto;"id="main_page_log_out"/></li>
            </ul>
     </div> 
```

这里是 first_map 页面被命名为 spot_page

```
<div data-role="page" id="spot_page" data-theme="b">
<div data-role="header" style="overflow:hidden;">
    <img class="logo_icon" src="images/logo_icon.png">
</div><!-- header -->
<div class="clear"></div>
<div id="search_form_holder" style="margin:0px 25px" >
    <p class="center" style="font-size:16px;font-weight:bold;">
        Search for a Spot
    </p>
    <ul class="some_space" style="margin:0 auto;
                                        margin-left:auto;
                                        margin-right:auto;
                                        align:center;
                                        text-align:center;
                                        width:280px;">
    <li><input type="text" id="address_zip" class="field black" placeholder="Address/Zip Code"/></li>
    <li id="to"></li>
    <li><input type="button" data-role="none" style="width:200px;margin:15px auto;" id="search_spot_btn" class="btn" value="Search for a Spot"></li>
    </ul>
    <div id="hidden_scroller" style="display:none">
    <select id="distance" name="Within">
            <option value="1">1 Mile</option>
            <option value="3">3 Miles</option>
            <option value="5">5 Miles</option>
            <option value="10">10 Miles</option>
        </select>
    </div>
</div><!-- search form -->
<div id="first_map" style="width: 100%;
                            height: 247px;border:1px solid black;margin:0 auto">

</div>
</div><!-- split  view --> 
```

最后是第二张地图：

```
 <div data-role="page" id="nearby_page">
        <div data-role="header" style="overflow:hidden;">
            <img class="logo_icon" src="images/logo_icon.png">
        </div><!-- header -->
        <div class="clear"></div>
        <div class="second_header">Spots nearby</div>
        <div id="map" style="width: 100%;
                            height: 398px;border:1px solid black;margin:0 auto">

        </div>
    </div> 
```

如您所见，页面彼此分开。
我有最后一个问题，导航插件是否可以帮助解决像 jquery 历史插件这样的问题，感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T04:23:00.533

确保将您的页面放在不同的单独页面上。如果不是这样，就会发生这种错误。大多数情况下，您会遇到异常导航错误。这就是我在我的经历中所经历的。

顺便说一句，您应该向这里的人们展示更多代码以帮助您。

**更新**

PhoneGap 和 Android 的后退按钮的行为确实很奇怪。我在我的应用程序中所做的是禁用后退按钮并在顶部标题上提供软后退按钮。Simple`history.back()`将为后退按钮带来魔力。

您可以按如下方式禁用。

```
$(function(){
    document.addEventListener("deviceready", onDeviceReady, false);
})

// PhoneGap is loaded and it is now safe to call PhoneGap methods
//
function onDeviceReady() {
    // Register the event listener
    document.addEventListener("backbutton", onBackKeyDown, false);
}

// Handle the back button
//
function onBackKeyDown() {
    console.log("Back button pressed but nothing happened");
} 
```

无论如何，这是我的方法。你可以选择与众不同。

# drupal - Drupal 7，按自定义字段值列出用户

> ID：15211238
> 
> 赞同：4
> 
> 时间：2013-03-04T21:13:36.310
> 
> 标签：drupal, drupal-7, custom-fields

我为用户的家乡创建了一个自定义字段，我们称之为“field_home”，每个用户在注册帐户时都需要该字段。他们只能从列表中选择某些文本值。

有什么办法可以在管理员/人员中添加一个“家乡”列，其中列出了每个用户的 field_home 值以及他们的用户名和角色？

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T07:43:03.990

I would recommend creating a new view. You can build a better view than the one provided in `admin/people` in no time.

Add your own custom fields, edit/cancel-account links and filtering criteria. That'd be much easier and faster.

# c++ - 计时排序算法的效率但得到不正确的输出

> ID：15211240
> 
> 赞同：0
> 
> 时间：2013-03-04T21:13:55.013
> 
> 标签：c++

我正在编写一个程序，它将找出通过不同的排序过程需要多少毫秒才能找到最有效的。我无法从程序中获取正确的时间输出。而不是显示时间量，例如：

```
Bubble Sort: 100
Merge Sort: 45
etc. 
```

我越来越：

```
Bubble Sort: -3098
Merge Sort: -3
etc. 
```

如果有人可以帮助我弄清楚为什么会发生这种情况，我将不胜感激。这是我的源代码。

```
static double diffclock(clock_t clock1,clock_t clock2)
{
  double diffticks=clock1-clock2;
  double diffms=(diffticks)/(CLOCKS_PER_SEC/1000);
  return diffms;
}

int main ()
{
clock_t begin, end;

for (int n = 1; n<=1000000; n*=10)
{
    cerr << n << endl;
    int *array = new int[n];
    int *temparray = new int[n];

    srand((unsigned int)time(0));

    for (int i = 0; i < n; i++)
    {
        array[i] = rand()%1000;
    }

    begin = clock();
    bubbleSort(array, n);
    end = clock();
    cerr << "Bubble Sort: " << diffclock(begin, end) << endl;

    srand((unsigned int)time(0));

    for (int i = 0; i < n; i++)
    {
        array[i] = rand()%1000;
    }

    begin = clock();
    insertionSort(array, n);
    end = clock();
    cerr << "Insertion Sort: " << diffclock(begin, end) << endl;

    srand((unsigned int)time(0));

    for (int i = 0; i < n; i++)
    {
        array[i] = rand()%1000;
    }

    begin = clock();
    mergesort(array, 0, n-1, temparray);
    end = clock();
    cerr << "Merge Sort: " << diffclock(begin, end) << endl;

    srand((unsigned int)time(0));

    for (int i = 0; i < n; i++)
    {
        array[i] = rand()%1000;
    }

    begin = clock();
    quicksort(array, 0, n-1);
    end = clock();
    cerr << "Quick Sort: " << diffclock(begin, end) << endl;

    srand((unsigned int)time(0));

    for (int i = 0; i < n; i++)
    {
        array[i] = rand()%1000;
    }

    begin = clock();
    selectionSort(array, n);
    end = clock();
    cerr << "Selection Sort: " << diffclock(begin, end) << endl;
}

    return 0;
} 
```

再次，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:15:39.097

你应该从clock1中减去clock2

```
static double diffclock(clock_t clock1,clock_t clock2)
{
   double diffticks=clock1-clock2; 
```

或切换开始和结束

```
diffclock(begin, end) 
```

您的结束时间大于开始时间，因此如果减去（开始 - 结束），您会得到负值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:15:30.027

看起来你正在输出`begin - end`.

# c# - 如何在新的 ormlite api 中设置命令超时

> ID：15211241
> 
> 赞同：2
> 
> 时间：2013-03-04T21:14:05.563
> 
> 标签：c#, ormlite-servicestack

我升级到了新版本的 ormlite 并正在更新我的代码，但现在我看不到我可以在哪里设置命令时间，因为一切都脱离了 idbconnection。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-23T09:22:40.263

正如我在另一个线程中发布的那样，我创建了一个扩展方法来处理这种情况，并且仍然保留了不错的 API：

```
public static partial class IDbConnectionExtensionMethods
{
    public static List<T> Query<T>(this IDbConnection self, string sql, TimeSpan commandTimeout)
    {
        List<T> results = null;
        self.Exec((dbCmd) =>
            {
                dbCmd.CommandTimeout = (int)commandTimeout.TotalSeconds;
                dbCmd.CommandText = sql;
                using (var reader = dbCmd.ExecuteReader())
                {
                    results = reader.ConvertToList<T>();
                }
            });

        return results;
    }   // eo Query<T>
}   // eo class IDbConnectionExtensionMethods 
```

# oracle - SQL交叉连接查询比预期慢，需要重构思路

> ID：15211245
> 
> 赞同：0
> 
> 时间：2013-03-04T21:14:18.240
> 
> 标签：oracle, database-performance

此查询有效，但需要 5000 毫秒。

```
SELECT 
    SUM(case 
        when ((TRUNC(OPEN_DATE) <= thedate and TRUNC(END_DATE) > thedate) or(TRUNC(OPEN_DATE) <= thedate and END_DATE Is Null)) then 1 
        else 0 
        end) as Open  
From ( 
    select * 
    FROM PROJECT 
    WHERE 
        PROGRAM_NAME = :program   
        AND ACTION_FOR_ORG = :orgName 
    )   
    cross join ( 
        select add_months(last_day(SYSDATE), level-7) as thedate 
        from dual 
        connect by level <= 12  
    )  
GROUP BY thedate
ORDER BY thedate 
```

如果我将子查询复制到自己的表中

```
create table test_project as  
select * FROM PROJECT WHERE PROGRAM_NAME = :program   
AND ACTION_FOR_ORG = :orgName 
```

然后执行上述查询，但子查询在复制的表上，如下所示：

```
From ( select * FROM test_project WHERE PROGRAM_NAME = :program   
AND ACTION_FOR_ORG = :orgName ) 
```

查询需要 10 毫秒

该查询会根据`OPEN_DATE`与`END_DATE`

有没有办法重写原始查询以获得最佳性能？

# 编辑

好的，我创建了第二个表，它是我被允许访问的项目表（井视图）的完整副本。表格复制大约需要 5 秒。使用完整的数据集和我的 sql 查询或来自下面的 Egor，查询速度非常快。视图有问题。尝试使用子查询中的视图吐出解释计划，但权限不足。这是使用视图的完整副本的解释计划

```
 Plan hash value: 3695211866

 ------------------------------------------------------------------------------------------------
 | Id  | Operation                        | Name        | Rows  | Bytes | Cost (%CPU)|     Time     |
 ------------------------------------------------------------------------------------------------
 |   0 | SELECT STATEMENT                 |             |   637 |  1277K|   163   (2)| 00:00:02 |
 |   1 |  SORT ORDER BY                   |             |   637 |  1277K|   163   (2)| 00:00:02 |
 |   2 |   HASH GROUP BY                  |             |   637 |  1277K|   163   (2)| 00:00:02 |
 |   3 |    MERGE JOIN CARTESIAN          |             |   637 |  1277K|   161   (0)| 00:00:02 |
 |   4 |     VIEW                         |             |     1 |     6 |     2   (0)| 00:00:01 |
 |*  5 |      CONNECT BY WITHOUT FILTERING|             |       |       |              |          |
 |   6 |       FAST DUAL                  |             |     1 |       |     2   (0)| 00:00:01 |
 |   7 |     BUFFER SORT                  |             |   637 |  1273K|   163   (2)| 00:00:02 |
 |*  8 |      TABLE ACCESS FULL           | COMMIT_TEST |   637 |  1273K|   159   (0)| 00:00:02 | 
```

* * *

谓词信息（由操作 id 标识）：

* * *

```
5 - filter(LEVEL<=12)
8 - filter("PROGRAM_NAME"='program_name' AND "ACTION_FOR_ORG"='action_for_org') 
```

笔记

* * *

```
- dynamic sampling used for this statement (level=2) 
```

使用活动表解释计划 ![在此处输入图像描述](../Images/274c3238a758efd47f4e191ab3ddc45d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:02:12.113

```
with
   PRJ as (
      select /*+ NO_UNNEST */ 
         trunc(OPEN_DATE) as OPEN_DATE,
         nvl(trunc(END_DATE), sysdate + 1000) as END_DATE
      from
         PROJECT
      where
         PROGRAM_NAME = :program
         and ACTION_FOR_ORG = :orgName
   ),
   DATES as (
      select
         add_months(trunc(last_day(SYSDATE)), level-7) as thedate
      from dual
      connect by level <= 12
   )
SELECT
   thedate,
   sum(case when thedate between open_date and end_date then 1 end) as Open
FROM
   DATES, PRJ
GROUP BY thedate
ORDER BY 1 
```

# d3.js - 将特征位置投影到 D3.js 地理投影上

> ID：15211251
> 
> 赞同：1
> 
> 时间：2013-03-04T21:14:38.637
> 
> 标签：d3.js

我正在尝试在 D3.js 的一些地理投影上添加一些代表各种特征位置的点。我希望这些点像乡村路径一样旋转并被剪裁，但我很难让它发挥作用。

对于给定的投影，我可以通过根据[演示](http://mbostock.github.com/d3/talk/20111018/azimuthal.html)中的拖动更新投影来获取更新的坐标，然后在我要更新的坐标上调用 projection() ，但这并不能正确剪辑圆圈（你可以看到地球另一侧的圆圈）。是否有可能得到一个这样的例子？回顾一下，我想在纽约市周围画一个圆圈，然后能够旋转地球并“设置”圆圈。

谢谢！

劳伦

# jquery - 如何将 Twitter Bootstrap 与 2 个版本的 jquery 一起使用

> ID：15211256
> 
> 赞同：1
> 
> 时间：2013-03-04T21:14:51.610
> 
> 标签：jquery, twitter-bootstrap, drupal-6

与旧版本的 jQuery 一起使用 Twitter Bootstrap 的最佳方法是什么？

我有一个 drupal 6 站点和一个基于 Bootstrap 的响应式主题，效果很好，但他们每个人都需要自己的 Jquery 版本。我已经研究过使用实现的东西，`noconflict`但在这种情况下我找不到一个直接的例子——这让我想知道这是否是正确的方法。

任何见解将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:21:09.103

包括 jquery 1.9.1，包括引导程序，然后包括以下内容：

```
<script>
    var $_191 = $.noConflict(true);
</script> 
```

或者，更好的是，更新 drupal 以包含 jQuery 1.9.1 + jQuery migrate

* * *

编辑：从 1.3.2 更新到 1.9.1 需要的不仅仅是添加 jQuery migrate 最有可能，我不建议尝试它，除非你有一点时间来解决这些错误。

# c# - 我的 WPF 用户控件具有单向绑定，我不知道为什么

> ID：15211257
> 
> 赞同：0
> 
> 时间：2013-03-04T21:14:59.220
> 
> 标签：c#, wpf, data-binding, user-controls

我创建了一个非常简单的用户控件，它显示了一个`ColorPicker`（来自 WPF 扩展工具包）及其十六进制代码的文本字段：

```
<UserControl x:Class="HexColorPicker"> <!-- namespace declarations omitted -->
    <UserControl.Resources>
        <glue:ColorToRgbHex x:Key="colorToHex"/> <!-- custom converter I made -->
    </UserControl.Resources>
    <StackPanel Orientation="Horizontal" Name="layoutRoot">
        <Label Content="#"/>
        <TextBox Text="{Binding SelectedColor, Converter={StaticResource colorToHex}}"/>
        <extToolkit:ColorPicker SelectedColor="{Binding SelectedColor}"/>
    </StackPanel>
</UserControl> 
```

这是支持代码：

```
public partial class HexColorPicker : UserControl
{
    public static readonly DependencyProperty SelectedColorProperty
        = DependencyProperty.Register("SelectedColor", typeof(Color), typeof(HexColorPicker));

    public HexColorPicker()
    {
        InitializeComponent();
        layoutRoot.DataContext = this;
    }

    public Color SelectedColor
    {
        get { return (Color)GetValue(SelectedColorProperty); }
        set { SetValue(SelectedColorProperty, value); }
    }
} 
```

`layoutRoot.DataContext`恶作剧来自[我发现的这个](http://www.scottlogic.co.uk/blog/colin/2012/02/a-simple-pattern-for-creating-re-useable-usercontrols-in-wpf-silverlight/)地方。

然后我像这样使用我的控件：

```
<me:HexColorPicker SelectedColor="{Binding MyColor}"/> 
```

它有点工作。文本字段和颜色选择器是同步的：当一个改变时，另一个也改变。但是，控件和模型对象不是双向同步的：如果我更改模型对象的`MyColor`属性，我的控件将更新，`MyColor`但当我用我的控件更改它时，该属性不会更新。

我究竟做错了什么？为什么从我的模型到我的控件的绑定是单向的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:20:19.490

将您的 DependencyProperty 声明更改为：

```
public static readonly DependencyProperty SelectedColorProperty = DependencyProperty.Register("SelectedColor", typeof (Color), typeof (HexColorPicker), new FrameworkPropertyMetadata(default(Color),FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:22:50.400

~~我记得，在类型之间转换的绑定有时默认为`OneWay`绑定。~~

从 BindingMode.Default ( [http://msdn.microsoft.com/en-us/library/system.windows.data.bindingmode.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingmode.aspx) ) 的参考资料：

> 使用绑定目标的默认模式值。每个依赖属性的默认值都不同。通常，用户可编辑的控件属性（例如文本框和复选框的属性）默认为双向绑定，而大多数其他属性默认为单向绑定。确定依赖属性默认绑定单向还是双向的一种编程方法是使用 GetMetadata 获取属性的属性元数据，然后检查 BindsTwoWayByDefault 属性的布尔值。

看起来问题在于您的控件不被视为“用户可编辑”控件。

最简单的解决方案是`Mode=TwoWay`在绑定中指定。

# grep - 我只需要在 txt 文件中保留包含“#”的行

> ID：15211258
> 
> 赞同：-1
> 
> 时间：2013-03-04T21:15:03.280
> 
> 标签：grep

我只需要在我的文本文件中保留这一行，其中包含符号#。

例如，我有这样的事情：

```
something #
anything else fxgbdfg
car #
325235363456356 @ dfsjdbfkjfbfds
958395959 #
sdfsnfjkndsnc3r / 
```

我需要这个：

```
something #
car #
958395959 # 
```

有人可以告诉我如何在 GREP 中做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:17:13.183

grep \#

或者 grep \# filename 如果你想使用文件而不是标准输入

# actionscript-3 - AS3：根据播放的视频流周期性调用外部函数

> ID：15211259
> 
> 赞同：1
> 
> 时间：2013-03-04T21:15:03.393
> 
> 标签：actionscript-3, callback, video-streaming, netstream

我实现了一个 flex 应用程序来播放来自 Red5 媒体服务器的传入视频流。

```
private function playStream(streamName:String, offset:int):void {
  stream = new NetStream(connection);
  stream.play(streamName + ".flv", offset);
  var streamVideo:Video = new Video();
  streamVideo.attachNetStream(stream);
  display.addChild(streamVideo); } 
```

playStream 方法从 offset 参数定义的位置播放给定的流。现在我想根据播放的视频流更新我的页面内容。或者更具体地说，我想在视频的每一分钟之后调用一个更新内容的 actionscript 方法。我应该出于这个原因使用 Timer 吗？

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T05:14:55.173

是的，您需要使用一个`Timer`对象。但不要使用`Timer`来确定用户在播放视频时所处的位置。您应该改用[time](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetStream.html#time)的属性`NetStream` 。

您还应该`NetStatusEvent`在您的`playStream()`方法中添加一个事件侦听器。特别是，您要检查此事件的[info](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/NetStatusEvent.html#info)`info.code`属性（从技术上讲，它是属性）。这有几条有用的消息，您需要知道：视频播放何时开始/停止/暂停，用户何时执行搜索，等等。通过这种方式，您可以`Timer`在用户与视频播放器交互时有效地管理和更新 UI。

下面是一些相关的代码`NetStatusEvent`。但检查完整列表，您可能会发现其他对您有帮助的人。

*   NetStream.Pause.Notify（用户暂停播放，此处酌情启动/停止计时器）
*   NetStream.Play.Start（播放开始，启动定时器）
*   NetStream.Play.Stop（播放停止，停止定时器）
*   NetStream.Seek.Notify（用户搜索到新点，更新 UI）

# jquery - jQuery UI Dialog动态设置输入框的文本

> ID：15211260
> 
> 赞同：0
> 
> 时间：2013-03-04T21:15:06.127
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

我已经尝试解决这个问题，但仍然遇到一些麻烦。

我想在脚本内部以对话框形式设置输入框的文本（例如名称），因为文本将在运行时确定。我在设计时不知道。我了解到该文本来自：

```
<div id="dialog-form" title="Create new user">
    <p class="validateTips">All form fields are required.</p>
    <form>
        <fieldset>
            <label for="name">Name</label>
            <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
        </fieldset>
    </form>
</div> 
```

从 ... 标签 for="name">Name.. 具体来说。

表单其实来源于JQuery UI标准示例：

[http://jqueryui.com/dialog/#modal-form](http://jqueryui.com/dialog/#modal-form)

我的问题是：

我可以避免这种方式来设置文本吗？我可以完全通过脚本设置吗？

如果没有，我该如何通过脚本更改它？

如果没有，我如何访问 html 中的文本“名称”并从脚本中更改它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:23:24.543

```
 <fieldset>
        <label for="name">Name</label>
        <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
    </fieldset>

<script>
var text = $('#name').prev().text(); // get the text

$('#name').prev().text('YourTextHere'); // Change the text
</script> 
```

# c# - 从 ASP.NET 应用程序池标识运行命令

> ID：15211275
> 
> 赞同：7
> 
> 时间：2013-03-04T21:15:45.630
> 
> 标签：c#, asp.net, iis-7, application-pool, applicationpoolidentity

当用户单击一个按钮时，我正在从我的 ASP.NET 应用程序运行一个可执行进程。这个过程创建了几个文件并将它们提供给最终用户。我无法真正看到该进程在做什么或没有在做什么，但是直到我将管理员用户指定为服务器上的应用程序池身份之后，它才起作用。我正在使用 IIS7。

```
 using (var proc = new Process())
 {
    proc.StartInfo.FileName = Server.MapPath("~/Testing/Demo/MyExe.exe");
    proc.StartInfo.Arguments = String.Format("\"{0}\"", commandFilePath);
    proc.StartInfo.UseShellExecute = true;
    proc.Start();
    proc.WaitForExit();
 } 
```

我假设这通常是一件坏事。您能否让我了解需要做什么才能为普通`ApplicationPoolIdentity`帐户启用此功能？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:23:49.837

首先，为什么需要 Shell 来执行它？不是控制台应用程序 - 你打开任何窗口吗？

其次，您需要重定向输入和输出。

最后，您需要做的是将您的脚本运行的目录放在运行您的池的用户的权限上。并从您的池中删除管理员。

```
proc.StartInfo.UseShellExecute = false;
proc.StartInfo.CreateNoWindow = false;
proc.StartInfo.RedirectStandardError = true;
proc.StartInfo.RedirectStandardOutput = true;
proc.StartInfo.RedirectStandardInput = true;

proc.Start();

proc.StandardInput.Flush();
proc.StandardInput.Close();

proc.WaitForExit();
proc.Close(); 
```

因此，例如，如果您将池添加到在 UserA 下运行，则转到您的程序运行的目录并添加 UserA 能够在该目录上执行程序的权限。如果您的程序还使用其他目录进行读写，则还要为这些目录添加 UserA 的权限。

> 我真的看不出这个过程在做什么或没有做什么

如果您在服务器上使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)，您可以查看它是否运行，是否关闭，是否停止但停留在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:23:12.787

这可能是文件/执行权限问题。尝试`execute`将 ApplicationPoolIdentity 的`~/Testing/Dema/MyExe.exe`权限`read`授予给`commandFilePath`. 您提到您的流程会创建文件。您将需要在将创建文件的文件夹上授予 ApplicationPoolIdentity`modify`或权限。`full control`这是权限的矩阵[列表](http://technet.microsoft.com/en-us/library/cc732880.aspx)。

有关授予权限的信息，请参阅[为 ApplicationPoolIdentity 帐户分配](https://serverfault.com/questions/81165/how-to-assign-permissions-to-applicationpoolidentity-account)权限。

安全事件日志应捕获权限被拒绝错误。检查那里，看看您是否有访问权限问题。系统和应用程序日志也可能包含有关问题的信息。

Process Explorer 还可以显示文件访问请求。这是一篇关于[使用 Process Explorer 进行故障排除](http://blogs.technet.com/b/askperf/archive/2007/06/01/troubleshooting-with-process-monitor.aspx)的技术网文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T22:45:50.220

每当您从 ASP.NET 页面运行任何进程时，它都会在工作进程的安全上下文（即您的应用程序池帐户的权限）下运行。它不像您通常运行 MyExe.exe，在这种情况下它将使用登录帐户运行。正因为如此，当您将管理员帐户提供给应用程序池时，您的代码才有效。

有很多方法可以解决这个问题。

最简单的方法之一是将您的应用程序池标识更改为网络服务并将网络服务添加到 MyExe.exe 将访问文件表单的文件夹的权限。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T15:13:35.173

感谢大家的帮助。我需要做的就是将 StartInfo.WorkingDirectory 设置为我能够编写的位置。

```
 using (var proc = new Process())
        {
            proc.StartInfo.FileName = Server.MapPath("~/Testing/Demo/MyEXE.exe");
            proc.StartInfo.Arguments = String.Format("\"{0}\"", commandFile);
            proc.StartInfo.WorkingDirectory = savePath;
            proc.Start();
            proc.WaitForExit();
        } 
```

这会导致临时文件被写入非系统文件夹，因此不需要任何提升的应用程序池权限。

# android - 为 iOS 和 Android 编译 C++ 代码 (Xcode)。这是真的吗？

> ID：15211277
> 
> 赞同：29
> 
> 时间：2013-03-04T21:15:53.287
> 
> 标签：android, c++, ios, xcode

我想尝试为 iOS 和 Android 设备编写和编译 C++ 代码。我使用 Xcode 已经有一段时间了（我正在为 MacOS 和 Windows 编写 c++ 代码）。所以我想将 Xcode 用于我的目的。

问题是我不知道如何为 Android 设备和 iPad/iPhone 编译 C++ 代码。我想为 iOS 和 Android 使用跨平台解决方案，但不想使用 Marmalade (c++) 或其他框架。

是真的还是假的？:) 有教程或其他有用的材料吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-03-04T21:29:12.377

您绝对可以在 iOS 和 Android 上使用 C++。我已经为两者编写了自己的游戏引擎。

Xcode 是 iOS 的普通 IDE，原生支持“Objective-C++”开发（编译器同时支持[Objective-C](http://en.wikipedia.org/wiki/Objective-C)和[C++](http://en.wikipedia.org/wiki/C++)）。您将需要在 Objective-C 中编写一个瘦包装器来与操作系统交互，但如果您愿意，您可以在 C++ 中编写其他所有内容。如果您下载 Xcode 命令行工具，您也可以从脚本构建。

Eclipse 是 Android 的常用 IDE，如果您下载[NDK](http://developer.android.com/tools/sdk/ndk/index.html)，您可以利用[JNI](http://en.wikipedia.org/wiki/Java_Native_Interface)在 Java 和 C++ 之间进行接口。就像 iOS 一样，您至少需要一个 Java 包装器来与操作系统交互。

但是，您不仅限于 Eclipse 和 Xcode。例如，您可以使用[emacs](http://www.gnu.org/software/emacs/)和/或使用[CMake](http://www.cmake.org/)来尝试和整合项目设置。Emacs 是一个非常强大和灵活的 IDE，但它的学习曲线非常陡峭，而且安装起来也不是很简单。如果您在 Mac 上执行此操作，我会推荐[emacsformacosx](http://emacsformacosx.com/)并安装[ECB](http://ecb.sourceforge.net/)和[自动完成](http://cx4a.org/software/auto-complete/)也是。CMake 基本上是一个跨平台构建系统，它允许您从一个源代码树构建许多不同的项目文件（Visual Studio、Xcode、Eclipse 等）。就像 emacs 一样，它非常强大，但学习曲线有点陡峭。如果您想立即加入，您可能希望同时使用 Xcode 和 Eclipse。如果您在 PC 上开发，则需要 Mac VM 或 Hackintosh 才能使用 Xcode 和 cygwin 才能使用 NDK for android（Macbook Pro 用户可以轻松享受乐趣）。

原生 Android 开发肯定要困难得多。您不仅要应对更多的设备细分，而且本机调试也不是很直接。您必须在设备上运行 GDB 服务器并与其连接以设置断点，许多人从命令行执行此操作。如果您想要基于 GUI 的 IDE，我听说有些人使用[Tegra Tools for Eclipse 取得了成功。](https://developer.nvidia.com/tegra-android-development-pack)

我肯定会建议您首先在 iOS 上进行开发，因为您可以从 IDE 中使用更强大的工具。您可以轻松跟踪内存泄漏、分析代码、设置断点；) 等。一旦您在 iOS 上开发了一项功能，您就可以与 .mk 文件和其他 Android 原生开发的优点搏斗。

以下是有关 iOS 核心对象和生命周期的一些信息：

*   [核心对象](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/AppArchitecture/AppArchitecture.html#//apple_ref/doc/uid/TP40007072-CH3-SW2)
*   [生命周期](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW3)

对于安卓：

*   [生命周期](http://developer.android.com/guide/components/activities.html)

只要您能很好地使用操作系统并尊重应用程序的生命周期，您就可以自由地调用 C++ 逻辑。您可以直接使用 iOS 执行此操作，但使用 Android 您必须通过 JNI 编组调用。如果您封装平台细节，您可以在两个平台之间共享 C++ 逻辑。

我是 C++ 的忠实拥护者，但使用它的选择确实取决于这些平台的情况。C++ 不是这些平台的流行选择，因此您不会找到那么多文档（大部分时间是您自己）。如果您对 C++ 不是很熟悉（您熟悉[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)、[设计模式](http://en.wikipedia.org/wiki/Software_design_pattern)、[STL](http://en.wikipedia.org/wiki/Standard_Template_Library)吗？），复杂性可能会增加一点。

以下是一些可能有意义的情况：

*   如果您需要使用以 C/C++ 编写的库
*   如果您想为您的应用或游戏构建自己的平台无关框架
*   如果您正在使用实时/性能关键应用程序，例如游戏

我并不是说你*必须*在这些情况下使用 C++，因为很多人都使用 Objective-C 开发游戏。我只是说，如果您需要充分利用硬件，或者您只是想要更便携的东西，这可能是需要考虑的事情。

# vb.net - 以编程方式对成员字段进行 VB ReDim

> ID：15211278
> 
> 赞同：0
> 
> 时间：2013-03-04T21:15:53.880
> 
> 标签：vb.net, gettype

我正在尝试根据读取文件来重新调整成员数组。我不知道该怎么做。这是我尝试过的，但它不起作用。

```
Public Class BS
    Public A() As String
    Public B() As Double
    Public C() As Double
End Class

Public Class SB

    Public MyBS() As BS

    'ReadFieldString is a function that returns a string of the field name of Class BS,
    'i.e., A, B or C.  For test purpose, retun a constant
    Public Function ReadFieldString() As String
        Return "B"
    End Function

    'GetArrayDim is a function that returns an integer, which is the size of the array
    'of that field name. For test purpose, retun a constant
    Public Function GetArrayDim() As Integer
        Return 1
    End Function

    Public Sub DimArrays()
        ReDim MyBS(3)
        Dim i As Integer
        For i = 0 To MyBS.Length - 1
            'Try to ReDim the member of MyBS
            ReDim MyBS(i).GetType.GetField(ReadFieldString)(GetArrayDim)
        Next()
    End Sub

End Class 
```

ReDim 语句出现错误“表达式是一个值，因此不能成为赋值的目标”。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:10:39.980

我不确定`ReDim`这样的工作方式。将代码更改为此将实现我相信您所追求的：

> ```
> Public Sub DimArrays()
>     ReDim MyBS(3)
>     Dim i As Integer
>     For i = 0 To MyBS.Length - 1
>         MyBS(i) = New BS()
>         Dim f = GetType(BS).GetField(ReadFieldString())
>         f.SetValue(MyBS(i), Array.CreateInstance(f.FieldType.GetElementType(), GetArrayDim()))
>     Next
> End Sub 
> ```

但是，我认为更好的方法是在 BS 构造函数中指定数组大小。

# python - 如何使字段之间的制表符在 wxPython 的框架中工作

> ID：15211279
> 
> 赞同：0
> 
> 时间：2013-03-04T21:15:58.080
> 
> 标签：python, user-interface, wxpython

我对 wxPython 很陌生，我使用以下教程创建了几个 TextCtrl 字段和东西。 [http://sebsauvage.net/python/gui/#import](http://sebsauvage.net/python/gui/#import)

一切正常，除了我无法使用非常烦人的 Tab 按钮在字段之间切换。我如何修改该教程中的示例（添加了更多 TextCtrl），以便我可以使用选项卡在字段之间切换？

如果您不想看教程，它基本上是一个带有一堆 TextCtrl 的框架，它使用 GridBagSizer 放在它上面。

在网上搜索时，我发现的只是“创建一个面板”，但我试过了，因为我对 wxPython 很陌生，所以它没有用，我找不到关于如何做到这一点的详尽教程（如果可能的话，我想只坚持一个框架......）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T14:33:45.713

您需要将 wx.Panel 添加到框架，然后将面板对象作为所有其他小部件的父对象。wx.Panel 添加了选项卡功能并使框架在所有平台上看起来都正确（主要是正确的颜色）。如果您没有面板，则选项卡将不起作用。

请参阅 wxPython 的创建者 Robin Dunn 说同样的话的线程：[https ://groups.google.com/forum/?fromgroups=#!topic/wxpython-users/gF8r_HwnOEU](https://groups.google.com/forum/?fromgroups=#!topic/wxpython-users/gF8r_HwnOEU)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:44:39.680

这是我以前做的东西，不是很好，但我可以假设你可以随意添加

```
import os
import wx

class tab(wx.Panel):
    def __init__(self, parent, newid=0, name="New Tab", file=None, aNewTab=False):
        wx.Panel.__init__(self, parent)
        self.control = wx.TextCtrl(self, style=wx.TE_MULTILINE)
        sizer = wx.BoxSizer()
        sizer.Add(self.control, -1, wx.EXPAND, newid)
        self.SetSizer(sizer)
        if file != None:
            self.control.write(file)
        else:
            pass

class MainWindow(wx.Frame):

    def __init__(self, parent, title):
        wx.Frame.__init__(self, parent, title=title, size=(1000,900))
        self.CreateStatusBar()

        self.buttons = []

        filemenu = wx.Menu()
        helpmenu = wx.Menu()

        menuOpen = filemenu.Append(wx.ID_OPEN, "&Open", "Open a file to edit")
        menuSave = filemenu.Append(wx.ID_SAVE, "&Save", "Save the current file")
        menuSaveAs = filemenu.Append(wx.ID_SAVEAS, "&Save As", "Save the current file as")
        menuExit = filemenu.Append(wx.ID_EXIT, "E&xit", "Terminate the program")
        menuAbout = helpmenu.Append(wx.ID_ABOUT, "&About", "Information about this program,")

        menuBar = wx.MenuBar()
        menuBar.Append(filemenu, "&File") 
        menuBar.Append(helpmenu, "&Help")
        self.SetMenuBar(menuBar)

        self.openFiles = { }

        self.p = wx.Panel(self)
        self.nb = wx.Notebook(self.p)
        self.newTab = tab(self.nb)
        self.nb.AddPage(self.newTab, "New Tab")
        self.sizer = wx.BoxSizer()
        self.sizer.Add(self.nb, 1, wx.EXPAND)
        self.p.SetSizer(self.sizer)

        #new ids
        saveid = wx.NewId()
        openid = wx.NewId()
        boldid = wx.NewId()

        #Set Events
        self.Bind(wx.EVT_MENU, self.OnAbout, menuAbout)
        self.Bind(wx.EVT_MENU, self.OnExit, menuExit)
        self.Bind(wx.EVT_MENU, self.OnOpen, menuOpen)
        self.Bind(wx.EVT_MENU, self.OnSave, menuSave)
        self.Bind(wx.EVT_MENU, self.OnSave, menuSaveAs)
        # Events that are activated when buttons are pressed
        self.Bind(wx.EVT_MENU, self.OnSave, id=saveid)
        self.Bind(wx.EVT_MENU, self.OnOpen, id=openid)
        self.Bind(wx.EVT_MENU, self.OnBold, id=boldid)

        self.accel_tbl = wx.AcceleratorTable([(wx.ACCEL_CTRL, ord('S'), saveid),
                                              (wx.ACCEL_CTRL, ord('O'), openid),
                                              (wx.ACCEL_CTRL, ord('B'), boldid)])
        self.SetAcceleratorTable(self.accel_tbl)

        self.Show(True)

    def OnAbout(self,e):
        dlg = wx.MessageDialog(self, "A simple text editor", "About Simple Editor", wx.OK)
        dlg.ShowModal()
        dlg.Destroy()

    def OnExit(self,e):
        if self.control.IsModified:
            dlg = wx.MessageDialog(self, "If you quit now all your work will be erased. Do you still want to quit?", "Are You Sure?", wx.YES_NO | wx.ICON_QUESTION)
            a = dlg.ShowModal()
            if a == wx.ID_YES:
                self.Close(True)
            else:
                self.OnSave(self, True)

    def OnOpen(self,e):
        """
        Open a File
        """
        self.dirname = ''
        dlg = wx.FileDialog(self, "Choose a file", self.dirname, "", "*.*", wx.FD_OPEN)
        if dlg.ShowModal() == wx.ID_OK:
            self.filename = dlg.GetFilename()
            self.dirname = dlg.GetDirectory()
            f = open(os.path.join(self.dirname, self.filename), 'r')
        newTab = tab(self.nb, name=self.filename, file=f.read(), aNewTab=True)
        self.nb.AddPage(newTab, "%s" %(self.filename))
        f.close()
        self.SetTitle("Simple Editor - %s" %(self.filename))
        dlg.Destroy()

    def OnSave(self,e, exit=False):
        """
        Save a file
        """
        #if self.newTab.control.IsEmpty():
            #dlg = wx.
        self.dirname = ''
        dlg = wx.FileDialog(self, "Where do you want to save this file?", self.dirname, "", "*.*", wx.FD_SAVE)
        if dlg.ShowModal() == wx.ID_OK:
            self.filename = dlg.GetFilename()
            self.dirname = dlg.GetDirectory()
            f = open(os.path.join(self.dirname, self.filename), 'w')
            a = str(self.control.GetValue())
            f.write(a)
            f.close()
        dlg.Destroy()
        if exit != False:
            self.Close(True)
        self.SetTitle("Simple Editor - %s" %(self.filename))

app = wx.App(False)
frame = MainWindow(None, "Simple Editor")
app.MainLoop() 
```

# sql-server - 用一组可能重叠的排除项计算日期范围内的天数

> ID：15211282
> 
> 赞同：2
> 
> 时间：2013-03-04T21:16:03.843
> 
> 标签：sql-server, tsql

给定以下示例查询，当还给出一组要排除的范围时，考虑到这些范围可能有重叠的日期，什么是计算日期范围内总天数的合理且高效的方法？

更简单地说，我有一个表格，其中包含一组关闭计费的日期范围，我从一个日期范围开始（比如 Jan1 - Jan31），我需要确定在该范围内发生了多少计费天。只需将日期的日期差异减去禁用日期的日期差异的总和。但是，禁用日期范围有可能重叠，即在一条记录中禁用 Jan5-Jan8，在另一条记录中禁用 Jan7-Jan10 - 因此简单的总和会使 Jan7 加倍。排除这些重叠并获得准确计数的最佳方法是什么。

```
Declare @disableranges table (disableFrom datetime, disableTo datetime)
insert into @disableranges
select '01/05/2013', '01/08/2013' union
select '01/07/2013', '01/10/2013' union
select '01/15/2013', '01/20/2013'

declare @fromDate datetime = '01/01/2013'
declare @toDate datetime = '01/31/2013'

declare @totalDays int = DATEDIFF(day,@fromDate,@toDate)
declare @disabledDays int = (0 /*not sure best way to calc this*/)

select @totalDays - @disabledDays 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:33:33.387

就我而言，尝试过这个并且工作正常。

```
Declare @disableranges table (disableFrom datetime, disableTo datetime)
insert into @disableranges
select '01/05/2013', '01/08/2013' union
select '01/07/2013', '01/10/2013' union
select '01/15/2013', '01/20/2013'

declare @fromDate datetime = '01/01/2013'
declare @toDate datetime = '01/31/2013'

declare @totalDays int = DATEDIFF(day,@fromDate,@toDate) + 1 /*Without +1 it is giving 30 instead of 31*/
declare @disabledDays int = (0 /*not sure best way to calc this*/)
/*Fill temporary table with the given date range.*/
SELECT  DATEADD(DAY, nbr - 1, @fromDate) TempDate INTO #Temp
FROM    ( SELECT    ROW_NUMBER() OVER ( ORDER BY c.object_id ) AS Nbr
          FROM      sys.columns c
        ) nbrs
WHERE   nbr - 1 <= DATEDIFF(DAY, @fromDate, @toDate)
/*Check how many dates exists in the disableranges table*/
SELECT @disabledDays=count(*) from #Temp t WHERE 
EXISTS(SELECT * FROM @disableranges 
WHERE t.TempDate BETWEEN disableFrom AND DATEADD(d, -1, disableTo))

select @totalDays /*Output:31*/
select @disabledDays /*Output:10*/
select @totalDays - @disabledDays /*Output:21*/
drop table #Temp 
```

从答案[https://stackoverflow.com/a/7825036/341117](https://stackoverflow.com/a/7825036/341117)中获取帮助，用日期范围填写表格

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:38:55.347

您可以使用[递归 CTE](http://msdn.microsoft.com/en-us/library/ms186243%28v=sql.105%29.aspx)生成 和 之间的`@dateFrom`日期`@dateTo`。然后将日期与范围进行比较，并找到任何范围内的所有日期。最后，计算结果中的行数以获取禁用日期的计数（[**DEMO**](http://www.sqlfiddle.com/#!3/d41d8/10365)）：

```
-- recursive CTE to generate dates
;with dates as (
  select @fromDate as date
  union all
  select dateadd(day, 1, date)
  from dates
  where date < @toDate
)

-- join with disable ranges to find dates in any range
, disabledDates as (
  select date from dates D
  left join @disableranges R
    on D.date >= R.disableFrom and d.Date < R.disableTo
  group by date
  having count(R.disablefrom) >= 1
)

-- count up the total disabled dates
select @disabledDays=count(*) from disabledDates; 
```

# java - 正则表达式 Java 端点注释

> ID：15211284
> 
> 赞同：1
> 
> 时间：2013-03-04T21:16:10.550
> 
> 标签：python, perl, javascript, java, javascript, python, regex, perl

我有一个项目来记录一个非常大的项目中的所有端点。我只有源文件，所以我不能在上面运行某种文档工具。我唯一的资源（据我所知）是带有 perl 或 python 或类似东西的正则表达式。

以下是方法上的注释示例：

```
/**
 * Method Javadoc
 */
@Endpoint
@POST
@Path("path/{objectid}")
@Consumes(MediaType.APPLICATION_JSON)
@Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
@TypeHint(SomeObject.class)
public Response deleteObject(@PathParam("objectid") Integer objectid) {
  //method code
} 
```

我相信我唯一可以信任的是一致的是每个端点方法都会有`@Endpoint`注释。它可能是也可能不是第一个注释。这些方法可以有任何签名。

对于像这样的正则表达式的任何帮助都会很棒。我希望匹配所有这些信息不仅仅需要一个正则表达式，所以一些[python](/questions/tagged/python "显示标记为“python”的问题")、[perl](/questions/tagged/perl "显示标记为“perl”的问题")甚至[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")也会有所帮助！

只是为了让你知道我要做什么（我不希望你为我做这项工作，我主要是在寻求正则表达式的帮助），我想要的是一个具有以下结构的 csv：

```
SourceFile.java  |  MethodName  |      Path       | Method  |  QueryParams  |  FormParams  |  Consumes                  |  Produces                                                |  ReturnedObject
ClassName.java   | deleteObject | path/{objectid} |  POST   |  objectid,    |              | MediaType.APPLICATION_JSON |  {MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML} | SomeObject.class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:20:50.350

您对 regexp 作为唯一解决方案的态度如何？假设您已经编译了代码（或可以编译它），并且您的注释是零售的，您可以编写一个遍历所有类的 java 方法，使用 class.forName() 加载它们，然后你有一个多种反射 API 供您使用，以检查类、方法、字段等的注释。

如果类被 jarred 了，您只需在运行时将 jar 添加到类路径中，然后使用 ZipInputStream 打开它，检查条目，然后使用 class.forName() 将它们一一加载。如果它“爆炸”（只是一堆 *.class 文件）你的工作就更容易了。

浏览一个 zip（其中 *.jar、*.ear、*.war 是）类似于：

```
ZipInputStream zis = new ZipInputStream(new FileInputStream("fileName"));
ZipEntry entry;
while ((entry = zis.getNextEntry())!=null) {
    if (entry.isDirectory()) {
        continue;
    }
    if (!entry.getName().endsWith(".class")) {
        continue;
    }
    Class theClass = Class.forName(entry.getName());
    Endpoint targetAnnotation = theClass.getAnnotation(Endpoint.class);
    if (targetAnnotation == null) {
        continue;
    }
    //probably what youre looking for
} 
```

当然，您的程序需要在执行的 lasspath 上使用目标 *.war/jar/ear 执行，才能使`Class.forName()`调用生效。如果编译后的代码没有震动，那么您可以简单地以非常相似的方式遍历文件系统。

如果您之后的注释在编译后没有保留，您可以考虑引入一个可以读取 java 代码并遍历语法树的库，例如[这个](http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html#sec-parsing-a-source-file)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:46:27.933

像这样的东西可能在 Perl 中起作用，例如，

```
my $found_method;
my $found_endpoint;

# Iterate over each line of the input .java file
while (<>) {
  $found_method = 0;
  $found_endpoint = 0;

  # Look for an @endpoint annotation, and capture what's between the
  # parenthesees.  Do the same for each annotation.
  if (/\@endpoint/i) {
    $found_endpoint = 1;
  } elsif (/\@path\(([^\)]+)\)/i) {
    $path = $+;
  } elsif (/\@consumes\(([^\)]+)\)/i) {
    $consumes = $+;
  } elsif (/\@produces\(([^\)]+)\)/i) {
    $produces = $+;
  } elsif (/\@typehint\(([^\)]+)\)/i) {
    $typehint = $+;

  # Look for a method definition (all on one line)
  } elsif (/\w+\s+\w+\(.*{/i) {
    $open_brackets = 1;

    # Skip over the bracketed method definition
    while ($open_brackets) {
      $found_method = 1;
      if (/{/) {
        $open_brackets++;
      } elsif (/{/) {
        $open_brackets--;
      }
    }
  }

  # If we just finished passing over an annotated method, output what we
  # found
  if ($found_method and  $found_endpoint) {
    print "\npath = " . $path;
    print "\nconsumes = " . $consumes;
    print "\nproduces = " . $produces;
    print "\ntypehint = " . $typehint;
  }
} 
```

# bittorrent - 如何从 torrent-magnet 链接获得第一个对等点？

> ID：15211285
> 
> 赞同：29
> 
> 时间：2013-03-04T21:16:15.163
> 
> 标签：bittorrent, dht, magnet-uri, kademlia

我一直在尝试了解 torrent-magnet 技术，但我似乎无法弄清楚在打开磁力链接时如何连接到第一个对等方。

当您获得如下所示的磁力链接时，它不包含初始对等点 - 只有 BitTorrent 信息哈希 (btih) 和文件名。

```
magnet:?xt=urn:btih:bbb6db69965af769f664b6636e7914f8735141b3&dn=ubuntu-12.04-desktop-i386.iso 
```

根据[BitTorrent & Magnets：它们是如何工作的？（MakeUseOf）](http://www.makeuseof.com/tag/bittorrent-magnets-work-technology-explained/)

> 如果您单击未指定跟踪器 ( `tr`)**的磁力链接，将使用 DHT 找到第一个对等**点。一旦你有了对等点，对等点交换也开始了。

Wikipedia 上的[DHT 文章](http://en.wikipedia.org/wiki/Distributed_hash_table)没有指定如何找到对等点，但在[Kademlia 文章](http://en.wikipedia.org/wiki/Kademlia)（BitTorrent DHT 所基于）中，它说

> 想要加入网络的节点必须首先通过引导过程。在这个阶段，**加入节点需要知道**已经参与 Kademlia 网络的另一个节点的 IP 地址和端口——一个引导节点（从用户获得，或从存储的列表中获得）。

但是它从哪里知道那个节点呢？我没有在磁力链接中看到地址或任何内容。由于它是分散的（无跟踪器），我不希望它提前*知道*节点。或者 DHT 实际上*不是*去中心化的？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-17T20:48:49.523

在大多数情况下，当你启动一个 bittorrent 客户端时，引导程序：

1.  上次会话中的节点，已保存到磁盘
2.  您所在的任何群体中的其他同龄人

如果客户没有其他方法可以找到它们，则可以使用一些众所周知的引导节点。基本上，这种情况发生的唯一情况是您第一次安装客户端时，您下载的第一个 torrent 是没有跟踪器的磁力链接。

然后你可以点击 router.utorrent.com:6881。我相信传输、azureus 和 bitcomet 运行类似的路由器，可能还有其他客户端。

“路由器”是指一个节点，其行为与 DHT 中的任何其他节点相似，但可能具有不同的机制来确定分发哪些节点，并且可能专门针对仅引入 dht 节点的用例进行了优化彼此。

**更新：**您可以运行自己的 DHT 引导机器，[这](https://github.com/bittorrent/bootstrap-dht)是源代码。

# jquery-select2 - select2-choices ui 元素：如何只允许匹配标签的条目？

> ID：15211292
> 
> 赞同：1
> 
> 时间：2013-03-04T21:16:58.770
> 
> 标签：jquery-select2

我在一个简单的 webapp 上使用“select2-choices”元素。我能够使用标签生成的数据填充搜索条目，并且排序和选择都按预期工作。

但是，即使未在 tags 属性中指定，用户仍然可以输入自己的选择：

```
tags:[{id: 1, text: 'red'}, {id: 2, text: 'green'}, {id: 3, text: 'blue'}] 
```

如果用户键入“chartreuse”并按回车键，它会被添加到隐藏字段中，从而添加到表单输入中。

![在此处输入图像描述](../Images/b23a6e8b918441583f1b6c891da9de10.png)

如何防止这种情况，并只允许与标签匹配的项目？

# android - 如何在录制视频帧时检索其时间戳？

> ID：15211297
> 
> 赞同：11
> 
> 时间：2013-03-04T21:17:30.083
> 
> 标签：android

因此，我一直在尝试找出一种方法来获取正在录制的视频帧的时间戳。

在线和 API 文档中的所有示例都告诉您使用 MediaRecorder 录制来自摄像机的视频。问题是没有返回时间戳数据，也没有在记录帧时调用回调。

我开始研究 Android 4.2 源代码中的相机应用程序，并在这方面取得了重大进展。我成功地从相机录制了视频，在调用 SurfaceTexture 的 onFrameAvailable 侦听器时将帧时间戳保存到文件中，因为 SurfaceTexture 具有时间戳属性。

不过，经过进一步调查，我发现我在*显示*框架时收到了这些回调，而不是在*记录*时。事后看来，这很有意义，我应该早点发现它。

无论如何，我继续深入到相机应用程序并开始查看它的 EffectsRecorder 类。我发现它通过过滤器框架使用了一些未记录的 API 来允许使用 OpenGL 着色器。对于我的用例，这很有帮助，所以我可能会继续沿着这条路走下去。我仍在尝试通过它来正确录制视频，但我觉得我仍然只会显示时间戳，而不是录制。

进一步看，我发现它使用了一个过滤器，该过滤器下面有一个 MediaRecorder 类，使用了一个未记录的第二个视频源，而不是相机，称为 GRALLOC_BUFFER = 2。这更加有趣和有用，但最终，我仍然需要时间戳正在录制的帧。

我正在呼吁 Stack Overflow，希望社区中有人遇到过这种情况。我只需要一个指向哪里的指针。我可以提供源代码，因为其中大部分是从 AOSP 中提取的，但我还没有提供，只是因为我不确定什么是相关的。

非常感谢您的帮助。

# api - 如何在 OauTh Token 之后在 Google Contacts API 中获取登录用户的 useID/Email

> ID：15211300
> 
> 赞同：1
> 
> 时间：2013-03-04T21:17:38.263
> 
> 标签：api

我开发了一个运行良好的程序，但我可以从 gmail 导入数据。我想跟踪用户如何获得管理联系人的权限。但是经过一番艰苦的搜索，我没有得到任何关于登录用户的想法。我的代码如下。

============================================

```
var parameters = new OAuth2Parameters
            {
                ClientId = ConfigurationManager.AppSettings["ClientID"].ToString(),
                ClientSecret = ConfigurationManager.AppSettings["ClientSecret"].ToString(),
                RedirectUri = ConfigurationManager.AppSettings["RedirectURL"].ToString(),
                Scope ="https://www.googleapis.com/auth/userinfo.profile"

            };

            parameters.AccessCode = Request.QueryString["Code"].ToString();
            OAuthUtil.GetAccessToken(parameters);
            Session["Token"] = parameters.AccessToken; 
```

====================================

但我不知道如何获取登录用户的电子邮件。请让我这样

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T04:06:26.773

[请求https://www.googleapis.com/auth/userinfo.email](https://www.googleapis.com/auth/userinfo.email)的附加范围，然后您也可以访问用户信息。还有一个 userinfo.profile 女巫包含有关用户的其他信息，如姓名、头像、语言等。

您的代码看起来像 C#，但我只有一个使用多个范围和共享令牌的 Python 示例。

代码：[https](https://code.google.com/p/google-api-oauth-demo/) ://code.google.com/p/google-api-oauth-demo/ 文章：[http ://www.hackviking.com/2013/10/python-get-user-info-after-oauth/](http://www.hackviking.com/2013/10/python-get-user-info-after-oauth/)

# wso2esb - 活动 MQ 与默认 ESB 消息存储

> ID：15211303
> 
> 赞同：0
> 
> 时间：2013-03-04T21:18:04.390
> 
> 标签：wso2esb

有人能告诉我 Active MQ 和默认 ESB 消息存储之间的本质区别吗？

每个简单的示例案例的最佳用途是什么？

谢谢布拉诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T10:02:31.277

There are two type of message stores that WSO2 ESB supports the In memory message store and JMS message store

Here are the main differences between those two

**In memory message store**

*   Stores messages in an in-memory queue.
*   Not persistent
*   Supports random access
*   Retains message order

**JMS message store**

*   Stores message in a JMS queue (works with any JMS/JNDI compliant broker)
*   Persistent
*   Does not support random access
*   Retains message order

So as a JMS message store you can use any JMS Broker you desire (after some configuration though). It can be Apache Active MQ , some JBOSS destribution or WSO2 message broker (another WSO2 product)

For the simple use case you asked, Please refer [this blog post by hiranya jayathilake](http://techfeast-hiranya.blogspot.com/2012/01/wso2-esb-tips-tricks-08-message-stores.html) It clearly define the usage of each message stores

If you are looking for some implementation refer the following posts in WSO2 Oxygen tank

1.  [Implementing Store and Forward Messaging Patterns With WSO2ESB Part 1](http://wso2.org/library/articles/2011/10/implementing-store-forward-messaging-patterns-wso2esb-part-1)
2.  [Implementing Store and Forward Messaging Patterns with WSO2 ESB Part 2](http://wso2.org/library/articles/2011/12/implementing-store-forward-messaging-patterns-wso2esb-part-2)

Thank you

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T11:59:57.197

有关 ESB In Memory Message Store [1] 和 JMS Message Store [2] 的详细说明，请参阅以下文章。JMS 消息存储可以配置为在 ActiveMQ 中存储消息，如 [3]

[1] [http://docs.wso2.org/wiki/display/ESB460/In+Memory+Message+Store](http://docs.wso2.org/wiki/display/ESB460/In+Memory+Message+Store)

[2] [http://docs.wso2.org/wiki/display/ESB460/JMS+Message+Store](http://docs.wso2.org/wiki/display/ESB460/JMS+Message+Store)

[3] [http://docs.wso2.org/wiki/display/ESB460/Store+and+Forward+Using+JMS+Message+Stores](http://docs.wso2.org/wiki/display/ESB460/Store+and+Forward+Using+JMS+Message+Stores)

# vb.net - 缺少对类库的引用时处理“FileLoadException”

> ID：15211310
> 
> 赞同：0
> 
> 时间：2013-03-04T21:18:32.813
> 
> 标签：vb.net, visual-studio-2008

我编写了一个 DLL/类库，我在我的一些应用程序中使用它。我在项目引用中有对库的引用，我在如下形式的“公共类”中声明了库的一个瞬间（即不在子或函数内）：

```
Dim myLibrary As New MyHelperLibrary.MyHelperLibraryClass 
```

我喜欢尝试处理任何错误，而不是让用户看到可怕的 Unhandled Exception 窗口，但是如果出于某种原因，我的库丢失或已被删除，我似乎无法处理它生成的异常：

```
System.IO.FileNotFoundException: Could not load file or assembly 'MyHelperLibrary, Version=0.9.0.0, Culture=neutral, PublicKeyToken=45f96d659b47asd9' or one of its dependencies. The system cannot find the file specified. 
```

有没有办法处理上述情况？显然，我不能在 Dim 周围放置 Try/Catch，因为它在方法之外，但我什至不确定是否是导致错误的那条线，或者只是存在不存在的项目引用这一事实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:34:29.923

通常，直接在全局范围内的第三方库的实例对象不是一个好习惯，因为它可能导致您提到的那种情况。

您应该在将使用它们的类的构造函数或加载方法上移动变量的实例化。

前任：

```
Class MyClass

    Dim myLibrary As MyHelperLibrary.MyHelperLibraryClass

    Private Sub New()
        myLibrary = New MyHelperLibrary.MyHelperLibraryClass
    End Sub

End Class 
```

或者：

```
Class MyClass

    Dim myLibrary As MyHelperLibrary.MyHelperLibraryClass

    Public Sub Main()
        myLibrary = New MyHelperLibrary.MyHelperLibraryClass
    End Sub

End Class 
```

通过这种方式，您可以使用 try/catch 块包装实例化。

另一种方法是处理 Application.UnhandledException

```
Private Sub MyApplication_UnhandledException(ByVal sender As Object, ByVal e As Microsoft.VisualBasic.ApplicationServices.UnhandledExceptionEventArgs) Handles Me.UnhandledException
    MsgBox(e.Exception.Message ) 
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T01:45:24.533

> 我什至不确定是否是导致错误的那条线

它是，但不是你想的。异常是由抖动生成的，*在*任何实际使用该类型的代码甚至开始运行之前。作为准时制，这通常是在调用类的任何方法中。为了生成代码，首先需要组装的是抖动。异常将在进行调用的代码中引发，而不是在您的班级附近的任何地方。

从那里开始变得更糟。当您运行发布版本时，抖动可能会将您的类中的方法内联到调用该方法的代码中。现在，在调用您的类的方法的方法中引发了异常。如果您的程序集具有非平凡数量的公共类和非平凡数量的公共成员，则可能引发异常的可能位置数量可能非常大。数百个是可能的。

如果这听起来像是一个非常糟糕的主意，那么，是的，它是。

# javascript - CSS + jquery 响应式背景颜色变化

> ID：15211313
> 
> 赞同：0
> 
> 时间：2013-03-04T21:18:38.933
> 
> 标签：javascript, jquery, css

我想要实现的目标是，如果窗口大小大于 400，`#box2`颜色变为黑色（当 onhover on 时`#box1`），如果小于 400，`#box2`颜色变为黄色。

我以为我完成了这个任务，但是我发现我总是需要刷新页面才能看到效果。一旦窗口大小发生变化，jQuery 就不会立即工作。

我是否需要使用 ajax 或其他东西来使 jQuery 响应工作？

在线示例：http: [//jsfiddle.net/dFbXr/](http://jsfiddle.net/dFbXr/)

这是我的代码

```
HTML:
    <div id="box1">
        <div id="box2"></div>
    </div>

jQuery:
    function colorchange(){
     if($(window).width() > 400){
        $("#box1").mouseover(function(){
        $("#box2").css('background','black');
         }).mouseout(function(){
             $("#box2").css('background','blue');
     });
      }else{
     $("#box1").mouseover(function(){
     $("#box2").css('background','yellow');
    }).mouseout(function(){
          $("#box2").css('background','blue');
    });
    }
    }      

    colorchange();

CSS:
    #box1{
        display: block;
        background:red;
        background-size: 100%;
        position: relative;
        padding-bottom: 60%;
    }

    #box2{
        display:block;
        background:blue;
        position:absolute;
        height:70px;
        width:70px;
        right:50%;
        top:50%;
        margin: -35px -35px 0 0;
      } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:21:52.817

您需要`colorchange()`在页面首次加载和调整窗口大小时调用您的函数。有一个“调整大小”事件，您可以使用如下代码处理：

```
$(window).on("resize",colorchange); 
```

请注意，`colorchange`它作为参数传递给*不带括号的*[`.on()`函数](http://api.jquery.com/on/) ，即not 。没有括号传递对函数的引用，带括号立即调用函数并传递其结果。*`colorchange``colorchange()`*

 *演示：http: [//jsfiddle.net/dFbXr/1/](http://jsfiddle.net/dFbXr/1/)

您提到了 Ajax，但 Ajax 与手头的问题完全无关：它用于从 Web 服务器发送和/或接收数据，而无需重新加载整个页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:23:17.030

您只调用该`colorchange()`函数一次——您需要在调整窗口大小时再次调用它，否则它只会通过您的 if-else 一次。

您需要将此 jQuery 添加到您的代码中：

```
$(window).on("resize",colorchange); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:28:19.147

如果您只支持`CSS3`浏览器并且不想依赖 JavaScript，则可以使用媒体查询来实现相同的目的，方法是更改`:hover`​​按屏幕大小的效果。

这是一个简单的例子：http: [//jsfiddle.net/dFbXr/2/](http://jsfiddle.net/dFbXr/2/)*

# android - Android - 在我的方法上使用 Thread 会强制关闭我的应用程序

> ID：15211314
> 
> 赞同：0
> 
> 时间：2013-03-04T21:18:40.900
> 
> 标签：android, multithreading, sleep

我正在创建一个线程并在我的一个方法中启动它，在睡眠之后，应用程序刚刚关闭：s 无法理解为什么.. 任何线索？这是我的代码：

```
btn.setOnClickListener(new OnClickListener(){

                @Override
                public void onClick(View arg0) {
                    if(!toggleRemove){
                        grupo.increment();
                        vibrate();

                    }else
                        grupo.decrement();
                    showToPanel(grupo);
                    new Thread(){
                        public void run(){
                            try {
                                sleep(3000);
                            } catch (InterruptedException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }
                            showToPanel(null);
                        }
                    }.start();

                }

            }); 
```

非常感谢提前！！

改用它来修复它：

```
btn.setOnClickListener(new OnClickListener(){

                @Override
                public void onClick(View arg0) {
                    if(!toggleRemove){
                        grupo.increment();
                        vibrate();

                    }else
                        grupo.decrement();
                    showToPanel(grupo);

                    new Handler().postDelayed(new Runnable(){
                        @Override
                        public void run(){
                           showToPanel(null);
                        }
                    }, 3000); 

                }

            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:20:34.610

请在发布崩溃错误时发布完整的堆栈跟踪。但我的猜测是 showToPanel 对 UI 进行了更改？如果是这样，您不能在另一个线程上执行此操作，您必须在主线程上执行此操作。最好的方法是将延迟消息发布到处理程序并更改其中的 UI，因为除了在另一个线程上完成睡眠之外没有其他实际工作。

# mysql - 如何处理没有唯一 ID 的数据集

> ID：15211315
> 
> 赞同：0
> 
> 时间：2013-03-04T21:18:43.160
> 
> 标签：mysql

我正在处理从一个源到另一个源的数据导入例程，并且我有一个没有自己唯一标识符的表。相反，它使用四个字段的组合来确定要修改的记录。我的源表结构如下：

feed_hcp_leasenote 表：

```
BLDGID varchar(255),
LEASID varchar(255),
NOTEDATE varchar(255),
REF1 varchar(255),
NOTETEXT varchar(8000),
tempid int PRIMARY, AUTONUMBER 
```

前四个是在完全评估时使记录在源数据库中唯一的字段。我将此数据导入到两个表中，一个用于注释，另一个用于其他字段。这是我的新数据库结构：

租约表：

```
lnid int PRIMARY AUTONUMBER,
notetext longtext,
lid int (lease ID, links to lease table) 
```

customfield_data 表（保存其他数据）：

```
cfdid int PRIMARY AUTONUMBER,
data_date dateteime,
data_smtext varchar(1000),
linkid int (links the data to its source ID)
cfid int (links the data to its field type) 
```

我遇到的问题是，当我尝试识别源数据库中存在的那些记录而新数据库中没有匹配项时，我的查询似乎将记录复制到查询永远不会完成并锁定我的服务器的地步。我可以根据 BLDGID 和 LEASID 成功查询并将查询限制为正确的记录，但是当我尝试加入别名为 NOTEDATE 和 REF1 字段的 customfield_data 表时，它开始以指数方式复制记录。这是我的查询：

```
SELECT NOTEDATE, REF1, REF2, LASTDATE, USERID, NOTETEXT, lid
FROM feed_hcp_leasenote
JOIN customfield_data mrileaseid ON feed_hcp_leasenote.LEASID = mrileaseid.data_smtext AND mrileaseid.cfid = 36
JOIN leases ON mrileaseid.linkid = leases.lid
JOIN suites ON leases.sid = suites.sid
JOIN floors ON suites.fid = floors.fid
JOIN customfield_data coid ON floors.bid = coid.linkid AND coid.cfid = 1 AND coid.data_smtext = feed_hcp_leasenote.BLDGID
JOIN customfield_data status ON leases.lid = status.linkid AND status.cfid = 27 AND status.data_smtext <> 'I'
WHERE tempid NOT IN (
  SELECT tempid
  FROM feed_hcp_leasenote
  JOIN customfield_data mrileaseid ON feed_hcp_leasenote.LEASID = mrileaseid.data_smtext AND mrileaseid.cfid = 36
  JOIN leases ON mrileaseid.linkid = temp_leases.lid
  JOIN suites ON leases.sid = suites.sid
  JOIN floors ON suites.fid = floors.fid
  JOIN customfield_data coid ON floors.bid = coid.linkid AND coid.data_smtext = feed_hcp_leasenote.BLDGID AND coid.cfid = 1
  JOIN customfield_data notedate ON STR_TO_DATE(feed_hcp_leasenote.NOTEDATE, '%e-%b-%Y') = notedate.data_date AND notedate.cfid = 55 
  JOIN customfield_data ref1 ON feed_hcp_leasenote.REF1 = ref1.data_smtext AND ref1.cfid = 56
  JOIN lease_notes ON leases.lid = lease_notes.lid AND notedate.linkid = lease_notes.lnid AND ref1.linkid = lease_notes.lnid ) 
```

目前，我已将问题缩小到 NOT IN 子查询——仅运行该部分会使服务器崩溃。我想问题是因为可以有多个具有相同 BLDGID、LEASID、NOTEDATE 和 REF1（但不是全部 4 个）的音符，所以查询会不断选择自身并有效地创建一个无限循环。

没有修改源数据库以包含唯一 ID（我不能这样做），有没有人看到解决方案？提前致谢！

**（根据反馈修改）**

抱歉，信息不足，我很担心。基本上，我是从另一个我无法控制的数据库转储的 CSV 文件中导入 feed_hcp_leasenote 中的数据。将数据导入服务器后，我会添加一个 tempid 字段，并打算在 SELECT WHERE tempid NOT IN 查询中使用它，尽管我不接受这种方法。

我的目标是将 feed_hcp_leasenote 中的数据拆分为两个表：lease_note 包含主记录（具有唯一 ID）和便笺本身；customfield_data 保存与记录相关的其他数据。

源数据馈送包含大约 65,000 条记录，其中我要导入大约 25,000 条，因为其余的都连接到已停用的记录。

**（第二次编辑）**

相关表格的视觉架构：[http ://www.tentenstudios.com/clients/relynx/schema.png](http://www.tentenstudios.com/clients/relynx/schema.png)

解释查询：

```
id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra
1   PRIMARY     status  ref     data_smtext,linkid,cfid     cfid    4   const   928     Using where
1   PRIMARY     mrileaseid  ref     data_smtext,linkid,cfid     linkid  5   rl_hpsi.status.linkid   19  Using where
1   PRIMARY     leases  eq_ref  PRIMARY,sid     PRIMARY     4   rl_hpsi.mrileaseid.linkid   1   Using where
1   PRIMARY     suites  eq_ref  PRIMARY,fid     PRIMARY     4   rl_hpsi.leases.sid  1    
1   PRIMARY     floors  eq_ref  PRIMARY,bid     PRIMARY     4   rl_hpsi.suites.fid  1    
1   PRIMARY     feed_hcp_leasenote  ref     BLDGID,LEASID   LEASID  768     rl_hpsi.mrileaseid.data_smtext  19  Using where
1   PRIMARY     coid    ref     data_smtext,linkid,cfid     data_smtext     1002    rl_hpsi.feed_hcp_leasenote.BLDGID   10  Using where
2   DEPENDENT SUBQUERY  feed_hcp_leasenote  eq_ref  PRIMARY,BLDGID,LEASID   PRIMARY     4   func    1    
2   DEPENDENT SUBQUERY  mrileaseid  ref     data_smtext,linkid,cfid     data_smtext     1002    rl_hpsi.feed_hcp_leasenote.LEASID   10  Using where
2   DEPENDENT SUBQUERY  leases  eq_ref  PRIMARY,sid     PRIMARY     4   rl_hpsi.mrileaseid.linkid   1    
2   DEPENDENT SUBQUERY  suites  eq_ref  PRIMARY,fid     PRIMARY     4   rl_hpsi.leases.sid  1    
2   DEPENDENT SUBQUERY  floors  eq_ref  PRIMARY,bid     PRIMARY     4   rl_hpsi.suites.fid  1    
2   DEPENDENT SUBQUERY  ref1    ref     data_smtext,linkid,cfid     data_smtext     1002    rl_hpsi.feed_hcp_leasenote.REF1     10  Using where
2   DEPENDENT SUBQUERY  lease_notes     eq_ref  PRIMARY     PRIMARY     4   rl_hpsi.ref1.linkid     1   Using where
2   DEPENDENT SUBQUERY  coid    ref     data_smtext,linkid,cfid     data_smtext     1002    rl_hpsi.feed_hcp_leasenote.BLDGID   10  Using where
2   DEPENDENT SUBQUERY  notedate    ref     linkid,cfid     linkid  5   rl_hpsi.ref1.linkid     19  Using where 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:45:08.080

> 没有它自己的唯一标识符。相反，它使用四个字段的组合来确定要修改的记录

否：如果四个字段组合构成一个唯一键，那么您就有一个唯一标识符 - 只有一个由四个部分组成。

> BLDGID varchar(255)、LEASID varchar(255)、NOTEDATE varchar(255)、REF1 varchar(255)、NOTETEXT varchar(8000)

因此，您不知道数据的实际结构，或者您是从一个也不知道的 MSAccess 程序员那里得到的。

> 从 feed_hcp_leasenote 中选择 NOTEDATE、REF1、REF2、LASTDATE、USERID、NOTETEXT、盖子

我的天啊。如果那是答案，那么您问的是错误的问题。

> 没有修改源数据库以包含唯一 ID（我不能这样做），有没有人看到解决方案？

找另一份工作？严重地。如果您无法将主键添加到导入表/无法将其导入到定义了主键的临时表中，那么您将花费大量时间来尝试解决此问题。

顺便说一句：虽然 innodb 将处理最多 3072 字节（32 位上为 1024）的键，但它会继续像狗一样运行，直到您减小列大小或使用实际 PK 数据的散列作为主键。

从您的问题中不清楚您要添加多少行/数据库中已有多少行。您也没有提供其他表格的结构。 **您也没有提供解释计划**，这应该是您解决任何性能问题的起点。

有可能让它运行得更快 - 从您提供的信息中无法判断。但是考虑到你必须在不改变架构的情况下让它更快的**荒谬限制，我想知道还有什么其他的恐怖等待着。**

我确实认为，在不知道当前模式的详细信息的情况下，可以将当前查询分解为几个组件并检查每个组件，在导入表中维护一个分数 - 然后使用分数来确定哪些数据不匹配 -但是，这也需要架构更改。

顺便说一句，在 SQL 中有 DISTINCT 关键字的 google。

# c++ - 隐藏规则 - 参数/返回类型是否必须相同？

> ID：15211322
> 
> 赞同：0
> 
> 时间：2013-03-04T21:19:24.950
> 
> 标签：c++, inheritance, overriding

我有几个关于隐藏的问题/一般性问题？

基类有一个函数：f() 派生类现在声明虚拟 f()

如果派生函数是 const 会发生什么？这不隐藏吗？

如果返回类型不同怎么办？

参数不一样？

一个是静态的，另一个不是？

只是想知道这两个函数之间的哪些差异导致隐藏/不导致隐藏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:23:24.440

隐藏是关于名字，而不是签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:40:53.677

先说第一件事。

隐藏是指如果您在派生类中覆盖基类函数，那么在该派生类中，您定义的原始基类方法将被隐藏。- 也就是说，如果您需要从基类访问函数的定义，那么您需要在代码中包含它以使其不被隐藏：

```
using baseClass::functionName(); 
```

**const** - 如果你用 const 定义一个函数两次，另一个没有 const，它们是不同的。Scott Mayers 的书 Effective c++ 包含一个解释 const 和 non const-ness 的优秀章节，我建议你阅读它以获得透彻的理解。

您不能通过具有不同的返回类型来覆盖函数，它可能会给出编译时错误，说明它的模棱两可 - 测试它，以确保。

但是，您可以通过具有不同的参数列表来重载函数，这就是重载函数的方式。

如果您对超载和超载感到困惑-那么我建议您也阅读一下。简而言之，重载是指在同一范围内有两个具有不同参数列表的函数，而覆盖是指在派生类中重新定义具有相同参数列表的基类虚函数。

# graphviz - GraphViz 如何在页面上均匀布局形状

> ID：15211325
> 
> 赞同：0
> 
> 时间：2013-03-04T21:19:30.303
> 
> 标签：graphviz

我有一个包含很多对象的图表。其中许多对象没有链接。GraphVis 将它们放在图表顶部的一条长水平线上。

无论如何要使 GraphViz 具有最大宽度，所以未连接的对象会出现在下一个“行”上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T22:42:18.020

在它们之间添加不可见的边缘。这将迫使 graphviz 像普通节点一样布局这些节点。

# sql - sql 语句，现在 - Unix/纪元时间 6 个月

> ID：15211328
> 
> 赞同：3
> 
> 时间：2013-03-04T21:19:38.503
> 
> 标签：sql, postgresql, date, timestamp, epoch

我的数据库在此表中使用纪元时间中的整数作为日期。

我想做这样的事情：

`select * from myTable where date_column > CURRENT_TIMESTAMP - 6 months`

我不确定如何动态地从中获得 6 个月的时间。结果`CURRENT_TIMESTAMP - 6 months`必须在纪元时间内

洞察力赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:35:14.430

在 Postgres 中，我相信正确的语法是：

```
date_column > EXTRACT('epoch' from (NOW() - interval ' 6 months')) 
```

或类似地：

```
to_timestamp(date_column) > (NOW() - interval ' 6 months')) 
```

[您可以阅读Postgres 的日期/时间函数](http://www.postgresql.org/docs/9.2/static/functions-datetime.html)的完整文档以获取更多信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:21:34.437

在 MSSQL 中，您可以使用

```
select * 
from myTable 
where date_column > dateadd(month,-6,CURRENT_TIMESTAMP) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:42:06.593

你可以试试这个

```
SELECT *
  FROM myTable 
 WHERE TO_TIMESTAMP(date_column) > CURRENT_DATE - INTERVAL '6 MONTH'; 
```

**这是[sqlfiddle](http://sqlfiddle.com/#!1/51640/4)**

# python - linux 文件系统 /dev/input/event4

> ID：15211329
> 
> 赞同：1
> 
> 时间：2013-03-04T21:19:47.873
> 
> 标签：python

我已经运行了下面的代码，但我不明白结果。

Python代码：

```
f = open('/dev/input/event4', 'r')
while True:
    print f.read(8) 
```

结果很奇怪：

```
>>> 5Q�
>>> 
>>> 5Q
>>> 
>>> 5Q 
```

当我按下一个键时，它会添加一个难以理解的代码。谢谢你的帮助！

# http - Rack::Deflater 在所有页面加载（公共文件除外）上返回错误 330

> ID：15211333
> 
> 赞同：1
> 
> 时间：2013-03-04T21:20:02.580
> 
> 标签：http, gzip, jruby, rack

jRuby 1.7.3，Rack 1.5.2（带有 jRuby-Rack && Trinidad）

升级 jRuby && Rack && jRuby-Rack 后，突然我所有的页面加载都失败并出现错误 330，除非它们引用公共文件。

**我通过 rackup 的config.ru**调用我的应用程序。我在其中**使用 Rack::Deflater**。

在我更新之前，一切都很好。我没有一次更新它们，否则我会知道是哪一个导致了缺陷。

我到处寻找原因，但没有任何线索。特立尼达的配置 我设置了压缩，或者我尝试... Google PageSpeed 抱怨我的数据没有被压缩。

这个外星人或鬼魂住在哪里？如果我注定要开始等待上游代码修订，我可能应该向它收取租金或确保它获得租约。

# asp.net-mvc - 渲染视图需要很长时间

> ID：15211334
> 
> 赞同：3
> 
> 时间：2013-03-04T21:20:13.707
> 
> 标签：asp.net-mvc, razor

我们有一个 MVC 4 Web 应用程序。我使用 miniprofiler 检查了它需要多长时间，它表明渲染具有三个部分视图的视图需要很长时间。我尝试将部分视图中的信息直接移动到页面上，但这在时间上没有任何影响。我应该怎么做才能减少渲染时间？关于我应该从哪里开始寻找的任何提示？如您所见，渲染需要 48 秒。

```
 **| duration | from start(ms)**
|http://localhost:61380/CaseContacts     | 653.7    | +0.0 
|Controller: CaseController.Contacts     | 11.9     | +641.1 
|    Contacts view - not an ajax request | 0.3      | +651.7
|        populating view model           | 0.0      | +652.1
|    getting list of contacts            | 374.4    | +652.1
|    Find: Contacts                      | 499.8    | +1033.6
|    Render: Contacts                    | 48400.8  | +1535.2

**| client event           |duration(ms)| from start(ms)**
|Request start           |            | +2.0
|Response                |   1.0      | +52245.0
|Dom loading             |            | +52247.0
|scripts                 | 390.0      | +52315.0 
|Dom Content Loaded Event| 29.0       | +52707.0
|Dom Interactive         |            | + 52707.0
|Load Event              |            | + 52760.0
|Dom Complete            |            | + 52760.0 
```

**更新：**

```
public IQueryable<T> FindQueryable(Expression<Func<T, bool>> predicate, Func<T, Object> orderBy)
    {
        return this.db.GetAll<T>().Where(predicate).OrderBy(orderBy).AsQueryable<T>();
    }
public class ContactRepository : Repository<USRContact>, IContactRepository<USRContact>
{
    public IList<ContactNameViewModel> GetAll(int fieldOfficeID, string searchText = "")
    {
        if (searchText.Length > 0)
            return Mapper.Map<IList<USRContact>, IList<ContactNameViewModel>>(this.FindQueryable(x => (x.FieldOfficeID == fieldOfficeID) &&
            (x.FormalName.Contains(searchText) || x.PreferredName.Contains(searchText) || x.Alias.Contains(searchText) || x.Pseudonym.Contains(searchText)), x => (x.STMGender.Gender)).ToList());
        else
            return Mapper.Map<IList<USRContact>, IList<ContactNameViewModel>>(this.FindQueryable(x => (x.FieldOfficeID == fieldOfficeID)).ToList());
    } 
```

然后我的控制器将结果加载到视图模型上，然后：

```
@Html.Partial("~/Views/Shared/Contacts/ContactNameList.cshtml", Model.Contacts) 
```

部分视图包含以下代码：

```
@model IList<Casenator.Web.Models.Contact.ContactNameViewModel>
<ul id="NameList" style="margin-left:0">
    @foreach (var item in Model)
    {
        @*<li>@Html.RouteLink(@item.FullName, "Contacts", new { id = item.ContactID })</li>*@
        <li>@Ajax.RouteLink(item.FullName, "Contacts", new { id = item.ContactID }, new AjaxOptions { UpdateTargetId = "BasicInfo", OnSuccess="InitializeComboBoxes", OnBegin="LoadContact(" + item.ContactID + ")" }) </li>
    }
</ul> 
```

任何帮助将不胜感激！谢谢，萨弗里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:47:38.077

您从查询返回的内容很重要。如果您要返回`IEnumerable`，最好返回`IQueryable`。您可能会看到[这个](https://stackoverflow.com/questions/7051287/using-linq-select-to-cast-into-new-type-is-too-slow?rq=1)问题，它可能会对您的情况有所帮助

我不认为`automapper`像工具旨在映射许多记录。您可以尝试手动映射对象

# perl - Perl - 文件删除没有发生

> ID：15211335
> 
> 赞同：0
> 
> 时间：2013-03-04T21:20:13.927
> 
> 标签：perl, rename, unlink

我有一个文件，我必须在其中添加 2 行。为此，我打开文件，读取行，添加新行并将文件另存为新的临时文件。现在我想删除原始文件并将新文件重命名为原始文件名。但不知何故，它没有发生。

```
unlink $file;
rename($outfile,"D:/Test/Original.cxx") or die; 
```

这就是我刚才尝试的方式。任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:23:47.493

如果这仍然不起作用，你应该得到一个很好的线索为什么

```
unlink($file) && rename($outfile,$file) or die "$! $file"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:38:12.287

您应该尝试测试命令的输出。[unlink](http://perldoc.perl.org/functions/unlink.html)命令返回删除的文件数。您可以使用此信息来测试文件是否被删除：

```
 unlink $file or die qq(Cannot delete file "$file"\n;
 rename $outfile, $file or die qq(Cannot rename file "$outfile" to "$file\n); 
```

这将使您了解`unlink`是失败还是`rename`. 文件可能仍处于打开状态。如果要向文件中添加行，请确保`close`先使用关闭文件句柄：

```
open my $in_fh, "<", $file or die qq(Cannot open "$file" for reading\n);
open my $out_fh, ">", $outfile or die qq(Cannot open file "$outfile" for writing\n)

...   #What ever you're doing

close $in_fh;     #Close your files, so nothing is holding them open.
close $out_fh;
unlink $file or qq(Cannot delete file "$file"\n);
rename $outfile, $file or qq(Cannot rename "$outfile" to "$file"\n); 
```

在 Windows 上，在执行任何操作之前关闭所有文件句柄尤为重要。即使是*读取*也会阻止您对文件执行任何操作。

# jquery - jQuery通过表单提交在div中加载重新加载div中的内容

> ID：15211336
> 
> 赞同：0
> 
> 时间：2013-03-04T21:20:18.703
> 
> 标签：jquery, html, replace, load, hyperlink

我正在开发一个消息传递系统。我已经完成了收件箱和消息查看部分。它们被加载到用户帐户页面上的 div 中，并且在不刷新页面的情况下都可以正常工作。

我基于[这篇文章](http://www.hashbangcode.com/blog/using-jquery-load-content-page-without-iframe-536.html)的 jquery 。

在此处获得一些帮助以获取消息链接以在不刷新页面的情况下在 div 中打开消息，以及如何添加过滤器以允许配置文件链接实际刷新并转到实际的配置文件页面。这都很好。

我转到消息发送端，它使用模式（twitter 引导程序）来加载外部表单。这也有效，但我现在花了很长时间试图弄清楚如何做与链接相同的事情，使用表单提交，即在不刷新整个页面的情况下提交它。同样，我使用的 jQuery 与收件箱部分几乎相同。

这是收件箱代码：

```
<p id="waiting"><!-- ajax loading --></p>
<div class="messages"><!-- inbox --></div> 
```

Javascript：

```
$.ajaxSetup({ cache: false});
$(document).ready(function(){
    // set up the click event
    $('a.loader').live('click', function() {
        var toLoad = '<? echo base_url(); ?>user/messaging/';
        $('.messages').fadeOut(100, loadContent);
        $('#load').remove();
        $('#waiting').append('<div id="load" style="height: 700px; background:url(<? echo base_url(); ?>files/recordCovers/index.html?<? echo rand(5,1555); ?>); background-size: cover;"><div class="circle"></div><div class="circle1"></div></div>');
        $('#load').fadeOut(1000);

        function loadContent() {
            $('.messages').load(toLoad, '', function(response, status, xhr) {
                if (status == 'error') {
                    var msg = "Sorry but there was an error: ";
                    $(".messages").html(msg + xhr.status + " " + xhr.statusText);
                }            
            }).fadeIn(4000, hideLoader());
        }
        function hideLoader() {
            $('#load').fadeOut(2000);
        }
        return false;
    });
});

<? // this makes the links open in the same div
// a:not(.profile) allows profile links to open in browser window
// we put class="profile" on profile links.?>
$(".messages").on("click", "a:not(.profile)", function (e) {
    $(".messages").load($(this).attr("href"));
    e.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:17:48.713

如果你想保持一个正常的形式，只是捕获提交事件，那么你可以做这样的事情：

[http://jsfiddle.net/ufomammut66/uPvYx/2/](http://jsfiddle.net/ufomammut66/uPvYx/2/)

基本上在提交该表单时，我们将运行一个函数而不是立即提交。我们发送一个 ajax 调用（提交您的表单数据），然后`return false`. 返回 false 将阻止页面提交表单（此时它将再次提交，因为我们只是使用 ajax 提交的）。因此，您可以执行所有逻辑、ajax 调用、任何其他检查/处理，然后返回 false 以停止提交。

我在其中添加了更多内容，以防您希望进行一些错误恢复或围绕使用 ajax 提交的条件。如果您返回 true 而不是 false，页面将继续提交表单并重定向到该页面。因此，如果您有禁用 ajax 提交的模式，您可以在此处使用它。我在那里放了一个废话检查，作为概念证明。您可以使用该检查来查看它是否有效。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-04T21:33:48.183

我想它会帮助你：

```
function submit()
{
 $.ajax({
      type:'POST',
      url: "your url to submit",
      data: ({param_1:somevar}),    
      dataType:"json",  
      beforeSend: function(){ //do something here }
          success: function(return){ //do something here }
 });
} 
```

并且不要放置任何提交按钮。您可以使用以下方法调用提交函数：

```
$('#button').click(function(){
        submit(somevalue);  
      }); 
```

# iphone - 如何从 DatePicker 中提取数据并将其转换为整数？

> ID：15211337
> 
> 赞同：-1
> 
> 时间：2013-03-04T21:20:18.783
> 
> 标签：iphone, objective-c, datepicker

这听起来像是一个普通的问题，但我在这里有点卡住了。所以，我得到了一个 DatePicker，它显示的值如下：

```
-(void)defaultBirthdayPickerDate{

    NSString *dateString = @"09-Oct-1987";
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
    dateFormatter.dateFormat = @"dd-MMM-yyyy";
    NSDate *date = [dateFormatter dateFromString:dateString];

    [self.birthdayPicker setDate:date];
} 
```

我需要知道如何提取数据（在用户选择正确的数据之后），然后将其转换为整数（然后将其存储在其他地方，但我可以处理）。例如，用户点击 1983 年 3 月 5 日，我得到一个整数 30 (2013-1983)。请帮助我，我对此不是很热衷，任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T05:57:28.910

使用下面的代码....

```
NSString *dateString = @"09-Oct-1987";
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
dateFormatter.dateFormat = @"dd-MMM-yyyy";
NSDate *date = [dateFormatter dateFromString:dateString];
[self.birthdayPicker setDate:date];

NSDate *birthDate = self.birthdayPicker.date;

NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
NSDateComponents *components = [calendar components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit
                                           fromDate:date
                                             toDate:birthDate
                                            options:0];

NSLog(@"Difference in years %i/", components.year); 
```

# ios - UIDocument loadFromContents 内容已损坏 EXC_BAD_ACCESS？

> ID：15211344
> 
> 赞同：3
> 
> 时间：2013-03-04T21:20:39.303
> 
> 标签：ios, objective-c, cocoa-touch, icloud

几天来我一直在尝试解决这个问题，但没有运气。

我有一个通过 iCloud 同步的 UIDocument，这里是方法

```
- (id)contentsForType:(NSString *)typeName error:(NSError *__autoreleasing *)outError {

    NSMutableData *data = [NSMutableData data];
    NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];
    [archiver encodeObject:name forKey:@"name"];
    [archiver encodeObject:note forKey:@"note"];
    [archiver finishEncoding];
    return data;
}

- (BOOL)loadFromContents:(NSData *)contents ofType:(NSString *)typeName error:(NSError *__autoreleasing *)outError {
    NSLog(@"%@", [contents bytes]);
    NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:contents];
    name = [unarchiver decodeObjectForKey:@"name"];
    note = [unarchiver decodeObjectForKey:@"note"];
    [unarchiver finishDecoding];

    return YES;
} 
```

正如你所看到的，我在内容上做了一个 NSLog，大多数时候，一切都很好。它可以正确加载，但是当数据损坏时，即使只是执行 NSLog，我也会得到 EXC_BAD_ACCESS。

不知何故，无处不在的容器中的数据被破坏了，但是它不会传播到其他设备，所有其他设备都会很好地加载内容。从设备中删除应用程序并不能修复它。只有当我将文档重新保存在另一台设备上时，它才能正常工作。我正在使用ARC，所以这不应该是问题。我检查了返回 true 的 NSURLUbiquitousItemIsDownloadedKey。

显然，我首先想弄清楚是什么导致了损坏，但是我怎样才能确定数据是否无效，以便应用程序不会崩溃？

# sql-server-2008 - SQL Server 2008 R2 中长 UNION 语句中的类似 WHERE 子句

> ID：15211358
> 
> 赞同：0
> 
> 时间：2013-03-04T21:21:13.053
> 
> 标签：sql-server-2008, tsql, sql-server-2008-r2

在一个存储过程中，我需要将`INSERT`一个 long 的结果`UNION`放入一个临时表中。该`WHERE`子句对于所有表都是相同的，位于`SELECT DISTINCT`.

为了可读性而简化，它是这样的：

```
INSERT INTO #MyTemp
  SELECT col1, col2, col3 FROM tab1 WHERE col1 in (SELECT DISTINCT myId FROM TabIds) UNION
  SELECT col1, col2, col3 FROM tab2 WHERE col1 in (SELECT DISTINCT myId FROM TabIds) UNION
  SELECT col1, col2, col3 FROM tab3 WHERE col1 in (SELECT DISTINCT myId FROM TabIds) UNION
  .
  .
  .
  SELECT col1, col2, col3 FROM tab20 WHERE col1 in (SELECT DISTINCT myId FROM TabIds) 
```

虽然`TabIds`是一个小型临时表，通常有 3-6 条记录，但这似乎非常无用。

有一个更好的方法吗？

***总结我的问题：***

有没有一种方法我可以`SELECT DISTINCT myId FROM TabIds`只做一次并将其分配给一种数组/列表/集合（而不是另一个临时表），然后在`WHERE`子句中使用它，如果有办法，对于这样的小（3-6 记录）临时表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:25:38.410

从概念上讲，您正在做的事情对于一次性和数据加载都很好。不过，我希望这不是生产代码中更大模式的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:33:10.543

[您正在寻找的是一个公用表表达式。](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)

我的 T-SQL 有点生疏，但使用 CTE，您的查询将类似于：

```
WITH TabIds_CTE AS (SELECT DISTINCT myId FROM TabIds)
INSERT INTO #MyTemp
SELECT col1, col2, col3 FROM tab1 WHERE col1 IN (SELECT * FROM TabIds_CTE)
UNION ALL ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-06T14:21:25.287

我忽略了您的要求（“不要到另一个临时表”），因为我不相信它是有根据的。试试看这个解决方案是否能给你更好的性能：

```
SELECT i = myId
  INTO #x 
  FROM dbo.TabIds -- please always use schema prefix
  GROUP BY myId;

CREATE UNIQUE CLUSTERED INDEX x ON #x(i);

INSERT INTO #MyTemp(col1, col2, col3)
SELECT col1, col2, col3
FROM
(
  SELECT col1, col2, col3 FROM dbo.tab1 WHERE EXISTS -- likely better than IN
    (SELECT 1 FROM #x WHERE i = tab1.col1)
  UNION ALL 
  SELECT col1, col2, col3 FROM dbo.tab2 WHERE EXISTS 
    (SELECT 1 FROM #x WHERE i = tab2.col1)
  UNION ALL

  ...

  UNION ALL
  SELECT col1, col2, col3 FROM dbo.tab20 WHERE EXISTS 
    (SELECT 1 FROM #x WHERE i = tab20.col1)
) AS x
GROUP BY col1, col2, col3; -- likely more efficient than `UNION` to remove dupes 
```

当然，如果`col1`在所有 20 个表中都建立了索引，并且该索引包括`col2`and ，这将最有效`col3`。

我建议一个视图的原因并不是因为我认为它会使这段代码运行得更快。只是你可以创建一个视图来`UNION`为你生成这个，使*这个*代码更简单（以及任何其他重复这个单调的代码`UNION`）。这是为了方便而不是性能的建议——尽管我需要明确一点，使用视图不会神奇地让事情变慢。有时我可以，但这是一个危险且不合逻辑的回避观点的理由。

最后，我强烈考虑标准化。为什么这 20 张不同的桌子放在首位，而它们都可以放在一张桌子上？

```
CREATE TABLE dbo.Normal
(
  SourceTableID INT,
  col1 <data type>,
  col2 <data type>,
  col3 <data type>
);

-- indexes / constraints

INSERT dbo.Normal
SELECT 1, col1, col2, col3 FROM dbo.tab1
UNION ALL
SELECT 2, col1, col2, col3 FROM dbo.tab2
UNION ALL

...

UNION ALL
SELECT 20, col1, col2, col3 FROM dbo.tab20; 
```

现在您的所有查询都可以简单地引用这个新表。如果您通常只寻找其中一个来源（例如`tab5`），那么索引或分区`SourceTableID`将很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T16:32:22.067

我认为以下对于小桌子可能会更好，但仍然 - 在某些生产过程中保持这样的想法是可怕的:)

```
INSERT INTO #MyTemp (col1,col2,col3)
select distinct
    x.col1,x.col2,x.col3 
from (
  SELECT col1, col2, col3 FROM tab1 union all
  SELECT col1, col2, col3 FROM tab2 union all 
  SELECT col1, col2, col3 FROM tab3 union all 
  -- ...
  SELECT col1, col2, col3 FROM tab20
) x
join (
    SELECT DISTINCT myId FROM TabIds
) y
on x.col1=y.myid 
```

# r - 给定叶子对和它们合并的高度，在 R 中绘制一棵树

> ID：15211359
> 
> 赞同：0
> 
> 时间：2013-03-04T21:21:13.163
> 
> 标签：r, tree, cluster-analysis, dendrogram

我有一棵树的叶子列表和我希望它们合并的高度，即它们最近的共同祖先的高度。假设所有叶子的高度为 0。玩具示例可能如下所示：

```
as.data.frame(rbind(c("a","b",1),c("c","d",2),c("a","d",4)))
   V1 V2 V3
1  a  b  1
2  c  d  2
3  a  d  4 
```

我想绘制一棵代表这些数据的树。我知道 R 可以绘制来自`hclust`. 如何将我的数据转换为由返回的格式`hclust`或其他易于绘制的格式？

**编辑添加图表：**

上述数据集的树如下所示：

```
 __|___
  |      |
  |     _|_
 _|_   |   |
|   |  |   |  
a   b  c   d 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T14:42:37.013

您拥有的是已经指定的层次聚类（以您自己的数据格式约定），并且您想使用 R 的绘图工具。这似乎并不容易。我现在看到的唯一方法是创建一个对象，例如 hclust 返回的对象。它有属性“merge”、“height”、“order”、“labels”、“method”、“call”、“dist.method”，这些属性都很容易理解。有人已经尝试过这个：[https](https://stat.ethz.ch/pipermail/r-help/2006-February/089170.html) ://stat.ethz.ch/pipermail/r-help/2006-February/089170.html但显然仍然存在问题。您还可以尝试使用与您的聚类一致的虚拟值填充距离矩阵，然后将其提交给 hclust。例如

```
a <- matrix(ncol=4,nrow=4, c(0,1,4,4,1,0,4,4,4,4,0,2,4,4,2,0))
b <- hclust(as.dist(a), method="single")
plot(b, hang=-1) 
```

这可能有用。

# c# - 此上下文仅支持原始类型或枚举类型

> ID：15211362
> 
> 赞同：41
> 
> 时间：2013-03-04T21:21:22.100
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我已经看到了很多关于这个主题的问题，但是我无法对其中任何一个真正解决我所看到的问题的问题进行分类。我有一个活动实体，它跟踪分配给哪个员工以及哪个员工创建并更新了记录。如果我删除 `where a.AssignedEmployee == currentUser' 代码行，我不会得到下面的运行时错误。

> 无法创建“DataModels.Employee”类型的常量值。此上下文仅支持原始类型或枚举类型。

## 控制器

```
var query = from a in db.Activities
            where a.AssignedEmployee == currentUser
            where a.IsComplete == false
            orderby a.DueDate
            select a;
return View(query.ToList()); 
```

## 看法

```
@model IEnumerable<Data.DataModels.Activity>
.......... 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-03-04T21:24:14.630

我的猜测是该错误表明 EF 无法将相等运算符转换为`Employee`SQL（无论您是假设引用相等还是重写`==`运算符）。假设`Employee`该类具有唯一标识符，请尝试：

```
var query = from a in db.Activities
            where a.AssignedEmployeeId == currentUser.Id
            where a.IsComplete == false
            orderby a.DueDate
            select a;
return View(query.ToList()); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-04T21:24:42.067

它不喜欢您尝试将整个对象相等性转换为数据库查询的事实。您只能使用常量值执行实体框架查询，就像您执行 SQL 查询一样。解决这个问题的方法是比较 ID 以查看 AssignedEmployee 的 ID 是否与员工表中当前用户的 ID 相同。

附带说明一下，如果`currentUser`您正在跟踪的对象不是 Employee 类型，您可能需要考虑缓存该用户的相应 Employee 记录，以便在以后的查询中更好地引用它。这比试图不断地通过那张桌子要好得多。（同样，这只会影响您，如果它实际上是在不同的表中）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-30T05:31:52.673

使用 == 和 obj.Equals 的问题是实体框架不知道如何将该方法调用转换为 SQL ——即使您将这两个方法重载为可以转换为 SQL 的方法。您可以做些什么来解决 Entity Framework 中的这个缺点，即创建一个返回表达式树的方法，该表达式树执行您想要执行的更复杂的相等性检查。

例如，假设我们有以下类

```
public class Person {
    public string Firstname { get; set; } 
    public string Lastname  { get; set; }
} 
```

为了返回 Entity Framework 可以理解的自定义相等操作，在 Person 类中添加以下方法：

```
public static Expression<Func<Person, bool>> EqualsExpressionTree(  Person rhs )
{
    return ( lhs ) => string.Equals( lhs.Firstname, rhs.Firstname ) &&
                      string.Equals( lhs.Lastname, rhs.Lastname );
} 
```

在您的 LINQ 查询中，您可以像这样利用您的自定义相等代码：

```
Person anotherPerson = new Person { Firstname = "John", Lastname = "Doe" }
personCont.Where( Person.EqualsExpressionTree(anotherPerson) );
//...
if ( personCont.Any( Person.EqualsExpressionTree(anotherPerson)) ) {
//... 
```

此外，可以重写 EqualsExpressionTree 方法以调用静态 Equals 方法，从而允许您利用自定义相等逻辑。但是，无论如何，请记住*您的代码必须转换为 SQL 表达式*，因为毕竟我们是在调用数据库而不是从内存中访问内容。

# php - YII 为每个类记录单独的文件名

> ID：15211363
> 
> 赞同：0
> 
> 时间：2013-03-04T21:21:22.370
> 
> 标签：php, yii

我希望能够为每个班级拥有自己的 .log 文件。
我不想在 config/main.php 文件中手动执行此操作，而是以某种方式
将其发送到带有另一个参数的日志函数，这可能吗（也许以某种方式继承它）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T10:33:09.977

你可以这样做，但你需要编写一些代码。具体来说，您必须：

### 创建自己的实现`CLogRoute`

该标准[`CFileLogRoute`](http://www.yiiframework.com/doc/api/1.1/CFileLogRoute)将日志消息写入单个文件。调整代码并编写自己的代码应该不难，例如`OneFilePerClassLogRoute`，它可以满足您的需要。例如，[`processLogs`](http://www.yiiframework.com/doc/api/1.1/CFileLogRoute#processLogs-detail)方法的实现以

```
protected function processLogs($logs)
{
    $logFile=$this->getLogPath().DIRECTORY_SEPARATOR.$this->getLogFile();
    // ...
{ 
```

参数`$logs`是一个数组；每个项目都是一个包含四条信息的数组（如果你看的话，你可以看到它们是什么[`formatLogMessage`](http://www.yiiframework.com/doc/api/1.1/CLogRoute#formatLogMessage-detail)）。其中之一是每条消息的“类别”。您可以为类别使用类名，并`processLogs`根据其类别（即与哪个类相关）将每条消息写入单独的文件。

### 将必要的信息传递给记录器

当然，要做到这一点，您需要将当前类名作为每个日志消息的类别传递。幸运的是，这很容易使用[`__CLASS__`](http://php.net/manual/en/language.constants.predefined.php)魔法常数：

```
Yii::log($message, $level, __CLASS__); 
```

### 配置 Yii 使用你的日志路由

最后，不要忘记使用您的自定义日志路由配置 Yii，如[文档](http://www.yiiframework.com/doc/guide/1.1/en/topics.logging#message-routing)中所示。根据您编写日志路由类的方式，它可能看起来像这样：

```
'log'=>array(
    'class'=>'CLogRouter',
    'routes'=>array(
        array(
            'class'=>'MyCustomLogRoute',
            'logPath'=>'where_your_logs_will_be_saved',
            //...other options for your custom route here...
        ),
        // ...other routes here...
    ),
), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T10:12:36.657

您可以获得的最接近的方法是扩展 CLogFilter 以将有关当前类/文件名的附加信息添加到日志中。

[http://www.yiiframework.com/doc/guide/1.1/en/topics.logging#logging-context-information](http://www.yiiframework.com/doc/guide/1.1/en/topics.logging#logging-context-information)

# php - PHP/PDO 使用关联数组浏览记录集。

> ID：15211366
> 
> 赞同：1
> 
> 时间：2013-03-04T21:21:43.220
> 
> 标签：php, mysql, pdo, associative-array

我有一个简单的程序，我正在尝试实现某种分页/功能来浏览 MySQL 数据库中的各个记录。代码本身调用一个函数，该函数返回一个关联数组，以便在删除创建非顺序索引的情况下可以顺序导航记录。

```
function getKeys($handle, $user, $password) {

    try {

         $conn = new PDO($handle,$user,$password);
         $conn -> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

        }

    catch(PDOException $e) {
        echo "Error connectiong to database. Error: (" . $e -> getMessage() . ")";

    }

    $sql = "Select Workstation_ID from Workstation"; 

    $result = $conn -> query($sql);
    $resultArray = array();

    while ( $row = $result -> fetch()) {

        $resultArray[] = $row;
    }

    $conn = null;

    return $resultArray; } 
```

我试图将这个函数的结果存储到一个变量中，并从那里尝试增加该变量以用于其他函数：

```
 $Keys = getKeys($dsn,$un,$pw);

    $i = 0;

    $currID = $Keys[$i][0];

    $row = getResultSet($dsn,$un,$pw,$currID); 
```

然后我会使用 $row 来显示当前的工作站：

```
 echo "<hr class='viewHR'>";
    echo "</br></br><div class='viewFormat'>";
    echo "<form name = 'updateWorkstationForm' action ='updateWorkstation.php' method  ='post'>";
    echo "<b>Workstation Name:</b><br><input type = 'Textbox' name = 'pcName' value = '" . $row['Workstation_Name'] . "'/></br>";
    echo "<b>Serial Number: </b><br> <input type = 'Textbox' name = 'SN' value = '" . $row['Serial_Number'] . "'/></br>";

    echo "<b>Model</b></br>";

    echo "<select name ='modelSelect'>";
    echo "<option value = '".$row['Model_ID'] . "'>" .  $row['Model'] . "</option>";
    echo "</select></br>";

    echo "<b>Department</b></br>";
    echo "<select name ='DepartmentSelect'>";
    echo "<option value = '".$row['Department_ID'] . "'>" .  $row['Department'] . "   </option>";
    echo "</select></br>"; 
```

我想知道我是否完全错误地解决了这个问题，或者我将如何增加数组的索引以在单击锚标记或按钮时显示每条记录整个文件如下：

```
<html>
<body>
    <div>
        <?php

            $un = "xxx";
            $pw = "xxxxxx";
            $dsn = "mysql:host=127.0.0.1;dbname=xxxxxxxxxxx";

            $Keys = getKeys($dsn,$un,$pw);

            $i = 0;

            $currID = $Keys[$i][0];

            $row = getResultSet($dsn,$un,$pw,$currID); 

            echo "<hr class='viewHR'>";
            echo "</br></br><div class='viewFormat'>";
            echo "<form name = 'updateWorkstationForm' action ='updateWorkstation.php' method = 'post'>";
            echo "<b>Workstation Name:</b><br> <input type = 'Textbox' name = 'pcName' value = '" . $row['Workstation_Name'] . "'/></br>";
            echo "<b>Serial Number: </b><br> <input type = 'Textbox' name = 'SN' value = '" . $row['Serial_Number'] . "'/></br>";

            echo "<b>Model</b></br>";
            echo "<select name ='modelSelect'>";
            echo "<option value = '".$row['Model_ID'] . "'>" .  $row['Model'] . "</option>";
            echo "</select></br>";

            echo "<b>Department</b></br>";
            echo "<select name ='DepartmentSelect'>";
            echo "<option value = '".$row['Department_ID'] . "'>" .  $row['Department'] . "</option>";
            echo "</select></br>";

            echo "<b>Room</b></br>";
            echo "<select name ='RoomSelect'>";
            echo "<option value = '".$row['Room_ID'] . "'>" .  $row['Room'] . "</option>";
            echo "</select></br>";

            echo "<b>Property Status</b> </br>";
            echo "<select name = 'propertyStatus'>";
            echo "<option value = '".$row['Property_Status_ID'] . "'>" .  $row['Property_Status'] . "</option>";
            echo "</select></br>";

            if ($row['Property_Status'] != "Owned"){
                echo "<b>Lease Company:</b> ";
                echo "<select name = leaseSelect>";
                echo "<option value = '" . $row['Lease_Info_ID'] ."'>Company:" . $row['Company'] . ", Start: " . $row['Start_Date'] . "End: " .$row['End_Date'] . "</option>";
                echo "</select></br>";
            }

            echo "<b>Cart</b></br>";
            echo "<select name ='cartSelect'>";
            echo "<option value = '".$row['Cart_ID'] . "'>" .  $row['Cart_Type'] . "</option>";
            echo "</select></br>";

            echo "<b>Workstation Comments: </b><br> <Textarea rows='5' cols='60' name = 'wsComments'> ". $row['Workstation_Comment'] . " </Textarea></br>";

            echo "<b>Location Comments: </b><br> <Textarea rows='5' cols='60' name = 'locComments'> ". $row['Workstation_Comment'] . " </Textarea></br>";
            echo "<input type = 'submit' value = 'Update' />";
            echo "<input type = 'button' value = 'Cancel' onclick = 'location.reload(this);' />";
            echo "</form>";
            echo "</div>"; 

            /*Function to return a parallel array. This is so that non-sequential records in the database may be described sequentially with the help of an array's indices*/
            function getKeys($handle, $user, $password) {

                try {

                    $conn = new PDO($handle,$user,$password);
                    $conn -> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                }

                catch(PDOException $e) {

                    echo "Error connectiong to database. Error: (" . $e -> getMessage() . ")";
                }

                $sql = "Select Workstation_ID from Workstation"; 

                $result = $conn -> query($sql);
                $resultArray = array();

                while ( $row = $result -> fetch()) {

                    $resultArray[] = $row;
                }

                $conn = null;

                return $resultArray; 
            }

            function getResultSet($handle, $user, $password, $ID) {

                $resultSet = "";

                try {

                    $conn = new PDO($handle,$user,$password);
                    $conn -> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                }

                catch(PDOException $e) {

                    echo "Error connectiong to database. Error: (" . $e -> getMessage() . ")";
                }

                $sql = "Select Workstation.Workstation_ID,Workstation.Model_ID,Workstation.Property_Status_ID,workstation.Lease_Info_ID, Workstation.Workstation_Name, Workstation.Serial_Number, Model.Model, Department.Department,Room.Room,Property_Status.Property_Status,Lease_Info.Start_Date,Lease_Info.End_Date,Lease_Info.Company,Lease_Info.Lease_Comment,Cart.Cart_Type,Workstation.Workstation_Comment,Workstation.Location_Comment from Workstation INNER JOIN Model ON Workstation.Model_ID = Model.Model_ID  INNER JOIN Department ON Workstation.Department_ID = Department.Department_ID INNER JOIN Room ON Workstation.Room_ID = Room.Room_ID INNER JOIN Property_Status ON Workstation.Property_Status_ID = Property_Status.Property_Status_ID INNER JOIN Lease_Info ON Workstation.Lease_Info_ID = Lease_Info.Lease_Info_ID INNER JOIN Cart ON Workstation.Cart_ID = Cart.Cart_ID where Workstation_ID = :ID"; 

                $pstmt = $conn -> prepare($sql);

                if(!$pstmt) {
                    echo "Error preparing the statement. Error: (" . $conn -> ErrorInfo() . ")";
                }

                $pstmt -> bindParam(':ID', $ID);

                try {

                    $pstmt -> execute();
                }

                catch(PDOException $e) {

                    echo "Failed to execute prepared Statement. Error:  (" . $e -> getmessage() . ")";
                }

                $resultSet = $pstmt -> fetch();

                return $resultSet;

                $conn = null;
            }
        ?>  

    </div>
</body>
</html> 
```

任何批评、见解或指示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:30:42.630

如果您只想显示一个子集或仅显示一个子集，则不应获取*所有记录。*

要分页，请使用`LIMIT`从句。因此，如果您将记录分成十页，那么要获取第一页，您的查询将是：

```
SELECT * FROM workstations LIMIT 0,10 
```

其中第一个数字是偏移量，第二个数字是您希望获取的偏移量之后的记录数。要获取第二页，您需要将 limit 子句更改为`LIMIT 10,10`; 获取第三页`LIMIT 20,10`，依此类推。PHP方程是：

```
$offset = (($page - 1) * $records_per_page); 
```

页面值可以来自`$_GET`变量，例如[http://www.example.com/?page=1](http://www.example.com/?page=1)。

其次，如果您只想显示一条记录，请获取该记录：

```
SELECT * FROM workstations WHERE id = ? LIMIT 1 
```

再次通过`$_GET`参数传递 ID，并使用 PDO 进行绑定，以避免 SQL 注入漏洞：

```
<?php

$sql = "SELECT * FROM workstations WHERE id = :id LIMIT 1";

$sth = $db->prepare($sql);
$sth->bindParam(':id', $_GET['id'], PDO::PARAM_INT);
$sth->execute();
$row = $sth->fetchObject(); 
```

# qt - Qt 的 QGraphicsScene 中的抗锯齿使重叠线更暗

> ID：15211367
> 
> 赞同：3
> 
> 时间：2013-03-04T21:21:45.277
> 
> 标签：qt, pyside

在 Qt 中使用抗锯齿渲染时`QGraphicsScene`，有一种行为使绘图看起来不像预期的那样：重叠的线条变得更暗。我在文档中看不到此行为的任何描述，也找不到禁用它的方法。

例如，如果我想绘制这样一个多边形：

![多边形](../Images/3c4d030c1e7c3620cbee51a080277571.png)

由于点的数量，不可能没有重叠的线 - 很好。但是由于激活了抗锯齿功能，某些边框看起来比其他边框“厚”。

有没有什么办法可以避免这种情况，并有可以重叠的抗锯齿线，但同时被渲染而不会变暗？

我当然知道我可以重新定义`paint()`函数并手动绘制不重叠的单条线，但这是我想要避免的。我正在使用 Pyside，由于调用频率很高，这会显着减慢应用程序的速度`paint()`。

**编辑**`QPainterPath`通过使用/`QGraphicsPathItem`而不是`QPolygon`/定义对象形状来修复`QGraphicsPolygonItem`。在这种情况下，该`moveTo`功能允许避免重叠的线条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T08:35:55.313

您可以尝试的另一件事是在您的坐标（而不是尺寸）上添加半个像素。这为我解决了抗锯齿问题。

```
XCoord = int(XValue) + 0.5
YCoord = int(XValue) + 0.5 
```

还要确保在此之前您有整数像素值。

# wcf - 我怎样才能旋转回来？

> ID：15211368
> 
> 赞同：0
> 
> 时间：2013-03-04T21:21:46.080
> 
> 标签：wcf

我正在为 Windows 8 APP 开发 wcf 服务。但我一度哽咽。下面的方法，它是使用实体来数据库中的数据。但这数据返回到类类型。我的问题，如果结果为空，我可以向谁发送这种方法

```
 public AnketorDTO AnketorBul(string tc, string pass)
    {
        _entity = new AnketDBEntities();
        var result = (from i in _entity.Anketors
                          where i.TC == tc
                          where i.Sifre == pass
                          select i).ToList();
        if (!result.Any())
     -->>>   return new AnketorDTO();

        Anketor anketor = result.First();
        return Converter.ConvertAnketorToAnketorDTO(anketor);
    } 
```

使用这个方法，我通过创建一个新的类类型来发送它，但是使用这个方法的部分不起作用，因为值变为空。我们怎样才能防止它。

客户 ：

```
AnketorDTO anketor = await client.AnketorBulAsync(txtKullanici.Text, txtSifre.Password);
            **if (anketor != null)
                lblError.Text = anketor.Adi;**
            else
                lblError.Text = "Hata"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T10:42:00.613

你可以试试这个方法看看，是否有效？

```
_entity = new AnketDBEntities();
var result = _entity.Anketors.FirstOrDefault(yourexpressions); 
```

# android - Phonegap 中的卸载事件

> ID：15211376
> 
> 赞同：0
> 
> 时间：2013-03-04T21:22:12.550
> 
> 标签：android, cordova, jquery-mobile

我正在使用 PhoneGap 和 jQuery Mobile 开发 Android 应用程序。

我正在尝试将函数调用绑定到用户离开页面的事件（后退按钮或单击其他链接）。

到目前为止我所拥有的：

```
 $(window).unload(function () {
            //my function
        }) 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:15:35.767

您应该使用 jQuery Mobile 的 pagebeforehide 。来自 jQuery Mobile 文档：

**pagebeforehide** 事件：

在实际过渡动画开始之前，在我们正在过渡的“fromPage”上触发。此事件的回调将接收一个数据对象作为其第二个参数。该数据对象具有以下属性： nextPage (object) 一个 jQuery 集合对象，其中包含我们要转换到的页面 DOM 元素。请注意，在应用程序启动时的第一页转换期间不会调度此事件，因为之前没有活动页面。

# c# - 查找包含对象的数组中的最低索引？

> ID：15211381
> 
> 赞同：1
> 
> 时间：2013-03-04T21:22:21.907
> 
> 标签：c#, visual-studio-2010, powerpacks

您好，我正在使用 Microsoft.VisualBasic.PowerPacks 名称空间在 Windows 窗体上创建形状。我使用了一个数组来存储所有对象，这样我就可以根据给定的场景生成新的形状并修改对象集合的属性。

我正在尝试对数组执行查找以查找包含椭圆形的最低索引。在互联网上搜索了很长一段时间后，我只找到了可以接受固定值的语句，因为数组中的每个位置都包含相同的值，我不能这样做。

我正在寻找与以下陈述类似的东西。在哪里我可以找到第一个不为空的条目或包含“Microsoft.VisualBasic.Powerpacks.Ovalshape”的对象而不是类型。谢谢。

```
// ** Object declaration
Microsoft.VisualBasic.PowerPacks.OvalShape shape = new Microsoft.VisualBasic.PowerPacks.OvalShape();    
Microsoft.VisualBasic.PowerPacks.OvalShape[] shapes;
**//

     int myIndex = Array.IndexOf(shapes, != null); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:32:46.733

只需使用：

```
Array.FindIndex(shapes, s => s != null) 
```

# r - 在 R 中获得回归预测区间的任何简单方法？

> ID：15211384
> 
> 赞同：-1
> 
> 时间：2013-03-04T21:22:40.727
> 
> 标签：r, regression, prediction

我正在处理一个包含超过 300K 元素的大数据集，并运行一些回归分析，试图使用预测变量 Distance 估计一个名为 Rate 的参数。我有回归方程。现在我想获得置信区间和预测区间。我可以通过以下命令轻松获得系数的置信区间：

```
> confint(W1500.LR1, level = 0.95)
              2.5 %      97.5 %
(Intercept) 666.2817393 668.0216072
Distance      0.3934499   0.3946572 
```

这给了我系数 CI 的上限和下限。现在我想为预测区间获得相同的上限和下限。到目前为止，我唯一了解到的是，我可以使用以下代码获取特定距离值（例如 200、500 等）的预测区间：

```
predict(W1500.LR1, newdata, interval="predict") 
```

这对我没有用，因为我有超过 300K 不同的距离值，需要为每个值运行此代码。有什么简单的方法可以像我上面显示的 confint 命令那样获得预测间隔？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-04T21:54:36.407

必须自己编数据，但你去吧

```
x = rnorm(300000)
y = jitter(3*x,1000)

fit = lm(y~x)

#Prediction intervals
pred.int =  predict(fit,interval="prediction")

#Confidence intervals
conf.int =  predict(fit,interval="confidence")

fitted.values = pred.int[,1]

pred.lower = pred.int[,2]
pred.upper = pred.int[,3]

plot(x[1:1000],y[1:1000])
lines(x[1:1000],fitted.values[1:1000],col="red",lwd=2)
lines(x[1:1000],pred.lower[1:1000],lwd=2,col="blue")
lines(x[1:1000],pred.upper[1:1000],lwd=2,col="blue") 
```

![在此处输入图像描述](../Images/a76d116572d4c246ddf04ca51e6c647e.png)

因此，您可以看到您的预测是用于预测新数据值，而不是用于构建 beta 系数的区间。因此，您真正想要的置信区间将以相同的方式从 conf.int 获得。

# c# - 扩展方法 - 装饰器模式

> ID：15211385
> 
> 赞同：10
> 
> 时间：2013-03-04T21:22:43.550
> 
> 标签：c#, design-patterns, decorator

我想知道我们是否可以将扩展方法视为 C# 中装饰器模式的实现？因为目标相同，但实施的逻辑和概念可能不同？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T21:25:28.007

装饰器模式通常与独立于其他实例的类型的特定实例添加行为相关联。在扩展方法的情况下，它会影响在同一范围内编译的类型的所有实例。我认为它不是装饰器模式的一部分。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-04T21:25:52.733

我认为您没有正确理解装饰器模式。
这与添加*新方法*无关。*它是关于向现有方法*添加新功能。

所以，不，扩展方法不是装饰器模式的实现。

# eclipse - 运行黑莓应用程序时出现验证错误

> ID：15211386
> 
> 赞同：1
> 
> 时间：2013-03-04T21:22:47.873
> 
> 标签：eclipse, blackberry, java-me

我正在开发由其他人开发的黑莓应用程序。我尝试创建和运行其他应用程序。除了这个特定的应用程序之外，所有应用程序都可以工作。

对于这个应用程序，我需要安全元素签名。我从黑莓那里获得了签名密钥，并请求了安全元素签名。

每当我在模拟器上运行应用程序时，它都能完美运行。但是，当我尝试在 Blackberry Bold 9900 上运行它时，它会告诉我`'application name' has verification errors`，有时会说应用程序已终止，有时会说`'net_rim_tsm_lib' not found.`. 目前它说`'net_rim_tsm_lib' not found`。

我不确定它有什么问题。请帮忙。

先感谢您，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T20:18:58.713

在网上搜索并询问同事后，我发现了问题所在。基本上，我试图使用安全元素，而黑莓给我的签名密钥没有使用安全元素的权限。出于我的目的，我不需要访问安全元素，因此我只是将应用程序的那一部分取出，它运行良好。但是，如果您需要访问安全元素，则需要获取安全元素的签名密钥。您可以向 BlackBerry 索取它们，我的请求未获批准，因此我无法获得签名密钥。祝他们好运。

请注意，在网上搜索时，我发现验证错误的原因有很多。我不确定这一切是否只是废话，验证错误背后的全部原因只是一些签名密钥。所以我不确定这是否适用于您的所有问题。

谢谢

# c++ - OpenCV - 使用 calcHist 混淆

> ID：15211387
> 
> 赞同：6
> 
> 时间：2013-03-04T21:22:48.430
> 
> 标签：c++, opencv, image-processing, image-segmentation

我已经多次阅读 calcHist() 的文档，但我认为我对 OpenCV 的缺乏经验和生疏的编程技能完全使我无法理解它。

我正在寻找 HSV 图像（色调或通道 [0]）的一个通道中的像素计数，以使用 10 个根据类似的东西非常接近颜色的 bin 进行分割（让我们以此为例，我偷走了范围网络 - fwiw，省略紫红色似乎是错误的）：

红色：0-19 & 330-360 红黄 (RY)：20-49 黄色：50-69 YG：70-84 绿色：85-170 GB：171-191 蓝色：192-264 BP：265-289 紫色: 290-329

等等...

那么我该如何使用 calcHist 呢？

我就：

```
#include <opencv2/opencv.hpp>
#include <vector>
#include <opencv2/highgui/highgui.hpp>
#include <iostream>

using namespace std;
using namespace cv;

int main(int argc, char *argv[])
{
    Mat scene, sceneHSV, dest, histo;
    int numImages = 1, histChannel[] = {0}, dims = 1, histSize[] = {10};

    float redRange[] = {0, 10};
    float roRange[] = {10, 25};
    float orangeRange[] = {25, 35};
    float oyRange[] = {35, 42};
    float yellowRange[] = {42, 85};
    float ygRange[] = {85, 96};
    float greenRange[] = {96, 132};
    float gbRange[] = {132, 145};
    float blueRange[] = {145, 160};
    float bpRange[] = {160, 165};
    float purpleRange[] = {165, 180};

    const float* ranges[] = {redRange, roRange, orangeRange, oyRange, yellowRange, ygRange, greenRange, gbRange, blueRange, bpRange, purpleRange};

    vector<Mat> channels;

    scene = imread("Apple.jpg", 1);
    if (scene.data == NULL)
    {
        cout<<"FAIL"<<endl;
        cin.get();
    }

    cvtColor(scene, sceneHSV, CV_BGR2HSV);
    dilate(sceneHSV, sceneHSV, Mat(), Point(-1, -1), 1, BORDER_CONSTANT, 1);
    pyrMeanShiftFiltering(sceneHSV, dest, 2, 50, 3);
    split(sceneHSV, channels); 

    calcHist(&scene, 1, histChannel, Mat(), histo, dims, histSize, ranges, false, false); 

    cout<<histo<<endl;

    waitKey(0);

    return 0;
} 
```

怎么办？在这种情况下， calcHist 的参数是什么样的，输出直方图是什么样的？只是一个充满整数的 1x9 数组？

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T01:23:36.230

[我从这里](http://docs.opencv.org/modules/imgproc/doc/histograms.html?highlight=calchist#cv2.calcHist)修改了代码

您可能还想在[此处查看cvtColor 的文档](http://docs.opencv.org/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cvtcolor#cv2.cvtColor)

请注意，我没有尝试编译或运行此代码，因此我不保证它会起作用。但尽管如此，它可能作为参考有用。

```
Mat hist;
int nimages = 1; // Only 1 image, that is the Mat scene.
int channels[] = {0} // Index for hue channel
int dims = 1 // Only 1 channel, the hue channel
int histSize[] = {9} // 9 bins, 1 each for Red, RY, Yellow, YG etc.
float hranges[] = { 0, 180 }; // hue varies from 0 to 179, see cvtColor
const float *ranges[] = {hranges};

// Compute the histogram.
calcHist(&scene, 
nimages, 
channels, 
Mat(), // No mask
hist, dims, histSize, ranges, uniform=true)

// Now hist will contain the counts in each bin.
// Lets just print out the values. Note that you can output Mat using std::cout
cout << "Histogram: " << endl << hist << endl;

// To access the individual bins, you can either iterate over them
// or use hist.at<uchar>(i, j); Note that one of the index should be 0
// because hist is 1D histogram. Print out hist.rows and hist.cols to see if hist is a N x 1 or 1 x N matrix.
/*
MatIterator_<uchar> it, end;
int binIndex = 0;
for( it = hist.begin<uchar>(), end = hist.end<uchar>(); it != end; ++it)
{
  printf("Count in %d bin: %d\n", binIndex, *it);
  ++binIndex;
}
*/ 
```

# requirejs - 使用 RequireJS 和 CDN 设置 Backbon.Marionette

> ID：15211394
> 
> 赞同：1
> 
> 时间：2013-03-04T21:23:17.383
> 
> 标签：requirejs, marionette

我正在尝试使用 requireJS 设置一个带有 Marionette 扩展的 Backbone 项目。使用像 cdnjs 这样的 CDN 之一时，我无法使其工作。有谁知道混合这三个的好例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T19:55:34.197

我创建了一个将 Backbone.Marionette 与 Require 一起使用的示例，您可以在这里找到它：http: [//beta.plnkr.co/edit/bPMwEqPz1sYod46Stfhk](http://beta.plnkr.co/edit/bPMwEqPz1sYod46Stfhk)

您只需单击运行以确认 Mariontte 正在通过 CDN 工作。

在这个例子中，你默认打开了 html，但是在菜单中你会找到我用来加载所有内容的 script.js。

希望这个问题。

# dynamics-crm-2011 - 设置队列项目标题

> ID：15211400
> 
> 赞同：2
> 
> 时间：2013-03-04T21:23:41.347
> 
> 标签：dynamics-crm-2011

我有一个对话工作流，它创建一个启用队列的自定义实体的实例。然后我创建一个队列项并引用此实例，但我想设置队列项的标题，以便它在默认视图中具有描述性。但是，当我在“创建”步骤中设置标题字段时，它是非交互式的。我不能点击它、编辑它或用它做任何事情。我已确保标题字段不是只读的，并且我已将所有“标题”字段设置与另一个字段（队列项）进行了比较，并且两者之间的所有属性都是相同的。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T12:23:16.017

因为您无法修改该字段。队列项的标题将通过引用的活动设置。

如果您查看[queueitem 元数据](http://msdn.microsoft.com/en-us/library/gg309545.aspx#att)，您将看到该属性`title`标记为

```
attribute | ... | IsValidForCreate | ... | IsValidForUpdate 
title     | ... | False            | ... | False 
```

这意味着虽然您可以在技术上编辑和编写此字段，但系统不会允许它并过滤掉此信息。

因此，基本上您必须将引用活动的标题设置为描述性值。

# visual-c++ - WinCE 6.0 读取ini文件

> ID：15211406
> 
> 赞同：0
> 
> 时间：2013-03-04T21:23:56.870
> 
> 标签：visual-c++, windows-ce

这可能是一个哲学问题，但我正在审查一位以前的工程师的代码，并且想知道什么时候是阅读 ini 文件的最佳时间。当前应用程序每次需要一个值时都会重新读取ini文件，并在每次更改时写入数据。在我看来，一个更好的解决方案是读/写一次并将信息存储在内存中。我错过了什么吗？ini 文件中有大约 40 个条目。

工程师也做了自己的班级，难道没有现有的班级可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T11:48:54.493

默认情况下，我会在启动时读取一次配置，不仅在 CE 上，而且在任何其他系统上也会这样做。如果我希望能够对配置中的更改做出反应，我希望重新加载是明确的，例如向程序发送信号。在 CE 下缺少信号，您可以使用命名事件或询问用户是否有 UI。缺少所有这些，我会定期检查文件的时间戳并在更改时重新加载文件，但仍会在内存中保留一份副本。

不对单个值打开-读取-关闭文件的原因是，有时两个值具有依赖关系，如果这样做，您可能会将旧值和新值放入内存，从而导致不一致。此外，在实际开始使用之前，我会验证配置的完整性。也就是说，仅仅为了读取单个配置值而访问硬盘也是非常低效的。

关于更改的编写，我会根据用户的明确要求或在接受更改后自动进行。不过，出于与不读取单个值相同的原因，我会尽量避免写入单个值。

最后，INI 文件已被声明为过时，因此 CE 不支持用于读取和写入它们的 win32 API。这就解释了为什么有人滚动他们自己的类来读写这些文件。MS 希望您改用注册表，因为它提供并支持 API。我不太同意这里的 MS，因为文本配置文件（不是必需的 INI 文件）提供了一些注册表没有的功能，例如使用现有文本工具的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:07:16.587

您可以使用[Boost.PropertyTree](http://www.boost.org/doc/libs/1_53_0/doc/html/property_tree.html)库来读取和写入 INI 文件。

这是读取 INI 文件、修改并保存它的示例代码：

```
#include <iostream>
#include <string>
#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/ini_parser.hpp>

/*
[owner]
name=John Doe
organization=Acme Widgets Inc.
*/

int main(int ac, char* av[])
{
    boost::property_tree::ptree pt;

    // Read
    read_ini("data.ini", pt);
    std::cout << pt.get<std::string>("owner.name") << std::endl; // John Doe
    std::cout << pt.get<std::string>("owner.organization") << std::endl; // Acme Widgets Inc.

    // Write
    pt.put<std::string>("owner.name", "New Name");
    pt.put<std::string>("owner.name", "New Organization");
    write_ini("date2.ini", pt);

    return 0;
} 
```

**注意：**在 Windows CE 上编译此代码时，您可能需要调整 Boost.PropertyTree 库。Windows CE 的标准 C++ 库似乎没有`<locale>`标题，而 Boost.PropertyTree 在读取和写入 INI 文件时使用它。

# sql - sql 返回没有结果的日期

> ID：15211408
> 
> 赞同：1
> 
> 时间：2013-03-04T21:24:11.227
> 
> 标签：sql, postgresql, timestamp, epoch

我想得到一个结果表，显示 X 有条目的日期

```
SELECT count(*),
       date_column
FROM myTable
WHERE X
GROUP BY date_column
ORDER BY date_column DESC 
```

这可行，但我也想查看 X 没有条目的日期，在我的用例中，这将是中间日期。

因此，例如 2013-3-10 将出现在结果中，但下一个日期将是 2013-3-5，但我需要我的结果还返回 count = 0 的天数，因此在本例中为第 6 天、第 7 天, 第 8 和第 9

我将如何格式化我的查询以包括那些额外的时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:53:55.013

我模拟了一个简单的例子：

```
SELECT q.date_column, count(f.id) FROM
(SELECT
 generate_series(min(date_column),max(date_column), '1 day') AS date_column
 FROM mytable) AS q
LEFT JOIN mytable AS f
ON q.date_column=f.date_column
GROUP BY q.date_column ORDER BY q.date_column; 
```

这会生成所需范围内的所有日期。确保不要做 count(*) 否则你会得到 1 而不是 0 [http://sqlfiddle.com/#!1/fd4ff/1](http://sqlfiddle.com/#!1/fd4ff/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:00:44.937

The following works for postgresql:

```
SELECT count(*) as count, datecolumn as date FROM myTable group by datecolumn UNION 
select 0 as count, i::date as date from generate_series('2013-01-01', 
'2013-12-31', '1 day'::interval) i where i not in (select datecolumn from myTable) order by date desc 
```

# ios - 计算器应用程序不会将操作数添加到数组

> ID：15211409
> 
> 赞同：-1
> 
> 时间：2013-03-04T21:24:13.497
> 
> 标签：ios, objective-c

我正在尝试制作一个计算器应用程序，但是当我按下回车键时，没有任何东西被推入数组。我有一个定义方法的类`CaculatorBrain`，但是（现在）我在视图控制器中`pushElement`定义并实现了方法。`pushElement`

当我按下输入键时在控制台中键入操作数对象时，数组的内容为零！这是为什么？

```
#import "CalculatorViewController.h"
#import "CalculatorBrain.h"

@interface CalculatorViewController ()
@property (nonatomic)BOOL userIntheMiddleOfEnteringText;
@property(nonatomic,copy) NSMutableArray* operandStack;

@end

@implementation CalculatorViewController

BOOL userIntheMiddleOfEnteringText;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

-(NSMutableArray*) operandStack {
    if (_operandStack==nil) {
        _operandStack=[[NSMutableArray alloc]init];
    }
    return _operandStack;

}

-(CalculatorBrain*)Brain
{
   if (!_Brain) _Brain=  [[CalculatorBrain alloc]init];
    return _Brain;
}

- (IBAction)digitPressed:(UIButton*)sender {
    if (self.userIntheMiddleOfEnteringText) {
    NSString *digit= [sender currentTitle];
    NSString *currentDisplayText=self.display.text;
    NSString *newDisplayText= [currentDisplayText stringByAppendingString:digit];
    self.display.text=newDisplayText;
     NSLog(@"IAm in digitPressed method");
}
    else
    {
        NSString *digit=[sender currentTitle];
        self.display.text = digit;
       self. userIntheMiddleOfEnteringText=YES;
    }
}

-(void)pushElement:(double)operand {
    NSNumber *operandObject=[NSNumber numberWithDouble:operand];
    [_operandStack addObject:operandObject];
    NSLog(@"operandObject is %@",operandObject);
    NSLog(@"array contents is %@",_operandStack);

}

- (IBAction)enterPressed {

[self  pushElement: [self.display.text doubleValue] ];

NSLog(@"the contents of array is %@",_operandStack);

        userIntheMiddleOfEnteringText= NO;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:38:55.997

看起来操作数堆栈从未初始化。

当您直接访问时`_operandStack`，您不会经过`-(NSMutableArray*) operandStack`，这是分配和初始化操作数堆栈的唯一地方。如果未分配数组，则不能在其中放入任何内容，这就是将内容记录为 nil 的原因。

我建议在方法内部以外的任何地方都使用`self.operandStack`（它使用检查是否`_operandStack`为 nil 的`-(NSMutableArray*) operandStack`方法），或者在`viewDidLoad`.

# php - Drupal，Ubercart - 将自定义字段添加到结帐表单

> ID：15211415
> 
> 赞同：2
> 
> 时间：2013-03-04T21:24:26.920
> 
> 标签：php, drupal, ubercart

需要 Drupal 专家的帮助。

我的目的（使用 Drupal 7 和 Ubercart 3）是向 Checkout 页面添加一个自定义字段，该字段应该是动态的（来自 ajax 请求的值），其内容取决于用户的交付城市输入。

使用“额外字段窗格”模块，我已经成功创建了具有一些占位符值的字段。然后，我使用 JS 方法将值附加到该字段。当我提交具有该动态添加的选定值的表单时出现了问题 - 我对该字段有“无效选择”错误。当非添加的JS值（占位符）所选时 - 一切都按预期工作。

你能提示我解决这个问题吗？

我在这里找到了一个[https://stackoverflow.com/a/5159013/837255](https://stackoverflow.com/a/5159013/837255)，这似乎是一种常见的方法，但这里开始了其他问题。在钩子中的 %my module% 中，我无法访问字段以对其进行操作。

我需要如何更改由模块“ajax_field_name”创建的示例：

```
$form['panes']['delivery']['ajax_field_name']['#ajax'] = .... 
```

但是我的 *cking 窗格没有任何 $form['panes']['delivery']['ajax_field_name']。当我这样做时，`var_dump($form['panes']['delivery'])`我看到 'ajax_field_name' 位于`$form['panes']['delivery']['address']['#uc_addresses_address']`私有财产后面的 OBJECT 中的某处。

```
function uc_nova_poshta_form_alter(&$form, &$form_state, $form_id){
    if ($form_id == 'uc_cart_checkout_form'){
        $obj = $form['panes']['delivery']['address']['#uc_addresses_address'];
        // addressBook is a private property
        $obj->addressBook;
    }
} 
```

事实上，这段代码可以满足我的需要 -

```
$form['panes']['delivery']['address']['ajax_field_name2'] = array(
  '#type' => 'select',
  ...
} 
```

在正确的位置创建一个自定义字段，可以访问它，但仅在该表单中，此字段不会影响任何进一步的活动（订单审查、管理页面等）。同样在`$form['panes']['delivery']`此字段中（'ajax_field_name2'）与使用模块'ajax_field_name'创建的分开。

我猜这种行为的原因是一些模块，例如 uc_addresses （我是对的吗？），但即使我禁用了最可疑的模块 - 问题仍然存在。

是否有可能找出如何访问“ajax_field_name”创建的字段？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-24T05:05:29.483

这可能无法完全解决您的问题（如果您仍然有它，因为这似乎是一个相当古老的问题......），但一个问题是您使用了错误的钩子。您应该使用[`hook_uc_checkout_pane_alter`](http://api.ubercart.me/api/drupal/ubercart%21uc_cart%21uc_cart.api.php/function/hook_uc_checkout_pane_alter/7)和目标[`uc_checkout_pane_delivery`](http://api.ubercart.me/api/drupal/ubercart%21uc_cart%21uc_cart_checkout_pane.inc/function/uc_checkout_pane_delivery/7)来完成此操作。我在尝试将选择的默认国家/地区设置为美国以外的其他国家/地区时遇到了困难。`hook_form_alter`如果你通过它的变体来操纵它们，事情会很糟糕。

我现在正在处理类似的事情。当我发现它时，我会用更多信息更新这个答案。

# javascript - 更改类别 当滚动到

> ID：15211416
> 
> 赞同：1
> 
> 时间：2013-03-04T21:24:29.760
> 
> 标签：javascript, jquery, class, scroll

我有一个导航设置，当单击链接时，页面会向下滚动到列表中的相应项目，当到达项目时更改链接的类。

```
<nav>
<a href="#one" class="anchorLink">one</a>
<a href="#two" class="anchorLink">two</a>
</nav>

<ul>
    <li id="one"></li>
    <li id="two"></li>
</ul> 
```

这是一个相当粗略的例子

[http://jsfiddle.net/FSk5Q/1/](http://jsfiddle.net/FSk5Q/1/)

我还想更改项目的背景颜色（最好淡化为新颜色），然后在滚动到另一个项目时恢复它的原始类，然后更改下一个项目的类。

非常感谢您的建议。在js部门不太好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:28:22.837

你真的不需要把它弄得这么复杂，只要有可能，只需使用 CSS 过渡：

```
li:target {
    background-color: #f90;
    -moz-transition: all 2s linear;
    -ms-transition: all 2s linear;
    -o-transition: all 2s linear;
    -webkit-transition: all 2s linear;
    transition: all 2s linear;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/FSk5Q/2/)。

```
body {
  margin: 0;
  padding: 0;
}
nav {
  position: fixed;
  background: #fff;
  width: 10%;
  padding: 50px;
  background-color: rgba(255, 255, 255, 0.4);
  border: 2px solid #000;
}
.highlight {
  background: #b4b4b4;
}
ul li {
  list-style: none;
  margin-bottom: 10px;
  width: 300px;
  height: 500px;
  background: #ccc;
}
li:target {
  background-color: #f90;
  -moz-transition: all 2s linear;
  -ms-transition: all 2s linear;
  -o-transition: all 2s linear;
  -webkit-transition: all 2s linear;
  transition: all 2s linear;
}
li::before {
  content: 'list-element ' attr(id);
  display: block;
  text-align: right;
  font-size: 2em;
  font-weight: bold;
}
```

```
<nav>
  <a href="#one" class="anchorLink">one</a>
  <a href="#two" class="anchorLink">two</a>
</nav>

<ul>
  <li id="one"></li>
  <li id="two"></li>
</ul>
```

# python - python中的菜单tk

> ID：15211417
> 
> 赞同：-2
> 
> 时间：2013-03-04T21:24:35.560
> 
> 标签：python, menu, tkinter

我想在这段代码中放一个菜单（我在这个网站上找到的）；但我不知道如何，也没有找到答案。

编辑：主要问题是每当我尝试放置出现在其他窗口中的菜单时（如 tk #2）

EDIT2：我已经解决了，谢谢。

```
import tkinter as tk
TITLE_FONT = ("Helvetica", 18, "bold")
class SampleApp(tk.Tk):

def __init__(self, *args, **kwargs):
    tk.Tk.__init__(self, *args, **kwargs)
    container = tk.Frame(self)
    container.pack(side="top", fill="both", expand=True)
    container.grid_rowconfigure(0, weight=1)
    container.grid_columnconfigure(0, weight=1)
    self.frames = {}
    for F in (StartPage, PageOne):
        frame = F(container, self)
        self.frames[F] = frame
        frame.grid(row=0, column=0, sticky="nsew")
    self.show_frame(StartPage)
def show_frame(self, c):
    frame = self.frames[c]
    frame.tkraise()
class StartPage(tk.Frame):
    def __init__(self, parent, controller):
        tk.Frame.__init__(self, parent) 
        label = tk.Label(self, text="This is the start page", font=TITLE_FONT)
        label.pack(side="top", fill="x", pady=10)
         button1 = tk.Button(self, text="Go to Page One", 
                        command=lambda: controller.show_frame(PageOne))
         button1.pack()
class PageOne(tk.Frame):
    def __init__(self, parent, controller):
        tk.Frame.__init__(self, parent) 
        label = tk.Label(self, text="This is page 1", font=TITLE_FONT)
        label.pack(side="top", fill="x", pady=10)
        button = tk.Button(self, text="Go to the start page", 
                           command=lambda: controller.show_frame(StartPage))
        button.pack()
if __name__ == "__main__":
    app = SampleApp()
    app.mainloop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:46:27.853

添加类似的东西

```
 menubar = tk.Menu(self)
    file_menu = tk.Menu(menubar)
    file_menu.add_command(label='Quit', command=sys.exit)
    menubar.add_cascade(label='File', menu=file_menu)
    self.config(menu=menubar) 
```

到`SampleApp.__init__`.

* * *

```
import sys
import tkinter as tk
TITLE_FONT = ("Helvetica", 18, "bold")

class SampleApp(tk.Tk):
    def __init__(self, *args, **kwargs):
        tk.Tk.__init__(self, *args, **kwargs)
        container = tk.Frame(self)
        container.pack(side="top", fill="both", expand=True)
        container.grid_rowconfigure(0, weight=1)
        container.grid_columnconfigure(0, weight=1)

        menubar = tk.Menu(self)
        file_menu = tk.Menu(menubar)
        file_menu.add_command(label='Quit', command=sys.exit)
        menubar.add_cascade(label='File', menu=file_menu)
        self.config(menu=menubar)

        self.frames = {}
        for F in (StartPage, PageOne,
                  # PageTwo
                  ):
            frame = F(container, self)
            self.frames[F] = frame
            frame.grid(row=0, column=0, sticky="nsew")

        self.show_frame(StartPage)

    def show_frame(self, c):
        frame = self.frames[c]
        frame.tkraise()

class StartPage(tk.Frame):
    def __init__(self, parent, controller):
        tk.Frame.__init__(self, parent)
        label = tk.Label(self, text="This is the start page", font=TITLE_FONT)
        label.pack(side="top", fill="x", pady=10)
        button1 = tk.Button(self, text="Go to Page One",
                                command=lambda: controller.show_frame(PageOne))
        button1.pack()

class PageOne(tk.Frame):
    def __init__(self, parent, controller):
        tk.Frame.__init__(self, parent)
        label = tk.Label(self, text="This is page 1", font=TITLE_FONT)
        label.pack(side="top", fill="x", pady=10)
        button = tk.Button(self, text="Go to the start page",
                           command=lambda: controller.show_frame(StartPage))
        button.pack()

if __name__ == "__main__":
    app = SampleApp()
    app.mainloop() 
```

# c# - 如何在 Visual Studio 2012 中调用强类型数据集中指定的 SQL 标量函数？

> ID：15211421
> 
> 赞同：0
> 
> 时间：2013-03-04T21:24:46.023
> 
> 标签：c#, sql-server, visual-studio-2012, dataset, user-defined-functions

我正在使用 Visual Studio 2012 并使用 IDE 创建了一个数据源。使用向导，我包含了一些表格、视图和一个函数。但是，该功能没有出现在智能感知中。

如何在强类型数据集中调用标量函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:58:46.267

当您创建类型化数据集时，您最终会得到一个文件调用`MyDataSet.Designer.cs`。进去看看，你会发现两个类`MyDataSet`和`QueriesTableAdapter`. `QueriesTableAdapter`将有一个与您的功能相对应的方法。

# asp.net - 是否可以通过单击功能区按钮来启动 asp ( asp.net ) 页面？

> ID：15211425
> 
> 赞同：1
> 
> 时间：2013-03-04T21:24:54.637
> 
> 标签：asp.net, dynamics-crm-2011

我可以用功能区按钮启动 aspx (asp.net) 页面吗？aspx 页面需要继承作为登录的 Dynamics 用户的身份验证和授权。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T15:50:34.827

您可以从功能区按钮执行自定义 JavaScript，允许您启动一个新的浏览器窗口，指向您喜欢的任何内容。

要继承安全凭据，您需要查看跨 CRM 服务器和托管 ASPX 的自定义网站设置联合身份验证。正如您可能想象的那样，这不是一项微不足道的任务。

您还可以像使用 CRM 4 一样将您的网站放入自定义 ISV 文件夹。但是，这种方法在 CRM 2011 中**已被弃用**，因此不再支持 AFAIK。

正如@Konrad 指出的那样，您将无法从您的自定义网页使用数据服务 REST API (OData)，因为该服务只能从 CRM 环境中托管的 Web 资源访问。在服务器端，您可以使用组织服务。

如果您可以在网络资源中完成您需要的事情，我强烈推荐它，因为它的工作量要少得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:05:34.930

我不确定你能做到这一点。不久前，我放入了一个链接到外部网页的 iframe，**除了**连接到组织数据外，它按预期工作。我只是无法完成这项工作（老实说，我很不耐烦并且没有太努力）。

我最终部署的解决方案是运行一个 Web 资源，该资源在服务器内部运行，将数据传递给外部服务。

我假设如果您尝试打开窗口/将数据传入/传出 CRM，也会出现相同的行为。

# pdf - 使用 Ghostscript 将 TIFF 转换为 PDF

> ID：15211428
> 
> 赞同：6
> 
> 时间：2013-03-04T21:25:10.447
> 
> 标签：pdf, tiff, ghostscript, postscript

你能告诉我如何使用 Ghostscript 或 Postscript 将 TIFF 转换为 PDF 吗？

我尝试使用此命令：

```
gswin32c.exe -dBATCH -dNOPAUSE -sDEVICE=pdfwrite -sOutputFile=o.pdf test.tif 
```

但它不起作用。

它产生一个错误：

```
GPL Ghostscript 9.06 (2012-08-08)
版权所有 (C) 2012 Artifex Software, Inc。保留所有权利。
此软件不提供任何担保：有关详细信息，请参阅文件 PUBLIC。
错误：/未定义在 II*
操作数栈：

执行栈：
   %interp_exit .runexec2 --nostringval-- --nostringval-- --nostringval-- 2 %stopped_push --nostringval-- --nostringval-- --nostringval-- false 1 %stopped_push 1910 1 3 %oparray_pop 1909 1 3 % oparray_pop 1893 1 3 %oparray_pop 1787 1 3 %oparray_pop --nostringval-- %errorexec_pop .runexec2 --nostringval-- --nostringval-- --nostringval-- 2 %stopped_push --nostringval--
字典栈：
   --dict:1169/1684(ro)(G)-- --dict:0/20(G)-- --dict:77/200(L)--
当前分配模式是本地的
当前文件位置是 4
GPL Ghostscript 9.06：不可恢复的错误，退出代码 1

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T08:39:56.397

Ghostscript 读取 PDF 和 PostScript 作为输入，它不读取图像格式，特别是不读取 TIFF。但是 PostScript 是一种编程语言，因此完全可以编写 PostScript 程序来读取 TIFF 文件（Ghostscript 提供的 viewgif.ps 和 viewjpeg.ps 程序对 GIF 和 JPEG 格式执行此操作）

在某种程度上，我确实有一个程序可以做到这一点，并且已经在 comp.lang.postscript 上发布了几次。在这里分享有点大（33Kb），但如果你有兴趣，我可以通过电子邮件给你一份副本。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-05-24T00:49:18.087

该`libtiff`软件包（适用于所有主要操作系统平台）附带一个名为`tiff2pdf`.

```
$ tiff2pdf -h
  LIBTIFF, Version 4.0.3
  Copyright (c) 1988-1996 Sam Leffler
  Copyright (c) 1991-1996 Silicon Graphics, Inc.

  usage:  tiff2pdf [options] input.tiff
  options:
   -o: output to file name
   -j: compress with JPEG
   -z: compress with Zip/Deflate
   -q: compression quality
   -n: no compressed data passthrough
   -d: do not compress (decompress)
   -i: invert colors
   -u: set distance unit, 'i' for inch, 'm' for centimeter
   -x: set x resolution default in dots per unit
   -y: set y resolution default in dots per unit
   -w: width in units
   -l: length in units
   -r: 'd' for resolution default, 'o' for resolution override
   -p: paper size, eg "letter", "legal", "A4"
   -F: make the tiff fill the PDF page
   -f: set PDF "Fit Window" user preference
   -e: date, overrides image or current date/time default, YYYYMMDDHHMMSS
   -c: sets document creator, overrides image software default
   -a: sets document author, overrides image artist default
   -t: sets document title, overrides image document name default
   -s: sets document subject, overrides image image description default 
   -k: sets document keywords
   -b: set PDF "Interpolate" user preference
   -h: usage 
```

因此，获取 PDF 的简单命令是：

```
$ tiff2pdf -o output.pdf -p A4 -F test.tif 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-14T19:29:05.870

使用[gdal_translate](http://www.gdal.org/gdal_translate.html)实用程序。它专为地理空间光栅图像而设计，但它并不关心它是否只是普通图像。

```
gdal_translate -of pdf \path\to\someimage.tif test.pdf 
```

有关 geo-pdf 驱动程序及其选项的附加信息： [http ://www.gdal.org/frmt_pdf.html](http://www.gdal.org/frmt_pdf.html)

应用的默认压缩是 DEFLATE，这很好，因为它是无损的，但不会产生非常小的文件。通常使用 PREDICTOR 和 TILED 选项可以提高压缩率（但并非总是使用您的数据进行测试）。

```
gdal_translate -of pdf ^
--config COMPRESS=DEFLATE --config PREDICTOR=2 --config TILED=YES ^
in.tif deflate.pdf 
```

对于最小的文件，请使用 JPEG。对于最小和最小损耗的组合使用 JPEG2000，但在客户端的 pdf 阅读器中进行测试，因为支持不是普遍的（最近的 Adob​​e Reader 很好）。

```
gdal_translate -of pdf -co compress=jpeg -co jpeg_quality=85 ^
inimage.tif outdoc.pdf

gdal_translate -of pdf -co compress=jpeg2000 ... 
```

`-co`为简洁起见，它可以与 . 互换`--config`。第一个示例中的大写仅是约定，在命令行上无关紧要。 `^`是 Windows 字符，用于抑制换行，在一行中省略。

获取预构建的二进制文件： [http ://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries](http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries)

如果您对地理信息系统一无所知，那么弄清楚要使用哪个分发包会有点麻烦。如果您只想将程序塞入某个地方并运行它，请从 GIS Internals，2015 年 1 月 32 位稳定版本[此处获取](http://www.gisinternals.com/query.html?content=filelist&file=release-1400-gdal-1-11-1-mapserver-6-4-1.zip)*“单个 zip 中编译的二进制文件”*，解压缩并从.`SDKShell.bat`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-20T10:09:08.223

我使用 Imagick 将 Tiff 文件转换为 Pdf 文件

代码 ：

```
$document = new Imagick(test.tiff); 

$document->setImageFormat("pdf");

$document->writeImages("test.pdf", true); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-27T21:51:25.233

到目前为止，我使用过的最好的工具是 Irfanview。它允许我们制作一个非常模糊的 TIFF 文件版本，还允许我们进行混合 TIFF 到 PDF 的转换，其中一些页面是灰度的，一些是彩色的，还有一些是 CCITT4 传真编码的。

我创建了一个 .NET 程序，它使用以下命令行使用 Irfanview 转换了数百万个文档：

C:\Program Files (x86)\IrfanView\i_view32.exe TIFFFile.tiff /convert=OutputPDFFile.pdf /silent /cmdexit

.NET 程序本质上只是传递了 TIFF 输入和 PDF 输出文件的完整路径。

**设置**

下载 Irfanview 32 位。并非所有插件都可用于 64 位版本，因此我使用了 32 位。

然后下载 Irfanview 的插件包并安装。

然后打开 Irfanview，您需要通过转到文件>>批量转换/重命名来定义 IMPdf 插件（仅限传统 32 位插件）或较新的 PDF 插件的设置。

批量转换/重命名窗口中的设置对程序的每次后续执行都有效，因为它们存储在 Irfanview INI 文件中。

单击输出格式，然后选择 PDF。

然后单击选项按钮。这将允许您控制输入 TIFF 文件在转换为 PDF 时会发生什么的参数。

然后尝试 irfanview 手动对一些 TIFF 文件执行此操作，以确保所需的输出。

然后，您可以使用程序将其自动化...

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-06-12T06:36:11.420

我在 ubuntu 上使用 Java的**Ghostscript将****PDF 文件转换为 Tiff 文件。** 片段代码：

 **String convertCommand = "gs -dNOPAUSE -q -sDEVICE=tiff24nc -sCompression=lzw -dBATCH -sOutputFile=" + outputFile + " " + sourceFile;
运行时 rt = Runtime.getRuntime();
进程 pr = rt.exec(convertCommand);
pr.waitFor();

*如果要**压缩**，只需将命令替换为*
String convertCommand = "gs -dNOPAUSE -q -sDEVICE=tifflzw -dBATCH -sOutputFile=" + outputFile + " " + sourceFile;

使用前请先安装 Ghostscript，
1\. sudo apt-get install ghostscript libtiff-tools**

# c# - 不使用默认程序打开文件

> ID：15211431
> 
> 赞同：3
> 
> 时间：2013-03-04T21:25:23.503
> 
> 标签：c#, file-type

如何在 c# 中使用指定的程序打开文件，即：不是该文件类型的默认程序

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T21:27:00.663

如果您可以构建命令行来运行程序（包括将输入文件作为命令行参数传递）而不是构建命令行并使用`Process.Start`.

当然这是假设

1.  你知道程序可执行文件的路径
2.  您知道如何将文件名作为命令行参数传递。

2\. 如何工作取决于程序。它可能很简单

```
Process.Start("MyProgram.exe","MyFile.dat") 
```

但其他程序可能需要命令行开关或其他信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T21:29:35.060

您可以使用可以[在此处](http://msdn.microsoft.com/en-us/library/h6ak8zt5.aspx)`System.Diagnostics.Process(String, String)`找到更多文档的方法

样本：

```
// Start a Web page using a browser associated with .html and .asp files.
Process.Start("IExplore.exe", "C:\\myPath\\myFile.htm"); 
```

对于以后的帖子，我建议您发布您已经尝试/编写的代码，以帮助我们更好地帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-06T09:18:16.240

我在互联网上找到的所有答案都说你可以使用`Process.Start("MyProgram.exe")`

但我总是遇到找不到文件的异常，所以我通过在安装文件夹中指定 .exe 文件的完整路径来让它工作

`Process.Start(@"C:\Program Files\Google\Chrome\Application\chrome.exe")`

您可以通过在桌面快捷方式上单击鼠标右键并按 来找到安装文件夹`Open file location`。

[![图标上的右键菜单](../Images/93ec9b535f238d1277b3a4fbe51d081b.png)](https://i.stack.imgur.com/NzIGu.png)

[![突出显示 chrome.exe 的 Windows 资源管理器](../Images/e72663dbf1d1f10e85a9082eca517c18.png)](https://i.stack.imgur.com/PCjLU.png)

# javascript - 定义的 var 为 null (document.getElementById('existingDiv'))

> ID：15211433
> 
> 赞同：0
> 
> 时间：2013-03-04T21:25:27.023
> 
> 标签：javascript

在我的 HTML 文件中，我有一个 div

```
<div id="game">a div inside here</div> 
```

在我的 JS 文件的顶部（在任何函数之外）

```
var gameDiv = document.getElementById('game');
var newDiv = document.createElement('div'); 
```

在我的一个功能中（在页面加载后通过单击按钮运行）

```
newDiv.setAttribute('id', 'displayCards');
newDiv.innerHTML = 'some stuff.';
gameDiv.appendChild(newDiv); 
```

当我运行它时，Firebug 说 gameDiv 为空 :(

有任何想法吗？我是 JS 新手，仍在试图弄清楚“一切都是对象”的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:27:39.327

它在加载 DOM 之前运行。您应该将 javascript 移到元素声明之后，或者将其放在页面加载时调用的函数中（body.onload 应该可以工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:27:51.177

当你运行时：

```
var gameDiv = document.getElementById('game'); 
```

HTML 中还没有渲染元素“game”，所以它失败了。

# algorithm - 平滑 Kinect Facetracking 数据

> ID：15211435
> 
> 赞同：1
> 
> 时间：2013-03-04T21:25:28.410
> 
> 标签：algorithm, kinect, tracking

我正在尝试使用 Kinect Facetracking 控制机器人炮塔。当用户移动他的头部时，炮塔会朝同一方向移动。我能够获得用户头部的偏航、俯仰和滚动，并使用这些数据控制炮塔。我目前的尝试有效，但不要流畅地移动炮塔。运动有时是零星的和波涛汹涌的。我想要的是流畅的动作和流畅的动作。

所以我遇到的主要问题是，由于数据是实时接收的，我无法可靠地预测用户接下来要做什么。我需要在接收数据和命令之间尽可能少的延迟。

另一个问题是来自 Kinect 的数据并不完美，有时会有些波动。这是很好的数据，但如果我不对其进行处理，就会出现波动。

如何平滑来自 Kinect 的数据，使其尽可能流畅？

我有一些想法，但我宁愿不影响你，让你像我一样思考

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T20:34:12.473

TransformSmoothParameters 联合过滤帮助了一些。但是当我偶然发现这个时，最显着的变化发生了：[http](http://www.dyadica.co.uk/journal/very-simple-kalman-in-c/) ://www.dyadica.co.uk/journal/very-simple-kalman-in-c/ 所以基本上只是通过更新传递你的数据，它开始过滤它. 非常感动。很简单。效果非常好。我认为这更像是一个移动平均线而不是卡尔曼滤波器，但这正是我所需要的。希望这可以帮助那些试图做类似事情的人。

```
 private double Q = 0.000001;
        private double R = 0.0001;
        private double P = 1, X = 0, K;

        private void measurementUpdate()
        {
            K = (P + Q) / (P + Q + R);
            P = R * (P + Q) / (R + P + Q);
        }

         public double update(double measurement)
        {
            measurementUpdate();
            double result = X + (measurement - X) * K;
            X = result;
           // Debug.WriteLine("Measurement " + result + " y: " + y);
            return result;
        } 
```

# c# - 如何从数据库中读取动态属性

> ID：15211437
> 
> 赞同：6
> 
> 时间：2013-03-04T21:25:35.167
> 
> 标签：c#, ado.net, data-access-layer, sqldatareader

我会尽力解释我的情况。我的数据库中有以下表格：

```
Products{ProductId, CategoryId ...}
Categories{CategoryId ...}
CategoryProperties{CategoryPropertyId, CategoryId, Name ...}
PropertyValues{ProductId, CategoryPropertyId, Value ...} 
```

因此，目标是列出属于某个类别的产品，每个类别可以有“n”个属性，其值在“PropertyValues”表中。我有一个基于“categoryId”返回数据的查询，因此我总是可以从数据库中获得不同的结果：

对于 CPU 类别：

```
intel i7 | CPU | Model | Socket | L1 Cash | L2 Cahs | etc. 
```

对于 HDD 类别：

```
samsung F3 | HDD | Model | Speed | GB | etc. 
```

因此，根据我查询的类别，我总是可以获得不同的列号和名称。对于数据库访问，我使用简单的 ADO.NET 调用来返回结果的存储过程。但是因为查询结果本质上是动态的，所以我不知道什么是读取这些数据的好方法。

我制作了一个`Product`实体，但**我很困惑如何真正制作它:(** 我认为我可以制作一个`Product`实体并制作其他**继承** `Product`的实体，如`Cpu`, `Hdd`, `Camera`, `PcCase`, `GraphicCard`,等`MobilePhone`，但我认为**这很愚蠢**，因为我可以用域中 有**200 多个实体**。 在这种情况下你会怎么做？ 如何阅读以及将这个**动态属性**放在哪里？ **更新 - 一些解决方案** 好吧，基于*@millimoose*的建议和*@Tim Schmelter*使用的想法`Gps`

 *********`Dictionary`*`DataTable`对象我来了一些解决方案。
现在......这工作我得到数据读取它们，我可以显示它们。
但是我仍然需要比我更聪明的人的建议，**我是否做得很好**，或者我应该更好地处理这个问题，或者我做了一些**spageti 代码**。所以在这里我做了什么：**********

 ******```
public class Product
    {
        public Product()
        {
            this.DynamicProperties = new List<Dictionary<string, string>>();
        }

        public List<Dictionary<string, string>> DynamicProperties { get; set; }

    }
...
List<Product> products = new List<Product>();
...
using (SqlDataAdapter a = new SqlDataAdapter(cmd))
                {
                    DataTable t = new DataTable();
                    a.Fill(t);

                    Product p = null;

                    foreach (DataRow row in t.Rows)
                    {
                        p = new Product();
                        foreach (DataColumn col in t.Columns)
                        {
                            string property = col.ColumnName.ToString();
                            string propertyValue = row[col.ColumnName].ToString();

                            Dictionary<string, string> dictionary = new Dictionary<string, string>();

                            dictionary.Add(property, propertyValue);

                            p.DynamicProperties.Add(dictionary);
                        }

                        products.Add(p);
                    }
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-01T11:23:23.570

你原来的方法

```
public class Product
{
    public List<Dictionary<string, string>> DynamicProperties { get; set; }
} 
```

相当不错。不过，我会使用自定义集合，名称更好，因此意图更清晰。

* * *

您还可以利用 C# 4.0 的*更酷*`dynamic`的功能，但我不确定它对您的情况有什么好处。你可以做类似的事情，

 *```
public class Product
{
    public List<dynamic> DynamicProperties { get; set; }
}

...

conn.Open();
using (var reader = cmd.ExecuteReader())
{
    var p = new Products();
    p.DynamicProperties = reader.AsDyamic().ToList();

    //or

    foreach (var item in reader.AsDynamic())
        yield return item;
}

// carry this extension method around
public static IEnumerable<dynamic> AsDynamic(this IDataReader reader)
{
    var names = Enumerable.Range(0, reader.FieldCount).Select(reader.GetName).ToList();
    foreach (IDataRecord record in reader as IEnumerable)
    {
        var expando = new ExpandoObject() as IDictionary<string, object>;
        foreach (var name in names)
            expando[name] = record[name];

        yield return expando;
    }
} 
```

有点相关的问题：[如何将数据阅读器转换为动态查询结果](https://stackoverflow.com/questions/31656938/how-to-convert-a-data-reader-to-dynamic-query-results)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:47:50.950

你有一个产品，一堆类别，每个类别都有一堆属性。

```
class Product
{
    public int Id { get; set; }
    public Category Category { get; set; }
    public List<ProductProperty> Properties { get; set; }
}

class Category
{
  public int Id { get; set; }
  public string Name { get; set; }
}

class ProductProperty
{
   public  int Id { get; set; }
   public  string Name { get; set; }
   public string Value { get; set; }
} 
```

您可以将产品属性存储在列表/字典中

然后您只需向产品添加属性

```
Properties.Add(new ProductionProperty() { Name="intel i7"}); 
```

或者如果它的名称/值

```
Properties.Add(new ProductionProperty() { Name="Speed", Value="150MB/s"}); 
```*******

# hadoop - 如何设置 Cloudera Hadoop 在 Ubuntu localhost 上运行？

> ID：15211438
> 
> 赞同：1
> 
> 时间：2013-03-04T21:25:35.803
> 
> 标签：hadoop, cloudera, cloudera-manager

我正在尝试在单个 Ubuntu localhost 上运行所有 Hadoop 服务器。所有端口都是打开的，我的 /etc/hosts 文件是

```
127.0.0.1   frigate frigate.domain.local    localhost
# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters 
```

**尝试安装集群 Cloudera 管理器失败并显示以下消息：**

```
Installation failed. Failed to receive heartbeat from agent.

Ensure that the host's hostname is configured properly.
Ensure that port 7182 is accessible on the Cloudera Manager server (check firewall rules).
Ensure that ports 9000 and 9001 are free on the host being added.
Check agent logs in /var/log/cloudera-scm-agent/ on the host being added (some of the logs can be found in the installation details). 
```

我从通过 Wifi/拨号调制解调器连接到我的提供商的家中运行我的 Ubuntu-12.04 节点。缺少什么配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:37:45.247

将您的 pc ip 添加到 /etc/hosts 文件中，例如

```
# IP pc_name
192.168.3.4 my_pc 
```

它将解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T10:40:20.733

这个配置对我来说没问题。希望有帮助。

```
127.0.0.1       localhost.localdomain localhost 
```

[https://groups.google.com/a/cloudera.org/forum/?fromgroups=#!msg/cdh-dev/9rczbLkAxlg/lF882T7ZyNoJ](https://groups.google.com/a/cloudera.org/forum/?fromgroups=#!msg/cdh-dev/9rczbLkAxlg/lF882T7ZyNoJ)

我的电脑：（ubuntu12.04.2 64bit vm）

# ios - 在页面视图控制器中以编程方式使用情节提要中的视图控制器

> ID：15211441
> 
> 赞同：23
> 
> 时间：2013-03-04T21:25:36.383
> 
> 标签：ios, objective-c, uipageviewcontroller

我有一个带有故事板的应用程序。我正在使用几个带有 segues 的视图控制器来根据所选项目从表视图中进行选择。我想要一个页面视图控制器，其中页面将是情节提要中的一个或多个视图控制器，甚至重复它们。我正在尝试这样`init`的页面视图控制器： .... self.dataSource=self;

```
UIViewController *initialViewController =[self viewControllerAtIndex:current];
NSArray *viewControllers = [NSArray arrayWithObject:initialViewController];

[self setViewControllers:viewControllers direction:UIPageViewControllerNavigationOrientationHorizontal  animated:NO completion:nil];
....

- (UIViewController *)viewControllerAtIndex:(NSUInteger)index
{
if ((descriptions.count == 0) ||
    (index >= descriptions.count)) {
    return nil;
}

current=index;

// Create a new view controller and pass suitable data.
NSString *language = [[NSLocale preferredLanguages] objectAtIndex:0];

Description *description=[DBCompany getDescriptionById:language descriptionId:[[descriptions objectAtIndex:index] integerValue]];

UIViewController *viewController=nil;
if(description.frame==100){
    viewController=[[Company100ViewController alloc] init];
    ((Company100ViewController*)viewController).companyId = companyId;
}
return viewController;
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController
{
if ((descriptions.count == 0) ||
    (current-1 < 0)) {
    return nil;
}

return [self viewControllerAtIndex:current-1];
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController
{
if ((descriptions.count == 0) ||
    (current >= descriptions.count)) {
    return nil;
}

return [self viewControllerAtIndex:current+1];
} 
```

然而，它`viewcontroller`以黑色显示。我认为是因为我正在添加`UIviewcontroller`类但没有将它连接到任何视图，XIB，在我的故事板的情况下。

如何以编程方式使用情节提要中的不同视图控制器在页面视图控制器中使用？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-05T01:56:28.860

如果您执行 viewController=[[Company100ViewController alloc] init] 那么是的，这不是与情节提要或 XIB 关联的控制器。要使用 XIB 加载控制器，您必须执行以下操作：

```
UIStoryboard *sb = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
Company100ViewController * vc = (Company100ViewController *)[sb instantiateViewControllerWithIdentifier:@"vc-identifier"]; 
```

在情节提要中，确保将视图控制器的 id 设置为 vc-identifier；您选择的任何标识符。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-08-07T14:18:03.473

**斯威夫特 3**

```
let sb = UIStoryboard(name: "MainStoryboard", bundle: nil)
let vc = sb.instantiateViewController(withIdentifier: "vc-identifier") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-22T08:56:53.557

**迅速**

如果你想从一个`UIViewController`对象初始化。

```
guard let vc = storyboard?.instantiateViewController(withIdentifier: "nameVC") else {
  return
}

// add to current view
view.addSubview(vc.view) 
```

# sed - 打印第一列并打印 % 符号后的所有内容

> ID：15211447
> 
> 赞同：1
> 
> 时间：2013-03-04T21:25:53.597
> 
> 标签：sed, awk

在这种情况下，我想打印第一列主机 IP 和`%`字符后的所有内容。

> 10.162.254.12 3558：003557：2013 年 3 月 4 日 12:13:28：%LINEPROTO-SP-5-UPDOWN：接口 GigabitEthernet8/37 上的线路协议，将状态更改为向上
> 192.50.0.14：2013 年 3 月 4 日 13:14:20 EST : %ETHPORT-5-IF_DOWN_LINK_FAILURE: 接口 Ethernet17/33 已关闭（链接失败）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:29:41.930

您有两个`%`字符并且没​​有指定是否应该打印第一个或最后一个之后的所有内容？这是两种使用方式`sed`：

```
# First field and everything after first %
$ sed 's/ [^%]*%/ /' file
10.162.254.12 LINEPROTO-SP-5-UPDOWN: Line protocol on Interface GigabitEthernet8/37, changed state to up 192.50.0.14 : 2013 Mar 4 13:14:20 EST: %ETHPORT-5-IF_DOWN_LINK_FAILURE: Interface Ethernet17/33 is down (Link failure)

# First field and everything after last % 
$ sed 's/ .*%/ /' file
10.162.254.12 ETHPORT-5-IF_DOWN_LINK_FAILURE: Interface Ethernet17/33 is down (Link failure) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:30:53.723

```
sed 's/\([^ ]*\)[^%]*%/\1 /' input 
```

# ios - UIImageView 在滚动之前不会加载到 UITableViewCell 中

> ID：15211451
> 
> 赞同：1
> 
> 时间：2013-03-04T21:25:57.693
> 
> 标签：ios, uitableview, uiimageview, uiimage

我有一个 UIImageView 的问题，我在**tableview 中设置：cellForRowAtIndexPath：**由于某种原因，当 UITableView 在视图中加载底部单元格时，没有像 UITableViewCells 的其余部分一样将图像加载到 UIImageView 中，但是一旦我滚动然后它会自行解决。但是一旦这样做，顶部的 UItableViewCell 就会丢弃它的图像！直到我将其滚动回完整视图。

我所做的是在 Interface Builder 中创建 UITableViewCell 并且我有一个空白的 UIImageView，然后我设置 UIImage 我要放置在 ViewDidLoad 中的 UIImageView 中，然后在 tableview:CellForRowAtIndexPath: 中设置它然后返回单元格。

这是代码

```
//.m
- (void)viewDidLoad
{
//..
storageCalcIconImage = [UIImage imageNamed:@"CALC.png"];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    SeriesSearchResultItem *myObj = [[SeriesSearchResultItem alloc] init];

    if (indexPath.section == 0) {

        //call obj array with all of the values from my sorting algorithum
        myObj = (SeriesSearchResultItem*)[dataArrayOfObjects objectAtIndex:indexPath.row];
//.. assinging storageCalcIconImage inside if statment
firstSpaceImage.image = storageCalcIconImage;
//..
}
    return cell;
} 
```

tableView:CellForRowAtIndexPath 发生了很多事情，但我决定放弃与图像问题无关的内容。希望你们能看到我正在犯的一个我还没有犯的错误......任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:39:29.737

这是在 tableView 中使用可重用单元格的预期结果。如果您想避免这种行为，您应该为 tableView 的每一行创建一个单元格，而不是使用`dequeueReusableCellWithIdentifier`. 如果您有很多行要显示，预计会有巨大的性能影响。

# javascript - d3.js replace circle with a foreignObject

> ID：15211454
> 
> 赞同：1
> 
> 时间：2013-03-04T21:26:06.070
> 
> 标签：javascript, d3.js, force-layout

i played with this example of a force directed graph layout. www.bl.ocks.org/GerHobbelt/3071239

or to manipulate directly, here with fiddle, [http://jsfiddle.net/BeSAb/](http://jsfiddle.net/BeSAb/)

what i want was to replace the circle element

```
 node = nodeg.selectAll("circle.node").data(net.nodes, nodeid);
  node.exit().remove();

  node.enter().append("circle")
      .attr("class", function(d) { return "node" + (d.size?"":" leaf"); })
      .attr("r", function(d) { return d.size ? d.size + dr : dr+1; })
      .attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; })
      .style("fill", function(d) { return fill(d.group); })
      .on("click", function(d) {
        console.log("node click", d, arguments, this, expand[d.group]);
        expand[d.group] = !expand[d.group];
    init();
      }); 
```

with a group (g) element that contains a svg foreignObject

```
node = nodeg.selectAll("g.node").data(net.nodes, nodeid);
node.exit().remove();

var nodeEnter = node.enter().append("foreignObject")
//simplified for this demo
        .attr("class", function(d) { return "node" + (d.size?"":" leaf"); })
        .attr('width', '22px')
        .attr('height', '22px')
        .attr('x', -11)
        .attr('y', -11)
        .append('xhtml:div')
            .style("background",function(d){return fill(d.group)})
            .style("width","20px")
            .style("height","20px")
            .style("padding","2px")
       .on("click", function(d) {
       console.log("node click", d, arguments, this, expand[d.group]);
       expand[d.group] = !expand[d.group];
       init();
       }); 
```

The Graph is build correct but if i try to expand a node by clicking it, it seems that the graph isn't updated. So that all old nodes are duplicated.

i make an other Fiddle where you can show this problem by clicking a node. [http://jsfiddle.net/xkV4b/](http://jsfiddle.net/xkV4b/)

does anyone know what i forgot, or what the issue is?

Thank you very much!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:54:20.100

Your enter append should probably match your selection on nodeg. But even then it appears that d3 has some trouble selecting 'foreignObject' things. That may be a question/issue to bring up on the [d3 google group](https://groups.google.com/forum/?fromgroups#!forum/d3-js) - it may be a bug.

However you can get around it by just selecting on the class. I updated the code to read:

```
node = nodeg.selectAll(".fo-node").data(net.nodes, nodeid);
node.exit().remove();

var nodeEnter = node.enter().append("foreignObject")
    .attr("class", function(d) { return "fo-node node" + (d.size?"":" leaf"); })
    .attr('width', '22px')
    ... 
```

Which seems to [work](http://jsfiddle.net/superboggly/7Suyj/).

# python - 为人人社交网络开发

> ID：15211459
> 
> 赞同：0
> 
> 时间：2013-03-04T21:26:45.310
> 
> 标签：python, api, rest

我有一个基于 Django 的 API 来与社交网络交互，我想与 RenRen 集成。

我的主要问题不是编程问题，而是如何为人人创建应用程序。我尝试使用谷歌翻译浏览网站[http://app.renren.com/](http://app.renren.com/)以提供帮助，但我无法创建应用程序。

我总是被重定向到页面以输入我的信息。我想知道是否需要输入我的所有个人信息并在创建应用程序之前对其进行验证。最重要的是，我不是中国国籍，所以我没有可以接受的身份证件。

任何有为人人开发经验的人都可以对如何创建应用程序有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T13:08:29.313

人人开发的最佳链接是：[http ://wiki.dev.renren.com/wiki/%E7%A7%BB%E5%8A%A8%E5%AE%A2%E6%88%B7%E7%AB %AF%E6%8E%A5%E5%85%A5](http://wiki.dev.renren.com/wiki/%E7%A7%BB%E5%8A%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8E%A5%E5%85%A5)

是的，人人需要开发者一个人人注册账号。但是，注册不需要身份证件，只需要用户名，电子邮件，密码。所以你创建一个人人应用应该没有问题。

与其他 API 服务一样，使用 Oauth 2.0 进行授权。人人开发文档不如 Google 或 Facebook 的文档好，但它确实有效。

# entity-framework - 通过实体框架映射嵌套类

> ID：15211460
> 
> 赞同：0
> 
> 时间：2013-03-04T21:26:48.010
> 
> 标签：entity-framework

我有这个定义的类：

```
public class WebSiteContent 
    {
        public Guid Id { get; set; }
        public About About { get; set; }
        public Tips Tips { get; set; }
        public Images Images { get; set; }
    } 
```

我的 About 和 Tips 和 Images 看起来像这样：

```
 public class About
    {
        public Guid Id { get; set; }
        public string Text { get; set; }
        public string Addres { get; set; }
        public int PhoneNumber { get; set; }
        public int Mobile { get; set; }
    } 
```

和提示：

```
 public class Tips
    {
        public Guid Guid { get; set; }
        public string Content { get; set; }
    } 
```

和图像：

```
public class Images
    {
        public Guid Id { get; set; }
        public string Background { get; set; }
        public string Logo { get; set; }
        public About About { get; set; }

    } 
```

在这里，我只想使用 about 和 Images and Tips 作为帮助类来创建一个属性，并且不想在数据库中拥有 about、Images 或 Tips 表！

实体框架需要 Id 来映射上述所有类，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T08:49:48.483

> 在这里，我只想使用 about 和 Images and Tips 作为帮助类来创建一个属性并且不想在数据库中拥有 about、Images 或 Tips 表

所以你正在寻找复杂的类型。`[ComplexType]`用属性标记您的 About、Tips 和 Images 类。

> 实体框架需要 Id 来映射上述所有类，我该怎么做？

EF 只需要实体的 ID。如果将它们映射为复杂类型，则不需要使用任何 Id。

顺便提一句。如果您根本不想在数据库中拥有这些类及其属性，则可以改用`[NotMapped]`属性。

# java - 在 JTable 中单击对我的图标的操作

> ID：15211461
> 
> 赞同：1
> 
> 时间：2013-03-04T21:26:49.907
> 
> 标签：java, swing, jtable, action, imageicon

我创建了类 ImageRenderer，它允许我在 JTable 图标 png 中显示，

当我单击 JTable 中的图标时，我想添加一个动作，

图像渲染器

```
import java.awt.Component;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JTable;
import javax.swing.table.DefaultTableCellRenderer;

class ImageRenderer extends DefaultTableCellRenderer {
      JLabel lbl = new JLabel();
      public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
        lbl.setIcon((ImageIcon)value);
        return lbl;

      }
    } 
```

和

```
ImageIcon icon = new ImageIcon("myicon.png");
tabla.setValueAt(icon, 0, 7);
jTable1.getColumn("Link").setCellRenderer(new ImageRenderer()); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:31:29.870

您必须在表格中添加一个鼠标侦听器，并让它使用`rowAtPoint()`and确定单击的单元格`columnAtPoint()`。

渲染器绘制的组件仅用作“橡皮图章”。它们不存在于组件层次结构中，因此不响应鼠标输入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T00:01:48.390

最简单的编码是 的实现`prepareRenderer`，例如

注意之前将所有图形对象准备为局部变量，不要，永远不要从文件加载图形，不要从 JDBC 流，因为 XxxRenderer 可以在每个鼠标和键事件上触发其事件

![在此处输入图像描述](../Images/0b506f0edfc71d22f8696634cbf2cfa8.png)![在此处输入图像描述](../Images/c6d26d6c9a73ca4cab4e772bfa447f4d.png)![在此处输入图像描述](../Images/23426f310f6eee3d25cc5f12c90d5291.png)

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Dimension;
import javax.swing.*;
import javax.swing.table.*;

public class TableIcon extends JFrame {

    private static final long serialVersionUID = 1L;
    private JFrame frame = new JFrame ();
    private JTable table;
    private JLabel myLabel = new JLabel("waiting");
    private int pHeight = 40;
    private ImageIcon errorIcon = (ImageIcon) UIManager.getIcon("OptionPane.errorIcon");
    private ImageIcon infoIcon = (ImageIcon) UIManager.getIcon("OptionPane.informationIcon");
    private ImageIcon warnIcon = (ImageIcon) UIManager.getIcon("OptionPane.warningIcon");
    private ImageIcon questIcon = (ImageIcon) UIManager.getIcon("OptionPane.questionIcon");

    public TableIcon() {
        String[] columnNames = {"Picture", "Description"};
        Object[][] data = {{errorIcon, "About"}, {errorIcon, "Add"}, {errorIcon, "Copy"}, {errorIcon, "Copy"}};
        DefaultTableModel model = new DefaultTableModel(data, columnNames);
        table = new JTable(model) {
            private static final long serialVersionUID = 1L;

            @Override
            public Class getColumnClass(int column) {
                return getValueAt(0, column).getClass();
            }

            @Override
            public Component prepareRenderer(TableCellRenderer renderer, int row, int column) {
                Component comp = super.prepareRenderer(renderer, row, column);
                JLabel jc = (JLabel) comp;
                if (column == 0) {
                    if (isRowSelected(row) && isColumnSelected(column)) {
                        jc.setIcon(infoIcon);
                    } else if (isRowSelected(row) && !isColumnSelected(column)) {
                        jc.setIcon(warnIcon);
                    } else {
                        jc.setIcon(jc.getIcon());
                    }
                }
                return comp;
            }
        };
        table.setRowHeight(pHeight);
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        JScrollPane scrollPane = new JScrollPane(table);
        frame.add(scrollPane, BorderLayout.CENTER);
        myLabel.setPreferredSize(new Dimension(200, pHeight));
        myLabel.setHorizontalAlignment(SwingConstants.CENTER);
        frame.add(myLabel, BorderLayout.SOUTH);
        frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        frame.setLocation(150, 150);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                TableIcon frame = new TableIcon();
            }
        }); 
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-15T21:02:25.897

它有一个简单的方法：

```
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.util.Vector;
import javax.imageio.ImageIO;
import javax.swing.*;
import javax.swing.table.DefaultTableModel;

public class ImageIconTable {

    private final int imageHeight = 200;//todo change to desire height
    private JTable table;

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new ImageIconTable().initGUI();
            }
        });
    }

    public void initGUI() {
        JFrame frame = new JFrame();

        ImageIcon icon1 = null;// new ImageIcon( "c://test1.gif"); //its not worked with gif
        ImageIcon icon2 = null;// new ImageIcon( "c://test2.jpg"); //it work with jpg

        try {
            BufferedImage bufferedImage1 = ImageIO.read(new File("c://test1.gif"));
            icon1 = new ImageIcon(bufferedImage1); //it work with all type images
            //todo scale imageHeight
            BufferedImage bufferedImage2 = ImageIO.read(new File("c://test2.jpg"));
            icon2 = new ImageIcon(bufferedImage2); //it work with all type images
        } catch (IOException e) {
            e.printStackTrace();
        }

       /*
       approach 1
       Object[] columnNames = {"name","picture"};
        Object[][] rowData = {{"me", icon1}
                        ,{"boss", icon2}};*/

        //approach 2
        Vector columnNames = new Vector();
        columnNames.add("name");
        columnNames.add("picture");

        Vector rowData = new Vector();
        Vector row1 = new Vector();
        Vector row2 = new Vector();
        row1.add("me");
        row1.add(icon1);
        row2.add("boss");
        row2.add(icon2);
        rowData.add(row1);
        rowData.add(row2);

        DefaultTableModel tableModel = new DefaultTableModel(rowData,columnNames) {
            @Override
            public Class getColumnClass(int column) {
                if (column == 1) return ImageIcon.class;
                return Object.class;
            }
        };

        table = new JTable(tableModel);
        table.setRowHeight(imageHeight);

        frame.add(new JScrollPane(table), BorderLayout.CENTER);
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

} 
```

# hibernate - 从数据库加载 joda LocalTime

> ID：15211462
> 
> 赞同：1
> 
> 时间：2013-03-04T21:26:56.280
> 
> 标签：hibernate, jodatime

我正在使用 Joda Time 和 Jadira 用户类型库将 Joda LocalTime 保存在我的数据库中。

这是我的实体

```
@Entity
public class Airport implements Serializable {

    private static final long serialVersionUID = 6382228467347085567L;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @Column(nullable = false)
    @NotNull
    private String nameOACI;

    @Column(nullable = false)
    @NotNull
    private String nameIATA;

    @Column(nullable = false)
    @NotNull
    private int ssliaLevel;

    @Column(nullable = true)
    @Type(type = "org.jadira.usertype.dateandtime.joda.PersistentLocalTime")
    private LocalTime openingTime;

    @Column(nullable = true)
    @Type(type = "org.jadira.usertype.dateandtime.joda.PersistentLocalTime")
    private LocalTime closingTime;

    @Column(nullable = false)
    @NotNull
    private String latitude;

    @Column(nullable = false)
    @NotNull
    private String longitude;

    @Column(nullable = false)
    @NotNull
    private int altitude;

    @Column(nullable = true)
    private String comments;

    @Column(nullable = false)
    @Enumerated(EnumType.STRING)
    private AirportCategoryE category;

    @Column(nullable = true)
    @NotNull
    @Type(type = "com.flightfaq.dao.converters.MinutesDaoConverter")
    private Minutes taxiTime;

    @Column(nullable = true)
    @NotNull
    @Type(type = "com.flightfaq.dao.converters.MinutesDaoConverter")
    private Minutes depTimeOffset;

    @Column(nullable = true)
    @NotNull
    @Type(type = "com.flightfaq.dao.converters.MinutesDaoConverter")
    private Minutes arrTimeOffset;

    @OneToMany(mappedBy = "airport", cascade = CascadeType.ALL)
    private List<Runway> runways;

    @OneToMany(mappedBy = "airport", cascade = CascadeType.ALL)
    private List<Fueler> fuelers;

    @OneToMany(mappedBy = "airport", cascade = CascadeType.ALL)
    private List<Handling> handlings;

    public Airport() {
        runways = new ArrayList<Runway>();
        fuelers = new ArrayList<Fueler>();
        handlings = new ArrayList<Handling>();
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getNameOACI() {
        return nameOACI;
    }

    public void setNameOACI(String nameOACI) {
        this.nameOACI = nameOACI;
    }

    public String getNameIATA() {
        return nameIATA;
    }

    public void setNameIATA(String nameIATA) {
        this.nameIATA = nameIATA;
    }

    public int getSsliaLevel() {
        return ssliaLevel;
    }

    public void setSsliaLevel(int ssliaLevel) {
        this.ssliaLevel = ssliaLevel;
    }

    public String getLatitude() {
        return latitude;
    }

    public void setLatitude(String latitude) {
        this.latitude = latitude;
    }

    public String getLongitude() {
        return longitude;
    }

    public void setLongitude(String longitude) {
        this.longitude = longitude;
    }

    public int getAltitude() {
        return altitude;
    }

    public void setAltitude(int altitude) {
        this.altitude = altitude;
    }

    public String getComments() {
        return comments;
    }

    public void setComments(String comments) {
        this.comments = comments;
    }

    public AirportCategoryE getCategory() {
        return category;
    }

    public void setCategory(AirportCategoryE category) {
        this.category = category;
    }

    public Minutes getTaxiTime() {
        return taxiTime;
    }

    public void setTaxiTime(Minutes taxiTime) {
        this.taxiTime = taxiTime;
    }

    public Minutes getDepTimeOffset() {
        return depTimeOffset;
    }

    public void setDepTimeOffset(Minutes depTimeOffset) {
        this.depTimeOffset = depTimeOffset;
    }

    public Minutes getArrTimeOffset() {
        return arrTimeOffset;
    }

    public void setArrTimeOffset(Minutes arrTimeOffset) {
        this.arrTimeOffset = arrTimeOffset;
    }

    public List<Runway> getRunways() {
        return runways;
    }

    public void setRunways(List<Runway> runways) {
        this.runways = runways;
    }

    public List<Fueler> getFuelers() {
        return fuelers;
    }

    public void setFuelers(List<Fueler> fuelers) {
        this.fuelers = fuelers;
    }

    public List<Handling> getHandlings() {
        return handlings;
    }

    public void setHandlings(List<Handling> handlings) {
        this.handlings = handlings;
    }

    public LocalTime getOpeningTime() {
        return openingTime;
    }

    public void setOpeningTime(LocalTime openingTime) {
        this.openingTime = openingTime;
    }

    public LocalTime getClosingTime() {
        return closingTime;
    }

    public void setClosingTime(LocalTime closingTime) {
        this.closingTime = closingTime;
    }

} 
```

这是我的道

```
@Singleton
@Startup
@LocalBean
public class AirportDaoImpl implements AirportDao {

    @PersistenceContext(unitName = "flightfaq")
    protected EntityManager em;

    /** JPQL query to find a {@link Airport} given its OACI name */
    private static final String JPQL_FIND_BY_NAME = "SELECT a FROM Airport a WHERE a.nameOACI=:nameOACI";

    @Override
    public Airport find(String nameOACI) throws DAOException {
        Airport airport = null;
        try {
            TypedQuery<Airport> findQuery = em.createQuery(JPQL_FIND_BY_NAME,
                    Airport.class).setParameter("nameOACI", nameOACI);
            airport = findQuery.getSingleResult();
        } catch (NoResultException e) {
            airport = null;
        } catch (Exception e) {
            throw new DAOException(e);
        }
        return airport;
    }

} 
```

问题是，当我使用有效名称调用 DAO 时，我得到了

```
4 mars 2013 21:21:46 org.jadira.usertype.spi.reflectionutils.JavaTimeZoneWorkaroundHelper <clinit>
ATTENTION: Under JDK 6 it may not be possible to handle DST transitions correctly
4 mars 2013 21:21:46 com.sun.faces.lifecycle.InvokeApplicationPhase execute
ATTENTION: #{missionHandler.generateMissionFeasability}: javax.ejb.EJBException: The bean encountered a non-application exception; nested exception is: 
    com.flightfaq.dao.DAOException: javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
javax.faces.FacesException: #{missionHandler.generateMissionFeasability}: javax.ejb.EJBException: The bean encountered a non-application exception; nested exception is: 
    com.flightfaq.dao.DAOException: javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:117)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:791)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1256)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.tomee.catalina.OpenEJBValve.invoke(OpenEJBValve.java:45)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
    at java.lang.Thread.run(Thread.java:680)
Caused by: javax.faces.el.EvaluationException: javax.ejb.EJBException: The bean encountered a non-application exception; nested exception is: 
    com.flightfaq.dao.DAOException: javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:101)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:101)
    ... 24 more
Caused by: javax.ejb.EJBException: The bean encountered a non-application exception; nested exception is: 
    com.flightfaq.dao.DAOException: javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
    at org.apache.openejb.core.ivm.BaseEjbProxyHandler.convertException(BaseEjbProxyHandler.java:363)
    at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:283)
    at sun.proxy.$Proxy127.find(Unknown Source)
    at com.flightfaq.beans.managed.MissionHandler.computeFlightTimes(MissionHandler.java:314)
    at com.flightfaq.beans.managed.MissionHandler.generateMissionFeasability(MissionHandler.java:212)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.el.parser.AstValue.invoke(AstValue.java:278)
    at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:274)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:87)
    ... 25 more
Caused by: com.flightfaq.dao.DAOException: javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
    at com.flightfaq.dao.impl.AirportDaoImpl.find(AirportDaoImpl.java:41)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.cdi.CdiInterceptor.invoke(CdiInterceptor.java:128)
    at org.apache.openejb.cdi.CdiInterceptor.access$000(CdiInterceptor.java:43)
    at org.apache.openejb.cdi.CdiInterceptor$1.call(CdiInterceptor.java:64)
    at org.apache.openejb.cdi.CdiInterceptor.aroundInvoke(CdiInterceptor.java:70)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.monitoring.StatsInterceptor.record(StatsInterceptor.java:176)
    at org.apache.openejb.monitoring.StatsInterceptor.invoke(StatsInterceptor.java:95)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.monitoring.StatsInterceptor.record(StatsInterceptor.java:176)
    at org.apache.openejb.monitoring.StatsInterceptor.invoke(StatsInterceptor.java:95)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.core.interceptor.InterceptorStack.invoke(InterceptorStack.java:138)
    at org.apache.openejb.core.singleton.SingletonContainer._invoke(SingletonContainer.java:244)
    at org.apache.openejb.core.singleton.SingletonContainer.invoke(SingletonContainer.java:211)
    at org.apache.openejb.core.ivm.EjbObjectProxyHandler.synchronizedBusinessMethod(EjbObjectProxyHandler.java:253)
    at org.apache.openejb.core.ivm.EjbObjectProxyHandler.businessMethod(EjbObjectProxyHandler.java:248)
    at org.apache.openejb.core.ivm.EjbObjectProxyHandler._invoke(EjbObjectProxyHandler.java:92)
    at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:279)
    ... 36 more
Caused by: javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1377)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1300)
    at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:273)
    at com.flightfaq.dao.impl.AirportDaoImpl.find(AirportDaoImpl.java:34)
    ... 75 more
Caused by: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime
    at org.hibernate.property.DirectPropertyAccessor$DirectSetter.set(DirectPropertyAccessor.java:151)
    at org.hibernate.tuple.entity.AbstractEntityTuplizer.setPropertyValues(AbstractEntityTuplizer.java:707)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.setPropertyValues(PojoEntityTuplizer.java:371)
    at org.hibernate.persister.entity.AbstractEntityPersister.setPropertyValues(AbstractEntityPersister.java:4463)
    at org.hibernate.engine.internal.TwoPhaseLoad.doInitializeEntity(TwoPhaseLoad.java:186)
    at org.hibernate.engine.internal.TwoPhaseLoad.initializeEntity(TwoPhaseLoad.java:134)
    at org.hibernate.loader.Loader.initializeEntitiesAndCollections(Loader.java:1103)
    at org.hibernate.loader.Loader.processResultSet(Loader.java:960)
    at org.hibernate.loader.Loader.doQuery(Loader.java:910)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:341)
    at org.hibernate.loader.Loader.doList(Loader.java:2516)
    at org.hibernate.loader.Loader.doList(Loader.java:2502)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2332)
    at org.hibernate.loader.Loader.list(Loader.java:2327)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:490)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:355)
    at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:195)
    at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1247)
    at org.hibernate.internal.QueryImpl.list(QueryImpl.java:101)
    at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:264)
    ... 76 more
Caused by: java.lang.IllegalArgumentException: Can not set org.joda.time.LocalTime field com.flightfaq.beans.business.Airport.closingTime to org.joda.time.LocalTime
    at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:146)
    at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:150)
    at sun.reflect.UnsafeObjectFieldAccessorImpl.set(UnsafeObjectFieldAccessorImpl.java:63)
    at java.lang.reflect.Field.set(Field.java:657)
    at org.hibernate.property.DirectPropertyAccessor$DirectSetter.set(DirectPropertyAccessor.java:139)
    ... 95 more 
```

正如您在堆栈末尾看到的那样，有

```
Caused by: org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.flightfaq.beans.business.Airport.closingTime 
```

但是也

```
Can not set org.joda.time.LocalTime field com.flightfaq.beans.business.Airport.closingTime to org.joda.time.LocalTime 
```

这是我用来在数据库中输入有问题的机场的 SQL 命令

```
INSERT INTO `Airport` (`id`, `altitude`, `arrTimeOffset`, `category`, `closingTime`, `comments`, `depTimeOffset`, `latitude`, `longitude`, `nameIATA`, `nameOACI`, `openingTime`, `ssliaLevel`, `taxiTime`) VALUES
(1, 499, '0', 'A', '00:00:00', 'se garer au parking R12', '15', '433806N', '0012204E', 'TLS', 'LFBO', '00:00:00', 4, '0'); 
```

我输入了“00:00:00”作为关闭时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T09:30:30.147

您`closingTime`应该输入`time`数据库。
如果你想`varchar[]`在数据库中使用类型，那么你应该使用你自己的用户类型

它应该看起来像

```
public class LocalTimeType implements UserType {
    public int[] sqlTypes() {
        return new int[] {
                Types.VARCHAR,
        };
    }

    public Class getReturnedClass() {
        return LocalTime.class;
    }

    public Object nullSafeGet(ResultSet rs, String[] names, Object owner) throws SQLException {
       ...
    }

    public void nullSafeSet(PreparedStatement st, Object value, int index) throws SQLException {
      ...
    }

    ...
} 
```

# c++ - 为什么不是 common_type ::type = long long?

> ID：15211463
> 
> 赞同：20
> 
> 时间：2013-03-04T21:26:59.813
> 
> 标签：c++, language-lawyer, integer-promotion

`common_type<long, unsigned long>::type`是`unsigned long`因为关于积分提升后的操作数标准说...

> [...]如果具有无符号整数类型的操作数的等级大于或等于另一个操作数类型的等级，则具有符号整数类型的操作数应转换为具有无符号整数类型的操作数的类型

不要称积分提升系统有问题，但似乎如果有一个更大的有符号整数类型可以表示有符号和无符号操作数的范围，则应该使用它。

我知道有些平台可能有 long == long long，在这种情况下，上面的规则可以生效。但是如果有*更大*的有符号整数类型可用，不应该使用它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T15:04:39.213

首先，std::common_type（当然还有 boost::type_traits::common_type）使用三元运算符来检索类型结果。在这种情况下，相关报价来自[CppReference](http://en.cppreference.com/w/cpp/language/operator_other) , 6b)

> E2 和 E3 具有算术或枚举类型：应用通常的算术转换将它们带入公共类型，该类型就是结果。

有了这些信息，我们可以在[c++ 标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3242.pdf)，5p10，第 88 页中找到*常用算术转换的规则。*

> — 否则，如果无符号整数类型的操作数的秩大于或等于另一个操作数类型的秩，则将有符号整数类型的操作数转换为无符号整数类型的操作数的类型。

所以基本上你的问题的答案是：*......因为标准是这样说的。*

但您并不是唯一一个发现这种行为出乎意料的人。这是一个可以尝试的快速运行示例：

```
#include <iostream>
#include <typeinfo>
#include <type_traits>

int main(int argc, const char* argv[])
{

    std::cout << typeid(std::common_type<char, unsigned char>::type).name() << std::endl;
    // I would expect "short", and the result is "int", ok so far.

    std::cout << typeid(std::common_type<short, unsigned short>::type).name() << std::endl;
    // I would expect "int", and the result is "int", yay.

    std::cout << typeid(std::common_type<int, unsigned int>::type).name() << std::endl;
    // I would expect "long", but the result is "unsigned int"

    std::cout << typeid(std::common_type<long, unsigned long>::type).name() << std::endl;
    // I would expect "long long", but the result is "unsigned long"

    // So this usual arithmetic conversion can lead to unexpected behavior:
    auto var_auto = true ? var_i : var_ui;
    std::cout << typeid(var_auto).name() << std::endl;   // unsigned int
    std::cout << var_auto << std::endl;                  // 4294967173

    return 0;
} 
```

但是当前的行为是一个问题是[已知](https://groups.google.com/a/isocpp.org/d/topic/std-discussion/EiHc7W3P2UY/discussion)的，并且存在消除一些意外的[提议。](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3387.html)

-汉内斯

# c# - 在 C# 中使用 COM 端口而不获取所有发送的数据

> ID：15211469
> 
> 赞同：1
> 
> 时间：2013-03-04T21:27:08.983
> 
> 标签：c#, .net-3.5, serial-port

只是为了解释一下，我有一个开发板，根据命令，射出 4 个字符（字节）。我用来调试的终端程序（RealTerm）看到所有 4 个字节。我现在开始编写桌面软件，我的程序只关注发送的 4 个字节中的 1 个。澄清一下，我不知道 4 个字节中的哪一个（第一个、最后一个、中间两个），但我可以确定它是否真的有必要。

起初我认为 SerialPort.DataReceived 事件会为接收到的每个字节触发。这不是真的，我不知道是什么导致它触发，但它不是接收单个字节。

所以我尝试遍历 SerialPort.BytesToRead，但这也只获取第一个字节，即使它识别出有 3 个字节要读取（为什么不是 4 个？？）

在它到达端口的确切时间接收这些数据对我来说并不重要，但显然我不想丢失 3/4 的数据。但是它不会总是 4 个字节，这就是它现在所做的。我只想获取所有准备好读取的字节。

事件处理程序：

```
private void comPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
        {
            while (comPort.BytesToRead > 0)
            {
                RxString = comPort.ReadExisting();
                RxByte = comPort.ReadByte(); 
                byte[] myByte = new byte[6];

                for (int i = 0; i < 6; i++)
                {
                    myByte[i] = 0000000;
                }

                comPort.Read(myByte, 0, comPort.BytesToRead);
                for (int i=0;i<6;i++)
                {
                    if (myByte[i] != null)
                    {
                        thisBytes.Add(myByte[i]);
                    }
                }
                RxString = RxByte + "";
                try
                {
                    this.Invoke(new EventHandler(dealWithByte));
                }
                catch
                {

                }
            }
        }

private void dealWithByte(object sender, EventArgs e)
        {
            foreach (byte item in thisBytes)
            {
                RxByte = Convert.ToInt16(item);
                string binary = Convert.ToString(RxByte, 2).PadLeft(8, '0');
                //processTime(binary);
            }
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:59:10.443

我不是 C# 人，但代码很简单，伪代码

```
 numBytes As Int = SerialPort1.BytesToRead 'get # of bytes available
    buf(numBytes - 1) As Byte 'allocate a buffer
    br As Int = SerialPort1.Read(buf, 0, numBytes) 'read the bytes
    If br <> numBytes {
        Resize(buf, br) 'resize the buffer
    } 
```

此时将字节存储到列表中。然后可以针对消息处理该列表。

# javascript - 为什么有些浏览器在没有 opener 对象的情况下声明了一个 opener 对象？

> ID：15211471
> 
> 赞同：2
> 
> 时间：2013-03-04T21:27:20.837
> 
> 标签：javascript, internet-explorer, google-chrome, firefox, opera

```
typeof(opener) 
```

在除 IE 之外的所有浏览器中产生“对象”，尽管对象为空。IE 仅在实际使用 window.open 或类似方法时才会这样做。我不想这样想，但 IE 是唯一能做到这一点的浏览器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:34:07.127

> *“为什么有些浏览器在没有打开器对象的情况下声明一个？”*

在 JavaScript 中，`typeof null === "object"`

代替`typeof`，使用直接`===`比较。

```
opener === null; // true 
```

如果 IE 是给你`undefined`的，那么使用`==`来测试两者。

```
opener == null; // true if null or undefined 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:34:20.830

*   `window.opener`一片空白。
*   `null`是导致对象带有 的原始类型之一`typeof`。

控制台输出 Chrome：

```
> window.opener
    null
> typeof null
    "object"
> typeof window.opener
    "object" 
```

控制台输出 IE9：

```
>> window.opener 
>> typeof window.opener 
"undefined" 
```

所以看起来 Chrome/Firefox 将它初始化为 null 并且 IE 没有定义它开始。但是，当您进行真实检查时，这并不重要，因为 null 和 undefined 将评估为 false。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-04T21:45:45.700

与其他浏览器相比，Internet Explorer 做的很多事情都不同。这只是一个小例子。

好的、跨平台的 JavaScript 将需要有许多 If-then-else 分支的实例（或作为替代的 try-catch）来处理这些差异。

# mysql - 分组最大值

> ID：15211479
> 
> 赞同：9
> 
> 时间：2013-03-04T21:27:56.653
> 
> 标签：mysql, sql

我有一个表，我试图从中检索每种证券的最新位置：

桌子：

我创建表的查询：`SELECT id, security, buy_date FROM positions WHERE client_id = 4`

```
+-------+----------+------------+
| id    | security | buy_date   |
+-------+----------+------------+
|    26 | PCS      | 2012-02-08 |
|    27 | PCS      | 2013-01-19 |
|    28 | RDN      | 2012-04-17 |
|    29 | RDN      | 2012-05-19 |
|    30 | RDN      | 2012-08-18 |
|    31 | RDN      | 2012-09-19 |
|    32 | HK       | 2012-09-25 |
|    33 | HK       | 2012-11-13 |
|    34 | HK       | 2013-01-19 |
|    35 | SGI      | 2013-01-17 |
|    36 | SGI      | 2013-02-16 |
| 18084 | KERX     | 2013-02-20 |
| 18249 | KERX     | 0000-00-00 |
+-------+----------+------------+ 
```

我一直在搞乱基于[此页面](http://dev.mysql.com/doc/refman/5.0/en/example-maximum-column-group-row.html)的查询版本，但我似乎无法得到我正在寻找的结果。

这是我一直在尝试的：

```
SELECT t1.id, t1.security, t1.buy_date 
FROM positions t1
WHERE buy_date = (SELECT MAX(t2.buy_date)
                    FROM positions t2
                    WHERE t1.security = t2.security) 
```

但这只是回报我：

```
+-------+----------+------------+
| id    | security | buy_date   |
+-------+----------+------------+
|    27 | PCS      | 2013-01-19 |
+-------+----------+------------+ 
```

我正在尝试获取每种证券的最大/最新购买日期，因此每个证券的结果将具有最近购买日期的一行。任何帮助是极大的赞赏。

编辑：位置的 id 必须与最大购买日期一起返回。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-04-25T06:36:34.597

您可以使用此查询。您可以在 75% 的时间内取得成果。我检查了更多的数据集。子查询需要更多时间。

```
SELECT p1.id, 
       p1.security, 
       p1.buy_date 
       FROM positions p1
left join
            positions p2
                on p1.security = p2.security
                   and p1.buy_date < p2.buy_date
      where 
      p2.id is null; 
```

SQL-小提琴[链接](http://sqlfiddle.com/#!2/a7e00/21)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-04T21:39:04.413

您可以使用子查询来获取结果：

```
SELECT p1.id, 
  p1.security, 
  p1.buy_date 
FROM positions p1
inner join
(
  SELECT MAX(buy_date) MaxDate, security
  FROM positions 
  group by security
) p2
  on p1.buy_date = p2.MaxDate
  and p1.security = p2.security 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/a7e00/7)

`WHERE`或者您可以在子句中使用以下内容：

```
SELECT t1.id, t1.security, t1.buy_date 
FROM positions t1
WHERE buy_date = (SELECT MAX(t2.buy_date)
                  FROM positions t2
                  WHERE t1.security = t2.security
                  group by t2.security) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/a7e00/5)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-04T21:31:39.680

这是通过一个简单的 group by 完成的。您想按证券分组并获得buy_date 的最大值。SQL：

```
SELECT security, max(buy_date) 
from positions
group by security 
```

请注意，这比[bluefeet 的答案](https://stackoverflow.com/a/15211634/215752)要快，但不显示 ID。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-04T23:51:34.547

@bluefeet 的答案还有两种方法可以获得您想要的结果 - 第一种可能比您的查询更有效。

我不明白的是为什么你说你的查询不起作用。它看起来很不错，并返回了预期的结果。在**[SQL-Fiddle测试](http://sqlfiddle.com/#!2/a7e00/12)**

```
SELECT t1.id, t1.security, t1.buy_date 
FROM positions t1
WHERE buy_date = ( SELECT MAX(t2.buy_date)
                   FROM positions t2
                   WHERE t1.security = t2.security ) ; 
```

如果添加`client_id = 4`条件时出现问题，那是因为您只在一个`WHERE`子句中添加它，而您必须在两个子句中添加它：

```
SELECT t1.id, t1.security, t1.buy_date 
FROM positions t1
WHERE client_id = 4
  AND buy_date = ( SELECT MAX(t2.buy_date)
                   FROM positions t2
                   WHERE client_id = 4
                     AND t1.security = t2.security ) ; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T21:29:53.033

```
select security, max(buy_date) group by security from positions; 
```

是您获得每种证券的最大购买日期所需的全部内容（当您大声说出您想要从查询中得到什么并包含短语“for each x”时，您可能想要在 x 上进行分组）

当您使用 a`group by`时，您的选择中的所有列必须是已分组或聚合的列，因此，例如，如果您想包含 id，您可能必须使用与之前类似的子查询，因为似乎没有任何聚合可以合理地用于 id，而另一个 group by 会给你太多行。

# string - 在 D3 中用逗号格式化数字

> ID：15211488
> 
> 赞同：18
> 
> 时间：2013-03-04T21:28:39.823
> 
> 标签：string, formatting, d3.js

当我使用 D3 创建图表时，轴标签中有逗号来分隔数千、数百万等。

是否有一个 D3 函数，我可以调用它传递一个数字并返回一个用逗号格式化的字符串，就像在轴中使用的那样？它相当于这个 C#: `x.ToString("0,000")`。

我知道存在这样的格式化库，但我想避免包含其他库。我已经在使用 D3，所以如果那里有一个 API，我可以使用它会很棒。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2016-07-27T13:51:50.477

执行此操作的语法在 d3 v4 中变得更加严格，但看起来像：

```
format = d3.format(",");
formattedX = format(x); 
```

[D3 格式化文档](https://github.com/d3/d3-format/blob/master/README.md#format)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-04T21:31:09.743

在文档中快速搜索发现它：

```
format = d3.format("0,000");
formattedX = format(x); 
```

[https://github.com/mbostock/d3/wiki/Formatting#wiki-d3_format](https://github.com/mbostock/d3/wiki/Formatting#wiki-d3_format)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-07-30T05:27:23.657

为了避免您阅读@altocumulus 的评论，这是正确的答案：

`let format = d3.format(','); let formattedX = format(x);`

从[文档](https://github.com/d3/d3-format#locale_format)：

> 逗号 ( `,`) 选项允许使用组分隔符，例如表示千位的逗号。

（@altocumulus 获得了所有功劳。）

# regex - 如何省略包含 Unicode NULL (U+0000) 的行？

> ID：15211489
> 
> 赞同：1
> 
> 时间：2013-03-04T21:28:43.557
> 
> 标签：regex, perl, unicode, null, nul

我正在阅读一个文件，并且想知道如何跳过具有 Unicode NULL, [U+0000](http://www.fileformat.info/info/unicode/char/0000/index.htm)的行？我已经尝试了以下所有方法，但没有一个有效：

*   `if($line)`
*   `chomp($line)`
*   `$line =~ s/\s*$//g;`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:33:19.480

您的“一切”列表似乎不包括明显的`$line =~ m/\000/`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T22:04:41.513

Perl 字符串可以包含任意数据，包括 NUL 字符。您`if`只检查真假（其中`""`和`"0"`是两个假字符串，其他一切都为真，包括包含单个 NUL“\x00”的字符串）。您`chomp`只删除行分隔符，而不是 NUL。NUL 字符不是空格，因此不匹配`\s`。

`"\000"`您可以通过使用八进制或十六进制表示法（或`"\x00"`分别）在正则表达式中指定它来显式匹配 NUL 字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T22:29:54.797

因为您询问了 Unicode NULL（在[UTF-8](https://en.wikipedia.org/wiki/UTF-8)编码时与 ASCII NUL 相同），所以让我们使用[perlunicode 文档](http://perldoc.perl.org/perlunicode.html#Effects-of-Character-Semantics)`\N{U+...}`中描述的形式。

> Unicode 字符也可以通过使用`\N{U+...}`符号添加到字符串中。所需字符的 Unicode 代码（十六进制）应放在大括号中，位于`U`. 例如，笑脸是`\N{U+263A}`。

您也可以在正则表达式中进行匹配`\N{U+...}`。见下文。

```
#! /usr/bin/env perl

use strict;
use warnings;

my $contents =
  "line 1\n" .
  "\N{U+0000}\n" .
  "foo\N{U+0000}bar\n" .
  "baz\N{U+0000}\n" .
  "\N{U+0000}quux\n" .
  "last\n";

open my $fh, "<", \$contents or die "$0: open: $!";

while (defined(my $line = <$fh>)) {
  next if $line =~ /\N{U+0000}/;
  print $line;
} 
```

输出：

```
$ ./filter-nulls
1号线
最后的
```

# paypal - PayPal 交易搜索 API 不返回任何结果

> ID：15211490
> 
> 赞同：0
> 
> 时间：2013-03-04T21:28:54.893
> 
> 标签：paypal

我从 java 调用 PayPal API 交易搜索 [SOAP] 并没有得到任何结果。
这是我的搜索参数
交易开始日期：- 2012 年 3 月 4 日
InvoiceId：- '1000010'
但是响应是成功的，但没有付款交易。我检查了一下，这笔款项存在于我的帐户 [今天创建] 中。详细信息：
1）sdk jar 文件：“merchant-java-sdk-1.2.95.jar”

```
2) Related properties/configuration file values. 
service.Binding=SOAP
service.RedirectURL=https://www.sandbox.paypal.com/webscr&cmd=
service.DevCentralURL=https://developer.paypal.com

service.EndPoint.PayPalAPI=https://api-3t.sandbox.paypal.com/2.0
service.EndPoint.PayPalAPIAA=https://api-3t.sandbox.paypal.com/2.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T23:09:44.957

如果您当前指向沙盒，则在通过发票 ID 进行搜索时，存在阻止 TransactionSearch API 正常工作的问题。例如，如果您仅根据开始日期进行搜索，您应该会返回结果。

# google-chrome-extension - 内联安装后如何强制加载 Chrome 扩展程序

> ID：15211498
> 
> 赞同：2
> 
> 时间：2013-03-04T21:29:31.883
> 
> 标签：google-chrome-extension

我有一个网站，其中包含 Chrome 扩展的内联安装。

问题是，一旦安装了扩展程序，它就不会在我的网站上起作用，直到用户刷新页面。有没有办法在现有页面上加载扩展而不刷新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T11:22:35.513

我认为你不能在安装后不重新加载现有页面的情况下加载你的扩展。

所以我想，尝试使用`chrome.webstore.install(url, successCallback, failureCallback)`

并调用`location.reload()`suncessCallback 函数。

# c# - 告诉 WPF 评估绑定

> ID：15211502
> 
> 赞同：1
> 
> 时间：2013-03-04T21:29:50.587
> 
> 标签：c#, .net, wpf, binding

假设我有一个命令的执行方法，如下所示：

```
 private void Execute()
    {
        // Bound to a wait indicator in the UI
        Searching = true;

        // Do some long running process
        Thread.Sleep(2000);

        Searching = false;
    } 
```

当 Searching 设置为 True 时，它​​所绑定的 UI 元素将不会更新（即使 Searching 发送 OnPropertyChanged 调用）。

但是，一旦 Thread.Sleep 完成，UI 就会处理我的更改并显示 Searching 绑定到的等待指示器。

现在，我知道传统智慧是对长时间运行的进程（Thread.Sleep）的调用是异步的。

但是假设我没有使用异步库，**有没有办法指示 WPF 现在对搜索执行绑定？**

像这样的东西：

```
 private void Execute()
    {
        // Bound to a wait indicator in the UI
        Searching = true;

        // MADE UP CODE
        Binding.UpdateBindingNow("Searching");
        // END MADE UP CODE

        // Do some long running process
        Thread.Sleep(2000);

        Searching = false;
    } 
```

更新：我尝试过的：

*   使用 Dispatcher 尝试分别将命令发送到 UI。
*   我还尝试了具有高优先级的调度程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T21:33:35.717

您需要将您的工作推入后台线程。在 UI 线程可以处理消息之前，绑定不会更新，这在您的操作完成之前不会发生。

异步是一种方法，但更经典的方法是仅用于[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)执行此操作，所有版本的 WPF 都支持该方法。

如果您使用的是 .NET 4，您也可以通过 TPL 执行此操作：

```
private void Execute()
{
    // Bound to a wait indicator in the UI
    Searching = true;

    Task.Factory.StartNew( () => { 
        // Do long running work... 
    }).ContinueWith(t =>
    {
        // You can do work here, including touching UI controls/collections/etc
        Searching = false;
    }, TaskScheduler.FromCurrentSynchronizationContext());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:42:07.137

我同意其他人的观点，将长时间运行的进程转移到后台/异步操作是最好的方法。既是因为您的 UI 不会为用户冻结，也因为您所做的任何事情（刷新绑定等）实际上都不会在长时间运行的进程工作时反映在 UI 中，因为 UI 线程将被阻塞。

也就是说，您的问题是您能否强制绑定从代码中评估/刷新，答案是肯定的。您可以通过调用以下代码来完成`UpdateTarget`此操作`BindingExpression`：

```
labelTextBlock.GetBindingExpression(TextBlock.TextProperty).UpdateTarget(); 
```

还有一种`UpdateSource`方法`BindingExpression`可以以几乎相同的方式使用，只影响源而不是目标。

同样，如果您的 UI 线程被阻塞，它可能无法完成您所希望的，但这就是您将强制绑定重新评估的方式。

# powershell - 使用 PowerShell 从 CSV 中剖析文本

> ID：15211506
> 
> 赞同：1
> 
> 时间：2013-03-04T21:29:59.353
> 
> 标签：powershell, csv, split

我已经在网上搜索了我的问题的以下解决方案...我目前有 csv 格式的文本，我需要将其分成几列，如下所示

```
Task ID,Task Name,Project                   
2,2 - CR04AW212 Warehouse,2 Crown Castle International : 001586 2013 ALU Phase 3 Sprint Crown : 001623 CR04AW212 ALU Sprint                 
10,10 - CR04AW090 Tower Punch,24 Alcatel Lucent : 001713 2013 ALU AAV : 001752 CR04AW090 ALU AAV 
```

我需要翻译\分解成几列拉开文本，如下所示

```
Task ID,Task Name,Customer ID,Customer Name,Parent Project ID,Parent Project Name,Child Project ID,Child Project Name
2,CR04AW212 Warehouse,2,Crown Castle International,001586,2013 ALU Phase 3 Sprint Crown 001623,CR04AW212 ALU Sprint
10,CR04AW090 Tower Punch,24,Alcatel Lucent,001713,2013 ALU AAV,001752,CR04AW090 ALU AAV 
```

任务 ID 号在任务名称中再次出现重复。我想从名称中删除该数字，如第二张图片所示

Project 列实质上包含分成 6 列所需的所有数据。我相信必须有一种以编程方式选择文本的方法。我将一次一点地进入它。“客户 ID”列应包含“项目列”中第一个空格之前的数字。这可以由一位数或两位数组成。无论如何，该数字应始终存在于“项目”中的第一个空格之前。作为一个明显的新手，我能够使用 -split 参数来完成它

@{Name="客户 ID";Expression={($_.Project -split ' ')[0]}}。

现在我必须选择以下文本“客户名称”，该文本将始终存在于第一个空格之后和“：”之前。

此示例再持续 2 次。“父项目 ID”和“子项目 ID”是固定的 6 位数字。每个 ID 后面的文本表示为该项目的名称。

这是我的谷歌搜索已经用尽的地方

我很抱歉没有上传图片，我刚刚注册了 StackOverflow 直到我有足够的信誉才允许我这样做:)

编辑：如何在第一场比赛后退出？

```
Add-Member -PassThru NoteProperty 'Task Name' -Value ($_.'Task Name' -replace '\d+ - ') 
```

此刻如果我有

```
1,1 - JA03MR008 - Civil,9 New Tech Construction Corp. : 001583 2013 Panhandle : 001810 JA03MR008" 
```

当我想删除“任务名称”中的第一个匹配项时，它会导致删除所有匹配项

> 任务 ID：1
> 任务名称：JA03MRCivil
> 客户 ID：9
> 客户名称：New Tech Construction Corp.
> 父项目 ID：001583
> 父项目名称：2013 Panhandle
> 子项目 ID：001810
> 子项目名称：JA03MR008

为此，我参加了 REGEX 速成课程，我认为这对我的目的最有效。请参阅下面的代码。它似乎工作得很好。以这种方式使用它有什么警告吗？提前致谢

```
Add-Member -PassThru NoteProperty 'Task Name' -Value ($_.'Task Name' -replace '^([^-]*) - ') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:20:18.877

可能有很多方法可以给这只猫换皮，我建议使用正则表达式来处理输入对象的 Project 属性：

```
@"
Task ID,Task Name,Project
2,2 - CR04AW212 Warehouse,2 Crown Castle International : 001586 2013 ALU Phase 3 Sprint Crown : 001623 CR04AW212 ALU Sprint
10,10 - CR04AW090 Tower Punch,24 Alcatel Lucent : 001713 2013 ALU AAV : 001752 CR04AW090 ALU AAV
"@ | ConvertFrom-Csv | ForEach-Object {
    if ($_.Project -match '(\d+) ([^:]+) : (\d+) ([^:]+) (: (\d+) (.*))?') {
        $_ | select 'Task ID' |
            Add-Member -PassThru NoteProperty 'Task Name' -Value ($_.'Task Name' -replace '\d+ - ') |
            Add-Member -PassThru NoteProperty 'Customer ID' -Value $Matches[1]                      |
            Add-Member -PassThru NoteProperty 'Customer Name' -Value $Matches[2]                    |
            Add-Member -PassThru NoteProperty 'Parent Project ID' -Value $Matches[3]                |
            Add-Member -PassThru NoteProperty 'Parent Project Name' -Value $Matches[4]              |
            Add-Member -PassThru NoteProperty 'Child Project ID' -Value $Matches[6]                 |
            Add-Member -PassThru NoteProperty 'Child Project Name' -Value $Matches[7]

    }
} 
```

这可能需要在这里和那里进行一些抛光。例如，您可以使用 select-object + hashtables 而不是 Add-Member。在 v3 中会容易得多，但我认为这必须与 v2 兼容，因此不使用 v3 代码。

**编辑：** 用没有子项目时能够处理选项的代码更新了代码，新的正则表达式：

```
 '(\d+) ([^:]+) : (\d+) ([^:]+) (: (\d+) (.*))?' 
```

它正在制作最后两部分：`: (\d+)`和`(.*)`可选：`(pattern)?` $Matches[5] 将是空白，或者将包含可选组，因此您需要将子项目属性的索引更改为 6 和 7。

# c++ - atoi() 方法，char * cout

> ID：15211507
> 
> 赞同：1
> 
> 时间：2013-03-04T21:30:03.997
> 
> 标签：c++, char, infinite-loop, cout

这是`atoi()`我试图理解的。为了使用不存在的库进行编译，我将其命名为`m()`.

我对几行代码感到困惑，主要是`char *`问题。

我的问题列在**代码**之后：

```
#include "stdafx.h"
#include <iostream>

using namespace std;

int m( char* pStr ) {   
    int iRetVal = 0;   
    int iTens = 1;   
    cout << "* pStr: " << * pStr << endl;   // line 1
    if ( pStr )  {    
        char* pCur = pStr;  
        cout << "* pCur: " << * pCur << endl;
        while (*pCur)  {     
            //cout << "* pCur: " << * pCur << endl; //line 2
            pCur++;   }
        cout << "pCur: " << pCur << endl;       //line 3
        cout << "* pCur: " << * pCur << endl;   //line 4
        pCur--;     
        cout << "pCur: " << pCur << endl;       //line 5
        while ( pCur >= pStr && *pCur <= '9' && *pCur >= '0' )     {       
            iRetVal += ((*pCur - '0') * iTens);      
            pCur--;       
            iTens *= 10;     }  }   
    return iRetVal; } 

int main(int argc, char * argv[])
{
    int i = m("242");
    cout << i << endl;
    return 0;
} 
```

**输出：**

```
* pStr: 2
* pCur: 2
pCur:
* pCur:
pCur: 2
242 
```

**问题**：

> **第 1 行：**为什么 cout 是 2？*`pStr`是作为指向`char`242 的指针传入的，不应该是 242 吗？
> **第 2 行：**我必须注释掉它，`cout`因为它看起来像是处于无限循环中。这`while (*pCur)`是什么意思？为什么我们需要这个循环？
> **第 3 行：**为什么它不打印任何内容？
> **第 4 行：**为什么它不打印任何内容？
> **第 5 行：**为什么它减少后现在打印出 2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:34:45.880

要理解为什么会发生这种情况，您需要了解字符串在 C++ 中是如何工作的，实际上，字符数组是如何工作的。字符串实际上只是一个字符数组，以空字符（值 0，而不是数字 0）结尾。我们通过指向数组中的第一个字符来传递这个字符串。当我们希望打印字符串时，我们只需打印指向的字符，增加指针，然后继续，直到我们到达空字符。

**第 1 行**：您取消引用指针，它实际上是一个指向字符数组的指针。所以指针指向第一个字符。它看起来像这样：

```
char 1: 2 <-- The pointer points to this  
char 2: 4  
char 3: 2  
char 4: \0 (null byte) 
```

通过在指针前面加上`*`您检索它所指向的值，即字符 2。

**第 2 行**：正如我在第 1 行中提到的，`*ptr`实际上是指向的字符的值，所以`while (*ptr)`只要指向的字符`ptr`不为 0，就会继续。通过增加`ptr`我们增加指针并在某个点到达空字节。

```
char 1: 2
char 2: 4  
char 3: 2  
char 4: \0 (null byte) <-- After the loop, this is what we point at 
```

**第 3 行**：这不是一个无限循环，您检查指向的 char 的值，如果它不为 0，则增加指针。这本质上就是迭代字符串字符的方式。对于每次迭代，您将打印出指向的字符（正如您 commted 部分所做的那样），并增加指针，直到到达空字符。

由于您已经增加了上面的指针直到它到达空字符，所以它也将在循环之后指向空字符。因此，当您打印 ptr 指针时，您实际上执行了上面的循环，打印所有字符，直到到达空指针。但是在您的情况下，您已经指向空字符。

```
char 1: 2
char 2: 4  
char 3: 2  
char 4: \0 (null byte) <-- We are still point to the null character, 
                           so it is treated as an empty string 
```

**第 4 行**：您尝试打印出 所指向的字符`ptr`，但这是空字符，因此不会打印任何内容。

```
char 1: 2
char 2: 4  
char 3: 2  
char 4: \0 (null byte) <-- We are still point to the null character so no 
                           printing is done. 
```

**第 5 行**：减少上一行的指针，这意味着它指向数组中的前一个元素。所以你现在指向最后一个'2'字符，所以它被打印出来。

```
char 1: 2
char 2: 4  
char 3: 2  <-- You decreased it by one, so now we are pointing at 2.
char 4: \0 (null byte) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:43:28.183

在第 1 行中，您将使用`pCur`not`*pCur`来输出字符串。在第一种形式中，它是指向 a 的指针*，*`char`它被视为以第一个“空字节”( `'\0'`) 结尾的字符串。在第二种形式中，指针指向的内存地址被取消引用，因此您实际上是在打印单个字符。

在第 2 行中，目的是在字符串末尾退出循环。方便的是，字符串在第一个“空字节”处结束，用 0 表示，其计算结果为 false。`pCur++`沿字符串移动指针，直到找到 0 。

在第 3 行中，`pCur`现在指向空字节，它本质上转换为空字符串。

在第 4 行中，`*pCur`再次取消引用指针地址 - 但该字符是不可打印字符`'\0'`，因此您在输出中看不到任何内容。

在第 5 行中，您将指针*向后*移动了一个空格——指向“242”的个位，因此您将`2`其视为输出。

# c - Fork() causing print statements to overlap

> ID：15211515
> 
> 赞同：0
> 
> 时间：2013-03-04T21:30:37.263
> 
> 标签：c, fork

I use fork to fork multiple child processes, but for some reason they print over each other here is an example.

```
Winning Child (5): 0
Child placed peice at: 6,4
 -  -  -  -  -  -  -  - 
Child placed peice at: 2,6
 -  -  -  -  -  -  -  - 
Child placed peice at: 4,1
 -  -  -  -  -  -  -  - 
Child placed peice at: 6,5
 -  -  -  -  -  -  -  - 
Child placed peice at: 3,1
 R  -  -  -  -  -  -  - 
Child placed peice at: 5,4
 R  -  -  -  -  -  -  - 
Child placed peice at: 5,7
 B  B  B  B  -  R  B  R 
 R  R  B  B  R  R  B  B 
Child placed peice at: 2,2 
```

This should print like this:

```
Winner Parent
Winning Parent (20): 26181
 -  -  -  -  -  -  -  - 
 -  -  -  -  -  -  -  - 
 -  -  -  -  -  -  -  - 
 -  -  -  -  -  -  -  - 
 B  -  -  R  -  -  -  - 
 B  -  -  R  B  -  -  - 
 B  -  -  R  B  B  R  R 
 R  R  -  R  R  B  B  B 
```

Is there a way to stop the other processes stop their printing when I print the winning board?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:35:57.183

It is absolutely normal to overlap the print statements in different processes because the run at the same time. You can `wait()` for the process you want to not overlap the prints with the other processes, but in the case you will lose concurrency.

Another solution would be to use some synchronization mechanisms such as a semaphore or mutex.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:38:28.317

Use `sprintf` to print to a string, then use `printf` on that string with a `fflush(stdout)` to flush to the io stream. This will keep the processes from interleaving output.

I believe this issue is a bigger issue though, what are you trying to do? Can you write the child processes to another file?

# vba - 用于计算时间长度的用户定义函数

> ID：15211518
> 
> 赞同：1
> 
> 时间：2013-03-04T21:30:45.640
> 
> 标签：vba

我正在创建一个数据库，目的是计算两个里程碑之间经过的时间长度。

```
[ID] [里程碑] [MDate] [时间长度]
-------------------------------------------------- ------
  1 1 Jan 1, 2013 [如果下一个里程碑是 2 并且它们具有相同的 ID；
                     计算 2013 年 1 月 1 日与 2013 年 2 月 1 日的 Datediff] Ans: 1 个月]

  1 2 2013 年 2 月 1 日 [如果没有随后的里程碑，结束日期应为 date()；Datediff= 2013 年 2 月 1 日与 Date()]

  2 1 2013 年 1 月 15 日 [如果以下里程碑为 2 并且它们具有相同的 ID；
                     计算 2013 年 1 月 15 日与 2013 年 2 月 1 日的 Datediff] Ans: 18 days]

  2 2 2013 年 2 月 1 日 [如果以下里程碑为 3 并且它们具有相同的 ID；
                     计算 2013 年 2 月 1 日与 2013 年 2 月 27 日的 Datediff] Ans: 12 days]

  2 3 Feb 27, 2013 如果没有后续里程碑，结束日期应为 date()；Datediff= 2013 年 2 月 27 日与 Date()]

```

表的设置是：

```
[ID] - Number; 
[Milestone] - Number; 
[Mdate]-Date; 
[Length of time] - calculated field in the query; should be with a user defined function 
```

问题是我无法自动计算两者之间的时间长度。我需要我的数据库来感知当两个具有相同 ID 和里程碑编号的记录发生更改时，上一个里程碑将使用下一个里程碑的结束日期，否则如果结束日期之后没有任何内容，则为当前日期。

我需要一个用户定义的函数来自动计算时间长度。

# javascript - 将 jQueryFileUpload 库与 require.js 一起使用

> ID：15211519
> 
> 赞同：1
> 
> 时间：2013-03-04T21:30:50.587
> 
> 标签：javascript, jquery, requirejs, jquery-file-upload

我正在[将此文件上传库](https://github.com/blueimp/jQuery-File-Upload)与 require.js 一起使用。当我尝试运行它时，出现 404 not found 错误

> localhost/js/jam/tmpl.js 404（未找到）

它似乎在寻找我在任何地方都找不到的“tmpl.js”文件。fileupload 包附带的“jquery.fileupload-ui.js”文件的第 21 行对此文件有参考。

```
(function (factory) {
'use strict';
if (typeof define === 'function' && define.amd) {
    // Register as an anonymous AMD module:
    define([
        'jquery',
        'tmpl',
        'load-image',
        './jquery.fileupload-fp'
    ], factory); 
```

同样，我不确定它的位置或来源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T05:01:38.237

[是的，您需要从https://github.com/blueimp/JavaScript-Templates](https://github.com/blueimp/JavaScript-Templates)下载文件 tmpl.js（或 tmpl.min.js）。 这是 Blueimp 自己的模板引擎。

带有链接的插件要求的完整列表：[https ://github.com/blueimp/jQuery-File-Upload#requirements](https://github.com/blueimp/jQuery-File-Upload#requirements)

# sql - 表值函数

> ID：15211525
> 
> 赞同：0
> 
> 时间：2013-03-04T21:31:16.107
> 
> 标签：sql, performance, function, table-valued-parameters

我有一个曾经可以工作的表值函数，但现在不行了，或者至少需要很多时间。

唯一可能改变的是查询读取的表上的数据量。

这是函数的代码。

```
ALTER FUNCTION [dbo].[SUPERVISOR_NOMINA2] (@iniDATE DATE,@endDATE DATE)
RETURNS @TABLA TABLE (
     [ID]               INT         NOT NULL PRIMARY KEY CLUSTERED
    ,[EFEC]             FLOAT       NOT NULL
    ,[TOP]              FLOAT       NOT NULL
    ,[EXTRA]            FLOAT       NOT NULL
    ,[DEUDA]            FLOAT       NOT NULL
    )

AS 
BEGIN

    INSERT INTO @tempTABLE

    /*------RUN FROM HERE TO TEST-------
    DECLARE @iniDATE DATE,@endDATE DATE
    SET @iniDATE = '2013-02-20'
    --*/

    SELECT 
    SOURCE.[ID],SOURCE.[NAME],SOURCE.[CAMPAIGN],[SUPERVISOR],[FLOOR MANAGER],[LAST LOGON],[EFEC],[TOP]
        ,[HR+] AS EXTRA
        ,CASE
            WHEN [DIF] >= 0 THEN 0
            ELSE [DIF]
        END AS DEUDA
    FROM (
    SELECT  
           NM.[ID]
          ,NM.[NAME]
          ,NM.[CAMPAIGN]
          ,NM.[SUPERVISOR]
          ,SUM(CASE 
             WHEN [ATT ID] > 4 AND [ATT ID] <> 7 THEN '0'
             ELSE ROUND([EFEC],2)
          END) AS [EFEC]
          ,SUM(CASE 
             WHEN [ATT ID] > 4 AND [ATT ID] <> 7 THEN '0'
             ELSE [TOP]
          END) AS [TOP]
          ,SUM(CASE 
             WHEN [ATT ID] > 4 AND [ATT ID] <> 7 THEN '0'
             WHEN [EFEC] < [TOP] THEN 0
             WHEN [TOP]+[EXHR] > [EFEC] THEN ROUND([EFEC]-([TOP]+[EXHR]),0,1)
             ELSE [EXHR]
          END) AS [HR+]
          ,ROUND(SUM(CASE 
             WHEN [ATT ID] > 4 AND [ATT ID] <> 7 THEN '0'
             WHEN [EFEC] < [TOP] THEN ROUND([EFEC]-[TOP],2)
             WHEN [TOP]+[EXHR] > [EFEC] THEN ROUND([EFEC]-([TOP]+ROUND([EFEC]-([TOP]+[EXHR]),0,1)),2)
             ELSE ROUND([EFEC]-([TOP]+[EXHR]),2)
          END),2) AS [DIF]

      FROM [WFO].[dbo].[VIEW_NOMINA] NM
      FULL JOIN [WFO].[dbo].[VIEW_ATTENDANCE] AT ON NM.ID = AT.ID AND NM.DATE = AT.DATE
      WHERE NM.DATE < CONVERT(DATE,GETDATE()) AND NM.[DATE] BETWEEN @iniDATE AND @endDATE
      GROUP BY NM.[ID],NM.[NAME],NM.[CAMPAIGN],NM.[SUPERVISOR]) SOURCE
      LEFT JOIN (
          SELECT [ID],CONVERT(DATE,MAX(DATETIME)) AS [LAST LOGON]
          FROM [WFO].[dbo].[AGENT-LOGBOOK] 
          GROUP BY [ID]
      ) LT ON LT.ID = SOURCE.ID
      LEFT JOIN [WFO].[dbo].[SUPERVISORS] SP ON SP.NAME = SOURCE.SUPERVISOR
      ORDER BY [NAME]
RETURN
END 
```

有趣的是，如果我只在插入语句之后和返回语句之前运行查询，则查询会在几秒钟内工作。

你认为我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:34:33.453

一个可能的问题是 where 子句中的这个 SQL：

```
NM.DATE < CONVERT(DATE,GETDATE()) 
```

除了我很确定`CONVERT`在这种情况下没有必要之外，以这种方式使用函数通常可以使您拥有的索引不被使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:39:53.583

这甚至可以运行吗？您的许多 CASE 语句为一种情况返回一个字符，为另一种情况返回一个数字。这应该失败。像这样更改所有行

```
 WHEN [ATT ID] > 4 AND [ATT ID] <> 7 THEN '0' 
```

对此

```
 WHEN [ATT ID] > 4 AND [ATT ID] <> 7 THEN 0 
```

# ios - iOS 屏幕绘图最佳实践

> ID：15211527
> 
> 赞同：0
> 
> 时间：2013-03-04T21:31:20.860
> 
> 标签：ios, objective-c, touch, uigesturerecognizer, uibezierpath

我正在探索制作一个用户用手指绘制图片的涂鸦应用程序，我遇到了几种不同的在屏幕上画线的方法。我在任何地方都看到过代码：

```
- (void)drawRect:(CGRect)rect // (5)
{
    [[UIColor blackColor] setStroke];
    [path stroke];
}
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    CGPoint p = [touch locationInView:self];
    [path moveToPoint:p];
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    CGPoint p = [touch locationInView:self];
    [path addLineToPoint:p]; // (4)
    [self setNeedsDisplay];
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self touchesMoved:touches withEvent:event];
}
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self touchesEnded:touches withEvent:event];
} 
```

到：

鼠标滑动=是；UITouch *touch = [触摸任何对象]; CGPoint currentPoint = [touch locationInView:self.view];

```
UIGraphicsBeginImageContext(self.view.frame.size);
[self.tempDrawImage.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
CGContextSetLineWidth(UIGraphicsGetCurrentContext(), brush );
CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), red, green, blue, 1.0);
CGContextSetBlendMode(UIGraphicsGetCurrentContext(),kCGBlendModeNormal);

CGContextStrokePath(UIGraphicsGetCurrentContext());
self.tempDrawImage.image = UIGraphicsGetImageFromCurrentImageContext();
[self.tempDrawImage setAlpha:opacity];
UIGraphicsEndImageContext();

lastPoint = currentPoint; 
```

最后一种方法（我想出的方法至少对我来说最有意义）

```
- (void) viewDidLoad{
UIPanGestureRecognizer* pan = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(drawImage:)];
[self.view addGestureRecognizer:pan];
pan.delegate = self;
paths = [[NSMutableArray alloc]init];
}
- (void) drawImage:(UIPanGestureRecognizer*)pan{
CGPoint point = [pan translationInView:self.view];

[paths addObject:[NSValue valueWithCGPoint:point]];
} 
```

在最后一个实现中，我将存储用户拖动的点并在他们绘制时绘制一条线。我觉得这将是一种密集的开销，但因为在用户与应用程序交互时有很多绘图正在进行。

所以我的问题是，是否有最佳实践/最佳绘画方法？Apple 是否更喜欢一种特定的方式而不是另一种方式，每种方式的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:04:58.337

更好的方法是使用用户的接触点作为`UIBezierPath`. 请参阅 2012 年 WWDC 会议 233 ... [http://developer.apple.com/itunes/?destination=adc.apple.com.16351493766](http://developer.apple.com/itunes/?destination=adc.apple.com.16351493766)

# soundcloud - “The Hives”的曲目未通过 api 流式传输

> ID：15211538
> 
> 赞同：5
> 
> 时间：2013-03-04T21:32:11.373
> 
> 标签：soundcloud

“The Hives”的曲目声称可以流式传输，但返回的是 404。

这是 Civilization's Dying id 3644317 ( [http://api.soundcloud.com/tracks/3644317.json?client_id=](http://api.soundcloud.com/tracks/3644317.json?client_id=) ) 的 JSON 响应：

```
{
    "kind": "track",
    "id": 3644317,
    …
    "sharing": "public",
    "streamable": true,
    "embeddable_by": "all",
    "downloadable": false,
    "title": "Civilization's Dying",
    …
    "stream_url": "http://api.soundcloud.com/tracks/3644317/stream"    
} 
```

streamable 是 true 并且它给出了一个 stream_url，当我尝试使用我的 client_id 访问它时（就像我对其他轨道所做的那样）它返回 404。

编辑：共享是公开的。将信息添加回有效负载和指向 api 页面的链接以及完整响应以供参考。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T12:09:12.030

目前有一个错误影响了一些艺术家，他们的曲目实际上不再可流式传输，但 API 响应没有显示这一事实。这应该很快解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:33:55.237

Make sure this song has "sharing" set to "public" in the returned track get request. If not, you will need to authenticate with Soundcloud.

[http://developers.soundcloud.com/docs#authentication](http://developers.soundcloud.com/docs#authentication)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-18T13:32:26.243

当我尝试流式传输 Lorde (Royals) 的曲目时，我也遇到了这个问题。（声云用户名：27622444）

检查从 API 返回的轨道属性后，我注意到该`streamable`属性已设置为`false`

**API 返回数据：**

```
(...)
sharing: "public"
state: "finished"
streamable: false
tag_list: ""
title: "Swingin' Party"
(...) 
```

希望有帮助！

干杯，T

# python - 是否可以在 Python 类定义中使用导入的类方法而不运行导入文件中的所有代码？

> ID：15211540
> 
> 赞同：1
> 
> 时间：2013-03-04T21:32:14.470
> 
> 标签：python, file, import, structure, pymol

我将 PyMOL 分子查看器用作更大程序的子集，为了便于阅读，我将我的文件分解成这样......

```
### command1ClassFile.py

class command1Class():
    def command1(self):
        print "do action 1, this requires pymol functions"

### command2ClassFile.py

class command2Class():
    def command2(self):
        print "do action 2, this also requires pymol functions"

### mainModule.py

import command1ClassFile, command2ClassFile

class commandsClass(command1Class, command2Class):
    pass

class guiClass(parentClass, commandsClass):
    def onLeftClick(self):
        self.command1()

    def onRightClick(self):
        self.command2()

# this imports the module as well as launching the program, unfortunately
import pymol
pymol.finish_launching() 
```

我不能只在其他文件的开头添加“import pymol”，因为那样会多次启动程序。我可以只使用一个 .py 文件来解决这个问题，但这会导致源文件过大。

我没有发现任何人对 PyMOL 邮件列表感兴趣，所以我希望有其他方法可以解决这个问题。如果没有，有没有更好的方法来分解代码？我习惯了被 C++ 中的头文件宠坏了，而 Python 项目的架构对我来说有点难以正确处理。

编辑：对于不同的情况，以这种方式跨文件和虚拟编译类使用多重继承是用复杂方法构建 python 项目的好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:53:07.493

如果我正确理解了这个问题，那`if __name__ == '__main__'`就是为了。

# iis-7 - HttpModule 在不同的服务器上提供文件

> ID：15211547
> 
> 赞同：0
> 
> 时间：2013-03-04T21:33:01.303
> 
> 标签：iis-7, windows-server-2008

我想创建一个可以为不同服务器上的文件提供服务的 HttpModule。

服务器 A 可公开访问并接收对 file.txt 的请求。该文件位于服务器 B 上，服务器 A 将其提供给用户。服务器 B 不公开。

使用 HttpModule 完成此任务的最高性能方法是什么？

我可以让服务器 A 从服务器 B 下载文件并将其流回给用户。这将需要服务器 A 的大量资源来执行此操作。

另一种选择可能是服务器 A 将直接从打开的文件共享向服务器 B 提供文件。这可能需要服务器 A 上的更少内存，但仍需要将文件从服务器 B 流式传输到服务器 A。

我希望有某种方法可以将请求重定向到服务器 B，然后文件可以直接从服务器 B 返回到客户端，这可能由服务器 A 促成。

我不能简单地重定向到服务器 B，因为最终用户不能直接使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T02:48:07.023

我可能根本不会投资编写 HttpModule，而是会使用 ARR（[应用程序请求路由](http://www.iis.net/downloads/microsoft/application-request-routing)）模块以高性能的方式为您执行“代理”。您还可以使用它的缓存功能，如果某些文件是“热的”，它们可以直接由“前端”服务器下载，而无需访问后端服务器。使用它的缓存将是最快的选择，因为它在缓存方面非常聪明，它也是一种无痛的方式。

它经过优化，每秒可处理数千个请求，并以异步方式进行处理，使其扩展到大量数量。用于许多内容交付网络类型的情况，因此您可以指望它非常快。

# regex - 在 Django url 正则表达式模式中使用方括号和破折号

> ID：15211554
> 
> 赞同：2
> 
> 时间：2013-03-04T21:33:39.723
> 
> 标签：regex, django, unicode

最初我使用的是 url 模式：

`url(r'^poi/folder/(?P<doc_type>\w+)/$', ...)`

捕获`doc_type`参数，该参数是从 django 中提取的字符串`models.CharField`，但是当我将模型更改为使用 django`models.SlugField`时，模式将不再匹配字符串（SlugField 返回一个 unicode 字符串），这迫使我将模式更改为：

`url(r'^poi/folder/(?P<doc_type>[-\w]+)/$', ...`

我的问题是为什么添加括号和“-”会使模式匹配 unicode 字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T21:38:28.827

我不确定Django，但我认为你错了。括号表示正则表达式中的[字符类选择器。](http://www.regular-expressions.info/charclass.html)

`\w`所以和之间的区别在于`[-\w]`：

*   `\w`仅匹配小写和大写字母以及数字和`_`（下划线符号），但不**匹配**`-`（破折号）
*   字符类`[-\W]`匹配所有`\w`匹配项加上`-`（破折号）

因此，第一个正则表达式不适用于您的其他字段但第二个正则表达式起作用的原因很可能是第二个字段中有破折号。不是该字段包含 Unicode 字符的事实。

# html - 将整个 html 文本限制为 2 行

> ID：15211560
> 
> 赞同：0
> 
> 时间：2013-03-04T21:34:02.347
> 
> 标签：html, css, line-breaks

我有各种尺寸（用 CSS 定义）`height:50px, width:100px.` 我希望每个里面的文本大约分成两半（仅当它太长时）并在必要时扩展它以适应它。

现在，当文本长度需要额外空间时，分成 3 行或更多行并溢出 ，但我既不想隐藏也不滚动文本。

你可以在这里看到代码：

```
CSS:
    div {
        font-size: 20px;
        border: 1px solid;
        width: 100px;
        height: 50px;    
    }
html:
     <div>Lorem ipsum dolor sit amet</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:37:47.297

你不能单独使用 CSS 来做到这一点。您需要使用 JavaScript 来检测高度并相应地调整框宽度的字体大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:46:03.767

这应该做的工作

```
div {
display: inline-block;
border: 1px solid;
width: 100px;
height: 50px;  
overflow: hidden;
} 
```

*   [JSFiddle 示例](http://jsfiddle.net/qk5QG/)
*   [处理此问题的另一个主题](https://stackoverflow.com/questions/7238926/limiting-text-to-only-two-lines)

当然，如果您有不同或更长的文本，您需要交替使用宽度和高度——在本[主题](https://stackoverflow.com/questions/7238926/limiting-text-to-only-two-lines)中（如前所述）提供了多种解决方案 (PHP/CSS)。

# java - 如何为我的盒子设置一个在设备间保持不变的百分比宽度？

> ID：15211562
> 
> 赞同：0
> 
> 时间：2013-03-04T21:34:08.283
> 
> 标签：java, android

我很困惑，我试图设置一个盒子的最小宽度，对于我希望它的最小宽度为屏幕宽度的 20% 的所有设备。我怎样才能做到这一点？

我从平板电脑和 XHDPI Galaxy S3 获得了两个屏幕的 dpWidth。S3 的 dpWidth 为 300，平板电脑为 800。在这种情况下，我可以通过计算 20% 的 dpWidth 并将其设置为我的盒子 dp 值以编程方式执行此操作。

我猜我不能使用重量，因为它只是为了宽度。那么如何在 XML 中做到这一点呢？

还有一个后续问题， dp 到底有什么用？如果一个设备可以有 300 和另一个 800，那么 dp 的效果会发生巨大的变化！我不明白为什么没有更多有用的单位可以使用，即屏幕分为 100 个单位或其他东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:38:09.170

您可以使用重量。线性布局中的权重仅在布局方向上计算。所以如果你有一个水平的LinearLayout，权重将控制相对宽度。如果您希望该布局中的项目跨越整个屏幕，请将它们全部设置为 fill_parent，相应地设置权重（3:1 使其为 75/25%），然后将父布局的宽度设置为 0dp。结果将是按您指定的权重分解的全屏布局。

dp 很有用。1 dp 基本上是 1/160 英寸。如果您希望事物保持真实世界的大小，请使用 dp. 如果您希望它保持以像素为单位的固定大小，请使用 px。如果您希望大小非常基于字体大小，请使用 sp。

# python - 将 Python 字典排列组合到字典列表中

> ID：15211568
> 
> 赞同：27
> 
> 时间：2013-03-04T21:34:23.727
> 
> 标签：python, dictionary

给定一个看起来像这样的字典：

```
{
    'Color': ['Red', 'Yellow'],
    'Size': ['Small', 'Medium', 'Large']
} 
```

如何创建一个组合第一个字典键的各种值的字典列表？我想要的是：

```
[
    {'Color': 'Red', 'Size': 'Small'},
    {'Color': 'Red', 'Size': 'Medium'},
    {'Color': 'Red', 'Size': 'Large'},
    {'Color': 'Yellow', 'Size': 'Small'},
    {'Color': 'Yellow', 'Size': 'Medium'},
    {'Color': 'Yellow', 'Size': 'Large'}
] 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-03-04T21:49:45.577

我认为您想要笛卡尔积，而不是排列，在这种情况下[`itertools.product`](https://docs.python.org/2.7/library/itertools.html#itertools.product)可以提供帮助：

```
>>> from itertools import product
>>> d = {'Color': ['Red', 'Yellow'], 'Size': ['Small', 'Medium', 'Large']}
>>> [dict(zip(d, v)) for v in product(*d.values())]
[{'Color': 'Red', 'Size': 'Small'}, {'Color': 'Red', 'Size': 'Medium'}, {'Color': 'Red', 'Size': 'Large'}, {'Color': 'Yellow', 'Size': 'Small'}, {'Color': 'Yellow', 'Size': 'Medium'}, {'Color': 'Yellow', 'Size': 'Large'}] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:15:39.403

您可以通过以下方式获得该结果：

```
x={'Color': ['Red', 'Yellow'], 'Size': ['Small', 'Medium', 'Large']}
keys=x.keys()
values=x.values()

matrix=[]
for i in range(len(keys)):
     cur_list=[]
     for j in range(len(values[i])):
             cur_list.append({keys[i]: values[i][j]})
     matrix.append(cur_list)

y=[]
for i in matrix[0]:
     for j in matrix[1]:
             y.append(dict(i.items() + j.items()))

print y 
```

结果：

```
[{'Color': 'Red', 'Size': 'Small'}, {'Color': 'Red', 'Size': 'Medium'}, {'Color': 'Red', 'Size': 'Large'}, {'Color': 'Yellow', 'Size': 'Small'}, {'Color': 'Yellow', 'Size': 'Medium'}, {'Color': 'Yellow', 'Size': 'Large'}] 
```

# ruby-on-rails - Rails / 如何在后台运行 csv 导出以避免慢查询

> ID：15211571
> 
> 赞同：2
> 
> 时间：2013-03-04T21:34:35.840
> 
> 标签：ruby-on-rails

我想知道是否有人对在后台运行 csv/excel 导出查询有任何好主意，这将最大限度地减少查询负载。对于 10k+ 的结果，可能会导致查询缓慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:26:25.450

好吧，我建议您使用[Sidekiq](http://mperham.github.com/sidekiq/)。这是我设想的方式

1.  你点击导出按钮
2.  包装保存整个 sql/activerecord 作业的方法，并将其放在 sidekiq 工作人员中。
3.  生成 csv 后，使其在文件系统中可用，人们可以从那里下载它。

这样做的好处是，sidekiq 将帮助您加快 SQL 查询并正确分配负载，其次，您不会遇到浏览器超时问题，因为长时间的查询需要时间来加载和在浏览器上流式传输 excel/csv。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:53:24.220

查看这些流行的后台作业库。这是一个常见的问题。

[雷斯克](http://railscasts.com/?tag_id=32)

[其他](http://railscasts.com/?tag_id=32)

[RailsCast](http://railscasts.com/?tag_id=32)

# internet-explorer - 在 PowerShell 3.0 中使用 Invoke-Webrequest 会产生 Windows 安全警告

> ID：15211573
> 
> 赞同：18
> 
> 时间：2013-03-04T21:34:45.147
> 
> 标签：internet-explorer, powershell, powershell-3.0

在 PowerShell 3.0 中使用以下代码时

```
PS> $data = Invoke-Webrequest -Uri stackoverflow.com
PS> $data.ParsedHtml.getElementsByTagName("div") 
```

我收到这个警告：

> Windows 安全警告 - 为了允许本网站为您提供个性化信息，您是否允许它在您的计算机上放置一个小文件（称为 cookie）？

我真的很想**禁止显示此消息或添加处理 cookie**的代码，以便可以安排代码。

我曾尝试在 IE 中信任该站点，允许使用 cookie，甚至降低“用户帐户控制设置”，但无济于事。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-04-01T14:37:24.470

```
$data = Invoke-WebRequest http://stackoverflow.com -UseBasicParsing 
```

它看起来像一个 Internet Explorer 提示，这是因为 Invoke-WebRequest 可能正在使用 Internet Explorer 解析 DOM。当您使用`-UseBasicParsing`参数时，您指示 PowerShell 使用其自己的解析器。出于某种原因，它似乎也隐藏了 cookie 提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-14T16:07:20.807

可以通过放松 Internet 选项中的隐私设置来隐藏该消息![在此处输入图像描述](../Images/da67730b6521de7663131baaa22abfca.png)

您也可以只为您在脚本中使用的站点添加每个站点的隐私选项，而不是允许所有 cookie。

与`-UseBasicParsing`您将保留 Internet Explorer 提供的解析相反。（以放松安全为代价）

# ruby-on-rails - RSpec，在请求规范中验证设计用户

> ID：15211576
> 
> 赞同：7
> 
> 时间：2013-03-04T21:34:57.687
> 
> 标签：ruby-on-rails, rspec, devise, warden

我正在尝试编写 RSpec 请求规范以测试我的服务 API，为此我需要对用户进行身份验证。我在网上找到了一些例子，但没有任何效果，目前我被这个困住了：

```
require "spec_helper"

include Warden::Test::Helpers
Warden.test_mode!

describe "My requests" do

  it "creates an imaginary object" do
    user = FactoryGirl.create(:user)
    login_as(user, :scope => :user)
    post "/my_service", :my_data=> {:some => "data"}
    expect(response.body).to include("success")
  end

end 
```

我得到的错误是：

```
 ArgumentError: uncaught throw :warden 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-05-19T23:39:09.950

最简单的方法是：

**规范/rails_helper.rb**

```
RSpec.configure do |config|
  # ...
  config.include Devise::Test::IntegrationHelpers, type: :request
end 
```

只需`sign_in`在您的请求规范中使用。这相当于`include Devise::Test::IntegrationHelpers`在系统/功能规范或 Rails 系统/控制器测试中声明。

这样做会导致“更好”的测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T03:03:10.960

您需要实际登录用户（即用户需要提交登录表单，或者至少在您的登录操作上执行 POST），如下所述：[Stubbing authentication in request spec](https://stackoverflow.com/questions/5787409/stubbing-authentication-in-request-spec)

# html - href 属性的相对 url 值

> ID：15211579
> 
> 赞同：0
> 
> 时间：2013-03-04T21:35:07.597
> 
> 标签：html, anchor, href

假设目前我在`www.example.com/category1/?page2`，我想在 html 中放置一个锚标记，可以将我重定向到`www.example.com/category1`. 我尝试使用`href='/'`，但它会带我去`www.example.com`而不是`www.example.com/category1`. 我也尝试使用`href=" "`，但它只是刷新当前页面。那么我应该如何指定锚标签的 href 属性呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:51:19.930

编写相对 URL 时应考虑的一件事是使用基本元素。基本元素允许您定义相对 URL 路径的上下文。

有关使用基本元素的信息：[单击此处](http://reference.sitepoint.com/html/base)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:36:31.133

如果您使用相对 url，它总是相对于顶层，而不是您所处的任何级别。所以如果你想在`www.example.com/category1`，使用`/category1`

编辑：误解了你的问题。如果您只想从您的网址中清除获取参数，请查看类似的问题，例如[如何在没有查询参数的情况下重新加载页面？](https://stackoverflow.com/questions/7241851/in-javascript-how-do-i-reload-the-page-without-the-query-parameters)（看起来使用`window.pathname`是最干净的解决方案）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:45:55.073

您可以使用`href="../category1/"`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-04T21:43:30.087

如前所述，如果您知道路径名并希望将其硬编码到标记中，则只需指定相对路径：

`<a title="Go to Category 1" href="/category1">Category 1</a>`

否则，如果您想要一个动态解决方案或不想硬编码路径，您可以使用 javascript 摆脱查询参数并使单击链接执行重定向：

`<a href="#" title="Return to main category page" onclick="window.location.href = window.location.pathname; return false;">Category N</a>`

（有关`window.location`其属性的更多信息，请参阅[https://developer.mozilla.org/en-US/docs/DOM/window.location#Properties](https://developer.mozilla.org/en-US/docs/DOM/window.location#Properties)。）

# c# - Application_Start 是否在 Web.config 文件转换之前执行？

> ID：15211588
> 
> 赞同：1
> 
> 时间：2013-03-04T21:36:01.193
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, visual-studio

我有一个转换文件，它`appconfig`向`Web.config`. 然后在`Application_Start`我试图读取添加的密钥的方法中，但它似乎不存在。当我对转换文件进行“预览转换”时，预览看起来不错，并添加了行。

**问题：**`Application_Start`在转换之前运行吗`Web.config`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:02:24.670

转换仅在实际部署期间发生，而**不是**在构建过程中发生。在您的情况下，它可能根本不会发生。

可以在构建期间触发转换，尽管它需要手动修改项目文件才能实现。[这篇文章](http://www.damirscorner.com/TransformationOfConfigurationFilesInBuildProcess.aspx)提供了一些关于如何做到这一点的见解。

但是，您可以`MSBuild`从命令行使用来执行转换（查看[此处](http://msdn.microsoft.com/en-us/vs2010trainingcourse_webdevelopment_topic4.aspx)），因此您可能能够触发构建后事件来执行此操作。[这个答案](https://stackoverflow.com/a/4960852/1250033)可能会提供您所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:38:44.413

正如@rae1n 在他的回答中解释的那样，web.config 在部署期间被转换，例如。当您决定发布 Web 应用程序的发布版本时。这`Application_Start`是您的 Web 应用程序的入口点，即当您的应用程序启动并运行时执行的第一件事。将`Application_Start`其视为`Main`C# 控制台应用程序中的方法。您的应用程序已编译，所需的任何转换都已完成。您部署了应用程序，最终用户启动了它。我希望这对你来说有点清楚了。

# javascript - 是否可以判断是否由于应用安装而打开了覆盖新标签页？

> ID：15211589
> 
> 赞同：2
> 
> 时间：2013-03-04T21:36:02.727
> 
> 标签：javascript, html, google-chrome-extension

默认的新标签页“反弹”新安装的应用程序；有没有办法用一个新的标签覆盖页面来做到这一点？我知道我可以只保存一个应用程序列表，`localStorage`或者`chrome.storage`将保存的列表与当前安装的应用程序进行比较，但这似乎是一个混乱的解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T11:16:30.983

到目前为止，还没有标准的计算方法。

有一个增强请求包括单个权限**`chrome_url_overrides`**而不是***`pageToOverride`***部分，因此[**chrome.management.getAll()**](https://developer.chrome.com/extensions/management.html#method-getAll)将识别谁覆盖了 new_tab_page。

# spring - Spring - 别名与名称的使用

> ID：15211590
> 
> 赞同：38
> 
> 时间：2013-03-04T21:36:04.357
> 
> 标签：spring

我对别名的使用感到困惑。我确实了解别名是什么以及它是如何使用的，但我看不出它与在 bean 定义中使用名称有何不同。

```
<bean id="xyx" name="abc,def" .. />

<alias name="xyx" alias="pqr"/> 
```

为什么我可以使用 abc 或 def 时使用别名？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-04T22:32:48.550

在我看来，bean 别名在您无法操作 bean 名称的大型系统中很有帮助。您可以选择为您的系统部分创建自己的名称（别名）...

来自 Spring 文档 (3.0.x) [http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/)

> ...有时需要为单个 bean 提供多个名称，也称为 bean 别名...

因此创建多个名称或/和别名是一回事。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-09-14T09:05:07.987

一个用例可能是当您想要自定义一些已经在模块化应用程序中某处定义的 bean（例如，每个模块都是一个 spring 项目）时，bean 可能由第三方框架/API 甚至您的团队定义。在这种情况下，您希望仅在您的 spring 项目中调用自定义版本而不更改其他模块（项目），只需在您的 spring 配置中添加别名，这确实是一个强大的功能：

```
<alias alias="globalBeanService" name="customizedBeanService" /> 
```

因此，每当 Spring 找到对 globalBeanService 的调用时，它都会在您的特定模块中为您注入自定义的BeanService。如果没有这个特性，你应该遍历所有类并手动修改 bean！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-02-15T14:08:02.557

别名 bean 总是比非别名 bean 具有更高的优先级，如果有不同的 bean 具有相同的别名，那么最后一个声明的 bean 将具有优先级。换句话说，别名 bean 将覆盖非别名 bean。这在创建大型项目或构建项目扩展并且不想触及原始 bean 定义时特别有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-01T01:56:52.247

Alias 有一个特定的使用场景，多个名称没有：

想象一下您的项目中有多个 config xml 文件，其中大部分是由您的同事编写的，您需要添加自己的 config.xml 文件。使用您将能够引用在另一个配置文件中定义的具有不同名称的 bean，这可能对您的配置更有意义，而无需接触您同事的配置文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-06T12:55:07.693

我最近发现了另一个用例，其中 alias 很容易解决问题。

当自动配置处于活动状态时，Spring Boot 提供`serverProperties`可用于访问有关当前运行 Web 应用程序的服务器的信息的 bean。

在集成测试中（即`@SpringBootTest`存在注释时），相同的 bean 在 name 下可用`org.springframework.boot.autoconfigure.web.ServerProperties`。

当然，可以使用不同的配置文件进行集成测试，但这需要在多个位置手动更改配置。但是，只需添加

```
<alias name="serverProperties" alias="org.springframework.boot.autoconfigure.web.ServerProperties"/> 
```

相同的配置文件可用于集成测试和生产。

这可能是 Spring Boot 中的一个错误，但是 alias 可以轻松解决问题，而无需等待新版本。而且我当然不可能自己更改引导配置。

# java - java中的泛型：识别T的类型

> ID：15211595
> 
> 赞同：0
> 
> 时间：2013-03-04T21:36:35.667
> 
> 标签：java

我正在写一些通用`DAO`的如下

```
public class MyGenericDAO<T> {

      Class<T> clazz;

      public void doSome(){
        for(int =0 ;i<14;i++){
            //do something
           }
      }
} 
```

现在我想根据 T 的类型初始化 clazz？。我该怎么做？

例如，如果有人这样做，`MyGenericDAO<Xyz> = new MyGenericDAO<MyGenericDAO>()` 那么类型`T` 应该是`Xyz`。

我该怎么做？是否可以不重新选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:39:16.717

不幸的是，反射甚至不可能。如果需要，您需要创建一个带参数的`MyGenericDao`构造`Class<T>`函数：

```
public MyGenericDao(class<T> clazz) {
  this.clazz = clazz;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T21:39:12.280

不幸的是，由于*类型擦除*`clazz`，初始化类型的唯一方法`T`是在构造函数中传递相应的类：

```
MyGenericDAO(Class<T> clazz) {
    this.clazz = clazz;
} 
```

`java.lang.Class`之所以被通用化，其中一个原因就是为了支持这种模式。由于`T`in`Class<T>`必须与 in 相对应`T`，`MyGenericDAO<T>`编译器将能够为您进行类型检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T23:19:04.247

类型参数不会到达运行时，因此调用代码必须传递一个*令牌*才能在运行时构造`Class<T>`对象。我将其命名为*令牌*，因为您可以传递许多不同的对象来`Class<T>`在运行时重建对象，例如：

*   a `String`, 与`Class.forName(name)`
*   一个`Class<T>`对象
*   *类型标记*，即参数化类型的子类，其参数既不是类型变量也不是通配符（有界或无界），例如 a `new List<String>(){}`（我使用`new`花括号来强调该表达式返回匿名子类的实例）

使用类型标记：

```
public class MyGenericDAO<T> {

  @SuppressWarnings("unchecked")
  public Class<T> getTypeParameter() throws Exception {
    Type type = ((ParameterizedType) getClass().getGenericSuperclass())
           .getActualTypeArguments()[0];
    return (Class<T>) type;
  }
} 
```

请注意，当您将 转换`Type`为`Class<T>`. 调用代码如下所示：

```
MyGenericDAO<Foo> dao = new MyGenericDAO<Foo>(){};
// Then if you want an instance
Foo foo = dao.getTypeParameter().newInstance(); 
```

再次注意花括号，因为超类型标记仅在编译时生成**真实类时才有效。**这种方法只有在客户端代码遵守合同并在每次需要 DAO 对象时使用匿名内部类时才有效（否则魔法`getTypeParameter()`消失）

# ruby - Resque 无法启动

> ID：15211598
> 
> 赞同：0
> 
> 时间：2013-03-04T21:36:59.020
> 
> 标签：ruby, ruby-on-rails-3, resque

我整天都在用头撞这个。我正在尝试使用以下设置 Resque`resque.rake`

```
require 'resque/tasks'
require 'resque_scheduler/tasks'

task "resque:setup" => :environment do
  Resque.after_fork do |job|
    ActiveRecord::Base.establish_connection
  end
  ENV['QUEUE'] ||= '*'
end 
```

当我运行时`rake resque:work --trace`，出现以下错误：

```
The Gemfile's dependencies are satisfied
** Invoke resque:work (first_time)
** Invoke resque:preload (first_time)
** Invoke resque:setup (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute resque:setup
** Execute resque:preload
Connecting to database specified by database.yml
** Invoke resque:setup 
** Execute resque:work
rake aborted!
undefined method `get' for #<Hash:0x000000021a0b88>
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/redis-namespace-1.2.1/lib/redis/namespace.rb:257:in `method_missing'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/resque-1.23.0/lib/resque/worker.rb:517:in `job'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/resque-1.23.0/lib/resque/worker.rb:450:in `unregister_worker'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/resque-1.23.0/lib/resque/worker.rb:169:in `rescue in work'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/resque-1.23.0/lib/resque/worker.rb:129:in `work'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/resque-1.23.0/lib/resque/tasks.rb:36:in `block (2 levels) in <top (required)>'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
/share/eugene/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/bin/rake:23:in `load'
/share/eugene/.rvm/gems/ruby-1.9.3-p327/bin/rake:23:in `<main>'
Tasks: TOP => resque:work 
```

我的 Gemfile 有以下相关的 Gems：

```
gem 'resque'
gem 'resque-scheduler' 
```

我也有以下初始化程序，但我认为此时它不相关：

```
require 'resque'
require 'resque_scheduler'

Resque.redis           = YAML.load_file('config/resque.yml')
Resque.schedule        = YAML.load_file('config/resque_schedule.yml') 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:00:19.653

我很笨。

```
Resque.redis = YAML.load_file('config/resque.yml') 
```

需要是

```
Resque.redis = Redis.new YAML.load_file('config/resque.yml') 
```

# design-patterns - 大型配置的责任链

> ID：15211603
> 
> 赞同：0
> 
> 时间：2013-03-04T21:37:28.810
> 
> 标签：design-patterns, configuration, dependency-injection, chain-of-responsibility

我正在为我的管道使用责任链设计模式。我发现的一个问题是，随着我添加更多链，配置对象变得越来越大。本质上，我的配置对象正在变成一个巨大的单例。有没有有效的方法来处理这种情况？

细节：

我目前的设置是

```
handler.next = handler2
handler2.next = handler3
... 
```

我通过将配置对象传递给它来使用链。

```
handler.HandleRequest(config) 
```

配置对象具有处理程序所需的所有配置信息，因此随着我添加更多链而变得越来越大。

可能的解决方案：

在这篇文章中，最好的答案是使用依赖注入。

[哪些设计模式可以应用于配置设置问题？](https://stackoverflow.com/questions/1314730/which-design-patterns-can-be-applied-to-the-configuration-settings-problem)

但是，我不确定如何在不大幅改变设计的情况下在责任链设计上使用依赖注入。

有人可以帮我解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T12:10:55.903

我认为你们正在尝试一起做一些并不真正属于一起的事情。

如果您需要为应用程序的不同部分提取设置/配置值，为什么要尝试在一个地方全部读取它们？

对于需要某种设置的每个组件，我更喜欢小的“设置对象”。我通常从包含所有硬编码默认值的对象开始，并在必要时从该基本设置派生。派生对象可以从任意源读取（大部分时间是 app.config 文件，但我也使用数据库和 Web 服务）。

这是一篇更详细地[描述设置对象的博客文章。](http://outlawtrail.wordpress.com/2012/09/26/settings-objects/)

# c# - 将 C 中包含 unsigned char 指针的代码移植到 C#

> ID：15211609
> 
> 赞同：7
> 
> 时间：2013-03-04T21:37:55.520
> 
> 标签：c#, c, encryption

我在 C 中有这段代码，需要移植到 C#：

```
void CryptoBuffer(unsigned char *Buffer, unsigned short length)
{
    unsigned short i;
    for(i=0; i < length; i++)
    {
        *Buffer ^= 0xAA;
        *Buffer++ += 0xC9;
    }
} 
```

我试过这个：

```
public void CryptoBuffer(byte[] buffer, int length)
{
    for(int i = 0; i < length; i++)
    {
        buffer[i] ^= 0xAA;
        buffer[i] += 0xC9;
    }
} 
```

但结果与预期不符。

根据示例，这是：

```
A5 03 18 01... 
```

应该变成这样：

```
A5 6F 93 8B... 
```

它还说第一个字节没有加密，所以这就是 A5 保持不变的原因。

**编辑澄清**：规范只是说你应该跳过第一个字节，它没有详细说明，所以我猜你只是传递从位置 1 到最后一个位置的序列来跳过第一个字节。

但是我对那个 C# 端口的结果是：

```
A5 72 7B 74... 
```

这个端口是正确的还是我错过了什么？

**编辑2**：为了进一步澄清，这是一个封闭的协议，所以我不能详细说明，这就是为什么我提供了足够的信息来帮助我移植代码，C代码是给我的，那就是规范所说的它会做什么。真正的问题是规范中的“0xAA”是错误的，这就是为什么输出不是预期的。此处提供的 C# 代码和接受的答案毕竟是正确的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-08T21:36:39.810

让我们一次一步地分解它。

```
void CryptoBuffer(unsigned char *Buffer, unsigned short length)
{
    unsigned short i;
    for(i=0; i < length; i++)
    {
        *Buffer ^= 0xAA;
        *Buffer++ += 0xC9;
    }
} 
```

不管其他一些评论如何，这*就是*您通常在 C/C++ 中执行这些操作的方式。这段代码没有什么花哨的，也不是太复杂，但我认为最好将其分解以向您展示发生了什么。

注意事项：

1.  unsigned char 与 c# 中的 byte 基本相同
2.  无符号长度的值介于 0-65536 之间。Int 应该可以解决问题。
3.  缓冲区有一个后增量
4.  字节分配 (+= 0xC9) 将溢出。如果它溢出，在这种情况下它会被截断为 8 位。
5.  缓冲区由 ptr 传递，因此调用方法中的指针将保持不变。
6.  这只是基本的 C 代码，没有 C++。假设人们在这里不使用运算符重载是非常安全的。

这里唯一“困难”的是 Buffer++。可以在 Sutter 的“Exceptional C++”一书中阅读详细信息，但也有一个小示例对此进行了说明。幸运的是，我们有一个完美的例子。上述代码的**直译**为：

```
void CryptoBuffer(unsigned char *Buffer, unsigned short length)
{
    unsigned short i;
    for(i=0; i < length; i++)
    {
        *Buffer ^= 0xAA;
        unsigned char *tmp = Buffer;
        *tmp += 0xC9;
        Buffer = tmp + 1;
    }
} 
```

在这种情况下，临时变量可以很容易地解决，这导致我们：

```
void CryptoBuffer(unsigned char *Buffer, unsigned short length)
{
    unsigned short i;
    for(i=0; i < length; i++)
    {
        *Buffer ^= 0xAA;
        *Buffer += 0xC9;
        ++Buffer;
    }
} 
```

现在将此代码更改为 C# 非常简单：

```
private void CryptoBuffer(byte[] Buffer, int length)
{
    for (int i=0; i<length; ++i) 
    {
        Buffer[i] = (byte)((Buffer[i] ^ 0xAA) + 0xC9);
    }
} 
```

**这与您移植的代码基本相同。**这意味着在路上的某个地方出现了其他问题......所以让我们破解密码缓冲区好吗？:-)

如果我们假设不使用第一个字节（如您所述）并且“0xAA”和/或“0xC9”是错误的，我们可以简单地尝试所有组合：

```
static void Main(string[] args)
{
    byte[] orig = new byte[] { 0x03, 0x18, 0x01 };
    byte[] target = new byte[] { 0x6F, 0x93, 0x8b };

    for (int i = 0; i < 256; ++i)
    {
        for (int j = 0; j < 256; ++j)
        {
            bool okay = true;
            for (int k = 0; okay && k < 3; ++k)
            {
                byte tmp = (byte)((orig[k] ^ i) + j);
                if (tmp != target[k]) { okay = false; break; }
            }
            if (okay)
            {
                Console.WriteLine("Solution for i={0} and j={1}", i, j);
            }
        }
    }
    Console.ReadLine();
} 
```

我们走了：**哎呀**，没有解决方案。这意味着加密缓冲区没有做你认为它正在做的事情，或者这里缺少部分 C 代码。前任 他们真的将“缓冲区”传递给 CryptoBuffer 方法还是他们之前更改了指针？

最后，我认为这里唯一好的答案是缺少解决这个问题的关键信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T22:36:26.880

您提供的示例与 C 示例中的代码不一致，C 和 C# 代码产生相同的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T21:53:06.100

移植看起来正确；你能解释一下为什么03应该变成6F吗？结果似乎偏离了 03 的“预期”值这一事实对我来说有点可疑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T21:50:01.293

港口*看起来*不错。

在这种情况下，我会拿出一张纸和一支笔，用二进制写出字节，进行 XOR，然后加法。现在将其与 C 和 C# 代码进行比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T21:52:40.733

在 C# 中，您正在溢出字节，因此它被截断为 0x72。这是将 0x03 转换为二进制和十六进制的数学运算：

```
 00000011   0x003
^  10101010   0x0AA
=  10101001   0x0A9
+  11001001   0x0C9
= 101110010   0x172 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T11:54:01.837

使用 C 中的原始方法，我们首先假设序列以**对称**方式解密/加密，并调用`CryptoBuffer`

*   最初调用`a5 03 18 01 ...`

    ```
    a5 03 18 01 ... => d8 72 7b 74 ... 
    ```

    然后上`d8 72 7b 74 ...`

    ```
    d8 72 7b 74 ... => 3b a1 9a a7 ... 
    ```

*   最初调用`a5 6f 93 8b ...`

    ```
    a5 6f 93 8b ... => d8 8e 02 ea ... 
    ```

    然后上`d8 8e 02 ea ...`

    ```
    d8 8e 02 ea ... => 3b ed 71 09 ... 
    ```

我们知道这是不可行的。

当然，您可能有**非对称**解密方法；但首先，我们需要`a5 03 18 01 ... => a5 6f 93 8b ...`用任何可能的幻数证明其中一个或相反的方向。**使用蛮力方法**进行分析的代码放在帖子的后面。

我使幻数成为测试的变量。通过**重现性分析**，我们发现原始序列可以在连续变化的幻数上每 256 次调用重现。好的，按照我们所经历的，这里仍然是可能的。

然而，**可行性分析**测试`256*256=65536`了两个方向的所有案例，从`original => expected`和`expected => original`，并且没有。

现在我们知道没有办法将加密序列解密为预期的结果。

因此，我们只能说**两种语言或您的代码的预期行为是相同**的，但是由于假设被打破，所以**预期结果是不可能的。**

* * *

分析代码

```
public void CryptoBuffer(byte[] buffer, ushort magicShort) {
    var magicBytes=BitConverter.GetBytes(magicShort);
    var count=buffer.Length;

    for(var i=0; i<count; i++) {
        buffer[i]^=magicBytes[1];
        buffer[i]+=magicBytes[0];
    }
}

int Analyze(
    Action<byte[], ushort> subject,
    byte[] expected, byte[] original,
    ushort? magicShort=default(ushort?)
    ) {
    Func<byte[], String> LaHeX= // narrowing bytes to hex statement
        arg => arg.Select(x => String.Format("{0:x2}\x20", x)).Aggregate(String.Concat);

    var temporal=(byte[])original.Clone();
    var found=0;

    for(var i=ushort.MaxValue; i>=0; --i) {
        if(found>255) {
            Console.WriteLine(": might found more than the number of square root; ");
            Console.WriteLine(": analyze stopped ");
            Console.WriteLine();
            break;
        }

        subject(temporal, magicShort??i);

        if(expected.SequenceEqual(temporal)) {
            ++found;
            Console.WriteLine("i={0:x2}; temporal={1}", i, LaHeX(temporal));
        }

        if(expected!=original)
            temporal=(byte[])original.Clone();
    }

    return found;
}

void PerformTest() {
    var original=new byte[] { 0xa5, 0x03, 0x18, 0x01 };
    var expected=new byte[] { 0xa5, 0x6f, 0x93, 0x8b };

    Console.WriteLine("--- reproducibility analysis --- ");
    Console.WriteLine("found: {0}", Analyze(CryptoBuffer, original, original, 0xaac9));
    Console.WriteLine();

    Console.WriteLine("--- feasibility analysis --- ");
    Console.WriteLine("found: {0}", Analyze(CryptoBuffer, expected, original));
    Console.WriteLine();

    // swap original and expected
    var temporal=original;
    original=expected;
    expected=temporal;

    Console.WriteLine("--- reproducibility analysis --- ");
    Console.WriteLine("found: {0}", Analyze(CryptoBuffer, original, original, 0xaac9));
    Console.WriteLine();

    Console.WriteLine("--- feasibility analysis --- ");
    Console.WriteLine("found: {0}", Analyze(CryptoBuffer, expected, original));
    Console.WriteLine();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-14T14:44:21.333

这是一个演示

[http://codepad.org/UrX0okgu](http://codepad.org/UrX0okgu)

显示给定输入的原始代码`A5 03 18 01`产生`D8 72 7B 01`；所以

1.  仅当缓冲区从第 2 个开始发送时，第一个字节未解码的规则才是正确的（向我们展示调用）

2.  输出不匹配（您是否错过其他电话？）

所以你的翻译是正确的，但你对原始代码的期望却不是。

# jquery - 无法将 div 定位在无线电 IE 的顶部

> ID：15211610
> 
> 赞同：0
> 
> 时间：2013-03-04T21:38:00.277
> 
> 标签：jquery, internet-explorer, radio-button, z-index

我有一个小应用程序，它禁用了需要升级才能启用的选项。当用户单击设置选项时，会显示一个 div，为他们提供升级说明。它在 Firefox 和 Chrome（尚未测试 Opera 或 Safari）中运行良好，但在 IE（任何版本）中不起作用。

在我所做的测试中，似乎 javascript 可以工作，但是如果您直接单击输入元素，则脚本不会运行。如果您单击元素外部（在本例中为单选按钮），则它可以工作。具有 hidden-input 类的 div 应该显示在顶部，但它似乎显示在它周围。我对 z-index 所做的一切似乎都不起作用，包括来自[http://brenelz.com/blog/squish-the-internet-explorer-z-index-bug/](http://brenelz.com/blog/squish-the-internet-explorer-z-index-bug/)的修复我猜其他人已经遇到过这个问题，但我不确定如何修复它。以下是供参考的html和javascript。

```
<div style="display:inline-block; position:relative;">
    <input type="radio" class="radio" id="wcmenucart[cart_icon][1]" name="wcmenucart[cart_icon]" value="1" disabled="" />
    <div style="position:absolute; left:0; right:0; top:0; bottom:0;" class="hidden-input-icon">
    </div>
</div>
<span style="display:none;" class="pro-icon"><i> Available in the <a href="#">Pro Version</a></i></span> 
```

Javascript - 似乎工作正常，但以防万一......

```
<script type="text/javascript">
    jQuery('.hidden-input-icon').click(function() {
        jQuery('.pro-icon').show('slow');
    });
</script> 
```

CSS：

.hidden **-input-icon**或**.pro-icon**都没有 css 样式。**.pro-icon** div 包含并且`style="display:none;"`.hidden **-input-icon** div 包含`style="position:absolute; left:0; right:0; top:0; bottom:0;"`

**编辑：**

我的代码在这里有一个小提琴[。](http://jsfiddle.net/dfkBb/7/)希望这将有助于阐明情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:28:40.737

我不相信你在`z-index`这里有问题。我相信您在通过禁用元素传播事件时遇到问题。FF 和 Chrome 显然会将`click`事件沿链传播到下一个元素，但 IE 不会。 [这篇 SO 帖子](https://stackoverflow.com/questions/3100319/event-on-a-disabled-input)处理了类似的问题，但使用了 FF。他们的解决方案在 IE 中也失败了，但值得查看该帖子以查看更多详细信息。

[这是一个](http://blog.pengoworks.com/index.cfm/2010/4/23/Attaching-mouse-events-to-a-disabled-input-element)至少适用于 Chrome 和 IE 的解决方案。这是您[更新](http://jsfiddle.net/dfkBb/10/)的小提琴以使用此解决方案。

代码与上面的解决方案非常相似，我只更改了第 17 行的“父”元素和第 39 行的实际点击功能。我还删除了原始的点击处理程序。我在小提琴中添加了另一个单选按钮，以便您可以看到我的解决方案不应干扰现有的“非禁用”元素。

# graph - 图中最短路径的数量

> ID：15211611
> 
> 赞同：17
> 
> 时间：2013-03-04T21:38:00.650
> 
> 标签：graph

我需要使用 BFS 找到图的两个节点之间的所有路径的数量。我想我的问题的答案可以在这里找到：

[如何在有向图中和线性时间中找到两个顶点之间不同最短路径的数量？](https://stackoverflow.com/questions/10226251/graph-how-to-find-the-number-of-different-shortest-paths-between-two-vertices)

但我不太明白。有人可以把算法写下来，以便我能更好地理解它吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-04T22:37:02.747

假设你需要从 src 到 dest。

对于每个顶点 x，关联两个值 count 和 val，其中 count 是从 src 到 x 的最短路径数，val 是从 src 到 x 的最短距离。还要维护一个visited 变量，告知这是否是第一次访问该节点。

应用通常的 BFS 算法，

```
Initialize u = src
visited[u] = 1, 
val[u] = 0
count[u] = 1
For each child v of u,
    if v is not visited 
```

第一次访问一个节点，从src到现在的u只有一条路径，所以到v的最短路径是（1+到u的最短路径），通过最短路径到达v的路径数相同as count[u] 因为说 u 有 5 种方式从源到达，那么只有这 5 种方式可以扩展到 v 因为 v 第一次通过 u 遇到，所以

```
val[v] = val[u]+1,    
count[v] = count[u], 
visited[v] = 1

if v is visited 
```

如果 v 已经被访问过，这意味着存在通过其他一些顶点到达 v 的其他路径，那么会出现三种情况：

1.  案子`val[v] == val[u]+1`

如果当前 val[v]（通过其他路径到达 v）等于 val[u]+1，即我们使用通过 u 的当前路径和到达 v 的其他路径到达 v 的最短距离相等，那么到 v 的最短距离保持不变，但路径数会随着到达 u 的路径数而增加。

```
count[v] = count[v]+count[u] 
```

2.  案子`val[v] > val[u]+1`

由于我们使用 BFS 逐级遍历节点，这种情况不会发生：图是未加权的，所以我们第一次设置 val[v] 时，保证 val[v] 已经包含最短路径的长度从 src 到 v。

3.  案子`val[v] < val[u]+1`

在这种情况下，无需更改 val[v] 和 count[v] 的值，因为该路径不算最短路径

执行此算法直到 BFS 完成。最后 val[dest] 包含到源的最短距离，count[dest] 包含从 src 到 dest 的路径数。

# ajax - 用于交互式用户决策的 AJAX 模式

> ID：15211612
> 
> 赞同：0
> 
> 时间：2013-03-04T21:38:03.487
> 
> 标签：ajax, jquery, user-interaction

我只是想找到一种模式/最佳实践来提出交互式用户决策。所以基本上我有一个用户必须填写的（相当大的）表格。一旦他提交，AJAX-Post-Request 就会发送到服务器。起初在那里进行了一些故障检查，但有些检查需要用户交互，例如“这真的正确吗”。由于返回的“文档”始终是 XML，我想像 bla bla2 一样一次返回所有问题，然后遍历它们。哦，因此我正在使用 JQuery 和 Bootstrap 模式。如果所有这些问题的回答都是肯定的，我将再次发送表单，并带有参数 allyes=true 或其他东西。

但是，我对此不太满意，我只是想知道是否有一些更简单的方法来编写代码。

最好的问候，火

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:40:24.630

从用户的角度来看，最好是表单告诉您在进行过程中存在问题，而不是全部填写。如果检查是字段级别的，我很想在填写时验证每一项.

# android - 使用 SpriteBatch 渲染图像时，ShapeRenderer 颜色停止工作

> ID：15211615
> 
> 赞同：4
> 
> 时间：2013-03-04T21:38:15.567
> 
> 标签：android, colors, drawing, sprite, libgdx

我制作了一个`ShapeRenderer`用于制作彩色线条的游戏。这很好用，但是当我开始导入图像时，彩色线条突然变黑了。最糟糕的是：当我使用背景时，线条根本不显示，是的，我正在以正确的顺序绘制它......

导入和渲染图像的代码：

```
Constructor(){
    TextureAtlas atlas = new TextureAtlas(Gdx.files.internal("data/texture.atlas"));
    AtlasRegion region = atlas.findRegion("path");
    Sprite sprite = new Sprite(region);
} 
```

………………………………………………………………………………………………………………………………………………

```
@Override
public void render() {
    Gdx.gl.glClearColor(255, 255, 255, 1);
    Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

    batch.begin();
    background.draw(batch); // drawing the background

    drawing.draw(); // drawing the lines
    drawObjects(); // drawing some pictures
    batch.end();
} 
```

但是当我删除用于渲染背景和图片的代码时，线条会以正确的颜色显示出来......

请帮忙！！

编辑：用看起来像这样的东西绘图`ShapeRenderer`（不必把所有东西都放进去）：

```
public void draw() {
    shaperenderer.begin(ShapeType.Line);
    shaperenderer.setColor(Color.RED);
    shaperenderer.line(1, 1, 100, 100);
    shaperenderer.end();
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-04T22:49:43.427

您不能嵌套依赖于 OpenGL 上下文的对象。具体来说，您将 a 嵌套`ShapeRenderer.begin()`在 a 中`SpriteBatch.begin()`。如果您将渲染更改为如下所示：

```
batch.begin();
background.draw(batch); // drawing the background
batch.end(); // end spritebatch context to let ShapeRenderer in

drawing.draw(); // drawing the lines (with ShapeRenderer)

batch.begin(); 
drawObjects(); // drawing some pictures
batch.end(); 
```

# java - POI 无法识别

> ID：15211617
> 
> 赞同：0
> 
> 时间：2013-03-04T21:38:17.723
> 
> 标签：java, apache-poi

我正在使用 struts 应用程序。我想处理报告。所以打算试试POI。我得到了这个 jar 文件 poi-3.6-20091214.jar 并将它们放在 web-inf/lib 文件夹中。当我尝试在类文件中使用它们时，无法识别 poi。我在下面尝试...

```
import org.apache.poi.hssf.usermodel.HSSFSheet; 
import org.apache.poi.hssf.usermodel.HSSFWorkbook; //.. 
HSSFWorkbook workbook = new HSSFWorkbook(); 
HSSFSheet sheet = workbook.createSheet("Sample sheet"); //Create a new row in current sheet 
Row row = sheet.createRow(0); //Create a new cell in current row
Cell cell = row.createCell(0); //Set value to new value 
cell.setCellValue("Blahblah"); 
```

但是导入本身不起作用。知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T14:58:55.063

我认为它的`HSSFRow`&`HSSFCell`而不是`Row`and `Cell`。这些都包含在罐子里。

使用 POI 要考虑的一点是，相同的代码将无法同时处理文件格式`.xls`和`.xlsx`文件格式。

错过了这一点：`XSSF`如果您正在使用`.xlsx`文件和`HSSF`文件`.xls`格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T09:20:00.050

您是否已添加到 eclipse lib 路径中？另一件事：使用 poi 3.8，是更新的。为什么要从旧版本开始？

# c - 结构中的可变长度数组

> ID：15211619
> 
> 赞同：6
> 
> 时间：2013-03-04T21:38:20.480
> 
> 标签：c, arrays, struct, malloc

我正在用 C 编写一个应用程序（作为初学者），我正在努力在包含可变长度数组的结构中获取损坏的数据。我在 cprogramming.com 和 cert.og/secure-coding 的论坛帖子中发现了类似的问题。我以为我找到了正确的解决方案，但似乎没有。

结构看起来像这样；

```
typedef struct {
    int a;
    int b;
} pair;

typedef struct {
    CommandType name;
    pair class;
    pair instr;
    pair p1;
    pair p2;
    pair p3;
    CommandType expected_next;
    char* desc;
    int size;
    pair sw1;
    pair sw2;
    pair* data;
} command; 
```

有问题的是“命令”。对于“命令”的任何给定实例（或任何正确的短语），将设置不同的字段，尽管在大多数情况下，尽管在不同的实例中设置了相同的字段。

我遇到的问题是在尝试设置 expected_next、name、sw1、sw2、size 和 data 字段时。数据字段越来越损坏。我正在为这样的结构分配内存；

```
void *command_malloc(int desc_size,int data_size)
{
    return malloc(sizeof(command) +
                  desc_size*sizeof(char) +
                  data_size*sizeof(pair));
}

command *cmd;
cmd = command_malloc(0, file_size); 
```

但是当我（漂亮地）打印生成的 cmd 时，数据字段的中间似乎是随机垃圾。我已经逐步使用 gdb 并且可以看到正确的数据正在加载到该字段中。似乎只有当命令被传递给不同的函数时，它才会被破坏。此代码在函数内部调用，例如；

```
command* parse(char *line, command *context) 
```

漂亮的打印发生在另一个函数中；

```
void pretty_print(char* line, command* cmd) 
```

我曾以为我做的事情是正确的，但显然不是。据我所知，我构造了该结构的其他实例没问题（我为这个重复了这些方法），但它们不包含任何可变长度数组，而且它们的漂亮打印看起来很好——这让我很担心，因为它们也有可能被破坏，但破坏不太明显。

我正在写的实际上是一个解析器，所以一个命令被传递到解析函数中（它描述了当前状态，提示解析器接下来会发生什么）和下一个命令（来自输入“行”）是回来。“context”在 parse 函数的末尾是 free-d，新命令将被返回 - 然后将通过下一个“line”输入传递回“parse”。

任何人都可以就为什么会发生这种情况提出任何建议吗？

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-05-02T04:24:46.690

当你为结构分配内存时，只有一个指针大小被分配给 *desc。正如有人已经指出的那样，您必须将内存分配给 desc 指向的空间（数组内容）。我回答的目的是展示稍微不同的方法。由于有一个指针 *desc 会增加一个字的结构大小（sizeof 指针），因此您可以安全地在结构中使用可变长度数组来减少结构大小。

这是您的结构应该是什么样子，请注意 desc[] 已被拉到结构的末尾：

```
typedef struct {
    CommandType name;
    pair class;
    pair instr;
    pair p1;
    pair p2;
    pair p3;
    CommandType expected_next;
    int size;
    pair sw1;
    pair sw2;
    pair* data;
    char desc[];
} command; 
```

现在，1\. 为包含数组大小的命令分配内存：

```
 command *cmd = malloc(sizeof(command) + desc_length); 
```

1.  使用说明：

    cmd->desc[desc_length -1] = '\0';

此 hack 仅在成员位于结构末尾时才有效，节省结构大小，节省指针间接，如果数组长度特定于结构实例，则可以使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-04T21:40:10.930

您必须分别分配 desc 和 data。

当您分配结构命令 *cmd 时，将为您的 decs 和数据指针分配内存。Desc 和 data 必须分开分配。

所以分配你的命令

```
command *cmd =  malloc(sizeof(command)); 
```

然后为数据分配内存或
为 desc 分配 desc 示例：

```
cmd->desc = malloc( sizeof(char )*100); 
```

# javascript - 由跟踪进度条触发的 HTML 5 Canvas 属性

> ID：15211620
> 
> 赞同：0
> 
> 时间：2013-03-04T21:38:26.360
> 
> 标签：javascript, jquery, html, css

我是网络编码的新手，所以这似乎是一个愚蠢的问题，但问没有坏处......有什么办法可以让音轨的进度条触发画布动画？任何帮助将不胜感激。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:05:19.430

以下是您可以附加绑定的事件列表：http: [//www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#mediaevents](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#mediaevents)

你可能正在寻找“播放”事件，所以你会做这样的事情：

```
document.getElementById('aud').play = function () {
    getElementById('can').animate();
} 
```

和“结束”事件

```
document.getElementById('aud').ended = function () {
    getElementById('can').stopAnimate();
} 
```

# javascript - javascript IsNaN 和 0

> ID：15211621
> 
> 赞同：3
> 
> 时间：2013-03-04T21:38:26.913
> 
> 标签：javascript, nan, zero

我有一些返回意外结果的代码。

HTML：

```
<select name="cc_dropdown[0]" id="cc-dropdown-0" style="display: none;">
    <option value="">Select a card</option>
    <option value="0" selected="selected">***********8431</option>
    <option value="-1">Use a new card</option>
</select> 
```

JS：

```
var ccVal = parseInt($("#cc-dropdown-0 option:selected").val());
var errors = [];

if( ccVal == -1 ) {
        if( $('#cc_number-'+bIdx).val().length <= 0 || !isValidCreditCardNo($('#cc_number-'+bIdx).val()) ) {
            errors.push('Invalid Credit card Number');
        }

        if( $('#cc_name-'+bIdx).val().length <= 0 ) {
            errors.push('Please provide the name on the credit card.');
        }

        if($('#cc_exp_month-'+bIdx).val() == ""){
            errors.push('Please Select an Expiration Date.');
        }

        if($('#cc_exp_year-'+bIdx).val() == ""){
            errors.push('Please Select an Expiration Date.');
        }

        if( !isValidZipcode($('#cc_zip-'+bIdx).val())){
            errors.push('Please enter a valid zipcode.');
        }
    }    else if ( ccVal == 'na' || ccVal == '' || isNaN(ccVal)) {
        console.log("ccVal inside else if: " + ccVal);
        console.log("ccVal type: " + typeof ccVal);
        errors.push('Please select a credit card, or enter a new one.')
    }
else {
    console.log("else");
    errors.push("Arg!");
}
console.dir(errors); 
```

在这种情况下，`ccVal`是 0，但它属于 else if 语句。我希望只有当它根本不是一个数字时才会发生这种情况。预期的结果是它应该落入最终`else`陈述中。这是一个带有结果的 JSFiddle：http: [//jsfiddle.net/n2Uy7/](http://jsfiddle.net/n2Uy7/)

谁能解释为什么会这样？如果它是 0，它不应该命中 the`if`或`else if`语句。JS 是否认为 0 是 NaN，即使`typeof`表明它是一个数字？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T21:40:34.570

`0 == ''`所以`true`这`isNaN`部分甚至没有得到评估。

使用`===`而不是`==`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:40:16.140

您正在与“只是”双等号进行比较，所以`0 == ''`（在浏览器的控制台中尝试）。

解决此问题的一种方法是改用三等号。另一种方法是`parseInt`完全删除，所以`ccVal`将保留一个字符串。字符串到字符串的比较将按预期进行（`'' != '0'`）。

删除`parseInt`也可以解决另一个问题（您没有传入基数，但您*必须*）。为什么它仍然存在？

# java - 示例代码未按预期执行

> ID：15211624
> 
> 赞同：1
> 
> 时间：2013-03-04T21:38:32.433
> 
> 标签：java

这是算法（不工作）请让我知道错误在哪里

谢谢

```
private void checkSouth(Location point, int player) {
        //Loop through everything south
        boolean isthereAnOppositePlayer=false;

        int oppositePlayer=0;
        //Set opposite player
        if (player==1) {
            oppositePlayer=2;
        }else{
            oppositePlayer=1;
        }

        for (int i = point.getVertical(); i < 8; i++) {

            //Create a location point with the current location being compared
            MyLocation locationBeingChecked= new MyLocation();
            locationBeingChecked.setHorizontal(point.getHorizontal());
            locationBeingChecked.setVertical(i);

            int value = board[locationBeingChecked.getVertical()][locationBeingChecked.getHorizontal()];

            //If the first checked is the opposite player
            if (value==oppositePlayer) {
                //Then potential to evaluate more
                isthereAnOppositePlayer=true;
            }
            //If it isn't an opposite player, then break
            if(!isthereAnOppositePlayer && value!=0){
                break;
            }

            //If another of the player's piece found or 0, then end
            if (isthereAnOppositePlayer && value==player || isthereAnOppositePlayer && value==0) {
                break;
                //end   
            }

            //Add to number of players to flip
            if(isthereAnOppositePlayer && value==oppositePlayer && value!=0){
                //add to array
                addToPiecesToTurn(locationBeingChecked);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:52:08.347

看起来旋转回另一个玩家的位置与第一次移动时旋转的位置完全相同。我猜想填充的数组`addToPiecesToTurn`可能在每次移动之间都没有被清除，所以之前的所有位置仍然在那里。

如果您将要转动的碎片存储在 中`ArrayList`，则可以使用该[`clear()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/ArrayList.html#clear%28%29)方法在每个回合之间擦除集合的内容。

* * *

另一个可能的问题是您正在检查对面的玩家，然后立即开始填充`addToPiecesToTurn`。但是，除非它们被包含当前玩家棋子的第二个位置“夹在”中，否则该方向上的棋子不一定可以旋转。我认为您的代码没有正确检查这种情况；发生这种情况时，您会想以某种方式跳过将这些部分翻转给其他玩家，例如清除`piecesToTurn`.

* * *

**编辑**：查看您当前分别实现每个方向的解决方案，您将有很多重复的代码。如果您考虑沿着某个方向行走意味着什么，您可以将其视为将 x/y 值调整“步长”量。步数可以是`-1`向后、`0`不移动或`1`向前。然后，您可以创建一个处理所有方向的方法，而无需重复逻辑：

```
private void checkDirection(Location point, int player, int yStep, int xStep) {
    int x = point.getHorizontal() + xStep;
    int y = point.getVertical() + yStep;

    MyLocation locationBeingChecked = new MyLocation();
    locationBeingChecked.setHorizontal(x);
    locationBeingChecked.setVertical(y);

    while (isValid(locationBeingChecked)) {
        // do the logic here

        x += xStep;
        y += yStep;

        locationBeingChecked = new MyLocation();
        locationBeingChecked.setHorizontal(x);
        locationBeingChecked.setVertical(y);
    }
} 
```

您需要实施`isValid`以检查该位置是否有效，即在板上。然后你可以为每个方向调用这个方法：

```
// north
checkDirection(curPoint, curPlayer, -1, 0);
// north-east
checkDirection(curPoint, curPlayer, -1, 1);
// east
checkDirection(curPoint, curPlayer, 0, 1);
// etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:03:37.603

对于某些单元测试来说，这是一种成熟的问题。您可以非常轻松地设置棋盘、下棋并验证答案，而测试结果将让您深入了解您的期望与现实的分歧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T22:06:47.007

你为什么不使用二维数组？

每个单元格将包含一个枚举：EMPTY, PLAYER_1, PLAYER_2。

然后，为了遍历单元格，您只需为每个方向使用循环。

例如，单击一个单元格时，向右检查将是：

```
for(int x=pressedLocation.x+1;x<cells[pressedLocation.y].length;++x)
  {
  Cell cell=cells[pressedLocation.y][x];
  if(cell==EMPTY||cell==currentPlayerCell)
    break;
  cells[pressedLocation.y][x]=currentPlayerCell;
  } 
```

从上到下检查将是：

```
for(int y=pressedLocation.y+1;y<cells.length;++y)
  {
  Cell cell=cells[y][pressedLocation.x];
  if(cell==EMPTY||cell==currentPlayerCell)
    break;
  cells[y][pressedLocation.x]=currentPlayerCell;
  } 
```

# java - 使用 HashMaps Java

> ID：15211626
> 
> 赞同：1
> 
> 时间：2013-03-04T21:38:44.270
> 
> 标签：java, hashmap

我正在编写一种方法，该方法允许我计算 String 类型的元素在 Strings 类型的 LinkedList 中出现的次数。我下面显示的代码不起作用。我在下面评论的那一行中不断出现索引超出范围。好像找不到bug

```
public int findDuplicate (LinkedList<String> e) {
int j = 1;
LinkedList<String> test = e;
while (!test.isEmpty()){
    test = e;
    String value = test.pop();
    //Screws up here when i = 6 
    for(int i =0; i<=test.size() && test.get(i)!=null; i++){ 
        String value3 = test.get(i);
        if(e.get(i).equals(value) && i<=test.size()){
            String value2 = test.get(i); 
            j++;
            String Duplicate = e.get(i);
            e.remove(i);
        }
    }
    System.out.println(value + " is listed " + j + " times");

}
return j;
} 
```

使用哈希图..仍然不起作用

```
public void findDuplicate (LinkedList e) {

    Map<String,Integer> counts = new HashMap<String,Integer>();

    while(!e.isEmpty()){
        String value = e.pop();
        for(int i =0; i<e.size(); i++){
            counts.put(value, i);
        }
    }
    System.out.println(counts.toString());
} 
```

我的代码应该通过链接列表找出列表中的元素出现多少次，并同时从列表中删除重复项。然后打印元素及其在列表中出现的次数。我昨晚发布了这个，但还没有得到回应。很抱歉重新发布。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:41:22.830

你跑出了列表的末尾。改变

```
for(int i =0; i<=test.size() && test.get(i)!=null; i++){ 
```

到

```
for(int i =0; i< test.size() && test.get(i)!=null; i++){ 
```

`List`a （或数组）的有效索引是`0`through `size() - 1`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:46:07.400

关于您的哈希图示例以计算重复项：

```
@Test
public void countOccurrences() {
    LinkedList<String> strings = new LinkedList<String>(){{
        add("Fred");
        add("Fred");
        add("Joe");
        add("Mary");
        add("Mary");
        add("Mary");
    }};

    Map<String,Integer> count = count(strings,new HashMap<String,Integer>());
    System.out.println("count = " + count);
}

private Map<String, Integer> count(List<String> strings, Map<String, Integer> runningCount) {
    if(strings.isEmpty()) {
        return runningCount;
    }
    String current = strings.get(0);
    int startingSize = strings.size();
    while(strings.contains(current)) {
        strings.remove(current);
    }
    runningCount.put(current, startingSize - strings.size());
    return count(strings,runningCount);
} 
```

如果您希望保留原始字符串列表，您可以这样做

```
 Map<String,Integer> count = count(new LinkedList<String>(strings),new HashMap<String,Integer>());
    System.out.println("strings = " + strings);
    System.out.println("count = " + count); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T21:56:42.227

查看 google 的 guava collections，它有一个完美的类来维护地图和获取计数：

[https://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#BiMap](https://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#BiMap)

```
Multiset<String> wordsMultiset = HashMultiset.create();
wordsMultiset.addAll(words);
// now we can use wordsMultiset.count(String) to find the count of a word 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T21:41:53.767

这不会影响您的越界问题，但您正在从列表中删除元素，同时仍在评估它。如果你删除一个元素，你应该`i--`在之后调用，或者你跳过下一个实体（它被重新索引）进行评估。

另外值得注意的是，关于您的代码，我看到您正在尝试复制您的列表，但标准分配意味着`test`并且`e`都指向同一个实例。您需要使用`Collections.copy()`查看[此 SO 线程来了解如何使用该类](https://stackoverflow.com/questions/689370/java-collections-copy-list-i-dont-understand)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T21:47:34.210

我希望你明白`test = e`声明的作用。此语句执行后两者都`test`引用`e`同**一个**对象。

如果他们中的任何一个人修改了列表，那么另一个人会看到它，因为他们都在看同一个对象。

如果这不是有意的，则需要先*克隆*列表，然后再将其分配给另一个列表引用。

# sed - 使用 awk 解析数千个 xml 文件

> ID：15211627
> 
> 赞同：1
> 
> 时间：2013-03-04T21:38:46.093
> 
> 标签：sed, awk

我有几千个文件，每个文件只包含一个很长的行。

我想将它们全部转换为一个文件，在 ID 字段中每行拆分一个条目，我可以处理几个文件，但是数百个文件花费的时间太长，而且似乎在数千个文件上崩溃。寻找一种无限的更快方式。

```
(find -type f -name '*.xml' -exec cat {} \;) | awk '{gsub("ID","\nID");printf"%s",$0}' 
```

这个我也试过了。。

```
(find -type f -name '*.xml' -exec cat {} \;) | sed 's/ID/\nID/g' 
```

我认为问题在于尝试使用替换而不是插入，或者它使用了太多内存。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:49:50.977

我无法使用数千个文件对其进行测试，但不是`cat`在使用 处理它们之前将所有数据放入内存，而是`awk`尝试一次运行`awk`其中一些文件，例如：

```
find . -type f -name "*.xml*" -exec awk '{gsub("ID","\nID");printf"%s",$0}' {} + 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:47:36.560

1.  创建您需要处理的所有文件的列表
2.  将此列表划分为较小的列表，每个列表包括 50 个文件
3.  创建一个读取子列表并输出中间文件的脚本，同时执行 ID 操作
4.  创建另一个脚本，一次在 3、20 个进程中执行脚本，根据需要，作为后台进程
5.  合并输出文件

# android - Android 空指针 onDraw Bitmap 图像

> ID：15211628
> 
> 赞同：3
> 
> 时间：2013-03-04T21:38:46.717
> 
> 标签：android, nullpointerexception, bitmapfactory

我遇到了一个我似乎无法在这里解决的问题！我正在开发一个简单的 android 游戏并且几乎实现了所有东西，但后来决定添加一些障碍（游戏是月球着陆器风格的游戏）。

基本上，我创建了一个 Asteroid 类，只是想在屏幕上绘制它们。加载游戏时，小行星被绘制，一切正常，但如果你按下主页按钮或关闭电源然后重新启动游戏，我会得到一个 NPE：

```
03-04 21:33:21.243: E/AndroidRuntime(10748): FATAL EXCEPTION: Thread-680
03-04 21:33:21.243: E/AndroidRuntime(10748): java.lang.NullPointerException
03-04 21:33:21.243: E/AndroidRuntime(10748):    at com.swiss196.LunarLander.GameThread.doDraw(GameThread.java:421)
03-04 21:33:21.243: E/AndroidRuntime(10748):    at com.swiss196.LunarLander.GameThread.run(GameThread.java:386) 
```

它指向以下代码：

```
canvas.drawBitmap(test2.getBitmap(), 120, 120, null); 
```

这表明 getBitmap 返回的画布或 test2 对象/图像为空，但在此之前，我检查画布是否不为空。在位图中，我检查图像也不为空：

```
public Bitmap getBitmap() {
if(asteroidImage == null)
    asteroidImage = BitmapFactory.decodeResource(mGameView.getContext().getResources(),
                                                 R.drawable.asteroid);

return asteroidImage;
} 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T01:47:53.793

我忘记从包中重新加载一些需要的变量，包括图像..

感谢你的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:51:27.090

您可能超出了内存预算，这就是您在尝试[解码 Bitmap](http://developer.android.com/reference/android/graphics/BitmapFactory.html#decodeResource%28android.content.res.Resources,%20int%29)时得到空值的原因。

开发者网站有[很好的描述](http://developer.android.com/training/displaying-bitmaps/index.html)如何避免这种情况。

使用的一个重要选项（再次查看第二个链接以了解如何使用它的示例）是“BitmapFactory.Options”，它允许您验证是否有足够的内存用于位图：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inJustDecodeBounds = true;
BitmapFactory.decodeResource(getResources(), R.id.myimage, options);
int imageHeight = options.outHeight;
int imageWidth = options.outWidth; 
```

引用文档

> 解码时将 inJustDecodeBounds 属性设置为 true 可避免内存分配，为位图对象返回 null，但设置 outWidth、outHeight 和 outMimeType。此技术允许您在构建位图（和内存分配）之前读取图像数据的尺寸和类型。

# haskell - 在 Haskell 中合并有限排序列表

> ID：15211629
> 
> 赞同：2
> 
> 时间：2013-03-04T21:38:48.263
> 
> 标签：haskell

我是 Haskell 的新手。我想知道如何在 Haskell 中编写一个接受有限排序的整数列表并将它们合并（排序）的函数。任何代码表示赞赏！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-04T21:47:16.553

如果您的目标只是合并两个列表，这并不复杂

```
merge :: Ord a => [a] -> [a] -> [a] 
```

这表示`merge`需要两个列表并为具有已定义排序关系的任何类型生成一个列表

```
merge [] x = x
merge x [] = x 
```

这表示如果你将空列表与任何东西合并，你就会得到任何东西

```
merge (x:xs) (y:ys) | y < x     = y : merge (x:xs) ys
merge (x:xs) (y:ys) | otherwise = x : merge xs (y:ys) 
```

这表示`if`当您合并两个列表时，第二个列表的第一个元素较低，应该放在新列表的前面，否则您应该使用第一个列表的第一个元素。

编辑：请注意，与其他一些解决方案不同，上面的合并既稳定`O(n)`又*稳定*。如果您不知道这意味着什么，请查阅维基百科。

如果您的目标是合并列表列表，您通常希望通过一次合并两个列表来做到这一点

```
mergePairs :: Ord a => [[a]] -> [[a]]
mergePairs [] = []
mergePairs [ls] = [ls]
mergePairs (x:y:ls) = (merge x y):mergePairs ls

merges :: Ord a => [[a]] -> [a]
merges [] = []
merges [x] = x
merges ls = merges $ mergePairs ls 
```

可以证明，如果所有初始列表的长度相同，则这是渐近最优的（`O(m n log n)`其中`m`是排序列表的长度，是排序列表`n`的数量）。

这可以导致渐近有效的合并排序

```
mergeSort :: Ord a => [a] -> [a]
mergeSort ls = merges $ map (\x -> [x]) ls 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T21:47:21.123

这应该这样做，而不要求列表是有限的：

```
merge :: Ord a => [a] -> [a] -> [a]
merge (x:xs) (y:ys) = if x < y
                        then x:(merge xs (y:ys))
                        else y:(merge (x:xs) ys)
merge [] xs = xs
merge xs [] = xs 
```

在英语中，检查每个列表的第一个元素，并将较小的元素作为下一个元素，然后合并剩余的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T21:47:03.303

```
(sort . concat) [[30..32],[1..3]] == [1,2,3,30,31,32] 
```

# php - 遍历sql表并在php中计算数字

> ID：15211633
> 
> 赞同：0
> 
> 时间：2013-03-04T21:39:03.103
> 
> 标签：php, sql, database, database-table

我有一个看似简单的问题，但我无法锻炼如何去做。

```
Employee id | dev_time | pm_time
1           |    4     |    5
2           |    2     |    3
3           |    6     |    2
2           |    3     |    6
3           |    4     |    4
1           |    1     |    5 
```

我的本地主机上有一个看起来像这样的表。如何找出每个员工花费的总时间（dev_time + pm_time）？我需要 SQL 语句和 while/for/foreach 循环解决方案

> 例如，employee_id 1 总共花费了 15 小时或employee_id 2 总共花费了 14 小时

谢谢！！！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:44:09.303

尝试这个：

```
 select employee_id, sum(dev_time + pm_time) as totalhours
    from mytable
group by employee_id 
```

样本输出（[**DEMO**](http://www.sqlfiddle.com/#!2/65518/1)）：

```
EMPLOYEE_ID | TOTALHOURS
1             15
2             14
3             16 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T21:45:16.440

`I require both the SQL statement and the while/for/foreach loops solution`

好吧，我有一些坏消息要告诉你。我将给你一些链接，而不是直接的代码，这样你就可以自己解决这个问题。

首先，您想了解基本的[SQL 运算符](http://www.tizag.com/sqlTutorial/sqloperators.php)。然后你会发现你想要的SQL语句不是那么难推导出来的。

其次，我会给你文字描述：

`Query all tuples from the database`

`Loop through each one, first grabbing their dev_time value, and summing it with their pm_time value.`

`Store the sum value somewhere`

正如 Conrad Friz 所提到的，这种文字描述可能会导致“N+1 选择问题”，这可以在单个语句中完成，正如您希望已经解决的那样。

希望您会采用这种方法，而不是简单地复制和粘贴代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T21:43:47.000

您可以直接在 SQL 中执行此操作，我不确定您使用的是什么 DBMS，但在 MySQL 中它是：

```
SELECT *, (dev_time+pm_time) AS total FROM table_name 
```

# php - 如何创建“未知”类的对象？

> ID：15211637
> 
> 赞同：0
> 
> 时间：2013-03-04T21:39:14.787
> 
> 标签：php, oop

我有一个 MySQL 数据库和一个表 tobjects，其中每条记录都有它的`id`, `parameter`, `value`（类似于 XML），可以说此`parameter`列确定对象的“类型”。

这些对象在其他一些表中使用，具体取决于它们的类型，因此应以特定方式处理它们中的每一个。

因为“处理”有点常见（我使用相同的函数），所以我创建了一个 TObject 类（不是抽象的，但可能是），我从中继承了其他类；这种继承方法非常有用，这就是我使用面向对象编程的原因。例如，TObject 具有`retrieve()`从 db 获取所有必要数据的方法，不是 tobjects 表中的数据，而是其他数据，这些数据依赖于类型，因此我在某些类中覆盖它。

我遇到的问题是，当我创建一个对象时，我不知道它应该是什么类。当然，我可以`SELECT Parameter FROM tobjects WHERE id=$id`，然后（使用`switch`）创建适当类的对象，并使用它的`retrieve()`方法（每个类检索不同的数据，只有来自 tobjects 的数据是常见的）从数据库中获取数据，这导致我运行查询二次和课外的一些工作，这很有效，但并不温和。

最好的解决方案是，如果我可以创建一个 TObject，然后在检索时将对象的类更改为我需要的类，它将是 TObject 的后代，但我几乎可以肯定这是不可能的。

我的解决方案是我运行第一个查询只是为了从 tobjects 中选择一个字段来确定对象的类吗？或者是否有在运行时更改对象类的技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:46:21.793

如果理解你在做什么正确，这里是我会处理这个的方式：

传递`PDO::FETCH_CLASS | PDO::FETCH_CLASSTYPE`给的第一个参数`PDOStatement::fetch()`将返回一个类的对象`PDOStatement::fetchColumn(0)`- 换句话说，它确定要从结果集第一列的值实例化的类名。

为了利用这一点，您可以`JOIN tobjects ON targetTable.objectType = tobjects.id`选择并选择`tobjects.Parameter`结果集中的第一列。如果该`Parameter`列已经包含数据库对象类型到类名的 1:1 映射，这就是您需要做的所有事情，但是我不确定是否是这种情况，而且可能不应该是这种情况，因为它使以后更难替换另一个班级。

为了克服这个限制，我建议您在第一次连接数据库时创建一个临时表，它将`Parameter`值映射到类名，您可以将其映射`JOIN`到查询中以获取目标类名。

所以流程会是这样的：

```
// Set up the connection
$db = new PDO('mysql:yourDSNhere');
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

// Create a temp table to store the mapping
$db->query("
  CREATE TEMPORARY TABLE `objectMappings` (
    `Parameter` INT NOT NULL PRIMARY KEY,
    `ClassName` VARCHAR(255)
  ) ENGINE=MEMORY
");

// A mapping of Parameter IDs to class names
$classMap = array(
  1 => 'Class1',
  2 => 'Class2',
  3 => 'Class3',
  // ...
);

// Build a query string and insert
$rows = array();
foreach ($classMap as $paramId => $className) {
  // this data is hard-coded so it shouldn't need further sanitization
  $rows[] = "($paramId, '$className')";
}

$db->query("
  INSERT INTO `objectMappings`
    (`Parameter`, `ClassName`)
  VALUES
    ".implode(',
    ', $rows)."
");

// ...

// When you want to retrieve some data
$result = $db->query("
  SELECT m.ClassName, t.*
  FROM targetTable t
  JOIN tobjects o ON t.objectType = o.id
  JOIN objectMappings m ON o.Parameter = m.Parameter
  WHERE t.someCol = 'some value'
");

while ($obj = $result->fetch(PDO::FETCH_CLASS | PDO::FETCH_CLASSTYPE)) {
  // $obj now has the correct type, do stuff with it here
} 
```

# android - 应用程序的属性不在服务和活动之间持续存在

> ID：15211638
> 
> 赞同：0
> 
> 时间：2013-03-04T21:39:16.720
> 
> 标签：android, android-activity, android-service

问题是当从 Activity 访问 TaskTimerApplication.TEST 时，它仍然是“创建”，但在服务中它应该是“修改”。在活动访问数据之前，我已经 100% 确定我的服务正在执行其代码。下面是一个简单的测试场景，以更明显的方式呈现问题。

申请代码：

```
public class TaskTimerApplication extends Application {
    // Static properties
    private static final String TAG = "Application";
    public static final boolean DEBUG = true;
    public static String TEST = "Declaration";

    @Override
    public void onCreate() {
        super.onCreate();
        TEST = "Creation";
        Log.v(TAG, "Created");
    }
} 
```

服务代码：

```
public class TaskService extends Service {
    public static final String TAG = "TaskService";

    @Override
    public void onCreate() {
        TaskTimerApplication.TEST = "Modification";
        Log.d(TAG, TaskTimerApplication.TEST);
    }
} 
```

我的完整非测试代码可以在我的[GitHub 项目](https://github.com/Gawdl3y/task-timer/tree/master/android)中看到。在完整代码中，TASKS ArrayList 在活动中保持为空，但在服务中正确填充。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:04:23.500

您的问题在于您的清单：

```
<service android:description="@string/service_description" android:name=".TaskService" android:label="@string/service_label" android:process=":TaskService"></service> 
```

通常没有充分的理由通过将您的服务放在单独的进程中来浪费 RAM 和 CPU。此外，如果您确实将服务放在单独的进程中，那么您的活动和服务将不在同一个进程中，因此不会共享一个公共`Application`对象实例。

我的建议是删除该`android:process`属性。

# c++ - 奇怪的运算符重载行为？

> ID：15211645
> 
> 赞同：7
> 
> 时间：2013-03-04T21:39:34.807
> 
> 标签：c++, operator-overloading

```
#include <iostream>
using namespace std;

class Foo{

        string _s;
        public:
        Foo(string ss){
                _s = ss;
        }
        Foo& operator=(bool b){
                cout << "bool" << endl;
                return *this;
        }
        Foo& operator=(const string& ss){
                cout << "another one" << endl;
                return *this;
        }
};

int main(){

        Foo f("bar");
        f = "this";
        return 0;

} 
```

我重载了`=`运算符。我期望`f = "this";`语句调用`operator=(const string& ss)`重载。但事实并非如此。它称为`operator=(bool b)`重载。为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-04T21:42:39.353

此运算符`operator=(const string& ss)`需要对参数 ( `const char*`to `std::string`) 的用户定义类型进行转换，而`bool`版本没有，因此提供了更好的匹配：您可以从内置类型转换`const char[5]`为`const char*`to `bool`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:15:50.827

正如另一个答案所指出的，`bool`转换的指针是首选，因为它不涉及用户定义的转换，而`std::string`转换中包含用户定义的转换。

C++11 提供了手动类型控制的能力。

```
template<size_t n>
struct enumarated_enum {
private:
  enum empty {};
};

template<bool b, size_t n=0>
using EnableIf = typename std::enable_if< b, typename enumerated_enum<n>::empty >::type;

template<typename String, EnableIf< std::is_convertible< String, std::string >::value >... >
Foo& operator=(String&& s) {
  cout << "string overload" << "\n";
}

// either this:
template<typename Bool, EnableIf< !std::is_convertible< Bool, std::string >::value && std::is_convertible< Bool, bool >::value, 1 >... >
Foo& operator=(Bool&& b) {
  cout << "bool overload" << "\n";
}
// or this:
Foo& operator=(bool b) {
  cout << "bool overload" << "\n";
} 
```

如果可以将类型转换为 a ，我们将*完美*匹配该类型，如果无法转换为`std::string`模板，则模板不匹配，`std::string`并且查看其他重载。

如果您希望能够支持多种类型，则必须使用长逻辑形式来描述您要运行的重载，并确保其他类型不接受它（使用上面的 not 构造）。如果您只有两种类型，则第二种类型可以是传统的重载。模板重载首先破解与传统重载不完全匹配的任何内容......

（第二个模板参数是一个`enum`不存在的编号 s 的可变列表，其唯一目的是确保两个模板有足够的差异，编译器不会抱怨。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:47:33.323

在不深入研究 C++ 标准的情况下，从表面上看，您的问题是，您使用 string& 和 bool 定义了分配重载，但在测试中您分配了一个 char* 数组。

因此，如果您定义一个字符串并分配，它将按预期工作。

检查它在这里工作：[http ://codepad.org/owb6noXR](http://codepad.org/owb6noXR)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T22:09:11.707

正如其他人所说，解决此问题的一个简单方法是在执行运算符时简单地将字符串转换为`std::string`, ，以便 C++ 确切知道要选择哪个重载：

```
#include <iostream>
using namespace std;

class Foo{

        string _s;
        public:
        Foo(string ss){
                _s = ss;
        }
        Foo& operator=(bool b){
                cout << "bool" << endl;
                return *this;
        }
        Foo& operator=(const string& ss){
                cout << "another one" << endl;
                return *this;
        }
};

int main(){

        Foo f((string)"bar");
        f = (string)"this";
        return 0;

} 
```

# scala - 在scala中迭代while循环

> ID：15211646
> 
> 赞同：0
> 
> 时间：2013-03-04T21:39:35.813
> 
> 标签：scala

我正在尝试编写一个程序，它将一个数字转换成它的等效字符串。IE 987,654,321 = 9876654321。我从控制台读取了值，我想遍历从 i = 0 到 string.length 的 while 循环

例子

```
 var s = "987654321"
   var characters = s.toString;
   var i = 0;
   while(i < characters.length){
     do something
   } 
```

我的代码在下面

```
 object project1 {
      def main(args: Array[String]) {
        println("Enter a number")
        val s = Console.readLine

        println(eval(s));
      }

      def tens(c: Char) : String = ( 
        if (c.toInt == 9){
          return "Ninety";
        } else if (c.toInt == 8){
          return "Eighty";
        } else if(c.toInt == 7){
          return "Seventy";
        } else if(c.toInt == 6){
          return "Sixty";
        } else if(c.toInt == 5){
          return "Fifty";
        } else if(c.toInt == 4){
          return "Fourty";
        } else if(c.toInt == 3){
          return "Thirty";
        } else if(c.toInt == 2){
          return "Twenty";
        } else{
          return "";
        }
  )

      def everyThingElse(c : Char): String = (
        if (c.toInt == 9){
          return "Nine";
        } else if (c.toInt == 8){
          return "Eight";
        } else if(c.toInt == 7){
          return "Seven";
        } else if(c.toInt  == 6){
          return "Six";
        } else if(c.toInt  == 5){
          return "Five";
        } else if(c.toInt  == 4){
          return "Four";
        } else if(c.toInt  == 3){
          return "Three";
        } else if(c.toInt  == 2){
          return "Two";
        } else if(c.toInt  == 1){
          return "One";
        } else{
          return "";
        }
      );

      def eval(s: String): String = {
        val characters = s.toCharArray;
        var word = "";
        var i = 0;
        while( i < characters.length ){
          if((i == 14) || (i == 11) || (i == 8) || (i == 5) || (i == 2)){
            word = word + everyThingElse(characters(i));
            word = word + " Hundred ";
            i += 1;
          } else if ((i == 13) || (i == 10) || (i == 7) || (i == 4) || (i == 1)){
            if(characters(i).toInt != 1){
              word = word + tens(characters(i));
              i += 1;
            } else{
              i += 1;
              if(characters(i).toInt == 9){
                word = word + " Nineteen ";
              } else if(characters(i).toInt == 8){
                word = word + " Eighteen ";
              } else if(characters(i).toInt ==7){
                word = word + " Seventeen ";
              } else if(characters(i).toInt == 6){
                word = word + " Sixteen ";
              } else if(characters(i).toInt == 5){
                word = word + " Fifteen ";
              } else if(characters(i).toInt == 4){
                word = word + " Fourteen ";
              } else if(characters(i).toInt == 3){
                word = word + " Thirdteen ";
              } else if(characters(i).toInt == 2){
                word = word + " Twelve ";
              } else if(characters(i).toInt == 1){
                word = word + " Ten ";
              }
              i += 1;
            }
          } else if (i == 9){
            word = word + everyThingElse(characters(i));
            word = word + " Billion ";
            i += 1;
          } else if(i == 6){
            word = word + everyThingElse(characters(i));
            word = word + " Million ";
            i += 1;
          } else if (i == 12){
            word = word + everyThingElse(characters(i));
            word = word + " Trillion ";
            i += 1;
          } else if (i == 0){
            word = word + everyThingElse(characters(i));
            i += 1;
          }
        }
      }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T23:43:52.423

我认为将其作为输出选项会很有趣，因此我创建了：

```
object Longhand {
  val small = (
    " one two three four five six seven eight nine ten eleven twelve " +
    "thirteen fourteen fifteen sixteen seventeen eighteen nineteen"
  ).split(' ')

  val mid = "twen thir for fif six seven eigh nine".split(' ').map(_ + "ty")

  lazy val big: Stream[String] = {
    Stream("", "thousand") #::: 
    "m b tr quadr quint sext sept oct non dec".split(' ').map(_+"illion").toStream #:::
    big.drop(1).map(_ + "-decillion")
  }

  def duo(n: Int) = {
    if (n >= 20) List(mid(n/10 - 2), small(n % 10)).filterNot(_.isEmpty)
    else List(small(n)).filterNot(_.isEmpty)
  }

  def trio(n: Int, and: Boolean = false) = {
    val tens = duo(n % 100) match {
      case Nil => Nil
      case x => if (and) "and" :: x else x
    }
    List(small(n/100)).filterNot(_.isEmpty).map(_ + " hundred") ::: tens
  }

  def triples(s: String) = s.reverse.grouped(3).map(_.reverse.toInt).toList

  def apply(s: String): String = {
    val and = (s.length>2) #:: Stream.continually(false)
    val tri = (triples(s) zip and).map{ case (s,a) => trio(s,a) }
    val all = (tri zip big).collect{ case (t,b) if !t.isEmpty => t :+ b }
    all.reverse.flatten.filterNot(_.isEmpty).mkString(" ")
  }
  def apply(l: Long): String = if (l<0) "minus "+apply(-l) else apply(l.toString)
  def apply(b: BigInt): String = if (b<0) "minus "+apply(-b) else apply(b.toString)
} 
```

它处理任意长度的字符串。这里面有所有东西和厨房水槽（更适合代码高尔夫而不是教学目的），但也许你可以从中获得一些指导。特别是，您应该尝试使用列表（数组，向量，某些东西）以避免一遍又一遍地重复自己，一遍又一遍......

有没有想过`Long`写出的最大的 unsigned long long ( ) 是什么？

```
scala> Longhand(BigInt(2).pow(64)-1)
res32: String = eighteen quintillion four hundred forty six quadrillion
  seven hundred forty four trillion seventy three billion seven hundred nine million
  five hundred fifty one thousand six hundred and fifteen 
```

* * *

编辑：等等，如果你想解决逆问题怎么办？只需在 apply 之后和右大括号之前插入：

```
val bigset = big.take(12).filterNot(_.isEmpty).toSet
val smallset = small.filterNot(_.isEmpty).toSet
val midset = mid.toSet
val valid = (bigset ++ smallset ++ mid) + "hundred"
val bignum = Iterator.iterate(BigInt(1000))(_ * 1000).take(11).toArray

def unapply(text: String): Option[BigInt] = {
  val bits = text.toLowerCase.trim.split(" +|-").filter(x => !x.isEmpty && x!="and")
  if (!bits.forall(valid contains _)) return None
  val parts = bits.map{ case s =>
    if (bigset contains s) Right(bignum(big.indexOf(s)-1))
    else if (smallset contains s) Left(small.indexOf(s))
    else if (midset contains s) Left(20 + 10*mid.indexOf(s))
    else Left(100)
  }.foldLeft(List[Either[Int,BigInt]]()){ (xs,x) =>
    x match {
      case Left(i) => xs match {
        case Left(j) :: more =>
          if (i==100) {
            if (j>=10) return None else Left(i*j) :: more
          }
          else if (i > 10 && (j%100) != 0) return None
          else if ((j%10) != 0) return None
          else Left(i+j) :: more
        case _ => Left(i) :: xs
      }
      case Right(n) => xs match {
        case Right(m) :: more => Right(n*m) :: more
        case Left(j) :: more => Right(n*j) :: more
        case Nil => Right(n) :: Nil
      }
    }
  }.collect{ case Right(n) => n; case Left(i) => BigInt(i) }
  Some(parts.foldLeft(BigInt(0)){ (acc,x) =>
    if (acc > x) return None else acc+x
  })
} 
```

现在你可以：

```
scala> "five million eight hundred and one thousand and sixty-two"
res0: String = five million eight hundred and one thousand and sixty-two

scala> res0 match { case Longhand(n) => n }
res1: BigInt = 5801062

scala> Longhand.unapply("one and hundred billion five seven million")
res2: Option[BigInt] = None 
```

（在某些情况下，它会接受实际上格式不正确的东西，但拒绝格式错误的数字非常好。）

# mysql - vb.net/mysql 在文本框中显示多于 1 行

> ID：15211651
> 
> 赞同：0
> 
> 时间：2013-03-04T21:39:50.897
> 
> 标签：mysql, vb.net, visual-studio-2010

我刚开始使用 Visual basic (vb.net) 并试图在 TextBox 中显示超过 1 个数据库行，到目前为止我有这个：

```
Private Sub foobox_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

        Dim conn As MySqlConnection

        conn = New MySqlConnection
        conn.ConnectionString = connStr

        Try
            conn.Open()
        Catch myerror As MySqlException
            MsgBox("No connection")
        End Try

        Dim myAdaptor As New MySqlDataAdapter

        Dim sqlquery = "SELECT * FROM foo ORDER BY id DESC"
        Dim myCommand As New MySqlCommand()
        myCommand.Connection = conn
        myCommand.CommandText = sqlquery

        myAdaptor.SelectCommand = myCommand
        Dim myData As MySqlDataReader
        myData = myCommand.ExecuteReader()

        If myData.HasRows Then
            myData.Read()
            Viewer.Text = myData("foo1") & myData("foo2")

        End If

        myData.Close()
        conn.Close()

    End Sub 
```

它成功连接到数据库，但只输出 1 行，我怎样才能让它输出更多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:42:30.863

您需要一个循环读取数据并在 StringBuilder 中逐行存储。
然后，当退出阅读循环时，设置文本框的 Text 属性

```
 Dim sb as StringBuilder = new StringBuilder()
    While myData.Read()
        sb.AppendLine(myData("foo1") & myData("foo2"))
    End While
    Viewer.Text = sb.ToString 
```

当然，您的文本框应该将`MultiLine`属性设置为 True

除了对您的问题的直接回答之外，您的代码应该在使用后更改为处理连接和数据读取器，我还删除了 DataAdapter 因为这里不需要

```
 Using conn = New MySqlConnection(connStr)
        Try
            conn.Open()
        Catch myerror As MySqlException
            MsgBox("No connection")
        End Try

        Dim sqlquery = "SELECT * FROM foo ORDER BY id DESC"
        Dim myCommand As New SqlCommand(sqlquery, conn)
        Using myData = myCommand.ExecuteReader()
            Dim sb as StringBuilder = new StringBuilder()
            While myData.Read()
                sb.AppendLine(myData("foo1") & myData("foo2"))
            End While
            Viewer.Text = sb.ToString        
        End Using
    End Using 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:50:32.153

你需要某种循环。我还将使用该`Using`语句来确保即使在出现异常的情况下也处理所有非托管资源（它也会关闭连接）：

```
Using conn As New MySqlConnection(connStr)
    Using myCommand As New MySqlCommand("SELECT * FROM foo ORDER BY id DESC", conn)
        Try
            conn.Open()
            Using myData = myCommand.ExecuteReader()
                If myData.HasRows Then
                    While myData.Read()
                        Dim line = String.Format("{0}{1}{2}",
                                                 myData.GetString(myData.GetOrdinal("foo1")),
                                                 myData.GetString(myData.GetOrdinal("foo1")),
                                                 Environment.NewLine)
                        viewer.Text &= line
                    End While
                End If
            End Using
        Catch ex As Exception
            MessageBox.Show(ex.ToString())
        End Try
    End Using
End Using 
```

但是，如果您想显示多条记录，我会推荐一个[`ListBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.aspx)。它对许多项目更有效，并且还将它们在逻辑上彼此分开。

（只需替换`viewer.Text &= line`为`ListBox1.Items.Add(line)`）

# java - Java EE 6 安全性和重定向

> ID：15211653
> 
> 赞同：4
> 
> 时间：2013-03-04T21:39:54.847
> 
> 标签：java, security, jsf-2, jboss7.x, java-ee-6

我有一个在 JBoss 7.1.1 上运行的 Java EE 6 Web 应用程序，它有一些页面需要身份验证，而许多页面不需要。对于经过身份验证的页面，我使用的是 Servlet 3.0 Programmatic Security，如上[一篇文章](https://stackoverflow.com/a/2207147/2133333)中所述。

在我的 web.xml 中，我有以下条目

```
<login-config>
  <auth-method>FORM</auth-method>
  <form-login-config>
    <form-login-page>/login</form-login-page>
    <form-error-page>/loginError</form-error-page>
  </form-login-config>
</login-config> 
```

在我的登录类中，我有一个方法注释了`@PostConstruct`请求的页面被捕获的位置： `String previousURL = (String) FacesContext.getCurrentInstance().getExternalContext().getRequestMap().get(RequestDispatcher.FORWARD_QUERY_STRING)`

但是，它评估为 /login 页面本身，而不是用户请求的页面，*然后*由于 web.xml 中的 login-config 设置被 JBoss 转发到该页面。结果，当我转发到 previousURL 时，它只是将我带回到登录页面，而不是用户最初单击的页面。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T04:21:32.450

您正在尝试检索错误的属性。您应该尝试检索的是[RequestDispatcher.FORWARD_REQUEST_URI](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#FORWARD_REQUEST_URI)，它是一个实际的 URI。您当前尝试检索的是`?param=1`请求的 url 之后的查询字符串（基本上是实际 URL 之后的任何内容；等等）

# makefile - 使用 JDK 6u17 构建出现问题

> ID：15211655
> 
> 赞同：1
> 
> 时间：2013-03-04T21:40:03.270
> 
> 标签：makefile, java, java-6, building

我正在尝试为工作构建旧版本的 JDK，并且在运行`make dev-sanity`. 好吧，有几个障碍，但我已经设法绕过所有障碍，除了这个。具体来说，我正在尝试从此处的源 JAR 构建 JDK 1.6u17 的 64 位版本：

*   [源码下载页面](http://download.java.net/jdk6/6u17/promoted/b04/)
*   [构建自述文件](http://download.java.net/jdk6/6u17/promoted/b04/docs/build/README-builds.html)

> **TL;DR**：我正在从源代码构建 JDK6u17，但`dev-sanity`在`make`. 我在构建自述文件中列出了所有软件及其版本，所以我认为这是一个环境变量问题。

**软件版本信息**

*   Windows 7，amd64 处理器
*   `cl.exe`版本是`14.00.50727.762`
*   `link.exe`版本是`8.00.50727.762`
*   Java 引导程序是 JDK 1.7u15
*   `msvcrt.dll`版本是`7.0.7601.17744`
*   Cygwin 是当前版本
*   `make`是 GNU make, version 的 Cygwin 版本`3.80-1`，它支持 DOS 路径。我还尝试了官方存储库中的 3.81 和 3.82 版本，因为它们没有 DOS 路径支持，所以它们不起作用，以及带有 DOS 路径支持的修补 3.81 和 3.82 版本，它们都给了我相同的错误输出为 3.80。

**环境变量**

*   `PATH`- 包括编译器工具、引导程序 JDK、来自 Cygwin 的 UNIX 工具，然后是我路径上的所有其他东西，按此顺序。
*   `LIB``SetEnv.cmd /X64`-在 Microsoft SDK 的文件夹中设置为用户环境变量`Bin`以获取值
*   `INCLUDE``SetEnv.cmd /X64`-在 Microsoft SDK 的文件夹中设置为用户环境变量`Bin`以获取值
*   `ALT_COMPILER_PATH`- 设置为`C:\PROGRA~1\MICROS~2\Windows\v6.0\VC\Bin\x64\`（使用短路径来避免空格问题）
*   `ALT_BOOTDIR`- `C:\PROGRA~1\Java\JDK17~1.0_1\`（JDK 7 路径）
*   `ALT_MSVCRT_DLL_PATH`- `C:\Windows\System32\`（msvcrt.dll 文件在我的 System32 文件夹中）
*   `ALT_DXSDK_PATH`- 只是设置为短路径`DXSDK_DIR`

我可以打开 Cygwin 并使用以下命令开始制作过程：

```
make dev-sanity ARCH_DATA_MODEL=64 ARCH=amd64 
```

但随后它会出现以下输出错误：

```
$ cd [jdk-src-root]/control/make
$ make dev-sanity ARCH_DATA_MODEL=64 ARCH=amd64
cd  ../../control/make
make sanity DEV_ONLY=true
make[1]: Entering directory `/cygdrive/c/Users/bsaltz/jdk6u17src/control/make'
make[2]: Entering directory `/cygdrive/c/Users/bsaltz/jdk6u17src/deploy/make'
../make/common/Defs.gmk:52: /make/common/Defs.gmk: No such file or directory
make[2]: -p: Command not found
make[2]: -p: Command not found
../make/common/Defs-windows.gmk:9: /make/common/Defs-windows.gmk: No such file or directory
../../j2se/make/common/Defs-windows.gmk:16: /Defs.gmk: No such file or directory
/bin/sh: - : invalid option
Usage:  /bin/sh [GNU long option] [option] ...
        /bin/sh [GNU long option] [option] script-file ...
        [ ... More /bin/sh usage output ]
/bin/sh: - : invalid option
Usage:  /bin/sh [GNU long option] [option] ...
        /bin/sh [GNU long option] [option] script-file ...
        [ ... More /bin/sh usage output ]
/bin/sh: #define: command not found
/bin/sh: {print $3}: command not found
/bin/sh: -n: command not found
/bin/sh: - : invalid option
/bin/sh: - : invalid option
/bin/sh: -n: command not found
../../j2se/make/common/shared/Sanity.gmk:97: /Sanity-Settings.gmk: No such file or directory
make[2]: -p: Command not found
make[2]: *** No rule to make target `/Sanity-Settings.gmk'.  Stop.
make[2]: Leaving directory `/cygdrive/c/Users/bsaltz/jdk6u17src/deploy/make'
make[1]: *** [deploy-sanity] Error 2
make[1]: Leaving directory `/cygdrive/c/Users/bsaltz/jdk6u17src/control/make'
make: *** [dev-sanity] Error 2 
```

据我所知，我可能在某处有一个坏的或缺少的环境变量，因为它看起来命令没有正确执行，也许有些变量没有得到解决。

请注意，我们这样做是为了获取带有局部变量的调试 jar，而且似乎 fastdebug jar 不再适用于 6u17。如果有人有 6u17 fastdebug 链接，如果这意味着我不需要编译任何东西，我也会接受。

如果有人想要`-d`输出，请告诉我，我会把它贴在 pastebin 或其他东西上。

# ios - 架构 armv7 的未定义符号：重复文件

> ID：15211665
> 
> 赞同：1
> 
> 时间：2013-03-04T21:40:25.087
> 
> 标签：ios, xcode

我在导入 DropboxSDK 时收到此错误：

![在此处输入图像描述](../Images/2b2bbb0679d34f1fec9a7d734b5f895c.png)

很奇怪，但我注意到 Dropbox sdk 头文件夹和我在应用程序的另一部分使用的 .h 文件之一都有这个文件：Base64Transcoder

我尝试将我的另一个更改为 Base64Transcoder2，但错误仍然存​​在。这个问题的解决方案可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:34:39.643

You probably need to add that .m class file to Project->Target ->Build Phases -> Compile Sources.

EDIT:

This is a good answer. [Undefined symbols for architecture armv7](https://stackoverflow.com/questions/6429494/undefined-symbols-for-architecture-armv7)

# c++ - 在 Itanium 和 MSVC ABI 中跨模块边界的 RTTI

> ID：15211667
> 
> 赞同：5
> 
> 时间：2013-03-04T21:40:33.953
> 
> 标签：c++, visual-c++, gcc, rtti, abi

我正在阅读[Itanium ABI](http://refspecs.linux-foundation.org/cxxabi-1.83.html#rtti)，它说

> 当且仅当指针相等时，两个 type_info 指针才指向等价的类型描述。实现必须满足这个约束，例如通过使用符号抢占、COMDAT 部分或其他机制。

有谁知道在使用动态加载库时如何在流行平台上实现这一点的血腥细节，例如使用 GCC 和 GNU binutils 的 Linux？它有多可靠？

此外，我的印象是`typeid`MSVC 中的比较是（曾经？）使用运行时字符串比较对损坏的符号名称实现的，因为不能保证满足这一要求。这仍然是它的做法吗？是否存在阻止 MSVC 使用与 Itanium ABI 平台相同的技术的技术平台限制？

**编辑**还有一个问题：跨模块边界（在任一 ABI 中）捕获异常是否也依赖于 RTTI 信息，或者除了等效于 runtime 之外是否还涉及另一种机制`dynamic_cast`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-25T14:14:23.787

MSVC 首先使用指针比较，然后，如果失败，则比较字符串。可以在 VS2012 的 CRT 源码中看到实现：

```
extern "C" _CRTIMP int __cdecl __TypeMatch(
    HandlerType *pCatch,                // Type of the 'catch' clause
    CatchableType *pCatchable,          // Type conversion under consideration
    ThrowInfo *pThrow                   // General information about the thrown
                                        //   type.
) {
    // First, check for match with ellipsis:
    if (HT_IS_TYPE_ELLIPSIS(*pCatch)) {
        return TRUE;
    }

    // Not ellipsis; the basic types match if it's the same record *or* the
    // names are identical.
    if (HT_PTD(*pCatch) != CT_PTD(*pCatchable)
      && strcmp(HT_NAME(*pCatch), CT_NAME(*pCatchable)) != 0) {
        return FALSE;
    }
    ... 
```

Itanium ABI 始终只使用指针比较。它应该与 DLL 一起工作的方式是动态加载程序应确保程序地址空间中的每个异常都有一个 typeinfo 对象的实例。

如果您对异常 RTTI 的实际实现和捕获信息感兴趣，请查看我的[OpenRCE 文章](http://www.openrce.org/articles/full_view/21)(MSVC) 和[Recon 2012 演示文稿](http://www.hexblog.com/?p=704)（GCC，MSVC x64）。

# php - 如何在 phpDocumentor 中更改 php 的路径？

> ID：15211669
> 
> 赞同：0
> 
> 时间：2013-03-04T21:40:39.743
> 
> 标签：php, phpdoc

我的机器上至少安装了两个（可能三个）PHP。phpDocumentor 似乎坚持使用`/usr/local/bin/php`，而我更喜欢使用它`/usr/local/php5/bin/php`。我找不到任何关于指定解释器路径的参考。是否有可能，或者我应该只是符号链接到正确的版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:22:53.087

嗯，在我的 phpdoc（`which phpdoc`==`/usr/bin/phpdoc`此处）中，您可以将 shebang 更改为`#!/usr/local/php5/bin/php`，但我不想推测如果我更新 phpdocumentor 会发生什么...

如果你用 pear 安装它，你可以：

```
$ sudo pear config-set php_bin /usr/local/php5/bin/php
# remove to reset the package
$ sudo pear uninstall phpDocumentor
$ sudo pear instal phpDocumentor
....
$ head `which phpdoc`
#!/usr/local/php5/bin/php
<?php
/** 
```

# mysql - MySQL：使用 4 个表进行查询所需的帮助

> ID：15211670
> 
> 赞同：0
> 
> 时间：2013-03-04T21:40:40.620
> 
> 标签：mysql

有这四张表：

```
posts
posts_replies
likes
myfavorite 
```

我正在使用以下查询从前 3 个表中返回数据。但是第四张表（我最喜欢的），我希望它也包含在其中并加载用户选择为收藏夹的帖子。

```
SELECT  posts.title, 
    posts.num, 
    posts.status, 
    posts.category, 
    posts.content, 
    posts.member_num, 
    COUNT( posts_replies.post_num ) AS count, 
    COUNT( likes.comment_num ) AS likes_count
FROM    posts
    LEFT JOIN posts_replies 
        ON ( posts_replies.post_num = posts.num )
    LEFT JOIN likes 
        ON ( likes.comment_num = posts_replies.num )
WHERE   posts.member_num = '84'
GROUP   BY posts.num 
ORDER   BY posts.num 
```

myfavorite 表具有以下字段：

```
id (primary key)
member_num 
recordNum 
table ('posts' OR 'members') 
```

我尝试将以下左连接添加到上述查询中以从 myfavorite 表中提取记录，但它不起作用：

```
LEFT JOIN myfavorite 
ON ( myfavorite.recordNum = posts.num ) 
```

我对这个查询感到困惑，对此有什么建议吗？

谢谢

****编辑 ******

 **以下是带有示例数据的表格`posts`和`myfavorite`表格：

桌子：`myfavorite`

```
id  |   member_num  |   recordNum   |   table   
72  |   84          |   74          |   blyrbs 
```

桌子：`posts`

```
title       |   num |   status  |   category    |   content                 |   member_num
Testing Post|   117 |       1   |   0           |   testing...              |   84
My Fav Post |   107 |       1   |   0           |   this is the fav post... |   22 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T06:54:48.633

好的，我自己找到了答案，我实际上是错误地使用了这部分查询：

```
LEFT JOIN myfavorite 
    ON ( myfavorite.member_num = posts.member_num ) 
```

它应该在哪里：

```
 LEFT JOIN myfavorite 
        ON ( myfavorite.recordNum = posts.num ) 
```

而且我还更改了以下`WHERE`条款：原始只是：

```
WHERE   posts.member_num = 84 
```

编辑后的工作是：

```
WHERE   posts.member_num = 84 OR myfavorite.member_num = 84 
```

所以最终的工作查询是这样的：**`(Query took 0.2901 sec)`**

```
SELECT  posts.title, 
    posts.num, 
    posts.status, 
    posts.category, 
    posts.content, 
    posts.member_num, 
    myfavorite.recordNum,
    myfavorite.`table`,
    COUNT( posts_replies.post_num ) AS count, 
    COUNT( likes.comment_num ) AS likes_count
FROM    posts
    LEFT JOIN posts_replies 
        ON ( posts_replies.post_num = posts.num )
    LEFT JOIN likes 
        ON ( likes.comment_num = posts_replies.num )
    LEFT JOIN myfavorite 
        ON ( myfavorite.recordNum = posts.num )
WHERE   posts.member_num = 84 OR myfavorite.member_num = 84
GROUP   BY posts.num 
ORDER   BY posts.num 
```

它完全按照需要提供了两条记录。

但是我看到了一个新问题，即查询所花费的时间。我认为上述查询效率不高。

如果我将 where 子句改回**`WHERE posts.member_num = 84`**然后查询只需要**`0.0059 sec`**

我想知道这是否真的是最好和最有效的方法？

顺便说一句，感谢 @Slowcoder、@Melanie 和 @ethrbunny 的时间和建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T03:44:26.447

您可以尝试以下查询吗？

```
SELECT  posts.title, 
    posts.num, 
    posts.status, 
    posts.category, 
    posts.content, 
    posts.member_num, 
    myfavourite.record_num,
    myfavourite.table,
    COUNT( posts_replies.post_num ) AS count, 
    COUNT( likes.comment_num ) AS likes_count
FROM    posts
    LEFT JOIN posts_replies 
        ON ( posts_replies.post_num = posts.num )
    LEFT JOIN likes 
        ON ( likes.comment_num = posts_replies.num )
    LEFT JOIN myfavorite 
        ON ( myfavorite.member_num = posts.member_num )
WHERE   posts.member_num = 84
GROUP   BY posts.num 
ORDER   BY posts.num 
```**

# php - $_SESSION 变量没有将数据发送到下一页

> ID：15211672
> 
> 赞同：0
> 
> 时间：2013-03-04T21:40:51.040
> 
> 标签：php, session-variables

我正在编写一个 php 脚本，该脚本在成功登录后将数据发送到下一页。

我让它在我的`localhost`.

但是现在我上传到服务器，变量不再被传递。此外，我不得不更改我的 PHP 脚本，因为它不会执行`header("Location: blah.php)`。

经过一番研究，我发现`ob_start()`解决了标题的问题。

我想知道这是否是导致我`$_SESSION`无法将数据发送到下一页的原因。

这是第一页的代码：

```
if (mysqli_num_rows($result) == 1){
    $_SESSION['currentUser'] = $username;
    header("Location: loggedin.php"); 
```

这是我获得会话变量的第二页`currentUser`。

```
//start the session
session_start();
//grab the current user
$currentUser = $_SESSION['currentUser'];
echo "You're Logged in as: ". $currentUser; 
```

当我运行脚本时，它只打印出`You're Logged in as:`没有用户名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:46:37.110

`session_start()`在第一页调用。

# wcf - mvc wcf 安全性

> ID：15211674
> 
> 赞同：2
> 
> 时间：2013-03-04T21:41:10.040
> 
> 标签：wcf, model-view-controller, authentication, wcf-security

我有一个使用表单身份验证的 MVC 应用程序。此应用程序还托管 WCF Web 服务（模型）。Webservice 为应用程序提供 c# 对象，当从应用程序（浏览器）外部调用时，相同的数据可用作 JSON。除了 Web 服务没有对​​任何请求进行身份验证之外，一切都运行良好。以下是我在 web.config 中的内容：

```
<system.serviceModel>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
<behaviors>
  <endpointBehaviors>
    <behavior name="ServiceBehavior">
      <webHttp />
    </behavior>
  </endpointBehaviors>
</behaviors>
<bindings>
  <webHttpBinding>
    <binding name="webHttpBindingWithJson" crossDomainScriptAccessEnabled="true" />
  </webHttpBinding>
</bindings>
<services>
  <service name="Services.MyService">
    <endpoint address="http://localhost:1234/MyService.svc/" binding="webHttpBinding"
              bindingConfiguration="webHttpBindingWithJson"
              contract="Services.IService"
              behaviorConfiguration="ServiceBehavior"/>
  </service>
</services> 
```

我想对 Webservice 请求进行身份验证：

*   应用程序内部的请求应自动进行身份验证
*   当从应用程序外部调用 Web 服务时，会要求用户进行身份验证。

任何帮助，将不胜感激。

/D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:31:01.440

听起来您需要一个内部端点来提供 wsdl 用于绑定到网站（使用网站正在运行的 ASP.NET 身份进行身份验证）和一个单独的外部绑定，用于使用 OAuth 之类的东西进行身份验证的 JSON 请求。

无论哪种方式，您都在查看两种不同的身份验证机制。

# linux-device-driver - Linux PCI 驱动程序 - pci_enable_device 失败

> ID：15211681
> 
> 赞同：2
> 
> 时间：2013-03-04T21:41:40.647
> 
> 标签：linux-device-driver, pci

我对 linux/kernels/drivers 相当陌生。我正在为嵌入式 linux (3.2.17) 上的 pci 卡编写驱动程序。

我遇到的问题是在我的探测功能中，`result = pci_enable_device(dev)`失败并出现以下错误

```
0000:02:00.0: device not available (can't reserve [mem 0x00000000-0x00001ff) 
```

我不确定这是为什么或如何调试它。

请让我知道我应该发布哪些其他信息。

编辑：

`lspci -v` 退回了这个

```
02:00.0 Class 0000: Unknown device 11aa:1770 (rev 52)

   Subsystem: Unknown device feed:beef

   Flags: slow devsel, IRQ 16

   Memory at <ignored> (32-bit, non-prefetchable)

   Capabilities: [44] Vendor Specific Information 
```

在 dmesg 中找到了这个

```
PCI: Probing PCI hardware
pci_bus 0000:00: scanning bus
pci 0000:00:00.0: [1957:0070] type 1 class 0x000b20
pci 0000:00:00.0: calling quirk_mmio_always_on+0x0/0x24
pci 0000:00:00.0: ignoring class b20 (doesn't match header type 01)
pci 0000:00:00.0: calling fixup_hide_host_resource_fsl+0x0/0x54
pci 0000:00:00.0: calling pcibios_fixup_resources+0x0/0x110
pci 0000:00:00.0: calling quirk_fsl_pcie_header+0x0/0x74
pci 0000:00:00.0: calling quirk_resource_alignment+0x0/0x19c
pci 0000:00:00.0: supports D1 D2
pci 0000:00:00.0: PME# supported from D0 D1 D2 D3hot D3cold
pci 0000:00:00.0: PME# disabled
pci_bus 0000:00: fixups for bus
pci 0000:00:00.0: scanning [bus 01-02] behind bridge, pass 0
pci 0000:00:00.0: scanning [bus 00-00] behind bridge, pass 1
pci_bus 0000:01: scanning bus
pci 0000:01:00.0: [12d8:e110] type 1 class 0x000604
pci 0000:01:00.0: calling quirk_mmio_always_on+0x0/0x24
pci 0000:01:00.0: calling pcibios_fixup_resources+0x0/0x110
pci 0000:01:00.0: calling quirk_resource_alignment+0x0/0x19c
pci 0000:01:00.0: PME# supported from D0 D3hot D3cold
pci 0000:01:00.0: PME# disabled
pci_bus 0000:01: fixups for bus
pci 0000:00:00.0: PCI bridge to [bus 01-ff]
pci 0000:00:00.0:   bridge window [mem 0xc0000000-0xc00fffff]
pci 0000:01:00.0: scanning [bus 02-02] behind bridge, pass 0
pci 0000:01:00.0: scanning [bus 00-00] behind bridge, pass 1
pci_bus 0000:02: scanning bus
pci 0000:02:00.0: [11aa:1770] type 0 class 0x000000
pci 0000:02:00.0: calling quirk_mmio_always_on+0x0/0x24
pci 0000:02:00.0: reg 10: [mem 0xc0000000-0xc0001fff]
pci 0000:02:00.0: calling pcibios_fixup_resources+0x0/0x110
pci 0000:02:00.0: calling quirk_resource_alignment+0x0/0x19c
pci_bus 0000:02: fixups for bus
pci 0000:01:00.0: PCI bridge to [bus 02-ff]
pci 0000:01:00.0:   bridge window [mem 0xc0000000-0xc00fffff]
pci_bus 0000:02: bus scan returning with max=02
pci_bus 0000:01: bus scan returning with max=02
pci_bus 0000:00: bus scan returning with max=02
PCI: Cannot allocate resource region 1 of PCI bridge 2, will remap
PCI: Cannot allocate resource region 0 of device 0000:02:00.0, will remap
PCI 0000:00 Cannot reserve Legacy IO [io  0xff7ec000-0xff7ecfff]
PCI: max bus depth: 2 pci_try_num: 3
pci 0000:01:00.0: BAR 8: assigned [mem 0xc0000000-0xc00fffff]
pci 0000:01:00.0: PCI bridge to [bus 02-02]
pci 0000:01:00.0:   bridge window [mem 0xc0000000-0xc00fffff]
pci 0000:00:00.0: PCI bridge to [bus 01-02]
pci 0000:00:00.0:   bridge window [io  0xff7ec000-0xff7fbfff]
pci 0000:00:00.0:   bridge window [mem 0xc0000000-0xdfffffff]
pci 0000:00:00.0: enabling device (0106 -> 0107)
pci_bus 0000:00: resource 0 [io  0xff7ec000-0xff7fbfff]
pci_bus 0000:00: resource 1 [mem 0xc0000000-0xdfffffff]
pci_bus 0000:01: resource 0 [io  0xff7ec000-0xff7fbfff]
pci_bus 0000:01: resource 1 [mem 0xc0000000-0xdfffffff]
pci_bus 0000:02: resource 1 [mem 0xc0000000-0xc00fffff] 
```

有问题的设备是 0000:02

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T01:20:18.887

我认为这个问题是由于函数 pci_enable_resources() 调用失败，失败的原因是没有资源->父节点。

资源关系是在 pcibios_init() 期间或内核启动期间的某个地方建立的。

我对解决这个问题的建议是，在内核建立资源关系之前，您必须正确配置 PCI 芯片配置空间中的 BAR 寄存器。然后内核将使用这些配置来开发资源关系。

# jquery - 让浏览器控制滚动 CSS

> ID：15211683
> 
> 赞同：0
> 
> 时间：2013-03-04T21:41:52.583
> 
> 标签：jquery, css

我正在使用 dynatree 创建手风琴视图。当我扩展手风琴时，我希望它扩展以容纳尽可能多的文本空间。如果文本运行得比屏幕更远，那么你在浏览器上的滚动条。我不想在文本所在的空间中滚动条（溢出：隐藏）。如何展开以便正确显示？

![在此处输入图像描述](../Images/efb8ce2fb6a2bd0171d8041aac856d36.png)

这是关于“包含文本的部分”的课程

```
#expanderHtml{
    padding: 10px;
    border: 1px solid #aaa;

    overflow: hidden;
    background: #fff;
    position: relative;
    z-index: 12;
    -mox-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    -moz-box-shadow: 0px 1px 0px 0px #fff;
    -webkit-box-shadow: 0px 1px 0px 0px #fff;
    box-shadow: 0px 1px 0px 0px #fff;
    behavior: url(../Css/PIEFiles/PIE.htc);

} 
```

这是带有文本的框后面的灰色框上的类。

```
.ViewWrapper{
    padding: 20px 20px 20px 0px;
    border-top: 1px solid #999999;
    background: #e5e5e5;
    position: relative;
    -mox-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    height: 243px;
} 
```

我需要 dynatree 扩展至文本向下，如果它太远，那么你可以滚动剩下的路

# ruby - 如何遍历条件以将新值分配给不同的属性？

> ID：15211685
> 
> 赞同：1
> 
> 时间：2013-03-04T21:42:00.770
> 
> 标签：ruby, loops, where

我正在尝试使用 :name 属性中的文本在新的哈希数组中分配 unit_type 。

这是我的数据

```
class Unit
  attr_accessor :name
  attr_accessor :imported_id
  attr_accessor :country
  attr_accessor :unit_type

  raw_stuff = [{:old_id=>576, :name=>"16th Armored Division (USA) "}, {:old_id=>578, :name=>"20th Armored Division (USA)"}, {:old_id=>759, :name=>"27th Armoured Brigade (UK)"}, {:old_id=>760, :name=>"- 13th/18th Royal Hussars"}, {:old_id=>761, :name=>"- East Riding of Yorkshire Yeomanry "}, {:old_id=>762, :name=>"- Staffordshire Yeomanry "}, {:old_id=>769, :name=>"A I R B O R N E "}, {:old_id=>594, :name=>"1st Airborne Division (UK)"}, {:old_id=>421, :name=>"6th Airborne Division (UK)"}]

  units = []

  raw_stuff.each do |unit_hash|
   u = Unit.new
   u.name = unit_hash[:name].sub("-","").lstrip
   u.unit_type = unit_hash[:name].scan("Division")
   puts u.unit_type
   puts u.name
  end

end 
```

这适当地将“除法”分配为 unit_type。但是我似乎不能分配其他任何东西，例如“旅”。我应该使用 if 或 where 条件吗？

```
When I use the following code:
  raw_stuff.each do |unit_hash|
   u = Unit.new
   u.name = unit_hash[:name].sub("-","").lstrip
      if unit_hash[:name].scan("Division")
        u.unit_type = "Division"
      elsif unit_hash[:name].scan("Brigade")
        u.unit_hash = "Brigade"
      else
        u.unit_hash = nil
      end
   puts u.unit_type
   puts u.name
  end 
```

我最终将分部分配到每个单位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:25:26.573

可爱的单线：

```
u.unit_type = unit_hash[:name][/Division|Brigade/] 
```

您的代码中的错误是当它没有找到任何东西时`scan`返回一个空数组 ( )，而一个空数组是“真实的”。`[]`您正在寻找的方法是`include?`我的解决方案通过直接将字符串搜索结果（可以是`nil`）分配给单元类型来完全绕过条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:49:08.477

试试这个：

```
if unit_hash[:name].include?("Division")
    u.unit_type = "Division"
  elsif unit_hash[:name].include?("Brigade")
    u.unit_type = "Brigade"
  else
    u.unit_type = nil
  end 
```

# ruby-on-rails - delay_job，作业随机消失

> ID：15211688
> 
> 赞同：0
> 
> 时间：2013-03-04T21:42:08.890
> 
> 标签：ruby-on-rails, ruby, delayed-job

我们有一个生成报告的模型。

每个报告都可能非常复杂，并且可能需要很长时间才能加载。因此，我们使用`delayed_job`在后台执行此操作。

一切都在我的本地计算机上运行，​​但在我们的生产环境中，工作随机消失。它们甚至不存在于`delayed_job.log`成功或失败中。创建了延迟的作业，但有时它们被删除而不会引发任何错误或完成工作。

这是我们模型中的方法：

```
def generate_html
    ac = DelayedJobsController.new()
    tmp_html = ac.render_to_string partial: self.partial_path, object: self
    self.update_attributes(html: tmp_html, done: true)
end
handle_asynchronously :generate_html 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T19:35:33.063

经过大量的工作，我们发现了问题。

当我们确实运行时`crontab -l`，`ps aux`我们看到两个 delay_job 实例正在运行。在我们杀死了其中最老的一个之后，它们都按原样工作了。

# mysql - 交错狮身人面像索引

> ID：15211689
> 
> 赞同：0
> 
> 时间：2013-03-04T21:42:16.577
> 
> 标签：mysql, sphinx

我正在尝试创建一个包含 3700 万条记录的索引。

我正在使用脚本从 MySQL 导出数据，并将其输出为 XML，然后使用 xmlpipe2 导入。

我遇到的问题是生成的 XML 文件非常大，而我正在开发的服务器没有存储 XML 的内存。

如果我限制要导入的行数，例如 LIMIT 0、1000000，那么当我执行 LIMIT 1000000、1000000 时，索引不会像这样“合并”，而是会覆盖。

我可以以某种方式错开这一点，以便最终得到所有数据的索引吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T13:06:08.787

无需输出到实际的 XML 文件，只需将输出直接通过管道传输到 sphinx。这样他们的实际文件就不必存在（在内存中或文件系统上）。

即，您在“xmlpipe_command”中调用的脚本只是将 XML 直接打印到 STDOUT。狮身人面像会随着它的进行消化并阅读它。

我已经读取了比服务器内存大很多倍的 XML 数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T06:17:46.037

每个索引可以有多个源，例如多个 xml 文件或多个 mysql 源。索引按照您给它们的顺序获取它们，只需确保文档 id 在源中是唯一的。

# c# - 如何确保至少选中一个复选框

> ID：15211690
> 
> 赞同：1
> 
> 时间：2013-03-04T21:42:19.433
> 
> 标签：c#, javascript, asp.net

我试图确保使用自定义验证器和 javascript 选择了至少一个复选框，但它根本不显示错误消息。它阻止代码继续前进，但无法显示错误消息。如果我选择一个复选框，那么代码将进入下一个级别。这里缺少什么？谢谢。

```
 <script type="text/javascript">

        function ValidateModuleList(source, args) {
            var chkListModules = document.getElementById('<%= cblCustomerList.ClientID %>');
            var chkListinputs = chkListModules.getElementsByTagName("input");
            for (var i = 0; i < chkListinputs.length; i++) {
                if (chkListinputs[i].checked) {
                    args.IsValid = true;
                    return;
                }
            }
            args.IsValid = false;
        }
    </script> 
```

这是我的自定义验证器和控件

```
 <asp:CheckBoxList ID="cblCustomerList" runat="server" DataSourceID="SqlDataSource1"
     DataTextField="GroupName" DataValueField="GroupName" onclick="readCheckBoxList()">
 </asp:CheckBoxList>

 <asp:CustomValidator runat="server" ID="cvmodulelist" ValidateModuleList"
      ErrorMessage="Please Select Atleast one Application" ></asp:CustomValidator> 
```

# jquery - 使用 SELECT 作为 post 值加载数据

> ID：15211691
> 
> 赞同：0
> 
> 时间：2013-03-04T21:42:26.080
> 
> 标签：jquery, ajax

我正在使用以下 HTML：

```
<select name="compet" id="compet"></select>
<select  name="spage" id="spage">
  <option value="home">Home</option>
  <option value="insert">Insert</option>
  <option value="ranking">change</option>
  <option value="details">Details</option>
</select>
<input type="submit" name="ChangePage" id="Goto" onclick="change_page()" value="ChangePage" /> 
```

和以下 jQuery（我希望单击按钮通过 AJAX 将新页面加载到 div 中）：

```
<script  type="text/javascript">
  function change_page(){
    $.ajax({
      url: '', // This is where I want to get the value based on the SELECT
      type: 'POST',
      data: { compet: $('#compet').val() },
      success: function(data){
        $(".myresult").html(data);
      }
    })
  }
</script> 
```

我希望 URL 基于`SELECT`选择的项目。不过，不知道如何做到这一点。任何的意见都将会有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:53:08.407

这应该有效（nb，未经测试）

```
<script  type="text/javascript">
  function change_page(){

     var myurl;

     switch($("#spage").val())
     {
        case "home":
          myurl = "http://mysite.com";
          break;
        case "insert":
          myurl = "http://mysite.com/insert";
          break;
        case "ranking":
          myurl = "http://mysite.com/ranking";
          break;
 // etc
     }

    $.ajax({
      url: myurl,
      type: 'POST',
      data: { compet: $('#compet').val() },
      success: function(data){
        $(".myresult").html(data);
      }
    })
  }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:52:04.240

在我更改此 HTML 后，它现在可以工作了

```
<select name="compet" id="compet"></select>
<select  name="spage" id="spage">
  <option value="home">Home</option>
  <option value="insert">Insert</option>
  <option value="ranking">change</option>
  <option value="details">Details</option>
</select>
<input type="button" name="ChangePage" id="Goto" onclick="change_page()" value="ChangePage" /> // I changed type to button from submit 
```

谢谢

# file - 在特定行号之间获取行的速度

> ID：15211702
> 
> 赞同：0
> 
> 时间：2013-03-04T21:43:21.473
> 
> 标签：file, unix

我使用以下命令获取文件中特定行号之间的行：

```
sed -n '100000,200000p' file1.xml > file2.xml 
```

花了相当长的时间。有更快的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T04:07:58.077

如果您的文件有比您设置的限制（200000 条）多得多的记录，那么您会花时间阅读您不想要的记录。

您可以使用 q 命令退出 sed，并避免阅读许多您不想要的行。

```
sed -n '100000,200000p; 200001q' file1.xml > file2.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:28:40.463

你可以试试这个`split`命令。

`split -l 100000 file1.xml file2`

然后您将获得多个带有后缀 aa、ab 等的文件。您将对带有后缀的文件感兴趣`ab`。

# python - 使用python将csv文件导入Mysql数据库

> ID：15211703
> 
> 赞同：2
> 
> 时间：2013-03-04T21:43:22.173
> 
> 标签：python, mysql, csv

这是我的代码：

```
#!/usr/bin/python 
import MySQLdb
import csv

db = MySQLdb.connect(host="host", # The Host
                     user="username", # username
                     passwd="pwd", # password
                     db="databasename") # name of the data base

sqlLoadData = 'LOAD DATA LOCAL INFILE "csv?_file_name.csv" INTO TABLE tablename '   
sqlLoadData += 'FIELDS TERMINATED BY "," LINES TERMINATED BY "\n"'     
sqlLoadData += 'IGNORE 1 LINES'     
sqlLoadData += 'ENCLOSED BY '"' ESCAPED BY "\\" '

try:
    curs = db.cursor()   
    curs.execute(sqlLoadData)    
    resultSet = curs.fetchall()    
except StandardError, e:    
    print e    
    db.rollback()
    db.close() 
```

我收到错误消息：您的 SQL 语法有错误；检查与您的 Mysql 服务器相对应的手册。

当我移除零件时，`sqlLoadData += 'ENCLOSED BY '"' ESCAPED BY "\\" '`一切都很完美。我使用最后一部分只是为了从值中删除引号。

我也试过：

> 游标 = mydb.cursor()
> 
> reader = csv.reader(open('Cumulative.csv', 'rb'))
> 
> reader.next() for row in reader[1:]: cursor.execute('INSERT INTO Cumulative (C1, C2, C3, C4, C5, C6) VALUES(%s, %s, %s, %s, % s, %s)', 行)
> cursor.commit()

关闭与数据库的连接。

> 光标.close()

我只想删除引号，以便整数字段支持数据。所以带引号的“1”将被视为字符串而不是整数

任何人都可以帮助我理解这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:45:11.973

看起来您忘记用空格或换行符终止前一行。当解析器试图理解`LINESENCLOSED`哪个显然不是关键字时，这会导致语法错误。

```
 sqlLoadData += 'IGNORE 1 LINES \n'
 sqlLoadData += ''ENCLOSED BY '"' ESCAPED BY "\" '' 
```

作为一个经验法则：当你在调试时，你可以通过删除一行来修复你的代码，不要排除*上面的行*

编辑：修改了第二行的引号。我认为它打破了“封闭式”声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T18:04:53.720

经过两天的研究，我找到了答案：

```
!/usr/bin/python  
import MySQLdb 
import csv

db = MySQLdb.connect(host="host", # The Host
                      user="username", # username
                      passwd="pwd", # password
                      db="databasename") # name of the data base

 cursor = connection.cursor() 
 Query = """ LOAD DATA LOCAL INFILE 'usrl to csv file' INTO TABLE
 table_nameFIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED
 BY '"' Lines terminated by '\n' IGNORE 1 LINES """

cursor.execute(Query)   
connection.commit()   
cursor.close() 
```

希望它会帮助那里的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-25T01:40:26.843

经过数天和数小时的互联网搜索并遇到各种错误和警告，这非常有效。我希望这可以节省一些时间

```
import MySQLdb
import os
import string

db = MySQLdb.connect (host="host",
    user="user",
    passwd="pwd",
    db="database_name",
    local_infile = 1) #Grants permission to write to db from an input file. Without this you get sql Error: (1148, 'The used command is not allowed with this MySQL version')

print "\nConnection to DB established\n"

#The statement 'IGNORE 1 LINES' below makes the Python script ignore first line on csv file
#You can execute the sql below on the mysql bash to test if it works
sqlLoadData = """load data local infile 'file.csv' into table table_name FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n' IGNORE 1 LINES;"""

try:
    curs = db.cursor()   
    curs.execute(sqlLoadData)
    db.commit()   
    print "SQL execution complete"   
    resultSet = curs.fetchall()   
except StandardError, e:    
    print "Error incurred: ", e    
    db.rollback()
    db.close()

print "Data loading complete.\n" 
```

谢谢，我希望这会有所帮助:)

# c# - 如何在 WPF 中从一个 tabitem 移动到另一个 tabitem

> ID：15211710
> 
> 赞同：1
> 
> 时间：2013-03-04T21:43:49.620
> 
> 标签：c#, wpf, ado.net, wpf-controls, wpfdatagrid

我有一个`tab-control`包含三个选项卡项目。每个选项卡项目上都有一个`datagrid`放置。并且这三个数据网格在其各自的选项卡项上都是 Master-Detail-SubDetail 形式。

当用户在主数据网格上选择一行时，如何从第一个选项卡项移动到第二个选项卡项？我使用`ADO.Net`实体框架创建了一个模型来创建这个主从视图。

XAML 布局

```
 <TabControl Height="270" HorizontalAlignment="Left" Margin="16,23,0,0" Name="tabControl1" VerticalAlignment="Top" Width="462">
        <TabItem Header="Person" Name="tabItem1">
            <Grid DataContext="{StaticResource peopleViewSource}">
                <DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="166" SelectedItem="{Binding personDetails}"
                          HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="64,23,0,0" Name="peopleDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="289">
                    <DataGrid.Columns>
                        <DataGridTextColumn x:Name="personIDColumn" Binding="{Binding Path=personID}" Header="person ID" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="firstNameColumn" Binding="{Binding Path=firstName}" Header="first Name" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="lastNameColumn" Binding="{Binding Path=lastName}" Header="last Name" Width="SizeToHeader" />
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </TabItem>
        <TabItem Header="Person Details" Name="tabItem2">
            <Grid DataContext="{StaticResource peoplepersonDetailsViewSource}">
                <DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="120" SelectedItem="{Binding personDetails.personStatus}"
                          HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="82,18,0,0" Name="personDetailsDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="172">
                    <DataGrid.Columns>
                        <DataGridTextColumn x:Name="detailIDColumn" Binding="{Binding Path=detailID}" Header="detail ID" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="positionColumn" Binding="{Binding Path=position}" Header="position" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="personIDColumn1" Binding="{Binding Path=personID}" Header="person ID" Width="SizeToHeader" />
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </TabItem>
        <TabItem Header="Person Status" Name="tabItem3">
            <Grid DataContext="{StaticResource peoplepersonDetailspersonStatusViewSource}">
                <DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="143" HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="91,23,0,0" Name="personStatusDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="185">
                    <DataGrid.Columns>
                        <DataGridTextColumn x:Name="detailIDColumn1" Binding="{Binding Path=detailID}" Header="detail ID" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="positionColumn1" Binding="{Binding Path=position}" Header="position" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="statussColumn" Binding="{Binding Path=statuss}" Header="statuss" Width="SizeToHeader" />
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </TabItem>
    </TabControl> 
```

![选项卡项目 1](../Images/0a29929862500e10a9bea1faef87acd6.png)

![选项卡项目 2](../Images/e4a9dad4cc378e7c07c043aec8071f7c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:08:31.113

你可以设置一个`EventTrigger`事件`DataGrid` `SelectionChanged`

因为 EventTrigger 只允许 Animation 你可以设置一个`Int32AnimationUsingKeyFrames`动画来改变`TabControl` `SelectedIndex`

扳机

```
 <DataGrid.Triggers>
    <EventTrigger RoutedEvent="DataGrid.SelectionChanged" > // SelectionChanged Event
        <BeginStoryboard>
            <Storyboard >
                <Int32AnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="tabControl1" Storyboard.TargetProperty="SelectedIndex"> // set target control and target property
                    <SplineInt32KeyFrame KeyTime="00:00:00" Value="1"/> // Value = TabControl Selected index you want to show
                </Int32AnimationUsingKeyFrames>
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
</DataGrid.Triggers> 
```

这是一个例子：

```
<TabControl Height="270" HorizontalAlignment="Left" Margin="16,23,0,0" Name="tabControl1" VerticalAlignment="Top" Width="462">
        <TabItem Header="Person" Name="tabItem1">
            <Grid DataContext="{StaticResource peopleViewSource}">
                <DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="166" SelectedItem="{Binding personDetails}"
                          HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="64,23,0,0" Name="peopleDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="289">
                    <DataGrid.Columns>
                        <DataGridTextColumn x:Name="personIDColumn" Binding="{Binding Path=personID}" Header="person ID" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="firstNameColumn" Binding="{Binding Path=firstName}" Header="first Name" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="lastNameColumn" Binding="{Binding Path=lastName}" Header="last Name" Width="SizeToHeader" />
                    </DataGrid.Columns>
                        <DataGrid.Triggers>
                            <EventTrigger RoutedEvent="DataGrid.SelectionChanged" >
                                <BeginStoryboard>
                                    <Storyboard >
                                        <Int32AnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="tabControl1" Storyboard.TargetProperty="SelectedIndex">
                                            <SplineInt32KeyFrame KeyTime="00:00:00" Value="1"/>
                                        </Int32AnimationUsingKeyFrames>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </DataGrid.Triggers>
                </DataGrid>
            </Grid>
        </TabItem>
     ...... 
```

这是我的模型

代码：

```
namespace WpfApplication7
{
    public partial class MainWindow : Window
    {

        private Person _selectedPerson;
        private ObservableCollection<Person> _persons = new ObservableCollection<Person>();

        public MainWindow()
        {
            InitializeComponent();
            Items.Add(new Person { personID = "Stack" });
            Items.Add(new Person { personID = "Overflow" });
        }

        public ObservableCollection<Person> Items
        {
            get { return _persons; }
            set { _persons = value; }
        }

        public Person SelectedPerson
        {
            get { return _selectedPerson; }
            set { _selectedPerson = value; }
        }

    }

    public class Person
    {
        public string personID { get; set; }
        public string firstname { get; set; }
        public string lastname { get; set; }
    }
} 
```

xml:

```
<Window x:Class="WpfApplication7.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="399" Width="464" Name="UI" >

    <Grid>
        <TabControl Height="270" HorizontalAlignment="Left" Margin="16,23,0,0" Name="tabControl1" VerticalAlignment="Top" Width="462">
            <TabItem Header="Person" Name="tabItem1">
                <Grid DataContext="{Binding ElementName=UI, Path=Items}" >
                    <DataGrid  AutoGenerateColumns="False" EnableRowVirtualization="True" Height="166" SelectedItem="{Binding personDetails}"
                          HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="64,23,0,0" Name="peopleDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="289">
                        <DataGrid.Columns>
                            <DataGridTextColumn x:Name="personIDColumn" Binding="{Binding Path=personID}" Header="person ID" Width="SizeToHeader" />
                            <DataGridTextColumn x:Name="firstNameColumn" Binding="{Binding Path=firstName}" Header="first Name" Width="SizeToHeader" />
                            <DataGridTextColumn x:Name="lastNameColumn" Binding="{Binding Path=lastName}" Header="last Name" Width="SizeToHeader" />
                        </DataGrid.Columns>
                        <DataGrid.Triggers>
                            <EventTrigger RoutedEvent="DataGrid.SelectionChanged" >
                                <BeginStoryboard>
                                    <Storyboard >
                                        <Int32AnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="tabControl1" Storyboard.TargetProperty="SelectedIndex">
                                            <SplineInt32KeyFrame KeyTime="00:00:00" Value="1"/>
                                        </Int32AnimationUsingKeyFrames>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </DataGrid.Triggers>
                    </DataGrid>
                </Grid>
            </TabItem>
            <TabItem Header="Person Details" Name="tabItem2">
                <Grid>
                    <DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="120" SelectedItem="{Binding personDetails.personStatus}"
                          HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="82,18,0,0" Name="personDetailsDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="172">
                        <DataGrid.Columns>
                            <DataGridTextColumn x:Name="detailIDColumn" Binding="{Binding Path=detailID}" Header="detail ID" Width="SizeToHeader" />
                            <DataGridTextColumn x:Name="positionColumn" Binding="{Binding Path=position}" Header="position" Width="SizeToHeader" />
                            <DataGridTextColumn x:Name="personIDColumn1" Binding="{Binding Path=personID}" Header="person ID" Width="SizeToHeader" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            <TabItem Header="Person Status" Name="tabItem3">
                <Grid>
                    <DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="143" HorizontalAlignment="Left" ItemsSource="{Binding}" Margin="91,23,0,0" Name="personStatusDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="185">
                        <DataGrid.Columns>
                            <DataGridTextColumn x:Name="detailIDColumn1" Binding="{Binding Path=detailID}" Header="detail ID" Width="SizeToHeader" />
                            <DataGridTextColumn x:Name="positionColumn1" Binding="{Binding Path=position}" Header="position" Width="SizeToHeader" />
                            <DataGridTextColumn x:Name="statussColumn" Binding="{Binding Path=statuss}" Header="statuss" Width="SizeToHeader" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window> 
```

# machine-learning - Python 中的梯度下降实现返回 Nan

> ID：15211715
> 
> 赞同：0
> 
> 时间：2013-03-04T21:44:28.410
> 
> 标签：machine-learning, linear-regression, statistics

我正在尝试在 python 中实现梯度下降；当我尝试使用 training_set1 时，该实现有效，但当我尝试使用 training_set 时，它返回的不是数字（nan）。知道为什么我的代码被破坏了吗？

```
from collections import namedtuple

TrainingInstance = namedtuple("TrainingInstance", ['X', 'Y'])

training_set1 = [TrainingInstance(0, 4), TrainingInstance(1, 7),
    TrainingInstance(2, 7), TrainingInstance(3, 8),
    TrainingInstance(8, 12)]

training_set = [TrainingInstance(60, 3.1), TrainingInstance(61, 3.6),
    TrainingInstance(62, 3.8), TrainingInstance(63, 4),
    TrainingInstance(65, 4.1)]

def grad_desc(x, x1): 
    # minimize a cost function of two variables using gradient descent
    training_rate = 0.1
    iterations = 5000
    #while sqrd_error(x, x1) > 0.0000001:
    while iterations > 0:
        #print sqrd_error(x, x1)
        x, x1 = x - (training_rate * deriv(x, x1)), x1 - (training_rate * deriv1(x, x1))
        iterations -= 1
    return x, x1

def sqrd_error(x, x1):
    sum = 0.0
    for inst in training_set:
        sum += ((x + x1 * inst.X) - inst.Y)**2
    return sum / (2.0 * len(training_set))

def deriv(x, x1):
    sum = 0.0
    for inst in training_set:
        sum += ((x + x1 * inst.X) - inst.Y)
    return sum / len(training_set)

def deriv1(x, x1):
    sum = 0.0
    for inst in training_set:
        sum += ((x + x1 * inst.X) - inst.Y) * inst.X
    return sum / len(training_set)

if __name__ == "__main__":
    print grad_desc(2, 2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T02:29:57.340

减少`training_rate`，以便目标在每次迭代中减少。

参见图 6。在本文中：http: [//yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf](http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf)

# google-maps - 打开位置标记绿色，关闭位置标记灰色？

> ID：15211718
> 
> 赞同：0
> 
> 时间：2013-03-04T21:44:45.453
> 
> 标签：google-maps, google-maps-api-3

我对 Google Maps API 相当陌生，并且正在使用第 3 版构建一个包含餐厅位置的移动网络应用程序。我想在地图上列出所有附近的位置，但标记的颜色表示餐厅的营业状态（即绿色标记=目前开放，灰色标记=目前关闭）。

我真的可以使用一些关于如何开始这个项目的信息。任何人都对如何最好地实现这一点有一些见解，或者有任何好的例子的链接？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T06:01:55.477

你可以使用这样的东西

```
var markerIcon = "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=U|00AAFF|000000";

if(isStoreOpen){
    markerIcon = "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=O|00FF00|000000";
}else{
    markerIcon = "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=C|808080|000000"
}

var marker = new google.maps.Marker({
      position: myLatlng,
      map: map,
      icon: new google.maps.MarkerImage(markerIcon)
  }); 
```

# c - 打开文件并分配给 char 时，不兼容的类型错误

> ID：15211720
> 
> 赞同：0
> 
> 时间：2013-03-04T21:44:57.587
> 
> 标签：c

我正在尝试查找大数的总和。（100 位，1500 位）

有我的求和函数：

```
char *find_sum(char *a, char *b) {
  char *res;
  int alen, blen, rlen;
  int carry;

  alen = strlen(a);
  blen = strlen(b);
  rlen = 1 + ((alen > blen) ? alen : blen);
  res = malloc(1 + rlen);
  if (res) {
    int oldlen = rlen;
    res[rlen] = 0;
    carry = 0;
    while (rlen) {
      int tmp;
      if (alen && blen) tmp = a[--alen] - '0' + b[--blen] - '0';
      else if (alen) tmp = a[--alen] - '0';
      else if (blen) tmp = b[--blen] - '0';
      else tmp = 0;
      tmp += carry;
      res[--rlen] = '0' + tmp % 10;
      carry = tmp / 10;
    }
    if (res[0] == '0') memmove(res, res+1, oldlen);
  }
  return res;
} 
```

如果我尝试如下所示，代码正在运行：

```
char a[] = "243432423423423";
char b[] = "74356348775345";
char *c;
c = find_sum(a,b);
printf("%s",c); 
```

但我想从文件中（按行）获取这些数字（a 和 b）。例如，我的 data.txt 有以下几行：

```
7326473264723672364723864762374236
32473264623748632784632784
432423432423423423
0
3248972389473289473289478923
4897238473247382
732468723647236478238423
0
432748932489327894723894798239
48327489237483278
0
32423423423423 
```

我想打开这个文件，读取每一行和所有数字的总和（如果达到 0 则停止并写入其他文件 sum.txt）

如果我尝试使用**fgets**从文件中添加值，则会出现类型不兼容的错误。

我的测试代码：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char *find_sum(char *a, char *b);

int main(int argc, const char *argv[])
{
    FILE *file;
    file = fopen("a.txt", "r");

    if (file != NULL){
        char *buf;
        char *buf1;
    char *sum;
        fgets(buf, 100, file);
        fgets(buf1, 100, file);

        sum = find_sum(buf, buf1);

        printf("%s",sum);

    }
    fclose(file);

    return 0;
}
char *find_sum(char *a, char *b) {
  char *res;
  int alen, blen, rlen;
  int carry;

  alen = strlen(a);
  blen = strlen(b);
  rlen = 1 + ((alen > blen) ? alen : blen);
  res = malloc(1 + rlen);
  if (res) {
    int oldlen = rlen;
    res[rlen] = 0;
    carry = 0;
    while (rlen) {
      int tmp;
      if (alen && blen) tmp = a[--alen] - '0' + b[--blen] - '0';
      else if (alen) tmp = a[--alen] - '0';
      else if (blen) tmp = b[--blen] - '0';
      else tmp = 0;
      tmp += carry;
      res[--rlen] = '0' + tmp % 10;
      carry = tmp / 10;
    }
    if (res[0] == '0') memmove(res, res+1, oldlen);
  }
  return res;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:11:56.500

您应该在 main 函数的开头（而不是在条件内）声明变量，并且必须为它们分配内存。最简单的方法是将它们声明为

```
int main(int argc, const char *argv[])
{
    char buf[100];
    char buf1[100]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:17:13.987

我猜你是gettign这个错误

```
36 D:\Projects\c_c++\so\find_sum\main.cpp invalid conversion from `void*' to `char*' 
```

在线

```
res = malloc(1 + rlen); 
```

`malloc`返回`void*`你需要为你分配内存的女巫的类型。要消除此错误，请以这种方式添加类型猫

```
 res = (char*) malloc(1 + rlen); 
```

然后您的代码将编译。

**编辑**

从文件中读取数字并将添加结果写入另一个输出文件

基本上你需要在一个循环中，读取两个操作数并进行加法，因为只有在找到包含 a`"0"`或到达的行后才必须停止添加`EOF`，你必须在下一个中读取下一个操作数循环并将前一个循环的总和添加到它，然后将结果存储回总和。在您达到`"0"`或`EOF`将文件总和写入输出文件之后。

另一种选择是将所有数字读入字符串数组，直到您到达`"0"`或`EOF`在一个步骤中，在下一步中您遍历所有红色数字，计算总和，然后将其写入输出文件。

这是第一个解决方案的示例实现

```
int main(int argc, const char *argv[])
{
    char buf[100] = "";    
    FILE *input_file = fopen("a.txt", "r");

    if (input_file) {
        FILE *output_file = fopen("r.txt", "w");
        if(output_file) {
            char *op1 = NULL, *op2 = NULL, *sum = NULL, *p_buf = NULL;

            do {
                // if we alredy have done an additin, copy (flat) that result to op1
                if(sum) {
                    printf("have sum %s\n", sum);
                    op1 = sum;
                }
                // if op1 does not point to a sum from previous addition, then attemp to read it from file
                if(! op1) { 
                    // read next operand and escape all "0"
                    do {
                        p_buf = fgets(buf, 100, input_file);
                        remove_new_line_ending(p_buf, buf);
                    } while(p_buf && 0 == strcmp(p_buf, "0"));

                    if(p_buf) {
                         printf("read op1 %s\n", buf);
                         op1 = strdup(buf);
                         sum = op1;
                    }
                }

                // read next operand
                p_buf = fgets(buf, 100, input_file);
                remove_new_line_ending(p_buf, buf);
                if(p_buf && 0 != strcmp(p_buf, "0")) {
                    printf("read op2 %s\n", buf);
                     op2 = strdup(buf);
                }

                // we have both op1 and op2 then make the addition
                if(op1 && op2) {
                    printf("have op1 and op2 %s\n", "");
                    sum = find_sum(op1, op2);
                } else {
                    if(sum) {
                        // if we have only op1 then it is the result from the previous addion and there is no operand left in the file
                        // then write the result to output file and reset all variables
                        printf("print sum %s to output file\n\n", sum);
                        fprintf(output_file, "%s\n0\n", sum);
                        free(sum);
                        sum = NULL;
                    }
                }
                free(op1);
                free(op2);
                op1 = NULL;
                op2 = NULL;

            } while(p_buf);

            fclose(output_file);

        } else {
            perror("r.txt");
        }

        fclose(input_file);
    } else {
        perror("a.txt");
    }

    return 0;
}

void remove_new_line_ending(char* line, char dest[])
{
     if(line) {
         int len = strlen(line);
         int i = 0;
         while(i < len && line[i] != '\r' && line[i] != '\n') {
             dest[i] = line[i];
             i++;
         }
         dest[i] = '\0';
     }
} 
```

**输入**

```
0
0
7326473264723672364723864762374236
32473264623748632784632784
432423432423423423
0
0
0
3248972389473289473289478923
4897238473247382
732468723647236478238423
0
0
432748932489327894723894798239
48327489237483278
0
32423423423423
0
0 
```

**输出**

```
7326473297196937420895929970430443
0
3249704858201833948240964728
0
432748932489376222213132281517
0
32423423423423
0 
```

# entity-framework - .net mvc 下拉列表选择的值未更新

> ID：15211726
> 
> 赞同：0
> 
> 时间：2013-03-04T21:45:14.587
> 
> 标签：entity-framework, html-select

我有两个模型定义如下：

```
public class Division
{
    public int DivisionID { get; set; }
    [Required]
    public string DivisionName { get; set; }
    public virtual Employee Contact{ set;get; }
    public virtual ICollection<Employee> Employees { get; set; }
}

public class Employee
{
  public int EmployeeID{ get; set; }
  public string Name{ get; set; }
  public virtual Division Division{set;get;}
} 
```

实体框架在部门表中设置了一个名为 的字段`employee_employeeid`，如何为部门表中的联系人属性创建员工下拉列表。

这是我尝试过的，但没有任何东西被发送到数据库。

```
ViewBag.contact = new SelectList(db.Employees,"EmployeeID","Name"); 
```

在我看来：

```
@Html.DropDownList("contact",String.Empty) 
```

我必须使用命名约定吗？

**编辑**

发布操作：

```
[HttpPost]
public ActionResult Edit(Division division)
{
    if (ModelState.IsValid)
    {
        db.Entry(division).State = EntityState.Modified;
        db.SaveChanges();
        return RedirectToAction("Index");
    }
    ViewBag.employeeid = new SelectList(
        db.Employees, "EmployeeID", "EmployeeFirstName", division.employee);

    return View(division);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:38:10.893

我建议您在模型中公开一个外键属性。它使绑定到下拉列表和以后的更新更容易。您的`Division`模型将如下所示：

```
public class Division
{
    public int DivisionID { get; set; }
    [Required]
    public string DivisionName { get; set; }
    [ForeignKey("Contact")]
    public int ContactId { set;get; }
    public virtual Employee Contact { set;get; }
    public virtual ICollection<Employee> Employees { get; set; }
} 
```

然后在 Edit GET 操作中填写`ViewBag`您所做的：

```
ViewBag.Contacts = new SelectList(
    db.Employees, "EmployeeID", "Name", division.ContactId); 
```

你有一个带有`Division`as 模型的强类型视图：

```
@model MyNamespace.Division 
```

在此视图中，您可以将下拉列表绑定到`ContactId`属性：

```
@Html.DropDownListFor(model => model.ContactId, ViewBag.Contacts) 
```

您的 POST 操作可能与您当前的版本类似：

```
[HttpPost]
public ActionResult Edit(Division division)
{
    if (ModelState.IsValid)
    {
        db.Entry(division).State = EntityState.Modified;
        db.SaveChanges();
        return RedirectToAction("Index");
    }
    ViewBag.Contacts = new SelectList(
        db.Employees, "EmployeeID", "Name", division.ContactId);

    return View(division);
} 
```

请注意，在许多情况下，更好的做法是（尤其是出于安全原因）为您的视图使用特殊的 ViewModel 而不是数据库实体。然后，您可以将`Contacts`集合合并到您的 ViewModel 中（而不是使用`ViewBag`）。要更新数据库中的实体，您将加载它并将 ViewModel 中更改的属性写入实体，然后保存它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:55:57.630

我建议实际使用`ViewData`而不是 ViewBag。在您的控制器中有以下内容：

```
var employees = db.Employees.Select(e => new DropDownItem{ Text = e.Name, Value = e.EmployeeID });
ViewData["Employees"] = employees; 
```

然后，在您看来，有以下显示它：

```
@Html.DropDownList("Contact", ((IEnumerable<DropDownItem>)(ViewData["Employees"]))) 
```

# php - 多种可能性的正则表达式

> ID：15211729
> 
> 赞同：1
> 
> 时间：2013-03-04T21:45:22.453
> 
> 标签：php, regex

我有一段代码对于用实际链接替换电子邮件地址非常有用。有时电子邮件地址有多个后缀（即：.co.uk 与 .com）。我能够为这些场景中的每一个创建正则表达式，但是我很好奇是否有任何正则表达式大师知道将两者组合成一个表达式的方法。如果是这样，您能否解释一下您的答案是什么以及为什么有效？

这是我当前的代码 -

```
$input = "here is a line of text, test@test.com, email@domain.com, email@domain.co.uk here";

preg_match_all('%\w+\@\w+\.\w+\.\w+%', $input, $matches);

$outmatch = Array();

if(is_array($matches[0])){
    foreach($matches[0] as $match){
        array_push($outmatch,$match);
    }
}

$outmatch = array_unique($outmatch);

if(is_array($outmatch)){
    foreach($outmatch as $outm){
        $input = str_replace($outm,'<a href="mailto:' . $outm . '">' . $outm . '</a>',$input);
    }
}

print $input; 
```

2 后缀的表达式：`%\w+\@\w+\.\w+\.\w+%`

1 后缀的表达式：`%\w+\@\w+\.\w+%`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:47:27.213

首先，我的目标不是在这篇文章中开发完美匹配的正则表达式来匹配电子邮件地址。我只是想帮助提问者一点点。:)

* * *

以下正则表达式至少匹配一个域及其 tld，但它允许多个子域。

```
preg_match_all('%\w+\@\w+\.\w+(\.\w+)?%', $input, $matches); 
```

所以它匹配：

```
test@test.com

test@sub.test.com

test@subsub.sub.test.com 
```

... 等等。但它不匹配：

```
test@test 
```

..因为缺少顶级域名。

* * *

进一步注意，一个有效的电子邮件用户名可以包含像点这样的字符`.`所以`\w`不会匹配所有可能的地址。所以一个更好的模式可能看起来像这样：

```
preg_match_all('%[a-zA-Z0-9._\%+-]+\@\w+\.\w+(\.\w+)?%', $input, $matches); 
```

* * *

进一步说明:) 一个有效的域名还可以包含数字和特殊字符，例如`-`. 这会产生一个像这样的正则表达式：

```
preg_match_all('%[a-zA-Z0-9._\%\+\-]+\@[a-zA-Z0-9\-]+\.\w+(\.\w+)?%', $input, $matches); 
```

* * *

进一步说明 :) :) 有效的电子邮件地址也可以如下所示：

```
test@192.168.0.1 
```

..没有域名。另请注意，任何没有 tld 的电子邮件地址都是有效的。您会看到创建一个真正*匹配*的电子邮件正则表达式并不那么容易。

我建议您从网络上获取一份经过详细说明的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:47:27.937

这可能对您有用：`%\w+\@(?:\w+\.)*\w+\.\w+%`

它允许尽可能多的子域或 TLD。这是它的[一个例子](http://regexpal.com/?flags=g&regex=%5Cw%2b%5C@%28?%3a%5Cw%2b%5C.%29%2a%5Cw%2b%5C.%5Cw%2b&input=person@site.com%0Aperson@site.co.uk%0Aperson@my.site.co.uk)。

意思是“子域出现零次或多次，`(?:\w+\.)*`后跟一个点”。这`(?:`使它不匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T21:47:36.853

使用交替;)

```
preg_match_all('%\w+\@\w+\.\w+\.\w+|\w+\@\w+\.\w+%', $input, $matches); 
```

# mysql - 运行 ubuntu 12.04 的 mysql 无法连接

> ID：15211732
> 
> 赞同：0
> 
> 时间：2013-03-04T21:45:45.023
> 
> 标签：mysql, ubuntu, xampp, mysql-error-2002

我是 linux 新手，我正在尝试在 Ubuntu 12.04 上安装 Mysql。（在同一台机器上）当我输入`machine@machine$ ./lampp start`时，它说 XAMPP-MYSQL 已经在运行。

但是，当我尝试访问 phpmyadmin 或键入时`machine@machine$mysql -u root -p`，我收到以下错误：

> “错误2002（HY000）：无法通过套接字'/var/run/mysqld/mysqld.sock'（2）连接到本地MySQL服务器”

这些命令可能会有所帮助：

```
machine@machine$ sudo netstat -tap | grep mysql
tcp        0      0 *:mysql                 *:*                     LISTEN      8401/mysqld 
```

# java - 在活动之间共享 ArrayList

> ID：15211734
> 
> 赞同：0
> 
> 时间：2013-03-04T21:45:47.283
> 
> 标签：java, android, list, arraylist

我在跨活动`List`的类中存储 a 时遇到问题。`Application`

在我的启动画面中，我正在将数据加载到`List`数据库`MySQL`中。

`List`是在一个名为`Rateit`that的类中`extends Application`。我在其中作为类变量执行此操作：

```
public static List<String> masterCats; 
```

在启动画面活动/类中，我这样做：

在`onCreate`：

```
Rateit.masterCats = new ArrayList<String>(); 
```

在我的 AsyncTask 循环中加载数据我这样做：

```
Rateit.masterCats.add(cat); 
```

`cat`是来自数据库的列表项。我有`Log.d`数据 ( `cat`) 以及 ListPosition 来检查它是否被添加到`List`并且它是。

但是，我需要在接下来获取相同的信息`Activity`并将其放入`adapter`. 它以 0 长度返回。

我只是这样做： `adapter = new MasterCatAdapter(getActivity(), Rateit.masterCats, tf);`

为什么列表不跨活动维护数据？这是因为它`static`吗？别的东西？

（注意：我很快就会在这里添加 getter 和 setter 方法！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:05:24.027

正如@A--C 在他的评论中提到的那样，避免使用您现在使用静态变量的模型。相反，我会做这样的事情：

```
private void yourMethodWhereYouGetYourData(){
    //get your data
    ArrayList<String> masterCats = new ArrayList<String>();
    masterCats.add(cat);

   //Assuming you're doing this synchronously, once you've gotten your data just do:
   Intent i = new Intent(this, YourActivity.class);
   i.putStringArrayListExtra("MasterCats", masterCats);
   startActivity(i);
} 
```

然后，在您的 new`Activity`或`onCreate()`任何地方，只需执行以下操作即可访问列表：

```
getIntent().getStringArrayListExtra("MasterCats"); 
```

@KickingLettuce 在评论中还提到了如果用户离开`Activity`. 因此，无论`Activity`您想在哪个位置保存 ArrayList，只需将其转换为以逗号分隔的字符串并将其保存在 SharedPreferences 中，如下所示：

```
private void saveCats(){
    //get your ArrayList from wherever (either as a global variable or pass it into the
    //method.
    StringBuilder sb = new StringBuilder();
    for(int i = 0; i < masterCats.size(); i++){
        if(i == masterCats.size() - 1)
            sb.append(masterCats.get(i));
        else
            sb.append(masterCats.get(i)+",");
    }

    SharedPreferences.Editor prefsEditor =
        PreferenceManager.getDefaultSharedPreferences(this).edit();
    prefsEditor.putString("MasterCats", sb.toString()).commit();

    //Note: in API 11 and beyond you can store a Set of Strings in SharedPreferences, so
    //if you are only targeting API 11+ you could do:
    Set<String> masterCatsSet = new LinkedHashSet<String>(); //<--using LinkedHashSet to preserve order
    masterCatsSet.addAll(masterCats);
    prefsEditor.putStringSet("MasterCats",masterCatsSet).commit();
} 
```

`onCreate`如果您希望在整个生命周期中保留列表，请在您的或其他东西中访问此 SharedPreference `Activity`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T09:42:30.313

将列表保存在应用程序扩展类中是个好主意，您可以通过以下方式实现它

在您的 App 类中如下声明列表，例如

```
public static List<String> masterCats; 
```

并为上述变量声明 setter 和 getter 方法

```
public List getMasterCatsList()
 {
    return masteCats;
 }

public Void setMasterCatsList(List list)
 {
    masteCats=list;
 } 
```

在您的 Loader 类中按如下方式获取应用程序对象，如下所示

Application application = (YOurClassName That Extends Application class) getApplication();

并将列表设置如下

```
 application.setMasterCatsList(List list); 
```

现在您可以从任何活动中访问此列表，如下所示

```
 Application application = (YOurClassName That Extends Application class) getApplication();

 List l = application.getMasterCatsList(); 
```

希望对你有帮助

# c++ - 为什么这在分成 2 行时不起作用？

> ID：15211735
> 
> 赞同：0
> 
> 时间：2013-03-04T21:45:54.337
> 
> 标签：c++

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T21:49:36.913

There is very little relation between the two snippets.

The first one declares and initializes the variable `lRoot`, nothing to see there.

The second snippet declares and default-initializes `lRoot` in the first line, but then it goes on to invoke [`operator()`](http://msdn.microsoft.com/en-us/library/kdte99aa%28v=vs.110%29.aspx) on `lRoot` with an argument of type `Ogre::root*`. Since `std::auto_ptr` [does not define](http://www.cplusplus.com/reference/memory/auto_ptr/) an `operator()`, the compiler produces the given error.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-04T21:53:34.930

The first statement is a declaration of variable `lRoot` with initialisation (using the syntax of initialiser in parentheses).

The second is a declaration of default-initialised variable `lRoot`, followed by invoking `operator()` on the variable. (Note that [`std::auto_ptr`](http://en.cppreference.com/w/cpp/memory/auto_ptr) doesn't define such an operator).

To split this into two lines (still as one statement), you can just insert a line break anywhere whitespace is allowed:

```
std::auto_ptr<Ogre::Root> lRoot(
  new Ogre::Root(lConfigFileName, lPluginsFileName, lLogFileName)); 
```

To actually split this into a declaration and assignment (note that when split, it cannot be an initialisation), you could do this:

```
std::auto_ptr<Ogre::Root> lRoot;
lRoot.reset(new Ogre::Root(lConfigFileName, lPluginsFileName, lLogFileName)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T21:47:44.197

They are not the same thing!

You are not just splitting the statement into two lines. The two are two different statements..

You can split the first statement onto two lines like this:

```
std::auto_ptr<Ogre::Root> lRoot
    (new Ogre::Root(lConfigFileName, lPluginsFileName, lLogFileName)); 
```

And it would compile just fine because the multiple white spaces are ignored.

# php - 使 phpmailer() 发送富文本或纯文本电子邮件 - 而不是 html

> ID：15211737
> 
> 赞同：0
> 
> 时间：2013-03-04T21:45:55.677
> 
> 标签：php, email, phpmailer, plaintext, richtext

我试图将消息发送到只接受富文本或纯文本电子邮件的邮件帐户。我知道这种`AltBody`方法，但我想将消息作为富文本或纯文本电子邮件发送。

我查看了文档但找不到答案，有人知道我如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:49:28.810

将 HTML（丰富）版本放置到普通正文，将纯文本版本放置到 AltBody。然后以 HTML 格式发送邮件。PhpMailer 将发送两个正文；能够显示 HTML 的客户端将显示它，其他客户端应显示纯文本版本。

# map - Hadoop：映射器没有从多个输入路径读取文件

> ID：15211738
> 
> 赞同：1
> 
> 时间：2013-03-04T21:45:55.740
> 
> 标签：map, hadoop, path, file-read

Mapper 无法从多个目录中读取文件。有人可以帮忙吗？我需要在每个映射器中读取一个文件。我添加了多个输入路径并实现了自定义 WholeFileInputFormat、WholeFileRecordReader。在 map 方法中，我不需要输入键。我确保每张地图都可以读取整个文件。

命令行：hadoop jar AutoProduce.jar Autoproduce /input_a /input_b /output 我指定了两个输入路径----1.input_a; 2.input_b;

运行方法片段：

```
Job job = new Job(getConf());
job.setInputFormatClass(WholeFileInputFormat.class);
FileInputFormat.setInputPaths(job, new Path(args[0]), new Path(args[1]));
FileOutputFormat.setOutputPath(job, new Path(args[2])); 
```

地图方法片段：

```
public void map(NullWritable key, BytesWritable value, Context context){
    FileSplit fileSplit = (FileSplit) context.getInputSplit();
    System.out.println("Directory :" + fileSplit.getPath().toString());
    ......
} 
```

自定义 WholeFileInputFormat：

```
class WholeFileInputFormat extends FileInputFormat<NullWritable, BytesWritable> {
    @Override
    protected boolean isSplitable(JobContext context, Path file) {
        return false;
    }

    @Override
    public RecordReader<NullWritable, BytesWritable> createRecordReader(
        InputSplit split, TaskAttemptContext context) throws IOException,
        InterruptedException {

        WholeFileRecordReader reader = new WholeFileRecordReader();
        reader.initialize(split, context);
        return reader;
    }
} 
```

自定义 WholeFileRecordReader：

```
class WholeFileRecordReader extends RecordReader<NullWritable, BytesWritable> {
    private FileSplit fileSplit;
    private Configuration conf;
    private BytesWritable value = new BytesWritable();
    private boolean processed = false;

    @Override
    public void initialize(InputSplit split, TaskAttemptContext context)
    throws IOException, InterruptedException {
        this.fileSplit = (FileSplit) split;
        this.conf = context.getConfiguration();
    }

    @Override
    public boolean nextKeyValue() throws IOException, InterruptedException {
        if (!processed) {

            byte[] contents = new byte[(int) fileSplit.getLength()];
            Path file = fileSplit.getPath();
            FileSystem fs = file.getFileSystem(conf);
            FSDataInputStream in = null;
            try {
                in = fs.open(file);
                IOUtils.readFully(in, contents, 0, contents.length);
                value.set(contents, 0, contents.length);
            } finally {
                IOUtils.closeStream(in);
            }
            processed = true;
            return true;
        }
        return false;
    }
    @Override
    public NullWritable getCurrentKey() throws IOException,InterruptedException {
        return NullWritable.get();
    }

    @Override
    public BytesWritable getCurrentValue() throws IOException,InterruptedException {
        return value;
    }

    @Override
    public float getProgress() throws IOException {
        return processed ? 1.0f : 0.0f;
    }

    @Override
    public void close() throws IOException {
        // do nothing
    }
} 
```

问题：

设置两个输入路径后，所有map任务只从一个目录读取文件。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T13:49:44.853

您必须使用`MultipleInputs`而不是`FileInputFormat`在驱动程序中。所以你的代码应该是：

```
MultipleInputs.addInputPath(job, new Path(args[0]), <Input_Format_Class_1>);
MultipleInputs.addInputPath(job, new Path(args[1]), <Input_Format_Class_2>);
.
.
.
MultipleInputs.addInputPath(job, new Path(args[N-1]), <Input_Format_Class_N>); 
```

因此，如果要`WholeFileInputFormat`用于第一个输入路径和`TextInputFormat`第二个输入路径，则必须按以下方式使用它：

```
MultipleInputs.addInputPath(job, new Path(args[0]), WholeFileInputFormat.class);
MultipleInputs.addInputPath(job, new Path(args[1]), TextInputFormat.class); 
```

希望这对你有用！

# javascript - 是什么阻止 Require'ed 脚本注入更多脚本标签

> ID：15211741
> 
> 赞同：1
> 
> 时间：2013-03-04T21:46:08.103
> 
> 标签：javascript, requirejs

我正在尝试在 AMD/Require 站点中使用一些较旧的脚本。其中一些较旧的脚本通过使用 document.write 或 document.writeln 标签来注入其他脚本。以下是正在发生的事情的简化形式：

**脚本1.js：**

```
console.log('script1');
document.writeln("<script src='script2.js'></script>"); 
```

**script2.js**

```
console.log('script2'); 
```

如果我以经典方式加载 script1，则 DOM 显示两个脚本标记都存在，控制台输出显示两者都已执行：

```
<head>
    <script src="script1.js"></script>
</head>
<body></body> 
```

但是如果我通过 RequireJS 加载 script1，DOM**只**显示script1 标签。控制台输出显示 script1**已**执行，但 document.writeln 显然被忽略，因此 script2 未添加到 DOM：

```
<head>
    <script src="require-jquery.js"></script>
    <script language="javascript">
        require( ['script1'], function( ) { } );
    </script>
</head>
<body></body> 
```

是什么阻止了这个额外的脚本被插入到 DOM 中？我怀疑即使上述工作正常，我也会在加载顺序方面遇到其他问题。但是我想了解这个漏洞，因为我知道 RequireJS 的不同之处在于阻止加载额外的脚本。

我正在使用 RequireJS 的 2.1.4 版本。Firefox 和 Chromium 上的行为相同。

编辑：我忘了提到，在真实场景中，“script2”的路径是动态的，基于一些服务器端逻辑，因为生成了第一个脚本。

EDIT2：我在尝试简化场景时掩盖了其他内容：我不能（轻松）更改这些旧库，因为它们由公司的不同部门控制并且基于服务器端逻辑部分是动态的（这又是，我不控制）。所以正如@ddotsenko 建议的那样，也许我应该改写这个问题：*如何采用一些依赖于注入脚本标签的遗留脚本，并使它们适合试图通过使用 AMD/RequireJS 做正确事情的站点的其余部分?* 建议的 shim 方法接近但不起作用，因为依赖关系未知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T05:55:53.517

问题是 document.write() 在页面加载后不起作用（并且 RequireJS 使用 XHR）。

但是您可以使用“shim”来预定义旧模块的依赖关系 - [http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)

**配置.js**

```
require.config({

    deps: ["main"],

    shim: {
        script1: {
            deps: ['script2'],
            exports: "someScript1Object"
        }
    }
}); 
```

**main.js**

```
require(
    [ "script1" ],
    function(someScript1Object) {
        // ...
    }
); 
```

控制台输出是

```
script2
script1 
```

**更新。第二种变体：覆盖 document.write / document.writeln**

您可以使用[ControlJS](http://controljs.org/)中的技巧- 覆盖 document.write。试试这个代码：

```
require.docwrite = function(text){
    var aMatches = text.match(/src='([^']*)/i) ||
        text.match(/src="([^"]*)/i) ||
        text.match(/src=([^ >]*)/i);
    if ( aMatches ) {
        var url = aMatches[1];
        require([ url ]);
    }
}

document.write = require.docwrite;
document.writeln = require.docwrite; 
```

# html - 谷歌浏览器中的 html5 saveAs 支持

> ID：15211742
> 
> 赞同：14
> 
> 时间：2013-03-04T21:46:09.587
> 
> 标签：html, google-chrome, html5-filesystem

我正在尝试使用[此处](http://updates.html5rocks.com/2011/08/Saving-generated-files-on-the-client-side)`saveAs`解释的界面

目前，我只担心谷歌浏览器，我使用最新的 Canary（版本 27.0.1429.0 canary）

Qn1：文章说。

> W3C 文件 API 包括一个 FileSaver 接口，这使得保存生成的数据就像 saveAs(data, filename) 一样简单，但不幸的是它最终会从规范中删除。

为什么会被删除？

Qn2：下面的代码。

```
if (window.saveAs) {
    window.saveAs(blob, name);
}else{
    console.log("saveAs not supported")
} 
```

印刷

```
saveAs not supported 
```

所以chrome不支持saveAs。这不是我在网上阅读很多文章的印象。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-14T19:38:35.480

这是一个 polyfill，如文章中所述。您必须加载文章中列出的 javascript 文件，将其保存在您的资源中并在您的代码中链接到它：存储库在那里： [https ://github.com/eligrey/FileSaver.js](https://github.com/eligrey/FileSaver.js)

不过，Chrome 有一些限制。如果文件已经保存，则新的保存名称会递增：myFile(1)，然后是 myFile(2)，等等。

我现在在 Chrome 上有一个错误，它告诉它不能打开文件，但这只是一个错误的警告，因为文件保存得很好，这就是重点。

# c++ - IOKit 和获取唯一 ID

> ID：15211748
> 
> 赞同：2
> 
> 时间：2013-03-04T21:46:33.517
> 
> 标签：c++, macos, iokit

我正在使用：IOServiceGetMatchingServices

```
kr = IOServiceGetMatchingServices(kIOMasterPortDefault,
IOServiceNameMatching("AppleUSBEHCI"), &io_objects); 
```

我正在寻找如何找到有关内部 HD 的信息，因为上面会探测 USB 设备。

我似乎找不到可以告诉我这一点的清单或任何东西。

本质上，我正在寻找一种从系统中获取唯一 ID 的方法。在 Windows 上，其他开发人员使用硬盘 ID。

任何人都可以阐明这些价值观吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:59:50.537

我相信您要做的是查看设备描述符，看看它是否有序列号。由设备提供序列号，如果提供了序列号，则该序列号可能不是唯一的。如果设备有自定义描述符，那里也可能有用。

请参阅以下描述符： [http ://www.beyondlogic.org/usbnutshell/usb5.shtml](http://www.beyondlogic.org/usbnutshell/usb5.shtml)

似乎有一个属性可以获取 HID 设备包装类上的序列号：

[https://developer.apple.com/library/mac/#documentation/IOKit/Reference/IOHIDBase_header_reference/Reference/reference.html#//apple_ref/doc/uid/TP40012400](https://developer.apple.com/library/mac/#documentation/IOKit/Reference/IOHIDBase_header_reference/Reference/reference.html#//apple_ref/doc/uid/TP40012400)

如果这不起作用，应该有一种方法可以直接访问 USB 设备并请求您需要的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:29:12.317

在命令行上，您可以使用该`ioreg`工具来探索 IO Kit 注册表。对于 Lion 或 Older，您还可以使用 Apple 硬件 IO 工具包中方便的 IORegistryExplorer GUI 工具。（它在山狮上崩溃）

对于查看内部硬盘驱动器属性，这是一个很好的开始：

```
ioreg -irc IOAHCIBlockStorageDevice -w 0 
```

在我的 MacBook Air 上产生：

```
+-o IOAHCIBlockStorageDevice  <class IORegistryEntry:IOService:IOBlockStorageDevice:IOAHCIBlockStorageDevice, id 0x100000216, registered, matched, active, busy 0 (472 ms), retain 7>
  | {
  |   "IOCFPlugInTypes" = {"24514B7A-2804-11D6-8A02-003065704866"="SMARTLib.plugin"}
  |   "device-type" = "Generic"
  |   "IOStorageFeatures" = {"Unmap"=Yes}
  |   "Device Characteristics" = {"Logical Block Size"=512,"Product Name"="APPLE SSD TS256C                        ","Medium Type"="Solid State","Physical Block Size"=512,"SATA Features"=23,"Serial Number"="        X06S10H7THRZ","Product Revision Level"="CJAA0201"}
  |   "Protocol Characteristics" = {"Physical Interconnect"="SATA","Physical Interconnect Location"="Internal"}
  |   "SMART Capable" = Yes
  |   "IOMinimumSegmentAlignmentByteCount" = 4
  | }
  | 
  +-o IOBlockStorageDriver  <class IORegistryEntry:IOService:IOStorage:IOBlockStorageDriver, id 0x100000219, registered, matched, active, busy 0 (471 ms), retain 8>
    +-o APPLE SSD TS256C Media  <class IORegistryEntry:IOService:IOStorage:IOMedia, id 0x10000021a, registered, matched, active, busy 0 (471 ms), retain 11>
      +-o IOMediaBSDClient  <class IORegistryEntry:IOService:IOMediaBSDClient, id 0x10000021b, registered, matched, active, busy 0 (0 ms), retain 6>
      +-o IOGUIDPartitionScheme  <class IORegistryEntry:IOService:IOStorage:IOPartitionScheme:IOGUIDPartitionScheme, id 0x10000021d, !registered, !matched, active, busy 0 (3 ms), retain 8>
        +-o EFI system partition@1  <class IORegistryEntry:IOService:IOStorage:IOMedia, id 0x100000263, registered, matched, active, busy 0 (0 ms), retain 9>
        | +-o IOMediaBSDClient  <class IORegistryEntry:IOService:IOMediaBSDClient, id 0x100000266, registered, matched, active, busy 0 (0 ms), retain 6>
        +-o Customer@2  <class IORegistryEntry:IOService:IOStorage:IOMedia, id 0x100000264, registered, matched, active, busy 0 (2 ms), retain 11>
        | +-o IOMediaBSDClient  <class IORegistryEntry:IOService:IOMediaBSDClient, id 0x100000267, registered, matched, active, busy 0 (0 ms), retain 7>
        +-o Recovery HD@3  <class IORegistryEntry:IOService:IOStorage:IOMedia, id 0x100000265, registered, matched, active, busy 0 (3 ms), retain 9>
          +-o IOMediaBSDClient  <class IORegistryEntry:IOService:IOMediaBSDClient, id 0x100000268, registered, matched, active, busy 0 (0 ms), retain 6> 
```

您可以通过 IOKit 用户库以编程方式获取这些属性，正如您已经为 USB 发现的那样。

在更高的层次上，一些信息也可以通过磁盘仲裁框架，通过[`DADiskCopyDescription`函数](http://developer.apple.com/library/mac/documentation/DiskArbitration/Reference/DADisk_header_reference/Reference/reference.html#//apple_ref/doc/uid/TP40011609-CHDADiskhFunctions-DontLinkElementID_4)获得。通过此函数公开的设备属性似乎没有记录在`DADisk.h`头文件之外，但它们是不言自明的，例如：

```
extern const CFStringRef kDADiskDescriptionDeviceGUIDKey;      /* ( CFData       ) */
extern const CFStringRef kDADiskDescriptionDeviceInternalKey;  /* ( CFBoolean    ) */
extern const CFStringRef kDADiskDescriptionDeviceModelKey;     /* ( CFString     ) */
extern const CFStringRef kDADiskDescriptionDevicePathKey;      /* ( CFString     ) */
extern const CFStringRef kDADiskDescriptionDeviceProtocolKey;  /* ( CFString     ) */
extern const CFStringRef kDADiskDescriptionDeviceRevisionKey;  /* ( CFString     ) */
extern const CFStringRef kDADiskDescriptionDeviceUnitKey;      /* ( CFNumber     ) */
extern const CFStringRef kDADiskDescriptionDeviceVendorKey;    /* ( CFString     ) */ 
```

# awk - 使用 awk 查找大于或等于 0.021 到 0 的值

> ID：15211751
> 
> 赞同：2
> 
> 时间：2013-03-04T21:46:38.577
> 
> 标签：awk

我有一个包含三个部分的大文件。它的一部分只有 3 列，然后它移动到图像部分，它有 5 列，然后是有 7 列的旋转部分（我只对更改旋转部分感兴趣）。我正在尝试`awk`生成一个将所有负值更改为`0`并且所有正数大于`0.2`to的文件`0`。我关心的值仅在第 7 列中，并且必须在包含单词的行中`ROTATION`。

这是我的尝试。

```
awk BEGIN '/ROTATION/ {if (function abs($7) > = 0.021) $7=0; print}' awktest.tlt > awktest1.tlt 
```

我需要 awk 将其余数据也保留在那里，而不仅仅是产生从 X 到 0 的变化。

至于执行它，我正在使用`awk -f fix.awk awktest.tlt`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:50:37.270

这将做到：

```
awk 'NF==7&&/ROTATION/{if($7<0||$7>0.2)$7=0}1' file 
```

# performance - 每个页面上加载时间都很慢的网站

> ID：15211752
> 
> 赞同：0
> 
> 时间：2013-03-04T21:46:42.997
> 
> 标签：performance, wordpress

[http://www.puppykisses.org/](http://www.puppykisses.org/)

我为客户制作了一个 WordPress 页面，由于某种原因，加载页面需要一分钟多的时间。我唯一能想到的问题是他在主页顶部的滑块中插入的照片数量。看起来所有这些图片都需要在弹出任何其他内容之前加载。但是然后我点击联系人或任何其他没有真实图像的页面，问题仍然存在。只是想知道是否有人可以指出我正确的方向来解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:01:06.807

Like @David said, its the initial request (the source for the page) that is giving you the issues. This means it is unlikely an issue with hosting, and most likely an issue with your code. I would go through any plugins you have installed and disable them one-by-one, and slowly start commenting out your own custom dynamic code bit by bit, till you see what is taking so incredibly long. Then rewrite/excise that code from the site.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T05:18:57.687

**从基础开始**

*   将您使用的 WordPress 插件数量保持在最低限度
*   获取合适的托管服务提供商
*   从 WordPress 标头中删除不必要的代码 -> [http://goo.gl/yfRcF](http://goo.gl/yfRcF)
*   使用 firebug 并单击 Network 选项卡以检查每个文件的加载速度
*   检查如何提高网站速度的建议 -> [http://goo.gl/FtiX3](http://goo.gl/FtiX3)
*   安装 WP Super Cache 插件 -> [http://wordpress.org/extend/plugins/wp-super-cache/](http://wordpress.org/extend/plugins/wp-super-cache/)

**如果您使用图库，请尝试使用图像缩略图而不是加载整个图像大小*

# visual-studio-2012 - 在 Visual Studio 2012 中更新帮助文件时权限不足

> ID：15211754
> 
> 赞同：5
> 
> 时间：2013-03-04T21:46:55.203
> 
> 标签：visual-studio-2012

我有 Visual Studio 2012 Ultimate，我已经从 MSDN 下载了 Visual Studio 2012 ISO。尝试安装文档时：

我以管理员身份打开 Visual Studio

![Visual Studio 以管理员身份打开](../Images/2efcb47d1a7390b22afd0832dae16925.png)

按照安装的自述文件遵循这些说明

> 在 Visual Studio 2012 的菜单栏上，选择帮助、添加和删除帮助内容。
> 
> Help Viewer 2.0 启动，显示“管理内容”选项卡。在管理内容选项卡上，选择磁盘选项按钮，选择浏览 (...) 按钮，然后导航到 DVD 驱动器。
> 
> 选择 helpcontentsetup.msha 文件，然后选择打开按钮。
> 
> 在可用文档下，将显示 DVD 中可用内容集的列表。
> 
> 选择要安装到本地计算机上的内容集旁边的添加链接。您指定的项目出现在 Pending Changes 列中。您可以通过选择项目旁边的“X”从 Pending Changes 列中删除项目。选择更新按钮。

![更新就绪](../Images/64fe8db71cad0bf7d89e80ebdf8d4090.png)

然后单击更新。

当我单击更新时，它会进行大约 3-4 秒，然后失败并出现错误：

> 执行请求的任务时发生以下错误：
> 
> 更新内容时出错。您没有足够的权限来完成此任务。

![权限不足](../Images/02109c6ae35f9bf64b03bd95a7e42ff4.png)

我该如何解决这个问题？

**更新**

我在管理员模式下运行帮助查看器。

![在此处输入图像描述](../Images/a32983f0425d40258b72260d9a0ef906.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-16T10:16:01.267

尝试这个。它解决了我的问题。

1.  将 vs2012doc.iso 的安全权限更改为完全控制您的帐户。
2.  安装它
3.  一个接一个地安装文档。一个接一个记住。

能帮上忙吗...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T22:15:02.773

更改您的机器日期，然后重试。就我而言，使用“oct/01/2012”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-07T13:04:03.077

这是使用 Visual Studio 2013，但可能类似于 Visual Studio 2012 和可能 2015 的帮助。我没有尝试过，所以你告诉我。

我在 vs2013 的帮助下直接将 ISO 拿到了微软。现在我不记得地址了，所以我没有把它放在这里。用google查找很容易。

当我以本地安装方式使用 Microsoft Help Viewer 2.1 时，出现错误：权限不足，未安装书籍。

我将描述的内容可以让您更轻松地做到这一点。但我无法验证它，然后他们描述了我这样做的步骤。

我做的第一件事是将 ISO 的全部内容复制到我的硬盘上的一个文件夹中，以方便我的情况。`C:\T`

使用命令提示符导航到从 iso 内容复制它的文件夹，然后`C:\T\Packages`运行以下命令`winrar t * .cab`

这会导致测试 winrar 制作所有 cab 文件，并在其中任何一个文件损坏时提出抗议。

这是为了对那些不得不再次关闭的文件进行评分，在我的情况下，只有一个有问题的 .cab 文件

**v2Visual_Studio_2011_NET_Framework_4_B1545_VS_100_en-us_13(b0ba5cce-2b72-f582-80f3-8a6165ef6b9b).cab**

以下是直接从微软这个方向下载的，   [http ://packages.mtps.microsoft.com/v2Visual_Studio_2011_NET_Framework_4_B1545_VS_100_en-us_13(b0ba5cce-2b72-f582-80f3-8a6165ef6b9b).cab](http://packages.mtps.microsoft.com/v2Visual_Studio_2011_NET_Framework_4_B1545_VS_100_en-us_13(b0ba5cce-2b72-f582-80f3-8a6165ef6b9b).cab)

我认为所有其他软件包也都在那里。

接下来是用新的和最后一步替换损坏的文件是进入 Visual Studio 帮助文件所在的文件夹，在我的情况下，我总是将此文件夹放在对我来说舒适的地方。

```
D:\VS_2012_2013_HLP\VisualStudio12 
```

这个文件夹里面还有另外两个`\Incoming\Cab`，一定要保证cab文件夹是空的。

最后一件事是进入 Microsoft Help Viewer 2.1 并说新发电厂是我们复制 ISO ( `D:\T\helpcontentsetup.msha`) 内容的地方。剩下的就是安装书籍..

# json - 如何使用 net.sf.json 库解析输入流

> ID：15211757
> 
> 赞同：2
> 
> 时间：2013-03-04T21:47:02.250
> 
> 标签：json

以下是我在对 Http API 格式发出 get 请求后得到的 Json 响应，

```
[{"name":"test","tracing":false},{"name":"dyn1","tracing":false},
{"name":"dyn2","tracing":false},{"name":"esb","tracing":false}] 
```

您能否发布一个示例代码来解析此 json 对象以获取具有名称和跟踪的单个 Host 对象。

谢谢，

阿莫尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:16:14.103

```
String myDataAsAString = "[{\"name\":\"test\",\"tracing\":false},{\"name\":\"dyn1\",\"tracing\":false},
{\"name\":\"dyn2\",\"tracing\":false},{\"name\":\"esb\",\"tracing\":false}]";

JSONArray hostArray = JSONArray.fromObject(myDataAsAString);

for(int i = 0; i < hostArray.size(); i++)
{
    JSONObject hostObject = hostArray.getJSONObject(i);
    String hostName = hostObject.getString("name");
    boolean tracing = hostObject.getBoolean("tracing");
    ...your code for each element here
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-04T22:41:07.537

您可以使用 GSON 库[http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

尝试：

```
import com.google.gson.Gson;

public class Test {

  public static void main(String[] args){
    String json = "[{'name':'test','tracing':false},{'name':'dyn1','tracing':false},\n" +
            "{'name':'dyn2','tracing':false},{'name':'esb','tracing':false}]";
    HostObj[] hostObjects = new Gson().fromJson(json, HostObj[].class);
  }

  class HostObj {

    private String name;
    private boolean tracing;

    HostObj() {
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        name = name;
    }

    public boolean isTracing() {
        return tracing;
    }

    public void setTracing(boolean tracing) {
        tracing = tracing;
    }
  }
} 
```

# ruby-on-rails - 抢救 DelayedJob 工作人员中的“RecordNotFound”错误

> ID：15211759
> 
> 赞同：0
> 
> 时间：2013-03-04T21:47:10.623
> 
> 标签：ruby-on-rails, delayed-job, rescue

我使用 DelayedJob 在后台处理某些任务。

例如，在我的应用程序中，用户可以“点赞”一条消息，当这种情况发生时，发帖人会收到通知。此通知在后台处理。

有时，可能发生的情况是点赞者决定在通知发出之前撤消他的操作并删除他的“点赞”。在这些情况下，后台代码会遇到“RecordNotFound”错误，因为“like”不再存在。

我以为我是通过挽救错误来处理这种情况的（这里的 self 是 Like）：

```
 def send_push_notifications
    begin
      user = self.message.user
      message = "#{self.user.name} liked your workout"
      Urbanairship::push_now(user, message, ["message", self.message.id]) if self.user != user
    rescue ActiveRecord::RecordNotFound
      # Do nothing
    end
  end 
```

然而，实际上这似乎并没有挽救错误，因为我仍然在我的日志中看到这样的错误：

```
{ActiveRecord::RecordNotFound, class: Like , primary key: 1557 
/app/vendor/bundle/ruby/1.9.1/gems/delayed_job-3.0.2/lib/delayed/serialization/active_record.rb:12:in `rescue in yaml_new'
/app/vendor/bundle/ruby/1.9.1/gems/delayed_job-3.0.2/lib/delayed/serialization/active_record.rb:6:in `yaml_new'
/usr/local/lib/ruby/1.9.1/syck.rb:135:in `transfer'
/usr/local/lib/ruby/1.9.1/syck.rb:135:in `node_import'
/usr/local/lib/ruby/1.9.1/syck.rb:135:in `load'
/usr/local/lib/ruby/1.9.1/syck.rb:135:in `load' 
```

任何想法为什么我的救援声明在这种情况下不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T18:45:33.477

Like 对象不存在，因此甚至没有调用具有救援的方法。

尝试将您的延迟方法定义为类方法，而不是实例方法。这样，延迟作业将能够执行该方法，即使该实例不存在。例如，

```
class Like < ActiveRecord::Base

...

def self.send_push_notifications(like_id=nil)
  begin
    like = Like.find like_id
    user = like.message.user
    message = "#{like.user.name} liked your workout"
    Urbanairship::push_now(user, message, ["message", like.message.id]) if like.user != user
  rescue ActiveRecord::RecordNotFound
    # Do nothing
  end
end

...

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-27T17:47:40.363

我终于通过使用类方法而不是延迟调用的实例方法解决了这个问题。让我以示例的方式向您展示。以下是我之前构建延迟调用的方式：

```
 def background_send_push_notifications
    self.delay.send_push_notifications
  end

  def send_push_notifications
    message = "#{self.user.name} liked your workout"
    ...
  end 
```

我一直遇到的问题是，用户在喜欢某件事后立即不喜欢是很常见的。这意味着当delayed_job 尝试执行时，Like 对象不再存在，并且我会收到很多“RecordNotFound”错误。

现在，我已将延迟调用转换为在后台执行对象查找并在对象不再存在时返回的类方法。这是新结构

```
 def background_send_push_notifications
    Like.delay.send_push_notifications(self.id)
  end

  def self.send_push_notifications(id)
    like = Like.find_by_id(id)
    like.send_push_notifications unless like.nil?
  end

  def send_push_notifications
    message = "#{self.user.name} liked your workout"
    ...
  end 
```

希望这对某人有帮助！

# algorithm - 在 oracle 中生成 16 位随机数

> ID：15211769
> 
> 赞同：1
> 
> 时间：2013-03-04T21:47:34.720
> 
> 标签：algorithm, oracle, bigdata

我必须编写在`registered_security_numbers`. 我知道安全号码的前 6 位数字是**1234 11**或**1234 12**，其余 10 位数字是随机生成的。

我有两种可能的解决方案：

1.  编写第二个程序，生成所有可能的安全号码并将它们插入`possible_security_numbers`表中，设置属性`free=1`。然后，当我收到注册新安全号码的请求时，我会在`possible_security_numbers`表中查询一个随机安全号码，该号码是免费的，并将其插入`registered_security_numbers`.

2.  每次收到注册安全号码的请求时，我都会从 **1234 1100 0000 0000 - 1234 1299 9999 9999**`registered_security_numbers`范围内生成随机数，直到获得安全号码，该号码在表格中不存在 并将其插入`registered_security_numbers`.

(1) 我不喜欢的方法，因为`possible_security_numbers`表将包含数十亿个条目，我不确定它有多好或选择/更新可以运行多快。

（2）我不喜欢的方法，因为如果我在`registered_security_numbers`表中有很多记录，从一个范围内生成随机数可能会重复很多次。

我想知道是否有人有其他解决方案或可以评论我的解决方案，这对我来说似乎很糟糕......</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:02:32.760

您实际上要生成多少个数字？

想象一下，您最多将生成 100 万 (10^6) 个数字。如果是这样，您需要生成第二个随机数的几率大约是 10^-5 中的 5（0.00005 或 0.005%）。如果是这种情况，那么担心偶尔生成第二个数字的费用或几乎不可能生成第三个数字是没有意义的。第二种方法会更有效率。

另一方面，假设您打算随着时间的推移生成 10 亿个数字。如果是这种情况，那么到最后，您需要生成第二个数字的几率是 5%，并且您需要合理频繁地生成 3 或 4 个数字。在这里，权衡取舍要困难得多。根据业务的不同，捕获唯一约束违规异常并在某些调用上生成多个号码对性能的影响可能会导致服务经常违反 SLA，而枚举有效号码可能更有效。

另一方面，假设您打算随着时间的推移生成所有 200 亿个数字。如果是这种情况，到最后，您预计必须生成 100 亿个随机数，然后才能找到剩余的一个有效数字。如果是这种情况，明显的优势将是枚举所有可能的数字并跟踪已使用的数字的第一个选项。

# geolocation - 地球经纬度到 3D 球体上的纬度和经度

> ID：15211776
> 
> 赞同：2
> 
> 时间：2013-03-04T21:47:51.573
> 
> 标签：geolocation, geometry

我以前从未做过这种事情，但我正在做的是制作一个类似形状的 3D 球体（具有地球般的纹理），我想使用特定位置的谷歌地图中的纬度和经度在其上绘制位置。现在我想知道，我的球体半径明显小于地球半径，这仍然会影响纬度和经度值的位置到 xyz 给定以下公式：

```
tx = radiusOfSphere * cos(latitude) * cos(longitude);
ty = radiusOfSphere * -sin(latitude);
tz = radiusOfSphere * cos(latitude) * sin(longitude); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:08:31.673

是的。

*   tx^2 + ty^2 + tz^2 = radius^2 & math = radius^2，所以你在你的球体上。
*   如果纬度=0，那么ty = 0，所以你在一个平行于赤道的圆上。
*   如果经度 = 0，则 tz = 0，所以你在子午线上。

只需检查您是否在*xyz*而不是*xzy*或*zyx*，并且 North 是 x>0 和 East y>0，或者任何与您的 3D 渲染软视点兼容的标志。

# c# - 简单的银行程序，有 2 种我无法完全解决 C# 的方法

> ID：15211777
> 
> 赞同：2
> 
> 时间：2013-03-04T21:47:52.847
> 
> 标签：c#

我正在创建一个具有这两种我无法弄清楚的方法的程序。它们是“提款”和“存款”，它们位于 CheckingAccount 类中。在这些方法中，我希望最初的值为 0 然后添加到它。然后我想取新数字并从中减去。我想“存入”250 美元。然后我想“提取” 98 美元。我不确定在哪里存储这些值以及如何执行它们。当我将提款和存款方法留空时，我知道显示应该如何结束。

账户类：

```
class Account
{
    protected string firstName;
    protected string lastName;
    protected long number;

    public string FirstName
    {
        set
        {
            firstName = value;
        }
    }
    public string LastName
    {
        set
        {
            lastName = value;
        }
    }
    public long Number
    {
        set
        {
            number = value;
        }
    }
    public override string ToString()
    {
        return firstName + " " + lastName + "\nAccount #: " + number;
    }
}
} 
```

支票账户类：

```
 class CheckingAccount : Account
{
    private decimal balance;

    public CheckingAccount(string firstName, string lastName, long number, decimal initialBalance)
    {
        FirstName = firstName;
        LastName = lastName;
        Number = number;
        Balance = initialBalance;
    }
    public decimal Balance
    {
        get
        {
            return balance;
        }
        set
        {
            balance = value;
        }
    }

    public void deposit(decimal amount)
    {
        //initial value should be 0 and should be adding 250 to it.
    }
    public void withdraw(decimal amount)
    {
        //this takes the 250 amount and subtracts 98 from it
    }

    public void display()
    {
        Console.WriteLine(ToString());
        Console.WriteLine("Balance: ${0}", Balance);
    }
}
} 
```

展示类：

```
 class Display
{
    static void Main(string[] args)
    {

        CheckingAccount check = new CheckingAccount("John", "Smith", 123456, 0M);

        Console.WriteLine("After Account Creation...");
        check.display();

        Console.WriteLine("After Depositing $250...");
        //constructor
        Console.WriteLine("After Withdrawing $98...");
        //constructor
    }
}
} 
```

我希望我的输出看起来像这样：

创建帐户后...
John Smith
帐户编号：123456
余额：0

存入 250 美元后...
John Smith
帐号：123456
余额：250

提取 98 美元后...
John Smith
帐号：123456
余额：152

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T21:51:02.287

简单的答案是

```
public void deposit(decimal amount)
{
    balance += amount;
}
public void withdraw(decimal amount)
{
    balance -= amount;
} 
```

随意添加必要的验证（透支？试图存入负数？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:53:59.220

要创建帐户：

```
Checking Account ca = new Checking Account (John, Smith, 123456, 0); 
```

存入 250 美元：

```
ca.deposit(250); 
```

提取 98 美元：

```
ca.withdraw(98); 
```

商业逻辑：

```
public void deposit(decimal amount)
{
    balance += amount;
}
public void withdraw(decimal amount)
{
    balance -= amount;
} 
```

正如另一个[答案](https://stackoverflow.com/a/15211826/1121302)所述，当您的帐户中没有钱（或更少）时验证透支或提款等场景是明智的！

* * *

奖金：

您还可以编写一个 GetBalance 函数来验证存款/取款。

```
public decimal GetBalance(long accountNumber)
{
    return balance;
} 
```

并使用以下方法调用它：

```
var currentBalance = ca.GetBalance(123456); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T22:10:07.190

您可能希望为提款方法提供额外的逻辑以防止透支。

```
public void withdraw(decimal amount)
{
    if (balance >= amount)
    {
       balance -= amount;
    }
    else
    {
       Console.WriteLine("You can't withdraw money that you don't have!");
       // or else you could charge an overdraft fee as long as you're within 
       // a certain tolerance (minimum of -1000 or something like that). 
    }
} 
```

# html - 画布我应该使用带有 html5 行的 beginpath()

> ID：15211779
> 
> 赞同：4
> 
> 时间：2013-03-04T21:48:02.390
> 
> 标签：html, canvas, geometry

我知道你可以`beginpath();`在画布上使用圆圈。但是，根据我所学到的，您不需要将它与线条一起使用。我有时不将它与线条一起使用，它工作得非常好，与添加相同`beginpath()`，仍然可以正常工作。但是我应该使用`beginpath();`线条吗？如果是这样，还有什么？这是一个好习惯还是坏习惯，告诉我你知道的一切。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:58:02.523

**是的，使用 beginPath()**

beginPath() 告诉画布你即将开始一条新路径——而 toLine() 是一个路径过程。如果没有 beginPath()，您的下一张图纸将渗入您之前的图纸，因为 canvas 认为您仍在继续之前的图纸。其他路径图也是如此，例如 arc、arcTo、quadraticCurveTo 等。

# jquery - 从默认选项的选择菜单中运行 JQuery 功能

> ID：15211784
> 
> 赞同：0
> 
> 时间：2013-03-04T21:48:12.140
> 
> 标签：jquery, forms

Let's say you have a select menu that does some sort of jQuery when an option is selected

```
<select class="doThis">
    <option selected="selected">Do This</option>
    <option>Do That</option>
    <option>Do That Other Thing</option>
</select> 
```

运行它的 jQuery 是这样的：

```
$(".doThis").change(function () {
     //Code
}); 
```

这一切都很好，但是如果某些人使用下拉菜单选择已选择的选项，您如何让该功能运行？“执行此操作”选项。由于“执行此操作”已经存在，因此没有任何更改，并且该功能不会触发。我怎样才能生这火？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:49:57.483

您可以使用：

`$(".doThis option").on('click',function(){ })`

或者

有你的功能并添加这个功能：

`$(".doThis option[selected=selected]").click(function(){})`

# tfs - 还原和升级后查找 TFS 项目门户

> ID：15211787
> 
> 赞同：1
> 
> 时间：2013-03-04T21:48:24.113
> 
> 标签：tfs, import

我们正在尝试从 TFS 2010 升级到 2012。我们为新服务器配备了所有新硬件，因此我们进行了迁移和升级。我们的 SharePoint 服务器配置了 TFS 扩展。TFS 2012 安装顺利，TFSRestore 正常运行，TFSConfig 导入正常运行。所有项目门户网站（例如[https://projects.example.com/sites/MyProject](https://projects.example.com/sites/MyProject)）都可以通过 URL 访问和导航。

我们可以在 Team Explorer 中浏览项目并转到[http://tfs.example.com:8080/tfs/DefaultCollection/MyProject](http://tfs.example.com:8080/tfs/DefaultCollection/MyProject)。但是项目站点中没有“转到项目门户”链接，并且项目的门户设置中没有列出 url。

问题一：我的项目门户设置真的没有了吗？

问题2：有没有办法以编程方式恢复这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:56:04.583

在过去的一天中，我们发现了一些有趣的事情。ALM Rangers 的升级指南似乎表明 SQL Server 2005 不能用于就地升级，因此我们使用了我在问题中提到的手动备份/恢复/tfsconfig 导入。

我们的一位 DBA 查看了 2005 年的数据库并问道：“为什么不直接将这些迁移到 2008 R2 并从 TFS 安装程序运行升级选项？” 我们经历了这个，向导转换了我们所有的项目并毫无问题地维护了他们的门户 URL。

# css - Wordpress 中的水平滚动达到最大宽度

> ID：15211789
> 
> 赞同：2
> 
> 时间：2013-03-04T21:48:35.957
> 
> 标签：css, wordpress, horizontal-scrolling

这真让我抓狂。我正在 Wordpress 中构建一个新的水平滚动网站。页眉和页脚是简单的固定元素，但页面内容是水平滚动的。我不是试图在帖子中这样做，而是作为一个页面。一切正常，直到我达到一定的宽度，然后我的图像创建了一个新行，打乱了整个页面的流程。然后它也会隐藏页脚。我已经在多个浏览器中查看过这个，并且被困在做什么。我不应该可以随心所欲地水平滚动吗？好像我在我的网站上达到了某种最大宽度。

这里看起来[不错](http://www.matthewniederhauser.com/counterfeit-paradises-good/)，然后如果我使用 div 以相同的方式添加另外两个图像，它会跳过一行并将所有内容都搞砸并且看起来很[糟糕](http://www.matthewniederhauser.com/counterfeit-paradises-bad/)。

请帮忙。这是相关的CSS：

```
/************************* GLOBAL STYLES ***************************/
body {color:#eee; background: #000000}
.container-inner {position:relative; overflow:auto}
.container {background:#111; position:relative; overflow:auto}
h1,h2,h3,h4,h5,h6 {color:#eee;}
h1 a,h2 a,h3 a,h4 a,h5 a,h6 a {color:#eee;}
h3.sub,h2.sub {margin: 0 0 10px 0;padding: 0 0 5px 0;font-size: 1.9em;font-weight: bold;line-height: 1em;text-transform: uppercase;letter-spacing: 2px;color: #515151;border-bottom: 1px solid #000;}
a {color:#428ce7;text-decoration:none;}
a:hover, a:focus {color:#fff;}
p {color:#eee;}
h6.top {color:#ccc;}
.login {float:left;}

/* Posts */
.content {font-size: 1.2em; position:relative; overflow:auto}
.content h2 {font-size:1.5em; border: 3px solid white; text-align: center; padding: 2px;}
.post {display:block;font-size: 1.2em;}
.post h4, .post h6 {font-size: 1.2em;}
.post h2 {font-size:1.5em; border: 3px solid white; text-align: center; padding: 2px;}
.postmetadata {background:#000;padding:1em;color:#999; font-size:10px;-moz-border-radius: 5px;-khtml-border-radius: 5px;-webkit-border-radius: 5px;border-radius: 5px;}
.postmetadata a {}
.postmetadata a:hover {color:#fff;}
.underlined {border-bottom:1px solid #eee;}
h6.underlined {margin:0 0 1em;}
.welcomebox {padding:1.5em;margin-bottom:1.5em;color:#eee;text-shadow: 1px 1px 1px #000}

.nav-image-left, .nav-image-up, .nav-image-right {text-align:center;float:left;width:25px;margin:0 10px 0 2px;}
.nav-image-left a, .nav-image-up a, .nav-image-right a {background:#eee;padding:2px 48% 2px 48%;text-decoration:none;color:#000;}
.nav-image-left a:hover, .nav-image-up a:hover, .nav-image-right a:hover {background:#000;color:#fff;}
.nav {background:#eee;margin:0 0 1em 0;-moz-border-radius: 5px;-khtml-border-radius: 5px;-webkit-border-radius: 5px;border-radius: 5px;}
.nav:hover {background:#ccc;}
.prev a, .next a {color:#222;text-decoration:none;padding:.2em 1em;}

.nav-interior {margin:0;padding:0;clear:both;display:inline;}
.nav-interior .next {color:#000;text-decoration:none;float:right;}
.nav-interior .prev {color:#000;text-decoration:none;float:left;}

/* Paragraph */
#paragraph {margin:0px 30px 0px 30px; text-align:justify;}

/* Horizontal Scroll */
#wrapper {
    float:left;
    margin:40px 20px 30px;
    margin-right:-999em;
    position:relative;
    overflow:auto;
}

.floatbox {
    float:left; 
    margin:0 20px 0 0;
    white-space:nowrap;
}

.floatbox img {float:left;}

.floatboxtext {
    width:480px;
    float:left;
    margin:20px 60px 0 40px;
    font-family:"Courier New", Courier, monospace;
    text-align:justify;
    font-size:.8em;
    overflow:hidden;
}

/* Footer */
#footer {padding:1.5em 0; margin:0 auto; color:#999; text-align:center; border-top:2px solid #333; position:fixed; width:100%}
#footer p {color:#999}
#footer h3 {margin:0;padding:0 0 .4em 0; border-bottom:none; color:#999} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:06:53.847

我*不*知道这是如何工作的，但至少对我有用：

```
#wrapper {
    margin-right:-999em;
} 
```

到：

```
#wrapper {
    margin-right: -99999em;
} 
```

你的例子盯着工作`-1080em`，所以我假设`margin-right`确定它的最大宽度。我把它说成是`-99999em`因为它看起来足够大，你可以增加它。

# bash - bash shell脚本将具有特定扩展名的第一个文件复制到当前目录

> ID：15211792
> 
> 赞同：4
> 
> 时间：2013-03-04T21:48:54.327
> 
> 标签：bash, shell

我有一个包含多个 .c 源文件的目录，我试图在另一个目录中编写一个 shell 脚本，该脚本将从前一个目录复制第一个 .c 文件，编译它，运行它，然后删除它。现在我了解了如何编译、运行和删除文件，但是当目录中有多个具有相同扩展名的文件时，如何在不知道其名称的情况下只获取一个 .c 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:50:39.127

一种方法是使用循环，然后在第一次迭代后中断：

```
for f in dir/*.c; do
    cp "$f" .
    # compile
    # run
    # delete
    break
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:59:48.980

您尚未指定如何定义“第一个”，但您可以使用`set`：

```
set -- source_dir/*.c
cp "$1" .
# ...
rm "$1" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T22:01:13.483

假设您所说的“第一个”是指排序列表中的第一个文件。

for 循环可以正常工作，但您也可以这样做：

```
file=`ls -1 dir/*.c | head -1`
# compile $file && run $file && delete $file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T00:02:10.733

在 bash 中，您可以使用数组：

```
files=(*.c)
echo "compiling ${files[0]}"
compile ${files[0]} 
```

# asp.net - 在带有 DataTable 的 DataGridView 中显示 LINQ 查询结果

> ID：15211793
> 
> 赞同：0
> 
> 时间：2013-03-04T21:49:01.340
> 
> 标签：asp.net, entity-framework, linq, datatable

我有一个包含 LINQ 查询并将结果作为 DataTable 返回的函数。我在使用返回的 DataTable 填充 DataGridView 时遇到问题。查询应该返回一些数据，但表看起来是空的。我的功能如下：

```
public static DataTable GetEmployeeTimesheets(int employeeId)
{
    DataTable table = new DataTable();

    using (PTMS_DataEntities entities = new PTMS_DataEntities())
    {
        var timesheets = from timesheet in entities.Timesheets
                         join timesheetTask in entities.Timesheet_Task
                         on timesheet.Id equals timesheetTask.Timesheet_Id
                         join task in entities.Tasks
                         on timesheetTask.Task_Id equals task.Id
                         join project in entities.Projects
                         on task.Project_Id equals project.Id
                         join department in entities.Departments
                         on project.Department_Id equals department.Id
                         where timesheet.Employee_Id == employeeId
                         select new
                         {
                             date = timesheet.Date,
                             taskName = task.Name,
                             projectName = project.Name,
                             projectDesc = project.Description,
                             departmentName = department.Name,
                             taskEstimatedHours = task.Estimated_Hours,
                             timesheetHours = timesheetTask.Hours
                         };

        table.Columns.Add("date");
        table.Columns.Add("taskName");
        table.Columns.Add("projectName");
        table.Columns.Add("projectDesc");
        table.Columns.Add("departmentName");
        table.Columns.Add("taskEstimatedHours");
        table.Columns.Add("timesheetHours");

        foreach (var item in timesheets)
        {
            table.Rows.Add(item.date, item.taskName, item.projectName,
                item.projectDesc, item.departmentName, item.taskEstimatedHours,
                item.timesheetHours);
        }
    }

    return table;
} 
```

填充 DataGridView 的代码如下：

```
 TimesheetGrid.DataSource = EmployeeManager.GetEmployeeTimesheets(employeeId);
    TimesheetGrid.DataBind(); 
```

我是在函数/LINQ 查询本身中做错了什么，还是我没有正确填充 DataGridView？

# transactions - 工作流基础和 DTC 事务回滚错误行为

> ID：15211795
> 
> 赞同：0
> 
> 时间：2013-03-04T21:49:04.387
> 
> 标签：transactions, workflow-foundation-4, transactionscope, msdtc

我正在工作流基础 4.5 中测试接收事务范围，我认为它有问题！

查看我何时通过显式回滚来回滚事务：

```
using (TransactionScope s = new TransactionScope())
{
    using (ServiceReference1.ServiceClient cli = new ServiceReference1.ServiceClient())
    {
        Transaction t = Transaction.Current;                    
        cli.GetData(new ServiceReference1.GetData() { data = 10, ID = id });
        t.Rollback();                                        
    }
} 
```

或通过在 transactionScope 中抛出异常：

```
using (TransactionScope s = new TransactionScope())
{
    using (ServiceReference1.ServiceClient cli = new ServiceReference1.ServiceClient())
    {
        cli.GetData(new ServiceReference1.GetData() { data = 10, ID = id });
        throw new Exception("Error!");
    }
} 
```

我希望工作流程也能回滚！换句话说，我希望接收“GetData”仍然有效！但这不会发生。工作流被执行，GetData 不再有效！

“GetData”后面还有其他“receives”，保证工作流不会进入“完成”状态……

我确定我的事务正在流入工作流程，因为在工作流程中我有一个活动返回我的事务 ID（当然与应用程序上的 ID 匹配）

谁能告诉发生了什么？我错过了什么？

进一步说明：
一切都在我的机器上运行（包括后备存储，在 Sql Server 2012 上）DTC 已启用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T04:45:36.200

工作流本身不是事务资源。因此，尽管您所做的任何数据库更新都可能被回滚，但工作流本身的状态不会被重置。

# python - 为什么 Django admin list_select_related 在这种情况下不起作用？

> ID：15211799
> 
> 赞同：11
> 
> 时间：2013-03-04T21:49:09.117
> 
> 标签：python, django, performance, django-admin

我有一个`ModelAdmin`类，其中包含一个外键字段`list_display`。但是该模型的管理列表页面正在执行数百个查询，每行一个查询以从另一个表而不是连接 ( `select_related()`) 获取数据。

Django 文档[表明](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_select_related)您可以将`list_select_related = True`其作为属性添加到您的 ModelAdmin 以使其消失，但它似乎对我来说根本不起作用。[这个 SO question](https://stackoverflow.com/questions/9719662/django-admin-performance-issue)似乎给出了类似的问题，但他的解决方案尚不清楚，并且在我的情况下不起作用。

这是我的模型和模型管理员的精简版：

```
class Device(models.Model):
    serial_number = models.CharField(max_length=80, blank=True, unique=True)
    label = models.CharField(max_length=80, blank=True)

    def __str__(self):
        s = str(self.serial_number)
        if self.label:
            s += ': {0}'.format(self.label)
        return s

class Event(models.Model):
    device = models.ForeignKey(Device, null=True)
    type = models.CharField(max_length=40, null=False, blank=True, default='')

class EventAdmin(admin.ModelAdmin):
    list_display = ('__str__', 'device')
    list_select_related = True 
```

但是，添加它`list_selected_related = True`并没有改变任何东西。我仍然得到很多这样的查询，而不是 SQL 连接：

![很多查询，而不是连接](../Images/41d9807d32fdea5d0ab8dfd26a96f454.png)

任何想法为什么 Django 管理员似乎忽略了我的 list_select_related 并进行 N 查询？我正在使用 Python 2.7 和 Django 1.3.3。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-04T22:13:14.863

这里的问题是设置`list_select_related = True`只是在查询中添加了一个基本信息`select_related()`，但默认情况下该调用不会跟随 ForeignKeys with `null=True`. 所以答案是自己定义更改列表使用的查询集，并指定要遵循的 FK：

```
class EventAdmin(admin.ModelAdmin):
    list_display = ('__str__', 'device')
    def queryset(self, request):
        return super(EventAdmin, self).queryset(request).select_related('device') 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-02-25T03:52:04.273

[从 Django 1.6](https://docs.djangoproject.com/en/1.6/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_select_related)开始，`list_select_related`接受一个布尔值、列表或元组，其中包含要包含在`select_related()`调用中的字段名称。因此，您现在可以使用：

```
class EventAdmin(admin.ModelAdmin):
    list_display = ('__str__', 'device')
    list_select_related = ['device'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-04T14:45:16.093

虽然`select_related`通常是要走的路，但有时需要更多控制，然后覆盖`get_queryset`变得更适用，这是丹尼尔罗斯曼答案的更现代版本：

外键字段在哪里`foo`和是：`bar`

```
 def get_queryset(self, request):
        qs = super().get_queryset(request)
        return qs.select_related('foo', 'foo__bar').only('foo__field1', 'foo__bar__field2') 
```

# javascript - JS - 更改所有对象实例的值

> ID：15211802
> 
> 赞同：1
> 
> 时间：2013-03-04T21:49:34.687
> 
> 标签：javascript, oop

我的某个对象的实例有一些称为`selected`和方法的值`select()`。当方法`select()`被触发时，我希望`selected`设置对象的值`true`，但是`selected`该对象的所有其他实例的值是`false`- 怎么做？

换句话说 - 如何更改某个对象的所有实例的值？

```
 var Puzzel = function() {
        this.selected = false;
    }; 

    Puzzel.prototype = {            
        select: function{
            this.selected = true;
            //how to set selected = false on every other instance of Puzzel
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:54:35.993

如果您可以依赖 getter/setter（请参阅[兼容性](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty#Cross-browser_concerns)），那么以下内容将起作用。

这种方法在选择或检查选择时具有恒定的开销，并且具有恒定的内存开销。

```
var Selectable = function () {
  // Define your constructor normally.
  function Selectable() {
  }
  // Use a hidden variable to keep track of the selected item.
  // (This will prevent the selected item from being garbage collected as long
  // as the ctor is not collectible.)
  var selected = null;
  // Define a getter/setter property that is true only for the
  // item that is selected
  Object.defineProperty(Selectable.prototype, 'selected', {
    'get': function () { return this == selected; },
    // The setter makes sure the current value is selected when assigned
    // a truthy value, and makes sure the current value is not selected
    // when assigned a falsey value, but does minimal work otherwise.
    'set': function (newVal) {
      selected = newVal ? this : this == selected ? null : selected;
    }
  });
  // Define a select function that changes the current value to be selected.
  Selectable.prototype.select = function () { this.selected = true; };
  // Export the constructor.
  return Selectable;
}(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:53:04.870

您需要跟踪这些实例。这是一种方法：

```
(function() {
    var instances = [];
    window.MyClass = function() {
        instances.push(this);
        // rest of constructor function
    };
    window.MyClass.prototype.select = function() {
        for( var i=0, l=instances.length; i<l; i++) instances[i].selected = false;
        this.selected = true;
    };
})(); 
```

# android - 在 API 版本 8 中在 RelativeLayout 中设置 ImageView

> ID：15211804
> 
> 赞同：0
> 
> 时间：2013-03-04T21:49:40.837
> 
> 标签：android, coordinates, android-relativelayout, android-imageview

我`RelativeLayout`在我的 XML 文件中创建了一个基本的。在我的代码中，我想动态创建几个`ImageView`s 并将它们放置在`RelativeLayout`. 我尝试过的所有内容 ( `ImageView.setX()`, `ImageView.setTranslationX()`, `ImageView.setPadding()`) 要么说我需要更高的 API 级别 (11+) 要么导致`ImageView`不出现。

如果我不尝试对 的位置做任何事情`ImageView`，那么图像确实会出现在屏幕上的`(0,0)`位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T23:23:24.493

这个简单的应用程序将使用RelativeLayout 将15 个图标动态布局成三行。没有理由使用 AbsoluteLayout - 它也已被弃用。

主要活动。

```
public class MainActivity extends Activity {

    private int mWidth;
    private int mTile;
    private int mColMax = 5;
    private Context mContext;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        mContext = this;

        // the screen width is need to work out the tile size
        mWidth = mContext.getResources().getDisplayMetrics().widthPixels;
        // how wide (and high) each icon will be to fit the screen.
        mTile = (mWidth / mColMax);

        setContentView(R.layout.activity_main);
        // layout the icons
        initUI();
    }

    /**
     * Layout 15 icon images in three rows dynamically.
     */
    private void initUI() {
        // this is the layout from the XML
        ViewGroup layout = (ViewGroup) findViewById(R.id.main_layout); 

        ImageView iv;
        RelativeLayout.LayoutParams params;

        int i = 0;
        int row = 0;
        int col = 0;
        do {
            params = new RelativeLayout.LayoutParams(mTile,mTile);
            params.setMargins((col * mTile), (row * mTile), 0, 0);
            iv = new ImageView(mContext);
            iv.setAdjustViewBounds(true);
            iv.setScaleType(ScaleType.FIT_CENTER);
            iv.setImageResource(R.drawable.ic_launcher);
            iv.setLayoutParams(params);
            layout.addView(iv);
            if (col == mColMax) {
                row++;
                col = 0;
            } else {
                col++;
            }
        } while (++i <= 16);
    }
} 
```

和布局 XML。

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/main_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-04T21:55:14.477

相对布局用于将项目与其他项目相关联。您不会使用它们将布局放置在特定位置，例如 setX。如果要相对于现有项目放置新项目，请查看RelativeLayout.LayoutParams-您可以通过它们设置layout_alignXXX和layout_toXXXOf类型参数。

如果您需要精确的像素位置，请使用已弃用的 AbsoluteLayout。请注意，在没有大量工作的情况下，在任何具有不同纵横比或屏幕尺寸的设备上，它看起来都很难看。

# android - 从android下载图像，保证得到它

> ID：15211806
> 
> 赞同：2
> 
> 时间：2013-03-04T21:49:46.043
> 
> 标签：android, web-services, soap, download, ksoap2

我有一个与 Web 服务交互的 android 应用程序。我从服务下载图像，作为 base64 字符串。这是过程：

::应用程序每 10 秒轮询一次 wifi

::Within wifi > 发送请求以获取任何新图像

::服务器获取请求，处理图像，更新数据库（都相当快）

::Server 将 image 转换为 base64 并返回字符串

::App保存图片

够简单吧？我遇到的问题是应用程序短暂进入 wifi 范围，然后在它得到响应之前退出。这意味着图像被认为是下载到数据库中，而实际上不是（这个系统中的大问题）。

有没有确保响应通过的好方法？我最好的选择是制作第二种网络方法，它更新数据库，只有在下载图像后才从应用程序调用？

我正在使用 SOAP（ksoap2 导入）进行这些调用。

是我放下的方式好，还是有更好的方式？

CallSoap.java：

```
public String Call(String variable1)
{

    SoapObject request = new SoapObject(WSDL_TARGET_NAMESPACE,OPERATION_NAME);
    PropertyInfo pi=new PropertyInfo();
    pi.setName("variable1");
    pi.setValue(variable1);
    pi.setType(String.class);
    request.addProperty(pi);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
    SoapEnvelope.VER11);
    envelope.dotNet = true;
    envelope.setOutputSoapObject(request);
    HttpTransportSE httpTransport = new HttpTransportSE(SOAP_ADDRESS);
    Object response=null;
    try

    {

        httpTransport.call(SOAP_ACTION, envelope);

        response = envelope.getResponse();

    }

    catch (Exception exception)

    {

        response=exception.toString();

    }

    return response.toString();
} 
```

调用者.java

```
public class Caller  extends Thread 
{

public CallSoap cs;
public String variable1= "variable1";

public void run()
{
    try
    {
    cs=new CallSoap();  
    String resp=cs.Call(variable1);
    MySOAPCallActivity.rslt=resp;
    }catch(Exception ex)
    {
        MySOAPCallActivity.rslt=ex.toString();  
    }

}
} 
```

主类：

```
try{

                rslt="START";
                Caller c=new Caller();
                c.variable1=variable1;
                c.join();
                c.start();
                while(rslt=="START")
                {
                    try
                    {
                        Thread.sleep(10);
                    }
                    catch(Exception ex)
                    {
                    }
                }
            }
            catch(Exception ex){
            } 
```

# ms-access - VBA手动创建BMP

> ID：15211808
> 
> 赞同：4
> 
> 时间：2013-03-04T21:49:54.720
> 
> 标签：ms-access, vba, bmp

我正在研究一个 VBA 类来创建 QR 码，但在将 QR 数据位写入实际 BMP 文件时，我感到很困惑。为了掌握 BMP 结构和代码，我一直在尝试使用下面的代码制作一个 21 x 21 像素的全白位图。这几乎可以工作，除了每行中最左边的列是黄色而不是白色。关于可能发生什么的任何想法？我猜我的标题定义有问题，但我不确定。我远不是 BMP 的专业人士。我的代码基于我在这里找到的[http://answers.microsoft.com/en-us/office/forum/office_2007-customize/how-can-i-create-a-bitmap-image-with-vba/4976480a -d20b-4b2a-8ecc-436428d9586b](http://answers.microsoft.com/en-us/office/forum/office_2007-customize/how-can-i-create-a-bitmap-image-with-vba/4976480a-d20b-4b2a-8ecc-436428d9586b)

```
Private Type typHEADER
    strType As String * 2  ' Signature of file = "BM"
    lngSize As Long        ' File size
    intRes1 As Integer     ' reserved = 0
    intRes2 As Integer     ' reserved = 0
    lngOffset As Long      ' offset to the bitmap data (bits)
End Type
Private Type typINFOHEADER
    lngSize As Long        ' Size
    lngWidth As Long       ' Height
    lngHeight As Long      ' Length
    intPlanes As Integer   ' Number of image planes in file
    intBits As Integer     ' Number of bits per pixel
    lngCompression As Long ' Compression type (set to zero)
    lngImageSize As Long   ' Image size (bytes, set to zero)
    lngxResolution As Long ' Device resolution (set to zero)
    lngyResolution As Long ' Device resolution (set to zero)
    lngColorCount As Long  ' Number of colors (set to zero for 24 bits)
    lngImportantColors As Long ' "Important" colors (set to zero)
End Type
Private Type typPIXEL
    bytB As Byte    ' Blue
    bytG As Byte    ' Green
    bytR As Byte    ' Red
End Type
Private Type typBITMAPFILE
    bmfh As typHEADER
    bmfi As typINFOHEADER
    bmbits() As Byte
End Type

'==================================================

Public Sub makeBMP(intQR() As Integer)
    Dim bmpFile As typBITMAPFILE
    Dim lngRowSize As Long
    Dim lngPixelArraySize As Long
    Dim lngFileSize As Long
    Dim j, k, l, x As Integer

    Dim bytRed, bytGreen, bytBlue As Integer
    Dim lngRGBColoer() As Long

    Dim strBMP As String

    With bmpFile
        With .bmfh
            .strType = "BM"
            .lngSize = 0
            .intRes1 = 0
            .intRes2 = 0
            .lngOffset = 54
        End With
        With .bmfi
            .lngSize = 40
            .lngWidth = 21
            .lngHeight = 21
            .intPlanes = 1
            .intBits = 24
            .lngCompression = 0
            .lngImageSize = 0
            .lngxResolution = 0
            .lngyResolution = 0
            .lngColorCount = 0
            .lngImportantColors = 0
        End With
        lngRowSize = Round(.bmfi.intBits * .bmfi.lngWidth / 32) * 4
        lngPixelArraySize = lngRowSize * .bmfi.lngHeight

        ReDim .bmbits(lngPixelArraySize)
        ReDim lngRGBColor(21, 21)
        For j = 1 To 21  ' For each row, starting at the bottom and working up...
            'each column starting at the left
            For x = 1 To 21
                k = k + 1
                .bmbits(k) = 255
                k = k + 1
                .bmbits(k) = 255
                k = k + 1
                .bmbits(k) = 255
            Next x

            If (21 * .bmfi.intBits / 8 < lngRowSize) Then   ' Add padding if required
                For l = 21 * .bmfi.intBits / 8 + 1 To lngRowSize
                    k = k + 1
                    .bmbits(k) = 0
                Next l
            End If
        Next j
        .bmfh.lngSize = 14 + 40 + lngPixelArraySize
     End With ' Defining bmpFile

    strBMP = "C:\Desktop\Sample.BMP"

    Open strBMP For Binary Access Write As 1 Len = 1
        Put 1, 1, bmpFile.bmfh
        Put 1, , bmpFile.bmfi
        Put 1, , bmpFile.bmbits
    Close
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:31:16.707

这是一个行字节对齐问题。用一个额外的字节填充每一行，您的问题应该会消失。

发布，以便您有一个要检查的答案。:)

另外，这里有一个很好的 bmp 工具。 [https://50ab6472f92ea10153000096.openlearningapps.net/run/view](https://50ab6472f92ea10153000096.openlearningapps.net/run/view)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-11T04:51:38.157

此 BMP 导出代码中有一个小错误。
说的那一行

```
lngRowSize = Round(.bmfi.intBits * .bmfi.lngWidth / 32) * 4 
```

实际上应该说

```
'old line:    lngRowSize = Round(.bmfi.intBits * .bmfi.lngWidth / 32) * 4
 lngRowSize = WorksheetFunction.Ceiling_Precise(.bmfi.intBits * .bmfi.lngWidth / 32) * 4 
```

之前，round 函数会阻止某些图像宽度正确导出，并且代码会引发错误。以前拒绝的宽度：(3,6,7,11,14,15,19,22,23,27,30,...)

我假设您不再需要此代码，但我从这里复制了它，我认为其他人也会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-22T21:44:06.673

我运行了你的代码来验证黄线。仔细查看后，我相信可以通过设置 bmpfile.bmpbits 字节数组的边界来解决问题。当您定义数组时，您将下限留空，因此默认情况下数组将从 0 开始。如果您像这样重新调暗数组

```
 ReDim .bmbits(1 To lngPixelArraySize) 
```

您将获得一个纯白色的 sample.bmp。我运行它来验证它对我有用。

祝你好运。我可以看到让 k 从 -1 开始是如何工作的。剩下的唯一问题是您的数组大小将多出一个字节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-11T16:49:38.623

要使“天花板”功能正确（VBA / excel 2007），不需要“精确”语句。
宏在以下情况下正常工作：

```
lngRowSize = WorksheetFunction.Ceiling(.bmfi.intBits * .bmfi.lngWidth / 32, 0.5) * 4 
```

# c# - 在 WinRT 的 HttpClient 类中使用 Keep-Alive 连接？

> ID：15211812
> 
> 赞同：5
> 
> 时间：2013-03-04T21:50:01.793
> 
> 标签：c#, windows-8, windows-runtime, windows-store-apps, dotnet-httpclient

打开与我们服务器的连接时，我们的 WinRT 应用程序非常慢。请求需要大约 500 毫秒才能运行。这阻碍了我们的一些场景。

在调试时，我们注意到当 Fiddler 处于活动状态时，请求要快得多 - 每个请求约 100 毫秒。后来通过一些搜索我们了解到这是因为 Fiddler 在代理调用时使用了 Keep-Alive 连接，这使得我们的代理调用更快。

我们以两种方式仔细检查了这一点。

1.  我们将 UseProxy 设置为 false 并观察到请求变慢了。
2.  我们关闭了 Fiddler 的“重用连接”选项，并观察到请求又变慢了。

我们尝试通过 Connection 标头 (.Connection.Add("Keep-Alive")) 启用 keep-alive，但这似乎没有任何效果 - 事实上，标头似乎被 .NET 组件公然忽略并且是未按请求发送（再次通过 Fiddler 检查）。

有谁知道如何在 Windows 8、WinRT、HttpClient 类中设置保持活动状态？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-11-18T02:26:14.440

以下设置正确的标头为我打开保持活动状态（客户端是 HttpClient）

```
client.DefaultRequestHeaders.Connection.Clear();
client.DefaultRequestHeaders.ConnectionClose = false;
// The next line isn't needed in HTTP/1.1
client.DefaultRequestHeaders.Connection.Add("Keep-Alive"); 
```

如果要关闭保持活动状态，请使用

```
client.DefaultRequestHeaders.Connection.Clear();
client.DefaultRequestHeaders.ConnectionClose = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T06:39:20.560

尝试使用 HttpContent 类添加标题 - 基于（但未经测试）[http://social.msdn.microsoft.com/Forums/en-CA/winappswithcsharp/thread/ce2563d1-cd96-4380-ad41-6b0257164130](http://social.msdn.microsoft.com/Forums/en-CA/winappswithcsharp/thread/ce2563d1-cd96-4380-ad41-6b0257164130)

在幕后 HttpClient 使用 HttpWebRequest 可以让您直接访问 KeepAlive 但由于您正在通过 HttpClient 您不能直接访问 HttpWebRequest 类上的该属性。

```
 public static async Task KeepAliveRequest()
{
    var handler = new HttpClientHandler();
    var client = new HttpClient(handler as HttpMessageHandler);

    HttpContent content = new StringContent(post data here if doing a post);
    content.Headers.Add("Keep-Alive", "true");

    //choose your type depending what you are sending to the server
    content.Headers.ContentType = new MediaTypeHeaderValue("application/x-www-form-urlencoded");

    HttpResponseMessage response = await client.PostAsync(url, content);

    Stream stream = await response.Content.ReadAsStreamAsync();

    return new StreamReader(stream).ReadToEnd();
} 

```

**编辑** 因为你只想要 GET，你可以这样做：

```
 public static async Task KeepAliveRequest(string url)
{
    var client = new HttpClient();
    var request = new HttpRequestMessage()
    {
        RequestUri = new Uri("http://www.bing.com"),
        Method = HttpMethod.Get,
    };
    request.Headers.Add("Connection", new string[] { "Keep-Alive" });
    var responseMessage = await client.SendAsync(request);
    return await responseMessage.Content.ReadAsStringAsync();
} 

```

# android - clicklistener 的语法错误

> ID：15211816
> 
> 赞同：1
> 
> 时间：2013-03-04T21:50:29.410
> 
> 标签：android, button, syntax

好的朋友。所以我已经让我的应用程序做了一些基本的功能，并且对自己很满意。我的下一个目标是设置一个按钮和备用活动/布局。我打算继续进行该活动，并且它在按钮代码之外运行良好。但是，当合并到按钮代码中时，我充满了语法错误。我在按钮上做错了什么？

.java

```
package com.eai.vgp;

import java.util.Random;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

         Button op1 = (Button) findViewById(R.id.op1);

            op1.setOnClickListener(new OnClickListener(){
                Intent goToNextActivity = new Intent(getApplicationContext(), OptionsActivity.class);
                startActivity(goToNextActivity);
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:51:34.593

尝试：

```
op1.setOnClickListener(new OnClickListener(){
    @Override
    public void onClick(View v){
        Intent goToNextActivity = new Intent(getApplicationContext(), OptionsActivity.class);
        startActivity(goToNextActivity);
    }
}); 
```

您缺少`);`完成声明所需的内容，并且没有`onClick()`适当的方法。

此外，您需要更改`getApplicationContext()`为`MainActivity.this`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:52:41.160

尝试：

```
op1.setOnClickListener(new OnClickListener(){
    @Override
    public void onClick(View v){
    Intent goToNextActivity = new Intent(v.getContext(), OptionsActivity.class);
    startActivity(goToNextActivity);
   }
}); 
```

您需要在匿名类声明的末尾有一个分号，并且您需要将启动代码并使您的 Activity 放在 overriden 中`onClick()`。我还改变了你使用视图上下文的意图，只是为了更简洁的代码。

# ios - 我应该在 Objective-C 的视图控制器中在哪里初始化自定义类？

> ID：15211821
> 
> 赞同：2
> 
> 时间：2013-03-04T21:50:43.720
> 
> 标签：ios, objective-c

最佳实践是什么，我将如何在方法中使用它？我的对象类中已经有一个 init 方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:53:44.297

> 我应该在 Objective-C 的视图控制器中在哪里初始化自定义类？

您应该`viewDidLoad`在方法中或`initWithNibName`方法中初始化变量或自定义类对象

> 如何使用？

你可以像这样初始化自定义类对象

```
CustomClass *classObj = [[CustomClass alloc] init]; 
```

> 如何使用自定义类作为属性？

在**MyViewController.h**

```
@class CustomClass;

@interface MyViewController:ViewController

@property (strong,nonatomic)CustomClass *classObject; 
```

在**MyViewController.m**

```
 #import "CustomClass.h"
......
    @synthesize classObject;
.....
    self.classObject=[[CustomClass alloc]init]; 
```

# javascript - Yii Widget 视图不呈现 javascript 代码

> ID：15211825
> 
> 赞同：0
> 
> 时间：2013-03-04T21:51:01.653
> 
> 标签：javascript, yii, yii-components

我正在尝试使用 registerScript() 将一些原始 javascript 输出到我的页面中。以下似乎工作正常（在视图级别，由控制器调用）：

模块/myApp/views/readEditor.php：

```
<?php
$cs = Yii::app()->getClientScript();  
$cs->registerScript(
                'my-hello-world-1',
                'var someCoolVariableInView = 11;',
                CClientScript::POS_END
);
?> 
```

这应该在之前出现：

```
/*<![CDATA[*/
var someCoolVariableInView = 11;
/*]]>*/ 
```

但是，当我在小部件的视图中执行等效操作时：

模块/myApp/components/views/myWidget.php：

```
<?php
$cs = Yii::app()->getClientScript();  
$cs->registerScript(
                'my-hello-world-2',
                'var someCoolVariableInWidget = 10;',
                CClientScript::POS_END
);
?> 
```

javascript 不显示。

我做了一堆谷歌搜索，但没有发现任何有用的东西。我的猜测是小部件正在过滤掉 javascript...希望有一个参数或配置开关我可以更改以使其输出（或者也许有更好的方法来做到这一点）。

谢谢，

彼得

更新：

小部件如何呈现：

```
<?php
class myWidget extends CWidget {

    public function init() {
    } // end init()

    public function run() {
        // ...
        $this->render('myWidget');
    } // end run()

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T10:22:43.473

将您的 registerScript 放入`init()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-23T12:58:26.373

在您的控制器中尝试以下代码来处理呈现 javascript 代码。

```
$output=$this->widget('myWidget',array(),true); 
echo $this->processOutput($output); 
```

# ruby - ruby 中“next”与“unless”时的执行顺序混淆

> ID：15211827
> 
> 赞同：2
> 
> 时间：2013-03-04T21:51:05.423
> 
> 标签：ruby

该`next`语句用于跳过循环的一部分并继续循环的下一次迭代。它可以与`for`和`while`语句结合使用。

如果在评估某些条件后有一段复杂的代码，我见过人们使用下一个，即

```
next if @state!=:some_state
# some long complicated code 
```

现在我在这里玩了`next`如下`IRB`：

```
n = 1
loop do
  n = n + 1
  next unless n == 10
  print "Good"
  break
end
# Good=> nil 
```

上面那位明白了。很清楚。

```
n = 1
#=> 1
loop do
  print "#{n}"
  n = n + 1
  next puts "hi" unless n == 5
  p "good"
  break
end
#1hi
#2hi
#3hi
#4"good"
#=> nil 
```

在上面的代码中，无法理解行`puts "hi"`和`unless n == 5`执行的顺序。哪个先执行？

下面的一个导致`infinite Loop`.

```
n = 1
#=> 1
loop do
  print "#{n}"
  n = n + 1
  next puts "hi"; 2 + 3 unless n == 5
  p "good"
  break
end 
```

而这个很好：

```
n = 1
#=> 1
loop do
  print "#{n}"
  n = n + 1
  next puts "hi", 2 + 3 unless n == 5
  p "good"
  break
end

#1hi
#5
#2hi
#5
#3hi
#5
#4"good"
#=> nil 
```

请在这里帮助我理解 - 这个是如何解决这个`forever`循环的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:57:21.847

分号被评估为换行符，因此：

```
next puts "hi"; 2 + 3 unless n == 5 
```

相当于：

```
next puts "hi"
2 + 3 unless n == 5 
```

因此，`next`将始终被调用，并且您将有一个无限循环。

`puts`逗号被评估为传递一组参数（通过方法签名将其解释为数组），因此：

```
next puts "hi", 2 + 3 unless n == 5 
```

相当于：

```
next puts("hi", 2 + 3) unless n == 5 
```

关于`puts`and `unless`- 的执行顺序，请考虑以下几点：

```
unless n == 5
  next puts "hi"
end 
```

在这个例子中，很明显`unless`先被评估，然后如果传递的条件被评估为假，`next puts "hi"`则执行语句。好：

```
next puts "hi" unless n == 5 
```

是完全相同的事物的简写。所以`unless`修饰符总是首先被评估。自然，如果您在中间插入分号，则会导致对它的评估不同，因为分号被评估为换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T02:50:15.707

条件必须首先执行，否则，它怎么知道是否评估涉及该语句的任何表达式？

至于您的第二个问题，循环忽略**下一个**表达式的值，表达式中的值仅对从块中返回值有用。所以，唯一让你的循环结束的是**break**。

# c# - 如何从 XAML 访问代码中的对象

> ID：15211829
> 
> 赞同：2
> 
> 时间：2013-03-04T21:51:14.510
> 
> 标签：c#, wpf, xaml, data-binding

我是 WPF 的新手，正在尝试了解如何使用数据绑定将窗口上的控件绑定到后面代码中的对象。我看到了几个关于从代码隐藏中访问 XAML 对象的问题，但这不是我想要的。我已经知道该怎么做。

```
label1.Content = LabelText;
listbox1.ItemsSource = ListItems; 
```

我还看到了有关如何从 XAML 访问代码隐藏中的类的答案。

```
<local:MyClass x:Key="myClass" /> 
```

但我不知道如何将其应用于类的特定实例。这是我正在尝试做的一个例子。“绑定”显然是不正确的。这就是我需要帮助的地方。

```
public partial class MainWindow : Window
{
    private string _labelText;
    private List<string> _listItems = new List<string>();

    public MainWindow()
    {
        InitializeComponent();

        _labelText = "Binding";
        _listItems.Add("To");
        _listItems.Add("An");
        _listItems.Add("Object");
    }

    public string LabelText
    {
        get { return _labelText; }
        set { _labelText = value; }
    }

    public List<string> ListItems
    {
        get { return _listItems; }
        set { _listItems = value; }
    }
}

<Window x:Class="SO_Demo.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="SO Demo" Height="160" Width="225">
  <Grid DataContext="MainWindow">
    <Label x:Name="label1" Width="80" Height="25" Margin="12,12,0,0" 
           Content="{Binding Path=LabelText}"
           HorizontalAlignment="Left" VerticalAlignment="Top" />
    <ListBox x:Name="listbox1" Width="100" Height="60" Margin="12,44,0,0" 
             ItemsSource="{Binding Path=ListItems}" DisplayMemberPath="ListItems"
             HorizontalAlignment="Left" VerticalAlignment="Top" />
  </Grid>
</Window> 
```

我读过的书籍和教程听起来应该很简单。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T22:13:12.837

虽然您可以`DataBind`按照您尝试的方式直接上课，但这并不是通常的做法。推荐的方法是创建一个对象 (ViewModel)，该对象聚合您希望在 UI 中显示的所有模型数据，然后将该 ViewModel 设置`DataContext`为您的视图（在本例中为窗口）。我建议阅读 MVVM，这是大多数 WPF 应用程序的构建方式。但是下面的示例可以帮助您入门。

这是一个基于上述示例的简单示例：

**视图模型**

```
public class MyViewModel : INotifyPropertyChanged
{
    private string _title;
    private ObservableCollection<string> _items;

    public string LabelText
    { 
        get { return _title; } 
        set 
        { 
            _title = value;
            this.RaisePropertyChanged("Title");
        }
    }

    public ObservableCollection<string> ListItems { 
        get { return _items; }
        set 
        { 
            _items = value;   //Not the best way to populate your "items", but this is just for demonstration purposes.
            this.RaisePropertyChanged("ListItems");
        }
    }

    //Implementation of INotifyPropertyChanged
    public event PropertyChangedEventHandler PropertyChanged;

    protected void RaisePropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

} 
```

**代码隐藏**

```
public partial class MainWindow : Window
{
    private MyViewModel _viewModel;

    public MainWindow()
    {
        InitializeComponent();
        _viewModel = new MyViewModel();

        //Initialize view model with data...

        this.DataContext = _viewModel;
    }
} 
```

**视图（窗口）**

```
<Window x:Class="SO_Demo.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="SO Demo" Height="160" Width="225">
  <Grid>
    <Label x:Name="label1" Width="80" Height="25" Margin="12,12,0,0"               Content="{Binding Path=LabelText}"
           HorizontalAlignment="Left" VerticalAlignment="Top" />
    <ListBox x:Name="listbox1" Width="100" Height="60" Margin="12,44,0,0" 
             ItemsSource="{Binding Path=ListItems}"
             HorizontalAlignment="Left" VerticalAlignment="Top" />
  </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T21:55:37.023

`<Grid DataContext="MainWindow">`是无效的。

如果要引用该窗口，则必须：

```
<Window x:Name="MyWindow">
   <Grid DataContext="{Binding ElementName=MyWindow}"/>
</Window> 
```

或者

```
<Grid DataContext="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"/> 
```

# actionscript-3 - 编译默默失败，我做错了什么？

> ID：15211830
> 
> 赞同：0
> 
> 时间：2013-03-04T21:51:17.743
> 
> 标签：actionscript-3, flash

我正在处理我的 Flash 项目，该项目一直编译得很好。然后我做了一些更改，然后，在测试项目时，项目编译，flash player 出现，显示第一帧，但没有代码执行。没有单一的跟踪输出。没有什么。没有错误，没有警告，很奇怪！！！

有谁能够帮我？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:51:17.743

您可能偶然发现了 FlashIDE/Flex 编译器中的一个 BUG。

试试这个片段并想知道：

```
// ------ Put in first frame of a fresh flash file 

trace ("why won't i execute");

var dummy=function(a:int){

    a:int = 0;

} 
```

而不是抓住你的编码错误：

`a:int = 0;`应该是`var a:int = 0;`或`a=0;`

编译器窒息而死，甚至没有时间让你知道。

**谨防！**

这个错误可能深深隐藏在一些导入的中间类中。

因此，要回答您的问题，请查看您已更改的内容，您可能已更改了作为函数参数提供的本地 var，拿走了本地`var`但也忘记了删除该`:type`部分。

# jquery - 使用索引访问下一个相邻表中的元素

> ID：15211839
> 
> 赞同：2
> 
> 时间：2013-03-04T21:51:36.503
> 
> 标签：jquery

我是 jQuery 新手，我正在尝试完成一些我没有找到答案的事情。我有两个相邻的表，它们的行数和列数完全相同。当我单击一个表中的元素时，我想访问另一个表中的相同元素。到目前为止，我可以弄清楚我在当前表中的行索引，但我似乎无法转到下一张表。这是我的桌子的布局：

表格1

```
row col1 col2
1    a    b 
2    c    d
3    e    f 
```

表2

```
row col1 col2
1    w    x
2    y    z
3    n    m 
```

例如，如果我单击表 1 中的“a”，我想知道元素“w”中的值是多少。我很感激任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:58:26.020

您可以使每个表格元素都有一个 id，其中该 id 类似于“{tableNum}-{row}-{col}”。这将使通过其 id 访问每个元素变得容易。

如果您看到 a 已被单击，您将取回该元素并使用 访问另一个表中的元素`$("#table2-1-1")`。如果我措辞不好，请告诉我。

# gcc - 使用原生树莓派编译问题

> ID：15211843
> 
> 赞同：3
> 
> 时间：2013-03-04T21:51:54.867
> 
> 标签：gcc, compilation, compiler-errors, arm, raspberry-pi

**问题**

我们正在尝试在树莓派上编译 spi_slave 代码。我们使用了本地 gcc 编译器，编译运行没有任何错误。

问题是当我尝试运行输出时：

/home/pi/spi_slave# ./build/output.elf 分段错误

/home/pi/spi_slave# ./build/kernel.img bash: ./build/kernel.img: 无法执行二进制文件

试图从 cambridge 下载 arm-none-eabi 编译器，但它不会运行：/home/pi/spi_slave# ../arm-2008q3/bin/arm-none-eabi-gcc bash: ../arm-2008q3/bin /arm-none-eabi-gcc: 无法执行二进制文件

**源代码**

我们试图编译的代码是：[http ://tylernichols.me/wp-content/uploads/2012/11/raspberry_pi_bare_metal_spi_slave.zip](http://tylernichols.me/wp-content/uploads/2012/11/raspberry_pi_bare_metal_spi_slave.zip)

我们所做的唯一更改是在 makefile 中，在 ARMGNU var 前面添加了一个 #

```
#ARMGNU = arm-none-eabi 
```

**环境**

```
# uname -a
Linux raspberrypi 3.6.11+ #371 PREEMPT Thu Feb 7 16:31:35 GMT 2013 armv6l GNU/Linux 
```

**我究竟做错了什么？**

我们已经尝试在谷歌和 stackoverflow 上寻找答案几个小时了，但都没有成功。：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:04:14.883

`arm-none-eabi`是一个非linux编译器。它适用于*裸机*应用。不同之处在于`C`图书馆。但是，与正常编译的库`gcc`密切相关。`C`

然后是代码。它不是为 Linux 编写的。它是为*裸机*应用程序编写的。您需要在没有 Linux 的情况下从 Raspberry-Pi 引导加载程序（berryboot？）加载和运行代码。

您可以使用 ARM Linux 编译器为*裸机*应用程序创建代码。但是，您可能更容易找到针对 Raspberry Pi的**newlib编译器。**您可以在网上搜索一个*或*尝试自己构建一个。

请参阅：[如何`gcc`为 Raspberry Pi](https://stackoverflow.com/questions/10973020/cross-compilation-for-raspberry-pi-in-gcc-where-to-start)和[Bare-metal gcc](http://www.kunen.org/uC/gnu_tool.html)构建。

# ruby-on-rails - 将现有模型数据添加到大礼包产品

> ID：15211844
> 
> 赞同：0
> 
> 时间：2013-03-04T21:51:59.507
> 
> 标签：ruby-on-rails, import, spree, product

我有一个现有的网站，其中包含模型数据和数百个条目。我想赋予目录电子商务功能，所以我决定使用 Spree。

但是，我不知道如何将我的模型数据与 Spree 中的产品连接起来。基本上，我需要做的就是为现有数据加上一个价格，以及结帐功能。我不想重新添加所有以前的条目。

任何人都有我可以阅读的资源，或者有实现这一点的想法？

这还是用的吗？ [https://github.com/joshmcarthur/spree-import-products](https://github.com/joshmcarthur/spree-import-products)

我正在使用最新版本的 Rails，ruby 1.9.3 和 Spree 2.0.0.beta

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T10:58:25.357

您的旧目录模式可能与 Spree 的 Product 和 Variant 模型不兼容，因此您可能必须编写一个简单的 Rake 任务来完成这项工作，如下所示：

```
LegacyProduct.all.each do |legacy_product|
  Spree::Product.create(:name => legacy_product.title, // etc.
  // create variants etc.
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:31:11.297

你有没有机会看看这个 Spree Railscast ( [http://railscasts.com/episodes/298-getting-started-with-spree](http://railscasts.com/episodes/298-getting-started-with-spree) )

# hadoop - Hadoop：start-dfs.sh 权限被拒绝

> ID：15211848
> 
> 赞同：24
> 
> 时间：2013-03-04T21:52:20.833
> 
> 标签：hadoop

我正在笔记本电脑上安装 Hadoop。SSH 工作正常，但我无法启动 hadoop。

```
munichong@GrindPad:~$ ssh localhost
Welcome to Ubuntu 12.10 (GNU/Linux 3.5.0-25-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

0 packages can be updated.
0 updates are security updates.

Last login: Mon Mar  4 00:01:36 2013 from localhost

munichong@GrindPad:~$ /usr/sbin/start-dfs.sh
chown: changing ownership of `/var/log/hadoop/root': Operation not permitted
starting namenode, logging to /var/log/hadoop/root/hadoop-munichong-namenode-GrindPad.out
/usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-munichong-namenode.pid: Permission denied
usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/root/hadoop-munichong-namenode-GrindPad.out: Permission denied
head: cannot open `/var/log/hadoop/root/hadoop-munichong-namenode-GrindPad.out' for reading: No such file or directory
localhost: chown: changing ownership of `/var/log/hadoop/root': Operation not permitted
localhost: starting datanode, logging to /var/log/hadoop/root/hadoop-munichong-datanode-GrindPad.out
localhost: /usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/root/hadoop-munichong-datanode-GrindPad.out: Permission denied
localhost: /usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-munichong-datanode.pid: Permission denied
localhost: head: cannot open `/var/log/hadoop/root/hadoop-munichong-datanode-GrindPad.out' for reading: No such file or directory
localhost: chown: changing ownership of `/var/log/hadoop/root': Operation not permitted
localhost: starting secondarynamenode, logging to /var/log/hadoop/root/hadoop-munichong-secondarynamenode-GrindPad.out
localhost: /usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-munichong-secondarynamenode.pid: Permission denied
localhost: /usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/root/hadoop-munichong-secondarynamenode-GrindPad.out: Permission denied
localhost: head: cannot open `/var/log/hadoop/root/hadoop-munichong-secondarynamenode-GrindPad.out' for reading: No such file or directory

munichong@GrindPad:~$ sudo /usr/sbin/start-dfs.sh
[sudo] password for munichong: 
starting namenode, logging to /var/log/hadoop/root/hadoop-root-namenode-GrindPad.out
localhost: Permission denied (publickey,password).
localhost: Permission denied (publickey,password). 
```

我用了“须藤”。但是权限仍然被拒绝。

有没有人可以帮助我？

提前致谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2015-04-21T16:14:56.547

在过去的几个小时里，我被困在同一个问题上，但最终解决了。我的 hadoop 安装由与我用来运行 hadoop 的用户相同的用户提取。所以用户权限不是问题。
我的配置是这样的：Google Cloud 上的 Ubuntu linux 机器。

Hadoop安装/home/ Hadoop数据目录/var/lib/hadoop，目录访问位为777，所以任何人都可以访问。我做了 ssh 到远程机器对配置文件进行了更改并执行了 start-dfs.sh，然后它给了我“权限被拒绝（公钥）”所以这是解决方案：在同一个 ssh 终端中：

1.  **ssh-keygen**

2.它会询问复制密钥的文件夹位置，我输入**/home/hadoop/.ssh/id_rsa**

3.它会要求输入密码，为简单起见保持空白。

4\. **cat /home/hadoop/.ssh/id_rsa.pub >> .ssh/authorized_keys** （将新生成的公钥复制到用户home/.ssh目录下的auth文件）

5.  **ssh 本地主机**

6.  **start-dfs.sh** （现在它应该可以工作了！）

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-12-08T18:25:18.183

我遇到了同样的问题，所以尝试连接 SSH 并得到类似“*未找到*”的语句，所以我通过以下步骤前往 ssh 位置进行调试：

`cd ~/.ssh`

`ssh-keygen -t rsa -p""`

`cat id_rsa.pub >> authorized_keys`

...然后它起作用了...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-05T12:03:53.383

尝试将文件夹的所有权：`/var/log/hadoop/root`更改为用户：`munichong`。与所有系统一样，LOGS 目录需要由 hadoop 编辑。因此，它需要编辑 LOG 文件夹及其内容的权限。

`sudo`在这种情况下将不起作用，因为即使在此脚本完成其工作（即在后台启动 HADOOP 服务）之后，也需要具有更改文件夹内容的权限。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-09-20T06:32:33.620

您正在尝试 ssh 到您自己的机器（本地主机）并且缺少`authorized_keys`允许登录的文件。

SSH 中的此文件指定可用于登录配置该文件的用户帐户的 SSH 密钥。

请按照以下两个步骤正确配置它。

在终端中使用以下命令生成新的密钥生成器：

```
ssh-keygen 
```

按回车键保留默认名称 id_rsa.pub

现在注册生成的密钥文件：

```
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-20T03:38:27.917

那么我现在也面临这个问题，在我回答这个问题之前，我使用下面的方法。

1.  `sudo -s -H`

使用此代码以 root 用户身份登录

2.  `ssh localhost`

使用 ssh 登录（如果您只是尝试使用单节点模式）

3.  `./sbin/start-dfs.sh`

`./sbin/start-yarn.sh`

“cd”到您的 Hadoop 安装路径，然后打印该代码以启动 HDFS&MapRedude，那么您将不会再遇到许可问题。

我猜这个问题的原因：

我使用root用户来初始化Hadoop环境，所以几个文件夹是由root用户创建的，所以当我现在使用我自己的账户比如'Jake'时，我没有权限启动服务（在那段时间系统需要访问LOGS）

![在此处输入图像描述](../Images/e81396c3d5ed5f3a8fe0e8d8522b66b0.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-19T10:31:41.040

尝试更改存储 hdfs namenode 和 datanode 的位置的权限。

> hdfs-site.xml 中提到的位置

那个位置应该有755的许可。-rwxr-xr-x 与您运行 hadoop 的用户一起使用。

还为日志位置设置相同的权限。

希望它会有所帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-21T02:42:37.820

我认为问题在于root和用户的ssh连接。这是我的副本[https://askubuntu.com/questions/497895/permission-denied-for-rootlocalhost-for-ssh-connection](https://askubuntu.com/questions/497895/permission-denied-for-rootlocalhost-for-ssh-connection) 解决了我的问题。

默认情况下，SSH 服务器拒绝基于密码的 root 登录。在 /etc/ssh/sshd_config 中，

更改： PermitRootLogin without-password to PermitRootLogin yes

并重启 SSH： sudo service ssh restart

或者，您可以使用 SSH 密钥。如果您没有，请使用 ssh-keygen 创建一个（坚持默认的密钥，如果您愿意，可以跳过密码）。然后执行 sudo -s（或任何您喜欢的成为 root 的方法），并将 SSH 密钥添加到 /root/.ssh/authorized_keys：

猫 /home/user/.ssh/id_rsa.pub >> /root/.ssh/authorized_keys

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-27T16:03:22.230

R hadoop安装权限被拒绝问题，下面的命令适用于start-all.sh

```
sudo chown -R hadoop /usr/local/hadoop/ 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-12T02:37:04.007

必须这样做，就像上面的每个人一样：

```
cd ~/.ssh

ssh-keygen -t rsa -p""

cat id_rsa.pub >> authorized_keys 
```

但这是关键：

```
chmod 400 ~/.ssh/id_rsa 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2018-12-12T10:05:31.127

我通过将所有文件的权限设置为`777`：

```
sudo chmod 777 /usr/local/hadoop-2.7.6/* -R 
```

# css - 字母之外的 CSS 文本描边

> ID：15211849
> 
> 赞同：1
> 
> 时间：2013-03-04T21:52:25.497
> 
> 标签：css, outline

好的，现在一直在为此苦苦挣扎，我几乎拥有我想要的外观，但现在正在努力定位这些物品。基本上我想要一个在外面有笔划的笔划文本，这意味着 webkit 文本笔划是无用的。

所以我想我会把两个文本元素放在一起并这样做。这很好用，除了因为我使用的是 position:absolute 元素基本上没有高度。

HTML 如下所示：

```
<div class="hcontainer"
    <h2>A Framework For Web Artisans</h2>
    <span class="h2white">A Framework For Web Artisans</span>
</div> 
```

像这样的CSS：

```
h2{font-size:2em; 
margin: 10px 0;
color:#234F70;
-webkit-text-stroke: 10px #531A16;
-webkit-text-fill-color:#FFF;
letter-spacing:-2px;
position:absolute; 
top:10px; 
left:0px;}

.h2white{font-family:dom_bold,arial black;
font-size:2em; 
margin: 10px 0;
color:#FFF;
position:relative; 
top:10px; left:0px;
letter-spacing:-2px;
position:absolute;}

.hcontainer{position:relative;clear:both;height:2em;} 
```

所以这就是问题所在。hcontainer 需要设置高度，因为它包含的元素是绝对定位的，因此没有高度并且会打乱流程。问题是使高度动态化，以便我可以适当地间隔元素。

我可以为每个标题制作一个单独的容器，但这似乎有点多。谁能想到一个更好的方法来做我在这里想做的事情？还是解决身高问题的方法？

[http://jsfiddle.net/calder12/9M7YZ/](http://jsfiddle.net/calder12/9M7YZ/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T21:31:57.143

我真的不明白“问题在于使高度动态化，以便我可以适当地间隔元素”是什么意思。但是，如果您不想在 .hcontainer 上声明高度，则可以在 .h2white 上使用负上边距将其放置在红色 h2 之上，而不是使用绝对定位。像这样：

[http://jsfiddle.net/9M7YZ/10/](http://jsfiddle.net/9M7YZ/10/)

```
.h2white{
    font-family:lemon;
    font-weight:bold;
    font-size:4em;
    color:#FFF;
    letter-spacing:-2px;
    margin-top:-86px;
    position:absolute;
} 
```

# javascript - 如何将 $.when 用于回调函数？

> ID：15211853
> 
> 赞同：0
> 
> 时间：2013-03-04T21:52:41.347
> 
> 标签：javascript, jquery

我想说当这个函数 close() 完成时运行这个函数 init()。但这对我不起作用。

```
$.when(close(toolTip)).done(init(toolTip, anchor)); 
```

我没有将 $.when 用于任何与 ajax 相关的事情，只是试图确保在调用 init() 之前完成 close()，并且不，我不能在 close() 的末尾粘贴 init()。有任何想法吗？

好的，这里是 close()

```
var close = function (toolTip) {
    toolTip.fadeOut('fast', function (e) {
        if (typeof e !== 'undefined') {
            //Re-set values applied when initted
            var toolTipBd = toolTip.find('.bd:first');
            toolTip.css('width', '');
            toolTipBd.css('max-height', '');
            toolTip.css('max-height', '');
            toolTipBd.css('overflowY', '');
        }
    });
}; 
```

在 close() 中没有任何地方可以调用 init()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:01:46.977

Simply return toolTip:

```
return toolTip.fadeOut(... 
```

using the callback to resolve a deferred object can result in odd results if there are more than one elements selected for whatever reason.

This works because jQuery objects have a `.promise` method that when called, return a promise object that resolves when all active animations are completed. `$.when` calls `.promise` on all passed in arguments.

You'll also need to call init differently, for example,

```
$.when(close(toolTip)).done(function(){
    init(toolTip, anchor);
}); 
```

And, as pointed out by others, you could then shorten that to

```
close(toolTip).promise().done(function(){
    init(toolTip, anchor);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:58:36.880

你的`close()`实现应该是这样的：

```
var close = function (toolTip) {
    var d = $.Deferred();

    toolTip.fadeOut('fast', function (e) {
        if (typeof e !== 'undefined') {
            //Re-set values applied when initted
            var toolTipBd = toolTip.find('.bd:first');
            toolTip.css('width', '');
            toolTipBd.css('max-height', '');
            toolTip.css('max-height', '');
            toolTipBd.css('overflowY', '');
        }

        d.resolve();
    });

    return d.promise();
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T21:58:50.213

`$.when`与[`Deferred`'s](http://api.jquery.com/jQuery.Deferred)一起使用。它返回一个新的，当您提供的所有 '`Deferred`都解决时，它将解决。`Deferred`

由于`close()`似乎没有返回 Promise，[将](http://api.jquery.com/jQuery.when)`when`立即解决（根据.[`when()`](http://api.jquery.com/jQuery.when)

但是，如果`close()`是同步的，则根本不需要`when()`。如果它*是*异步的，则需要返回 a `Promise`，并在动画或其他任何内容完成时解析它；

```
function close(what) {
    var promise = jQuery.Deferred();

    what.fadeOut('slow', function () {
        promise.resolve();
    });

    return promise.promise();
} 
```

...但您仍然不需要`$.when`，因为只涉及**1 个**承诺。`$.when`仅在多个 Promise 起作用时才有用。

```
close(toolTip).done(function () {
    init(toolTip, anchor);
}); 
```

另请注意，`done(init(tooltip, anchor))`将`init`立即调用，并将该函数调用的*结果*`done()`传递给; 相反，您需要传递一个*函数*来完成。由于`init`需要参数，我们通过引入匿名函数解决了这个问题。如果`init`不需要任何参数，它会很简单：

```
close(toolTip).done(init); 
```

# javascript - D3 绘制数据集的选择性部分

> ID：15211855
> 
> 赞同：6
> 
> 时间：2013-03-04T21:52:58.697
> 
> 标签：javascript, d3.js, graphing

我有一个需要绘制的大型时间序列数据集，并且正在尝试使用 D3 来完成它。我计划让我的图表以时间为 x 轴，并允许图表在 x 方向上移动。我想让图表只加载/显示屏幕上当前时间范围内存在的点。

例如，如果我的数据集有 1-100 次，但图表以显示的时间 1-10 开始，则该图表应仅绘制点 1-10。然后用户可以向右移动并看到时间 5-15 并且图表应该相应地更新。

谁能向我解释如何通过 d3 来完成？我很难将立即加载并立即绘制图形的整个数据集与数据子集的选择性图形联系起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:38:52.717

我认为您正在寻找该[`selection.filter()`](https://github.com/mbostock/d3/wiki/Selections#wiki-filter)功能。例如，您可以拥有：

```
var allNodes = vis.selectAll("Nodes").data(data.nodes); 
var validNodes = allNodes.filter(function(d){return (d.time>1 && d.time <10)});
//use normal graph functions on validNodes. 
```

您也可以直接在节点数组上应用过滤器。

# sql - 在 ssms 中创建数据库和表

> ID：15211861
> 
> 赞同：-2
> 
> 时间：2013-03-04T21:53:13.353
> 
> 标签：sql, sql-server-2008, login, permissions, ssms

我刚刚在本地计算机上安装了 ssms。

当我尝试创建数据库或数据库表时，它给了我一个错误，指出我没有正确的权限。我尝试通过访问来授予该用户的权限`Security->Logins->myUser`。但它再次告​​诉我我没有正确的权限。然后我尝试添加一个新的登录名/用户，这给了我同样的错误。

如果我安装了 ssms 并且除 之外没有其他用户，我该怎么做才能给自己正确的权限`sa`，默认情况下禁用“使用此用户登录”。我无法以其他用户身份登录，也无法更改当前用户权限。非常困惑 - 有人请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:59:34.767

在安装过程中，您（或其他人）必须添加 SA 以外的用户才能使用 Windows 身份验证登录。使用该用户。

您的用户是没有足够权限的简单用户。

如果您不是安装服务器的人，请询问安装此服务器的人为您的用户设置正确的权限。

另请查看[recover-sa-password](https://stackoverflow.com/questions/11475970/recover-sa-password)和[灾难恢复：SQL Server 2005 中 SA 帐户密码丢失时该怎么办](http://blogs.msdn.com/b/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:34:09.763

您应该检查是否将文件放置在 SQL Server 帐户（不是您登录的帐户，而是服务帐户）有权写入的文件夹中。

对于初学者，**并且不要保留在生产环境中**，请尝试确保放置数据库文件的默认路径已将“读/写”设置为“所有人”。

# android - Android - 在画布上定位位图因设备而异。怎么处理？

> ID：15211863
> 
> 赞同：1
> 
> 时间：2013-03-04T21:53:20.923
> 
> 标签：android, drawing, android-canvas

我的情况涉及绘制一个背景，其中其他对象包含在背景区域内，以进行边界。我设置了我的表面视图绘图以将我的位图布局在正确的位置，但是当我在不同的设备上进行测试时，事情不在正确的位置。

我将我的代码重构为不那么具体，并将我的所有计算都基于画布的中心（这是我给定图像的要求）。鉴于我的其他对象必须保留在图像的特定区域，我认为我可以找出 mdpi 图像上的 xy 位置并尝试根据画布的比例缩放我的位置。没用。在这一点上，我真的不确定还有什么可以尝试的。

```
//Center of canvas
float centerX = canvas.getWidth() / 2;
float centerY = canvas.getHeight() / 2;

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mBackground.getWidth() / 2), -(mBackground.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX, centerY);
canvas.drawBitmap(mBackground, mDrawingMatrix, null);

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mFlatBobble.getWidth() / 2), -(mFlatBobble.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX-(10 * mScale), centerY + (50 * mScale));
canvas.drawBitmap(mFlatBobble, mDrawingMatrix, null);

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mBobble.getWidth() / 2), -(mBobble.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX + (68 * mScale), centerY + (78 * mScale));
canvas.drawBitmap(mBobble, mDrawingMatrix, null);

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mMask.getWidth() / 2), -(mMask.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX, centerY);
canvas.drawBitmap(mMask, mDrawingMatrix, null); 
```

**EDIT2：下面的代码已过时。请参阅我在下面添加的答案。**

**编辑：**工作代码现在看起来像：

```
//In the constructor...
DisplayMetrics dm = new DisplayMetrics();
((Activity)context).getWindowManager().getDefaultDisplay().getMetrics(dm);
mTargetScreenXRatio = (float)(dm.widthPixels / 480);
mTargetScreenYRatio = (float)(dm.heightPixels / 320);

//Center of canvas
float centerX = canvas.getWidth() / 2;
float centerY = canvas.getHeight() / 2;

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mBackground.getWidth() / 2), -(mBackground.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX, centerY);
canvas.drawBitmap(mBackground, mDrawingMatrix, null);

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mFlatBobble.getWidth() / 2), -(mFlatBobble.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX-(10 * mScale * mTargetScreenXRatio), centerY + (50 * mScale * mTargetScreenYRatio));
canvas.drawBitmap(mFlatBobble, mDrawingMatrix, null);

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mBobble.getWidth() / 2), -(mBobble.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX + (68 * mScale * mTargetScreenXRatio), centerY + (78 * mScale * mTargetScreenYRatio));
canvas.drawBitmap(mBobble, mDrawingMatrix, null);

mDrawingMatrix.reset();
mDrawingMatrix.postTranslate(-(mMask.getWidth() / 2), -(mMask.getHeight() / 2));
mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(centerX, centerY);
canvas.drawBitmap(mMask, mDrawingMatrix, null); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:31:20.067

如果您的问题与我通常遇到的相同，我通过根据当前屏幕分辨率计算自己的比例来解决它。

```
DisplayMetrics dm = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(dm);

screenW = dm.widthPixels;
screenH = dm.heightPixels;

X = (float) screenW / 480;
Y = (float) screenH / 800; 
```

480 * 800 是我的参考屏幕尺寸，您可以将其更改为您喜欢的参考屏幕尺寸。

此时，您只需将坐标乘以 X 和 Y 即可获得正确的比例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:44:46.793

虽然我不会更改已接受的答案，但实际上我的做法略有不同。我没有通过检查等来手动计算分辨率变化`dm.widthPixels`，而是找到了一种更好的方法。

代码改为：

```
//Trimmed for brevity.
//In the constructor...
//mDisplayMetrics is a private variable in the class.
this.mDisplayMetrics = new DisplayMetrics();
((Activity)context).getWindowManager().getDefaultDisplay().getMetrics(dm);
//I no longer need the target ratio variables anymore.

float bobblePosX = centerX - (TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 10, this.mDisplayMetrics) * mScale);
float bobblePosY = centerY + (TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 50, this.mDisplayMetrics) * mScale);

mDrawingMatrix.postScale(mScale, mScale);
mDrawingMatrix.postTranslate(bobblePosX, bobblePosY);
canvas.drawBitmap(mFlatBobble, mDrawingMatrix, null); 
```

在上面的代码中，我改变了将之前的目标屏幕比例值乘以我想要的 mdpi 值的位置。我还需要稍微缩放位置，因为图像并不总是与屏幕分辨率匹配。

希望这可以帮助某人！

# javascript - 如何禁止访问我服务器上的目录？

> ID：15211866
> 
> 赞同：0
> 
> 时间：2013-03-04T21:53:38.987
> 
> 标签：javascript, html, networking

我经营一个音乐博客，顶部有一个播放 mp3 的播放器。我不希望用户能够查看我的代码以获取 mp3 的保存位置、访问该站点并保存 mp3。我猜我可以通过转到文件位置来禁止他们直接访问 mp3，但仍然允许我的 mp3 播放器工作。我的直觉是在我的文件中添加一些行`.htaccess`，但我对 的了解很少`htaccess`，所以有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:55:38.983

不可能。浏览器可以查看（在 Chrome 中，按 F12 并转到“网络”选项卡）实际下载文件的位置，然后直接从那里保存。

您不能阻止用户保存他已经下载的内容。

# javascript - For 循环未达到 5

> ID：15211869
> 
> 赞同：0
> 
> 时间：2013-03-04T21:53:49.843
> 
> 标签：javascript, loops, for-loop

我在 CodeAcademy 工作，试图学习一些 JavaScript，实际上我遇到了这个有趣的事情。请看这里：

```
for(var counter = 100; counter > 0; counter = counter - 5){
    console.log(counter);
} 
```

在这里，我告诉循环循环打印计数器编号，只要计数器大于 0，但它最终只会将 100..95..90 等打印到 5。我知道如何解决这个问题，只需在大于号之后添加一个简单的等号。像这样：

```
for(var counter = 100; counter >= 0; counter = counter - 5){
    console.log(counter);
} 
```

但我很想知道为什么这不起作用？我的意思是它以 5 结束输出，5 大于 0，不是吗？当我在大于号之前放置一个等号时，它确实应该输出一些未定义的数字，因为即使计数器等于 0，它也应该循环。我的头因此而受伤。谁能解释一下，谢谢：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:59:02.987

不，一旦达到零，它就不应该继续循环。for 循环的工作方式是这样的：

```
for (initialization; condition; increment) {
    body;
} 
```

它按以下顺序执行这些操作：

```
initialization
loop {
    condition true? then:
        body
        increment
    else:
        stop loop
} 
```

因此，当计数器达到零时，条件为假，并且计数器的值为“0”时不会执行主体，它将简单地停止。但是，当您输入 >= 时，此时条件仍然为真。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:59:37.963

“for”循环的英文翻译是：

1.  将计数器设置为 100
2.  如果 counter > 0 不为真，则结束此块
3.  运行此代码块（在本例中为日志计数器）
4.  将计数器减少 5
5.  返回第 2 步

因此，在这种情况下，如果计数器为零，则它不 > 0，因此代码不会返回到步骤 2。而在第二种情况下，它 >= 0，因此它最后一次运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T22:00:25.557

让我们看看这里发生了什么，

当你说`counter > 0`时，它应该继续直到它*严格*大于零。由于零不大于自身，因此循环在 5 处停止。

然后，当您将表达式更改为 时`counter>=0`，它会告诉编译器继续直到计数器大于或等于零，因此它也会继续打印零。

# entity-framework - 从 VS 2012 发布到 Azure 网站时，我的实体框架种子数据未插入 SQL Azure

> ID：15211870
> 
> 赞同：5
> 
> 时间：2013-03-04T21:53:49.850
> 
> 标签：entity-framework, visual-studio-2012, entity-framework-5, azure-sql-database, azure-web-app-service

我有一个使用 Entity Framework 5.0 和 Code First 的 ASP.NET MVC 应用程序。

我已使用 Visual Studio 2012 将我的网站发布到 Azure 网站。除了种子数据没有插入 SQL Azure 之外，一切似乎都正常工作；**网站正常工作，建立数据库，但未**插入种子数据。当我在本地机器上运行它时，一切正常。

根据我看到的示例，从 Visual Studio 2012 发布时，有一个名为“执行代码优先迁移”的选项（见下图）。

![在此处输入图像描述](../Images/94be27de7e4bb44d333cd1ad593684e7.png)

但是当我尝试发布我的网站时，“执行代码优先迁移”选项**不可**用。 ![在此处输入图像描述](../Images/2c05643431816b0805657d1c5097d4d0.png)

我相信这可能与我的解决方案的配置方式有关。我有 3 个项目构成我的应用程序。

*   **网站**——这是一个 ASP.NET MVC 项目。它确实有一个参考实体框架，但所有数据访问代码（DBContext）都在数据项目中
*   **域**——这是一个类库。它没有对实体框架的引用
*   **数据**——这个项目参考了实体框架。我有一个继承自 DbMigrationsConfiguration 的配置类。在这个配置类中，我重写了 Seed 方法。

同样，这一切都适用于我的本地电脑。大多数情况下，一切都在 Azure 上运行；网站正常工作，建立数据库，但未插入种子数据。

对于我的场景，当我从 Visual Studio 2012 发布时，是否有任何建议如何将种子数据插入 SQL Azure？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T10:39:03.907

您将需要手动编辑您的 pubxml 文件 (Properties/PublishingProfiles/YourName.pubxml) 以使复选框出现。我有一篇博客文章描述了这里的情况和解决方案：http: [//www.dominicstpierre.net/2012/11/enable-code-first-migrations-check-box.html](http://www.dominicstpierre.net/2012/11/enable-code-first-migrations-check-box.html)

这部分需要手动更改

```
<PublishDatabaseSettings>
  <Objects xmlns="">
    <ObjectGroup Name="Namespace.Models.YourDBClass" Order="1" Enabled="True">
      <Destination Path="your-connection-string-goes-here" />
      <Object Type="DbCodeFirst">
        <Source Path="DBMigration" DbContext="Namespace.Models.YourDBClass, AssamblyName" MigrationConfiguration="Namespace.Migrations.Configuration, Assambly" Origin="Convention" />
      </Object>
    </ObjectGroup>
  </Objects>
</PublishDatabaseSettings> 
```

通过继承 DbContext 的类更改 Namespace.Models.YourDBClass，更改 Namespace.Migratins.Configuration 以适应您的迁移配置命名空间，并使用您的 Assambly 名称更改 Assambly。

保存并打开发布向导，您将拥有该复选框。

# ios - UIImageView 触控点

> ID：15211873
> 
> 赞同：1
> 
> 时间：2013-03-04T21:54:04.363
> 
> 标签：ios, uiview, uiimageview

我有一个包含缩放图像的 UIImageView。图像大小为 3264 x 2448，UIImageView contentMode 设置为 AspectFit。UIImageView 的大小为 320 x 427。我有以下视图层次结构：

```
WorkspaceView : UIView
   -> UIImageView (Contains the image)
   -> A UIView which contains a UITapGestureRecognizer 
```

我目前正在尝试基于 UIImageView （具有较大的 XY 坐标空间 - 2448）从触摸中获取坐标。UIView 基于它自己的视图而不是它的父视图引发触摸。它封装了 UITapGestureRecognizer 以便引发委托调用。

当给定 UIView 内的坐标时，如何获得缩放的 XY 触摸点？我已经尝试了以下代码，但它似乎不起作用：

```
- (void)lineView:(LineView *)aLineView requestsDistanceForLine:(Line *)line {
   // aLineView is the subview
   // line contains the startpoint and endpoint of the aLineView - it's the model
   // capturedImageView is the local instance of the scaled UIImageView
   CGPoint startPoint =[self convertPoint:[line startPoint] toView:self.capturedImageView];
} 
```

startPoint 最终太小了。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:46:37.990

原来有人已经解决了这个问题。这是它的 github 存储库的链接。

[https://github.com/nubbel/UIImageView-GeometryConversion](https://github.com/nubbel/UIImageView-GeometryConversion)

# php - 正则表达式匹配可能转义的引号

> ID：15211874
> 
> 赞同：1
> 
> 时间：2013-03-04T21:54:12.940
> 
> 标签：php, regex, escaping

我正在尝试编写一个正则表达式来匹配单引号，这可能会被转义。匹配的引号前面应该有偶数个反斜杠（奇数表示引号被转义）。例如，在这五个字符串中：

```
'quotes should be matched'
\'quotes should NOT be matched\'
\\'quotes should be matched\\'
\\\'quotes should NOT be matched\\\'
\\\\'quotes should be matched\\\\' 
```

这是我拥有的正则表达式：

```
(?<=[^\\](?:\\\\)*)' 
```

但是，这与上述示例中的任何内容都不匹配。我觉得这很奇怪，因为`*`从正则表达式中删除 与两个反斜杠匹配的引号，因为它应该：

`(?<=[^\\](?:\\\\))'`火柴`\\'`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:26:25.427

据我所知，不可能只匹配`'`. 这是因为您不能像 Wiseguy 指出的那样进行动态长度后视。

但是，以下正则表达式将匹配正确的`'`AND 任何`\`导致它的 s。不确定这是否有任何用处..

```
(?<!\\)(?:\\\\)*' 
```

匹配任意数量的`\`前面没有 a`\`并且后面跟着 a的 double `'`。

# mysql - 一张有 Nulls 的桌子 vs 两张桌子

> ID：15211881
> 
> 赞同：0
> 
> 时间：2013-03-04T21:54:39.190
> 
> 标签：mysql, null

假设我有一个简单的情况。我的网站有`user`表格，我需要在某处放置激活码以进行电子邮件验证。

什么是更好的选择：

1.  `activation_code`表中的列`user`，这意味着当电子邮件已被验证时，我将获得 NULL 或无用数据。但另一方面，我敢肯定，我每个用户只有一个代码，而且少了一个表。
2.  单独的代码表。没有无用的数据或 NULL。但是一列的附加表（+ user_id）。

因为我尽量不使用任何 NULL（那是因为我被教过，不确定是否正确），我更喜欢第二个选项。但是我在许多网络应用程序中看到了第一种方式，所以这就是我提出这个问题的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:56:28.813

我会提倡使用单独的表格，因为在我看来它可以更好地模拟数据。它还允许您为同一用户生成多个激活码 - 这可以派上用场！

另一方面，我完全不同意不使用 NULL 的做法。我知道有些人主张避开它们，原因通常可以归因于懒惰，但现实情况是 NULL 在建模数据时非常有用！它们的目的是表示**缺失的数据**或**未知值**，它们绝对应该用于此目的！

# sql-server - 在 Sql Server 查询中将聚合表与另一个表连接起来

> ID：15211883
> 
> 赞同：-1
> 
> 时间：2013-03-04T21:54:55.347
> 
> 标签：sql-server

我有 2 张桌子 -`AfricanRatings`和`AfricanRatingsAVG`. `AfricanRatingsAVG`是查询的结果：

```
INSERT INTO AfricanRatingsAVG 
SELECT RecipeID, COUNT(*) AS Count, AVG(Rating) AS RatingAVG
FROM AfricanRatings
GROUP BY RecipeID 
```

此查询工作正常，并`AfricanRatingsAVG`在新条目进入时更新`AfricanRatings`。

使用了 GridView 控件，并且来自 AfricanRatingsAVG 的数据在 GridView 中显示得很好。我的问题：我还想从第三个表中获取数据，AfricanRecipes 也包含在同一个 GridView 中。我在 JOIN 之后尝试了 JOIN，但没有结果。尝试的最后两个 JOINS 是：

```
SelectCommand="SELECT * 
FROM (SELECT RecipeID, COUNT(*) AS Count, AVG(Rating) AS RatingAVG
FROM AfricanRatings
GROUP BY RecipeID  ) AS AfricanRatingsAVG
JOIN (SELECT AfricanRecipes.RecipeID, AfricanRecipes.Category, AfricanRecipes.Name, AfricanRecipes.Description
FROM AfricanRecipes
GROUP BY RecipeID  ) AS AfricanRecipes ON (AfricanRatingsAVG.RecipeID = AfricanRecipes.RecipeID)" 
```

和

```
SelectCommand="SELECT * 
FROM (SELECT RecipeID, COUNT(*) AS Count, AVG(Rating) AS RatingAVG
FROM AfricanRatings
GROUP BY RecipeID  ) AS AfricanRatingsAVG
JOIN AfricanRecipes.RecipeID, AfricanRecipes.Category, AfricanRecipes.Name, AfricanRecipes.Description
FROM AfricanRecipes
GROUP BY RecipeID AS AfricanRecipes ON (AfricanRatingsAVG.RecipeID = AfricanRecipes.RecipeID)" 
```

上面的第一个 JOIN 给出了错误消息：列`AfricanRecipes.Category`在选择列表中无效，因为它既不包含在聚合函数中，也不包含在`GROUP BY`子句中。

第二个 JOIN 给出错误消息：

> ',' 附近的语法不正确

我已经尝试了上述连接的数十种变体，但都没有运气。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:08:12.857

```
SELECT 
    AfricanRatingsAVG.*,
    AfricanRecipes.RecipeID, 
    AfricanRecipes.Category, 
    AfricanRecipes.Name, 
    AfricanRecipes.Description 
FROM (
    SELECT 
       RecipeID, 
       COUNT(*) AS RecipeCount, 
       AVG(Rating) AS RatingAVG 
    FROM AfricanRatings 
    GROUP BY RecipeID 
) AfricanRatingsAVG 
    JOIN AfricanRecipes
        ON AfricanRatingsAVG.RecipeID = AfricanRecipes.RecipeID 
```

# java - 如何在 Openide 层中定位文件夹

> ID：15211884
> 
> 赞同：0
> 
> 时间：2013-03-04T21:54:55.943
> 
> 标签：java, xml, openide

我想在我的文件菜单中放置一个子菜单。编写类不起作用，所以我在模块的 layer.xml 中放置了一个文件夹。现在我无法指定放置它的位置。如何在 layer.xml 中指定子菜单文件夹的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:54:55.943

这让我花了很长时间才弄清楚。它就像`<attr name=position intvalue="pos"/>`在文件夹声明之后添加`pos`您希望放置文件夹的位置一样简单。结果如下所示：

```
<folder name="myFolder">
    <attr name="position" intvalue="0"/>
</folder> 
```

# c# - 记录集循环的替代方案

> ID：15211886
> 
> 赞同：0
> 
> 时间：2013-03-04T21:55:00.090
> 
> 标签：c#, loops, sqldatareader

过去使用 ADO，我们使用 GetRows() 拉回一个数组并循环遍历它，因为它比使用 rs.MoveNext 遍历记录要快。我正在编写一个应用程序，它可以拉回 50 万行并将它们写到一个文件中。从 SQL 中提取数据大约需要 3 分钟，但将其写入 CSV 则需要另外 12 分钟。从它的外观来看，这是因为我正在循环一个 SqlDataReader。什么是更快的选择？

请记住，我不知道 SQL 结构会是什么样子，因为它正在调用一个报告表，该表告诉我的应用程序应该调用什么查询。我查看了使用 linq 并返回一个数组，但这需要知道结构，所以这不起作用。

注意下面的代码，case 语句有很多情况，但是为了节省空间，我把它们都删除了，除了一个。

```
StringBuilder rowValue = new StringBuilder();
SqlDataReader reader = queryData.Execute(System.Data.CommandType.Text, sql, null);

//this is to handle multiple record sets
while (reader.HasRows)
{
  for (int i = 0; i < reader.FieldCount; i++)
  {
    if (rowValue.Length > 0)
        rowValue.Append("\",\"");
    else
        rowValue.Append("\"");
    rowValue.Append(reader.GetName(i).Replace("\"", "'").Trim());
  }
  rowValue.Append("\"" + Environment.NewLine);

  File.AppendAllText(soureFile, rowValue.ToString());

  while (reader.Read())
  {
    rowValue = new StringBuilder();

    for (int i = 0; i < reader.FieldCount; i++)
    {
      String value = "";
      switch (reader.GetFieldType(i).Name.ToLower())
      {
          case "int16":
              value = reader.IsDBNull(i) ? "NULL" : reader.GetInt16(i).ToString();
              break;
      }

      if (rowValue.Length > 0)
          rowValue.Append("\",=\"");               //seperate items
      else
          rowValue.Append("\"");                  //first item of the row.

      rowValue.Append(value.Replace("\"", "'").Trim());
    }
    rowValue.Append("\"" + Environment.NewLine);    //last item of the row.

    File.AppendAllText(soureFile, rowValue.ToString());
    }  

  //next record set
  reader.NextResult();

  if (reader.HasRows)
    File.AppendAllText(soureFile, Environment.NewLine);
}

reader.Close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:46:28.903

这里的问题几乎可以肯定是您正在调用`File.AppendAllText()`每一行。由于`AppendAllText`每次调用文件时都会打开、写入和关闭文件，因此它会变得非常慢。

更好的方法是使用该`AppendText()`方法或显式`StreamWriter`.

# powershell - 开始使用 Powershell 脚本调试 Visual Studio 项目

> ID：15211887
> 
> 赞同：4
> 
> 时间：2013-03-04T21:55:04.813
> 
> 标签：powershell, visual-studio-2012

我以前在 Visual Studio 中打开一个解决方案文件，右键单击一个项目，选择“调试”->“启动一个新实例”以启动一个调试会话。

我可以编写一个 powershell 脚本来自动执行此操作吗？为方便起见，自动化不必重新构建和 Project，脚本只需要在 Visual Studio 中启动一个调试会话，执行 myApplication.debug.exe

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-16T10:01:40.910

Visual Studio 有一个“DebugExe”命令行参数，您可以使用它来完成此操作。

```
param
(
    [Parameter(Mandatory = $false)]
    [String]
    $TargetFileName
)

& "C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe" /command "Debug.Start" /debugexe "$TargetFileName" 
```

# python - TypeError: 正好需要 2 个参数（给定 1 个）

> ID：15211893
> 
> 赞同：-2
> 
> 时间：2013-03-04T21:55:27.377
> 
> 标签：python

```
class DLLNode(object):

    def __init__(self, data, prev_link, next_link):  
        self.data = data
        self.prev_link = prev_link
        self.next_link = next_link

class DoublyLinkedList(object):

    def __init__(self):
        self.head=None
        self.tail=None

    def add_head(self, add_obj):
        self.head=DLLNode(add_obj,None,self.head) 
```

* * *

```
>>> x=DoublyLinkedList
>>> x.add_head(1)
Traceback (most recent call last):
  File "<pyshell#20>", line 1, in <module>
    x.add_head(1)
TypeError: add_head() takes exactly 2 arguments (1 given) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:57:12.840

猜测 x 不算作参数，因为它没有被正确实例化。

```
x = DoublyLinkedList() 
```

不是

```
x = DoublyLinkedList 
```

不包括括号将`DoublyLinkedList`模块对象分配给 x，它不会创建一个新对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T21:58:31.363

当你写

```
x = DoublyLinkedList 
```

您将类分配`DoublyLinkedList`给`x`，而不是它的实例。`add_head`作为实例方法，它不能直接在类上调用。相反，您需要使用

```
x = DoublyLinkedList()
x.add_head(1) 
```

这样，python 将能够替换`self`为`x`，并且您的调用将有 2 个参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T22:04:02.633

分配给 x 时需要创建对象的实例

```
 x = DoublyLinkedList() 
```

前一种语法 (DoubleLinkedList) 是允许的，因为类作为对象是有效的。

# .net - 初始化和分区磁盘 - 如何防止出现“您需要格式化磁盘”消息？

> ID：15211900
> 
> 赞同：2
> 
> 时间：2013-03-04T21:56:16.670
> 
> 标签：.net, windows, format, partitioning

我正在尝试从应用程序初始化、分区和格式化磁盘。操作系统是 Windows Server 2008 R2。我对这些任务使用哪种方法并不重要，但假设我使用的是 DeviceIoControl API。

一旦应用程序初始化并创建了一个分区，Windows 就会弹出一个消息框，说“您需要格式化磁盘...

![在此处输入图像描述](../Images/11fbdcf387c0e8138846e898d453c9d1.png)"

因此，即使我的应用程序立即格式化此磁盘，消息框仍然存在，用户会感到困惑，实际上可以再次格式化它。

有没有办法阻止 Windows 弹出该消息框？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T17:12:30.920

看起来情况比我最初的情况要复杂一些。让我在这里解释一下我的发现，可能对其他人有用。

您以哪种方式初始化和格式化驱动器确实很重要。例如，以下**diskpart**脚本将执行所有操作，Windows**不会**弹出该消息：

```
select disk 2
create partition primary
select part 1
format fs=ntfs label="NEW DISK" quick
assign letter Z
exit 
```

但是，如果您尝试先分配字母，然后执行格式 - 将出现消息。

但就我而言，我不想依赖diskpart。我使用**DeviceIoControl** API 来初始化和分区磁盘，然后等待 WMI 识别卷，所以我可以通过 WMI 格式化它。

不幸的是，锁定装置也不是一种选择。因为如果我这样做，WMI 将无法识别该卷。

基于这个答案[如何在没有 Windows 分配驱动器号的情况下创建分区？](https://stackoverflow.com/questions/10457254/how-to-create-a-partition-without-windows-assigning-a-drive-letter/11867015#11867015)我决定停止和启动**ShellHWDetection**服务，实际上效果很好。

# javascript - 返回 tr 标签的“值”属性

> ID：15211904
> 
> 赞同：1
> 
> 时间：2013-03-04T21:56:30.090
> 
> 标签：javascript, jquery, return-value, html-table

我有下表：

```
<table id="messages" border="1">
  <tbody>
    <tr>
      <th>Name</th>
      <th>Text</th>
      <th>Subject</th>
    </tr>
    <tr value="1">
      //data
    </tr>
    <tr value="2">
      //data
    </tr>
  </tbody>
</table> 
```

我需要一些 jquery 来返回点击的 tr 的 val 属性。我已经有 jquery，它将返回 tr 内所有封闭 td 的数组，但我仍然需要将“值”保存到变量中。有什么帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-04T21:59:41.797

不建议`value`为非输入元素添加属性，因为这对浏览器没有意义。使用（其中*一个*唯一表行的 jQuery 对象）更改`<tr value="1">`并`<tr data-value="1">`访问它。`$tr.data('value')``$tr`

 *[http://api.jquery.com/data/](http://api.jquery.com/data/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T22:02:47.600

您可以使用`$(this).attr('value')`来获取属性，但某些浏览器可能不支持这样的非标准属性。最好使用数据属性：

```
<tr data-value="1"> 
```

然后你可以使用`$(this).data('value')`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T21:58:20.307

使用 jQuery

`var variable = $('tr').val();`

或者

`var variable = $('tr').attr('value');`

即使给 tr 元素赋值是不正确的*

# android - 画布问题 - 绘图时滚动和缩放（保持透视）

> ID：15211905
> 
> 赞同：1
> 
> 时间：2013-03-04T21:56:38.560
> 
> 标签：android, android-canvas

我的问题是我正在将矩形绘制到屏幕上，并且希望能够在一个方向上滚动并继续绘制。这是一个基本的房屋平面图绘图应用程序。

我先画一个正方形：

![1](../Images/1e850f1592867a7924d10e6e475f2f78.png)

然后我单击`MOVE SCREEN`按钮并切换到“移动模式”。我捏缩小以绘制相邻的房间：

![2](../Images/83942cdc1873eced2d7f24ececba4648.png)

然后我希望能够画出这个：

![3](../Images/37dcc07b9897294b64915f2d74728b46.png)

但是，一旦我单击`DRAW`模式并开始绘制第二个房间，就会发生这种情况：

![4](../Images/5b483b3984625416a7ebbb056db86919.png)

即它恢复到原始缩放并绘制在错误的位置。我意识到它可能是我在`onDraw()`方法中的代码。这是我的代码：

```
class HomerView extends View { // the custom View for drawing on

    // set up Bitmap, canvas, path and paint
    private Bitmap myBitmap; // the initial image we turn into our canvas
    private Canvas myCanvas; // the canvas we are drawing on
    private Rect myRect; // the mathematical path of the lines we draw
    private Paint myBitmapPaint; // the paint we use to draw the bitmap

    // get the width of the entire tablet screen
    private int screenWidth = getContext().getResources().getDisplayMetrics().widthPixels;
    // get the height of the entire tablet screen
    private int screenHeight = getContext().getResources().getDisplayMetrics().heightPixels;

    private int mX, mY, iX, iY; // current x,y and initial x,y
    private static final float TOUCH_TOLERANCE = 4;
    private static final int INVALID_POINTER_ID = -1;
    private float mPosX;
    private float mPosY;
    private float mLastTouchX;
    private float mLastTouchY;
    private int mActivePointerId = INVALID_POINTER_ID;
    private ScaleGestureDetector mScaleDetector;
    private float mScaleFactor = 1.f;

    public HomerView(Context context) { // constructor of HomerView
        super(context);
        myBitmap = Bitmap.createBitmap(screenWidth, screenHeight,
                Bitmap.Config.ARGB_8888); // set our drawable space - the bitmap
                                          // which becomes the canvas we draw on
        myCanvas = new Canvas(myBitmap); // set our canvas to our bitmap which
                                         // we just set up
        myRect = new Rect(); // make a new rect
        myBitmapPaint = new Paint(Paint.DITHER_FLAG); // set dither to ON in our
                                                      // saved drawing - gives
                                                      // better color
                                                      // interaction
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
    }

    public HomerView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
    }

    public HomerView(Context context, AttributeSet attrs) {
        this(context, attrs, 0);
    }

    protected void onDraw(Canvas canvas) { // method used when we want to draw
                                           // something to our canvas
        super.onDraw(canvas);
        if (addObjectMode == true || addApplianceMode == true) {
            canvas.drawColor(Color.TRANSPARENT); // sets canvas colour
            canvas.drawBitmap(myBitmap, 0, 0, myBitmapPaint); // save the canvas
                                                              // to bitmap - the
                                                              // numbers are the
                                                              // x, y coords we
                                                              // are drawing
                                                              // from
            canvas.drawRect(myRect, myPaint); // draw the rectangle that the
                                              // user has drawn using the paint
                                              // we set up
        } else if (moveMode == true) {
            canvas.save();
            canvas.translate(mPosX, mPosY);
            canvas.scale(mScaleFactor, mScaleFactor);
            canvas.drawBitmap(myBitmap, 0, 0, myBitmapPaint); // if not present
                                                              // - nothing is
                                                              // moved
            canvas.restore();
        }
    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) { // if
                                                                     // screen
                                                                     // size
                                                                     // changes,
                                                                     // alter
                                                                     // the
                                                                     // bitmap
                                                                     // size
        super.onSizeChanged(w, h, oldw, oldh);
    }

    private void touch_Start(float x, float y) { // on finger touchdown
        // check touch mode
        iX = (int) (Math.round(x));
        iY = (int) (Math.round(y));
        mX = (int) (Math.round(x));
        mY = (int) (Math.round(y));
        if (addObjectMode == true) {
            myRect.set(iX, iY, mX, mY);
        } else if (addApplianceMode == true) {
            // code to draw an appliance icon at mX, mY (with offset so icon is
            // centered)
            if (isLamp == true) {
                Resources res = getResources();
                bmp = BitmapFactory.decodeResource(res, R.drawable.lamp);
                myCanvas.drawBitmap(bmp, iX - 50, iY - 50, myBitmapPaint);
            } else if (isPC == true) {
                Resources res = getResources();
                bmp = BitmapFactory.decodeResource(res, R.drawable.pc);
                myCanvas.drawBitmap(bmp, iX - 50, iY - 50, myBitmapPaint);
            } else if (isKettle == true) {
                Resources res = getResources();
                bmp = BitmapFactory.decodeResource(res, R.drawable.kettle);
                myCanvas.drawBitmap(bmp, iX - 50, iY - 50, myBitmapPaint);
            } else if (isOven == true) {
                Resources res = getResources();
                bmp = BitmapFactory.decodeResource(res, R.drawable.oven);
                myCanvas.drawBitmap(bmp, iX - 50, iY - 50, myBitmapPaint);
            } else if (isTV == true) {
                Resources res = getResources();
                bmp = BitmapFactory.decodeResource(res, R.drawable.tv);
                myCanvas.drawBitmap(bmp, iX - 50, iY - 50, myBitmapPaint);
            }
        }
    }

    private void touch_Move(float x, float y) { // on finger movement
        float dX = Math.abs(x - mX); // get difference between x and my X
        float dY = Math.abs(y - mY);
        if (dX >= TOUCH_TOLERANCE || dY >= TOUCH_TOLERANCE) { // if coordinates
                                                              // are outside
                                                              // screen? if
                                                              // touching hard
                                                              // enough?
            mX = (int) (Math.round(x));
            mY = (int) (Math.round(y));
            if (addObjectMode == true) {
                myRect.set(iX, iY, mX, mY);
            }
        }
    }

    @SuppressWarnings("deprecation")
    private void touch_Up() { // on finger release
        if (addObjectMode == true) {
            myRect.set(iX, iY, mX, mY);
            myCanvas.drawRect(iX, iY, mX, mY, myPaint);
            if (eraseMode == false) {
                dialogStarter();
            }
        } else if (addApplianceMode == true) {
            showDialog(DIALOG_DEVICE_ENTRY);
        }
    }

    public boolean onTouchEvent(MotionEvent event) { // on any touch event
        if (addObjectMode == true || addApplianceMode == true) {

            float x = event.getX(); // get current X
            float y = event.getY(); // get current Y

            switch (event.getAction()) { // what action is the user performing?
            case MotionEvent.ACTION_DOWN: // if user is touching down
                touch_Start(x, y);
                invalidate();
                break;
            case MotionEvent.ACTION_MOVE: // if user is moving finger while
                                          // touched down
                touch_Move(x, y);
                invalidate();
                break;
            case MotionEvent.ACTION_UP: // if user has released finger
                touch_Up();
                invalidate();
                break;
            }
            return true;
        } else if (moveMode == true) {
            mScaleDetector.onTouchEvent(event);
            final int action = event.getAction();
            switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                final float x = event.getX();
                final float y = event.getY();
                mLastTouchX = x;
                mLastTouchY = y;
                mActivePointerId = event.getPointerId(0);
                invalidate();
                break;
            }
            case MotionEvent.ACTION_MOVE: {
                final int pointerIndex = event
                        .findPointerIndex(mActivePointerId);
                final float x = event.getX(pointerIndex);
                final float y = event.getY(pointerIndex);

                // Only move if the ScaleGestureDetector isn't processing a
                // gesture.
                if (!mScaleDetector.isInProgress()) {
                    final float dx = x - mLastTouchX;
                    final float dy = y - mLastTouchY;
                    mPosX += dx;
                    mPosY += dy;
                    invalidate();
                }
                mLastTouchX = x;
                mLastTouchY = y;
                break;
            }

            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_POINTER_UP: {
                final int pointerIndex = (event.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = event.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = event.getX(newPointerIndex);
                    mLastTouchY = event.getY(newPointerIndex);
                    mActivePointerId = event.getPointerId(newPointerIndex);
                }
                break;
            }
            }
            invalidate();
            return true;
        } else {
            return false;
        }
    }

    public void drawApplianceIcon() {
        myCanvas.drawBitmap(bmp, iX - 50, iY - 50, myBitmapPaint);
        makeToast("BMP drawn to canvas = " + bmp);
    }

    private class ScaleListener extends
            ScaleGestureDetector.SimpleOnScaleGestureListener {

        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();

            // Don't let the object get too small or too large.
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 10.0f));
            invalidate();
            return true;
        }
    }
} 
```

任何人都可以拆开我的代码，以便我可以直接在缩放或平移的图像上绘制吗？我是不是找错了树，我应该只使用垂直和水平滚动条吗？缩放并不是绝对必要的。

任何帮助将非常感激！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:00:36.823

在非移动模式下，您的 onDraw 不会缩放画布。这意味着一旦您进入任何其他模式，您就会永久失去比例因子。你需要解决这个问题。

# php - PHP：使用准备发布，不工作

> ID：15211906
> 
> 赞同：-1
> 
> 时间：2013-03-04T21:56:38.723
> 
> 标签：php, sql, prepared-statement

我尝试将表单的数据存储到数据库中。我无法弄清楚为什么这段代码不起作用......什么也没有发生。感谢您的帮助。这是我的代码：

```
<?php
// Connexion à la base de données
try
{
$bdd = new PDO('mysql:host=localhost;dbname=mydb', 'root', '');
}
catch(Exception $e)
{
die('Erreur : '.$e->getMessage());
}
// Insertion du message à l'aide d'une requête préparée

$auteur="Henri";

$req = $bdd->prepare('INSERT INTO factures (projet, fournisseur, montant, ref, in_out, commentaires, auteur, input_date, maturity) VALUES(:projet, :fournisseur, :montant, :ref, :in_out, :commentaires, :auteur, CURDATE(), :maturity');
$req->execute(array(
                    'projet'=>$_POST['projet'], 
                    'fournisseur'=>$_POST['fournisseur'], 
                    'montant'=>$_POST['montant'], 
                    'ref'=>$_POST['ref'],
                    'in_out'=>$_POST['in_out'],
                    'commentaires'=>$_POST['commentaires'], 
                    'auteur'=>$auteur,
                    'maturity'=>$_POST['maturity']
                    ));

header('Location: index.php');
?> 
```

正确的代码： - 'projet'=>$_POST['projet'] 必须是 ':projet'=>$_POST['projet'], - 在 VALUES SQL 查询的末尾缺少 )。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:59:59.860

正如您从[文档](http://php.net/manual/en/pdo.prepared-statements.php)中看到的那样，您放入准备好的 SQL 语句中的值必须与您传递给 execute() 的值完全匹配。

IE：

`'projet'=>$_POST['projet'],`应该`':projet'=>$_POST['projet'],`

你的代码什么都不做的原因是因为值`$_POST['projet']`被映射到'projet'。因为 'project' 没有出现在您的 SQL 语句中，所以它没有被映射。但是，在这种情况下，您的 SQL 语句中缺少一个“)”。

但是，使用 PDO 而不是 my_sql 函数值得称赞。

# vim - 将 UDF 结果传递给 VIM 中的 :tabe

> ID：15211913
> 
> 赞同：1
> 
> 时间：2013-03-04T21:57:12.670
> 
> 标签：vim, user-defined-functions

我在 .vimrc 中编写了一个小函数来将字符串转换为文件路径。

```
function FindPath(param)
    " some logic here
    return goodPath
endfunction 
```

这很有效。我想要做的是绑定一个键以使用 FindPath 和当前 cWORD 的结果打开一个新选项卡。我似乎无法弄清楚如何让它将结果传递给：tabe。它要么按字面意思对待它，要么我到处都遇到语法错误。

```
nnoremap <leader>c :tabe FindClass(<cWORD>) 
```

基本上是我在伪代码意义上想要的，我只是无法获得正确的语法来挽救我的生命，这有点难以搜索。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:31:02.213

我不太使用标签，我猜你被卡在`exec`and`expand()`部分。你可以试试这条线：

```
:exec 'tabe '.FindPath(expand("<cWORD>")) 
```

如果这对您有用，您可以按照自己的方式创建地图，例如：

```
nnoremap <leader>c :exec 'tabe '.FindPath(expand("<cWORD>"))<cr> 
```

# python - boto simpledb 不支持 desc 排序？或者我很困惑

> ID：15211915
> 
> 赞同：2
> 
> 时间：2013-03-04T21:57:14.410
> 
> 标签：python, boto, amazon-simpledb

在我看来，python 的 boto 不支持 DESC 排序。例如：

```
conn.create_domain('testing')

dom = conn.get_domain('testing')

dom.put_attributes ('hulk', { 'color': 'green', 'strength' : 90 })
dom.put_attributes ('iron man', { 'color': 'yellow', 'strength' : 50 })
dom.put_attributes ('me', { 'purple': 'blue', 'strength' : 1 })
dom.put_attributes ('superman', { 'color': 'red', 'strength' : 100 })
dom.put_attributes ('captain america', { 'color': 'blue', 'strength' : 10 })

q = dom.select ("select * from testing where strength is not null order by strength desc", consistent_read=True, max_items=1)
for r in q:
    print "strongest is " + str(r.name) + " " + r['strength']

conn.delete_domain('testing') 
```

结果是：

```
strongest is hulk 90 
```

好吧，boto 或 SimpleDB 是由 Marvel 的铁杆粉丝编写的，或者我不理解某些东西，因为这不应该是结果。

现在，如果我将其切换为“按强度排序”，我会得到：

```
strongest is me 1 
```

因此，如果您上升，似乎排序可以正常工作，但如果您下降，则不能正常工作？

我正在尝试模拟 SQL MAX() 函数的等效项，SimpleDB 的 SELECT 语法不支持该函数。

顺便说一句，实际的数据集，唉，色彩要少得多。

# qt - Qt 5 关于 QT / QML 和 Widget 自定义的一般问题

> ID：15211917
> 
> 赞同：3
> 
> 时间：2013-03-04T21:57:23.990
> 
> 标签：qt

我是一名 iOS / Cocoa 开发人员，希望将我的一个应用程序移植到 PC 平台。我不在乎编写多平台代码并维护一个应用程序。我将继续使用 cocoa 和 cocoa touch 进​​行 iOS Mac 开发。我选择在 PC 上使用 QT 5，我不确定它是否明智的选择，但它很简单，我可以理解 c++。如果不是，请指出正确的方向。

我的应用程序不是很复杂，但需要一些特殊的自定义，例如看起来像 iOS 表视图的 ListView，使用带有 twitter 引导样式搜索框的自定义圆形窗口，我想监视一些全局 OS 事件，如击键，以及用户的其他应用程序目前正在合作。我还使用 SQLite 和 AES 加密。

我的问题是关于 UI 定制的。

1.  我应该开始学习并为此使用 QML 吗？我不确定它到底是什么，看起来非常简单的 CSS，但我感觉更多的是为嵌入式设备设计的并且有局限性......

2.  如果我使用 QML，我是否可以使用 QT 的全部功能？

3.  我必须使用 QML 来自定义小部件的其他选项（例如，在目标 C 中，我们使用子类化和绘制我们想要的任何东西或处理事件......）

4.  我对windows平台没有经验。我应该使用 VisualStudio C++ 而不是 QT5 吗？随着所有权的变化，我感到有些不安全。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T09:43:05.970

1.  是的你应该。QML 是声明性语言，允许在其中执行 javascript。你几乎可以做任何与 QML 相关的 UI。如果您没有某些特定的 UI 元素，您可以用纯 C++(Qt) 绘制它并在 QML 中使用它。所以QML是目前Qt开发的最佳选择。虽然它不像 CSS，但它更强大。
2.  是的，您拥有 Qt 的所有功能以及声明性语言可能提供的额外功能 - 简化 UI 开发过程以及现代分解 UI 和逻辑。
3.  您可以在纯 C++ Qt 中使用此选项，您可以子类化小部件、重绘它们、更改行为等。这种方法不如 QML 方法。
4.  这一点没有意义。有些人将 Visual C++ 视为单独的语言，这是错误的。您可以将 Visual C++ 视为 C++ + MS 编译器的一些次要扩展。但是将其称为 GCC C++ 是很可笑的。因此，如果您使用免费提供的 Qt 集成插件，基本上您几乎可以轻松地将 Visual Studio 与 Qt 一起使用。或者你可以选择 Qt creator，有些人认为它优于 MSVS。选择什么取决于您，但我相信对于新手来说，将 Qt creator 与 Qt 一起使用要简单得多。但请注意，您将需要一些编译器，因为 Qt 创建者只是一个 IDE，它应该使用一些第 3 方编译器（MS 或 GNU 之一）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T09:23:43.250

您可以使用 QML 桌面组件轻松构建您的应用程序： [https ://web.archive.org/web/20121203050945/http://blog.qt.digia.com/blog/2012/06/06/desktop-components- for-qt-5/](https://web.archive.org/web/20121203050945/http://blog.qt.digia.com/blog/2012/06/06/desktop-components-for-qt-5/)

[http://qt-project.org/wiki/Qt_Quick_Components](http://qt-project.org/wiki/Qt_Quick_Components)

无论如何，我建议您使用 Qt 小部件和 Qt 样式表来装饰您的小部件：http: [//qt-project.org/doc/qt-4.8/stylesheet-reference.html](http://qt-project.org/doc/qt-4.8/stylesheet-reference.html)

# javascript - 通过 javascript 混淆来混淆 css 文件

> ID：15211919
> 
> 赞同：0
> 
> 时间：2013-03-04T21:57:35.067
> 
> 标签：javascript, css, html, obfuscation

如果一个人做了一些艰苦的工作并且不想让其他人复制它，例如 javascript、css、html。有办法吗？

我听说 javascript 可以被混淆（参考[How can I obfuscate (protect) JavaScript?](https://stackoverflow.com/questions/194397/how-can-i-obfuscate-javascript)）。

只为 html 这样做是没有意义的，因为 SEO（搜索引擎优化）会受到影响。

但是如何为 .css 文件执行此操作？它对我来说非常重要。

**有什么方法可以让它变得更难？（除了将变量/样式重命名为虚假的）** 有没有办法将所有的 css 和 html 包含到 javascript 中，然后混淆 javascript？谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T21:59:34.480

浏览器的内置 CSS 调试器将显示 RENDERED CSS，无论您要应用哪种混淆疯狂。

这样做根本没有意义。

或者就像我说的：*如果你不想被盗，就不要放到网上*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T22:03:23.353

You can parse/regex your outbound html with your external css files to make all your html have inline css, so nobody knows what classes you use.

Edit, yes, this is horribly and ridiculously inefficient, but it does prevent people from copy/pasting your valuable css files.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T22:00:05.827

JavaScript 可以通过使用无意义的变量和函数名称并删除所有格式来混淆。

在 CSS 中，您唯一可以控制的是 id 名称、类名和格式。这些是很容易被忽略或修复的东西，所以还有很多其他的混淆方法。

# windows-store-apps - 在 WinRT XAML 应用程序中，ListView.CanDragItems 在使用触摸时仅在一个方向上启用拖动

> ID：15211921
> 
> 赞同：1
> 
> 时间：2013-03-04T21:57:41.090
> 
> 标签：windows-store-apps, winrt-xaml

请参阅以下非常基本的 XAML。我在模拟器中以触摸模式运行它。我可以向右或向左拖动项目，但不能向下拖动。使用鼠标模式时效果很好。经过一番谷歌搜索后，我看到了这个帖子（[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/8bb5e423-4517-448b-89ce-179a978e9e2d/](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/8bb5e423-4517-448b-89ce-179a978e9e2d/)），但它并没有帮助我。

```
<Page
    x:Class="App3.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <ListView Background="AliceBlue" 
            AllowDrop="True" CanDragItems="True" SelectionMode="None"  CanReorderItems="False"
                     IsItemClickEnabled="False" IsSwipeEnabled="True"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                      ScrollViewer.VerticalScrollBarVisibility="Disabled"
                        Margin="10">
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel Orientation="Horizontal" />
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Border Background="Blue" Width="100" Height="100"/>
                </DataTemplate>
            </ListView.ItemTemplate>
            <x:String>s1</x:String>
            <x:String>s2</x:String>
            <x:String>s3</x:String>
        </ListView>
    </Grid>
</Page> 
```

这是非常基本的东西，奇怪的是它对我不起作用。有人知道任何解决方案或解决方法吗？

谢谢

梅尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T06:18:04.650

我可能错了，但是使用触摸的 AFAIK 只能撕下垂直于滚动方向的项目。您链接到的论坛帖子中也提到了相同的内容。如果你设置`IsSwipeEnable=False`你也禁用此行为。

如果您希望`ListView`水平滚动，因为您已经更改了 的方向`ItemsPanelTemplate`，您需要将以下内容添加到您的`ListView`：

```
ScrollViewer.HorizontalScrollMode="Enabled"
ScrollViewer.VerticalScrollMode="Disabled" 
```

现在，tear off 将垂直工作而不是水平工作，考虑到您当前的布局，这应该更直观。

# gwt - GWT：通过表中的 id 获取行的支持对象

> ID：15211930
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:08.073
> 
> 标签：gwt, gwt-celltable, multipleselection

是否有任何简单的方法可以通过行的索引获取用于在 CellTable 中呈现给定行的对象？

我正在使用 AsyncDataProvider，并且不想记住从服务器返回的数据对象列表。我也在使用 MultiSelectionModel，所以可以在那里选择几个项目，我需要找出最后点击的项目。

我知道最后点击的行的索引，所以我需要以某种方式获取与该行相对应的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T23:17:49.343

[`getVisibleItem`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/cellview/client/AbstractHasData.html#getVisibleItem%28int%29)? `getPageStart`如果您使用分页并且您只知道*绝对索引*，则可能结合使用。

对于您的用例，也许您可​​以使用`setSelected`跟踪最后更改的自定义选择模型。

# mysql-python - 使用 mysql-python 只连接到我的路由器，而不是我的远程服务器

> ID：15211932
> 
> 赞同：1
> 
> 时间：2013-03-04T21:58:11.673
> 
> 标签：mysql-python

使用带有模块的python：MySQLdb 我尝试连接到远程mysql服务器......

```
conn = mdb.connect('mysql.remotehost.com', 'username', 'password', 'database') 
```

而不是尝试连接到 mysql.remotehost.com 我收到此错误：

```
_mysql_exceptions.OperationalError: (1045, "Access denied for user 'username'@'xx.x.xxx.xxx' (using password: YES)") 
```

其中 xx.x.xxx.xxx 是我的调制解调器/路由器的 IP 地址。为什么会这样？我怎样才能绕过它来实际访问我的远程 mysql 主机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:24:47.440

看起来您没有权限从主机 xx.x.xxx.xxx 访问 MySQL。您需要授予用户访问权限。

# java - Sublime Text 2 - 错误但不在 IDE 中

> ID：15211935
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:22.007
> 
> 标签：java, intellij-idea, sublimetext2

我正在尝试使用 Sublime 文本，并且我更改了编译设置以显示 java 程序的输出。但是，我不能在 Sublime Text 2 中运行它，而 IntelliJ 可以很好地显示它，DrJava 和 Eclipse 也是如此。

我的错误是：

> ```
> -----------OUTPUT-----------
> This program will calculate the average for the given number of student's marks
> How many students are in the class?
> Exception in thread "main" java.lang.NumberFormatException: null
>   at java.lang.Integer.parseInt(Unknown Source)
>   at java.lang.Integer.parseInt(Unknown Source)
>   at Unit4ClassAverage.main(Unit4ClassAverage.java:33)
> [Finished in 0.8s with exit code 1] 
> ```

负责这个的代码块，我猜是：

```
System.out.println("This program will calculate the average for the given number of student's marks");
            System.out.println("How many students are in the class?");
            strInput = br.readLine();
            intStudents = Integer.parseInt(strInput); 
```

我的 JavaC.sublime-build 文件如下所示：

```
{
    "cmd": ["runJava.bat", "$file"],
    "file_regex": "^(...*?):([0-9]*):?([0-9]*)",
    "selector": "source.java"
} 
```

我的 runJava.bat 文件如下所示：

```
@ECHO OFF
cd %~dp1
ECHO Compiling %~nx1.......
IF EXIST %~n1.class (
DEL %~n1.class
)
javac %~nx1
IF EXIST %~n1.class (
ECHO -----------OUTPUT-----------
java %~n1
) 
```

它位于我的“C:\Program Files (x86)\Java\jdk1.7.0_05\bin”文件夹中。

任何帮助，将不胜感激！整个程序可以在这里看到：http: [//pastebin.com/d5QDqMbJ](http://pastebin.com/d5QDqMbJ)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-14T04:30:46.633

迟到的响应，但如果有人想知道，sublime 没有导入您在这种情况下请求的实用程序。这是代码运行的问题，而不是其内容的问题。

# linux - 使用串口与 stty 不工作，minicom ok

> ID：15211936
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:24.890
> 
> 标签：linux, serial-port, stty

我正在尝试写入串行端口并通过 bash scrpts（echo、printf 和 read）读取结果。就我可以锻炼而言，我已经正确设置了 stty，但我无法读回任何字符。

如果我将端口放在环回中，我可以使用 minicom 发送和接收字符。耶 ：）

但是当我退出 minicom 并向设备回显一些字符时，串行端口闪烁 rx led 一次，并且读取不显示任何字符。进一步的回显命令不会导致 rx 导致闪烁，所以看来我只能发送一次。

任何想法可能发生的事情以及我如何使事情正常进行。

谢谢，布伦丹。

# ruby-on-rails - 未初始化的常量 GamesController::GamesAccounts

> ID：15211938
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:27.937
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在 library 文件夹中创建了一个 games_account.rb 文件。下面是结构

```
module GamesAccounts
    class GamesAccountsClient
.
.
.
.
.
end
 end 
```

尝试在控制器中执行 GamesAccounts::GamesAccountsClient.new 会给我错误

```
uninitialized constant GamesController::GamesAccounts 
```

我什至添加了

```
config.autoload_paths += %W(#{config.root}/lib) in the applications.rb 
```

我在这里做错什么了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:04:27.633

我不确定这一点，但我认为你可能需要把它放进去`lib/games_accounts/games_accounts_client.rb`而不是你现在拥有的东西，我猜是`lib/games_account.rb`. 这个想法是应该的`lib/<module name>/<class name>.rb`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:20:30.163

我有另一个想法，如果你的文件对模型有帮助，而不是尝试以关注文件夹的形式保存它并在那里添加你的文件。从 Rails 4 开始，所有这些支持活动都将受到关注，最好立即采用。也可以阅读 DHH 的博客文章：

[http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns](http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T22:17:30.007

问题出在您的文件中，将其命名为**games_accounts.rb**而不是**games_account.rb**，它应该可以工作（因为它将与模块​​名称匹配）。

如果您打算在此模块中放置许多类，请创建一个名为 games_accounts 的目录，并在其中添加该类以及每个文件到每个类的映射，并将其放在您的**application.rb**文件中，例如

```
config.autoload_paths += %W(#{config.root}/lib/games_accounts) 
```

# jquery - 如果用户单击第一个 [opera] 以外的任何图片，.PNG 不会显示

> ID：15211939
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:28.467
> 
> 标签：jquery, fancybox

Opera 似乎是唯一的浏览器，当我点击页面上第一个图像以外的任何图像时，不会显示下一个/上一个按钮，但用户仍然可以前进/后退；单击图像的两侧后，这些按钮似乎会重新出现一瞬间。以这种方式，如果他们用户滚动图像，有时下一个/上一个按钮之一从一开始就出现在图像上方的固定位置（通常它们不会出现，除非用户将鼠标悬停在图像的任一侧） . 有任何想法吗？

```
$(document).ready(function() {
    $(".fancybox")
        .attr('rel', 'group')
        .fancybox({
            padding: 0,
            openSpeed: "fast",
            closeSpeed: "fast",
            nextSpeed: "normal",
            prevSpeed: "normal",
            helpers: { 
                overlay: { 
                    css: {
                        'background' : '#000000',
                        'background' : 'rgba(0, 0, 0, 0.85)',
                        /*'background' : '#000000',*/
                        /*'filter' : 'alpha(opacity=60)',*/
                    }
                }
            }
    });
}); 
```

# sql - 通过 xml 输入更新表

> ID：15211942
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:44.780
> 
> 标签：sql, sql-server, xml

我有一个存储过程，它通过 xml 输入在我的 2008 SQL 服务器表中插入新记录：

```
CREATE PROCEDURE ins_AddBinsToBox
@BoxId          BIGINT,
@BinIds         XML
AS
BEGIN

INSERT INTO WebServiceBoxDetails 
(
  BinId,
  BoxId 
)
SELECT 
  ParamValues.ID.value('.','VARCHAR(20)'),
  @BoxId  
FROM 
  @binIds.nodes('/Bins/id') AS ParamValues(ID) 
```

这对于插入新行非常有用，我感到困惑的是使用新的 xml 输入更新（通过 UPDATE 语句）同一个表？

桌子：

```
Id(PK)    BoxNumber  BinId
(bigint)  (bigint)   (int)
_______________________
1           12         334
2           12         445
3           12         776
4           16         223
5           16         669 
```

要使用的命令：

```
EXEC upd_Box @binIds='<Bins><id>7848</id><id>76554</id><id>71875</id></Bins>', @BoxId=12 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:58:54.637

您可以再次使用 NODES 方法。

```
UPDATE WebServiceBoxDetails
SET BinID = ParamValues.ID.value('@BinID','VARCHAR(20)')
FROM
 @bindIDs.nodes('/Bins/id') AS ParamValues(ID)
 JOIN WebServiceBoxDetails w ON w.ID = ParamValues.ID.value('@id','VARCHAR(20)')
 WHERE w.BoxNumber = @BoxID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T03:33:19.710

试试这个

```
DECLARE @binIds AS XML = '<Bins><id>7848</id><id>76554</id><id>71875</id></Bins>'
DECLARE @id INT
DECLARE @newid INT
DECLARE @count INT = 1
DECLARE @BinIdTable TABLE(RowNumber INT, BinId INT) 

INSERT @BinIdTable(RowNumber, BinId)
SELECT ROW_NUMBER() OVER(ORDER BY ID), ParamValues.ID.value('.','INT')
FROM
 @binIds.nodes('/Bins/id') AS ParamValues(ID)

DECLARE MyCursor CURSOR FOR
 SELECT id FROM WebServiceBoxDetails WHERE BoxNumber = 12 ORDER BY id

 OPEN MyCursor

 FETCH NEXT FROM MyCursor
 INTO @id

 WHILE @@FETCH_STATUS = 0
 BEGIN

    SELECT @newid =  B.BinId
    FROM @BinIdTable B
        WHERE RowNumber = @count

    UPDATE WebServiceBoxDetails
        SET BinId = @newid
        WHERE Id = @id

    SET @count = @count + 1
    FETCH NEXT FROM MyCursor 
    INTO @id
 END
 CLOSE MyCursor
 DEALLOCATE MyCursor 
```

让我知道事情的后续。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T12:32:08.113

抱歉耽搁了。这是您第二部分的答案（这应该适用于更新和插入）

```
DECLARE @binIds AS XML = '<Bins><id>44</id><id>55</id><id>66</id><id>77</id></Bins>'
DECLARE @id INT
DECLARE @newid INT
DECLARE @count INT = 1
DECLARE @BinIdTable TABLE(RowNumber INT, BinId INT) 
DECLARE @BoxNumber INT = 12
DECLARE @RowCount INT = 0

INSERT @BinIdTable(RowNumber, BinId)
SELECT ROW_NUMBER() OVER(ORDER BY ID), ParamValues.ID.value('.','INT')
FROM
 @binIds.nodes('/Bins/id') AS ParamValues(ID)

SELECT @RowCount = COUNT(*) FROM @BinIdTable

DECLARE MyCursor CURSOR FOR
 SELECT id FROM WebServiceBoxDetails WHERE BoxNumber = @BoxNumber ORDER BY id

 OPEN MyCursor

 FETCH NEXT FROM MyCursor
 INTO @id

 WHILE @@FETCH_STATUS = 0
 BEGIN

    SELECT @newid =  B.BinId
    FROM @BinIdTable B
        WHERE RowNumber = @count

    UPDATE WebServiceBoxDetails
        SET BinId = @newid
        WHERE Id = @id

    SET @count = @count + 1
    FETCH NEXT FROM MyCursor 
    INTO @id
 END
 CLOSE MyCursor
 DEALLOCATE MyCursor

 IF @RowCount >= @count
 BEGIN

    INSERT INTO WebServiceBoxDetails
    SELECT @BoxNumber, BinId 
        FROM @BinIdTable
        WHERE RowNumber >= @count

 END 
```

让我知道事情的后续。

# c# - 如何在 C# 应用程序中使用 .xls 文件

> ID：15211944
> 
> 赞同：0
> 
> 时间：2013-03-04T21:58:47.073
> 
> 标签：c#, .net, xls

在 C# 控制台应用程序中，我有一个`PointF[]`数组。我需要在 .xls 图表文件中绘制这些点，但我需要指导如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:16:34.537

查看[适用于 Microsoft Office 的 Open XML SDK 2.0](http://www.microsoft.com/en-us/download/details.aspx?id=5124)

我以前用它来做你描述的事情。

我开始在 Excel 中创建一个 .xls 文件，该文件具有正确的图表，可以从特定范围的单元格中读取值等等。然后使用 SDK 我添加/更改了这些单元格的值并保存了文件的新版本。所以基本上我使用在 Excel 中创建的文件作为模板，我可以随时更改而不更改代码（只要将值写入相同的单元格范围）。

您还可以将值单元格放在单独的工作表中，以便用户在打开文件时看不到它们...

# javascript - 错误：“请使用 POST 请求”与表单和 Javascript

> ID：15211946
> 
> 赞同：4
> 
> 时间：2013-03-04T21:58:55.150
> 
> 标签：javascript, html, css, forms, function

我做了一个小表格，我希望它在输入空白时将信息发回给用户。

出于某种原因，它说请使用发布请求，所以我添加了它，现在它给了我一个不同的错误消息。

这是代码：http: [//jsfiddle.net/pwtnY/](http://jsfiddle.net/pwtnY/)

```
<div id="main">
<form name="myForm" method="post">
    <label><span>First Name:</span><input type="text" class="firstname" name="fname"></label><br/>
    <label><span>Last Name:</span><input type="text" class="lastname"></label><br>
    <label><span>E-Mail:</span><input type="text" class="email"></label><br/>
    <label><span>Phone:</span><input type="text" class="phone"></label><br/>
    <input type="submit" name="submit">
</form>
<div id="answer"></div>
</div> 
```

Javascript：

```
$(document).ready(function(){
    $('input:submit').click(function(){
       $firstname = $('.firstname').val();
       $lastname = $('.lastname').val();
       $email = $('.email').val();
       $phone = $('.phone').val();

       if($firstname === "" && $lastname==="" && $email ==="" && $phone === ""){
           $("#answer").html("Please fill out all fields.");
       }

   });
}); 
```

任何人都知道问题可能是什么以及我该如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:06:18.373

当您单击提交时，表单实际上正在发布到您的 django 后端。如果您想在发布到服务器之前进行前端验证，请阻止提交按钮实际发布。

```
$('input:submit').click(function(event){
       event.preventDefault();
       $firstname = $('.firstname').val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:16:15.433

在您的小提琴中，您没有包含 jquery 库。如果您不想向服务器提交任何内容，请将 submit button 替换为 simple button `<input type="button" value="submit">`。有更新你的例子：[小提琴](http://jsfiddle.net/pwtnY/18/)

PS您可能想在验证中使用 OR 而不是 AND 来验证是否有任何字段为空

# php - 循环中未定义的偏移量通知

> ID：15211950
> 
> 赞同：1
> 
> 时间：2013-03-04T21:59:05.133
> 
> 标签：php, loops, undefined, offset

我正在使用脚本来创建其他表单行。它为某些文本字段循环 $i 编号当我运行此脚本时，偏移量未定义，因为它不存在。我需要使用 if(isset()) 函数，但我不确定如何将它放在代码中。任何人都可以帮忙吗？

```
for ($i=0; $i<100; $i++) {

    if ($text['length'][$i] == "") $text['length'][$i] = "0";
    if ($text['bredth'][$i] == "") $text['bredth'][$i] = "0";
    if ($text['height'][$i] == "") $text['height'][$i] = "0";
    if ($text['weight'][$i] == "") $text['weight'][$i] = "0.00"; 
```

所有以“if”开头的行都显示了通知：

> 注意：未定义的偏移量：第 41 行 C:\xampp\htdocs\newparcelscript.php 中的 1

已解决事实上我根本不需要和“if”语句，因为行的创建和值的设置是一起运行的。

```
for ($i=0; $i<100; $i++) {

   $text['length'][$i] = "0";
   $text['breadth'][$i] = "0";
   $text['height'][$i] = "0";
   $text['weight'][$i] = "0.00"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:01:11.453

根据您在此处尝试执行的操作，我建议您使用以下其中一种 isset/empty 组合

```
if (isset($text['length'][$i]) == false or empty($text['length'][$i]) == true)

if (isset($text['length'][$i]) == true and empty($text['length'][$i]) == true) 
```

该错误很可能来自对不存在的索引的测试：*if($text['length'][$i] == "")*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:05:45.243

我认为测试`empty()`是您在这里寻找的。

```
for($i = 0; $i < 100; $i++)
{
    if(empty($text['length'][$i]) === TRUE) $text['length'][$i] = 0;
    ...
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T22:07:27.180

对于这种情况，如果您需要为未定义的字段插入值，请使用`empty()`.

`empty()`如果值为空字符串，则返回 TRUE，而`!isset()`将返回 FALSE。
关于这个有很多问题，例如[看这里](https://stackoverflow.com/questions/1219542/in-where-shall-i-use-isset-and-empty)。

像这样的东西：

```
for ($i=0; $i<100; $i++) {
    if (empty($text['length'][$i])) $text['length'][$i] = "0";
    if (empty($text['bredth'][$i])) $text['bredth'][$i] = "0";
    if (empty($text['height'][$i])) $text['height'][$i] = "0";
    if (empty($text['weight'][$i])) $text['weight'][$i] = "0.00";
} 
```

# android - 更改 ShareActionProvider 视图的背景

> ID：15211952
> 
> 赞同：3
> 
> 时间：2013-03-04T21:59:12.317
> 
> 标签：android, android-actionbar, shareactionprovider

我想`ShareActionProvider`更改`ActionBar`作为`MenuItem`. 我似乎无法在样式中找到正确的属性来执行此操作。我需要更改整个事物的背景，如下所示：

![](../Images/cf8a049732e1a3a46a29d1416c2595c9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-30T11:20:33.123

你需要这样做：

```
ActionBar actionBar= getActionBar();
actionBar.setBackgroundDrawable(getResources().getDrawable(R.drawable.abc)); 
```

# html - 在指令的 jqlite 生成的 html 中使用控制器范围的数据

> ID：15211954
> 
> 赞同：1
> 
> 时间：2013-03-04T21:59:18.243
> 
> 标签：html, scope, angularjs, directive

[这个问题与Mike](https://stackoverflow.com/users/197862/mike)的文章[Using ng-model within a directive](https://stackoverflow.com/questions/12717897/using-ng-model-within-a-directive)中提出的问题类似。

我正在编写一个页面，它是一个小型电子表格，它显示基于用户输入字段的计算输出。使用指令，我正在制作这样的自定义标签：

```
<wbcalc item="var1" title="Variable 1" type="input"></wbcalc>
<wbcalc item="var2" title="Variable 2" type="input"></wbcalc>
<wbcalc item="calc" title="Calculation" type="calc"></wbcalc> 
```

'item' 字段引用了我的控制器中的范围数据：

```
$scope.var1 = '5';  // pre-entered input
$scope.var2 = '10'; // pre-entered input
$scope.calc = function() {
    return parseInt($scope.var1) + parseInt($scope.var2);
}; 
```

并且在指令的逻辑中使用“类型”字段来了解是将项目视为字符串还是函数。

这是一个小提琴：http: [//jsfiddle.net/gregsandell/PTkms/3/](http://jsfiddle.net/gregsandell/PTkms/3/) 我可以让输出元素与惊人的代码行一起工作：

```
html.append(angular.element("<span>")
    .html(scope.$eval(attrs.item + "()"))
); 
```

...我正在使用它来让我的输入连接到我的范围控制器数据（我从[Mike 的帖子](https://stackoverflow.com/questions/12717897/using-ng-model-within-a-directive)中得到这个：

```
var input = angular.element("<input>").attr("ng-model", attrs.item);
$compile(input)(scope);
html.append(input); 
```

...虽然它确实将值放在字段中，但它们不受计算约束，正如您通过更改我的小提琴中的输入所看到的那样。

是否有更好和/或更直观的方法将我的控制器范围数据链接到我的指令中的 jqlite 生成的 html？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:15:10.197

看看这个，我认为您可以简化流程。

[http://jsfiddle.net/PTkms/4/](http://jsfiddle.net/PTkms/4/)

```
angular.module('calculator', []).directive('wbcalc', function($compile) {
    return {
        restrict: 'E',
        template: '<div><div class="span2">{{title}}</div><input ng-model="item"></div>',
        scope: {
            title: '@',
            item: '='
        },
        link: function(scope, element, attrs) {
            // Don't need to do this.
        }
    }
});
function calcCtrl($scope) {
    $scope.var1 = '5';
    $scope.var2 = '10';

    $scope.calc = function() {
        // Yes, this is a very simple calculation which could
        // have been handled in the html with {{0 + var1 + var2}}.
        // But in the real app the calculations will be more
        // complicated formulae that don't belong in the html.
        return parseInt($scope.var1) + parseInt($scope.var2);
    };
} 
```

我知道你说过你喜欢 jQuery——但要充分利用 Angular，你需要以 Angular 的方式思考——使用绑定，不要直接操作 DOM 等。

对于此示例，阅读使用的隔离范围绑定会很有帮助 - '@' 和 '='，请参阅：

[http://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

# objective-c - 在 Cocoa for osx 中使用正则表达式进行用户输入验证

> ID：15211955
> 
> 赞同：1
> 
> 时间：2013-03-04T21:59:24.670
> 
> 标签：objective-c, regex, macos, cocoa, validation

刚刚面临无法编写满足我需求的良好正则表达式的问题。我以前从未使用过正则表达式，所以这对我来说并不是一个大惊喜。

以下是我要验证的良好输入示例：

*   01
*   00:01
*   01:02:03
*   01:02:03:04 - 最多 3 个冒号
*   123,456,789 - 最多两个逗号
*   40000035
*   1:2:06

以下是不好的：

*   ,3234
*   134,2343,333
*   000:01:00
*   :01:03:00
*   :01
*   01：

首先，我尝试编写一个至少涵盖所有冒号的情况，这就是我所拥有的：

```
NSUInteger numberOfMatches = -1;

NSError *error = NULL;

NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"([([0-9]{1,2}):]{1,3})([0-9]{1,2})"
                                                                       options:NSRegularExpressionCaseInsensitive
                                                                       error:&error];
if (error) {
    NSLog(@"error %@", error);
}

numberOfMatches = [regex numberOfMatchesInString:stringToValidate
                                         options:0
                                           range:NSMakeRange(0, [stringToValidate length])]; 
```

我也很好奇 NSRegularExpression 是否有任何方法可以在某种数组中提取经过验证的子字符串？！

例如：

12:23:63 --- 将被验证并且数组将包含 [12,23,63]

234 --- 将被验证并且数组将包含 [234]

123,235,653 --- 将被验证并且数组将包含 [123235653]

基本上冒号分隔的输入将作为单独的值，其他所有内容将作为一个值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:13:16.710

为了达到你想要的效果，我建议你为每个案例做一个验证。

# 验证

### 冒号：

```
^\d{1,2}(?::\d{1,2}){0,2}(?::\d{2})?$ 
```

### 逗号：

```
^\d{3}(?:,\d{3}){0,2}$ 
```

### 只是数字：

```
^\d+$ 
```

然后假设您通过了每个案例的验证，使用其他东西进行数据提取。

# 数据提取

### 冒号

*   [只需在冒号上进行字符串拆分。](https://stackoverflow.com/questions/259956/nsstring-tokenize-in-objective-c)

### 逗号：

*   [删除`,`字符串中所有出现的 of。](https://stackoverflow.com/questions/925780/remove-characters-from-nsstring-in-iphone-programming)

### 只是数字：

*   好吧，你在这里有你需要的东西，所以不需要做任何改变。

# python - django 获取字符串的第一部分

> ID：15211966
> 
> 赞同：3
> 
> 时间：2013-03-04T22:00:21.990
> 
> 标签：python, django

是否有一个简单的 django 标签来获取模板中字符串的前 x 个字符？

在模型实例列表中，我想为每个对象实例提供不同的符号，具体取决于对象实例的状态。状态可以是“等待”、“成功”或“失败 XXXX”，其中 XXXX 是错误代码。

我想检查 objectinstance.status 的前 5 个字符是否 == 'error'，那么该符号将是红色的。但是，我该怎么做？在 Python 中，我可以使用 objectinstance.status[:5]。

使用[https://docs.djangoproject.com/en/dev/ref/templates/builtins/](https://docs.djangoproject.com/en/dev/ref/templates/builtins/)我设法通过以下“怪异”连接来做到这一点，但是有没有像 .left() 或 .right() 这样简单的东西？

```
{% if run.status|make_list|slice:":5"|join:"" == 'error' %} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T22:42:32.640

你可以试试：

```
{% if run.status|truncatechars:5 == 'error...' %} 
```

（参见Django 文档中的[截断字符）](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#s-truncatechars)

尽管我可能会说，总的来说，您不应该将这种逻辑放在您的 Django 模板（其他框架中的视图）中。您想将其放入 Django 视图（其他框架中的控制器）。意思是，在你看来，你会是这样的：

```
has_error = run.status.startswith('error') 
```

确保 has_error 被传递给模板并且：

```
{% if has_error %} 
```

它可能需要更多的工作，但是检测错误条件的逻辑可以在多个视图和模板之间共享，并且您可以将控制逻辑与视图逻辑分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:46:22.677

如果您使用 Django 1.4+，您可以使用[`truncatechars`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#truncatechars)标签，但它只会部分解决您的答案，并会在末尾添加省略号。

唯一可行的方法是编写一个自定义过滤器，就像您已经做的那样连接许多过滤器。这是您可以自定义的初稿：

```
from django import template
from django.template.defaultfilters import stringfilter

register = template.Library()

@register.filter
@stringfilter
def slicestring(value, arg):
    """usage: "mylongstring"|slicestring:"2:4" """
    els = map(int, arg.split(':'))
    return value[els[0]:els[1]] 
```

作为奖励，此过滤器允许您通过提供“切片字符串”作为参数来几乎完全模仿切片符号。唯一的例外似乎是`[:9]`必须用 替换的语法`[0:9]`，因此使用这个参数：`yourvariable|slicestring:"0:9"`

**附注**：由于您的问题是“获取字符串的第一部分”，我相信自定义过滤器可能是正确的答案，但是如果获取切片字符串的唯一原因是在`if`语句中检查其中的一部分，那么我必须同意 Anton 的观点：如果可能，您应该将检查放在视图内，而不是模板内。

# javascript - How do I load a webpage inside a div using Javascript without IFRAME and JQuery?

> ID：15211969
> 
> 赞同：2
> 
> 时间：2013-03-04T22:00:29.260
> 
> 标签：javascript, html, css

I need to load an external webpage into a div. I don't want to use an iFrame. And I want this done with plain Javascript. I'm not sure how to go about it.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T22:22:12.327

困难重重……</p>

使用 Ajax（例如通过[XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)）来获取页面。由于它是外部的，因此您需要[绕过相同的来源策略](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)。

获得页面后，提取它的相关部分（可能是元素的子`body`元素）并将[其添加到现有的 DOM](http://www.w3.org/wiki/Creating_and_modifying_HTML)中。

您需要考虑您的站点和外部站点之间的不同样式表、相对 URI（针对外部站点上不属于您的资源的资源）以及远程内容中的任何[脚本](https://stackoverflow.com/questions/1197575/can-scripts-be-inserted-with-innerhtml)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-09T18:18:08.167

无论你有哪种方法，在 js 中，试试这个： `$('#myid').load('mylink.com')`

我只在js中知道这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T00:55:07.023

你甚至不需要 javascript-

但同样的限制适用于 iframe 包含不同域。

```
<!doctype html>
<html lang="en">
<head>
<meta charset= "utf-8">
<title>test page</title>
</head>
<body>

<div> 
<object type="text/html" data="http://validator.w3.org/" width="800px" height="600px" style="overflow:auto;border:5px ridge blue">
</object></div>
</div>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T22:21:42.050

您应该能够使用 jQuery.get() 方法在页面中加载 html 页面。我将这种方法用于我的客户的两个网站，其中各个页面是网站的不同部分。

如果您尝试使用此方法加载包含标题信息和正文标记的完整 HTML 页面，我不确定您可能会遇到的行为。我建议使用它来加载 HTML 片段。

[jQuery.get()](http://api.jquery.com/jQuery.get/)

# regex - How do I make this a negative regex

> ID：15211970
> 
> 赞同：0
> 
> 时间：2013-03-04T22:00:33.660
> 
> 标签：regex

I have the following string that i want to replace parts of:

Blah blah Mr. [-user_first_name-] [-user_last_name-]

This will replace verything [- -]:

```
preg_replace('/[^\[-[a-z\d_\/A-Z. ]+-\]]/i', '', $body); 
```

My goal is to replace everything that isn't in [- -]

Do you know how I can make this worth?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:08:54.400

不要使用`preg_replace()`. 使用`preg_match_all()`相同的正则表达式并连接结果。

```
preg_match_all('%\[-[a-z\d_/A-Z. ]+-\]%', $subject, $result, PREG_PATTERN_ORDER);
$result = implode($result[0]); 
```

# python - how to authenticate a link using requests

> ID：15211972
> 
> 赞同：0
> 
> 时间：2013-03-04T22:00:40.960
> 
> 标签：python, beautifulsoup

I am trying to use beautiful soup to extract data from a link...currently its failing authentication like below..how do I authenticate the link,I know the server that should be logged-in..where to provide the server path and how to validate the link?

```
from bs4 import BeautifulSoup as bs
import argparse
import urllib
import urllib2
import getpass
import re
import requests

def update (url):
    print url
    r = requests.get(url)
    html = r.text
    soup = bs(html)
def main ():
    #For logging
    print "test"
    parser = argparse.ArgumentParser(description='This is the update.py script created by test')
    parser.add_argument('-u','--url',action='store',dest='url',default=None,help='<Required> url link',required=True)
    results = parser.parse_args()# collect cmd line args
    url = results.url
    #print url
    update(url)
if __name__ == '__main__':
    main() 
```

Error:-

```
Traceback (most recent call last):
  File "announce_update2.py", line 24, in <module>
    main()
  File "announce_update2.py", line 22, in main
    update(url)
  File "announce_update2.py", line 11, in update
    r = requests.get(url)
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\api.py", line 55, in get
    return request('get', url, **kwargs)
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\api.py", line 44, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\sessions.py", line 289, in request
    history = [r for r in gen] if allow_redirects else []
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\sessions.py", line 133, in resolve_redirects
    proxies=proxies
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\sessions.py", line 279, in request
    resp = self.send(prep, stream=stream, timeout=timeout, verify=verify, cert=cert, proxies=proxies)
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\sessions.py", line 374, in send
    r = adapter.send(request, **kwargs)
  File "C:\Python27\lib\site-packages\requests-1.1.0-py2.7.egg\requests\adapters.py", line 213, in send
    raise SSLError(e)
requests.exceptions.SSLError: [Errno 1] _ssl.c:504: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed 
```

# sql - change recovery model on current database

> ID：15211977
> 
> 赞同：1
> 
> 时间：2013-03-04T22:00:53.207
> 
> 标签：sql, sql-server-2008, tsql

I am trying to change the recovery model of the current database.

This is what I have:

```
DECLARE @dbName VARCHAR(50)
SELECT @dbName = DB_NAME()
ALTER DATABASE @dbName SET RECOVERY SIMPLE WITH NO_WAIT 
```

`@dbName` gives me:

> Incorrect syntax near '@dbName'.

I tried:

```
ALTER DATABASE database_id SET RECOVERY SIMPLE WITH NO_WAIT 
```

`database_id` gives me:

> Msg 5011, Level 14, State 5, Line 3 User does not have permission to alter database 'database_id', the database does not exist, or the database is not in a state that allows access checks.

How should I execute this on the current database?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T22:03:37.970

```
DECLARE @sql NVARCHAR(MAX) = N'ALTER DATABASE ' 
  + QUOTENAME(DB_NAME())
  + ' SET RECOVERY SIMPLE WITH NO_WAIT;';

EXEC sp_executesql @sql; 
```

# c# - 插入返回 ID

> ID：15211987
> 
> 赞同：1
> 
> 时间：2013-03-04T22:01:33.467
> 
> 标签：c#, sql-server

我正在尝试从存储过程中获取插入或更新的 id，我尝试了 2 种不同的方法

`If exists(select ....)`出于性能原因，我不允许使用

**1-使用输出**

```
 @firstName varchar(30),
    @Telephone int

        AS
        BEGIN transaction
            UPDATE [PHONE_BOOK].[dbo].[USER]
                       SET TELEPHONE= @Telephone
                       output inserted.USERID
                     where FIRST_NAME = @firstName

    if @@ROWCOUNT = 0
    begin
            INSERT INTO [PHONE_BOOK].[dbo].[USER]
           ([FIRST_NAME]
           ,[TELEPHONE])
           output inserted.USERID -- or output SCOPE_IDENTITY()
     VALUES
           (@firstName
           ,@Telephone)
  end 
```

C# 代码

```
IList<SqlParameter> parameters = new List<SqlParameter>();
            parameters.Add(new SqlParameter("@firstName", "Mike"));
            parameters.Add(new SqlParameter("@Telephone", 9514256));

            using (var sqlConnection = new SqlConnection(Config.ConnString))
            {
                sqlConnection.Open();
                using (SqlCommand command = sqlConnection.CreateCommand())
                {
                    command.CommandType = CommandType.StoredProcedure;
                    command.CommandText = "[dbo].[INSET_USER]";
                    command.UpdatedRowSource = UpdateRowSource.None;

                    foreach (SqlParameter oPar in parameters)
                        command.Parameters.Add(oPar);

                    object x = command.ExecuteScalar();

                }
            } 
```

1.  如果更新 ==>`x`是正确的
2.  如果删除 ==>`x`为空

**2- 使用 OUTPUT 参数**

```
@firstName varchar(30),
@Telephone int,
@userId int output

AS
BEGIN transaction
    UPDATE [PHONE_BOOK].[dbo].[USER]
               SET TELEPHONE= @Telephone
             where FIRST_NAME = @firstName
            -- i can't find different way to set @userId than doing a select which is not acceptable
    if @@ROWCOUNT = 0
    begin
            INSERT INTO [PHONE_BOOK].[dbo].[USER]
           ([FIRST_NAME]
           ,[TELEPHONE])
     VALUES
           (@firstName
           ,@Telephone)
           set @userId = SCOPE_IDENTITY()
        end 
```

c#代码：

```
IList<SqlParameter> parameters = new List<SqlParameter>();
            parameters.Add(new SqlParameter("@firstName", "Mike"));
            parameters.Add(new SqlParameter("@Telephone", 9514256));

            using (var sqlConnection = new SqlConnection(Config.ConnString))
            {
                sqlConnection.Open();
                using (SqlCommand command = sqlConnection.CreateCommand())
                {
                    command.CommandType = CommandType.StoredProcedure;
                    command.CommandText = "[dbo].[INSET_USER]";
                    command.UpdatedRowSource = UpdateRowSource.None;

                    foreach (SqlParameter oPar in parameters)
                        command.Parameters.Add(oPar);
                    command.Parameters.Add("@userId",0).Direction = ParameterDirection.Output;

                    command.ExecuteNonQuery();
                    var x = command.Parameters["@userId"].Value;

                }
            } 
```

1.  如果更新 ==>`x`为 -1
2.  如果删除 ==>`x`是正确的

我怎样才能解决这个问题？我喜欢第一个选项，因为我不需要将输出参​​数传递给存储过程

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:31:51.203

考虑将 RETURN 或 OUTPUT 参数与 ExecuteNonQuery() 一起使用，它会自动将值填充到变量中。不需要 ExecuteScalar()。

[http://blogs.msdn.com/b/spike/archive/2009/05/07/a-simple-example-on-how-to-get-return-and-out-parameter-values-using-ado-网络.aspx](http://blogs.msdn.com/b/spike/archive/2009/05/07/a-simple-example-on-how-to-get-return-and-out-parameter-values-using-ado-net.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T23:12:13.780

在这种情况下你没有得到你的输出值的原因是因为你是*选择*它而不是*返回*它。如果您不想更改 proc，则可以从第一个结果集中获取它 - 但 ExecuteScalar 会抑制结果集，因此您需要使用 ExecuteReader 或类似的东西。但是，有一个标准模式，你没有遵循它，所以我会发布它只是为了好点 - 我相信它已经在其他地方被覆盖了。

标准 SP 模式 -

```
create proc UpsertMyTable (
    @parameter int
) AS

declare @result int

if exists (select 1 from MyTable where value = @parameter) begin
    UPDATE HERE
end else begin
    INSERT HERE
end

set @result = SCOPE_IDENTITY()

return @result 
```

然后在您的 C# 代码中，基本上您在示例中的内容是正确的，除了您完成参数的方式是多余的并且存在性能问题......

```
using (var sqlConnection = new SqlConnection(Config.ConnString)) {
    sqlConnection.Open();
    using (SqlCommand command = sqlConnection.CreateCommand()) {
        command.CommandType = CommandType.StoredProcedure;
        command.CommandText = "[dbo].[PROC_UPSERT_SHARE]";
        command.UpdatedRowSource = UpdateRowSource.None;

        command.parameters.Add(new SqlParameter("@fullName", "dwfae"));
        command.parameters.Add(new SqlParameter("@name", "aze"));
        command.parameters.Add(new SqlParameter("@root", "aze"));
        command.parameters.Add(new SqlParameter("@creationDate", new DateTime(2000, 10, 10)));
        command.parameters.Add(new SqlParameter("@lastAccessDate", new DateTime(1999, 11, 11)));
        command.parameters.Add(new SqlParameter("@lastWriteDate", new DateTime(1990,12,12)));
        command.parameters.Add(new SqlParameter("@subShareCount", 20));
        command.parameters.Add(new SqlParameter("@serverId", "serverx"));

        object x = command.ExecuteScalar();
        Console.WriteLine(x);
    }
} 
```

像这样的东西会快得多。即使您认为影响可能很小，也请考虑此类事情。

# node.js - understanding modules/routes in nodejs

> ID：15211988
> 
> 赞同：1
> 
> 时间：2013-03-04T22:01:36.047
> 
> 标签：node.js, express

I'm new in nodejs. I want to build a rest service with multiple, lets say, categories.

```
> app.js 
var express = require('express')
  , http = require('http')
  , routes = require('./routes')
  , path = require('path');

app = express();
app.use(app.router);

app.get('*',routes.index);

app.listen(3000);
console.log('Express app started on port 3000'); 
```

and

```
> routes/index.js
var sites = [
    'sve',
    'ice'
];

exports.index = function(req,res){
    var url = req.url.split('/');
    for (i in sites) {
        app.get('/' + sites[i] + '/*',require('./' + sites[i]));
    }
}; 
```

and

```
> routes/sve/index.js
module.exports = function(req, res){
  console.log('sve')
  res.end({category:'sve'});
}; 
```

and

```
> routes/sve/index.js
module.exports = function(req, res){
  console.log('sve')
  res.end({category:'sve'});
}; 
```

when I run "node app" I get "Express app started on port 3000" and the server is running but when I access "localhost:3000/sve/test" I have no response or "localhost:3000/ice/test" or even "localhost:3000/abc/test". Not even in the console.

What am I doing wrong?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T22:25:05.373

正如我在评论中提到的，我认为您正在寻找一种使用子应用程序（如 Rails 引擎）的方法来模块化您的应用程序。如果是这种情况，您应该使用 app.use() 挂载子应用程序。

[这里](http://vimeo.com/56166857)有一个很好的视频。

视频中未提及的最后一件事是，您可以相对安装子应用程序。例如：

```
var subapplication = require('./lib/someapp');

app.use('/base', app.use(subapplication)); 
```

这会将子应用程序中的路由视为来自“/base”路径。例如，在子应用程序中捕获“/a”的路由，在本示例中挂载时，会将请求匹配到“/base/a”。

# ios - 应用程序在 iPad 2 上运行良好，在 iPad 3 上崩溃，内存不足警告

> ID：15211989
> 
> 赞同：1
> 
> 时间：2013-03-04T22:01:37.247
> 
> 标签：ios, xcode, symbolicatecrash

正如标题所说，我有一个可以在 iPad 2 上运行的应用程序，但在 iPad 3 上崩溃。运行它时，控制台会给我一个内存不足的警告消息。当崩溃发生时，我用符号表示它，但实际上没有什么可以与代码相关联，就像它显示的那样

```
 process name, UUID, rpages, recent_max, [reason] (state) 
```

在那些列标题下只是十六进制的东西，没有显示项目中的方法调用或行。

有任何想法吗？我是否在代码中遗漏了一些允许更好的崩溃日志的标志？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:51:37.900

如果您收到内存不足警告并且未能释放足够的内存来解决问题，那么您的应用几乎肯定会崩溃。问题是，我不认为它崩溃的方式或原因的细节可能具有启发性。此时，您正在评估继发症状。您确实需要回过头来弄清楚*为什么*首先会收到内存不足警告并解决该问题。

正如丹尼尔所说，您可以查看[Technical Note 2151](http://developer.apple.com/library/ios/technotes/tn2151/_index.html#//apple_ref/doc/uid/DTS40008184-CH1-UNDERSTANDING_LOW_MEMORY_REPORTS)，但正如它所说：

> 当您看到内存不足崩溃时，与其担心终止时代码的哪一部分正在执行，不如调查内存使用模式和对内存不足警告的响应。[Memory Allocations Help](https://developer.apple.com/library/ios/#recipes/instruments_help-memory-allocations-help/Eliminating_Messages_To_Deallocated_Objects/06_Eliminating_Messages_To_Deallocated_Objects.html#//apple_ref/doc/uid/TP40011396-CH4-SW1)列出了有关如何使用 Leaks Instrument 发现内存泄漏以及如何使用 Allocations Instrument 的 Mark Heap 功能来避免废弃内存的详细步骤。[内存使用性能指南](https://developer.apple.com/library/mac/#documentation/Performance/Conceptual/ManagingMemory/ManagingMemory.html#//apple_ref/doc/uid/10000160i)讨论了响应内存不足通知的正确方法以及有效使用内存的许多技巧。还建议您查看 WWDC 2010 会议，[使用仪器进行高级内存分析](https://developer.apple.com/videos/wwdc/2010/?id=311)。

所以，有几个想法：

1.  你有没有寻找泄漏？[Find Leaks](https://developer.apple.com/library/ios/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/MemoryManagementforYouriOSApp/MemoryManagementforYouriOSApp.html#//apple_ref/doc/uid/TP40004652-CH11-SW4)文章将引导您了解如何使用仪器来查找泄漏。

2.  如果你打开了僵尸，你有没有把它们关掉？Zombies 是一个很好的诊断工具，但只是消耗内存。

3.  您是否通过静态分析器运行代码（`shift`++或在“产品”菜单上选择“分析”）`command`？`B`特别是如果使用非 ARC 代码，这会发现很多内存问题。

4.  您是否使用仪器`Allocations`工具检查了未解释的增加而没有抵消减少的分配。使用它，您可以运行程序，查看图表上的内存消耗，看看您是否看到在某个点上没有被相应的减少抵消的任何增加。如果是这样，请在图中突出显示这些增加：

    例如，在运行分配工具时，按住选项键，然后用鼠标单击并拖动以突出显示时间线的一部分，以确定您要检查的内容。您可能希望专注于分配中的一个高峰。例如，我在我的分配中发现了一个凸起并突出显示它（这是一个非常简单的示例，我在其中创建了一个巨大的数组`viewDidLoad`，但希望它能给你这个想法）：

    ![分配](../Images/5ee67985b4f7760f90d0c689abddec14.png)

    请注意，我发现在下部面板中显示调用树很有用，选择“隐藏系统库”以专注于您的代码（以及“反转调用树”）通常很有用。如果你双击 Instruments 中的方法名（在我的例子中，这里是 viewDidLoad），Instruments 会显示你正在分配的代码：

    ![显示代码](../Images/eb6b0cbea159d432112118ab817c28ba.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:17:37.153

内存不足警告会生成与标准崩溃不同类型的日志。查看本文的“了解内存不足报告”部分，了解您的应用程序发生了什么以及如何使用 Instruments 对其进行调试：http: [//developer.apple.com/library/ios/#technotes/tn2151/ _index.html](http://developer.apple.com/library/ios/#technotes/tn2151/_index.html)

# javascript - Saving JS object in html data atribute

> ID：15211990
> 
> 赞同：1
> 
> 时间：2013-03-04T22:01:42.503
> 
> 标签：javascript, html

How come this:

```
data-something='{property:1}' 
```

doesnt work, but this

```
data-something='{"property":1}' 
```

does. Does it

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T22:03:02.437

Because JSON requires that object keys be quoted. This is mandated by the [JSON specification](http://www.json.org/); accepting non-quoted keys would mean that the implementation is not JSON-compliant.

This decision was made to side-step the issue of reserved keywords in JavaScript. It was desired that valid JSON also be a valid JavaScript expression, and to make that happen you would *have* to quote keys like `return` and `function`. To simplify specification of the JSON language, it was decided to require that all keys be quoted rather than maintain a list of keys that must be quoted and thereby complicate the JSON grammar (as well as tie the JSON language more closely to the JavaScript language than would otherwise be required).

# python - Socket code from python to Objective C

> ID：15211991
> 
> 赞同：0
> 
> 时间：2013-03-04T22:01:44.760
> 
> 标签：python, ios, objective-c, cocoa, sockets

I need some help to translate this code from Python to Objective C (for iOS).

I know how to create the socket in C but perhaps ther is a most elegant way to do it with cocoa classes (NSStream ?)

What is the equivalent of thats chr(0x00) and b64encode ?

if you guys have some knowledge in Python And Objective, thank you for your help !

```
new = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
new.connect((dst, 55000))

msg = chr(0x64) + chr(0x00) +\
    chr(len(base64.b64encode(src)))    + chr(0x00) + base64.b64encode(src) +\
    chr(len(base64.b64encode(mac)))    + chr(0x00) + base64.b64encode(mac) +\
    chr(len(base64.b64encode(remote))) + chr(0x00) + base64.b64encode(remote)

pkt = chr(0x00) +\
    chr(len(app)) + chr(0x00) + app +\
    chr(len(msg)) + chr(0x00) + msg
new.send(pkt) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T00:39:04.470

这是部分答案。它没有解决您关于套接字的问题，因为这是我在 Objective-c 方面没有经验的领域

至于你的另外两个问题：

**相当于`chr(0x00)`什么？**

的等价物`chr(0x<num>)`很简单`'0xnum'`。所以例如`chr(0x00)`变成`'0x00'`. 请注意，在这里使用单引号而不是双引号很重要，因为与 C/objective-c 中的 python 不同，它们具有不同的含义

**b64encode 的等价物是什么？**

好吧，似乎没有办法像 python 那样开箱即用地做到这一点。但是，[在 SO wiki 上](http://stackoverflow.org/wiki/Base64_Encoding/Decoding_in_Objective-C)有一个指向[此文章](http://www.cocoawithlove.com/2009/06/base64-encoding-options-on-mac-and.html)的条目。文章末尾有一些源代码的链接，您应该可以按原样使用。它通过使用类别来添加`NSData`允许您对 base64 字符串进行编码/解码的方法来工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T03:58:31.620

此代码是有效的翻译。它当然可以改进，欢迎您提出意见，但它运行良好，并且完全符合 Python 代码的功能。

```
NSString * src = @"X.X.X.X";
NSString * mac = @"XX-XX-XX-XX-XX-XX";

const unsigned char byte64[] = {0x64};
const unsigned char byte00[] = {0x00};

NSString * srcString = [src base64EncodedString];
int srcDataLength = [srcString length];
char* srcDataLengthAsByte = (char*) &srcDataLength;

NSString * macString = [mac base64EncodedString];
int macDataLength = [macString length];
char* macDataLengthAsByte = (char*) &macDataLength;

NSString * remoteString = [remote base64EncodedString];
int remoteDataLength = [remoteString length];
char* remoteDataLengthAsByte = (char*) &remoteDataLength;

NSString * appString = [app base64EncodedString];
int appDataLength = [appString length];
char* appDataLengthAsByte = (char*) &appDataLength;

NSMutableData * msgData = [NSMutableData data];
[msgData appendBytes:byte64 length:1];
[msgData appendBytes:byte00 length:1];
[msgData appendBytes:srcDataLengthAsByte length:1];
[msgData appendBytes:byte00 length:1];
[msgData appendData:[srcString dataUsingEncoding:NSASCIIStringEncoding]];
[msgData appendBytes:macDataLengthAsByte length:1];
[msgData appendBytes:byte00 length:1];
[msgData appendData:[macString dataUsingEncoding:NSASCIIStringEncoding]];
[msgData appendBytes:remoteDataLengthAsByte length:1];
[msgData appendBytes:byte00 length:1];
[msgData appendData:[remoteString dataUsingEncoding:NSASCIIStringEncoding]];
int msgDataLength = [msgData length];
char* msgDataLengthAsByte = (char*) &msgDataLength;

NSMutableData * packet = [NSMutableData data];
[packet appendBytes:byte00 length:1];
[packet appendBytes:appDataLengthAsByte length:1];
[packet appendBytes:byte00 length:1];
[packet appendData:[appString dataUsingEncoding:NSASCIIStringEncoding]];
[packet appendBytes:msgDataLengthAsByte length:1];
[packet appendBytes:byte00 length:1];
[packet appendData:msgData];
[self send:packet]; 
```

和插座部分：

```
- (BOOL)connect
{
    struct sockaddr_in addr;
    sockfd = socket( AF_INET, SOCK_STREAM, 0 );
    addr.sin_family = AF_INET;
    addr.sin_addr.s_addr = inet_addr([TV_IP UTF8String]);
    addr.sin_port = htons(TV_PORT);
    return connect(sockfd, (struct sockaddr*)&addr, sizeof(addr))==0;
}

- (long)send:(NSData*)data
{
    long sent = send(sockfd, [data bytes], [data length], 0);

    VADebugLog(@"sent data:(%ld bytes) = [%@]",sent,[data description]);

    return sent;
}

-(void)close
{
    close(sockfd);
} 
```

并包含来自： [https://github.com/nicklockwood/Base64的 base64](https://github.com/nicklockwood/Base64)

```
#include <netinet/in.h>
#include <arpa/inet.h>
#import "Base64.h" 
```

# c# - 如何在程序运行期间保持 WCF Soap 服务打开

> ID：15211996
> 
> 赞同：1
> 
> 时间：2013-03-04T22:01:59.303
> 
> 标签：c#, wcf

我正在研究一个 C# WCF 项目，除了一个很大但希望很简单的问题外，我已经完成了它的工作。

WCF 服务托管在我的控制台应用程序中，我的控制台应用程序调用一个函数到不同的类以打开 WCF 服务的连接。

但是，如果函数的最后一行是 host.open(); 然后函数调用完成，连接被关闭，服务不能再使用。但是，如果我将 Console.ReadLine() 放在 host.open 之后，那么服务将保持打开状态并且我可以使用它，但显然程序的其余流程不再运行。

下面是我用来打开主机连接的代码。

```
public void startSoapServer()
        {
            string methodInfo = classDetails + MethodInfo.GetCurrentMethod().Name;
            if (String.IsNullOrEmpty(Configuration.soapServerSettings.soapServerUrl) ||
                Configuration.soapServerSettings.soapPort == 0)
            {
                string message = "Not starting Soap Server: URL or Port number is not set in config file";
                library.logging(methodInfo, message);
                library.setAlarm(message, CommonTasks.AlarmStatus.Medium, methodInfo);
                return;
            }
            //baseAddress = new Uri(string.Format("{0}:{1}", Configuration.soapServerSettings.soapServerUrl, 
            //    Configuration.soapServerSettings.soapPort));
            baseAddress = new Uri("http://localhost:6525/hello");

            using (ServiceHost host = new ServiceHost(typeof(SoapServer), baseAddress))
            {
                ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
                smb.HttpGetEnabled = true;
                smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
                host.Description.Behaviors.Add(smb);
                host.Opened += new EventHandler(host_Opened);
                host.Faulted += new EventHandler(host_Faulted);
                host.Open();
                Console.ReadLine();
            } 
```

没有 Console.ReadLine() 函数完成，因此连接关闭。如何在 C# 应用程序运行期间保持主机打开。

这个函数调用是从 Main 方法中调用的，在控制台中初始化一些东西的过程中途。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:04:16.373

您需要在类范围而不是函数范围内声明 ServiceHost，并且不要使用`using`.

`using {}`将自动处置它所属的对象，处置意味着关闭。此外，由于您的 ServiceHost 是在函数范围内定义的，因此一旦函数完成，它将超出范围并由垃圾收集器清理。

您的`ReadLine`调用阻止关闭的原因是因为它位于 using 语句内，并在声明变量的函数内停止程序，使其保持在范围内。

你需要做这样的事情：

```
private ServiceHost host;

public void startSoapServer()
        {
            // trimmed... for clarity

                host = new ServiceHost(typeof(SoapServer), baseAddress));

                ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
                smb.HttpGetEnabled = true;
                smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
                host.Description.Behaviors.Add(smb);
                host.Opened += new EventHandler(host_Opened);
                host.Faulted += new EventHandler(host_Faulted);
                host.Open();

           // etc. 
```

`host`当您退出应用程序时，您将关闭。