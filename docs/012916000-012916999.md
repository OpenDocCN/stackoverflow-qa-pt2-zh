# StackOverflow 问答 12916000-12916999

# c - 在 Windows 上的 C 目录中查找最旧的文件

> ID：12916003
> 
> 赞同：2
> 
> 时间：2012-10-16T13:40:24.623
> 
> 标签：c, windows, file, io, directory

我正在处理一个 C 项目，我试图在一个目录中找到最旧的文件，以便一旦找到最旧的文件，它就会被删除。我找不到任何关于如何在 C 中使用 windows 执行此操作的信息，已经找到在 Linux 中执行此操作的方法，但我需要一个适用于 Windows 的版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T13:50:57.900

基本上你扫描目录，就像在 Linux 中一样（但你也可以查看 Boost 库）。

有关时间和日期的数据已经在[目录扫描结构中可用](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx)

```
HANDLE fh;

FILETIME oldest = {-1U, -1U};

// Buffer to hold file name
oldestFile = malloc(MAX_PATH);

fd = malloc(sizeof(WIN32_FIND_DATA));
if (INVALID_HANDLE_VALUE == (fh = FindFirstFile(directory_name, fd)))
    // Signal error, free memory, (and return an error code?)

// OK to proceed
do
{
    if(fd->dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)
        continue;
    // 
    if ((fd->ftCreationTime.dwHighDateTime < oldest.dwHighDateTime)
    || (fd->ftCreationTime.dwHighDateTime == oldest.dwHighDateTime
      && fd->ftCreationTime.dwLowDateTime < oldest.dwLowDateTime))
    {
        oldest.dwHighDateTime = fd->ftCreationTime.dwHighDateTime; // ftLastAccessTime? ftLastWriteTime?
        oldest.dwLowDateTime = fd ->ft CreationTime.dwLowDateTime;
        strncpy(oldestFile, MAX_PATH, fd->cFileName);
    }
} while(FindNextFile(fh, fd));
FindClose(fh);
free(fd); fd = NULL; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:44:09.963

由于 windows 是 POSIX 兼容的，您应该能够读取目录并对`stat()`文件执行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T13:45:52.940

您需要在 Windows 上使用`FindFirstFile`/`FindNextFile`组合来获取目录中的文件。然后，您可以`stat`像在 Linux 中一样使用，也`GetFileAttributesEx`可以检查日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T13:44:22.693

您可以使用[`GetFileAttributesEx()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364946%28v=vs.85%29.aspx)填充具有三个时间相关成员的[WIN32_FILE_ATTRIBUTE_DATA的函数：](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365739%28v=vs.85%29.aspx) `struct`

*   `ftCreationTime`
*   `ftLastAccessTime`
*   `ftLastWriteTime`

您可以比较其中哪个更相关，并跟踪迭代期间找到的最旧文件。迭代结束后，使用[`DeleteFile()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363915%28v=vs.85%29.aspx). 时间成员具有类型`FILETIME`，可以使用 进行比较[`CompareFileTime()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724214%28v=vs.85%29.aspx)。

* * *

或者使用[`GetFileTime()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724320%28v=vs.85%29.aspx)来获取相关的时间属性，正如[BeyondSora](https://stackoverflow.com/users/690061/beyondsora)所评论的那样。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-10-16T14:02:41.053

要在 Windows 中查找文件的详细信息，您必须参考**文件分配表**，其中包含有关文件的所有详细信息。[在这里](http://www.dailyfreecode.com/code/file-allocation-table-2866.aspx)检查编码部分以读取 FAT

# stylesheet - 通过 Sass / Compass 实现页面特定样式

> ID：12916006
> 
> 赞同：0
> 
> 时间：2012-10-16T13:40:41.227
> 
> 标签：stylesheet, sass, compass-sass, code-organization

我想使用特定于页面的样式，例如*仅*应用于即联系人页面的contact.css（已编译）。

我编译了一个 screen.css，它导入了包含全局变量、自定义 mixins、类等的 _base.css，但问题是如果它包含来自 _base.css 的全局变量，我不能使用 contact.css 样式——即使使用在contact.css（链接）之前设置的screen.css总是输出错误。如果我将变量导入到 contact.scss 本身，我就会得到重复的样式。

我该怎么办，如何定位特定页面并在 Sass 中保留全局变量？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:09:25.727

在需要的地方创建`_globalvariables.scss`和导入，包括`_base.scss`.

对于您的`screen.scss`（或其他）， import `_base.scss`，对于`contact.scss`只需要变量的工作表，仅 import in `_globalvariables.scss`。

换句话说，将你的 mixin 和变量保存在一个表单中，而不需要任何直接编译为 CSS 的东西，这样你就可以将它导入到你想要的地方，而不必处理重复的样式声明。

# hibernate - 使用 Junit4 和 Hibernate 在 Java 中测试 DAO

> ID：12916014
> 
> 赞同：1
> 
> 时间：2012-10-16T13:41:00.977
> 
> 标签：hibernate, unit-testing, transactions, junit4

使用junit测试DAO，主要是我在hibernate中启动一个事务，调用比较函数，然后回滚事务。问题是如果我在测试函数是一个事务错误我不能剥离嵌套，我想过实现DBUnit xml的想法，但管理似乎不是一个好主意，在这种情况下我用这种方法做了足够多的测试用例。任何人都知道如何修复它而无需使用除 Junit 或 hibernate 之外的任何东西？

这是一个例子

```
@Test
public void Test1GetByCodigo(){
    String cod = "999999999";
    DBTenant dbTenant = null; 
    Session sess = null;
    Transaction trans = null;
    ClienteBO cli = null;
    Clientes clie = null;
    try{
        try{
            dbTenant = new DBTenant();
            sess = dbTenant.getTenantSession();
            trans = sess.beginTransaction();
        }
        catch(Exception e){
            fail("Error en la carga de la transaccion.Quedo alguna transaccion abierta?");
        }   
        clie  = CargaCliente(cod);
        sess.save(clie);
        cli = cliBL.getByCodigo(cod);
    }
    catch(Exception e){
        trans.rollback();
        dbTenant.closeSession();
        fail("Error la carga del cliente.Se modifico la bse de datos Clientes??");
    }
    trans.rollback();
    sess.clear();
    dbTenant.closeSession();
    ClienteBO clieEsp = CargaClienteBO(clie);
    assertNotNull(clieEsp);
    assertNotNull(cli);
    assertEquals("Error el cliente no coincide",clieEsp,cli);
} 
```

if cliBL.getbycodigo function() tubiera 一个事务会有bug，谢谢帮忙谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T09:23:09.680

使用 hibernate 为这个测试设置一个内存数据库，让 junit 测试尽可能多地使用事务。因为数据库是在测试之前创建并在之后丢弃的，所以隔离没有问题。这篇[文章](https://stackoverflow.com/a/3805230/671619)可能会有所帮助

# api - youtube API - setShuffle 不起作用

> ID：12916017
> 
> 赞同：1
> 
> 时间：2012-10-16T13:41:12.443
> 
> 标签：api, youtube, youtube-api, playlist

我在我的网站中添加了这个脚本来重现视频播放列表。

```
<script type="text/javascript" src="swfobject.js"></script>  
<div id="ytapiplayer">
You need Flash player 8+ and JavaScript enabled to view this video.
</div>
<script type="text/javascript">
var params = { allowScriptAccess: 'always',
allowFullScreen: 'true' };
var atts = { id: 'myytplayer' };
swfobject.embedSWF("https://www.youtube.com/v/videoseries?listType=playlist&list=PLBA9E733B5C8314DE&autoplay=1&modestbranding=1&enablejsapi=1&playerapiid=ytplayer&version=3", "ytapiplayer", "640", "360", "8", null, null, params, atts);
function onYouTubePlayerReady(myytplayer) {
        ytSwfPlayer = document.getElementById( 'myytplayer' );
        ytSwfPlayer.setShuffle(1);
}
</script> 
```

setShuffle 功能不起作用！！！你能建议我一个解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:41:11.713

这似乎是播放器中的一个错误。我已经向团队报告了这个错误。以后您可以在[https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20(Defect%20Report)报告错误](https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20%28Defect%20Report%29)

作为一种解决方法，您可以使用 JS api 自己洗牌。当视频结束时，您可以调用`playVideoAt`并传递一个随机数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-27T14:52:07.517

问题在于，如果您在 Youtube 播放器中加载了播放列表队列，下一首曲目将自动在当前播放曲目的末尾开始。

所以你应该绑定轨道结束事件（即`event.data = 0`），然后让 youtube 播放器做两件事：

1.  别玩了
2.  `playVideoAt`通过调用方法播放具有随机索引的新曲目。

避免多次重复相同曲目的简单解决方案是将播放的 idx 存储在列表中。然后，你应该有一个函数，比如`shuffle`生成一个介于 0 和队列长度之间的随机整数：

```
function getRandomId() {
    var random_id = 0
    while(played_idx.indexOf(random_id) != -1) {
      random_id = Math.floor(Math.random * playlist.length)
    }
    return random_id
} 
```

然后，只需调用`playVideoAt(random_id)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-05T17:13:02.233

我注意到如果您稍后启动该命令，setShuffle 确实有效。像这样的东西：

```
function onPlayerReady(event) {
    event.target.mute();
    setTimeout( function() { 
        event.target.setShuffle(true); 
        event.target.setLoop(true);
    }, 2000);
} 
```

如果你直接启动它，它肯定不会工作（我已经注意到，令我沮丧）。

# c# - Windows 控制台应用程序最后突然崩溃

> ID：12916021
> 
> 赞同：0
> 
> 时间：2012-10-16T13:41:18.563
> 
> 标签：c#, crash

我有一个 C# 中的应用程序，它可以工作并在最后突然结束说

> “ABC.exe 已停止工作” 一个问题导致程序停止正常工作。Windows 将关闭程序... . . . .

如果我设置断点并逐行执行直到 main() 结束，它可以完美运行，没有任何问题。不能从根本上导致这个问题发生在哪里？

您能否指导在这种情况下该怎么做？我正在使用 VS2012 和 Win8 操作系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T13:49:49.527

[抛出异常时](http://msdn.microsoft.com/en-us/library/d14azbfh.aspx)需要中断

# logging - 禁用大型有效负载的日志记录 - Mule 3.3.0

> ID：12916023
> 
> 赞同：2
> 
> 时间：2012-10-16T13:41:23.520
> 
> 标签：logging, mule

我需要找到一种方法来防止在发生异常时记录大型有效负载。当连接超时时，我正在通过 FTP 发送大文件（大约 30MB），记录了整个有效负载内容。

```
[01-10-2012 10:32:59:059] ERROR exception.DefaultMessagingExceptionStrategy:
********************************************************************************
Message               : Connection timed out (java.net.ConnectException)
Code                  : MULE_ERROR--2
--------------------------------------------------------------------------------
Exception stack is:
1\. Connection timed out (java.net.ConnectException)
  java.net.PlainSocketImpl:-2 (null)
2\. Connection timed out (java.net.ConnectException) (org.mule.transport.ConnectException)
  org.mule.transport.ftp.FtpConnector:556 (http://www.mulesoft.org/docs/site/current3/apidocs/org/mule/transport/ConnectExcepti
on.html)
--------------------------------------------------------------------------------
Root Exception stack trace:
java.net.ConnectException: Connection timed out
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
    + 3 more (set debug level logging or '-Dmule.verbose.exceptions=true' for everything)
********************************************************************************

[01-10-2012 10:32:59:059] ERROR exception.DefaultMessagingExceptionStrategy: Message being processed is: 
+++++++++++LARGE_PAYLOAD_CONTENT++++++++++++++
.
.
.
.
. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T16:36:44.850

对于 Mule 3.3.0，唯一的选择是将记录器设置`org.mule.exception.DefaultMessagingExceptionStrategy`为`FATAL`（通过 Log4j 配置）。

这已在 Mule 3.3.1 / 3.4.0-SNAPSHOT 中修复：现在仅当记录器`org.mule.exception.DefaultMessagingExceptionStrategy`设置为时才会记录完整的消息负载`DEBUG`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:47:38.443

尝试将 mule.verbose.exceptions 设置为 false

`-Dmule.verbose.exceptions=false`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T19:23:16.560

这已针对 3.3.1（仅限 EE）修复：http: [//www.mulesoft.org/jira/browse/MULE-6268](http://www.mulesoft.org/jira/browse/MULE-6268)

# android - pm.hasSystemFeature(PackageManager.FEATURE TELEPHONY); 总是返回假

> ID：12916028
> 
> 赞同：2
> 
> 时间：2012-10-16T13:41:33.247
> 
> 标签：android, uses-feature

我正在尝试检查设备是否具有电话功能。但是在模拟器中，它总是返回false。为什么会这样？难道我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-02T13:18:13.007

您可以将代码包装在 try/catch 中。它适用于所有情况，即使关于短信发送的最后一个 api 更改。

```
try{
    // code that use telephony features
}
catch(Exception e){
    // code that doesn't use telephony features
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-18T09:02:14.337

您还可以连接到模拟器控制台以模拟传入的语音呼叫或 SMS。有关详细信息，请参阅电话仿真和 SMS 仿真。
本页结尾：[https](https://developer.android.com/studio/run/emulator-networking)
://developer.android.com/studio/run/emulator-networking 这很正常，你的模拟器不打电话也不发短信（注意 Telephony 包含很多功能）

# c# - 不规则的事件行为 - 触发取决于订阅子控件的等效事件

> ID：12916029
> 
> 赞同：0
> 
> 时间：2012-10-16T13:41:33.770
> 
> 标签：c#, .net, events, windows-runtime, winrt-xaml

我在 WinRT 的 ListView 中遇到了这种行为。

`LayoutUpdated`如果没有事件处理程序附加到 inner`ScrollViewer`的`LayoutUpdated`事件，则事件的触发频率会降低。

我用 标记了靠近底部的临界线`// === Critical line ===`。删除前导斜杠将导致`lv_LayoutUpdated`更频繁地调用。

这会产生影响，因为该事件很少被触发，以至于它对我没有任何用处（在注释掉的情况下）问题是，我无法在`ScrollViewer`' 的突变结束之前设置滚动位置。不过，通过 ' 事件进行路由`ScrollViewer`似乎很愚蠢。

这是一个错误还是可以用冒泡策略或某事来解释？

编辑：顺便说一句，此页面未显示在应用程序的根框架中，而是显示在不同页面的框架中，如果这有什么不同的话。

EDIT2：我最终发现了为什么触发时间没用（正在执行数据绑定异步，这与标准事件时间有关）。但是，这种行为仍然存在 - 订阅`ScrollViewer`' 事件会导致 ' 事件发布更多内容`ListView`。这最终会在什么其他情况下发生，我不知道。我正在使用 Caliburn.Micro - 所以他们的数据源接线可能会对控件产生影响。例如，CM 的一个问题是，它吞下了视图的第一个 LayoutUpdated 事件（如果至少通过 Message:Attach 绑定）——尽管这可能只会影响视图模型。

无论如何，我会把这个问题留给其他人来解决。

代码隐藏中的此设置：

```
 public FileListView()
    {
        this.InitializeComponent();

        var lv = (ListView)FindName("Files");

        lv.Loaded += lv_Loaded;

        lv.LayoutUpdated += lv_LayoutUpdated;
    }

    void lv_LayoutUpdated(object sender, object e)
    {
        var m = (FileListViewModel)DataContext;
        m.Offset = 100;
    }

    void lv_Loaded(object sender, RoutedEventArgs e)
    {
        var lv = (ListView)sender;

        var sv = lv.GetFirstDescendantOfType<ScrollViewer>();

        if (sv == null)
        {
            return;
        }
        //sv.LayoutUpdated += sv_LayoutUpdated; // === Critical line ===
    }

    void sv_LayoutUpdated(object sender, object e)
    {
      // No code here. Just the subscription suffices
    } 
```

XAML：

```
 <Page
    x:Class="Namespace1.FileListView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Poolar.Mobile.PsProject.WinRT.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid HorizontalAlignment="Left" Height="768" VerticalAlignment="Top" Width="1366">
        <Grid.RowDefinitions>
            <RowDefinition Height="61*"/>
            <RowDefinition Height="707*"/>
        </Grid.RowDefinitions>
        <ListView x:Name="Files" HorizontalAlignment="Left" Height="446" VerticalAlignment="Top" Width="1366"
                  Margin="10,10,-10,0" Grid.Row="1" />
        <Button x:Name="GoBack" x:Uid="ButtonGoBack" Content="Button" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top"/>
    </Grid>
  </Page> 
```

# sql - 相同数据更新的例外

> ID：12916031
> 
> 赞同：2
> 
> 时间：2012-10-16T13:41:38.030
> 
> 标签：sql, oracle, plsql, oracle11g

在异常处理方面需要帮助。如果我运行这个 UPDATE 脚本一旦它工作，但是当我运行相同的脚本两次或多次时，我会收到以下错误“1 row updated.commited”，但它不正常。我想收到异常。“注意：表格已经更新”

```
UPDATE FBTB_TXNLOG
SET txnstageid = '-1',
LOCKED = 'N',
where xrefid = 'FJB1229000056689';
commit; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:50:06.513

试试这个解决方案：

```
SET SERVEROUTPUT ON -- need for dbms_output.put_line()
declare 
  cnt int;
begin
  -- if data exists 
  SELECT count(1)  
  INTO   cnt
  FROM   FBTB_TXNLOG
  WHERE   txnstageid = '-1'
  and  LOCKED = 'N'
  and xrefid = 'FJB1229000056689';

 if (cnt > 0 ) 
 then  
   -- exists: display message
   dbms_output.put_line('Table is already updated');  
 else
   -- let's edit 
   UPDATE FBTB_TXNLOG
   SET txnstageid = '-1',
       LOCKED = 'N',
   where xrefid = 'FJB1229000056689';
   commit;
 end if; 
end;
/ 
```

# html - 以表格结构显示数据，如下所示

> ID：12916032
> 
> 赞同：0
> 
> 时间：2012-10-16T13:41:38.437
> 
> 标签：html

我正在从数据库中读取数据，并对其进行迭代。我想显示它，如下所示。这里的挑战是它没有侧边界，两个记录集之间有粗线和其中的温和线。有可能实现这种结构吗？

![在此处输入图像描述](../Images/f20b8bfdfa3d1d7a4bf4087f2935f2b3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:51:09.960

是的。通常更容易将表格用作**没有样式**的容器，并在每个单元格中放置一个 DIV，并在 DIV 上使用类名来控制外观。

```
<table>
   <tr>
     <td>
        <div class="topRow Col1"></div>
      ... etc ... 
```

# apache - Apache POI：比较工作表的简单方法？

> ID：12916034
> 
> 赞同：2
> 
> 时间：2012-10-16T13:41:51.163
> 
> 标签：apache, compare, apache-poi

我需要将两个工作表与 Apache POI 进行比较。有没有一种简单的方法可以做到这一点，例如工作表比较功能，还是我必须比较每个单元格？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-01T20:30:11.437

由于这是 Google 上出现的关于比较 POI 工作簿的第一个问题，我想分享一个适用于单元测试的解决方案。我找到了一个很好的 Hamcrest 匹配器来解决这个问题：

[http://baddotrobot.com/blog/2012/09/14/diff-excel-with-java-and-hamcrest/](http://baddotrobot.com/blog/2012/09/14/diff-excel-with-java-and-hamcrest/)

基本上，通过 Maven 导入库（在 Github README 中有详细说明）。一旦你有两个 POI 工作簿，你就可以编写一个类似于下面的断言：

```
MatcherAssert.assertThat("Workbooks to be identical", actualWorkbook,
    WorkbookMatcher.sameWorkbook(expectedWorkbook)); 
```

> 注意：我在这里使用 MatcherAssert 来检索更详细的比较注释，但 JUnit Assert 也可以使用。这在作者的网站上有说明。

它可以在[GitHub 上](https://github.com/tobyweston/simple-excel)以及通过作者的[个人 Maven 存储库](http://www.robotooling.com/maven/)获得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-15T16:36:06.223

```
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.junit.Assert;

public class CompareExcel {

    public static void assertWorkbooksEqual(final XSSFWorkbook workbookA, final XSSFWorkbook workbookB) {
        for (int i = 0; i < workbookA.getNumberOfSheets(); i++) {
            final XSSFSheet sheetA = workbookA.getSheetAt(i);
            final XSSFSheet sheetB = workbookB.getSheetAt(i);

            compareTwoSheets(sheetA, sheetB);
        }
    }

    private static void compareTwoSheets(final XSSFSheet sheetA, final XSSFSheet sheetB) {
        final int firstRowA = sheetA.getFirstRowNum();
        final int lastRowB = sheetA.getLastRowNum();

        final String sheetName = sheetA.getSheetName();
        Assert.assertEquals(sheetName, sheetB.getSheetName());

        Assert.assertEquals("In sheet: " + sheetName, firstRowA, sheetB.getFirstRowNum());
        Assert.assertEquals("In sheet: " + sheetName, lastRowB, sheetB.getLastRowNum());

        for(int i=firstRowA; i <= lastRowB; i++) {

            final XSSFRow rowA = sheetA.getRow(i);
            final XSSFRow rowB = sheetB.getRow(i);

            compareTwoRows(sheetName, rowA, rowB);
        }
    }

    private static void compareTwoRows(final String sheetName, final XSSFRow rowA, final XSSFRow rowB) {
        if((rowA == null) && (rowB == null)) {
            return;
        }
        Assert.assertNotNull("In sheet: " + sheetName, rowA);
        Assert.assertNotNull("In sheet: " + sheetName, rowB);

        final int firstCellA = rowA.getFirstCellNum();
        final int lastCellA = rowA.getLastCellNum();

        Assert.assertEquals("In sheet: " + sheetName, firstCellA, rowB.getFirstCellNum());
        Assert.assertEquals("In sheet: " + sheetName, lastCellA, rowB.getLastCellNum());

        for(int i=firstCellA; i <= lastCellA; i++) {
            final XSSFCell cellA = rowA.getCell(i);
            final XSSFCell cellB = rowB.getCell(i);
            compareTwoCells(sheetName, cellA, cellB);
        }
    }

    private static void compareTwoCells(final String sheetName, final XSSFCell cellA, final XSSFCell cellB) {
        if((cellA == null) && (cellB == null)) {
            return;
        }
        Assert.assertNotNull(cellA);
        Assert.assertNotNull(cellB);

        String valueA = null;
        String valueB = null;

        Assert.assertEquals(cellA.getCellTypeEnum(), cellB.getCellTypeEnum());

        switch(cellA.getCellTypeEnum()) {
            case NUMERIC:
                valueA = String.valueOf(cellA.getNumericCellValue());
                valueB = String.valueOf(cellB.getNumericCellValue());
                break;
            case STRING:
                valueA = cellA.getStringCellValue();
                valueB = cellB.getStringCellValue();
                break;
            default:
                Assert.fail(
                        String.format(
                                "Unexpected cell type '%s' in sheet: '%s' row: '%s' column: '%s'",
                                cellA.getCellTypeEnum().name(),
                                sheetName,
                                cellA.getRowIndex(),
                                cellA.getColumnIndex()
                        ));
        }

        Assert.assertEquals(
                String.format(
                        "Cell values do not match in sheet: '%s' row: '%s' column: '%s'",
                        sheetName,
                        cellA.getRowIndex(),
                        cellA.getColumnIndex()
                ),
                valueA, valueB);
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-22T09:42:34.510

尝试遍历所有单元格并计算正在运行的哈希或类似的东西。您运行它两次，每个工作表一次，如果哈希相同 - 工作表是相同的。AFAIK，没有开箱即用的方法可以做到这一点。

我相信这是一种比逐个单元进行比较更好的方法，因为您一次只能打开一个工作表（而不是逐个单元方法中的两个工作表）。

# php - mysql 多个查询或外键（表关系）

> ID：12916035
> 
> 赞同：-5
> 
> 时间：2012-10-16T13:41:51.390
> 
> 标签：php, mysql, yii

我想知道什么是更好的做法（以及更好的性能）：

使用从 1 个表到多个表的多个外键（因此，当我获取对象时，它是一个更大的对象并使用关系包含所有其他表信息），或者从表中获取一个对象，然后执行另一个查询以获取其余数据.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T13:47:33.723

通常这取决于您从多个表中获取哪些列的频率。

1.如果您在一个表中创建许多外键，然后将这些外键连接到许多其他键，那么您最终将连接许多表以获取所需的数据。

2.所以我建议你首先确定你主要从这个主表中查看什么类型的数据以及你使用它的频率。

3.此外，您需要在所有连接键上创建索引以获得更好的性能。这一方面是开销，另一方面可以节省您的时间。

所以这一切都取决于你的需求。

# android - Android：无法使用 SQL 扩展功能或内置更新行

> ID：12916041
> 
> 赞同：0
> 
> 时间：2012-10-16T13:42:23.980
> 
> 标签：android, sqlite, spatialite

我在使用 SQLiteDatabase 命令时遇到了很多麻烦。我已经加载了 spatialite 并启用了扩展。我希望我的值之一是 MakePoint 函数的输出，所以我有一个这样的内容值：

```
values.put("Location", "MakePoint(43.2, 27.345, 4326)"); 
```

当它被传递到`SQLiteDatabase.Update()`它时，它会被转义，以便最终生成的字符串成为`"UPDATE Targets SET Location='MakePoint(43.2, 27.345, 4326)'"`SQLite 讨厌它并抛出异常。

有没有简单的方法解决这个问题？现在我正在尝试手动构建字符串，因为我无法使用更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:09:09.470

`SQLiteDatabase`不是为 SpatiaLite 扩展设计的。 `update()`仅支持简单值，不支持泛型表达式；您不能使用它来插入地理对象。

执行命令的唯一方法是手动构建它并运行它`execSQL()`。

您可以编写自己的数据库包装对象来理解 SpatiaLite 数据类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T20:00:37.560

我想到了。我必须先执行“SELECT MakePoint(43.2, 27.345, 4326)”，然后将其插入位置。

# javascript - 仅使用正则表达式查找不是电子邮件地址的所有内容

> ID：12916042
> 
> 赞同：1
> 
> 时间：2012-10-16T13:42:26.757
> 
> 标签：javascript, regex, email

我需要在不是电子邮件地址的字符串中找到所有内容。

这是我如何查找电子邮件地址的版本。

```
^[a-zA-Z0-9_.-]+@[a-zA-Z0-9][a-zA-Z0-9-.]+\.([a-zA-Z]{2,6})$ 
```

我想修改这个正则表达式来找到相反的——除了任何字符串中的电子邮件地址之外的所有内容。

* * *

###示例1： `asdasd`

###示例 2：123@asd.com`sda`

* * *

**注意：** 我想进入`status == true`以下行：

```
var status = myString.match(pattern matches everything that is not an email address); 
```

###我只能换花样，没有别的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T13:51:45.360

官方标准称为[RFC 2822](https://www.rfc-editor.org/rfc/rfc2822#section-3.4.1)。电子邮件地址的正则表达式模式是：

```
(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]) 
```

更实际的 RFC 2822 实现（如果我们省略使用双引号和方括号的语法），它仍然匹配当今实际使用的所有电子邮件地址的 99.99%，它是：

```
[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])? 
```

要从`myString`使用 JavaScript 代码中获取不匹配的“单词”列表：

```
var status = myString.match(/(?:\s|^)(?![a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)\S+\b(?=\s|$)/ig); 
```

检查[**这个演示**](http://jsfiddle.net/B3763/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:46:23.943

您可以使用空字符串调用`replace`，以删除与您的模式匹配的电子邮件实例：

```
var noEmails = stringWithEmails.replace(/[a-zA-Z0-9_.-]+@[a-zA-Z0-9][a-zA-Z0-9-.]+\.([a-zA-Z]{2,6})/g, ''); 
```

请注意，我取出了前导`^`和尾随`$`。这些迫使模式匹配整个字符串（`^`是行首，`$`是行尾）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:50:33.427

```
var result=myString.replace('[a-zA-Z0-9_.-]+@[a-zA-Z0-9][a-zA-Z0-9-.]+\.([a-zA-Z]{2,6})', ''); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T13:58:06.140

string.replace(/[/[a-zA-Z0-9_.-]+@[a-zA-Z0-9][a-zA-Z0-9-.]+.([a-zA-Z] {2,6})]*/gi, '');

它的工作

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-16T14:16:25.403

根据您的编辑，您真正想要的是

```
var status = ! myString.match(email pattern) 
```

也就是说，与警卫一起使用您的电子邮件模式（或 Ωmega 发布的巨型东西）。这将匹配*只有*电子邮件地址的所有内容。这与你想要的完全相反，所以反转布尔值，你就完成了。

# sql-server - 检查点会阻止所有其他操作吗？

> ID：12916043
> 
> 赞同：1
> 
> 时间：2012-10-16T13:42:36.923
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, checkpoint

当 Sql Server 发出检查点时，它是否会阻塞所有其他操作，直到检查点完成？

如果我理解正确，当检查点发生时，服务器应该写入所有脏页。

完成后，它将检查点写入事务日志，因此如果发生任何故障，它将仅处理该时间点的事务（或在检查点时已经开始的事务）。

sql server 如何在检查点进行时防止某些非脏页变脏？

它会阻止所有写入直到检查点完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:04:34.797

检查点不会阻止写入。

检查点有一个开始和一个结束 LSN。它保证磁盘上的所有页面至少在检查点的起始 LSN 处。任何页面是否在稍后的 LSN 上都没有关系（因为它是在检查点开始之后写入的）。

检查点只保证磁盘上所有页面的最小 LSN。它不保证准确的 LSN。

这是有道理的，因为您可以删除所有包含来自 LSN 的信息的事务日志记录，这些 LSN 早于检查点开始 LSN。这就是检查点的目的：允许部分日志变为非活动状态。

数据一致性和正确性不需要检查点。它们只是释放日志空间并缩短恢复时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:18:10.457

> 发生检查点时，服务器应写入所有脏页

这就是它的作用。*然而，检查点提供的保证是它会在检查点开始*时写入所有脏页。在检查点进行过程中变脏的任何页面可能会或可能不会被写入，但不能*保证*会被写入。该保证提供的是一种优化，即物理恢复可以从最后一个检查点开始 REDO，因为在它之前的日志中的所有内容都已应用于数据页（不必重做）。甚至在[ARIES 的维基百科页面上](http://en.wikipedia.org/wiki/Algorithms_for_Recovery_and_Isolation_Exploiting_Semantics)：

> 简单的检查点方法包括锁定整个数据库以避免在创建检查点期间更改 DPT 和 TT。模糊日志通过写入两条日志记录来规避这一点。One Fuzzy Log Starts Here 记录，并在准备好检查点数据后，记录实际的检查点。可以在两条记录之间创建其他日志记录

usr 的回答解释了这是如何实现的（通过使用检查点开始 LSN 和结束 LSN）。

# javascript - 将社交媒体的外部 Javascript 加载到网页中的目的

> ID：12916045
> 
> 赞同：1
> 
> 时间：2012-10-16T13:42:49.620
> 
> 标签：javascript, html, performance, social-networking, webpage

在网页中添加社交媒体资源时，传统方法会导致从其他域加载大量外部 JS，仅加载带有品牌图像背景的 iframe 或锚点。以下可能是网络上传输最多的文件（在[http://www.google-analytics.com/ga.js](http://www.google-analytics.com/ga.js) 36.35KB 之后，这对许多人来说是不可避免的）

[http://connect.facebook.net/en_US/all.js](http://connect.facebook.net/en_US/all.js) 181.30KB（59.06KB 压缩）
[https://platform.twitter.com/widgets.js](https://platform.twitter.com/widgets.js) 75.19KB（24.42KB 压缩）
[https://apis.google。 com/js/plusone.js](https://apis.google.com/js/plusone.js) 16.71KB
[http://assets.pinterest.com/js/pinit.js](http://assets.pinterest.com/js/pinit.js)（这个很小，但仍然不需要连接）

> 例如，[http](http://connect.facebook.net/en_US/all.js) ://connect.facebook.net/en_US/all.js 只做一件事：添加 iFrame`<iframe src="//www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Flavishdream&amp;width=292&amp;height=180&amp;colorscheme=light&amp;show_faces=true&amp;border_color&amp;stream=false&amp;header=false" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:292px; height:180px;" allowtransparency="true"></iframe>`
> 
> Twitter 和 Google Plus 脚本执行非常相似的任务，只是将小的 HTML 块添加到页面中。

为什么不只编写那些 iFrame、图像和锚点 HTML 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:06:57.683

您提到的大多数脚本也在后台跟踪用户行为。此外，在加载 JS 文件时，提供者（例如 Google）可能会更改此类脚本附带的功能。当您只是添加一个静态文件或自己编写所需的 HTML 时，这不会那么容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:46:36.517

它不会干扰您的网站性能。每个 js 应该加载多个资源，这不应该影响它们嵌入的站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:58:58.090

您所指的库不仅仅是添加简单的 iFrame。它们还引用框架内的对象。就性能而言，您将遇到的唯一问题是托管 js 文件的站点是否出现故障。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-16T13:56:06.333

首先，任何 Javascript 都是客户端应用程序，因此您不必担心布局这些组件所需的性能。其次，这些文件非常小，因此流量可以忽略不计，即使 iFrame 是 HTML 格式，您也需要某种连接来获取它，对吧？因为显然你不能只在代码中静态地放置喜欢按钮（出于可维护性的原因）

# javascript - Rails - 使用 AJAX 时刷新页面而不是部分

> ID：12916048
> 
> 赞同：0
> 
> 时间：2012-10-16T13:42:55.600
> 
> 标签：javascript, jquery, ruby-on-rails, ajax

> **可能重复：**
> [Rails - AJAX 用于新/创建操作](https://stackoverflow.com/questions/12915062/rails-ajax-to-for-new-create-action)

我有一个时间轴，上面有部分事件，因此您可以直接在时间轴上 CRUD 事件。我的删除部分工作正常，因此每次删除事件时，删除部分和时间线都会刷新。但是，当创建新事件时，我无法让它工作。不是刷新表单和时间线，而是刷新整个页面。

我假设这与控制器有关？但我似乎无法修复它。任何帮助将不胜感激，谢谢：0）

事件控制器：

```
def create
    @event = Event.new(params[:event])

    respond_to do |format|
      if @event.save
        format.html { redirect_to @event.timeline, notice: 'Event was successfully created.' }
        format.json { render json: @event, status: :created, location: @event }
        format.js 
      else
        format.html { render action: "new" }
        format.json { render json: @event.errors, status: :unprocessable_entity }
        format.js 
      end
    end
  end 
```

时间线/节目：

```
<div id="new-event">
        <%= render :partial => "new_event", :locals => { :event => Event.new(:timeline_id=>@timeline.id) }, :remote => true %>
    </div> 
```

时间线/_new_event：

```
<br />
<h2>Add an event</h2>
<h4>Fill in the form and click 'Create Event' to add a new event to the timeline.</h4>

<%= form_for(event) do |f| %>
  <% if event.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(event.errors.count, "error") %> prohibited this event from being saved:</h2>

      <ul>
      <% event.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%=f.hidden_field 'timeline_id', :value => current_user.timeline.id %>
  <div class="field">
    <%= f.label :date %><br />
    <%= f.date_select :start_date, :order => [:day, :month, :year], :start_year => 1800 %>
  </div>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :headline, :size => 50 %>
  </div>
  <div class="field">
    <%= f.label :event_description %><br />
    <%= f.text_area :text, :size => "47x4" %>
  </div>
  <%= check_box_tag "blockCheck", :value => "1", :checked => false %>
  <div class="field" id="media_box">
    <%= f.label :media %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>Please paste a URL here</span><br />
    <%= f.text_field :media, :size => 50 %>
  </div>
  <div class="field">
    <%= f.label :media_description %><br />
    <%= f.text_area :caption, :size => "47x3" %>
  </div>
  <div class="actions">
    <%= f.submit 'Create Event', :class => "btn btn-success", :remote => true  %>
  </div>
<% end %> 
```

事件/create.js.erb：

```
$('#new-event').html('<%= escape_javascript( render :partial => "/timelines/new_event", :locals => { :event => Event.new(:timeline_id=>@timeline.id) } ) %>');
$('.notice').html("<p>Event was successfully created.</p>");
$('.notice').show(300);
$('#my-timeline-box').html('<%= escape_javascript( render :partial => "/timelines/my_timeline" ) %>');
$('#show-timeline').html('<%= escape_javascript( render :partial => "/timelines/show_timeline" ) %>'); 
```

（下面两行是刷新时间线本身）。

更新：

这是错误消息：

```
Started POST "/events" for 127.0.0.1 at 2012-10-16 14:52:37 +0100
Processing by EventsController#create as JS
  Parameters: {"utf8"=>"V", "authenticity_token"=>"i8oiRI7rOLsfb5o45QCK0te/hAsWv
BMTqpxU9KrbmNA=", "event"=>{"timeline_id"=>"1", "start_date(3i)"=>"16", "start_d
ate(2i)"=>"10", "start_date(1i)"=>"2012", "headline"=>"", "text"=>"", "media"=>"
", "caption"=>""}, "commit"=>"Create Event"}
  ←[1m←[35m (0.0ms)←[0m  begin transaction
  ←[1m←[36mSQL (5.0ms)←[0m  ←[1mINSERT INTO "events" ("caption", "created_at", "
credit", "end_date", "headline", "media", "start_date", "text", "thumbnail", "ti
meline_id", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)←[0m  [["capti
on", ""], ["created_at", Tue, 16 Oct 2012 13:52:37 UTC +00:00], ["credit", nil],
 ["end_date", nil], ["headline", ""], ["media", ""], ["start_date", Tue, 16 Oct
2012], ["text", ""], ["thumbnail", nil], ["timeline_id", 1], ["updated_at", Tue,
 16 Oct 2012 13:52:37 UTC +00:00]]
  ←[1m←[35m (88.0ms)←[0m  commit transaction
  Rendered events/create.js.erb (99.0ms)
Completed 500 Internal Server Error in 617ms

ActionView::Template::Error (Called id for nil, which would mistakenly be 4 -- i
f you really wanted the id of nil, use object_id):
    1: $('#new-event').html('<%= escape_javascript( render :partial => "/timelin
es/new_event", :locals => { :event => Event.new(:timeline_id=>@timeline.id) } )
%>');
    2: $('.notice').html("<p>Event was successfully created.</p>");
    3: $('.notice').show(300);
    4: $('#my-timeline-box').html('<%= escape_javascript( render :partial => "/t
imelines/my_timeline" ) %>');
  app/views/events/create.js.erb:1:in `_app_views_events_create_js_erb___8626901
43_20024148'
  app/controllers/events_controller.rb:59:in `create'

  Rendered C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.4.rc1/lib/action_d
ispatch/middleware/templates/rescues/_trace.erb (5.0ms)
  Rendered C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.4.rc1/lib/action_d
ispatch/middleware/templates/rescues/_request_and_response.erb (2.0ms)
  Rendered C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.4.rc1/lib/action_d
ispatch/middleware/templates/rescues/template_error.erb within rescues/layout (1
000.1ms) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:00:44.440

您尚未在控制器代码中初始化 @timeline。因此你得到一个 nil 动作。

因此，输入您的创建代码：

```
@timeline = current_user.timeline 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:48:13.723

你有`:remote => true`提交按钮。这是不正确的。它应该在表格上：

```
<%= form_for(event, :remote => true) do |f| %> 
```

# asp.net - asp.net 查询字符串格式化

> ID：12916050
> 
> 赞同：0
> 
> 时间：2012-10-16T13:43:02.783
> 
> 标签：asp.net, vb.net, query-string, request-queueing

如何在查询字符串中发送特殊字符？

喜欢：

```
thankyou.aspx?data=GQH/FUvq9sQbWwrYh5xX7G++VktXU5o17hycAfNSND8gt8YbbUaJbwRw 
```

当我这样做时， **++**被取出：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
  Dim theData As String = Request.QueryString("data")
  .... 
```

它将它存储在 theData 中，如下所示：

**GQH/FUvq9sQbWwrYh5xX7G VktXU5o17hycAfNSND8gt8YbbUaJbwRw**

因此，它是无效的。我怎样才能正确地发送该字符串而不会在收到后更改？

**更新**

这样做：

```
Dim en As String = endecryption.EncryptData("=" & "aclub" & "=" & strName & "=" & strEmail)
Response.Redirect("/thankyou.aspx?data=" & HttpUtility.UrlEncode(en), False) 
```

在另一端：

```
Dim theData As String = HttpUtility.UrlDecode(Request.QueryString("data")) 
```

它像这样发送它：**GQH%2fFUvq9sQbWwrYh5xX7G%2bVktXU5o17hycAfNSND8gt8YbbUaJbwRw**

但它的解码方式如下：**GQH/FUvq9sQbWwrYh5xX7G[2 个空格]VktXU5o17hycAfNSND8gt8YbbUaJbwRw**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T13:45:15.007

看看使用 Server.UrlEncode() 在将参数包含在查询字符串中之前对其进行编码，并在需要时使用 Server.UrlDecode() 将其转换回来。

[msdn文章](http://msdn.microsoft.com/en-us/library/ms525738%28v=vs.90%29.aspx)

在“GQH/FUvq9sQbWwrYh5xX7G++VktXU5o17hycAfNSND8gt8YbbUaJbwRw”上调用 Server.UrlEncode() 产生：

```
GQH%2fFUvq9sQbWwrYh5xX7G%2b%2bVktXU5o17hycAfNSND8gt8YbbUaJbwRw 
```

并在该结果上调用 Server.UrlDecode 会产生：

```
GQH/FUvq9sQbWwrYh5xX7G++VktXU5o17hycAfNSND8gt8YbbUaJbwRw 
```

在将查询字符串数据附加到 url 之前，您需要确保对查询字符串数据进行 url 编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:14:20.730

你可以：

1.  ~~正如迈克所说，您可以[HttpServerUtility.UrlEncode](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.urlencode.aspx)上面的 base64 字符串（并反过来解码）~~
2.  如果您在两端都坚持使用 MS，您还可以查看[HttpServerUtility.UrlTokenEncode](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.urltokenencode.aspx) -如果您选择此选项，请参阅[此说明](https://stackoverflow.com/a/1789179/304683)

## 更新

啊。它回到了我的身边——base64 陷阱：*“HttpRequest 的构造函数将为你解析实际的字符串 QueryString 和 UrlDecode 值。小心不要双重解码。”* ——[**斯科特·汉塞尔曼**](http://www.hanselman.com/blog/ASPNETParamsCollectionVsQueryStringFormsVsRequestindexAndDoubleDecoding.aspx)

如果你要做base64，我个人的建议是走UrlToken路线......

# c# - 附加在订阅者方法中收到的字符串？

> ID：12916053
> 
> 赞同：2
> 
> 时间：2012-10-16T13:43:14.850
> 
> 标签：c#, event-handling, serial-port, append, grasshopper

`myReceivedLines`在下面的代码中，当与我的串行端口连接时（当`connecttodevice`为真时）出现在其中接收到的字符串。但是，当我启动另一个命令时它们会消失（何时`homeall`为真）。

我添加了`myReceivedLines`在类中调用的字段，以便我可以使用该方法`String.Add()`接收到的所有反馈和发送的命令（就像程序中的控制台一样）。

为什么发送命令后反馈消失？如何确保所有字符串都保留在变量中`myReceivedLines`？字符串是否会`myReceivedLine`因为它们发生在订阅者方法中而消失？我该如何解决？

注意：GH_DataAccess.SetDataList(Int32, IEnumerable) 是来自内核的一种方法，一个名为[Grasshopper](http://grasshopper3d.com)的软件将值分配给输出（它必须在也来自这个内核的 GH_Component.SolveInstance() 方法中使用），我是使用它来可视化 myReceivedLines。

**代码：**

```
 public class SendToPrintComponent : GH_Component
    {
        //Fields
        List<string> myReceivedLines = new List<string>();
        SerialPort port;

        //subscriber method for the port.DataReceived Event
        private void DataReceivedHandler(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
        {
            SerialPort sp = (SerialPort)sender;
            while (sp.BytesToRead > 0)
            {
                try
                {
                    myReceivedLines.Add(sp.ReadLine());
                }
                catch (TimeoutException)
                {
                    break;
                }
            }
        }

        protected override void SolveInstance(IGH_DataAccess DA)
        {
           //Opening the port
            if (port == null)
            {
                string selectedportname = default(string);
                DA.GetData(1, ref selectedportname);
                int selectedbaudrate = default(int);
                DA.GetData(2, ref selectedbaudrate);

                //Assigning an object to the field within the SolveInstance method()
                port = new SerialPort(selectedportname, selectedbaudrate, Parity.None, 8, StopBits.One);

                //Enables the data terminal ready (dtr) signal during serial communication (handshaking)
                port.DtrEnable = true;
                port.WriteTimeout = 500;
                port.ReadTimeout = 500;
            }

            //Event Handling Method
            bool connecttodevice = default(bool);
            DA.GetData(3, ref connecttodevice);

            **if (connecttodevice == true)**
            {
                if (!port.IsOpen)
                {
                    port.DataReceived += new SerialDataReceivedEventHandler(DataReceivedHandler);
                    DA.SetDataList(0, myReceivedLines);
                    port.Open();

                }
            }
            else
            if (port.IsOpen)
                {
                    port.DataReceived -= new SerialDataReceivedEventHandler(DataReceivedHandler);
                    port.Close();
                }

            if (port.IsOpen)
            {
                DA.SetData(1, "Port Open");
            }

            //If the port is open do all the rest
            if (port.IsOpen)
            {
                bool homeall = default(bool);
                DA.GetData(5, ref homeall);

                //Home all sends all the axis to the origin
                **if (homeall == true)**
                {
                    port.Write("G28" + "\n");
                    myReceivedLines.Add("G28" + "\n");
                    DA.SetDataList(2, myReceivedLines);
                }

            }
            else
            {
                DA.SetData(1, "Port Closed");
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T13:57:27.957

如果您尝试附加到字符串，我会推荐一个 StringBuilder 对象。

或者不太清晰的分辨率，使用 += 运算符，

```
string s = "abcd";
s+="efgh";
Console.WriteLine(s); //s prints abcdefgh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:23:26.910

首先，您的变量（myReceivedLines 和端口）不是静态的。我不确定您是否希望它们是静态的，因为我看不到您如何使用 SendToPrintComponent 类。你能解释一下 DA.SetDataList(0, myReceivedLines); 或者更好的是包含代码，因为问题可能在那里......

# java - 在 Eclipse 中查看类层次结构的快捷方式

> ID：12916054
> 
> 赞同：19
> 
> 时间：2012-10-16T13:43:22.333
> 
> 标签：java, eclipse

我有一个查询是我正在使用 eclipse 并且我已经导入了项目，并且像往常一样在一个项目中有 30 到 40 个包，每个包都包含一组类，现在说在名为 AI 的包中有一个名为 abc 的类，稍后子包，假设在名为 W 的包中，我扩展并覆盖了该类（abc）的一些方法并构造了一个名为 def 的新类，它扩展了父类 abc，现在请让我知道我已经打开了父类eclipse 中的 abc 是否有任何快捷方式，我可以通过它找出以后包中的哪些子类覆盖它的方法以及哪些子类正在扩展它..！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-16T13:45:45.340

是：当您的光标在类名上时（如：`public class A|bc`），您可以按`Ctrl+T`查看 的继承层次结构`Abc`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-03T07:45:30.000

如果您按两次 CTRL-T，它将显示超类型层次结构，其中还包括您的类实现的任何接口。偶尔非常有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-15T09:04:21.553

还，

```
Right click on the file in the project explorer -> Open type hierarchy.
Same works for right click on the class name in editor window.
Shortcut is F4. 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-16T13:48:59.020

此外，除了值得`shortcut`发布之外`Aaron`，您还可以这样做：-

> 转到 Windows -> 显示视图 -> 打开大纲视图（如果未找到 - 转到其他）

它将打开一个大纲视图，显示当前类的类层次结构

# php - 在 PHP 中读取 XML

> ID：12916055
> 
> 赞同：-3
> 
> 时间：2012-10-16T13:43:26.677
> 
> 标签：php, xml-parsing

我正在尝试使用 simplexml_load_file 读取 XML。以下是我的 XML：

```
<map_style>
    <background_color>FFFFFF</background_color>         

    <state_color>c5d577</state_color>
    <label_color>212121</label_color>

    <state_hover_color>AECE13</state_hover_color>
    <label_hover_color>FFFFFF</label_hover_color>

    <state_inactive_color>dbe99c</state_inactive_color>
    <label_inactive_color>212121</label_inactive_color>

    <stroke_color>AECE13</stroke_color>

    <lake_color>ffffff</lake_color>
    <lake_stroke_color>ffffff</lake_stroke_color>

    <other_color>FFFFFF</other_color>
    <other_stroke_color>FFFFFF</other_stroke_color>
</map_style>

<!------for map on home page---------------->
<mapstyle_home mapOutlineColor="c2da78" mapRollOverColor="AECE13" mapGradientColor="AECE13"></mapstyle_home>

<!------for featured properties settings---------------->
<featured_property_style>
    <layout width="203" height="182" background="#FFFFFF" imageBackground="#aec565" showGrid="1" autoPlayDefault="1" />
    <buttons navigationDots="1" playPause="1" />
    <text option="1" />
<featured_property_style> 
```

我可以阅读 XML 直到`</map_style>`. 但是，只要我添加：

```
<!------for map on home page---------------->
<mapstyle_home mapOutlineColor="c2da78" mapRollOverColor="AECE13" mapGradientColor="AECE13"></mapstyle_home>

<!------for featured properties settings---------------->
<featured_property_style>
    <layout width="203" height="182" background="#FFFFFF" imageBackground="#aec565" showGrid="1" autoPlayDefault="1" />
    <buttons navigationDots="1" playPause="1" />
    <text option="1" />
<featured_property_style> 
```

并尝试读取 XML，然后它会给出错误。

以下是我的代码：

```
$xml = simplexml_load_file($strCurlUrl);

    //$xml = new SimpleXMLElement($strCurlUrl);

    //echo $xml->getName() . "<br />";
    $this->m_arrXml = array();
    foreach($xml->children() as $child)
    {
      //echo $child->getName() . ": " . $child . "<br />";
      $this->m_arrXml[$child->getName()] = $child;

    } 
```

`$strCurlUrl`上面的xml文件在哪里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T13:47:20.527

看起来您的 XML 无效。XML 总是需要一个根节点！在您的示例中，其中有三个...

# windows - 查询过去两周的windows事件日志

> ID：12916060
> 
> 赞同：10
> 
> 时间：2012-10-16T13:43:38.837
> 
> 标签：windows, windows-7, cmd, windows-server-2008-r2, event-log

我正在尝试导出 Windows 事件日志，但不是根据数量而是根据记录事件的时间来限制导出的事件。我正在尝试在 Windows 7 及更高版本上执行此操作。到目前为止，我的工作重点是使用 wevtutil。

我正在使用 wevtutil，我的命令行现在是：`wevtutil Application events.evtx`这里的问题是我导出了整个日志，这可能非常大，所以我想将它限制在最后 2 周。

我找到[了这篇](http://www.networksteve.com/windows/topic.php/Wevtutil_command_options_for_Date/?TopicId=47201&Posts=1)文章，但首先它似乎没有在我的系统上产生任何输出（是的，我已经更改了日期和时间），其次它似乎取决于我试图避免的日期格式。

这是我运行的修改后的命令：

```
wevtutil qe Application "/q:*[System[TimeCreated[@SystemTime>='2012-10-02T00:00:00' and @SystemTime<'2012-10-17T00:00:00']]]" /f:text 
```

我不得不用实际的符号替换`&lt;`and`&gt;`否则会出现语法错误。此命令产生空输出。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-11T07:40:29.933

问题是由于 /q: 在引号内。它应该在外面，例如：

```
wevtutil qe Application /q:"*[System[TimeCreated[@SystemTime>='2012-10-02T00:00:00' and @SystemTime<'2012-10-17T00:00:00']]]" /f:text 
```

这对我来说很好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-03-07T19:29:21.973

对于过去 2 周的事件，您还可以使用`timediff`, 来避免硬编码日期。

Windows 使用毫秒，因此它将是 1000 * 86400（秒，= 1 天）* 14（天）= 1209600000。

对于您的查询，这看起来像

```
wevtutil qe Application /q:"*[System[TimeCreated[timediff(@SystemTime) <= 1209600000]]]" /f:text /c:1 
```

我`/c:1`在示例中添加了仅获取​​ 1 个事件，因为过去 2 周有很多事件。

您可能还只想列出警告和错误。为此，您可以使用`(Level=2 or Level=3)`. （由于某种原因，`Level<4`在 Win7 上似乎对我不起作用）

```
wevtutil qe Application /q:"*[System[(Level=2 or Level=3) and TimeCreated[timediff(@SystemTime) <= 1209600000]]]" /f:text /c:1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T17:45:24.463

我强烈建议[`LogParser`](http://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx)用于此类任务：

```
logparser -i:evt file:query.sql 
```

包含`query.sql`这样的内容：

```
SELECT
  TimeGenerated,EventID,SourceName,Message
FROM Application
WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()), 1209600))
ORDER BY TimeGenerated DESC 
```

有点不直观的日期计算将系统时间 ( `SYSTEM_TIMESTAMP()`) 转换为整数 ( `TO_INT()`)，减去 1209600 秒 (60 * 60 * 24 * 14 = 2 周) 并将结果转换回时间戳 ( `TO_TIMESTAMP()`)，从而从 2 周生成日期前。

您可以通过将固定的秒数替换为`MUL(86400, $days)`并将命令行更改为以下方式来参数化时间跨度：

```
logparser -i:evt file:query.sql+days=14 
```

您还可以将查询直接传递给 logparser：

```
logparser -i:evt "SELECT TimeGenerate,EventID,SourceName,Message FROM ..." 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T17:54:34.140

我不知道您对 PowerShell 的看法，但它在您标记的所有系统上都可用。

在 powershell 提示符下，请参阅 Get-Help Get-EventLog -Examples 了解更多信息。

如果您必须从 .cmd 或 .bat 文件执行此操作，则可以调用 powershell.exe -File powershell_script_file_name

其中 powershell_script_file_name 包含您需要的 Get-EventLog 命令。

这个例子给出了所有的安全事件日志失败，我用它来审计系统：

```
Get-EventLog -LogName security -newest 1000 | where {$_.entryType -match "Failure"} 
```

# c# - 如何将枚举的整数输出转换为两个字符串？

> ID：12916061
> 
> 赞同：2
> 
> 时间：2012-10-16T13:43:39.170
> 
> 标签：c#

对于以下枚举：

```
public enum ContentKey {
    Menu = 0,
    Article = 1,
    FavoritesList = 2
}; 
```

枚举 ContentKey 返回一个整数 0,1,2。如何转换或转换它以使其返回两位数的零填充字符串“00”、“01”..“99”等

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T13:45:26.957

当你打电话时，`ToString`你可以使用格式字符串`"00"`来确保你得到至少两位数：

```
string result = ((int)contentKey).ToString("00"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-16T13:46:51.663

```
 String.Format("{0:00}", (int)<youEnum>), 
```

对于枚举，您只需要这样做

```
public enum ContentKey {
Menu = 0,
Article,
FavoritesList 
```

};

它会自动为您设置值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T13:46:20.037

我不相信你可以用 0 填充 int 。

但是，如果您想使用字符串来执行此操作，则可以使用：

```
string text = value.ToString("00"); 
```

# android - 在android中创建AlertBox的方法有问题

> ID：12916063
> 
> 赞同：0
> 
> 时间：2012-10-16T13:43:45.350
> 
> 标签：android, dialog, android-alertdialog

我想创建一个包含一个文本框和两个按钮的警报框。我为此创建了一个布局，其中包含一个`EditText`并创建了一个类扩展`DialogFragment`类。我已经创建`onCreateDialog()`并希望将输入从`EditText`数据库发送。我也有数据库处理程序类。我现在想创建一个类的对象，并`show()`在需要对话框出现时使用。

`onCreateDialog()`这种方法是正确的还是如果我在扩展的类中创建而不是像之前的方法那样创建对象会更好`Activity`？

代码片段是：

公共类 AskDialog 扩展 DialogFragment {

```
private String var = "";
EditText ask;

public void setVar(String var){
    this.var = var;
}
@Override
public Dialog onCreateDialog(Bundle savedInstance){

    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
    LayoutInflater inflator = getActivity().getLayoutInflater();

    builder.setView(inflator.inflate(R.layout.ask, null));
    builder.setTitle("Not Found").setMessage("XYZ is not found");
    final EditText ask = new EditText(this); //Error
    builder.setPositiveButton("Save", new OnClickListener(){

        @Override
        public void onClick(DialogInterface arg0, int arg1) {
            // TODO Auto-generated method stub
            String ab = ask.getText().toString();
        }

    });
    builder.setNegativeButton("Don't Know", new OnClickListener(){

        @Override
        public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub

        }

    });

    return null;
} 
```

}

我想通过在 Activity 类中创建一个对象来使用这个类，并使用它的 show(getFragment(), null) 函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:57:51.330

要制作自定义警报框，您可以使用 android 提供的“Layout Inflater”类。要了解有关 Layout inflater 的更多信息，您可以直接查看此链接[http://developer.android.com/reference/android/view/LayoutInflater.html](http://developer.android.com/reference/android/view/LayoutInflater.html)

我认为这段代码将帮助您构建一个带有编辑字段和按钮的自定义警报框。

```
LayoutInflater inflater =(LayoutInflater)Yourclass.this.getSystemService
(Context.LAYOUT_INFLATER_SERVICE);
addNotes = (LinearLayout) inflater.inflate(R.layout.ask, null);

final Button positiveButton = (Button) addNotes.findViewById(R.id.btn_positive);

final EditText et_ask=(EditText)addNotes.findViewById(R.id.et_ask);

positiveButton.setOnClickListener(new View.OnClickListener() {
public void onClick(View v) {

String ab = et_ask.getText().toString();

addNotes.setVisibility(View.GONE);

}
});

LayoutParams params = new  LayoutParams(LayoutParams.FILL_PARENT,
LayoutParams.FILL_PARENT);
Yourclass.this.addContentView(addNotes,params);
addNotes.setVisibility(View.VISIBLE); 
```

# zend-framework2 - Zend\Navigation 面包屑找不到活动元素

> ID：12916064
> 
> 赞同：1
> 
> 时间：2012-10-16T13:43:47.020
> 
> 标签：zend-framework2, zend-navigation

我的导航正在运行，所有链接都工作正常。使用渲染导航`$this->navigation($nav)->menu()`将显示一个无序列表，并且所有链接都在工作。

此外，那里的活动链接也在工作。活动元素具有`class="active"`属性。

渲染相同的导航，只是作为一个 bradcrumb`$this->navigation($nav)->breadcrumbs()`不会给我任何东西。这可能是因为我的导航现在只有一层，但我认为第一层仍然应该被渲染。

使用超现代`die()`的调试，我发现什么都没有渲染，因为`findActive()`viewHelper 没有找到活动元素，因此返回一个空字符串。

关于我的错误可能位于何处的任何想法？任何见解将不胜感激。到目前为止，这是我的代码：

```
'navigation' => array(
    'default' => array(
        'biete' => array(
            'label' => 'Biete',
            'route' => 'biete',
        ),
        'suche' => array(
            'label' => 'Suche',
            'route' => 'suche',
        ),
        'administration' => array(
            'label' => 'Administration',
            'route' => 'admin'
        ),
        'dashboard' => array(
            'label' => 'Meine Artikel',
            'route' => 'dashboard'
        ),
        'login' => array(
            'label' => 'Anmelden',
            'route' => 'duituser/login'
        ),
        'logout' => array(
            'label' => 'Abmelden',
            'route' => 'duituser/logout'
        )
    ),
),
'service_manager' => array(
    'factories' => array(
        'translator' => 'Zend\I18n\Translator\TranslatorServiceFactory',
        'navigation' => 'Zend\Navigation\Service\DefaultNavigationFactory',
    ),
), 
```

以及位于我的视图部件`layout.phtml`

```
<?php echo $this->navigation('navigation')->menu(); ?>
<?php echo $this->navigation('navigation')->breadcrumbs(); ?> 
```

再次提前感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T11:09:47.320

我玩了导航类/助手 - 当匹配“游乐场”路线时，似乎会呈现面包屑（在下面的示例中）。但是，通过添加`'active' => true`到我的默认路由意味着它将始终由面包屑助手呈现。

```
'navigation' => array(
     'default' => array(
        'test' => array(
            'label' => 'Home',
            'route' => 'test',
            'active' => true,
            'pages' => array(
                'playground' => array(
                    'label' => 'Playground',
                    'route' => 'playground',
                ),
            ),
        ),
    ),
 ), 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T13:17:02.943

除了 DrBeza 的回答之外，这对我有帮助。问题是面包屑导航只有在我们到达第二级时才会被渲染。但是您显然可以通过调用以下命令来更改该设置：

```
$this->navigation('navigation')->breadcrumbs()->setMinDepth(0); 
```

对我来说，这就是所需要的。然而，正如 DrBeza 指出的那样，在某些情况下，这可能还不够。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T00:57:01.373

就我而言，这仅有助于此：

```
$this->navigation('navigation')->breadcrumbs()->render('navigation'); 
```

奇怪的是，只有在之前调用 $this->navigation('navigation')->menu() 时才需要它，因为没有呈现面包屑。

# list - APC 键列表

> ID：12916078
> 
> 赞同：1
> 
> 时间：2012-10-16T13:44:21.043
> 
> 标签：list, key, apc

我有一个大约 100 万行的 35MB 文件。我将每一行作为键（10-12 个字符）和一个整数作为值加载到 APC。如果我获取大约 80% 的条目不存在，则只有文件末尾的行存在。是否有可能 APC 的内存已满并且第一个条目被新的条目覆盖？

apc.shm_size: 512M

512 Mb 应该足以存储 35MB 文件中的数据，不是吗？

是否有任何可视化工具（WAMP）来查看 APC 的条目列表和内存使用情况？

***编辑***

我对代码进行了一些修改，以查看何时会覆盖第一个条目。大约是第 220.000 行。此外，我将 apc.shm_size 增加到 1024M。并且行数增加了2倍。为什么我需要超过 2GB 才能在内存中存储 35MB 数据？

如果我将 apc.shm_size 从 1024M 增加到 1025，Apache 将无法启动。

# c# - 无法在 LINQ to Entities 查询中构造实体或复杂类型“ ”

> ID：12916080
> 
> 赞同：29
> 
> 时间：2012-10-16T13:44:25.460
> 
> 标签：c#, linq-to-entities

> **可能重复：**
> [无法在 LINQ to Entities 查询中构造实体](https://stackoverflow.com/questions/5325797/the-entity-cannot-be-constructed-in-a-linq-to-entities-query)

```
 var tasks = from i in data.Incidents
                    join a in data.Accounts on i.CustomerID equals a.Acct_CID
                    select new Tasks()
                    {

                        creator_id = a.ID,
                        start_date = i.DateOpened,
                        end_date = i.DateCLosed,
                        product_code = i.ProductCode,
                        install_type = i.InstallType,
                        os = i.OSType,
                        details = i.Description,
                        solution = i.Solution,
                        creator_name = i.TechID,
                        category = i.Title,
                        text = "Ticket for" + " " + i.Name,
                        status_id = 7
                    };

        foreach (var task in tasks)
            data.Tasks.Add(task);
        data.SaveChanges();

 public class Incidents
    {
        [Key]
        public int IncidentID { get; set; }
        public string CustomerID { get; set; }
        public string ProductCode { get; set; }
        public string TechID { get; set; }
        public DateTime DateOpened { get; set; }
        public DateTime DateCLosed { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public string Solution { get; set; }
        public string Name { get; set; }
        public string OSType{ get; set; }
        public string InstallType { get; set; }
        public string AddOnSoftware { get; set; }
        public string ScreenShare { get; set; }
    } 
```

当我尝试迭代时给我一个错误，我希望得到一些帮助

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-10-16T13:51:49.083

在 Linq-to-Entities 中，您只能投影到匿名类型或常规类。您不能投影到现有的实体类型。你可以像这样使用 linq-to-objects

```
var tasks = (from i in data.Incidents
            join a in data.Accounts on i.CustomerID equals a.Acct_CID
             select new
             {
               creator_id = a.ID,
               start_date = i.DateOpened,
               end_date = i.DateCLosed
              // ...
             }).AsEnumerable().Select(x => new Tasks {
               creator_id = x.creator_id,
               start_date = x.start_date,
               end_date = x.end_date              
             }).ToList(); 
```

# algorithm - 热门在网格上找到最近的自由点

> ID：12916082
> 
> 赞同：1
> 
> 时间：2012-10-16T13:44:26.780
> 
> 标签：algorithm, matrix, geometry, grid-layout

想象一个简单的二维网格；网格上的对象可以占据一个以上的单元格（但点始终是连接的）。考虑以下示例，其中我使用字母`A`并`B`仅用于区分对象（这很有用，因为对象可能彼此靠近放置）：

```
0 1 2 3 4 5 6 7 8 9 10
1 . . . . . . . . . .
2 . . . . . . . . . .
3 . . . A . . . . . .
4 . . A A A . . B B .
5 . . . A . . . B B .
6 . . . . . . . . . . 
```

我需要一种插入新对象的算法，将它们定位在网格上并确保它们不重叠。因此，如果我想嵌入一个新对象（用 表示`C`）并且它的任何单元格的坐标已经被占用，算法应该找到最近的空闲区域（即点列表）来分配新对象。让我们尝试将对象 C 插入到`(4, 3)`已被来自的单元格占据的坐标处`A`：

```
0 1 2 3 4 5 6 7 8 9 10
1 . . . . . . . . . .
2 . C C . . . . . . .
3 . C C A . . . . . .
4 . . A A A . . B B .
5 . . . A . . . B B .
6 . . . . . . . . . . 
```

如您所见，对象被移动以适合对象附近`A`。我假设搜索应该从占用的单元格开始，顺序为（按方向给出）：N、E、S、W，然后在中间方向：NE、SE 等。

你建议如何实现这个算法？

**更新**：对象位置是左上角。并且*最近*点是从初始请求位置与周围自由点之间评估的距离获得的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:10:52.970

您想按距离增加的顺序迭代可能的位移（即移位）。由于所有位移都是整数，所以位移的平方需要是[两个平方的和](http://oeis.org/A001481)。以下 python 代码跟踪每个*x位移的下一个可能的**y*位移。它生成对列表。每对表示位移坐标。单个列表中的所有元素与原点的距离相同，而后面列表中的元素将具有更大的距离。因此，至少在距离方面，遍历内部列表的顺序无关紧要。你甚至可能想要随机化这些。

 *```
def iter_distance(maxr = 10):
    r = 0
    d = [0]
    while r <= maxr:
        m = maxr*maxr + 1
        for x, y in enumerate(d):
            sq = x*x + y*y
            if sq < m:
                m = sq
                b = []
            if sq == m:
                b.append((x, y))
        for x, y in b:
            d[x] = y + 1
        if b[-1][0] == r:
            r += 1
            d.append(0)
        yield (b +
               [(x, -y) for x, y in b if y] +
               [(-x, y) for x, y in b if x] +
               [(-x, -y) for x, y in b if x*y])

for lst in iter_distance():
    marker = '*'
    for x, y in lst:
        print("{:5} {:5} {:10} {}".format(x, y, x*x + y*y, marker))
        marker = ' ' 
```

输出的第一行如下所示：

```
 0     0          0 *
    0     1          1 *
    1     0          1  
    0    -1          1  
   -1     0          1  
    1     1          2 *
    1    -1          2  
   -1     1          2  
   -1    -1          2  
    0     2          4 *
    2     0          4  
    0    -2          4  
   -2     0          4  
    1     2          5 *
    2     1          5  
    1    -2          5  
    2    -1          5  
   -1     2          5  
   -2     1          5  
   -1    -2          5  
   -2    -1          5  
    2     2          8 *
    2    -2          8  
   -2     2          8  
   -2    -2          8  
    0     3          9 *
    3     0          9  
    0    -3          9  
   -3     0          9 
```

对于高达 400 的距离（即传递 400 作为`maxr`参数），您将获得 37,556 个不同距离的 502,625 行，因此您希望动态生成这些，而不是将它们硬编码到应用程序中。但是，您可以使用这些数字来检查您的实施，以防我们中的一个人出错。

如果你关心性能，你可以使用优先级队列而不是数组，这样写：

```
#include <queue>
#include <utility>
#include <cmath>
#include <iostream>
#include <iomanip>

class displacement {
private:
  int _d;
  int _x;
  int _y;
public:
  displacement() : _d(0), _x(0), _y(0) {}
  displacement(int x, int y) : _d(x*x + y*y), _x(x), _y(y) {}
  int x() const { return _x; }
  int y() const { return _y; }
  int sqd() const { return _d; }
  bool operator<(const displacement& d) const { return sqd() > d.sqd(); }
};

static void print2(int x, int y, int sqd) {
  std::cout << std::setw(10) << x << ' '
            << std::setw(10) << y << ' '
            << std::setw(20) << sqd << ' '
            << std::endl;
}

static void print1(int x, int y, int sqd) {
  print2(x, y, sqd);
  if (y)
    print2(x, -y, sqd);
  if (x) {
    print2(-x, y, sqd);
    if (y)
      print2(-x, -y, sqd);
  }
}

int main(int argc, char** argv) {
  int maxr = 400;
  int maxrsq = maxr*maxr;
  std::priority_queue<displacement> q;
  q.push(displacement(0, 0));
  while (q.top().sqd() <= maxrsq) {
    const displacement& d = q.top();
    int x = d.x();
    int y = d.y();
    int sqd = d.sqd();
    print1(x, y, sqd);
    q.pop();
    q.push(displacement(x, y + 1));
    if (x == y) {
      q.push(displacement(x + 1, y + 1));
    }
    else {
      print1(y, x, sqd);
    }
  }
} 
```

在这种情况下，队列包含单个位移，结果将以任意（可能是实现定义的）顺序打印相同距离的单个位移，而不会将它们收集到列表中。只有给定位移的镜像才会立即打印。这里的代码采用了完全的 8 重对称，因此任何一次存储在队列中的元素数量甚至比目前生成的最大距离还要少，除了最开始的时候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T17:13:27.503

我想你有一个检查对象重叠的方法，所以我将定义一个封装孔平面及其已放置对象的对象：如果你要放置的对象与任何对象重叠，则使用返回 true`Plane`的实例方法当您将其放入平面时或如果它不适合平面，例如当对象大于单个点时将其放置在平面的右下边缘时。`boolean overlaps(Object2D object, Point position)``Object2D``position`

正如@MvG 指出的那样，只有整数点，所以可能的距离数量有限，所以我会为点之间的距离做一个查找表，以这种方式加快处理速度（我假设是 Java）：

```
 // creates a lookup table with the possible offsets for each possible distance
    static Hashtable<Integer, List<Point>> createLookupPointOffsets(int gridWidth, int gridHeight)
    {
        Hashtable<Integer, List<Point>> l = new Hashtable<Integer, List<Point>>();
        for (int i = 0; i <= gridWidth; i++)
        {
            int i2 = i * i;
            for (int j = 0; j <= gridHeight; j++)
            {
                int sqrDistance = i2 + j * j; // distance^2
                List<Point> ps = l.get(sqrDistance);
                if (ps == null)
                {
                    ps = new List<Point>();
                    l.put(sqrDistance, ps);
                }
                ps.add(new Point(i, j));
            }
        }
    } 
```

这样，您将获得可能距离的 1/4 偏移量，对于其他距离，您只需通过 x 或 y 或两个轴反映点。为了评估使用此索引偏移量放置对象的最接近点，请将此方法添加到 中`Plane`，我假设变量`mIndexedOffsets`已使用最后一个方法的结果进行初始化：

```
 // returns true if placed the object
    boolean place(Object2D object, Point position)
    {
        if (overlaps(object, position))
        {
            Integer[] distances = new Integer[mIndexedOffsets.keySet().size()];
            distances = mIndexedOffsets.keySet().ToArray(distances);
            // sort the keys in crescent order
            for (int k = 0; k < distances.length - 1; k++)
            {
                for (int l = k + 1; l < distances.length; l++)
                {
                    if (distances[k] > distances[l])
                    {
                        int t = distances[k];
                        distances[k] = distances[l];
                        distances[l] = t;
                    }
                }
            }
            for (int i = 0; i < distances.length; i++)
            {
                List<Point> ps = mIndexedOffsets.get(distances[i]);
                for (int j = 0; j < ps.size(); j++)
                {
                    Point p = ps.get(j);
                    Point newPoint = (Point) position.clone();
                    newPoint.x += p.x;
                    newPoint.y += p.y;
                    if (!overlaps(object, newPoint)
                    {
                        put(object, newPoint);
                        return true;
                    }
                    // test with the reflected points
                    newPoint = (Point) position.clone();
                    newPoint.x -= p.x;
                    newPoint.y += p.y;
                    if (!overlaps(object, newPoint)
                    {
                        put(object, newPoint);
                        return true;
                    }
                    newPoint = (Point) position.clone();
                    newPoint.x += p.x;
                    newPoint.y -= p.y;
                    if (!overlaps(object, newPoint)
                    {
                        put(object, newPoint);
                        return true;
                    }
                    newPoint = (Point) position.clone();
                    newPoint.x -= p.x;
                    newPoint.y -= p.y;
                    if (!overlaps(object, newPoint)
                    {
                        put(object, newPoint);
                        return true;
                    }
                }
            }
        }
        else
        {
            put(object, position); // puts the object in the desired position
            return true;
        }
        return false;
    } 
```

希望能帮助到你。*

# android - Android：每 1 分钟更新一次 ListView 项目

> ID：12916084
> 
> 赞同：9
> 
> 时间：2012-10-16T13:44:31.603
> 
> 标签：android, listview

我的应用程序中有一个自定义 ListView，其中包含一个 ImageView 和 3-5 个 TextView。

**TextViews 中的 1 个显示当前时间**与为该 ListView 项**指定**的时间之间的时间间隔。

喜欢：*发表于 5 分钟前*

问题是，我怎样才能在不干扰 ListView 的情况下每分钟更新这个 TextView。

喜欢：*如果我正在查看 ListView 5 分钟，则仅此 TextView 必须从 1 分钟更改为 2 分钟，依此类推，每个可见项目*

**我尝试了什么：**

1.  **在getView()**中设置这个 TextView使用`System.currentTimeMillis() - givenTime[position];`

但是如果我不滚动（不调用 getView）或更改项目的可见性，这里的 TextView 将不会得到更新。

1.  每 1 分钟使用一次**timeTask()**线程并尝试更新每个项目的 TextView

这里的问题是我得到一个例外：

```
android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. 
```

此外，我不知道如何更改 Activity 中每个 ListView 项目的 TextView。

但这似乎是一个熟悉的案例。

我怎样才能做到这一点？

谢谢你

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-16T13:50:23.060

使用 a`Handler`及其`postDelayed`方法使列表的适配器无效，如下所示：

```
final Handler handler = new Handler()
handler.postDelayed( new Runnable() {

    @Override
    public void run() {
        adapter.notifyDataSetChanged();
        handler.postDelayed( this, 60 * 1000 );
    }
}, 60 * 1000 ); 
```

您只能在主 (UI) 线程中更新 UI。

通过在主线程中创建处理程序，您可以确保发布到处理程序的所有内容也在主线程中运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-30T12:24:09.320

您还可以创建自定义`TextView`，它每秒或每分钟或每小时更新一次。这可以通过创建扩展`TextView`并在该类中添加 Handler 的类来轻松完成。好处是您不必更新整个 ListView，TextView 会自动更新。

例子：

```
public class TextViewTimeCounter extends TextView {
private long mStartTime = 0;
private long mTimeNow = 0;
private int mDelay = 0;
private String mPart1 = "";
private String mPart2 = "";

private Handler mHandler;

public TextViewTimeCounter(Context context) {
    super(context, null, 0);
}

public TextViewTimeCounter(Context context, AttributeSet attrs) {
    this(context, attrs, 0);
}

public TextViewTimeCounter(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

public void startTimer(long delay, String part1, String part2){
    mStartTime = System.currentTimeMillis();
    mTimeNow = System.currentTimeMillis();
    mDelay = delay;
    mHandler = new Handler();
    mHandler.postDelayed(r, delay);
    convertDatesToMinutes(mStartTime, mTimeNow);
}

public void stopTimer(){
    if(mHandler != null){
        mHandler = null;
        mStartTime = 0;
        mTimeNow = 0;
    }
}

public boolean isTimerRunning(){
    return mHandler == null? false : true;
}

Runnable r = new Runnable() {
    @Override
    public void run(){
        mTimeNow += mDelay;
        convertDatesToMinutes(mStartTime, mTimeNow);
        if(mHandler != null){
            mHandler.postDelayed(r, mDelay);
        }
    }
};

public void convertDatesToMinutes(long start, long end){
    long secs = (end - start);
    long minute = (secs / (1000 * 60)) % 60;
    long hour = (secs / (1000 * 60 * 60)) % 24;
    String time = String.format(Locale.getDefault(), "%2d hours %2d minutes", hour, minute);

    setText(mPart1 + time + mPart2);
} 
```

用法：

```
TextViewTimeCounter timer = (TextViewTimeCounter)convertView.findViewById(R.id.start_logging_time_text);
timer.startTimer(10000, "Posted ", " ago"); 
```

输出将如下所示：

```
 Posted 1 hours 5 minutes ago 
```

如果您还想显示秒数，请将`convertDatesToMinutes(long start, long end)`方法更改为：

```
public void convertDatesToMinutes(long start, long end){
        long secs = (end - start);
        long second = (secs / 1000) % 60;
        long minute = (secs / (1000 * 60)) % 60;
        long hour = (secs / (1000 * 60 * 60)) % 24;
        String time = String.format(Locale.getDefault(), "%2d hours %2d minutes %2d seconds", hour, minute, second);
        setText(mPart1 + time + mPart2);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-07T14:47:54.097

使用内置的 TimerTask

[http://developer.android.com/reference/java/util/TimerTask.html](http://developer.android.com/reference/java/util/TimerTask.html)

这是一种可靠的做事方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-21T16:37:04.213

如果你想在主线程中重复一个动作，你应该使用 Time.class 的“schedule”方法

```
mHandler = new Handler();
mTimer = new Timer();
mTimer.schedule(new TimerTask() {
    @Override
    public void run() {
        mHandler.post(new Runnable() {
            @Override
            public void run() {
                // run main thread code
            }
        });
    }
}, DELAY_TIME, PERIOD_TIME); 
```

# c# - 在需要特殊字符的密码中是否有我不应该支持的特殊字符？(WebMatrix C#)

> ID：12916085
> 
> 赞同：3
> 
> 时间：2012-10-16T13:44:37.520
> 
> 标签：c#, validation, passwords, webmatrix

我有一个需要特殊字符的密码，并且想知道是否有任何我不应该支持的特殊字符，例如“=”或“`”或“>”等。

这是我到目前为止所拥有的：

```
 if(c!='!' && c!='@' && c!='#' && c!='$' && c!='%' && c!='^' && c!='&' && c!='*' && c!='(' && c!=')' && c!='-' && c!='_' && c!='+' && c!='=' && c!='~')
        {
            Scount++;
            if(Scount >= password.Length)
            {
                errorMessage = "Your password must contain at least one special character.";
            }
        } 
```

好的，我想我知道我不想支持尖括号，但是有没有像大多数网站支持的标准特殊字符集，或者我绝对应该远离的字符（除了尖括号，那些可能会出错WebMatrix 验证器在很多情况下）。

请不要评论我没有使用正则表达式来检查模式。我知道这一点，我不在乎。这是对我有用的第一件事，所以这就是我要做的。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:51:49.327

自从我在 XKCD 上看到这个关于密码强度的优秀[卡通片](http://xkcd.com/936/)以来，任何强迫我使用大写或小写字符、数字或字母的网站......这让我很生气。唯一应该检查您的网站应该是检查密码的长度。

如果人们想输入 0bscur€ 密码很好，但不要强迫他们。

# java - 为什么服务器上的 Multiform-Upload-Request 为空？

> ID：12916086
> 
> 赞同：0
> 
> 时间：2012-10-16T13:44:47.560
> 
> 标签：java, php, http, file-upload

我正在尝试通过 URLConnection 和 multipart/form-data 上传文件并发布一些变量。但是服务器上的请求是空的。

我已经编写了一个非常基本的 PHP 脚本来制作解决方案的原型。目前代码如下所示：

```
$uploaddir = './uploads/';
$uploadfile = $uploaddir . basename($_FILES['file1']['name']);

if(move_uploaded_file($_FILES['file1']['tmp_name'], $uploadfile)) {
  echo 'success ' . $_POST['input1'] . ' ' . $_POST['input2'];
} else {
  echo 'error ';
  var_dump($_FILES);
  echo ' ';
  var_dump($_POST);
} 
```

我的 Java 测试代码如下所示：

```
 URL url = new URL(DEST_URL);
    String boundary = "---------------------" + Long.toString(System.currentTimeMillis());
    PrintWriter writer = null;
    URLConnection con = url.openConnection();

    con.setDoInput(true);
    con.setDoOutput(true);
    con.setRequestProperty("Content-Type", "multipart/form-data; boundary=" + boundary);
    OutputStream output = con.getOutputStream();
    InputStream input = new FileInputStream(new File(FILE_PATH));
    writer = new PrintWriter(new OutputStreamWriter(output));

    writer.println(boundary);
    writer.println("Content-Disposition: form-data; name=\"input1\"");
    writer.println();
    writer.println("1234");

    writer.flush();

    writer.println(boundary);
    writer.println("Content-Disposition: form-data; name=\"input1\"");
    writer.println();
    writer.println("asdf");

    writer.flush();

    writer.println(boundary);
    writer.println("Content-Disposition: form-data; name=\"file1\"; filename=\"clicknpoint.png\"");
    writer.println("Content-Type: image/png");

    writer.flush();

    int length = 0;
    byte[] buffer = new byte[1024];

    for(length = 0; (length = input.read(buffer)) > 0;) {
        output.write(buffer, 0, length);
    }
    input.close();

    writer.println();
    writer.println(boundary);

    writer.flush();

    input = con.getInputStream();
    BufferedReader reader = new BufferedReader(new InputStreamReader(input));

    String cur = null;
    StringBuffer buf = new StringBuffer();

    while((cur = reader.readLine()) != null) {
        buf.append(cur);
    }

    System.out.println(buf.toString());

    Assert.assertTrue(buf.toString().startsWith("success")); 
```

测试用例失败并打印

```
 error array(0) {} array(0) {} 
```

我已经用wireshark检查了请求。这就是发送的内容：

```
POST /test/upload.php HTTP/1.1
Content-Type: multipart/form-data; boundary=---------------------1350394409130
User-Agent: Java/1.6.0_33
Host: localhost
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
Content-Length: 94528

---------------------1350394409130
Content-Disposition: form-data; name="input1"

1234
---------------------1350394409130
Content-Disposition: form-data; name="input1"

asdf
---------------------1350394409130
Content-Disposition: form-data; name="file1"; filename="clicknpoint.png"
Content-Type: image/png
.PNG
.
...
IHDR..............d<.....sRGB.........gAMA......a.....pHYs..........o.d....IDATx^..}.FWy......c,UU.....|.($. .B1..4%..(MC. ...(..j..."<.I.dD.&.DD.&q..Y....P..\..v.!..k...1v....m. // and so on 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T13:27:44.167

问题是边界无效。边界必须以额外的“--”开头，请求必须以“--”+边界+“--”在它自己的行中结束。

这里就没有了。

# android - Android SDK - 为不同视图元素的相同属性创建一个“类”

> ID：12916087
> 
> 赞同：0
> 
> 时间：2012-10-16T13:44:52.260
> 
> 标签：android, android-layout, android-view

我在布局 XML 中定义了一个标题和一个基本的`TextView`. 我在整个应用程序中经常使用这些元素。到目前为止，我只是复制并粘贴了每一个`TextView`，但我想必须有一种方法可以创建一个“类”，就像`CSS`我可以定义属性的切割集一样，即标题元素。

有什么想法可以将它们存储到类或其他东西中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T13:51:58.670

听起来您正在寻找[样式](http://developer.android.com/guide/topics/ui/themes.html)。

文本视图实现

```
<TextView
    style="@style/CodeFont"
    android:text="@string/hello" /> 
```

res/values/styles.xml

```
<resources>
    <style name="CodeFont" parent="@android:style/TextAppearance.Medium">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:textColor">#00FF00</item>
        <item name="android:typeface">monospace</item>
    </style>
</resources> 
```

# jsf - Escape false 在 primefaces 中不起作用？

> ID：12916090
> 
> 赞同：0
> 
> 时间：2012-10-16T13:45:04.687
> 
> 标签：jsf, primefaces

我使用的是 primefaces 3.2，我已经使用`escape=false`来`outputText`显示输出。这对我不起作用。

```
val = "<ol><li>sfsfsd</li><li>fgsdsdg</li></ol>"
<h:outputText escape="false" value="#{dummyBean.val}" /> 
```

它不显示数字，而是显示一个点 (.)。

我得到的输出如下：

```
. sfsfsd
. fgsdsdg 
```

但预期的输出是：

```
 1.sfsfsd
 2.fgsdsdg 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:13:37.063

一个奇怪的想法：如果 html 确实被转义了，但是你有一些样式问题，它隐藏了点之前的数字。我会尝试在打印列表中添加一些左填充

```
<ol style="padding-left: 100px;">
    <li>First</li>
    <li>Second</li>
</ol> 
```

或跨度本身

```
<h:outputText escape="false" value="#{dummyBean.val}" style="padding-left: 100px;"/> 
```

看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:16:54.967

您正在寻找的只是一种不同的方式来设置有序列表的样式。

你只需要添加这个样式

```
ol {
    list-style-type: decimal;
} 
```

# c# - 项目动态 Dapper 结果不包括某些属性

> ID：12916091
> 
> 赞同：1
> 
> 时间：2012-10-16T13:45:08.433
> 
> 标签：c#, linq, dapper

给定一个动态的 Dapper 查询，例如：

```
var results = connection.Query<dynamic>("SELECT ...."); 
```

我想从结果中删除几个返回的列/属性。诀窍是我想在不知道/关心我要保留的属性的名称的情况下执行此操作，否则我只会将结果投影到一个新的匿名类型中。

我试图遍历结果并将每个结果转换为一个`IDictionary<string, object>`，以便我可以简单地删除保存数据的键/值对。不幸的是，无论出于何种原因，底层的内部 FastExpando 对象都没有实现 Remove 方法。[FastExpando 的源代码](https://github.com/SamSaffron/dapper-dot-net/blob/master/Dapper/SqlMapper.cs#L1303)显示：

```
bool IDictionary<string, object>.Remove(string key)
{
    throw new NotImplementedException();
} 
```

我该如何实施？要清楚，我基本上想要：

```
var filteredResults = from r in results
                      select new { // All properties except a couple of well-known ones } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T06:54:23.547

如果你迭代`FastExpandoObject`并返回一个过滤器`ExpandoObject`怎么办？

```
 var filteredResults = dynamicResult.Select<dynamic, dynamic>(x =>
                    {
                        var filteredRow = new ExpandoObject() as IDictionary<string, Object>;
                        var props = x as IDictionary<string, object>;
                        foreach (var prop in props)
                        {
                            if (!filter.Contains(prop.Key))
                                filteredRow.Add(prop);
                        }
                        return filteredRow;
                    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-18T06:13:59.627

没有理由`FastExpandoObject`不实现这些方法，除了：它不需要。我现在已经填写了所有缺少的 /`NotImplementedException`方法。我还没有部署到 NuGet，但是 github/google-code 上的代码已经更新了。

# ios - 自 iOS6 以来，GLKTexture 未正确映射

> ID：12916092
> 
> 赞同：19
> 
> 时间：2012-10-16T13:45:08.993
> 
> 标签：ios, opengl-es, opengl-es-2.0, shader, glkit

从 Xcode 4.5 和 iOS 6 SDK 开始，在我的 3D 对象上使用纹理时，我遇到了一个奇怪的行为。在针对 OS X 10.8 SDK 构建时，我的 mac 应用程序也出现了该问题。

我在 iOS 上使用 OpenGL ES 2.0，在 OS X 10.8 上使用 OpenGL 旧配置文件 (< 3.0)。

纹理不再放置在正确的坐标处，并且我有很多工件。VAO 已正确上传，它们看起来不错，没有纹理。使用 XCode 4.4.1 和 iOS 5.1 SDK 时一切正常。

VAO 完全相同（通过 OpenGL ES 帧捕获检查），并且纹理制服也正确绑定。

* * *

**Xcode 4.4 VAO 概述**

![Xcode 4.4](../Images/9cc4250a5cca5cf5cf32da0daa8fa870.png)

**Xcode 4.5 VAO 概述**

![Xcode 4.5](../Images/bacf3fe16bd573b7c31012eb9956bbd5.png)

**XCode 4.4.1 (iOS 5.1 SDK)**

![iOS 模拟器 5.1 SDK](../Images/c0ec3285c2ceff534ee3aad1cf5af619.png)

**XCode 4.5 (iOS 6 SDK)**

![iOS 模拟器 6.0 SDK](../Images/63d12789574734fafd582b82fc226b7b.png)

* * *

**代码/着色器片段**

*用于上传和处理纹理的相关部分。我不得不将着色器剥离到最小。*

**顶点着色器**

```
precision highp float;
attribute vec2 a_vTextureCoordinate;
uniform mat4 u_mModelViewMatrix;
uniform mat4 u_mModelViewMatrixInverse;
uniform mat4 u_mProjectionMatrix;
uniform mat4 u_mNormalMatrix;
void main()
{
....

    // Transform output position 
    gl_Position = u_mProjectionMatrix * u_mModelViewMatrix * a_vPosition;
    // Pass through texture coordinate v_texcoord = a_vTextureCoordinate.xy;
    v_vPosition = vec3(u_mModelViewMatrix * a_vPosition);
    v_vTextureCoordinate = a_vTextureCoordinate.xy;
    ....
} 
```

**片段着色器**

```
precision highp float;
// location 1
uniform sampler2D u_diffuseTexture;
varying vec2 v_vTextureCoordinate;
varying vec3 v_vPosition;
....
void main() {
    ....
    vec4 base = texture2D(u_diffuseTexture, v_vTextureCoordinate);
    gl_FragColor = base;
    ....
} 
```

**纹理加载**

```
 NSDictionary *options = @{GLKTextureLoaderOriginBottomLeft: @(YES), [NSNumber numberWithBool:YES] : GLKTextureLoaderGenerateMipmaps};
    NSError *error;
    path = [path stringByReplacingOccurrencesOfString:@"/" withString:@""];
    path = [[NSBundle mainBundle] pathForResource:[path stringByDeletingPathExtension] ofType:[path pathExtension]];
    GLKTextureInfo *texture = [GLKTextureLoader textureWithContentsOfFile:path options:options error:&error]; 
```

**渲染循环（仅发送活动纹理的制服）**

```
....
    [self setShaderTexture:[[materials objectForKey:@"diffuse"] objectForKey:@"glktexture"]
                    forKey:@"u_diffuseTexture"
             withUniform1i:0
            andTextureUnit:GL_TEXTURE0+0];
....

#pragma mark - Texture communication

-(void)setShaderTexture:(GLKTextureInfo*)texture forKey:(NSString*)key withUniform1i:(int32_t)uniform andTextureUnit:(int32_t)unit {
    glActiveTexture(unit);
    glBindTexture(texture.target, texture.name);
    [self.shaderManager sendUniform1Int:key parameter:uniform];
} 
```

* * *

自 iOS 6 以来，有没有人遇到过我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:51:45.067

如前所述，您应该将错误报告给 bugreport.apple.com。顺便说一句，如果您建议 GLKTextureLoader 可能是问题所在（似乎是一个很好的理论），那么您可能会以两种方式之一缩小范围...

1）我会将显示的纹理渲染为一个普通的四边形，看看渲染结果是否符合您的期望。即，它渲染是否与您期望的垂直翻转？源纹理是否以某种您没有预料到的方式出现了部分乱码？

2）您可以尝试将您的图像转换为不同的尺寸/颜色深度/图像类型，看看问题是否仍然存在。我在想的是，这似乎不太可能，但可能没有被报告，因为由于图像格式的某些原因，您遇到了不寻常的边缘情况。知道这一点对任何试图在苹果公司解决这个问题的人都有很大的帮助。

可能没有太大帮助，但无法访问您的所有资源和资产，很难知道该建议什么。FWIW，我有一些示例与您正在做的事情类似，并且在 GLKit v. 10.8 下没有注意到任何事情。

# xml - 如何创建这样的xsd

> ID：12916096
> 
> 赞同：0
> 
> 时间：2012-10-16T13:45:20.763
> 
> 标签：xml, xsd-validation

我有一个看起来像这样的 xml 文件：

```
<Summary>
  <Persons>
    <Status>
      <Active value="false" text="Active" />
      <Inactive value="false" text="Inactive" />
    </Status>
   <Language>
      <Dutch value="false" text="" />
      <EnglishUK value="false" text="" />
      <EnglishUS value="false" text="" />
      <German value="false" text="" />
      <French value="false" text="" />
  </Language>
 </Persons>
 <Roles>
  <Status>
   <Active value="false" text="" />
   <Inactive value="false" text="" />
  </Status>
  <AssignedUsers>
   <m10 value="false" text="" />
   <b10and50 value="false" text="" />
   <x50 value="false" text="" />
  </AssignedUsers>
 </Roles>
</Summary> 
```

我使用在线 xsd 生成器从这个 xml 创建了一个 xsd：

```
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified"
  xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="Summary">
<xs:complexType>
  <xs:sequence>
    <xs:element name="Persons">
      <xs:complexType>
        <xs:sequence>
          <xs:element name="Status">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="Active">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="Inactive">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="Anonymous">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="Yes">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="No">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="Language">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="Dutch">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="EnglishUK">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="EnglishUS">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="German">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="French">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:complexType>
    </xs:element>
    <xs:element name="Roles">
      <xs:complexType>
        <xs:sequence>
          <xs:element name="Status">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="Active">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="Inactive">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="AssignedUsers">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="m10">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="b10and50">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
                <xs:element name="x50">
                  <xs:complexType>
                    <xs:simpleContent>
                      <xs:extension base="xs:string">
                        <xs:attribute type="xs:string" name="value"/>
                        <xs:attribute type="xs:string" name="text"/>
                      </xs:extension>
                    </xs:simpleContent>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:complexType>
    </xs:element>
  </xs:sequence>
</xs:complexType>
</xs:element>
</xs:schema> 
```

问题是每次我将一个新元素插入到 Persons/Status 或例如插入到 Roles/AssignedUsers 中时，我的验证都会失败。我想要的是一个验证父元素的模式，比如 Person/Status 和 Roles/Status 等等，但是像''这样的子元素不需要存在，但如果它们存在，它们必须具有属性“价值”和“文本”。如何创建这样的模式，一些帮助会很大。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:54:46.833

您的验证失败，因为您没有将任何元素指定为可选元素，因此所有元素都成为必需的。尝试添加`minOccurs="0"`到可选元素。

例如。我变了

```
<xs:element name="Anonymous" minOccurs="0"> 
```

并且您的示例 xml 已通过验证，没有错误

# iphone - UITextField 将不接受来自 IOS6 的键盘输入

> ID：12916097
> 
> 赞同：2
> 
> 时间：2012-10-16T13:45:21.287
> 
> 标签：iphone, ios, ipad, uitextfield

我已将其范围缩小到仅 IOS6 设备。

**原始问题：**

我到处搜索并尝试了所有方法，但我根本无法弄清楚！

我有一个`UITextField`. 当它被选中时，键盘向上滑动并且光标开始在文本字段上闪烁。当我点击键盘上的按钮时，一切正常，键响应并且光标停止闪烁。唯一的问题是文本没有放入文本字​​段！但是，它确实接受来自表情符号键盘的输入。任何帮助将不胜感激！

这`UITextField`是创建的方式：

```
UITextField *userInput = [[UITextField alloc] initWithFrame:CGRectMake(10, yPos, controlWidth, 26)];
yPos += 32;
[userInput setText:[prompt defaultValue]];
[userInput setPlaceholder:[prompt helpText]];
[userInput setBorderStyle:UITextBorderStyleRoundedRect];
[userInput setClearButtonMode:UITextFieldViewModeWhileEditing];
[userInput setFont:[UIFont fontWithName:@"Helvetica" size:18]];
[userInput setAdjustsFontSizeToFitWidth:YES];
[userInput setMinimumFontSize:10];
[userInput setAutoresizingMask:UIViewAutoresizingFlexibleWidth];
[userInput setDelegate:self];
[self.scrollView addSubview:userInput];
[self.promptControls addObject:userInput];
[userInput release]; 
```

这是在 for 循环中，因此`UITextField`s 的数量取决于循环被调用的次数。

这些是我使用的委托方法：

```
- (void)textFieldDidBeginEditing:(UITextField *)aTextField
{
    self.activeField = aTextField;
}

- (void)textFieldDidEndEditing:(UITextField *)aTextField
{
    self.activeField = nil;
}

- (BOOL)textFieldShouldReturn:(UITextField *)aTextField
{
    [aTextField resignFirstResponder];
    return YES;
} 
```

`activeField`是视图控制器上的一个属性，仅用于确定哪个字段当前处于活动状态

我相信这就是所有相关的代码

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T17:52:21.460

Ensure that you are setting up your window correctly at launch

And that you are calling

`[window setRootViewController:someViewController];`

Which is now an error in iOS6 if you dont and...

`[window makeKeyAndVisible];`

Which isn't an error (to omit) but throws things into wierd land and seems to result in `UITextView` and `UITextField` not working well.

as in...

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

self.viewController = [[[MyViewController alloc] initWithNibName:nil bundle:nil] autorelease];

self.navigationController = [[[UINavigationController alloc] initWithRootViewController:self.viewController] autorelease];

[window setRootViewController:navigationController];

[window makeKeyAndVisible];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T12:40:25.640

尝试评论`[userInput setDelegate:self];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:19:43.273

我不确定，但这可能是文本颜色的简单问题。尝试设置文字颜色；

```
[userInput setTextColor:[UIColor blackColor]]; 
```

我希望它有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-27T09:46:08.317

这可能是因为窗口文本字段不是关键窗口。只有键窗口可以接受用户输入。因此，尝试制作 [textfield.window makeKeyAndVisible];

# python - 使用 python 同步 2 个音频流

> ID：12916098
> 
> 赞同：2
> 
> 时间：2012-10-16T13:45:23.437
> 
> 标签：python, audio, synchronization

这是我的需求：我使用 gstreamer 和 python 录制了两个音频流（原始）。两条蒸汽之间没有漂移，但有一个三角洲。相关函数的图片可以给我增量值。

我没有使用 python 加载/处理音频的经验。由于这个过程并不困难..我可以询问有关要使用的库的建议，以及这样做的示例代码吗？

简单来说：

```
1) load raw audios files with python
2) compute inter-correlation
3) shift one audio streams by delta to synchronise both stream 
```

提前致谢。

# java - 为什么 Java GUI for R (JGR) 中没有命令历史记录？

> ID：12916100
> 
> 赞同：0
> 
> 时间：2012-10-16T13:45:27.813
> 
> 标签：java, r

很抱歉在 SO 中询问，但 rforge.net 似乎没有论坛或工作 bugzilla。有谁知道 JGR 不允许保存和加载历史记录是否有功能原因？
如果没有，有没有办法向团队提交“功能请求”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:37:48.687

您很可能需要阅读历史。正如 ?history 的详细信息部分所说：“有几种历史机制可用于不同的 R 控制台，它们以相似但不同的方式工作。R 的其他用途，特别是嵌入式用途，可能没有历史记录。这里描述的功能在 readline 命令行界面下工作，但可能不能在其他情况下工作（例如，在批量使用或嵌入式应用程序中）。” 在某些情况下，还有更多细节可能会提供纠正问题的方法。

# javascript - Django 的 Javascript 日期格式

> ID：12916104
> 
> 赞同：1
> 
> 时间：2012-10-16T13:45:36.780
> 
> 标签：javascript, django, date

我正在用 Django 创建一个运动应用程序。我需要显示一个带有倒计时的匹配列表，该倒计时可以精确到这些匹配的时间。

一切正常，除了倒计时到比赛当天，而不是小时和分钟。例如，如果一场比赛在两天后的晚上 9 点开始，倒计时将在比赛当天的午夜停止。所以不会到晚上九点。

这是我的代码：

```
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<script type="text/javascript"  src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="http://keith-wood.name/js/jquery.countdown.js">    </script>
</head>

<body>

<div style="float:left">
{% for match in matches %}
<div>  
    <p>{{ match }}</p>
    <p> {{match.real_start}} <p>
    <a href="{{ match.get_absolute_url_grille }}">Go</a>
    <div class="match_countdown" data-date="{{ match.real_start|date:'M j, Y'}}"></div>
</div>
{% endfor %}
</div>
</br></br>

<script>

$('.match_countdown').each(function() {
var self = $(this),
    date_string = self.attr('data-date'),
    date = new Date(date_string);
self.countdown({until: date});
});
</script>

</body> 
```

“real_start”是我的 DateTime 我猜问题出在与 DateTimeField 不匹配的日期格式“M j，Y”上。但我没有找到如何解决它。

欢迎任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T22:26:41.157

我认为最好的解决方案是将 Python 代码中的 you DateTimeField 模型属性转换为时间戳，转换为毫秒。要么通过向模型添加一个方法来处理该逻辑，这是最简单的解决方案，然后在 javascript 中解析该字符串以获得毫秒数，要么编写一个 Django 过滤器，但这稍微复杂一些。

```
import time
import datetime

def datetime_to_milliseconds(some_datetime_object):
    timetuple = some_datetime_object.timetuple()
    timestamp = time.mktime(timetuple)
    return timestamp * 1000.0

## Example using this
now = datetime.datetime.now()
millisecond_timestamp_now = datetime_to_milliseconds(now) 
```

（代码选择冗长，以便您更容易掌握逻辑）。

然后，您的 Javascript 应该类似于以下内容：

```
$('.match_countdown').each(function() {
    var self = $(this),
    date_string = self.attr('data-date'),
    date_milliseconds = Number(date_string);
    date = new Date(date_milliseconds);
    self.countdown({until: date});
}); 
```

基本上这些方面的东西应该可以解决问题，只需将其调整为一种方法即可。

未来的提示，尽量避免在模板中放置大量逻辑，这很容易出错并且不是一个真正的好习惯（除非它只是呈现逻辑，即使这样也有更好的解决方案）。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-13T09:14:47.233

从 Django 1.2 开始，你可以做

```
date = new Date({{ value|date:"c" }}); 
```

[在此处](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#date)检查格式文档。

# android - 如何在android中为有线以太网（ieee 802.3）创建pppoe连接？

> ID：12916108
> 
> 赞同：2
> 
> 时间：2012-10-16T13:45:46.660
> 
> 标签：android, pppoe

我有一个带有主机 USB 端口的 android 2.3 平板电脑。我还有一个连接到 USB 的以太网适配器。

我的设备支持以太网设施，因为它可以从设置菜单中看到。

唯一的问题是我无法使用登录详细信息“创建连接”到我的 ISP。

我没有路由器可以将 wan 转换为 lan。我也没有台式机/笔记本电脑/上网本。

我不是极客，但根据我所拥有的一点点知识，我发现这只是几行代码或一个应用程序的问题，直到现在我似乎还没有找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T02:45:09.743

这远非微不足道。Android 本身并不支持 PPPoE，因此您需要自己构建相关代码，这只能在有根设备上执行。此外，库存的 Android 2.3 不支持 USB 主机模式。当您将平板电脑连接到 USB 时，您的平板电脑是否看到以太网端口？如果是这样，你可能有机会。否则投资便宜的无线路由器，都应该支持PPPoE。

# c# - DataTable 将结果分组为一行

> ID：12916110
> 
> 赞同：1
> 
> 时间：2012-10-16T13:45:50.217
> 
> 标签：c#, linq, datatable, linq-group

我有一个 DataTable 并且想要对 Name、LastName 和 Comment 进行分组。其余的应该在同一行。在我的代码中，首先我将 ID 的值作为标题，然后将属性值组织到每个 ID。我在这里想要将相同的名称、姓氏和评论与其 ID 值分组。我的第一个表看起来像这样：

```
ID   Name   Lastmame    Comment    Attribute
1    kiki   ha          hello      FF        
3    lola   mi          hi         AA
2    ka     xe          what       UU
2    kiki   ha          hello      SS 
```

使用我的代码后：

```
 Name   Lastname    Comment   1    3    2
     kiki   ha           hello    FF
     lola   mi           hi            AA
     ka     xe           what              UU 
     kiki   ha           hello             SS 
```

我想要的是：

```
 Name   Lastname    Comment   1    3    2
     kiki    ha           hello   FF        SS
     lola    mi            hi          AA
     ka      xe           what              UU 
```

我的代码：

```
DataTable table1 = new DataTable("Kunde"); 
table1.Columns.Add("Comment", typeof(String)); 
table1.Columns.Add("Name", typeof(String)); 
table1.Columns.Add("Lastname", typeof(String)); 

DataTable comment = new DataTable("Comment");
comment.Columns.Add("ID", typeof(String)); 
comment.Columns.Add("Comment", typeof(String)); 
comment.Columns.Add("Attribute", typeof(String)); 

DataSet ds = new DataSet("DataSet"); 
ds.Tables.Add(table1); 
ds.Tables.Add(comment); 

object[] o1 = { "hello", "kiki", "ha" }; 
object[] o2 = { "hi", "lola", "mi" }; 
object[] o3 = { "what", "ka", "xe" };  
object[] c1 = { 1, "hello", "FF" }; 
object[] c2 = { 3, "hi", "AA" };
object[] c3 = { 2, "what", "UU" };
object[] c4 = { 2, "hello", "SS" }; 

table1.Rows.Add(o1); 
table1.Rows.Add(o2); 
table1.Rows.Add(o3); 
comment.Rows.Add(c1); 
comment.Rows.Add(c2);
comment.Rows.Add(c3);
comment.Rows.Add(c4);

var results = from tb1 in comment.AsEnumerable() 
              join tb2 in table1.AsEnumerable() 
              on tb1.Field<string>("Comment") equals tb2.Field<string>("Comment") 
              select new 
              { 
                  ID = tb1.Field<String>("ID"),
                  Name = tb2.Field<String>("Name"),
                  Lastname = tb2.Field<String>("Lastname"),
                  Comment = tb1.Field<String>("Comment"),
                  Attribute = tb1.Field<String>("Attribute"),
              };
DataTable result = LINQToDataTable(results);
var products = result.AsEnumerable()
                    .GroupBy(c => c["ID"])
                    .Where(g => !(g.Key is DBNull))
                    .Select(g => (string)g.Key)
                    .ToList();
var newtable = result.Copy();
products.ForEach(p => newtable.Columns.Add(p, typeof(string)));

foreach (var row in newtable.AsEnumerable())
{
    if (!(row["ID"] is DBNull)) row[(string)row["ID"]] = row["Attribute"];
}
newtable.Columns.Remove("ID");
newtable.Columns.Remove("Attribute");

var result11 = from t1 in newtable.AsEnumerable()
               group t1 by new { Name = t1.Field<String>("Name"), LastName = t1.Field<String>("LastName"), Comment = t1.Field<String>("Comment"), } into grp
               select new
               {
                   Name = grp.Key.Name,
                   LastName = grp.Key.LastName,
                   Comment = grp.Key.Comment,
                   //Something here
               }; 
```

`LINQToDataTable`方法定义

```
using System.Reflection;

public DataTable LINQToDataTable<T>(IEnumerable<T> varlist)
{
    DataTable dtReturn = new DataTable();

    // column names 
    PropertyInfo[] oProps = null;

    if (varlist == null) return dtReturn;

    foreach (T rec in varlist)
    {
        if (oProps == null)
        {
            oProps = ((Type)rec.GetType()).GetProperties();
            foreach (PropertyInfo pi in oProps)
            {
                Type colType = pi.PropertyType;

                if ((colType.IsGenericType) && (colType.GetGenericTypeDefinition()
                == typeof(Nullable<>)))
                {
                    colType = colType.GetGenericArguments()[0];
                }

                dtReturn.Columns.Add(new DataColumn(pi.Name, colType));
            }
        }

        DataRow dr = dtReturn.NewRow();

        foreach (PropertyInfo pi in oProps)
        {
            dr[pi.Name] = pi.GetValue(rec, null) == null ? DBNull.Value : pi.GetValue
            (rec, null);
        }

        dtReturn.Rows.Add(dr);
    }
    return dtReturn;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:34:31.387

根据[对此其他答案](https://stackoverflow.com/a/12914411/390819)的评论：

一种方法是将所有变量列填充到一个结构中（如字典）。

为此，请使用以下查询：

```
var variableColumnNames = newtable.Columns.Cast<DataColumn>()
    .Select(c => c.ColumnName)
    .Except(new[]{"Name", "Lastname", "Comment"});

var result11 = from t1 in newtable.AsEnumerable()
    group t1 by new
    {
        Name = t1.Field<String>("Name"),
        LastName = t1.Field<String>("LastName"),
        Comment = t1.Field<String>("Comment"),
    } into grp
    select new
    {
        grp.Key.Name,
        grp.Key.LastName,
        grp.Key.Comment,

        Values = variableColumnNames.ToDictionary(
            columnName => columnName,
            columnName => grp.Max(r => r.Field<String>(columnName)))
    }; 
```

如果你真的需要在类中拥有可变数量的属性，据我所知这是不可能的，所以唯一可行的方法是将结果输出到另一个`DataTable`（我们可以添加尽可能多的列我们想要）。

### 方法 #2 - 使用`dynamic`

LINQ 查询：

```
var result11 = from t1 in newtable.AsEnumerable()
    group t1 by new
    {
        Name = t1.Field<String>("Name"),
        LastName = t1.Field<String>("LastName"),
        Comment = t1.Field<String>("Comment"),
    } into grp
    select CreateNewDynamicObject
        (
            grp.Key.Name,
            grp.Key.LastName,
            grp.Key.Comment,
            variableColumnNames.ToDictionary(
                columnName => columnName,
                columnName => grp.Max(r => r.Field<String>(columnName)))
        );
    } 
```

创建动态对象的新方法：

```
private static dynamic CreateNewDynamicObject(
    string name, string lastName, string comment, Dictionary<string, string> customProperties)
{
    dynamic obj = new ExpandoObject();

    obj.Name = name;
    obj.LastName = lastName;
    obj.Comment = comment;

    foreach (var prop in customProperties)
        (obj as IDictionary<string, Object>).Add(prop.Key, prop.Value ?? "");

    return obj;
} 
```

### 方法 #3 - 输出到`DataTable`

结果`DataTable`( `destinationTable`) 可用作 a 的源`DataGridView`：

```
var destinationTable = new DataTable();

foreach (var column in newtable.Columns.Cast<DataColumn>())
    destinationTable.Columns.Add(column.ColumnName, typeof(String));

var result11 =
    from t1 in newtable.AsEnumerable()
    group t1 by new
                    {
                        Name = t1.Field<String>("Name"),
                        LastName = t1.Field<String>("Lastname"),
                        Comment = t1.Field<String>("Comment"),
                    }
        into grp
        select
            variableColumnNames.ToDictionary(
                columnName => columnName,
                columnName => grp.Max(r => r.Field<String>(columnName)))
            .Concat(new Dictionary<string, string>
                    {
                        {"Name", grp.Key.Name},
                        {"Lastname", grp.Key.LastName},
                        {"Comment", grp.Key.Comment}
                    }
            ).ToDictionary(x => x.Key, x => x.Value);

foreach (var row in result11)
{
    var newRow = destinationTable.NewRow();

    foreach (var columnName in newtable.Columns.Cast<DataColumn>().Select(c => c.ColumnName))
        newRow[columnName] = row[columnName];

    destinationTable.Rows.Add(newRow);
} 
```

# silverlight - 单击按钮时关闭 Silverlight 窗口

> ID：12916111
> 
> 赞同：0
> 
> 时间：2012-10-16T13:45:51.987
> 
> 标签：silverlight, xaml

Silverlight 窗口中有“确定”和“取消”按钮。

单击该窗口上的取消按钮时，如何关闭窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:51:27.967

如果 SilverLight 应用程序托管在 WebBrowser 中，那么您可以将浏览器重定向到另一个页面：

```
HtmlPage.Window.Navigate(new Uri("../Login/Login.aspx", UriKind.Relative)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T20:27:33.483

你可以使用下一条语句：

```
System.Windows.Browser.HtmlPage.Window.Invoke("close"); 
```

# preprocessor - C++ 中的预处理

> ID：12916117
> 
> 赞同：4
> 
> 时间：2012-10-16T13:45:57.000
> 
> 标签：preprocessor

当我同时定义两个指令时，我会得到编译错误，如何做到这一点？在这里我想要错误

```
#define ENG
#define POL
#if defined POL
#if defined ENG 
```

这里不

```
#define ENG
//#define POL
#if defined POL
#if defined ENG 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T13:47:11.217

```
#if defined( ENG ) && defined( POL )
#error You can't define both!
#endif 
```

# silverlight - 数据网格。结构属性未更新

> ID：12916119
> 
> 赞同：1
> 
> 时间：2012-10-16T13:46:11.213
> 
> 标签：silverlight, xaml, data-binding, struct

我遇到了 Silverlight 的奇怪问题`DataGrid`。当我将结构列表（放置在 中`ViewModel`）绑定到网格值时，会正确显示，但由于某些原因，对网格所做的更改不会反映在`ViewModel`.

```
public struct ObjectSelection 
{
    public bool Selected { get; set; }
    public string Name { get; set; }
}

public List<ObjectSelection> SelectedObjects
{
    get { return _selectedObjects; }
    set
    {
        if (value != _selectedObjects)
        {
            _selectedObjects= value;
            FirePropertyChanged("SelectedObjects");
        }
    }
} 
```

XAML：

```
<navigation:DataGrid AutoGenerateColumns="False" ItemsSource="{Binding SelectedObjects, Mode=TwoWay}"                                    
    <navigation:DataGrid.Columns>
        <navigation:DataGridFilterTemplateColumn Header="Selected"
            CanUserFilter="True"
            CanUserSort="False"
            DataType="Boolean"
            SortMemberPath="Include">
            <navigation:DataGridFilterTemplateColumn.CellTemplate>
                <DataTemplate>
                    <controls:CheckBox HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        IsChecked="{Binding Selected, Mode=TwoWay}"/>
                </DataTemplate>
            </navigation:DataGridFilterTemplateColumn.CellTemplate>
        </navigation:DataGridFilterTemplateColumn>                                        
        <navigation:DataGridFilterColumn Header="Dimension"
            DataType="String" 
            CanUserFilter="False"
            IsReadOnly="True"
            Binding="{Binding Name}" 
            CanUserSort="True"                                              
            SortMemberPath="Name"
            Width="*"/>
    </navigation:DataGrid.Columns>
</navigation:DataGrid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:51:24.707

你不应该定义`ObjectSelection`为`struct`.

每次从您的属性中读取A时`struct`都会**复制它。**该副本用于装订。如果该副本随后被用户修改，则原始副本保持不变。我建议你使用 a`class`而不是 a `struct`。在几乎所有情况下，类都是更好的选择。

[微软推荐](http://msdn.microsoft.com/en-us/library/ms229017.aspx)：

> 如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。
> 
> 除非类型具有以下所有特征，否则不要定义**结构**：
> 
> *   它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
> *   它的实例大小小于 16 字节。
> *   它是不可变的。
> *   它不必经常装箱。

# sql - SQL多表合二为一

> ID：12916125
> 
> 赞同：0
> 
> 时间：2012-10-16T13:46:29.627
> 
> 标签：sql, sql-server-2008

对于任何特定产品，我都有一个产品表和一个单独的图像表。

`tblProducts`：

*   产品编号
*   产品名称

`tblProductImages`：

*   产品编号
*   图像文件名

我可以使用两个单独的查询返回产品详细信息，然后返回该产品的产品图像，但我不确定如何将其放入一个查询中？

例如，我想看看：

```
productID productName imageFilename imageFilename imageFilename 
```

作为我的结果集（需要是动态的，因为每个产品可能上传 1 到 10 张图片）。

这是我可以用 PIVOT 做的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:25:30.440

您可以将 a`PIVOT`用于此结果。如果您知道列数，则可以对它们进行硬编码：

```
select *
from
(
  select p.productid,
    p.productname,
    i.imagefilename,
    'ImageFile_' + 
      cast(row_number() over(partition by i.productid 
                order by i.productid) as varchar(10)) col
  from tblproducts p
  left join tblProductImages i
    on p.productid = i.productid
) x
pivot
(
  max(imagefilename)
  for col in ([ImageFile_1], [ImageFile_2], [ImageFile_3])
) p 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/4aa72/8)

或者您可以使用动态 SQL 生成`PIVOT`. 如果您的数量不断变化，动态将起作用`imagefilename`：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' 
                        + QUOTENAME('ImageFile_'+ cast(x.rn as varchar(10))) 
                    from
                    (
                      select row_number() over(partition by i.productid 
                          order by i.productid) rn
                      from tblProductImages i
                    ) x
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT productid, productname,' + @cols + ' 
              from 
             (
                select p.productid,
                  p.productname,
                  i.imagefilename,
                  ''ImageFile_'' + 
                    cast(row_number() over(partition by i.productid 
                              order by i.productid) as varchar(10)) col
                from tblproducts p
                left join tblProductImages i
                  on p.productid = i.productid
            ) x
            pivot 
            (
                max(imagefilename)
                for col in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/4aa72/15)

这两个结果都将与此类似：

```
PRODUCTID | PRODUCTNAME |  IMAGEFILE_1 | IMAGEFILE_2 | IMAGEFILE_3
==================================================================
1         | Product 1   | Image1       | Image2      | Image3
2         | Product 2   | Image1       | Image2      | (null)
3         | Product 3   | Image1       | (null)      | (null)
4         | Product 4   | Image1       | Image2      | Image3
5         | Product 5   | Image1       | (null)      | (null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:10:42.743

也试试这样。每个产品ID 都有一个逗号分隔的文件名。

```
select p.productID,
(select STUFF((select ','+imageFileName from tblProductImages where productID=p.productID
for xml path('')),1,1,'')) as ImageFileNames
from tblProducts p
group by p.productID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:23:31.633

我想感谢@RomanParker。`apply`但是，当更常见`join`的情况完全足够时，我会感到不舒服。查询还有许多其他更改，特别是在加入产品表*之前进行聚合：*

```
select P.productID, P.productName,
       imageFileName1,
       imageFileName2,
       imageFileName3,
       ...
       imageFileName10
from tblProducts as P left outer join
     (select I.productID,
             min(case when I.RowNum = 1 then I.imageFileName else null end) as imageFileName1,
             min(case when I.RowNum = 2 then I.imageFileName else null end) as imageFileName2,
             min(case when I.RowNum = 3 then I.imageFileName else null end) as imageFileName3,
             ...
             min(case when I.RowNum = 10 then I.imageFileName else null end) as imageFileName10
      from (select I.*,
                   row_number() over (partition by ProductId Order by (select NULL)) as RowNum
            from tblProductImages as I
           ) I
      group by I.productID
     )
     on p.productId = I.productID 
```

# php - 如何从当前日期中减去字符串时间？

> ID：12916128
> 
> 赞同：0
> 
> 时间：2012-10-16T13:46:32.227
> 
> 标签：php

我想从当前日期减去指定时间。我不知道为什么，但它说我的日期（我想子）是一个字符串。如何将其转换为一种格式，如果从中减去当前时间，我将得到剩余天数。

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:58:34.837

假设`$num_of_days`是没有。您想从当天减去的天数。

```
 $new_date =  date('Ymd', strtotime(date('Ymd', strtotime(date('Ymd') . " -  ".$num_of_days."days")))); 
```

`$new_date`将采用日期 Ymd 格式。如果你想及时

```
 $new_time = strtotime(date('Ymd', strtotime(date('Ymd') . " -  ".$num_of_days."days"))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:48:27.110

假设您的日期在名为 的变量中`$dateToSubtract`，您可以使用 PHP[`strtotime()`](http://php.net/strtotime)将其转换为时间戳：

```
$timestamp = strtotime($dateToSubtract); 
```

用于查找“现在”和指定日期之间的差异：

```
$date = time() - strtotime($dateToSubtract); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T13:49:23.410

[使用HERE](http://www.ozzu.com/programming-forum/subtracting-date-from-another-t29111.html)指定的 dateDiff 函数。这是我发现的最有效的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T13:48:42.993

[`strtotime`](http://php.net/strtotime)，字面意思是“时间字符串”，应该是您要查找的内容。

# iphone - 为 iOS 模拟器减慢互联网速度

> ID：12916133
> 
> 赞同：31
> 
> 时间：2012-10-16T13:46:45.137
> 
> 标签：iphone, xcode, ios-simulator

我的 iOS 应用程序发生随机崩溃。当互联网连接速度较慢时会发生这种情况。我的办公室网速太快了。

为了在模拟器上进行测试，我安装了 Network Link Conditioner，如下所述：[Installing Apple's Network Link Conditioner Tool](https://stackoverflow.com/questions/9659382/installing-apples-network-link-conditioner-tool)

现在的问题是，我选择了一个较慢的连接配置文件，但我仍然在模拟器中拥有正常（快速）的互联网速度。

我还创建了自己的配置文件并将下载带宽设置为 5kbps，但仍然没有用。

我有： Mackbook 视网膜，OSX 10.7.5，XCode：4.4.1

重新启动 Xcode 和 Simulator 也不起作用。

Network Link Conditioner 是否需要任何其他设置？还是我应该做其他事情来重新产生崩溃？有什么帮助吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-10-16T15:18:41.127

您可以通过在设备上进行测试来将网络设置为慢速特性。转到设置 -> 开发人员设置 -> 网络链接调节器 -> 启用。这适用于运行 iOS 6 Network Link Conditioner 的 iPhone/iPad，也可用于 Mac 在“Xcode 的附加工具”中用于在模拟器中进行测试。

注意：它在设备连接到 Xcode、启用开发并在其上运行一些应用程序后出现。

以下是测试可怕的网络性能的方法： ![在此处输入图像描述](../Images/adb8f8f07dff558fb25554797531ad3f.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-16T15:18:14.907

开发代理服务器来模拟慢速连接怎么样？一个看起来很有希望的是[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:46:40.837

您不能使用连接到您的 mac 的 ipad/iphone 来重现崩溃吗？

ios6 也包含一个网络链接调节器：http: [//www.neglectedpotential.com/2012/09/ios6-network-link-conditioner/](http://www.neglectedpotential.com/2012/09/ios6-network-link-conditioner/)

# .net - 发布 Excel Interop com 对象的最佳方式

> ID：12916137
> 
> 赞同：2
> 
> 时间：2012-10-16T13:46:48.187
> 
> 标签：.net, vb.net, interop

专家，请让我知道我能做到这一点的最佳方法......

我正在开发一个 VB.Net 应用程序，该应用程序使用 Microsoft.Office.Interop.Excel 对象库在工作簿中创建工作表并在这些工作表中创建数据透视表。

我的代码看起来像这样：

```
Dim ExcelApp As New Microsoft.Office.Interop.Excel.Application
Dim wbk As Microsoft.Office.Interop.Excel.Workbook = Nothing
Dim wksRawData As Microsoft.Office.Interop.Excel.Worksheet = Nothing
Dim wksPvtTbl As Microsoft.Office.Interop.Excel.Worksheet = Nothing
Dim pvtCache As Microsoft.Office.Interop.Excel.PivotCache = Nothing
Dim pvtTables As Microsoft.Office.Interop.Excel.PivotTables = Nothing
Dim pvtTable As Microsoft.Office.Interop.Excel.PivotTable = Nothing
Dim r1 As Microsoft.Office.Interop.Excel.PivotField = Nothing
Dim r2 As Microsoft.Office.Interop.Excel.PivotField = Nothing
Dim df1 As Microsoft.Office.Interop.Excel.PivotField = Nothing

Try

... Create the objects, put in the information

Catch ex As Exception
   MessageBox.Show("There was an error creating the Excel file", "Error Creating File", MessageBoxButtons.OK)
Finally

   ReleaseObject(r1)
   ReleaseObject(r2)
   ReleaseObject(df1)
   ReleaseObject(pvtTable)
   ReleaseObject(pvtTables)
   ReleaseObject(pvtCache)
   ReleaseObject(wksRawData)
   ReleaseObject(wksPvtTbl)
   ReleaseObject(wbk)

   ExcelApp.DisplayAlerts = True
   ExcelApp.Quit()
   ReleaseObject(ExcelApp)

   ExcelApp = Nothing
   wbk = Nothing
   wksRawData = Nothing
   GC.Collect()
End Try 
```

然后我的发布对象的代码如下所示：

```
Public Sub ReleaseObject(ByRef Reference As Microsoft.Office.Interop.Excel.Application)
    Dim i As Integer
    If Reference IsNot Nothing Then
        i = System.Runtime.InteropServices.Marshal.ReleaseComObject(Reference)

        While i > 0
            i = System.Runtime.InteropServices.Marshal.ReleaseComObject(Reference)
        End While

        Reference = Nothing
    End If
End Sub

Public Sub ReleaseObject(ByRef Reference As Microsoft.Office.Interop.Excel.Workbook)
    Dim i As Integer
    If Reference IsNot Nothing Then
        i = System.Runtime.InteropServices.Marshal.ReleaseComObject(Reference)

        While i > 0
            i = System.Runtime.InteropServices.Marshal.ReleaseComObject(Reference)
        End While

        Reference = Nothing
    End If
End Sub

... etc 
```

我知道这类问题有很多解决方案，但我迷失在所有不同的解决方案中，不知道什么最适合我目前的情况……这是一个很好的方法吗？如果不是，什么是更有效的方法？？

谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T17:07:42.800

不要手动搜索和调用释放。如果应用程序发生灾难性崩溃，Interop 进程仍可能运行松散。

[我会通过Job Objects](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684161(v=vs.85).aspx)将 Interop 进程注册到操作系统。

这是一个解决方案：[https ://stackoverflow.com/a/1307180/160146](https://stackoverflow.com/a/1307180/160146)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:55:17.193

我的答案不是最好的，但它有效：（杀死您的应用程序使用的 Excel 进程）

[如何正确清理 Excel 互操作对象？](https://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c-sharp/1577441#1577441)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:49:10.197

过去我遇到过 Excel 无法正常关闭的问题。

这是我所做的：

*   确保你 .Close() 和 .Dispose() 所有的工作簿，然后所有的应用程序
*   还有 Marshal.ReleaseComObject()，但只有一次。我从来没有像你那样做for循环。
*   然后 GC.Collect() 和 GC.WaitForPendingFinalizers()
*   通常在开始时将 DisplayAlerts 和 Interactive 设置为 false。确保没有弹出窗口在后台运行。

我从来没有使用互操作做数据透视表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-04T19:04:14.750

我分享 VB.net 代码：

```
Imports System.Runtime.InteropServices
Namespace Jobs

Public Class Job
    Implements IDisposable

    <DllImport("kernel32.dll", CharSet:=CharSet.Unicode)>', 
    CallingConvention:=CallingConvention.Cdecl)>
    Shared Function CreateJobObject(a As IntPtr, lpName As String) As IntPtr
    End Function

    <DllImport("kernel32.dll")>
    Public Shared Function SetInformationJobObject(hJob As IntPtr, infoType As 
    JobObjectInfoType, lpJobObjectInfo As IntPtr, cbJobObjectInfoLength As UInteger) As Boolean
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)>
    Public Shared Function CloseHandle(Token As IntPtr) As Boolean
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)>
    Public Shared Function AssignProcessToJobObject(job As IntPtr, process As IntPtr) as Boolean
    End Function

    Private m_handle As IntPtr
    Private m_disposed As Boolean = False

    Public Sub New()

        m_handle = CreateJobObject(IntPtr.Zero, Nothing)

        Dim info As JOBOBJECT_BASIC_LIMIT_INFORMATION = New JOBOBJECT_BASIC_LIMIT_INFORMATION()
        info.LimitFlags = &H2000

        Dim extendedInfo = New JOBOBJECT_EXTENDED_LIMIT_INFORMATION()
        extendedInfo.BasicLimitInformation = info

        Dim length As Integer = Marshal.SizeOf(GetType(JOBOBJECT_EXTENDED_LIMIT_INFORMATION))
        Dim extendedInfoPtr As IntPtr = Marshal.AllocHGlobal(length)
        Marshal.StructureToPtr(extendedInfo, extendedInfoPtr, False)

        If (Not SetInformationJobObject(m_handle, JobObjectInfoType.ExtendedLimitInformation, extendedInfoPtr, length)) Then
            Throw New Exception(String.Format("Unable to set information.  Error: {0}", Marshal.GetLastWin32Error()))
        End If
    End Sub

#Region "IDisposableMembers"

    Public Sub Dispose() Implements IDisposable.Dispose
        Dispose(True)
        GC.SuppressFinalize(Me)
    End Sub

#End Region
    Private Sub Dispose(disposing As Boolean)
        If m_disposed Then
            Return
        End If
        If disposing Then
        End If
        Close()
        m_disposed = True
    End Sub

    Public Sub Close()
        CloseHandle(m_handle)
        m_handle = IntPtr.Zero
    End Sub

    Public Function AddProcess(handle As IntPtr) As Boolean
        Return AssignProcessToJobObject(m_handle, handle)
    End Function

End Class

Public Enum JobObjectInfoType
    AssociateCompletionPortInformation = 7
    BasicLimitInformation = 2
    BasicUIRestrictions = 4
    EndOfJobTimeInformation = 6
    ExtendedLimitInformation = 9
    SecurityLimitInformation = 5
    GroupInformation = 11
End Enum

<StructLayout(LayoutKind.Sequential)>
Public Structure SECURITY_ATTRIBUTES
    Public nLength As Integer
    Public lpSecurityDescriptor As IntPtr
    Public bInheritHandle As Integer
End Structure

<StructLayout(LayoutKind.Sequential)>
Structure JOBOBJECT_BASIC_LIMIT_INFORMATION
    Public PerProcessUserTimeLimit As Int64
    Public PerJobUserTimeLimit As Int64
    Public LimitFlags As Int16
    Public MinimumWorkingSetSize As UInt32
    Public MaximumWorkingSetSize As UInt32
    Public ActiveProcessLimit As Int16
    Public Affinity As Int64
    Public PriorityClass As Int16
    Public SchedulingClass As Int16
End Structure

<StructLayout(LayoutKind.Sequential)>
Structure IO_COUNTERS
    Public ReadOperationCount As UInt64
    Public WriteOperationCount As UInt64
    Public OtherOperationCount As UInt64
    Public ReadTransferCount As UInt64
    Public WriteTransferCount As UInt64
    Public OtherTransferCount As UInt64
End Structure

<StructLayout(LayoutKind.Sequential)>
Structure JOBOBJECT_EXTENDED_LIMIT_INFORMATION
    Public BasicLimitInformation As JOBOBJECT_BASIC_LIMIT_INFORMATION
    Public IoInfo As IO_COUNTERS
    Public ProcessMemoryLimit As UInt32
    Public JobMemoryLimit As UInt32
    Public PeakProcessMemoryUsed As UInt32
    Public PeakJobMemoryUsed As UInt32
End Structure

End Namespace 
```

并且，在您计划实施的课程中：

```
<DllImport("user32.dll", SetLastError:=True)>
Public Shared Function GetWindowThreadProcessId(hWnd As IntPtr, ByRef lpdwProcessId As UInteger) As UInteger
End Function

'Implements
Dim oExcelApp = New Microsoft.Office.Interop.Excel.Application
Dim job As Jobs.Job = New Jobs.Job()
Dim pid As UInteger = 0
GetWindowThreadProcessId(New IntPtr(oExcelApp.Hwnd), pid)
job.AddProcess(Process.GetProcessById(pid).Handle)

oExcelApp.Workbooks.Open(RutaArchivoExcel)

'Code work code here

oExcelApp.Workbooks(1).Close()
oExcelApp.Quit()

'Then Dispose correctly the excel app and windows distroy appropiately the process
job.Dispose() 
```

我用 Microsoft Excel 2016 对此进行了测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-13T04:02:06.557

我已确保所有对象都通过后期绑定单独声明、使用和释放，并用“ONE DOT”仔细声明每个对象。确保 Excel 范围、工作表、工作簿和应用程序都被创建为对象并以相反的顺序关闭或退出，请注意没有未回答的对话框可以停止关闭或退出。使用了 InteropServices.Marshal.FinalReleaseComObject 并将 ReleaseComObject 放在一个 while 循环中，等待 count 变为零，以努力释放每一件小事。始终在 try/catch 块的 finally 子句中将对象设置为空。完成垃圾收集并等待终结者。确保我正在使用已编译的代码而不是在调试器中进行测试。换句话说，我已经阅读了每一个专家的意见并尝试了每一个专家的建议。任务管理器中仍然有孤立的 Excel 进程，在重新启动 PC 之前永远不会清理这些进程。唯一真正有效的方法是在我完成后终止进程。在我完成所有其他操作以退出、释放和垃圾收集之前，我不会杀死它。但是我不能让孤立的 excel 进程徘徊等待永远不会完成的 .NET 垃圾收集。

# django - 如何在前端更改管理员日期小部件的外观

> ID：12916138
> 
> 赞同：2
> 
> 时间：2012-10-16T13:46:47.997
> 
> 标签：django

我将 Django Admin datewidget 集成到我的前端。我想更改出现的日历中的外观和一些文本。所以，我发现不知何故，正在调用的脚本是 DateTimeShortcuts.js。我尝试通过 su vi 更改代码并保存更改，但输出中没有出现任何更改。有人可以指出我做错了什么。我将链接粘贴到屏幕截图中，以便您更容易理解我想要做什么。帮助将不胜感激。非常感谢。

[http://imageshack.us/a/img31/2977/screenshot20121016at709.png](http://imageshack.us/a/img31/2977/screenshot20121016at709.png)

萨达特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T06:05:18.210

我建议为您的前端 datepicker 小部件使用另一个库，例如[jQuery UI datepicker](http://jqueryui.com/datepicker/)。这是因为让 Django datepicker 小部件在前端工作非常繁琐。但是，如果您坚持使用它，您会发现这个 Stack Overflow 问题（以及随附的答案）很有用：[Using Django time/date widgets in custom form](https://stackoverflow.com/questions/38601/using-django-time-date-widgets-in-custom-form)。我怀疑没有加载正确的脚本（或以错误的顺序加载）。

# excel - 使用动态范围时出现 Excel VBA 错误

> ID：12916140
> 
> 赞同：1
> 
> 时间：2012-10-16T13:46:59.367
> 
> 标签：excel, vba

我正在尝试用动态范围的值填充组合框（拖到我的工作表上）。

Normaly 'ThisWorkbook.Names("NAME_OF_RANGE").RefersToRange' 有效，但它在我的动态范围内失败！

我尝试了不同的解决方案（参见下面的代码），但随后工作表名称从引用中被删除（因此填充了错误的数据）

```
Public Sub FillCombobox(cboComboBox As ComboBox, sRange As String)
'Remember current selected item
Dim sSelectedItem As String
sSelectedItem = cboComboBox.Text

'Empty the combobox
cboComboBox.Clear
cboComboBox.AddItem "---pick one---"

'Get the data from the dynamic range
Dim oListFillRange As Range
'This line will throw an error:
Set oListFillRange = ThisWorkbook.Names(sRange).RefersToRange 'Does not work with a dynamic range!!!
''Set oListFillRange = Range(Application.Evaluate(ThisWorkbook.Names(sRange).RefersTo).Address) 'Works with dynamic ranges on the SAME SHEET (as the sheetname is stripped out!)

'Fill combobox
Dim oRange As Range
For Each oRange In oListFillRange
    cboComboBox.AddItem oRange.Value
Next oRange

'Set previous selected item
Dim i As Integer
For i = 0 To cboComboBox.ListCount - 1
    If cboComboBox.List(i) = sSelectedItem Then
        cboComboBox.ListIndex = i
        Exit for
    End If
Next i

If cboComboBox.ListIndex = -1 Then cboComboBox.ListIndex = 0
End Sub 
```

那么如何让 'ThisWorkbook.Names("NAME_OF_RANGE").RefersToRange' 使用动态范围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:57:28.300

请参阅`Range`属性的范围。

```
Set oListFillRange = Sheets("mySheet").Range(sRange) 'where mySheet is the relevant sheet name 
```

对于更多信息，`RefersToRange`不起作用的原因是因为动态范围的公式中没有范围，因此excel属性无法读取实际范围。因此，直接引用范围是唯一的方法。

# asp.net - VS2012 - 按钮不回发

> ID：12916152
> 
> 赞同：0
> 
> 时间：2012-10-16T13:47:24.690
> 
> 标签：asp.net, visual-studio, html, visual-studio-2012, asp.net-4.5

这必须很简单。不过，我注意到 VS2012 的行为非常不稳定——例如，有时它不会生成设计器文件条目。有没有人知道这里可能发生了什么？我尝试在代码中添加按钮并将其拖到设计图面上。我已经重新创建了几次表格，但无济于事。

这是我的代码：

**ASPX：**

```
<asp:Button ID="Button1" runat="server" CssClass="submitButton" 
    OnClick="Submit_Click" Text="  Submit  "  /> 
```

**代码隐藏：**

```
protected void Submit_Click(object sender, EventArgs e)
{
    if (Page.IsValid)
    {
        Response.Write("got to here...");
    }
} 
```

**设计师：**

```
protected global::System.Web.UI.WebControls.Button Button1; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T13:59:43.633

删除 OnClick="Submit_Click"，正如 ASAWYER 所说，转到设计器并双击该按钮。或在后端代码中选择常规下拉菜单，找到您的按钮，然后在声明下拉菜单中选择点击事件![在此处输入图像描述](../Images/1366bc5822bca579ad536f48c165766e.png)

# javascript - 在 javascript 中使用图像作为 Windows 8 Metro 的超链接

> ID：12916156
> 
> 赞同：2
> 
> 时间：2012-10-16T13:47:37.523
> 
> 标签：javascript, windows-8, microsoft-metro

在我的 home.html 中，我有：

```
<a href="/pages/page2/page2.html">Go to page2</a> 
```

由 home.js 处理：

```
WinJS.Utilities.query("a").listen("click", linkClickEventHandler, false); 
```

和 linkClickEventHandler 定义：

```
function linkClickEventHandler(eventInfo)
{
   eventInfo.preventDefault();
   var link = eventInfo.target;
   WinJS.Navigation.navigate(link.href);
} 
```

如您所见，我重写了`<a>`使用页面控件导航而不是普通 HTML 导航的行为。

单击“转到 page2”时，它成功地将页面控件从 home.html 更改为 page2.html

现在，如果我想在`<a>`标签内使用图像而不是文本“Go to page2”，该怎么办：

```
<a href="/pages/page2/page2.html"><img src="page2.png" /></a> 
```

这似乎不起作用。我已经加载并显示了图像，但是当我单击它时，它似乎尝试以文本格式显示图像，因为页面控件更改为一些充满未知（方形）字符的垃圾文本，这些字符以 'PNG. .. PHOTOSHOP...”（我使用 Photoshop 创建图像）

我也尝试添加：

```
WinJS.Utilities.query("img").listen("click", linkClickEventHandler, false); 
```

但它什么也没做

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:02:39.773

用这个：

```
var link = eventInfo.currentTarget; 
```

... 反而。`eventInfo.currentTarget`看，和`eventInfo.target`（引用[文档](http://msdn.microsoft.com/en-us/library/windows/apps/hh453015.aspx)）之间有一个微妙但重要的区别：

> 该`target`属性返回最初接收到事件的元素。但是，该`currentTarget`属性返回在捕获和冒泡阶段正在处理事件处理程序的元素。

该错误是由`eventInfo.target`图像元素引起的，而不是链接元素。）看，从技术上讲，`click`事件首先发生在其中`<img src... />`；最终它到达了外部`<a href="...">`元素（所谓的`bubbling`），但它的原始目标（= eventInfo.target）仍然是一样的！因此，您的脚本实际上会导航到`src`图像属性中指定的 URL（作为其`href`属性值）。

# java - 处理 HttpClient (Httpget) 超时

> ID：12916159
> 
> 赞同：1
> 
> 时间：2012-10-16T13:47:41.430
> 
> 标签：java, httpclient, apache-httpclient-4.x

因此，我正在运行一个多线程程序，该程序对 api 和一些它想要抓取的网页进行调用。在一些不寻常的情况下，httpget 会严重失败并导致程序“冻结”（线程永远不会退出，线程池永远不会关闭，main 永远不会退出等）

我需要为我正在建立的 http 连接设置超时。我正在使用 DefaultHttpClient

```
DefaultHttpClient httpclient = new DefaultHttpClient(); 
```

而且我没有设置任何参数。

有人可以帮我把这些超时，或者至少指出我应该在哪里寻找处理超时？（Apache 似乎有很棒的库，但似乎从来没有很好的例子）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T13:56:01.210

尝试如下所示。

```
int connectiontimeout = 1000; //1 second
int sockettimeout = 1000;

HttpParams httpparameters = new BasicHttpParams();

HttpConnectionParams.setConnectionTimeout(httpparameters, connectiontimeout);
HttpConnectionParams.setSoTimeout(httpparameters, sockettimeout);

HttpClient httpclient = new DefaultHttpClient(httpparameters); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:50:03.020

你想要[HttpConnectionParams](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/HttpConnectionParams.html)。您可能需要区分连接超时和套接字超时（与读取有关，*而不是连接*）

> SO_TIMEOUT 以毫秒为单位定义默认套接字超时 (SO_TIMEOUT)，即等待数据的超时。
> 
> CONNECTION_TIMEOUT 确定连接建立之前的超时时间。

有关更多详细信息，请参见[此处](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d5e399)。这些选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:49:49.307

您可能想要使用两者中的一个，最好是第一个。

```
 HttpConnectionParams.setConnectionTimeout(int) 

 HttpConnection.setConnectionTimeout(int) 
```

作为：

```
 HttpConnectionParams.setConnectionTimeout( httpParams, 5000 ); 
```

# java - 如何在 Java 中使用 REST

> ID：12916169
> 
> 赞同：50
> 
> 时间：2012-10-16T13:48:11.057
> 
> 标签：java, web-services, rest

使用 Java 工具，

```
wscompile for RPC
wsimport for Document
etc.. 
```

我可以使用 WSDL 生成访问 SOAP Web 服务所需的存根和类。

但我不知道如何在 REST 中做同样的事情。如何获得访问 REST Web 服务所需的 Java 类。无论如何，打服务的方法是什么？

谁能给我指路？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2018-02-05T09:54:49.433

工作示例，试试这个：

```
package restclient;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;

public class NetClientGet {
    public static void main(String[] args) {
        try {

            URL url = new URL("http://localhost:3002/RestWebserviceDemo/rest/json/product/dynamicData?size=5");//your url i.e fetch data from .
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setRequestProperty("Accept", "application/json");
            if (conn.getResponseCode() != 200) {
                throw new RuntimeException("Failed : HTTP Error code : "
                        + conn.getResponseCode());
            }
            InputStreamReader in = new InputStreamReader(conn.getInputStream());
            BufferedReader br = new BufferedReader(in);
            String output;
            while ((output = br.readLine()) != null) {
                System.out.println(output);
            }
            conn.disconnect();

        } catch (Exception e) {
            System.out.println("Exception in NetClientGet:- " + e);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-09-26T13:43:10.793

正如其他人所说，您可以使用较低级别的 HTTP API 来执行此操作，或者您可以使用较高级别的 JAXRS API 将服务作为 JSON 来使用。例如：

```
Client client = ClientBuilder.newClient();
WebTarget target = client.target("http://host:8080/context/rest/method");
JsonArray response = target.request(MediaType.APPLICATION_JSON).get(JsonArray.class); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-12-30T03:18:03.297

它只是 2 行代码。

```
import org.springframework.web.client.RestTemplate;

RestTemplate restTemplate = new RestTemplate();
YourBean obj = restTemplate.getForObject("http://gturnquist-quoters.cfapps.io/api/random", YourBean.class); 
```

[参考。Spring.io 消费-休息](http://spring.io/guides/gs/consuming-rest/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-07T14:41:46.360

下面的代码将有助于通过 Java 使用 rest api。 **URL** - 端点休息 如果您不需要任何身份验证，则不需要编写**authStringEnd**变量

该方法将返回带有您的响应的 JsonObject

```
public JSONObject getAllTypes() throws JSONException, IOException {
        String url = "/api/atlas/types";
        String authString = name + ":" + password;
        String authStringEnc = new BASE64Encoder().encode(authString.getBytes());
        javax.ws.rs.client.Client client = ClientBuilder.newClient();
        WebTarget webTarget = client.target(host + url);
        Invocation.Builder invocationBuilder = webTarget.request(MediaType.APPLICATION_JSON).header("Authorization", "Basic " + authStringEnc);

        Response response = invocationBuilder.get();
        String output = response.readEntity(String.class
        );

        System.out.println(response.toString());
        JSONObject obj = new JSONObject(output);

        return obj;
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-09T17:27:47.530

如果您还需要转换作为对服务调用的响应的 xml 字符串，您需要的 x 对象可以按如下方式进行：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.StringReader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import javax.xml.bind.JAXB;
import javax.xml.bind.JAXBException;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.w3c.dom.CharacterData;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.InputSource;
import org.xml.sax.SAXException;

public class RestServiceClient {

// http://localhost:8080/RESTfulExample/json/product/get
public static void main(String[] args) throws ParserConfigurationException,
SAXException {

try {

URL url = new URL(
    "http://localhost:8080/CustomerDB/webresources/co.com.mazf.ciudad");
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
conn.setRequestMethod("GET");
conn.setRequestProperty("Accept", "application/xml");

if (conn.getResponseCode() != 200) {
throw new RuntimeException("Failed : HTTP error code : "
    + conn.getResponseCode());
}

BufferedReader br = new BufferedReader(new InputStreamReader(
    (conn.getInputStream())));

String output;

Ciudades ciudades = new Ciudades();
System.out.println("Output from Server .... \n");
while ((output = br.readLine()) != null) {
System.out.println("12132312");
System.err.println(output);

DocumentBuilder db = DocumentBuilderFactory.newInstance()
    .newDocumentBuilder();
InputSource is = new InputSource();
is.setCharacterStream(new StringReader(output));

Document doc = db.parse(is);
NodeList nodes = ((org.w3c.dom.Document) doc)
    .getElementsByTagName("ciudad");

for (int i = 0; i < nodes.getLength(); i++) {
    Ciudad ciudad = new Ciudad();
    Element element = (Element) nodes.item(i);

    NodeList name = element.getElementsByTagName("idCiudad");
    Element element2 = (Element) name.item(0);

    ciudad.setIdCiudad(Integer
        .valueOf(getCharacterDataFromElement(element2)));

    NodeList title = element.getElementsByTagName("nomCiudad");
    element2 = (Element) title.item(0);

    ciudad.setNombre(getCharacterDataFromElement(element2));

    ciudades.getPartnerAccount().add(ciudad);
}
}

for (Ciudad ciudad1 : ciudades.getPartnerAccount()) {
System.out.println(ciudad1.getIdCiudad());
System.out.println(ciudad1.getNombre());
}

conn.disconnect();

} catch (MalformedURLException e) {
e.printStackTrace();
} catch (IOException e) {
e.printStackTrace();
}
}

public static String getCharacterDataFromElement(Element e) {
Node child = e.getFirstChild();
if (child instanceof CharacterData) {
CharacterData cd = (CharacterData) child;
return cd.getData();
}
return "";
}
} 
```

请注意，我在示例中预期的 xml 结构如下：

```
<ciudad><idCiudad>1</idCiudad><nomCiudad>BOGOTA</nomCiudad></ciudad> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-16T13:51:11.503

只需使用正确的查询字符串或请求正文向所需的 URL 发出 http 请求。

例如，您可以使用`java.net.HttpURLConnection`然后使用 via `connection.getInputStream()`，然后再使用您的对象。

在春天有一个`restTemplate`让这一切变得更容易的事情。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-16T13:51:29.293

看看[泽西岛](http://jersey.java.net/)。同样，REST 是关于数据的。还有一个教程[在这里](http://www.vogella.com/articles/REST/article.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-17T12:24:28.167

根据您的问题，不清楚您是否使用任何框架。对于 REST，您将获得 WADL 和 Apache CXF 最近添加了对 WADL 优先开发 REST 服务的支持。请通过[http://cxf.apache.org/docs /index.html](http://cxf.apache.org/docs/index.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-10-16T13:53:35.543

[JAX-RS](http://cxf.apache.org/docs/jax-rs.html)，但您也可以使用标准 Java 附带的常规 DOM

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-21T13:06:32.963

您可以使用 RestTemplate.class 在 Spring 中使用 Restful Web 服务。

例子 ：

```
public class Application {

    public static void main(String args[]) {
        RestTemplate restTemplate = new RestTemplate();
        ResponseEntity<String> call= restTemplate.getForEntity("http://localhost:8080/SpringExample/hello",String.class);
        System.out.println(call.getBody())
    }

} 
```

[参考](https://www.youtube.com/watch?v=LGjgU_pFynA)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-04T07:43:51.370

Apache Http Client API 非常常用于调用 HTTP Rest 服务。

这是使用 HTTP GET 调用的示例之一。

```
import java.io.IOException;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpUriRequest;
import org.apache.http.impl.client.HttpClientBuilder;

public class CallHTTPGetService {

public static void main(String[] args) throws ClientProtocolException, IOException {

    HttpClient client = HttpClientBuilder.create().build();
    HttpUriRequest httpUriRequest = new HttpGet("URL");

    HttpResponse response = client.execute(httpUriRequest);
    System.out.println(response);

}
} 
```

如果使用 Maven 项目，请使用以下 Maven 依赖项。

```
<dependency>
        <groupId>org.apache.httpcomponents</groupId>
        <artifactId>httpclient</artifactId>
        <version>4.5.1</version>
    </dependency>
    <!-- https://mvnrepository.com/artifact/org.apache.httpcomponents/httpmime -->
    <dependency>
        <groupId>org.apache.httpcomponents</groupId>
        <artifactId>httpmime</artifactId>
        <version>4.5.1</version>
    </dependency> 
```

# networking - 捕获 SYN 扫描的规则

> ID：12916171
> 
> 赞同：2
> 
> 时间：2012-10-16T13:48:14.130
> 
> 标签：networking, rules, snort

我需要编写一个捕获 SYN 扫描的规则。
我试过这个：`alert tcp any any -> any any (flags:S,12; msg:"SYN"; sid: 1231213;)`
然后尝试扫描：`nmap -sS myIP`但这不输出“SYN”
如何写一个正确的规则？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:14:43.327

尝试更改`flags:S,12`为[Snort 手册](http://manual.snort.org/node33.html#SECTION00468000000000000000)`flags:S`所述：

> 保留位“1”和“2”已分别替换为“C”和“E”，以匹配 RFC 3168，“将显式拥塞通知 (ECN) 添加到 IP”。'1' 和 '2' 的旧值对于 flag 关键字仍然有效，但现在已弃用。

因此`12`将检查是否设置了两个保留位，这可能不是您想要的。此外，据我了解，文档`flags:S`将匹配仅包含 SYN 集的数据包，我猜这在您的情况下应该是正确的。如果你想匹配一些标志而不考虑其他标志，你可以使用`*`.

# php - PHP 回合行为

> ID：12916172
> 
> 赞同：0
> 
> 时间：2012-10-16T13:48:14.320
> 
> 标签：php, floating-point, rounding

```
$r = 302 / 490;
printLn($r);
printLn(round($r, 2, PHP_ROUND_HALF_UP)); 
```

给

> 0.61632653061224484947189239392173476517200469970703125 0.619999999999999995555910790149937383830547332763671875

为什么不正常四舍五入到真正的 2 位数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T13:53:03.540

在浮点数的可测量精度范围内，显示的四舍五入为`0.62`。要了解为什么您没有得到确切`0.62`的 ，您需要了解浮点数是如何工作的。基本上，您可以取任何数量级高达 2 ^(53) -1 的整数并将其乘以 -1074 和 971（含）之间的任何 2 的幂。`0.62`不能以这种方式准确表示。

换句话说，你的`precision`INI设置太高了。请参阅[此键盘](http://codepad.viper-7.com/4LktQf)。尝试将其设置为更具代表性的数字，例如默认的 15。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:52:10.827

我使用**print**而不是**printLn**尝试了您的代码，这就是我得到的：

```
0.61632653061224
0.62 
```

您可以尝试使用 print 而不是 printLn（这是 Java 打印）来修改您的代码吗？

# memory-management - gfortran for dummies：mcmodel=medium 到底做了什么？

> ID：12916176
> 
> 赞同：19
> 
> 时间：2012-10-16T13:48:27.140
> 
> 标签：memory-management, fortran, x86-64, gfortran

我有一些代码在编译时给了我重定位错误，下面是一个说明问题的示例：

```
 program main
  common/baz/a,b,c
  real a,b,c
  b = 0.0
  call foo()
  print*, b
  end

  subroutine foo()
  common/baz/a,b,c
  real a,b,c

  integer, parameter :: nx = 450
  integer, parameter :: ny = 144
  integer, parameter :: nz = 144
  integer, parameter :: nf = 23*3
  real :: bar(nf,nx*ny*nz)

  !real, allocatable,dimension(:,:) :: bar
  !allocate(bar(nf,nx*ny*nz))

  bar = 1.0
  b = bar(12,32*138*42)

  return
  end 
```

用 编译它`gfortran -O3 -g -o test test.f`，我得到以下错误：

```
relocation truncated to fit: R_X86_64_PC32 against symbol `baz_' defined in COMMON section in /tmp/ccIkj6tt.o 
```

但如果我使用`gfortran -O3 -mcmodel=medium -g -o test test.f`. 另请注意，如果我使数组可分配并在子例程中分配它，它会起作用。

我的问题是具体`-mcmodel=medium`做什么？我的印象是代码的两个版本（一个有`allocatable`数组，一个没有）或多或少是等价的......

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-18T14:49:51.377

Since `bar` is quite large the compiler generates static allocation instead of automatic allocation on the stack. Static arrays are created with the `.comm` assembly directive which creates an allocation in the so-called COMMON section. Symbols from that section are gathered, same-named symbols are merged (reduced to one symbol request with size equal to the largest size requested) and then what is rest is mapped to the BSS (uninitialised data) section in most executable formats. With ELF executables the `.bss` section is located in the data segment, just before the data segment part of the heap (there is another heap part managed by anonymous memory mappings which does not reside in the data segment).

With the `small` memory model 32-bit addressing instructions are used to address symbols on x86_64\. This makes code smaller and also faster. Some assembly output when using `small` memory model:

```
movl    $bar.1535, %ebx    <---- Instruction length saving
...
movl    %eax, baz_+4(%rip) <---- Problem!!
...
.local  bar.1535
.comm   bar.1535,2575411200,32
...
.comm   baz_,12,16 
```

This uses a 32-bit move instruction (5 bytes long) to put the value of the `bar.1535` symbol (this value equals to the address of the symbol location) into the lower 32 bits of the `RBX` register (the upper 32 bits get zeroed). The `bar.1535` symbol itself is allocated using the `.comm` directive. Memory for the `baz` COMMON block is allocated afterwards. Because `bar.1535` is very large, `baz_` ends up more than 2 GiB from the start of the `.bss` section. This poses a problem in the second `movl` instruction since a non-32bit (signed) offset from `RIP` should be used to address the `b` variable where the value of `EAX` has to be moved into. This is only detected during link time. The assembler itself does not know the appropriate offset since it doesn't know what the value of the instruction pointer (`RIP`) would be (it depends on the absolute virtual address where the code is loaded and this is determined by the linker), so it simply puts an offset of `0` and then creates a relocation request of type `R_X86_64_PC32`. It instructs the linker to patch the value of `0` with the real offset value. But it cannot do that since the offset value would not fit inside a signed 32-bit integer and hence bails out.

With the `medium` memory model in place things look like this:

```
movabsq $bar.1535, %r10
...
movl    %eax, baz_+4(%rip)
...
.local  bar.1535
.largecomm      bar.1535,2575411200,32
...
.comm   baz_,12,16 
```

First a 64-bit immediate move instruction (10 bytes long) is used to put the 64-bit value which represents the address of `bar.1535` into register `R10`. Memory for the `bar.1535` symbol is allocated using the `.largecomm` directive and thus it ends in the `.lbss` section of the ELF exectuable. `.lbss` is used to store symbols which might not fit in the first 2 GiB (and hence should not be addressed using 32-bit instructions or RIP-relative addressing), while smaller things go to `.bss` (`baz_` is still allocated using `.comm` and not `.largecomm`). Since the `.lbss` section is placed after the `.bss` section in the ELF linker script, `baz_` would not end up being inaccessible using 32-bit RIP-related addressing.

All addressing modes are described in the [System V ABI: AMD64 Architecture Processor Supplement](http://www.x86-64.org/documentation/abi.pdf). It is a heavy technical reading but a must read for anybody who really wants to understand how 64-bit code works on most x86_64 Unixes.

When an `ALLOCATABLE` array is used instead, `gfortran` allocates heap memory (most likely implemented as an anonymous memory map given the large size of the allocation):

```
movl    $2575411200, %edi
...
call    malloc
movq    %rax, %rdi 
```

This is basically `RDI = malloc(2575411200)`. From then on elements of `bar` are accessed by using positive offsets from the value stored in `RDI`:

```
movl    51190040(%rdi), %eax
movl    %eax, baz_+4(%rip) 
```

For locations that are more than 2 GiB from the start of `bar`, a more elaborate method is used. E.g. to implement `b = bar(12,144*144*450)` `gfortran` emits:

```
; Some computations that leave the offset in RAX
movl    (%rdi,%rax), %eax
movl    %eax, baz_+4(%rip) 
```

This code is not affected by the memory model since nothing is assumed about the address where the dynamic allocation would be made. Also, since the array is not passed around, no descriptor is being built. If you add another function that takes an assumed-shaped array and pass `bar` to it, a descriptor for `bar` is created as an automatic variable (i.e. on the stack of `foo`). If the array is made static with the `SAVE` attribute, the descriptor is placed in the `.bss` section:

```
movl    $bar.1580, %edi
...
; RAX still holds the address of the allocated memory as returned by malloc
; Computations, computations
movl    -232(%rax,%rdx,4), %eax
movl    %eax, baz_+4(%rip) 
```

The first move prepares the argument of a function call (in my sample case `call boo(bar)` where `boo` has an interface that declares it as taking an assumed-shape array). It moves the address of the array descriptor of `bar` into `EDI`. This is a 32-bit immediate move so the descriptor is expected to be in the first 2 GiB. Indeed, it is allocated in the `.bss` in both `small` and `medium` memory models like this:

```
.local  bar.1580
.comm   bar.1580,72,32 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-16T14:37:24.457

`bar`不，如果您不使用大型静态数组（如您的`-mcmodel=medium`. 但是当然可以分配更好。对于可分配对象，只有数组描述符必须适合 2 GB，而不是整个数组。

来自 GCC 参考：

```
-mcmodel=small
Generate code for the small code model: the program and its symbols must be linked in the lower 2 GB of the address space. Pointers are 64 bits. Programs can be statically or dynamically linked. This is the default code model. 
-mcmodel=kernel
Generate code for the kernel code model. The kernel runs in the negative 2 GB of the address space. This model has to be used for Linux kernel code. 
-mcmodel=medium
Generate code for the medium model: The program is linked in the lower 2 GB of the address space but symbols can be located anywhere in the address space. Programs can be statically or dynamically linked, but building of shared libraries are not supported with the medium model. 
-mcmodel=large
Generate code for the large model: This model makes no assumptions about addresses and sizes of sections. Currently GCC does not implement this model. 
```

# javascript - 当另一个事件正在执行 jQuery 时“禁止”执行一个事件

> ID：12916177
> 
> 赞同：3
> 
> 时间：2012-10-16T13:48:27.297
> 
> 标签：javascript, jquery, events

我有两个事件：一个是`onclick`当我单击菜单时滚动到某个 div，另一个是`onscroll`当滚动靠近 div 时“突出显示”菜单项。

我的问题是：如何在另一个事件执行时“禁止”执行一个事件。

这是我的代码：

```
function goToByScroll(id){
  var value = $(id).offset().top;
  var scrl = value - 154;
  $('html,body').animate({
    scrollTop: scrl},
  'slow');  
} 

//scroll menu control
$("#menu-home ul li a").click(function(e) {
    e.preventDefault();
    $("#menu-home ul li a").removeClass('menu-home-active');
    $(this).addClass('menu-home-active');
    goToByScroll($(this).attr("href"));    
});

//scroll bar control
$(window).scroll(function() {
  var scrv = $(this).scrollTop();
  var allmenu = $("#menu-home ul li a");
  if(scrv == 0){
    allmenu.removeClass('menu-home-active');
    $('#menu-div1').addClass('menu-home-active');  
  }
  if(scrv > 458 && scrv < 478){
    allmenu.removeClass('menu-home-active');
    $('#menu-div2').addClass('menu-home-active');  
  }
  if(scrv > 989 && scrv < 1009){
    allmenu.removeClass('menu-home-active');
    $('#menu-div3').addClass('menu-home-active');  
  }
  if(scrv >= 1324){
    allmenu.removeClass('menu-home-active');
    $('#menu-div4').addClass('menu-home-active');  
  }
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T13:53:27.420

首先; 当滚动事件（或相反）时，单击事件不会触发。当您到达滚动事件时，点击事件已经完成。

您可能应该做的是在 click 事件上设置一个变量，如下所示：

```
function goToByScroll(id) {
    window.isAutoScrolling = true;
    var value = $(id).offset().top;
    var scrl = value - 154;
    $('html,body').animate({scrollTop: scrl}, 'slow', goToByScrollCompleted);
}
function goToByScrollCompleted() {
    window.isAutoScrolling = false;
} 
```

然后你添加到滚动事件的开始：

```
if(window.isAutoScrolling) return; 
```

另外，至于注册goToByScrollCompleted，这可能可以通过多种方式完成，但是，由于我不知道您如何进行滚动，所以我不能说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:52:56.233

您可以拥有全局布尔变量`lock`，检查它是否为假，如果是，请将其设置为真并执行您的函数。然后重置它。

# mongodb - 从 mongo shell 对所有数据库进行操作

> ID：12916183
> 
> 赞同：12
> 
> 时间：2012-10-16T13:48:56.873
> 
> 标签：mongodb

我们有一个包含许多不同 mongo 数据库的系统。我经常想编写适用于所有（或一部分）它们的临时查询，而无需先验知道那里有哪些数据库。

我可以`show dbs`，这将在视觉上打印一个列表，但有没有办法做类似的事情：

```
var db_list = listDatabases();

for (i = 0; i < db_list.length; i++) {
     do_something(db_list[i])
} 
```

我的问题`show dbs`是它没有捕获任何返回值，所以我不能对输出做任何有成效的事情。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-16T14:14:07.873

您可以`'listDatabases'`为此使用 admin 命令：

```
var db_list = db.adminCommand('listDatabases'); 
```

这将返回一个如下所示的对象：

```
{
    "databases" : [
        {
            "name" : "test",
            "sizeOnDisk" : 2097152000,
            "empty" : false
        },
        {
            "name" : "local",
            "sizeOnDisk" : 1,
            "empty" : true
        }
    ],
    "totalSize" : 8487174144,
    "ok" : 1
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-01T13:32:36.677

还有 getDBNames() （我喜欢 JohnnyHK 的答案如何获得大小。

```
d = db.getMongo().getDBNames()
[ "graylog2", "local", "admin", "test" ] 
```

然后我可以：

```
for (var x in d) { db = new Mongo().getDB(d[x]); print(db); y = print(db.getCollectionNames()); } 
```

# php - 如何在 Zend Framework 2 中包含外部库？

> ID：12916186
> 
> 赞同：9
> 
> 时间：2012-10-16T13:49:02.303
> 
> 标签：php, zend-framework2

我成功地使用了 zf2-tutorial，但是在尝试集成像“jpgraph”这样的外部库时我完全感到困惑。我知道我必须使用 autoload 或 servicemanager 执行此操作，但它不起作用。jpgraph 的 php 文件位于 vendor/graph 目录中。我在控制器 indexAction 中使用了一个名为 Jpgraph 的模块，我尝试：

```
$graph = new Graph($width,$height); 
```

这给了我一个错误：

```
Fatal error: Class 'Jpgraph\Controller\Graph' not found in ... 
```

**jpgraph 库不使用命名空间。**

[我也尝试过这种方式但没有成功](https://stackoverflow.com/questions/8026375/zend-framework-2-library-paths)

整合这些东西的最佳方法是什么？

我会很高兴每一个提示或帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T18:18:28.473

Add the library to your composer.json and add the class with Classmap and/or the include path as phpunit does

[https://github.com/sebastianbergmann/phpunit/blob/master/composer.json#L48](https://github.com/sebastianbergmann/phpunit/blob/master/composer.json#L48)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T22:15:41.443

正如 Maks3w 指出的那样，一种选择是使用[Composer](http://getcomposer.org/)。如果您之前从未听说过或使用过 composer，那么绝对值得一看。我很惊讶设置和使用 3rd 方库是多么容易。设置您自己的库以与 composer 一起使用也很容易，并使用您自己的任何源代码控制（git 或 svn）库 - 与 GitHub repos 一起使用 - 只需添加一个 composer.json 文件。

另一方面，你不需要使用作曲家来做你想做的事，它会很容易，但它可能有点矫枉过正。Zend Framework 2 有一个非常灵活的自动加载系统，虽然它与[PSR-0](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)配合得很好，但你可以拥有任何你喜欢的类自动加载系统。看看[Zend\Loader](http://framework.zend.com/manual/2.0/en/index.html#zend-loader)的不同组件，特别是我认为[ClassMapAutoloader](http://framework.zend.com/manual/2.0/en/modules/zend.loader.class-map-autoloader.html)将是满足您需求的组件。

# elasticsearch - 弹性搜索 - 查询不会执行

> ID：12916188
> 
> 赞同：4
> 
> 时间：2012-10-16T13:49:14.507
> 
> 标签：elasticsearch

在简要阅读了弹性搜索教程之后，我正在尝试使以下查询工作一段时间：

```
{
"query" :
{ 
    "size" : "10",
    "query" : {
        "bool" : {
            "must" : {
                "custom_score" : {
                    "query" : {
                        "text" : { "phrase" : {"query" : "iphone4", "type" : "phrase_prefix"}}
                    },
                    "params" : {
                            "param1" : 1000
                     },
                    "script" : "_score * param1 "
                }
            },
            "should" : [{ 
                "custom_score" : {
                    "query" : { "match_all" : {}},
                    "params" : {
                            "param2" : 0.001
                     },
                    "script" : "_score * doc['matches'].value * param2 "
                }
            },{
                "custom_score" : {
                    "query" : {"match_all" : {}},
                    "params" : {
                            "param3" : 0.001
                     },
                    "script" : "_score * doc['hits'].value * param3 "
                }
            }]

        }
    }
}
} 
```

当我尝试运行它时，我收到以下错误：

```
{
    "error": "SearchPhaseExecutionException[Failed to execute phase [query], total failure; shardFailures {[jJz-l-ENSV-0inWp2Sf8Bw][searches][2]: SearchParseException[[searches][2]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\n\"query\" :\n{ \n \t\"size\" : \"10\",\n \t\"query\" : {\n\t\t\"bool\" : {\n\t\t\t\"must\" : {\n\t\t\t\t\"custom_score\" : {\n\t\t\t\t\t\"query\" : {\n\t\t\t\t\t\t\"text\" : { \"phrase\" : {\"query\" : \"iphone4\", \"type\" : \"phrase_prefix\"}}\n\t\t\t\t\t},\n\t\t\t\t\t\"params\" : {\n        \t\t\t\t\t\"param1\" : 1000\n   \t\t\t\t\t },\n\t\t\t\t\t\"script\" : \"_score * param1 \"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"should\" : [{ \n\t\t\t\t\"custom_score\" : {\n\t\t\t\t\t\"query\" : { \"match_all\" : {}},\n\t\t\t\t\t\"params\" : {\n        \t\t\t\t\t\"param2\" : 0.001\n   \t\t\t\t\t },\n\t\t\t\t\t\"script\" : \"_score * doc['matches'].value * param2 \"\n\t\t\t\t}\n\t\t\t},{\n\t\t\t\t\"custom_score\" : {\n\t\t\t\t\t\"query\" : {\"match_all\" : {}},\n\t\t\t\t\t\"params\" : {\n        \t\t\t\t\t\"param3\" : 0.001\n   \t\t\t\t\t },\n\t\t\t\t\t\"script\" : \"_score * doc['hits'].value * param3 \"\n\t\t\t\t}\n\t\t\t}]\n\t     \t\n\t\t}\n\t}\n}\n}]]]; nested: QueryParsingException[[searches] [_na] query malformed, no field after start_object]; }{[jJz-l-ENSV-0inWp2Sf8Bw][searches][4]: SearchParseException[[searches][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\n\"query\" :\n{ \n \t\"size\" : \"10\",\n \t\"query\" : {\n\t\t\"bool\" : {\n\t\t\t\"must\" : {\n\t\t\t\t\"custom_score\" : {\n\t\t\t\t\t\"query\" : {\n\t\t\t\t\t\t\"text\" : { \"phrase\" : {\"query\" : \"iphone4\", \"type\" : \"phrase_prefix\"}}\n\t\t\t\t\t},\n\t\t\t\t\t\"params\" : {\n        \t\t\t\t\t\"param1\" : 1000\n   \t\t\t\t\t },\n\t\t\t\t\t\"script\" : \"_score * param1 \"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"should\" : [{ \n\t\t\t\t\"custom_score\" : {\n\t\t\t\t\t\"query\" : { \"match_all\" : {}},\n\t\t\t\t\t\"params\" : {\n        \t\t\t\t\t\"param2\" : 0.001\n   \t\t\t\t\t },\n\t\t\t\t\t\"script\" : \"_score * doc['matches'].value * param2 \"\n\t\t\t\t}\n\t\t\t},{\n\t\t\t\t\"custom_score\" : {\n\t\t\t\t\t\"query\" : {\"match_all\" : {}},\n\t\t\t\t\t\"params\" : {\n        \t\t\t\t\t\"param3\" : 0.001\n   \t\t\t\t\t },\n\t\t\t\t\t\"script\" : \"_score * doc['hits'].value * param3 \"\n\t\t\t\t}\n\t\t\t}]\n\t     \t\n\t\t}\n\t}\n}\n}]]]; nested: QueryParsingException[[searches] [_na] query malformed, no field after start_object]; }]",
    "status": 500
} 
```

你觉得我的错在哪里？关于我应该如何进行的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:08:54.057

您需要将嵌套查询与外部查询“合并”。试试这个：

```
{
    "query" : { 
        "bool" : {
            "must" : {
                "custom_score" : {
                    "query" : {
                        "text" : { "phrase" : {"query" : "iphone4", "type" : "phrase_prefix"}}
                    },
                    "params" : {
                            "param1" : 1000
                     },
                    "script" : "_score * param1 "
                }
            },
            "should" : [{ 
                "custom_score" : {
                    "query" : { "match_all" : {}},
                    "params" : {
                            "param2" : 0.001
                     },
                    "script" : "_score * doc['matches'].value * param2 "
                }
            },{
                "custom_score" : {
                    "query" : {"match_all" : {}},
                    "params" : {
                            "param3" : 0.001
                     },
                    "script" : "_score * doc['hits'].value * param3 "
                }
            }]

        }
    },
    "size" : "10"
} 
```

如果您使用 curl 运行它，您可能还需要替换`'`为`'\''`

# r - 在R中向后历史搜索

> ID：12916189
> 
> 赞同：9
> 
> 时间：2012-10-16T13:49:14.813
> 
> 标签：r

通常在我的机器中，我可以通过键入我想要向后搜索的命令的所需第一个字符来向后搜索 R 的历史记录，然后使用 PageUp 或 PageDown 键浏览 R 历史记录中的所有条目。

我现在在远程集群中以访客身份工作，此选项在这台机器上不可用。

有谁知道我可以在哪里将此功能添加到 R 中？

编辑：我对键绑定感兴趣，而不是如何重现此功能。

EDIT2：我在本地的 Fedora 16 机器上；远程 CentOS release 5.3 (Final)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T15:30:58.117

```
history(pattern="lm\\(")   # finds lines with lm or glm calls 
```

有多种历史记录机制，您的控制台正在查看的内容可能与历史记录调用将访问的内容不同。阅读“历史”页面的详细信息部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T12:15:58.513

我找到了在哪里看以便告诉 R 如何表现。

关键是修改我的 ~/.inputrc 文件，因为它是 R 输入法的参考。

我使用本地 Fedora 16 /etc/inputrc 中的相同文件并将其作为 ~/.inputrc 复制到远程集群中。文件看起来像这样

```
# do not bell on tab-completion
#set bell-style none

set meta-flag on
set input-meta on
set convert-meta off
set output-meta on

# Completed names which are symbolic links to
# directories have a slash appended.
set mark-symlinked-directories on

$if mode=emacs

# for linux console and RH/Debian xterm
"\e[1~": beginning-of-line
"\e[4~": end-of-line
# commented out keymappings for pgup/pgdown to reach begin/end of history
#"\e[5~": beginning-of-history
#"\e[6~": end-of-history
"\e[5~": history-search-backward
"\e[6~": history-search-forward
"\e[3~": delete-char
"\e[2~": quoted-insert
"\e[5C": forward-word
"\e[5D": backward-word
"\e[1;5C": forward-word
"\e[1;5D": backward-word

# for rxvt
"\e[8~": end-of-line
"\eOc": forward-word
"\eOd": backward-word

# for non RH/Debian xterm, can't hurt for RH/DEbian xterm
"\eOH": beginning-of-line
"\eOF": end-of-line

# for freebsd console
"\e[H": beginning-of-line
"\e[F": end-of-line
$endif 
```

# c++ - 在 C/C++ 中有效使用文件描述符

> ID：12916191
> 
> 赞同：1
> 
> 时间：2012-10-16T13:49:18.117
> 
> 标签：c++, file-descriptor

我正在使用 C++ 从我的客户端系统备份文件。每一秒，文件都从我的客户端机器中涌入，我必须为每个文件获取文件描述符以写入服务器。有时我在一分钟内甚至可以得到 10K 个文件，那么我如何才能真正利用文件描述符来有效地写入多个文件。

我有一个 C++ 套接字侦听器，每台客户端机器都连接到服务器并开始上传文件。是否可以使用有限的文件描述符编写多个文件。我已经尝试将所有文​​件写入一个大文件，但我已经跟踪了文件的结尾和我写入的每个文件的大文件中的开始字节。那将是一项工作.

我希望能够编写高性能的文件并保持磁盘安全。有什么想法可以分享..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:54:33.020

看来您应该将请求排队。

这样，您可以让有限数量的工作人员（例如 16 个，具体取决于系统上的硬件）来实际传输文件，并让其余工作人员等待。

这可能会提高吞吐量和性能，因为

*   它消除了线程调度开销
*   它消除了资源瓶颈（fd + 缓冲区分配）
*   它不会同时命中磁盘（在老式硬件上（即最常旋转磁盘），如果您导致重复磁盘寻道，这可能会导致性能严重下降。

    *   免责声明：您的文件系统/操作系统可以通过重新安排磁盘写入（电梯/完全公平排队和其他算法）来共同限制/减少这种影响。
    *   无论如何，在将顺序上传写入共享卷时，通常带宽使用将是最佳的

        ```
        sum(upload rates) ~= effective disk write bandwitdh 
        ```

关于排队：

*   查看操作系统的函数`backlog`参数`listen`
*   查看[生产者/消费者](http://en.wikipedia.org/wiki/Producer-consumer_problem)实现

    另请参阅C++或其他搜索引擎[中的消费者/生产者](https://stackoverflow.com/questions/9396279/consumer-producer-in-c)

# java - 如何知道 JScrollBar 是否已到达 JScrollPane 的底部？

> ID：12916192
> 
> 赞同：7
> 
> 时间：2012-10-16T13:49:20.333
> 
> 标签：java, swing, jscrollpane, jscrollbar

我想知道是否有办法知道 a `JScrollBar`（在我的情况下是垂直的）何时到达他的容器底部`JScrollPane`。

起初我虽然`AdjustmentListener`在滚动条上使用了 ，但我不知道如何`value`解释`JScrollBar`. 此外，我不确定是否正确理解`maximum`代表什么以及是否可以使用该值来获取我需要的信息。

**编辑**：

```
scrollPane.getVerticalScrollBar().addAdjustmentListener(new AdjustmentListener() {
    @Override
    public void adjustmentValueChanged(AdjustmentEvent ae) {
        System.out.println("Value: " + scrollPane.getVerticalScrollBar().getValue() + " Max: " + scrollPane.getVerticalScrollBar().getMaximum());
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T14:12:35.593

您必须将滚动条的范围添加到计算中。我在下面的示例中将代码添加到您的代码中。

```
scrollPane.getVerticalScrollBar().addAdjustmentListener(new AdjustmentListener() {
    @Override
    public void adjustmentValueChanged(AdjustmentEvent ae) {
        int extent = scrollPane.getVerticalScrollBar().getModel().getExtent();
        System.out.println("Value: " + (scrollPane.getVerticalScrollBar().getValue()+extent) + " Max: " + scrollPane.getVerticalScrollBar().getMaximum());
    }
}); 
```

**两种替代实现（部分响应 Kleopatra）**

```
scrollPane.getVerticalScrollBar().addAdjustmentListener(new AdjustmentListener() {

    @Override
    public void adjustmentValueChanged(AdjustmentEvent event) {
        JScrollBar scrollBar = (JScrollBar) event.getAdjustable();
        int extent = scrollBar.getModel().getExtent();
        System.out.println("1\. Value: " + (scrollBar.getValue() + extent) + " Max: " + scrollBar.getMaximum());

    }
}); 
```

或通过模型

```
scrollPane.getVerticalScrollBar().getModel().addChangeListener(new ChangeListener() {

    @Override
    public void stateChanged(ChangeEvent event) {
        BoundedRangeModel model = (BoundedRangeModel) event.getSource();
        int extent = model.getExtent();
        int maximum = model.getMaximum();
        int value = model.getValue();

        System.out.println("2\. Value: " + (value + extent) + " Max: " + maximum);

    }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-17T14:11:55.747

@StanislavL 几乎得到了正确答案。

试试`scrollBar.getValue() == scrollBar.getMaximum() - scrollBar.getVisibleAmount()`。

要了解为什么`getVisibleAmount()`需要调用，您必须首先了解 JScrollBars 是如何工作的。JScrollBar 有 4 个值：最小值、最大值、值和范围。`value`是滚动句柄本身的顶部，是滚动句柄`extent`的有效长度。`value`除非滚动句柄的长度为 0，否则永远不会相等`maximum`。为了补偿，我们必须通过减去滚动句柄的长度来调整我们比较的值以获得有效的最大值。

[此处](http://docs.oracle.com/javase/7/docs/api/javax/swing/JScrollBar.html#getMaximum())记录了此效果，这会误导性地使它听起来像是`getMaximum()`在按应有的方式调整值，但仔细观察[JScrollBar 的实现会](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7u40-b43/javax/swing/JScrollBar.java#JScrollBar.getMaximum%28%29)发现，它`getMaximum()`实际上给了我们真正的最大值，而不是有效的最大值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:13:05.873

通过使用 JScrollPane 的视口，您可以计算视口是否正在查看组件的末尾。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ViewPortDemo extends JPanel{

    public ViewPortDemo(){
        super();
        JTree tree = new JTree();
        for(int i =0; i < tree.getRowCount(); i++){
            tree.expandRow(i);
        }

        final JScrollPane pane = new JScrollPane(tree){
            Dimension prefSize = new Dimension(200,150);
            public Dimension getPreferredSize(){
                return prefSize;
            }
        };

        pane.getVerticalScrollBar().addAdjustmentListener(new AdjustmentListener() {

            @Override
            public void adjustmentValueChanged(AdjustmentEvent e) {
                JViewport vp = pane.getViewport();
                if(vp.getView().getHeight() <= vp.getHeight() + vp.getViewPosition().y){
                    System.out.println("End");
                }
            }
        });

        add(pane);
    }

    public static void main(String[] args){
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new ViewPortDemo());
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-16T13:58:16.537

```
scrollBar.getValue()==scrollBar.getMaximum() 
```

# android - 杀死 Android 应用程序中的活动后出现对话框错误

> ID：12916195
> 
> 赞同：0
> 
> 时间：2012-10-16T13:49:24.257
> 
> 标签：android, multithreading, android-activity, dialog

我在 Activity example.activity.SetupManage 中。经过一些操作后，我调用了一个显示通知消息的对话框。但即使我不点击 OK 按钮，所有后续代码都会执行，所以当我杀死所有 Activity 时，对话框会产生问题。我能做些什么来解决我的问题？

```
 AlertDialog myAlertDialog;
    public void onDestroy(Bundle savedInstanceState){

    if(myAlertDialog.isShowing())
        myAlertDialog.dismiss();
}
  // *** some operations *** //
  try{
        myAlertDialog = new AlertDialog.Builder(this)
        .setTitle("Notification")
        .setMessage("Operation Failed")
        .setPositiveButton("OK", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {

        }
    })
    .show();

    }
    catch(Exception ex){

    }

    try{
    Intent myIntent = new Intent();
    myIntent.setClassName("example.activity", "example.activity.MainActivity");
    myIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP|
            Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(myIntent);
    }catch(Exception ex){

    } 
```

错误信息：

```
 10-16 15:33:11.120: E/WindowManager(4360): Activity example.activity.SetupManage has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@415ca638 that was originally added here
   10-16 15:33:11.120: E/WindowManager(4360):   at example.activity.SetupManage.CleanDatabase(SetupManage.java:61)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.view.ViewRoot.<init>(ViewRoot.java:288)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:249)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:193)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:118)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.view.Window$LocalWindowManager.addView(Window.java:532)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.app.Dialog.show(Dialog.java:269)
   10-16 15:33:11.120: E/WindowManager(4360):   at android.app.AlertDialog$Builder.show(AlertDialog.java:907)
   10-16 15:33:11.120: E/WindowManager(4360):   at example.activity.SetupManage.CleanDatabase(SetupManage.java:61) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:12:54.547

它继续执行，因为这就是你告诉它要做的事情。如果您希望在关闭对话框时执行代码，请将其放在`onClick`对话框按钮中，或者`onDismiss`如果可用。

更重要的是，为什么首先会出现这些`onDestroy()`？放置对话框（或 99.8% 的时间调用另一个活动的意图）似乎是一个非常糟糕的地方。您将永远无法看到它，该活动现在正在被*破坏*。我建议重新考虑您的程序流程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T11:04:31.213

```
Replace this code , it can help you...pass getApplication context 

 try{
        myAlertDialog = new AlertDialog.Builder(getApplicationContext() )
        .setTitle("Notification")
        .setMessage("Operation Failed")
        .setPositiveButton("OK", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {

        }
    })
    .show();

    }
    catch(Exception ex){

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:51:53.223

将 AlertDialog 保存到变量中：

myAlertDialog=new AlertDialog.Builder(这个).....

在 onPause() 方法中，如果对话框处于活动状态，您应该关闭它！

# google-maps - 谷歌地图 API V2 2013 年 5 月

> ID：12916196
> 
> 赞同：1
> 
> 时间：2012-10-16T13:49:27.623
> 
> 标签：google-maps

> **可能重复：**
> [Google Maps API Ver2 已退役？](https://stackoverflow.com/questions/12180774/google-maps-api-ver2-retired)

有谁知道 2013 年 5 月 19 日 Google Maps V2 api 会发生什么？它会停止工作吗？所有使用 V2 api 的应用程序都会停止工作吗？

# silverlight-4.0 - 使用 Prism 进行导航时如何创建视图/视图模型的新实例

> ID：12916197
> 
> 赞同：1
> 
> 时间：2012-10-16T13:49:28.027
> 
> 标签：silverlight-4.0, prism, prism-4

我试图控制何时创建新视图以及何时显示现有视图。

这是 Prism 文档中“导航到现有视图”部分中概述的非常相似的场景，但我无法让它完全工作：http: [//msdn.microsoft.com/en-us/library/gg430861 (v=pandp.40).aspx](http://msdn.microsoft.com/en-us/library/gg430861(v=pandp.40).aspx)

我发现我可以从 ok 开始创建视图/视图模型，但是我无法创建它的新实例。即我希望同时存在多个实例。

这是视图模型的示例：

```
[Export]
[PartCreationPolicy(CreationPolicy.NonShared)]
public class DataEntryPageViewModel : INavigationAware, IRegionMemberLifetime
{
    private Guid id;

    [ImportingConstructor]
    public DataEntryPageViewModel()
    {
        id = Guid.NewGuid();
    }

    public bool IsNavigationTarget(NavigationContext navigationContext)
    {
        // In actual fact there would be more logic here to determine
        // whether this should be shown to the user
        return false;
    }

    public void OnNavigatedFrom(NavigationContext navigationContext)
    {
    }

    public void OnNavigatedTo(NavigationContext navigationContext)
    {
    }

    public bool KeepAlive
    {
        // For the purposes of this example we don't want the view or the viewModel
        // to be disposed of.
        get { return true; }
    }
} 
```

我正在按如下方式导航到此：

```
m_RegionManager.RequestNavigate(
               "MainRegion",
               new Uri("/DataEntryPageView", UriKind.Relative)); 
```

所以我第一次调用上面的视图时会显示出来。

下次我调用 RequestNavigate 时，IsNavigationTarget 被命中，它返回 false。然后我希望它做的是创建一个新实例，但这并没有发生。我知道它没有发生，因为构造函数没有被命中并且 UI 没有更新以显示视图的新实例。

有什么想法可以让它创建一个新实例吗？

非常感谢，

保罗

**编辑**

我注意到第二次调用 RequestNavigate（请求同一视图的另一个实例）时，回调报告错误“视图已存在于区域中”。因此，似乎我可以在一个区域中拥有多个不同视图的实例，但不能拥有同一视图的多个实例。我对此的理解不是很好，所以我可能是错的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T04:01:49.437

当您想要创建一个新视图时，为什么不创建视图？在我看来，您正在使用 MEF。

1.  使用容器来解析视图的新实例
2.  将视图的新实例添加到 MainRegion
3.  然后调用 Navigate 并在 IsNavigationTarget 中处理相应的逻辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T07:48:51.763

您应该`[Export]`在视图中使用带有合同名称的属性：`[Export("DataEntryPageView")]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T08:55:39.280

我现在能够让它工作，这是因为我没有

```
[PartCreationPolicy(CreationPolicy.NonShared)] 
```

在视图的类声明上。我在 ViewModel 上有它。

所以这现在导致了我预期的行为。

感谢 Zabavsky 和 ​​Alan 的建议。

# java - 如何使用注释扩展 org.simpleframework.xml，将注释写入生成的 XML

> ID：12916198
> 
> 赞同：3
> 
> 时间：2012-10-16T13:49:31.897
> 
> 标签：java, xml, serialization, simple-framework

我正在使用 org.simpleframework.xml (http://simple.sourceforge.net/) 将 Java 对象序列化为 XML。

我想添加的是基于 Java 对象中的注释在生成的 XML 中添加注释区域。

因此，例如，我想编写一些 Java 对象，例如：

```
@Root(name = "myclass")
public class MyClass {
  @Element(required=true)
  @Version(revision=1.1)
  @Comment(text=This Element is new since, version 1.1, it is a MD5 encrypted value)
  private String activateHash;
} 
```

生成的 xml 如下所示：

```
<myclass version="1.1">
  <!-- This Element is new since, version 1.1, it is a MD5 encrypted value -->
  <activateHash>129831923131s3jjs3s3jjk93jk1</activateHash>
</myclass> 
```

他们的文档中有一个关于如何编写访问者的示例，该访问者将在 xml 中编写评论：http: [//simple.sourceforge.net/download/stream/doc/tutorial/tutorial.php#intercept](http://simple.sourceforge.net/download/stream/doc/tutorial/tutorial.php#intercept)

但是：我如何才能将访客附加到策略？

此外，simpleframework 的访问者概念不允许访问原始解析类。在访问者中，只有一种方法可以覆盖：

```
public void write(Type type, NodeMap<OutputNode> node) { ... } 
```

=> OutputNode 没有让我有机会阅读我正在解析的元素的注释。那么应该如何访问属性的注释。

谢谢！

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T16:54:36.800

截至 2012 年 11 月 5 日的更新：

org.simpleframework.xml 的作者回答：这行得通

[https://simple.svn.sourceforge.net/svnroot/simple/trunk/download/stream/src/test/java/org/simpleframework/xml/strategy/CommentTest.java](https://simple.svn.sourceforge.net/svnroot/simple/trunk/download/stream/src/test/java/org/simpleframework/xml/strategy/CommentTest.java)

```
package org.simpleframework.xml.strategy;

import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

import org.simpleframework.xml.Default;
import org.simpleframework.xml.Root;
import org.simpleframework.xml.ValidationTestCase;
import org.simpleframework.xml.core.Persister;
import org.simpleframework.xml.stream.InputNode;
import org.simpleframework.xml.stream.NodeMap;
import org.simpleframework.xml.stream.OutputNode;

public class CommentTest extends ValidationTestCase {

   @Retention(RetentionPolicy.RUNTIME)
   private static @interface Comment {
      public String value();
   }

   @Root
   @Default
   private static class CommentExample {
      @Comment("This represents the name value")
      private String name;
      @Comment("This is a value to be used")
      private String value;
      @Comment("Yet another comment")
      private Double price;
   }

   private static class CommentVisitor implements Visitor {
      public void read(Type type, NodeMap<InputNode> node) throws Exception {}
      public void write(Type type, NodeMap<OutputNode> node) throws Exception {
         if(!node.getNode().isRoot()) {
            Comment comment = type.getAnnotation(Comment.class);
            if(comment != null) {
               node.getNode().setComment(comment.value());
            }
         }
      }
   }

   public void testComment() throws Exception {
      Visitor visitor = new CommentVisitor();
      Strategy strategy = new VisitorStrategy(visitor);
      Persister persister = new Persister(strategy);
      CommentExample example = new CommentExample();

      example.name = "Some Name";
      example.value = "A value to use";
      example.price = 9.99;

      persister.write(example, System.out);
   }

} 
```

更新于 2012-11-01 20:16

这是似乎达到预期效果的解决方法 - 必要的 FieldHelper 在（[Get the value of a field, given the hierarchy path](https://stackoverflow.com/questions/12999214/get-the-value-of-a-field-given-the-hierarchical-path)）中描述

```
 /**
     * write according to this visitor
     */
    public void write(Type type, NodeMap<OutputNode> node) {
        OutputNode element = node.getNode();
        Class ctype = type.getType();

        String comment = ctype.getName();
        if (!element.isRoot()) {
            FieldHelper fh = new FieldHelper();
            element.setComment(comment);
            try {
                if (type.getClass().getSimpleName().startsWith("Override")) {
                    type = (Type) fh.getFieldValue(type, "type");
                }
                if (type.getClass().getSimpleName().startsWith("Field")) {
                    Field field = (Field) fh.getFieldValue(type, "field");
                    System.out.println(field.getName());
                    Comment commentAnnotation = field.getAnnotation(Comment.class);
                    if (commentAnnotation != null) {
                        element.setComment(commentAnnotation.value());
                    }
                }
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    } 
```

这是我在这方面取得的进展。不幸的是，它没有按预期工作。我已经给 Simpleframwork for XML 的作者写了一封电子邮件。

```
 /**
  * write according to this visitor
  */
    public void write(Type type, NodeMap<OutputNode> node) {
        OutputNode element = node.getNode();
        Class ctype = type.getType();

        String comment = ctype.getName();
        if (!element.isRoot()) {
            Comment commentAnnotation = type.getAnnotation(Comment.class);
            if (commentAnnotation!=null)
                element.setComment(commentAnnotation.value());
            else
                element.setComment(comment);
        }
    }

    @Override
    public void read(Type type, NodeMap<InputNode> nodeMap) throws Exception {

    }

} 
```

我这样声明了 Comment 注释：

```
package com.bitplan.storage.simplexml;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import java.lang.annotation.ElementType;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
public @interface Comment {
String value();
} 
```

然后可以像这样使用：

```
@Comment("this is the unique identifier")
private long id; 
```

可以像这样添加访客：

```
/**
 * get Serializer
 * 
 * @return
 */
public Serializer getSerializer() {
    Serializer serializer = null;
    Strategy strategy=null;
    VisitorStrategy vstrategy=null;
    if ((idname != null) && (refname != null)) {
        strategy = new CycleStrategy(idname, refname);
    }
    CommentVisitor cv=new CommentVisitor();
    if (strategy==null) {
        vstrategy=new VisitorStrategy(cv);
    } else {
        vstrategy=new VisitorStrategy(cv,strategy);
    }       
    serializer = new Persister(vstrategy);
    return serializer;
} 
```

# c# - Directory.GetCurrentDirectory() 在 Linux 上不起作用？

> ID：12916204
> 
> 赞同：8
> 
> 时间：2012-10-16T13:49:55.703
> 
> 标签：c#, linux, mono

因此，我正在尝试创建一个需要读取名为“scripts”的子文件夹中的脚本的应用程序。我的代码有问题：

```
string script = Console.ReadLine();
string path = Directory.GetCurrentDirectory();
string sciptpath  = path + "/scripts/" + script; 
```

这在 Windows 上运行良好。但在 Linux（使用 Mono Runtime 运行）上，它会转到当前用户的主目录……而不是可执行文件的目录。这是一个错误吗？有人可以提出解决方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T13:54:25.423

并不是说它需要“修复”，而是当前目录不是您认为的那样。当前目录是相对路径“具有焦点”的目录。无论您的 EXE 在哪里，您的当前目录都可以在其他任何地方，甚至可能在执行期间发生变化。

你想要的是：

```
string path = Path.GetDirectoryName(Application.ExecutablePath); 
```

# postgresql - 如何在postgres sql中对不规则的字母数字数据进行排序

> ID：12916212
> 
> 赞同：2
> 
> 时间：2012-10-16T13:50:06.103
> 
> 标签：postgresql, natural-sort

对于示例表的特定列符号，我有以下示例数据。

（更新：）数据不是常规模式。数字可以出现在字符之间的任何位置。

```
symbol

COL4A1
COL4A3
COL8A2
COL2A1
COL12A1
COL12A1
COL16A1
COL19A1 
```

我需要在数据库级别对这些数据进行排序。我使用了以下查询：

```
select symbol from sample order by symbol asc 
```

结果如下：

```
COL12A1
COL12A1
COL16A1
COL19A1
COL2A1
COL4A1
COL4A3
COL8A2 
```

但我需要通过以下方式获取订单：

```
COL2A1
COL4A1
COL4A3
COL8A2
COL12A1
COL12A1
COL16A1
COL19A1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:00:32.227

PostgreSQL 不提供可以执行“人性化”排序的数字感知排序规则，例如“1A、2A、3A、... 10A、11A、...”。它依赖于操作系统进行排序，我不知道有任何操作系统会向应用程序公开这种排序规则。

为此，您需要根据模式和模式部分的顺序拆分文本，可能使用[`regexp_matches`](http://www.postgresql.org/docs/current/static/functions-matching.html).

```
CREATE TABLE Table1 ("symbol" text);
INSERT INTO Table1 ("symbol") VALUES
    ('COL4A1'),('COL4A3'),('COL8A2'),('COL2A1'),
    ('COL12A1'),('COL12A1'),('COL16A1'),('COL19A1');

WITH matched(symbol, symbol_parts) AS (
  SELECT symbol, regexp_matches(symbol, '(\D*)(\d+)(\D+)(\d+)')
  FROM Table1
)
SELECT symbol 
FROM matched
ORDER BY symbol_parts[1], symbol_parts[2]::integer,
         symbol_parts[3], symbol_parts[4]::integer; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T08:57:12.520

```
CREATE OR REPLACE FUNCTION pad_numbers(text)
              RETURNS text AS
            $BODY$
                SELECT regexp_replace(
                regexp_replace(
                  regexp_replace(
                    regexp_replace(
                      $1, 
                      E'(^|\\D)(\\d{1,3}($|\\D))', E'\\1000\\2', 'g'
                    ), E'(^|\\D)(\\d{4,6}($|\\D))', E'\\1000\\2', 'g'
                  ), E'(^|\\D)(\\d{7}($|\\D))', E'\\100\\2', 'g'
                ), E'(^|\\D)(\\d{8}($|\\D))', E'\\10\\2', 'g'
              );
            $BODY$
              LANGUAGE 'sql' VOLATILE;

select symbol from sample order by pad_numbers(symbol) asc 
```

# java - 在android中收到消息时应该更改图像

> ID：12916213
> 
> 赞同：2
> 
> 时间：2012-10-16T13:50:08.853
> 
> 标签：java, android, events

```
 package com.example.nhx;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.gsm.SmsMessage;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.Toast;

public class SmsReceiver extends BroadcastReceiver {
    ImageView imageView1;
    ImageView imageView2;
    Button ON, OFF;
    String msg = "";

    @Override
    public void onReceive(Context context, Intent intent) {
        // ---get the SMS message passed in---

        if (msg.contains("LED ON")) {
            Toast.makeText(context, "HELLO WORLD", Toast.LENGTH_SHORT).show();
        }

        if (msg.contains("LED OFF")) {
            Toast.makeText(context, "HELLO", Toast.LENGTH_SHORT).show();
        }

        if (msg == "LED ON") {

            imageView1.setVisibility(imageView1.VISIBLE);
            imageView2.setVisibility(imageView2.INVISIBLE);

        }

        if (msg == "LED OFF") {
            imageView2.setVisibility(imageView2.VISIBLE);
            imageView1.setVisibility(imageView1.INVISIBLE);
        }
        Bundle bundle = intent.getExtras();
        SmsMessage[] msgs = null;
        String str = "";
        if (bundle != null) {
            // ---retrieve the SMS message received---
            Object[] pdus = (Object[]) bundle.get("pdus");
            msgs = new SmsMessage[pdus.length];
            for (int i = 0; i < msgs.length; i++) {
                msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);
                // str += "SMS from " + msgs[i].getOriginatingAddress();
                // str += " :";
                str += msgs[i].getMessageBody().toString();
                str += msg;
                // str += "\n";

            }

        }

        if (msg.contains("LED ON")) {
            Toast.makeText(context, "HELLO WORLD", Toast.LENGTH_SHORT).show();
        }

        else {
            Toast.makeText(context, "HELLO", Toast.LENGTH_SHORT).show();

        }

        if (msg == "LED ON") {

            imageView1.setVisibility(imageView1.VISIBLE);
            imageView2.setVisibility(imageView2.INVISIBLE);

        }

        if (msg == "LED OFF") {
            imageView2.setVisibility(imageView2.VISIBLE);
            imageView1.setVisibility(imageView1.INVISIBLE);
        }

        Toast.makeText(context, str, Toast.LENGTH_SHORT).show();

    }

    private void startactivity(Intent i) {

    }
}

    package com.example.nhx;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.gsm.SmsManager;
import android.view.View;
import android.widget.Button;
import android.widget.ImageView;

public class blinkMe extends Activity {
    Button ON;
    Button OFF;
    ImageView imageView1;
    ImageView imageView2;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        ON = (Button) findViewById(R.id.ON);
        OFF = (Button) findViewById(R.id.OFF);
        imageView1 = (ImageView) findViewById(R.id.imageView1);
        imageView2 = (ImageView) findViewById(R.id.imageView2);

        ON.setOnClickListener(new Button.OnClickListener() {

            public void onClick(View v) {

                sendSMS("5556", "LED ON");
                OFF.setClickable(true);
                imageView1.setVisibility(imageView1.VISIBLE);
                imageView2.setVisibility(imageView2.INVISIBLE);

            }

            private void sendSMS(String phoneNumber, String message) {
                // TODO Auto-generated method stub
                SmsManager sms = SmsManager.getDefault();
                sms.sendTextMessage(phoneNumber, null, message, null, null);
                ON.setClickable(true);

            }
        });

        OFF.setOnClickListener(new Button.OnClickListener() {

            public void onClick(View v) {
                ON.setClickable(true);
                sendSMS("5554", "LED OFF");
                /* Intent i = new Intent(); */

                imageView2.setVisibility(imageView2.VISIBLE);
                imageView1.setVisibility(imageView1.INVISIBLE);

            }

            private void sendSMS(String phoneNumber, String message) {
                // TODO Auto-generated method stub
                SmsManager sms = SmsManager.getDefault();
                sms.sendTextMessage(phoneNumber, null, message, null, null);

            }
        });

    }

} 
```

在我的应用程序中，我有两个按钮，例如开和关，两个图像相互重叠，红色和绿色。当我单击按钮时，绿色图像应出现前言，当我单击关闭时，红色图像应出现前言，单击按钮时应向预定义的号码发送一条消息，这意味着单击按钮时会发生两个事件 1。相应的图像切换前言 2\. 消息被发送到预定义的号码

现在问题出现在发送消息后，预期的接收者现在根据收到的消息向我们发送消息，图像应该自动更改，例如如果接收者回复打开，则绿色图像应该是前言，如果他回复关闭，那么红色图像应该是前言。

# java - 使用Tomcat和Eclipse部署的网站地址

> ID：12916215
> 
> 赞同：2
> 
> 时间：2012-10-16T13:50:11.693
> 
> 标签：java, eclipse, tomcat, web

我正在尝试使用 Tomcat 和 Eclipse 运行网站。我创建了一个动态 Web 项目，配置了 web.xml 文件，还使用了 Maven。在 src/main/webapp 目录中，我放置了一个 index.html 文件。我还在同一个项目中做了一个简单的 REST 服务。所以这个 REST 服务对我有用（例如，当我在地址栏中输入“http://localhost:8080/RESTfulService/rest/item”时。但是我应该写什么地址才能访问我放在 webapp 文件夹中的网站？我认为“http://localhost:8080/RESTfulService/”应该可以工作，但事实并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:29:15.623

根据我对您设置的了解，请尝试“http://localhost:8080/index.html”。您是否有一个名为“RESTfulService”设置的上下文路径？

您的 中是否`context`列出了一个元素`server.xml`？如果是这样，它说明了什么？

# ios - UIPageController 与 UIPageControl 结合使用？

> ID：12916216
> 
> 赞同：16
> 
> 时间：2012-10-16T13:50:16.657
> 
> 标签：ios, uipagecontrol

我一直在使用`UIPageController`在不同的控制器之间导航。现在我想在底部添加那个点，这样用户就可以看到他在哪个控制器上。这是通过`UIPageControl`. 有没有简单的方法可以将这两者结合起来？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-24T00:26:26.970

从 UIPageViewController.h (iOS6+) 的底部~

> 如果实现了这两种方法，页面指示器将可见，过渡样式为“UIPageViewControllerTransitionStyleScroll”，导航方向为“UIPageViewControllerNavigationOrientationHorizo​​ntal”。这两种方法都是为了响应“setViewControllers:...”调用而调用的，但在手势驱动导航的情况下，表示索引会自动更新。

```
- (NSInteger)presentationCountForPageViewController:(UIPageViewController *)pageViewController NS_AVAILABLE_IOS(6_0); // The number of items reflected in the page indicator.
- (NSInteger)presentationIndexForPageViewController:(UIPageViewController *)pageViewController NS_AVAILABLE_IOS(6_0); // The selected item reflected in the page indicator. 
```

`UIPageControl`否则，我认为您需要添加一个`UIPageViewController`并基本上将它们绑定在一起以使它们保持同步……但是您必须手动完成所有绑定。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-30T21:10:43.723

如果您使用的是 Xcode 的基于页面的应用程序模板，请转到属性检查器并将 Transiton 样式属性设置为 Scroll。

并转到您的应用程序 AppDelegate.m 文件并为

```
 UIPageControl *pageControl = [UIPageControl appearance];
    pageControl.pageIndicatorTintColor = [UIColor lightGrayColor];
    pageControl.currentPageIndicatorTintColor = [UIColor blackColor];
    pageControl.backgroundColor = [UIColor whiteColor]; 
```

对于基于页面的 Xcode 模板，它已经适用于 iOS 6，iOS 7，只是它的颜色设置为白色。

# html - dom 对象加载乱码/不合适，然后在满载时正确设置

> ID：12916217
> 
> 赞同：0
> 
> 时间：2012-10-16T13:50:19.727
> 
> 标签：html, css, dom

我有一个小问题，虽然不常见，但它确实发生在我身上，问题是，当页面加载时，某些元素显得格格不入，格格不入。然后当整个东西被加载时，它会去它应该去的地方。

例如，我最近为客户建立的这个最新的 wordpress 网站

[http://www.islandlivingpatio.com/](http://www.islandlivingpatio.com/)

首次加载页面时，主图像偏离中心/侧面。满载后一切就位。起初我以为这是我使用的滑块，但后来一位朋友刚刚问我“为什么我的页面会这样做（如上所述）并且我没有答案。

[http://discoverarmenia.org/tourism.php](http://discoverarmenia.org/tourism.php)

注意他的内容 div 也是如何加载到一边的。

我不知道如何解决它。这不是什么大不了的事，尤其是当页面加载速度很快但连接速度很慢时它非常明显。

关于如何纠正这个问题的任何想法？

先谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:05:22.680

我相信正在发生的事情是内容被加载，然后被样式化。例如那个旅游页面，那个 div 是向左浮动的。所以所有的内容都被加载了，然后是样式。

你的风格也在身体而不是头部。样式和元应该存在于头脑中！

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:23:25.673

您需要在标题中移动样式。对于旅游页面，这可能是快速的解决方法：

```
<div id="slider" class="nivoSlider"> 
```

至

```
<div id="slider" style="height:376px" class="nivoSlider"> 
```

这会将您的内容 div 放在正确的位置。连接速度较慢的用户在加载样式后不会注意到任何 div 移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:12:26.987

可能是因为您的主图像设置为`float:left(right);`，当它第一次加载时，它可能不会在所需的位置，直到加载除它之外的其他元素并将其挤压到正确的位置。希望这可以帮助！

# java - 从网站读取字节

> ID：12916227
> 
> 赞同：-1
> 
> 时间：2012-10-16T13:50:57.823
> 
> 标签：java, sockets

我正在尝试创建代理服务器。

我想逐字节读取网站，以便显示图像和所有其他内容。我试过 readLine 但我无法显示图像。您对如何更改代码并将所有数据与 DataOutputStream 对象发送到浏览器有什么建议吗？

```
try{
    Socket s = new Socket(InetAddress.getByName(req.hostname), 80);
    String file = parcala(req.url);
    DataOutputStream out = new DataOutputStream(clientSocket.getOutputStream());
    BufferedReader dis = new BufferedReader(new InputStreamReader(s.getInputStream()));
    PrintWriter socketOut = new PrintWriter(s.getOutputStream());
    socketOut.print("GET "+ req.url + "\n\n");
    //socketOut.print("Host: "+req.hostname);
    socketOut.flush();
    String line;
    while ((line = dis.readLine()) != null){
        System.out.println(line);
    }
} 
catch (Exception e){}
} 
```

编辑部分

这是我应该做的。我可以阻止被禁止的网站，但不能在我的程序中允许其他网站。

在过滤器程序中，您将在指定端口打开一个 TCP 套接字并等待连接。如果请求到来（即客户端键入一个 URL 来访问一个网站），应用程序将处理它以确定是否允许访问，然后使用相同的套接字将回复发送回客户端。在客户端打开她与 WebPolice 的连接后（并且她的请求已被检查并被允许），需要向客户端显示真实的网页。因此，既然用户已经提出了请求，那么现在轮到 WebPolice 转发请求，以便用户获取网页。因此，WebPolice 充当客户端并请求网页。这意味着您需要打开与 Web 服务器的连接（不关闭与用户的连接），通过此连接转发请求，得到回复并将其转发回客户端。您将使用线程来处理多个连接（同时和/或不同时间）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:55:01.087

我不知道您到底想做什么，但是制作一个 HTTP 请求并读取它的响应所包含的内容比您在此处所做的要多。无论如何，Readline 都无法处理二进制数据。

你可以看看`URLConnection`类（[这里偷来](http://docs.oracle.com/javase/tutorial/networking/urls/readingWriting.html)的）：

```
URL oracle = new URL("http://www.oracle.com/");
URLConnection yc = oracle.openConnection();
BufferedReader in = new BufferedReader(new InputStreamReader(yc.getInputStream())); 
```

`in`然后您可以从对象中读取文本或二进制数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:55:09.923

读取行会将读取的行视为字符串，因此除非您想弄乱转换为字节的问题，否则我不建议这样做。

我只会读取字节，直到您无法再读取，然后将它们写入文件，这应该允许您抓取图像，保持文件头完整，这在处理文本以外的文件时可能很重要。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:55:17.287

而不是使用`BufferedReader`你可以尝试使用`InputStream`. 它有几种读取字节的方法。 [http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html)

# java - RExecClient apache InputStream 不可用

> ID：12916237
> 
> 赞同：0
> 
> 时间：2012-10-16T13:51:21.737
> 
> 标签：java, apache-commons-net

我想使用 RExecClient Apache Commons-Net 类在远程机器上运行命令。

我的代码是：

```
import java.io.IOException;
import java.io.InputStream;

import org.apache.commons.io.IOUtils;
import org.apache.commons.net.bsd.RExecClient;

public class TestRlogin {

    static final int PORT_NUMBER = 512;
    private RExecClient client;
    private final String url = "test.corp";
    private final String login = "bob";
    private final String password = "bob";

    public TestRlogin() {
        client = new RExecClient();
    }
    public String run(String cmd) throws IOException {
        String res = null;
        InputStream is = null;
        if (client != null) {
            try {
                if (!client.isConnected()) {
                    client.connect(url, PORT_NUMBER);
                }
                client.rexec(login, password, cmd);
                is = client.getInputStream();
                if (is != null && is.available() > 0) {
                    res = IOUtils.toString(is);
                } else {
                    System.err.println("InputStream is not available!");
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
            finally {
                IOUtils.closeQuietly(is);
                client.disconnect();
            }
        } else {
            System.err.println("The RLogin client is not connected to "+url);
        }
        return res;
    }
    public void main(String[] args) {
        TestRlogin trl = new TestRlogin();
        try {
            System.out.println(trl.run("ls -lrt /tmp;"));
            System.out.println(trl.run("tar -xf /tmp/archive.tar;"));
            System.out.println(trl.run("ls -lrt /tmp;"));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

该`ls`命令工作正常，但该`tar`命令不提取存档并且不返回任何内容。我得到的信息是`InputStream is not available!`。

我检查了两次服务器上存在的 tar 存档。当我手动 rlogin 并运行命令时，没有返回任何内容，但提取了 tar 存档。

我没主意了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T15:20:27.497

我终于解决了这个问题。连接时无需指定端口。

此外，如果您以 root 身份登录，请检查该`$HOME/.rhosts`文件。以非 root 身份登录时，同时配置`$HOME/.rhosts`和`/etc/hosts.equiv`。

```
import java.io.IOException;
import java.io.InputStream;

import org.apache.commons.io.IOUtils;
import org.apache.commons.net.bsd.RExecClient;

public class TestRlogin {

    private RExecClient client;
    private final String url = "test.corp";
    private final String login = "bob";
    private final String password = "bob";

    public TestRlogin() {
        client = new RExecClient();
    }
    public String run(String cmd) throws IOException {
        String res = null;
        InputStream is = null;
        if (client != null) {
            try {
                if (!client.isConnected()) {
                    client.connect(url);
                }
                client.rexec(login, password, cmd);
                is = client.getInputStream();
                if (is != null && is.available() > 0) {
                    res = IOUtils.toString(is);
                } else {
                    System.err.println("InputStream is not available!");
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
            finally {
                IOUtils.closeQuietly(is);
                client.disconnect();
            }
        } else {
            System.err.println("The RLogin client is not connected to "+url);
        }
        return res;
    }
    public void main(String[] args) {
        TestRlogin trl = new TestRlogin();
        try {
            System.out.println(trl.run("ls -lrt /tmp;"));
            System.out.println(trl.run("tar -xf /tmp/archive.tar;"));
            System.out.println(trl.run("ls -lrt /tmp;"));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

但我还有一个问题。如何检查命令是否正确终止（我在**[这里](https://stackoverflow.com/questions/12897239/java-exit-code-rexecclient-apache)**发布了问题）？也许可以使用`addProtocolCommandListener`SocketClient 类中的方法。我看到有一个受保护的方法`fireReplyReceived`。

谢谢您的帮助。

# php - Xml 到 Json 的转换忽略了最深层次的属性

> ID：12916238
> 
> 赞同：0
> 
> 时间：2012-10-16T13:51:23.750
> 
> 标签：php, xml, json, parent-child, cdata

我制作了一个简单的 PHP 脚本，可以将`XML`文件转换为`JSON`文件。
这是一个代码片段：

```
$xml = simplexml_load_string($fileContents);
$json = json_encode(new SimpleXMLElement($xml->asXML(), LIBXML_NOCDATA)); 
```

我`XML`很好地转换为`JSON`. 除了一件事：最深的子标签（在 XML 中）的属性没有添加到`JSON`. （这些最深的子标签没有自己的子标签，它们只有一个属性并包含一些`CDATA`文本。）

这很奇怪，因为正在添加具有子标签的标签的属性。

我没有任何线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:25:12.007

There is a bug report about xml to json conversion in php: [https://bugs.php.net/bug.php?id=54632](https://bugs.php.net/bug.php?id=54632)

Check and see where you lose the data with var_dumps.

# javascript - 从javascript动态更改自定义组件属性值

> ID：12916242
> 
> 赞同：1
> 
> 时间：2012-10-16T13:51:41.293
> 
> 标签：javascript, salesforce, apex-code, visualforce

我的 visualforce 页面中有一个自定义组件，它需要一个属性：

```
<c:myCustomComponent id="myCC" attr='Some value'></c:myCustomComponent> 
```

我想从javascript动态更改属性值。我试过 `getElementById('myCC').setAttribute('other value')`了，但它似乎不起作用，并且 DOM 没有自定义组件 ID 的引用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:56:35.010

您应该使用**文档**.getElementById('myCC').setAttribute( **'value'** , 'other value');

并且不使用属性“attr”。

检查这个jsfiddle：

[http://jsfiddle.net/wkJck/](http://jsfiddle.net/wkJck/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:05:15.827

您必须首先定义您的 value 属性，然后您可以通过 javascript 访问和更改它。

例如：

组件**定义**

```
 <apex:attribute name="myValue" description="This is the value for the component."  type="String" required="true"/> 
```

通过**visualforce访问价值**

```
<c:myComponent myValue="Some value" id="myCC"/> 
```

**通过javascript**访问和更改

 **```
document.getElementById('myCC').value ='other value' ; 
```

[阅读官方文档](http://www.salesforce.com/us/developer/docs/pages/Content/pages_comp_cust_elements_attributes.htm)中的完整示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T17:58:28.223

您无法通过输入的 id 直接使用 javascript 访问 visualforce 元素，因为生成的 dom 元素的真实 id 看起来不同。我为此使用 jquery，这很容易：

```
<c:MyComponent id="myCC" />

<script>
    jQuery("[id$=myCC]").hide();
</script> 
```**

# filter - 如何在当前周（周一至周五）找到已解决的 JIRA 问题

> ID：12916250
> 
> 赞同：3
> 
> 时间：2012-10-16T13:51:57.960
> 
> 标签：filter, jira, jql

我想找到本周解决的所有问题。我们正在使用 JIRA web ui。我确实看到了一种在分辨率字段的 JIRA 过滤器自定义中指定“从”和“到”日期的方法。我想知道什么是正确的语法来指定起始日期是本周的星期一。

我喜欢使用此过滤器的方式是将其放入仪表板中，并在每天结束时查看它，我们在本周修复错误的情况如何。

谢谢
视频大佬

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-16T21:22:31.753

您可以在 Jira 4.1.1 中做的最好的事情是在过去 7 天内解决所有问题： `resolutiondate >= "-7d"`

或者为一周中的每一天创建一个过滤器。例如过滤器“一周内解决的问题（星期三）”将是`resolutiondate >= "-3d"`。过滤器“一周内解决的问题（星期五）”将是`resolutiondate >= "-5d"`

从 Jira 4.3 开始，您可以使用[startOfWeek()](https://confluence.atlassian.com/display/JIRA043/Advanced+Searching#AdvancedSearching-startOfWeek)函数 -`resolutiondate > startOfWeek()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T17:16:17.083

您可以使用以下格式使用高级问题搜索：

```
resolutiondate >= "2012-10-14" and resolutiondate <= "2012-10-20" 
```

# ruby-on-rails - DB Down时如何处理？

> ID：12916251
> 
> 赞同：0
> 
> 时间：2012-10-16T13:51:59.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3

### DB Down时如何处理这种情况！

描述：服务器：乘客

想象一下：当你的应用程序运行时，其中一个 dbs 关闭了，所以这个 rails 出错了，当网站有新请求时，会有新的 rails 来回答请求（但 DB 仍然关闭），所以它一直出错直到所有导轨出问题了！

### 那么这种情况下的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T13:54:34.543

只需更新您的`/public/500.html`

您的文件夹中有`404.html`, `422.html`,`500.html`页面`public`，每当根据错误代码发生任何错误时，都会向用户显示其中一个 html。

您需要提供与您的应用程序相同的外观和相关消息，以便用户应该确认发生了不好的事情，同时应该连接到您的应用程序。

# jms - apache JMeter JMS 点对点发送 XML 类型消息

> ID：12916257
> 
> 赞同：0
> 
> 时间：2012-10-16T13:52:23.177
> 
> 标签：jms, jmeter

我可以使用 JMS 点对点将 XML 类型的消息发送到 Q 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T04:02:28.310

XML 消息只是纯文本消息，所以这应该是完全可行的。

# browser - 网站覆盖 - 有可能吗？

> ID：12916258
> 
> 赞同：1
> 
> 时间：2012-10-16T13:52:23.640
> 
> 标签：browser, overlay, media, social

我有兴趣教老年人如何使用社交媒体。

我想创建一个位于浏览器和网站之间的培训层，向用户展示如何使用网站功能。

一个例子是 Facebook。当您访问个人资料时，浏览器将显示模态窗口或弹出窗口，以解释状态更新的工作原理。

这就像将网站放在网站之上。一个是训练层，另一个是实际网站本身。

一个人将如何实现这一目标？我的技术/开发有限，但如果这是可行的以及可以使用哪些技术来做到这一点，我将不胜感激。

# css - webkit浏览器中风格化锚点/按钮的片状点击

> ID：12916260
> 
> 赞同：1
> 
> 时间：2012-10-16T13:52:34.947
> 
> 标签：css

在此按钮上的文本下方或上方直接单击无法在 Chrome/Safari 中注册为单击（可能需要几次尝试才能找到最佳位置，但它的一致性足以令人恼火）。:active CSS 被应用，所以它显然是一个错误。有人有解决方法吗？

[http://jsfiddle.net/BpR76/](http://jsfiddle.net/BpR76/)

[这家伙](https://stackoverflow.com/questions/10287537/button-not-registrering-clicks)似乎也有同样的问题，但我不同意这个答案——这不是一个拖拉的问题。

# java - 使用 PreparedStatement 将日期插入 MySQL 数据库

> ID：12916262
> 
> 赞同：4
> 
> 时间：2012-10-16T13:52:40.000
> 
> 标签：java, jdbc, prepared-statement

我想使用准备好的语句将字符串日期更新到 MySQL 数据库中。我已经尝试了很多，但总是出错`java.util.Date cannot parse into java.sql.Date`，反之亦然。我没有在这里导入任何东西。请根据您的回答导入。

```
public class Date1 
{ 
    public static void main(String args[]) 
    {
        String source="2008/4/5";              
        SimpleDateFormat format = new SimpleDateFormat("dd/MM/yyyy");                       
        java.sql.Date d=(Date) format.parse(source);             
        Class.forName("com.mysql.jdbc.Driver");        
        Connection con=(Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/employee", "root", "root");   
        PreparedStatement ps=con.prepareStatement("insert into ankur1 values(?)");          
        ps.setDate(1,(java.sql.Date) d);    
        ps.executUpdate();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T13:59:21.833

写这个

```
java.sql.Date d= new java.sql.Date(format.parse(source).getTime()); 
```

而不是这个：

```
java.sql.Date d=(Date) format.parse(source); 
```

因为您不能只`java.util.Date`转换为它的子类型`java.sql.Date`。你必须转换它。另请注意，您的格式字符串与您的实际日期格式不匹配，正如 Bill the Lizard 评论的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T10:27:05.280

```
java.sql.Timestamp date = new java.sql.Timestamp(new java.util.Date().getTime());

pstmt.setTimestamp(1, date); 
```

试试这个它可能会工作..谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-12T05:00:21.873

这是解决此问题的另一种更简单的方法：

```
preparedStatement = connect.prepareStatement("INSERT INTO test.TABLENAME VALUES (default, STR_TO_DATE( ?, '%m/%d/%Y'), STR_TO_DATE(?, '%l:%i %p'),?,?,?,?,?)"); 
```

或者，您可以替换“？” 用真实数据。

这就是我在 mySQL 中插入日期和时间的方式，只是想通了。

我们可以调整各种参数以适应我们的数据格式，简单明了。

# iphone - 如何获得相机镜头距地面的高度？

> ID：12916266
> 
> 赞同：2
> 
> 时间：2012-10-16T13:52:57.317
> 
> 标签：iphone, augmented-reality

我想得到从地面到相机镜头的高度。有人可以建议我这样做的方法吗。我有谷歌，但即使是数学公式也找不到任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:22:59.360

勾股定理是您正在寻找的公式。

不知道如何获得使用它的值，除非有一种方法可以确定从相机到它所关注的物体的距离，这会让你得到一个。如果你能做到这一点，他们可以将它指向地面/点击以集中注意力并给你高度。

# c# - 违反了多重性约束。关系 '' 的角色 '' 具有多重性 1 或 0..1

> ID：12916270
> 
> 赞同：3
> 
> 时间：2012-10-16T13:53:30.753
> 
> 标签：c#, asp.net, .net, entity-framework, data-binding

我有一个 Tab 对象。这个选项卡对象有很多问题。这是我的课程：

```
public abstract class Tab
{
    /// <summary> init default values </summary>
    public Tab()
    {
        // Do some init stuff
    }
    public int ID { get;set; }

    //...

    /// <summary> Question for this Tap. Like Quiz-App or Sweepstake </summary>
    public virtual ICollection<Tabs.Question> Questions { get; set; }

    //...
}

public class Question
{
    public int Id { get; set; }
    public int OrderNumber { get; set; }
    public string Text { get; set; }

    public virtual Tab Tab { get; set; }
 } 
```

这是两个类的配置。

```
class TabConfig : EntityTypeConfiguration<Tab>
{
    public TabConfig()
    {
        this.Map(m => m.Requires("AppType").HasValue<byte>((byte)ApplicationType.Application)).ToTable("TmTabs");
        this.HasKey(c => c.ID);
        this.Property(p => p.ID).HasColumnName("ID").IsRequired().HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);

    }
}

public class QuestionConfig : EntityTypeConfiguration<Question>
{
    public QuestionConfig()
    {
        ToTable("TmQuestions");
        HasKey(q => q.Id);
        Property(q => q.Id).HasColumnName("Id").HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
        Property(q => q.OrderNumber).HasColumnName("OrderNumber").IsRequired();
        Property(q => q.Text).HasColumnName("Text").IsRequired();
        HasRequired(q => q.Tab).WithMany(t => t.Questions).Map(q => q.MapKey("TmTabs_Id")).WillCascadeOnDelete(false);
    }
} 
```

并且配置将像这样添加到构建的事件中。

```
public class ModelContext : DbContext
{

    public Guid ContractId { get; set; }

    #region construction

    public ModelContext()
        : base(Tools.DatabaseTools.GetDefaultConnectionString())
    {
        ContractId = Guid.Empty;
    }

    public ModelContext(Guid contractGuid)
        : base(Tools.DatabaseTools.GetConnectionString(contractGuid))
    {
        ContractId = contractGuid;            
    }

    public ModelContext(string connectionString)
        : base(connectionString)
    {
        ContractId = Guid.Empty;
    }

    public ModelContext(string connectionString, Guid contractGuid)
        : base(connectionString)
    {
        ContractId = contractGuid;
    }

    public DbSet<Tab> Tabs { get; set; }     
    public DbSet<Question> Questions { get; set; }

    protected override void OnModelCreating(DbModelBuilder builder)
    {
        builder.Conventions.Remove<PluralizingTableNameConvention>();

        // tab-table
        builder.Configurations.Add(new TabConfig());

        // Qustions
        builder.Configurations.Add(new ModelConfig.QuestionConfig());

        base.OnModelCreating(builder);

    }
} 
```

在我的 Edit-Form 上，我将整个 Tab 对象绑定到绑定 Source，并编辑 Tab 对象的某些属性并添加 Questions。

如果我第一次保存 Tab 对象，一切正常。但是，如果我编辑选项卡对象，则会出现此错误：

```
Multiplicity constraint violated. The role 'Question_Tab_Target' of the relationship 'Tabmaker.Common.Question_Tab' has multiplicity 1 or 0..1. 
```

Tab业务层的代码为：

```
public bool SaveTab<T>(ModelContext context, T tab) where T:Tab
    {
        try
        {
            // add if detached
            if (tab.ID == 0)
            {
                // new tab code
            }

            // attach/set to be modified if id!=0\. if tab is not detached, the property 
            // changes were already tracked and nothing need to be done here
            var state = context.Entry(tab).State;
            if (state == EntityState.Detached || state == EntityState.Deleted)
            {
                context.Entry(tab).State = EntityState.Modified;
            }
            context.SaveChanges();
            return true;
        }
        catch (Exception ex)
        {
            // Catch
    return false
        }
    } 
```

如果我询问选项卡实体的状态，则会发生错误：

```
var state = context.Entry(tab).State; 
```

我希望我尽可能地解释一切。

# tfs - 从 t4 模板生成的文件似乎忽略了 tfignore 规则

> ID：12916272
> 
> 赞同：1
> 
> 时间：2012-10-16T13:53:35.127
> 
> 标签：tfs, visual-studio-2012, t4

我的环境是带有本地工作区的 Visual Studio 2012/TFS 2012。

我在项目中使用 t4 模板生成具有特定扩展名 (.generated.cs) 的代码文件，以便使用以下规则从源代码管理中排除这些文件（.tignore 文件位于 .tt 的同一级别文件） ：

```
######################################
# Ignore generated.cs files in project
*.generated.cs 
```

我很难在项目中保持一致的行为。在某些项目中，这工作正常，并且文件在生成后会自动从源代码管理中排除。在另一个包括...

这可能与我的本地工作区有关。

有没有办法在工作区级别调试排除过程的行为？

TIA。

# overflow - 将数字转换为数据类型日期时间的算术溢出错误

> ID：12916274
> 
> 赞同：0
> 
> 时间：2012-10-16T13:53:41.533
> 
> 标签：overflow

我有这个简单的更新声明

```
 UPDATE EmpSchedual2
    SET AttH = 0, AttM = 0, AttC = 'AM', DisH = 0, DisM = 0, DisC = 'PM', changeDate = 0
    WHERE  (EmpID = 4) AND (WeekDay = 2) 
```

运行时出现此错误：

*   将数字转换为数据类型日期时间的算术溢出错误

这是表定义：

```
 Column Name DataType
    Serial      int 
    EmpID       int 
    WeekDay     int 
    AttH        int 
    AttM        int 
    AttC        char    
    DisH        int 
    DisM        int 
    DisC        char    
    changeDate  int 
    WorkM       int 
```

有人能弄清楚为什么我会收到这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:11:03.227

谢谢

我很抱歉发布这样的问题。

我在附加到该表的触发器中发现了错误

# mysql - mysql 从一个纪元时间更新 HH:MM:SS

> ID：12916275
> 
> 赞同：0
> 
> 时间：2012-10-16T13:53:42.297
> 
> 标签：mysql, epoch

我希望对以毫秒为单位的列进行大规模查询更新。对于根据我的 where 子句返回的每一行，我想将时间值更新为传入的内容，并将其仍存储在 ms 中。我的更新子句需要是什么样的？

例如，我有两行

```
MY_TIMESTAMP  | VALUE
----------------------
1281275302000 | some val 1
1347198502000 | some val 2 
```

第 1 行对应于周日，2010 年 8 月 8 日 13:48:22 UTC 第 2 行对应于周日，2012 年 9 月 9 日 13:48:22 UTC

现在我想设置两个时间，比如 07:00:00，但保持日期不变。所以更新语句的结果应该是这样的：

```
MY_TIMESTAMP  | VALUE
----------------------
1281250800000 | some val 1
1347174000000 | some val 2 
```

对应于 2010 年 8 月 8 日星期日 07:00:00 UTC 和 2012 年 9 月 9 日星期日 07:00:00 UTC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:19:44.927

您可以使用 FROM_UNIXTIME 执行此操作：

```
UPDATE MY_TABLE
  SET MY_TIMESTAMP = (UNIX_TIMESTAMP(TIMESTAMP(DATE(FROM_UNIXTIME(MY_TIMESTAMP / 1000 + 14400)), '07:00:00')) - 14400) * 1000; 
```

通过此选择测试它是否为您提供正确的结果：

```
SELECT (UNIX_TIMESTAMP(TIMESTAMP(DATE(FROM_UNIXTIME(MY_TIMESTAMP / 1000 + 14400)), '07:00:00')) - 14400) * 1000 
   FROM MY_TABLE LIMIT 100; 
```

PS 14400 对应于我与 UTC 的偏移量（以秒为单位）。如果您的不同，请更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:37:14.750

应该可以只用简单的数学，以避免任何时区考虑：

```
UPDATE MY_TABLE
SET MY_TIMESTAMP = MY_TIMESTAMP - (MY_TIMESTAMP % 86400000) + 25200000 
```

`MY_TIMESTAMP - (MY_TIMESTAMP % 86400000)`给你没有时间的日期

`25200000`等于 7 小时（以毫秒为单位）。

# iphone - 从设置中手动设置日期时，NSDate 计算缺少 1 小时

> ID：12916278
> 
> 赞同：1
> 
> 时间：2012-10-16T13:53:47.070
> 
> 标签：iphone, objective-c, ios, nsdate, nsdateformatter

我有一个奇怪的问题...

如果在我的 iPhone 中自动设置了日期/时间，则时间会正确显示，如下所示...![在此处输入图像描述](../Images/d821180d1ceec327d92a89ba19601b63.png)

如果日期/时间手动设置的时区与我实际所在的时区不同（**我在印度并将其设置为伦敦。如果设置为印度则工作正常**），它仅显示使用计算的两个日期的错误结果方法`[self.surveyModel.creationDate dateByAddingTimeInterval:60*60*24*30]`和类似的20天..见下图..

![在此处输入图像描述](../Images/a425835ccdc77bf802462f31e255ea7b.png)

我没有为应用程序设置默认时区或本地时区，我正在使用以下方法来显示结果...

```
- (NSString *)stringWithFormat:(NSString *)format {
    NSDateFormatter *outputFormatter = [[NSDateFormatter alloc] init];
    [outputFormatter setTimeZone:[NSTimeZone systemTimeZone]];
    [outputFormatter setDateFormat:format];
    NSString *timestamp_str = [outputFormatter stringFromDate:self];
    [outputFormatter release];
    return timestamp_str;
} 
```

我在这里做错了什么......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T13:14:53.363

**注意：**此答案是对问题评论的回复

似乎错误是由夏令时的地区引起的，在这种情况下是英国伦敦。

当自动计算日期/时间时，iOS DateTime 库会考虑夏令时。

手动处理 DateTime 时，您正在通过此代码执行此操作`[self.surveyModel.creationDate dateByAddingTimeInterval:60*60*24*30]`

您正在设置 DateTime 而不列出启用的 DayLight 选项。因此，当您`NSTimeZone`寻找 DayLight 节省选项时。

# android - Android前置摄像头录制视频但播放颠倒......！

> ID：12916280
> 
> 赞同：1
> 
> 时间：2012-10-16T13:53:52.853
> 
> 标签：android, orientation, android-camera, landscape, screen-rotation

我设法创建了一个 android 应用程序来录制视频，但问题在于前置摄像头视频的方向。输出不符合要求。它会自动旋转。

应用程序方向是横向的。所以，我需要在横向模式下使用前置摄像头进行录制。

什么都没有解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:31:31.160

您可能想看看 AOSP [VideoCamera 活动](http://androidxref.com/7.1.1_r6/xref/packages/apps/LegacyCamera/src/com/android/camera/VideoCamera.java)是如何实现这一点的：

```
 if (info.facing == CameraInfo.CAMERA_FACING_FRONT) {
        rotation = (info.orientation - mOrientation + 360) % 360;
    } else {  // back-facing camera
        rotation = (info.orientation + mOrientation) % 360;
    } 
```

[我在此处对另一个问题的回答中提供](https://stackoverflow.com/a/12417965/1023092)了更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-26T06:36:22.643

在 setVideoSource 下面开始录制视频的地方添加这个

```
mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
if (cameraId == 1) {
    mediaRecorder.setProfile(CamcorderProfile
        .get(CamcorderProfile.QUALITY_LOW));
    mediaRecorder.setOrientationHint(270);
} else if (cameraId == 0) {
    mediaRecorder.setProfile(CamcorderProfile
        .get(CamcorderProfile.QUALITY_HIGH));
    mediaRecorder.setOrientationHint(orientation);
} 
```

`mediaRecorder.setOrientationHint(270);`用于前置摄像头倒置问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-12T13:10:55.853

检查相机 ID，如果是 1，则按照媒体播放器“setOrientationHit() 的方向更改

```
private static final SparseIntArray REAR_ORIENTATIONS = new SparseIntArray();
static {
    REAR_ORIENTATIONS.append(Surface.ROTATION_0, 270);
    REAR_ORIENTATIONS.append(Surface.ROTATION_90, 0);
    REAR_ORIENTATIONS.append(Surface.ROTATION_180, 90);
    REAR_ORIENTATIONS.append(Surface.ROTATION_270, 180);
} 
```

然后在媒体播放器预览准备方法为：

```
if(cameraId == FRONT_CAMERA) {
     mMediaRecorder.setOrientationHint(REAR_ORIENTATIONS.get(rotation));
} 
```

# c# - 从 jquery mouseup 事件写入 SQL Server Compact 数据库

> ID：12916287
> 
> 赞同：0
> 
> 时间：2012-10-16T13:54:17.597
> 
> 标签：c#, jquery, webforms, sql-server-ce, mouseup

我正在开发一个 asp.net c# 空 Web 表单项目。我有一个带有单个表的 SQL Server Compact 数据库，我想用它来存储有关元素 (x,y) 坐标的信息。

`mouseup`当在特定面板上触发事件（本质上是一个 div）时，应该使用特定面板的新坐标更新数据库。解决方案不需要ajax，提交页面就可以了。

问题是元素没有`mouseup`类型的事件，`<asp:Panel>`另一方面我不确定如何从 jQuery 触发服务器端的东西。使用 jQuery 获取坐标很容易，但是我该怎么做呢？

隐藏输入可以吗？给我你最好的解决方案——我不需要看代码，只是让我更好地了解我应该做什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:58:53.160

首先检查firebug在浏览器中究竟`asp:Panel`呈现了什么，假设它呈现为`div`那么你可以使用jquery的`.mouseup()`函数并将这个事件绑定到该面板呈现的任何元素。假设如果该 asp:panel 呈现为 div 然后查看下面的代码示例。

```
 <div id="asp_panel">
  Click here
</div>
$('#asp_panel').mouseup(function() {

    $.ajax({
            url: "HelloWorld.asmx/Hello",
            type: "POST",
            contentType: "application/json; charset=utf-8",
            data: "{}", // if your method takes any parameter pass it in here in json format.
            dataType: "JSON"
            success: function(msg) {
                alert(msg);
            }
    });
}); 
```

# javascript - 如何在 div 水平滚动条上触发 javascript 鼠标滚轮？

> ID：12916289
> 
> 赞同：2
> 
> 时间：2012-10-16T13:54:22.663
> 
> 标签：javascript

我有一个带有更大嵌套 div 的 div。溢出-x 设置为自动，出现这样的滚动条。我想这样做，如果用户在 div 内滚动（使用鼠标滚轮），滚动条会水平滚动。

```
<div id="outer" style="width:1000px;overflow-x:auto">
      <div id="inner" style="width:2000px"></div>
</div> 
```

为此需要什么样的javascript。请记住，滚动条是自动的，而不是寻找 javascript 改变左/右位置的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:23:40.030

为什么更改 scrollLeft 不适合您？

```
document.getElementById('outer').addEventListener('mousewheel', function(e) {
  this.scrollLeft -= (e.wheelDelta);
  e.preventDefault();
}, false); 
```

# java - Java StringTokenizer 和存储数组

> ID：12916296
> 
> 赞同：0
> 
> 时间：2012-10-16T13:54:41.507
> 
> 标签：java, arrays, object, equals, stringtokenizer

我已经编写了一个 Worker 类和 Worker 的驱动程序类。我的工作类正在编译并显示所需的输出。但是在数组和 StringTokenizer 中我面临着主要问题……在**TestWorker.java的第****32**行有一个错误，我不知道它为什么会给出问题是......

 **(i) 声明一个数组，该数组可以存储使用数据（名称、workerID 和 hourlyRate）构造的最多 5 个**Worker对象的引用。**

(ii)现在允许用户重复输入workerID和小时，直到用户输入一个空字符串。读取这些值并在适当的对象上调用方法**addWeekly()**（通过搜索数组来定位具有指定 ID 的对象）。如果输入了不存在的 ID，则显示相应的错误消息。

(iii)计算并显示所有工人的工资

请看我下面的代码......

//**工人.java**

```
public class Worker { 
        public final double bonus=100;    
        protected String name, workerID;
        protected double hourlyRate, totalHoursWorked,tax,grossSalary,netSalary;

        public Worker(){

    }
public Worker(String name, String workerID, double hourlyRate){
    this.name = name;
    this.workerID = workerID;
    this.hourlyRate = hourlyRate;

    }

public void addWeekly(double hoursWorked){
    this.totalHoursWorked = this.totalHoursWorked + hoursWorked;
    }

public double gross(){
    grossSalary = (totalHoursWorked*hourlyRate);
            if(totalHoursWorked>=150){
        grossSalary = grossSalary +100;
        }
        return  grossSalary;
        }
public double netAndTax(){
    netSalary = grossSalary;
    if(grossSalary>500){
        tax = (grossSalary - 500) *0.3;
        netSalary = (grossSalary - tax);

    }
    return netSalary;
 }
public String getName(){
    return this.name;
}

public String getWorkerID(){
    return this.workerID;
}

public double getHourlyRate(){
    return this.hourlyRate;
}

public double getTotalHours(){
    return totalHoursWorked;
}

public double getGrossSalary(){
    return grossSalary;
    }

public void addToGross(double amt){
    grossSalary = grossSalary + amt;
}
public void displaySalary(){
    System.out.print("Name: " +getName() + "\nID :" + getWorkerID() 
            + "\nHourly Rate: " + getHourlyRate()+ "\nTotalHours Worked" + getTotalHours() + 
            "\nGross pay" + getGrossSalary() + "\nTax: " + netAndTax() + 
            "\nNet Pay: " + netAndTax());
}

} 
```

// **TestWorker.java**

```
import java.util.Scanner;
import java.util.StringTokenizer;
public class TestWorker {
    public static void main(String args[]){
        Worker e = new Worker("John Major","s123",15.0);
        e.addWeekly(45);
        e.addWeekly(40);
        e.addWeekly(32);
        e.addWeekly(38);
        e.gross();
        e.netAndTax();
        e.displaySalary();

        Worker[] worklist = new Worker[5];
        worklist[0] = new Worker("Richard Cooper","s1235",20.0);
        worklist[1] = new Worker("John Major","s1236",18.0);
        worklist[2] = new Worker("Mary Thatcher","s1237",15.0);
        worklist[3] = new Worker("David Benjamin","s1238",16.0);
        worklist[4] = new Worker("Jack Soo","s1239",25.0);

    Scanner input = new Scanner(System.in);
    String name;
    double hourly;

    do{
        System.out.println("\n"); 
        System.out.print("Please Enter ID and hours-worked in a given week: ");
        name = input.nextLine();

        StringTokenizer string = new StringTokenizer(name,"+");
        String[] array  =new String[(string.countTokens)];
        for(int i=0;i<=4;i++){
            if(array[0].equals(worklist[0])){
            e.getName();
            e.getWorkerID();
            e.addWeekly(Double.parseDouble(array[0]));
            e.gross();
            e.displaySalary();

            }
            else if(array[0].equals(worklist[1])){
            e.getName();
            e.getWorkerID();
            e.addWeekly(Double.parseDouble(array[1]));
            e.gross();
            e.displaySalary();
            }

            else if(array[0].equals(worklist[2])){
            e.getName();
            e.getWorkerID();
            e.addWeekly(Double.parseDouble(array[2]));
            e.gross();
            e.displaySalary();
            }

            else if(array[0].equals(worklist[3])){
            e.getName();
            e.getWorkerID();
            e.addWeekly(Double.parseDouble(array[3]));
            e.gross();
            e.displaySalary();
            }

            else if(array[0].equals(worklist[4])){
            e.getName();
            e.getWorkerID();
            e.getHourlyRate();
            e.addWeekly(Double.parseDouble(array[4]));
            e.gross();
            e.displaySalary();
            }

            else{
            System.out.println("Please Enter correct information");
        }

     }

        System.out.println();
        while(string.hasMoreElements()){
            System.out.println(string.nextElement());
        }
    }
    while(name.isEmpty()==false);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:37:15.300

`countTokens`首先，当它实际上是这一行的方法时，您已将其指定为字段：

```
String[] array = new String[(string.countTokens)]; // Incorrect
String[] array = new String[(string.countTokens())]; // Correct 
```

现在您似乎将输入拆分为一个`+`标志？因此，您期望输入的内容`s123+12`类似于`ID s123 worked 12 hours this week`. 因此，为了解决类似您可能需要一个看起来像这样的循环的问题：

```
Scanner input = new Scanner(System.in);

System.out.println("\n");
System.out.print("Please Enter ID and hours-worked in a given week: ");
String enteredString = input.nextLine();

while (!enteredString.isEmpty()) {
    StringTokenizer stringtok = new StringTokenizer(enteredString, "+");
    String id = stringtok.nextToken();
    Double hours = Double.parseDouble(stringtok.nextToken());

    for (int i = 0; i < 5; i++) {
        if (worklist[i].getWorkerID().equals(id)) {
            worklist[i].addWeekly(hours);
            break;
        }
    }

    System.out.println("\n");
    System.out.print("Please Enter ID and hours-worked in a given week: ");
    enteredString = input.nextLine();
}

for (int i = 0; i < 5; i++) {
    worklist[i].gross();
    worklist[i].netAndTax();
    worklist[i].displaySalary();
} 
```

请记住，这非常粗略，从您的说明中我并不完全清楚您要达到的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:12:13.523

为什么不考虑[String.split()](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29) `name.split("\\+")`会给你一个字符串数组**

# java - 比较Java中的两个arraylist

> ID：12916306
> 
> 赞同：0
> 
> 时间：2012-10-16T13:55:25.477
> 
> 标签：java, arraylist

我有两个数组列表 listA 和 listB 可能包含也可能不包含相同的元素。例如：

```
listA= [1,2,3] &
listB=[2,3,4] 
```

我需要比较两个数组列表，并将 listA 中而不是 listB 中的元素添加到 listB 中。此外，如果 listB 中存在的任何其他元素不在 listA 中，我应该将其从 listB 中删除。

请帮助我如何用 Java 编写代码。

如果需要，我更喜欢使用 Iterator 方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:00:41.417

您的描述表明您希望使用集合。例如，假设一个元素在 A 中出现两次，但在 B 中只有一次。是否应该将其添加到 B 一次？

对您的问题最简单的答案是

```
List listA = ...
List listB = ...

listB.clear();
listB.addAll(listA); 
```

但是，假设您想保留一些订单，您可以这样做。

```
List listA = ...
List listB = ...
Set setA = new HashSet(listA);
setA.removeAll(listB);

Set setB = new HashSet(listB);
setB.removeAll(listA);

listB.addAll(setA);
listB.removeAll(setB); 
```

注意：如果元素的 A 多于 B，则不会添加条目，如果 B 的元素多于 A，则不会删除条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:59:34.610

尝试这个

```
for(int i : listA)
    if(!listB.contains(i)) listB.add(i);
for(int j : listB)
    if(!listA.contains(j)) listB.remove(j); 
```

否则

```
Arrays.sort(listA); Arrays.sort(listB);
for(int i = 0; i < listA.length(); i++)
{
   if(!listB.contains(listA.get(i))) listB.add(listA.get(i));
   if(!listA.contains(listB.get(i))) listB.remove(listA.get(i));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:59:59.930

编写代码的简单步骤

首先执行删除

```
 Iterate ListB
    For each element in ListB, check if it is present in List A
      If Not, delete from ListB
      else continue
 Close your loops 
```

然后加法

```
Iterate ListA
  For each element in ListA, check if it is present in List B
    If Not, add to ListB
    else continue
Close your loops 
```

示例代码：

```
 List<Integer> listA = ..
    List<Integer> listB = ..

    for(Integer intB: listB)
      if(!listA.contains(intB)){
         listB.remove(intB);
      }
    }   

   for(Integer intA: listA)
      if(!listB.contains(intA)){
         listB.add(intA);
      }
    } 
```

# sql-server - 删除和添加列时更正错误处理

> ID：12916307
> 
> 赞同：0
> 
> 时间：2012-10-16T13:55:28.037
> 
> 标签：sql-server, error-handling, transactions

我有一个表，它当前正在使用几个名为`DateFrom`and的列`DateTo`。我正在尝试用单个`NewDate`列替换它们，为现有行填充值来自`DateFrom`.

我需要良好的错误/事务处理，因为如果更改失败，我不想要中间表，我想恢复。

我已经尝试了很多东西，但无法让它正常工作。任何帮助表示赞赏，因为我远没有这方面的经验。

我从

```
BEGIN TRAN

ALTER TABLE TableName
ADD NewDate DATETIME

IF @@ERROR = 0 AND @@TRANCOUNT = 1
UPDATE TableName
SET NewDate = ValidFrom
.... 
```

这会立即失败，因为`NewDate`当前不是表中的列。好的，所以我`GO`在那里添加一个。这将它分成两批，现在运行，除了它使`@@ERROR`检查毫无意义。我也不能使用局部变量，因为它们也会丢失`GO`。理想情况下，我想使用 a`TRY...CATCH` 来避免在每个语句之后检查错误，但我不能使用 a `GO`，因为它需要是一批。

我发现的所有文章都没有谈论这种情况（使用 进行错误处理`GO`）。所以问题是：在添加和更新列时（这似乎需要某个地方），有*什么*方法可以得到我正在寻找的带有错误的事务处理方法`GO`？

还是我将不得不分批进行，如果出现任何问题，我无法回滚到我原来的表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:22:49.817

您为什么担心在事务中创建新列？只需创建列，然后填充它。填充时甚至不需要显式 tran。如果失败（这不太可能），只需再次进行更新。

我会执行以下步骤

1.  添加新列
2.  更新新列
3.  检查新列中的数据是否正确
4.  删除不再需要的旧列（您可能希望在删除它们之前检查这些列的使用位置，例如它们是否用于任何存储过程、报告、前端应用程序代码）

此外，值得为您的问题添加更多上下文。我假设您正在针对测试数据库测试脚本，然后将脚本应用到产品数据库。prod数据库很大吗？很忙？关键任务？按计划备份？

# c++ - 从全局向量中移除的元素的生命周期

> ID：12916309
> 
> 赞同：0
> 
> 时间：2012-10-16T13:55:34.603
> 
> 标签：c++, variables, member, lifetime

我基本上有一个

```
vector<Object> vec_; 
```

作为 cpp 类中的类成员。在某个类函数中，这个向量将被“对象”填充，就像这样：

```
vec_.push_back(Object()); 
```

稍后，我遍历向量元素并保留指向最佳元素的指针。然后向量被清除，如下所示：

```
Object* o_ptr = &(vec_[0]);
for (unsigned int i = 1;  i < vec_.size(); i++) {
  if (o_ptr->getCost() > vec_[i].getCost()) {
  o_ptr = &(vec_[i]);
} 

vec_.clear(); 
```

现在我的问题是：从向量中删除的对象会发生什么？一旦它们从向量中移除，它们的生命周期就结束了吗？那么指针是否也指向空白空间？如果不是，这些对象的生命周期何时结束？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T13:57:52.910

当`vector.clear()`被调用时（或当`vector`被破坏时），包含在 中的所有对象都`vector`将被破坏（在这种情况下，它们是对象而不是原始指针），留下`o_ptr`一个悬空指针。

请注意，缓存元素的地址（或迭代器）`vector`是危险的，即使没有调用`clear()`. 例如，`push_back()`可能导致内部重新分配`vector`，使缓存地址（或迭代器）无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:00:35.953

跟踪对象生命周期的最佳方法是将 printf 添加到构造函数和析构函数中。

```
class MyObject
{
public:
    MyObject()
    {
        printf("MyObject constructed, this=%p\n", this);
    }
    ~MyObject()
    {
        printf("MyObject destructed, this=%p\n", this);
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:02:05.093

> 从向量中删除的对象会发生什么？

他们被摧毁了。

> 一旦它们从向量中移除，它们的生命周期就结束了吗？

是的。

> 那么指针是否也指向空白空间？

是的，它确实。如果要保存对象，请在清除矢量之前对其进行复制。

同样重要的是要注意，即使未清除向量，某些向量操作也可能使指针指向空。特别是调整大小，这通常涉及重新分配。通常最好通过索引存储对向量元素的引用，因为您将始终能够通过索引获取元素（而指针可能在某些操作后失效）。

应用于向量的下标运算符返回引用并且不进行复制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T14:03:04.973

对象归向量所有，并且`.clear()`确实将它们删除。

另外，**指向 a 中存储的对象`std::vector`有点危险。**如果您将新元素推送到向量，则在某些时候向量可能需要分配更多内存 - 这可能会使用其复制构造函数将所有先前的元素复制到不同的地址（因此使您的指针无效）。

所以：使用整数索引`std::vector`而不是指针，除非你知道你不会超出保留容量（你可以保证使用`.reserve()`）。

（另外，当我们这样做时，请确保不要将向量的内部缓冲区大小与 混淆`.size()`，后者只是存储的实际元素的数量）。

# rest - 骨干 RESTful CRUD 404

> ID：12916310
> 
> 赞同：0
> 
> 时间：2012-10-16T13:55:36.460
> 
> 标签：rest, backbone.js, crud

所以我试图通过使用[Addy Osmani 的书](http://addyosmani.github.com/backbone-fundamentals/#restfulapps)在我的 Backbone 应用程序中实现 CRUD 。我遇到的一个问题是，尽管我目前使用 express/mongoose/path 的 NodeJS 服务器的相同代码，但对于所有 CRUD 操作，我得到 404。这是我当前在 localhost 上的文件夹结构

```
/
/myApplication/ (working dir)
/myApplication/js (contains all js files from Backbone app)
/myApplication/mongoServer.js (the server app) 
```

所以根据指南，唯一需要设置的是集合中的 url

```
myCollection = Backbone.Collection.extend({
 model: myModel,
 url: '/api/myModels'
 ...
}) 
```

我期望的是，一旦我添加了一个模型，因为它是集合的一部分，它会创建一个集合（如果它不存在），然后将它与服务器同步。这可能会发生，但有一个例外

```
POST http://localhost/api/todos 404 (Not Found) 
```

当然我认为那是不正确的，因为它可能需要查看路径

```
POST http://localhost/myApplication/api/todos 
```

因为 mongoServer.js 在 myApplication 的文件夹中。我真的不知道如何解决这个问题。也许有人可以改变路线，或者我的实施逻辑存在缺陷？

编辑：另外澄清一下，我已经测试过了

```
url: '/myApplication/api/myModels' 
```

XHR 完成加载，但 POST 仍然是 404。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T12:17:24.613

我遇到的一般问题是 Express 应用服务器的设置。造成麻烦的线路是

```
app.configure(function() {
 app.use(express.static(path.join(application_root, "public")));
}); 
```

这基本上表明该应用程序的静态路径位于公共文件夹中（我显然没有）。当快递服务器监听您选择的端口时

```
app.listen(3000); 
```

您实际想要访问的页面（例如您的 index.html 或 static.html）可以在下面找到

```
http://localhost:3000/index.html or static.html 
```

在 localhost 之后没有任何*/myApplication*。这也有助于应用程序本身的一般 url 设置，因为它实际上只需要*/api/myModels*

# xml - 在 GtkSourceView 中使用重叠模式

> ID：12916312
> 
> 赞同：1
> 
> 时间：2012-10-16T13:55:51.390
> 
> 标签：xml, gtksourceview

有谁知道是否有办法在 GtkSourceView 3 XML 语言文件中指定重叠模式？例如，在下面的文本中，有没有办法以一种颜色突出显示*foo*和*bar之间的“一些文本...”和另一种颜色的**bar*和*baz*之间的“一些更多文本...” ？这里的问题是*bar*是一个上下文的结束，也是另一个上下文的开始，这意味着*bar-baz*上下文永远不会应用。

```
foo
some text...
bar
some more text...
baz 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T09:31:51.923

我找到了解决方案。*bar*部分可以包含在foo*部分*中：

```
<context id="bar" style-ref="bar" style-inside="true" extend-parent="false">
   <start>^bar\b</start>
</context>

<context id="foo" style-ref="foo" style-inside="true">
   <start>^foo\b</start>
   <end>^baz\b</end>
   <include>
      <context ref="bar"/>
   </include>
</context> 
```

# c# - 在两个表单上使用和实例化一个类

> ID：12916314
> 
> 赞同：1
> 
> 时间：2012-10-16T13:55:57.787
> 
> 标签：c#, winforms, oop

我正在努力解决以下问题。我目前有三种形式，我的主要课程和一个主要课程。

```
public partial class frmMain : Form
{
    public frmMain()
    {
        InitializeComponent();
    }
}

public partial class frmSuppliers : Form
{
    public frmSuppliers()
    {
        InitializeComponent();
    }
}

public partial class frmCustomers : Form
{
    public frmCustomers()
    {
        InitializeComponent();
    }
} 
```

在我的主程序中，我有：

```
 public class Program
 {
        public StockControl StockSystem = new StockControl("The Book Shop", 20);
 } 
```

我希望能够从 frmSuppliers 和 frmMain 中的 StockControl 访问方法。

我知道这可能是一个 N00b 问题 - 但它整天困扰着我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T13:57:39.827

您需要将其作为构造函数参数传递给其他表单，然后将其存储在私有字段中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:57:46.737

将其声明为静态

```
public static StockControl StockSystem = new StockControl("The Book Shop", 20); 
```

并用作

```
Program.StockSystem 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:38:21.660

您应该为每个表单添加一个 StockControl 类型的字段，并将其公开，或向其添加 getter/setter。这意味着在每个表单中添加以下行：

```
private StockControl _stockCtrl;
public StockControl StockCtrl
{
   get { return _stockCtrl; }
   set { _stockCtrl = value; }
} 
```

您可以在每个表单的代码中访问您的 StockControl。但是如果你不给它分配一些东西，它将是空的（即空）。这是我在打开表格之前要做的事情。如果你在你的主要方法中：

```
frmSuppliers frmToOpen = new frmSuppliers();
frmSuppliers.StockCtrl = StockSystem;
frmSuppliers.Show(); 
```

# ios - 如何将我的 phonegap ipa 文件上传到苹果应用商店

> ID：12916318
> 
> 赞同：4
> 
> 时间：2012-10-16T13:56:10.233
> 
> 标签：ios, xcode, cordova, ipa, application-loader

我已经使用 phonegap 成功构建并测试了一个应用程序。现在我想将它上传到苹果商店，但是当我通过应用程序加载器运行 IPA 文件时，它会警告我捆绑包 ID 与我放入 iTunes 连接的内容不匹配。我可以通过 phonegap 配置 bundle id 还是必须将其拉入 xcode 并通过 info.plist 进行配置？

将我的应用上传到商店并提供匹配信息的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:13:42.100

为了让您的应用程序进入 App Store，您需要创建一个应用程序（在[App IDs](https://developer.apple.com/ios/manage/bundles/index.action)中），该应用程序具有与您目前在应用程序中使用的相同的捆绑标识符。

此外，您需要设置有效的配置文件以在 App Store 上使用。您可以在[Members Center](https://developer.apple.com/membercenter/)下的[Provisioning Portal](https://developer.apple.com/ios/manage/overview/index.action)中找到它。不要忘记在*Distribution*选项卡中创建此配置文件并选择适当的 App ID（您创建的新 ID）。

 *然后，您需要下载该配置文件，将其拖到您的 XCode 中进行安装并在 Build Settings 下的 Code Signing 部分中使用它。

最后，您需要访问[iTunes Connect](https://itunesconnect.apple.com)，在这里您将创建一个新的应用程序请求（在*Manager Your Applications*下）。请务必使用您在应用程序中使用的相同 App ID。

之后，在 XCode 中归档您的应用程序（使用*Project - Archive*菜单项）。确保您当前的方案（左上角下拉菜单）设置为生产使用，而不是调试。您可以编辑您的方案以验证（不确定现在在哪个菜单下）。

最后一步是单击存档的应用程序并选择*分发*（或旧 XCode 中的*共享*）并选择导出到 App Store。

我希望这对您有所帮助:)*

# spring - 如何为表单和 OpenID 身份验证配置不同的 UserDetailsS ervice bean

> ID：12916320
> 
> 赞同：1
> 
> 时间：2012-10-16T13:56:20.547
> 
> 标签：spring, spring-security

我正在尝试使用 spring security 3.1 自定义身份验证以同时使用表单和 OpenID 登录。

这是我的 spring-security.xml 文件：

```
 <http auto-config="true" use-expressions="true">

    <intercept-url pattern="/login.htm" access="permitAll" />
    <intercept-url pattern="/loginfailed*" access="permitAll" />
    <intercept-url pattern="/loginopenidfailed*" access="permitAll" />
    <intercept-url pattern="/home.htm" access="permitAll" />
    <intercept-url pattern="/**.htm" access="hasRole('ROLE_CLOUD_USER')" />

    <form-login login-page="/login.htm"
        default-target-url="/admin.htm"
        authentication-failure-url="/loginfailed.htm"
        always-use-default-target="true"/>
    <logout logout-url="/logout.htm" logout-success-url="/home.htm" />  
    <openid-login authentication-failure-url="/loginopenidfailed.htm">
      <attribute-exchange>
        <openid-attribute name="email" type="http://schema.openid.net/contact/email" required="true" count="2"/>
        <openid-attribute name="name" type="http://schema.openid.net/namePerson/friendly" />
      </attribute-exchange>
    </openid-login>
  </http>

  <!--Authentication Manager -->
  <authentication-manager alias="authenticationManager">
    <authentication-provider ref="daoAuthenticationProvider"/>
    <authentication-provider ref="openIDAuthenticationProvider"/>
  </authentication-manager>

  <!--dao authentication provider -->
  <beans:bean id="daoAuthenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
    <beans:property name="userDetailsService" ref="userService" />
    <beans:property name="passwordEncoder">
      <beans:bean class="org.springframework.security.authentication.encoding.ShaPasswordEncoder" />
    </beans:property>
  </beans:bean>

  <!--openID authentication provider -->
  <beans:bean id="openIDAuthenticationProvider" class="org.springframework.security.openid.OpenIDAuthenticationProvider">
    <beans:property name="userDetailsService" ref="openIDUserDS" />
  </beans:bean>

  <!--openID UserDetail -->
  <beans:bean id="openIDUserDS" class="test.security.CloudOpenIDUserDS"/>

  <user-service id="userDetailsService">
    <user name="abdellah" password="32fe5bbf04adc744455c92fa7b71e9dca8ce729c" authorities="ROLE_CLOUD_USER" />
    <user name="guest"    password="35675e68f4b5af7b995d9205ad0fc43842f16450" authorities="ROLE_CLOUD_USER" />
  </user-service>

</beans:beans> 
```

您可以看到我在“authentication-manager”中有两个提供程序元素，一个用于每种类型的身份验证。OpenID 提供者配置了一个`UserDetailService`名为`openIDUserDS`.

当我部署应用程序时，我得到了这个异常：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.filterChains': Cannot resolve reference to bean 'org.springframework.security.web.DefaultSecurityFilterChain#0' while setting bean property 'sourceList' with key [0]; nested exception is 

... Snip to root cause ...

Caused by: org.springframework.context.ApplicationContextException: More than one UserDetailsService registered. Please use a specific Id reference in <remember-me/> <openid-login/> or <x509 /> elements.
    at org.springframework.security.config.http.UserDetailsServiceFactoryBean.getUserDetailsService(UserDetailsServiceFactoryBean.java:102)
    at org.springframework.security.config.http.UserDetailsServiceFactoryBean.authenticationUserDetailsService(UserDetailsServiceFactoryBean.java:66)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:149)
    ... 95 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T14:17:37.723

您正在使用`<openid-login>`命名空间元素，该元素将自动尝试查找`UserDetatailsService`. 只是将其他 bean 添加到配置中本身不会有任何区别。

正如错误消息所说，您需要直接在命名空间元素中提供一个 ID。使用`user-service-ref`属性（参见[命名空间附录](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-openid-login)）：

```
<openid-login user-service-ref="openIDUserDS">
   ... 
```

并取出`openIDAuthenticationProvider`豆子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T08:05:50.117

正如异常堆栈跟踪所示

```
nested exception is org.springframework.context.ApplicationContextException: More than one UserDetailsService registered. Please use a specific Id reference in   or  elements. 
```

问题在于元素 -

```
 <user-service id="userDetailsService">
    <user name="abdellah" password="32fe5bbf04adc744455c92fa7b71e9dca8ce729c" authorities="ROLE_CLOUD_USER" />
    <user name="guest"    password="35675e68f4b5af7b995d9205ad0fc43842f16450" authorities="ROLE_CLOUD_USER" />
  </user-service> 
```

这导致了冲突。看到你的配置，既然你不是指这个bean，请删除它。错误应该得到解决。

# c# - 如果标题等于某个东西，我正在尝试从 rss 提要中选择“描述”

> ID：12916321
> 
> 赞同：0
> 
> 时间：2012-10-16T13:56:22.447
> 
> 标签：c#, asp.net, xml, xslt

如果标题等于某个东西，我正在尝试从 rss 提要中选择“描述”。

在代码中我有这个：

```
public static XmlDocument GetDefaultHoroscopesFeed(string StarSign){
 xdoc.SelectSingleNode(string.Format("rss/channel/item/[title = '{0}']/description", StarSign));
            xdoc.LoadXml(DefaultPageHoroscopeNode.InnerXml);
            return xdoc;

} 
```

但我不断收到此错误：表达式必须评估为节点集。

请帮助某人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:10:38.407

您没有在 和 之间指定节点名称`.../item/`，`[title = ...`因此您不会得到有效的节点集。此外，在 RSS 中，该`<title>`节点不会有一个名为 的子节点`<description>`。

你需要改变你的 XPath

```
"rss/channel/item/[title = '{0}']/description" 
```

进入

```
"rss/channel/item[title = '{0}']/description" 
```

这将为您`<item>`提供具有`<title>`值为 StarSign 的节点的节点，然后检索其`<description>`节点。

您也可以使用`XDocument`和 Linq to XML 来执行此操作，如下所示：

```
XDocument xdoc = XDocument.Load(pathToRss);
XElement description = xdoc.Descendants("item")
    .Where(i => i.Element("title").Value.Equals(StarSign))
    .Select(i => i.Element("description"))
    .FirstOrDefault(); 
```

# java - 几个类似的GUI Java面板

> ID：12916322
> 
> 赞同：3
> 
> 时间：2012-10-16T13:56:24.393
> 
> 标签：java, swing, layout, jpanel

我正在创建 GUI，但我不知道如何解决我的问题。我想做的是从 PanelClass 创建几个面板，就像我在 Main 中所做的那样。

我不知道如何：

1.  在我的面板中命名按钮并赋予它们一些功能（就像我尝试使用按钮 b1 一样）
2.  向 panel3 添加额外的标签和按钮。

我的主要课程

```
public class Main {

    JFrame f;
    PanelClass panel1, panel2, panel3;
    JButton b1, b2;

    public Main() {

        b1 = new JButton("asasa");

        f = new JFrame();
        f.setSize(300, 300);
        f.setLayout(new GridBagLayout());
        f.setVisible(true);
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        panel1 = new PanelClass(b1, b2, panel1);
        panel2 = new PanelClass(b1, b2, panel2);
        panel3 = new PanelClass(b1, b2, panel3);

        f.add(panel1);
        f.add(panel2);
        f.add(panel3);
    }

    public static void main(String[] args) {    
        Main m = new Main();    
    }    
} 
```

我的面板类

```
public class PanelClass extends JPanel {

    public PanelClass(JButton btn, JButton btn1, JPanel p) {

        super();
        p = new JPanel(new GridBagLayout());
        btn = new JButton();
        btn1 = new JButton();

        GridBagConstraints c = new GridBagConstraints();

        c.gridx = 0;
        c.gridy = 0;
        p.add(btn, c);
        c.gridx = 0;
        c.gridy = 1;
        p.add(btn1, c);
        add(p);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T14:50:16.110

1.  一个组件一次只能存在于一个可见容器中（除非它被用作享元渲染器）。因此，将相同的按钮放入 3 个面板中是行不通的。
2.  该代码在其构造函数中传递一个按钮，该按钮`PanelClass`被忽略。而是创建了 2 个新按钮实例。只需将传递的按钮分配给..当我注意到它们不是时，我会说“类级别属性”。完全删除 `btn = new JButton();`，按钮构造函数中传递的文本就会出现。
3.  有关事件，请参阅[如何编写动作侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:58:48.500

尝试阅读[官方 Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/panel.html)。它解释了如何添加面板、标签等。

要编辑标签名称，您可以使用`setText(String name)`方法。要向按钮添加功能，您必须在每个按钮中实现一个侦听器。像在其他面板中一样添加标签，我看不出问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:40:12.380

要添加“事件”，如单击和鼠标悬停等 - 您必须为小部件实现正确的“侦听器”。阅读任何关于 Swing 的优秀教程，它会告诉你一切。屏幕上的小部件也是常规对象，因此可以像常规对象一样将它们添加到“集合”中，进行迭代和玩耍。注意线程复杂性和警告“跨线程调用对您的程序有害”。

# qt - QListView 项的拖放

> ID：12916324
> 
> 赞同：1
> 
> 时间：2012-10-16T13:56:30.967
> 
> 标签：qt, drag-and-drop, qt4.7, qlistview, qt4.8

请帮我解决这个问题....我`QListView`在左侧有一个`QWidget`，在另一侧有一个。在`QListView`我使用`QStandardItem`. 现在我想将项目拖放`QListView`到另一边`QWidget`，我也必须这样做`QWidget`。`QListView`我可以通过使用将我的项目拖放到自身*内部`QListView`*

```
listView.setAcceptDrops(true);
listView.setDragEnabled(true);
listView.setDragDropMode(QAbstractItemView::InternalMove); 
```

这仅在 QListView 内工作正常。我想将 QListView 项目拖放到另一个小部件。我怎样才能做到这一点？我知道我必须像这样处理事件

```
void dropEvent(QDropEvent *);
void dragMoveEvent(QDragMoveEvent *);
void dragEnterEvent(QDragEnterEvent *);
void mousePressEvent(QMouseEvent *); 
```

我只是这样尝试

```
void Example::dragMoveEvent(QDragMoveEvent *e)
{
    // The event needs to be accepted here
    e->accept();
}

void Example::dragEnterEvent(QDragEnterEvent *e)
{
    // Set the drop action to be the proposed action.
    e->acceptProposedAction();
}

void Example::dropEvent(QDropEvent *e)
{
    qDebug("Items Dropped");
} 
```

正如我刚刚尝试使用一些**qDebug() 一样**，*当我从我的项目中拖动一个项目`QListView`并将其放入其中`QWidget`* 并将输出作为**"Items Dropped"**时，这是有效的。*但我不知道如何将我的确切`QListView`物品*带到这里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-20T12:48:44.070

您不必对视图进行子类化。所有拖放内容都由模型处理，因此您必须对标准模型进行子类化。您可能想查看[模型子类化参考](http://doc.qt.io/qt-4.8/model-view-programming.html#model-subclassing-reference)。当然，您还必须更改视图的拖放模式`QAbstractItemView::DragDrop`以获取外部拖放。

# objective-c - UIViewControllerHierarchyInconsistency 视图控制器异常

> ID：12916331
> 
> 赞同：1
> 
> 时间：2012-10-16T13:57:09.823
> 
> 标签：objective-c, ios

我正在尝试更改 splitViewController 中的详细信息视图，当我执行 self.detailView.view=view.view; 时出现 UIViewControllerHierarchyInconsistency 异常；我已经控制了 xib 文件中是否有其他视图控制器，并且我还使用了方法 removeFromParentViewController，但我有同样的例外。该错误仅在 iOS 6 中，但不在 iOS 5 中，在 iPad 模拟器中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T16:27:24.547

> 由于未捕获的异常“UIViewControllerHierarchyInconsistency”而终止应用程序，原因：“一个视图一次最多只能与一个视图控制器相关联！这是错误，view.view 是我要在 splitViewController 中加载的视图，没有其他代码，我只更改拆分中的视图，我使用 removefromparentviewcontroller 因为我想删除与 viewController 的关联删除异常

你的 splitViewController 是 UISplitViewController 的一个实例吗？ [http://developer.apple.com/library/ios/#documentation/uikit/reference/UISplitViewController_class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UISplitViewController_class/Reference/Reference.html)

如果是这样，那么你做的事情根本上是错误的。UISplitViewController 只是两个视图控制器的容器，一个主视图控制器和一个详细视图控制器。然后由您的视图控制器决定如何处理交互等。removeFromParentViewController 仅在 View Controller Containment 中使用，因此在这里似乎不适用。

阅读上面链接中的文档，看看它是否满足您的需求，但如果我理解，您需要在拆分视图中设置您的视图**控制器，而不是您的视图。**

做你，你需要做：

```
// Assume this is initialised correctly
UISplitViewController* splitViewController = [UISplitViewController alloc] init...];

// Assign the two view controller you want to be used in the split view controller
splitViewController.viewControllers = @[masterViewController, detailViewController]; 
```

如果这不适用，请提供您的代码，以便制定正确的解决方案。你的描述对你实际在做什么相当模糊。

# c# - 如何在C#中比较两个对象的值

> ID：12916332
> 
> 赞同：2
> 
> 时间：2012-10-16T13:57:25.580
> 
> 标签：c#

我创建了一个结构

```
 public struct MyCalender : IComparable<MyCalender>
{
 public int CompareTo(PersianDate other)
    {
        return DateTime.Compare(this, other);
    }
 .
 .
 .
 .
 .
} 
```

我在另一个 UserControl 中新建了两个对象，我想比较它们。

我使用此代码，但出现错误。

```
 MyCalender value = new MyCalender(2010,11,12);
 MyCalender value2 = new MyCalender(2010,11,12);
        if (value < value2) ==> geterror 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T14:00:50.743

`IComparable`暴露[`CompareTo`](http://msdn.microsoft.com/en-us/library/system.icomparable.compareto.aspx)。`<`并且`>`必须单独重载：

```
class Foo : IComparable<Foo>
{
    private static readonly Foo Min = new Foo(Int32.MinValue);

    private readonly int value;

    public Foo(int value)
    {
        this.value = value;
    }

    public int CompareTo(Foo other)
    {
        return this.value.CompareTo((other ?? Min).value);
    }

    public static bool operator <(Foo a, Foo b)
    {
        return (a ?? Min).CompareTo(b) < 0;
    }

    public static bool operator >(Foo a, Foo b)
    {
        return (a ?? Min).CompareTo(b) > 0;
    }
} 
```

我*编辑*了代码，以便在与`null`. 为了简短起见，我使用了一个有效的快捷方式，除非`value`是`Int32.MinValue`正确的`Foo`. 严格来说，您必须`null`明确检查才能[使合同](http://msdn.microsoft.com/en-us/library/system.icomparable.compareto.aspx)正确：

> 根据定义，任何对象比较大于（或跟随）null，并且两个 null 引用比较彼此相等。

此外，实现`IComparable<T>`意味着`CompareTo(T value)`接受一个参数`T`。因此`MyCalendar : IComparable<MyCalender>`应该实现一个方法`CompareTo(MyCalendar other)`而不是`PersianDate`（或实现`IComparable<PersianDate>`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:02:22.567

如果只比较一个日期时间对象，

会像

```
 DateTime A = DateTime.Now, B = DateTime.Now.AddMinutes(1);
  var isqual = A.Date.CompareTo(B.Date); 
```

做这个把戏？

或类似的东西：

```
 class Calender
        {
            public DateTime datetime { get; set;}
        }

        class DateComparer : Calender, IComparable<Calender>
        {
            public int CompareTo(Calender other)
            {
                return other.datetime.Date.CompareTo(this.datetime.Date);
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:06:29.180

您应该使用已实现的 CompareTo 方法而不是 > 在您发布的行中，或者您需要为您的特定类重载 > 和 < 运算符。例如：

```
public static bool operator >(MyCalendar c1, MyCalendar c2)
        {
            return c1.CompareTo(c2) > 0;
        }
        public static bool operator <(MyCalendar c1, MyCalendar c2)
        {
            return c1.CompareTo(c2) < 0;
        } 
```

但请记住，您必须使它们都超载。

# jquery - 重复值时，如何仅将值绑定到下拉列表一次？

> ID：12916334
> 
> 赞同：0
> 
> 时间：2012-10-16T13:57:26.083
> 
> 标签：jquery, html-select

我有一些数据动态绑定到下拉列表，如下所示：

```
if (product.oPTIONS.length > 0) {
   $.each(product.oPTIONS, function (idx, options) {
         /*appending the each option to a label*/
         $("#productdetails").append('<div class="clear">');
         $("#productdetails").append('<label>' + options.OptionName + '</label>');
         if (options.values.length > 0) {
            var stringBuilder = [];
            /*Creating a select tag for the Retrieved options*/
            $("#productdetails").append('<select id="' + options.OptionName + '" onchange="getimage($(this).val())" ><option>Choose</option>');
            $.each(options.values, function (idx, values) {
            /*Binding options to the Created select tag For an Option based on option Id*/           
            $("" + "#" + options.OptionName + "").append('<option value="' + values.sku + '">' + values.OptionValue + '</option>');
        });
        stringBuilder.push('</select>');
        $("#productdetails").append(stringBuilder.join(''));
     }
     $("#productdetails").append('</div>');
   })
 } 
```

现在我的情况是，下拉列表的某些值可能会重复，在这种情况下，只有一个值应该绑定到下拉列表。

```
 example
   Size:DropDown
     [S]
     [XXl]
     [s]
     [xl]
   Fit:DropDown
     [Slim]
     [Regular]
     [Slim]
     [AppleCut] 
```

就是这样，这里我只想绑定 [S],[Slim] 大小，只适合下拉菜单一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:18:38.663

将选项添加到数组中，因为它们被考虑包含在选择中，在包含之前检查它们是否存在于该数组中：

```
var optionsarray = new Array();
$.each(options.values, function (idx, values) {
    if (jQuery.inArray(values.OptionValue.toUpperCase(), optionsarray) < 0) {                            
        $("" + "#" + options.OptionName + "").append('<option value="' + values.sku + '">' + values.OptionValue + '</option>');           
    }
    optionsarray.push(values.OptionValue.toUpperCase());
}); 
```

见：[http ://api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

# android - 从 android 中的 accountmanager 获取 Dropbox 帐户的身份验证令牌

> ID：12916336
> 
> 赞同：2
> 
> 时间：2012-10-16T13:57:26.503
> 
> 标签：android, oauth, dropbox, accountmanager

我正在尝试从帐户管理器获取设备中配置的保管箱帐户的身份验证令牌。我在用

`accountManager.getAuthToken(account, "DROPBOX",null,Hello.this, new GetAuthTokenCallback(), null);//account"`是保管箱帐户

我看到一个允许/拒绝页面。我单击允许，但根本没有调用回调，并且我没有获得身份验证令牌。我得到了一个谷歌帐户的 authtoken（使用不同的 authtokentype）。我错过了什么。我不确定`authTokenType`Dropbox 的参数。还有任何其他特定于 dropbox 的参数，例如我缺少的 bundle 参数。这种方式可以用于保管箱吗？

检查下面的功能参数

```
public AccountManagerFuture<Bundle> getAuthToken (Account account, String authTokenType, Bundle options, Activity activity, AccountManagerCallback<Bundle> callback, Handler handler) 
```

链接：http: [//developer.android.com/reference/android/accounts/AccountManager.html](http://developer.android.com/reference/android/accounts/AccountManager.html)

**更新**

1.  我假设由于我们能够在 android Accounts and Sync(Settings) 中创建一个保管箱帐户，因此必须有一个保管箱身份验证器，它具有 AbstractAccountAuthenticator 中实现的所有功能，包括 getAuthToken()。所以我认为Dropbox应该支持提供身份验证令牌。

2.  Dropbox 也使用 oauth1，而客户经理使用 outh 2.0。所以这是一个问题。有人可以对此发表评论吗？

编辑： UPADATE 2 根本没有出现。我认为这与 oauth1 或 2 无关。正如 Nikolay 指出的那样，它只是服务提供商是否通过客户经理公开了身份验证。（因为我是为使用 oauth1.0 的 twitter 做的）

那么有没有人通过客户经理成功获得了Dropbox的身份验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:09:34.640

AFAIK，Dropbox 使用 OAuth。除非他们在某个地方记录他们的帐户提供商能够为您提供 OAuth 令牌，否则您尝试做的事情将行不通。'authToken' 参数是特定于帐户提供商的，这就是 API 参考中没有值列表的原因。请参阅 Dropbox API 手册（如果有）。

# c# - C#：有什么简单的方法可以将字符串转换为 RTF？

> ID：12916338
> 
> 赞同：2
> 
> 时间：2012-10-16T13:57:27.690
> 
> 标签：c#, string, converter, rtf

> **可能重复：**
> [如何在 C# 中将字符串转换为 RTF？](https://stackoverflow.com/questions/4795709/how-to-convert-a-string-to-rtf-in-c)

我想知道是否有一种简单的方法将字符串转换为 C# 中的 RTF。

不仅是标准字符，还有特殊字符，例如 €ƒ…†‡ to。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:00:02.413

使用 RichTextBox 控件。您可以将它的`Text`属性设置为字符串，然后取回它的`Rtf`属性。

# c# - 复杂类型在 ApiController 参数中为空

> ID：12916340
> 
> 赞同：54
> 
> 时间：2012-10-16T13:57:34.907
> 
> 标签：c#, ajax, json, asp.net-web-api

我不知道为什么我的参数“ParametroFiltro Filtro”变空，其他参数“page”和“pageSize”变正常。

```
public class ParametroFiltro
{
    public string Codigo { get; set; }
    public string Descricao { get; set; }
} 
```

我的 ApiController 获取方法：

```
public PagedDataModel<ParametroDTO> Get(ParametroFiltro Filtro, int page, int pageSize) 
```

我的ajax调用：

```
var fullUrl = "/api/" + self.Api;
$.ajax({
    url: fullUrl,
    type: 'GET',
    dataType: 'json',
    data: { Filtro: { Codigo: '_1', Descricao: 'TESTE' }, page: 1, pageSize: 10 },
    success: function (result) {
        alert(result.Data.length);
        self.Parametros(result.Data);
    }
}); 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-10-16T14:14:27.903

您正在尝试使用`GET`方法发送复杂对象。失败的原因是`GET`方法不能有正文，并且所有值都被编码到 URL 中。您可以使用 来完成这项工作`[FromUri]`，但首先您需要更改客户端代码：

```
$.ajax({
    url: fullUrl,
    type: 'GET',
    dataType: 'json',
    data: { Codigo: '_1', Descricao: 'TESTE', page: 1, pageSize: 10 },
    success: function (result) {
        alert(result.Data.length);
        self.Parametros(result.Data);
    }
}); 
```

如果您像这样更改您的操作方法，这种方式`[FromUri]`将能够直接从 URL 中获取您的复杂对象属性：

```
public PagedDataModel<ParametroDTO> Get([FromUri]ParametroFiltro Filtro, int page, int pageSize) 
```

您以前的方法宁愿使用`POST`可以具有主体的方法（但您仍然需要使用`JSON.stringify()`将主体格式化为 JSON）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-16T14:14:39.383

`contentType`在进行 ajax 调用时提供该属性。使用[`JSON.stringify`](http://msdn.microsoft.com/en-us/library/cc836459%28v=vs.94%29.aspx)方法构建要发布的 JSON 数据。将类型更改为`POST`，MVC 模型绑定会将发布的数据绑定到您的类对象。

```
var filter = { "Filtro": { "Codigo": "_1", "Descricao": "TESTE" }, 
                                               "page": "1", "pageSize": "10" }; 
$.ajax({
    url: fullUrl,
    type: 'POST',
    dataType: 'json',
    contentType: 'application/json',
    data: JSON.stringify(filter),
    success: function (result) {
        alert(result.Data.length);
        self.Parametros(result.Data);
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-09T08:43:24.433

也可以通过[Newtonsoft.Json.Linq](https://www.nuget.org/packages/Newtonsoft.Json) JObject 访问 POST 变量。

例如，这个 POST：

```
$.ajax({
    type: 'POST',
    url: 'URL',
    data: { 'Note': note, 'Story': story },
    dataType: 'text',
    success: function (data) { }
}); 
```

可以像这样在 APIController 中访问：

```
public void Update([FromBody]JObject data)
{
    var Note = (String)data["Note"];
    var Story = (String)data["Story"];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-14T10:11:01.857

如果您将 json 数据附加到查询字符串，并稍后在 web api 端解析它。你也可以解析复杂的对象。它比发布 json 对象更有用，尤其是在一些特殊的 httpget 需求案例中。

```
//javascript file 
    var data = { UserID: "10", UserName: "Long", AppInstanceID: "100", ProcessGUID: "BF1CC2EB-D9BD-45FD-BF87-939DD8FF9071" };
    var request = JSON.stringify(data);
    request = encodeURIComponent(request);

    doAjaxGet("/ProductWebApi/api/Workflow/StartProcess?data=", request, function (result) {
        window.console.log(result);
    });

    //webapi file:
    [HttpGet]
    public ResponseResult StartProcess()
    {
        dynamic queryJson = ParseHttpGetJson(Request.RequestUri.Query);
            int appInstanceID = int.Parse(queryJson.AppInstanceID.Value);
        Guid processGUID = Guid.Parse(queryJson.ProcessGUID.Value);
        int userID = int.Parse(queryJson.UserID.Value);
        string userName = queryJson.UserName.Value;
    }

    //utility function:
    public static dynamic ParseHttpGetJson(string query)
    {
        if (!string.IsNullOrEmpty(query))
        {
            try
            {
                var json = query.Substring(7, query.Length - 7); //seperate ?data= characters
                json = System.Web.HttpUtility.UrlDecode(json);
                dynamic queryJson = JsonConvert.DeserializeObject<dynamic>(json);

                return queryJson;
            }
            catch (System.Exception e)
            {
                throw new ApplicationException("can't deserialize object as wrong string content！", e);
            }
        }
        else
        {
            return null;
        }
    } 
```

# cordova - PhoneGap的Web应用程序，我应该先单独开发吗？

> ID：12916342
> 
> 赞同：2
> 
> 时间：2012-10-16T13:57:42.177
> 
> 标签：cordova

所以我打算使用PhoneGap开发一个应用程序。

我还将一边学习 jQuery，所以想知道是否可以在 PhoneGap 环境之外开发应用程序的核心，即记事本 + 浏览器？

大多数应用程序仅包含对 API 的 UI 和 Ajax 调用。我认为在 DG 之外开发和调试会更容易。

我担心我需要修补我的代码负载才能让它在 PG 中工作，或者它只是一个以最小的更改将其放入的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:16:01.207

是的，您应该先在 Web 浏览器中构建尽可能多的应用程序，然后再使用 PhoneGap 将其封装到本机应用程序中。当然，使用 Chrome/Safari Web 开发工具调试 HTML 会更容易。当您最终将其封装到本机应用程序中时，您可以使用[Weinre](https://people.apache.org/~pmuellr/weinre/)远程调试您的应用程序。

此外，请查看[jQuery Mobile](http://jquerymobile.com/test/docs/pages/phonegap.html)文档，了解如何设置 AJAX 连接以解决 CORS 限制。

# iphone - 如何 NSLog 核心数据数据库的内容

> ID：12916347
> 
> 赞同：0
> 
> 时间：2012-10-16T13:57:53.800
> 
> 标签：iphone, core-data

在我的应用程序中，我`coredata`用来存储有关文档的详细信息

这是我的代码

```
-(void)writeToDatabase:(UIManagedDocument *)newdocument
    {
     Images *image =[NSEntityDescription insertNewObjectForEntityForName:@"Images" inManagedObjectContext:newdocument.managedObjectContext];  
      image.album = @"Album 1";
      image.date = @"October";
      image.share = @"Not shared yet"; } 
```

在上面的代码中

```
 1.Images is the core data entity.

    2.I have inserted data in this fashion(temporarily) just to check. 
```

我怎么能`NSLog`价值观？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:34:18.043

试试这个，

假设 coredata 中的属性值为 Strings

```
 NSLog(@"Image Name %@",image.album);
 NSLog(@"Data %@",image.date);
 NSLog(@"Share Name %@",image.share); 
```

希望能帮助到你。

# css - 更改 CSS3 Rotate Transitiion 的 End 行为

> ID：12916348
> 
> 赞同：1
> 
> 时间：2012-10-16T13:57:56.583
> 
> 标签：css, css-transitions

我在一个按钮上有一个旋转（360度）CSS转换，默认css是旋转（0度）。

当应用该rotate(360deg) 值的类不再存在时，浏览器会自动倒**回到**默认的rotate(0deg)。

默认情况下，随着动画顺时针方向，我宁愿最终行为是顺时针方向继续到默认值 0，而不是回滚（逆时针方向）。

我可以指定这种行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:06:30.887

我认为你还不能，反正我不知道。我试图自己得到类似的东西。很确定 Jquery 会完成这项工作，我实际上并没有这样做，但它应该是这样的

```
$("#container").rotate({ 
```

绑定：{ mouseover : function() { $(this).rotate({animateTo:360}) },

```
 } 
```

});

**编辑**对不起，它是一个 JQuery 插件，不包含在其中。这是一个链接[http://code.google.com/p/jqueryrotate/wiki/Examples](http://code.google.com/p/jqueryrotate/wiki/Examples)

**第二次编辑**认为我已经使用关键帧解决了它。将其放在您的 css 文件中的任何位置：

```
@-webkit-keyframes Rotate {
0% {
    -webkit-transform:rotate(0deg);
}
100% {
    -webkit-transform:rotate(360deg);
} } 
```

然后把它放在你的悬停动作中：

```
.button:hover{
-webkit-animation-name: Rotate;
-webkit-animation-duration: 0.5s;
-webkit-animation-iteration-count: 1;
-webkit-animation-timing-function: linear; 
} 
```

应该做你想做的，为我工作。

# bash - Shell 脚本读取缺少最后一行

> ID：12916352
> 
> 赞同：98
> 
> 时间：2012-10-16T13:58:07.813
> 
> 标签：bash, process

我有一个 bash shell 脚本的奇怪问题，我希望能对此有所了解。

我的团队正在编写一个脚本，该脚本遍历文件中的行并检查每一行中的内容。我们有一个错误，当通过将不同脚本排列在一起的自动化流程运行时，最后一行没有被看到。

用于遍历文件中行的代码（存储`DATAFILE`在

```
cat "$DATAFILE" | while read line 
```

我们可以从命令行运行脚本，它会看到文件中的每一行，包括最后一行，就好了。但是，当由自动化进程运行时（它运行在相关脚本之前生成 DATAFILE 的脚本），永远不会看到最后一行。

我们更新了代码以使用以下代码来迭代行，问题就解决了：

```
for line in `cat "$DATAFILE"` 
```

*注意：DATAFILE 在文件末尾没有任何换行符。*

我的问题是两部分......为什么原始代码看不到最后一行，为什么这会有所不同？

我只是想我能想出为什么最后一行不会被看到是：

*   之前写入文件的进程依赖于进程结束来关闭文件描述符。
*   问题脚本启动并提前打开文件的速度足够快，虽然前一个进程已经“结束”，但它还没有“关闭/清理”到足以让系统自动关闭文件描述符。

话虽如此，似乎如果您在 shell 脚本中有 2 个命令，那么在脚本运行第二个命令时，第一个命令应该完全关闭。

任何对问题的见解，尤其是第一个问题，将不胜感激。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2012-10-16T14:18:26.997

C 标准规定文本文件必须以换行符结尾，否则最后一个换行符之后的数据可能无法正确读取。

> ISO/IEC 9899:2011 §7.21.2 流
> 
> 文本流是组成行的有序字符序列，每行由零个或多个字符加上一个终止换行符组成。最后一行是否需要终止换行符是实现定义的。可能必须在输入和输出上添加、更改或删除字符，以符合在主机环境中表示文本的不同约定。因此，流中的字符与外部表示中的字符之间不需要一一对应。只有在以下情况下，从文本流中读取的数据必须与之前写入该流的数据相比较： 数据仅包含打印字符和控制字符水平制表符和换行符；空格字符前面没有换行符；最后一个字符是换行符。读入时是否出现在换行符之前立即写出的空格字符是实现定义的。

我不会期望文件末尾缺少换行符会导致`bash`（或任何 Unix shell）出现问题，但这似乎是可重现的问题（`$` 是此输出中的提示）：

```
$ echo xxx\\c
xxx$ { echo abc; echo def; echo ghi; echo xxx\\c; } > y
$ cat y
abc
def
ghi
xxx$
$ while read line; do echo $line; done < y
abc
def
ghi
$ bash -c 'while read line; do echo $line; done < y'
abc
def
ghi
$ ksh -c 'while read line; do echo $line; done < y'
abc
def
ghi
$ zsh -c 'while read line; do echo $line; done < y'
abc
def
ghi
$ for line in $(<y); do echo $line; done      # Preferred notation in bash
abc
def
ghi
xxx
$ for line in $(cat y); do echo $line; done   # UUOC Award pending
abc
def
ghi
xxx
$ 
```

它也不限于`bash`— Korn shell ( `ksh`) 并且其`zsh`行为也是如此。我生活，我学习；感谢您提出这个问题。

如上面的代码所示，该`cat`命令读取整个文件。该`for line in `cat $DATAFILE`` 技术收集所有输出并用单个空白替换任意序列的空白（我得出结论，文件中的每一行都不包含空白）。

在 Mac OS X 10.7.5 上测试。

* * *

### POSIX 说什么？

POSIX[`read`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/read.html)命令规范说：

> 读取实用程序应从标准输入读取单行。
> 
> 默认情况下，除非`-r`指定选项，否则 <backslash> 应充当转义字符。未转义的 <backslash> 应保留后面字符的文字值，<newline> 除外。如果 <newline> 跟在 <backslash> 之后，read 实用程序应将其解释为行继续。<反斜杠> 和`<newline>`应在将输入拆分为字段之前删除。在将输入拆分为字段后，应删除所有其他未转义的 <backslash> 字符。
> 
> 如果标准输入是终端设备并且调用 shell 是交互式的，则 read 在读取以 <backslash> <newline> 结尾的输入行时应提示输入续行，除非`-r`指定了该选项。
> 
> 应从输入中删除终止的 <newline> **（如果有） ，并将结果拆分为参数扩展结果的 shell 中的字段（请参阅字段拆分）；**[...]

请注意“（如果有）”（强调在引号中添加）！在我看来，如果没有换行符，它仍然应该读取结果。另一方面，它还说：

> 标准输入
> 
> 标准输入应为文本文件。

然后你回到关于不以换行符结尾的文件是否是文本文件的辩论。

但是，同一页面上的理由是：

> 虽然标准输入必须是文本文件，因此总是以 <newline> 结尾（除非它是空文件），但在`-r`不使用该选项时处理续行可能会导致输入不以<换行符>。如果输入文件的最后一行以 <backslash> <newline> 结尾，则会发生这种情况。正是出于这个原因，在描述中的“应从输入中删除终止的<换行符>（如果有）”中使用了“如果有”。这并不是放宽标准输入是文本文件的要求。

该基本原理必须意味着文本文件应该以换行符结尾。

文本文件的 POSIX 定义是：

> [3.395](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_395)文本文件
> 
> 包含组织成零行或多行的字符的文件。这些行不包含 NUL 字符，长度不能超过 {LINE_MAX} 个字节，包括 <newline> 字符。尽管 POSIX.1-2008 不区分文本文件和二进制文件（参见 ISO C 标准），但许多实用程序仅在对文本文件进行操作时产生可预测或有意义的输出。具有此类限制的标准实用程序始终在其 STDIN 或 INPUT FILES 部分中指定“文本文件”。

这并没有直接规定“以 <newline> 结尾”，但确实遵循 C 标准，并且确实说“包含组织成零行或多**行**的字符的文件”，当我们查看“行”的 POSIX 定义时“ 它说：

> [3.206](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_206)线
> 
> 零个或多个非 <newline> 字符加上终止 <newline> 字符的序列。

因此，根据 POSIX 定义，文件必须以终止换行符结尾，因为它由行组成，并且每行必须以终止换行符结尾。

* * *

### “无终端换行”问题的解决方案

注意[戈登戴维森](https://stackoverflow.com/users/89817/gordon-davisson)的[回答](https://stackoverflow.com/questions/12916352/shell-script-read-missing-last-line/12919766#12919766)。一个简单的测试表明他的观察是准确的：

```
$ while read line; do echo $line; done < y; echo $line
abc
def
ghi
xxx
$ 
```

因此，他的技术：

```
while read line || [ -n "$line" ]; do echo $line; done < y 
```

或者：

```
cat y | while read line || [ -n "$line" ]; do echo $line; done 
```

将适用于最后没有换行符的文件（至少在我的机器上）。

* * *

我仍然惊讶地发现 shell 删除了输入的最后一段（不能称为行，因为它不以换行符结尾），但在 POSIX 中可能有足够的理由这样做。显然，最好确保您的文本文件确实是以换行符结尾的文本文件。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2012-10-16T16:57:30.973

根据[读取命令的 POSIX 规范，](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/read.html)如果“检测到文件结束或发生错误”，它应该返回非零状态。由于在读取最后“行”时检测到 EOF，因此它设置`$line`然后返回错误状态，并且错误状态会阻止循环在最后“行”上执行。解决方案很简单：如果读取命令成功或读取任何内容，则执行循环`$line`。

```
while read line || [ -n "$line" ]; do 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-07-14T05:43:36.443

# 添加一些附加信息：

1.  无需使用`cat`while 循环。`while ...;do something;done<file`足够的。
2.  [不要阅读带有`for`.](http://mywiki.wooledge.org/DontReadLinesWithFor)

使用 while 循环读取行时：

1.  正确设置`IFS`（否则可能会丢失缩进）。
2.  [您几乎应该始终将 -r 选项与 read 一起使用。](http://mywiki.wooledge.org/BashFAQ/001)

在满足上述要求的情况下，适当的 while 循环将如下所示：

```
while IFS= read -r line; do
  ...
done <file 
```

并使其与末尾没有换行符的文件一起使用（从[此处](https://stackoverflow.com/a/31397497/3744681)重新发布我的解决方案）：

```
while IFS= read -r line || [ -n "$line" ]; do
  echo "$line"
done <file 
```

或使用`grep`while 循环：

```
while IFS= read -r line; do
  echo "$line"
done < <(grep "" file) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-04T16:40:07.837

作为一种解决方法，在从文本文件中读取之前，可以将换行符附加到文件中。

```
echo -e "\n" >> $file_path 
```

这将确保读取文件中先前的所有行。我们需要将 -e 参数传递给 echo 以启用转义序列的解释。 [https://superuser.com/questions/313938/shell-script-echo-new-line-to-file](https://superuser.com/questions/313938/shell-script-echo-new-line-to-file)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T15:44:31.077

我在命令行中对此进行了测试

```
# create dummy file. last line doesn't end with newline
printf "%i\n%i\nNo-newline-here" >testing 
```

使用您的第一个表单进行测试（管道到 while-loop）

```
cat testing | while read line; do echo $line; done 
```

这错过了最后一行，这是有道理的，因为`read`只得到以换行符结尾的输入。

* * *

使用第二种形式进行测试（命令替换）

```
for line in `cat testbed1` ; do echo $line; done 
```

这也得到最后一行

* * *

`read`只有当它被换行符终止时才会得到输入，这就是你错过最后一行的原因。

另一方面，在第二种形式

```
`cat testing` 
```

扩展为

```
line1\nline2\n...lineM 
```

它被外壳使用 IFS 分隔成多个字段，所以你得到

```
line1 line2 line3 ... lineM 
```

这就是为什么你仍然得到最后一行。

p/s：我不明白你是如何让第一个表格工作的......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-23T17:33:24.787

使用 sed 匹配文件的最后一行，如果不存在，它将附加一个换行符，并让它对文件进行内联替换：

`sed -i '' -e '$a\' file`

代码来自这个 stackexchange[链接](https://unix.stackexchange.com/questions/31947/how-to-add-a-newline-to-the-end-of-a-file)

注意：我添加了空单引号，`-i ''`因为至少在 OS X 中，`-i`它被`-e`用作备份文件的文件扩展名。我很乐意对原始帖子发表评论，但缺少 50 分。也许这会让我在这个线程中获得一些，谢谢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-03T18:53:02.987

我有一个类似的问题。我正在做一个文件的猫，将它传递给一个排序，然后将结果传递给一个'while read var1 var2 var3'。即： ***cat $FILE|sort -k3|while read Count IP Name do*** “do”下的工作是一个 if 语句，它标识了 $Name 字段中的更改数据，并根据更改或没有更改进行 $Count 的总和或打印报告的总和行。我还遇到了无法将最后一行打印到报告的问题。我采用了将 cat/sort 重定向到新文件的简单权宜之计，将换行符回显到该新文件，然后在新文件上运行我的“同时读取计数 IP 名称”并获得成功。即： ***cat $FILE|sort -k3 > NEWFILE echo "\n" >> NEWFILE cat NEWFILE |while read Count IP Name do*** 有时，简单、不优雅是最好的方法。

# haskell - 如何从 unixtime 转换为 Haskell 中的日期/时间？

> ID：12916353
> 
> 赞同：6
> 
> 时间：2012-10-16T13:58:11.417
> 
> 标签：haskell

所以，设置是我有时间，以秒为单位，从纪元开始，我想把它变成我能真正理解的日期。我如何在 Haskell 中做到这一点？如果可能，我将如何从这种新编码中提取天/小时/分钟？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T14:12:18.870

[Data.Time.Clock.POSIX](http://hackage.haskell.org/packages/archive/time/1.4.0.1/doc/html/Data-Time-Clock-POSIX.html)具有`posixSecondsToUTCTime`（您可以将另一种数字类型转换为预期的输入`POSIXTime`）`realToFrac`。

[Data.Time.Calendar](http://hackage.haskell.org/packages/archive/time/1.4.0.1/doc/html/Data-Time-Calendar.html)有很多你需要从中提取日、月等的东西，`Day`它们构成了 的一部分`UTCTime`，包的其余部分还有其他有用的实用程序。

例子：

```
Prelude> import Data.Time.Format.ISO8601
Prelude Data.Time.Format.ISO8601> import Data.Time.Clock.POSIX 
Prelude Data.Time.Format.ISO8601 Data.Time.Clock.POSIX> iso8601Show $ posixSecondsToUTCTime $ 100
"1970-01-01T00:01:40Z" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-16T14:19:52.143

使用默认安装的[时间库：](http://hackage.haskell.org/package/time)

```
import Data.Time.Clock.POSIX
import Data.Time.Format
import System.Locale

main = print $ formatTime defaultTimeLocale  "%c" $ posixSecondsToUTCTime 10 
```

该库具有广泛的日期操作功能（例如日期减法，获取组件，如日月等）。如果您想提取组件只是为了将它们转换为字符串，您可以使用`formatTime`.

# java - 字符串到堆栈和队列

> ID：12916356
> 
> 赞同：1
> 
> 时间：2012-10-16T13:58:21.340
> 
> 标签：java, string, stack, queue

我正在读取一个字符串，但在将其推入堆栈并将其排入队列之前，我需要在保持顺序的同时消除所有空格和标点符号。

我是 Java 新手，并尝试了以下*引发异常*的代码：

```
 for (int i = 0;i < input.length(); i++){
            String character = Character.toString(input.charAt(i));
            if (charChecker(character)){
                stack.push(character);
                queue.enqueue(character);
            }
        }

    private static boolean charChecker (String character) {
        if (character.equals(" ") || character.equals(".") ||
            character.equals("?") || character.equals("!") ||
            character.equals(",") || character.equals(";") ||
            character.equals(":") || character.equals("-"))
            return false;
        else
            return true;
    }

    int diff = 0;
    for (int i = 0; i < input.length(); i++) {
        String char1 = stack.pop();
        String char2 = queue.dequeue();
        if (!(char1.equalsIgnoreCase(char2))) {
            diff++;
        }
    } 
```

**输出：**

```
Enter file name: input1.txt
evil live
Exception in thread "main" java.util.EmptyStackException
  at Stack.pop(Stack.java:22)
  at Palindrome.main(Palindrome.java:57) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:02:21.833

任何你不能这样做的理由：

```
String output = input.replaceAll("[.?!,;:-]", ""); 
```

对于所有标点符号和空格，您可以使用`\W`：

```
String output = input.replaceAll("\\W", ""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:00:25.127

***请发布完整的代码片段，因为代码片段不包含引发错误的行。***

它说您尝试`pop()`操作的堆栈是空的。您确定`pop`在堆栈上推送某些内容后会调用它吗？

我很确定您`pop`在将任何内容放入堆栈之前正在尝试操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:03:48.697

问题是你弹出错误的次数。

您没有将`input.legnth()`字符数放在堆栈上，而是多次调用 pop() 。这是因为您没有将空格和标点字符放在堆栈上。

尝试使用：

```
while(!stack.empty()) {
        String char1 = stack.pop();
        String char2 = queue.dequeue();
        if (!(char1.equalsIgnoreCase(char2))) {
            diff++;
        }
    } 
```

# php - 在我的页面中添加 head 部分的 php 包含是一种好习惯吗？

> ID：12916358
> 
> 赞同：8
> 
> 时间：2012-10-16T13:58:32.883
> 
> 标签：php, html, web-standards

我正在创建我的投资组合网站，并且我想将 head 部分作为 php 包含在我的页面上。原因是该站点将有相当多的页面，我希望稍后对诸如整理 css 文件之类的事情进行更改。

例如;

```
<head>
    <?php include('head.php'); ?>
</head> 
```

与下面的所有内容相反，每一页都显示：

```
 <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/1140.css">
    <link rel="stylesheet" href="css/ie.css">
    <script src="js/vendor/modernizr-2.6.1.min.js"></script>
</head> 
```

我只是不知道这是否是一个好的做法，因为这是我的投资组合网站，我需要从一开始就正确的代码，因为他们可能也会研究它的标准。

你对人们有什么意见和建议？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-16T14:08:39.937

是的，这很标准。但不是写：

```
<head>
    <?php include('head.php'); ?>
</head> 
```

你应该把标签放在里面`head.php`。我说这更好，因为里面的东西`head.php`没有头部标签就没有意义，所以它们有点联系在一起。将如此链接的内容连接到一个文件中，而不必`head`为每个页面重复打开和关闭标签，这是一种很好的做法。

`header.php`实际上，拥有,`body.php`和分别具有以下文件的文件甚至是一种很好的做法（并且是常用的）`footer.php`：

**头文件.php**

```
<html>
<head>
...
</head>
<body> 
```

**正文.php**

```
... 
```

**页脚.php**

```
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T14:11:45.783

我在我的应用程序中这样做，但我发现这不是一个好主意，因为你的许多样式表、javascripts 等在一个 php 文件中，包括 head 部分，你会遇到将它包含在 php 中的问题嵌套文件夹中的文件。这个问题是因为相对路径。如果您可以使用绝对路径，那么没关系，否则这不是一个好主意......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-16T14:01:29.620

PHP Includes 一直都是这样使用的。每当您的内容在每个页面上都完全相同时，使用包含非常有帮助

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-18T08:34:16.333

这是一个老话题，但我使用

```
 <?php include_once("phpinclude/head.txt"); ?> 
```

phpinclude 是它自己的文件夹，我将页脚、页眉和公共位置信息保留在该文件夹中。.js 和 .css 也有它自己的。

编辑：我现在使用 require 。我宁愿让代码失败并死掉，也不愿给出一些随机字符串。它们是相同的，除了一个模具，另一个将打印出错误或随机代码。这适用于学习 PHP 的人，而不是老头。

# python - Spynner 不从 URL 加载 html

> ID：12916360
> 
> 赞同：0
> 
> 时间：2012-10-16T13:58:35.033
> 
> 标签：python, screen-scraping, spynner

我使用 spynner 从网站上抓取数据。我的代码是这样的：

```
import spynner

br = spynner.Browser()
br.load("http://www.venere.com/it/hotel/roma/hotel-ferrari/#reviews")
text = br._get_html() 
```

此代码无法加载整个 html 页面。这是我收到的 html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>

<script type="text/javascript">(function(){var d=document,m=d.cookie.match(/_abs=(([or])[a-z]*)/i)
v_abs=m?m[1].toUpperCase():'N'
if(m){d.cookie='_abs='+v_abs+'; path=/; domain=.venere.com';if(m[2]=='r')location.reload(true)}
v_abp='--OO--OOO-OO-O'
v_abu=[,,1,1,,,1,1,1,,1,1,,1]})() 
```

我的问题是：如何加载完整的 html？

更多信息：

我试过：

```
import spynner
br = spynner.Browser()
respond = br.load("http://www.venere.com/it/hotel/roma/hotel-ferrari/#reviews")

if respond == None:
   br.wait_load () 
```

但加载 html 永远不会完成或确定。问题是什么？我要疯了。

再说一遍：我在 Django 1.3 中工作。如果我在 Python (2.7) 中使用相同的代码，有时会加载所有 html。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:38:04.800

现在，在您检查 test.html 的内容后，您会发现 id="feedback-...somenumber..." 的 p 元素：

```
import spynner

def content_ready(browser):
    if 'id="feedback-' in browser.html:
        return True

br = spynner.Browser()
br.load("http://www.venere.com/it/hotel/roma/hotel-ferrari/#reviews", wait_callback=content_ready)

with open("test.html", "w") as hf:
    hf.write(br.html.encode("utf-8")) 
```

# iphone - 如何使适用于 iOS 的 Adob e AIR 应用程序同时支持新旧屏幕尺寸

> ID：12916361
> 
> 赞同：2
> 
> 时间：2012-10-16T13:58:40.280
> 
> 标签：iphone, ios, actionscript-3, flash, air

我已经做了几年 Flash 动画师，最近尝试使用 Flash CS6 和 AS3 开发一个简单的 iOS 应用程序。

当我开始开发时，我正在为 iPhone 4S 的屏幕尺寸创建，但是现在随着 iPhone 5 的发布，新的屏幕尺寸显然不会填满屏幕，导致顶部和底部出现黑条屏幕。

我有三个问题要问：

1.  是否可以为不同的设备在 App Store 上发布两个不同版本的应用程序，还是必须是通用的？（我相信答案是后者，但我找不到明确的答案）

2.  是否有可能有一个与 iPhone 5 的较大显示屏相匹配的舞台尺寸，但切断了以前 iPhone 尺寸的底部（例如），实际上只是为 iPhone 5 用户在屏幕底部添加了一些信息？

3.  如果 (2) 不可能，是否有可用的编码示例更改屏幕上项目的位置？例如，我有一个标题和任务栏以及一个背景，我可以将它编码为拉伸到设备屏幕的大小而不是舞台的大小吗？我是否需要更改舞台大小，或者是否有代码可以为我做到这一点？

我对 AS3 的编程方面很陌生，如果有您认为我应该知道的答案，我很抱歉，但我非常感谢您抽出时间阅读和回答，我提前感谢您的回复！

本·卡汉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T20:05:25.910

虽然您的所有选项都是可能的，但您需要确保您的程序根据屏幕尺寸、像素密度和方向动态地自行布局和调整视觉资源的大小。

更多在这里：

[一个应用，五个屏幕（包括iPad）](http://blogs.adobe.com/cantrell/archives/2010/04/one_application_five_screens.html)

和

[编写多屏 AIR 应用程序](http://www.adobe.com/devnet/air/flex/articles/writing_multiscreen_air_apps.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T16:34:20.690

你应该考虑做3号！1 将难以维护，2 将激怒屏幕较小的用户。如果您将应用程序设计得更灵活一点，那也意味着您有一个可以在 android 上运行的应用程序；）

我没有任何特定的代码来处理不同的屏幕尺寸，但我记得当 Adob​​e 推出面向移动设备的 FP 时，我读过它。这篇[文章](http://www.kongregate.com/pages/multiscreen-best-practices)为移动开发提供了很多很好的建议（即使它有点旧）——也许你可以通过谷歌找到更新的东西:)

# android - regex.PatternSyntaxException 用电话号码中的空格替换 + 号时产生异常

> ID：12916364
> 
> 赞同：0
> 
> 时间：2012-10-16T13:58:49.033
> 
> 标签：android, string

当我使用以下代码用空格替换电话号码+符号时，然后生成异常

代码：

```
phonenum.replaceAll("+",""); 
```

例外：

```
java.util.regex.PatternSyntaxException: Syntax error U_REGEX_RULE_SYNTAX near index 1: 
```

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:02:09.117

该`replaceAll`方法似乎使用了正则表达式，所以我猜它会失败，因为`+`它不是一个有效的正则表达式，`+`必须有一些东西要重复。

尝试`phonenum.replaceAll("\\+","")`转义它并匹配文字“+”。

# wpf - 如何在 Visual Studio 2010 中将现有数据模型添加为数据源？

> ID：12916366
> 
> 赞同：0
> 
> 时间：2012-10-16T13:58:50.577
> 
> 标签：wpf, visual-studio-2010, entity-framework, datasource

我正在尝试使用 .edmx 文件作为 Visual Studio 2010 中的数据源的简单 WPF 应用程序。

我不知道我做了什么，但突然间数据源窗格/窗口现在是空的，但 .edmx 文件仍然是我项目的一部分。

数据源窗口只有“添加新数据源”选项；如何使它使用现有的实体模型作为数据源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T22:31:15.433

您应该查看您的应用程序配置，看看您是否可以找到您的 edmx 文件的连接字符串。根据它是 SqlCE 或 SqlServer 的类型，您应该在那里拥有连接信息。

# mysql - 使用 Select sub select 更新语句

> ID：12916369
> 
> 赞同：0
> 
> 时间：2012-10-16T13:58:55.630
> 
> 标签：mysql

我怎样才能完成这项工作 - 给我 #1093 - 您不能在 FROM 子句中指定目标表“订单”进行更新

```
Update Orders set flag = 0 where orders_id = (select orders_id from orders ORDER BY orders_id DESC LIMIT 1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:04:29.350

您需要将其包装在子查询中（*创建临时表*）

```
Update Orders 
set flag = 0 
where orders_id = 
    (
        SELECT x.orders_id
        FROM
        (
            select orders_id 
            from orders 
            ORDER BY orders_id DESC 
            LIMIT 1
        ) x
    ) 
```

或者

```
Update Orders 
set flag = 0 
where orders_id = 
    (
        SELECT x.orders_id
        FROM
        (
            select MAX(orders_id) orders_id 
            from orders 
        ) x
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:05:28.167

看起来您正在尝试更新表中的最后一个订单？尝试

```
Update Orders set flag = 0 ORDER BY orders_id DESC LIMIT 1; 
```

Mysql 不支持在子查询中使用表时更新表。

# iphone - 在 Objective-C 中使用弱引用检查对象是否被释放

> ID：12916374
> 
> 赞同：1
> 
> 时间：2012-10-16T13:59:10.653
> 
> 标签：iphone, objective-c

我正在使用ARC。
有时我写了下面的代码来断言一个对象应该被释放：

```
__weak weakVariableOrProperty = someObject;
....

someObject = nil;
// or someObject = anotherObject;
....

if (weakVariableOrProperty) {
    @throw [NSException exceptionWithName:NSInternalInconsistencyException reason:@"Object not deallocated" userInfo:nil];
} 
```

例如，我使用这段代码在创建新的视图控制器之前检查视图控制器是否被释放。

我相信在最后一个强变量或属性设置为 nil 或其他对象之后，弱变量或弱属性**立即设置为 nil。**

到目前为止，这段代码正在按我的预期工作。

使用弱变量或属性来检查对象是否被释放是常用的技术吗？
这段代码将来可能会导致问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:25:36.403

> I believe that weak variable or weak property is set to nil **immediately** after last strong variable or property was set to nil or another object.

This is not exactly true, because an object could be *autoreleased*. In this case, the last strong reference may be gone, but the reference count of the instance would remain positive. In cases like that, the `__weak` reference would not be `nil`-ed out until the autorelease process takes place.

> Is using weak variable or property to check if object is deallocated a technique commonly used?

I seriously doubt that this technique has gained much popularity, because ARC is a relatively new thing to Objective C. However, the technique appears valid.

> Is it possible that this code will cause problem in the future?

This is very hard to guess, because the [ARC Specification](http://clang.llvm.org/docs/AutomaticReferenceCounting.html) does not make any specific guarantees about the timing of `nil`-ing out the references, and because the spec allows compilers to optimize sequences of `retain` and `release` messages that they send to ARC objects.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:56:53.363

您的解释代码将容易出现竞争条件。

在评估条件`weakVariableOrProperty`后，可以释放in 中的对象（因为它仅被弱引用引用）。`if`为避免这种情况，请引入一个普通变量，将其设置为`weakVariableOrProperty`并检查它`nil`。

也就是说，正如@dasblinkenlight 所说，准确地押注一个物体*何时*会消失是很困难的。在引用计数系统中，您不知道还有什么在保留它。它可能会在您检查后消失。您应该能够对您的环境进行足够的限制，以使您知道系统不会将事情松懈，但是自动释放和弱引用都会使事情复杂化。

解决这个问题的最好方法是简单地定义明确的对象生命周期：视图控制器不会永远存在，你明确告诉它们离开等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-18T04:31:55.863

所以我尝试使用这种技术来确保对象总是在后台线程上被释放。我的一些课程的 [dealloc] 的重量适中，可能需要很长时间（10 毫秒），这会稍微冻结主线程。

我决定在主线程上释放所有这些重对象之前将它们添加到一个数组中，然后稍后在后台线程上通过该数组将它们从数组中删除。当时的想法是，该数组将使 retainCount 保持活动状态，直到它可以从后台线程上的数组中删除，然后我可以保证 [dealloc] 的成本不会发生在主线程上。

为此，我有以下代码：

```
while([objectsToDealloc count] && /* other conditions to prevent infinite loop */){
    __weak id ref = [objectsToDealloc lastObject];
    [objectsToDealloc removeLastObject];
    @synchronized(ref){
        // synchronising on ref will retain it if possible.
        // so if its still around,that means we didn't dealloc it
        // like we were asked to.
        // so insert it back into our array. once the object is deallocd
        // it won't be able to be synchronized, because the weak ref will
        // be nil
        if(ref){
            [objectsToDealloc insertObject:ref atIndex:0];
        }
    }
} 
```

这个想法是，如果数组不包含最后一个引用（或者如果对象上有挂起的自动释放，等等），那么弱引用不会为零。然后我会在对象上@synchronize - 同步块将保留 + 释放正在同步的任何对象 - 这将确保`ref`在该块期间保持活动状态。如果它是 nil，那么它就被释放了。如果它不是零，那么我应该将它添加回数组并稍后再检查。

在过去几周使用此代码进行测试后，我不能推荐这种策略来检查已释放的对象。我还没有找到确切的原因，但很少有对象会释放，但 ref 还不会是 nil，所以我会将一个无效的对象添加回数组中。

我只在调试器中发现过一次，尽管我有几次崩溃日志。您可以在下面看到“nil”最终出现在我的数组中，即使上面的代码应该防止它发生。

![NSArray 中的 nil](../Images/506abc4663b6017550bb86a6f3083a63.png)

同样，我建议不要使用这种技术来检测对象何时/是否释放，而是集中精力澄清对象图和关系。

# php - MySQLi，准备好的语句和关联数组

> ID：12916375
> 
> 赞同：0
> 
> 时间：2012-10-16T13:59:14.710
> 
> 标签：php

我从good ol'切换`MySQL`到`MySQLi`（我知道大器晚成）并选择`MySQLi`了`PDO`。

首先，我喜欢关联数组`(eg: $db_data['whatever_field'])`，所以我不能使用准备好的语句，因为它不会返回关联数组（默认情况下/没有变通方法）。

所以我必须自己手动准备我的`MySQLi`陈述，例如：

```
'SELECT * FROM admin_users WHERE email='. $mysqli->real_escape_string($_COOKIE['admin']['email']) .' AND password='. $mysqli->real_escape_string($_COOKIE['admin']['password']); 
```

可以想象，这可能会让人厌烦！有没有短片`$mysqli->real_escape_string()`或者你们是做什么的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:13:31.087

在我的监视下，您不会在 PDO 上使用 Mysqli！

> 首先，我喜欢关联数组（例如：$db_data['whatever_field']），所以我不能使用准备好的语句，因为它不返回关联数组（默认情况下/没有变通方法）。

这是一个糟糕的借口。

```
PDOStatement::fetch 
```

接受可以设置为的获取样式作为第一个参数`PDO::FETCH_ASSOC`。

还，

```
 PDO::setAttribute 
```

使您能够选择默认提取样式，特别是设置`PDO::ATTR_DEFAULT_FETCH_MODE`为`PDO::FETCH_ASSOC`.

参考：

*   [PDOStatement::fetch](http://www.php.net/manual/en/pdostatement.fetch.php)
*   [PDO::setAttribute](http://www.php.net/manual/en/pdo.setattribute.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:19:09.773

如果您准备不需要转义的语句，那是准备语句的主要目的之一。

我支持 Jeffrey 关于为什么使用 PDO 的解释，并且我还想说明 mysqli 是一个奇怪的库，如果你必须要测试的话，真的很难测试。通过引用绑定变量的方式看起来并不容易。我个人建议你重新考虑你的选择。希望有一天我们会弃用 mysql 和 mysqli。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:08:35.180

有一个函数名为`fetch_assoc`. 进一步阅读 php 手册[http://php.net/manual/en/mysqli-result.fetch-assoc.php](http://php.net/manual/en/mysqli-result.fetch-assoc.php)

> mysqli_result::fetch_assoc -- mysqli_fetch_assoc -- 获取结果行作为关联数组

# java - 是否有任何级别的混淆可以“欺骗”instanceof？

> ID：12916379
> 
> 赞同：5
> 
> 时间：2012-10-16T13:59:36.100
> 
> 标签：java, casting, polymorphism, instanceof

我一直在玩这个，到目前为止，我还没有找到任何方法来隐藏或通过混淆层隐藏它的类型来欺骗`instanceof`返回`false`，但这并不意味着这是不可能的，因为我远离最了解 Java 的人。所以特地来请教专家。

我尝试了以下组合，在每种情况下，`instanceof`操作员都能够识别对象的真实/基本类型。

```
public class Test {

    public static void main(String[] args) {
        Object o = new TestObject();
        printType("Base Class", o);

        o = (TestSuperObject)(new TestObject());
        printType("Super Class", o);

        o = (TestInterface)(new TestObject());
        printType("Interface", o);

        o = (TestInterface)((TestSuperObject3)(new TestObject3()));
        printType("Interface on Super Class", o);

        o = (TestSuperObject3)((TestInterface)(new TestObject3()));
        printType("Super Class on Interface", o);
    }

    private static void printType(String testCase, Object o) {
        System.out.println(testCase);
        System.out.println("TestObject:" + (o instanceof TestObject));
        System.out.println("TestObject2:" + (o instanceof TestObject2));
        System.out.println("TestObject3:" + (o instanceof TestObject3));
        System.out.println();
    }

} 
```

这些类被定义为...

```
public class TestObject extends TestSuperObject implements TestInterface
public class TestObject2 extends TestSuperObject implements TestInterface
public interface TestInterface
public class TestSuperObject
public class TestObject3 extends TestSuperObject3
public class TestSuperObject3 implements TestInterface 
```

所以基本上，有没有办法隐藏这些信息或以某种方式丢失类型信息？我不问是因为我有这样做的理由，而是如果可能的话，我想知道它并在未来*保持警惕*。另外，我只是觉得它很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:16:38.780

有可能让自己与 JVM 混淆，`instanceof`但不会。

*   同名但在不同包中的类是不一样的。这意味着你可以做

    ```
    // in one class
    ClassA classA = new ClassA(); // package1.ClassA
    another.test(classA);

    // calls in another class
    public void test(Object o) {
       if (o instanceof ClassA) // package2.ClassA => false 
    ```

*   使用不同的类加载器，包`o.getClass().getName()`是相同的，但由于类加载器不同，`instanceof`返回 false。

*   即使可以将对象分配给任何引用类型，该对象也是`null`并且始终是错误的。`null instanceof ClassB``null`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:04:22.523

> 所以基本上，有没有办法隐藏这些信息或以某种方式丢失类型信息？

不，这是不可能的。

每个对象都有一个真实的类型，Java 的强+静态类型系统使得不可能改变一个对象的类型，或者假装它的实际类型与它的实际类型不同。

* * *

^(（假设有可能陷入本机代码并颠覆 Java 类型系统，但这样做的后果可能非常糟糕......崩溃 - JVM 糟糕。）)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:27:29.480

您可以通过混淆器运行代码。但这基本上是一个重命名。`TestObject`可以重命名为 eg `A`，但`instanceof A`仍然返回正确的结果。

顺便说一句：命名你的类 *Object 是一个坏主意（在面向对象的语言中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:31:49.963

这取决于OP真正想要什么，但这[可能](http://ideone.com/5KtHs)会做到。

基本上我将课程设为私有。这意味着任何`object instanceof Class`代码都不会编译（在私有类的范围之外）。

# java - Wu的非黑色背景的抗锯齿线算法

> ID：12916381
> 
> 赞同：2
> 
> 时间：2012-10-16T13:59:44.103
> 
> 标签：java, math, colors, antialiasing

我已经实现[了 Wu 的 Antialias 线算法](http://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm)，它在黑色背景上效果很好。但是，我遇到了一个问题，使强度与其他颜色一起工作。

我一直在做这样的颜色混合。

```
for(int i =0; i < 3; i++)
        rgbNew[i] = (int) (rgb[i] * brightness + baseRgb[i] * (1 - brightness)); 
```

但是，这似乎只适用于黑白背景（在其他情况下，我得到的结果不正确，如下图所示）。关于我没有考虑的任何建议？

![不正确的图像](../Images/a727fc767621b284c7f7f21d6b03de71.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T17:11:49.813

我的问题最终是我的方法，它分解了一个代表颜色的整数，混合了红色和蓝色。上面的颜色混合是正确的。

# php - 保护 localhost 中的 php 代码

> ID：12916382
> 
> 赞同：2
> 
> 时间：2012-10-16T13:59:59.137
> 
> 标签：php, copy-protection

> **可能重复：**
> [加密 php 代码](https://stackoverflow.com/questions/764927/encrypt-php-code)

我需要保护我的 PHP 代码。情况如下：我在 Linux 中使用 PHP + Apache + MySQL 开发了一个系统（当然）。该系统将与笔记本电脑一起出售。执行将在本地主机中。该系统和笔记本电脑将一起出售。我不想复制我的代码。如何保护我的代码免受复制。

我认为加密分区并输入强密码。那安全吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:06:24.293

如果你真的想保护你的代码，这里有一个关于 PHP 代码混淆的有趣话题：[https ://stackoverflow.com/a/232767/1252290](https://stackoverflow.com/a/232767/1252290)

TL;博士：

> 写执照并请律师

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:07:05.680

您可以获得的唯一安全性是将您的代码托管在您的服务器中，并出售服务，而不是代码。如果你泄露了代码并且你想闯入，他们会的。除了让他们签署 EULA 并在其中指定要保留的权利外，您无能为力。

# javascript - 在我的网站中保存搜索关键字

> ID：12916385
> 
> 赞同：0
> 
> 时间：2012-10-16T14:00:10.467
> 
> 标签：javascript, html, google-search

我正在其中开发一个网站我正在使用谷歌搜索栏，我使用的代码

```
<form  id="form_body" method="get" action="http://www.google.com /search">
    <p>Google Search<input type="text" name="q"/>
    <input type="submit" value="Search"/></p>
</form> 
```

现在的问题是我希望保存输入的搜索关键字我尝试使用此代码

```
<form  id="form_body" method="get" action="http://www.google.com/search">
    <p>Google Search<input type="text" name="q"/>
    <input type="button" onclick="save1()" value="Search"/></p>
</form> 
```

我的 javascript 函数在哪里`save1`不起作用（根本不起作用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:46:07.313

当您`click`在表单中挂钩提交按钮的事件时，它不会在页面卸载时触发/停止触发。相反，挂钩`submit`事件以确保您的代码在页面提交*之前触发。*

```
<form  id="form_body" method="get" action="http://www.google.com/search" onsubmit="return save1();">               
<p>Google Search<input type="text" name="q"/>
<input type="submit" value="Search"/></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:20:55.607

在按钮的提交上创建一个 ajax 调用，该调用会提取文本输入值，然后将其发送到 php 文件以将值存储在数据库中。

# networking - 我如何强制 tcp 丢弃缓冲区中最旧的数据段并接受应用程序在 NS2 中写入的新数据

> ID：12916396
> 
> 赞同：1
> 
> 时间：2012-10-16T14:00:40.540
> 
> 标签：networking, tcp, tcp-ip, ns2

我正在尝试调整 TCP 以在实时通信中正常工作。为此，规范之一是强制 TCP 接受应用程序写入的新数据，即使缓冲区已满，这也会使 TCP 有时“不可靠”。这样，应用程序写入调用永远不会被阻塞，并且发送方应用程序的时间不会被破坏。我认为NS2中必须有一个选项才能使它成为可能。那么，如何强制 TCP 丢弃缓冲区中最旧的数据段并接受应用程序在 NS2 中写入的新数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:16:27.417

你不能。TCP 是一个“可靠的流”。任何允许删除数据的功能都与该目标背道而驰，因此没有此类支持。

如果您希望能够删除数据，那么如果您想要“最可靠的交付”而不是“尽力而为”，那么您将不得不切换到 UDP 之类的东西并实现自己的窗口/重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:10:51.627

如果您无论如何都要删除数据，请在将其发送到套接字之前将其删除。您可以使用 select 来查看套接字是否可用于写入，如果不可用，则在应用层删除数据。如果您拥有最新的最新数据至关重要，那么请参阅 Brian 的回答。

**编辑**

在旁注中，您可能想在谷歌上搜索实时网络协议，并查看已经存在的协议。

# wordpress - Wordpress Yelp Review Ticker 插件

> ID：12916401
> 
> 赞同：2
> 
> 时间：2012-10-16T14:00:53.830
> 
> 标签：wordpress

我制作了这个插件来显示来自我业务的 yelp 的评论，这是我的第一次尝试并且它有效，但我想与大家分享。当我在代码上添加我的设置时，它会按照预期的方式工作。但是当我制作管理界面以便人们可以使用他们自己的 API 密钥并将外观更改为最合适的时，它不会“保存”设置并且不会工作。我希望有人可以阐明并帮助我，以便我可以共享代码/插件。（顺便说一下，这是我第一次尝试编码）

yelprt.php

```
<?php
/*
Plugin Name:  Yelp Reviews Ticker
Plugin URI:   http://www.google.com/
Description:  Yelp Reviews Ticker
Version:      0.1
Author:       Flavio
Author URI:   http://www.google.com/    
*/
    function yelp_rt_widget($args, $widget_args = 1) {

        extract( $args, EXTR_SKIP );
        if ( is_numeric($widget_args) )
            $widget_args = array( 'number' => $widget_args );
        $widget_args = wp_parse_args( $widget_args, array( 'number' => -1 ) );
        extract( $widget_args, EXTR_SKIP );

        $options = get_option('yelprt_widget');
        if ( !isset($options[$number]) ) 
        return;

        $title = $options[$number]['title'];        // single value
        $speed = $options[$number]['speed'];
        $pause = $options[$number]['pause'];
        $showitems = $options[$number]['showitems'];
        $animation = $options[$number]['animation'];
        $mousepause = $options[$number]['mousepause'];
        //$height = $options[$number]['height'];
        $direction = $options[$number]['direction'];
        $yrtunsigned_url = $options[$number]['unsigned_url'];
        $yrtconsumer_key = $options[$number]['consumer_key'];
        $yrtconsumer_secret = $options[$number]['consumer_secret'];
        $yrttoken = $options[$number]['token'];
        $yrttoken_secret = $options[$number]['token_secret'];

        echo $before_widget; // start widget display code 
?><h2><?=$title?></h2><?php
//print $yrtunsigned_url;
//echo $options[$number]['unsigned_url'];

//******MY ADDITION     
// From http://non-diligent.com/articles/yelp-apiv2-php-example/
//

// Enter the path that the oauth library is in relation to the php file
//require_once ('lib/OAuth.php');
$unsigned_url = $options[$number]['unsigned_url'];
$consumer_key = $options[$number]['consumer_key'];
$consumer_secret = $options[$number]['consumer_secret'];
$token = $options[$number]['token'];
$token_secret = $options[$number]['token_secret'];

require_once ('lib/OAuth.php');
// Token object built using the OAuth library
$token = new OAuthToken($token, $token_secret);
//$token = new OAuthToken($yrttoken, $yrttoken_secret);

// Consumer object built using the OAuth library
$consumer = new OAuthConsumer($consumer_key, $consumer_secret);
//$consumer = new OAuthConsumer($yrtconsumer_key, $yrtconsumer_secret);

// Yelp uses HMAC SHA1 encoding
$signature_method = new OAuthSignatureMethod_HMAC_SHA1();

// Build OAuth Request using the OAuth PHP library. Uses the consumer and token object created above.
$oauthrequest = OAuthRequest::from_consumer_and_token($consumer, $token, 'GET', $unsigned_url);
//$oauthrequest = OAuthRequest::from_consumer_and_token($consumer, $token, 'GET', $yrtunsigned_url);

// Sign the request
$oauthrequest->sign_request($signature_method, $consumer, $token);
//$oauthrequest->sign_request($signature_method, $yrtconsumer, $yrttoken);

// Get the signed URL
$signed_url = $oauthrequest->to_url();

// Send Yelp API Call
$ch = curl_init($signed_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
$data = curl_exec($ch); // Yelp response
curl_close($ch);

// Handle Yelp response data
$response = json_decode($data);

$arr = (array) $response;

if(is_array($arr['reviews'])){
    echo    "<div id='yelprt'>";
    echo    "<ul id='list'>";
    foreach($arr['reviews'] as $review){
        echo "<li><div id='yelprt_table'>\n";
        echo "  <div class='row'>\n";
        echo "    <span class='yelprt_cell2'>\n";
        echo "      <img src='" . $review->user->image_url . "' width='60px'/>\n";
        echo "      <br />" . $review->user->name . "\n";
        echo "      <br /><img src='" . $review->rating_image_small_url . "'/>\n";
        echo "  </span>\n";
        echo "    <span class='yelprt_cell1'>\n";
        echo "      " . $review->excerpt . "\n";
        echo "      <br />\n";
        echo "          <span class='yelprt_smalltxt'>" . gmdate("m/d/Y", $review->time_created) . " more at <a href='".$yrtunsigned_url."'><img src='http://s3-media1.ak.yelpcdn.com/assets/2/www/img/14f29ad24935/map/miniMapLogo.png'/></a></span>\n";
        echo "  </span>\n";
        echo "  </div>\n";
        echo " </div></li>\n";
    }
    echo    "</div>";
}

    echo $after_widget; // end widget display code

}

    function yelp_rt_widget_control($widget_args) {

        global $wp_registered_widgets;
        static $updated = false;

        if ( is_numeric($widget_args) )
            $widget_args = array( 'number' => $widget_args );           
        $widget_args = wp_parse_args( $widget_args, array( 'number' => -1 ) );
        extract( $widget_args, EXTR_SKIP );

        $options = get_option('yelprt_widget');

        if ( !is_array($options) )  
            $options = array();

        if ( !$updated && !empty($_POST['sidebar']) ) {

            $sidebar = (string) $_POST['sidebar'];  
            $sidebars_widgets = wp_get_sidebars_widgets();

            if ( isset($sidebars_widgets[$sidebar]) )
                $this_sidebar =& $sidebars_widgets[$sidebar];
            else
                $this_sidebar = array();

            foreach ( (array) $this_sidebar as $_widget_id ) {
                if ( 'yelp_rt_widget' == $wp_registered_widgets[$_widget_id]['callback'] && isset($wp_registered_widgets[$_widget_id]['params'][0]['number']) ) {
                    $widget_number = $wp_registered_widgets[$_widget_id]['params'][0]['number'];
                    if ( !in_array( "yelp-rt-$widget_number", $_POST['widget-id'] ) ) // the widget has been removed.
                        unset($options[$widget_number]);
                }
            }

            foreach ( (array) $_POST['yelp-rt'] as $widget_number => $yelprt_widget ) {
                if ( !isset($yelprt_widget['title']) && isset($options[$widget_number]) ) // user clicked cancel
                    continue;

                $title = strip_tags(stripslashes($yelprt_widget['title']));
                $speed = $yelprt_widget['speed_value'];
                $pause = $yelprt_widget['pause_value'];
                $showitems = $yelprt_widget['showitems_value'];
                $animation = $yelprt_widget['animation_value'];
                $mousepause = $yelprt_widget['mousepause_value'];
                //$height = $yelprt_widget['height_value'];
                $direction = $yelprt_widget['direction_value'];
                $yrtunsigned_url = $yelprt_widget['unsigned_url_value'];
                $yrtconsumer_key = $yelprt_widget['consumer_key_value'];
                $yrtconsumer_secret = $yelprt_widget['consumer_secret_value'];
                $yrttoken = $yelprt_widget['token_value'];
                $yrttoken_secret = $yelprt_widget['token_secret_value'];
                // Pact the values into an array
                $options[$widget_number] = compact( 'title', 'speed', 'pause', 'showitems', 'animation', 'mousepause', 'direction', 'unsigned_url', 'consumer_key', 'consumer_secret', 'token', 'token_secret' );
            }

            update_option('yelprt_widget', $options);
            $updated = true;
        }

        if ( -1 == $number ) { // if it's the first time and there are no existing values

            $title = 'Reviews';
            $speed = '2500';
            $pause = '6000';
            $showitems = '2';
            $animation = 'fade';
            $mousepause = 'true';
            //$height = '';
            $direction = 'up';
            $yrtunsigned_url = '';
            $yrtconsumer_key = '';
            $yrtconsumer_secret = '';
            $yrttoken = '';
            $yrttoken_secret = '';
            $yrtnumber = '%i%';

        } else { // otherwise get the existing values

            $title = $options[$number]['title'];
            $speed = $options[$number]['speed'];
            $pause = $options[$number]['pause'];
            $showitems = $options[$number]['showitems'];
            $animation = $options[$number]['animation'];
            $mousepause = $options[$number]['mousepause'];
            //$height = $options[$number]['height'];
            $direction = $options[$number]['direction'];
            $yrtunsigned_url = $options[$number]['unsigned_url'];
            $yrtconsumer_key = $options[$number]['consumer_key'];
            $yrtconsumer_secret = $options[$number]['consumer_secret'];
            $yrttoken = $options[$number]['token'];
            $yrttoken_secret = $options[$number]['token_secret'];
        }

        print_r($options[$number]);

    ?>
    <p><label>Widget Title</label><br /><input id="title_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][title]" type="text" value="<?=$title?>" /></p>
    <p><label>Speed</label><br /><input id="speed_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][speed_value]" type="text" value="<?=$speed?>" /></p>
    <p><label>Pause</label><br /><input id="pause_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][pause_value]" type="text" value="<?=$pause?>" /></p>
    <p><label>Show Items</label><br /><input id="showitems_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][showitems_value]" type="text" value="<?=$showitems?>" /></p>

    <p>
        <label>Fade</label><br />
        Yes <input id="animation_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][animation_value]" type="radio" <?php if($animation == 'fade') echo 'checked="checked"'; ?> value="fade" />
        No <input id="animation_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][animation_value]" type="radio" <?php if($animation == '') echo 'checked="checked"'; ?> value="" />
    </p>
    <p>
        <label>Mousepause</label><br />
        Yes <input id="mousepause_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][mousepause_value]" type="radio" <?php if($mousepause == 'true') echo 'checked="checked"'; ?> value="true" />
        No <input id="mousepause_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][mousepause_value]" type="radio" <?php if($mousepause == 'false') echo 'checked="checked"'; ?> value="false" />
    </p>
    <p>
        <label>Direction</label><br />
        Up <input id="direction_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][direction_value]" type="radio" <?php if($direction == 'up') echo 'checked="checked"'; ?> value="up" />
        Down <input id="direction_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][direction_value]" type="radio" <?php if($direction == 'down') echo 'checked="checked"'; ?> value="down" />
    </p>
    <p><label>Business URL</label><br /><input id="unsigned_url_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][unsigned_url_value]" type="text" value="<?=$yrtunsigned_url?>" /></p>
    <p><label>Consumer Key</label><br /><input id="consumer_key_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][consumer_key_value]" type="text" value="<?=$yrtconsumer_key?>" /></p>
    <p><label>Consumer Secret</label><br /><input id="consumer_secret_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][consumer_secret_value]" type="text" value="<?=$yrtconsumer_secret?>" /></p>
    <p><label>Token</label><br /><input id="token_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][token_value]" type="text" value="<?=$yrttoken?>" /></p>
    <p><label>Token Secret</label><br /><input id="token_secret_value_<?php echo $number; ?>" name="yelp-rt[<?php echo $number; ?>][token_secret_value]" type="text" value="<?=$yrttoken_secret?>" /></p>

    <input type="hidden" name="yelp-rt[<?php echo $number; ?>][submit]" value="1" />

    <?php
    }

    function yelp_rt_widget_register() {
        if ( !$options = get_option('yelprt_widget') )
            $options = array();
        $widget_ops = array('classname' => 'yelprt_widget', 'description' => __('Yelp Reviews Ticker'));
        $control_ops = array('width' => 400, 'height' => 350, 'id_base' => 'yelp-rt');
        $name = __('Yelp Reviews Ticker Widget');

        $id = false;
        foreach ( (array) array_keys($options) as $o ) {

            if ( !isset( $options[$o]['title'] ) )
                continue;

            $id = "yelp-rt-$o";
            wp_register_sidebar_widget($id, $name, 'yelp_rt_widget', $widget_ops, array( 'number' => $o ));
            wp_register_widget_control($id, $name, 'yelp_rt_widget_control', $control_ops, array( 'number' => $o ));
        }

        if ( !$id ) {
            wp_register_sidebar_widget( 'yelp-rt-1', $name, 'yelp_rt_widget', $widget_ops, array( 'number' => -1 ) );
            wp_register_widget_control( 'yelp-rt-1', $name, 'yelp_rt_widget_control', $control_ops, array( 'number' => -1 ) );
        }
    }

add_action('init', yelp_rt_widget_register, 1);
//add_action('widgets_init', create_function('', 'return register_widget("yelprt_widget");') );
add_action('wp_head', 'yelprt_head');
    function yelprt_head($widget_args) {

        global $wp_registered_widgets;
        static $updated = false;

        if ( is_numeric($widget_args) )
            $widget_args = array( 'number' => $widget_args );           
        $widget_args = wp_parse_args( $widget_args, array( 'number' => -1 ) );
        extract( $widget_args, EXTR_SKIP );

        $options = get_option('yelprt_widget');
            $title = $options[$number]['title'];
            $speed = $options[$number]['speed'];
            $pause = $options[$number]['pause'];
            $showitems = $options[$number]['showitems'];
            $animation = $options[$number]['animation'];
            $mousepause = $options[$number]['mousepause'];
            //$height = $options[$number]['height'];
            $direction = $options[$number]['direction'];
            $yrtunsigned_url = $options[$number]['unsigned_url'];
            $yrtconsumer_key = $options[$number]['consumer_key'];
            $yrtconsumer_secret = $options[$number]['consumer_secret'];
            $yrttoken = $options[$number]['token'];
            $yrttoken_secret = $options[$number]['token_secret'];
            echo "<!-- Start Yelp Reviews Ticker -->\n";
            echo "<link type='text/css' href='" . plugins_url( 'css/yelprt.css' , __FILE__ ) . "' rel='stylesheet'/>\n";
            echo "<script type='text/javascript' src='" . plugins_url( 'lib/jquery.js' , __FILE__ ) . "'></script>\n";
            echo "<script type='text/javascript' src='" . plugins_url( 'lib/jquery.vticker-min.js' , __FILE__ ) . "'></script>\n";
            echo "<script type='text/javascript'>\n";
            echo "  $(function(){\n";
            echo "  $('#yelprt').vTicker({ \n";
            echo "      speed: ".$speed.",\n";
            echo "      pause: ".$pause.",\n";
            echo "      animation: '".$animation."',\n";
            echo "      mousePause: ".$mousepause.",\n";
            echo "      direction: '".$direction."',\n";
            echo "      showItems: ".$showitems."\n";
            echo "  });\n";
            echo "});\n";
            echo "</script>\n";
            echo "<!-- End Yelp Reviews Ticker -->\n";
    }
?> 
```

我知道我还有很多代码清理工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:14:32.933

`var_dump($options);`就在这条线下面`$options = get_option('yelprt_widget');`——告诉我是否`$unsigned_url`在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:09:07.937

事实上，在 wordpress 调用 $instance 之前，我使用的是一个非常古老的“插件模板”。所以人们过去常常制作自己的实例，这就是我正在做的事情。我已经清理了我的代码并让它工作了。我遇到的唯一问题是，一旦 jQuery 接管，我的 css 将无法在插件中工作。但这是一个不同的问题。这是我的修复

```
 <?php
/*
Plugin Name:  Yelp Reviews Ticker
Plugin URI:   http://wordpress.org/extend/plugins/
Description:  This reviews ticker allows you to show your yelp reviews and also customize its display to your taste in a easy manner
Version:      0.5
Author:       Flavio Domeneck Jr
Author URI:   http://www.flaviotreeservice.com/ 
License: GPL2

Copyright 2013  FDJ  (email : contactflavio@gmail.com )

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License, version 2, as 
    published by the Free Software Foundation.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/

class yrtWidget extends WP_Widget {
    function yrtWidget() {
        parent::__construct( 
            false, 
            'Yelp Reviews Ticker',
            array( 'description' => "Yelp Reviews Ticker shows your yelp reviews cleanly and pain free" ) 
        );

    }

    function widget( $args, $instance ) {
        extract($args);
        echo $before_widget;
        echo $before_title.$instance['title'].$after_title;

//
// Partially from
// http://non-diligent.com/articles/yelp-apiv2-php-example/
// https://github.com/Yelp/yelp-api/blob/master/v2/php/example.php
//

// Enter the path that the oauth library is in relation to the php file
require_once ('lib/OAuth.php');

// Set instance values
$speed = $instance['speed'];
$pause = $instance['pause'];
$showitems = $instance['showitems'];
$animation = $instance['animation'];
$mousepause = $instance['mousepause'];
$direction = $instance['direction'];
$yelp_url = $instance['yelp_url'];
$unsigned_url = $instance['unsigned_url'];
$consumer_key = $instance['consumer_key'];
$consumer_secret = $instance['consumer_secret'];
$token = $instance['token'];
$token_secret = $instance['token_secret'];

// Token object built using the OAuth library
$token = new OAuthToken($token, $token_secret);

// Consumer object built using the OAuth library
$consumer = new OAuthConsumer($consumer_key, $consumer_secret);

// Yelp uses HMAC SHA1 encoding
$signature_method = new OAuthSignatureMethod_HMAC_SHA1();

// Build OAuth Request using the OAuth PHP library. Uses the consumer and token object created above.
$oauthrequest = OAuthRequest::from_consumer_and_token($consumer, $token, 'GET', $unsigned_url);

// Sign the request
$oauthrequest->sign_request($signature_method, $consumer, $token);

// Get the signed URL
$signed_url = $oauthrequest->to_url();

// Send Yelp API Call
$ch = curl_init($signed_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
$data = curl_exec($ch); // Yelp response
curl_close($ch);

// Handle Yelp response data
$response = json_decode($data);

$arr = (array) $response;

if(is_array($arr['reviews'])){
    ?>

<!-- Start Yelp Reviews Ticker -->
<script type="text/javascript">
$(function(){
    $('#yelp-review-ticker').vTicker({ 
    <?
    echo "  speed: " . $instance['speed'] . ",\n";
    echo "  pause: " . $instance['pause'] . ",\n";
    echo "  animation: '" . $instance['animation'] . "',\n";
    echo "  mousePause: " . $instance['mousepause'] . ",\n";
    echo "  direction: '" . $instance['direction'] . "',\n";
    echo "  showItems: " . $instance['showitems'] . "\n";
    ?>
    });
});
</script>
<!-- End Yelp Reviews Ticker -->
<div id="yelp-review-ticker"><ul>
<? foreach($arr['reviews'] as $review){ ?>
        <li>
            <table>
                <tr>
                    <td style="text-align:center; padding:5px; font-size:90%">
<? echo "               <img src=\"" . $review->user->image_url . "\" width=\"60px\"/>\n";
echo "                  <br />" . $review->user->name . "\n";
echo "                  <br /><img src=\"" . $review->rating_image_small_url . "\" />\n";
?>
                    </td>
                    <td>
<? echo "               <p>" . $review->excerpt . "</p>\n"; 
echo "                  <div style=\"text-align:right; font-size:80%;\"><a href=\"" . $instance['yelp_url'] . "\" target=\"_blank\"> " . gmdate("m/d/Y", $review->time_created) . " more at \n"; 
echo "                      <img src=\"http://s3-media1.ak.yelpcdn.com/assets/2/www/img/14f29ad24935/map/miniMapLogo.png\"/></a>\n";
?>
                    </div>
                    </td>
                </tr>
            </table>
        </li>
<? } ?>
    </ul>
</div>
<? }

echo $after_widget;

} // End function widget.

    function yrtWidget_header(){
// jQuery vTicker from
// http://www.jugbit.com/jquery-vticker-vertical-news-ticker/
        echo '
        <script type="text/javascript" src="' . plugins_url( 'lib/jquery-1.8.3.min.js' , __FILE__ ) . '"></script>
        <script type="text/javascript" src="' . plugins_url( 'lib/jquery.vticker-min.js' , __FILE__ ) . '"></script>
        <style type="text/css"  media="all" src="' . plugins_url( 'css/yelprt.css' , __FILE__ ) . '"></style>
        ';

    }

// Updates the settings.

    function update( $new_instance, $old_instance ) {
        return $new_instance;
    }
    function form( $instance ) { //<- set default parameters of widget
        if($instance){
            $title = $instance['title'];
            $speed = $instance['speed'];
            $pause = $instance['pause'];
            $showitems = $instance['showitems'];
            $animation = $instance['animation'];
            $mousepause = $instance['mousepause'];
            $direction = $instance['direction'];
            $yelp_url = $instance['yelp_url'];
            $unsigned_url = $instance['unsigned_url'];
            $consumer_key = $instance['consumer_key'];
            $consumer_secret = $instance['consumer_secret'];
            $token = $instance['token'];
            $token_secret = $instance['token_secret'];
        }
        else{
            $title = 'Reviews';
            $speed = '2500';
            $pause = '6000';
            $showitems = '2';
            $animation = 'fade';
            $mousepause = 'true';
            $direction = 'up';
            $yelp_url = 'http://www.yelp.com/biz/';
            $unsigned_url = 'http://api.yelp.com/v2/business/';
            $consumer_key = '';
            $consumer_secret = '';
            $token = '';
            $token_secret = '';
        }
    ?>
        <p>
            <label for="<?php echo $this->get_field_id('title');?>">Widget Title</label><br />
            <input id="<?php echo $this->get_field_id('title');?>" name="<?php echo $this->get_field_name('title');?>" type="text" value="<?php echo $title; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('speed');?>">Speed</label><br />
            <input id="<?php echo $this->get_field_id('speed');?>" name="<?php echo $this->get_field_name('speed');?>" type="text" value="<?php echo $speed; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('pause');?>">Pause</label><br />
            <input id="<?php echo $this->get_field_id('pause');?>" name="<?php echo $this->get_field_name('pause');?>" type="text" value="<?php echo $pause; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('showitems');?>"># of reviews</label><br />
            <input id="<?php echo $this->get_field_id('showitems');?>" name="<?php echo $this->get_field_name('showitems');?>" type="text" value="<?php echo $showitems; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('animation');?>">Fade</label><br />
            Yes <input id="<?php echo $this->get_field_id('animation');?>" name="<?php echo $this->get_field_name('animation');?>" type="radio" <?php if($animation == 'fade') echo 'checked="checked"'; ?> value="fade"/>
            No <input id="<?php echo $this->get_field_id('animation');?>" name="<?php echo $this->get_field_name('animation');?>" type="radio" <?php if($animation == '') echo 'checked="checked"'; ?> value=""/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('mousepause');?>">Mouse Pause</label><br />
            Yes <input id="<?php echo $this->get_field_id('mousepause');?>" name="<?php echo $this->get_field_name('mousepause');?>" type="radio" <?php if($mousepause == 'true') echo 'checked="checked"'; ?> value="true"/>
            No <input id="<?php echo $this->get_field_id('mousepause');?>" name="<?php echo $this->get_field_name('mousepause');?>" type="radio" <?php if($mousepause == 'false') echo 'checked="checked"'; ?> value="false"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('direction');?>">Direction</label><br />
            Up <input id="<?php echo $this->get_field_id('direction');?>" name="<?php echo $this->get_field_name('direction');?>" type="radio" <?php if($direction == 'up') echo 'checked="checked"'; ?> value="up"/>
            Down <input id="<?php echo $this->get_field_id('direction');?>" name="<?php echo $this->get_field_name('direction');?>" type="radio" <?php if($direction == 'down') echo 'checked="checked"'; ?> value="down"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('yelp_url');?>">Yelp Business URL</label><br />
            http://www.yelp.com/biz/...<br />
            <input id="<?php echo $this->get_field_id('yelp_url');?>" name="<?php echo $this->get_field_name('yelp_url');?>" type="text" value="<?php echo $yelp_url; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('unsigned_url');?>">API Business URL</label><br />
            http://api.yelp.com/v2/business/...<br />
            <input id="<?php echo $this->get_field_id('unsigned_url');?>" name="<?php echo $this->get_field_name('unsigned_url');?>" type="text" value="<?php echo $unsigned_url; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('consumer_key');?>">Consumer Key</label><br />
            <input id="<?php echo $this->get_field_id('consumer_key');?>" name="<?php echo $this->get_field_name('consumer_key');?>" type="text" value="<?php echo $consumer_key; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('consumer_secret');?>">Consumer Secret</label><br />
            <input id="<?php echo $this->get_field_id('consumer_secret');?>" name="<?php echo $this->get_field_name('consumer_secret');?>" type="text" value="<?php echo $consumer_secret; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('token');?>">Token</label><br />
            <input id="<?php echo $this->get_field_id('token');?>" name="<?php echo $this->get_field_name('token');?>" type="text" value="<?php echo $token; ?>"/>
        </p>
        <p>
            <label for="<?php echo $this->get_field_id('token_secret');?>">Token Secret</label><br />
            <input id="<?php echo $this->get_field_id('token_secret');?>" name="<?php echo $this->get_field_name('token_secret');?>" type="text" value="<?php echo $token_secret; ?>"/>
        </p>

    <?php
    } // end function form

} // end class

// Register the widget.
function yrtw_register() {
    register_widget( 'yrtWidget' );
}

add_action('wp_head', 'add_yrt_header');
    function add_yrt_header(){

        echo '
        <script type="text/javascript" src="' . plugins_url( 'lib/jquery-1.8.3.min.js' , __FILE__ ) . '"></script>
        <script type="text/javascript" src="' . plugins_url( 'lib/jquery.vticker-min.js' , __FILE__ ) . '"></script>
        <style type="text/css"  media="all" src="' . plugins_url( 'css/yelprt.css' , __FILE__ ) . '"></style>
        ';

    }

add_action( 'widgets_init', 'yrtw_register' );

?> 
```

我希望它可以帮助别人

# c# - 用于过滤的 LinQ 语句

> ID：12916407
> 
> 赞同：2
> 
> 时间：2012-10-16T14:01:13.317
> 
> 标签：c#

我试图过滤掉一个`ObservableCollection<MainBusinessObject>`我需要过滤集合中所有项目的地方`Subobject.PropertyX == true`。

```
 MainBusinessObject 
     - PropertyA int
     - PropertyB string
     - ListOfSubobject ObservableCollection<Subobject>

  Subobject
     - PropertyX bool
     - PropertyY int
     - PropertyZ - string 
```

我真的想远离循环和 if 语句，但我似乎无法正确使用 LinQ 语句。这是我到目前为止所拥有的：

```
return (MainBusinessObjectCollection) 
          listOfMainBusinessObject.Where(x =>
           (x as MainBusinessObject).CanBePartitioned == true); 
```

**编辑** 我需要`ListOfSubobject`从主要业务对象中过滤掉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:05:39.570

取决于您是否希望任何子对象具有该属性或所有子对象都具有该属性：

```
var filteredList = listOfMainBusinessObject
                       .Where(x => x.ListOfSubobject.Any(s=>s.PropertyX)); 
```

或者

```
var filteredList = listOfMainBusinessObject
                      .Where(x => x.ListOfSubobject.All(s=>s.PropertyX)); 
```

此外，您还有一些似乎无效或不必要的演员表。要转换为 a `MainBusinessObjectCollection`（假设它是`MainBusinessObject`s 的集合），您可能必须从返回的 中初始化`IEnumerable`它`Where`：

```
var newList = new MainBusinessObjectCollection(filteredList); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:09:16.747

如果你想要`Subobjects`所有`Subobject.PropertyX == true`：

```
listOfMainBusinessObject.SelectMany(x => x.ListOfSubobject)
                        .Where(x => x.PropertyX == true); 
```

# java - java线程问题，正确的方法？

> ID：12916413
> 
> 赞同：0
> 
> 时间：2012-10-16T14:01:38.063
> 
> 标签：java, multithreading, datediff

我正在创建一个将在后台连续运行的 java 服务，该服务的工作是在特定日期创建表的副本。确切地说，我从某个表中读取数据，如果表中的 record_date 与当前日期匹配，我需要创建表副本。然后服务应该休眠到下一个运行日期。下一个运行日期也是通过查看表中的记录来确定的。

目前，我如何做到这一点，是创建一个在 while(true) 循环中运行的线程。当线程完成执行任务，即创建表副本时，我使用 Thread.sleep() 让它进入睡眠状态，直到它下次需要运行。线程休眠的毫秒数，我通过计算当前日期（线程执行任务的日期）和下一次运行日期之间的差异来计算。

这是正确的方法吗，在这个特定场景中使用 thread.sleep() 是正确的吗？我这样说是因为线程的下一次运行日期可能在三个月甚至一年之后。如果我在这里不是很清楚，也请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:06:47.467

**剖析这两个操作怎么样？**

1.  编写一个 Java 作业，当调用时检查表中的日期并创建一个副本。
2.  安排 java 作业以您希望的方式运行。

由于我们 UNIX`cron`对我们执行此类任务有很大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:19:48.993

看看[`Lock`界面](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html)。这是`wait()`and的抽象`notify()`，你应该使用它来代替`sleep()`.

这里有一个[答案](https://stackoverflow.com/a/8025887/334274)说明了原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T03:37:26.680

查看 Java Timer API 或 Quartz 库

# android - 在果冻豆上启动相机

> ID：12916415
> 
> 赞同：0
> 
> 时间：2012-10-16T14:01:40.997
> 
> 标签：android, android-intent, android-activity, camera, gallery

我正在开发一个必须启动相机的应用程序。在 Jelly Bean 中，画廊和相机合并，现在是同一个应用程序（`com.android.gallery3d`我认为）。我一直在寻找有关如何启动相机的答案，但它们都是关于`startActivityForResult()`方法的。我不希望用户返回我的应用，也不希望我的应用获取照片。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:14:16.920

这个 Intent 在 JellyBean 上对我很有效：

```
Intent intent = new Intent(android.provider.MediaStore.INTENT_ACTION_STILL_IMAGE_CAMERA);
startActivity(intent); 
```

# udp - rtmfp / UDP 究竟是如何工作的

> ID：12916416
> 
> 赞同：3
> 
> 时间：2012-10-16T14:01:47.050
> 
> 标签：udp, protocols, p2p, flash-media-server, rtmfp

我正在尝试使用 flash 和 rtmfp 协议开发实时视频聊天应用程序，但我对 rtmfp 如何保证连接对等点存有疑问，尤其是当对等点位于不同的网络中时。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T05:42:47.040

RTMFP 依靠中央集合服务器来“引入”2 个位于不同网络中并且可能位于防火墙后面的客户端。为了通过防火墙导航，它使用[NAT 穿越技术](http://en.wikipedia.org/wiki/NAT_traversal)，基本上相当于：

*   2 个客户端（Joe 和 Mary）连接到中央集合服务器
    *   Adobe 的公共 RTMFP（非商业）集合服务器 rtmfp://p2p.rtmfp.net/
    *   或者您可以使用 GPL 开源[Cumulus](https://github.com/OpenRTMFP/Cumulus)或[ArcusNode托管您自己的](https://github.com/OpenRTMFP/ArcusNode)
*   Joe 与 Mary 共享他的 peer ID，或者他们可以使用共享的[NetGroup](http://www.flashrealtime.com/simple-chat-p2p-netgroup-rtmfp/) ID
*   Mary 与中央会合服务器通信，然后使用各种 NAT 和防火墙穿越技术建立对等 2 对等 UDP 连接

无法保证任何 2 个客户端网络/防火墙与 RTMFP P2P 连接兼容（您可以使用[RTMFP 连接测试仪](http://blog.yoz.sk/2010/07/rtmfp-connection-tester/)进行诊断），这就是 Adob​​e 通过其[LiveCycle Collaboration Service](http://www.adobe.com/devnet/flashplatform/services/collaboration.html)或[Adob​​e Flash Media Server](http://www.adobe.com/products/adobe-media-server-extended/rtmfp-faq.html)提供备用解决方案到中央中继服务的原因（如果无法建立直接 P2P 连接，基本上所有网络流量都将通过两个客户端都可以公开访问的服务器。

Adobe 的 RTMFP 是其对 Peer 2 Peer 网络会合服务的专有捆绑，并提供了一些其他更高级别的 P2P 网络网格功能。

如果您对更开放的标准 P2P 协议感兴趣，您应该研究[WebRTC](http://www.webrtc.org/)。本质上，WebRTC 与允许客户端通过 UDP 连接 P2P 的概念相同，但旨在被用作 Web 浏览器标准，并且还可以在其使用标准 NAT 的引擎盖下在各种本机设备（例如 Android、iPhone 等）上实现和使用[STUN](http://en.wikipedia.org/wiki/STUN)、[ICE](http://en.wikipedia.org/wiki/Interactive_Connectivity_Establishment)、[TURN](http://en.wikipedia.org/wiki/Traversal_Using_Relays_around_NAT)、[RTP-over-TCP 的](http://en.wikipedia.org/wiki/Real-time_Transport_Protocol)防火墙穿越技术和对代理的支持。我相信 WebRTC 是在[libjingle](http://code.google.com/p/libjingle/) P2P Google Talk 库中完成的一些工作的标准化。

# doctrine-orm - Doctrine 自定义存储库与实体方法最佳实践

> ID：12916418
> 
> 赞同：1
> 
> 时间：2012-10-16T14:01:50.387
> 
> 标签：doctrine-orm, theory

您可以使用实体方法遍历实体，并且可以使用实体存储库执行完全相同的操作，不同之处在于您将创建额外的类并将其附加到实体上，并且存储库也会对其他开发人员造成某种混淆，以了解是否有某种方法可用，他们将需要检查实体和存储库。

还有其他区别吗？使用自定义存储库有什么好处吗？或者处理这种情况的最佳做法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T08:09:17.807

一般来说：

*   实体中的方法应该只连接到这个特定的实体对象（例外是具有关系的 getter / setter）。

*   存储库中的方法应连接到整个实体类

例如：如果你有一个 Article 实体，你可以在实体内部创建“slugify”方法，因为你想从这个特定对象的标题中生成 slug。

但是，如果您需要，比如说，获取所有超过一年的文章 - 您将在存储库中创建这样的方法（因为它与任何特定对象无关）

# objective-c - 为什么接口中允许使用“__block”关键字？

> ID：12916419
> 
> 赞同：6
> 
> 时间：2012-10-16T14:01:53.087
> 
> 标签：objective-c

如果我尝试使用 __block 存储类型访问“对象变量”：

```
@interface {
__block float x;
} 
```

在一个块中：

```
@implementation ... {
...
-(void) func: {
   ^(...) {
      x = 0;
   }
} 
```

我收到“保留周期”警告，除非我创建一个对 self 的 __block 引用并像这样使用它：

```
-(void) func: {
   __block id s = self;
   ^(...) {
      s->x = 0;
   }
} 
```

为什么可以在接口中声明变量“__block”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T09:07:27.063

__block 变量存在于变量的词法范围和在变量的词法范围内声明或创建的所有块和块副本之间共享的存储中。 [看](https://stackoverflow.com/questions/7080927/what-does-the-block-keyword-mean?rq=1)

# iphone - UIQueuingScrollView didScrollWithAnimation:force 中的断言失败：

> ID：12916422
> 
> 赞同：33
> 
> 时间：2012-10-16T14:02:03.893
> 
> 标签：iphone, ios, uipageviewcontroller

我已经`UIPageViewController`设置了寻呼我的`ImageViewController`.

`ImageViewController`包含`UIScrollView`一个内部`UIImageView`。没有其他的。

我目前正在我的数据源中使用 3 个“项目”进行测试`UIPageViewController`（即三页）。

一切正常，我可以滚动和缩放，然后翻页大约 30 秒，然后突然我收到这个警告......

```
*** Assertion failure in -[_UIQueuingScrollView _didScrollWithAnimation:force:], /SourceCache/UIKit/UIKit-2372/_UIQueuingScrollView.m:778 
```

我不知道从哪里开始调试它，因为它没有指向我的任何代码，并且堆栈中没有我的任何代码或任何东西。

有人可以给我一个关于从哪里开始调试的指针。

**编辑**

我做了更多的测试。如果滚动视图正在减速（即在轻弹之后），那么似乎会发生这种情况，然后我尝试将 PageViewController 转换到另一个 ViewController，因为滚动视图仍在移动。

在过渡到下一页的过程中，应用程序崩溃了大约 20%。

**编辑 2**

该错误似乎停止在 _cache_getImp 行（不确定这是大写 i 还是小写 L）。

**编辑 3**

这变得更好。我刚刚下载了 Apple 的 PhotoScroller 示例应用程序，看看他们是否以不同的方式解决了这个问题。嗯，不，他们没有。示例应用程序崩溃的方式与我的完全相同！您必须同时缩放、滚动和转换页面，以使其更有可能崩溃，但它也会自行发生，可能需要更长的时间才能发生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-14T10:56:06.007

Came up with a solution! In my case I have a `UIPageViewController` with `UIPageViewControllerTransitionStyleScroll` as well as next buttons that allow the user to advance through my viewpager by tapping. I am getting this crash when the user presses a next button and drags around slightly before releasing their finger (still within the frame of the button). It appears that the dragging within the button is interfering with `UIPageViewController`'s pan gesture recognizer in this case, and that's what causes the crash.

While it's pretty unlikely that the user will get in this state, I've come up with a relatively simple solution the prevents my app from crashing if it does happen. I have a boolean that represents if the user is in a valid state to move to the next screen and set it to YES on touch down, then to NO if the user drags anywhere inside my button. Then, on touchUp (nextPressed) I check the boolean before moving my `UIPageViewController` programatically.

```
- (IBAction)touchDown:(id)sender
{
  self.shouldAdvanceToNextScreen = YES;
}

- (IBAction)touchDragInside:(id)sender
{
  self.shouldAdvanceToNextScreen = NO;
}

- (IBAction)nextPressed:(id)sender
{
  if (self.shouldAdvanceToNextScreen) {
    UIViewController *initialViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"TutorialScreen2"];
    NSArray *viewControllers = [NSArray arrayWithObject:initialViewController];
    [self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:nil];
  }
} 
```

The downside is that nothing will happen even though the user still released their finger within the button frame. However, I prefer this over a crash and see this as a pretty rare edge case regardless. I'd expect the user would just tap again - this time without a tap & drag - and move forward successfully.

I'd welcome any ideas on taking this a step further and preventing the clash between the touch drag and the `UIPageViewController` altogether.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T14:42:19.320

我整天都在和这个作斗争。我的结论：

如果你有一个滚动视图作为显示 ViewController 并且你是滚动的代表：你有麻烦了。即使 PageViewController 配置了水平滚动，视图上的垂直滚动也会触发一个事件。-> 如果出现以下情况，这不会造成麻烦：您之前滚动回视图顶部（不确定如何解决此问题）。

有像[这样](https://stackoverflow.com/questions/14220289/)的好 StackOverflow 线程。

基本上解决方案是：

1`[yourView setViewControllers:yourControllers direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:nil];`

2 使用 UIPageViewControllerTransitionStylePageCurl 作为过渡样式。

这解决了我的大部分问题。

如果有人对滚动的委托问题有解决方案，将是最受欢迎的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T14:15:18.237

您是否尝试过在 UIScrollView 中禁用弹跳？这对我有用，并解决了我在上面的评论中提到的其他问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-13T16:52:17.437

我有一个类似的问题。我的设置是 a `UIPageViewController`，我正在加载带有`UIImageView`内部的视图控制器。在滚动时进行交互时，`UIPageViewController`我得到了相同的崩溃日志。

我通过创建`UILongPressGestureRecognizer`并添加到`UIPageViewController`的滚动视图来修复它。

1.  创建了我自己的子类`UIPageViewController`（解决方案特定于我的情况，但可以很容易地用作通用解决方案）

2.  找到内部 UIScrollView 的`UIPageViewController`

    ```
    - (UIScrollView *)findScrollView
    {
        UIScrollView *scrollView;
        for (id subview in self.view.subviews)
        {
            if ([subview isKindOfClass:UIScrollView.class])
            {
                scrollView = subview;
                break;
            }
        }

        return scrollView;
    } 
    ```

3.  将长按手势识别器添加到内部滚动视图并将其操作指向方法或 nil

    ```
    /**
     *  On tap-hold the page view controller crashes as soon as it pages to a new view controller.
     *  Setting a long press gesture to ignore the hold.
     */
    - (void)listenForLongPressGestureOnScrollView:(UIScrollView *)scrollView
    {
        UILongPressGestureRecognizer *longPressGestureRecognizer = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:nil];
        [longPressGestureRecognizer setMinimumPressDuration:0.5];
        [scrollView addGestureRecognizer:longPressGestureRecognizer];
    } 
    ```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-09-13T14:33:50.093

它肯定看起来像 iOS 8 和 9 中的一个错误。（下面的“答案”试图解决这个问题）

随时在 bugreport.apple.com 上提交票证 请务必指定如何使 PhotoScroller 崩溃

包括您看到它崩溃的所有 iOS 版本

到目前为止，我已经看到：

> -[XXX.TrackingPageViewController queuingScrollView:didEndManualScroll:toRevealView:direction:animated:didFinish:didComplete:] 中的断言失败，/BuildRoot/Library/Caches/com.apple.xbs/Sources/UIKit/UIKit-3512.60.12/UIPageViewController.m :2028
> 
> -[_UIQueuingScrollView _didScrollWithAnimation:force:] 中的断言失败，/BuildRoot/Library/Caches/com.apple.xbs/Sources/UIKit/UIKit-3512.60.12/_UIQueuingScrollView.m:785 (lldb)

我会保持更新列表（尽管投票反对，但数量很大）。敬请关注。

它看起来不像我们的错误。

UPD 2016 09 27（现在在 Xcode 8 上）：

> -[XXX.TrackingPageViewController queuingScrollView:didEndManualScroll:toRevealView:direction:animated:didFinish:didComplete:] 中的断言失败，/SourceCache/UIKit/UIKit-3347.44.2.2/UIPageViewController.m:1875

惊人的

# javascript - Javascript Map 取消引用

> ID：12916426
> 
> 赞同：1
> 
> 时间：2012-10-16T14:02:18.607
> 
> 标签：javascript, html, dom, memory, reference

如果我有一个包含`id`DOM 元素的映射，并且我想取消引用映射中的一个条目，那么垃圾收集器可以拾取相应的元素，我应该通过哪些步骤来确保没有内存泄漏？我应该`delete`还是`= null`在地图条目上？我需要对元素本身做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:04:26.673

*（我假设“地图”是指“对象”。）*

要从对象中永久删除属性和值，请使用`delete`. 使用`null`将具有清除值，但保留属性的效果。

两者都将允许对值进行垃圾收集。

但是对于你想要完成的事情，如果地图只引用了一个 ID 字符串，它不会对元素本身产生影响。您需要删除对元素的所有引用*（在 DOM 和 JavaScript 中）*以确保元素被垃圾回收。

# performance - 使用缓存还是使用CDN更好？

> ID：12916430
> 
> 赞同：25
> 
> 时间：2012-10-16T14:02:32.753
> 
> 标签：performance, cdn, browser-cache

我正在研究加载静态文件时的浏览器性能，这个疑问出现了。

> 有人说使用 CDN 静态文件（即 Google Code、jQuery latest、AJAX CDN...）性能更好，因为它从另一个域请求而不是整个网页。
> 
> 其他提高性能的方法是将`Expires`标头设置为几个月后，强制浏览器缓存静态文件并减少请求。
> 
> 我想知道哪种方式最好，考虑性能以及是否可以将两者结合起来。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-10-16T15:20:56.540

如果您正在对网站进行 Web 性能优化 (WPO)，也称为前端优化 (FEO)，最终最好同时使用这两种技术。他们可以惊人地携手合作。虽然如果我**必须**选择一个而不是另一个，我肯定会在任何一天选择**缓存。**事实上，我想说的是，即使您要使用 CDN，也必须为所有 Web 项目设置适当的资源缓存。

## 缓存

设置`Expires`标头和资源缓存是必须的，并且应该在 100% 的时间内为您的资源完成。真的没有理由不做缓存。在 Apache 上，启用`mod_expires.c`和`mod_headers.c`. [HTML5 Boilerplate 项目在](https://github.com/h5bp/html5-boilerplate)[.htaccess 文件](https://github.com/h5bp/html5-boilerplate/blob/master/dist/.htaccess)中有很好的实现示例，如果您的服务器是 nginx、lighttpd 或 IIS 等其他服务器，请查看这些[其他服务器配置](https://github.com/h5bp/server-configs)。

如果有人有兴趣学习缓存，这里是一本很好的读物：[Mark Nottingham's Caching Tutorial](http://www.mnot.net/cache_docs/)

## 内容交付网络

您提到`Google Code, jQuery latest, AJAX CDN`了，我只想简单地谈谈 CDN，包括那些您付费并托管自己的资源的 CDN，但如果您只是使用 jquery 托管文件 cdn 或从[http://cdnjs.com/](http://cdnjs.com/)加载某些内容，这同样适用例子。

我想说 CDN 不如设置服务器端标头缓存重要，但 CDN**可以**提供显着的性能提升，但您的内容交付网络性能会因[提供商](http://www.cdnplanet.com/cdns/)而异。

如果您的流量是全球受众并且 CDN 提供商拥有许多全球边缘/对等位置，则尤其如此。它还将显着降低您的虚拟主机带宽和 CPU 使用率（一点），因为您将一些工作卸载到 CDN 以提供资源。

在极少数情况下，如果 CDN 的延迟最终比您的服务器慢，CDN 可能会对性能产生负面影响。此外，如果您过度优化并使用过多的资源[并行](https://developers.google.com/speed/docs/best-practices/rtt#ParallelizeDownloads)化（使用多个子域，如 cdn1、cdn2、cdn3 等），最终可能会降低用户体验并导致额外的 DNS 查找开销。这里需要一个良好的平衡。

另一个可能发生的负面影响是 CDN 是否关闭。它已经发生了，而且还会再次发生。免费 CDN 更是如此。如果 CDN 由于某种原因出现故障，您的网站也会出现故障。这是另一个潜在**[的单点故障 (SPOF)](http://www.stevesouders.com/blog/2010/06/01/frontend-spof/)**。对于 javascript 资源，您可以变得聪明并从 CDN 加载资源，如果它失败，无论如何，然后检测并加载本地副本。下面是一个从 ajax.googleapis.com 加载 jQuery 的示例，带有后备（取自 HTML5 Boilerplate）：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.2.min.js"><\/script>')</script> 
```

除了明显的免费 API 资源（jquery、google api 等）之外，如果您使用 CDN，您可能需要支付使用费，因此它会增加托管成本。当然，对于某些 CDN，您甚至必须支付额外费用才能访问某些位置，例如亚洲节点可能比北美节点要额外付费。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-16T15:15:12.757

对于公共应用程序，请使用 CDN。缓存有助于重复请求，但不适用于第一个请求。为了确保在第一页访问时快速加载使用 CDN，该文件很有可能已经被另一个站点缓存。正如其他人已经提到的那样，CDN 结果当然也被大量缓存。

但是，如果您有一个 Intranet 网站，您可能希望自己托管文件，因为它们通常从内部源加载比从 CDN 加载更快。然后，您还可以选择将多个文件合并为一个以减少请求数量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-16T14:10:04.157

CDN 具有提供多个服务器并自动将您的流量路由到离您的客户端最近的位置的好处。这可以加快交付速度，并根据位置进行优化。

此外，静态内容不需要特殊的应用程序服务器（如动态内容），因此能够将其卸载到 CDN 意味着您可以完全减少流量。流式视频剪辑可能太大而无法缓存或不应该被缓存。但是您不一定要支持该带宽。CDN 将为您承担该流量。

它并不总是与缓存有关。小型应用程序 Web 服务器可能只想提供动态内容，但需要针对很少更改的重磅媒体的解决方案。CDN 为您处理扩展问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T14:54:52.033

同意@Anthony_Hatzopoulos (+1)

CDN 补充了缓存；在某些情况下，它还有助于优化缓存指令。

例如，我工作的一家公司已将行为学习算法集成到其 CDN 中，以识别和动态缓存生成的对象。

通常，这些对象是不可缓存的（即 [Cache-Control: max-age=0] Http 标头）。但在这种情况下，系统能够识别缓存的可能性并覆盖原始 HTTP 标头方向。（例如：一个动态生成的流行产品应该被缓存，或者流行的搜索结果页面，虽然是动态生成的，但随着时间的推移仍然以相同的形式呈现给成千上万的用户）。

是的，在您问之前，系统还可以识别个性化数据并且非常新鲜，以防止误报... :)

由于反向代理 CDN 技术，才有可能实现这样的算法。这是 CDN 和缓存如何相互补充，以创建更好、更智能的加速解决方案的示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-18T13:42:19.130

在这些专家的引用之上，解释是完美的理解 CDN 技术和缓存我只是提供我的个人经验，我曾在 joomla 德行网站上工作，不幸的是它不允许更新新的 joomla 和德行版本，因为它太多定制产品页面中的字段，因此一旦访问者达到 900/DAY 和批次用户无法将他们的项目放入他们的购物篮，因为每次调用批次 js 和 ajax 调用订单项目需要太多时间

优化网站后，我们决定使用CDN，然后性能真的变好了，根据gtmetrix的记录，第一个YSlow Score是50%，然后优化+CDN后达到74%

[https://gtmetrix.com/reports/www.florihana.com/jWlY35im](https://gtmetrix.com/reports/www.florihana.com/jWlY35im)

从 CDN 的仪表板中，您可以看到哪个数据中心的成本最高和收费最高的数据，以改善您的营销：

[![在此处输入图像描述](../Images/7cc296522dad940da3a349c230770599.png)](https://i.stack.imgur.com/oHyVj.png)

但是是的，要配置 CDN，它必须注意清除时间并平衡资源 CDN 的数量，如果它关闭了一些问题，您需要找出哪个资源 CDN 原因

希望这会有所帮助

# google-apps-script - 如何在电子表格中编辑的评论中记录最后修改时间？

> ID：12916431
> 
> 赞同：0
> 
> 时间：2012-10-16T14:02:32.410
> 
> 标签：google-apps-script, google-sheets

在已编辑单元格的评论中记录上次修改时间很容易（请参阅 onEdit() [https://developers.google.com/apps-script/understanding_triggers](https://developers.google.com/apps-script/understanding_triggers)）

但是如何记录评论的最后修改时间呢？（如果我编辑评论（不是单元格）- onEdit() 不起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:01:55.817

不幸的是，Google Apps 脚本不为评论/注释提供 onEdit 事件，仅针对单元格值。

# php - Symfony2 重定向事件监听器？

> ID：12916439
> 
> 赞同：34
> 
> 时间：2012-10-16T14:02:45.873
> 
> 标签：php, symfony

如果用户未登录，我有一个内核事件侦听器设置（kernel.controller）来重定向用户。事件侦听器已成功调用，但是我无法弄清楚如何重定向。这是我得到的：

```
$cont = $event->getController('testpost');
$event->setResponse($cont); 
```

这给了我错误：

```
Fatal error: Call to undefined method Symfony\Component\HttpKernel\Event\FilterControllerEvent::setResponse() 
```

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-04-23T11:16:22.267

如果你想从你那里重定向，`FilterControllerEvent`你应该使用这个：

```
public function onKernelController(FilterControllerEvent $event)
{
    // do something
    $event->setController(function() use ($redirectUrl) {
        return new RedirectResponse($redirectUrl);
    });
} 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-10-16T14:39:03.017

您不能设置对`FilterControllerEvent`对象的响应。您需要侦听该`kernel.request`事件，因为它的`GetResponseEvent`对象具有以下`setResponse()`方法：

```
$route = 'route_name';

if ($route === $event->getRequest()->get('_route')) {
    return;
}

$url = $this->router->generate($route);
$response = new RedirectResponse($url);
$event->setResponse($response); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-14T01:13:06.683

在 'kernel.controller' 事件上重定向的更多或更不清晰的方法

```
public function onKernelController(FilterControllerEvent $event)
{
    /* @var $controller \Symfony\Bundle\FrameworkBundle\Controller\Controller */
    $controller = $event->getController()[0]; // PHP 5.4 or $controller = $controller[0];

    throw new HttpException(307, null, null, array('Location' => $controller->generateUrl('homepage')));
} 
```

* * *

## 回答 #4

> 赞同：-8
> 
> 时间：2013-05-21T06:17:13.520

这不是没有办法，我的朋友。你应该使用默认的 Symfony 安全来为你覆盖它......

# forms - Symfony2 形式：调用另一个实体的方法

> ID：12916441
> 
> 赞同：0
> 
> 时间：2012-10-16T14:02:56.097
> 
> 标签：forms, symfony, symfony-forms

我有两个实体：用户和个人。用户是一个人，在用户实体中我有一个方法 getPerson()。

现在我正在尝试创建一个表单以更改用户配置文件。在那里，我想创建：

```
$builder->add('degree', 'entity', array(
        'class' => 'SciForumVersion2Bundle:Degree',
        'property' => 'degree',
));
$builder->add('person.firstname', 'text', array('required'=>true));
$builder->add('person.lastname', 'text', array('required'=>true));
$builder->add('person.address1', 'text', array('label'=>'Address', 'required'=>true));

ETC.... 
```

在树枝文件中，我必须使用

```
<tr>
    <td>
        {{ form_label(form.degree) }}
    </td>
    <td>
        {{ form_widget(form.degree) }}
    </td>
</tr>
<tr>
    <td>
    {{ form_label(form.firstname) }}
    </td>
    <td>
        {{ form_widget(form.firstname, { 'attr': {'size': 30} }) }}
    </td>
</tr>
<tr>
    <td>
        {{ form_label(form.lastname) }}
    </td>
    <td>
        {{ form_widget(form.lastname, { 'attr': {'size': 30} }) }}
    </td>

ETC.... 
```

但对于

```
form.firstname
form.firstname 
```

我得到了例外：

```
Method "firstname" for object "Symfony\Component\Form\FormView" does not exist in SciForumVersion2Bundle:User:changeProfile.html.twig at line 54 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:20:54.307

如果你想在 User 表单中显示 Person 表单，你应该查看symfony 文档中的[Embedded Forms](http://symfony.com/doc/2.0/book/forms.html#embedded-forms)章节。

如果您只想显示一个人表单，您的代码应该通过删除“人”来工作。部分来自字段名称，如下所示：

```
$builder->add('firstname', 'text', array('required'=>true));
$builder->add('lastname', 'text', array('required'=>true));
$builder->add('address1', 'text', array('label'=>'Address', 'required'=>true)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T10:10:22.777

我设法解决了这个问题。我所做的是创建了一个名为 PersonUserEntity 的额外实体。在那里，我有我需要的所有变量：

```
degree
firstname
lastname
address1
...ETC... 
```

然后我将这个实体用于表单。

提交表单后，我将从该实体获取信息并分别填充 Person 和 User 实体。

之后，我正在使用：

```
$em->persist($person);
$em->flush();

$em->persist($user);
$em->flush(); 
```

# c# - C#从&到同一个文件读取和写入

> ID：12916443
> 
> 赞同：1
> 
> 时间：2012-10-16T14:03:07.060
> 
> 标签：c#

> **可能重复：**
> [如何在 C# 中同时读取/写入文件](https://stackoverflow.com/questions/605685/how-to-both-read-write-file-in-c-sharp)

我想在同一个文本文件中写入和读取文本。这是代码

```
TextWriter notesWriter = new StreamWriter("text.txt");
TextReader notesReader; = new StreamReader("text.txt"); 
```

一旦文件打开以进行写入，它就会被锁定并阻止读取它。因此，抛出了一些异常，例如，

> *该进程无法访问文件“text.txt”，因为它正被另一个进程使用。*

解决方法是什么？谢谢你。

编辑：假设，如果要更改文本框中的文本并将其保存在文件中并在需要设置文本框中的文本时从中读取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:12:35.127

考虑到您的编辑，您不需要同时读取和写入。

*   打开应用程序
*   阅读文件。将文件的内容放入文本框中。关闭文件
*   将文本框内容保存到文件中。关闭文件。

如您所见，如果您在两次使用之间关闭文件，则永远不需要同时读取和写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:05:22.050

每次完成写入时，您都应该写入`Close`文件，除非您需要同时写入和读取，这是您不应该做的~~不可能~~的事情，因为在大多数情况下，用于存储数据的标准文本文件并不那么安全/硬/无用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:07:49.623

尝试类似的东西

```
using(TextWriter notesWriter = new StreamWriter("text.txt"))
{
//do write-things here
} 
```

关闭刹车后，Streamwriter 将被处理，您可以读取该文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:07:50.157

解决方法是不要这样做。虽然在技术上可以做到这一点，但您想要的方式（通过使用**流**语义访问文件）几乎不可能是正确的，因为即使您修复了文件共享，这也意味着您正在读回相同的东西您在无限循环中编写。

您可以使用基于分页的文件访问隐喻，这又不太可能是您想要做的。

最可能的选择是您想写入不同的文件，即原始文件的（修改的？）副本，然后将副本与原始文件交换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T14:09:14.773

当然你可以同时读写，但你只需要一个参考：

```
Stream l_fileStream = File.Open( "text.txt", FileMode.Open, FileAccess.ReadWrite ); 
```

[http://msdn.microsoft.com/en-us/library/s67691sb.aspx](http://msdn.microsoft.com/en-us/library/s67691sb.aspx)

现在您可以读取/写入文件：

```
StreamReader l_reader = new StreamReader( l_fileStream );
StreamWriter l_writer = new StreamWriter( l_fileStream ); 
```

你为什么想做这个？我不知道。似乎您想在开始下一个操作之前完成一个操作，除非您想在实际的字节数组中陷入困境（例如高级分页系统），在这种情况下，您可能没有足够的经验来拉这样的事关了。

# codeigniter - 为什么 CodeIgniter 不使用原生 PHP 会话？

> ID：12916444
> 
> 赞同：6
> 
> 时间：2012-10-16T14:03:10.197
> 
> 标签：codeigniter, session, cookies, codeigniter-2

PHP 框架“CodeIgniter”提供了一个不使用原生 PHP-Sessions 的 Session 类。相反，他们使用 Cookie 开发了自己的会话系统。

在他们的网站[CodeIgniter.com](http://ellislab.com/codeigniter/user_guide/libraries/sessions.html)上，他们写道：

```
Note: The Session class does not utilize native PHP sessions. It generates its own session data, offering more flexibility for developers. 
```

如下所述，最多只能保存 4KB。

```
Note: Cookies can only hold 4KB of data, so be careful not to exceed the capacity. The encryption process in particular produces a longer data string than the original so keep careful track of how much data you are storing. 
```

那么，这究竟如何为程序员提供更大的灵活性呢？**开发人员不**使用原生 PHP 会话的真正原因是什么？

感谢您的信息！

# c - 在 Linux 上写入映射内存时返回带 mmap 的共享内存

> ID：12916448
> 
> 赞同：1
> 
> 时间：2012-10-16T14:03:39.933
> 
> 标签：c, linux, shared-memory, mmap

我试图找出共享内存并尝试编写一个涉及消费者和生产者的简单程序。我没有进入消费者部分，发现了这个奇怪的小问题：父母会在`*spool=3;`没有押韵或理由的情况下返回。什么都没有`dmesg`。

```
#include <unistd.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>

#define PRODUCER_ERROR(msg)         \
    do {perror("Producer Error: " msg "\n"); exit(1); }while(0)

#define SHM_NAME "/my_sharedmem"

void producer();

int main(int argc, char *argv[])
{
    pid_t pID = fork();
    if (pID == 0) {
    // Code only executed by child process
    printf ("Son here\n");
    return 0;
    } else if (pID < 0) {
    perror("Unable to fork\n");
    exit(1);
    } else {
    // Code only executed by parent process
    printf ("Parent here\n");
        producer();
    return 0;
    }

    return 0;
}

void producer()
{
    int fd, d;
    unsigned* spool;

    printf("<<Producer>> started\n");
    fd = shm_open(SHM_NAME, O_CREAT | O_RDWR,  S_IRWXU | S_IRWXG | S_IRWXO ); // FIXED

    printf ("<<Producer>> memory file opened\n");

    spool = mmap(NULL, sizeof(unsigned), PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, fd, 0);
    printf ("<<Producer>> mmaped to %p\n\tGonna write.\n", spool);
    perror(NULL);

    *spool = 3;
    // msync(spool, sizeof(unsigned), MS_SYNC | MS_INVALIDATE);

    printf("<<Producer>> ended\n");
} 
```

编辑：固定 shm_open 模式参数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:18:32.887

您使用 shm_open 获得的对象大小为零。你需要为它分配一些空间。mmap 将允许您映射超出其大小的事物（shm 对象和文件），但是当您访问该内存时会崩溃。

在 shm_open 之后这样的事情是你想要做的：

```
ftruncate(fd, <the size you want>); 
```

您也可以在 mmap 之后执行此操作，如果这会使您的船浮起来的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:14:33.800

你有`shm_open`错误的模式参数。这应该是一个模式规范`open`。巧合的是，您的版本可能禁止写入该地址，因此当您尝试写入该地址时，该过程会崩溃。

顺便说一句：您应该始终检查库调用的返回，例如`shm_open`and `mmap`。

*编辑：*正如我在下面的评论中所观察到的，您也缺少使用`ftruncate`.

# javascript - D3 选择性缩放

> ID：12916449
> 
> 赞同：3
> 
> 时间：2012-10-16T14:03:44.360
> 
> 标签：javascript, d3.js, zooming, force-layout

我正在开发一个带有一些附加功能的强制导向图形布局：可选链接/节点、工具提示、鱼眼效果，以及——对我的问题很重要——缩放和平移。

现在，缩放效果很好，如下所示：

```
d3 ... .append('svg:g').call(d3.behavior.zoom().on("zoom", redraw))... 
```

重绘功能看起来像这样......

```
function redraw() {
  trans = d3.event.translate;
  scale = d3.event.scale;
  vis.attr("transform", "translate(" + trans + ")" + " scale(" + scale + ")");
} 
```

但是，此方法会缩放整个 SVG 图形，包括字体大小、图形边缘、节点周围的线条笔划宽度等。

是否可以*不*缩放某些元素？到目前为止，我看到的唯一解决方案是写这样一行（从这里获取[http://jsfiddle.net/56RDx/2/](http://jsfiddle.net/56RDx/2/)）

```
node.attr("font-size", (nodeFontSize / d3.event.scale) + "px"); 
```

在重绘方法中，基本上是在飞行中反转某些元素的缩放。然而，我的问题是（除了这是一个丑陋的黑客之外），我的边缘宽度是在图形绘制上动态生成的（根据一些图形属性......），所以这种“反转”方法不起作用......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T07:58:26.470

1.  您可以向要触发缩放的元素添加一个类：

    ```
    d3 ... .append('svg:g').classed("some_classname", true).call(d3.behavior.zoom().on("zoom", redraw))... 
    ```

    然后做：

    ```
    function redraw() {
      trans = d3.event.translate;
      scale = d3.event.scale;
      vis.selectAll("some_classname").attr("transform", "translate(" + trans + ")" + " scale(" + scale + ")");
    } 
    ```

    * * *

2.  或者您可以为所有不想触发缩放的元素添加一个类，然后使用 CSS3 :not 伪类：

    ```
    function redraw() {
      trans = d3.event.translate;
      scale = d3.event.scale;
      vis.selectAll("*:not(.some_classname)").attr("transform", "translate(" + trans + ")" + " scale(" + scale + ")");
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:29:55.023

我能找到的唯一解决方案是“丑陋的黑客”，例如，如果（我假设你是）你试图不缩放线条，你应该尝试下面的方法，它适用于放大和缩小：

演示：http: [//jsfiddle.net/SO_AMK/gJMTb/](http://jsfiddle.net/SO_AMK/gJMTb/)

JavaScript：

```
function redraw() {
  vis.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")");
  vis.attr("font-size", (nodeFontSize / d3.event.scale) + "px");
  vis.selectAll("line.link").style("stroke-width", getStrokeWidth); // Function so it runs for each element individually
}

function getStrokeWidth(){
    if (!this.__data__.stroke) { // Doesn't exist, so set it to the original stroke-width
        this.__data__.stroke = parseFloat(d3.select(this).style("stroke-width"));
        // I found __data__ to be easier than d3's .data()
    }
    return this.__data__.stroke / d3.event.scale + "px";
} 
```

有关使用函数的详细信息，请参阅[文档](https://github.com/mbostock/d3/wiki/Selections#wiki-style)`style()`

# javascript - 从按钮单击更改 jQuery 覆盖图像

> ID：12916453
> 
> 赞同：1
> 
> 时间：2012-10-16T14:03:49.273
> 
> 标签：javascript, jquery, jquery-ui

我正在尝试通过从对话框内部单击按钮来更改 jQuery-ui 对话框覆盖图像，但在覆盖图像下面的代码中没有改变。我需要在点击事件中动态编辑叠加层的 CSS。

```
$("document").ready(function(){
    var divCustom = '<div id="myOverlay">
                         <div id="button1">button1</div>
                         <div id="button2">button2</div>
                     </div>';

    $(divCustom).dialog({ height: 400, width: 700, modal: true });

    $("#button1").click(function(){
        $("#myOverlay .ui-widget-overlay").css({ 
            "background-image": "happy.gif"
        });
    });

    $("#button2").click(function(){
        $("#myOverlay .ui-widget-overlay").css({ 
            "background-image": "sad.gif" 
        });
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:15:11.553

没有 JSFiddle 就无法对此进行测试，但以下内容可能会有所帮助：

```
$("#myOverlay .ui-widget-overlay").css({ "background-image": "url(happy.gif)" }); 
```

# c# - 如何格式化签名货币

> ID：12916455
> 
> 赞同：1
> 
> 时间：2012-10-16T14:04:07.173
> 
> 标签：c#

我有以下情况。十进制值需要显示为货币，但包括适当的货币符号和符号，因此：

1.  -45.23 显示为 -£45.23
2.  45.23 显示为 +£45.23

货币符号必须来自`System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol`。我有这个，但我找不到交换符号和货币符号的方法：

```
string s1 = string.Format(@"{1}{0:+#,##0.00;-#,##0.00}", 45.09M, 
    System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol);
Console.WriteLine(s2);
string s2 = string.Format(@"{1}{0:+#,##0.00;-#,##0.00}", -45.09M, 
    System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol);
Console.WriteLine(s2); 
```

输出：

```
£+45.09
£-45.09 
```

我想：

```
+£45.09
-£45.09 
```

# 更新

有人发布了关于该属性的另一个答案[`NumberFormatInfo.CurrencyPositivePattern`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencypositivepattern.aspx)，看起来很有希望，特别是因为微软似乎忽略了该[`NumberFormatInfo.CurrencyNegativePattern`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencynegativepattern.aspx)属性包含用于呈现负号的各种选项的可能性。但是，`NumberFormatInfo.CurrencyPositivePattern`不包括包含正号的选项！该死。感谢提到它的人，但删除了他们的评论。尽管如此，我还是学到了一个人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:07:07.420

当我发布这篇文章时，我意识到答案是分三步而不是两步完成：

```
string s1 = string.Format(@"{0:+;-}{1}{0:#,##0.00;#,##0.00}", 45.09M, System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol);
Console.WriteLine(s1);

string s2 = string.Format(@"{0:+;-}{1}{0:#,##0.00;#,##0.00}", -45.09M, System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol);
Console.WriteLine(s2); 
```

输出：

```
+£45.09
-£45.09 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:25:34.390

您*明确地*`string.Format`将+/- 放在前面。

 *如果将操作分为两个步骤，它会变得更容易。首先注入您的 currentcy 符号，然后格式化您的号码。

```
string fmt = string.Format(@"{{0:+{0}#,##0.00;-{0}#,##0.00}}",  
    System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol);
string s1 = string.Format(fmt, 45.09M);
Console.WriteLine(s1); 
string s2 = string.Format(fmt, -45.09M);
Console.WriteLine(s2); 
```*

# visual-studio - 无法创建虚拟目录

> ID：12916456
> 
> 赞同：19
> 
> 时间：2012-10-16T14:04:09.740
> 
> 标签：visual-studio, iis, iis-express, hosts

我正在开发一个通过 Facebook 进行身份验证的网站，以便用户可以通过他/她的 Facebook 个人资料登录。我见过类似的问题，但没有一个能完全涵盖我的问题。

为了在本地测试这个 Facebook 身份验证，我认为需要一些技巧。你看，Facebook 只允许在身份验证过程之后重定向到某些域。对于这些域，`localhost`不是一个选项。

所以我决定做一些研究。我最终更改了我的`hosts`文件以将域`local.fablelane.com`指向`127.0.0.1`. 但是，现在当我尝试更改 Visual Studio 2012 中的虚拟目录时它会抱怨。

首先，我在更改后看到此对话框。

![在此处输入图像描述](../Images/83e8432bd2b4b3f2a6330c34ac9655b0.png)

然后我单击是并在此处结束此对话框。

![在此处输入图像描述](../Images/a5e6cc26075e8bcd7776cb48faf6ba23.png)

你建议我尝试什么？如何更改我的虚拟目录？重要的是，我找到一种方法来以编程方式、通过在某处更改文件或通过命令行来执行此操作。这样做的原因是我打算在未来为我做一个自动安装程序。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-01-07T20:09:09.703

您将需要取消选中`Use IIS Express`并将您的新名称添加`local.fablelane.com`为与 IIS 的绑定，以便当 VS 尝试打开站点 URL 时，主机头与站点匹配。

此外，您是否有任何理由需要特定端口，而不是默认端口？80应该没问题。

您还没有说您使用的是哪个版本的 IIS，但是在 8 上，打开 IIS Admin，展开您的机器名称，展开`Sites`，右键单击`local.fablelane.com`（或者您已命名它），然后选择`Edit bindings`并添加`local.fablelane.com`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T00:12:42.850

尝试取消选中“使用 IIS Express”选项。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-03-03T07:16:19.780

检查您在 IIS 中的网站端口号是否已更改。如果更改编辑绑定并将端口号更改为 80

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2016-06-28T18:30:16.163

除上述内容外，单击覆盖应用程序根 URL 并粘贴您在项目 URL 中提供的主机名地址。

它对我有用。

# vim - 我可以让 vim 显示当前函数/命名空间/等吗？在底部栏中？

> ID：12916459
> 
> 赞同：2
> 
> 时间：2012-10-16T14:04:13.767
> 
> 标签：vim, namespaces, text-editor

我喜欢 textedit 和 sublime edit 等应用程序所具有的各种功能，您可以在 UI 的小栏中看到当前命名空间。有没有办法让 vim 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:53:53.367

[电力线](http://www.vim.org/scripts/script.php?script_id=3881)插件显示当前功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T07:10:21.907

这是您可以放入 .vimrc 的单行代码（尽管需要安装 taglist.vim）：

```
set statusline=%<%f\ [%{Tlist_Get_Tagname_By_Line()}]\ %h%m%r%=%-14.(%l,%c%V%)\ %P 
```

...当您四处移动时，它将显示您的光标所在的当前功能。

我忘记了细节，但有时您需要手动刷新它，在这种情况下，此映射很有用：

```
map <F4> :TlistUpdate<CR>:TlistHighlightTag<CR> 
```

^ 当您按 F4 时，它将刷新状态行中的函数名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:18:01.693

TagBar或[TagList](http://www.vim.org/scripts/script.php?script_id=273)[有](http://majutsushi.github.com/tagbar/)帮助吗？两者都提供了一个小功能来添加到您的状态栏以达到这种效果。或者也许[这个其他插件](http://www.vim.org/scripts/script.php?script_id=2055)？

我不喜欢这种功能。我更喜欢`<C-w>}`在需要时使用。

# c# - 将值传递给 Linq 中的 OrderBy 或 OrderByDescending 语句？

> ID：12916460
> 
> 赞同：1
> 
> 时间：2012-10-16T14:04:14.560
> 
> 标签：c#, linq

> **可能重复：**
> [动态 LINQ OrderBy](https://stackoverflow.com/questions/41244/dynamic-linq-orderby)

如何将值传递给 Linq 中的 OrderBy 或 OrderByDescending 语句？我正在尝试动态获取属性名称：

```
x.GetType().GetProperty(sortField) 
```

这似乎不起作用。有任何想法吗？

```
private void DynamicSort(ref List<Quote> myQuotes, String sortField, String direction)
{         
        if(direction == "ASC"){
            this.grdViewDrafts.DataSource = myQuotes.OrderBy(x =>  x.GetType().GetProperty(sortField)).ToList();
        }else{
            this.grdViewDrafts.DataSource = myQuotes.OrderByDescending(x => x.GetType().GetProperty(sortField)).ToList();
        }

} 
```

解决方案：

```
this.grdViewDrafts.DataSource =  myQuotes.OrderBy(x => x.GetType().GetProperty(sortField).GetValue(x, null)).ToList(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:17:40.747

代码中的实际问题是您只获取`PropertyInfo`对象而不是属性值本身。要获取属性值，您必须调用对象`GetValue()`的方法`PropertyInfo`。

# c# - 将未知值传递给 switch 语句时应该抛出什么类型的异常

> ID：12916461
> 
> 赞同：11
> 
> 时间：2012-10-16T14:04:19.307
> 
> 标签：c#, exception-handling

## 编辑 1

更新以使枚举不是方法的参数...

## 问题

这种类型的问题经常出现在 switch 语句中的枚举中。在示例代码中，开发者已经计算了程序当前使用的所有国家，但是如果将另一个国家添加到 Country 枚举中，则应该抛出异常。我的问题是，应该抛出什么类型的异常？

## 示例代码：

```
enum Country
{
    UnitedStates, Mexico,
}

public string GetCallingCode(Guid countryId){
    var country = GetCountry(countryId);
    switch (country)
    {
        case Country.UnitedStates:
            return "1";
            break;
        case Country.Mexico:
            return "52";
            break;
        default:
            // What to throw here
        break;
    }
} 
```

我看过

*   [NotImplemented](http://msdn.microsoft.com/en-us/library/system.notimplementedexception.aspx)，*当请求的方法或操作未实现时引发的异常。*
*   [NotSupported](http://msdn.microsoft.com/en-us/library/system.notsupportedexception.aspx) *基类中不支持某些方法，期望这些方法将在派生类中实现。派生类可能只实现基类方法的子集，并为不受支持的方法抛出 NotSupportedException。
    对于对象有时可以执行请求的操作，并且对象状态决定是否可以执行操作的场景，请参阅 InvalidOperationException。*
*   [InvalidOperation](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception.aspx) *用于调用方法失败是由无效参数以外的原因引起的情况。*

我的猜测是 NotImplemented 或 Invalid Operation。我应该使用哪一个？有人有更好的选择吗（我知道自己*滚动*始终是一种选择）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-16T14:07:08.497

我会选择`ArgumentException`，因为协议无效。

编辑：http: [//msdn.microsoft.com/en-us/library/system.argumentexception%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/system.argumentexception%28v=vs.71%29.aspx)

还有`InvalidEnumArgumentException`，这可能更准确地描述了问题，但是，我之前没有看到有人使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-16T14:30:59.747

一种选择是在调试模式下进行几乎方法合同检查。为美观的表单添加一个扩展方法：

```
[Conditional("DEBUG")]
public static bool AssertIsValid(this System.Enum value)
{
    if (!System.Enum.IsDefined(value.GetType(), value))
        throw new EnumerationValueNotSupportedException(value.GetType(), value); //custom exception
} 
```

我想它可能只有在调试模式下才能通过你的开发/测试环境和单元测试，并且在生产中没有开销（尽管这取决于你）

```
public string GetCallingCode(Guid countryId)
{
    var country = GetCountry(countryId);
    country.AssertIsValid(); //throws if the country is not defined

    switch (country)
    {
        case Country.UnitedStates:
            return "1";
        case Country.Mexico:
            return "52";
    }
} 
```

我建议尽管这实际上是您的`GetCountry`方法的责任。*它*应该识别出`countryId`无效并抛出异常。

无论如何，这也应该被您的单元测试所捕获，或者以某种方式更好地处理。无论您在何处将字符串/int 转换为枚举，都应该由一个单一的方法处理，该方法反过来可以检查/抛出（就像任何`Parse`方法一样），并有一个检查所有有效数字的单元测试。

一般来说，我不认为各种`ArgumentExceptions`（等等）是一个很好的候选，因为有几个条件（非参数）案例。我认为如果您将检查代码移动到一个位置，您不妨抛出自己的异常，该异常可以准确地传达给任何正在监听的开发人员。

编辑：考虑到讨论，我认为这里有两个特殊情况。

## 案例 1：将底层类型转换为等效枚举

如果您的方法采用某种类型的输入数据（字符串、整数、Guid？），则执行转换为枚举的代码应该验证您是否有一个可用的*实际枚举。*这就是我在上面的答案中发布的情况。在这种情况下，可能会抛出您自己的异常或可能`InvalidEnumArgumentException`.

这应该像任何标准输入验证一样对待。在您的系统中的某个地方，您正在提供垃圾输入，因此请像处理任何其他解析机制一样处理它。

```
var country = GetCountry(countryId);

switch (country)
{
    case Country.UnitedStates:
        return "1";
    case Country.Mexico:
        return "52";
}

private Country GetCountry(Guid countryId)
{
    //get country by ID

    if (couldNotFindCountry)
        throw new EnumerationValueNotSupportedException(.... // or InvalidEnumArgumentException

    return parsedCountry;
} 
```

编辑：当然，编译器要求你的方法抛出/返回，所以不太确定你应该在这里做什么。我想这取决于你。如果确实发生了这种情况，那可能是一个愚蠢的异常（下面的案例 2），因为您通过了输入验证*但*没有更新开关/案例来处理新值，所以也许应该这样做`throw new BoneheadedException()`；

## 案例 2：添加一个新的枚举值，您的代码中的 switch/case 块不处理该值

如果您是代码的所有者，这属于 Eric Lippert 在@NominSim 的回答中描述的“Boneheaded”异常。尽管这实际上根本不会导致异常*，*同时使程序处于异常/无效状态。

最好的方法可能是在您对枚举执行 switch/case（或类似操作）运行的任何地方，您应该考虑编写一个单元测试，*自动针对枚举的**所有*定义值运行该方法。因此，如果你懒惰或不小心错过了一个块，你的单元测试会警告你，你没有更新一个方法来解释你的枚举列表的变化。

最后，如果您的枚举来自您没有意识到他们更新了值的第 3 方，您应该编写一个快速的单元测试来验证您的所有预期值。因此，如果您编写程序时检查`UnitedStates`and `Mexico`，那么您的单元测试应该只是这些值的 switch/case 块并抛出异常，否则会在/如果它们最终添加时警告您`Canada`。当更新 3rd 方库后该测试失败时，您知道必须在哪里/在哪里进行更改才能兼容。

因此，在这个“案例 2”中，您应该抛出任何您想要的旧异常，因为只要它准确地向*您*或您的单元测试的消费者传达缺少的内容，它将由您的单元测试处理。

* * *

在任何一种情况下，我都不认为 switch/case 代码应该过分关心无效输入并且不在那里抛出异常。它们应该在设计时抛出（通过单元测试）或在验证/解析输入时抛出（因此抛出适当的“解析/验证”异常）

* * *

编辑：我偶然发现了[Eric Lippert 的一篇文章，](http://blogs.msdn.com/b/ericlippert/archive/2011/02/24/never-say-never-part-two.aspx)其中讨论了 C# 编译器如何检测具有返回值的方法是否在没有返回的情况下达到其“终点”。编译器擅长保证端点有时是不可达的，但在上述情况下，*我们的开发人员*知道它是不可达的（除非在上面提到的情况下`BoneheadedExceptions`发挥作用）。

没有讨论的内容（至少我看到了）作为开发人员应该做什么来解决这些情况。编译器*要求*您提供返回值或抛出异常，即使您*知道*它永远不会到达该代码。在这种情况下，谷歌搜索并没有神奇地出现一些可以利用的异常（尽管我无法找出好的搜索词），我宁愿抛出一个异常并被告知我认为它无法到达终点的*假设*是不正确的，而不是返回*一些*可能不会通知我问题或导致不良行为的值。在这种情况下，也许某种`UnexpectedCodePathFailedToReturnValueException`形式是最有效的。当我有时间时，我会做更多的挖掘，也许会发布一个关于[程序员的问题](https://softwareengineering.stackexchange.com/)争取一些讨论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:33:37.007

[`InvalidOperationException`](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception.aspx)如果您正在使用的值纯粹是您的对象当前状态的产物，我会使用。正如它所说：

> 当方法调用对于对象的当前状态无效时引发的异常。

即使您更新了问题，由于您无法正确处理的特定值是从传递给它的参数派生的，我仍然会使用`ArgumentException`- 您可以在错误消息中解释您从参数*派生*的信息不匹配你可以处理的任何事情。

* * *

对于两者而言`NotImplementedException`，`NotSupportedException`期望是，无论调用者做什么，他们都无法纠正这种情况。而`ArgumentException`和`InvalidOperationException`是线索，如果调用者将使用不同的参数，或将对象转换到另一个状态（分别），调用可能会起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T14:08:56.717

在您列出的例外情况中，仅`InvalidOperationException`适合您的情况。我会考虑使用这个，或者[`ArgumentException`](http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx)更具体的[`ArgumentOutOfRangeException`](http://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception.aspx)，因为你的`switch`值是作为参数提供的。

或者，正如你所说，自己动手。

**编辑：**根据您更新的问题，我建议`InvalidOperationException`您是否要使用框架异常。但是，对于这种更通用的情况，我肯定更喜欢自己动手——你不能保证`InvalidOperationException`不会在调用堆栈的其他地方被捕获（可能被框架本身捕获！），所以使用你自己的异常类型要多得多强大的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-16T14:10:58.323

就个人而言，我认为这根本不适合任何异常。如果添加 Country，则应在 switch 语句中添加 case。代码不应中断，因为您向枚举添加了一个值。

Eric Lippert有[一篇](http://blogs.msdn.com/b/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)关于何时使用异常的文章，它将您正在寻找的异常类型分类为：（请原谅它不是我的措辞）

> **愚蠢**的异常是您自己的错误，*您可以阻止它们，因此它们是您代码中的错误*。**你不应该抓住它们；这样做会隐藏代码中的错误。**相反，您应该*编写代码，使异常不可能首先发生*，因此不需要被捕获。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-10-16T14:08:35.580

不可能传递另一个值，因为您的枚举将可能的值限制为您处理的值。所以你不需要任何例外。

# sql-server-2005 - 在触发器中插入已删除的行

> ID：12916463
> 
> 赞同：0
> 
> 时间：2012-10-16T14:04:21.207
> 
> 标签：sql-server-2005, triggers

我需要将表 Table_A 中已删除的行插入到 Table_B 中，这些行具有相同的结构
（类似于回收站），但我在 SQL SERVER 触发器方面没有太多经验

```
CREATE TRIGGER dbo.Table_A_Delete_Instead_Of_Trigger
ON dbo.Table_A
INSTEAD OF DELETE
AS
BEGIN    
     INSERT INTO Table_B 
     SELECT T 

     DELETE T                  
END 
```

请饶恕我的经验之湖。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:17:41.627

您不需要“INSTEAD OF”触发器，您需要“AFTER”触发器。

给定一个表 TableA...

```
CREATE TABLE [dbo].[TableA](
    [Col1] [varchar](50) NOT NULL,
    [Col2] [varchar](50) NOT NULL
) ON [PRIMARY] 
```

和相应的TableB ...

```
CREATE TABLE [dbo].[TableB](
    [Col1] [varchar](50) NOT NULL,
    [Col2] [varchar](50) NOT NULL
) ON [PRIMARY] 
```

然后下面的触发器会做你想做的事：

```
CREATE TRIGGER trg_TableA_Archive 
ON  TableA
AFTER DELETE
AS 

    INSERT INTO TableB
    SELECT *
    FROM deleted
GO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:06:31.257

尝试这个：

```
CREATE TRIGGER dbo.Table_A_Delete_Instead_Of_Trigger
ON dbo.Table_A
AFTER DELETE
AS
BEGIN    
     INSERT INTO Table_B 
     SELECT * FROM 
     DELETED;          
END 
```

我认为在这种情况下你不需要一个代替触发器。

# ruby-on-rails - Rails routes.rb - 不区分大小写

> ID：12916465
> 
> 赞同：6
> 
> 时间：2012-10-16T14:04:22.163
> 
> 标签：ruby-on-rails, routes

网址（由于不清楚的原因，会产生不同的问题/没有真正的优势）由 w3 定义区分大小写。

我在 routes.rb 中不区分大小写的可能性是什么？

这里匹配：

```
match '/:foo/library/:bar' => 'library#show' 
```

网址示例：/europe/library/page4711

使用 { :foo => "europe", :bar => "page4711" } 在库控制器中调用显示操作

*我想要的是两件事：*

*   :foo 的参数值需要一个 .downcase 所以 /Europe 应该是 { :foo => "europe" }
*   库应该不区分大小写（即 /Library、/LIBRARY、/liBRarY 都应该匹配）

如何在 routes.rb 中执行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T15:21:07.833

好的，回答我自己的问题：

在 Rails routes.rb 中没有很好的方法来做到这一点。

这是我所做的：

首先，我在控制器中创建了一个 before_filter：

```
before_filter :foo_to_lower_case

def foo_to_lower_case
  params[:foo] = params[:foo].downcase
end 
```

对于第二个，我创建了一个负载均衡器规则以将其小写到 rails 应用程序。当然，您也可以定义一个 nginx/apache 规则。

**编辑**：我为第二部分找到了另一个解决方案，因为我不喜欢每个 url 的预解析/替换。

我为一个符号制作了“库”，并为它写了一个约束，它只接受“库”这个词的任何形式。

所以 routes.rb 中的行看起来像：

```
match '/:foo/:library/:bar' => 'library#show', :constraints => { :library => /library/i } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-14T13:19:42.487

只需将其添加到您的 Gemfile

```
gem 'route_downcaser' 
```

重启rails，不需要配置。该项目的 github 位于：

[https://github.com/carstengehling/route_downcaser](https://github.com/carstengehling/route_downcaser)

如 gem 中所述，“查询字符串参数和资产路径不会以任何方式更改。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T17:05:12.660

要缩小路径，您可以设置一个初始化程序来添加一个 Rack 中间件。在这里，我正在检查路径是否以更长的单词开头`/posts`并且`posts`不是更长单词的一部分。有关更多信息，请参阅代码注释。

```
class PathModifier
  def initialize(app)
    @app = app
  end

  def call(env)
    if env['PATH_INFO'] =~ /^\/posts\b/i
      Rails.logger.debug("modifying path")
      %w(PATH_INFO REQUEST_URI REQUEST_PATH ORIGINAL_FULLPATH).each do |header_name|
        # This naively downcases the entire String. You may want to split it and downcase
        # selectively. REQUEST_URI has the full url, so be careful with modifying it.
        env[header_name].downcase!
      end
    end
    @app.call(env)
  end
end
Rails.configuration.middleware.insert(0, PathModifier) 
```

# php - 标题的卷曲问题

> ID：12916472
> 
> 赞同：1
> 
> 时间：2012-10-16T14:04:55.390
> 
> 标签：php, curl, http-headers, libcurl

我在 CURL 上的标头有问题，我的脚本有两部分，第一部分是认证，第二部分是请求，第一部分运行良好，我得到了结果代码和一个 id，在我设置的第二部分使用该 id 设置标头并将其发送到标头上，但我收到此错误（< HTTP/1.1 401 Unauthorized），但是，我现在尝试使用 firefox 插件（ModifyHeaders），现在得到响应（我在这个软件上设置了 id 并通过 URL 访问 WS），我不知道发生了什么或如何修复它，这里是代码：

```
$postargs = array('username' => 'user', 'password' => 'pass', 'key' => '1234567890');
$postargs = json_encode($postargs);

$ch = curl_init();
curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Content-Type: application/json; charset=utf-8","Accept:application/json, text/javascript, */*; q=0.01"));
curl_setopt($ch, CURLOPT_POSTFIELDS, $postargs);
curl_setopt($ch, CURLOPT_URL, "https://ws.com/login");
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($ch, CURLOPT_HTTPPROXYTUNNEL, 0);

curl_setopt($ch, CURLOPT_VERBOSE, TRUE);
$fh = fopen('curl_debug.txt', 'w');
curl_setopt($ch, CURLOPT_STDERR, $fh);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);            
$response = curl_exec($ch);
$a = json_decode($response);
echo $a->result;
curl_close($ch);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://ws.com/data");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("id : $a->result","dataRequest : name","Content-Type: application/json; charset=utf-8","Accept:application/json, text/javascript, */*; q=0.01"));
curl_setopt($ch, CURLOPT_VERBOSE, TRUE);
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($ch, CURLOPT_HTTPPROXYTUNNEL, 0);
$fh2 = fopen('curl_debug2.txt', 'w');
curl_setopt($ch, CURLOPT_STDERR, $fh2);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); 
$response2 = curl_exec($ch); 
```

脚本有什么问题？为什么标头（在本例中为 id）不是由脚本执行，而是由 ModifyHeaders 执行？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:14:54.990

第二个请求是您刚刚关闭经过身份验证的 curl 连接并初始化一个新连接后的 GET 请求。这是一个完全未经身份验证的请求。您没有像在 POST 中那样通过身份验证数组。

看看这个：[我可以在 curl 连接上发出多个请求吗？](https://stackoverflow.com/questions/479490/can-i-make-more-then-one-request-on-a-curl-connection)

# mvvm - Silverlight DataForm 不显示正确的初始值

> ID：12916474
> 
> 赞同：0
> 
> 时间：2012-10-16T14:05:05.247
> 
> 标签：mvvm, silverlight-5.0, dataform

我试图强制 DataForm 显示一个与 ItemsSource 列表的第一个不同的初始值，但没有成功。

我正在使用 MVVM 模式。

我只是将 ItemsSource 绑定到客户列表（所有客户），然后将 CurrentItem 绑定到我希望在 DataForm 上作为初始项目显示的一个客户：

```
 <toolkit:DataForm Height="292"
                    HorizontalAlignment="Left"
                    ItemsSource="{Binding Path=Customers}"
                    CurrentItem="{Binding SelectedCustomer}"
                    Margin="88,122,0,0"
                    Name="customerDataForm"
                    VerticalAlignment="Top"
                    Width="342" /> 
```

在我设置的视图模型中：

```
 void loadOpCustomers_Completed(object sender, EventArgs e) {
     Customers = _Context.Customers;
     SelectedCustomer = Customers.Where(c => c.CustomerID == initialCustomerID).FirstOrDefault();
  } 
```

当我调试它时，SelectedCustomer 持有我想要的确切客户，但 DataForm 坚持显示客户列表的第一个。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:18:23.160

在 XAML 中添加绑定模式：

```
ItemsSource="{Binding Path=Customers}"
CurrentItem="{Binding SelectedCustomer,Mode=TwoWay}" 
```

并确保您的 ViewModel 实现了 INotifyPropertyChanged。

# c++ - 为什么 stl::list 复制元素添加到列表中？

> ID：12916480
> 
> 赞同：10
> 
> 时间：2012-10-16T14:05:25.830
> 
> 标签：c++, stl

[列表](http://www.cplusplus.com/reference/stl/list/push_back/)的标准模板库文档说：

> 无效 push_back ( const T& x );
> 
> 在末尾添加元素 在列表的末尾添加一个新元素，紧跟在其当前最后一个元素之后。这个新元素的内容被初始化为 x 的副本。

这些语义与 Java 语义有很大不同，让我感到困惑。我缺少 STL 中的设计原则吗？“一直在复制数据”？这让我害怕。如果我添加对对象的引用，为什么要复制对象？为什么不只是对象通过？

这里必须有一个语言设计决定，但我在 Stack Overflow 和其他网站上找到的大多数评论都集中在与所有这些对象复制都可能引发异常的事实相关的异常引发问题上。如果您不复制，而只处理引用，那么所有这些异常问题都会消失。很迷茫。

请注意：在我使用的这个遗留代码库中，boost 不是一个选项。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T14:12:52.600

STL 总是准确地存储您告诉它存储的内容。`list<T>`始终是一个列表，`T`因此所有内容都将按值存储。如果您想要一个指针列表，请使用`list<T*>`，这将类似于 Java 中的语义。

这可能会诱使您尝试`list<T&>`，但这是不可能的。C++ 中的引用与 Java 中的引用具有不同的语义。在 C++ 中，引用必须初始化为指向一个对象。一个引用被初始化后，它会一直指向这个对象。你永远不能让它指向不同的对象。这使得在 C++ 中不可能有一个引用容器。Java 引用与 C++ 指针更密切相关，因此您应该使用`list<T*>`, 代替。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T14:07:50.057

它被称为“价值语义”。C++ 通常被编码为复制值，与 Java 不同的是，除了原始类型之外，您复制引用。它可能会吓到你，但我个人觉得 Java 的引用语义更让我害怕。但是在 C++ 中，您可以选择，如果您想要引用语义，只需使用指针（最好是智能指针）。那么你会更接近你习惯的Java。但请记住，在 C++ 中没有垃圾收集（这就是您通常应该使用智能指针的原因）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-16T14:09:10.507

您不添加对对象的引用。**你通过引用**传递一个对象。那不一样。如果您没有通过引用传递，甚至在实际插入之前可能已经制作了额外的副本。

它会复制一份，因为您需要一份副本，否则代码如下：

```
std::list<Obj> x;
{
   Obj o;
   x.insert(o);
} 
```

会留下一个无效对象的列表，因为`o`超出了范围。如果您想要类似于 Java 的东西，请考虑使用`shared_ptr`. 这为您提供了您在 Java 中习惯的优势 - 自动内存管理和轻量级复制。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-16T14:21:23.853

实际上，Java 的工作方式相同。请允许我解释一下：

```
Object obj = new Object();
List<Object> list = new LinkedList<Object>();
list.add(obj); 
```

是什么类型的`obj`？它是*对`Object`*. 实际的对象在堆上的某个地方浮动——在 Java 中您唯一能做的就是传递对它的引用。您将对该对象的引用传递给列表的`add`方法，列表本身就存储了该引用的**副本**。您可以稍后修改命名引用`obj`，而不会影响存储在列表中的该引用的单独副本。（当然，如果您修改对象本身，您可以通过任一引用看到该更改。）

C++ 有更多选择。您可以模拟 Java：

```
class Object {};
// ...
Object* obj = new Object;
std::list<Object*> list;
list.push_back(obj); 
```

是什么类型的`obj`？它是一个指向`Object`. 当您将它传递给列表的`push_back`方法时，列表本身会存储该指针的**副本**。这与 Java 具有相同的语义。

但是，如果您从效率的角度考虑…… C++ 指针/Java 引用有多大？4 字节或 8 字节，具体取决于您的架构。如果您关心的对象大约是那个大小或更小，为什么还要费心把它放在堆上，然后到处传递指向它的指针呢？只需传递对象：

```
class Object {};
// ...
Object obj;
std::list<Object> list;
list.push_back(obj); 
```

现在，`obj`是一个实际的对象。您将它传递给列表的`push_back`方法，该方法本身存储该对象的**副本**。在某种程度上，这是一个 C++ 习语。它不仅对指针是纯开销的小对象有意义，而且在非 GC 语言中它也使事情变得更容易（堆上没有任何可能意外泄漏的东西），并且如果对象的生命周期自然绑定到列表中（即，如果它从列表中删除，那么在语义上它应该不再存在），那么您不妨将整个对象存储在列表中。它还具有缓存局部性优势（`std::vector`无论如何，当在 中使用时）。

* * *

你可能会问，“那为什么`push_back`要使用引用参数呢？” 有一个足够简单的理由。每个参数都按值传递（同样，在 C++ 和 Java 中）。如果你有一个`std::list`of `Object*`，那很好——你传入你的指针，然后**复制**那个指针并传递给`push_back`函数。然后，在该函数内部，制作该指针的另一个副本并将其存储到容器中。

这对指针来说很好。但是在 C++ 中，复制对象可以任意复杂。复制构造函数可以做*任何事情*。在某些情况下，将对象复制两次（一次复制到函数中，再复制到容器中）可能会导致性能问题。所以`push_back`通过 const 引用获取它的参数——它从原始对象直接复制到容器中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-23T06:26:48.827

如果没有引用计数，就无法维持共享所有权，因此通过复制来维持单一所有权。

考虑一个常见的情况，你想将一个堆栈分配的对象添加到一个比它更长寿的列表中：

```
void appendHuzzah(list<string> &strs) {
  strs.push_back(string("huzzah!"));
} 
```

该列表无法保留原始对象，因为该对象在超出范围时将被销毁。通过复制，列表获得了自己的对象，其生命周期完全在自己的控制之下。如果不是这样，那么这种直接的用法就会崩溃并且毫无用处，我们将*始终*不得不使用指针列表。

Java 区分原始类型和引用类型。在 C++ 中，所有类型都是原始类型。

# ruby-on-rails - ActiveSupport::Notifications transaction_id

> ID：12916482
> 
> 赞同：4
> 
> 时间：2012-10-16T14:05:36.797
> 
> 标签：ruby-on-rails, transactions, notifications

我一直在 Github 上浏览 Rails 存储库以查找 transaction_id 的定义，但没有成功。

是什么样的交易？看起来相同的 transaction_id 用于一组事件。

```
ActiveSupport::Notifications.subscribe do |name, start, finish, transaction_id , payload|
  Rails.logger.debug(["notification:", name, start, finish, transaction_id , payload].join(" "))
end 
```

结果：

```
Started GET "/" for 127.0.0.1 at 2012-10-16 15:51:40 +0200

notification: sql.active_record 2012-10-16 15:51:40 +0200 2012-10-16 15:51:40 +0200 9eb707034598e4cc7c32 {:sql=>"SHOW client_min_messages", :name=>"SCHEMA", :connection_id=>46235640, :binds=>[]}

notification: sql.active_record 2012-10-16 15:51:40 +0200 2012-10-16 15:51:40 +0200 9eb707034598e4cc7c32 {:sql=>"SET client_min_messages TO 'panic'", :name=>"SCHEMA", :connection_id=>46235640, :binds=>[]}

notification: sql.active_record 2012-10-16 15:51:40 +0200 2012-10-16 15:51:40 +0200 9eb707034598e4cc7c32 {:sql=>"SET standard_conforming_strings = on", :name=>"SCHEMA", :connection_id=>46235640, :binds=>[]}

notification: sql.active_record 2012-10-16 15:51:40 +0200 2012-10-16 15:51:40 +0200 9eb707034598e4cc7c32 {:sql=>"SET client_min_messages TO 'notice'", :name=>"SCHEMA", :connection_id=>46235640, :binds=>[]}

notification: sql.active_record 2012-10-16 15:51:40 +0200 2012-10-16 15:51:40 +0200 9eb707034598e4cc7c32 {:sql=>"SET time zone 'UTC'", :name=>"SCHEMA", :connection_id=>46235640, :binds=>[]}

...

notification: process_action.action_controller 2012-10-16 15:51:40 +0200 2012-10-16 15:51:41 +0200 9eb707034598e4cc7c32 {:controller=>"PagesController", :action=>"index", :params=>{"controller"=>"pages", "action"=>"index"}, :format=>:html, :method=>"GET", :path=>"/", :status=>200, :view_runtime=>339.344333, :db_runtime=>31.421587} 
```

相同的transaction_id：9eb707034598e4cc7c32

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T23:48:30.427

我只是深入研究了这一点，希望有某种方法可以从 LogSubscriber 中获取请求。没有这样的运气。

Activesupport::Notifications::Instrumenter 有一个唯一的 id，在初始化时初始化为 SecureRandom.hex(10)。该仪器创建的任何 evernt 都会获得该 10 位十六进制 ID。

在 ActiveSupport::Notifications 中，检测器从 Thread.current 中挑选出来，如果不存在则创建 - 因此在单个线程范围内发送的所有通知都将具有相同的 transaction_d，将它们统一在一起（这很好），但是该 transaction_id 的初始值只是一个 10 位随机十六进制。（在 Activesupport::Notifications::Instrumenter#unique_id 中定义）

# javascript - 带有 UIAutomation 的 TypeScript（Apple 的库）

> ID：12916483
> 
> 赞同：1
> 
> 时间：2012-10-16T14:05:36.857
> 
> 标签：javascript, ui-automation, typescript

我想知道是否有人尝试过使用 Typescript 实现[iOS](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Reference/UIAutomationRef/_index.html) UIAutomation 测试。

我想我需要制作自己的声明文件并根据需要添加它们，但是有一件事我无法弄清楚。其他javascript文件需要使用`#import`求源语句导入。像这样的东西：

```
#import "File.js"

var target = UIATarget.localTarget();
var app = target.frontMostApp();
var window = app.mainWindow();
target.logElementTree();
... 
```

如何在 Typescript 中处理这种语法？我想告诉编译器不要处理只是将其复制到结果 js 中，但我在[规范](http://www.typescriptlang.org/Content/TypeScript%20Language%20Specification.pdf)`#import "File.js`中找不到任何编译器指令或类似指令。这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:02:33.567

我也没有在文档中找到此功能。我认为没有办法做到这一点。

您可以在请求此方法的 codeplex 上打开一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T18:18:53.273

不幸的是，目前在 Typescript 中没有办法做到这一点。[在codeplex](http://typescript.codeplex.com/workitem/264)也有一个问题。在 Microsoft 出现并添加指令之前，您必须手动完成。

# iphone - 如何在 Xcode 中构建上滑菜单

> ID：12916484
> 
> 赞同：1
> 
> 时间：2012-10-16T14:05:38.060
> 
> 标签：iphone, xcode, ios5, user-interface

我是 Xcode 开发的新手，我想在我的 iPhone 应用程序中开发一个`slide-up menu`触发。`UIToolbar`

我正在查看的是创建一个带有菜单按钮的子视图，将其添加到主视图中，并在`toggle`点击按钮时向上（可见）或向下（隐藏）滑动。

我如何以编程方式执行此操作？！iPhone的**Opera 应用程序**在这方面做得很好（见图）。

![歌剧应用](../Images/d94b645424ff56c790c34f863328fbf5.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T14:16:48.937

你所说的可以通过代码来完成，方法是在你的主视图中添加一个子视图并上下滑动它以使其可见和不可见。

1) 将子视图添加到远 y 坐标，使其最初在视图中不可见。

```
subView  =  [[UIView alloc]initWithFrame:CGRectMake(0,470,320,200)]]; // subView is an ivar
// Add stuffs to your subview
[self.view addSubview:subView]; 
```

2) 现在制作两个 IBActions showMySubview 和 hideMySubview 并将它们链接到相应的按钮，或者您可以通过检查其 label.text 来使用一个按钮进行一些切换。

3）在你的 showMySubview

```
 [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:1.5];
        [UIView setAnimationDelay:0.0];
        subView.frame = CGRectMake(0, 50, 320, 200);
        [UIView commitAnimations]; 
```

4）在你的 hideMySubview

```
 [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:1.5];
        [UIView setAnimationDelay:0.0];
        editPopUpView.frame = CGRectMake(0, 470, 320, 200);
        [UIView commitAnimations]; 
```

您还可以对您的子视图做一些美化事情，以使您的项目看起来不错添加**QuartzCore**框架并将其导入到您的 .m 文件中，并在将您的子视图添加到主视图后添加这些行，导入为 **#import "QuartzCore/QuartzCore.h "**

```
[[subView layer] setCornerRadius:12.0f];
[[subView layer] setMasksToBounds:YES];
[[subView layer] setBorderWidth:4.0f];
[subView layer].borderColor =   [UIColor purpleColor].CGColor; 
```

希望这无论如何都会对您有所帮助:)

**编辑 ：**

通过代码将按钮添加到您的子视图：

```
for (int i = 0; i < 3; i++) {

    for (int j = 0; j < 3; j++) {

        UIButton *btn   =   [UIButton buttonWithType:UIButtonTypeCustom];
        btn.frame       =   CGRectMake(j*60,200+ 35 * i ,50 , 30);
        //[btn setTitle:@"Test" forState:UIControlStateNormal];
        [btn setBackgroundImage:[UIImage imageNamed:@"normal.png"] forState:UIControlStateNormal];
        [btn setBackgroundImage:[UIImage imageNamed:@"selected.png"] forState:UIControlStateHighlighted];
        btn.tag =   (j + 1) + (3 * i);
        [btn addTarget:self action:@selector(subViewButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
        btn.showsTouchWhenHighlighted   =   YES;
        [subView addSubview:btn]; // its the subview we added to our main view add this after initializing the subview

    }
} 
```

现在是一个捕捉所有按钮点击的功能

```
-(IBAction)subViewButtonClicked:(id)sender
{
    switch ([sender tag]) {
    case 1:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }

    case 2:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }
    case 3:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }
    case 4:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }
    case 5:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }

    case 6:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }
    case 7:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }
    case 8:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }

    case 9:
    {
        // Do your stuff here

         NSLog(@"the tag of sender is %i",[sender tag]);

        break;
    }
    default:
        break;
}

} 
```

可能有很多简单的方法，但希望这能让你开始:)

# r - 递归调用函数中的变量范围

> ID：12916487
> 
> 赞同：2
> 
> 时间：2012-10-16T14:05:46.697
> 
> 标签：r

我知道变量对于 R 中的函数是本地的，但是如果我从自身递归调用函数会发生什么？函数内部的赋值会被函数的后续调用覆盖吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:13:16.220

在典型的编程语言中，在函数中创建的变量是该函数的本地变量。就在该函数中创建和容纳的变量而言，调用自身的函数类似于调用另一个函数的函数。一旦该函数返回变量，它们在内存中的关联就会丢失；除非您使用指针、引用、返回变量等，否则您将无法检索此信息，无论它是否是递归函数。

我不确定 R 的具体情况，但我会简单地创建一个简单的测试来查看。

# c++ - 如何在子进程中禁用断言错误对话框

> ID：12916489
> 
> 赞同：0
> 
> 时间：2012-10-16T14:05:56.660
> 
> 标签：c++, visual-studio, debugging, winapi, assert

我在 MSVC++ 2010 中使用 CreateProcess 函数创建子进程，在此之前使用 SetErrorMode(SEM_FAILCRITICALERRORS | SEM_NOGPFAULTERRORBOX); 设置错误级别；

任务是运行控制台程序并隐藏任何烦人的消息，如著名的“不要发送”对话框，防止程序在严重错误后正常完成。

所以，如果我创建包含一些错误的子进程（例如除以 0）它工作正常，但是当我创建带有矢量索引溢出的子进程时，它会导致不可避免的断言错误消息（当然在调试模式下）。这是这个程序的代码：

```
#include <stdlib.h>
#include <vector>

int main(int argc, char *argv[])
{
    int index = atoi(argv[1]);
    switch(index)
    {
    case 0:
    {
        int k = 3, j = 3;
        j -= k;
        k = k/j;//division by zero
    }
    case 1:
    {
        std::vector<int> k(2);
        int i = k.at(2);//index is out of bounds and it causes assert failure
    }
    }
} 
```

在发布配置中它工作正常，但在调试中 - 它会导致断言错误对话框。当然，我可以将[_set_abort_behavior](http://msdn.microsoft.com/en-us/library/e631wekh.aspx)添加到子程序代码中，但这不是我的选择。

对于在 Debug 配置中编译的程序，有没有办法超越这个断言错误对话框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:27:56.617

一种通用的方法是将进程作为被调试者启动，或者创建一个始终忽略未处理异常的简单调试器。甚至可能已经有一个现有的调试器可以做到这一点，我只是不知道有一个。

关于这种方法的几个好处：

1.  包含所有这些行为很容易；它不会对调用者施加太多影响
2.  它使您有机会自己记录未处理的异常信息，例如自动和静默保存小型转储。
3.  我相信这些断言对话框窗口只在应用程序没有被调试时出现。这意味着调试器方法也是专门处理这些问题的一种方法。我相信如果你只是恢复被调试者，它可能会弹出对话框。我不确定你会如何处理它；这只是正常的程序继续。也许您可以在调试中断时调整寄存器以绕过它。

但是，当您需要为整个子流程树执行此操作时，或者如果您想让任何应用程序“静默”且没有消息框或用户输入时，它会变得更加棘手。

请注意，这些调试断言对话框窗口通常仅在调试版本中启用。对于生产，它们根本不应该出现。

# objective-c - 将 Objective-C 对象作为 void * 指针传递给函数

> ID：12916491
> 
> 赞同：14
> 
> 时间：2012-10-16T14:06:17.003
> 
> 标签：objective-c, pointers, casting, callback

我有一个功能：

```
 myFunction (MyProc callback, void * ref) 
```

这个函数是从一个 Objective-C 类中调用的。该函数被传递一个指向回调（类中的函数）的指针和一个引用。引用是必要的，因为回调是静态调用的，因此没有上下文。ref 可用于为回调提供上下文。

我希望能够通过 Objective-C 类作为参考。所以问题是：

如何将 NSObject 转换为 void * 以及如何将 void * 转换为 NSObject。

提前致谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-16T16:36:36.953

做这样的事情：

```
void func(void *q)
{
    NSObject* o = CFBridgingRelease(q);
    NSLog(@"%@", o);
}

int main(int argc, const char * argv[])
{
    @autoreleasepool {
        NSObject* o = [NSObject new];
        func((void*)CFBridgingRetain(o));
    }
    return 0;
} 
```

请注意`CFBridgingRetain()`和`CFBridgingRelease()`是围绕编译器属性的宏。随意使用。我喜欢 API 变体，因为它在我们的代码库中更常用，而且更明确/更少混淆。

`CFBridgingRetain()`有效地硬保留必须由 a 平衡的对象`CFBridgingRelease()`。`CFTypeRef`它*也*恰好返回与强制转换兼容的 a `void*`。 `CFBridgingRelease()`有效地撤消了硬保留，因此`q`只会在有效范围内保持`o`有效。

`void *context;`对基本回调有效，但对于必须保留一段时间的类型的东西，你可能不会那样做。为了那个原因：

```
void callback(void *context)
{
    // grab an ARC aware reference without impacting hard-retain
    NSObject* o = (__bridge NSObject *)(context);
    NSLog(@"%@", o);
}

void freeContext(void *context)
{
    // release the hard-retain
    CFBridgingRelease(context);
} 
```

请注意，如果您省略了 cast / API 调用，Xcode 非常适合准确地建议您应该做什么。它甚至解释了每个替代解决方案的含义（我非常依赖这个，直到我能把它们牢牢记在心里）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-16T14:23:57.500

我假设您正在使用 ARC。你可以在调用时使用这样的东西`myFunction`

```
id ref = ...; // your Objective-C object
myFunction(callback, (__bridge_retained void *) ref); 
```

在您的回调中，您必须将所有权转回：

```
void callback(void* refPtr) {
    id refObj = (__bridge_transfer id) refPtr;
} 
```

根据需要替换`id`为您的对象类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:09:22.933

答：没有办法。`void *`隐式兼容任何指针类型，所以如果你有一个对象，它是一个类型的指针`id`（别名为`struct objc_object *`），你可以简单地将它传递到需要 void 指针的地方，而不需要强制转换。例子：

```
// this is the declaration of the callback function:
void callback(void *context);

// then you can call it like this:
SomeClass *obj = [[SomeClass alloc] init];
callback(obj); 
```

# javascript - 如何在 onclick 事件时发送标签的值

> ID：12916492
> 
> 赞同：0
> 
> 时间：2012-10-16T14:06:17.187
> 
> 标签：javascript, jquery, html, ajax

我正在尝试在单击此锚标记时发送标签的值。谁能建议我传递标签值的最佳方法是什么（标签值动态变化，因此希望在单击锚时将该值传递给 java脚本函数。）

示例代码：

```
<a class="k-link" onclick="Getvalue("$("#ID").html()">Profile</a> 
```

2

```
function Getvalue(Id) {
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:09:21.200

不完全确定您要在这里获得什么，但这是否有效（在您的 onclick 中）？

```
$(this).html(); 
```

或者

```
$(this).text(); 
```

或者更好的是，正如追逐建议的那样，使用 jquery 来连接您的事件，以便您可以将其与 html 分开：

```
$(".k-link").click(function() {
    var label = $(this).text();
    // Do something with the label...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:09:21.630

使用[.text()](http://api.jquery.com/text/)而不是[.html()](http://api.jquery.com/html/)：

**jQuery**

```
$("a").on("click", function(){
   alert($(this).text());
})​ 
```

**[例子](http://jsfiddle.net/tAruv/)**

因为我们是通过 jQuery 绑定 click 事件，所以不需要内联。然后您的 HTML 变为：

```
<a class="k-link">Profile</a> 
```

> 与 .html() 方法不同，.text() 可用于 XML 和 HTML 文档。.text() 方法的结果是一个字符串，其中包含所有匹配元素的组合文本。（由于不同浏览器中 HTML 解析器的差异，返回的文本在换行符和其他空白处可能会有所不同。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:09:47.310

这不是一个真正的标签，也不是一个有价值的元素，它是一个常规的锚点，如果你想要的是它包含的文本，你可以这样做：

```
$('a.k-link').on('click', function(e) {
    e.preventDefault();
    var txt = $(this).text(); //gets text
    var id = this.id; //gets ID, if you need it ?
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-08T03:02:55.950

```
<label id="lbltest">10</label>
<button type="button" onclick='addToCart(lbltest.innerHTML)'>+</button> 
```

工作对我有好处。

# c# - 如何用数组_c#Linq的最后一个索引替换我的第二个和第三个数组索引？

> ID：12916501
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:06:49.227
> 
> 标签：c#, linq

其实我有一个像

```
oldList= ['First','Second','Third',.....'Seventh']; 
```

newArray 应该是这样的

```
newArray=['First',.........'Seventh','Second','Third'] 
```

那么如何使用 linq c# 提供这样的排序？

我的意思是我的第一个元素应该保留在旧的地方。但我必须跳过第二个和第三个元素到列表末尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:21:20.080

如果你的收藏已经是一个列表，你可以跳过第一行

```
List<string> oldList2 = new List<string>(oldList);
var tmp = oldList2.GetRange(1, 2);
oldList2.RemoveRange(1, 2);
oldList2.AddRange(tmp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:15:44.703

奇怪的要求，但`OrderBy`即使在这种情况下你也可以使用：

```
var newArray = oldList.Select((t, index) => new { t, index })
                      .OrderBy(x => x.index == 1 || x.index == 2)
                      .ThenBy(x => x.index)
                      .Select(x => x.t)
                      .ToArray(); 
```

这是一个演示：http: [//ideone.com/qJOlv](http://ideone.com/qJOlv)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:16:55.933

是的，您*可以*在 LINQ 中执行此操作，尽管它可能不是最有效的：

```
var newArray = oldList.Take(1)
    .Concat(oldList.Skip(3).Take(4))
    .Concat(oldList.Skip(1).Take(2))
    .ToArray(); 
```

但是，如果您的原始容器是 a `List<T>`，您可以更有效地做一些事情：

```
var newList = oldList.GetRange(0, 1)
    .Concat(oldList.GetRange(3, 4))
    .Concat(oldList.GetRange(1, 2))
    .ToList(); 
```

**更新**：

对于踢腿和笑容，我继续为几种建议的方法计时，看起来@LB's`Get/Add/RemoveRange()`排在首位：

超过 100,000 次迭代：

*   Skip() / Take() 耗时 82 毫秒（0.00082 毫秒 / 调用）
*   GetRange() / Concat() 耗时 69 毫秒（0.00069 毫秒 / 调用）
*   OrderBy() / ThenBy() 耗时 145 毫秒（0.00145 毫秒 / 调用）
*   Add/Get/RemoveRange() 耗时 21 毫秒（0.00021 毫秒/调用）

当然，我们在这里进行微优化，所以我会说选择对您最有意义且最可维护的那个。但看起来 LB 的解决方案是性能最高的（并且也易于阅读）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:31:53.287

LINQ 旨在查询数据源以产生新结果，而不是改变现有数据。

我用来解决这个问题的一般方法：

```
var second = array[1];
var third = array[2];

for(int i = 3; i < array.Length; i++)
{
    array[i-2] = array[i];
}

array[array.Length-2] = second;
array[array.Length-1] = third; 
```

如果你真的，真的需要使用 LINQ，我会做这样的事情：

```
var newArray = array.Take(1)
          .Concat(array.Skip(3))
          .Concat(array.Skip(1).Take(2))
          .ToArray(); 
```

请注意，这种方法对数据源进行了 3 次迭代；如果它实际上是一个数组或列表，那很好，但如果实际上它只是`IEnumerable<T>`一些查询或复杂操作的结果，那将是不好的。

# c++ - 获取当前工作目录的相对路径，而不是绝对路径

> ID：12916502
> 
> 赞同：0
> 
> 时间：2012-10-16T14:06:52.103
> 
> 标签：c++, c, linux

我有一个目录路径，其中有第二个挂载的 fs 作为完整路径的一部分。

如果我使用`getcwd`它返回第二个挂载文件系统的绝对路径，而不是所有应用程序配置所需的相对路径。

当我查看`pwd`代码时，它显示了`xgetcwd`哪些调用`getcwd`。目前尚不清楚如何：

1.  `pwd`能够使用返回相对路径`getcwd`
2.  如果有提供相对而非绝对路径的选项或命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:13:17.047

首先使用以下方法获取绝对路径：

```
char abspath[256] = "";
getcwd(abspath, 256); 
```

然后使用以下方法获取相对路径：

```
strrchr(abspath, '/'); 
```

# javascript - 父子表单和传递值

> ID：12916503
> 
> 赞同：0
> 
> 时间：2012-10-16T14:06:54.723
> 
> 标签：javascript, asp-classic, parent-child

我有以下作为父母和孩子

家长（仅发布脚本和表单标签）

```
<script type='text/javascript'>
window.onload = function () {
    document.getElementById('NewTicket').onsubmit = sendToChild;
    document.getElementById('sName').onclick = openChild;
}
function openChild() {
    this.disabled = true;
    xWinOpen('SecList.asp');
    this.disabled = false;
}
function sendToChild() {
    if (xChildWindow) {
        var pta = document.getElementById('sName');
        var cta = xChildWindow.document.getElementById('sName');
        cta.value = pta.value;
        xChildWindow.focus();
    }
    return false;
}
var xChildWindow = null;
function xWinOpen(sUrl) {
    // Modify 'features' to suit your needs:
    var features = "left=100,top=100,width=400,height=400,location=0,menubar=0," +
    "resizable=1,scrollbars=1,status=0,toolbar=0";
    if (xChildWindow && !xChildWindow.closed) { xChildWindow.location.href = sUrl; }
    else { xChildWindow = window.open(sUrl, "myWinName", features); }
    xChildWindow.focus();
    return false;
}</script><form name="NewTicket" target="_self" method="POST" action=""><input name="sName" type="text" value="ABC" id="sName"></form> 
```

Child 看起来像这样（再次只有脚本和 tbody 部分）。

```
<script type='text/javascript'>
    function sendToParent(myStr)
    {
          alert(myStr)
          var myStrSplit = myStr.split("/")
          opener.document.NewTicket.sID.value = myStrSplit[0]
          opener.document.NewTicket.sName.value = myStrSplit[1]
          document.write(myStrSplit[0])
          document.write(myStrSplit[1])
          self.close();
    }
    </script>
<tbody>
            <%Do While Not oRS.EOF
              sVal = oRS("sID") & "/" & oRS("SecDet")%>
            <tr> 
                <td><%=oRS("sID")%></td>
                <td><a href="#" onclick="sendToParent(" & <%=sVal%> & ")"><%=oRS("SecurityName")%></a></td>
                <td><%=oRS("BBG_Ticker")%></td>
                <td><%=oRS("ISIN_Code")%></td>
                <td><%=oRS("Country")%></td>
                <td><%=oRS("Curr")%></td>
            </tr>
            <%oRS.MoveNext
        Loop%>
        </tbody> 
```

在子 oRs("SecDet") 中是 5 个与“/”连接的字段，我在函数中进行拆分。

我想做什么？正如您在子表单中看到的那样，将有一个表格，我希望当用户单击任何行时，该行上的所有相应 6 个字段都应填充到父级的 6 个文本字段中。

我无法实现什么？似乎 sendToParent() 根本不起作用。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:39:02.843

下面的代码终于奏效了......

家长

```
<script>
function openwindow()
{
window.open("SecList.asp","_blank","height=200,width=400,status=yes,toolbar=no,menubar=no,location=no")
}
</script> 
```

和孩子（有更正）也由 Flakes 建议

```
<script type='text/javascript'>
function sendToParent(myStr)
{
      alert(myStr)
      var myStrSplit = myStr.split("/")
      opener.document.NewTicket.sID.value = myStrSplit[0]
      opener.document.NewTicket.sName.value = myStrSplit[1]
      document.write(myStrSplit[0])
      document.write(myStrSplit[1])
      self.close();
}
</script>
<tbody>
            <%Do While Not oRS.EOF
              sVal = oRS("sID") & "/" & oRS("SecDet")%>
            <tr id="<%="sID" & oRS("sID")%>"> 
                <td><%=oRS("sID")%></td>
                <td><a href="#" onclick="sendToParent('<%=sVal%>')"><%=oRS("SecurityName")%></a></td>
                <td><%=oRS("BBG_Ticker")%></td>
                <td><%=oRS("ISIN_Code")%></td>
                <td><%=oRS("MarketName")%></td>
                <td><%=oRS("Curr")%></td>
            </tr>
            <%oRS.MoveNext
        Loop%>
        </tbody> 
```

# watir - 我无法使用 Watir 选择链接元素

> ID：12916509
> 
> 赞同：4
> 
> 时间：2012-10-16T14:07:12.290
> 
> 标签：watir

这是我正在使用的 Watir 代码：

```
require 'watir-classic'
browser = Watir::IE.new
browser.link(:class, "Wizardbutton").exists? 
```

这是包含我要检查是否存在的链接的页面 HTML 的一部分。

```
<tr>
    <td align="left" style="vertical-align: top;">
        <a class="Wizardbutton"href="javascript:parent.showPopup('/web/wizard.html');window.focus();">
            <span>Add new Team</span>
        </a>
    </td>
</tr> 
```

我得到的错误是：

```
Watir::Exception::UnknownObjectException: Unable to locate element, using {:tag_name=>["a"], :class=>"Wizardbutton"} 
```

为什么我在 HTML 源代码中可以清楚地看到链接元素不存在的错误？我已经成功点击了页面上的其他链接，但由于某种原因我看不到这个。嵌入的跨度标签是否搞砸了？我也尝试使用 href 进行选择，但也没有用。任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T18:08:41.463

OK，谜团解开了。与 Watir 合作时，iframe 是一个主要问题。除非您专门选择 iframe，然后选择 iframe 中的项目，否则属于 iframe 的元素不可见。所以例如代码

```
browser.frame(:name, "nameOfFrame").link(:class, "Wizardbutton") 
```

意味着给我一个名称属性为“nameOfFrame”的 iframe，然后选择类属性为“Wizardbutton”的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-17T06:21:08.297

我也面临同样的错误。有时，如果浏览器控件存在于 div 或 tables 标签中，则无法找到它。在您的情况下，链接控件放置在表格内。请试试这个

```
browser.table(:class=> "classname").link(:class => "Wizardbutton") 
```

希望对你有帮助

# symfony - Symfony2：使用两个不同的用户提供程序登录网站时无法模拟用户

> ID：12916510
> 
> 赞同：1
> 
> 时间：2012-10-16T14:07:18.137
> 
> 标签：symfony, impersonation, fosfacebookbundle

在我的网站中，用户可以使用简单帐户（在我的网站中创建，配置 MY_OWN_USER 提供程序，通过电子邮件选择用户）或使用 facebook 登录（通过 fosfacebook 捆绑包集成）登录。

当我试图模拟用户时（附加链接'...？_switch_user=demo@demo.com'，如[Symfony2 文档](http://symfony.com/doc/current/book/security.html#impersonating-a-user)中所述）Symfony2 记录这样的警告：

**security.WARNING：切换用户失败：“用户未在 facebook 上进行身份验证”**

我已经检查了**Symfony\Component\Security\Http\Firewall\SwitchUserListener**并且看起来默认情况下它不是 MY_OWN_USER 提供程序，而是 fosfacebook 提供程序，它试图通过 facebook_id 选择用户（如果我附加带有 '...?_switch_user=FACEBOOK_ID' 的链接- 切换用户正常工作！）

那么如何让 SwitchUserListener 获得 MY_OWN_USER 提供者，它通过电子邮件而不是 facebook id 选择用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-08T08:26:32.990

在您的防火墙配置中配置模拟时`security.yml`，您可以指定应使用哪个提供程序来查找被模拟的用户（[参考](http://symfony.com/doc/current/reference/configuration/security.html)）。例如：

```
switch_user:
    provider: MY_OWN_USER 
```

希望这可以帮助！

# erlang - 如何计算 gproc 注册的进程？

> ID：12916516
> 
> 赞同：0
> 
> 时间：2012-10-16T14:07:47.390
> 
> 标签：erlang

我有一堆由 gproc 注册的进程，我想随时计算这些进程。当然，如果每个过程都运行良好，那将不是问题。每次启动或停止进程时，我都可以使用计数器递增和递减它们。

但问题是，流程并不总是表现良好。有时他们只是因为一些不明显的原因而死。设计上没问题，但我仍然想知道仍在运行的进程的确切数量。

有没有一种很好的方法来计算刚刚处于活动状态的进程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:23:35.443

如果您在 gproc 中注册的进程受到监督，您可以`count_children`从[supervisor](http://www.erlang.org/doc/man/supervisor.html#count_children-1)使用。例如，您可以在 a 中使用 gproc 注册一个新进程`init`并`gen_server`取消注册它的`terminate`. 您将同时获得 gproc 和监督的好处。

如果您不使用监督，您可以使用 gproc 计数器（或 aggregate_counter？，请参阅 gproc api）。

# java - Java中的数据导航框架

> ID：12916521
> 
> 赞同：0
> 
> 时间：2012-10-16T14:07:58.547
> 
> 标签：java, data-structures

假设我有一些这样的数据结构：

```
people 0  name       Bob
          surname    Smith
          nicknames  0 bs
                     1 bobby 
       1  name       John
          surname    Lee
          nicknames  0 jaylee
                     1 TheJhon 
```

我不是太正式，但想象一下，事情可以是`List`，`HashMap`或类似的数据结构。我想做诸如“检索具有 nick=bs 的所有记录的名称、姓氏和昵称列表”之类的事情。假设我也有一个类似的结构

```
groups 0  name           Golf club
          member_nicks   0 bs
                         1 bobby
       1  name           Poker association
          member_nicks   0 bobby
                         1 someonelse 
```

我想获得诸如“李姓人参加哪些团体？”之类的信息。有没有图书馆允许做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:10:06.223

你考虑过[JXPath](http://commons.apache.org/jxpath/)吗？它是 JavaBeans 的 XPath，因此允许您对 POJO 的层次结构执行查询。

这是我很久以前写的关于如何使用它[的 Javaworld 的一篇文章。](http://today.java.net/pub/a/today/2006/08/03/java-object-querying-using-jxpath.html)

# vb.net - VB.NET 3dline 用户控件，左右锚定到父级

> ID：12916524
> 
> 赞同：0
> 
> 时间：2012-10-16T14:08:06.890
> 
> 标签：vb.net

我正在尝试制作一个用户控件，它是位于“确定”和“取消”按钮上方的 3D 线，有时会在 Thunderbird 窗口中看到：

[http://s11.postimage.org/gh45ux9wj/thunderbird1.png](http://s11.postimage.org/gh45ux9wj/thunderbird1.png)

我不想每次将用户控件放在表单上时都必须手动设置锚属性，这就是为什么我想在用户控件中使其自动停靠到父级（左=0，宽度=父级）。宽度）。

但是，我并没有真正做到这一点。

我的尝试很多，所以我不确定我应该在这里发布什么。

我的假设是我应该使用

```
Private Sub UserControl1_ParentChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.ParentChanged

    Me.SetBounds(0, Me.Top, Me.Parent.Width, 0, BoundsSpecified.X Or BoundsSpecified.Y Or BoundsSpecified.Width)

End Sub 
```

但这根本行不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:32:25.607

您需要为父`Resize`事件添加一个事件处理程序，以便每次父的大小更改时都会通知您。例如，这样的事情会起作用：

```
Public Class ThreeDLine
    Private _lastParent As Control

    Private Sub Parent_Resize(ByVal sender As Object, ByVal e As EventArgs)
        resizeToParentWidth()
    End Sub

    Private Sub Divider_ParentChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.ParentChanged
        If _lastParent IsNot Nothing Then
            RemoveHandler _lastParent.Resize, AddressOf Parent_Resize
        End If
        _lastParent = Parent
        If Parent IsNot Nothing Then
            AddHandler Parent.Resize, AddressOf Parent_Resize
            resizeToParentWidth()
        End If
    End Sub

    Private Sub resizeToParentWidth()
        If Parent IsNot Nothing Then
            Me.Left = 0
            Me.Width = Parent.ClientSize.Width
        End If
    End Sub
End Class 
```

# java - URLConnection 有哪些可用的 setRequestProperty

> ID：12916528
> 
> 赞同：0
> 
> 时间：2012-10-16T14:08:17.020
> 
> 标签：java, android, http

我正在开发一个 Android 应用程序来调查 URLConnection 的使用并以 JSON 格式获取数据。

我找到了很多很好的资源和如何编码的例子

我在哪里可以找到所有有效 RequestProperty 的完整列表？如这里所示？

```
 urlconn.setRequestProperty("Content-Type", "text/xml");
urlconn.setRequestProperty("Content-Length", String.valueOf(params.getBytes().length));
urlconn.setRequestProperty("Content-Language", "en-US"); 
```

我错过了什么？

作为一个补充问题（如果我可以的话），URLConnection 是否具有“强制”POST 和 GET 退出的机制？如果是这样，你如何设置这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:18:44.470

先说第二个问题。您可能希望将`timeout`连接设置为：

```
 urlconn.setConnectTimeout(10000);
  urlconn.setReadTimeout(10000); 
```

回到问题 1，从技术上讲，您可以设置任何您想要的属性。**如果属性列表中不存在该属性，则只需在列表中添加具有指定值的新属性。**

如果您指的是连接，您可以根据属性设置标题`http`支持的任何属性。`html``usage/need`

# jquery - jQuery XML 解析器两次打印变量

> ID：12916532
> 
> 赞同：0
> 
> 时间：2012-10-16T14:08:29.763
> 
> 标签：jquery, xml, cordova

我使用以下代码在我的 Phonegap Android 应用程序中使用 jQuery 解析 XML 文件：

```
 $( function() {
        var XMLURI = 'http://gdata.youtube.com/feeds/api/users/remcob00/uploads?max-results=50&alt=rss&lr=nl&orderby=published';
        $.ajax({
            url: XMLURI,
            success: function(xml){
                setTimeout(
                function(){
                        feedItem = '';

                    $(xml).find( "item" ).each(
                        function(){
                            var item = $(this), 
                                title =  item.find('title').text(),
                                link =  item.find('link').text(),
                                description =  item.find('description').text(),
                                pubDate =  item.find('pubDate').text();

                            var idname = "v";
                            idname = idname.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
                            var regexS = "[\\?&]"+idname+"=([^&#]*)";
                            var regex = new RegExp( regexS );
                            var results = regex.exec(link);
                            var videoid = results[1];

                            feedItem = feedItem + '<li data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="div" data-icon="arrow-r" data-iconpos="right" data-theme="a" class="ui-btn ui-btn-icon-right ui-li-has-arrow ui-li ui-li-has-thumb ui-btn-up-a"><div class="ui-btn-inner ui-li"><div class="ui-btn-text">';
                            feedItem = feedItem + '<a href="video.html?v=' + videoid + '&title=' + encodeURIComponent(item.find('title').text()) + '&description=' + encodeURIComponent(description) + '" rel="external" class="ui-link-inherit">';
                            feedItem = feedItem + '<img src="http://img.youtube.com/vi/' + videoid + '/0.jpg" class="ui-li-thumb">';
                            feedItem = feedItem + '<h3 class="ui-li-heading">' + title+ '</h3>';
                            feedItem = feedItem + '</a></div><span class="ui-icon ui-icon-arrow-r ui-icon-shadow">&nbsp;</span></div></li>';
                    });
                    $('#list').append(feedItem);

                }
                , 5000);
            },
            error: function(){
                // $('#blogheader').html('<li>Kan video's niet laden, mogelijk heb je geen internet verbinding</li>');
            },
            dataType: "xml"
        });
    }); 
```

此代码将项目的标题和描述打印两次而不是一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T16:17:16.380

我发现这是 YouTube 提要中的一个问题，如果我使用 json 提要没有问题。

# jquery-ui - jQuery UI Autocomplete onSelect 重写

> ID：12916534
> 
> 赞同：2
> 
> 时间：2012-10-16T14:08:33.103
> 
> 标签：jquery-ui, jquery, jquery-ui-autocomplete

我有一个要附加自动完成功能的文本框。当您开始输入时...它会在数据库中查找并返回/缩小适当的内容。当用户从返回的列表中选择时...返回图像和其他一些信息并将其放置在页面中。效果很好。见下文：

```
jQuery(function ($) {
var a = $('#artistName').autocomplete({ 
    serviceUrl: '/link/to/processor.ashx?action=artist',
    minChars:1, 
    maxHeight:400,
    width:300,
    zIndex: 9999,
    deferRequestBy: 0, 

    // callback function:
    onSelect: function(value, data){ 
        if (data) {
            var artistData = data.split('|');
            var src = '<%= ImageServer %>' + '/path/to/image/' + value + '.jpg';
            $("#artistPhoto").attr('src', src);
            $('#artistExt').remove();

            if (artistData[1] !== undefined && artistData[1] != 0) {
                $("#artistSection").append('<div id="artistExt"><span>Contact me @</span> 1-888-123-4567 Ext: ' + artistData[1] + '</div>');
            }
        }
    }
});    
}); 
```

如果用户没有从列表中选择，我想要做的是提供相同的功能（例如......用户可以开始输入像“Bill”这样的名称并且自动完成将返回“Bill”......但是如果用户没有从返回的结果列表中选择“Bill”，而只是键入名称......显然不会发生任何事情，因为事件在 onSelect 函数上）。

有人可以帮我弄清楚如何以一种触发事件 onSelect、onChange、onLoad、onKeyUp、on[enter] 等的方式编写它...只要有匹配项？只寻找价值/长度会更好吗？还有一种情况可能会发生，用户进入页面，文本框被预填充。在这种情况下，我想要与 onSelect 函数相同的显示更改。

任何帮助将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:14:28.560

这有点骇人听闻，但它确实有效。

在设置自动完成之前，添加一个变量：

```
var firstitem = null; 
```

使用此代码为您的自动完成添加一个`open`选项。

```
open : function (event, ui) {
  firstitem = j$(j$("#SelectProject").data("autocomplete").menu.element.children().first()[0].innerHTML).html();
} 
```

定义自动完成后，将模糊事件绑定到自动完成输入。

```
.bind("blur", function () { j$(this).val(firstitem); } ); 
```

最终结果应如下所示：

```
jQuery(function ($) {

  var firstitem = null;
  var a = $('#artistName').autocomplete({
      serviceUrl : '/link/to/processor.ashx?action=artist',
      minChars : 1,
      maxHeight : 400,
      width : 300,
      zIndex : 9999,
      deferRequestBy : 0,

      // callback function:
      onSelect : function (value, data) {
        if (data) {
          var artistData = data.split('|');
          var src = '<%= ImageServer %>' + '/path/to/image/' + value + '.jpg';
          $("#artistPhoto").attr('src', src);
          $('#artistExt').remove();

          if (artistData[1] !== undefined && artistData[1] != 0) {
            $("#artistSection").append('<div id="artistExt"><span>Contact me @</span> 1-888-123-4567 Ext: ' + artistData[1] + '</div>');
          }
        }
      },

      open : function (event, ui) {
        firstitem = j$(j$("#SelectProject").data("autocomplete").menu.element.children().first()[0].innerHTML).html();
      }
    }).bind("blur", function () { j$(this).val(firstitem); } );

}); 
```

此外，请参阅[selectFirst](https://github.com/scottgonzalez/jquery-ui-extensions/blob/master/autocomplete/jquery.ui.autocomplete.selectFirst.js)插件、[autoFocus 选项](http://api.jqueryui.com/autocomplete/#option-autoFocus)和[打开事件文档](http://api.jqueryui.com/autocomplete/#event-open)以获取更多信息。

# java - ArrayList.toArray() 抛出 NullPointerException

> ID：12916536
> 
> 赞同：2
> 
> 时间：2012-10-16T14:08:34.813
> 
> 标签：java, exception, arraylist, nullpointerexception

我在主类中声明了两个 ArrayList。一个是例程对象的 ArrayList，另一个是例程名称的字符串数组。每次构造例程时，该例程名称以及存储在例程中的都存储在 Names 数组列表中。

```
 static ArrayList <Routine> routineArrayList = new ArrayList <Routine> ();
    static ArrayList <String> Names = new ArrayList <String> (); 
```

我创建了一个 JList 并使用 String Names arrayList 来填充它..

```
 list = new JList(Names.toArray()); 
```

一切顺利，我可以选择一个名称并选择相应的 Routine。

问题是每个例程都有自己的名称数组列表。

我希望能够使用选定的例程并使用该例程内的名称填充 JList。这就是我正在尝试的..

```
 currentRoutine = routineArrayList.get(intChoice);
    ...
    list = new JList(currentRoutine.Names.toArray());  ******** PROBLEM LINE 
```

`System.out.println(currentRoutine.Names.toArray())`给出完全相同的`NullPointerException`.

它已经困扰了我一段时间，如果需要更多信息，我将竭诚为您提供任何帮助，我将尽力提供。

编辑

感谢您的回答，事实证明，主要问题是每个 Routine 对象内的名称数组未正确初始化。但是，问题仍然存在。

```
'System.out.println("Choice: " + currentRoutine.names.get(0)); // Or get(x) 
```

和

```
'System.out.println("Choice: " + currentRoutine.names.toString() 
```

两者都给出了他们应该做的。完整的名称数组或元素注意：'System.out.println("Choice: " + currentRoutine.names.toArray() 提供地址详细信息等。

但是，当我尝试

```
'list = new JList(currentRoutine.names.toArray());' 
```

我得到相同的 NullPointerException？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:12:40.040

该方法`ArrayList<String>.toArray()`不应该抛出 a `NullPointerException`，所以这里的问题几乎可以肯定是`currentRoutine`or 或`currentRoutine.Names`is `null`。您需要检查您填充的代码`routineArrayList`，确保其所有元素都是非空的并且具有非空`Names`字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:21:28.260

**建议**：遵循字段的命名约定，`static` `ArrayList <String> names`而不是`static ArrayList <String> Names`

ruakh 在他的回答中提到，这似乎`currentRoutine`或无效。`currentRoutine.Names`

所以对可空性做一个小的检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T13:59:27.210

谢谢你们的帮助，

我把它整理好了，这确实与布局不佳的 Frames 和 JLists 有关。我最终在我的第一个 JList 以及一个新的 JFrame 的 selectionListener 中声明了一个新的“名称”JList (Routine.names)。

干杯，

马修

# php - 使用 Twitter API 1.1 版检索 user_timeline 的最简单 PHP 示例

> ID：12916539
> 
> 赞同：301
> 
> 时间：2012-10-16T14:08:41.217
> 
> 标签：php, twitter

由于 Twitter API 1.0[于 2013 年 6 月 11 日停用](https://dev.twitter.com/blog/api-v1-retirement-date-extended-to-june-11)，下面的脚本不再工作。

```
// Create curl resource 
$ch = curl_init(); 
// Set url 
curl_setopt($ch, CURLOPT_URL, "http://twitter.com/statuses/user_timeline/myscreenname.json?count=10"); 
// Return the transfer as a string 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
// $output contains the output string 
$output = curl_exec($ch); 
// Close curl resource to free up system resources 
curl_close($ch);

if ($output) 
{
    $tweets = json_decode($output,true);

    foreach ($tweets as $tweet)
    {
        print_r($tweet);
    }
} 
```

如何以尽可能少的代码获取 user_timeline（最近状态）？

我发现了这个：[https](https://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline) ://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline 但我收到以下错误：

```
"{"errors":[{"message":"Could not authenticate you","code":32}]}" 
```

那里有很多类，但在尝试了几个之后，由于 Twitter 上的这些更新，它们似乎都不起作用，而且其中一些是非常高级的类，具有很多我并不真正需要的功能。

使用 PHP 获取最近用户状态的最简单/最短的方法是什么？

* * *

## 回答 #1

> 赞同：832
> 
> 时间：2013-03-09T19:02:11.867

> **重要提示：**截至 2018 年年中，获取 twitter API 令牌的过程变得更加官僚化。我花了**一个多星期**的时间才获得一组 API 令牌，这是一个开源项目，适用于在 Packagist 上安装超过*120 万*和在 Github 上安装超过 1.6k 星的你们，理论上应该是更高的优先级.
> 
> 如果您的任务是使用 twitter API 进行工作，则必须考虑到这个潜在的极长等待时间。还可以考虑其他社交媒体渠道，例如 Facebook 或 Instagram，并提供这些选项，因为检索其代币的过程是即时的。

* * *

# 所以你想使用 Twitter v1.1 API？

*[注意：这些文件在 GitHub 上](https://github.com/J7mbo/twitter-api-php)*。

1.0 版[**将很快被弃用**](https://dev.twitter.com/docs/application-permission-model)，并且不允许未经授权的请求。所以，这里有一篇文章可以帮助你做到这一点，还有一个 PHP 类可以让你的生活更轻松。

> **1\. 创建开发者账号：**在 Twitter 上为自己设置一个[开发者账号](https://dev.twitter.com/)

您需要访问官方 Twitter 开发者网站并注册开发者帐户。这是请求 v1.1 API 的**免费**且必要的步骤。

> **2\. 创建应用程序：**在 Twitter 开发者网站上创建应用程序

什么？您认为您可以提出未经身份验证的请求吗？不适用于 Twitter 的 v1.1 API。您需要访问[http://dev.twitter.com/apps](http://dev.twitter.com/apps)并单击“创建应用程序”按钮。

![在此处输入图像描述](../Images/7c63905b53b728688b134412048f9d44.png)

在此页面上，填写您想要的任何详细信息。对我来说，这并不重要，因为我只是想发出大量阻止请求以摆脱垃圾邮件追随者。关键是您将为自己获取一组用于您的应用程序*的唯一键。*

因此，创建应用程序的目的是为自己（和 Twitter）提供一组密钥。这些都是：

*   消费者钥匙
*   消费者的秘密
*   访问令牌
*   访问令牌秘密

[这里](https://dev.twitter.com/docs/auth/oauth/single-user-with-examples)有一些关于这些令牌用途的信息。

> **3\. 创建访问令牌**：您需要这些令牌才能成功请求

[OAuth](http://en.wikipedia.org/wiki/OAuth)请求一些令牌。因此，您需要为您生成它们。

![在此处输入图像描述](../Images/a7122ff6cd7290955337d3b5e0006feb.png)

点击底部的“创建我的访问令牌”。然后，一旦您再次滚动到底部，您将拥有一些新生成的密钥。您需要从该页面获取四个先前标记的密钥以进行 API 调用，因此请在某处记下它们。

> **4.更改访问级别**：您不想要只读，是吗？

如果您想适当地使用此 API，如果您正在使用[GET](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)请求进行标准数据检索以外的任何操作，则需要将您的设置更改为 Read & Write。

![在此处输入图像描述](../Images/228939a0e56f8342c4137042b843758c.png)

选择页面顶部附近的“设置”选项卡。

![在此处输入图像描述](../Images/fcdc3017d2cfebbf9c11a28ff4c6dc6d.png)

授予您的应用程序读/写访问权限，然后点击底部的“更新”。

您可以在此处[阅读有关](https://dev.twitter.com/docs/application-permission-model)Twitter 使用的应用程序权限模型的更多信息。

* * *

> **5\. 编写访问 API 的代码**：我已经为你完成了大部分工作

我将上面的代码与一些修改和更改组合到一个 PHP 类中，因此发出您需要的请求非常简单。

这使用**OAuth**和**Twitter v1.1 API**以及我创建的类，您可以在下面找到。

```
require_once('TwitterAPIExchange.php');

/** Set access tokens here - see: https://dev.twitter.com/apps/ **/
$settings = array(
    'oauth_access_token' => "YOUR_OAUTH_ACCESS_TOKEN",
    'oauth_access_token_secret' => "YOUR_OAUTH_ACCESS_TOKEN_SECRET",
    'consumer_key' => "YOUR_CONSUMER_KEY",
    'consumer_secret' => "YOUR_CONSUMER_SECRET"
); 
```

确保将您从上面的应用程序中获得的密钥放在各自的空间中。

接下来，您需要选择一个要向其发出请求的 URL。Twitter 有他们的**[API 文档](https://developer.twitter.com/en/docs)**来帮助您选择哪个 URL 以及请求类型（POST 或 GET）。

```
/** URL for REST request, see: https://dev.twitter.com/docs/api/1.1/ **/
$url = 'https://api.twitter.com/1.1/blocks/create.json';
$requestMethod = 'POST'; 
```

在文档中，每个 URL 都说明了您可以传递给它的内容。如果我们使用上面的“blocks” URL，我可以传递以下 POST 参数：

```
/** POST fields required by the URL above. See relevant docs as above **/
$postfields = array(
    'screen_name' => 'usernameToBlock', 
    'skip_status' => '1'
); 
```

现在您已经设置了要使用 API 执行的操作，是时候发出实际请求了。

```
/** Perform the request and echo the response **/
$twitter = new TwitterAPIExchange($settings);
echo $twitter->buildOauth($url, $requestMethod)
             ->setPostfields($postfields)
             ->performRequest(); 
```

对于**[POST](http://en.wikipedia.org/wiki/POST_%28HTTP%29)**请求，就是这样！

对于**GET**请求，它有点不同。这是一个例子：

```
/** Note: Set the GET field BEFORE calling buildOauth(); **/
$url = 'https://api.twitter.com/1.1/followers/ids.json';
$getfield = '?username=J7mbo';
$requestMethod = 'GET';
$twitter = new TwitterAPIExchange($settings);
echo $twitter->setGetfield($getfield)
             ->buildOauth($url, $requestMethod)
             ->performRequest(); 
```

* * *

**最终代码示例**：对于我的关注者列表的简单 GET 请求。

```
$url = 'https://api.twitter.com/1.1/followers/list.json';
$getfield = '?username=J7mbo&skip_status=1';
$requestMethod = 'GET';
$twitter = new TwitterAPIExchange($settings);
echo $twitter->setGetfield($getfield)
             ->buildOauth($url, $requestMethod)
             ->performRequest(); 
```

**[我已将这些文件放在 GitHub 上](https://github.com/J7mbo/twitter-api-php)**，感谢 @lackovic10 和 @rivers！我希望有人觉得它有用；我知道我做到了（我将它用于循环中的批量阻塞）。

> 此外，对于那些在 Windows 上遇到 SSL 证书问题的人，请查看[这篇文章](https://snippets.webaware.com.au/howto/stop-turning-off-curlopt_ssl_verifypeer-and-fix-your-php-config/)。这个库在后台使用 cURL，所以你需要确保你已经设置了你的 cURL 证书。谷歌也是你的朋友。

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2012-10-17T17:26:39.763

[转到 dev.twitter.com 并创建一个应用程序](https://dev.twitter.com/apps/new)。这将为您提供所需的凭据。这是我最近用[PHP](http://en.wikipedia.org/wiki/PHP)和[cURL](http://en.wikipedia.org/wiki/CURL)编写的一个实现。

```
<?php
    function buildBaseString($baseURI, $method, $params) {
        $r = array();
        ksort($params);
        foreach($params as $key=>$value){
            $r[] = "$key=" . rawurlencode($value);
        }
        return $method."&" . rawurlencode($baseURI) . '&' . rawurlencode(implode('&', $r));
    }

    function buildAuthorizationHeader($oauth) {
        $r = 'Authorization: OAuth ';
        $values = array();
        foreach($oauth as $key=>$value)
            $values[] = "$key=\"" . rawurlencode($value) . "\"";
        $r .= implode(', ', $values);
        return $r;
    }

    $url = "https://api.twitter.com/1.1/statuses/user_timeline.json";

    $oauth_access_token = "YOURVALUE";
    $oauth_access_token_secret = "YOURVALUE";
    $consumer_key = "YOURVALUE";
    $consumer_secret = "YOURVALUE";

    $oauth = array( 'oauth_consumer_key' => $consumer_key,
                    'oauth_nonce' => time(),
                    'oauth_signature_method' => 'HMAC-SHA1',
                    'oauth_token' => $oauth_access_token,
                    'oauth_timestamp' => time(),
                    'oauth_version' => '1.0');

    $base_info = buildBaseString($url, 'GET', $oauth);
    $composite_key = rawurlencode($consumer_secret) . '&' . rawurlencode($oauth_access_token_secret);
    $oauth_signature = base64_encode(hash_hmac('sha1', $base_info, $composite_key, true));
    $oauth['oauth_signature'] = $oauth_signature;

    // Make requests
    $header = array(buildAuthorizationHeader($oauth), 'Expect:');
    $options = array( CURLOPT_HTTPHEADER => $header,
                      //CURLOPT_POSTFIELDS => $postfields,
                      CURLOPT_HEADER => false,
                      CURLOPT_URL => $url,
                      CURLOPT_RETURNTRANSFER => true,
                      CURLOPT_SSL_VERIFYPEER => false);

    $feed = curl_init();
    curl_setopt_array($feed, $options);
    $json = curl_exec($feed);
    curl_close($feed);

    $twitter_data = json_decode($json);

//print it out
print_r ($twitter_data);

?> 
```

这可以从命令行运行：

```
$ php <name of PHP script>.php 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2012-12-22T23:18:23.663

Rivers 粘贴的代码很棒。非常感谢！我是新来的，无法发表评论，我只想回答来自 javiervd 的问题（你将如何设置 screen_name 并用这种方法计数？），因为我已经浪费了很多时间来弄清楚它出去。

您需要将参数添加到[URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)和签名创建过程。 *[创建签名](https://dev.twitter.com/docs/auth/creating-signature)*是帮助我的文章。这是我的代码：

```
$oauth = array(
           'screen_name' => 'DwightHoward',
           'count' => 2,
           'oauth_consumer_key' => $consumer_key,
           'oauth_nonce' => time(),
           'oauth_signature_method' => 'HMAC-SHA1',
           'oauth_token' => $oauth_access_token,
           'oauth_timestamp' => time(),
           'oauth_version' => '1.0'
         );

$options = array(
             CURLOPT_HTTPHEADER => $header,
             //CURLOPT_POSTFIELDS => $postfields,
             CURLOPT_HEADER => false,
             CURLOPT_URL => $url . '?screen_name=DwightHoward&count=2',
             CURLOPT_RETURNTRANSFER => true, CURLOPT_SSL_VERIFYPEER => false
           ); 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-04-23T12:52:02.330

就像其他答案中所述，创建一个 Twitter 应用程序来获取令牌、密钥和秘密。使用下面的代码，您可以从一处修改请求参数，避免拼写错误和类似错误（更改函数`$request`中的数组`returnTweet()`）。

```
function buildBaseString($baseURI, $method, $params) {
    $r = array();
    ksort($params);
    foreach($params as $key=>$value){
        $r[] = "$key=" . rawurlencode($value);
    }
    return $method."&" . rawurlencode($baseURI) . '&' . rawurlencode(implode('&', $r));
}

function buildAuthorizationHeader($oauth) {
    $r = 'Authorization: OAuth ';
    $values = array();
    foreach($oauth as $key=>$value)
        $values[] = "$key=\"" . rawurlencode($value) . "\"";
    $r .= implode(', ', $values);
    return $r;
}

function returnTweet(){
    $oauth_access_token         = "x";
    $oauth_access_token_secret  = "x";
    $consumer_key               = "x";
    $consumer_secret            = "x";

    $twitter_timeline           = "user_timeline";  //  mentions_timeline / user_timeline / home_timeline / retweets_of_me

    //  create request
        $request = array(
            'screen_name'       => 'budidino',
            'count'             => '3'
        );

    $oauth = array(
        'oauth_consumer_key'        => $consumer_key,
        'oauth_nonce'               => time(),
        'oauth_signature_method'    => 'HMAC-SHA1',
        'oauth_token'               => $oauth_access_token,
        'oauth_timestamp'           => time(),
        'oauth_version'             => '1.0'
    );

    //  merge request and oauth to one array
        $oauth = array_merge($oauth, $request);

    //  do some magic
        $base_info              = buildBaseString("https://api.twitter.com/1.1/statuses/$twitter_timeline.json", 'GET', $oauth);
        $composite_key          = rawurlencode($consumer_secret) . '&' . rawurlencode($oauth_access_token_secret);
        $oauth_signature            = base64_encode(hash_hmac('sha1', $base_info, $composite_key, true));
        $oauth['oauth_signature']   = $oauth_signature;

    //  make request
        $header = array(buildAuthorizationHeader($oauth), 'Expect:');
        $options = array( CURLOPT_HTTPHEADER => $header,
                          CURLOPT_HEADER => false,
                          CURLOPT_URL => "https://api.twitter.com/1.1/statuses/$twitter_timeline.json?". http_build_query($request),
                          CURLOPT_RETURNTRANSFER => true,
                          CURLOPT_SSL_VERIFYPEER => false);

        $feed = curl_init();
        curl_setopt_array($feed, $options);
        $json = curl_exec($feed);
        curl_close($feed);

    return json_decode($json, true);
} 
```

然后打电话`returnTweet()`

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-04-05T17:50:47.850

谢谢克里斯！

它在不使用查询参数的情况下对我有用，每当我使用多个参数时，它都会向我显示错误：32 无法对您进行身份验证。

对我来说，问题在于＆符号编码。所以在你的代码中它是以下行

```
$url .= "?".http_build_query($query); 
```

我在下面添加了以下行：

```
$url=str_replace("&amp;","&",$url); 
```

它使用两个或多个参数（如 screen_name 和 count）来工作。

整个代码如下所示：

```
$token = 'YOUR TOKEN';
$token_secret = 'TOKEN SECRET';
$consumer_key = 'YOUR KEY';
$consumer_secret = 'KEY SECRET';

$host = 'api.twitter.com';
$method = 'GET';
$path = '/1.1/statuses/user_timeline.json'; // api call path

$query = array( // query parameters
    'screen_name' => 'twitterapi',
    'count' => '2'
);

$oauth = array(
    'oauth_consumer_key' => $consumer_key,
    'oauth_token' => $token,
    'oauth_nonce' => (string)mt_rand(), // a stronger nonce is recommended
    'oauth_timestamp' => time(),
    'oauth_signature_method' => 'HMAC-SHA1',
    'oauth_version' => '1.0'
);

$oauth = array_map("rawurlencode", $oauth); // must be encoded before sorting
$query = array_map("rawurlencode", $query);

$arr = array_merge($oauth, $query); // combine the values THEN sort

asort($arr); // secondary sort (value)
ksort($arr); // primary sort (key)

// http_build_query automatically encodes, but our parameters
// are already encoded, and must be by this point, so we undo
// the encoding step
$querystring = urldecode(http_build_query($arr, '', '&'));

$url = "https://$host$path";

// mash everything together for the text to hash
$base_string = $method."&".rawurlencode($url)."&".rawurlencode($querystring);

// same with the key
$key = rawurlencode($consumer_secret)."&".rawurlencode($token_secret);

// generate the hash
$signature = rawurlencode(base64_encode(hash_hmac('sha1', $base_string, $key, true)));

// this time we're using a normal GET query, and we're only encoding the query params
// (without the oauth params)
$url .= "?".http_build_query($query);
$url=str_replace("&amp;","&",$url); //Patch by @Frewuill

$oauth['oauth_signature'] = $signature; // don't want to abandon all that work!
ksort($oauth); // probably not necessary, but twitter's demo does it

// also not necessary, but twitter's demo does this too
function add_quotes($str) { return '"'.$str.'"'; }
$oauth = array_map("add_quotes", $oauth);

// this is the full value of the Authorization line
$auth = "OAuth " . urldecode(http_build_query($oauth, '', ', '));

// if you're doing post, you need to skip the GET building above
// and instead supply query parameters to CURLOPT_POSTFIELDS
$options = array( CURLOPT_HTTPHEADER => array("Authorization: $auth"),
                  //CURLOPT_POSTFIELDS => $postfields,
                  CURLOPT_HEADER => false,
                  CURLOPT_URL => $url,
                  CURLOPT_RETURNTRANSFER => true,
                  CURLOPT_SSL_VERIFYPEER => false);

// do our business
$feed = curl_init();
curl_setopt_array($feed, $options);
$json = curl_exec($feed);
curl_close($feed);

$twitter_data = json_decode($json); 
```

希望它可以帮助遇到同样问题的人。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-03-14T01:23:58.763

这个问题对我帮助很大，但并没有让我完全理解需要发生的事情。[这篇博客文章](http://hueniverse.com/oauth/guide/authentication/)出色地引导我完成了它。

以下是集中在一处的重要信息：

*   如上所述，您必须签署您的 1.1 API 请求。如果您正在执行诸如获取公共状态之类的操作，您将需要应用程序密钥而不是用户密钥。您想要的页面的完整链接是：[https ://dev.twitter.com/apps](https://dev.twitter.com/apps)
*   您必须散列所有参数，包括 oauth 参数和 get 参数（或 POST 参数）。
*   您必须先对参数进行排序，然后才能将它们简化为经过哈希处理的 url 编码形式。
*   您必须对某些内容进行多次编码 - 例如，您从参数的 url 编码值创建一个查询字符串，然后对它进行 url 编码并与方法类型和 url 连接。

我对所有的头痛表示同情，所以这里有一些代码来总结它：

```
$token = 'YOUR TOKEN';
$token_secret = 'TOKEN SECRET';
$consumer_key = 'YOUR KEY';
$consumer_secret = 'KEY SECRET';

$host = 'api.twitter.com';
$method = 'GET';
$path = '/1.1/statuses/user_timeline.json'; // api call path

$query = array( // query parameters
    'screen_name' => 'twitterapi',
    'count' => '2'
);

$oauth = array(
    'oauth_consumer_key' => $consumer_key,
    'oauth_token' => $token,
    'oauth_nonce' => (string)mt_rand(), // a stronger nonce is recommended
    'oauth_timestamp' => time(),
    'oauth_signature_method' => 'HMAC-SHA1',
    'oauth_version' => '1.0'
);

$oauth = array_map("rawurlencode", $oauth); // must be encoded before sorting
$query = array_map("rawurlencode", $query);

$arr = array_merge($oauth, $query); // combine the values THEN sort

asort($arr); // secondary sort (value)
ksort($arr); // primary sort (key)

// http_build_query automatically encodes, but our parameters
// are already encoded, and must be by this point, so we undo
// the encoding step
$querystring = urldecode(http_build_query($arr, '', '&'));

$url = "https://$host$path";

// mash everything together for the text to hash
$base_string = $method."&".rawurlencode($url)."&".rawurlencode($querystring);

// same with the key
$key = rawurlencode($consumer_secret)."&".rawurlencode($token_secret);

// generate the hash
$signature = rawurlencode(base64_encode(hash_hmac('sha1', $base_string, $key, true)));

// this time we're using a normal GET query, and we're only encoding the query params
// (without the oauth params)
$url .= "?".http_build_query($query);

$oauth['oauth_signature'] = $signature; // don't want to abandon all that work!
ksort($oauth); // probably not necessary, but twitter's demo does it

// also not necessary, but twitter's demo does this too
function add_quotes($str) { return '"'.$str.'"'; }
$oauth = array_map("add_quotes", $oauth);

// this is the full value of the Authorization line
$auth = "OAuth " . urldecode(http_build_query($oauth, '', ', '));

// if you're doing post, you need to skip the GET building above
// and instead supply query parameters to CURLOPT_POSTFIELDS
$options = array( CURLOPT_HTTPHEADER => array("Authorization: $auth"),
                  //CURLOPT_POSTFIELDS => $postfields,
                  CURLOPT_HEADER => false,
                  CURLOPT_URL => $url,
                  CURLOPT_RETURNTRANSFER => true,
                  CURLOPT_SSL_VERIFYPEER => false);

// do our business
$feed = curl_init();
curl_setopt_array($feed, $options);
$json = curl_exec($feed);
curl_close($feed);

$twitter_data = json_decode($json); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-03-18T18:19:20.667

如果您安装了 OAuth PHP 库，则不必担心自己形成请求。

```
$oauth = new OAuth($consumer_key, $consumer_secret, OAUTH_SIG_METHOD_HMACSHA1, OAUTH_AUTH_TYPE_URI);
$oauth->setToken($access_token, $access_secret);

$oauth->fetch("https://api.twitter.com/1.1/statuses/user_timeline.json");
$twitter_data = json_decode($oauth->getLastResponse());

print_r($twitter_data); 
```

有关更多信息，请查看[文档](http://www.php.net/manual/en/book.oauth.php)或他们的[示例](http://www.php.net/manual/en/oauth.examples.fireeagle.php)。您可以使用`pecl install oauth`来获取库。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-06-17T06:04:41.413

首先，我要感谢 jimbo 和（[他的帖子](http://www.example.com/)/ twitter-api-php 简单库）。

如果您打算将[GET 搜索/推文 API](https://api.twitter.com/1.1/search/tweets.json)与“twitter-api-php”PHP 库 (TwitterAPIExchange.php) 一起使用：

首先，您只需注释“执行 POST 请求并回显响应”代码区域。

只需使用“执行 GET 请求并回显响应”代码并回显响应并更改这两行：

```
$url = 'https://api.twitter.com/1.1/followers/ids.json';
$getfield = '?screen_name=J7mbo'; 
```

到

```
$url = 'https://api.twitter.com/1.1/search/tweets.json';
$getfield = '?q=J7mbo'; 
```

（更改`screen_name`为`q`，就是这样：）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-16T18:48:52.447

您需要[在 Twitter 上创建一个“应用程序”](https://dev.twitter.com/apps/new)（并且您需要一个 Twitter 帐户来执行此操作）。

然后，您需要[使用 OAuth 向 Twitter 发出授权请求](https://dev.twitter.com/docs/auth/authorizing-request)。

您可以使用[GET statuses/user_timeline](https://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline)资源来获取最近推文的列表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-13T13:51:16.623

这是一个简短的，用于从您的时间线中获取指定数量的推文。它与其他示例的功能基本相同，只是代码更少。

只需填写密钥并`$count`根据自己的喜好进行调整：

```
$url = 'https://api.twitter.com/1.1/statuses/user_timeline.json';
$count = '10';

$oauth = array('count' => $count,
               'oauth_consumer_key' => '[CONSUMER KEY]',
               'oauth_nonce' => md5(mt_rand()),
               'oauth_signature_method' => 'HMAC-SHA1',
               'oauth_timestamp' => time(),
               'oauth_token' => '[ACCESS TOKEN]',
               'oauth_version' => '1.0');

$oauth['oauth_signature'] = base64_encode(hash_hmac('sha1', 'GET&' . rawurlencode($url) . '&' . rawurlencode(implode('&', array_map(function ($v, $k) { return $k . '=' . $v; }, $oauth, array_keys($oauth)))), '[CONSUMER SECRET]&[ACCESS TOKEN SECRET]', true));

$twitterData = json_decode(file_get_contents($url . '?count=' . $count, false, stream_context_create(array('http' => array('method' => 'GET',
                                                                                                                           'header' => 'Authorization: OAuth ' 
                                                                                                                                       . implode(', ', array_map(function ($v, $k) { return $k . '="' . rawurlencode($v) . '"'; }, $oauth, array_keys($oauth)))))))); 
```

这个使用匿名函数而`file_get_contents`不是 cURL 库。请注意使用 MD5 散列随机数。每个人似乎都同意`time()`随机数，但是，网络上大多数关于 OAuth 的示例都使用某种加密字符串（例如：[http](http://www.sitepoint.com/understanding-oauth-1/) ://www.sitepoint.com/understanding-oauth-1/ ）。这对我来说也更有意义。

**进一步注意：**匿名函数需要 PHP 5.3+（以防您的服务器/计算机在某个冷战洞穴中并且您无法升级它）。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-03-21T21:36:49.197

从他们的[签名生成器](https://dev.twitter.com/oauth/tools/signature-generator/)中，您可以生成`curl`以下形式的命令：

```
curl --get 'https://api.twitter.com/1.1/statuses/user_timeline.json' --data 'count=2&screen_name=twitterapi' --header 'Authorization: OAuth oauth_consumer_key="YOUR_KEY", oauth_nonce="YOUR_NONCE", oauth_signature="YOUR-SIG", oauth_signature_method="HMAC-SHA1", oauth_timestamp="TIMESTAMP", oauth_token="YOUR-TOKEN", oauth_version="1.0"' --verbose 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2014-06-23T07:26:50.023

```
$connection = new TwitterOAuth(CONSUMER_KEY, CONSUMER_SECRET, OAUTH_TOKEN, OAUTH_TOKEN_SECRET);

$timelines = $connection->get('statuses/user_timeline', array('screen_name' => 'NSE_NIFTY', 'count' => 100, 'include_rts' => 1)); 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2014-07-03T23:29:35.833

多亏了这个线程，尤其是 budidino，因为他的代码让我明白了这一点。只是想贡献如何从请求中检索 JSON 数据。更改代码的“//create request”请求数组部分以执行不同的请求。最终，这会将 JSON 输出到浏览器屏幕上

```
<?php
    function buildBaseString($baseURI, $method, $params) {
    $r = array();
    ksort($params);
    foreach($params as $key=>$value){
        $r[] = "$key=" . rawurlencode($value);
    }
    return $method."&" . rawurlencode($baseURI) . '&' . rawurlencode(implode('&', $r));
}

function buildAuthorizationHeader($oauth) {
    $r = 'Authorization: OAuth ';
    $values = array();
    foreach($oauth as $key=>$value)
        $values[] = "$key=\"" . rawurlencode($value) . "\"";
    $r .= implode(', ', $values);
    return $r;
}

function returnTweet(){
    $oauth_access_token         = "2602299919-lP6mgkqAMVwvHM1L0Cplw8idxJzvuZoQRzyMkOx";
    $oauth_access_token_secret  = "wGWny2kz67hGdnLe3Uuy63YZs4nIGs8wQtCU7KnOT5brS";
    $consumer_key               = "zAzJRrPOj5BvOsK5QhscKogVQ";
    $consumer_secret            = "Uag0ujVJomqPbfdoR2UAWbRYhjzgoU9jeo7qfZHCxR6a6ozcu1";

    $twitter_timeline           = "user_timeline";  //  mentions_timeline / user_timeline / home_timeline / retweets_of_me

    //  create request
        $request = array(
            'screen_name'       => 'burownrice',
            'count'             => '3'
        );

    $oauth = array(
        'oauth_consumer_key'        => $consumer_key,
        'oauth_nonce'               => time(),
        'oauth_signature_method'    => 'HMAC-SHA1',
        'oauth_token'               => $oauth_access_token,
        'oauth_timestamp'           => time(),
        'oauth_version'             => '1.0'
    );

    //  merge request and oauth to one array
        $oauth = array_merge($oauth, $request);

    //  do some magic
        $base_info              = buildBaseString("https://api.twitter.com/1.1/statuses/$twitter_timeline.json", 'GET', $oauth);
        $composite_key          = rawurlencode($consumer_secret) . '&' . rawurlencode($oauth_access_token_secret);
        $oauth_signature            = base64_encode(hash_hmac('sha1', $base_info, $composite_key, true));
        $oauth['oauth_signature']   = $oauth_signature;

    //  make request
        $header = array(buildAuthorizationHeader($oauth), 'Expect:');
        $options = array( CURLOPT_HTTPHEADER => $header,
                          CURLOPT_HEADER => false,
                          CURLOPT_URL => "https://api.twitter.com/1.1/statuses/$twitter_timeline.json?". http_build_query($request),
                          CURLOPT_RETURNTRANSFER => true,
                          CURLOPT_SSL_VERIFYPEER => false);

        $feed = curl_init();
        curl_setopt_array($feed, $options);
        $json = curl_exec($feed);
        curl_close($feed);

    return $json;
}

$tweet = returnTweet();
echo $tweet;

?> 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2015-12-31T14:38:49.097

如果它对任何人有用... 在我的博客中，我实现了以下 PHP 代码，以检索最后的推文，提取它们最相关的数据，然后将它们保存到 MySQL 数据库中。它有效，因为我在我的博客中得到了它。

存储它们的“推文”表：

```
CREATE TABLE IF NOT EXISTS `tweets` (
  `tweet_id` int(11) NOT NULL auto_increment,
  `id_tweet` bigint(20) NOT NULL,
  `text_tweet` char(144) NOT NULL,
  `datetime_tweet` datetime NOT NULL,
  `dayofweek_tweet` char(3) NOT NULL,
  `GMT_tweet` char(5) NOT NULL,
  `shorturl_tweet` char(23) NOT NULL,
  PRIMARY KEY  (`tweet_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=83 ; 
```

get_tweets.php：

```
<?php
function buildBaseString($baseURI, $method, $params) {
    $r= array();
    ksort($params);
    foreach($params as $key=>$value){
        $r[]= "$key=".rawurlencode($value);
    }
    return $method."&".rawurlencode($baseURI).'&'.rawurlencode(implode('&', $r));
}

function buildAuthorizationHeader($oauth) {
    $r= 'Authorization: OAuth ';
    $values= array();
    foreach($oauth as $key=>$value) {
        $values[]= "$key=\"".rawurlencode($value)."\"";
    }
    $r.= implode(', ', $values);
    return $r;
}

function returnTweets($last_id) {
    $oauth_access_token         = "2687912757-vbyfJA483SEyj2HJ2K346aVMxtOIgVbsY4Edrsw";
    $oauth_access_token_secret  = "nIruzmR0bXqC3has4fTf8KAq4pgOceiuKqjklhroENU4W";
    $api_key                    = "ieDSTFH8QHHPafg7H0whQB9GaY";
    $api_secret                 = "mgm8wVS9YP93IJmTQtsmR8ZJADDNdlTca5kCizMkC7O7gFDS1j";
    $twitter_timeline           = "user_timeline";  //[mentions_timeline/user_timeline/home_timeline/retweets_of_me]
    //create request
    $request= array(
        'screen_name'       => 'runs_ES',
        'count'             => '3',
        'exclude_replies'   => 'true'
        );
    if (!is_null($last_id)) { //Add to the request if it exits a last_id
        $request['since_id']= $max_id;
    }
    $oauth = array(
        'oauth_consumer_key'        => $api_key,
        'oauth_nonce'               => time(),
        'oauth_signature_method'    => 'HMAC-SHA1',
        'oauth_token'               => $oauth_access_token,
        'oauth_timestamp'           => time(),
        'oauth_version'             => '1.0'
        );
    //merge request and oauth to one array
    $oauth= array_merge($oauth, $request);
    //do some magic
    $base_info=                 buildBaseString("https://api.twitter.com/1.1/statuses/$twitter_timeline.json", 'GET', $oauth);
    $composite_key=             rawurlencode($api_secret).'&'.rawurlencode($oauth_access_token_secret);
    $oauth_signature=           base64_encode(hash_hmac('sha1', $base_info, $composite_key, true));
    $oauth['oauth_signature']=  $oauth_signature;
    //make request
    $header= array(buildAuthorizationHeader($oauth), 'Expect:');
    $options= array(CURLOPT_HTTPHEADER => $header,
                    CURLOPT_HEADER => false,
                    CURLOPT_URL => "https://api.twitter.com/1.1/statuses/$twitter_timeline.json?". http_build_query($request),
                    CURLOPT_RETURNTRANSFER => true,
                    CURLOPT_SSL_VERIFYPEER => false);
    $feed= curl_init();
    curl_setopt_array($feed, $options);
    $json= curl_exec($feed);
    curl_close($feed);
    return $json;
}

function parse_tweettext($tweet_text) {
    $text= substr($tweet_text, 0, -23);
    $short_url= substr($tweet_text, -23, 23);
    return array ('text'=>$text, 'short_url'=> $short_url);
}

function parse_tweetdatetime($tweetdatetime) {
    //Thu Aug 21 21:57:26 +0000 2014 Sun Mon Tue Wed Thu Fri Sat
    $months= array('Jan'=>'01', 'Feb'=>'02', 'Mar'=>'03', 'Apr'=>'04', 'May'=>'05', 'Jun'=>'06', 
                    'Jul'=>'07', 'Aug'=>'08', 'Sep'=>'09', 'Oct'=>'10', 'Nov'=>'11', 'Dec'=>'12');
    $GMT= substr($tweetdatetime, -10, 5);
    $year= substr($tweetdatetime, -4, 4);
    $month_str= substr($tweetdatetime, 4, 3);
    $month= $months[$month_str];
    $day= substr($tweetdatetime, 8, 2); 
    $dayofweek= substr($tweetdatetime, 0, 3);
    $time= substr($tweetdatetime, 11, 8);
    $date= $year.'-'.$month.'-'.$day;
    $datetime= $date.' '.$time;
    return array('datetime'=>$datetime, 'dayofweek'=>$dayofweek, 'GMT'=>$GMT);
    //datetime: "YYYY-MM-DD HH:MM:SS", dayofweek: Mon, Tue..., GMT: +####
}

//First check in the database the last id tweet:
$query= "SELECT MAX(tweets.id_tweet) AS id_last FROM tweets;";
$result= exec_query($query);
$row= mysql_fetch_object($result);
if ($result!= 0 && mysql_num_rows($result)) { //if error in query or not results
    $last_id= $row->id_last;
}
else {
    $last_id= null;
}

$json= returnTweets($last_id);
$tweets= json_decode($json, TRUE);

foreach ($tweets as $tweet) {
    $tweet_id= $tweet['id'];
    if (!empty($tweet_id)) { //if array is not empty
        $tweet_parsetext= parse_tweettext($tweet['text']);
        $tweet_text= utf8_encode($tweet_parsetext['text']);
        $tweet_shorturl= $tweet_parsetext['short_url'];
        $tweet_parsedt= parse_tweetdatetime($tweet['created_at']);
        $tweet_datetime= $tweet_parsedt['datetime'];
        $tweet_dayofweek= $tweet_parsedt['dayofweek'];
        $tweet_GMT= $tweet_parsedt['GMT'];
        //Insert the tweet into the database:
        $fields = array(
            'id_tweet' => $tweet_id,
            'text_tweet' => $tweet_text,
            'datetime_tweet' => $tweet_datetime,
            'dayofweek_tweet' => $tweet_dayofweek,
            'GMT_tweet' => $tweet_GMT,
            'shorturl_tweet' => $tweet_shorturl
            );
        $new_id= mysql_insert('tweets', $fields);
    }
} //end of foreach
?> 
```

保存推文的功能：

```
function mysql_insert($table, $inserts) {
    $keys = array_keys($inserts);
    exec_query("START TRANSACTION;");
    $query= 'INSERT INTO `'.$table.'` (`'.implode('`,`', $keys).'`) VALUES (\''.implode('\',\'', $inserts).'\')';
    exec_query($query);
    $id= mysql_insert_id();
    if (mysql_error()) {
        exec_query("ROLLBACK;");
        die("Error: $query");
    }
    else {
        exec_query("COMMIT;");
    }
    return $id;
} 
```

# php - xajax 调用后启动会话

> ID：12916541
> 
> 赞同：2
> 
> 时间：2012-10-16T14:08:50.670
> 
> 标签：php, xajax

我在使用 xajax 发出 ajax 请求时遇到问题。问题是我不想在服务器上启动会话，除非它是完全必要的。对于 xajax 调用，如果会话不存在，则无法发送响应，因此我被迫启动它。

所以，假设**会话没有**在用户从客户端进行调用的那一刻开始，如果我在服务器端有这个功能：

```
function example() {
    $response = new XajaxResponse();
    $response->script("alert('hello')");
    return $response;
} 
```

我得到一个错误。我无法追踪 chrome 或资源管理器中的错误，但在 Firefox 中，我在库的核心中得到了一个未捕获的对象异常。如果我在返回之前开始会话，它“有效”：

```
function example() {
    session_start();
    $response = new XajaxResponse();  
    $response->script("alert('hello')");
    return $response;
} 
```

我说“有效”是因为它以部分方式起作用。在 Firefox 中，ajax 调用完美完成，**但是在 chrome/ie 中我需要进行 2 次调用**：第一次没有任何反应，而第二次则可以。

我现在能想到的唯一解决方案是一个非常肮脏的解决方案。应该是创建一个xajax函数来启动会话：

```
function startSession () {
     session_start();
} 
```

然后，从客户端以这种方式进行两次调用：

```
xajax_startSession(); xajax_example(); 
```

通过这种方法，我解决了 chrome/ie 中“第一次执行”的问题，但是必须为每个 xajax 调用添加一个额外的调用是一个非常糟糕的主意:(

再次非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:35:06.713

你可以做同样的动作

```
$response->alert('hello'); 
```

代替

```
$response->script("alert('hello')"); 
```

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:15:28.683

您的代码是错误的，除非您只是动态编写的

```
function example() {
    session_start();  
    $response->script("alert('hello')");
    $response = new XajaxResponse();
    return $response;
} 
```

两条线应该互换

```
 $response->script("alert('hello')");
    $response = new XajaxResponse(); 
```

至于您的实际问题，它似乎是[在 ajax 调用期间创建会话（php-xajax）的重复](https://stackoverflow.com/questions/12800653/create-the-session-during-ajax-call-php-xajax)

# objective-c - 核心数据转换器

> ID：12916545
> 
> 赞同：1
> 
> 时间：2012-10-16T14:09:04.783
> 
> 标签：objective-c, ios, xcode, sqlite, core-data

我想用`NSValueTransformer`类加密一些核心数据列，但我不太确定要使用什么加密方法。有没有人在使用 Core Data 时尝试过加密单个实体，如果是，是否有任何工作实现的示例代码？我希望加密不会干扰`NSPredicate`我以后用来从数据库取回数据的任何 s

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:29:23.157

Apple 的 iPhoneCoreDataRecipes 示例代码有一个`NSValueTransformer`在模型中使用子类和可转换属性的示例。请参阅可转换的属性类型设置：

![在此处输入图像描述](../Images/14d3ea663c4b4b19815d16364ac0050e.png)

和价值转换器的实施：

在您的情况下，您需要按照[此处建议](http://robnapier.net/blog/aes-commoncrypto-564)的方式分别在`transformedValue`和方法中提供加密和解密算法。`reverseTransformedValue`

# ios - 删除背景

> ID：12916555
> 
> 赞同：0
> 
> 时间：2012-10-16T14:09:22.230
> 
> 标签：ios, xcode

我正在使用 Parse DB，需要 currentUsers 才能从中删除。我在 UITableView 中设置了一个 PFQuery，它返回 currentUsers 条目。这是我迄今为止尝试过的，但没有成功。

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source

        [filteredBooks removeObjectAtIndex:indexPath.row ];
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation: UITableViewRowAnimationFade];

        PFObject *myobject = [PFObject objectWithClassName:@"Books"];
        [myobject deleteInBackgroundWithBlock:^(BOOL succeeded, NSError *error) {
        if (succeeded) {

                [self.tableView reloadData];
            }

        }];

    }
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
       // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
} 
```

它抛出异常：原因：'无效更新：第 0 节中的行数无效。更新后现有节中包含的行数（2）必须等于更新前该节中包含的行数（ 2)，加上或减去从该节插入或删除的行数（0 插入，1 删除），加上或减去移入或移出该节的行数（0 移入，0 移出）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:12:13.247

你应该做的第一件事是解决这个问题：

```
[filteredBooks removeObjectAtIndex:indexPath.row ];<br>
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] 
                 withRowAnimation: UITableViewRowAnimationFade]; 
```

将其替换为：

```
[filteredBooks removeObjectAtIndex:indexPath.row ];
[tableView beginUpdates];
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] 
                 withRowAnimation: UITableViewRowAnimationFade];
[tableView endUpdates]; 
```

我不确定第二部分。如果`myObject`与您从中删除的对象相同，`filteredBooks`则您根本不必`[tableView reloadData]`在完成块中进行操作。你能描述一下你想在那里做什么吗？

此外，为了在 tableView 中获得更好的性能以及漂亮的更新动画，我更喜欢使用表更新而不是 reloadData，如下所示：

```
[tableView beginUpdates];
[tableView reloadRowsAtIndexPaths:[tableView indexPathsForVisibleRows]
                 withRowAnimation:UITableViewRowAnimationFade];
[tableView endUpdates]; 
```

而不是，`[tableView reloadData];`
但当然你应该知道你要做什么

# ruby-on-rails - 多个用户对我的应用进行身份验证导致其中一些用户被暂停

> ID：12916557
> 
> 赞同：0
> 
> 时间：2012-10-16T14:09:24.820
> 
> 标签：ruby-on-rails, facebook, facebook-graph-api, facebook-authentication

[我的网站](http://www.wavenconnect.com)上有一个验证应用程序按钮

我的问题我有一个展位，用户来到展位在他们的帐户上验证我的应用程序，以便在连续验证大约 30 个用户后将他们的帐户映射到某个 RFID 卡，用户号 31/32 被[暂停消息与此完全相同](https://www.dropbox.com/s/zblxc3hc0kz4qeu/Screenshot_2012-01-03-04-47-06.png?m)

重现：

1.  打开网站
2.  点击与 Facebook 连接
3.  从 Facebook 注销
4.  使用另一个用户连接等等。

注意：我正在使用 Galaxy Tab 和所有用户从平板电脑进行身份验证/登录，然后注销以供其他用户登录。

预期行为：-我的应用程序通过用户帐户的身份验证

真正发生的事情： - 应用程序像魅力一样获得身份验证，但在 30 个用户之后，一两个用户的帐户因上述消息而被暂停

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:37:58.697

检查您的 facebook API 的条款和条件。可能是您被限制为 30 个并发用户，并且可能需要支付更多费用才能获得更高的数量。

# android - Android 应用程序与 google Docs 同步`

> ID：12916564
> 
> 赞同：0
> 
> 时间：2012-10-16T14:09:52.037
> 
> 标签：android, google-app-engine, google-docs, google-docs-api, google-drive-api

我是android新手。在我的应用程序中，我的应用程序与谷歌文档有一个模块同步...任何人都可以帮助我们提供良好的教程链接，这使我快速构建...。我希望我有好东西请野兔帮帮我谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T21:11:10.450

[`google-api-java-client`](https://code.google.com/p/google-api-java-client/wiki/Android)从支持 Android的库开始。页面底部有一些示例。

# xcode - Xcode 创建可点击的文本

> ID：12916569
> 
> 赞同：4
> 
> 时间：2012-10-16T14:09:59.140
> 
> 标签：xcode, text, hyperlink, clickable

我正在尝试创建一个可以在其中包含可点击文本的对象。

例如：我向用户显示文本： *“请在接受注册之前验证条款和条件。”*

我只想将*“条款和条件”*文本显示为链接。文本将带有蓝色下划线。

当用户单击文本时，我希望他们导航到我的条款和条件视图控制器页面。所以链接是应用程序内部的，而不是外部网页。

**问题**

1.  如何仅使特定文本可链接来显示文本？
2.  如何通过用户单击链接文本来“排序”到 ViewController 页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T18:20:43.933

您可以使用[TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)做到这一点。从自述文件中：

> 除了支持富文本之外，TTTAttributedLabel 还允许您自动检测 URL、地址、电话号码和日期的链接，或者允许您嵌入自己的链接。
> 
> ```
> label.dataDetectorTypes = UIDataDetectorTypeAll; // Automatically detect links when the label text is subsequently changed
> label.delegate = self; // Delegate methods are called when the user taps on a link (see `TTTAttributedLabelDelegate` protocol)
> 
> label.text = @"Fork me on GitHub! (http://github.com/mattt/TTTAttributedLabel/)"; // Repository URL will be automatically detected and linked
> 
> NSRange range = [label.text rangeOfString:@"me"];
> [label addLinkToURL:[NSURL URLWithString:@"http://github.com/mattt/"] withRange:range]; // Embedding a custom link in a substring 
> ```

# c# - 设置 Windows Media Center 插件模板

> ID：12916570
> 
> 赞同：1
> 
> 时间：2012-10-16T14:10:02.583
> 
> 标签：c#, visual-studio-2010, wix, winapi, windows-media-center

我正在开始一个涉及为 Windows Media Center 编写插件的项目。

我现在要做的就是运行默认包含在 Windows Media Center SDK 中的示例项目。项目中包含执行此操作的说明，我已逐步遵循这些说明。

我可以使用调试功能在 Visual Studio 中运行程序（只是一个简单的应用程序，有四个按钮，不执行任何操作），但在尝试创建安装程序时遇到问题，以便程序可以安装在 Windows Media 中中心。

说明告诉我将此行添加到我的项目的“构建后事件命令行”部分：

```
"$(ProjectDir)Setup\Build.bat" $(ConfigurationName) 
```

当我去构建我的解决方案时（按照指示），我收到以下错误：

```
Error   1   The command "%windir%\eHome\McmlVerifier.exe -verbose
-assemblyredirect:"C:\Users\john\Documents\Visual Studio 2010\Projects\MediaCenterApplication1\MediaCenterApplication1\bin\Release" 
-directory:"C:\Users\john\Documents\Visual Studio 2010\Projects\MediaCenterApplication1\MediaCenterApplication1\Markup"
REM "C:\Users\john\Documents\Visual Studio 2010\Projects\MediaCenterApplication1\MediaCenterApplication1\Setup\Build.cmd" Release
"C:\Users\john\Documents\Visual Studio 2010\Projects\MediaCenterApplication1\MediaCenterApplication1\Setup\Build.bat" Release
" exited with code 9009\.    MediaCenterApplication1 
```

我选择用 C# 编写插件，这是我目前的设置：

```
- Windows 7 Home Premium 64-bit
- Microsoft Visual C# Express 2010
- Windows SDK v6.0
- Windows Media Center SDK v7.1
- WiX Toolset v3.7 
```

有没有人对出了什么问题有任何想法？如果不是，那么推荐给 WMC 开发人员的论坛是什么？到目前为止，我看过的论坛似乎都很安静。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:15:33.860

当 ehome 文件夹中没有 mcmlverifier.exe 时，我得到了退出代码 9009。

我发现有助于开发 build.cmd 的链接是 [http://david.gardiner.net.au/2010/10/writing-media-center-application-in.html](http://david.gardiner.net.au/2010/10/writing-media-center-application-in.html)

问候克里斯

# c++ - 从模板 C++ 继承

> ID：12916574
> 
> 赞同：5
> 
> 时间：2012-10-16T14:10:11.857
> 
> 标签：c++, templates, inheritance

我有一个关于我最近收到的代码的问题。我只想知道在 C++ 模板范例中进行以下继承是否正确或有用（仅以 3 个类为例）：

* * *

```
template< class I, class P, class D, unsigned int ID = 0 >
class PathFilter : public Filter< I, P, 1 >
{
...
} 
```

* * *

```
template< class I, class A, unsigned int N = 1 >
class Filter : public Algorithm< I, A >
{
...
} 
```

* * *

```
template< class I, class A >
class Algorithm : public A //This line
{
   ...
} 
```

* * *

我的问题是关于第三个例子中的继承。让它如此“通用”而不精确有用吗？通过更通用的代码来妥协可理解的代码是一个不错的选择吗？

我首先问是因为我不是 C++ 模板方面的专家，还因为我发现使用模板很难理解这段代码（通常模板的名称没有说明它的内容）。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:17:01.277

你正在做的是一个*mixin 类*（特别是你的类`Algorithm`）。

作为参考，您可以参考，例如[http://en.wikipedia.org/wiki/Mixin](http://en.wikipedia.org/wiki/Mixin)或[http://en.wikipedia.org/wiki/Composite_pattern](http://en.wikipedia.org/wiki/Composite_pattern)。

实际上，您正在指定“某些功能（由 指定`A`）被继承或仅由子类（即`Algorithm`）重用”。（引自第一篇文章）

换句话说，您正在让自己（或您的用户）自由地添加或更改行为以`Algorithm`某种“事后”。您真正的收获是仅依靠编译器而不是某些*类似动态绑定的机制*（例如，覆盖虚函数）来实现这种灵活性。实际上，您的最终类`Algorithm<A>`是在编译时构建的，它*可能* 与您明确编写的类一样有效（即，在*手工*编写时`Algorithm<A>`明确包括策略）。`A``Algorithm`

 ***编辑**：

我还建议查看有关基于策略的设计的维基百科页面（[http://en.wikipedia.org/wiki/Policy-based_design](http://en.wikipedia.org/wiki/Policy-based_design)）。

`A`正如@full.stack.ex 明智地建议的那样，在那里，策略名称（您的）以清晰的形式出现，并带有清晰的名称。*

# php - iframe“类似ajax”文件上传 - 预览

> ID：12916578
> 
> 赞同：0
> 
> 时间：2012-10-16T14:10:24.223
> 
> 标签：php, javascript, jquery, html

我正在尝试在已经存在的提交表单中包含图片上传器 - 理想情况下，我希望它看起来像 ajax，所以显然 iframe 是要走的路 - 一旦上传，我希望它显示上传图像的预览并离开隐藏输入中文件位置的 url

我发现[http://www.uploadify.com/demos/](http://www.uploadify.com/demos/)这似乎是我最好的选择，但是我不知道如何让它显示预览图像或将 url 保留在隐藏的输入中。最好我想要一个“撤消”按钮，以防他们选择了错误的文件，但我并不挑剔

任何人都知道如何实现这一点或更好的选择

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T17:42:02.093

[您可以通过 Uploadify 的onUploadSuccess](http://www.uploadify.comdocumentation/uploadify/onuploadsuccess/)事件的 data 参数返回任何信息，包括文件 url。

# java - 为什么我的线程在失败时没有超时？

> ID：12916580
> 
> 赞同：2
> 
> 时间：2012-10-16T14:10:32.520
> 
> 标签：java, multithreading, timeout, executorservice

所以我刚才问了一个问题：[在这里](https://stackoverflow.com/questions/12302984/implementing-thread-timeout-in-executor-service)问了一个问题“如果我的线程花费太长时间，我怎样才能让它们被杀死”

我已经实现了那里提到的解决方案，但是在线程超时的某些罕见情况下，程序仍然可能失败/锁定（请参阅：保持 main() 方法打开，并防止程序的进一步 cron 运行）。

这是我正在使用的来源：

```
 //Iterate through the array to submit them into individual running threads.
    ExecutorService threadPool = Executors.newFixedThreadPool(12);
    List<Future<?>> taskList = new ArrayList<Future<?>>();
    for (int i = 0; i < objectArray.length; i++) {
        Future<?> task = threadPool.submit(new ThreadHandler(objectArray[i], i));
        taskList.add(task);
        Thread.sleep(500);
    }

    //Event handler to kill any threads that are running for more than 30 seconds (most threads should only need .25 - 1 second to complete.
    for(Future future : taskList){
        try{
            future.get(30, TimeUnit.SECONDS);
        }catch(CancellationException cx){ System.err.println("Cancellation Exception: "); cx.printStackTrace();
        }catch(ExecutionException ex){ System.err.println("Execution Exception: ");ex.printStackTrace();
        }catch(InterruptedException ix){ System.err.println("Interrupted Exception: ");ix.printStackTrace();
        }catch(TimeoutException ex) {future.cancel(true);}
    }
    threadPool.shutdown();
    threadPool.awaitTermination(60, TimeUnit.SECONDS); 
```

所以我的问题是：执行此代码后，为什么执行程序服务没有在 30 秒时中断。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:12:36.253

因为我怀疑您的工作线程仍在运行。您正在调用`future.cancel(true);`，但所做的只是在线程上设置中断标志——它不会主动中断您正在运行的代码。“中断”代码的另一种方法是设置一些`volatile boolean shutdown`标志为真，并在你的代码中测试它。[有关中断线程](http://www.techrepublic.com/article/interrupting-java-threads/5144546)的更多详细信息，请参见此处。

您需要确保您的`ThreadHandler`代码正确处理中断。例如，它需要检查`Thread.currentThread().isInterrupted()`循环或其他代码块。您还需要确保`InterruptedException`正确处理，而不仅仅是吞下中断。

有关线程中断的更多信息，请参阅[我的答案](https://stackoverflow.com/a/12060317/179850)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:24:42.197

每个任务的超时时间都在增加，这可能不是预期的。相反，您可以在超时后关闭线程池并取消其余部分。

```
threadPool.shutdown();
threadPool.awaitTermination(30, TimeUnit.SECONDS);
threadPool.shutdownNow(); // interrupt any running tasks. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T18:32:14.633

Java Concurrency in Practice 一书中有一整章专门的任务取消。从我读过的内容来看，任务取消必须在 finally 块中，以确保任务始终结束。

```
 try{
            future.get(30, TimeUnit.SECONDS);

        } catch (TimeoutException e) {
           // log error message and falls through to finally block
        } catch (ExecutionException e) {
            throw e;
        } finally {
            future.cancel(true); // interrupt task
        } 
```

在处理 InterruptedException 时必须恢复中断状态。

```
 catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            } 
```

在 ThreadHandler 任务中检查 Thread.currentThread().isInterrupted() 标志，如果为真则抛出 InterruptedException 传播中断状态。

# jquery - 在 iframe 上打开新的颜色框窗口

> ID：12916585
> 
> 赞同：1
> 
> 时间：2012-10-16T14:10:44.733
> 
> 标签：jquery, window, colorbox, parent

我的父链接设置如下：

```
 $(".ajax").colorbox({iframe:true, innerWidth:"470px", innerHeight:"500px"}); 
```

这将打开第一个 iframe，在我有链接的父 iframe 内。目前，这些链接会在父 Colorbox 窗口中加载新内容，而无需调整大小或进行任何操作。很好，但我需要在父颜色框上加载另一个窗口，因为窗口 2 上的内容需要更少的空间（200 像素宽度而不是父 470 像素）

如何做到这一点？到目前为止，我已经尝试过：

```
 $(document).ready(function(){
    $('.open_page2').colorbox({
        width:"704px",
        height:"800px",
        iframe:true,
        scrolling: false,
        overlayClose: false,
        photo: false,
        opacity: 0.6
    }); 
     }); 
```

没有运气。另请注意，新窗口需要从 href 链接打开。

# c# - 正则表达式的建议

> ID：12916586
> 
> 赞同：-2
> 
> 时间：2012-10-16T14:10:49.777
> 
> 标签：c#, regex, visual-studio-2010

在正则表达式方面需要帮助。我尝试过使用备忘单，但它不起作用。我正在遍历列表中的行并正在寻找匹配项：

```
邮件交换器 = *.domain.com
```

其中 * = 一切。

有什么帮助吗？

我尝试过：

```
\\w[mail exchanger = ].*\\.domain\\.com 
```

- 但它也可以在没有“交换器”部分的情况下在线匹配。

最好的祝福

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:17:18.727

为什么不直接使用`line.Contains(".domain.com") && line.Contains("mail exchanger = ")`？很好很简单。

* * *

您的正则表达式不起作用，因为`[]`' 说要匹配其中的*任何*字符。所以它会匹配 an `m`, an `a`, an`i`等等......你的意思是使用`()`'s。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:13:55.110

我认为您将通配符与正则表达式混淆了。在这种情况下，正则表达式类似于：

`^.+?\.domain\.com$`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:32:24.110

你可以试试这个：

`.[a-zA-Z0-9]*.com`

# javascript - 如何让 TinyMCE 显示在 jsfpage 上？

> ID：12916587
> 
> 赞同：1
> 
> 时间：2012-10-16T14:10:50.383
> 
> 标签：javascript, jsf, tinymce, rich-text-editor

我是 jsf 的新手，我想在我的网页上使用 TinyMCE 作为富文本编辑器。我按照 TinyMCE 在这里给出的安装说明进行操作：

[http://www.tinymce.com/wiki.php/%22For_Dummies%22](http://www.tinymce.com/wiki.php/%22For_Dummies%22)

我使用 netbean 作为我的 IDE。我将 tiny_mce 文件夹放在名为“resources”的文件夹下，该文件夹位于 -WAR 项目文件夹下的“Web-Pages”文件夹下，

我的 newjsf.xhtml 页面中有这个

```
<h:head>     
    <title>test</title>
    <script src="/resources/tiny_mce/tiny_mce.js" type="text/javascript"></script>

    <script type="text/javascript">
        tinyMCE.init({
            // General options
            mode : "textareas",
            theme : "simple"          
        });
    </script>     

</h:head>
<h:body>
    <h:form id="window">          

        <h:inputTextarea id="field" value="#{test.text}"  />

    </h:form>
</h:body> 
```

这是托管豆。

```
public class test {

private String text;

public test() {
}

/**
 * @return the text
 */
public String getText() {
    return text;
}

/**
 * @param text the text to set
 */
public void setText(String text) {
    System.out.println("setted me!!!!!!!!!" + text);
    this.text = text;
} 
```

}

我在浏览器页面上得到的只是一个纯文本区域“”，而不是一个 tinyMCE 文本编辑器。javascript 会自动用 TinyMCE 替换纯文本区域，这不是真的吗？还是我错误地指定了 tiny_mce.js 的路径，导致程序找不到加载的 .js 文件的源？奇怪的是，当我打开 newjsf.xhtml 页面时，我的 glassfish 服务器日志没有错误/异常输出。只是 TinyMCE 是纯文本区域，而不是演示中显示的内容。

谢谢！

* * *

我解决了显示问题。这确实是由我放置 tiny_mce 文件夹的地方引起的。我尝试模仿包中的示例网页，并将 .js 文件放置到具有示例的相对结构的路径中，并显示编辑器。我遇到的新问题是如何将 inputTextarea 内容传递给 managerbean。我有下面两行来提交内容。

h:inputTextarea value="#{test.text}" p:commandButton value="submit" actionListener="#{test.print}"

方法我的managerbean

```
public void print (){
    if (this.text == null) {
        System.out.println("why");
    } else {
        System.out.println(this.text + "i got it");
    }
}   
public String getText() {
    return text;
}
public void setText(String text) {
    System.out.println("setted me!!!!!!!!!" + text);
    this.text = text;
} 
```

当我提交时，服务器输出是这样的。

信息：设置我！！！！！！！！！！信息：我知道了

即使触发了对 setter 的调用，我输入的所有内容也不会被捕获。有人可以帮助我吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:10:53.883

我得到它！只需添加 onclick="tinyMCE.getContent()" 内容就可以传递给 managerbean。如果您有更好的建议，请在下方留言。

# jquery - Jquery 索引数据库和重定向问题

> ID：12916588
> 
> 赞同：0
> 
> 时间：2012-10-16T14:10:53.720
> 
> 标签：jquery, jquery-plugins, indexeddb

我正在寻找一些帮助。

我有一个 javascript 登录页面，它在成功登录时重定向用户（基于来自服务器的 JSON 响应）。

我希望能够向我的 indexeddb 添加大量数据以在站点周围使用，而不是一直触发 ajax 请求；但是，我的登录脚本会在所有数据都存储在数据库中之前重定向用户。（可能有很多。）

我正在循环一个响应对象，如下所示：

```
var lookup = $.indexedDB("atlas").objectStore("Lookup");
lookup.clear();
$.each(obj, function(){
    lookup.add(this);
}); 
```

有没有办法可以检测到上述所有内容何时完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:00:05.980

我不熟悉该插件，但在使用 indexeddb 规范时，您对事务有完整的回调。这在事务完成并提交时调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-23T08:47:07.957

我编写了一个小的 jquery 插件（仍然非常 alpha）来简化令人困惑的 IndexedDB API 的使用

[https://github.com/ameyms/jquery-indexeddb](https://github.com/ameyms/jquery-indexeddb)

我试图保持 API 超级简单：

```
//Define and initialize an IndexedDB ...
var db = $.idb({
                    name:'foobar', 
                    version: 2,
                    drop: stores_to_be_deleted,
                    stores:list_of_stores
                });

// ... Add objects to a store
db.put(items, 'into_store').done(onsuccess);

//.. And delete objects from a store
db.remove('from_store', conditionFunc).done(onremoval);

//.. And not to forget fetching objects from a store
db.select('from_my_store', conditionFunc).done(function (items){

    console.log(items)
}); 
```

希望你喜欢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-27T08:57:26.247

对不起，但完全忘记了这个线程。

我设法使用 $.indexedDB().done() 函数解决了这个问题，该函数允许我在当前狡猾的过程之后运行代码。

# css - 为什么选择的宽度在 IE8 中不起作用？

> ID：12916591
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:11:13.207
> 
> 标签：css

我将选择字段放在我的页面中，但宽度规则不适用于 IE8，但在 Firefox 和 chrome 中可以正常工作？您可以在此处查看代码：http: [//jsfiddle.net/48ucG/](http://jsfiddle.net/48ucG/) 有什么帮助我遇到这个问题的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:17:09.710

我还没有 IE8 可以尝试，所以这是在黑暗中的一个小镜头：

试试这个：

```
.width_2, width_2 option {
    width: 144px;
} 
```

确保选项元素以及选择具有明确的宽度参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:29:51.697

我在玩小提琴，在规则中添加高度似乎可以解决它，你将不得不调整它的位置，但我能够让它以那个宽度出现。[这里](http://jsfiddle.net/48ucG/4/)希望对你有所帮助

# php - 使用 PHP 的 jQuery 自动建议

> ID：12916592
> 
> 赞同：2
> 
> 时间：2012-10-16T14:11:14.257
> 
> 标签：php, javascript, jquery

第一个问题是我有一个自动完成功能，当我完成输入名字时，它可以正常工作，但是当我按空格键继续输入姓氏时，div 会隐藏并且不会继续搜索结果。我遗漏了一些东西在 php 文件或 jquery 文件中。

这是搜索栏

```
<form method='post' action='index2.php#profile_info.php'>
    <input type="text"  id='inputSearch' placeholder="Search"  autocomplete="off" class="search" />
    <input type='submit' id='Search_Submit' value='' />
</form>
<div id="divResult"</div> 
```

这是查询数据库的 search.php 文件

```
<?php
include('connect.php');
if($_POST)
{
$q=$_POST['searchword'];
$sql_res=mysql_query("SELECT user_id, firstname, lastname, email, country, gender from users where firstname like '%$q%' OR lastname like '%$q%' order by email_activated='1' LIMIT 5");
while($row=mysql_fetch_array($sql_res))
{

$id = $row['user_id'];  
$firstname=$row['firstname'];
$lastname=$row['lastname'];
$email=$row['email'];
$country=$row['country'];
$Gender=$row['gender'];
$cacheBuster = rand(999999999,9999999999999);

$check_pic = "members/$id/image01.jpg";
    $default_pic = "members/image01.jpg";
    if (file_exists($check_pic)) {
    $users_pic ="$check_pic?$cacheBuster"; // forces picture to be 100px wide and no more
    }else {
    $users_pic = "images/profiles/".$Gender."_small.jpg"; // forces default picture to be 100px wide and no more

}

$b_firstname='<b>' .$q. '</b>';
$b_lastname='<b>'.$q.'</b>';
$final_firstname = str_ireplace( $q, $b_firstname, $firstname);
$final_lastname = str_ireplace( $q, $b_lastname, $lastname);
?>
<div class="display_box" align="left" >
<a href="http://localhost/MyNewSite/index2.php?user_id='<?php echo $id; ?>'#status.php" target="_self"> <img src="<?php echo $users_pic; ?>" style="width:55px; height:50px; float:left; margin-right:6px;" /></a><span class="name"><a href="http://localhost/MyNewSite/index2.php?user_id='<?php echo $id; ?>'#status.php" target="_self" class="friendsLink"><?php echo " $final_firstname $final_lastname"; ?> </a></span>&nbsp;<br/><span style="font-size:10px; margin-left:6px;"><?php echo $email; ?></span><br/>
<span style="font-size:10px; color:#C40000; margin-left:6px;"><?php echo $country; ?></span></div>

<?php
}
}
?> 
```

和 jquery 加载 div

```
$(function(){
$(".search").keyup(function() 
{ 
var inputSearch = $(this).val();
var dataString = 'searchword='+ inputSearch;
if(inputSearch!='')
{
    $.ajax({
    type: "POST",
    url: "search.php",
    data: dataString,
    cache: false,
    success: function(html)
    {
    $("#divResult").html(html).show();
    }
    });
}return false;    
});

jQuery("#divResult").live("click",function(e){ 
    var $clicked = $(e.target);
    var $name = $clicked.find('.name').html();
    var decoded = $("<div/>").html($name).text();
});
jQuery(document).live("click", function(e) { 
    var $clicked = $(e.target);
    if (! $clicked.hasClass("search")){
    jQuery("#divResult").fadeOut(); 
    }
});
$('#inputSearch').click(function(){
    jQuery("#divResult").fadeIn();
});
});

jQuery(function($){
   $("#inputSearch").Watermark("Search");
   }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T01:56:11.883

这是 where 查询，非常感谢 Michal Klouda 提供的问题所在的提示。

```
$sql_res=mysql_query("SELECT user_id, firstname, lastname, email, country, gender
FROM users where lower(concat_ws(' ', firstname, lastname)) like '%$q%' ORDER BY email_activated =  '1'
LIMIT 5"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:15:08.027

当您在名字后键入空格时，它不会返回任何内容，因为搜索短语按原样传递，并分别在`firstname`和`lastname`列中查找。查看您的查询：

```
SELECT user_id, firstname, lastname, email, country, gender 
from users 
where firstname like '%$q%' OR lastname like '%$q%'  /* <- here's the problem */
order by email_activated='1' LIMIT 5 
```

如果您的表中有 John Smith，则不会找到他，因为`"John"` **不像** `"%John %"`.

您将需要更改 where 子句。你可以试试：

```
where firstname + ' ' + lastname like '%$q%' or
      lastname + ' ' + firstname like '%$q%' 
```

# objective-c - Sudzc 响应问题 (iOS ARC)

> ID：12916602
> 
> 赞同：1
> 
> 时间：2012-10-16T14:11:51.010
> 
> 标签：objective-c, ios, soap, sudzc

我目前遇到了 Sudzc 生成的代码的问题。（对于基于 ARC 的 iOS）

使用生成的代码调用肥皂网络服务工作正常，当我需要检索响应时出现问题。

我目前处理这样的呼叫响应：

```
-(void)userLoginCompleted:(id)value
{
    if([value isKindOfClass:[NSError class]])
    {
        NSLog(@"%@",value);
    }

    if([value isKindOfClass:[SoapFault class]])
    {
        NSLog(@"%@",value);
    }

    if([value isKindOfClass:[IWWSLoginResult class]])
    {
        IWWSLoginResult *loginData  = (IWWSLoginResult*)value;
        NSLog(@"LoginData Result: %i",loginData.Result);
        NSLog(@"LoginData AccessToken: %@",loginData.AccessToken)
        //Other login related stuff here
    }
} 
```

每当使用 NSError 或 SoapFault 调用此代码时，代码运行良好（也就是说，它将解析日志中的错误）。

但是，当使用 IWWSLoginResult 作为参数调用它时，`Result`和`AccessToken`属性分别是`NO`和`(null)`，即使 Sudzc 代码的日志显示如下`ResponseEnvelope`：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <UserLoginResponse xmlns="[Omitted]">
           <UserLoginResult>
              <Result>true</Result>
              <AccessToken>[Omitted]</AccessToken>              
           </UserLoginResult>
        </UserLoginResponse>
    </soap:Body>
</soap:Envelope> 
```

`AccessToken and xmlns-url ommitted, but present`

这是生成的 SudzC 代码中的错误，还是我的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T12:18:35.680

SudzC 在soap 结果消息中检查`<body>`标签，但大多数.Net web 服务使用`<soap:body>`标签。这很可能会使框架认为没有结果，因此将结果的值默认为 false 或 null。

要解决此问题，请更改 SoapRequest.m 文件中的以下元素：

```
CXMLNode *element = [[Soap getNode: [doc rootElement] withName: @"Body"] childAtIndex:0]; 
```

到

```
CXMLNode *element = [[Soap getNode: [doc rootElement] withName: @"soap:Body"] childAtIndex:0]; 
```

# linux - mmap内存保护PROT_NONE的目的是什么

> ID：12916603
> 
> 赞同：23
> 
> 时间：2012-10-16T14:11:51.183
> 
> 标签：linux, memory, mapping, mmap

我正在阅读以下[文档](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)`mmap`并落在了这条线上：

> **PROT_NONE**页面可能无法访问。

将文件映射到内存但从不访问它有什么用处？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-17T13:44:43.673

`PROT_NONE`可以用来实现[保护页](https://www.us-cert.gov/bsi/articles/knowledge/coding-practices/guard-pages)，微软也有同样的概念（[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366549(v=vs.85).aspx)）。

引用第一个链接：

> ...在内存分配操作期间分配额外的不可访问内存是一种减轻利用堆缓冲区溢出的技术。这些保护页是放置在一页或更大的所有内存分配之间的未映射页。保护页面在任何访问时都会导致分段错误。

因此在实现对网络接口、虚拟机和解释器等领域的保护时很有用。示例用法：[pthread_attr_setguardsize, pthread_attr_getguardsize](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_attr_getguardsize.3.html)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-12-01T14:20:45.597

PROT_NONE 分配一个没有授予权限的连续虚拟内存区域。

正如其他人所提到的，这对于实现警卫（出于查找错误和安全目的而导致段错误的页面）或“魔术”指针可能很有用，其中 PROT_NONE 映射中的值将被解释为指针以外的东西.

另一种用途是当应用程序希望将多个独立映射映射为*虚拟连续*映射时。这将通过首先使用 PROT_NONE 映射足够大的块，然后使用 MAP_FIXED 标志和在 PROT_NONE 映射区域内设置的地址执行其他 mmap 调用来完成（使用 MAP_FIXED 会自动取消映射正在“覆盖”的映射的一部分”）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-06T21:06:01.663

一种可能的应用：您可以使用它来保留内存范围。分配这样一个区域后，您可以使用指向该范围的指针作为*特殊*值。

一个可能的应用程序是一个库，它可以透明地在“小”和“大”整数之间切换，并采用一种小值优化的形式。一个大整数将表示为指向保存实际数字的内存区域的指针。一个小整数将是指向此保留内存区域的指针，表示等于该区域的偏移量的数字。（我并不是说这是实现这样一个库的最佳方法，只是说它应该是可能的。）

# css - 停止CSS动画后滚动页面时如何防止工件出现在Webkit中

> ID：12916606
> 
> 赞同：4
> 
> 时间：2012-10-16T14:11:53.813
> 
> 标签：css, webkit, css-animations, mobile-webkit

在某些情况下，我必须停止 CSS 关键帧动画。如果我之后滚动页面，我倾向于在屏幕上收到伪影。它们出现在我停止动画之前的 div 位置。有时我会从原始位置到先前动画 div 的新位置获得这些工件的“轨迹”。

在桌面 Chrome 中，通常我只看到一个工件（重绘工件会擦除它），但在 iOS Safari 中，我有一个混乱的痕迹。

我尝试使用不同的方法停止 CSS 动画，但总是得到相同的结果。我向 div 添加了一个类，它定义了一个新位置（顶部/左侧，div 本身位于相对位置），以及一个停止动画的属性，我尝试了：

1.  将动画持续时间设置为最小。
2.  将 -webkit-animation 设置为“无”
3.  使用 -webkit-animation-play-state 暂停动画

这些都没有修复工件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-01T18:27:04.590

将此添加到调用动画的 css 中：

```
-webkit-transform: translate3d(0,0,0); 
```

它强制硬件加速。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-09T13:53:52.633

我也有这个问题。

**translate3d**应该应用于所有参与显示工件的子项。

为滚动容器和其中的所有子容器工作的 CSS

```
.scrolling-container {
    overflow: auto;
    -webkit-overflow-scrolling: touch;
}

.scrolling-container .child-element {
    position: relative;
    -webkit-transform: translate3d(0,0,0);
} 
```

# sql-server-2008 - SSRS BIDS 更改元标记

> ID：12916609
> 
> 赞同：2
> 
> 时间：2012-10-16T14:11:58.573
> 
> 标签：sql-server-2008, reporting-services, ssrs-2008, bids

使用 SSRS BIDS/SQL Server 2008 R2 开发报告时，无论如何您都可以更改用于报告的元标记或 css。

我想将此添加到相关报告部分的标题中：

```
<meta http-equiv="X-UA-Compatible" content="IE=7"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T13:27:49.557

我也试图找到一种正式的方法来实现这一目标，但到目前为止我还没有成功。我的 hack 方法似乎可以完成工作，是更新位于以下路径下的文件*ReportViewer.aspx 。*

> Microsoft SQL Server\MSRS11.MSSQLSERVER\Reporting Services\ReportServer\Pages

只需将元标记添加到 head 部分。

# oracle - EXTRACT() 24 小时格式的小时

> ID：12916611
> 
> 赞同：17
> 
> 时间：2012-10-16T14:12:04.320
> 
> 标签：oracle

我有类似下面的东西-

```
EXTRACT(HOUR from CAST(to_char(tran_datetime,'DD-MON-YYYY HH24:MI:SS') AS TIMESTAMP)) 
```

`tran_datetime`是`DATE`类型。这会给某些行说错误`HOUR must be between 1 and 12`，所以我知道它不能以`24 Hour`格式（或军事时间）处理 Hour。以下作品（显然） -

```
EXTRACT(HOUR from CAST(to_char(tran_datetime,'DD-MON-YYYY HH:MI:SS') AS TIMESTAMP)) 
```

或者

```
EXTRACT(HOUR from CAST(tran_datetime AS TIMESTAMP))  --12 Hr format by default 
```

有没有办法使用`EXTRACT()`24`HOUR`小时格式，即 15 表示下午 3 点，13 表示下午 1 点等。

请注意 -`to_char(tran_datetime,'HH24')`是一个非常明显的选项，但我希望`EXTRACT()`专门使用功能。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-16T15:04:00.597

问题不在于`extract`，它当然可以处理“军事时间”。看起来你有一个默认的时间戳格式，`HH`而不是`HH24`; 或者至少这是我能看到重新创建它的唯一方法：

```
SQL> select value from nls_session_parameters
  2  where parameter = 'NLS_TIMESTAMP_FORMAT';

VALUE
--------------------------------------------------------------------------------
DD-MON-RR HH24.MI.SSXFF

SQL> select extract(hour from cast(to_char(sysdate, 'DD-MON-YYYY HH24:MI:SS')
  2  as timestamp)) from dual;

EXTRACT(HOURFROMCAST(TO_CHAR(SYSDATE,'DD-MON-YYYYHH24:MI:SS')ASTIMESTAMP))
--------------------------------------------------------------------------
                                                                        15

alter session set nls_timestamp_format = 'DD-MON-YYYY HH:MI:SS';

Session altered.

SQL> select extract(hour from cast(to_char(sysdate, 'DD-MON-YYYY HH24:MI:SS')
  2  as timestamp)) from dual;

select extract(hour from cast(to_char(sysdate, 'DD-MON-YYYY HH24:MI:SS') as timestamp)) from dual
                              *
ERROR at line 1:
ORA-01849: hour must be between 1 and 12 
```

因此，简单的“修复”是将格式设置为可以识别 24 小时的格式：

```
SQL> alter session set nls_timestamp_format = 'DD-MON-YYYY HH24:MI:SS';

Session altered.

SQL> select extract(hour from cast(to_char(sysdate, 'DD-MON-YYYY HH24:MI:SS')
  2  as timestamp)) from dual;

EXTRACT(HOURFROMCAST(TO_CHAR(SYSDATE,'DD-MON-YYYYHH24:MI:SS')ASTIMESTAMP))
--------------------------------------------------------------------------
                                                                        15 
```

尽管您根本不需要`to_char`：

```
SQL> select extract(hour from cast(sysdate as timestamp)) from dual;

EXTRACT(HOURFROMCAST(SYSDATEASTIMESTAMP))
-----------------------------------------
                                       15 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-16T14:42:23.907

```
select to_char(tran_datetime,'HH24') from test;

TO_CHAR(tran_datetime,'HH24')
------------------
16 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-05T16:30:21.330

简单易行的解决方案：

```
select extract(hour from systimestamp) from dual;

EXTRACT(HOURFROMSYSTIMESTAMP)
-----------------------------
                           16 
```

# .net - 为什么 SHA512Managed 不符合 FIPS 标准？

> ID：12916612
> 
> 赞同：4
> 
> 时间：2012-10-16T14:12:05.847
> 
> 标签：.net, security, encryption, hash

正如标题所问，为什么 SHA512Managed 加密会导致`InvalidOperationException`机器上的 FipsAlgorithmPolicy 处于活动状态？

它对 FIP 标准来说不够安全，还是太安全了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:36:21.143

FIPS 不是一个单一的标准，而是一套广泛的标准。

“FIPS-compliant”是一个多余的术语——任何由 FIPS 定义的算法实现都是兼容的，否则它不会与其他实现互操作。

现在，存在 FIPS 140-2 - 定义什么可以被视为“安全”环境的规则集（主要是管理和 IT 相关，而不是纯粹的编程相关）。

现在我们更接近了……该算法可以通过“FIPS 认证”，即被认证机构批准为满足包括 FIPS 140-2 在内的各种标准要求的算法。

当您启用 FIPS 模式时，您实际上要求仅使用 FIPS 认证的 Windows 模块。而且 Windows 并没有对所有加密模块进行认证 - 认证既昂贵又耗时，因此只有某些本机（非托管）模块经过认证，并且只有这些模块的特定版本经过认证。

简而言之 - SHA512Managed 类未经认证，因此不符合政策要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T17:43:04.183

FIPS140-x 通常处理加密模块，它们更多的是关于验证加密实施情况的工作量。

现在 FIPS180-4 完全是关于安全散列标准的，您可以在那里找到有关 SHA512 及其所有变体的详细信息。也许 SHA512Managed 没有做 FIPS180 同意的事情，或者可能只是没有评估该操作模式。

# c# - DI - 创建服务对象

> ID：12916616
> 
> 赞同：0
> 
> 时间：2012-10-16T14:12:15.533
> 
> 标签：c#, asp.net-mvc-4, ninject

[注意：我的 NinjectDependencyResolver 类位于此问题的底部。]

## 设置：

在 ASP.NET MVC 4 应用程序中，我有使用服务的控制器。

每个服务都有一个 IUnitOfWork 接口作为构造函数参数。例如：

```
public ClientService(IUnitOfWork uow){ //... } 
```

在 Global.asax.cs 类中注册一个适当编写`NinjectDependencyResolver : IDependencyResolver`的类允许这些服务正确实例化并且一切正常。到目前为止，一切都很好。

但是，在某些情况下，服务需要在其他一些代码中实例化，例如，在属性中。例如：

```
namespace MyApp.Domain.Attributes
{
    public class AuthorizeUnprocessedOnlyAttribute : AuthorizeAttribute
    {
        protected override bool AuthorizeCore(HttpContextBase httpContext)
        {
            bool isUnprocessed = false;

            string usuario = string.Empty;
            if (httpContext.User.Identity.IsAuthenticated)
            {
                // THIS IS THE LINE WHERE DI IS NEEDED!!
                ClientService service = new ClientService();
                usuario = httpContext.User.Identity.Name;
                isUnprocessed = service.IsUnprocessed(usuario);
            }

            return isUnprocessed;
        }
    }
} 
```

我的问题是这条线：

```
ClientService service = new ClientService(); 
```

我不得不给 ClientService 一个无参数的构造函数，如下所示：

```
public ClientService() : this (new UnitOfWork()) {} 
```

这似乎完全反对 DI。

这样做的原因是我不确定如何在属性代码中注入依赖项。控制器是由 ControllerFactory 实例化的，所以我在不知不觉中度过了难关。

即，我对 Ninject 或 IDependencyResolver 的了解不够……

## 问题一：

那么，我怎样才能超越我的`'Ignorance Pattern'`？

我应该按照以下方式获取我的 ClientService 对象：

```
NinjectDependencyResolver ndr = new NinjectDependencyResolver();
IUnitOfWorkMR uow = ndr.Kernel.Get<IUnitOfWorkMR>();
IClientService service = new ClientService(uow); 
```

即使第一个问题的答案是“是”，我也不太高兴：

我仍然需要实例化 ClientService 的实例，所以现在我必须将 IClientService 接口绑定到 NinjectDependencyResolver 类中正确构造的 ClientService 实例。

这个我不知道该怎么做，所以这是我的第二个问题：

## 问题2：

如何菊花链 IUnitOfWork 构造参数的依赖注入以正确实例化 ClientService？（请参阅下面我注释掉的努力 - 我将其注释掉是因为它对我来说甚至没有意义 - 我不应该创建 UnitOfWork 的新实例，不是吗？）：

## NinjectDependencyResolver 类：

```
namespace MyApp.Domain.Infrastructure
{
    public class NinjectDependencyResolver : IDependencyResolver
    {
        private IKernel kernel;

        public NinjectDependencyResolver()
        {
            kernel = new StandardKernel();
            AddBindings();
        }

        public object GetService(Type serviceType)
        {
            return kernel.TryGet(serviceType);
        }

        public IEnumerable<object> GetServices(Type serviceType)
        {
            return kernel.GetAll(serviceType);
        } 

        public IBindingToSyntax<T> Bind<T>()
        {
            return kernel.Bind<T>();
        }

        public IKernel Kernel
        {
            get { return kernel; }
        }

        private void AddBindings()
        {
            kernel.Bind<IUnitOfWorkMR>().To<UnitOfWorkMR>().InRequestScope();
            // kernel.Bind<IClientService>().To<ClientService>().WithConstructorArgument("uow", new UnitOfWork());
        }
    }
} 
```

## 笔记：

我已经更正了 WithConstructorArgument 中的错误（它缺少参数名称）。

编辑：

在测试中，令人难以置信的事情发生了：问题 1 中的代码有效。至于问题 2，NinjectDepenedencyResolver 类中的以下更改突然释放了一个工作应用程序（这样的事情确实很少见）：

```
kernel.Bind<IUnitOfWorkMR>().To<UnitOfWorkMR>().InRequestScope();
            kernel.Bind<IClientService>().To<ClientService>().InRequestScope(); 
```

即，我删除了 WithConstructorArgument 调用。据推测，Ninject 有一个 UnitOfWork 的工作实例，它使用它来实例化我的服务。所以，没有更多的无参数构造函数......

但这是 RWTDI（正确的方法）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T20:13:40.730

是的，这是配置绑定的正确方法。这就是 DI 容器的全部意义所在，它根据构造函数的参数和您配置的内容确定要注入的内容。

但是，我发现您的 NinjectDependcyResolver 很奇怪。为什么不直接使用 Ninject.MVC3？（它也适用于 MVC4）。这将自动为 MVC 设置 DependencyResolver，您将在 App_Start\NinjectWebCommon.cs 中配置映射

对于您的属性，正确的方法是使用随 Ninject.MVC3 自动安装的 BindFilter 扩展。您可以像这样配置它：

```
kernel.BindFilter<MyAuthorization>(FilterScope.Action, 0)
    .WhenActionMethodHas<MyAuthorization>(); 
```

然后 Ninject 将自动处理注入其中的任何已配置对象。

这消除了从属性内部调用 GetService 的需要（这总是一种代码味道），并使一切协同工作。

至少，使用 Ninject.MVC3 设置您的 MVC 应用程序，然后在过滤器中，如果您真的想调用 GetService，然后使用 MVC DependencyResolver（Ninject.MVC 自动注册）并执行以下操作：

```
var x = DependencyResolver.Current.GetService<MyType>(); 
```

但同样，您应该真正使用 BindFilter 语法。

# jquery - JQuery 追加然后删除

> ID：12916620
> 
> 赞同：3
> 
> 时间：2012-10-16T14:12:30.867
> 
> 标签：jquery, append, detach

小提琴： http: [//jsfiddle.net/YbfZG/4/](http://jsfiddle.net/YbfZG/4/)出于某种原因，toggleDiv/removeDiv 函数无法正常工作（我没有经常使用 jsfiddle），但希望这能让您更好地了解我是什么试图完成。

我有一个页面，用户可以通过从下拉列表中进行选择来动态添加项目（div）。这是通过 .append() 完成的。他们还可以删除一个项目 (.remove()) 并可能重新添加它。每个 div 都包含一个通过单击链接触发的隐藏/显示区域。

第一次将 div 添加到页面时，隐藏/显示区域可以正常工作。如果相同的 div 被删除然后重新添加，则隐藏/显示不再起作用。我相信这是因为 div 没有完全从 DOM 中删除，因此基于 id 操作的隐藏/显示功能无法找到正确的 div 来处理。

我尝试将删除功能修改为 $(this).empty().remove(); 但这没有用。我也尝试过使用分离，但功能没有变化。我做了一些阅读，我可能需要使用 .on()，但我不确定如何构建它。

ETA：附加和切换代码并将 div 名称更改为不仅仅是数字（我的错字）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:16:09.430

如果您将标记更改为：

```
<div id="8" class="wrapper">
    <div>
    <a title="Remove" class="remove" href="#">Remove</a>
    </div>
</div> 
```

（基本上我在主 div 中添加了一个“包装器”类，在删除链接中添加了一个“删除”类）

因此，您将摆脱该`onclick`属性并改用一个简单的函数：

```
$('body').on('click','a.remove',function(){
    $(this).closest('div.wrapper').remove();
});​ 
```

[**演示**](http://jsfiddle.net/gionaf/7xuBE/)

* * *

鉴于您的完整代码，以下是如何使其工作（**[演示](http://jsfiddle.net/gionaf/PkEXm/)**）：

```
$(function() {

    $('.elements').on('click', '.remove', function() {
        $(this).closest('div[id^=div]').remove();
    });

    $('.elements').on('click', '.open-close', function() {
        var hideShowN = $(this).closest('div[id^=div]').attr('id').replace(/\D/g,'');
        $('#hide_show_'+hideShowN).toggle();
    });

    $('.add').on('click', function() {
        $('.elements').append('<div id="div_8">Element<a class="open-close" href="#" title="Open/Close">Open/Close</a><div id="hide_show_8" style="display: none;">Stuff</div><a class="remove" href="#" title="Remove">Remove</a></div>');
    });

});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:30:13.540

我建议您在使用 jQuery 时使用侦听器，它更清洁且通常更容易。

我用我认为你需要的东西做了一个 jsfiddle。在这里检查：http: [//jsfiddle.net/YbfZG/2/](http://jsfiddle.net/YbfZG/2/)。

此示例中重要的是删除元素的侦听器正在侦听“元素”div，而不是删除按钮。当侦听器被触发时，它会检查点击是否在“.element .remove”内，如果是，则执行该函数。

这很重要，因为如果您将侦听器直接放在“.element .remove”上，那么通过“添加”按钮新添加的类将失败，因为它们是在 jQuery 附加侦听器之后添加的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:17:44.623

我以前也遇到过类似的问题。我相信这是由同一件事引起的。问题是您在删除/读取 div 时需要重新绑定单击处理程序。我所做的是创建一个绑定处理程序的函数，并在出现这种情况时调用它，即从 DOM 中添加/删除元素。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:19:01.410

使用[.detach](http://api.jquery.com/detach/)而不是 remove 来保留事件绑定。从文档中引用。

> .detach() 方法与 .remove() 方法相同，不同之处在于 .detach() 保留与已删除元素关联的所有 jQuery 数据。当移除的元素稍后要重新插入到 DOM 中时，此方法很有用。

# android - 通过 ContentProvider 缓存 Android 位图

> ID：12916621
> 
> 赞同：2
> 
> 时间：2012-10-16T14:12:32.550
> 
> 标签：android, android-contentprovider, simplecursoradapter, bitmapcache

我正在尝试解决一个有点棘手的问题。我有一个通过自定义 BaseAdapter 从远程服务器获取图像的网格视图。相关代码如下。

```
//The gridview
pictureAdapter = new PictureAdapter(cont, document, thumbWidth);

GridView gridview = (GridView) findViewById(R.id.pictures_gridview);
gridview.setColumnWidth(thumbWidth);
gridview.setAdapter(pictureAdapter); 
```

网格视图的定义非常简单......

```
//The adapter
public class PictureAdapter extends BaseAdapter {
    private Context mContext;
    private JSONArray mPics;
    private List<String> mThumbs;
    private List<String> mViews;
    private List<Integer> mIds;
    private int thumbWidth;
    private SparseArray<Bitmap> imageData;
    private boolean isFlinging;

    public PictureAdapter(Context c, JSONArray pics, int thumbWidth) {
        mContext = c;
        mPics = pics;
        this.thumbWidth = thumbWidth;
        setPicThumbs();
        imageData = new SparseArray<Bitmap>();

    }

    public void setFlinging(boolean isFlinging) {
        this.isFlinging=isFlinging;
    }

    public boolean getFlinging() {
        return this.isFlinging;
    }

    private void setPicThumbs() {
        mThumbs = new Vector<String>();
        mViews = new Vector<String>();
        mIds = new Vector<Integer>();
        for(int i=0; i<mPics.length(); i++) {
            JSONObject row;
            try {
                row = mPics.getJSONObject(i);
                mThumbs.add(row.getString("thumb"));
                mViews.add(row.getString("view"));
                mIds.add(row.getInt("id"));
            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    }

    public int getCount() {
        return mThumbs.size();
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    public void setThumbWidth(int width) {
        thumbWidth = width;
    }

    public List<String> getViews() {
        return mViews;
    }

    public View getView(final int position, final View convertView, ViewGroup parent) {
        final PycsellImageView imageView;
        String imageUrlDirty = mThumbs.get(position);
        String imageUrlClean = imageUrlDirty.split("\\?")[0];

        if (convertView == null) {  // if it's not recycled, initialize some attributes
            imageView = new PycsellImageView(mContext, mIds.get(position));
            imageView.setLayoutParams(new GridView.LayoutParams(thumbWidth+3, thumbWidth+3));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(0, 0, 0, 0);
            //imageView.setVisibility(View.INVISIBLE);
        } else {
            imageView = (PycsellImageView) convertView;
            imageView.setPicId(mIds.get(position));
            if(imageView.getCurrentDrawable() != mThumbs.get(position) || isFlinging == true) {
                imageView.setImageDrawable(null);
                imageView.setCurrentDrawable("");
            }

           // imageView.setVisibility(View.INVISIBLE);
        }

        if(imageData.get(position) != null) {
            if (imageView.getDrawable() == null) {
                imageView.startFade();
            }
            imageView.setImageBitmap(imageData.get(position));
            imageView.setCurrentDrawable(mThumbs.get(position));
        } 

        else if (isFlinging == false) {
            //Log.d("Picture Adapter", "Getting album thumb: "+imageUrlClean);

            DownloadHelper downloadHelper = new DownloadHelper() {

                public void OnFailure(String response) {
                    Log.e("Picture Adapter", response);
                }

                public void OnSucess(Bitmap bitmap) {
                    if (imageView.getDrawable() == null) {
                        imageView.setImageBitmap(bitmap);
                        imageView.setCurrentDrawable(mThumbs.get(position));
                        imageView.startFade();
                    }
                    imageData.put(position, bitmap);
                }
            };

            new ImageTask(mContext, downloadHelper, imageUrlClean).execute();
        }

        return imageView;
    }

} 
```

适配器中的大部分代码与此无关，但我将其完整呈现。您会注意到请求图像是通过 DownloadHelper AsyncTask 下载的，并放置在本地 SparseArray 中。如果必须再次显示图像，它将从此数组中获取，而不是重新下载。

显然，这是非常糟糕的，因为可能存在大量图像。这只是一个占位符解决方案。我显然想实现更强大的图像缓存，因为这些图像在下载后也必须离线可用。问题是……我不知道怎么做。

我已经实现了一个数据库......

```
public class PycsellDatabase extends SQLiteOpenHelper {
    private static final int DB_VERSION = 1;
    private static final String DB_NAME = "pycsell_data";

    public static final String TABLE_ALBUMS_IMAGES = "albums_and_images";
    public static final String ID="_id";
    public static final String COL_TYPE="type";
    public static final String COL_PYCID="pycsell_id";
    public static final String COL_THUMB="thumb";
    public static final String COL_VIEW="view";
    public static final String COL_ALBUM="album";
    public static final String COL_TITLE="title";
    public static final String COL_PICNUM="picnum";
    private static final String CREATE_TABLE_ALBUMS_IMAGES = "create table" + TABLE_ALBUMS_IMAGES + "("
            + ID + "integer primary key autoincrement"
            + COL_TYPE + "integer not null"
            + COL_PYCID + "integer not null"
            + COL_THUMB + "text not null"
            + COL_VIEW + "text"
            + COL_ALBUM +"integer"
            + COL_TITLE + "text"
            + COL_PICNUM + "integer);";

    private static final String DB_SCHEMA = CREATE_TABLE_ALBUMS_IMAGES;

    public PycsellDatabase(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(DB_SCHEMA);
    }
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_ALBUMS_IMAGES);
        onCreate(db);
    }
} 
```

...和（部分）内容提供者...

```
public class BitmapProvider extends ContentProvider {
    private PycsellDatabase pDB;
    private static final String AUTHORITY = "com.atlantbh.pycsell.db.BitmapProvider";
    public static final int ALBUMS=100;
    public static final int IMAGES=110;
    public static final int SINGLE_IMAGE=120;
    private static final String ALBUMS_IMAGES_BASE_PATH = "albums_images";
    public static final Uri CONTENT_URI = Uri.parse("content://" + AUTHORITY + "/" + ALBUMS_IMAGES_BASE_PATH);
    public static final String CONTENT_ITEM_TYPE = ContentResolver.CURSOR_ITEM_BASE_TYPE+"/album_image";
    public static final String CONTENT_TYPE = ContentResolver.CURSOR_DIR_BASE_TYPE+"/album_image";

    private static final UriMatcher sURIMatcher = new UriMatcher(
            UriMatcher.NO_MATCH);
    static {
        sURIMatcher.addURI(AUTHORITY, ALBUMS_IMAGES_BASE_PATH, ALBUMS);
        sURIMatcher.addURI(AUTHORITY, ALBUMS_IMAGES_BASE_PATH + "/#", IMAGES);
        sURIMatcher.addURI(AUTHORITY, ALBUMS_IMAGES_BASE_PATH + "/#/#", SINGLE_IMAGE);
    }

    @Override
    public boolean onCreate() {
        pDB = new PycsellDatabase(getContext());
        return true;
    }

    @Override
    public Cursor query(Uri uri, String[] projection, String selection,
            String[] selectionArgs, String sortOrder) {
        SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
        queryBuilder.setTables(PycsellDatabase.TABLE_ALBUMS_IMAGES);
        int uriType = sURIMatcher.match(uri);
        switch (uriType) {
        //1 = albums, 2 = images
        case ALBUMS:
            queryBuilder.appendWhere(PycsellDatabase.COL_TYPE+"= 1");
            break;

        case IMAGES: 
            queryBuilder.appendWhere(PycsellDatabase.COL_TYPE+"= 2");
            queryBuilder.appendWhere(PycsellDatabase.COL_ALBUM+"="+uri.getLastPathSegment());
            break;

        case SINGLE_IMAGE:
            List<String> segments = uri.getPathSegments();
            queryBuilder.appendWhere(PycsellDatabase.COL_TYPE+"= 2");
            queryBuilder.appendWhere(PycsellDatabase.COL_ALBUM+"="+segments.get(0));
            queryBuilder.appendWhere(PycsellDatabase.COL_PYCID+"="+segments.get(1));
            break;
        }

        Cursor cursor = queryBuilder.query(pDB.getReadableDatabase(), projection, selection, selectionArgs, null, null, sortOrder);
        cursor.setNotificationUri(getContext().getContentResolver(), uri);
        return cursor;
    }

    @Override
    public int delete(Uri uri, String selection, String[] selectionArgs) {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public String getType(Uri uri) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Uri insert(Uri uri, ContentValues values) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public int update(Uri uri, ContentValues values, String selection,
            String[] selectionArgs) {
        // TODO Auto-generated method stub
        return 0;
    }
} 
```

而且我相当确定我可以自己处理这些……我遇到的问题是实际的适配器。我知道如何实现游标适配器，但是我只能检查数据库，而不是执行“先下载，稍后从数据库获取”。我想逻辑是这样的：

*   通过提供者查询图片
*   将返回的光标传递给适配器
*   如果光标为空（即该图像在数据库中没有条目），则下载并将其放入数据库

但是，我不是 100% 确定这是这样做的方法。任何帮助将不胜感激。

最好的问候，达米尔 H。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:15:50.523

我强烈建议使用[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader "通用图像加载器")库来下载和缓存图像

您可以将库作为 JAR 文件下载，该文件可以轻松包含到任何 Android 项目中

来自官方页面的功能：

*   多线程图像加载
*   可以广泛调整 ImageLoader 的配置（线程池大小、HTTP 选项、内存和磁盘缓存、显示图像选项等）
*   在内存和/或设备的文件系统（或 SD 卡）中缓存图像的可能性
*   “听”加载过程的可能性
*   可以使用单独的选项自定义每个显示图像调用
*   小部件支持

# jquery - jQuery 的数组和元素

> ID：12916627
> 
> 赞同：0
> 
> 时间：2012-10-16T14:12:42.973
> 
> 标签：jquery, arrays

我正在构建一个包含这样一些元素的数组：

```
var listAccordions = [];
$("#accordeon ul.sub-menu.ui-accordion").each(function() { 
listAccordions.push("#" + $(this).parent().attr('id') + " ul.sub-menu");
}); 
```

这里一切正常，我有我的数组，很好，现在我想像这样使用它：

```
$( listAccordions ).hide(); 
```

但这似乎不起作用？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:16:36.060

你可以这样做：

```
$(listAccordions.join(',')).hide(); 
```

但合理的问题是：为什么需要这样的数据结构？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:14:09.900

您将不得不遍历`listAccordions`并调用`hide`每一个。

```
for (var i = 0; i < listAccordions.length; i++) {
   $(listAccordions[i]).hide();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:14:28.357

`listAccordions`在内存中，而不是 DOM。您可以为这些元素添加类名，然后使用类名隐藏它们 - 如果您打算将此集合用于其他用途。否则，将它们隐藏在循环中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:14:57.077

```
$.each(listAccordions,function(i,item) {
  $("#"+item).hide();
}); 
```

将工作。你的数组是一个字符串数组

```
var listAccordions = [];
$("#accordeon ul.sub-menu.ui-accordion").each(function() { 
  listAccordions.push($("#" + $(this).parent().attr('id') + " ul.sub-menu"));
});

listAccordions.each(function() {
  $(this).hide()
}); 
```

也应该工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T14:16:16.450

尝试类似的东西

```
$(listAccordions).each(function() {
    $(this).hide();
} 
```

# jquery - jQuery load 事件到底什么时候触发？

> ID：12916630
> 
> 赞同：6
> 
> 时间：2012-10-16T14:12:46.327
> 
> 标签：jquery

我一直在这里和谷歌中寻找 jQuery .load() 事件何时触发（当然我的意思是图像的加载事件）？我并不是指加载带有图像的文档时的典型情况，我所知道的 - load 事件在我们以下时触发：

**1/ 将新的 img 添加到文档中：**

```
$('<img src="picture.jpg" />').appendTo('body'); 
```

**2/ 更改现有图像的 src 属性：**

```
$('img').attr('src' , 'new_path.jpg'); 
```

**3/ 创建新的 img 对象：**

```
var object = $('<img src="picture.jpg" />'); 
```

* * *

但是这些情况怎么办，因为我不确定：

**4/ 将图像附加到未添加到文档 (DOM) 的对象：**

```
var o = $('<div></div>');
o.append('<img src="picture.jpg" />'); 
```

*// 我的意思是**o**在 DOM 树中不存在，它没有附加*

**5/ 将带有 imgs 的内容加载到未添加到文档中的对象：**

```
var o = $('<div></div>');
o.load('url.html #pictures'); 
```

*// 我的意思是**o**在 DOM 树中不存在，它没有附加*

我将非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:35:37.930

对于数字 4，它似乎只在附加到内存对象时触发一次，而在附加到 DOM 时它不会再次触发。查看这个小提琴： http: [//jsfiddle.net/JxHe4/](http://jsfiddle.net/JxHe4/)并在 Chrome 工具或 Firebug 中观察网络流量和控制台输出。

Chrome、Firefox 和 IE9 之间的行为似乎是一致的。现在，这回答了您的部分问题（希望如此），但没有解释行为的原因。我的猜测是这是指定的方式（因为所有浏览器的行为都相似），但我找不到正式定义 onLoad 事件的规范。

对于数字 5，我不希望加载页面会影响图像加载，我不知道如何首先获得对这些图像的引用以将 .Load 处理程序附加到它们。

**[更新]**

[HTML4 规范的这段摘录](http://www.w3.org/TR/REC-html40/struct/objects.html#h-13.5)可以解释第 4 点中的行为：嵌入式文档（在这种情况下为 IMG）完全独立于它所嵌入的文档。例如，嵌入文档中的相对 URI 根据嵌入文档的基本 URI 而不是主文档的基本 URI 进行解析。嵌入文档仅在另一个文档中呈现（例如，在子窗口中）；它在其他方面保持独立。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:36:28.320

如果

4 - 您可以将元素附加到 var `o`，现在当您将 var 附加`o`到某个 DOM 时，它会附加包含 img 的 div。

5 - 如果是，在您的 var被转储到页面上`o.load`之前，内容不会被加载。`o`不过，您不会在控制台中收到相同的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:50:54.253

在大多数情况下，您的 #4 应该触发加载事件（缓存图像可能存在一些问题），但是 #5 可能会或可能不会取决于您绑定事件的位置以及图像加载的速度。如果您将事件绑定在 之后的行上`.load(url)`，它不会触发，因为图像尚不存在。如果你把它放在成功的 .load 调用中，如果它在你绑定它之前没有触发它可能会触发（竞争条件）。

# vspackage - 已部署的 VS 包未显示在包负载分析器中

> ID：12916631
> 
> 赞同：0
> 
> 时间：2012-10-16T14:12:50.197
> 
> 标签：vspackage

我开发了一个 vspackage。要进行部署，我已按照 MSDN 演练中的步骤进行操作：部署 VSPackage。完成演练后，我的包没有出现在包负载分析器中，我的包也没有被初始化。

我猜我错过了一步，但我不知道是哪一步。我完全按照 MSDN 记录的那样做。这是 VS2008 的一个包，我也想将它用于 VS 2010，但首先我希望它在 VS 2008 中工作。

更新我在 MSDN 中使用了 MSI 步骤。现在我的包显示在 de 包负载分析器中，但问题仍然是我的包只有在我在负载分析器中分析我的包时才会被加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T12:33:33.820

我自己解决了这个问题。起初，我遵循了 msdn 上解释的 xcopy 选项。但这没有用。然后我按照安装程序的步骤进行操作。这行得通，但由于 plk 验证错误，Package Load 分析器无法加载包，而我的 plk 信息是正确的。所以我使用了另一个 guid 因此生成了另一个完美运行的 plk。我描述的另一个问题通过使用 ProvideAutoLoad 属性得到了解决。

问候，基申

# iphone - 如何在应用程序的后台运行计时器？

> ID：12916633
> 
> 赞同：4
> 
> 时间：2012-10-16T14:12:51.117
> 
> 标签：iphone

我想减少倒计时的时间。因此，如果用户最小化应用程序，则应用程序加载背景。如何在应用程序后台运行计时器？我正在使用下面的代码。当应用程序最小化时，计时器停止。请帮我。

```
 timer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(timerCountDown) userInfo:nil repeats:YES];

- (void)timerCountDown
{
    if(secondsLeft > 0 ) {
        secondsLeft -- ;
        hours = secondsLeft / 3600;
        minutes = (secondsLeft % 3600) / 60;
        seconds = (secondsLeft %3600) % 60;
    }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-17T11:17:21.157

我得到了答案，它工作得很好。

```
UIBackgroundTaskIdentifier bgTask =0;
UIApplication  *app = [UIApplication sharedApplication];
bgTask = [app beginBackgroundTaskWithExpirationHandler:^{
    [app endBackgroundTask:bgTask];
}];

timer = [NSTimer
               scheduledTimerWithTimeInterval:1.0
               target:self
               selector:@selector(timerCountDown:)
               userInfo:nil
               repeats:YES]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T14:18:45.463

应用程序不会永远在后台运行；您不能保证应用程序关闭时计时器会继续。

在应用程序委托中，在 applicationDidEnterBackground 内，保存任何允许计时器在 applicationWillEnterForeground 时继续运行的数据。在您的特定情况下，使后台计时器无效，并在进入前台时再次启动它。使用您的 secondsLeft，您可能希望能够通过 NSDates 的差异来计算它，并保存开始和结束日期。

# spring - 模拟自动装配的@Resource 列表

> ID：12916637
> 
> 赞同：0
> 
> 时间：2012-10-16T14:13:01.540
> 
> 标签：spring, junit, mockito

如何`List`在单元测试中模拟 Spring 自动装配的 bean。

到目前为止，我无法达到我想要的结果。有没有办法做到这一点？

```
@Component
public class CrmStatusChecker {

    @Resource
    private List<IsAliveEnabledComponent> components;

    ....
} 
```

测试

```
@RunWith(MockitoJUnitRunner.class)
public class CrmStatusCheckerTest {

    @Mock
    private List<IsAliveEnabledComponent> isAliveComponents;

    @InjectMocks
    private final CrmStatusChecker crmStatus = new CrmStatusChecker();;

    @Before
    public void setUp() {
        MockitoAnnotations.initMocks(this);
    }

    ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:35:40.027

查看[Springockito](https://bitbucket.org/kubek2k/springockito/wiki/springockito-annotations)。它允许在 spring 上下文中用 mock 替换 bean。

另一个问题是，通过类型擦除，你`List<IsAliveEnabledComponent>`只是变成了`List<Object>`. 所以你刚刚嘲笑了`List`。这可能是 Mockito 忽略它的原因。

如果您正在加载 Spring 上下文，我会使用 Springockito。否则，我将创建一组模拟`IsAliveEnabledComponent`实例，创建一个列表并在您的设置中手动调用设置器。

# ruby - 如何将 YAML 布尔值传递给 HAML

> ID：12916640
> 
> 赞同：0
> 
> 时间：2012-10-16T14:13:15.610
> 
> 标签：ruby, haml, yaml

是否可以将 YAML 布尔值传递给 HAML？我尝试了几种方法，但似乎无法理解，只是匹配文本。

这是 YAML 布尔值：

```
---
show_banner: true
--- 
```

我已经尝试显式匹配布尔值，并且在 HAML 中也松散地匹配它。

```
- if "#{page.show_banner}" == true

- if "#{page.show_banner}" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:15:30.533

这个 HAML 在什么上下文中？你是如何传入参数的？

在不了解更多信息的情况下，我假设您可以这样做：

```
- if page.show_banner 
```

您对引号的使用是将参数更改为字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:16:41.023

我很幸运使用[Ruby 对象](http://ruby-doc.org/core-1.9.3/Object.html)作为中介，如下面的代码所示。

```
require 'YAML'
require 'HAML'

a = ('ShowBanner: false').to_yaml
puts a
b = YAML::load(a)
puts b
c = Haml::Engine.new(b)
d = c.render(b)
puts d 
```

# ruby-on-rails - 如何转换 Erb 2 Haml

> ID：12916642
> 
> 赞同：2
> 
> 时间：2012-10-16T14:13:16.983
> 
> 标签：ruby-on-rails

我在视图中写了几个erb模板，如何自动将erb转换为haml？但不能手动转换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:24:45.447

[`html2haml`](https://github.com/haml/html2haml) should do what you want. There's a `--erb` option that accepts ERB tags.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-20T15:04:47.433

在你的`Gemfile`：

```
gem "haml-rails" 
```

然后运行：

```
bundle install
rake haml:erb2haml 
```

如果您忘记了如何执行此操作，`rake -T`将向您展示已烘焙的 rake 任务；只需 grep 查找您要查找的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T11:33:42.357

检查 gem erb2haml。我认为你正在寻找的是正确的

更多信息[在这里](https://github.com/dhl/erb2haml)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-05-14T12:02:55.647

html2haml 做起来很简单。如果你有太多的观点，可能很少的脚本会帮助你。看到[那个](http://snot2000.wordpress.com/2009/11/28/html2haml-for-multiple-files/)

# youtube-api - Youtube API 观看次数不起作用

> ID：12916643
> 
> 赞同：3
> 
> 时间：2012-10-16T14:13:22.893
> 
> 标签：youtube-api

我正在从 youtube api 访问个人资料/频道信息，并取回看似关闭的号码。我正在使用： http: [//gdata.youtube.com/feeds/api/users/](http://gdata.youtube.com/feeds/api/users/) ?v=2。

viewCount 字段没有改变。这应该是用户频道的观看次数。自 9 月 16 日以来一直没有更新，对于几个高流量帐户也是如此。我在网上阅读了很多关于 youtube 网站本身发生的这种情况，但我读到的内容看起来好像问题已经解决了。我无法在 youtube 上找到可以比较的统计数据，所以我不知道是不是这种情况。

有谁知道youtube是否不再跟踪这个？还是只是没有在 api 中更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T03:58:37.917

我最后一次听到的是，由于政策决定，该特定属性将不再更新。一旦我们确定这是最终决定，我们将更新文档以反映这一点。

对于此更改可能造成的任何不便，我们深表歉意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:54:20.790

这很可能只是由于 YouTube 的缓存基础设施。我应该很快就会更新。

[如果您认为这是一个错误，请在https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20(Defect%20Report)](https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20%28Defect%20Report%29)提交报告

# c++ - 如何使用 3 个红外 LED 找到由 3 个点组成的三角形的旋转和平移

> ID：12916645
> 
> 赞同：3
> 
> 时间：2012-10-16T14:13:28.637
> 
> 标签：c++, opencv, rotation, geometry, translation

我正在做一个项目，我只有一个静态相机（不移动），但有一个物体平面，上面有 3 个点（它是一个平面，所以 z 方向上的点之差为零）。相机始终在同一位置，平面在空间中移动和旋转。我已经用 25 个棋盘图像和功能校准了相机：

```
calibrateCamera(object_points, image_points, image.size(), intrinsic, distCoeffs, rvecs,      tvecs); 
```

并且不失真效果很好。现在我制作了 opencv (c++) 将内在函数和 distCoeffs 写入 xml 文件。

如何在新程序中使用这些参数，找到形成三角形的 3 个点（用红外灯制成），并返回这个三角形的旋转和平移？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T09:27:39.683

# 2D案例

**这部分答案仅讨论*平面中的*刚性运动，因此与问题不完全匹配。**

假设您已经确定了您的观点，这似乎根据[您的评论](https://stackoverflow.com/questions/12916645/how-to-find-rotation-and-translation-of-a-triangle-made-of-3-points-with-3-infra#comment17501624_12916645)起作用。现在您可以计算这些点之间的距离并对它们进行排序。两个检测点之间的最短距离应对应于原始三角形的最短边，依此类推。有了这些信息，您可以将您的点标记为*A*、*B*和*C*。

接下来，您移动（平移）所有点，以便之后一个点位于原点。这是假设您的原始三角形在原点有一个角。让我们假设*A*在您的原始三角形和移动的点集中都位于原点。这个向量的否定版本表示你的三角形的**平移**。

现在轮换。假设对于您的原始三角形，*B*位于正*x*轴，即*y* = 0 且*x* > 0。现在您可以从相机中获取点*B*`atan2`的（移动）位置，并使用它的坐标，您可以确定直线*AB*和*x*轴之间的角度。这就是三角形的**旋转角度。**

您可以将这两者结合起来形成仿射变换。如果您的原始三角形不是以*A*为原点，*B位于**x*轴的正部分，那么您可以使用类似的技术来确定您的原始三角形如何与具有所述属性的三角形相关。

# 3D案例

对于空间中的刚性运动，我没有现成的解决方案。只是一个想法。假设您的相机位于原点，并且您分析的图像嵌入在*z* = 1 处。那么图像中的一个点 ( *x* , *y* ) 对应于该嵌入位置中的一个点 ( *x* , *y* , 1)，并且穿过该点的光线由该坐标的倍数给出，即 ( *λx* , *λy* , *λ* )。因此，从图像中点*A*、*B*和*C*的位置开始，您可以根据每个点的单个变量计算空间中的对应点，例如*a* through*丙*。

现在你的任务是选择这三个变量，使空间中点之间的距离与三角形的边长相匹配。这导致了一个由三个变量组成的三个方程组：

```
(a - b)^2 + (Ay*a - By*b)^2 + (Ax*a - Bx*b)^2 == AB^2
(a - c)^2 + (Ay*a - Cy*c)^2 + (Ax*a - Cx*c)^2 == AC^2
(b - c)^2 + (By*b - Cy*c)^2 + (Bx*b - Cx*c)^2 == BC^2 
```

不幸的是，这些方程不是线性的。到处都是你的变量的正方形。简单地将它们输入计算机代数系统还没有为我提供明确的解决方案。我想可能有数字方法可以使用一些迭代过程找到近似值，但是您必须对此进行一些研究。

获得 3D 坐标后，通过这些坐标计算转换应该很简单。这完全取决于您希望描述旋转的格式。

# python - 从 Dropbox API 中上传文件的元数据中获取用户凭据

> ID：12916652
> 
> 赞同：2
> 
> 时间：2012-10-16T14:13:39.603
> 
> 标签：python, metadata, dropbox

我有一个在许多用户之间共享的保管箱文件夹。使用 Python Dropbox SDK，我开发了一个轮询系统，它会持续扫描这个文件夹，以便处理可以上传到其中的所有可能的文件。

我的问题：有没有办法确定谁在该文件夹中上传了什么？我在文件的元数据中找不到此信息。

提前感谢您的任何帮助。

# ios - 除了@2x，UIImage 还支持哪些标签？

> ID：12916656
> 
> 赞同：0
> 
> 时间：2012-10-16T14:13:57.750
> 
> 标签：ios, uiimage

我知道我可以使用该`@2x`标签为 Retina 屏幕自动加载图像。还支持哪些其他标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:13:57.750

目前支持三个标签：

*   `@2x`对于 Retina 屏幕。
*   `~iPad`对于 iPad，必须是扩展名之前的最后一个标签。
*   `~iPhone`对于 iPhone 和 iPod Touch，同样，必须是最后一个。

对于启动画面，还有`Default-568h@2x`适用于 iPhone 5 的版本。这表明您可以使用`-568h`自动加载 iPhone 5 的图像，但不幸的是，情况并非如此（[rdar://12516489](http://openradar.appspot.com/radar?id=2161402)）。您可以修补`UIImage`类以自己添加支持。

最后有五种可能的图像变体：

*   `Image.png`对于旧设备，480✕320
*   `Image@2x.png`对于视网膜，960✕640
*   `Image-568h@2x.png`对于 Retina，1136✕640，仅在修补后`UIImage`
*   `Image~iPad.png`对于较旧的 iPad，1024✕768
*   `Image@2x~iPad.png`适用于 Retina iPad，2048✕1536

所有这些都[在 GitHub 上的 iOS Image Loader 示例项目](https://github.com/zoul/iOS-Image-Loader)中展示。

# sql - 我应该如何加入这些表格？

> ID：12916659
> 
> 赞同：1
> 
> 时间：2012-10-16T14:14:07.700
> 
> 标签：sql, join, inner-join

我有一个连接 5 个表的 SQL 语句，但我认为我必须错误地连接它们。我有一个 asp.net 表单，它允许通过复选框和下拉列表进行输入，因此我正在基于 UI 构建 SQL 内部代码。

搜索条件将包括来自 3 个不同表的字段。我得到的错误是

> *无法绑定多部分标识符“openingReq.bgChk”。*

我觉得我的加入一定是问题所在，但我不确定我应该如何更改它们以使其工作。

这是SQL语句

```
 SELECT COMPANY.NAME, 
       SITE.NAME, 
       OPENING.JOBTITLE, 
       ( OPENINGSCHED.WEEKLYHOURSLOW + '-' 
         + OPENINGSCHED.WEEKLYHOURSHIGH )                   AS weeklyHours, 
       ( OPENINGCOMP.WAGELOW & '-' & OPENINGCOMP.WAGEHIGH ) AS payRange 
FROM   COMPANY 
       INNER JOIN [SITE] 
               ON COMPANY.ORGID = SITE.ORGID 
       INNER JOIN OPENING 
               ON SITE.SITEID = OPENING.SITEID 
       INNER JOIN OPENINGSCHED 
               ON OPENING.OPENINGID = OPENINGSCHED.OPENINGID 
       INNER JOIN OPENINGCOMP 
               ON OPENINGSCHED.OPENINGID = OPENINGCOMP.OPENINGID 
WHERE  OPENING.JOBORWE = 'Job' 
       AND OPENING.OCCUPATIONCODE = 59 
       AND COMPANY.SECTORCODE = 202 
       AND OPENING.ONBUSROUTE = 1 
       AND ( OPENING.LANGCODE = 1 
              OR OPENING.LANGCODE = 7 
              OR OPENING.LANGCODE = 22 ) 
       AND OPENING.TIER = 1 
       AND OPENINGREQ.BGCHK = 1 
       AND OPENINGREQ.MINEXP = 'no minimum experience' 
       AND OPENINGREQ.MINED = 'no minimum education' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:16:22.487

您的查询中没有名为“openingReq”的表或别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:16:24.547

我正在查看您的查询，但找不到该`OPENINGREQ`表的连接。
这可以解释为什么 SQL 不能绑定它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:17:18.873

我在任何地方都看不到`openingReq`JOIN 中的表 - 但 WHERE 子句......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:28:24.690

`OPENINGREQ`在您的上下文中不存在。将其替换为正确的表名或别名：

```
 AND OPENINGREQ.BGCHK = 1 
   AND OPENINGREQ.MINEXP = 'no minimum experience' 
   AND OPENINGREQ.MINED = 'no minimum education' 
```

# python - 保存另一个模型的对象时更新值的正确方法

> ID：12916663
> 
> 赞同：1
> 
> 时间：2012-10-16T14:14:16.000
> 
> 标签：python, django, many-to-many, signals, admin

一旦我保存交易（来自管理员），我想更新交易中涉及的人（债权人和借方）的余额值。这是我的模型：

```
#models.py
class Person(models.Model):
    first_name = models.CharField(max_length = 30) 
    last_name = models.CharField(max_length = 30) 
    phone_number = models.CharField(max_length = 30) 
    email = models.EmailField('e-mail')
    balance = models.DecimalField(max_digits = 5, decimal_places = 2)

class Transaction(models.Model):
    creditor = models.ForeignKey(Person,related_name = 'creditor')
    debtors = models.ManyToManyField(Person, related_name = 'debtors')
    value = models.DecimalField(max_digits = 5, decimal_places = 2)
    split = models.BooleanField()
    date = models.DateField() 
```

这是我的想法，但我只在交易发生变化时工作（第一次保存不起作用）：

```
#admin.py
class PersonAdmin(admin.ModelAdmin):
    list_display = ('first_name','last_name','balance')

class TransactionAdmin(admin.ModelAdmin):
    list_display = ('creditor','value','date')
    list_filter = ('date',)
    date_hierarchy = 'date'
    ordering = ('-date',)
    filter_horizontal = ('debtors',)

    def save_model(self,request,obj,form,change):
            obj.save()
            if obj.split:
                    split_value = obj.value/(obj.debtors.all().count()+1)
                    for debtor in obj.debtors.all():
                            p = Person.objects.get(id = debtor.id)
                            p.balance = p.balance - split_value
                            p.save()
                    p = Person.objects.get(id = obj.creditor.id)
                    p.balance = p.balance + (obj.debtors.all().count())*split_value                     
                    p.save()

admin.site.register(Person,PersonAdmin)
admin.site.register(Transaction,TransactionAdmin) 
```

我是 Django 的新手，对这样做的正确方法感到非常困惑。我很感激这方面的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T23:36:40.970

这是我在研究这些链接后找到的解决方案：

1.  [https://docs.djangoproject.com/en/dev/ref/contrib/admin/](https://docs.djangoproject.com/en/dev/ref/contrib/admin/)
2.  [http://reinout.vanrees.org/weblog/2011/11/29/many-to-many-field-save-method.html](http://reinout.vanrees.org/weblog/2011/11/29/many-to-many-field-save-method.html)
3.  [保存后多对多关系未立即更新的问题](https://stackoverflow.com/questions/1925383/issue-with-manytomany-relationships-not-updating-inmediatly-after-save/1925784#1925784)
4.  [Django 多对多信号？](https://stackoverflow.com/questions/1958540/django-manytomany-signals/6047637#6047637)
5.  [http://python.6.n6.nabble.com/Process-Related-Object-when-Saving-td4974737.html](http://python.6.n6.nabble.com/Process-Related-Object-when-Saving-td4974737.html)

```
 def save_related(self,request,form,formsets,change):
            form.save_m2m()

            debtors = form.instance.debtors.all()
            n_debtors = debtors.count()
            creditor = form.instance.creditor
            value = form.instance.value

            if form.instance.split:
                    value = value/(n_debtors + 1)

            for debtor in debtors:
                    p = Person.objects.get(id = debtor.id)
                    p.balance = p.balance - value
                    p.save()

            p = Person.objects.get(id = creditor.id)    
            p.balance = p.balance + n_debtors*value
            p.save() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:26:28.950

您可以使用[django 的信号](https://docs.djangoproject.com/en/dev/topics/signals/)，以便创建一个在执行保存后（同步）触发的[`post-save`](https://docs.djangoproject.com/en/dev/ref/signals/#django.db.models.signals.post_save)函数（准确地说是一个函数）。

例如：

```
from django.db.models.signals import post_save
from signals import do_something

class TransactionAdmin(models.Model):
    ...

post_save.connect(do_something, sender=TransactionAdmin) 
```

并在一个`signals.py`文件中：

```
def do_something(sender, instance, created, *args, **kwargs):
    if created and sender == TransactionAdmin:
        ...
    ... 
```

# ruby-on-rails - 设计区分注册/登录的钩子

> ID：12916667
> 
> 赞同：1
> 
> 时间：2012-10-16T14:14:25.640
> 
> 标签：ruby-on-rails, devise

有哪些简单的方法可以连接到 Devise，以便我可以区分以下事件：1\. 注册，2\. 登录

我只需要知道如何为此连接到设计。我还没有找到我正在寻找的东西——一个干净的、最小的、控制器级的实现。以下是我尝试过的一些选项：

1.  创建一个自定义控制器（如[https://github.com/plataformatec/devise#configuring-controllers](https://github.com/plataformatec/devise#configuring-controllers)所述）。我宁愿不使用它，因为它需要大量工作、脆弱且重复。

2.  使用模型回调。我宁愿不走这条路。我希望这是控制器级代码。我的意思是，至少，我想要访问控制器环境。在我看来，这是控制器的责任。我希望这是可测试的，而不必处理模型。

3.  `sign_in`在我的应用程序的 ApplicationController 中覆盖。问题？这种方法无法区分注册和登录。（如果这不准确，请纠正我？）我在浏览了 Devise registrations_controller.rb 和 session_controller.rb 后说这两个`create`方法调用`sign_in`。

我的具体应用是：(a) 向管理员发送电子邮件通知和 (b) 对后端分析服务进行 API 调用。请注意，这两者都不是模型职责——这些都是控制器级别（应用程序级别）的职责。

2012-10-16 更新：我在问 Devise 项目是否愿意为 sign_up 添加一个新的钩子：[https ://github.com/plataformatec/devise/issues/2104](https://github.com/plataformatec/devise/issues/2104)

2012 年 10 月 16 日更新：我从这个问题中删除了“退出”，因为这很容易挂钩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:42:08.197

感谢来自[https://github.com/pootsbook](https://github.com/pootsbook)和[https://github.com/rubynortheast](https://github.com/rubynortheast)的拉取请求，Devise 的主分支现在支持 sign_up 和 sign_out 的单独挂钩。所以我认为它将进入下一个版本，也许是 2.1.3。

看：

*   [https://github.com/plataformatec/devise/pull/2111](https://github.com/plataformatec/devise/pull/2111)
*   [https://github.com/plataformatec/devise/issues/2104](https://github.com/plataformatec/devise/issues/2104)

# model-view-controller - dataTable().makeEditable() - 如何为 Add 调用特定的操作方法

> ID：12916672
> 
> 赞同：0
> 
> 时间：2012-10-16T14:14:30.210
> 
> 标签：model-view-controller, datatable

在 dataTable().makeEditable() 的默认实现中，点击 formAddNewRow 的 Ok 按钮时调用的操作方法是 AddData(string name, string .....)。

如何调用特定的操作方法，例如 AddCompany(string name, string .....)？

我试过使用下面的代码，但它抛出了一个错误： $(document).ready(function () { $('#myDataTable').dataTable().makeEditable({ sAddURL: "/Admin/AddCOIRole" }) ; });

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T18:02:48.637

我已经删除了控制器参考，它工作正常。sAddURL：“添加COIRole”

# delphi - 异常事件后的 DBGrid 行为

> ID：12916674
> 
> 赞同：2
> 
> 时间：2012-10-16T14:14:32.307
> 
> 标签：delphi, delphi-5

我需要帮助解决以下问题。我已经使用以下组件类型实现了一个可编辑的 DBGrid：TQuery、TDataSource、TUpdateSQL、TDBGrid。Query AfterPost 事件处理程序将更改应用于数据库。

```
procedure TCardForm.Query2AfterPost(DataSet: TDataSet);
begin
  Query2.ApplyUpdates;
end; 
```

因此，如果我在 DBGrid 中编辑一行并移动到另一行或按下向下箭头键，我所做的更改将应用​​于数据库。一切正常，只有一个例外。当输入不正确的值时，会引发数据库异常并显示一条消息，例如“Column ... cannot be NULL”。在消息框中单击“确定”后，应用程序允许我浏览 DBGrid 并转到另一行，而无需尝试应用更改，也不会再次显示异常消息。仅当我编辑另一行或再次编辑同一行时，它才会显示异常消息。我不希望应用程序允许我这样做。在输入正确的值之前，我希望无法移动到 DBGrid 中的另一行。

提前感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:25:29.643

Most probably you should handle the error in try except block. Or validate entries before posting to database.

# android - 将用户从一个 Android 应用迁移到 Google Play 中的另一个应用

> ID：12916687
> 
> 赞同：2
> 
> 时间：2012-10-16T14:15:09.827
> 
> 标签：android, google-play

我有两个具有相似功能的应用程序，我们称它们为应用程序 A 和应用程序 B。现在我想删除应用程序 B 并将所有这些用户移动到应用程序 A。理想情况下，我想向应用程序 B 发送一个更新，以便无缝传输所有这些用户都进入 App A。可以这样做吗？如果不能，我还有什么其他选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:19:26.183

你不能这样做。您可以更新 App B 并放置一个大横幅，说明此版本不再可用，然后是指向您的 App A 的链接。

# php - 在数组中跳过 mysql 数据库中的值

> ID：12916695
> 
> 赞同：0
> 
> 时间：2012-10-16T14:15:48.383
> 
> 标签：php, mysql, arrays

> **可能重复：**
> [MySQL：仅从列中选择唯一值](https://stackoverflow.com/questions/8571902/mysql-select-only-unique-values-from-a-column)

我从 mysql 表类别和列父级获取值。父级包含像 1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4 这样的值

如果它们重复，我想跳过这些值。所以我希望输出为 1,2,3,4

请帮帮我..我的代码不工作。

```
$new_cat1 = $cat1;
    foreach($cat1 as $category){
        $query="SELECT parent FROM categories where id='$category'";
        $result = mysql_query($query);  
        $line = mysql_fetch_assoc($result);
        array_push($new_cat1,$line['parent']);
        if (in_array("1", $new_cat1)) {
        continue;
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T14:16:34.873

添加`DISTINCT`您的查询，以便它只选择唯一值。

```
SELECT DISTINCT parent FROM categories where id='$category' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:19:32.720

还有一种并行的方法：

```
SELECT DISTINCT parent FROM categories where id='$category' group by parent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:17:24.530

将查询更改为：`SELECT parent FROM categories where id='$category' GROUP BY parent`

问候。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:18:17.010

```
SELECT parent FROM categories where id='$category'
group by parent 
```

# python - 我是否必须自己刷新 oauth2 access_token，或者

> ID：12916699
> 
> 赞同：4
> 
> 时间：2012-10-16T14:15:52.940
> 
> 标签：python, google-app-engine, oauth, oauth-2.0

我使用适用于 Python 的 Google API 客户端库（oauth2client 应用引擎）。当access_token过期时，我必须自己刷新还是由API完成？现在 access_token 过期了，没有刷新！

我使用 oauth 感知装饰器。访问类型 = 离线，并且刷新令牌在凭据内。

这是我收到的 TokenInfo：

```
{
 "issued_to": "1002825648120.apps.googleusercontent.com",
 "audience": "1002825648120.apps.googleusercontent.com",
 "user_id": "110738386197429542823",
 "scope": "https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",
 "expires_in": 3540,
 "email": "xxxxxxxxx@gmail.com",
 "verified_email": true,
 "access_type": "offline"
} 
```

如果我必须刷新 access_token，oauth 客户端 API 中是否有一种简单的方法可以做到这一点？

**更新 1：**

我研究了oauth2/client.py的代码。我现在认为不使用 decorator.http() 会导致不刷新访问令牌。看到这个（我的另一个）问题： [Failed to authorize tokeninfo oauth2 request using decorator.http()](https://stackoverflow.com/questions/12915253/failed-to-authorize-tokeninfo-oauth2-request-using-decorator-http)

**更新 2：已解决：**

上面提到的问题（在 UPDATE-1 中）得到了解决，也解决了这个问题。API 将在调用授权的 http.request 时尝试刷新 access_token（如果已过期）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:25:34.027

我研究了oauth2/client.py的代码。我现在认为不使用 decorator.http() 会导致不刷新访问令牌。看到这个（我的另一个）问题：Failed to authorize tokeninfo oauth2 request using decorator.http()

更新并解决：

上面提到的问题解决了，也解决了这个问题。API 将在调用授权的 http.request 时尝试刷新 access_token（如果已过期）。

# python - 为什么我的深度优先搜索实施失败了

> ID：12916700
> 
> 赞同：3
> 
> 时间：2012-10-16T14:15:56.607
> 
> 标签：python, algorithm, depth-first-search

我一直在尝试不同的方式来实现深度优先搜索。我找到了一些工作方法，但它们涉及一些相当繁琐的字典工作。我使用列表开发了一个新想法，但是此实现返回的操作与所需的结果不匹配。我会尽量清楚地注释代码：

```
start = problem.getStartState()            ## returns an (x, y) tuple
children = problem.getSuccessors(start)    ##returns the children of a parent node in ((start                  
                                           state), action, cost) format. 
stack = Stack()                            ##creates a Stack (LIFO) data structure
visited = []                               ##list of visited nodes
visited.append(start)
for child in children:
    stack.push((child, [], [], 0))         ##push children to fringe in the format of (child,
    while stack:                           ##path taken, actions taken, cost) 
        parent = stack.pop()
        node = parent[0]
        if parent[0] in visited: continue
        visited.append(parent[0])
        path = parent[1] + [node[0]]           ##assigns previous path/actions/cost to new 
        actions = parent[2] + [node[1]]        ##node, creating a cumulative, ordered list of
        print actions                          ##the path/actions and a cumulative cost
        cost = parent[3] + node[2]
        if problem.isGoalState(node[0]):
            print parent[2]
            return parent[2]                    ## returns list of actions 
        children = problem.getSuccessors(node[0])
        if children != []:
            for child in children:
                stack.push((child, path, actions, cost))   ##assigns cumulative lists to child 
```

任何人都看到我的问题在这个实现中可能出在哪里？顺便说一句，我知道 DFS 在大多数情况下是一种低效的算法。但是一旦我正确地实现了这个实现，它应该能够通过简单地更改存储父节点子节点的数据结构来跨越其他搜索算法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T15:03:52.490

CS188 朋友：D 在这里阅读您的代码真的很难......所有这些索引％）使用更多变量，它会更清晰。我的解决方案：

```
def depthFirstSearch(problem):
    fringe = util.Stack()
    expanded = set()
    fringe.push((problem.getStartState(),[],0))

    while not fringe.isEmpty():
        curState, curMoves, curCost = fringe.pop()

        if(curState in expanded):
            continue

        expanded.add(curState)

        if problem.isGoalState(curState):
            return curMoves

        for state, direction, cost in problem.getSuccessors(curState):
            fringe.push((state, curMoves+[direction], curCost))
    return [] 
```

我希望我不需要评论它。很容易阅读：）祝您有美好的一天；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-16T14:55:27.743

你似乎有名字冲突。注意：

```
children = problem.getSuccessors(start)    ##returns the children of a parent node in ((start                  
... 
for child in children:
    ...
    while stack:
        ...
        children = problem.getSuccessors(node[0])
        ... 
```

在第一次迭代之后，您的原始子代会丢失，因为它被内部循环中的子代覆盖。

一般来说，DFS最好使用[递归函数](https://en.wikipedia.org/wiki/Recursion_%28computer_science%29)实现，大致如下（未经测试）：

```
def dfs(problem, state, visited):
    visited.append(state)

    # have we reached the goal?
    if problem.isGoalState(state):
        return [state]

    for child in problem.getSuccessors(state):
        # if child is already visited, don't bother with it
        if child in visited: continue

        # otherwise, visit the child
        ret = dfs(problem, child, visited)

        if ret is not None:
            # goal state has been reached, accumulate the states
            ret.append(state)
            return ret

    return None # failed to find solution here
    # note that Python return None by default when reaching the end of a function 
```

# java - Java中添加到文件夹的文件的FIFO处理

> ID：12916705
> 
> 赞同：1
> 
> 时间：2012-10-16T14:16:11.643
> 
> 标签：java, file-io

Java中是否有任何方法可以确保对添加到文件夹的文件进行FIFO处理。我正在寻找一个独立于平台的解决方案。我目前正在使用`listFiles()`in 方法`java.io.File`从目录中获取所有文件，但我已经读过它不保证使用此方法找到的文件的任何顺序。我还考虑过根据文件的最后修改日期对文件进行排序，但这是不可靠的，并且不能确保 FIFO。有没有人有任何其他想法？

我必须使用 Java 6，Java 7 不是一个选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:30:16.990

该`File.listFiles()`方法以未指定的平台相关顺序返回文件。

如果目录中的文件在您处理它们时不会被更改，那么对`File`列表进行排序应该可以工作。

如果目录中的文件容易更改，那么您将无法获得文件及其修改时间的“快照”。但是您可能会使用 Java 7[`WatchService`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html)来跟踪目录添加和文件更改，并使用它来处理目录列表和排序期间和之后发生的更改。

* * *

Java 6 中没有与 Java 7 WatchService 等效的东西。如果你想要那种东西，你要么使用外部程序以正确的顺序将文件名提供给 Java，要么使用 JNI 和本机代码与操作系统交互级文件/目录监视服务。

# jasper-reports - 页脚分成更多部分

> ID：12916706
> 
> 赞同：0
> 
> 时间：2012-10-16T14:16:15.403
> 
> 标签：jasper-reports, ireport, footer, sections

我知道*Crystal Reports*提供了将页脚拆分为可根据某些条件打印的部分（a 部分、b 部分...）的可能性。如果*条件 1*为*真*，则打印部分 a，否则打印部分 b，依此类推。

我必须使用*iReport*制作类似的东西，但我不知道怎么做。我找不到制作更多部分的选项。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T18:31:11.163

要扩展并建议对 Alex 的评论进行扩展，您可以将您想到的每个部分布局`frame`在页脚中的 a 中。然后`printWhenExpression`为每一帧设置而不是一堆元素。

例如：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report3" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="0" bottomMargin="0" uuid="35abc101-1375-42c5-9f5f-2eb3542ca382">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <parameter name="footerPrint" class="java.lang.String">
        <defaultValueExpression><![CDATA["1"]]></defaultValueExpression>
    </parameter>
    <pageFooter>
        <band height="51">
            <frame>
                <reportElement uuid="c8bef919-0e83-4d72-9b25-1a7e0aa6b82b" x="0" y="0" width="555" height="20">
                    <printWhenExpression><![CDATA[$P{footerPrint}.equals("1")]]></printWhenExpression>
                </reportElement>
                <staticText>
                    <reportElement uuid="4ad1f177-9e43-4d9f-8f05-012090c33193" x="0" y="0" width="100" height="20"/>
                    <textElement/>
                    <text><![CDATA[Footer Print: 1]]></text>
                </staticText>
            </frame>
            <frame>
                <reportElement uuid="c8bef919-0e83-4d72-9b25-1a7e0aa6b82b" x="0" y="0" width="555" height="20">
                    <printWhenExpression><![CDATA[$P{footerPrint}.equals("2")]]></printWhenExpression>
                </reportElement>
                <staticText>
                    <reportElement uuid="4ad1f177-9e43-4d9f-8f05-012090c33193" x="0" y="0" width="100" height="20"/>
                    <textElement/>
                    <text><![CDATA[Footer Print: 2]]></text>
                </staticText>
            </frame>
        </band>
    </pageFooter>
</jasperReport> 
```

框架设置为相同的尺寸，其余设置为完​​全相同的 x/y 坐标。所以本质上它们是重叠的，但如果你正确地执行表达式，无论如何一次只会显示一个。

当然另一种选择是为每个元素设置表达式，我只是觉得这种方式更容易。

# rest - azure 中自动创建的存储帐户选项

> ID：12916717
> 
> 赞同：1
> 
> 时间：2012-10-16T14:16:34.567
> 
> 标签：rest, azure

如果我想通过 REST API 使用自动创建的存储帐户选项 { ie.implicit storage account creation in case if there are no such things inside selected region } 我如何在 REST API 调用中实现这一点，尤其是价值是什么用于该场景中的媒体链接。

是否有任何规定可以将价值作为“自动”或其他方式传递，以便在不可用的情况下创建新的隐式存储？

另外如何区分隐式帐户与区域中的其他存储其他帐户？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T11:51:04.293

我做了一个解决{可能是唯一的方法} ...如果我没有找到任何以“portalvhd..”开头的存储帐户并且描述为“隐式创建的存储帐户”，我只是在创建一个新的存储具有此属性“portalvhd..”作为起始短语和描述为“隐含...帐户”的帐户。这样，我能够实现类似于门户的行为。

越过一个障碍......仍然期待来自天蓝色的更多:-)

# ios - 如何在 iOS 中再次请求照片库权限

> ID：12916721
> 
> 赞同：3
> 
> 时间：2012-10-16T14:16:36.620
> 
> 标签：ios, permissions, privacy

在我的 iOS 应用程序中，我正在访问用户的照片库。用户第一次这样做时，它会请求他们的许可。由于权限请求，我的一些用户报告第一次崩溃，但在随后的尝试中运行良好。

为了能够自己测试，我需要能够从我的 iPad 上删除权限并再次提示它。有没有办法通过 iPad/iPhone 本身或通过代码来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:32:11.487

运行设置应用程序。转到常规，然后重置。点击重置位置和隐私。这将重置您的所有位置和隐私设置，而不仅仅是您的测试应用程序。但是您在开发设备上执行此操作应该没问题。这也适用于模拟器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-13T19:55:47.953

在 iOS 7+ 中，您可以进入“设置”>“隐私”>“照片”并明确启用或禁用个别应用的访问权限。

这比重置您的整个设备隐私设置要好得多！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-08T09:20:49.250

另一种方法是临时更改Info.plist中的Bundle Identifier（CFBundleIdentifier）。系统会将此类应用程序视为一个新的单独应用程序，并将显示“想访问您的照片”警报。结束测试后不要忘记恢复 CFBundleIdentifier。

# c# - ScriptIgnore 不适用于 WCF REST 服务应用程序

> ID：12916724
> 
> 赞同：1
> 
> 时间：2012-10-16T14:16:43.673
> 
> 标签：c#, visual-studio-2010, wcf, rest, scriptignore

我启动了一个 Visual Studio WCF Rest 服务应用程序项目，我希望有一个服务返回带有序列化对象的 Json 格式消息，并且我希望对象的某些字段不被序列化。我必须说，我对 WCF 的了解非常基础，并且我使用了 Visual Studio 中的 Rest Service Application 项目，因为它是一种快速实现我需要的简单方法。

假设这是我拥有的对象：

```
public class BaseMessage
{
    public string errorCode { get; set; }
    public string errorMessage { get; set; }
} 
```

这是我的代码

```
 [WebGet(UriTemplate = "/v1/test", 
    ResponseFormat = WebMessageFormat.Json),OperationContract]

    public BaseMessage Test()
    {
        return (new BaseMessage { errorCode = "000", errorMessage = "test" });
    } 
```

我到处读到我需要做的是将 [ScriptIgnore] 属性分配给我不想序列化的属性。但如果我这样做，它就不起作用。无论如何，我都会将它们序列化。

我实现我想要做的唯一方法是以这种方式声明我想要返回的对象：

```
[Serializable]
public class BaseMessage
{
    public string errorCode;
    [NonSerialized]
    public string errorMessage;
} 
```

通过这种方式，我可以根据需要对类进行序列化。但这让我很烦恼，因为我可能没有正确地做这件事。我这样做对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:23:36.637

我认为您应该为您的数据对象使用 [DataContract] 属性，为您的对象成员使用 [DataMember]

像这里[http://msdn.microsoft.com/en-us/library/ms733127.aspx](http://msdn.microsoft.com/en-us/library/ms733127.aspx)

当你想忽略一个项目时；您将其标记为 [IgnoreDataMember] 属性

# java - 如何将命名空间属性添加到 ksoap 信封？

> ID：12916726
> 
> 赞同：3
> 
> 时间：2012-10-16T14:16:46.263
> 
> 标签：java, android, attributes, ksoap2, envelope

我需要在 ksoap2（Android 版本）生成的信封中添加一个属性（xmlns:n0="urn:checkOTP"）。

```
<v:Envelope
  xmlns:i="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:d="http://www.w3.org/2001/XMLSchema"
  xmlns:c="http://www.w3.org/2003/05/soap-encoding"
  xmlns:v="http://www.w3.org/2003/05/soap-envelope">
  <v:Header>
  ...
</v:Envelope> 
```

转向

```
<v:Envelope
  xmlns:i="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:d="http://www.w3.org/2001/XMLSchema"
  xmlns:c="http://www.w3.org/2003/05/soap-encoding"
  xmlns:v="http://www.w3.org/2003/05/soap-envelope"
  xmlns:n0="urn:checkOTP">
  <v:Header>
   ...
  </v:Envelope> 
```

错误代码是：

```
W/System.err(858): Code: SOAP-ENV:Sender, Reason: Method 'checkOtp' not implemented: method name or namespace not recognized 
```

该服务器是 gSOAP2 的，如果在标头中添加“xmlns:n0="urn:checkOTP"（使用 javascript 测试），则可以完美运行。

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-23T14:07:56.110

以下应该有效：

```
SoapObject request = new SoapObject("urn:checkOTP", "checkOTP") 
```

这似乎不是将命名空间添加到信封，而是作为 body 元素内的方法元素的属性，但是也可以。

# apache-flex - 如何监听父组件调度的子组件内部的事件

> ID：12916727
> 
> 赞同：0
> 
> 时间：2012-10-16T14:16:46.607
> 
> 标签：apache-flex, events

当一个事件被组件分派时，事件的流动分为三个阶段，捕获 - 事件从应用程序流向分派事件的组件，当事件到达实际分派事件的目标时，目标，然后事件从目标流向应用程序的冒泡阶段。有一种情况，Application 有子 comp1，comp1 有子 comp2。我在 comp1 中有一个按钮，用于调度事件，我想在 comp2 中收听该事件。理想情况下，事件将从 Application->comp1->button->comp1->Application 流出。我怎样才能实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:31:47.477

在内部`comp1`调度您的事件并确保它冒泡：

```
myButton.addEventListener(MouseEvent.CLICK, handleMyButtonClick);

private function handleMyButtonClick(event:MouseEvent):void {
     dispatchEvent(new Event("myCustomEvent", true));
} 
```

现在在里面`comp2`监听这个事件`stage`：

```
stage.addEventListener("myCustomEvent", handleMyCustomEvent); 
```

就是这样：因为事件冒泡，它*总是*会在某个时候击中`stage`. 因此，您可以使用它在任何地方收听。只是不要忘记在尝试附加侦听器之前确保设置了`stage`属性。`comp2`

注意：请注意，应用程序中的所有组件都可以*看到*此事件，因此请确保正确的组件处理正确的事件。对于初学者，我永远不会在内置事件中使用这种方法；仅使用`type`s 与内置事件不一致的自定义事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:41:59.680

你的建议可能不是最好的方法。您可能应该通过让父母明确地做一些帮助孩子知道该做什么的事情来更好地处理这个问题。

一种方法是使用事件总线的概念，例如[您在 RobotLegs 中看到的](http://knowledge.robotlegs.org/discussions/questions/495-why-a-centralized-event-bus)。`eventBus`只需给您的 child2 一个使用 IEventDispatcher 类型调用的公共字段或属性。然后，您可以让父级使用 填充此属性`this`。我通常将此类属性设置为 getter/setter，以便在将孩子从舞台上移除并且孩子可以[移除其 listeners](http://www.developria.com/2010/08/rethinking-addeventlistener-an.html)时，该属性可以为空。

这使您可以从实现这一目标所需的确切内容开始，但是如果您发现自己在需要它来收听不同对象的情况下使用 child2，那么您就可以开始了。

第二种可能性是只在子级上公开一个父级可以调用的方法（父级已经有对子级的引用——你没有在这里引入不必要的耦合），然后简单地调用它而不是调度事件。

# c# - ThreadStart 和 Action 的区别

> ID：12916732
> 
> 赞同：10
> 
> 时间：2012-10-16T14:16:57.620
> 
> 标签：c#, .net, wpf

有人知道两者的区别吗

```
Dispatcher.BeginInvoke(DispatcherPriority.Background, new ThreadStart(() =>
{ 
```

和

```
Dispatcher.BeginInvoke(DispatcherPriority.Background, new Action(() =>
{ 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-16T14:19:13.257

应该没有区别。`ThreadStart`并`Action`定义为

```
public delegate void ThreadStart();

public delegate void Action(); 
```

即，没有参数也没有返回值的委托。所以它们在语义上是相同的。

* * *

但是，我会使用`Action`and not `ThreadStart`，因为它与构造函数`ThreadStart`密切相关，因此带有的代码可以提示直接创建线程，因此会产生轻微的误导。`Thread``ThreadStart`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-26T15:27:42.917

看起来和在上下文中*是*有区别的。`ThreadStart``Action``BeginInvoke`

正如 Vlad 所提到的，它们都将在委托中正确运行代码。

但是，如果委托中发生异常，则会`ThreadStart`导致`TargetInvocationException`. 但是 using`Action`会为您提供来自委托的正确异常。

`Action`出于这个原因，应该首选。

看看[这个问题](https://stackoverflow.com/q/28607015/4593760)。

# java - 在 Leiningen 项目中分叉一个 JVM

> ID：12916735
> 
> 赞同：2
> 
> 时间：2012-10-16T14:17:11.863
> 
> 标签：java, clojure, jvm, integration, leiningen

是否可以在 Leiningen 项目中分叉 VM，类似于启用 fork="true" 选项时的 Ant 任务？

我可以用脚本解决这个问题，但是简单地编写“lein run”并启动两个进程会非常有用。也可以导入（或更糟糕的是，编写）代码来执行此操作，但在这种情况下，它更适合在构建环境中使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:15:02.993

好像你想要[lein-daemon](https://github.com/arohner/lein-daemon)

# c# - WCF 客户端代理生成失败并添加新方法

> ID：12916736
> 
> 赞同：0
> 
> 时间：2012-10-16T14:17:12.087
> 
> 标签：c#, wcf, svcutil.exe, proxy-classes

我有一个需要为其生成客户端代理类的库，并且在我的本地机器上运行此命令和服务时，现有代码可以正常工作

```
svcutil.exe /config:thn /r:Citi.Rbcs.BusGn.dll /r:Citi.Rbcs.Buscm.dll net.tcp://localhost:8088/RbcThnService/mex 
```

客户端代理生成良好。RbcThnService 使用接口 IRbcThinService。如果我随后向该接口添加一个新方法，如下所示

```
[OperationContract(ProtectionLevel = ProtectionLevel.EncryptAndSign)]
        [FaultContract(typeof (GenericException))]
        [FaultContract(typeof (CustomException))]
        RbcCustomerStructure GetCustomerStructures(string CustomerId, short QueueId, DateTime dateUpdate, RbcSecurityContext securityContext); 
```

然后重建并安装服务，并尝试重新生成客户端代理，我得到

```
There is an error in the XML document.

The value for the 'type' attribute is invalid - 'q32:ArrayOfstring' is an invalid value for the 'type' attribute. 
```

听起来好像在声明中没有找到某种类型，但奇怪的是接口中有另一个方法与原始库中的签名完全相同，它允许客户端代理生成就好了。所以我只是创建一个与已经存在的方法相同的方法，只是用一个新名称。

有没有人有什么建议？

更新：好的，如果我注释掉现有方法之一并重试，那么情节会变厚 - 它适用于新方法。我已经尝试将其简化为仅几种方法加上新方法，它可以工作。我逐渐将其他方法一一重新引入，它一直在工作，直到我添加了最后一个方法，然后它出错了。

有趣的是，我开始将一个原始方法注释掉并且它正在工作，然后我创建了一个 SECOND dummy NEW 方法并且它出错了，同样的错误但是它不是 ArrayOfstring 它有一个不同的类型，因为它失败了。

因此，如果我没有找错树，它似乎与接口定义中的方法数量或生成的 XML 的长度有关。有什么我应该注意的限制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T13:33:19.817

对于任何类型的 Web 服务，您都不能有重载的方法。如果您指定不同的 OperationContract Name EG，WCF 允许这样做

```
[ServiceContract]
interface IService
{
    [OperationContract(Name="Foo")]
    void Foo();

    [OperationContract(Name="Foobar")]
    void Foo(string bar);

} 
```

但这基本上是将公共签名更改为方法，即使它在接口中命名相同，所以我通常不会这样做，因为在创建客户端时可能会更加混乱。

查看[此帖子](https://stackoverflow.com/questions/12943277/why-does-wcf-test-client-preempt-my-wcf-app-and-how-can-i-avoid-it/12943471#12943471)以了解类似问题。在 Web 服务（包括 WCF）中，任何重载（同名）的方法实际上都无法弄清楚您在调用什么。将 OperationContract 中的方法名称或 Name 属性更改为不同的名称，然后重试。

# c++ - 让回调记住一些信息的好方法（C++）

> ID：12916738
> 
> 赞同：2
> 
> 时间：2012-10-16T14:17:15.800
> 
> 标签：c++, callback

我在我的程序中使用了一个回调，这个回调会被重复调用，所以我想用一些方法来存储当前的信息，这样他就可以记住他在哪里。我想创建一个类，并使用一些静态成员来存储它们，但我认为它并不好......我想要一些建议，非常感谢！

实际上，我更喜欢使用结构或类，我举一个简单的例子来说明我的想法。

```
callback(parameters)
{
   A* a->setcounter(record current value);
   A* a->getcounter(get current value);
   A* a->addcounter(current value ++);
   A* a->calculate(do some calculation with values);
} 
```

让我困惑的是，我应该先创建一个A类的对象，但我不想这样做，所以我选择使用静态成员，但我认为应该有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:19:35.510

让回调函数中的参数是上下文对象，即包装状态信息的结构类型或类的某个实例，这些信息对回调函数用于识别程序的状态是有用的。回调函数可以基于此状态来了解要执行的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:38:34.533

如果您使用仿函数，即定义 的类的对象`operator()`，您可以以与函数相同的方式使用它（例如，代替您现在使用的回调函数），但在类的数据成员中您可以存储状态信息。类似这样的东西：

```
class CallbackObject {
  int _state_information;
public:
  CallbackObject():_state_information(0) {}

  void operator()(int some_data_to_process) {
    /* ..process data.. */

    ++_state_information; // Update internal state
  }
}; 
```

那么这个类的对象可以像回调函数一样使用。

* * *

但是，如果可以使用 C++11，有一种特别方便的方法可以实现类似的效果，即使用*捕获 lambda：*

```
#include <iostream>

/* This is our "backend" that calls the callback
   function: */
template <typename Callback>
void process(int data, Callback callback) {
  callback(data);
}

int main()
{
  /* State information: */
  int num_calls = 0;

  /* Here we define the callback function as a lambda: */
  auto callback = [&num_calls](int data) { ++num_calls; };

  /* Have it called a few times: */
  for (int i = 0 ; i < 10 ; ++i)
    process(i,callback);

  std::cout << "Callback was called " << num_calls << " times." << std::endl;
  return 0;
} 
```

函数中的`callback`变量`main`存储了 lambda 函数。`[&num_calls]`意味着整数变量`num_calls`被捕获为引用，因此在调用 lambda 时对其值所做的任何更改都将直接影响原始变量`num_calls`。因此，您可以使用捕获的引用`num_calls`（当然可能是更复杂的类型或多个变量）来存储和更新状态信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:21:16.217

函数中的静态变量是否有某些原因不会这样做？

```
int my_callback(int i)
{
    static int my_int;
    if (i != -1) my_int = i;

    return my_int;
} 
```

在此示例中，将任何值传递给 my_callback 都会将该值分配给回调的静态变量，除了`-1`，它将返回当前值而不分配给它。

# vim - 从目录递归地包含 ctags 文件

> ID：12916743
> 
> 赞同：2
> 
> 时间：2012-10-16T14:17:29.617
> 
> 标签：vim, ctags

我成功地将 Ctags 与 Vim 一起使用。目前，我的标签设置如下：

```
set tags=./tags;/ 
```

我有一个目录`~/.ctags`，其中包含诸如：等文件，这些文件`~/.ctags/rails`基本上`~/.ctags/laravel`是为特定项目生成的 ctags，我可能需要从我的其他项目中获取这些文件。

有没有办法，我可以告诉 Vim 包含所有这些文件以用于 ctags 目的？就像是：

```
set tags+=~/.ctags/* 
```

有人还可以向我解释使用这种方法与在单个文件中生成我所有的 ctags（来自 ruby​​、php、python 等项目）的优缺点吗？

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:45:18.410

`:help 'tags'`解释：

> 文件名本身不能包含通配符，它​​按原样使用。

因此，您要么需要在启动时显式添加所有标签：

```
for tagfile in split(glob('~/.ctags/*'), "\n")
    let &tags .= ',' . tagfile
endfor 
```

或更改您的标记生成以将同名文件放在子目录中。然后您可以使用`*`通配符将它们全部包含在内：

```
set tags+=~/.ctags/*/tags 
```

我没有太多使用标签，但我认为将它们分开是一个好习惯。毕竟，Vim 确实支持多个标签文件位置。

# java - 未读取 Json 文件 - Java/Gson

> ID：12916744
> 
> 赞同：0
> 
> 时间：2012-10-16T14:17:39.140
> 
> 标签：java, json, gson

我整理了几行代码来使用 Google 的 GSON 库读取 Json，但在运行时收到错误消息。我不确定它是什么，但我怀疑它可能是 json 的格式

错误：

```
Exception in thread "main" com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_ARRAY but was BEGIN_OBJECT at line 1 column 2
    at com.google.gson.Gson.fromJson(Gson.java:806)
    at com.google.gson.Gson.fromJson(Gson.java:761)
    at tweetfeedreader.main(tweetfeedreader.java:18)
Caused by: java.lang.IllegalStateException: Expected BEGIN_ARRAY but was BEGIN_OBJECT at line 1 column 2
    at com.google.gson.stream.JsonReader.expect(JsonReader.java:339)
    at com.google.gson.stream.JsonReader.beginArray(JsonReader.java:306)
    at com.google.gson.internal.bind.CollectionTypeAdapterFactory$Adapter.read(CollectionTypeAdapterFactory.java:79)
    at com.google.gson.internal.bind.CollectionTypeAdapterFactory$Adapter.read(CollectionTypeAdapterFactory.java:60)
    at com.google.gson.Gson.fromJson(Gson.java:795)
    ... 2 more 
```

代码：

```
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.lang.reflect.Type;
import java.util.ArrayList;

import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;

public class tweetfeedreader {
    public static void main(String args[]) throws FileNotFoundException {

        ArrayList<tweet> tCollection = new ArrayList<tweet>();
        Gson gson = new Gson();
        BufferedReader bufferedReader = new BufferedReader(new FileReader(
                "C:/Users/DX029/Desktop/jsonfile.txt"));
        Type type = new TypeToken<ArrayList<tweet>>(){}.getType();
        ArrayList J_tweet = (ArrayList<tweet>)gson.fromJson(bufferedReader, type);
        supertweet sup = new supertweet();
        for(tweet t: sup.result){
            System.out.println(t.text);
        }
    }
} 
```

鸣叫

```
public class tweet {
    String from_user;
    String from_user_name;
    String profile_image_url;
    String text;

    public tweet(){
            }

} 
```

超级推文

```
import java.util.ArrayList;

public class supertweet {
    ArrayList<tweet> result;

    public supertweet(){

        result = new ArrayList<tweet>();
    }

    public void setResult(ArrayList<tweet> result)
    {
        result = result;
    }
} 
```

添加 Json 会占用太多空间，所以这里是链接。 [http://pastebin.com/rPrbfPMb](http://pastebin.com/rPrbfPMb)

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:22:38.057

您在实际获取对象时尝试将 Json 转换为数组。

尝试更改您的代码：

```
//you need to create this object
TweetObject J_tweet = (TweetObject) gson.fromJson(bufferedReader, type); 
```

# svn - 当 Repo 根本没有主干/分支/标签结构时，如何从 SVN 转换为 HG？

> ID：12916749
> 
> 赞同：1
> 
> 时间：2012-10-16T14:17:48.607
> 
> 标签：svn, mercurial, migration

我有一个 SVN 存储库，根本没有主干/分支/标签结构（不好，我知道...），所以所有项目都直接位于存储库中。当我尝试 hg convert 时，它说 `file:///c/MySvnRepo does not look like a Subversion repository`

我试图创建主干/分支/标签文件夹并将所有内容移动到主干。然后我得到了一个具有我期望的结构的 HG 回购，但它的历史始于我将内容移动到主干的修订。

我还尝试了选项`--config convert.svn.trunk=xy`，其中 xy 是空白或任何包含的项目。它仍然中止说“......看起来不像......”

我在 Windows 7 64 位、SVN 1.7.2、Mercurial 1.9.3

我发现了很多关于更复杂结构的问题，但对于这个简单的结构却没有。也许答案太简单了，我看不到。

任何帮助表示赞赏。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:54:32.447

添加 hgsubversion 扩展并使用相应的 URL 克隆存储库的任何部分。

从未尝试使用 file:// 协议，但看不到与 svn|http 不同行为的原因

**样本**

```
z:\>dir /B
svn-repo
hg-repo
wc 
```

* * *

```
z:\>svn ls -v file:///Z:/svn-repo
      3 Badger                окт 20 01:47 ./
      3 Badger             42 окт 20 01:47 data.txt 
```

* * *

```
z:\>hg help subversion
Working with Subversion Repositories
... 
```

* * *

```
z:\>hg clone --verbose -- file:///Z:/svn-repo Z:\hg-repo
using single layout
[r1] Badger: Ininial data
A data.txt
substituting author "Badger" for default "Badger@7b881c4c-2bda-1f48-a8b3-d2b14f06ee49"
data.txt
 committed to "default" as 7965fdc9055d
[r2] Badger: Change 1
M data.txt
data.txt
 committed to "default" as c266778f29c0
[r3] Badger: Add-on
M data.txt
data.txt
 committed to "default" as 2aa45237e3b3
pulled 3 revisions
updating to branch default
resolving manifests
getting data.txt
1 files updated, 0 files merged, 0 files removed, 0 files unresolved 
```

* * *

```
z:\>cd hg-repo

z:\hg-repo>hg log
changeset:   2:2aa45237e3b3
tag:         tip
user:        Badger@7b881c4c-2bda-1f48-a8b3-d2b14f06ee49
date:        Fri Oct 19 19:47:54 2012 +0000
summary:     Add-on

changeset:   1:c266778f29c0
user:        Badger@7b881c4c-2bda-1f48-a8b3-d2b14f06ee49
date:        Fri Oct 19 19:47:00 2012 +0000
summary:     Change 1

changeset:   0:7965fdc9055d
user:        Badger@7b881c4c-2bda-1f48-a8b3-d2b14f06ee49
date:        Fri Oct 19 19:46:09 2012 +0000
summary:     Ininial data 
```

# xslt - 获取元素的前一个兄弟？

> ID：12916756
> 
> 赞同：0
> 
> 时间：2012-10-16T14:18:20.153
> 
> 标签：xslt

在这个平面 XML 中，我如何获得具有给定名称的公司的“直系父母”？我的意思是一个具有 Level = 0 并且是给定公司之前的第一个元素的元素。

因此，鉴于公司名称是 VI 需要获得公司 Z。

```
<Companies>
  <Company>
     <Name>X</Name>
     <Level>1</Level>
   </Company>
   <Company>
     <Name>Y</Name>
     <Level>1</Level>
   </Company>
   <Company>
     <Name>Z</Name>
     <Level>0</Level>
   </Company>
  <Company>
     <Name>V</Name>
     <Level>1</Level>
   </Company>
</Companies> 
```

这不工作？

```
<xsl:value-of select="Companies/Company[Name='V']/preceding-sibling[Level=0]/last() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:35:03.020

在你的`<xsl:value-of select="...">`，你可以改变

```
Companies/Company[Name='V']/preceding-sibling[Level=0]/last() 
```

到

```
(Companies/Company[Name='V']/preceding-sibling::*[Level=0])[last()] 
```

笔记：

*   与任何轴一样，前面的兄弟轴必须后跟`::`一个节点测试（例如`*`）。
*   `last()`不是您想要的位置步骤（尽管它在 XSLT 2.0 中可能是合法的......我不确定）。相反，您希望它在 predicate`[` `]`中。谓词`[last()]`是 的简写`[position() = last()]`。
*   我之前把括号括起来`[last()]`的原因是@Lukasz 提到的一个原因： The`preceding-sibling::`有一个相反的方向。

因此，如果您说`preceding-sibling::*[last()]`您以相反的顺序获得最后一个前面的兄弟，即*文档*顺序中的第一个前面的兄弟！由于您实际上想要文档顺序中的*最后*一个同级，因此您可以`preceding-sibling::*[1]`像@Lukasz 那样做；或者你可以用我所做的`(...)[last()]`。两者都是有效的。我稍微喜欢后者，我将在下面解释。

该`(...)[last()]`表单有效，因为括号强制`[last()]`谓词应用于*整个 XPath 表达式*直到该点，而不是仅应用于具有`preceding-sibling::`轴的步骤。结果，谓词被应用于不受`preceding-sibling::`轴反向控制的表达式。*因此，我们按文档*顺序选择（给定集合的）最后一个节点。

如果没有括号，在某些 XPath 表达式中，谓词和轴的关联性可能会令人惊讶。您必须对优先规则有所了解。诚然，我对学习优先规则的细节有点懒惰。但是我的经验（在许多编程语言中）一直是，依靠不那么明显的解析优先级规则是确保您的代码被下一个出现并尝试调试或修改它的人误解或弄乱的好方法。（通常那个“下一个人”就是我自己，一个月后。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:28:48.580

以下 XSLT 片段将从提供的示例 XML 中检索先前的 Company 元素：

```
<xsl:copy-of select="Companies/Company[Name='V']/preceding-sibling::*[1]" /> 
```

这将是：

```
<Company>
    <Name>Z</Name>
    <Level>0</Level>
</Company> 
```

如您所见，我们正在访问**第一个**节点 ( `*[1]`) - 这似乎违反直觉 - 您可以[在此处](http://www.infopathdev.com/blogs/greg/archive/2005/06/13/Using-XPath_2700_s-_2700_preceding_2D00_sibling_2700_-Axis-Correctly.aspx)找到进一步的解释。

编辑：我不确定您是否要考虑 Level=0 条件。

# connection-pooling - 带有 jmx 的 Spring 数据源连接管理器以公开实时连接数

> ID：12916760
> 
> 赞同：2
> 
> 时间：2012-10-16T14:18:39.757
> 
> 标签：connection-pooling, spring-jdbc, spring-jmx

使用`java/Spring/Ibatis sqlserver`的是数据库，下面`datasource`是`org.apache.commons.dbcp.BasicDataSource`数据源对象我想公开实时连接池计数，比如现在有多少正在使用，有多少处于空闲状态，我想用`jmx`任何快速的想法来监控如何实现

```
<bean id="wssModelDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="net.sourceforge.jtds.jdbcx.JtdsDataSource"/>
    <property name="url" value="com.wss.jdbc.ConnectionUrl=jdbc:jtds:sqlserver://x-x2/x_control_QA;appName=wss;sendStringParametersAsUnicode=false;loginTimeout=20;socketTimeout=180"/>
    <property name="username" value="xxx"/>
    <property name="password" value="xxx"/>
    <property name="maxActive" value="10"/>
    <property name="maxWait" value="10000"/>
  </bean> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T10:13:56.500

接受的答案并没有真正告诉你如何做到这一点。如果您使用 Spring，一个可能的解决方案是使用`MethodNameBasedMBeanInfoAssembler`并列出`BasicDataSource`您需要公开的方法。假设您有一个配置了 id 的 bean，`dataSource`请将其添加到您的[Spring XML 配置](https://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-instantiation)中：

```
<bean id="mbeanServer" class="org.springframework.jmx.support.MBeanServerFactoryBean">
    <property name="locateExistingServerIfPossible" value="true" />
</bean>
<bean id="mbeanExporter" class="org.springframework.jmx.export.MBeanExporter">
    <property name="assembler">
      <bean class="org.springframework.jmx.export.assembler.MethodNameBasedMBeanInfoAssembler">
        <property name="managedMethods">
        <list>
          <value>getNumActive</value>
          <value>getMaxActive</value>
          <value>getNumIdle</value>
          <value>getMaxIdle</value>
          <value>getMaxWait</value>
          <value>getInitialSize</value>
          </list>
        </property>
      </bean>
    </property>
    <property name="beans">
        <map>                   
        <entry key="dataSource:name=DataSource" value-ref="dataSource"/>    
    </map>
    </property>
    <property name="server" ref="mbeanServer" />
    </bean>
</beans> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:02:54.227

是的，我们可以做到，只需为您的 dao 类启用 jmx，该类注入了 jdbcTemplate 并被 dao 方法使用，并使用创建公共 getter 方法返回以下方法的值，然后 jmx 可以为您监控。

[http://commons.apache.org/dbcp/apidocs/org/apache/commons/dbcp/BasicDataSource.html](http://commons.apache.org/dbcp/apidocs/org/apache/commons/dbcp/BasicDataSource.html)

```
getMinIdle() 
          Returns the minimum number of idle connections in the pool.
 int    getNumActive() 
          [Read Only] The current number of active connections that have been allocated from this data source.
 int    getNumIdle() 
```

# android - IDEA 中的 ClassNotFoundException 与 AndroidAnnotations

> ID：12916761
> 
> 赞同：1
> 
> 时间：2012-10-16T14:18:40.770
> 
> 标签：android, intellij-idea, android-annotations

我正在尝试将 AndroidAnnotations 添加到我的 maven/idea 项目中。这是我现在拥有的：

### 显现

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="ua.avtopoisk"
      android:versionCode="1" android:versionName="0.5">

<uses-sdk android:minSdkVersion="1"
          android:targetSdkVersion="8"/>

<uses-permission android:name="android.permission.READ_PHONE_STATE"/>

<uses-permission android:name="android.permission.GET_ACCOUNTS"/>
<uses-permission android:name="android.permission.INTERNET"/>

<application android:name=".AvtopoiskApplication" android:icon="@drawable/icon"      android:label="@string/app_name">
    <activity android:name=".activites.SearchActivity_"
              android:screenOrientation="portrait"
              android:configChanges="keyboardHidden|orientation">
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>
    </activity>
    <activity android:name=".activites.SearchResultActivity"
              android:screenOrientation="portrait"
              android:configChanges="keyboardHidden|orientation"
              android:label="@string/app_name"/>
</application> 
```

### maven依赖

```
<dependency>
            <groupId>com.googlecode.androidannotations</groupId>
            <artifactId>androidannotations</artifactId>
            <version>2.6</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>com.googlecode.androidannotations</groupId>
            <artifactId>androidannotations</artifactId>
            <classifier>api</classifier>
            <version>2.6</version>
        </dependency> 
```

### 开始活动

```
@EActivity(R.layout.search)
    public class SearchActivity extends Activity {
    } 
```

我还编辑了我的项目设置，如下所示[https://github.com/ealden/android-annotations-idea-test/blob/master/project-settings-guide.png](https://github.com/ealden/android-annotations-idea-test/blob/master/project-settings-guide.png)

它编译得很好，但是当我尝试运行这个应用程序时，我收到了这个：

```
10-16 16:39:49.789: ERROR/AndroidRuntime(15972): FATAL EXCEPTION: main
            java.lang.RuntimeException: Unable to instantiate activity    ComponentInfo{ua.avtopoisk/ua.avtopoisk.activites.SearchActivity_}:   java.lang.ClassNotFoundException: ua.avtopoisk.activites.SearchActivity_ in loader   dalvik.system.PathClassLoader[/data/app/ua.avtopoisk-2.apk]
            at   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1573)
            at    android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
            at android.app.ActivityThread.access$1500(ActivityThread.java:117)
            at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
            at android.os.Handler.dispatchMessage(Handler.java:99)
            at android.os.Looper.loop(Looper.java:130)
            at android.app.ActivityThread.main(ActivityThread.java:3687)
            at java.lang.reflect.Method.invokeNative(Native Method)
            at java.lang.reflect.Method.invoke(Method.java:507)
            at   com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
            at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
            at dalvik.system.NativeStart.main(Native Method)
            Caused by: java.lang.ClassNotFoundException:   ua.avtopoisk.activites.SearchActivity_ in loader   dalvik.system.PathClassLoader[/data/app/ua.avtopoisk-2.apk]
            at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
            at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
            at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
            at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
            at   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1565)
            ... 11 more 
```

如果您能给我任何提示，我将不胜感激。

### 更新

我发现当我通过 maven 构建我的应用程序时，一切都很好，但是当我通过 IDEA 构建它时，我仍然有 ClassNotFoundException。我仍然不知道出了什么问题

### 更新 2

我尝试使用 eclipse 构建我的项目，但我遇到了同样的错误。我也尝试构建android注释示例项目（HelloWorldEclipse），我也有同样的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T14:16:00.327

我发现问题了！带有生成源的文件夹 gen 被 IDEA 排除（设置->编译器->排除）。现在工作正常，但我仍然很感兴趣，这是真的吗。

# javascript - Jquery淡入淡出，一键淡入淡出

> ID：12916768
> 
> 赞同：0
> 
> 时间：2012-10-16T14:19:02.507
> 
> 标签：javascript, jquery

我有一个问题，它已经做了好几个星期了，我就是无法解决它。

我有几个嵌套列表，里面有隐藏的 div，当单击一个 div 时，隐藏的 div 显示，但是在显示一个 div 之后，当我尝试对另一个 div 执行相同操作时，它只需单击一下即可显示和隐藏，它不是不应该这样做。

HTML 是有效的，javascript 也是有效的，这让我抓狂。

jsfiddle：http: [//jsfiddle.net/amando96/TPZuu/](http://jsfiddle.net/amando96/TPZuu/)

我在本地运行完全相同的东西，但它不起作用，但在 Jsfiddle 中很好......这是一个 jquery 错误还是我没有错的东西？

我注释掉了 JS 和 css 文件中的所有其他行，以防它们受到干扰，但我一直在这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:21:13.537

根据您的描述，这不太可能是 jQuery 中的错误。

如果它在小提琴中有效，但在您的代码中无效，那么您很可能没有完全相同的场景。您的代码中发生了其他一些事情，而小提琴中没有。一些调试指针：

1.  在代码关键点设置断点
2.  到达断点时，检查选择器结果
3.  到达断点时，检查 DOM 状态（是否存在元素等）

# c# - Excel 单元格值替换为 C# Windows 应用程序中的其他值

> ID：12916773
> 
> 赞同：0
> 
> 时间：2012-10-16T14:19:16.430
> 
> 标签：c#, .net, excel, printing, replace

我正在使用 .NET C# 开发 Windows 应用程序。我必须用其他一些文本（我从数据库中获取）替换 Excel 单元格内容。我需要做的是用数据库中的实际值替换 Excel 的值。（例如，“CustomerName”将被“John”替换，“CustomerCompanyName”将被“GE”替换等）。此外，如果某些值不存在，则该空白空间将与其以下值重叠。

我们如何实现这个东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:35:30.513

这取决于。

如果这些只是工作表中的静态值，并且您不希望在更新它们时在 excel 中执行计算，那么只需使用[OpenXml](http://msdn.microsoft.com/en-us/office/ee358824.aspx) 来编辑电子表格。

否则，您将不得不使用 Office Interopt 或一些第三方 excel 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T06:31:37.113

如果您想使用 OpenXml，您将[在此处](http://msdn.microsoft.com/en-us/library/hh298534%28v=office.14%29)了解如何读取 Excel 文档中单元格的值，以及如何在单元格中[写入](http://msdn.microsoft.com/en-us/library/cc861607%28v=office.14%29)值。

您可以使用的另一个免费库是[NPOI](http://npoi.codeplex.com/)。这些说明让您初步了解如何读取/写入单元格的数据并保存修改后的文件：

```
 FileStream aFile = new FileStream(@"c:\tmp\foo.xls", FileMode.Open, FileAccess.Read);
        HSSFWorkbook wb = new HSSFWorkbook(aFile);
        aFile.Close();
        ISheet ws = wb.GetSheet("Worksheet1");

        IRow aRow = curSheet.GetRow(aRowIdx);
        if (aRow == null)
            aRow = curSheet.CreateRow(aRowIdx);
        ICell aCell = aRow.GetCell(aColIdx);
        if (aCell == null)
            aCell = aRow.CreateCell(aColIdx);
        string sValue = aCell.StringCellValue; // here the value is read
        sValue = sValue + " MODIFIED";
        aCell.SetCellValue(sValue); // here it is written
        aFile = new FileStream(@"c:\tmp\bar.xls", FileMode.Create);
        wb.Write(aFile);
        aFile.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:45:02.670

我正在使用来自[http://www.tmssoftware.net/](http://www.tmssoftware.net/)（无从属关系）的 FlexCel，它很棒。价格合理，速度快，所有托管代码和开发人员似乎知道他在说什么，并且对查询也非常敏感。

1000% 比 Office 互操作库恕我直言。

过去，我通过互操作库访问 Excel，对于服务器，我使用了 ODBC/OLE-DB 驱动程序，但总是遇到困难。

# java - Jackson ObjectMapper 无法反序列化 POJO，抛出异常：没有找到适合类型 [...] 的构造函数：无法从 JSON 对象实例化

> ID：12916774
> 
> 赞同：23
> 
> 时间：2012-10-16T14:19:19.117
> 
> 标签：java, json, spring, jackson

我试图测试以下代码但没有成功：

```
class TestClass
{
  private class ND2Customer
  {
    public String name;
    public String description;
    public String email;
    public Boolean multiuser;

    public String dnszone;
    public String uri;
    public String type;

    public ND2Customer()
    {

    }
  }

  @Test
  public void TestJackson() throws JsonParseException, JsonMappingException, IOException
  {
    String json="{\"description\": \"test1u\", \"dnszone\": \"test1.public.sevenltest.example.com.\", \"uri\": \"http://199.127.129.69/customer/test1\", \"multiuser\": true, \"type\": \"2.0.3-3146\", \"email\": \"test1@com.com\", \"name\": \"test1\"}";
    ObjectMapper mapper = new ObjectMapper();

    ND2Customer casted=mapper.readValue(json, ND2Customer.class);

    String castedback=mapper.defaultPrettyPrintingWriter().writeValueAsString(casted);
    System.out.println(castedback);
  } 
} 
```

这个问题与这个问题不同： [Deserializing JSON with Jackson - Why JsonMappingException "No proper constructor"?](https://stackoverflow.com/questions/8367445/deserializing-json-with-jackson-why-jsonmappingexception-no-suitable-construc)

而这个： [JsonMappingException：没有找到适合类型[简单类型，类]的构造函数：无法从 JSON 对象实例化](https://stackoverflow.com/questions/7625783/jsonmappingexception-no-suitable-constructor-found-for-type-simple-type-class)

而这个： [JsonMappingException：没有找到适合类型[简单类型，类]的构造函数：无法从 JSON 对象实例化](https://stackoverflow.com/questions/7625783/jsonmappingexception-no-suitable-constructor-found-for-type-simple-type-class)

因为我手动覆盖了默认构造函数，它不是子类。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-10-16T16:47:24.550

使其成为静态的。杰克逊不能反序列化到内部类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:23:14.710

问题可能是 Jackson 无法正确访问您的`ND2Customer`类以调用其构造函数，因为它是`private`，因为您的类看起来很好。尝试制作它`public`，看看它是否有效。

# java - 编译 Java 源文件时出错

> ID：12916776
> 
> 赞同：0
> 
> 时间：2012-10-16T14:19:29.523
> 
> 标签：java

我是 Java 的初学者，我创建了这个类：

```
class test
{
    public static void main(String[] args)
    {
        System.out.println("Hello World!");
    }
} 
```

作为 test.java，当我用这个 cmd 编译它时：

```
javac C:\Users\Aimad\Desktop\test.java 
```

接着：

```
java C:\Users\Aimad\Desktop\test.class 
```

我收到了这个错误：

> 无法找到或加载主类 C:\Users\Aimad\Desktop\test.class

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:41:08.050

你所写的问题是你添加了“.class”。通过编写此代码，您已指示 Java.exe 在您当前所在目录下名为“test”的目录中查找名为“class”的类文件。为了使您的代码正常工作，请删除“.class”扩展名，您需要首先在命令行中导航到文件。此外，包含您的 main 方法的类必须声明为“public”。

**代码**

```
public class test
{
    public static void main(String[] args)
    {
        System.out.println("Hello World!");
    }
} 
```

**命令行**

```
cd C:\Users\Aimad\Desktop
java test 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:47:52.520

The solution is either:

```
% cd C:\Users\Aimad\Desktop
% java test 
```

or

```
% java -cp C:\Users\Aimad\Desktop test 
```

* * *

Explanation:

1.  The argument to the `java` command must be the fully qualified name of the class. In your case, since your class is declared in the "default" package, the FQN is "test".

2.  The `java` command needs to be able the class (i.e. the "test.class" file) via its classpath. The default java classpath is `.` so the first solution is to change to the directory containing the "test.class" file and so that it can be accessed as ".\test.class". The second solution uses the `-cp` argument to specify a non-default classpath.

Note that using a pathname to identify the class won't work, either with the ".class" suffix, or with the ".class" suffix removed ... (except as above)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:21:04.657

试试看::

```
java C:\Users\Aimad\Desktop\test 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:29:15.653

转到 .class 文件所在的目录并键入命令以运行程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T14:29:24.297

因为`execution`，你不需要写`java C:\Users\Aimad\Desktop\test.class` 。**class**文件是机器可读的，所以我们不需要调用它们。

只需添加`public class` `name`唯一的，例如`java C:\Users\Aimad\Desktop\test`

[在这里](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javac.html)阅读

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-16T14:28:02.777

$cd C:\Users\Aimad\Desktop $java -cp 。测试

并将课程公开

运行程序时无需指定 .class 和路径，它应该是完全限定的类名:)

# android - 操作栏上的图标优先级

> ID：12916777
> 
> 赞同：6
> 
> 时间：2012-10-16T14:19:32.157
> 
> 标签：android, resources

如果在一个操作栏上显示了多个图标`android:showAsAction="ifRoom"`并且没有足够的空间放置所有图标，Android 如何决定，显示什么图标？是否可以设置相对图标重要性？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T14:27:40.973

您应该使用[文档](http://developer.android.com/guide/topics/resources/menu-resource.html)`android:orderInCategory`中的 , ：

> 整数。组内项目的“重要性”顺序。

# json - 使用 JavaScriptSerializer 创建 json

> ID：12916779
> 
> 赞同：0
> 
> 时间：2012-10-16T14:19:32.580
> 
> 标签：json, javascriptserializer, generic-handler

我在 Asp.net 的通用处理程序中有以下代码：

```
 var students= Student.GetStudents();
    var result = new
    {
        Data = students.Select(s => new []{s.subjects})              
    };

    var serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
    var json = serializer.Serialize(result);                
    context.Response.ContentType = "application/json";
    context.Response.Write(json); 
```

应用于班级`Student`：

```
public class Student
{
    public List<String> subjects{get; set;}

    Student()
    {
        subjects= new List<string>();
    }    

    public static IEnumerable<Student> GetStudents()
    {       
        List<Student> students= new List<Student>();

        Student s1 = new Student();
        s1.subjects.Add("Trigonometry");
        s1.subjects.Add("Chemistry");
        students.Add(row1);

        Student s2 = new Student();
        s2.subjects.Add("Physics");
        s2.subjects.Add("Biology");
        students.Add(s2);

        return students;
   }
} 
```

这给了我输出：

```
{"Data":[[["Trigonometry","Chemistry"]],[["Physics","Biology"]]]} 
```

但我希望它采用以下格式：

```
{"Data":[["Trigonometry","Chemistry"],["Physics","Biology"]]} 
```

JavaScriptSerializer 是如何工作的？
为什么要创建另一个数组？
我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T05:18:33.773

它并不完美，但对我有用：

```
var rows = Row.GetRows();
StringBuilder sb = new StringBuilder("\"aaData\":[");

for (int i = 0; i < rows.Count; i++)
{
    if (i == 0){  sb.Append("[");  }
    else  {  sb.Append(",[");  }
    for (int j = 0; j < rows[i].fields.Count; j++)
    {
        if (j == 0){
            sb.Append("\"" + rows[i].fields[j].ToString() + "\"");
        }
        else{
            sb.Append(",\"" + rows[i].fields[j].ToString() + "\"");
        }
    }
    sb.Append("]");            
}
sb.Append("]}");

var json = sb.ToString();

context.Response.ContentType = "application/json";
context.Response.Write(json); 
```

由于向json对象`JavaScriptSerializer`添加了一个`[]`，我尝试不使用它并手动创建json字符串。

让我知道使用这种方式的利弊。

# php - MVC 模式在事务中保存多个模型的常用做法

> ID：12916781
> 
> 赞同：2
> 
> 时间：2012-10-16T14:19:35.010
> 
> 标签：php, yii, transactions, yii-cmodel

我想在一个事务中保存两个模型，但它将用于多个视图。

我应该将该交易放在其中一个模型中吗？或者我应该以某种方式重用控制器动作？

在这种情况下，MVC 模式的最佳实践是什么？

注意：我的视图由多个模型组成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:45:49.540

这取决于您的业务逻辑是否告诉您每次保存模型 A 时，模型 B 也应该更新/创建。然后将事务放入您的模型中，这样无论您在哪里调用它（控制器、CLI），它对于您的逻辑都是正确的。

另一方面，如果此事务仅对当前用户请求重要，则将其放入您的控制器中。

此时视图无关紧要，您的视图中可以有任意数量的模型。它与您的业务逻辑无关。

# clojure - Clojure Koans：难以理解序列理解部分

> ID：12916782
> 
> 赞同：3
> 
> 时间：2012-10-16T14:19:35.680
> 
> 标签：clojure, sequences

我是 Clojure 的新手，所以最近几天我一直在阅读[Clojure Koans 。](https://github.com/functional-koans/clojure-koans)[在序列理解部分](https://github.com/functional-koans/clojure-koans/blob/master/src/koans/11_sequence_comprehensions.clj)之前，事情进展得相当顺利。我在这部分苦苦挣扎。[答案](https://github.com/functional-koans/clojure-koans/blob/master/resources/koans.clj)是可用的，但我不明白他们是*如何*得出这些答案的。在过去的两天里，我读了很多关于 Clojure 的文章，但它与 Ruby 有很大的不同，以至于我需要一段时间才能理解它。

该部分有五个“问题”，我无法弄清楚。以下是两个让我特别困惑的问题示例：

```
"And also filtering"
(= '(1 3 5 7 9)
  (filter odd? (range 10))
  (for [index __ :when (odd? index)]
    index))

"And they trivially allow combinations of the two transformations"
(= '(1 9 25 49 81)
  (map (fn [index] (* index index))
    (filter odd? (range 10)))
  (for [index (range 10) :when __]
    __)) 
```

对于有使用 Clojure 经验的人，您能否解释一下他们是如何得出本节的解决方案的？不管我读了多少关于序列的内容，我都无法理解这一节。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:50:09.900

我假设你理解`map`和`filter`函数，我猜它们也存在于 Ruby 中。让我给你一个例子，可能可以帮助你理解`for`在这种情况下的使用。

```
(map <some function to map a value> 
  (filter <some function to return true OR false to filter values>
          <a sequence of values>)) 
```

上面的代码使用函数对一系列值进行`filter`过滤，然后使用函数将过滤后的序列的每个值映射到其他值`map`。

`for`基本上允许你做同样的事情，如下所示

```
(for [index <a sequence of values> 
     :when <some expression to return true OR false by check index value>]
     (<some expression to map a value i.e transform index to something else>)) 
```

我希望上面的例子能让你能够映射如何使用`map`和`filter`代码来表达`for`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T16:13:28.877

这种解释有所帮助，并且在将自己沉浸在 Clojure 中几天之后，我对这种语言感到更加自在。为了确保我理解，我将完成这两个测试。

```
"And also filtering"
(= '(1 3 5 7 9)
  (filter odd? (range 10))
  (for [index (range 10) :when (odd? index)]
    index)) 
```

`'(1 3 5 7 9)`是 0 到 9 之间所有奇数
`(filter odd? (range 10))`的列表。返回集合中所有项目的列表，这些项目`(range 10)`在检查时评估为真`odd?`。返回值等于第一个列表。
`(for)`基本上是一个for循环。它是迭代的。`(for [index (range 10)] index)`会将 0 到 9 之间的所有数字绑定到变量`index`然后返回`index`，对吗？所以加上奇数`(for [index __ :when (odd? index)] index))`的条件。`index`返回值等于前两个。

那是对的吗？

```
"And they trivially allow combinations of the two transformations"
(= '(1 9 25 49 81)
  (map (fn [index] (* index index))
    (filter odd? (range 10)))
  (for [index (range 10) :when (odd? index)]
    (* index index))) 
```

这里`map`函数接受一个函数。这个匿名函数接受一个参数并将该参数与自身相乘。`map`将把这个函数应用于它传递的集合中的每个元素。该集合是 0 到 9 之间的奇数。

`for`将在变量为奇数时将每个数字从 0 到 9 设置为变量`index`，然后返回每个数字平方的惰性序列。

我的解释正确吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:34:28.197

你了解它是如何`for`工作的吗？您是否[在 Clojure API 文档中阅读过它](http://clojuredocs.org/clojure_core/clojure.core/for)？如果您知道如何使用`for`，那么您将无需做任何事情来“找到”这两个问题的解决方案；它们将是不言而喻的。

这些问题的目的是让您推断如何`for`工作。如果他们没有帮助您做到这一点，那么您最好阅读该主题。如果您在 上查找一些信息`for`，但发现难以理解，请编辑此问题以准确说明您的困惑之处，我（或其他人）可以尝试解释。

# php - 分类过滤器仅过滤 10 个结果

> ID：12916784
> 
> 赞同：1
> 
> 时间：2012-10-16T14:19:42.290
> 
> 标签：php, wordpress

在 Wordpress 中，我有一个房地产经纪人网站，它有 3 种分类法——出售、出租和商业。在模板中，我有一个 while 循环，它不限制过滤的属性数量，虽然它没有分页，但它应该是无限的。

所以我不知道为什么，但它只显示 10。

这是我的代码：

```
 <?php while ( have_posts() ) : the_post(); ?>

                <div class="entry-content">
                    <a href="<?php the_permalink(); ?>" title="<?php printf( esc_attr__( 'Permalink to %s', 'toolbox' ), the_title_attribute( 'echo=0' ) ); ?>" rel="bookmark"><?php if ( has_post_thumbnail() ) {
                        the_post_thumbnail();
                    } ?>
                <div class="entry-info">
                <h1><?php the_title() ?>  <span class="price"><?php echo get_post_meta($post->ID, "_property_info_price", true); ?></span></h1>
                    <?php the_excerpt(); ?></a>
                </div>

                </div> 
```

这里也是解释我的意思的网站链接。在后端，为“待售”属性创建了 21 个属性，但仅显示了 10 个。在搜索中也是如此（来自主页）。

[http://www.james-hayward.com/property_type/for-sale/](http://www.james-hayward.com/property_type/for-sale/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:24:42.663

By default WordPress is showing the last 10 posts (see under settings > reading > "Blog pages show at most"). You can either change that setting or make you own custom query in your template page (See the [WP_Query documentation](http://codex.wordpress.org/Class_Reference/WP_Query) for examples).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:26:05.093

很可能您没有指定要显示的帖子数量，因此 wordpress 使用在管理部分中设置的值，默认情况下为 10。要么更改（在管理 -> 设置 -> 阅读中），要么指定有多少帖子你想在查询中获取。

```
$args = array(
    /* taxonomy and post type args */
    posts_per_page => -1 // -1 is unlimited.
);

$the_query = new WP_Query($args);
if($the_query->have_posts()) : while($the_query->have_posts()) : $the_query->the_post();
      /* Your markup and stuff goes here */
endwhile; endif; 
```

# jsf-2 - 目标模型类型不是集合或数组

> ID：12916794
> 
> 赞同：0
> 
> 时间：2012-10-16T14:20:09.057
> 
> 标签：jsf-2

我使用 JQuery 在 2 选择多个列表框之间移动元素（来回）。下面是我的 JQuery 代码。

```
<script type="text/javascript">

$(document).ready(function() {
    alert('inside function');
    $('#testForm\\:button_add').click(function(e) {
    var selectedOpts = $("#testForm\\:select_from option:selected");
    if (selectedOpts.length == 0) {
    alert("Nothing to move.");
    e.preventDefault();
    }
    $('#testForm\\:select_to').append($(selectedOpts).clone());
    $(selectedOpts).remove();
    e.preventDefault();
    });
    $('#testForm\\:button_remove').click(function(e) {
    var selectedOpts = $("#testForm\\:select_to option:selected");
    if (selectedOpts.length == 0) {
    alert("Nothing to move.");
    e.preventDefault();
    }                                               
    $('#testForm\\:select_from').append($(selectedOpts).clone());
    $(selectedOpts).remove();
    e.preventDefault();
    });
    });

</script> 
```

下面是我的 JSF 代码：

```
<td width="40%">
    <h:selectManyListbox value="#{testListBox.selectManyOptions}" id="select_from" size="5" >

    <f:selectItems value="#{testListBox.selectedOptions}" />
</h:selectManyListbox>
</td>
<td></td>
<td width="40%">
    <h:commandButton value="To" id="button_add"/><br/>
    <h:commandButton value="From" id="button_remove"/>
</td>
<td></td>
<td>
    <h:selectManyListbox id="select_to" size="5"
                        value="#{testListBox.selectedItems}">
    <f:selectItems />
</h:selectManyListbox>
</td> 
<td></td> 
```

在页面 bean 中，我用相应的 getter/setter 声明了相应的绑定变量，如下所示。

```
private Map<String, Object> selectedOptions;
private Map<String, Object> selectManyOptions;

private List<SelectItem> selectItems = new ArrayList<SelectItem>();
private List<String> selectedItems; 
```

现在我在提交我的页面时遇到错误。“目标模型类型不是集合或数组”任何人都可以建议它阻止我的导航吗？- 瓦姆西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T01:46:01.387

您的具体问题是因为您使用`Map`而不是`Collection`或`Object[]`as `value`of引起的`<h:selectManyListbox>`。该组件不支持`Map`as 值。

如果你更换

```
private Map<String, Object> selectedOptions;
private Map<String, Object> selectManyOptions; 
```

经过

```
private List<String> selectedOptions;
private List<String> selectManyOptions; 
```

*（或`String[]`）*

那么这个特殊问题应该会消失。

* * *

**与具体问题无关**，在你解决了这个问题之后，你无疑会面临一个新的问题。为了避免再次提出另一个问题，下面是答案：[如何在 JSF 中创建选择列表？尝试使用 JS/jQuery 移动项目，但使用“验证错误：值无效”提交错误](https://stackoverflow.com/questions/12874394/how-to-create-a-picklist-in-jsf-tried-moving-items-using-js-jquery-but-submit/12882040#12882040)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:28:19.303

你有`<f:selectItems value="#{testListBox.selectedOptions}" />`where selectedOptions 是一个不是集合的地图。`SelectItem`在 的值中使用 的集合`f:selectItems`。

# linux - Bash java自动编译器

> ID：12916797
> 
> 赞同：2
> 
> 时间：2012-10-16T14:20:18.223
> 
> 标签：linux, bash, javac

我目前正在尝试制作一个 bash 脚本，该脚本将进入 ./ 中的每个文件夹并编译 blah.java，然后运行 ​​blah 发送一个数字作为输入，并将输出放入我命名的文件中。我有一些功能性很强的东西，但它只进入第一个目录，之后它在我身上失败了。我目前有...

```
#! /bin/bash

for i in $(find . -maxdepth 1 -type d)
do

    pwd
    cd $i
    pwd

    if [ -f "blah.java" ];
    then
        javac -cp . blah.java
        echo "17" | java -cp . blah - > blahresult17
        echo "43" | java -cp . blah - > blahresult43

    fi

done 
```

我认为它有问题，因为一旦进入子目录，它就会尝试从 ./ 进入目录，但显然从子目录中它不存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:22:47.400

你`cd`进入目录但永远不会`cd`离开它。

我的建议：使用[`pushd`/`popd`](https://en.wikipedia.org/wiki/Pushd_and_popd)而不是`cd`.

替换`cd $i`为`pushd "$i"`并放在`popd`循环的末尾。

`for dir in */`迭代当前目录中的所有目录也是一个更简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:24:40.027

您的 if 缺少 fi，但这可能是剪切和粘贴错误，而不是您失败的根源。可能的问题是，一旦您执行了第一个 cd，以下 cd 命令与您所在的位置相关，而不是您现在所在的位置。您可以使用 pushd/popd 来解决此问题，或者在子 shell 中运行 cd 和 java 位，以便 cd 不会持续到下一个循环迭代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-25T18:27:40.113

这是另一种方式，如果您想通过一次调用 javac 来编译所有文件，这允许 javac 处理依赖项：

```
SRC=`find src -name "*.java"`
if [ ! -z $SRC ]; then
    javac -classpath $CLASSPATH -d obj $SRC
    # stop if compilation fails
    if [ $? != 0 ]; then exit; fi
fi 
```

# javascript - Javascript 高级事件冒泡

> ID：12916798
> 
> 赞同：3
> 
> 时间：2012-10-16T14:20:18.510
> 
> 标签：javascript, events

我的大部分工作都是 jQuery，但是对于即将到来的项目（要求 - 没有 JQUERY 或其他库 - 超出我的控制范围，不要说“使用 jQuery”），我正在恢复到“老派” js ）。我的范围纯粹是最新的浏览器，包括 iOS safari，不需要向后兼容。我正在研究事件处理程序——我有一个可能很疯狂的想法，但我找不到任何相关的东西——可能是因为它很疯狂。

1.  我试图避免将事件直接绑定到元素，因为我将经常用 AJAX 调用替换内容。

2.  我目前的思路是将侦听器绑定到文档。似乎很标准的做法。

但是，我可以跳过所有的事件冒泡吗？我可以以某种方式告诉浏览器忘记它对事件冒泡的了解，并直接跳到文档吗？我意识到如果我这样做，我将无法处理分配给父元素的事件，但考虑到项目范围，我可以忍受这一点，特别是如果它可以提高浏览器的熟练度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:29:05.237

真的，跳过冒泡阶段不是一种选择。但由于您只希望支持现代浏览器，您可以简单地捕获顶级 ( `document`) 级别的事件，并调用该`stopPropagation`方法。
这样，事件永远不会到达目标/srcElement，也永远不会到达冒泡阶段：

```
document.body.addEventListener('click',function(e)
{
    e.stopPropagation();
    //handle event
},true);//<-- true for capturing 
```

更多关于捕捉的信息，[可以在 quirksmode 上找到](http://www.quirksmode.org/js/events_order.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:21:28.820

> 我可以跳过所有事件冒泡吗？

不，浏览器不提供这样做的方法。

# list - 当对象是动态的时，如何在Scala中对列表进行排序？

> ID：12916799
> 
> 赞同：2
> 
> 时间：2012-10-16T14:20:24.580
> 
> 标签：list, scala, sorting

我在 Scala 中有以下层次结构

```
abstract class MyAbstractClass
case class Child1(alpha: MyAbstractClass, points: Int) extends MyAbstractClass
case class Child2(beta: Char, points: Int) extends MyAbstractClass 
```

现在我有一个列表 List(MyAbstractClass type objects ... Chil1 或 Child2 )

我想根据点对上面的列表进行排序。如何在 Scala 中编写这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:27:40.437

您应该添加一个调用`points`到您的基类的方法：

```
abstract class MyAbstractClass { def points:Int } 
```

子类已经实现了这个方法，因为它们是案例类，所以你不需要改变它们。

```
case class Child1(alpha: MyAbstractClass, points: Int) extends MyAbstractClass
case class Child2(beta: Char, points: Int) extends MyAbstractClass 
```

然后，您可以使用此方法对列表进行排序。

```
println(List(Child2('a',0),Child1(Child2('b',2),3)).sortBy(_.points)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T16:08:23.557

您可以在这里使用结构类型来帮助您

```
list.sortBy{
  case x: {def points: Int} => x.points
} 
```

sortBy 采用一个函数，当应用于每个元素时将返回要排序的值。case 语句说“如果 x 是具有“点”方法的类型，则返回 x.points

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T15:05:38.813

使用了稍微不同的方法 1) 不向父类添加点 var 2) 不改变类的层次结构

包含 MyAbstractClass 类型的对象的列表

```
list.sortWith((x,y) => point(x) < point(y))

def point(mylist: MyAbstractClass): Int = mylist match {
case Child1(a, p) => p
case Child2(b, p) => p
} 
```

# javascript - 启动 d3.js 强制布局图时出现“无法读取未定义的属性‘权重’”错误

> ID：12916802
> 
> 赞同：2
> 
> 时间：2012-10-16T14:20:30.640
> 
> 标签：javascript, graph, d3.js, force-layout

在我的项目中，我想使用 d3.js 强制布局和以下数据绘制图表。

```
Nodes --> [{"name":"http://dbpedia.org/ontology/abstract","type":"s","group":0},
{"name":"http://www.w3.org/2002/07/owl#DatatypeProperty","type":"o","group":1},
{"name":"http://dbpedia.org/ontology/wikiPageID","type":"s","group":2},
{"name":"http://www.w3.org/2002/07/owl#backwardCompatibleWith","type":"s","group":4},
{"name":"http://www.w3.org/2002/07/owl#OntologyProperty","type":"o","group":5},
{"name":"http://dbpedia.org/ontology/birthDate","type":"s","group":6}, 
{"name":"http://dbpedia.org/ontology/deathDate","type":"s","group":8},
{"name":"http://dbpedia-live.openlinksw.com/sparql","type":"s","group":10},  
{"name":"http://www.w3.org/ns/sparql-service-description#Service","type":"o","group":11},
{"name":"http://www.w3.org/2002/07/owl#incompatibleWith","type":"s","group":12},
{"name":"http://www.w3.org/2002/07/owl#priorVersion","type":"s","group":14},
{"name":"http://dbpedia.org/ontology/wikiPageRevisionID","type":"s","group":16},
{"name":"http://www.w3.org/2002/07/owl#imports","type":"s","group":18}]

Links --> [{"source":0,"target":1,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":2,"target":1,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":4,"target":5,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":6,"target":1,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":8,"target":1,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":10,"target":11,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":12,"target":5,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":14,"target":5,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":16,"target":1,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200},
{"source":18,"target":5,"uri":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","weight":1,"value":200}] 
```

此数据已以这种格式动态准备。在javascript代码中 force.start(); 函数已被调用“无法读取未定义的属性‘权重’”已引发错误。[这个](https://stackoverflow.com/questions/11357974/d3-js-cannot-read-property-weight-of-undefined-when-manually-defining-both-no)相关的问题对我没有帮助，那么我能做什么来防止这个错误。此外，链接数组为空或某些链接已被删除，或者当我使用“miserables.json”作为数据 javascript 时，下面的 javascript 可以成功运行。

```
<script type="text/javascript">
    var w = 900,
        h = 900;
    var color = d3.scale.category10();

    var nodes = eval('(' + '${graphDrawer.nodes}' + ')');

    var links = eval('(' + '${graphDrawer.links}' + ')');

    var vis = d3.select("#activationGraphDiv").append("svg:svg")
        .attr("width", w)
        .attr("height", h);

        var force = d3.layout.force()
            .gravity(.05)
            .linkDistance(100)
            .charge(-200)
            .size([w, h]);

        var link = vis.selectAll("line.link")
            .data(links)
            .enter().append("svg:line")
            .attr("class", "link")
            .attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

        var node = vis.selectAll("g.node")
            .data(nodes)
            .enter().append("svg:g")
            .attr("class", "node")
            .on("mouseover", nodeMouseover)
            .on("mouseout", nodeMouseout);

        node.append("circle")
            .attr("r",10) // Node radius
        .style("fill", "white") // Make the nodes hollow looking
        .style("stroke-width", 4) // Give the node strokes some thickness
        .style("stroke", function(d) { return color(d.group); } ) // Node stroke colors
        .call(force.drag);

        node.append("svg:text")
            .attr("class", "nodetext")
            .attr("dx", 26)
            .attr("dy", ".35em")
            .text(function(d) { return d.name });

        node.append("title")
            .text(function(d) { return d.name; });

        force.on("tick", function() {
          link.attr("x1", function(d) { return d.source.x; })
              .attr("y1", function(d) { return d.source.y; })
              .attr("x2", function(d) { return d.target.x; })
              .attr("y2", function(d) { return d.target.y; });

          node.attr("transform", function(d) { return "translate(" + d.x+ "," + d.y+ ")"; });
        });

        force
          .nodes(nodes)
          .links(links)
          .start();

        function nodeMouseover() {
            d3.select(this).select("circle").transition()
              .duration(250)
              .attr("r",function(d){
                    return 20;
            });
            d3.select(this).select("text").transition()
              .duration(250)
              .style("font", "bold 20px Arial")
              .attr("fill", "Blue");
          }

        function nodeMouseout() {
            d3.select(this).select("circle").transition()
               .duration(250)
               .attr("r",function(d){
                    return 10;
            });
            d3.select(this).select("text").transition()
               .duration(250)
               .attr("fill", "Blue")
               .style("font", function(d){
                    return "normal 12px Arial";
               });
          }
    </script> 
```

感谢您的帮助：D

# python - 在高低之间找到一个数字

> ID：12916804
> 
> 赞同：1
> 
> 时间：2012-10-16T14:20:40.023
> 
> 标签：python, python-3.x

我正在尝试制作一个程序，让用户知道一个数字是否在下限和上限之间，它还让他们知道它是否不是 int。我一直试图让它正常运行，但由于某种原因，我第一次输入任何值时它返回的不是整数，第二次输入一个值时它给出了正确的值，如果它更高或更低，我检查了我的缩进看看是否会导致它。我仍然不确定为什么。关于如何改进此代码或使其正常运行的任何想法？谢谢！

以下是主程序：

```
import damn

HIGH = 10
LOW = 5
prompt = "Please enter a value Between 5 and 10"

numbers = damn.get_pos_integer(prompt, HIGH, LOW) 

print (numbers) 
```

以下是我的功能：

```
def get_pos_integer(prompt, low, high):

    s = input(prompt)
    while True:
        if s.isdigit():
            x = int(s)
            if x < low:
                print("Number is too low")
            elif x > high:
                print("Number is too high")
            else:
                print("Number is an integer")
                return x
        else:
            print("Not a number")

x = get_pos_integer(prompt, 5, 10)
print("You entered", x) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:51:25.793

在您的函数中，语法是

```
def get_pos_integer(prompt, LOW, HIGH): 
```

当你用它调用它时

```
number = get_pos_integer(prompt, HIGH, LOW) 
```

你已经切换`high`和`low`。您可能应该检查您的输入是否`high > low`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:40:39.370

input() 返回整数或浮点数。用 raw_input() 替换 input()，它会返回一个字符串给你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:43:59.207

你写了

```
s = input(prompt)
while True:
    # check that number 
```

这意味着您要*一个*号码并反复检查。如果数字无效，则此循环将永远继续。

你可能想要

```
while True:
    s = input(prompt) # ask for new numbers until you get a valid one
    if s.isdigit():
        ... 
```

# php - 有时 Curl 和 file_get_contents 不会从 Facebook 下载图像

> ID：12916805
> 
> 赞同：0
> 
> 时间：2012-10-16T14:20:39.863
> 
> 标签：php, facebook, facebook-graph-api, curl, file-get-contents

我在从 Facebook 下载或获取图像到我的应用程序时遇到问题。过去 6 个月运行良好，现在开始出现问题。我尝试使用**Curl**甚至**file_get_contents**，有时它能够下载并顺利运行，有时它根本无法运行，有时它再次运行。在**file_get_contents**和**Curl**中抛出错误**403 Forbidden**会给我损坏的图像。我什至尝试使用 CURL 放置用户代理，如在 Stackoverflow 上看到的一些查询。但仍然是同样的问题。

 ****几天后，我遇到了身份验证问题，因为**Curl Exception 7，无法连接到主机**，所以在主机/等中我做了如下更改：**69.171.224.34 graph.facebook.com** 然后它又开始工作了。现在我什至在 IPtables 和自定义防火墙中添加了 Facebook IP 的范围。还是同样的问题。我应该从主机文件中删除条目吗？或者是其他东西？请建议我一些东西来摆脱它。谢谢。****

# html - 将用户输入的电话号码嵌入到 url

> ID：12916806
> 
> 赞同：0
> 
> 时间：2012-10-16T14:20:40.723
> 
> 标签：html, forms, phone-number

我是这个论坛的新手，我几乎是 HTML 编码的新手

我的要求如下。

我刚刚发现我的 VOIP 提供商有一个名为 Dial By URL 的功能，它听起来像示例 URL [https://soho66.co.uk/url_dial.aspx?f=1000027806&h=87EF4366186C4E4A5F4A705&t=0123456789](https://soho66.co.uk/url_dial.aspx?f=1000027806&h=87EF4366186C4E4A5F4A705&t=0123456789)

我想在我的 joomla 网站上使用这个功能，要求用户输入他们的电话号码，重新验证并按 Call Now 按钮建立连接。

正如您在上面的链接中看到的，最后 10 位数字是电话号码。

任何人都可以帮我实现这一目标吗？

如果您需要任何进一步的信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T13:20:15.033

你的问题有点含糊。您确实需要对 joomla 组件进行一些研究才能入门。

看看这里[http://docs.joomla.org/Creating_a_simple_component__-_Part_1](http://docs.joomla.org/Creating_a_simple_component_-_Part_1)或谷歌搜索“joomla 组件”

# android - android.os.NetworkOnMainThreadException 萨克斯解析

> ID：12916807
> 
> 赞同：0
> 
> 时间：2012-10-16T14:20:41.270
> 
> 标签：android, rss, android-asynctask

这个类导致我 android.os.NetworkOnMainThreadException，我知道我必须使用 asyncTask 来制作它，但我不知道如何因为我使用 1 个片段，这使得我的应用程序非常慢，尤其是当我加载位图时，可以请帮帮我。

```
public class ContainerData {    

static public Context context;

public ContainerData() {

}

public static ArrayList<Feed> getFeeds(String feedurl){
    SAXParserFactory fabrique = SAXParserFactory.newInstance();
    SAXParser parseur = null;
    ArrayList<Feed> feeds = null;
    try {
        parseur = fabrique.newSAXParser();
    } catch (ParserConfigurationException e) {
        e.printStackTrace();
    } catch (SAXException e) {
        e.printStackTrace();
    }
    URL url = null;
    try {
        url = new URL(feedurl);
    } catch (MalformedURLException e1) {
        e1.printStackTrace();
    }

    DefaultHandler handler = new ParserXMLHandler();
    try {
        parseur.parse(url.openConnection().getInputStream(), handler);

        feeds = ((ParserXMLHandler) handler).getData();
    } catch (SAXException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return feeds;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:08:54.490

无论您是否使用片段，您仍在尝试在主线程上执行网络活动。

`AsyncTask`创建一个可以执行所有解析的扩展类。

```
public class MyTaskHandler extends AsyncTask<String, Integer, Boolean>
{

@Override
protected void onPreExecute() 
{
   //Could display progress dialog here
}

@Override
protected Boolean doInBackground(String... params) 
{
   //Implement your parser here
}

@Override
protected void onPostExecute(Boolean result) 
{
   //Check result, dismiss dialog etc
}
} 
```

然后创建一个新实例`MyTaskHandler`并运行它...

```
MyTaskHandler myTask = new MyTaskHandler();
myTask.execute("http://www.myxmlsite.com/lists.xml"); 
```

execute 方法可以采用`(String... params)`，因此您可以传递例如 URL，并在其中检索它`doInBackground(String... params)`

```
@Override
protected Boolean doInBackground(String... params) 
{
   //Implement your parser here
   String urlToParse = params[0];
} 
```

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:31:37.067

如果您使用`AsyncTask`确保`getFeeds`在`doInBackground(...)`回调中调用

# ruby-on-rails - 如何通过 AJAX 搜索传递参数生成 Excel 文件？

> ID：12916810
> 
> 赞同：1
> 
> 时间：2012-10-16T14:20:46.730
> 
> 标签：ruby-on-rails, ajax, spreadsheet, export-to-excel

我正在我的 Rails 应用程序中执行 AJAX 搜索。这是来自控制器的代码：

```
def show
@website = Website.find(params[:id])
if (current_user.id != @website.user_id)
  redirect_to root_path
  flash[:notice] = 'You are not owner!'
end
if params[:report] && params[:report][:start_date] && params[:report][:end_date]
  @performance_reports = @website.performance_reports.where("created_at between ? and ?", params[:report][:start_date].to_date, params[:report][:end_date].to_date)    
else
  @performance_reports = @website.performance_reports
end 
```

但是当我尝试生成 Excel 文档时，它总是在没有参数的情况下转到分支，因为 URL 中没有参数。

一位男士推荐我使用这篇[文章](https://stackoverflow.com/questions/4049939/direct-downloading-a-xls-file-without-writing-it-to-the-directory-by-spreadsheet)。我试图实现它，但不能。

我不太了解这篇文章，我只是无法获取数据传递的位置（电子表格宝石）

这是代码：

```
 def export

  @website = Website.last

  @data = @website.performance_reports

  report = Spreadsheet::Workbook.new

  spreadsheet = StringIO.new

  contruct_body(spreadsheet, @data)

  report.write spreadsheet 

  send_data spreadsheet.string, :filename => "yourfile.xls", :type =>  "application/vnd.ms-excel"

 end 
```

它给了我错误：

```
 undefined method `contruct_body' 
```

视图代码：

```
 <%= form_tag( url_for, :method => :get, :id => "report") do%>
      ...show action posted above...
     <% end %>

    <%= link_to export_path do%>
     <b>Export</b>
    <% end %>
   ...working code without AJAX...
       <%= link_to url_for(request.parameters.merge({:format => :xls}))  do%>
    <b>Export</b>
    <% end %> 
```

请告诉我我的错误在哪里或建议没有

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:31:25.913

对于第一个问题，您需要显示视图代码和 ajax 所采用的路径。向我们提供更多关于如何调用 excel 的信息。

对于第二个问题，您需要定义该方法。指定如何使用数据填充电子表格。这是指南。[https://github.com/zdavatz/spreadsheet/blob/master/GUIDE.txt](https://github.com/zdavatz/spreadsheet/blob/master/GUIDE.txt)

== 写作很容易 和以前一样，确保您需要电子表格并设置了 client_encoding。然后制作一个新的工作簿：

```
 book = Spreadsheet::Workbook.new 
```

添加一个工作表，您就可以开始了：

```
 sheet1 = book.create_worksheet 
```

这将创建一个名为“Worksheet1”的工作表。如果您更喜欢其他名称，您可以执行以下任一操作：

```
 sheet2 = book.create_worksheet :name => 'My Second Worksheet'
  sheet1.name = 'My First Worksheet' 
```

现在，使用 、 或直接在 Row 上使用任何修改 Array 的 Array-Methods 将数据添加到工作`Worksheet#[]=`表 `Worksheet#update_row`：

```
 sheet1.row(0).concat %w{Name Country Acknowlegement}
  sheet1[1,0] = 'Japan'
  row = sheet1.row(1)
  row.push 'Creator of Ruby'
  row.unshift 'Yukihiro Matsumoto'
  sheet1.row(2).replace [ 'Daniel J. Berger', 'U.S.A.',
                          'Author of original code for Spreadsheet::Excel' ]
  sheet1.row(3).push 'Charles Lowe', 'Author of the ruby-ole Library'
  sheet1.row(3).insert 1, 'Unknown'
  sheet1.update_row 4, 'Hannes Wyss', 'Switzerland', 'Author' 
```

为风味添加一些格式：

```
 sheet1.row(0).height = 18

  format = Spreadsheet::Format.new :color => :blue,
                                   :weight => :bold,
                                   :size => 18
  sheet1.row(0).default_format = format

  bold = Spreadsheet::Format.new :weight => :bold
  4.times do |x| sheet1.row(x + 1).set_format(0, bold) end 
```

最后，编写 Excel 文件：

```
 book.write '/path/to/output/excel-file.xls' 
```

# sql - 将大量数据插入数据库，避免 RBAR

> ID：12916811
> 
> 赞同：1
> 
> 时间：2012-10-16T14:20:48.960
> 
> 标签：sql, vb.net, visual-studio, ms-access, bulkinsert

所以我正在编写必须将数千条记录插入 Microsoft Access 的软件。目前我正在使用 JET 的 RBAR（通过痛苦的行）方法。在询问如何加快流程之前，我写了一个关于 SO 的[问题](https://stackoverflow.com/q/12040607/1606972)，并被告知使用 DAO 而不是 JET，因为它会更快，并避免 RBAR。

我现在处于准备实施更快解决方案的情况，但是，我还有一些问题。首先是一些简单的事情，有没有人知道 vb.net 中的 DAO 语法的好教程，因为我试图在网上寻找一个但一直在努力。还有人知道要使用的图书馆吗？

其次，避免使用 RBAR 方法将数据插入数据库的最佳方法是什么。我假设这是使用记录集，但我不确定如何实现其中之一，或者一次插入多行所需的 SQL 查询。

最后有人告诉我，ms-access 不是最好的使用方法，它很慢。有没有人对访问的不同替代方案有任何建议？我需要它是一个免费的商业许可证，我知道这是一个延伸。我只使用数据库作为我不需要访问提供的任何用户接口的数据的存储。我在 SO 上发现了一个关于此的[问题](https://stackoverflow.com/a/29205/1606972)，建议使用 SQLite、MySQL 或 FireBird。有谁知道这些解决方案与 Access 相比的速度以及它们是否仍可免费用于商业用途。

因此，我基本上是在寻找有关如何尽快将大量数据读/写到数据库的建议。任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:25:58.040

使用 MS SQL Express（免费版）进行批量插入：

[http://www.sswug.org/articles/viewarticle.aspx?id=35680](http://www.sswug.org/articles/viewarticle.aspx?id=35680)

基本上涉及使用批量插入语法并传入文件：

```
BULK INSERT Test..Clients FROM
'c:\TestData.csv'
WITH (
   FIELDTERMINATOR = ',',
   ROWTERMINATOR = '\n'
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:26:22.133

而不是访问，看看[firebird](http://www.firebirdsql.org/) 它免费且非常可靠。

> Firebird 是一个关系型数据库，提供许多在 Linux、Windows 和各种 Unix 平台上运行的 ANSI SQL 标准特性。Firebird 为存储过程和触发器提供了出色的并发性、高性能和强大的语言支持。自 1981 年以来，它以各种名称用于生产系统。
> 
> Firebird 项目是 C 和 C++ 程序员、技术顾问和支持者基于 Inprise Corp（现称为 Borland Software Corp）于 7 月 25 日发布的源代码开发和增强多平台关系数据库管理系统的商业独立项目， 2000 年。

# python - 在 Python 中将 STDOUT 十六进制输出转换为字符串

> ID：12916818
> 
> 赞同：3
> 
> 时间：2012-10-16T14:21:07.137
> 
> 标签：python, string, hex

我一直在寻找将以下类型的十六进制输出转换为 Python 中的字符串字符的方法。输出来自`STDOUT`我代码的前面部分，我希望能够进一步处理它。

让我给你一些我想要转换的字符串的例子：

```
\x5f\x63\x6c\x6f\x73\x65\x28 
```

我希望这种类型的字符串被剥离 '\x' 并且我只对后面的两个十六进制字符感兴趣。最好，我想将这样的字符串转换为；

```
5f 63 6c 6f 73 65 28 
```

原始输入被解释为一个字符串，但我不能简单地剥离`\x`Python 本身。如果我可以在 Python 内部解决这种转换，那会很棒吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:22:56.153

```
>>> '\x12\x34\x56\x78'.encode('hex')
'12345678' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:33:01.347

为此`Python 3`可以这样做：

```
>>> s = b'\x5f\x63\x6c\x6f\x73\x65\x28'
>>> import binascii
>>> binascii.hexlify(s)
b'5f636c6f736528' 
```

`encode`在 Python 3 中返回错误，因为从二进制字符串到二进制字符串的转换。

[这是](https://stackoverflow.com/questions/11384583/hex-decoding-in-python-3-2)我前一段时间自己遇到这个问题的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:27:59.913

可以只使用基本的字符串函数：

```
s = r'\x5f\x63\x6c\x6f\x73\x65\x28'
s.replace(r'\x', ' ').lstrip()
# '5f 63 6c 6f 73 65 28'

# or
s[2:].replace(r'\x', ' ') 
```

# objective-c - 保存应用程序的数据，如果我更新应用程序，不要丢失它们

> ID：12916819
> 
> 赞同：0
> 
> 时间：2012-10-16T14:21:08.740
> 
> 标签：objective-c, save

如果我有一个应用程序的本地数据，假设我存储游戏的所有分数的本地高分。如果我发布应用程序的更新，我会丢失所有数据。我用这种方法保存数据：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *filename = [documentsDirectory stringByAppendingPathComponent:@"defaultStage.dat"];

char cstr[512]={0};
[filename getCString:cstr maxLength:512 encoding:NSASCIIStringEncoding];

defaultStage=1;
FILE *pFile=fopen(cstr, "wb");
// and save with fprintf 
```

有一种方法可以“永久”保存数据，在我重新安装或更新应用程序时不会丢失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:51:34.393

在 iOS/Mac OS X 下，您有很多保存数据的选项。您可以从查看[Core data](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/cdProgrammingGuide.html)、[NSUserDefaults](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)和[NSFileManager 开始](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html)。检查您要保存多少数据，看看哪一个适合您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:16:39.183

保存到 Documents 目录不应该在更新时丢失数据，这很奇怪。真的吗？至于删除和重新安装应用程序，没有办法将数据保存在手机本地（即在应用程序被删除时被删除的应用程序沙箱之外）。您需要使用 iCloud 或远程 Web 服务器。

为了保存高分，我建议使用 NSUserDefaults 更新应用程序时它也不会被删除。

编辑：我假设您谈论的是 iOS，而不是 OS X

# java - 在 Spring WS 拦截器中使用 java xml 转换器时出现问题

> ID：12916821
> 
> 赞同：1
> 
> 时间：2012-10-16T14:21:10.127
> 
> 标签：java, xml, web-services, spring

嗨，我正在使用 Spring 编写一个 SAOP Web 服务，该服务在标头中嵌入了一个复杂类型。

```
 <soapenv:Header>
      <ser:Header>
           <ser:from>xyz</ser:from>
           <ser:to>abc</ser:to>
      </ser:Header>
 </soapenv:Header>
 <soapenv:Body>
     <abc>test</abc>
 </soapenv:Body> 
```

在我的端点，我编写了生成 SOAP 主体的实现。我还在 Spring 中实现了一个响应拦截器，以生成所需格式的 SOAP Header

```
StringBuffer headerXml = new StringBuffer();
headerXml.append("<ser:Header xmlns:mos=\"http://test.services.com\">")
.append("<ser:from>xyz</ser:from>");
.append("<ser:to>abc</ser:to>");
.append("</ser:Header>");
Source xmlInput = new StreamSource(new StringReader(headerXml.toString()));
Result xmlOutput = soapHeader.getResult();
TransformerFactory transformerFactory = TransformerFactory.newInstance();
try{
    Transformer transformer = transformerFactory.newTransformer();
    transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
    transformer.setOutputProperty(OutputKeys.INDENT, "yes");
    transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", String.valueOf(4));
    transformer.transform(xmlInput, xmlOutput);     
}catch(IllegalArgumentException ie){
    ie.printStackTrace();
}catch(TransformerException te){
    te.printStackTrace();
} 
```

在这里，我从 SoapHeader 获取 Result 对象并尝试使用转换器将其解析为 xml 的字符串进行更新

```
transformer.transform(xmlInput, xmlOutput); 
```

但是在这里，我只将第一行放入输出标题中，如下所示

```
<soapenv:Header>
    <ser:Header xmlns:ser="http://test.services.com"/>
</soapenv:Header> 
```

我没有得到完整的标题。虽然在调试模式下我可以看到整个字符串标题已添加到**xmlInput**变量中

我尝试了所有选项，但没有成功。请尽快提供这方面的帮助。

提前致谢！！

# javascript - javascript函数中未捕获的TypeError

> ID：12916822
> 
> 赞同：2
> 
> 时间：2012-10-16T14:21:11.183
> 
> 标签：javascript, json, html, session-storage

```
Storage.prototype.setObj = function(key, obj) {
    return this.setItem(key, JSON.stringify(obj))
    ^-----Error in this line: Uncaught TypeError: Accessing selectionDirection on an input element that cannot have a selection
}
var selected = jQuery('input:checkbox.mychkbox:checked').each(function() {
        return this.id;
});
sessionStorage.setObj("savedCollSearch",selected); 
```

我正在使用 jQuery 1.7.2 和 Chrome 22。此错误在 Firefox 16 中显示为未捕获的异常。在 SO 和 Google 中搜索无济于事，我不知道如何解决此问题。

我 100% 确定 jQuery 已正确加载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:02:38.653

这个表情...

```
var selected = jQuery('input:checkbox.mychkbox:checked').each(function() {
  return this.id;
}); 
```

...似乎在这里被滥用：它会返回一个 jQuery 包装的选中复选框元素的集合，这可能不太容易字符串化（因为循环引用）。

*（作为旁注，`.each`将在第一个没有 的元素处停止迭代`id`，或者将其设置为空字符串，但这在这里无关紧要）*

您可能想改用它：

```
var selected = jQuery('input:checkbox.mychkbox:checked').map(function() {
  return this.id;
}).get(); 
```

# javascript - Html 模拟工具

> ID：12916824
> 
> 赞同：3
> 
> 时间：2012-10-16T14:21:13.633
> 
> 标签：javascript, html

我需要向专业设计师展示一些页面，为此我需要一个工具，展示我当前使用`JQuery`静态 Html 构建的页面，而不引用任何 Javascript 文件。

我正在寻找一种工具，它可以让我模拟当前页面的 html 并将所有`CSS`属性`display`、、、`border`等`source`动态设置`Javascript`为样式`style="display: none; border: 1px solid gray;"`。有人见过这样的工具吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:24:48.497

浏览器可以做到这一点。任何由 javascript 添加的样式都将在呈现页面的 HTML 元素中的 style 属性中。

我知道 Chrome 的行为是这样的。您可以从开发人员工具箱中复制 HTML。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T14:33:06.667

序列化 DOM 的当前状态实际上非常容易：

```
$('html')[0].outerHTML 
```

但是，您必须重新添加`DOCTYPE`。

[演示在这里。](http://jsfiddle.net/josh3736/HHmzm/)

# android - android如何正确设置应用程序的默认语言，即使在关闭设备后也是如此

> ID：12916830
> 
> 赞同：1
> 
> 时间：2012-10-16T14:21:23.623
> 
> 标签：android, localization, locale, android-preferences

我对android dev很陌生，我有一点本地化问题。我有一个应用程序，用户可以在其中选择使用除设备当前语言之外的其他默认语言。例如，居住在德国并将手机设置为“德语”的法国用户可能希望以法语使用我的应用程序（出于各种原因），但不想将手机的默认语言设置为法语。

我的应用程序只有一个活动，我在其中加载和卸载一些视图。这是一个非常简单的应用程序，但内容很大（文本和图像）。

为此，我使用下面的代码。

它运作良好，但存在一些问题：

*   当用户使用适当的按钮选择新语言并重新启动应用程序时（或者如果我强制应用程序完成（）...）：只有第一个视图使用新语言。下一个视图仍设置为以前的语言。

*   如果用户选择关闭他的设备，同样的问题：只有活动的第一个视图设置为选择的语言（从首选项中读取变量。）。

*   但是，如果用户第二次选择重新启动应用程序，所有视图和子视图都会正确设置为新语言。

*   而且，如果用户之前至少重新启动了一次应用程序，则每次语言更改都会成功完成。无需再次重新启动应用程序。

那么，有没有办法正确设置新语言

*   应用程序首次重新启动后立即

*   如果用户之前已经关闭并打开了他的设备

任何帮助将不胜感激。这是我使用的代码（简化）：

```
public void onCreate(Bundle savedInstanceState) {
    SharedPreferences myPrefs;
    myPrefs = getSharedPreferences("langage", MODE_PRIVATE);  
    String langageToLoad = myPrefs.getString("langageToLoad", "");
    changeLangage(langageToLoad);

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
     (...some other code...)
    }

public void setLangageEn(View view){
    changeLangage( "en");
    setPreference( "en"); 
    // finish(); // optionnal
    }

public void changeLangage(String langage) {
    Locale locale = new Locale(langage); 
    Locale systemLocale = Locale.getDefault();
    if (systemLocale != null && systemLocale.equals(locale)) {
    return;
    }
    Locale.setDefault(locale);
    android.content.res.Configuration config = new android.content.res.Configuration();
    config.locale = locale;
    getResources().updateConfiguration(config, getResources().getDisplayMetrics());
    }

public void setPreference( String langage){
    SharedPreferences languagepref = getSharedPreferences("langage",MODE_PRIVATE);
    SharedPreferences.Editor editor = languagepref.edit();
    editor.putString("langageToLoad",langage );
    editor.commit();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T08:40:06.633

Following thing: **just because you finish() one activity, the previous activities don't need to be closed and therefor MIGHT call onResume() and just "jump over" onCreate()**, they aren't out of the memory yet and don't call onCreate() (which comes before onResume()), where you implement your language check.

* * *

One thing to avoid this issue, might be to create a custom "Application class" (extends Application) and there, check the localize-preference and set it to a field with getter and setter methods. To get the application instance then (which is created on the application start!(not when just starting a second activity..) you can do ((CustomApp)Context.getApplicationContext).getCustomLocalization() in your activities..

However. To really load up the new language settings in every activity, be sure to check it in onResume() and set the language 1\. to the field in CustomApp and 2\. to the preference (maybe with the same setter method?) when changing it. Then finish() your settings activity and recreate it to load the new settings.

# vim - Vim，netrw 插件 tmp 文件未上传到服务器

> ID：12916835
> 
> 赞同：1
> 
> 时间：2012-10-16T14:21:49.913
> 
> 标签：vim, netrw

如果我通过 sftp 与 netrw 插件连接并打开文件，文件路径看起来像`sftp://..` 在当前会话中如果我关闭此文件并重新打开它，netrw 从加载文件，`/tmp/..`保存此文件后不会上传到服务器。关闭后如何删除临时文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T11:41:33.387

虽然结果并没有获胜，但我找到了另一种选择 - 它是缓冲区。为了方便和易于访问，我使用了一个插件[bufexplorer](http://www.vim.org/scripts/script.php?script_id=42)，第二次我已经直接从它打开文件了。

# javascript - 使用循环在 div 标签中添加链接元素

> ID：12916836
> 
> 赞同：0
> 
> 时间：2012-10-16T14:21:51.020
> 
> 标签：javascript, dom-events, blackberry, blackberry-webworks

我想让我的 DIV 元素能够单击并转到详细信息页面，并将 ID 作为查询参数数据发送到我的服务器。我找到了一些我可以使用的可能用途的例子，例如：

```
<div style="cursor:pointer;" onclick="document.location='http://www.google.com'">Foo</div> 
```

只是我很困惑想将上面的脚本添加到我构建的代码中。

我的部分代码：

```
 for ( var i = 0; i < response.length; ++i ) {
                str = response[i].judul;
                str2 = response[i].waktu_mulai;
                str3 = response[i].channel_code;

                var Year,Month,Date,Time,Strip,Join= ""

                var Year        = str2.substr(0,4)
                var Month       = str2.substr(5,2)
                var Date        = str2.substr(8,2)
                var Time        = str2.substr(-8,8)
                var Strip       = str2.substr(4,1)

                var Join        = Date+Strip+Month+Strip+Year+' '+Time

                listItem = document.createElement('div');
                listItem.setAttribute('data-bb-type', 'item');
                listItem.setAttribute('data-bb-img', 'images/icons/logo/'+str3+'.png');
                listItem.setAttribute('data-bb-title', str);
                listItem.innerHTML = Join+" WIB";
                container = document.createElement('div');
                container.appendChild(listItem);
                bb.imageList.apply([container]);
                dataList.appendChild(container.firstChild);  
                        if (bb.scroller) {
                                bb.scroller.refresh();
                        }
} 
```

也许有人可以通过从数据库循环我的应用程序来帮助我使用每个 DIV 添加的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:03:10.580

确保为您的问题提供正确的上下文。您目前正在发布一段 bbUI.js 框架脚本，它的交互方式可能与普通 HTML、CSS3 和 JavaScript 完全不同。

我也你两次声明你的变量。-> var ...... = ""; 然后是每个单独的 var。

也尝试先搜索 StackOverflow，看看你是否再次问同样的问题。这个特定问题之前已经被提出和/或回答过很多次，您可以在许多“从 HTML、Javascript 开始”中找到它。尽管每个人都愿意提供帮助，但有些东西只是在涵盖基础知识时才发现的，并且可以通过在例如 Google 上执行正确的搜索轻松找到。人们希望看到您自己努力寻找答案，也希望看到您在提出问题时付出的努力。你对问题的描述越好，答案就越准确。

回到主题：

我认为仅使用它可以解决您的问题：

```
<element>.setAttribute('onclick','doSomething();'); // for normal browsers
<element>.onclick = function() {doSomething();}; // for IE 
```

你可以在哪里替换'doSomeThing();' 使用您自己想要的代码，例如。：“document.location='http://www.google.com'”

如果你想让它更动态，你也可以只调用一个函数：

```
<element>.setAttribute('onclick','myFunction();'); // for normal browsers
<element>.onclick = function() {myFunction();}; // for IE 
```

我的功能在哪里：

```
function MyFunction() {
    var called_id = this.id;
    var call_url = "http://myurl.com/page?id="+called_id;
    document.location = call_url;
    return; //superflous 
} 
```

正如其他人所说，试图提高您对 StackOverFLow 的接受率，人们会更渴望回答您的问题。

# css - 如何让 IBM WebSphere Commerce 7 对 SCSS 文件进行语法高亮显示？

> ID：12916837
> 
> 赞同：0
> 
> 时间：2012-10-16T14:22:06.637
> 
> 标签：css, websphere, syntax-highlighting, sass

我想开始使用 Sass。我已经准备好了所有东西，但是我的其他团队成员有一个小障碍。我使用 Sublime Text 作为我的主要编辑器，但他们使用我们的 WebSphere Commerce Developer IDE 7 作为他们的编辑器。我可以轻松更改语法突出显示以适应 SCSS 文件，但似乎它们不能。即使我一直推荐它，他们也不愿意换另一个编辑器。

我看到在 Window > Preferences > Web 下，我可以更改 CSS、JSP 等的某些语法突出显示。但是，我看不出有办法告诉它将 SCSS 文件突出显示为 CSS。有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T13:22:10.287

由于 IBM WebSphere Commerce 在 Eclipse IDE 中运行，我在[这里](https://stackoverflow.com/questions/5829732/ide-with-syntax-highlight-support-for-less)找到了一个非常相似的答案。

首选项 > 常规 > 内容类型：找到“CSS”条目并添加 .scss 扩展名。然后，Preferences > General > Editors > File Assoc：添加 .scss 扩展名并与 CSS 编辑器关联。

# c++ - 如何撤消 glTranslatef 的效果

> ID：12916838
> 
> 赞同：1
> 
> 时间：2012-10-16T14:22:16.650
> 
> 标签：c++, opengl

假设我想翻译一个多边形。如果在绘制它之前我使用 glTranslatef 它会被翻译，但是如果我想绘制两个多边形并且只翻译一个，我该怎么做？

```
#include <OpenGL/OpenGL.h>
#include <GLUT/GLUT.h>
#include "utility.h"

void init()
{
    glLoadIdentity();
    glOrtho(-1, 1, -1, 1, -1, 1);
}

void render()
{
    glClearColor(APPLE_GRAY);
    glClear(GL_COLOR_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW);
    glTranslatef(0.5, 0.0, 0.0);
    glBegin(GL_POLYGON);
    glColor4f(RED);
    glVertex2f(0,0.5);
    glVertex2f(-0.5,-0.5);
    glVertex2f(0.5, -0.5);
    glBegin(GL_POLYGON);
    glColor4f(BLUE);
    glVertex2f(0.5,0.5);
    glVertex2f(-0.5,0.5);
    glVertex2f(-0.5, -0.5);
    glVertex2f(0.5, -0.5);
    glEnd();
    glFlush();
} 
```

我只想翻译三角形，而不是正方形。怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T14:29:25.807

在翻译之前，请致电：

`glPushMatrix()`

然后在绘制第一个多边形后，调用：

`glPopMatrix()`

我还注意到您`glEnd()`在第一个多边形之后没有呼叫。此外，除非有更多未列出的代码，否则我注意到您在调用时不会从模型视图切换到投影矩阵`glOrtho()`。如果您仅在此示例中使用模型视图矩阵，则这不是绝对必要的，但传统的方法是像这样设置您的投影：

```
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
glOrtho(-1, 1, -1, 1, -1, 1); 
```

然后，您的渲染函数为多边形渲染设置模型视图矩阵。同样，这不是一个要求，您的示例看起来可以满足您的需求，因为您只使用一个矩阵。

参考： [glPushMatrix() OpenGL 文档](http://www.opengl.org/sdk/docs/man/xhtml/glPushMatrix.xml)

# android - 应用程序加载时 Android 崩溃（Unity3D 3.5.64f（最新））

> ID：12916839
> 
> 赞同：0
> 
> 时间：2012-10-16T14:22:17.933
> 
> 标签：android, mono, crash, unity3d

我知道这是 Unity3D 问题，并且有更具体的堆栈/论坛站点...请参阅附加的 logcat 日志，有什么可以给我们任何线索吗？

Unity 启动画面出现在设备上，但几秒钟后它崩溃了。这个应用程序昨天还可以，我添加了一些 C# 代码纹理等。我仔细检查了调试构建 logcat 日志。我的代码甚至没有机会运行，崩溃发生在之前...... 注意：logcat 日志中没有 Mono 运行时异常。

*   它在 Unity 编辑器或 Windows 独立版本中运行良好。
*   再次：它工作正常，昨天的设置相同。更多：昨天的备份平台今天工作，重建，部署到同一设备。这个今天的版本（我已经添加了纹理、代码等）在设备上不起作用。

请参阅随附的日志。

不知道在哪里搜索... :-(谢谢帮助

[下载logcat日志文件](http://forum.unity3d.com/attachment.php?attachmentid=39449&d=1350310564)

# powershell - ArrayList 展开

> ID：12916840
> 
> 赞同：8
> 
> 时间：2012-10-16T14:22:24.503
> 
> 标签：powershell

Powershell展开让我发疯。

我有以下代码可以从交换收件人那里检索电子邮件地址。我正在使用 ArrayList，因为当您希望能够从数组中删除项目时，许多人都建议使用它。

```
$aliases = New-Object System.Collections.ArrayList
$smtpAddresses = (Get-Recipient $this.DN).EmailAddresses | ?{$_.Prefix.ToString() -eq 'smtp' } 
    foreach ($smtpAddress in $smtpAddresses) {
        $aliases.Add($smtpAddress.SmtpAddress)
    }
return $aliases 
```

$aliases 的值在函数末尾是正确的（即将包含 x 个电子邮件地址，并且类型为 ArrayList），但在返回后它变为 System.Object[] 并具有 2x 个条目。有 x 个 Int32 后跟 x 个字符串（即 {0, 1, bob@here, bob@there} ）。为什么会发生这种情况以及如何保持我的 ArrayList 完好无损？我使用 ArrayList 错了吗？

出于好奇，由于 PS 展开导致的所有问题/问题，它的目的是什么？powershell 的最大好处是你可以直接使用对象而不是它们的文本投影，不幸的是，我永远不知道我正在使用什么样的对象 - 即使当我检查时，它似乎也无法保持其形状更多而不是几行代码。

-- Edit 该函数作为 PSObject 的一部分调用

```
$get_aliases = { ... }
$obj | Add-Member -MemberType ScriptProperty -Name Aliases -Value $get_aliases -SecondValue $set_aliases 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T15:01:12.927

部分问题是如何在函数内部使用数组。请记住，PowerShell 中的函数实际上并不*返回*任何内容。它将对象写入管道。因此，退货是多余的，但实际上并没有造成任何问题。该`Add`函数的使用导致了问题，因为`Add` [返回](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.add.aspx)了添加值的索引，因此也写入了管道。

```
function get-myarray
{ 
   $al = New-Object System.Collections.ArrayList
   $al.Add( 0 ) 
   $al.Add( 1 )
   $al.Add( 'me@co.com' )
   $al.Add( 'you.co.com' )
   return $al 
}

$array = get-myarray
$array.Count
8 
```

注意大小是8。需要做的是抑制`Add`函数返回的内容的写入。有几种方法可以做到这一点，但这里有一种：

```
function get-myarray
{ 
   $al = New-Object System.Collections.ArrayList
   $al.Add( 0 ) | out-null
   $al.Add( 1 )  | out-null
   $al.Add( 'me@co.com' )  | out-null
   $al.Add( 'you.co.com' )  | out-null
   return $al 
}

$array = get-myarray
$array.Count
4 
```

如果您想从中删除项目，我不相信使用“ArrayList”是错误的。

就*展开*而言，这值得另一个问题，并且已经得到[解决](https://stackoverflow.com/a/1829401/4916)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:38:47.527

你是怎么退货的`$aliases`？

像这样？

```
$a = MyFunctionName # In this way `$a` is of type [OBJECT[]] 
```

你可以这样试试：

```
[System.Collections.ArrayList]$a = MyFunctionName 
```

在您可以通过这种方式知道类型之后：

```
$a.item(0).gettype() 
```

# process - Windows XP 中应用程序的磁盘使用情况

> ID：12916850
> 
> 赞同：0
> 
> 时间：2012-10-16T14:22:53.333
> 
> 标签：process, windows-xp, disk

大多数进程监控软件可以实时显示应用程序的 CPU 负载。但我找不到任何可以显示应用程序（硬盘、CD/DVD、闪存驱动器等）的实时磁盘使用情况的东西。

有一个程序[***AnVir 任务管理器***](http://www.anvir.net/)可以显示硬盘负载，但它根本不是按每个应用程序或进程显示的。

另一方面，[***Sysinternals***](http://technet.microsoft.com/ru-ru/sysinternals/bb545027)有一个名为***Filemon***（现为***Process Monitor***）的实用程序，它显示了文件系统（读/写文件）的所有活动以及进程和路径，但这些信息过于冗长。

我想我正在寻找可以显示如下表格的软件：

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

   工艺 | 磁盘使用率 (%) | 磁盘/分区 | 一些信息.. |

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ |

uTorrent.exe | 68 | 硬盘1/分区0 | 废话-废话-5 |

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ |

应用程序-9.exe | 17 | 硬盘1/分区1 | bloh-bloh-5 |

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ |

请告诉您是否知道这种软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T21:04:31.010

从[这里](https://serverfault.com/a/4810/131157)：

您可以通过启用“Options->I/O History Tray Icon”来使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)查看系统托盘中的 IO 使用情况。

将鼠标悬停在图标上，它会告诉您当前哪个应用程序使用的 IO 最多。

# marklogic - MarkLogic：错误的总计数

> ID：12916853
> 
> 赞同：0
> 
> 时间：2012-10-16T14:22:58.033
> 
> 标签：marklogic

我有以下两个 XML 文件：

**Page1.xml**

```
<pages xmlns="http://marklogic.com/docs">
  <page>
    <elementNode>data1</elementNode>
    <textNode>text1</textNode>
  </page>
  <page>
    <elementNode>data1</elementNode>
    <textNode>text1</textNode>
  </page>
  <page>
    <elementNode>data3</elementNode>
    <textNode>text3</textNode>
  </page>
  <page>
    <elementNode>data4</elementNode>
    <textNode>text4</textNode>
  </page>
<pages> 
```

**Page2.xml**

```
<pages xmlns="http://marklogic.com/docs">
  <page>
    <elementNode>data1</elementNode>
    <textNode>text1</textNode>
  </page>
  <page>
    <elementNode>data2</elementNode>
    <textNode>text3</textNode>
  </page>
  <page>
    <elementNode>data3</elementNode>
    <textNode>text5</textNode>
  </page>
  <page>
    <elementNode>data4</elementNode>
    <textNode>text6</textNode>
  </page>
<pages> 
```

我在“elementNode”上创建了一个元素范围索引，并将“page”元素定义为片段根。我使用 searchText "text1" 执行了以下 xquery

```
xquery version "1.0-ml";
declare namespace html = "http://www.w3.org/1999/xhtml";
declare namespace ts= "http://marklogic.com/docs";

import module namespace search ="http://marklogic.com/appservices/search" at "/MarkLogic/appservices/search/search.xqy";

declare variable $options :=  
  <options xmlns="http://marklogic.com/appservices/search">
    <grammar>
      <starter strength="30" apply="grouping" delimiter=")">(</starter>
      <starter strength="40" apply="prefix" element="cts:not-query">NOT</starter>
      <joiner strength="10" apply="infix" element="cts:or-query" tokenize="word">OR</joiner>
      <joiner strength="20" apply="infix" element="cts:and-query" tokenize="word">AND</joiner>
      <joiner strength="50" apply="constraint">:</joiner>
    </grammar>
    <constraint name="elementNode">
      <range collation="http://marklogic.com/collation/" type="xs:string">
        <facet-option>limit=1000</facet-option>
        <element ns="http://marklogic.com/docs" name="elementNode"/>
      </range>
    </constraint>
  </options>;
let $searchResult := search:search("text1", $options)
return $searchResult 
```

执行查询后，我得到以下响应：

```
<?xml version="1.0" encoding="UTF-8"?>
<search:response total="3" start="1" page-length="10" xmlns="" xmlns:search="http://marklogic.com/appservices/search">
  <search:result index="1" uri="/content/C/Documents and Settings/vimleshm/Desktop/abc.xml" path="fn:doc(&quot;/content/C/Documents and Settings/vimleshm/Desktop/abc.xml&quot;)" score="22784" confidence="0.451657" fitness="0.663945">
    <search:snippet>
      <search:match path="fn:doc(&quot;/content/C/Documents and Settings/vimleshm/Desktop/abc.xml&quot;)/*:pages/*:page[1]">
        <search:highlight>text1</search:highlight>
      </search:match>
      <search:match path="fn:doc(&quot;/content/C/Documents and Settings/vimleshm/Desktop/abc.xml&quot;)/*:pages/*:page[2]">
        <search:highlight>text1</search:highlight>
      </search:match>
    </search:snippet>
  </search:result>
  <search:result index="2" uri="/content/C/Documents and Settings/vimleshm/Desktop/abc1.xml" path="fn:doc(&quot;/content/C/Documents and Settings/vimleshm/Desktop/abc1.xml&quot;)" score="22784" confidence="0.451657" fitness="0.663945">
    <search:snippet>
      <search:match path="fn:doc(&quot;/content/C/Documents and Settings/vimleshm/Desktop/abc1.xml&quot;)/*:pages/*:page[1]">
        <search:highlight>text1</search:highlight>
      </search:match>
    </search:snippet>
  </search:result>
  <search:facet name="elementNode">
    <search:facet-value name="data1" count="3">data1</search:facet-value>
  </search:facet>
  <search:qtext>text1</search:qtext>
  <search:metrics>
    <search:query-resolution-time>PT0S</search:query-resolution-time>
    <search:facet-resolution-time>PT0.015S</search:facet-resolution-time>
    <search:snippet-resolution-time>PT0S</search:snippet-resolution-time>
    <search:total-time>PT0.015S</search:total-time>
  </search:metrics>
</search:response> 
```

现在你可以看到这里的“total”属性`search:response`是“3”，因为我已经将“page”定义为片段根[ [Marklogic Wrong count and Facet result Xquery](https://stackoverflow.com/questions/12435620/marklogic-wrong-count-and-facet-result-xquery])。有什么方法可以获得正确的总数，因为“text1”只存在于 Page1.xml 和 Page2.xml 中，所以这里应该是“2”？此外，我得到了计数为“3”的 facet“data2”，它应该是“2”，因为它与前一种情况一样存在于两个 XML 文件中。请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T22:06:46.013

您可以将片段根设置为`<pages>`（或无，这将默认在每个 XML 文档的根上进行分段），然后将有 2 个命中：一个在 Page1.xml 中有 2 个匹配项，一个在 Page2 中有 1 个匹配项。 xml。但是，如果您将片段根设置`<page>`为您所做的那样，搜索会将这些元素中的每一个视为其自己的文档，并且它将计数`<page>`而不是`<pages>`.

简单地说，结果计数将反映片段命中的数量。所以问题是你真的想计算什么？文件还是`<page>`s？

# c - 为什么溢出一个 char 数组会影响另一个数组？

> ID：12916856
> 
> 赞同：1
> 
> 时间：2012-10-16T14:23:05.687
> 
> 标签：c

**你好。这是难题。我有这个代码：**

```
#include<stdio.h>
#include<conio.h>
#include<string.h>
int main(){

char a[5];
char b[5];

memset(a, 0, 5); 
memset(b, 0,5);

strcpy(a, "BANG");

printf("b = "); 

scanf("%s", &b);
printf("a = %s\n", a);  
getch();
} 
```

当你运行它时，你会注意到如果你将足够长的字符串读入`b`， 的值`a`也会改变。你会期望它保持“BANG”，但事实并非如此。我想对此作出解释。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:32:00.150

恭喜，您遇到了第一次缓冲区溢出（首先您知道 :)）。

数组将分配在程序的堆栈中，并且这些数组是相邻的。由于 C 不检查是否违反数组边界，因此您可以将内存的任何允许部分作为任何数组的单元来访问。

让我们回顾一个非常常见的运行时示例，这个程序在 x86 上运行。x86 上的堆栈正在增长到最少的地址，因此通常编译器将其放在堆栈`a[]`之上。`b[]`当您尝试访问`b[5]`时，它的地址将与`a[0]`、`b[6]`is`a[1]`等相同。

这就是缓冲区溢出漏洞的工作原理：一些粗心的程序员没有检查缓冲区中的字符串大小，然后一个邪恶的黑客将他的恶意代码写入堆栈并运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:42:45.693

根据程序的内存来考虑它。 `a`是 5 个字符`b`的数组， 是 5 个字符的数组。你的堆栈上有这样的东西：

```
[0][0][0][0][0][0][0][0][0][0]
 ^              ^
 |              +--"a" something like 0xbfe69e52
 +-----------------"b" something like 0xbfe69e4d 
```

因此，当您执行“砰”的 strcpy 时：

```
[0][0][0][0][0][B][A][N][G][0]
 ^              ^
 |              +--"a" something like 0xbfe69e52
 +-----------------"b" something like 0xbfe69e4d 
```

现在，如果您将“长”字符串放入`b`：

```
[T][h][i][s][I][s][l][o][n][g]
 ^              ^
 |              +--"a" something like 0xbfe69e52
 +-----------------"b" something like 0xbfe69e4d 
```

哎呀，刚刚输了`a`。这是一个“缓冲区溢出”，因为您溢出`b`了（`a`在这种情况下）。C不会阻止你这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T14:25:45.750

您正在创建“缓冲区溢出”。该数组的大小只能容纳 5 个字节（4 个字符加上标准 C 字符串终止符），如果放得更多，其余的就会溢出。

通常，进入一些重要的事情，使你的程序崩溃。

有自动化工具（例如`valgrind`）来检测这种错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-16T14:26:29.977

如果字符串足够长，您将遇到缓冲区溢出并且行为未定义，包括覆盖另一个数组甚至使应用程序崩溃。因为行为是未定义的，你应该避免它，但只是为了理解，编译器已经在内存中的`a`数组之后布置了数组`b`（在编译器的这个特定运行中）。当您写信时，`b+sizeof(b)`您正在写信给`a[0]`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T14:49:00.697

上面每个人似乎都忘记提及的一件事是堆栈通常以与您期望的相反方向处理。

从当前堆栈指针（esp/rsp on x86/x64）有效地分配“a”减去 5 个字节。'b' 的分配然后再减去 5 个字节。

因此，当您进行第一次堆栈分配时，假设您的 esp 为 0x1000。这为“a”提供了内存地址 0xFB。'b' 然后将得到 0xF6，因此 0xF6 的第 6 个字节（即索引 5）是 0xF6 + 5 或 0xFB，因此您现在正在写入 a 的数组。

这可以通过以下代码轻松确认（假设为 32 位）：

```
printf( "0x%08x\n", a );
printf( "0x%08x\n", b ); 
```

你会看到 b 的内存地址比 a 低。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-16T14:30:34.830

b 只有 5 个字母。所以如果你写一个更长的字符串，你写的是与 b 相邻的内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-16T14:26:06.270

C 对内存访问没有边界检查，因此您可以在数组声明的末尾自由读写。`a`并且`b`可能最终在内存中相邻，即使与它们的声明顺序相反，所以除非你的代码注意*不要*读取比 eg 更多的字符 ，否则`b`你可能会损坏`a`. 实际发生的事情是未定义的，并且可能会随着运行而改变。

在这种特殊情况下，请注意您可以通过`scanf`在格式字符串中使用宽度来限制读取的字符数：`scanf("%4s", &b);`

# jquery - 仅在提交后显示 jQuery.validationEngine 警报

> ID：12916857
> 
> 赞同：1
> 
> 时间：2012-10-16T14:23:06.510
> 
> 标签：jquery

我使用[jQuery.validationEngine](https://github.com/posabsolute/jQuery-Validation-Engine)插件，我只想在用户提交表单后而不是在编辑表单时显示警报。

例子：

```
<form id="formID" method="post" action="submit.action">
<input value="2010-12-01" class="validate[required,custom[date]]" type="text" name="date" id="date" /> 
```

```
$(document).ready(function(){
   $("#formID").validationEngine();
 }); 
```

我知道这可能很容易，但我是 $ 新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:27:57.317

验证引擎执行此操作.. 将“绑定”选项设置为 true。前任：

```
$(document).ready(function(){
   $("#formID").validationEngine('attach', {
        binded: TRUE
   });
 }); 
```

[https://github.com/posabsolute/jQuery-Validation-Engine](https://github.com/posabsolute/jQuery-Validation-Engine)

根据文档，上述内容应该有效。因为它不会尝试这样的事情

```
$(document).ready(function(){
    $("#formbutton").click(function(){
        $("#form").validationEngine().submit();
        $("#form").validationEngine('detach');
    });
}); 
```

使验证引擎附加在按钮提交上。如果它失败了，你就分离以摆脱内联编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T19:26:24.923

验证引擎执行此操作.. 将“绑定”选项设置为 false。

```
$(document).ready(function(){
   $("#formID").validationEngine({
    binded: false
   });

 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-15T02:46:58.277

这就是我这样做的方式（使用 AJAX 登录）

```
$("#loginModal form").validationEngine('attach', {
  autoHidePrompt: true,
  autoHideDelay: 3000,
  validationEventTrigger: 'submit',// Validate on Submit
  onValidationComplete: function(form, status){
    if(status) { // status == true == it validated!!!
        // Login With Ajax
        $.ajax({
            url: '/login',
            type: 'post',
            dataType: 'json',
            data: {
                email: $('#login-email').val(),
                password: $('#login-password').val(),
            },
            success: function( result ) {
                   // Your Success func.
            }
        });
    }
  }
}); 
```

# c++ - Qt 中的非类方法（使用 qtcreator）未解析的外部符号

> ID：12916860
> 
> 赞同：1
> 
> 时间：2012-10-16T14:23:17.450
> 
> 标签：c++, qt, lnk2019

我有一个在 Linux 中构建没有问题的应用程序，现在我正在尝试针对 Windows 编译它，我创建了一个 .pro 文件专门用于在 Windows 中编译它。

我使用了一个伪类（只是一个带有大量方法的命名空间，但没有类语句，因此我可以在不创建对象的情况下使用它）在 Linux 中工作得很好，但是当我尝试针对 Windows 进行编译时，我得到一个'使用此伪类的所有代码中未解析的外部符号。

伪类是这样的：

```
namespace foo {
   bool method_bar();
} 
```

然后我像这样使用它：

```
foo:method_bar(); 
```

非常简单，有点像静态方法。

在有人问我之前，为什么不首先使用静态方法？我有一些特殊情况，我不能将这些方法用作静态方法。这就是为什么我直接在命名空间下构建方法。

因此，在我的 .PRO 文件中，我从我的伪类中添加了 .h 和 .cpp 文件，如下所示：

```
 HEADERS += \
       ....
       include/foo.h
       ....

    SOURCES += \
       ....
       include/foo.cpp
       ---- 
```

尽管它在我的项目中包含这些文件，但它抛出了 LNK2019: unresolved external symbol 错误。

我不是编程的初学者，但我是 Qt 的初学者。

任何帮助将不胜感激。

ps：原谅我的英文错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T18:31:07.103

首先范围运算符是 foo"::"method_bar();

请注意在使用函数之前包含标题，以便您调用此函数的地方知道函数的声明

在 QT 中使用命名空间没有问题。

还有一个建议是

使用命名空间 foo；

查看完整的代码真的可以帮助我解决问题

# sql-server - SSRS 根据其他值更改值

> ID：12916861
> 
> 赞同：0
> 
> 时间：2012-10-16T14:23:21.540
> 
> 标签：sql-server, ssrs-2008, reporting-services

我的报告遇到了问题。

此下拉菜单需要调整 PeriodStart/PeriodEnd 中的值

## ![](../Images/4b29d5fbc550f45f9bf152ed5b9ad069.png)

当每周周期改变时，这些值需要改变。虽然，我想在每周期间更改之前保留默认值。

## ![](../Images/0cd0c65b8fc7389a67412036502cb6d2.png)

因此，可以说下拉列表的值为 10/1/12 | 2012 年 10 月 7 日。我假设我将更改两个日期字段的表达式并对下拉值进行某种拆分，但我不确定那会是什么。这是我需要指导的地方。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:32:03.250

我现在不在报表生成器附近，但它应该是这样的：

1）让您的每周期间下拉一个日期时间字段，其中包含开始日期的值，以及您喜欢的任何格式的标签。

2）将您的期间开始日期参数设置为日期时间字段，并在默认值选项卡中，将默认值设置为表达式`=Parameters!WeeklyPeriod.Value`

3) 将期间结束日期参数设置为日期时间字段，并在默认值选项卡中，将默认值设置为表达式`=DateAdd("d", 7, Parameters!WeeklyPeriod.Value)`

# c# - 如何拥有一个带有 json 动态成员的 WCF DataContract

> ID：12916865
> 
> 赞同：8
> 
> 时间：2012-10-16T14:23:29.927
> 
> 标签：c#, json, wcf, serialization

在我正在进行的项目中，我们需要有一个可以包含一些未定义 JSON 的 DataContract。

DataMember 是一些仅对客户端有意义的 JSON。我们希望允许客户端向我们发送我们不知道的 json。

例子：

```
public class Contract
{
    [DataMember]
    public int clientId;
    [DataMember]
    public string json;
} 
```

显然，定义这样的合约需要客户端像这样转义 json：

```
{
    "clientId":1,
    "json": "{\"test\":\"json\"}"
} 
```

显然，这不是我们需要的。客户端应该发送给我们的 json 应该如下所示：

```
{
    "clientId":1,
    "json": {"test":"json"}
} 
```

我们调查的可能解决方案：

1.  使用 Stream 作为请求正文的合同参数。工作，但把工作放在我们这边，而不是使用框架。
2.  将“json”定义为 DynamicObject。不工作。无法正确写入属性。
3.  使用 Newtonsoft 库，更改 WCF 端点中的默认合同序列化程序，以将所有输入序列化为 JObject。我们还需要处理请求的序列化，这会导致我们的应用程序出现问题。我们宁愿避免这种方式。

有没有人可以解决这个问题？

**编辑**

该服务提供休息 json 资源。它使用 webHttpBinding 定义了一个端点。操作是这样定义的（为简单起见，简化了）：

```
[WebInvoke(Method = "POST", UriTemplate = "...", ResponseFormat = WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare)]
[OperationContract]
Stream Create(Contract c); 
```

此外，该服务装饰有以下属性：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)] 
```

谢谢你。杰夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T22:29:41.627

WCF（从 4.5 开始）不支持将任意 JSON 作为数据协定的一部分进行反序列化。您需要使用另一个序列化程序来执行此操作 - JSON.NET 是我个人喜欢的一个。为了能够更改序列化程序，您可以使用不同的消息格式化程序，并在[https://github.com/microsoftarchive/msdn-code-gallery-community-sz/tree/master/Supporting%20different%20data的帖子中%20and%20serialization%20formats%20in%20WCF](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Supporting%20different%20data%20and%20serialization%20formats%20in%20WCF)我有一个完全可以做到这一点的示例 - 将 WCF 使用的默认序列化替换为 JSON.NET。

请注意，要使用该库接收任意 JSON，您需要将“json”属性的类型更改为 JSON.NET 中的任意 JSON，JToken：

```
public class Contract 
{ 
    [DataMember] 
    public int clientId; 
    [DataMember] 
    public Newtonsoft.Json.Linq.JToken json; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:30:04.763

你用这些标签配置了类和方法吗？课堂实施前

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class xxx {...} 
```

方法实现前

```
[OperationContract]
[WebGet(ResponseFormat = WebMessageFormat.Json)]
public Contract getContract() {...} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T18:09:45.487

你试过这个吗？

```
public class Contract 
{ 
    [DataMember] 
    public int clientId; 
    [DataMember] 
    public Dictionary<string,string> DynamicProperties; 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-11T10:24:29.797

更改签名以接受流。例如：

```
public String ProcessJson(Stream jsondata)
{
//play with jsondata

} 
```

要作为流接收，请覆盖 WebContentTypeMapper 方法。

```
 public class RawWebContentTypeMapper : WebContentTypeMapper 
    {
        public override WebContentFormat GetMessageFormatForContentType(string contentType)
        {            
                return WebContentFormat.Raw;       
        }   
    } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-16T15:51:45.693

您不希望“json”属性包含字符串，而是希望它包含对象。像这样：

```
public class Contract
{
    [DataMember]
    public int clientId;
    [DataMember]
    public JsonObj json;
}
public class JsonObj
{
    [DataMember]
    public string test;
} 
```

这样 json 解析器将输出您需要的内容。我希望我说清楚了。

干杯!

# android - “在不使用默认/内置应用程序的情况下使用 JavaMail API 在 Android 中发送电子邮件”仅适用于模拟器？

> ID：12916867
> 
> 赞同：2
> 
> 时间：2012-10-16T14:23:32.847
> 
> 标签：android, email

[在不使用默认/内置应用程序的情况下使用 JavaMail API 在 Android 中发送电子邮件](https://stackoverflow.com/questions/2020088/sending-email-in-android-using-javamail-api-without-using-the-default-built-in-a)

该问题的上述解决方案在模拟器上完美运行，但在我的 ICS 设备上不起作用。为 ICS 及更高版本引入此或更新修复的任何原因？

更新：我通过运行最新的 android os 4.1.2 并将清单更改为 min sdk 版本 7 使其工作。我真的无法解释为什么它开始以这种方式工作。我尝试了实际设备和运行构建目标 4.0.3 的 avd，但发送失败且没有错误。将其更改为最新的 4.1.2 仍然没有。放弃了，所以回到了另一个活动，但我无法在我的设备上运行它。我只是将 min sdk 更改为 7 离开了构建目标，在完成一天之前再次尝试它，它以某种方式工作。此外，我对整个构建所做的另一个更改是添加到清单中。不知道是不是那个或 minsdk 是什么修复了它，但认为 id 包括更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T11:35:02.000

我在我的 android 版本 4.0.3 上遇到了同样的问题。将 min sdk 版本更改为 7 就可以了。

```
<uses-sdk android:minSdkVersion="7" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-11T13:50:15.260

虽然它解决了，但我遇到了通过使用上述解决方案的[这一](https://stackoverflow.com/a/13470775/1323163)部分解决的相同问题

我的意思是使用`AsyncTask` which 允许您在用户界面上执行异步工作。AsyncTask 将在工作线程中执行阻塞操作并将结果发布到 UI 线程上，而无需您自己处理线程和/或处理程序。

# plsql - PL/SQL：如何编写这个程序？

> ID：12916872
> 
> 赞同：0
> 
> 时间：2012-10-16T14:23:46.183
> 
> 标签：plsql

我有 3 列：“GAME”“PLAYER_ID”“MINUTES_PLAYED”

看起来像这样：

```
GAME     ID     MINUTES_PLAYED
12550788  229569   23
12500788  393438   4
12500788  458730   25
12500782  229569   10 
```

我想找到每场比赛的总上场时间，即

```
ID       TOTAL_MINUTES
229569   33
.
.
. 
```

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:25:36.200

`select id, sum(minutes_played) from tableName group by id`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:25:41.333

```
SELECT ID, SUM(MINUTES_PLAYED)
FROM MYTABLE
GROUP BY ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:26:01.707

只需将它们相加：

```
SELECT ID, SUM(MINUTES_PLAYED) AS TOTAL_MINUTES
FROM table GROUP BY ID 
```

# wpf - 将转换应用于源 xaml

> ID：12916876
> 
> 赞同：0
> 
> 时间：2012-10-16T14:23:58.957
> 
> 标签：wpf, silverlight, xaml

我对 XAML 和 Blend 有一点问题。我们已将公司徽标从 转换`AI -> SVG -> XAML`，对其进行了一些清理，并且它产生了一个非常奇特的来源。本质上，它是对一组路径应用“翻转”转换：

```
<Canvas Width="640" Height="200" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Canvas Width="640" Height="200" RenderTransform="1,0,0,-1,0,200" >

        <!-- L -->
        <Canvas RenderTransform="1,0,0,1,317.0645,64.3652">
            <Path>
                <Path.Data>
                    <PathGeometry FillRule="Nonzero" Figures="M0,0L0,75.065 18.743,76.83 18.743,17.066 43.553,17.066 38.564,0 0,0z" />
                </Path.Data>
            </Path>
        </Canvas>
        ... etc 
```

注意`RenderTransform="1,0,0,-1,0,200"`封闭的节点`Canvas`。它将画布上下翻转并将其降低 200 以调整到根画布位置。鉴于 taht 徽标在渲染时看起来不错意味着 xaml 中的所有图形元素实际上都是颠倒的 :)。也许它是一个人工智能的东西，我不知道。

问题是我现在使用 Blend 将此画布转换为 GraphicBrush。混合省略了变换，并且在应用画笔时徽标看起来是颠倒的。而不是再次在每个画笔接收者处进行转换，我在想也许我们应该只在根处修复它，例如转换所有路径，以便它们正确渲染以开始避免对根转换的需要。

问题：是否有程序化（或任何其他方式）可以做到这一点？意思是，我可以渲染这个画布，然后将渲染的（在应用了所有转换之后）DOM 序列化为 XAML 吗？

或者为了让问题更清楚：每条路径都应用了两个变换（如上所示，每条路径一个全局翻转和一个局部移位），我能否以某种方式将这些变换应用于每个路径/它的点，以便路径在没有它们的情况下呈现.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T14:25:10.373

您可以使用Microsoft 表达式套件中**表达式设计**中内置的导出到 XAML 功能。

或者我个人通常使用 Mike Swanson 的[AI 到 XAML 转换器](http://www.mikeswanson.com/xamlexport/)，因为我通常已经在 Illustrator 中工作以处理更复杂的矢量图形。

两者都会提供比您使用的转换器更好的结果。不确定原始转换在哪里使用 RenderTransforms 等变得如此古怪，但正如您所发现的，从一开始就进行良好的转换会有所帮助，然后再经历修复坏转换的麻烦哈哈。

干杯!

# c++ - 使用 Boost.Python 公开带有无符号字符和参数的方法

> ID：12916877
> 
> 赞同：1
> 
> 时间：2012-10-16T14:24:03.227
> 
> 标签：c++, python, boost-python

我有闭源 C++ 库，它提供的头文件代码相当于：

```
class CSomething
{
  public:
      void getParams( unsigned char & u8OutParamOne, 
                      unsigned char & u8OutParamTwo ) const;
  private:
      unsigned char u8OutParamOne_,
      unsigned char u8OutParamTwo_,
}; 
```

我试图将它暴露给 Python，我的包装代码是这样的：

```
BOOST_PYTHON_MODULE(MySomething)
{
    class_<CSomething>("CSomething", init<>())
        .def("getParams", &CSomething::getParams,(args("one", "two")))

} 
```

现在我正在尝试在 Python 中使用它，但失败了：

```
one, two = 0, 0
CSomething.getParams(one, two) 
```

结果是：

```
ArgumentError: Python argument types in
    CSomething.getParams(CSomething, int, int)
did not match C++ signature:
    getParams(CSomething {lvalue}, unsigned char {lvalue} one, unsigned char {lvalue} two) 
```

我需要在 Boost.Python 包装器代码或 Python 代码中进行哪些更改才能使其正常工作？如何添加一些 Boost.Python 魔法来自动`PyInt`转换`unsigned char`，反之亦然？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:22:42.367

`Boost.Python`正在抱怨缺少`lvalue`参数，这是 Python 中不存在的概念：

```
def f(x):
  x = 1

y = 2
f(y)
print(y) # Prints 2 
```

该函数的`x`参数`f`不是类似 C++ 的引用。在 C++ 中，输出是不同的：

```
void f(int &x) {
  x = 1;
}

void main() {
  int y = 2;
  f(y);
  cout << y << endl; // Prints 1.
} 
```

您在这里有几个选择：

a) 包装`CSomething.getParams`函数以返回新参数值的元组：

```
one, two = 0, 0
one, two = CSomething.getParams(one, two)
print(one, two) 
```

b) 包装`CSomething.getParams`函数以接受类实例作为参数：

```
class GPParameter:
  def __init__(self, one, two):
    self.one = one
    self.two = two

p = GPParameter(0, 0)
CSomething.getParams(p)
print(p.one, p.two) 
```

# c++ - Mingw 和 libraw 导致未定义的引用

> ID：12916878
> 
> 赞同：0
> 
> 时间：2012-10-16T14:24:07.083
> 
> 标签：c++, mingw

有人用 mingw 使用 libraw 吗？我正在尝试编译一个程序并得到以下错误：

```
obj\Release\inc\img\cimg.o:cimg.cpp|| undefined reference to `_imp___ZN6LibRawC1Ej'|
obj\Release\inc\img\cimg.o:cimg.cpp|| undefined reference to `_imp___ZN6LibRaw9open_fileEPKcx'|
obj\Release\inc\img\cimg.o:cimg.cpp|| undefined reference to `_imp___ZN6LibRaw6unpackEv'|
obj\Release\inc\img\cimg.o:cimg.cpp|| undefined reference to `_imp___ZN6LibRaw13dcraw_processEv'|
obj\Release\inc\img\cimg.o:cimg.cpp|| undefined reference to `_imp___ZN6LibRaw20dcraw_make_mem_imageEPi'|
obj\Release\inc\img\cimg.o:cimg.cpp|| undefined reference to `_imp___ZN6LibRaw7recycleEv'|
obj\Release\inc\img\cimg.o:cimg.cpp:(.text$_ZN6LibRawD1Ev[LibRaw::~LibRaw()]+0xf)||undefined reference to `_imp___ZN6LibRaw7recycleEv'|
||=== Build finished: 7 errors, 0 warnings ===| 
```

我将 libraw.a 添加到我的项目中。想不出问题。有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:29:24.540

从这些符号名称来看，您似乎正在尝试针对 libraw 的 DLL 版本进行编译（由`_imp___`前缀暗示）。检查您的 libraw 头文件并确保函数名称没有类似`__declspec(dllimport)`或`__attribute__((dllimport))`前面的任何内容。这些有时会被宏定义隐藏，因此请检查头文件以查看您是否可以定义另一个宏，这将导致它不在函数原型中使用该属性。

# python - MySQL INSERT ... ON DUPLICATE KEY UPDATE 使用 django 1.4 进行批量插入

> ID：12916880
> 
> 赞同：3
> 
> 时间：2012-10-16T14:24:16.947
> 
> 标签：python, mysql, django

我在使用 django 1.4 确定 MySQL INSERT ... ON DUPLICATE KEY UPDATE 时遇到问题。

我试图插入记录的表有一个 2 列（复合）唯一键。我收到的记录来自第 3 方来源，并且值会随着时间的推移而变化，除了那些设置唯一键的字段。我一次收到 1 ~ 5k 条记录，需要

目前我正在使用 Model.objects.bulk_create 进行批量插入，性能非常惊人，因为无论记录集有多大，它通常都会发出一个查询。但是，由于我的记录在第 3 方结束时会随着时间而改变，我需要对记录集执行 MySQL INSERT ... ON DUPLICATE KEY UPDATE 查询。

我打算编写原始 SQL 语句并使用类似这里的东西执行：

```
sql = "MySQL INSERT ... ON DUPLICATE KEY UPDATE"

raw_insert(sql)

def raw_insert(sql):
    from django.db import connection, transaction
    cursor = connection.cursor()

    # Data modifying operation - commit required
    cursor.execute(sql)
    transaction.commit_unless_managed()

    return 1 
```

想知道我的问题是否有更好的解决方案。另外，我将如何清理原始插入的字段值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-17T03:20:13.703

所以我创建了一个自定义管理器。这是经理：

```
class BulkInsertManager(models.Manager):
    def _bulk_insert_or_update(self, create_fields, update_fields, values):

        from django.db import connection, transaction
        cursor = connection.cursor()

        db_table = self.model._meta.db_table

        values_sql = []
        values_data =[]

        for value_lists in values:
            values_sql.append( "(%s)" % (','.join([ "%s" for i in range(len(value_lists))]),) )
            values_data.extend(value_lists)

        base_sql = "INSERT INTO %s (%s) VALUES " % (db_table, ",".join(create_fields))

        on_duplicates = []

        for field in update_fields:
            on_duplicates.append(field + "=VALUES(" + field +")")

        sql = "%s %s ON DUPLICATE KEY UPDATE %s" % (base_sql, ", ".join(values_sql), ",".join(on_duplicates))

        cursor.executemany(sql, [values_data])
        transaction.commit_unless_managed() 
```

和一个样本模型：

```
class User_Friend(models.Model):
    objects = BulkInsertManager() # assign a custom manager to handle bulk insert

    id = models.CharField(max_length=255)
    user = models.ForeignKey(User, null=False, blank=False)
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)
    city = models.CharField(max_length=50, null=True, blank=True)
    province = models.CharField(max_length=50, null=True, blank=True)
    country =  models.CharField(max_length=30, null=True, blank=True) 
```

和示例实现：

```
def save_user_friends(user, friends):
    user_friends = []
    for friend in friends:

        create_fields = ['id', 'user_id', 'first_name', 'last_name', 'city', 'province', 'country']
        update_fields = ['first_name', 'last_name', 'city', 'province', 'country']

        user_friends.append(
            [
                str(user.id), 
                str(friend['id']),
                friend['first_name'],
                friend['last_name'],
                friend['city'],
                friend['province'],
                friend['country'],
            ]
        )

    User_Friend.objects._bulk_insert_or_update(create_fields, update_fields, user_friends) 
```

这是[要点](https://gist.github.com/3903508)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T21:54:55.880

您可以使用 ModelForm 进行消毒：

```
from django.forms.models import modelform_factory
form_class = modelform_factory(MyModel)

for obj in my_data:
    form = form_class(obj)
    if not form.is_valid():
        raise Hell() 
```

至于原始 SQL，我说去吧。Django 的 ORM 似乎不支持`ON DUPLICATE KEY UPDATE`，所以不要让它妨碍你。[Django 文档谈论毫无保留地这样做](https://docs.djangoproject.com/en/dev/topics/db/sql/)。

不过，它可能值得使用`Manager.raw`。

# hibernate - 如何使用 Hibernate 在数据库中搜索项目

> ID：12916881
> 
> 赞同：0
> 
> 时间：2012-10-16T14:24:19.293
> 
> 标签：hibernate, tapestry

我是新来的（非常新的）冬眠。我正在使用 Hibernate 和 Tapestry。我想做的是在数据库中搜索一些元素。我在数据库中有用户 ID、用户名和密码（以及一个名为 User 的类）。我需要使用用户名检查输入字符串，如果存在则需要检查密码是否正确。

```
List<User> moderators =  session.createCriteria(User.class).list(); 
```

我可以获取对象列表并通过它进行搜索。但我相信 Hibernate 会做得更好更快。谁能告诉我该怎么做？

# csv - 将 xlsx 转换为 csv 时出现文本列问题

> ID：12916882
> 
> 赞同：2
> 
> 时间：2012-10-16T14:24:21.177
> 
> 标签：csv, xlsx, file-conversion

我在将 xlsx 文件转换为 csv 格式时遇到问题。不知何故，它不会复制包含文本的列的内容。

我试过：python xlsx2csv-0.20/xlsx2csv.py -s 2 -d ';' 'testin.xlsx' 'testout.csv'

结果应如下所示：

"www.vistaheads.com";"http://www.vistaheads.com/forums/microsoft-public-windows-vista-general/200274-vista-mbr-vs-xp-mbr-4.html";"YahooBossAPIv2 ";;"eng";"ie";;9/8/2010;TRUE;FALSE;;0;-8.2666666667;0;0;0;0
"www.drpletsch.com";"http://www. drpletsch.com/elos-acne-treatment.html";"Oxyme.Searchv3.0.0";;"eng";;;7/31/2012;TRUE;FALSE;;;;0;0;0;0
"www .charterhouse-aquatics.co.uk";"http://www.charterhouse-aquatics.co.uk/catalog/elos-systemmini-marine-litre-aquarium-black-p-7022.html";"YahooBossAPIv2"; ;"eng";"us";;7/11/2012;TRUE;FALSE;;1;5.6666666667;0;0;0;0
"www.proz.com";"http://www.proz.com /kudoz/latin_to_english/religion/4794760-concio_melos_tinnulo.html";"YahooBossAPIv2";;"eng";"in";;5/7/2012;TRUE;FALSE;;1;3;0;0;0;0
“schoee.blogspot.co.uk”；“http://schoee.blogspot.co.uk/2010/08/review-body-shop-vitamin-c-facial.html”；“YahooBossAPIv2”；；“eng” ;;;2010 年 8 月 1 日;真;假;;1;1;0;0;0;0

但相反，我得到：

;;;;;;;09-08-10;真;假;;0.0;-8.266666666666666;0.0;0.0;0.0;0.0;
;;;;;;;07-31-12;真;假;;;;0.0;0.0;0.0;0.0;
;;;;;;;07-11-12;真;假;;1.0;5.666666666666667;0.0;0.0;0.0;0.0;
;;;;;;;05-07-12;真;假;;1.0;3.0;0.0;0.0;0.0;0.0;
;;;;;;;08-01-10;真;假;;1.0;1.0;0.0;0.0;0.0;0.0;
;;;;;;;09-08-10;真;假;;0.0;0.033333333333333354;0.0;0.0;0.0;0.0;
;;;;;;;07-03-12;真;假;;1.0;2.0;0.0;0.0;0.0;0.0;
;;;;;;;10-18-11;真;假;;1.0;4.666666666666667;0.0;0.0;0.0;0.0;

我也尝试使用 ssconvert，但在这里我得到了类似的结果，即：

ssconvert -S 'testin.xlsx' testout2.csv

同样在这里，文本内容不知何故消失了：

2010/09/08,TRUE,FALSE,,0,-8.26666666666667,0,0,0,0
"2012/07/31 09:58:39.823",TRUE,FALSE,,,,0,0,0,0
"2012/07/11 13:35:09.220",TRUE,FALSE,,1,5.66666666666667,0,0,0,0
2012/05/07,TRUE,FALSE,,1,3,0,0,0, 0
2010/08/01,TRUE,FALSE,,1,1,0,0,0,0
2010/09/08,TRUE,FALSE,,0,0.03333333333333,0,0,0,0
"2012/07/ 03 22:24:03.467",TRUE,FALSE,,1,2,0,0,0,0
2011/10/18,TRUE,FALSE,,1,4.66666666666667,0,0,0,0
"2012/07 /22 02:10:58.313",TRUE,FALSE,,1,2,0,0,0,0
"2012/08/02 17:01:39.637",TRUE,FALSE,,1,1,0,0 ,0,0
2010/06/05,TRUE,FALSE,,1,4,0​​,0,0,0
"2012/07/25 16:11:47.843",TRUE,FALSE,,1,2,0, 0,0,0
2012/09/26,TRUE,TRUE,1,,,1,0,0,1
2012/04/29,TRUE,TRUE,2,,,8,3,1,4
2012/07/22,TRUE,FALSE,,0,0.03333333333333,0,0,0,0
2012/05/01,TRUE,FALSE,,1,14,0,0,0,0
"2012/08/07 06:17:39.647",TRUE,FALSE,,1,1,0,0,0,0
"2012/07/18 15:15:19.283",TRUE,FALSE,,1,3,0,0,0 ,0
2012/07/27,TRUE,FALSE,,1,0.33333333333333,0,0,0,0
2010/09/08,TRUE,FALSE,,1,0.33333333333333,0,0,0,0
"2012/07 /21 18:10:57.700",真,假,,1,0.33333333333333,0,0,0,0

Excel 文件对我来说看起来不错。有什么想法可能会出错吗？

Excel 文件是使用 Apache POI 生成的，也许这是一个线索？

亲切的问候，瑞安

# powershell - Register-WmiEvent (Win32_ProcessStopTrace) - 如何在 -Action 开关中使用变量？

> ID：12916884
> 
> 赞同：0
> 
> 时间：2012-10-16T14:24:30.070
> 
> 标签：powershell, powershell-2.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:06:19.643

这是我使用备用查询对任务的看法，注册 Win32_Service 修改事件，其中 Win32_Service.State 值为“已停止”。我使用 $Event.SourceEventArgs.NewEvent.TargetInstance.Name 来获取服务名称：

```
function Stop-MyService($SystemName)
{
    $ControllerSvc = $SystemName

    $query = "SELECT * FROM __InstanceModificationEvent WITHIN 2 " +
             "WHERE TargetInstance Isa 'Win32_Service' " +
             "AND TargetINstance.Name = '" + $ControllerSvc + "' " +
             "AND TargetInstance.State = 'Stopped'"

    $action = 
    { 
        Write-Host $Event.SourceEventArgs.NewEvent.TargetInstance.Name," stopped "
        Unregister-Event -SourceIdentifier "ControllerSvcEvent"    
    }

    Register-WMIEvent -query $query -SourceIdentifier "ControllerSvcEvent" -action $action
}

Stop-MyService 'MSSQL$SQLEXPRESS' 
```

我使用 SQL Server Express 进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:30:15.600

尝试`$ControllerSvc`通过`-MessageData`参数of `Register-WMIEvent`，那么它应该可以通过`$Event`，根据[这篇文章](http://www.colorconsole.de/PS_Windows/en/Register-WmiEvent.htm)。

# mysql - MySQL 计划事件：数据库备份，包括输出文件中的日期

> ID：12916894
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:25:01.597
> 
> 标签：mysql, events, date-format

我现在正在努力使我的小型备份系统自动化。我设法收集了一些代码，但我做不到。

```
SET @sql_text = 
   CONCAT (
   "SELECT * FROM commandes INTO OUTFILE 'Y:/folder/Archives/BDD-commandes-CSV"
   , DATE_FORMAT( NOW(), '%Y%m%d')
   , "commandes.csv'"
);

PREPARE s1 FROM @sql_text;

CREATE EVENT BackUpCSV
ON SCHEDULE EVERY 1 HOUR
STARTS CURRENT_TIMESTAMP + INTERVAL 1 DAY
ENDS CURRENT_TIMESTAMP + INTERVAL 1 YEAR
DO
  BEGIN
    EXECUTE s1;
  END |

DROP PREPARE s1; 
```

这是我试图做的。在第 7 行发现了一个错误，实际上它是一个空行（'#1064 - 您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 7 行的 '' 附近使用正确的语法')

我会很感激能得到这个帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T17:36:31.517

有关于分隔符的一切。这是可以编译的版本：

```
SET @sql_text = 
   CONCAT (
   "SELECT * FROM commandes INTO OUTFILE 'Y:/folder/Archives/BDD-commandes-CSV"
   , DATE_FORMAT( NOW(), '%Y%m%d')
   , "commandes.csv'"
);

PREPARE s1 FROM @sql_text;

delimiter |

CREATE EVENT BackUpCSV
ON SCHEDULE EVERY 1 HOUR
STARTS CURRENT_TIMESTAMP + INTERVAL 1 DAY
ENDS CURRENT_TIMESTAMP + INTERVAL 1 YEAR
DO
  BEGIN
    EXECUTE s1;
  END |

delimiter ;

DROP PREPARE s1; 
```

另外，我建议添加`drop event if exists BackUpCSV |`

附言。我不确定这个脚本是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T17:44:51.297

为此，最好使用 shell 脚本或命令行。像这样的东西：

```
#!/bin/bash

mysqldump --add-drop-table -h <hostname> -u <username> --password=<password> --all-databases > filename.sql
filename="filename.sql."`eval date +%Y%m%d`".tgz"
tar -czf $filename filename.sql 
rm filename.sql 
```

您可以将其保存到文件中，并将该文件作为 cron 作业运行。如果您愿意，您甚至可以将该存档文件推送到具有相同脚本的另一个系统。

当然，您应该明白，在这种情况下，您将数据库凭据存储在一个普通文件中。但是，如果有人可以访问文件系统，我相信他/她会找到您的应用程序配置文件，而您的操作完全相同。

# sharepoint - Site Settings not working in sp 2013 after migration from sp 2010

> ID：12916898
> 
> 赞同：3
> 
> 时间：2012-10-16T14:25:11.877
> 
> 标签：sharepoint, migration, sharepoint-2013

I migrated my sharepoint 2010 site to sharepoint 2013 server. The site contains custom web parts.

Now all pages (both custom and out-of-the-box) are working fine without any issue.

But when I go to site settings, I get this: **An error occurred during the compilation of the requested file, or one of its dependencies. Cannot convert type 'string' to 'int'**

Checking the logs, i found the following exception:

```
> Application error when access /_layouts/settings.aspx,
Error=c:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\e75b3e8d\191e7f\App_Web_settings.aspx.2a428413.q0ornjvx.0.cs(491):
error CS0030: Cannot convert type 'string' to 'int'
   at System.Web.Compilation.AssemblyBuilder.Compile()
   at System.Web.Compilation.BuildProvidersCompiler.PerformBuild() 
   at System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath)  
   at System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate)  
   at System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate)  
   at System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean throwIfNotFound)  
   at System.Web.Compilation.BuildManager.CreateInstanceFromVirtualPath(VirtualPath virtualPath, Type requiredBaseType, HttpContext context, Boolean allowCrossApp)  
   at System.Web.UI.PageHandlerFactory.GetHandlerHelper(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath)  
   at System.Web.HttpApplication.MaterializeHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()  
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
> 
> System.Web.HttpCompileException: c:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\e75b3e8d\191e7f\App_Web_settings.aspx.2a428413.q0ornjvx.0.cs(491):
 error CS0030: Cannot convert type 'string' to 'int'    at System.Web.Compilation.AssemblyBuilder.Compile()
     at System.Web.Compilation.BuildProvidersCompiler.PerformBuild() 
     at System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath)
     at System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate)
     at System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate)
     at System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean throwIfNotFound)
     at System.Web.Compilation.BuildManager.CreateInstanceFromVirtualPath(VirtualPath virtualPath, Type requiredBaseType, HttpContext context, Boolean allowCrossApp)
     at System.Web.UI.PageHandlerFactory.GetHandlerHelper(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath)
     at System.Web.HttpApplication.MaterializeHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
     at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
> 
> An error occurred during the compilation of the requested file, or one of its dependencies. Cannot convert type 'string' to 'int 
```

'

Any help will be appreciated.

Thanks in advance, Ferdin

# php - Foreign key constraint error when saving product

> ID：12916899
> 
> 赞同：2
> 
> 时间：2012-10-16T14:25:14.157
> 
> 标签：php, mysql, magento, foreign-keys, constraints

```
$product = Mage::getModel('catalog/product');
            // Build the product
            $product->setStoreID($store_id);//Store Id
                   $product ->setTotalrooms($post['room'])//No of roms avaliable
                    ->setSku($sku)//product Sku
                    ->setUserid($CusId)//Customer id
                    ->setAttributeSetId(4)
                    ->setTypeId('property')//product type
                    ->setName($post['name'])//propertyName
                    ->setDescription($post['desc'])//Description
                    ->setShortDescription($post['sdesc'])//shortdescription
                    ->setPrice($post['price']) // Set some price
                    ->setAccomodates($post['accomodate'])//Custom created and assigned attributes
                    ->setHostemail($CusEmail)//host email id
                    ->setpropertyadd($post['address'])// property address
                    ->setAmenity($amenity)//amenity like room service,e.t.c
                    ->setState($post['state'])//property state name
                    ->setCity($post['city'])// property city name
                    ->setCountry($post['propcountry'])//country
                    ->setCancelpolicy($post['cancelpolicy'])//regarding to cancelation policy
                    ->setPets($post['pets'])//regaring to pets allowed or not allowed
                    ->setBedtype($post['bedtype'])//bedtype
                    ->setMaplocation($post['map'])//property map location
                    ->setMetaTitle($post['meta_title'])//Meta title
                    ->setMetaKeyword($post['meta_keyword'])//Meta keywords
                    ->setMetaDescription($post['meta_description'])//Meta description
                    ->setPropertytype(array($post['proptype']))//property type
                    ->setPrivacy(array($post['privacy']))//privacy
                    ->setCategoryIds(Mage::app()->getStore()->getRootCategoryId())//Default Category
                    ->setVisibility(Mage_Catalog_Model_Product_Visibility::VISIBILITY_BOTH)//Visibility in both catalog and search
                    ->setStatus(1)//enable the Status
                    ->setTaxClassId(0) # My default tax class
                    ->setStockData(array(
                        'is_in_stock' => 1,
                        'qty' => 100000
                    ))//Inventory
                    ->setCreatedAt(strtotime('now'))
                    ->setWebsiteIDs(array($websiteId)); //Website id, my is 1 (default frontend)
           try {
                    $product->save();
                }
                catch (Exception $ex) {
                    echo $ex->getMessage();
                    exit();
                } 
```

When I save the product it shows the error like the below:

> a:5:{i:0;s:313:"SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`glampeu_mage1`.`mage_catalog_product_entity`, CONSTRAINT `FK_GALI_CAT_PRD_ENTT_ATTR_SET_ID_GALI_EAV_ATTR_SET_ATTR_SET_ID` FOREIGN KEY (`attribute_set_id`) REFERENCES `mage_eav_attribute_set` )";i:1;s:2463:"#0 /lib/Varien/Db/Statement/Pdo/Mysql.php(110): Zend_Db_Statement_Pdo->_execute(Array)

Can any one help me to rectify the problem?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:34:58.127

看起来您没有设置**attribute_set_id** = 4 的属性，因此您的新产品无法插入或更新。检查您的表**mage_eav_attribute_set**以查看它是否为真。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T14:10:50.593

检查您的 attribute_set_id 是否正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T05:35:37.853

try this code

```
try {
   //$product->save(); //this method re-trigger all save events
   $product->getResource()->save($product);
}
catch (Exception $ex) {
   echo $ex->getMessage();
   exit();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-30T08:19:58.790

这条线应该有一个大写P

```
->setpropertyadd($post['address'])// property address 
```

所以应该是

```
->setPropertyadd($post['address'])// property address 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T15:53:01.310

检查您的数据库中的密钥，可能存在问题，有时它会在更新 magento 后发生。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-12T16:02:28.367

Community 和 Entrprise 的工作方式似乎有些不同，

在社区中，$product->save(); 将在企业版中工作，$product->getResource()->save($product); 作品。

使用后者时，社区似乎不会引发任何约束错误，但企业会。

# c# - 如何控制winform mschart图例文本对齐c#？

> ID：12916901
> 
> 赞同：2
> 
> 时间：2012-10-16T14:25:16.673
> 
> 标签：c#, text, alignment, mschart, legend

如何在图表图例对象中设置文本的对齐方式？我试过使用：

```
 myChartName.Legends["mySeriesName"].Alignment = stringAlignment.Near 
```

没有效果。我还尝试创建自定义图例项，再次导致无效。文本始终在图例“框”中居中（与系列标记一起）。我能够对齐的唯一文本是标题，但我的应用程序中不需要标题。

我迄今为止的研究表明，图例对象基本上是一个带有（默认情况下）两个单元格的表格。如果是这种情况，应该有一种方法可以访问这些单元格并将它们作为表格单元格进行操作。那么，什么给了？为什么我无法访问图例对象的文本对齐属性？显然，我缺少一些东西，但对于我的生活，我似乎无法弄清楚这一点。相当令人沮丧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T19:09:23.050

问题解决了。CustomItem 方法也不起作用，所以我尝试使用 LegendCellColumn 类。

我将 LegendStyle 从 Column 更改为 Row，然后添加了两个 CellColumn，一个用于系列符号，一个用于图例文本。设置对齐方式、边距和列宽（原来是诀窍），瞧；一个看起来像我想要的传奇。这是任何有类似问题的人的代码。

```
chartSel.Legends[ySeries.Name].CellColumns.Add(new LegendCellColumn("", LegendCellColumnType.SeriesSymbol, ""));
chartSel.Legends[ySeries.Name].CellColumns[0].Alignment = ContentAlignment.TopLeft;
chartSel.Legends[ySeries.Name].CellColumns[0].Margins = new System.Windows.Forms.DataVisualization.Charting.Margins(0, 0, 1, 1);
chartSel.Legends[ySeries.Name].CellColumns[0].MinimumWidth = 250;
chartSel.Legends[ySeries.Name].CellColumns[0].MaximumWidth = 250;

chartSel.Legends[ySeries.Name].CellColumns.Add(new LegendCellColumn("", LegendCellColumnType.Text, ySeries.Name));
chartSel.Legends[ySeries.Name].CellColumns[1].Alignment = ContentAlignment.MiddleLeft;
chartSel.Legends[ySeries.Name].CellColumns[1].Margins = new System.Windows.Forms.DataVisualization.Charting.Margins(0, 0, 1, 1);
chartSel.Legends[ySeries.Name].CellColumns[1].MinimumWidth = 1500;
chartSel.Legends[ySeries.Name].CellColumns[1].MaximumWidth = 1500; 
```

这可能不是最有效的方法，但它确实有效。从技术上讲，图例符号和文本仍然在对象中居中，但是因为我强制调整两列的宽度，所以它看起来像是左对齐的。

希望这可以帮助像我这样的另一个新手避免惊慌失措的日子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:30:37.540

我的理解是`Legend`对齐与`Docking`属性有关，而不是文本在图例中的对齐方式。所以设置`Alignment`为 Near 意味着将图例框定位在`Docking`方向附近。

这在文字上是很难解释的。[MS Chart Samples](http://archive.msdn.microsoft.com/mschart)有一个名为的小节，`Chart features -> Legends -> Style and Auto Positioning`它将帮助您使用这两个属性并了解它们的工作原理。

对于内部图例对齐，您可能需要单独使用`Legend.CustomItems`和定义`LegendCell`。

```
chart.Legends["Default"].CustomItems.Clear();
chart.Legends["Default"].CustomItems.Add(new LegendItem("LegendItem", Color.Red, ""));
chart.Legends["Default"].CustomItems[0].Cells.Add(new LegendCell(LegendCellType.Text, "My text", ContentAlignment.MiddleLeft)); 
```

这`Chart features -> Legends -> Legend Cells`在示例部分中进行了描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T22:53:34.313

在继续尝试弄清楚这一点时，我偶然发现了来自以下 MSDN 库页面的这条信息：

[http://msdn.microsoft.com/en-us/library/dd456711(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/dd456711(v=vs.100).aspx)

“注意：您不能调整 Chart.Legends 集合中的单个图例项和单元格。要调整它们，请使用自定义图例项。”

所以，回到 CustomItem 路线。我从几个来源（包括你，Dominique，谢谢）收集了这段代码：

```
chartSel.Legends.Add(ySeries.Name);
chartSel.Series[ySeries.Name].IsVisibleInLegend = false;
chartSel.Legends[ySeries.Name].CustomItems.Clear();
LegendItem li = new LegendItem();
li.ImageStyle = LegendImageStyle.Line;
li.Cells.Add(LegendCellType.SeriesSymbol, "", ContentAlignment.TopLeft);
li.Cells[0].BackColor = Color.CornflowerBlue; //color is only to see the cell bounds
li.Cells.Add(LegendCellType.Text, ySeries.Name, ContentAlignment.TopLeft);
li.Cells[1].BackColor = Color.Aquamarine; //color is only to see the cell bounds
chartSel.Legends[ySeries.Name].CustomItems.Add(li); 
```

据我所知，它应该可以工作，但事实并非如此。它产生一个带有两个单元格的图例对象；第一个是空的，第二个是左对齐的文本。我试图发布它的图像，但系统说我还不配。

为什么系列符号没有线也是一个谜，但这是另一个需要解决的问题。文本对齐问题是我目前主要关心的问题。看起来单元格中的文本是左对齐的，但单元格本身在图例对象中居中；不是我想要的。我也希望这些单元格在对象中左对齐，所以第一个单元格靠在图例对象的左边缘。

想法？

# struts - How to pass more than one parameter using display tag?

> ID：12916902
> 
> 赞同：0
> 
> 时间：2012-10-16T14:25:17.610
> 
> 标签：struts, query-string, jsp-tags, displaytag, querystringparameter

I'm using display tag. but i want to pass more than one parameter in the runtime. How can i pass the more than one parameter in the display:column using the 'paramProperty' and 'paramid'

My code is ,

```
<display:table name="${weeklyDlvyInstancesDashboardReportForm.asnAccuracyListQO}" uid="asnAccuracyListUID" sort="list" defaultsort="1" 
                                        requestURI="/weeklyDlvyInstancesDashboardReportPre.do?method=httpGet" excludedParams="method"
                                        decorator="com.ford.mpl.superg.decorator.WeeklyDeliveryInstancesTypeTableDecorator" keepStatus="true">
    <%@include file="/jsp/include/displaytag.jsp"%>
    <c:set value="${asnAccuracyListUID.firstWeekOfCountLabel}" var="asnAccuracyFirstWeekOfCount"/>
    <c:set value="${asnAccuracyListUID.secondWeekOfCountLabel}" var="asnAccuracySecondWeekOfCount"/>
    <c:set value="${asnAccuracyListUID.thirdWeekOfCountLabel}" var="asnAccuracyThirdWeekOfCount"/>
    <c:set value="${asnAccuracyListUID.fourthWeekOfCountLabel}" var="asnAccuracyFourthWeekOfCount"/>
    <c:set value="${asnAccuracyListUID.fifthWeekOfCountLabel}" var="asnAccuracyFifthWeekOfCount"/>
    <c:set value="${asnAccuracyListUID.sixthWeekOfCountLabel}" var="asnAccuracySixthWeekOfCount"/>

    <c:if test="${(asnAccuracyListUID.instanceType != null && asnAccuracyListUID.instanceType != 'Sum')}">
        <display:column property="instanceTypeDescription" title="Instance Type" sortable="false"/>
    </c:if>
    <c:if test="${(asnAccuracyListUID.instanceType != null && asnAccuracyListUID.instanceType == 'Sum')}">
        <display:column property="instanceType" title="Instance Type" sortable="false" style="font-weight:bold;text-align:center"/>
    </c:if>
    <display:column property="firstWeekOfCount" title="${asnAccuracyFirstWeekOfCount}" href="${pageContext.request.contextPath }/weeklyDlvyInstancesDashboardReportPost.do?method=WeeklyDlvyInstExcelReport" paramProperty="instanceType,ratingElementId" paramId="instanceTypeForJSP,ratingElementIdForJSP" sortable="false" />
    <display:column property="secondWeekOfCount" title="${asnAccuracySecondWeekOfCount}" sortable="false"  />
    <display:column property="thirdWeekOfCount" title="${asnAccuracyThirdWeekOfCount}" sortable="false"  />
    <display:column property="fourthWeekOfCount" title="${asnAccuracyFourthWeekOfCount}" sortable="false" />
    <display:column property="fifthWeekOfCount" title="${asnAccuracyFifthWeekOfCount}" sortable="false" />
    <display:column property="sixthWeekOfCount" title="${asnAccuracySixthWeekOfCount}" sortable="false"/>
</display:table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T09:21:08.207

不要使用它，因为它只将第一行作为参数

```
 <display:table  cellpadding="2" name="dl" id="data" pagesize="500" requestURI="dataDisplayFormOne.htm" class="main_grid_table">
    <display:column property="facid" title="facid"  href="printUserForm20.htm?factid=${data.facid}&Licensenumber=${data.LICENSE_NO_FORM20}"  class="main_grid_column"/>
 </display:table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T14:37:15.510

```
<display:column property="firstWeekOfCount" title="${asnAccuracyFirstWeekOfCount}" href="${pageContext.request.contextPath }/weeklyDlvyInstancesDashboardReportPost.do?method=WeeklyDlvyInstExcelReport&ratingElementIdFromJSP=${asnAccuracyListUID.ratingElementId}" paramProperty="instanceType" paramId="instanceTypeFromJSP" sortable="false"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:21:33.807

您可以简单地自己生成链接：

```
<display:column>
    <c:url value="..." var="theUrl">
        <c:param name="..." value="..."/>
        <c:param name="..." value="..."/>
    </c:url>
    <a href="<c:out value="${theUrl"}/>">...</a>
</display:column> 
```

# javascript - How to add Facebook friends profile pictures to a HTML5 Canvas using JavaScript

> ID：12916903
> 
> 赞同：2
> 
> 时间：2012-10-16T14:25:23.630
> 
> 标签：javascript, html5-canvas

I am pretty new to HTML5 and was wondering how I would go about adding 10 random Facebook friends profile image's using JavaScript to an HTML5 Canvas, I have searched all over the net and have yet to find a solution that works, below is an example that I have been playing about with, I have created a Facebook App with the required permissions and can get a list of friends and their profile images I just can not figure out how to add them to the HTML5 Canvas.

```
<script>
  function loadImages(sources, callback) {
    var images = {};
    var loadedImages = 0;
    var numImages = 0;
    // get num of sources
    for(var src in sources) {
      numImages++;
    }
    for(var src in sources) {
      images[src] = new Image();
      images[src].onload = function() {
        if(++loadedImages >= numImages) {
          callback(images);
        }
      };
      images[src].src = sources[src];
    }
  }

  window.onload = function(images) {
    var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");

    var sources = {
      canvasbackground: "prof.jpg",
      userpic1: "https://graph.facebook.com/1645410740/picture",
      userpic2: "https://graph.facebook.com/100000557085310/picture"
    };

        loadImages(sources, function(images) {
        context.drawImage(images.canvasbackground, 0, 0, 422, 464);
        context.drawImage(images.userpic1, 33, 28, 70, 70);
        context.drawImage(images.userpic2, 130, 28, 70, 70);
    });
  };

</script> 
```

Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T18:46:18.600

所以，是的，首先我会将 numImages 更改为等于 sources.length，然后对于回调，执行

```
if( ! -- numImages ){ // once it gets down to 0, it's done, probably want to name it loadingImages
   //done 
} 
```

输入一些控制台日志，看看实际发生了什么。

# c++ - 为什么这个循环是无限的？

> ID：12916911
> 
> 赞同：0
> 
> 时间：2012-10-16T14:25:38.773
> 
> 标签：c++, vector, indexing, size-t

我有一些用于绘制多边形边的代码，例如，在顶点为 0、1 和 2 的三角形中，边为 (0, 1)、(1, 2) 和 (2, 0)。我以为我可以这样完成：

```
for(size_t j = 0, k = 1; j <= vertices.size()-1; j++, k++){
 if(j == vertices.size()-1){k = 0;} //For j to k final edge
...
//draw edges, etc. 
...
} 
```

...但这会使 k 值爆炸成无限循环。我已经看过了，并怀疑问题可能出在我的索引中，但是如果一切都取决于 j，我会认为可能是 vertices.size() 搞砸了。我在这段代码中遗漏了什么，还是应该更仔细地查看实际的顶点向量？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:32:15.590

你不需要计算 k ：

```
size_t const count = vertrices.size()
for(size_t j = 0; j < count; j++) {
  size_t k = (j + 1) % count;
  // draw
} 
```

这种方式`k`是`j+1`除了当 j 是最大值时，在这种情况下它是 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:31:27.337

如果您不确定`vertices`至少有一个条目，则减法`vertices.size()-1`可能会导致下溢（即减法中的值非常大`size_t(0)-1`），并且您的循环运行时间可能比您想要的长得多。

一个更惯用的解决方案是循环

```
for (size_t j = 0, k = 1; j < vertices.size(); j++, k++) {
 if ( j == vertices.size()-1) { //works, vertices has at least one entry
   k = 0;
 }
...
//draw edges, etc. 
...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T14:32:50.677

如果向量“顶点”为空，则循环将近似为无限。您在条件中使用无符号整数算术，因此 -1 将是 0xFFFFFFF 或更大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:33:29.543

如果您在此处提供的所有内容均正确，则不会是无限循环。所以最好的答案是仔细检查你的代码的其他部分。

# ios - 用于音频的 ALAssetLibrary

> ID：12916921
> 
> 赞同：0
> 
> 时间：2012-10-16T14:25:59.943
> 
> 标签：ios, ios5, alassetslibrary, alasset

我正在尝试通过这段代码使用 ALAssetLibrary 在我的应用程序中加载所有文件（音频、视频和图像）：

```
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
[library enumerateGroupsWithTypes:ALAssetsGroupAll usingBlock:^(ALAssetsGroup *group, BOOL *stop) {
    // Within the group enumeration block, filter to enumerate everything.
    [group setAssetsFilter:[ALAssetsFilter allAssets]];
    // Accessing all the assets.

    for (int i = 0;i<[group numberOfAssets] ; i++) {

    [group enumerateAssetsAtIndexes:[NSIndexSet indexSetWithIndex:i] options:0 usingBlock:^(ALAsset *alAsset, NSUInteger index, BOOL *innerStop) {
        // The end of the enumeration is signaled by asset == nil
        if (alAsset) {
            ALAssetRepresentation *representation = [alAsset defaultRepresentation];
            NSURL *url = [representation url];
            NSLog(@"%@",url);
            AVAsset *avAsset = [AVURLAsset URLAssetWithURL:url options:nil];

            //Doing some stuff with assets

                       }
    }]; 
    }
}
failureBlock: ^(NSError *error) {
   NSLog(@"No groups");
 }]; 
```

但是，这只会加载视频和图像，而不是音频文件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T04:26:35.123

关于[Apple.Developer ALAsset 文档](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAsset_Class/Reference/Reference.html)，一个**ALAsset**对象表示由 Photo 应用程序管理的**照片或视频。**

资产可以有多种表现形式，例如以 RAW 和 JPG 拍摄的照片。同一资产的不同表示可能具有不同的维度。

所以我认为，ALAssetsLibrary 不会检索您需要的内容:)

# eclipse - 如何测试 Eclipse Juno RCP 的 UI

> ID：12916923
> 
> 赞同：4
> 
> 时间：2012-10-16T14:26:02.083
> 
> 标签：eclipse, testing, frameworks, eclipse-juno

我们正在开发一个基于 Eclipse 的 RCP。最近我们更新到 Eclipse Juno，目前我们关注质量，这当然使自动化测试成为焦点，因为应用程序非常大并且测试工作延迟了发布。

我们已经在编写 JUnit 测试，但我对 UI 测试更感兴趣。对于较旧的 Eclipse，这不是问题。周围有很多很好的测试框架。不幸的是，由于增加了通过 Swing 或 JavaFX 切换默认 SWT UI 的能力，Juno 一切都发生了变化（至少这是我对导致问题的变化的理解）

所以大多数测试工具不再正常工作。从过去的经验看来：

*   **SWTBot**最近好像不太喜欢，而且很不稳定（某些版本找不到元素）
*   **Window Tester**看起来相当不错，但在测试运行期间识别元素有很多问题（尤其是内容辅助或工具提示等弹出窗口）
*   显然**Froglogics Squish**支持 Juno，但由于许可证费用约为 2,5k 欧元，我必须通过
*   **QF-Test**似乎也是如此（太贵了）。
*   这留下了我们过去尝试过的**Jubula （或 GUIDancer，即商业 Jubula），但它与 Window Tester 和 SWTBot 存在类似的问题（在 Eclipse 平台的更改和检测某些元素方面的困难方面不稳定）**

我需要知道，应该关注/信任哪个工具。是否有人对其中一种工具有经验，甚至目前正在测试 Juno RCP（或 Juno 本身）？或者有人知道 Eclipse 如何测试他们自己的平台（如果他们甚至在 atm 上测试）？

搜索与“test”、“Juno”和“UI/GUI”相关的信息，只会找到商业产品。

对我来说，重要的是找到一个工具，即使在未来的版本中，我也可以使用开发的测试用例，这意味着： 一个框架项目，它得到了社区的一些支持，以便能够快速适应。同样重要的是找到工具提示、覆盖或内容辅助/建议之类的东西 - 与基本的 HTMLUnit 相比，类似于 Selenium。

在这一点上，我什至不太关心集成、报告或遵守标准。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T20:44:24.530

您可以在 Eclipse Wiki 中找到 GUI 测试工具的综合表： [http ://wiki.eclipse.org/Automated_Testing#UI_tests](http://wiki.eclipse.org/Automated_Testing#UI_tests)

您必须做出的一个重要决定是，如果您想使用鼠标记录/创建测试（Jubula、QFTest，...），如果您希望能够手写测试代码（SWTBot，... )，或者如果您希望两者都可以（WindowTester Pro，...）。

Eclipse Juno 相当新，我预计所有列出的工具都会出现问题，但是迁移应该不会花那么长时间，因为这些工具中的大多数主要集中在测试 SWT-widgets 并且 Juno 仍然使用 SWT。到目前为止，除了技术演示之外，我还没有收到任何认真使用 JavaFX 的 RCP 应用程序的消息，但我很想看到它们！

我认为问题在于测试 Eclipse 很困难，而 GUI 测试尤其困难。您可能想看看这项发现并解释主要问题的研究： http: [//swerl.tudelft.nl/twiki/pub/Main/TechnicalReports/TUD-SERG-2011-010.pdf](http://swerl.tudelft.nl/twiki/pub/Main/TechnicalReports/TUD-SERG-2011-010.pdf)

如果您相信这项研究，那么 JUnit 测试通常比 GUI 测试更可取。好吧，有了 Juno，您就有了一个很大的优势，即现在对 Eclipse 进行单元测试比以往任何时候都更容易，因为框架从继承和单例切换到依赖注入，这使得它更易于测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T11:24:16.803

我建议你也看看[Xored 的 Q7](http://www.xored.com/products/q7/)，它用于对一些 Eclipse 项目进行 GUI 测试，包括 Eclipse DLTK、Eclipse LDT、Eclipse Tigerstripe，而且这个工具非常完美：它让你每天可以为每个工程师开发数十个 UI 测试，并且没有稳定性和错误录制的问题。它是专门设计的，仅用于测试基于 Eclipse 的应用程序，并且显然是该领域中最好的。

但是它需要花钱，这对你来说可能是一个障碍（比如 squish），但是他们有一个免费的社区版本，这对于大多数用例来说已经足够了。以及那些 Xored 人刚刚介绍了按测试执行付费的定价模型——这些工具将是免费的，您只需按每月执行的测试付费（少于 5000 个是免费的）。更多关于新模型的信息在这里[eclipse-testing.com](http://www.eclipse-testing.com)

# php - 为什么 PHP 的 urlencode 使用不同的 URL 编码？

> ID：12916925
> 
> 赞同：4
> 
> 时间：2012-10-16T14:26:04.453
> 
> 标签：php, unicode, typo3, urlencode

η 的 URL 编码是`%CE%B7`。但是在 PHP 中，我在编写时会得到一些奇怪的符号`echo urldecode("%ce%b7");`

相反，如果我写，`echo urlencode("η");`那么我得到`%26%23951%3B`. 为什么我不能使用`%CE%B7`？

**解决方案**

问题是我们使用了typo3。它有些如何不使用 unicode 进行内部处理。一旦我们设置`$TYPO3_CONF_VARS['BE']['forceCharset'] = 'utf-8';`了typo3，输出`echo urldecode("%ce%b7");`就是正确的。

为什么`echo urlencode("η");`给我`%26%23951%3B`看 Joni 的答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T14:33:36.747

`urldecode("%ce%b7")`*产生以 UTF-8 编码的*η 。如果您正在使用其他编码查看输出，您可能会看到其他内容。

另一方面，当您解码`%26%23951%3B`时，您确实没有获得 η；您获得`&#951;`了 η 的 HTML 实体代码。要解码实体代码，请使用`html_entity_decode`：

```
echo html_entity_decode('&#951;', false, 'UTF-8'); // prints η, encoded in UTF-8 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:28:01.570

您可以尝试以下方法

```
header('Content-Type: text/html; charset=utf-8');
echo urldecode("%ce%b7"); // output : η 
```

[观看现场演示](http://codepad.org/lgSmIjRV)

# objective-c - 在另一个类中的 UIButton Action 中调用方法

> ID：12916928
> 
> 赞同：0
> 
> 时间：2012-10-16T14:26:20.367
> 
> 标签：objective-c, ios, uibutton

我有一个班级`UIViewController`，里面有一个按钮，我想从另一个班级调用一个方法，请你帮我实现按钮的动作

我是objective-c的新手

我的按钮操作`UIViewController`：

```
- (IBAction)ActionButton:(id)sender {
NSLog(@"A1");

} 
```

我在`WebViewControlle`r 中的方法：

```
 -(void)loadWebView{

    NSURL *url = [NSURL fileURLWithPath:[ [ NSBundle mainBundle ] pathForResource:  
    @"TestName/TestName1/Test1Name1" ofType:@"html" ]];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [webView loadRequest:request];

   } 
```

我的问题是如何将此方法调用到我的按钮，因为它在另一个视图中？我有一种方法，`WebViewController`我想从我拥有的一个按钮中调用它`UIViewController`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:36:38.937

你可以试试这个：

假设您有一个`ViewA`实现该方法的类。

如果您希望按钮操作调用该方法，您需要有另一个类的实例。

```
-(void)loadWebView{

NSURL *url = [NSURL fileURLWithPath:[ [ NSBundle mainBundle ] pathForResource:  
@"TestName/TestName1/Test1Name1" ofType:@"html" ]];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[webView loadRequest:request];

} 
```

为您按钮查看：

```
#import "ViewA.h"

ViewA *instanceOfViewA;
// assign an instance to instanceOfViewA 
```

你的按钮方法：

```
- (IBAction)ActionButton:(id)sender {
NSLog(@"A1");
    [yourButton addTarget:instanceOfViewA
                  action:@selector(loadWebView)
        forControlEvents:UIControlEventTouchUpInside];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:29:51.507

您可以在主视图控制器中存储对 WebViewController 的引用并向该引用发送消息，检查我的[答案](https://stackoverflow.com/questions/12910702/accessing-ibooutlet-uibutton-of-different-class-ios/12910804#12910804)。

代码：

在`MyViewController.h`：

```
@class WebViewController;
...
@interface MyViewController
{
    ...
}
@property (nonatomic, retain) IBOutlet WebViewController* webViewController;
... 
```

在`MyViewController.m`：

```
#import "WebViewController.h"
...
@implementation MyViewConroller
@synthesize webViewController;

...
- (void) dealloc {
    ...
    self.webViewController = nil;
    ...
    [super dealloc];
} 
```

在 IB 中分配您的 WebViewController（就像您对按钮和其他东西所做的那样），然后在代码中：

```
- (IBAction)ActionButton:(id)sender {
    NSLog(@"A1");
    [self.webViewController loadWebView];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:31:34.387

您可以在 UIViewController 中使用通知或委托或引用 WebViewController ..

# c# - 刷新一个gridview数据

> ID：12916930
> 
> 赞同：2
> 
> 时间：2012-10-16T14:26:28.477
> 
> 标签：c#, winforms, visual-studio-2010

我正在使用 c# 开发一个 Windows 窗体应用程序。我在 Visual Studio 2010 中使用 grdiview 智能标签将 SQL 数据表中的数据填充到 gridview 中。当我使用 SQL 插入向表中添加新数据时，gridview 中的数据保持不变，除非我关闭应用程序。我想编写一个 REFRESH 按钮，单击它应该再次填充 gridview，然后它将获取所有数据，包括新插入的数据。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:40:35.077

datagridview 的数据源保持绑定，所以刷新它设置为 null 然后再次绑定其他数据，我希望我已经正确理解了你的问题！

```
 dataGridView1.DataSource = null;
    dataGridView1.DataSource = ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:41:13.600

强制重新绑定的快速方法

```
dataGridView.DataSource = null
dataGridView.DataSource = (DataTable) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:47:27.400

如果您使用助手连接到数据库，它将生成类似于以下的代码：

```
private void Form1_Load(object sender, EventArgs e)
{
  // TODO: This line of code loads data into the 'YourDatabase_ProductionDataSet.Product' table. You can move, or remove it, as needed.
  this.productTableAdapter.Fill(this.YourDatabase_ProductionDataSet.Product);
} 
```

您可以使用同一行来更新数据库，如下所示：

```
private void button1_Click(object sender, EventArgs e)
{
  this.productTableAdapter.Fill(this.YourDatabase_ProductionDataSet.Product);
} 
```

# ruby-on-rails - 循环遍历复选框数组列表以在控制器中的 rails 3.1 上的 ruby 中插入多条记录

> ID：12916934
> 
> 赞同：0
> 
> 时间：2012-10-16T14:26:36.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, checkbox

`check_box_tag`我有一个用( `<%= check_box_tag "user_ids[]", user.id %>`)创建的复选框列表。现在我想遍历控制器中基于 users_ids 的所有复选框并插入所有选定用户的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:52:39.530

正如 Meltemi 所说，在 ruby​​ 中迭代的常用方法是`.each`. 在您的情况下，在接收表单的控制器中可能是这样的：

```
params[:user_ids].each do |user_id|
  u = User.find(user_id)
  u.do_something_to_that_user  #call a method or some such on the user
  something_else.users << u    #associate that user with something else
end 
```

或者，一次完成所有这些通常会更有效，尽管其确切形式取决于您对用户所做的事情。例如，如果您想将选中的用户与某些记录相关联：

```
Record.user_ids = params[:user_ids] 
```

或者，如果您想以某种方式更新所有这些用户：

```
User.where(:id => params[:user_id]).update_all(:attribute => some_value) 
```

# ios - ios内存泄漏搜索

> ID：12916939
> 
> 赞同：1
> 
> 时间：2012-10-16T14:26:48.780
> 
> 标签：ios, memory-leaks

我在一个包含几个小游戏的应用程序上工作。这些迷你游戏之一显然会泄漏内存。反过来，这个迷你游戏不是那个“迷你”。它包括十几个来源。坦率地说，他们很糟糕。

如何找到内存泄漏？我的想法是在小游戏开始时设置一些“开始狩猎”标记，并输出自标记设置以来分配的所有对象，并且在小游戏结束时未释放。iOS 调试工具允许吗？

# c# - 为国家、语言组合创建自定义 CultureInfo

> ID：12916940
> 
> 赞同：12
> 
> 时间：2012-10-16T14:26:49.680
> 
> 标签：c#, .net, cultureinfo, culture, currentuiculture

我正在开发一个 .net 4.5 应用程序，该应用程序需要多语言支持多文化等。

以下是国家/语言的示例列表

*   俄罗斯 / 俄语
*   比利时 / 法国
*   比利时/荷兰

对于上述所有内容，可以根据上述文化名称创建一个 CultureInfo 对象

*   RU-RU
*   FR-BE
*   nl-BE

当用户进入站点时，我将 Thread.CurrentThread.CurrentCulture 和 Thread.CurrentThread.CurrentUICulture 设置为使用上述名称创建的文化，例如。

```
Thread.CurrentThread.CurrentCulture = new CultureInfo("nl-BE", false)
Thread.CurrentThread.CurrentUICulture = new CultureInfo("nl-BE", false) 
```

以上所有名称都是有效的文化名称。

不，但是我需要添加另一个文化名称，即俄罗斯的英语语言。但问题是代码 en-RU 无效，所以当我创建时，`new CultureInfo("en-RU", false)`我得到一个 CultureNotFoundException，因为 en-RU 无效。

有了这种文化，我想要俄罗斯的数字、日期等格式，但我希望网站上的语言是英语。是否可以根据国家（俄罗斯）的行为为无效的文化名称创建自定义 CultureInfo 对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T14:33:38.977

> 是否可以为无效的文化名称创建自定义 CultureInfo 对象

是的。

利用[`CultureAndRegionInfoBuilder`](http://msdn.microsoft.com/en-us/library/system.globalization.cultureandregioninfobuilder.aspx)帮助创建自定义`CultureInfo`. （注意。一旦您有了创建文化的代码，可以将执行此操作的设置保存到 XML，然后从资源中加载，例如，从资源中加载，这在运行时需要更少的代码。）

[可以在 CodeProject 中找到](https://www.codeproject.com/Articles/66277/Creating-Extending-a-Culture)如何执行此操作的示例项目以及可下载的代码。这篇文章的一个重要说明是，即使这个类位于`System.Globalization`命名空间中，默认情况下它也不可用，引用：

> 我们将从引用程序集开始`sysglobl.dll`并为命名空间添加一条`using`语句`System.Globalization`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T14:30:40.037

您可能必须混合和混合和匹配 - 有一个用于英语文本的文化对象，但有一个用于数字格式的 ru-Ru（俄语）文化对象。

或者更好地创造一种将两者结合起来的定制文化

[在 ASP.NET 中创建自定义文化](https://stackoverflow.com/questions/1304507/create-custom-culture-in-asp-net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:32:33.260

你应该使用`CultureInfo.InvariantCulture`属性

> 不变的文化是文化不敏感的；它与英语相关，但与任何国家/地区无关。您可以在对 CultureInfo 实例化方法的调用中使用空字符串 ("") 按名称指定不变区域性。CultureInfo.InvariantCulture 还检索不变区域性的一个实例。它几乎可以用在 System.Globalization 命名空间中需要文化的任何方法中。CompareInfo、DateTimeFormat 和 NumberFormat 等属性返回的对象也反映了字符串比较和不变区域性的格式约定。

[CultureInfo.InvariantCulture 属性](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.invariantculture.aspx)

这是另一个选项[自定义全球应用程序文化](http://www.codeproject.com/Articles/19762/Custom-Global-Application-Culture)

# jquery - 我试图通过单击按钮从手风琴菜单中删除一个项目。我究竟做错了什么？

> ID：12916941
> 
> 赞同：1
> 
> 时间：2012-10-16T14:26:50.820
> 
> 标签：jquery, html, jquery-mobile

当我单击红色方块时，我希望整个 div 消失。不仅仅是现在正在发生的方块。这是我的 JS

```
$('document').ready(function(){

  $('.theListItem .red').click(function(){
  var $toRemove = $(this).parent('div').prev('h3');
      $toRemove = $toRemove.add($(this).parent('div'));

  $toRemove.animate({height:0}, 500, function(){
    // This is the callback.
    $toRemove.remove();
  });

  return false;
});
}); 
```

这是一些html

```
div class = "theListItem" data-role="collapsible-set" data-collapsed="false">

    <div data-role="collapsible" data-collapsed="false" data-theme="a">
    <h3>Keep Working!</h3>
<div data-role="controlgroup"  data-type="horizontal">
<a class= "green" href="categorize.html" data-transition="slide" data-role="button">Yes</a>
<a class="red" href="#" data-role="button">No</a>
<a class="blue" href="index.html" data-role="button">Maybe</a>
</div>
    </div>

    <div data-role="collapsible" data-collapsed="false" data-theme="a">
    <h3>Section 1</h3>
<div data-role="controlgroup"  data-type="horizontal">
<a href="categorize.html" data-role="button">Yes</a>
<a href="index.html" data-role="button">No</a>
<a href="index.html" data-role="button">Maybe</a>
</div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:39:30.417

你可以使用`closest`方法。

```
$('document').ready(function() {
    $('.theListItem .red').click(function() {
        var $toRemove = $(this).closest('div[data-theme="a"]')

        $toRemove.animate({
            height: 0
        }, 500, function() {
            // This is the callback.
            $toRemove.remove();
        });

        return false;
    });
}); 
```

[http://jsfiddle.net/C5aDA/](http://jsfiddle.net/C5aDA/)

# popcornjs - 使用 Mozilla Popcorn 和 sequence.js 加载备用视频源

> ID：12916943
> 
> 赞同：1
> 
> 时间：2012-10-16T14:26:55.910
> 
> 标签：popcornjs

通常使用 html5 视频，您可以指定替代格式，以便浏览器找到它满意的格式：

```
<video height="180" width="300" id="ourvideo">
  <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.mp4">
  <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.ogv">
  <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.webm">
</video> 
```

使用 sequence.js，我可以找到的所有演示只为序列中的每个剪辑指定一种格式：

[http://jsfiddle.net/jmTgD/1/](http://jsfiddle.net/jmTgD/1/)

[http://scotland.proximity.on.ca/cadecairos/sequence/issue11/test/functional-plugin.html](http://scotland.proximity.on.ca/cadecairos/sequence/issue11/test/functional-plugin.html)

本质上：

```
var sequence = Popcorn.sequence(
                "container-id",
                [
                    {
                        src: "http://videos.mozilla.org/serv/webmademovies/atultroll.webm",
                        in: 0,
                        out: 3
                    },
                    {
                        src: "http://videos.mozilla.org/serv/webmademovies/justintime.ogv",
                        in: 174,
                        out: 180
                    },
                    {
                        src: "http://videos.mozilla.org/serv/webmademovies/popcornplug.ogv",
                        in: 0,
                        out: 6
                    }
                ]); 
```

谁能告诉我是否可以使用 sequence.js 提供替代源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T20:45:15.413

看起来 Popcorn.sequence 不会处理多个来源，但有一些方法可以解决这个问题。

一种选择是用于`canPlayType`检测浏览器可以播放的格式，然后相应地设置源。像这样的东西：

```
var ext = 'ogv', i, vid,
    formats = {
        'mp4': 'mp4',
        'webm': 'webm',
        'ogg': 'ogv'
    },
    files = ['atultroll', 'justintime', 'popcornplug'];

var vid = document.createElement('video');
for (i in formats) {
    if (vid.canPlayType(i)) {
        ext = formats[i];
        break;
    }
}
for (i = 0; i < files.length; i++) {
    files[i] += ext;
} 
```

理论上，`canPlayType`它不是 100% 准确的，因为实际视频编码中存在浏览器可能不支持的变化，但这在实践中通常不是问题。

另一种选择是使用[Popcorn Splice Player](https://github.com/brianchirls/popcorn-splice)。Popcorn 1.4（尚未发布，但在 master 分支中）允许在模仿 HTML 媒体元素的对象中封装非本地播放器（例如 YouTube、Vimeo）的模块。Splice Player 就是这样一个模块，它将组合多个媒体源并将它们作为一个视频播放。它将支持多个来源。

```
var player = Popcorn.SplicePlayer('#container');
player.src = [
    {
        src: [ "atultroll.mp4", "atultroll.webm", "atultroll.ogv" ],
        from: 0,
        to: 3
    },
    {
        src: [ "justintime.mp4", "justintime.webm", "justintime.ogv" ],
        from: 174,
        to: 180
    },
    {
        src: [ "popcornplug.mp4", "popcornplug.webm", "popcornplug.ogv" ]",
        from: 0,
        to: 6
    }
]; 
```

# php - HTML 谢谢您的电子邮件未发送

> ID：12916945
> 
> 赞同：2
> 
> 时间：2012-10-16T14:27:09.213
> 
> 标签：php, html, email

我正在尝试设置在用户提交表单时发送的基本电子邮件（他们输入详细信息，包括电子邮件地址，然后将感谢电子邮件发送到该电子邮件地址）。我在一个页面上工作，但是，当尝试在另一个页面上实现它时，我似乎无法获取他们输入的用户电子邮件地址。我已经习惯了非常基本的 PHP，而且我似乎无法让它工作的页面比我习惯的要复杂得多。

在我看来，我应该告诉要发送到 $uEmail 的电子邮件，但是当我这样做时，不会发送任何电子邮件。这个确切的代码适用于另一个更基本的 PHP 页面，但我需要让它工作的页面是由比我更有经验的人创建的。

我真的很感激在这件事上的帮助。

```
 <form method="post" action="<?php echo $this->url('/clients/register', 'do_register')?>" class="clearfix">

        <?php  if ($displayUserName) { ?>
            <div>
            <?php echo $form->label('uName', t('Username') )?>
            <?php echo $form->text('uName')?>
            </div>
            <br/>
        <?php  } ?>

        <div>
          <div>
            <?php echo $form->label('uEmail', t('Email Address') )?>
            <span class="ccm-required">*</span>
          </div>
          <?php echo $form->text('uEmail')?>
        </div>
        <br/>

        <?php

        $attribs = UserAttributeKey::getRegistrationList();

        //UserAttributeKey::getRegistrationList();

        $af = Loader::helper('form/attribute');

        foreach($attribs as $ak) {
 //                $ak = UserAttributeKey::getByHandle($akHandle);
            print $af->display($ak, $ak->isAttributeKeyRequiredOnRegister());
 //                print '<br/><br/>';
        }

        if (ENABLE_REGISTRATION_CAPTCHA) {
            print $form->label('captcha', t('Please type the letters and numbers shown in the image.'));
            //print '<br/>';
            $captcha = Loader::helper('validation/captcha');
            $captcha->display();
            ?>

            <div><?php  $captcha->showInput();?> </div>
        <?php  } ?>

        <br/>

       <!-- checkbox code -->

      <!-- end checkbox code -->

     <input type="hidden" name="sendCopy" id="sendCopy" value="true"<?php if(isset($_POST['sendCopy']) && $_POST['sendCopy'] == true) echo ' checked="checked"'; ?> />

        <div class="ccm-button">
            <?php echo $form->submit('register', t('Register'))?>
            <?php echo $form->hidden('rcID', $rcID); ?>
        </div>

    </form>
    <?php  } ?>

   <?php 
   if (mysql_affected_rows()) {

   // NEW TEMP CODE
   //if (isset($error) && $error != '') { 
   //if (isset($_POST['register'])) {

    $emailTo = 'allen.hughes@hotmail.com';
    $subject='Application form submission from test.com';
    $sendCopy = trim($_POST['sendCopy']);
    $body = "Email: Hello! Thanks for applying...test***";
        $headers = 'From: Allen hughes ' . 'Reply-To: ' . $email;

    mail($uEmail, $emailTo, $subject, $body);

    if($sendCopy == true) {
        $subject = 'You applied to Allenhughes.com';
    mail($uEmail, $subject, $body);
    }
    $emailSent = true; 
   }
   else { 

  echo "Confirmation email has not been sent as email address has not been specified";

   }

   ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:13:43.520

90% 的时间这个错误是由你的服务器的一些配置错误引起的。

检查您的电子邮件日志是否有任何错误

还要检查什么邮件功能返回

```
if (mail()) {
  echo 'succesful';
} 
```

# orbeon - 无法在 Orbeon 4 M11 中获得授权服务 (orbeon-auth)

> ID：12916946
> 
> 赞同：3
> 
> 时间：2012-10-16T14:27:12.400
> 
> 标签：orbeon

Orbeon/Tomcat 新手在这里 - 希望我只是错过了一些明显的东西......

我在 Orbeon 4 M11 上，想试用捆绑的 orbeon-auth 作为授权服务，如下所述：[http ://wiki.orbeon.com/forms/doc/developer-guide/page-flow-controller /授权](http://wiki.orbeon.com/forms/doc/developer-guide/page-flow-controller/authorization)。

最初我什至无法让 orbeon-auth 工作，但现在我已经做到了，如果我访问`http://localhost:8080/orbeon-auth`它会提示进行身份验证，如果我输入正确的凭据，它将返回 http 200。现在我需要配置我的页面以使用 orbeon-auth。根据上面链接中的说明，我需要设置此属性：

```
<property as="xs:anyURI" processor-name="oxf:page-flow" name="authorizer" value="/orbeon-auth"/> 
```

但我不确定将代码放在哪里。我认为它可能会出现在标签内的 page-flow.xml 中`<controller>`，但是当我把它放在那里并尝试访问一个页面时，我得到了“Orbeon Forms - An Error Has Occurred”错误页面。我也尝试将它放在 properties-local.xml 中，但没有做任何事情。希望有人能指出我正确的方向......

这是我的 properties-local.xml 的全部内容：

```
<!--
    This file is an empty template for your own properties-local.xml file. Please follow the instructions here:

    http://wiki.orbeon.com/forms/doc/developer-guide/configuration-properties
-->
<properties xmlns:xs="http://www.w3.org/2001/XMLSchema"
            xmlns:oxf="http://www.orbeon.com/oxf/processors">

    <!-- This is an example of property which overrides an existing property's default value:
    <property as="xs:NMTOKENS"
              name="oxf.xforms.logging.debug"
              value="document model submission submission-details control event action analysis server html"/>
    -->
    <property as="xs:string" name="oxf.fr.persistence.provider.Test.*.*" value="oracle"/>
    <property as="xs:string" name="oxf.fr.persistence.provider.FieldReports.*.*" value="oracle"/>

    <property as="xs:string" name="oxf.fr.persistence.service.oracle.datasource" value="oracle"/>

    <property as="xs:boolean" name="oxf.fr.persistence.oracle.create-flat-view" value="true"/>

    <property as="xs:string"  name="oxf.fr.summary.buttons.*.*" value="new print delete"/>

    <property as="xs:string" name="oxf.fr.detail.buttons.*.*" value="close clear print save save-locally submit workflow-review workflow-send"/>

    <property as="xs:boolean" name="oxf.fr.detail.edit.accept-post.*.*" value="true"/>

    <property as="xs:anyURI" name="oxf.fr.default-logo.uri.*.*"
                         value="/usr/local/tomcat/webapps/orbeon4pe/WEB-INF/resources/wb-logo.png"/>
    <property
        as="xs:anyURI"
        processor-name="oxf:page-flow"
        name="authorizer"
        value="/orbeon-auth"/>
</properties> 
```

我没有更改`/WEB-INF/resources/page-flow.xml`orbeon-auth`/WEB_INF/web.xml`文件 - 它们是开箱即用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T14:45:06.550

我对这个功能应该如何运作感到困惑。我通过将以下内容添加到 /WEB-INF/config/properties-local.xml 来覆盖默认页面公共方法（GET 和 HEAD）：

```
<property
  as="xs:string"
  processor-name="oxf:page-flow"
  name="page-public-methods"
  value="HEAD"/> 
```

...并且外部 GET 请求确实首先导致了对 orbeon-auth 的调用（没有提示进行身份验证，不确定这是否是预期的行为 - orbeon-auth 只返回 401/未授权，然后立即返回 403/禁止，没有提示） .

# php - 带有分块 CSV 附件的 PHP 邮件导致双换行错误

> ID：12916947
> 
> 赞同：1
> 
> 时间：2012-10-16T14:27:17.073
> 
> 标签：php, email, csv, chunked-encoding

我尝试使用 PHP 邮件发送 CSV 文件。这是导致双换行错误的版本（从服务器错误日志中获得）：

```
$content = base64_encode($content);
$uid = md5(uniqid(time()));
$header = "From: ".$from_name." <".$from_mail.">\r\n";
$header .= "Reply-To: ".$replyto."\r\n";
$header .= "Content-type:text/plain; charset=utf-8\r\n";
$header .= "Content-Transfer-Encoding: 7bit\r\n";
$header .= $message."\r\n";
$header .= "--".$uid."\r\n";
$header .= "Content-Type: application/octet-stream; name=\"".$filename."\"\r\n"; // use different content types here
$header .= "Content-Transfer-Encoding: base64\r\n";
$header .= "Content-Disposition: attachment; filename=\"".$filename."\"\r\n";
$header .= $content."\r\n";
$header .= "--".$uid."--";
if (!mail($mailto, $subject, "", $header)) {
    echo "mail send ... ERROR!";
} 
```

而当我删除“chunk_split”时，它不会导致错误，但收件人邮件服务器不接受它（即它既不会出现在收件箱中，也不会出现在垃圾邮件中）。

注意：“双换行错误”代码用于以前的主机，但无法在新主机上运行。

# ios - ios：更改 window.rootViewController 和内存管理

> ID：12916948
> 
> 赞同：0
> 
> 时间：2012-10-16T14:27:19.597
> 
> 标签：ios, memory-management, uiviewcontroller, uiviewanimationtransition, appdelegate

我面临以下问题：我的应用程序有两个主控制器 (a)loginController 和 (b) contentController，当应用程序启动时，我检查用户是否已登录，如果是，则显示 contentController，否则显示登录控制器。所以基本上在 didFinishLaunchingWithOptions 中，我将此控制器之一分配给 window.rootViewController。问题是当我想从一个控制器切换到另一个控制器时（因为用户进行了登录或注销）来完成此操作，我使用以下代码：

```
[UIView transitionWithView:self.window
                  duration:0.65
                   options:UIViewAnimationOptionTransitionFlipFromLeft
                animations:^{
                    self.window.rootViewController = self.contentController;
                }
                completion:^(BOOL finished){
                    [self.loginController release];
                }]; 
```

在此转换 window.rootViewController 为 loginController 之前，这里的问题是执行此代码时收到以下错误：

```
-[loginController _preferredInterfaceOrientationGivenCurrentOrientation:]: message sent to deallocated instance 0x1c55b490 
```

我想了解如何在不出现此错误的情况下释放我的控制器。如果有人能建议我在运行时更改 window.rootViewController 的最佳方法是什么，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:19:38.090

如果没有看到更多代码，就不可能确定您遇到内存管理问题的原因。但我想提供一个不同的答案。让您的内容控制器始终成为窗口的根控制器。如果您需要显示登录屏幕，请将其显示为内容控制器上的模式视图控制器。这将比切换根视图控制器容易得多。您可以在启动时不显示动画，因此用户永远不会看到它的过渡。登录后，您可以取消任何显示其下方内容控制器的方法。如果用户注销，您可以再次显示登录控制器，作为内容控制器上的模式控制器。

# javascript - 额外回报有什么好处？

> ID：12916950
> 
> 赞同：0
> 
> 时间：2012-10-16T14:27:26.497
> 
> 标签：javascript

取自 JavaScript Ninja，我看到：

```
function bind(context, name) {
    return function() {
        return context[name].apply(context, arguments);
    };
} 
```

上面的代码和有什么区别？

```
function bind(context, name) {
    return context[name].apply(context, arguments);
} 
```

我很困惑为什么需要额外的回报？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:29:14.587

第一个返回一个函数。

第二个返回调用结果`context[name]`

它允许您在保持上下文的同时在某处传递一个函数（以便以后可以调用它）（因此需要的*值*）`this`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:28:55.113

除了他们完全不同的事实之外？一个返回一个包含函数调用的闭包，另一个调用该函数并返回其返回值。

# php - PHP 文件从客户端通过服务器流式传输到客户端

> ID：12916956
> 
> 赞同：2
> 
> 时间：2012-10-16T14:27:40.900
> 
> 标签：php, file-upload, streaming, download

### 问题

是否可以通过 PHP 流式传输上传文件，以便其他客户端可以在第一个客户端上传时下载它？

我不想将文件永久保存在服务器上。我怎样才能做到这一点？

### 为什么选择 PHP？

下载客户端不需要额外的软件来获取流。我认为最简单的方法是网络浏览器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:32:49.460

这是可能的，但实施起来会相当尴尬。主要障碍是多部分 POST 请求的处理被硬编码到 PHP 中。在调用您的脚本之前，它将始终将文件保存到临时位置。一种解决方法是将 PHP-CLI 设置为 CGI 脚本。由于 PHP 的 CLI 版本不支持 HTTP，因此它可以让您掌握传入的数据。

.CGI 文件将如下所示：

```
#!/usr/local/src/php-4.3.4/sapi/cli/php
<?php

// populate $_GET
parse_str($_ENV['QUERY_STRING'], $_GET);

// get the session id from the cookie
parse_str($_ENV['HTTP_COOKIE'], $_COOKIE);
$session_name = ini_get("session.name");
$session_id = $_COOKIE[$session_name];

// get the length of the request body
$length = (int) $_ENV['CONTENT_LENGTH'];

// read the POST data
$stdin = fopen("php://stdin", "rb");

while($chunk = fread($stdin, 4096)) {
    [...]
}

?> 
```

解析 RFC1867 请求并非易事。我想，协调上传方和下载方也会相当棘手。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:41:24.187

看来你不能直接。在文件完成上传之前，您的 PHP 脚本不会执行。使用 APC，您似乎可以获得上传文件的进度，但不能获得实际字节本身。唯一的另一种方法是在 PHP 中使用套接字编写您自己的服务器，等等。

作为替代方案，如果你有 Node.js（或者其他任何东西，真的），你可以这样做：

1.  客户端 A 连接并开始上传
2.  服务器开始将上传写入磁盘
3.  客户端 B 连接，请求下载客户端 A 的数据
4.  服务器从磁盘读取缓冲数据并发送给客户端 A
5.  服务器在数据可用时继续发送，直到客户端 A 或 B 断开连接

磁盘缓冲区选项是最简单的，但对于大文件或实时流，如果客户端 B 能够跟上，或者如果数据丢失不没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-23T22:08:29.390

您应该研究 tus 协议 - 有一个支持它的 php 库 ( [https://github.com/ankitpokhrel/tus-php](https://github.com/ankitpokhrel/tus-php) ) 以及 Javascript 框架，包括客户端的 uppy (uppy.io)。

# sql-server - 针对全文索引的混合查询

> ID：12916958
> 
> 赞同：4
> 
> 时间：2012-10-16T14:27:44.707
> 
> 标签：sql-server, full-text-search, sql-server-2012, full-text-indexing

我正在使用 SQL Server 2012。一个表有一个文本和一个日期列。文本列具有全文索引。查询针对全文列发出 CONTAINS，但它还需要在日期列中包含大于条件。我担心 SQL Server 合并来自 b 树和全文索引的结果的性能。

在 Oracle 中，通过将“正常”列（不受全文搜索）包含到全文索引 (CTXCAT) 中来解决此方案的性能方面，因此可以设置全文索引，如那：

```
ctx_ddl.create_index_set('auction_set');
ctx_ddl.add_index       ('auction_set', 'start_date'); 
```

然后像这样查询：

```
WHERE CATSEARCH (item_desc, '(toy dog) | "live animal"', 'start_date > ###') > 0 
```

是否可以在 SQL Server 中将 b-tree 索引组合成全文索引？

解决 SQL Server 中混合（全文和 b 树）查询场景的最高效方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:24:32.317

如果我正确理解您的问题，我认为您不会遇到任何问题。我经常将全文和 b-tree 结合起来，效果很好。当进行全文搜索时，它会将每个分隔的“术语”视为一个索引，就像它只具有一个术语的索引列一样（提供或获取一些 sql 统计信息）。无论哪种方式，SQL 都必须弄清楚它的执行路径。全文搜索不支持比较整数/日期值——更多的是用于匹配分隔数据的字符串。

我想你会想继续利用 b-tree 概念的效率来发挥你的优势。全文目录索引搜索在我看来是一个更全面的搜索，尽管在使用“LIKE”来解析/比较字符串的情况下更有利。

我要做的是：

```
 SELECT * FROM MyTable
  WHERE CONTAINS(columnName, '"Toy Dog" OR "live animal"')
    AND start_date > ###; 
```

（[有关语法信息，请参阅此 msdn 文章](http://msdn.microsoft.com/en-us/library/ms142571.aspx)）

PS 当全文索引整数数据时，关闭停止列表，以便在目录索引中不会忽略这些值。

希望任何帮助！（没有人回答，所以我想我会给出我的经验）

# mysql - 将 MySQL 数据库复制到另一台机器

> ID：12916959
> 
> 赞同：3
> 
> 时间：2012-10-16T14:27:48.873
> 
> 标签：mysql, copy

我在 mt Windows 计算机上有一个 MySQL 数据库。我需要获取一个数据库并将其复制到另一台机器上。另一台机器也运行 Windows 并具有 MySQL 数据库。两台机器无法通过互联网连接。我该怎么办？如何通过USB卡完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:36:23.117

`USB card`在 sql 文件中创建导出 DB Mysqldump并将sql 文件复制`import`到另一台机器。按照它可以帮助您实现它的步骤

`mysql dump` 供参考，请[参见此处](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)的 示例：

```
mysqldump -u admin -p passwd DB_Name > file/path/filename.sql 
```

`import``sql`文件到`mysql DB` as

样本 ：

```
 mysql > use DB_Name;
  mysql >source yourfile.sql 
```

（或者）

```
 mysql -u USERNAME -p PASSWORD DATABASE-NAME < file/path/filename.sql 
```

如果错了请纠正我

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:34:31.450

将数据库转储为 SQL 文件的最佳方式。然后在另一台机器上导入。

```
mysqldump -uuser -i uutfile.sql -p db_name 
mysql -uuser -p < uutfile.sql 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:30:20.397

取当前数据库的备份（sql dump），在另一台机器上执行备份。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T14:30:55.153

1.  导出数据：

    mysqldump db_name > 备份文件.sql

2.  使用棍子

3.  导入数据：

    mysql -u 用户名 -p 数据库 < 备份文件.sql

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T16:56:41.413

[MySQL Workbench](http://dev.mysql.com/downloads/workbench/)包有一个内置的备份和恢复过程。数据库备份实际上只是一个长 SQL 文件，可以将其重新播放到另一个数据库中以复制您的原始数据。它甚至可以安排备份。

还有一个命令行工具`mysqldump`可以做同样的事情，但不那么容易使用。如果你经常这样做，你会想要编写脚本，这样你就不需要记住特定的命令行选项：

```
 mysqldump --single-transaction --quick --user=... --password=... database | gzip -9 > backup.sql.gz
 gunzip -dc backup.sql.gz | mysql --user=... --password=... 
```

# vba - If 或语句始终为真

> ID：12916961
> 
> 赞同：1
> 
> 时间：2012-10-16T14:27:54.330
> 
> 标签：vba, excel

**摘要：**我有一个包含一堆不必要列的电子表格。因为将来可能会添加新列，所以我将删除`<>`必要列的任何内容。

**问题：**我在`If Or`下面使用了一个很长的陈述，但它总是正确的。我尝试在`Or`'s 和许多其他括号变体之间的每个语句周围加上括号，但没有一个是正确的。在括号的一种变体下，该陈述总是错误的，但这是我收到的唯一变化。

**代码：**

```
If (Cells(4, i).Value <> "BATCH_ID" Or Cells(4, i).Value <> "Indicative" Or Cells(4, i).Value <> "Company Code" Or Cells(4, i).Value <> "Policy Num" Or Cells(4, i).Value <> "Numeric Amount" Or Cells(4, i).Value <> "Legal Amount" Or Cells(4, i).Value <> "PAYMENT_AMT") Then

      ActiveCell.EntireColumn.Delete

End If 
```

我在这里做错了什么？提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-16T14:34:35.490

其他人提到了在这种情况下使用`And`over的一个很好的概念。`Or`我还建议`Select Case`在有多个标准的情况下使用它，因为它更容易阅读、理解和编辑。

```
Select Case Cells(4, i).Value

    Case Is = "BATCH_ID", "Indicative", "Company Code", "Policy Num", "Numeric Amount", "Legal Amount", "PAYMENT_AMT"

    Case Else: ActiveCell.EntireColumn.Delete

End Select 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:31:05.330

否定的“或”语句经常让人绊倒。

您实际上需要使用“和”。这是逻辑：

如果`x <> a or x <> b`, 那么 x 可以是除 a 之外的任何东西，或者 x 可以是除 b 之外的任何东西。因此，如果 x == a，则第二个语句为真，如果 x == b 第一个语句为真。使用 OR，只要两个陈述中的一个为真，整个事情就为真。

如果你使用“和”：

如果`x <> a AND x <> b`, 那么对于第一部分 x 可以是除 a 之外的任何东西，对于第二部分 x 可以是除 b 之外的任何东西，但是...如果 x 是 a 那么第一部分是假的，所以整个陈述是假的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T14:32:29.090

尝试使用 AND，因为您只想删除不匹配的行。因为 OR 只需要 1 个条件为真/假即可执行。

在你的情况下，它会说不等于“Batch_ID”（如果它是真的-> 删除）等等..

```
If (Cells(4, i).Value <> "BATCH_ID" AND Cells(4, i).Value <> "Indicative") Then 
```

# java - 想用 Java 和数据库做一些原型设计。要使用什么驱动程序？

> ID：12916969
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:28:09.720
> 
> 标签：java, database, jdbc

一段时间以来，我一直在想一个小程序的想法。它将涉及玩家通过网络玩一个简单的游戏，并且需要服务器跟踪许多适合某种数据库系统的东西。

由于我只是一名学生，我可能最终会与我的一群朋友和他们的运行不同操作系统的笔记本电脑一起测试它，我选择使用 Java 和 Swing 以确保轻松的交叉兼容性。

我从来没有真正用数据库编写过任何东西，而不是用 Java 或任何其他语言。我做了一些研究并研究了 JDBC。现在，我主要关心使用哪个驱动程序。除了 4 种不同类型的驱动程序外，我没有找到任何连贯的列表，但这并不能帮助我选择特定的驱动程序。

我只是想快速入门并拥有一些数据库功能，我不太关心性能或其他任何东西，我很确定我的小项目不会要求任何特殊的东西，这是每个数据库系统都无法完成的.

什么是快速入门的好驱动程序？该服务器将在 Linux 机器上运行，以防万一。如果有一些关于如何开始使用该驱动程序使用数据库进行编程的指南，则可以加分。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:29:38.977

为您要使用的数据库使用类型 IV 驱动程序：MySQL、PostgreSQL、Derby、Hypersonic 等。

驱动程序将由供应商作为 JAR 文件提供，您将添加到 CLASSPATH 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:31:39.313

根据数据库，您需要选择驱动程序。驱动程序特定于数据库。您可以从数据库网站（如 oRacle 或 MySQL）下载驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:33:10.810

您在询问要使用什么驱动程序，但我想您真的想知道要使用什么 RDBMS。

[您可以使用 PostgreSQL 并从PostgreSQL 站点](http://www.postgresql.org/)获取 JDBC 驱动程序。

* * *

# jquery - 在 Chrome 中获得焦点模糊的元素

> ID：12916970
> 
> 赞同：2
> 
> 时间：2012-10-16T14:28:12.433
> 
> 标签：jquery, google-chrome

如果这是重复的，我很抱歉，但我找不到我的问题的答案。如果您知道在哪里已经回答，请给我一个链接。

我正在使用 jquery 将函数绑定到文本框的 onblur 事件。`tblUserDetails`目标是仅当焦点离开表格中的文本框时才触发回发。当文本框失去焦点时：

*   在 IE 中，新的焦点元素是新选择的文本框。
*   在 Chrome 中，文档集中在两个文本框之间，因此`$(document.activeElement)`永远不会指向新选择的文本框。

这是我的代码，它适用于 IE，但不适用于 Chrome：

```
SaveNetworkDetails: function () {

    // Trigger the blur event when one of the textboxes loses focus
    $("[id$=tblUserDetails]").find('input[id*="txt"]').blur(function (e) {

        // Check if the new focused element is among the textboxes
        if ($(document.activeElement).parents("[id$=tblUserDetails]").length == 0) {
            // Trigger postback
        }
    });
} 
```

如何在绑定到 blur 事件的函数中找到 Chrome 中新选择的文本框？

问候，

吉尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:30:48.233

这里有一个小误解：[`.blur()`](http://api.jquery.com/blur/)不会触发 blur 事件，它会将函数绑定到 blur 事件，这意味着您设置了一个在发生模糊时触发的函数。

也许这种误解是您问题的根本原因。

**更新**

我已经重新阅读了这个问题，现在我看到了你想要实现的目标。尽管您的文本让人认为您正在以编程方式触发模糊，但您的问题是，在 chrome 中，当离开控件时，文档会获得临时焦点。

与其在第一个输入的模糊处触发回发，不如在下一个输入的焦点上触发回发。根据我在您的代码中看到的，这种更改并不重要，但会解决您的问题。

# php - 在 WAMP 中提交大文本后连接重置

> ID：12916971
> 
> 赞同：1
> 
> 时间：2012-10-16T14:28:23.033
> 
> 标签：php, jquery, mysql, apache, wamp

我有一个 PHP 程序，它接收项目列表（1 到 x）并将它们与库存进行比较，然后打印出一份报告。它最多可以处理 1161 个项目，然后`connection reset`抛出 a。

我需要它才能处理多达 5000 行。行项目每行最多 10 个字母数字字符。一个 3462 行 (69 kb) 的文件正在杀死它……

我已经检查了许多 Apache 和 PHP 的设置，但还没有弄清楚。

```
ini_set('xdebug.max_nesting_level', 3000);
set_time_limit(360); 
```

有很多旧代码，整个文件都是分段工作的，所以没有坏数据进入。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:18:28.927

这可能是参数传输的限制。您是使用 GET 还是 POST 提交？如果使用 GET，则 URL 的最大长度受到限制。限制取决于操作系统和 Apache 版本等。

如果使用 POST，也可能有一些限制。

沃尔克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T14:12:59.390

丹博士是对的，这是我继承并修补了几次的旧代码。*问题是线程问题*，对函数的许多调用。完全以 OOP 风格重写，运行良好

# c++ - 在 Python 中将有符号整数转换为无符号整数

> ID：12916975
> 
> 赞同：0
> 
> 时间：2012-10-16T14:28:32.567
> 
> 标签：c++, python

首先，请原谅我无知问这种问题，但由于我不擅长 Python，我无能为力。

我遇到了以下需要转换为 C++ 的 Python 代码。

```
def getSignedNumber(number, bitLength):
    mask = pow(2,bitLength) - 1
    if number & (1 << (bitLength - 1)):
        return number | ~mask
    else:
        return number & mask

def getUnsignedNumber(number, bitLength):
    mask = pow(2,bitLength) - 1
    return number & mask 
```

这用于将 unsigned int 转换为有符号 int，反之亦然。但我不知道为什么我们必须这样做，因为我认为只需转换为相应的类型就足够了。也许是因为 Python 是一种动态类型的语言，需要这种操作？我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:49:46.807

你是说`reinterpret_cast`还是`dynamic_cast`？

长话短说：对于任意位长度的整数，您都需要它。下面的解释尝试：

将`getUnsignedNumber`一块内存解释为一个 nBit 数。这是必要的，因为您只能以特定的块大小获得内存（通常您不能分配 3 位，您需要分配下一个更大的单元，一个字节（char））。因此，您需要确保忽略不需要的 5 个额外位。

`getSignedNumber`对有符号数做同样的事情，但是如果数字是负数，我们需要用符号位填充。因此，即使对于 c，您也需要此功能。（想象一下，您将 -3 存储在您的 char 中并希望将其读取为无符号 3 位数字）

看来，这用于正确填充数字，假设您有一个字符：

c = 10001111

现在，如果您想将其解释为四位有符号类型，则实际上必须输入

c = 11111111

因为如果一个数字在二进制中为负数，则它之前的所有位实际上都是一个。但是，如果您将其解释为 5 位有符号类型，您会看到符号位为 0，因此**所有**前导位都应为零。所以你必须掩盖它，这样

c = 00001111

# html - 规范元标记与标头

> ID：12916977
> 
> 赞同：0
> 
> 时间：2012-10-16T14:28:44.047
> 
> 标签：html, http, seo

至少 Google 支持`<link rel="canonical">`标签和[链接 HTTP 标](http://www.w3.org/wiki/LinkHeader)头来规范化 URL 并帮助防止重复内容。

在 HTTP 标头可用时，是否优先使用 HTML 标记？在我的网站上，我想创建一个简单的函数，让您设置规范的 URL，但对于非 HTML 页面，这当然只能通过标题来完成。

那么只依赖 HTTP 标头来设置规范 URL 可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:21:55.273

当您的页面完全脱离上下文（FTP 服务器上的 HTML 文件（Google 也可以索引））时，使用元标记很有用。标头最适合通过 HTTP 传输的任何内容（因为您不必解析正文并依赖文档的 ~validity）。

# xslt - XSLT 中的自定义根节点

> ID：12916978
> 
> 赞同：1
> 
> 时间：2012-10-16T14:28:47.650
> 
> 标签：xslt, root

我想以自定义方式在 xslt 1.0 中创建根节点

预期的

" < TESTROOT xmlns="http://www.example.org/TESTXMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www. example.org/TESTXMLSchema TESTEntry.xsd">

实际的

" < TESTROOT xsi:schemaLocation="http://www.example.org/TESTXMLSchema TESTEntry.xsd" xmlns="xmlns="http://www.example.org/TESTXMLSchema"" xmlns:xsi="http:// /www.w3.org/2001/XMLSchema-instance">

提前感谢您的帮助

问候拉梅什库马尔·辛格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:13:00.017

**就这么简单**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <TESTROOT xmlns="http://www.example.org/TESTXMLSchema"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="http://www.example.org/TESTXMLSchema TESTEntry.xsd">
    The results of your processing here ...
  </TESTROOT>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于任何 XML 文档（未使用）时，将产生所需的结果：**

```
<TESTROOT xmlns="http://www.example.org/TESTXMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.example.org/TESTXMLSchema TESTEntry.xsd">
    The results of your processing here ...
  </TESTROOT> 
```

# windows - 带有 QT 的 OpenCV 2.4.2

> ID：12916983
> 
> 赞同：0
> 
> 时间：2012-10-16T14:28:51.403
> 
> 标签：windows, qt, opencv

你好我实际上一直在使用 OpenCV 2.4.2 和 QT。

我可以编译我的项目，但是当我通过 QT 运行它时，我没有好的windws。

我在 Windows 下运行 QTCreator 最新版本

在这里，我将 OpenCV 2.4.2 与 QT 一起使用：

1.  下载 OpenCV 并解压到 C:/
2.  安装 MinGW 并添加路径变量
3.  像这样修改我的 .pro 文件：

    模板 = 应用程序

    配置 += 控制台

    配置 -= qt

    INCLUDEPATH = C:\Users\Erowlin\Desktop\OpenCv_QT\opencv\include

    LIBS = -LC:\Users\Erowlin\Desktop\OpenCv_QT\opencv\lib -l opencv_core242 -l opencv_highgui242

    来源 += main.cpp

我实际上可以编译没有错误，但是当我运行我的程序时，我得到了这个窗口：![在此处输入图像描述](../Images/8fba8597fa573f130c7b4738ad40b9cb.png)

当我手动执行我的程序时，我没有问题，一切都像魅力一样工作。

有人已经遇到同样的问题了吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T17:36:43.750

这就是你的 .pro 文件的样子......

```
INCLUDEPATH += C:\Users\Erowlin\Desktop\OpenCv_QT\opencv\build\include 

LIBS +=-LC:\Users\Erowlin\Desktop\OpenCv_QT\opencv\build\x86\mingw\lib\ 
-lopencv_core242\ 
-lopencv_highgui242\ 
-lopencv_imgproc242\ 
-lopencv_video242\ 
```

并且您的系统变量名为 path 应该有

1.  C:\Users\Erowlin\Desktop\OpenCv_QT\opencv\build\x86\vc9\bin （如果你有 Qt 4.8.1 for desktop MSVC2008 (QtSDK) Debug 作为你的目标）
2.  C:\Users\Erowlin\Desktop\OpenCv_QT\opencv\build\x86\mingw\bin （如果您的目标基于 Qt MinGW x86 ）
3.  C:\Users\Erowlin\Desktop\OpenCv_QT\opencv\build\common\tbb\ia32\vc9(mingw) （我添加了这个，因为它显示了一些奇怪的错误......你可以试试）

编辑路径变量后关闭 Qt ide/应用程序并重新启动它以使系统变量更改得到反映..

尝试从[该网站](http://opencv.org/)获取 opencv 2.4.2 ...使用已经构建的库和 dll 或使用 CMAKE 从头开始​​构建...我还遇到了使用带有 imread 和 imshow 的 cv::Mat 格式读取图像的问题.. .但是从opencv.org下载opencv2.4.2解决了这个问题......如果仍然没有解决然后尝试链接调试库，如opencv_core242d.lib......它解决了这个问题..

# php - PHP Doctrine 初学者：找不到 Doctrine\ORM\Tools\Setup

> ID：12916985
> 
> 赞同：6
> 
> 时间：2012-10-16T14:28:59.553
> 
> 标签：php, doctrine, pear, require-once

我是学说的初学者。我刚刚安装了 pear + 学说 2.3.3 并想对其进行测试。

为了测试教义，我写了一个名为“person”的类

```
/**
 * @Entity
 */
class person
{
    /** @Id @Column(type="integer") @GeneratedValue * */
    private $id;

    /** @Column(type="string") * */
    private $name;

    /** @Column(type="string") * */
    private $surname;

    //some getters and setters ...
} 
```

之后我制作了 bootstrap.php 文件、bootstrep_doctrine.php 和 cli-config.php 文件并运行命令：

```
doctrine orm:schema-tool:create 
```

效果很好！

但是现在，当我想将我的 bootstrap.php 包含在“普通”php 文件中以创建“人”时，我收到以下错误：

```
Fatal error: Class 'Doctrine\ORM\Tools\Setup' not found 
in /var/www/vms/bootstrap_doctrine.php on line 15 
```

该文件如下所示：

```
<?php
$debug = true;
if($debug){
    error_reporting(E_ALL);
    ini_set("display_errors", "on");
    ini_set("display_startip_errors", "on");
}
require_once '../bootstrap.php';

include_once ('testClassOrm.php');
$person = new person();
$person = new person();
$person->setName("Hans");
?> 
```

引导程序.php：

```
if(!class_exists("Doctrine\Common\Version", false)){
    require_once 'bootstrap_doctrine.php';
} 
```

bootstrap_doctrine.php

```
use Doctrine\ORM\Tools\Setup;
use Doctrine\ORM\EntityManager;

$paths = array("entities/");
$isDevMode = true;

// the connection configuration
$dbParams = array(
    'driver'   => 'pdo_mysql',
    'user'     => 'TEST',
    'password' => 'TEST',
    'dbname'   => 'test',
);

$config = Setup::createAnnotationMetadataConfiguration($paths, $isDevMode);
$em = EntityManager::create($dbParams, $config); 
```

我检查了 /usr/share/pear/ 是否在 php_include 路径中。它是..

```
require_once 'System.php';
var_dump(class_exists('System', false)); 
```

它返回真：

但这确实返回false：

```
use Doctrine\ORM\Tools\Setup;
var_dump(class_exists('Setup', false)); 
```

难道我做错了什么？

此致

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-10T08:43:37.220

是的，似乎缺少自动加载，自动加载类的最简单方法是使用 Composer，它还可以下载依赖项，例如 Doctrine。为此，您必须将 composer.phar 安装在项目根目录本地或全局安装在 PATH 系统变量中声明的文件夹（`/usr/local/bin/`是推荐的文件夹）中。

然后您必须`composer.json`在项目的根文件夹中编辑一个文件。在此文件中，您将定义项目的依赖项以及您希望能够加载的类路径。

```
{
    "require": {
        "Doctrine/ORM": "2.3.3"
    },
    "autoload": {
        "psr-0": {"MyProject\\Models\\": "src/models/"}
    }
} 
```

然后您所要做的就是从项目的根文件夹中打开一个终端并输入`composer install`. 这将创建一个包含所有下载依赖项的供应商文件夹。您还将`autoload.php`在此供应商文件夹中获得一个文件。你只需要在你的 php 文件中包含这个自动加载器，就可以使用你在`composer.json`.

您可以在此处获取有关 composer 的更多信息： [https](https://getcomposer.org/) ://getcomposer.org/ 您还可以在此处浏览可用的包： [https ://packagist.org/](https://packagist.org/)

希望这会有所帮助

# css - 在 Firefox 和 Chrome 中，较大的边框底部会破坏左边框和右边框

> ID：12916987
> 
> 赞同：1
> 
> 时间：2012-10-16T14:29:01.093
> 
> 标签：css, firefox, google-chrome, border

当覆盖已经有 1px 边框`border-bottom`的 a的大小时，Firefox 和 Chrome 会错误地渲染and ：`div``border-left``border-right`

### HTML

```
<div></div> 
```

### CSS

```
div{
    width: 300px;
    height: 200px;
    border: 1px solid #9fd;
    border-bottom: 50px solid #333;
} 
```

**jsFiddle 链接：http:** [//jsfiddle.net/azSrQ/](http://jsfiddle.net/azSrQ/)

### 预期结果（Safari 6.0.1）

![Safari 6.0.1](../Images/cd1423fcc426df67a2e9dcf998743826.png)

### 实际结果（Firefox 15.0.1 和 Chrome 22）

![火狐和铬](../Images/03c5a3d4d9759d0ed4c64b3a82ee1362.png)

`border-bottom`在最新的 Chrome 和 Firefox 中，左右边框总是停在中间。我在 Bugzilla 或 Chromium 的问题页面中找不到任何关于此的报告。

有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:40:48.243

我猜这很奇怪。或者也许这是默认行为？它们正好停在底部边界的 50% 处。

无论如何，这是一种模拟它的方法：

```
div:after {
    content:".";
    color:#333;
    position:absolute;
    bottom:-50px; left:-1px; right:-1px;
    line-height:25px;
    border-left:1px solid #9fd; border-right:1px solid #9fd;
}​ 
```

**[演示](http://jsfiddle.net/gionaf/GWSFR/)**

测试并在最新的 Chrome 和 Safari 上工作，FF 的小问题（赢）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T00:57:15.643

根据规范，这应该给出从一个边框宽度到另一个边框宽度的倾斜渐变。但是当其中一个宽度只有 1px 时，就会生成您在上面看到的内容......

# java - 如何将其解析为多值映射？

> ID：12916993
> 
> 赞同：0
> 
> 时间：2012-10-16T14:29:16.177
> 
> 标签：java, arrays, parsing

我有一个字符串 `name,5486984,189.658.235.215,3.158.68.15,name2,189189,189.658.218.268,3.158.68.13...`

等等

我在想我会把它放到地图中，但我不完全确定。我正在查看具有多值映射的 Apache Commons Collection 库。即使我使用它，我也不确定如何将这个 StringArray 解析成它。

编辑：

感谢您的答复。我的总体目标是让该字符串显示在 JSF 下拉菜单中。我有

```
<f:selectItems itemValue="#{mainBean.information}" value="#mainBean.information}" /> 
```

在我的 Java 中，我有

```
Private String [] information;
information = config.getStringArray("information"); // This brings in this string from the property file 
```

我一直在参考这个 [http://www.horstmann.com/corejsf/refcard.html](http://www.horstmann.com/corejsf/refcard.html)

因此，就我在这里所拥有的而言，我刚刚发布了。它将填充该字符串数组的每个元素。我只希望显示“名称”并将其他三个值作为实际“值”传递。

我想我可能需要提出一个新问题。

我试图制作一个 Map 对象，它是一个字符串和一个字符串数组，但 JSF 拒绝接受它。

这是新问题： [JSF 我需要用 StringArray 填充 selectItems 但我需要先解析它](https://stackoverflow.com/questions/12918956/jsf-i-need-to-populate-selectitems-with-a-stringarray-but-i-need-to-parse-it-fir)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:49:29.870

由于您将 Apache Commons 用于多图，并且您知道有四个值：

```
MultiMap map = new MultiHashMap();    
String[] elements = source.split(",");

// process the elements in groups of four
for (int keyIndex = 0; keyIndex < elements.length; keyIndex += 4) {
  String key = elements[keyIndex];
  map.put(key, elements[keyIndex+1]);
  map.put(key, elements[keyIndex+2]);
  map.put(key, elements[keyIndex+3]);
} 
```

最后你会得到一个`MultiMap`每个键包含三个元素。您当然应该对数据进行一些完整性检查，但基本思想如上所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:44:09.180

我可以从你的问题中理解，试试这个::

让你的数据是：

```
 String data = "name,5486984,189.658.235.215,3.158.68.15,name2,189189,189.658.218.268,3.158.68.13"

// Now you have 

    String[] sections = data.split(","); 
```

这些部分将包含以下数据：

部分[0] = "名称,5486984,189.658.235.215,3.158.68.15"; 部分[1] = "名称2,189189,189.658.218.268,3.158.68.13";

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:14:15.190

你真的不需要一个多值/多图。

我认为一个`map <String, String[]>`就足够了。

仍然有**分裂**的想法

```
@Test
public void testIt() {
    final String s = "name,5486984,189.658.235.215,3.158.68.15," +
            "name2,189189,189.658.218.268,3.158.68.13," +
             "name3,5486984,189.658.235.215,3.158.68.15," +
             "name4,189189,189.658.218.268,3.158.68.13";
    final String[] sections = s.split(",(?=[a-zA-Z])");
    final Map<String, String[]> map = new HashMap<String, String[]>();
    String[] tmp;
    for (final String sec : sections) {
        tmp = sec.split(",", 2);
        map.put(tmp[0], tmp[1].split(","));
    }
    //just for output
    for (final String k : map.keySet()) {
        LOG.debug("{} - {}", k, Arrays.toString(map.get(k)));
    }
} 
```

输出：

```
DEBUG: name3 - [5486984, 189.658.235.215, 3.158.68.15]
DEBUG: name4 - [189189, 189.658.218.268, 3.158.68.13]
DEBUG: name - [5486984, 189.658.235.215, 3.158.68.15]
DEBUG: name2 - [189189, 189.658.218.268, 3.158.68.13] 
```

如果你真的需要一个集合/列表作为价值，`Arrays.asList(array)`可以帮助你。

# sql-server - 在 SQL Server 查询中复制 MS Access “First”函数

> ID：12916994
> 
> 赞同：6
> 
> 时间：2012-10-16T14:29:19.163
> 
> 标签：sql-server, ms-access

我对 SQL Server 很陌生，所以我现在道歉。

我有一个表，我想 GroupBy`field1`并返回该字段`field2`中关联计数最高的记录。`counted`我通常会在 MS ACCESS 中使用 2 个查询来执行此操作，第一个查询以降序返回数据，第二个查询使用 First() 函数选择第一条记录，如下所示：-

查询 1

```
SELECT t.field1, t.field2, Count(t.counted) AS count1
FROM Table1 AS t
WHERE (((t.counted)=2))
GROUP BY t.field1, t.field2
ORDER BY t.field1, Count(t.counted) DESC; 
```

查询 2（基于上面的查询 1）

```
SELECT q.field1, First(q.field2) AS firstoffield2
FROM q
GROUP BY q.field1; 
```

[我正在寻找的 SOURCE DATA 和查询结果](https://docs.google.com/spreadsheet/ccc?key=0Ana40VqkvVtRdHhVUlVjRnBFN0c4VnFoOFNaZ3dSQnc)

我很难在 SQL Server 2008 查询中完成与上述相同的结果。有人可以帮忙吗？（请提供我需要使用的准确 SQL）。

这是数据的子集和结果示例：-

表格1

```
field1 ¦ field2 ¦ counted
10     ¦ 20     ¦ 2
10     ¦ 30     ¦ 2
10     ¦ 20     ¦ 2
20     ¦ 30     ¦ 0
20     ¦ 40     ¦ 0
20     ¦ 50     ¦ 1
20     ¦ 50     ¦ 2
20     ¦ 60     ¦ 1 
```

Query1 results (groups by field1, counts where "counted" field record is "2")

```
field1 ¦ field2 ¦ count1
10     ¦ 20     ¦ 2
10     ¦ 30     ¦ 1
20     ¦ 50     ¦ 1 
```

Query 2 resuls (the output I want to get from SQL)

```
field1 ¦ firstoffield2
10     ¦ 20
20     ¦ 50 
```

I hope that helps a bit, thanks guys.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T17:10:48.153

```
WITH
  q AS
(
  Put your query one here
)
,
  sequenced AS
(
  SELECT
    ROW_NUMBER() OVER (PARTITION BY field1 ORDER BY count1 DESC) AS sequence_id,
    *
  FROM
    q
)
SELECT
  *
FROM
  sequenced
WHERE
  sequence_id = 1 
```

To change this to LAST() change the order direction in the ROW_NUMBER() function.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T17:12:13.533

This isn't the most elegant query I've ever written, but how about something like this:

```
SELECT qSource.Field1, qSource.Field2
FROM (SELECT Field1, Field2, COUNT(Counted) AS Count1
    FROM dbo.Table1
    WHERE Counted = 2
    GROUP BY Field1, Field2)qSource
INNER JOIN (SELECT q.Field1,MAX(q.Count1) AS HighestCount
    FROM (SELECT Field1, Field2, COUNT(Counted) AS Count1
        FROM dbo.Table1
        WHERE Counted = 2
        GROUP BY Field1, Field2) q
    GROUP BY q.Field1) qHighest
ON qSource.Field1 = qHighest.Field1
AND qSource.Count1 = qHighest.HighestCount
ORDER BY qSource.Field1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-20T03:36:17.827

I was looking for the same thing and didn't like the complicated solutions, so I kept looking and found this:

[https://www.sqlservercentral.com/forums/topic/t-sql-equivalent-to-ms-access-first-function](https://www.sqlservercentral.com/forums/topic/t-sql-equivalent-to-ms-access-first-function)

Use "Top 1"

Select Top 1 SomeColumn From SomeTable Order By

This is really nice because you have added functionality of a complex ORDER BY to get exactly which one you want If there are multiple firsts