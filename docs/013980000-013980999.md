# StackOverflow 问答 13980000-13980999

# iphone - 我需要按下按钮重置第一个视图

> ID：13980000
> 
> 赞同：-2
> 
> 时间：2012-12-20T20:29:51.037
> 
> 标签：iphone, ios

在我正在创建的应用程序中，您需要在迷宫中滑动一个正方形，如果它碰到墙壁，它会转到另一个屏幕，告诉您您输了。但是，当您按下重置按钮时，它会返回，并且方块与它接触墙壁的位置完全相同。有什么方法可以让我按下按钮并让方块返回同时开始？任何反馈表示赞赏！谢谢。（顺便说一句，我正在使用 Xcode。）

这是 .h 文件中按钮的代码：

```
- (IBAction)retry:(id)sender; 
```

这是.m的代码：

```
- (IBAction)retry:(id)sender {

    [self dismissModalViewControllerAnimated:YES];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T10:53:13.687

在 buttonPressEvent 上调用您的初始方法。

```
- (IBAction)retry:(id)sender {

    [self viewDidLoad];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:53:19.843

用于`viewWillAppear`重置您的视图

```
-(void) viewWillAppear: (BOOL) animated { 
} 
```

# jquery - Masonry jQuery 插件对我不起作用

> ID：13980002
> 
> 赞同：1
> 
> 时间：2012-12-20T20:29:59.907
> 
> 标签：jquery, html, css

我似乎无法让砌体插件工作，我已经尝试了几个小时。我没有任何 javascript 错误。这是我的代码（现在，不仅在基础上，甚至在文档页面上）

HTML：

```
<div class="container">

<div class="item"></div>
<div class="item" style="height:320px;"></div>
<div class="item"></div>
<div class="item" style="height:300px;"></div>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>

</div>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.masonry.min.js"></script>
<script type="text/javascript">
    $(function(){
    $('#container').masonry({
        // options
        itemSelector : '.item',
    });
});
</script> 
```

CSS：

```
body {
margin: 0;
padding: 0;
width: 1310px;
margin:0 auto;
background-color: #212121;
}
.container {
width: 1302px;
margin: 0 auto;
position: absolute;
}
.item {
width: 220px;
height: 200px;
margin: 10px;
float: left;
background-color: #fff;
padding: 10px;
border-radius: 5px;
} 
```

任何帮助深表感谢，

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T20:31:19.940

```
$('#container').masonry({ //no element in the dom with id=container
    // options
    itemSelector : '.item',
}); 
```

你的 CSS 选择器是错误的。您正在解决它，因为`#container`它指的是 id，但是该元素上没有指定 id，只有一个类`.container`

将选择器更改为`$('.container')`或添加`id`属性（即`<div id="container">`，您应该一切顺利。

# queue - 禁用 TeamCity 构建队列

> ID：13980006
> 
> 赞同：6
> 
> 时间：2012-12-20T20:30:16.183
> 
> 标签：queue, teamcity

是否可以在 TeamCity 中禁用构建队列？如果一项作业已经在运行，我不希望另一个作业排队（例如，如果由触发器启动）。我已经进行了一些搜索，但没有找到防止排队的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T18:30:12.663

如果每个只有一个构建配置，您可以在同一个代理上运行它们，这样只有一个可以同时运行。但是，构建 2 将在构建 1 完成后运行，这是您不想要的。

这是我解决这个问题的方法。它有点难看，但很简单，并且可以推广到许多构建配置：

选择一个特定的服务器。由于此服务器将确定构建是否运行，因此我们将其称为您的*网关*服务器。我们需要一个现在不存在的文件位置，也不会由任何其他程序创建。比如说，`/teamcity/.lock'

使用以下内容进行构建配置：

```
lockFileLocation="/teamcity/.lock"
if [ -f $lockFileLocation ];
then
    echo "oops, we're already running a build."
    exit 1
else
    echo "No build is running. Let's lock it up!"
    touch $lockFileLocation
fi 
```

对于 Powershell，它是这样的：

```
$lockFileLocation = "C:\teamcity\lock"
if(Test-Path $lockFileLocation)
{
    echo "oops, we're already running a build."
    exit 1
}
else
{
    echo "No build is running. Let's lock it up!"
    echo "lock'd!" > $lockFileLocation
} 
```

并确保构建设置为仅在*网关*代理上运行。所以这个构建只有在它从未运行过时才会成功。还没有用。我们称之为构建*锁*。使用以下内容进行新的构建配置：

```
lockFileLocation="/teamcity/.lock"
if [ -f $lockFileLocation ];
then
    echo "Build's over. You don't have to do home, but you can't stay here"
    rm $lockFileLocation
else
    echo "No build is running. How did we get here?"
    exit 1
fi 
```

对于 Powershell：

```
$lockFileLocation = "C:\teamcity\lock"
if(Test-Path $lockFileLocation)
{
    echo "Build's over. You don't have to do home, but you can't stay here"        
    rm "$lockFileLocation"
}
else
{
    echo "No build is running. How did we get here?"
    exit 1
} 
```

确保构建设置为仅在*gate*上运行，并且构建将删除该文件（如果存在）。让我们称之为构建*解锁*。

酷，现在我们可以运行*lock*来写入文件，并且*unlock*来删除它。如果你运行*lock*两次而不运行*unlock*，第一次运行*lock*将通过，第二次运行失败。好的。

但这对我们有什么帮助？假设您的构建是一个名为*work*的单一构建配置。*在工作上*设置完成构建触发器，以便它在*锁定*成功后运行。*同样，在解锁*时设置完成构建触发器，以便它在*工作*完成后运行，**无论它是通过还是失败**。即使您提交了错误的代码，我们也希望解锁构建。

如果您的构建是一组构建配置，则您的构建内部需要通过快照依赖项连接，而不是完成构建触发器。假设您的构建是两种构建配置：*work-A*和*work-B*。您想先运行*work-A*，然后在完成后运行*work-B*。像往常一样设置从*工作 B*到*工作 A的快照依赖项。**然后，在解锁*时设置一个完成构建触发器，当*锁定*通过时触发。将快照依赖项从*解锁*设置为*工作-B*, 设置为“即使依赖失败也运行构建。这是构建图，其中向下的箭头是完成构建触发器，向上的箭头是快照依赖项：

```
+----+                           
|lock|                           
+----+  +------+                 
  |     |work-A|                 
  |     +------+                 
  |        ^                     
  |        |                     
  |        |                      
   \   +------+                  
    \  |work-B|                  
     \ +------+                  
      \   ^                      
       \  |                      
        v |                      
       +------+                  
       |unlock|                  
       +------+ 
```

*现在，当您在lock*上点击“运行”时，它将锁定构建，触发您的构建配置，然后解锁构建。多次点击“运行”，看看*work-A*和*work-B*是如何排队的。

但这只是一组构建配置。你有两个。所以以这种方式设置它们，确保它们查看相同的文件，并且都设置为仅在*网关*代理上运行。

耶！我们完成了！但是等等，为什么*work-A*和*work-B*需要通过快照依赖关系连接？好吧，假设构建如下：

```
+----+
|lock|
+----+
   |
   |
   v
+------+ 
|work-A|
+------+
   |
   |
   v             
+------+
|work-B|
+------+
   |
   |
   v
+------+
|unlock|
+------+ 
```

现在，如果*work-A*失败了怎么办？*work-B*不会运行，因此也不会*unlock*。

注意：理论上，您可以按如下方式运行构建：

```
+----+        
|lock|        
+----+  +------+
   \    |work-A|
    \   +------+
     \     ^
      \    |
       v   |
      +------+
      |work-B|
      +------+
         |    
         |    
         v   
      +------+
      |unlock|
      +------+ 
```

这应该可以，但我还没有测试过，所以我不能给你所有的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T19:05:36.480

我找不到动态禁用触发器或根据另一个状态有条件地运行一个构建的方法。

如果这两个作业彼此无关，也许您可​​以将它们配置为在不同的代理上运行？这样他们就可以在不相互干扰的情况下运行。

# obfuscation - .NET Reactor 和 InnoSetup

> ID：13980008
> 
> 赞同：1
> 
> 时间：2012-12-20T20:30:38.940
> 
> 标签：obfuscation, inno-setup, net-reactor

我有一个 VS 2010 C#“解决方案”；在我在安装程序的 InnoSetup 构建中使用的发布模式下进行构建时，它会创建一个 .exe 文件和一个 .pdb 文件。

我的应用程序使用了几个来自其他供应商的 .dll（即 WinSCP）。我的问题是：是否仍然使用 InnoSetup 构建安装程序，将 .NET Reactor 中的新 .exe 替换为 Visual Studio 创建的安装程序？我唯一想使用 .NET Reactor 混淆的是我的应用程序，而不是其他供应商。

（我查看了 Google 和 SO，但没有找到答案。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-11-12T15:06:28.207

您可以在构建安装程序之前直接替换 exe/dll。

如果您想在将 VS 项目文件输出 (exe/dll) 打包到您的设置中之前自动保护它，您可以使用[.NET Reactor Visual Studio Add-in](https://stackoverflow.com/a/64806223/12720992)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-07-24T11:38:41.700

安装 dotFuscator 然后您将能够在源代码中将其项目类型添加为新项目。在那里您可以将输出文件设置为混淆。

# asp.net - SMTP windows server 2008 Asp.net 分拣目录

> ID：13980015
> 
> 赞同：0
> 
> 时间：2012-12-20T20:31:02.233
> 
> 标签：asp.net, email, smtp, windows-server-2008-r2

我已经在 Windows Server 2008 中通过 IIS 6.0 配置了一个 smtp 服务器。我已经授予：-Administrators - NT AUTHORITY\LOCAL SERVICE - NT AUTHORITY\NETWORK SERVICE - IUSR_MACHINE_NAME - 我的域用户

SMTP 服务的文件夹结构如下： - Badmail - Drop - Pickup - Queue

我有一个通过拾取目录发送电子邮件的 mvc 应用程序，配置如下：

```
<smtp deliveryMethod="SpecifiedPickupDirectory">
<specifiedPickupDirectory pickupDirectoryLocation="E:\Email\dev\Pickup" xdt:Transform="Replace"  />
</smtp> 
```

问题是当我设置拾取目录时，应用程序从不将电子邮件文件写入该特定文件夹，奇怪的是我也没有遇到任何异常，我想这可能是与某些用户权限相关的问题，但我已经向该文件夹中的每个人授予了完全控制权。

事实是我没有收到任何电子邮件。

此环境不适用于生产，仅用于测试目的，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T08:46:18.470

试试下面的代码，这对我有用，我一直在我的项目中使用它，发送邮件时，eml 文件在这里创建。

```
 <system.net>
        <mailSettings>
          <!-- Method#2: Dump emails to a local directory -->
          <smtp from="admin@abc.com" deliveryMethod="SpecifiedPickupDirectory">
            <network host="localhost" />
            <specifiedPickupDirectory pickupDirectoryLocation="F:\Project\Mails\" />
          </smtp>
        </mailSettings>
      </system.net> 
```

# extjs - ExtJS 中的 Tab 未触发依赖组合框

> ID：13980017
> 
> 赞同：0
> 
> 时间：2012-12-20T20:31:06.483
> 
> 标签：extjs, extjs3

我有一个品牌和一个型号的组合框。当用户选择品牌时，品牌组合会加载信息。问题是，当用户关闭组合框时，它不会触发。当他们按下回车键或用鼠标从列表中选择一个项目时，它确实有效。以下是我们的 make 组合：

```
new Ext.form.ComboBox({
    id: 'ddlMake',
    store: makeStore,
    displayField: 'Description',
    valueField: 'MakeOid',
    width: 175,
    typeAhead: true,
    mode: 'local',
    forceSelection: true,
    triggerAction: 'all',
    emptyText: 'Select a make',
    selectOnFocus: true,
    allowBlank: false,
    listeners:
        {
            select: function(combo, record, index) {
                LoadModelCombo(combo, record, index);
                FillAircraftType();
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T12:43:55.687

这是我最终使用的。我同时使用了选择和更改：

```
new Ext.form.ComboBox({
    id: 'ddlMake',
    store: makeStore,
    displayField: 'Description',
    valueField: 'MakeOid',
    width: 175,
    typeAhead: true,
    mode: 'local',
    forceSelection: true,
    triggerAction: 'all',
    emptyText: 'Select a make',
    selectOnFocus: true,
    allowBlank: false,
    listeners: {
        select: function (combo, record, index) {
            LoadModelCombo(combo, record, index);
            FillAircraftType();
        },
        change: function (combo, record, index) {
            LoadModelCombo(combo, record, index);
            FillAircraftType();
        }
    }
}), 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T20:41:51.297

使用组合框组件的**forceSelection**配置属性，这将允许您实现您想要的。其余的你可以看到这个配置的 sencha 文档

# python - 匹配新行

> ID：13980026
> 
> 赞同：1
> 
> 时间：2012-12-20T20:32:34.757
> 
> 标签：python, regex

我有以下正则表达式：

```
pattern = re.compile(r"HESAID:|SHESAID:") 
```

它工作正常。我用它来分割多个分隔符，如下所示：

```
result = pattern.split(content) 
```

我要添加的是验证，以便除非将 HESAID: 或 SHESAID: 放在新行上，否则不会发生拆分。这不起作用：

```
pattern = re.compile(r"\nHESAID:\n|\nSHESAID:\n") 
```

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T20:39:28.667

如果您详细说明它到底是如何不工作的，那将会很有帮助，但我猜问题是它与 HESAID/SHESAID 的连续行不匹配。您可以通过使用行首和行尾锚来解决此问题，而不是实际放入`\n`您的正则表达式：

```
pattern = re.compile(r'^HESAID:$|^SHESAID:$', re.MULTILINE) 
```

该`re.MULTILINE`标志是必需的，以便在行的开头和结尾匹配，而不仅仅是字符串的开头和结尾`^`。`$`

我可能会如下重写正则表达式，`?`之后`S`使其成为可选：

```
pattern = re.compile(r'^S?HESAID:$', re.MULTILINE) 
```

# jsf - JSF 页面未呈现为 HTML

> ID：13980040
> 
> 赞同：2
> 
> 时间：2012-12-20T20:33:41.433
> 
> 标签：jsf, jsf-1.2

我正在尝试运行一个非常基本的 JSF 页面。使用 Websphere 7.0 作为服务器，所以我试图坚持使用 JSF 1.2。浏览器没有呈现 html，我的意思是它只是显示所有 html 代码，包括 doctype 等。
我的第一个猜测可能是它没有通过 FacesServlet，但是当 url-pattern 不匹配时它找不到页面。是 JSF 版本问题吗？还有其他想法吗？谢谢各位

我在我的 lib 文件夹中包含了 jstl-api-1.2.jar 和 jstl-imp-1.2.jar。

我设置了以下 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns="http://java.sun.com/xml/ns/javaee"
  xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
      http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
  version="2.5">
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.jsf</url-pattern>
  </servlet-mapping>
  <context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Development</param-value>
  </context-param>
  <context-param>
        <param-name>javax.faces.application.CONFIG_FILES</param-name>
        <param-value>/WEB-INF/faces-config.xml</param-value>
</context-param>
  <context-param>
    <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
    <param-value>.xhtml</param-value>
  </context-param>

  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>index.html</welcome-file>
  </welcome-file-list>
</web-app> 
```

面孔-config.xml：

```
<?xml version="1.0"?>
<faces-config xmlns="http://java.sun.com/xml/ns/javaee" 
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
      http://java.sun.com/xml/ns/javaee/web-facesconfig_1_2.xsd"
   version="1.2">
</faces-config> 
```

index.jsp：

```
<% response.sendRedirect("page-a.jsf"); %> 
```

以及 xhtml 文件的开头：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T04:16:30.747

您似乎正在尝试将 JSF 1.2 与 Facelets 1.x 一起使用。这很好，但在`faces-config.xml`. 您应该在那里有以下条目：

```
<application>
    <view-handler>com.sun.facelets.FaceletViewHandler</view-handler>    
</application> 
```

请注意，您需要该[`jsf-facelets.jar`](http://mavenhub.com/mvn/thirdparty-releases/com.sun.facelets/jsf-facelets/1.1.15)文件。

另请注意，您实际上不需要在 webapp中提供[JSTL ；](https://stackoverflow.com/tags/jstl/info)WebSphere 7 作为一个成熟的 Java EE 5 应用服务器已经自己提供了它。我建议删除那些 JSTL JAR 文件，因为它可能与 WebSphere 提供的文件冲突。JSF 也已由 WebSphere 提供，但 Facelets 并不是自 Java EE 6 以来只是 Java EE 的一部分。

Given the lack of Facelets view handler, I wonder if you're reading the right Facelets tutorial (since JSF 2.0, a Facelets `<view-handler>` configuration is not mandatory as it's the default view handler already, so perhaps you were accidently reading a JSF 2.0 targeted tutorial, while you should really be reading the one for JSF 1.x), so for the sake of completeness, here's a link to [the official developer guide of Facelets 1.x](http://facelets.java.net/nonav/docs/dev/docbook.html).

# css - 如何在单选按钮标签处于活动状态时删除它们周围的虚线边框？

> ID：13980041
> 
> 赞同：4
> 
> 时间：2012-12-20T20:33:56.910
> 
> 标签：css, css-selectors

> **可能重复：**
> [如何删除单击按钮时出现的虚线](https://stackoverflow.com/questions/11393044/how-to-remove-dotted-that-appears-when-button-is-clicked)

我有一些这样的代码：

```
<input id="input-radio-principal" type="radio" name="chart-type" value="principal" checked="checked" />
<label for="input-radio-principal">Principal balances</label>

<input id="input-radio-payments" type="radio" name="chart-type" value="payments" />
<label for="input-radio-payments">Monthly payments</label> 
```

每当我单击单选按钮时，IE9 中单选按钮的标签上都会出现灰色虚线边框。是否可以删除该边框？

我已经看到了很多关于如何从链接中删除它的信息，但没有看到单选按钮标签。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T20:52:01.537

也许这在你的 CSS 中：

```
input {outline: none;} 
```

在[这个 JSFiddle中工作](http://jsfiddle.net/cTrYf/5/)

适用于 IE8 和 IE 9，其中边框不在按钮或标签周围。但是，边框仍然围绕在 IE7 中的标签周围。正如上面的评论者所建议的那样，我相信一个完整的解决方案可能会涉及 Javascript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T20:52:23.173

```
<input class="button" type="radio" id="radioButton"/> 

input[type="radio"] {
    outline: none;
} 
```

那应该在IE9中工作

# wpf - DataGrid 单元格验证中的 WPF 多绑定转换器

> ID：13980043
> 
> 赞同：1
> 
> 时间：2012-12-20T20:33:59.773
> 
> 标签：wpf, validation, datagrid, multibinding

我正在尝试使用 Multibinding 对数据网格单元格进行验证，以启用和禁用基于其他控件值和数据的验证。

```
<TextBox Validation.ErrorTemplate="{StaticResource errorTemplateSilverlightStyle}" Grid.Column="5" Grid.Row="10" Name="totalNumberOfPackagesInMBLTextBox" MinWidth="150" MaxWidth="150" Margin="5" HorizontalAlignment="Left" >
<TextBox.Text>
    <Binding  Path="TotalNumberOfPackagesInMBL" Mode="TwoWay" ValidatesOnDataErrors="True"  NotifyOnValidationError="true"  UpdateSourceTrigger="PropertyChanged" >
        <Binding.ValidationRules>
            <validate:RequiredFieldRule>
                <validate:RequiredFieldRule.IsEnabled>
                    <validate:ValidationRuleProperty>
                        <validate:ValidationRuleProperty.IsEnabled>
                            <MultiBinding Converter="{StaticResource sealFieldRequiredConverter}" ConverterParameter="S">
                                <Binding Path="Text" ElementName="sealTypeTextBox" Mode="OneWay"/>
                                <Binding Path="Items.Count" ElementName="shippingBillEOUsDataGrid" Mode="OneWay"/>
                            </MultiBinding>
                        </validate:ValidationRuleProperty.IsEnabled>
                    </validate:ValidationRuleProperty>
                </validate:RequiredFieldRule.IsEnabled>
            </validate:RequiredFieldRule>
            <validate:IsNumberValidationRule/>
        </Binding.ValidationRules>
    </Binding>
</TextBox.Text> 
```

因此，使用此代码，我无法将转换器中的控制值作为 UnSetvalue 获得。

请让我知道代码有什么问题。

# javascript - 我正在使用 jsTree 和 jsTree Grid 并且我的第二列中的数据消失了

> ID：13980044
> 
> 赞同：3
> 
> 时间：2012-12-20T20:34:08.667
> 
> 标签：javascript, html, jstree

我在 jsTree Grid 中有一列代表我的树。第二列用于显示与每个节点关联的“标签”。在我单击另一个级别之前，它显示得很好。

所以第二列将创建一个 div 并将我的标签（类似于堆栈溢出标签）附加到该 html 元素。

这是页面首次加载时的问题。我看到根节点很好，并且与我在第二列中定义的根节点关联的“标签”。看起来很棒！

当我单击展开根节点时，可以进入下一个级别。我丢失了与根节点关联的标签。我想要的是保留它们，但我不知道为什么网格会丢失它。

编辑：

删除了代码和图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:36:00.563

问题是 jsTreeGrid 插件在展开节点时会重绘单元格。由于您只在“loaded”和“select_cell”事件期间附加标签，因此标签会消失。

您可以通过在更多事件上重新附加标签来解决此问题：

```
.bind("open_node.jstree create_node.jstree clean_node.jstree change_node.jstree", function (event, data) { 
    doDisplayTags(mapNameTag);
}) 
```

# ruby-on-rails-3 - 覆盖 active_admin form.has_many 中的默认范围

> ID：13980045
> 
> 赞同：4
> 
> 时间：2012-12-20T20:34:15.720
> 
> 标签：ruby-on-rails-3, activeadmin, default-scope

给定一个具有多个附件的模型 Post，并且附件具有隐藏标志。在整个应用程序中，我想轻松地说 post.attachments 并且只获取可见的，所以我在 Attachment 模型中设置了一个默认范围（使用 squeel）：

```
default_scope -> { where { (hidden != true) | (hidden == nil) } } 
```

但是管理页面需要能够查看帖子的所有附件，而不仅仅是可见的附件（这样您就可以切换隐藏的复选框）。这样做的默认方式（在 admin/posts.rb 中）使用 default_scope 并且只允许我编辑可见的：

```
f.has_many :attachments do |a|
  ...
end 
```

我知道我不能使用 default_scope 而是将其命名为 :visible，然后在任何地方（管理页面除外）都说 post.attachments.visible，但我不想这样做。

如何在管理页面上取消子附件的范围？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T20:34:15.720

这是我制定的解决方案：

在 app/admin/posts.rb

```
f.has_many :attachments, for: [:attachments, f.object.attachments_including_hidden] do |a|
  ...
end 
```

在 app/models/posts.rb

```
def attachments_including_hidden
  Attachment.unscoped.where( attachable_id: id )
end 
```

（其中附件模型属于_to: :attachable, polymorphic: true ）

这是怎么回事？ActiveAdmin 使用 Formtastic，后者使用 Rails Form Builder。form.has_many 方法是一个 ActiveAdmin 方法，它调用 Formtastic 的 form.inputs，而后者又调用 Rails 的 fields_for。:for 选项将一直传递到 fields_for 中，它可以接受一个集合（作为它的第二个参数），所以我明确地将这个集合传递给它。

# function - VHDL在Generate中使用库函数

> ID：13980049
> 
> 赞同：2
> 
> 时间：2012-12-20T20:34:27.003
> 
> 标签：function, package, vhdl

所以我使用一种算法来创建一个类似于链接中的结构（[http://ars.els-cdn.com/content/image/1-s2.0-S0140366499000031-gr1.gif](http://ars.els-cdn.com/content/image/1-s2.0-S0140366499000031-gr1.gif)）。所以我创建了一个函数来决定下一步跳转到哪里。在我的 VHDL 交换机架构中，我尝试使用生成语句来定义节点并适当地映射它们的端口，但是当我合成它时说““banyan”不能在这个表达式中使用”（banyan 是库中的一个函数）。下面是一些示例代码：

```
INPUT: IF ( l = 1 ) GENERATE 
            NODE_Element : BN PORT MAP( 
                                                clk, reset, 
                                                Input((2*n)-1), 
                                                Input((2*n)), 
                                                SyncIn, 
                                                con(l+1,Banyan(l,n),BanyanPort(l,n)), 
                                                con(l+1,Banyan(l,n),BanyanPort(l,n)), 
                                                sync(l+1,n)
                                            ); --GENERIC MAP(...)
        END GENERATE INPUT; 
```

有没有人知道如何解决这个问题......这似乎很重要，但我可以找到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:58:28.623

看起来问题不是生成，而是端口映射。您可以在端口映射中执行的操作有一些限制，并且许多工具（您没有说这是哪个合成器工具！）都有自己的严格限制。

我建议将函数结果分配给临时信号，并在端口映射中使用该信号。

```
INPUT: IF l = 1 GENERATE 
Banyan1     <= Banyan(l,n);
BanyanPort1 <= BanyanPort(l,n);
Con1        <= con(l+1,Banyan(l,n),BanyanPort(l,n)); 

 NODE_Element : BN PORT MAP( 
                              clk, reset, 
                              Con1, 
                           );
END GENERATE INPUT; 
```

您可能会发现并非所有这些更改都是必要的；可能将 con(...) 移出端口图就足够了。

# rest - 将对象作为原始字符串而不是使用 JSON/XML 传递是否可以？

> ID：13980050
> 
> 赞同：0
> 
> 时间：2012-12-20T20:34:45.527
> 
> 标签：rest

我正在开发一个移动应用程序，我需要将对象来回发送到中央服务器。每个对象有大约 10 个属性（字符串或整数）。

当我想将一个对象从应用程序发送到服务器时，我会创建一个 POST，其中每个属性都成为一个键值对。

当我想从服务器获取一个对象到应用程序时，我只需使用连接字符串上的对象属性（例如，atribute1；atribute2；atribute3；atribute4；atribute5；等）回复一个 POST 请求，然后解析该数据通过拆分字符串并重新创建对象在应用程序上。

**问题**：使用此方法而不是将字符串格式化为 JSON 或 XML 是否可以？我选择这个是因为简单，而且我也相信我不会失去任何性能（实际上我可能会获得一些）。但我想确认一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:42:01.923

这是一个有趣的站点，展示了拆分字符串和解析 json 之间的性能差异。我觉得如果您已经设置了发送数据的系统，那么坚持使用它应该没问题。

[http://jsperf.com/json-parse-vs-string-split/4](http://jsperf.com/json-parse-vs-string-split/4)

至于其他开发人员的 JSON 是一个伟大而简单的坚持标准。

# c# - 如果在 using 子句中发生错误，C# `Using` 语句是否会关闭变量

> ID：13980058
> 
> 赞同：0
> 
> 时间：2012-12-20T20:35:32.847
> 
> 标签：c#, sharepoint-2010, idisposable, using, spweb

> **可能重复：**
> [什么是 C# Using 块，我为什么要使用它？](https://stackoverflow.com/questions/212198/what-is-the-c-sharp-using-block-and-why-should-i-use-it)

如果我运行以下代码：

```
using (SPWeb web = SPContext.Current.Site.OpenWeb("/myweb")){

   //error happens here
} 
```

**如果在右括号之前发生错误**，对象`web`会被正确处理吗？

 **我们被告知对我们的对象使用`using`语句是最好的，但是 我们在有关 SPRequests 和 SPWeb 的日志中看到了很多错误。`OpenWeb`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T20:38:06.517

是的，这就是重点。它是语法糖：

```
SomeType obj = new SomeType();
try
{
    // do stuff with obj
    // if an exception is thrown then the finally block takes over
}
finally
{
    if(obj != null)
        obj.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:39:02.620

有关“使用”功能的完整说明，请参见 MSDN：http: [//msdn.microsoft.com/en-us/library/yh598w02.aspx](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

简短的回答是肯定的，因为 Dispose 在 finally 子句中。**

# javascript - 在 jPlayer 中随机化流链接

> ID：13980060
> 
> 赞同：0
> 
> 时间：2012-12-20T20:35:42.890
> 
> 标签：javascript, jquery, jplayer

我有一个经过改装的 jPlayer，它连接到一个直播/冰播源。

我想让 jPlayer 在打开页面时随机连接 2 个或多个 url。

例如，如果我有 2 个链接：

1.  www.example.com:8000/live
2.  www.example.com:8000/live2

然后我需要 jPlayer 在打开页面时随机选择其中一个。目的是防止一台服务器过载。

我应该如何在 jQuery 代码中处理它？

*jQuery：*

```
$("#jquery_jplayer_1").jPlayer({
        ready: function(event) {
            $(this).jPlayer("setMedia", {
                mp3: "http://www.example.com:8000/live"
            }).jPlayer("play");
        },
        swfPath: "js/",
        wmode: "window",
        solution: "flash,html",
        supplied: "mp3",
        preload: "none",
        volume:0.75,
        cssSelectorAncestor: "",
        cssSelector: {
                play: "#play",
                pause: "#pause"
        }
    });

    $("#jquery_jplayer_1").bind($.jPlayer.event.pause, function(event) {
        $(this).jPlayer("clearMedia");
        $(this).jPlayer("setMedia", {
                mp3: "http://www.example.com:8000/live"
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:46:28.610

回答您的问题，您可以执行以下操作。

```
var servers = ["www.example.com:8000/live", "www.example.com:8000/live2"];
var server = servers[Math.floor(Math.random() * servers.length)]; 
```

```
$(this).jPlayer("setMedia", {
  mp3: server
}); 
```

* * *

尽管这不是解决您的实际问题的最佳方法：

> 目的是防止一台服务器过载。

您应该考虑使用[**负载平衡**](http://en.wikipedia.org/wiki/Load_balancing_%28computing%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T20:38:23.663

您可以使用服务器端语言或 javascript 获取 X 个随机 url 之一。然后只需将随机值传递给`mp3:`

```
var randomUrl = getRandomUrl();
$("#jquery_jplayer_1").bind(...) {
       mp3: randomUrl;
} 
```

# python - 马尔可夫决策过程的数据结构

> ID：13980063
> 
> 赞同：10
> 
> 时间：2012-12-20T20:36:04.383
> 
> 标签：python, artificial-intelligence, markov

我已经在 Python 中实现了简单马尔可夫决策过程[维基百科](http://en.wikipedia.org/wiki/Markov_decision_process)的值迭代算法。为了保持特定马尔可夫过程的结构（状态、动作、转换、奖励）并对其进行迭代，我使用了以下数据结构：

1.  状态和可用于这些状态的操作的字典：

    `SA = { 'state A': {' action 1', 'action 2', ..}, ...}`

2.  转换概率字典：

    `T = {('state A', 'action 1'): {'state B': probability}, ...}`

3.  奖励字典：

    `R = {('state A', 'action 1'): {'state B': reward}, ...}`.

我的问题是：这是正确的方法吗？最适合 MDP 的数据结构（在 Python 中）是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T08:43:04.750

我之前在 Python 中实现了马尔可夫决策过程，发现以下代码很有用。

[http://aima.cs.berkeley.edu/python/mdp.html](http://aima.cs.berkeley.edu/python/mdp.html)

此代码取自Stuart Russell 和 Peter Norvig的*《人工智能：现代方法》 。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-20T21:09:12.507

数据结构是否合适主要取决于您对数据的处理方式。您提到您想要迭代该过程，因此为此目的优化您的数据结构。

马尔可夫过程中的转换通常由矩阵乘法建模。转移概率`Pa(s1,s2)`和奖励`Ra(s1,s2)`可以由（可能是稀疏的）矩阵描述并由`Pa`状态`Ra`索引。我认为这将有几个优点：

*   如果为此使用 numpy 数组，索引可能会比使用字典更快。
*   然后状态转换也可以通过矩阵乘法简单地描述。
*   例如轮盘选择的过程模拟将更快、更清晰地实现，因为您只需选择转换矩阵的相应列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-12T05:16:11.853

有一个名为[pymdptoolbox](https://github.com/sawcordwell/pymdptoolbox)的带有 python 的 MDP 实现。它是基于使用称为[MDPToolbox](http://www7.inra.fr/mia/T/MDPtoolbox/)的 Matlab 实现而开发的。两者都值得注意。

基本上，概率转移矩阵表示为（`A`×× ）数组，奖励表示为（× `S`）矩阵，其中和表示状态数和动作数。该包对稀疏矩阵也有一些特殊处理。`S``S``A``S``A`

# c# - 在 WPF 中使用 C# 绑定 xml

> ID：13980064
> 
> 赞同：1
> 
> 时间：2012-12-20T20:36:04.827
> 
> 标签：c#

我有以下xml

```
<?xml version="1.0" encoding="utf-8"?>
<Categories>
<Product>
<Product_id>dave</Product_id>
<Product_name>smith</Product_name>
<Product_price>none</Product_price>
</Product>
</Categories> 
```

我想通过代码绑定它，因为我真的在 WPF 和 XAML 上苦苦挣扎。除非有人能告诉我一个简单的方法。

下面的 C#

```
XmlDataProvider xds= new XmlDataProvider();
        xds.Source = new Uri(@"C:\Users\Roi\Desktop\dave\Sum.xml", UriKind.RelativeOrAbsolute);
        xds.XPath = "/Categories/Product/@Product_id";
        Binding binding = new Binding();
        binding.Source = xds;
        BindingOperations.SetBinding(listView1, ItemsControl.ItemsSourceProperty, binding); 
```

任何帮助都会非常有用。

谢谢

詹姆士

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:42:09.590

像这样的东西应该工作：

```
<Window x:Class="WpfApplication4.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication4"
       Title="MainWindow" Height="300" Width="400" Name="UI" >

    <Grid>
        <ListView DataContext="{Binding MyXmlDataSource}" ItemsSource="{Binding XPath=/Product/@Product_id}" />
    </Grid>
</Window> 
```

您将希望`DependencyProperty`在您的窗口/控件上为 XmlDataProvider添加一个

```
public XmlDataProvider MyXmlDataSource
{
    get { return (XmlDataProvider)GetValue(MyXmlDataSourceProperty); }
    set { SetValue(MyXmlDataSourceProperty, value); }
}

// Using a DependencyProperty as the backing store for MyXmlDataSource.  This enables animation, styling, binding, etc...
public static readonly DependencyProperty MyXmlDataSourceProperty =
    DependencyProperty.Register("MyXmlDataSource", typeof(XmlDataProvider), typeof(MainWindow), new UIPropertyMetadata(null)); 
```

然后你可以分配你的 XmlDataProvider

```
XmlDataProvider xds= new XmlDataProvider();
        xds.Source = new Uri(@"C:\Users\Roi\Desktop\dave\Sum.xml", UriKind.RelativeOrAbsolute);
        xds.XPath = "/Categories";

MyXmlDataSource = xds; 
```

# breeze - Breeze.js 如何显示验证错误消息

> ID：13980067
> 
> 赞同：1
> 
> 时间：2012-12-20T20:36:19.623
> 
> 标签：breeze

在保存更改期间，存在验证失败的情况，但我如何返回并显示实际的错误消息。执行了 saveFailed 函数，但我想要更多详细信息，关于哪些验证失败以及那些单独的错误消息

```
 function saveChanges() {
       if (manager.hasChanges()) {
           manager.saveChanges()
               .then(saveSucceeded)
               .fail(saveFailed);
       } else {
           alert("Nothing to save");
       };
   };

   function saveSucceeded() {
       alert("changes saved successfully");
   };

   function saveFailed(error) {
       alert("Error while saving changes" + error.message);
   }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:34:40.713

看一下微风下载提供的 TODO 示例。

dataservice.js 清楚地向您展示了如何捕获和显示验证错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:57:27.817

失败处理程序返回的“错误”对象应包含其他详细信息，具体取决于错误。以下属性应始终存在

error.message - 错误消息 error.status - http 错误代码 - 通常是 400 或 500 代码 error.detail - 与错误相关的任何详细信息 error.XHR - 原始 XML HttpResponse 对象 error.responseText

对于验证错误，现在它们出现在 error.message 中，但我们正在考虑以一种更简洁的方式将它们分解，可能会分解到另一个属性中。但现在它们将出现在 error.message 中。

# jquery - 如何同步两个jQuery Cycle 2？

> ID：13980071
> 
> 赞同：0
> 
> 时间：2012-12-20T20:36:42.290
> 
> 标签：jquery, sync, cycle

我正在为我的项目使用 Jquery Cycle 2，它需要在两者中提供相同的幻灯片。我使用的方法是：

```
$('.cycle-slideshow.big').on('cycle-after',function(e,opts) {
    $('.cycle-slideshow.small').cycle('goto',opts.nextSlide);
}); 
```

opts.nextSlide 只是滑块“小”中下一张幻灯片的 ID。

由于某种原因，浏览器会在第二个滑块中随机播放图片，所以我不能使用序列号，这就是问题所在。如何同步滑块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T14:11:11.807

问题解决了。只需将 Progressive Image Loading 替换为 simple 并删除 IE 的 data-cycle-loader 即可。

# facebook - 如何获取网站链接统计信息？

> ID：13980075
> 
> 赞同：0
> 
> 时间：2012-12-20T20:37:10.077
> 
> 标签：facebook, hyperlink, statistics, facebook-fql

我听说有一种方法可以使用 FQL 从 Facebook 获取 URL 的统计信息。有没有办法使用 Open Graph 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-25T04:12:25.373

是的。

您可以从 Graph API 端点检索链接统计信息。

例如，访问[https://graph.facebook.com/?id=http://example.com](https://graph.facebook.com/?id=http://example.com)会得到如下响应：

```
{
   "id": "http://example.com",
   "shares": 47068
} 
```

# javascript - AngularUI select2 AJAX 通过模型设置

> ID：13980077
> 
> 赞同：0
> 
> 时间：2012-12-20T20:37:15.623
> 
> 标签：javascript, jquery, angularjs, jquery-select2, angular-ui

我将 AngularUI 的`ui-select2`指令与 AJAX 一起使用。

以下是我的观点：

```
<label>Group: <input ng-model="group" ui-select2="select2GroupConfig"></label> 
```

这是我的模型中的内容：

```
$scope.select2GroupConfig = {
    ajax: {
        url: 'theURL',
        data: function (term, page)
        {
            return { q: term };
        },
        results: function (data, page)
        {
            return { results: data };
        }
    }
}; 
```

这按预期工作。

* * *

**我的问题：**如何通过模型更新值？

我试过：

```
$scope.group = 'some group'; 
```

我也尝试使用一个对象：

```
$scope.group = { id: 32, text: 'some group'}; 
```

但这也不起作用。

**如何通过模型更新使用 AJAX 的 select2？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T16:24:12.460

原来你**可以**将它设置为一个对象，但只能在`ui-select2`运行之后；我试图给它一个初始值。

因此，您必须使用`select2`'`initSelection`函数，而不是使用常规模型：

```
$scope.group = 'Dummy Content';

$scope.select2GroupConfig.initSelection = function ( el, fn ) {
    fn({ id: 2, text: 'Some group' });
} 
```

请注意，您必须给输入一个初始值，否则`initSelection`永远不会被调用。这就是为什么我只是将它设置为一些虚拟内容。

* * *

这行得通，但感觉就像一个黑客。

有没有人有更好的想法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T02:59:03.610

如果你有`initSelection`设置，你可以只传递 ID，指令将拉起整个行对象。

这也将允许您在页面加载到 ID 时设置该值。

如果您不想使用`initSelection`，可以将整行（对象）设置为值，并且 select2 将相应更新。然而，这一切都取决于您的用例。

# php - 显示每个用户的三张图片

> ID：13980078
> 
> 赞同：3
> 
> 时间：2012-12-20T20:37:19.660
> 
> 标签：php, mysql, loops, picturegallery

我有一个图片表，其中用户的图片与他们的 ID 和图片物理链接一起保存。

```
userID  |  picture
1       |  picnameLink
1       |  picnameLink
2       |  picnameLink
1       |  picnameLink
2       |  picnameLink
3       |  picnameLink 
```

现在，我想在 jquery 图片库块中显示最多 3 张图片，其中一个块应显示来自同一用户的所有 3 张图片，如果用户的图片少于 3 张，则不应显示图像文本。

我试图通过 mysql 查询进行分组，但我没有得到想要的结果。我必须使用两个循环吗？

--编辑 fthiella -- 这是代码

```
$query = "SELECT * FROM pictures GROUP BY userID";
$result = mysql_query($query);
while($row = mysql_fetch_array($result)){
    $image_array[] = $row['picLink'];
    $id_array[] = $row['pic_id'];
}
$num_images_to_display = 3; /* MODIFY TO REFLECT NUMBER OF IMAGES TO SHOW PER SCREEN */
$num_images = count($image_array);
$image_path = "../images/"; /* MODIFY TO REFLECT THE PATH TO YOUR IMAGES */
$y = $num_images_to_display;
if(!isset($_GET['first'])){
        $first = 0;
    }else{
        $first = (int) $_GET['first'];
}
$x = $num_images - 1;
$z = $x - $y;
if($first>$z) {
    $first = $z;
}
$last = $first + $num_images_to_display; 
```

这里是 HTML 区域：

```
<div style="position:absolute; top:50px; left:100px; width:800px; text-align: center;">
    <?PHP
    $i = $first;
    while($i<$last) { $showme = $image_path . $image_array[$i]; ?>

<?php if($image_array[$i]!="") { ?><img src="<?PHP echo $showme; ?>" width="176px" height="197px"><?php } else { ?><img src="../image/no_image.jpg" width="176px" height="197px"><?PHP } ?>

    $prev = $first-1;
    $next = $first +1;
    if($prev<0){ $prev = 0; }
    ?>
</div> 
```

此查询的结果按组显示图片，但我希望每个用户最多三张图片，如果用户的图片少于三张，则不显示任何图片。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T20:42:36.520

我不知道是否有更好的解决方案，但我认为你可以使用这个：

```
SELECT p1.userID, p1.picture as pic1, p2.picture as pic2, p3.picture as pic3
FROM
  pictures p1 left join pictures p2
  on p1.userID=p2.userID and p1.picture<>p2.picture
  left join pictures p3
  on p1.userID=p3.userID and p1.picture<>p3.picture and p2.picture<>p3.picture
GROUP BY p1.userID 
```

这将为每个用户选择三个图像。如果用户的图像少于三个，它将显示空值，如果它有更多，它会在所有图像之间选择三个。

另一种方法是使用变量来显示三个图像，每个图像都在不同的行中：

```
SELECT userid, picture
FROM (
  SELECT
    userid,
    picture,
    case when @prec_id=userid then @row:=@row+1 else @row:=1 end as row,
    @prec_id:=userid
  FROM 
    `pictures`,
    (SELECT @prec_id:=0, @row:=0) s
  ORDER BY userid) s
WHERE row<=3 
```

**编辑：**要一次为每个用户显示三个图像，我将使用我的第一个查询，我将从以下代码开始：

```
<?php
$mysqli = new mysqli("localhost", "username", "password", "test");

$image_path = "../images/";
$no_image = "../image/no_image.jpg";

if(!isset($_GET['first'])){
  $first = 0;
} else {
  $first = (int) $_GET['first'];
}

if ($stmt = $mysqli->prepare("SELECT p1.userID, p1.picture as pic1, p2.picture as pic2, p3.picture as pic3
FROM
  pictures p1 left join pictures p2
  on p1.userID=p2.userID and p1.picture<>p2.picture
  left join pictures p3
  on p1.userID=p3.userID and p1.picture<>p3.picture and p2.picture<>p3.picture
GROUP BY p1.userID
LIMIT ?,1")) {

    $stmt->bind_param("i", $first); 
    $stmt->execute();
    $stmt->bind_result($user, $pic1, $pic2, $pic3);
    $stmt->fetch();
    $stmt->close();
}
$mysqli->close();
?>
<div style="position:absolute; top:50px; left:100px; width:800px; text-align: center;">
  <img src="<?PHP echo (isset($pic1) ? $image_path.$pic1 : $no_image); ?>" width="176px" height="197px">
  <img src="<?PHP echo (isset($pic2) ? $image_path.$pic2 : $no_image); ?>" width="176px" height="197px">
  <img src="<?PHP echo (isset($pic3) ? $image_path.$pic3 : $no_image); ?>" width="176px" height="197px">
</div> 
```

（它已经改进了，但你可以从它开始。我使用的是 mysqli 而不是 mysql）

# c++ - 在 Visual Studio 2012 中跟踪 LNK1112 错误

> ID：13980082
> 
> 赞同：1
> 
> 时间：2012-12-20T20:37:55.070
> 
> 标签：c++, visual-studio-2012, linker-errors

我有一个项目，我作为 x64 项目已经编译了很长一段时间，但由于各种原因，我现在必须将它编译为 x86 项目。

我遇到的问题是每次编译项目时都会出现 LNK1112 错误。

```
1>Link:
1>  
1>  Starting pass 1
1>Release\CameraCapture.obj : fatal error LNK1112: module machine type 'x64' conflicts with target machine type 'X86'
1>
1>Build FAILED. 
```

文件 Release\CameraCapture.obj 是从我项目中的 .cpp 文件编译而来的。

我已经删除了项目中所有额外的 .lib 依赖项，只是为了消除我错过获取任何 3rd 方库的 32 位版本的任何可能性。剩下的就是默认添加到项目中的 Windows 库。

我想知道有什么方法可以具体跟踪 LNK1112 错误涉及哪些文件？显然涉及到CameraCapture.obj，但是这个文件应该是x86的，没有任何问题。有没有人对如何找到我遇到的问题有什么好的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:54:06.097

处理此类问题的一些技巧：

*   打开链接器启动横幅，以便您可以准确查看它正在使用的输入（或查看项目属性中的命令行。

*   确保项目是干净的，所以周围没有任何旧的二进制文件。

*   确保在项目设置中设置了正确的平台类型。我什至会在 .vcxproj 文件本身中搜索 x64 和 x86，以确保您掌握了所有内容。

*   用于`dumpbin /HEADERS`检查进入链接器的 .obj 和 .lib 文件的机器类型。

# css - Div 侧边栏高度和缩放

> ID：13980087
> 
> 赞同：0
> 
> 时间：2012-12-20T20:38:00.637
> 
> 标签：css

如需现场演示，请访问我的网站[@http://hello-world.cu.cc](http://hello-world.cu.cc)。请务必查看主页、项目页面和评论页面。这些页面中的每一个都有相同的侧边栏，并应用了不同的样式。这是为了向您展示我尝试过的内容以及它导致的问题。

我正在制作一个左侧有侧边栏，右侧有主要内容的网站。我遇到的问题与侧边栏有关。我让它向左浮动，这很好，直到我放大网页并且突然侧边栏移动位置，这破坏了整个布局。我试图通过将侧边栏的位置设置为绝对位置并将容器的位置设置为相对位置来解决此问题。现在这解决了缩放问题，因为当我现在放大时它保持在相同的位置。但是，由于位置现在是绝对的，因此页面不会自动变长以容纳侧边栏。我目前使用的临时解决方案是绝对定位侧边栏以解决缩放问题，然后添加最大高度以及`overflow:auto`提供可用于滚动侧边栏的滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:39:09.567

您有两件事似乎会导致问题。

*   #header 有`min-width:100%`
*   #main 有`width:1100px`

修好这些，你就可以上路了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T19:32:01.570

就像 Randy Hunt 上面指出的那样，最大的问题是由您的`#header`. 我会将这些应用于您的标题：`position: absolute; left: 0px; top: 0px;`，然后您需要通过应用正边距来调整当前使用负边距的所有元素。获取标题的 150 像素高度并添加负边距以找到新的正边距值（因此 -138 像素的上边距将变为 12 像素）。

另外，`min-width: 100%;`我不会做类似`width: 100%; min-width: 1100px;`或任何宽度的事情。

希望有帮助。

# networking - 在 Azure 上设置 Windows 域并让我的笔记本电脑成为其中的一部分

> ID：13980091
> 
> 赞同：4
> 
> 时间：2012-12-20T20:38:22.107
> 
> 标签：networking, azure, vpn

我是 Azure Networking 的新手，一般对网络不是很熟悉，所以请原谅我的天真。

我的要求是建立一个 Windows 域，我理解它是用于描述通过集中式数据库（通常是 Active Directory）跟踪其主体（机器、用户、服务等）的网络的短语。

我知道这可以在 Azure 上完成，我可以将 Azure 上预配的虚拟机添加到此网络。但是，我也希望我的笔记本电脑（可能还有我和我的团队拥有的其他机器）成为同一网络的一部分。

1.  这在 Azure 上可行吗？

2.  [我需要这里](http://msdn.microsoft.com/en-us/library/windowsazure/jj156075.aspx)提到的设备来设置这样的东西吗？

我需要这个设置是为了创建一个环境，让我们能够复制我们的客户所拥有的环境（典型的企业 Windows 域，带有 Active Directory、Exchange Server 等）。因此，即使使用 Azure 可以实现上述操作，但还有更有效的替代方案，我也很想了解它们。

谢谢贾斯普雷特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T01:22:32.093

您真正需要的是创建一个虚拟网络集，您将在其中添加 Windows Azure 上的虚拟机以及来自本地网络的物理机。

要将计算机保留在一个域下，您可以在 Windows Azure 虚拟机中运行域控制器 (DC)，或者您可以在本地继续运行 DC 并连接到 Azure 虚拟网络。

建立 DC 后，您将在本地计算机和 Azure VM 之间建立基于 VPN 的网络连接。因此，当您携带笔记本电脑或任何加入相同域的物理机器（云/本地 DC）时，机器将通过您之前配置的同一个 DC 进行身份验证。请记住，只要您的域控制器配置了 Azure 虚拟网络，任何已加入域的物理计算机都将显示在同一网络中。这就是你所需要的。

以下是供您遵循的分步详细信息：

1.  [在 Windows Azure 中创建和设置虚拟网络](https://www.windowsazure.com/en-us/manage/services/networking/create-a-virtual-network/)
2.  [在 Windows Azure 上将虚拟机添加到虚拟网络](https://www.windowsazure.com/en-us/manage/services/networking/add-a-vm-to-a-virtual-network/)
3.  [在 Windows Azure 中安装新的 Active Directory 林](https://www.windowsazure.com/en-us/manage/services/networking/active-directory-forest/)

    或者

    [在 Windows Azure 虚拟网络中安装副本 Active Directory 域控制器](https://www.windowsazure.com/en-us/manage/services/networking/replica-domain-controller/)

4.  [https://www.windowsazure.com/en-us/manage/services/networking/cross-premises-connectivity/](https://www.windowsazure.com/en-us/manage/services/networking/cross-premises-connectivity/)

# haxe - 为什么 setter 需要在 Haxe 中返回一个值？

> ID：13980095
> 
> 赞同：1
> 
> 时间：2012-12-20T20:38:30.967
> 
> 标签：haxe

我最近被这样一个事实绊倒了：设置 an 的 setter 的预期类型`Int`是`Int -> Int`.

为什么 setter 会返回一个值？这个值有什么意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T22:05:57.747

除了此处的其他答案之外，它还允许您执行以下操作：

```
x = y = z = 5; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T20:38:30.967

setter 返回的值是赋值表达式的值。

例如，如果您要执行以下操作：

```
public var x(setX, getX): Int

public function setX(val: Int): Int {
    return 5;
}

static function main() {
    neko.Lib.print(x = 2); // Prints 5
} 
```

Haxe 会打印出 5。setter 返回 set 表达式的值。当然，在这种情况下，这是一个荒谬的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T16:05:25.490

在现实世界中，它允许在赋值时实现按值复制的方式，例如：

```
public var pos(set_pos, default):Point;
function set_pos(newPos:Point) {
    pos.x = newPos.x
    pos.y = newPos.y;
    return pos;
} 
```

并且在实现可能失败的设置器时也有一个合理的回报，例如：

```
public var positiveX(default, set_positiveX):Int;
function set_positiveX(newX:Int) {
    if (newX >= 0) x = newX;
    return x;
}

trace(x = 10); // 10
trace(x = -4); // 10
trace(x);      // 10 
```

而你会得到这样的东西：

```
trace(x = 10); // 10
trace(x = -4); // -4
trace(x);      // 10 
```

即使设置器不修改值，AS3 中也会发生这种情况。如果你不能这样做，显然第一个，其中 x = -4 返回 10 更好:)

# c++ - Visual Studio 中的“多处理器编译”有什么缺点吗？

> ID：13980097
> 
> 赞同：29
> 
> 时间：2012-12-20T20:38:44.790
> 
> 标签：c++, visual-studio, compilation, multiprocessing

在 Visual Studio for C++ 项目中使用“多处理器编译”选项时，我应该注意哪些缺点、副作用或其他问题？或者，换一种说法，为什么这个选项在 Visual Studio 中默认是关闭的？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-20T20:47:16.857

[的文档`/MP`说](http://msdn.microsoft.com/en-us/library/bb385193.aspx)：

> **不兼容的选项和语言功能**
> 该`/MP`选项与某些编译器选项和语言功能不兼容。如果您将不兼容的编译器选项与该`/MP`选项一起使用，编译器会发出警告 D9030 并忽略该`/MP`选项。如果您使用不兼容的语言功能，编译器会发出错误 C2813，然后根据当前编译器警告级别选项结束或继续。
> **注意：**
> 大多数选项是不兼容的，因为如果它们被允许，并发执行的编译器会同时将它们的输出写入控制台或特定文件。结果，输出将混合并出现乱码。在某些情况下，选项的组合会使性能变差。

它提供了一个表格，列出了与以下内容不兼容的编译器选项和语言功能`/MP`：

> *   `#import`预处理指令（将类型库中的类型转换为 C++ 类，然后将这些类写入头文件）
> *   `/E`, `/EP`（将预处理器输出复制到标准输出（stdout））
> *   `/Gm`（启用增量重建）
> *   `/showIncludes`（将包含文件列表写入标准错误（stderr））
> *   `/Yc`（写一个预编译的头文件）

Visual Studio不是默认禁用这些其他选项（并默认启用`/MP`），而是让您手动禁用/阻止这些功能并启用`/MP`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-20T20:45:48.290

根据我们的经验，发现的主要问题是：

1.  由于多个项目同时调用 bscmake，浏览信息无法构建（现在无用的信息，因此应作为项目设置删除）
2.  由于依赖问题和构建顺序问题导致的链接器失败，在正常构建时通常不会看到
3.  批量构建不利用多处理器编译，至少 2005-2008 VS 版本确实如此
4.  生成的关于预编译头不兼容的警告，当您构建 stdafx 时会发生这种情况并且可以忽略，但是在进行重建时会生成此消息

但是，以上是您可以解决的配置问题，否则应该启用它，因为它会加快构建速度。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-20T20:44:44.670

因为多处理器编译与许多其他编译选项不兼容，并且还具有更高的系统资源使用率。应该由开发商来决定对他来说是否值得。您可以在此处找到完整的文档：http: [//msdn.microsoft.com/en-us/library/bb385193.aspx](http://msdn.microsoft.com/en-us/library/bb385193.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-11T19:52:48.430

虽然使用`/MP`会给编译速度带来一些好处，但由于工作负载的调度方式，仍有一些性能留在桌面上：[https ://randomascii.wordpress.com/2014/03/22/make-vc-compiles-快速并行编译/](https://randomascii.wordpress.com/2014/03/22/make-vc-compiles-fast-through-parallel-compilation/)

编译器以“批次”的形式接收作业（一组传递给编译器的源文件），并且只有在前一个批次完成后才会开始下一个批次。这意味着在编译最长的翻译单元之前，其他内核上还有未使用的周期。编译器子进程之间没有数据共享。

为了进一步提高多核的利用率，我建议切换到`ninja`. 我已经在几个项目中实现了它，它总是一个胜利，例如[https://github.com/openblack/openblack/pull/68#issuecomment-529172980](https://github.com/openblack/openblack/pull/68#issuecomment-529172980)

# php - 使用 PHP 和 JS 到服务器的系统时间

> ID：13980100
> 
> 赞同：2
> 
> 时间：2012-12-20T20:38:57.670
> 
> 标签：php, javascript, time

我正在尝试做的是在网站的登录/注册页面中填写隐藏的输入，并且在该输入中将包含 JavaScript`new Date()`内容，例如：

```
"Fri Mar 23 2012 22:23:03 GMT-0700 (PDT)" 
```

我想获取该信息并在服务器端使用它来将其转换为 PHP`date()`并将其显示在用户的时区中。

似乎有一种使用 GMT 差异的简单方法`-0700`，但我已经查看了所有内容，但找不到简单插入该数字的方法。

有一个简单的解决方案吗？我要做的就是在提交表单后将输出修改为用户时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:46:10.867

使用[date_create_from_format()](http://php.net/manual/en/datetime.createfromformat.php)或类似函数。确保以您打算阅读的相同格式从 Javascript 输出日期。

另请参阅...我自己的这个旧答案：

*   [如何在 PHP 中显示服务器和用户时间？](https://stackoverflow.com/a/13093074/1244588)

# javascript - 获取应用于元素的 CSS 类的背景颜色

> ID：13980101
> 
> 赞同：7
> 
> 时间：2012-12-20T20:39:01.123
> 
> 标签：javascript, css

说，我有以下 CSS 类：

```
.upComing{ background:#ccc; font-weight:bold; } 
```

在我的 HTML 中，我有一个表格，其中一些行应用了该类，如下所示：

```
<table>
  <tr> <td></td> <td></td> </tr>
  <tr> <td></td> <td></td> </tr>
  <tr class='upComing'> <td></td> <td></td> </tr>
  <tr> <td></td> <td></td> </tr>
  <tr class='upComing'> <td></td> <td></td> </tr>
</table> 
```

到目前为止，一切都很好，但是通过 JavaScript，我有监听 td 点击的事件，我想获取行的颜色（我知道我可以获取行的类，但在这种情况下，我需要能够获取类的颜色）。

我需要这样做，因为可以将表格导出到 excel 文件，并且如果它们在 CSS 类上，行颜色不会应用于 excel 文件，我想在发送 html 之前将此颜色应用于每个 td到excel生成器。

PS：该表是从我们创建的 jQuery 插件动态生成的，它仍在进行中，但是当我们对它有足够的信心时，我们会向公众发布它。

--更新-- 这是关于这个主题的更新，确实有一个纯 javascript 解决方案，我不得不潜入 jQuery 的源代码来检查这一点。这是解决方案：

1）指向所需的元素

```
var tr = $("tr.upComing").first()[0]; 
```

2) 获取元素的 COMPUTED STYLE

```
var css = window.getComputedStyle( tr ); 
```

3) 获取 COMPUTED STYLE 的 PROPERTY VALUE

```
var color = css.getPropertyValue( "background-color" ); 
```

到目前为止，我只在 Mac 上的 FF、Safari、Chromium 和 Opera 中进行了测试，如果有人可以在 IE 上尝试这个并给我们反馈，那就太好了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T20:46:21.270

您可以使用 jquery CSS 方法从元素中获取背景颜色：http: [//api.jquery.com/css/](http://api.jquery.com/css/)

```
var color = $(this).css("background-color"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T20:46:10.353

以下应该这样做

```
$('.upComing:eq(0)').css('backgroundColor') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-16T08:44:31.060

如果它有帮助，我遇到了同样的问题并发现，在你的情况下使用：

```
a = document.getElementsByClassName('upcoming');
console.log(a.style.backgroundColor);
```

如果您不使用，则可以使用**：**

> document.addEventListener("DOMContentLoaded", function(event) {});<

而是在结束 body 标记之前引用 js 文件，尽管这被认为是脏的。

# html - Link_to 在 Rails 中显示动作

> ID：13980104
> 
> 赞同：5
> 
> 时间：2012-12-20T20:39:13.527
> 
> 标签：html, ruby-on-rails, ruby, erb

在我的`index.html.erb`文件中，我有：

```
<% @posts.each do |post| %>
  <%= post.title %>
  <%= link_to 'Show', post %>
<% end %> 
```

如何链接到显示操作但`<%= post.title =>`将链接名称作为链接名称？

我试过`<%= link_to '<%= post.title %>', post %>`了，但它不起作用。我错过了什么还是需要改变什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T20:40:25.283

```
<%= link_to post.title, post %> 
```

更多信息：[http ://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T20:41:42.113

这将有助于：

```
 <%= link_to post.title, post_path(post) %>. 
```

您还应该阅读以下内容：[rails guides](http://guides.rubyonrails.org/getting_started.html)

# javascript - 需要通过选择框、多个文本框和选择列表的值填充文本框

> ID：13980106
> 
> 赞同：0
> 
> 时间：2012-12-20T20:39:14.913
> 
> 标签：javascript, jquery, textarea, double-click, selectlist

嘿伙计们，我有一个表，它有一个主行，一个带有文本框的行和一个带有选择列表的行，该列表具有预先制作的评论值，双击时需要将其填充到其上方的文本框中。我能够将所选列表项的值放入一个变量中，但我似乎找不到我正在寻找的文本框。这都是由我们的数据库运行的，所以我使用的是类而不是 id，并且需要使用类名查找上一个项目。这是我的代码，任何帮助都会很棒。

注意：我不包括 document.ready 包装器，但它在我的代码中。

```
 $(".mfValues").dblclick(function () {
            var val = $(this).attr("value")
           // alert(val);
            $(this).prev(".mfTextComments").val(val);
        });

   <tr><td><textarea class="mfTextComments" runat="server" cols="20" rows="2" ></textarea></td></tr>";
   <tr><td><select runat=\"server\" style=\"height:20px;\" title=\"Please select a comment from this list by double clicking the comment or create your own in the text area above.\" size=\"4\">
    <option class="mfValues" value="Value1"\">Value1</option>
    <option class="mfValues" value="Value2"\">Value1</option>
    <option class="mfValues" value="Value3"\">Value1</option>
    </select></td></tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:41:19.637

你快到了，只需要离开 < tr > ：

```
$(".mfValues").dblclick(function() {
    var $this = $(this),
        val = $this.val();
    $this.closest('tr').prev().find(".mfTextComments").val(val);
});​ 
```

# php - PHP session_start() 这将是最佳实践吗？

> ID：13980108
> 
> 赞同：-3
> 
> 时间：2012-12-20T20:39:24.110
> 
> 标签：php, session, isset

根据用户是否登录，我想在我的主页上显示特定信息。但是，以下是最好的方法吗？

```
<?php session_start()?>

if (!isset($_SESSION['test'])) {
  session_destroy();
}
else {
  show info
} 
```

这是最佳实践吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T20:44:34.153

你的代码不会做任何事情。

它只会输出：

> if (!isset($_SESSION['test'])) { session_destroy(); } 其他 { 显示信息 }

演示：[http ://codepad.viper-7.com/9a3iOK](http://codepad.viper-7.com/9a3iOK)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:09:30.137

如果您不指定是什么`$_SESSION['test']`、如何设置或取消设置，那么您的代码将毫无意义。

大致猜想，你想做这样的事情：

```
<?php
session_start();

//during login
...
$_SESSION['token'] = md5($username . $_SERVER['REMOTE_ADDR']);

//at the top of all your pages.
if( isset($_SESSION['token']) && $_SESSION['token'] != md5($username . $_SERVER['REMOTE_ADDR']) ) {
    session_destroy();
    echo "Possible session hijacking, go away.";
    exit;
} 
```

因此，如果有人尝试附加到会话，他们将被拒绝，因为他们的 IP*可能*不同。如果您在共享 wifi AP 上，并且没有使用 HTTPS 或受信任的 VPN，那么同一 AP 上的某人可能会因为 NAT 而获取会话 cookie，并且仍然具有相同的公共 IP 地址。您可以添加额外的信息，例如`$_SESSION['HTTP_USER_AGENT']`，但如果他们知道自己在做什么，那仍然是欺骗性的。

像这样的东西，加上 SSL 应该可以让你在绝大多数情况下免受会话 cookie 劫持和会话 ID 暴力破解。极少数是与您在同一个 NAT 的 AP 上的人，在您当时碰巧登录的站点上暴力破解会话 ID，并且很幸运。

# jquery - jQuery循环通过json？

> ID：13980113
> 
> 赞同：7
> 
> 时间：2012-12-20T20:39:32.727
> 
> 标签：jquery, json, each

我有一些`var data`看起来像这样的 json ( )：

```
{"success":"true","keywords":["firstkeyword","secondkeyword"]} 
```

我尝试使用以下代码遍历关键字：

```
 data.keywords.each(function(e){
                $('#campaign_keywords').append("<p>"+e+"</p>");
            }); 
```

但我得到了错误

```
Uncaught TypeError: Object firstkeyword,secondkeyword has no method 'each' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-20T20:42:02.110

你需要像这样循环遍历它：

```
$.each(data.keywords, function (i, v) {
    $('#campaign_keywords').append("<p>"+data.keywords[i]+"</p>");
}); 
```

[jQuery.each()](http://api.jquery.com/jQuery.each/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T20:41:41.863

那是因为它是一个数组，并且它需要是一个 jquery 包装的对象才能使用 jquery 函数。尝试：

```
$.each(data.keywords, function(index, value){...}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T20:44:45.980

它是一个 javascript 数组，而不是 jQuery 对象。只需在它上面应用 $ 以使其像 jquery 对象一样

```
 $(data.keywords).each(function(e){
        $('#campaign_keywords').append("<p>"+e+"</p>");
    }); 
```

# java - 聚合器模式，SOA (SplitJoin OSB)

> ID：13980117
> 
> 赞同：2
> 
> 时间：2012-12-20T20:39:45.397
> 
> 标签：java, service, soa, design-patterns, osb

我让 Oracle Service Bus 公开了一项服务，该服务聚合了来自 3 个不同后端的响应。

最大的问题是 OSB 在响应大负载时表现非常糟糕。

如果响应有大约 20 MB 的肥皂消息，它需要在大约 700 MB 的内存中使用 xquery、xpath（由 OSB 提供的函数）进行聚合和转换！！！！（真的！）

这意味着如果 2,3 个用户同时提出请求，OOME 很快就会导致游戏结束。

那么是否有一些开源替代方案可以实现聚合器模式服务（来自多个后端的聚合肥皂响应）？

我可以通过调用其他 3 个 WS 的 WS 自己执行此操作（顺序开始，然后并行），但我想首先知道 java 中是否已经有这样的东西（如 OSB 的拆分连接），所以我不必重新发明轮子。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T05:47:43.893

Oracle OSB 的替代品是 Mulesoft ESB。

[Mulesoft.org](http://mulesoft.org)

[Mulesoft Foreach 命令](http://www.mulesoft.org/documentation/display/MULE3STUDIO/Foreach)

我与骡子没有任何关系。

# c# - 设置源数据时删除转换

> ID：13980118
> 
> 赞同：2
> 
> 时间：2012-12-20T20:39:46.430
> 
> 标签：c#, xaml, windows-8, microsoft-metro, windows-store-apps

当我将 Windows 8 应用商店应用程序中的默认模板用于项目网格时，我会在设置集合源时获得一些漂亮的过渡。如何删除这些过渡？

我正在对数据进行过滤，我不喜欢每次数据更改时数据如何淡入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:01:07.993

您可以通过覆盖 ItemContainerTransitions 来删除它们。如果将以下样式添加到页面资源中：-

```
 <Page.Resources>
    <Style x:Key="NoAnimations" TargetType="GridView">         
        <Setter Property="ItemContainerTransitions">
            <Setter.Value>
                <TransitionCollection>                        
                </TransitionCollection>
            </Setter.Value>
        </Setter>           
    </Style>
</Page.Resources> 
```

然后将gridview的样式设置为NoAnimations：

```
<GridView Grid.Row="1" Style="{StaticResource NoAnimations}"> 
```

那应该为你处理它。如果您不想丢失所有动画，那么您可以添加其中一些动画 - 这是 gridview 上的默认动画列表：-

```
<TransitionCollection>                       
    <AddDeleteThemeTransition/>
    <ContentThemeTransition/>
    <ReorderThemeTransition/>
    <EntranceThemeTransition IsStaggeringEnabled="False"/>
</TransitionCollection> 
```

# jquery - Superfish 菜单 - 如果右侧屏幕空间不足，则在左侧显示子项

> ID：13980122
> 
> 赞同：3
> 
> 时间：2012-12-20T20:39:57.803
> 
> 标签：jquery, superfish

我有 3 级菜单。当没有足够的屏幕空间来显示子菜单时，我希望子菜单向左而不是向右打开。

请查看屏幕截图以获得确切的想法。

![在此处输入图像描述](../Images/e4ba6364572ef27d0bb380937a0f26dd.png)

我想使用 superfish 菜单的 onBeforeShow() 函数来解决这个问题，但我无法让它按需要工作。

到目前为止，这是我的代码：

```
$("ul.sf-menu").superfish({
    delay: 1000,
    speed: 'fast',
    disableHI: true,
    onBeforeShow: function()
    {
      thisWidth = $(this).width();
      if  ( thisWidth > 0 ) 
      {
        thisParent = this.parent();
        parentLeft = thisParent.offset().left;
        parentWidth = this.parent().width();
        parentRight = parentWidth + parentLeft ;

        mainLeft =  document
          .getElementsByClassName('sf-menu')[0].offsetLeft;

        mainRight = document
          .getElementsByClassName('sf-menu')[0].offsetWidth;

        if  ( ( thisWidth + parentLeft ) < ( mainLeft + mainRight ) )   
        {
          if  ( thisWidth > ( parentLeft + parentHeight ) ) 
          {
            $(this).css('left', - (parentLeft - mainLeft));
          } 
          else 
          {
            // open left
            $(this).css('left', - (thisWidth - parentWidth));
          }
        }
      }
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-27T02:20:18.080

我目前正在使用此代码来解决我工作的网站上的问题：

```
onBeforeShow: function() {
   if($(this).parents("ul").length > 1){
      var w = $(window).width();  
      var ul_offset = $(this).parents("ul").offset();
      var ul_width = $(this).parents("ul").outerWidth();

      // Shouldn't be necessary, but just doing the straight math
      // on dimensions can still allow the menu to float off screen
      // by a little bit.
      ul_width = ul_width + 50;

      if((ul_offset.left+ul_width > w-(ul_width/2)) && (ul_offset.left-ul_width > 0)) {
         $(this).addClass('too_narrow_fix');
      }
      else {
         $(this).removeClass('too_narrow_fix');
      }
   };
} 
```

这是它应用的CSS：

```
.too_narrow_fix {
   left: -14.5em !important;
   top: .5em  !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-14T13:14:20.347

虽然这是很老的帖子，但我正在分享一个对我有用的解决方案，因为它可以帮助某人并节省时间。我在使用最新的 jquery superfish menu 1.7.9 时遇到了这个问题。我在那个论坛中找到了另一个 jquery 插件“假设”来解决这个问题。

```
(function($) { //create closure so we can safely use $ as alias for jQuery

  $(document).ready(function() {

    // initialise plugin
    var example = $('#example').superfish({
      //add options here if required                    
    }).supposition();

  });

})(jQuery); 
```

[jsfiddle 链接](https://jsfiddle.net/2hmeLw8g/5/) [1 jsfiddle 链接2](https://jsfiddle.net/2hmeLw8g/9/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-11T00:31:18.797

使用 CSS 快速修复。

```
ul.genesis-nav-menu li.menu-item:last-child .sub-menu {
    right: 0;
} 
```

# javascript - Backbone.js - 如何处理具有相同 id 和类型的多个模型？或者如何避免这种情况

> ID：13980124
> 
> 赞同：3
> 
> 时间：2012-12-20T20:40:11.400
> 
> 标签：javascript, backbone.js, models, backbone-relational

我最近遇到了一些情况，页面上有多个视图需要由单个模型支持。这样，只需修改模型，所有相关视图都会自动更新其外观。问题是，为了实现这个 atm，我需要编写代码来主动寻找这些模型。我偶尔会很幸运，并通过事件处理程序为我提供了一个模型，但通常情况并非如此。我正在寻找一种在页面上一次拥有一个模型实例的好方法，然后在其他任何地方都引用该模型。人们通常如何处理这种需求？Backbone-relational 通过使用草地椅.js 保持一个中央存储来处理它，我听说有人使用一个全局集合来保存所有模型的注册表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T20:47:03.910

**简短的回答：**

一个由多个视图共享的模型（您可以称之为“重复模型”）实际上是一种完全有效（且有用）的主干模式；这根本不是问题。据我所知，这里的问题是很难将该模型放入多个视图中，因此我建议改为解决这个问题。

**更长的答案：**

将模型传递给多个视图的问题在于它固有地将视图耦合在一起（为了向每个视图提供该共享模型，父视图也需要具有该模型，就像任何“中间”视图一样）。现在，作为程序员，我们被教导要尽可能地封装事物，因此耦合视图一开始可能看起来“错误”。然而，耦合视图实际上是可取的：关键是适当地限制*哪些*视图是耦合的。

@Shauna 为此提出了一个很好的经验法则：“视图只关心自己并创建它的孩子。” 如果你遵循这条规则，你的视图之间的耦合不会成为问题，你将能够创建灵活、可维护的代码（比使用全局变量更易于维护，因为那样你*真的*会失去封装）。

鉴于这一切，让我们看一个简单的例子。假设您有视图 A、B 和 C，它们都使用模型 X，但是您在代码中完全不同的位置构建 A、B 和 C（使得它们之间难以共享 X）。

1) 首先，我会看看为什么 A、B 和 C 建在如此不同的位置，看看我是否不能将它们靠得更近。

2）如果它们必须建得如此之远，那么我会看看它们是否有我可以利用的共同点；例如，所有这些点是否都共享一些相关的对象？如果是这样，那么也许我们可以将 X 放在那个对象上，以便与我们所有的视图共享它。

2) 如果 A、B 和 C 之间的代码放置或公共变量没有联系，那么我不得不问“我真的应该在它们之间共享一个模型吗？”

**关于作者的无聊故事：**

当我第一次开始使用 Backbone 时，我经常会发现自己和同事争论，因为我想做全局变量，他们坚决反对。我试图向他们解释，如果我不能使用全局变量，我必须将模型从视图 A 传递到视图 B，再到视图 C，再到视图 D，再到视图 E，而实际上只有 E 需要该模型。太浪费了！

除了（正如我从那以后了解到的），我错了。至少从可维护性的角度来看，全局变量是一个可怕的想法。一旦你开始使用它们，你很快就不知道是什么代码在影响什么，因为你失去了通常在使用该全局变量的视图之间的封装。如果您正在处理一个有意义的大型项目（即值得使用 Backbone 的项目），封装是保持代码健全的唯一方法之一。

在这期间经常使用 Backbone，我现在坚信正确的答案是在创建模型时将模型传递给视图。这可能意味着在不直接使用它们的中间视图之间传递模型，但这样做会比通过全局传递模型提供更好、更易于维护的代码。一开始可能会觉得很尴尬，但在创建模型时将模型传递给视图是正确的做法。

一旦您对 Backbone 更加熟悉，您可能会发现您很少需要通过多个中间视图传递模型。事实上，您可能会注意到，每当您发现自己必须在多个视图之间传递模型时，您就会检测到“代码异味”，而真正的问题是您的代码需要重构。

但与 Stack Overflow 上的其他所有内容一样，您的里程可能会有所不同；-)

# apache2 - Apache 提供旧版本的文件

> ID：13980127
> 
> 赞同：7
> 
> 时间：2012-12-20T20:40:33.177
> 
> 标签：apache2, cache-control

我在 localhost 上调试 js 代码，我需要防止浏览器缓存文件。我不能使用附加到 url 的时间戳，因为它会删除 chrome 调试器断点。

通常我不必刷新缓存，但过段时间每个人都会这样做。这是一个大问题，因为我去其他地方寻找错误。我前段时间将此代码添加到apache：

```
 <IfModule mod_headers.c>
            Header add Expires "Sun, 19 Nov 1978 05:00:00 GMT"
            Header add Cache-Control "no-store, no-cache, must-revalidate, post-check=0, pre-check=0"
    </IfModule> 
```

有人能解释一下为什么 Apache 会误认为一个文件是有效的，或者在配置代码中提供一些可以一劳永逸地解决这个问题的附加内容吗？

使用以下解决方案的标头：

```
<IfModule mod_expires.c>
  expiresActive On
  ExpiresDefault "access plus 1 seconds"
  ExpiresByType text/html "access plus 1 seconds"
  ExpiresByType text/javascript "access plus 1 seconds"
  ExpiresByType application/x-javascript "access plus 1 seconds"
</IfModule>

http://localhost/static/images/%d0%9a%d0%be%d0%bf%d0%b8%d1%8f%20logo_inner.png

GET /static/images/%d0%9a%d0%be%d0%bf%d0%b8%d1%8f%20logo_inner.png HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://localhost/static/images/
Cache-Control: max-age=0

HTTP/1.1 200 OK
Date: Sun, 23 Dec 2012 19:33:20 GMT
Server: Apache/2.2.22 (Ubuntu)
Last-Modified: Thu, 28 Jun 2012 17:32:51 GMT
Etag: "b3c27-f1f-4c38bb88d96c0"
Accept-Ranges: bytes
Content-Length: 3871
Expires: Sun, 19 Nov 1978 05:00:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive
Content-Type: image/png

HTTP/1.1 200 OK
Date: Sun, 23 Dec 2012 19:33:54 GMT
Server: Apache/2.2.22 (Ubuntu)
Last-Modified: Thu, 28 Jun 2012 17:32:51 GMT
Etag: "b3c27-f1f-4c38bb88d96c0"
Accept-Ranges: bytes
Content-Length: 3871
Cache-Control: max-age=1
Expires: Sun, 23 Dec 2012 19:33:55 GMT
Keep-Alive: timeout=15, max=100
Connection: Keep-Alive
Content-Type: image/png

The second request:

http://localhost/static/images/%d0%9a%d0%be%d0%bf%d0%b8%d1%8f%20logo_inner.png

GET /static/images/%d0%9a%d0%be%d0%bf%d0%b8%d1%8f%20logo_inner.png HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://localhost/static/images/
If-Modified-Since: Thu, 28 Jun 2012 17:32:51 GMT
If-None-Match: "b3c27-f1f-4c38bb88d96c0"
Cache-Control: max-age=0

HTTP/1.1 304 Not Modified
Date: Sun, 23 Dec 2012 19:34:58 GMT
Server: Apache/2.2.22 (Ubuntu)
Connection: Keep-Alive
Keep-Alive: timeout=15, max=99
Etag: "b3c27-f1f-4c38bb88d96c0"
Expires: Sun, 23 Dec 2012 19:34:59 GMT
Cache-Control: max-age=1 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-23T20:47:58.830

传递静态文件时，Apache 会发送一个 ETag 标头，类似于文件的校验和。浏览器将缓存该文件并记住与下一个请求一起发送的 ETag。

如果文件更改浏览器 ETag 应该不同并且网络服务器应该重新发送，当 etag 相等时，网络服务器将响应`304 Not Modified`. ETag 机制比其他缓存头具有更高的优先级。

要禁用 etags，您可以使用 apaches

```
FileETag None 
```

[http://httpd.apache.org/docs/current/en/mod/core.html#fileetag](http://httpd.apache.org/docs/current/en/mod/core.html#fileetag)

维基百科有一篇关于 Etag 标头的好文章 [http://en.wikipedia.org/wiki/HTTP_ETag](http://en.wikipedia.org/wiki/HTTP_ETag)

**编辑**

这应该是防水配置

```
FileETag None
<ifModule mod_headers.c>
    Header unset ETag
    Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
</ifModule> 
```

不要忘记配置更改需要重新启动服务器才能生效。

```
sudo /etc/init.d/httpd restart 
```

**编辑2**

围绕配置包装 filesMatch 以仅禁用特定文件扩展名的缓存

```
<filesMatch ".(php|js|css)$">
    FileETag None
    [..]
</filesMatch> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T06:37:27.103

如果我正确理解您的要求，您希望 Web 浏览器不记得您正在访问的网页的任何内容，并且您的 apache Web 服务器应该将其视为新页面请求。您可能首先要启用 mod_expires 和 mod_headers ，我使用 ubuntu 所以我的是

```
a2enmod headers && a2enmod expires && service apache2 restart 
```

比你想添加下面的代码来做最小的缓存控制，

```
<IfModule mod_expires.c>
  expiresActive On
  ExpiresDefault "access plus 1 seconds"
  ExpiresByType text/html "access plus 1 seconds"
  ExpiresByType text/javascript "access plus 1 seconds"
  ExpiresByType application/x-javascript "access plus 1 seconds"
</IfModule> 
```

如果你使用的是 firefox，你可以通过安装/运行 Live Http header Plugin 来测试它，或者如果你是 linux/unix，你可以使用**curl -v** your_url运行这个请求

# cloud-foundry - vmc push 应用程序报告“无法启动”但应用程序正在运行

> ID：13980132
> 
> 赞同：1
> 
> 时间：2012-12-20T20:41:03.920
> 
> 标签：cloud-foundry

我们使用 BOSH 创建了自己的内部多节点云代工厂。当我推送一个简单的 sinatra 应用程序时，它会执行显示以下几行的所有步骤：

```
Uploading hello... OK
Starting hello... OK
Checking hello... GAVE UP
Application failed to start. 
```

（当然，最后两行需要一段时间才能完成）

但是当我尝试点击应用程序 URL hello.mycloud.example.com 时，一切正常。也就是说，应用程序实际上正在运行。我查看了 dea 上的日志，果然，他们报告应用程序已启动并且系统已收到通知。

```
[2012-12-20 20:08:45.813061] dea - pid=24441 tid=40fc fid=0c65   INFO -- Starting up instance (name=hellocornelia app_id=1 instance=1e4cae7a70078687753ebc7d116de550 index=0) on port:62642
[2012-12-20 20:08:45.835886] dea - pid=24441 tid=40fc fid=47ea   INFO -- Starting up instance (name=hellocornelia app_id=1 instance=d1e1b77335f23d3ce1fe5e24caf85ed5 index=1) on port:62047
[2012-12-20 20:08:46.369563] dea - pid=24441 tid=40fc fid=23e8   INFO -- Instance (name=hellocornelia app_id=1 instance=1e4cae7a70078687753ebc7d116de550 index=0) is ready for connections, notifying system of status
[2012-12-20 20:08:46.370488] dea - pid=24441 tid=40fc fid=23e8   INFO -- Instance (name=hellocornelia app_id=1 instance=d1e1b77335f23d3ce1fe5e24caf85ed5 index=1) is ready for connections, notifying system of status
[2012-12-20 20:08:46.873075] dea - pid=24441 tid=40fc fid=23e8   INFO -- PID:22404 assigned to droplet instance: (name=hellocornelia app_id=1 instance=1e4cae7a70078687753ebc7d116de550 index=0)
[2012-12-20 20:08:46.873591] dea - pid=24441 tid=40fc fid=23e8   INFO -- PID:22410 assigned to droplet instance: (name=hellocornelia app_id=1 instance=d1e1b77335f23d3ce1fe5e24caf85ed5 index=1) 
```

运行启用了跟踪的 vmc 应用程序显示：

```
{
"name": "hello",
"staging": {
  "model": "sinatra",
  "stack": "ruby18"
},
"uris": [
  "hello.cloudad.sccf.lab.emc.com"
],
"instances": 1,
"runningInstances": 0,
"resources": {
  "memory": 128,
  "disk": 2048,
  "fds": 256
},
"state": "STARTED",
"services": [

],
"version": "966c1f76a126696d09db9f49405f42130f72cbc3-1",
"env": [

],
"meta": {
  "debug": null,
  "console": null,
  "version": 3,
  "created": 1356035779
}
}
]
<<<
... OK
name    status   usage      runtime   url
hello   0%       1 x 128M   ruby18    hello.cloudad.sccf.lab.emc.com 
```

这是可以预料的，因为系统不知道应用程序正在运行。我检查了云控制器和运行状况管理器日志，似乎找不到任何迹象表明哪里出了问题。有什么提示吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T22:26:16.697

我会检查你的健康经理。健康管理器日志会很有帮助。它甚至可能没有运行。请通过以下方式检查您的虚拟机状态

```
bosh vms 
```

如果您的运行状况管理器正在运行，我会通过 ssh 进入它并检查位于 /var/vcap/sys 位置的日志

```
bosh ssh <component-name> <index> 
```

IE

```
 bosh ssh health_manager 0 
```

我会说你的健康经理很可能有问题。由于一切正常，但您没有在客户端（vmc）中看到它

# android - 如何获取每个不同值的计数（SQLite Query - Android）

> ID：13980134
> 
> 赞同：2
> 
> 时间：2012-12-20T20:41:18.813
> 
> 标签：android, sqlite

我了解如何创建查询以仅查找不同的值，但我想计算每个不同的值有多少。

所以我的代码示例，在我的数据库助手中，它只是给了我一个不同值的列表：

```
public Cursor fetchDamagedComponentSpecForInspection(long inspectionId, String componentType) {
    Cursor mCursor =
            rmDb.query(true, DAMAGED_COMPONENTS_TABLE, new String[] {
                    DAMAGED_COMPONENT_ID,
                    LOCATION_LINK,
                    RUN_LINK,
                    AREA_LINK,
                    INSPECTION_LINK,
                    LOCATION_REF,
                    RACKING_SYSTEM,
                    COMPONENT,
                    COMPONENT_TYPE,
                    QUANTITY,
                    POSITION,
                    RISK,
                    ACTION_REQUIRED,
                    NOTES_GENERAL,
                    MANUFACTURER,
                    TEXT1,
                    TEXT2,
                    TEXT3,
                    TEXT4,
                    NOTES_SPEC,
                    SPEC_SAVED}, 
                    INSPECTION_LINK + " = " + inspectionId + " AND " + COMPONENT_TYPE + " = ? AND " + SPEC_SAVED + " = ? ", 
                    new String[] {componentType, "Yes"},
                    MANUFACTURER + ", " + TEXT1 + ", " + TEXT2 + ", " + TEXT3 + ", " + TEXT4 + ", " + NOTES_SPEC, 
                    null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
} 
```

所以这将返回一个类似的列表：

```
Dexion, M Duty, 3000mm, Blue
Hi-lo, Rackplan, 4000mm, Blue
PSS, P85 1.6, 4500mm, Blue 
```

但我想知道每个值有多少（即有多少'Dexion，M Duty，3000mm，Blue'条目，所以输出看起来有点像这样：

```
2 x Dexion, M Duty, 3000mm, Blue
5 x Hi-lo, Rackplan, 4000mm, Blue
1 x PSS, P85 1.6, 4500mm, Blue 
```

CommonsWare 建议了一篇提供以下解决方案的帖子：

```
select type, count(type) from table group by type; 
```

但是，我不确定如何将它与我正在使用的查询类型集成到我现有的代码中。

编辑-以下是我尝试集成此计数功能但没有成功：

```
public Cursor fetchDamagedComponentSpecForInspection(long inspectionId, String componentType) {
    Cursor mCursor =
            rmDb.query(true, DAMAGED_COMPONENTS_TABLE, new String[] {
                    DAMAGED_COMPONENT_ID,
                    LOCATION_LINK,
                    RUN_LINK,
                    AREA_LINK,
                    INSPECTION_LINK,
                    LOCATION_REF,
                    RACKING_SYSTEM,
                    COMPONENT,
                    COMPONENT_TYPE,
                    QUANTITY,
                    POSITION,
                    RISK,
                    ACTION_REQUIRED,
                    NOTES_GENERAL,
                    MANUFACTURER,
                    TEXT1,
                    TEXT2,
                    TEXT3,
                    TEXT4,
                    NOTES_SPEC,
                    SPEC_SAVED}, 
                    INSPECTION_LINK + " = " + inspectionId + " AND " + COMPONENT_TYPE + " = ? AND " + SPEC_SAVED + " = ? ", 
                    new String[] {componentType, "Yes"},
                    MANUFACTURER + ", " + TEXT1 + ", " + TEXT2 + ", " + TEXT3 + ", " + TEXT4 + ", " + NOTES_SPEC + 
                    ", Count (*) AS count", 
                    null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
} 
```

也无法理解我是如何在我的主代码中实际检索到它的（下面是我目前如何获取信息）：

```
 manufacturer = RMUtilities.notEmpty(cursor.getString(cursor.getColumnIndex(RMDbAdapter.MANUFACTURER)),"");
        text_1 = RMUtilities.notEmpty(cursor.getString(cursor.getColumnIndex(RMDbAdapter.TEXT1)),"");
        text_2 = RMUtilities.notEmpty(cursor.getString(cursor.getColumnIndex(RMDbAdapter.TEXT2)),"");
        text_3 = RMUtilities.notEmpty(cursor.getString(cursor.getColumnIndex(RMDbAdapter.TEXT3)),"");
        text_4 = RMUtilities.notEmpty(cursor.getString(cursor.getColumnIndex(RMDbAdapter.TEXT4)),"");
        spec_notes = RMUtilities.notEmpty(cursor.getString(cursor.getColumnIndex(RMDbAdapter.NOTES_SPEC)),""); 
```

但是我如何获取计数值呢？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T16:42:47.763

从我的代码：

```
String w = myColumn + "like ?"
String [] args = { myData }
c = ourDatabase.query(DATABASE_TABLE, columns, w, args, null, null, null);
int count = c.getCount(c.getColumnIndex(myColumn)); 
```

# firebird - 选择插入的“当前没有获取操作的记录”

> ID：13980136
> 
> 赞同：4
> 
> 时间：2012-12-20T20:41:22.217
> 
> 标签：firebird, firebird1.5

谁能看到为什么我在下面得到“没有获取操作的当前记录”？

通过捕获而不是重新抛出下面的唯一键违规异常，我成功地跳过了重复记录。然而还有另一个错误。

```
FOR SELECT 
  ...
FROM
  P_SELECT_CLAIM_FILE cf
ORDER BY
  cf.DATESBM, cf.TIMESBM, cf.TRANSCDE
INTO
  ...variables
DO BEGIN

  INSERT INTO
   CLAIM_TABLE (...)
    VALUES (...variables);

  WHEN GDSCODE unique_key_violation DO
    TX_ID=0;

  WHEN GDSCODE no_cur_rec DO
    /* Why does this happen?
      -508 335544348 no_cur_rec No current record for fetch operation 
    */
    EXCEPTION E 'no_cur_rec ' || TX_ID;

END 
```

过程 P_SELECT_CLAIM_FILE 包含另一个 FOR SELECT INTO 有大量的修剪和最后一个 SUSPEND 命令。这从一个固定宽度的文本文件中读取。

我很想将其更改为单个 INSERT SELECT where not exists 语句。然而，我更喜欢做一个最小的修复；假期已经到了。

# canvas - 服务器后端使 2 个单独的用户 HTML Canvas 在网络游戏中保持同步

> ID：13980138
> 
> 赞同：1
> 
> 时间：2012-12-20T20:41:27.173
> 
> 标签：canvas, signalr, game-engine

嗨，我正在制作一款游戏（太空射击游戏），我正在考虑使用 .Net 的 Signal R 让用户的 HTML Canvas 在两个不同的用户之间保持同步。

因此，我希望用户 A 在其浏览器中使用画布与用户 B 的画布同步（所有游戏对象都相同）。

您认为这是一项很好的技术吗？如果是这样，你能给我一些关于最好的方法的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:04:14.410

请参阅使用 SignalR 构建的 ShootR (http://shootr.signalr.net/)。太空射手=）。

[https://github.com/NTaylorMullen/ShootR](https://github.com/NTaylorMullen/ShootR)

# sql - java sql插入

> ID：13980144
> 
> 赞同：9
> 
> 时间：2012-12-20T20:41:51.690
> 
> 标签：sql

我有一个包含 4 个字段的表格：

> id, int(11), auto increment email, varchar(32) pass, varchar(32) date_created, date

我的问题是我的查询应该是什么样子？我的意思是我不需要将第一个值插入 id 因为它是自动递增的，但我必须插入所有值..

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-20T20:48:46.357

首先，我希望您使用的是 PreparedStatements。

假设您有一个名为 conn 的 Connection 对象和两个字符串电子邮件和密码...

```
PreparedStatement stmt = conn.prepareStatement("INSERT INTO table_name(email, pass, date_created) VALUES (?, ?, ?)");

stmt.setString(1, email);
stmt.setString(2, password);
stmt.setDate(3, new Date());

stmt.executeUpdate(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T20:43:01.160

在 SQL 中，您可以指定要在`INSERT`语句中设置的列：

```
INSERT INTO table_name(email, pass, date_created) VALUES(?, ?, ?) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T20:47:51.120

您可以插入格式

```
INSERT INTO YourTable (Your Columns) VALUES (Your Values) 
```

所以例如

```
INSERT INTO Test_Table (email, pass, data_created) VALUES ('john@blah.com', 'pass', to_date(string, format)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T20:46:02.487

使用参数`tsql`- ; ***（最好在参数中传递值而不是作为字符串）***

```
Insert into [YourTableName] (email, pass, date_created) 
values (@email, @pass, @date_created) 
```

# android - 警报对话框中的按钮不可点击

> ID：13980145
> 
> 赞同：2
> 
> 时间：2012-12-20T20:41:53.443
> 
> 标签：android, android-alertdialog

我有一个警报对话框，在对话框的布局中有一个我希望可以点击的按钮，但是当我使用 onclick 侦听器时，该按钮仍然不起作用。

我的警报对话框就是这样构建的。

```
AlertDialog.Builder alert = new AlertDialog.Builder(this);

    Context mContext = getApplicationContext();
    LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(LAYOUT_INFLATER_SERVICE);
    View layout = inflater.inflate(R.layout.distro_editor_popup, (ViewGroup) findViewById(R.id.layout_root));

    txt_Name = (EditText) layout.findViewById(R.id.txt_LinuxName);
    txt_Image = (EditText) layout.findViewById(R.id.txt_ImageName);
    filemanger = (Button) layout.findViewById(R.id.fileselector); 

    txt_Name.setText(selected_Name);
    txt_Image.setText(selected_Image);

    final String oldName = selected_Name;
    final String oldImage = selected_Image;

    filemanger.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
            intent.setType("file/*");
            startActivityForResult(intent,PICKFILE_RESULT_CODE);
        }
    });

    alert.setView(layout);

    alert.setPositiveButton(R.string.dialog_button_ok, new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int whichButton) {
            String name = txt_Name.getText().toString();
            String image = txt_Image.getText().toString();

            // Make sure the user entered a name
            if (name.equals("")) {
                return;
            }

            if (!oldName.equals(name)) {
                // Name was changed so we have to delete the old one from the profiles first!
                profiles.remove(oldName);
            }

            if (!oldImage.equals(image)) {
                // Image name has changed so we rename the mounts and config files
                file_Rename(oldImage + ".mounts", image + ".mounts");
                file_Rename(oldImage + ".config", image + ".config");
            }

            profiles.put(name, image);
            lastSelected = name;

            fillSpinner();
            savePrefs();
        }
    });
    alert.setNegativeButton(R.string.dialog_button_cancel, new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int whichButton) {
        }
    });

    alert.show(); 
```

然后对话框的 XML 布局是：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/layout_root"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp"
>

<RelativeLayout android:layout_alignBaseline="@+id/layout_root" android:layout_height="wrap_content" android:layout_width="fill_parent" android:layout_marginTop="8sp" android:id="@+id/RelativeLayout1">
    <TextView
        android:id="@+id/label_Name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/inputLabel_Name"
        android:layout_centerVertical="true"/>

    <EditText
        android:id="@+id/txt_LinuxName"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/label_Name"
        android:hint="@string/hint_EnterName"
        android:textColor="#FF111111" >

        <requestFocus></requestFocus>
    </EditText>
</RelativeLayout>

<RelativeLayout
    android:id="@+id/RelativeLayout3"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/layout_root"
    android:layout_marginTop="8sp" >

    <TextView
        android:id="@+id/label_Image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:text="@string/launcher_Label_ImageName" />

    <EditText
        android:id="@+id/txt_ImageName"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@+id/fileselector"
        android:layout_toRightOf="@id/label_Image"
        android:textColor="#FF111111" >

        <requestFocus></requestFocus>
    </EditText>

    <Button
        android:id="@+id/fileselector"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/txt_ImageName"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:text="..." />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:00:59.663

这只是一个猜测，因此可能是错误的，但是当您设置 时`onClickListener`，请尝试将行替换`fileSelector.setOnClickListener(new OnClickListener)`为`fileSelector.setOnClickListener(new View.OnClickListener)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:45:43.673

您没有在否定按钮上调用驳回：

```
alert.setNegativeButton(R.string.dialog_button_cancel, new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
          dialog.dismiss();
    }
}); 
```

至于积极的一面，你`onClick`被解雇了吗？把Log语句放进去看看是不是。

# .net - 在 SQL Server 中共享来自单个数据库（模拟 GAC）的程序集

> ID：13980151
> 
> 赞同：4
> 
> 时间：2012-12-20T20:42:03.060
> 
> 标签：.net, sql-server, sql-server-2005, user-defined-functions, sqlclr

SQL Server 版本：2005

.NET 版本：3.5

我正在尝试使用关于内存和性能的最有效方法来使用 CLR UDF。因此，SQL Server 似乎带有来自 GAC 的预加载 .NET 程序集。但是，SQL Server 禁止您将自定义程序集从 GAC 加载到您的 SQL 数据库。为了找到解决此问题的替代方法，我通过在每个数据库上加载程序集来试验 SQL CLR，并使用我的 CLR UDF 运行 SQL 查询，以发现每个数据库都分配有自己的 appdomain。此外，每个 appdomain 都会加载程序集的副本（我的主程序集及其依赖项）。说得通。

好的，然后我尝试将程序集创建到单个数据库中，然后通过其他数据库中的 dbname.dbo.clrudfname 引用 CLR UDF 以找到一些有趣的东西。加载的唯一 appdomain 属于托管程序集的数据库。此外，加载的唯一程序集是那些托管在该 appdomain 中的程序集。此外，引用另一个数据库的程序集与托管自己的副本的数据库相比，性能几乎相同。

有没有人认为这种方法在更有效地管理 CLR 内存方面存在问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T20:57:56.567

没有理由在同一数据库服务器上有重复的程序集。这只是需要维护的额外副本。

创建一个名为 Utilities（或 CLR 或其他）的数据库并将 CLR 放在那里。然后，您可以使用服务器上任何数据库中的 3 部分名称 (db.schema.object) 来引用它们。

由于您使用的是 CLR，我建议您在此处查看 David Wiseman 的 IO Utility 解决方案：http: [//www.wisesoft.co.uk/articles/sql_server_clr_io_utility.aspx](http://www.wisesoft.co.uk/articles/sql_server_clr_io_utility.aspx)

它非常适合将文件系统与 T-SQL 集成。它也非常适合初学者学习如何构建 CLR。

# c++ - 如何从已经运行的 GUI 应用程序中启动带有 GUI 的可执行文件

> ID：13980156
> 
> 赞同：3
> 
> 时间：2012-12-20T20:42:18.033
> 
> 标签：c++, macos, osx-mountain-lion

我有一个在 OS X 中运行的应用程序，它需要启动另一个带有 GUI 的可执行文件，然后自行关闭，使另一个 GUI 完好无损。

现在，我正在使用**fork**启动另一个可执行文件，然后执行**execve**并关闭启动它的应用程序，但新的可执行文件将菜单栏与刚刚关闭的应用程序隔离开来。这会阻止我运行原始应用程序，直到我关闭可执行文件的窗口。

我发现的唯一一件事是人们说要使用**nohup**但据我了解，当父母关闭时，它只会阻止程序关闭？

**编辑**：查看第一个答案中的功能后，我意识到我应该包含更多细节。我正在使用 OS X 10.8，它似乎已经弃用了很多文件管理器 API。另一个重要的细节是我需要将命令行参数传递给可执行文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T23:44:41.033

可可的方式是`-[NSWorkspace launchApplication:]`。在略低的水平，但仍远高于 BSD，有`LSOpenApplication`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T15:15:13.953

事实证明，我试图启动的可执行文件最初位于另一个应用程序包中，正在使用**plist**文件来启动可执行文件的应用程序。我在原始应用程序的可执行文件所在的 Contents/MacOS 文件夹中有可执行文件。将其他可执行文件放入其自己的应用程序包中后，我能够在其自己的包中的可执行文件上使用**fork**和**execve**来正确启动它。

# c++ - 具有模板成员变量的 C++ 类

> ID：13980157
> 
> 赞同：31
> 
> 时间：2012-12-20T20:42:21.550
> 
> 标签：c++, templates, types

我正在尝试解决一个由包含多个参数的对象（称为图表）组成的编程问题。每个参数（Parameter 类）可以是以下几种类型之一：int、double、complex、string - 仅举几例。

所以我的第一个直觉是将我的 Diagram 类定义为具有模板参数的向量，看起来像这样。

```
class Diagram
{
private:
    std::vector<Parameter<T> > v;
}; 
```

这不编译，我明白为什么。因此，根据此页面上的建议[如何声明类中任何类型的对象的数据成员，](https://stackoverflow.com/questions/6261375/how-to-declare-data-members-that-are-objects-of-any-type-in-a-class)我将代码修改为：

```
class ParameterBase
{
public:
    virtual void setValue() = 0;
    virtual ~ParameterBase() { }
};

template <typename T>
class Parameter : public ParameterBase
{
public:
    void setValue() // I want this to be 
                    // void setValue(const T & val)
    {
        // I want this to be 
        // value = val;
    }

private:
    T value;
};

class Diagram
{
public:
    std::vector<ParameterBase *> v;
    int type;
}; 
```

我无法弄清楚如何使用适当的模板化参数调用 setValue 函数。在 ParameterBase 抽象基类中不可能有模板化参数。任何帮助是极大的赞赏。

PS 我没有使用 boost::any 的灵活性。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-20T21:21:15.230

你离得很近。我添加了一些位，因为它们很方便

```
class ParameterBase
{
public:
    virtual ~ParameterBase() {}
    template<class T> const T& get() const; //to be implimented after Parameter
    template<class T, class U> void setValue(const U& rhs); //to be implimented after Parameter
};

template <typename T>
class Parameter : public ParameterBase
{
public:
    Parameter(const T& rhs) :value(rhs) {}
    const T& get() const {return value;}
    void setValue(const T& rhs) {value=rhs;}    
private:
    T value;
};

//Here's the trick: dynamic_cast rather than virtual
template<class T> const T& ParameterBase::get() const
{ return dynamic_cast<const Parameter<T>&>(*this).get(); }
template<class T, class U> void ParameterBase::setValue(const U& rhs)
{ return dynamic_cast<Parameter<T>&>(*this).setValue(rhs); }

class Diagram
{
public:
    std::vector<ParameterBase*> v;
    int type;
}; 
```

然后，图表可以执行以下操作：

```
Parameter<std::string> p1("Hello");
v.push_back(&p1);
std::cout << v[0]->get<std::string>(); //read the string
v[0]->set<std::string>("BANANA"); //set the string to something else
v[0]->get<int>(); //throws a std::bad_cast exception 
```

看起来您的意图是将拥有资源的指针存储在向量中。如果是这样，请注意使`Diagram`具有正确的析构函数，并使其不可复制构造和不可复制分配。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T21:02:45.657

下面的实现使用了一些 C++11 特性，但您可以将它们分开。

```
#include <vector>
#include <memory>

class Parameter
{
private:
  class ParameterBase {
  public:
    virtual ~ParameterBase() {}
    virtual ParameterBase* copy() = 0;
    virtual void foo() = 0;
  };

  template <typename T>
  class ParameterModel : public ParameterBase {
  public:
    // take by value so we simply move twice, if movable
    ParameterModel(const T& t) : t(t) {}
    ParameterModel(T&& t) : t(t) {}
    void foo() { t.foo(); }
    ParameterModel* copy() { return new ParameterModel(*this); }
  private:
    T t;
  };

public:
  template <typename T>
  Parameter(T&& t) 
    : pp(new ParameterModel< typename std::remove_reference<T>::type >(std::forward<T>(t))) {}

  // Movable and Copyable only
  Parameter(Parameter&&) = default;
  Parameter& operator=(Parameter&&) = default;

  Parameter(const Parameter& other) : pp(other.pp->copy()) {};
  Parameter operator=(const Parameter& other) {
    pp.reset(other.pp->copy());
    return *this;
  };

  // members

  void foo() { pp->foo(); }
private:
  std::unique_ptr<ParameterBase> pp;
};

class Diagram
{
public:
  std::vector<Parameter> v;
  int type;
};

struct X {
  void foo() {}
};

struct Y {
  void foo() {}
};

int main()
{
  Diagram d;
  d.v.emplace_back(X()); // int

  // parameters are copyable and can be reassigned even with different
  // impls
  Parameter p = d.v.back();

  Parameter other((Y()));
  other = p;
  return 0;
} 
```

这段代码有什么作用？它隐藏了我们使用继承来实现用户参数的事实。他们只需要知道我们需要一个名为 的成员函数`foo`。这些要求在我们的`ParameterBase`. 您需要确定这些要求并将其添加到`ParameterBase`. 这基本上是一个更严格的`boost::any`.

它也非常接近[Sean Parent 的价值语义](http://isocpp.org/blog/2012/12/value-semantics-and-concepts-based-polymorphism-sean-parent)演讲中描述的内容。

# php - CakePHP 中的片段系统？

> ID：13980158
> 
> 赞同：1
> 
> 时间：2012-12-20T20:42:22.767
> 
> 标签：php, cakephp, fragment

我想知道 CakePHP 是否有类似于 Ruby on Rails 中的片段的东西？

我在[这里](http://book.cakephp.org/2.0/en/views.html#displaying-blocks)找到了一些东西，但是，当我`test.ctp`在`Elements`文件夹中尝试这个时

```
<?php echo $this->fetch("/Elements/test"); ?> 
```

什么都没发生。

我做错了什么还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:06:19.907

## 元素不是那样工作的

[我假设元素](http://book.cakephp.org/2.0/en/views.html#elements)相当于片段。[element](http://api.cakephp.org/class/view#method-Viewelement)方法用于返回元素的内容（包含一大块视图代码的文件）：

```
echo $this->element('some'); // output View/Elements/some.ctp 
```

## Fetch 用于返回视图块

[Fetch](http://api.cakephp.org/class/view#method-Viewfetch)是一种用于返回视图块内容的方法 - 一些预渲染的，在内存中的字符串：

```
// app/View/Common/view.ctp
<h1><?php echo $this->fetch('title'); ?></h1>
<?php echo $this->fetch('content'); ?>

<div class="actions">
    <h3>Related actions</h3>
    <ul>
    <?php echo $this->fetch('sidebar'); ?>
    </ul>
</div> 
```

# python - 多处理 - 生产者/消费者设计

> ID：13980160
> 
> 赞同：7
> 
> 时间：2012-12-20T20:42:30.397
> 
> 标签：python, multiprocessing

我正在使用多处理模块来拆分一个非常大的任务。它在大多数情况下都有效，但我的设计肯定遗漏了一些明显的东西，因为这样我很难有效地判断何时处理了所有数据。

我有两个单独的任务运行；一个喂另一个。我想这是一个生产者/消费者问题。我在所有进程之间使用共享队列，生产者填满队列，消费者从队列中读取并进行处理。问题是数据量是有限的，所以在某些时候每个人都需要知道所有数据都已处理，以便系统可以正常关闭。

使用 map_async() 函数似乎很有意义，但是由于生产者正在填满队列，所以我不知道前面的所有项目，所以我必须进入一个 while 循环并使用 apply_async()并尝试检测何时一切都以某种超时完成......丑陋。

我觉得我错过了一些明显的东西。如何更好地设计？

生产者

```
class ProducerProcess(multiprocessing.Process):
    def __init__(self, item, consumer_queue):
        self.item = item
        self.consumer_queue = consumer_queue
        multiprocessing.Process.__init__(self)

    def run(self):
        for record in get_records_for_item(self.item): # this takes time
            self.consumer_queue.put(record)

def start_producer_processes(producer_queue, consumer_queue, max_running):
    running = []

    while not producer_queue.empty():
        running = [r for r in running if r.is_alive()]
        if len(running) < max_running:
            producer_item = producer_queue.get()
            p = ProducerProcess(producer_item, consumer_queue)
            p.start()
            running.append(p)
        time.sleep(1) 
```

消费者

```
def process_consumer_chunk(queue, chunksize=10000):
    for i in xrange(0, chunksize):
        try:
            # don't wait too long for an item
            # if new records don't arrive in 10 seconds, process what you have
            # and let the next process pick up more items.

            record = queue.get(True, 10)
        except Queue.Empty:                
            break

        do_stuff_with_record(record) 
```

主要的

```
if __name__ == "__main__":
    manager = multiprocessing.Manager()
    consumer_queue = manager.Queue(1024*1024)
    producer_queue = manager.Queue()

    producer_items = xrange(0,10)

    for item in producer_items:
        producer_queue.put(item)

    p = multiprocessing.Process(target=start_producer_processes, args=(producer_queue, consumer_queue, 8))
    p.start()

    consumer_pool = multiprocessing.Pool(processes=16, maxtasksperchild=1) 
```

这是它变得俗气的地方。我不能使用地图，因为要消费的列表同时被填满。所以我必须进入一个while循环并尝试检测超时。当生产者仍在尝试填充它时，consumer_queue 可能会变空，所以我不能只检测到一个空队列并就此退出。

```
 timed_out = False
    timeout= 1800
    while 1:
        try:
            result = consumer_pool.apply_async(process_consumer_chunk, (consumer_queue, ), dict(chunksize=chunksize,))
            if timed_out:
                timed_out = False

        except Queue.Empty:
            if timed_out:
                break

            timed_out = True
            time.sleep(timeout)
        time.sleep(1)

    consumer_queue.join()
    consumer_pool.close()
    consumer_pool.join() 
```

我想也许我可以 get() 主线程中的记录并将它们传递给消费者而不是传递队列，但我认为我最终会遇到同样的问题。我仍然需要运行一个 while 循环并使用 apply_async() 提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:49:49.560

您可以使用 a`manager.Event`来表示工作的结束。此事件可以在您的所有进程之间共享，然后当您从主进程发出信号时，其他工作人员可以正常关闭。

```
while not event.is_set():
 ...rest of code... 
```

因此，您的消费者将等待事件设置并在设置后处理清理。

要确定何时设置此标志，您可以`join`在生产者线程上执行 a，当这些都完成时，您可以加入消费者线程。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T21:17:31.250

我强烈推荐[SimPy](http://simpy.sourceforge.net/)而不是多进程/线程来进行**离散**事件模拟。

# database - 通过 http 或 web 服务的数据库查询代理

> ID：13980162
> 
> 赞同：0
> 
> 时间：2012-12-20T20:42:36.857
> 
> 标签：database, web-services, entity-framework, proxy

我已经看到了通过 http 和 web 服务接口等查询数据库的各种方案。很好奇是否有某种标准，以及一种在客户端将其公开为普通数据库连接的方法。

例如：可以让我定义一个数据库连接，然后可以在客户端代码中与实体框架连接一起使用。然后我可以对它发出查询，使其看起来就像一个普通的数据库连接。

# reporting-services - AX 2012 SSRS 报告可见性问题

> ID：13980164
> 
> 赞同：0
> 
> 时间：2012-12-20T20:42:53.653
> 
> 标签：reporting-services, ssrs-2008, axapta, dynamics-ax-2012

在我的报告中，数据被插入到我的临时表中。问题是报告中没有显示数据。我也删除了所有隐藏和可见性表达式。

这是 ProjInvoiceReport。我添加了第二个数据集，它需要为一个字段插入多个值。数据被插入到表中，但是当我将字段放在报表上的表控件（正确的数据集）中时......什么也没有出现！

在 ProjInvoiceDP 类中，我添加了一个 get 方法

```
[
    SRSReportDataSetAttribute(tableStr(ProjInvoiceServiceOrderTmp))
]
public ProjInvoiceServiceOrderTmp getProjInvoiceServiceOrderTmp()
{
    select * from projInvoiceServiceOrderTmp;
    return projInvoiceServiceOrderTmp;
} 
```

和一个 initTempTable 方法

```
 public void initTempTableFromSMAServiceOrder(ProjTable  _projTable, ProjInvoiceId 
    _projInvoiceId)
    {
    SMAServiceOrderLine serviceOrderLine;
    ProjEmplTrans       projEmplTrans;
    ProjItemTrans       projItemTrans;

    iProjInvoiceId = _projInvoiceId;

ttsBegin;
delete_from projInvoiceServiceOrderTmp where projInvoiceServiceOrderTmp.ProjInvoiceId ==
iProjInvoiceId;
ttsCommit;

while select serviceOrderLine
    join projEmplTrans
    where serviceOrderLine.ProjTransId == projEmplTrans.TransId
        && serviceOrderLine.ProjId  ==  _projTable.ProjId
{
    if(projEmplTrans.invoiceId() == iProjInvoiceId)
    {
        projInvoiceServiceOrderTmp.clear();
        projInvoiceServiceOrderTmp.ServiceOrderId       = serviceOrderLine.ServiceOrderId;
      //  projInvoiceServiceOrderTmp.ShowFieldTicketInfo  = #True;
        projInvoiceServiceOrderTmp.ProjInvoiceId = iProjInvoiceId;
        projInvoiceServiceOrderTmp.insert();
    }
}

while select serviceOrderLine
    join projItemTrans
    where serviceOrderLine.ProjTransId == projItemTrans.ProjTransId
        && serviceOrderLine.ProjId  ==  _projTable.ProjId
{
    if(projItemTrans.invoiceId() == iProjInvoiceId)
        {
            projInvoiceServiceOrderTmp.clear();
            projInvoiceServiceOrderTmp.ServiceOrderId       = serviceOrderLine.ServiceOrderId;
          //  projInvoiceServiceOrderTmp.ShowFieldTicketInfo  = #True;
            projInvoiceServiceOrderTmp.ProjInvoiceId = iProjInvoiceId;
            projInvoiceServiceOrderTmp.insert();
        }
    }

} 
```

initTempTable 方法在 projInvoiceTmp.insert() 之前最后的 insertIntoProjInvoiceTmp 中调用。一位曾在此报告中工作过的人在同一区域调用了他们的 initTempTableFromProjTable。

insertIntoProjInvoiceTmp 在 fetch 方法中被调用。processReport 调用 fetch 方法。

知道问题是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T10:39:29.383

这可能是由一个众所周知的问题引起的：

如果客户端显示设置未设置为 100%，则某些字段不会显示。

请参阅[此 Microsoft 技术说明](http://technet.microsoft.com/en-us/library/gg231521.aspx)

尝试改变这一点 - 它立即为我工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T10:13:51.117

您是否将表 TempDB 设为临时表？

您是否对课程进行了适当的更改`ProjInvoiceDP`，制作了新方法？

```
[SRSReportDataSetAttribute(tableStr(MyTmp))]
public MyTmp getMyTmp()
{
    select myTmp;
    return myTmp;    
} 
```

# javascript - javascript api 简化

> ID：13980167
> 
> 赞同：1
> 
> 时间：2012-12-20T20:43:27.187
> 
> 标签：javascript, api, document-ready

正在使用fourquare api获取场地，之前有一个从api写出的可点击列表，但将其缩减为仅写入屏幕的一个场地名称。然后决定最好将其发送到php。所以当我做了我认为是逻辑切割代码的事情时，它完全停止了工作。

我的程序有这个，工作：

```
$(document).ready(function doEverything(element) {
    $.getJSON("https://api.foursquare.com/v2/venues/search?ll=" + lat + "," + lng + "&client_id=L2VWBKPOW45D5X3FJ3P4MJB5TGVJ4ST2J005RIVAFIWG44ND%20&client_secret=ZKDAOLHASCA31VUOGMBTAS3RFYUOMXL4IFFYPRURIDQA3QMA%20&v=20111107", function(data) {
        one = data.response.venues[0].name;
        var list = [];
        list[0] = [one];

        function Make() {
            for (var i = 0; i < 1; i++) {
                var div = document.createElement("div");
                div.style.margin = "-435px 100px 0px 110px";
                div.innerHTML = list[i];
                !
                function() {
                    var index = 0;
                    div.onclick = function() {
                        doSomething(this);
                    };
                }();
                document.body.appendChild(div);
            }
        }

        function doSomething(element) {
            var value = element.innerHTML;
            switch (value) {
            case one:
                break;
            }
        }
        Make();
    });
}); 
```

然后我决定我想使用这个将一个变量传递给 php：

```
theVar = 10; //just to make things simple.
urlString = "cookiestesttwo.php?var=" +theVar;
window.location = urlString; 
```

因此，我尝试将我的 api 代码简化为此，但它停止了工作：

```
$(document).ready() {
    $.getJSON("https://api.foursquare.com/v2/venues/search?ll=" + lat + "," + lng + "&client_id=L2VWBKPOW45D5X3FJ3P4MJB5TGVJ4ST2J005RIVAFIWG44ND%20&client_secret=ZKDAOLHASCA31VUOGMBTAS3RFYUOMXL4IFFYPRURIDQA3QMA%20&v=20111107", function(data) {
        one = data.response.venues[0].name;
        document.write(one)
        theVar = one
        urlString = "cookiestesttwo.php?var=" + theVar;
        window.location = urlString;)
    };
};​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:50:14.703

您的问题可能是您`document.write()`在 DOM 已经完成时使用。你不应该那样做。创建一个元素`document.createElement( "div" )`并设置`innerText()`，然后将其附加到 dom。就像你在重构之前所做的一样。

**编辑**

我知道这不是，`document.write()`但只是澄清我在说什么我写了一个小重构。我也扔掉了，`theVar = one`因为那是多余的。还要确保在正确的范围内声明您的变量。所以我`var`在前面加了一个`one`。

```
$(document).ready(function() {
    $.getJSON("https://api.foursquare.com/v2/venues/search?ll="+lat+","+lng+"&client_id=L2VWBKPOW45D5X3FJ3P4MJB5TGVJ4ST2J005RIVAFIWG44ND%20&client_secret=ZKDAOLHASCA31VUOGMBTAS3RFYUOMXL4IFFYPRURIDQA3QMA%20&v=20111107",

    function(data){
       var one = data.response.venues[0].name;

       var div = document.createElement( "div" );
       div.innerText( one );
       document.appendChild( div );

       window.location = "cookiestesttwo.php?var=" + one;
    });
  }); 
```

但是如果你改变窗口的位置。`document.write()`因为无论如何你离开了网站，所以没有必要添加新的 div 或添加新的 div。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:16:45.030

`$(document).ready() {`不是正确的语法并且会引发错误。

此外，函数末尾还有另一个语法错误。你颠倒了}和）

```
$(document).ready(function() {
    $.getJSON("https://api.foursquare.com/v2/venues/search?ll=" + lat + "," + lng + "&client_id=L2VWBKPOW45D5X3FJ3P4MJB5TGVJ4ST2J005RIVAFIWG44ND%20&client_secret=ZKDAOLHASCA31VUOGMBTAS3RFYUOMXL4IFFYPRURIDQA3QMA%20&v=20111107", function(data) {
        one = data.response.venues[0].name; // if one is local to this function then use VAR otherwise you'll leak it globally.
        document.write(one);
        theVar = one; // same here for the VAR keyword.
        urlString = "cookiestesttwo.php?var=" + theVar; // and here as well. NO GLOBAL LEAKS!
        window.location = urlString;
    });
}); 
```

我在评论中提出了更多提示。

# c - 菜单功能错误：指针和整数的比较[默认启用]

> ID：13980168
> 
> 赞同：1
> 
> 时间：2012-12-20T20:43:30.463
> 
> 标签：c, eclipse-cdt

我有这个功能，它是一个菜单。编译后不断出现如下错误：error: comparison between pointer and integer [默认开启]。为什么会这样？

```
 char choice;

    printf ("Welcome to the Customer menu! \n");
    printf ("Please select option from below\n");
    printf ("a. Add customer\n");
    printf ("b. Modify customer\n");
    printf ("c. List customers\n");
    printf ("d. Go back to main menu");

    while ((gets(&choice)) != 'q')
            {
                if (choice == '\n')
                    continue;
                switch (choice)
                {

        case 'a' : add_customer();
                   break;
        case 'b' : printf ("products_main ()");
                   break;
        case 'c' : printf ("orders_main ()");
                   break;
        default : printf ("Invalid input. Please enter an option from the above menu\n");
                  continue;

                }

                printf ("END PROGRAM"); 
```

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:48:36.610

该`gets()`函数返回 a `char *`，而您将该返回值与 a 进行比较`char`：

```
if (gets(&choice)) != 'q') 
```

另请注意，这在两个级别上是错误的，因为从`gets()`读取`stdin`直到遇到换行符，因此如果将 one 的地址传递给它`char`，则可能会导致缓冲区溢出错误。为什么不`fgets()`改用？

```
char buf[128];
fgets(buf, sizeof(buf), stdin);
if (buf[0] == 'q') {
    /* etc */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T23:27:00.720

您不能使用gets() 来执行此操作，毕竟gets() 非常危险，不会检查要读取的字符数，因此可能会导致非常糟糕的运行时缓冲区溢出。

您应该像 H2CO3 一样使用 fgets()，它有读取字符的限制，因此更安全。

```
char * input(const char *message, size_t quantity)
{
    const int BUFFER_SIZE = 512;
    char buf[BUFFER_SIZE], *res = NULL;

    if(quantity > BUFFER_SIZE || quantity == 0)
        quantity = BUFFER_SIZE - 1;

    if(message) 
        printf("%s",message);

   if(fgets(buf, quantity + 1, stdin) > 0)
   {
        char *end = strchr(buf, '\n');
        if(end){
            *end = '\0';
        }

        res = malloc(strlen(buf) + 1);
        if(!res)
        {
           fprintf(stderr, "input(): MEM alloc error\n");
           return NULL;
        }
       strcpy(res, buf);

   }
   return res;
} 
```

尝试使用该功能，只需传递您想要的消息以及您想要的输入字符的确切数量。:)

如果你想单独尝试，这里有一个测试程序：

```
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

char * input(const char *message, size_t quantity)
{
    const int BUFFER_SIZE = 512;
    char buf[BUFFER_SIZE], *res = NULL;

    if(quantity > BUFFER_SIZE || quantity == 0)
        quantity = BUFFER_SIZE - 1;

    if(message) 
        printf("%s",message);

   if(fgets(buf, quantity + 1, stdin) > 0)
   {
        char *end = strchr(buf, '\n');
        if(end){
            *end = '\0';
        }

        res = malloc(strlen(buf) + 1);
        if(!res)
        {
           fprintf(stderr, "input(): MEM alloc error\n");
           return NULL;
        }
       strcpy(res, buf);
   }
   return res;
}

int main()
{
    char *a = input("Input:", 4);
    if(a) 
    {
        printf("%s\n",a);   
        free(a);   
        return 0;
    }
    printf("Got NULL input\n");
    return -1;
} 
```

当你对一个特定的函数有疑问时，它们的参数是什么，它们的返回值是什么，你可以在谷歌中查找它，你会发现很多例子和函数定义。随着时间的推移，您将学会轻松理解定义并记住一些函数名称及其参数。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T20:46:45.877

这一行：

```
while ((gets(&choice)) != 'q') 
```

gets() 读取一个字符串，而不是一个字符，并返回该字符串（即，它填充您通过字符指针传递给它的缓冲区）。然后，您将返回的指针（与您传入的指针相同）与一个字符进行比较。

您可能只想阅读一个字符。如果你想要一个完整的字符串，你需要将它读入一个 char 数组，而不是传递单个 char 的地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-26T20:03:33.710

在做了一些阅读后，我发现包括

```
#include <unistd.h> 
```

有助于摆脱警告。我是 unix c 的新手，以前从未见过。我还在测试我的代码，所以当我确定这是否有效时，我会回复你。

希望这可以帮助。

最后警告回来了，它最终进入了一个无限循环，所以我的逻辑有问题。

对不起，我没有任何帮助。

# php - 在 XML 文档中注释和取消注释节点

> ID：13980173
> 
> 赞同：1
> 
> 时间：2012-12-20T20:44:22.033
> 
> 标签：php, xml, domdocument

```
<node1>
    <node2>
         <node3>
         </node3>
         <node3>
         </node3>
         <node3>
         </node3>
    </node2>

    <node2>
         <node3>
         </node3>
         <node3>
         </node3>
         <node3>
         </node3>
    </node2>

    ...
 </node1> 
```

假设我在 XML 文档中有这种结构。我希望能够**评论一个节点**及其所有内容，并**在必要**时使用`PHP`. 我试图找到一种方法来查看 DOMDocument 的文档和 SimpleXML 的文档，但没有成功。

编辑：只是为了澄清：我找到了如何评论节点，但没有找到如何取消评论它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:08:39.530

可以使用创建评论[`DOMDocument::createComment()`](http://php.net/domdocument.createcomment)。用实际节点替换注释就像替换任何其他节点类型一样，使用[`DOMElement::replaceChild()`](http://php.net/domelement.replacechild).

```
$doc = new DOMDocument;
$doc->loadXML('<?xml version="1.0"?>
<example>
    <a>
        <aardvark/>
        <adder/>
        <alligator/>
    </a>
</example>
');

$node = $doc->getElementsByTagName('a')->item(0);

// Comment by making a comment node from target node's outer XML
$comment = $doc->createComment($doc->saveXML($node));
$node->parentNode->replaceChild($comment, $node);
echo $doc->saveXML();

// Uncomment by replacing the comment with a document fragment
$fragment = $doc->createDocumentFragment();
$fragment->appendXML($comment->textContent);
$comment->parentNode->replaceChild($fragment, $comment);
echo $doc->saveXML(); 
```

上面的（超级简化的）示例应该输出如下内容：

```
<?xml version="1.0"?>
<example>
    <!--<a>
        <aardvark/>
        <adder/>
        <alligator/>
    </a>-->
</example>
<?xml version="1.0"?>
<example>
    <a>
        <aardvark/>
        <adder/>
        <alligator/>
    </a>
</example> 
```

**参考**

*   [`DOMDocument::createComment()`](http://php.net/domdocument.createcomment)创造`<-- comments -->`
*   [`DOMElement::replaceChild()`](http://php.net/domelement.replacechild)交换节点
*   [`DOMDocument::createDocumentFragment()`](http://php.net/domdocument.createdocumentfragment)创建*文档片段*
*   [`DOMDocumentFragment::appendXML()`](http://php.net/domdocumentfragment.appendxml)将一串 xml 附加到片段
*   [`DOMDocument::saveXML()`](http://php.net/domdocument.savexml)获取元素的 XML
*   [`DOMCharacterData->data`](http://php.net/domcharacterdata#domcharacterdata.props.data)获取评论的内容

# c# - 来自主窗口c#的用户输入

> ID：13980176
> 
> 赞同：-2
> 
> 时间：2012-12-20T20:44:35.667
> 
> 标签：c#, user-input, prompt

如何使用 c# 在主窗口上获得提示以询问用户输入？我试过了

```
 Console.Writeline("write something"); 
```

&

```
 string input = Console.Readline(); 
```

但这些命令不会在我的主窗口上显示任何内容。我那里有一张图片，控制台提示符的显示会在它后面吗？

我想让用户输入在 main() 方法之外的方法中使用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T20:47:23.300

`Console`仅对控制台项目有用。如果这是一个 winform 项目，则没有（可见的）控制台可供访问。

相反，您想[`MessageBox`](http://www.dotnetperls.com/messagebox-show)查看[WinForms](http://msdn.microsoft.com/en-us/library/system.windows.forms.messagebox.show%28v=vs.110%29.aspx)或[WPF](http://msdn.microsoft.com/en-us/library/ms602949.aspx)

# ruby-on-rails - 用于从 text_field 接收数组的 Rails 字段

> ID：13980177
> 
> 赞同：1
> 
> 时间：2012-12-20T20:44:42.943
> 
> 标签：ruby-on-rails, arrays, forms

我有一个`form_for`, 和一个嵌套`fields_for`在其中。

现在看起来像这样

```
form_for blah 
  fields_for :badgetype do |b|
    b.text_field :name
    b.text_field :keyword 
```

参数看起来像`badgetype: { :name => "foo", :keyword => "bar" }`

我想要的是设置其中的 5 个，然后得到类似的东西：

```
badgetype: { 1 => { :name => "foo", :keyword => "bar" }, 
             2 => { :name => "boof", :keyword => "baz" },
             ... 
           } 
```

我将如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-20T23:14:47.043

```
<%= form_for blah do |a| %>
  <% (1..5).each do |number| %>
    <%= a.fields_for "badgetype[#{number}]" do |b| %>
      <%= b.text_field :name %>
      <%= b.text_field :keyword %>
    <% end %>
  <% end %>
  <%= a.submit %>
<% end %> 
```

# wordpress - 在 WordPress 中接收带有函数的警告消息 .. 警告：无法修改标头信息 - 标头已由

> ID：13980183
> 
> 赞同：0
> 
> 时间：2012-12-20T20:45:03.433
> 
> 标签：wordpress

这是我的功能，

```
class emailer {
function notifyHeart($post_ID)  {
$interests = get_user_meta(get_current_user_id(), 'interests');
$to = the_author_meta( 'user_email', get_current_user_id() );
$post = get_post($post_ID);

foreach($interests as $interest) {
  if(has_tag($interest, $post)) {
    $email = $to;
    mail($email, "An article about Heart", 'A new post has been published about heart.');
    break;
  }
}
 }
 }
  add_action('publish_post', array('emailer', 'notifyHeart')); 
```

发布帖子后出现错误，并且仅在我包含

```
$to = the_author_meta( 'user_email', get_current_user_id() ); 
```

如果我包括这个，

```
$to = "email@email.com"; 
```

不会出现警告。有人想吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:48:07.487

您只需要使用不同的 WP 功能：

```
// This actually echos the result right to the page, hence the headers error.
the_author_meta()

// Whereas this lets you capture the value into your $to variable:
get_the_author_meta() 
```

# java - Acs Reader acr122 with smartcardio，如果我们之前不启动 ACR122UTool，则会出现以下错误 SCARD_E_READER_UNAVAILABLE

> ID：13980184
> 
> 赞同：3
> 
> 时间：2012-12-20T20:45:05.497
> 
> 标签：java, nfc

我正在使用 smartcardio api 将数据从 NFC ACR 122u 读卡器写入 Android 手机

这是我正在使用的代码：

```
TerminalFactory factory = TerminalFactory.getDefault();
List<CardTerminal> terminals = factory.terminals().list();

if (terminals==null || terminals.size()==0) {
    le.warn("nfcReaderPresent no terminal found");
    return false;
}

terminal = terminals.get(0);
try {
    boolean res=terminal.waitForCardPresent(5*1000);
    if (res)
        interrupt=true;
}
catch(Exception p) {
    le.error("pushData p="+p);
    le.fatal(p);
}

if (terminal.isCardPresent()) {
    card = terminal.connect("*");//it seems always to be T=1

    ATR atr=card.getATR();
    CardChannel channel = card.getBasicChannel();
    le.debug("card: " + card+" channel="+channel+"  atr="+ByteArrayToHexString(atr.getBytes()));

    //ADPU command
    byte getDataCmd[]={(byte)0xFF,(byte)0xCA,(byte)0x00,(byte)0x00,(byte)0x00};
    sendCommand(getDataCmd,channel);
... 
```

该错误`javax.smartcardio.CardException: sun.security.smartcardio.PCSCException: SCARD_E_READER_UNAVAILABLE`发生在发送 APDU 命令之前。

当我在工具 ACR122UTool 之前启动并单击连接时，一切正常。（不再需要ACR122uTool）似乎acs工具初始化了设备。

任何帮助将不胜感激

# android - 使用来自 AlertDialog 的用户输入添加 ListView 项目

> ID：13980185
> 
> 赞同：0
> 
> 时间：2012-12-20T20:45:21.853
> 
> 标签：android, listview, button, alert, android-alertdialog

我试图用来自 AlertDialog 的输入填充 ListView，该输入在其中打开一个 EditText。我的问题是每次我用 EditText 在 AlertDialog 中给出一些东西并单击 AlertDialog 中的添加按钮时，它会用相同的 String 填充我的 Array 的所有 20 组。但我希望他只从 EditText 填充 String 1时间，我可以进一步处理这 1 个项目。

这是我的代码

**MainActivity.java**

```
public class MainActivity extends Activity {

    private static final int DIALOG_ALERT = 10;

    ListView list;
    Button addBtn;
    EditText input;

    String[] items;
    ArrayAdapter<String> adapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        list = (ListView) findViewById(R.id.list);
        addBtn = (Button) findViewById(R.id.addPlanBtn);

        input = new EditText(this);

        items = new String[20];

        adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, items);
        list.setAdapter(adapter);

        addBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                AlertDialog alert = new AlertDialog.Builder(MainActivity.this).create();
                alert.setTitle("Train plan name");
                alert.setMessage("enter a name:");
                alert.setView(input);

                alert.setButton("add", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                            String value = input.getText().toString();

                            for(int i=0; i < items.length; i++){     
                                items[i] = value;

                            }

                     }
                  });

                    alert.show();
            }

        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

**activity_main.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/addPlanBtn"
         >

    </ListView>

    <Button
        android:id="@+id/addPlanBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:text="add a new Plan" />

</RelativeLayout> 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:50:26.330

点击监听器中的这个 for 循环正在为列表中的所有数组成员设置字符串：

```
for(int i=0; i < items.length; i++){     
    items[i] = value;
} 
```

要仅更改有问题的字符串，您需要索引数组的特定成员，例如：

```
items[0] = value; 
```

这只会改变第一项。在您的情况下，您拉出的对话框与特定的列表项无关，因此您必须想出一种方法来跟踪正在编辑的列表项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T12:39:51.013

知道了，

这是工作代码。

**MainActivity.java**

```
public class MainActivity extends Activity {

    private static final int DIALOG_ALERT = 10;

    ListView list;
    Button addBtn;
    EditText input;

    String[] items;
    MyListAdapter adapter;
    AlertDialog alert;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        list = (ListView) findViewById(R.id.list);
        addBtn = (Button) findViewById(R.id.addPlanBtn);

        input = new EditText(this);

        items = new String[1];

        alert = new AlertDialog.Builder(MainActivity.this).create();
        alert.setTitle("Train plan name");
        alert.setMessage("enter a name:");
        alert.setView(input);

        alert.setButton("add", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                    String value = input.getText().toString();

                    items[items.length - 1] = value;

                    adapter = new MyListAdapter(MainActivity.this, items);
                    list.setAdapter(adapter);

                    String[] temp = new String[items.length +1];

                    for(int i = 0; i< items.length; i++)
                        temp[i] = items[i];

                    items = temp;

                    alert.dismiss();
                    adapter.notifyDataSetChanged();
             }

          });

        addBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                    alert.show();
            }

        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

**我的列表适配器**

```
public class MyListAdapter extends ArrayAdapter<String> {

    private final Context context;
    private final String[] values;

    static class ViewHolder {
        public TextView text;
    }

    public MyListAdapter(Context context, String[] values) {
        super(context, R.layout.row_item, values);
        this.context = context;
        this.values = values;
    }

    @Override
      public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.row_item, parent, false);
        TextView textView = (TextView) rowView.findViewById(R.id.tvItem);
        textView.setText(values[position]);

        return rowView;
      }

} 
```

**row_item.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/tvItem"
        android:layout_width="fill_parent"
        android:layout_height="50px"
        android:textSize="40px" >

    </TextView>

</RelativeLayout> 
```

**activity_main.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/addPlanBtn"
         >

    </ListView>

    <Button
        android:id="@+id/addPlanBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:text="add a new Plan" />

</RelativeLayout> 
```

谢谢大家，谁有时间帮助我。

# c++ - 在另一个结构中声明一个结构

> ID：13980190
> 
> 赞同：1
> 
> 时间：2012-12-20T20:45:45.163
> 
> 标签：c++, linked-list, nodes

在我的头文件中：

```
private:
struct movieNode {
    string title;

    castNode *castHead;

    movieNode *prev;
    movieNode *next;
};

struct castNode {
    string name;

    castNode *next;

};

movieNode *head;
movieNode *last; 
```

但编译器错误是：

> 预期的 ';' 在“*”标记之前

我的目标是每个movieNode都应该有一个标题和一个演员表（带有castNode）。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T20:48:06.720

`movieNode`至少需要能够看到一个不完整的类型，称为`castNode`. 此刻，编译器正在“嗯，`castNode`？那到底是什么？” 因为它还没有看到的定义`castNode`。`castNode` *在这种情况下，您可以通过在定义之前*简单地定义来避免它`movieNode`。只需交换两个结构。

在其他情况下，如果你有一个循环依赖（例如，如果`castNode`有一个指向 a 的指针`movieNode`），你可以使用前向声明来提供一个不完整的类型（它看起来像`class castNode;`），然后稍后正确定义它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T20:52:17.967

```
private:
     struct castNode; // <- add this
     struct movieNode
     {
             string     title;
             castNode*  castHead;
             movieNode* prev;
             movieNode* next;
     };
     struct castNode
     {
             string    name;
             castNode* next;
     };
     movieNode*   head;
     movieNode*   last; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T20:50:03.643

`castNode`前声明`movienode`。

只有这样才`movienode`“知道”什么是 a `castNode`。

# c - 如何将 elf 文件从 dwarf 转换为 stabs 格式？

> ID：13980195
> 
> 赞同：1
> 
> 时间：2012-12-20T20:45:51.123
> 
> 标签：c, file, debugging, elf, dwarf

有一个 ELF 调试文件。

该文件使用 DWARF 格式。

如何将其转换为 stabs 格式？

是否有任何工具或方法可能有助于做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:38:14.923

```
http://opensource.apple.com/source/binutils/binutils-20/src/binutils/wrstabs.c 
```

是从 ELF 二进制文件中提取 stabs 信息的代码链接。这是长期混乱和有问题的。

确实没有预先构建的转换器。您将不得不对上面的代码进行逆向工程。正如 Mats 建议的那样，考虑重新编译。

但是我猜你有一个遗留的二进制文件，后面没有代码。DWARF 格式是 Sun 大约 10 多年前所做的事情，这对 Sun、IMO 来说是一种失​​败。

这是将二进制文件反向工程为汇编程序的链接。

```
http://www.linuxsa.org.au/meetings/reveng-0.2.pdf 
```

一旦你有了汇编程序，理论上，你就可以构建一个新的二进制文件。问题是; 外部函数的入口点，并使它们与您的链接器正确工作。您还必须删除与 DWARF 相关的内容。然后重新编译链接刺我猜

但是，`http://dwarf.freestandards.org`文档所在的站点似乎永久脱机。

如果我知道你的硬件，这对我的回答会有很大帮助。

# c# - xsd 生成器到 C#/protobuf

> ID：13980197
> 
> 赞同：2
> 
> 时间：2012-12-20T20:45:53.803
> 
> 标签：c#, serialization, protobuf-net

我正在开发一个通过网络对消息进行序列化和反序列化的应用程序。但是我遇到了使用 xsd 从 xsd 模式生成的 C# 类的问题。

我能够用我自己的测试类成功地测试 protobuf 库。安装 lib 并使用必要的 protobuf 属性（包括整数顺序）装饰我的类。

我从文档中了解到 protobuf 尊重现有的序列化属性，如 xmltype、datacontract 等。当我运行 xsdgen 工具时，我的类被这些属性修饰，但序列化过程没有发生。

我尝试创建一个部分类，但如果我有很多类并且这些类不断变化，它仍然是相当手动的。

这是我的 xsd 命令 [xsd TopClass.xsd /c /eld /edb /n:MyNamespace /order]

有人可以推荐一个解决方案吗？

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "4.0.30319.1")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlRootAttribute("safHeartBeat", Namespace="", IsNullable=false)]
public partial class SaFHeartBeat {

    private System.DateTime timestampField;
    private string cacheNameField;
    private string hostnameField;
    private System.DateTime processStartTimeField;
    private SafStatusEnum statusField;
    private object datatypeField;
    private int itemCountField;
    private System.DateTime lastUpdateTimeField;
    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(Order=0)]
    public System.DateTime timestamp {
        get {
            return this.timestampField;
        }
        set {
            this.timestampField = value;
        }
    }
    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(Order=1)]
    public string cacheName {
        get {
            return this.cacheNameField;
        }
        set {
            this.cacheNameField = value;
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(Order=2)]
    public string hostname {
        get {
            return this.hostnameField;
        }
        set {
            this.hostnameField = value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T08:12:13.920

protobuf-net 可以*尝试*使用来自其他库的属性，但前提是它们提供了足够的信息。特别是，protocol buffers 要求每个成员有一个正整数标识符（它可以尝试从中获取`Order`），但是：`[XmlAttribute]` *没有*`Order`，并且 xsd 令人讨厌地启动`Order`from ，它不能`0`被 protocol buffers 使用（它不是一个有效的字段标识符）。

最终，这可能不适合来自 xsd 的正在进行/更改的定义；我很想说“稍后为 protobuf 编写一个单独的 DTO”。但是，另一种选择是生成第二个`partial`类文件，并对其进行装饰*，*例如：

```
namespace MyNamespace {
    [ProtoContract]
    [ProtoPartialMember(1, "Id"), ProtoPartialMember(2, "Name")]
    partial class SomeType {}

    [ProtoContract]
    [ProtoPartialMember(1, "Id"), ProtoPartialMember(2, "Date")]
    [ProtoPartialMember(3, "Value"), ProtoPartialMember(4, "Origin")]
    partial class SomeOtherType {}
} 
```

不过，这仍然需要维护以包含您需要序列化的成员。

# c++ - 如何避免丢失自动生成的初始化列表构造函数？

> ID：13980200
> 
> 赞同：4
> 
> 时间：2012-12-20T20:46:08.133
> 
> 标签：c++, c++11, initializer-list

*我喜欢新的自动生成的大括号括起来的初始化器！*

如果我开始声明自己的构造函数，有什么办法可以避免丢失它们？

**代码**

```
#include <string>

struct Foo
{
    int          i;
    std::string  s;

    // Foo() { }  // I lose my brace-enclosed initializers if I uncomment this line
};

int
main( int argc, char* argv[] )
{
    Foo f{ 1, "bar" };  // having the option to do this is good

    return 0;
} 
```

**回答**

根据[下面 juanchopanza 的回答](https://stackoverflow.com/a/13980239/975129)，看来我必须满足[聚合](https://stackoverflow.com/questions/4178175/what-are-aggregates-and-pods-and-how-why-are-they-special)的冗长规则。但我仍然需要一个可以应用于 50 多个 ORM 类（每个类有 5-15 个字段）的解决方案，不需要大量的样板代码，或者如果有样板代码，至少应该易于编辑/维护。

我能得到的最接近的是这个使用组合的解决方案。我想知道是否有更好/更简单的东西......

```
#include <string>

// this class must satisfy the rules for aggregates
struct Foo_
{
    int          i;
    std::string  s;
};

// this class can be anything...
struct Foo
{
    Foo_         m_f;
    Foo( Foo_ const& f ) : m_f( f ) { }
};

int
main( int argc, char* argv[] )
{
    Foo  f( { 1, "bar" } );   // ugly, but works

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T20:48:21.007

您无法避免丢失自动聚合初始化，因为您的类不再是聚合。但是您可以添加一个带有两个参数的构造函数，并从非聚合的聚合初始化中受益：

```
struct Foo
{
    int          i;
    std::string  s;
    Foo(int i, const std::string& s) : i(i), s(s) {}
    Foo() = default; // idiomatic C++11
}; 
```

# c# - c#文件编解码，不可读

> ID：13980207
> 
> 赞同：0
> 
> 时间：2012-12-20T20:46:25.050
> 
> 标签：c#, file, encoding

当您使用 txt 编辑器打开某个文件时，无法读取编码类型并且它只是一堆乱七八糟的字符，我想在保存文件时将其与我的程序一起使用，以及如何在 c# 中执行此操作：

```
BinaryWriter bw = new BinaryWriter(File.Create(path), Encoder.SOME_ENCODING); 
```

然后在加载时对其进行解码。那么我应该使用什么编码呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:15:19.473

> *我想将一些字符串（例如“Sweet”）保存到文件中，如果您在文本编辑中打开该文件，您会看到类似“nfgkdn@{3!”的内容。*

只是一个简单的例子

```
Obfuscate("a.txt", "hello");
string orgstr = Deobfuscate("a.txt"); 
```

中的数据`a.txt`：`Mj82NjU=`

```
void Obfuscate(string fileName, string data)
{
    var bytes = Encoding.UTF8.GetBytes(data);
    for (int i = 0; i < bytes.Length; i++) bytes[i] ^= 0x5a;
    File.WriteAllText(fileName,Convert.ToBase64String(bytes));
}

string Deobfuscate(string fileName)
{
    var bytes = Convert.FromBase64String(File.ReadAllText(fileName));
    for (int i = 0; i < bytes.Length; i++) bytes[i] ^= 0x5a;
    return Encoding.UTF8.GetString(bytes);
} 
```

# java - Java 邮件：NoClassDefFoundError：javax/activation/DataSource

> ID：13980209
> 
> 赞同：2
> 
> 时间：2012-12-20T20:46:32.227
> 
> 标签：java, email, classpath, noclassdeffounderror, sunos

我编写了一个小型 Java 命令行程序来测试从远程服务器发送电子邮件。我得到了可怕的“NoClassDefFoundError”，我不知道为什么。

服务器正在运行：

*   SunOS 5.10 通用 2005 年 1 月
*   Java 1.5.0_30-b03（Sun，标准）

我的java程序被称为

**发送电子邮件ACME**

错误信息是

```
Exception in thread "main" java.lang.NoClassDefFoundError: javax/activation/DataSource 
```

程序运行的完整输出是：

```
bash-3.00$ javac SendEmailACME.java
bash-3.00$ java SendEmailACME
SendEmailACME: Classpath: .:/users/steve/TestProgramsLib/mail.jar:users/steve/TestProgramsLib/activation.jar
DEBUG: setDebug: JavaMail version 1.4.4
Exception in thread "main" java.lang.NoClassDefFoundError: javax/activation/DataSource
        at SendEmailACME.main(SendEmailACME.java:47)
bash-3.00$ 
```

我跑了

java -verbose SendEmailACME

输出对于 stackoverflow 来说太长了。它所包含的只是常规输出，以及一堆关于 java 加载其所有常规库的消息，这些库来自 mail.jar，但我没有从 javax.activation 中看到任何消息。*

“$ echo $CLASSPATH”的输出是：

```
bash-3.00$ echo $CLASSPATH
.:/users/steve/TestProgramsLib/mail.jar:users/steve/TestProgramsLib/activation.jar
bash-3.00$ 
```

我的主目录是

```
/users/steve 
```

它包含这两个目录

1.  测试程序
2.  测试程序库

第一个有我的程序 SendEmailACME.java, SendEmailACME.class/ 第二个有以下罐子：

```
bash-3.00$ ls -l
total 1102
-rw-r--r--   1 steve  acme      55932 Apr 19  2006 activation.jar
-rw-r--r--   1 steve  acme     494975 Jan 14  2011 mail.jar
bash-3.00$ 
```

这是我的命令行程序 SendEmailACME 的源代码：

```
import javax.mail.*;
import javax.mail.internet.*;
import javax.mail.Authenticator;
import javax.mail.PasswordAuthentication;

import java.util.Properties;

public class SendEmailACME {

    public static void main(String[] args) throws Exception{

        String smtpServer  = "msg.abc.acme.com";
        int port           = 25;        
        String userid      = "acme.staffdirectory"; 
        String password    = "password";  
        String contentType = "text/html";

        String subject     = "test: Send An Email, From A Java Client Using msg.abc.acme.com";
        String from        = "ACME.Staff.Directory@acme.com";
        String to          = "steve@acme.com,joerre123@gmail.com,fake.mail@acme.com,bogus@fauxmail.com";
        String body        = "<h1>Test. An Email, From A Java Client Using msg.abc.acme.com.</hi>";

        System.out.println("SendEmailACME: Classpath: " + System.getProperty("java.class.path"));

        Properties props   = new Properties();
        props.put("mail.transport.protocol", "smtp");
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.starttls.enable","true");
        props.put("mail.smtp.host", smtpServer);

        Session mailSession = Session.getInstance(props);

        // Get runtime more runtime output when attempting to send an email
        mailSession.setDebug(true);

        MimeMessage message = new MimeMessage(mailSession);
        message.setFrom(new InternetAddress(from));
        message.setRecipients(Message.RecipientType.TO, to);
        message.setSubject(subject);
        message.setContent(body,contentType);

        Transport transport = mailSession.getTransport();
        transport.connect(smtpServer, port, userid, password);
        transport.sendMessage(message,message.getRecipients(Message.RecipientType.TO));
        transport.close();
    }// end function main()

}// end class SendEmailACME 
```

以下是运行命令以查看activation.jar 中的内容的输出：

```
bash-3.00$ jar -tf activation.jar
META-INF/MANIFEST.MF
META-INF/SUN_MICR.SF
META-INF/SUN_MICR.RSA
META-INF/
META-INF/mailcap.default
META-INF/mimetypes.default
javax/
javax/activation/
javax/activation/ActivationDataFlavor.class
javax/activation/MimeType.class
javax/activation/MimeTypeParameterList.class
javax/activation/MimeTypeParseException.class
javax/activation/CommandInfo.class
javax/activation/DataHandler$1.class
javax/activation/DataHandler.class
javax/activation/DataSource.class
javax/activation/CommandMap.class
javax/activation/DataContentHandler.class
javax/activation/DataContentHandlerFactory.class
javax/activation/CommandObject.class
javax/activation/DataHandlerDataSource.class
javax/activation/DataSourceDataContentHandler.class
javax/activation/ObjectDataContentHandler.class
javax/activation/FileDataSource.class
javax/activation/FileTypeMap.class
javax/activation/MailcapCommandMap.class
javax/activation/MimetypesFileTypeMap.class
javax/activation/SecuritySupport$1.class
javax/activation/SecuritySupport$2.class
javax/activation/SecuritySupport$3.class
javax/activation/SecuritySupport$4.class
javax/activation/SecuritySupport$5.class
javax/activation/SecuritySupport.class
javax/activation/URLDataSource.class
javax/activation/UnsupportedDataTypeException.class
com/
com/sun/
com/sun/activation/
com/sun/activation/registries/
com/sun/activation/registries/MailcapFile.class
com/sun/activation/registries/MailcapParseException.class
com/sun/activation/registries/MimeTypeFile.class
com/sun/activation/registries/MimeTypeEntry.class
com/sun/activation/registries/LineTokenizer.class
com/sun/activation/registries/LogSupport.class
com/sun/activation/registries/MailcapTokenizer.class
com/sun/activation/viewers/
com/sun/activation/viewers/ImageViewer.class
com/sun/activation/viewers/ImageViewerCanvas.class
com/sun/activation/viewers/TextEditor.class
com/sun/activation/viewers/TextViewer.class
bash-3.00$ 
```

一切都编译得很好，但是尽管activation.jar 在类路径中，但它似乎找不到 javax.activation.DataSource

我无权访问 jdk_home/jre/lib/ext 目录。

我一直在尝试从我的目录 /users/steve/TestPrograms 执行 SendEmailACME

提前感谢您的帮助

史蒂夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:05:21.463

```
bash-3.00$ echo $CLASSPATH
.:/users/steve/TestProgramsLib/mail.jar:users/steve/TestProgramsLib/activation.jar 
```

您似乎缺少一个`/`between`mail.jar:`和`users/steve`。这意味着`java`在错误的地方寻找`activation.jar`(in`./users`而不是`/users`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:49:26.283

您的 CLASSPATH 不包含放置 javax.* 库的 JDK 库。

# java - Java 6 / RHEL 6 中不显示 CJK 字符

> ID：13980219
> 
> 赞同：0
> 
> 时间：2012-12-20T20:47:09.733
> 
> 标签：java, fonts

似乎无法在 RHEL 环境中正确显示中文、韩文和日文字符（而是显示正方形）。我正在专门使用 Swing 应用程序进行测试，但似乎不限于此。

我发现 Red Hat 的这份报告说 Oracle 根本不支持它 - [https://bugzilla.redhat.com/show_bug.cgi?id=647157](https://bugzilla.redhat.com/show_bug.cgi?id=647157)

但这对我来说似乎很奇怪。这个错误报告 - [http://bugs.sun.com/view_bug.do?bug_id=7010379](http://bugs.sun.com/view_bug.do?bug_id=7010379) - 似乎表明 jre 6u25 中包含了一个修复程序，但这是我正在使用的，它不存在。

有没有人熟悉这个问题，如果有，知道任何解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:52:12.457

这个问题似乎在 SE 6u30 和 SE 7 中得到解决。这似乎是 jre/lib 下的 fontconfig 文件的问题。另一种选择似乎是使用物理字体，或者只是升级。

# java - 单击链接时，Android WebView 会打开 uTorrent 应用程序

> ID：13980220
> 
> 赞同：2
> 
> 时间：2012-12-20T20:47:10.210
> 
> 标签：java, android, webview

我为 Google Play 制作了一个应用程序，它使用 webview 组件来运行，有人就我遇到的问题与我联系。他说，每当他点击应用程序内的链接时，它都会打开 uTorrent 应用程序，我什至自己尝试过，这是一个非常烦人的问题。

有没有人找到解决 uTorrent 与 WebView 冲突的问题的方法？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:50:53.837

```
wv.setWebViewClient(new WebViewClient()
    {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);
            return true;
        }
    }); 
```

这将解决问题。

# vba - 如何添加用于导入文本数据的文件的文件名

> ID：13980229
> 
> 赞同：1
> 
> 时间：2012-12-20T20:47:35.880
> 
> 标签：vba, excel

我发现一个宏非常适合从指定目录中的文本文件导入数据。

我没有任何用 VBA 编写的实际经验，但想知道是否有办法获取下面的代码并添加将宏从中检索数据的文件名放入列（*如 A 列*）的能力。

我正在使用它来搜索 100 多个日志以获取特定数据，并且能够将这些日志中的所有数据导入到 Excel 中，这非常容易。现在我只需要一种方法来查看数据来自哪个文件。在此先感谢，我期待学习新的东西。

**宏**：

```
Sub ReadFilesIntoActiveSheet()
    Dim fso As FileSystemObject
    Dim folder As folder
    Dim file As file
    Dim FileText As TextStream
    Dim TextLine As String
    Dim Items() As String
    Dim i As Long
    Dim cl As Range

    ' Get a FileSystem object
    Set fso = New FileSystemObject

    ' get the directory you want
    Set folder = fso.GetFolder("My File Path")

    ' set the starting point to write the data to
    Set cl = ActiveSheet.Cells(1, 1)

    ' Loop thru all files in the folder
    For Each file In folder.Files
        ' Open the file
        Set FileText = file.OpenAsTextStream(ForReading)

        ' Read the file one line at a time
        Do While Not FileText.AtEndOfStream
            TextLine = FileText.ReadLine

            ' Parse the line into | delimited pieces
            Items = Split(TextLine, "|")

            ' Put data on one row in active sheet
            For i = 0 To UBound(Items)
                cl.Offset(0, i).Value = Items(i)
            Next

            ' Move to next row
            Set cl = cl.Offset(1, 0)
        Loop

        ' Clean up
        FileText.Close
    Next file

    Set FileText = Nothing
    Set file = Nothing
    Set folder = Nothing
    Set fso = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:38:05.483

```
 cl.value = file.Name
    ' Put data on one row in active sheet
    For i = 0 To UBound(Items)
        cl.Offset(0, i+1).Value = Items(i)
    Next 
```

# ios - iOS异常代码列表

> ID：13980231
> 
> 赞同：4
> 
> 时间：2012-12-20T20:47:43.160
> 
> 标签：ios, crash

我正在尝试调试我的应用程序在 SBJson 中看到的崩溃（非常罕见），但我不知道如何破译异常代码：

```
Date/Time:       2012-12-16 12:21:31.311 -0500
OS Version:      iOS 6.0.1 (10A523)
Report Version:  104

Exception Type:  EXC_BREAKPOINT (SIGTRAP)
Exception Codes: 0x0000000000000001, 0x000000000000defe
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   CoreFoundation                  0x3a0a92be CFRelease + 18
1   libcache.dylib                  0x369217d2 _entry_remove + 154
2   libcache.dylib                  0x369221d8 _cache_enforce_limits + 168
3   libcache.dylib                  0x3692115e _cache_update_limits + 170
4   libcache.dylib                  0x3692156c cache_set_and_retain + 1028
5   CoreFoundation                  0x3a0fc480 -[NSCache setObject:forKey:cost:] + 52
6   CoreFoundation                  0x3a0fc442 -[NSCache setObject:forKey:] + 38
7   MyApp                       0x000c4226 -[SBJsonStreamWriter writeString:]     (SBJsonStreamWriter.m:315)
8   MyApp                       0x000c3460 -[SBJsonStreamWriter writeObject:] (SBJsonStreamWriter.m:104)
9   MyApp                       0x000c613c -[SBJsonWriter dataWithObject:] (SBJsonWriter.m:93)
10  MyApp                       0x000c5efc -[SBJsonWriter stringWithObject:] (SBJsonWriter.m:61)
11  MyApp                       0x000c14d0 -[NSObject(NSObject_SBJsonWriting) JSONRepresentation] (NSObject+SBJson.m:38) 
```

Apple 在这里提供了一些文档：

[http://developer.apple.com/library/ios/#technotes/tn2151/_index.html](http://developer.apple.com/library/ios/#technotes/tn2151/_index.html)

但未列出 0x0000000000000001, 0x000000000000defe 异常代码。有人知道我在哪里可以获得更完整的清单吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T06:44:46.523

你确定你传递的json是正确的吗？尝试在某个第三方验证它。我用这个： http: [//paulisageek.com/json_validator/](http://paulisageek.com/json_validator/)

# node.js - mongoDB有重新连接问题还是我做错了？

> ID：13980236
> 
> 赞同：29
> 
> 时间：2012-12-20T20:48:07.217
> 
> 标签：node.js, mongodb, azure, mongoose, mlab

我正在使用 nodejs 和 mongoDB - 我遇到了一些连接问题。

好吧，实际上是“唤醒”问题！它连接得非常好 - 速度超级快，我通常对结果感到满意。

**我的问题：**如果我有一段时间不使用连接（我说一段时间，因为时间范围变化 5 分钟以上），它似乎会停止。我没有触发断开连接事件 - 它只是挂起。

最终我得到一个像错误这样的响应：无法连接到 [ * .mongolab.com: * ] - ( * = masked values)

快速重启应用程序，连接再次恢复正常。有时，如果我不重新启动应用程序，我可以刷新并愉快地重新连接。

这就是为什么我认为这是“唤醒”问题。

**粗略的代码大纲：**

我没有包含代码 - 我认为不需要它。它有效（除了连接丢失）

**注意事项：**只有一个“连接”——我从不关闭它。我从不重新打开。

我正在使用猫鼬，socketio。

```
/* constants */

var mongoConnect = 'myworkingconnectionstring-includingDBname';

/* includes */

/* settings */

/* Schema */

var db = mongoose.connect(mongoConnect);

    /* Socketio */

io.configure(function (){
    io.set('authorization', function (handshakeData, callback) {

    });
});

io.sockets.on('connection', function (socket) {

});//sockets

io.sockets.on('disconnect', function(socket) {
    console.log('socket disconnection')
});

/* The Routing */

app.post('/login', function(req, res){  

});

app.get('/invited', function(req, res){

});

app.get('/', function(req, res){

});

app.get('/logout', function(req, res){

});

app.get('/error', function(req, res){

});

server.listen(port);
console.log('Listening on port '+port);

db.connection.on('error', function(err) {
    console.log("DB connection Error: "+err);
});
db.connection.on('open', function() {
    console.log("DB connected");
});
db.connection.on('close', function(str) {
    console.log("DB disconnected: "+str);
}); 
```

我在这里尝试了各种配置，比如一直打开和关闭 - 不过我相信，普遍的共识是像我一样做一个打开的包装。??

我尝试了一个连接测试器，它会不断检查连接的状态......即使这似乎表明一切都很好 - 问题仍然存在。

从第一天起我就遇到了这个问题。我一直使用 MongoLab 托管 MongoDB。本地主机上的问题似乎更糟。但我在 Azure 和现在的 nodejit.su 上仍然存在问题。

就像它随处发生的那样——它一定是我、MongoDB 或 mongolab。

顺便说一句，我对 php 驱动程序也有类似的经验。（确认这是在nodejs上）

提供一些帮助会很棒——即使有人只是说“这很正常”

提前致谢

抢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-18T23:42:05.837

**更新**：我们对这个主题的支持文章（基本上是这篇文章的副本）已移至[我们的连接故障排除文档](http://docs.mongolab.com/connecting/#known-issues)。

有一个已知问题是 Azure IaaS 网络强制执行大约 13 分钟的空闲超时（根据经验得出）。我们正在与 Azure 合作，看看我们是否不能让事情变得更加用户友好，但与此同时，其他人通过配置他们的驱动程序选项来解决这个问题已经取得了成功。

**最大连接空闲时间**

我们在与 Azure 和我们的客户合作时发现的最有效的解决方法是将最大连接空闲时间设置为低于四分钟。这个想法是让驱动程序在防火墙强制问题之前回收空闲连接。例如，一位使用 C# 驱动程序的客户设置`MongoDefaults.MaxConnectionIdleTime`为一分钟，这解决了他们的问题。

```
MongoDefaults.MaxConnectionIdleTime = TimeSpan.FromMinutes(1); 
```

应用程序代码本身没有改变，但现在驱动程序在幕后积极回收空闲连接。结果也可以在服务器日志中看到：在应用程序的空闲期间大量连接流失。

[在相关的 mongo-user 线程SocketException using C# driver on azure](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/_Z8YepNHnbI)中有更多关于这种方法的详细信息。

**活着**

您还可以通过使用某种[keepalive](http://en.wikipedia.org/wiki/Keepalive)使您的连接不那么空闲来解决此问题。这实现起来有点棘手，除非您的驱动程序开箱即用地支持它，通常是利用[TCP Keepalive](http://tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/)。如果您需要自己滚动，请确保每隔几分钟从池中获取每个空闲连接并发出一些简单而廉价的命令，可能是[ping](http://docs.mongodb.org/manual/reference/command/ping/)。

**处理断开连接**

即使没有积极的防火墙设置，也会不时发生断开连接。在投入生产之前，您需要确保正确处理它们。

首先，确保启用自动重新连接。如何做到这一点因驱动程序而异，但是当驱动程序检测到由于连接错误而导致操作失败时，打开自动重新连接会告诉驱动程序尝试重新连接。

但这并不能完全解决问题。您仍然有如何处理触发重新连接的失败操作的问题。自动重新连接不会自动重试失败的操作。那将是危险的，尤其是对于写入。所以通常会抛出异常并要求应用程序处理它。通常重试读取是不费吹灰之力的。但是应该仔细考虑重试写入。

下面的 mongo shell 会话演示了这个问题。默认情况下，mongo shell 启用了自动重新连接。我在一个名为的集合中插入一个文档，`stuff`然后找到该集合中的所有文档。然后我设置了一个三十分钟的计时器，并再次尝试同样的发现。它失败了，但外壳自动重新连接，当我立即重试时，我发现它按预期工作。

```
% mongo ds012345.mongolab.com:12345/mydatabase -u *** -p *** 
MongoDB shell version: 2.2.2 
connecting to: ds012345.mongolab.com:12345/mydatabase 
> db.stuff.insert({}) 
> db.stuff.find() 
{ "_id" : ObjectId("50f9b77c27b2e67041fd2245") } 
> db.stuff.find() 
Fri Jan 18 13:29:28 Socket recv() errno:60 Operation timed out 192.168.1.111:12345 
Fri Jan 18 13:29:28 SocketException: remote: 192.168.1.111:12345 error: 9001 socket exception [1] server [192.168.1.111:12345] 
Fri Jan 18 13:29:28 DBClientCursor::init call() failed 
Fri Jan 18 13:29:28 query failed : mydatabase.stuff {} to: ds012345.mongolab.com:12345 
Error: error doing query: failed 
Fri Jan 18 13:29:28 trying reconnect to ds012345.mongolab.com:12345 
Fri Jan 18 13:29:28 reconnect ds012345.mongolab.com:12345 ok 
> db.stuff.find() 
{ "_id" : ObjectId("50f9b77c27b2e67041fd2245") } 
```

**我们在这里为您提供帮助**

当然，如果您有任何问题，请随时通过 support@mongolab.com 与我们联系。我们是来帮忙的。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-19T20:21:37.613

感谢所有帮助人员 - 我已经设法在本地主机上解决了这个问题并部署到了实时服务器。

这是我现在工作的连接代码：

```
var MONGO = {
    username: "username",
    password: "pa55W0rd!",
    server: '******.mongolab.com',
    port: '*****',
    db: 'dbname',
    connectionString: function(){
        return 'mongodb://'+this.username+':'+this.password+'@'+this.server+':'+this.port+'/'+this.db;
    },
    options: {
        server:{
            auto_reconnect: true,
            socketOptions:{
                connectTimeoutMS:3600000,
                keepAlive:3600000,
                socketTimeoutMS:3600000
            }
        }
    }
};

var db = mongoose.createConnection(MONGO.connectionString(), MONGO.options);

db.on('error', function(err) {
    console.log("DB connection Error: "+err);
});
db.on('open', function() {
    console.log("DB connected");
});
db.on('close', function(str) {
    console.log("DB disconnected: "+str);
}); 
```

我认为最大的变化是使用“createConnection”而不是“connect”——我以前用过这个，但现在这些选项可能会有所帮助。这篇文章帮助很大[http://journal.michaelahlers.org/2012/12/building-with-nodejs-persistence.html](http://journal.michaelahlers.org/2012/12/building-with-nodejs-persistence.html)

老实说，我不太确定为什么要添加这些选项-正如@jareed 所提到的，我还发现有些人在“MaxConnectionIdleTime”方面取得了成功-但据我所知，javascript 驱动程序没有有这个选项：这是我试图复制行为的尝试。

到目前为止一切顺利 - 希望这对某人有所帮助。

**更新：2013 年 4 月 18 日** *注意，这是第二个具有不同设置的应用程序*

现在我以为我已经解决了这个问题，但问题最近又出现在**另一个应用程序**上——使用相同的连接代码。使困惑！​​！！

但是设置略有不同……</p>

**这个新应用程序正在使用 IISNode 的 Windows 框上运行。** 我最初并不认为这很重要。

我读到 Azure (@jareed) 上的 mongo 可能存在一些问题，因此我将数据库移至 AWS - 问题仍然存在。

所以我又开始玩那个选项对象，读了很多关于它的东西。得出了这样的结论：

```
options: {
    server:{
        auto_reconnect: true,
        poolSize: 10,
        socketOptions:{
            keepAlive: 1
        }
    },
    db: {
        numberOfRetries: 10,
        retryMiliSeconds: 1000
    }
} 
```

这比我声明的原始选项对象更受过教育。然而——还是不行。

现在，由于某种原因，我不得不离开那个 windows 盒子（与未在其上编译的模块有关） - 移动比再花一周时间试图让它工作更容易。

所以我将我的应用程序移至 nodejitsu。**低，看我的连接还活着！哇！**

所以…。这是什么意思……我不知道！我所知道的是这些选项似乎适用于 Nodejitsu ...... 为了我。

我相信 IISNode 使用某种“永远”脚本来保持应用程序的运行。现在公平地说，应用程序不会因为启动而崩溃，但我认为必须有某种不断刷新的“应用程序周期” - 这就是它可以进行持续部署的方式（ftp代码，无需重新启动应用程序）-也许这是一个因素；但我现在只是猜测。

当然这一切意味着现在，这还没有解决。它仍然没有解决。它只是在我的设置中为我解决了。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-27T02:49:48.837

对于仍然遇到此问题的人的一些建议：

1.  确保您使用的是最新的 mongodb 客户端 node.js。从 v1.2.x 迁移到 v1.3.10（截至今天的最新版本）时，我注意到这方面的显着改进

2.  您可以将选项对象传递给 MongoClient.connect。从 Azure 连接到 MongoLab 时，以下选项对我有用：

    options = { db: {}, server: { auto_reconnect: true, socketOptions: {keepAlive: 1} }, replSet: {}, mongos: {} };

    MongoClient.connect(dbUrl, options, function(err, dbConn) { // 你的代码 });

3.  请参阅this other answer，其中我描述了如何处理似乎更可靠的“关闭”事件。[https://stackoverflow.com/a/20690008/446681](https://stackoverflow.com/a/20690008/446681)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T03:21:27.693

启用这样的`auto_reconnect` [`Server`](http://mongodb.github.com/node-mongodb-native/api-generated/server.html?highlight=server#server)选项：

```
var db = mongoose.connect(mongoConnect, {server: {auto_reconnect: true}}); 
```

您在此处打开的连接实际上是一个包含 5 个连接的池（默认情况下），因此您只需连接并保持打开状态是正确的。我的猜测是，您会间歇性地失去与 mongolab 的连接，而当这种情况发生时，您的连接就会消失。希望启用`auto_reconnect`可以解决这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-18T10:53:24.020

增加超时可能会有所帮助。

*   "socketTimeoutMS" ：在超时之前套接字上的发送或接收需要多长时间。
*   "wTimeoutMS" ：它控制服务器等待写关注得到满足的毫秒数。
*   "connectTimeoutMS" ：在超时之前打开连接需要多长时间（以毫秒为单位）。

    > $m = new MongoClient("mongodb://127.0.0.1:27017", array("connect"=>TRUE, "connectTimeoutMS"=>10, "socketTimeoutMS"=>10, "wTimeoutMS"=>10));
    > 
    > ```
    >  $db= $m->mydb;
    >     $coll = $db->testData;
    >     $coll->insert($paramArr); 
    > ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T17:46:29.050

我有一个类似的问题，[定期与 MongoDB 断开连接](https://stackoverflow.com/q/14301725/266536)。做两件事解决了它：

1.  确保您的计算机永不休眠（这会破坏您的网络连接）。
2.  绕过您的路由器/防火墙（或正确配置它，我还没有弄清楚如何去做）。

# php - 您如何执行由 Radiant CMS 构建的页面的 PHP 组件？

> ID：13980237
> 
> 赞同：-1
> 
> 时间：2012-12-20T20:48:11.540
> 
> 标签：php, ruby-on-rails, radiant

我在具有 PHP 组件的页面上有一个脚本。我的整个网站都在使用 RadiantCMS 进行管理。目前，我的虚拟主机上的 PHP 已关闭，因为有人告诉我 PHP 和 Rails 不能很好地协同工作。所以目前，由于 PHP 组件没有执行，脚本将不会运行。

我不太确定如何继续或解决这个问题。只有 1 个页面需要执行 PHP 脚本，以便主 javascript 将运行，但问题是让 PHP 与 Rails 一起运行，我不确定它如何影响我当前基于 Radiant 的所有其他网站页面。

这只是不可行的实施吗？否则，如果我的虚拟主机打开 PHP，我不知道会发生什么。当我通过 Radiant 部署整个站点时，我是否应该假设这就是 PHP 运行所需的全部内容？

我查看了与 Rails 一起运行的 PHP 上的几个线程，但不知道如何使其适用于我的情况。对不起，我不是开发人员，我对后端不太了解。

在联系我的网络托管服务提供商之前，我仍在等待我想使用的脚本开发人员的回复。同时，我们将不胜感激任何建议或可能的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T22:11:12.183

通常“打开”其他编程或脚本语言（如 PHP 或 Ruby）不会相互干扰。如果您使用 RadiantCMS 并因此使用 Ruby 来生成您网站的内容，您可能会遇到将 PHP 程序集成到此环境中的麻烦。

告诉供应商开启 PHP 不会对您的活动安装造成任何问题。并且应该有一种方法可以以某种方式执行 PHP - 使用正确的网络服务器设置 - 并让脚本运行。试一试。

无论如何，如果你不熟悉编程，你应该得到一些帮助。因为将脚本上传到服务器时所做的事情是有问题的；每个人都可以通过请求网络服务器来执行它。这可能是一个安全问题。请记住这一点。

# makefile - 如果语句没有被正确评估（automake、makefile.am）

> ID：13980243
> 
> 赞同：0
> 
> 时间：2012-12-20T20:48:43.113
> 
> 标签：makefile, automake

现在我终于让 xmonad 可以很好地与 MATE DE 配合使用，但我会尝试将[GNOME2/3/XFCE4 面板小程序移植](https://github.com/alexkay/xmonad-log-applet)到 mate 上，因为 MATE 本质上是 GNOME2。

到目前为止，我已经为 MATE 添加了必要的依赖项，ifdef 等，并且运行`autogen.sh --with-panel=mate`会吐出一个显示任何错误的 Makefile。但是，运行`make`会出现此错误：`Makefile:770: *** missing separator. Stop.`这是我的 Makefile： http: [//pastebin.com/bLF9TD4M](http://pastebin.com/bLF9TD4M)。

这是导致错误的部分：

```
#    $(applet_files): $(applet_files:.desktop=.desktop.in)
#           $(SED) -e "s|\@PLUGIN_DIR\@|$(PLUGIN_DIR)|" $< > $@
    if PANEL_MATE
        applet_files = org.mate.panel.XmonadLogApplet.panel-applet
        $(applet_files): $(applet_files:.panel-applet=.panel-applet.in)
                $(SED) -e "s|\@PLUGIN_DIR\@|$(PLUGIN_DIR)|" $< > $@
    else
        applet_files = org.gnome.panel.XmonadLogApplet.panel-applet
        $(applet_files): $(applet_files:.panel-applet=.panel-applet.in)
                $(SED) -e "s|\@PLUGIN_DIR\@|$(PLUGIN_DIR)|" $< > $@
    endif

    if !PANEL_MATE
        servicedir = $(SESSION_BUS_SERVICES_DIR)
        service_in_files = org.gnome.panel.applet.XmonadLogAppletFactory.service.in
        service_DATA = $(service_in_files:.service.in=.service)
        org.gnome.panel.applet.XmonadLogAppletFactory.service: $(service_in_files)
                $(SED) -e "s|\@PLUGIN_DIR\@|$(PLUGIN_DIR)|" $< > $@
    else
        servicedir = $(SESSION_BUS_SERVICES_DIR)
        service_in_files = org.mate.panel.applet.XmonadLogAppletFactory.service.in
        service_DATA = $(service_in_files:.service.in=.service)
                org.mate.panel.applet.XmonadLogAppletFactory.service: $(service_in_files)
                $(SED) -e "s|\@PLUGIN_DIR\@|$(PLUGIN_DIR)|" $< > $@
    endif 
```

这些 IF 语句是 Makefile.am 文件的剩余部分，它们不应该在这里。如果我手动删除 if 语句（将相关内容保留在其中）并运行 make，我会得到：

```
make  all-am
make[1]: Entering directory `/home/ari/development/xmonad-log-applet'
gcc -DHAVE_CONFIG_H -I.  -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include   -I/usr/include/dbus-1.0 -I/usr/lib/x86_64-linux-gnu/dbus-1.0/include -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include      -g -O2 -MT xmonad_log_applet-main.o -MD -MP -MF .deps/xmonad_log_applet-main.Tpo -c -o xmonad_log_applet-main.o `test -f 'main.c' || echo './'`main.c
main.c:15:21: fatal error: gtk/gtk.h: No such file or directory
compilation terminated.
make[1]: *** [xmonad_log_applet-main.o] Error 1
make[1]: Leaving directory `/home/ari/development/xmonad-log-applet'
make: *** [all] Error 2 
```

这是我第一次真正使用 makefile 和 automake，所以任何帮助将不胜感激。这是我在 github 上的修改：[https ://github.com/geniass/xmonad-log-applet](https://github.com/geniass/xmonad-log-applet)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T17:09:06.057

您不能`if`在 Automake 中的块内缩进代码。（Makefile 对缩进很敏感。）

# javascript - jQuery Domino 类似滑块插件

> ID：13980248
> 
> 赞同：8
> 
> 时间：2012-12-20T20:48:55.597
> 
> 标签：javascript, jquery, html, transition

我正在寻找一个基于 jQuery 的内容滑块插件。我的意思不是[这样](http://www.mr-j.it/demo/factory_galleries/example/)的（其中太多了），也不是[jQueryUI 滑块](http://jqueryui.com/slider/)。我正在寻找的东西可以用图片来最好地描述。

是否有一个 jQuery 插件允许我将某些元素滑出（或转换）视口并在其位置滑动新元素？理想情况下，我希望能够以（某种）系列的形式将几个元素从页面上移开并放回页面，而不是一个接一个。缓和这些元素的能力，而不是以线性速度滑动它们，将是非常棒的。

这张照片是我能想到的最好的视觉效果：

![在此处输入图像描述](../Images/88c6cd750f21660b10e56f698c809880.png)

我知道我可以开发一个插件，就像我以前做过几个一样，但如果可能的话，我想避免重新发明轮子。谁能推荐一个插件？

感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:01:38.150

如果你支持 CSS3，你可以尝试做这样的事情，尽管构建一个动画类可能会更好。

```
.item:nth-child(1)
{
transition-timing-function            : ease-in-out;       
transition-property                    : left;
transition-duration                    : 0.1s;
transition-delay                    : 0.35s;
}

item:nth-child(2)
{
transition-timing-function            : ease-in-out;       
transition-property                    : left;
transition-duration                    : 0.1s;
transition-delay                    : 0.55s;
}

.item:nth-child(3)
{
transition-timing-function            : ease-in-out;       
transition-property                    : left;
transition-duration                    : 0.1s;
transition-delay                    : 0.65s;
}

.item:nth-child(4)
{
transition-timing-function            : ease-in-out;       
transition-property                    : left;
transition-duration                    : 0.1s;
transition-delay                    : 0.75s;
}​ 
```

如果您想使用 jQuery，我已经在[http://api.jquery.com/queue/](http://api.jquery.com/queue/)上取得了一些成功，这将允许您制作更复杂的链式动画。对于未知数量的孩子，您可以使用该`slice()`方法。

[我已经更改了在http://paulirish.com/2008/sequentially-chain-your-callbacks-in-jquery-two-ways/](http://paulirish.com/2008/sequentially-chain-your-callbacks-in-jquery-two-ways/)上找到的这段自动执行代码

```
(function hidenext(jq){
jq.eq(0).fadeOut("fast", function(){
    (jq=jq.slice(1)).length && hidenext(jq);
});
 })($('div')) 
```

您不必使用`fadeOut`它，也不需要自动执行，但它是一种将“过渡”应用于未知数量元素的整洁方式。

[这是一个使用淡出http://jsfiddle.net/NpBfJ/](http://jsfiddle.net/NpBfJ/)的小提琴...这可能比您想要的要多...:-)

关于滑块，这是最好的免费滑块之一[http://caroufredsel.dev7studios.com/](http://caroufredsel.dev7studios.com/)它有许多可定制的功能。

# android - Android - 并非所有日志都出现在 logcat 输出中

> ID：13980249
> 
> 赞同：0
> 
> 时间：2012-12-20T20:49:05.777
> 
> 标签：android, debugging, android-logcat

我正在使用 windows cmd 终端使用以下命令输出我的应用程序的日志：

```
adb.exe logcat | find "%part_of_my_apps_name%" 
```

但是，并非所有日志都出现在输出中。只有这样的消息：

```
I/AppService(10597): Received start id 1: Intent { cmp=package_name/.AppService(has extras) } 
```

在我的`AppService`我有以下代码：

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {

    Log.i(TAG, "Received start id " + startId + ": " + intent);
    Log.i(TAG, "Test"); 
```

那么我做错了什么？

**UPD**：我问了一个错误的问题。我实际上使用了我的应用程序名称的一部分，而不是包，所以它必须出现在日志输出中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:44:56.370

根据你的`TAG`变量是什么，你使用命令

```
adb.exe logcat -s "[tagname]" 
```

例如，如果在我的代码中，我的 TAG 被声明为：

```
public static final String TAG = "com.myapp"; 
```

我的 LogCat 将是

```
adb.exe logcat -s "com.myapp" 
```

看来引号也是可选的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:51:42.170

但是，我使用了应用程序名称的一部分，因为`"find"`基本上`case sensitive`它确实只显示了那个特定的输出（名称出现在包名称中），所以我想出了以下命令：

```
adb.exe logcat -v time | find "%part_of_my_apps_name%" /I 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:51:07.103

Logcat 输出与 不相关，但与您在代码中使用`package name`的字符串相关联。`TAG`您可以将所有标签更改为 your `package name`，或者您可以明确地将您添加`package name`到每`Log.i/w/e/v()`行的消息中，然后您将获得所需的行为。但是，我实际上会使用 @A--C 建议，因为它允许您仅对特定类的输出进行更精细的过滤。

# file - AppHarbor 上托管的应用程序，如何保存上传的图像？

> ID：13980252
> 
> 赞同：0
> 
> 时间：2012-12-20T20:49:07.523
> 
> 标签：file, appharbor, paas, filepicker.io

AppHarbor（如 Heroku）不允许您保存上传的文件或图像。我需要在某个地方卸载它，我不知道为此目的存在哪些服务。

我查看了 FilePicker.io，但他们在上传程序中显示了俗气的品牌形象，要删除该品牌，你必须支付一大笔钱。

关于如何解决这个问题的任何建议？需要在 PaaS 上托管的文件上传的应用程序的作案方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T18:53:48.583

我们建议您使用 Amazon S3 来存储这样的文件。一位 AppHarbor 用户在支持论坛上撰写了[有关如何开始使用 S3 的指南](http://support.appharbor.com/discussions/problems/749-handling-uploading-files)。

# mongodb - 使用 mongoDB 中的新键更新对象数组

> ID：13980253
> 
> 赞同：4
> 
> 时间：2012-12-20T20:49:14.300
> 
> 标签：mongodb, insert, updates

类似于这个[问题](https://stackoverflow.com/questions/9209670/mongo-push-to-array-inside-array)

Barrowing 数据集，我有类似的东西：

```
{
    'user_id':'{1231mjnD-32JIjn-3213}',
    'name':'John',
    'campaigns':
        [
            {
                'campaign_id':3221,
                'start_date':'12-01-2012',
            },
            {
                'campaign_id':3222,
                'start_date':'13-01-2012',
            }
        ]
} 
```

我想像这样添加一个新密钥`campaigns`：

```
{
    'user_id':'{1231mjnD-32JIjn-3213}',
    'name':'John',
    'campaigns':
        [
            {
                'campaign_id':3221,
                'start_date':'12-01-2012',
                'worker_id': '00000'
            },
            {
                'campaign_id':3222,
                'start_date':'13-01-2012',
                'worker_id': '00000'
            }
        ]
} 
```

如何将`insert/update`新键放入对象数组？
我想在数组中的每个对象中添加一个新键，默认值为`00000`.

我努力了：
`db.test.update({}, {$set: {'campaigns.worker_id': 00000}}, true, true)`
`db.test.update({}, {$set: {campaigns: {worker_id': 00000}}}, true, true)`

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:48:34.933

我假设这个操作会发生一次，所以你可以使用脚本来处理它：

```
var docs = db.test.find();
for(var i in docs) {
    var document = docs[i];

    for(var j in document.campaigns) {
        var campaign = document.campaigns[j];
        campaign.worker_id = '00000';
    }

    db.test.save(document);
} 
```

该脚本将遍历集合中的所有文档，然后遍历每个文档中的所有活动，设置 *worker_id* 属性。最后，每个文档都被持久化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T09:13:49.650

```
db.test.update({}, {$set: {'campaigns.0.worker_id': 00000}}, true, true 
```

这将更新 0 元素。

如果你愿意，`add a new key into every object inside the array`你应该使用： `$unwind`

例子：

```
{
  title : "this is my title" ,
  author : "bob" ,
  posted : new Date() ,
  pageViews : 5 ,
  tags : [ "fun" , "good" , "fun" ] ,
  comments : [
      { author :"joe" , text : "this is cool" } ,
      { author :"sam" , text : "this is bad" }
  ],
  other : { foo : 5 }
} 
```

展开标签

```
db.article.aggregate(
    { $project : {
        author : 1 ,
        title : 1 ,
        tags : 1
    }},
    { $unwind : "$tags" }
); 
```

结果：

```
{
     "result" : [
             {
                     "_id" : ObjectId("4e6e4ef557b77501a49233f6"),
                     "title" : "this is my title",
                     "author" : "bob",
                     "tags" : "fun"
             },
             {
                     "_id" : ObjectId("4e6e4ef557b77501a49233f6"),
                     "title" : "this is my title",
                     "author" : "bob",
                     "tags" : "good"
             },
             {
                     "_id" : ObjectId("4e6e4ef557b77501a49233f6"),
                     "title" : "this is my title",
                     "author" : "bob",
                     "tags" : "fun"
             }
     ],
     "OK" : 1
} 
```

在您可以编写简单的更新查询之后。

# asp.net - 我可以在 tableA.myColumn = tableB.myColumn 的地方内连接两个 DataTables 吗？

> ID：13980261
> 
> 赞同：0
> 
> 时间：2012-12-20T20:50:21.507
> 
> 标签：asp.net, vb.net, datatable

我正在解析 Excel 工作簿并将数据提取到两个 DataTables 中，如下所示：

```
If SetDBConnect("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & filepath & ";
Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1""", True) Then

'Get total dollars table
 sql.Append("SELECT * FROM [" & totalDollars & "]")
 dt = _dh.GetTable(sql.ToString())

sql.Length = 0
sql.Append("SELECT * FROM [" & totalUnits & "]")
dt_units = _dh.GetTable(sql.ToString())
End If 
```

这两个电子表格完全相同，只有一个区别。在“总美元”电子表格中，有一列包含美元金额，而在“总单位”电子表格中，它是一个包含单位金额的列。

我想`INNER JOIN`这两个表`WHEN`tableA.UPC = tableB.UPC。这可能吗？我已经阅读了有关 DataSets 和 DataRelations 的信息，但我想知道是否有更简单的方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:16:03.123

使用 Linq 的一个简单方法是：

```
var query = from c in dt.AsEnumerable()
            join r in dt_units.AsEnumerable() 
            on c.Filed<string>("UPC") equals r.Field<string>("UPC")
            select new {
                  UPC= r.Field<string>("UPC"),
                  //and so on.. you pick whatever columns you need from each table
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T22:37:25.300

不要对此投赞成票，但想粘贴一个 VB .NET 版本：

```
Dim query = From c In dt.AsEnumerable() _
        Join r In dt_units.AsEnumerable() _
        On c.Field(Of String)("UPC") Equals r.Field(Of String)("UPC") _
        Select New With
        {
              .UPC = r.Field(Of String)("UPC")
        } 
```

# django - 在 Django 中报告 403 错误

> ID：13980263
> 
> 赞同：2
> 
> 时间：2012-12-20T20:50:24.967
> 
> 标签：django, error-reporting

目前我已经设置了我的生产环境，以便在出现 500 错误时通过电子邮件向 MANAGERS 发送电子邮件。我还想在有人试图访问他们无权访问的东西时收到电子邮件（即，他们产生 403 错误）。

[据我所知，当有人产生 404（ https://docs.djangoproject.com/en/dev/howto/error-reporting/#errors](https://docs.djangoproject.com/en/dev/howto/error-reporting/#errors) ）时，您可以轻松地让 Django 向您发送电子邮件，但没有这样的对于 403。

当有人产生 403 时，让 Django 发送电子邮件的最佳方法是什么？

# jquery - Jquery 选项卡 - 使用外部 URL 链接

> ID：13980268
> 
> 赞同：2
> 
> 时间：2012-12-20T20:51:08.810
> 
> 标签：jquery, user-interface, tabs, hyperlink

我正在使用 Jquery UI 选项卡，并且有一个问题。

```
<div id="ui-tabs">
    <ul>
        <li><a href="#tab-1"><span>My First Tab</span></a></li>
        <li><a href="#tab-2"><span>My Second Tab</span></a></li>
        <li><a href="http://www.someothersite.com/"><span>My Third Tab</span></a></li>
    </ul>
</div> 
```

是否有可能让**第三个选项卡**在单击时实际转到场外 URL？我试过这个，但链接被忽略了，所以我不确定我是否做错了什么，或者它是否不可能如所写。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:02:03.497

它不漂亮，但这有效

```
 <li><a href="#tabs-3"><a href="http://espn.com">ESPN</a></a></li> 
```

示例在这里[http://codepen.io/martypowell/pen/leGaz](http://codepen.io/martypowell/pen/leGaz)

# windows-7-x64 - CreateRemoteThread 失败并显示 ERROR_ACCESS_DENIED

> ID：13980270
> 
> 赞同：0
> 
> 时间：2012-12-20T20:51:22.913
> 
> 标签：windows-7-x64, dll-injection

我正在尝试学习 dll 注入的基础知识，因此我创建了一个非常简单的 hello-world 类型的 DLL 和一个基于我在网上找到的代码的注入器。我找不到任何开箱即用的东西，所以我不得不做一些调整。

[注入代码](http://pastebin.com/7s05REuM), [DLL代码](http://pastebin.com/PPwuaLiE)

我在 64 位窗口上运行这些。我正在使用 Visual Studio 2010 进行编译。注入器是一个 win32 控制台应用程序，dll 也是 win32。我正在尝试将我的代码注入现有的记事本进程（也是 32 位）。所有这些都在 Windows 7 x64 上运行。

当我运行注入器时，它每次都失败`CreateRemoteThread`，`GetLastError`返回 5（即`ERROR_ACCESS_DENIED`）。我已经确认 dll 路径是正确的（尽管将其更改为虚假路径会产生相同的行为），并且我已经确认该路径正在使用[Cheat Engine](http://www.cheatengine.org/)在正确的地址写入记事本的内存。我遇到了困难，因为我不确定如何进一步调试问题。

什么可能导致 CreateRemoteThread 失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T18:25:13.940

问题是 notepad.exe 是 64 位窗口中的 64 位进程，而我试图用 32 位进程注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-28T08:39:57.867

我也想出了同样的问题。我的情况是这样的：

1.  我的系统是 64 位的，记事本也是 64 位的。

2.  但是注入器是32位进程。

我的解决办法是把系统目录下的64位记事本换成32位记事本。

# html - 图片未出现在现场；直接通过url访问

> ID：13980272
> 
> 赞同：17
> 
> 时间：2012-12-20T20:51:34.347
> 
> 标签：html, image

我有一个 HTML 站点，它使用了几个无法在 Chrome 中加载的图像 [编辑：在某些人的 Firefox 中，不是我的]。

使用 Chrome 检查器，我可以看到它们的大小为 1px x 1px。另外，正在将以下内联样式添加到 jpg（不是 png）中：`style="display: none !important; visibility: hidden !important; opacity: 0 !important; background-position: 0px 0px;" width="0" height="0"`在我的网站上，但不在 jsfiddle 中。（让我们专注于第一部分。）

当我在本地查看同一个站点时，它们显示正常。有没有搞错？看看：http: [//jsfiddle.net/3HtPH/2/](http://jsfiddle.net/3HtPH/2/)。

编辑：感谢 Gaby aka G. Petrioli，我发现这是由于 AdBlock，我安装在 Chrome 而不是我的其他浏览器上，阻止了任何名为“ad-_”的资源。AdBlock 还阻止了大量以“ad”开头的类和 id 名称。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-20T21:17:31.967

未加载的图像被命名为***ad*** -something..

这意味着您有一个广告拦截器（*浏览器插件*）会阻止那些认为它们是广告的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:57:10.510

主机使用[防盗链](http://en.wikipedia.org/wiki/Inline_linking#Prevention)，即他们阻止从他们自己的域之外使用他们的图像。

# ruby-on-rails - 修改 en.yml 文件以验证错误消息 rails 3

> ID：13980274
> 
> 赞同：3
> 
> 时间：2012-12-20T20:51:47.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-i18n

我从来没有真正处理或理解过 en.yml 文件，因为我过去没有使用过它，今天我试图改变它并自定义表单提交失败时显示的验证错误消息

我有一个食谱模型和一个提交食谱的表单。目前我的 en.yml 文件看起来像这样

```
 en:  
   activerecord:
    models: 
     recipe: 

    attributes:
     user:
      email: 
       errors:
         models:
          recipe:
           attributes:
            dish_name:
             blank: "Dont forget to give your Recipe a Dish Name" 
```

现在显然这是错误的，我正在寻找有关如何布局文件的一些帮助，也许是对正在发生的事情的解释，我阅读了文档，但是对于我的 Rails 技能水平来说，它的水平有点太高了。

目前，如果对 disc_name 的验证失败，即它的空白，我会收到此错误消息

```
Dish name Dont forget to give your Recipe a Dish Name 
```

任何帮助表示赞赏

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T21:14:09.707

您需要覆盖错误消息的默认格式：

```
en:
  errors:
    format: "%{message}"

  activerecord:
    errors:
      models: 
        recipe: 
          attributes:
            dish_name:
              blank: "Dont forget to give your Recipe a Dish Name" 
```

然后你应该得到想要的消息：

```
Dont forget to give your Recipe a Dish Name 
```

请记住，这也会覆盖其他 ActiveRecord 模型的格式。您还需要为您将支持的任何其他语言环境指定格式，否则 rails 将默认显示该属性。

# sql - sql查询错误

> ID：13980276
> 
> 赞同：1
> 
> 时间：2012-12-20T20:51:49.947
> 
> 标签：sql

```
select E.Job_ID, count(*), max(Employee_Salary) as kos, avg(Employee_Salary)
    from Employee E  
    inner join JOB D on E.Job_ID = D.Job_ID
    group by E.Job_ID 
```

我想通过 D.Functio 订购我的结果，但我有这个错误

```
Msg 8120, Level 16, State 1, Line 1
Column 'JOB.Functio' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:53:20.497

错误消息有什么不清楚的地方？您正在尝试按未聚合的内容进行排序。这是一种解决方案：

```
order by max(d.Functio) 
```

问题是别名“job”未知。您需要使用分配给表格的“d”。

这应该可行，因为大概有一个 job.Functio 每个作业 ID。另一个解决方法是将其更改`group by`为：

```
group by e.Job_ID, d.Job.Functio 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T20:55:06.767

如果它是描述性列（工作职能？），您想将其添加到您的 GROUP BY

```
select E.Job_ID, count(*), max(Employee_Salary) as kos, avg(Employee_Salary)
    from Employee E  
    inner join JOB D on E.Job_ID = D.Job_ID
    group by E.Job_ID, D.Functio
    order by D.Functio 
```

否则，在排序中，您需要应用一个聚合函数，如 min()、max()、avg() 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T20:55:21.403

包括`D.Functio`在`Select`和`Group by`

```
select E.Job_ID, D.Functio,
     count(*), max(Employee_Salary) as kos, avg(Employee_Salary)
from Employee E  
inner join JOB D on E.Job_ID = D.Job_ID
group by E.Job_ID, D.Functio
order by D.Functio 
```

# javascript - Javascript SFDC 自定义案例按钮 - 希望“新评论”窗口在父窗口中呈现，如关闭案例（Salesforce 自定义按钮）

> ID：13980277
> 
> 赞同：0
> 
> 时间：2012-12-20T20:51:54.690
> 
> 标签：javascript, salesforce

我创建了一个自定义案例升级按钮（见下文），执行 javascript 以：

1.  将案例所有者更改为队列
2.  将案例状态更改为已升级
3.  并允许支持代理在升级和父页面重新加载之前添加评论。

它工作正常，但支持代表希望新的评论页面呈现在同一个父页面中（与关闭案例按钮的工作方式相同），我只是无法弄清楚执行此操作的语法或功能。

它现在的工作方式是打开一个新窗口以添加评论，然后在保存此子窗口后关闭并使用更新的数据刷新父窗口。

非常感谢您的帮助！

```
{!REQUIRESCRIPT("/soap/ajax/13.0/connection.js")}

var caseObj = new sforce.SObject("Case");
caseObj.Id = '{!Case.Id}';
parent.ID='{!Case.ParentId}'
caseObj.Status = 'Escalated';
caseObj.OwnerId = '00GE0000001ZsMH';
onclick='window.close()';
window.open('/00a/e?parent_id={!Case.Id}&retURL=/{!Case.Id}');
var result = sforce.connection.update([caseObj]);

if (result[0].success=='false') {
     alert(result[0].errors.message);
} else {

     location.reload(true);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:36:52.083

There isn't really a good way you can do that with just a Javascript button. A better choice would be a little Visualforce page which allows the agent to enter the comment and sets the status and owner accordingly on save.

# android - 对如何使用 Mockito 进行 android 测试感到困惑

> ID：13980281
> 
> 赞同：10
> 
> 时间：2012-12-20T20:52:00.727
> 
> 标签：android, mockito, robolectric

我正在尝试为我的 android 应用程序编写一个单元测试，但是在使用 mockito 做我想做的事情时遇到了麻烦。这与 Robolectric 结合使用，我工作得很好，并且已经证明单元测试有效。

我想根据是否连接了一些蓝牙设备来测试按钮是否会打开新活动。显然，在我的测试中没有连接蓝牙的设备，但是我想假装好像有。蓝牙连接的状态存储在我的应用程序类中。没有可公开访问的方法来更改此值。

所以基本上应用程序中的逻辑是这样的：

**HomeActivity.java：**

```
//this gets called when the button to open the list is clicked.
public void openListActivity(View button) { 
  MyApplication myApplication = (MyApplication) getApplication();
  if (myApplication.isDeviceConnected() {
      startActivity(new intent(this, ListActivity.class));
   }
} 
```

所以为了测试这一点，我做了以下事情：

**TestHomeActivity.java：**

```
@Test
public void buttonShouldOpenListIfConnected() {
    FlexApplication mockedApp = Mockito.mock(MyApplication.class);
    Mockito.when(mockedApp.isDeviceConnected()).thenReturn(true);
    //listViewButton was setup in @Before
    listViewButton.performClick();
    ShadowActivity shadowActivity = Robolectric.shadowOf(activity);

    Intent intent = shadowActivity.getNextStartedActivity();
    assertNotNull(intent); //this fails because no new activity was opened. I debugged this and found that isDeviceConnected returned false.
    ShadowIntent shadowIntent = Robolectric.shadowOf(intent);
    assertThat(shadowIntent.getComponent().getClassName(), equalTo(ListActivity.class.getName()));
} 
```

所以我的单元测试失败了，因为对 isDeviceConnected 的调用（在活动中）返回 false，即使我*认为*我告诉它使用模拟框架返回 true。我希望我的测试让这个方法返回 true。这不是 mockito 所做的，还是我完全误会了如何使用 mockito？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T21:06:32.177

这就是 mockito 的工作原理，但问题是：你`listViewButton`使用的是你的`mockedApp`? 似乎不是，因为您是`mockedApp`在测试方法上创建的，并且从未在任何地方设置它。Mockito 不会模拟 的所有实例的方法调用`Application`，只会从您声明为模拟的内容中模拟。

我个人不知道 android 如何与`Application`该类一起工作，但是您必须将其设置在某个位置，以便 listView 使用您的`mockedApp`而不是它通常接收的内容。

**编辑** 更新问题后，您可以将您的方法转换`getApplication`为受保护的方法，并使其返回您[`spy`](http://mockito.googlecode.com/hg-history/1.5/javadoc/org/mockito/Mockito.html#spy%28T%29)的. 这闻起来有点难闻，但如果您不能将应用程序模拟对象设置为.`listViewButton``mockedApp``listViewButton`

**编辑2**

在测试中使用 spy 以[`BDDMockito`](http://docs.mockito.googlecode.com/hg/org/mockito/BDDMockito.html)提高可读性的示例:)

```
public HomeActivity {
    ...
    protected MyApplication getApplication() {
       // real code
    }
    ...
}

public void TestHomeActivity {
   private HomeActivity homeActivity;

   @Before
   public void setUp() {
       this.homeActivity = spy(new HomeActivity());
   }

   @Test
   public void buttonShouldOpenListIfConnected() {
       // given
       FlexApplication mockedApp = Mockito.mock(MyApplication.class);
       Mockito.when(mockedApp.isDeviceConnected()).thenReturn(true);
       // IMPORTANT PART
       given(homeActivity.getApplication()).willReturn(mockedApp);
       ...
   }
} 
```

之后，您的测试应该按预期工作。但我强调：`spy`仅当您无法注入`mockedApp`内部 HomeActivity 时才使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:08:52.077

您的模拟版本没有被调用。

看到那个电话，`getApplication()`？（以下）。这将返回您的 MyApplication 类的真实副本，而不是您的模拟版本。您需要拦截`getApplication()`调用并传入模拟的 Application 对象。

```
HomeActivity.java:

//this gets called when the button to open the list is clicked.
public void openListActivity(View button) { 
    MyApplication myApplication = (MyApplication) getApplication(); // returns the real thing
    if (myApplication.isDeviceConnected() {
        startActivity(new intent(this, ListActivity.class));
   }
} 
```

我不确定这对 Mockito 是否可行。您是否尝试过自定义 ShadowActivity#getApplication() 方法？

# hash - 在 OpenLDAP 中启用密码散列

> ID：13980285
> 
> 赞同：1
> 
> 时间：2012-12-20T20:52:07.293
> 
> 标签：hash, openldap

如何在 OpenLDAP 中启用密码散列？似乎 OpenLDAP 已默认`password-hash`设置为`{SSHA}`，但每当我`userPassword`使用 Apache Directory Studio 在属性中输入明文密码时，它仍以明文形式存储。我期待它被 OpenLDAP 转换为 SSHA。

我也尝试`password-hash {SSHA}`输入`slapd.conf`文件，但这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-26T07:36:08.190

当您尝试`userPassword`在添加/修改 LDAP 操作中存储属性时， `userPassword`值将存储为纯文本。但是您可以使用OpenLDAP`ppolicy_hash_cleartext`中覆盖模块中的选项 来覆盖此行为。`ppolicy`启用后，当客户端发送纯文本密码时，默认存储为 SSHA。[您可以从此处](http://xacmlinfo.org/2015/06/25/enable-hash-passwords-in-openldap/)找到有关在 OpenLADP 中启用哈希密码的配置详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:06:27.887

当您直接设置属性时，您正在设置实际值，可以散列也可以不散列（正如您已经发现的那样）。

以下引用自[常见问题解答](http://www.openldap.org/faq/data/cache/347.html)： 首先，使用 'slappasswd' 实用程序生成密码，这样您就可以检查您的 PHP 例程是否正确。（slappasswd 实用程序是 openldap 发行版的一部分）。命令

```
slappasswd -h {SHA} -s supersecretpassword 
```

可能会有所帮助。

# c# - 使用流水线的 ServiceStack Redis 客户端批量插入

> ID：13980291
> 
> 赞同：7
> 
> 时间：2012-12-20T20:52:41.037
> 
> 标签：c#, redis, servicestack

我必须一次将大约 80,000 行插入到 redis 中，并且正在考虑使用 redis 流水线来执行此操作。然而，当测试仅插入 1000 行时，使用流水线需要 46 秒，而没有流水线需要 6 秒。

在下面的代码中，我有一个按邮政编码分组的邮政编码列表，我试图插入到 redis 中。它们作为 RedisZipCode 插入，其中包含作为 id 的邮政编码和在分组期间收集的邮政编码列表。

```
public class ZipCode
{
    public string city { get; set; }
    public string state { get; set; }
    public string zip_code { get; set; }
}

public class RedisZipCode
{
    public string id { get; set; }
    public List<ZipCode> zipcodes{ get; set; }
} 
```

**没有流水线**

```
using (var zipCodeClient = redisClient.GetTypedClient<RedisZipCode>())
{
    foreach (var item in zipcodes.GroupBy(z => z.zip_code))
    {
        zipCodeClient.Store(new RedisZipCode(item.ToList()));
    }
} 
```

**使用流水线**

```
using (var zipCodeClient = redisClient.GetTypedClient<RedisZipCode>())
using (var pipeline = zipCodeClient.CreatePipeline())
{
    foreach (var item in zipcodes.GroupBy(z => z.zip_code))
    {
        pipeline.QueueCommand(c => c.Store(new RedisZipCode(item.ToList())));
    }
    pipeline.Flush();
} 
```

# android - 为什么我的 bindService 函数失败了？

> ID：13980294
> 
> 赞同：0
> 
> 时间：2012-12-20T20:52:54.720
> 
> 标签：android, service

我无法在我的活动中绑定我的服务。你知道为什么吗？绑定服务返回假。我不知道为什么。甚至没有异常被抛出。

`public class GPSService extends Service {`

 ````
private final IBinder _IBinder = new GPSBinder( );

public class GPSBinder extends Binder {
    public GPSService getService( ) { 
        return GPSService.this;
    }
} 

@Override
public void onCreate( ) { 
    super.onCreate( );
    }

@Override
public IBinder onBind(Intent intent) {  
    return _IBinder;
}

@Override
public boolean onUnbind( Intent intent ){ 
    return super.onUnbind( intent ); 
} 
````  `在 onStart 中绑定：

`servCon = new ServiceConnection( ){`

 ````
 @Override
        public void onServiceConnected(ComponentName name, IBinder service) {
            Log.d("GPS", "Serv conn");
        }

        @Override
        public void onServiceDisconnected(ComponentName name) {
            Log.d("GPS", "Serv disc");
        }

    };
    boolean ret = bindService( new Intent( this, GPSService.class), servCon, Activity.BIND_AUTO_CREATE ); 
````  `ret 值等于 false。``

# browser - 浏览器升级警告信息

> ID：13980295
> 
> 赞同：0
> 
> 时间：2012-12-20T20:52:55.050
> 
> 标签：browser, cross-browser

作为我公司的唯一开发人员，我真的厌倦了支持旧版浏览器（主要是 IE）。我想向用户显示一条好消息，让他们知道他们正在使用已弃用的浏览器，事情可能不太正确，并提供有关如何升级的说明。是否有一个托管的 JS 小部件我可以包含在可以完成此操作的页面中？

我不反对自己制作，只是认为如果存在这样的东西，使用现有服务可能会很好。

（在每月大约 10k 的唯一身份中，5% 使用 IE 7 或更低版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T23:52:31.833

听起来你可能想尝试这样的事情：http: [//browser-update.org/](http://browser-update.org/)

# javascript - Javascript变量范围的问题

> ID：13980298
> 
> 赞同：6
> 
> 时间：2012-12-20T20:53:09.927
> 
> 标签：javascript, function, variables, scope

我有一个变量 mutedUser，我希望将其保留到另一个函数。我在点击事件之外持续存在的变量有点麻烦。拥有它的最佳方法是什么，以便“return mutedUser”将根据满足 if 语句的条件保持“静音”字符串添加？谢谢！

*console.log 是我检查持久性停止的地方

```
this.isUserMuted = function isUserMuted(payload) {
  var mutedUser = '';
  // If mute button is clicked place them into muted users list
  // check for duplicates in list
  $("#messages-wrapper").off('click', '.message button.muteButton');
  $("#messages-wrapper").on('click', '.message button.muteButton', function(e) {

      $('#unMute').show();

      //create userId reference variable
      var chatUserID = parseInt($(this).parent().parent().attr("data-type"));

      //store userId in muted user object
      mutedUsers[chatUserID] = {};
      mutedUsers[chatUserID].id = chatUserID;
      mutedUsers[chatUserID].muted = true;

      if (mutedUsers[chatUserID] !== null && mutedUsers[chatUserID].id === payload.a) {
          console.log("user is now muted");
          mutedUser += ' muted';
          console.log(mutedUser + 1);
      }
      console.log(mutedUser + 2);
  });
  return mutedUser;
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:05:51.980

如果我了解您要做什么（通过查看代码），这将是最好的方法：

```
// If mute button is clicked place them into muted users list
// check for duplicates in list
$("#messages-wrapper").off('click', '.message button.muteButton');
$("#messages-wrapper").on('click', '.message button.muteButton', function(e) {
    $('#unMute').show();

    //create userId reference variable
    var chatUserID = parseInt($(this).parent().parent().attr("data-type"));

    //store userId in muted user object
    mutedUsers[chatUserID] = {};
    mutedUsers[chatUserID].id = chatUserID;
    mutedUsers[chatUserID].muted = true;
});

this.isUserMuted = function isUserMuted(payload) {
  var mutedUser = '';

  if (mutedUsers[payload.a] !== null) {
      mutedUser += ' muted';
  }

  return mutedUser;
}; 
```

代码保留 的数组`mutedUsers`，并且`isUserMuted`函数检查提供的用户是否在该数组中。在您提供的代码中，您将在每次`isUserMuted`调用函数时附加一个新的事件处理程序。

该`isUserMuted`功能甚至可以缩短为：

```
this.isUserMuted = function isUserMuted(payload) {
  return mutedUsers[payload.a] !== null ? ' muted' : '';
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T20:56:29.357

**编辑**

抱歉，是我的错。另一种方法是传入该变量，即

```
this.isUserMuted = function isUserMuted(payload, isMuted) {
  isMuted = '';
  // If mute button is clicked place them into muted users list
  // check for duplicates in list
  $("#messages-wrapper").off('click', '.message button.muteButton');
  $("#messages-wrapper").on('click', '.message button.muteButton', function(e) {

      $('#unMute').show();

      //create userId reference variable
      var chatUserID = parseInt($(this).parent().parent().attr("data-type"));

      //store userId in muted user object
      mutedUsers[chatUserID] = {};
      mutedUsers[chatUserID].id = chatUserID;
      mutedUsers[chatUserID].muted = true;

      if (mutedUsers[chatUserID] !== null && mutedUsers[chatUserID].id === payload.a) {
          console.log("user is now muted");
          isMuted += ' muted';
          console.log(mutedUser + 1);
      }
      console.log(mutedUser + 2);
  });
  return isMuted;
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T21:15:41.767

你不能。如果从函数中返回一个字符串，它总是按值传递，即复制；它的价值不会再改变了。您需要返回一个可以访问局部变量的当前值的函数，或者一个具有正在更改的属性的对象。

由于您似乎已经有了一个对象，因此选项#2 在这里很适合：

```
function User() { // or whatever you have
    …

    var user = this;
    // If mute button is clicked place them into muted users list
    // check for duplicates in list
    $("#messages-wrapper").on('click', '.message button.muteButton', function(e) {

        $('#unMute').show();

        //store userId in muted user object
        mutedUsers[user.id] = user;
        user.muted = true;
    });
    this.muted = false;
    this.isUserMuted = function() {
        return this.muted ? ' muted' : '';
    }
} 
```

# rewrite - 如何为 Webrick 指定重写规则？

> ID：13980301
> 
> 赞同：0
> 
> 时间：2012-12-20T18:27:02.113
> 
> 标签：rewrite, ruby-on-rails

我正在使用启用 rails/angular html5mode 的应用程序在 Webrick 上运行。我想实现这一点：

服务器端

```
Using this mode requires URL rewriting on server side, basically you have to rewrite all your links to entry point of your application (e.g. index.html) 
```

可能与webrick有关吗？我想在我的开发环境中坚持使用 webrick。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:04:09.637

坦白说，我不会。

我喜欢开发环境与实际环境完全匹配。因此，如果您在生产中使用 Thin，例如，将 Thin 用于开发。

# c# - 如何为 Nullable 与类似的自定义 C# 结构不同？

> ID：13980303
> 
> 赞同：4
> 
> 时间：2012-12-20T20:53:25.690
> 
> 标签：c#, nullable, language-features, boxing

在[Nullable micro-optimizations, part one](http://ericlippert.com/2012/12/20/nullable-micro-optimizations-part-one/)中，Eric 提到它`Nullable<T>`有一种*奇怪的装箱行为*，这是类似的用户定义类型无法实现的。

C# 语言赋予预定义`Nullable<T>`类型的特殊功能是什么？尤其是那些不能在一个`MyNullable`类型上工作的。

当然，`Nullable<T>`有特殊的语法糖`T?`，但我的问题更多是关于语义的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-20T20:58:01.573

我的意思是：**没有盒装的 nullable 之类的东西**。当你装箱时`int`，你会得到一个装箱的引用`int`。当您装箱时`int?`，您将获得空引用或对装箱的引用`int`。你永远不会得到一个盒装的`int?`.

您可以轻松地制作自己的`Optional<T>`结构，但不能实现具有这种装箱行为的结构。`Nullable<T>`的特殊行为已融入运行时。

这一事实导致了许多奇怪的事情。例如：

*   [C# 4：动态和可空<>](https://stackoverflow.com/questions/3728752)

*   [C# 反射：如何获取 Nullable<int> 的类型？](https://stackoverflow.com/questions/8550209)

*   [无法在泛型方法中将类型更改为可为空](https://stackoverflow.com/questions/10318334)

仅供参考，还有其他方式可以使`Nullable<T>`类型“神奇”。例如，虽然它是一个结构类型，但它不满足结构约束。您无法制作具有该属性的自己的结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T20:53:25.690

[我在C# 规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)中找到了这两个：

*   运算符的`is`工作方式`T?`与对 的作用相同`T`，并且`as`运算符可以转换为可为空的类型。
*   对不可为空值类型进行操作的预定义和用户定义运算符被提升为这些类型的可空形式。

现在，以下是我认为**不限**于以下功能`Nullable<T>`：

*   a 中的值`switch`可以是可为空的类型。我不认为这很重要，因为 switch 还接受可以在 MyNullable 类型上定义的用户定义的隐式转换。
*   支持空 IDisposable 类型，在生成的 Dispose() 调用之前插入空检查。我不认为这很重要，因为我可以将 MyNullable 定义为一个类，然后它会是一样的。

这是我不确定的：

*   规范提到了装箱/拆箱和隐式/显式转换，但我不明白是否可以使用 MyNullable 实现相同的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T20:59:34.353

C# 提升了可空类型的运算符。例如：

```
int? SumNullableInts(int? a, int? b)
{
    return a + b;
} 
```

你必须做很多反射工作`MyNullable<T>`来支持它，然后下面会编译，它不应该：

```
MyNullable<List<string>.Enumerator> SumNullableEnumerators(MyNullable<List<string>.Enumerator> a, MyNullable<List<string>.Enumerator> b)
{
    return a + b;
} 
```

# sql - 以编程方式区分magento中的多商店？

> ID：13980308
> 
> 赞同：1
> 
> 时间：2012-12-20T20:53:42.820
> 
> 标签：sql, magento

如果设置不正确，如何区分正确的域`core_config_data`和`web/unsecure/base_url`域？`web/secure/base_url``value`

例如：

1.  行 config_id：2 范围：默认 scope_id：0 路径：web/unsecure/base_url 值： http: [//www.com/](http://www.com/)
2.  行 config_id：3 范围：默认 scope_id：0 路径：web/secure/base_url 值：[https ://www.com/](https://www.com/)
3.  行 config_id：837 范围：存储 scope_id：7 路径：web/unsecure/base_url 值： http: [//www.com/](http://www.com/)
4.  行 config_id：838 范围：存储 scope_id：7 路径：web/secure/base_url 值：[https ://www.com/](https://www.com/)
5.  行 config_id：883 范围：存储 scope_id：9 路径：web/unsecure/base_url 值： http: [//www.com/](http://www.com/)
6.  行 config_id：884 范围：存储 scope_id：9 路径：web/secure/base_url 值：[https ://www.com/](https://www.com/)
7.  行 config_id：951 范围：网站 scope_id：6 路径：web/unsecure/base_url 值： http: [//www.com/](http://www.com/)
8.  行 config_id：952 范围：网站 scope_id：6 路径：web/secure/base_url 值：[https ://www.com/](https://www.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:57:54.760

这是一个想法：

查看数据库中的“ **core_website** ”表，在这里您将找到您安装的所有“网站 ID”以及您为每个商店命名的名称。

接下来将 ' **website_id ' 与****core_config_data**表中的 ' **scope_id** '匹配（其中路径是 web/unseucre/base_url 等）。

 **让我们知道您是否需要进一步的帮助**

# ajax - Selenium IDE 脚本在页面上找不到第二个选择元素

> ID：13980310
> 
> 赞同：1
> 
> 时间：2012-12-20T20:54:01.400
> 
> 标签：ajax, selenium, automation, browser-automation

我正在测试一个 Ajax 应用程序，并在 Firefox 17 的 Selenium IDE 1.9.1 中记录了一个脚本。它通常可以工作，但在某些时候会挂断。我遇到的一个问题是脚本正确地找到并从选择元素（下拉列表）中选择了正确的选项。在这个元素的正下方还有另一个选择元素，出于某种原因，Selenium 说它找不到那个元素（即使它显然在那里并且名称是正确的）。

这是代码：

```
<tr>
    <td>select</td>
    <td>id=answerChoice7_8</td>
    <td>label=Massachusetts</td>
</tr>
<tr>
    <td>select</td>
    <td>id=answerChoice7_9</td>
    <td>label=Boston University - Boston</td>
</tr> 
```

第一个选择工作正常，但由于某种原因，当它尝试选择第二个时出现以下错误：“未找到元素 id=answerChoice7_9”。我使用 Firebug 检查元素名称，它肯定是 answerChoice7_9。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T07:05:14.850

在选择之前添加命令 waitForElementPresent(id="answerChoice7_9") 。它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T13:08:54.560

你的 html 元素有名字吗？如果它有名称，则命令是`name=answerChoice7_9`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T23:19:10.643

Selenium 经常有时间问题。由于 selenium 之间没有页面加载，因此不知道等待元素出现。我认为有一个命令“waitForElementPresent”。试试看。

# .htaccess - 是否可以使用 .htaccess 将 url 重写到文件所在的另一个域？

> ID：13980311
> 
> 赞同：0
> 
> 时间：2012-12-20T20:54:02.697
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

一个网站位于[http://www.siteone.com](http://www.siteone.com) ，我想将 URL 重写为[http://www.anothersite.com/siteone](http://www.anothersite.com/siteone)或子域[http://siteone.anothersite.com](http://siteone.anothersite.com) .

该网站将仅托管在[http://www.siteone.com](http://www.siteone.com)，并且不会将任何文件移动或复制到 anothersite.com。

是否可以使用 .htaccess 来做到这一点，还是有其他方法可以做到这一点？

编辑（以下是我在本地主机的 htaccess 中所做的，它似乎不起作用）。不知道我做错了什么。我不想在这个阶段搞乱现场直播。

```
RewriteCond %{HTTP_HOST} /localhost/mysite [NC] 
RewriteRule ^(.*)$ http://www.anothersite.com/siteone/$1 [L,P] 
ProxyPassReverse /localhost/mysite http://www.anothersite.com/siteone/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:26:58.687

只要您加载了**mod_proxy**`P` ，您就可以使用重写规则中的标志来反向代理请求。您可以在 htaccess 文件中执行此操作：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?siteone.com$ [NC]
RewriteRule ^(.*)$ http://www.anothersite.com/siteone/$1 [L,P] 
```

这将使得当您访问时`http://siteone.com/some/path/`，请求将被反向代理，`http://www.anothersite.com/siteone/some/path/`并且该请求的内容将被发送到原始请求。这个在浏览器中的 URL 仍然存在`http://siteone.com/some/path/`。

为了处理重定向之类的事情，您需要设置一个[ProxyPassReverse](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypassreverse)以便位置标头得到属性重写：

```
ProxyPassReverse / http://www.anothersite.com/siteone/ 
```

另请参阅，`ProxyPassReverseCookieDomain`如果`ProxyPassReverseCookiePath`该站点`www.anothersite.com`想要设置 cookie。

注意：虽然该`ProxyPass`指令只能在 vhost 和服务器配置中使用，但这些`ProxyPassReverse`指令实际上可以与 mod_rewrite 一起在 htaccess 文件中使用。

# fluent - 如何使用 Laravel 的流畅查询构建器混合原始 SQL 和非原始 SQL

> ID：13980313
> 
> 赞同：3
> 
> 时间：2012-12-20T20:54:11.727
> 
> 标签：fluent, laravel, eloquent

我敢肯定这很简单，但我找不到任何例子。

我在我的 Laravel 应用程序中使用 fluent 来记录用户的登录信息，因此我创建了自己的身份验证驱动程序，但是我遇到了混合原始数据和非原始数据的 fluent 查询的问题，请查看以下内容：

```
DB::table('logins')->insert(array(
    'login_email' => $arguments['email'],
    'login_date' => DB::raw('UNIX_TIMESTAMP(NOW())'),
    'login_ip'=> DB::raw('INET_ATON('.$_SERVER['REMOTE_ADDR'].')'),
    'login_result' => (bool)$success
)); 
```

什么导致：

```
SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '@gmail.com, UNIX_TIMESTAMP(NOW()), INET_ATON(127.0.0.1), ?)' at line 1

SQL: INSERT INTO `cs_logins` (`login_email`, `login_date`, `login_ip`, `login_result`) VALUES (?, UNIX_TIMESTAMP(NOW()), INET_ATON(127.0.0.1), ?)

Bindings: array (
  0 => false,
) 
```

所以我做了以下事情：

```
DB::table('logins')->insert(array(
    'login_email' => DB::raw("'".$arguments['email']."'"),
    'login_date' => DB::raw('UNIX_TIMESTAMP(NOW())'),
    'login_ip'=> DB::raw('INET_ATON('.$_SERVER['REMOTE_ADDR'].')'),
'login_result' => DB::raw((bool)$success)
)); 
```

但正如 Dayle Rees 所说，如果它看起来很丑，它不在框架中......所以我想知道我在这里缺少什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:28:55.103

# 使用雄辩

首先，如果还没有完成，为*Login*创建一个模型，这样你就可以使用 laravel 自己的 ORM **eloquent**了。Eloquent 允许您以非常富有表现力的方式编写简单而强大的查询。

现在您可以执行以下两个选项之一：

```
$logins = Login::create(array('email' => 'example@gmail.com')); 
```

或者，在您的情况下可能更优雅：

```
$login = new Login;

$login->email = 'example@gmail.com';
$login->login_date = DB::raw('UNIX_TIMESTAMP(NOW())');

$login->save(); 
```

有关更多信息，请参阅**[eloquent 文档](http://laravel.com/docs/database/eloquent#save)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:06:54.977

好吧，别介意它看起来像“？” 问号只是意味着流利的没有达到创建准备好的陈述的那部分。我是 Laravel 和 Fluent 的新手，我认为问号表示错误出现在查询的那部分。

# jquery - 动画隐藏/显示时列表元素跳跃中的 Div

> ID：13980316
> 
> 赞同：0
> 
> 时间：2012-12-20T20:54:20.270
> 
> 标签：jquery, css

我在列表元素中有一个 div 。每次他们单击父列表元素时，我都会隐藏/显示 div。该功能正在运行，但是动画在动画结束时跳转。我认为这与每次隐藏/显示内部的 div 时更改高度的父列表元素有关。我似乎无法弄清楚如何处理它。我认为这是一个CSS问题？

[**链接到 JSFIDDLE**](http://jsfiddle.net/ypxLx/)

**HTML：**

```
<li id='band'>
  <h3>BAND</h3>
    <div class='content'>
        <p>Lorem ipsum.</p>
   </div>
</li> 
```

**CSS**

```
#centerpage ul {
  padding: 0;
  list-style: none;
  text-align: center;
}

#centerpage ul li p {
  margin: 0;
}

.content {
    background-color: green;
    width: 100%;
    overflow: hidden;
} 
```

**JQUERY/JAVASCRIPT**

```
$(function() {
    var $el = $('#links ul li');

    $el.each(function() {
        var $content = $(this).children().filter('.content');
        var height = $content.height();
        $content.hide().css({ height: 0});
        var listheight = $(this).height();
        console.log(listheight);

        $(this).click(function() {

            var $content = $(this).children().filter('.content');
            if ( $content.is(':visible') ) {
                $content.animate( {
                    height: 0
                }, 1000, function() {   
                    $content.hide();

                });
            }

            else {
                $content.show().animate({ height: height }, { duration: 1000} );
            }

        })  

    })

}) 
```

# php - 使用 mb_substr() 将字符串的其余部分保存到末尾并仍然设置编码

> ID：13980320
> 
> 赞同：6
> 
> 时间：2012-12-20T20:54:47.830
> 
> 标签：php, optional-parameters, multibyte

您可以省略第三个参数以`substr()`获取字符串的其余部分：

```
substr('abcdefg', 2) // returns "cdefg" 
```

你不能这样做`mb_substr()`：

```
mb_substr('abcdefg', 2, null, 'UTF-8'); // returns empty string 
```

我只找到了奇怪和丑陋的解决方案。

*   将一个非常高的数字设置为长度：

    `$a = mb_substr('abcdefg', 2, 9999999999, 'UTF-8');`

*   计算数量：

    `$a = mb_substr('abcdefg', 2, mb_strlen('abcdefg', 'UTF-8') - 2, 'UTF-8');`

*   通过使用省略 charset 参数`mb_internal_encoding()`：

    `$temp = mb_internal_encoding(); // prevent action at a distance`
    `mb_internal_encoding('UTF-8');`
    `$a = mb_substr('abcdefg', 2);`
    `mb_internal_encoding($temp);`

没有真正的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:07:46.117

更改日志将此显示为版本 5.4.8（2012 年 10 月 18 日）中的错误修复。

[http://us.php.net/ChangeLog-5.php](http://us.php.net/ChangeLog-5.php)

> 允许将 null 作为默认值传递给 mb_substr() 和 mb_strcut()。Alexander Moskaliov 通过 GitHub PR #133 提供的补丁。

这里也是拉取请求线程的链接：[https ://github.com/php/php-src/pull/133](https://github.com/php/php-src/pull/133)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:11:42.823

这是 PHP 5.3（也可能在早期版本中）和 PHP 5.4 之间的区别。

实际上，如果您好奇的话，您可以在 PHP 的源代码中看到问题所在。

它是`ext/mbstring/mbstring.c`具有以下`PHP_FUNCTION(mb_substr)`功能差异的文件。

在**PHP 5.3**中，他们检查这种情况：

```
if (argc < 3) {
    len = str_len;
} 
```

而在**PHP 5.4**中，他们使用：

```
if (argc < 3 || Z_TYPE_PP(z_len) == IS_NULL) {
    len = str_len;
} 
```

您可以在上述文件中`mb_string`启动的函数的实现中找到这些定义。`PHP_FUNCTION(mb_substr)`源代码可以从[php.net 下载页面下载](http://php.net/downloads.php)。

# sql - 给定 SQL Server 中的以下 XML，我如何获取值？

> ID：13980321
> 
> 赞同：3
> 
> 时间：2012-12-20T20:54:52.477
> 
> 标签：sql, sql-server, xml, xml-namespaces

这是我的 SQL。我似乎无法从这件事中得到一个单一的价值。它仅在我删除所有 xmlns 属性时才有效。

我认为问题在于这个 xml 包含 2 个默认命名空间，一个附加到 Response 元素，一个附加到 Shipment 元素。

```
DECLARE @xml XML
SET @xml = '<TrackResponse xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Response xmlns="http://www.ups.com/XMLSchema/XOLTWS/Common/v1.0">
    <ResponseStatus>
      <Code>1</Code>
      <Description>Success</Description>
    </ResponseStatus>
    <TransactionReference />
  </Response>
  <Shipment xmlns="http://www.ups.com/XMLSchema/XOLTWS/Track/v2.0">
    <InquiryNumber>
      <Code>01</Code>
      <Description>ShipmentIdentificationNumber</Description>
      <Value>1ZA50209234098230</Value>
    </InquiryNumber>
    <ShipperNumber>A332098</ShipperNumber>
    <ShipmentAddress>
      <Type>
        <Code>01</Code>
        <Description>Shipper Address</Description>
      </Type>
      <Address>
        <AddressLine>123 HWY X</AddressLine>
        <City>SOMETOWN</City>
        <StateProvinceCode>SW</StateProvinceCode>
        <PostalCode>20291   1234</PostalCode>
        <CountryCode>US</CountryCode>
      </Address>
    </ShipmentAddress>
    <ShipmentWeight>
      <UnitOfMeasurement>
        <Code>LBS</Code>
      </UnitOfMeasurement>
      <Weight>0.00</Weight>
    </ShipmentWeight>
    <Service>
      <Code>42</Code>
      <Description>UPS GROUND</Description>
    </Service>
    <Package>
      <TrackingNumber>1ZA50209234098230</TrackingNumber>
      <PackageServiceOption>
        <Type>
          <Code>01</Code>
          <Description>Signature Required</Description>
        </Type>
      </PackageServiceOption>
      <Activity>
        <ActivityLocation>
          <Address>
            <City>SOMEWHERE</City>
            <StateProvinceCode>PA</StateProvinceCode>
            <CountryCode>US</CountryCode>
          </Address>
        </ActivityLocation>
        <Status>
          <Type>X</Type>
          <Description>Damage reported. / Damage claim under investigation.</Description>
          <Code>UY</Code>
        </Status>
        <Date>20120424</Date>
        <Time>125000</Time>
      </Activity>
      <Activity>
        <ActivityLocation>
          <Address>
            <City>SOMEWHERE</City>
            <StateProvinceCode>PA</StateProvinceCode>
            <CountryCode>US</CountryCode>
          </Address>
        </ActivityLocation>
        <Status>
          <Type>X</Type>
          <Description>All merchandise discarded. UPS will notify the sender with details of the damage.</Description>
          <Code>GY</Code>
        </Status>
        <Date>20120423</Date>
        <Time>115500</Time>
      </Activity>
      <PackageWeight>
        <UnitOfMeasurement>
          <Code>LBS</Code>
        </UnitOfMeasurement>
        <Weight>0.00</Weight>
      </PackageWeight>
    </Package>
  </Shipment>
</TrackResponse>'

select Svc.Dsc.value('(/TrackResponse/Shipment/Service/Description)[1]', 'varchar(25)')
from @xml.nodes('/TrackResponse') as Svc(Dsc) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:44:41.423

正如@marc_s 所说，您忽略了 xml 命名空间。[这是一个 sql fiddle 示例](http://sqlfiddle.com/#!3/d41d8/7345)。这给了**X**，我认为这就是你所需要的。[阅读这篇文章了解更多](http://blog.jontav.com/post/11396385355/ignore-xml-namespaces-in-t-sql)。注：`*:TrackResponse[1]/*:`在`xpath`

```
--Results: X

declare @xmlTable as table (
 xmlData xml
)
insert into @xmlTable 
select '<TrackResponse xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
             <Response xmlns="http://www.ups.com/XMLSchema/XOLTWS/Common/v1.0">
              ...
        </TrackResponse>'

;with xmlnamespaces(default 'http://www.ups.com/XMLSchema/XOLTWS/Track/v2.0')
select
  x.xmlData.value('(/*:TrackResponse[1]/*:Shipment[1]/Package[1]/Activity[1]/Status[1]/Type[1])','varchar(100)') as all_snacks
from @xmlTable x 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:26:07.660

两个问题：

*   您公然忽略了`<shipment>`元素上定义的 XML 命名空间
*   你的 XQuery 表达式有点不对劲

试试这个：

```
-- define XML namespace
;WITH XMLNAMESPACES('http://www.ups.com/XMLSchema/XOLTWS/Track/v2.0' AS ns)
select 
    Svc.Dsc.value('(ns:Shipment/ns:Service/ns:Description)[1]', 'varchar(25)')
from 
    -- this already selects all <TrackResponse> nodes - no need to repeat that in 
    -- your above call to .value()
    @xml.nodes('/TrackResponse') as Svc(Dsc) 
```

给我一个结果：

```
UPS GROUND 
```

# asp.net - 简单的asp.net安装程序

> ID：13980325
> 
> 赞同：1
> 
> 时间：2012-12-20T20:55:09.780
> 
> 标签：asp.net, iis, installation

我有一个 asp.net 2.0 应用程序。我想把它打包成一个安装程序。为澄清起见，在用户的机器上已经安装了“VFP 应用程序”。以下是要求：

-检查是否存在 iis 并安装该机器操作系统可用的任何版本

- 检查是否存在 asp.net 并在必要时安装（或激活）

- 在目标机器上创建 iis 应用程序和子文件夹

-修改应用程序池以提供32位应用程序

- 检查并安装 Microsoft OLE DB Provider for Visual FoxPro 9.0（如果不存在）

-确定现有“VFP 应用程序”的位置并将几个附加文件复制到该“VFP 应用程序”位置

- 将“VFP 应用程序”文件夹标记为 iis 应用程序池用户的读/写

我正在寻找一个安装程序，它可以以最小的学习曲线执行上述操作，并且希望成本低或开源。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T11:27:06.320

正如上面 Darth 所提到的，WiX 是最好的免费解决方案。但是，如果您愿意花一点钱，您可以获得[高级安装程序](http://www.advancedinstaller.com)的专业版。这是基于 GUI 的，因此实现速度要快得多。将项目传递给另一位同事也会更简单，因为使用 Advanced Installer 非常容易学习。

以下[IIS 教程](http://www.advancedinstaller.com/user-guide/tutorial-iis.html)可以帮助您入门。您可以免费试用，试用 30 天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:57:10.633

我会说尝试使用[**WiX**](http://wix.sourceforge.net/)，[本文](http://www.codeproject.com/Articles/115036/Creating-WIX-Installer-for-ASP-NET-Web-Application)概述了该过程。

# jquery - 检查条件是否所有复选框都“未选中”

> ID：13980327
> 
> 赞同：1
> 
> 时间：2012-12-20T20:55:11.810
> 
> 标签：jquery, html

我有七个复选框，如下所示。我正在尝试做以下三件事：
1）当“任何”复选框被“选中”时，剩余的“1-6”应该被“取消选中”。2）当“1到6”复选框中的任何一个被“选中”时，“任何”复选框应该被“取消选中”。3）如果我“检查”数字然后“取消选中”所有数字，那么应该“选中”“任何”复选框

我能够使用 jquery 做 1）和 2），但不能做 3）。

我无法检查是否所有复选框“1 - 6”都“未选中”。

html:

```
<input name="deal_any" type="checkbox">any

<input name="deal" type="checkbox">1
<input name="deal" type="checkbox">2
<input name="deal" type="checkbox">3
<input name="deal" type="checkbox">4
<input name="deal" type="checkbox">5
<input name="deal" type="checkbox">6 
```

jQuery：

```
$("input").click(function(){
name=$(this).attr("name");
match = name.match(/any/);
if( match != null)
{
if($(this).is(':checked'))
{
   $('input[name="deal"]').attr('checked', false);
}
}
else
{
if($(this).is(':checked'))
{
   $('input[name="deal_any"]').attr('checked', false);
}
}
}); 
```

谁能告诉我如何做到这一点？对不起，如果我的解释不清楚。

我将感谢您的任何努力，并提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:08:22.697

你可以这样做

```
var da = $('input[name="deal_any"]'); // any checkbox
var di = $('input[name=deal]'); // other 6
// when any checkbox changes
da.change(function() {
    // if checked then uncheck all others
    if(this.checked){
        di.prop('checked',false);
    }
});
// when other 6 checkboxes change
di.change(function(){
    // if none are checked then check "deal_any" checkbox - else uncheck
    da.prop('checked',$('input[name=deal]:checked').length === 0);
}).change(); // trigger on page load 
```

[http://jsfiddle.net/W8QSW/](http://jsfiddle.net/W8QSW/)

你可以像这样使它通用

```
var da = $('input.class_one'); // checkbox with name that ends with any
var di = $('input.class_two'); // other checkboxes that don't have any
// when any checkbox changes
da.change(function() {
    // if checked then uncheck all others
    if(this.checked){
        di.prop('checked',false);
    }
});
// when other 6 checkboxes change
di.change(function(){
    // if none are checked then check "deal_any" checkbox - else uncheck
    da.prop('checked',$('input.class_two:checked').length === 0);
}).change(); // trigger on page load

​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:04:05.603

```
if ($('input[name=deal]:checked').length==0) { 
```

[http://jsfiddle.net/mblase75/8MWgj/](http://jsfiddle.net/mblase75/8MWgj/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T21:13:35.120

这将满足 OP 列出的所有条件 -

```
$('input[name="deal"]').change(function() {
    $('input[type="checkbox"]').not($(this)).prop('checked', false);
    if($('input[name="deal"]:checked').length == 0){
        $('input[name="deal_any"]').prop('checked', true);
    } 
}); 
```

基于 OP 希望能够在没有明确名称的复选框的情况下重复使用它，他也可以这样做 -

```
$('input[name="deal"]').change(function() {
    $('input[type="checkbox"]').not($(this)).prop('checked', false);
    if($('input[type="checkbox"]:checked').length == 0){
        $('input[type="checkbox"]').eq(0).prop('checked', true);
    } 
}); 
```

# javascript - How can we attach a jquery function to a div that has been appended after the page was loaded, without any event being triggered

> ID：13980330
> 
> 赞同：-4
> 
> 时间：2012-12-20T20:55:16.010
> 
> 标签：javascript, jquery, html

How can we attach a Jquery function to a div that has been appended after the page was loaded, **without** any event being triggered.

In the example below defaultTab-28 is the div that has been **appended later** to the page.

```
<a href="javascript:toggleDiv('defaultTab-28')" 
```

and now I want to use **toggle function on the "defaultTab-28" div** like

```
function toggleDiv(divId){
     $("#" + divId).toggle();
} 
```

If I use .delegate() or .on() I will have to **specify the event** like click etc, but in this case event trigger is not necessary.

Edit: to be a more precise:

I know using inline JS is not good when using JQuery, I could have used button click function from JQuery, but my question is : Is there any function like .on or .delegate to assign a function without an event

1.  I have added a div to an existing page
2.  When anybody clicks the tag I want the div that is passed to the javascript function which here is my div to use jquery toggle , but because this div is added later it cannot bind to toggle function

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:12:44.740

Your code already works as is, you don't need to do anything about the div not existing yet.

[http://jsfiddle.net/97GZb/](http://jsfiddle.net/97GZb/)

```
function toggleDiv(id){
    $("#" + id).toggle();
}

setTimeout(function(){
    $("body").append("<div id='defaultTab-28'>I'm the div!!!</div>");
},5000); 
```

with this html:

```
<a href="javascript:toggleDiv('defaultTab-28')">Click me to toggle the div that will be appended in 5 seconds.</a> ​ 
```

And to answer your comment:

> I know using inline JS is not good when using JQuery, I could have used button click function from JQuery, but my question is : Is there any function like .on or .delegate to assign a function without an event

No, there has to be an event of some kind to tell the javascript engine when to run the code. An element being added to the page is an Event, it is called a Mutation Event. there are also Mutation Observers that can handle this as well that were meant to be a replacement for Mutation Events. Neither of the two have very good cross-browser support.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:02:17.497

JavaScript

```
function toggleDiv(divObj){
     $(divObj).toggle();
} 
```

HTML (the thing you will append later):

```
<div onClick='toggleDiv(this);'></div> 
```

# java - 避免 Hessian 登录 catalina.out

> ID：13980332
> 
> 赞同：4
> 
> 时间：2012-12-20T20:55:30.577
> 
> 标签：java, tomcat, slf4j, hessian, catalina

我在使用 Caucho Hessian 时遇到问题。我在 catalina.out (tomcat) 中收到很多消息，如下所示：

```
'Dec 20, 2012 8:33:08 PM com.caucho.hessian.io.SerializerFactory getDeserializer
WARNING: Hessian/Burlap: '...blehClass' is an unknown class in WebappClassLoader
  delegate: false
  repositories:
    /WEB-INF/classes/
----------> Parent Classloader:
org.apache.catalina.loader.StandardClassLoader@f79f36b' 
```

这是一个问题，因为 catalina 的 Gb 空间...我需要使用 slf4j 获取此日志（我将使用 upd appender 将此日志发送到其他服务器）

有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T23:50:59.967

据我在[源代码](http://www.jarvana.com/jarvana/view/com/caucho/hessian/4.0.7/hessian-4.0.7-src.jar!/com/caucho/hessian/io/SerializerFactory.java?format=ok)上看到的，Caucho Hessian 使用 java.util.logging 框架。

```
import java.util.logging.Level;
import java.util.logging.Logger; 
```

因此，您可能希望按照官方[文档](http://www.slf4j.org/legacy.html)中的说明配置 JUL 桥接器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T16:41:46.490

帮助我关闭此警告的是在 ${tomcat_home}/conf/loggin.properties 的末尾添加一行：

com.caucho.hessian.io.SerializerFactory.level = 严重

# c# - 实体框架代码优先：Configuration.cs 种子或自定义初始化程序

> ID：13980335
> 
> 赞同：10
> 
> 时间：2012-12-20T20:56:11.647
> 
> 标签：c#, entity-framework, ef-code-first

我第一次使用实体框架的代码优先样式。我想设置一些默认数据。我遇到的第一种方法涉及创建[自定义初始化程序](https://stackoverflow.com/questions/5655841/entity-framework-code-first-default-data-in-database)。我走在这条路线上，但在设置迁移后注意到它与 Configuration.cs 一起已经覆盖了种子方法，就像自定义初始化程序一样。

```
internal sealed class Configuration : DbMigrationsConfiguration<Toolkit.Model.ToolkitContext>
{
    public Configuration()
    {
        AutomaticMigrationsEnabled = false;
    }

    protected override void Seed(Toolkit.Model.ToolkitContext context)
    {
        //  This method will be called after migrating to the latest version.

        //  You can use the DbSet<T>.AddOrUpdate() helper extension method 
        //  to avoid creating duplicate seed data. E.g.
        //
        //    context.People.AddOrUpdate(
        //      p => p.FullName,
        //      new Person { FullName = "Andrew Peters" },
        //      new Person { FullName = "Brice Lambson" },
        //      new Person { FullName = "Rowan Miller" }
        //    );
        //
    }
} 
```

因此，似乎有两种方法可以完成此任务。有人可以阐明推荐的这样做方式吗？或者这有什么关系，我应该掷硬币？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-20T22:00:42.470

Configuration.cs Seed 方法将在您的模型每次更改时运行，以确保某些特定数据保留在您的数据库中，或者甚至可能将该数据重置为指定的默认设置。

另一方面，自定义初始化程序的种子方法可以设置为在每次加载应用程序时运行，就像这段代码一样，目前在我的 MVC 页面的 Global.asax 文件中：

```
Database.SetInitializer(new MyCustomInitializer<MyDbContext, Configuration>());
var db = new MyDbContext();
db.Database.Initialize(true); 
```

部署应用程序后，实际差异真正发挥作用。Custom Initializer 将确保没有用户可以破坏您的程序中绝对需要的某些数据。

# c# - 使用互操作将具有多张工作表的 xls 或 xlsx 文件转换为一个 csv 文件

> ID：13980336
> 
> 赞同：1
> 
> 时间：2012-12-20T20:56:11.663
> 
> 标签：c#, .net, excel, csv, interop

我正在尝试使用 c# 和互操作库将具有多张工作表的 xls 或 xlsx 文件转换为一个 CSV 文件。我只得到 CSV 文件中的一张。我知道我可以指定要另存为的工作表或更改活动工作表以保存该工作表，但我正在寻找一种解决方案，将所有工作表附加到同一个 CSV 文件中，该文件适用于 xls 和 xlsx 文件。我正在自动执行此操作，并且不在乎 excel 文档中的内容只是想将字符串值拉出并将其附加到 csv 文件中。这是我正在使用的代码：

```
Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();
app.Visible = false;
app.DisplayAlerts = false;
Workbook wkb = app.Workbooks.Open(fullFilePath);
wkb.SaveAs(newFileName, XlFileFormat.xlCSVWindows); 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T16:06:12.137

我刚刚开始处理类似的情况，但我相信这可能会满足您的需求：

[http://www.codeproject.com/Articles/246772/Convert-xlsx-xls-to-csv](http://www.codeproject.com/Articles/246772/Convert-xlsx-xls-to-csv)

这使用您可以从 NuGet 获得的 ExcelDataReader api

[http://exceldatareader.codeplex.com/](http://exceldatareader.codeplex.com/)

正如 Tim 所说，您将必须确保并可能验证工作表之间的列和结构是否相同。您可能还必须在第一张之后吃掉所有床单上的标题行。完成后，我将发布更新和一些代码示例。

更新 [7/15/2013]。这是我完成的代码。不是很花哨，但它可以完成工作。所有工作表都是 DataSet 中的表，因此您只需遍历添加到目标的表。我正在输出到 MongoDB，但我猜你可以很容易地将它换成 StreamWriter 用于你的 CSV 文件。

```
 private static void ImportValueSetAttributeFile(string filePath)
    {
        FileStream stream = File.Open(filePath, FileMode.Open, FileAccess.Read);

        // Reading from a OpenXml Excel file (2007 format; *.xlsx)
        IExcelDataReader excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);

        // DataSet - The result of each spreadsheet will be created in the result.Tables
        DataSet result = excelReader.AsDataSet();

        // Free resources (IExcelDataReader is IDisposable)
        excelReader.Close();

        var connectionString = ConfigurationManager.ConnectionStrings[0].ConnectionString;
        var database = ConfigurationManager.AppSettings["database"];
        var mongoAccess = new MongoDataAccess(connectionString, database);

        var cdm = new BaseDataManager();

        int ind = 0;

        for (int i = 0; i < result.Tables.Count; i++)
        {
            int row_no = 1;
            while (row_no < result.Tables[ind].Rows.Count) // ind is the index of table
                // (sheet name) which you want to convert to csv
            {
                var currRow = result.Tables[ind].Rows[row_no];
                var valueSetAttribute = new ValueSetAttribute()
                    {
                        CmsId = currRow[0].ToString(),
                        NqfNumber = currRow[1].ToString(),
                        ValueSetName = currRow[2].ToString(),
                        ValueSetOid = currRow[3].ToString(),
                        Definition = currRow[4].ToString(),
                        QdmCategory = currRow[5].ToString(),
                        Expansion = currRow[6].ToString(),
                        Code = currRow[7].ToString(),
                        Description = currRow[8].ToString(),
                        CodeSystem = currRow[9].ToString(),
                        CodeSystemOid = currRow[10].ToString(),
                        CodeSystemVersion = currRow[11].ToString()
                    };

                cdm.AddRecords<ValueSetAttribute>(valueSetAttribute, "ValueSetAttributes");

                row_no++;
            }
            ind++;
        }
    } 
```

# sql-server - SQL Server - 在特定分区上创建非聚集索引

> ID：13980345
> 
> 赞同：1
> 
> 时间：2012-12-20T20:56:59.770
> 
> 标签：sql-server, performance, sql-server-2008, indexing, partitioning

表分区的最大好处之一是“可以在特定分区上重建索引”。

想象有一个分区表（现在有 12 个分区），它有集群索引和一些非集群索引，所有分区都对齐。

我想为表添加一个新的非聚集索引，它不必为旧分区构建。我只需要最后 3 个分区的索引。

那么，如何为 12 个分区表的最后 3 个分区创建新的非聚集索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:14:21.750

这是不可能的。这会给参数化查询带来问题，因为查询计划器永远不会静态地知道可以使用索引（除非存在常量表达式谓词）。

您可以使用 `where partitionKey >= startOfSomePartition' 创建过滤索引。不过，您的查询必须静态包含此谓词。

您可以尝试查看*两个*具有不同架构的分区表。不过开发起来不太方便。

# joomla - Joomla extension for content

> ID：13980358
> 
> 赞同：1
> 
> 时间：2012-12-20T20:58:04.180
> 
> 标签：joomla

I need help to find an extension or a way in joomla to display an introduction of an article with an image, but when I click in the article it shows the full article without the image.

Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T07:11:19.360

this is pretty easy to do with native articles. Simply enable "show more" setting and keep image there, and use read more tag.

Until now best 3rd party components still are: [Yootheme Zoo](http://www.yootheme.com/zoo) and [K2](http://getk2.org/)

See this thread: [Joomla template show image thumbnail on frontpage](https://stackoverflow.com/questions/3857479/joomla-template-show-image-thumbnail-on-frontpage/3858109#3858109)

# asp.net-mvc - 通过 ASP.NET MVC 管道运行 URL 字符串以获取 ActionResult

> ID：13980360
> 
> 赞同：3
> 
> 时间：2012-12-20T20:58:09.653
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, actionresult

我有一个通过查询 Google Analytics 数据获得的 URL 列表。我想通过 MVC 管道运行这些 URL 中的每一个以获取 ActionResult。动作结果包含视图模型，我可以从中提取一些重要信息。

基于 MVC 的可扩展性，我认为这很容易。我想我可以使用字符串 URL 模拟一个 HttpRequest 并通过路由和控制器传递它。我的终点是调用将返回 ActionResult 的操作方法。我正在寻找一些我需要的东西，但是很多方法都在各种类中受到保护，并且它们的文档非常稀疏。

我想以某种方式访问​​ ControllerActionInvoker 并获取对受保护函数 InvokeActionMethod 的调用结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-25T16:13:12.280

首先，达林的回答让我开始了，但最终解决方案还有更多细节，所以我添加了一个单独的答案。这个很复杂，所以请耐心等待。

从 URL 获取 ViewResult 有 4 个步骤：

1.  通过路由系统模拟 RequestContext （达林的回答让我开始了这个）。

    ```
     Uri uri = new Uri(MyStringUrl);
            var request = new HttpRequest(null, uri.Scheme + "://" + uri.Authority + uri.AbsolutePath, string.IsNullOrWhiteSpace(uri.Query) ? null : uri.Query.Substring(1));
            var response = new HttpResponse(new StringWriter());
            var context = new HttpContext(request, response);
            var contextBase = new HttpContextWrapper(context);
            var routeData = System.Web.Routing.RouteTable.Routes.GetRouteData(contextBase);

            // We shouldn't have to do this, but the way we are mocking the request doesn't seem to pass the querystring data through to the route data.
            foreach (string key in request.QueryString.Keys)
            {
                if (!routeData.Values.ContainsKey(key))
                {
                    routeData.Values.Add(key, request.QueryString[key]);
                }
            }

            var requestContext = new System.Web.Routing.RequestContext(contextBase, routeData); 
    ```

2.  子类化你的控制器。添加一个公共方法，允许您调用受保护的 Execute(RequestContext) 方法。

    ```
    public void MyExecute(System.Web.Routing.RequestContext requestContext)
    {
        this.Execute(requestContext);
    } 
    ```

3.  在同一个子类控制器中，添加一个挂钩到受保护的 OnActionExecuted 事件的公共事件。这允许您通过 ActionExecutedContext 获取 ViewResult。

    ```
    public delegate void MyActionExecutedHandler(ActionExecutedContext filterContext);

    public event MyActionExecutedHandler MyActionExecuted;

    protected override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        base.OnActionExecuted(filterContext);
        if (MyActionExecuted != null)
        {
            MyActionExecuted(filterContext);
        }
    } 
    ```

4.  通过实例化新控制器子类的实例、添加事件处理程序并调用新的公共执行方法（传入模拟的 RequestContext），将所有内容联系在一起。事件处理程序将允许您访问 ViewResult。

    ```
     using (MyCompany.Controllers.MyController c = new Controllers.MyController())
            {
                c.MyActionExecuted += GrabActionResult;
                try
                {
                    c.MyExecute(requestContext);
                }
                catch (Exception)
                {
                    // Handle an exception.
                }
            } 
    ```

这是事件处理程序：

```
 private void GrabActionResult(System.Web.Mvc.ActionExecutedContext context)
        {
            if (context.Result.GetType() == typeof(ViewResult))
            {
                ViewResult result = context.Result as ViewResult;
            }
            else if (context.Result.GetType() == typeof(RedirectToRouteResult))
            {
                // Handle.
            }
            else if (context.Result.GetType() == typeof(HttpNotFoundResult))
            {
                // Handle.
            }
            else
            {
                // Handle.
            }
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T22:13:18.597

这里的困难在于将 url 解析为它的组成控制器和动作。这是如何做到的：

```
var url = "http://example.com/Home/Index";
var request = new HttpRequest(null, url, "");
var response = new HttpResponse(new StringWriter.Null);
var context = new HttpContext(request, response);
var routeData = RouteTable.Routes.GetRouteData(new HttpContextWrapper(context));
var values = routeData.Values;
var controller = values["controller"];
var action = values["action"]; 
```

现在您知道了控制器和操作，您可以使用反射来实例化和执行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:36:31.007

试试这个：

```
object result = null;
Type controller = Type.GetType("MvcApplication4.Controllers.HomeController");
if (controller != null)
{
    object controllerObj = Activator.CreateInstance(controller, null);
    if (controller.GetMethod("ActionName") != null)
    {
        result = ((ViewResult)controller.GetMethod("ActionName").Invoke(controllerObj, null)).ViewData.Model;
    }
} 
```

我假设在应用程序中配置了正常路由，并且可以使用正则表达式或字符串操作来检索。在您的讨论之后，我了解到你们希望通过不使用反射或任何硬编码技术来深入研究框架，从而真正遵循 MVC 管道。但是，我尝试通过遵循此线程尝试将 url 与应用程序中配置的路由匹配来搜索以最小化硬编码

[如何确定任意 URL 是否与定义的路由匹配](https://stackoverflow.com/questions/4748342/how-to-determine-if-an-arbitrary-url-matches-a-defined-route/4749840#4749840)

此外，我遇到了其他创建 httprequest 以访问 routedata 对象的线程，但需要再次使用反射。

[RouteValueDictionary 的字符串 URL](https://stackoverflow.com/questions/1481565/string-url-to-routevaluedictionary)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-29T08:15:27.020

感谢 Ben Mills，这让我开始解决自己的问题。但是，我发现通过执行以下操作，我不必执行 2、3 或 4。

```
Uri uri = new Uri(MyStringUrl);
var absoluteUri = uri.Scheme + "://" + uri.Authority + uri.AbsolutePath;
var query = string.IsNullOrWhiteSpace(uri.Query) ? null : uri.Query.Substring(1);
var request = new HttpRequest(null, absoluteUri, query); 
```

访问字符串编写器很重要。

```
var sw = new StringWriter();
var response = new HttpResponse(sw);
var context = new HttpContext(request, response);
var contextBase = new HttpContextWrapper(context);
var routeData = System.Web.Routing.RouteTable.Routes.GetRouteData(contextBase); 
```

如果我们将 RouteData 分配给请求上下文，我们可以按预期使用 MVC 管道。

```
request.RequestContext.RouteData = routeData;

var controllerName = routeData.GetRequiredString("controller");

var factory = ControllerBuilder.Current.GetControllerFactory();
var contoller = factory.CreateController(request.RequestContext, controllerName);

controller.Execute(request.RequestContext);

var viewResult = sw.ToString(); // this is our view result.

factory.ReleaseController(controller);
sw.Dispose(); 
```

我希望这可以帮助其他想要实现类似目标的人。

# c++ - 返回对局部变量的引用

> ID：13980362
> 
> 赞同：7
> 
> 时间：2012-12-20T20:58:19.973
> 
> 标签：c++, reference

> **可能重复：**
> [返回局部变量或临时变量的地址](https://stackoverflow.com/questions/2744264/returning-the-address-of-local-or-temporary-variable)
> [局部变量的内存是否可以在其范围之外访问？](https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope)

即使知道以下剪辑的结果会发生什么，也有助于了解它是如何发生的。接下来是四个问题。

鉴于：

```
int& foo()
{
    int i = 1;
    return i;
} 
```

并且知道在下面对**名为 i 的本地**的引用被取消引用到分配给 intVal 的 temp 中，并且**本地 i在***foo()*的末尾消失

 *```
int  intVal = foo(); 
```

第一个问题 - 在下面，表达式的右侧与上面相同，所以这是编译器看到左侧并且根据上下文知道不取消引用返回的引用的情况，而是创建一个新的引用是用它初始化的吗？

第二个问题 - 仅这一点就让**本地 i**在 intRef 范围内时留下来？

```
int& intRef = foo(); 
```

第三个问题 - 波纹管*intPtr*获取**本地 i**的地址。那么，编译器是否使用赋值的上下文并决定在获取引用地址之前不取消引用来获取值（而不是说获取包含取消引用值的临时地址）？

第四个问题 -当*intPtr*在范围内时，**本地 i是否会留下来？**

 *```
int* intPtr = &foo(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T21:03:26.163

不，这些都不会延长局部变量的生命周期。C++ 中*没有任何东西会产生这种效果。*C++ 中的本地对象一直存在，直到声明它们的范围结束，故事结束。

乍一看，似乎遵循不同规则的唯一规则是：

```
int foo() {
    return 42;
}

int main() {
    const int& i = foo();
    // here, `i` is a reference to the temporary that was returned from `foo`, and whose lifetime has been extended
} 
```

也就是说，一个*const*引用可以延长分配给它的*临时对象的生命周期。*

但这需要函数返回一个值，而不是一个引用，并且被调用者将返回值绑定到一个 const 引用，这两者都没有在您的代码中完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:06:52.777

在任何情况下（不是 intVal、不是 intRef 和不是 intPtr）都不`i`一定会在 foo 返回后继续存在。

在 foo 返回后，之前由 i 占用的堆栈上的值可能随时更改，也可能不更改。

例如（在某些 CPU 和 O/Ses 上），它可能会被任何后续调用子程序更改，并且可能会在发生硬件中断时更改。**

# graph - Facebook FQL 从提要中获取认可的朋友

> ID：13980366
> 
> 赞同：1
> 
> 时间：2012-12-20T20:58:34.507
> 
> 标签：graph, facebook-fql

我能够获取所有提要，然后找到将“approved_friend”作为 status_type 的帖子。

我想知道，有没有办法通过使用 fql 来过滤提要，例如；

从 [feed] 中选择 [columns]，其中 status_type="approved_friend"

所以我只能从我的提要中获取批准的朋友帖子。

我会很感激你们提供的任何帮助。

提前致谢，

# php - 发送修改后的请求后如何检查响应头

> ID：13980370
> 
> 赞同：3
> 
> 时间：2012-12-20T20:58:58.153
> 
> 标签：php, validation, jsp

我在想他们是否可以通过任何方式检查响应标头或在我修改请求标头或获取参数后页面呈现不同。

喜欢：

```
Original:www.abc.com/index.php?a=2 
mODIFIED:www.abc.com/index.php?a=2polo 
```

现在，当我在 2 之后附加 polo 字符串时，我应该会看到页面呈现不同或应该正常呈现。但是我如何检查它是否正常渲染。

有什么办法可以比较正常响应和修改后的“请求”响应？

阐述我的问题。我有一个例子。假设这是原始网址：[http ://www.lnctgroup.in/institute.php?institute=4](http://www.lnctgroup.in/institute.php?institute=4polo)

现在这是 get 参数上的修改：[http ://www.lnctgroup.in/institute.php?institute=4polo](http://www.lnctgroup.in/institute.php?institute=4polo)

您可以看到在原始情况下正常呈现的页面，但是在附加“polo”字符串时，它显示错误，因为 mysql 错误可能是但页面呈现方式不同。我只想比较在我修改后我得到的是相同的页面还是不同的页面获取帖子参数。

帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:17:39.330

如果你经历过这个，那么你不应该问这个问题。

[http://php.net/manual/en/class.httpresponse.php](http://php.net/manual/en/class.httpresponse.php)

先过一遍。我不能在这里为你准备完整的功能代码。

# android - Media Player API 16 中 TimedText API 的使用

> ID：13980371
> 
> 赞同：1
> 
> 时间：2012-12-20T20:59:02.290
> 
> 标签：android, android-mediaplayer

有没有人在 Android API 16 上的媒体播放器中使用 TimedText api 运气好？

我们正在使用存储在应用程序的 getFilesDir() 存储区域中的外部 SRT 子文件。每当我们通过 addTimedTextSource 将它传递给 MediaPLayer 时，我们都会得到一个神秘的异常：

```
12-20 14:17:11.581: W/System.err(693): java.lang.RuntimeException: failure code: -38
12-20 14:17:11.581: W/System.err(693):  at android.media.MediaPlayer.invoke(MediaPlayer.java:644)
12-20 14:17:11.591: W/System.err(693):  at android.media.MediaPlayer.addTimedTextSource(MediaPlayer.java:1812)
12-20 14:17:11.591: W/System.err(693):  at android.media.MediaPlayer.addTimedTextSource(MediaPlayer.java:1776)
12-20 14:17:11.591: W/System.err(693):  at android.media.MediaPlayer.addTimedTextSource(MediaPlayer.java:1708) 
```

我们已经尝试了几个已知可以在其他播放器上正常工作的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T06:06:53.883

目前支持的格式是 SubRip，文件扩展名为 .srt 您可以下载演示[TimedTextTest](https://github.com/iTech-Developer/TimedTextTest.git)

# html - 用于自定义博客的优秀富文本编辑器

> ID：13980376
> 
> 赞同：1
> 
> 时间：2012-12-20T20:59:38.327
> 
> 标签：html, blogs, rich-text-editor

我正在开发一个项目（网站），我需要在其中创建一个用户能够发布帖子的功能，比如博客，所以我想将帖子数据保存在数据库中。您可以向我推荐什么富文本编辑器，它不是很难使用，并且会取代 HTML 文本区域？

另外，如果我只是将富文本编辑器中的内容直接放入数据库字段中，那么内容实际上是什么格式？我正在考虑 HTML 字符串，但不确定。因此，如果它是 HTML，我可以在显示帖子内容时回显整个内容吗？很抱歉有这么多问题，并提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:19:46.060

我认为 TinyMCE 适合你的博客。

> TinyMCE 是一个独立于平台的基于 Web 的 Javascript HTML WYSIWYG。编辑。

看看这个网站：[http](http://www.tinymce.com/) : //www.tinymce.com/ 你也可以在这里试试：[http ://www.tinymce.com/tryit/full.php](http://www.tinymce.com/tryit/full.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T22:01:48.093

我推荐使用[TinyMCE](http://www.tinymce.com/index.php)

这是相当标准的。我知道它是作为 Joomla 的可选编辑器提供的！安装 - 所以你知道它至少足够稳定，可以在广泛使用的 CMS 的大型发行版中使用。

# biztalk - 在 BizTalk Map 中创建处理指令

> ID：13980382
> 
> 赞同：1
> 
> 时间：2012-12-20T20:59:54.360
> 
> 标签：biztalk, biztalk-mapper

我知道在 BizTalk 地图中，您可以坚持处理指令。但是，我将拥有的源 XML 将没有任何处理指令。但是，我需要为 Target XML 创建一个处理指令。我知道我可以编写一个自定义 XSLT 来执行此操作，但是我想避免这种情况，因为除此之外我已经完成了 BizTalk 映射。

我可以仅使用 BizTalk 映射器中的可用 functoid 在目标 XML 上创建处理指令吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T08:19:20.503

除了您提到的[使用 XSLT](https://stackoverflow.com/questions/3716608/biztalk-2010-mapping-an-xsd-with-a-lot-of-elements-with-the-same-name/3718014#3718014)之外，还有一个选项可以在发送端口上执行此操作：

*   选择本机`XmlTransmit`发送管道
*   [根据此示例](http://thoughtsofmarcus.blogspot.com/2010/02/adding-xml-stylesheet-reference-or.html)将您的处理说明添加到 `XmlAsmProcessingInstructions`属性中

# vb.net - VB字典包含值返回键

> ID：13980383
> 
> 赞同：2
> 
> 时间：2012-12-20T20:59:59.400
> 
> 标签：vb.net, dictionary, key, contains

我有一个问题...如果 containsvalue 的条件为真，我试图将其放入字符串字典键值列表中：

但是，这是不正确的:(

这是一个代码：

```
Private listID As New List(Of String)                       ' declaration of list
Private dictionaryID As New Dictionary(Of String, Integer)  ' declaration of dictionary

  'put a keys and values to dictionary
  dictionaryID.Add("first", 1)
  dictionaryID.Add("second", 2)
  dictionaryID.Add("first1", 1)

    If dictionaryID.ContainsValue(1) Then                 ' if value of dictinary is 1
        Dim pair As KeyValuePair(Of String, Integer)
        listID.Clear()
        For Each pair In dictionaryID
            listID.Add(pair.Key)
        Next
    End If 
```

现在，列表必须有两个元素... -> "first" 和 "first1"

你能帮助我吗？非常感谢你！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T21:08:46.333

您正在遍历整个字典并将所有元素添加到列表中。您应该将 if 语句放入`For Each`或使用 LINQ 查询，如下所示：

```
If listID IsNot Nothing Then
    listID.Clear()
End If
listID = (From kp As KeyValuePair(Of String, Integer) In dictionaryID
          Where kp.Value = 1
          Select kp.Key).ToList() 
```

使用 if 语句：

```
listID.Clear()
For Each pair As KeyValuePair(Of String, Integer) In dictionaryID
    If pair.Value = 1 Then
        listID.Add(pair.Key)
    End If
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:09:01.090

我的 VB.Net 有点生疏，但看起来你正在添加所有这些，无论它们的值是否为 1。

```
Private listID As New List(Of String)                       ' declaration of list
Private dictionaryID As New Dictionary(Of String, Integer)  ' declaration of dictionary

  'put a keys and values to dictionary
  dictionaryID.Add("first", 1)
  dictionaryID.Add("second", 2)
  dictionaryID.Add("first1", 1)

    If dictionaryID.ContainsValue(1) Then                 ' if value of dictinary is 1
        Dim pair As KeyValuePair(Of String, Integer)
        listID.Clear()
        For Each pair In dictionaryID
            If pair.Value = 1 Then
                listID.Add(pair.Key)
            End If
        Next
    End If 
```

# ios - 如何实现懒惰的json文件下载？

> ID：13980386
> 
> 赞同：2
> 
> 时间：2012-12-20T21:00:24.270
> 
> 标签：ios, json, lazy-evaluation

我正在使用从服务器上的数据库返回 JSON 格式数据的 Web 服务，这些数据将显示在我的 iPhone 应用程序的某些视图中。

由于该应用程序是免费的，所以我的数据库中有数千行，当然还有我必须下载的 JSON 数据。

如何对我的 JSON 数据进行延迟加载？请任何代码行将不胜感激。

谢谢。

编辑 1：

换句话说，我正在使用诸如“从表中全选”之类的 Sql 请求，然后将此数据作为 JSON 返回到我的应用程序。

我怎样才能请求一个小号码然后添加其他人等..？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T23:18:27.070

术语“延迟加载”可能并不完全适合单个 JSON 响应，它可能使我们倾向于一种方法而不是另一种方法。因此，让我来解决我认为的基本问题，即尽管服务器数据库非常大，但您仍希望获得改善的用户体验：

1.  如果 JSON 真的很大，你总是可以考虑一个“分页”的比喻，你下载前*x*条记录，然后对服务器数据的下一个“页面”发出后续请求。鉴于可以在请求之间添加额外的服务器记录，您必须仔细考虑该实现，但这可能很容易做到。

2.  另一种提高 JSON 效率的方法是限制初始请求中返回的数据。例如，第一个请求可能只返回所有或合理的记录子集的标识符或标头信息，然后您可能有后续请求以获取更多详细信息（例如，用户转到详细信息屏幕）。

3.  如果 JSON 当前包含任何大型数据元素（例如，Base64 编码的二进制数据，如图像或声音文件），则前一点的特定排列将是。通过将这些排除在初始响应之外，这将解决许多问题。如果您可以返回此二进制数据的 URL，而不是数据本身，那肯定会适合延迟加载（以及让您能够轻松下载二进制信息，而不是大 33% 的 Base64 编码） . 如果您正在处理图像，您可能还需要考虑缩略图v 大图像的想法，特别是在延迟加载模型中处理后者。

4.  您可以考虑实现一个支持流的 XML 解析版本。标准`NSXMLParser`实现尝试在解析继续之前一次将整个 XML 提要（或尽可能多的？）加载到内存中（尽管方法名称会暗示相反）。如果您的应用使用`LibXML2`了（例如在 Apple 的[AdvancedURLConnections 示例中](https://developer.apple.com/library/ios/#samplecode/AdvancedURLConnections/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009558)），您可以在将初始数据呈现给用户的同时继续在后台下载和解析 XML。这将同时产生大多数人与“延迟加载”（即您在将结果呈现给用户之前不会等待所有内容）和“急切加载”（即它将下载下一条记录，因此它们当他们去那里时已经为用户准备好了）。

为了让我们提出更明智的建议，您确实需要分享有关 JSON 的性质及其背后的数据的更多信息，描述为什么您认为“延迟加载”是解决方案等等。您可能不想发疯特定的解决方案，直到您对数据进行一些分析（例如，数千行的 JSON 仍然可以小于单个大图像）。

* * *

**更新：**

如果您打算采用第一种方法，您首先需要更改您的 Web 服务，以便在响应请求时，它只提供从特定记录编号开始的*n条记录。*您可能还需要返回服务器上的记录总数，以便您可以为用户提供一些视觉提示，以了解有多少需要滚动。

其次，您需要更新您的 iOS 应用程序以支持此模型。因此，在您的 UI 中，当您滚动浏览结果时，您可能希望您的用户界面通过显示（a）实际结果（如果您已经获取它）来响应滚动事件；或 (b) 一些 UI 可以直观地指示正在检索相关记录，然后从服务器异步请求信息。如果您在 a 中执行此`UITableViewCell`操作，它可能会执行以下操作：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [self initiateRequestForFirstSetOfData];
}

- (void)initiateRequestForFirstSetOfData
{
    // asynchronously retrieve the data from the server:
    //   (a) retrieve the total number of records
    //   (b) retrieve the actual data for the first n records
    // and when this is done, dispatch a `[self.tableView reloadData]` back to the
    // main queue.
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return self.totalNumberOfRecordsOnServer;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    BOOL isAvailable = ... // do whatever logic to determine if this row has already been retrieved

    if (isAvailable)
    {
        // configure the cell like normal here
    }
    else
    {
        // configure the cell to indicate that a fetch is in progress here.

        // perhaps add a UIActivityIndicatorView and startAnimating it

        dispatch_async(backgroundQueue, ^{

            // initiate the request for the data (if you haven't already)

            dispatch_async(dispatch_get_main_queue(), ^{

                // don't just update the UI here, but make sure the cell
                // in question is still on screen by calling `UITableView`
                // method `cellForRowAtIndexPath`, not to be confused with
                // this method, which is a `UITableViewController` method.

                UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
                if (cell)
                {
                    // update the cell: sometimes you can get away with
                    // updating the cell directly, sometimes you want to
                    // just call something like:
                    //
                    // [tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
                }
            });
        });
    }

    cell.imageView.contentMode = UIViewContentModeScaleAspectFill;

    return cell;
} 
```

对于上面的代码，我可能会建议一大堆改进，相当简单的代码，但希望它能给你基本的想法。您 (a) 计算出总共有多少行数据；(b) 您检索前*n*条记录；(c) 当用户滚动到一条记录时，如果你有它，你会显示它，但如果没有，提供视觉提示，你将异步地为他们获取该数据；(d) 当数据进来时，如果合适的话，更新 UI。

就像我说的，我可能会对上面的代码进行一些改进，例如，我可能不会在视图控制器本身中嵌入异步检索，而是在我的模型中这样做并有一些委托模式来更新 UI，我'可能会使用操作队列而不是调度队列，所以我可以取消我们不再需要的请求等，但你明白了基本的想法。

如果你使用 a `UICollectionViewController`，它类似于上面的代码。如果您使用滚动视图，则模式非常相似，尽管您将改为响应该`UIScrollViewDelegate`方法`scrollViewDidScroll`（并且您不仅需要编写代码，还需要编写一些可以释放`UIKit`已滚动元素的代码也离开屏幕）。

# php - Zend Server Community Edition 为您安装了什么？

> ID：13980388
> 
> 赞同：0
> 
> 时间：2012-12-20T21:00:37.093
> 
> 标签：php, apache, zend-server

[该页面](http://www.zend.com/products/server-ce/downloads)说 Zend Server Community Edition 安装了“包含 ZF 的完整 PHP 堆栈”。这意味着什么？它会安装 Apache 吗？mysql？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:37:42.153

好的，我在尝试安装 Zend Server 时得到了答案，以下是自述文件中的内容

```
What is Installed?
 - PHP-Zend Server provides a complete PHP stack that can be controlled by the Administration Interface
 - MySQL Database
 - Apache Web server
In addition, the following components are also installed:
Zend components that are installed and enabled:
 - Zend Debugger - The Zend Debugger component enables remote debugging of PHP scripts using Zend Studio or PDT.
 - Zend Optimizer+ - The Zend Optimizer+ component speeds up PHP execution through opcode caching and optimization.
 - Zend Data Cache - The Zend Data Cache component provides a set of PHP functions for improving performance by storing data in the cache.
 - Zend Framework - An open source framework for developing Web applications and Web services with PHP.
 - PHPmyAdmin - A popular open-source management tool for handling MySql Database over a Web interface.
Additional Zend Server features that are not included in the Community Edition:
 - Zend Monitor - The Zend Monitor component is integrated into the runtime environment and serves as an alerting and collection mechanism for early detection of PHP script problems.
 - Zend Page Cache - The Zend Page Cache component is used for caching the entire output of PHP scripts without changing the PHP code.
 - Job Queue Component - The Jobs Component is used to streamline offline processing of PHP scripts.
- Zend Code Tracing - Code Tracing enables real-time execution flow recording in Production Environments. 
```

# android - 单击时我无法更改列表项的背景

> ID：13980391
> 
> 赞同：0
> 
> 时间：2012-12-20T21:00:54.220
> 
> 标签：android

我想在单击列表项时更改它的背景，但它不起作用。

这是我的 MusicAdapter 内部类：

```
class MusicAdapter extends ArrayAdapter<String>{
        Fill fill=null;
        public MusicAdapter(){
            super(GetMusics.this,android.R.layout.simple_list_item_1,song_list);
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub

            row = convertView;
            if(row==null){
                LayoutInflater inflater = getLayoutInflater();
                row = inflater.inflate(R.layout.row, null);
                fill=new Fill(row);
                row.setTag(fill);
            }else{
                fill=(Fill)row.getTag();
            }
            row.setBackgroundResource(R.drawable.list_selector);
            fill.setRow(song_list.get(position));
            return row;
        }
    } 
```

我也试过这个，但还是不行：

```
private AdapterView.OnItemClickListener onItemClick = new AdapterView.OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> arg0, View v, int arg2,
            long arg3) {
        // TODO Auto-generated method stub
        lv.getChildAt(arg2).setBackgroundResource(R.drawable.list_selector);
    }
}; 
```

这是我的 list_selector.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:state_focused="true"
        android:drawable="@color/Peru"/>
    <item android:state_pressed="true"
        android:drawable="@color/Tan"/>
    <item
        android:drawable="@color/Peru"/>
</selector> 
```

你有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T22:47:21.683

你必须使用一个叫做`Selector`并将其设置为的东西`ListSelector`，请参考这个问题[Android ListView Selector Color](https://stackoverflow.com/questions/2038040/android-listview-selector-color)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:16:49.963

`onItemClick()`传递您需要更改背景的视图。只需在那里设置背景。

```
@Override
public void onItemClick(AdapterView<?> arg0, View v, int arg2,
        long arg3) {
    v.setBackgroundResource(R.drawable.list_selector);
} 
```

# ruby-on-rails - 在旧版本的 Rails 上清空 Rake -T

> ID：13980403
> 
> 赞同：0
> 
> 时间：2012-12-20T21:01:54.830
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-2

当我运行时，`rake -T`我没有得到任何输出：

$ rake -T $ rake -v (在 /Users/noah/Work/website) rake 中止了！不知道如何构建任务“默认”（通过使用 --trace 运行任务查看完整跟踪）

例如，无论我运行什么`rake db:migrate`，我总是不知道如何构建任务“无论如何”

我正在使用 ruby​​ 1.8.7、Rails 2.3.8 和 rake (0.8.7)。

关于什么可能是错的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:34:43.873

由于所有不同的 ruby​​、rails、rake 等版本之间不兼容，我不得不迁移到 Rails 2.3.14。

# php - 在主机上启用 system() 和 exec() 功能？

> ID：13980404
> 
> 赞同：5
> 
> 时间：2012-12-20T21:01:58.413
> 
> 标签：php, wordpress, hosting, clone

我是一名开发人员，我在我的服务器上构建客户端站点，然后在完成后使用 PHP 脚本将其克隆到客户端的服务器。我这次尝试了，但出现错误

> “您的主机不允许使用 system() 和 exec() 函数。”

知道如何启用此功能吗？我有 cpanel 访问权限，主机帐户是 greengecko.com。安装 Wordpress 很简单，我就是无法运行这个脚本！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T21:07:37.173

如果您的主机禁用了这些功能，将无法启用它们。您可以考虑联系您的主机以查看他们是否会为每个帐户启用它们，或者如果您使用免费主机，您可以考虑升级到其主机的付费版本以启用这些功能。出于安全原因，它们被主机禁用。但是，您唯一的做法是联系您的网络托管服务商或尝试升级到付费托管服务（如果还没有）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:19:49.163

一些托管服务提供商能够从 .htaccess（如果是 Apache Httpd）中覆盖[php.ini](http://php.net/manual/en/ini.php)设置，或者使用托管帐户目录中某处的单独 php.ini 文件。

我不熟悉您的托管服务提供商，因此无法评论这是否可行。但是，我可以说，如果您能够利用这样的工具，您可能正在寻找[disable_functions](http://php.net/manual/en/ini.core.php#ini.disable-functions)指令。

作为进一步的建议，如果您发现自己能够“重新启用”受保护的 PHP 函数并且这是在客户的帐户上，我不能强调您记住之后再次“重新禁用”它们的重要性（禁用`exec()`并且`system()`托管帐户越来越成为必需品，因为漏洞利用和简单的错误对服务器安全性来说是极其昂贵的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-29T00:02:48.687

以利亚，我也有同样的问题，关于 system() 和 exec() 在 php 中没有被禁用。

只需通过 FTP 下载您网站根目录中的 php.ini 文件，您会发现如下内容：

```
register_globals = On
safe_mode = Off
enable_dl = On
disable_functions = "exec,passthru,shell_exec,proc_open,popen,system,curl_exec,curl_multi_exec,parse_ini_file,show_source" 
```

只需删除 disable_functions 行上的 exec，（“”之间的第一个单词）并删除系统，

不要忘记删除带有两个单词的逗号 (,)。

它对我有用。

请注意，大约一个月前我自己创建了这个 php.ini 文件，但我不知道为什么，通过更改 cPanel 中的 php 版本，exec 和系统又回来了。

还请遵循质粒87 在这里给出的好建议，在完成创建您的站点的克隆后将其放回原处。

马里奥·布鲁诺

# mysql - 在创建sql之前使用ID？

> ID：13980406
> 
> 赞同：0
> 
> 时间：2012-12-20T21:02:03.230
> 
> 标签：mysql, sql

你好我有一个关于mysql的问题

这是我的查询：

```
$geboortedatum = $_POST['dag'].'-'.$_POST['maand'].'-'.$_POST['jaar'];
$geboortedatum1 = $_POST['dag1'].'-'.$_POST['maand1'].'-'.$_POST['jaar1'];
try{                                                                    
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);                                                                   

    $sql = "
        INSERT INTO clienten 
        (client_voornaam,
        client_achternaam,
        client_geboortedatum,
        client_geslacht,
        client_adres,
        client_postcode,
        client_woonplaats,
        client_contactpersoon,
        client_diagnose,
        datun_aanmaak)
        VALUES (:voornaam,
        :achternaam.
        :geboortedatum,
        :geslacht,
        :adres,
        :postcode,
        :woonplaats,
        :contactpersoon,
        :diagnose,
        :datumaanmaak)
        INSERT INTO verzorgers(
        wat_is_verzorger,
        voornaam_verzorger,
        achternaam_verzorger,
        geboortedatum_verzorger,
        email_verzorger,
        geslacht_verzorger,
        adres_verzorger,
        postcode_verzorger,
        woontplaats_verzorger,
        tel1_verzorger,
        tel2_verzorger,
        datum_aanmaak
        )
        VALUES(
        :watisverz
        :voornaamverz,
        :achternaamverz,
        :geboortedatumverz,
        :emailverz,
        :geslachtverz:
        :adresverz,
        :postcodeverz,
        :woonplaatsverz,
        :tel1verz,
        :tel2verz,
        :datumaanmaak
        )
        ";                                                              

    $stmt = $db->prepare($sql);                                         

    $stmt->bindParam(':voornaam', $_POST['voornaam'], PDO::PARAM_STR);                  
    $stmt->bindParam(':achternaam', $_POST['achternaam'], PDO::PARAM_STR);                  
    $stmt->bindParam(':geboortedatum', $geboortedatum, PDO::PARAM_INT); 
    $stmt->bindParam(':geslacht', $_POST['geslacht'], PDO::PARAM_STR);                  
    $stmt->bindParam(':adres', $_POST['adres'], PDO::PARAM_STR);                    
    $stmt->bindParam(':postcode', $_POST['postcode'], PDO::PARAM_INT);  
    $stmt->bindParam(':woonplaats', $_POST['woonplaats'], PDO::PARAM_STR);                  
    $stmt->bindParam(':contactpersoon', $_POST['contactpersoon'], PDO::PARAM_STR);                  
    $stmt->bindParam(':diagnose', $_POST['diagnose'], PDO::PARAM_INT);  
    $stmt->bindParam(':datumaanmaak', $_POST['datum_toetreding'], PDO::PARAM_INT);                                                                      

        $stmt->execute();                                               

}                                                                       
catch(PDOException $e)                                                  
{                                                                       
    echo '<pre>';                                                       
    echo 'Regel: '.$e->getLine().'<br>';                                
    echo 'Bestand: '.$e->getFile().'<br>';                              
    echo 'Foutmelding: '.$e->getMessage();                              
    echo '</pre>';                                                      
}   ?> 
```

现在，当创建客户端和 verzorger 时，它们都会获得一个唯一的 ID。客户有一列存储相关的verzorger ID，反之亦然。是否可以进行也直接存储创建的 ID 的查询？

编辑：好吧，也许很难，也许是在verzorger中只获取客户ID的答案？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T15:55:08.220

这样的事情怎么样（TableAID 和 TableBID 都是 AUTO_INCREMENT 列）：

```
INSERT INTO TableA
(SomeColumn)
VALUES
('Blah');

SET @TableAID = LAST_INSERT_ID();

INSERT INTO TableB
(TableAID, AnotherColumn)
VALUES
(@TableAID,'Foobar');

SET @TableBID = LAST_INSERT_ID();

UPDATE TableA
SET TableBID = @TableBID
WHERE TableAID = @TableAID; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T21:04:42.100

您可以做的是创建一个查询序列生成器的函数：

```
create function foo  returns int
Begin 
   Declare nextValue int
   Set nextValue = SELECT NEXT VALUE FOR mySequence;
End
return (nextValue); 
```

这将允许您传递从该序列返回的值，并且您可以“提前”知道这些值将是什么。

**编辑**

请了解并发的工作原理并使用悲观或乐观锁定。虽然这应该是显而易见的，但有些人觉得有必要包括在内。

# html - 如何逆时针显示元素？

> ID：13980407
> 
> 赞同：3
> 
> 时间：2012-12-20T21:02:09.040
> 
> 标签：html, css, animation

我想将图像逆时针显示为动画？更准确地说，我想展示一颗星星的某种笔触，这样它会给你一种被画出来的印象。而这一切都只在 CSS3 中。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:58:11.240

此方法基于 Kyle J Larson 关于如何使用 CSS3 + 一些 CSS3 动画[创建饼图的帖子](http://www.kylejlarson.com/blog/2011/how-to-create-pie-charts-with-css3/)

**[DEMO](http://jsfiddle.net/GRR6B/2/show)**（[代码查看](http://jsfiddle.net/GRR6B/2/)）

```
<img src="http://t2.gstatic.com/images?q=tbn:ANd9GcRnxxoXUA200QV3f8ERe_3wM40HdwUUhx-Gyvh6Lurs27DcxksSWoUnsMfP" />
<div class="outer"><div class="inner"></div></div>
<div class="outer2"><div class="inner2"></div></div>​ 
```

CSS：

```
img {position:absolute;top:33px;left:32px;}
.outer {
    position:absolute;
    width:300px;
    height:300px;
    background:rgba(255, 0, 0, .5);
    background:transparent;
    clip: rect(0, 150px, 300px, 0);
    /*clip: initial;*/
}

.inner {
    position:absolute;
    background:rgba(0, 255, 0, .5);
    background:#fff;
    width:300px;
    height:300px;
    clip: rect(0, 300px, 300px, 150px);
    /*clip: initial;*/
    -webkit-transform:rotate(-180deg);
    border-radius:150px;
    -webkit-animation:innerAnim 3s 1 linear forwards;
}
.outer2 {
    position:absolute;
    width:300px;
    height:300px;
    background:rgba(127, 127, 0, .5);
    background:transparent;
    -webkit-transform:rotate(-180deg);
    clip: rect(0, 150px, 300px, 0);
    /*clip: initial;*/
}

.inner2 {
    position:absolute;
    background:rgba(0, 0, 255, .5);
    background:#fff;
    width:300px;
    height:300px;
    clip: rect(0, 300px, 300px, 150px);
    /*clip: initial;*/
    -webkit-transform:rotate(180deg);
    border-radius:150px;
    -webkit-animation:innerAnim2 3s 1 linear forwards 3s;
}

@-webkit-keyframes innerAnim {
    from {
        -webkit-transform:rotate(-180deg);
    }
    to {
        -webkit-transform:rotate(0deg);
    }
}

@-webkit-keyframes innerAnim2 {
    from {
        -webkit-transform:rotate(180deg);
    }
    to {
        -webkit-transform:rotate(0deg);
    }
}
​ 
```

*注意：每个类有 2`background`种样式，删除第 2 种以更好地了解动画的工作原理*

你甚至可以用 CSS 制作星星（参见：http: [//3easy.org/buildmobile/jquerymobile/#star](http://3easy.org/buildmobile/jquerymobile/#star)）

*编辑：*向 jsfiddle 添加了供应商前缀

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:43:26.673

我唯一能想到的就是使用[关键帧](http://www.w3schools.com/css3/css3_animations.asp)和动画属性。

使用它，您可以通过将其放置在带有一大堆区域或 div 标签的 div 中来模糊您的图像。然后使用动画，您可以“淡出”`divs`或`areas`显露图像。如果您正确掌握了隐藏图像的元素的位置和密度，则看起来好像正在绘制图像。

[这是一个非常基本的示例，它使用 4 个 div](http://jsfiddle.net/C6kk3/)来隐藏星形图像。如果您制作更多 div 并将它们更密集地放置在星星上，您可以轻松地显示它们。

这可以用更少的 CSS 来完成，但这只是一个简单的例子。

# android - 如何将数据库写入 CSV (Android)

> ID：13980409
> 
> 赞同：0
> 
> 时间：2012-12-20T21:02:21.627
> 
> 标签：android, csv

我已经研究出如何触发电子邮件并用数据库查询中的信息填充它，但我想将其写入 CSV 文件，以便我可以使用 excel 进行格式化（如果这样，可能会附加到电子邮件中）完全有可能）。

下面是我创建要发送到电子邮件的文本的代码：

```
private void exportRedRiskItemsToEmail(){

    recipient = email; 

    subject.append(inspectionRef).append(" - Locators Rack Inspection Report (Red Risk Items)");

    message.append("Dear ").append(contactFirstName).append(",\r\n");
    message.append("\r\n");
    message.append("Following todays inspection, below is a list of locations which are noted as Red Risk:\r\n");

    final Cursor areasCursor = (Cursor) rmDbHelper.fetchAllAreasForInspection(inspectionId);
    if(areasCursor.moveToFirst()){
        do{
            areaId = areasCursor.getLong(areasCursor.getColumnIndex(RMDbAdapter.AREA_ID));
            areaNumber = RMUtilities.notEmpty(areasCursor.getString(areasCursor.getColumnIndex(RMDbAdapter.AREA_NUMBER)), "number unknown"); 
            areaRef = RMUtilities.notEmpty(areasCursor.getString(areasCursor.getColumnIndex(RMDbAdapter.AREA_REF)), ""); 

            if (areaRef != ""){
                areaRef = " (" + areaRef + ")";
            }
            message.append("______________________________________________________").append("\r\n");
            message.append("\r\n");
            message.append("Area ").append(areaNumber).append(areaRef).append("\r\n");
            message.append("\r\n");

        } 
        while (areasCursor.moveToNext());
    }
    areasCursor.close();
    message.append("______________________________________________________").append("\r\n");
    message.append("\r\n");
    message.append("Please fully off-load above locations (for uprights, please off-load bays either side). \r\n");
    message.append("\r\n");
    message.append("We will follow up with our full report and quotation for repairs shortly. \r\n");
    message.append("\r\n");
    message.append("In the meantime, if you have any queries, please give me a call on 07970 088845\. \r\n");
    message.append("\r\n");
    message.append("Kind regards, \r\n");
    message.append("\r\n");
    message.append(inspector).append("\r\n");

    sendEmail(recipient, subject.toString(), message.toString());
} 
```

这是触发电子邮件的代码：

```
private void sendEmail(String recipient, String subject, String message) { 
    try { 
        final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
        emailIntent.setType("plain/text");
        emailIntent.setType("message/rfc822");
//      emailIntent.setType("high/priority"); //This didn't work - any way to do this though!?
        if (recipient != null)      emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{recipient}); 
        if (subject != null)        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject); 
        if (message != null)            emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, message); 

        startActivity(Intent.createChooser(emailIntent, "Send mail...")); 

    } catch (ActivityNotFoundException e) { 
        // cannot send email for some reason 
    } 
} 
```

任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:13:03.683

您可能想查看[OpenCSV](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDcQFjAA&url=http://opencsv.sourceforge.net/&ei=k37TUP-rMor28wSalIDgAw&usg=AFQjCNG3Pwd9EIuel-nctmq8gWiGjBKHgA&sig2=3ocUVlioIZupleRYoDFgnQ&bvm=bv.1355534169,d.eWU)库。它是免费、开源且易于使用的。它不支持直接从 SQLite DB 转储，但编写必要的代码来实现这一点应该非常简单。OpenCSV 确实支持将对象列表写入 CSV，因此，如果您可以将数据从 sqlite DB 中取出到列表中，那么您会很高兴。

这里还有[一篇](http://bethecoder.com/applications/tutorials/csv/open-csv/bean-to-csv.html)关于这个主题的帖子。

OpenCSV 也会写入文件。然后可以将此文件附加到电子邮件中，或按您的意愿使用（上传到谷歌驱动器，通过 USB 传输到计算机等）

```
 CSVWriter writer = new CSVWriter(new FileWriter("yourfile.csv"));
 // feed in your array (or convert your data to an array)
 writer.write(entries);
 writer.close(); 
```

这只是一个片段，我现在正在从内存中写入，所以它可能有点偏离。你也可以在 android 中查找写入文件。您可以将其存储在外部存储器或应用程序存储器中。如果您想从应用程序外部访问该文件，则需要将其放在外部存储器中。

```
Intent sendIntent = new Intent(Intent.ACTION_SEND); 
sendIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
sendIntent.putExtra(Intent.EXTRA_SUBJECT,"subject line"); 
sendIntent.putExtra(Intent.EXTRA_TEXT,"Body of email"); 
sendIntent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(new File("yourfile.csv"))); 
sendIntent.setType("vnd.android.cursor.dir/email"); 

startActivity(Intent.createChooser(sendIntent,"Email:")); 
```

# matlab - 忽略 Octave 中的某些行（但为 Matlab 保留它们）

> ID：13980414
> 
> 赞同：4
> 
> 时间：2012-12-20T21:02:47.467
> 
> 标签：matlab, octave, environment, getenv

> **可能重复：**
> [如何检测我运行的是 MATLAB 还是 Octave？](https://stackoverflow.com/questions/2246579/how-do-i-detect-if-im-running-matlab-or-octave)

我的代码是使用 MATLAB 设计的，我仍然使用它。但是，如果我尝试使用 Octave 运行其中的某些部分，则会出现错误。例如，MATLAB 代码使用`pause on`Octave 不使用的代码。

有没有办法检查哪个编程环境正在使用代码？例如，

```
if  invoking_env == 'Matlab'
    % do this
else 
    % ok, so do this
end 
```

我可以使用`getenv('COMPUTERNAME')`，但在这种情况下，计算机名称是相同的！谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T21:12:46.837

[MATLAB](http://www.mathworks.com/help/matlab/ref/version.html)和[Octave](http://octave.sourceforge.net/octave/function/version.html)都有版本函数。它们返回不同的值，并且 MATLAB 的版本有一些参数，这些参数在 Octave 中是不存在的。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:06:59.877

我认为最好的方法是有一个检查这个的子函数。以下代码段可能是系统要求最低的代码段。并且使用持久变量可以重复调用它而不会严重影响性能。

```
function r = isoctave ()
  persistent x;
  if (isempty (x))
    x = exist ('OCTAVE_VERSION', 'builtin');
  end
  r = x;
end 
```

然后，您可以在条件块中轻松使用它。请参阅Octave wiki 上的[该条目。](http://wiki.octave.org/Compatibility)

# android - 在 Android 中将自定义形状绘制到 Canvas 上

> ID：13980419
> 
> 赞同：0
> 
> 时间：2012-12-20T21:03:22.950
> 
> 标签：android, android-canvas

我已经被这个难住了一点，所以我想我会在这里询问是否有人有任何指示。

简而言之，我有一个应用程序，我希望将多个复杂的形状绘制到画布上，然后将其绘制到屏幕上（我将按照这个问题的答案中的建议在大画布上实现平移：[Android：绘图并在画布上旋转](https://stackoverflow.com/questions/4831824/android-drawing-and-rotating-on-a-canvas)）

我该如何创建自定义形状并将其绘制在 Android 画布上的任意位置/旋转处？

下面是一个简单的自定义形状的示例，到目前为止我已经尝试实现它（通常它们会在运行时创建）

```
public class Symbol {
    public Bitmap b = Bitmap.createBitmap(500, 500, Bitmap.Config.ARGB_8888);
    public Symbol() {
        Canvas canvas = new Canvas(b);;
        Paint paint = new Paint();
        paint.setColor(Color.GRAY);
        paint.setStyle(Paint.Style.STROKE);
        paint.setTextSize(25);
        paint.setStrokeWidth(4);
        paint.setDither(true);                    
        paint.setStrokeJoin(Paint.Join.ROUND);    
        paint.setStrokeCap(Paint.Cap.ROUND);      
        paint.setAntiAlias(true);  
        String str="TestStr";
        canvas.drawText(str, 250,250, paint);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:17:59.913

哇，我在这个上讨厌铁杆。

[Android：canvas.drawBitmap 性能问题](https://stackoverflow.com/questions/5186212/android-canvas-drawbitmap-performance-issue)

在我的主课中添加这个让一切都很开心，至少就这个简单的案例而言：

```
Symbol s = new Symbol();
canvas.save();
canvas.rotate(5);
canvas.drawBitmap(s.b, 0,0, null);
canvas.restore(); 
```

# jmockit - 编译器优化会导致使用原始静态最终值，即使它被 JMockit 更改

> ID：13980420
> 
> 赞同：2
> 
> 时间：2012-12-20T21:03:23.137
> 
> 标签：jmockit

考虑以下使用 JSch 创建 SSH 连接的代码：

```
public class DoSsh {
  private static final int DEFAULT_PORT = 22;

  public DoSsh(String user, String pass) {
    JSch jsch = new JSch();
    Session sess = jsch.getSession(user, pass, DEFAULT_PORT);
    ... 
```

以下使用 JMockit 的测试代码：

```
@Test
public void testDoShs() {
  // Change the default port
  Deencapsulation.setField(DoSsh.class, "DEFAULT_PORT", 2222);
  DoSsh ssh = new DoSsh("me","mypass");
  ... 
```

此处的目标是使 SSH 连接在测试期间使用备用端口（在本例中为 2222）连接到内存中的 SSH 服务器（Apache MIRA）。

当我调试这个时，我可以看到'DEFAULT_PORT'的值确实已经改变了（谢谢JMockit :-) 问题是编译器已经优化了对'jsch.getSession'的调用并硬编码了原始值22 进去。因此，当我在调试器中进入该调用时，即使传入的值为 2222，调用内部的值也是 22。

我的问题是，任何人都可以提出一种不涉及使 DEFAULT_PORT 非最终的解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:57:59.947

找到了我自己的答案。它涉及模拟对“jsch.getSession”的调用，然后从模拟中调用真实版本，并使用所需的端口号。这基本上是一种 AOP 方法。不使用解封装。这是代码：

```
@MockClass(realClass = JSch.class)
public static class MockedJSch {
    public JSch it;
    @Mock(reentrant = true)
    public Session getSession(final String user, final String pass, final int port) throws JSchException {
        return it.getSession(user, pass, TESTING_PORT);
    }
}

@BeforeMethod
public void beforeMethod() {
  Mockit.setUpMocks(MockedJSch.class);
} 
```

这里有两个关键点需要注意。

1.  模拟的方法被标记为“可重入”。
2.  模拟有一个名为“it”的公共实例成员，用于调用“真实”方法。该实例成员在 JMockit 内部的某处被初始化，以引用调用此方法的实例，并且该引用可以访问该方法的“真实”版本。

# javascript - 如何使用 Node.js (express.js) 开发多租户应用程序？

> ID：13980422
> 
> 赞同：14
> 
> 时间：2012-12-20T21:03:25.220
> 
> 标签：javascript, node.js, express

我正在寻找有关如何在 Node.js 中编写多租户应用程序的资源。谁能指导我正确的方向？谢谢。

这是我的技术栈：

*   节点.js
*   Express.js
*   摩卡.js
*   PostgreSQL SQL
*   JavaScript
*   HTML5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-29T03:47:11.667

可以在这里找到一个非常完整的 StackOverflow 答案：

[如何为 80 端口上的网站制作 Node.js 多租户？](https://stackoverflow.com/questions/10216003/how-to-make-node-js-multi-tenant-for-websites-on-port-80)

jackdbernier 对 expressJS 中的虚拟主机也有很好的回答。

# iphone - 将一个项目添加到另一个项目时出现问题

> ID：13980426
> 
> 赞同：0
> 
> 时间：2012-12-20T21:04:05.487
> 
> 标签：iphone, objective-c, ios, ipad

当我在文件夹 Flight 中的项目 ProjFlight 并且我正在向其中添加另一个项目 Proj4 时（通过在 xcode 中拖动 Proj4.xcodeproj 并添加库 libProj4.a 来添加）一切正常。但是当我将我的项目 ProjFlight 移动到另一个文件夹 saveFolder 并执行相同的操作以将项目 Proj4 添加到它时出现错误。在#import“proj_api.h”。未找到“proj_api.h”文件。我能做些什么来修复它？Project Proj4 可以在任何文件夹中。在这两种情况下，ProjFlight 位于文件夹 Flight 和 ProjFlight 位于文件夹 saveFolder

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:43:15.373

确保项目设置中的包含文件搜索路径正确

# sql - 需要根据查表值执行的SQL存储过程

> ID：13980428
> 
> 赞同：1
> 
> 时间：2012-12-20T21:04:14.287
> 
> 标签：sql, stored-procedures

我有一个 SQL 存储过程，仅当查找表值具有今天的日期时才需要执行。

如果不是，那么它应该在 30 分钟后以相同的标准再次运行。

我怎样才能做到这一点？

查找表只有一个日期行值 = '12-14-2012'。它将被另一个过程改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:07:19.553

像这样的东西可以为你做。请注意，此代码不会执行，您需要将项目替换为您的值。

```
DECLARE @Today DATE
SET @Today = GETDATE()

IF EXISTS (SELECT 'x' FROM MyTable WHERE CAST(ColumnName as DATE) = @Today)
    BEGIN
      EXEC Sproc Here
    END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:09:38.030

在较高级别上，您可以使用 SQL Server 代理来安排 proc。要决定是否运行，您可以在 proc 中放置类似的内容

```
IF EXISTS(SELECT * FROM LOOKUP WHERE colname = convert(varchar, getdate(), 110))
BEGIN 
    --do stuff
END 
```

# php - 通过 Session_start() 使用 PHP Cookie

> ID：13980430
> 
> 赞同：0
> 
> 时间：2012-12-20T21:04:29.100
> 
> 标签：php, cookies

我想转而使用 Cookies 进行身份验证，我提出了以下代码，并希望在我的`user_check.php`页面中实现类似的内容。

```
$username = $_POST['username'];
$ClientIP = $_SERVER['REMOTE_ADDR'];
date_default_timezone_set('Europe/London');
$date = date('m/d/Y h:i:s a', time());

$LoginAudit = $Con->prepare("INSERT INTO loginaudit ('ID', 'emailaddress, 'date') VALUES ('', '$username', '$date'");
$LoginAudit->execute();
setcookie("LoginAuthentication", $username , time()+3600);
header("location:member_area.php"); 
```

还有我的脚本来检查cookie是否已设置？

```
setcookie("LoginAuthentication", $username , time()+3600);

if (!isset($_COOKIE['LoginAuthentication']))
{
    /// Re-direct To Main Menu
    break; 
} 
```

我无法弄清楚为什么我的网站脚本没有获取我的 cookie LoginAuthentication 并自动登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:08:41.233

为此使用 cookie 是一个非常糟糕的主意，因为 cookie 是可编辑的和/或可以随时使用其中的任意信息创建（如 PeeHaa 所述）。

您应该查看 PHP**会话**。对于 PHP 会话，所有变量都存储在服务器上并链接到会话 ID。此会话 ID 在每个会话开始时创建，并（通常）存储在 cookie 中。

这往往是一种更安全的方法，因为特定的会话 ID 是唯一的，并且没有数据（会话 ID 除外）存储在客户端。

参考：

*   [http://php.net/manual/en/session.examples.basic.php](http://php.net/manual/en/session.examples.basic.php)
*   [http://php.net/manual/en/book.session.php](http://php.net/manual/en/book.session.php)
*   [http://www.tizag.com/phpT/phpsessions.php](http://www.tizag.com/phpT/phpsessions.php)

# javascript - Firefox 将文本覆盖放置在错误的位置，在 Firefox 中不起作用（适用于 IE、Chrome 和 safari）

> ID：13980438
> 
> 赞同：1
> 
> 时间：2012-12-20T21:04:57.027
> 
> 标签：javascript, css, firefox

我正在尝试制作一个照片库： http: [//lovingearthphotography.com/cal.html](http://lovingearthphotography.com/cal.html) 我正在修改我在网上找到的一个使用表格查看缩略图的示例。我想用一些文字（拍摄照片的月份的哪一天）覆盖缩略图。虽然这适用于大多数浏览器，但文本在 Firefox 中没有显示在正确的位置。如果您转到上面的链接，您将看到表格左上角的数字 9，而不是每个单元格左上角的文本）。

该表是在 JS 中生成的：

```
getCurrentThumbTable: function(){
    var thumbTable = new Element("table");
    var thumbTableBody = new Element("TBODY");

    thumbTable.setProperty('id', 'imagoCurrentThumbTable');
    var counter = this.lastThumbImageIndex;
    for (i = 0; i < this.thumbnailRows; i++) {
        var tr = new Element("tr");
        for (j = 0; j < this.thumbnailColumns; j++) {
            var td = new Element("td");
            td.style.position = "relative";
            if (this.getThumbImage(counter) != null) {
                td.appendChild(this.getThumbImage(counter));
                //var text = new Element("div");
                //text.addClass( "thumbOverlay" );
                var text = document.createElement('div');
                text.style.position = "absolute";
                text.style.fontSize = "24px";
                text.style.left = "5px";
                text.style.top = "5px";
                text.style.color = "#f5f5f5";
                text.style.backgroundColor = "rgba(69,69,69,0.8)";

                text.innerHTML = this.images[counter].getImageDay();

                td.appendChild(text);
                counter++;
                this.lastThumbsOnCurrentPage++;
                if (this.images.length > this.thumbsPerPage) {
                    ElementHelper.show('imagoMenuNextLink');
                }
            }
            else {
                ElementHelper.hide('imagoMenuNextLink');
            }
            tr.appendChild(td);
        }
        thumbTableBody.appendChild(tr);
    }
    thumbTable.appendChild(thumbTableBody);
    this.lastThumbImageIndex = counter;
    return thumbTable;
}, 
```

在运行时产生：

```
<table id="imagoCurrentThumbTable">
    <tbody>
        <tr>
            <td style="position: relative;">
                <img src="Pics/thu/001.jpg" class="imago_thumbImg imago_selectedThumb" alt="Running" id="id_001.jpg">
                <div style="position: absolute; font-size: 24px; left: 5px; top: 5px; color: rgb(245, 245, 245); background-color: rgba(69, 69, 69, 0.8);">1</div>
            </td>
            ….
            <td style="position: relative;">
                <img src="Pics/thu/002.jpg" class="imago_thumbImg" alt="abcd" id="id_002.jpg">
                <div style="position: absolute; font-size: 24px; left: 5px; top: 5px; color: rgb(245, 245, 245); background-color: rgba(69, 69, 69, 0.8);">2</div>
            </td>
        </tr>
    </tbody>
</table> 
```

有谁知道为什么这在 FF 中不起作用？

谢谢

KK

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:15:29.333

前几天有一个非常相似的问题。

在我经常使用的网站上通过谷歌搜索找到了这个[绝对位置元素在表格单元内。](http://css-tricks.com/absolutely-position-element-within-a-table-cell/)

您需要在表格单元格 position: relative 中放置一个容器 div，以便绝对位置项可以与其对齐。

希望有帮助

# cloud-foundry - 使用 BOSH 部署云代工——“bosh 删除部署”清理了什么？

> ID：13980440
> 
> 赞同：1
> 
> 时间：2012-12-20T21:05:03.163
> 
> 标签：cloud-foundry, cf-bosh

我们刚刚完成了使用 BOSH 部署多节点（34 节点）云代工厂的过程，但在此过程中遇到了一些小问题。一个特别的问题是，我们花了几次“bosh deploy”运行才能完成初始编译步骤。我们将启动 bosh 部署，它会开始编译，通过一些组件然后失败。毫无疑问，我们基于 VMWare 的基础架构存在一些配置问题，我怀疑我们的资源即将耗尽。但这是我现在的主要问题。

我们能够通过在失败后发出“bosh delete deployment ourcloud --force”来完成编译。

这个命令清除了什么？它显然留下了成功编译的东西，但是清理了什么？临时存储？还要别的吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T23:15:00.257

bosh delete deployment 将删除整个部署，它会删除 vCenter 中的虚拟机，清除其数据库中的信息并删除清单。完成后，应该没有部署的跟踪（日志除外）。

# html - PRE 标签无法正常工作

> ID：13980441
> 
> 赞同：2
> 
> 时间：2012-12-20T21:05:17.150
> 
> 标签：html

对于 PHP 调试，我给自己做了一个 pre() 函数，如下所示：

```
function pre($data)
{
    echo '<pre>'.print_r($data).'</pre>';
} 
```

但它没有按应有的方式显示换行符。例如，我将所有这些都集中在一行上：

`Template_model Object ( [id] => 1 [type] => 1 [shortname] => default [is_custom] => 0 [is_open] => 1 [options] => Array ( [id] => 1 [name] => background_color [value] => #6699CC [type] => 0 [campaign_id] => 8 [user_id] => 11 [template_id] => 1 ) )`

有些部分应该有换行符。我究竟做错了什么？

这可能听起来很新，但是当我多年来一直使用它时，我无法理解我做错了什么。

请不要在页面上显示任何其他 HTML 之前调用我的 pre 函数。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:08:00.203

[`print_r`](http://php.net/print_r)不返回字符串，它回显到屏幕本身（并返回 TRUE）

如果您`true`作为第二个参数传递，那么它将返回一个字符串。

```
echo '<pre>'.print_r($data, true).'</pre>'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:07:10.863

您需要打印`pre`之前`print_r()`处理`print_r()`它自己的输出。像这样：

```
function pre($data) 
{
    echo '<pre>';
    print_r($data);
    echo '</pre>';
} 
```

但是，如果您使用可选参数（指定您希望它返回输出），我不确定它是否会保留换行符。让我们看看[键盘对此有什么看法](http://codepad.org/uEBsvLeN)。

# mysql - mysql中的竞争条件选择sql

> ID：13980443
> 
> 赞同：2
> 
> 时间：2012-12-20T21:05:38.143
> 
> 标签：mysql

我试图完成的事情似乎很简单，

Db类型：MyISAM
表结构：card_id，status
查询：从表中选择一个未使用的card_id，并将该行设置为“已使用”。

当两个查询同时运行并且在更新状态之前，两次获取相同的 card_id 是否是竞争条件？

我已经做了一些搜索。似乎 Lock table 是一个解决方案，但它对我来说太过分了，需要 Lock Privilege。

任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:17:23.353

这实际上取决于您正在运行的语句。

对于针对 MyISAM 表的普通旧`UPDATE`语句，MySQL 将获得整个表的锁定，因此两个会话之间没有“竞争”条件。一个会话将等到锁被释放，然后继续它自己的更新（或将等待指定的时间段，并以“超时”中止。）

但是，如果您要问的是两个会话都对表运行 SELECT 以检索要更新的行的标识符，并且两个会话都检索相同的行标识符，然后两个会话都尝试更新同一行，那么是的，这是一种确定的可能性，并且确实必须考虑。

如果没有解决该条件，那么基本上将是“最后一次更新获胜”的问题，第二个会话将（可能）覆盖先前更新所做的更改。

如果这对您的应用程序来说是一个站不住脚的情况，那么确实需要解决这个问题，或者使用不同的设计，或者使用某种机制来防止第二次更新覆盖第一次更新所应用的更新。

正如您所提到的，一种方法是通过首先获得表上的排他锁（使用 LOCK TABLES 语句），然后运行 ​​SELECT 来获取标识符，然后运行 ​​UPDATE 来更新标识的行来避免这种情况，并且最后，释放锁（使用 UNLOCK TABLES 语句。）

对于一些低容量、低并发的应用程序来说，这是一种可行的方法。但它确实有一些明显的缺点。主要关注的是并发性降低，因为在单个资源上获得了排他锁，这有可能导致性能瓶颈。

另一种选择是一种称为“乐观锁定”的策略。（与前面描述的方法相反，可以描述为“悲观锁定”。）

对于“乐观锁定”策略，会在表中添加一个额外的“计数器”列。每当对表中的行应用更新时，该行的计数器就会加一。

为了使用这个“计数器”列，当查询检索到稍后将（或可能）更新的行时，该查询也会检索计数器列的值。

当尝试更新时，该语句还将行中“计数器”列的当前值与先前检索到的计数器列值进行比较。（我们只是在 UPDATE 语句中包含一个谓词（例如在 WHERE 子句中）。例如，

```
UPDATE mytable
   SET counter = counter + 1
     , col = :some_new_value       
 WHERE id = :previously_fetched_row_identifier
   AND counter = :previously_fetched_row_counter 
```

如果某个其他会话对我们尝试更新的行应用了更新（有时在我们的会话检索该行的时间和我们的会话尝试进行更新之前），那么该行上“计数器”列的值将被改变。

我们的 UPDATE 语句中的谓词会检查这一点，如果“计数器”已更改，那将导致我们的更新不被应用。然后我们可以检测到这种情况（即受影响的行数将是 0 而不是 1）并且我们的会话可以采取一些适当的措施。（“嘿！其他一些会话更新了我们打算更新的行！”）

关于如何实现“乐观锁定”策略有一些很好的文章。

一些 ORM 框架（例如 Hibernate、JPA）为这种类型的锁定策略提供支持。

* * *

不幸的是，MySQL 不支持 UPDATE 语句中的 RETURNING 子句，例如：

```
UPDATE ... 
   SET status = 'used'
 WHERE status = 'unused'
   AND ROWNUM = 1
RETURNING card_id INTO ... 
```

其他 RDBMS（例如 Oracle）确实提供了这种功能。有了 UPDATE 语句的这个特性，我们可以简单地运行`UPDATE`语句来 1) 找到一行`status = 'unused'`2) 更改 的值`status = 'used'`3) 返回`card_id`我们刚刚更新的行的（或我们想要的任何列） .

这解决了必须运行 SELECT 然后运行单独的 UPDATE 的问题，其他会话可能会更新我们的 SELECT 和我们的 UPDATE 之间的行。

但是`RETURNING`MySQL 不支持该子句。而且我还没有找到任何可靠的方法来从 MySQL 中模拟这种类型的功能。

* * *

**这可能对你有用**

我不完全确定为什么我以前使用用户变量放弃了这种方法（我在上面提到过我已经玩过这个。我想也许我需要更通用的东西，它会更新不止一行并返回一组 id值。或者，也许有一些关于用户变量的行为不能保证的东西。（再说一次，我只在精心构造的 SELECT 语句中引用用户变量；我不在 DML 中使用用户变量；可能是因为我不能保证他们的行为。）

由于您只对一行感兴趣，因此这三个语句的序列可能对您有用：

```
SELECT @id := NULL ;

UPDATE mytable
   SET card_id = (@id := card_id) 
     , status = 'used'
 WHERE status = 'unused'
 LIMIT 1 ;

SELECT ROW_COUNT(), @id AS updated_card_id ; 
```

重要的是这三个语句在同一个数据库会话中运行（即保持数据库会话；不要放手并获得一个新的。）

首先，我们将用户变量 ( `@id`) 初始化为一个不会与表中的真实 card_id 值混淆的值。（`SET @id := NULL`语句也可以工作，不返回结果，就像 SELECT 语句一样。）

接下来，我们将`UPDATE`语句运行到 1) 找到其中的一行`status = 'unused'`，2) 将`status`列的值更改为`'used'`3) 将`@id`用户变量的`card_id`值设置为我们更改的行的值。（我们希望该`card_id`列是整数类型，而不是字符，以避免任何可能的字符集转换问题。）

`ROW_COUNT()`接下来，我们运行一个查询，使用该函数（我们需要在客户端验证这是 1）获取上一个 UPDATE 语句更改的行数，并检索`@id`用户变量的值，这将是已更改行中的 card_id 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T15:50:39.963

在我发布这个问题之后，我想到了一个与您最后提到的解决方案完全相同的解决方案。我使用了update语句，即“update TABLE set status ='used' where status ='unused' limit 1”，它返回TABLE的primary Id，然后我可以使用这个primary ID来获取cart_id。说有两个更新语句同时发生，正如你所说，“MySQL 将获得整个表的锁，因此两个会话之间没有“竞争”条件”，所以这应该解决我的问题。但我不确定您为什么说“MySQL 不提供样式声明支持”。

# javascript - jQuery .focusout / .click 冲突

> ID：13980448
> 
> 赞同：34
> 
> 时间：2012-12-20T21:06:10.937
> 
> 标签：javascript, jquery

我正在开发一个带有自动完成搜索框的项目。现在我有一个问题，我想将找到的自动完成结果中的值传递给输入框，但同时，我希望在输入字段没有更集中时隐藏自动完成框。

现在我和他们两个都发生了冲突，因为点击自动完成框被视为焦点，甚至在它可以传递值之前隐藏框。此类问题的任何指示或解决方法？这里有一个 jsfiddle 让你更清楚。

[http://jsfiddle.net/KeGvM/](http://jsfiddle.net/KeGvM/)

或者在这里

**CSS**：

```
#a_c {display:none;}​ 
```

**JS**：

```
$('#search_field').focusout(function() {
    $('#a_c').hide(); // IF I DELETE THIS IT WORKS
});

$('#search_field').focusin(function() {
    $('#a_c').show();
});

$('#a_c a').click(function() {
    $('#search_field').val('');
    var value = $(this).text();
    var input = $('#search_field');
    input.val(input.val() + value);
    $('#a_c').hide();
    return false;
});​ 
```

**HTML**：

```
<input autocomplete="off" onkeyup="searchFor(this.value);" name="search" id="search_field" class="bold" type="text" placeholder="Search...">
<div id="a_c"><a href="">hello world</a></div>​ 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2017-12-22T16:50:50.493

我解决这个问题的方法是使用`mousedown`事件而不是`click`. `mousedown`事件**总是**在事件之前触发，`focusout`而`click`不是。

您可以在下面的小演示中尝试一下。专注于该领域，然后单击按钮。

```
const field = document.getElementById('field');
const btn = document.getElementById('btn');

btn.addEventListener('click', () => console.log('Click'));
btn.addEventListener('mousedown', () => console.log('Mouse down'));
field.addEventListener('focusout', () => console.log('Focus out'));
```

```
<input id="field">
<button id="btn">Try it</button>
```

如您所见，输出按以下顺序排列：

1.  鼠标向下
2.  专注
3.  点击

这是最稳定的解决方案，无需使用任何解决方法，如超时。它也不依赖于 jQuery。唯一值得注意的是`mousedown`不等待用户释放他们的鼠标按钮，但就用户体验而言，这并不是真正关心的问题。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-11-21T03:03:39.733

怎么用

> ：徘徊

我用它解决了同样的问题。

```
$('className').on('focusout', function(e) {
    if($('.suggestLi' + ':hover').length) {
        return;
    }
    $('.suggestList').empty();
}); 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-12-20T21:09:39.387

在类似情况下，我的解决方案是使用超时来暂时推迟在`blur`事件处理程序中执行的操作。像这样：

```
$('#search_field').focusout(function() {
    window.setTimeout(function() { $('#a_c').hide() }, 100);
}); 
```

# c++ - C++ Autotools 谷歌测试框架

> ID：13980449
> 
> 赞同：2
> 
> 时间：2012-12-20T21:06:11.987
> 
> 标签：c++, autotools, googletest

我正在尝试使用自动工具将 Google 测试框架添加到我的应用程序中。但是我遇到了一些奇怪的错误。在configure.ac中：

```
AC_CHECK_HEADER([gtest/gtest.h], [AC_DEFINE([HAVE_GTEST_H], 1)]) 
```

但在日志中我得到：

```
...
checking for limits.h... yes
checking gtest/gtest.h usability... no
checking gtest/gtest.h presence... no
checking for gtest/gtest.h... no 
```

配置日志：

```
configure:3276: checking gtest/gtest.h presence
configure:3276: gcc -E  conftest.c
In file included from conftest.c:19:0:
/usr/include/gtest/gtest.h:54:18: fatal error: limits: No such file or directory
compilation terminated. 
```

两个文件都存在。据我所知 /usr/include 是默认包含。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:19:52.653

`<limits>`是一个 C++ 标头，这可能表示`gtest.h`是一个 C++ 标头，这意味着 Google 测试框架是用 C++ 编写的。您需要使用 C++ 编译器来检测标头的可用性。

有关如何使用自动工具解决此问题的详细信息，请参阅[此答案。](https://stackoverflow.com/a/6129834/256138)

# ssl - GlassFish 3：HTTP 侦听器上的 HTTPS 请求挂起

> ID：13980451
> 
> 赞同：1
> 
> 时间：2012-12-20T21:06:30.440
> 
> 标签：ssl, https, glassfish

我有一个程序使用 HTTPS 连接到 GlassFish 中的 JSF 应用程序，但 GlassFish 仅配置为纯 HTTP。该程序首先尝试 HTTPS，如果 HTTPS 不起作用，则回退到 HTTP。

使用*ssldump*我可以看到 GlassFish 2.1 在收到 HTTPS 请求时立即发送 TCP FIN，但 GlassFish 3.1.2.2 只是处于空闲状态。

GlassFish 2.1 的作用如下：

> 新 TCP 连接 #1：localhost(53643) <-> localhost(8081)
> 1 1 0.0008 (0.0008) C>S Handshake
> ClientHello
> 3.1 版
> 密码套件
> ...
> 1 0.0106 (0.0098) S>C TCP FIN

GlassFish 3.1.2.2 的作用如下：

> 新的 TCP 连接 #1：localhost(53388) <-> localhost(8081)
> 1 1 0.0005 (0.0005) C>S Handshake
> ClientHello
> 版本 3.1
> 密码套件
> ...
> 1 59.9989 (59.9983) C>S TCP FIN

如何让 GlassFish 3.1.2.2 立即关闭连接（尝试）？

我为 HTTP 侦听器使用了开箱即用的标准配置。图片中没有防火墙。我使用相同的客户端程序在同一台机器上运行这两个测试，只是每次使用不同的 GlassFish。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T20:23:53.343

这是客户端的 OpenSSL 库过时的问题。更新 OpenSSL 后一切正常。

# android - 获取 Google Maps Android v2 API 密钥

> ID：13980454
> 
> 赞同：-1
> 
> 时间：2012-12-20T21:06:34.367
> 
> 标签：android, google-maps-api-2

我知道这不是问这个问题的正确地方，但有人可以指出一个简单的教程，说明如何获取 Google Maps Android v2 API 密钥以及如何使用它在我的应用程序中显示地图。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:10:27.330

完整的说明在[这里](https://developers.google.com/maps/documentation/android/start#the_google_maps_api_key)。

# haskell - Haskell 错误：“(n+k) 模式中的第一个参数必须是变量” - 但是如何？

> ID：13980460
> 
> 赞同：2
> 
> 时间：2012-12-20T21:07:03.423
> 
> 标签：haskell

我正在尝试创建一个无限的毕达哥拉斯值列表，但我遇到了一个问题。

```
pytrips = [(x, y, z) | z <- [1..], y <- [1..z], x <- [1..y],
           (x^2 + y^2) <- z^2, gcd x y == 1] 
```

我的错误是这样写的：

`"First argument in (n+k) pattern must be a variable"`

我不太明白我为此提出了什么语法问题，因为该方法不需要传递任何参数。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T21:09:22.640

您可能打算写`==`而不是`<-`：

```
pytrips = [(x, y, z) | z <- [1..], y <- [1..z], x <- [1..y],
           x^2 + y^2 == z^2, gcd x y == 1] 
```

# php - 使用 PHPExcel 将新行追加到 Excel 文件

> ID：13980471
> 
> 赞同：1
> 
> 时间：2012-12-20T21:07:44.867
> 
> 标签：php, excel-2007, add

我有这个代码

```
 $objPHPExcel = new PHPExcel();
    $objPHPExcel->setActiveSheetIndex(0);
    $LastRow = $objPHPExcel->setActiveSheetIndex(0)->getHighestRow();
    $row = $LastRow + 1;

    $objPHPExcel->getActiveSheet()->SetCellValue('A'.$row, $_POST['name']);
    $objPHPExcel->getActiveSheet()->SetCellValue('B'.$row, $_POST['email'] );
    $objPHPExcel->getActiveSheet()->SetCellValue('C'.$row, $_POST['tel']);
    $objPHPExcel->getActiveSheet()->SetCellValue('D'.$row, $_POST['adresss']);

    $objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);

    $objWriter->save('files\Clientes.xlsx'); 
```

这里的问题是总是创建一个新的 .xlsx 文件或删除 Excel 文件中的其他行，我需要添加一个新行......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:11:22.727

在您当前的代码中，您每次都在创建一个新的 PHPExcel() 对象。您需要加载现有的，然后插入新行。请参阅此处了解如何：[使用 PHPExcel 添加新行？](https://stackoverflow.com/questions/11416934/phpexcel-add-new-line)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:12:28.363

```
$objPHPExcel = $objReader->load("FILE.xlsx");
$objWorksheet = $objPHPExcel->getActiveSheet(); 
```

只需打开文件

# objective-c - 对 Class 对象执行类方法

> ID：13980474
> 
> 赞同：0
> 
> 时间：2012-12-20T21:08:02.263
> 
> 标签：objective-c, class, selector

我有一个`Class`类的实例，通过调用`class`方法获得（下面的例子）。对于那个实例，我想调用一个类（`+ ..`）方法。

**被调用者**

```
Class foo = [FooBar class];
SEL selector = @selector(doSomething:)
// Call somehow? 
```

**FooBar 定义**

```
@implementation FooBar

+ (void)doSomething:(id)argument { .. }

@end 
```

有没有办法做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:21:36.660

```
Class foo = [FooBar class];
[foo doSomething]; 
```

# c++ - 不能在 C++ 中重载运算符>>

> ID：13980475
> 
> 赞同：0
> 
> 时间：2012-12-20T21:08:04.417
> 
> 标签：c++, overloading, operator-keyword

我正在学习 C++，但是当我尝试从 Java 代码转换为 C++ 时，我一直遇到这个错误。我在 java 中有一些类，我必须将其翻译成 c++ 代码（使用 C++ 风格的编程）。我有一个 Article 类，从 ArticleUnitaire 继承的 ArticleUnitaire 类，以及从 ArticleUnitaire 继承的 Ramette 类。所有的 getter 和 setter 都可以正常工作，问题是当我尝试执行与 c++ 等效的 toString 时，即 operator<< 重载。让我向您展示代码和错误： Java 代码：

```
 public abstract class Article {
      ....
      public String toString() {
        return this.getClass().getName() + ":reference=" 
          + reference + ";descriptif=" + getDescriptif() 
          + ";marque=" + getMarque() + ";PU=" + getPU();
      }

    }

public abstract class ArticleUnitaire extends Article {
  private String marque;
  private double pu;
  private String descriptif;

  public ArticleUnitaire(String reference) {
    super(reference);
  }

  public ArticleUnitaire(String reference, String descriptif, String marque,
                         double pu) {
    super(reference);
    this.marque = marque;
    this.pu = pu;
    this.descriptif = descriptif;
  }

  // useless to redefine toString because PU and descriptif
  // were also displayed by the superclass(Article)

}

public class Stylo extends ArticleUnitaire {
 ....

  @Override
  public String toString() {
    return super.toString() + ";couleur=" + couleur;
  }
} 
```

这是我的文章.h 文件：

```
 #include <string>
    using namespace std;

    class Article
    {
        public:
        string getReference();
        virtual string getDescriptif() const;
        virtual double getPU() const;
        string getMarque() const;
        void Afficher(ostream&) const;
        ostream& operator<<(ostream&) const;

        protected:
        Article(string&);
            string reference;
        private:

    };

    class ArticleUnitaire : public Article {
        public:
          ArticleUnitaire(string);
          ArticleUnitaire(string, string, string, double);
          string getMarque() const;
          void setMarque(string&);
          double getPU() const;
          void setPU(double&);
          void setDescriptif(string&);
          string getDescriptif() const;
          void Afficher(ostream&) const;

        protected:
          string marque;
          double pu;
          string descriptif;
        private:

    };

    class Stylo : public ArticleUnitaire {
        public:
          Stylo(string r, string d, string m, double p, string c);
          void Afficher(ostream& os) const;
          string getCouleur();
        protected:
        private:
          string couleur;

    };

class Lot : public Article {
    public:
      Lot(string, Article, int, int);
      double getPU() const;
      string getDescriptif() const;
      string getMarque() const;
      int getNbArticles() const;
      void setNbArticles(int&);
      int getPourcentage() const;
      void setPourcentage(int&);
      Article getArticle() const;
      void setArticle(Article&);
      virtual void Afficher(ostream& os) const;

    protected:
    private:
      int nb;
      int pourcentage;
      Article art;
}; 
```

还有articles.cc 文件：

```
 #include <typeinfo>
    #include <string>
    using namespace std;
    #include "articles.h"

    /*   Article   */

    Article::Article(string& ref) : reference(ref) {};

    string Article::getReference() {
      return reference;
    }

    ostream& Article::operator<<(ostream& os) const {
      Afficher(os);
      return os;
    }

    string Article::getMarque() const {
      return "Sans marque";
    }

    void Article::Afficher(ostream& os) const {
      os << " : reference = " << getReference() << " ; descriptif = " << getDescriptif() << " ; marque = " << getMarque() << " ; PU = " << getPU();
    }

    /*   Article Unitaire   */

    ArticleUnitaire::ArticleUnitaire(string r) : Article(r) {};

    ArticleUnitaire::ArticleUnitaire(string r, string d, string m, double p) : Article(r), marque(m), descriptif(d), pu(p) {};

    string ArticleUnitaire::getMarque() const {
      return marque;
    }

    void ArticleUnitaire::setMarque(string& m) {
      marque = m;
    }

    double ArticleUnitaire::getPU() const {
      return pu;
    }

    void ArticleUnitaire::setPU(double& p) {
      pu = p;
    }

    void ArticleUnitaire::setDescriptif(string& d) {
      descriptif = d;
    }

    string ArticleUnitaire::getDescriptif() const {
      return descriptif;
    }

    /*   Stylo    */

    Stylo::Stylo(string r, string d, string m, double p, string c) : ArticleUnitaire(r,d,m,p), couleur(c) {};

    string Stylo::getCouleur() {
      return couleur;
    }

    void Stylo::Afficher(ostream& os) const {
      Article::Afficher(os);
      os << " ; couleur = " << getCouleur();
    }

Lot::Lot(String r, Article a, int n, int p) : Article(r) {
  art = a;
  nb = n;
  pourcentage = p;
};
... 
```

但是，当我尝试编译时，方法 Afficher() 始终出现相同的错误：

```
In member function ‘void Article::Afficher(std::ostream&) const’:
articles.cc:24:9: error: no match for ‘operator<<’ in ‘os << " : reference = "’
articles.cc:24:9: note: candidate is:
In file included from /usr/include/c++/4.7/string:54:0,
                 from articles.cc:2:
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note:   template argument deduction/substitution failed:
articles.cc:24:9: note:   mismatched types ‘const std::basic_string<_CharT, _Traits, _Alloc>’ and ‘const char [16]’
articles.cc:24:43: error: passing ‘const Article’ as ‘this’ argument of ‘std::string Article::getReference()’ discards qualifiers [-fpermissive]
articles.cc: In member function ‘void Stylo::Afficher(std::ostream&) const’:
articles.cc:67:9: error: no match for ‘operator<<’ in ‘os << " ; couleur = "’
articles.cc:67:9: note: candidate is:
In file included from /usr/include/c++/4.7/string:54:0,
                 from articles.cc:2:
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note:   template argument deduction/substitution failed:
articles.cc:67:9: note:   mismatched types ‘const std::basic_string<_CharT, _Traits, _Alloc>’ and ‘const char [14]’
articles.cc:67:39: error: passing ‘const Stylo’ as ‘this’ argument of ‘std::string Stylo::getCouleur()’ discards qualifiers [-fpermissive]
articles.cc: In member function ‘void Ramette::Afficher(std::ostream&) const’:
articles.cc:79:9: error: no match for ‘operator<<’ in ‘os << " ; grammage = "’
articles.cc:79:9: note: candidate is:
In file included from /usr/include/c++/4.7/string:54:0,
                 from articles.cc:2:
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note:   template argument deduction/substitution failed:
articles.cc:79:9: note:   mismatched types ‘const std::basic_string<_CharT, _Traits, _Alloc>’ and ‘const char [15]’
articles.cc:79:41: error: passing ‘const Ramette’ as ‘this’ argument of ‘int Ramette::getGrammage()’ discards qualifiers [-fpermissive]
articles.cc: At global scope:
articles.cc:84:9: error: expected constructor, destructor, or type conversion before ‘(’ token
articles.cc: In member function ‘virtual std::string Lot::getDescriptif() const’:
articles.cc:91:26: error: invalid operands of types ‘const char*’ and ‘const char [3]’ to binary ‘operator+’
articles.cc: In member function ‘void Lot::Afficher(std::ostream&) const’:
articles.cc:124:9: error: no match for ‘operator<<’ in ‘os << " ;reduction = "’
articles.cc:124:9: note: candidate is:
In file included from /usr/include/c++/4.7/string:54:0,
                 from articles.cc:2:
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/include/c++/4.7/bits/basic_string.h:2750:5: note:   template argument deduction/substitution failed:
articles.cc:124:9: note:   mismatched types ‘const std::basic_string<_CharT, _Traits, _Alloc>’ and ‘const char [15]’ 
```

如您所见，编译器不喜欢我对 operator>> 重载中使用的方法 Afficher 所做的事情。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:12:49.487

一些问题：

*   Stylo::getCouleur() 不是 const

*   Ramette::getGrammage() 不是 const

这是我发现的前两个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:22:44.657

重载`operator<<`为非成员函数，而不是成员函数。这是唯一的方法，因为您希望您的对象位于运算符的右侧，而不是左侧（并且您不能更改 class `std::ostream`）。

编辑：但是那个非成员函数又可以调用一个虚拟成员函数......

头文件：

```
class Article {
public:
    virtual void Afficher(std::ostream& os) const;
    //...
};
std::ostream& operator<<(std::ostream& os, const Article& art);

class ArticleUnitaire : public Article {
public:
    virtual void Afficher(std::ostream& os) const;
    //...
};

inline std::ostream& operator<<(std::ostream& os, const Article& art) {
    art.Afficher(os);
    return os;
} 
```

源文件：

```
void Article::Afficher(std::ostream& os) const {
    //...
}

void ArticleUnitaire::Afficher(std::ostream& os) const {
    Article::Afficher(os);
    //Other data...
} 
```

# c++ - C++ 函数参数将指针的地址作为参数。这是如何使用的？它是干什么用的？

> ID：13980482
> 
> 赞同：5
> 
> 时间：2012-12-20T21:08:50.873
> 
> 标签：c++, function, pointers, reference

想象一个这样的函数：

```
 function(Human *&human){
      // Implementation
 } 
```

你能解释一下 *& 到底是什么吗？它会用来做什么？与仅传递指针或引用有何不同？你能提供一个小的解释性样本吗？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T21:11:07.553

```
void doSomething(int &*hi); 
```

不管用。您不能指向参考。然而，这：

```
void doSomething(int *&hi); // is valid. 
```

它是对指针的引用。这很有用，因为您现在可以将此指针传递给函数以指向其他“人类”类型。

如果您查看此代码，它会将“hi”指向“someVar”。但是，对于传递给这个函数的原始指针，什么都不会改变，因为指针本身是按值传递的。

```
void doSomething(int *hi)
{
    hi = &someVar;
} 
```

所以你这样做，

```
void doSomething(int *&hi)
{
    hi = &someVar;
} 
```

这样传递给函数的原始指针也被改变了。

如果您理解“指向指针的指针”，那么请想象一下，除非某物是引用，否则它可以被视为“非指针”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T21:11:06.610

它就像一个双指针。您通过引用传递指针，允许“函数”函数修改指针的值。

例如，“human”可以指向 Jeff，函数可以修改它以指向 Ann。

```
Human ann("Ann");

void function(Human *& human)
{
    human = &ann;
}

int main()
{
    Human jeff("Jeff");
    Human* p = &jeff;
    function(p);  // p now points to ann
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-20T21:10:48.500

“获取指针的地址” - 不，它没有。它~~需要~~引用一个[指针](http://en.wikipedia.org/wiki/Reference_%28C++%29)。

但是，这是一个语法错误。你可能的意思是

```
rettype function(Human *&human) 
```

（是的，它也缺少返回类型......）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-20T21:15:54.937

由于您是在脑海中写下这段代码，所以我假设您打算做这样的事情：

```
void f(T *&) {} 
```

此函数签名允许传递的指针变为可修改的，这是替代语法所不允许的`int *`。正如其他人在这里所说的那样，指针*通过引用有效地传递。*

使用这种语法，您现在可以修改实际指针，而不仅仅是它指向的*指针*。例如：

```
void f(int *& ptr) {
    ptr = new int;
}

int main() {
    int * x;
    f(ptr); // we are changing the pointer here

    delete x;
} 
```

摘要（假设类型在参数中）：

1.  `T *`: 我们只能改变指针指向的对象的值。更改参数不会更改传递的指针。
2.  `T *&`: 我们现在可以改变实际的指针`T`，以及它所指向的对象的值`*T`。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-20T21:12:16.337

尽管它看起来就像地址操作符，但它不是——它是一个引用参数。当您希望能够在调用者端更改值时，您可以使用引用。在这种情况下，指针可能正在函数内设置或更改。

# c# - 异步 HTTP 请求在通用列表中引发 IndexOutOfRange 异常

> ID：13980485
> 
> 赞同：1
> 
> 时间：2012-12-20T21:09:07.660
> 
> 标签：c#, multithreading, generic-list, outofrangeexception

我正在开发一个 Windows 服务，该服务在一系列数据库中循环，然后使用 HTTP 请求发送 SMS 消息。在遍历每个数据库的方法的开头，我定义了一个通用列表，如下所示：

```
public static List<Recipient> Recipients = new List<Recipient>(); 
```

我使用通过线程池发送的异步 HTTP 请求的结果填充该列表：

```
//inside main method                    
foreach (var SMS in SMSJoin)
{
    ...

    SMSMessage oSMS = new SMSMessage(Keyword, Number, Message, MessageID);

    ThreadPool.QueueUserWorkItem(SendSMS, oSMS);
} 
```

然后它被传递给下一个方法：

```
public static void SendSMS(object SMStoSend)
{
    try
    {
        SMSMessage oSMS = (SMSMessage)SMStoSend;
        ...
        Request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), state);
    }
    ...
} 
```

然后去`GetRequestStreamCallback`...

```
public static void GetRequestStreamCallback(IAsyncResult AsynchronousResult)
{
    State state = (State)AsynchronousResult.AsyncState;
    SMSMessage oSMS = state.oSMS;
    try
    {
        ...
        Request.BeginGetResponse(new AsyncCallback(ReceiveResponse), state);
    }
    ...
} 
```

最后收到响应并将其添加到收件人列表中：

```
public static void ReceiveResponse(IAsyncResult Result)
{
    ...
    finally
    {
        oSMS.Complete = DateTime.Now;

        Recipient CompleteMessage = new Recipient(oSMS.MessageID, oSMS.Recipient, oSMS.ErrorCode, oSMS.Complete, oSMS.ResponseCode);
        Recipients.Add(CompleteMessage);
    } 
```

在代码的最后，每个响应都应该被添加到一个`Recipient`对象中，然后存储在通用列表中。问题是大约每 1000 条左右的 SMS 消息（分批发送 50 条）一次`IndexOutOfRangeException`，代码行会抛出一个未处理的消息`Recipients.Add(CompleteMessage)`。

没想到列表里有索引，很多收件人都是重复的。为什么它会抛出这个错误，为什么每隔一段时间才会抛出一次？这可能与线程问题有关吗？

请注意，我正在从一个`Timer`对象激活 main 方法，但它会等到前一个实例完成后再启动一个新实例。

**编辑：** 这是`Recipient`课程：

```
public class Recipient
{
    public Recipient(long MessageID, string PhoneNumber, string ErrorMessage, DateTime? Completed, string Response)
    {
        this.MessageID = MessageID;
        this.PhoneNumber = PhoneNumber;
        this.ErrorMessage = ErrorMessage;
        this.Completed = Completed;
        this.Response = Response;
    }

    public long MessageID { get; set; }
    public string PhoneNumber { get; set; }
    public string ErrorMessage { get; set; }
    public DateTime? Completed { get; set; }
    public string Response { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:44:35.973

我的猜测是您遇到了多个线程，试图同时添加到 Recipients 并且一个在前一个完成之前开始。

尝试在读写期间锁定您的收件人，看看是否有帮助：

```
private static object mylock = new object();
private static List<Recipient> _recipients = new List<Recipient>();
public static List<Recipient> Recipients
{
    get
    {
        List<Recipient> result;
        lock (mylock)
        {
            result = _recipients;
        }
        return result;
    }
    set
    {
        lock (mylock)
        {
            _recipients = value;
        }
    }
} 
```

# debugging - 如何让 windbg 保存我的会话状态？

> ID：13980493
> 
> 赞同：7
> 
> 时间：2012-12-20T21:09:39.623
> 
> 标签：debugging, windbg

我刚刚在平台堆栈中的“较低级别”开始了一项新任务，并且开始使用windbg。到目前为止，我对调试器的纯粹功能感到非常满意。但是，我希望它只保存我的会话默认值，就像 VS 调试器一样。我想要的是，每当我“.restart”或重新打开windbg时，它就像我离开它一样工作：相同的bp，相同的sxe状态，相同的文件在相同的地方打开，等等。

我知道“保存工作区”似乎可以做我想做的事，但它是手动的，每次更改工作区状态时我都必须这样做。

有没有办法让 windbg 自动执行此操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T21:14:33.700

它应该在您第一次关闭会话时提示您是否要保存工作区，这里有一个类似于图像的复选框。

![在此处输入图像描述](../Images/69b7105dc8028c2703a35355df387fe2.png)

如果这次单击“是”和“*在此 WinDbg 会话中不再询问*”框，那么它将自动保存您的工作区，同样，如果它错误地保存了一些您不再感兴趣的断点或路径，您也可以清除工作区。

您也可以在选项中设置它，如下所示：

![在此处输入图像描述](../Images/d23ac7d305fee6241ab0eb236589ce73.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T05:38:15.840

微软 NTDebugging 博客。[揭示工作区在 WinDbg 中的工作方式。](http://blogs.msdn.com/b/ntdebugging/archive/2010/05/07/uncovering-how-workspaces-work-in-windbg.aspx)

# python - python循环优化 - 迭代dirs 3级并删除

> ID：13980498
> 
> 赞同：1
> 
> 时间：2012-12-20T21:09:58.577
> 
> 标签：python

嗨，我有以下程序，

问题： - 如何使它更优雅、更易读、更紧凑。- 我该怎么做才能将常见循环提取到另一种方法。

假设：

从给定的 rootDir 目录按如下方式组织。

proc的作用：

如果输入为 200，它将删除所有 OLDER 超过 200 天的 DIRS。不是基于修改时间，而是基于目录结构和目录名称[我稍后将在每个较旧的目录上通过暴力“rm -Rf”删除]

例如目录结构：

```
-2009(year dirs) [will force delete dirs e.g "rm -Rf" later]
-2010
  -01...(month dirs)
  -05 ..
      -01.. (day dirs)
         -many files. [I won't check mtime at file level - takes more time]
      -31
  -12
-2011
-2012 ... 
```

我拥有的代码：

```
def get_dirs_to_remove(dir_path, olderThanDays):
    today = datetime.datetime.now();
    oldestDayToKeep = today + datetime.timedelta(days= -olderThanDays) 
    oldKeepYear = int(oldestDayToKeep.year)
    oldKeepMonth =int(oldestDayToKeep.month);
    oldKeepDay = int(oldestDayToKeep.day);
    for yearDir in os.listdir(dirRoot):
        #iterate year dir
        yrPath = os.path.join(dirRoot, yearDir);
        if(is_int(yearDir) == False):
            problemList.append(yrPath); # can't convery year to an int, store and report later 
            continue

        if(int(yearDir) < oldKeepYear):
                print "old Yr dir: " + yrPath
                #deleteList.append(yrPath); # to be bruteforce deleted e.g "rm -Rf"
                yield yrPath;
                continue
        elif(int(yearDir) == oldKeepYear):
            # iterate month dir
            print "process Yr dir: " + yrPath
            for monthDir in os.listdir(yrPath):
                monthPath = os.path.join(yrPath, monthDir)
                if(is_int(monthDir) == False):
                    problemList.append(monthPath);
                    continue
                if(int(monthDir) < oldKeepMonth):
                        print "old month dir: " + monthPath
                        #deleteList.append(monthPath);
                        yield monthPath;
                        continue
                elif (int(monthDir) == oldKeepMonth):
                    # iterate Day dir
                    print "process Month dir: " + monthPath
                    for dayDir in os.listdir(monthPath):
                        dayPath = os.path.join(monthPath, dayDir)
                        if(is_int(dayDir) == False):
                            problemList.append(dayPath);
                            continue
                        if(int(dayDir) < oldKeepDay):
                            print "old day dir: " + dayPath
                            #deleteList.append(dayPath);
                            yield dayPath
                            continue
print [ x for x in get_dirs_to_remove(dirRoot, olderThanDays)]
print "probList" %  problemList # how can I get this list also from the same proc? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:33:48.487

这实际上看起来很不错，除了这条评论中提到的一件大事：

```
print "probList" %  problemList # how can I get this list also from the same proc? 
```

听起来您正在存储`problemList`在全局变量或其他东西中，并且您想修复它。这里有一些方法可以做到这一点：

*   产生删除文件和问题文件——例如，产生一个`tuple`第一个成员说它是哪种类型，第二个成员如何处理它的地方。
*   以`problemList`为参数。请记住`list`s 是可变的，因此调用者可以看到附加到参数。
*   `yield`最后的`problemList`—— 这意味着您需要重新构建使用生成器的方式，因为它不再只是一个简单的迭代器。
*   将生成器编码为类而不是函数，并存储`problemList`为成员变量。
*   查看内部生成器信息并将其塞入`problemList`其中，以便调用者可以检索它。

同时，有几种方法可以使代码更加紧凑和可读。

最简单的：

```
print [ x for x in get_dirs_to_remove(dirRoot, olderThanDays)] 
```

此列表推导与原始迭代完全相同，您可以更简单地编写为：

```
print list(get_dirs_to_remove(dirRoot, olderThanDays)) 
```

至于算法本身，您可以对 进行分区`listdir`，然后只使用分区`list`的 s。你可以懒惰地做：

```
yearDirs = os.listdir(dirRoot):
problemList.extend(yearDir for yearDir in yearDirs if not is_int(yearDir))
yield from (yearDir for yearDir in yearDirs if int(yearDir) < oldKeepYear)
for year in (yearDir for yearDir in yearDirs if int(yearDir) == oldKeepYear):
    # next level down 
```

或者严格来说：

```
yearDirs = os.listdir(dirRoot)
problems, older, eq, newer = partitionDirs(yearDirs, oldKeepYear)
problemList.extend(problems)
yield from older
for year in eq:
    # next level down 
```

后者可能更有意义，特别是考虑到这`yearDirs`已经是一个列表，而且不太可能那么大。

当然你需要编写那个`partitionDirs`函数——但好的是，你可以在几个月和几天的级别再次使用它。这很简单。事实上，我实际上可能通过排序来进行分区，因为它使逻辑如此明显，即使它更冗长：

```
def partitionDirs(dirs, keyvalue):
    problems = [dir for dir in dirs if not is_int(dir)]
    values = sorted(dir for dir in dirs if is_int(dir), key=int)
    older, eq, newer = partitionSortedListAt(values, keyvalue, key=int) 
```

如果您环顾四周（也许搜索“python 分区排序列表”？），您可以找到很多实现该`partitionSortedListAt`功能的方法，但这里有一个我认为对于没有想到问题的人来说很容易理解的东西的草图这边走：

```
 i = bisect.bisect_right(vals, keyvalue)
    if vals[i] == keyvalue:
        return problems, vals[:i], [vals[i]], vals[i+1:]
    else:
        return problems, vals[:i], [], vals[i:] 
```

如果您搜索“python split predicate”，您还可以找到其他方法来实现初始拆分——尽管请记住，大多数人要么关心能够分区任意迭代（您在这里不需要），要么，正确与否，担心效率（您在这里也不关心）。所以，不要寻找有人说是“最好”的答案；查看所有答案，然后选择对您来说最易读的答案。

最后，您可能会注意到您最终得到了三个看起来几乎相同的级别：

```
yearDirs = os.listdir(dirRoot)
problems, older, eq, newer = partitionDirs(yearDirs, oldKeepYear)
problemList.extend(problems)
yield from older
for year in eq:
    monthDirs = os.listdir(os.path.join(dirRoot, str(year)))
    problems, older, eq, newer = partitionDirs(monthDirs, oldKeepMonth)
    problemList.extend(problems)
    yield from older
    for month in eq:
        dayDirs = os.listdir(os.path.join(dirRoot, str(year), str(month)))
        problems, older, eq, newer = partitionDirs(dayDirs, oldKeepDay)
        problemList.extend(problems)
        yield from older
        yield from eq 
```

您可以通过递归进一步简化这一点——传递到目前为止的路径，以及要检查的进一步级别列表，您可以将这 18 行变成 9 行。这是否更具可读性取决于您对信息进行编码的程度传下来并适当`yield from`。这是这个想法的草图：

```
def doLevel(pathSoFar, dateComponentsLeft):
    if not dateComponentsLeft:
        return
    dirs = os.listdir(pathSoFar)
    problems, older, eq, newer = partitionDirs(dirs, dateComponentsLeft[0])
    problemList.extend(problems)
    yield from older
    if eq:
        yield from doLevel(os.path.join(pathSoFar, eq[0]), dateComponentsLeft[1:]))
yield from doLevel(rootPath, [oldKeepYear, oldKeepMonth, oldKeepDay]) 
```

如果您使用的是没有 的较旧 Python 版本，那么`yield from`转换较早的东西几乎是微不足道的；编写的递归版本会更丑陋，更痛苦。但是在处理递归生成器时确实没有办法避免这种情况，因为子生成器不能“通过”调用生成器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T07:57:35.723

我建议不要使用生成器，除非你绝对确定你需要它们。在这种情况下，您不需要它们。

在下面，`newer_list`不是严格需要的。虽然`categorizeSubdirs`可以递归，但我认为复杂性的增加不值得节省重复（但这只是个人风格问题；我只在不清楚需要多少级递归或数量固定时才使用递归，但大；三个是不够的 IMO）。

```
 def categorizeSubdirs(keep_int, base_path):
    older_list = []
    equal_list = []
    newer_list = []
    problem_list = []

    for subdir_str in os.listdir(base_path):
        subdir_path = os.path.join(base_path, subdir_str))
        try:
            subdir_int = int(subdir_path)
        except ValueError:
            problem_list.append(subdir_path)
        else:
            if subdir_int  keep_int:
                newer_list.append(subdir_path)
            else:
                equal_list.append(subdir_path)

    # Note that for your case, you don't need newer_list, 
    # and it's not clear if you need problem_list
    return older_list, equal_list, newer_list, problem_list

def get_dirs_to_remove(dir_path, olderThanDays):
    oldest_dt = datetime.datetime.now() datetime.timedelta(days= -olderThanDays) 
    remove_list = []
    problem_list = []

    olderYear_list, equalYear_list, newerYear_list, problemYear_list = categorizeSubdirs(oldest_dt.year, dir_path))
    remove_list.extend(olderYear_list)
    problem_list.extend(problemYear_list)

    for equalYear_path in equalYear_list:
        olderMonth_list, equalMonth_list, newerMonth_list, problemMonth_list = categorizeSubdirs(oldest_dt.month, equalYear_path))
        remove_list.extend(olderMonth_list)
        problem_list.extend(problemMonth_list)

        for equalMonth_path in equalMonth_list:
            olderDay_list, equalDay_list, newerDay_list, problemDay_list = categorizeSubdirs(oldest_dt.day, equalMonth_path))
            remove_list.extend(olderDay_list)
            problem_list.extend(problemDay_list)

    return remove_list, problem_list 
```

最后的三个嵌套循环可以以代码复杂性为代价减少重复性。我不认为这是值得的，尽管理性的人可能会不同意。在其他条件相同的情况下，我更喜欢更简单的代码而不是更聪明的代码；正如他们所说，阅读代码比编写代码更难，所以如果你编写了最聪明的代码，你就不会聪明到去阅读它。：/

# ajax - 如何使用来自 ajax 加载函数的数据？

> ID：13980499
> 
> 赞同：1
> 
> 时间：2012-12-20T21:10:25.777
> 
> 标签：ajax, jquery

假设我在下面有以下代码。根据他们从下拉列表中选择的值，它会显示与该值关联的复选框。这部分工作得很好，除了当我提交表单时，`process.php`没有加载来自 ajax 调用 () 的数据。我没有在视图源中看到它，因此我无法将它们包含在其中`<form></form>`

**javascript**

```
$(document).ready(function() {
    $('#dropdown').change( function() {
        $('#output').load('/process.php',{dropdown: $(this).val()});
    });
}); 
```

**html**

```
<form method="post" id="myform">
<select id="dropdown" name="dropdown">
    <option value="QU">QU</option>
    <option value="QF">QF</option>
    <option value="QC">QC</option>
</select>

<div id="output"></div>
<button type="submit">Continue</button>
</form> 
```

顺便说一句，我也尝试了以下方法。

```
$(document).ready(function() {
    $('#dropdown').live("change", function() {
        $('#output').load('/process.php',{dropdown: $(this).val()});
    });
}); 
```

***process.php 的片段***

结果显示得很好，除了我不能在表单提交中使用复选框值。

```
foreach($new as $r) {
    $svn_tag = rtrim($r['current_tag'], '/');
    echo "<tr>";
    echo "<td><label class='checkbox'><input name='tag[{$r['name']}]' type='checkbox' value='{$r['name']}'  /></label></td>";        
    echo "<td class='primary'>". ucfirst($r['name']) . "</td>";
    echo "<td class='primary'><input type='text' name='revision[{$r['name']}]' value='{$svn_tag}'></td>";
    echo "<td><input type='hidden' name='docroot[{$r['name']}]' value='{$r['docroot']}'></td>";
    echo "</tr>";
} 
```

让我们让这更容易。我改为`process.php`只显示以下内容。请记住，它显示得很好，只是在表单提交期间不包含它。

```
<input type="checkbox" name="tag" value="test"> 
```

我选中该框，点击继续按钮，但它失败了。意思是， 的值`tag`不会传递给下一个方法。基本上，如果您查看源代码，则`output`div 中不会显示任何内容。

# parsing - 将括号解析为原子 ANTLR

> ID：13980501
> 
> 赞同：1
> 
> 时间：2012-12-20T21:10:27.407
> 
> 标签：parsing, antlr, grammar, expression

我正在尝试匹配平衡的括号，这样，`PARAMS`如果进行匹配，就会创建一棵树，否则 LPARAM 和 RPARAM 令牌只是作为原子添加到树中......

```
tokens
{
    LIST;    
    PARAMS;
}

start   : list -> ^(LIST list);

list    : (expr|atom)+;

expr : LPARAM list? RPARAM -> ^(PARAMS list?);

atom :  INT | LPARAM | RPARAM;

INT :   '0'..'9'+;
LPARAM  :   '(';
RPARAM  :   ')'; 
```

目前，它永远不会创建`PARAMS`树，因为在规则 expr 中，它总是将结尾`RPARAM`视为原子，而不是该规则的结束标记。

所以目前，类似的东西`1 2 3 (4) 5`被添加到`LIST`树中作为标记的平面列表，而不是所需的分组。

我之前处理过将标记作为原子添加到树中，但他们从来没有能够启动另一个规则，就像`LPARAM`这里一样。

我需要某种语法/语义谓词吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T23:14:44.027

这是一个带有几个约束的简单方法。我认为这些符合您在评论中提到的预期行为。

*   不匹配的`LPARAM`永远不会出现在子列表中
*   不匹配的`RPARAM`永远不会出现在子列表中

语法：

```
start   : root+ EOF -> ^(LIST root+ );

root    : expr
        | LPARAM
        | RPARAM
        ;

expr    : list
        | atom
        ;           

list    : LPARAM expr+ RPARAM -> ^(LIST expr+)
        ;

atom    : INT
        ; 
```

规则`root`匹配不匹配`LPARAM`的 s 和`RPARAM`s。规则`list`，`atom`只关心自己。

该解决方案相对脆弱，因为 rule`root`需要在和`expr`之前列出。即便如此，也许这足以解决您的问题。`LPARAM``RPARAM`

### 测试用例 1：没有列表

输入：`1 2 3`

输出：

![1 2 3](../Images/ed978f1e7f410a466f6c691a6452dfee.png)

### 测试用例 2：一个列表

输入：`1 (2) 3`

输出：

![1 (2) 3](../Images/14fd19cf1e82bcf11695a164840cb3ef.png)

### 测试用例 3：两个列表

输入：`(1) 2 (3)`

输出：

![(1) 2 (3)](../Images/7df1c92b517d9f6038ecd45293b4fdbb.png)

### 测试用例 4：没有列表，左不匹配

输入：`((1 2 3`

输出：

![((1 2 3](../Images/ec12a8df9d1443a9d4e1e248cdfda4ff.png)

### 测试用例 5：两个列表，左不匹配

输入：`((1 (2) (3)`

输出：

![（（1（2）（3）](../Images/52c9aa02f3a09afd24eefd1e1d4a1890.png)

### 测试用例 6：没有列表，权限不匹配

输入：`1 2 3))`

输出：

![1 2 3))](../Images/2c22606d3b8ef62877b184af371cd47d.png)

### 测试用例 7：两个列表，权限不匹配

输入：`(1) (2) 3))`

输出：

![(1) (2) 3))](../Images/620a605c16fcaab78577c4a363d5f34d.png)

### 测试用例 8：两个列表，混合不匹配的左侧

输入：`((1 (2) ( (3)`

输出： ![(((1 (2)) ( (3)](../Images/7fe7c383355de32d31a0a8b8cdf67308.png)

### 测试用例 9：两个列表，混合错配权限

输入：`(1) ) (2) 3))`

输出：

![(1) ) (2) 3))](../Images/68fa66b096f03d731e32bdab4e626805.png)

* * *

这是一个稍微复杂一点的语法，它作用于`[]`和`()`对。我认为当你添加对时，解决方案会变得更糟，但是，嘿，这很有趣！您可能还遇到了语法驱动的 AST 构建所能做的限制。

```
start   : root+ EOF -> ^(LIST root+ )
        ;

root    : expr
        | LPARAM
        | RPARAM
        | LSQB
        | RSQB
        ;       
expr    : plist
        | slist
        | atom
        ;           

plist   : LPARAM pexpr* RPARAM -> ^(LIST pexpr*)
        ;

pexpr   : slist
        | atom
        | LSQB
        | RSQB
        ;       

slist   : LSQB sexpr* RSQB -> ^(LIST sexpr*)
        ;

sexpr   : plist
        | atom
        | LPARAM
        | RPARAM
        ;               

atom    : INT;

INT     : ('0'..'9')+;
LPARAM  : '(';
RPARAM  : ')';
LSQB    : '[';
RSQB    : ']'; 
```

# java - “点击计数器”Android 应用程序的重置按钮

> ID：13980502
> 
> 赞同：0
> 
> 时间：2012-12-20T21:10:31.713
> 
> 标签：java, android

我正在创建一个小的“点击计数器”应用程序，它基本上有一个按钮功能，当按下它时，一个 textview 字段会显示点击次数。我正在尝试设置一个“重置”按钮，它将 textview 的值更改回 0。这是我到目前为止的代码：

```
wreset = (Button)findViewById(R.id.wreset);       
wreset.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View arg0) {
        // TODO Auto-generated method stub
        txtCount.setText(String.valueOf(0));
    } 
```

这会将 textview 值更改为 0，但是当再次单击按钮时，它会从单击重置按钮时的计数开始返回。
例如：
一。当前计数 = 10
b。选择复位按钮
c. 当前计数 = 0
d。按下点击器按钮
e. 当前计数 = 11

我是否使用了错误的陈述或意图？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:13:13.763

您没有重置您正在使用的任何计数器：

```
@Override
public void onClick(View arg0) {
   yourCounter = 0;
   txtCount.setText("0");

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:13:28.177

您需要将计数器状态保存在实例字段或静态字段中。然后在重置时将该字段设置为零。例如：

```
private int counter = 0;

// ...

wreset = (Button) findViewById(R.id.wreset);
wreset.setOnClickListener(new OnClickListener()
{
    @Override
    public void onClick(View arg0)
    {
        counter = 0;
        txtCount.setText(String.valueOf(counter));
    }
}

increment = (Button) findViewById(R.id.increment);
increment.setOnClickListener(new OnClickListener()
{
    @Override
    public void onClick(View arg0)
    {
        counter++;
        txtCount.setText(String.valueOf(counter));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-24T16:50:56.207

```
public void onClick(View view) {
    int count = 0;
    count++;//increment the count
    TextView text = (TextView) findViewById(R.id.counttxt);// resorce location
    text.setText("No.of Clicks " + count);// view in the text 
```

# ruby-on-rails - 将 AJAX 添加到不应该存在的链接页面上显示的 will_paginate 内容

> ID：13980506
> 
> 赞同：0
> 
> 时间：2012-12-20T21:10:55.693
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, jquery

[我使用这个 wiki https://github.com/ronalchn/ajax_pagination/wiki/Installing](https://github.com/ronalchn/ajax_pagination/wiki/Installing)添加了 ajax_pagination

它可以工作，但是当我单击新闻部分中的链接时，顶部的滑块会显示在显示页面上，但它不应该存在，但是当您刷新页面时，它会消失并恢复正常

有谁知道如何解决这一问题？

这是我的看法

batnews.html.erb

```
<div class="container">
  <br /><br />
  <h2 class="black">
    Featured Articles
   <div class="line_section"><div>
  </h2>
  <ul class="example2">
  <% @articles.each do |article| %>
    <li>
      <h2><%= link_to(article.title, article, style: 'color: #4C4C4C;') %></h2>

      <%= link_to image_tag(article.photo, style: 'width: 400px; float: left; margin-right: 20px; margin-top: -10px; height: 260px;'), article %>

          <div class="info" style="position: relative; right: -20px; top: -3px;">
            <img style="position: relative; top: -2px;" src="/assets/icon_calendar.png">
            <%= article.date %>
            <img style="position: relative; top: -2px;" src="/assets/icon_author.png">
             <%= article.author %>
            <img style="position: relative; top: -2px;" src="/assets/icon_talk.png">
            <!-- TODO make this link scroll down to comments section smoothly -->
             <%= link_to article.comments.count, article %> <%= link_to 'comments', article %></a>
          </div>
      <p style="width: 460px; float: right;"><%= truncate article.content, length: 400 %>
        <br />
        <%= link_to('Read More', article, style: 'font-size: 12px;') %></p>
     </li>
      <% end %>
   </ul>
  </div>

   <%= ajax_section :id => "recent_news", :render => "recent_news" %> 
```

这是我正在渲染的部分内容 _recent_news.html.erb

```
 <div class="container">
   <br />
    <br />
    <h2 class="black">
      Recent News
       <div class="line_section"><div>
      </h2>
     <%= ajax_links :section_id => "recent_news" do %>
   <%= will_paginate @news_all %>
    <div class="row"> 
   <div class="span12">

    <ul class="recent-news"> 

    <% @news_all.each do |news| %>

    <li style="font-size: 16px; line-height: 19px; letter-spacing: 1px; font-size: 14px; color: #555; text-align: left;">
    <%= link_to image_tag(news.photo.url), news, class: 'pull-left', style: 'margin-right:40px; margin-top: 2px; width: 300px;' %> 
     <div style=" width: 600px; float: right;">
    <%= link_to news.title, news %> 

  <br />

   <%= link_to news.date, news, style: 'font-size: 10px; color: black; position: relative; top: 15px;' %> 

    <i style="position: relative; top: 18px;" class="icon-comment"><%= link_to   (news.comments.count), news, :style => 'font-size: 8px; color: white; font-weight: bold;    position: absolute; top: 0px; right: 5px;' %></i>
    <br /><br />
    <%= truncate news.content, length: 500 %> 
   <br />  
    <%= link_to 'Read More...', news, style: 'font-size: 12px !important;' %>
     </div>
   </li>
  <% end %> 
  <%= will_paginate @news_all %>
  <% end %>
  </div><!-- end span12 -->

 </div><!-- end row -->
   </div><!-- end container --> 
```

这是我的控制器

static_pages_controller.rb

```
def batnews
  @articles = Article.all
  @news_all = News.all
  @news_all = News.paginate(page: params[:page], per_page: 4, :order => 'created_at DESC')
  @comment_count = Comment.count(:id)
  respond_to do |format|
  format.html # index.html.erb
  ajax_respond format, :section_id => "recent_news"
  end
end 
```

这是我的宝石

```
gem 'rails', '3.2.8'
gem 'bootstrap-sass', '2.0.4'
gem 'bcrypt-ruby', '3.0.1'
gem 'faker', '1.0.1'
gem 'will_paginate', '3.0.3'
gem 'bootstrap-will_paginate', '0.0.6'
gem 'jquery-rails', '2.0.2'
gem 'jquery-ui-rails'
gem "haml", "~> 3.1.7"
gem 'twitter-bootstrap-rails', :git => 'git://github.com/seyhunak/twitter-bootstrap-rails.git'
gem 'activerecord-reputation-system', require: 'reputation_system'
gem "paperclip", :git => "git://github.com/thoughtbot/paperclip.git"
gem 'aws-sdk'
gem 'friendly_id'
gem 'ajax_pagination'
gem "jquery-historyjs" 
```

这是指向该网站的链接，您可以在其中看到我正在谈论的行为[http://www.batman-fansite.com/batnews](http://www.batman-fansite.com/batnews)

因此，如果您单击recent_news 中的一条新闻，您将被带到显示页面向上滚动，您会注意到滑块仍然存在......点击刷新，滑块将消失......

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:44:27.603

实际上对此有一个简单的解释，您的 ajax 只是替换`<div id="recent_news" class="ajax_section">`标签中的 HTML。由于您的轮播不是`recent_news`其内容的子项，因此不会被新请求的 HTML 替换。一个简单的解决方案是将您的 ajax 选择包装在您想要替换的任何内容周围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:46:07.627

这并不能直接回答您的问题，但可以解决您的问题：我尝试了很多不同的 ajax will_paginate 解决方案，但没有一个符合我的要求。然后我继续使用普通的 will_paginate gem 并编写了一个自定义链接渲染器，将它们创建为基于 ajax 的。完整的[解决方案发布在这里](https://stackoverflow.com/questions/13787431/ajax-call-in-rails-3-2-3-with-will-paginate-gem/13975268#13975268)。

# c# - 组合框/ SelectedIndexChanged 与 SQL

> ID：13980507
> 
> 赞同：-2
> 
> 时间：2012-12-20T21:11:05.473
> 
> 标签：c#, sql, visual-studio, combobox

我有 3 个不同的 SQL 代码。我将我的 3 个文本（男性、女性、两者）放在组合框集合中。我不知道如何在组合框中按示例选择 Men 时，应用良好的 SQL 代码。

男士：

```
SELECT EmployeeID, FirstName, LastName, MaritalStatus, Gender 
FROM Employes, Contacts 
WHERE Employes.ContactId = Contacts.ContactID 
  AND Gender = 'M' 
ORDER BY LastName, FirstName 
```

女士：

```
SELECT EmployeeID, FirstName, LastName, MaritalStatus, Gender 
FROM Employes, Contacts 
WHERE Employes.ContactId = Contacts.ContactID 
  AND Gender = 'F' 
ORDER BY LastName, FirstName 
```

两个都：

```
SELECT EmployeeID, FirstName, LastName, MaritalStatus, Gender 
FROM Employes, Contacts 
WHERE Employes.ContactId = Contacts.ContactID 
ORDER BY LastName, FirstName 
```

看（是法语）（Choisir le sexe = 选择性别）（Afficher = 以英语显示）

![在此处输入图像描述](../Images/915ff0a0d73cae20d5e20655e1768b4c.png)

多谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:20:37.783

假设你用三个字符串填充你的组合框，`Hommes, Femmes, Tous`那么当你收到事件时，`SelectedIndexChanged`你可以写这样的东西

```
private void comboBox1_SelectedIndexChanged(object sender, System.EventArgs e)
{
   // Get the currently selected item in the ListBox.
   string curItem = comboBox1.SelectedItem.ToString();
   string sqlText = "SELECT EmployeeID, FirstName, LastName, MaritalStatus, Gender " + 
                    "FROM Employes JOIN Contacts ON Employes.ContactId = Contacts.ContactID "
   switch(curItem)
   {
      case "Femmes":
          sqlText += "AND Gender = 'F' ORDER BY LastName, FirstName";
          break;
      case "Hommes":
          sqlText += "AND Gender = 'M' ORDER BY LastName, FirstName";
          break;
      default:
          sqlText += "ORDER BY LastName, FirstName";
   }
   DataTable dt = GetEmployeeList(sqlText);
   ...... // Now fill the datasource of your grid
} 
```

编辑：嗯，只需阅读@marc_s 评论

# image-processing - 图像处理：我想过滤包含特定文本和数字的相册的图片。任何提示/工具？(Ubuntu/Windows/Mac)

> ID：13980511
> 
> 赞同：1
> 
> 时间：2012-12-20T21:11:08.863
> 
> 标签：image-processing, ocr

我收集了大量图片，但需要过滤带有特定文本的图片。从五个最佳文本识别工具中尝试了一些 OCR 工具，但对我的事业没有帮助。任何工具/提示将不胜感激。

感谢您的关注：）

# ios - 目标 C：对二维数组进行排序

> ID：13980513
> 
> 赞同：1
> 
> 时间：2012-12-20T21:11:18.223
> 
> 标签：ios, sorting, nsdate

我有一个数组数组。包含数组的第一个元素都是 NSDate 对象。我想按从最近到最少的顺序对包含数组的数组进行排序。出于某种原因，以下排序算法会导致无限循环。谁能帮我吗？谢谢你。

最好的...SL

```
//array is the array containing all of the other arrays(that have NSDates as their first elements)
//temp is the new array being added to the end of the array, to later be sorted into the correct position.

[array addObject:temp];    
NSMutableArray *tempArray;

for (int i=0; i<[array count]; i++) 
{
    NSDate *session1, *session2;
    session1 = [[array objectAtIndex:i] objectAtIndex:0];
    session2 = [[array objectAtIndex:[array count]-1] objectAtIndex:0];

    if([session1 compare:session2] == NSOrderedDescending)
{
        tempArray = [array objectAtIndex:i];
        [array insertObject:[array objectAtIndex:[array count]-1] atIndex:i];
        [array insertObject:tempArray atIndex:[array count]-1];
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T21:19:14.720

这会导致无限循环，因为在每一步中，您都将另外两个值插入到数组中。因此，您的数组的增长速度比您遍历它的速度快。我假设您打算交换值。

在任何情况下，更简单和更有效的排序是使用内置的排序功能：

```
// NSArray *sortedArray, with the unsorted 'array' pulled from some other instance
sortedArray = [array sortedArrayUsingComparator:^(id a, id b) {
    return [[b objectAtIndex:0] compare:[a objectAtIndex:0]];
}]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T21:20:13.263

如果`array`是可变的并且您想对其进行排序：

```
[array sortUsingComparator:^(id a, id b) {
    return [b[0] compare:a[0]];
}]; 
```

如果`array`是不可变的，或者您想不理会它并制作一个排序副本：

```
NSArray *sortedArray = [array sortedArrayUsingComparator:^(id a, id b) {
    return [b[0] compare:a[0]];
}]; 
```

# matplotlib - 从 pandas 数据框中打印时间序列图的问题

> ID：13980516
> 
> 赞同：-1
> 
> 时间：2012-12-20T21:11:31.857
> 
> 标签：matplotlib, pandas

我有一个以日期时间为索引的 DataFrame 对象：

```
In [210]:
f
f.plot(legend=True)

Out[210]:
                         user_time  sys_time  wait_io_time
date_time                                             
2012-11-01 08:59:27          3         1             0
2012-11-01 08:59:32          0         0             0
2012-11-01 08:59:37         20         2             1
2012-11-01 08:59:42          0         0             0
2012-11-01 08:59:47          0         0             0 
```

f.plot() 导致此错误：

```
-> 1367     plot_obj.generate()
--> 674         self._make_plot()
-> 1000             self._make_ts_plot(data, **self.kwds)
---> 81     left, right = _get_xlim(ax.get_lines())
--> 220         left = min(x[0].ordinal, left)
AttributeError: 'numpy.int64' object has no attribute 'ordinal' 
```

我确实看到一个线图，显示来自 user_time 数据的值，因此怀疑来自 sys_time 的数据值可能导致问题。根据[https://github.com/pydata/pandas/issues/1737](https://github.com/pydata/pandas/issues/1737)的建议，我安装了更新版本的 matplotlib（1.1.1）但没有运气，并且在错误 url 的数据上绘图也失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:47:35.943

这似乎适用于安装的最新 matplotlib 库。我升级后忘记重新启动 ipython 笔记本进程或重新加载 matplotlib。

# tfs - Team Foundation Service Mandatory Comments on check in

> ID：13980521
> 
> 赞同：15
> 
> 时间：2012-12-20T21:11:59.043
> 
> 标签：tfs, azure-devops

我正在使用 Microsoft 的新 Team Foundation Service，[http ://tfs.visualstudio.com/](http://tfs.visualstudio.com/)

我想知道是否可以在签入时强制进行注释，例如，如果我签入没有注释的更改，则会引发错误并且我的提交被拒绝。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-20T22:09:13.330

在 Visual Studio (2012) 中。

*   打开“团队资源管理器”。
*   选择您的“团队项目”。
*   点击“设置”。
*   在“团队项目”标题下，单击“源代码管理”。
*   选择“签入策略”选项卡。
*   点击“添加...”
*   选择“变更集评论策略”。

![变更集评论政策](../Images/e4636b4c1b1bd10217051791da1e13e4.png)

在 Visual Studio 2010 中，您必须在所有客户端计算机上安装[Team Foundation Power Toys](http://aka.ms/tfpt) - 未安装它的那些将无法签入代码。

# php - 将内容拆分到布局的最佳方法是什么？

> ID：13980523
> 
> 赞同：1
> 
> 时间：2012-12-20T21:12:14.357
> 
> 标签：php

最近，我编写了一个小型且功能齐全的 CMS，没有 OOP 逻辑，并且采用了著名的不良做法来包含页眉、内容和页脚：

```
<?php
     require_once("header.php");

     //Content

     require_once("footer.php");
?> 
```

现在，我正在尝试建立一个基于**模板引擎**的新 CMS 。我读了很多关于*Smarty & CO*的文章。但我认为这并不完全清楚，因为您需要学习这种特定的语言。那么我该怎么做呢？我一直在寻找这个，但似乎找不到任何符合要求的东西....

**提前感谢**！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:21:43.637

让所有内容都通过重写进入单个路由文件，然后像这样拉取正确的文件：

```
ob_start();
include('page_you_need_to_load.php');
$html = ob_get_contents();
ob_end_clean();

include('header.php');
echo $html;
include('footer.php'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:24:57.843

您需要做的是将生成内容*数据*的代码位和*显示*数据的代码位分开。在 MVC 领域，数据部分将由模型/控制器处理，并由视图显示。解释您的代码：

```
<?php
require('data.php');
require('header.php');
require('display.php');
require('footer.php'); 
```

这在逻辑上简化为：

```
<?php
require('data.php');
require('display.php'); 
```

您`data.php`只会将数据生成特定变量，`display.php`然后将其转化为可显示的内容。最好在输出任何内容之前完成所有与内容相关的工作，以防您想返回并更改 HTML 标头中的某些内容 [即：页面标题] 或执行 HTTP 重定向或其他`header()`操作。

研究 MVC 风格的编码是一个好主意，我发现以下两页对于理解和创建 MVC 应用程序非常有用。

[http://www.onextrapixel.com/2012/03/14/a-detailed-overview-of-the-model-view-controller-mvc-coding-structure/](http://www.onextrapixel.com/2012/03/14/a-detailed-overview-of-the-model-view-controller-mvc-coding-structure/)

[http://www.phpro.org/tutorials/Model-View-Controller-MVC.html](http://www.phpro.org/tutorials/Model-View-Controller-MVC.html)

# sql - 无法加入备注、OLE 或超链接对象 - Access 2007 - 外部联接

> ID：13980535
> 
> 赞同：2
> 
> 时间：2012-12-20T21:12:49.523
> 
> 标签：sql, database, join, outer-join

我在 Access 2007 中有 2 个这样的表...

```
 Table 1 - tbEmployees Details
           FieldName      Data Type
      PK   *ID            Autonumber 
           EmployeeID     Number
           First          Text
           ....           ...

 Table 2 - tbEmployeesQualification
           FieldName    Data Type
     PK   *ID           Autonumber  
           CV (attachment)  Attachment  
           Qualification / Certificate (memo box)
           Skills (memo box) 
```

我正处于关系的设计阶段。我正在尝试使用上表中的外部联接，因为我想为每个员工附加简历。我尝试了以下方法。将 ID 从 tbEmployees Details 拖到 tbEmployeesQualification 上。然后出现加入属性屏幕...

```
 Left Table  -            Right Table -
   tbEmployees Details      tbEmployeesQualification 
   Left Column -            Right Column 
   ID                       Qualification / Certificate 
```

我选择了选项 2 - 包括来自 .... 的所有记录，其中连接字段相等。

为了测试这一点，我使用了 Query。当我使用查询向导时，似乎查询显示的结果包括来自 tbEmployees Details 的所有数据和所有数据 tbEmployeesQualification 但

当我使用查询设计时，我收到以下错误...

```
Cannot join on Memo, OLE, or Hyperlink Object ([tbEmployees Details].ID=[     
tbEmployeesQualification].[Qualification/Certificate]) 
```

错误是正确的。我知道 ID 具有 Autonumber 作为数据类型和来自 tbEmployeesQualification 的资格/证书作为备忘录数据类型，因此不能使用内部联接。所以我的问题是如何解决这个问题？或者可以通过使用外部连接来解决，还是我需要做一些我没见过的事情？

提前感谢您抽出时间回答我的问题。

编辑 - 我认为外键可能是答案。我刚刚在 tbEmployeesQualification 中添加了数据类型为 Number 的 ID。创建一对多关系，一个是 tbEmployees Details，许多是 tbEmployeesQualification。我会尽快更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T12:58:19.367

通过使用一对多关系解决了这个问题。在 tbEmployees 表中，我将名字放在字段名称 (PK) 中，数据类型为文本。在 tbEmployeesQualification 表中，我再次使用数据类型 Text 创建了 Field Name FirstName。我将 tbEmployees 表（一个）链接到 tbEmployeesQualification 表（很多）。这解决了问题。

# vb.net - 检查字符串变量是否具有整数值

> ID：13980538
> 
> 赞同：20
> 
> 时间：2012-12-20T21:13:09.177
> 
> 标签：vb.net, string, visual-studio-2010, parsing, integer

我正在做一个允许孩子们向圣诞老人发送信息的项目。不幸的是，如果他们在 AGE 字段中输入字符串而不是整数，程序会崩溃并返回从字符串“[exampleString]”到类型“Double”的转换无效。有没有办法检查他们是否输入了整数？这是代码。

```
If childAge > 0 And childAge < 150 Then
    fmSecA2 = "Wow! You are already " & childAge & " years old? You're growing to be a big " & childGender & " now! "
Else
    fmSecA2 = "Erm, I couldn't really understand your age. Are you making this up? Ho ho ho!"
End If 
```

谢谢，凯:)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-12-20T21:18:38.880

一个非常简单的技巧是[尝试将字符串解析](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)为整数。如果成功，它是一个整数（惊喜惊喜）。

```
Dim childAgeAsInt As Integer
If Integer.TryParse(childAge, childAgeAsInt) Then
    ' childAge successfully parsed as Integer
Else
    ' childAge is not an Integer
End If 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-10-30T14:09:50.000

补充 Styxxy 的响应，如果您不需要结果，只需将其替换为 vbNull：

```
If Integer.TryParse(childAge, vbNull) Then 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-21T06:07:02.463

您可以执行以下两个测试来合理地确定您得到的输入是一个整数：

```
If IsNumeric(childAge) AndAlso (InStr(1, childAge, ".") <> 0) Then
    fmSecA2 = "Wow! You are already " & childAge & " years old? You're growing to be a big " & childGender & " now! "
    If childAge < 0 OrElse childAge > 150 Then
        fmSecA2 = "I don't believe it's possible to be" & childAge & " years old..."
    End If
Else
    fmSecA2 = "Erm, I couldn't really understand your age. Are you making this up? Ho ho ho!" 
```

如果[InStr](http://msdn.microsoft.com/en-us/library/8460tsh1%28v=vs.90%29.aspx "InStr")函数没有找到正在查找的字符串，则返回零，因此当将该测试与 IsNumeric 组合时，您还排除了输入某些浮点数据类型的可能性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-20T21:18:51.933

IsNumeric 内置在 VB 中，将返回真/假

```
If IsNumeric(childAge) AndAlso (childAge > 0 And childAge < 150) Then
    fmSecA2 = "Wow! You are already " & childAge & " years old? You're growing to be a big " & childGender & " now! "
Else
    fmSecA2 = "Erm, I couldn't really understand your age. Are you making this up? Ho ho ho!"
End If 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-20T21:16:11.253

你可以使用这个。

```
Sub checkInt() 
    If IsNumeric(Range("A1")) And Not IsEmpty(Range("A1")) Then 

        If Round(Range("A1"), 0) / 1 = Range("A1") Then 
            MsgBox "Integer: " & Range("A1") 
        Else 
            MsgBox "Not Integer: " & Range("A1") 
        End If 
    Else 
        MsgBox "Not numeric or empty" 
    End If 
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-10T10:36:26.207

根据 Styxxy 的回答，如果您将其解析为字节而不是整数，那么它还会一次性检查负年龄和 255 岁的最大年龄。

```
Dim childAgeAsByte As Byte
If Byte.TryParse(childAge, childAgeAsByte) Then
    ' childAge successfully parsed as Byte
Else
    ' childAge is not a Byte
End If 
```

克里斯蒂安

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-14T10:53:59.137

```
Dim Input 

 Input = TextBox1.Text
 If Input > 0 Then 
   ............................
   ............................
 Else 
   TextBox2.Text = "Please only enter positive integers"
 End If 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-08T08:58:03.017

```
Try
    If TextBox1.Text > 0 Then
        Label1.Text = "Integer"
    End If
Catch ex As Exception
    Label1.Text = "String"
End Try 
```

有了这个你可以放任何东西`TextBox1`，如果你放文本，那么你得到`Label1`的是字符串，如果你放数字，那么你得到的是整数

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-12-20T21:18:30.377

在 .Net 中，您可以使用`GetType()`来确定变量的数据类型。

```
Dim n1 As Integer = 12
Dim n2 As Integer = 82
Dim n3 As Long = 12

Console.WriteLine("n1 and n2 are the same type: {0}",
                  Object.ReferenceEquals(n1.GetType(), n2.GetType()))
Console.WriteLine("n1 and n3 are the same type: {0}",
                  Object.ReferenceEquals(n1.GetType(), n3.GetType()))
' The example displays the following output: 
'       n1 and n2 are the same type: True 
'       n1 and n3 are the same type: False 
```

基于上面的示例，您可以编写代码片段：

```
If childAge.GetType() = "Integer" then '-- also use childAge.GetType().Name = "Int32"
  ' do something
End if 
```

*   [参考 MSDN](http://msdn.microsoft.com/en-us/library/system.object.gettype.aspx)

# php - SQL 和 WordPress：使用 SQL 提取两个自定义字段

> ID：13980539
> 
> 赞同：3
> 
> 时间：2012-12-20T21:13:10.590
> 
> 标签：php, sql, wordpress

WordPress`wp_postmeta`表构造为键/值对：

```
ID | meta_key | meta_value 
```

我需要在结果集中获取两个 meta_keys 的值：

`property_lat`和`property_long`

然后我将使用这些值来评估给定点的半径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T23:36:14.340

一个结果集中的两个值：

```
SELECT * 
FROM wp_postmeta 
WHERE meta_key IN ('property_lat', 'property_long') 
```

一行中的两个值：

```
SELECT (SELECT meta_value FROM wp_postmeta WHERE meta_key='property_lat' LIMIT 1) AS lat, 
       (SELECT meta_value FROM wp_postmeta WHERE meta_key='property_long' LIMIT 1) AS lng 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T11:39:30.667

Preterm 的解决方案永远无法一次获得所有纬度/经度对。它一次只能为您提供一个 ID 的一对。我在 SQL 方面不够专业，无法保证这会立即起作用，但我认为您正在寻找这样的东西：

```
SELECT tbl.ID, lat.meta_value, lng.meta_value
FROM wp_postmeta AS tbl
INNER JOIN wp_postmeta AS lat ON lat.ID = tbl.ID AND lat.meta_key='property_lat'
INNER JOIN wp_postmeta AS lng ON lng.ID = tbl.ID AND lng.meta_key='property_long'
WHERE meta_key IN ('property_lat', 'property_long')
GROUP BY tbl.ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T19:53:06.943

在您的帮助下，我能够构建我的查询：

```
SET @centerLat = '48.428289';
SET @centerLng = '-123.380585';

SELECT wp_posts.*,
( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat.meta_value ) ) * cos( radians( lng.meta_value ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat.meta_value ) ) ) ) AS distance

FROM wp_posts

LEFT JOIN wp_postmeta AS lat 
    ON lat.post_id = wp_posts.ID 
        AND lat.meta_key = 'property_lat'

LEFT JOIN wp_postmeta AS lng 
    ON lng.post_id = wp_posts.ID 
        AND lng.meta_key = 'property_long'

WHERE lat.meta_key IS NOT NULL

HAVING distance > 5

LIMIT 0 , 20 
```

谢谢！

# vbscript - 使用 VBScript 确定我的时区偏移量？

> ID：13980541
> 
> 赞同：5
> 
> 时间：2012-12-20T21:13:12.743
> 
> 标签：vbscript, timezone, wmi, utc, timezone-offset

如何使用**VBScript确定我的****时区偏移量**？

 **Windows 操作系统提供`TZ`环境变量。对于东部标准时间（纽约），其值为`EST5EDT`。但是，我正在寻找与 UTC 的有符号整数偏移量。（东部标准时间为**-5**。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T21:14:04.397

这是一个修改后的函数，似乎考虑了夏令时。*（受[这个 SO question](https://stackoverflow.com/q/1797758/1497596)的启发。）*

```
Function GetTimeZoneOffset()
    Const sComputer = "."

    Dim oWmiService : Set oWmiService = _
        GetObject("winmgmts:{impersonationLevel=impersonate}!\\" _
                  & sComputer & "\root\cimv2")

    Set cItems = oWmiService.ExecQuery("SELECT * FROM Win32_ComputerSystem")

    For Each oItem In cItems
        GetTimeZoneOffset = oItem.CurrentTimeZone / 60
        Exit For
    Next
End Function 
```

* * *

***[不考虑夏令时的原始功能。]***

这是我对我的问题的回答（[原始来源](http://social.technet.microsoft.com/Forums/en-US/ITCG/thread/daf4b666-fcb6-46ad-becc-689e6daf49ed/)）。

对于东部标准时间（纽约），此 VBScript 函数将返回**-5**：

```
Function GetTimeZoneOffset()
    Const sComputer = "."

    Dim oWmiService : Set oWmiService = _
        GetObject("winmgmts:{impersonationLevel=impersonate}!\\" _
                  & sComputer & "\root\cimv2")

    Dim cTimeZone : Set cTimeZone = _
        oWmiService.ExecQuery("Select * from Win32_TimeZone")

    Dim oTimeZone
    For Each oTimeZone in cTimeZone
        GetTimeZoneOffset = oTimeZone.Bias / 60
        Exit For
    Next
End Function 
```**

# c# - 阻止某些文件类型从 USB 复制到本地计算机

> ID：13980542
> 
> 赞同：0
> 
> 时间：2012-12-20T21:13:14.520
> 
> 标签：c#, .net, security, usb

标题听起来有点混乱，所以让我澄清一下。

我希望能够阻止（例如 .exe 文件）被导入到插入 USB 驱动器的机器上。

有没有办法停止来自 USB 驱动器的文件扩展名列表？

我在拍什么...

我的应用程序将运行，每当有人插入 USB 驱动器并将 .exe 文件拖到桌面时，我希望我的应用程序检查其扩展类型并删除文件或阻止它进入计算机。

这甚至可能吗？如果是这样，怎么做？也许这可以用不同的语言做得更好？

主要是，我想阻止 .exe、.msi、.zip 和其他一些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:29:39.023

您应该能够使用 FileSystemWatcher，因为您只查看桌面和子文件夹。

# sql - 通过存储过程更新日期

> ID：13980543
> 
> 赞同：0
> 
> 时间：2012-12-20T21:13:18.640
> 
> 标签：sql, datediff, procedures

我有个问题！

我的任务是计算我图书馆数据库中书籍的年龄。之后将一些书籍称为太稀有，一些稀有，并且通常使用价值列。

我的图书馆表（ ... ，年龄 - 日期，价值 - 日期）

注意：“年龄” - 列的定义不正确，最好说“出版年份”。其实我的任务是找年龄！

所以，我这样做了，我的值列没有改变:(

```
create procedure foo 
as
  declare @bookdate date,
          @currentdate date,
          @diff int

  set @currentdate = GETDATE()

  select @bookdate =  age from books

  select @diff = DATEDIFF (yyyy , @bookdate , @currentdate ) 
```

版本 #1：

```
 UPDATE books SET value = DATEADD(year,@diff, age) 
```

版本 #2：

```
 UPDATE books SET value = @diff 
```

PS抱歉我犯的任何错误，这是我在sql中的第一步，完全编程，并用英语寻求帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:34:52.613

对我来说，听起来你想要这样的东西（我假设你正在使用 SQL Server，因为你已经使用了 GETDATE() 函数）：

```
CREATE PROCEDURE foo

AS
BEGIN

    SELECT   *
            ,DATEDIFF(yyyy,age,GETDATE()) AS YearsSincePublication
            ,CASE   WHEN DATEDIFF(yyyy,age,GETDATE()) > 200 THEN 'Too rare'
                    WHEN DATEDIFF(yyyy,age,GETDATE()) > 100 THEN 'Rare'
                    ELSE 'Usual'
             END AS Value
    FROM    books

END 
```

从顶部开始工作：
* 表示所有表中
的所有列 datediff 计算自发布以来的年数，AS 位命名结果列（给它一个别名）。

CASE 语句是一种测试语句的方法（如果 a 等于 b，则执行 c）。第一条语句检查这本书是否超过 200 年，如果是，则写“太稀有”，第二行检查超过 100 年，否则写“通常”。同样，AS 用于将列标记为 Value。

最后指定了我们想要从中获取数据的表，Books。

创建存储过程后运行它很简单：

```
EXEC foo 
```

# java - javax.persistence.EntityManager.getCriteriaBuilder()Ljavax/persistence/criteria/CriteriaBuilder

> ID：13980546
> 
> 赞同：3
> 
> 时间：2012-12-20T21:13:27.880
> 
> 标签：java, spring, hibernate

我正在使用 Hibernate 4、Spring 3 和 JSF 2.0 以及 Weblogic 10.3.6 我在 DAO 类中有以下内容

```
 CriteriaBuilder cb = entityManager.getCriteriaBuilder();
        CriteriaQuery<Request> c = cb.createQuery(Request.class); 
```

当我运行我的应用程序时，出现以下异常。

```
javax.persistence.EntityManager.getCriteriaBuilder()Ljavax/persistence/criteria
/CriteriaBuilder;

java.lang.NoSuchMethodError: 
javax.persistence.EntityManager.getCriteriaBuilder()Ljavax/persistence/criteria
    /CriteriaBuilder;
    at net.test.request.dao.RequestDAOImpl.getRequest(RequestDAOImpl.java:51) 
```

我没有使用 JPA1 jar，但是我仍然收到此异常。无法弄清楚如何摆脱这个异常。任何帮助都是非常可观的。

谢谢

pom.xml

```
<repositories>
        <repository>
            <id>prime-repo</id>
            <name>PrimeFaces Maven Repository</name>
            <url>http://repository.primefaces.org</url>
            <layout>default</layout>
        </repository>
    </repositories>
    <properties>
        <spring.version>3.1.1.RELEASE</spring.version>
    </properties>
    <dependencies>
        <!-- Spring 3 dependencies -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <!-- JSF library -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.6</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.6</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <!-- Primefaces library -->
        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.4.2</version>
        </dependency>
        <dependency>
            <groupId>org.primefaces.themes</groupId>
            <artifactId>flick</artifactId>
            <version>1.0.8</version>
        </dependency>
        <!-- Hibernate library -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.1.0.Final</version>
        </dependency>
        <dependency>
            <groupId>javassist</groupId>
            <artifactId>javassist</artifactId>
            <version>3.12.1.GA</version>
        </dependency>
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <!-- Oracle Java Connector library -->
        <dependency>
            <groupId>com.oracle</groupId>
            <artifactId>ojdbc6</artifactId>
            <version>11.2.0.3</version>
        </dependency>
        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>
        <!-- Log4j library -->
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.16</version>
        </dependency>
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>6.4</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-jpamodelgen</artifactId>
            <version>1.2.0.Final</version>
        </dependency>
    </dependencies>
    <build>
        <resources>
            <resource>
                <directory>src/main/resources</directory>
            </resource>
        </resources>

        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArgument>-proc:none</compilerArgument>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.bsc.maven</groupId>
                <artifactId>maven-processor-plugin</artifactId>
                <executions>
                    <execution>
                        <id>process</id>
                        <goals>
                            <goal>process</goal>
                        </goals>
                        <phase>generate-sources</phase>
                        <configuration>
                            <!-- source output directory -->
                            <outputDirectory>target/metamodel</outputDirectory>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:48:12.373

该方法`EntityManager.getCriteriaBuilder`是 JPA 2 的一部分（它是 Java EE 6 的一部分），在 WebLogic 10 中默认不提供和/或打开该方法。

这是一个链接[http://docs.oracle.com/cd/E17904_01/web.1111/e13720/using_toplink.htm](http://docs.oracle.com/cd/E17904_01/web.1111/e13720/using_toplink.htm)，它提供了可以解决您的问题的说明。如果没有，您需要开始搜索“weblogic 10 jpa 2”，看看是否能找到适合您的解决方案。

如果这些解决方案都不起作用，您最后的手段是重新设计您的应用程序以仅使用 JPA 1 方法。要使用 JPA 1，您必须限制自己使用此处定义的类和接口：http: [//docs.oracle.com/javaee/5/api/javax/persistence/package-summary.html](http://docs.oracle.com/javaee/5/api/javax/persistence/package-summary.html)

[更新]

或者 - 因为你无论如何都在使用 Hibernate，所以不要太依赖 JPA 类。改用休眠特定的类。Hibernate 从 3.x 开始就有标准。您可以创建 Hibernate 会话工厂，而不是 EntityManager。然后你可以这样做：

```
import org.hibernate.Criteria;
import org.hibernate.Session;
import org.hibernate.SessionFactory;

...

Session session = sessionFactory.openSession();
Criteria crit = session.createCriteria(Person.class); 
```

您的代码现在被锁定为使用 Hibernate 作为您的持久性提供程序。就我而言，我们总是使用 Hibernate，所以这不是一个真正的问题。这是一个你必须自己决定的问题。如果您的应用程序可以容忍被锁定到 Hibernate，那么这应该会为您提供所需的功能，同时仍在 WebLogic 上运行。

# jquery-ui - 使用打字稿制作 jquery ui 的最佳方法

> ID：13980549
> 
> 赞同：7
> 
> 时间：2012-12-20T21:13:32.670
> 
> 标签：jquery-ui, typescript, jquery-widgets

我正在用打字稿中输入的小[部件工厂制作一个 jquery 小部件。](http://api.jqueryui.com/jQuery.widget/)如何在无需编写 .d.ts 的情况下提供良好的智能感知？

前任：

```
/*mywidget.ts*/

$.widget("ui.mywidget", {
    options: {
        myoption: ""
    },
    doSomething: function () {
        this._hasDoSomething = true;
        /*do doSomething*/
    },
    hasDoSomething: function (): bool {
        return <bool>this._hasDoSomething;
    }
});

/*mywidget.d.ts*/
interface MyWidgetOptions {
    myoption: string;
}

interface MyWidget extends Widget, MyWidgetOptions {}

interface NLIB { 
    mywidget: MyWidget;
}

interface JQuery {
    mywidget(): JQuery;
    mywidget(methodName: string): JQuery;
    mywidget(options: MyWidgetOptions): JQuery;
    mywidget(optionLiteral: string, optionName: string): any;
    mywidget(optionLiteral: string, options: MyWidgetOptions): any;
    mywidget(optionLiteral: string, optionName: string, optionValue: any): JQuery;
}

interface JQueryStatic {
    nlib: NLIB;
}

/// <reference path="teste.d.ts" />
$(".teste").mywidget({
    myoption: "asdadds"
}); 
```

为每个插件编写 .d.ts 太无聊了。有什么选择吗？

注意：如果我不包含 mywidget.d.ts，则此代码将无法编译，并且我将没有智能感知：

```
///<reference path="path/to/jqueryui-1.9.d.ts"/>
$(".teste").mywidget({ 
    myoption: "asdadds"
}); 
```

/* 编译器输出: ... 'JQuery' 类型的值上不存在属性 'mywidget' */

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-21T07:32:51.063

GitHub 上的[DefinitiveTyped](https://github.com/borisyankov/DefinitelyTyped)项目为大多数流行的 JavaScript 库提供了定义文件。

您需要做的就是下载您需要的文件并在您的代码中引用它，例如：

```
///<reference path="path/to/jqueryui-1.9.d.ts"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T09:16:58.040

如果您不想要 .d.ts 文件，只需在界面前使用 declare 关键字。例如，请参阅我在[https://stackoverflow.com/a/16967239/1859442上的回答](https://stackoverflow.com/a/16967239/1859442)

# php - MySQL查询如何从包含多个字符串值的列中获取所有不同值的列表？

> ID：13980551
> 
> 赞同：1
> 
> 时间：2012-12-20T21:13:37.150
> 
> 标签：php, mysql, database

我正在尝试从表中的列中获取不同值的列表。每列可以包含**多个逗号分隔的值**。我只想消除重复值并提出一个唯一值列表。

我知道如何使用 PHP 通过抓取整个表然后循环行并将唯一值放入唯一数组来执行此操作。

但是可以用 MySQL 查询来做同样的事情吗？

我的桌子看起来像这样：

```
| ID |                  VALUES                    |
---------------------------------------------------
| 1  |    Acadian,Dart,Monarch                    |
| 2  |    Cadillac,Dart,Lincoln,Uplander          |
| 3  |    Acadian,Freestar,Saturn                 |
| 4  |    Cadillac,Uplander                       |
| 5  |    Dart                                    |
| 6  |    Dart,Cadillac,Freestar,Lincoln,Uplander | 
```

所以我的唯一值列表将包含：

*   阿卡迪亚
*   卡迪拉克
*   镖
*   自由之星
*   林肯
*   君主
*   土星
*   高地人

这可以通过单独的 MySQL 调用来完成，还是需要一些 PHP 排序？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T11:43:42.693

为什么要将这样的数据存储在数据库中？首先，您故意取消了您想要使用数据库的所有广泛查询功能。相反，有一个这样的表：

```
| valueID | groupID |   name     |
----------------------------------
|    1    |    1    |  Acadian   |
|    2    |    1    |  Dart      |
|    3    |    1    |  Monarch   |
|    4    |    2    |  Cadillac  |
|    2    |    2    |  Dart      | 
```

请注意与 Matthew 的建议相比的不同`valueID`之处。`Dart`那就是具有相同的值具有相同的 valueID（您可能希望稍后再参考这些，并且您不想再犯同样的错误，即不再提前考虑，是吗？）。然后让主键同时包含 valueID 和 groupID。

然后，要回答您的实际问题，您可以通过此查询检索所有不同的值：

`SELECT name FROM mytable GROUP BY valueID`

（`GROUP BY`在这里应该比 a 表现更好，`DISTINCT`因为它不应该进行表扫描）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:31:11.530

我建议选择（并拆分）到一个临时表中，然后对此进行调用。

[首先，MySQL http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/](http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/)中显然没有拆分功能（这已经三年了，所以如果这已经改变，有人可以评论吗？）

将所有内容推入临时表并从中选择。

如果可以将它们分解成具有这种结构的表，那就更好了：

```
| ID |                  VALUES                    |AttachedRecordID |
---------------------------------------------------------------------
| 1  |    Acadian                                 |        1        |
| 2  |    Dart                                    |        1        |
| 3  |    Monarch                                 |        1        |
| 4  |    Cadillac                                |        2        |
| 5  |    Dart                                    |        2        | 
```

等等

# generics - Oracle JDK 和 Eclipse JDT 编译器不同意！哪个编译不正确？不寻常的泛型和推理

> ID：13980552
> 
> 赞同：4
> 
> 时间：2012-12-20T21:13:56.083
> 
> 标签：generics, java, eclipse-jdt, compiler-bug

我有一段代码在 Oracle JDK 7 和 Eclipse JDT 7 之间编译不一致，但由于我不确定哪个编译器犯了错误，我想在提交任何错误报告之前我应该​​在这里征求意见。

这是我能想出的最简单的测试来证明不一致：

```
interface Foo<S extends Foo<S, T>, T> {
    // should this compile?
    public <X extends Foo<S, Y>, Y> Y method1();

    // what about this?
    public <X extends Foo<? extends S, Y>, Y> Y method2();
} 
```

Oracle JDK 在方法 1 上给出错误，但在方法 2 上没有，而 Eclipse 对这两种方法都没有问题。我什至不确定这*两种*方法都应该编译...

如果这两种方法都不应该从一开始就编译，那么以下几点就没有实际意义，但我觉得如果我们添加以下代码，两个编译器都会出错：

```
interface Bar extends Foo<Bar, Integer> {
}

class Bug {
    void bug() {
        Bar bar = null;
        Double bubble;

        // these fail as expected...
        bar.<Foo<Bar, Double>, Double> method1();
        bar.<Foo<? extends Bar, Double>, Double> method2();

        // ...but these don't even though the inferred parametrisations should be
        // the same as above
        Double bobble = bar.method1();
        Double babble = bar.method2();
    }
} 
```

当我们为方法 1 和方法 2 提供显式参数时，我找不到任何会导致有效调用返回 Double 的参数（即，当使用 Double 参数化 Y 时，我找不到 X 的有效参数）。这是我所期望的行为，据我所知，这里的 Y 应该只能使用 Integer 进行参数化。

但是，当我们让编译器*推断*参数化时，Oracle JDK 和 Eclipse JDT 都允许将 Y 推断为 Double 的调用。如果您将鼠标悬停在 Eclipse 中的调用上，它甚至会显示参数化与我们手动失败的参数设置完全相同，那么为什么会有不同的行为呢？

（此时分配给新变量 bobble 和 babble 的原因是悬停文本显示不同的参数 - 出于某种原因将 Double 替换为 Object - 如果我们再次分配给 bubble。它仍然编译调用并分配给 Doubles ，所以我不知道这是为什么。）

所以，这可能是我提出的另一个相当模糊的问题，但这里的任何人都可以为我解释一下吗？

**编辑：**

Eclipse 的错误报告：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=398011](https://bugs.eclipse.org/bugs/show_bug.cgi?id=398011)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T00:35:30.880

编译器似乎做了某种简化。`Foo.method1`and`Foo.method2`用两个参数声明，`X`and `Y`，其中一个可以在推断期间确定，但`X`根本不使用。

所以当你调用的时候`Double bobble = bar.method1()` `X`应该计算为`extends Foo<Bar, Double>`，但是编译器决定去掉这个参数，因为它没有被使用。

当您明确指定方法参数时，编译器必须检查它们的正确性并按预期失败。

如果您更改这些方法中的任何一个以接受类型参数，`X`那么您将不会遇到这种模棱两可的情况，因为您将为编译器提供一些信息，这些信息将用于确定实际`X`的 .

当 Eclipse 的编译器完全没有显示错误时，Eclipse 有几个这样的错误，但`javac`开始抱怨不正确的方法调用。避免此类错误的最佳方法是使用显式参数，在这种情况下，大多数编译器的行为几乎相同。因此，如果您对显式参数有疑问，最好重新设计您的类。

# java - 初学者 Android 应用程序崩溃

> ID：13980553
> 
> 赞同：0
> 
> 时间：2012-12-20T21:13:58.680
> 
> 标签：java, android

我正在做一本初学者的 android 入门书，代码看起来很简单。但是，它无法运行。当我尝试运行它时，eclipse 崩溃了。

这是我的java代码：

```
package com.example.gamebeginner;

import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.widget.Button;
public class MainActivity extends Activity implements View.OnClickListener {
    Button button;
    int touchCount;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        button = new Button(this);
        button.setText("Touch me!");
        button.setOnClickListener(this);
        setContentView(button);
    }

    public void onClick(View v){
        touchCount++;
        button.setText("Touched me " + touchCount + " times(s)");
    }
} 
```

* * *

活动.main xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

</RelativeLayout> 
```

* * *

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.gamebeginner"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="14" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme"
        android:debuggable="true" >
        <activity
            android:name="com.example.gamebeginner.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我在jdk 1.6版上。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:56:29.710

**确保您的设备已连接并正常工作。**

1.  转到窗口 -> 显示视图 -> android -> 设备单击确定，以便打开设备列表。确保您在窗口中看到您的设备。
2.  确保单击设备以突出显示该设备。现在去点击你的 logcat 选项卡。如果您没有打开 logcat 选项卡，请转到窗口 -> 显示视图 -> 其他 -> android -> logcat。确保不要选择已弃用的版本。

还可以尝试杀死并重新启动 adb 守护程序。

`adb kill-server`然后`adb start-server`在命令提示符下。如果您`adb`的路径上没有，则需要引用完整路径`adb`或在包含`adb`.

**断开并重新连接设备解决了该问题。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:25:30.077

如果您的错误消息（在 logcat 中，对吗？）是`java se binary is not responding`，我敢说您以某种错误的方式生成代码。您是使用 Eclipse 还是 IntelliJ 来构建您的应用程序？您使用的项目类型是什么 - Java 应用程序或 Android 应用程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:15:43.123

首先添加 setContentView 和 afer View

# mysql - MYSQL/PHP 处理图像文件（适用于 txt 文件，但不适用于 PNG/JPEG 等）

> ID：13980555
> 
> 赞同：0
> 
> 时间：2012-12-20T21:14:07.500
> 
> 标签：mysql, sql, image

我只是想复制一些图像文件并将它们存储在一个文件夹中......我的代码似乎适用于 txt 文档但是当我想复制其他东西时它不起作用:(

```
 <?php

$ImageLocation = $_POST["ImageLocation"];

//$ImageLocation = '/xampp/htdocs/cw/mysql/images/test.txt';

$ext  = (new SplFileInfo($ImageLocation))->getExtension();

$newFile = "/xampp/htdocs/cw/mysql/images/$ProductName.$ext";

if (!copy($ImageLocation, $newFile)) {
    echo "failed to copy $file...\n";
}

?> 
```

如果有人可以提供帮助，那将非常方便，ta。

# regex - 检查正则表达式中的最小数量

> ID：13980566
> 
> 赞同：1
> 
> 时间：2012-12-20T21:14:35.713
> 
> 标签：regex

我有一个正则表达式，用于检查 0 到 999999 之间的值。

```
/^((?:\d{1,3},)?\d{1,3})(\.\d{2})$/ 
```

问题是 0.00 是有效的。我想将 0.01 设置为有效的最小金额。因此，输入 0.00 会使我无效。

我对正则表达式的黑魔法感到很害怕。任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:17:07.867

不要将逻辑放入正则表达式。它们用于匹配模式，而不是进行数值比较。

在 Perl 中，这将是：

```
if ( $s =~ /^((?:\d{1,3},)?\d{1,3})(\.\d{2})$/ && ( $s > 0 ) ) {
    # acceptable number
} 
```

如果您正确使用正则表达式，它们就不是一门黑魔法。试图用它们进行数值计算并没有正确使用它们。

# sqlite - 用于单点触控的 mvvmcross sqlite-net 插件

> ID：13980567
> 
> 赞同：3
> 
> 时间：2012-12-20T21:14:44.927
> 
> 标签：sqlite, xamarin.ios, mvvmcross, sqlite-net

我正在多平台企业应用程序中实现出色的 mvvmcross 库。monodroid sqlite 插件正在工作 - 我现在需要实现单点触控功能。如果有人为 ios/monotouch 平台开发了附带的 sqlite 插件并描述所涉及的复杂性和所采取的路径、绊脚石等，我很感兴趣。干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T08:04:12.020

这应该很直接...

1.  在 Mac 上使用 MonoDevelop，在文件夹 /MvvmCross/Cirrious/Plugins/Sqlite/ 中新建一个 MonoTouch 库项目 - Cirrious.MvvmCross.Plugins.Sqlite.Touch
2.  将调试和发布的构建路径设置为 ../../../../bin/Touch/debug 和 ../../../../bin/Touch/release
3.  添加对：Cirrious.MvvmCross（核心 PCL）、Cirrious.MvvmCross.Touch（核心 MonoTouch 方法）、Cirrious.MvvmCross.Plugins.Sqlite（核心 SQLite 函数）的引用
4.  添加“样板”插件文件——它只是在 DI 中注册连接工厂——见下文
5.  添加连接工厂类 - 见下文
6.  在 Droid 插件 - SQLiteNet.cs 中添加指向 sqlite-net 文件的**链接**
7.  建造
8.  当你在 MonoTouch UI 项目中使用这个插件时，你需要在你的 setup.cs 文件中注册插件实例——就像你做所有的 Touch 插件一样——这是因为我们不能在运行时使用 Assembly.Load()
9.  您可能还需要做一些特殊的事情才能在运行时使用插件 - 不确定 - 尚未在 MonoTouch 中使用 SQLite-net - Sqlite 示例应该有所帮助 - [https://github.com/praeclarum/sqlite-net/tree/大师/示例/StocksTouch](https://github.com/praeclarum/sqlite-net/tree/master/examples/StocksTouch)

我对此的尝试是： [https ://github.com/slodge/MvvmCross/tree/vnext/Cirrious/Plugins/Sqlite/Cirrious.MvvmCross.Plugins.Sqlite.Touch](https://github.com/slodge/MvvmCross/tree/vnext/Cirrious/Plugins/Sqlite/Cirrious.MvvmCross.Plugins.Sqlite.Touch)

但我没有测试过这个。

如果它有效，我很想阅读它……如果它不起作用，我会看到修复它的动力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T07:56:26.303

你看过这篇博文吗？[http://slodge.blogspot.nl/2012/10/a-sqlite-example-vnext-portable.html](http://slodge.blogspot.nl/2012/10/a-sqlite-example-vnext-portable.html)

> “请注意，到目前为止，我只完成了这个插件的 Droid 实现，但我认为其余的所有 - WP7、MonoTouch 和 WinRT（及更高版本）都应该是直截了当的 - 并且相同的 SQLiteNet.cs 文件（ #if's and all) 将在这些插件之间链接共享。”

您是否尝试过为 monotouch 项目使用相同的 SQLite 插件？

# javascript - 如何安全地触发两个打开的处理程序 jQuery

> ID：13980568
> 
> 赞同：1
> 
> 时间：2012-12-20T21:14:51.043
> 
> 标签：javascript, android, jquery, iphone, dialog

我的一些页面工作，其中一些没有。那些不起作用的是具有自定义事件处理程序的那些。所有页面都有以下 jQuery 代码。

```
 var speed = 750;
    $(document).on("dialogopen", ".dialogClass", function() {
            var parent = $(this).parent();
            $(this).dialog("option", "width", $(window).width());
            $(this).dialog("option", "height", $(window).height());
            $(this).dialog("option", "position", [0,0]);
            $(this).dialog("option", "draggable", "false");
            parent.css("position","fixed");
            parent.css("top","0px");
            parent.css('left','-' + $(window).width() + 'px');
            parent.animate({
                    left: 0
            }, speed, "easeOutBounce");

    });

    $(document).on("dialogclose", ".dialogClass", function() {
            if($('#dialog').is(':data(dialog)')){
                    $(this).dialog("destroy");
                    $(this).swipe("destroy");
                    $(this).swipe({
                            swipeLeft:function(event, direction, distance, duration, fingerCount) {

                                    if(distance >= 200){
                                            var dia = $(this);
                                            $(this).parent().animate({
                                                    left : -$(window).width()
                                            },speed, "easeInExpo", function(e) {
                                                    dia.dialog("close");
                                            });
                                    }

                            }
                    });
            }

    }); 
```

一些对话框具有自定义的打开\关闭处理程序，例如（theDialog 属于类 dialogClass）：

```
 $("#theDialog").dialog({
           width: 700,
           height:675,
           title:'Add Event',
           resizable:false,
           modal:true,
           close: function(event,ui{
                  $("#theDialog").html('');
                  //Do other things
  }); 
```

拥有两个关闭处理程序的 jQuery 是否合适？这些在任何形状或形式上是否相互冲突？如果是这样，我怎样才能让自定义事件处理程序以及全局类一触发。

# c# - 如何在 C# 中初始化整数数组

> ID：13980570
> 
> 赞同：5
> 
> 时间：2012-12-20T21:15:12.830
> 
> 标签：c#, .net

> **可能重复：**
> [c# 更精简的初始化 int 数组的方法](https://stackoverflow.com/questions/13971730/c-sharp-leaner-way-of-initializing-int-array)

基本上我想知道是否有比下面显示的更有效的代码

```
 private static int[] GetDefaultSeriesArray(int size, int value)
    {
        int[] result = new int[size];
        for (int i = 0; i < size; i++)
        {
            result[i] = value;
        }
        return result;
    } 
```

其中大小可以从 10 到 150000 不等。对于小型阵列不是问题，但应该有更好的方法来完成上述操作。我正在使用 VS2010(.NET 4.0)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T21:18:02.353

C#/CLR 没有内置方法来用非默认值初始化数组。

如果您衡量每个项目的操作，您的代码将尽可能高效。

如果您并行初始化大块数组，您可以获得更快的初始化速度。由于多线程操作的成本很高，这种方法需要仔细调整。

通过分析您的需求并可能一起删除整个初始化，可以获得更好的结果。即，如果数组通常包含常量值，您可以实现某种 COW（写入时复制）方法，其中您的对象最初没有后备数组并且 simpy 返回常量值，在写入元素时它将创建（可能是部分）后备数组用于修改段。

更慢但更紧凑的代码（可能更容易阅读）将使用[`Enumerable.Repeat`](http://msdn.microsoft.com/en-us/library/bb348899.aspx). 请注意，这`ToArray`将导致为大型数组分配大量内存（这也可能最终导致 LOH 上的分配） - [Enumerable.Range 的内存消耗高？](https://stackoverflow.com/questions/10519275/high-memory-consumption-with-enumerable-range).

```
 var result = Enumerable.Repeat(value, size).ToArray(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T22:01:19.647

提高速度的一种方法是利用`Array.Copy`. 它能够在较低级别上工作，在该级别上批量分配更大的内存部分。

通过批处理分配，您最终可以将数组从一个部分复制到其自身。

最重要的是，批次本身可以非常有效地并行化。

这是我的初始代码。在我的机器（只有两个内核）上，样本数组大小为 1000 万个项目，我得到了 15% 左右的加速。您需要调整批量大小（尝试保持页面大小的倍数以保持效率）以将其调整为您拥有的项目的大小。对于较小的数组，它最终将与您的代码几乎相同，因为它不会超过填充第一批，但在这些情况下它也不会（明显）更糟。

```
private const int batchSize = 1048576;
private static int[] GetDefaultSeriesArray2(int size, int value)
{

    int[] result = new int[size];

    //fill the first batch normally
    int end = Math.Min(batchSize, size);
    for (int i = 0; i < end; i++)
    {
        result[i] = value;
    }

    int numBatches = size / batchSize;

    Parallel.For(1, numBatches, batch =>
    {
        Array.Copy(result, 0, result, batch * batchSize, batchSize);
    });

    //handle partial leftover batch
    for (int i = numBatches * batchSize; i < size; i++)
    {
        result[i] = value;
    }

    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T22:21:36.333

另一种提高性能的方法是使用一种非常基本的技术：循环展开。

我编写了一些代码来初始化一个包含 2000 万个项目的数组，重复执行 100 次并计算平均值。如果不展开循环，这大约需要 44 毫秒。循环展开为 10，该过程在 23 毫秒内完成。

```
 private void Looper()
        {
            int repeats = 100;
            float avg = 0;

            ArrayList times = new ArrayList();

            for (int i = 0; i < repeats; i++)
                times.Add(Time()); 

            Console.WriteLine(GetAverage(times)); //44

            times.Clear();

            for (int i = 0; i < repeats; i++)            
                times.Add(TimeUnrolled()); 

            Console.WriteLine(GetAverage(times)); //22

        }

 private float GetAverage(ArrayList times)
        {
            long total = 0;
            foreach (var item in times)
            {
                total += (long)item;
            }

            return total / times.Count;
        }

        private long Time()
        {
            Stopwatch sw = new Stopwatch();
            int size = 20000000;
            int[] result = new int[size];
            sw.Start();

            for (int i = 0; i < size; i++)
            {
                result[i] = 5;
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
            return sw.ElapsedMilliseconds;
        }

        private long TimeUnrolled()
        {
            Stopwatch sw = new Stopwatch();
            int size = 20000000;
            int[] result = new int[size];
            sw.Start();

            for (int i = 0; i < size; i += 10)
            {
                result[i] = 5;
                result[i + 1] = 5;
                result[i + 2] = 5;
                result[i + 3] = 5;
                result[i + 4] = 5;
                result[i + 5] = 5;
                result[i + 6] = 5;
                result[i + 7] = 5;
                result[i + 8] = 5;
                result[i + 9] = 5;
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
            return sw.ElapsedMilliseconds;
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:32:19.300

阅读 Enumerable.Repeat 比循环的 ops 标准慢 20 倍，我发现唯一可能提高其速度的是

```
private static int[] GetDefaultSeriesArray(int size, int value)
{
    int[] result = new int[size];
    for (int i = 0; i < size; ++i)
    {
        result[i] = value;
    }
    return result;
} 
```

注意 i++ 更改为 ++i。i++ 复制 i，增加 i，并返回原始值。++i 只返回递增的值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T21:18:07.537

```
Enumerable.Repeat(value, size).ToArray(); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-20T21:28:08.660

正如有人已经提到的，您可以像这样利用并行处理：

```
int[] result = new int[size];
Parallel.ForEach(result, x => x = value);
return result; 
```

抱歉，我没有时间对此进行性能测试（这台机器上没有安装 VS），但如果你能做到并分享结果，那就太好了。

*编辑*：根据评论，虽然我仍然认为它们在性能方面是等效的，但您可以尝试并行 for 循环：

```
Parallel.For(0, size, i => result[i] = value); 
```

# php - PHP $_POST 奇怪的行为，仅在第二次发布表单时有效

> ID：13980576
> 
> 赞同：0
> 
> 时间：2012-12-20T21:15:39.650
> 
> 标签：php, forms, post

我真的被一些非常恼人的事情困住了。在尝试了我所知道的一切几个小时后，我最终来到这里，看看是否有人可以提供帮助。这是一般的想法。

我希望通过表单发送的密码可以访问某个特定页面。没有用户，密码不会改变。这应该很容易吧！

我有一个提交的表单，方法设置为 post，操作设置为`$_SERVER['PHP_SELF']`. 计划是，当我预定义的密码变量与表单中输入的内容匹配时，一组内容会显示在页面上，而当它不匹配时，您会获得另一组内容（表单）。

这就是奇怪的地方。在查看 a 时，`print_r`我看到我在数组中的表单中提交的任何内容，但是当我将正确的密码放入数组填充时，然后很快清空。我在页面重新加载时看到了这一点。它完全清空自己。更奇怪的是，我第二次这样做，它有效。我在这里想念什么？我很想知道！

非常感谢，圣诞快乐。

----一些代码----

表格

```
 <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
            <label for="pass" id="pass">Password:</label>
        <input type="text" name="pass" id="pass" />
        <input type="submit" name="submit" value="Yes" />
    </form> 
```

文件顶部的一些 PHP；

```
$pass = '12846565488374';
if($_POST['pass']){ $login = $_POST['pass']; } else { $login = 'empty'; }
if($login != $pass) { $show = 0; } elseif($login == $pass){ $show = 1; } 
```

- - - 解决了 - - -

原来这是一个 JS 插件在我不知情的情况下重新加载页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:27:10.730

尝试：

```
if(isset($_POST['pass']) AND $_POST['pass'] == $pass) {
     $show = 1;
} else {
     $show = 0;
} 
```

从下面的评论中复制：

从服务器加载页面后，PHP 无法更新任何内容...您只能使用刷新或 JS/AJAX 来更改内容。如果您将整个页面上传到某个地方会容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:27:35.443

```
<?php
    if (isset($_POST['pass']))
    {

        if ($_POST['pass'] == $pass)
        {
            $show = 1; 
            echo $show;
        }
        else
        {
            $show = 0;
            echo $show;
        }
?>

<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
        <label for="pass" id="pass">Password:</label>
    <input type="text" name="pass" id="pass" />
    <input type="submit" name="submit" value="Yes" />
</form> 
```

也许是这样的？

**的目的`echo`是显示输入正确密码时，$show 变为 1，错误时变为 0**

*编辑：*

您的参数检查`$show`

```
<?php
    if (isset($show) AND $show === 1)
    {
        echo "The Variable Is Set To 1"; 
    }
    elseif (isset($show) AND $show === 0)
    {
        echo "The Variable Is Set To 0";
    }
?> 
```

这是经过测试并与您的代码一起使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:36:24.013

尝试：

```
 <?PHP
if(isset($_POST['pass'])
    {
    $pass = '12846565488374';
    ($_POST['pass'] == $pass)? $show = 1 : $show = 0;
    echo $show;
    }
    else
        {
?>
    <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
            <label for="pass" id="pass">Password:</label>
        <input type="text" name="pass" id="pass" />
        <input type="submit" name="submit" value="Yes" />
    </form>
<?PHP
        }
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:43:41.713

感谢大家的帮助 - 正如 Matanya 所说，这确实是重新加载页面的 Javascript 问题。它是一个音乐播放器，它被置于 IF 声明的“真实”部分。我不明白为什么会有这种效果，但至少我知道。我认为错误会出现在我的 PHP 中。这是有问题的播放器：SCM 音乐播放器[http://scmplayer.net](http://scmplayer.net)

再次感谢。

# java - 导入通配符是否一直导入所有内容？

> ID：13980580
> 
> 赞同：4
> 
> 时间：2012-12-20T21:15:45.323
> 
> 标签：java, import, wildcard, packages

我正在开发一个小型 Java 程序并使用数组，所以我完成了：

```
import java.util.Arrays; 
```

后来我开始扩展我之前所做的并决定我想从用户那里获得输入，所以我添加了：

```
import java.util.Scanner; 
```

现在产生了一个念头。我知道我可以这样做：

```
import java.util.* 
```

然后我只需要 1 个导入行而不是两个（或者我最终需要的多个），但是导入中的通配符是否意味着它将从该包中导入*所有内容*，无论是否需要，或者只会选择性功能被拉？

我的直觉是编写更多代码，并且只包含我*知道*我需要的包，但如果没有什么不同，为什么有人会导入更多的关卡/包然后他们需要呢？（我宁愿偷懒，少写代码）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T21:22:55.887

清楚 import 正在做什么。这并不意味着加载`.class`文件和字节码。

所有 import 都允许您使用短类名来保存输入。

因此，如果您`java.sql.PreparedStatement`在代码中使用，则`PreparedStatement`可以在 import 时使用`java.sql.PreparedStatement`。您可以永远编写 Java 代码，而无需使用单个`import`语句。您只需要拼出所有完全解析的类名。

`.class`并且类加载器仍然会在运行时首次使用文件时从文件中引入字节码。

它可以节省您的击键次数。就这样。

它与类加载*无关。*

就个人而言，我更喜欢避免使用 * 符号。我拼出每一个进口。我认为它更好地记录了我的意图。我的 IDE 是 IntelliJ，所以我要求它即时插入导入。

懒惰通常是开发人员的一种美德，但在这种情况下并非如此。拼出它们并让您的 IDE 为您单独插入它们。

如果你输入

```
import java.util.*; 
```

你会得到`Scanner`他们`List`的简称。

但是，如果您想这样做，`FutureTask`并且`LinkedBlockingQueue`您必须拥有这个：

```
import java.util.concurrent.*; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T21:18:54.543

通配符会导入该包中的所有内容。但是，使用像 Eclipse 这样的 IDE，它为您提供了组织导入的可能性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:24:06.820

通配符导入该包中的所有类和接口。

但是，通配符导入不会**导入**以相同名称开头的其他包。

例如，导入 java.xml.* 不会**导入**java.xml.bind 包。

# javascript - 当操作系统暂停/在后台在应用程序上运行 JavaScript 时恢复 Android webview？

> ID：13980584
> 
> 赞同：8
> 
> 时间：2012-12-20T21:15:53.717
> 
> 标签：javascript, android, webview

首先，我正在开发一个需要在应用程序不在前台时运行 JavaScript 的应用程序；问题似乎是，当应用程序进入后台/webview 与屏幕分离时，webview 的 onPause 方法被调用，每个文档执行以下操作：“暂停与此 WebView 及其关联的 DOM、插件相关的任何额外处理, JavaScript 等”

从我迄今为止发现的情况来看，我最好的选择似乎是使用反射来调用 webview 的“onResume”方法，该方法应该撤消所有这些进程暂停。在我当前的实现中，我得到了一个所述方法的实例，但是当调用时似乎什么都没有发生，因为我随后的 JavaScript 调用什么都不做（请注意，当我打开应用程序并在前台时，这有效）。

当您的应用程序在后台而不完全启动应用程序时，其他人看到我的代码存在问题或有运行 JavaScript 的解决方案吗？

推送消息说需要运行 JavaScript，因此发送意图以通知在后台运行的服务：

```
 Intent intent = new Intent( "some action" );
 intent.putExtra( "xtifyJson", xtifyJSON.toString() );
 context.sendBroadcast( intent ); 
```

在我的广播接收器的 onReceive 中，它位于始终运行的后台服务中：

```
final String stringArrayExtra = intent.getStringExtra( "xtifyJson" );
 if ( !Text.isNull( stringArrayExtra ) ) {

     new Handler( context.getMainLooper() ).post( new Runnable() {

          @Override
          public void run() {
             try {
                Log.d( "Hey Dev Guy", "Message received" );
                JavaScriptInterface javaScriptInterface = ( (SpecialApplication) getApplicationContext() ).getJavaScriptInterface();
                relectHiddenMethod( javaScriptInterface.getParentWebView(), "onResume" );
                javaScriptInterface.getParentWebView().resumeTimers();
                javaScriptInterface.callBackPushReceived( new JSONObject( stringArrayExtra ) );

          }
          catch (Exception e) {
             // TODO Auto-generated catch block
             e.printStackTrace();
          }
       }
    } );

 } 
```

reflectHiddenMethod 反射方法：

```
private void reflectHiddenMethod( final WebView webview, final String name ) {

    if ( webview != null ) {
        try {
            Method method = WebView.class.getMethod( name );
            Object invoke = method.invoke( webview );
        }
        catch (final Exception e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T01:02:14.943

不幸的是，这行不通。WebView 是一个 UI 组件，因此需要附加到窗口。StackOverflow 上还有其他参考资料，例如：[Android webview inside a service?](https://stackoverflow.com/questions/7884568/android-webview-inside-a-service) .

一种可能性是研究替代 JavaScript 库来执行您的代码，而不需要 WebView，例如 Rhino、V8 或 spidermonkey。

但可能最好的解决方案是用 Java 实现您的推送消息。

# android - Android List OnScrollListener如何检测每次新列表项在任一方向可见时

> ID：13980585
> 
> 赞同：3
> 
> 时间：2012-12-20T21:16:01.843
> 
> 标签：android, listview, onscroll

学习如何使用 OnScrollListener 并且我想找到一种方法，当用户在列表视图中向上或向下滚动时，每次新列表项可见时，我可以检测到，如果用户向下滚动，我想为每个计数器增加 1进入屏幕的新单元格，如果它向上滚动，我希望它减少，任何帮助都会有很长的路要走，谢谢。

```
counter = 0;
    list.setOnScrollListener(new OnScrollListener() {
        public void onScrollStateChanged(AbsListView view, int scrollState) {

        }

        public void onScroll(AbsListView view, int firstVisibleItem,
                int visibleItemCount, int totalItemCount) {

            // If list scroll up
            counter++;

            // If list scrolls down
            counter--;

        }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T00:04:45.473

我想通了，当您向下滚动时，第一个可见项目会增加一个

```
counter = 0;
    list.setOnScrollListener(new OnScrollListener() {
        public void onScrollStateChanged(AbsListView view, int scrollState) {
            // Do nothing
        }

        public void onScroll(AbsListView view, int firstVisibleItem,
                int visibleItemCount, int totalItemCount) {

            if(firstVisibleItem > counter + 3 || firstVisibleItem < counter - 3){
                counter = firstVisibleItem;
                Toast.makeText(ListTestActivity.this,
                        "counter = " + counter,
                        Toast.LENGTH_LONG).show();
            }

        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:43:42.523

使用`firstVisibleItem`变量。当它改变时，适当地调整你的计数。

# .net - .NET（背后的 C# 代码）重定向页面上的谷歌分析事件

> ID：13980588
> 
> 赞同：0
> 
> 时间：2012-12-20T21:16:10.863
> 
> 标签：.net, google-analytics

我正在创建一个专门用于触发 Google Analytics 事件的 .NET 页面。原因是我希望能够看到有多少人在点击我在电子邮件中发送的链接。我的最佳想法是制作一个简单的 .NET 页面，该页面会触发一个事件，然后重定向到一个文档。

问题是，它使用以下重定向就好了： protected void Page_Load(object sender, EventArgs e) { Response.Redirect("...". true); }

但是我无法触发该事件。我尝试使用 StringBuilder，这是我习惯从代码隐藏添加脚本的方式。关于如何让事件正常工作的任何建议，甚至更好的方法来触发电子邮件点击文档的事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:23:19.947

谷歌分析事件没有发生的原因是谷歌分析是客户端脚本。

当服务器将 HTML 和 JavaScript（以及其他内容）发送到浏览器时，会交付客户端脚本。

通过在服务器上使用 Response.Redirect，您可以确保 Web 服务器永远不会将该 HTML 和 JavaScript 发送到浏览器。相反，Web 服务器会发送一个 http 代码 ( [Http status-code 302](https://stackoverflow.com/questions/1723487/response-redirect-http-status-code) )，告诉 Web 浏览器转到您要重定向到的页面。

如果您想跟踪点击次数，最好将它们保存在 Page_Load 事件中的数据库中，而不是尝试使用 Google Analytics。

# php - php oci8 获取数组变量

> ID：13980592
> 
> 赞同：1
> 
> 时间：2012-12-20T21:16:23.967
> 
> 标签：php, javascript, oracle, google-maps-api-3

我在 javascript 中有一个数组，我想将它发布到 php 以存储到 oracle varchar2 中。我想知道如何在 php.ini 中获取这个数组。现在我总是有一个字符串 [object Object] 而不是 oracle 中的数组。我使用 JQuery $.post 将变量发送到 php，如下所示：

```
function savePolygons(){
    $.get('oracle_deletePolygons.php');
    for (var i = 0; i < createdShapes.length; i++){
        var nom_zone  = escape(document.getElementById('nom_zone_' + createdShapes[i].id).value);
        var couleur = escape(createdShapes[i].fillColor);
        var code_cs = escape('711');
        var shapeid_export = escape(createdShapes[i].id);
        var geometry = createdShapes[i].getPath();
        alert(geometry)
        var url1 = "oracle_savePolygons.php?nom_zone=" + nom_zone + "&couleur=" + couleur + "&code_cs=" + code_cs + "&shapeid_export=" + shapeid_export + "&geometry=" + geometry;
        $.get(url1);
    }
} 
```

在 php 中：

```
<?php
require("oracle_dbinfo.php");
sleep(5);
$nom_zone =$_GET['nom_zone'];
$shapeid_export = $_GET['shapeid_export'];
$code_cs = $_GET['code_cs'];
$couleur = $_GET['couleur'];
$geometry = $_GET['geometry'];

$conn = oci_connect($username, $password, $database);
$query = oci_parse($conn, 'INSERT INTO test1 (nom_zone, shapeid, code_cs, couleur, geometry) VALUES (:nom_zone, :shapeid_export, :code_cs, :couleur, :geometry)');

oci_bind_by_name($query, ":nom_zone", $nom_zone);
oci_bind_by_name($query, ":shapeid_export", $shapeid_export);
oci_bind_by_name($query, ":code_cs", $code_cs);
oci_bind_by_name($query, ":couleur", $couleur);
oci_bind_by_name($query, ":geometry", $geometry);

oci_execute($query);
oci_commit($conn);
?> 
```

var 几何是多边形每个顶点的坐标数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:20:47.413

如果您没有向 url 发布任何数据，只需使用 $.get() ：

```
$.get('oracle_deletePolygons.php'); 
```

请参考[jQuery.get()](http://api.jquery.com/jQuery.get/)

另请注意，这很可能是使用 $.get() 因为您只是发送查询字符串：

```
var url1 = "oracle_savePolygons.php?nom_zone=" + nom_zone + "&couleur=" + couleur + "&code_cs=" + code_cs + "&shapeid_export=" + shapeid_export + "&geometry=" + geometry;
$.post(url1); 
```

试试这个：

```
var url1 = "oracle_savePolygons.php?nom_zone=" + nom_zone + "&couleur=" + couleur + "&code_cs=" + code_cs + "&shapeid_export=" + shapeid_export + "&geometry=" + geometry;
$.get(url1); 
```

[使用$.get()](http://api.jquery.com/jQuery.get/)发布数据的示例：

```
$.get('oracle_savePolygons.php', {
    'num_zone' : nom_zone,
    'couleur' : couleur,
    'code_cs' : code_cs,
    'shapeid_export' : shapeid_export,
    'geometry' : geometry
}, function (data) {
  //Success callback if you need it
}); 
```

# objective-c - 协议中的方法无法正常工作

> ID：13980596
> 
> 赞同：0
> 
> 时间：2012-12-20T21:16:46.057
> 
> 标签：objective-c, delegates, protocols

我不明白为什么这段代码可以正常工作，例如

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{

    UITabBarItem *item1 = [self.tabBarController.tabBar.items objectAtIndex:1];

    visibleMapRect = self.mappa.visibleMapRect;
    visibleAnnotations = [mappa annotationsInMapRect:visibleMapRect];

    if(visibleAnnotations.count>0){
        item1.enabled=true;
    }
    else{
        item1.enabled=false;

    }

} 
```

但如果我将它放入由协议/委托（语言环境）调用的方法中，则不起作用

协议系统运行良好，因为`NSLog`它显示在控制台中

```
-(void)locale{

    UITabBarItem *item1 = [self.tabBarController.tabBar.items objectAtIndex:1];

    visibleMapRect = self.mappa.visibleMapRect;
    visibleAnnotations = [mappa annotationsInMapRect:visibleMapRect];

    if(visibleAnnotations.count>0){
        item1.enabled=true;
     }
     else{
         item1.enabled=false;

     }

     NSLog(@"%d",visibleAnnotations.count);

 } 
```

在第一种方法`NSLog(@"%d",visibleAnnotations.count);`中返回正确的数字......但在协议方法中它总是返回 0 ；

# rest - HTTP Allow 标头是否应该包含“OPTIONS”？

> ID：13980602
> 
> 赞同：8
> 
> 时间：2012-12-20T21:17:27.827
> 
> 标签：rest, http, header, http-options-method

如果 HTTP 资源无法使用给定的 HTTP 方法处理请求，它应该发送一个`Allow`标头以列出允许的 HTTP 方法。获得带有`Allow`标头的响应的另一种可能性是使用该方法发送请求`OPTIONS`。

我想知道`Allow`标题是否应该包含`OPTIONS`方法本身。

例子：

```
Allow: GET, PUT, DELETE, OPTIONS 
```

或者

```
Allow: GET, PUT, DELETE 
```

什么是正确的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T01:41:26.167

我不明白为什么不。`OPTIONS`request 方法用于请求有关可用于请求的 URI 的通信选项的信息。一些客户端使用`OPTIONS`来确定通信要求和服务器的功能，而无需检索或对请求资源执行操作。

# knockout.js - 淘汰赛js没有更新

> ID：13980606
> 
> 赞同：0
> 
> 时间：2012-12-20T21:17:32.627
> 
> 标签：knockout.js

在这个例子中我一定遗漏了一些东西。谁能让我知道可能出了什么问题？

链接：http: [//jsfiddle.net/EBxy4/42/](http://jsfiddle.net/EBxy4/42/)

屏幕：[共享屏幕](http://jsfiddle.net/EBxy4/42/embedded/result/)

当您更新第 1 行中框 1 中的值时，下角的值不会改变。

代码是：

```
function revenueStream(w1, w2, w3) {
    var self = this;
    self.week1Amount = ko.observable(w1);
    self.week2Amount = ko.observable(w2);
    self.week3Amount = ko.observable(w3);
}

function revenueStreamCategory(revenueStreams) {
    var self = this;
    self.revenueStreams = ko.observalrevenueStreams;

    self.week1Sum = ko.computed(function () {
        var sum = 0.0;

        ko.utils.arrayForEach(self.revenueStreams, function(item) {
            sum += item.week1Amount();
        });      
        return sum;
    });    
}

var rs = [];
rs.push(new revenueStream(10, 11, 12));
rs.push(new revenueStream(13, 14, 15));    
rs.push(new revenueStream(16, 17, 18));

var vm = new revenueStreamCategory(rs);      

ko.applyBindings(vm, document.getElementById("test"));​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:27:12.570

你的问题出在你的绑定上，替换这个：

```
<td><input data-bind="value: week1Amount()" /></td> 
```

和：

```
<td><input data-bind="value: week1Amount" /></td> 
```

这是一个工作小提琴：

[http://jsfiddle.net/EBxy4/44/](http://jsfiddle.net/EBxy4/44/)

我什至修复了你的小计，它是连接而不是求和！

# configuration - 如何为某些类配置不同级别的 log4net？

> ID：13980615
> 
> 赞同：2
> 
> 时间：2012-12-20T21:18:22.623
> 
> 标签：configuration, log4net

我想要所有东西的信息和一个包的调试。我尝试了许多变体：

```
<log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
        <param name="File" value="C:/temp/AutoTag.log"/>
        <param name="AppendToFile" value="true"/>
        <param name="MaxSizeRollBackups" value="2"/>
        <param name="MaximumFileSize" value="100KB"/>
        <param name="RollingStyle" value="Size"/>
        <param name="StaticLogFileName" value="true"/>
        <layout type="log4net.Layout.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] ac.server %-5p %c - %m%n"/>
        </layout>
    </appender>
    <root>
        <level value="INFO"/>
        <appender-ref ref="RollingFileAppender"/>
    </root>
    <logger name="AutoTagCore.net.windward.autotag.utils">
        <level value="DEBUG"/>
    </logger>
</log4net> 
```

但没有任何效果。如果我移除`<root/>`零件，我会在一个包装中获得详细信息。否则，就好像该`<logger/>`部分不存在一样。

我怎样才能做到这一点？（**更新**以显示完整的 log4net 部分）。

**更新 2：**我是个白痴 - 我在那里输入了错误的包名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:24:31.313

Logger 将从 root 继承所有 appender。您只需要指定级别：

```
<root>
    <level value="INFO"/>
    <appender-ref ref="RollingFileAppender"/>
</root>
<logger name="AutoTagCore.net.windward.autotag.utils">
    <level value="DEBUG"/>
</logger> 
```

*顺便说一句*，验证 appender 设置 - 它可以限制为 INFO 级别：

```
<threshold value="INFO"/> 
```

最后一个可能的问题 - 你可以有不同的类型命名空间和记录器名称（可能是一些错字）。

# css - 覆盖特定 DIV 的 CSS 样式？

> ID：13980626
> 
> 赞同：1
> 
> 时间：2012-12-20T21:19:18.267
> 
> 标签：css, fonts

我正在尝试覆盖我网站特定部分的默认字体样式，但无法使其正常工作。默认段落设置会覆盖 DIV 样式。

我的默认段落字体设置如下：

```
p {
color: #000000;
font: 15px/24px "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
margin-bottom: 24px;
} 
```

我试图通过像这样设置 DIV 的样式来缩小页脚字体：

```
#footer-disclaimers-freedvd {
color: #656565;
font: 12px/18px "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
} 
```

我的 html 看起来像这样：

```
<div id="footer-disclaimers-freedvd">
<p>some text....</p>
</div> 
```

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T21:21:10.860

您只需将段落添加到您的选择器

```
#footer-disclaimers-freedvd p {
color: #656565;
font: 12px/18px "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:21:18.927

您的选择器需要更具体

```
#footer-disclaimers-freedvd p { insert styles } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:33:57.910

有时，如果您确定您的目标是您的元素，但它仍然不起作用，请尝试添加“！important”。例如 div.class{margin-left:10px !important;}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:21:39.550

尝试`<p>`像这样定位元素：

```
#footer-disclaimers-freedvd p{
    color: #656565;
    font: 12px/18px "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
} 
```

# maven - 使用 Jmeter Maven 插件编辑 jmeter saveservice.properties 文件

> ID：13980628
> 
> 赞同：2
> 
> 时间：2012-12-20T21:19:36.010
> 
> 标签：maven, maven-3, jmeter, jmeter-plugins, jmeter-maven-plugin

当我使用 Jmeter Maven 插件调用 Jmeter 时，有没有办法编辑（向其中添加一些属性）Jmeter saveservice.properties 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T11:04:35.603

您可以将自己的 saveservice.properties 版本复制到：

```
${project.base.directory}/src/test/jmeter 
```

或者您可以使用 <propertiesSaveService> 配置设置覆盖特定属性，如下所示：

```
+---+
<project>
    [...]
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>${project.groupId}</groupId>
                    <artifactId>${project.artifactId}</artifactId>
                    <version>${project.version}</version>
                    <executions>
                        <execution>
                            <id>jmeter-tests</id>
                            <phase>verify</phase>
                            <goals>
                                <goal>jmeter</goal>
                            </goals>
                        </execution>
                    </executions>
                    <configuration>
                        <propertiesSaveService>
                            <HTTPSampler2>org.apache.jmeter.protocol.http.sampler.HTTPSampler2</HTTPSampler2>
                        </propertiesSaveService>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
    [...]
</project>
+---+ 
```

此信息现在可在项目 wiki 上获得，网址为[https://github.com/Ronnie76er/jmeter-maven-plugin/wiki/Modifying-Properties](https://github.com/Ronnie76er/jmeter-maven-plugin/wiki/Modifying-Properties)

# c# - 0xFF 变成 0x3F

> ID：13980631
> 
> 赞同：4
> 
> 时间：2012-12-20T21:19:50.143
> 
> 标签：c#, serial-port

我将 0xFF 发送到串口

结果我看到了 0x3F。

所有其他字节都是正确的。

情况是这样的……

外部盒子将这些字节发送到 PC...

> 0xFF, 0x0D, 0x00, 0x30, 0x31, 0x53, 0x55, 0x43, 0x43, 0x45, 0x53, 0x53

C# 在缓冲区中产生这个......

> 0x3F, 0x0D, 0x00, 0x30, 0x31, 0x53, 0x55, 0x43, 0x43, 0x45, 0x53, 0x53

第一个字节缺少前两位。有没有人见过这个 ？

如果这里有一篇文章解释了发生了什么，更重要的是为什么，甚至最重要的是，如何解决它，请指点我。谢谢你。

这是代码；我希望我已经弄清楚了 StackOverFlow 系统；仍然是这个社区的新手，我的 C# 知识大约有 1 或 2 个月大。

```
 public static void OurBackGroundSerialPortReceiver(object sender, SerialDataReceivedEventArgs e )
    {
                                                                //// Item 1, tell the world, particularly the
                                                                //// chief dispatch routin, that we are receiving

        aUartSemaphoreThatTells.WhatTheUartBackgroundRxIsDoing = (int)aValueWhichIndicatesThat.theUARTisReceivingData;

        SerialPort CurrentPort = (SerialPort)sender;            //// Int routine gave is this in the arguments

        int LastByteInUartBuffer = CurrentPort.ReadBufferSize;
        int TheLastByteTheBoxSent = CurrentPort.BytesToRead;
        string inputData = CurrentPort.ReadExisting();          //// This is a C# property method of ports

        int Dest;
        Dest = UartPlaceHolders.RxBufferLeader;                 //// Will index into buffer for Chief dispatch

        int Source;                                             //// Will index into Uart buffer to fish it out
        Source = 0;                                             //// therefore, we start at zero

        int TopEdge;                                            //// We'll calculate this here once instead of in the loops below
        TopEdge = (int)TheSizeOf.OneSecondsWorthOfData;         //// This will tell us when to wrap around

        if (Dest < UartPlaceHolders.RxBufferTrailer)            //// Half the time we'll have wrap-around
        {                                                       //// If that's the case, then the trailer > the leader
            while (
                  (Dest < UartPlaceHolders.RxBufferTrailer)     //// If we are wrapped, make sure we don't
                   &&                                           //// overtake either the trailer or
                   (Dest < TopEdge)                             //// go over the top edge
                   &&                                           //// At the same time, make sure that
                   (Source <= LastByteInUartBuffer)             //// we don't fish out more than is there
                   )
            {
                UartData.TheImmediateSecondOfData[Dest] = (byte)inputData[Source];      //// Move bytes into buff for chief
                Dest = Dest + 1;
                Source = Source + 1;
            }

            if (Source >= LastByteInUartBuffer)                 //// Have we done all the bytes for this event ?            
            {                                                   //// Yes, therefore we will update the leader
                UartPlaceHolders.RxBufferLeader = Dest;         //// This tells us where to start next time

                aUartSemaphoreThatTells.WhatTheUartBackgroundRxIsDoing = (int)aValueWhichIndicatesThat.WeHaveReceivedSomeData;

                return;                                         //// and we are done
            }
                                                                //// //  //   Else no, more bytes so...
            else if (Dest >= TopEdge)                           //// Did we wrap around ?
            {                                                   //// Yes, so
                Dest = 0;                                       //// wrap around to the start
                while (                                         //// Now we do the same thing again
                      Dest < UartPlaceHolders.RxBufferTrailer   //// C# and windows keep buffers at 4K max, 
                      &&                                        //// so we will wrap only once
                      Source < LastByteInUartBuffer             //// May not even need that other test
                      )                                         //// This will finish the rest of the bytes
                {
                    UartData.TheImmediateSecondOfData[Dest] = (byte)inputData[Source];      //// There they go
                    Dest = Dest + 1;
                    Source = Source + 1;
                }

                UartPlaceHolders.RxBufferLeader = Dest;         //// This tells us where to start next time
                return;
            }

            else                                             //// Dest is neither <, >, nor =, we have logic error
            {
                ErrorFlags.SerialPortErrorDescription = (int)AnError.ExistsInTheSerialPortBufferPointers;
                return;
            }

        }

        if (Dest >= UartPlaceHolders.RxBufferTrailer)           //// Now, if the Trailer is ahead of the leader, here we go
        {                                                       //// If that's the case, then the trailer > the leader
            while (
                //(Dest < UartPlaceHolders.RxBufferTrailer)     //// This is the first major difference twixt this time & previous...
                // &&                                           //// ...because This condition is defacto guarateed to be false now
                   (Dest < TopEdge)                             //// We still want to stop before we hit the top edge
                   &&                                           //// At the same time, make sure that we go past...
                   (Source < LastByteInUartBuffer)              //// ...the last byte the Uart gave us
                   &&
                   (Source < TheLastByteTheBoxSent)
                   )
            {
                UartData.TheImmediateSecondOfData[Dest] = (byte)inputData[Source];      //// Move bytes into buff for chief
                Dest = Dest + 1;
                Source = Source + 1;
            }

            if (Source >= LastByteInUartBuffer)                 //// Have we done all the bytes for this event ?
            {                                                   //// Yes, therefore we will update the leader
                UartPlaceHolders.RxBufferLeader = Dest;         //// This tells us where to start next time
                return;                                         //// and we are done
            }                                                   //// //   Else no, we have more bytes to move, so...
            else if (Dest >= TopEdge)                           //// Did we wrap around ?
            {                                                   //// Yes, so...
                Dest = 0;                                       //// wrap around to the start
                while (                                         //// Now we do the same thing again
                      Dest < UartPlaceHolders.RxBufferTrailer   //// C# and windows keep buffers at 4K max, 
                      &&                                        //// so we will wrap only once
                      Source < LastByteInUartBuffer
                      )
                {
                    UartData.TheImmediateSecondOfData[Dest] = (byte)inputData[Source];
                    Dest = Dest + 1;
                    Source = Source + 1;
                }

                UartPlaceHolders.RxBufferLeader = Dest;         //// This tells us where to start next time

                aUartSemaphoreThatTells.WhatTheUartBackgroundRxIsDoing = (int)aValueWhichIndicatesThat.WeHaveReceivedSomeData;

                return;
            }

            else                                                //// Dest is neither <, >, nor =, we have logic error
            {
                ErrorFlags.SerialPortErrorDescription = (int)AnError.ExistsInTheSerialPortBufferPointers;
                return;
            }

        }

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T02:29:30.053

这就是找到答案的地方......

[http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx)

向下滚动到“阅读”，它将详细说明用于执行此操作的方法，可在此处找到...

[http://msdn.microsoft.com/en-us/library/ms143549.aspx](http://msdn.microsoft.com/en-us/library/ms143549.aspx)

这是暂时解决此问题的代码（也许是好的）

```
 SerialPort CurrentPort = (SerialPort)sender;                                //// caller gave us this in the arguments

        int TheNumberOfBytes = CurrentPort.BytesToRead;                             // The system will tell us how large our array should be

        byte[] inputData = new byte[TheNumberOfBytes];                              // Our array is not that large

        int WeReadThisMany = CurrentPort.Read(inputData, 0, TheNumberOfBytes);      //// This is a C# property method of ports 
```

希望我在这里回答是正确的。

无论如何，这样做的最终结果是，此方法读取实际字节，作为字节，这些字节由另一端的任何东西发送到串行端口。

# wcf - gsoap2.8客户端和wcf service()

> ID：13980633
> 
> 赞同：1
> 
> 时间：2012-12-20T21:19:59.970
> 
> 标签：wcf, gsoap

我在 gsoap 客户端 c++ 调用我的简单 wcf 服务时遇到问题，该服务公开：

```
public double Add(double n1, double n2) {
    double result = n1 + n2;
    return result;
} 
```

下面是我的 gsoap 客户端测试代码：

```
BasicHttpBinding_USCORERestaurantService svc;
_ns1__Add         request;
_ns1__AddResponse response;

//svc->endpoint
double n1 = 1.12;
double n2 = 2.32;

request.n1 =&n1;
request.n2= &n2;
svc.soap->keep_alive=1;
int iResult = svc.__ns1__Add(&request, &response); // response result always return 0 
```

我在服务上有一个断点，n1,n2 的参数始终为 0；

下面是我的wsdl文件：

```
<?xml version="1.0" encoding="utf-8" ?> 
 <wsdl:definitions name="RestaurantService" targetNamespace="http://www.thinktecture.com/services/restaurant/2006/12" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:tns="http://www.thinktecture.com/services/restaurant/2006/12" xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsap="http://schemas.xmlsoap.org/ws/2004/08/addressing/policy" xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" xmlns:msc="http://schemas.microsoft.com/ws/2005/12/wsdl/contract" xmlns:wsa10="http://www.w3.org/2005/08/addressing" xmlns:wsx="http://schemas.xmlsoap.org/ws/2004/09/mex" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata">
 <wsdl:types>
 <xsd:schema elementFormDefault="qualified" targetNamespace="http://www.thinktecture.com/services/restaurant/2006/12">
 <xsd:element name="Add">
 <xsd:complexType>
 <xsd:sequence>
  <xsd:element minOccurs="0" name="n1" type="xsd:double" /> 
  <xsd:element minOccurs="0" name="n2" type="xsd:double" /> 
  </xsd:sequence>
  </xsd:complexType>
  </xsd:element>
 <xsd:element name="AddResponse">
 <xsd:complexType>
 <xsd:sequence>
  <xsd:element minOccurs="0" name="AddResult" type="xsd:double" /> 
  </xsd:sequence>
  </xsd:complexType>
  </xsd:element>
  </xsd:schema>
  </wsdl:types>
 <wsdl:message name="RestaurantService_Add_InputMessage">
  <wsdl:part name="parameters" element="tns:Add" /> 
  </wsdl:message>
 <wsdl:message name="RestaurantService_Add_OutputMessage">
  <wsdl:part name="parameters" element="tns:AddResponse" /> 
  </wsdl:message>
 <wsdl:portType name="RestaurantService">
 <wsdl:operation name="Add">
  <wsdl:input wsaw:Action="http://www.thinktecture.com/services/restaurant/2006/12/RestaurantService/Add" message="tns:RestaurantService_Add_InputMessage" /> 
  <wsdl:output wsaw:Action="http://www.thinktecture.com/services/restaurant/2006/12/RestaurantService/AddResponse" message="tns:RestaurantService_Add_OutputMessage" /> 
  </wsdl:operation>
  </wsdl:portType>
 <wsdl:binding name="BasicHttpBinding_RestaurantService" type="tns:RestaurantService">
  <soap:binding transport="http://schemas.xmlsoap.org/soap/http" /> 
 <wsdl:operation name="Add">
  <soap:operation soapAction="http://www.thinktecture.com/services/restaurant/2006/12/RestaurantService/Add" style="document" /> 
 <wsdl:input>
  <soap:body use="literal" /> 
  </wsdl:input>
 <wsdl:output>
  <soap:body use="literal" /> 
  </wsdl:output>
  </wsdl:operation>
  </wsdl:binding>
 <wsdl:service name="RestaurantService">
 <wsdl:port name="BasicHttpBinding_RestaurantService" binding="tns:BasicHttpBinding_RestaurantService">
  <soap:address location="http://localhost:3456/WebHost/Service.svc/RS" /> 
  </wsdl:port>
  </wsdl:service>
  </wsdl:definitions> 
```

下面是我启用日志记录的肥皂消息：

```
call from gsoap c++ client
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ns1="http://www.thinktecture.com/services/restaurant/2006/12">
<s:Header xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<To s:mustUnderstand="1" xmlns="http://schemas.microsoft.com/ws/2005/05/addressing/none">http://localhost:3456/WebHost/Service.svc/RS</To>
<Action s:mustUnderstand="1" xmlns="http://schemas.microsoft.com/ws/2005/05/addressing/none">http://www.thinktecture.com/services/restaurant/2006/12/RestaurantService/Add</Action>
</s:Header>
<SOAP-ENV:Body>
<ns1:Add>
<n1 xsi:type="xsd:double" xmlns="">1.1200000000000001</n1>
<n2 xsi:type="xsd:double" xmlns="">2.3199999999999998</n2>
</ns1:Add>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

从服务返回消息：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Header>
<ActivityId CorrelationId="ac83c5fa-e518-4883-a381-f5ec63411226" xmlns="http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics">dddc227b-82e3-4578-b282-572017003943</ActivityId>
</s:Header>
<s:Body>
<AddResponse xmlns="http://www.thinktecture.com/services/restaurant/2006/12">
<AddResult>0</AddResult>
</AddResponse>
</s:Body>
</s:Envelope> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T16:21:49.037

当 WCF 服务在请求 Add(int n1, int n2) 时总是返回 0 时，我遇到了同样的问题。经过长时间的工作，我找到了解决方法，我的解决方法是应用 gSoap 2.7.16 而不是最后的 2.8.1_2，它可以完美运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T01:43:07.260

下班后，我已经修复了这个问题，如果您使用的是 WCF ，则需要在操作中添加一个属性，例如：

```
[ServiceContract]
    public interface IMyService
    {
        [OperationContract]
        [XmlSerializerFormat(Style = OperationFormatStyle.Rpc, Use = OperationFormatUse.Literal)]
        long Method1(int a, int b, long c, string d);
     } 
```

因此 gsoap 可以正确地将参数值发送到服务器。

# c# - 设计 SQL 表（带有可变列？）

> ID：13980637
> 
> 赞同：0
> 
> 时间：2012-12-20T21:20:29.073
> 
> 标签：c#, sql

我正在创建一个将客户付款存储在数据库中的程序。

可以为一种产品多次付款，但我不想为客户进行的每次付款创建单独的列。

我想过通过在每次付款后添加一个新列来使列数可变，但这对我来说似乎是一个糟糕的解决方案......

有什么建议么 ？

我认为该表应如下所示：

```
ID    ClientID   ProductID   Payment????..... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:23:51.817

您应该创建一个单独的表，`Payments`然后您可以为每个订单进行多次付款。与此类似：

```
create table payments
( 
   paymentid int,
   paymentamount int,
   orderid int,
   paymentType varchar(50)
)

create table orders
(
   orderid int,
   customerid int,
)

create table customers
(
  customerid int,
  customername varchar(10)
)

create table orderdetails
(
  orderid int,
  productid int
)

create table products
(
  productid int,
  productname varchar
) 
```

以这样的方式进行设置将允许您为每个订单进行多次付款。

然后你的查询将是：

```
select *
from customers c
left join orders o
  on c.customerid = o.customerid
left join orderdetails od
  on o.orderid = od.orderid
left join products p
  on od.productid = p.productid
left join payments ps
  on o.orderid = ps.orderid 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:25:20.313

如评论中所述，您应该有一个链接到用户表的付款表。

```
Customer
{
  ID,
  Name etc...

}

Payment
{
   Amount
   CustomerId, (foreign key to customer table)
   ProductId,
   etc...
} 
```

然后查看客户支付的款项：

```
Select * 
From Customer 
Inner join Payment on Customer.Id = Payment.CustomerId
where customer.id == ? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:22:45.683

我认为可能有必要跟踪每笔单独的付款。从技术角度来看，它会让你的生活变得更加简单，在现实生活中的交易中，它可能是必需的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:44:23.260

产品销售场景的典型数据库规范化如下：

```
Table: Product
(pkey) ProductID
BarCode
ProductName
Price
etc... (product description, and stuff)

Table: InvoiceItem
(pkey) InvoiceItemID
(pkey) InvoiceID
(fkey) ProductID
Quantity

Table: Invoice
(pkey) InvoiceID
*some people like InvoiceTotal here, but then you end up with multiple authorities for the total of the invoice, I prefer to derive the InvoiceTotal from the sum of InvoiceItems*

Table: Payments
(pkey) PaymentID
(fkey) InvoiceID
PaymentAmount 
```

PKEY 指的是表中行的主键。FKEY 是指与另一个实体的外键关系。

最后（当您加入所有这些时），您最终会得到一个垂直表，其中包含一个包含一个或多个付款的单个发票，不同列中的贷方和借记。这允许一张发票在同一总数上包含多个产品，并允许将多个付款应用于同一张发票。如上所述，动态添加列将比其他任何事情都更令人困惑。关系数据库设计都是关于一组已知的列，将数据连接到未知数量的行上。

# objective-c - 使用 validateForInsert 防止核心数据重复

> ID：13980640
> 
> 赞同：2
> 
> 时间：2012-12-20T21:20:40.740
> 
> 标签：objective-c, ios, validation, core-data, duplicates

我的应用程序有一个竞争条件，多个 API 请求可能会返回完全相同的数据并尝试保存它们。我想通过在我的模型上添加 validateForInsert 来防止这种情况发生。验证的前提只是检查并查看标识符键是否已经像这样存在

```
- (BOOL)validateForInsert:(NSError *__autoreleasing *)error
{
    NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:NSStringFromClass([CWDeal class])];
    fetchRequest.predicate = [NSPredicate predicateWithFormat:@"identifier == %@", self.identifier];
    NSError *validateError;
    int count = [[(CWAppDelegate *)[[UIApplication sharedApplication] delegate] privatewriterManagedObjectContext] countForFetchRequest:fetchRequest error:&validateError];
    if (count > 0) {
        return FALSE;
    }
    return [super validateForInsert:error];
} 
```

问题是没有任何东西可以保存。我有一个 managedObjectContext（主线程），它有一个 privateWriterManagedObjectContext 的父级（连接到 PSC）。当我导入东西时，我将创建一个 importContext（一些后台线程），它有一个 managedObjectContext 的父级。当我获得新数据并尝试保存流程时，将是这样的。

（记住验证是检查对象的 privateWriterMOC）

在 importContext 上创建对象 -> 保存 -> 验证 -> 好的。

（数据被推送到 importContext 的父对象 managedObjectContext）。

保存 managedObjectedContext -> 验证 -> 好的。

（数据被推送到 managedObjectContext 的父级 privateWriterMOC）。

保存 privateWriterMOC -> 验证 -> 失败。privateWriterMOC 识别出对象在其上下文中并且不会保存它们。

似乎没有很多关于使用 validateForInsert 的文档，所以我希望有人对如何执行此操作有建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:47:32.323

这是我用于生产的代码：

```
- (BOOL)validateForInsert:(NSError *__autoreleasing *)error {
    [[(AppDelegate *)[[UIApplication sharedApplication] delegate] persistentStoreCoordinator] lock];
    NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:NSStringFromClass([Deal class])];
    fetchRequest.predicate = [NSPredicate predicateWithFormat:@"identifier == %@", self.identifier];
    NSError *validateError;
    int count = [[(AppDelegate *)[[UIApplication sharedApplication] delegate] validationContext] countForFetchRequest:fetchRequest error:&validateError];
    if (count > 0) {
        [[(AppDelegate *)[[UIApplication sharedApplication] delegate] persistentStoreCoordinator] unlock];
        return FALSE;
    }
    [[(CWAppDelegate *)[[UIApplication sharedApplication] delegate] persistentStoreCoordinator] unlock];
    return [super validateForInsert:error];
} 
```

锁定 PSC 是这项工作的关键。在不同的上下文尝试同时联系 PSC 之前，我遇到了很多死锁。我发现这种方法的唯一缺陷是，如果一个对象返回 false，则整个上下文将被标记为无效并且不会保存。假设您有许多好对象，但一个坏对象都在未保存的上下文中，那么单个坏对象将不允许保存好对象。我在测试时遇到了这个问题，但在生产中我没有看到任何问题。

* * *

我将发布一个我在编写问题并进行测试时提出的答案。我不知道这是否是正确的想法，但目前似乎正在防止重复。

我所做的是在我的 appDelegate 中创建另一个名为 validationContext 的上下文，并将其设置为与 privateWriterMOC 完全相同。基本上这个想法是它只连接到商店，并且它知道的唯一数据已经被写入。当调用 validateForInsert 时，我使用了 validationContext 来执行获取，如果该对象已被保存，它将通知我。

我相信竞争条件仍然可能发生（假设写入和获取同时发生并且获取首先返回）但我会更多地研究它（也许 sqlite3 数据库是原子的？）。竞争条件是一个非常极端的情况，但我只是想处理它以防万一。

# sql - 没有光标的 CSV 文件加载

> ID：13980644
> 
> 赞同：1
> 
> 时间：2012-12-20T21:21:14.247
> 
> 标签：sql, sql-server, database, tsql, cursor

我需要读取一个 CSV 文件并循环遍历所有记录，并对少数字段执行一些数据清理并将它们插入到 3 个不同的表 a、b 和 c。我不想要游标，请建议我一个简单但更快的方法来做到这一点。TSQL 代码片段会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:45:17.127

我建议使用 SSIS（SQL Server 集成服务）

[http://msdn.microsoft.com/en-us/library/ms141026.aspx](http://msdn.microsoft.com/en-us/library/ms141026.aspx)

或者，如果您使用的是旧版本的 SQL (SQL 2000)，则可以使用 DTS：

[http://msdn.microsoft.com/en-us/library/cc707786(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/cc707786%28v=sql.105%29.aspx)

这将允许您导入 CSV 文件，进行数据清理，并根据您自己的标准将数据插入到您想要的位置。

# jquery - 由于显示 jQuery 的 css 更改图像

> ID：13980649
> 
> 赞同：0
> 
> 时间：2012-12-20T21:21:28.347
> 
> 标签：jquery

我正在尝试根据 .css 的 CSS 来更改图像`.slidingDiv`。这是我到目前为止的代码：

```
$(document).ready(function(){
    var a = $('.slidingDiv').css({'display':'none'});
    var b = $('.slidingDiv').css({'display' : 'table-row'});

    if (a > b) {
        a.find('.imgchange img').attr('src','http://illiweb.com/fa/m/tabs_less1.gif');
    } else  if (a<b){
        $('.imgchange img').attr('src','http://illiweb.com/fa/m/tabs_more1.gif');
    }
});​ 
```

谁能解释我做错了什么？

编辑：我试图`tabs_more1.gif`在 div 关闭时显示（`display:none;`），`tabs_less1.gif`如果它们打开则显示（`display:table-row;`

打开和关闭 div 的代码：

```
$(document).ready(function() {
  $(".slidingDiv").hide();  
$('.secondarytitle').click(function() {  
    $(this).closest('tr').siblings('.slidingDiv').slideToggle(); 
});  
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:26:30.030

第一的

```
var a = $('.slidingDiv').css({'display':'none'});
var b = $('.slidingDiv').css({'display' : 'table-row'}); 
```

这两行针对相同的元素，因此第二行覆盖了第一行的功能。

* * *

然后你在比较`(a > b)`。您对此有何期待？您正在比较两个 jquery 对象（*此时具有相同的内容*）

* * *

在`else`你做

```
('.imgchange img'). 
```

你似乎`$`一开始就错过了..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:25:36.317

只需测试`.slidingDiv`.

在您的代码中，`a`并`b`返回 jQuery 本身，而不是数字。 [jQuery.fn.css](http://api.jquery.com/css/)以两个参数或一个对象作为其第一个参数传递，会将 CSS 设置为您的第二个参数的字符串值或对象的值。您正在隐藏您的`slidingDiv`元素，然后以如此之快的速度再次显示它，眼睛可能不会注意到它。jQuery 被返回，因此您可以将[方法链接](http://en.wikipedia.org/wiki/Method_chaining#jQuery)在一起。

你想做什么取决于你什么*时候*想做。

如果要在**之后**更改图像，请在代码中提供一个回调函数作为[slideToggle](http://api.jquery.com/slideToggle/)的第二个参数。`.slidingDiv`它是在停止滑动/动画时执行的函数。在该功能中，您可以在此之后检查您想要的任何内容；保证您的 div 将完全显示或完全隐藏，并且 jQuery 将正确评估当前应用的 CSS 样式到`.slidingDiv`.

```
$(document).ready(function() {
    $(".slidingDiv").hide();  
    $('.secondarytitle').click(function() {  
        $(this).closest('tr').siblings('.slidingDiv').slideToggle(undefined, changeImage); 
    });  
});

function changeImage() {
    var slidingEl = $('.slidingDiv'),
        isVisibleBool = slidingEl.is(':visible'),
        imgToChangeEl = $('.imgchange img');

    if (true === isVisibleBool) {
        imgToChangeEl.attr('src','http://illiweb.com/fa/m/tabs_less1.gif');
    } else {
        imgToChangeEl.attr('src','http://illiweb.com/fa/m/tabs_more1.gif');
    }
} 
```

如果要更改**之前**的图像，请将调用放在`changeImage`调用之前`slideToggle`。您可以将回调函数保存到另一天。但是，请注意[hide](http://api.jquery.com/hide/)确实接受回调函数作为参数。

# sql - 按具有多种地址类型的 id（非主键）分组

> ID：13980654
> 
> 赞同：1
> 
> 时间：2012-12-20T21:21:39.230
> 
> 标签：sql, sql-server, sql-server-2008

我的地址表如下所示：

```
AddressID Street        City         AddressTypeID    PersonID
1         1st 2ave      Edmonton     1                10
2         3st 6ave      Edmonton     2                10
3         8st 5ave      Edmonton     5                10
4         7st 4ave      Edmonton     2                11
5         2st 9ave      Edmonton     3                12
6         9st 2ave      Edmonton     5                12 
```

在该表中，personid 10 具有 3 种不同类型的地址。我希望结果是按优先级为 addressTypeID 1 的 personID 分组，如果此人没有 addresstypeID 1 则使用 addresstypeID 5

我希望输出如下所示：

```
AddressID Street        City         AddressTypeID    PersonID
1         1st 2ave      Edmonton     1                10
4         7st 4ave      Edmonton     2                11
6         9st 2ave      Edmonton     5                12 
```

谢谢你回答我的问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:27:17.997

```
; with cte as (
    select 
        a.AddressID, a.Street, a.City, a.AddressTypeID, a.PersonID,
        row_number() over(
            partition by a.PersonID 
            order by case a.AddressTypeID
                when 1 then 1
                when 5 then 2
                else 3
            end
        ) as rn
    from address a
)
select *
from cte
where rn = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:27:19.017

就像是

```
SELECT AddressTable.* FROM AddressTable INNER JOIN 

(SELECT PersonID, MIN(AddressID) as MinAddressID GROUP BY PersonID) AS MinIdTable ON 

AddressTable.AddressID = MinIdTable.MinIdTable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:28:53.857

这不是作为一个组最简单的方法，而是使用以下`row_number()`功能：

```
select a.*
from (select a.*,
             row_number() over (partition by personId
                                order by (case when AddressTypeId = 1 then 1
                                               when AddressTYpeId = 5 then 2
                                               else 3
                                          end)
                               ) as seqnum
      from addresses a
     ) a
where seqnum = 1 
```

请注意，我`case`在子句中使用了一个语句`order by`来指定您的优先级。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:31:27.720

首先，通过子查询过滤表以仅包含 AddressTypeID 为 1 或 5 的行。然后选择每个人具有最低 AddressTypeID 的单个（因为您希望 1 优先于 5）

```
select 
    *
from
    (select * from myaddresstable 
    where AddressTypeID in (1, 5))
where
    row_number() over (partition by PersonID order by AddressTypeID asc) = 1 
```

# python - 作者姓名的近似字符串匹配 - 模块和策略

> ID：13980656
> 
> 赞同：6
> 
> 时间：2012-12-20T21:22:09.350
> 
> 标签：python, python-2.7, difflib

我创建了一个小程序来检查作者是否存在于作者数据库中。我无法找到任何特定的模块来解决这个问题，所以我使用模块从头开始编写它以进行近似字符串匹配。

该数据库包含大约 6000 位作者，并且格式很差（许多拼写错误、变体、诸如“博士”之类的标题等）。查询作者列表通常在 500-1000 之间（我有很多这样的列表），因此速度非常重要。

我的一般策略是尽可能地修剪和过滤数据库并寻找精确匹配。如果没有找到匹配项，我将继续进行近似字符串匹配。

我目前正在使用内置的，`difflib.get_close_matches`它完全符合我的要求 - 但是，它非常慢（几分钟）。因此，我正在寻找其他选择：

*   什么是最快的模块，它可以返回最好的，比如说，在数据库中给出查询字符串的某个阈值以上的 3 个匹配？
*   比较两个字符串最快的模块是什么？

我发现的唯一一个是fuzzy wuzzy，它甚至比difflib 还要慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-04T18:44:59.763

在安装了 native-C [python-levenshtein](https://pypi.python.org/pypi/python-Levenshtein/)库的情况下尝试使用[fuzzywuzzy](https://github.com/seatgeek/fuzzywuzzy)。

[我在我的 PC 上运行了一个基准测试，以在安装和未安装C-native levenshtein 后端](http://www.lfd.uci.edu/~gohlke/pythonlibs/#python-levenshtein)（使用）的情况下在 ~19k 单词列表中找到 8 个单词的最佳候选者`pip install python_Levenshtein-0.12.0-cp34-none-win_amd64.whl`，我得到了这些时间：

*   无 C 后端：
    在 48.591717004776 秒（0.00032039058052521366 秒/搜索）内比较了 151664 个字。
*   安装的 C 后端：
    在 13.034106969833374 秒（8.594067787895198e-05 秒/搜索）内比较了 151664 个字。

那是**〜x4快**（但没有我预期的那么多）。

结果如下：

```
0 of 8: Compared 'Lemaire' --> `[('L.', 90), ('Le', 90), ('A', 90), ('Re', 90), ('Em', 90)]`
1 of 8: Compared 'Peil' --> `[('L.', 90), ('E.', 90), ('Pfeil', 89), ('Gampel', 76), ('Jo-pei', 76)]`
2 of 8: Compared 'Singleton' --> `[('Eto', 90), ('Ng', 90), ('Le', 90), ('to', 90), ('On', 90)]`
3 of 8: Compared 'Tagoe' --> `[('Go', 90), ('A', 90), ('T', 90), ('E.', 90), ('Sagoe', 80)]`
4 of 8: Compared 'Jgoun' --> `[('Go', 90), ('Gon', 75), ('Journo', 73), ('Jaguin', 73), ('Gounaris', 72)]`
5 of 8: Compared 'Ben' --> `[('Benfer', 90), ('Bence', 90), ('Ben-Amotz', 90), ('Beniaminov', 90), ('Benczak', 90)]`
6 of 8: Compared 'Porte' --> `[('Porter', 91), ('Portet', 91), ('Porten', 91), ('Po', 90), ('Gould-Porter', 90)]`
7 of 8: Compared 'Nyla' --> `[('L.', 90), ('A', 90), ('Sirichanya', 76), ('Neyland', 73), ('Greenleaf', 67)]` 
```

这是基准测试的python代码：

```
import os
import zipfile
from urllib import request as urlrequest
from fuzzywuzzy import process as fzproc
import time
import random

download_url = 'http://www.outpost9.com/files/wordlists/actor-surname.zip'
zip_name = os.path.basename(download_url)
fname, _ = os.path.splitext(zip_name)

def fuzzy_match(dictionary, search):
    nsearch = len(search)
    for i, s in enumerate(search):
        best = fzproc.extractBests(s, dictionary)
        print("%i of %i: Compared '%s' --> `%s`" % (i, nsearch, s, best))

def benchmark_fuzzy_match(wordslist, dict_split_ratio=0.9996):
    """ Shuffle and split words-list into `dictionary` and `search-words`. """
    rnd = random.Random(0)
    rnd.shuffle(wordslist)
    nwords = len(wordslist)
    ndictionary = int(dict_split_ratio * nwords)

    dictionary = wordslist[:ndictionary]
    search = wordslist[ndictionary:]
    fuzzy_match(dictionary, search)

    return ndictionary, (nwords - ndictionary)

def run_benchmark():
    if not os.path.exists(zip_name):
        urlrequest.urlretrieve(download_url, filename=zip_name)

    with zipfile.ZipFile(zip_name, 'r') as zfile:
        with zfile.open(fname) as words_file:
            blines = words_file.readlines()
            wordslist = [line.decode('ascii').strip() for line in blines]
            wordslist = wordslist[4:]  # Skip header.

            t_start = time.time()
            ndict, nsearch = benchmark_fuzzy_match(wordslist)
            t_finish = time.time()

            t_elapsed = t_finish - t_start
            ncomparisons = ndict * nsearch
            sec_per_search = t_elapsed / ncomparisons
            msg = "Compared %s words in %s sec (%s sec/search)."
            print(msg % (ncomparisons, t_elapsed, sec_per_search))

if __name__ == '__main__':
    run_benchmark() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T14:38:46.857

Python 的自然语言工具包 (nltk) 可能有一些额外的资源可供您试用 -[这个 google groups 线程](https://groups.google.com/forum/?fromgroups=#!topic/nltk-users/EJKQpnOgKUw)似乎是一个好的开始。只是一个想法。

# ruby-on-rails-3.2 - 将 Rails 3 render_to_string 与 PrivatePub 一起使用

> ID：13980658
> 
> 赞同：1
> 
> 时间：2012-12-20T21:22:18.200
> 
> 标签：ruby-on-rails-3.2

我正在使用 Rails 3.2 中的一个项目并使用 Ryan Bates 的 PrivatePub gem（Faye 包装器）。我在将 render_to_string 的结果传递到 Publish 方法的 javascript 时遇到问题。到目前为止，我还没有浏览过 Google、render_to_string 文档或 Faye 文档。

在我的控制器中，我有以下内容：

```
def my_action
  html_text = render_to_string :partial => 'my_partial', :formats => [:html]
  puts html_text
  PrivatePub.publish_to("/#{my_channel}", "$('#my_id').html('#{html_text}');")
end 
```

这不起作用（订阅页面上的 div 不会更新）。但是，将 my_partial 中相同内容的字符串分配给 html_text，它可以正常工作（div 更新）：

```
def my_action
  html_text = "<h3>Testing this</h3>" #This is the only change from above
  puts html_text
  PrivatePub.publish_to("/#{my_channel}", "$('#my_id').html('#{html_text}');")
end 
```

查看服务器日志，我可以看到在任何一种情况下，“puts html_text”输出看起来都完全相同。

不确定这是否重要，但我的控制器只响应 json，并且我正在使用 curl 将测试 POST 推送到此操作。

部分很简单：

```
<h3>Testing this</h3> 
```

我必须在这里遗漏一些简单的东西，但我不明白为什么 render_to_string 会给我一个不同的结果，只是分配一个字符串变量。

有人有想法么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T15:52:33.070

我得到了这个工作，虽然我不完全确定为什么。这是我所做的：

根据[这篇文章](https://stackoverflow.com/questions/7857779/string-comparison-not-working-in-ruby "这个帖子")中的一些讨论，我在代码中添加了以下内容，以便更好地了解正在发生的事情：

```
 html_text = render_to_string :partial => 'my_partial', :formats => [:html]
    test_text = "<h3>Testing this</h3>"
    puts "****************************************"
    puts html_text
    puts test_text
    puts html_text.bytes.count
    puts test_text.bytes.count
    puts "-" + html_text + "-"
    puts "****************************************"
    PrivatePub.publish_to("/#{my_channel}", "$('#my_id').html('#{html_text}');") 
```

在服务器日志中，我注意到 html_text 比 test_text 多一个字节。我还注意到 html_text 上的结尾“-”显示在单独的行上。

```
-<h3>Testing this</h3>
- 
```

所以我加了

```
html_text.strip! 
```

在 render_to_string 调用之后，它突然起作用了！现在的问题是弄清楚到底是什么字节导致这不起作用（因为我不能放过它！）。有人对那可能是什么有任何想法吗？

**编辑**

我弄清楚是什么导致了这个问题，所以我会解释一下，以防其他人遇到类似的问题。

我扩大了我的部分看起来像这样

```
<h3>Testing this</h3>
One
Two 
```

事情又停止了工作。那是因为`/n`里面有字符串。所以我替换 `html_text.strip!`了`html_text.gsub!(/\n/, '<br/>')`，现在一切正常。有时，深入思考只会混淆简单的答案！

不确定这是否是解决此问题的最佳 Railsy 方法，但它完成了工作。如果有人知道更好的方法来做到这一点，我很想听听！

# ms-access - ms 访问运行时错误 -2147352567 (80020009) 数据已更改

> ID：13980663
> 
> 赞同：1
> 
> 时间：2012-12-20T21:22:49.050
> 
> 标签：ms-access, vba, ms-access-2010

在我正在构建的 Access DB 中突然出现上述错误。它在我有一段时间没有编辑的过程中触发。工作正常。奇怪的是，当错误触发并且我进入调试模式时，我可以立即继续运行代码并且它可以工作。我试着在那条线运行之前暂停一下，但似乎没有帮助。

这是一段代码，但是，这个过程通常只调用其他过程：

```
 Call common.CalculateAllLoadTotals(Me, Me.AffiliateID, Me.ClientID, Me.FacilityID, Me.ProposalRevision)

'    Call common_2.sSleep(2000)

    Me.chkProposalRevisionTreated = -1
    Me.txtTreated.Requery 
```

该错误突出显示以下行：

```
Me.chkProposalRevisionTreated = -1 
```

有什么想法吗？

斯科蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:34:24.513

好吧，我用不同的方法“解决”了我的问题。没什么大不了的，但我使用 SQL UPDATE 查询来更改值。这很奇怪。

无论如何，我仍然欢迎任何人对此问题的见解。

斯科蒂

# c# - 使用 SQL Server Express 排列图表绑定中的所有数据

> ID：13980669
> 
> 赞同：1
> 
> 时间：2012-12-20T21:23:03.200
> 
> 标签：c#, winforms, sql-server-express

我很难将数据表的内容放在一个图表中，该数据表的内容基本上是性别、婚姻状况、年龄和日期。我正在使用条形图或柱形图，但我无法让它像我想要的那样工作。

我正在寻找的是图表的每一列都有他的名字在底部（数据库的列名）和标题（认为被称为标签）显示 SQL 查询的结果，但如果在该查询中存在不同例如，在 SEX 列中的数据有两种可能性，MAN 或 WOMAN，我需要如果柱形图 SEX 标题上有 2 个 MAN 结果和 3 个 WOMAN 结果，则该值必须出现在该列的标题中。

我从 SQL Server Express 数据库中获取数据。

这是我必须在图表中获取数据的查询：

```
SqlCommand cmd2 = new SqlCommand(string.Format("SELECT SEX, MARITAL,AGE,DATE FROM TEST WHERE (SEX IN (" + sex + ")) AND (MARITAL IN (" + marital + ")) AND (AGE (" + age + ")) AND (DATE IN (" + date + "))"), con1);

SqlDataAdapter da2 = new SqlDataAdapter(cmd2);

DataSet ds2 = new DataSet();
da2.Fill(ds2);

chart1.DataSource = da2;
chart1.Visible = true; 
```

如果你不理解我，这就是我正在寻找的（用 photoshop 制作：p）：

![在此处输入图像描述](../Images/4fa1a6420c94a5f047412295f65c6e2a.png)

[http://img38.imageshack.us/img38/4586/graficoingles.jpg](http://img38.imageshack.us/img38/4586/graficoingles.jpg)

我真的在 c# Winforms 中搜索了所有与图表相关的网站，但我找不到任何这样的解决方案。

任何人都可以帮助我使用我的 bbdd 中的绑定来制作类似于图表示例的代码。

感谢您的回答！

亲切的问候。

# c# - Visual C++ 的返回类型不匹配

> ID：13980671
> 
> 赞同：0
> 
> 时间：2012-12-20T21:23:09.683
> 
> 标签：c#, visual-studio-2010, visual-c++, types, bytearray

我在 Visual C++ 中有以下返回类型：

```
extern "C" __declspec(dllexport) unsigned char* _cdecl 
                                          getname(LPCTSTR Track1, int len) 
```

我编写了以下代码以`unsigned char*`在 C# 中获得正确的值：

```
[DllImport(_dllLocation, CallingConvention = CallingConvention.Cdecl)]
 public static extern byte[] getname(string track1, int len); 
```

我使用以下代码从另一个 .cs 文件中调用了上述方法：

```
string track = "hello12345"; 
byte[] name = UnsafeNativeMethods.getname(track, 160); 
```

请告诉我在这里做错了什么，还请检查参数数据类型，即`LPCTSTR`和`string`。

`unsigned char*`相当于`byte[]`。_ 如果是这样，那么为什么我在 C# 文件中得到错误的值，而在 C++ 中它是正确的。

## 编辑：

在通过评论提出一些建议后，我将其更改为`byte name`，`byte[] name`但它显示了以下异常：

```
A first chance exception of type 'System.Runtime.InteropServices.MarshalDirectiveException' occurred in DecryptionWS.dll
A first chance exception of type 'System.Runtime.InteropServices.MarshalDirectiveException' occurred in DecryptionWS.dll
A first chance exception of type 'System.Runtime.InteropServices.MarshalDirectiveException' occurred in   System.ServiceModel.dll
A first chance exception of type 'System.Runtime.InteropServices.MarshalDirectiveException' occurred in System.ServiceModel.dll 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:57:28.120

`unsigned char*`并且`byte[]`不完全等价。An`unsigned char*`是指向字节的指针，但 a是*已知长度*`byte[]`的字节数组。An没有已知的长度。.Net marshaller 不能直接从a 编组到 a ，因为它不知道缓冲区的长度。*`unsigned char*``unsigned char*``byte[]`*

 *因此，您将不得不手动编组返回值：

1.  更改您的 p/Invoke 函数定义以返回一个`IntPtr`（即通用指针值）`
2.  使用[Marhsal.Copy](http://msdn.microsoft.com/en-us/library/ms146631.aspx)从 复制`IntPtr`到字节数组。

示例：

```
[DllImport(_dllLocation, CallingConvention = CallingConvention.Cdecl)]
public static extern IntPtr getname(string track1, int len);

string track = "hello12345"; 
IntPtr namePtr = UnsafeNativeMethods.getname(track, 160);
Byte[] name = new Byte[/* some size here - it is not clear how*/];
Marshal.Copy(namePtr, name, 0, name.Length); 
```*

# oauth - 无法从 login box.com 获取授权码

> ID：13980676
> 
> 赞同：2
> 
> 时间：2012-12-20T21:23:35.313
> 
> 标签：oauth, box-api

我尝试通过指令获取身份验证令牌：http: [//developers.box.com/oauth/](http://developers.box.com/oauth/) 发送 GET 请求：[https](https://api.box.com/oauth2/authorize?response_type=code&client_id=MY_CLIENT_ID&state=authenticated&redirect_uri=MYURL) ://api.box.com/oauth2/authorize?response_type=code&client_id=MY_CLIENT_ID&state=authenticated&redirect_uri=MYURL 。输入登录名/密码并单击允许，但没有获得任何授权码。而不是这个简单的 box.com 页面。

如果我单击拒绝，那么好的，我看到打开的 url 带有错误 access_denied。我正在尝试从浏览器执行此操作。

为什么登录后收不到验证码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T05:03:27.940

我通过创建一个单独的页面来解决这个问题，用户可以在其中使用框登录，但我怀疑这是解决问题的最佳方式。Sean Rose 的建议显然是你最好的选择。这是我为获取代码所做的工作：

用户访问 [https] mysite.com/login_with_box 以授权访问。用户点击“允许”后，她重定向到 [https] mysite.com/redirect_uri，其 url 显然与您提供的应用程序的 redirect_uri 匹配。重定向后，用户应该会在 [https] mysite.com/redirect_uri?code=xxxxxxxxxxxxxxxxxx 中看到代码

我不得不使用 [https] 而不是 https:// 因为我是这里的新用户。

# regex - Perl regexp - 检索所有匹配项以列出并从文本中删除它们

> ID：13980677
> 
> 赞同：2
> 
> 时间：2012-12-20T21:23:37.253
> 
> 标签：regex, perl

我有一个文本，我想在其中找到所有匹配项
（例如每个匹配的模式`/d.g/`）

我需要在列表中并从原始文本中删除的那些模式。

操作上：`dog and dig where dug in dug`应该给我：（狗，挖，挖，挖）。

文本应更改为：`and where in`

我可以通过两次传递文本来做到这一点，但这会是双重工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:41:50.027

这是另一种选择：

```
use strict;
use warnings;

my $str = 'dog and dig where dug in dug';
my @matches;

$str =~ s/\b(d.g)\b/push @matches, $1; ''/ge;

print $str, "\n";
print join ', ', @matches; 
```

输出：

```
 and  where  in 
dog, dig, dug, dug 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:26:25.680

尝试这样做：

```
$_ = 'dog and dig where dug in dug';

(/\b(d.g)\b/) ? push @_, $1 : print "$_ " for split /\s+/;

print "\n\narr:\n", join "\n", @_; 
```

# 解释

*   `\b`是单词边界
*   `(condition) ? 'if true' : 'if false'`语句是三元运算符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T01:42:05.563

我会这样写

```
use strict;
use warnings;

my $str = 'dog and dig where dug in dug';
my @matches;

push @matches, substr $str, $-[0], $+[0] - $-[0], '' while $str =~ /d.g/g;

print join(', ', @matches), "\n";

print $str, "\n"; 
```

**输出**

```
dog, dig, dug, dug
 and  where  in 
```

# c++ - 类之间的关系——继承和组合

> ID：13980678
> 
> 赞同：1
> 
> 时间：2012-12-20T21:23:42.830
> 
> 标签：c++, inheritance, relationship, composition

我正在开发一款游戏，Snake。我对类之间的关系有疑问，我真的不明白为什么。

我有这三个类：

*   Snake - 蛇类。
*   食物——蛇吃的食物
*   对象 - 具有成员：宽度、高度、posX 和 posY

这些是关系： Snake 拥有来自 Object 类的无限数量的对象。每个对象都是蛇的一个块。因此在蛇声明中我有：

```
Object **blocks; 
```

然后，在蛇构造函数中，我为块创建了一个对象数组。不用管这部分，我已经测试过Snake，并使其顺利运行了几个块。蛇不是主要问题。

然后我尝试对 Food 类进行继承，只要我只使用头文件而不使用 cpp 文件，它就可以工作：

```
//Header file for Food
#include "Object.h"
class Food : Object { ............ }; 
```

到目前为止一切都很好，但是！，只要我写了一行：#include "Food.h" for food.cpp 并尝试编译编译器就会在 Snake(!?) 中发现错误。对于以下行，我有一个错误说“错误：“对象”不是类型上的名称”：

```
Object **blocks; 
```

这是否意味着我不能将类（对象）用于继承和组合？

编辑：我有很多代码，没有时间缩短所有代码。这是 Object.h 的代码（我没有 object.cpp 文件，因为还不需要）：

```
#ifndef OBJECT_H
#define OBJECT_H

#include "stdafx.h"
#include "Snake.h"

class Object {
private:
    int posX;
    int posY;
    int height;
    int width;

public:
    //Get functions
    int getPosX() const { return this->posX; }
    int getPosY() const { return this->posY; }
    int getHeight() const { return this->height; }
    int getWidth() const { return this->width; }

    //Set functions
    void setPosX(int x) { this->posX = x; }
    void setPosY(int y) { this->posY = y; }
    void setHeight(int h) { this->height = h; }
    void setWidth(int w) { this->width = w; }
};

#endif //OBJECT_H 
```

这是 Snake.h 的代码：

```
#ifndef SNAKE_H
#define SNAKE_H

#include "Object.h"
#include "stdafx.h"

class Snake {
public:
    enum Direction { Left, Right, Up, Down };

private:
    Object **blocks;
    int nrOfBlocks;
    float speed;
    int frontBlock;
    Direction direction;
    sf::Image blockImg;
    sf::Sprite blockSprite;

public:
    Snake();
    ~Snake();

    //Get functions
    int getNrOfBlocks() const { return this->nrOfBlocks; }
    float getSpeed() const { return this->speed; }
    Direction getDirection() const { return this->direction; }
    sf::Image getBlockImg() const { return this->blockImg; }
    sf::Sprite getSprite() const { return this->blockSprite; }

    //Set functions
    void setNrOfBlocks(int nrOfBlocks) { this->nrOfBlocks = nrOfBlocks; }
    void setSpeed(float speed) { this->speed = speed; }
    void setDirection(Direction direction) { this->direction = direction; }
    void setImage(sf::Image image) { this->blockImg = image; }
    void setBlockSprite(sf::Sprite sprite) { this->blockSprite = sprite; }

    void move(int n);
    void newFrontBlock();
    void changeDir(Direction dir);
    sf::Sprite doSprite(int n);
};

#endif //SNAKE_H 
```

这是 Food.h 的代码：

```
#ifndef FOOD_H
#define FOOD_H

#include "Object.h"
#include "stdafx.h"

class Food : public Object {
private:
    int points;
    int timeExperation;
    sf::Image image;
    sf::Sprite sprite;

public:
    Food();
    int getPoint() const { return this->points; }
    int getTimeExperation() const { return this->timeExperation; }
    void setPoints(int points) { this->points = points; }
    void setTimeExperation(int timeExp) { this->timeExperation =  timeExp; }
};

#endif //FOOD_H 
```

我希望代码不多。它主要是不重要的成员变量和 set-get-functions。如果您在这里找不到任何错误，那么我稍后会回来提供更多。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:52:01.410

发现错误。由于某种原因，可能是一个测试或错误，我不小心在 Object.h 中包含了#include "Snake.h"，同时我在 Snake.h 中包含了#include "Object.h"

不要现在为什么你只能将一个文件包含在另一个文件中而不是**反过来**，但是，我只是从 Object.h 中删除了#include "Snake.h"，它现在可以工作了！最奇怪且我完全不明白的是为什么 food.cpp 的 #include "Food.h" 会触发错误。如果有人知道这一点，请回复，我想从我的错误中学习。

无论如何，感谢所有回答的人！

# arrays - 如何避免数组中的 NPE 并避免引用相同的索引？

> ID：13980679
> 
> 赞同：2
> 
> 时间：2012-12-20T21:23:43.513
> 
> 标签：arrays, string, reference, indexing, nullpointerexception

在课堂上，我有以下领域：

```
public static String[] substring; 
```

现在我尝试使用以下方法初始化此变量：

```
for(int i = 0; i < MAX_SUBSTRING; i++){
    substring[i] = new String();
} 
```

但是发生的事情是我得到了一个 NPE，与 substring[i] 一致。我知道这是因为子字符串在声明时没有得到值，但是当我给它赋值时，每个索引都指向同一个位置。有点像每本书都指向另一本书，打开一本书意味着所有其他书同时打开。

```
public static String[] substring = new String[MAX_STRING]; 
```

我对此数组的任何索引所做的任何更改都会影响其余的索引。通过上述方式，我可以避免 NPE，但随后发生了另一个问题！

还是初学者，谁能帮帮我？

我正在使用 Java。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T09:22:33.683

我假设您使用的是 Java（因为您没有指定）。

向量子串的初始化是好的。我无法复制你的问题。你如何改变向量元素？

另外，MAX_STRING 和 MAX_SUBSTRING 是否具有相同的值？为什么将 substring 声明为静态变量？

# php - 如何使用 Doctrine 在 symfony 的管理生成器中对 FK 过滤器进行排序？

> ID：13980682
> 
> 赞同：1
> 
> 时间：2012-12-20T21:23:49.557
> 
> 标签：php, symfony-1.4, doctrine-1.2

我的 Poem 类有一个 symfony 管理员生成的模块。我的诗歌表对我的 MasterIndex 表 (user_id) 有一个 foreign_key 约束。当使用 Symfony 管理生成器时，在列表模式下，它会为我的 user_id 显示一个下拉过滤器。我可以通过修改 MasterIndex 类中的 __toString() 方法来更改正在显示的数据，以显示用户名而不是 Id。

如何对过滤器下拉列表中显示的数据进行排序？

我发现[这个](http://trac.symfony-project.org/wiki/HowtoSortAdminGeneratorListByForeignTableName)链接提出了一个解决方案，但`peer_method`它使用的似乎只适用于 Propel。

我在 Symfony 1.4 项目中使用 Doctrine 1.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T23:59:19.723

[您可以在此处](https://github.com/symfony/symfony1/blob/1.4/lib/plugins/sfDoctrinePlugin/lib/widget/sfWidgetFormDoctrineChoice.class.php#L35-48)找到可用的选项`sfWidgetFormDoctrineChoice`

```
* model:        The model class (required)
* add_empty:    Whether to add a first empty value or not (false by default)
                If the option is not a Boolean, the value will be used as the text value
* method:       The method to use to display object values (__toString by default)
* key_method:   The method to use to display the object keys (getPrimaryKey by default)
* order_by:     An array composed of two fields:
                  * The column to order by the results (must be in the PhpName format)
                  * asc or desc
* query:        A query to use when retrieving objects
* multiple:     true if the select tag must allow multiple selections
* table_method: A method to return either a query, collection or single object 
```

您可以使用如下`order_by`选项：`...->setOption('order_by', array('some_field', 'asc'))`.

**更新：**

如果您想按多个字段排序，您可以编写自定义查询并向其添加多个 order by，然后使用`query`or`table_method`选项而不是`order_by`.

例如（您应该将查询写入表类）：

```
$query = Doctrine_Core::getTable('UserTable')->createQuery('u')->orderBy('u.last_name asc, u.first_name asc');
$this->getWidget('user_id')->setOption('query', $query);
// if you add some where condition to the query
// don't forget to set it to the validator as well
$this->getValidator('user_id')->setOption('query', $query); 
```

# node.js - 通过节点 js 测试主干模型

> ID：13980684
> 
> 赞同：0
> 
> 时间：2012-12-20T21:23:53.583
> 
> 标签：node.js, backbone.js, express, mocha.js

我一直在尝试通过一个 express node.js 项目将单元测试与我的 Backbone 模型集成，并且很难准确掌握如何完成这项任务。（旁注：我来自很多 Java 背景，我意识到存在差异，但到目前为止我喜欢节点开发环境的简单和优雅。）

我的问题源于以下问题，骨干模型需要暴露给浏览器才能在其中运行，而通过 mocha 进行的测试是节点运行时环境中的“服务器端”。

这是我正在谈论的一个例子：

模型文件：/public/js/backbone/models.js

```
var SomeModel = Backbone.Model.extend({...}); 
```

服务器端测试：/test/backbone/models-test.js

```
??? 
```

我写的 ？？？因为通过服务器端进行正常的单元测试，您只需执行以下操作：

```
var SomeModule = require('./someModule'); 
```

走你快乐的路。显然，由于浏览器不在 Node 中运行，因此模块并不容易获得。

我已经阅读了一些帖子，说明您需要将浏览器端 javascript 包装在 require.js 中，这会将这些 javascript 文件自动放入节点命名空间中，从而允许您执行 require 并继续进行测试。但是，我还没有找到一种连贯的方式来完成这样的任务，我已经尝试四处寻找示例，但似乎找不到适用的东西。诚然，这很可能是我对这个框架的普遍缺乏了解，因为我仍在思考如何在 javascript 中定义事物的范围、注入依赖项等的整个想法。

任何帮助将不胜感激，如果这个问题已经被问了一百万次，我很抱歉，我确定它已经问过了，而且我以不正确的方式问它。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T22:20:33.307

如果你有一些仅限节点的代码（比如你的单元测试，如果你只打算在节点下执行它们），你可以采用这种方法：

*   npm 安装主干
*   `var Backbone = require('backbone');`
*   只需确保您从 NPM 获得的主干版本与您发送到浏览器的版本相同。如果您愿意，您甚至可以符号链接`public/js/backbone.js`到下面的文件`node_moules/backbone/backbone.js`。

如果您有仅浏览器的代码，您可以使用`Backbone`全局变量或它的`require.js`填充版本（如果您愿意）。

如果您有想要在浏览器中运行但也可以在节点中运行的代码（如模型），最干净的解决方案是使用 CommonJS（节点）样式对其进行编码`var Backbone = require('backbone');`并在节点中以这种方式运行，但用 requirejs 包装它/AMD 包装器，当您将其发送到浏览器并使用`require.config`&`require.paths`将“主干”映射到您的主干.js 文件时。

这个非常受欢迎的问题/答案中的详细信息：

[https://stackoverflow.com/a/10914666/266795](https://stackoverflow.com/a/10914666/266795)

也可以看看：

[http://backbonetutorials.com/organizing-backbone-using-modules/](http://backbonetutorials.com/organizing-backbone-using-modules/)

# com - 了解 C++Builder xxx_TLB.h 文件

> ID：13980685
> 
> 赞同：3
> 
> 时间：2012-12-20T21:24:03.527
> 
> 标签：com, activex, c++builder

我已经使用 c++Builder 2010（组件/导入组件/类型库向导）导入了一个类型库，并试图了解生成的 xxx_TLB.b 和 xxx_OCX.h 文件中定义的类和类型。*（问题的一些背景 - 我试图让我的 COM 对象和方法按名称绑定，而不是按 DISPID -[请参阅此问题](https://stackoverflow.com/questions/11670175/late-binding-com-objects-with-cbuilder?rq=1)）*

假设库包含一个类 Foo，我将获得以下 GUID

```
const GUID IID_IFoo = {0xF1EC45FE, 0x2540, 0x4188,{ 0xAE, 0x14, 0xD8,0x4F, 0x65, 0x6F,0x7A, 0x00} };
const GUID CLSID_Foo = {0xDD1C416D, 0xD8A2, 0x4BBC,{ 0x8E, 0xA8, 0x1A,0x10, 0x77, 0xA4,0x30, 0x0C} }; 
```

这对我来说很有意义。还生成了 FooEvents，但我暂时忽略它。我还获得了以下接口和 typedef，每种方法都有两个版本 - 一个“原始”版本和一个带有更友好的包装隐藏的版本`HRESULTS`。

```
interface DECLSPEC_UUID("{F1EC45FE-2540-4188-AE14-D84F656F7A00}") IFoo;
typedef TComInterface<IFoo, &IID_IFoo> IFooPtr;

interface IFoo  : public IDispatch 
{
  virtual HRESULT STDMETHODCALLTYPE get_Bar(BSTR* Value/*[out,retval]*/) = 0; // [201]
  ...
  BSTR __fastcall get_Bar(void)
  {
    BSTR Value = 0;
    OLECHECK(this->get_Bar((BSTR*)&Value));
    return Value;
  }
} 
```

现在我们来谈谈我无法理解的东西：两个基本公开相同功能但不同的附加类。

```
template <class T /* IFoo*/ >
class TCOMIFooT : public TComInterface<IFoo>, public TComInterfaceBase<IUnknown>
{
... again, two versions of each method are provided.
}
typedef TCOMIFooT<IFoo> TCOMIFoo;

template<class T>
class IFooDispT : public TAutoDriver<IFoo>
{
... again, two more versions of each method are provided.
}
typedef IFooDispT<IFoo> IFooDisp; 
```

情况变得更糟：在 xxx_OCX.h 文件中，我们发现了这个附加类：-

```
class PACKAGE TFoo : public Oleserver::TOleServer
{
  IFooPtr m_DefaultIntf;
  _di_IUnknown __fastcall GetDunk();
public:
  ... this tim, just one version of each method
} 
```

因此，对于 Foo 类型的对象，我似乎有四个不同的类来表示它——我应该使用哪一个，什么时候使用？

```
 IFooPtr f;
  IFooDisp f;
  TCOMIFoo f;
  TFoo *f; 
```

最后，因为`IFooDisp f;`似乎我可以`Bar()`通过任何一个调用`f->Bar()`-`f.Bar()`它们会以相同的方式工作，还是有一些细微的区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T00:13:23.153

> 所以，对于 Foo 类型的对象，我似乎有四个不同的类来表示它

`TComInterface`是一个包装类，用于为您管理接口指针的引用计数，很像 ATL`CComPtr`和`CComQIPtr`类。`AddRef()`这样，您不必`Release()`手动调用。

包装器`TCOMIFoo`基本上只是一个 typedef for `TComInterface<IFoo>`，尽管它也被`TCoClassCreator`同一个文件中创建的派生类使用。

`TAutoDriver`是一个用于处理`IDispatch`和后期绑定的包装类（按名称绑定成员所需要的）。

`TOleServer`是一个包装类，用于将 COM 对象公开为 VCL 组件，特别是在设计时可以将其放置在`TForm`、`TFrame`和`TDataModule`对象上。

> 我应该使用哪一个，何时使用？

我从未`TAutoDriver`在我的代码中使用过包装器，并且在设计时不使用 COM 对象（因为如果未安装 COM 对象，它们不允许您进行运行时错误处理）。对于大多数代码，我会坚持使用`IFooPtr`or `TCOMIFoo`，它们基本上是一样的。

> 最后，对于 IFooDisp f; 看来我可以通过 f->Bar() 和 f.Bar() 调用 Bar() - 它们的工作方式相同，还是有一些细微的区别？

有细微的差别。

`f->Bar()`直接调用该`IFoo::Bar()`方法，因此您必须进行自己的`HRESULT`检查，这使您可以决定发生错误时该怎么办。

`f.Bar()`调用包装器`IFooDisp::Bar()`方法，该方法调用该`IFoo::Bar()`方法并`HRESULT`为您进行检查，如果发生错误则引发异常。

一般来说，任何通过`->`操作符调用的方法都会直接调用原始接口，而任何通过`.`操作符调用的方法都会调用一个包装器方法。

另一个细微的区别是如果`Bar()`返回一个接口指针。使用`->`运算符，您必须对结果指针进行自己的引用计数，例如：

```
ISomeIntf i;
if (SUCCEEDED(f->Bar(&i)))
{
    ...
    i->Release();
} 
```

除非您使用`TComInterface`变量来接收它：

```
TComInterface<ISomeIntf> i; // or ISomeIntfPtr
if (SUCCEEDED(f->Bar(&i)))
{
    ...
    // Release()'d automatically
} 
```

相反，使用`.`运算符，包装器通常会返回 a`TComInterface`而不是原始接口指针。当接口链接在一起时，这尤其有用，您希望获得一个返回返回...的接口的接口，等等。使用`->`运算符更灵活，但不如使用`.`运算符干净，例如：

```
TComInterface<ISomeIntf> i; // or ISomeIntfPtr
if (SUCCEEDED(f->get_SomeIntf(&i)))
{
    TComInterface<IOtherIntf> j; // or IOtherIntfPtr
    if (SUCCEEDED(i->get_OtherIntf(&j)))
    {
        j->DoSomething();
    }
} 
```

相对：

```
f.SomeIntf.OtherIntf.DoSomething(); 
```

# android - 从 NFC 标签读取启动应用程序

> ID：13980687
> 
> 赞同：1
> 
> 时间：2012-12-20T21:24:05.913
> 
> 标签：android, android-manifest, nfc

我已经阅读和阅读，但我不明白当我触摸 NFC 标签时我需要做什么才能启动应用程序（一个列表弹出 TagWriter 和 {X}）

我已将此添加到我的应用程序主活动中（在清单中）

```
<intent-filter>
    <action android:name="android.nfc.action.NDEF_DISCOVERED"/>
    <category android:name="android.intent.category.DEFAULT"/>
    <data android:mimeType="text/plain" />
</intent-filter>
<intent-filter>
    <action android:name="android.nfc.action.TECH_DISCOVERED"/>
</intent-filter>
<intent-filter>
    <action android:name="android.nfc.action.TAG_DISCOVERED"/>
</intent-filter> 
```

我还在`application/com.pgsideris.aeglea`应用程序中使用 NDEF 数据写入和读取标签

我会欢迎一些细节，因为大多数其他帖子并没有提供太多内容，而且他们提供的链接让我有些困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T07:41:28.677

这些应用程序弹出的主要原因是您正在过滤 mimetype “text/plain”，如果您使用该 mimetype 编写了一个 NFC 标签，所有应用程序（包括您自己的应用程序）都将响应该标签。

如果您正确编写了 NFC 标签，可能会发布一些代码来验证这一点，您应该过滤 mimetype “application/com.pgsideris.aeglea”，这会产生以下过滤器：

```
<intent-filter>
    <action android:name="android.nfc.action.NDEF_DISCOVERED"/>
    <category android:name="android.intent.category.DEFAULT"/>
    <data android:mimeType="application/com.pgsideris.aeglea" />
</intent-filter> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T08:50:14.120

您的应用程序需要读取标签，还是只需要启动它？如果是后者，Android 提供了一个自定义的 NDEF rectord，您可以在其中指定要启动的确切包（应用程序）。参照，Android 应用记录 (AAR)： http: [//developer.android.com/reference/android/nfc/NdefRecord.html#createApplicationRecord](http://developer.android.com/reference/android/nfc/NdefRecord.html#createApplicationRecord(java.lang.String) (java.lang.String )

如果您想读取标签，并且您的应用不在前台，如果设备上的其他应用已注册处理相同的标签、NFC 技术等，您将看到一个选择对话框。您无法更改此设置，只需确保您的如果应用程序已经在前台使用前台调度，则它会获得优先权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T02:26:34.250

确保将权限添加到 AndroidManifest.xml：

```
<uses-permission android:name="android.permission.NFC"></uses-permission> 
```

根据标签的类型，您可能需要过滤标签。例如，要过滤包含指向您服务器的 url 的标签，您可以将其放入您的意图过滤器中：

```
 <data android:scheme="http"
            android:host="yourserver.com"
            android:pathPrefix="/"/> 
```

# asp.net-mvc-3 - Mvc 3 自定义 HelperFor，日期时间

> ID：13980689
> 
> 赞同：1
> 
> 时间：2012-12-20T21:24:20.930
> 
> 标签：asp.net-mvc-3, model, html-helper, form-submit

我的模型中有一个 DateTime 属性的自定义助手。

帮助器返回 Html for 3 选择一个代表天，一个代表月，最后一个代表年。

我有 ：

```
 public static MvcHtmlString DateFor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression)
        {
         ...
        } 
```

而且我想知道当我将表单提交到我的模型 dateTime 属性时如何链接用户的选择。

事实上，我想做和 EditorFor Helper 一样的事情。如果我有例如：

```
@Html.EditorFor(model => model.UserName) 
```

其中 userName 是一个字符串。它返回一个 textBox html 输入，当我提交表单时，userName 属性会自动填充字段值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:36:35.870

您可以在 3 个选择旁边发出一个 html 隐藏元素，并将其初始值设置为 3 个选择的初始值（连接即 dd/mm/yyyy，具体取决于适用于您的格式）。

然后，您可以将客户端更改事件连接到所有 3 个选择，以在每次更改时更新隐藏字段的值。

当然，隐藏字段的名称必须是日期时间属性名称（用于模型绑定）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:38:03.343

您可以为 DateTime 类型编写自定义模型绑定器和自定义编辑器模板来呈现您喜欢的 UI。斯科特汉塞尔曼[`blogged about this`](http://www.hanselman.com/blog/SplittingDateTimeUnitTestingASPNETMVCCustomModelBinders.aspx)。这是一个[`updated version`](http://www.longcloudtech.com/Blogs/Yankiwi/post/2010/04/21/Updating-Scott-Hanselmane28099s-DateTime-Custom-Model-Binder-%28DateAndTimeModelBinder%29.aspx).

# r - 如何将行名与列值进行比较并将新变量添加到 R 程序中的数据框

> ID：13980691
> 
> 赞同：-2
> 
> 时间：2012-12-20T21:24:25.620
> 
> 标签：r, dataframe

我想将一个矩阵（df2）中的行名与另一个数据框（df1）中的列值进行比较。比较后，我想在新列中将 df2 的值添加到 df1。

```
df1
ID  value  
A    12
B    13
C    14
A    15

df2
    LocationID
A    2
B    3
C    4

Finalresult
ID   Value   LocationID
A     12        2
B     13        3
C     14        4
A     15        2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:28:02.963

您正在寻找`merge`. 您可以设置 `by.y`检查行名，`by.x`以`ID`

```
merge(df1, df2, by.x = 'ID', by.y = 'row.names')
  ID value LocationID
1  A    12          2
2  A    15          2
3  B    13          3
4  C    14          4 
```

# android - 适用于 Android 的点对点消息传递解决方案？

> ID：13980693
> 
> 赞同：1
> 
> 时间：2012-12-20T21:24:40.090
> 
> 标签：android, android-networking

我需要使我的 Android 应用程序支持点对点式通信系统，该系统将允许 2 个或更多运行我的应用程序的设备相互通信。（交换位置数据、次要 ID 和一些特征类型数据，如聊天消息或阻止列表等......）

这些设备 99% 的时间都是 wifi，所以运行 XMPP 服务器是不可能的。我需要真正的点对点方法。我可能会知道运行我的应用程序的所有设备，因此对等发现不必成为问题。我也在看 AllJyon，但我还没有对此发表意见。

任何人都对在已知设备“池”之间传递数据的点对点方法有任何经验吗？我可以直接在同一个应用程序中使用客户端和服务器实现套接字解决方案。但是民意调查有很多要考虑的事情，我知道我会偶然发现其他人会想到的其他事情。

也许是 4 人游戏的游戏网络库？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:59:45.123

还不如回答我自己的问题。

我看过 AllJoyn，但 AllJoyn 守护进程是 Eclipse 的 PITA。使用 Google ADT 捆绑包 v21.0，AllJoyn 聊天应用程序不会导入和运行。本机 JNI 库将无法在模拟器或设备上加载。然后，我完全按照 AllJoyn 设置说明进行操作，并设法让 Chat 示例与 Eclipse 3.7.2 和 Google ADT 一起运行。然而，对于这两个 Eclipse 版本，我从来没有能够从头开始创建我自己的 AllJoyn 项目。该死的 JNI 库不会加载。我已经按照说明发布到论坛上，但没有运气。

看着 Sip2Peer。永远无法使示例正常工作，并且文档确实缺乏。然而，我已经看到了一堆证据表明它有效并且人们使用它，只是不是我。

我一个人去 我将只实现一个服务器/客户端并制定一个广播方法来进行发现。

# c++ - 如何计算 C++ 中类对象使用的内存量？

> ID：13980701
> 
> 赞同：-1
> 
> 时间：2012-12-20T21:25:33.727
> 
> 标签：c++

我想计算一个对象使用的内存量（以字节为单位）。给定

```
struct A
{
    float data[16];
    int index;
};

struct B
{
    A a;
}; 
```

以下是正确的方法吗？

```
template <class Type>
size_t footprint();

template <>
size_t footprint<A>()
{
    return sizeof(float) * 16 + sizeof(int);
}

template <>
size_t footprint<B>()
{
    return footprint<A>();
} 
```

我不确定footprint()，因为我听说编译器可能会添加额外的信息来存储成员变量，我不确定footprint()，因为它引用了一个类对象。这也需要一些内存吗？

编辑：好的，假设情况发生了变化，我们没有使用静态数组而是使用实际指针：

```
#include <iostream>

using namespace std;

struct A
{
    A(int size_)
    {
        data = new float[size_];
        size = size_;
    }

    ~A()
    {
        delete [] data;
    }

    float* data;
    int size;
};

struct B
{
    B() : a(16) {}

    A a;
};

size_t footprint(const A& a)
{
    return sizeof(float) * a.size + sizeof(int);
}

size_t footprint(const B& b)
{
    return footprint(b.a);
}

int main()
{
    A a(16);
    B b;

    cout << "sizeof(A) = " << sizeof(A) << endl;
    cout << "sizeof(B) = " << sizeof(B) << endl;
    cout << "footprint(a) = " << footprint(a) << endl;
    cout << "footprint(b) = " << footprint(b) << endl;
} 
```

在这里，您实际上需要一个特殊的 sizeof 函数（这里称为足迹）对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:36:31.767

正确的方法是使用`sizeof(A)`or `sizeof(B)`。添加成员的大小是不正确的，因为编译器可以自由放置额外的空间，称为填充，以正确对齐事物。`sizeof`占这个填充。

您还表达了对您的数组衰减为指针的担忧。情况并非如此`sizeof`。`sizeof(an array)`将给出数组占用的字节总数，前提是它仍然是数组形式并且没有衰减为指针。事实是，标准明确不允许这种衰减发生在`sizeof`，所以你在那里是安全的：

C++11 N3485 § 5.3.3/4 [强调我的]：

> 左值到右值 (4.1)、**数组到指针**(4.2) 和函数到指针 (4.3) 标准转换不适用于 sizeof 的操作数。

`sizeof(A) == 16 * sizeof(float) + sizeof(int) + sizeof(additional padding)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:34:29.320

由于该示例具有静态分配的数组，因此使用 sizeof(A) 将为您提供正确的大小。但是，有时由于位填充，大小会与您预期的不同。

但是，如果您有动态分配的数组，则需要执行以下操作：

```
lengthOfArray*sizeof(arrayElement); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:38:52.737

不仅`return sizeof(float) * 16 + sizeof(int);`对于更复杂的对象非常麻烦，而且它也可能是不正确的。C 语言规范允许编译器“填充”结构。比如说我们有

```
class X {
public:
    int i;
    char c;
    double d;
}; 
```

您调整结构大小的方法会说它占用 4 + 1 + 8（或一些这样的值），但实际`sizeof(X)`会给出 4 + 4 + 8。由于大小数据类型的极端混合，我们很容易看到错误50-75%。[成员的确切布局取决于编译器、处理器架构、编译器开关等]。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T21:43:02.767

在动态分配情况下，它变得更加复杂。实际说明您的班级使用情况的最佳解决方案是实现您自己的 operator::new(size_t size) [并可能调用 malloc 来分配 size 字节数]，然后说明大小 - 但是，这不会说明分配器本身的开销，每次调用 new 大约 12 个字节。并且分配器还可以对正在分配的实际大小进行四舍五入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-20T22:23:13.210

作为对先前答案的补充，编译器为您提供了控制填充行为方式的方法（因此，如果内存占用在程序的那个点对您特别重要，如果您想要通过网络或其他方式发送您的结构）。

您可以查看`#pragma pack`实现此类目标的声明。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-20T22:33:15.617

我还没有看到提到的一个问题。当你这样做

```
float * data = new float[size_];
delete [] data; 
```

然后 sizeof(float) * size_ 是分配的内存量。但是当你这样做时

```
std::string * data = new std::string[size_];
delete [] data; 
```

当删除发生时，它需要知道在 new() 期间 size_ 是什么，因此它知道调用 std::string 析构函数的次数。C++ 有时可以在分配中添加几个字节来跟踪您分配了多少数组成员。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-21T09:24:19.663

鉴于上述评论，我认为需要另一个答案。

我可以想到一些很好的解决方案来限制缓存使用的内存量： 1\. 开始时，分配 X KB 内存（无论您的缓存“允许”使用什么）。根据需要将其切成部分。装满后，取出最旧的并重复使用（如果大小不同，可能需要多个）。

你需要一些方法来标记“最近使用”或“老化”的东西，这样你就可以扔掉最旧的东西。可能通过使用展开[树](http://en.wikipedia.org/wiki/Splay_tree)，当您获取某些东西时它会自动重新排序，因此最近的对象位于树的顶部。

1.  与上述类似，但使用固定数量的固定大小的数据块 - 例如 16 或 32（或 256、或 500 或任何对您的典型缓存条目大小最有意义的东西）。在一天开始时，将所有缓存条目放入“免费”容器（例如列表）中。当你需要一个新的缓存条目时，获取空闲列表的顶部。如果列表为空，则查找最旧的列表并将其重新用于缓存。

2.  如果您存储的对象的类型和大小不同，您可能会发现创建自己的堆并为您的类使用 operator::new() 是更好的选择（显然也是相应的 operator::delete()）。关于如何制作自己的堆有多种解决方案（有时在 C++ 中称为免费存储）。我倾向于有一些圆形的东西，大小有限，这样你就不会得到如此糟糕的碎片。

# c# - 具有许多属性的类的装饰器模式

> ID：13980703
> 
> 赞同：12
> 
> 时间：2012-12-20T21:25:38.253
> 
> 标签：c#, properties, decorator

我有这个简单的课程：

```
public class DataBag
{
    public string UserControl { get; set; }
    public string LoadMethod { get; set; }
    public dynamic Params { get; set; }
    public int Height { get; set; }

    public DataBag(string Control, 
        object vars, string lm)
    {
        UserControl = Control;
        LoadMethod = lm;
        Params = vars;
        Height = 0;
    }
} 
```

然后我想为它创建一个装饰器，它会添加一堆它自己的属性。问题是提供对装饰属性的访问的最简洁和优雅的方式是什么？

到目前为止，我有两个选择：或者我为`get-set`装饰器中的四个装饰属性中的每一个提供一对（这看起来很乏味而且很拗口，基本上这是我想要避免的）或者我继承`DataBag`然后`DynamicObject`以某种方式设法使用`TryGetMember`方法获取装饰属性（这是动态的，似乎不是在 C# 中做事的正确方法）。

有什么建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T22:02:28.970

在实现装饰器时，我通常会执行以下操作。首先 - 提取装饰对象的接口并使装饰对象实现该接口：

```
public interface IDataBag
{
    string UserControl { get; set; }
    string LoadMethod { get; set; }
    dynamic Params { get; set; }
    int Height { get; set; }
} 
```

接下来 - 创建一个装饰器，它将所有调用委托给装饰对象（所有装饰器都将从这个装饰器继承）：

```
public class DataBagDecorator : IDataBag
{
    private IDataBag _dataBag;

    public DataBagDecorator(IDataBag dataBag)
    {
        _dataBag = dataBag;
    }

    public virtual string UserControl
    {
        get { return _dataBag.UserControl; }
        set { _dataBag.UserControl = value; }
    }

    // other members
} 
```

最后 - 创建装饰器：

```
public class FooDataBag : DataBagDecorator
{
    public FooDataBag(IDataBag dataBag) 
        : base(dataBag) { }

    public override string UserControl
    {
        // added behavior
        get { return "Foo" + base.UserControl; }
        set { base.UserControl = value; }
    }

    // you don't need to override other members
} 
```

用法：

```
IDataBag dataBag = new FooDataBag(new DataBag()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:46:26.043

更新：@JeremyDWill 正确地指出，您不能从其参数之一派生泛型类型......

~~如果您将装饰器视为“添加新属性的子类”，您可以执行以下操作：~~

 ~~```
public class MyDecorator<T> : T
{
    public int MyDecoratorProperty1 { get; set; }
    public int MyDecoratorProperty2 { get; set; }
} 
```~~ 

~~然后，您可以创建`MyDecorator<DataBag>`、 和`MyDecorator<OtherClass>`等的实例。现有属性是可访问的，因为`MyDecorator<>`是特定于泛型参数的类型，并且派生自该类。~~

您可以创建一个包含装饰对象的包装器：

```
public class MyDecorator<T>
{
    public MyDecorator(T decoratedObject)
    {
        this.DecoratedObject = decoratedObject;
    }

    public T DecoratedObject { get; private set; }

    public int MyDecoratorProperty1 { get; set; }
    public int MyDecoratorProperty2 { get; set; }
} 
```

优点是获得装饰属性很容易：`myObj.MyDecoratorProperty1`. 缺点是您现在必须通过`DecoratedObject`成员才能到达基础对象：

```
DataBag bag = new DataBag("", null, null);
MyDecorator<DataBag> deco = new MyDecorator<DataBag>(bag);
deco.DecoratedObject.Height = 2; 
```

如果您不能从装饰子类化（例如，您需要一次支持多个装饰器），则必须执行“附加属性”之类的操作……您的装饰器类必须保留原始字典对象和装饰的属性。使用一些扩展方法，您可以使这些属性“看起来”像被修饰类的本地成员，只要您知道预先修饰的类型（或愿意修饰*任何*对象）：

```
public static class AttachedDecorator
{
    private class Properties
    {
        public int MyDecoratorProperty1 { get; set; }
        public int MyDecoratorProperty2 { get; set; }
    }

    private static Dictionary<object, Properties> map = new Dictionary<object, Properties>();

    public static int GetMyDecoratorProperty1(object obj)
    {
        Properties props;
        if (map.TryGetValue(obj, out props))
        {
            return props.MyDecoratorProperty1;
        }

        return -1; // or some value that makes sense if the object has no decorated property set
    }

    public static int GetMyDecoratorProperty2(object obj) { /* ... */ }

    public static void SetMyDecoratorProperty1(object obj, int value)
    {
        Properties props;
        if (!map.TryGetValue(obj, out props))
        {
            props = new Properties();
            map.Add(obj, props);
        }

        props.MyDecoratorProperty1 = value;

    }

    public static void SetMyDecoratorProperty2(object obj, int value) { /* ... */ }
}

public static class DecoratorExtensions
{
    private static int GetMyDecoratorProperty1(this object obj)
    {
        return AttachedDecorator.GetMyDecoratorProperty1(obj);
    }

    private static void SetMyDecoratorProperty1(this object obj, int value)
    {
        return AttachedDecorator.GetMyDecoratorProperty1(obj, value);
    }
    // ...
} 
```

您的代码可能如下所示：

```
DataBag myData = new DataBag();
myData.SetMyDecoratorProperty1(7);
Console.WriteLine("prop1: {0}", myData.GetMyDecoratorProperty1()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T22:00:58.213

这是最简单的装饰方法：

```
public class PrettyBag : DataBag
{
    public int Decoration1 { get; set; }
    public int Decoration2 { get; set; }
} 
```

如果您想创建一个外观并隐藏一些 DataBag 属性而不是仅仅添加属性，那么您可以使 DataBag 的成员受到保护。

使用接口，您可以执行以下操作：

```
 public interface IDataBag
    {
       ...
    }
    public class DataBag : IDataBag
    {
       ...
    }
    public interface IPrettyBag : IDataBag
    {
        int Decoration1 { get; set; }
        int Decoration2 { get; set; }
    }
    public class BigBag : IPrettyBag
    {
        public int Decoration1 { get; set; }
        public int Decoration2 { get; set; }
    }
    public interface SmallBag : IPrettyBag
    {
        public int Decoration1 { get; set; }
        public int Decoration2 { get; set; }
    } 
```

# php - 在多维数组中搜索值并在PHP中获取父数组

> ID：13980706
> 
> 赞同：5
> 
> 时间：2012-12-20T21:25:51.123
> 
> 标签：php, arrays, search, multidimensional-array

我有这个数组：

```
Array
(
    [0] => Array
        (
            [name] => Dick Jansen
            [matchedMovie] => Array
                (
                    [0] => Array
                        (
                            [nameMovie] => Saw
                            [genre] => Horror
                            [patheMovie] => Texas Chainsaw 3D
                            [patheMovieGenre] => Horror
                            [score] => 100.00
                        )

                )

        )

    [1] => Array
        (
            [name] => Jim Scott
            [matchedMovie] => Array
                (
                    [0] => Array
                        (
                            [nameMovie] => Shooter
                            [genre] => Action, Thriller
                            [patheMovie] => The Shining
                            [patheMovieGenre] => Horror, Suspense/Thriller 
                            [score] => 52.38
                        )

                    [1] => Array
                        (
                            [nameMovie] => Resident Evil Movie
                            [genre] => Action/Horror
                            [patheMovie] => Texas Chainsaw 3D
                            [patheMovieGenre] => Horror
                            [score] => 63.16
                        )

                )

        )
) 
```

我想搜索 [patheMovie] 值（如“The Shining”）并获取带有 [name] 的父数组加上仅带有匹配的 [patheMovie] 的 [matchedMovie] 数组。

我试过这样的事情：

```
$search='Texas Chainsaw 3D';

                $sorted=false;
                foreach ($sorted as $n=>$c)
                    if (in_array($search,$c)) {
                        $cluster=$n;
                    break;
                } 
```

例如，如果我搜索“The Shining”，我希望数组返回如下：

```
 Array
    (

    [0] => Array
            (
                [name] => Dick Jansen
                [nameMovie] => Saw
                [genre] => Horror
                [patheMovie] => Texas Chainsaw 3D
                [patheMovieGenre] => Horror
                [score] => 100.00
            )
    )

and if you search for 'Texas Chainsaw 3D' like so:

Array
    (
        [0] => Array
            (
                [name] => Dick Jansen
                [nameMovie] => Saw
                [genre] => Horror
                [patheMovie] => Texas Chainsaw 3D
                [patheMovieGenre] => Horror
                [score] => 100.00
             )
         [1] => Array
             (
                [name] => Jim Scott
                [nameMovie] => Resident Evil Movie
                [genre] => Action/Horror
                [patheMovie] => Texas Chainsaw 3D
                [patheMovieGenre] => Horror
                [score] => 63.16
              )
      ) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T22:08:58.953

该解决方案将取决于两个共轭环。

```
<?php
function searchIt($arr, $searchItem){
$result = array();
$resultIndex = 0;
for ($i =0; $i < count($arr); $i++){
 for ($j = 0; $j < count($arr[$i]['matchedMovie']); $j++){
  if ($arr[$i]['matchedMovie'][$j]['patheMovie'] == $searchItem){
   $result[$resultIndex]['name'] = $arr[$i]['name'];
    foreach ($arr[$i]['matchedMovie'][$j] as $key => $value){
     $result[$resultIndex][$key] = $value;
   }
    $resultIndex++;
  }
 } 
}
return $result;
}
?> 
```

### [phpfiddle 演示](http://phpfiddle.org/main/code/xmt-j9u)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:41:10.093

尚未对此进行测试，但这应该可以工作：

```
function findYourGuy($array, $searchTerm) {
    $searchTerm = 'The Shining'; // testing purpose only
    foreach($array as $personArray) {
        $matchedMovies = $personArray['matchedMovie'];
        $name = $personArray['name'];
        foreach($matchedMovies as $matchedMovie) {
            if($matchedMovie['patheMovie'] == $searchTerm) {
                return array('name' => $name, 'matchedMovie' => $matchedMovie)
            }
        }
    }
    return false; //no result
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:46:16.707

我会使用[array_filter](http://ca3.php.net/array_filter)。沿线的东西

```
$movieName = 'The shining';
$result = array_filter($movies, filterCallback);

function filterCallback($var)
{
  foreach($var['matchedMovie'] as $movie) {
    if($movie['PatheMovie'] == $movieName) {
      return true;
    }
  }
} 
```

# ios - 如何制作“打开方式”或“共享”菜单

> ID：13980707
> 
> 赞同：0
> 
> 时间：2012-12-20T21:25:52.417
> 
> 标签：ios

如何制作“打开方式”菜单？你以前见过他们。照片、Instagram、电子邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:25:52.417

我曾经想知道如何制作 Apple 的“打开方式”菜单。这真的很容易！

```
 NSString* someText = @"Sent from my app!";
UIImage* image = imageview.image;
NSArray* dataToShare = @[someText, image];  //Array of sharable stuff.

UIActivityViewController* activityViewController = 
        [[UIActivityViewController alloc] initWithActivityItems:dataToShare 
        applicationActivities:nil];
[self presentViewController:activityViewController animated:YES completion:^{}]; 
```

就是这样。你真的不需要更多，因为它非常简单。

# c++ - 需要：用于维护一维范围列表的 C++ 类

> ID：13980709
> 
> 赞同：5
> 
> 时间：2012-12-20T21:26:04.617
> 
> 标签：c++, algorithm, stl-algorithm

我正在寻找一个可以维护一维范围列表的 C++ 类。

每个范围定义为一`(start,len)`对。

我希望能够向列表中添加其他范围并自动合并它们。也就是说，如果我们在列表中有`(0,5)`and并且被添加，那么新列表应该只包含.`(10,5)``(5,5)``(0,15)`

范围永远不会从列表中删除。

这样的事情存在吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:43:54.990

您正在寻找 Boost.Icl。它完全按照您的描述进行。

[http://www.boost.org/doc/libs/1_52_0/libs/icl/doc/html/index.html](http://www.boost.org/doc/libs/1_52_0/libs/icl/doc/html/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T00:52:48.997

这是一个简单的间隔容器的示例实现：

```
#include <iostream>
#include <vector>
#include <memory>
#include <algorithm>

using std::vector;
using std::pair;
using std::make_pair;

typedef pair<int, int> interval;    

struct interval_container
{
    void add(int start, int len)
    {
        _data.emplace_back( make_pair(start, len) );
    }

    void consolidate()
    {
        // sort intervals first by start then by length
        std::sort(_data.begin(), _data.end());

        // create temp data
        vector<interval> consolidated;

        // iterate over all sorted intervals
        for(const interval& i : _data)
        {
            int start = i.first;
            int len = i.second;

            // special case: first interval
            if (consolidated.empty())
            {
                consolidated.emplace_back(i);
            }
            // all other cases
            else
            {
                // get last interval in the consolidated array
                interval& last = consolidated.back();
                int& last_start = last.first;
                int& last_len = last.second;

                // if the current interval can be merged with the last one
                if ((start >= last_start) and (start < (last_start + last_len)))
                {
                    // merge the interval with the last one
                    last_len = std::max(last_len, (start + len - last_start));
                }
                // if the current interval can't be merged with the last one
                else
                {
                    consolidated.emplace_back(i);
                }
            }
        }

        // copy consolidated data
        _data = consolidated;
    }

    vector<interval>& data() { return _data; }

private:
    vector<interval> _data;
};

int main()
{
    interval_container intervals;

    intervals.add(0, 2);
    intervals.add(1, 3);
    intervals.add(5, 3);

    intervals.consolidate();

    int c(0);
    for(interval i : intervals.data())
    {
        std::cout << (c++) << ": from " << i.first << " to " << (i.first + i.second) << std::endl;
    }
} 
```

# php - 在我的 Wordpress 主页 (Index.php) 中显示特色图片的其他方式

> ID：13980712
> 
> 赞同：0
> 
> 时间：2012-12-20T21:26:07.173
> 
> 标签：php, wordpress

正如标题所暗示的，我正在寻找在我的主页或 index.php 中显示我的特色图像的其他方法/方式。

我已经尝试过使用：

```
add_theme_support( 'post-thumbnails' );
set_post_thumbnail_size( 150, 150, true ); // Normal post thumbnails
add_image_size( 'featured-thumbnail', 60, 60 ); // Featured thumbnail size 
```

但它不与我合作，它不遵循我指定的尺寸并且它不裁剪图像。我已经被困在这里好几天了。

您还有其他方法可以建议显示特色图片吗？非常感谢您，祝您有美好的一天！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T05:18:44.277

您发布的那些代码行只是设置您的主题以支持特色图像，它们实际上不会显示图像。

要显示图像，您需要使用[`the_post_thumbnail('featured-thumbnail')`](http://codex.wordpress.org/Function_Reference/the_post_thumbnail)或类似的功能。

您还应该知道，您的`add_image_size`代码还为**新上传**的图片设置了尺寸，*而不是*之前上传的图片。

这是一个常见问题，许多人在添加新图像大小时使用某种[调整大小插件来调整现有媒体的大小。](http://wordpress.org/extend/plugins/regenerate-thumbnails/)

# ruby-on-rails - 用于 RESTful API 测试的免费资源？

> ID：13980713
> 
> 赞同：0
> 
> 时间：2012-12-20T21:26:19.710
> 
> 标签：ruby-on-rails, api, rest

我想开始学习如何使用 ActiveResource 在我的 Rails 应用程序中进行 API 集成。

有谁知道我在修补时可以用来集成的 RESTful 数据源？我在网上看到的大多数 API 都需要某种形式的 oauth 或其他身份验证，我想要一个开放的 API，这样我就可以先使用 ActiveResource ——然后再处理整个身份验证问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T22:54:11.907

老实说，任何主要的 REST API 都需要 API 密钥、客户端 ID 或 OAuth 使用者密钥。

如果您在 Instagram 注册您的网站并获得一个客户 ID，那么您可以使用 REST API 通过 JSON 来“获取”照片和其他详细信息，如下所示：

`https://api.instagram.com/v1/media/popular?client_id={CLIENT-ID}`

如果您在 Tumblr 上注册，您可以获得一个 OAuth 使用者密钥（也称为 API 密钥），您可以使用它来“获取”Tumblr 博客上的信息，如下所示：

`https://api.tumblr.com/v2/blog/{base-hostname}/info?api_key={key}`

但是，如果您想测试 REST API 的 POST 操作，那么您将需要某种 OAuth 或类似的身份验证。

请注意，此问题提供了一个有用的解决方案，可以将 API 密钥或客户端 ID 附加到发出的任何 ActiveResource 请求：[将 api 密钥添加到 ActiveResource 中的每个请求](https://stackoverflow.com/questions/2918419/add-api-key-to-every-request-in-activeresource)。

# php - 为什么 YAML 没有按预期解析？

> ID：13980717
> 
> 赞同：1
> 
> 时间：2012-12-20T21:26:35.583
> 
> 标签：php, yaml

我有以下 YAML 我正在尝试用 SPYC 解析（[https://github.com/mustangostang/spyc/](https://github.com/mustangostang/spyc/)）：

```
children:
    - root:
        - child one
        - child two:
            - subchild one
            - subchild two
        - child three 
```

我希望它返回如下内容：

```
["children"]=>array(1){
    ["root"]=>array(3){
        [0]=>string(9) "child one",
        ["child two"]=>array(2){
            [0]=>string(12) "subchild one"
            [1]=>string(12) "subchild two"
        }
        [1]=>string(11) "child three"
    }
} 
```

相反，它返回类似这样的内容（包含似乎是一堆空且不必要的数组）：

```
array(4) {
  [0]=>
  array(4) {
    ["root"]=>
    array(0) {
    }
    [0]=>
    string(9) "child one"
    [1]=>
    array(3) {
      ["child two"]=>
      array(0) {
      }
      [0]=>
      string(12) "subchild one"
      [1]=>
      string(12) "subchild two"
    }
    [2]=>
    string(11) "child three"
} 
```

我构建 YAML 内容的方式是否有问题，或者 SPYC（解析器）是否存在已知问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:53:59.963

这是将生成您正在寻找的结构的 YAML

```
children:
    root:
        child one
        child two:
            subchild one
            subchild two
        child three 
```

在您的初始 YAML 中，`-`表示您正在启动一个列表/数组。例如，这个 YAML

```
items:
    - id: 1
      name: ABC

    - id: 2
      name: CDB 
```

生产

```
[items] => Array
    (
        [0] => Array
            (
                [id] => 1
                [name] => ABC
            )

        [1] => Array
            (
                [id] => 2
                [name] => CDB
            )

    ) 
```

# cuda - cuda glib 错误

> ID：13980719
> 
> 赞同：0
> 
> 时间：2012-12-20T21:26:38.050
> 
> 标签：cuda

下面是我希望工作的 cuda 代码。我收到“双重免费或损坏”错误。经过多次调试，我发现有问题的行是“cudaMemcpy（out，out_device ...）。我对为什么这个错误仍然存​​在感到完全傻眼。任何帮助都将不胜感激。ComplexFloat 的类型定义为 float2。

```
void covariance2(float alpha, complex float* in, complex float* out, int dims[5])
{
    int x = dims[0];
    int y = dims[1];
    int z = dims[2];
    int N = dims[3];
    int M = dims[4];

    ComplexFloat* in_device;
    ComplexFloat* out_device;
    int siz = x*y*z*N*(N+1)/2;
    assert(cudaMalloc(&in_device, sizeof(ComplexFloat)*x*y*z*N*M) == cudaSuccess);
    assert(cudaMalloc(&out_device, sizeof(ComplexFloat)*siz) == cudaSuccess);
    assert(cudaMemcpy(in_device, in, sizeof(ComplexFloat)*x*y*z*N*M, cudaMemcpyHostToDevice) == cudaSuccess);
    dim3 numBlocks(x,y,z);
    dim3 numThreads(1);
    size_t sharedMem = N*M + N*(N+1)/2;

    cudaMemcpy(out, out_device, sizeof(ComplexFloat)*siz, cudaMemcpyDeviceToHost);
    cudaFree(in_device);
    cudaFree(out_device);
}

int main()
    {
    int xxx = 2;
    int yyy = 2;
    int zzz = 1;
    int MMM = 7;
    int NNN = 3;
    int dims[5] = { xxx, yyy, zzz, MMM, NNN };
    float alpha = 5.;
    complex float a = 1.314 + 5.42*_Complex_I;
    complex float* in = (complex float*) malloc(sizeof(complex float)*NNN*MMM*xxx*yyy*zzz);
    for (int i = 0; i < xxx*yyy*zzz*MMM*NNN; i++)
        in[i] = a*pow(i,2);
    complex float* out = (complex float*) malloc(sizeof(complex float)*xxx*yyy*zzz*NNN*(NNN+1)/2);
    assert(out);
    covariance2(alpha, in, out, dims);
    for (int i = 0; i < NNN*(NNN+1)/2; i++)
        printf("i = %d, real = %f, imag = %f\n", i, __real__(out[i]), __imag__(out[i]));
    free(out);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T14:51:51.970

在你的`covariance2`函数中，你有：

```
int N = dims[3];
int M = dims[4]; 
```

但在你里面`main()`你有：

```
int dims[5] = { xxx, yyy, zzz, MMM, NNN }; 
```

请注意，M 是在 N 之前的参数`dims[]`

由于您的 malloc (of `out`) 和 cudaMalloc (of `out_device`) 依赖于 N，因此您使用 N（3 和 7）的两个不同值来计算大小。这意味着`out`并且`out_device`大小不同，我认为这不是您的意图。由于 (size of)`out`是用 3 的 N 计算的，并且 (size of)`out_device`是用 7 的 N 计算的，因此您正在尝试将较大的数据结构 cudaMemcpy 到较小的数据结构上。在 covariance2 中的修复大概是这样的：

```
int M = dims[3];
int N = dims[4]; 
```

# ruby-on-rails - ActiveModel 多步骤表单未显示下一步

> ID：13980721
> 
> 赞同：1
> 
> 时间：2012-12-20T21:26:40.203
> 
> 标签：ruby-on-rails, forms, routes, modal-dialog, activemodel

因此，我一直在使用 Active 模型在 ruby​​ on rails (1.9.3) 中处理多步骤表单，同时遵循 railscast #217 和 #219，并且在从 /awizard/ 路由到我的表单中的下一步时遇到问题/awizard/1 的新手希望有人可以帮助我。（我不能使用表单 gem，必须自己编写）我认为这是一个路由类型问题（我没有使用我给模型的 id，但我不知道应该在哪里使用它）有点帮助会不胜感激！

**我的控制器代码 - (contollers/awizard_controller.rb)**

```
class AwizardController < ApplicationController

  def new
    # New Asset Wizard
    @wizard = Awizard.new(id: 1)
    # Set session variable as initial step
    session[:wizard_step] = @wizard.current_step
  end

  def update
    @wizard = Awizard.new(id: 1) unless !@wizard.nil?
    @wizard.current_step = session[:wizard_step] unless nil

    if @wizard.valid?
      if params[:back_button]
        @wizard.previous_step
      elsif @wizard.last_step?
        @wizard.save if @wizard.all_valid?
      else
        @wizard.next_step
      end
      session[:wizard_step] = @wizard.current_step
    end

    if @wizard.changed?
      render 'form'
    else
      @wizard.save
    end
  end

  def show
    render 'form'
  end

end 
```

**我的模型 - (models/awizard.rb)**

```
class AWizard
include ActiveModel::Validations
include ActiveModel::Conversion
include ActiveModel::Dirty
include ActiveModel::Naming

#This class is used to manage the wizard steps using ActiveModel (not ActiveRecord)

attr_accessor :id
attr_writer :current_step  #used to write to current step
define_attribute_methods [:current_step] #used for marking change

def initialize(attributes = {})
   attributes.each do |name, value|
     send("#{name}=", value)
   end
end

def current_step
  @current_step || steps.first
end

def steps
  %w[step1 step2 step3] #make list of steps (partials)
end

def next_step
  current_step_will_change! #mark changed when moving stepped
  self.current_step = steps[steps.index(current_step)+1] unless last_step?
end

def previous_step
  current_step_will_change! #mark changed when moving stepped
  self.current_step = steps[steps.index(current_step)-1] unless first_step?
end

def first_step?
  current_step == steps.first
end

def last_step?
  current_step == steps.last
end

def all_valid?
  steps.all? do |step|
    self.current_step = step
    valid?
  end
end

def step(val)
  current_step_will_change!
  self.current_step = steps[val]
end

def persisted?
  self.id == 1
end

def save
 #will do later
end

end 
```

**我的观点 -** **(/views/awizard/_form.html.erb)**

```
<%=  content_for :awizard_form do%>
  <%= form_for(@wizard) do |f| %>
    <%= render "#{@wizard.current_step}_step", :f => f %>
    <%= f.submit "Previous", :name => "back_button" unless @wizard.first_step? %>
    <%= f.submit "Continue", :name => "step" unless @wizard.last_step? %>
  <% end %>
<% end %> 
```

**(/views/awizard/_step1.html.erb)**

```
<div class="field">
  <%= f.label 'Step1' %><br />
</div> 
```

**(/views/awizard/_step2.html.erb)**

```
<div class="field">
  <%= f.label 'Step2' %><br />
</div> 
```

**(/views/awizard/_step3.html.erb)**

```
<div class="field">
  <%= f.label 'Step3' %><br />
</div> 
```

**路线代码**

```
resources :awizard 
```

**错误消息** 单击第一个继续按钮后我得到的错误消息是这样的 - “模板丢失

缺少模板向导/表单，带有 {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]} 的应用程序/表单。搜索：*“fakepath/app/views”

更深入的错误日志如下所示 -

在 2013-01-07 10:12:06 +1300 开始为 127.0.0.1 PUT "/awizard/1" 由 AwizardController#update 作为 HTML 参数处理：{"utf8"=>"✓", "authenticity_token"=>" ", "awizard"=>{"data"=>"data"}, "step"=>"Continue", "id"=>"1"} 1ms 内完成 500 内部服务器错误

ActionView::MissingTemplate（缺少模板向导/表单，应用程序/表单，带有 {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}。搜索：*“fakepath/app/views”）：app/controllers/awizard_controller.rb:40:in `update'

在救援/布局中渲染 fakepath/gems/actionpack-3.2.2/lib/action_dispatch/middleware/templates/rescues/missing_template.erb (0.6ms)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:58:58.620

错误消息指出，目录中没有名称`form`的部分`awizard`。你应该遵守 Rails 关于部分的约定——部分文件总是以下划线为前缀。

在您的情况下，尝试重命名`form.html.erb`为`_form.html.erb`.

编辑：您可以尝试像这样渲染您的部分

```
render :partial => 'awizard/form' 
```

# c++ - 受保护的成员可以在非直系后代中访问吗？

> ID：13980722
> 
> 赞同：1
> 
> 时间：2012-12-20T21:26:46.003
> 
> 标签：c++

根据[http://en.cppreference.com/w/cpp/language/access](http://en.cppreference.com/w/cpp/language/access)，

> 受保护的成员可在类及其方法及其后代中访问

它们是指*直系*后代，而不是后代的后代，还是指*所有*后代？

例如，如果类 C 是 B 的子类，而 B 是具有受保护成员的 A 的子类，那么 B 显然可以访问它，但是 C 呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T21:29:36.377

受保护的成员对所有后代都可用，直到/除非您达到使用私有继承的地步。因此，只要您的 A、B 和 C 都使用公共继承（或受保护的继承，尽管这种情况很少到几乎可以忽略），那么是的，最派生的仍然可以使用来自最基类的受保护成员（并且如果有 D、E 和 F，同样如此）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T21:29:41.260

所有的后代。

另外，有时您应该自己尝试一下，在某个地方创建一个 main.cpp 并尝试一下。这样你学得最多。

（当然，我在这里假设您一直使用公共派生，因为您没有另外指定）

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:28:45.677

> 他们只指直系后代吗？

否 - 后代的后代，后代的后代，等等，也符合条件。他们都可以访问所有基类的受保护成员，一直到继承链。

```
class A {
protected:
    int val;
public:
    A(int x) : val(x) {}
};

struct B : public A {
    B(int x) : A(x) {}
};

struct C : public B {
    C(int x) : B(x) {}
    void show() {
        cout << val << endl;
    }
};

int main() {
    C c(123);
    c.show();
    return 0;
} 
```

以上[编译并打印`123`](http://ideone.com/HZLPKN)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T21:29:47.413

受保护的方法在第一个后代中是受保护的或私有的（取决于后代的继承方式）。从那里开始，他们的状态被确定为根据继承规则他们是该类的成员。

例子：

```
class A{
   protected: int var;
}

class B : private A{
}

class C : protected A{
}

class D : public A{
} 
```

In`C`和`D`变量`var`是受保护的，在`B`其私有中，不能被进一步的后代看到。

# iphone - 这个平移手势识别器动作有什么问题？

> ID：13980723
> 
> 赞同：3
> 
> 时间：2012-12-20T21:26:52.933
> 
> 标签：iphone, objective-c, ios, ipad

我不确定为什么当我移动视图时这不会平移？

```
CGPoint translation = [recognizer translationInView:self.view];

    if ((recognizer.view.frameY + translation.y >= self.view.frameHeight - recognizer.view.frameHeight)) {
        CGPoint newOrigin = CGPointMake(self.view.bounds.size.width, roundf(recognizer.view.frameY + translation.y));
        recognizer.view.frameOrigin = newOrigin;
        NSLog(@"FRAME ORIGIN %@", NSStringFromCGPoint(recognizer.view.frameOrigin));
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T18:36:36.673

我不清楚你的一些自定义变量等，所以我没有调试你的代码，我想我会告诉你我如何使用`UIPanGestureRecognizer`.

因此，假设 (a) 手势已添加到被拖动的视图中；(b) 该视图包含在您想要约束视图移动的超级视图中，代码可能如下所示：

```
- (void)handlePan:(UIPanGestureRecognizer *)gesture
{
    static CGRect originalFrame;

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        originalFrame = gesture.view.frame;
    }
    else if (gesture.state == UIGestureRecognizerStateChanged)
    {
        CGPoint translate = [gesture translationInView:gesture.view.superview];
        CGRect newFrame = CGRectMake(originalFrame.origin.x + translate.x,
                                     originalFrame.origin.y + translate.y,
                                     originalFrame.size.width,
                                     originalFrame.size.height);

        if (CGRectContainsRect(gesture.view.superview.bounds, newFrame))
            gesture.view.frame = newFrame;
    }
} 
```

虽然上述内容具有一定的简单性，但我认为我们可以改善用户体验。值得注意的是，如果用户将视图拖到它的超级视图之外，上面的代码将不会做任何事情（例如，拖过左边框并冻结在那里，即使您上下移动手指；不是很优雅）。我认为以下是一个更优雅的用户界面（但阅读代码有点复杂），当用户拖动手指时，我们会将对象拖动到超级视图中与用户的手指是。

```
- (void)handlePan:(UIPanGestureRecognizer *)gesture
{
    static CGRect originalFrame;

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        originalFrame = gesture.view.frame;
    }
    else if (gesture.state == UIGestureRecognizerStateChanged)
    {
        CGPoint translate = [gesture translationInView:gesture.view.superview];
        CGRect newFrame = CGRectMake(fmin(gesture.view.superview.frame.size.width - originalFrame.size.width, fmax(originalFrame.origin.x + translate.x, 0.0)),
                                     fmin(gesture.view.superview.frame.size.height - originalFrame.size.height, fmax(originalFrame.origin.y + translate.y, 0.0)),
                                     originalFrame.size.width,
                                     originalFrame.size.height);

        gesture.view.frame = newFrame;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T05:19:55.203

是否调用了平移手势方法？如果未设置启用用户交互。你可以使用下面的代码。

```
- (void)handlePan:(UIPanGestureRecognizer *)recognizer {

CGPoint translation = [recognizer translationInView:recognizer.view.superview];

recognizer.view.center = CGPointMake(recognizer.view.center.x + translation.x, 
                                     recognizer.view.center.y + translation.y);
[recognizer setTranslation:CGPointMake(0, 0) inView:recognizer.view.superview];

if (recognizer.state == UIGestureRecognizerStateEnded) {

    CGPoint velocity = [recognizer velocityInView:recognizer.view.superview];
    CGFloat magnitude = sqrtf((velocity.x * velocity.x) + (velocity.y * velocity.y));
    CGFloat slideMult = magnitude / 200;
    NSLog(@"magnitude: %f, slideMult: %f", magnitude, slideMult);

    float slideFactor = 0.1 * slideMult; // Increase for more of a slide
    CGPoint finalPoint = CGPointMake(recognizer.view.center.x + (velocity.x * slideFactor), 
                                     recognizer.view.center.y + (velocity.y * slideFactor));
    finalPoint.x = MIN(MAX(finalPoint.x, 0), recognizer.view.superview.bounds.size.width);
    finalPoint.y = MIN(MAX(finalPoint.y, 0), recognizer.view.superview.bounds.size.height);

    [UIView animateWithDuration:slideFactor*2 delay:0 options:UIViewAnimationOptionCurveEaseOut animations:^{
        recognizer.view.center = finalPoint;
    } completion:nil];

} 

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:32:54.807

在`if`你应该写`<=`而不是`>=`，因为原点在左上角

# java - 在Java/eclipse中使用Search Engine实现调用层次结构（获取调用某个方法的所有方法）

> ID：13980726
> 
> 赞同：3
> 
> 时间：2012-12-20T21:27:06.523
> 
> 标签：java, eclipse, search

我有一个名为“javaProject”的 Java 项目，它有两个类 Hello 和 ReferenceHello。

![在此处输入图像描述](../Images/f4dc24aa221bebbe898f5daa58c59fa6.png)

你好.java

```
package com.prosseek.test;

public class Hello {
    public void world()
    {
        System.out.println("Hello world");
    }

    public void referWorld()
    {
        world();
    }
} 
```

参考Hello.java

```
package com.prosseek.test;

public class ReferenceHello {
    public void referWorld()
    {
        Hello h = new Hello();
        h.world();
    }
} 
```

我可以使用 Search/Java 对话框找到所有引用（或调用）Hello.world() 的方法。

![在此处输入图像描述](../Images/67acbd09d232e2ef529308a3ac2ac0c4.png)

我想以编程方式使用`Search Engine`. 这是我想出的代码，但是它什么也没返回。

```
public void testIt() throws CoreException {
    String projectName = "javaProject";
    IJavaProject javaProject = JavaProjectHelper.createJavaProject(projectName);

    String targetMethodName = "world";
    SearchPattern pattern = SearchPattern.createPattern(
            targetMethodName, 
            IJavaSearchConstants.METHOD, 
            IJavaSearchConstants.REFERENCES,
            SearchPattern.R_CASE_SENSITIVE // <--- ????
            );

    boolean includeReferencedProjects = false;
    IJavaElement[] javaProjects = new IJavaElement[] {javaProject};
    IJavaSearchScope scope = SearchEngine.createJavaSearchScope(javaProjects, includeReferencedProjects); // <--- ????

    SearchRequestor requestor = new SearchRequestor() {
        @Override
        public void acceptSearchMatch(SearchMatch match)
                throws CoreException {
            System.out.println(match.getElement());
        }
    };
    SearchEngine searchEngine = new SearchEngine();
    searchEngine.search(
            pattern, 
            new SearchParticipant[] { SearchEngine.getDefaultSearchParticipant()}, 
            scope, 
            requestor, 
            null);      
} 
```

*   我的搜索代码可能有什么问题？
*   还有其他方法可以通过编程方式在 Eclipse 插件中获取调用层次结构吗？

## 添加

搜索代码工作正常，问题在于我错误地使用了[JavaProjectHelper.createJavaProject](http://alvinalexander.com/java/jwarehouse/eclipse/org.eclipse.jdt.debug.tests/test-plugin/org/eclipse/jdt/debug/testplugin/JavaProjectHelper.java.shtml)。我应该打开现有的 java 项目，而不是创建一个同名的项目。结果，.metadata 被破坏并且没有搜索任何内容。

使用我的新 getJavaProject 方法，现在一切正常。

```
private IJavaProject getJavaProject(String projectName) throws CoreException
{
    IWorkspaceRoot root= ResourcesPlugin.getWorkspace().getRoot();
    IProject project= root.getProject(projectName);
    if (!project.exists()) {
        project.create(null);
    } else {
        project.refreshLocal(IResource.DEPTH_INFINITE, null);
    }

    if (!project.isOpen()) {
        project.open(null);
    }

    IJavaProject jproject= JavaCore.create(project);

    return jproject;    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T16:10:39.623

从[这个网站](http://www.programcreek.com/2011/07/find-all-callers-of-a-method/)的暗示。我可以使用 CallHierarchy API。

## getCallersOf() 方法

```
package com.prosseek.asttest;

// http://www.programcreek.com/2011/07/find-all-callers-of-a-method/
import java.util.HashSet;

import org.eclipse.core.runtime.NullProgressMonitor;
import org.eclipse.jdt.core.IJavaElement;
import org.eclipse.jdt.core.IMember;
import org.eclipse.jdt.core.IMethod; 
import org.eclipse.jdt.internal.corext.callhierarchy.CallHierarchy;
import org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper;

public class CallHierarchyGenerator {
public HashSet<IMethod> getCallersOf(IMethod m) {

    CallHierarchy callHierarchy = CallHierarchy.getDefault();

    IMember[] members = { m };

    MethodWrapper[] methodWrappers = callHierarchy.getCallerRoots(members);
    HashSet<IMethod> callers = new HashSet<IMethod>();
    for (MethodWrapper mw : methodWrappers) {
        MethodWrapper[] mw2 = mw.getCalls(new NullProgressMonitor());
        HashSet<IMethod> temp = getIMethods(mw2);
        callers.addAll(temp);
    }

    return callers;
}

HashSet<IMethod> getIMethods(MethodWrapper[] methodWrappers) {
    HashSet<IMethod> c = new HashSet<IMethod>();
    for (MethodWrapper m : methodWrappers) {
        IMethod im = getIMethodFromMethodWrapper(m);
        if (im != null) {
            c.add(im);
        }
    }
    return c;
}

IMethod getIMethodFromMethodWrapper(MethodWrapper m) {
    try {
        IMember im = m.getMember();
        if (im.getElementType() == IJavaElement.METHOD) {
            return (IMethod) m.getMember();
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}
} 
```

findMethod 实用程序

```
IMethod findMethod(IType type, String methodName) throws JavaModelException
{
    //IType type = project.findType(typeName);

    IMethod[] methods = type.getMethods();
    IMethod theMethod = null;

    for (int i = 0; i < methods.length; i++)
    {
        IMethod imethod = methods[i];
        if (imethod.getElementName().equals(methodName)) {
            theMethod = imethod;
        }
    }

    if (theMethod == null)
    {           
        System.out.println("Error, method" + methodName + " not found");
        return null;
    }

    return theMethod;
} 
```

## 用途

```
 CallHierarchyGenerator callGen = new CallHierarchyGenerator();

    IMethod m = findMethod(type, "world");
    Set<IMethod> methods = new HashSet<IMethod>();
    methods = callGen.getCallersOf(m);
    for (Iterator<IMethod> i = methods.iterator(); i.hasNext();)
    {
        System.out.println(i.next().toString());
    } 
```

## 结果

```
void referWorld() {key=Lcom/prosseek/test/ReferenceHello;.referWorld()V} [in ReferenceHello [in ReferenceHello.java [in com.prosseek.test [in src [in javaTest]]]]]
void referWorld() {key=Lcom/prosseek/test/Hello;.referWorld()V} [in Hello [in Hello.java [in com.prosseek.test [in src [in javaTest]]]]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T00:40:47.320

在创建搜索范围的方法中设置断点并在调试模式下启动运行时工作台。当您在那里调用 Call Hierarchy 时，它应该停止并让您确切地看到它是如何完成的。

# php - REGEX 测试字符串中的所有字符

> ID：13980736
> 
> 赞同：2
> 
> 时间：2012-12-20T21:27:30.187
> 
> 标签：php, regex

我正在使用代码（在底部）来测试一些非美国字符的字符串，返回以下代码：

```
int(1)
int(1)
int(1) 
```

我正在寻找的结果是第一个和第三个转储应该是 0，第二个转储应该是 1，如下所示：

```
int(0)
int(1)
int(0) 
```

这是我的测试代码：

```
<?php
$str[] = '漢語';
$str[] = 'abc123';
$str[] = '漢語abc123';
var_dump(preg_match("/\p{Common}+/u", $str[0]));
var_dump(preg_match("/\p{Common}+/u", $str[1]));
var_dump(preg_match("/\p{Common}+/u", $str[2])); 
```

现在它只是测试是否有 1 个美国字符，但我需要测试所有字符。我可以做些什么来测试所有字符以获得预期的输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:21:48.697

我不确定你想要达到什么，你期望`\p{common}`匹配什么。我从未使用过它，我不确定该脚本中包含什么。

也许像这样的课程`[\p{Latin}\p{Nd}]`会更符合您的要求？

`\p{Latin}`是拉丁字符，不确定它包括什么，快​​速测试表明，例如ÖÄÜ也包括在内

`\p{Nd}`一个数字 0-9

有关更多信息，请查看 regular-expressions.info 上的[Unicode 正则表达式](http://www.regular-expressions.info/unicode.html)

因此，这会带来您的预期结果：

```
$str[] = '漢語';
$str[] = 'abc123';
$str[] = '漢語abc123';
var_dump(preg_match("/^[\p{Latin}\p{Nd}]+$/u", $str[0]));
var_dump(preg_match("/^[\p{Latin}\p{Nd}]+$/u", $str[1]));
var_dump(preg_match("/^[\p{Latin}\p{Nd}]+$/u", $str[2])); 
```

# php - 查询不会插入到表中

> ID：13980737
> 
> 赞同：0
> 
> 时间：2012-12-20T21:27:30.340
> 
> 标签：php, sql

在你们问任何人之前，我有一个可以打印完美信息的数组。我有一个 implode 语句和一个 insert 语句，它们似乎不起作用，我不知道问题出在哪里。

返回一个没有任何信息的空白网页。我的代码有问题吗？

我的代码如下。有任何想法吗？

```
$data = '"' . implode('" , "', $news_stories) . '"';
$query = mysql_query("INSERT INTO news_story (`title`, `description`, `keywords`, `link`) VALUES (" . $data . ")")or die(mysql_error()); 
```

什么都没有返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:33:00.843

在您的查询末尾添加`or die(mysql_error())`以查看究竟是什么问题。

```
$query = mysql_query("INSERT INTO news_story (`title`, `description`, `keywords`, `link`) VALUES (" . $data . ")") or die(mysql_error()); 
```

我认为问题出在 implode 函数上，但由于我不知道里面有什么数据，所以我不能肯定地说。

# css - 为同样在两个单独的样式表中定义的元素定义样式

> ID：13980738
> 
> 赞同：0
> 
> 时间：2012-12-20T21:27:31.857
> 
> 标签：css

我经常在一个样式表需要完整构建和部署才能更新的网站上工作，这是一个很大的麻烦，不值得更新一些基本的东西，比如链接样式。

我有一种方法可以通过 CMS 应用我自己的样式以避免完整的构建和部署，但是如果样式已经在其中一张表中定义，或者使用更具体的选择器，我必须用 !important 覆盖。

我不相信使用 !important 会产生负面影响，尽管我知道这不是最佳实践，因为它可能很难维护。但这是一个我不确定的例子。假设我有这段 HTML：

```
 <p class="snaps">
                This is a bit of text followed <a class="snaps-link">by a link</a>
            </p> 
```

在一个样式表中，我们有：

```
 .snaps {text-align: center; font-weight: bold;} 
```

在另一个样式表中， a 元素的定义如下：

```
 a { outline: none; color: #6D6E71; text-decoration: none;} 
```

我想在 CMS 中编写这样的样式（通过外部或内部样式表）：

```
 p.snaps a.snaps-link{color: orange; text-decoration: underline; font-weight: normal;} 
```

这样做有问题吗？我是公司里唯一一个对编码一无所知的人，所以我没有人可以从中汲取灵感。所以我来找你......有兴趣听听任何人的想法。

我遇到的另一个问题是我经常被要求删除元素。通常最简单的方法是使用 display: none 并隐藏它们。我认为如果我隐藏文本可能会受到 SEO 处罚，但还有其他我不知道的后果吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:59:22.463

这个 CSS 没有任何问题：

```
p.snaps a.snaps-link{color: orange; text-decoration: underline; font-weight: normal;} 
```

你在那里使用的是一个*组合*器，它是完全合法的。[在此处阅读有关组合器的更多信息。](http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#combinators)

你的方法`display: none;`是一个很好的解决方案。这样做不应该有任何后果，这会对你产生任何重大的负面影响。如果您可以通过 CMS 注入 JavaScript，则可以[使用它来完全删除元素](https://stackoverflow.com/questions/8830839/javascript-dom-remove-element)。

# python - DBus-Python 网络管理器脚本 - WpaFlags 问题

> ID：13980741
> 
> 赞同：2
> 
> 时间：2012-12-20T21:27:48.593
> 
> 标签：python, dbus

我正在 DBus-python 中编写一个 python 脚本，用于通过网络管理器获取有关可用接入点的一些信息。我可以正确获取 ssid、mac 地址、信号强度值。尽管当我尝试获取 WpaFlags 时，我只得到了一些整数值。我想，我应该知道如何使用“NM_802_11_AP_SEC”，但我不知道如何使用。我会很感激任何建议。

可读结果：

```
ssid = ap_prop_iface.Get("org.freedesktop.NetworkManager.AccessPoint","Ssid",byte_arrays=True)
hwaddr = ap_prop_iface.Get("org.freedesktop.NetworkManager.AccessPoint", "HwAddress") 
```

不可读的结果：

```
encryption = ap_prop_iface.Get("org.freedesktop.NetworkManager.AccessPoint", "WpaFlags") 
```

如果没有加密，则 encryption=0 - 没关系 - 我得到的其他结果是 324 和 392

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T14:37:09.633

WpaFlags（和其他 *Flags）是一个由位标志组成的整数，这里[是 NM_802_11_AP_SEC](http://projects.gnome.org/NetworkManager/developers/api/09/spec.html#type-NM_802_11_AP_SEC)。所以 324 ix 0x144（十六进制），即 NM_802_11_AP_SEC_KEY_MGMT_PSK | NM_802_11_AP_SEC_GROUP_TKIP | NM_802_11_AP_SEC_PAIR_TKIP。

这是一个关于位标志的一般问题：[按位操作和使用](https://stackoverflow.com/questions/1746613/bitwise-operation-and-usage)。

例子：

```
NM_802_11_AP_SEC_PAIR_TKIP = 0x04  // declare other constants too...
flags = 324                        // from an API call really
if flags & NM_802_11_AP_SEC_PAIR_TKIP:
    print "PAIR_TKIP is enabled" 
```

# jquery - jquery mobile css不会从本地加载，只能从网络加载

> ID：13980742
> 
> 赞同：2
> 
> 时间：2012-12-20T21:27:51.323
> 
> 标签：jquery, css, mobile

一定有人能回答这个问题，这让我发疯了！！！

我正在测试一个 jquery 移动页面，并在我的 index.html 页面中有以下内容：

```
<link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css" />
<script src="js/jquery-1.8.2.min.js"></script>
<script src="js/jquery.mobile-1.2.0.min.js"></script> 
```

它不起作用。该页面无法识别 css 或 js。但是当我通过网络加载它时，它可以工作：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

我一遍又一遍地复制和下载这些文件，以检查我是否拥有正确的本地文件。为什么它会从外部 URL 加载而不是我的本地文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:32:02.477

如果您的项目根目录中有一个 js 文件夹和一个 css 文件夹，请添加前导“/”。前导斜杠将从域的开头开始。

```
<link rel="stylesheet" href="/css/jquery.mobile-1.2.0.min.css" />
<script src="/js/jquery-1.8.2.min.js"></script>
<script src="/js/jquery.mobile-1.2.0.min.js"></script> 
```

# java - 如何在 Tomcat 中启动 Mule？

> ID：13980743
> 
> 赞同：1
> 
> 时间：2012-12-20T21:27:51.637
> 
> 标签：java, web-services, soap, mule, spring-3

我是 mule 的新手，并尝试使用 mule 编排 Web 服务。我编写了一个简单的 web 服务，但是当我尝试在 tomcat 中部署 mule web 项目时，我得到了这个日志语句。

```
21 Dec, 2012 2:44:59 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jdk1.6.0_27\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\oraclexe\app\oracle\product\10.2.0\server\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\WIDCOMM\Bluetooth Software\;C:\Program Files\WIDCOMM\Bluetooth Software\syswow64;;C:\Program Files\Dell\DW WLAN Card;.
21 Dec, 2012 2:45:00 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:PosMuleService' did not find a matching property.
21 Dec, 2012 2:45:00 AM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
21 Dec, 2012 2:45:00 AM org.apache.coyote.ajp.AjpProtocol init
INFO: Initializing Coyote AJP/1.3 on ajp-8009
21 Dec, 2012 2:45:00 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 770 ms
21 Dec, 2012 2:45:00 AM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
21 Dec, 2012 2:45:00 AM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.4
21 Dec, 2012 2:45:13 AM org.apache.catalina.core.ApplicationContext log
INFO: No Spring WebApplicationInitializer types detected on classpath
21 Dec, 2012 2:45:13 AM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
21 Dec, 2012 2:45:13 AM org.apache.coyote.ajp.AjpProtocol start
INFO: Starting Coyote AJP/1.3 on ajp-8009
21 Dec, 2012 2:45:13 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 13237 ms 
```

这是我的 web.xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
  version="3.0"  metadata-complete="true">
  <display-name>PosMuleService</display-name>

  <context-param>
    <param-name>org.mule.config</param-name>
    <param-value>/WEB-INF/spring-servlet.xml,/WEB-INF/maf_services.xml</param-value>
  </context-param>

  <listener>
    <listener-class>org.mule.config.builders.MuleXmlBuilderContextListener</listener-class>
  </listener>

</web-app> 
```

这是我的 spring-servlet.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<!-- START SNIPPET: beans -->
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jaxws="http://cxf.apache.org/jaxws"
    xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd">
</beans> 
```

这是我的 maf_services.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:cxf="http://www.mulesoft.org/schema/mule/cxf"
xmlns:http="http://www.mulesoft.org/schema/mule/http"
xmlns:spring="http://www.springframework.org/schema/beans"
xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.mulesoft.org/schema/mule/cxf http://www.mulesoft.org/schema/mule/cxf/3.4/mule-cxf.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/3.4/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.4/mule.xsd">

  <flow name="helloService">
    <http:inbound-endpoint address="http://localhost:8080/PosMuleService/hello" exchange-pattern="request-response">
        <cxf:simple-service serviceClass="org.example.HelloWorld"/>
    </http:inbound-endpoint>
    <component class="org.example.HelloWorldImpl" /> 
  </flow>
  </mule> 
```

这是我的 HelloWorld Impl

```
/**
 * 
 */
package org.example;

import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;

/**
 * @author 
 *
 */
@WebService(endpointInterface = "org.example.HelloWorld",
serviceName = "HelloWorld")
public class HelloWorldImpl implements HelloWorld {

    /* (non-Javadoc)
     * @see org.example.HelloWorld#sayHi(java.lang.String)
     */
    @WebMethod(operationName="sayHi")
    public @WebResult(name="sayHiResult")String sayHi(@WebParam(name="text")String text) {
        // TODO Auto-generated method stub
        return "Hi "+text;
    }

} 
```

这是我的 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>PosMuleService</groupId>
  <artifactId>PosMuleService</artifactId>
  <packaging>war</packaging>
  <version>0.0.1-SNAPSHOT</version>
  <name>PosMuleService Maven Webapp</name>
  <url>http://maven.apache.org</url>
<dependencies>
    <dependency>
      <groupId>org.codehaus.groovy</groupId>
      <artifactId>groovy-all</artifactId>
      <version>1.8.1</version>
    </dependency>

    <dependency>
        <groupId>org.mule.modules</groupId>
        <artifactId>mule-module-builders</artifactId>
        <version>3.4-M1</version>
    </dependency>
    <dependency>
        <groupId>org.mule</groupId>
        <artifactId>mule-core</artifactId>
        <version>3.4-M1</version>
    </dependency>
    <dependency>
        <groupId>org.mule.modules</groupId>
        <artifactId>mule-module-scripting</artifactId>
        <version>3.4-M1</version>
    </dependency>
    <dependency>
        <groupId>org.mule.transports</groupId>
        <artifactId>mule-transport-vm</artifactId>
        <version>3.4-M1</version>
    </dependency>
    <dependency>
        <groupId>org.mule.transports</groupId>
        <artifactId>mule-transport-servlet</artifactId>
        <version>3.4-M1</version>
    </dependency>
    <dependency>
        <groupId>org.mule.transports</groupId>
        <artifactId>mule-transport-stdio</artifactId>
        <version>3.4-M1</version>
    </dependency>
    <dependency>
        <groupId>asm</groupId>
        <artifactId>asm-commons</artifactId>
        <version>3.3.1</version>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.14</version>
    </dependency>
</dependencies>

  <repositories>
    <repository>
      <id>mule-deps</id>
      <name>Mule Dependencies</name>
      <url>http://dist.codehaus.org/mule/dependencies/maven2</url>
    </repository>
  </repositories>
  <build>
    <finalName>PosMuleService</finalName>
  </build>
</project> 
```

我正在使用tomcat7.0和eclipse juno ..知道为什么我的骡子没有正常启动..我既看不到服务也看不到wsdl ..获取404的URL

```
http://localhost:8080/PosMuleService/hello 
```

注意在服务器日志中我得到了这一行：`INFO: No Spring WebApplicationInitializer types detected on classpath` 但我在 WEB-INF 中添加了 spring-servlet.xml 文件，也尝试使用上下文加载器但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:36:01.987

几个问题：

*   不要使用 Mule 加载 Spring 配置文件：`/WEB-INF/spring-servlet.xml`从`param-value`
*   在 Web 容器中运行时不要使用 HTTP 入站端点：Mule 将尝试在此端口上启动 Web 服务器。而是使用 servlet 入站端点，以便 Mule 通过 Web 容器处理的 servlet 进行侦听。

在你的情况下使用：

```
<servlet:inbound-endpoint path="hello" /> 
```

*   将 Mule servlet 添加到您的 web.xml。

像这样：

```
<servlet>
    <servlet-name>muleServlet</servlet-name>
    <servlet-class>org.mule.transport.servlet.MuleReceiverServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>muleServlet</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T08:41:57.310

我可以确认您要在 tomcat 上部署的应用程序有效。

在 David 提出的更改旁边，我将流定义更改如下：

```
<flow name="helloService">
    <servlet:inbound-endpoint path="hello" />
    <component class="org.example.HelloWorldImpl" />
</flow> 
```

在这里，您不需要任何 Spring。如果要使用 Spring，请在 mule 配置中定义以下组件：

```
<spring:beans>
    <spring:import resource="classpath:applicationContext.xml"/>
</spring:beans> 
```

确保您的 Spring applicationContext 在您的类路径中。（例如，在 maven 文件结构中，将您的 applicationContext 放在 src/main/resources/ 中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T05:15:35.993

是的，我做到了，但采用了不同的方法。我无法使用tomcat做到这一点。可能我们不应该在 tomcat 上运行 mule，因为我们必须依赖 servlet 线程进行处理，我认为这会降低性能。如果我错了，请纠正我。我在某处读到这个。我已经安装了 mule studio 并创建了一个 mule 项目将`maf_Services.xml`和 webservices 代码添加到 mule studio 项目并将该项目作为 mule 应用程序执行。在生产环境中，我将使用 mule studio 导出我的 mule 项目，并使用 mule 独立服务器部署我的应用程序。

# python - 如何使用正则表达式找出 Python 列表中的任何一项是否在字符串中？

> ID：13980744
> 
> 赞同：-1
> 
> 时间：2012-12-20T21:27:57.283
> 
> 标签：python, regex, string, list

我有一个列表，我想知道该列表中的任何一项是否在使用正则表达式的字符串中。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:30:17.123

当然。

```
myregex = re.compile(...)
print any(myregex.search(s) for s in my_list_of_strings) 
```

或许：

```
regexs = [re.compile(s) for s in my_list_of_regex_strings]
any(r.search(my_string) for r in regexs) 
```

我想这可能与以下内容相同：

```
regex_str = '|'.join('(?:%s)'%re.escape(s) for s in list_of_regex_strings)
re.search(regex_str,my_string) 
```

我仍然无法判断您要尝试哪种方式...

最后，如果你真的想知道哪个正则表达式匹配：

```
next(regex_str for regex_str in regex_str_list if re.search(regex_str,mystring)) 
```

如果没有正则表达式匹配，这将引发`StopIteration`异常（您可以捕获）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:43:33.977

我假设 OP 正在询问如何*找出字符串列表中的任何一项是否与使用 regex 的模式匹配*。

```
# import the regex module
import re

# some sample lists of strings
list1 = ['Now', 'is', 'the', 'time', 'for', 'all', 'good', 'men']
list2 = ['Me', 'Myself', 'I']

# a regex pattern to match against (looks for words with internal vowels)
pattern = '.+[aeiou].+'

# use any() around a list comprehension to determine
# if any match via the re.match() function
any(re.match(pattern, each) for each in list1)

# if you're curious to determine just what is matching your expression, use filter()
list(filter(lambda each: re.match(pattern, each) , list2)) 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-20T21:30:31.527

```
for each item in list:
   use regex on string 
```

鉴于您的问题的普遍性，这尽可能具体。

编辑：这是伪代码，而不是 python

# c# - 更新带有自引用表的 LINQ 记录时出现 StackOverFlowException

> ID：13980749
> 
> 赞同：2
> 
> 时间：2012-12-20T21:28:19.593
> 
> 标签：c#, asp.net, c#-4.0, linq-to-sql

当我更新包含自定义/非数据库属性的记录时，我收到了 StackOverflowException。这些属性着眼于数据库属性，最重要的是，相关记录中的值。

相关的记录就是问题——TaskTemplateRecord 的集合被遗忘了。

如果我在这里只返回 0，一切都很好。我认为下面是一遍又一遍地调用 TaskTemplateRecord。我只是想不通为什么。

我该如何解决？有没有办法告诉 LINQ 在更新操作期间跳过这样的属性？

```
 if (this == new ProjectTask()) return 0; 
```

有没有办法轻松比较上述值？这也可能奏效。

```
 public int UnitTypeId
    {
        get
        {
            //return 0;

            //If this is a task template return the actual database value
            if (IsTaskTemplate)
                return UnitTypeIdPrivate;
            //If there is a task template override and UnitTypeId has a value return that
            else if (IsTemplateOverride && UnitTypeIdPrivate != 0)
                return UnitTypeIdPrivate;

            //Else return the value in the task template record.
            return (TaskTemplateRecord ?? new ProjectTask()).UnitTypeId;
        }
        set { UnitTypeIdPrivate = value; }
    } 
```

这是抛出 StackOverFlowException 的地方。

```
 public ProjectTask()
    {
            ...
            this._ProjectTasksUsingThisTemplate = new EntitySet<ProjectTask>(new Action<ProjectTask>(this.attach_ProjectTasksUsingThisTemplate), new Action<ProjectTask>(this.detach_ProjectTasksUsingThisTemplate));
            ...
            } 
```

一如既往地感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:52:10.487

看来这条线可能是问题所在：

```
return (TaskTemplateRecord ?? new ProjectTask()).UnitTypeId; 
```

我在猜测您显示的代码位于哪个类中。如果`UnitTypeId`是`ProjectTask`该类的属性，那么如果为 null，那么您将在`ProjectTask`此处创建一个新`TaskTemplateRecord`类，并且它将继续创建新类，最终导致`StackOverflowException`.

也许这种方法会奏效：

```
if (TaskTemplateRecord != null)
    return TaskTemplateRecord.UnitTypeId;
else
   return 0; // some default value rather than creating the class again 
```

# javascript - 如何订阅 observableArray 中的 observable

> ID：13980753
> 
> 赞同：5
> 
> 时间：2012-12-20T21:28:31.030
> 
> 标签：javascript, knockout.js

`observable`我正在`observableArray`使用KnockoutJS 并尝试订阅`observableArray`. 所以我的viewModel看起来像这样......

```
function viewModel() {
    // private properties
    var self = this;

    // public properties
    self.movies = ko.mapping.fromJS([]);

    // subscriptions
    self.movies.UserMovies.Rating.subscribe(function(newValue) {
        console.log(newValue);
    });
} 
```

从映射插件填充后，`movies`observableArray 看起来像这样......

```
[{
    Id: 1,
    Title: 'Movie1',
    Year: 2010,
    UserMovies: [{ Id: 11, Rating: 3.5, IsWatched: true }]
},{
    Id: 2,
    Title: 'Movie2',
    Year: 2010,
    UserMovies: [{ Id: 4, Rating: 4, IsWatched: true }]
}] 
```

我正在尝试设置订阅 UserMovies.Rating 但是，从我上面的 viewModel 收到错误消息

> 类型错误：self.movi​​es.UserMovies 未定义

**`UserMovies.Rating`当从映射插件填充它时，我将如何设置订阅？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T00:28:46.350

Knockout 不提供了解数组中哪些项目发生变化的粒度，只是知道发生了*什么*变化。每次添加或删除项目时，您都需要遍历数组。

`foreach`绑定（通过）实际上计算了将一个数组转换为另一个数组的`ko.utils.compareArrays`最小操作数，因此不需要重新创建 DOM 元素。

使用`ko.utils.compareArrays`，我能够创建一个在项目级别订阅数组更改的方法。利用这一点，我可以编写一个`select`管理订阅的方法。

[http://jsfiddle.net/MizardX/s9M4z/](http://jsfiddle.net/MizardX/s9M4z/)

使用新`select`方法，您可以非常简洁地做到这一点：

```
// Subscribe to items added to the array. The returned 'subscription' will be
// disposed of, when the item is later removed.
viewModel.movies.select(function (movie) {

    // Return the subscription. Same as above.
    return movie.UserMovies.select(function (userMovie) {

        // Subscribe to a non-array. The callback will receive the updated value,
        // instead of the an added item.
        return userMovie.Rating.select(function (rating) {

            // Executed each time a rating is updated.
            console.log(movie.Id(), userMovie.Id(), rating);
        });
    });
}); 
```

它按预期处理添加、更新和删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:30:11.840

我认为你必须遍历你的电影并订阅每个人的评级属性：

```
$.each(self.movies(), function(i, movie) { 
     movie.Rating.subscribe(function(newRatingValue){  /* ... */ }) 
}); 
```

当然，这里的缺点是您还必须订阅数组本身，以应对将新电影添加到数组中的情况，然后手动订阅*其*评分值的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-15T12:12:06.697

您可以以这种方式订阅您的属性：

```
 var UserMovies = function (data) {
        this.Id = ko.observable();
        this.Rating = ko.observable();
        this.IsWatched = ko.observable();
        this.update(data);
    }

    ko.utils.extend(UserMovies.prototype, {
        update: function (data) {
            this.Id(data.Id || "");
            this.Rating(data.Rating || "");
            this.Rating.subscribe(function (newValue) {
                console.log(newValue);
            });
            this.IsWatched(data.IsWatched || "");
        }
    }); 
```

我不确定通过订阅对象内部的东西可以做什么或不做什么，但这确实有效。我也不确定每个订阅是否都是唯一的，或者一个评级更改是否会引发所有 UserMovies 评级订阅。我没有测试过。我只在单个对象而不是对象数组中使用它。

# c++ - 我可以依靠短路评估来检查 C++ 中的向量边界吗？

> ID：13980755
> 
> 赞同：10
> 
> 时间：2012-12-20T21:28:41.760
> 
> 标签：c++, stl

下面的代码可以接受吗？

```
if(vector.size() > 0 && vector[0] == 3) {
} 
```

或者当向量为空时它是否有可能崩溃？我没有注意到这种情况发生，但我担心它仍然是可能的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T21:29:30.013

是的，您可以依靠内置运算符`&&`进行短路。这是其规范的一部分。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-20T21:31:12.823

是的，这行得通，但更习惯地说`!vector.empty() && vector[0] == 3`：这将适用于所有容器，效率最高，所以它永远不会更糟，有时更好，而且总是更具可读性。

# html - 背景图像粘贴到页脚

> ID：13980758
> 
> 赞同：0
> 
> 时间：2012-12-20T21:28:51.373
> 
> 标签：html, css, background-image

我怎样才能让我的背景图像始终贴在页面底部。[这](http://healinghands.vtable.us/board-of-directors/)是我遇到问题的页面。我将图像附加到正文，我的 CSS 是

```
html {
height:100%;
     }

body {
background: #fff url(images/bg.png) repeat-x;
-moz-font-smoothing: antialiased;
-webkit-font-smoothing: antialiased; 
color: #404040;
font-family: Arial, Helvetica, sans-serif;
font-size: 14px;
font-smoothing: antialiased;
line-height: 1.5em;
text-rendering: optimizeLegibility;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:30:49.953

```
body {
  background-attachment: fixed; /* stick it */
  background-position: bottom;  /* to the bottom */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:32:07.363

采用：`background-position: bottom left;`

# javascript - 从其他 .js 文件访问函数

> ID：13980767
> 
> 赞同：1
> 
> 时间：2012-12-20T21:29:31.127
> 
> 标签：javascript, function, titanium

嗨，我想从其他 .js 文件访问一个函数。实际上有两个 .js 文件。在一个 js 文件中，我将函数编写为。这是 db.js

```
function quizfun() {
   var quizes = db.execute('select * from Quiz');
   while (quiz.isValidRow()) {
       var counter = 0;
       dataArray[counter] = quiz.fieldByName('Quiz_Text');
       quiz.next();
       alert(dataArray[counter]);
       counter++;
   };
   return dataArray;
} 
```

我正在从像这样的 quizwin.js 的其他 js 文件访问它，但它没有访问函数

```
var quiz_db = Titanium.include('db.js');
 quiz_db.quizfun(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T22:39:24.097

你想要的是使用 CommonJS 模块。它们允许您封装逻辑，并明确定义供其他文件使用的 API。

这是您的示例，但使用 CommonJS：

db.js：

```
/* Public API: */
exports.quizfun = quizfun;

/* Implementation: */
function quizfun() {
    // put your quiz fun logic here
} 
```

quizwin.js：

```
var db = require('db'); // notice no ".js" extension
var dataArray = db.quizfun(); 
```

您可以在此处阅读有关 CommonJS 的更多信息：http: [//developer.appcelerator.com/blog/2011/12/commonjs-module-guide-for-1-8.html](http://developer.appcelerator.com/blog/2011/12/commonjs-module-guide-for-1-8.html)

# html - 从 Google Chrome 复制源代码会遗漏“<”和“>”

> ID：13980768
> 
> 赞同：-1
> 
> 时间：2012-12-20T21:29:34.480
> 
> 标签：html, google-chrome

我正在玩弄我的一个网站的 HTML，把它搞砸了。为了恢复损坏，我去了当前在线的站点，单击“查看源代码”并复制了所有代码。当我将它粘贴到记事本文件甚至 Dreamweaver 中时，除了括号 < 和 > 之外，它都可以很好地粘贴。手动检查所有代码并替换括号将非常耗时。有没有办法复制所有内容，包括括号？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:39:25.927

尝试不同的浏览器“查看源代码”，或尝试不同的文本编辑器。Textpad、Notepad++、Vim 都是很棒的文本编辑器。

我怎样才能像上面的人一样评论你的问题？我似乎找不到选项。我不得不发布这个答案作为回应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:41:17.800

作为在基于 webkit 的浏览器中处理默认“查看源代码”行为的替代方法 - 如果您打开了开发工具：右键单击 > 检查元素 > 右键单击​​根节点 > “复制为 html”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:46:03.847

我会提出第二个@Impulss 建议。很可能这不是 Chrome 的错，而是您要粘贴到的编辑器。我刚刚尝试使用 Chrome 和 TextMate，并且能够很好地粘贴此特定页面的源代码，保留所有尖括号。所以我冒昧地猜测你的编辑器正试图对 HTML/XML 变得“聪明”，并故意去除尖括号。

另一件事是探索`Paste`您的编辑器在上下文菜单中有哪些选项（而不是使用 Ctrl/Cmd-v 粘贴）。

# php - 在新页面/同一页面上构建新幻灯片

> ID：13980770
> 
> 赞同：1
> 
> 时间：2012-12-20T21:29:39.017
> 
> 标签：php, javascript, drupal, slideshow

目前我们的网站有一个幻灯片放映，但它相当小。我想添加一个新幻灯片，通过单击一个按钮在 Javascript 上运行的较大幻灯片中显示原始图片，然后它会像插页式广告一样占据大部分屏幕（如果它只在新窗口中打开）那没问题）。

我已经构建了一组照片、标题等（在 php 中）以发送到此页面（不确定最佳方式）。当前，当您单击该按钮时，它会转到新页面上的新更大幻灯片，但它不知道从上一页图片信息到的数组。

我的问题是我不确定实现这一点的最佳方法。

有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:50:56.960

如果您还没有，您可以考虑使用现有的模块，例如[Views Slideshow](http://drupal.org/project/views_slideshow)。基本思想是您创建一个内容类型，其中包括一个图像字段、一个标题字段，如果合适的话，还有一个目标 URL，然后视图幻灯片允许您创建它们的幻灯片。

该页面上“查看幻灯片安装和配置”下的要点包括指向多个教程的链接。这是我以前用过的一个：http: [//mustardseedmedia.com/podcast/episode42](http://mustardseedmedia.com/podcast/episode42)

# git - 将 Github 存储库移动到 Codeplex 并使它们保持同步

> ID：13980782
> 
> 赞同：3
> 
> 时间：2012-12-20T21:30:29.847
> 
> 标签：git, version-control, github, codeplex

我在 Github 上有一个存储库，我想将其移至 Codeplex。

我想从我的 Github 存储库中获取所有现有的提交，并将它们推送到一个新的 Codeplex 存储库。

我认为这不是正确的方法，但我尝试过：

```
git remote github add url
git remote update
git add .
git commit 
```

但是没有什么要提交的，它下载了 github repo，但是工作目录是空的。

如何切换到 Github master 分支，将所有文件添加到 Codeplex master 分支，并将提交推送到 Codeplex？

理想情况下，我希望能够继续在 Github 分支上工作并将更改推送到 Codeplex。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:48:03.603

### 添加遥控器

假设您已经设置了 Codeplex 存储库，并且 GitHub 当前标记为*origin*，那么您可以执行类似的操作。

```
git remote add codeplex https://foo/bar/baz
git push codeplex master 
```

要查看您的遥控器，请使用`git remote -v`，您将看到您定义的遥控器以及它们指向的 URL。您可以使用多个遥控器；只需确保您已将 GitHub 和 Codeplex 正确设置为遥控器。然后，您可以像往常一样从 GitHub 推送/拉取，然后在需要时显式推送到 Codeplex。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-14T05:03:58.520

对于 codeplex，您的远程（或克隆）url 将类似于： https://{git-server}.codeplex.com/{project-name} （即[https://git01.codeplex.com/eisk](https://git01.codeplex.com/eisk)）

所以，它会像

```
git remote add my-project-at-codeplex https://git01.codeplex.com/eisk
git push my-project-at-codeplex master 
```

[您可以从相反的方向执行相同的操作（即以相同的方式从 codeplex 到 github。可以在此处](http://lastexitcode.com/blog/2012/09/26/CloneCodePlexRepositoryToGitHub/)找到详细的分步详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-15T16:54:51.000

保持 2 个存储库同步将是一场噩梦。您应该考虑[创建一个镜像存储库](http://blog.plataformatec.com.br/2013/05/how-to-properly-mirror-a-git-repository/)。

> 如果您之前没有克隆存储库，您可以通过以下方式将其镜像到新家

```
$ git clone --mirror git@example.com/upstream-repository.git
$ cd upstream-repository.git
$ git push --mirror git@example.com/new-location.git 
```

> 这将获取上游存储库中可用的所有分支和标签，并将它们复制到新位置。
> 
> ## 警告
> 
> 不要在没有被 --mirror 克隆的存储库中使用 git push --mirror 。它将用您的本地引用（和您的本地分支）覆盖远程存储库。这不是我们想要的。阅读下一部分以了解在这些情况下该怎么做。
> 
> git clone --mirror 也比 git clone --bare 更受欢迎，因为前者还克隆 git 注释和其他一些属性。

# iphone - UIWebView中电影播放器 的旋转和外观

> ID：13980785
> 
> 赞同：2
> 
> 时间：2012-12-20T21:30:32.433
> 
> 标签：iphone, objective-c, cocoa-touch, uiwebview, uiappearance

我的应用程序仅支持纵向，但我有显示 YouTube 视频的 Web 视图，当该视频全屏播放时，我希望播放器能够进入横向。如何仅支持视频的横向？

此外，我使用外观 API 来设置整个应用程序中导航栏和栏按钮项的样式。这也适用于电影播放器​​。如何在应用程序的其他部分仍然使用外观 API 的同时使用电影播放器​​的默认布局？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T09:02:57.953

我已经设法解决了这两个问题。

对于旋转，在目标摘要中启用横向。

![在此处输入图像描述](../Images/68e19816d9be4aec48979af26f04f430.png)

然后将以下行添加到您的视图控制器。将其添加到最顶层的控制器就足够了。例如，如果您的整个应用程序在导航控制器中运行，您可以子类化导航控制器。

```
- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
}

- (BOOL)shouldAutorotate
{
    return NO;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return (toInterfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

从技术上讲，我认为仅仅`shouldAutorotate`返回就足够了，`NO`因为它不会在 iOS 6 上旋转，如果你不实现`shouldAutorotateToInterfaceOrientation:`，我相信它默认为 iOS 5 的上述内容。无论如何我都喜欢包含它。

这将确保您的应用程序只能在纵向上运行，但这不会对 MPAVController（UIWebView 用于在其中呈现视频）产生任何影响，因此它将正确旋转。

为了避免在 MPAVController 上设置外观，我更改了对外观 API 的调用，例如：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"MyBackgroundImage.png"] forBarMetrics:UIBarMetricsDefault]; 
```

至

```
[[UINavigationBar appearanceWhenContainedIn:[UINavigationController class], nil] setBackgroundImage:[UIImage imageNamed:@"NavigationBar_Background.png"] forBarMetrics:UIBarMetricsDefault]; 
```

因此，仅当导航栏包含在导航控制器中时才会设置背景，而导航控制器不在 MPAVController 中。

# bash - 远程调用 bash 脚本失败，但在本地运行时有效

> ID：13980786
> 
> 赞同：1
> 
> 时间：2012-12-20T21:30:37.050
> 
> 标签：bash, ssh, find

尝试在批处理文件中本地运行此命令会产生预期结果

```
find $DIR -name "*" -type f -exec ls -alo {} \; | awk '{printf "%-12s %-1s %-1s %-1s %-1s \n",$4,substr($8,20),$9,$10,$11}' | sort -k 1 -n > file_count 
```

当我通过 ssh 远程运行批处理文件时，命令中断：

```
+ find /cygdrive/h/AltaroHyperVBackup -name '*' -type f -exec ls -alo '{}' ';'
+ awk '{printf "%-12s %-1s %-1s %-1s %-1s \n",$4,substr($8,20),$9,$10,$11}'
**FIND: Invalid switch** 
```

我应该如何对批处理文件进行编码，以便它在远程调用时正确运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T20:58:25.090

或者，您也可以将其放在批处理文件的顶部附近：

> 导出 PATH=/bin/:/usr/bin:$PATH

这将确保根据 shellter 的正确诊断调用 Cygwin 查找，而不是 Windows 查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T23:06:11.047

我发现如果你在 find 周围加上引号，它会起作用。将命令的第一部分设为：

```
ssh NODE "find $DIR -type f -exec ls -alo {} \\; " 
```

我去掉了 -name "*" 因为我认为这是多余的。

# php - 如果 $_POST 为“空”或零，我如何检查 PHP？

> ID：13980787
> 
> 赞同：3
> 
> 时间：2012-12-20T21:30:43.400
> 
> 标签：php, post

我有一个（除其他外）有一个输入字段：

```
<input type="text" id="NumAthletes_Ratings" name="NumAthletes_Ratings" /> 
```

在我的 PHP 代码中，我想检查用户是否输入了任何值或 0。但是，此代码

```
 if (isset($_POST['NumAthletes_Ratings'])) {
        if ($_POST['NumAthletes_Ratings'] > 0) {
            echo 'POST Parameter is set to ' . $_POST['NumAthletes_Ratings'];
        } else {
            echo 'POST Parameter is set to Zero';
        }
    } else {
        echo 'POST Parameter is not set';
    } 
```

`POST Parameter is set to Zero`无论传递的是空值还是 0，都将打印。我如何区分这些情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:32:28.443

您可以检查字符串`"0"`（所有`$_POST`变量都是字符串或字符串数​​组）：

```
if ($_POST['NumAthletes_Ratings'] > 0) {
        echo 'POST Parameter is set to ' . $_POST['NumAthletes_Ratings'];
    } elseif ($_POST['NumAthletes_Ratings'] === '0') {
        echo 'POST Parameter is set to 0';
    } else {
        echo 'POST Parameter is empty';
    } 
```

# postgresql - 分区表上 Postgres 中的 UPSERT 语句

> ID：13980790
> 
> 赞同：0
> 
> 时间：2012-12-20T21:31:01.997
> 
> 标签：postgresql, merge, partitioning, upsert

我有一个分区表和一个更新函数/触发器。更新行时，它首先删除该行，然后将其插入到正确的分区中。我的问题是我正在尝试做一个类似于 Oracle 中的 MERGE 的语句。我在 Postgres 中找到了使用 UPSERT 的类似实现的参考，如下所示：

```
WITH upsert as
(
   update mytable2 m 
      set sales=m.sales+d.sales, 
          status=d.status 
   from mytable d 
   where m.pid=d.pid
   RETURNING m.*
)
insert into mytable2 
select a.pid, a.sales, 'NEW' 
from mytable a 
where a.pid not in (select b.pid from upsert b); 
```

但是，问题是更新首先触发 - 在特定行上导致删除和插入，然后插入再次插入。这是因为我在分区上的更新功能/触发器。有没有办法让它像在 Oracle 中那样通过合并（即如果找到行，更新它，否则插入它）而不会导致欺骗或因违反约束而失败？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:27:08.307

您的问题在于返回 null 的触发器和期望返回结果的 upsert 的交集。本质上，您正在做的是：

1.  删除行
2.  插入行
3.  中止更新（这与您的 upsert 混淆）
4.  检查更新是否完成，如果没有插入。

在这种情况下，您会遇到一些问题，因为您的触发器会破坏软件的流程。

那么如何使这项工作......

我看不出有一种简单的方法可以在一个非常大的集合上完成这项工作。我确实认为您将不得不将更新部分移动到您可以调用的函数中。该函数的细节将取决于您一次实际更新的行数。然后你可以做一个`INSERT ... SELECT`类似于你正在做的事情，但使用函数调用而不是 CTE。

# android - 从简单的类中获取视图子

> ID：13980800
> 
> 赞同：0
> 
> 时间：2012-12-20T21:31:42.573
> 
> 标签：android

我能以某种方式从适配器或扩展 Activity 的类以外的类中获取视图的子类吗？

```
ImageView v = (ImageView)parent.getChildAt(position);
v.setImageResource(R.drawable.test2); 
```

我需要更改 GridView 中的每个 ImageView，因为它们是动态下载的。

我的getView：

```
 @Override
public View getView(int position, View convertView, ViewGroup parent) {

    ImageView imageView;
    if (convertView == null) {  
        imageView = new ImageView(mContext);
        if (DefinedValues.width/3 < DefinedValues.height/4)
        imageView.setLayoutParams(new GridView.LayoutParams
                (DefinedValues.height/4, DefinedValues.height/4));
        else
            imageView.setLayoutParams(new GridView.LayoutParams
                    (DefinedValues.width/3-5, DefinedValues.width/3-5));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        imageView.setPadding(8, 8, 8, 8);
    } else {
        imageView = (ImageView) convertView;
    }
    imageView.setImageResource(R.drawable.test3);

    return imageView;
} 
```

# php - 使用 PHP 在一条语句中执行多个 SQL 查询

> ID：13980803
> 
> 赞同：27
> 
> 时间：2012-12-20T21:32:01.623
> 
> 标签：php, mysql

如何将这些多个查询合并为一个（可以吗？）

```
$query = "DELETE FROM aktywne_kody WHERE kodsms ='$kodSMSgracza' AND typkodu ='$id'";
mysql_query($query) or die(mysql_error());

$query = "INSERT INTO uzyte_kody (gracz, kodsms, typkodu) VALUES ('$nickGracza', '$kodSMSgracza', '$id')";
mysql_query($query) or die("Błąd MySQL X04");

$query = "INSERT INTO do_odebrania (gracz, itemDATA, itemQTY) VALUES ('$nickGracza', '$itemDATA', '$itemQTY')";
mysql_query($query) or die("Błąd MySQL X05"); 
```

顺便说一句，如果我在完成所有查询后执行 mysql_close($db) 会更好吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-21T00:34:21.917

作为第 5 个参数传递`65536`给。`mysql_connect`

例子：

```
$conn = mysql_connect('localhost','username','password', true, 65536 /* here! */) 
    or die("cannot connect");
mysql_select_db('database_name') or die("cannot use database");
mysql_query("
    INSERT INTO table1 (field1,field2) VALUES(1,2);

    INSERT INTO table2 (field3,field4,field5) VALUES(3,4,5);

    DELETE FROM table3 WHERE field6 = 6;

    UPDATE table4 SET field7 = 7 WHERE field8 = 8;

    INSERT INTO table5
       SELECT t6.field11, t6.field12, t7.field13
       FROM table6 t6
       INNER JOIN table7 t7 ON t7.field9 = t6.field10;

    -- etc
"); 
```

当您使用 mysql_fetch_* 或 mysql_num_rows 或 mysql_affected_rows 时，只有第一个语句有效。

比如下面的代码，第一条语句是INSERT，不能执行mysql_num_rows和mysql_fetch_*。可以使用 mysql_affected_rows 返回插入的行数。

```
$conn = mysql_connect('localhost','username','password', true, 65536) or die("cannot connect");
mysql_select_db('database_name') or die("cannot use database");
mysql_query("
    INSERT INTO table1 (field1,field2) VALUES(1,2);
    SELECT * FROM table2;
"); 
```

再比如，下面的代码，第一条语句是SELECT，不能执行mysql_affected_rows。但是您可以执行 mysql_fetch_assoc 来获取第一个 SELECT 语句产生的行的键值对，或者您可以执行 mysql_num_rows 来获取基于第一个 SELECT 语句的行数。

```
$conn = mysql_connect('localhost','username','password', true, 65536) or die("cannot connect");
mysql_select_db('database_name') or die("cannot use database");
mysql_query("
    SELECT * FROM table2;
    INSERT INTO table1 (field1,field2) VALUES(1,2);
"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-06T05:18:53.783

这可能是创建 sql 注入点“SQL Injection Piggy-backed Queries”。攻击者能够附加多个恶意 sql 语句。所以不要将用户输入直接附加到查询中。

> > 安全注意事项
> > 
> > API 函数 mysqli_query() 和 mysqli_real_query() 没有设置激活服务器中的多查询所需的连接标志。对多个语句使用额外的 API 调用，以减少意外 SQL 注入攻击的可能性。攻击者可能会尝试添加语句，例如；删除数据库 mysql 或 ; 选择睡眠 (999)。如果攻击者成功在语句字符串中添加 SQL 但未使用 mysqli_multi_query，则服务器不会执行第二条注入的恶意 SQL 语句。

[PHP文档](http://php.net/manual/en/mysqli.quickstart.multiple-statement.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-08T08:59:54.637

`mysqli`您可以使用多个语句来真正使用`mysqli_multi_query()`.

[阅读 PHP 文档中有关多个语句的更多信息](http://www.php.net/manual/en/mysqli.quickstart.multiple-statement.php)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:43:20.737

您可以只添加单词 JOIN 或添加一个 ; 在每一行之后（如@pictchubbate 所说）。由于可读性，这种方式更好，而且你不应该用 INSERT 干预 DELETE；去南方很容易。

最后一个问题是一个有争议的问题，但据我所知，是的，您应该在一组查询后关闭。这主要适用于旧的普通 mysql/php 而不是 PDO、mysqli。在这些情况下，事情变得更加复杂（并且在辩论中变得激烈）。

最后，我建议使用 PDO 或其他方法。

# css - 非插入显示可折叠设置太宽

> ID：13980805
> 
> 赞同：0
> 
> 时间：2012-12-20T21:32:09.323
> 
> 标签：css, jquery-mobile

我们正在使用 jquery-mobile.. 并添加了一个带有非 inset="false" 的可折叠列表视图，因此它将适合移动屏幕的整个宽度。

现在我们已经设置好了，列表视图和分隔线太宽了，所以它不能正确地适应屏幕。如果我们设置 inset="true" lsitview 正确地适合屏幕..但我们希望有非插入..

有什么问题，我们必须自定义样式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:55:47.817

All you have to do to make it work as intended is to set `data-role="content"` to `div` container of your collapsible.

```
<div data-role="content" class="content-primary">
    <div data-role="collapsible-set" data-inset="false"> 
```

Here is [jsfiddle](http://jsfiddle.net/pmatseykanets/c3ttz/)

# combobox - 如何使用 Foxpro 组合框的显示值

> ID：13980806
> 
> 赞同：1
> 
> 时间：2012-12-20T21:32:13.463
> 
> 标签：combobox, foxpro

我有一个组合框，我希望它显示

`category name ("Cat1" , "Cat2"...)`

但是当单击或仅显示时，我想获取此类别的 ID。知道如何在 Foxpro 中执行此操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:42:15.260

要填充您的组合框：

```
Thisform.Combo1.AddItem("Cat1")
Thisform.Combo1.AddItem("Cat2") 
```

您可以使用 rowsource 将整个项目列表添加到组合框中。

获取组合框的选定值：

```
Thisform.Combo1.DisplayValue 
```

*   请[参考这篇文章](http://www.universalthread.com/ViewPageArticle.aspx?ID=590)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:39:32.763

创建一个光标，其中包含要在第一列中显示的内容和在第二列中显示的 ID。然后，像这样设置组合：

```
RowSourceType = 2-Alias
RowSource = <your cursor name>
BoundColumn = 2
BoundTo = .T. && so you can have a numeric controlsource 
```

添马舰

# common-lisp - Common Lisp：Cffi：设置外来类型

> ID：13980812
> 
> 赞同：4
> 
> 时间：2012-12-20T21:32:40.327
> 
> 标签：common-lisp, ffi

我最近一直在玩奇妙的 cffi，但我在确定使用内置机制是否可以实现某些事情时遇到了问题。

我想创建一个外来向量数组并设置外来类型翻译，这样就可以了。

```
> (defparameter a (foreign-alloc 'vec3 :count 10))
A
> (setf (mem-aref  a 'vec3 4) (convert-to-foreign #(1.0 2.0 3.0) 'vec3))
#(1.0 2.0 3.0)
> (convert-from-foreign (mem-aref b 'vec3 4) 'vec3)
#(1.0 2.0 3.0 
```

到目前为止，我有以下允许创建和获取外部 vec3 但不允许检索。

```
(defcstruct %vec3
  (components :float :count 3))

(define-foreign-type vec3-type ()
  ()
  (:actual-type %vec3)
  (:simple-parser vec3))

(defmethod translate-from-foreign (value (type vec3-type))
  (make-array 
   3 
   :element-type 'single-float
   :initial-contents (list (mem-aref value :float 0)
               (mem-aref value :float 1)
               (mem-aref value :float 2)))) 
```

问题是，虽然我可以轻松地设置一个函数来充当 vec3 的设置器，但我希望有一些我没有看到的内置方式来执行此操作。我已经阅读了 cffi 手册，并看到了 translate-to-foreign 方法以及 expand-to-foreign-dyn，但我还没有找到一种方法来使用基本上扩展为如下内容：

```
(let ((tmp (mem-aref a '%vec3 4)))
  (setf (mem-aref tmp :float 0) (aref lisp-value 0))
  (setf (mem-aref tmp :float 1) (aref lisp-value 1))
  (setf (mem-aref tmp :float 2) (aref lisp-value 2))) 
```

这样就不会分配额外的内存并直接设置值。

好吧，这就是我的小白日梦，有人知道它是否可以工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T11:43:43.277

阅读了 CFFI 源代码，似乎内置机制不支持这一点。那里有处理数组类型的代码，但它没有公开或导出，因此显然不适合使用。还有一个建议的块存储器接口，但尚未编写。

所以这次没有骰子，但是 CFFI 很棒，所以我会用不同的方式来实现。

ps 还有[WAAF-CFFI](http://www.cliki.net/WAAF-CFFI)值得研究，但我还没有具体细节

# vb6 - VB6 和 .PFX 代码签名

> ID：13980813
> 
> 赞同：7
> 
> 时间：2012-12-20T21:32:41.343
> 
> 标签：vb6, signing, pfx

我的老板已经从 Comodo 购买了一个证书，我一直在试图找到解决将证书*放入*VB6 应用程序的问题的解决方案。证书本身是 VB6 格式的，我对这类事情几乎一无所知。Comodo 的人非常乐于助人（从我的老板那里，他们说他可以在互联网上找到一些东西。显然他们不知道互联网有多大-.-）

签署项目是否需要将代码放入程序中，还是只是由 MS Authenticode 可执行文件签署的 .exe？

有没有人有这样的白痴一步一步的指导解决方案？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T10:30:37.100

这是我们构建脚本的一个片段

```
set signtool=C:\{cert_path}\signtool.exe sign /f C:\{cert_path}\my_code_sign_current.p12 /p ###### /du "http://mycompany.com" /t "http://timestamp.comodoca.com/authenticode"
%signtool% /d "My Application 1.0" "C:\{binn_path}\App.exe"
%signtool% /d "My Other App 2.0" "C:\{binn_path}\Other.exe"
... 
```

我们使用旧版本`signtool.exe`（[6.0.4002.0](http://dl.unicontsoft.com/upload/signtool.exe)），因为我们在使用一些新版本（[http://www.startssl.com/timestamp](http://www.startssl.com/timestamp)）的时间戳服务器时遇到了麻烦。

注意：.pfx 和 .p12 文件——它们是相同的 PKCS #12 容器文件，DER 编码

# javascript - 检测 iframe 何时从跨域站点返回

> ID：13980816
> 
> 赞同：0
> 
> 时间：2012-12-20T21:32:55.210
> 
> 标签：javascript, iframe, cross-domain-policy

我的页面上有一个 iframe，用于向第三方页面提交表单。一旦第三方完成计算，它就会重定向回我自己的站点。我想检测 iframe 何时返回我自己的网站。

我目前的方法是使用超时并`location.host`每 0.5 秒检查一次 iframe。但是，虽然 iframe 仍在第三方网站上，但我收到了一个 JS 错误，我想避免这种情况。

有没有一种好方法可以确定 iframe 的位置何时回到我自己的服务器上而不会出现 JS 错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:38:42.440

```
function check() {
    try { 
        location.host; // if I error, doStuff() is never hit. 
        doStuff();
    } catch( e ) {
        setTimeout(check, 5000);
    }
} 
```

使用 try / catch 语句应该可以为您解决这个问题。可能还有其他方法可以解决这个问题，但是在查看您的问题后，这是第一个想到的。

另一种选择是`onload`从 iframe 监听事件。每次 iframe 页面更改时都会触发（至少在 chrome 中）。[http://jsfiddle.net/rlemon/DwVJX/1/](http://jsfiddle.net/rlemon/DwVJX/1/)这是一个快速演示。在 iframe 中单击 jsFiddle 徽标返回主页。我知道这并不能告诉您您是否在正确的域中，但是结合 try/catch 可以消除对计时器的需要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:38:38.817

您可以将支票包装在一个`try catch`块中。或者，您可以让主机上的页面“呼叫”父级。（类似于`parent.notifyReady()`）这样你就不必使用`setInterval`

`document.referrer`您可以使用该属性将您的逻辑基于是否调用父级

所以在你的第三页你可以有这样的东西：

```
if(document.referrer.indexOf('otherdomain.com') != -1) {
    // script called via otherdomain.com
    parent.notifyReady();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:40:17.493

我认为您当前正在做的是可靠地检测 iframe 是否位于父页面域上托管的页面上的唯一方法。

大多数 iframe 属性是不可访问的（访问时抛出异常），而 iframe 与父级位于不同的域中。异常实际上表明 iframe 不在您的站点上，因此只需捕获异常并重试。如果未引发异常，则 iframe 位于与其父级相同域中的页面上。

# shell - 如何在 linux shell 中发送交互式提示响应？

> ID：13980821
> 
> 赞同：1
> 
> 时间：2012-12-20T21:33:34.370
> 
> 标签：shell, prompt

我正在尝试制作一个使用密码自动压缩文件的脚本。Zip 通过在交互式提示中询问密码来做到这一点。如何使脚本响应提示？

我试过了：

# zip -e xxx 我的文件

输入密码：

zip 错误：中断（中止）

# zip -e 我的文件 < xxx

-bash: xxx: 没有这样的文件或目录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:41:27.957

-e 选项期望`zip`在终端上运行。如果您不介意复杂性，您可以使用伪终端和脚本（使用 Tcl 或 Perl 或类似软件中可用的 Expect 包）。

将 -P 标志（或 --password）标志与 zip 一起使用可能更容易，只需在命令行上传递密码即可。

# android - Android Google Maps Api V2，获取当前地图中心的坐标

> ID：13980823
> 
> 赞同：6
> 
> 时间：2012-12-20T21:33:41.390
> 
> 标签：android, google-maps-android-api-2

我正在使用 Android Google Maps Api V2（不是 MapView 或 MapActivity），我很难获得地图中心的坐标。

我正在考虑使用

```
@Override
public void onCameraChange(CameraPosition arg0) {
    // TODO Auto-generated method stub
    geoCodeCenter(/*Location object*/);
} 
```

但我无法从 CameraPosition 对象中获取纬度/经度。相机还具有更多尺寸，因为您现在也可以以不同的间距查看地图，因此获取纬度/经度的中心并不相同，因为不能保证用户从鸟瞰视图中查看地图，除非某些手势被禁用。

有一个更好的方法吗？我不希望用户必须长按一个标记来将其拖到地图上，我希望他们通过用户平移它来知道地图的中心在哪里。

该`map.getMyLocation()`方法用于其他内容，例如当前的 LocationProvider 位置。尽管我正在使用 GPS 并且它仍然返回 null ，但似乎也不是这个选项

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T21:51:03.357

> 但我无法从 CameraPosition 对象中获取纬度/经度

根据我对文档的阅读，a上的[`target`公共数据成员](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/CameraPosition#target)`CameraPosition`是`LatLng`地图中心的一个。

# javascript - 将一个“更大” ul 的底部与另一个的底部对齐

> ID：13980824
> 
> 赞同：1
> 
> 时间：2012-12-20T21:33:42.793
> 
> 标签：javascript, jquery, html, css

我正在尝试制作一个菜单，该菜单在单击以激活它的 div 的右侧打开。但是，我不明白如何正确定位。我希望最后一个`li`（我存储子菜单选项的地方）的底部与激活弹出窗口的 div 的底部相同。然而，给予是负边际

```
ul.dd{
  z-index:100;
  position:relative;
  margin-bottom:-30px;
  display:none;
} 
```

行不通。我怎样才能做到这一点

[http://jsfiddle.net/mBPfG/1/](http://jsfiddle.net/mBPfG/1/)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:40:31.863

您的容器 div 阻止隐藏`<ul>`标签浮动到另一个的右侧。还添加了负边距顶部以调整定位。

我已经更新了[jsfiddle](http://jsfiddle.net/mBPfG/4/)。

我只是补充说：

```
.dd_container { width:600px; }

ul.dd{
  z-index:100;
  position:relative;
  margin-top:-60px;
  display:none;
} 
```

但是，我建议将您的第二个嵌套`<ul>`在第一个`<li>`中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T22:12:33.067

我已经完全修改了`HTML`and`CSS`以获得更正确的答案。

```
<div id="dd_container" class="dd dd_container">
<ul class="dd_deploy">
    <li><a href="#_">more options --></a>
       <ul class="dd">
           <li><a href="#_">el1</a></li>
           <li><a href="#_">el2</a></li>
           <li><a href="#_">el3</a></li>   
       </ul>
   </li>
</ul>
<div class="cb"></div> 
```

​​​​​​​​​​标记越少越好

查看完整的[jsfiddle](http://jsfiddle.net/jev4S/1/)。

# c++ - 按列主要顺序遍历行主要存储的数组

> ID：13980829
> 
> 赞同：0
> 
> 时间：2012-12-20T21:33:57.303
> 
> 标签：c++, arrays

我正在研究一个多维数组类（省略了复杂/不相关的细节）。我将数据存储为以行主要顺序存储的线性数组。我需要创建一个迭代器，它可以按列优先顺序迭代数组。鉴于数据以行主要顺序存储，行主要迭代器可以简单地将索引递增到数组中。但是，我不确定如何实现列主迭代器。我猜有一个公式可以用来计算索引，但无法在任何地方找到它或自己推导出它。重新排列数据不是一种选择，因为无论我需要两个迭代器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:41:00.807

```
last_idx = width * height - 1;

if(pos == last_idx)
{
    end;
}
else {
    pos += width;
    if(pos > last_idx) pos -= last_idx;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:41:11.227

```
// Example
const int ROWS = 4;
const int COLS = 5;

// Initial
int row = 0;
int col = 0;

// Iteration
row += 1;
col += row / ROWS;
row %= ROWS;

// Index into your array
row * ROWS + col

// Termination
row * ROWS + col < ROWS * COLS 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:50:12.217

给定数组的维度，您可以创建映射表并让迭代器对其进行迭代。

```
array[mapping_table[i]] 
```

# java - 确定在 Linux 平台上远程机器上运行的 JVM 列表

> ID：13980832
> 
> 赞同：1
> 
> 时间：2012-12-20T21:34:03.107
> 
> 标签：java, linux, rmi, jmx

我需要确定在远程机器上运行的 JVM 列表，一旦完成，使用 JMX 连接到每个 JVM。我是新手，经历过以下概念：
1\. 使用 jps 和 jstat：我读到这些命令在未来的 jdk 版本中可能不可用。
2.使用java类“virtualmachine().list”。但问题在于它可以帮助您获取 JVM 列表，但仅适用于本地机器。我不知道如何连接到远程机器然后获取这个列表。

谁能建议如何使用“virtualmachine().list”或任何其他方法来获取远程机器上的 JVM 列表？

问题是我研究的连接到远程 JVM 的所有方法（包括 jconsole 的工作方式）都集中在一个特定的 JVM 上，我需要在其中提供端口号（JVM 进程的）。但我需要一份所有正在运行的 JVM 的列表。我怎样才能做到这一点 ？甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:47:25.537

一种选择是在远程机器上启动一个小型 Java 应用程序并让它运行 virtualmachine().list 或类似的，然后发回信息或使用 JMX 使其可访问。此应用程序可能一直在运行，或者您可以远程启动它。

这里提到的其他一些想法：[Get System Information of a Remote Machine (Using Java)](https://stackoverflow.com/questions/1135490/get-system-information-of-a-remote-machine-using-java)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T22:10:22.807

您可以向每个远程 JVM 添加一个 java-agent 或其他一些通用组件，并让它们将其 JMXServiceURL“回拨”到中央 JVM 票据交换所。除此之外，我认为您唯一的选择广泛来自[monex0](https://stackoverflow.com/users/1284420/monex0)的建议。

# sqlanywhere - 如何确定数据库的文件名？

> ID：13980833
> 
> 赞同：1
> 
> 时间：2012-12-20T21:34:04.917
> 
> 标签：sqlanywhere

我的应用程序使用 Entity Framework 4 来访问 SQL Anywhere 12.0.1 数据库。我需要一个查询来告诉我磁盘上数据库文件的名称，包括驱动器号。

如何从数据库本身获取数据库路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:47:04.873

我想到了。此查询将检索存储当前数据库的文件的路径：

从 SYSDBFILE 中选择文件名，其中 dbfile_name = 'system'

# bash - 用 find 痛打冬天

> ID：13980835
> 
> 赞同：1
> 
> 时间：2012-12-20T21:34:14.997
> 
> 标签：bash, command, find

最近（也就是前几天的冬天）写了一个简单的脚本，里面打包了一些文件夹，脚本如下：

```
#!/bin/bash 
for DIR in `find -name "MY_NAME*" -type d`
do
tar -zcvf $DIR.tar.gz $DIR &
done
echo "Packing is done" > packing.txt 
```

`MY_NAME*`它工作正常，除了它在它运行的文件夹的每个子目录中搜索。因为`MY_NAME*`文件夹包含大量文件，并且打包需要很长时间，所以我想限制时间损失，并且我希望`find`命令`MY_NAME*`仅在脚本运行的文件夹中查找这些目录（没有子目录）。可以用命令`find`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:40:20.993

如果您只希望它在您所在的文件夹中，请不要使用 find。试试这个：

```
for DIR in MY_NAME*/
   do
   tar -zcvf "$DIR".tar.gz "$DIR" &
done
echo "Packing is done" > packing.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:41:23.330

看来您想`-maxdepth`在命令上使用标志`find`：

```
find -name "MY_NAME*" -type d -maxdepth 1 
```

# php - 重置数组PHP中项目的位置

> ID：13980837
> 
> 赞同：0
> 
> 时间：2012-12-20T21:34:23.607
> 
> 标签：php

我在一个数组中有一个由 7 个数字组成的字符串，看起来像 4,1,2,56,7,9,10 但是有时这些元素是空的 ,,,56,7,9,10 例如。我想做的是重新排序数组，使其看起来像 56,7,9,10,,,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:47:14.013

在循环中使用 unset 删除空值并将值向上移动。

```
foreach($yourarray as $key=>$val )
{
    if($yourarray[$key] == '')
    {
       unset($yourarray[$key]);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:41:31.543

尝试这个：

```
$null_counter = 0;
foreach($array as $key => $val) {
   if($val == null) {
       $null_counter++;
       unset($array[$key]);
   }
}
for($x=1;$x<=$null_counter;$x++) {
    $array[] = null;
} 
```

# ruby-on-rails - 应该如何使用 Amazon Web 服务及其弹性 beantalk 将机密文件推送到 EC2 Ruby on Rails 应用程序？

> ID：13980842
> 
> 赞同：12
> 
> 时间：2012-12-20T21:34:43.607
> 
> 标签：ruby-on-rails, ruby, amazon-web-services, amazon-s3, amazon-ec2

应该如何使用 Amazon Web 服务及其弹性 beantalk 将机密文件推送到 EC2 Ruby on Rails 应用程序？

我将文件添加到 git 存储库，然后推送到 github，但我想将我的秘密文件保留在 git 存储库之外。我正在使用以下方法部署到 aws：

```
git aws.push 
```

以下文件位于 .gitignore 中：

```
/config/database.yml
/config/initializers/omniauth.rb
/config/initializers/secret_token.rb 
```

按照此链接，我尝试将 S3 文件添加到我的部署中： http: [//docs.amazonwebservices.com/elasticbeanstalk/latest/dg/customize-containers.html](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/customize-containers.html)

*引用该链接：*

> ## 示例片段
> 
> 以下示例从 Amazon S3 存储桶下载 zip 文件并将其解压缩到 /etc/myapp：
> 
> ```
> sources:  
>     /etc/myapp: http://s3.amazonaws.com/mybucket/myobject 
> ```

按照这些指示，我将文件上传到 S3 存储桶，并将以下内容添加到 .ebextensions 目录中的 private.config 文件中：

```
sources:
  /var/app/current/: https://s3.amazonaws.com/mybucket/config.tar.gz 
```

该 config.tar.gz 文件将提取到：

```
/config/database.yml
/config/initializers/omniauth.rb
/config/initializers/secret_token.rb 
```

但是，在部署应用程序时，S3 主机上的 config.tar.gz 文件永远不会被复制或提取。我仍然收到找不到 database.yml 的错误，并且 EC2 日志没有配置文件的记录，这是错误消息：

```
Error message:
  No such file or directory - /var/app/current/config/database.yml
Exception class:
  Errno::ENOENT
Application root:
  /var/app/current 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T15:51:53.937

做我认为你想做的事情的“正确”方法是使用 IAM 角色。您可以在此处查看有关它的博客文章：http: [//aws.typepad.com/aws/aws-iam/](http://aws.typepad.com/aws/aws-iam/)

基本上，它允许您启动 EC2 实例，而无需在任何配置文件中放置任何个人凭证。当您启动实例时，它将被分配给定的角色（一组使用 AWS 资源的权限），并且将使用 Amazon IAM 自动在机器上放置一个轮换凭证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-31T22:29:57.377

为了使`.ebextension/*.config`文件能够从 S3 下载文件，它们必须是公开的。鉴于它们包含敏感信息，这是一个坏主意。

[您可以使用实例角色](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.iam.roles.aeb.html)启动 Elastic Beanstalk 实例，并且可以授予该角色访问相关文件的权限。不幸的是，文件的`file:`和`sources:`部分`.ebextension/*.config`没有使用此角色的直接访问权限。

您应该能够使用[AWS SDK for Ruby的](http://aws.amazon.com/sdkforruby/)[AWS::S3::S3Object](http://docs.aws.amazon.com/AWSRubySDK/latest/AWS/S3/S3Object.html)类编写一个简单的脚本来下载文件，并使用 a而不是. 如果您不指定凭据，SDK 将自动尝试使用该角色。`command:``sources:`

您必须为您的角色添加一个策略，该策略允许您专门下载您感兴趣的文件。它看起来像这样：

```
{                       
  "Statement": [
    {
    "Effect": "Allow",
     "Action": "s3:GetObject",
     "Resource": "arn:aws:s3:::mybucket/*"
    }
  ]
} 
```

`.config`然后你可以在你的文件中做这样的事情

```
files:
  /usr/local/bin/downloadScript.rb: http://s3.amazonaws.com/mybucket/downloadScript.rb
commands:
  01-download-config:
    command: ruby /usr/local/downloadScript.rb http://s3.amazonaws.com/mybucket/config.tar.gz /tmp
  02-unzip-config:
    command: tar xvf /tmp/config.tar.gz
    cwd: /var/app/current 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-31T13:16:32.233

使用环境变量是一个好方法。在环境中引用密码，所以在一个 yaml 文件中：

```
password: <%= ENV['DATABASE_PASSWORD'] %> 
```

然后直接使用 eb 或控制台在实例上设置它们。

您可能担心在环境中容易获得此类敏感信息。如果某个进程破坏了您的系统，无论它在哪里，它都可能获得密码。Heroku 等许多 PaaS 提供商都使用这种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-29T14:22:57.640

在 S3 中存储敏感文件并自动将它们复制到您的 Beanstalk 实例是可能的（并且很容易）。

当您创建 Beanstalk 应用程序时，会自动创建一个 S3 存储桶。该存储桶用于存储应用版本、日志、元数据等。

分配给您的 Beanstalk 环境的默认设置`aws-elasticbeanstalk-ec2-role`对此存储桶具有读取权限。

因此，您需要做的就是将敏感文件放入该存储桶（在存储桶的根目录或您想要的任何目录结构中），并创建一个`.ebextension`配置文件以将它们复制到您的 EC2 实例。

这是一个例子：

```
# .ebextensions/sensitive_files.config

Resources:
  AWSEBAutoScalingGroup:
    Metadata:
      AWS::CloudFormation::Authentication:
        S3Auth:
          type: "s3"
          buckets: ["elasticbeanstalk-us-east-1-XXX"] # Replace with your bucket name
          roleName: 
            "Fn::GetOptionSetting": 
              Namespace: "aws:autoscaling:launchconfiguration"
              OptionName: "IamInstanceProfile"
              DefaultValue: "aws-elasticbeanstalk-ec2-role" # This is the default role created for you when creating a new Beanstalk environment. Change it if you are using a custom role

files:
  /etc/pki/tls/certs/server.key: # This is where the file will be copied on the EC2 instances
    mode: "000400" # Apply restrictive permissions to the file
    owner: root # Or nodejs, or whatever suits your needs
    group: root # Or nodejs, or whatever suits your needs
    authentication: "S3Auth"
    source: https://s3-us-west-2.amazonaws.com/elasticbeanstalk-us-east-1-XXX/server.key # URL to the file in S3 
```

这记录在这里：[http ://docs.aws.amazon.com/elasticbeanstalk/latest/dg/https-storingprivatekeys.html](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/https-storingprivatekeys.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T21:53:59.730

从那里安全文档 Amazon EC2 支持用于文件加密的 TrueCrypt 和用于传输中的数据的 SSL。查看这些文件

*   [安全白皮书](http://media.amazonwebservices.com/pdf/AWS_Security_Whitepaper.pdf)
*   [特征](http://aws.amazon.com/security/#features)
*   [风险与合规](http://media.amazonwebservices.com/AWS_Risk_and_Compliance_Whitepaper.pdf)
*   [最佳实践](http://media.amazonwebservices.com/Whitepaper_Security_Best_Practices_2010.pdf)

您可以使用加密磁盘上传服务器实例，也可以使用私有仓库（我认为这对 github 来说是成本，但还有其他选择）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-26T16:12:50.930

我认为最好的方法是不要破解 AWS（设置挂钩、上传文件）。只需使用 ENV 变量。

使用 gem 'dot-env' 进行开发（即 <%= ENV['LOCAL_DB_USERNAME'] %> in 'config/database.yml'）和默认的 AWS 控制台在 Beanstalk 中设置变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-20T07:29:23.017

我知道这是一篇旧帖子，但我在任何地方都找不到另一个答案，所以我烧了半夜的油来找一个。我希望它可以为您节省几个小时。

我同意开发人员发布了多少 PITA 来强制开发人员将 ENV vars 放入他们的本地 dev database.yml 中。我知道 dotenv gem 很好，但您仍然需要维护 ENV 变量，这会增加启动站所需的时间。

我的方法是在 EB 创建的存储桶中存储一个 database.yml 文件，然后使用 .ebextensions 配置文件在服务器的 pre hook 目录中创建一个脚本，以便在解压缩到暂存目录之后但之前执行它资产编译——当然，没有 database.yml 就会崩溃。

.config 文件是

```
# .ebextensions/sensitive_files.config
# Create a prehook command to copy database.yml from S3
files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/03_copy_database.sh" :
    mode: "000755"
    owner: root
    group: root
    content: |
        #!/bin/bash
        set -xe
        EB_APP_STAGING_DIR=$(/opt/elasticbeanstalk/bin/get-config  container -k app_staging_dir)
        echo EB_APP_STAGING_DIR is  ${EB_APP_STAGING_DIR} >/tmp/copy.log
        ls -l ${EB_APP_STAGING_DIR} >>/tmp/copy.log
        aws s3 cp s3://elasticbeanstalk-us-east-1-XXX/database.yml ${EB_APP_STAGING_DIR}/config/database.yml >>/tmp/copy.log 2>>/tmp/copy.log 
```

## *笔记*

*   当然bucket名称中的XXX是EB创建的序列号。您必须检查 S3 才能看到存储桶的名称。
*   我创建的脚本文件的名称很重要。这些脚本是按字母顺序执行的，所以我很小心地给它命名，所以它排在asset_compilation 脚本之前。
*   显然将输出重定向到 /tmp/copy.log 是可选的

对我帮助最大的帖子是[自定义 ElasticBeanstalk 部署挂钩](https://forums.aws.amazon.com/thread.jspa?threadID=137136)

由 Kenta@AWS 发布。谢谢健太！

# asp.net - 在哪里放置 ELMAH 二进制文件？

> ID：13980847
> 
> 赞同：1
> 
> 时间：2012-12-20T21:35:33.000
> 
> 标签：asp.net, asp.net-mvc, elmah

我正在尝试在我的 MVC 项目中实现 ELMAH。我已经完成了相当多的教程，并正确设置了所有内容。

当我尝试将 elmah.dll 添加到我的 ThirdPartyLibs 文件夹（我存储所有 .dll 文件的位置）时，我的问题就出现了。我下载了文件并将其解压缩到我的下载文件夹中。我添加-> 现有，并导航到 .dll 并指出：

“您正在尝试将项目添加到源代码控制项目，但该项目的路径没有映射。如果您继续添加，该项目将不会添加到源代码管理。您希望继续添加吗？”

然后我添加它，我的项目在以下代码的 elmah 部分失败：

```
Line 71:     <httpModules>
Line 72:       <add name="Glimpse" type="Glimpse.Core.Module" />
Line 73:       <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah"/>
Line 74:     </httpModules>
Line 75:     <httpHandlers> 
```

我不确定我做错了什么，因为大多数文章都假设您了解 MVC、Visual Studio 并且可以引用 .dll。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:46:20.240

从您收到的错误消息来看，您似乎正在使用 Visual Studio 下的某些源代码控制，例如 Team Foundation Server。您的项目是源代码控制的，并且您已将`Elmah.dll`程序集放置在项目位置之外的文件夹中，该文件夹受源代码控制。

因此，例如，您的源代码控制项目被映射到`c:\myproject`，并且您已将 elmah 程序集提取到`c:\elmah`该位置并从该位置引用它。这种方法的问题是源代码管理将不再知道这个依赖程序集的位置。

因此，解决此问题的一种可能性是将源代码管理下的依赖程序集添加到同一文件夹中：例如`c:\myproject\Reference Assemblies\Elmah`，然后从那里引用它。

或者干脆使用[`official NuGet package`](http://nuget.org/packages/elmah).

# c# - 传递嵌套复杂类型的 REST URL 语法是什么？

> ID：13980851
> 
> 赞同：12
> 
> 时间：2012-12-20T21:35:52.030
> 
> 标签：c#, url, rest, asp.net-web-api

将带有嵌套对象的对象传递给我的 ASP.NET Web API GET 方法的 URL 语法是什么？这可能吗？ `http://mydomain/mycontroller?...`

Mycontroller GET 方法：

```
 public void Get([FromUri]MyType myType) { ... } 
```

C# 类型：

```
public class MyType
{
  public string Name { get; set; }
  public NestedType Foo { get; set; }
}

public class NestedType
{
  public int Bar { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-20T22:18:42.173

有可能——尝试以这种格式传递 URL：

```
?myType.Foo.Bar=3&myType.Name=Maggie 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:46:32.400

如果您尝试实现执行以下操作的获取：1）按名称获取 2）通过 Foo.Bar 获取

然后你可以使用查询字符串参数。 [REST 将多个输入传递给 GET 方法](https://stackoverflow.com/questions/2552574/rest-pass-multiple-inputs-to-get-method)

如果您不是真正尝试执行 GET，而是尝试将数据 POST 到服务器，那么您应该使用 POST。

# jquery - Zend 中的 jQuery ajax 调用失败

> ID：13980858
> 
> 赞同：0
> 
> 时间：2012-12-20T21:36:20.643
> 
> 标签：jquery, ajax, zend-framework

我设置了一个 zend 控制器来处理 ajax 请求的部分 HTML，每当我直接访问它时它工作得很好，但是当我通过 ajax 调用访问它时它会给出 500 错误。我不确定从哪里开始寻找尝试找出失败的原因。我完全关闭了所有acl的东西，它仍然失败。

访问日志：

```
127.0.0.1 - - [20/Dec/2012:16:31:04 -0500] "GET /ajax/iconlist?icondir=attributes&format=html HTTP/1.1" 500 1157 "http://hc.localhost/attribute/edit" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11"
127.0.0.1 - - [20/Dec/2012:16:32:08 -0500] "GET /ajax/iconlist?icondir=attributes&format=html HTTP/1.1" 200 1757 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11" 
```

第一个条目是一个 ajax 请求，它以 500 失败。第二个条目直接转到加载得很好的链接。

特雷`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:57:22.540

我的猜测是你遇到了 ajax 的跨域问题。它试图访问[http://hc.localhost/](http://hc.localhost/)而不是 localhost 或 127.0.0.1 ，这可能会导致它失败。

如果您搜索“跨域 ajax”，JSON-P 会出现很多，所以也许值得一看

# c# - 如何制作贝壳吐司？

> ID：13980864
> 
> 赞同：7
> 
> 时间：2012-12-20T21:36:31.150
> 
> 标签：c#, windows-phone-8

在我的应用程序中，我想用`ShellToast`.

只要跑...

```
var toast = new ShellToast
{
    Title = "Nom nom nom!",
    Content = "More! More! Keep feeding me!",
};
toast.Show(); 
```

...什么也没发生，据我所知，它需要从`ScheduledTaskAgent`. 但是我如何在命令上运行它，并确保它只运行一次？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-20T22:22:09.233

当应用程序是前台应用程序时，您不能使用 ShellToast。它意味着从后台服务调用，而应用程序不是前台应用程序。

如果您想拥有类似于 ShellToast 的 UX，请使用[Coding4fun 工具包](http://coding4fun.codeplex.com/)ToastPrompt 控件。这是一个代码片段，展示了如何使用它：

```
 private void ToastWrapWithImgAndTitleClick(object sender, RoutedEventArgs e)
    {
        var toast = GetToastWithImgAndTitle();
        toast.TextWrapping = TextWrapping.Wrap;

        toast.Show();
    }

    private static ToastPrompt GetToastWithImgAndTitle()
    {
        return new ToastPrompt
        {
            Title = "With Image",
            TextOrientation = System.Windows.Controls.Orientation.Vertical,
            Message = LongText,
            ImageSource = new BitmapImage(new Uri("../../ApplicationIcon.png", UriKind.RelativeOrAbsolute))
        };
    } 
```

运行此代码段显示以下内容：

![带图像的 ToastPrompt 控件](../Images/0914653dc91494e6736306ebbf1d26e0.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T20:13:21.687

只是一个小更新：`ShellToast`在应用程序处于前台时使用，现在可以在使用 Windows Phone 8 Update 3 时使用。不过，它们会被其他活动（如电话或锁定屏幕）遮挡。[来源](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj662938%28v=vs.105%29.aspx)

# python - v4l2/streamer 运行不稳定

> ID：13980865
> 
> 赞同：0
> 
> 时间：2012-12-20T21:36:34.543
> 
> 标签：python, opencv, webcam, raspberry-pi, v4l2

我正在使用树莓派为我的父母制作一个在线网络摄像头。我希望它捕获照片，将其上传到网络服务器，然后将副本上传到不同的服务器进行存档。我使用脚本流媒体从网络摄像头中截取静止图像。它有效，问题是流媒体似乎有时会崩溃，循环错误消息“v4l2：oops：select timeout”。这可能在几次拍摄后发生，或者在运行 10 分钟后发生，这似乎是随机的。我添加了一个命令，在每个快照之后终止流媒体进程，它确实使程序更加稳定，但最终它仍然卡在错误循环中。我不知道问题是什么，甚至不知道如何调试它。我该怎么办？

我正在使用包含驱动程序的 raspbian。网络摄像头是罗技 c200。我首先尝试使用 opencv 来捕获静止图像，但无法使其正常工作。如果有人可以提供帮助，也许它会解决问题，我不知道..

这是代码，它是python：

```
import time
import sys
from subprocess import call
import ftputil

while True:
    call("streamer -q -f jpeg -s 640x480 -o ./current.jpeg", shell=True)
    time.sleep(0.2);
    call("killall -q streamer", shell=True)
    filename = str(time.time()) + ".jpg"
    host = ftputil.FTPHost(*****)
    #host.remove("/domains/***/public_html/webcam.jpg")
    host.upload("./current.jpeg", "/domains/***/public_html/webcam.jpg", mode='b')
    host.close()
    host = ftputil.FTPHost(****)
    #host.remove("/domains/***/public_html/webcam.jpg")
    host.upload("./current.jpeg", "/webcamarchive/"+filename, mode='b')
    host.close()
    time.sleep(10); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T12:36:45.360

没关系，用 pygame 代替：

```
cam = pygame.camera.Camera("/dev/video0",(640,480))
cam.start()
image = cam.get_image() 
```

# php - Masonry JQuery 的翻转动画

> ID：13980869
> 
> 赞同：0
> 
> 时间：2012-12-20T21:36:46.383
> 
> 标签：php, wordpress, jquery-animate, jquery-masonry

我在我的网站[http://zakiyadavidson.com](http://zakiyadavidson.com)上使用 jquery 砌体。

我想做一个翻转效果，例如[http://damiencorrell.com/](http://damiencorrell.com/)上的内容。我的最终结果将是当您翻转图片文本时出现。

我试图在下面的js代码中添加：

```
 //Set div dimensions equal to image's dimensions:
$('#image_holder1').width($('#image_1').width());
$('#image_holder1').height($('#image_1').height());
$('#image_1').each(function(){
//set css of right:
$(this).css({right: '-' + $(this).width() + 'px'})})
    //tell the browser what to do when hovering on the div:
    $('#image_holder1').hover(function() {
  //when mouse hover:
$('#image_0').animate({
    right: '-' + $(this).width() + 'px'
}, /*duration*/ 360, /*ease*/ 'swing');
$('#image_1').animate({
    right: '0px'
}, /*duration*/ 360, /*ease*/ 'swing');
},

function() {
//when mouse out, no hover:
$('#image_0').animate({
    right: '0px'
}, /*duration*/ 360, /*ease*/ 'swing');
$('#image_1').animate({
    right: '-' + $(this).width() + 'px'
}, /*duration*/ 360, /*ease*/ 'swing');
});​ 
```

连同上面的 js 代码，我在下面的 css 块中添加：

```
#image_holder1 {
overflow: hidden;
}

.image1 {
position: absolute;
}​ 
```

砌体 html 如下所示，上面添加了更改：

```
<div class="box photo col3" id="image_holder1">
  <img id="image_0" src="image_17.jpg" title="Family First" alt="Family First" />
  <img id="image_1" src="image_17Hover.jpg" /> 
```

...

而不是在您将鼠标悬停时显示的图像，您可以在加载页面时立即看到它。砌体布局现在未正确对齐。是不是因为我有onload事件下的功能？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:13:03.570

我想到了！！！

一个简单的 Jquery 脚本就可以解决问题，并且可以让您根据需要制作尽可能多的图片！！

```
<script>

jQuery(function () {
$(".imgSwap img").hover(function () {
    this.src = this.src.replace("_off", "_on");
}, function () {
    this.src = this.src.replace("_on", "_off");
});
});

</script> 
```

我希望这对其他人有所帮助。

[您可以访问我的网站http://zakiyadavidson.com](http://zakiyadavidson.com)查看工作脚本

# jquery - jQuery $.ajax 调用同步执行而不是同时调用 WCF 服务

> ID：13980870
> 
> 赞同：11
> 
> 时间：2012-12-20T21:36:50.690
> 
> 标签：jquery, asp.net, ajax

我有一个 Web 应用程序，其中包含一个页面，该页面上有一个包含数百个字段的表单。更改任何字段都会触发 jQuery $.ajax 回调到服务器以确定是否需要根据新值将任何其他字段添加到表单中。换句话说，当一个字段发生变化时，它会检查是否需要将任何依赖字段添加到表单中。

这个过程有点复杂，因此，有时这些检查可能需要几秒钟。

问题是，如果一个字段处于其 $.ajax 调用的中间，并且我在等待第一个字段完成时尝试更改另一个字段，则 UI 会被阻止并且我无法在页面上执行任何操作，直到第一次通话完成。就像 UI 一次只能处理一个 $.ajax 调用。这是 $.ajax 调用的副本：

```
$.ajax({
        type: "POST",
        async: true,
        url: serviceUrl,
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        processdata: true,
        success: serviceSuccess,
        error: serviceFailed
    }); 
```

`serviceSuccess`回调有很多复杂的代码来更新 UI，但是我删除了其中的所有代码，问题仍然存在。我认为这与回调没有任何关系，因为它似乎发生在调用完成之前，但为了确定，我试了一下。

有没有人用 jQuery $.ajax 听说过这样的事情？

**编辑：**我注意到从 $.ajax 调用返回的响应大小约为 130k。

**编辑 2：** $.ajax 调用正在调用 WCF 服务。类定义现在如下所示：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class ReviewDataService : IReviewDataService, IReadOnlySessionState 
```

**解决方案：**所以 Jason 肯定为我指明了正确的方向。事实上，我的问题是由于 ASP.NET 会话锁定。为了解决这个问题，我必须从调用堆栈中的任何位置消除对源自我的 WCF 服务的调用的 Session 使用。此外，我将 AspNetCompatibilityRequirementsMode 设置为 AspNetCompatibilityRequirementsMode.NotAllowed 并在 web.config 的 serviceHostingEnvironment 元素中设置 aspNetCompatibilityEnabled="false"。

这导致 WCF 在尝试访问 Session 时抛出错误，并且我重构了这些实例中的每一个，以便它们不依赖于 session。之后，我的 WCF 调用开始并发运行，而不是同步运行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T21:42:46.430

如果您使用的是 ASP.NET，它们会在 Session 对象上使用读/写锁。这使得 AJAX 请求串行。

在 ASP.NET 中，您可以拥有实现 IReadOnlySessionState 的 IHttpHandler，它不会在 Session 上放置读/写锁。虽然不确定您使用的是什么环境。

**编辑 1**

这篇文章似乎表明 WCF 服务不允许您灵活地解锁会话：

[如何强制 IIS 托管的 WCF 或 ASMX [webservice] 以只读方式使用会话对象？](https://stackoverflow.com/questions/1269198/how-to-force-an-iis-hosted-wcf-or-asmx-webservice-to-use-session-object-readon)

**编辑 2**

设置不会锁定 Session 对象的 IHttpHandler。

*网页配置*

```
<configuration>
    <connectionStrings>
    </connectionStrings>
    <system.web>
        <compilation debug="true" targetFramework="4.0" />
    </system.web>
    <system.webServer>
        <httpProtocol>
            <customHeaders>
                <add name="Access-Control-Allow-Origin" value="*" />
            </customHeaders>
        </httpProtocol>
        <modules runAllManagedModulesForAllRequests="true" />
        <handlers>
            <add name="MyProvider" path="MyProvider.aspx" verb="*" type="MyNamespace.MyProvider" resourceType="Unspecified" />
        </handlers>
    </system.webServer>
</configuration> 
```

*MyProvider.cs*

```
using System;
using System.Web;
using System.Web.SessionState;

namespace MyNamespace
{
    public class MyProvider : IHttpHandler, IReadOnlySessionState
    {
        public bool IsReusable
        {
            get { return true; }
        }

        public void ProcessRequest(HttpContext context)
        {
        }
    }
} 
```

如果你想创建一个接收和返回 JSON 对象的提供者，你可以为请求和响应创建类，然后你的处理程序可以这样设置：

*MyProvider.cs（处理 JSON 对象）*

```
using System;
using System.Runtime.Serialization.Json;
using System.Web;
using System.Web.SessionState;

namespace TestWebsite
{
    public class MyProvider : IHttpHandler, IReadOnlySessionState
    {
        public bool IsReusable
        {
            get { return true; }
        }

        public void ProcessRequest(HttpContext context)
        {
            var response = new Json.Response();
            try
            {
                var requestSerializer = new DataContractJsonSerializer(typeof(Json.Request));
                var request = (Json.Request)requestSerializer.ReadObject(context.Request.InputStream);

                // ...
            }
            catch (Exception ex)
            {
                response.Error = ex.ToString();
            }

            try
            {
                var responseSerializer = new DataContractJsonSerializer(typeof(Json.Response));
                context.Response.ContentType = "application/json";
                responseSerializer.WriteObject(context.Response.OutputStream, response);
            }
            catch (Exception)
            {
                throw;
            }
        }
    }
} 
```

# sql - 检查文件是否存在？

> ID：13980871
> 
> 赞同：5
> 
> 时间：2012-12-20T21:36:51.503
> 
> 标签：sql, oracle, plsql

试图检查我要读取的文件是否存在。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-21T06:03:31.163

这是另一种方法：

1.  包的使用`BFILE`和`fileexists`功能`dbms_lob`：

    ```
    create or replace function FileExists(
       p_DirName in varchar2,     -- schema object name
       p_FileName in varchar2
     ) return number
    is
      l_file_loc bfile;
    begin
      l_file_loc := bfilename(upper(p_DirName), p_FileName);
      return dbms_lob.fileexists(l_file_loc);  -- 1 exists; 0 - not exists
    end; 
    ```

2.  使用包`fgetattr`功能`utl_file`：

    ```
    create or replace function FileExists(
      p_DirName in varchar2,     -- schema object name
      p_FileName in varchar2
    ) return number
    is
      l_fexists boolean;
      l_flen   number;
      l_bsize  number;
      l_res    number(1);
    begin
      l_res := 0;
      utl_file.fgetattr(upper(p_DirName), p_FileName, l_fexists, l_flen, l_bsize);
      if l_fexists
      then
        l_res := 1;
      end if;  
      return l_res;
    end; 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T22:05:26.157

创建一个检查文件是否存在的函数相当容易，只需尝试打开它并捕获任何异常（此示例函数取自[AskTom](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:7682748147019)）

```
CREATE OR REPLACE FUNCTION file_exists(p_fname IN VARCHAR2) RETURN BOOLEAN
AS
  l_file UTL_FILE.FILE_TYPE;
BEGIN
  l_file := UTL_FILE.FOPEN(SUBSTR( p_fname, 1, instr(p_fname,'/',-1) ),
                           SUBSTR( p_fname, instr( p_fname, '/', -1)+1 ), 'r' );   
  UTL_FILE.FCLOSE( l_file );
  RETURN TRUE;
EXCEPTION
  WHEN UTL_FILE.INVALID_PATH      THEN RETURN FALSE;
  WHEN UTL_FILE.INVALID_OPERATION THEN RETURN FALSE;
END;
/ 
```

然后你可以使用;

```
IF ( file_exists( 'MED_LIST_19_OCT_12.csv' ) )
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-12T11:11:25.017

使用`UTL_FILE.FGETATTR`功能。此功能专为此目的而设计。

## 句法：

```
UTL_FILE.FGETATTR(
   location     IN VARCHAR2, 
   filename     IN VARCHAR2, 
   fexists      OUT BOOLEAN, 
   file_length  OUT NUMBER, 
   block_size   OUT BINARY_INTEGER); 
```

## 例子：

```
DECLARE
  fexists      BOOLEAN;
  file_length  NUMBER;
  block_size   BINARY_INTEGER;
BEGIN

    UTL_FILE.FGETATTR('MY_ORA_DIRECTORY', 'my_file_name.csv', fexists, file_length, block_size);
    IF fexists THEN
       -- Do something
       -- ...
    END IF;

END IF; 
```

Oracle 文档： [https](https://docs.oracle.com/database/121/ARPLS/u_file.htm#ARPLS70915)
://docs.oracle.com/database/121/ARPLS/u_file.htm#ARPLS70915 另一个有用的链接： [https ://www.foxinfotech.in/2018/09/how-to-check-if -file-exists-in-pl-sql.html](https://www.foxinfotech.in/2018/09/how-to-check-if-file-exists-in-pl-sql.html)

# spotify - CocoaLibSpotify 通过 Spotify 应用程序登录？

> ID：13980875
> 
> 赞同：1
> 
> 时间：2012-12-20T21:37:37.680
> 
> 标签：spotify, cocoalibspotify-2.0

我已经将 CocoaLibSpotify 与我的 iOS 应用程序集成在一起，我想知道如果用户已经在手机上登录了 Spotify 应用程序，是否有办法让他们不必输入凭据。

我知道 Spotify 不支持 OAuth，但我确实想问是否有人知道 Spotify (1) 是否计划在未来支持 OAuth，或者 (2) 正在研究另一种方式来避免用户重新输入凭据同一服务的另一个应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T09:35:15.780

这对于 CocoaLibSpotify 是不可能的——用户第一次想要登录时，他们必须输入他们的凭据。

完成此操作后，CocoaLibSpotify 具有用于保存用户凭据并在下次使用它们的 API，因此用户只需输入一次凭据即可。老实说，由于具有 OAuth 的应用程序也会对用户进行一次身份验证，因此 CocoaLibSpotify 使用的方法对用户来说并不是真正的额外努力。

登录后查看delegate方法`session:didGenerateLoginCredentials:forUserName:`获取凭证，`attemptLoginWithUserName:existingCredential:`下次再登录。

# linux - httpd (pid 1766) 已经在运行，但我无法加载 localhost 并在浏览器上查看 apache 确认

> ID：13980880
> 
> 赞同：1
> 
> 时间：2012-12-20T21:38:18.740
> 
> 标签：linux, apache, centos, apache-config

所以我在 linux 上安装了 APACHE ..我输入了 apachectl start 并让 httpd (pid 1766) 已经运行但我在浏览器上什么也看不到.. 当我输入机器的本地 IP 地址时，它应该带来一个带有 APACHE 的屏幕显示它现在正在运行..但是页面不断加载和加载..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T08:27:42.977

配置有问题。

*   首先尝试重新启动（如果 pid 已经在运行...首先停止）另一个问题可以帮助您
*   打开 httpd.conf，查找 httpd.pid（或 apache.pid 或链。“Pid”）的位置
*   ps aux |grep httpd # 你看到 apache 正在运行的进程。如果运行停止它。检查设置
*   在系统上 ls -lisa "location_of_pid"
*   如果有任何结果，请删除文件“location_of_pid”

# .net - 在 Windows 8 上安装 .net 2.0 SDK

> ID：13980882
> 
> 赞同：27
> 
> 时间：2012-12-20T21:38:27.257
> 
> 标签：.net, sdk, windows-8, failed-installation

是否有人在 Windows 8 x64 上成功安装了 .NET 2.0 SDK（ [x86](http://www.microsoft.com/en-us/download/details.aspx?id=19988)或[x64 ）？](http://www.microsoft.com/en-us/download/details.aspx?id=15354)

我之前在所有以前的 Windows 版本上都安装了它而没有问题（几个月前我最后一次在 Windows 7 x64 上安装了 x86 和 x64 版本），但我无法在 Windows 8 x64 上安装它。

我知道它现在已经过时了，但它是我所知道的安装 .NET Framework 配置插件的唯一方法，虽然我知道 CASPOL 也是如此，但我仍然希望能够看到图形表示尝试制定自定义程序集权限，它对于生成程序集权限安装程序仍然非常有用。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-28T02:12:34.650

我也设法做到了，但是通过使用 WinRAR 从我下载的原始 setup.exe 文件中提取文件。当我从提取的文件中运行“install.exe”时，我能够正常安装 SDK。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-21T20:43:48.293

好的，我找到了自己的解决方案。

您需要首先将安装程序下载到 Windows 7 机器上。

下载后，我重命名了每个 setup.exe 文件以表示它们是什么。因此，x86 版本更名为 setup.net20.sdk.x86.exe，x64 版本更名为 setup.net20.sdk.x64.exe。

现在，在您下载（并可选择重命名）安装程序可执行文件的文件夹中打开命令提示符并运行以下命令...

*   setup.net20.sdk.x86.exe /t:"C:\net20sdk86" /c
*   setup.net20.sdk.x64.exe /t:"C:\net20sdk64" /c

显然，如果您选择不重命名下载的文件，则必须相应地修改命令。

最后，将文件夹 C:\net20sdk86 和 C:\net20sdk64 复制到你的 windows 8 机器，然后从 C:\net20sdk86 运行 install.exe，然后（假设你是 64 位）C:\net20sdk64。请注意，您应该使用管理权限运行这些文件夹中的每个安装程序（右键单击“以管理员身份运行”）。

然后，您寻找的配置向导将显示在开始屏幕上。如果它们不存在，请打开超级按钮菜单（从开始屏幕），选择设置，然后选择磁贴，并确保启用了“显示管理工具”。

瞧！

# javascript - 在 Canvas Renderer 中带有回调的 ImageUtils.loadTexture

> ID：13980889
> 
> 赞同：7
> 
> 时间：2012-12-20T21:38:54.827
> 
> 标签：javascript, canvas, webgl, three.js

我正在使用 three.js 修订版 53

在 Canvas Renderer（Win7 上的 IE）中加载纹理并为 onLoad 事件添加回调时，不会显示纹理。当我删除回调函数时，纹理将按预期显示：

// 不工作与回调添加

```
var material = new THREE.MeshBasicMaterial({
            map: THREE.ImageUtils.loadTexture('text_build.png', {}, function()
            {
 //do something
            })
});
var plane = new THREE.Mesh(new THREE.PlaneGeometry(135, 135), material);
plane .overdraw = true;
scene.add(plane ); 
```

// 没有回调的工作

```
var material = new THREE.MeshBasicMaterial({
             map: THREE.ImageUtils.loadTexture('text_build.png')
});
var plane = new THREE.Mesh(new THREE.PlaneGeometry(135, 135), material);
plane .overdraw = true;
scene.add(plane ); 
```

在 WebGL 渲染器（FF，WIN7 上的 Chrome）中运行相同的代码时，两个示例都可以正常工作。

也许有人可以指出我显然在这里犯的错误。

非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T22:16:15.637

试试这个：

```
var material = new THREE.MeshBasicMaterial({    
    map: THREE.ImageUtils.loadTexture( 'text_build.png', new THREE.UVMapping(), function() { ... } )
}); 
```

# javascript - $watch'ing Angular 指令中的数据更改

> ID：13980896
> 
> 赞同：133
> 
> 时间：2012-12-20T21:39:26.143
> 
> 标签：javascript, angularjs, angularjs-directive

如何`$watch`在操作内部数据（例如，插入或删除数据）时触发 Angular 指令中的变量，但不为该变量分配新对象？

我有一个当前从 JSON 文件加载的简单数据集。我的 Angular 控制器执行此操作，并定义了一些函数：

```
App.controller('AppCtrl', function AppCtrl($scope, JsonService) {
    // load the initial data model
    if (!$scope.data) {
        JsonService.getData(function(data) {
            $scope.data = data;
            $scope.records = data.children.length;
        });
    } else {
        console.log("I have data already... " + $scope.data);
    }

    // adds a resource to the 'data' object
    $scope.add = function() {
        $scope.data.children.push({ "name": "!Insert This!" });
    };

    // removes the resource from the 'data' object
    $scope.remove = function(resource) {
        console.log("I'm going to remove this!");
        console.log(resource);
    };

    $scope.highlight = function() {

    };
}); 
```

我有一个`<button>`正确调用该函数的`$scope.add`函数，并且新对象已正确插入到`$scope.data`集合中。每次点击“添加”按钮时，我设置的表格都会更新。

```
<table class="table table-striped table-condensed">
  <tbody>
    <tr ng-repeat="child in data.children | filter:search | orderBy:'name'">
      <td><input type="checkbox"></td>
      <td>{{child.name}}</td>
      <td><button class="btn btn-small" ng-click="remove(child)" ng-mouseover="highlight()"><i class="icon-remove-sign"></i> remove</button></td>
    </tr>
  </tbody>
</table> 
```

`$scope.data`但是，当这一切发生时，我设置的要监视的指令不会被触发。

我在 HTML 中定义我的标签：

```
<d3-visualization val="data"></d3-visualization> 
```

这与以下指令相关联（为问题健全而修剪）：

```
App.directive('d3Visualization', function() {
    return {
        restrict: 'E',
        scope: {
            val: '='
        },
        link: function(scope, element, attrs) {
            scope.$watch('val', function(newValue, oldValue) {
                if (newValue)
                    console.log("I see a data change!");
            });
        }
    }
}); 
```

我一`"I see a data change!"`开始就收到消息，但在我点击“添加”按钮之后就再也没有收到消息。

`$watch`当我只是从对象中添加/删除对象时，如何触发事件`data`，而不是获取一个全新的数据集来分配给`data`对象？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2012-12-20T21:47:20.047

您需要启用深度对象脏检查。默认情况下，角度仅检查您观看的顶级变量的引用。

```
App.directive('d3Visualization', function() {
    return {
        restrict: 'E',
        scope: {
            val: '='
        },
        link: function(scope, element, attrs) {
            scope.$watch('val', function(newValue, oldValue) {
                if (newValue)
                    console.log("I see a data change!");
            }, true);
        }
    }
}); 
```

见[范围](http://docs.angularjs.org/api/ng.$rootScope.Scope)。$watch 函数的第三个参数如果设置为 true，则启用深度脏检查。

请注意，深度脏检查是**昂贵的**。因此，如果您只需要查看子数组而不是整个`data`变量，请直接查看变量。

```
scope.$watch('val.children', function(newValue, oldValue) {}, true); 
```

1.2.x 版本引入了[$watchCollection](https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$watchCollection)

> Shallow 监视对象的属性并在任何属性更改时触发（对于数组，这意味着监视数组项；对于对象映射，这意味着监视属性）

```
scope.$watchCollection('val.children', function(newValue, oldValue) {}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-22T16:16:30.930

因为如果你想用它来触发你的数据，你必须传递`true`你的监听器的第三个参数。默认情况下`false`，它意味着你的函数会触发，只有当你的**变量不会改变它的字段**时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-10T09:55:19.230

我的指令版本使用 jqplot 在数据可用后绘制数据：

```
 app.directive('lineChart', function() {
        $.jqplot.config.enablePlugins = true;

        return function(scope, element, attrs) {
            scope.$watch(attrs.lineChart, function(newValue, oldValue) {
                if (newValue) {
                    // alert(scope.$eval(attrs.lineChart));
                    var plot = $.jqplot(element[0].id, scope.$eval(attrs.lineChart), scope.$eval(attrs.options));
                }
            });
        }
}); 
```

# sql - 是否可以创建没有行的派生表？

> ID：13980897
> 
> 赞同：0
> 
> 时间：2012-12-20T21:39:31.557
> 
> 标签：sql, sql-server-2008

换句话说，我可以这样说：

```
MERGE MyTable AS trg
USING (VALUES(1, 'a')) AS src(key, val)
ON ... 
```

我也想这样说：

```
-- does not work:
MERGE MyTable AS trg
USING () AS SRC(key, val)
ON ... 
```

有没有办法做到这一点？除了 MERGE、FROM 等文档中的切线引用之外，我似乎找不到太多关于派生表（Sql Server 2008R2）的官方文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:56:17.340

是的，通过使用永远不会返回任何行作为派生表的查询：

```
USING (SELECT 1 as 'key', 1 as 'val' where 1 = 0) AS src (key, val) 
```

# java - 在 @PersistenceContext 中设置 unitName 的 Spring Hibernate 配置

> ID：13980903
> 
> 赞同：4
> 
> 时间：2012-12-20T21:39:46.720
> 
> 标签：java, spring, hibernate, jpa

我在这里和网上看到了一些关于此的问题，但它们似乎与我收到的错误消息不太匹配。

我一直在我的代码中使用 JPA 注释来处理数据库。我使用@PersistenceContext 注释来配置实体管理器。这一切都很好，直到我向我的持久性 xml 添加多个持久性单元。然后我想打电话

```
@PersistenceContext(unitName = "myPU") 
```

然后我遇到了问题，说没有找到名为 myPU 的 bean

我实际上已经从我的 persistence.xml 中删除了第二个持久性单元，并且我只是想通过名称基本上引用我的一个持久性单元（我知道这不是必需的，但是一旦我添加另一个 pu 就会这样做）。

我的 persistence.xml 是

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
         http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
<persistence-unit name="myPU" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc/mycore</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect"/>
    </properties>
</persistence-unit> 
```

我的 core-context.xml 是

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:tx="http://www.springframework.org/schema/tx"
   xmlns:jee="http://www.springframework.org/schema/jee"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context  
   http://www.springframework.org/schema/context/spring-context-3.0.xsd  http://www.springframework.org/schema/tx  http://www.springframework.org/schema/tx/spring-tx-3.0.xsd  
   http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd">

<context:annotation-config/>

<context:component-scan base-package="com.mine.model"/>
<bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor">
    <property name="persistenceUnits">
        <map>
            <entry key="myPU" value="jdbc/mycore"/>

        </map>
    </property>
</bean>
<bean class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<tx:jta-transaction-manager/>
<tx:annotation-driven/>

<jee:jndi-lookup id="entityManagerFactory" jndi-name="jdbc/mycore"/> 
```

我得到的确切错误是

```
Error occurred during deployment: Exception while loading the app :  java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'myfirstbean': Injection of persistence dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'myPU' is defined. Please see server.log for more details. 
```

目前我正在尝试部署到 Glassfish。

任何人都可以帮忙吗？我确定我在这里遗漏了一些非常基本的东西

谢谢

**编辑**

我尝试了 MasterSlave 给出的答案，不幸的是这不起作用。

```
@PersistenceContext(unitName = "myPU", name="jdbc/mycore") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T14:58:51.720

我设法通过清理我的 core-context.xml 文件并删除几行不需要的行来实现这一点。我发现[这](http://forum.springsource.org/showthread.php?115587-Example-for-using-two-databases-w-Spring-amp-JTA-transaction-manager)特别有用

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" ... and some more stuff>

   <context:annotation-config/>
   <context:component-scan base-package="com.my.model"/>

   <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"/>
   <tx:jta-transaction-manager/>
   <tx:annotation-driven/>

   <jee:jndi-lookup id="corePU" jndi-name="jdbc/mycore"/>
</beans> 
```

# python - 在 Python 2.7 中从 Unicode 转换字符串时遇到问题？

> ID：13980906
> 
> 赞同：1
> 
> 时间：2012-12-20T21:40:03.873
> 
> 标签：python, unicode, beautifulsoup

我对 Python 2.x 中的 unicode 感到非常困惑。

我正在使用 BeautifulSoup 抓取网页，并尝试将我找到的内容插入到字典中，名称为键，url 为值。

我正在使用 BeautifulSoup 的`find`功能来获取我需要的信息。我的代码开始如下：

```
name = i.find('a').string
url = i.find('a').get('href') 
```

这有效，除了从返回的thign`find`是一个对象，而不是一个字符串。

*事情开始让我感到困惑*

`str`如果我在将其分配给变量之前尝试将其转换为类型，它有时会抛出一个`UnicodeEncodeError`.

```
'ascii' codec can't encode character u'\xa0' in position 5: ordinal not in range(128) 
```

我四处搜索，发现我应该编码为`ascii`

我尝试添加：

```
print str(i.find('a').string).encode('ascii', 'ignore') 
```

不走运，仍然给出一个 Unicode 错误。

从那里，我尝试使用`repr`.

```
print repr(i.find('a').string) 
```

那行得通……几乎！

我在这里遇到了一个新问题。

一旦一切都说完了，字典也建好了，我就什么也不能访问了！它一直给我一个`KeyError`.

我可以遍历字典：

```
for i in sorted(data.iterkeys()):
    print i

>>> u'Key1'
>>> u'Key2'
>>> u'Key3'
>>> u'Key4' 
```

但是如果我尝试像这样访问字典的一个项目：

```
print data['key1'] 
```

或者

```
print data[u'key1'] 
```

或者

```
test = unicode('key1')
print data[test] 
```

它们都返回 KeyErrors，这让我 100% 感到困惑。我认为这与它们是 Unicode 对象有关。

我已经尝试了几乎所有我能想到的东西，但我不知道发生了什么。

哦！更奇怪的是，这段代码：

```
name = repr(i.find('a').string)
print type(name) 
```

返回

```
>>> type(str) 
```

但如果我只是打印东西

```
print name 
```

它显示为 unicode 字符串

```
>>>> u'string name' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:42:02.450

该`.string`值确实不是字符串。您需要将其转换为`unicode()`：

```
name = unicode(i.find('a').string) 
```

这是一个类似于 unicode 的*对象*，称为[`NavigableString`](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#navigablestring). 如果你真的*需要*它`str`，你可以从那里对其进行编码：

```
name = unicode(i.find('a').string).encode('utf8') 
```

或类似的。对于在 a 中使用，`dict`我会使用`unicode()`对象而不是编码。

要了解编码之间的区别`unicode()`以及`str()`使用什么编码，我建议您阅读[Python Unicode HOWTO](http://docs.python.org/2/howto/unicode.html)。

# python - XSLT：省略嵌入在文本中的声明

> ID：13980909
> 
> 赞同：1
> 
> 时间：2012-12-20T21:40:08.327
> 
> 标签：python, xslt, groovy, declaration, xalan

希望大家能帮忙。我有一个字符串（请记住它类似于 XML，但我的应用程序将其视为二进制字符串），其中包含文本中的多个 xml 声明。我想删除这些声明。例如

```
<?xml version="1.0" encoding="UTF-8"?>
<Parent>
    <?xml version="1.0" encoding="UTF-8"?>
    <Child1>
    .
    .
    </Child1>
    <?xml version="1.0" encoding="UTF-8"?>
    <Child2>
    .
    .
    </Child2>
</Parent> 
```

omit-xml-declaration="yes" 在这种情况下将不起作用，因为它无法访问文档中的声明。除了使用 XSLT 的第一个声明之外，还有什么方法可以转义任何声明？我也许可以以某种方式使用 CDATA（但不确定这是否可行）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T08:47:20.603

这是使用 XSLT 无法实现的！

原因：解析器需要有效的 XML。您列出的示例代码不是有效的 XML。

解决方案：

1.  如果可以修改生成此类 XML 的源代码，请更正它！由于第二个建议不推荐！否则，如果您别无选择，那么
2.  通过使用字符串操作或使用正则表达式的主机程序（如 C# 或 Java）将此声明部分替换为空/空格来修改 XML。RegEx 会更有用，因为字符串模式在整个代码中总是很常见。

# node.js - Nodejs 将昂贵的同步任务转换为异步系列

> ID：13980910
> 
> 赞同：1
> 
> 时间：2012-12-20T21:40:09.277
> 
> 标签：node.js, asynchronous

在 nodejs 中，我有一个昂贵的功能，例如：

```
function expensiveCode(){
  a.doExensiveOperation(1);
  b.doAnotherExensiveOperation(2);
  c.doADiffererentExensiveOperation(3);
  d.doExensiveOperation(4);
} 
```

这样每个子函数调用都有不同的参数，因此不能在循环中完成。我想限制这个昂贵的函数调用，以便每个子调用都在 nextTick 上完成，例如：

```
function expensiveCode(){
    process.nextTick(function(){
        a.doExensiveOperation(1);
        process.nextTick(function(){
            b.doAnotherExensiveOperation(2);
            process.nextTick(function(){
                c.doADiffererentExensiveOperation(3);
                process.nextTick(function(){
                  d.doExensiveOperation(4);                 
                });
            });
        });
    });
} 
```

这显然是丑陋的，如果有 20 行不同的操作就太可怕了，甚至无法考虑。

我已经查看了许多库，例如“async.js”，但它们似乎都希望被调用的函数是异步的——在完成时有一个回调函数。我需要一种简单的方法来做到这一点，而无需将我的所有代码都转换为“完成时回调”方法，这似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:07:20.150

很抱歉打破你的泡沫，但`async.waterfall`或者也许`async.series`结合`async.apply`是你想要的，是的，你需要使这些操作异步。我很难相信你已经找到了 20 种不同的计算密集型操作，它们都没有做任何 IO。查看该`bcrypt`库以获取有关如何提供 CPU 密集型调用的同步和异步版本的示例。在完成时将代码转换为回调并不过分，它是 node.js 。这就是节点中的规则。要么您的函数不执行 IO 并快速完成，要么您通过回调使其异步。选项结束。

# haskell - 列表理解和类型问题 (Haskell)

> ID：13980911
> 
> 赞同：2
> 
> 时间：2012-12-20T21:40:10.050
> 
> 标签：haskell, types, primes

我在以下构造中有烦人的语法错误：

```
isPrime n = if numOfDivisors n == 0 then True else False            
    where numOfDivisors n = length $ [x | x <- [2..ceiling (sqrt n)], n `mod` x == 0] 
```

我该如何解决？我是 Haskell 的新手，所以我不知道`[2..ceiling (sqrt n)]`.

谢谢（对不起我可怜的大脑）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T21:51:19.047

您同时使用`sqrt`and `mod`with `n`--第一个需要浮点类型，后者需要整数类型。您可能想要后者，并改为使用`sqrt (fromIntegral n)`。

其他一些不请自来的建议：

*   没有可能的理由去做`if foo then True else False`。只需单独使用布尔表达式。

*   函数参数在`where`子句的范围内，因此`numOfDivisors`不需要`n`作为参数。

*   不要`length`用于检查列表是否为空。改为在除数列表上使用`null`。

# c++ - 找不到 DLL 入口点

> ID：13980912
> 
> 赞同：3
> 
> 时间：2012-12-20T21:40:13.880
> 
> 标签：c++, vba, dll, entry-point

我一直在尝试在我的 VBA 项目中调用 DLL 函数，但我不断收到此错误消息：

`Run-time error '453': Can't find DLL entry point "CheckStatus" in "Power.dll"`

以下是 C++ 文件中 DLL 的定义：

`#define CLASS_DECLSPEC extern "C" __declspec(dllexport)`

`CLASS_DECLSPEC int __stdcall CheckStatus();`

这就是我试图声明它并在 VBA 中调用它的方式：

```
Public Declare Function CheckStatus Lib "Power.DLL" () As Long

Dim test As Long
test = CheckStatus 
```

然后当我运行它时收到上述错误消息。

有谁知道如何解决这一问题？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:43:40.280

这与名称修改有关（即使是`extern "C"`）。
看看 DLL 中真正的导出是什么，猜测可能是`_CheckStatus`或`_CheckStatus@0`.
要强制名称保持原样，`.def`请在项目中创建一个包含以下内容的文件：

```
EXPORTS
    CheckStatus=CheckStatus 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T22:24:03.287

使用[这篇](http://msdn.microsoft.com/en-us/library/office/aa165080%28v=office.10%29.aspx)MSDN 文章，我会尝试这种声明函数的方法：

```
Public Declare Function CheckStatus Lib "Power.DLL" Alias "_CheckStatus@0" () As Long 
```

# javascript - 是否可以独立运行 jquery/javascript 脚本？

> ID：13980914
> 
> 赞同：0
> 
> 时间：2012-12-20T21:40:18.367
> 
> 标签：javascript, jquery, html

我的计算机上有许多 html 页面，我想编写一个 javascript 脚本来获取这些页面的某些文本/元素（请参阅[从 html 页面中提取元素](https://stackoverflow.com/questions/13978021/extract-elements-from-a-html-page)）有人编写了一些 jquery 代码，可以提取我想要的元素，但是我不知道如何在 linux 控制台上的 html 页面上运行脚本并将提取的元素放入日志文件

所以基本上我想像这样运行：

```
javascript.js page1.html

javascript.js page2.html

javascript.js page3.html 
```

此外，是否可以使用 javascript 写入某些文件？顺便说一句，我在linux上谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:48:36.560

有几种方法可以在命令行运行 Javascript。

如果您在 Windows 上，您可以`WSH`在 JS 中编写 -style shell 脚本。完毕！

如果你在 Mac/Linux 上，你只需要一个命令行 JS 解析器。我尝试了一些，我喜欢`V8`最好的，虽然编译它有点痛苦。

不过，关于使用 jQuery 的部分意义不大，因为 jQuery 主要旨在为网页的 DOM 提供快捷方式。

因此，如果您真正希望做的是针对多个 HTML 文件运行脚本并查询它们的 DOM，那么可能是时候查看 .`Webdriver`虽然`Phantomjs`可能是一个更容易开始的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:49:27.320

也许您正在寻找[Node.js](http://nodejs.org/)？这是一个允许您编写服务器端 javascript 的框架，并且有用于读取和写入磁盘的库。

但是，您应该知道 Node.js 不是浏览器，因此您无法访问 DOM（因为没有文档）。代替`window`，您会得到`process`，它包含诸如您在文件系统中的位置之类的属性。

如果您需要访问 DOM，您可能需要查看[phantom.js](http://phantomjs.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:49:13.360

在 Windows 机器上，您可以通过 WScript.exe 运行 JS 文件，例如

WScript.exe javascript.js "page1.html"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:44:57.237

如果您使用正确的框架，例如 nodejs 或 phantomjs，您可以使用 javascript 写入文件系统。我不太明白你问题的第一部分，但如果你想抓取一个网页，那么 phantomjs 是一个非常好的选择。

# java - Java 中的 Console.WriteLine 方法。建立一个字符串

> ID：13980916
> 
> 赞同：0
> 
> 时间：2012-12-20T21:40:22.010
> 
> 标签：java

在 C# 中有一种将字符串写入控制台的方法。

这是`Console.WriteLine("Hello {0} My name is {1}", "World", "John");`

这将返回

```
Hello World My name is John 
```

我如何在java中重新创建这样的方法结构。这样我就可以在我的方法结束时传入无限数量的参数并将其放置在正确的索引中？

任何帮助将不胜感激

// 编辑

也许我解释得不够好。我不需要制作控制台输出的方法。我只想知道如何重新创建一个结构，我可以在其中传递任意数量的参数并将其放置在正确的位置。例如

movie.setPlot("这部电影是 {0}，评分为 {1}", "FUN", "6 Thumbs up");

这会将电影的情节变量设置为

```
This movie is FUN and gets a rating of 6 Thumbs up 
```

// 编辑 2

最终结果：

```
private static final String PREFIX = "AwesomeApp";

    public static void e(String TAG, String msg){
        android.util.Log.e(PREFIX + "  >> " +TAG,  msg);
    }

    public static void e(String TAG, String msg, Object...args){
        e(TAG, String.format(msg, args));
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:41:40.173

您可以使用`var-args`来处理不确定数量的参数：

```
void setPlot(String text, String... args) {
   System.out.printf(text, args);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:42:23.190

您可以使用[`Formatter`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html)Java 5 中引入的类，如下所示：

```
Formatter f = new Formatter();
f.format("Hello %s my name is %s", "World", "John");
System.out.println(f.toString()); 
```

**编辑：（**响应问题的编辑）您可以在您自己的自定义方法的实现中使用格式化程序，如下所示：

```
private String plot;

void setPlot(String formatStr, Object... data) {
    Formatter f = new Formatter();
    format(formatStr, data);
    plot = f.toString();
} 
```

您现在可以`setPlot`像这样调用您的函数：

```
movie.setPlot("This movie is %s and gets a rating of %s", "FUN", "6 Thumbs up"); 
```

# java - Java Mail API - 编码问题

> ID：13980922
> 
> 赞同：12
> 
> 时间：2012-12-20T21:40:35.983
> 
> 标签：java, api, email, encoding, jakarta-mail

我正在使用 Java Mail API，并且正在尝试通过 Gmail 的 SMTP 发送电子邮件。我的程序是如何工作的： java.util.Scanner 类用于获取用户输入 - 我正在向用户询问要在邮件发送类中使用的各种参数；它执行以下操作：

```
Message mailMessage = new MimeMessage(session);
mailMessage.setFrom(new InternetAddress("example@example.com"));
mailMessage.setRecipients(Message.RecipientType.TO,InternetAddress.parse(mail.getTo()));
mailMessage.setSubject(mail.getSubject());
mailMessage.setText(mail.getMessage());
Transport.send(mailMessage); 
```

只要我使用 ASCII 符号/字符，一切正常。但是，每当我想使用“特定于国家/地区”的字符时——比如 [õäöü]——我都会得到一堆看起来很奇怪的符号......

到目前为止我使用的技术（对我不起作用）：

```
setHeader("Content-Type", "text/plain; charset=UTF-8");
setHeader("Content-Encoding","ISO-8859-9");
setContent(message, "text/plain; charset=iso-8859-2"); 
```

注意：当执行 System.out.println() 以显示要发送的消息时，IDE 中的所有内容都会正确显示。

编辑：例如，当发送的邮件正文为 [õäöü] 它在 Gmail 中显示为 [ä„”？]。

编辑：`mailMessage.setText(MimeUtility.encodeText(mail.getMessage(), "UTF-8", "Q"));`使用时，Gmail 中的输出如下：

```
"=?UTF-8?Q?=C3=A4=E2=80=9E=E2=80=9D=EF=BF=BD;=0D=0A?=" 
```

另一个编辑：有趣的是，当我这样做时：`mailMessage.setText(strVar + "õäöü", "ISO-8859-1");` 它实际上在我的电子邮件中很好地附加了“õäöü”（但字符串的第一部分 [strVar] 仍然充满了？和 []）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T22:36:30.743

```
 MimeMessage message = new MimeMessage(session);
    message.setSubject(subject, "UTF-8");
    message.setText(body, "UTF-8"); 
```

因此，必须为正文和主题设置字符编码。

* * *

***由于@bartac 的评论而出现的附录***

为对应`MimeBodyPart`做一个`setHeader("Content-Type", "text/plain; charset=UTF-8")`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T22:25:18.760

您应该使用[`setText(String text, String charset)`](http://javamail.kenai.com/nonav/javadocs/javax/mail/internet/MimeBodyPart.html#setText%28java.lang.String,%20java.lang.String%29)or[`setText(String text, String charset, String subtype)`](http://javamail.kenai.com/nonav/javadocs/javax/mail/internet/MimeBodyPart.html#setText%28java.lang.String,%20java.lang.String,%20java.lang.String%29)设置具有特定编码的文本正文。

`MimeUtility.encodeText()`不适用于正文，而仅适用于标头中的编码文本（然后仅适用于使用`setHeader`or设置的标头`addHeader`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T11:17:48.860

基本上，我的代码工作得很好，就像它应该做的那样。是 cmd，无法处理非 ascii 字母。我使用了一个 bat 文件来访问一个 jar。我想我只是要做一个小GUI...谢谢大家的回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-12T11:06:01.060

以下对我有用：

```
MimeMessage message = ...
message.setSubject(subject, "UTF-8");
message.setContent(body, "text/plain; charset=UTF-8"); 
```

where`subject`和`body`是没有特殊处理的常规 String 对象（代码和用户界面使用 UTF-8）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-23T17:58:32.170

1-考虑您想发送一封正文中包含此字符串的电子邮件：

```
"Olá João!" 
```

2 - 由于代码在 GAE 服务器中运行，此字符串使用默认的 ASCII 编码进行解释。要使用正确的重音字符发送此电子邮件，请将字符串定义为：

```
String body = "Ol\u00e1 Jo\u00e3o!"; 
```

特殊字符是使用其 UTF-8 代码手动定义的。在表中搜索您需要的代码[http://www.utf8-chartable.de/](http://www.utf8-chartable.de/)

3- 将字符串编码转换为 UTF-8。现在将正确解释所有手动输入的代码：

```
Session session = Session.getDefaultInstance(props);
MimeMessage message = new MimeMessage(session);
String encodedSubject = new String (subject.getBytes("UTF-8"),"UTF-8");
String encodedBody = new String (body.getBytes("UTF-8"),"UTF-8");
message.setSubject(encodedSubject, "UTF-8");
message.setText(encodedBody, "UTF-8"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-10T10:02:05.143

```
JavaMailSenderImpl emailSender = new JavaMailSenderImpl();
mailSender.setHost("...");

MimeMessage message = emailSender.createMimeMessage();
message.setSubject("...", "UTF-8");
message.setText("...", "UTF-8");

MimeMessageHelper helper = new MimeMessageHelper(message, "UTF-8");
helper.setFrom(from);
helper.setTo(to);

emailSender.send(message); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-07T15:45:28.337

如果您使用 HTML 消息，请尝试以下操作：

```
Message message = new MimeMessage(session);
message.setContent(htmlText, "text/html; charset=UTF-8"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-05T17:07:34.477

以下字符集对我有用：`charset=ISO-8859-1`，例如：

```
mail.setContent(testMail.getTexto(), "text/plain; charset=ISO-8859-1"); 
```

# search - ConEmu：搜索整个缓冲区

> ID：13980923
> 
> 赞同：12
> 
> 时间：2012-12-20T21:40:52.227
> 
> 标签：search, conemu

我最近搬到了 ConEmu 控制台，我很喜欢它。它非常可配置，并且具有我正在寻找的许多功能（Mac Terminal App 的替代品。）

不过，我无法弄清楚如何搜索整个历史缓冲区。有一个名为 App+F 的键，它似乎在*可见*缓冲区中搜索字符串，但没有什么可以让我搜索整个 9999 行缓冲区。有人知道这个的键盘快捷键吗？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-07-07T08:02:22.350

对于**Windows**设置不同的热键，因为`win`+`f`绑定到 Windows 操作。
以下是设置方法`ctrl`+`f` ![在此处输入图像描述](../Images/c74983b33c9986bc9ee2e1fba1fd66c2.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T09:36:51.180

`Apps`+`F`可以搜索整个缓冲区。但首先更新到**最新**版本并注意您需要“冻结控制台”才能启用缓冲区搜索。

顺便说一句，`Apps`+`F`是默认热键，您可以选择任何合适的。

# tomcat - 如何将环境变量添加到在 Tomcat 上运行的应用程序？

> ID：13980924
> 
> 赞同：3
> 
> 时间：2012-12-20T21:40:52.520
> 
> 标签：tomcat, tomcat7

我从一个 Web 应用程序生成了一个 .war，我正在尝试使用 vanilla Tomcat 7（没有 Eclipse 或其他任何东西）来部署它。

这是我的问题：应用程序依赖环境变量来连接事物然后启动。

在 CLI 中，我确实通过以下方式设置它们`APP_ENV=deploy ./run.sh`：我可以在 Tomcat 中的任何位置设置它们吗？从 Web 界面和配置文件来看，这似乎是不可能的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:46:24.133

创建一个名为 bin/setenv.sh 的文件 - 如果它在那里，它将被获取。

在那里，提供设置：

```
CATALINA_OPTS="-Dsome.property=some.value -Xmx1024m" 
```

（只有样品，你懂的）

这显然适用于系统属性，但同样适用于环境变量。我不知道通过某些接口在运行时设置它们的技术。但是，在运行时，您不需要依赖环境变量，而是可以处理任何其他配置技术。

如果要通过server.xml和web.xml，也可以使用[tomcat-environment](http://tomcat.apache.org/tomcat-6.0-doc/config/context.html#Environment_Entries)配置。（那一章也可能提供其他方法来通过 tomcat 配置您的应用程序）

# codeigniter - Codeigniter：网址保护

> ID：13980925
> 
> 赞同：4
> 
> 时间：2012-12-20T21:40:55.070
> 
> 标签：codeigniter, url, htmlpurifier

我将 mode_rewrite 与 codeiniter 一起使用以获取 url，例如：

```
 /controller/param1/param2 
```

大多数时候 param1 和 param2 将是数据库中的 ID（即数字），仅此而已。

问题是，我可以做什么以及我应该做什么来保护它免受潜在的黑客攻击？我应该为此使用 html 净化器，还是有更好的方法，或者甚至需要做些什么？

我在安全和保护方面真的是新手，我刚刚听说过 html 净化器，我不想像初学者可能倾向于在任何地方使用它。

我应该只 preg_match() 吗？

如果 preg_match() 是解决方案，哪个表达式只接受数值（ID 值）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:14:35.177

在您的配置文件中，您可以找到

```
$config['permitted_uri_chars'] = 'a-z 0-9~%.:_\-+'; 
```

您不需要使用 preg match，因为它已经在 Codeigniter 中通过这个完成了另一方面我建议进行验证，只有合适的人可以访问此链接，例如，如果项目 ID 未显示为只读用户等，您可以在控制器中进行某些检查后通过路由或重定向来处理此问题

但是我的安全性不是很好，但到目前为止我所知道的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T00:59:03.163

如果这不是特定于 codeignitor 的问题，而是一般如何清理用户输入，那么一个简单的解决方案是在提交 SQL 之前转义并引用该值。

像这样的东西会起作用（警告：未经测试的 PHP 代码）：

```
function escapeAndQuoteValue($value, $forceQuote = false) {
    if (is_null($value)) {
        $escapedString = 'NULL';
    } elseif (is_bool($value)) {
        $escapedString = $value ? 'TRUE' : 'FALSE';
    } elseif (isDigits($value) && $value[0] != '0') {
        $escapedString = $value; //return ints verbatim -- unless it has a leading zero
    } else {
        $escapedString = pg_escape_string($value);
    }

    $quoteString = 
        $forceQuote     ||
        is_null($value) || 
        is_bool($value) || 
         (isDigits($value) && $value[0] != '0');

    return $quoteString ? "'$escapedString'" : $escapedString; 
```

}

# mysql - MYSQL 日期范围 RFC 2822

> ID：13980926
> 
> 赞同：0
> 
> 时间：2012-12-20T21:41:00.117
> 
> 标签：mysql, search, datetime, between, rfc2822

**情况** 我提取格式为 RFC 2822（星期六，2012 年 12 月 1 日 05:49:45 +0000）的时间戳并将它们存储在 MYSQL 的 VARCHAR 字段中。我有一个 start_date 和 end_date。

**两个日期之间的目标** 搜索（例如 start_date BETWEEN '2012-11-01' AND '2012-12-01'）

**条件** 我想用纯 SQL 来做这件事，而不是用 PHP 做后期处理

**可接受的妥协** 我不想这样做，但如果需要，我会使用 PHP 将它们转换并存储为 DATETIME。

任何人都可以帮助我实现我的目标（如上所列）。瑞克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:06:19.430

您可以使用 str_to_date 将字符串日期转换为 datetime：

```
select str_to_date('Sat, 01 Dec 2012 05:49:45 +0000','%a, %d %b %Y %T') 
```

如果您还需要转换时区，请尝试以下操作：

```
set @datestring='Sat, 01 Dec 2012 05:49:45 +0000';
select
  CONVERT_TZ(
    str_to_date(@datestring,'%a, %d %b %Y %T'),
    concat(mid(@datestring, 27, 3), ':', mid(@datestring, 30, 2)),
    '+00:00'
  ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:43:44.010

将它们存储为原生`DATETIME`. 这是唯一理智的方法。

为什么你如此反对使用合适的工具来完成这项工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:44:26.940

将时间戳存储为字符串是对数据库功能的不良使用。由于它们都是相同的格式，因此可以很容易地在输入时将它们转换为日期时间。

# objective-c - 对多个位置进行地理编码 - 知道何时调用了“所有”完成块

> ID：13980930
> 
> 赞同：2
> 
> 时间：2012-12-20T21:41:00.743
> 
> 标签：objective-c, ios, geocoding, objective-c-blocks, grand-central-dispatch

我正在使用 CoreLocation 的地理编码器来获取多个地图项的 CLLocation 坐标。地理编码器在完成每个项目时调用一个完成块。

**当所有**这些包含异步地理编码器调用已完成时，如何创建一个类似的块功能？（我可以使用手动计数器。但必须有一个更优雅的解决方案）

到目前为止，这是我的地理编码功能。它循环遍历一系列位置项，并为每个位置项启动一个新的地理编码过程。

```
-(void)geoCodeAllItems {
    for (EventItem* thisEvent in [[EventItemStore sharedStore] allItems]) {
        if (![thisEvent eventLocationCLLocation]){ //Only geocode if the item has no location data yet
            CLGeocoder *geocoder = [[CLGeocoder alloc]init];
            [geocoder geocodeAddressString:[thisEvent eventLocationGeoQuery] completionHandler:^(NSArray *placemarks, NSError *error) {
                if (error){
                     NSLog(@"\t Geo Code - Error - Failed to geocode";
                     return;
                 }
                 if (placemarks)
                 {
                     if ([placemarks count] > 1) NSLog(@"\t Geo Code - Warning - Multiple Placemarks (%i) returned - Picking the first one",[placemarks count]);

                     CLPlacemark* placemark = [[CLPlacemark alloc]initWithPlacemark:[placemarks objectAtIndex:0]];
                     CLLocationCoordinate2D placeCoord = [[placemark location]coordinate];
                     [thisEvent setEventLocationCLLocation:[[CLLocation alloc]initWithLatitude:placeCoord.latitude longitude:placeCoord.longitude]];

                     [[EventItemStore sharedStore] saveItems];
                 } else {
                     NSLog(@"\t Geo Code - Error - No Placemarks decoded");
                 }
             }];
            geocoder = nil;
        } 
    } 
} 
```

这基本上是可行的，但是由于我不知道所有地理编码活动何时最终结束的异步方式。

我的感觉是，我要么为此创建一个块，要么使用 Grand Central Dispatch，但我不太确定。我感谢任何帮助以找到正确的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T04:15:52.430

您可以使用 GCD 调度组来执行此操作。另外，我认为您可以使用单个`CLGeocoder`.

由于我们可能根本不需要创建组和地理编码器，我们将懒惰地创建它们：

```
-(void)geocodeAllItems {
    dispatch_group_t group = NULL;
    CLGeocoder *geocoder = nil; 
```

我们遍历这些项目，跳过那些已经被地理编码的项目：

```
 for (EventItem *item in [[EventItemStore sharedStore] allItems]) {
        if (item.eventLocationCLLocation)
            continue; 
```

现在我们已经找到了一个需要地理编码的，如果我们需要，我们创建地理编码器和调度组：

```
 if (!geocoder) {
            geocoder = [[CLGeocoder alloc] init];
            group = dispatch_group_create();
        } 
```

我们将使用辅助方法对此项进行地理编码：

```
 [self geocodeItem:item withGeocoder:geocoder dispatchGroup:group];
    } 
```

现在我们已经浏览了所有项目，我们将检查我们是否对任何项目进行了地理编码：

```
 if (group) { 
```

如果我们对任何一个进行地理编码，那么调度组中就会有块。当通知块变为空时，我们将要求组执行通知块：

```
 dispatch_group_notify(group, dispatch_get_main_queue(), ^{
            NSLog(@"note: all geocoding requests have completed");
        }); 
```

最后，我们需要释放组以平衡由返回的 +1 保留计数`dispatch_group_create`：

```
 dispatch_release(group);
    }
} 
```

这是仅对一项进行地理编码的辅助方法：

```
- (void)geocodeItem:(EventItem *)item withGeocoder:(CLGeocoder *)geocoder dispatchGroup:(dispatch_group_t)group { 
```

我们“进入”了这个群体。这会自动增加组的成员资格计数器：

```
 dispatch_group_enter(group); 
```

然后我们可以开始地理编码：

```
 [geocoder geocodeAddressString:item.eventLocationGeoQuery completionHandler:^(NSArray *placemarks, NSError *error) {
        if (error) {
            NSLog(@"error: geocoding failed for item %@: %@", item, error);
        } else {

            if (placemarks.count == 0) {
                NSLog(@"error: geocoding found no placemarks for item %@", item);
            } else {
                if (placemarks.count > 1) {
                    NSLog(@"warning: geocoding found %u placemarks for item %@: using the first", item, placemarks.count);
                }
                CLPlacemark* placemark = placemarks[0];
                thisEvent.eventLocationCLLocation = placemarks[0].location;
                [[EventItemStore sharedStore] saveItems];
            }
        } 
```

在地理编码完成块中，完成所有工作后，我们“离开”该组，这会减少其成员数：

```
 dispatch_group_leave(group);
    }];
} 
```

当成员计数变为零时，该组将执行我们在末尾添加的通知块`geocodeAllItems`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T17:45:17.397

看看 NSBlockOperation 与 NSOperationQueue 一起使用

创建一个 NSBlockOperation 然后将所有单独的任务添加为执行块 [addExecutionBlock:](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSBlockOperation_class/Reference/Reference.html)。设置你的完成块[setCompletionBlock:](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html#//apple_ref/occ/cl/NSOperation)它在 NSOperation 超类中，当所有任务完成时它会被调用。默认情况下，它们不会在主线程上运行，因此如果您希望完成块在主线程上执行，则必须明确告诉它这样做。将 NSBlockOperation 添加到[NSOperationQueue addOperation:(NSOperation *) 操作](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html#//apple_ref/doc/uid/TP40004592)

[参考操作队列的并发指南页面](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html#//apple_ref/doc/uid/TP40008091-CH101-SW1)

推荐：WWDC 2012 视频会议 225（跳至 16:55）

# javascript - 在 HTML 拖动操作期间是否可以忽略标准拖放光标？

> ID：13980936
> 
> 赞同：1
> 
> 时间：2012-12-20T21:41:13.003
> 
> 标签：javascript, css, html, drag-and-drop

我正在使用 HTML 拖放 API 来帮助调整表中列的大小。但是，当用户开始拖动列时，光标会变为标准拖放效果之一（移动、无等）。我希望光标保持拖动事件启动之前的状态。这是否可以使用拖放事件，或者我是否必须使用其他事件（如单击和鼠标移动）来伪造拖放？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-20T21:49:35.817

你可以用css做到这一点

```
.elementClass {
    cursor: normal;
} 
```

# ms-access - 通过跨表查询在 Access 中打开表单

> ID：13980940
> 
> 赞同：3
> 
> 时间：2012-12-20T21:41:22.117
> 
> 标签：ms-access

这是场景。我有一个数据库，它基本上是管理文档的单一功能。对于此示例，我正在处理两个表。

表1：具有以下字段的文档表`DOCUMENT_NUM`，PK；`DOCUMENT_NAME`; 等。与表 1 的一对多关系，具有基于的参照完整性`DOCUMENT_NUM`

表2：带字段的文档修订历史表`DOCUMENT_NUM`，PK；`REVISION_DATE`; `REVISION_NUM`.

我有一个输入表 1 信息的表格，还有一个输入表 2 信息的表格，其中包含`DOCUMENT_NUM`表格 1 中的标准。

**我的问题**：我有一个搜索表单，我希望能够打开绑定到表 1 的表单 1，方法是不仅搜索表 1 中的参数，还搜索表 2 中的参数。示例：搜索在 ## 之间修改的文档/##/#### 和 ##/##/#### 但将使用“DOCUMENT_NUM”、“DOCUMENT_NAME”等打开表格 1。但是我无法进行搜索，因为 From 1 绑定到表 1我查询的信息在表 2 中。

搜索使用`DoCmd.OpenForm "Documents",,,strQuery`where`strQuery = "1=1 AND [SOPS].[SOP_NUMBER] = 'QA-001' AND [SOP_REVISIONS].[REVISION_DATE] >= #12/02/2011# AND [SOP_REVISIONS].[REVISION_DATE] <= #12/02/2012#"`

（[SOPS] == 表 1 && [SOP_REVISIONS] == 表 2）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:22:28.877

怎么样：

```
strQuery = "1=1 AND [SOPS].[SOP_NUMBER] = 'QA-001' " _
    & "AND DOCUMENT_NUM IN (" _
    & "   SELECT DOCUMENT_NUM FROM [SOP_REVISIONS] " _
    & "   WHERE [SOP_REVISIONS].[REVISION_DATE] >= #12/02/2011# " _
    & "   AND [SOP_REVISIONS].[REVISION_DATE] <= #12/02/2012#)" 
```

换句话说，使用子查询从 [SOP_REVISIONS] 中获取相关的 DOCUMENT_NUM。

# json - Phonegap 上的 vimeo 实现

> ID：13980944
> 
> 赞同：2
> 
> 时间：2012-12-20T21:41:27.983
> 
> 标签：json, cordova, vimeo

有谁知道我需要使用哪个 API 将 vimeo 实现到 phonegap ios/Android 应用程序中。我正在研究简单和高级的 API。简单的似乎没有播放器实现，我只能获取有关我的视频的数据。我希望视频在我的应用程序中播放。高级 api 似乎有一些播放器实现，但看起来我需要对用户进行身份验证。我有点迷失在这一切中。任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T15:19:09.303

1.  Iframe 共享与 PHONEGAP 相得益彰。
2.  如果您需要更换播放器，您需要一个 VIMEO 专业帐户和高级 API
3.  如果你想限制你的视频公开，那么你需要 Advance API

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T11:20:54.910

查看此插件解决方案：

[http://simonmacdonald.blogspot.ca/2011/11/video-player-plugin-for-phonegap.html](http://simonmacdonald.blogspot.ca/2011/11/video-player-plugin-for-phonegap.html)

# sql - T-SQL 触发器 - 使用单独的表更新表，可以进行多行插入

> ID：13980951
> 
> 赞同：0
> 
> 时间：2012-12-20T21:41:54.220
> 
> 标签：sql, sql-server, tsql, triggers

我是触发器的新手，并且正在设置触发器以`REQ_L`在插入满足特定参数的记录时更新表 ()。要更新的值`REQ_L`是从具有匹配键的单独表中提取的。

```
create table REQ_L (item_number varchar(20), 
                    commodity_code varchar(20), 
                    vendor_id varchar(20), 
                    item_source varchar(20));

create table XREF_C (item_number varchar(20), 
                     commodity_code varchar(20), 
                     xref_type varchar(20)); 
```

我希望在将记录插入时使用`REQ_L`它，如果它符合触发器中的条件，它将使用in作为键更新`COMMODITY_CODE`from 。`REQ_L``COMMODITY_CODE``XREF_C``ITEM_NUMBER`

不再锁定并切换到使用插入的表。好消息是不再出现死锁，坏消息是它仍然没有更新表。更新的 SQL 触发器尝试：

```
CREATE TRIGGER WBM
    ON REQ_L
    AFTER INSERT
    AS
    IF EXISTS (SELECT * FROM inserted WHERE VENDOR_ID = 'W7315'
                AND ITEM_SOURCE = 'XML'
                AND COMMODITY_CODE NOT LIKE '%-%')
    BEGIN
        UPDATE REQ_L
            SET COMMODITY_CODE = (SELECT distinct CODE_2 
                                    FROM XREF_C xc, inserted i 
                                    WHERE i.ITEM_NUMBER = xc.CODE_1 
                                    AND xc.XREF_TYPE = 'WBM')
        FROM XREF_C xc, inserted i
        WHERE i.ITEM_NUMBER = xc.CODE_1
        END
GO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:48:02.643

我同意上面的一般评论，但我认为您使用的逻辑看起来很狡猾。你有：

```
 UPDATE REQ_L
        SET COMMODITY_CODE = (SELECT distinct CODE_2 
                                FROM XREF_C xc, inserted i 
                                WHERE i.ITEM_NUMBER = xc.CODE_1 
                                AND xc.XREF_TYPE = 'WBM')
    FROM XREF_C xc, inserted i
    WHERE i.ITEM_NUMBER = xc.CODE_1 
```

好吧，我可能错了，但我不禁认为您正在更新的表应该出现在语句的 from 子句中。

这个怎么样：

```
UPDATE rl
SET Commodity_Code = x.Code_2
FROM Req_L rl
    INNER JOIN Inserted i ON --limit the join clause to the cols that have been inserted
        rl.item_number = i.item_number and  
        rl.commodity_code = i.commodity_code and
        rl.vendor_id = i.vendor_id and 
        rl.item_source = i.item_source
    INNER JOIN XREF_C x ON L.item_number = x.item_number
WHERE x.xref_type = 'WBM' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:38:11.320

尝试简化您的查询结构。我仍然不知道 CODE_1 和 CODE_2 是什么，但这对我有用。

```
ALTER TRIGGER [dbo].[WBM]
    ON [dbo].[REQ_L]
    AFTER INSERT
    AS
    UPDATE  REQ_L
    SET     commodity_code = xc.commodity_code  FROM    INSERTED i          INNER JOIN          XREF_C xc ON i.Item_Number=xc.item_number
                         AND
                         xc.xref_type = 'WBM'
                         AND
                         i.VENDOR_ID = 'W7315'
                         AND
                         i.ITEM_SOURCE = 'XML'
                         AND
                         i.COMMODITY_CODE NOT LIKE '%-%' 
```

请记住，`IF`语句属于 C# 和 Visual Basic - 如果您在 SQL 中使用它们，您就不会以数据集的心态编写查询。大多数时候是；有时它们是无法避免的。

# php - 使用 Eval 执行 PHP 中的字符串比较

> ID：13980954
> 
> 赞同：1
> 
> 时间：2012-12-20T21:42:05.157
> 
> 标签：php, string, eval

我有一些看起来像这样的代码。

```
eval('$ruleTrue = '."{$value} {$operator} {$value2};"); 
```

我主要从数据库中提取数值并将它们与其他数值进行比较。运算符也来自数据库。可能的运算符是 <,>,==。

那么在比较整数和浮点数时，这非常有效。但是在比较字符串时它会中断。例如..

作品：5 > 4 $ruleTrue = true

不能正常工作：John-Adams == Alice $ruleTrue = true <--- 为什么？因为约翰不是爱丽丝的==。

由于某种原因，我的 $ruleTrue 变量在比较字符串时被返回为 true。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:46:41.793

您正在尝试评估此代码：

```
$ruleTrue = John == Alice; 
```

`John`并且`Alice`不是字符串，它们是未定义的常量。你想在它们周围加上引号。但要小心，因为如果您的用户能够编辑数据库中的这些字段，他们可能会找到一种方法来取消引用字符串并执行他们自己的 php 代码，这可能是灾难性的。Eval 那样是非常不安全的，你可能不应该使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:57:45.053

该表达式的`John-Adams == Alice`解析有点像`(John - Adams) == Alice`. 左边试图减去两个字符串（未定义的常量被认为是'barewords'，并且等于它们的名称的字符串化；`John === 'John'`例如），为了理解这种奇怪的操作，PHP 将两个字符串都转换为数字。作为整数，两个字符串的值都是 0，所以左边等于 0。

一个整数。

现在，当 PHP 想与 比较时`==`，它想强制双方进入相同的类型。在这种情况下，它正在转换为 int。 `Alice` *也*转换为 0。双方均为 0，它们“显然”相等。

为了防止这种情况发生，您可能应该在您的值周围加上引号。您也可以考虑使用严格的等号运算符 ( `===`)，除非您真的想要那种类型的强制魔法。

或者，如果您有一组已知的运算符，您可以`eval`通过创建一个具有运算符子功能的比较函数来消除并使其更安全、更健壮。像这样：

```
function compare($value1, $op, $value2) {
    static $known_ops = array(
        '==' => function($a, $b) { return $a == $b; },
        '!=' => function($a, $b) { return $a != $b; },
        ...

        # you can even make up your own operators.  For example, Perl's 'eq':
        'eq' => function($a, $b) { return "$a" === "$b"; }

        ...
    );
    $func = $known_ops[$op];
    return $func($value1, $value2);
}

...

$ruleTrue = compare($value, $operator, $value2); 
```

现在你不必担心你的价值观。您确实需要担心`$operator`，但这只是在您让用户输入而不验证它的情况下才会出现的问题。在这种情况下，你可能想要抛出一个异常或其他东西，因为如果`$op`你`$known_ops`让 PHP 来处理它，当它尝试调用时你可能会得到一个致命错误`null`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:45:42.033

确保，如果值是字符串，它们被“引号”包围

# node.js - 为什么我的 mongodb 的 nodeunit 测试没有完成？

> ID：13980956
> 
> 赞同：3
> 
> 时间：2012-12-20T21:42:17.810
> 
> 标签：node.js, mongodb, nodeunit

我正在为围绕 mongodb 的操作编写 nodeunit 测试。当我使用 nodeunit (nodeunit testname.js) 执行测试时，测试运行并变为绿色，但 nodeunit 命令行没有返回（我需要按 ctrl-c）。

我究竟做错了什么？我需要关闭我的数据库连接或服务器还是我的测试错误？

这是一个缩减样本测试。

```
process.env.NODE_ENV = 'test';
var testCase = require('/usr/local/share/npm/lib/node_modules/nodeunit').testCase; 
exports.groupOne = testCase({
    tearDown: function groupOneTearDown(cb) {       
    var mongo = require('mongodb'), DBServer = mongo.Server, Db = mongo.Db;
    var dbServer = new DBServer('localhost', 27017, {auto_reconnect: true});
    var db = new Db('myDB', dbServer, {safe:false});

    db.collection('myCollection', function(err, collectionitems) {
            collectionitems.remove({Id:'test'});    //cleanup any test objects
        }); 

    cb();
},
aTest: function(Assert){
    Assert.strictEqual(true,true,'all is well');
    Assert.done();
}
}); 
```

迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:11:35.737

关闭连接后，尝试将您`cb()`的`remove()`回调放在回调中：

```
var db = new Db('myDB', dbServer, {safe:false});

db.collection('myCollection', function(err, collectionitems) {
    collectionitems.remove({Id:'test'}, function(err, num) {
        db.close();
        cb();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-10T07:55:33.873

You need to invoke `cb` function *after* the closure of `db` (during the `tearDown`):

```
tearDown: function(cb) {

    // ...
    // connection code
    // ...

    db.collection('myCollection', function(err, collectionitems) {
        // upon cleanup of all test objects
        db.close(cb);
    });
} 
```

This works for me.

# ruby-on-rails - Rails + Mac OS X：libMagickCore-Q16.7.dylib 不起作用

> ID：13980957
> 
> 赞同：3
> 
> 时间：2012-12-20T21:42:18.693
> 
> 标签：ruby-on-rails, ruby, osx-lion, rake, rmagick

如果我运行某种`rake`命令，我会收到以下错误消息：

```
rake aborted!
dlopen(/Users/adam/.rvm/gems/ruby-1.9.3-p327/gems/rmagick-2.13.1/lib/RMagick2.bundle, 9): Library not loaded: /usr/local/lib/libfreetype.6.dylib
  Referenced from: /usr/local/lib/libMagickCore-Q16.7.dylib
  Reason: Incompatible library version: libMagickCore-Q16.7.dylib requires version 16.0.0 or later, but libfreetype.6.dylib provides version 13.0.0 - /Users/adam/.rvm/gems/ruby-1.9.3-p327/gems/rmagick-2.13.1/lib/RMagick2.bundle
... 
```

我在 RoR 3.2、OSX Lion 上运行。

谁能帮助我，请，如何解决这个问题？我花了 2 天时间在谷歌上搜索，阅读讨论，但不幸的是，成功率为零……

非常感谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-17T13:14:21.050

使用 Homebrew 我可以使用以下命令解决它：

```
brew uninstall freetype
brew update
brew install freetype 
```

更新步骤可能是不必要的。安装成功，但出现以下警告：

```
Warning: Could not link freetype. Unlinking... 
```

所以最后一个命令：

```
brew link --overwrite freetype 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T20:02:11.367

我有一个很棒的 how-to-install-rmagick 对我来说效果很好，尝试按照以下步骤重新安装 ImageMagick：

1.  `yum install tcl-devel libpng-devel libjpeg-devel ghostscript-devel bzip2-devel freetype-devel libtiff-devel -y`（我使用 CentOS，你可以将命令翻译到你的发行版）
2.  下载 ImageMagick。写入`wget ftp://ftp.imagemagick.org/pub/ImageMagick/ImageMagick.tar.gz`并按 Enter。ImageMagick.tar.gz 在当前目录中创建。
3.  解压缩 ImageMagick 存档。写入`tar xczf ImageMagick.tar.gz`并按 Enter。创建了一个新目录 ImageMagick-version，其中 version 是 ImageMagick 版本号。
4.  切换到 ImageMagick 目录。写入 cd ImageMagick-version 并按 Enter。
5.  配置 ImageMagick 构建。写入`./configure --prefix=/usr/local --without-perl`并按 Enter。
6.  编译 ImageMagick。写入`make`并按 Enter。ImageMagick 编译。此步骤可能需要几分钟。
7.  将 ImageMagick 安装到您的主目录。写入`make install`并按 Enter。
8.  删除安装文件。写入`rm -r ImageMagick.tar.gz`并按 Enter。
9.  将 /usr/local/bin 添加到您的 PATH 中。
    *   写入`echo export PATH="/usr/local/bin:$PATH" >> ~/.bash_profile`并按 Enter。
    *   重新加载您的 .bash_profile。写入`source ~/.bash_profile`并按 Enter。
10.  安装 RMagick gem。
    *   写入`export LD_LIBRARY_PATH=/usr/local/lib`并按 Enter。
    *   写入`export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig/`并按 Enter。
    *   在 Ruby on Rails 应用程序中安装 RMagick gem。

以后再告诉我进展如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:55:31.977

您是否使用类似[`Homebrew`](http://mxcl.github.com/homebrew/)或[`MacPorts`](http://www.macports.org/)管理外部库依赖项的东西？

从那里安装`imagemagick`库，然后安装 rmagick。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T19:39:36.630

我在另一篇文章中找到了答案：

[Rails 3 - RMagick 使用 Paperclip 找不到 libfreetype.6.dylib](https://stackoverflow.com/questions/13346697/rails-3-rmagick-doesnt-find-libfreetype-6-dylib-using-paperclip)

我进行了搜索，发现有一个旧版本的 libfreetype 被引用，而新版本隐藏在其他地方。通过将较新的版本复制/链接到适当的目录（在我的情况下是 /usr/local/lib），问题得到了解决。

# ajax - Yii、Fancybox 和 ajax 加载的数据

> ID：13980959
> 
> 赞同：0
> 
> 时间：2012-12-20T21:42:38.613
> 
> 标签：ajax, validation, yii, fancybox

我有一个看起来像的链接

```
<a class="fancy" href="/site/feedback">feedback</a> 
```

阿贾克斯调用：

```
$('.fancy').fancybox({
    wrapCSS: 'custom-fancy',
    padding: 0,
    type: 'ajax'
}); 
```

单击fancybox 加载控制器发送的内容。

```
$this->renderPartial('_feedback') 
```

反馈视图：

```
<?php
/* @var $this Controller */
/* @var $model FeedbackForm */
/* @var $form CActiveForm */

$form = $this->beginWidget('CActiveForm', array(
    'id' => 'feedback-form',
    'enableClientValidation' => TRUE,
)); ?>
<div><?= $form->textArea($model, 'feedback') ?></div>
<?=$form->error($model, 'feedback')?>
<? $this->widget('CCaptcha') ?>
<?=$form->textField($model, 'verifyCode', array('placeholder' => 'Captcha code'))?>
<div><?=CHtml::submitButton('Send', array('class' => 'r button'))?></div>
<? $this->endWidget() ?> 
```

问题是这个加载的表单上没有 javascript/ajax 验证。我认为，这是因为在 ajax 调用后没有加载一些 Yii 脚本（可能是 yiiActiveForm.js，我不知道）。这种情况的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-04T06:52:14.543

我们需要设置**$processOutput**为**true**作为第四个参数。（***RenderPartial 后处理默认值为 false***。）然后只有**$processOutput**方法会将注册的客户端脚本插入到适当位置的输出中。

```
$this->renderPartial('view file', array(data to be available to view file), false, true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T10:17:10.907

好吧，你需要用javascript加载一些代码

```
$output = $this->renderPartial('_feedback', array(), true)
// you need set layout to false for render only your form
Yii::app()->clientScript->render($output);
// where you need remove jquery for prevent double initiation's jquery script
// it's not worked example!!!
preg_replace('@<script type="text/javascript" src="jquery.js"></script>@mi', '', $output);
// well, we may output
echo $output; 
```

# iphone - iPhone - 创建自定义 UITableViewCell 顶部和底部边框

> ID：13980960
> 
> 赞同：7
> 
> 时间：2012-12-20T21:42:43.383
> 
> 标签：iphone, uitableview, cell

我一直在到处寻找，并没有完全找到我的答案。

我用来自 JSON 的动态单元格填充 UITableView，我试图隐藏任何额外的单元格。我关闭了 IB 中的分隔符，当然所有的单元格分隔符都消失了。如何在每个 tableviewcell 的底部和顶部添加一条线，以便只有具有信息的单元格显示边框？我已经导入了 Quartz 并且一直在玩 CALayer 但找不到解决方案。

我在这里发现了一个类似的问题，但唯一的答案不是很有帮助。

有什么更好的、不同的方式来做到这一点？

这是我的 cellForRowAtIndexPath 和我的 numberOfRowsInSection：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.
    //set equal to the information in the array

    return [_jsonDataArray count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    //create Dictionary of data in row
    NSDictionary *jsoninfo = [_jsonDataArray objectAtIndex:indexPath.row];

    //get required keys from dictionary and assign to vairables
    NSString *title = [jsoninfo objectForKey:@"title"];
    NSString *subtitle = [jsoninfo objectForKey:@"subtitle"];
    NSURL *imageURL = [NSURL URLWithString:[jsoninfo objectForKey:@"series_image_URL"]];

    //download the images.
    NSData *imgData = [NSData dataWithContentsOfURL:imageURL];
    UIImage *img = [[UIImage alloc] initWithData:imgData];

    //set boarder for custom cells... I need to have a border on the top and bottom of the cells I am creating so xcode does not autofill the empty space.

    //fill in text to cells
    cell.textLabel.text = title;
    cell.detailTextLabel.text = subtitle;
    cell.imageView.image = img;

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-20T22:15:46.890

我也认为这不是最好的主意，但如果你真的想这样做，这里的代码可以实现你想要的：

```
tableView.separatorStyle = UITableViewCellSeparatorStyleNone;

// Draw top border only on first cell
if (indexPath.row == 0) {
    UIView *topLineView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, 1)];
    topLineView.backgroundColor = [UIColor grayColor];
    [cell.contentView addSubview:topLineView];
}

UIView *bottomLineView = [[UIView alloc] initWithFrame:CGRectMake(0, cell.bounds.size.height, self.view.bounds.size.width, 1)];
bottomLineView.backgroundColor = [UIColor grayColor];
[cell.contentView addSubview:bottomLineView]; 
```

将此代码放入`tableView:cellForRowAtIndexPath:`方法中。您的最终外观`UITableView`将是这样的：

![具有选择性边框的表格视图](../Images/10616695ecccf22a2a315769f371afb0.png)

考虑到这对性能不是很好，特别是如果您有很多单元格。如果您有大量数据，请参阅[此 SO 问题](https://stackoverflow.com/questions/3128752/draw-line-in-uiview)以获取有关如何优化绘图的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-07T15:44:54.077

仅在方法中尝试此`tableView:cellForRowAtIndexPath:`方法

```
[cell.contentView.layer setBorderColor:[UIColor grayColor].CGColor];
[cell.contentView.layer setBorderWidth:1.0f]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:46:22.603

这听起来像是尝试将有效单元格与带有线条的空单元格“区分开来”的次优解决方案。一种更好的方法是在用它填充表之前清理数据源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T02:14:59.283

Use Custom Cells. Your Datasoure (Models) should drive the information into the Custom Cells. Create a setter within the Custom Cell class that can be set at each row. as in....

* * *

1.  Allocation your Custom Cell with reuse Id,

2.  Pass the property that is determing if the line should show:
    **[cell setCustomLines:Model.property];**

3.  return the cell;

* * *

You will have far more flexibility to design the CustomCell any way you want, Images, Lines, Colors, or other ways of letting your user's see a difference among your cells.

Technically, Marco's Answer will work, and good job on a simple solution. But you will not be able to expand this very much farther this this.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-03T15:03:07.650

这不是问题的答案，而是原始问题的干净解决方案。

添加一个空的 UIView 作为 UITableView 的页脚。然后将隐藏空单元格。看到[这个答案](https://stackoverflow.com/a/16664491/651651)。

# php - php安全反序列化

> ID：13980961
> 
> 赞同：4
> 
> 时间：2012-12-20T21:42:43.933
> 
> 标签：php

在php中使用反序列化时，处理变量无法反序列化的潜在情况最安全的方法是什么。

例如（我不会这样做，只是为了举例）：

```
$myVar = true;

$result = unserialize($myVar); 
```

这将返回 false，这很好。但它也引发了令人讨厌的通知。

我一直在做以下事情：

```
$result = @unserialize($myVar); 
```

感觉很hacky。那么当有可能出现错误时，反序列化的最佳方法是什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:49:41.257

您可以使用带有 try / catch 的错误处理程序：

```
set_error_handler('exceptions_error_handler');
function exceptions_error_handler($severity, $message, $filename, $lineno) {
  if (error_reporting() == 0) {
    return;
  }
  if (error_reporting() & $severity) {
    throw new ErrorException($message, 0, $severity, $filename, $lineno);
  }
}
$string = 'bob';
try {
   $result = unserialize($string);
} catch (Exception $e) {
   echo 'Caught exception: ',  $e->getMessage(), "\n";
}
if(isset($result)) {
    //Continue code for valid serialized array here
} 
```

# ios - 如果应用程序在 10 秒内被杀死，NSUserDefaults 会丢失新保存的数据

> ID：13980968
> 
> 赞同：6
> 
> 时间：2012-12-20T21:43:05.457
> 
> 标签：ios, core-data, nsuserdefaults

我正在寻找一种比 NSUserDefaults 更快的方法来保存用户首选项。我发现如果应用程序在写入 NSUserDefaults 后大约 10 秒内被杀死，它不会被永久保存。我使用默认值来保存自定义铃声的路径、自定义图像的路径、地图坐标以及基本上只是用户定义的首选项。使用核心数据是更好的选择吗？SQLite？什么被认为是最快和最轻量级的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-20T21:44:11.857

您需要确保调用同步以立即保存数据。

```
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

来自 Apple 的[类参考](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html#//apple_ref/occ/instm/NSUserDefaults/synchronize)：

> 由于此方法会定期自动调用，因此仅当您无法等待自动同步（例如，如果您的应用程序即将退出）或您想要更新用户默认值时才使用此方法，即使您没有进行任何更改。

要回答您的第二个问题，这实际上取决于您要存储多少数据。NSUserDefaults 旨在存储非常少量的数据（用于偏好），例如拨动开关的状态等。您可以在此处存储图像和铃声的路径，但这并不完全可取。我的意思是你可以，但可能不应该。

如果您计划存储许多这些路径，Core Data 是一种更好的方法，因为它具有很强的可扩展性并且性能非常好。所以总的来说，如果你需要存储大量数据，用户 Core Data，或者作为另一种选择，将路径存储在文档目录中的 plist 中。

# regex - 从正则表达式中提取静态字符串

> ID：13980970
> 
> 赞同：7
> 
> 时间：2012-12-20T21:43:18.207
> 
> 标签：regex

我正在尝试有效地提取静态字符串（**必须**匹配给定正则表达式才能匹配的字符串）。我已经能够在最简单的情况下做到这一点，但我正试图找到一个更强大的解决方案。

* * *

给定一个正则表达式，如下所示

```
"fox jump(ed|ing|s)" 
```

会给我们

```
"fox,jumped,jumping,jumps" 
```

* * *

另一个例子是

```
"fox jump(ed|ing|s)?" 
```

这会给我们

```
"fox,jump" 
```

因为可选运算符

* * *

我现在的算法过于简单。它将从正则表达式的末尾开始并删除组或单个字符，后跟这些运算符“*？” 以及“explode”分组的 OR 运算符“(|)”。这工作得很好，但没有考虑到正则表达式的完整语法。您可以将其视为正则表达式的最小集合生成过程（正则表达式可以“生成/必须匹配”的最小字符串集）。

***为什么？*** 我正在尝试将一堆文本与大量正则表达式进行匹配。如果我可以获得这些“必需”的正则表达式的“关键字”列表，我可以对该关键字进行快速文本搜索以过滤我关心的正则表达式（忽略那些我保证不匹配甚至跳过该文本完全有效地不在文本上运行任何正则表达式，因为我们保证在我们的正则表达式集中没有匹配项）。我可以在一个有效的数据结构（Binary Search/Trie/Aho-Corasick）中组织这组关键字，以在我尝试通过有限自动机运行文本之前过滤这组正则表达式。在尝试运行正则表达式之前，我可以将一些非常快速的字符串匹配算法作为过滤阶段运行。我'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:21:31.253

如果我正确理解了您的问题，那么您正在寻找一组单词，使得所有这些单词都是（给定的）正则表达式接受的任何单词的（不相交的）子字符串。

我的猜测是这样的集合通常是空的，但仍然可以找到它。

为了找到这样一个集合，我提出了以下算法：

1.  找到与您的输入正则表达式对应的 FA。
2.  识别起始状态 S 和接受状态 F 之间的桥梁 ( [https://en.wikipedia.org/wiki/Bridge_(graph_theory](https://en.wikipedia.org/wiki/Bridge_(graph_theory) ) )。例如，这可以通过删除边 E 并询问是否存在来自 S 的路径来完成删除 E 的 FA 中的 E - 对所有边缘重复此操作。
3.  在接受运行期间，所有作为桥梁的边都必须被击中，并且每条边对应于一个输入字母。
4.  您现在可以通过端到端连接后续桥边来生成所需的单词。

我认为从算法构造来看，FA（而不是 DFA）足以使其工作。再一次，证明会很好，但我认为它应该有效:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-15T10:44:55.597

请参阅给定正则表达式的库[Xeger](https://code.google.com/p/xeger/)将为您提供所有可能匹配的字符串。

您似乎只想保留这些字符串的公共前缀（您说要忽略可选运算符的部分），但如果您这样做，您可能会捕获具有该公共前缀但没有您想要的结尾的字符串（例如“跳跃”在你的例子中）。如果这不是问题，那么只需找到 Xeger 给出的最短字符串，假设可选运算符仅出现在正则表达式的末尾。

# jquery - jQuery + 选择的插件：将 url 添加到选定的选项

> ID：13980971
> 
> 赞同：1
> 
> 时间：2012-12-20T21:43:19.177
> 
> 标签：jquery, html, jquery-chosen

如果您只看我的[fiddle](http://jsfiddle.net/nickcoxdotme/3cdPp/2/)，这可能是最容易解释的，为了清楚起见，我已经对其进行了评论。基本上，我使用的是 Harvest[选择](https://github.com/harvesthq/chosen)的插件，我只是想让我放在它旁边的“开始”按钮`data-url`成为所选选项属性的链接。我大量使用控制台来尝试调试，但我无法让它工作。

我只是希望这种情况发生：当您从所选菜单中选择一个选项时，`href`go 按钮将成为该选项的链接。看看小提琴，一切都会变得清晰。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T22:01:32.670

将您的 url 选择器更改为

```
url = $('#cancer-select option:eq(' + selectedIndex + ')').attr('data-url'); 
```

并删除您的选择选项周围的空`<option>`标签似乎可以解决它。

从OP编辑：

您还需要将功能更改为

```
$('#button-go').attr('href', '' + url); 
```

[http://jsfiddle.net/nickcoxdotme/3cdPp/8/](http://jsfiddle.net/nickcoxdotme/3cdPp/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:59:17.433

好吧，您似乎无法添加数据属性并期望选择的人将其带到您的新列表中。所以我建议：[在选择之前创建一个 url 数组，并通过选项名称附加 url。](http://jsfiddle.net/VxUbT/1/)

我添加了这个：

```
var dataURLS = new Array();

var options = $('option');

options.each(function(){
    dataURLS[$(this).text()] = $(this).attr('data-url');
}); 
```

并改变了这一点：

```
url = $('#cancer-select option:eq(selectedIndex)').attr('data-url'); 
```

对此：

```
url = dataURLS[$(this).text()];
$('.chzn-single').attr('href',url); 
```

查看控制台输出，我认为它可以满足您的需求。

编辑：更新的准确性。

# android - 在 Android 画布中绘制 2D 曲线？

> ID：13980974
> 
> 赞同：1
> 
> 时间：2012-12-20T21:43:26.863
> 
> 标签：android, 2d, android-canvas, curve

我们如何绘制这样的二维曲线`Canvas`？

![在此处输入图像描述](../Images/50aadbeea3b7acc8d476102a5f2147b6.png) ![在此处输入图像描述](../Images/e470c4e13a419f7079603048aafb40da.png) ![在此处输入图像描述](../Images/8179a5a9c6b82e7227d8b0e6f6196186.png)

所有相似的曲线都有`mathematical formula`或是`fractals`，但画布只有一些绘制简单形状的方法，如三角形或矩形。我知道大多数曲线可以分成更简单的形状，例如绘制[Heart Curve](http://www.mathematische-basteleien.de/heart.htm)，但是有没有更简单的方法可以用画布绘制 2D 曲线？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:59:15.290

使用 Path 对象，您可以在 Canvas 中制作一些更精美的线条和曲线。只是随机发现了这两个问题；我希望他们可以为您指明正确的方向，因为我个人没有使用过它们。

[绘制连接三点的完美曲线](https://stackoverflow.com/questions/3811529/draw-a-perfect-curve-connecting-three-points)

[贝塞尔曲线和画布](https://stackoverflow.com/questions/9993030/bezier-curve-and-canvas)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T22:27:52.310

如果您查看如何绘制一般的 2D 曲线，您将绘制点或线，并且它看起来很平滑。

您的问题有两种参数形式和一种分形形式。一切都可以用线和点来绘制。参数形式可以直接通过您问题中的算法完成，也可以转换为更通用的形式，如@leenephi 提到的贝塞尔曲线

大多数情况下，生成分形的方程/算法使用线、科赫雪花或点、曼德布罗集。如果您真正了解如何生成它们，您会发现分形不是关于绘制“曲线”，而是更多关于过程（递归）和结果（自相似性）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:53:40.503

您必须通过更简单的图元（例如短线段）来近似曲线。

# java - 使用单检查习语进行延迟初始化

> ID：13980975
> 
> 赞同：1
> 
> 时间：2012-12-20T21:43:32.337
> 
> 标签：java, volatile, lazy-initialization, effective-java

在“Effective Java, Second Edition”的第 71 项中，引入了双重检查习惯用法和单一检查习惯用法，用于延迟实例化实例字段。

**双重检查成语**

```
private volatile FieldType field;
FieldType getField() {
  FieldType result = field;
  if (result == null) {
    synchronized(this) {
      result == field;
      if (result == null)
        field = result = computeFieldValue();
    }
  }
  return result;
} 
```

**单检查成语**

```
private volatile FieldType field;
FieldType getField() {
  FieldType result = field;
  if (result == null) {
    field = result = computeFieldValue();
  }
  return result;
} 
```

在复查习语 Joshua 中，**结果**变量用于确保 volatile**字段**只被读取一次，从而提高了性能。这我理解，但是我不明白为什么我们需要在单检查习语中使用它，因为无论如何我们只读取一次**字段。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:46:54.967

在单检查习语中，如果没有结果变量，您仍然会阅读两次；一次用于空检查，一次用于返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:59:59.457

我更喜欢以下惰性评估的实现：

```
@ThreadSafe
class MyClass {
    private static class MyClassHelper {
       public static final MyClass helper = new MyClass();
    }

    public static MyClass getInstance() {
        return MyClassHelper.helper;
    }
} 
```

# javascript - 用 Javascript 添加类？

> ID：13980982
> 
> 赞同：108
> 
> 时间：2012-12-20T21:43:44.147
> 
> 标签：javascript, html

如何`<html>`使用 Javascript 将类添加到根元素？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-12-20T21:45:09.997

像这样：

```
var root = document.getElementsByTagName( 'html' )[0]; // '0' to assign the first (and only `HTML` tag)

root.setAttribute( 'class', 'myCssClass' ); 
```

或者使用它作为你的'setter'行来保留任何以前应用的类：（感谢@ama2）

```
root.className += ' myCssClass'; 
```

或者，根据所需的浏览器支持，您可以使用以下`classList.add()`方法：

```
root.classList.add('myCssClass'); 
```

[https://developer.mozilla.org/en-US/docs/Web/API/Element/classList](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList) [http://caniuse.com/#feat=classlist](http://caniuse.com/#feat=classlist)

更新：

引用元素的更优雅的解决方案`HTML`可能是：

```
var root = document.documentElement;
root.className += ' myCssClass';
// ... or:
//  root.classList.add('myCssClass');
// 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-20T21:47:38.287

这也应该有效：

```
document.documentElement.className = 'myClass'; 
```

[兼容性](https://web.archive.org/web/20170413002413/http://reference.sitepoint.com/javascript/Document/documentElement#compatibilitysection)。

**编辑：**

IE 10 认为它是只读的；然而：

![有效！？](../Images/706a903d8c71e8c580c7f68d2f6ba72e.png)

歌剧作品：

![作品](../Images/f9486e9557116a62dacb9132928b6654.png)

我还可以确认它适用于：

*   铬 26
*   火狐 19.02
*   Safari 5.1.7

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-10-27T17:18:01.273

```
document.documentElement.classList.add('myCssClass'); 
```

`classList`从 ie10 开始支持：[https ://caniuse.com/#search=classlist](https://caniuse.com/#search=classlist)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-20T21:45:09.093

我建议您看一下**[jQuery](http://jquery.com/)**。

jQuery方式：

```
$("html").addClass("myClass"); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-12-20T21:46:52.347

您应该附加类而不是覆盖它

```
var headCSS = document.getElementsByTagName("html")[0].getAttribute("class") || "";
document.getElementsByTagName("html")[0].setAttribute("class",headCSS +"foo"); 
```

我仍然建议使用 jQuery 来避免浏览器不兼容

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-18T22:06:49.727

```
document.getElementsByTagName("html")[0].classList.add('theme-dark');
document.getElementsByTagName("html")[0].classList.remove('theme-dark')
document.getElementsByTagName("html")[0].classList.toggle('theme-dark') 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2017-03-27T22:43:10.090

**使用 Jquery** ...您可以将类添加到 html 元素，如下所示：

`$(".divclass").find("p,h1,h2,h3,figure,span,a").addClass('nameclassorid');`

**nameclassorid**没有点或#开头

# iphone - 选择模拟器后，如何在 XCode 中自动启用#define？

> ID：13980983
> 
> 赞同：2
> 
> 时间：2012-12-20T21:43:50.057
> 
> 标签：iphone, ios, ipad

当我在模拟器上测试我的 iPhone 应用程序时，我有一些文件想要以不同的方式编译，所以我`#define simulator`在这些文件中使用了宏。我试图弄清楚如何注释掉这个#define 语句并告诉XCode 在选择模拟器时定义这个宏。我怎样才能做到这一点？

我在这里阅读了其他几个类似的问题，并尝试在“任何 iOS 模拟器 SDK”架构的“其他 C 标志”构建设置中添加条件赋值，并将值设置为“-simulator=1”，但这并没有似乎什么都做。

提前感谢您的智慧！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T21:49:34.027

`#if TARGET_IPHONE_SIMULATOR`应该做的伎俩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T21:51:18.220

您不需要自己`#define`的：[Apple 为您提供了一个](https://developer.apple.com/library/ios/documentation/Xcode/Conceptual/ios_development_workflow/15-Configuring_Applications/configuring_applications.html#//apple_ref/doc/uid/TP40007959-CH19-SW4)。只需使用

```
#if TARGET_IPHONE_SIMULATOR 
```

围绕您想要特定于模拟器的代码。（您需要为此包含`TargetConditionals.h`标题，但如果您导入框架，它可能已经包含在内。）

# apache - 将带有查询字符串的 URL 重定向到具有相同查询字符串的新 URL

> ID：13980992
> 
> 赞同：1
> 
> 时间：2012-12-20T21:44:20.800
> 
> 标签：apache, .htaccess

我目前在我的`.htaccess`文件中有以下内容，可将所有请求重定向到网站的 SSL 版本：

```
RewriteEngine On
RewriteCond %{HTTP:X-Forwarded-SSL} !on
RewriteRule ^(.*) https://www.mydomain.com$1 [R=301,nc] 
```

现在，我想将调用重定向到我当前的根 URL（**仅当它附加了查询字符串时**）到具有相同查询字符串的新 URL。例子：

`https://www.mydomain.com/?foo=bar`重定向到：

`https://www.mydomain.com/new_mapping/?foo=bar`

而没有查询字符串的请求继续转到`https://www.mydomain.com/`

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:53:27.263

使用 a`RewriteCond`匹配非空查询字符串`.+`并用`[QSA]`

```
RewriteEngine On
# If the querystring has at least 1 character
RewriteCond %{QUERY_STRING} ^.+
# Rewrite requests to the root 
RewriteRule ^/?$ new_mapping [L,QSA] 
```

如果您想实际重定向浏览器以显示新 URL，请使用`[R=301]`. 这`[QSA]`在技术上是不必要的，因为查询字符串将自动附加以进行重定向。

```
RewriteRule ^/?$ new_mapping [L,R=301,QSA] 
```

# python - Python：创建一个将高分写入文件的字典

> ID：13980994
> 
> 赞同：0
> 
> 时间：2012-12-20T21:44:24.960
> 
> 标签：python, list, dictionary, pickle

第一：你不必为我编写代码，除非你是一个超级棒的好人。但是由于你们都非常擅长编程并且比我和所有人都更好地理解它，所以它可能比逐段编写试图让我理解它更容易（因为它可能不是太多的代码行）。

所以 - 我需要列出一个在新条目时更新的高分列表。 *所以这里是：*

**第一步**——完成

我有玩家输入的输入，它已被用作一些计算的数据：

```
import time
import datetime

print "Current time:", time1.strftime("%d.%m.%Y, %H:%M")
time1 = datetime.datetime.now()
a = raw_input("Enter weight: ")    
b = raw_input("Enter height: ")
c = a/b 
```

**第二步**——制作高分榜

在这里，我需要某种字典或可以读取先前条目并检查分数（`c`）是否（至少）优于“高分”中最后一个分数的东西，如果是，它会提示您输入您的姓名。

输入您的姓名后，它会将您的姓名、您的`a`、`b`、`c`和时间发布在高分列表中。

这是我想出的，它绝对行不通：

```
list = [("CPU", 200, 100, 2, time1)]
player = "CPU"
a = 200
b = 100
c = 2
time1 = "20.12.2012, 21:38"
list.append((player, a, b, c, time1))
list.sort()

import pickle
scores = open("scores", "w")
pickle.dump(list[-5:], scores)
scores.close()

scores = open("scores", "r")
oldscores = pickle.load(scores)
scores.close()
print oldscores() 
```

我**知道**我做了一些非常愚蠢的事情，但无论如何，感谢您阅读本文，我希望您能帮助我解决这个问题。:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T22:58:59.003

首先，不要`list`用作变量名。它遮蔽了[内置`list`](http://docs.python.org/2/library/functions.html#list)对象。其次，避免只使用简单的日期字符串，因为使用对象要容易得多[`datetime`](http://docs.python.org/2/library/datetime.html)，它支持正确的比较和简单的转换。

这是您的代码的完整示例，其中包含帮助划分步骤的各个函数。我试图不使用任何更高级的模块或功能，因为您显然只是在学习：

```
import os
import datetime
import cPickle

# just a constants we can use to define our score file location
SCORES_FILE = "scores.pickle"

def get_user_data():
    time1 = datetime.datetime.now()
    print "Current time:", time1.strftime("%d.%m.%Y, %H:%M")

    a = None
    while True:
        a = raw_input("Enter weight: ")    
        try:
            a = float(a)
        except:
            continue
        else:
            break

    b = None
    while True:
        b = raw_input("Enter height: ")    
        try:
            b = float(b)
        except:
            continue
        else:
            break

    c = a/b

    return ['', a, b, c, time1]

def read_high_scores():
    # initialize an empty score file if it does
    # not exist already, and return an empty list
    if not os.path.isfile(SCORES_FILE):
        write_high_scores([])
        return []

    with open(SCORES_FILE, 'r') as f:
        scores = cPickle.load(f)
    return scores

def write_high_scores(scores):
    with open(SCORES_FILE, 'w') as f:
        cPickle.dump(scores, f)

def update_scores(newScore, highScores):
    # reuse an anonymous function for looking
    # up the `c` (4th item) score from the object
    key = lambda item: item[3]

    # make a local copy of the scores
    highScores = highScores[:]

    lowest = None
    if highScores:
        lowest = min(highScores, key=key)

    # only add the new score if the high scores
    # are empty, or it beats the lowest one
    if lowest is None or (newScore[3] > lowest[3]):
        newScore[0] = raw_input("Enter name: ")
        highScores.append(newScore)

    # take only the highest 5 scores and return them
    highScores.sort(key=key, reverse=True)
    return highScores[:5]

def print_high_scores(scores):
    # loop over scores using enumerate to also
    # get an int counter for printing
    for i, score in enumerate(scores):
        name, a, b, c, time1 = score
        # #1    50.0    jdi    (20.12.2012, 15:02)
        print "#%d\t%s\t%s\t(%s)" % \
            (i+1, c, name, time1.strftime("%d.%m.%Y, %H:%M"))

def main():
    score = get_user_data()
    highScores = read_high_scores()

    highScores = update_scores(score, highScores)

    write_high_scores(highScores)
    print_high_scores(highScores)

if __name__ == "__main__":
    main() 
```

它现在所做的只是在没有高分或超过最低分的情况下添加新分数。如果之前的分数少于 5 个，您可以修改它以始终添加一个新分数，而不是要求它击败最低的分数。然后在 highscores >= 5 的大小之后执行最低检查

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:48:53.497

我注意到的第一件事是您没有告诉`list.sort()`排序应该基于每个条目的最后一个元素。默认情况下，`list.sort()`将使用 Python 的默认排序顺序，它将根据每个条目的第一个元素（即名称）对条目进行排序，然后对第二个元素、第三个元素等进行排序。因此，您必须告诉`list.sort()`使用哪个项目进行排序：

```
from operator import itemgetter
[...]
list.sort(key=itemgetter(3)) 
```

这将根据每个元组中索引为 3 的项（即第四项）对条目进行排序。

此外，`print oldscores()`肯定不会工作，因为`oldscores`它不是一个函数，因此你不能用`()`操作员调用它。`print oldscores`可能更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T22:26:20.190

你绝对不想要这里的字典。字典的重点是能够将键映射到值，而无需任何排序。你想要的是一个排序列表。你已经明白了。

好吧，正如 Tamás 指出的那样，您实际上得到了一个按球员姓名排序的列表，而不是分数。最重要的是，您希望按向下顺序排序，而不是向上排序。你可以使用 decorate-sort-undecorate 模式，或者一个键函数，或者其他什么，但是你需要做*一些事情*。此外，您已将其放在名为 的变量中`list`，这是一个非常糟糕的主意，因为这已经是`list`类型的名称。

无论如何，您可以使用标准库中的模块来确定是否将某些内容添加到 sorted`list`中，以及在哪里插入。[`bisect`](http://docs.python.org/2/library/bisect.html)但是使用类似的东西可能更简单[`SortedCollection`](http://code.activestate.com/recipes/577197-sortedcollection/)or [`blist`](http://pypi.python.org/pypi/blist/)。

这是一个例子：

```
highscores = SortedCollection(scores, key=lambda x: -x[3]) 
```

现在，当你完成游戏时：

```
highscores.insert_right((player, a, b, newscore, time1))
del highscores[-1] 
```

而已。如果您实际上不在前 10 名，您将被添加到第 11 名，然后被删除。如果您在前 10 名中，您将被添加，而旧的 #10 现在将成为 #11 并被删除。

如果您不想像以前的街机游戏那样用 10 个假分数预先填充列表，只需将其更改为：

```
highscores.insert_right((player, a, b, newscore, time1))
del highscores[10:] 
```

现在，如果已经有 10 个分数，当你被添加时，#11 将被删除，但如果只有 3 个，则什么都不会被删除，现在有 4 个。

同时，我不确定您为什么要将新分数写入`pickle`文件，然后再读回相同的内容。您可能希望在将高分添加到列表之前进行读取，然后在之后进行写入添加它。

您还问如何“美化列表”。嗯，这有三个方面。

首先，在代码中，`(player, a, b, c, time1)`意义不大。当然，为变量提供更好的名称会有所帮助，但最终您仍然会归结为这样一个事实，即在访问列表时，您必须`entry[3]`获得分数或`entry[4]`时间。

至少有三种方法可以解决这个问题：

*   存储 s 的一个`list`（或`SortedCollection`）`dict`而不是`tuple`s。代码变得更加冗长，但更具可读性。你写`{'player': player, 'height': a, 'weight': b, 'score': c, 'time': time1}`，然后在访问列表时，你做`entry['score']`而不是`entry[3]`.
*   使用[`namedtuple`](http://docs.python.org/2/library/collections.html#collections.namedtuple)s 的集合。现在你实际上可以只插入`ScoreEntry(player, a, b, c, time1)`，或者你可以插入`ScoreEntry(player=player, height=a, weight=b, score=c, time=time1)`，以在给定的情况下更具可读性，并且它们的工作方式相同。您可以访问`entry.score`or as `entry[3]`，再次使用更具可读性的那个。
*   为分数条目编写一个明确的类。这与上一个非常相似，但是要编写更多代码，并且您不能再进行索引访问，但从好的方面来说，您不必了解`namedtuple`.

其次，如果你只是`print`条目，它们看起来像一团糟。处理这个问题的方法是字符串格式化。而不是`print scores`，你做这样的事情：

print '\n'.join("{}: height {}, weight {}, score {} at {}".format(entry) for entry in highscores)

如果您使用 a `class`or`namedtuple`而不仅仅是 a `tuple`，您甚至可以按名称而不是按位置进行格式化，从而使代码更具可读性。

最后，高分文件本身就是一团乱七八糟的东西，因为`pickle`它不适合人类消费。如果您希望它是人类可读的，您必须选择一种格式，并编写代码来序列化该格式。幸运的是，CSV 格式非常易于阅读，并且大部分代码已经在[`csv`](http://docs.python.org/2/library/csv.html)模块中为您编写好了。（您可能想查看`DictReader`和`DictWriter`类，特别是如果您想编写标题行。同样，为了提高可读性，需要权衡更多代码。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T22:26:56.840

这是我注意到的事情。

这些行似乎顺序错误：

```
print "Current time:", time1.strftime("%d.%m.%Y, %H:%M")
time1 = datetime.datetime.now() 
```

当用户输入身高和体重时，它们将被读取为字符串，而不是整数，因此您将在此行收到 TypeError：

```
c = a/b 
```

您可以通过将 a 和 b 转换为像这样浮动来解决此问题：

```
a = float(raw_input("Enter weight: ")) 
```

但是您可能需要将其包装在 try/catch 块中，以防用户放入垃圾，基本上是任何不能转换为浮点数的东西。把整个事情放在一段时间里，直到他们做对了。

所以，像这样：

```
b = None
while b == None:
    try:
        b = float(raw_input("Enter height: "))
    except:
        print "Weight should be entered using only digits, like '187'" 
```

因此，在第二部分中，您不应该将`list`其用作变量名，因为它是内置的，我将使用`high_scores`.

```
# Add one default entry to the list
high_scores = [("CPU", 200, 100, 2, "20.12.2012, 4:20")] 
```

你说你想对照高分检查球员得分，看看它是否最好，但如果是这样，为什么要列出一个列表？为什么不只是一个条目？无论如何，这让我很困惑，不确定你是否真的想要一个高分列表，或者只是一个高分。

所以，无论如何，让我们添加分数：

假设您已将他们的名字放入`name`变量中。

```
high_score.append((name, a, b, c, time1)) 
```

然后应用@Tamás 的另一个答案