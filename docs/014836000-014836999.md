# StackOverflow 问答 14836000-14836999

# ruby-on-rails - Rails Responder 重定向到创建中的索引会导致奇怪的行为

> ID：14836001
> 
> 赞同：4
> 
> 时间：2013-02-12T15:32:19.837
> 
> 标签：ruby-on-rails

在我的控制器中，我有这个：

```
class TestController < ApplicationController
  respond_to :html, :json

  # code...

  def create
    @test = current_user.tests.create(params[:test])
    respond_with @test, location: tests_url
  end

  # code...

end 
```

这很酷，当我创建 时`test`，它会重定向到`test#index`（如预期的那样），*但是*，如果我按下`F5`，浏览器会要求我重新提交表单。

如果我从中删除该`location`语句`respond_with`就可以了，但不会转到我想要的 URL。

我该如何解决这个问题？

提前致谢。

* * *

## 编辑

我将方法更改为

```
@test = current_user.tests.new(params[:transaction])
respond_with(@test) do |format|
  format.html { redirect_to "/tests/" } if @test.save
end 
```

它有效.. 但是，我不得不使用 String 而不是`tests_url`.

* * *

## 编辑 2

请参阅此[完整示例代码](https://github.com/caarlos0/respond-with)和 [错误报告](https://github.com/rails/rails/issues/9271)。

* * *

## 编辑 3

我无法用 Ruby 1.9.3-p327 重现它，只能在 -p385 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:29:23.120

您可以只使用该`redirect_to`方法，如下所示：

```
def create
  @test = current_user.tests.create(params[:test])
  respond_with @test do |format|
    format.html { redirect_to tests_path }
  end
end 
```

然后，如果客户端要求 json 响应，`to_json`将触发默认行为，但如果所需的响应格式是 html，则将发送重定向。

# android - 锁定到一个方向时获取手机方向

> ID：14836003
> 
> 赞同：10
> 
> 时间：2013-02-12T15:32:26.110
> 
> 标签：android, android-camera

这很容易与另一个问题重复，我只是在努力找出要搜索的内容。

我的相机应用程序被锁定在横向模式（在清单中），如下所示：

```
android:screenOrientation="landscape" 
```

但是，当设备旋转为纵向时，我仍然希望旋转一些 UI 元素（尽管 android 仍然会认为它是横向的，但这是故意的）。

所以我试过这个来检查方向

```
int rotation = this.getWindowManager().getDefaultDisplay()
            .getRotation();
    int degrees = 0;
    switch (rotation) {
        case Surface.ROTATION_0:
            Log.d("Rotation", "0");
            break;
        case Surface.ROTATION_90:
            Log.d("Rotation", "90");
            break;
        case Surface.ROTATION_180:
            Log.d("Rotation", "180");
            break;
        case Surface.ROTATION_270:
            Log.d("Rotation", "270");
            break;
    } 
```

不幸的是，无论我如何转动手机，它总是返回 90。无论Android“认为”方向是什么，是否有更强大的方法来获取方向？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T14:19:19.910

所以在我考虑之后，我意识到我可以实现一个与 Android 本身用来确定方向的算法类似的算法。我使用 onSenseorChanged 回调来做到这一点

```
public static final int UPSIDE_DOWN = 3;
public static final int LANDSCAPE_RIGHT = 4;
public static final int PORTRAIT = 1;
public static final int LANDSCAPE_LEFT = 2;
public int mOrientationDeg; //last rotation in degrees
public int mOrientationRounded; //last orientation int from above 
private static final int _DATA_X = 0;
private static final int _DATA_Y = 1;
private static final int _DATA_Z = 2;
private int ORIENTATION_UNKNOWN = -1;
@Override
public void onSensorChanged(SensorEvent event) 
{
    Log.d(TAG, "Sensor Changed");
    float[] values = event.values;
    int orientation = ORIENTATION_UNKNOWN;
    float X = -values[_DATA_X];
    float Y = -values[_DATA_Y];
    float Z = -values[_DATA_Z];        
    float magnitude = X*X + Y*Y;
    // Don't trust the angle if the magnitude is small compared to the y value
    if (magnitude * 4 >= Z*Z) {
        float OneEightyOverPi = 57.29577957855f;
        float angle = (float)Math.atan2(-Y, X) * OneEightyOverPi;
        orientation = 90 - (int)Math.round(angle);
        // normalize to 0 - 359 range
        while (orientation >= 360) {
            orientation -= 360;
        } 
        while (orientation < 0) {
            orientation += 360;
        }
    }
    //^^ thanks to google for that code
    //now we must figure out which orientation based on the degrees
    Log.d("Oreination", ""+orientation);
    if (orientation != mOrientationDeg) 
    {
        mOrientationDeg = orientation;
        //figure out actual orientation
        if(orientation == -1){//basically flat

        }
        else if(orientation <= 45 || orientation > 315){//round to 0
            tempOrientRounded = 1;//portrait
        }
        else if(orientation > 45 && orientation <= 135){//round to 90
            tempOrientRounded = 2; //lsleft
        }
        else if(orientation > 135 && orientation <= 225){//round to 180
            tempOrientRounded = 3; //upside down
        }
        else if(orientation > 225 && orientation <= 315){//round to 270
            tempOrientRounded = 4;//lsright
        }

    }

    if(mOrientationRounded != tempOrientRounded){
            //Orientation changed, handle the change here
        mOrientationRounded = tempOrientRounded;

    }
} 
```

它看起来比实际复杂，但只要知道它可以工作（我会说和系统一样好）。不要忘记在 onResume 和 onPause 中为加速度计注册传感器更改事件监听器

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T15:40:34.133

对于检测方向，我将其用于向传感器管理器注册：

```
mSensorOrientation = mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION);      
mSensorManager.registerListener(this, mSensorOrientation, SensorManager.SENSOR_DELAY_NORMAL); 
```

然后这用于检测方向变化，您可以在评论中放置自己的方法实现。

常数：

```
public static final int LYING = 0;
public static final int LANDSCAPE_RIGHT = 1;
public static final int PORTRAIT = 2;
public static final int LANDSCAPE_LEFT = 3;

public void onSensorChanged(SensorEvent event) {

Sensor sensorEvent = event.sensor;

if ((sensorEvent.getType() == Sensor.TYPE_ORIENTATION)) {

    float [] eventValues = event.values;

    // current orientation of the phone
    float xAxis = eventValues[1];
    float yAxis = eventValues[2];

    if ((yAxis <= 25) && (yAxis >= -25) && (xAxis >= -160)) {

        if (previousOrientation != PORTRAIT){
            previousOrientation = PORTRAIT;

            // CHANGED TO PORTRAIT
        }

    } else if ((yAxis < -25) && (xAxis >= -20)) {

        if (previousOrientation != LANDSCAPE_RIGHT){
            previousOrientation = LANDSCAPE_RIGHT;

            // CHANGED TO LANDSCAPE RIGHT
        }

    } else if ((yAxis > 25) && (xAxis >= -20)){

        if (previousOrientation != LANDSCAPE_LEFT){
            previousOrientation = LANDSCAPE_LEFT;

            // CHANGED TO LANDSCAPE LEFT
        }
    }
} 
```

}

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-03T09:37:39.730

在做了一些研究并尝试了一些东西之后，当我将传感器设置为：

```
mSensorOrientation = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER); 
```

Sensor.TYPE_ORIENTATION 已被弃用，并且根据来自不同人的一些示例代码检索方向给了我不好的结果。我真的不知道它是否可以，但它对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-16T11:15:35.173

这是 @Jameo 答案的略微修改的 Kotlin 版本。我需要度数来计算锁定方向的活动中的相机旋转。也请给他点赞。

```
private var rotationDeg: Int = 0
private var rotationRoundedClockwise: Int = 0

override fun onSensorChanged(event: SensorEvent) {
    Timber.d("Sensor Changed")
    val newRotationDeg = calculateNewRotationDegree(event)
    //^^ thanks to google for that code
    // now we must figure out which orientation based on the degrees
    Timber.d("rotation: $newRotationDeg")
    if (newRotationDeg != rotationDeg) {
        rotationDeg = newRotationDeg
        rotationRoundedClockwise = calculateRoundedRotation(newRotationDeg)
    }
    Timber.d("rotationRoundedClockwise: $rotationRoundedClockwise")
}

private val X_AXIS_INDEX = 0
private val Y_AXIS_INDEX = 1
private val Z_AXIS_AXIS = 2
private val ORIENTATION_UNKNOWN = -1

private fun calculateRoundedRotation(newRotationDeg: Int): Int {
    return if (newRotationDeg <= 45 || newRotationDeg > 315) { // round to 0
        0  // portrait
    } else if (newRotationDeg in 46..135) { // round to 90
        90  // clockwise landscape
    } else if (newRotationDeg in 136..225) { // round to 180
        180  // upside down portrait
    } else if (newRotationDeg in 226..315) { // round to 270
        270  // anticlockwise landscape
    } else {
        0
    }
}

private fun calculateNewRotationDegree(event: SensorEvent): Int {
    val values = event.values
    var newRotationDeg = ORIENTATION_UNKNOWN
    val X = -values[X_AXIS_INDEX]
    val Y = -values[Y_AXIS_INDEX]
    val Z = -values[Z_AXIS_AXIS]
    val magnitude = X * X + Y * Y
    // Don't trust the angle if the magnitude is small compared to the y value
    if (magnitude * 4 >= Z * Z) {
        val ONE_EIGHTY_OVER_PI = 57.29577957855f
        val angle = Math.atan2((-Y).toDouble(), X.toDouble()).toFloat() * ONE_EIGHTY_OVER_PI
        newRotationDeg = 90 - Math.round(angle)
        // normalize to 0 - 359 range
        while (newRotationDeg >= 360) {
            newRotationDeg -= 360
        }
        while (newRotationDeg < 0) {
            newRotationDeg += 360
        }
    }
    return newRotationDeg
}

private fun getCameraRotation(): Int {
    return when (rotationRoundedClockwise) {
        0 -> 90
        90 -> 180
        180 -> 270
        270 -> 0
        else -> 90
    }
} 
```

这是监听事件的方法。

```
override fun onCreate() {
    super.onCreate()
    (activity?.getSystemService(SENSOR_SERVICE) as? SensorManager)?.let {
            sensorManager = it
        }
}

override fun onResume() {
    super.onResume()

    sensorManager.registerListener(this,
            sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
            SensorManager.SENSOR_DELAY_NORMAL)
}

override fun onPause() {
    super.onPause()

    sensorManager.unregisterListener(this)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-13T17:30:28.893

@panavtec 对 API 23 的回答的翻译，[以此](https://github.com/eziosoft/MultiWii_EZ_GUI/blob/master/src/com/ezio/multiwii/helpers/Sensors.java)作为参考

```
class MyActivity extends Activity implements SensorEventListener {

    private SensorManager sensorManager;
    private float[] lastMagFields = new float[3];;
    private float[] lastAccels = new float[3];;
    private float[] rotationMatrix = new float[16];
    private float[] orientation = new float[4];

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        sensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
    }

    protected void onResume() {
        super.onResume();
        sensorManager.registerListener(this, sensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD), SensorManager.SENSOR_DELAY_GAME);
        sensorManager.registerListener(this, sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_NORMAL);
    }

    protected void onPause() {
        super.onPause();
        sensorManager.unregisterListener(this);
    }

    public void onAccuracyChanged(Sensor sensor, int accuracy) {
    }

    public void onSensorChanged(SensorEvent event) {
        switch (event.sensor.getType()) {
            case Sensor.TYPE_ACCELEROMETER:
                System.arraycopy(event.values, 0, lastAccels, 0, 3);
                break;
            case Sensor.TYPE_MAGNETIC_FIELD:
                System.arraycopy(event.values, 0, lastMagFields, 0, 3);
                break;
            default:
                return;
        }

        if (SensorManager.getRotationMatrix(rotationMatrix, null, lastAccels, lastMagFields)) {
            SensorManager.getOrientation(rotationMatrix, orientation);

            float xAxis = (float) Math.toDegrees(orientation[1]);
            float yAxis = (float) Math.toDegrees(orientation[2]);

            int orientation = Configuration.ORIENTATION_UNDEFINED;
            if ((yAxis <= 25) && (yAxis >= -25) && (xAxis >= -160)) {
                Log.d(TAG, "Portrait");
                orientation = Configuration.ORIENTATION_PORTRAIT;
            } else if ((yAxis < -25) && (xAxis >= -20)) {
                Log.d(TAG, "Landscape Right");
                orientation = Configuration.ORIENTATION_LANDSCAPE;
            } else if ((yAxis > 25) && (xAxis >= -20)){
                orientation = Configuration.ORIENTATION_LANDSCAPE;
                Log.d(TAG, "Landscape Left");
            }
        }
    }
} 
```

# java - Java Date() 给出错误的日期

> ID：14836004
> 
> 赞同：4
> 
> 时间：2013-02-12T15:32:27.433
> 
> 标签：java, date

我有一个简单的方法应该获取当前日期，将其转换为某种格式，然后将其作为字符串返回。到目前为止，一切都很好（最后一次尝试是在 1 月 31 日左右），但由于某种原因，当我今天尝试它时，它返回字符串“2013-02-43”。

现在显然二月份没有 43 天，我不知道为什么它会返回这个。我到处寻找解决方案，但似乎没有一个适合我遇到的具体问题。这是代码：

```
public String getDate(){
    DateFormat dateFormat = new SimpleDateFormat("YYYY-MM-DD");
    Date date = new Date();

    return dateFormat.format(date);
} 
```

只是为了记录，我尝试使用 Calendar.getInstance() 等，结果相同。有趣的是，当我尝试

```
get(Calendar.DAY_OF_MONTH) 
```

它返回 12，所以某个地方的数字是正确的，但在两者之间出现了问题。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-12T15:35:04.903

`DD`表示一年中的某一天，而`dd`表示月份中的某一天。此外，`Y`表示周年，而`y`表示年。你想要`yyyy-MM-dd`（区分大小写）。

```
public String getDate(){
    DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
    Date date = new Date();

    return dateFormat.format(date);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T15:35:49.093

a中的大写D`DateFormat`是年份中的日期。您想要月份的日期：

```
DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T15:35:21.923

试试这个：“yyyy-MM-dd”

区分大小写很重要。“DD”是一年中的一天。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-24T20:05:28.730

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T15:35:22.627

您可能希望使用带有小写 d 的格式“yyyy-MM-dd”。大写 D 是年中日的格式。[您可以在此处](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)找到日期模式的概述。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-12T15:36:35.897

阅读[SimpleDateFormat 的 javadoc](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)。`Y`不存在，`D`是一年中的一天。你想`yyyy-MM-dd`作为你的模式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-12T15:35:37.570

您的格式字符串应该是`"YYYY-MM-dd"`而不是`"YYYY-MM-DD"`.

`DD`是“年中的日”，`dd`而是“月中的日”。

查看[参考](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-12T15:37:22.427

看起来日期格式应该是小写的

`DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");`

返回 2013-02-12

否则返回一年中的某一天。

请参阅[SimpleDateFormat API](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)页面以获取接受的格式模式的完整列表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-12T15:43:46.483

使用以下代码：

```
SimpleDateFormat df = new SimpleDateFormat("YYYY-MM-dd");
Date date = new Date();
System.out.println(df.format(date)); 
```

它应该是`dd`而不是`DD`。

# wix - 每个文件的组件标签

> ID：14836013
> 
> 赞同：0
> 
> 时间：2013-02-12T15:33:14.600
> 
> 标签：wix, wix3.5

根据 WiX 文档，每个文件都应该用组件标签包装。它的意义是什么？如果我在一个组件下放置多个文件怎么办？我没有找到关于主题的明确答案。对产品升级有何影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T14:09:14.427

基本上它会破坏安装程序中的“修复”选项。想象一下这个场景，你有一个包含 3 个文件的组件：

```
<Component Id="FilesToInstall">
    <File Id="FileA" Source="[PathToFileA]" KeyPath="yes" />
    <File Id="FileB" Source="[PathToFileB]" />
    <File Id="FileC" Source="[PathToFileB]" />
</Component> 
```

请注意，您必须将其中一个文件设置为 KeyPath，并且每个组件只能设置一个。

现在，如果由于某种原因 FileA 在安装后被删除或损坏，您可以进行修复，Windows 安装程序将检查该文件，发现它已被删除或损坏并标记该组件以重新安装。然后，这将用安装程序中的正确版本替换 FileA、FileB 和 FileC。

但是，如果 FileB 或 FileC 丢失或损坏，但 FileA 仍然正常，则 Windows 安装程序将不会替换任何内容，因为它会将组件视为有效。

# java - 解压缩的视频文件在 Java 中不起作用

> ID：14836015
> 
> 赞同：1
> 
> 时间：2013-02-12T15:33:17.387
> 
> 标签：java, compression

基本上我使用 Java 中的自定义压缩器类压缩视频。我在这里组装了完整的代码片段。我的实际问题是，从解压缩的字节数组生成的视频 [A.mp4] 没有运行。我实际上是通过互联网获得了这个压缩机类代码。作为 Java 平台的新手，我正在努力解决这个问题。你能请任何人帮助我吗？

```
public class CompressionTest
{
    public static void main(String[] args)
    {
        Compressor compressor = new Compressor();

        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        FileInputStream fis=null;
        File file=null;

        try
        {
            URL uri=CompressionTest.class.getResource("/Files/Video.mp4");
            file=new File(uri.getPath());
            fis = new FileInputStream(file);
        } 
        catch ( FileNotFoundException fnfe )
        {
            System.out.println( "Unable to open input file");
        }

        try 
        {

            byte[] videoBytes = getBytesFromFile(file);

            System.out.println("CompressionVideoToCompress is: '" +videoBytes + "'");

            byte[] bytesCompressed = compressor.compress(videoBytes);

            System.out.println("bytesCompressed is: '" +bytesCompressed+ "'");

            byte[] bytesDecompressed=compressor.decompress(bytesCompressed);

            System.out.println("bytesDecompressed is: '" +bytesDecompressed+ "'");

            FileOutputStream out = new FileOutputStream("A.mp4");
            out.write(bytesDecompressed,0,bytesDecompressed.length-1);
            out.close();

        } 
        catch (IOException e) 
        {
            // TODO Auto-generated catch block
            System.out.println("bytesCompressed is: '");
        }

    }

    public static byte[] getBytesFromFile(File file) throws IOException 
    {
        InputStream is = new FileInputStream(file);

        // Get the size of the file
        long length = file.length();

        // You cannot create an array using a long type.
        // It needs to be an int type.
        // Before converting to an int type, check
        // to ensure that file is not larger than Integer.MAX_VALUE.
        if (length > Integer.MAX_VALUE) {
            // File is too large
        }

        // Create the byte array to hold the data
        byte[] bytes = new byte[1064];

        // Read in the bytes
        int offset = 0;
        int numRead = 0;
        while (offset < bytes.length
               && (numRead=is.read(bytes, offset, bytes.length-offset)) >= 0)
        {
            offset += numRead;
        }

        // Ensure all the bytes have been read in
        if (offset < bytes.length) {
            throw new IOException("Could not completely read file "+file.getName());
        }

        // Close the input stream and return bytes
        is.close();
        return bytes;
    }
}

class Compressor
{
    public Compressor()
    {}

    public byte[] compress(byte[] bytesToCompress)
    {        
        Deflater deflater = new Deflater();
        deflater.setInput(bytesToCompress);
        deflater.finish();

        byte[] bytesCompressed = new byte[Short.MAX_VALUE];

        int numberOfBytesAfterCompression = deflater.deflate(bytesCompressed);

        byte[] returnValues = new byte[numberOfBytesAfterCompression];

        System.arraycopy
        (
            bytesCompressed,
            0,
            returnValues,
            0,
            numberOfBytesAfterCompression
        );

        return returnValues;
    }

    public byte[] decompress(byte[] bytesToDecompress)
    {
        Inflater inflater = new Inflater();

        int numberOfBytesToDecompress = bytesToDecompress.length;

        inflater.setInput
        (
            bytesToDecompress,
            0,
            numberOfBytesToDecompress
        );

        int compressionFactorMaxLikely = 3;

        int bufferSizeInBytes =
            numberOfBytesToDecompress
            * compressionFactorMaxLikely;

        byte[] bytesDecompressed = new byte[bufferSizeInBytes];

        byte[] returnValues = null;

        try
        {
            int numberOfBytesAfterDecompression = inflater.inflate(bytesDecompressed);

            returnValues = new byte[numberOfBytesAfterDecompression];

            System.arraycopy
            (
                bytesDecompressed,
                0,
                returnValues,
                0,
                numberOfBytesAfterDecompression
            );            
        }
        catch (DataFormatException dfe)
        {
            dfe.printStackTrace();
        }

        inflater.end();

        return returnValues;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T12:07:34.053

两个提示：

1) 替换`getBytesFromFile`为众所周知的 API 调用，使用 Apache commons (IOUtils) 或 java 7 现在也提供了这样的方法。
2）测试`compress`并`decompress`编写一个Junit测试：创建一个随机的大字节数组，将其写出，读回并与创建的数组进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T12:14:02.557

我已经通过压缩和解压缩一个简单的 TXT 文件来测试您的代码。代码已**损坏**，因为压缩文件在未压缩时与原始文件不同。

理所当然地认为代码*至少*在`getBytesFromFile`函数中被破坏了。它的逻辑既棘手又麻烦，因为它只允许长度为 1064 的文件，并且检查（`IOException`读取较长文件时抛出）根本不起作用。该文件仅部分读取，不会引发异常。

您想要实现的目标（文件压缩/解压缩）可以通过这种方式完成。我已经测试过了，它可以工作，你只需要[**这个库**](http://commons.apache.org/io/index.html)。

```
import java.io.*;
import java.util.zip.*;
import org.apache.commons.io.IOUtils; // <-- get this from http://commons.apache.org/io/index.html

public class CompressionTest2 {

    public static void main(String[] args) throws IOException {
        File input = new File("input.txt");
        File output = new File("output.bin");
        Compression.compress(input, output);
        File input2 = new File("input2.txt");
        Compression.decompress(output, input2);
        // At this point, input.txt and input2.txt should be equal
    }

}

class Compression {

    public static void compress(File input, File output) throws IOException {
        FileInputStream fis = new FileInputStream(input);
        FileOutputStream fos = new FileOutputStream(output);
        GZIPOutputStream gzipStream = new GZIPOutputStream(fos);
        IOUtils.copy(fis, gzipStream);
        gzipStream.close();
        fis.close();
        fos.close();
    }

    public static void decompress(File input, File output) throws IOException {
        FileInputStream fis = new FileInputStream(input);
        FileOutputStream fos = new FileOutputStream(output);
        GZIPInputStream gzipStream = new GZIPInputStream(fis);
        IOUtils.copy(gzipStream, fos);
        gzipStream.close();
        fis.close();
        fos.close();
    }

} 
```

此代码并非来自“可靠和/或官方来源”，但至少它有效。:)

此外，为了获得更多答案，请调整标题以说明您的真正问题：您的压缩文件没有以正确的方式解压。这里没有“视频”的东西。此外，压缩`.mp4`文件也不是什么成就（压缩率可能在 99.99% 左右）。

# c# - XmlSerializer 在 c# 中给出 Null 异常

> ID：14836017
> 
> 赞同：-2
> 
> 时间：2013-02-12T15:33:21.443
> 
> 标签：c#, xml-serialization, nullreferenceexception

可以告诉我为什么这不起作用的人的金牌。仅供参考，它没有内部异常文本，所以它根本没有帮助我......

```
XmlSerializer x = new XmlSerializer(typeof(DownloadedSite)); 
```

我的内心异常只是空。我的错误是：{“对象引用未设置为对象的实例。”}

这是我的课：

```
namespace WayBackMachine.Business.Obj
{
    using System;
    using System.Xml.Serialization;
    using System.Linq;
    using System.Collections.Generic;

    [Serializable]
    [XmlRoot("DownloadedSite")]
    public class DownloadedSite : ManagedObject
    {
        private SortableBindingList<SiteSource> sources;// = new SortableBindingList<SiteSource>();
        private SortableBindingList<SiteSource> links;// = new SortableBindingList<SiteSource>();
        private SortableBindingList<Page> pages;// = new SortableBindingList<Page>();
        private string name;
        private string defaultSite;

        public DownloadedSite() : base()
        {
            sources = new SortableBindingList<SiteSource>();
            links = new SortableBindingList<SiteSource>();
            pages = new SortableBindingList<Page>();
            name = "";
            defaultSite = "";
        }

        [XmlArray("Sources")]
        [XmlArrayItem("SiteSource", typeof(SiteSource))]
        public SortableBindingList<SiteSource> Sources
        {
            get { return this.sources; }
            set
            {
                this.CheckPropertyChanged<SortableBindingList<SiteSource>>
                ("Sources", ref this.sources, ref value);
            }
        }

        [XmlArray("Links")]
        [XmlArrayItem("SiteSource", typeof(SiteSource))]
        public SortableBindingList<SiteSource> Links
        {
            get { return this.links; }
            set
            {
                this.CheckPropertyChanged<SortableBindingList<SiteSource>>
                ("Links", ref this.links, ref value);
            }
        }

        [XmlArray("Pages")]
        [XmlArrayItem("Page", typeof(SiteSource))]
        public SortableBindingList<Page> Pages
        {
            get { return this.pages; }
            set
            {
                this.CheckPropertyChanged<SortableBindingList<Page>>
                ("Pages", ref this.pages, ref value);
            }
        }

        [XmlElement("SiteName")]
        public string Name
        {
            get { return this.name; }
            set
            {
                CheckPropertyChanged<string>
                ("Name", ref this.name, ref value);
            }
        }

        [XmlElement("DefaultSite")]
        public string DefaultSite
        {
            get { return this.defaultSite; }
            set
            {
                CheckPropertyChanged<string>
                ("DefaultSite", ref this.defaultSite, ref value);
            }
        }

    }
} 
```

如果有帮助，这是它继承自的另一个类：

```
namespace WayBackMachine.Business
{
    using System.ComponentModel;
    using System;
    using System.Xml.Serialization;

    [Serializable]
    [XmlRoot("ManagedObject")]
    public class ManagedObject : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        protected bool CheckPropertyChanged<T>(string propertyName, ref T oldValue, ref T newValue)
        {
            if (oldValue == null && newValue == null)
            {
                return false;
            }
            if (oldValue == null && newValue != null || !oldValue.Equals((T)newValue))
            {
                oldValue = newValue;
                FirePropertyChanged(propertyName);
                return true;
            }
            return false;
        }

        protected void FirePropertyChanged(string propertyName)
        {
            if (this.PropertyChanged != null)
            {
                this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }
} 
```

有没有人有任何想法，它让我发疯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:53:06.603

这看起来不对：

```
 [XmlArray("Pages")]
 [XmlArrayItem("Page", typeof(SiteSource))] <-- should be typeof(Page)?
 public SortableBindingList<Page> Pages 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-24T12:11:25.740

首先检查节点是否存在，如果存在记下代码

XmlNode xmlNode = voucharbrandnode.SelectSingleNode("节点名称");

```
if (xmlNode != null)
{
write some code
} 
```

# javascript - 显示 JS 使仅部分屏幕响应滑动手势

> ID：14836022
> 
> 赞同：1
> 
> 时间：2013-02-12T15:33:34.867
> 
> 标签：javascript, ios, jquery-plugins, touchscreen

我正在寻找制作一个模拟 html 应用程序。我一直在使用显示 JS 和我自己的 jquery 来制作大部分内容，但我只需要页面的一部分对滑动手势“敏感”。有谁知道一种只使屏幕区域的一部分敏感的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:39:33.380

将一个 HTML 元素放在那里，覆盖所需的区域并将滑动事件绑定到它。

对于更多的概念，您应该尝试一些东西，如果没有成功，请返回一个代码示例。

# php - 来自库的 Codeigniter HMVC MY_Form_validation

> ID：14836025
> 
> 赞同：0
> 
> 时间：2013-02-12T15:33:42.557
> 
> 标签：php, codeigniter, codeigniter-2, hmvc

无论我做什么，我似乎都无法在我的 MY_Form_validation 中使用 dob 函数...请注意 _register_verify 在我的用户库中，而不是控制器，所以我使用的是 $CI 而不是 $this...

```
<?php
/** application/libraries/MY_Form_validation **/ 
class MY_Form_validation extends CI_Form_validation
{
    public $CI;
    function __construct( $config = array() )
    {
        parent::__construct($config);
        log_message('DEBUG', 'MY FORM VALIDATION Initialized!!');
    }

    // --------------------------------------------------------------------

    public function dob($dob)
    {
        $CI =& get_instance();
        $CI->form_validation->set_message('dob[]_check', 'Please enter a valid DOB');
        show_error('I AM AN ERROR');
    } 
```

这是我的用户库中的功能...

```
public function _register_verify($testmode = FALSE)
{
    if ($testmode) return TRUE;
    $CI =& get_instance();
    $CI->load->library('form_validation');
    $CI->form_validation->CI =& $CI;
    $CI->form_validation->set_rules('dob[]', 'DOB', 'trim|dob');
    if ($CI->form_validation->run() == FALSE)
    {
        // What to do if user details are NOT correct?
        $CI->session->set_flashdata('dob_error', form_error('dob[]'));
        return FALSE;
    } else {
        return TRUE;
    }
} 
```

我试过扩展 MY_Form_validation 而没有别的，它仍然不起作用。我发现的大多数教程都从控制器调用 form_validation。

我检查了日志，日志消息不存在，也没有显示错误。

编辑：设法让类初始化，但是 dob 永远不会被调用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:21:37.210

MY_Form_Validation.php 中的函数应该返回给出测试结果的布尔值。

```
public function dob($dob){
  //not perfect, but, returns true if date matches 12/10/1999 for example.
  return preg_match("/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/", $dob);
} 
```

确保您已在控制器或配置文件中将 dob 设置为规则，具体取决于您的设置方式：

```
$this->load->library('form_validation');
$this->form_validation->set_rules('dob', 'date of birth', 'required|dob'); 
```

错误在`application/language/english/form_validation_lang.php`. 添加：

```
$lang['dob'] = "Oops, wrong DOB format."; 
```

最后，请在控制器中运行表单验证，而不是库或模型。在此用例中，无需调用`get_instance()`并分配给 $CI。

# windows - 代码签名服务有什么区别？

> ID：14836035
> 
> 赞同：2
> 
> 时间：2013-02-12T15:33:59.750
> 
> 标签：windows, certificate, ssl-certificate, signing

我们正在为 Windows 开发一个新软件，并希望签署我们的代码以获得用户的信任。

有几家公司提供这项服务，价格也大不相同。

我不是在寻找针对特定服务的推荐 - 我只是想知道在这些供应商中可能有什么不同以及要寻找什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:58:25.690

科莫多为我工作。大约一年前我使用它们时，它是迄今为止最便宜的。其他人购买代码签名证书的价格要高得多。与 SSL 证书不同，它们会对客户进行一些尽职调查背景检查。这一定是额外费用的来源。他们确保 URL 和域名注册商地址和名称是真实的，并与付款名称和地址等匹配。因此，请确保您使用与付款、域名和电话一致的名称和地址，您应该一切就绪。我们在我的公司遇到了一些小问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:54:07.050

**重要提示：请注意下面的评论！Mozilla 和 Google 正在从受信任列表中删除 CA。**

它们基本上都是一样的。您为该服务付费以获得基于*AuthentiCode*的库、应用程序或文件签名的*证书。*您向每个 CA 支付相同的费用：验证您是否存在以及您是谁。然后，他们将为您创建一个证书，以保证您是一个真实的人。

 *如果用户看到您的证书来自 VeriSign（现为 Symantec）而不是 Digicert，这对用户来说并不重要。如果弹出带有绿色可信样式的 UAC 控制窗口，99% 的用户认为这是一个安全的应用程序，因为屏幕会变成绿色而不是黄色或红色。

**CA的业务非常好。他们正在以信任的方式工作。无限的好东西，成本低，利润大。**

CA 之间的区别主要在于它们提供的保修。如果有人基本上使用您的证书来签署应用程序，VeriSign 即提供 125K 美元的延长保修期。我不熟悉严格的指导方针，以防他们支付这笔钱。

老实说：如果有人使用他们为您创建的证书来创建签名的恶意软件应用程序，他们只会付费，即 - 您必须遵守告诉您如何保持证书安全和私密的指南。如果你丢失了你的证书或者是你的错，我无法想象他们会赔偿你的经济损失。

与 StartSSL 相比，VeriSign 的价格要贵 10 倍以上。我不明白为什么保单值这个差价。

如果您需要建议：坚持使用[StartSSL](https://www.startssl.com/)。他们提供最便宜的服务，让您有能力创造

*   一个 AuthentiCode 证书
*   无限 SSL 通配符证书
*   好服务

一次性费用为 60 美元。

PS不要忘记为您签名的可执行文件加上时间戳！*

# ios - UIScrollView 在 Paging 定义的停止之间停止（或减慢）滚动

> ID：14836038
> 
> 赞同：0
> 
> 时间：2013-02-12T15:34:10.763
> 
> 标签：ios, performance, uiscrollview, unity3d, slowdown

我有一个使用 Unity3D 的 iOS 应用程序。当我暂停 Unity 以仅显示与 Quartz 相关的内容时，性能通常很好。

但是在当前项目中，**滚动视图和表格视图有时会表现得很糟糕**。它们过早停止滚动，滚动视图甚至在分页预定义大小的倍数之间停止。

我试着用 Instruments 看一下，发现 FPS 通常约为 50-60，但有时会更低。然而，这并不能回答我的问题。

顺便说一句，表格和滚动条只有很少的数据，并且没有重新加载问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T08:13:02.833

[好的，现在我在Unity 论坛](http://forum.unity3d.com/threads/113815-quot-Sticky-quot-scrolling-in-UITableView-and-UIScrollView-when-interfacing-Unity-and-Obj-C)上找到了一些非常有用的信息。使用

```
#define USE_DISPLAY_LINK_IF_AVAILABLE 0 
```

防止描述的问题。Unity-iOS 项目现在使用 THREAD_BASED_LOOP 而不是 CADisplayLink 类。也许我会进一步使用 CADisplayLink 并降低目标帧速率。

有关使用的渲染循环类型的一些有趣信息可以在[Unity 手册](http://docs.unity3d.com/352/Documentation/Manual/iphone-Optimizing-MainLoop.html)中找到。

# android - 安全 SQLite 数据库

> ID：14836041
> 
> 赞同：1
> 
> 时间：2013-02-12T15:34:17.980
> 
> 标签：android, sqlite

我想知道 。

我正在尝试将我的数据库设为私有。可能吗。

如何`context.MODE_PRIVATE`在 SQLite DB 中使用。

我想让我的数据库私有，其他应用程序不应访问该数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T15:37:51.213

在将数据输入数据库之前加密数据。据我所知，SQLite 数据库保存在 /data/ 目录中某处的单个文件中。更重要的是，您的数据以纯文本格式保存。这意味着某人总是可以通过 root 手机、获取 .db SQLite 文件并使用文本编辑器打开它来提取该数据。

sqlite 的作者提供了一个加密数据的版本。它不是免费的

[https://guardianproject.info/code/sqlcipher/](https://guardianproject.info/code/sqlcipher/) SQLCipher 是一个 SQLite 扩展，它为数据库文件提供透明的 256 位 AES 加密。

早期的 sqlcipher 是用于 SQLite 的开源完整数据库加密，不适用于 android。但现在它可以作为 android 平台的 alpha 版本使用。开发人员已更新标准 android 应用程序“Notepadbot”以使用 SQLCipher。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:39:06.527

为了保护您的数据库，您必须在`cache`应用程序的内存中创建数据库。android 默认情况下会做这件事，除非你提供一个`external storage path`来保存你的数据库。

# python - Python 中定义的未达到 return 语句的行为是什么？

> ID：14836043
> 
> 赞同：1
> 
> 时间：2013-02-12T15:34:21.357
> 
> 标签：python, return

给定以下 Python 代码：

```
def avg(a):
  if len(a):
    return sum(a) / len(a) 
```

`avg`当 的长度`a`为零或语言未指定其行为因此不应在 Python 代码中计算时，语言定义的行为是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T15:34:42.590

默认返回值为`None`.

从[关于 Calls 的文档中](http://docs.python.org/2/reference/expressions.html#calls)：

> 调用总是返回一些值，可能是`None`，除非它引发异常。如何计算此值取决于可调用对象的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:46:04.907

如果`len(a)`is `0`，那将被视为`False`-like 值，并且您的`return`语句将无法到达。当控制流脱离函数底部而没有到达显式`return`语句时，Python 函数会隐式返回`None`：

```
>>> print(avg([]))
None 
```

If`len(a)`没有定义——换句话说，如果对象没有[`__len__()`](http://docs.python.org/2/reference/datamodel.html#object.__len__)方法——你会得到一个`TypeError`：

```
>>> print(avg(False))
Traceback (most recent call last): 
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 2, in avg
TypeError: object of type 'bool' has no len() 
```

# node.js - 如何在 Windows 上更改 npm 的缓存路径（或完全禁用缓存）？

> ID：14836053
> 
> 赞同：132
> 
> 时间：2013-02-12T15:34:51.330
> 
> 标签：node.js, npm

我已经在我的 Windows 7 x64 开发机器上安装了 Node.js，手动方式：

```
mkdir C:\Devel\nodejs
cd C:\Devel\nodejs
set NODE_PATH=%CD%
setx /M PATH "%PATH%;%NODE_PATH%"
setx /M NODE_PATH "%NODE_PATH%\node_modules" 
```

我已将主[节点 x64 二进制文件](http://nodejs.org/dist/latest/x64/)与[npm 包管理器](http://nodejs.org/dist/npm/)一起放在`C:\Devel\nodejs`. 像魅力一样工作，我可以更新主二进制文件而无需处理安装程序。

我无法解决的唯一问题是移动缓存文件夹。当我安装本地软件包时：

```
npm install express 
```

...缓存放在`%APP_DATA%\npm-cache`文件夹下。我想将其更改为：

`C:\Devel\nodejs\npm-cache`

如何更改 npm 缓存文件夹，或完全禁用它？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2013-02-12T21:09:23.407

`npm`您可以使用命令行更改 npm 缓存文件夹。（见[https://docs.npmjs.com/cli/v6/using-npm/config#cache](https://docs.npmjs.com/cli/v6/using-npm/config#cache)）

所以你可能想试试这个命令：

```
> npm config set cache C:\Devel\nodejs\npm-cache --global 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2017-08-07T11:41:55.850

您还可以使用`export npm_config_cache=/path/to/cache`(Unix) 或`set npm_config_cache=C:\path\to\cache`(Win) 设置环境变量作为替代`npm config set`（对于 npm 中的所有配置选项都是如此）。

* * *

对于使用 docker 的任何人，您都可以在运行时添加 env var：

```
docker run -e npm_config_cache=/path/to/cache mydockerimage:tag 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-11-16T20:48:33.897

您还可以执行以下操作：

**对于您希望的缓存路径，在安装单个软件包时：**

```
npm install packageName --cache path/to/some/folder 
```

**对于 package.json 中的所有包，为了拥有你想要的缓存路径：**

只需在 package.json 像往常一样的目录中并执行

```
npm install --cache path/to/some/folder 
```

你可能在 npm 文档中找不到这个，但我已经用 npm 6 尝试过它并且它可以工作。看起来它从 npm 5 开始就有效 [参考：[如何在安装命令中指定 npm5 中的缓存文件夹？](https://stackoverflow.com/questions/44310188/how-to-specify-cache-folder-in-npm5-on-install-command])

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-09-18T16:56:16.953

在 Windows 中，您可以简单地 cd 到所需的缓存文件夹并执行`npm set cache --global`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-01-27T19:32:35.837

此外，我发现运行更新命令也可以 - 例如：

```
npm update npm 
```

最后，可以检查他们的 npm-cache 目录以查看是否被填充。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-07-07T06:24:42.320

## 解决方案

将以下代码粘贴到 npmrc 文件中。

**npmrc**文件位置： ***C:\Program Files\nodejs\node_modules\npm\npmrc***

```
prefix=D:\nodejs\npm
cache=D:\nodejs\npm-cache 
```

**注意：没有'.' 在 npmrc 前面**

## 图表

### NPMRC 文件夹看起来像这样

[![在此处输入图像描述](../Images/f922eda173dc8a88c3c49f6c15918227.png)](https://i.stack.imgur.com/apgCQ.png)

### NPMRC 内容看起来像这样

[![在此处输入图像描述](../Images/fe8cb0786cd1a4f57f426a841eb1700f.png)](https://i.stack.imgur.com/3NTEi.png)

**希望能帮助到你。干杯**

# sql - 在 SQL 查询中对换行符/回车符使用 REPLACE

> ID：14836054
> 
> 赞同：7
> 
> 时间：2013-02-12T15:34:53.230
> 
> 标签：sql, sql-server

我有一个名为 Account Type 的数据库，其中包含回车符和换行符（CHAR(10) 和 CHAR(13)）。

当我搜索这个值时，我需要执行`REPLACE`如下所示的操作。以下代码工作正常。

```
SELECT AccountNumber,AccountType, 
  REPLACE(REPLACE(AccountType,CHAR(10),'Y'),CHAR(13),'X') FormattedText 
FROM Account 
WHERE AccountNumber=200
AND REPLACE(REPLACE(AccountType,CHAR(10),' '),CHAR(13),' ') LIKE 
'%Daily Tax Updates:  -----------------        Transactions%' 
```

我的问题是——需要这样替换的其他字符（类似于 CHAR(10) 和 CHAR(13)）是什么？

注意：该列的数据类型是`VARCHAR`.

注意：查询从 SQL Server Management Studio 运行

![在此处输入图像描述](../Images/3ea6f4ccb4a1c5a462b440630f74faca.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T15:50:46.713

可能还有嵌入的选项卡 ( `CHAR(9)`) 等。您可以使用以下内容找出需要替换的其他字符（我们不知道您的目标是什么）：

```
DECLARE @var NVARCHAR(255), @i INT;

SET @i = 1;

SELECT @var = AccountType FROM dbo.Account
  WHERE AccountNumber = 200
  AND AccountType LIKE '%Daily%';

CREATE TABLE #x(i INT PRIMARY KEY, c NCHAR(1), a NCHAR(1));

WHILE @i <= LEN(@var)
BEGIN
  INSERT #x 
    SELECT SUBSTRING(@var, @i, 1), ASCII(SUBSTRING(@var, @i, 1));

  SET @i = @i + 1;
END

SELECT i,c,a FROM #x ORDER BY i; 
```

您还可以考虑在这些数据进入数据库*之前对其进行更好的清理。*每次需要搜索或显示时都清理它不是最好的方法。

# android - 在 Parcelable 中存储复杂的对象图？

> ID：14836064
> 
> 赞同：2
> 
> 时间：2013-02-12T15:35:10.703
> 
> 标签：android, parcelable

现有的 Parcelable 示例相当琐碎。如果您有一个复杂的对象图，则会很快出现以下问题，质疑其可行性：

1.  有什么办法可以防止一个对象被多次写入一个包裹？
2.  编写时是否有任何最佳实践来限制对象图的深度？

举第一个问题的例子，对象 A 引用 B，而 B 又引用 A。这个循环导致写入 A，B，A，B，A，......直到我们得到一个 StackOverflowError，因为似乎没有一种仅引用先前编写的对象的方法。

对于第二个问题，让我们有一个很长的图 A->B->C->D->E，并且我们希望将 A 序列化为 2 的额外深度，即 A->B->C。我们通过编写一个自定义的 writeToParcelDeep 方法来做到这一点，这当然不如标准的 writeToParcel 方便。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-25T00:33:11.537

Java 序列化将保留引用并只写入一次对象。当前的设备也比过去的设备强大得多，我不太确定性能提升是否证明编写 Parcelable biolerplate 代码的合理性，尤其是在您的示例中如此复杂的代码。

[我将继续使用可序列化，您可以在此处](https://medium.com/nemanja-kovacevic/yet-another-post-on-serializable-vs-parcelable-1e829e98472)阅读有关我在此主题上的发现的更多信息。

# asp.net-mvc-4 - 当 IIS 在不同系统上运行时，SignalR WPF 客户端无法访问部署在 IIS 上的集线器

> ID：14836065
> 
> 赞同：4
> 
> 时间：2013-02-12T15:35:09.850
> 
> 标签：asp.net-mvc-4, signalr

我只是玩了一下signalR。我的应用程序只有一个简单的集线器，它存储在 ASP.NET 应用程序中，我编写了一个**WPF 客户端**，它通过集线器连接和创建的代理与 ASP.NET 应用程序进行交互。在我的本地 PC 上一切正常。我在**IIS**上部署了**ASP.NET 应用程序**。

 **现在我要进入正题了……

当我在**我自己的**PC 上的浏览​​器中输入以下内容时（pcthi-and）

```
http://pcthi-and:8080/signalr/hubs 
```

我会得到我想要的

**当我在另一**台电脑的浏览器中输入相同的 url 时，我会得到**相同的响应，并且一切看起来都很好。**

但我的应用程序只能在我的电脑上运行，而不能在另一台电脑上运行。当我在另一台电脑上启动 hubconnection 时，我没有得到 connectionId。

我试图将 url 更改为我的 IP 地址，但没有效果。

浏览器调用集线器有效，但应用程序不起作用。

**调用**如下所示：

```
private bool tryToConnectToCoffeService()
    {
        try
        {
            this.hubConnection = new HubConnection(ConfigurationManager.ConnectionStrings["coffeeConnection"].ConnectionString);

            this.hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;

            this.coffeeService = this.hubConnection.CreateHubProxy("coffee");

            this.hubConnection.Start();

            if (string.IsNullOrEmpty(hubConnection.ConnectionId))
            {
                return false;
            }

            return true;
        }
        catch(Exception ex)
        {
            return false;
        }
    } 
```

**Global.asax：**

```
public class Global : System.Web.HttpApplication
{

    protected void Application_Start(object sender, EventArgs e)
    {
        RouteTable.Routes.MapHubs();
    } 
```

像这样的枢纽

```
[HubName("coffee")]
public class CoffeeHub : Hub
{ 
```

我的集线器连接字符串是这样的：

```
"http://pcthi-and:8080/" 
```

或者：

```
"http://My-Current-IP-Address:8080/" 
```

我使用 SignalR 1.0 rc2。

有人有想法吗？感谢您的帮助。

干杯

坦率

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:45:37.657

我认为你需要改变

```
hubConnection.Start(); 
```

到

```
hubConnection.Start().Wait(); 
```

如果您正在运行 .NET 4.5，则可以创建该`tryToConnectToCoffeService`方法`async`，然后`await`在启动集线器连接时。

```
await hubConnection.Start(); 
```

它今天可能在 localhost 上工作，因为客户端可以在`if (string.IsNullOrEmpty(hubConnection.ConnectionId))`执行之前完成连接。

从另一台机器连接可能需要更长的时间，这会在您不等待`HubConnection.Start()`完成时暴露存在的竞争条件。**

# d3.js - d3.js: 到 svg:path 的距离

> ID：14836068
> 
> 赞同：9
> 
> 时间：2013-02-12T15:35:12.213
> 
> 标签：d3.js

是否有一种（有效的）方法来（a）计算 d3.js 中固定点和 svg:path 元素之间的最短距离，以及（b）确定路径上属于该距离的点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-18T21:24:10.543

在一般情况下，我不这么认为。SVG 路径是一个复杂的元素。例如，如果路径是贝塞尔曲线，则控制点可能不在所表示的线上，所表示的形状可能在控制点的边界框之外。

我认为，如果您有一组用于生成路径的点，您可以使用这些点来计算从这些点到给定点的距离并获得最小距离。在[MDN SVG 路径教程](https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths)中，您可以找到一些复杂形状的示例以及它们是如何制作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-25T05:05:12.273

虽然我的微积分答案仍然有效，但您可以[在这个 bl.ocks 示例中做所有事情](http://bl.ocks.org/mbostock/8027637)：

```
var points = [[474,276],[586,393],[378,388],[338,323],[341,138],[547,252],[589,148],[346,227],[365,108],[562,62]];

var width = 960,
    height = 500;

var line = d3.svg.line()
    .interpolate("cardinal");

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var path = svg.append("path")
    .datum(points)
    .attr("d", line);

var line = svg.append("line");

var circle = svg.append("circle")
    .attr("cx", -10)
    .attr("cy", -10)
    .attr("r", 3.5);

svg.append("rect")
    .attr("width", width)
    .attr("height", height)
    .on("mousemove", mousemoved);

function mousemoved() {
  var m = d3.mouse(this),
      p = closestPoint(path.node(), m);
  line.attr("x1", p[0]).attr("y1", p[1]).attr("x2", m[0]).attr("y2", m[1]);
  circle.attr("cx", p[0]).attr("cy", p[1]);
}

function closestPoint(pathNode, point) {
  var pathLength = pathNode.getTotalLength(),
      precision = pathLength / pathNode.pathSegList.numberOfItems * .125,
      best,
      bestLength,
      bestDistance = Infinity;

  // linear scan for coarse approximation
  for (var scan, scanLength = 0, scanDistance; scanLength <= pathLength; scanLength += precision) {
    if ((scanDistance = distance2(scan = pathNode.getPointAtLength(scanLength))) < bestDistance) {
      best = scan, bestLength = scanLength, bestDistance = scanDistance;
    }
  }

  // binary search for precise estimate
  precision *= .5;
  while (precision > .5) {
    var before,
        after,
        beforeLength,
        afterLength,
        beforeDistance,
        afterDistance;
    if ((beforeLength = bestLength - precision) >= 0 && (beforeDistance = distance2(before = pathNode.getPointAtLength(beforeLength))) < bestDistance) {
      best = before, bestLength = beforeLength, bestDistance = beforeDistance;
    } else if ((afterLength = bestLength + precision) <= pathLength && (afterDistance = distance2(after = pathNode.getPointAtLength(afterLength))) < bestDistance) {
      best = after, bestLength = afterLength, bestDistance = afterDistance;
    } else {
      precision *= .5;
    }
  }

  best = [best.x, best.y];
  best.distance = Math.sqrt(bestDistance);
  return best;

  function distance2(p) {
    var dx = p.x - point[0],
        dy = p.y - point[1];
    return dx * dx + dy * dy;
  }
}
```

```
path {
  fill: none;
  stroke: #000;
  stroke-width: 1.5px;
}

line {
  fill: none;
  stroke: red;
  stroke-width: 1.5px;
}

circle {
  fill: red;
}

rect {
  fill: none;
  cursor: crosshair;
  pointer-events: all;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
```

我把所有的时间都花在了上一个答案上，写了漂亮的 LaTeX！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-25T04:55:57.823

我不知道对此有特定于 d3 的解决方案。但是，如果您的路径可以表示为函数的一部分，那么通过一点微积分就有希望了。

1.  从线长方程开始[![长度方程](../Images/b351cebf2a5be6568e8ec0b25b5f87e6.png)](https://i.stack.imgur.com/JEaoM.gif)。
2.  将您的点插入 x1 和 y1。
3.  将剩余的 y 替换为代表您的路径的函数。
4.  化简，然后计算导数[![dd/dx](../Images/879cd40decba79034eb2a32fa662d972.png)](https://i.stack.imgur.com/Vr7Gp.gif)。
5.  设置[![dd/dx](../Images/879cd40decba79034eb2a32fa662d972.png)](https://i.stack.imgur.com/Vr7Gp.gif)为 0 并求解。希望一个 x 值将在您的路径端点的范围内。将此 x 应用于您的路径功能，您就可以在路径上找到自己的观点。

[一个更直观的例子。](http://www.mathalino.com/reviewer/differential-calculus/48-49-shortest-distance-from-a-point-to-a-curve-by-maxima-and-minima)在 JavaScript 中实现这一点需要考虑很多因素：我的函数是什么？获取上述导数的最快方法是什么？这些是特定于您的情况的。

# windows-phone-7 - Windows 手机上的“慢动作”效果

> ID：14836076
> 
> 赞同：3
> 
> 时间：2013-02-12T15:35:54.447
> 
> 标签：windows-phone-7, windows-phone-8, windows-phone

是否可以在 Windows Phone 设备上录制具有“慢动作”效果的视频？我试图找到有关此功能的一些信息，但没有找到任何信息

# asp.net - 在 ASP.NET MVC4 中注册自定义 UserProfile 导致重复表

> ID：14836085
> 
> 赞同：1
> 
> 时间：2013-02-12T15:36:24.243
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, asp.net-membership

我正在尝试将自定义 UserProfile 类存储在 ASP.NET MVC4 Internet 应用程序中。UserProfile 类名为“Usuario”，如下所示：

```
[Table("Usuarios")]
public class Usuario
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    [EmailAddress]
    public string Correo { get; set; }
    public string Twitter { get; set; }
    public string Perfil { get; set; }
    public string LinkedIn { get; set; }
    public List<Evento> Ponencias { get; set; }
    public List<Evento> Asistencias { get; set; }
    public List<Evento> EventosCreados { get; set; }
} 
```

我还创建了一个名为 WeventioDb 的 Context 类，如下所示：

```
 public class WeventioDb : DbContext
{
    public DbSet<Usuario> Usuarios { get; set; }
    public DbSet<Evento> Eventos { get; set; }
    public DbSet<Comentario> Comentarios { get; set; }
    public DbSet<Ubicacion> Ubicaciones { get; set; }
} 
```

**问题**是，当用户注册时，它不会存储到“Usuario”表中，而是存储在“Usuario”中（注意末尾缺少的 S），并且只有一个 UserName 属性和 UserId。我希望在用户注册时将其存储到“Usuarios”表中。

我的注册操作如下所示：

```
 public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            try
            {
                WebSecurity.CreateUserAndAccount(model.UserName, model.Password);
                WebSecurity.Login(model.UserName, model.Password);
                return RedirectToAction("Index", "Home");
            }
            catch (MembershipCreateUserException e)
            {
                ModelState.AddModelError("", ErrorCodeToString(e.StatusCode));
            }
        }

        return View(model);
    } 
```

关于如何创建用户并将其存储到“Usuarios”表中并将其与会员资格一起使用的任何想法？

Upadte：这就是我最初的迁移（表创建）的样子，它正在创建正确的表“Usuario”，但是当我转到 .mdf 文件时，“Usuario”表是空的，所有注册用户都在“Usuario”中" 如前所述：

```
public partial class Initial : DbMigration
{
    public override void Up()
    {
        CreateTable(
            "dbo.Usuarios",
            c => new
                {
                    UserId = c.Int(nullable: false, identity: true),
                    UserName = c.String(),
                    Correo = c.String(),
                    Twitter = c.String(),
                    Perfil = c.String(),
                    LinkedIn = c.String(),
                    Evento_Id = c.Int(),
                    Evento_Id1 = c.Int(),
                })
            .PrimaryKey(t => t.UserId)
            .ForeignKey("dbo.Eventos", t => t.Evento_Id)
            .ForeignKey("dbo.Eventos", t => t.Evento_Id1)
            .Index(t => t.Evento_Id)
            .Index(t => t.Evento_Id1);

        CreateTable(
            "dbo.Eventos",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Fecha = c.DateTime(nullable: false),
                    Precio = c.Double(nullable: false),
                    Descripcion = c.String(),
                    Schema = c.String(),
                    Sector = c.String(),
                    Banner = c.String(),
                    Imagen = c.String(),
                    Twitter = c.String(),
                    Hashtag = c.String(),
                    Programa = c.String(),
                    Organizador_UserId = c.Int(),
                    Rating_ID = c.Int(),
                    Sitio_Id = c.Int(),
                    Usuario_UserId = c.Int(),
                    Usuario_UserId1 = c.Int(),
                    Usuario_UserId2 = c.Int(),
                })
            .PrimaryKey(t => t.Id)
            .ForeignKey("dbo.Usuarios", t => t.Organizador_UserId)
            .ForeignKey("dbo.Ratings", t => t.Rating_ID)
            .ForeignKey("dbo.Ubicacions", t => t.Sitio_Id)
            .ForeignKey("dbo.Usuarios", t => t.Usuario_UserId)
            .ForeignKey("dbo.Usuarios", t => t.Usuario_UserId1)
            .ForeignKey("dbo.Usuarios", t => t.Usuario_UserId2)
            .Index(t => t.Organizador_UserId)
            .Index(t => t.Rating_ID)
            .Index(t => t.Sitio_Id)
            .Index(t => t.Usuario_UserId)
            .Index(t => t.Usuario_UserId1)
            .Index(t => t.Usuario_UserId2);

        CreateTable(
            "dbo.Ratings",
            c => new
                {
                    ID = c.Int(nullable: false, identity: true),
                    Texto = c.String(),
                    Puntaje = c.Int(nullable: false),
                    Fecha = c.DateTime(nullable: false),
                    Autor_UserId = c.Int(),
                })
            .PrimaryKey(t => t.ID)
            .ForeignKey("dbo.Usuarios", t => t.Autor_UserId)
            .Index(t => t.Autor_UserId);

        CreateTable(
            "dbo.Ubicacions",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Latitud = c.Double(nullable: false),
                    Longitud = c.Double(nullable: false),
                    Direccion = c.String(),
                    Nombre = c.String(),
                    Twitter = c.String(),
                    CodigoPostal = c.Int(nullable: false),
                    Ciudad = c.String(),
                    Estado = c.String(),
                })
            .PrimaryKey(t => t.Id);

        CreateTable(
            "dbo.Comentarios",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Texto = c.String(),
                    Fecha = c.DateTime(nullable: false),
                    Autor_UserId = c.Int(),
                    Evento_Id = c.Int(),
                })
            .PrimaryKey(t => t.Id)
            .ForeignKey("dbo.Usuarios", t => t.Autor_UserId)
            .ForeignKey("dbo.Eventos", t => t.Evento_Id)
            .Index(t => t.Autor_UserId)
            .Index(t => t.Evento_Id);

    }

    public override void Down()
    {
        DropIndex("dbo.Comentarios", new[] { "Evento_Id" });
        DropIndex("dbo.Comentarios", new[] { "Autor_UserId" });
        DropIndex("dbo.Ratings", new[] { "Autor_UserId" });
        DropIndex("dbo.Eventos", new[] { "Usuario_UserId2" });
        DropIndex("dbo.Eventos", new[] { "Usuario_UserId1" });
        DropIndex("dbo.Eventos", new[] { "Usuario_UserId" });
        DropIndex("dbo.Eventos", new[] { "Sitio_Id" });
        DropIndex("dbo.Eventos", new[] { "Rating_ID" });
        DropIndex("dbo.Eventos", new[] { "Organizador_UserId" });
        DropIndex("dbo.Usuarios", new[] { "Evento_Id1" });
        DropIndex("dbo.Usuarios", new[] { "Evento_Id" });
        DropForeignKey("dbo.Comentarios", "Evento_Id", "dbo.Eventos");
        DropForeignKey("dbo.Comentarios", "Autor_UserId", "dbo.Usuarios");
        DropForeignKey("dbo.Ratings", "Autor_UserId", "dbo.Usuarios");
        DropForeignKey("dbo.Eventos", "Usuario_UserId2", "dbo.Usuarios");
        DropForeignKey("dbo.Eventos", "Usuario_UserId1", "dbo.Usuarios");
        DropForeignKey("dbo.Eventos", "Usuario_UserId", "dbo.Usuarios");
        DropForeignKey("dbo.Eventos", "Sitio_Id", "dbo.Ubicacions");
        DropForeignKey("dbo.Eventos", "Rating_ID", "dbo.Ratings");
        DropForeignKey("dbo.Eventos", "Organizador_UserId", "dbo.Usuarios");
        DropForeignKey("dbo.Usuarios", "Evento_Id1", "dbo.Eventos");
        DropForeignKey("dbo.Usuarios", "Evento_Id", "dbo.Eventos");
        DropTable("dbo.Comentarios");
        DropTable("dbo.Ubicacions");
        DropTable("dbo.Ratings");
        DropTable("dbo.Eventos");
        DropTable("dbo.Usuarios");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T16:48:11.253

问题出在 InitializeSimpleMembership 类上，因此删除了 [InitializeSimpleMembership] 注释和类并添加到 Global.asax.cs 中：

```
 var migrator = new DbMigrator(new Configuration());
        migrator.Update();

        if (!WebSecurity.Initialized)
        {
            WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true);
        } 
```

# mysql - MySQL | 左连接

> ID：14836094
> 
> 赞同：3
> 
> 时间：2013-02-12T15:36:54.173
> 
> 标签：mysql, sql

我有这样的事情：

```
ID | post_author | post_date | ... | post_title | post_status | ... | post_type
-------------------------------------------------------------------------------
1  | 1           | 2007-08-11| ... | A          | publish     | ... | post
2  | 3           | 2007-08-12| ... | B          | publish     | ... | post
3  | 1           | 2007-08-12| ... | C          | publish     | ... | post
4  | 1           | 2007-08-13| ... | D          | publish     | ... | post
5  | 3           | 2007-08-13| ... | E          | publish     | ... | post 
```

我喜欢做的是按用户获取帖子数量以及最后一个帖子的标题和 ID。根据以上数据，结果应该是：

```
AuthorID | TotalPosts | PostID | PostTitle
------------------------------------------
1        | 3          | 5      | E
3        | 2          | 4      | D 
```

我试过的是这样的：

```
SELECT 
    p1.post_author         AS  Author,
    count(p1.post_author)  AS  Posts,
    p2.post_title          AS  Title
FROM 
    wp_posts AS p1
LEFT JOIN
    wp_posts As p2
ON
    p1.ID = p2.ID
WHERE
    p1.post_type   =   'post'
AND
    p1.post_status =   'publish'
GROUP BY
    p1.post_author
ORDER BY
    Posts   DESC,
    p2.post_date   ASC
LIMIT
    2 
```

问题是我总是得到第一篇文章的标题，而不是最后一篇文章的标题。有没有办法获得最后插入的帖子的标题？

亲切的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T15:49:08.613

如果您只想要每个作者的最新标题，您可以使用内联相关子查询。使用适当的索引，这将相对较快 - 特别是如果您只想要 2 个发表次数最多的作者的结果：

```
SELECT 
    post_author         AS  Author,
    COUNT(*)            AS  Posts,
    ( SELECT   p2.post_title
      FROM     wp_posts AS p2
      WHERE    p2.post_author = p1.post_author
        AND    p2.post_type = 'post'
        AND    p2.post_status = 'publish' 
      ORDER BY p2.post_date DESC
        LIMIT 1
    )                   AS  Title
FROM 
    wp_posts AS p1
WHERE
    post_type   =   'post'
AND
    post_status =   'publish'
GROUP BY
    post_author
ORDER BY
    Posts   DESC
LIMIT
    2 ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T15:45:50.807

像这样的东西应该工作：

```
SELECT p.post_author, p3.id, p3.post_title, COUNT(DISTINCT p.id) PostCount
FROM wp_posts p
   JOIN (
    SELECT Max(Post_Date) max_post_date, post_author
    FROM wp_posts
    GROUP BY post_author) p2
     ON p.post_author = p2.post_author
   JOIN wp_posts p3 on p.post_author = p3.post_author
    AND p2.max_post_date = p3.post_date
GROUP BY p.post_author, p3.id, p3.post_title 
```

这假设每个帖子只有一个日期。如果不是，您的 ID 字段也是您的最大字段吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:11:33.143

您能否检查此选项是否更快：

```
SELECT t1.*, t2.post_title FROM
    (SELECT 
        post_author         AS  Author,
        COUNT(*)            AS  Posts,
        Max(ID) AS MaxID
    FROM 
        wp_posts AS p
    WHERE
        post_type   =   'post' AND
        post_status =   'publish'
    GROUP BY post_author
    ORDER BY Posts   DESC
    LIMIT 2) t1 LEFT JOIN wp_posts t2 
                 ON t1.MaxID= t2.ID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T15:58:51.000

```
ORDER BY
p2.post_date DESC,
Posts   DESC 
```

# sql - 为什么这个错误来自 Postgres

> ID：14836096
> 
> 赞同：-1
> 
> 时间：2013-02-12T15:36:56.997
> 
> 标签：sql, database, postgresql

我有以下查询

```
select wbod.subject, wbi.object, 
       age(dod.object,wbod.object) as ageOfPerson 
from wasbornin as wbi, 
     wasbornondate as wbod, 
     diedondate as dod 
where wbi.subject=wbod.subject 
  and wbod.subject=dod.subject  
  and age(dod.object,wbod.object) = (select max(age(dod1.object,wbod1.object)) 
                                     from wasbornin as wbi1, 
                                     wasbornondate as wbod1, 
                                     diedondate as dod1 
                                     where wbi1.subject = wbod1.subject 
                                     and wbod1.subject=dod1.subject 
                                     group by wbi1.object)   
group by wbi.object 
ORDER BY wbi.subject; 
```

但它给出了以下错误

```
column "wbod.subject" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select wbod.subject, wbi.object 
```

为什么会出现这个错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T15:39:35.290

那是因为您正在选择此列。如果给定组（GROUP BY wbi.object）有 150 个不同的主题，应该返回哪一个？

我最初误读了查询 - 订单使用 wbi.subject，但错误与 wbod.subject 有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T15:45:59.317

如果我正确理解您的查询，您实际上不需要子查询或 group by：

```
select subject,
       object,
       ageOfPerson
from (
    select wbod.subject, 
           wbi.object, 
           age(dod.object, wbod.object) as ageOfPerson,
           dense_rank() over (partition by dod.subject order by age(dod.object, wbod.object) desc) as rnk
    from wasbornin as wbi
      join wasbornondate as wbod on wbi.subject=wbod.subject 
      join diedondate as dod on wbod.subject=dod.subject  
) t
where rnk = 1; 
```

# android - 每个安卓手机默认都有街景应用吗？

> ID：14836097
> 
> 赞同：1
> 
> 时间：2013-02-12T15:36:57.823
> 
> 标签：android, android-intent, android-package-managers, google-street-view

是不是每部2.3及以上的安卓手机都默认有街景，还是必须下载街景并安装。我问的原因是我在我的应用程序中使用街景，我使用

```
private boolean isIntentAvailable(Intent intent) {
    final PackageManager packageManager = mapView.getContext().getPackageManager();
    List<ResolveInfo> list =
            packageManager.queryIntentActivities(intent,
                    PackageManager.MATCH_DEFAULT_ONLY);

    return list.size() > 0;
} 
```

查看设备中是否有街景应用程序。问题是，在具有 android 4.1.1 街景的移动设备之一中可用，但此方法仍然为此抛出错误。但它适用于我测试过的大多数设备，就像在所有三星、HTC 和索尼手机中一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:39:37.797

并非所有安卓设备都有谷歌应用。这取决于构造函数

[编辑：]检查是否安装了应用程序，您可以使用：

```
appInstalledOrNot("com.google.android.apps.maps") 
```

使用方法：

```
private boolean appInstalledOrNot(String uri) {
        PackageManager pm = getPackageManager();
        boolean app_installed = false;
        try {
               pm.getPackageInfo(uri, PackageManager.GET_ACTIVITIES);
               app_installed = true;
        } catch (PackageManager.NameNotFoundException e) {
               app_installed = false;
        }
        return app_installed ;
} 
```

我在某处读到所有版本的地图都有街景，但我真的无法确认这一点，我不确定。

# objective-c - 试图用 UIRotationGestureController 模拟动量/惯性

> ID：14836107
> 
> 赞同：4
> 
> 时间：2013-02-12T15:37:35.703
> 
> 标签：objective-c, animation, rotation, uigesturerecognizer, momentum

好的，所以我正在尝试在 iOS 中使用轮子形状制作“幸运之轮”类型的效果，我可以在其中抓住并旋转轮子。我目前可以随心所欲地拖动和旋转轮子，但是松开手指后，它就停止了。我需要对其施加一些动量或惯性，以模拟车轮自然旋转。

我已经进行了速度计算，所以当我抬起手指时，我`NSLog`会得出一个速度（在最小 1 到最大 100 之间），范围在 1 到 1800 之间（在我最难的轻弹中！） ，现在我只是想确定如何将该速度转换为实际旋转以应用于对象，以及如何随着时间的推移减慢速度。

我最初的想法是这样的：开始以与给定速度相同的速度在一个循环上旋转一整圈，然后在随后的每次旋转中，将速度降低一小部分。这应该会产生一种效果，即较硬的旋转速度更快，并且需要更长的时间才能减速。

我不是数学家，所以我的方法可能是错误的，但如果有人对我如何让它工作有任何提示，至少在基本状态下，我将非常感激。这里有一个非常有用的答案：[iPhone添加惯性/动量物理来动画“命运之轮”，如旋转控制](https://stackoverflow.com/questions/9624804/iphone-add-inertia-momentum-physics-to-animate-wheel-of-fortune-like-rotating)，但它更具理论性，缺乏关于如何将计算出的速度准确应用于对象等的实用信息。我是我想我在这里也需要一些动画帮助。

编辑：我还需要弄清楚他们是顺时针还是逆时针拖动轮子。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:28:52.137

我为我的程序 Bit 写了一些类似的东西，但我认为我的情况有点复杂，因为我在 3D 中旋转：[https ://itunes.apple.com/ua/app/bit/id366236469?mt=8](https://itunes.apple.com/ua/app/bit/id366236469?mt=8)

基本上我所做的是设置一个定期调用某些方法的 NSTimer。我只是用方向和速度来创建一个旋转矩阵（正如我所说，3D 有点糟糕：P），然后我将速度乘以小于 1 的数字，所以它会下降。乘法而不是减法的原因是，如果用户的旋转速度是原来的两倍，那么您不希望对象旋转两倍的时间，因为等待我发现这很烦人。

至于确定车轮旋转的方向，只需将其存储在您拥有所有信息的 touchesEnded:withEvent: 方法中。既然您说只要用户手指向下，您就已经可以进行跟踪，这应该是显而易见的。

我在 3D 中的内容类似于：

```
// MyView.h
@interface MyView : UIView {
    NSTimer *animationTimer;
}
- (void) startAnimation;
@end

// MyAppDelegate.h
@implementation MyAppDelegate

- (void) applicationDidFinishLaunching:(UIApplication *)application {
    [myView startAnimation];
}

@end

// MyView.m
GLfloat rotationMomentum = 0;
GLfloat rotationDeltaX  = 0.0f;
GLfloat rotationDeltaY  = 0.0f;

@implementation MyView
- (void)startAnimation {
    animationTimer = [NSTimer scheduledTimerWithTimeInterval:(NSTimeInterval)((1.0 / 60.0) * animationFrameInterval) target:self selector:@selector(drawView:) userInfo:nil repeats:TRUE];
}

- (void) drawView:(id)sender {
    addRotationByDegree(rotationMomentum);
    rotationMomentum /= 1.05;
    if (rotationMomentum < 0.1)
        rotationMomentum = 0.1; // never stop rotating completely
    [renderer render];
}

- (void)touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event
{
}

- (void)touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
    UITouch *aTouch = [touches anyObject];
    CGPoint loc = [aTouch locationInView:self];
    CGPoint prevloc = [aTouch previousLocationInView:self];

    rotationDeltaX = loc.x - prevloc.x;
    rotationDeltaY = loc.y - prevloc.y;

    GLfloat distance = sqrt(rotationDeltaX*rotationDeltaX+rotationDeltaY*rotationDeltaY)/4;
    rotationMomentum = distance;
    addRotationByDegree(distance);

    self->moved = TRUE;
}

- (void)touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event
{
}

- (void)touchesCancelled:(NSSet*)touches withEvent:(UIEvent*)event
{
} 
```

我省略了 addRotationByDegree 函数，但它的作用是使用全局变量 rotationDeltaX 和 rotationDeltaY 并将旋转矩阵应用于已存储的矩阵，然后保存结果。在您的示例中，您可能想要一些更简单的东西，例如（我现在假设只有 X 方向的运动才能旋转轮子）：

```
- (void)touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
    UITouch *aTouch = [touches anyObject];
    CGPoint loc = [aTouch locationInView:self];
    CGPoint prevloc = [aTouch previousLocationInView:self];

    GLfloat distance = loc.x - prevloc.x;
    rotationMomentum = distance;
    addRotationByDegree(distance);

    self->moved = TRUE;
}

void addRotationByDegree(distance) {
    angleOfWheel += distance; // probably need to divide the number with something reasonable here to have the spin be nicer
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T18:20:05.850

这将是一个粗略的答案，因为我手头没有任何详细的例子。

如果您在抬起手指时已经有了速度，那么它应该不难。你拥有的速度是每秒像素或类似的东西。首先，您需要将该线速度转换为角速度。这可以通过知道圆的周长来完成`2*PI*radius`，然后`2*PI/perimeter*velocity`得到以弧度每秒为单位的角速度。

如果您的车轮在其轴上没有任何摩擦，它将永远以该速度运行。好吧，你可以为这个摩擦力仲裁一个值，这是一个加速度，可以用每秒平方的像素数或角加速度的每秒弧度平方来表示。然后只需将角速度除以该角加速度，就可以得到直到它停止的时间。

通过动画时间，您可以使用等式`finalAngle = initialAngle + angularSpeed*animationTime - angularAcceleration/2*animationTime*animationTime`来获得您的轮子将在动画结束时的最终角度。然后在变换上做一个动画，并在你得到的时间内旋转那个角度，然后说你的动画应该缓和下来。

这看起来应该足够现实。如果不是，您需要根据上面等式中的一些样本为您的轮子的旋转属性提供动画路径。

# internationalization - symfony 1_4 工厂 i18n 参数源容器 yaml

> ID：14836109
> 
> 赞同：0
> 
> 时间：2013-02-12T15:37:42.763
> 
> 标签：internationalization, containers, yaml, symfony-1.4

当我生成翻译容器文件（message.xml）

通过使用此命令：

```
php symfony i18n:extract frontend en --auto-save 
```

是否可以用 YML 文件替换 XML 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:20:19.557

你不能。

Symfony 1.x 只依赖 xliff 文件来处理国际化。所以你不能为此使用 yml 文件。

> 所有翻译都存储在目录中。i18n 框架提供了许多不同的策略来存储翻译。我们将使用“ [XLIFF](http://en.wikipedia.org/wiki/XLIFF) ”格式，这是一种标准且最灵活的格式。它也是管理员生成器和大多数 symfony 插件使用的商店。

正如您[在此处](http://www.symfony-project.org/api/1_4/i18n)看到的，在 yaml 文件中没有像`sfMessageSource_Yml`处理 i18n 这样的功能。

但是您可以在数据库中处理翻译。有一些插件可以做到这一点：

*   [tmcI18n插件](http://www.symfony-project.org/plugins/tmcI18nPlugin)
*   [mgI18n插件](https://github.com/rande/mgI18nPlugin)

# iphone - 在 iOS 中为 mp4 视频写字幕

> ID：14836115
> 
> 赞同：1
> 
> 时间：2013-02-12T15:38:10.230
> 
> 标签：iphone, ios, ios4, avfoundation, mp4

我有一个 mp4 视频和一个元数据 xml 文件，其中包含有关要添加到 mp4 的字幕的信息。我想在 iOS 中为该视频添加字幕。我知道这可以使用 HTML5 的视频元素来完成。我想知道 iOS 中是否有任何 API 可以做到这一点，比如 AVFoundation 或 MediaPlayer 框架。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:43:32.643

我不是百分百肯定这会回答你的问题，因为它看起来有点模糊。但这可能会帮助你。 [http://www.3playmedia.com/2011/12/22/html5-video-captioning-explain-it-to-me/](http://www.3playmedia.com/2011/12/22/html5-video-captioning-explain-it-to-me/)

# ruby-on-rails - 如何告诉 Bundler 使用系统范围内安装的 gems（生产部署）？

> ID：14836119
> 
> 赞同：1
> 
> 时间：2013-02-12T15:38:34.817
> 
> 标签：ruby-on-rails, rubygems, rvm, capistrano, bundler

使用 Capistrano 部署 Rails 应用程序时，我希望 Bundler`shared/bundles`仅在找不到已在系统范围内安装的 gem 时将 gem 安装到目录。我该怎么做？

例如，如果我已经在系统上安装了一个`pg`gem ，我希望 Bundler 使用它，而不是在我的应用程序的目录中`v 0.14`构建和安装一个新的。`shared/bundles`

我正在使用 Ubuntu Server，并且为多个用户安装了 RVM。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:09:03.883

Bundler 允许使用**共享**(rubygems) 和**vendored** (bundler) gems，默认`bundler/capistrano`配置为：

```
set :bundle_flags, "--deployment --quiet" 
```

仅强制出售宝石，

您可以显式切换回共享 gem：

```
set :bundle_flags, "--system --quiet" 
```

仍然安装`vendor`但也使用共享宝石：

```
set :bundle_flags, "--path #{shared_path}/bundles --quiet" 
```

如果部署已经运行`--deployment`（默认），那么它可以帮助运行一次部署：

```
set :bundle_flags, "--no-deployment" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:50:52.240

这实际上是 Bundler 的一个特性，本质上是依赖隔离——你不希望你的应用程序依赖于像这样的外部系统 gem。更新系统 gem 可能会对正在运行的应用程序产生影响。

如果您已经在使用 capistrano，那么您应该在脚本中使用它，无论如何`require "bundler/capistrano"`都会安装它们。`shared/bundles`您也可以事先查看包装：http: [//gembundler.com/v1.2/bundle_package.html](http://gembundler.com/v1.2/bundle_package.html)

# c# - 非常简单的网络服务：接受输入、电子邮件结果

> ID：14836120
> 
> 赞同：2
> 
> 时间：2013-02-12T15:38:38.723
> 
> 标签：c#, python, django, web-services

我在一家小型初创公司担任数据科学家，我正在寻找使我的分析对组织更可见/更有用的方法。我希望能够建立一个简单的网络服务，允许内部用户远程运行我的脚本。他们应该能够通过一个非常简单的 UI 输入一些参数，并且他们应该可以选择将结果显示在浏览器窗口中（可能需要很长时间），或者通过电子邮件发送。结果可能是一些 pdf 数字，也可能是 Excel 电子表格（将来可能会更奇特，但目前仅此而已）。

脚本将全部在 Python 中，它将处理分析。

所以，我想知道使用 C#/WCF 与 Django 或 Python 之类的优缺点。我在这里在客户端代码库中工作的 C# 方面有丰富的经验，但我对 WCF 的经验要少得多。我所有的分析工作都是在 Python（和 R，在较小程度上）完成的。主要目标是不要把我所有的时间都花在构建一个花哨的 Web 服务/UI 上——前端必须足够友好，不会吓到营销人员。我不必担心加密，服务器将在我们的防火墙后面。我与平台无关，但我认为服务器都是基于 Windows 的，如果这有帮助的话。

提前致谢。

* * *

如果我的一些脚本在 F# 中，您的答案会如何变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:26:23.657

您可以考虑使用 Django Web 框架。你可以用你的 python 脚本设置一个小应用程序作为不同的视图。[https://www.djangoproject.com/](https://www.djangoproject.com/)

如果你不想花太多精力来创建友好的 UI，你可以使用 twitter bootstrap。 [http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

然后只需在内部运行应用程序以通过 HTTP GET 或电子邮件收集和显示数据。

编辑：对不起，我没有仔细阅读“使用 C#/WCF 与 Django 之类的优缺点”。我最近制作了一个 Django 应用程序，它相当简单。

# php - 多域主页的 CodeIgniter 配置

> ID：14836124
> 
> 赞同：1
> 
> 时间：2013-02-12T15:39:19.250
> 
> 标签：php, codeigniter, url-routing, app-config

我已经构建了一个 CI 应用程序，最近才被告知它必须是多宿主的。也就是说，它将位于具有 2 个 NIC 的服务器上。一个用于`www`内部地址，另一个用于内部地址。

我不太确定我应该在我的配置文件中使用什么值`base_url`。从技术上讲，该站点的用户应该能够通过以下任一方式访问它：

`www.widgets.com`- 公共地址

或者

`http://ourserver.widgets.net`- 内部地址

如何配置我的 CI 应用程序以允许这样做？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:05:26.760

修改`base_url`in的配置为`./application/config/config.php`如下

```
/*
  |--------------------------------------------------------------------------
  | Base Site URL
  |--------------------------------------------------------------------------
  |
  | URL to your CodeIgniter root. Typically this will be your base URL,
  | WITH a trailing slash:
  |
  | http://example.com/
  |
  | If this is not set then CodeIgniter will guess the protocol, domain and
  | path to your installation.
  |
 */
$config['base_url'] = 'http' . ((isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] == 'on') ? 's' : '') . '://' . $_SERVER['HTTP_HOST'] . '/';; 
```

它接受任何域`widgets.com`或`ourserver.widgets.net`带有`http`和`https`协议的任何域。谢谢！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:02:11.600

```
$config['base_url'] = ''; 
```

CodeIgniter 会`base_url`自行解决。

# java - 找不到主要方法

> ID：14836125
> 
> 赞同：0
> 
> 时间：2013-02-12T15:39:19.280
> 
> 标签：java, methods, main

当我尝试执行下面的 java 类（AuctionExample1.java）时，出现以下错误：“选择不包含主要类型”

这是java类：

```
package org.cloudbus.cloudsim.examples.auction;

/**
* A simple example showing how to create a bidder datacenter and a bidder broker 
* and start the auction.
* No VM is specified at all because no one wins he auction.
* 
* Created on 2011/9/9
*/
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.LinkedList;
import java.util.List;

import org.cloudbus.cloudsim.Cloudlet;
import org.cloudbus.cloudsim.CloudletSchedulerTimeShared;
import org.cloudbus.cloudsim.DatacenterCharacteristics;
import org.cloudbus.cloudsim.Host;
import org.cloudbus.cloudsim.Log;
import org.cloudbus.cloudsim.Pe;
import org.cloudbus.cloudsim.Storage;
import org.cloudbus.cloudsim.UtilizationModel;
import org.cloudbus.cloudsim.UtilizationModelFull;
import org.cloudbus.cloudsim.Vm;
import org.cloudbus.cloudsim.VmAllocationPolicySimple;
import org.cloudbus.cloudsim.VmSchedulerTimeShared;
import org.cloudbus.cloudsim.auction.auctioneer.Auctioneer;
import org.cloudbus.cloudsim.auction.bid.DatacenterBid;
import org.cloudbus.cloudsim.auction.bid.DatacenterBrokerBid;
import org.cloudbus.cloudsim.auction.bidder.BidderDatacenter;
import org.cloudbus.cloudsim.auction.bidder.BidderDatacenterBroker;
import org.cloudbus.cloudsim.auction.vm.DatacenterAbstractVm;
import org.cloudbus.cloudsim.auction.vm.VmCharacteristics;
import org.cloudbus.cloudsim.core.CloudSim;
import org.cloudbus.cloudsim.provisioners.BwProvisionerSimple;
import org.cloudbus.cloudsim.provisioners.PeProvisionerSimple;
import org.cloudbus.cloudsim.provisioners.RamProvisionerSimple;

public class AuctionExample1 {

/** The cloudlet list. */
private static List<Cloudlet> cloudletList;

/** The vmlist. */
private static List<Vm> vmlist;

/**
 * Creates main() to run this example.
 *
 * @param args the args
 */
public static void main(String[] args) {
    Log.printLine("Starting AuctionExample1...");

    try {
        // First step: Initialize the CloudSim package. It should be called
        // before creating any entities.
        int num_user = 1; // number of cloud users
        Calendar calendar = Calendar.getInstance();
        boolean trace_flag = false; // mean trace events

        // Initialize the CloudSim library
        CloudSim.init(num_user, calendar, trace_flag);
        Auctioneer.initAuctioneer();

        // Second step: Create Datacenters
        // Datacenters are the resource providers in CloudSim. We need at
        // list one of them to run a CloudSim simulation
        BidderDatacenter datacenter0 = createDatacenter("Datacenter_0");

        // Third step: Create Broker
        BidderDatacenterBroker broker = createBroker();
        int brokerId = broker.getId();

        // Fourth step: Create one virtual machine
        vmlist = new ArrayList<Vm>();

        // VM description
        int vmid = 0;
        int mips = 1000;  /*Youness: VM need  to  be  allocated  a  share  of  
        processing  power  on   Datacenter's  hosts.*/

        long size = 10000; // image size (MB) (Youness: virtual machine's image size)
        int ram = 512; // vm memory (MB)
        long bw = 1000;
        int pesNumber = 1; // number of cpus
        String vmm = "Xen"; // VMM name

        // create VM
        Vm vm = new Vm(vmid, brokerId, mips, pesNumber, ram, bw, size, vmm, new                 CloudletSchedulerTimeShared());

        // add the VM to the vmList
        vmlist.add(vm);

        // Fifth step: Create one Cloudlet
        cloudletList = new ArrayList<Cloudlet>();

        // Cloudlet properties
        int id = 0;
        long length = 400000; //MI       cloudletLength
        long fileSize = 300;   //cloudletFileSize
        long outputSize = 300;  //cloudletOutputSize
        UtilizationModel utilizationModel = new UtilizationModelFull();

        Cloudlet cloudlet = new Cloudlet(id, length, pesNumber, fileSize, outputSize, utilizationModel, utilizationModel, utilizationModel);
        cloudlet.setUserId(brokerId);
        cloudlet.setVmId(vmid);//Youness: Bind cloudLet to a VM. If you do not do this, application assigns the first created VM for this cloudlet

        // add the cloudlet to the list
        cloudletList.add(cloudlet);

        // submit cloudlet list to the broker
        broker.submitCloudletList(cloudletList);

        DatacenterBrokerBid brokerBid = new DatacenterBrokerBid(broker.getId(), 0.0035);
        brokerBid.addVM(vm, 1);
        broker.submitBid(brokerBid);

        // Sixth step: Starts the simulation
        CloudSim.startSimulation();         

        CloudSim.stopSimulation();

        //Final step: Print results when simulation is over
        List<Cloudlet> newList = broker.getCloudletReceivedList();
        printCloudletList(newList);

        // Print the debt of each user to each datacenter
        datacenter0.printDebts();

        Log.printLine("AuctionExample1 finished!");
    } catch (Exception e) {
        e.printStackTrace();
        Log.printLine("Unwanted errors happen");
    }
}

/**
 * Creates the datacenter.
 *
 * @param name the name
 *
 * @return the datacenter
 */
private static BidderDatacenter createDatacenter(String name) {

    // Here are the steps needed to create a PowerDatacenter:
    // 1\. We need to create a list to store
    // our machine
    List<Host> hostList = new ArrayList<Host>();

    // 2\. A Machine contains one or more PEs or CPUs/Cores.
    // In this example, it will have only one core.
    List<Pe> peList = new ArrayList<Pe>();

    int mips = 1000;

    // 3\. Create PEs and add these into a list.
    peList.add(new Pe(0, new PeProvisionerSimple(mips))); // need to store Pe id and MIPS Rating

    // 4\. Create Host with its id and list of PEs and add them to the list
    // of machines
    int hostId = 0;
    int ram = 2048; // host memory (MB)
    long storage = 1000000; // host storage
    int bw = 10000;

    Host host = new Host(
            hostId,
            new RamProvisionerSimple(ram),
            new BwProvisionerSimple(bw),
            storage,
            peList,
            new VmSchedulerTimeShared(peList)
        );
    hostList.add(host); // This is our machine

    // 5\. Create a DatacenterCharacteristics object that stores the
    // properties of a data center: architecture, OS, list of
    // Machines, allocation policy: time- or space-shared, time zone
    // and its price (G$/Pe time unit).
    String arch = "x86"; // system architecture
    String os = "Linux"; // operating system
    String vmm = "Xen";
    double time_zone = 10.0; // time zone this resource located
    double cost = 3.0; // the cost of using processing in this resource
    double costPerMem = 0.05; // the cost of using memory in this resource
    double costPerStorage = 0.001; // the cost of using storage in this
                                    // resource
    double costPerBw = 0.0; // the cost of using bw in this resource
    LinkedList<Storage> storageList = new LinkedList<Storage>(); // we are not adding SAN
                                                // devices by now

    DatacenterCharacteristics characteristics = new DatacenterCharacteristics(
            arch, os, vmm, hostList, time_zone, cost, costPerMem,
            costPerStorage, costPerBw);

    // 6\. Finally, we need to create a PowerDatacenter object.
    BidderDatacenter datacenter = null;
    try {
        datacenter = new BidderDatacenter(name, characteristics, new VmAllocationPolicySimple(hostList), storageList, 0);
    } catch (Exception e) {
        e.printStackTrace();
    }

    //TODO check if VM fits the host
    VmCharacteristics vmCharacteristics = new VmCharacteristics(
            arch, os, vmm, time_zone, cost, costPerMem,
            costPerStorage, costPerBw);
    DatacenterAbstractVm vm = new DatacenterAbstractVm(1000, 1, 512, 1000, 1000, vmCharacteristics);
    DatacenterBid bid = new DatacenterBid(datacenter.getId());
    bid.addVM(vm, 1);
    datacenter.submitBid(bid);

    return datacenter;
}

// We strongly encourage users to develop their own broker policies, to
// submit vms and cloudlets according
// to the specific rules of the simulated scenario
/**
 * Creates the broker.
 *
 * @return the datacenter broker
 */
private static BidderDatacenterBroker createBroker() {
    BidderDatacenterBroker broker = null;
    try {
        broker = new BidderDatacenterBroker("Broker");
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
    return broker;
}

/**
 * Prints the Cloudlet objects.
 *
 * @param list list of Cloudlets
 */
private static void printCloudletList(List<Cloudlet> list) {
    int size = list.size();
    Cloudlet cloudlet;

    String indent = "    ";
    Log.printLine();
    Log.printLine("========== OUTPUT ==========");
    Log.printLine("Cloudlet ID" + indent + "STATUS" + indent
            + "Data center ID" + indent + "VM ID" + indent + "Time" + indent
            + "Start Time" + indent + "Finish Time");

    DecimalFormat dft = new DecimalFormat("###.##");
    for (int i = 0; i < size; i++) {
        cloudlet = list.get(i);
        Log.print(indent + cloudlet.getCloudletId() + indent + indent);

        if (cloudlet.getCloudletStatus() == Cloudlet.SUCCESS) {
            Log.print("SUCCESS");

            Log.printLine(indent + indent + cloudlet.getResourceId()
                    + indent + indent + indent + cloudlet.getVmId()
                    + indent + indent
                    + dft.format(cloudlet.getActualCPUTime()) + indent
                    + indent + dft.format(cloudlet.getExecStartTime())
                    + indent + indent
                    + dft.format(cloudlet.getFinishTime()));
        }
    }
}

} 
```

我想补充一点，这个项目的结构不构成包。以下是项目层次结构的概要描述：

```
/CloudAuction
/CloudAuction/src
/CloudAuction/src/main
/CloudAuction/src/test
/CloudAuction/src/test/java
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction/AuctionExample1.java
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction/AuctionExample2.java
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction/AuctionExample3.java
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction/AuctionExample4.java
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction/BidderBrokerFactory.java
/CloudAuction/src/test/java/org.cloudbus.cloudsim.examples.auction/BidderDatacenterFactory.java
/CloudAuction/target
/CloudAuction/pom.xml 
```

任何人都可以帮我找到解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:57:52.243

在 src 文件夹下，您必须将包名称表示为文件夹。在您的代码中，您有： org.cloudbus.cloudsim.examples.auction 作为包名称，但您的 src 中没有相同的文件夹，该文件夹需要是这样的：

```
src/org/cloudbus/cloudsim/examples/auction/YourClass.java 
```

# c# - 为什么.net 中有静态和非静态的 Equals 重载？

> ID：14836131
> 
> 赞同：2
> 
> 时间：2013-02-12T15:39:34.197
> 
> 标签：c#, .net, equals

为什么.NET 的对象类中有[两个重载？](http://msdn.microsoft.com/en-us/library/d5171fyh.aspx)`Equals`如果我想要一个自定义相等函数，例如以便我可以使用集合或字典，我应该覆盖两者（除了`GetHashCode`），还是只覆盖其中一个就足够了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T15:42:27.253

您不能覆盖静态版本。

使用静态版本的原因是您可以`object.Equals(myObject, myOtherObject)`在不事先检查空值的情况下调用。

在内部，它只检查空值（`true`如果两个对象都为空则返回），然后委托给`myObject.Equals(myOtherObject)`. 因此，您只需要覆盖非静态 Equals 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T15:42:37.950

如果“第一个”对象为空，则存在静态方法。例如，如果`a`为 null`b`且不为 null，则您将无法运行`a.Equals(b)`，但您将能够运行`object.Equals(a, b)`.

您应该（并且**可以**）仅覆盖实例方法，原因有两个。首先，您不能覆盖静态方法。其次，静态方法最终会调用非静态方法。

有关更多信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/w4hkze5k.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T15:41:30.657

您不能覆盖静态方法。

仅覆盖非静态方法就可以了...

阅读这篇文章： [如何：覆盖静态方法](http://blogs.msdn.com/b/kirillosenkov/archive/2008/02/06/how-to-override-static-methods.aspx)：

> **为什么我们不能覆盖静态成员？**
> 
> 真的，为什么？如果你仔细想想，这只是常识。覆盖普通（实例）成员使用虚拟调度机制将合同与实现分开。合约在编译时已知（实例成员签名），但实现仅在运行时已知（具体类型的对象提供具体实现）。您在编译时不知道实现的具体类型。
> 
> 理解这一点很重要：当类型从其他类型继承时，它们履行一个共同的契约，而静态类型不受任何契约的约束（从纯 OOP 的角度来看）。语言中没有技术方法可以将两种静态类型与“继承”契约联系在一起。如果您要在两个不同的地方“覆盖” Log 方法，我们怎么知道我们在这里调用的是哪一个： Log.Message("what is the implementation?")
> 
> 对于静态成员，您可以通过显式指定定义它们的类型来调用它们。这意味着，您可以直接调用实现，这同样不受任何合约的约束。
> 
> 顺便说一句，这就是静态成员不能实现接口的原因。这就是虚拟调度在这里没有用的原因——所有客户端都直接调用实现，没有任何合同。

# ajax - Opencart addToCart 收到空响应

> ID：14836135
> 
> 赞同：0
> 
> 时间：2013-02-12T15:39:38.743
> 
> 标签：ajax, opencart

我有opencart。将产品添加到购物车的函数 addToCart() 在普通页面上正常工作。

我制作了自定义页面，其中只有触发函数 addtoCart() 的按钮。只是普通的按钮..

在正常页面（它工作的地方）我得到正常的响应。

请看这个图片链接：http: [//imgur.com/7M1AR1B,FKjiU05,9ggmiMR#2](http://imgur.com/7M1AR1B,FKjiU05,9ggmiMR#2)

第三张图片实际上是可以正常工作的帖子，第二张图片是可以正常工作的响应。第一张图片是我在打开购物车的自定义页面中得到的空响应。

你知道为什么会这样吗？

我使用函数 addToCart() 并在该自定义页面中使用硬变量 FOR TEST，这意味着变量总是可以传递。我使用硬变量，所以我不必解释如何在代码中将变量传回（它的工作原理相同，它在调试中传递所有内容）。问题是我只在定制页面上得到“空”响应。回复： [] ...

```
function addToCart() {

    var product_id = 79;
    var quantity = 1;

    $.ajax({
        url: 'index.php?route=checkout/cart/add',
        type: 'post',
        data: 'product_id=' + product_id + '&quantity=' + quantity,
        dataType: 'json',
        success: function (json) {
            $('.success, .warning, .attention, .information, .error').remove();

            if (json['redirect']) {
                location = json['redirect'];
            }

            if (json['success']) {
                $('#notification').html('<div class="success" style="display: none;">' + json['success'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');

                $('.success').fadeIn('slow');

                $('#cart-total').html(json['total']);

                $('html, body').animate({
                    scrollTop: 0
                }, 'slow');
            }
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:00:44.617

问题是，我添加了一个没有 1 个所需属性的产品，因此我总是得到空响应。opencart 中有一个属性，您必须在其中设置您的产品所属的商店。如果您在以编程方式将产品添加到商店时未设置该属性，您将添加产品，但无法将其添加到购物车。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T00:42:32.780

尝试的可能性

1.  使用 HTTPS 到非 HTTPS，反之亦然
2.  使用 www 到非 www 域，反之亦然
3.  使用与您用于呈现页面的域不同的域

如果以上都不是问题，您需要弄清楚请求之间的确切差异是什么，尽管我猜这是我列出的三种可能性之一

# casperjs - 从 cron 运行 CasperJS

> ID：14836136
> 
> 赞同：5
> 
> 时间：2013-02-12T15:39:39.317
> 
> 标签：casperjs

所以，我试图在我的服务器上运行 casperJS 作为 cron 作业，这是 crontab：

```
* * * * * /usr/local/bin/casperjs /var/www/javascript/uat/prime.sh 2>&1 
```

这是prime.sh

```
#!/bin/bash

export PHANTOMJS_EXECUTABLE=/usr/local/bin/phantomjs
/usr/local/bin/casperjs /var/www/javascript/uat/prime.js 2>&1 
```

我还将导出添加到用户的 .bash_profile 中，但 cron 会通过电子邮件发送给我

```
Fatal: [Errno 2] No such file or directory; did you install phantomjs? 
```

不知道还能做什么！有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T16:25:09.583

`.sh`使用仅运行`.js`或文件的 casperjs调用 a`.coffee`肯定不会分叉。我认为您可以像这样更直接地设置您的 cronjob：

```
* * * * * PHANTOMJS_EXECUTABLE=/usr/local/bin/phantomjs /usr/local/bin/casperjs /var/www/javascript/uat/prime.js 2>&1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-01T12:15:07.590

我有类似的问题，我像您一样将 phantomjs 和 casperjs 条目放入 .bashrc，然后以这种方式设置 cron

```
* * * * * source ~/.bashrc; casperjs /var/www/javascript/uat/prime.js 2>&1 
```

这对我有用。

# forms - 如何验证 OneToMany 实体表单集合？

> ID：14836139
> 
> 赞同：1
> 
> 时间：2013-02-12T15:39:44.427
> 
> 标签：forms, symfony, validation, symfony-2.1

我有一个产品表，它与产品到部门表之间存在一对多关系，其中产品可以与一个或多个部门相关联。

我在添加新产品以验证我的部门时遇到问题。

如果我不选择部门，表格仍会验证并提交。

这是我构建表单的地方。

```
class NewProductType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('departments', 'collection', array(
            'type' => new ProductDepartmentType(),
            'required' => true,
        ));
... 
```

该集合是通过 ProductDepartmentType 类设置的：

```
class ProductDepartmentType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('department', 'entity', array(
            'property' => 'indentedName',
            'class' => 'WebIllumination\SiteBundle\Entity\Department',
            'query_builder' => function(EntityRepository $er) {
                return $er->createQueryBuilder('d')
                    ->addSelect('dd')
                    ->leftJoin('d.descriptions', 'dd')
                    ->orderBy('d.displayOrder', 'ASC');
            },
            'required' => true,
            'empty_value' => '- Select a Department -',
        ), array());
        $builder->add('displayOrder', 'hidden');
    }

    public function getDefaultOptions(array $options)
    {
        $collectionConstraint = new Collection(array(
            'department' => array(
                new NotBlank(array('message' => 'Select a department.')),
            ),
        ));

        return array(
            'validation_constraint' => $collectionConstraint,
        );
    }

    public function getName()
    {
        return 'site_product_department';
    }
} 
```

然后我尝试将以下内容添加到 ProductDepartmentType 中：

```
class ProductDepartmentType extends AbstractType
{
...
    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'WebIllumination\SiteBundle\Entity\ProductToDepartment'
        ));
    }
... 
```

这没有任何影响，并且表单仍然可以在未经验证的情况下提交。

谁能帮我弄清楚如何验证这个字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:23:40.183

当您嵌套表单时，默认情况下错误不会传递给父表单。在您的子表单中，您需要设置`error_bubbling => true`要验证的字段，这会将错误传递给父表单。[http://symfony.com/doc/current/reference/forms/types/entity.html#error-bubbling](http://symfony.com/doc/current/reference/forms/types/entity.html#error-bubbling)

# svn - 是否可以将我的工作副本与任意修订进行比较？

> ID：14836143
> 
> 赞同：22
> 
> 时间：2013-02-12T15:40:02.620
> 
> 标签：svn, tortoisesvn

我知道从命令提示符下，我可以做类似的事情

```
svn diff -rXXX foo.bar 
```

将我的工作副本`foo.bar`与修订进行比较`XXX`，**即使此修订位于合并分支上。**

我怎样才能用 TortoiseSVN 做同样的事情？它就像一个魅力，过去的修订与我的 WC 在同一个分支上，但不是在不同的分支上......

**编辑：**

感谢 Rob 的回答，我现在可以将工作副本中的文件与位于合并分支上的过去修订进行比较。我想知道的最后一件事是是否可以手动将一些差异合并到我的工作副本中：

*   *当我在“显示日志”*窗口中右键单击给定文件的修订版并选择*“与工作副本比较”*时，差异查看器（或在我的情况下为 WinMerge）比较旧修订版的文件的本地副本（命名为在修订号之后，并出现在 Windows 临时文件夹中）到我的实际工作副本
*   当我右击同一个文件并选择“Diff with URL”时，正在比较的文件都是在 Windows 的临时文件夹中制作的本地副本，阻止我将一些差异直接合并到我的工作副本中......

有解决办法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-12T15:44:08.333

实现此目的的一种方法是在您右键单击工作副本中要比较的文件时按住 shift 键。选择 TortoiseSVN->Diff with URL。这会弹出一个对话框，允许您将完整的服务器路径名放入要比较的分支上的文件中。它还允许您指定修订版本。这带来了 TortoiseSVN 差异与 2 个文件和差异。

有关这方面的更多信息，您可以阅读此链接： [查看差异](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-diff.html)。这在“与另一个分支/标签的差异”部分中有专门讨论

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-13T20:26:35.663

@Rob 的答案当然有效，但需要您查找然后输入一个可能很长的 URL。您只需单击几下鼠标，无需输入即可完成相同的任务：

1.  在 Windows 资源管理器中打开目标文件的上下文菜单并选择`TortoiseSVN >> Revision Graph`.
2.  图表显示后，单击代表您的工作副本的节点。
3.  *control* +单击要比较的节点，该节点可能位于*任何*分支上。
4.  打开任一选定节点上的上下文菜单，然后选择`compare revisions`。

在插图中，修订版 22175 是我在一个分支上的工作副本。我选择了不同分支上的节点 18568 进行比较——两个节点都标有紫色方块。

![TortoiseSVN 修订图](../Images/b243556f17e746697f601b49661c780b.png)

**2013.02.14 更新：比较工作副本，而不仅仅是工作基础！**

Yannick，感谢您提醒我区分**工作副本**和**工作基础**。我之前的说明确实是将工作*基础*与任意节点进行比较。修改后的插图显示了如何将工作*副本*与任意节点进行比较。为此，请注意工具栏上最右侧的两个按钮。黑色圆圈的 WC 按钮显示并突出显示工作基础，在本例中为 22175。红色圆圈的 WC 按钮显示并突出显示工作副本作为标记为特殊的红色节点`Modified`. 一旦你实现了那个节点，你现在就有了一个修改过的工作副本，你可以随意触摸、抓取、折叠、旋转或破坏它！例如，您可以通过首先选择已修改然后选择工作基础（在本例中为 22175）并比较这些修订来查看您的工作副本修改。

最后说明：选择`Modified`节点时，顺序很重要！`Modified`先选择*然后*控制+选择要比较的节点。这使您`compare revisions`可以在上下文菜单上进行选择。如果你反其道而行之，你就`unified diff`只有一个选择。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-01-16T09:43:18.027

1.  在 Windows 文件资源管理器中右键单击该文件，然后单击 TortoiseSVN -> 显示日志。
2.  右键单击您需要比较的修订并选择“与工作副本比较”。

# jquery - 单击另一个div时如何更改div的背景图像？

> ID：14836149
> 
> 赞同：0
> 
> 时间：2013-02-12T15:40:20.437
> 
> 标签：jquery, css, click, background-image

我试图在按下另一个 div 时更改一个 div 的背景图像。我正在使用 jQuery 并发现这样做...

```
$('#input_id').click(function() {
  $('#div_id').css('background-image','url')
}); 
```

但是，我需要它做的不仅仅是改变一个 div 的背景图像，它还必须为其他几个设置动画。

我目前正在使用...

```
$('#input_id').click(function() {
$('#div1').animate({
    left: '0px'
}, 600);
$('#div2').animate({
    left: '-100%'
}, 1000);
$('#div3').animate({
    right: '-100px'
}, 200);
$('#div4').animate({
    top: '0px'
}, 600);
}); 
```

这工作正常，可以做我需要的一切，但是当我将它添加到列表中时......

```
$('#div5').css({
    'background-image', 'url(../images/backgrounds/background2.png)'); 
```

它完全停止工作。这是我的完整代码...

```
$('#input_id').click(function() {
$('#div1').animate({
    left: '0px'
}, 600);
$('#div2').animate({
    left: '-100%'
}, 1000);
$('#div3').animate({
    right: '-100px'
}, 200);
$('#div4').animate({
    top: '0px'
}, 600);
$('#div5').css({
    'background-image', 'url(../images/backgrounds/background2.png)');
}); 
```

我的第 5 部分的 CSS 背景图像代码是...

```
#div5 {
...
background-image:url(../images/backgrounds/background1.png);
...
} 
```

任何人都可以看到为什么这不起作用的任何原因吗？我是否做了明显错误的事情，或者在某处遗漏了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T15:41:33.320

有两件事...

```
$('#div5').css({
    'background-image': 'url(images/backgrounds/background2.png)'
}); 
```

首先，那段代码的末尾有一个语法错误（两个右括号）。

其次，这纯属猜测，但您的 CSS 文件可能位于 css（或样式）文件夹中。从那里引用图像文件夹是正确的`../images`，但不能从页面中运行的脚本中引用。（注意我删除了前导`../`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T15:43:24.763

你错过了什么`"});"`

```
 $('#input_id').click(function() {
    $('#div1').animate({
        left: '0px'
    }, 600);
    $('#div2').animate({
        left: '-100%'
    }, 1000);
    $('#div3').animate({
        right: '-100px'
    }, 200);
    $('#div4').animate({
        top: '0px'
    }, 600);
    $('#div5').css({
        'background-image', 'url(../../images/backgrounds/background2.png)');
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T15:43:55.437

我建议不要将实际的 css 放在 jQuery 中，因为这会变得很难维护。

而是使用 jQuery 添加一个类并在 css 文件中指定背景属性。

```
$('#div5').addClass("myclass");

.myclass {
    background-image: url(images/backgrounds/background2.png);
} 
```

然后，您可以根据需要使用 removeClass() 方法将其删除。

```
$('#div5').removeClass("myclass"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T15:43:14.003

您的

```
$('#div5').css({
    'background-image', 'url(../images/backgrounds/background2.png)'); 
```

包含一个{

```
$('#div5').css('background-image', 'url(../images/backgrounds/background2.png)'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T15:45:32.607

试试这个：

```
$('#div5').css('background-image', 'url(../images/backgrounds/background2.png)'); 
```

# android - 指定的孩子已经有一个父母你必须调用 removeview android textview table layout

> ID：14836150
> 
> 赞同：0
> 
> 时间：2013-02-12T15:40:19.747
> 
> 标签：android, textview, parent-child, android-tablelayout

hiii ...伙计们...我是android开发的新手..我遇到了这个异常，请帮帮我..“
指定的孩子已经有一个父母，你必须调用removeview”。
txtAmount.for 循环中的 android textview 表布局不输入 txtAmount 以显示文本..
它分别显示我的项目名称和评价我指定的 textview txtItemName 和 txtRate 但它没有在 for 循环中的 txtAmount 处显示数量文本.. 显示以下异常。 . "指定的孩子已经有一个父母，你必须调用 removeview "。

```
public class ConfirmOrder extends Activity {
    TextView txtLength;
    int length,rate,amount;
    String name;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
        setContentView(R.layout.confirmorder);
        Intent intent = getIntent();
         length=intent.getIntExtra("LENGTH", 0);
         rate=intent.getIntExtra("Rate", 0);
         amount=intent.getIntExtra("Amount", 0);
         name=intent.getStringExtra("Name");
        txtLength.setText(String.valueOf(amount));
         Log.d("length",""+length);
         Log.d("name",""+name);
         Log.d("Rate",""+rate);
         Log.d("Amount",""+amount);
        try
         {
        TableLayout tv=(TableLayout) findViewById(R.id.table);
                tv.removeAllViewsInLayout();
                int flag=1;
                for(int i=0;i<=10;i++)
            {
        TableRow tr=new TableRow(ConfirmOrder.this);
                 tr.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
                 if(flag==1)
                 {
                   TextView Name=new TextView(ConfirmOrder.this);
                   Name.setPadding(10, 0, 0, 0);
                   Name.setTextSize(20);
                   Name.setText("ItemName");
                   Name.setTextColor(Color.WHITE);
                   tr.addView(Name);
                   TextView Rate=new TextView(ConfirmOrder.this);
                   Rate.setPadding(10, 0, 0, 0);
                   Rate.setTextSize(20);
                   Rate.setText("Rate");
                   Rate.setTextColor(Color.WHITE);
                   tr.addView(Rate);
                   TextView Amount=new TextView(ConfirmOrder.this);
                   Amount.setPadding(10, 0, 0, 0);
                   Amount.setTextSize(20);
                   Amount.setText("Amount");
                   Amount.setTextColor(Color.WHITE);
                   tr.addView(Amount);
                   tv.addView(tr);

                   final View vline = new View(ConfirmOrder.this);
                   vline.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT, 2));
                   vline.setBackgroundColor(Color.GRAY);
                   tv.addView(vline);
                   flag=0;
                  }
                else
                 {
                   int l;
                   TextView[] txtItemName=new TextView[10];
                   TextView[] txtRate=new TextView[10];
                   TextView[] txtAmount=new TextView[10];
                   for( l=0; l<=10; l++)
                   {
                    txtItemName[l] = new TextView(this);
                    txtItemName[l].setTextSize(15);
                    txtItemName[l].setId(l);
                    txtItemName[l].setText(name);
                       tr.addView(txtItemName[l]);
                       tv.addView(tr);

                       txtRate[l] = new TextView(this);
                       txtRate[l].setTextSize(15);
                       txtRate[l].setId(l);
                       txtRate[l].setText(String.valueOf(rate));
                       tr.addView(txtRate[l]);
                       tv.addView(tr);

                       txtAmount[l] = new TextView(this);
                       txtAmount[l].setTextSize(15);
                       txtAmount[l].setId(l);
                     txtAmount[l].setText(String.valueOf(amount));
                       tr.addView(txtAmount[l]);
                      tv.addView(tr);

                   }                   
                   final View vline1 = new View(ConfirmOrder.this);
                   vline1.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT, 1));
                   vline1.setBackgroundColor(Color.WHITE);
                   tv.addView(vline1); 
               }

               }

         }
         catch(Exception e)
         {
                 Log.e("log_tag", "Error parsing data "+e.toString());
                System.out.println("ERROR : " + e.getMessage());
                Log.d("Message",""+e.getMessage());

         }

    }   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T15:50:13.157

从代码来看，这里应该发生异常......

```
tv.addView(tr); 
```

由于您再次将同一行添加到表布局中。任何视图只能添加到一个父级。如果要更改父级，则需要从当前父级中删除视图，然后根据需要添加到其他父级。

# rspec - Rails 请求规范不起作用 - noMethodError

> ID：14836151
> 
> 赞同：0
> 
> 时间：2013-02-12T15:40:21.733
> 
> 标签：rspec, railstutorial.org

有人可以告诉我为什么这很好用：

```
subject { page }
describe "for non-signed-in users" do
  describe "in the Microposts controller" do
    describe "submitting to the destroy action" do
      before { delete micropost_path(FactoryGirl.create(:micropost)) }
      specify { response.should redirect_to(signin_path) }
    end
  end
end 
```

但这会给出错误消息“nil:NilClass 的未定义方法‘destroy’”？：

```
subject { page }
describe "as wrong user" do
  let(:user) { FactoryGirl.create(:user) }
  let(:wrong_user) { FactoryGirl.create(:user, email: "wrong@example.com") }
  before { valid_signin user }
  describe "in the Microposts controller" do
    describe "submitting to the destroy action" do
      before { delete micropost_path(FactoryGirl.create(:micropost, user: wrong_user)) }
      specify { response.should redirect_to(root_path) }
    end
  end
end 
```

这是微博控制器：

```
class MicropostsController < ApplicationController
  before_filter :signed_in_user, only: [:create, :destroy]
  before_filter :correct_user,   only: :destroy

  def create
    @micropost = current_user.microposts.build(params[:micropost])
    if @micropost.save
      flash[:success] = "Micropost created!"
      redirect_to root_url
    else
      @feed_items = []
      render 'static_pages/home'
    end
  end

  def destroy
    @micropost.destroy
    redirect_to root_url
  end

  private

    def correct_user
      @micropost = current_user.microposts.find_by_id(params[:id])
    rescue
      redirect_to root_url # if @micropost.nil?
    end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T00:48:38.607

您期望第二个示例在`correct_user`. 我相当肯定没有引发异常，因此`destroy`在没有设置的情况下调用`@micropost`。

您可以将`find_by_id`（不会引发异常）更改为（会引发异常`find`）。或者重写when `@micropost`is重定向的方法`nil`。

# fft - 在处理一组正弦数据时如何使用采样频率概念？

> ID：14836155
> 
> 赞同：0
> 
> 时间：2013-02-12T15:40:42.533
> 
> 标签：fft, frequency, sampling, nyquist

所以首先我让自己习惯了 Matlab FFT，例如我会做以下事情：

```
 clc     
    fs = 4;    
    t = 0:1/fs:1-1/fs;     
    x1 = sin((2*pi)*t);     
    y1 = fft(x1,n);    

   FT_power1 = abs(y1(1:floor(n/2))).^2;     
   FT_phase1= (((angle(y1(1:floor(n/2))))) * 180/pi);     
   [c1,i1] = max(FT_power1);     
   phase(1) = FT_phase1(i1); 
```

而且我认为我对为什么使用奈奎斯特和采样频率参数有一个不错的理解。但是现在，我想对输出数组执行相同的过程（即来自我拥有的不同子​​程序的正弦曲线），这意味着我的输出数组有 2 列，第一列是时间向量，第二列是实际的正弦响应。现在，如何合并 fs 参数？我突然很困惑。如果您需要更多详细信息，请告诉我。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T18:45:29.107

如果我正确理解您的问题，您的新数组实际上是一个二维数组，第一个维度代表采样的时间，第二个维度代表正弦曲线的样本。

要通过 FFT 处理新数组，只需忽略时间维度，并仅使用样本维度（正弦数据样本）。

在这种情况下，奈奎斯特率仍然适用。您的正弦曲线必须以您希望通过 FFT 解析的最大频率的两倍（或更多）进行采样。

FFT 使用采样频率来正确缩放 FFT 输出的频率轴。

您可以在此处了解有关 Nyquist-Shannon 采样定理的所有信息：[采样定理](http://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem)

# android - 制作一个简短的 ListView（不滚动）对滚动尝试做出反应

> ID：14836158
> 
> 赞同：0
> 
> 时间：2013-02-12T15:40:46.320
> 
> 标签：android, android-listview

我有一个包含不同数量项目的 ListView。它可以滚动，也可以适合一个屏幕。当用户点击并拖动列表并进行过度滚动时，您将获得漂亮的过度滚动边缘发光效果。

如果列表没有滚动，因为它只有很少的元素，但是您点击并拖动其中一个项目，您仍然会获得边缘发光效果。这很好，也是我想要的。

问题是，如果您单击最后一项*下方并拖动，则没有任何反应。*在这种情况下，我也希望它“尝试滚动”。如果没有视觉反馈会令人困惑，并且列表似乎冻结了。

```
+--------------------------+
| Item 1           (x)     |     Tap and drag here works.  The list
+--------------------------+     doesn't move, but the user gets a
| Item 2                   |     visual overscroll indicator on the
+--------------------------+     top or the bottom.
| Item 3                   |
+--------------------------+
|                          |
|                  (x)     |     Tap and drag here does nothing.
|                          |
|                          |
|                          |
|                          |
|                          |
+--------------------------+ 
```

如何让整个 ListView 对滚动尝试做出反应？

我确保它涵盖了所有可用空间，而不仅仅是物品所需的空间（设置`android:layout_height="fill_parent"`并尝试了不同的 BG 颜色以确保）。启动滚动的代码在哪里？如果我必须重写某些东西很好，因为我已经在使用我自己的 ListView 子类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T22:06:33.510

发现了。ListView 子类中的以下内容可以解决问题。我在 Android 4.2.1 上对其进行了测试，但它应该可以在任何 4.x 上运行。

**免责声明：此代码依赖于 ListView 的实现细节，并使用反射来修改私有变量。我不能夸大这是多么邪恶。您不应该在生产代码中使用它！**

我把它作为概念证明并满足我的好奇心。如果您想使用这样的代码（不幸的是，有时需要获得某些效果），请在其周围放置版本保护，如下所示。仅在您尝试过并检查过源代码的版本上运行。在其他情况下，您应该只使用调用默认行为，例如`return super.onTouchEvent(ev)`.

此代码允许您（未成功尝试）通过最后一项下方的空白部分滚动短列表。单击并拖动空白区域，您应该会看到过度滚动发光。如果您已经实现了类似过度滚动橡皮筋效果的 iPhone，这将特别酷。

它是如何工作的？看看[AbsListView.OnTouchEvent](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/AbsListView.java/#3343)。在第 3397 行，motionPosition 是当前选中的项目索引。如果是 -1（没有项目），`if`后面几行是假的，`mTouchMode`不会被设置。在这种情况下，我将 ListView 手动置于滚动模式。

```
static final int TOUCH_MODE_DOWN = 0;
static final int TOUCH_MODE_SCROLL = 3;
static final int TOUCH_MODE_FLING = 4;

@Override
public boolean onTouchEvent(MotionEvent ev) {
    if (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN ||
        Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN_MR1) {
        final int x = (int) ev.getX();
        final int y = (int) ev.getY();
        int motionPosition = pointToPosition(x, y);
        int action = (ev.getAction() & MotionEvent.ACTION_MASK);

        if (action == MotionEvent.ACTION_DOWN) {
            if (motionPosition == -1) {
                setFieldInt("mActivePointerId", ev.getPointerId(0));
                if (!getAdapterViewFieldBool("mDataChanged")) {
                    if ((getFieldInt("mTouchMode") != TOUCH_MODE_FLING)) {
                        setFieldInt("mTouchMode", TOUCH_MODE_DOWN);
                    }
                }

                setFieldInt("mMotionViewOriginalTop", 0);
                setFieldInt("mMotionX", x);
                setFieldInt("mMotionY", y);
                setFieldInt("mMotionPosition", motionPosition);
                setFieldInt("mLastY", Integer.MIN_VALUE);
            }
        }
    }
    return super.onTouchEvent(ev);
}

private void setFieldInt(String fieldName, int value) {
    try {
        Field field = AbsListView.class.getDeclaredField(fieldName);
        field.setAccessible(true);
        field.setInt(this, value);
    }
    catch (NoSuchFieldException e) { Log.v(TAG, "exception", e); }
    catch (IllegalAccessException e) { Log.v(TAG, "exception", e); }
}

private int getFieldInt(String fieldName) {
    try {
        Field field = AbsListView.class.getDeclaredField(fieldName);
        field.setAccessible(true);
        return field.getInt(this);
    }
    catch (NoSuchFieldException e) { Log.v(TAG, "exception", e); }
    catch (IllegalAccessException e) { Log.v(TAG, "exception", e); }
    return 0;
}

private boolean getAdapterViewFieldBool(String fieldName) {
    try {
        Field field = AdapterView.class.getDeclaredField(fieldName);
        field.setAccessible(true);
        return field.getBoolean(this);
    }
    catch (NoSuchFieldException e) { Log.v(TAG, "exception", e); }
    catch (IllegalAccessException e) { Log.v(TAG, "exception", e); }
    return false;
} 
```

# c++ - 双调度和访客模式

> ID：14836159
> 
> 赞同：2
> 
> 时间：2013-02-12T15:40:49.423
> 
> 标签：c++

在学习复合模式时，我遇到了双重调度和访问者模式的概念。我已经在维基百科上检查了双重调度（[http://en.wikipedia.org/wiki/Double_dispatch](http://en.wikipedia.org/wiki/Double_dispatch)）并遵循了这个例子。我已经了解 C++ 中的虚函数是动态调度的，函数重载是静态完成的，但我的问题是解决方案。它指出该问题可以通过使用访客模式进行模拟双重调度来解决。现在我已经检查了这里的几个示例以及 GoF 书籍中访问者模式的示例，但我仍然不清楚如何应用该解决方案。当然，我错过了访问者模式的要点。

请有人可以通过完成维基百科示例来解释解决方案吗？先感谢您。

# c# - .NET 中的内置缓存接口

> ID：14836160
> 
> 赞同：3
> 
> 时间：2013-02-12T15:40:53.173
> 
> 标签：c#, .net, caching, interface

在阅读 AppFabric Caching 时，我在某处读到 .NET 中有一个内置的缓存接口。现在我似乎找不到它。需要接口来将交互限制为 Get 和 Put 调用。

# xcode - xcode Instruments - 找不到泄漏

> ID：14836161
> 
> 赞同：0
> 
> 时间：2013-02-12T15:40:58.893
> 
> 标签：xcode, instruments, memory-leaks

我遇到了一个真正让我头疼的问题。

所以基本上我有一个 MainMenuScene，它反过来创建了一个测试层。该层非常简单，因为它只创建一个乐谱标签和一个添加到菜单的按钮。当按下此按钮时，MainMenuScene 将被空白场景替换，然后再次加载 MainMenuScene。

到目前为止，一切都很好。然而问题是，当我每次重新加载场景时在仪器中进行堆放时，堆增加了大约 20kb。当我在扩展视图中深入挖掘时，似乎 testLayer 中的 sprite 和字体没有被释放，但是 layer 中的 dealloc 方法正在被调用。

除了核心 Cocos 文件之外，我还为我的文件添加了 ARC 支持。这有什么关系吗？

这是测试层：

```
@implementation TestLayer

-(id)init
{
    self = [super initWithColor:ccc4(2,2,2,210)];
    if (self != nil)
    {
        // ask director the the window size
    CGSize s = [[CCDirector sharedDirector] winSize];

        self.isTouchEnabled = YES;

        NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
        formatter.numberStyle = NSNumberFormatterDecimalStyle;

        NSNumber * n = [NSNumber numberWithInt:[SDCloudUserDefaults integerForKey:@"highscore"]];

        NSString *string = [formatter stringFromNumber:n];

        //score
        CCLabelBMFont * scoreLabel = [CCLabelBMFont labelWithString:string fntFile:@"scoreFont.fnt" width:s.width alignment:kCCTextAlignmentCenter];
        scoreLabel.position =  ccp( POS_X(443), POS_Y(877) );
        [self addChild:scoreLabel z:90];

        //PLAY BUTTON
       CCMenuItemSprite *playButton = [CCMenuItemSprite itemFromNormalSprite:[CCSprite spriteWithFile:@"play_up.png"]
                                                               selectedSprite:[CCSprite spriteWithFile:@"play_down.png"]
                                                                       target:self
                                                                     selector:@selector(Transition:)];

        playButton.position = ccp( POS_X(380) , POS_Y(177));

        menu = [CCMenu menuWithItems: playButton, nil];
        menu.position = ccp(0, 0);
        [self addChild: menu];

       }
    return self;
}

-(void) Transition:(ccTime) dt
{
    [self unschedule:@selector(Transition:)];
    [[SceneManager sharedSceneManager]RunSceneWithID:SCENE_LOADING:eCCTransitionCrossFade:1.0f];

}

- (void) dealloc
{
    NSLog(@"%s",__FUNCTION__);
}
@end 
```

我真的看不出这有什么问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:57:25.213

对，我在一个 unARCed 项目上做了同样的测试，对 [super dealloc] 等的所有正确调用都正确，并且得到了完全相同的行为。

然而，经过仔细检查，我仍然不确定我是否有泄漏或者我没有正确解释结果。

因此，我将程序置于初始状态并进行了快照。然后我按下 ui 按钮，使场景被替换然后重新加载。我回到初始状态并拍摄另一个堆，并注意到堆增长了大约 20kb 左右。当我再次按下 ui 按钮时，前一个 heapshot 回到零字节。这样做几次后，前一个堆总是回到零字节。

因为在 cocos2d 中，每次替换场景时，附加到该场景的所有内容都会被释放，当您回到它时，所有内容都会重新分配。所以我认为总会有一个堆增长，因为增长是场景的大小，该层作为一个孩子。这有意义吗？

我还注意到，每次我这样做时，统计数据中的#Living 列都没有增加，这是一个好兆头，对吧？

# php - Drupal 7 视图 $title 变量

> ID：14836163
> 
> 赞同：1
> 
> 时间：2013-02-12T15:41:03.527
> 
> 标签：php, view, drupal-7, template-engine

我在 Drupal 7 中的博客页面上有一个视图，我使用“.tpl.php”或模板文件覆盖该页面，以便我可以使用自己的自定义 HTML 并添加标题。

通常，可以在模板文件中使用`$title`或访问视图的标题，`$block->subject`但这在我的视图模板文件中不起作用。

使用`drupal_get_title()`简单地显示“博客”，因为页面本身是一个页面模板，但我需要使用 PHP 动态插入到页面模板文件中的块视图的标题。

奇怪的是，标题将与数据库查询的结果（也就是字段）一起显示在视图预览中。

那么，如何访问模板 PHP 文件中通常称为 $title 的变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:41:03.527

首先，在视图设置页面上，进入“其他”部分下的“主题：信息”。在那里，您可以找到可用于覆盖视图输出的文件名列表。

因此，如果您的视图被称为“测试视图”，那么您应该在文件夹中创建一个名为`views-view--test-view.tpl.php`的`your_theme/templates/views/`文件来覆盖视图的显示设置。

在该文件中，输入以下内容：

```
<?php if($view->human_name) print "<h2>" . $view->human_name . "</h2>"; ?> 
```

然后在“主题：信息”下单击“重新扫描模板文件”按钮，标题现在应该显示在您网站上显示该视图的任何位置。

如果该变量出现空白，您可以通过将以下代码放入该文件中来获得要显示的变量的猜测列表：

```
<?php
?>
<div>
    <?php $list = array_keys(get_defined_vars()); 
    foreach($list as $key => $value)
        print "$" . $value . ", ";
    die();

    ?>
</div> 
```

这些变量中的每一个都可能是一个对象或数组，因此您可能必须打印它们的内容`print_r($variable)`或`var_dump($variable)`了解它们内部的内容。

# mysql - 如何授予特定查询的权限

> ID：14836164
> 
> 赞同：1
> 
> 时间：2013-02-12T15:41:04.213
> 
> 标签：mysql, debugging, permissions

我需要我的 db 用户（在整个应用程序中使用，并且**没有 root 权限**）能够运行`SHOW PROCESSLIST`
我如何在不给他所有 root 权限的情况下实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:44:48.413

如果用户需要查看所有进程，则需要授予用户`PROCESS`权限，否则我相信他们应该能够发布`SHOW PROCESSLIST`和查看自己的。

请参阅[http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_process](http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_process)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:59:58.253

You can use `GRANT PROCESS ON *.* TO 'dbuser'@'%'` this will give the dbuser to do show processlist permission.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T15:54:04.757

您可以通过这种方式授予权限：

```
mysql> GRANT FILE, SELECT, SHOW VIEW, LOCK TABLES, RELOAD, SHOW PROCESSLIST, REPLICATION CLIENT ON
*.* TO 'backup_user'@'localhost' IDENTIFIED BY 'yourPassWord'; 
```

如需更多了解，您可以查看：[http ://dev.mysql.com/doc/refman/5.1/en/grant.html](http://dev.mysql.com/doc/refman/5.1/en/grant.html)

# c - c c++中的符号模拟

> ID：14836167
> 
> 赞同：2
> 
> 时间：2013-02-12T15:41:14.143
> 
> 标签：c, loops, simulation, unroll

我想知道我是否可以看到 C 程序的循环展开形式。例如，我有以下 for 循环

```
// The following code mimics functionality of a logic circuit whose
//inputs are a,b,c and d
//output f
//At every for loop iteration, fresh values of a,b,c and d are input
//to the code whereas k value is used from the previous iteration.

    bool k = 0;
    bool a,b,c,d;
    bool g,h,n,j,f;

    for(i = 1; i < 100; i++)
    {
    h = !(a | b);  //nor gate
    g =  (b & c);  //and gate
    n = !(c & d);  //nand gate
    f = (k==0) ? h : g;  //mux
    j = n ^ f;    //xor gate
    k = j;
    } 
```

问题是“是否有可能以可读格式查看该程序的循环展开形式”。我有兴趣了解 gcc 编译器如何表达 h99、g99、n99、f99、j99 和 k99（第 99 次循环迭代中的 h、g、n、f、j 和 k 的值）是否可以这样做？或者应该怎么做才能看到从输入 a99、b99、c99、d99 到 a1、b1、c1 和 d1 的 h99、g99、n99、f99、j99 和 k99 的表达式？

简而言之，我想在每次迭代“i”时进行符号模拟，即用输入 ai、bi、ci、di 表示输出 hi、gi、ni、fi、ji 和 ki，直到 a1、b1、c1 和d1。

请让我知道，如果你有任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-09T22:22:33.210

> 我有兴趣了解 gcc 编译器如何表达 h99、g99、n99、f99、j99 和 k99（第 99 次循环迭代中的 h、g、n、f、j 和 k 的值）是否可以这样做？或者应该怎么做才能看到从输入 a99、b99、c99、d99 到 a1、b1、c1 和 d1 的 h99、g99、n99、f99、j99 和 k99 的表达式？

从编译器的角度来看，您无法做任何事情来具体了解在第**99**次迭代中要做什么。您可以做的最好的事情是确切地了解如何处理它是双重的。**首先**，如果您可以阅读汇编程序，则可以使用该`gcc -S`选项将程序编译为汇编程序。您可能还希望包含以`-masm=intel`intel 格式而不是 ATT 格式输出汇编程序。IE：

```
gcc -S -o prog.asm prog.c -masm=intel 
```

**其次**，对于值比较，您需要在**第 99**次迭代中转储输入和输出值，并将输入/输出与您期望在纸上发生的情况进行比较。您可以编写一个小函数来提供类似于以下格式的输出：

```
void dumpIO (bool a, bool b, bool c, bool d, bool g, bool h, bool n, bool j, bool f)
{
    printf ("%-20s : %d = !(%d | %d);\n", "h = !(a | b)", h, a, b);
    printf ("%-20s : %d = (%d & %d);\n", "g =  (b & c)", g, b, c);
    printf ("%-20s : %d = !(%d & %d);\n", "n = !(c & d)", n, c, d);
    printf ("%-20s : %d = (%d == 0) ? %d : %d;\n", "f = (k==0) ? h : g", f, k, h, g);
    printf ("%-20s : %d = %d ^ %d;\n", "j = n ^ f", j, n, f);
    printf ("%-20s : %d = %d;\n", "k = j", k, j);
}

bool k = 0;
bool a,b,c,d;
bool g,h,n,j,f;

for(i = 1; i < 100; i++)
{
    h = !(a | b);  //nor gate
    g =  (b & c);  //and gate
    n = !(c & d);  //nand gate
    f = (k==0) ? h : g;  //mux
    j = n ^ f;    //xor gate
    k = j;
    if (i == 99) dumpIO(a, b, c, d, g, h, n, j, f);
} 
```

**示例输出：**

```
h = !(a | b)        :  0 = !(0 | 1);
g =  (b & c)        :  1 = (1 & 1);
n = !(c & d)        :  1 = !(1 & 0);
f = (k==0) ? h : g  :  0 = (1 == 0) ? 0 : 1;
j = n ^ f           :  1 = 1 ^ 0;
k = j               :  1 = 1; 
```

最**令人困惑的问题**是您期望在迭代之间看到什么不同`0-98`？循环中的任何内容都不依赖于循环迭代变量`i`，因此它只是将**相同的东西打印 100 次**。

我希望这可以为您提供一些您正在寻找的东西。就目前而言，您期望做什么还不太清楚`unrolling`。查看编译器如何处理您的代码然后验证输入/输出是您能做的最好的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-09T21:17:03.757

您应该考虑在正式推理工具中编写循环的递归版本，例如 ACL2（搜索 ACL2 以下载它，在 tryacl2.org 上还有一个原始交互式版本）。然后要求定理证明者通过要求它证明函数的调用等于未知数和 :expand 提示来为您展开循环。类似于以下内容：

```
(defthm unroll-it
  (equal (my-fun 1 nil nil nil nil nil nil nil nil nil)
         xxx)
  :hints (("Goal" :expand (...some term that you need expanded)))) 
```

您可能需要 100 个展开提示，因为默认情况下 ACL2 不会打开递归调用。无论如何，如果你真的开始走这条路，你可以联系 acl2-help 列表。有关 ACL2 声誉的声明，请参见 wikipedia。

# delphi - 德尔福 XE2 和 TeeChart 9

> ID：14836169
> 
> 赞同：-1
> 
> 时间：2013-02-12T15:41:17.193
> 
> 标签：delphi, delphi-xe2, teechart

我下载 TeeChart Pro v2012 评估版，我正在使用 Delphi XE2。我运行我在产品中找到的演示 exe，并尝试重现有关甘特图的代码，更准确地说是拖放甘特图元素的部分。我收到以下错误：“TGanttTool 未声明”我无法在代码中的任何位置找到此对象，知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T09:17:10.373

在这里对我来说似乎工作正常。最大限度地简化鼠标拖动示例，在运行时创建所有内容，这里是具有甘特拖动示例的最少代码。对你起作用吗？

```
uses VCLTee.Chart, VCLTee.GanttCh, VCLTee.TeeGanttTool;

var Chart1 : TChart;

procedure TForm1.FormCreate(Sender: TObject);
begin
  Chart1:=TChart.Create(Self);
  Chart1.Parent:=Self;
  Chart1.Align:=alClient;

  Chart1.View3D:=False;
  Chart1.Zoom.Allow:=False;

  with Chart1.AddSeries(TGanttSeries) as TGanttSeries do
  begin
    FillSampleValues(5);
    Marks.Visible:=True;
  end;

  (Chart1.Tools.Add(TGanttTool) as TGanttTool).Series:=Chart1[0];
end; 
```

也许问题只是在您的 IDE 中的路径中。请检查库/搜索路径中是否存在错误的引用。并检查正确的（参考 TeeChart）是否在列表的顶部。

# c# - Newtonsoft Json 反序列化、JProperty 和 JObjects？

> ID：14836171
> 
> 赞同：1
> 
> 时间：2013-02-12T15:41:22.990
> 
> 标签：c#, .net, json.net

我试图通过简单地反序列化 json-text/string：

```
var jObject = JsonConvert.DeserializeObject<JObject>(myjsonstring); 
```

问题是我稍后需要遍历 jObject.. 因为稍后我将使用特殊格式将其“序列化”回 XML。但是这种反序列化为json中的每个“节点”提供了一个JProperty和一个JObject ..有没有办法告诉序列化程序我只关注JProperties或JObjects。

==============

**编辑**

多解释一下..问题是，如果我稍后会在 VS-watch 中键入以下内容：

```
jObject 
```

它会给出结果：

```
{ "myjson":{ "mytest":"myvalue" } } 
```

和

```
jObject.Children().First() 
```

手表会给我以下结果/响应：

```
{"myjson":{ "mytest":"myvalue" } } 
```

但我认为更合乎逻辑的结果/响应是：

```
{ "mytest":"myvalue" } 
```

由于那是“myjson”属性的实际子对象..所以问题是..我如何获得我真正想要的行为？还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-05T17:29:36.797

要访问 JObject 中的值，我使用 JToken ：

```
JToken child = jObject["myjson"]; 
```

如果要检索字符串中的值，可以序列化 JToken

```
string childInString = JsonConvert.SerializeObject(child); 
```

希望有所帮助。

# powershell - Powershell：如何将从foreach返回的结果分配给变量

> ID：14836181
> 
> 赞同：1
> 
> 时间：2013-02-12T15:41:49.427
> 
> 标签：powershell, variable-assignment

我正在使用 Windows 2003 Server x86、Powershell 1.0 并遇到以下令人头疼的问题。当我尝试执行下面的脚本时，出现错误：

```
Error "=" operator: System error. (Fehler beim "="-Operator: Systemfehler.)
+ $data =  <<<< Get-Content $log | % { 
```

这是这个脚本：

```
$log = "C:\log file.txt"
$linePrefix = "PROCESS THIS LINE"
$trimStart = 25 #chars to ignore in the beginning
$started = 0

$data = Get-Content $log | % { 
    if ($_.length -ge $trimstart) { 
        $linedata = $_.substring($trimstart);
        $timesline = $linedata.startswith($lineprefix); 
        if ($started -eq 0 -and $timesline) { 
            $started = 1; 
        }
        if ($started) { 
            if ($timesline) { 
                $line = $linedata.substring($lineprefix.length).trimstart();
                if ($line.contains(": ")) {
                    write-output $line 
                } 
            } else { 
                break; 
            }
        }
    }
} 
```

但是，如果我在没有`$data =`分配的情况下执行它，它会完美运行并返回我的预期值。我也尝试过以下陈述

```
$data = (...)
$data = $(...) 
```

并用表达式声明一个函数但没有成功。

你能告诉我为什么会发生吗？

**更新**：我尝试在分配符号之前和之后删除空格并得到类似的错误，但现在 powershell 不喜欢`$data=G`字符串

```
Error "=" operator: System error (Fehler beim "="-Operator: Systemfehler.)
At C:\kosmo\scripts\ps\test.ps1:60 Symbol:7
+ $data=G <<<< et-Content $log | % { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:15:48.057

我已将您的代码转换为将返回 String 对象的函数。因此，您可以按如下方式运行它：

```
$data = Parse-LogFile 
```

您需要先将该函数导入您的 shell，只需复制并粘贴即可。

```
Function Parse-LogFile
{
   $log = gc "C:\log file.txt"
   $linePrefix = "PROCESS THIS LINE"
   $trimStart = 25 #chars to ignore in the beginning
   $started = 0
   $ReturnText = New-Object System.Text.StringBuilder
   foreach ( $line in $log )
   {
      if ($_.length -ge $trimstart)
      {
         $linedata = $_.substring($trimstart);
         $timesline = $linedata.startswith($lineprefix);

         if ($started -eq 0 -and $timesline) 
         { 
            $started = 1; 
         }

         if ($started) 
         { 
            if ($timesline)
            {
               $line = $linedata.substring($lineprefix.length).trimstart();
               if ($line.contains(": "))
               {
                  $ReturnText.Append($line)
                  $ReturnText.AppendLine()
               }
            }
            else
            {
               break;
            }
         }
      }
   }

   Retrun $ReturnText.ToString()
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:24:57.310

尽管我无法在我的机器上重现您的问题，但我认为该问题可能与您`break`在分配期间在管道中的使用有关。作为第一个测试，如果您删除`break`，它会改变吗？

假设这确实是问题所在，您可以稍微重构以避免直接进行分配。`$data`相反，您可以从循环本身中构建您的变量。

```
$log = ".\logfile.log"
$linePrefix = "PROCESS THIS LINE"
$trimStart = 25 #chars to ignore in the beginning
$started = 0
$data = @()  # initialize blank data array

Get-Content $log | % { 
    if ($_.length -ge $trimstart) { 
        $linedata = $_.substring($trimstart);
        $timesline = $linedata.startswith($lineprefix); 
        if ($started -eq 0 -and $timesline) { 
            $started = 1; 
        }
        if ($started) { 
            if ($timesline) { 
                $line = $linedata.substring($lineprefix.length).trimstart();
                if ($line.contains(": ")) {
                    # add to your result here
                    $data += $line 
                } 
            } else { 
                break; 
            }
        }
    }
} 
```

现在`$data`包含你想要的。这可能不是性能最好的代码，具体取决于您期望有多少结果，但它可能会给您一个开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T10:32:55.730

感谢大家的提示！可惜，但没有任何建议确实解决了我的问题。最有帮助的是 latkin 关于中断行为的提示。经过一番[阅读](https://stackoverflow.com/questions/7760013/why-does-continue-behave-like-break-in-a-foreach-object)，我发现，在 Foreach-Object cmdlet（由 % 别名）中，break 或 continue 语句会停止整个脚本

```
function getFilteredResult {

    1..50 | % { 
        if ($_ -le 20) { 
            if (($_ % 2) -eq 0) {
                write-output $_;
            }
        } else {
            break; #terminates whole script, you don't even get "after got result"
            #continue; #save result as break
        }
    }   
}

Write-Host "before getting result"

$result = getFilteredResult

$result | % {$i=0}{ ++$i; Write-Host "$i) $_" }

Write-Host "after got result" 
```

输出仅显示`before getting result`. 从那里我得出的结论是，在 Powershell 1.0 中没有办法做我想做的事！所以我找到[了一种](http://blogs.technet.com/b/danstolts/archive/2011/03/07/how-to-install-powershell-on-windows-server-2003-and-enable-remote-powershell-management-all-servers-should-have-this-done.aspx)在我的旧 2003 服务器上安装 Powershell 2.0 的方法（[提示](http://geekzguru.wordpress.com/2008/02/16/howto-uninstall-powershell-10/)如何卸载 Powershell 1.0；顺便说一句，我的 Windows 更新名为 KB926140-v5）。

好的，错误消失了。但是我还是没有想要的结果？！在我的旅程结束时，我发现了非常[有用的帖子](https://stackoverflow.com/a/9766814/1581272)并在下面编写了脚本

```
function getFilteredResult {
    Try {
        1..50 | % { 
            if ($_ -le 20) { 
                if (($_ % 2) -eq 0) {
                    write-output $_;
                }
            } else {
                #break; #terminates whole script, you don't even get "after got result"
                #continue; #terminates whole script, you don't even get "after got result"
                throw "terminated pipeline!"
            }
        }   
    } Catch {
        #ignore terminated pipeline exception
    }
}

Write-Host "before getting result"

$result = getFilteredResult

$result | % {$i=0}{ ++$i; Write-Host "$i) $_" }

Write-Host "after got result" 
```

并得到了答案：

```
before getting result
1) 2
2) 4
3) 6
4) 8
5) 10
6) 12
7) 14
8) 16
9) 18
10) 20
after got result 
```

*解释* 如果我使用`foreach`了语句，我可以使用 break 来估计行为，但是我正在处理大型日志文件，foreach-statement 将整个文件读入内存，而 ForEach-Object cmdlet 则逐行处理。我不确定 Get-Content cmdlet，也许它也会读取整个文件以返回它，但我已经写下了我自己的 cmdlet Get-Content-Reversed 从文件末尾读取行，这就是为什么我很漂亮当然不是

# nhibernate - NHibernate 版本控制 - 调用 ISession.Save 后出现异常

> ID：14836183
> 
> 赞同：1
> 
> 时间：2013-02-12T15:41:51.920
> 
> 标签：nhibernate, nhibernate-mapping, mapping-by-code

在发布这个问题之前，我已经看过很多关于 NH Versioning 的示例，所有这些都告诉我使用下面的代码；我可以使用 MappingByCode 拥有一个版本化实体：

```
Version(e => e.MyVersion, vm => {
     vm.Generated(VersionGeneration.Always);
     vm.UnsavedValue(0);
}); 
```

我希望分配 MyVersion 应该由 SQL Server 完成。所以当我调用 ISession.Save 或 ISession.SaveOrUpdate; NProf 显示生成的 sql 不包含传递给 Insert 语句的 MyVersion 参数（如预期的那样），但查询执行失败，因为 SQL Server 没有生成它；结果是`cannot insert null value into MyVersion column...`错误。

我对 VersionGeneration.Always 的期望是正确的吗？那么怎么了？

我正在使用 NHibernate 3.3 / SQL Server 2012

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T15:54:35.223

VersionGeneration.Always 意味着 NHibernate 应该期望数据库系统在 INSERT 和 UPDATE 上生成版本号。

但是您还需要告诉 SQL Server 它应该生成数字......例如参见[http://msdn.microsoft.com/en-us/library/ms182776.aspx](http://msdn.microsoft.com/en-us/library/ms182776.aspx)。

# uiwebview - Xcode 4.5 判断 uiwebview 是否可以向上滚动

> ID：14836184
> 
> 赞同：1
> 
> 时间：2013-02-12T15:41:53.667
> 
> 标签：uiwebview, uiscrollview, uikit

你们有什么想法每次某个uiwebview一直在页面上时如何调用一个方法，即。所以它不能向上滚动？如果能够以智能的方式刷新页面，这个功能会很棒。

/埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:46:26.353

你可以使用这样的东西：

在 .h 中，您的代码应类似于：

`@interface iSafeViewController : UIViewController <UIWebViewDelegate, UIScrollViewDelegate>`

然后在.m

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    //The webview is is scrolling
    float scrollViewHeight = scrollView.frame.size.height;
    float scrollContentSizeHeight = scrollView.contentSize.height;
    float scrollOffset = scrollView.contentOffset.y;

    if (scrollOffset <= 1)
    {
        // then we are at the top

    }
    else if (scrollOffset + scrollViewHeight >= scrollContentSizeHeight - 1)
    {
        // then we are at the end

    }
    else
    {
        //We are somewhere in the middle
    }
} 
```

您需要像这样设置 webView 的 scrollView 委托：

`[webView.scrollView setDelegate:self];`

如果这不起作用，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:46:50.693

`UIWebView`有财产`scrollView`。这是`UIScrollView`为委托设置您想要的任何对象：

```
@property(nonatomic, assign) id<UIScrollViewDelegate> delegate 
```

现在您将获得所有委托回调：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
- (void)scrollViewDidScrollToTop:(UIScrollView *)scrollView 
```

# c++ - 从文件中读取字符串并将其不同部分保存在 C++ 中的不同变量中

> ID：14836190
> 
> 赞同：0
> 
> 时间：2013-02-12T15:42:11.407
> 
> 标签：c++, string, file

所以我有这个包含一些字符串和数字的文件，它来自西班牙足球联赛：

```
Malaga 1 Levante 1
Malaga 1 Osasuna 1
Osasuna 1 Deportivo 1
Osasuna 1 Madrid 2
Osasuna 1 Levante 1
Osasuna 1 Malaga 1
# 
```

好的，我要做的就是阅读这篇文章，然后将不同的球队（马拉加、莱万特、奥萨苏纳、拉科鲁尼亚和马德里）保存在 5 个不同的变量中，我还必须将他们为每支球队和目标所做的目标保存在一个变量中他们为每个团队收到了另一个。这是我的代码：

```
#include<iostream>
#include<fstream>
#include<string>
using namespace std;
const char FI='#';
const int MAX_EQUIPS=20;

struct Equip {
   string nomEquip;
   int golsf;
   int golsc;
   int punts;
};

typedef Equip TaulaEquip[MAX_EQUIPS];

struct EquipLliga {
    TaulaEquip t;
    int n;
};
int cercaEquip(EquipLliga l, string equip) {
// Pre: --
// Post: si equip no hi es a d.t, retorna -1
//       altrament retorna posicio de l'equip de nom equip a d.t
   int ret=l.n-1;
   bool trobat= false;
   while (ret>=0 and not trobat) {
      if (l.t[ret].nomEquip.compare(equip)==0) trobat= true;
      else ret--;
   }
   return ret;
}
void llegir(ifstream & f) {

    string string1;
    f.open("Lliga.txt");
    char output;
    if (f.is_open()) {
        while (!f.eof()) {
            getline(f,string1);
            cout << string1 << endl;
        }
    }
    f.close();
}
void actualitzacioGols(ifstream & f, EquipLliga & e) {
// Pre: f obert
// Post: ha llegit totes les dades de f, incorporat altes i traspasos a al, i els
//       ingresos i despeses dels equips per altes, baixes i traspasos a d
    char tipus;

string equipA, equipB;
int golsf=0, golsc=0, cerca;
e.n=0;
f >> tipus;

while (tipus!=FI) {  // per cada equip
    cerca=cercaEquip(e,equipA);
    if (cerca=-1)
    {
        e[n].e.nomEquip=equipA;
        e[n].e.golsf=l[n].e.golsf+golsA;
        e[n].e.golsf=l[n].e.golsf+golsB;
    }
    else
    {
        e[cerca].e.golsf=l[cerca].e.golsf+golsA;
        e[cerca].e.golsc=l[cerca].e.golsc+golsB;
    }
    lliga.n++;
    cerca=cercaEquip(e,equipB);
    if (cerca=-1)
    {
        e[n].e.nomEquip=equipB;
        e[n].e.golsf=l[n].e.golsf+golsA;
        e[n].e.golsf=l[n].e.golsf+golsB;
    }
    else
    {
        e[cerca].e.golsf=l[cerca].e.golsf+golsA;
        e[cerca].e.golsc=l[cerca].e.golsc+golsB;
    }

}
int main() {

    } 
```

我遇到了函数“void actualitzacioGols(ifstream & f, EquipLliga & e)”的问题。我不知道如何对其进行编码，以便读取到第一个空格，然后将其保存到第一个团队变量“equipA”，然后将第一个数字保存到第一个目标变量“golsf”，与另外两个。

任何想法或有用的提示来解决这个问题？我对 C++ 有点陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:28:48.690

我建议你看看这篇文章，解释[如何使用 delim 分割字符串](https://stackoverflow.com/a/236803/1594913)

在您的情况下，您可能希望使用空格来拆分字符串。由于您具有固定格式，因此如果您确定文件将始终具有相同的格式，则可以通过将向量的元素作为数组访问并使用硬编码索引来检索所需的信息（团队和目标）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:42:30.083

我会使用[Find](http://www.cplusplus.com/reference/string/string/find/ "寻找")和[Substr](http://www.cplusplus.com/reference/string/string/substr/)。

您可以找到第一个空格，然后获取从 0 到该空格的子字符串。然后得到空格后+1的数字，然后从字符串的其余部分中创建一个新字符串，并对另一个名称执行相同的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-04T02:45:42.977

这是您问题的完整解决方案。希望能帮助到你！

```
#include <iostream>
#include <iomanip>
#include <string>
#include <map>
#include <algorithm>

using namespace std;
#define WIDTH 10

int main()
{
    string team1, team2; 
    int   team1goals, team2goals;

     // Data structure for storing Team name and scores
     map<string, pair<int, int>> scores;

    while (cin >> team1 >> team1goals >> team2 >> team2goals ) {
          scores[team1].first  +=   team1goals; 
          scores[team2].second  +=  team1goals;

          scores[team2].first += team2goals;
          scores[team1].second += team2goals;
    }

    cout << endl << setw (WIDTH) << "Team Name"  << setw(WIDTH) << "given" << setw(WIDTH) << "received";
    for_each( begin(scores), end(scores), [&]( pair<string, pair<int,int>> i ) {
        cout << endl << setw(WIDTH) << i.first  << setw(WIDTH) << i.second.first << setw(WIDTH) << i.second.first;
    });

    return 0;
} 
```

这是结果

```
/*
input file: inputFile.txt
-------------------------------
Malaga 1 Levante 1
Malaga 1 Osasuna 1
Osasuna 1 Deportivo 1
Osasuna 1 Madrid 2
Osasuna 1 Levante 1
Osasuna 1 Malaga 1
-------------------------------

runs as:
 yourexename < inputFile.txt
-------------------------------
output:

 Team Name     given  received
 Deportivo         1         1
   Levante         2         2
    Madrid         2         2
    Malaga         3         3
   Osasuna         5         5

*/ 
```

# javascript - IE7：单击仅在模糊时触发

> ID：14836193
> 
> 赞同：1
> 
> 时间：2013-02-12T15:42:25.697
> 
> 标签：javascript, jquery, html, internet-explorer-7

当单击复选框时，我尝试隐藏 div：

```
$("input[type='checkbox']").on('click', function() {
  $("div.new").hide();
}); 
```

div的隐藏只有在鼠标离开复选框后才会发生，为什么？我应该为资源管理器使用 mousedown 吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-12T15:46:06.180

尝试给复选框一个类并调用该类的函数

```
$(".checkbox").on('click', function() {
  $("div.new").hide();
}); 
```

# freepascal - 完整表格中的日期

> ID：14836201
> 
> 赞同：-1
> 
> 时间：2013-02-12T15:42:47.577
> 
> 标签：freepascal

我真的不知道该程序使用什么代码：编写一个程序，接受以数字形式写入的日期，然后将它们作为完整的形式输出。例如：输入是 2 26 1986，输出应该是 1986 年 2 月 26 日。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:53:12.953

这基本上是一个单行：

```
uses dateutils,sysutils;
var s :string;

begin
  s:='2 26 1986';
  // readln(s);
  writeln(formatdatetime('mmmm d, yyyy',scandatetime('m d yyyy',s)));
end. 
```

虽然它假定使用英语语言环境，但您可以在较新的 FPC 中使用 getlocaleformatsettings 强制加载（在 Windows 下）。或者加载你自己的格式设置，formatdatetime 有一个用于自定义格式设置的重载版本。

# svn - svn on linux-server 第三作者需要tortoise-svn-ssh-client

> ID：14836206
> 
> 赞同：1
> 
> 时间：2013-02-12T15:43:03.137
> 
> 标签：svn, ssh, tortoisesvn, authorization

大约一年前，当我设置我们的 vufind-server 时，我很难通过设置我的第一个 SVN-server 和 tortoise-SVN-clients 来支持和使用它。找到“ [http://tortoisesvn.net/ssh_howto.html](http://tortoisesvn.net/ssh_howto.html) ”似乎是天赐之物，一段时间后一切顺利。尤其是当我已经在我的服务器上使用 PGP 密钥对自己进行身份验证时（老实说，我使用的是*一个*PGP 密钥）......因此，似乎最容易将用于服务器身份验证的 PGP 信息传递给与我一起从事该项目的同事，因此让他获得了服务器访问权限。

按照操作方法，我为 /home/svnuser/.ssh/authorized_keys-file 中的两个不同作者制作了两条不同的行，也使用了两个不同的 pgp-keys，即使我不记得那些来自...

但现在我无法弄清楚如何让第三位作者进入系统。

我试图用新数据添加一个新行，但所做的任何编辑都将始终以我的名字命名......有人可以帮忙吗？

卡塔琳娜

# ruby-on-rails - 无法批量分配受保护的属性：shift_type_ids、unit_shift_type

> ID：14836210
> 
> 赞同：0
> 
> 时间：2013-02-12T15:43:17.000
> 
> 标签：ruby-on-rails, nested-attributes, rails-activerecord, mass-assignment

我正在尝试使用一个表单来在医院中创建一个单元，您可以在 UnitShiftTypes 表中选择适用于该单元的 shift_types。我在 Units 和 ShiftTypes 之间有 has_many 和 :through UnitShiftTypes。似乎每次都会抛出错误。我似乎无法弄清楚这一点。任何帮助将不胜感激！

_form.html.erb

```
<%= simple_form_for(@unit) do |f| %>
  <%= f.error_notification %>
  <div class="form-inputs">
    <%= f.input :name %>
    <%= f.input :number %>
    <%= f.fields_for :unit_shift_type do |ff| %>
      <%= f.select :shift_type_ids, ShiftType.all.collect {|x| [x.name, x.id, ]}, {}, :multiple => true %>
      <%= ff.hidden_field :user_id, :value => current_user %>
    <% end %>
    <%= f.input :hospital_id %>
  </div>
  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %> 
```

单位.rb

```
class Unit < ActiveRecord::Base
belongs_to :hospital
has_many :unit_users, :dependent => :restrict
has_many :unit_shift_types
has_many :users, :through => :unit_users, :dependent => :restrict
has_many :shift_types, :through => :unit_shift_types

attr_accessible :hospital_id, :name, :number, :unit_id, :unit_shift_types_attributes
accepts_nested_attributes_for :unit_shift_types

validates_presence_of :hospital_id, :name, :number
validates_uniqueness_of :number, :scope => :hospital_id, :message => "is already associated with this Hospital."
end 
```

unit_shift_type.rb

```
class UnitShiftType < ActiveRecord::Base
belongs_to :shift_type
belongs_to :unit

attr_accessible :shift_type_id, :unit_id

validates_presence_of :shift_type_id, :unit_id
validates_uniqueness_of :shift_type_id, :scope => :unit_id, :message => "is already associated with this Unit."
end 
```

shift_type.rb

```
class ShiftType < ActiveRecord::Base
has_many :unit_shift_types

attr_accessible :created_by_id, :enabled, :end_time, :name, :start_time
validates_presence_of :start_time, :end_time, :name, :created_by_id

end 
```

units_controller.rb

```
# POST /units
# POST /units.json
def create
  @unit = Unit.new(params[:unit])

  respond_to do |format|
    if @unit.save
      format.html { redirect_to @unit, notice: 'Unit was successfully created.' }
      format.json { render json: @unit, status: :created, location: @unit }
    else
      format.html { render action: "new" }
      format.json { render json: @unit.errors, status: :unprocessable_entity }
    end
  end
end

# PUT /units/1
# PUT /units/1.json
def update
  @unit = Unit.find(params[:id])

  respond_to do |format|
    if @unit.update_attributes(params[:unit])
      format.html { redirect_to @unit, notice: 'Unit was successfully updated.' }
      format.json { head :no_content }
    else
      format.html { render action: "edit" }
      format.json { render json: @unit.errors, status: :unprocessable_entity }
    end
  end
end 
```

请求参数：

```
{"utf8"=>"✓", "authenticity_token"=>"CnIZCDbEVNr/B8fby2La8ibvtQtjycwO/BD0mQ2sOw4=", "unit"=>{"name"=>"1", "number"=>"1", "shift_type_ids"=>["", "1"], "unit_shift_type"=>{"user_id"=>""}, "hospital_id"=>"1"}, "commit"=>"Create Unit", "action"=>"create", "controller"=>"units"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T22:04:53.317

如果您只想在创建新单元时添加现有的 shift_types 并且您正在使用 shift_type_ids，那么您不需要指定嵌套属性。无论如何，您正在使用表单对象来创建`select`，因此无需保留`fields_for`阻止。虽然您正在使用`fields_for`创建隐藏字段`user_id`，但我看不到您在 Model.xml 中的哪里有该`user_id`属性`UnitShiftType`。

所以替换 fields_for 块

```
<%= f.fields_for :unit_shift_type do |ff| %>
  <%= f.select :shift_type_ids, ShiftType.all.collect {|x| [x.name, x.id, ]}, {}, :multiple => true %>
  <%= ff.hidden_field :user_id, :value => current_user %>
<% end %> 
```

和

```
<%= f.select :shift_type_ids, ShiftType.all.collect {|x| [x.name, x.id]}, {}, :multiple => true %> 
```

并添加`shift_type_ids`到`Unit`模型的`attr_accessible`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-12T16:17:50.237

尝试更换：

```
<%= f.select :shift_type_ids, ShiftType.all.collect {|x| [x.name, x.id, ]}, {}, :multiple => true %> 
```

和：

```
 <%= f.select :shift_type_ids, @unit.unit_shift_types.collect {|x| [x.name, x.id, ]}, {}, :multiple => true %> 
```

但要获得真正的解决方案，我们必须查看控制器的创建和/或更新操作。您如何将 shift_type 添加到单元中？

它应该看起来像：

```
@unit << shift_type 
```

# c++ - Android NDK OpenCV - substr 的参数无效

> ID：14836213
> 
> 赞同：1
> 
> 时间：2013-02-12T15:43:24.157
> 
> 标签：c++, opencv, android-ndk-r5

我想在 android/opencv/ndk 项目中使用我的 c++ 代码。当我将文件粘贴到 jni 文件夹并打开它们时，编译器会为 substr 或 fwrite 等函数提供无效的参数错误。

一个例子：

```
#include <string>
#include <vector>
using namespace std;
using namespace cv;
...
std::string str="We think in generalities, but we live in details.";   
std::string str2 = str.substr (12,12); 
```

编译器是否为 substr 退出：

> 无效参数 ' 候选者是：std::basic_string,std::allocator> substr(?, ?) '

我显然做错了什么！我正在为 Android 和 C/C++ Dev 使用 OpenCV 2.4.3.2。Eclipse 工具 8.1.1。

# windows - 错误：为扩展 com.as3nui.nativeExtensions.air.kinect 找到重复的平台 Windows-x86

> ID：14836221
> 
> 赞同：0
> 
> 时间：2013-02-12T15:43:35.293
> 
> 标签：windows, actionscript-3, flash, air

尝试在 Flash 中编译 AIRKinect 项目并不断收到以下错误

'无法加载内容，因为加载扩展时出现问题：错误：为扩展 com.as3nui.nativeExtensions.air.kinect 找到了重复的平台 Windows-x86

谁能建议一些故障排除步骤？
我过去一直能够编译没有错误，这是我第一次看到这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:12:02.003

好的，这就是我要解决的问题

已删除我的临时文件夹的内容（并非所有内容都可以删除，因为某些文件正在使用中）

这里

C:\Users\用户名\AppData\Local\Temp

重新启动 Flash 并编译

# android - 在真实的 Android 设备上模拟收到的短信

> ID：14836222
> 
> 赞同：4
> 
> 时间：2013-02-12T15:43:38.957
> 
> 标签：android, sms, adb, simulation

我正在为 Android 手机开发一个与短信有关的应用程序。我找到了许多指南来模拟在模拟器上收到的短信，但我正在真实设备上测试软件。

有没有办法让真正的安卓手机误以为它收到了短信？

我已经尝试过`adb shell`使用`sms send`命令，但我认为它仅在使用 telnet 时在模拟器上可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:57:53.337

据我了解，这里的动机是为设备或模拟器创建一个 FAKE INCOMING SMS。

您可能需要使用消息传递内容提供程序进行一些逆向工程来实现这一点。您可以使用与消息传递相关的内容提供程序向数据库添加条目，这是模拟 SMS 的一般方法，也被 SMS 伪造应用程序使用。请注意不要依赖此内容，因为 Android 不保证此内容提供者将永远拥有此类访问权限。

另请参阅此链接： [http ://android-developers.blogspot.com/2010/05/be-careful-with-content-providers.html](http://android-developers.blogspot.com/2010/05/be-careful-with-content-providers.html)

希望这可以帮助。

# css - 带线性渐变的虚线边框

> ID：14836223
> 
> 赞同：0
> 
> 时间：2013-02-12T15:43:39.797
> 
> 标签：css

我有一个带有颜色代码 #664914 的虚线边框。我想让这个边框在最后以黑色渐变淡化。当前的css如下：

```
#div1{width:1000px;border-bottom:1px dotted #664914; margin: 5px auto 0;} 
```

尝试实现的目标是否可以通过 css 实现？如果是这样，我怎么能做到这一点。我知道我的问题可能很明显，但很难弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:46:34.130

你可以用`border-image`，这里有一组很好的例子：

[http://css-tricks.com/examples/GradientBorder/](http://css-tricks.com/examples/GradientBorder/)

基本思想：

```
.top-to-bottom {
    border-width:3px;
    -webkit-border-image: 
        -webkit-gradient(linear, 0 0, 0 100%, from(black), to(rgba(0, 0, 0, 0))) 1 100%;
    -webkit-border-image: 
        -webkit-linear-gradient(black, rgba(0, 0, 0, 0)) 1 100%;
    -o-border-image:
        -o-linear-gradient(black, rgba(0, 0, 0, 0)) 1 100%;
    -moz-border-image:
       -moz-linear-gradient(black, rgba(0, 0, 0, 0)) 1 100%;    
} 
```

请记住，IE 不支持此功能 - [http://caniuse.com/#search=border-image](http://caniuse.com/#search=border-image)

# iphone - IOS NSJSONSerialization 反序列化 NSArray

> ID：14836226
> 
> 赞同：-1
> 
> 时间：2013-02-12T15:43:45.100
> 
> 标签：iphone, ios, objective-c, json

我正在尝试将数组反序列化为 json 字符串。json是这样的

```
{
   "id": "2559",
    "tags": [
        "Tag1",
        "Tag2"
    ]
} 
```

我的代码是

```
NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData  options:kNilOptions error:nil];
myEntity= [[MyEntity alloc] init];

myEntity.id          = [json objectForKey:@"id"];
myEntity.tags        = [json objectForKey:@"tags"]; 
```

MyEntity 是

```
@interface MyEntity: NSObject{
    NSString *id;
    NSArray *tags;
... 
```

我的问题是我无法查看标签的值， myEntity.tags 是一个包含 2 项**empty**的数组。

如何对标签进行反序列化？

编辑对不起大家，我错了。它工作正常，如果我用

```
NSLog(@"%@", [json objectForKey:@"tags"]);
NSLog(@"%@", myEntity.tags); 
```

我可以看到相同的日志

```
(
    tags1,
    tags2
) 
```

我很困惑，因为在原木附近的区域我看到了这个

```
tags = (NSArray *) 0x07... @"2 objects"
    [0]
    [1] 
```

谢谢大家，再次为我的错误道歉

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T16:56:56.180

这对于评论来说太长了，但它正在变成一个拖拖拉拉的评论对话。

复制并粘贴您使用的确切代码，否则我们无法帮助您。

如果我使用您提供的 JSON，那么一切正常

```
NSString *JSONString =
@"{"
  @"\"id\": \"2559\","
  @"\"tags\": ["
    @"\"Tag1\","
    @"\"Tag2\""
  @"]"
@"}";

NSData *JSONData = [JSONString dataUsingEncoding:NSUTF8StringEncoding];

NSDictionary* json = [NSJSONSerialization JSONObjectWithData:JSONData
                                                     options:kNilOptions
                                                       error:nil];
NSLog(@"%@", [json objectForKey:@"tags"]);
//=> 2013-02-12 16:52:24.076 Test[52992:c07] (
//     Tag1,
//     Tag2
//   ) 
```

一旦因缺乏清晰度而导致的无尽评论线程完成后，我将删除此答案

# python - 是否有一种标准化的方法可以在 Python 中交换两个变量？

> ID：14836228
> 
> 赞同：402
> 
> 时间：2013-02-12T15:43:55.253
> 
> 标签：python, syntax, swap, conventions

在 Python 中，我看到使用这种语法交换了两个变量值：

```
left, right = right, left 
```

这是否被认为是交换两个变量值的标准方法，还是有一些其他方法可以按照惯例最常交换两个变量？

* * *

## 回答 #1

> 赞同：482
> 
> 时间：2013-02-12T15:56:33.150

> Python 从左到右计算表达式。请注意，在评估分配时，右侧先于左侧评估。
> 
> [Python 文档：评估顺序](http://docs.python.org/3/reference/expressions.html#evaluation-order)

这意味着表达式的以下内容`a,b = b,a`：

*   右边`b,a`是求值的，也就是说，在内存中创建了两个元素的元组。这两个元素是由标识符`b`和指定的对象`a`，它们在程序执行期间遇到指令之前就已经存在。
*   就在这个元组创建之后，还没有对这个元组对象进行赋值，不过没关系，Python内部知道它在哪里。
*   然后，对左侧进行求值，也就是说，将元组分配给左侧。
*   由于左侧由两个标识符组成，因此对元组进行解包，以便将第一个标识符`a`分配给元组的第一个元素（这是在交换之前以前是**b**`b`的对象，因为它有 name ）
    和第二个标识符`b`被分配给元组的第二个元素（这是在交换之前以前**是 a**`a`的对象，因为它的标识符是）

这种机制有效地交换了分配给标识符的对象`a`和`b`

所以，回答你的问题：是的，这是在两个对象上交换两个标识符的标准方法。
顺便说一句，对象不是变量，它们是对象。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2013-02-12T15:44:22.827

这是交换两个变量的标准方法，是的。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2016-01-06T23:34:40.287

我知道交换变量的三种方法，但`a, b = b, a`最简单。有

## XOR（整数）

```
x = x ^ y
y = y ^ x
x = x ^ y 
```

或者简而言之，

```
x ^= y
y ^= x
x ^= y 
```

## 临时变量

```
w = x
x = y
y = w
del w 
```

## 元组交换

```
x, y = y, x 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2016-12-07T21:10:58.263

我不会说这是一种标准的交换方式，因为它会导致一些意想不到的错误。

```
nums[i], nums[nums[i] - 1] = nums[nums[i] - 1], nums[i] 
```

`nums[i]`会先修改再影响第二个变量`nums[nums[i] - 1]`。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-12-06T08:50:08.407

不适用于多维数组，因为这里使用了引用。

```
import numpy as np

# swaps
data = np.random.random(2)
print(data)
data[0], data[1] = data[1], data[0]
print(data)

# does not swap
data = np.random.random((2, 2))
print(data)
data[0], data[1] = data[1], data[0]
print(data) 
```

另见[交换 Numpy 数组的切片](https://stackoverflow.com/questions/14933577/swap-slices-of-numpy-arrays/14933939#14933939)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-28T16:33:33.203

为了解决[eyquem](https://stackoverflow.com/a/14836456/10415695)解释的问题，您可以使用该`copy`模块通过函数返回一个包含值的（反转）副本的元组：

```
from copy import copy

def swapper(x, y):
  return (copy(y), copy(x)) 
```

与 a 相同的功能`lambda`：

```
swapper = lambda x, y: (copy(y), copy(x)) 
```

然后，将它们分配给所需的名称，如下所示：

```
x, y = swapper(y, x) 
```

**注意：**如果您愿意，可以导入/使用`deepcopy`而不是`copy`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-01T03:40:02.497

该语法是交换变量的标准方法。但是，在处理被修改然后在交换的后续存储元素中使用的元素时，我们需要注意顺序。

使用带有直接索引的数组很好。例如：

```
def swap_indexes(A, i1, i2):
      A[i1], A[i2] = A[i2], A[i1]
      print('A[i1]=', A[i1], 'A[i2]=', A[i2])
      return A

  A = [0, 1, 2, 3, 4]
  print('For A=', A)
  print('swap indexes 1, 3:', swap_indexes(A, 1, 3)) 
```

给我们：
('For A=', [0, 1, 2, 3, 4])
('A[i1]=', 3, 'A[i2]=', 1)
('交换索引 1, 3 :', [0, 3, 2, 1, 4])

但是，如果我们改变左边的第一个元素并在左边的第二个元素中使用它作为索引，这会导致错误的交换。

```
def good_swap(P, i2):
    j = P[i2]
    #Below is correct, because P[i2] is modified after it is used in P[P[i2]]
    print('Before: P[i2]=', P[i2], 'P[P[i2]]=', P[j])
    P[P[i2]], P[i2] = P[i2], P[P[i2]]
    print('Good swap: After P[i2]=', P[i2], 'P[P[i2]]=', P[j])
    return P

def bad_swap(P, i2):
    j = P[i2]
    #Below is wrong, because P[i2] is modified and then used in P[P[i2]]
    print('Before: P[i2]=', P[i2], 'P[P[i2]]=', P[j])
    P[i2], P[P[i2]] = P[P[i2]], P[i2]
    print('Bad swap: After P[i2]=', P[i2], 'P[P[i2]]=', P[j])
    return P

P = [1, 2, 3, 4, 5]
print('For P=', P)
print('good swap with index 2:', good_swap(P, 2))
print('------')
P = [1, 2, 3, 4, 5]
print('bad swap with index 2:', bad_swap(P, 2)) 
```

* * *

('For P=', [1, 2, 3, 4, 5])
('之前：P[i2]=', 3, 'P[P[i2]]=', 4)
('好的交换： After P[i2]=', 4, 'P[P[i2]]=', 3)
('good swap with index 2:', [1, 2, 4, 3, 5])

('Before: P[i2]=', 3, 'P[P[i2]]=', 4)
('Bad swap: After P[i2]=', 4, 'P[P[i2]]= ', 4)
('bad swap with index 2:', [1, 2, 4, 4, 3])

坏交换是不正确的，因为 P[i2] 是 3，我们期望 P[P[i2]] 是 P[3]。但是P[i2]先变成了4，所以后面的P[P[i2]]变成了P[4]，覆盖的是第4个元素而不是第3个元素。

上述场景用于排列。一个更简单的好交换和坏交换将是：

```
#good swap:
P[j], j = j, P[j]
#bad swap:
j, P[j] = P[j], j 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2020-01-31T23:31:31.860

您可以组合**元组**和**XOR**交换：**x, y = x ^ x ^ y, x ^ y ^ y**

```
x, y = 10, 20

print('Before swapping: x = %s, y = %s '%(x,y))

x, y = x ^ x ^ y, x ^ y ^ y

print('After swapping: x = %s, y = %s '%(x,y)) 
```

或者

```
x, y = 10, 20

print('Before swapping: x = %s, y = %s '%(x,y))

print('After swapping: x = %s, y = %s '%(x ^ x ^ y, x ^ y ^ y)) 
```

使用*lambda*：

```
x, y = 10, 20

print('Before swapping: x = %s, y = %s' % (x, y))

swapper = lambda x, y : ((x ^ x ^ y), (x ^ y ^ y))

print('After swapping: x = %s, y = %s ' % swapper(x, y)) 
```

输出：

```
Before swapping: x =  10 , y =  20
After swapping: x =  20 , y =  10 
```

# c++ - C++ 访问控制

> ID：14836238
> 
> 赞同：0
> 
> 时间：2013-02-12T15:44:20.247
> 
> 标签：c++, visual-c++

我想在一个类中定义一个可以被任何其他函数读取但只能由成员函数修改的变量。例如，C# 具有用于此目的的属性。传统上，我们定义了一个返回私有成员变量的函数。但我认为这看起来并不复杂。

在 C++ 中有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:49:22.610

不。Getter 函数（如果需要，还有 Setter）是访问数据成员的 C++ 方法。通常，您将任何数据成员设为私有变量以确保封装。仅当您设计的不是真正的类而是仅没有（很多）行为的“一堆数据”时才使用公共数据成员，在这种情况下，通常将其定义为结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:46:37.040

您对恢复对私人成员的访问权的疑虑是没有根据的。

```
class Thing
{
public:
    const std::string& GetString() const { return m_String; } // users can access m_String by calling GetString()

    void SomeRandomFunc() { m_String = "Hello"; } // member functions can write to m_String

private:
    std::string m_String;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T15:51:05.217

如果您在 Visual Studio 中编写，则 C++ 中的属性（如 C#）。但当然是特定于编译器的。如果你问我，我更喜欢“get”功能

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T15:58:33.753

C++ 中没有属性之类的东西，即使在 C# 中，这也是一对 set/get 函数。只是一些糖。

但是你可以做一些看起来与财产几乎相同的事情。

看看这个类原型

```
 template<class T, class Owner>
class Property {
    friend Owner;
public:
    Property(const T &_v) : m_v(_v) {
    }

    operator T() {
        return m_v;
    }

private:
    T   m_v;

    Property<T,Owner>& operator = (const Property<T,Owner> &v) {
        m_v = v.m_v;
        return *this;
    }

    Property<T,Owner>& operator = (const T& v) {
        m_v = v;
        return *this;
    }
}; 
```

并在您的班级公共成员中声明，例如

```
class Test {
public:
    Test() : Data(0) {}

    Property<int, Test> Data;

    void SetData(int data) {
        Data = data;

    }
    }; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T16:11:41.520

```
class A
{
private:
    string m_string;

public:
    const string& GetString() const
    {
        return m_string;
    }

    __declspec(property(get=GetString)) string String;
};

A a;
cout << a.String << endl; 
```

不过，仍然不如 C# 好。

当然还有 C++/CLI 属性（用于托管类），它们更接近于 C# 属性：

```
ref class A
{
private:
    String^ m_theString;

public:
    property String^ TheString
    {
        String^ get()
        {
            return m_theString;
        }
    }
}; 
```

# delphi - PChar('') 是否保证是指向 #0 的指针（不是 nil）？

> ID：14836247
> 
> 赞同：8
> 
> 时间：2013-02-12T15:45:03.253
> 
> 标签：delphi, null, string, null-terminated, pchar

我知道在 Delphi 中，一个空字符串（AnsiString 或 WideString）可以用一个 nil 指针表示，也可以用一个指向实际空字符串的指针表示。

通过实验，我已经在 Delphi XE2（具有特定的编译器设置）中证明了这一点`PChar('') <> nil`。但这是否得到保证，或者它可能会在未来的版本中发生变化，或者取决于某些编译器设置？

我正面临信任危机。如果有人能给我一个明确的答案，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T15:51:08.840

是的。从字符串文字到 PChar 的类型转换永远不会是空指针。从相同字符类型的字符串到 PChar 的类型转换也不会为空。（字符串到 PChar、AnsiString 到 PAnsiChar 等）

但是，对 PChar 的其他事物的类型转换可能为空。（指向 PChar 的指针、指向 PWideChar 的 AnsiString 等）

文档在字符串类型主题的[混合 Delphi 字符串和空终止字符串](http://docwiki.embarcadero.com/RADStudio/en/String_Types#Mixing_Delphi_Strings_and_Null-Terminated_Strings)部分中对此进行了介绍：

> 您还可以将 UnicodeString 或 AnsiString 字符串强制转换为以 null 结尾的字符串。以下规则适用：
> 
> *   如果 S 是 UnicodeString，则 PChar(S) 将 S 转换为以 null 结尾的字符串；它返回一个指向 S 中第一个字符的指针。这种类型转换用于 Windows API。例如，如果 Str1 和 Str2 是 UnicodeString，您可以像这样调用 Win32 API MessageBox 函数：MessageBox(0, PChar(Str1), PChar(Str2), MB_OK);。如果 S 是 AnsiString，则使用 PAnsiChar(S)。
> *   您还可以使用 Pointer(S) 将字符串转换为无类型指针。但如果 S 为空，则类型转换返回 nil。
> *   PChar(S) 总是返回一个指向内存块的指针；如果 S 为空，则返回指向 #0 的指针。
> *   当您将 UnicodeString 或 AnsiString 变量强制转换为指针时，指针将保持有效，直到为变量分配新值或超出范围。如果将任何其他字符串表达式转换为指针，则该指针仅在执行类型转换的语句内有效。
> *   当您将 UnicodeString 或 AnsiString 表达式转换为指针时，通常应将指针视为只读的。只有满足以下所有条件时，您才能安全地使用指针修改字符串：
>     *   表达式转换是 UnicodeString 或 AnsiString 变量。
>     *   字符串不为空。
>     *   该字符串是唯一的 - 即，引用计数为 1。要保证字符串是唯一的，请调用 SetLength、SetString 或 UniqueString 过程。
>     *   自进行类型转换以来，该字符串尚未被修改。
>     *   修改的字符都在字符串中。注意不要在指针上使用超出范围的索引。
> 
> 将 WideString 值与 PWideChar 值混合时适用相同的规则。

# asp.net-mvc-4 - 将自定义参数传递给 ValidationAttribute

> ID：14836248
> 
> 赞同：21
> 
> 时间：2013-02-12T15:45:04.070
> 
> 标签：asp.net-mvc-4

我构建了一个自定义 ValidationAttribute，因此我可以验证系统中的唯一电子邮件地址。但是，我想以某种方式传入一个自定义参数，以便为我的验证添加更多逻辑。

```
public class UniqueEmailAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        //I need the original value here so I won't validate if it hasn't changed.
        return value != null && Validation.IsEmailUnique(value.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-02-14T16:04:56.443

像这样？

```
public class StringLengthValidatorNullable : ValidationAttribute
{
    public int MinStringLength { get; set; }
    public int MaxStringLength { get; set; }

    public override bool IsValid(object value)
    {
        if (value == null)
        {
            return false;
        }
        var length = value.ToString().Length;

        if (length < MinStringLength || length >= MaxStringLength)
        {
            return false;
        }
        return true;
    }
} 
```

采用：

```
[StringLengthValidatorNullable(MinStringLength = 1, MaxStringLength = 16)]
public string Name {get; set;} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-03-14T14:34:22.827

您还可以传递同一模型中其他属性的参数。

创建自定义验证属性：

```
public class SomeValidationAttribute : ValidationAttribute
{
    //A property to hold the name of the one you're going to use.
    public string OtherProperty { get; set; }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        //Get the value of the property using reflection.
        var otherProperty = validationContext.ObjectType.GetProperty(OtherProperty);
        var otherPropertyValue = (bool)otherProperty.GetValue(validationContext.ObjectInstance, null);

        if (value != null && otherPropertyValue)
        {
            return ValidationResult.Success;
        }

        return new ValidationResult("Invalid property message.");
    }
} 
```

然后传递您要使用的属性的名称。

```
 public class RequestModel 
    {
        public bool SomeProperty { get; set; }

        [SomeValidation(OtherProperty = "SomeProperty")]
        public DateTime? StartDate { get; set; }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-29T21:21:34.093

有一个类似的要求，我必须将值传递给自定义属性。

这里的问题是 Attribute 装饰不允许**variables**。你得到编译时错误：

> 非静态字段、方法或属性需要对象引用

这是我能够做到的：

**在控制器中**

```
[FineGrainAuthorization]
public class SomeABCController : Controller
{
    public int SomeId { get { return 1; } }
} 
```

**在属性**

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method)]
public class FineGrainAuthorizationAttribute : AuthorizeAttribute
{
    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        base.OnAuthorization(filterContext);
        ControllerBase callingController = filterContext.Controller;
        var someIdProperty = callingController.GetType().GetProperties().Where(t => t.Name.Equals("SomeId")).First();
        int someId = (int) someIdProperty.GetValue(callingController, null);
    }
} 
```

记住里面的字符串`.Name.Equals("SomeId")`必须大小写匹配声明`public int SomeId`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T14:57:47.100

我会建议像@Oliver's answer之类的东西（无论如何，这就是我要做的），但后来我注意到你不想传递常量。

那么这样的事情呢？

```
public static class MyConfig
{
    public static int MinStringLength { get; set; }
    public static int MaxStringLength { get; set; }
    public static SomeObject otherConfigObject { get; set; }
} 
```

然后`MyConfig.MinStringLength`从验证中访问？不过，我同意它不太漂亮。

# django - 使用 django-storages 和 s3boto 后端：附加了我不想要的 x-amz-security-token

> ID：14836251
> 
> 赞同：8
> 
> 时间：2013-02-12T15:45:27.663
> 
> 标签：django, amazon-s3, boto

我正在使用 django-storages 从 s3 提供静态内容。这在使用 boto 2.5.X 时效果很好。但是当我使用 boto >= 2.6 时，s3 媒体的 url 会被破坏；附加了一个额外的变量。不同之处在于 x-amz-security-token 被附加（我不想要）。无法通过 url 访问媒体。

在我的 settings.py 中，我使用

```
AWS_QUERYSTRING_AUTH = False 
```

错误的网址：

```
https://mybucket.s3.amazonaws.com/static/style/css/layout.min.css?x-amz-security-token=AQoDYXdzEKj/76aRNkwEaoALUm866M8Z6Kc4aF/76aRNkjDcT70xSVB58kR%2BONYLf7y1z1pgqUX7fPRXVQjP9DYOZzcVdHCV27zybD/iPYT2C6rCEnvkQvhcq.... 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-26T18:17:40.893

我有一个基于 django-storages （版本 1.1.8）的更好的解决方法，它是

```
 AWS_S3_CUSTOM_DOMAIN = 'mybucket.s3.amazonaws.com' 
```

这避免了 django-storage 调用 boto`generate_url`并且只是将资源的路径缝合在一起。如果你想使用 auth 来获取静态文件，这是行不通的。

对于好奇：

我网站某些部分的静态文件有效，而其他部分（如管理员）则无效。这与两者之间的差异有关

```
{% load static %} 
```

和

```
{% load staticfiles %} 
```

两者都定义了一个块标签`{% static %}`，但它们做不同的事情。来自 static 的一个只是在 {{ STATIC_URL }} 之前，来自 staticfiles 的一个使用存储的`url`方法来获取文件的 url。django 管理员的`{% static %}`阻止`admin_static`就像`staticfiles`使用存储一样。

通过更改为使用`{% load staticfiles %}`我的网站，在`AWS_QUERYSTRING_AUTH = False`和/或`AWS_S3_SECURE_URLS = False`. 这表明问题基本上在 boto`generate_url`中，即当`querystring_auth`是时`False`，`x-amz-security-token`仍然设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-17T16:30:54.057

尝试将其添加到您的 settings.py

> AWS_S3_SECURE_URLS = 假

# audio - 我正在使用 EveryPlay api 录制视频，但无法录制声音

> ID：14836252
> 
> 赞同：0
> 
> 时间：2013-02-12T15:45:30.987
> 
> 标签：audio, cocos2d-iphone, recording, fmod, everyplay

推荐的声音 api 是付费的 FMOD。如果有一个可能的免费声音api可以替代cocos2d的标准简单音频引擎？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T19:52:06.470

我个人也尝试寻找一些替代方案，但没有运气，似乎几乎每个库都围绕 OpenAL 或 AVFoundation 包装了一些音频代码

但好消息是，OpenAL 和 CocosDenshion 支持很快就会出现在 Everyplay 中，这意味着无需更改现有代码。:)

这是一项正在进行的工作，但我希望在两周内公开发布

# amazon-s3 - PHPThumb GdThumb，调整图像的 2 个变体并将字符串保存到 S3 不起作用

> ID：14836257
> 
> 赞同：0
> 
> 时间：2013-02-12T15:45:54.237
> 
> 标签：amazon-s3, phpthumb

我无法让下面的代码工作。我将原始图像保存到我的 S3 存储桶中，然后调整同一图像的 2 个变体的大小并将 PHPThumb_GdThumb 生成的字符串发送到 S3，但调整大小的图像有 0kb 并包含错误。

图像可以很好地写入**mybucket/object**和**mybucket/object/thumb**，但 thumb 文件夹中的图像是 0kb 并且包含错​​误。

这是我的代码：

```
 // Add Original to S3 before doing any cropping

    $s3_path = 'mybucket/object';
    $S3_folder->addToBucket($s3_path.'/'.$filename, $path);

    $GDImage = new PHPThumb_GdThumb("{$path}");
    if (!$GDImage->getHasError())
    {
        // get images dimensions
        $dimensions = $GDImage->getCurrentDimensions();
        $imageWidth = (int) $dimensions['width'];
        $imageHeight = (int) $dimensions['height'];
        // thumbnails
        if ($imageHeight > $imageWidth)
        {
            $thumbPercent = floor(self::THUMB_SIZE / $imageHeight * 100);
        } else if ($imageHeight < $imageWidth)
        {
            $thumbPercent = floor(self::THUMB_SIZE / $imageWidth * 100);
        } else
        {
            // it's a square use either
            $thumbPercent = floor(self::THUMB_SIZE / $imageWidth * 100);
        }

        if ($imageHeight > self::THUMB_SIZE)
        {
            $img_string = $GDImage->resizePercent($thumbPercent)
                ->cropFromCenter(self::THUMB_SIZE)
                ->getImageAsString();

        } else
        {
            $img_string = $GDImage->getImageAsString();
        }

        $S3_folder->addToBucket($s3_path.'/thumb/'.$filename, $img_string); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T12:00:28.433

我已经设法让它工作，但现在第二次调整大小很快，但将其发送到 S3 非常慢，上传一个非常小的图像大约需要 30 秒。

有人一次性将多个对象放入 S3 有任何问题吗？

# java - struts2-core ejb模块之间的共享依赖

> ID：14836258
> 
> 赞同：3
> 
> 时间：2013-02-12T15:45:54.990
> 
> 标签：java, jakarta-ee, struts2, glassfish, ejb

我有一个结构如下的 EJB 应用程序。所有依赖项都保存在`/lib`目录中并在所有 Web 模块之间共享。

```
├── app1_war
│   ├── index.jsp
│   ├── META-INF
│   └── WEB-INF
|
├── core.jar
├── app2_war
│   ├── META-INF
│   └── WEB-INF
|
├── app3_war
│   ├── META-INF
│   └── WEB-INF
|
├── lib
│   ├── struts2-core-2.3.8.jar
│   ├── webwork-2.2.7.jar
│   ├── xwork-1.2.3.jar
│   └── xwork-core-2.3.8.jar
|
├── META-INF
│   ├── application.xml
│   ├── MANIFEST.MF
|
├── app4_war
    ├── index.jsp
    ├── META-INF
    └── WEB-INF 
```

所有模块都使用`struts2-core-2.3.8.jar`依赖项。当我在 Glassfish 上部署它时，我最终会遇到以下异常：

```
Exception starting filter struts2
java.lang.InstantiationException
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:124)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4685)
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:5377)
        at com.sun.enterprise.web.WebModule.start(WebModule.java:498)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
        at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2019)
        at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
[...]

Caused by: Unable to load configuration. - bean - jar:file:/opt/glassfish3/nodes/apps/fish1/applications/legacy/lib/struts2-core-2.3.8.jar!/struts-default.xml:29:72
        at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:483)
        at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
        at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:264)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:120)
        ... 41 more
Caused by: Unable to load configuration. - bean - jar:file:/opt/glassfish3/nodes/apps/fish1/applications/legacy/lib/struts2-core-2.3.8.jar!/struts-default.xml:29:72
        at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:70)
        at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:429)
        at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:471)
        ... 45 more
Caused by: Unable to load bean: type: class:com.opensymphony.xwork2.ObjectFactory - bean - jar:file:/opt/glassfish3/nodes/apps/fish1/applications/legacy/lib/struts2-core-2.3.8.jar!/struts-default.xml:29:72
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.register(XmlConfigurationProvider.java:245)
        at org.apache.struts2.config.StrutsXmlConfigurationProvider.register(StrutsXmlConfigurationProvider.java:102)
        at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:215)
        at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:67)
        ... 47 more
Caused by: Bean type class com.opensymphony.xwork2.ObjectFactory with the name xwork has already been loaded by bean - jar:file:/opt/glassfish3/nodes/apps/fish1/applications/legacy/lib/struts2-core-2.3.8.jar!/struts-default.xml:29:72 - bean - jar:file:/opt/glassfish3/nodes/apps/fish1/applications/legacy/lib/struts2-core-2.3.8.jar!/struts-default.xml:29:72
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.register(XmlConfigurationProvider.java:229) 
```

我的猜测是，这是因为所有模块都共享相同的依赖项，因此每个模块都`struts-default.xml`在其上下文中加载相同的文件。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T22:15:08.010

这是一个迟到的回应，但无论如何，这是我对这个问题的看法：

我在 EAR 文件中“共享”一些依赖项时遇到了类似的问题。我可以告诉你的是，当加载上下文时，Struts 会在第一个 WAR 类路径中初始化（依次使用 objectfactory，通常是 Spring）。然后，当加载其他战争时，它们具有不同的上下文但它们包含在同一个类路径层次结构中，Struts 再次初始化，但它发现它已经被初始化。

因此，您不能共享这些类型的依赖项，因为它们需要存在于自己的 Servlet 上下文中。因此，您应该将它们包含在每个 WAR 中。

如果您找到了更好的解决方案，请分享。但如果没有，我希望上面的评论对你有帮助。

# sql - 将 Access 查询转换为 SQL 服务器

> ID：14836259
> 
> 赞同：0
> 
> 时间：2013-02-12T15:45:57.920
> 
> 标签：sql, sql-server, ms-access

我正在尝试将 MS Access 查询转换为 SQL Server，但我无法找出以下代码的 SQL Server 等效项：

```
First(IIf(DateDiff("yyyy",[DateOfBirth],"31-Aug-2012")+Int(Format("31-Aug-2012","mmdd")<Format([DateOfBirth],"mmdd"))<18,'Parent/Guardian of:',Null)) AS PG, 
First(IIf(DateDiff("yyyy",[DateOfBirth],Now())+Int(Format(Now(),"mmdd")<Format([DateOfBirth],"mmdd"))<18,'Parent/Guardian of:',Null)) AS PG_old, 
```

这是我未完成的尝试：

```
First(CASE WHEN (DateDiff("yyyy",[DateOfBirth],"31-Aug-2012")+Int((DATEPART(mm,(CONVERT(DATE,"31-Aug-2012",103))) + (DATEPART(dd,(CONVERT(DATE,"31-Aug-2012",103)))))<Format([DateOfBirth],"mmdd")) < 18 THEN 'Parent/Guardian of:'
           ELSE Null)END) AS PG, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:27:49.073

我希望下面的查询会给你所需的输出

```
 select top 1 (select case When  DATEDIFF(year, DateOfBirth, '31-Aug-2012') < 18 Then 'Parent/Guardian of:' else Null  End  ) from table_name 
```

# ruby - 尝试使用 rbenv 安装 ruby 1.9.3

> ID：14836266
> 
> 赞同：1
> 
> 时间：2013-02-12T15:46:10.417
> 
> 标签：ruby, terminal, homebrew, rbenv, .bash-profile

我刚刚重新格式化了 mt 机器，所以我在这里从头开始。我安装 home brew 比 brew update 比 brew doctor 比我之前为 rbenv 运行以下

```
$ brew update
$ brew install rbenv
$ brew install ruby-build 
```

bash_profile

```
export PATH=$PATH:/Users/anderskitson/bin
export PATH=/usr/local/bin:subli
export PATH="$HOME/.rbenv/bin:$PATH"
eval "$(rbenv init -)" 
```

虽然当我运行 rbenv install 1.9.3-p327 我得到`env: bash: No such file or directory` 我还安装了带有命令行工具的 xcode。帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:07:32.943

您确实需要在 .bash_profile 的每一行中包含 $PATH ，否则您将丢失默认路径（包括 /bin，这是在 OS X 上默认安装 bash 的位置）。

就目前而言，如果在 .bash_profile 的第二行没有 $PATH，您将完全用“/usr/local/bin:subli”覆盖您以前的路径。然后第三行除此之外添加了“$HOME/.rbenv/bin”，但您仍然会丢失 /bin、/usr/bin 等内容。

我会继续并确保您在所有这三行中都包含 $PATH ，以便您添加而不是替换现有路径。

# javascript - javascript函数中的全局变量

> ID：14836269
> 
> 赞同：0
> 
> 时间：2013-02-12T15:46:25.080
> 
> 标签：javascript, node.js, oop

这是我的代码：

```
var csv = require('csv');

var Loader = function() {
  var rows;
  csv()
  .from.path('./data/ebay.csv', {
    columns: true,
    delimiter: ';'
  })
  .to.array( function(rows) {
    setRows(rows);
  });
  function setRows(input) {
    rows = input;
  }
  return rows;
};

module.exports = Loader; 
```

我想`rows`在调用`Loader`对象时得到。我是 OOP Javascript 的初学者，所以我不知道该怎么做。我从哪里开始使用 node 学习 javascript oop？我发现许多教程描述了如何从 node 开始以及如何使用各种框架制作 web，但我已经知道了。我用 PHP 编程，现在转向 NodeJS，我被浪费了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:00:35.397

像所有处理 I/O 的 node.js 函数一样，csv[异步](http://en.wikipedia.org/wiki/Asynchronous_I/O)工作。因此，调用`csv.from..to..`立即返回，但回调函数只是稍后调用。使您的加载器也异步，如下所示：

```
var csv = require('csv');
var Loader = function(onData) {
  csv()
  .from.path('./data/ebay.csv', {
    columns: true,
    delimiter: ';'
  })
  .to.array(onData);
};
module.exports = Loader; 
```

# css - 这个第 n 个子选择器如何在 IE 8 中工作？

> ID：14836272
> 
> 赞同：0
> 
> 时间：2013-02-12T15:46:34.237
> 
> 标签：css, internet-explorer-8, pseudo-class, css-selectors

这是我的 div 容器：

```
#randomid { 
margin-right:40px;
margin-bottom:35px; 
float:left;
} 
```

里面有 12 个元素（2 行）。我需要从最右边（每六分之一）中删除边距。

所以我得到了这个伪选择器：

```
#randomid:nth-child(6n+6) {
    margin-right: 0; 
} 
```

如何在不使用 javascript 的情况下在 IE 8 中进行这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:00:57.143

您可以使用选择性。它是一个 JavaScript 实用程序，在 Internet Explorer 6-8 中模拟 CSS3 伪类和属性选择器。只需将脚本包含在您的页面中，剩下的就交给 selectivizr。

[http://selectivizr.com/](http://selectivizr.com/)

交替

您可以使用 first-child 和“+”来模拟 nth-child，例如：

```
tr>td:first-child + td + td + td + td + td + td + td + td{background-color:red} 
```

选择第 9 列，就像 nth-child(9) 一样，适用于 IE

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:24:49.110

与其使用这样一个复杂的 CSS 选择器，其缺点是在旧版浏览器中缺乏支持，但有一些可能的解决方法可供研究。我整理了一个小例子，说明如何在不使用选择器的情况下实现我认为的预期结果。

下面的示例将在每行上有六个元素，每个元素之间有一个边距，但在每行的第一个元素之前或最后一个元素之后没有边距。

**标记：**

```
<div class="foo">
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="bar">A</div>
    <div class="clear"></div>
</div> 
```

**CSS：**

```
.foo {
    background-color: #ccc;
    width: 180px;
    margin: 0 -10px;
}

.bar {
    background-color: #888;
    float: left;
    margin-left: 10px;
    width: 20px;
}

.clear {
    clear: both;
} 
```

**[活生生的例子](http://jsfiddle.net/jLvP8/)**

*它可能不是您想要的，但它至少可以作为您适应和进一步发展的起点。*

**更新：**

有更好的方法来清除浮动，可以用来代替我的示例中使用的额外元素（我只是为了简单起见）。如果有兴趣，这里有一个关于这个的[问题](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T14:49:11.200

实际上有一个很好的技巧可以使这项工作完全跨浏览器。

为您的容器提供这样的宽度，即使右侧最后一个元素有边距，您也可以将所有子元素放入其中，例如

```
#randomidContainer { 
    width: 840px;
} 
```

然后，您只需将该容器包装到另一个容器中，您就可以使用它来执行以下技巧：

```
#randomidOuterContainer { 
    width: 800px;
    border: 1px solid #000;
    overfliw: hidden;
} 
```

这将（有点）神奇地使您的内部浮动元素在一行上很好地运行，尽管右侧有可能不适合您的像素完美布局的额外边距。

# excel - 找不到 OleDB 数据提供程序 VBA/Excel

> ID：14836274
> 
> 赞同：5
> 
> 时间：2013-02-12T15:46:36.603
> 
> 标签：excel, oracle, vba, odbc, oledb

我几乎不熟悉VBA（在学校有过一些课程，就是这样）。现在我需要从 Excel 文件连接到 Oracle 数据库（在远程服务器上运行）。我环顾四周，找到了一些例子。因此，到目前为止，我已经编写了以下代码：

```
 Sub Try()
         Dim cn As New ADODB.Connection
         Dim rs As ADODB.Recordset
         Dim cmd As ADODB.Command
         Dim chunk() As Byte
         Dim fd As Integer
         Dim flen As Long
         Dim Main As ADODB.Parameter
         Dim object As ADODB.Parameter

     Stil = vbYesNo + vbCritical + vbDefaultButton1
        Titel = "db connection test"
    '   Meldung anzeigen.
        Antwort = MsgBox("trying to connect to db", Stil, Titel, Hilfe, Ktxt)

         ' Connect to the database using ODBC [msdaora][ORAOLEDB.Oracle]Provider=ORAOLEDB.Oracle;
         With cn
             .ConnectionString = "Provider=ORAOLEDB.Oracle;Password=pass;User ID=usr;Data Source=host:port:sid"
             .Open
             .CursorLocation = adUseClient
         End With

         ret = cn.Execute("create table newtesttable (main integer, object oid)")

         ' Here is an example if you want to issue a direct
    ' command to the database
         '
         'Set cmd = New ADODB.Command
         'With cmd
         '    .CommandText = "delete from MYTABLE"
         '    .ActiveConnection = cn
         '    .Execute
         'End With
         'Set cmd = Nothing

         '
         ' Here is an example of how insert directly into the
     ' database without using
         ' a recordset and the AddNew method
         '
         Set cmd = New ADODB.Command
         cmd.ActiveConnection = cn
         ' cmd.CommandText = "insert into newtesttable(main,object) values(?,?)"
         cmd.CommandText = "select * from test"
         cmd.CommandType = adCmdText

         ' The main parameter
        ' Set main = cmd.CreateParameter("main", adInteger, adParamInput)
         'main.Value = 100 '' a random integer value ''
         'cmd.Parameters.Append main

         ' Open the file for reading
         'fd = FreeFile
         'Open "myBlobFile.txt" For Binary Access Read As fd
         'flen = LOF(fd)
         'If flen = 0 Then
          '   Close
           '  MsgBox "Error while opening the file"
            ' End
         'End If

         ' The object parameter
         '
         ' The fourth parameter indicates the memory to allocate
     ' to store the object
       '  Set object = cmd.CreateParameter("object", _
       '                                       adLongVarBinary, _
       '                                       adParamInput, _
                                              flen + 100)
       '  ReDim chunk(1 To flen)
       '  Get fd, , chunk()

         ' Insert the object into the parameter object
       '  object.AppendChunk chunk()
       '  cmd.Parameters.Append object

         ' Now execute the command
         Set rs = cmd.Execute

     '   Mldg = "test"
        Stil = vbYesNo + vbCritical + vbDefaultButton1
        Titel = "asdasdasd"
    '   Meldung anzeigen.
        Antwort = MsgBox(rs, Stil, Titel, Hilfe, Ktxt)
         ' ... and close all
         cn.Close
         Close

 End Sub 
```

我相信这段代码有很多问题，但目前它在尝试执行 .Open 时失败了，也就是说， `"Provider cannot be found. It may not be properly installed"`. 之后我发现我需要下载并安装 ORAOLEDB.dll。我通过安装 ORAOledb11.dll 来做到这一点（我尝试了 32 位和 64 位，你的机器是 64 位的）。我已经通过执行安装了它`regsvr32 OraOLEDB11.dll`。

不幸的是，问题一直存在。那么，解决此问题的步骤是什么？我能以某种方式确保 Oraoledb 正确安装在我的机器上吗？

任何提示将非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-10-22T08:01:00.837

**32 位操作系统**

**通过从 Oracle 官方网站Oracle10g Provider for OLE DB Version 10.1.0.4.0** 下载 oracle OLEDB 提供程序，我设法让它在 **Windows XP**虚拟机上运行。旧操作系统的当前工作[链接](http://www.oracle.com/technetwork/database/windows/utilsoft-088126.html) OLEDB（32 位）

 **但请注意，它会将 JDK 和 JRE 替换为较低版本（可以通过配置 xml - **products.xml** - 我没有足够的心理健康药水来防止它，所以我做了完整安装）。之后您需要删除环境变量中的引用，因为它可能会影响其他程序。安装后，我用**regsvc32注册了OraOLEDBxx.dll**

我正在使用 excel 2003 连接到 oracle db 11G。:)

**连接字符串**

我必须启用扩展（ActiveX 数据对象和记录库）。我的函数返回连接是：

```
Public Function connectToDb(provider As String, host As String, sid As String, user As String, pwd As String, db As String) As ADODB.Connection
Dim conn As ADODB.Connection
Dim dbConnectStr As String

    Set conn = New ADODB.Connection
    If provider = "Oracle" Then
        dbConnectStr = "Provider=OraOLEDB.Oracle;Data Source=" & host & ":1521/" & sid & ";User Id=" & user & ";Password=" & pwd & ";"
    Else

    End If
    conn.ConnectionString = dbConnectStr
    conn.Open
    Set connectToDb = conn
End Function 
```

**64 位操作系统但 32 位 Office**

当我们的虚拟机迁移到带有**Excel 2010**的 64 位**Windows 7**时。确保您将下载**ODAC** - Oracle 数据访问组件 - 用于您的 excel 安装的正确**位**版本，因为我安装了 32 位 excel 并认为它是 64 位（因为 Windows 是 64 位）所以我正在尝试分娩使其与**64 位**ODAC 版本一起使用。之后我确实下载了**32 位版本**，它和以前一样工作。对于安装，只需按照下载的存档文件夹中包含的安装说明进行操作。

 ******Oracle 网站上 ODAC 的当前工作[链接](http://www.oracle.com/technetwork/topics/dotnet/downloads/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-26T16:19:47.727

*您可以通过创建一个以.udl*结尾的文本文件，然后关闭并打开该文件来确保您的连接字符串是准确的。系统将提示您使用用户界面连接到服务器。输入您的信息并测试连接。然后，如果您的连接正常，请关闭该文件。以文本格式打开该文件并将连接字符串复制到您的代码中。还要确保为 ADO 选择了您的参考库。这一行看起来不对：

```
Data Source=host:port:sid 
```

下面是我用来从文本中提取 sql 并将结果提取到文本的示例。

```
 Public Function ObjectConnect(AID As String, APswd As String)

 ObjectConnect = "Provider=ORAOLEDB;Password=" & APswd & ";Persist Security Info=True;User ID=" & AID & ";Data Source=(nameofserverConn)"

 End Function

Sub RunSQL()

Dim strConn As String
Dim Query As String
Dim txt As Object
Dim ns As ADODB.Connection
Dim rs As ADODB.Recordset
Dim txtfile As Object
Dim f As ADODB.Field
Dim myFileSystemObject As Object
Dim txtN As String
Dim DL As String

FName1 = ""
Query = ""
txtStrngX = ""

Set ns = New ADODB.Connection
Set rs = New ADODB.Recordset
ns.ConnectionTimeout = 99000
ns.CommandTimeout = 99000

ns.Open ObjectConnect('UserID', 'Password') 'this is a public function w. userform for people to enter ID and Password.
With rs
    .ActiveConnection = ns
      'however you're writing the sql it would go here.
    .Open Query 
End With

If rs.State <> 0 Then
    DL = Sheet1.Cells(2, 2)
    RecordsetToText rs:=rs, FullPath:=txtN, ValueDelimiter:=DL  'this is a sub function that writes to a text file.  Didn't include the code but left this.  Here you would want to do something with the recordset.
End If

On Error Resume Next
rs.Close
Set rs = Nothing

End Sub 
```********

# sql-server - 案例语句 T-SQL

> ID：14836283
> 
> 赞同：0
> 
> 时间：2013-02-12T15:47:08.957
> 
> 标签：sql-server, tsql, case

下面的脚本一切正常，直到我尝试添加带有 SELECT 子句的 Case 语句 我已经这样做以使用正确的日期自动填充表，可以让我知道我做错了什么吗？

```
DECLARE @PitchType_Skey INT
DECLARE @Site_Skey INT
DECLARE @Capacity INT
DECLARE @StartDate DATE
DECLARE @EndDate DATE

SET @PitchType_Skey = 1
SET @Site_Skey = 1
SET @Capacity = 0

WHILE (@Site_Skey < 127)

BEGIN
    IF @PitchType_Skey = 8

BEGIN

SET @PitchType_Skey = 1
SET @Site_Skey = @Site_Skey + 1

END

IF (@Site_Skey < 127)

BEGIN

Set @Capacity = (SELECT SiteWeighting From Site Where Site_Skey = @Site_Skey)
Set @Capacity = @Capacity * (SELECT PitchTypeWeighting From PitchType  Where PitchType_Skey = @PitchType_Skey)
Set @Capacity = @Capacity * ((10*(100+((RAND()*40)-20)))*0.01)

     INSERT INTO Capacity 
     SELECT
     CASE @StartDate
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 1 THEN 01/05/2010) ELSE,
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 2 THEN 01/04/2010) ELSE,
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 3 THEN 01/04/2010) ELSE,
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 4 THEN 01/01/2010) ELSE,

     CASE @EndDate
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 1 THEN 30/09/2010) ELSE,
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 2 THEN 01/11/2010) ELSE,
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 3 THEN 01/11/2010) ELSE,
     WHEN (SELECT SiteWeighting FROM Site WHERE SiteWeighting = 4 THEN 01/12/2010) ELSE,

      round(@Capacity,0) as Capacity,
      @PitchType_Skey, @Site_Skey

END
  SET @PitchType_Skey = @PitchType_Skey + 1

END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T15:50:10.813

好吧，你的括号放错了地方。 `THEN`是 case 语句的一部分，但您在子查询中拥有它。您也只需要`ELSE`每个案例陈述一个。

如果不了解更多关于您的表的信息，很难知道是否还有更多错误，但语法正确的 case 语句看起来像这样：

```
CASE @StartDate
  WHEN (SELECT SiteWeighting FROM Site WHERE Site_SKey=@Site_SKey)=1 THEN '01/05/2010'
  WHEN (SELECT SiteWeighting FROM Site WHERE Site_SKey=@Site_SKey)=2 THEN '01/04/2010'
  ELSE NULL 
END 
```

但是，我强烈建议您不要为此使用 case 语句。相反，请使用其他东西，例如带有开始和结束日期的查找表，您可以基于`SiteWeighting`. 它会让你的生活轻松很多。

# javascript - 同步访问由异步请求填充的结构

> ID：14836284
> 
> 赞同：-2
> 
> 时间：2013-02-12T15:47:22.163
> 
> 标签：javascript, jquery, asynchronous

我正在尝试为在 JS/jQuery 中实现的应用程序提供状态值字典。这些值必须从服务器（ajax）中获取。我想以异步方式执行此操作，以便可以在初始化期间启动该请求。对值的实际访问应该稍后同步完成，以使代码易于理解。（非常）简化的代码目前如下所示：

初始化：

```
$(document).ready(function(){
    Status.fetch();
}) 
```

结构：

```
Status:{
    Valid:new $.Deferred(),
    Server:{},
    /* ... */
    fetch:function(){
        if (Status.Valid.isResolved()){
            // status already present due to a past request
            return Status.Valid.promise();
        }else{
            // fetch status information from server
            $.ajax({
                type:     'GET',
                url:      'status.php'),
                cache:    true,
                dataType: 'json'
            }).done(function(response){
                $.each(response,function(key,val){
                    Status.Server[key]=val;
                });
                Status.Valid.resolve(Status.Server);
            }).fail(function(response){
                Status.Valid.reject(NaN);
            });
            return Status.Valid.promise();
        }
    }, // Status.fetch
    getServerAspect:function(aspect){
        $.when(
            Status.fetch()
        ).done(function(server){
            return server[aspect];
        }).fail(function(server){
            return NaN;
        })
        /* whyever: processing always comes here, which I don't understand... */
    }, // Status.getServerAspect
} // Status 
```

`Status.Server`由 ajax 调用填充（有效）。是允许同步访问存储在结构`Status.getServerAspect()`中的方面的方法的示例（这*不起作用*）。`Status.Server`

 *基本思想是结构的异步填充在结构被访问之前运行。每个（同步）访问都意味着要么立即返回所引用的方面，要么阻塞直到该值出现。但是无论我在里面尝试什么风格`Status.getServerAspect()`，该方法都会立即返回，而没有我可以在调用范围内使用的任何方面值。

我显然很难理解使用延迟对象的基本概念。我一直使用它们进行同步处理，就像魅力一样。但这意味着您必须在整个应用程序中使用异步样式。对于这个特殊功能，我更喜欢同步风格，以便条件表达式保持简单：

```
if ('somevalue'==Status.getServerAspect('someaspect'))
    ...do something... 
```

在异步和同步处理之间建立“桥梁”的技巧是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T13:50:54.993

这将起作用，因为 setTimeout(...) 调用（异步时）仅确保 Status.Valid.state(); 通话并不经常进行。它仍然是一个繁忙的等待，它不仅会阻塞线程（因此，不应该在 WebWorker 之外完成）而且还会从你的 CPU 中窃取空闲时间。实际上，与其使用这种方法，不如使用同步 AJAX 请求是更好的解决方案。在为呼叫者阻塞时，不会是忙等待。但是，如果可以，您仍然应该使用纯异步实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:02:23.067

让 getServerAspect 简单地返回承诺，然后使用它。

```
getServerAspect: function(){
    return Status.Valid.promise();
} 
```

现在您可以将其用于：

```
Status.getServerAspect().done(function(data){
    if (data.someaspect == 'somevalue') {
        // do something, but don't return!
    }
}) 
```

这就是异步代码的工作方式。

您也可以将其抽象为函数，但我发现它更难阅读。

```
Status.getServerAspect: function(aspect,callback){
    Status.Valid.promise().done(function(data){
        callback(data[aspect]);
    })
} 
```

现在你可以像这样使用它：

```
Status.getServerAspect('someaspect',function(value) {
    if ( 'somevalue' == value ) {
        // do something but don't return!
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:06:53.893

很难调用异步进程并尝试使其同步，最简单的方法是将函数分成两部分；一个在异步调用之前和一个之后。

我发现最好的方法是使用 Promise 模式，或者您可以尝试使用调解器并将一系列事件传递给它，以由您的流程的每一步触发：

[用于不同进程使用的多个 xmlhttprequest 的良好模式](https://stackoverflow.com/questions/14440809/good-pattern-to-use-for-multiple-xmlhttprequests-used-by-different-processes)

据我所知，JavaScript 并没有像其他语言那样真正具有暂停或等待功能。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-12T15:53:12.157

在`$.ajax`请求中，您可以将`async`属性设置为 true 或 false，或将其传递给您的函数

```
 $.when(
     Status.fetch(true) 
```

示例见下文

```
 Status:{
          Valid:new $.Deferred(),
           Server:{},
           /* ... */
          fetch:function(asyncType){      /// boolean passed as param
             if (Status.Valid.isResolved()){
             // status already present due to a past request
             return Status.Valid.promise();
             }else{
            // fetch status information from server
        $.ajax({
            type:     'GET',
            url:      'status.php'),
            cache:    true,
            dataType: 'json',
            async: asyncType /////// will be true or false
        }).done(function(response){
            $.each(response,function(key,val){
                Status.Server[key]=val;
            });
            Status.Valid.resolve(Status.Server);
        }).fail(function(response){
            Status.Valid.reject(NaN);
        }); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-02-17T11:38:00.337

我想分享我最终找到的解决方案。这不是一件优雅的事情，但它以积极的方式回答了最初的问题。因此，它提供了一种根据请求组合异步和同步访问的方法。

我认为添加这个答案是有意义的，因为所有其他贡献者都声称这根本不可能。

所需要的只是实现一个阻塞例程，以确保仅在异步检索的数据结构可用时才返回请求的值。所以这里没有魔法，最后只是一个简单的“等待”策略：

```
getServerAspect:function(aspect){
    /* the state of the asynchronous retrieval attempt */
    var resolution=Status.Valid.state();
    while ("pending"==resolution) {
        setTimeout(function(){resolution=Status.Valid.state();},500);
    }
    /* asynchronous retrieval has finished */
    if ("resolved"==resolution){
        /* return vaule should be available */
        return server[aspect];
    }else{
        /* data could not be retrieved, something is borked */
        return NaN;
    }
}, // Status.getServerAspect 
```

[这个函数很简单，是从内存中写出来的，因为我的现实世界的解决方案更复杂。]

实际上，该功能在等待解决方案时会阻止 gui。这并不优雅，是的，但请注意，在原始文件中明确要求阻止行为。在正常情况下，检索应该在请求服务器方面之前很久就完成了，因此“通常”没有阻塞。对于那些不是这种情况的情况，我更愿意等待半秒，因为即使在异步处理中，最终操作也会延迟到检索完成。

这种阻塞策略使我可以使其余代码更简单、更易于阅读，因为我不必一直使用匿名函数。相反，我可以简单地在一个简单的条件语句中访问值：

```
if ("expected"==Status.getServerAspect('someaspect')){
    /* do something */
} 
```*

# c# - 需要一个依赖属性在基类中是静态的

> ID：14836289
> 
> 赞同：1
> 
> 时间：2013-02-12T15:47:34.090
> 
> 标签：c#, wpf, mvvm, dependency-properties, .net-4.5

我已从 WPF 应用程序中的 CLR 属性转移到依赖项属性。我有一个问题，以下代码位于我需要从各种其他视图模型访问的基类中。当它是 CLR 属性时，它是静态的，但现在不是，因此在未设置它的视图模型中始终返回 null。有办法解决这个问题吗？

```
 public Tuple<Guid, string> SelectedEntity
    {
        get { return (Tuple<Guid, string>)GetValue(SelectedEntityProperty); }
        set { SetValue(SelectedEntityProperty, value); }
    }

    public static readonly DependencyProperty SelectedEntityProperty =
        DependencyProperty.Register("SelectedEntity", typeof(Tuple<Guid, string>), typeof(MyViewModelBase), new PropertyMetadata(null)); 
```

# visual-studio-2012 - 无法在 VS 2012 中打开 .sdf 文件：未指定的错误

> ID：14836290
> 
> 赞同：4
> 
> 时间：2013-02-12T15:47:37.717
> 
> 标签：visual-studio-2012, sql-server-ce, orchardcms

我正在尝试在 Visual Studio Web Express ***2012***中打开一个 .sdf 文件。这是我当地的果园环境，但我想这并不重要，因为我在谷歌搜索时发现了这个错误。但是我只找到了适用于 Visual Studio 2010 及更低版本的解决方案，因此它们似乎不适用于我，因为它们通常包括为 SQL Server Compact 安装 Visual Studio 2010 工具。这显然不适用于 2012 年。

这是我尝试直接从 VS 解决方案资源管理器打开文件时出现的错误：

![未指定的错误](../Images/b8a59750f87b3cbbfa57ddca730de8b9.png)

有没有搞错？

当我尝试配置数据连接时，SQL Server Compact 不存在：

![配置新的数据连接](../Images/acf421fd39aed9b12490ccf92415589c.png)

我尝试通过 Web 平台安装程序重新安装 SQL Server Compact Latest，但这并没有帮助。但是，我可以在 LinqPad 中打开数据库：

![LinqPad 中的 Orchard.sdf](../Images/ed9915f0b2f81fa86fb893a6f9c7ad24.png)

关于 Visual Studio 2012 发生了什么的任何想法？

谢谢

PS：对不起，如果我在某处忽略了解决方案。只睡了2个小时左右。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T19:49:23.070

看看这个[MSDN 论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/csharpide/thread/d2312f94-a547-4bda-abae-e8c0fe407c9e/)。它与您的情况不完全匹配，但我相信这个特定问题与源代码控制有关，而不是与您正在使用的语言有关。

关于该做什么的答案大约是该帖子的 2/3。

> 因此，我取消了项目的绑定（选择解决方案文件，然后选择文件 -> 源代码管理 -> 高级 -> 更改源代码管理），然后重新绑定它们。

经过一些额外的调查，我发现这个问题可能与 .suo 文件有关。 [这个 SO 答案](https://stackoverflow.com/a/161261/1345223)表明 .suo 文件实际上是一次性的，因此您可以关闭您的解决方案；删除.suo；重新打开解决方案，“未指定的错误”应该会消失。

我已经尝试了这两种方法（取消绑定 | 绑定）并删除了 .suo 文件，它们都对我有用。

# html - 即使 z-index 较高，点击/触摸链接也会冒泡

> ID：14836294
> 
> 赞同：1
> 
> 时间：2013-02-12T15:47:55.090
> 
> 标签：html, css, z-index

我有一个相对于非常高的 z-index 定位的链接，但是在 android 和 ios 浏览器中点击链接会使链接下方的元素被点击、点击。

这里的风格，

```
li a {
background: linear-gradient(to right, #A5A5A5 0%, #EDEDED 50%, #A5A5A5 100%) repeat scroll 0 0 transparent;
color: #254FAA !important;
display: block;
height: 40px;
position: relative;
z-index: 9999; 
```

}

这里可能有什么问题，请注意在桌面上使用鼠标单击就可以了

# repository - 实体框架无法获取实体并给出“对象的键不匹配..”错误

> ID：14836295
> 
> 赞同：3
> 
> 时间：2013-02-12T15:47:58.333
> 
> 标签：repository, domain-driven-design, entity-framework-5

我被困在我的项目中，非常感谢任何帮助。我正在使用**EF 5 Code-First**方法。

这是我的基本实体：

```
...
public virtual Guid Id
    {
        get
        {
            return _id;
        }
        protected set { }

    }

public virtual bool IsEnabled { get; set; }
... 
```

我的实体：

```
...
public string CountryName { get; set; }
public string CountryCode { get; set; }
public Coordinate CountryCoordinate { get; set; }
public virtual ICollection<City> Cities
{
    get
    {
        if (_cities == null)
        {
            _cities = new HashSet<City>();
        }

        return _cities;
    }
    private set
    {
        _cities = new HashSet<City>(value);
    }
}
... 
```

它的配置：

```
public CountryEntityConfiguration()
{
this.HasKey(c => c.Id);

this.Property(c => c.CountryName)
    .HasMaxLength(64)
    .IsRequired();

this.Property(c => c.CountryCode)
    .HasMaxLength(4)
    .IsRequired();

this.HasMany(c => c.Cities)
    .WithRequired()
    .HasForeignKey(ci => ci.CountryId)
    .WillCascadeOnDelete(true);
} 
```

存储库还有其他东西，坐标值对象和城市的复杂类型等。

现在，当我尝试通过 CountryRepository 调用 GetEntity(Guid Id) 时，我收到一条错误消息：

> 作为对象键一部分的属性值与存储在 ObjectContext 中的相应属性值不匹配。如果作为键的一部分的属性返回不一致或不正确的值，或者在对作为键的一部分的属性进行更改后未调用 DetectChanges，则可能会发生这种情况。

我进行了很多搜索，但每个答案都是关于组合 PK、空列等。在测试时，我为 DB 播种，可以看到行和列都可以。

那么我做错了什么，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T16:35:54.270

好的，我终于可以弄清楚了。这是导致问题的带有空设置器的实体库。不知何故（可能是下班后）我跳过了 ID 的 setter 函数。所以将 _id = value 添加到 Id 属性解决了这个问题。呸..！

```
public virtual Guid Id
{
    get { return _id; }
    protected set { _id = value }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-05T13:10:17.150

我有相同的异常消息，但原因却截然不同。我有一个字符串 Id 列被尾随空格污染。尝试查看您在 Id 列中的值是否包含空格。

# javascript - 如何使用 gmaps.js

> ID：14836296
> 
> 赞同：-1
> 
> 时间：2013-02-12T15:47:59.673
> 
> 标签：javascript, google-maps, gmaps.js

我最近一直在玩 gmaps.js。但是，我无法让它工作。

这是代码。

在标题中，我导入了这三个文件：

[http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js)

[http://maps.google.com/maps/api/js?sensor=true](http://maps.google.com/maps/api/js?sensor=true)

gmaps.js

```
<div id="mouse_event_map"></div>

<script type="text/javascript">
/**
 * Mouse Events on Maps
 */
$(document).ready(function(){
 var map = new GMaps({
    el: '#mouse_event_map',
    lat: 51.5073346,
    lng: -0.1276831,
    zoom: 12,
    zoomControl : true,
    zoomControlOpt: {
        style : 'SMALL',
        position: 'TOP_LEFT'
    },
    panControl : false,
    click: function(e){
      alert('Click event');
    },
    dragend: function(e){
      alert('Drag Event');
    }
  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:56:00.317

gmaps.js[文档](http://hpneo.github.com/gmaps/examples/map_events.html)显示

```
map = new GMaps({
  div: '#map',
  zoom: 16,
  lat: -12.043333,
  lng: -77.028333,
  click: function(e) {
    alert('click');
  },
  dragend: function(e) {
    alert('dragend');
  }
}); 
```

请注意，这使用`div`而不是`el`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-02T17:41:36.207

我只是在同一个问题上苦苦挣扎——地图没有出现，我正在按照“T”的教程进行操作......

通过从 'el:' 声明中删除 '#' (ID) 符号，我得到了我的地图。这可能有助于寻找答案的人。仍然使用 id - 应该显示地图。

## 前任。

埃尔：'#map'，

## 变成：

el: '地图',

# emacs - Emacs 保存缓冲区键绑定？

> ID：14836298
> 
> 赞同：0
> 
> 时间：2013-02-12T15:48:02.757
> 
> 标签：emacs

有没有替代`C-x C-s`保存在 Emacs 中的方法？我的 VT520 终端`C-s`用于滚动锁定并给出奇怪的行为。或者，我可以对其重新编程或将 VT520 重新编程为另一个键绑定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T15:51:55.773

你可以手动运行它`M-x save-buffer`。但是我会尝试修复您的终端，因为`search-forward`如果您没有，您也会错过`C-s`，这是在 emacs 用户之间导航缓冲区的首选命令之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T22:01:33.147

您可以在 Emacs 中为任何命令定义自己的键绑定。例如，要为 进行`CTRL+x CTRL+z`额外的键绑定`save-buffers`，请将以下内容放入您的 .emacs 文件中：

```
(global-set-key (kbd "C-x C-z") 'save-buffers) 
```

请注意您选择的键绑定：某些模式可能会覆盖它们。

另请参阅[此处](http://www.gnu.org/software/emacs/manual/html_node/emacs/Init-Rebinding.html#Init-Rebinding)了解更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T19:21:24.680

我在我的 .bashrc 中禁用了 XON/XOFF（应该适用于任何 shell，但可能不是每个终端）：

```
# this stops C-s from freezing the terminal
if [ "$TERM" != "dumb" ] ; then
    stty -ixon
fi 
```

# c# - 使用 WriteableBitmapEx 的 Sobel 算子和卷积

> ID：14836299
> 
> 赞同：3
> 
> 时间：2013-02-12T15:48:03.410
> 
> 标签：c#, edge-detection, writeablebitmap, writeablebitmapex

因此，我将 WriteableBitmapEx 用于 Windows RT 上的应用程序。我正在尝试使用 sobel 运算符对图像进行边缘检测。我已经使用 .Convolute() 成功地将用于 x 和 y 检测的两个内核应用到图像上，但现在我坚持将两个图像都添加到一个图像中。问题是，这两个图像的所有像素似乎都具有透明度值 0（因此 ARGB 中的 A）。我可以毫无问题地单独显示这两个图像，但是添加它们只会给我一张黑色的图片。所以我的问题是：

*   为什么卷积后每个像素的透明度都设置为0？
*   为什么我仍然可以显示图像而不是全黑？
*   为什么我添加两个图像时它是黑色的？
*   有没有更好的方法来组合两个图像？Blit unfortunatley 似乎不支持这种像素添加。但是 ForEach 真的很慢......

为了进行校准，到目前为止，这是我的代码。我可以同时显示 wbmpY 和 wbmpX，但 finalbmp 完全是黑色的。

```
 public int[,] sobelY = new int[3, 3] { { 1, 2, 1 }, { 0, 0, 0 }, { -1, -2, -1 } };
    public int[,] sobelX = new int[3, 3] { { -1, 0, 1 }, { -2, 0, 2 }, { -1, 0, 1 } };

    public void trim(WriteableBitmap wbmp)
    {
        var graybmp = wbmp.Clone();
        graybmp.ForEach(toGrayscale);

        var wbmpY = graybmp.Clone();
        var wbmpX = graybmp.Clone();

        wbmpY = wbmpY.Convolute(sobelY, 1, 0);
        wbmpX = wbmpX.Convolute(sobelX, 1, 0);

        var finalbmp = combineSobel(wbmpX, wbmpY);           
     }

    public WriteableBitmap combineSobel(WriteableBitmap img, WriteableBitmap img2)
    {
        int height = img.PixelHeight;
        int width = img.PixelWidth;
        WriteableBitmap result = img.Clone();
        for (int x = 0; x < width; x++)
        {
            for (int y = 0; y < height; y++)
            {
                Color imgColor = img.GetPixel(x, y);
                Color img2Color = img2.GetPixel(x, y);
                Color newColor = Color.FromArgb(
                    Math.Min((byte)Math.Sqrt(Math.Pow(imgColor.A, 2) + Math.Pow(img2Color.A, 2)), (byte)255),
                    Math.Min((byte)Math.Sqrt(Math.Pow(imgColor.R, 2) + Math.Pow(img2Color.R, 2)), (byte)255),
                    Math.Min((byte)Math.Sqrt(Math.Pow(imgColor.G, 2) + Math.Pow(img2Color.G, 2)), (byte)255),
                    Math.Min((byte)Math.Sqrt(Math.Pow(imgColor.B, 2) + Math.Pow(img2Color.B, 2)), (byte)255)
                );

                result.SetPixel(x, y, newColor);
            }
        }
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:34:31.670

卷积应用于所有可用通道。不仅处理红色、绿色和蓝色（在这种情况下是您想要的），而且还处理 Alpha 通道。这导致 alpha 值为零（100% 透明）。考虑以下示例：

```
1 0 -1 255 255 255
2 0 -2 超过 255 255 255
1 0 -1 255 255 255

```

```
1*255 0*255 -1*255 255 0 -255
2*255 0*255 -2*255 = 510 0 -510
1*255 0*255 -1*255 255 0 -255

2*255 + 510 + 3*0 - 2*255 - 510 = 0 对于所有像素

```

从技术上讲，一切都很好，它没有检测到 alpha 通道上的任何边缘。但是，在这种情况下，这不是您想要的功能。如果不需要这种行为，您可以跳过处理 Alpha 通道（如果源允许）或之后将 Alpha 重置为 255。

我将推测将在屏幕上显示的黑色图像，因为我没有使用技术的经验。许多框架首先将图像重置为纯色（假设在这种情况下它是黑色）。这是必需的，这样如果您正在处理透明图像（或其中的一部分），前一个图像就不会渗出。将卷积（透明）图像添加到此纯色中，将产生相同的纯色。因此，图像将显示为全黑。

注意：combineSobel 使用所有通道，但由于之前已转换为灰度，您可能需要优化颜色的创建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:02:47.627

> 有没有更好的方法来组合两个图像？Blit unfortunatley 似乎不支持这种 >pixel-adding。但是 ForEach 真的很慢......

出于这个原因，您应该使用不安全代码，请查看：[为什么我的不安全代码块比我的安全代码慢？](https://stackoverflow.com/questions/2760564/why-is-my-unsafe-code-block-slower-than-my-safe-code)

至于速度问题，请考虑为每个像素调用 16 个函数（4xMath.Min、4xMath.Pow、4xMath.Sqrt）。这是一个巨大的开销。

像素值在 [0,255] 范围内 Math.Pow([0,255],2) + Mat.Pow([0,255],2) 结果在 [0,2*Math.Pow(255,2)] 范围内=> [0,130 050] 我会构建一个这样的查找表：

```
byte[] LUT4Sqrt = new byte[130051];

for (int i = 0; i < 130051; i++)
{
    LUT4Sqrt[i] = (byte)(Math.Sqrt(i));
} 
```

也可以制作 Math.Pow 的查找表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T22:23:16.037

您的代码中有两个问题：

1）我尝试了卷积方法对我不起作用 - 它只会创建一个空图像。我想这不是你的错。当您合并 2 个空图像时，您会得到一个空图像。

2）您的组合实现存在一个小问题。您可以在不使用 sqrt calc 的情况下将透明度设置为 255，就像在 r、g、b 上所做的那样

希望这可以帮助

# com - 在 VB.Forms.Add 调用 COM 时出现错误 -2147417848

> ID：14836304
> 
> 赞同：2
> 
> 时间：2013-02-12T15:48:15.103
> 
> 标签：com, vb6

我有一个引用 VB6 旧版 DLL 的 .NET 应用程序。旧版 DLL 有一个带有公共方法的类。在这个公共方法中，它试图按名称查找现有表单，或者如果它不存在则创建它：

```
Set objForm = GetForm(strFormName)

If objForm Is Nothing Then

    'Creates a new instance of the form
    Set objForm = VB.Forms.Add(strFormName)

End If 
```

...在哪里`GetForm`：

```
Private Function GetForm(ByVal strFormName As String) As Form

    Dim objForm As Form

    For Each objForm In VB.Forms
        If objForm.Name = strFormName Then
            Set GetForm = objForm
            Exit Function
        End If
    Next

    Set GetForm = Nothing

End Function 
```

它在这一行引发了一个错误：

```
Set objForm = VB.Forms.Add(strFormName) 
```

错误是：

```
Automation error
The object invoked has disconnected from its clients.   
Error#-2147417848(80010108) 
```

请注意，这`strFormName`是一个有效的表单名称，并且此公共方法调用*几乎一直*有效。它只是偶尔会引发此错误。

我想知道是什么导致了这个错误，或者我还能做些什么来进一步追踪它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T03:14:15.197

@Dabblernl 链接的[知识库文章](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q319832)与此问题非常相关。VB.Forms 集合正是这样一个不合格的参考。它就像一个全局变量，您可以在 VB6 代码中的任何地方使用 VB.Forms，而无需提供对象引用。

在底层，VB6 运行时会在您第一次创建表单时创建 Forms 集合并存储此集合对象，以便将来对 VB.Forms 的引用使用完全相同的集合。错误代码的意思是您在该集合*被销毁后使用它*。

何时发生这种情况还不是很清楚，这都是 VB6 运行时支持库的内部管道。但通常情况下，VB6 应用程序会在最后一个表单被卸载时终止。您的情况不同的是，您的进程的生命周期不再由 VB6 运行时控制。.NET 现在控制它。

因此，据此推断，VB6 运行时很有可能已决定不再需要 Forms 集合并将其销毁，并且您的 .NET 代码稍后可能会创建一个新的 Form，从而触发错误。

如果这完全准确，那么您需要采取对策来防止这种情况发生。一种可能的方法是确保始终存在至少一个 VB6 表单以保持集合有效。它不必是可见的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:40:08.633

如果问题是间歇性的并且很少如 OP 中所述，重试可能会解决它：

```
Public Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)

Public Sub SomeProcedure()
Dim attempts As Integer
On Error Goto ErrHandler

    Set objForm = GetForm(strFormName)
    If objForm Is Nothing Then

        'Creates a new instance of the form
        Set objForm = VB.Forms.Add(strFormName)

    End If

ErrHandler:
    If Err.Number = -2147417848 Then
        attempts = attempts + 1
        If attempts < 10 Then
            Err.Clear
            Sleep 55
            Debug.Print "Automation error. Retry attempt: " & attempts
            Resume
        End If
    End If
    If Err.Number <> 0 Then 'this should run after the 10th failed attempt
        MsgBox Err.Message
        Err.Clear
    End If
End Sub 
```

它没有解决问题，但它可能会阻止您的应用程序因此而崩溃......

# mysql - 优化查询创建索引以从查询计划中使用临时和使用文件排序删除

> ID：14836305
> 
> 赞同：1
> 
> 时间：2013-02-12T15:48:17.447
> 
> 标签：mysql, innodb, indexing, explain

我有这个查询，我已经优化了它的运行时间是一开始的一半。

现在我想改进它创建一些索引的执行，但还没有找到方法。

查询是：

```
SELECT straight_join CONCAT(IFNULL(u.nombre,''), ' ', IFNULL(u.apellidos,''), ' ', IFNULL(u.apellido2,''), ' ; ', IFNULL(u.correo,''), ' ; ', IFNULL(u.telefono,''), ' ', 
                            IFNULL(u.horario,''), ' ; ', IFNULL(u.telefono2,''), ' ', IFNULL(u.horario2,''), ' ; ', IFNULL(u.fecha_prox_llamada,'')) AS datos, 
        usuariohist1.web, usuariohist1.comentario, u.usuario_id, estad.estad_id, 
        estad.fecha, estad.tipoinf, estad.web_id, estad.procede, estad.convocatoria_id, eventos.evento as curso, 
        centros.centro, centros.centro_id 
    FROM centros 
    INNER JOIN convocatorias ON centros.centro_id = convocatorias.centro_id  
    INNER JOIN eventos ON eventos.evento_id = convocatorias.evento_id 
    INNER JOIN estad ON estad.convocatoria_id = convocatorias.convocatoria_id 
    INNER JOIN usuarios AS u ON estad.usuario_id = u.usuario_id 
    LEFT JOIN (select web, comentario, usuario_id FROM usuariohist order by fecha desc, id desc ) as usuariohist1       
        ON u.usuario_id = usuariohist1.usuario_id OR u.n_usuario = usuariohist1.usuario_id 
WHERE centros.segcupones = 1 and u.fecha_prox_llamada = '2013-02-13' 
    group by u.usuario_id, estad.web_id, estad.convocatoria_id 
    order by estad.fecha desc \G 
```

执行计划是：

```
*************************** 1\. row ***************************
           id: 1
  select_type: PRIMARY
        table: centros
         type: ALL
possible_keys: PRIMARY,centro_id,centro_id_2
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 2622
        Extra: Using where; Using temporary; Using filesort
*************************** 2\. row ***************************
           id: 1
  select_type: PRIMARY
        table: convocatorias
         type: ref
possible_keys: PRIMARY,FK_convocatorias_evento_id,FK_convocatorias_centro_id
          key: FK_convocatorias_centro_id
      key_len: 3
          ref: formaweb_op.centros.centro_id
         rows: 66
        Extra: Using where
*************************** 3\. row ***************************
           id: 1
  select_type: PRIMARY
        table: eventos
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: formaweb_op.convocatorias.evento_id
         rows: 1
        Extra: 
*************************** 4\. row ***************************
           id: 1
  select_type: PRIMARY
        table: estad
         type: ref
possible_keys: FK_Estad_Convocatorias,FK_Estad_Usuarios
          key: FK_Estad_Convocatorias
      key_len: 4
          ref: formaweb_op.convocatorias.convocatoria_id
         rows: 4
        Extra: 
*************************** 5\. row ***************************
           id: 1
  select_type: PRIMARY
        table: u
         type: eq_ref
possible_keys: PRIMARY,usuario_id
          key: PRIMARY
      key_len: 4
          ref: formaweb_op.estad.usuario_id
         rows: 1
        Extra: Using where
*************************** 6\. row ***************************
           id: 1
  select_type: PRIMARY
        table: <derived2>
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 23971
        Extra: 
*************************** 7\. row ***************************
           id: 2
  select_type: DERIVED
        table: usuariohist
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 28594
        Extra: Using filesort
7 rows in set (0.48 sec) 
```

我在 centros 表（centro_id、centro、segcupones）上创建了一个覆盖索引，但性能没有提高（或几乎没有提高）。现在执行计划显示使用索引但也使用临时和文件排序。

```
*************************** 1\. row ***************************
           id: 1
  select_type: PRIMARY
        table: centros
         type: index
possible_keys: PRIMARY,centro_id,centro_id_2,centro_id_3
          key: centro_id_3
      key_len: 307
          ref: NULL
         rows: 2873
        Extra: Using where; Using index; Using temporary; Using filesort
*************************** 2\. row ***************************
           id: 1
  select_type: PRIMARY
        table: convocatorias
         type: ref
possible_keys: PRIMARY,FK_convocatorias_evento_id,FK_convocatorias_centro_id
          key: FK_convocatorias_centro_id
      key_len: 3
          ref: formaweb_op.centros.centro_id
         rows: 66
        Extra: Using where
*************************** 3\. row ***************************
           id: 1
  select_type: PRIMARY
        table: eventos
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: formaweb_op.convocatorias.evento_id
         rows: 1
        Extra: 
*************************** 4\. row ***************************
           id: 1
  select_type: PRIMARY
        table: estad
         type: ref
possible_keys: FK_Estad_Convocatorias,FK_Estad_Usuarios
          key: FK_Estad_Convocatorias
      key_len: 4
          ref: formaweb_op.convocatorias.convocatoria_id
         rows: 4
        Extra: 
*************************** 5\. row ***************************
           id: 1
  select_type: PRIMARY
        table: u
         type: eq_ref
possible_keys: PRIMARY,usuario_id
          key: PRIMARY
      key_len: 4
          ref: formaweb_op.estad.usuario_id
         rows: 1
        Extra: Using where
*************************** 6\. row ***************************
           id: 1
  select_type: PRIMARY
        table: <derived2>
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 23971
        Extra: 
*************************** 7\. row ***************************
           id: 2
  select_type: DERIVED
        table: usuariohist
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 28594
        Extra: Using filesort
7 rows in set (0.54 sec) 
```

我还为表 usuariohist (DERIVED) 创建了索引，但没有成功，查询计划仍然相同。我试过这些索引：(fecha, id), (usuario_id, fecha, id) 和一个覆盖索引 (usuario_id, fecha, id, web, comentario)。

所涉及表的索引：

```
CREATE TABLE `centros` (

    ...FIELDS...

  PRIMARY KEY (`centro_id`),
  KEY `FK_Centros_Aux_Paises` (`pais_id`),
  KEY `FK_Centros_Aux_Provincias` (`provincia_id`),
  KEY `FK_Centros_Centros_Grupo` (`grupo_id`),
  KEY `centro_id_2` (`centro_id`,`tipouniversidad`),
  KEY `centro_id` (`centro_id`,`padre_id`,`provincia_id`),
  KEY `centro_id_3` (`centro_id`,`centro`,`segcupones`),
  CONSTRAINT `FK_Centros_Aux_Paises` FOREIGN KEY (`pais_id`) REFERENCES `aux_paises` (`pais_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_Centros_Aux_Provincias` FOREIGN KEY (`provincia_id`) REFERENCES `aux_provincias` (`provincia_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_Centros_Centros_Grupo` FOREIGN KEY (`grupo_id`) REFERENCES `centros_grupo` (`grupo_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=3373 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci

CREATE TABLE `convocatorias` (

    ...FIELDS...

  PRIMARY KEY (`convocatoria_id`),
  KEY `FK_Convocatorias_Centros` (`centro_id`),
  KEY `FK_Convocatorias_Eventos` (`evento_id`),
  CONSTRAINT `FK_Convocatorias_Centros` FOREIGN KEY (`centro_id`) REFERENCES `centros` (`centro_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_Convocatorias_Eventos` FOREIGN KEY (`evento_id`) REFERENCES `eventos` (`evento_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 

CREATE TABLE `eventos` (

    ...FIELDS...

  PRIMARY KEY (`evento_id`),
  KEY `evento` (`evento`,`temario`(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci

CREATE TABLE `estad` (

    ...FIELDS...

  CONSTRAINT `FK_Estad_Convocatorias` FOREIGN KEY (`convocatoria_id`) REFERENCES `convocatorias` (`convocatoria_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_Estad_Usuarios` FOREIGN KEY (`usuario_id`) REFERENCES `usuarios` (`usuario_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=360851 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci

CREATE TABLE `usuarios` (

    ...FIELDS...

  PRIMARY KEY (`usuario_id`),
  KEY `FK_Usuarios_WEBS` (`web_id`),
  KEY `usuario` (`usuario`,`clave`),
  KEY `usuario_id` (`usuario_id`,`web_id`),
  CONSTRAINT `FK_usuarios_web_id` FOREIGN KEY (`web_id`) REFERENCES `webs` (`web_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=256323 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci

CREATE TABLE `usuariohist` (

    ...FIELDS...

  PRIMARY KEY (`id`),
  KEY `usuario_id` (`usuario_id`,`fecha`,`id`),
  KEY `usuario_id_2` (`usuario_id`,`fecha`,`id`,`web`,`comentario`(255))
) ENGINE=InnoDB AUTO_INCREMENT=28153 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

任何人都知道我如何优化这个查询创建索引，请解释解决方案。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:09:29.117

只是几个指针 - 我现在没有时间进行全面分析：

对于任何要发挥其最大潜力的查询，如果提供了明确的值，那么如果它们驱动查询，将会有极大的帮助。**您的查询具有centros.segcupones**和**u.fecha_prox_llamada**
的特定值，但最后一个没有索引，第一个只有联合索引，因此您的第一个停靠港是为**u.fecha_prox_llamada**创建索引，然后也许看看**centros.segcupones**上的单个索引是如何运行的。

 ******* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:07:37.193

索引问题的内容太多了...无论如何...您应该索引所有主键和外键，以及您加入的任何内容...如果您加入日期，您也可以在该字段上建立索引。另请记住，您将希望从组级别索引到成员级别，因此如果您说三个字段标识一个成员，您将希望使用这三个字段来索引，例如。ClientCd - ID - Sub_ID 一起将创建一个代理键和一个唯一标识符，您可能希望对所有这三个字段进行索引，以使数据库搜索尽可能高效，同时忽略有关该人的任何人口统计信息......******

# c++ - 如何在sql表中找到str

> ID：14836309
> 
> 赞同：0
> 
> 时间：2013-02-12T15:48:30.587
> 
> 标签：c++, sqlite, embedded-linux

代码只需要让调用者知道是否`path`在表中。下面的 c++ 代码正确使用但仅在短时间内完成了此操作，然后就死了`select count(*)`。`sqlite3_get_table`sqlite3_get_table 显然存在问题。[这里](https://stackoverflow.com/questions/7402720/alternative-to-sqlite3-get-table)有一个非常相似的问题但我不知道如何将此答案应用于我的问题。我已经阅读了 sqlite 文档并完成了 sqlite 教程。我已经使用 sqlite3_exec 来初始化数据库并插入新记录，但同样，看不到如何编写一个健壮的 c++ 方法，如果它在表中找到或未找到匹配项，它只返回一个布尔值。正如我所说，下面的代码有效，但不能用于数百次调用。这不应该是与数据库有关的最简单的事情之一吗？是否有任何简单的示例说明如何执行此操作或有关解决此问题的最佳方法的建议？

```
bool ifFound(string path) {
    if (turn_off) return false;
    char **result;
    int nrow = 0; // Number of result rows
    int ncol = 0; // Number of result columns
    char * zErrMsg = 0; // Error message
    if (SQLITE_OK != sqlite3_open(database_path.c_str(), &db)) {
        coutError(__FILE__, __LINE__, "Can't open database " + database_path);
        return false;
    }
    int count = 0;
    string sqlCommand = "select count(*) from my_table where path='"+path+"'";
    if (SQLITE_OK == 
        sqlite3_get_table(db, sqlCommand.c_str(),&result,&nrow,&ncol,&zErrMsg)) 
        count = atoi(result[ncol]);
    else coutError(__FILE__, __LINE__, sqlCommand + " " + zErrMsg);
    sqlite3_free_table(result);
    sqlite3_close(db);
    return (count != 0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:35:07.940

摆脱 sqlite3_get_table 的一种方法是用 sqlite3_exec 替换它，一个回调来处理查询结果，一个全局变量来保存计数。

```
static int pathFound = 0;
int sqlCallback(void *p, int argc, char **argv, char **azColName) {
    pathFound = atoi(argv[0]);
    return 0;
}
void checkPath(string path) {
    string sqlCommand = "select count(*) from m_table where path='"+path+"'";
    rc = sqlite3_exec(db, sqlCommand.c_str(), sqlCallback, 0, &zErrMsg);
    if (SQLITE_OK != rc) {
        coutError(__FILE__, __LINE__, sqlCommand + "\n" + zErrMsg);
        sqlite3_free(zErrMsg);
    }
    sqlite3_close(db);
    if (0 == pathFound) doInsert(path);
} 
```

# c# - 使用 RequiredFieldValidator 验证服务器控件中的文本框

> ID：14836311
> 
> 赞同：2
> 
> 时间：2013-02-12T15:48:33.687
> 
> 标签：c#, asp.net, requiredfieldvalidator, servercontrols

我有自定义服务器控件，其中包含三个文本框。我需要使用 ASP.NET 字段验证器来验证其内容。

我将RequiredFieldValidator 的“ *ControlToValidate* ”属性设置为我的文本框的ID 属性，但似乎验证器无法找到此文本框。这是我正在尝试做的简化代码（省略当前未使用的字段和属性）：

```
[DefaultProperty("Text")]
[ToolboxData("<{0}:ServerControl runat=server></{0}:ServerControl>")]
public class CommentServerControl : WebControl, IPostBackDataHandler
{
    private TextBox _textBoxName;
    private RequiredFieldValidator _requiredName;

    protected override void OnInit(EventArgs e)
    {
        var idName = "Name-" + UniqueID;
        _textBoxName = new TextBox();
        _textBoxName.ID = idName;
        _textBoxName.ClientIDMode = System.Web.UI.ClientIDMode.Static;
        _textBoxName.ValidationGroup = ValidationGroup; // is set up via mark up
        Controls.Add(_textBoxName);
        _requiredName = new RequiredFieldValidator();
        _requiredName.ID = "RequiredName-" + UniqueID;
        _requiredName.ValidationGroup = ValidationGroup;
        _requiredName.ErrorMessage = RequiredMessage; // is set up via mark up
        _requiredName.ControlToValidate = _textBoxName.ID;
        Controls.Add(_requiredName);
    }

    public string ValidationGroup
    {
        get
        {
            var s = (string)ViewState["ValidationGroup"];
            return (s ?? string.Empty);
        }
        set
        {
            ViewState["ValidationGroup"] = value;
        }
    }

    public string RequiredMessage
    {
        get
        {
            var s = (string)ViewState["RequiredMessage"];
            return (s ?? string.Empty);
        }
        set
        {
            ViewState["RequiredMessage"] = value;
        }
    }
} 
```

运行此代码时，我收到错误消息“*无法找到由“RequiredName”的“ControlToValidate”属性引用的控件 ID“Name-ctl00$MainContent$ctl00”。*'

我已经读过这可能会发生，因为控件具有不同的 NamingContainer，但在这种情况下，对 NamingContainer 的引用是相同的。但是，*FindControl(string id)*方法在 OnInit 方法中找不到我的文本框控件。我究竟做错了什么？提前致谢。

注意：使用 UniqueID 创建 ID 是为了防止在多次使用我的控件时发生冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:55:19.750

On_Init 太早了，因为那时还没有创建控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T07:06:08.937

我发现问题出在哪里。我还不知道为什么，但是控件的 ID 属性*不能*包含“$”字符。在我的例子中，UniqueID 属性返回了类似“ *ctl00$MainContent$ctl00* ”的字符串，所以控件的完整 ID 是“ *Name-ctl00$MainContent$ctl00* ”。用其他符号替换“$”（以保持唯一性）解决了这个问题。顺便说一句，*FindControl*方法也开始起作用了。

```
_textBoxName.ID = "Name_" + UniqueID.Replace('$', '_') 
```

另请注意，符号'-' 作为验证器的 ID 会导致 JS 中的语法错误（因为 ASP.NET 会尝试创建具有相同名称的 JS 对象），因此也不建议使用它。

# wordpress - 从已删除的 CPT 重定向 404

> ID：14836315
> 
> 赞同：1
> 
> 时间：2013-02-12T15:48:49.337
> 
> 标签：wordpress

我正在寻找重定向 404 以获取我的网站上不再可用的自定义帖子类型（“个人资料”）。有很多关于为帖子/页面执行此操作的插件和问题，但我还没有找到为 CPT 执行此操作的方向。任何人？

干杯

# android - GreenDao 多对多关系

> ID：14836316
> 
> 赞同：3
> 
> 时间：2013-02-12T15:48:50.867
> 
> 标签：android, sqlite, orm, greendao

我在 Android 中使用 Greendao 进行数据库映射。到目前为止，一切都很好。

但现在我有以下问题：

我有一个集群和叶对象。一个簇包含许多叶子对象。如果一个集群被缩放，它可以分成更多的集群和更多的叶子。这不是严格的树关系，更多的是一个大集群有很多叶子，但一个小集群可以有这个叶子的一个子集。

基本上一个集群有很多叶子，但叶子也位于多个集群中，因为叶子的 id 是唯一的，并且与集群的关系保存在叶子中，叶子只能在一个集群中，对吧？

greendao 主页指出多对多关系是可能的，但我怎么不明白如何为这种关系建模。

是否可以对这种关系进行建模，或者数据结构对 GreenDao 来说是个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:40:55.017

让我们从[文档](http://greendao-orm.com/documentation/relations/)中的引用开始：

> 虽然 greenDAO 目前不直接支持 n:m 关系，但您可以将连接表建模为单独的实体。在实践中，您经常拥有带有附加属性的“关系实体”，因此您可能无论如何都希望这样做。在未来的版本中，greenDAO 可能会引入对 n:m 关系的直接支持。

因此，在您的情况下，您必须建模一个实体，即在 Cluster 和 Leaf 之间。我们称这个实体为 ClusterLeaf。为了有效地查询集群的叶子，我建议使用原始[查询](http://greendao-orm.com/documentation/queries/)，因为 QueryBuilder 还不支持连接。

# mongodb - MongoDB设计问题

> ID：14836317
> 
> 赞同：1
> 
> 时间：2013-02-12T15:49:06.510
> 
> 标签：mongodb

我想创建一个评级数组，在这个数组中我想以某种方式关联评级和检查这个评级的日期。现在我有这个解决方案：

```
> db.foo.find().pretty()
{
    "_id" : ObjectId("511a604f546e6b3019d5e673"),
    "ratings" : [
        {
            "rating" : 3,
            "date" : ISODate("2013-02-12T15:31:27.950Z")
        },
        {
            "rating" : 5,
            "date" : ISODate("2013-02-12T15:34:12.072Z")
        },
        {
            "rating" : 3,
            "date" : ISODate("2013-02-12T15:34:33.009Z")
        }
    ]
} 
```

有了这个“模式”，我看到了唯一的一个大问题，我认为按日期对文档进行排序并不复杂，如果我错了，请纠正我。你会如何设计它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:59:13.207

### 将评级存储在单独的“评级”集合中。

这种策略增加了需要两个查询来显示“foo”及其评级（每个集合一个查询）的小复杂性，但具有灵活性和可扩展性的优势。

另请参阅 10gen 的此建议：[存储评论](http://docs.mongodb.org/manual/use-cases/storing-comments/#storing-comments)。

# list - 通过 VBA 查找所有列表项

> ID：14836320
> 
> 赞同：0
> 
> 时间：2013-02-12T15:49:20.987
> 
> 标签：list, vba, ms-word, word-2007

我正在尝试设置发布到网站的文档，因此需要在列表项之前和之后添加一些 HTML 标记。但是，它没有选择列表项。有人可以帮忙吗？谢谢。

```
 sub format_list()

            Dim para as Paragraph
            Dim is_list_item as Boolean

            is_list_item = False

            For Each para In ActiveDocument.Paragraphs

                    If para.Range.ListFormat.ListType = WdListType.wdListBullet Then

                            is_list_item = True
                            para.Range.InsertBefore "<li>"
                            para.Range.InsertAfter "</li>"

                    End If

            Next

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:51:44.380

尝试使用以下代替`para.Range.InsertAfter "</li>"`

```
para.Range.Select
Selection.EndKey Unit:=wdLine
Selection.TypeText Text:="</li>" 
```

# jsf - 带有数据表和惰性数据模型的 FullAjaxExceptionHandler

> ID：14836325
> 
> 赞同：0
> 
> 时间：2013-02-12T15:49:29.097
> 
> 标签：jsf, primefaces, omnifaces

我正在使用 primefaces 3.4 和 omnifaces 1.3 构建搜索页面。托管 bean 是 SessionScoped。

我有一个带有以下内容的 xhtml 页面：

```
<p:autoComplete id="searchBox" value="#{searchBean.queryText}"... />
<p:commandButton action="#{searchBean.search()}" value="search" ajax="false" .../>

 <p:dataTable id="docuList" var="doc"
                                     binding="#{searchBean.resultDataTable}"
                                     value="#{searchBean.lazyModel}" lazy="true"
                                     styleClass="noBorder" paginator="true" rows="10"
                                     paginatorPosition="bottom" 
                                     paginatorTemplate="{PreviousPageLink} {CurrentPageReport} {NextPageLink}">
...
</p:dataTable> 
```

SearchBean 有一个方法 search 来初始化查询和lazyDataModel。

LazyDataModel 对 db 进行真正的查询。

当会话超时时，lazyDataModel 加载方法出现异常，但 FullAjaxExceptionHandler 无法拦截...

如何在lazyDataModel 中管理异常以重定向到过期会话页面？

感谢您的任何回复。

# iphone - CATransform3DMakeRotation 似乎第二次才正常工作

> ID：14836326
> 
> 赞同：1
> 
> 时间：2013-02-12T15:49:35.687
> 
> 标签：iphone, ios, objective-c, xcode, ios-simulator

我正在使用以下非常基本的代码，因为我正在尝试学习如何为初学者使用基本的景观旋转进行转换

我想学习更多的东西，而不仅仅是投入“shouldautorotate”的东西，这是我现在正在工作的代码

```
- (void)viewDidLoad
{
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didRotate:) name:UIDeviceOrientationDidChangeNotification object:nil];
}

- (void)didRotate:(NSNotification *)notification
{
    UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation]; 
    if (orientation == UIDeviceOrientationLandscapeRight)
    { 
        [UIView animateWithDuration:0.2f animations:^{
            self.view.layer.transform = CATransform3DMakeRotation(-M_PI/2, 0, 0.0, 1.0); 
            [self.scrollViewImages setContentSize:CGSizeMake(self.view.frame.size.width*self.images.count, 320.0)];
            [self.scrollViewImages setContentOffset:CGPointMake(0, 0) animated:YES];
        } completion:^(BOOL finished) {

        }];
    } else if(orientation == UIDeviceOrientationPortrait) {
        [UIView animateWithDuration:0.2f animations:^{ 
            self.view.frame = CGRectMake(0, 0, 320.0, 480.0);
            self.view.center = CGPointMake(160.0, 240.0);
            self.view.transform = CGAffineTransformIdentity;            
        } completion:^(BOOL finished) {

        }];
    }
} 
```

但是我第一次从肖像旋转时，我得到了这个

![肖像](../Images/292c9f22c66dca5d8ceb3f4363a117d1.png) ![景观](../Images/9b5756fae03fb49c759cae2eea06fb20.png)

但是一旦我将其恢复为纵向并再次旋转，我就会收到 ![更正确一点](../Images/ff6daa6438f20b17d37701679af1db64.png)

如果这是一个愚蠢的问题，或者我遗漏了一些明显的东西，我真的很抱歉。我通常在 SO 的帮助下自己学习 :)

感谢您的帮助，祝大家好运。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:25:51.457

如果您更改纵向上的中心或框架，则应将其更改回横向...您还应在每次旋转时更改滚动视图的 contentSize。

尝试这样的事情......

```
- (void)didRotate:(NSNotification *)notification
{
    UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation]; 
    if (orientation == UIDeviceOrientationLandscapeRight)
    { 
        [UIView animateWithDuration:0.2f animations:^{
            self.view.frame = CGRectMake(0, 0, 480.0, 320.0);
            self.view.center = CGPointMake(240.0, 160.0);

            self.view.layer.transform = CATransform3DMakeRotation(-M_PI/2, 0, 0.0, 1.0); 
            [self.scrollViewImages setContentSize:CGSizeMake(self.view.frame.size.width*self.images.count, 320.0)];
            [self.scrollViewImages setContentOffset:CGPointMake(0, 0) animated:YES];
        } completion:^(BOOL finished) {

        }];
    } else if(orientation == UIDeviceOrientationPortrait) {
        [UIView animateWithDuration:0.2f animations:^{ 
            self.view.frame = CGRectMake(0, 0, 320.0, 480.0);
            self.view.center = CGPointMake(160.0, 240.0);
            self.view.transform = CGAffineTransformIdentity;            

            [self.scrollViewImages setContentSize:CGSizeMake(self.view.frame.size.width*self.images.count, 320.0)];
            [self.scrollViewImages setContentOffset:CGPointMake(0, 0) animated:YES];

        } completion:^(BOOL finished) {

        }];
    }
} 
```

# python - 如何舍入 datetime64 值

> ID：14836335
> 
> 赞同：6
> 
> 时间：2013-02-12T15:50:15.990
> 
> 标签：python, datetime, numpy

我有一个 numpy 数组`datetime64`，我想对数组元素的亚秒值进行四舍五入。例如，从`2001-1-1 10:33:32.5`到`2001-1-1 10:33:32.0`。我正在寻找一种 vecotrized 方法。

更一般地说，我正在寻找一种矢量化方法来四舍五入到任何频率（分钟、天等）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T15:51:49.140

`rounded = numpy.array(myarray, dtype='datetime64[s]')`或者 `rounded = myarray.astype('datetime64[s]')`

这也适用于几分钟：

```
rounded = numpy.array(myarray, dtype='datetime64[m]') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-04T09:44:05.563

另一种处理截断的方法是：

```
rounded = numpy.array((numpy.array(myarray, dtype='datetime64[m]'), dtype='datetime64[ms]') 
```

# excel - Excel 公式停止工作

> ID：14836336
> 
> 赞同：0
> 
> 时间：2013-02-12T15:50:20.587
> 
> 标签：excel, excel-formula, excel-2010

我有一个程序可以根据来自数据库的查询动态创建 excel 工作簿。在其他几个中，有这两个工作表。第一个列出了几个项目中每个项目中的组件信息。第二张表按项目列出了每个组件中的所有员工及其每周分配的小时数。所以我制定了这个公式：

```
=SUMPRODUCT(--(OFFSET('User Breakdown'!$B$3,0,0,COUNTA('User Breakdown'!$B:$B),1)=A7)*(OFFSET('User Breakdown'!$C$3,0,0,COUNTA('User Breakdown'!$C:$C),1)=B9)*(OFFSET('User Breakdown'!$E$3,0,0,COUNTA('User Breakdown'!$C:$C),52))) 
```

将在每个项目和组件下分配给不同用户的所有小时数相加。它工作得很好。现在没有了。它返回一个#VALUE！错误。我们对用户细分表进行了一些更改，所以我认为这是因为这些更改。我们做了一些格式化，添加了一列，并填写了全年的值。我去了一张较旧的表格，其中公式有效，并逐步进行了所有这些更改，以查看公式将开始失败的地方。它从未失败过。仍然可以正常工作。所以我去了新表并取消了更改。该公式从未开始起作用。我将两个公式都复制到记事本中，然后坐在那里与同事逐个字符地比较它们。它们是相同的。我复制粘贴了工作表名称并返回公式（尽管那将是#REF！错误而不是#VALUE！错误）。MS 帮助包含与弹出窗口完全相同的文本，只是格式更多且页面非常慢。我将公式的各个部分分开，每个部分单独计算。

所以这给我留下了两个选择：反复刺伤计算机（这不起作用），或者问你们好人可能是什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:01:08.383

`#VALUE!`错误可能意味着您在定义的最后一个范围内有一些文本值

`=OFFSET('User Breakdown'!$E$3,0,0,COUNTA('User Breakdown'!$C:$C),52)`

这个版本有用吗？

`=SUMPRODUCT((OFFSET('User Breakdown'!$B$3,0,0,COUNTA('User Breakdown'!$C:$C),1)=A7)*(OFFSET('User Breakdown'!$C$3,0,0,COUNTA('User Breakdown'!$C:$C),1)=B9)*ISNUMBER(OFFSET('User Breakdown'!$E$3,0,0,COUNTA('User Breakdown'!$C:$C),52)),OFFSET('User Breakdown'!$E$3,0,0,COUNTA('User Breakdown'!$C:$C),52))`

如果确实如此，那只是因为该版本将忽略任何文本值 - 您可能仍需要确定文本值出现的位置，以防它们应该是包含在总数中的数字.....

# assembly - lb 指令到底是做什么的？

> ID：14836338
> 
> 赞同：4
> 
> 时间：2013-02-12T15:50:41.050
> 
> 标签：assembly, mips

我要考试了，其中一个练习题是：

> 假设`$t0`包含值`0x12121212`并`$t1`包含地址`0x1000000`。
> 
> 假设内存数据，起始地址`0x1000000`为： `88 77 66 55`。
> 
> `$t0`执行以下代码后的值是多少：
> 
> ```
> lb $t0, 0($t1) 
> ```
> 
> a) `0x00000088`b) `0x88121212`c) `0xffffff88`d)`0x12121288`

我给出的答案是`a`，因为`lb`指令将读取的字节（根据我对指令的理解）是 88。88 然后将存储在 中`$t0`，因此值将是`0x00000088`。但给出的答案是`c`。我觉得我对如何`lb`工作有一个根本的误解——有人可以解释为什么答案是这样`c`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T16:00:26.193

The answer would be `c) 0xffffff88`. The `lb` instructions sign-extends the byte into a 32-bit value. I.e. the most significant bit (msb) is copied into the upper 24 bits.

0x88 == 0b10001000, i.e. the msb is 1\. So the upper 24 bits will be 0b111111111111111111111111 == 0xffffff.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T15:56:00.033

该`lb`指令从内存中加载一个字节并加载`sign extends`到寄存器的大小。该`lbu`指令在没有符号扩展（无符号）的情况下执行相同的操作。

[http://en.wikipedia.org/wiki/MIPS_architecture#Integer](http://en.wikipedia.org/wiki/MIPS_architecture#Integer)

大多数计算机（包括 MIPS）都使用[二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)来表示有符号值，尽管还有[其他方法可以对符号进行编码](http://en.wikipedia.org/wiki/Signed_number_representations)，浮点通常以使用有符号幅度的[IEEE 754](http://en.wikipedia.org/wiki/IEEE_754-2008)格式表示。整数有符号值可以用任意位数表示，例如

*   C中的a`char`是8位，可以表示-128到+127
*   C 中的 a`short`是 16 位的，可以表示 -32768 到 +32767
*   ETC

在二进制补码中，最高有效位可用于确定数字的符号，a`'1'`表示它是负数，a`'0'`表示它是正数。

数字 0x88 在解释为 8 位二进制补码数时为负 0x78 或十进制 -120。当以 32 位二进制补码表示时，它是 0xFFFFFF88。有几种方法可以记住如何计算数字的二进制补码：

*   取数字的补码（反转每一位）并添加“1”，或
*   从最低有效位到最高有效位（从右到左），跳过你遇到的每个“0”和第一个“1”，之后反转每一位

要将 8 位符号扩展为 32 位，只需查看最高有效位（第 7 位）并将该位复制到第 8 位到第 31 位……这遵循二进制补码的定义。

# javascript - 在 angularJs 服务中访问 c ookie

> ID：14836341
> 
> 赞同：5
> 
> 时间：2013-02-12T15:50:57.493
> 
> 标签：javascript, html, angularjs, cookies

我可以像这样成功地访问我的控制器上的 cookie。

```
angular.module('mobbr', [ 'ngCookies' ]).    

function RegisterCtrl($scope, $cookies) { } 
```

但是每当我尝试在这样的服务中使用 cookie 时。

```
angular.module('mobbr.services', []);
angular.module('mobbr.services').factory('currentUser', [ 'ngCookies', function ($cookies) {}]); 
```

我收到以下错误：ngCookiesProvider <- ngCookies <- currentUser。

关于为什么这不起作用以及我应该如何初始化具有 cookie 访问权限的服务的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T15:58:28.983

This is what my code for something similar looks like:

```
angular.module('app.MyData', ['ngResource','ngCookies']).
    factory('MyService', function($resource, $http, $cookies) {
        ...
    }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-15T10:34:59.820

对我来说，这很有效：

```
module.controller('myCtrl', ['$scope', '$cookies',
        function($scope, $cookies) {
             ...........
         }
    ]); 
```

而不是使用`ngCookies`我正在使用`$cookies`. 我看了这个[例子](https://docs.angularjs.org/api/ngCookies/service/$cookies)，但不知何故它抛出了错误`Unknown provider: ngCookiesProvider <- ngCookies`

# ruby-on-rails - Rails & Backbone.js - Remotipart Gem Throwing Error after... 成功上传？

> ID：14836342
> 
> 赞同：0
> 
> 时间：2013-02-12T15:51:01.640
> 
> 标签：ruby-on-rails, ajax, backbone.js

我有一个 Backbone.js on Rails 应用程序，我想用 AJAX 上传图像。奇怪的是，图像正在上传到我的 Amazon S3，但 ajax 引发了解析错误。

```
= form_for @page, :html => { :multipart => true, :data => { :type => 'json' } }, :remote => true do |f|

  .field
    = f.label :bg_image
    = f.file_field :bg_image

  .actions
    = f.submit 'Save' 
```

当我单击保存时，它可以正常上传（我知道这是因为当我刷新它时会显示新图像，并且我的 rails 控制台中没有错误）。但是，我想将新图像绑定到我的主干模型，但以下只是`parseerror`在 JS 控制台中产生的结果。

```
 $("form").bind "ajax:success", (event, data) ->
    log data

  $("form").bind "ajax:error", (jqXHR, textStatus, errorThrown) ->
    log jqXHR
    log textStatus
    log errorThrown 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:22:16.617

原来我需要`:format => :json`在我的表单中，以使操作 url json （这是除了 'data-type' => 'json'）。

它正在重定向，因为 html 响应是重定向，因此是 parseerror。

# c++ - 如何在 Visual Studio 中链接库

> ID：14836343
> 
> 赞同：2
> 
> 时间：2013-02-12T15:51:02.850
> 
> 标签：c++, visual-studio-2010, linker, static-libraries

我正在尝试使用 SMILE 库（[http://genie.sis.pitt.edu/index.php/downloads](http://genie.sis.pitt.edu/index.php/downloads)）在 C++ 中创建一个项目。在该站点上，我下载了适用于 x64 的 Visual Studio 2010 / VC 10.0 SP1 版本（我安装了 Windows 7 和 Visual Studio 2010）。创建一个新项目后，我转到项目属性->配置->C/C++->附加包含目录并设置包含库的文件夹的路径。当我尝试编译时出现错误：

```
1>------ Inizio compilazione: Progetto: IDSS_2013, Configurazione: Debug Win32 ------
1>  stdafx.cpp
1>  AssemblyInfo.cpp
1>  IDSS_2013.cpp
1>  Generazione del codice in corso...
1>  .NETFramework,Version=v4.0.AssemblyAttributes.cpp
1>LINK : fatal error LNK1104: impossibile aprire il file 'smile_dbg.lib'
========== Compilazione: 0 completate, 1 non riuscite, 0 aggiornate, 0 ignorate ========== 
```

来源是文档中的示例提供的来源：

```
#include "smile.h"

#include <stdio.h>

void CreateNetwork(void);
void InfereceWithBayesNet(void);
void UpgradeToInfluenceDiagram(void);
void InferenceWithInfluenceDiagram(void);
void ComputeValueOfInformation(void);

int main()
{
 CreateNetwork();
 InfereceWithBayesNet();
 UpgradeToInfluenceDiagram();
 InferenceWithInfluenceDiagram();
 ComputeValueOfInformation();
 return(DSL_OKAY);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:03:50.833

根据[网站](http://genie.sis.pitt.edu/index.php/downloads)：

> 不要在项目设置中添加smile.lib 作为附加的链接器输入——smile.h 会处理这个问题。

我想这意味着smile.h文件已经包括：

```
#pragma import smile.lib 
```

你能检查一下是否是这种情况吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:01:53.127

use #pragma comment to add library or use project settings (linker->input)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-20T13:16:35.107

我有一个类似的问题（也在 Windows 7 和 Visual Studio 2010 上）并通过使用 x86 版本的微笑解决了它（在 Win32 下：Visual Studio 2010 / VC 10.0 SP1）。

# ruby - 如何获取 URL 参数？

> ID：14836346
> 
> 赞同：4
> 
> 时间：2013-02-12T15:51:09.333
> 
> 标签：ruby, url, parameters

我想获取 URL 的参数：

```
http://server/index.rhtml?parameter=gonnadie 
```

我如何获得'gonnadie'？

在 PHP 中，我会使用`$_GET['parameter']`.

我在 Ruby 中使用什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:56:39.870

使用[URI::Parser](http://www.ruby-doc.org/stdlib-1.9.3//libdoc/uri/rdoc/URI/Parser.html)库，如下所示：

```
require 'uri'
str = 'http://server.index.rhtml?parameter=gonnadie'
parsed = Uri.parse(str)
parameters = parsed.query
paramvalue = parameters.split('=')
ourvalue = paramvalue[1] 
```

希望有帮助...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T03:07:32.043

我使用`servlet_request.query["parameter"]`+ `Webrick` Thanks Dude解决了这个问题

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T15:52:42.880

`params[:parameter]`

假设您在谈论 RAILS！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T19:37:38.747

```
require 'uri'
str = 'http://server/index.rhtml?parameter=gonnadie'
fulluri = Uri.parse(str).split('?')[0]
parameter = Uri.parse(str).split('=')[1] 
```

# jakarta-ee - EJB 异常的根本原因。有什么巧妙的方法吗？

> ID：14836348
> 
> 赞同：1
> 
> 时间：2013-02-12T15:51:15.107
> 
> 标签：jakarta-ee, ejb

有没有一种简单的方法来获取 EJB 异常的根本（真正）原因？如果我查看异常的堆栈跟踪，那么我可以很容易地找出原因。例如，在下面给出的示例中，层次结构是 EJBException> RollbackException> DatabaseException。

有没有办法轻松找到它而不是一路走下去？

谢谢你。

```
javax.ejb.EJBException: Transaction aborted
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5142)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:89)
    at $Proxy631.edit(Unknown Source)
    at edu.ac.xxx.zzz.yyy.code.session.__EJB31_Generated__ScheduleFacade__Intf____Bean__.edit(Unknown Source)
    at WICKET_edu.ac.xxx.zzz.yyy.code.session.AbstractFacade$$FastClassByCGLIB$$e02eb00e.invoke(<generated>)
    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
    at org.apache.wicket.proxy.LazyInitProxyFactory$CGLibInterceptor.intercept(LazyInitProxyFactory.java:317)
    at WICKET_edu.ac.xxx.zzz.yyy.code.session.ScheduleFacade$$EnhancerByCGLIB$$3571e474.edit(<generated>)
    at edu.ac.xxx.zzz.yyy.code.ui.equipment.EditEquipment$1.onSubmit(EditEquipment.java:55)
    at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1595)
    at org.apache.wicket.markup.html.form.Form.process(Form.java:960)
    at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:922)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:182)
    at org.apache.wicket.request.target.component.listener.ListenerInterfaceRequestTarget.processEvents(ListenerInterfaceRequestTarget.java:73)
    at org.apache.wicket.request.AbstractRequestCycleProcessor.processEvents(AbstractRequestCycleProcessor.java:92)
    at org.apache.wicket.RequestCycle.processEventsAndRespond(RequestCycle.java:1252)
    at org.apache.wicket.RequestCycle.step(RequestCycle.java:1331)
    at org.apache.wicket.RequestCycle.steps(RequestCycle.java:1438)
    at org.apache.wicket.RequestCycle.request(RequestCycle.java:546)
    at org.apache.wicket.protocol.http.WicketFilter.doGet(WicketFilter.java:486)
    at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:319)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)
Caused by: javax.transaction.RollbackException: Transaction marked for rollback.
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:473)
    at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.commit(JavaEETransactionManagerSimplified.java:855)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5136)
    ... 53 more
Caused by: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: UPDATE command denied to user 'yang'@'localhost' for table 'schedule'
Error Code: 1142
Call: UPDATE schedule SET due_date = ? WHERE (id = ?)
    bind => [2 parameters bound]
Query: UpdateObjectQuery(edu.ac.xxx.zzz.yyy.code.entity.Schedule[id=26])
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:324)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:840)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeNoSelect(DatabaseAccessor.java:906)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:592)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:535)
    at org.eclipse.persistence.internal.sessions.AbstractSession.basicExecuteCall(AbstractSession.java:1717)
    at org.eclipse.persistence.sessions.server.ClientSession.executeCall(ClientSession.java:253)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:207)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:193)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.updateObject(DatasourceCallQueryMechanism.java:749)
    at org.eclipse.persistence.internal.queries.StatementQueryMechanism.updateObject(StatementQueryMechanism.java:432)
    at org.eclipse.persistence.internal.queries.DatabaseQueryMechanism.updateObjectForWriteWithChangeSet(DatabaseQueryMechanism.java:1042)
    at org.eclipse.persistence.queries.UpdateObjectQuery.executeCommitWithChangeSet(UpdateObjectQuery.java:84)
    at org.eclipse.persistence.internal.queries.DatabaseQueryMechanism.executeWriteWithChangeSet(DatabaseQueryMechanism.java:287)
    at org.eclipse.persistence.queries.WriteObjectQuery.executeDatabaseQuery(WriteObjectQuery.java:58)
    at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:844)
    at org.eclipse.persistence.queries.DatabaseQuery.executeInUnitOfWork(DatabaseQuery.java:743)
    at org.eclipse.persistence.queries.ObjectLevelModifyQuery.executeInUnitOfWorkObjectLevelModifyQuery(ObjectLevelModifyQuery.java:108)
    at org.eclipse.persistence.queries.ObjectLevelModifyQuery.executeInUnitOfWork(ObjectLevelModifyQuery.java:85)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2871)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1516)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1498)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1449)
    at org.eclipse.persistence.internal.sessions.CommitManager.commitChangedObjectsForClassWithCha
INFO: ngeSet(CommitManager.java:265)
    at org.eclipse.persistence.internal.sessions.CommitManager.commitAllObjectsWithChangeSet(CommitManager.java:128)
    at org.eclipse.persistence.internal.sessions.AbstractSession.writeAllObjectsWithChangeSet(AbstractSession.java:3799)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabase(UnitOfWorkImpl.java:1415)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitToDatabase(RepeatableWriteUnitOfWork.java:636)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabaseWithChangeSet(UnitOfWorkImpl.java:1505)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.issueSQLbeforeCompletion(UnitOfWorkImpl.java:3143)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.issueSQLbeforeCompletion(RepeatableWriteUnitOfWork.java:346)
    at org.eclipse.persistence.transaction.AbstractSynchronizationListener.beforeCompletion(AbstractSynchronizationListener.java:157)
    at org.eclipse.persistence.transaction.JTASynchronizationListener.beforeCompletion(JTASynchronizationListener.java:68)
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:435)
    ... 55 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: UPDATE command denied to user 'yang'@'localhost' for table 'schedule'
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2427)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2345)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2330)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:831)
    ... 87 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T10:29:40.087

[我在这里](http://www.coderanch.com/t/314724/EJB-JEE/java/rollback-exception-reveal-real-Exception)的一篇文章中找到了这个 Java 代码。它适用于所有 EJB 包装的异常，但如果你有一个持久层，那么我们就会遇到麻烦。

```
Java Code

   /** 
   * Returns the root cause of the given exception, defined as the first 
   * cause that is not an <tt>EJBException</tt> or the last cause in the chain. 
   * 
   * @param   exception     <tt>EJBException</tt> to inspect 
   * @return  the root cause of the exception 
   */  
  public static Exception getRootCause ( EJBException exception )  
  {  
    if ( null == exception ) {  
      return null;  
    }  

    EJBException effect = exception;  
    Exception cause = effect.getCausedByException();  

    while ( null != cause  &&  cause instanceof EJBException ) {  
      effect = (EJBException) cause;  
      cause = effect.getCausedByException();  
    }  

    return null == cause ? effect : cause;  
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T15:56:57.990

这就是 Java 异常的工作方式。如果捕获的异常被重新抛出并包裹在另一个异常中，那么您会得到像这样的冗长跟踪。

您可以考虑使用 in 创建一个servlet过滤[器](https://stackoverflow.com/tags/servlet-filters/info)，它在循环中提取直到到达最后一个，然后将其记录到单独的文件中，然后改为读取该日志文件。`FilterChain#doFilter()``try-catch``Exception#getCause()`

# html - 如何使用 html5 画布获取文本的边界框？

> ID：14836350
> 
> 赞同：6
> 
> 时间：2013-02-12T15:51:22.970
> 
> 标签：html, canvas

我想得到一些文本的边界框。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T15:51:22.970

我在提交问题之前找到了答案：

[http://mudcu.be/journal/2011/01/html5-typographic-metrics/#bboxUnicode](http://mudcu.be/journal/2011/01/html5-typographic-metrics/#bboxUnicode) [http://www.w3schools.com/tags/canvas_measuretext.asp](http://www.w3schools.com/tags/canvas_measuretext.asp)

```
var text_width = ctx.measureText("some text").width; 
```

我将行高用于`text_height`.

这给出了不精确的边界框，但在文本渲染之前它是快速且可用的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-02-09T20:29:18.313

在 Chrome 中工作：

```
const can = document.querySelector('canvas');
const ctx = can.getContext('2d');

let x = 10, y = 50;
let msg = "Hello, World!";

ctx.font = "30px monospace";

let textMetrics = ctx.measureText(msg);

ctx.fillText(msg, x, y);

console.log(textMetrics);

ctx.beginPath();
ctx.moveTo(
	x - textMetrics.actualBoundingBoxLeft,
  y - textMetrics.actualBoundingBoxAscent
);
ctx.lineTo(
  x + textMetrics.actualBoundingBoxRight, 
  y - textMetrics.actualBoundingBoxAscent
);
ctx.lineTo(
  x + textMetrics.actualBoundingBoxRight, 
  y + textMetrics.actualBoundingBoxDescent
);
ctx.lineTo(
	x - textMetrics.actualBoundingBoxLeft,
  y + textMetrics.actualBoundingBoxDescent
);
ctx.closePath();
ctx.stroke();
```

```
canvas {
  border: 1px solid black;
}
```

```
<canvas></canvas>
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2022-03-03T18:35:17.860

也许我不明白这个问题，但怎么样：

/* 见 w3schools box-sizing 页面 */

```
<style>
* {
    box-sizing: border-box;
} 
</style> 
```

# javascript - 我希望将返回的数据写入 html 的 div 标签

> ID：14836353
> 
> 赞同：1
> 
> 时间：2013-02-12T15:51:25.077
> 
> 标签：javascript, ajax

```
<script>
function showPrice(str)
{
if (str=="")
  {
  document.getElementById("remaining").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("remaining").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getevent.php?q="+str,true);
xmlhttp.send();
}
</script> 
```

以下代码将数据返回到相应的 div，但是当我看到源代码时，我无法找到新插入的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:54:40.827

那是因为它是动态添加到 dom 中的。如果您右键单击并检查元素（Chrome 和 firefox），某些浏览器会显示更新的 html。其他人只是向您展示如何下载它的开始版本。

# java - Java Spring 急切获取 Hibernate 子类失败

> ID：14836354
> 
> 赞同：0
> 
> 时间：2013-02-12T15:51:34.900
> 
> 标签：java, spring, hibernate, subclass

我正在使用 Hibernate 3.2.5 创建一个 Spring Web MVC 3.1.1 应用程序。我在 Netbeans 7.2 中开发，应用服务器是 GlassFish 3.1.2。数据库是Mysql 5.5。

我的问题是 subclass 没有预先加载`@OneToMany`，而另一个具有 a`@OneToMany`的类能够加载。此问题仅在 Glassfish 上出现：当我以完全相同的逻辑运行本地脚本时，没有问题。

相关的休眠配置：

```
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.hbm2ddl.auto">update</property>
    <mapping class="blagae.db.game.Game"/>
    <mapping class="blagae.db.game.GamePhase"/>
    <mapping class="blagae.db.game.Series"/>
    <mapping class="blagae.db.play.Play"/>
  </session-factory>
</hibernate-configuration> 
```

其基本理念是美式橄榄球比赛。A`Game`包含几个`GamePhases`( `Series`, `Kickoffs`, `Half Time`, `End Of Game`)；a `Series`contains `Plays`，它们被进一步细分。

**`GamePhase`& `Game`（这些工作）：**

```
@Entity
@Inheritance(strategy=InheritanceType.JOINED)
public class GamePhase implements Serializable {
  @Id
  @GeneratedValue
  private int gamePhaseID;
  @ManyToOne(fetch = FetchType.EAGER)
  private Game game;
}

@Entity
public class Game implements Serializable {
  @Id
  @GeneratedValue
  private int gameID;
  @OneToMany(cascade=CascadeType.ALL, mappedBy="game", fetch=FetchType.EAGER)
  private List<GamePhase> gamePhases = new ArrayList<GamePhase>();

  public List<GamePhase> getGamePhases() {
    return gamePhases;
  }

  public void setGamePhases(List<GamePhase> gamePhases) {
    this.gamePhases = gamePhases;
  }

  public Series getFirstGamePhase() throws Exception {
    if (gamePhases.isEmpty() || gamePhases == null) {
        throw new Exception ("List<GamePhase> error");
    }
    return gamePhases.get(0);
  }
} 
```

**`Series`(<- `GamePhase`) 和`Play`：**

```
@Entity
@Inheritance(strategy=InheritanceType.JOINED)
public class Play implements Countable, Serializable {
  @ManyToOne
  private Series series;
}

@Entity
public class Series extends GamePhase implements Countable {
  @OneToMany(cascade=CascadeType.ALL, mappedBy="series",fetch=FetchType.EAGER)
  private List<Play> plays = new ArrayList<Play>();

  public List<Play> getPlays() {
    return plays;
  }

  public void setPlays(List<Play> plays) {
    this.plays = plays;
  }

  public Play getFirstPlay() throws Exception {
    if (plays.isEmpty() || plays == null) {
        throw new Exception ("List<Play> error");
    }
    return plays.get(0);
  }
} 
```

当我在本地运行以下代码时，我得到了正常响应：

```
Session session = SessionFactoryHelper.getSession();
try {
    GamePhase gp = ((Game) session.get(Game.class, 1)).getFirstPlay();
    System.out.println("GamePhaseID="+gp.getGamePhaseID());
    Play play = ((Series) session.get(Series.class, 1)).getFirstPlay();
    System.out.println("PlayID="+play.getPlayID());
}
catch (Exception e) {
  e.printStackTrace(System.out);
} 
```

> 响应：GamePhaseID=1 PlayID=1

当我在 JSP 中运行它时（请原谅脚本，我仍在学习 JSTL 的基础知识）。

```
<% Game game = (Game) request.getAttribute("game");
List<GamePhase> series = game.getDrives(); %>
<p> <%=game.getFirstGamePhase() %> </p>

<%for (GamePhase gamePhase : series) {
      if (gamePhase.isSeries()) { 
Series series = (Series) gamePhase;%>
<table>
  <tr>
    <td> <%= series.getGamePhaseID() %>
    </td>
    <td> Play <%= series.getFirstPlay() %>
    </td>
  </tr>
</table> 
```

该`getFirstPlay()`方法失败，因为`List<Play>`play 为空。如果我注释掉 `<%-- series.getFirstPlay() --%>`，代码可以正常工作并呈现良好。

据我所知，唯一的区别是`@OneToMany`in`Play`指的是一个子类实体，而`@OneToMany`in`GamePhase`不是...

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:31:14.233

问题是铸造。

在工作示例中：

```
Play play = ((Series) session.get(Series.class, 1)).getFirstPlay(); 
```

在上述场景中，您告诉 Hibernate 显式加载 ID=1 的 Series 对象 - 因此它可以正确处理急切加载并且加载播放没有问题。

但是，在第二个示例中：

```
for (GamePhase gamePhase : series) {
    if (gamePhase.isSeries()) { 
        Series series = (Series) gamePhase; 
```

这次 Hibernate 已经为您加载了 GamePhase 对象 - 当您将其转换为 Series 对象时，该方法是可用的，但显然 Hibernate 并没有在此时急切地加载额外的 Series 内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:28:34.867

我认为您已经正确识别了问题。请记住，在获取您`Game`的 . 此时，它知道它将需要`GamePhase`. 你没有要求它获取一个子类，`GamePhase`所以通常它不会。因此，获得一切的连接`Game`通常永远不会包含来自`Series`.

（要么是那个，要么是因为你`plays`直接使用变量，而不是`getPlays()`在你的方法中使用。）

做到这一点的唯一方法是修复设计。例如，making 扮演了 every 的可选部分`GamePhase`。如何做得更优雅一点需要更多的思考。

# jquery - JQPlot 折线图上的自定义工具提示

> ID：14836355
> 
> 赞同：5
> 
> 时间：2013-02-12T15:51:36.047
> 
> 标签：jquery, tooltip, jqplot, jqplot-highlighter

我正在尝试为折线图获取自定义工具提示，因为我希望工具提示更详细地描述点而不是该点的值。（附上的图片进一步解释了我在做什么）

我已经尝试过如何做到这一点。

下面是我的代码：

```
<script type="text/javascript">        $('#page3a').live('pageshow', function () {
        var s1 = [1, 2, 3, 4, 5];
        var s2 = ["Message 1", "Message 2", "Message 3", "Message 4", "Message 5"];

        var lineGraph1 = $.jqplot('lineGraph1', [s1,s2], {

            animate: true,
            seriesDefault: {
                showMarker: false,
                pointLabels: { show: true }
            },

            grid: {
                drawBorder: false,
                drawGridlines: false,
                background: '#eafaff',
                shadow: false
            },
            axesDefaults: {
                show: false,

                showTicks: false,
                showTickMarks: false

            },

            highlighter: {
                show: true,
                sizeAdjust: 8,
                tooltipLocation: 'n',
                tooltipAxes: 'piered',
               formatString:'%s',
                fadeTooltip: true,
                tooltipFadeSpeed: "fast",
                useAxesFormatters: false

            }

        });
    });</script> 
```

任何帮助将不胜感激。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-05T08:59:08.110

有一个配置选项允许您提供一个自定义回调方法，该方法被调用以检索工具提示内容：

```
highlighter: {
    tooltipContentEditor: function (str, seriesIndex, pointIndex) {
        return str + "<br/> additional data";
    },

    // other options just for completeness
    show: true,
    showTooltip: true,
    tooltipFade: true,
    sizeAdjust: 10,
    formatString: '%s',
    tooltipLocation: 'n',
    useAxesFormatters: false,
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T10:24:55.817

我对 nick_w 的回答做了些微修改。但是我现在有了想要的效果，只是粘贴代码来帮助以后的其他人。

```
<script type="text/javascript">     

   $('#page3a').live('pageshow', function () {
          var s1 = [1, 2, 3, 4, 5];
          var s2 = ["Message 1", "Message 2", "Message 3", "Message 4", "Message 5"];

          var lineGraph1 = $.jqplot('lineGraph1', [s1, s2], {

              animate: true,
              seriesDefault: {
                  showMarker: false,
                  pointLabels: { show: true }
              },

              grid: {
                  drawBorder: false,
                  drawGridlines: false,
                  background: '#eafaff',
                  shadow: false
              },
              axesDefaults: {
                  show: false,

                  showTicks: false,
                  showTickMarks: false

              }
          });

          $('#lineGraph1').bind('jqplotDataMouseOver', function (ev, seriesIndex, pointIndex, data) {

              var mouseX = ev.mouseX; //these are going to be how jquery knows where to put the div that will be our tooltip
              var mouseY = ev.mouseY;
              $('#chartpseudotooltip').html(s2[pointIndex] );
              var cssObj = {
                  'position': 'absolute',
                  'font-weight': 'bold',
                  'left': mouseX + 'px', //usually needs more offset here
                  'top': mouseY + 'px',
                  'background-color': 'white',
                  'z-index':'1'
              };
              $('#chartpseudotooltip').css(cssObj);

          });

          $('#lineGraph1').bind('jqplotDataUnhighlight', function (ev) {
              $('#chartpseudotooltip').html('');
          });
      });</script> 
```

要调用此脚本，将以下内容添加到我的内容 div 中。

```
<div id="lineGraph1" style="margin-top: 20px; margin-left: 160px; width: 350px; height: 350px">
        <div id="chartpseudotooltip"></div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T13:54:36.807

如果您总是希望在点值之前出现文本“消息”，则只需将其添加到 formatString 中：

```
highlighter:{
  show: true,
  formatString: 'Message %s',
  //other stuff like sizeAdjust...
} 
```

如果它对应于您要显示的刻度，您也可以使用您的 s2 变量：

```
axes: {
   yaxis: {
       ticks: s2,
       tickRenderer: ...
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T06:22:21.567

像这样的东西怎么样（改编自[条形图上的 jqplot 工具提示](https://stackoverflow.com/questions/4889464/jqplot-tooltip-on-bar-chart)）？

```
$('#lineGraph1').bind('jqplotDataMouseOver', function (ev, seriesIndex, pointIndex, data) {

    var mouseX = ev.pageX; //these are going to be how jquery knows where to put the div that will be our tooltip
    var mouseY = ev.pageY;
    $('#chartpseudotooltip').html(s2[pointIndex] + ', (' + data[0] +', ' + data[1] + ')');
    var cssObj = {
        'position' : 'absolute',
        'font-weight' : 'bold',
        'left' : mouseX + 'px', //usually needs more offset here
        'top' : mouseY + 'px',
        'background-color': 'white'
    };
    $('#chartpseudotooltip').css(cssObj);

});

$('#lineGraph1').bind('jqplotDataUnhighlight', function (ev) {
    $('#chartpseudotooltip').html('');
}); 
```

`Message X, (x_value, y_value)`当鼠标经过数据点时，这将绘制表单的小工具提示。然后，您可以进一步设置工具提示的样式以适应。

在此示例中，工具提示如下：

```
 <div id="chartpseudotooltip"></div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-08T10:59:30.273

你可以在这里得到答案[jsfiddle](http://jsfiddle.net/bcorn/Dg26z/7/)

```
var line1=[['10/17/2013',21],['1/30/2014',3],['11/1/2013',12],['10/2/2013',3],['11/5/2013',18]];

   var line2=[['10/17/2013',41],['1/30/2014',33],['11/1/2013',12],['10/2/2013',63],['11/5/2013',18]];

var plot1 = $.jqplot('linegraph1', [line1,line2],{
  seriesDefaults: {
    lineWidth: 1,
     markerOptions: {
        show: true,             // wether to show data point markers.
        style: 'filledCircle',  // circle, diamond, square, filledCircle.
        size: 2            // size (diameter, edge length, etc.) of the marker.
    }},
    axes:{
      xaxis:{
        renderer:$.jqplot.DateAxisRenderer,

          tickOptions:{
            formatString:'%b&nbsp;%#d',
        showGridline: false
          }
      },
      yaxis:{min:0,numberTicks:25,
        tickOptions:{

        showGridline: false
          }
      }
    },
    legend :
    {
        "show" : true,
        location: 'se'
    },
    series : [
        {
            label : "line1",highlighter: {formatString: "<div style='text-align:center;'><span>%s </span><br/><span> Blue: %s <br/>custom tooltip<span></div>"}

        },
        {
            label : "line2",highlighter: {formatString: "<div style='text-align:center;'><span>%s </span><br/><span> Orange: %s <br/>custom tooltip<span></div>"},

        }
    ],
   highlighter: {
      show: true,
       sizeAdjust: 25.5,
       tooltipLocation: 's'
    }
  }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-14T13:58:47.010

```
<script type="text/javascript">        $('#page3a').live('pageshow', function () {
        var s1 = [[1, 1], [2, 2], [3, 3], [4, 4], [5, 5]];
        var s2 = [["Message 1"], ["Message 2"], ["Message 3"], ["Message 4"], ["Message 5"]];

        var lineGraph1 = $.jqplot('lineGraph1', [s1,s2], {

            seriesDefault: {
                showMarker: false,
                pointLabels: { show: true }
            },

            grid: {
                drawBorder: false,
                drawGridlines: false,
                background: '#eafaff',
                shadow: false
            },
            axes: {

                xaxis: {ticks: s2}

            },

                highlighter: {
                show: true,
                sizeAdjust: 8,
                tooltipLocation: 'n',
                tooltipAxes: 'x',
                formatString: '%s',

            }

        });
    });</script> 
```

# java - 表示单个字节

> ID：14836358
> 
> 赞同：1
> 
> 时间：2013-02-12T15:51:47.083
> 
> 标签：java

单个`byte`占用Java 虚拟机（*32 位处理器）内部的***四个字节**空间。

 *是的，我们可以使用一个字节数组，它只占用它实际需要的空间量。但我想使用单个字节**而不是**字节数组。

那么，是否有任何**类型**`Java`可以表示**8 位**数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T15:57:03.780

出于内存对齐的原因，**单个** `byte` **可以**分配多于一个字节的存储空间。

不要担心目标处理器。`byte`10000 s的数组**将存储**在大约 10000 字节的空间中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T15:53:41.090

> Java中是否有任何类型来表示8位数据。

是的，它被称为`byte`. 单个实际需要多少`byte`仅取决于 Java VM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T15:54:07.523

如何处理内部类型取决于实现（JVM）。我猜 8 位机器上的任何 JVM 都使用 1 个字节作为类型`byte`- 在 32 位或 64 位机器上，情况可能并非总是如此，正如您所注意到的 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T15:55:56.447

如果您使用`byte`，那么 Java 将使用最有效的方法来存储它。可能是 8 位，也可能是 64 位，但不管它是什么，都是有充分理由的。不要与编译器对抗，它比你更清楚。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T15:53:46.863

一个字节确实代表一个 8 位数据。为什么要关心 vm 的实现使用多少字节来存储它？*

# python - 我的 django 项目的构建配置问题，没有得到指定版本的 django

> ID：14836363
> 
> 赞同：1
> 
> 时间：2013-02-12T15:52:10.413
> 
> 标签：python, django, buildout

我`zc.buildout`使用`easy_install`. [我使用了http://jacobian.org/writing/django-apps-with-buildout/](http://jacobian.org/writing/django-apps-with-buildout/)上的教程。

我的问题是，我无法安装 buildout.cfg 中指定的版本：

```
[buildout]
parts = python 
        django
develop = .
versions = versions

eggs = nltk
       html5lib
       pysolr
       python-openid
       django-shorturls

[versions]
django = 1.4.1

[python]
recipe = zc.recipe.egg
interpreter = python
eggs = ${buildout:eggs}

[django]
recipe = djangorecipe 
```

当我尝试 ./bin/python

```
>>> import pysolr
>>> pysolr           #  it worked from my buildout 
<module 'pysolr' from '/home/builout-tests/sandbox/eggs/pysolr-3.0.4-py2.7.egg/pysolr.pyc'>
>>> import django
>>> django.VERSION
(1, 3, 1, 'final', 0)  # its my django version in system's python dist-packages
>>> django
<module 'django' from '/usr/lib/python2.7/dist-packages/django/__init__.pyc'> 
```

以及如何为开发和生产版本保留不同版本的 python、django、pylsolr、nltk 等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:58:48.853

您在您的`[buildout]`角色中指定的鸡蛋并没有真正做任何事情。通常的做法是把你需要的鸡蛋分成几个部分放在那里，就像你`[python]`的`[django]`情况一样。

所以...修复第一是添加`eggs = ${buildout:eggs}`到你的`[django]`部分，因为这可能是你想要的。

关于 django/Django 大写/小写版本：有两种解决方案。如果您使用 2.0 之前的构建版本，请添加`extension = buildout-versions`到您的`[buildout]`部分。它打印它选择的版本，并删除区分大小写。

不过，最好的选择是使用最新的 2.0 版本。您可能必须`bootstrap.py`从[http://downloads.buildout.org/2/bootstrap.py](http://downloads.buildout.org/2/bootstrap.py)下载新的并重新运行 bootstrap 和`bin/buildout`. 这也消除了不区分大小写的问题。为了更清楚，添加`show-picked-versions = true`到您的`[buildout]`部分以获得精选版本的漂亮列表。这样更容易发现怪异和意外行为:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:32:44.653

尝试在 [versions] 部分中用 Django 替换 django（使用大写字母 D）

# javascript - 我有一个消息输出，我想要一个字橙色，其余正常

> ID：14836368
> 
> 赞同：0
> 
> 时间：2013-02-12T15:52:27.800
> 
> 标签：javascript, jquery, html, css

我希望伯恩茅斯这个词是红色的，但其余的词要从 p 样式继承。

```
<script type="text/javascript">
    $(document).ready(function() {
        var now = new Date();
        var hours = now.getHours();
        var msg;
        if (hours >= 0 && hours <= 12) msg = "Today's lunch deals in Bournemouth";
        else if (hours >= 13 && hours <= 19) msg = "Tonight's dinner deals in Bournemouth";
        else msg = "Tomorrow's lunch deals in Bournemouth";
        $('#time p').text(msg);
    });
</script>

<div id="time" style="position:absolute; width:100%; padding-top:90px; text-align:center; font-family: Arial, Helvetica, sans-serif; font-weight:bold; color:#FFF; font-size:17px;">
    <p></p> 
</div> 
```

我需要为 jQuery 颜色使用某些标签吗？我尝试了 HTML，但这只是打印出代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T15:55:01.937

为了设置单行或单词的样式，您可以使用`span`标签。

HTML：

```
<p>Lorem ipsum dolor sit <span class="red">amet</span></p> 
```

CSS：

```
.red
{
color:#FF0000;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T15:55:40.677

你不使用 jQuery 着色（或者至少不是直接的，你可以用它修改 CSS）

尝试这样的事情：

```
if (hours >= 0 && hours <= 12) msg = "Today's lunch deals in <span class='red'>Bournemouth</span>";
  else if (hours >= 13 && hours <= 19) msg = "Tonight's dinner deals in <span class='red'>Bournemouth</span>";
  else msg = "Tomorrow's lunch deals in <span class='red'>Bournemouth</span>"; 
```

然后在你的 html 文件中：

```
<style>
.red {
  color: red;
}
</style> 
```

你还需要`.text(`换`.html(`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T15:58:53.927

尝试如下..它会工作...

好的，然后`<p>`像下面这样使用..

```
msg = "Tomorrow's lunch deals in <p style='color:red'>Bournemouth</p>";
$('#time p').html(msg); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T16:02:06.913

将 span 添加到文本 msg 然后将其附加为 html

```
 $(document).ready(function() {
  var now = new Date();
  var hours = now.getHours();
  var msg = " deals in <span class='highlight'>Bournemouth</span>";
  if (hours >= 0 && hours <= 12) msg = "Today's lunch"+ msg;
  else if (hours >= 13 && hours <= 19) msg = "Tonight's dinner"+ msg;
  else msg = "Tomorrow's lunch" + msg;
  $('#time p').html(msg);
}); 
```

在你的 CSS 中添加一个高亮类：

```
.highlight{color:red;} 
```

# java - 我用 Java 制作了一个软件应用程序。我想为其应用一个 Windows 快捷键

> ID：14836369
> 
> 赞同：0
> 
> 时间：2013-02-12T15:52:35.747
> 
> 标签：java, windows

我用Java制作了一个软件应用程序。我想对其应用一个Windows快捷键，这样用户就不会每次都双击它。我该怎么做..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:00:23.503

You can right-click on the icon of your program and choose properties. In the "connection"-tab is a shortcut-field where you can apply any shortcut to your program.

My Windows is german, so it might not be the words "properties" or "connection" exactly ;)

But I don't tink that there is a way to give your program a shortcut by programming it into it.

# ember.js - 在emberjs中渲染belongsTo子项时出现错误_create

> ID：14836370
> 
> 赞同：1
> 
> 时间：2013-02-12T15:52:38.337
> 
> 标签：ember.js

我正在尝试`mediaitems`在我的`post`模板中渲染，但我收到了这个令人讨厌的控制台错误：

`Uncaught TypeError: Object photo has no method '_create'`

这些是我的模型和夹具数据：

```
/**************************
 * Models
 **************************/

App.Store = DS.Store.extend({
    revision: 11,
    adapter: 'DS.FixtureAdapter'
});

App.Mediaitem = DS.Model.extend({
    type: DS.attr('string'),
    url: DS.attr('string'),

    post: DS.belongsTo('App.Post')
});

App.Post = DS.Model.extend({
    type: DS.attr('string'),
    title: DS.attr('string'),
    summary: DS.attr('string'),
    body: DS.attr('string'),
    date: DS.attr('date'),

    mediaitems: DS.hasMany('App.Mediaitem', {embedded:true})
});

App.Post.FIXTURES = [
    {
        id:"post-one", 
        type:"news", 
        title:"First Post", 
        summary:"Ipsum Lorem", 
        date:"2013-02-07T16:44:57",
        mediaitems:[{
            id:593,
            post_id:"post-one",
            type:'photo',
            url:'http://www.google.com'
        },
        {
            id:789,
            post_id:"post-one",
            type:'photo',
            url:'http://www.google.com'
        }]
    }, 
    {
        id:"post-two",
        type:"gallery", 
        title:"Second Post", 
        summary:"Lorem ipsum", 
        date:"2013-02-07T16:44:57",
        mediaitems:[{
            id:342,
            post_id:"post-two",
            type:'photo',
            url:'http://www.google.com'
        },
        {
            id:231,
            post_id:"post-two",
            type:'photo',
            url:'http://www.google.com'
        }]
    }
]; 
```

这是我的模板代码：

```
 <script type="text/x-handlebars" data-template-name="post">
        <div class="detail">
            {{#linkTo posts}}close{{/linkTo}}<br/>
            <h2>{{id}} - {{title}}</h2>
            <br/>
            {{#each mediaitem in mediaitems}}
                print something
            {{/each}}
        </div>
    </script> 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:16:37.263

FIXTURE 适配器不支持嵌入式关系，至少在 rev 11 中不支持。您需要每个模型都有自己的带有记录的 FIXTURE 定义，并且关系具有正确的子/父的 id/s。

```
App.Post.FIXTURES = [
{
    id:"post-one", 
    type:"news", 
    title:"First Post", 
    summary:"Ipsum Lorem", 
    date:"2013-02-07T16:44:57",
    mediaitems:['593','789']
}, 
{
    id:"post-two",
    type:"gallery", 
    title:"Second Post", 
    summary:"Lorem ipsum", 
    date:"2013-02-07T16:44:57",
    mediaitems:['342','231']
}];

App.Mediaitems.FIXTURES = [{
        id:342,
        post_id:"post-two",
        type:'photo',
        url:'http://www.google.com'
    },
    {
        id:231,
        post_id:"post-two",
        type:'photo',
        url:'http://www.google.com'
    },
    {
        id:593,
        post_id:"post-one",
        type:'photo',
        url:'http://www.google.com'
    },
    {
        id:789,
        post_id:"post-one",
        type:'photo',
        url:'http://www.google.com'
    }]; 
```

# node.js - MongoDB ObjectId 使用

> ID：14836374
> 
> 赞同：1
> 
> 时间：2013-02-12T15:52:41.487
> 
> 标签：node.js, mongodb, mongoose, objectid

我在我的**NodeJS REST**项目中使用**MongoDB**和**Mongoose ODM ：**

 **我的模型**架构**是：

```
var playerSchema = new mongoose.Schema({
    name: String,
    team: mongoose.Schema.Types.ObjectId
}) 
```

和**服务器端**：

```
app.post('/players', function(req, res) {
  Players.find(function(err, players) {
    res.json(players);
  });
}); 
```

**回应**是：

```
...
{
  "_id": "511a6010e6ca7b0fe0af02ff",
  "name": "player-1",
  "team": "511a53e2e6ca7b151c09ce8d"
}
... 
```

但我想要类似的东西：

```
{
  "_id": "511a6010e6ca7b0fe0af02ff",
  "name": "player-1",
  "team": {
    _id: "511a53e2e6ca7b151c09ce8d"
    name: "team-1"
  }
} 
```

我做错了什么？或者我还没有真正理解 ObjectId？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T07:39:41.780

您只获取具有团队文档 ID 的玩家文档。

因此，对于每个玩家，您还必须获得团队文档。

```
Players.find(function(err, players) {
   for(var i in players){
      Team.findById(players[i].team,function(error,teams){
          players[i].team = teams;
      })
   }
    res.json(players);
}); 
```**

# c# - ASP.Net MVC 4 WebAPI 自定义路由

> ID：14836382
> 
> 赞同：7
> 
> 时间：2013-02-12T15:53:03.620
> 
> 标签：c#, asp.net, asp.net-mvc-4, asp.net-web-api

我的 WebAPI 项目中有一个名为 News 的控制器，我有两个名为 Get 的默认操作，用于处理以下 URL：

/api/News <- 这会返回一个新闻列表 /api/News/123 <- 这会通过 id 返回一个特定的新闻项目。

到目前为止，一切都很简单，显然默认路由可以处理这些场景。我接下来想要一个如下所示的 URL：

/api/News/123/Artists <- 将返回与指定新闻项目相关的所有艺术家。

现在我对 ASP.Net MVC 和 WebAPI 相当陌生，所以这是我第一次不得不处理路由。我已将默认路由修改为如下所示：

```
routes.MapRoute(
            name: "Default",
            url: "{controller}/{id}/{action}",
            defaults: new { controller = "News", action = "Get", id = UrlParameter.Optional } 
```

所以在这里我将 {action} 移到了 URL 的末尾，并在我的 News 控制器中添加了一个 Artists 方法。这仍然适用于前两种情况，但在第三种情况下返回 404。

显然路由不适用于 /api/News/123/Artists 但我不知道为什么。

我似乎找不到任何使用这样的 WebAPI 的人的例子，这让我觉得我做的事情根本上是错误的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T16:31:18.407

问题是，您正在尝试访问*Web API*但映射**ASP.NET MVC**

这是您需要的映射：

```
config.Routes.MapHttpRoute(
  name: "DefaultApi",
  routeTemplate: "api/{controller}/{id}/{action}",
  defaults: new {controller = "News", action = "Get", id = RouteParameter.Optional}
  ); 
```

并且应该在`App_Start \ WebApiConfig`（如果使用默认模板设置）中完成

方法示例（在您的新闻 API 控制器中）：

```
// GET api/values/5
public string Get(int id)
{
  return "value " + id;
}

// GET api/values/5
[HttpGet]
public string Artist(int id)
{
  return "artist " + id;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T10:19:06.037

[AttributeRouting](https://github.com/mccalltd/AttributeRouting)应该是一个很好的解决方案。可以安装`Nuget`，文档在[这里](http://attributerouting.net/)。

# 一些例子

```
public class SampleController : Controller
{
    [GET("Sample")]
    public ActionResult Index() { /* ... */ }

    [POST("Sample")]
    public ActionResult Create() { /* ... */ }

    [PUT("Sample/{id}")]
    public ActionResult Update(int id) { /* ... */ }

    [DELETE("Sample/{id}")]
    public string Destroy(int id) { /* ... */ }

    [Route("Sample/Any-Method-Will-Do")]
    public string Wildman() { /* ... */ }

    [GET("", ActionPrecedence = 1)]
    [GET("Posts")]
    [GET("Posts/Index")]
    public ActionResult Index() { /* ... */ }

    [GET("Demographics/{state=MT}/{city=Missoula}")]
    public ActionResult Index(string state, string city) { /* ... */ }
} 
```

它工作得很好`custom routing`。

## 更新

[在 asp.net WebApi 2 中，AttributeRouting 被原生包含在里面。](https://docs.microsoft.com/en-us/aspnet/web-api/overview/web-api-routing-and-actions/attribute-routing-in-web-api-2)它有一些历史，第一个版本，`asp.net WebApi 1`在路由注释方面很弱。

然后，`asp.net WebApi 2`被释放，`AttributeRouting`被原生包含。因此，该开放项目不再维护，在[GitHub 页面](https://github.com/mccalltd/AttributeRouting)中说。

[在 microsoft blog](https://blogs.msdn.microsoft.com/interoperability/2013/11/14/showcasing-open-source-community-contributors-to-entity-framework-asp-net-and-web-api-for-visual-studio/)中，该部分`Independent Developer Profile – Tim McCall – Attribute Routing in MVC and Web API 2`也谈到了历史。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T16:22:27.307

在路由中，Action 是您要路由到的方法上的操作名称。该操作名称应该在方法上使用的属性中。

```
 [HttpGet]
 [ActionName("CustomAction")]
public HttpResponseMessage MyNewsFeed(Some params)
{ return Request.CreateResponse(); } 
```

现在你的路线应该是这样的

```
routes.MapRoute(
        name: "Default",
        url: "{controller}/{id}/{action}",
        defaults: new { controller = "News", action = "CustomAction", id = UrlParameter.Optional 
```

让我知道这是否有帮助。

# java - 刷新 Eclipse 首选项页面的内容

> ID：14836387
> 
> 赞同：5
> 
> 时间：2013-02-12T15:53:20.230
> 
> 标签：java, eclipse, eclipse-plugin

谁能告诉我如何在修改父页面时刷新子页面？

...在子偏好页面的 createContents() 中，我正在监听对父级的更改：

```
ParentPlugin.getDefault()
    .getPreferenceStore()
    .addPropertyChangeListener(new IPropertyChangeListener()
    {
        public void propertyChange(PropertyChangeEvent event)
        {
            //REFRESH CHILD PLUGIN
        };
    }); 
```

# ftp - mget 提示覆盖

> ID：14836397
> 
> 赞同：12
> 
> 时间：2013-02-12T15:54:00.583
> 
> 标签：ftp, command-prompt

我在命令行（终端）中使用 ftp 将多个数据文件从远程服务器传输到我的本地计算机。目录中有多个文件（~40），我想将它们全部传输，而不必在每个文件的提示中回答是。我尝试了 mget * 但这仅传输了第一个文件，然后弹出第二个文件的提示。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-12T15:55:48.033

首先发出`prompt`命令以关闭交互式提示。

或者，如果您可以控制调用 ftp 命令的方式，请使用@reg-edit 建议的命令行选项：

`ftp [-i | --no-prompt] [OPTIONS] [HOST [PORT]]`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-18T17:32:14.827

`prompt`作为在其他命令之前发出命令的替代方法，您可以使用`-i`开关调用 ftp。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-29T13:38:32.793

当您已经开始时`ftp`，您可以发出`prompt`命令在提示和不提示之间切换。所以这应该可以解决问题：

```
> ftp <some server>
ftp> prompt
Interactive mode OFF .
ftp> mget * 
```

# javascript - 为什么画布在 chrome 中工作，而不是在 firefox 中工作？

> ID：14836402
> 
> 赞同：0
> 
> 时间：2013-02-12T15:54:09.327
> 
> 标签：javascript, html, canvas, parallax, requestanimationframe

我正在开发一个利用视差滚动的网站。它在 chrome 中看起来很漂亮，但我想绘制到画布上的图像都没有在 Firefox 中呈现。我很困惑。

这是HTML：

```
<!DOCTYPE html>

<html>

<head>
    <meta charset='utf8'>
    <link rel='stylesheet' type='text/css' href='style.css'>
</head>

<body>
    <canvas id='canvas' width="400" height="200"></canvas>
    <img id='dog' src='dog.gif'>

    <script src='script.js'></script>
</body>

</html> 
```

和 Javascript：

```
 //  shim layer with setTimeout fallback
window.requestAnimFrame = (function(){
  return  window.requestAnimationFrame       ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame    ||
          window.oRequestAnimationFrame      ||
          window.msRequestAnimationFrame     ||
          function( callback ){
          window.setTimeout(callback, 1000 / 60);
          };
})();

(function(win, d){

    var $ = d.querySelector.bind(d);
  var w = window.innerWidth;
  var h = d.height;
    var canvas = $('#canvas');
    var ctx = canvas.getContext('2d');
  var dog = $('#dog');
  var ticking = false;
  var relativeY = win.scrollY / h;

  function updateElements(){
    ctx.drawImage(dog, 10, pos(50, 0, relativeY, 0));
  };

  function paint(){
    requestAnimFrame(updateElements)
  };

  function onScroll(){
    if(!ticking){
      ticking = true;
      requestAnimFrame(updateElements);
      var lastScrollY = win.scrollY;
    }
  }

    function pos(base, range, relY, offset) {
    return base + limit(0, 1, relY - offset) * range;
  }

  function limit(min, max, value) {
    return Math.max(min, Math.min(max, value));
  }

  win.addEventListener('load', paint, false);
  win.addEventListener('scroll', onScroll, false);

})(window, document); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T19:59:52.473

我认为 firefox 还没有准备好展示良好的性能，因为我通过在一些不同的操作系统和最新版本的 firefox 和不同的 pc 中运行游戏来检查，我得到 20 fps

当我用 chrome 运行同一个游戏时，我得到了 60 fps

你可以自己试试运行这个游戏[测试器](http://codeincomplete.com/projects/racer/v4.final.html)

在左侧顶部你会看到小窗口测试器看到你在 Firefox 中的表现它会是 30 我认为不好。

# java - 如何从 Java 验证 WSDL URL 是否已启动并正在运行？

> ID：14836407
> 
> 赞同：3
> 
> 时间：2013-02-12T15:54:35.370
> 
> 标签：java, web-services, url, wsdl

我想从 Java 代码中检查 WSDL url 是否有效。这样我就可以使用另一个基于此的 url。

所以我正在检查这样的代码。

```
private boolean isValidWsdlURL(String wsdlUrl) 
{
    UrlValidator urlValidator = new UrlValidator();
    if(urlValidator.isValid(wsdlUrl)) 
    {
        return true;
    }
    logger.info("WSDL URL is not valid...");
    return false;
} 
```

但是，尽管我有有效的 URL，但它总是返回 false。 **WSDL URL 例如：** [http ://www.sample.com/MyWsdlService?wsdl](http://www.sample.com/MyWsdlService?wsdl)

因为 URL 以 ?wsdl 结尾如何查看代码？看起来我们只需要“ [http://www.sample.com](http://www.sample.com) ”就可以通过 UrlValidator。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:04:58.490

您正在尝试验证 WSDL URL？为什么不使用 java.net.URL 类？
并执行以下操作：

```
String urlStr = "http://www.example.com/helloService?wsdl";
URL url = null;
try {
  url = new URL(urlStr);
  URLConnection urlConnection = url.openConnection()
} catch (MalformedURLException ex) {
   System.out.println("bad URL");
} catch (IOException ex) {
   System.out.println("Failed opening connection. Perhaps WS is not up?");
} 
```

当我插入像 htt2p 而不是 http 这样的错误 URL 时，我得到了 - “bad url” print

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:28:26.557

试试这个..它现在对我有用。谢谢@zaske

```
public class TestWSDL {

public static void main(String args[]) {
    String urlStr = "http://www.example.com:8080/helloService?wsdl";
    URL url = null;
    URLConnection urlConnection = null;
    try {
      url = new URL(urlStr);
      urlConnection = url.openConnection();
      if(urlConnection.getContent() != null) {
          System.out.println("GOOD URL");
      } else {
          System.out.println("BAD URL");
      }
    } catch (MalformedURLException ex) {
       System.out.println("bad URL");
    } catch (IOException ex) {
       System.out.println("Failed opening connection. Perhaps WS is not up?");
    } 
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-29T10:24:47.763

```
import org.apache.commons.validator.UrlValidator; 
```

公共类 ValidateUrlExample{

```
public static void main(String[] args) {

    UrlValidator urlValidator = new UrlValidator();

    //valid URL
    if (urlValidator.isValid("http://www.mkyong.com")) {
       System.out.println("url is valid");
    } else {
       System.out.println("url is invalid");
    }

    //invalid URL
    if (urlValidator.isValid("http://invalidURL^$&%$&^")) {
        System.out.println("url is valid");
    } else {
        System.out.println("url is invalid");
    }}

} 
```

欲了解更多信息： [https ://www.mkyong.com/java/how-to-validate-url-in-java/](https://www.mkyong.com/java/how-to-validate-url-in-java/)

# java - Google App Engine Java Text Search API 在字符串搜索中与 python 的工作方式不同

> ID：14836410
> 
> 赞同：5
> 
> 时间：2013-02-12T15:54:39.360
> 
> 标签：java, google-app-engine, full-text-search

我正在尝试使用 Google App Engine Java Search API，但它没有按预期工作。事实上python和java搜索是不同的。

Python：
[网站](http://gae-text-search.appspot.com/)
[源代码](http://code.google.com/p/gae-text-search/source/browse/main.py)

Java：
[网站](http://gaecloudant.appspot.com/search)
[源代码](http://code.google.com/p/google-app-engine-samples/source/browse/trunk/search/java/src/com/google/appengine/demos/search/TextSearchServlet.java)

当我搜索“tes”时，python 会导致所有带有“test”但不是 java 的文档。它是 java sdk 中的错误吗，我使用的是 1.7.4？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:21:15.263

不幸的是，鉴于 API，这仍然是不可能的。

有关更多信息，请参阅这些帖子：

*   [部分匹配 GAE 搜索 API](https://stackoverflow.com/questions/12899083/partial-matching-gae-search-api/13171181)
*   [GAE 全文搜索 API 词组匹配](https://stackoverflow.com/questions/10523987/gae-full-text-search-api-phrase-matching/)

这也在这里记录为问题/缺陷：

*   [http://code.google.com/p/googleappengine/issues/detail?id=7689](http://code.google.com/p/googleappengine/issues/detail?id=7689)

# random - 我可以在 clojure 中进行确定性随机播放吗？

> ID：14836414
> 
> 赞同：9
> 
> 时间：2013-02-12T15:54:47.957
> 
> 标签：random, clojure, permutation, shuffle, deterministic

我想做一些随机播放，每次运行我的程序时都是一样的：

这是一种方法：

```
(def colours ["red" "blue" "green" "yellow" "cyan" "magenta" "black" "white"])

(defn colour-shuffle [n] 
  (let [cs (nth (clojure.math.combinatorics/permutations colours) n)]
    [(first cs) (drop 1 cs)]))

; use (rand-int 40320) to make up numbers, then hard code:
(def colour-shuffle-39038 (colour-shuffle 39038))
(def colour-shuffle-28193 (colour-shuffle 28193))
(def colour-shuffle-5667  (colour-shuffle 5667))
(def colour-shuffle-8194  (colour-shuffle 8194))
(def colour-shuffle-13895 (colour-shuffle 13895))
(def colour-shuffle-2345  (colour-shuffle 2345))

colour-shuffle-39038 ; ["white" ("magenta" "blue" "green" "cyan" "yellow" "red" "black")] 
```

但是评估需要一段时间，而且看起来很浪费而且相当不雅。

是否有某种方法可以直接生成 shuffle 39038，而无需生成和消耗所有序列？

（我已经意识到我可以对它们进行硬编码，或者用宏将精力带回到编译时间。这也似乎有点垃圾。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-09-08T08:26:52.657

`clojure.core/shuffle`uses `java.util.Collection/shuffle`，它采用可选的随机数生成器。 `clojure.core/shuffle`不使用此参数，但您可以使用它来创建 shuffle 的变体，该变体采用额外的种子值参数，并使用该种子值创建随机数生成器以传递给 `java.util.Collection/shuffle`：

```
(defn deterministic-shuffle
  [^java.util.Collection coll seed]
  (let [al (java.util.ArrayList. coll)
        rng (java.util.Random. seed)]
    (java.util.Collections/shuffle al rng)
    (clojure.lang.RT/vector (.toArray al)))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T19:58:06.367

听起来您想对[排列进行编号](http://en.wikipedia.org/wiki/Permutation#Numbering_permutations)：

```
(def factorial (reductions * 1 (drop 1 (range))))

(defn factoradic [n] {:pre [(>= n 0)]}
   (loop [a (list 0) n n p 2]
      (if (zero? n) a (recur (conj a (mod n p)) (quot n p) (inc p)))))

(defn nth-permutation [s n] {:pre [(< n (nth factorial (count s)))]}
  (let [d (factoradic n)
        choices (concat (repeat (- (count s) (count d)) 0) d)]
    ((reduce 
        (fn [m i] 
          (let [[left [item & right]] (split-at i (m :rem))]
            (assoc m :rem (concat left right) 
                     :acc (conj (m :acc) item))))
      {:rem s :acc []} choices) :acc))) 
```

让我们尝试一下：

```
(def colours ["red" "blue" "green" "yellow" "cyan" "magenta" "black" "white"])

(nth-permutation colours 39038)
=> ["white" "magenta" "blue" "green" "cyan" "yellow" "red" "black"] 
```

...就像问题一样，但没有产生任何其他排列。

好吧，但我们会得到它们吗？

```
(def x (map (partial nth-permutation colours) (range (nth factorial (count colours)))))

(count x)
=> 40320
(count (distinct x))
=> 40320
(nth factorial (count colours))
=> 40320 
```

请注意，排列是按（按索引的词典）顺序生成的：

```
user=> (pprint (take 24 x))
(["red" "blue" "green" "yellow" "cyan" "magenta" "black" "white"]
 ["red" "blue" "green" "yellow" "cyan" "magenta" "white" "black"]
 ["red" "blue" "green" "yellow" "cyan" "black" "magenta" "white"]
 ["red" "blue" "green" "yellow" "cyan" "black" "white" "magenta"]
 ["red" "blue" "green" "yellow" "cyan" "white" "magenta" "black"]
 ["red" "blue" "green" "yellow" "cyan" "white" "black" "magenta"]
 ["red" "blue" "green" "yellow" "magenta" "cyan" "black" "white"]
 ["red" "blue" "green" "yellow" "magenta" "cyan" "white" "black"]
 ["red" "blue" "green" "yellow" "magenta" "black" "cyan" "white"]
 ["red" "blue" "green" "yellow" "magenta" "black" "white" "cyan"]
 ["red" "blue" "green" "yellow" "magenta" "white" "cyan" "black"]
 ["red" "blue" "green" "yellow" "magenta" "white" "black" "cyan"]
 ["red" "blue" "green" "yellow" "black" "cyan" "magenta" "white"]
 ["red" "blue" "green" "yellow" "black" "cyan" "white" "magenta"]
 ["red" "blue" "green" "yellow" "black" "magenta" "cyan" "white"]
 ["red" "blue" "green" "yellow" "black" "magenta" "white" "cyan"]
 ["red" "blue" "green" "yellow" "black" "white" "cyan" "magenta"]
 ["red" "blue" "green" "yellow" "black" "white" "magenta" "cyan"]
 ["red" "blue" "green" "yellow" "white" "cyan" "magenta" "black"]
 ["red" "blue" "green" "yellow" "white" "cyan" "black" "magenta"]
 ["red" "blue" "green" "yellow" "white" "magenta" "cyan" "black"]
 ["red" "blue" "green" "yellow" "white" "magenta" "black" "cyan"]
 ["red" "blue" "green" "yellow" "white" "black" "cyan" "magenta"]
 ["red" "blue" "green" "yellow" "white" "black" "magenta" "cyan"]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T16:24:35.587

我的建议：使用闭包并只计算一次排列。然后重新使用这些排列从中选择一个元素。在您的函数`colour-shuffle`中，每次调用都会重新计算排列，这不是很有效。

```
(use 'clojure.math.combinatorics)

(def colours ["red" "blue" "green" "yellow" "cyan" "magenta" "black" "white"])

(def select-permutation
  (let [perms (permutations colours)]
    (fn [n]
      (nth perms n))))

(defn colour-shuffle [n] 
  (let [cs (nth (permutations colours) n)]
    [(first cs) (drop 1 cs)]))

(time (do  (def colour-shuffle-39038 (colour-shuffle 39038))
           (def colour-shuffle-28193 (colour-shuffle 28193))
           (def colour-shuffle-5667  (colour-shuffle 5667))
           (def colour-shuffle-8194  (colour-shuffle 8194))
           (def colour-shuffle-13895 (colour-shuffle 13895))
           (def colour-shuffle-2345  (colour-shuffle 2345))))

(time (do (def select-permutation-39038 (select-permutation 39038))
          (def select-permutation-28193 (select-permutation 28193))
          (def select-permutation-5667  (select-permutation 5667))
          (def select-permutation-8194  (select-permutation 8194))
          (def select-permutation-13895 (select-permutation 13895))
          (def select-permutation-2345  (select-permutation 2345))))

(time (do  (def colour-shuffle-39038 (colour-shuffle 39038))
           (def colour-shuffle-28193 (colour-shuffle 28193))
           (def colour-shuffle-5667  (colour-shuffle 5667))
           (def colour-shuffle-8194  (colour-shuffle 8194))
           (def colour-shuffle-13895 (colour-shuffle 13895))
           (def colour-shuffle-2345  (colour-shuffle 2345))))

(time (do (def select-permutation-39038 (select-permutation 39038))
          (def select-permutation-28193 (select-permutation 28193))
          (def select-permutation-5667  (select-permutation 5667))
          (def select-permutation-8194  (select-permutation 8194))
          (def select-permutation-13895 (select-permutation 13895))
          (def select-permutation-2345  (select-permutation 2345)))) 
```

输出：

```
"Elapsed time: 129.023 msecs"
"Elapsed time: 65.472 msecs"
"Elapsed time: 182.226 msecs"
"Elapsed time: 5.715 msecs" 
```

请注意，使用选择排列的第二次运行时间甚至更快。这是因为惰性序列的结果在计算后被缓存。请求一个非常深入惰性序列的元素将导致所有前面的元素也被计算。这就是为什么第一次运行需要更长的时间。当从新的惰性序列请求第 39039 个元素时，将导致至少计算 39040 个元素（以 32 个为单位）。

顺便说一句，如果你的随机数无论如何都要被硬编码，你不妨硬编码上面检索到的排列。

# c# - 具有完成事件的异步方法

> ID：14836416
> 
> 赞同：8
> 
> 时间：2013-02-12T15:54:48.710
> 
> 标签：c#, .net, asynchronous

我使用.net 4.0，我试图弄清楚如何使用异步方法来等待 DocumentCompleted 事件完成并返回值。我的原始代码在上面，在这种情况下我怎样才能把它变成 async/await 模型？

```
private class BrowserWindow
    {
        private bool webBrowserReady = false;
        public string content = "";

        public void Navigate(string url)
        {

            xxx browser = new xxx();

            browser.DocumentCompleted += new EventHandler(wb_DocumentCompleted);
            webBrowserReady = false;
            browser.CreateControl();
            if (browser.IsHandleCreated)
                browser.Navigate(url);

            while (!webBrowserReady)
            {
                //Application.DoEvents(); >> replace it with async/await 
            }

        }

        private void wb_DocumentCompleted(object sender, EventArgs e)
        {
            try
            {
               ...

                  webBrowserReady = true;

                  content = browser.Document.Body.InnerHtml;

            }
            catch
            {

            }

        }

        public delegate string AsyncMethodCaller(string url);
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T16:16:50.733

所以我们需要一个在`DocumentCompleted`事件触发时返回任务的方法。任何时候你需要一个给定的事件，你可以创建一个这样的方法：

```
public static Task WhenDocumentCompleted(this WebBrowser browser)
{
    var tcs = new TaskCompletionSource<bool>();
    browser.DocumentCompleted += (s, args) => tcs.SetResult(true);
    return tcs.Task;
} 
```

一旦你有了，你可以使用：

```
await browser.WhenDocumentCompleted(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-03T03:44:42.837

@Servy 有我正在寻找的天才答案，但它不适用于我的用例。`TaskCompletionSource`由于事件处理程序试图在后续事件调用上设置结果，我在多次引发事件时发现错误。

我从两个方面加强了他的回答。第一个是`DocumentCompleted`在第一次处理后取消订阅该事件。

```
public static Task WhenDocumentCompleted(this WebBrowser browser)
{
    var tcs = new TaskCompletionSource<bool>();
    browser.DocumentCompleted += DocumentCompletedHandler;
    return tcs.Task;

    void DocumentCompletedHandler(object sender, EventArgs e)
    {
        browser.DocumentCompleted -= DocumentCompletedHandler;
        tcs.SetResult(true);
    }
} 
```

> 注意我在这里使用本地函数来捕获`TaskCompletionSource`实例，这至少需要 C# 7.0。

第二个增强是添加超时。我的特定用例是在单元测试中，我想让等待我的特定事件具有确定性，而不是在出现问题时无限期等待。

我为此选择使用计时器，并将其设置为仅触发一次，然后在不再需要时停止计时器。或者可以利用`CancellationToken`这里来管理，`TaskCompletionSource`但我觉得这需要维护者更多地了解它们的用法，并且计时器更容易被普遍理解。

```
public static Task WhenDocumentCompleted(this WebBrowser browser, int timeoutInMilliseconds = 500)
{
    var tcs = new TaskCompletionSource<bool>();

    var timeoutTimer = new System.Timers.Timer(timeoutInMilliseconds);
    timeoutTimer.AutoReset = false;
    timeoutTimer.Elapsed += (s,e) => tcs.TrySetCanceled();
    timeoutTimer.Start();

    browser.DocumentCompleted += DocumentCompletedHandler;

    return tcs.Task;

    void DocumentCompletedHandler(object sender, EventArgs e)
    {
        timeoutTimer.Stop();
        browser.DocumentCompleted  -= DocumentCompletedHandler;
        tcs.TrySetResult(true);
    }
} 
```

> 请注意，为了确保代码是线程安全的，我在这里采取了更多的防御措施并使用了`Try...`函数。这确保即使发生边缘情况交错执行，设置结果也不会出错。

# java - 遍历freemarker中的hashmap

> ID：14836417
> 
> 赞同：3
> 
> 时间：2013-02-12T15:54:50.610
> 
> 标签：java, freemarker

我有一个如下所示的哈希图

```
HashMap<String, String> testStatus = new HashMap<String, String>();
Map root = new HashMap();

public void fmTest() {

testStatus.put("one","1");
testStatus.put("two","2");
testStatus.put("three","3");
root.put("status", testStatus);
testStatus.clear();
} 
```

**我的超频：**

```
<#list status?keys as key> 
${key} = ${status[key]}
</#list> 
```

上面的代码只是一个例子。我的问题是，如果我循环 testStatus 哈希图以在每个循环中具有不同的值并在循环结束时清除......我怎样才能让 freemarker 从每个循环中显示 testStatus 哈希图的键值对。

如果我不清除 testStatus 哈希图，我会得到累积的结果。但是，如果我清除 testStatus 哈希图，freemarker 不会显示任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-17T09:40:07.553

```
HashMap<String, String> testStatus = new HashMap<String, String>(); 
```

把这个声明放到 fmTest 方法中，那么每次调用该方法时，都会在根中放入一个新的 Map ，这样就不会被累加了……

# java - Java TableModel：通过单击最后一行动态添加一行

> ID：14836419
> 
> 赞同：0
> 
> 时间：2013-02-12T15:54:54.257
> 
> 标签：java, swing, jtable, row, tablemodel

所以我试图实现一个动态可编辑的列表，当我点击最后一行或编辑最后一行时，我想动态添加一行。尽管我想知道如何实现 actionlistener，但我知道如何添加行。帮助将不胜感激。

```
 import java.awt.BorderLayout;
 import java.util.Date;

 import javax.swing.Icon;
 import javax.swing.ImageIcon;
 import javax.swing.JFrame;
 import javax.swing.JScrollPane;
 import javax.swing.JTable;
 import javax.swing.table.AbstractTableModel;
 import javax.swing.table.TableModel;

 public class EditListAction {
   public static void main(String args[]) {
     TableModel model = new AbstractTableModel() {
  Object rowData[] = {"English","hindi","Spanish","Russian" };

       String columnName = new String("Languages");

       public int getColumnCount() {
         return 1;
       }

       public String getColumnName() {
         return columnName;
       }

       public int getRowCount() {
         return rowData.length;
       }

       public Object getValueAt(int row,int col) {
         return rowData[row];
       }

       public Class getColumnClass(int column) {
         return (getValueAt(0, 1).getClass());
       }

       public void setValueAt(Object value, int row,int column) {
          if(column==0){
         rowData[row] = value;
          }
       }

       public boolean isCellEditable(int row, int column) {
         return (column == 0);
       }

     };

     JFrame frame = new JFrame("Column Renderer Table");
     JTable table = new JTable(model);
     JScrollPane scrollPane = new JScrollPane(table);
     frame.getContentPane().add(scrollPane, BorderLayout.CENTER);
     frame.setSize(400, 150);
     frame.setVisible(true);
   }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:14:10.293

> 我知道如何添加行

不是基于您发布的代码。您的自定义 TableModel 使用固定大小的数组来存储数据。因此，除非您每次都重新创建数组，否则您将无法添加新行，这不是很有效。

相反，只需使用 DefaultTableModel。它已经支持 addRow(...) 方法。

如果要在单击最后一行时添加一行，则将 MouseListener 添加到表中。然后您可以使用 JTable 的 rowAtPoint(...) 方法来确定是否单击了最后一行。

如果要在编辑最后一行时添加一行，则可以将 TableModelListener 添加到 TableModel。然后，您可以侦听最后一行的更新。

# android - 使用 TabActivity 的 BadTokenException ActivityGroup

> ID：14836420
> 
> 赞同：3
> 
> 时间：2013-02-12T15:54:57.597
> 
> 标签：android, fragment, nested-class, tabactivity, activitygroup

我需要在我的应用程序中实现 TabHost 中的嵌套活动。我使用这样的 ActivityGroup 类：

```
 public class CustomActivityGroup extends ActivityGroup {

View rootView;

public static CustomActivityGroup group;

private ArrayList<View> history;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.history = new ArrayList<View>(); group = this;

      View view = getLocalActivityManager().startActivity("LoginActivity", new Intent(this,RegisterActivity.class) .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP))
      .getDecorView();
      replaceView(view);

}

@Override
protected void onResume() {

    super.onResume();
    this.history = new ArrayList<View>();
    group = this;

}

public void replaceView(View v) {

    if (history.size() == 0) {
        if (rootView != null) {
            history.add(rootView);
            rootView = null;
        }
    }
    history.add(v);  
    setContentView(v);
}

public void back() {
    try {
        if (history.size() > 0) {
        history.remove(history.size() - 1);
        if (history.size() > 0) {
            setContentView(history.get(history.size() - 1));
        } else {
            finish();
        }
    } else {
        finish();
    }
    } catch (Exception ex) {
    }
}

public int getHistorySize() {
    return history.size();
}

@Override
public void onBackPressed() {
    try {
        CustomActivityGroup.group.back();
    } catch (Exception ex) {

    }
    return;
}
} 
```

在我的 TabActivity 中：

```
 intent = new Intent().setClass(this, CustomActivityGroup.class);

    spec = tabHost.newTabSpec("tab_2").setIndicator("Sign up",getResources().getDrawable(R.drawable.signup)).setContent(intent);
    tabHost.addTab(spec); 
```

但是当我点击相应的标签时，我得到

```
 FATAL EXCEPTION: main
 java.lang.RuntimeException: Unable to start activity ComponentInfo{com.assignmentexpert/com.activitygroups.CustomActivityGroup}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.assignmentexpert/com.assignmentexpert.RegisterActivity}: android.view.WindowManager$BadTokenException: Unable to add window -- token android.app.LocalActivityManager$LocalActivityRecord@405ceb00 is not valid; is your activity running?
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1491)
    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)

    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
    at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:676)
    at android.widget.TabHost.setCurrentTab(TabHost.java:348)
    at android.widget.TabHost$2.onTabSelectionChanged(TabHost.java:141)
    at android.widget.TabWidget$TabClickListener.onClick(TabWidget.java:456)
    at android.view.View.performClick(View.java:2485)
    at android.view.View$PerformClick.run(View.java:9080)
    at android.os.Handler.handleCallback(Handler.java:587)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:123)
    at android.app.ActivityThread.main(ActivityThread.java:3687)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.assignmentexpert/com.assignmentexpert.RegisterActivity}: android.view.WindowManager$BadTokenException: Unable to add window -- token android.app.LocalActivityManager$LocalActivityRecord@405ceb00 is not valid; is your activity running?
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1491)
    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
    at com.activitygroups.CustomActivityGroup.onCreate(CustomActivityGroup.java:31)
    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
    ... 18 more
 Caused by:  Unable to add window -- token android.app.LocalActivityManager$LocalActivityRecord@405ceb00 is not valid; is your activity running?
    at android.view.ViewRoot.setView(ViewRoot.java:532)
    at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
    at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
    at android.view.Window$LocalWindowManager.addView(Window.java:424)
    at android.app.Dialog.show(Dialog.java:241)
    at com.asynctaskbase.AbstractTaskProgressDialogFragment.onCreateDialog(AbstractTaskProgressDialogFragment.java:68)
    at com.asynctaskbase.AbstractTaskProgressDialogFragment.onCreateDialog(AbstractTaskProgressDialogFragment.java:1)
    at android.support.v4.app.DialogFragment.getLayoutInflater(DialogFragment.java:295)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:871)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
    at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:523)
    at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1129)
    at android.app.Activity.performStart(Activity.java:3791)
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1624)
    ... 24 more 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T11:19:35.817

我找到了这个问题的原因。我将 FragmentActivities 添加到 ActivityGroup，然后在 TabHost 中使用它们。当我单击名为 ProgressDialog 的按钮时，我得到了这个异常。我应该像这样创建它

```
progressDialog = new ProgressDialog(getActivity().getParent()); 
```

， 不是

```
 progressDialog = new ProgressDialog(getActivity()); 
```

# drupal - 用于分类的高级 Drupal View 过滤器

> ID：14836423
> 
> 赞同：0
> 
> 时间：2013-02-12T15:55:03.467
> 
> 标签：drupal, drupal-views, drupal-exposed-filter

我有一个名为产品模板的内容类型。在此内容中，我捕获了以下字段：标题（核心）、内容正文、分类术语参考和 6 种不同的文件类型。为我们拥有的每个模板创建一个新的产品模板内容。假设我们的产品是小部件，按颜色分类......蓝色、黑色、棕色、粉色、绿色等......

分类有主要的产品模板类别，例如：蓝色小部件、黑色小部件等。每个都有不同尺寸的多个模板，因此该术语将引用尺寸/样式，小部件、中、大、方形、圆形， ETC。

使用视图分类/术语/％附带的默认分类覆盖并将过滤器限制为产品模板和使用字段，而不是完整内容，我得到一个类似这样的列表：blue-widget small -> template b1s, template b2s,模板 b3s... / blue-wiget medium -> 模板 b1m、模板 b2m 等等。所以我最终得到的是所有产品模板及其相关模板文件的完整列表。

我希望发生的是，当访问者在分类/术语/％时，他们会看到一个显示不同选项的下拉或跳转菜单，然后当他们点击（例如）蓝色小部件时，相关的模板在页面上呈现/填充。所以基本上我想删除列表并将其变成一个可选区域。由于可能有大量选项/尺寸，我不想有一个包含 20 个滚动条的列表，也不想使用寻呼机。向他们展示一个下拉列表似乎更合乎逻辑，其中包含他们选择所需的所有选项/尺寸，然后只拉出那些模板。

关于如何实现这一点的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T11:23:41.060

您应该能够通过将过滤器添加到作为分类术语的视图中来完成此操作，然后将其设置为公开并使用以下 url 访问所有文档。

taxonomy/term/all（这应该显示所有文档）

这意味着它适用于所有词汇表，所以如果你只有一个词汇表不是问题。

# python - Python pandas，如何仅绘制实际具有数据点的 DataFrame 并留下空白

> ID：14836425
> 
> 赞同：5
> 
> 时间：2013-02-12T15:55:11.470
> 
> 标签：python, plot, dataframe, pandas

我有一个使用 DatetimeIndex 索引的日内数据的 DataFrame

```
df1 =pd.DataFrame(np.random.randn(6,4),index=pd.date_range('1/1/2000',periods=6, freq='1h'))
df2 =pd.DataFrame(np.random.randn(6,4),index=pd.date_range('1/2/2000',periods=6, freq='1h'))
df3 = df1.append(df2) 
```

可以看出两天之内有很大的差距`df3`

df3.plot()

将每隔一小时从`2000-01-01 00:00:00`to绘制一次`2000-01-02 05:00:00`，而实际上 from `2000-01-01 06:00:00`to`2000-01-02 00:00:00`实际上没有数据点。

如何将这些数据点留在图中以便不绘制from `2000-01-01 06:00:00`to ？`2000-01-02 00:00:00`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:35:44.557

一种方法是[`resample`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.resample.html)在绘制之前（每小时）：

```
df3.resample('H').plot() 
```

注意：这可确保您在未绘制（而不是连接）的实际值之间具有 NaN 值。*这意味着您要在此处存储更多数据，这可能是个问题。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T17:26:22.400

这似乎已经在 Google Groups 讨论了一段时间。

[Pandas 日内时间序列图](https://groups.google.com/forum/#!msg/pydata/x46E9Gpac68/oO2w2TiYR4w)

# c# - 我无法更改 Gridview 中的列值

> ID：14836427
> 
> 赞同：2
> 
> 时间：2013-02-12T15:55:14.100
> 
> 标签：c#, datagridview

我正在尝试将自动编号列插入 C# 中的 datagridview 控件。

一切正常，但我无法在专栏中写任何东西。它仍然是空的。

我怎样才能解决这个问题？

下面是我的代码（grv - gridview，ds-dataset）：

```
 grv1.AutoGenerateColumns = false;
        grv1.DataSource = ds.Tables[0];        
        grv1.Columns[0].DataPropertyName = "LastName";

        DataGridViewTextBoxColumn nrCol = new DataGridViewTextBoxColumn();
        nrCol.Name = "Nr";
        nrCol.HeaderText = "Nr";
        grv.Columns.Insert(0, nrCol);
        grv.Columns[0].ReadOnly = false;

        for (int i=0;i<grv.Rows.Count;i++)
        {
            grv.Rows[i].Cells[0].Value = i.ToString();       
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:01:51.257

Do you have rows in your grid? I see code that adds a column, and a loop that changes the field for every present row, but I don't see code that adds rows.

You need to call `grv.Rows.Add(...)` with a pre-filled `DataGridViewRow` within your loop.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:04:26.073

我认为您需要***在绑定数据源之后***`find the control`（`assign the value to the Text property of TextBox control` 而不是单元格）；单元格值可能不可见，因为 TextBox 正在覆盖它...

 *```
//your code here
...
//assign data source (if you have any)
grv.DataSource = YourDataSource;
//bind the gridview
grv.DataBind();

//now you can loop through the gridview as below
for (int i=0;i<grv.Rows.Count;i++)
{
    TextBox txt = (TextBox)grv.Rows[i].FindControl("Nr");
    txt.Text = i.ToString();
} 
```

***或者***你可以像下面这样巧妙地做到这一点；

***后面的代码：***

```
//define index variable in the code behind
protected int index = 1; 
```

***HTML：***

```
<!--Add this column to the GridView with your text box -->
<asp:TemplateField>
   <ItemTemplate>
       <asp:TextBox runat="server" ID="Nr" text='<%# index ++ %>'></asp:TextBox>
   </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T10:31:44.273

谢谢大家，我自己解决了这个问题，有点脏。

这个行号很方便，我将它添加到我的技巧中；）

但是这次我所做的是将我创建的数据网格列绑定到数据集中的一些随机列。当它解开时，我什么也写不出来。当它被绑定时，我很容易覆盖了这些值

```
 grv1.AutoGenerateColumns = false;
    grv1.DataSource = ds.Tables[0];        
    grv1.Columns[0].DataPropertyName = "LastName";

    DataGridViewTextBoxColumn nrCol = new DataGridViewTextBoxColumn();
    nrCol.Name = "Nr";
    nrCol.HeaderText = "Nr";
    grv1.Columns.Insert(0, nrCol);
    grv1.Columns[0].ReadOnly = false;

    //!!!!!!!!!!!!!!!!!!!!!!
    grv1.Columns[0].DataPropertyName = "Postal code"; //or whatever existing column 

    for (int i=0;i<grv.Rows.Count;i++)
    {
        grv.Rows[i].Cells[0].Value = i.ToString();       
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T22:34:48.023

如果我是正确的，你有 Person Table 或类似的东西。您不需要以`autonumber`这种方式为该表创建一个，只需从您的数据库中设置该表的`primary key`and`auto-increment = true`并完成。

**更新**

只需阅读您的评论，这是解决您问题的好方法。[ROW_NUMBER 行](http://msdn.microsoft.com/en-us/library/ms186734.aspx)。*

# android - 退出后Android应用程序似乎继续运行

> ID：14836428
> 
> 赞同：1
> 
> 时间：2013-02-12T15:55:18.753
> 
> 标签：android, service

这可能是一个愚蠢的问题，但我的应用程序似乎在我停止它之后仍然在运行。我通过按住主页键并将应用程序拖到左侧来关闭它。但是，我仍然看到 logcat 输出，它只有在我转到设置--> 应用程序--> 运行应用程序并以这种方式停止时才会停止。这是我的应用程序中的错误还是这是预期的 android 行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:57:28.143

[这是意料之中的](http://developer.android.com/reference/android/app/Activity.html)。[安卓行为](http://developer.android.com/training/basics/activity-lifecycle/starting.html)

与许多其他操作系统不同，Android 默认情况下没有用于手动关闭应用程序的专用按钮。这是因为 Android 旨在管理正在运行的应用程序本身并根据需要关闭它们。

根据设计，Android 处理分配给应用程序的内存和时间。这可确保保持打开状态的应用程序不会导致智能手机速度变慢或内存不足。

当按下 Home 按钮时，您的应用程序将进入后台，Android O/S 将在内存不足时将其关闭。如果没有，您再次打开该应用程序，它会从您离开的地方继续。除非您在应用程序中专门创建一个方法来关闭（完成）您的应用程序。

# highcharts - Highcharts：绘图边界的角半径

> ID：14836431
> 
> 赞同：0
> 
> 时间：2013-02-12T15:55:23.290
> 
> 标签：highcharts

有没有办法为“绘图边界”提供角半径值？寻找类似于图表边框的borderRadius 选项的东西。但我们需要它用于情节边界。

我尝试在使用以下加载图表后添加半径，但它不起作用

```
chart.plotBorder.rx=5;
chart.plotBorder.ry=5;
chart.redraw(); 
```

感谢任何帮助谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:13:27.250

使用`element.attr()`方法：

```
 load: function(){
                this.plotBorder.attr({rx: 10, ry: 10})
            } 
```

见例子：http: [//jsfiddle.net/3bQne/45/](http://jsfiddle.net/3bQne/45/)

但是，如您所见，它不会像您预期的那样工作。

# android - 将 Geocoder getFromLocationName 范围限制为一个特定的城市

> ID：14836432
> 
> 赞同：0
> 
> 时间：2013-02-12T15:55:26.387
> 
> 标签：android

以下是我的方法：

```
List<Address> addresses = null;
    addresses = new Geocoder(passengerHomeActivity).getFromLocationName(this.addressInput.getText().toString(), 1); 
```

有没有办法将`Geocoder` `getFromLocationName`' 的范围限制在一个特定的城市？有时，当我输入一个地址而不写城市名称时，它会将我带到一个相同的地址，但在另一个城市。

我的想法是通过获取用户的`latitude`和`longitude`，获取城市的价值，并将限制范围设置为`getFromLocationName`方法，但我对实现没有任何线索。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-04T13:31:47.397

使用此代码：

```
List<Address> addresses = new Geocoder(passengerHomeActivity).getFromLocationName((this.addressInput.getText().toString()) + ", YourCity, YourCountry", 1);` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-15T12:30:00.583

使用传递区域设置的构造函数。

```
Geocoder(Context context, Locale locale) 
```

像这样使用它：

```
Locale locale = new Locale(Locale.getDefault().getLanguage(), "US");
Geocoder geo = new Geocoder(context, locale)
addresses = geo.getFromLocationName(term, 1); 
```

请注意，这是一种方法，因为它会在该国家/地区为您提供结果，除非什么也没找到（在这种情况下，无论如何都会在全球范围内返回）。

# windows-services - 更改服务帐户密码

> ID：14836437
> 
> 赞同：1
> 
> 时间：2013-02-12T15:55:45.697
> 
> 标签：windows-services, active-directory

我的任务是更改组织内所有服务帐户的密码，并感谢之前解决过此问题的人的一些指示。

我已经确定了每个服务帐户以及使用该帐户的每台机器和服务。我想要的是有关如何实际执行此过程的一些指导。这是一个生产环境，我不想在工作时间破坏东西。

该过程是否像更改服务帐户密码、然后登录每个服务器、找到每个服务并在“登录”选项卡下更改相关信息一样简单/乏味？

有更好的方法吗？感谢您的建议/指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:04:26.150

差不多就是这样。

我的建议是复制具有相同权限的帐户（但在末尾加上“2013”​​或其他内容），然后在您更改密码时，也将服务重定向到该帐户。

这样做的原因是，至少有几次，一些随机遗留应用程序在服务帐户重置期间出现故障，纯粹是因为没有人知道它正在使用它/在刷新时错过了它/不知道它。这样，您触摸的所有内容都应该没问题，然后您可以监控现在的“旧”帐户以供任何使用。

/edit 实际上更改用户名/密码可以编写脚本，但这完全取决于您对更改的谨慎程度以及您是否希望能够轻松停止执行！有关示例，请参见[http://gallery.technet.microsoft.com/scriptcenter/79644be9-b5e1-4d9e-9cb5-eab1ad866eaf 。](http://gallery.technet.microsoft.com/scriptcenter/79644be9-b5e1-4d9e-9cb5-eab1ad866eaf)（您还需要考虑需要在哪些操作系统范围内执行此操作 - PowerShell 仅适用于某些操作系统，VBS 将适用于其他操作系统，但您需要进一步考虑，以及 NT4 ...... ;)）

# android - AndEngine BoundCamera 没有以正确的方式追逐实体

> ID：14836439
> 
> 赞同：0
> 
> 时间：2013-02-12T15:55:48.253
> 
> 标签：android, camera, andengine

我已经自定义了 BoundCamera 并将更新方法覆盖为：

```
@Override
public void onUpdate(float pSecondsElapsed) {
    // TODO Auto-generated method stub
    super.onUpdate(pSecondsElapsed);
    if(chaseEntity != null) {

        tempHeight = (chaseEntity.getY() * PIXEL_TO_METER_RATIO_DEFAULT) + PlayLevelActivity.CAMERA_HEIGHT/2;

        if(tempHeight < heightCovered) {
            setBounds(0, 0, PlayLevelActivity.CAMERA_WIDTH, tempHeight);

            heightCovered = tempHeight;
        }
    }

} 
```

并将相机初始化为：

```
mCamera = new MyBoundCamera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT, 0, CAMERA_WIDTH, 0, CAMERA_HEIGHT); 
```

我想一直把追逐实体放在中心。现在我面临的问题是，在开始时，相机追逐实体。随着实体越来越高，它在 y 方向上超出屏幕边界。我正在更新更新方法中的相机边界，以使实体始终位于中心但不工作。ChaseEntity.getY() 获取物理体的 y 位置。有谁知道我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T16:42:03.710

如果你使用

```
this.mBoundChaseCamera.setChaseEntity(Sptite);
setBoundsEnabled(false); 
```

那么精灵仍然会一直在屏幕的中心。缺点是精灵可能超出范围。您必须实现自己的方法以将精灵保持在界限内。

在您提到的评论中，您希望精灵在某些时候下降，但不希望它在下降时保持在中心。你可以使用

```
this.mBoundChaseCamera.setChaseEntity(null); 
```

然后将精灵放到屏幕底部。这应该提供类似于 papi jump 的效果。

# android - 使用 MySQL 进行 Android 注册和登录

> ID：14836440
> 
> 赞同：0
> 
> 时间：2013-02-12T15:55:48.287
> 
> 标签：android, sql, xml, json, sqlite

我正在开发一个 Android 应用程序，我坚持使用用户注册和登录的功能。

我需要将信息存储在 MySQL DB 上。

现在我已经编写了这个函数，但它没有运行。我有一个我无法弄清楚的错误。

这是我的主要java文件：

```
package com.example.androidhive;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import com.example.androidhive.library.UserFunctions;

public class DashboardActivity extends Activity {
UserFunctions userFunctions;
Button btnLogout;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    /**
     * Dashboard Screen for the application
     * */        
    // Check login status in database
    userFunctions = new UserFunctions();
    if(userFunctions.isUserLoggedIn(getApplicationContext())){
        setContentView(R.layout.dashboard);
        btnLogout = (Button) findViewById(R.id.btnLogout);

        btnLogout.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                userFunctions.logoutUser(getApplicationContext());
                Intent login = new Intent(getApplicationContext(), LoginActivity.class);
                login.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(login);
                // Closing dashboard screen
                finish();
            }
        });

    }else{
        // user is not logged in show login screen
        Intent login = new Intent(getApplicationContext(), LoginActivity.class);
        login.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(login);
        // Closing dashboard screen
        finish();
    }

}} 
```

我的注册功能

```
package com.example.androidhive;

import org.json.JSONException;
import org.json.JSONObject;
import com.example.androidhive.library.DatabaseHandler;
import com.example.androidhive.library.UserFunctions;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class RegisterActivity extends Activity {
Button btnRegister;
Button btnLinkToLogin;
EditText inputFullName;
EditText inputEmail;
EditText inputPassword;
TextView registerErrorMsg;

// JSON Response node names
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_ERROR_MSG = "error_msg";
private static String KEY_UID = "uid";
private static String KEY_NAME = "name";
private static String KEY_EMAIL = "email";
private static String KEY_CREATED_AT = "created_at";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.register);

    // Importing all assets like buttons, text fields
    inputFullName = (EditText) findViewById(R.id.registerName);
    inputEmail = (EditText) findViewById(R.id.registerEmail);
    inputPassword = (EditText) findViewById(R.id.registerPassword);
    btnRegister = (Button) findViewById(R.id.btnRegister);
    btnLinkToLogin = (Button) findViewById(R.id.btnLinkToLoginScreen);
    registerErrorMsg = (TextView) findViewById(R.id.register_error);

    // Register Button Click event
    btnRegister.setOnClickListener(new View.OnClickListener() {         
        public void onClick(View view) {
            String name = inputFullName.getText().toString();
            String email = inputEmail.getText().toString();
            String password = inputPassword.getText().toString();
            UserFunctions userFunction = new UserFunctions();
            JSONObject json = userFunction.registerUser(name, email, password);

            // check for login response
            try {
                if (json.getString(KEY_SUCCESS) != null) {
                    registerErrorMsg.setText("");
                    String res = json.getString(KEY_SUCCESS); 
                    if(Integer.parseInt(res) == 1){
                        // user successfully registred
                        // Store user details in SQLite Database
                        DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                        JSONObject json_user = json.getJSONObject("user");

                        // Clear all previous data in database
                        userFunction.logoutUser(getApplicationContext());
                        db.addUser(json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json.getString(KEY_UID), json_user.getString(KEY_CREATED_AT));                        
                        // Launch Dashboard Screen
                        Intent dashboard = new Intent(getApplicationContext(), DashboardActivity.class);
                        // Close all views before launching Dashboard
                        dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                        startActivity(dashboard);
                        // Close Registration Screen
                        finish();
                    }else{
                        // Error in registration
                        registerErrorMsg.setText("Error occured in registration");
                    }
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    });

    // Link to Login Screen
    btnLinkToLogin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            Intent i = new Intent(getApplicationContext(),
                    LoginActivity.class);
            startActivity(i);
            // Close Registration View
            finish();
        }
    });
}} 
```

我的登录

```
package com.example.androidhive;

import java.util.HashMap;
import org.json.JSONException;
import org.json.JSONObject;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import com.example.androidhive.library.DatabaseHandler;
import com.example.androidhive.library.UserFunctions;

public class LoginActivity extends Activity {
Button btnLogin;
Button btnLinkToRegister;
EditText inputEmail;
EditText inputPassword;
TextView loginErrorMsg;

// JSON Response node names
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_ERROR_MSG = "error_msg";
private static String KEY_UID = "uid";
private static String KEY_NAME = "name";
private static String KEY_EMAIL = "email";
private static String KEY_CREATED_AT = "created_at";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);

    // Importing all assets like buttons, text fields
    inputEmail = (EditText) findViewById(R.id.loginEmail);
    inputPassword = (EditText) findViewById(R.id.loginPassword);
    btnLogin = (Button) findViewById(R.id.btnLogin);
    btnLinkToRegister = (Button) findViewById(R.id.btnLinkToRegisterScreen);
    loginErrorMsg = (TextView) findViewById(R.id.login_error);

    // Login button Click Event
    btnLogin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            String email = inputEmail.getText().toString();
            String password = inputPassword.getText().toString();
            UserFunctions userFunction = new UserFunctions();
            Log.d("Button", "Login");
            JSONObject json = userFunction.loginUser(email, password);

            // check for login response
            try {
                if (json.getString(KEY_SUCCESS) != null) {
                    loginErrorMsg.setText("");
                    String res = json.getString(KEY_SUCCESS); 
                    if(Integer.parseInt(res) == 1){
                        // user successfully logged in
                        // Store user details in SQLite Database
                        DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                        JSONObject json_user = json.getJSONObject("user");

                        // Clear all previous data in database
                        userFunction.logoutUser(getApplicationContext());
                        db.addUser(json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json.getString(KEY_UID), json_user.getString(KEY_CREATED_AT));                        

                        // Launch Dashboard Screen
                        Intent dashboard = new Intent(getApplicationContext(), DashboardActivity.class);

                        // Close all views before launching Dashboard
                        dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                        startActivity(dashboard);

                        // Close Login Screen
                        finish();
                    }else{
                        // Error in login
                        loginErrorMsg.setText("Incorrect username/password");
                    }
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    });

    // Link to Register Screen
    btnLinkToRegister.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            Intent i = new Intent(getApplicationContext(),
                    RegisterActivity.class);
            startActivity(i);
            finish();
        }
    });
}} 
```

我的数据库处理程序

```
package com.example.androidhive.library;

import java.util.HashMap;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

  public class DatabaseHandler extends SQLiteOpenHelper {

// All Static variables
// Database Version
private static final int DATABASE_VERSION = 1;

// Database Name
private static final String DATABASE_NAME = "android_api";

// Login table name
private static final String TABLE_LOGIN = "login";

// Login Table Columns names
private static final String KEY_ID = "id";
private static final String KEY_NAME = "name";
private static final String KEY_EMAIL = "email";
private static final String KEY_UID = "uid";
private static final String KEY_CREATED_AT = "created_at";

public DatabaseHandler(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

// Creating Tables
@Override
public void onCreate(SQLiteDatabase db) {
    String CREATE_LOGIN_TABLE = "CREATE TABLE " + TABLE_LOGIN + "("
            + KEY_ID + " INTEGER PRIMARY KEY," 
            + KEY_NAME + " TEXT,"
            + KEY_EMAIL + " TEXT UNIQUE,"
            + KEY_UID + " TEXT,"
            + KEY_CREATED_AT + " TEXT" + ")";
    db.execSQL(CREATE_LOGIN_TABLE);
}

// Upgrading database
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // Drop older table if existed
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_LOGIN);

    // Create tables again
    onCreate(db);
}

/**
 * Storing user details in database
 * */
public void addUser(String name, String email, String uid, String created_at) {
    SQLiteDatabase db = this.getWritableDatabase();

    ContentValues values = new ContentValues();
    values.put(KEY_NAME, name); // Name
    values.put(KEY_EMAIL, email); // Email
    values.put(KEY_UID, uid); // Email
    values.put(KEY_CREATED_AT, created_at); // Created At

    // Inserting Row
    db.insert(TABLE_LOGIN, null, values);
    db.close(); // Closing database connection
}

/**
 * Getting user data from database
 * */
public HashMap<String, String> getUserDetails(){
    HashMap<String,String> user = new HashMap<String,String>();
    String selectQuery = "SELECT  * FROM " + TABLE_LOGIN;

    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);
    // Move to first row
    cursor.moveToFirst();
    if(cursor.getCount() > 0){
        user.put("name", cursor.getString(1));
        user.put("email", cursor.getString(2));
        user.put("uid", cursor.getString(3));
        user.put("created_at", cursor.getString(4));
    }
    cursor.close();
    db.close();
    // return user
    return user;
}

/**
 * Getting user login status
 * return true if rows are there in table
 * */
public int getRowCount() {
    String countQuery = "SELECT  * FROM " + TABLE_LOGIN;
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(countQuery, null);
    int rowCount = cursor.getCount();
    db.close();
    cursor.close();

    // return row count
    return rowCount;
}

/**
 * Re crate database
 * Delete all tables and create them again
 * */
public void resetTables(){
    SQLiteDatabase db = this.getWritableDatabase();
    // Delete All Rows
    db.delete(TABLE_LOGIN, null, null);
    db.close();
}} 
```

我的 JSON 解析器

```
package com.example.androidhive.library;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.List;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;
import android.util.Log;

public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);            
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

}} 
```

用户函数

```
package com.example.androidhive.library;

import java.util.ArrayList;
import java.util.List;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;
import android.content.Context;

public class UserFunctions {

private JSONParser jsonParser;

private static String loginURL = "http://10.0.2.2/ah_login_api/";
private static String registerURL = "http://10.0.2.2/ah_login_api/";

private static String login_tag = "login";
private static String register_tag = "register";

// constructor
public UserFunctions(){
    jsonParser = new JSONParser();
}

/**
 * function make Login Request
 * @param email
 * @param password
 * */
public JSONObject loginUser(String email, String password){
    // Building Parameters
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", login_tag));
    params.add(new BasicNameValuePair("email", email));
    params.add(new BasicNameValuePair("password", password));
    JSONObject json = jsonParser.getJSONFromUrl(loginURL, params);
    // return json
    // Log.e("JSON", json.toString());
    return json;
}

/**
 * function make Login Request
 * @param name
 * @param email
 * @param password
 * */
public JSONObject registerUser(String name, String email, String password){
    // Building Parameters
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", register_tag));
    params.add(new BasicNameValuePair("name", name));
    params.add(new BasicNameValuePair("email", email));
    params.add(new BasicNameValuePair("password", password));

    // getting JSON Object
    JSONObject json = jsonParser.getJSONFromUrl(registerURL, params);
    // return json
    return json;
}

/**
 * Function get Login status
 * */
public boolean isUserLoggedIn(Context context){
    DatabaseHandler db = new DatabaseHandler(context);
    int count = db.getRowCount();
    if(count > 0){
        // user logged in
        return true;
    }
    return false;
}

/**
 * Function to logout user
 * Reset Database
 * */
public boolean logoutUser(Context context){
    DatabaseHandler db = new DatabaseHandler(context);
    db.resetTables();
    return true;
}} 
```

最后是我的错误Logcat：

```
02-12 14:11:09.267: E/JSON(388): <?xml version="1.0" encoding="UTF-8"?>
02-12 14:11:09.267: E/JSON(388): <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0    Strict//EN"
02-12 14:11:09.267: E/JSON(388):   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
02-12 14:11:09.267: E/JSON(388): <html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
02-12 14:11:09.267: E/JSON(388): <head>
02-12 14:11:09.267: E/JSON(388): <title>Object not found!</title>
02-12 14:11:09.267: E/JSON(388): <link rev="made" href="mailto:postmaster@localhost" />
02-12 14:11:09.267: E/JSON(388): <style type="text/css"><!--/*--><![CDATA[/*><!--*/ 
02-12 14:11:09.267: E/JSON(388):     body { color: #000000; background-color: #FFFFFF;  }
02-12 14:11:09.267: E/JSON(388):     a:link { color: #0000CC; }
02-12 14:11:09.267: E/JSON(388):     p, address {margin-left: 3em;}
02-12 14:11:09.267: E/JSON(388):     span {font-size: smaller;}
02-12 14:11:09.267: E/JSON(388): /*]]>*/--></style>
02-12 14:11:09.267: E/JSON(388): </head>
02-12 14:11:09.267: E/JSON(388): <body>
02-12 14:11:09.267: E/JSON(388): <h1>Object not found!</h1>
02-12 14:11:09.267: E/JSON(388): <p>
02-12 14:11:09.267: E/JSON(388):     The requested URL was not found on this server.
02-12 14:11:09.267: E/JSON(388):   
02-12 14:11:09.267: E/JSON(388):     If you entered the URL manually please check your
02-12 14:11:09.267: E/JSON(388):     spelling and try again.
02-12 14:11:09.267: E/JSON(388):   
02-12 14:11:09.267: E/JSON(388): </p>
02-12 14:11:09.267: E/JSON(388): <p>
02-12 14:11:09.267: E/JSON(388): If you think this is a server error, please contact
02-12 14:11:09.267: E/JSON(388): the <a href="mailto:postmaster@localhost">webmaster</a>.
02-12 14:11:09.267: E/JSON(388): </p>
02-12 14:11:09.267: E/JSON(388): <h2>Error 404</h2>
02-12 14:11:09.267: E/JSON(388): <address>
02-12 14:11:09.267: E/JSON(388):   <a href="/">10.0.2.2</a><br />
02-12 14:11:09.267: E/JSON(388):   <span>Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7</span>
02-12 14:11:09.267: E/JSON(388): </address>
02-12 14:11:09.267: E/JSON(388): </body>
02-12 14:11:09.267: E/JSON(388): </html>
02-12 14:11:09.408: E/JSON Parser(388): Error parsing data org.json.JSONException: Value  <?xml of type java.lang.String cannot be converted to JSONObject
02-12 14:11:09.477: E/AndroidRuntime(388): FATAL EXCEPTION: main
02-12 14:11:09.477: E/AndroidRuntime(388): java.lang.NullPointerException
02-12 14:11:09.477: E/AndroidRuntime(388):  at com.example.androidhive.RegisterActivity$1.onClick(RegisterActivity.java:64)
02-12 14:11:09.477: E/AndroidRuntime(388):  at android.view.View.performClick(View.java:2408)
02-12 14:11:09.477: E/AndroidRuntime(388):  at android.view.View$PerformClick.run(View.java:8816)
02-12 14:11:09.477: E/AndroidRuntime(388):  at android.os.Handler.handleCallback(Handler.java:587)
02-12 14:11:09.477: E/AndroidRuntime(388):  at android.os.Handler.dispatchMessage(Handler.java:92)
02-12 14:11:09.477: E/AndroidRuntime(388):  at android.os.Looper.loop(Looper.java:123)
02-12 14:11:09.477: E/AndroidRuntime(388):  at android.app.ActivityThread.main(ActivityThread.java:4627)
02-12 14:11:09.477: E/AndroidRuntime(388):  at java.lang.reflect.Method.invokeNative(Native Method)
02-12 14:11:09.477: E/AndroidRuntime(388):  at java.lang.reflect.Method.invoke(Method.java:521)
02-12 14:11:09.477: E/AndroidRuntime(388):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
02-12 14:11:09.477: E/AndroidRuntime(388):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
02-12 14:11:09.477: E/AndroidRuntime(388):  at dalvik.system.NativeStart.main(NativeMethod) 
```

我真的需要帮助，因为这是我最后一年的项目，我在这个连接上坚持了几个月：O

所以非常感谢您的合作，谢谢大家，请尽力指导我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:15:43.517

分析logcat后，似乎有两个问题：

1.  未找到请求的 URL，它是 HTTP 404
2.  您正在尝试将从 http 服务器接收到的响应转换为 Json 对象。在这种情况下，由于未找到 URL，服务器已返回 XML 结构，因此无法转换为 Json 对象。

这些是您首先需要解决的问题。

# java - 用 Java 打印到不是默认打印机的标签打印机

> ID：14836442
> 
> 赞同：0
> 
> 时间：2013-02-12T15:55:54.260
> 
> 标签：java, pdf, printing

我需要打印到标签打印机。我在互联网上找到了下面的代码，并试图根据我的需要对其进行修改。当标签打印机是系统中的默认打印机时，它可以正常工作，但是当我将其他打印机设置为默认打印机时，它不能正确打印。在下面链接的图片中，可以看到默认情况下的结果（右侧），非默认情况下的第一次尝试（中间的）和非默认情况下的第二次尝试。无论打印机是否为默认打印机，我都需要正确打印，因为这将是我们将发布给客户的软件的一部分。我的问题是：当不是默认打印机时，是否应该将任何特定属性或命令发送到打印机以便正确打印？或如何在打印之前从我的代码中将该打印机设置为默认打印机，然后在我完成打印后恢复默认打印机？图片链接（[https://lh4.googleusercontent.com/-jBa7bA77ik0/URplehZYVIE/AAAAAAAQWg/bO4EE3wepjg/s279-c/21​​213](https://lh4.googleusercontent.com/-jBa7bA77ik0/URplehZYVIE/AAAAAAAAQWg/bO4EE3wepjg/s279-c/21213)）

源代码

```
/*
 * Copyright (c) 2004 David Flanagan.  All rights reserved.
 * This code is from the book Java Examples in a Nutshell, 3nd Edition.
 * It is provided AS-IS, WITHOUT ANY WARRANTY either expressed or implied.
 * You may study, use, and modify it for any non-commercial purpose,
 * including teaching and use in open-source projects.
 * You may distribute it non-commercially as long as you retain this notice.
 * For a commercial use license, or to purchase the book, 
 * please visit http://www.davidflanagan.com/javaexamples3.
 */
//package je3.print;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;

import javax.print.Doc;
import javax.print.DocFlavor;
import javax.print.DocPrintJob;
import javax.print.PrintException;
import javax.print.PrintService;
import javax.print.PrintServiceLookup;
import javax.print.SimpleDoc;
import javax.print.StreamPrintService;
import javax.print.StreamPrintServiceFactory;
import javax.print.attribute.Attribute;
import javax.print.attribute.HashPrintRequestAttributeSet;
import javax.print.attribute.PrintRequestAttributeSet;
import javax.print.attribute.standard.OrientationRequested;
import javax.print.event.PrintJobAdapter;
import javax.print.event.PrintJobEvent;

import org.apache.pdfbox.pdmodel.PDDocument;

/**
 * This utility program demonstrates the javax.print API and allows you to list
 * available printers, query a named printer, print text and image files to a
 * printer, and print to postscript files.
 */
public class Print {
  public static void main(String[] args) throws IOException {
    // These are values we'll set from the command-line arguments
    boolean query = false;
    String printerName = "Brother QL-570 LE";
    String inputFileName = "C:\\dev\\label.pdf";
    PrintRequestAttributeSet attributes = new HashPrintRequestAttributeSet();
    attributes.add(OrientationRequested.LANDSCAPE);

    if (query) {
        // Look for a named printer that can support the
        // attributes and print its status
        queryPrinter(printerName, attributes);
    } else {
        // print to the named printer, or to the default
        // printer otherwise.
        print(printerName, inputFileName, attributes);
    }
    // The main() method ends here, but there may be a printing thread
    // operating in the background. So the program may not terminate
    // until printing completes.
  }

  // List names of all PrintServices that can support the attributes
  public static void queryServices(PrintRequestAttributeSet attributes) {
    // Find all services that can support the specified attributes
    PrintService[] services = PrintServiceLookup.lookupPrintServices(null, attributes);
    // Loop through available services
    for (int i = 0; i < services.length; i++) {
      // Print service name
      System.out.print(services[i].getName());

      // Then query and print the document types it can print
      DocFlavor[] flavors = services[i].getSupportedDocFlavors();
      for (int j = 0; j < flavors.length; j++) {
        // Filter out DocFlavors that have a representation class other
        // than java.io.InputStream.
        String repclass = flavors[j].getRepresentationClassName();
        if (!repclass.equals("java.io.InputStream"))
          continue;
        System.out.println("\t" + flavors[j].getMimeType());
      }
    }
  }

  // List details about the named printer
  public static void queryPrinter(String printerName, PrintRequestAttributeSet attributes) {
    // Find the named printer
    PrintService service = getNamedPrinter(printerName, attributes);
    if (service == null) {
      System.out.println(printerName + ": no such printer capable of "
          + "handling the specified attributes");
      return;
    }

    // Print status and other information about the printer
    System.out.println(printerName + " status:");
    Attribute[] attrs = service.getAttributes().toArray();
    for (int i = 0; i < attrs.length; i++)
      System.out.println("\t" + attrs[i].getName() + ": " + attrs[i]);

  }

  // Print the contents of the named file to the named printer (or to a
  // default printer if printerName is null) requesting the specified
  // attributes.
  public static void print(String printerName, String filename, PrintRequestAttributeSet attributes)
      throws IOException {
    // Look for a printer that can support the attributes
    PrintService service = getNamedPrinter(printerName, attributes);
    if (service == null) {
      System.out.println("Can't find a printer " + "with specified attributes");
      return;
    }
    // Print the file to that printer. See method definition below
    printToService(service, filename, attributes);
    // Let the user know where to pick up their printout
    System.out.println("Printed " + filename + " to " + service.getName());
  }

  // Print to an output file instead of a printer
  public static void printToFile(String outputFileName, String outputFileType,
      String inputFileName, PrintRequestAttributeSet attributes) throws IOException {

    // Determine whether the system can print to the specified type, and
    // get a factory object if so.
    // The name of this static method is way too long!
    StreamPrintServiceFactory[] factories = StreamPrintServiceFactory
        .lookupStreamPrintServiceFactories(null, outputFileType);

    // Error message if we can't print to the specified output type
    if (factories.length == 0) {
      System.out.println("Unable to print files of type: " + outputFileType);
      return;
    }

    // Open the output file
    FileOutputStream out = new FileOutputStream(outputFileName);
    // Get a PrintService object to print to that file
    StreamPrintService service = factories[0].getPrintService(out);
    // Print using the method below
    printToService(service, inputFileName, attributes);
    // And remember to close the output file
    out.close();
  }

  // Print the contents of the named file to the specified PrintService,
  // requesting the specified attributes.
  // This is shared code used by print() and printToFile() above.
  public static void printToService(PrintService service, String filename,
      PrintRequestAttributeSet attributes) throws IOException {
    // Figure out what type of file we're printing
    DocFlavor flavor = getFlavorFromFilename(filename);
    // Open the file
    //InputStream in = new FileInputStream(filename);   

    PDDocument document = null;
    try 
    {
        document = PDDocument.load(filename);
    }
    catch (Exception e) 
    {
        System.out.println("Unable to open PDF file ");
    }
    // Create a Doc object to print from the file and flavor.
    Doc doc = new SimpleDoc(document, flavor, null);
    // Create a print job from the service
    DocPrintJob job = service.createPrintJob();

    // Monitor the print job with a listener
    job.addPrintJobListener(new PrintJobAdapter() {
      public void printJobCompleted(PrintJobEvent e) {
        System.out.println("Print job complete");
        System.exit(0);
      }

      public void printDataTransferCompleted(PrintJobEvent e) {
        System.out.println("Document transfered to printer");
      }

      public void printJobRequiresAttention(PrintJobEvent e) {
        System.out.println("Print job requires attention");
        System.out.println("Check printer: out of paper?");
      }

      public void printJobFailed(PrintJobEvent e) {
        System.out.println("Print job failed");
        System.exit(1);
      }
    });

    // Now print the document, catching errors
    try {
      job.print(doc, attributes);
    } catch (PrintException e) {
      System.out.println(e);
      System.exit(1);
    }
  }

  // A utility method to look up printers that can support the specified
  // attributes and return the one that matches the specified name.
  public static PrintService getNamedPrinter(String name, PrintRequestAttributeSet attrs) {
    PrintService[] services = PrintServiceLookup.lookupPrintServices(null, attrs);
    if (services.length > 0) {
      if (name == null)
        return services[0];
      else {
        for (int i = 0; i < services.length; i++) {
          if (services[i].getName().equals(name))
            return services[i];
        }
      }
    }
    return null;
  }

  // A utility method to return a DocFlavor object matching the
  // extension of the filename.
  public static DocFlavor getFlavorFromFilename(String filename) {
    String extension = filename.substring(filename.lastIndexOf('.') + 1);
    extension = extension.toLowerCase();
    if (extension.equals("gif"))
      return DocFlavor.INPUT_STREAM.GIF;
    else if (extension.equals("jpeg"))
      return DocFlavor.INPUT_STREAM.JPEG;
    else if (extension.equals("jpg"))
      return DocFlavor.INPUT_STREAM.JPEG;
    else if (extension.equals("png"))
      return DocFlavor.INPUT_STREAM.PNG;
    else if (extension.equals("ps"))
      return DocFlavor.INPUT_STREAM.POSTSCRIPT;
    else if (extension.equals("txt"))
      return DocFlavor.INPUT_STREAM.TEXT_PLAIN_HOST;
    else if (extension.equals("pdf"))
        return DocFlavor.SERVICE_FORMATTED.PAGEABLE;
    // Fallback: try to determine flavor from file content
    else
      return DocFlavor.INPUT_STREAM.AUTOSENSE;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-09-05T03:32:06.563

您可以尝试使用 pdfbox 的 pdf 打印功能[https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/printing/Printing.java?view=markup](https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/printing/Printing.java?view=markup)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T04:17:14.780

```
public static void main(String[] args) {
    try
    {
        FileInputStream fis = new FileInputStream("c:\\N0018902726.pdf");
        DocFlavor flavor = DocFlavor.INPUT_STREAM.AUTOSENSE;
        DocAttributeSet das = new HashDocAttributeSet(); 
        Doc pdfDoc = new SimpleDoc(fis, flavor, null);
        PrintService printService = PrintServiceLookup.lookupDefaultPrintService(); 
        DocPrintJob printJob = printService.createPrintJob();
        printJob.print(pdfDoc, new HashPrintRequestAttributeSet());
        fis.close();
    }
    catch (Exception e) {
        System.out.println("EXCEPTIOn : " +e.getMessage());

    }
} 
```

# c - PLT 重定向和 dlsym

> ID：14836445
> 
> 赞同：1
> 
> 时间：2013-02-12T15:56:00.250
> 
> 标签：c, linux, redirect, elf

我想在任意程序中重定向一些函数，并能够在新函数中调用旧函数。我使用热补丁注入我的共享库，PLT 重定向似乎是要走的路。

但是程序用 dlsym 接收的符号呢？他们似乎没有任何 PLT 条目，那么您如何重定向这些条目？

有没有一个图书馆可以做我想做的事？

# dynamics-crm-2011 - CRM 2011 导入邮件工作流设置错误的“发件人”字段

> ID：14836446
> 
> 赞同：0
> 
> 时间：2013-02-12T15:56:01.690
> 
> 标签：dynamics-crm-2011

使用解决方案导出/导入在组织之间复制自定义时遇到问题。每次我在不同的组织/环境之间复制数据时，我都必须遍历所有工作流程并更改对 CRM 数据的引用，即电子邮件的“发件人”字段，可以是队列或用户邮件。在新的解决方案中，我有“服务”，它应该是服务，所以具有相同的名称不是解决方案，所以我认为这是关于元素的 GUID，但是在导出时有任何选项，我想，为了避免这种情况，有任何免费软件工具吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:57:23.303

此解决方案需要一些 .Net 开发，但一旦设置好，它就具有相当的可扩展性。要么创建一个只有一条记录的配置实体，要么创建一个 xml Web 资源来存储所有环境变量，如对用户的引用、服务器设置 URL 等。

要从工作流访问您的配置实体（或 Web 资源），您可以创建一个简单的工作流活动，该活动只返回配置实体的第一条记录。拥有它后，您可以引用其上的任何属性，并且由于该配置中的数据是该环境独有的记录。

就像我提到的那样，您可能可以使用 XML 资源来执行此操作，但检索实体更容易，并且您可以获得用于选项集和查找的 CRM UI，并且您可以限制谁可以安全地对其进行编辑。您还可以随时添加新字段，而不必更改您的 WF 活动代码。

# ruby-on-rails - RSPEC 使用电子邮件格式失败

> ID：14836449
> 
> 赞同：1
> 
> 时间：2013-02-12T15:56:14.557
> 
> 标签：ruby-on-rails, rspec

我一直在浏览 Rails 教程，将用户帐户放在一起并为我正在处理的项目运行测试。

```
Failures:

  1) when email format is invalid should be invalid
     Failure/Error: @user.email = invalid_address
     NoMethodError:
       undefined method `email=' for nil:NilClass
     # ./spec/models/user_spec.rb:71:in `block (3 levels) in <top (required)>'
     # ./spec/models/user_spec.rb:70:in `each'
     # ./spec/models/user_spec.rb:70:in `block (2 levels) in <top (required)>'

  2) when email format is valid should be valid
     Failure/Error: @user.email = valid_address
     NoMethodError:
       undefined method `email=' for nil:NilClass
     # ./spec/models/user_spec.rb:81:in `block (3 levels) in <top (required)>'
     # ./spec/models/user_spec.rb:80:in `each'
     # ./spec/models/user_spec.rb:80:in `block (2 levels) in <top (required)>'

Finished in 0.527 seconds
9 examples, 2 failures

Failed examples:

rspec ./spec/models/user_spec.rb:67 # when email format is invalid should be invalid
rspec ./spec/models/user_spec.rb:78 # when email format is valid should be valid 
```

我不知道问题是什么。我看到了它的内容，但我什至 C&P 了教程中的代码，以仔细检查我所做的工作，以确保所有内容都正确输入。

这是 user_spec 文件。

[https://gist.github.com/pwz2k/4770845](https://gist.github.com/pwz2k/4770845)

这是 user.rb 文件。

[https://gist.github.com/pwz2k/4770854](https://gist.github.com/pwz2k/4770854)

直到我添加了电子邮件验证，失败才出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:04:35.707

确保在开始测试之前创建 @user .. 你的用户测试中有这些行吗？（[rails教程清单6.16](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#code-email_format_validation_tests)）

```
before do
    @user = User.new(name: "Example User", email: "user@example.com")
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T06:10:39.463

错误很明显！您将电子邮件设置为 nil 类。这意味着您应该将电子邮件设置给我们所说的用户

```
 @user.email = "something" 
```

错误是抱怨没有用户，并且不会有任何用户电子邮件。

To make is work here 是一个示例代码，可帮助您解决此问题。

```
 describe "validations" do
   before(:each) do
     @user = User.new(name: "gates", email: "somename@gmail.com")
   end
   it "should be invalid" do
     invalid_emails = %w{gs@gmail p.com name.gmail.com foo.ymail}
     invalid_emails.each do |invalid_email|
       @user.email = invalid_email
       expect(@user.email).to_not be_valid
    end
   end

   it "should be valid" do
    @user.name = "somename"
    valid_emails = %w{user@foo.COM A_US-ER@f.b.org frst.lst@foo.jp 
    a+b@baz.cn}
    valid_emails.each do |valid_email|
     @user.email = valid_email
     expect(@user.email).to be_valid
    end
   end  
 end 
```

请确保您已在您的fixures 文件夹中为用户创建了一个fixture。

希望这可以帮助！

# java - 在同步块的末尾是否需要 notifyAll()？

> ID：14836451
> 
> 赞同：5
> 
> 时间：2013-02-12T15:56:22.080
> 
> 标签：java

我曾经写过这样的`synchronized`块：

```
synchronized(foobar) {
    // do something
} 
```

但是，最近我看到有人写：

```
synchronized(foobar) {
    // do something
    foobar.notifyAll();
} 
```

有`foobar.notifyAll();`必要吗？如果我省略它会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:44:09.820

简短的回答是这取决于你在做什么。

如果同步块的目标只是确保安全地执行对数据结构的访问/更新，那么`notify()`或者`notifyAll()`没有任何用途。

另一方面，如果目标是实现一个“条件变量”，那么`notify()`or`notifyAll()`调用将与这样的调用一起工作`wait`......例如：

```
private boolean flag;
private final Object mutex = new Object();

public void awaitFlag(boolean flag) {
    synchronized (mutex) {
        while (this.flag != flag) {
            mutex.wait();
        }
    }
}

public void setFlag(boolean flag) {
    synchronized (mutex) {
        this.flag = flag;
        mutex.notifyAll();
    }
} 
```

上面实现了一个简单的机制，线程调用`awaitFlag()`等待`flag`成为`true`or `false`。当另一个线程调用`setFlag()`更改标志时，当前等待标志更改的所有线程都将被`notifyAll()`. 这是一个`notifyAll()`对代码的工作至关重要的示例。

* * *

因此，要了解`notify`or`notifyAll`代码是否是必要的，您需要弄清楚是否有其他代码*可能会*调用`wait`同一个互斥锁/锁对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T15:58:49.200

You don't *need* to do this. You only have to do it if the object (here `foobar`) is waiting to be notified. Notify only [Wakes up all threads that are waiting on this object's monitor.](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Object.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T15:59:06.797

In Java, you can use `wait()`, `notify()` and `notifyAll()` to achieve thread co-ordination. See [How to use wait and notify in Java?](https://stackoverflow.com/questions/886722/how-to-use-wait-and-notify-in-java)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T15:59:27.860

The notifyAll() is to tell any other thread sleeping in a foobar.wait() that the current thread is about to release the lock and they can compete for the resource again.

# node.js - 在 Jade 模板中使用 ucfirst 的更好方法？

> ID：14836452
> 
> 赞同：6
> 
> 时间：2013-02-12T15:56:22.393
> 
> 标签：node.js, pug

有没有比这更好的方法来将 Jade 中字符串的第一个字符大写？

```
for list in project.lists
    - list.name = list.name.charAt(0).toUpperCase() + list.name.slice(1);
    li #{list.name} 
```

每次我想大写一个变量时都这样做是丑陋的，在 Jade 中有什么方法可以定义我在每个模板中都可用的自定义函数，例如：

```
for list in project.lists
    li #{ucfirst(list.name)} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-12T17:25:48.313

的内容`#{}`作为标准 JS 执行，因此您可以传入辅助函数以用于类似的事情。您尚未指定，但假设您使用 Jade 和 Express，您可以执行以下操作：

```
app.locals.ucfirst = function(value){
    return value.charAt(0).toUpperCase() + value.slice(1);
}; 
```

这将公开一个`ucfirst`在 Jade 模板中调用的函数。您也可以在`locals`每次渲染时将其作为一部分传递，但如果您使用 Express，它会自动执行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-30T02:26:35.543

如果您愿意使用 CSS，您可以创建一个类，将目标元素中每个单词的首字母大写。

CSS

```
.caps {
    text-transform: capitalize;
} 
```

玉

```
div.caps
    each foo in ['one', 'two', 'three']
        span #{foo} 
```

生成的 HTML

```
<div class="caps"><span>one</span><span>two</span><span>three</span> 
```

结果视图

```
One Two Three 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-20T05:08:48.740

如果您将 pug 与 gulp 一起使用，这可能会有所帮助：

```
mixin ucfirst(text)
    - text = text.charAt(0).toUpperCase() + text.slice(1);
    .
      #{text} 
```

只需将其称为任何其他 mixin：

```
li
    +ucfirst(list.name) 
```

# asp.net - 从代码隐藏扩展 ASP.Net TreeView 节点

> ID：14836453
> 
> 赞同：3
> 
> 时间：2013-02-12T15:56:22.663
> 
> 标签：asp.net, vb.net, treeview, code-behind, expand

我正在学习如何访问 ASP.Net 母版页的控件并尝试扩展特定的 TreeView 节点。我正在从另一个不是母版页的页面执行此操作。

objContentPlaceHolder、objLoginView 和 objTreeView 都具有使用调试器确认的值。

你能看看这段代码，让我们知道为什么 for 循环中的代码没有执行吗？它到达了 for 循环，但此时只是跳过了 for 循环。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim objContentPlaceHolder As ContentPlaceHolder
    Dim objLoginView As LoginView
    Dim objTreeView As TreeView

    objContentPlaceHolder = CType(Master.FindControl("ContentPlaceHolderBody"), ContentPlaceHolder)

    If Not objContentPlaceHolder Is Nothing Then

        objLoginView = CType(objContentPlaceHolder.FindControl("loginViewMain"), LoginView)

        If Not objLoginView Is Nothing Then
            objTreeView = CType(objLoginView.FindControl("TreeViewMain"), TreeView)

            ' Make sure all nodes for Maintenance are expanded.
            '--------------------------------------------------
            For Each treenode As TreeNode In objTreeView.Nodes
                If treenode.Text = "Maintenance" Then
                    treenode.Expand()
                End If
            Next treenode
        End If
    End If
End Sub 
```

*** 更新 ***

我将页面加载事件处理程序更改为 PreRenderComplete 事件处理程序，您认为它有效吗？不知道为什么 PreRender 没有，但就是这样。再次感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:22:54.880

```
 public Sub TreeView_TreeNodeDataBound(ByVal sender As Object, ByVal e As TreeNodeEventArgs  )
       dim mapNode as SiteMapNode =  e.Node.DataItem as SiteMapNode
       If mapNode.Title = "Maintenance" then
           e.Node.Expand()
       End if
   End Sub

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

        Dim objContentPlaceHolder As ContentPlaceHolder
        Dim objLoginView As LoginView
        Dim objTreeView As TreeView

        objContentPlaceHolder = CType(Master.FindControl("ContentPlaceHolderBody"), ContentPlaceHolder)

        If Not objContentPlaceHolder Is Nothing Then

            objLoginView = CType(objContentPlaceHolder.FindControl("loginViewMain"), LoginView)

            If Not objLoginView Is Nothing Then
                objTreeView = CType(objLoginView.FindControl("TreeViewMain"), TreeView)
                objTreeView.TreeNodeDataBound += TreeView_TreeNodeDataBound 
            End If
        End If
    End Sub 
```

希望这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:25:35.407

从您的示例来看，您的逻辑似乎只检查根节点。在处理分层数据时，您需要使用递归逻辑来确保对整个结构进行评估。

你需要这样的东西：

```
Protected Sub btnSearch_Click(sender As Object, e As EventArgs)
    For Each node As TreeNode In TreeView1.Nodes
        ExpandNodeByValue("Maintenance", node)
    Next
End Sub

Private Sub ExpandNodeByValue(value As String, parentNode As TreeNode)
    For Each childNode As TreeNode In parentNode.ChildNodes
        If childNode.Value.ToLower() = value.ToLower() Then
            childNode.Expand()
        End If
        If childNode.ChildNodes.Count > 0 Then
            ExpandNodeByValue(value, childNode)
        End If
    Next
End Sub 
```

我还建议至少暂时使用 a`DirectCast`而不是，以确保找到控件。`CType`你可以这样实现：

```
Dim objTreeView as TreeView = DirectCast(objLoginView.FindControl("TreeViewMain"), TreeView)
If objTreeView IsNot Nothing Then
    'The control was found
End If 
```

# asp.net - 我的自定义 RoleProvider 是否应该在 AddUsersToRoles 中引发异常？

> ID：14836457
> 
> 赞同：2
> 
> 时间：2013-02-12T15:56:34.043
> 
> 标签：asp.net, exception, roleprovider

我正在实现一个自定义 ASP.NET 角色提供程序，我想知道如果传入的用户已经在传入的角色中，它的`AddUsersToRoles`方法是否应该抛出一个。默认的 Microsoft SQL Server 角色提供程序会表现出这种行为，即使[微软官方文档](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.adduserstoroles%28v=vs.85%29.aspx)不推荐它：`ProviderException``SqlRoleProvider`

> 异常详细信息：System.Configuration.Provider.ProviderException：用户“myTestUser”已经在角色“myTestRole”中。

我认为我的提供者在这种情况下不抛出异常而只是在给定用户已经处于给定角色时继续前进会很有用；这样调用代码就不需要担心重复了。但是，在这种情况下，是否存在依赖于抛出异常的现有角色提供程序使用代码？如果有，是否应该这样做，因为微软自己似乎并不推荐它？

如果我确实想实现一个类似于`AddUsersToRoles`在用户已经处于角色时不会引发异常的方法，我可以看到 3 种替代方法：

1.  将其实现为`AddUsersToRoles`并且具有与默认不同的行为`SqlRoleProvider`。
2.  `EnsureUsersInRoles`在我的角色提供者类中将其实现为新方法，并使用`((MyProvider)(Roles.Provider)).EnsureUsersInRoles()`.
3.  只需在一个完全独立的类中实现它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:08:03.343

就个人而言，我会遵守微软的做法。很难排除某个地方确实需要抛出该异常的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:15:57.597

我最终走上了我在问题中提出的路线 2）；我`RoleProvider`还用一些额外的方法实现了 a ，然后使用强制`((MyProvider)(Roles.Provider))`转换来访问我的额外方法，其中之一是`EnsureUsersInRoles()`，它具有我的调用代码想要的非抛出异常的功能。

# c - 如何将整数连接到C中的字符串？

> ID：14836461
> 
> 赞同：1
> 
> 时间：2013-02-12T15:56:56.807
> 
> 标签：c, int, concatenation

有问题的代码部分试图解码 MIPS 指令正在使用的寄存器。

这是通过传入寄存器的整数值来实现的，然后应该返回一个包含寄存器名称的字符串。执行此操作的王子语句在这里，它调用 getReg 来获取字符串。

```
printf("$%d aka $%s\n", itype->rs, getReg(itype->rs)); 
```

到目前为止，我已经尝试过将它们连接起来（没有 case 语句）：

```
char* getReg(int d) {
  char out[4];
  sprintf(out, "a%d", (d - 4));
  return out;
} 
```

但输出结果如下：

> $6 又名 $ìü(

什么时候应该：

> $6 又名 $a2

我哪里错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:01:10.533

You are returning address of a local variable (`out`).

```
char* getReg(int d) {
 char out[4];
 sprintf(out, "a%d", (d - 4));
 return out;
} 
```

scope and life of `out` is within function `getReg()` only.

Allocate memory dynamically for `out` to return and access outside function. (*and large enough*), like below

```
#define SIZE 25
char* getReg(int d) {
     char *out = malloc(SIZE*sizeof(char));
     sprintf(out, "a%d", (d - 4));   // I don't know about calculation??
      return out;
} 
```

and don't forget to free memory.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:04:47.953

该数组`out`对于您的函数是本地的`getreg`；一旦函数退出，`out`不再存在并且您返回的指针值不再有效。

最好将输出数组作为参数传递给函数：

```
void getReg(int d, char *str)
{
  sprintf(str, "a%d", (d-4));
} 
```

并将其称为

```
char mystr[4];
getReg(r, mystr); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:48:44.313

正如其他人已经提到的，OP 返回对存储的引用，如果在调用`printf()`.

提供外部缓冲区的另一种方法是：

```
char * getReg(int d, char * out) 
{
  sprintf(out, "a%d", (d - 4));

  return out;
}

...

printf(
  "$%d aka $%s\n", 
  itype->rs,  
  getReg(
    itype->rs, 
    (char[32]){0} /* provide a 32 byte long buffer, initialised to 0s */
  )
); 
```

# javascript - AJAX JQUERY 检索哈希值

> ID：14836470
> 
> 赞同：0
> 
> 时间：2013-02-12T15:57:24.100
> 
> 标签：javascript, jquery, ajax, hash

下面是我使用 ajax 动态更改图像而不刷新页面的代码。

**HTML**

```
<img id="design" alt="" width="300" height="300"  />
<input type="button" id="GetImage" value="Get Image" /> 
```

**查询**

```
$(document).ready(function(){

$("#GetImage").click(function() {

    $.ajax({ //Make the Ajax Request
             type: "POST",
             url: "testimagelook.php", //file name
             success: function(server_response){
                var id = server_response;
                document.location.hash = id;
                $('#design').attr('src','img/boxes/'+id+'.png');
             }
    });
});

}); 
```

php 文件 testimagelook.php 连接到数据库并带回我的一张图像的随机 id。此代码可以很好地显示图像并将图像的 id 保存在 URL 的哈希中，从而允许我保留图像的用户历史记录。但是，当用户单击后退按钮时，我不确定如何检索先前的哈希值并使用正确的 id 重新加载图像。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:05:37.507

试试这个：

```
 $(document).ready(function(){

    if (document.location.hash) {
         updateImage();
    }

    $("#GetImage").click(function() {

         $.ajax({ //Make the Ajax Request
             type: "POST",
             url: "testimagelook.php", //file name
             success: function(server_response){
                var id = server_response;
                document.location.hash = id;
             }
         });
    });

    $(window).bind('hashchange',function(){
           updateImage();
    });

    function updateImage() {
         var id = document.location.hash.substring(1); // remove #
         $('#design').attr('src','img/boxes/'+id+'.png');
    }
}); 
```

# cometd - CometD 发布数据的问题

> ID：14836471
> 
> 赞同：0
> 
> 时间：2013-02-12T15:57:27.930
> 
> 标签：cometd, bayeux

我是 CometD 的新手，在频道上发布数据时遇到问题。由于未在我的频道上调用握手（），我收到以下错误：

`Sender : null Sender : L:/abc/1? Exception in thread "Thread-9" java.lang.IllegalStateException: Method handshake() not invoked for local session L:/abc/1? at org.cometd.server.LocalSessionImpl.getId(LocalSessionImpl.java:161) at org.cometd.server.ServerChannelImpl.publish(ServerChannelImpl.java:309) at packagename.CometDSender.sendData(CometDSender.java:64) at packagename.ProcessorImp.processData(ProcessorImp.java:18) at packagename.TestSource.processNewData(TestSource.java:50) at packagename.TestSource.run(TestSource.java:36) at java.lang.Thread.run(Unknown Source)`

但是当我包含时，`sender.handshake()`我得到以下异常

```
 Sender : null
Sender : L:/abc/1?
Exception in thread "Thread-9" java.lang.NullPointerException
    at org.cometd.server.BayeuxServerImpl.freeze(BayeuxServerImpl.java:868)
    at org.cometd.server.BayeuxServerImpl.doPublish(BayeuxServerImpl.java:823)
    at org.cometd.server.BayeuxServerImpl.handle(BayeuxServerImpl.java:649)
    at org.cometd.server.LocalSessionImpl.doSend(LocalSessionImpl.java:214)
    at org.cometd.server.LocalSessionImpl.handshake(LocalSessionImpl.java:125)
    at org.cometd.server.LocalSessionImpl.handshake(LocalSessionImpl.java:110)
    at packagename.CometDSender.sendData(CometDSender.java:62)
    at packagename.ProcessorImp.processData(ProcessorImp.java:18)
    at packagename.TestSource.processNewData(TestSource.java:50)
    at packagename.TestSource.run(TestSource.java:36)
    at java.lang.Thread.run(Unknown Source) 
```

我在下面包括了我的课程。有人可以告诉我我是否遗漏了什么：

```
@Service 
```

公共类 CometDSender 实现 Sender {

```
@Inject
private BayeuxServer bayeuxServer;

@Session
private LocalSession sender;

private String channelName = null;

// setup CometD Channel
public CometDSender() {

    this.channelName = "/abc/1";

    System.out.println("bayeuxServer : " + (bayeuxServer == null ? "Is Null" : "Is Not Null"));
    if (bayeuxServer == null) {
        bayeuxServer = new BayeuxServerImpl();
    }

    bayeuxServer.createIfAbsent(channelName, new ConfigurableServerChannel.Initializer() {
    public void configureChannel(ConfigurableServerChannel channelName) {
        System.out.println("channel : " + (channelName == null ? "Is Null" : "Is Not Null"));
        channelName.setPersistent(true);
        channelName.setLazy(true);
        }
    });

}

public void sendData(Agent data) {

    // Convert the Update business object to a CometD-friendly format
    Map<String, Object> cometData = new HashMap<String, Object>(4);
    cometData.put("ID", data.getID());      

    // Publish to all subscribers
    ServerChannel channel = bayeuxServer.getChannel(channelName);
    System.out.println("Sender : " + sender);       

    if (sender == null) {
        sender = bayeuxServer.newLocalSession(channelName);
        System.out.println("Sender : " + sender);
        sender.handshake();         
    }   
    channel.publish(sender, cometData, null);

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:58:43.253

`BayeuxServerImpl`除非您知道自己在做什么，否则不得创建实例，这同样适用于`LocalSession`. 由于您使用的是 CometD 服务，因此这些字段必须是非空的，并且您不能自己创建它们。它们可能为空，这是因为您的配置很可能有错误`web.xml`（您没有发布）。

请阅读有关[CometD 服务](http://docs.cometd.org/reference/#java_server_services)的文档并按照[教程](http://docs.cometd.org/tutorials/)进行操作：它们将逐步指导您解决 CometD 服务的问题。

# c++ - C ++将长字符串传递给构造函数或setter

> ID：14836473
> 
> 赞同：0
> 
> 时间：2013-02-12T15:57:29.210
> 
> 标签：c++, c++11, parameter-passing, glib, stdstring

我有一个带有 Glib::ustring 成员的类（如果你不熟悉它，假设它是 std::string），它应该包含一个长字符串，即至少一个段落，也许更多。甚至可能超过 10 段。该字符串计划在 GUI 中显示，因此将来可能会将其存储在文本小部件的缓冲区中，但现在它只是我的 C++ 类的字符串成员对象。

问题是：如何将字符串传递给构造函数，以及如何将其传递给 set_string() 设置方法。长字符串意味着大副本，所以我认为一个好的解决方案是采用右值引用并将 std::move 参数放入成员对象中。但我也不希望类接口令人惊讶且难以使用/理解。你知道，最不意外的规则。

所以我在想，在这种情况下，预期/常见的解决方案是什么？

（对于 setter 方法，这里有另一个选项：由于在 GUI 中完成编辑，只需让 GUI 直接编辑字符串，然后 setter 方法的唯一用途就是以编程方式完全替换字符串，例如重置它或撤消最近的编辑)

```
class MyClass
{
public:
     explicit MyClass (Glib::ustring str);
     void set_string (Glib::ustring str);
private:
     Glib::ustring str;
} 
```

（我已经看到现有库的代码，例如 gtkmm，通过 const 引用获取字符串，但我也看到 SO 帖子的答案是按值传递以允许优化）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:06:55.430

[http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)

`string`假设你`string`有一个高效的移动构造函数，你的函数应该取值。

当您期望字符串很长时，调用者调用`std::move`并将值传递给设置器/构造器。这并不奇怪，因为`std::move`它非常明确地表明您正在移动数据。

If your system has no more than a modest amount of concurrency, and you rarely modify strings (really, most strings are shared far more than they are modified) shared pointers to immutable strings is actually a pretty useful pattern. (The shared write data is the reference count, so with high levels of concurrency can cause contention)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:02:16.717

我会去找参考资料（不仅传递它们，还要存储参考资料）。但是，二传手必须重新安装参考，这是不可能的。如果确实需要在构造后更改字符串，则必须使用指针（可能是智能指针）。

根据周围的代码，您可能希望使用字符串的共享所有权。在这种情况下，我会使用`std::shared_pointer<GLib::ustring>`. *如果你需要一个 setter*。（否则，参考更好。）

请注意，“某些段落”不是*很长的*字符串。在用户界面中，几毫秒的延迟，比如说在加载一些文本文件时，是完全可以接受的。与往常一样：请首先分析您的代码，检测瓶颈，然后在需要时进行优化以使其更快。

# mysql - monify 嵌入错误

> ID：14836478
> 
> 赞同：0
> 
> 时间：2013-02-12T15:57:53.307
> 
> 标签：mysql, mongodb, migration, data-migration

我正在尝试将我的数据库从 MySQL 迁移到 mongodb。

经过长时间的搜索，我决定使用 mongify。它工作得很好，但是当我尝试嵌入表时它没有做任何事情，它甚至没有将表导入到 mongodb。

这是我要嵌入的表格：

```
+------------+------------+--------+-------------+----------+
|  Flight_ID | Segment_ID | Origin | Destination | Aircraft |
+------------+------------+--------+-------------+----------+
|    14567   |  ORLY_SET  | XXXX   |  YYYY       |  B737    |
|    14567   |  SET_FGTE  | XXXX   |  YYYY       |  B737    |
|    14567   |  FGTE_SUY  | XXXX   |  YYYY       |  B737    |
|    14567   |  SUY_DERT  | XXXX   |  YYYY       |  B737    |
|    24789   |  SET_FGTE  | XXXX   |  YYYY       |  B737    |
|    24789   |  FGTE_TYU  | XXXX   |  YYYY       |  B737    |
|    24789   |  TYU_SETA  | XXXX   |  YYYY       |  B737    |
|    24789   |  SETA_MET  | XXXX   |  YYYY       |  B737    |
|    24789   |  MET_SETX  | XXXX   |  YYYY       |  B737    |
+------------+------------+--------+-------------+----------+ 
```

在 translation.rb 文件中，我使用以下语法：

```
table "Flight23", :embed_in => :flights, :on => :Flight_ID do
  column "Flight_ID", :integer, :references => :flights
  column "Segment_ID", :integer, :references => :segments
  column "Origin", :string
  column "Destination", :string
  column "Aircraft", :string
end 
```

有谁知道我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T09:00:37.147

问题是我没有航班表，所以我用 flight_id 创建了航班表来重新组合航班 23 表中的行，它运行良好

# c# - 如何将国家字符集应用于动态查询

> ID：14836483
> 
> 赞同：0
> 
> 时间：2013-02-12T15:58:05.763
> 
> 标签：c#, .net, sql-server, ado.net

我正在尝试`N`在变量名称之前应用[如何使用带有 unicode 字符串的“LIKE”语句](https://stackoverflow.com/questions/4251765/how-to-use-like-statement-with-unicode-strings)`Unicode`？

使用以下代码，我收到以下错误。这里需要纠正什么？

> 例外：列名“N@input”无效。

```
string commandText = @"SELECT AccountType,* 
                          FROM Account 
                          WHERE AccountType LIKE N@input "; 
```

代码

```
 static void Main(string[] args)
    {
        string result = DisplayTest("Daily Tax Updates:  -----------------        Transactions");

    }

    private static string DisplayTest(string searchValue)
    {
        string test = String.Empty;
        string connectionString = "Data Source=.;Initial Catalog=LibraryReservationSystem;Integrated Security=True;Connect Timeout=30";

        using (SqlConnection connection = new SqlConnection(connectionString))
        {
            connection.Open();
            string commandText = @"SELECT AccountType,* 
                          FROM Account 
                          WHERE AccountType LIKE N@input ";
            using (SqlCommand command = new SqlCommand(commandText, connection))
            {
                command.CommandType = System.Data.CommandType.Text;
                command.Parameters.AddWithValue("@input", "%" + searchValue + "%");

                using (SqlDataReader reader = command.ExecuteReader())
                {
                    if (reader.HasRows)
                    {
                        while (reader.Read())
                        {

                            test = reader.GetString(0);
                        }
                    }
                }
            }
        }

        return test;

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:09:50.880

我看到几个问题。

```
 string commandText = @"SELECT AccountType,* 
                              FROM Account 
                              WHERE AccountType LIKE N@input"; 
```

应该

```
 string commandText = @"SELECT AccountType,* 
                              FROM Account 
                              WHERE AccountType LIKE @input";

...

 command.Parameters.Add("@input",System.Data.SqlDbType.NVarChar,<<size>>);
 command.Parameters[0].Value = "%" + searchValue + "%"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:03:33.597

取自此堆栈[堆栈溢出](https://stackoverflow.com/questions/7548371/unicode-sql-query-w-parameter-instead-n-prefix)

```
SqlParameter parameter = new SqlParameter();
parameter.ParameterName = "@CategoryName";
parameter.SqlDbType = SqlDbType.NVarChar;
parameter.Direction = ParameterDirection.Input;
parameter.Value = categoryName; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T16:08:44.713

我看到您正在尝试使用 nvarchar 参数。我认为.net默认情况下会这样做`.AddWithValue`

我不确定您为什么需要对 nvarchar 进行类型转换，没有“N”部分应该没问题。

当您想要指定字符串文字应被视为 nvarchar 而不是 varchar 时，您需要的那部分，如`SELECT * from Table where field like N'%VALUE%'`

否则，您只需将变量/参数声明为 nvarchar

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T05:24:37.060

试试这个——

```
private static string DisplayTest(string searchValue)
{
    string connectionString = "Data Source=.;Initial Catalog=LibraryReservationSystem;Integrated Security=True;Connect Timeout=30";

    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();
        string commandText = @"SELECT AccountType,* FROM Account WHERE AccountType LIKE @input";

        using (SqlCommand command = new SqlCommand(commandText, connection))
        {
            command.CommandType = System.Data.CommandType.Text;

            command.Parameters.Add("@input", SqlDbType.NVarChar);
            command.Parameters["@input"].Value = string.Format("%{0}%", searchValue);

            using (SqlDataReader reader = command.ExecuteReader())
            {
                if (reader.HasRows)
                {
                    while (reader.Read())
                    {
                        return reader.GetString(0);
                    }
                }
            }
        }
    }

    return String.Empty;
} 
```

# animation - 在动画上模拟 mac 停靠鼠标

> ID：14836484
> 
> 赞同：0
> 
> 时间：2013-02-12T15:58:05.057
> 
> 标签：animation, qml

我想尝试使用 QML (QtQuick) 制作一个模拟 MacOSX 码头动画的码头应用程序。

我的目的是让它成为一个桌面应用程序，并使用鼠标区域来检测鼠标移动并创建 MacOSX 扩展坞正在使用的“鱼眼”动画。

我在想这可以在水平模式（或垂直模式）下使用 QML ListView：

（请参阅 expanddelegates.qml：[Qt 参考文档](http://doc.qt.digia.com/4.7-snapshot/declarative-modelviews-listview.html)）

只是想从专家那里得到一些反馈，这可以用 QML 相当好地完成吗？从哪里开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T13:10:01.107

这可以使用 qml 轻松完成。你需要学习：

*   [列表显示](http://doc.qt.digia.com/4.7-snapshot/qml-listview.html)

了解如何创建和使用

*   [列出模型](http://doc.qt.digia.com/4.7-snapshot/qml-listmodel.html)

了解如何使用和编辑（删除、追加）给定模型中的条目。

*   [鼠标区](http://doc.qt.digia.com/4.7-snapshot/qml-mousearea.html)

了解如何使用和了解“onEntered”和“onExited”信号。

*   [比例](http://doc.qt.digia.com/4.7-snapshot/qml-item.html#scale-prop)属性

*   [行为](http://doc.qt.digia.com/4.7-snapshot/qml-behavior.html)

了解如何使用它为元素属性的更改提供动画。

我认为如果您清楚地使用上述所有内容，您将能够清楚地想象如何实现您的想法。

# visual-studio - 无法使用 nuget 安装源代码包，有什么想法吗？

> ID：14836488
> 
> 赞同：1
> 
> 时间：2013-02-12T15:58:23.657
> 
> 标签：visual-studio, nuget, nuget-package

需要调试服务堆栈源，我发现他们正在[发布他们的源](http://www.symbolsource.org/Public/Metadata/NuGet/Project/ServiceStack.Common/3.9.35)，但是当我运行 nuget 命令来安装包时，它失败了，没有任何明显的异常：

> PM> Install-Package ServiceStack.Common -Source [http://nuget.gw.symbolsource.org/Public/NuGet/FeedService.mv​​c](http://nuget.gw.symbolsource.org/Public/NuGet/FeedService.mvc)
> Install-Package：处理此请求时出错。
> 在 line:1 char:16
> + Install-Package <<<< ServiceStack.Common -Source [http://nuget.gw.symbolsource.org/Public/NuGet/FeedService.mv](http://nuget.gw.symbolsource.org/Public/NuGet/FeedService.mvc)
> ​​c + CategoryInfo : NotSpecified: (:) [Install-包]，InvalidOperationException
> + FullyQualifiedErrorId：NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand

以前从未使用过`-Source`选项，它通常可以工作吗？我使用的版本是

> 包管理器控制台主机版本 2.2.31210.9045

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T07:04:36.450

我还没有设法解决 nuget 的问题，但我能够使用 workaraound 解决它 - 我只是添加`http://srv.symbolsource.org/pdb/Public`到符号服务器列表中，它能够根据需要下载服务堆栈 pdb。

# python - 在python中的类之间共享属性

> ID：14836489
> 
> 赞同：0
> 
> 时间：2013-02-12T15:58:23.980
> 
> 标签：python, object, inheritance

我不确定如何完成应该简单的事情。

我想定义一个类。在那个类中将是子类。在这些子类中将是属性。

好的，这很容易。但我希望根据另一个子类的属性生成一个子类的属性。这是我尝试这样做的（错误）代码：

```
class Food(object):
    class Fruits(object):
        crunchy=['Apples', 'Pears']
        juicy=['Limes', 'Lemons']

    class Salads(object):
        import Fruits
        FruitSalad=crunchy+juicy+['Whipped Cream'] 
```

显然“进口水果”在这里是错误的。但是我怎样才能完成我所需要的呢？

-------------编辑/附录---------------------------------- ----

好的，所以我失去了外部类“食物”，没关系，反正我从来不喜欢它。

我现在可以像这样将第一个类实例化为第二个类：

```
class Fruits(object):
    crunchy=['Apples', 'Pears']
    juicy=['Limes', 'Lemons']

class Salads(object):
    fruit=Fruits
    FruitSalad=fruit.crunchy+fruit.juicy+['Whipped Cream'] 
```

哪个更近，但我真的很想失去“水果”。结构体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:14:05.797

[也许对subclasses](http://en.wikipedia.org/wiki/Subclass_%28computer_science%29)与[encapsulation](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)存在一些混淆。如果您正在寻找继承，这是一个示例层次结构。请注意，这个特定的代码并没有充分利用层次结构，只是一些裸列表会更容易，并且变量都是类变量，而不是每个实例。

```
class Food(object):
    pass

class Fruit(Food):
    pass

class Salad(Food):
    pass

class CrunchyFruit(Fruit):
    ingredients = ['apples','pears']

class JuicyFruit(Fruit):
    ingredients = ['limes','lemons']

class FruitSalad(Salad):
    ingredients = JuicyFruit.ingredients + CrunchyFruit.ingredients + ['whipped cream']

print(FruitSalad.ingredients) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:28:44.977

因为您将其定义为一组嵌套的类，所以您不必要地使事情复杂化。解释现在将涉及诸如“班级套件”之类的词，以及为什么您需要`Fruits.crunchy`在一个地方和`Food.Fruits.crunchy`另一个地方。您还尝试连接列表和字符串，但这是行不通的。

只需保持简单，创​​建一个名为 的模块`food`，然后您就可以`import food`创建一个`food.Salads()`.

# javascript - pjax vs wiselinks，差异

> ID：14836490
> 
> 赞同：2
> 
> 时间：2013-02-12T15:58:25.890
> 
> 标签：javascript, jquery, ajax, browser-history, pjax

有什么区别，哪个更快？

**+1 for wiselinks**，可以这样使用：

```
<a href="/?page=2" data-push="true" data-target="@catalog">2</a> 
```

所以它可以针对

```
<div role="catalog"></div> 
```

并替换其内容。

**+1 为 pjax**，它可以在 php 服务器端重定向时重定向。

如我错了请纠正我。

你的意见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:55:26.533

例如，Wiselinks 可以处理表单，并且可以在非 HTML5 浏览器中工作。顺便说一句，不要忘记添加 role.js 以在 JQuery 中使用 @role 选择器。

# php - 如何使用 Jasny 的引导图像预览上传图像？

> ID：14836491
> 
> 赞同：5
> 
> 时间：2013-02-12T15:58:25.810
> 
> 标签：php, jquery, twitter-bootstrap

我正在尝试使用 Jasny 的 Bootstrap。这是个好作品！

[我在http://jasny.github.com/bootstrap/javascript.html#fileupload](http://jasny.github.com/bootstrap/javascript.html#fileupload)页面上找不到引导上传图像的解决方案

使用 bootstrap-fileupload.js，如何使用 Ajax 上传图像？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T10:55:29.607

我直接向 Jasny's Bootstrap 的所有者 ARNOLD DANIELS 提出了这个问题。

这是他的回答：

> 图片预览的重点是图片立即显示，无需使用AJAX将其上传到服务器。所以它只是一个常规的形式。如果需要，您可以使用 AJAX [http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)发布表单。
> 
> 如果您确实想使用 AJAX 上传图像并且不想使用表单， [请查看 http://www.9lessons.info/2011/08/ajax-image-upload-without-refreshing.html](http://www.9lessons.info/2011/08/ajax-image-upload-without-refreshing.html)

我使用此示例删除了与数据库相关的行，并且对我来说非常有效！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T16:57:48.920

首先你需要注册css和js文件：

如果你使用 Yii 框架：

```
$cs = Yii::app()->clientScript;
$cs->registerCSSFile("/css/fileupload.css");
$cs->registerScriptFile('/js/fileupload.js', CClientScript::POS_END); 
```

或者

```
<link rel="stylesheet" type="text/css" href="/css/fileupload.css">
<script type="text/javascript" src="/js/fileupload.js"></script> 
```

然后注册以下脚本：

```
$cs->registerScript("imageUpload", "$('.fileupload').fileupload({uploadtype: 'image'});", CClientScript::POS_END) ; 
```

或者

```
<script type="text/javascript">
$('.fileupload').fileupload({uploadtype: 'image'});
</script> 
```

然后将以下 HTML 代码添加到您的页面：

```
<div class="fileupload fileupload-new" data-provides="fileupload">
  <div class="fileupload-preview thumbnail" style="width: 200px; height: 150px;"></div>
  <div>
    <span class="btn btn-file"><span class="fileupload-new">Select image</span><span class="fileupload-exists">Change</span><input type="file" /></span>
    <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
  </div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-30T14:27:43.903

我在谷歌上遇到了这个问题，只是想表明我是为其他感兴趣的人做的（即使这不是最优雅的方式）

```
$(document).ready(function(){
$('.fileinput-preview').bind('DOMNodeInserted', function(event) {
    var imgdata = ($('.fileinput-preview img').attr('src'));
    $.post( "upload.php", { imgdata: imgdata})
    .done(function( data ) {
    alert( "Data Loaded: " + data );
  });
   })
}) 
```

上面这段代码检测文件输入预览何时更改。然后它从图像标签中找到base64数据，并使用jquery将其发布到upload.php。

Upload.php 只是简单的获取base64图片数据并保存为图片

```
$imgdata = $_POST['imgdata'];
$ifp = fopen("newimage.jpg", "wb"); 
$data = explode(',', $imgdata);
fwrite($ifp, base64_decode($data[1])); 
fclose($ifp); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T00:07:06.817

jasny 上的上传不仅仅是预览或客户端上传管理而不是 ajax，可能您需要使用其他方法或插件，因为 jasny 上传将使用二进制图像显示发送预览路径

# powershell - 从 GAC 导入模块用于 PowerShell 使用

> ID：14836492
> 
> 赞同：8
> 
> 时间：2013-02-12T15:58:26.040
> 
> 标签：powershell, gac

我创建了一个 powershell 模块，如果我像这样加载它就可以正常工作

```
Import-Module "C:\temp\My.PowerShell.DocumentConversion.dll" 
```

我确实在全局程序集缓存中注册了该模块，但无法从那里加载它。我已经验证该模块实际上已加载到 gac 中。我认为像这样加载模块就足够了

```
Import-Module My.PowerShell.DocumentConversion.dll 
```

显然我错了，如何从 gac 运行 powershell 模块？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-12T16:04:57.807

试试[`Add-Type`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/add-type)cmdlet：

```
Add-Type -Assembly My.PowerShell.DocumentConversion 
```

如果它不起作用，请尝试[LoadWithPartialName](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.loadwithpartialname)方法：

```
[System.Reflection.Assembly]::LoadWithPartialName('My.PowerShell.DocumentConversion') 
```

或使用完整路径：

```
[System.Reflection.Assembly]::LoadFile(...) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-20T13:02:14.627

只要程序集在 GAC 中，只需使用强名称来引用程序集。要获取 GAC 的路径，请注意它在 .Net 4.0 [http://en.wikipedia.org/wiki/Global_Assembly_Cache中已更改](http://en.wikipedia.org/wiki/Global_Assembly_Cache)

```
$assemblyPath = 'path to the assembly file in the gac'
$fullName = [System.Reflection.AssemblyName]::GetAssemblyName($assemblyPath).FullName
[System.Reflection.Assembly]::Load($fullName) 
```

# guice - how to have guice use my factory for creating new instances

> ID：14836493
> 
> 赞同：1
> 
> 时间：2013-02-12T15:58:26.347
> 
> 标签：guice

I am trying to have guice call my factory method to create the instance and then fill it in from inspecting it's annotations. I know I have done this before but I can't figure out how to bind the following code....

My bind code

```
binder.bind(ProcessorFactory.class).asEagerSingleton(); 
```

The code I am binding (and I want Guice to fill in SplineProcessor and InvertProcessor with their bindings on creation.

```
public class ProcessorFactory implements Provider<Processor>{

    public static final ThreadLocal<String> threadLocal = new ThreadLocal<String>();

    private Map<String, Class<?>> nameToClazz = new HashMap<String, Class<?>>();

    public ProcessorFactory() {
        nameToClazz.put("splineV1Beta", SplineProcessor.class);
        nameToClazz.put("invertV1Beta", InvertProcessor.class);
}

    @Override
    public Processor get() {
        String moduleName = threadLocal.get();
        if(moduleName == null)
             throw new IllegalArgumentException("Please call ProcessorFactory.threadLocal.set(moduleName)");
        Class<?> clazz = nameToClazz.get(moduleName);
        if(clazz == null)
             return null;

    try {
        Object newInstance = clazz.newInstance();
        return (Processor) newInstance;
    } catch (InstantiationException e) {
        throw new RuntimeException(e);
    } catch (IllegalAccessException e) {
        throw new RuntimeException(e);
    } finally {
        threadLocal.set(null);
    }
}

} 
```

NOTE: I would STILL like to know how to do this though I also have this open question which is an even better way of doing the same thing [guice multibinder with Providers](https://stackoverflow.com/questions/14833777/guice-multibinder-with-providers)

but unfortunately, I can't get that to work either.

NOTE: What inject code do I use as well. I am using the following code to inject(and tried ProcessorFactory as well).

```
@Inject
private Provider<ProcessorSetup> processors; 
```

EDIT FOR MORE CLARIY

In a bean I have the following

```
@Inject
private Provider<ProcessorSetup> processors; 
```

and when I call processors.get(), it steps into guice and then guice correctly invokes ProcessorFactory.get() and I step through that code, and my new enttiy passes through Guice to be returned to the client but is never wired up to anything. This stinks because we have @Inject in those entities we create as well. I know about 2 years ago I had this working on another project related to these posts

[https://groups.google.com/forum/?fromgroups=#!searchin/google-guice/dean/google-guice/BZn2cnSeX64/MCRgFPjoHH4J](https://groups.google.com/forum/?fromgroups=#!searchin/google-guice/dean/google-guice/BZn2cnSeX64/MCRgFPjoHH4J)

as I did figure out how to remove the injector at one point finally.

thanks, Dean

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:22:34.123

您是否试图让 Guice 使用您的提供程序来创建 的实例`Processor`？如果是这样，那么您应该将配置更改为：

```
bind(Processor.class).toProvider(ProcessorFactory.class); 
```

看起来您也正在使用它`ThreadLocal`来配置生成的实例。你考虑过[辅助注射](http://code.google.com/p/google-guice/wiki/AssistedInject "辅助注射")吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:20:23.063

> 我的新实体通过 Guice 返回给客户端，但从未连接到任何东西。这很臭，因为我们在我们创建的那些实体中也有 @Inject

这是预期的，因为您使用`clazz.newInstance()`. 如果你想让 Guice 注入它的成员，你需要调用`injector.injectMemebers(newInstance)`. 这将注入所有字段和方法，但显然不是构造函数注入。

我还有第二个 condit 建议，用 AssitedInject 替换 ThreadLocals 以进行参数传递，或者简单地创建一个自定义工厂而不是提供程序。

# ruby - List of Ruby Class Method Aliases

> ID：14836495
> 
> 赞同：3
> 
> 时间：2013-02-12T15:58:31.887
> 
> 标签：ruby

The Random class method `Random.rand` is aliased as `rand` (i.e. equivalent to `Random.rand`). Is there anyway to get a listing of the class method aliases used by Ruby?

Not sure that Ruby documentation offers a complete list as it does identify `rand` as an alias of `Random.rand` but there is no mention that `srand` is an alias yet it can be invoked using `srand` or `Random.srand`

I eventually answered my own question - please have a look below.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:52:11.820

编辑我的原始问题：

这个问题的根源在于对 Ruby Random 类文档参考[http://ruby-doc.org/core-2.0/Random.html](http://ruby-doc.org/core-2.0/Random.html)的误解，该参考引用了 Random.rand 类方法的别名 rand。事实证明 rand 和 srand 调用了内核实例方法。要调用 Random 类的类方法 rand 和 srand，您需要提供完整解析的调用，例如 Random.rand 或 Random.srand

因此，我正在寻找的列表实际上是内核实例方法的内核文档[http://www.ruby-doc.org/core-1.9.3/Kernel.html](http://www.ruby-doc.org/core-1.9.3/Kernel.html)

# java - how can Rss Location Based Feed be implemented

> ID：14836498
> 
> 赞同：2
> 
> 时间：2013-02-12T15:58:38.797
> 
> 标签：java, rss, location, feed, rss-reader

After more than 10 Hours of searching the web, I am not able to find a single piece of information that shows me how to implement RSS feeds based on location. Also, how can I implement Location and Category-based RSS Feed Search in Java, similar to Groupon and Living Social sites? I want to show location-based deals. Any help would be greatly appreciated.

# c++ - 在 C++ 中动态地将文件放入文件夹中

> ID：14836510
> 
> 赞同：1
> 
> 时间：2013-02-12T15:59:11.717
> 
> 标签：c++, linux

假设我有一个 txt 文件，在 txt 文件中写着：“doc1.doc, doc2.doc, doc3.doc”.. 等等。在我的代码中，我阅读了这个 txt 文件并找到了文件“doc1.doc , doc2.doc..”。

我想在使用 c++ 读取 txt 文件时将这些 doc 文件放在一个文件夹中。是否可以？

假设我已经有一个文件夹，不需要创建一个新文件夹。唯一关心的是将文件放入文件夹中。

编辑：我正在使用linux。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:18:19.210

您可以使用 Giomm，它是 glibmm 的一部分，它是 Glib 的 C++ 绑定。看一下，很直观（比低级系统/posix C 函数多）：

[http://developer.gnome.org/glibmm/stable/classGio_1_1File.html#details](http://developer.gnome.org/glibmm/stable/classGio_1_1File.html#details)

这可能对目录迭代有用：

[http://developer.gnome.org/glibmm/stable/classGlib_1_1Dir.html](http://developer.gnome.org/glibmm/2.34/classGlib_1_1Dir.html)

它也是便携的！它适用于 Glib 工作的任何地方。Windows、Linux、MacOS……你不会局限于 linux。这确实意味着您依赖于 Glim 和 glibmm，但是 Glib 非常常被 GNU/Linux 软件使用，并且任何使用 GTK 或其任何绑定的 GUI 应用程序，无论如何都非常有可能加载 Glib，这取决于您的情况，这解决方案并没有真正增加额外的依赖。

此外，一个很大的优势，尤其是在使用 Linux 的情况下，是您可以访问自由软件的源代码并查看这些代码在那里的作用。例如，您可以访问 Gnome 的 git 存储库（位于[git.gnome.org](http://git.gnome.org)），然后访问一个处理文档的项目，例如文本编辑器[gedit](http://git.gnome.org/browse/gedit)，并了解它如何将文档保存到文件中。或者更好的是，检查一个用 C++ 编写的项目（gedit 是用 C 编写的），例如 Glom 或 Inkscape 或 Gnote，看看它们做了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:03:25.030

您的问题没有提供足够的信息来获得完整的答案。C++ 作为一种语言并没有真正具有处理文件夹或文件的功能。这是因为 C++ 与平台无关，这意味着您可以编译 C++ 代码以在 Windows、MacOS、iOS、Android、Linux 任何其他甚至没有文件系统的设备上运行。

当然，在您的情况下，您可能指的是 Windows 或 Linux。如果是这种情况，那么根据它的具体情况，您可以使用文件系统函数来复制或移动文件系统中的文件。

对于 Windows，Win32 API 具有用于复制文件的[CopyFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363851%28v=vs.85%29.aspx)和 CopyFileEx 函数以及用于移动或重命名文件的[MoveFile和 MoveFileEx 函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365239%28v=vs.85%29.aspx)

对于 Linux，您可以使用[sendfile](http://linux.die.net/man/2/sendfile) API 函数通过内核复制文件。

我应该指出，可以在 C/C++ 中编写一些与平台无关的代码，以使用 open/read/write 函数将文件的内容复制到另一个文件（即以读取模式打开源文件，打开目标文件在写入模式下，然后继续从源读取并写入目标，直到到达源文件的末尾）但是其他文件系统功能更加困难，如果不是不可能在没有特定于平台的库的情况下重现的话。

**更新**

由于您指定要在 linux 中执行此操作，因此您可以使用 sendfile 函数：

```
int inputFileDesc;
int outputFileDesc;
struct stat statBuffer;
off_t offset = 0;

// open the source file, and get a file descriptor to identify it later (for closing and sendfile fn)
inputFileDesc = open ("path_to_source_file", O_RDONLY);

// this function will fill the statBuffer struct with info about the file, including the size in bytes
fstat (inputFileDesc, &statBuffer);

// open the destination file and get a descriptor to identify it later (for closing and writing to it)
outputFileDesc = open ("path_to_destination_file", O_WRONLY | O_CREAT, statBuffer.st_mode);

// this is the API function that actually copies file data from source to dest;
//   it takes as params the descriptors of the input and output files and an offset and length for the amount of data to copy over
sendfile (outputFileDesc, inputFileDesc, &offset, statBuffer.st_size);

close (outputFileDesc);    // closes the output file (identified by descriptor) 
close (inputFileDesc);     // closes the input file (identified by descriptor) 
```

# android - Android HTML5 Audio Element with Audio Sprites

> ID：14836512
> 
> 赞同：2
> 
> 时间：2013-02-12T15:59:20.533
> 
> 标签：android, html, audio, audio-streaming, html5-audio

So maybe someone has experience with advanced audio handling in mobile browsers!

I have problems in setting the current time of the audio player. On desktop browsers and iOS it all works perfect. I set the current time to my next sprite and then play until current time reaches the end of my sprite.

On android I set the current time and after the first timeupdate-event gets fired the current time of my audioplayer is about 15-20 sec later!!! So my sprite will not be played because my sprites are only 8 sec long.

I really need that sprite handling, because on mobile browsers we can only access one player and I dont wanna waste time in creating and audio element, downloading the source and set the src. This takes to much time...

I will also be very happe if there is another solution. Someone tried to have the audio player and stream audio in that from an server??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T14:22:01.737

如果有人有兴趣，我有一个解决方案！

错误是使用比特率模式变量导出音频文件（android 浏览器的 mp3）。首先我选择可变比特率模式，因为我的精灵之间有很多空白空间，使用这个选项我可以节省文件大小！虽然 android 浏览器的编解码器可以处理这些可变数据，但是当我尝试为我的文件设置一个明确的时间时，它可能会提前或推迟 10-12 秒。这取决于您如何意外地撞击可变数据块。

为了不给可变数据块带来麻烦，我将我的 mp3 导出为具有中等质量 (145-185 kbps) 的预设比特率模式。我的文件比可变比特率模式大 30%，但现在可以使用了！！

# google-dfp - DFP：如何在 640x480 区域中显示两个 300x250 广告？

> ID：14836516
> 
> 赞同：0
> 
> 时间：2013-02-12T15:59:40.540
> 
> 标签：google-dfp

我是 Google DFP 的新手，想知道...

*   我创建了一个 640x480 区域，但我目前没有要在其中显示的广告。
*   AdSense 用一个 300x250 的广告填充它。

有什么办法可以在那个 640x480 区域中显示两个 300x250 的广告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:09:10.207

第一个问题可能是两个 300x250 的广告不适合 640x480 的盒子……它们太高了，所以只会加载一个。这可能是问题所在，但我不确定谷歌是否会将两个广告加载到一个更大的 adunit 中......我认为没有任何方法可以使用 DFP 执行此操作，而无需您进行一些额外的编码。

您基本上需要对您的 640x480 广告进行回调，如果没有找到匹配的广告就会触发，并在其中添加两个新的广告单元并尝试为它们加载广告。

让这个回调恢复的一个简单方法是使用我制作的插件：[jQuery DFP](https://github.com/coop182/jquery.dfp.js)

查看[引导文件](https://github.com/coop182/jquery.dfp.js/blob/master/example-bootstrap.js)以了解如何使用回调...如果您需要一些示例代码，请告诉我！

# objective-c - 试图制作标签式uiwebview浏览器需要帮助xcode

> ID：14836517
> 
> 赞同：1
> 
> 时间：2013-02-12T15:59:49.213
> 
> 标签：objective-c, xcode, uiwebview

我正在尝试制作标签浏览器，就像带有标签的 safari 或 chrome 一样。当用户打开新的 url 时，webview 将被添加到数组中。当用户点击按钮然后 openLoadedWebview: 将调用并删除原始 webview 并从数组中打开加载的 webview。

**但它没有发生。工作的事情是：** webview removefromsuperview 工作。wv 成功添加到 self.view。索引号 **问题：** 新添加的 wv 与具有相同 url 的 webview 相同。

任何更好的想法或方法......我是全新的......

**主视图控制器.h**

```
 @interface mainViewController : UIViewController <UITextFieldDelegate, UIWebViewDelegate>
    {
        UIWebView *webView;
        UIWebView *wv;
    }
    @property (nonatomic, strong) NSMutableArray *array; 
```

**主视图控制器.m**

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    webView = [[UIWebView alloc]init];
    webView.frame = CGRectMake(10, 130, 300, 400);
    webView.delegate = self;
    [self.view addSubview:webView];
}

-(BOOL)textFieldShouldReturn:(UITextField *)textField {

    textField.text = [self repairURL:textField.text];
    NSURL *url = [[NSURL alloc] initWithString:textField.text];
    NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];
    [webView loadRequest:request];
    [array addObject:webView];

    return true;
}

-(void)openLoadedWebview:(NSString *)pageLabel

    if ([cell.label.text isEqualToString:@"Trending"]) {
                NSLog(@"Selected Cell: %@", pageLabel);
            NSLog(@"number of objects %d", [array count]);
           // wv = [[UIWebView alloc]init];

            wv = [array objectAtIndex:0];
            wv.frame = CGRectMake(10, 100, 300, 400);
            wv.delegate = self;
            [self.view addSubview:wv];

        }
      else if ([cell.label.text isEqualToString:@"Rec"]) {

            wv = [array objectAtIndex:1];
            wv.frame = CGRectMake(10, 100, 300, 400);
            wv.delegate = self;
            [self.view addSubview:wv];
        }

[webView removeFromSuperview];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:12:37.947

您可以使用其中之一： [https ://github.com/graetzer/SGTabs](https://github.com/graetzer/SGTabs) [https://github.com/xxhp/BrowserTabViewDemo](https://github.com/xxhp/BrowserTabViewDemo)

我认为这就是您想要实现的目标：[https ://github.com/fictorial/BHTabBar](https://github.com/fictorial/BHTabBar)

# java - Exceptions with java agents (-javaagent:XXXX.jar )

> ID：14836518
> 
> 赞同：1
> 
> 时间：2013-02-12T15:59:52.393
> 
> 标签：java, noclassdeffounderror, classnotfoundexception, javaagents, invocationtargetexception

Anybody can provide me with a suggestion/solution to fix this problem?

Java Version : JDK 1.6 --UPDATED

I am trying to add a jar file into eclipse VM arguments through javaagents: ![enter image description here](../Images/b027690002b16c91b35fbb9bc8c1d67f.png) But this seems to have an error when i run a simple code

```
package jassmodernexample;
import jass.modern.Pre;
import java.io.*;

public class Bar {
@Pre("args.length % 2 == 0")
public static void main(String[] args) {
    System.out.println("Hello, " + args.length);
     }
} 
```

> Exception in thread "main" **java.lang.reflect.InvocationTargetException** at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at sun.instrument.InstrumentationImpl.loadClassAndStartAgent(InstrumentationImpl.java:323) at sun.instrument.InstrumentationImpl.loadClassAndCallPremain(InstrumentationImpl.java:338)
> 
> Caused by: **java.lang.NoClassDefFoundError:** javax/tools/JavaCompilerTool$CompilationTask at java.lang.ClassLoader.defineClass1(Native Method) at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631) at java.lang.ClassLoader.defineClass(ClassLoader.java:615) at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141) at java.net.URLClassLoader.defineClass(URLClassLoader.java:283) at java.net.URLClassLoader.access$000(URLClassLoader.java:58) at java.net.URLClassLoader$1.run(URLClassLoader.java:197) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:190) at java.lang.ClassLoader.loadClass(ClassLoader.java:306) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301) at java.lang.ClassLoader.loadClass(ClassLoader.java:247) at jass.modern.core.bytecode.contracts.ContractClassFileTransformer.(ContractClassFileTransformer.java:50) at jass.modern.core.bytecode.PreMain.premain(PreMain.java:62) ... 6 more
> 
> Caused by: **java.lang.ClassNotFoundException**: javax.tools.JavaCompilerTool$CompilationTask at java.net.URLClassLoader$1.run(URLClassLoader.java:202) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:190) at java.lang.ClassLoader.loadClass(ClassLoader.java:306) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301) at java.lang.ClassLoader.loadClass(ClassLoader.java:247) ... 20 more
> 
> FATAL ERROR in native method: processing of -javaagent failed

# windows-phone-8 - Drag and Drop of a map in widows phone 8

> ID：14836520
> 
> 赞同：0
> 
> 时间：2013-02-12T16:00:00.947
> 
> 标签：windows-phone-8, bing-maps, bing-api

I am building a windows phone 8 using BingMapsDirectionsTask

```
BingMapsDirectionsTask task = new BingMapsDirectionsTask();

ShowMyLocationOnTheMap();

LabeledMapLocation start = new LabeledMapLocation(myCrntAddres, new System.Device.Location.GeoCoordinate());
LabeledMapLocation end = new LabeledMapLocation(desLoc.Text, new System.Device.Location.GeoCoordinate());
task.Start = start;
task.End = end; 
```

The code is working fine, but I want to add functionality so that a user can drag route on map which is already mapped between user current location and user inputed address.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:32:20.317

该功能不是内置的，并且不受 BingMapsDirectionsTask/MapsDirectionsTask 支持。

如果您想要此功能，您必须使用新的 WP8`<Map />`控件而不是使用启动器将其构建到您自己的应用程序中。阅读更多关于新地图控件@http [://www.developer.nokia.com/Resources/Library/Lumia/# !guide-to-the-maps.html;#toc_Mapcontrol](http://www.developer.nokia.com/Resources/Library/Lumia/#!guide-to-the-maps.html;#toc_Mapcontrol)

# css - horizontally align controls in gwt bootstrap

> ID：14836522
> 
> 赞同：0
> 
> 时间：2013-02-12T16:00:05.220
> 
> 标签：css, twitter-bootstrap, gwt-bootstrap

I'm attempting to horizontally align two controls (namely the `Checkbox` and `Nav`) in a `Controlgroup`'s controls section. However, I can't find a way to prevent their vertical alignment.

```
<b:ControlGroup>
   <b:Controls controlsRow="true">
      <b:CheckBox ui:field="tosCheckBox" text="I accept the " />
      <b:Nav>
         <b:NavLink href="" text="Terms of Use" />
      </b:Nav>
   </b:Controls>
</b:ControlGroup> 
```

Aligning two checkboxes horizontally is possible with 'Inline'. But in this case I want to horizontally align the checkbox and Nav. And Nav doesn't support Inline. I noticed by default listboxes are also horizontally aligned in a `Control`'s group

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T08:24:18.607

创建以下两个类 InlinePanel 和 InlineBlock

```
 public class InlinePanel extends UnorderedList {
    public static final String inline = "inline";

    public InlinePanel() {
        super();

        addStyleName(inline);
    }
}

public class InlineBlock extends ListItem {

} 
```

然后相应地调整您的代码：

```
<a:InlinePanel>
  <a:InlineBlock>
    <b:CheckBox ui:field="tosCheckBox" text="I accept the " />
  </a:InlineBlock>
  <a:InlineBlock>
    <b:Nav>
     <b:NavLink href="" text="Terms of Use" />
  </b:Nav>
  </a:InlineBlock>
</a:InlinePanel> 
```

这应该够了吧。

# c - ARMCC remove unused variables

> ID：14836528
> 
> 赞同：2
> 
> 时间：2013-02-12T16:00:22.493
> 
> 标签：c, optimization, arm, armcc

I'm trying to remove unused code with Keil ARM tools that use ARMCC compiler. I've previously used GCC based compilers for ARM and I could easily remove the unused code with:

```
-fdata-sections -ffunction-sections 
```

For ARMCC i found similar flag

```
--split_sections 
```

but it works only with functions and not with variables.

Is there any way to remove unused variables with ARMCC?

* * *

Edit:

For example giving the following library code:

```
lib.c :

static int veryBigArray[1000000UL];

int func1() { ... }

int func2() { memset(veryBigArray, 0, sizeof(veryBigArray); } 
```

and my project code:

```
project.c:

int main(void)
{
   func1();
} 
```

I want to remove func2() and veryBigArray using compiler/linker optimizations.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T09:55:38.367

我们从 ARM 支持收到的官方回答是，目前（ARMCC v5.03 [Build 24]）在 ARMCC 编译器中没有可用的选项 - 他们只是从未想过这种情况。

希望它将被添加到未来的 ARMCC 版本中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-15T23:39:50.250

在大多数情况下，当数据位于其自己的部分中时，可以使用 --remove 作为链接器选项来删除未使用的数据。要将数据放在自己的部分中，您可以创建另一个文件或使用部分属性： http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0375g/ [chr1359124982450.html](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0375g/chr1359124982450.html)

例如，如果全局数据仅在一个函数中使用，并且该函数已定义但从未使用过，则在 armcc 中自动删除数据，无需 --remove。

我说“在大多数情况下”是因为在某些情况下用户告诉编译器不要专门优化它。

Arm 编译器版本 6 (armclang) 确实具有 -fdata-sections。

# android - how to Get data from SQLite database to intent through “onItemClick” on item in ListView Android

> ID：14836533
> 
> 赞同：1
> 
> 时间：2013-02-12T16:00:33.220
> 
> 标签：android, sqlite, listview, onitemclicklistener, onitemclick

I apologize in advance, I am from Indonesia, so my English may not be good .. I just translate me through google translate

I'm making a android app associated with sqlite. the problem I have, I want to display data from the database according to the selected listview. application is an application that I made a tour guide.

while running the application, will be performing some of the category of existing attractions. if one of the selected categories, such as category: Nature, it will show a list of names that exist in nature in the form of a database listview.

I managed to get it up here.

after that, if I choose one of the name of nature, such as: Losari, it will show a description of Losari according to the database.

I am confused how to display as I described above .. please help me

this file alam.java for displaying listview whose data retrieved from the database

```
dbadapter db;
protected Cursor cursor;
protected ListAdapter adapter;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.alam);
    final ListView dftAlam = (ListView)findViewById(R.id.lv);
    final dbadapter db = new dbadapter(this);
    ArrayList<DFT_ALAM> dft_alam = db.getAllAlam();
    dftAlam.setAdapter(new MyAdapter(this, dft_alam));

    dftAlam.setOnItemClickListener(new OnItemClickListener() {

        private String nama;
        private String alamat;
        private String desk;

        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            // TODO Auto-generated method stub
            String selectedItem = (String) dftAlam.getItemAtPosition(arg2);
            String query = "SELECT nama, alamat, desk FROM wisata WHERE nama = '" + selectedItem + "'";
            SQLiteDatabase dbs = db.getReadableDatabase();
            Cursor result = dbs.rawQuery(query, null);
            result.moveToFirst();
            nama = result.getString(result.getColumnIndex("nama"));
            alamat = result.getString(result.getColumnIndex("alamat"));
            desk = result.getString(result.getColumnIndex("desk"));
            Intent intent = new Intent(android.content.Intent.ACTION_VIEW, null, null, deskAlam.class);
            startActivity(intent); 

        }
    });

}
    public void onClick(View v) {

    }

} 
```

This file deskAlam.java will display a description of the selected option in listview

```
dbadapter db;
TextView nama = null;
TextView alamat = null;
TextView desk = null;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.desk);

    TextView nama = (TextView)findViewById(R.id.nm);
    TextView alamat = (TextView)findViewById(R.id.alm);
    TextView desk = (TextView)findViewById(R.id.desk);
    dbadapter db = new dbadapter (this);
    db.openDataBase();
    Cursor c = (Cursor) db.getAllAlam();
    if (c.moveToFirst()){
        do{
            tampil(c);
        }while (c.moveToNext());
    }
}

public void tampil(Cursor c) {
    // TODO Auto-generated method stub
    Toast.makeText(this, c.getString(4) + "\n" +
                            c.getString(5) + "\n" +
                            c.getString(6), Toast.LENGTH_LONG).show();
}   

} 
```

please fix it if something goes wrong or less of the source code I mentioned above

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T10:28:00.733

这是您需要在 onItemClick 中执行的操作：

```
listview.setOnItemClickListener(new OnItemClickListener() {

    @Override
        public void onItemClick(AdapterView<?> parent, View view, int position,
                            long id) {
                Intent intent = new Intent(ThisActivity.this, NextActivity.class);
                intent.putExtra("chosen", position);
                startActivity(intent);
                }
        }); 
```

以及如何在下一个意图中获取数据：

```
int chosenPosition;
YourObject chosenObject;    
Bundle extras = getIntent().getExtras();

if (extras != null) {
    //Here you get the id from the item
    chosenPosition= (int)extras.getInt("chosen");
}   
//Here you use the id to get the object from your database or whatever
chosenObject = Database.getYourObject(chosenPosition+ 1); 
```

# php - 反向读取文本文件直到遇到随机日期

> ID：14836535
> 
> 赞同：0
> 
> 时间：2013-02-12T16:00:41.557
> 
> 标签：php, file, array-reverse

我有一个文本文件，例如：

```
================================================
[Feb 11 2013 13:17:14] - some string here and here
General options - [something]
Line y
================================================
Line 1
Line 2
Line 3
Line 4
Line 5     
Something here. Error message: ReferenceError: applyMetadataTemplate is undefined; line: 625  
Line 7
================================================
[Feb 11 2013 16:07:14] - some string here and here
General options - [something]
Line y
================================================
Line 1
Line 2
Line 3
Line 4
Line 5     
Something here. Error message: ReferenceError: applyMetadataTemplate is undefined; line: 625  
Line 7 
```

现在我想向后读取这个文件，对于我在新日期的记录中找到的每个错误，我需要做一些事情。我需要帮助 1) 向后读取文件，直到遇到日期并保存该日期，2) 在此之前将所有行作为字符串抓取并在其中找到单词 Error。注意：每条记录可能有不同的行数，并且不一定包含错误一词。这更像是“查找并匹配日期，然后在该记录中查找错误”类型的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:05:15.723

```
$matches = array();    
$file = file("log.txt");
$file = array_reverse($file);
foreach($file as $f){
    if (stripos($f, "[") !== false) { 
        // Check string for date by regex 
        preg_match('/(\D*) (\d{2}) (\d{4})/', $f, $matches);

        // Check that parts of the date were found
        if(count($matches) > 2) {
            echo $f; //print the line
            break;
        }
    }
} 
```

读取一个文件，并将其转换为一个数组，然后将数组反转为反向遍历，然后打印出最后一个日期。

# php - PHP - accessing locked row in an Oracle table

> ID：14836536
> 
> 赞同：2
> 
> 时间：2013-02-12T16:00:44.987
> 
> 标签：php, ajax, oracle, concurrency, locking

I have a web application which needs to send multiple Ajax request to a PHP page (backend.php)

There is an **Oracle** table, let's say *T1* with 2 int fields *min* and *max* (for this example is enough, actually it's a bit more complex).

Backend.php needs to read *mix* and *max*, update these values (let's say min += 2, max += 3), then return min and max via some JSON.

In this case I can't use Oracle Sequences (because in the real application there are N rows).

I want to put a **lock on the row**, to avoid different Ajax calls reading the same values from the row.

I tried to run (via PHP's OCI) something like `SELECT a, b FROM t1 FOR UPDATE SKIP LOCKED` but it seems not to work, 2 Ajax calls sometimes return the same A and B values.

How can I make locks working? Is there a better way? Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T11:31:32.347

我不确定您是否需要显式锁。一个简单的

```
update T1 set min=min+2, max=max+3 where ... 
```

将自动锁定受影响的行。

您可能需要花药选择来返回更新的值（或在 PL/SQL 中使用 RETURNING）

# java - 克隆字符串数组，检查参考

> ID：14836539
> 
> 赞同：0
> 
> 时间：2013-02-12T16:00:55.390
> 
> 标签：java, clone

使用 java 数组上的 clone() 方法克隆字符串数组。克隆后，我希望在新数组中有新的字符串 - 为它们分配了新的地址。但是......我的行为有点不同，请看看这个：

（它将打印：

```
same address
One 
```

)

```
public class ArrayCopyClone {

    static String[] array2 = new String[] {"One", "Two", "Three"};

    public static void main(String[] args) {

        String[] copy2 = array2.clone();

        if (copy2[0] != array2[0])  {
            System.out.println("good");   // will never show up
        } else {
           System.out.println("same address");  // I'm expecting never be here
        }

        array2[0] = "new";

        System.out.println(copy2[0]); // "One", and this is OK (it means we have a copy)

    }

} 
```

它与字符串阴影有关吗？应该是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:07:10.760

克隆数组会提供浅拷贝。所以内容是一样的。对于深度克隆，请参见[此处](https://stackoverflow.com/questions/2156120/java-recommended-solution-for-deep-cloning-copying-an-instance/2156367#2156367)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:07:06.227

首先，默认情况下`clone()`不作为“深度克隆”实现，因此它将子对象复制为引用。此外，字符串由 JDK 缓存。您正在暴露 2 个这些效果。

# c - I can not use libc, yet I have to reallocate and allocate memory using C

> ID：14836549
> 
> 赞同：-2
> 
> 时间：2013-02-12T16:01:14.127
> 
> 标签：c, linux

Here is my code,

```
char buf[1];
int count=0;
while( Read(fileID, buf, 1)==1)
{
        contents = (char *)realloc(contents,(iVal+1)*sizeof(char));
        contents[count]=buf[0];
        count++;
} 
```

Now that I can not use libc, how would I do the reallocation. The problem is that I do not know the size of the file I am reading so I have reallocate. The same problem exists with malloc as well.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:16:36.127

如果您没有`libc`或没有其他具有内存管理功能的库（malloc/realloc/free 等价物），您必须编写自己的内存管理器。如果您正在为 Linux 编写内核模块，您可能可以访问，`kmalloc(9)`甚至`kfree(9)`可能访问`krealloc`. 如果没有，那么您必须编写自己的内存管理函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:33:17.510

lseek 可以在您读取任何内容之前告诉您文件的大小，因此您不需要 realloc() 循环。mmap() 可以将其带入内存，因此您也不需要 malloc()/free()。

# scala - Count rows with Slick 1.0.0

> ID：14836552
> 
> 赞同：8
> 
> 时间：2013-02-12T16:01:37.177
> 
> 标签：scala, slick

I'm trying to create a query with [Slick](http://slick.typesafe.com/) 1.0.0 that returns a row count equivalent to the following SQL statement:

```
SELECT COUNT(*) FROM table; 
```

What I have so far is:

```
val query = for {
  row <- Table
} yield row
println(query.length) 
```

This prints `scala.slick.ast.FunctionSymbol$$anon$1@6860991f`. Also, `query.length` appears to be of type `scala.slick.lifted.Column`. I cannot find a way to execute the query. All examples that I can find in the documentation and anywhere else do not operate on `Column` or are for [ScalaQuery](http://scalaquery.org/) and do not work anymore.

What can I do to execute this?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-15T19:30:46.807

虽然我无法检查生成的 sql，但您可以通过删除 .list 来获得更短的源代码：

```
Query(MyTable.length).first 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T18:32:05.747

这些中的任何一个都可以解决问题：

```
Query(MyTable).list.length 
```

或者

```
(for{mt <- MyTable} yield mt).list.length 
```

或者

```
(for{mt <- MyTable} yield mt.count).first 
```

**更新：**

打印 H2 数据库日志显示了最后一个查询，这看起来是最佳的：

```
 03:31:26.560 [main] DEBUG h2database - jdbc[2]
 /**/PreparedStatement prep10 = conn1.prepareStatement("select select count(1) from \"MYTABLE\" s5", 1003, 1007); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T16:25:41.340

利用：

```
val query = for(row <- Table) yield row 
println(Query(query.count).first) 
```

`count`相当于“SELECT COUNT(*) FROM Table” 。为了获得第一行也是唯一的行，您必须使用它`first`来获取计数。

# php - JSON 如果创建了新对象，则使用新对象更新列表

> ID：14836553
> 
> 赞同：0
> 
> 时间：2013-02-12T16:01:40.170
> 
> 标签：php, javascript, jquery, json

我不确定这是否可能。（我刚开始学习 JSON）。现在谈这个问题：

我正在开发一个带有评论等的网站和 android 应用程序，客户希望在网站上获得像 facebook 这样的即时通知。

我想要做的是在我的php文件中有一个块，其中ex：发布新评论，成功将评论添加到数据库，完成用户等的前端更新（全部完成），然后如果评论成功添加，将新对象插入带有注释和详细信息的 JSON 文档。

这样我就可以使用 ajax 不断地轮询 .JSON 文件而不是数据库（我认为这应该更快），当它看到更新时，它会使用新的更新更新列表。

我的问题是如何从 json 追加更新的对象，以及如果在那段时间内有 3 个更新，我如何打印出 3 个更新

非常感谢，我知道我没有代码，但我需要的基本上是如何在 JSON 中显示最新的对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:28:32.380

好吧，您需要跟踪哪些帖子对用户来说应该被视为“新”。但无论您的 json 数据结构如何，您始终可以通过执行以下操作来获取最后一个对象：

**你的 json 文件：**

```
[
    {
        "msg": "foo",
        "datestamp": 12345
    },
    {
        "msg": "bar",
        "datestamp": 12346
    }
] 
```

**javascript:**

```
$.ajax({
    url: 'yourjsonfile.json',
    dataType: 'json',
    success: function(data){

        var lastObject = data[data.length-1];
        alert(lastObject.msg);
    }
}); 
```

希望这会让你走上正轨。但正如我之前提到的，您需要拥有更高级的逻辑才能了解用户的“新”内容。

# cocoa - 如何保存/归档包含自定义对象的 NSMutableArray？

> ID：14836554
> 
> 赞同：2
> 
> 时间：2013-02-12T16:01:46.153
> 
> 标签：cocoa, nsmutablearray, nscoder

我有一个 NSMutableArray *recordsArray，键是 NSString，值是自定义对象：

```
@interface DictRecord : NSObject{
}
@property (nonatomic, retain) NSString* word; 
@property (nonatomic, retain)  NSString  *wordStatus; 
```

Cocoa：如何保存/归档包含自定义对象的 NSMutableArray

我想保存那个 NSMutable 数组，最好是非二进制（有点可读）格式。

我已通读文档并将编码方法添加到 DictRecord：

```
- (void) encodeWithCoder: (NSCoder *)coder
{
    [coder encodeObject: _word forKey:@"word" ];
    [coder encodeObject: _wordStatus forKey:@"wordStatus" ];
}
- (id) initWithCoder: (NSCoder *) coder
{
    self = [super init];
    if (self) {
        self.word = [coder decodeObjectForKey:@"word"];
        self.wordStatus = [coder decodeObjectForKey:@"wordStatus"];
} 
```

然后我尝试保存使用：

```
[recordsArray writeToFile:filePath atomically:YES]; 
```

保存了一个文件，但我可以看到它是空的。

谁能告诉我我省略了哪些步骤，或者我是否走错了路。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T16:14:53.647

这有点令人困惑，但是 NSCoding 和 NSArray 和 NSDictionary 属性列表方法是两个独立的东西。

你有两个选择：

1.  使用 NSCoding。这是[一个答案](https://stackoverflow.com/a/2226449/893113)，它显示了如何正确获取对数组内容调用的编码方法。
2.  使用`-[NSArray writeToFile:atomically:]`. 与其实现`-initWithCoder:`and `-decodeWithCoder`，不如创建自己的两个方法：`-dictionaryValue`and `-initWithDictionary:`。要编写，遍历模型对象数组，构建一个新的字典数组，然后调用`-writeToFile:atomically:`它。要读取，调用 NSArray 读取方法之一，获取其中包含的字典，然后调用`-initWithDictionary:`每个字典。

如果你想要一个人类可读的 plist，第二个选项是一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:15:50.200

-[NSArray writeToFile:atomically:] 文档状态

> 此方法在写出文件之前递归地验证所有包含的对象都是属性列表对象，如果所有对象都不是属性列表对象，则返回 NO

If you want to create a property list file and have the NSCoder stuff get called, you have to use NSKeyedArchiver/NSKeyedUnarchiver.

# jquery - jQuery动态创建和提交表单

> ID：14836557
> 
> 赞同：9
> 
> 时间：2013-02-12T16:01:51.030
> 
> 标签：jquery

我正在尝试通过代码创建和提交表单。下面有什么问题？

```
$('#btnPrintInvoicePerFile').on('click', function (event) {
    event.preventDefault(); //stop link default

    var componentInvoiceId = EberlsComponentInvoiceForm.componentInvoice.Id;
    console.log(componentInvoiceId);

    $('<form>', {
        "id": "getInvoiceImage",
        "html": '<input type="text" id="componentInvoicId" name="componentInvoicId" value="' + componentInvoiceId + '" />',
        "action": window.siteRoot + 'ComponentInvoice/GetInvoiceImage/'
    }).submit();

}); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-12T16:06:05.130

尝试先将表单附加到 body 元素：

```
$('<form>', {
    "id": "getInvoiceImage",
    "html": '<input type="text" id="componentInvoicId" name="componentInvoicId" value="' + componentInvoiceId + '" />',
    "action": window.siteRoot + 'ComponentInvoice/GetInvoiceImage/'
}).appendTo(document.body).submit(); 
```

# c++ - thread safety of MPI send using threads created with std::async

> ID：14836560
> 
> 赞同：21
> 
> 时间：2013-02-12T16:01:56.850
> 
> 标签：c++, multithreading, c++11, thread-safety, mpi

According to [this website](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Send.html), the usage of `MPI::COMM_WORLD.Send(...)` is thread safe. However in my application I often (not always) run into deadlocks or get segmentation faults. Enclosing each call of `MPI::COMM_WORLD` methods with a `mutex.lock()` and `mutex.unlock()` consistently removes deadlocks as well as segfaults.

This is how I create threads:

```
const auto communicator = std::make_shared<Communicator>();
std::vector<std::future<size_t>> handles;
for ( size_t i = 0; i < n; ++i )
{
   handles.push_back(std::async(std::launch::async, foo, communicator));
}
for ( size_t i = 0; i < n; ++i )
{
   handles[i].get();
} 
```

`Communicator` is a class which has a `std::mutex` member and exclusively calls methods such as `MPI::COMM_WORLD.Send()` and `MPI::COMM_WORLD.Recv()`. I do not use any other methods of sending/receiving with MPI. `foo` takes a `const std::shared_ptr<Commmunicator> &` as argument.

My question: Is the thread safety promised by MPI not compatible with threads created by `std::async`?

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-12T16:31:34.110

MPI 中的线程安全不是开箱即用的。首先，您必须确保您的实现实际上支持同时进行 MPI 调用的多个线程。对于某些 MPI 实现，例如 Open MPI，这需要在构建时使用特殊选项配置库。然后你必须告诉 MPI 在适当的线程支持级别进行初始化。目前 MPI 标准定义了四个级别的线程支持：

*   `MPI_THREAD_SINGLE`- 表示用户代码是单线程的。如果使用，这是初始化 MPI 的默认级别`MPI_Init()`；
*   `MPI_THREAD_FUNNELED`- 表示用户代码是多线程的，但只有主线程进行 MPI 调用。主线程是初始化 MPI 库的线程；
*   `MPI_THREAD_SERIALIZED`- 表示用户代码是多线程的，但对 MPI 库的调用是序列化的；
*   `MPI_THREAD_MULTIPLE`- 意味着用户代码是多线程的，所有线程都可以随时进行 MPI 调用，而无需任何同步。

为了使用线程支持初始化 MPI，必须使用`MPI_Init_thread()`而不是`MPI_Init()`：

```
int provided;

MPI_Init_thread(&argc, &argv, MPI_THREAD_MULTIPLE, &provided);
if (provided < MPI_THREAD_MULTIPLE)
{
    printf("ERROR: The MPI library does not have full thread support\n");
    MPI_Abort(MPI_COMM_WORLD, 1);
} 
```

**具有过时**（并从 MPI-3 中删除）C++ 绑定的等效代码：

```
int provided = MPI::Init_thread(argc, argv, MPI::THREAD_MULTIPLE);
if (provided < MPI::THREAD_MULTIPLE)
{
    printf("ERROR: The MPI library does not have full thread support\n");
    MPI::COMM_WORLD.Abort(1);
} 
```

线程支持级别的顺序如下：`MPI_THREAD_SINGLE`< `MPI_THREAD_FUNNELED`< `MPI_THREAD_SERIALIZED`< `MPI_THREAD_MULTIPLE`，因此任何其他提供的级别，不同于`MPI_THREAD_MULTIPLE`将具有较低的数值 - 这就是`if (...)`上面的代码如此编写的原因。

`MPI_Init(&argc, &argv)`相当于`MPI_Init_thread(&argc, &argv, MPI_THREAD_SINGLE, &provided)`。实现不需要精确地在请求的级别初始化——而是可以在任何其他级别（更高或更低）初始化，这在`provided`输出参数中返回。

有关更多信息 - 请参阅 MPI 标准的第 12.4 节，可[在此处](http://www.mpi-forum.org/docs/)免费获得。

对于大多数 MPI 实现，级别的线程支持`MPI_THREAD_SINGLE`实际上等同于级别提供的支持`MPI_THREAD_SERIALIZED`- 正是您在案例中观察到的。

由于您没有指定使用哪种 MPI 实现，这里有一个方便的列表。

我已经说过 Open MPI 必须在编译时启用正确的标志才能支持`MPI_THREAD_MULTIPLE`. 但是还有另一个问题——它的 InfiniBand 组件不是线程安全的，因此 Open MPI 在以全线程支持级别初始化时不会使用本机 InfiniBand 通信。

英特尔 MPI 有两种不同的风格 - 一种支持全多线程，另一种不支持全多线程。多线程支持是通过将`-mt_mpi`选项传递给 MPI 编译器包装器来启用的，该包装器启用与 MT 版本的链接。如果启用了 OpenMP 支持或自动并行器，则也隐含此选项。我不知道启用全线程支持时 IMPI 中的 InfiniBand 驱动程序如何工作。

MPICH(2) 不支持 InfiniBand，因此它是线程安全的，并且可能最近的版本提供`MPI_THREAD_MULTIPLE`了开箱即用的支持。

MVAPICH 是构建英特尔 MPI 的基础，它支持 InfiniBand。我不知道它在具有 InfiniBand 的机器上使用时在全线程支持级别上的表现如何。

关于多线程 InfiniBand 支持的说明很重要，因为现在许多计算集群都使用 InfiniBand 结构。禁用IB 组件（`openib`Open MPI 中的 BTL）后，大多数 MPI 实现会切换到另一种协议，例如 TCP/IP（`tcp`Open MPI 中的 BTL），这会导致通信速度更慢且延迟更大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:32:00.443

MPI 线程安全有四个级别，并非所有实现都支持：MPI_THREAD_SINGLE、MPI_THREAD_FUNNELED、MPI_THREAD_SERIALIZED 和 MPI_THREAD_MULTIPLE。最后一个，它允许一个进程有多个线程，可以同时调用 MPI 函数，可能是你感兴趣的那个。所以，首先，你需要确保你的实现支持 MPI_THREAD_SERIALIZED。

必须通过调用来指定所需的线程安全级别`MPI_Init_thread`。调用后，`MPI_Init_thread`您应该能够在自己创建的 boost (POSIX) 线程中安全地调用 MPI 函数。

# perl - 当使用比预期更多的参数调用子程序时，是否应该发出嘶哑的声音？

> ID：14836567
> 
> 赞同：4
> 
> 时间：2013-02-12T16:02:19.773
> 
> 标签：perl, error-handling, arguments, subroutine

当使用比预期更多的参数调用子程序时应该发出嘶哑的声音，还是应该简单地忽略额外的参数？

```
#!/usr/bin/env perl
use warnings;
use strict;

sub routine {
    my ( $a, $b ) = @_;
    return $a * $b;
}

my $reslult = routine( 4, 5, 6 ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T16:10:15.220

一般来说，我不会费心手动编写参数检查，但我认为正确的反应是呱呱叫。这样，您可以在不破坏现有调用者的情况下扩展该函数以稍后采用可选参数。

如果你的 Perl 足够新，你可以[`Function::Parameters`](https://metacpan.org/module/Function::Parameters)像这样安装和使用：

```
use warnings;
use strict;
use Function::Parameters qw(:strict);

fun routine($x, y) {
    return $x * $y;
}

my $result = routine(4, 5, 6);  # croaks automatically 
```

（顺便说一句，不要调用您的变量`$a`或`$b`：这些名称被使用[`sort`](http://perldoc.perl.org/functions/sort.html) 并免于`strict 'vars'`检查。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-12T16:21:14.297

这有点主观，即使在项目中也是如此。在某些情况下，过多的参数可能表明调用者存在真正的问题并且值得检查，特别是如果子例程是已发布库的一部分。另一方面，如果子程序是供内部使用的，忽略额外的参数可能会更方便。（例如，您希望它对数组中的第一个元素进行操作，但不必费心隔离该值而只需将整个数组都给它。）

考虑用例，以及这些额外的参数是否只是垃圾或可能暗示一个真正的问题，以及性能问题是什么应该可以帮助您决定是否值得。另一个考虑：子例程中的代码是否会自然捕获可能导致出现额外参数的错误。如果是这样，测试参数计数可能是多余的，并且可能不如稍后捕获的特定错误有用。

# sql - 在 WHERE 上使用布尔值进行 sql JOIN

> ID：14836568
> 
> 赞同：2
> 
> 时间：2013-02-12T16:02:20.710
> 
> 标签：sql, sqlite

首先，请注意我对 SQL（在本例中为 sqlite3）几乎没有经验，因此即使这个问题的标题也可能措辞不当。

假设我有一个笔记表 ( `n`)，以及这些笔记的关键字表 ( `k`)，最后是一个将一个或多个关键字与每个笔记相关联的表 ( `nk`)。我想做的是找到每个包含两个（或更多）关键字的注释。

更具体地说，下面（sqlite3）是我设置数据库的方式。

```
CREATE TABLE n(nid integer primary key autoincrement, content);
CREATE TABLE k(kid integer primary key autoincrement, content);
CREATE TABLE nk(nkid integer primary key autoincrement, nid, kid);
INSERT INTO n(content) VALUES ("note 1");
INSERT INTO n(content) VALUES ("note 2");
INSERT INTO k(content) VALUES ("keyword 1");
INSERT INTO k(content) VALUES ("keyword 2");
INSERT INTO nk(nid, kid) VALUES (1, 1);
INSERT INTO nk(nid, kid) VALUES (1, 2);
INSERT INTO nk(nid, kid) VALUES (2, 1); 
```

有了这个，我可以得到用关键字 ID 1 标记的笔记

```
select * from n LEFT JOIN nk ON nk.nid = n.nid WHERE nk.kid=1; 
```

我的问题是如何获取关键字 ID 为 1*和*2 的注释。我在网络上进行了一些搜索，但恐怕我的知识不足以想到好的搜索词。我希望这个网站上的人可以提供帮助，而且——重要的是——如果这是一个愚蠢的问题，我深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:03:36.433

如果您只想要包含两个以上关键字的笔记，请使用聚合：

```
select nid
from nk
group by nid
having count(*) >= 2 
```

如果关键字可以在列表中重复，请使用：

```
having count(distinct nk.kid) >= 2 
```

要使用关键字 1 和 2 获取注释，请使用：

```
having max(case when kid = 1 then 1 else 0 end) = 1 and
       max(case when kid = 2 then 1 else 0 end) = 1 
```

在这种情况下，`having`子句只是在看到其中一个值时创建一个标志。然后，该逻辑确定在给定音符的关键字集中是否已经看到该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:05:30.727

为了改进@GordonLinoff 的回答：

```
select * from n where nid IN 
 (select nid
  from (select * from nk where kid in (1,2)) s
  group by nid
  having count(distinct s.kid) = 2) 
```

`kid`即使`kid`可能存在其他值（3,4 等）， 这也会得到匹配 1 和 2 的记录。[sqlfiddle 在这里](http://sqlfiddle.com/#!5/5f381/2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:05:40.337

`select * from n LEFT JOIN nk ON nk.nid = n.nid WHERE nk.kid in (1,2)`

# eclipse - Tomcat 7 与 Vaadin、Hibernate、Eclipse 和 Maven 3

> ID：14836571
> 
> 赞同：2
> 
> 时间：2013-02-12T16:02:23.993
> 
> 标签：eclipse, hibernate, tomcat7, maven-3, vaadin

我正在尝试将 maven 集成到我现有的 Vaadin 项目中。有几个错误和奇怪的事情。首先，我不明白我应该怎么做才能使 maven 使用的 tomcat 实例在 eclipse 中可见。我的意思是，当我运行 tomcat7:run 时，在 eclipse 中预先配置的 Tomcat 实例保持停止。我也无法理解 maven 使用哪个 Tomcat 实例以及为什么它在项目文件夹中创建 Tomcat 配置文件，因为当我尝试在 tomcat7:run 之后在浏览器中打开应用程序时，我收到错误 404。
顺便说一下，有几个关于Vaadin 小部件的编译。我配置了 vaadin maven 插件和 gwt maven 插件。当我运行 mvn gwt:compile 时，似乎一切正常，但是当我尝试使用 eclipse 插件编译 Vaadin 小部件时，出现以下错误

```
Executing compiler with parameters [C:\Program Files\Java\jdk1.7.0_03\bin\java.exe, -Djava.awt.headless=true, -Xss8M, -Xmx512M, -XX:MaxPermSize=512M, -classpath, C:\Program Files\Java\jre7\lib\resources.jar;C:\Program Files\Java\jre7\lib\rt.jar;C:\Program Files\Java\jre7\lib\jsse.jar;C:\Program Files\Java\jre7\lib\jce.jar;C:\Program Files\Java\jre7\lib\charsets.jar;C:\Program Files\Java\jre7\lib\ext\dnsns.jar;C:\Program Files\Java\jre7\lib\ext\localedata.jar;C:\Program Files\Java\jre7\lib\ext\sunec.jar;C:\Program Files\Java\jre7\lib\ext\sunjce_provider.jar;C:\Program Files\Java\jre7\lib\ext\sunmscapi.jar;C:\Program Files\Java\jre7\lib\ext\zipfs.jar;C:/Popov/Ohta/src/main/java;C:/Popov/Ohta/src/test/java;C:/Popov/Ohta/target/classes;C:/Popov/Ohta/target/test-classes;C:/Popov/newEclipse/eclipse/configuration/com.vaadin.integration.eclipse/download/gwt-dev/2.3.0/gwt-dev.jar;C:/Users/popov/.m2/repository/com/google/gwt/gwt-user/2.1.1/gwt-user-2.1.1.jar;C:/Users/popov/.m2/repository/com/vaadin/vaadin/6.8.2/vaadin-6.8.2.jar;C:/Users/popov/.m2/repository/org/vaadin/addons/refresher/1.1.1/refresher-1.1.1.jar;C:/Users/popov/.m2/repository/org/vaadin/addons/vaadin-colorpicker/1.1.0/vaadin-colorpicker-1.1.0.jar;C:/Users/popov/.m2/repository/com/google/gwt/gwt-user/2.3.0/gwt-user-2.3.0.jar;C:/Users/popov/.m2/repository/com/vaadin/vaadin/6.8.8/vaadin-6.8.8.jar, -Dgwt.persistentunitcachedir=C:\Users\popov\AppData\Local\Temp\widgetset_com.ritmsoft.ohta.widgetset.OhtaWidgetset943bcbe5-0ae3-4759-b1c0-d878be4261f9, com.vaadin.tools.WidgetsetCompiler, -war, src/main/webapp/VAADIN/widgetsets, -deploy, C:\Users\popov\AppData\Local\Temp\widgetset_com.ritmsoft.ohta.widgetset.OhtaWidgetset943bcbe5-0ae3-4759-b1c0-d878be4261f9, -extra, C:\Users\popov\AppData\Local\Temp\widgetset_com.ritmsoft.ohta.widgetset.OhtaWidgetset943bcbe5-0ae3-4759-b1c0-d878be4261f9, -localWorkers, 2, -logLevel, INFO, com.ritmsoft.ohta.widgetset.OhtaWidgetset]
Updating GWT module description file...
фев 12, 2013 7:36:08 PM com.vaadin.terminal.gwt.widgetsetutils.ClassPathExplorer getAvailableWidgetSets
INFO: Widgetsets found from classpath:
    com.github.wolfie.refresher.RefresherApplicationWidgetset in jar:file:C:/Users/popov/.m2/repository/org/vaadin/addons/refresher/1.1.1/refresher-1.1.1.jar!/
    com.vaadin.terminal.gwt.DefaultWidgetSet in jar:file:C:/Users/popov/.m2/repository/com/vaadin/vaadin/6.8.8/vaadin-6.8.8.jar!/
    com.vaadin.addon.colorpicker.gwt.ColorPickerWidgetSet in jar:file:C:/Users/popov/.m2/repository/org/vaadin/addons/vaadin-colorpicker/1.1.0/vaadin-colorpicker-1.1.0.jar!/
    com.ritmsoft.ohta.widgetset.OhtaWidgetset in file://C/Popov/Ohta/src/main/java

фев 12, 2013 7:36:08 PM com.vaadin.terminal.gwt.widgetsetutils.ClassPathExplorer getAvailableWidgetSets
INFO: Search took 24ms
Done.
Starting GWT compiler
Unknown argument: -war
Google Web Toolkit 2.3.0
GWTCompiler [-logLevel level] [-workDir dir] [-gen dir] [-style style] [-ea] [-XdisableClassMetadata] [-XdisableCastChecking] [-validateOnly] [-draftCompile] [-optimize level] [-compileReport] [-strict] [-out dir] [-localWorkers count] module[s] 

where 
  -logLevel               The level of logging detail: ERROR, WARN, INFO, TRACE, DEBUG, SPAM, or ALL
  -workDir                The compiler's working directory for internal use (must be writeable; defaults to a system temp dir)
  -gen                    Debugging: causes normally-transient generated types to be saved in the specified directory
  -style                  Script output style: OBF[USCATED], PRETTY, or DETAILED (defaults to OBF)
  -ea                     Debugging: causes the compiled output to check assert statements
  -XdisableClassMetadata  EXPERIMENTAL: Disables some java.lang.Class methods (e.g. getName())
  -XdisableCastChecking   EXPERIMENTAL: Disables run-time checking of cast operations
  -validateOnly           Validate all source code, but do not compile
  -draftCompile           Enable faster, but less-optimized, compilations
  -optimize               Sets the optimization level used by the compiler.  0=none 9=maximum.
  -compileReport          Create a compile report that tells the Story of Your Compile
  -strict                 Only succeed if no input files have errors
  -out                    The directory to write output files into (defaults to current)
  -localWorkers           The number of local workers to use when compiling permutations
and 
  module[s]               Specifies the name(s) of the module(s) to compile
Widgetset compilation failed 
```

否则，如果我使用 mvn gwt:compile 编译小部件，然后使用 maven 构建战争并部署它，我会在浏览器中收到空白页面。

此外，当我尝试在服务器上运行应用程序时，我有以下异常

```
WARNING: [SetContextPropertiesRule]{Context} Setting property 'source' to 'org.eclipse.jst.j2ee.server:Ohta' did not find a matching property.
фев 12, 2013 7:55:08 PM org.apache.catalina.core.ContainerBase addChildInternal
SEVERE: ContainerBase.addChild: start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/Ohta]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:657)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1637)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NoClassDefFoundError: org/hibernate/HibernateException
    at java.lang.Class.getDeclaredFields0(Native Method)
    at java.lang.Class.privateGetDeclaredFields(Unknown Source)
    at java.lang.Class.getDeclaredFields(Unknown Source)
    at org.apache.catalina.util.Introspection.getDeclaredFields(Introspection.java:106)
    at org.apache.catalina.startup.WebAnnotationSet.loadFieldsAnnotation(WebAnnotationSet.java:261)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationServletAnnotations(WebAnnotationSet.java:140)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationAnnotations(WebAnnotationSet.java:67)
    at org.apache.catalina.startup.ContextConfig.applicationAnnotationsConfig(ContextConfig.java:405)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5179)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 11 more
Caused by: java.lang.ClassNotFoundException: org.hibernate.HibernateException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    ... 25 more

фев 12, 2013 7:55:08 PM org.apache.catalina.startup.HostConfig deployDescriptor
SEVERE: Error deploying configuration descriptor C:\Popov\Soft\conf\Catalina\localhost\Ohta.xml
java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/Ohta]]
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:904)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:657)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1637)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

有我的 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.ritmsoft</groupId>
    <artifactId>Ohta</artifactId>
    <version>1.0</version>
    <packaging>war</packaging>

    <name>Ohta</name>
    <url>http://maven.apache.org</url>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <build>
        <sourceDirectory>src/main/java</sourceDirectory>
        <resources>
            <resource>
                <directory>src/main/java</directory>
                <excludes>
                    <exclude>**/*.java</exclude>
                </excludes>
            </resource>
        </resources>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.5.1</version>
                <configuration>
                    <source>1.7</source>
                    <target>1.7</target>
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-deploy-plugin</artifactId>
                <version>2.7</version>

            </plugin>
            <plugin>
                <groupId>org.apache.tomcat.maven</groupId>
                <artifactId>tomcat7-maven-plugin</artifactId>
                <version>2.0</version>
                <executions>
                    <execution></execution>
                </executions>
                <configuration>
                    <url>http://127.0.0.1:8080/manager/text</url>
                    <server>local_tomcat</server>
                    <path>/Ohta</path>
                    <username>tomcat</username>
                    <port>8080</port>
                    <username>tomcat</username>
                    <password>s3cret</password>
                    <warFile> ${project.build.directory}/Ohta.war</warFile>
                </configuration>
            </plugin>
            <plugin>
                <groupId>com.vaadin</groupId>
                <artifactId>vaadin-maven-plugin</artifactId>
                <version>1.0.2</version>
                <executions>
                    <execution>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>update-widgetset</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>gwt-maven-plugin</artifactId>
                <version>2.3.0</version>
                <configuration>
                    <webappDirectory>${basedir}/src/main/webapp/VAADIN/widgetsets/</webappDirectory>
                    <extraJvmArgs>-Xmx512M -Xss1024k </extraJvmArgs>
                    <deploy>${project.build.directory}/gwt-tmp/</deploy>
                    <soyc>false</soyc>
                    <force>true</force>
                    <strict>true</strict>
                    <style>OBFUSCATED</style>
                    <optimizationLevel>9</optimizationLevel>
                </configuration>
                <executions>
                    <execution>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>resources</goal>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <webXml>webContent\WEB-INF\web.xml</webXml>
                    <warName>Ohta</warName>

                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <version>2.5</version>
                <configuration>
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-eclipse-plugin</artifactId>
                <version>2.9</version>
                <inherited>true</inherited>
                <configuration>
                    <classpathContainers>
                        <classpathContainer>org.eclipse.jdt.launching.JRE_CONTAINER</classpathContainer>
                        <classpathContainer>rg.eclipse.jst.server.core.container/org.eclipse.jst.server.tomcat.runtimeTarget/Apache
                            Tomcat v7.0</classpathContainer>
                    </classpathContainers>
                </configuration>
            </plugin>

        </plugins>

        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.eclipse.m2e</groupId>
                    <artifactId>lifecycle-mapping</artifactId>
                    <version>1.0.0</version>
                    <configuration>
                        <lifecycleMappingMetadata>
                            <pluginExecutions>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>com.vaadin</groupId>
                                        <artifactId>
                                            vaadin-maven-plugin
                                        </artifactId>
                                        <versionRange>
                                            [1.0.2,)
                                        </versionRange>
                                        <goals>
                                            <goal>update-widgetset</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore></ignore>
                                    </action>
                                </pluginExecution>
                            </pluginExecutions>
                        </lifecycleMappingMetadata>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
    <pluginRepositories>
        <pluginRepository>
            <id>codehaus-snapshots</id>
            <url>http://nexus.codehaus.org/snapshots</url>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
            <releases>
                <enabled>false</enabled>
            </releases>
        </pluginRepository>
    </pluginRepositories>
    <repositories>
        <repository>
            <id>vaadin-addons</id>
            <url>http://maven.vaadin.com/vaadin-addons</url>
        </repository>
        <repository>
            <id>jboss-public-repository-group</id>
            <name>JBoss Public Repository Group</name>
            <url>http://repository.jboss.org/nexus/content/groups/public/</url>
            <layout>default</layout>
            <releases>
                <enabled>true</enabled>
                <updatePolicy>always</updatePolicy>
            </releases>
            <snapshots>
                <enabled>true</enabled>
                <updatePolicy>always</updatePolicy>
            </snapshots>
        </repository>
    </repositories>
    <dependencies>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.1.9.Final</version>
        </dependency>
        <dependency>
            <groupId>com.vaadin</groupId>
            <artifactId>vaadin</artifactId>
            <version>6.8.8</version>
        </dependency>
        <dependency>
            <groupId>org.vaadin.addons</groupId>
            <artifactId>vaadin-colorpicker</artifactId>
            <version>1.1.0</version>
        </dependency>
        <dependency>
            <groupId>org.vaadin.addons</groupId>
            <artifactId>refresher</artifactId>
            <version>1.1.1</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>3.0.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <version>3.1</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>1.6.4</version>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>com.mchange</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.2-pre7</version>
        </dependency>
        <dependency>
            <groupId>org.glassfish.metro</groupId>
            <artifactId>webservices-rt</artifactId>
            <version>2.2</version>
        </dependency>
        <dependency>
            <groupId>com.google.gwt</groupId>
            <artifactId>gwt-user</artifactId>
            <version>2.3.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.22</version>
        </dependency>
    </dependencies>
</project> 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T15:09:29.817

正确的语法是

```
mvn tomcat7:run-war 
```

maven 的参数中不能有空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-19T15:02:31.033

另请参阅我在[https://stackoverflow.com/a/25386703/1465758上的回答](https://stackoverflow.com/a/25386703/1465758)

可能你必须在 Maven 中添加罐子。

# jquery - Multiple Tab Groups on a page - CSS/jQuery

> ID：14836573
> 
> 赞同：1
> 
> 时间：2013-02-12T16:02:34.510
> 
> 标签：jquery, tabs, jquery-tabs

I know this topic has been asked before but looking through the posts isn't quite what I'm looking for so please bear with me for a minute.

first here's my little jQuery (works flawlessly)

```
$(document).ready(function(){
    $(".tabs li").click(function() {
        $(".tab-content").hide();
        var selected_tab = $(this).find("a").attr("href");
        $(selected_tab).fadeIn();
        $(".tabs li").removeClass('current');
        $(this).addClass("current");
        return false;
    });
}); 
```

And my basic HTML

```
<ul class="tabs">
    <li class="active"><a href="#tab4">Tab 4</a></li>
    <li><a href="#tab5"><div class="alert-icon">Tab 5</div></a></li>
    <li><a href="#tab6"><div class="printer-icon">Tab 6</div></a></li>
</ul>

 <div id="tab4" class="tab-content">Tab 4</div>
 <div id="tab5" class="tab-content">Tab 5 </div>
 <div id="tab6" class="tab-content">Tab 6 </div> 
```

Naturally if I put more than 1 tab section on the page, every time a tab is clicked the content of all tabs will "hide" and I need to make each tabbed section behave independently.

My problem is I want to avoid going the ID route, ideally I can put the JS right into the template and every time someone needs a tabbed area they can just paste the HTML, maybe add an ID to the UL and fill in the blanks.

Tabs and their content will be put in by other not very tetchy people so if I can avoid having them use JS, life would be wonderful!

I thought about playing with filters, string replaces, child elements (put the divs in the LIs?) etc. but before diving into an unfamiliar ocean without my ducky float I thought one of the pros here can give me a hint and point me in the right direction. js/jQuery was never my favorite ^^.

Thanks a lot!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:27:36.060

这应该可以解决问题：http: [//jsfiddle.net/BLGUW/](http://jsfiddle.net/BLGUW/)

HTML：

```
<div class="tabs">
        <ul>
            <li class="active"><a href="#tab4">Tab 4</a></li>
        <li><a href="#tab5"><div class="alert-icon">Tab 5</div></a></li>
        <li><a href="#tab6"><div class="printer-icon">Tab 6</div></a></li>
    </ul>
    <div id="tab4" class="tab-content">Tab 4</div>
    <div id="tab5" class="tab-content">Tab 5 </div>
    <div id="tab6" class="tab-content">Tab 6 </div>
</div>

<div class="tabs">
    <ul>
    <li class="active"><a href="#tab40">Tab 4</a></li>
    <li><a href="#tab50"><div class="alert-icon">Tab 5</div></a></li>
    <li><a href="#tab60"><div class="printer-icon">Tab 6</div></a></li>
    </ul>
    <div id="tab40" class="tab-content">Tab 4</div>
    <div id="tab50" class="tab-content">Tab 5 </div>
    <div id="tab60" class="tab-content">Tab 6 </div>
</div> 
```

JS

```
$(document).ready(function(){
    $(".tabs li").click(function() {
        $(this).parent().parent().find(".tab-content").hide();
        var selected_tab = $(this).find("a").attr("href");
        $(selected_tab).fadeIn();
        $(this).parent().find("li").removeClass('current');
        $(this).addClass("current");
        return false;
    });
}); 
```

我确信这可以优化；）

# algorithm - Find relevant words according to a given subject

> ID：14836575
> 
> 赞同：1
> 
> 时间：2013-02-12T16:02:39.407
> 
> 标签：algorithm, web-services, search

Is there an algorithm, webservice or technique which is able to search through a list of words, returning these that fit a given subject?

**Practical example:**
There is a Software which allows me to create a task and select an icon for it. There are hundreds of icons, >95% of them do not fit the given task.

My idea now is to tag these icons:
An icon with a letter would get the tags `mail`, `communication`, `message`, ...

The user then adds a task which is called `Write email`. The algorithm searches the icons and their tags and returns a list of presumably fitting icons (Perhaps the 20 most fitting icons). The user then can select from this list.

I think this could be useful in different areas. In a time where google is able to predict what the user wants to search for it must be possible in any way.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:20:12.677

可能不是最好的解决方案，但试一试。

如果输入中与图标匹配的术语有限，请考虑根据图标标签对术语进行倒排索引。

说，

```
mail -> mailicon
email -> mailicon 
```

在类似的行上，将单个术语的字典放在图标标签上。

```
mail -> mailicon
message -> chaticon
communication ->lanicon 
```

当“写一封电子邮件”这个词来自用户时，你可以使用[SynExpand](http://lucene.apache.org/core/old_versioned_docs/versions/2_9_1/api/all/org/apache/lucene/wordnet/SynExpand.html)之类的东西将这个词分解为同义词，并在整个地图中查找可能的图标。

比如说，电子邮件被分解为邮件、消息、通信等，你会得到三个图标的建议。

我相信您应该能够根据需要使用同义词值。

另请参阅[全文搜索](https://stackoverflow.com/questions/7053508/lucene-synonym-expansion-stemming-spell-check-and-more)

# python - Change variable value from an input in Python

> ID：14836576
> 
> 赞同：1
> 
> 时间：2013-02-12T16:02:39.710
> 
> 标签：python, variables, input

I'm wondering how to change a variable from a user input.. For example

```
new = raw_input("enter a new variable for x:")
x = new 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:06:15.757

在我看来，你正在做的事情似乎会奏效，尽管它可以被简化。

```
x=raw_input("New value for x: ") 
```

应该改变`x`输入的值。

# vb.net - Column Width Animating XAML

> ID：14836578
> 
> 赞同：0
> 
> 时间：2013-02-12T16:02:49.580
> 
> 标签：vb.net, xaml

I have a three column grid with the following contents:

Column 1: Child Grid (Width: Specific)

Column 2: TextBox (Width: Auto)

Column 3: Child Grid (Width: Auto)

I was wondering, in pure XAML and with no behindcode, if it is possible to animate the third column to "grow" and the second column to "shrink" to fit it.

If behindcode is required for this, is there any chance someone could point me in the way of a VB method?

I have tried all the doubleanimations I can think of, and I have looked for a way of shrinking the textbox relative to its current width, which would might solve the problem, to no avail.

Thanks in Advance,

Freddy.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:13:47.527

列宽被定义为`GridLength`not `double`，这就是为什么你不会得到你正在寻找的任何`DoubleAnimation`变体的结果。没有内置的实现，但制作 a`GridLengthAnimation`并不难，并且有很多示例（尽管我不知道 VB 中的一个）。

这是一个例子： http: [//marlongrech.wordpress.com/2007/08/20/gridlength-animation/](http://marlongrech.wordpress.com/2007/08/20/gridlength-animation/)

大多数代码都是样板文件，应该很容易让您自己在 VB 中编写，并且重要的部分（即`GetCurrentValueCore`）应该以非常小的更改进行翻译。

# javascript - 无法在后台页面和内容页面之间建立连接

> ID：14836584
> 
> 赞同：-1
> 
> 时间：2013-02-12T16:02:54.517
> 
> 标签：javascript, html, events, dom, google-chrome-extension

我正在编写 chrome 扩展程序，并且正在尝试在背景页面和内容页面之间发送消息。

问题是连接从未建立。我什至从谷歌文档中复制了代码，但无济于事。

**这是我的清单页面**

```
{
  "name": "x",
  "description": "x",
  "version": "0.1",
  "permissions": ["contextMenus", "tabs", "notifications"],
   "content_scripts": [
    {
      "matches": ["http://*/*","https://*/*"],
      "js": ["jquery.js", "content_script.js"]
    }
  ],
  "background": {
    "scripts": ["sample.js"]
  },
  "manifest_version": 2
} 
```

**我的后台页面**

```
function genericOnClick(info, tab) 
{
       //copy pasted from google tutorials. My own code also didn't work
       chrome.tabs.getSelected(null, function(tab) {
  chrome.tabs.sendMessage(tab.id, {greeting: "hello"}, function(response) {
    console.log(response.farewell);
  });
});

}

// Create a parent item and two children.
var parent1 = chrome.contextMenus.create({"title": "Rank Trigger", "contexts":["all"]});

var child1 = chrome.contextMenus.create
(
    {"title": "Rank 1", "contexts":["all"], "parentId": parent1, "onclick": genericOnClick}
);
var child2 = chrome.contextMenus.create
(
    {"title": "Rank 2", "contexts":["all"], "parentId": parent1, "onclick": genericOnClick}
);
var child2 = chrome.contextMenus.create
(
    {"title": "Rank 3", "contexts":["all"], "parentId": parent1, "onclick": genericOnClick}
); 
```

**内容脚本：**

```
//copied from google tutorials
chrome.extension.onMessage.addListener(
  function(request, sender, sendResponse) {
    console.log(sender.tab ?
                "from a content script:" + sender.tab.url :
                "from the extension");
    if (request.greeting == "hello")
      sendResponse({farewell: "goodbye"});
  }); 
```

请问有什么想法吗？也许因为事件是从上下文菜单触发的，但我不太确定。我是 JS 和 chrome 扩展编程的新手。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:05:15.810

在元素上设置一个`onclick`处理程序，然后使用它`event.currentTarget.outerHTML`来获取单击元素的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T10:59:22.497

事实证明我的代码按预期工作，并且确实在每个 onClick 上都发送了消息。问题是我在没有注入 contentScript 的错误页面上测试它。

我犯了愚蠢的错误……谢谢大家的帮助

# android - Sony SmartWatch - 什么是主机应用程序 (AHA)

> ID：14836591
> 
> 赞同：0
> 
> 时间：2013-02-12T16:03:26.450
> 
> 标签：android, sony, accessory, sony-smartwatch

我想扩展一个应用程序以在使用控制 API 的情况下与索尼智能手表进行通信。我是为索尼智能手表开发扩展的新手，但我不明白 AHA 是什么以及它的位置？？？我必须自己实施什么？我需要实施 AEA 和 AHA 吗？

在我看来，AHA 是应该扩展为与智能手表通信/工作的应用程序（如果可用）。

我需要什么才能让我的应用程序与索尼智能手表一起工作（SDK 和 LiveWareManager 已经在运行）？？？

编辑：为了使用扩展程序或启动扩展程序，我必须在我的普通旧 android 应用程序上修改/添加什么？我已经在我的 android 手机上安装了来自 sdk 的样本之一，现在想与它交谈？！？;-)

在此先感谢您的帮助！！！;-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:25:00.027

AHA 特定于特定的 Smart 配件型号，应由配件制造商 (Sony) 提供。作为第 3 方开发人员，您可以使用 SmartExtensions API（与 AHA 通信）和 Android API 来创建 AEA。

您可以在 SmartExtensions SDK 的 Code_examples 文件夹中找到一些示例和简短教程。

# java - 先前分配的对象的垃圾收集

> ID：14836598
> 
> 赞同：0
> 
> 时间：2013-02-12T16:03:54.203
> 
> 标签：java, garbage-collection

考虑以下场景：

```
String dude = "Harold";

//some stuff

dude = "Kumar"; 
```

一旦`dude`被赋予其第二个值“Kumar”，一个与“Harold”分离的全新对象就出现了。我想知道的是，既然“Harold”显然不再有用了，它是立即收集垃圾还是在JVM认为合适的某个时间收集垃圾？

**更新：**

仅仅因为`dude`已设置为新值（对象）并不一定意味着对旧对象的所有引用都已被消除。如果另一个引用`dude`在“Harold”之后和“Kumar”之前调用，它显然会保留“Harold”对象：

```
String dude = "Harold";

//some stuff

String interim = dude;

dude = "Kumar";

System.out.println("dude = " + dude);
System.out.println("interim = " + interim); 
```

印刷

```
dude = Kumar
interim = Harold 
```

因此，考虑因素比我最初设想的要多，因此初始值不一定非要在更改后超出范围。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T16:06:58.943

没有任何东西可以立即进行垃圾收集，并且不鼓励尝试强制垃圾收集（并且随着每个 java 版本的发布变得越来越困难）。
是的，一旦“Harold”不再可达（没有指向它的指针链），它就有资格进行垃圾收集并且可能被收集（如果 GC 曾经运行过）。话虽如此，字符串可以分配在 const 池中，该池位于 perm gen 中并且不是 GC'ed*（至少在 java 7 之前）。此处有关实习字符串的更多信息：http: [//www.codeinstructions.com/2009/01/busting-javalangstringintern-myths.html](http://www.codeinstructions.com/2009/01/busting-javalangstringintern-myths.html)

* - 不完全准确，即使它在 perm gen 中，const 池也是 GC'ed。情况很复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:52:24.043

> 因为显然“Harold”不再有用了

你是怎么得出这个结论的？仅通过查看您引用的单个类？但是根据[Java Language Specification](http://docs.oracle.com/javase/specs/jls/se7/html/index.html)，在以下情况下会重用字符串文字

*   同一包中同一类中的文字字符串表示对同一 String 对象的引用。
*   同一包中不同类中的文字字符串表示对同一 String 对象的引用。
*   不同包中不同类中的文字字符串同样表示对同一 String 对象的引用。
*   由常量表达式计算的字符串在编译时计算，然后将它们视为文字。
*   在运行时通过连接计算的字符串是新创建的，因此是不同的。
*   显式实习计算字符串的结果是与任何具有相同内容的预先存在的文字字符串相同的字符串。

因此，除非您确定以上所有内容都不正确，否则您可能无法指望它甚至有资格进行垃圾收集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T16:07:29.453

通常垃圾收集不会立即发生。此外，字符串是不可变的，并且保存在一个全局表中（据我所知，大多数 JVM），所以它可能永远不会被收集。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-12T16:12:15.130

这个：“在以后的某个时间，当 JVM 认为它合适时”。垃圾收集会消耗 CPU 并可能意味着暂停线程。GC 是极其复杂的东西，它不断地平衡 CPU 和内存的使用。

正如其他人所说，字符串更复杂，但我假设您只是想一般地了解 java 对象。我不认为所有关于 String 的华夫饼与您的问题真正相关，并且使这个问题比它需要的复杂得多！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T16:14:09.603

让我们忘记，该常量`String`可能会以不同的方式处理。对象没有立即被垃圾回收的主要原因是可能有其他对它的引用。例如，如果您的“某些东西”包含如下语句

```
t = dude; 
```

当您为 分配新值时，该对象并非不可访问`dude`。找出所有参考是相当昂贵的，因此只在必要时进行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-12T16:19:39.830

虽然 Java 规范的几乎所有当前实现都使用跟踪垃圾收集器，但我不认为规范要求使用跟踪 GC 管理堆。

可以想象 GC 实现包含引用计数。在上述情况的变体中（旨在避免 const 池细节）：

```
String dude = new String("Harold");
//
dude = new String("Kumar"); 
```

的 ref 计数引用的原始对象`dude`变为零，并且*可以*立即被垃圾回收。

净点是——对于Java，没有保证，但通常你不必担心。

此外，还有一篇[关于 Java GC 的旧参考](http://www.ibm.com/developerworks/library/j-jtp10283/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-12T16:06:46.540

`String`是`immutable`。当您重新分配变量时，`dude = "Kumar"`较旧的字符串对象会超出范围。

当垃圾收集器开始工作时，它收集了那个对象。

# amazon-web-services - 按日期查询 DynamoDB

> ID：14836600
> 
> 赞同：134
> 
> 时间：2013-02-12T16:04:01.420
> 
> 标签：amazon-web-services, nosql, amazon-dynamodb

我来自关系数据库背景并尝试使用亚马逊的 DynamoDB

我有一个带有哈希键“DataID”和一个范围“CreatedAt”的表以及其中的一堆项目。

我正在尝试获取在特定日期之后创建并按日期排序的所有项目，这在关系数据库中非常简单。

在 DynamoDB 中，我能找到的最接近的东西是查询并使用大于过滤器的范围键。唯一的问题是，要执行查询，我需要一个无法达到目的的哈希键。

那么我做错了什么？我的表模式是否错误，哈希键不应该是唯一的吗？还是有其他查询方式？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2016-08-05T13:09:55.607

鉴于您当前的表结构，这在 DynamoDB 中目前是不可能的。巨大的挑战是要理解表（分区）的哈希键应该被视为创建单独的表。在某些方面，这确实很强大（将分区键视为为每个用户或客户创建一个新表，等等......）。

查询只能在单个分区中完成。这真的是故事的结局。这意味着如果您想按日期查询（您将希望使用自纪元以来的毫秒），那么您要在单个查询中检索的所有项目都必须具有相同的哈希（分区键）。

我应该限定这个。您绝对可以`scan`按照您正在寻找的标准，这没问题，但这意味着您将查看表中的每一行，然后检查该行是否具有与您的参数匹配的日期。这真的很昂贵，特别是如果您首先要按日期存储事件（即您有很多行）。

您可能很想将所有数据放在一个分区中来解决问题，而且您绝对可以，但是您的吞吐量会非常低，因为每个分区只接收总设置量的一小部分。

最好的办法是确定要创建的更有用的分区来保存数据：

*   您真的需要查看所有行，还是仅查看特定用户的行？

*   可以先按月缩小列表范围，然后进行多个查询（每个月一个）吗？还是按年份？

*   如果您正在执行时间序列分析，有几个选项，将分区键更改为计算上的内容`PUT`以使其`query`更容易，或者使用其他 aws 产品（如 kinesis），它适用于仅附加日志记录。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-02-12T17:18:08.180

更新答案：

DynamoDB 允许指定二级索引以帮助进行此类查询。二级索引可以是全局的，即索引跨越散列键跨越整个表，也可以是局部的，即索引将存在于每个散列键分区中，因此在进行查询时也需要指定散列键。

对于此问题中的用例，您可能希望在“CreatedAt”字段上使用全局二级索引。

有关 DynamoDB 二级索引的更多信息，[请参阅二级索引文档](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SecondaryIndexes.html)

原答案：

DynamoDB 不允许仅对范围键进行索引查找。需要哈希键，以便服务知道要查找哪个分区来查找数据。

您当然可以执行扫描操作以按日期值进行过滤，但这需要全表扫描，因此并不理想。

如果您需要跨多个主键按时间对记录执行索引查找，DynamoDB 可能不是您使用的理想服务，或者您可能需要使用单独的表（在 DynamoDB 中或关系存储中）来存储项目您可以对其执行索引查找的元数据。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2015-09-26T01:06:13.117

我用来解决这个问题的方法是创建一个全局二级索引，如下所示。不确定这是否是最好的方法，但希望它对某人有用。

```
Hash Key                 | Range Key
------------------------------------
Date value of CreatedAt  | CreatedAt 
```

限制 HTTP API 用户指定检索数据的天数，默认为 24​​ 小时。

这样，我总是可以将 HashKey 指定为当前日期，并且 RangeKey 可以在检索时使用 > 和 < 运算符。这样，数据也分布在多个分片中。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-07-02T18:53:34.437

您的哈希键（主要排序）必须是唯一的（除非您有其他人所说的范围）。

在您的情况下，要查询您的表，您应该有一个二级索引。

```
|  ID  | DataID | Created | Data |
|------+--------+---------+------|
| hash | xxxxx  | 1234567 | blah | 
```

您的哈希键是 ID 您的二级索引定义为：DataID-Created-index（这是 DynamoDB 将使用的名称）

然后，您可以进行如下查询：

```
var params = {
    TableName: "Table",
    IndexName: "DataID-Created-index",
    KeyConditionExpression: "DataID = :v_ID AND Created > :v_created",
    ExpressionAttributeValues: {":v_ID": {S: "some_id"},
                                ":v_created": {N: "timestamp"}
    },
    ProjectionExpression: "ID, DataID, Created, Data"
};

ddb.query(params, function(err, data) {
    if (err) 
        console.log(err);
    else {
        data.Items.sort(function(a, b) {
            return parseFloat(a.Created.N) - parseFloat(b.Created.N);
        });
        // More code here
    }
}); 
```

基本上你的查询看起来像：

```
SELECT * FROM TABLE WHERE DataID = "some_id" AND Created > timestamp; 
```

二级索引将增加所需的读/写容量单位，因此您需要考虑这一点。它仍然比进行扫描要好得多，这在读取和时间上都将是昂贵的（我相信仅限于 100 个项目）。

这可能不是最好的方法，但对于习惯于 RD（我也习惯于 SQL）的人来说，这是获得生产力的最快方法。由于在模式方面没有任何限制，因此您可以制作一些可行的东西，一旦您有足够的带宽以最有效的方式工作，您就可以改变它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-12T18:32:24.457

您可以按照“产品类别”ID 的方式制作哈希键，然后将范围键作为时间戳与末尾附加的唯一 ID 的组合。这样你就知道哈希键并且仍然可以查询大于的日期。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-13T22:38:41.300

您可以拥有多个相同的哈希键；但前提是您有一个变化的范围键。把它想象成文件格式；您可以在同一个文件夹中拥有 2 个同名文件，只要它们的格式不同。如果它们的格式相同，则它们的名称必须不同。相同的概念适用于 DynamoDB 的哈希/范围键；只需将哈希视为名称，将范围视为格式。

另外，我不记得他们在 OP 时是否有这些（我不相信他们有），但他们现在提供本地二级索引。

我对这些的理解是，它现在应该允许您执行所需的查询而无需进行全面扫描。缺点是必须在创建表时指定这些索引，并且（我相信）在创建项目时不能为空。此外，它们需要额外的吞吐量（尽管通常不如扫描那么多）和存储，因此对于某些人来说，这不是一个完美的解决方案，而是一个可行的替代方案。

不过，我仍然推荐 Mike Brant 的回答作为使用 DynamoDB 的首选方法；并自己使用该方法。就我而言，我只有一个只有哈希键作为我的 ID 的中央表，然后是具有可以查询的哈希和范围的辅助表，然后项目将代码指向中央表的“感兴趣的项目”，直接.

[感兴趣的人可以在此处](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LSI.html)的 Amazon DynamoDB 文档中找到有关二级索引的其他数据。

无论如何，希望这将有助于在此线程上发生的其他任何人。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-04-15T16:31:54.387

**工作查询** 1.aws dynamodb scan --table-name tableName --region us-east-1 --filter-expression "begins_with(createdTm,:gen)" --expression-attribute-values "{ ​":gen":{​​​​​​​"S":"2021-04-15"}​​​​​​​}​​​​​​​​'--select "COUNT "

2.aws dynamodb 扫描 --table-name tableName --region us-east-1 --filter-expression "createdTm BETWEEN :v1 AND :v2" --expression-attribute-values '{":v1":{"S ":"2021-04-13"}, ":v2":{"S":"2021-04-14"}}' --选择 "COUNT"

* * *

## 回答 #8

> 赞同：-10
> 
> 时间：2014-02-14T18:02:26.013

**更新的答案** 使用具有可预测吞吐量的 Dynamo DB 查询没有方便的方法来执行此操作。一个（次优）选项是使用带有人工 HashKey 和 CreatedAt 的 GSI。然后单独通过 HashKey 查询并提到 ScanIndexForward 对结果进行排序。如果你能想出一个自然的 HashKey（比如项目的类别等），那么这个方法就是赢家。另一方面，如果您为所有项目保留相同的 HashKey，那么当您的数据集增长超过 10GB（一个分区）时，它将主要影响吞吐量

**原始答案：** 您现在可以使用 GSI 在 DynamoDB 中执行此操作。将“CreatedAt”字段设为 GSI 并发出类似 (GT some_date) 的查询。对于此类查询，将日期存储为数字（自纪元以来的毫秒数）。

此处提供详细信息：全球二级索引 - Amazon DynamoDB：[http ://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GSI.html#GSI.Using](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GSI.html#GSI.Using)

这是一个非常强大的功能。请注意，查询仅限于 (EQ | LE | LT | GE | GT | BEGINS_WITH | BETWEEN) 条件 - Amazon DynamoDB：[http ://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Condition.html](http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Condition.html)

# magento - Magento 覆盖模块中的核心文件

> ID：14836602
> 
> 赞同：1
> 
> 时间：2013-02-12T16:04:07.837
> 
> 标签：magento

我通过将核心 Varien 文件移动到 /local/ 命名空间并在那里进行编辑来覆盖它。我有一个模块，它取决于正在修改的文件。如果 Varien 文件在 /local/Varien 中，而我的模块在 /local/module_name 中，我该如何打包模块，包括修改后的 Varien 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T09:21:02.263

您应该尝试使用基于 XML 的覆盖，其语法如下：

```
<blocks>    
    <enterprise_giftregistry>
        <rewrite>
            <customer_list>MyNamespace_MyModule_Block_MyBlock</customer_list>
        </rewrite>
    </enterprise_giftregistry>
</blocks> 
```

例如，此页面上有更多信息，或者通过谷歌搜索“xml重写覆盖”：

[http://www.magentocommerce.com/wiki/5__-_modules_and_development/0__-_module_development_in_magento/how_to_overload_a_controller](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/how_to_overload_a_controller)

# php - 将 PHP 数组的字符串转换为 javascript 对象

> ID：14836603
> 
> 赞同：0
> 
> 时间：2013-02-12T16:04:09.210
> 
> 标签：php, javascript, arrays, json, javascript-objects

我有一个将javascript对象编码成这样的代码：

```
<script>
    var php_string='array("one"=>"value_one","two"=>"value_two")';
</script> 
```

现在我想知道如何将其转换为：

```
{
    "one":"value_one",
    "two":"value_two"
} 
```

的内容通过变量`php_string`发送到 PHP 。`$_POST`有没有办法做到这一点，或者我应该使用 JSON 来代替？

**编辑**

如所问，这是使我的代码`php_string`：

```
function encodeFormOptions(inputsWrapper){
    var the_serialize=$(inputsWrapper).find(":input").serializeArray();
    var text="array(";
    $.each( the_serialize, function( key, value ) {
        text+='"'+value["name"]+'"=>'+'"'+value["value"]+'",';
    });
    if (text.charAt(text.length-1)==",")
        text=text.substring(0,text.length-1);
    text+=");";
    return text;
} 
```

**编辑 2**

我忘了说我需要在纯 Javascript 中进行这种转换。换句话说，我需要将数组字符串解析为 javascript 对象，因为当点击我页面上的某个按钮时，我需要读取当前内部的值`php_string`。

**编辑3（的全部原因`php_string`）**

我试图抽象出这个问题，但现在我发现我不应该这样做。

我有一个页面表单，其中包含一些输入和多个名为“选项”的按钮

当我单击这些按钮中的任何一个时，会出现一个弹出窗口，其中包含动态字段（源自在选择字段上选择的选项），当我填写所有输入时，我会创建`php_string`并将其保存在隐藏字段中。

现在我希望当我再次单击“选项”按钮之一时，我可以读取我保存在隐藏字段中的内容，以便放置弹出输入应该显示的默认值，如果选择字段的选定选项没有不改变。

然后在 PHP 上解析隐藏字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:12:17.150

编辑：

看起来这可能更接近您正在寻找的内容：

```
<script>
    var php_string = 'array("one"=>"value_one","two"=>"value_two")';
    var php_string = JSON.parse(php_string.replace(/array\(/g, '{').replace(/\)/g, '}').replace(/=>/g, ':'));
</script> 
```

不过，这当然不是最优雅的处理方式，因此请考虑重构产生该输出的内容。例如，您可以从客户端发送 json 并在服务器端使用[json_decode](http://php.net/manual/en/function.json-decode.php)。

# opengl - OpenGL 正交视图近/远值

> ID：14836606
> 
> 赞同：2
> 
> 时间：2013-02-12T16:04:15.683
> 
> 标签：opengl, graphics, orthogonal

简单的问题：惯用手会改变正交视图的近距和远距值吗？例如：左手向下看 z 是正值（越远），右手向下看 z 是负值。

这是否意味着左手近/远应该是-1,1，右手近/远应该是1,-1？还是总是-1,1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:18:14.363

如果您使用例如[glOrtho()](http://msdn.microsoft.com/en-us/library/windows/desktop/dd373965%28v=vs.85%29.aspx)创建投影矩阵，则提供更近和更远的深度裁剪平面的值。如果您查看实际矩阵，您会看到投影后生成的 z 坐标为

```
z_proj = (-2 * z_view - far - near) / (far - near) 
```

如果`far > near`，则该值随着`z_view`减少而增加。这意味着具有较小`z_view`的对象比具有较大的对象更远`z_view`。这等于右手坐标系，其中相机前面的对象具有负 z 值。

如果`far < near`，则该值随着增加而`z_view`增加。这意味着具有较大`z_view`的对象比具有较小的对象更远`z_view`。这等于左手坐标系，其中相机前面的对象具有正 z 值。

您可能会进一步注意到 a `z_view`of`-near`映射到`-1`和 a `z_view`of`-far`映射到`+1`。

实际（绝对）值取决于您的场景。通常，您不想在相机后面显示任何内容。因此您可以设置`near`为 0（或到场景中第一个对象的距离）。您应该`far`至少设置到最远像素到相机的距离。如果要使用左手坐标系，请反转这些值。例如，右手的 [0, 2] 变成左手的 [0, -2]。

如果您不想总是考虑这个问题，您可以将投影矩阵的手性部分提取到单独的比例矩阵中：

```
ProjectionRH = Ortho * Scal(1, 1,  1)
ProjectionLH = Ortho * Scal(1, 1, -1) 
```

# node.js - 使用 MongoDB 投影数组元素

> ID：14836612
> 
> 赞同：0
> 
> 时间：2013-02-12T16:04:32.173
> 
> 标签：node.js, mongodb

我有以下 json 文件：

```
{
    "Section": {
        "Name": "Section 1",
        "Description": "Section 1 information",
        "Icon": "test.png"
    },
    "Data": [{
        "Name": "Firstname",
        "Desc": "Users first name",
        "Type": "Text"
    }, {
        "Name": "Lastname",
        "Desc": "Users last name",
        "Type": "Text"
    }]
} {
    "Section": {
        "Name": "Section 2",
        "Description": "Section 2 information",
        "Icon": "test.png"
    },
    "Data": [{
        "Name": "Section 2 Item",
        "Desc": "Section 2 Desc",
        "Type": "Text"
    }]
} 
```

我想问是否有任何方法可以基于 Data.Name 来投影项目。就像在 ['Firstname', 'Section 2 Item'] 中使用 Data.Name 项目所有内容，包括 Section 对象。所以结果应该是：

```
{
    "Section": {
        "Name": "Section 1",
        "Description": "Section 1 information",
        "Icon": "test.png"
    },
    "Data": [{
        "Name": "Firstname",
        "Desc": "Users first name",
        "Type": "Text"
    }]
} {
    "Section": {
        "Name": "Section 2",
        "Description": "Section 2 information",
        "Icon": "test.png"
    },
    "Data": [{
        "Name": "Section 2 Item",
        "Desc": "Section 2 Desc",
        "Type": "Text"
    }]
} 
```

不确定这是否可能。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:51:46.470

您可以使用`$`位置投影运算符来执行此操作，该运算符标识查询对象中匹配的数组元素的索引：

```
db.test.find(
    {'Data.Name': {$in: ["Firstname", "Section 2 Item"]}}, 
    {Section: 1, 'Data.$': 1}) 
```

# php - 向 drupal 渲染数组添加额外的内容/标记

> ID：14836617
> 
> 赞同：1
> 
> 时间：2013-02-12T16:04:44.607
> 
> 标签：php, drupal-7

这是我在这里的第一个问题——尽管我多年来一直使用它作为参考——所以，如果这是微不足道的/已经回答的，请原谅我，但我无法找到解决方案。

我有一个渲染数组被返回到块视图数组的“内容”属性。我现在只是返回一张桌子。

```
<?php
$data = array(
'#markup' => theme('table', array('header' => $header, 'rows' => $rows)),
);

return $data;
?> 
```

我想做的是在开头添加额外的标记。我尝试添加“#prefix”属性，但结果不如预期；我最终得到了块外的 HTML。我认为可行的其他任何事情似乎都会导致 PHP 错误或什么都不做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:52:28.787

当使用带有#prefix 的HTML 标签时，它们应该用#suffix 结束。你记得关闭#prefix 中的内容吗？

像这样：

```
$data = array(
    '#type' => 'markup',
    '#prefix' => '<div>',
    '#markup' => theme('table', array('header' => $header, 'rows' => $rows)),
    '#suffix' => '</div>',
); 
```

**编辑**

要将输出控制为 HTML 而不是渲染数组，可以使用 hook_block_view() 钩子为 $block['content'] 提供纯 HTML 而不是渲染数组。 [根据文档](http://api.drupal.org/api/drupal/modules!block!block.api.php/function/hook_block_view/7)， $block['content'] 可以处理这两种类型的输入。

```
function modulename_block_view($delta='') {
  $block = array();

  switch($delta) {
    case 'block_name' :
      $block['content'] = '<div>Content before</div>';
      $block['content'] .= theme('table', array('header' => $header, 'rows' => $rows));
      $block['content'] .= '<div>Content after</div>';
    break;
  }

  return $block;
} 
```

如果您不想使用块视图挂钩，我想您可以以这种方式渲染渲染数组：

```
$render_array = array(
    '#type' => 'markup',
    '#markup' => theme('table', array('header' => $header, 'rows' => $rows)),
);

$before = '<div>Content before</div>';
$after = '<div>Content after</div>';
$data = $before.render($render_array).$after;
return $data; 
```

请参阅[render()](http://api.drupal.org/api/drupal/includes!common.inc/function/render/7)以获取参考。还记得清除您的缓存，如[本答案](https://stackoverflow.com/a/5168175/1904615)中所述。

# php - sql查询。语法错误，意外的 '"'

> ID：14836623
> 
> 赞同：-4
> 
> 时间：2013-02-12T16:04:55.573
> 
> 标签：php, sql

这是我的查询：

```
$q="INSERT INTO users2 (id_fb,name, firstname ) VALUES($_SESSION["userprofile"]["id"],$_SESSION["userprofile"]["name"],$_SESSION["userprofile"]["first_name"])"; 
```

我有这个错误：

解析错误：语法错误，意外的 '"'，需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

如何正确执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:07:27.113

你需要引用：

```
$q="INSERT INTO users2 (id_fb,name, firstname ) 
  VALUES('".(int)$_SESSION["userprofile"]["id"]."',
         '".mysqli_real_escape_string($_SESSION["userprofile"]["name"])."',
         '".mysqli_real_escape_string($_SESSION["userprofile"]["first_name"])."')"; 
```

但是最好使用准备好的语句...

```
 $q = $sql->prepare("INSERT INTO `users2` SET 
                   `id_fb` = ?, `name` = ?, `firstname` = ?");
   $q->execute( array( (int)$_SESSION["userprofile"]["id"], 
            $_SESSION["userprofile"]["name"], 
            $_SESSION["userprofile"]["first_name"])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:09:24.113

**不要使用**mysql_*，它们已被弃用。此外，您很容易受到 SQL 注入的影响。

现在到你的问题。您正在使用双引号来构建字符串。当语句到达您的第一个`$_SESSION["`时，双引号会关闭您的字符串构造。您必须在会话中使用单引号。像这样：`$_SESSION['id']`

进一步澄清：

`$var = "This is a "statement"";``This is a "statement"`由于字符串在语句之前的双引号中关闭，因此不会产生输出。您必须转义内部双引号以显示它们 ( `\"`)。此外，由于单引号不会关闭以双引号开头的语句，`$var = "This is a 'statement'";`因此将输出，反之亦然。`This is a 'statement'`

在这个问题中，使用双引号开始字符串允许执行变量，但数组项在使用它们的索引时必须使用单引号：`$_SESSION['name']`而不是`$_SESSION["name"]`。

为了将来的帮助，请对 PHP 给您的错误进行一些研究，它们往往会告诉您或引导您解决问题。另外，阅读 PHP 的基础知识。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-12T16:07:44.453

尝试：

```
 $q="INSERT INTO users2 (id_fb,name, firstname ) VALUES($_SESSION['userprofile']   ['id'],$_SESSION['userprofile']['name'],$_SESSION['userprofile']['first_name'])"; 
```

# iis - 在 IIS 中允许 Amazon ELB

> ID：14836624
> 
> 赞同：1
> 
> 时间：2013-02-12T16:04:56.177
> 
> 标签：iis, amazon-web-services, load-balancing, windows-server-2012

IIS 的“IP 地址和域限制”部分是否有允许或禁止访问 Amazon Elastic Load Balancer 的选项？- 我希望我的网站只对我自己可见（我的 IP 地址）。但是，如果我禁止所有并仅允许我的 IP 地址，Amazon ELB 将无法访问 EC2 实例。我知道我不能通过 IP 允许 ELB，因为它一直在变化，是否有任何其他选项可以在“IP 地址和域限制”中允许 ELB？

使用 Windows 2012 IIS8。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:15:29.337

问题是，如果您允许 ELB 访问，任何使用 ELB 向外 IP 地址的人都可以访问您的网站。您无法将 IIS 配置为禁止基于*转发*的IP 地址的流量。

如果您在虚拟私有云 (VPC) 中，则可以创建私有 ELB

> 在虚拟私有云 (VPC) 中使用时，您可以创建和管理与 Elastic Load Balancing 关联的安全组，以提供额外的网络和安全选项。

[http://aws.amazon.com/elasticloadbalancing/](http://aws.amazon.com/elasticloadbalancing/)

这样，只有您（或您在 VPC 中允许的其他人）才能访问 ELB 本身。

如果您希望您的 ELB 面向公众，[X-Forwarded-For](http://en.wikipedia.org/wiki/X-Forwarded-For) HTTP 标头将提供原始 IP 地址（例如您的 IP）。您可以编写一个 IIS 模块来检查允许的转发 IP 并拒绝不在允许列表中的 IP。F5 的某个人编写了一个模块，可以提供一个良好的开端：

[https://devcentral.f5.com/blogs/us/x-forwarded-for-http-module-for-iis7-source-included](https://devcentral.f5.com/blogs/us/x-forwarded-for-http-module-for-iis7-source-included)

# printing - 对于 Windows 7 上的 hp 打印机，job_info_2 的 PagesPrinted 字段不可靠，值取决于打印处理器

> ID：14836627
> 
> 赞同：0
> 
> 时间：2013-02-12T16:04:59.743
> 
> 标签：printing, windows-7, driver, print-spooler-api

对于 Windows 7 上的 hp 打印机，job_info_2 的 PagesPrinted 字段不可靠，值取决于打印处理器

我正在开发打印监视器，对于 hp 打印机，PagesPrinted 不可靠且值错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T15:58:34.437

您的打印机的打印驱动程序显然正在使用不正确的页计数值调用 SetJob。你可能对此无能为力。因此，获得准确页数的唯一方法是解析打印数据流并自己计算页数。有问题的打印机使用 PCL。幸运的是，sourceforge 提供了一个开源[PCL 查看器](http://openpcl.sourceforge.net/)，您可以使用它来解析 PCL。尽管此解决方案比简单地调用 GetJob 更复杂，但它应该可以可靠地用于所有 PCL 打印机。支持 Postscript 打印机可以用类似的方式完成，而且解析也简单得多，因为 Postscript 将页数直接放在数据流中。

# vba - 从访问2010中的子表单中删除数据

> ID：14836628
> 
> 赞同：1
> 
> 时间：2013-02-12T16:05:04.527
> 
> 标签：vba, ms-access

我正在尝试在访问表单中创建一个按钮，该按钮将退出表单而不将数据保存在表中。这是我写的：

```
Private Sub Command7_Click()
Me.Undo
Dim myReply

myReply = MsgBox("Are you sure you want to exit without saving?", vbYesNo)
If myReply = vbYes Then
    DoCmd.Close
End If

End Sub 
```

当我有一个简单的表单时它工作正常，但是如果我的表单包含一个`sub form`（与不同的表相关）并且在单击该按钮之前进行了更改`sub form`，那么记录将被保存。

如何删除 和 中的`main form`记录`sub form`？

# c++ - 在OpenGL中使用GL_MAP2_COLOR_4来改变顶点颜色

> ID：14836630
> 
> 赞同：0
> 
> 时间：2013-02-12T16:05:15.653
> 
> 标签：c++, qt, opengl

我有一个模型，我在其中存储顶点数据以绘制曲面，一切正常，但顶点的颜色不起作用。

```
GLfloat ctrlpoints[model->rowCount()][model->columnCount()][3];
for (int i = 0; i < model->columnCount(); ++i) {
    for (int j = 0; j < model->rowCount(); ++j) {
        ctrlpoints[j][i][0]=(float)j/model->columnCount();
        ctrlpoints[j][i][1]=(float)i/model->rowCount();
        ctrlpoints[j][i][2]=(float)model->data(model->index(i,j)).toInt();
    }
}
GLfloat ctrlpointsColor[model->rowCount()][model->columnCount()][4];
for (int i = 0; i < model->columnCount(); ++i) {
    for (int j = 0; j < model->rowCount(); ++j) {
        ctrlpointsColor[j][i][0]=1;
        ctrlpointsColor[j][i][1]=0;
        ctrlpointsColor[j][i][2]=0;
        ctrlpointsColor[j][i][3]=1;
    }
}

glEnable(GL_MAP2_VERTEX_3);
glEnable(GL_MAP2_COLOR_4);
glEnable(GL_AUTO_NORMAL);
glMap2f(GL_MAP2_VERTEX_3, 0, 1, 3*model->columnCount(), model->rowCount(), 0, 1, 3, model->columnCount(), &ctrlpoints[0][0][0]);
glMap2f(GL_MAP2_COLOR_4, 0, 1, 4*model->columnCount(), model->rowCount(), 0, 1, 4, model->columnCount(),&ctrlpointsColor[0][0][0]);
glMapGrid2f(20, 0.0, 1.0, 20, 0.0, 1.0);
glEvalMesh2(GL_FILL, 0, 20, 0, 20); 
```

# c++ - 将字符串转换为 int if number

> ID：14836638
> 
> 赞同：1
> 
> 时间：2013-02-12T16:05:34.030
> 
> 标签：c++, if-statement, char, int

下面我有一个代码，我想在其中输入某些值。如果我 cin a [ 它应该忽略它。但是如果用户插入数字而不是 a`[`它应该将 char 转换为 int 并将其插入到`rows`else 函数中。如何将此 char 转换为 int 并将其放入`rows`？

```
 char ignoreChar;

    is >> ignoreChar;

    if(ignoreChar == '[')
    {
    }

    else
    {
    rows = ignoreChar;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:13:09.963

如果您适当注意`ignoreChar`将包含一个数字，您可以通过这种方式轻松地将其转换为整数：

```
rows = ignoreChar - '0'; 
```

该`std::isdigit()`函数可用于检查某个字符是否代表一个数字。

您可以将以下示例程序作为灵感：

```
#include <iostream>

using namespace std;

int main()
{
    int i = -1; // Equivalent of your "rows"

    char c; // Equivalent of your "ignoreChar"
    cin >> c;

    if (std::isdigit(c))
    {
        i = c - '0';
    }
    else
    {
        // Whatever...
    }

    cout << i;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T13:31:07.303

很抱歉代码比可能长得多。下面是“阶乘计数”的示例代码，其中包含输入符号及其处理。我试图展示不同的可能性。我现在看到的唯一问题是，如果用户在没有输入任何符号的情况下按 Enter 键，则没有任何反应。这是我在这里的第一篇文章，所以对于任何可能的字体、格式和其他废话，我感到非常抱歉。MaxNum = 21 是根据经验为 unsigned long long int 返回类型定义的。

我检查过这样的输入案例：abcde 2\. -7 22 21

```
#include "stdafx.h"
#include <iostream>
#include <iomanip>
#include <cstdlib>

unsigned long long int CalcFact( int p ) 
    { return p == 0 || p == 1 ? 1 : p*CalcFact(p-1); }

int main()
{
int MaxNum = 21, HowMany = 0, MaxAttempts = 5, Attempts = 0;
char AnyKey[] = "", *StrToOut = "The factorial of ", Num[3] = "";
bool IsOK = 0;

while( !IsOK && Attempts++ < MaxAttempts )
{
    std::cout << "Please enter an integer > 0 and <= 21: ";
    std::cin.width(sizeof(Num)/sizeof(char)); 
    std::cin >> Num;
    for( int Count = 0; Count < strlen(Num); Count++ )
        IsOK = isdigit(Num[Count]) ? true : false;
    if( IsOK )
    {
        if( !(atoi(Num) >= 0 && atoi(Num) <= MaxNum) )
            IsOK = false;
        else
        {
            for( int Count = 0; Count <= MaxNum; Count++ )
                {
                std::cout << StrToOut << Count << std::setfill('.') 
                << std::setw( Count < 10 ? 30 : 29 ) 
                << CalcFact(Count) << std::endl; 
                }
        }
    }
    if( !IsOK && Attempts > 0 )
    {
        std::cin.clear(); 
        std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    }
}
if( !IsOK ) 
    return -1;
else
    std::cin >> AnyKey;
return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:09:42.583

如果他们只输入一个字符，您应该能够键入 cast 它。

int a = (int)whateverNameOfChar;

这会将它转换为它的 ASCII 数字，所以你必须减去 '0'

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T16:12:35.190

要将`char`您知道是其中之一的a`'0'`转换为该数值`'9'`的 an ，您可以简单地执行以下操作：`int`

```
rows = ignoreChar - '0'; 
```

这是有效的，因为标准保证数字字符具有连续值。

如果您需要确定 是否`char`是数字，您可以使用`std::isdigit(ignoreChar)`或 的简单条件`ignoreChar >= '0' && ignoreChar <= '9'`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T16:14:11.307

“读取用户输入”有几种不同的方法。

哪一个效果最好，取决于输入的格式/风格。您可以考虑两种不同的格式，“Linebased”和“free form”。自由形式将像 C 源代码一样输入，您可以在其中添加换行符、空格等，只要您喜欢。

Linebased 具有一套格式，其中每一行包含一组给定的输入[不一定是相同数量的输入，但行尾终止该特定输入]。

在自由格式输入中，您必须阅读一个字符，然后确定“这个特定部分的含义是什么”，然后决定要做什么。有时你还需要使用该`peek()`功能来检查下一个字符是什么，然后根据它来确定要做什么。

在基于行的输入中，您`getline()`可以读取一行文本，然后将其拆分为您需要的任何格式，例如使用`stringstream`.

接下来，您必须决定是编写自己的代码（或使用一些基本的标准翻译代码）还是使用`stream`函数来解析例如数字。编写更多代码将为您提供更好的方法来处理错误，例如“1234aqj”不是数字，而是`stream`在到达该字符串中的“a”时停止读取。

# jquery-ui - 对话框中的jquery-ui可滚动列表

> ID：14836643
> 
> 赞同：0
> 
> 时间：2013-02-12T16:05:42.597
> 
> 标签：jquery-ui, list, dialog, scrollable

我在我的 crm 2011 应用程序中使用 JQuery-Ui。我使用 jquery-ui-dialog 来显示列表，但是当列表太长时，我希望出现垂直滚动条。现在列表超出了表单的长度。我尝试设置对话框的最大高度，但什么也没发生 - 也许我没有以正确的方式做到这一点..（我是 jquery 和 css 的新手）。我会很感激任何帮助，谢谢！

```
var listItemsString = "";

for (var i = 0; i < listItemsArray.length; i++) {
    listItemsString += "<li class='ui-widget-content'>" + listItemsArray[i] + "</li>";
}

var div = $("<div id='myListDialog' title='this is the title'><p class='validateTips'>this is the description</p>"
                + "<form><ul id='selectable'>" + listItemsString + "</ul></form></div>");

$("body").prepend(div);

$("#selectable ul").css({ "list-style-type": "none", "margin": "0", "padding": "0", "width": "60%" });
$("#selectable li").css({ "margin": "3px", "padding": "0.4em", "height": "14px" });

$("#selectable").selectable({ selected: listSelectfunction ,unselected: listUnselectfunction});

$("#myListDialog").dialog({
    height: 20,
    modal: true,
    autoOpen: true,
    draggable: false,
    resizable: false,
    position: [350, $(window.parent.document).scrollTop() + 500 / 2],
    closeOnEscape: false,
    open: function (event, ui) { $(".ui-dialog-titlebar-close").hide(); },
    buttons: buttons
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T05:18:46.643

您可以将对话框中的任何内容设置为具有最大高度（最大高度），并通过将溢出设置为自动使其在其中滚动。看到这个小提琴：http: [//jsfiddle.net/582ms/1/](http://jsfiddle.net/582ms/1/)

```
.child {
    max-height:150px;
    overflow: auto;
    width: 150px;
} 
```

# api - 使用来自云平台的 IP（白名单）受限 API

> ID：14836644
> 
> 赞同：5
> 
> 时间：2013-02-12T16:05:55.597
> 
> 标签：api, proxy, cloud, cloud-hosting, amazon-elastic-beanstalk

从本质上没有固定 IP 地址的 AWS Elastic Beanstalk 等云平台调用具有 IP 白名单的 API 的最佳解决方案是什么？

我最近经常遇到这个问题，因为我管理的越来越多的应用程序正在为云托管平台构建。到目前为止，我遇到的唯一真正的选择是在静态 IP 托管服务器上创建一个文件，该文件充当 API 请求的代理。

有没有更好的解决方案？

# asp.net - 页面 RegisterAsyncTask 服务器奇怪的行为

> ID：14836645
> 
> 赞同：3
> 
> 时间：2013-02-12T16:05:55.807
> 
> 标签：asp.net, asynchronous, optimization, pageasynctask

当前上下文：我们有一个需要并行加载多个列表的网页，我们决定使用 Page.RegisterAsyncTask 来执行此操作（一旦我们调用 Page.ExecuteRegisteredAsyncTasks()，这些方法只是加载数据，将被渲染作为渲染的 JSON，并且页面的 Async 属性设置为 true - 所以一切都应该没问题）在我们的开发机器（win 7 和 win 8）上，性能从 3 秒大幅提高到 1 秒以下。

问题：一旦部署在登台/实时服务器 (Windows 2008 R2) 上，与非异步标准版本相比，性能没有任何改进。

尝试了其他解决方案：我们尝试在不同线程上的 PageLoad 上使用 Task.Factory.StartNew + Task.WaitAll 加载任务，并且在开发机器和登台机器上存在相同的行为。尝试在登台服务器上更改 machine.config 中的设置（尽管尚未完成重新启动）（）

问题：有没有人遇到过这个问题，如果有，您是否找到了解决方案？是不是Win7/8和Windows 2008 R2的线程调度算法不同造成的

# iphone - 无法使用 stackmob 作为后端在英里内找到位置

> ID：14836646
> 
> 赞同：0
> 
> 时间：2013-02-12T16:06:00.250
> 
> 标签：iphone, ios, mkmapview, cllocationmanager, stackmob

我正在尝试查找位置，但我得到一个空数组返回。它成功了，但没有得到任何回报。在对象浏览器中，我可以说“位置”中有值。我使用当前位置保存了多个位置。这行得通吗？

```
- (void)geoQuery
{
    MKCoordinateRegion region;
    region = MKCoordinateRegionMakeWithDistance(locationController.locationManager.location.coordinate, 5000, 5000);

    [self.mapView setRegion:region animated:YES];

    SMQuery *query = [[SMQuery alloc] initWithSchema:@"event"];
    [query where:@"location" isWithin:10 kilometersOf:locationController.locationManager.location.coordinate];
    [[[SMClient defaultClient] dataStore] performQuery:query onSuccess:^(NSArray *results) {
        NSLog(@"%@", results);
    } onFailure:^(NSError *error) {
        NSLog(@"can't find any");
    }];
} 
```

这些是创建新事件的方法，包括地理位置数据：

```
- (void)onCreate:(QButtonElement *)buttonElement
{
    EventInfo *eventInfo = [[EventInfo alloc] init];
    Event *event = [[Event alloc] initIntoManagedObjectContext:self.managedObjectContext];
    [event setValue:[event assignObjectId] forKey:[event primaryKeyField]];
    [event setValue:eventInfo.title forKey:@"title"];
    NSDecimalNumber *latDecimal = [[NSDecimalNumber alloc] initWithDouble:mapViewController.locationManager.location.coordinate.latitude];
    NSDecimalNumber *lonDecimal = [[NSDecimalNumber alloc] initWithDouble:mapViewController.locationManager.location.coordinate.longitude];

    [event setValue:latDecimal forKey:@"lat"];
    [event setValue:lonDecimal forKey:@"lon"];

    [self.managedObjectContext saveOnSuccess:^{
        [self.navigationController popViewControllerAnimated:YES];
    } onFailure:^(NSError *error) {
        [self.managedObjectContext deleteObject:event];
    }];
} 
```

和数据模型：

```
@interface Event : NSManagedObject
@property (nonatomic, retain) NSString * title;
@property (nonatomic, retain) NSNumber * lat;
@property (nonatomic, retain) NSNumber * lon;
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:06:38.123

我是 StackMob 的一名 iOS 开发人员。

我们的 SDK 现在支持在 Core Data 中保存和查询地理位置。有关更多信息，请查看此博客文章：[https ://blog.stackmob.com/2013/02/stackmob-ios-sdk-v1-3-0-release/](https://blog.stackmob.com/2013/02/stackmob-ios-sdk-v1-3-0-release/)

# perl - perl 中的 gunzip 或系统 gzip

> ID：14836647
> 
> 赞同：0
> 
> 时间：2013-02-12T16:06:01.303
> 
> 标签：perl, gzip

我想gunzip一个文件。我想知道perl自带的gunzip命令还是系统自带的（uncompress -f file_name.Z）是更快还是更好。

我已经包含在我的 perl 脚本中

```
use IO::Uncompress::Gunzip qw(gunzip $GunzipError) ; 
```

我想测试 gunzip 命令，到目前为止，我一直在系统命令中使用 uncompress 作为：

```
system "wget ${my_file}.Z "
system "uncompress -f ${my_file}.Z"; 
```

我也可以用作：

```
gunzip -f ${my_file}.Z 
```

不涉及任何其他开销？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:33:51.933

Z 和 GZ 文件使用不同的压缩算法。GZ 的创建是因为 Z 使用了获得专利的 LZW 压缩算法。专利已经过期，但两者仍然不兼容。

# c# - 如何重写以下行以在 .NET 2.0 上工作？

> ID：14836650
> 
> 赞同：1
> 
> 时间：2013-02-12T16:06:08.757
> 
> 标签：c#, datetime, .net-2.0

我正在用 c# 开发一个应用程序，我的目标是 net framework 4.0。在我的解决方案的属性窗口中，我将目标框架更改为`NET Framework 2.0`，但应用程序突然停止工作。它向我显示以下错误：

`No overload for method ToString() takes 1 argument`

导致错误的代码：

```
 DateTime endTime;
  string endDate = get_end_date_fromDB();

  if (DateTime.TryParseExact(endDate, "dddd, MMMM dd, yyyy", null, DateTimeStyles.None, out endTime))
        {

            TimeSpan ts = endTime.Subtract(DateTime.Now);

            label1.Text = ts.ToString("d' Jours 'h' Heures 'm' Minutes'"); // <<<< THIS LINE IS CAUSING THE ERROR

        } 
```

是否有一种解决方法可以使上面的代码在 C# 2.0 上运行？我需要以特定格式显示日期。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-12T16:09:46.890

较旧的实现没有`ToString`使用格式参数覆盖。

```
label1.Text = string.Format("{0}' Jours '{1}' Heures '{2}' Minutes'", 
                                   ts.Days, ts.Hours, ts.Minutes); 
```

您可以通过在“其他版本”组合框中选择感兴趣的版本，在 MSDN 上找到特定于 .NET 版本的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:12:14.800

```
label1.Text = string.Format("{0}' Jours '{1}' Heures '{2}' Minutes'", ts.Days, ts.Hours, ts.Minutes); 
```

# php - PHP fgetcsv() 不读取第一个 UTF-8 字符 - 使用 fgets 的替代方法

> ID：14836653
> 
> 赞同：1
> 
> 时间：2013-02-12T16:06:19.370
> 
> 标签：php

根据用户 user1830391 在此处提供的答案： [PHP fgetcsv() 期间未读取 CSV 文件中的某些字符](https://stackoverflow.com/questions/1472886/some-characters-in-csv-file-are-not-read-during-php-fgetcsv)

我更新了以下代码以使用 fgets() 而不是 fgetcsv()。它解决了我的第一个角色问题。这不再是一个问题......但是......

如果 .csv 文件使用 ; 而不是 , 某些字段将使用双引号 "" 括起来，例如我的一行被拆分为 2 行。引号在一行的最后一个元素中打开，在下一行的第一个元素的末尾关闭。该单元格中有一个“输入”（/ n）。我应该如何使用此代码处理此问题。fgetcsv 捕获双引号内的元素，但我认为 fgets() 不会。

```
function runCSVtoArray() {
    // --> FOR IMPORT
    //Function that converts a CSV file to a PHP array.
    //echo '<span class="success">Chargement du fichier CSV pour importation MYSQL....</span><br />';
    $readCharsPerLine = (JRequest::getVar('charsPerLine') > 0) ? JRequest::getVar('charsPerLine') : 1500; /* Import as of 2012-04-16 seem to have max 800chars per line. 1500 is alot of extra. */
    ini_set("auto_detect_line_endings", true);
    iconv_set_encoding("internal_encoding", "UTF-8");
    $openfile = $this->imp['importPath'].$this->imp['csvFileName'];
    if ( file_exists($openfile) ) {
        //echo '<span class="success">Fichier CSV trouvé....</span><br />';
        //echo '<span class="success">Ouverture du fichier : '.$openfile.'</span><br />';
        if (($handle = fopen($openfile, "r")) !== FALSE) {
            //echo '<span class="success">Fichier CSV ouvert... Chargement en cours....</span><br />';
            $row_i=0;
            $this->_importData = array();
            /*while (($data = fgetcsv($handle, $readCharsPerLine, ";")) !== FALSE) {*/
            while (($the_line = fgets($handle)) !== FALSE) {
                $data = explode(';', $the_line);
                $debugoutput = implode('; ', $data).'<br />'; echo ( (JRequest::getVar('encodeutf8')) && ( mb_detect_encoding($debugoutput, "UTF-8") == "UTF-8") ) ? utf8_encode($debugoutput) : $debugoutput.'<br />'; //Debug2
                /*
                $num        = count($data);
                if ($row_i==0) {
                    // TITLE ROW
                    $keyRow = array();
                    for ($c=0; $c < $num; $c++) {
                        //Making title array with CSV first line
                        //Key for colum
                        if ( (JRequest::getVar('encodeutf8')) && ( mb_detect_encoding($data[$c], "UTF-8") == "UTF-8") ) { $data[$c] = utf8_encode($data[$c]); }
                        if ($data[$c]!="") {
                            $keyRow[$c]=trim($data[$c]);
                            $keyRow[$c]=str_replace('GDWACCENT', '', $keyRow[$c]);  //STRIP GDWACCENT, GDW uTF8 fgetcsv fix
                        }
                        else { $keyRow[$c]=''; }
                    }
                } else {
                    //VALUE ROW...
                    for ($c=0; $c < $num; $c++) {
                        $key = $keyRow[$c];
                        if ( (JRequest::getVar('encodeutf8')) && ( mb_detect_encoding($data[$c], "UTF-8") == "UTF-8") ) {
                            $data[$c] = utf8_encode($data[$c]);
                            $data[$c]=str_replace('GDWACCENT', '', $data[$c]);  //STRIP GDWACCENT, GDW uTF8 fgetcsv fix
                        }
                        if ($data[$c]!="") {
                            $this->_importData[$row_i][$key]=trim($data[$c]);
                            $this->_importData[$row_i][$key]=str_replace('GDWACCENT', '', $this->_importData[$row_i][$key]);    //STRIP GDWACCENT, GDW uTF8 fgetcsv fix
                        }
                    }
                }
                */
                $row_i++;
            } //End while()
            //echo '<span class="success">Chargement terminer.... Sauvegarde en cours...</span><br />';
            return true;
        } else {
            //Incapable d'ouvrir le fichier d'importation.
            return false;
        }
    } else {
        //FILE NOT FOUND...
        return false;
    }
} // runCSVtoArray() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:19:07.010

您所依赖的答案，即 fgetcsv 仅适用于 ascii 字符，是完全**错误**的。真实的是：

> 笔记：
> 
> 此功能考虑了区域设置。如果 LANG 是例如 en_US.UTF-8，则此函数会读取 >one-byte 编码的文件错误。

所以你必须配置你的`LANG`变量而不是使用 fgets。

下面是一个如何设置 lang 变量的示例：

```
putenv("LANG=fr_FR.UTF-8"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:21:44.203

我通过使用 fopen 和 fgets 而不是 fgetcsv() 打开文件并使用 utf8_encode 为每一行编写一个副本来解决这个问题。然后我使用副本并将其放入 fgetcsv()

这是我更新的代码。

```
function runCSVtoArray() {
    // --> FOR IMPORT
    //Function that converts a CSV file to a PHP array.
    //echo '<span class="success">Chargement du fichier CSV pour importation MYSQL....</span><br />';
    $readCharsPerLine = (JRequest::getVar('charsPerLine') > 0) ? JRequest::getVar('charsPerLine') : 1500; /* Import as of 2012-04-16 seem to have max 800chars per line. 1500 is alot of extra. */
    putenv("LANG=fr_CA.UTF-8");
    setlocale(LC_ALL, 'fr_CA.UTF-8');
    //ini_set("auto_detect_line_endings", true);
    //iconv_set_encoding("internal_encoding", "UTF-8");
    $openfile = $this->imp['importPath'].$this->imp['csvFileName'];
    $utf8File = str_replace('.csv', '_utf8.csv', $openfile);

    if ( file_exists($openfile) ) {
        //echo '<span class="success">Fichier CSV trouvé....</span><br />';

        //rewrite the file in UTF8
        if (JRequest::getVar('encodeutf8')) {
            if (($handle = fopen($openfile, "r")) !== FALSE) {
                $newFileHandle = fopen($utf8File, 'w');     //NEW UTF8 FORMAT
                //fwrite($newFileHandle, "\xEF\xBB\xBF");
                while (($the_line = fgets($handle)) !== FALSE) {
                    fwrite($newFileHandle, utf8_encode($the_line));
                }   //End of while()
            }
            $openfile = $utf8File;
        }

        //echo '<span class="success">Ouverture du fichier : '.$openfile.'</span><br />';
        if (($handle = fopen($openfile, "r")) !== FALSE) {
            //echo '<span class="success">Fichier CSV ouvert... Chargement en cours....</span><br />';
            $row_i=0;
            $this->_importData = array();
            while (($data = fgetcsv($handle, $readCharsPerLine, ";")) !== FALSE) {
            /*while (($the_line = fgets($handle)) !== FALSE) {*/
                //$data = explode(';', $the_line);
                //$debugoutput = implode('; ', $data); echo ( (JRequest::getVar('encodeutf8')) && ( mb_detect_encoding($debugoutput, "UTF-8") == "UTF-8") ) ? utf8_encode($debugoutput).'<br />' : $debugoutput.'<br />';   //Debug2
                //$debugoutput = implode('; ', $data); echo $debugoutput.'<br />';  //Debug2
                $num            = count($data);
                if ($row_i==0) {
                    // TITLE ROW
                    $keyRow = array();
                    $maxItems = count($data);   //Count the number of ";"
                    for ($c=0; $c < $num; $c++) {
                        //Making title array with CSV first line
                        //Key for colum
                        if ( (JRequest::getVar('encodeutf8')) && ( mb_detect_encoding($data[$c], "UTF-8") == "UTF-8") ) {
                            //$data[$c] = utf8_encode($data[$c]);
                            $data[$c] = $data[$c];
                        }
                        if ($data[$c]!="") {
                            $keyRow[$c]=trim($data[$c]);
                            $keyRow[$c]=str_replace('GDWACCENT', '', $keyRow[$c]);  //STRIP GDWACCENT, GDW uTF8 fgetcsv fix
                        }
                        else { $keyRow[$c]=''; }
                    }
                } else {
                    //VALUE ROW...
                    for ($c=0; $c < $num; $c++) {
                        $key = $keyRow[$c];
                        if ( (JRequest::getVar('encodeutf8')) && ( mb_detect_encoding($data[$c], "UTF-8") == "UTF-8") ) {
                            //$data[$c] = utf8_encode($data[$c]);
                            $data[$c] = $data[$c];
                            $data[$c]=str_replace('GDWACCENT', '', $data[$c]);  //STRIP GDWACCENT, GDW uTF8 fgetcsv fix
                        }
                        if ($data[$c]!="") {
                            $this->_importData[$row_i][$key]=trim($data[$c]);
                            $this->_importData[$row_i][$key]=str_replace('GDWACCENT', '', $this->_importData[$row_i][$key]);    //STRIP GDWACCENT, GDW uTF8 fgetcsv fix
                        }
                    }   //End of for()
                }
                $row_i++;
            } //End while()
            //echo 'HERE<br />';
            //gdwprint($this->_importData);
            //exit();
            //echo '<span class="success">Chargement terminer.... Sauvegarde en cours...</span><br />';
            return true;
        } else {
            //Incapable d'ouvrir le fichier d'importation.
            return false;
        }
    } else {
        //FILE NOT FOUND...
        return false;
    }
} // runCSVtoArray() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:23:22.843

根据我的经验，输入数据`fgetcsv()`必须是 UTF-8。

在您的情况下，如果您在 Éric 中忽略了 É，那么您的输入不是 UTF-8，而是可能是一些单字节编码（Windows-1252？`echo bin2hex($str);`要验证）。php 错误跟踪器中有一个错误报告（[https://bugs.php.net/bug.php?id=55507](https://bugs.php.net/bug.php?id=55507)）。解决方案是在输入 fgetcsv 之前将文本转换为 utf8

同样重要的是 UTF-8**不**包含 BOM。

# html - CSS 中心链接和填充栏到页面末尾

> ID：14836654
> 
> 赞同：0
> 
> 时间：2013-02-12T16:06:20.467
> 
> 标签：html, css

我正在尝试**垂直对齐导航栏中的文本**。

我试过使用垂直对齐。但它不起作用。

我还确保它的高度可以在内部对齐。

此外，有没有办法**将导航栏填充到页面末尾**，平行四边形/矩形。这样链接右侧就没有空格。所以它实际上是一根长条，由平行四边形分割。

[http://jsfiddle.net/Z4kUm/](http://jsfiddle.net/Z4kUm/)

```
 <ul id="navlist">
                        <li><a><span>Link</span></a></li>
                        <li><a><span>Link</span></a></li>
                        <li><a><span>Link</span></a></li>
                         <li><a><span>Link</span></a></li>
                    </ul> 
```

我的CSS：

```
ul#navlist {
    padding:10px;
    font: bold 12px Arial, sans-serif;
   display: inline;
}

ul#navlist li {
    float:left;
    margin-right:20px;
    display:inline-block;
    zoom:1;
    position:relative;
    width:125px;
    height: 50px;
    list-style: none;
    color:#757575;
}

ul#navlist li a {
    display: inline-block;
    vertical-align: middle;
    text-decoration:none;
    padding:5px 10px;
    transform: skewX(-20deg);
    -o-transform: skewX(-20deg);
    -moz-transform: skewX(-20deg);
    -webkit-transform: skewX(-20deg);
     width:115px;
     height: 40px;

}

ul#navlist li a span 
{
    width: 100%;
    height: 40px; 
    display: inline-block;
    text-align: center;
    vertical-align: middle;
    transform: skewX(20deg);
    -o-transform: skewX(20deg);
    -moz-transform: skewX(20deg);
    -webkit-transform: skewX(20deg);
}

ul#navlist li a {
    background:#AAA;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:18:03.647

设置`line-height`跨度上的属性以匹配它们的高度。

**[jsFiddle 示例](http://jsfiddle.net/j08691/Z4kUm/1/)**

```
ul#navlist li a span 
{
    width: 100%;
    height: 40px; 
    line-height:40px;
    display: inline-block;
    text-align: center;
    vertical-align: middle;
    transform: skewX(20deg);
    -o-transform: skewX(20deg);
    -moz-transform: skewX(20deg);
    -webkit-transform: skewX(20deg);
} 
```

# javascript - 我可以在提交时添加隐藏的表单字段吗？

> ID：14836655
> 
> 赞同：0
> 
> 时间：2013-02-12T16:06:20.780
> 
> 标签：javascript, jquery

我在提交表单时尝试添加一个额外的隐藏表单字段，但在提交后在 POST 表单数据中看不到它。

```
$('#myform').submit(function(){        
var hiddenInput = $('<input data-role="none"/>').attr({type:'hidden',name:'myname',value: 'somevalue'});
 $('#myform').appendTo(hiddenInput);
}); 
```

表单提交但不包含隐藏字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:08:17.940

使用`.append()`您编写的方式。

`.appendTo()`您正在尝试使用该语法将表单附加到输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:08:57.580

`#myform`您已附加`hiddenInput`但反之亦然。

`submit`而是为您的活动尝试以下操作：

```
$('<input data-role="none" />').attr({
    type: "hidden",
    name: "myname",
    value: "somevalue"
}).appendTo(this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:09:31.447

```
$('#myform').on("提交",function(e)
{
    e.preventDefault();

    $('#myform').append('<input type="hidden" name="myname" value="somevalue" data-role="none"/>');

    $(this).submit();
});

```

# java - 如何防止定时器锁定我的小程序？

> ID：14836657
> 
> 赞同：2
> 
> 时间：2013-02-12T16:06:38.763
> 
> 标签：java, swing, user-interface, timer

我正在尝试在 Applet 中开发游戏，但我遇到了这个问题。我希望显示器在游戏继续之前向用户显示倒计时。但是，倒计时不会显示，而是实际上使 GUI 冻结。如何避免这种情况？这是一些演示此问题的代码。

**编辑：“几乎”下面的代码有效，计时器正在运行，但屏幕只会在按下“开始”按钮时更新为新的计时器值。如何使文本自动刷新？**

```
public class TestApplet extends JApplet implements ActionListener{

        final JTextField _displayField = new JTextField("Countdown", 6);
        CountDownTimer clock = new CountDownTimer();
        JButton jbtnStart = new JButton("Start");

    public void addComponentToPane(Container pane) {

        JPanel mainPanel = new JPanel();    
        mainPanel.add(jbtnStart);
        mainPanel.add(_displayField);
        pane.add(mainPanel);
        jbtnStart.addActionListener(this);
    }

  public void init() {

        TestApplet testApplet = new TestApplet();
        testApplet.setVisible(true);    
        testApplet.addComponentToPane(this.getContentPane());   
        this.setSize(200, 100);

}

    public void actionPerformed(ActionEvent e) {

      if ( e.getSource() == jbtnStart   ){
              clock.start(_displayField);
          }
   }     
}

// ********************************************************************************
//********************************************************************************
//********************************************************************************

class CountDownTimer  {

    private static final int N = 60;
    private final ClockListener cl = new ClockListener();
    private final Timer t = new Timer(1000, cl);
    static int count =0;

    public int getCount(){
         System.out.println(count);
        return count;
    }
    public void setCount(int n){
        count = n;
    }

    public CountDownTimer() {
        t.setInitialDelay(0);
    }

    public void start(JTextComponent c) {
        t.start();
       Boolean bool  = false;
          while ( bool ==false){     
              c.setText( "Starting new game in... "+ this.getCount() );
              bool = ( this.getCount()<10 );
          }
    }

    private class ClockListener implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            count %= N;
            count++;
           setCount(count);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:19:14.983

在阻塞 EDT 的 ActionListener 中有一个 while 循环。更新显示字段的代码不应在 ActionListener 中。

相反，此代码应该在 Timer 类中。然后，每当 Timer 触发时，您只需减去一个并更新显示字段。当计数达到零时，您将停止计时器。

此外，您的 CountDownTimer 不应扩展 JFrame。它只是一个类，与框架无关。

编辑：

这是 Swing Timer 的简单用法：

```
import java.awt.*;
import java.awt.event.*;
import java.util.*;
import javax.swing.*;

public class TimerTime extends JFrame implements ActionListener
{
    JLabel timeLabel;

    public TimerTime()
    {
        timeLabel = new JLabel( new Date().toString() );
        getContentPane().add(timeLabel, BorderLayout.NORTH);
    }

    public void actionPerformed(ActionEvent e)
    {
        timeLabel.setText( new Date().toString() );
    }

    public static void main(String[] args)
    {
        TimerTime frame = new TimerTime();
        frame.setDefaultCloseOperation( EXIT_ON_CLOSE );
        frame.pack();
        frame.setVisible(true);

        int time = 1000;
        javax.swing.Timer timer = new javax.swing.Timer(time, frame);
        timer.setInitialDelay(1);
        timer.start();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T01:29:46.460

我们一直在争论是否可以使用带有后台线程的解决方案，所以我使用辅助线程编写了一个解决方案并且它工作正常。

*   “getCount”和“setCount”方法可有可无
*   “N”常数稳定倒计时的长度

    公共类 TestApplet 扩展 JApplet 实现 ActionListener{

    ```
    JTextField _displayField;
    CountDownTimer clock;
    JButton jbtnStart;
    Thread thread;

    public TestApplet(){
        this.jbtnStart = new JButton("Start");
        this._displayField = new JTextField("Countdown", 30);
        this.clock = new CountDownTimer(_displayField);
        this.thread = null;
    }

    public void addComponentToPane(Container pane) {

        JPanel mainPanel = new JPanel();    
        mainPanel.add(jbtnStart);
        mainPanel.add(_displayField);
        pane.add(mainPanel);
        jbtnStart.addActionListener(this);
    }

    public void init() {

        TestApplet testApplet = new TestApplet();
        testApplet.setVisible(true);    
        testApplet.addComponentToPane(this.getContentPane());   
        this.setSize(200, 100);

    }

    public void actionPerformed(ActionEvent e) {

        if ( e.getSource() == jbtnStart   ){

            if(thread != null){
                thread.interrupt();
            }
            thread = new Thread(clock);
            thread.start();
        }
    } 
    ```

    }

/ ***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *******//******* *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *** / / ***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** ***** *** ** *** ** *** ****** /***

 ***```
public class CountDownTimer implements Runnable{

    private static final int N = 60;
    JTextComponent c;
    static int count =0;

    public int getCount(){
         System.out.println(count);
        return count;
    }
    public void setCount(int n){
        count = n;
    }

    public CountDownTimer(JTextComponent c) {
        this.c = c; 
    }

    @Override
    public void run() {
        try {
            for(int i=N; i>0; i--){
                setCount(i);
                c.setText( "Starting new game in... "+ this.getCount() );
                Thread.sleep(1000); 
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }finally{
            setCount(0);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:17:55.200

使用并发进行倒计时怎么样？

```
 public void actionPerformed(ActionEvent e) {

              if ( e.getSource() == jbtnStart   ){
              //You should start your new thread here
              Thread thread = Thread(new Runnable(){
                 public void run(){
                     clock.start();
                     Boolean bool  = false;
                     while ( bool ==false){
    //You can not modify the UI from a secondary thread, so you should call to some 
    //method in the GUI thread...     
                     _displayField.setText( "Starting new game in... "+ clock.getCount() );
                     bool = ( clock.getCount()==5 );  
                 }

               }
               thread.start();

            }

     }
} 
```

**注意：** 代码是用心编写的，因此容易出现一些错误，但它表达了要点。***

# ruby-on-rails - 如何使用haml rails渲染js

> ID：14836661
> 
> 赞同：0
> 
> 时间：2013-02-12T16:06:53.363
> 
> 标签：ruby-on-rails, haml

我正在使用haml，在我没有任何haml经验之前。我正在触发 ujs 调用，其代码如下

```
 = link_to "this is the best",cast_vote_cast_votes_path(job_application.id),:id => job_application.id ,:remote => true ,:class => 'btn btn-primary best-button' 
```

在此调用触发后，我的函数“cast_vote”执行，我有名为“cast_vote.js.erb”的模板。我只想在其中执行 js 警报。但是警报没有执行为什么？

我不知道。任何帮助请..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:04:19.763

尝试将此添加到您的 haml 模板中：

```
:javascript
  $(document).ready(function() {
    $(".best-button").click(function() {
       alert("ok");
    });
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:20:36.183

您需要为远程 ajax 请求配置成功回调来处理响应。将此脚本添加到您的 haml 文件中：

```
$('.best-button')
  .bind('ajax:success', function(event, data, status, xhr){ 
    eval(data.response);
  }); 
```

并更改您的 js.erb 以返回表单中的 json 对象`{response: 'alert("ok")'}`。

# java - 在处理中实例化变量异常

> ID：14836663
> 
> 赞同：0
> 
> 时间：2013-02-12T16:06:54.050
> 
> 标签：java, constructor, processing

我正在尝试为一个类创建一个构造函数

```
// Variables to send to Host
private class ParameterClass {
  public String parameter;
  public int value;
  public Boolean sended;
}

public class SendToHostClass {
  private int sizeBuffer;
  public ParameterClass[] parameterList;

  SendToHostClass(int sizeBufferConf) {
    sizeBuffer = sizeBufferConf;
    parameterList = new ParameterClass[sizeBuffer];
  }

  public void Put (String parameter, int valuePut, Boolean sendedPut) {
    for (int index=0; index<sizeBuffer; index++) {
      if (parameter == parameterList[index].parameter) {
        parameterList[index].value = valuePut;
        parameterList[index].sended = sendedPut;
        exit();
      }
    }
  }
} 
```

所以我声明了变量

```
SendToHostClass sendToHost; 
```

`sendToHost`并在`setup()`处理方法中使用实例化

```
sendToHost = new SendToHostClass(10);
sendToHost.parameterList[0].value = 0; 
```

当我运行代码时，它会返回错误消息

> 在 processing.core.PApplet.handleDraw(PApplet.java:2117) 在 processing.opengl.PGL$PGLListener.display(PGL .java:2472) 在 jogamp.opengl.GLDrawableHelper.displayImpl(GLDrawableHelper.java:548) 在 jogamp.opengl.GLDrawableHelper.display(GLDrawableHelper.java:533) 在 jogamp.opengl.GLAutoDrawableBase$2.run(GLAutoDrawableBase.java:280) ）在 jogamp.opengl.GLDrawableHelper.invokeGLImpl(GLDrawableHelper.java:904) 在 jogamp.opengl.GLDrawableHelper.invokeGL(GLDrawableHelper.java:822) 在 com.jogamp.newt.opengl.GLWindow.display(GLWindow.java:543)在 processing.opengl.PGL.requestDraw(PGL.java:814) 在 processing.core.opengl.PGraphicsOpenGL.requestDraw(PGraphicsOpenGL.java:1566)。PApplet.run(PApplet.java:2020) 在 java.lang.Thread.run(Thread.java:662)

那么我做错了什么？

我还发现，如果我分别实例化每个列表对象，它不会出错：

```
sendToHost = new SendToHostClass(10);
sendToHost.parameterList[0] = new ParameterClass();
sendToHost.parameterList[0].value = 0; 
```

但这似乎是错误的，因为看起来`parameterList`成员被实例化了两次。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:09:24.253

```
parameterList = new ParameterClass[sizeBuffer]; 
```

上面的语句只是创建一个数组，而不是初始化数组元素。数组元素由它们的默认值初始化，即`null`，以防你有一些`custom type`或一些引用的数组。因此，您需要使用 for 循环分别初始化数组元素。

因此，在您的构造函数中，您需要添加一个循环：

```
SendToHostClass(int sizeBufferConf) {
    sizeBuffer = sizeBufferConf;
    parameterList = new ParameterClass[sizeBuffer];

    for (int i = 0; i < sizeBuffer; i++) {
        parameterList[i] = new ParameterList();
    }
  } 
```

但是，当然，首先你需要创建你的类`public`，并且更喜欢创建你的字段`private`而不是`public`，并提供公共访问器以使它们可以从外部访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:11:06.610

> 但这似乎是错误的，因为看起来 parameterList 成员被实例化了两次。

您需要了解创建数组和使用对象引用填充数组之间的区别。这：

```
parameterList = new ParameterClass[sizeBuffer]; 
```

...*只是*创建一个最初充满空引用的数组。如果你想让元素*为非 null*，你必须明确地这样做......这就是你在这一行中所做的：

```
sendToHost.parameterList[0] = new ParameterClass(); 
```

不过，您最好不要使用数组开始 - 为什么*要*使用数组？您可能会更好地提供`List<ParameterClass>`.

（顺便说一句，您应该了解并遵循 Java 命名约定，并保持字段私有。）

# java - JNI - Calling Java Method from C++

> ID：14836671
> 
> 赞同：4
> 
> 时间：2013-02-12T16:07:05.043
> 
> 标签：java, android, c++, crash, java-native-interface

So I've been trying to call a java method from C++ without any luck. This is the error that I receive:

> JNI ERROR (app bug): accessed stale local reference 0x5cb00019 (index 6 in a table of size 2) VM aborting Fatal signal 11 (SIGSEGV) at 0xdeadd00d (code=1)

Here is what I do in the code (java-side):

```
 public class Wrapper extends Activity{
        private native void initJNIBridge();
            static final String TAG = "Wrapper";

    protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);

            initJNIBridge(); // Calls C++ function.
    }

    public void upgradeAdFree() {
             Log.d(TAG, "Wrapper::upgradeAdFree()");
    } 
```

And here is the C++ side:

```
 typedef struct JniMethodInfo_
    {
        JNIEnv *    env;
        jclass      classID;
        jmethodID   methodID;
    } JniMethodInfo;

    extern "C"
    {
static jobject javaObj;

// get env and cache it
static JNIEnv* getJNIEnv(void)
{

    JavaVM* jvm = cocos2d::JniHelper::getJavaVM();
    if (NULL == jvm) {
        LOGD("Failed to get JNIEnv. JniHelper::getJavaVM() is NULL");
        return NULL;
    }

    JNIEnv *env = NULL;
    // get jni environment
    jint ret = jvm->GetEnv((void**)&env, JNI_VERSION_1_4);

    switch (ret) {
        case JNI_OK :
            // Success!
            return env;

        case JNI_EDETACHED :
            // Thread not attached

            // TODO : If calling AttachCurrentThread() on a native thread
            // must call DetachCurrentThread() in future.
            // see: http://developer.android.com/guide/practices/design/jni.html

            if (jvm->AttachCurrentThread(&env, NULL) < 0)
            {
                LOGD("Failed to get the environment using AttachCurrentThread()");
                return NULL;
            } else {
                // Success : Attached and obtained JNIEnv!
                return env;
            }

        case JNI_EVERSION :
            // Cannot recover from this error
            LOGD("JNI interface version 1.4 not supported");
        default :
            LOGD("Failed to get the environment using GetEnv()");
            return NULL;
    }
}

// get class and make it a global reference, release it at endJni().
static jclass getClassID(JNIEnv *pEnv)
{
    jclass ret = pEnv->FindClass(CLASS_NAME);
    if (! ret)
    {
        LOGD("Failed to find class of %s", CLASS_NAME);
    }

    return ret;
}
static bool getMethodInfo(JniMethodInfo &methodinfo, const char *methodName, const char *paramCode)
{
    jmethodID methodID = 0;
    JNIEnv *pEnv = 0;
    bool bRet = false;

    do 
    {
        pEnv = getJNIEnv();
        if (! pEnv)
        {
            break;
        }

        jclass classID = getClassID(pEnv);

        methodID = pEnv->GetMethodID(classID, methodName, paramCode);
        if (! methodID)
        {
            LOGD("Failed to find method id of %s", methodName);
            break;
        }

        methodinfo.classID = classID;
        methodinfo.env = pEnv;
        methodinfo.methodID = methodID;

        bRet = true;
    } while (0);

    return bRet;
}   

JNIEXPORT void JNICALL Java_org_test_games_Wrapper_initJNIBridge(JNIEnv *, jobject jobj){
    LOGD("Java_org_test_games_Wrapper_initJNIBridge()");

    javaObj = jobj;

    return;
}

void upgradeAdFreeJNI()
{      
    LOGD("upgradeAdFreeJNI");

    JniMethodInfo methodInfo;
    if (! getMethodInfo(methodInfo, "upgradeAdFree", "()V"))
    {
        LOGD("Cannot find method!");
        return;
    }

    methodInfo.env->CallVoidMethod(javaObj, methodInfo.methodID);
}

} 
```

Any suggestions here would be greatly appreciated as I've been stumped on this for a few days and its not the easiest task in the world to debug this.

Thanks

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:27:33.913

问题是您指向作业的静态指针不再有效。您需要保护它免受任何垃圾收集器运行。这可以通过使用全局引用而不是本地引用来完成。而不是仅仅分配指针创建一个 globalRef。

```
JNIEXPORT void JNICALL Java_org_test_games_Wrapper_initJNIBridge(JNIEnv *, jobject jobj)
{
    LOGD("Java_org_test_games_Wrapper_initJNIBridge()");

    javaObj = env->NewGlobalRef(env, jobj);

return;
} 
```

但请注意，您还必须释放 globafRef。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:58:44.533

You must not simply store pointer to an object, as your error says. When you want to store it, you have to store local or global reference to object. See [http://docs.oracle.com/javase/6/docs/technotes/guides/jni/spec/functions.html#global_local](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/spec/functions.html#global_local)

Change to:

```
 JNIEXPORT void JNICALL Java_org_test_games_Wrapper_initJNIBridge(JNIEnv *env, jobject jobj){
        LOGD("Java_org_test_games_Wrapper_initJNIBridge()");

        javaObj = NewGlobalRef(env, jobj);

        return;
    } 
```

# build-automation - NuGet pack Ignoring -Prop Arguments When -Build Specified

> ID：14836675
> 
> 赞同：4
> 
> 时间：2013-02-12T16:07:09.970
> 
> 标签：build-automation, release, nuget

I am trying to deploy to NuGet using a script. I have the following command for doing the actual deployment:

```
nuget pack MyProjection.csproj -Build -Properties Configuration=Release 
```

Based the examples provided on NuGet's website, this is the correct command line. I noticed that some examples say `-Prop` rather than `-Properties`, but I don't think it matters.

However, NuGet outputs:

```
Attempting to build package from 'MyProject.csproj'.
Building project for target framework '.NETFramework,Version=v4.0'.
Packing files from 'C:\Users\...\MyProjection\bin\Debug'.
Using 'MyProject.nuspec' for metadata.
Successfully created package 'C:\Users\...\MyProject\MyProject.2.2.0.0.nupkg'. 
```

Notice that it is packaging files in the `Debug` folder instead of the `Release` folder!

If I remove the `-Build` setting, it grabs the files from the `Release` like it's supposed to. The first question is: have I been publishing debug versions of my project? The second question is: how do I use these two command arguments together?

If I have to, I'll build the project using MSBuild.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:52:40.583

打包项目时，nuget 将使用当前项目设置，忽略从命令行传递的配置选项。例如，basepath 参数也是如此。

如果您将默认配置更改为发布，nuget 将使用发布位构建您的包。在 .csproj 中查找以下内容：

```
 <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration> 
```

并将其更改为：

```
 <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Release</Configuration> 
```

# c# - 连接两个类中的数据以在视图中使用

> ID：14836678
> 
> 赞同：0
> 
> 时间：2013-02-12T16:07:23.753
> 
> 标签：c#, wpf, xaml, binding, collections

我正在尝试将 IEnumberable 集合绑定到组合框。我知道问题在于我在哪里实例化我的 ViewModel...我的视图的数据上下文是一个完全不同的实例，没有看到正在设置的数据。我需要知道我需要如何将数据传递给正确的例子。我是 WPF 的新手，所以我可能无法完全正确地解释其中的一些内容。以下是我认为相关的代码。如果您想查看其他内容，请告诉我，我会尽力提供信息。任何帮助，将不胜感激！我也将永远接受提示和技巧！

代码：

XAML：

```
 <telerik:RadComboBox x:Name="cboProviders" ItemsSource="{Binding Source=AddressProviders}" DisplayMemberPath="ProviderName" SelectedItem="{Binding SelectedAddressProvider, Mode=TwoWay}" Grid.Row="0" Grid.Column="1"/> 
```

以上是我目前使用的绑定。它知道那里有一个集合，但它不显示正在设置的数据。

数据上下文：

```
public EmailAddressWindow()
        {
            InitializeComponent();
            this.DataContext = new EmailViewModel();

        } 
```

这设置为 EmailViewModel

电子邮件视图模型：

```
 public IEnumerable<IEmailAddressesProvider> AddressProviders 
    {
        get
        {
            return _AddressProviders;
        }
        set
        {
            _AddressProviders = value;
            OnPropertyChanged("AddressProviders");
        }
    }
private string _SelectedAddressProvider;
public string SelectedAddressProvider
{
    get
    {
        return _SelectedAddressProvider;
    }
    set
    {
        _SelectedAddressProvider = value;
        OnPropertyChanged("SelectedAddressProvider");
    }
} 
```

接口（IEmailAddressesProvider）：

```
 public interface IEmailAddressesProvider
    {
        string ProviderName { get; }
        IEnumerable<EmailAddress> GetEmailUsers();
    }
} 
```

设置了 ProviderName 并定义了 EmailUsers 方法 (EmailAddressesProvider)：

```
[Export(typeof(IEmailAddressesProvider))]
    public class EmailAddressProvider : IEmailAddressesProvider
    {
        #region Private Properties

        private static readonly IEncryptionService encryptionService = AllianceApp.Container.GetExportedValue<IEncryptionService>();

        #endregion

        public string ProviderName
        {
            get { return "Alliance Users"; }
        }

        public IEnumerable<EmailAddress> GetEmailUsers()
        {
            IUserRepository userRepo = AllianceApp.Container.GetExportedValue<IUserRepository>();
            IEnumerable<User> users = userRepo.GetAllUsers().Where(a => a.IsDeleted == false).OrderBy(a => a.UserID).AsEnumerable();

            List<EmailAddress> AddressList = new List<EmailAddress>();

            foreach (var user in users)
            {
                if (user.DisplayName != null && user.EmailAddress != null && user.DisplayName != string.Empty && user.EmailAddress != string.Empty)
                    AddressList.Add(new EmailAddress() { DisplayName = encryptionService.DecryptString(user.DisplayName), Email = encryptionService.DecryptString(user.EmailAddress) });
            }

            AddressList.OrderBy(u => u.DisplayName);

            return AddressList;

        }
    } 
```

在哪里被设置为 ViewModel (EmailService.cs)

```
[ImportMany]
        public IEnumerable<IEmailAddressesProvider> AddressProviders { get; set; }

 EmailView ev = AllianceApp.Container.GetExportedValue<EmailView>();

            ev.ViewModel.AddressProviders = this.AddressProviders; 
```

正如您在此处看到的，正在使用的视图是 EmailView ... 但是我需要使用组合框所在窗口的数据上下文中定义的视图。我是否需要以某种方式连接类以共享信息。如果是这样，我到底是怎么做到的。这甚至可能不是问题，但它是唯一对我有意义的事情。希望你们中的一个人能在我扔掉我的电脑之前弄清楚。再次感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:19:26.217

考虑使用[ObservableCollection](http://msdn.microsoft.com/en-GB/library/ms668604.aspx) 进行绑定，如果您已经拥有该集合，则`IEnumerable`可以轻松转换它，

```
ObservableCollection<T> obsColl = new ObservableCollection<T>(originalIEnumerable) 
```

`ObservableCollection`有一个以 a`IEnumerable`作为参数并对其进行浅拷贝的构造函数

# c - pthreads：由于 malloc 和直接声明的差异

> ID：14836679
> 
> 赞同：0
> 
> 时间：2013-02-12T16:07:24.690
> 
> 标签：c, pthreads

我在 pthreads 中制作了一个简单的程序，它通过一个结构将多个参数传递给被调用的函数。考虑这两个程序：
程序 1：

```
#include <pthread.h>
#include <stdio.h>
#include <malloc.h>

struct args{
    long long val1;
    int val2;
};

void *hello(void* threadid){
    struct args *tid;
    tid=(struct args*)threadid;
    printf("thread %lld\n",tid->val1);
    pthread_exit(NULL);
}

int main(){
    pthread_t threads[20];
    int i;
    for(i=0;i<20;i++){
        // ***** specific memory given to the struct *****
        struct args* a1=(struct args*)malloc(sizeof(struct args));    
        a1->val1=i;
        a1->val2=i+1;
        int ret=pthread_create(&threads[i],NULL,hello,(void*)a1);
        if(ret){
            printf("error code %d for %d\n",ret,i);
        }
    }
    pthread_exit(NULL);
} 
```

它按预期打印输出，一些排列`0..19`

另一方面，考虑程序 p2

```
#include <pthread.h>
#include <stdio.h>

struct args{
    long long val1;
    int val2;
};

void *hello(void* threadid){
    struct args *tid;
    tid=(struct args*)threadid;
    printf("thread %lld\n",tid->val1);
    pthread_exit(NULL);
}

int main(){
    pthread_t threads[20];
    int i;
    for(i=0;i<20;i++){
        // ***** struct made like normal declarations *****
        struct args a1;
        a1.val1=i;
        a1.val2=i+1;
        int ret=pthread_create(&threads[i],NULL,hello,(void*)&a1);
        if(ret){
            printf("error code %d for %d\n",ret,i);
        }
    }
    pthread_exit(NULL);
} 
```

这个程序有重复和不完整的条目，比如

```
thread 3
thread 5
thread 3
thread 4
thread 3
thread 6
thread 7
thread 8
thread 9
thread 10
thread 11
thread 12
thread 13
thread 15
thread 15
thread 16
thread 17
thread 18
thread 19
thread 19 
```

为什么结构的实例化直接导致这种重叠？C不应该为循环中的每次提供一个新的内存块吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:12:57.873

在您的第二个示例中，在循环`a1`中声明了自动存储持续时间。`for`这意味着在每次迭代结束时，该存储位置*可以*重新用于下一次迭代。所以：

```
int ret=pthread_create(&threads[i],NULL,hello,(void*)&a1); 
```

...您*可能会将*地址 ( `&a1`) 传递到将在后续迭代中修改的内存位置。`malloc`另一方面，将在每次迭代时分配一个指向不同内存位置的指针。

由于无法保证线程是否会在下一次迭代开始之前或之后执行，因此每次运行上述代码时实际上可能会得到不同的结果。

此外，`malloc`在不将指针存储在任何地方或在线程中释放它们的情况下使用将导致内存泄漏。在所有线程完成之前，您的结构也可能超出范围，结果是它们访问了一个悬空指针。最后，由于您没有加入任何线程，因此不知道在程序退出之前有多少线程会真正完全执行。

欢迎来到多线程的奇妙世界。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:10:17.347

您的第二个示例将为循环的每次迭代获取一个新实例，`a1`但这很可能指向所有先前迭代使用的相同内存。

无法保证何时或多长时间会安排线程，因此您无法确定在运行时是否（以及多久）`a1`会更新`hello`。这意味着打印出的值将在 [0, 20) 范围内，但在其他方面将是不可预测的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T16:14:22.203

C 可能不会为循环内声明的变量提供新的内存块。可以使用相同的存储器。您看到重叠输出的原因是因为相同的内存区域应该主要传递给所有线程，并且它也同时在主线程中得到更新。尽管您声明了一个新变量，但新变量没有必要获得一个新的内存块。内存块可以重复使用。这是无法预测的。

此外，这种编码是危险的，因为一旦循环结束，变量将超出范围，当其中一个线程尝试访问它时，这也可能导致未定义的行为。

要确定是否分配了相同的内存，您为什么不尝试打印您传递给每个线程中的线程的 a1 的地址。这将提供最好的清晰度。

# javascript - 返回或重定向到 url

> ID：14836680
> 
> 赞同：0
> 
> 时间：2013-02-12T16:07:24.527
> 
> 标签：javascript, jquery, html

我一直在使用后退按钮让用户导航回他们来自的页面，问题是，如果用户在新选项卡或直接链接中导航到那里，因为他们在被重定向之前没有“去过任何地方”回到空白页。

有解决方案吗？如果可能的话，我正在考虑类似导航，如果不是，它会将您带到特定的网址。

这是我到目前为止所拥有的：

```
<a href="#" onclick="history.go(-1);return false;">Go back</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:23:56.927

怎么用[`document.referrer`](http://www.w3schools.com/jsref/prop_doc_referrer.asp)？
这是一个黑客，我不推荐它，因为你不会维护帖子数据（如果有的话）。如果您的页面不需要重新发布任何数据，那么这应该可以。

```
<a id="mylink" href="#">Go back</a> 
```

```
$('#mylink').click(function () {
    if (history.length == 0) {
        document.location = document.referrer;
    } else {
        history.go(-1);
    }
}); 
```

我必须说我同意[SchautDollar 的评论](https://stackoverflow.com/questions/14836680/go-back-or-redirect-to-url/14837037#comment20789559_14836680)——消息是一个更好的警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:25:23.067

如果您使用的是 php，则可以将链接更改为：

```
echo '<a href="'. $_SERVER['HTTP_REFERER'] . '">Go back</a>'; 
```

如果没有，你可以用 jQuery 和 javascript 做同样的事情

```
document.location = document.referrer; 
```

关于链接点击方法。

# django - 字典作为模型字段

> ID：14836683
> 
> 赞同：6
> 
> 时间：2013-02-12T16:07:28.027
> 
> 标签：django, django-models, python-2.7, django-admin

我想向`dict`模型添加一个字段，`dict`在管理员上显示，并能够从管理员中编辑它。

例如，我有一个关系

`dict = { 'sister' : rel_score, 'mother' : rel_score, 'father': rel_score}`

其中`rel_score`(default = 0) 是每个关系的分数。我想将它存储`dict`到我的模型中并在管理员中显示，以便我可以为我的管理员上的每个关系分配这些 rel_score。

此外，如何为不同元素分配分数（优先级）并根据这些分配的分数返回值的任何示例都将非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-20T07:59:41.793

拥有 DictField 是不可能的，因为底层数据库不支持这种类型的数据结构。

您可以有一个RelationshipScore 模型来存储您的关系和一个ForeignKey 从它到您现有的模型（我将使用用户作为示例）。例如：

```
Class RelationshipScore(models.Model):
    user = models.ForeignKey(User)

    relationship = models.CharField(max_length=50, primary_key=True)
    score = models.IntegerField() 
```

然后，您可以将函数添加到现有模型以获取值：

```
class User(models.Model):
    def get_relationship(self, rel):
        return RelationshipScore.objects.get(relationship=rel, user=self)
    def get_lowest_relationship(self):
        return RelationshipScore.objects.filter(user=self).order_by("-score")[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-25T21:21:19.197

从 Django 1.8 开始，postgres 用户还可以选择使用[HStore 字段](https://docs.djangoproject.com/es/1.9/ref/contrib/postgres/fields/#hstorefield)。

```
A field for storing mappings of strings to strings. The Python data type used is a dict. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-20T17:18:01.873

Postgres 用户可以轻松使用 jsonfield：

```
from django.db import models

from django.contrib.postgres.fields import JSONField
import json

class Yourmodel(models.Model):
    name = models.CharField()
    dict_json = JSONField(blank=True, null=True)
    def __str__(self):              
        return self.name 
```

并在您的应用程序中：

```
the_dict = {'a':1,'b':2}
Yourmodel.dict_json = json.dumps(the_dict)
Yourmodel.save() 
```

[https://docs.djangoproject.com/es/1.9/ref/contrib/postgres/fields/#jsonfield](https://docs.djangoproject.com/es/1.9/ref/contrib/postgres/fields/#jsonfield)

# typo3 - tt_news 中的日期格式

> ID：14836687
> 
> 赞同：0
> 
> 时间：2013-02-12T16:07:35.240
> 
> 标签：typo3, typoscript, tt-news

我使用 tt_news 版本 3.4.0，我想更改新闻的日期格式，例如：2013 年 9 月

有谁能够帮助我 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T19:12:17.407

尝试...

```
plugin.tt_news {
  displayList.date_stdWrap.date = j F Y
  displayLatest.date_stdWrap.date = j F Y
  displaySingle.date_stdWrap.date = j F Y
} 
```

...或者...

```
plugin.tt_news {
  displayList.date_stdWrap.strftime = %e %B %Y
  displayLatest.date_stdWrap.strftime = %e %B %Y
  displaySingle.date_stdWrap.strftime = %e %B %Y
} 
```

# ruby-on-rails - 我应该在哪里放置自定义可执行文件在 Rails 项目中

> ID：14836689
> 
> 赞同：5
> 
> 时间：2013-02-12T16:07:39.987
> 
> 标签：ruby-on-rails, ruby

我一直在使用 bin/ 来放置我的各种 bash 脚本。我记得读到这是不正确的`bundle install --binstubs`，因为它与我们自己的 bash 脚本混合会造成混淆（甚至可能会覆盖，从而导致冲突）。

我隐约认为正确的答案是 script/，但我认为这也可能不对。

显然“答案”并不重要，但如果有一个标准的位置，我认为使用它是有意义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:39:07.487

对此似乎没有“正确”的答案。这是我过去多次寻找的东西，但我从来没有满足于将某些东西视为公认的标准。

在实践中，我已经看到二进制文件放置在`script/`（你真的认为整个目录应该只有一个文件吗？），`lib/script`（我可以看到这背后的逻辑，适合其他类似“lib”的东西），`lib/<various subdirectories>`（更多 -有组织地使用`lib/`) 或重写为 rake 任务 ( `lib/tasks`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:35:11.950

我在 bundler 中寻找它，发现了这个问题： [https ://github.com/carlhuda/bundler/issues/1250](https://github.com/carlhuda/bundler/issues/1250)

他们很遗憾 binstubs 可以取值，因此您可以将 binstubs 指向其他地方。所以解决方案与您的想法相反，您将 binstubs 指向另一个路径并将脚本保存在 /bin 中。

```
 bundle install --binstubs some_value 
```

# c++ - 使用 shared_ptr.reset 还是 operator = 更好？

> ID：14836691
> 
> 赞同：36
> 
> 时间：2013-02-12T16:07:42.400
> 
> 标签：c++, c++11, shared-ptr

我正试图围绕 C++11 的新习语展开思考。

似乎至少使用 shared_ptr ，使用`new T()`和之间存在实质性区别`make_shared<T>()`。

但是如何重置共享指针以指向某事物的新实例。以前，我通常会使用`reset(new T())`member。但是，这不会遇到与一开始不使用 make_shared() 相同的问题吗？（即它不允许 make_shared 分配对象，因此它被迫将引用计数放在单独的分配中，而不是与 T 本身放在相同的分配中？）

继续使用是否会更好：

```
 mysharedptr = make_shared<T>(args...); 
```

或者，还有更好的方法？

并且不应该像 make_shared 那样重置提供参数的可变参数转发，以便可以编写 mysharedptr.reset(args...);？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-12T16:36:05.697

两者之间确实存在很大差异：

```
shared_ptr<T> sp(new T()); 
```

和：

```
shared_ptr<T> sp = make_shared<T>(); 
```

第一个版本为`T`对象执行分配，然后执行单独的分配以创建引用计数器。第二个版本对对象和引用计数器执行一次分配，将它们放置在连续的内存区域中，从而减少内存开销。

此外，一些实现能够在以下情况下执行进一步的空间优化`make_shared<>`（请参阅 MS 的实现完成的“我们知道你住在哪里”优化）。

然而，这并不是存在的唯一原因`make_shared<>`。在某些情况下，基于显式的版本`new T()`不是异常安全的，尤其是在调用接受`shared_ptr`.

```
void f(shared_ptr<T> sp1, shared_ptr<T> sp2);

...

f(shared_ptr<T>(new T()), shared_ptr<T>(new T())) 
```

在这里，编译器可以计算第一个`new T()`表达式，然后计算第二个`new T()`表达式，然后构造相应的`shared_ptr<>`对象。但是，如果第二个分配在第一个分配的对象绑定到它之前导致异常`shared_ptr<>`怎么办？它会被泄露。使用`make_shared<>()`，这是不可能的：

```
f(make_shared<T>(), make_shared<T>()) 
```

因为分配的对象绑定到`shared_ptr<>`每个函数调用中的相应对象`make_shared<>()`，所以这个调用是异常安全的。`new`这也是为什么除非你真的知道自己在做什么，否则永远不应该使用裸体的另一个原因。(*)

考虑到您对 的评论`reset()`，您正确地观察到它将为计数器和对象执行单独的分配，就像当原始指针作为参数传递时`reset(new T())`new 的构造将执行单独的分配一样。`shared_ptr<>`因此，赋值 using`make_shared<>`是更可取的（甚至是诸如 之类的语句`reset(make_shared<T>())`）。

无论是否`reset()`应该支持可变参数列表，这可能更像是一种开放式讨论，StackOverflow 不适合。

(*) 有一些情况仍然需要它。例如，C++ 标准库缺少对应的`make_unique<>`函数`unique_ptr`，因此您必须自己编写一个。另一种情况是当您不希望将对象和计数器分配在单个内存块上时，因为指向对象的弱指针的存在将阻止*整个*块被释放，即使不再存在指向该对象的拥有指针.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T16:41:13.450

正确，`reset(new T...)`遭受所有问题`shared_ptr(new T...)`；这将导致双重分配并且也是非异常安全的（泄漏的可能性不大，除非`bad_alloc`发生在`reset`）。

`reset`记录为等效于`shared_ptr<T>(ptr).swap(*this)`，因此您也可以编写：

```
make_shared<T>(args...).swap(mysharedptr); 
```

赋值 from`make_shared<T>`几乎是等价的，唯一的区别是删除旧的`T`和销毁临时的的相对顺序`shared_ptr`，这是不可观察的。

# repository - 删除 bitbucket 中的最后一次提交

> ID：14836696
> 
> 赞同：120
> 
> 时间：2013-02-12T16:07:52.183
> 
> 标签：repository, bitbucket

我犯了一个错误，我不知道如何删除我在存储库中的最新推送。我拉取了应用程序的最新更新，但它有冲突，我将它推送到存储库。

如何删除我的最后一次提交？或者如何解决？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-02-13T16:39:13.337

首先，如果您与其他人在同一个代码存储库上工作，则**不应**删除提交，因为当您强制对存储库进行更新时，它将使您同事的本地存储库处于非法状态（例如，如果他们在您删除的提交之后进行提交，这些提交将无效，因为它们基于现在不存在的提交）。

就是说，您可以做的是**还原**提交。根据您使用的 CVS，此过程的执行方式不同（不同的命令）：

在[git](http://gitready.com/intermediate/2009/03/16/rolling-back-changes-with-revert.html)上：

```
git revert <commit> 
```

在[mercurial](https://www.mercurial-scm.org/wiki/Backout)上：

```
hg backout <REV> 
```

**编辑：** 还原操作创建一个与还原提交相反的新提交（例如，如果原始提交添加了一行，则还原提交删除该行），有效地删除了不需要的提交的更改，而无需重写存储库历史记录。

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2014-09-01T04:18:53.510

**如果您*不*与其他人一起工作（或者很乐意给他们带来很大的烦恼）**，那么可以从 bitbucket 分支中删除提交。

### 如果您尝试更改非主分支：

```
git reset HEAD^               # remove the last commit from the branch history
git push origin :branch_name  # delete the branch from bitbucket
git push origin branch_name   # push the branch back up again, without the last commit 
```

### 如果您尝试更改主分支

一般来说，在 git 中，master 分支并不特殊——它只是一个约定。但是，bitbucket 和 github 以及类似的站点通常需要有一个主分支（大概是因为它比编写更多代码来处理存储库没有分支的事件更容易 - 不确定）。因此，您需要创建一个新分支，并将其设为主分支：

```
# on master:
git checkout -b master_temp  
git reset HEAD^              # undo the bad commit on master_temp
git push origin master_temp  # push the new master to Bitbucket 
```

在 Bitbucket 上，转到存储库设置，并将“主分支”更改为`master_temp`（在 Github 上，更改“默认分支”）。

```
git push origin :master     # delete the original master branch from Bitbucket
git checkout master
git reset master_temp       # reset master to master_temp (removing the bad commit)
git push origin master      # re-upload master to bitbucket 
```

现在转到 Bitbucket，您应该会看到您想要的历史记录。您现在可以转到设置页面并将 Main 分支更改回`master`.

此过程也适用于任何其他历史更改（例如`git filter-branch`）。在新历史与旧历史分离之前，您只需确保重置为适当的提交。

***编辑****：显然你不需要去 github 上的所有这些麻烦，因为你可以[强制推送一个重置分支](https://stackoverflow.com/questions/448919/how-can-i-remove-a-commit-on-github/448929#448929)。*

## 与恼怒的合作者打交道

下次有人尝试从您的存储库中拉取时（如果他们已经拉取了错误的提交），拉取将失败。他们必须在更改历史记录之前手动重置为提交，然后再次拉取。

```
git reset HEAD^
git pull 
```

如果他们拉出了错误的提交，*并在它之上*提交，那么他们将不得不重置，然后`git cherry-pick`他们想要创建的好的提交，有效地重新创建整个分支而没有错误的提交。

如果他们从未拉过错误的提交，那么整个过程不会影响他们，他们可以正常拉动。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2015-08-09T18:10:53.123

你可以重置`HEAD^`然后强制推动它。

```
git reset HEAD^
git push -u origin master --force 
```

它将删除您的最后一次提交，并将在 bitbucket 上反映为提交已删除，但仍将保留在其服务器上。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2019-09-25T05:24:38.487

这是一个最多 4 个步骤的简单方法：

**0 - 建议您要修复存储库的团队**

与团队联系，让他们知道即将发生的变化。

**1 - 删除最后一次提交**

假设您的目标分支是`master`：

```
$ git checkout master              # move to the target branch
$ git reset --hard HEAD^           # remove the last commit
$ git push -f                      # push to fix the remote 
```

如果你是一个人工作，此时你就完成了。

**2 - 修复队友的本地存储库**

在你队友的：

```
$ git checkout master              # move to the target branch
$ git fetch                        # update the local references but do not merge  
$ git reset --hard origin/master   # match the newly fetched remote state 
```

如果你的队友没有新的提交，你就完成了，你应该同步。

**3 - 恢复丢失的提交**

假设一个队友有一个新的未发布的提交在这个过程中丢失了。

```
$ git reflog                       # find the new commit hash
$ git cherry-pick <commit_hash> 
```

根据需要对尽可能多的提交执行此操作。

我已经多次成功地使用过这种方法。它需要团队的努力来确保一切都是同步的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-07-08T06:45:25.363

# 这个命令对我很有效！！

就我而言，我的队友使用错误的代码完成了提交。所以无论如何我都必须恢复那个提交，所以我试图

> 运行此命令以 REVERT 提交

```
git revert [LastCommitID] 
```

在此之后，更改未反映在存储库中，因此

> 我执行了这个命令

```
git push --force origin master 
```

并且此命令通过删除最后一次提交来反映更改

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-05-24T23:15:02.773

我过去在使用 git revert 时遇到过麻烦（主要是因为我不太确定它是如何工作的。）由于合并问题，我在还原时遇到了麻烦..

我的简单解决方案是这样的。

步骤1。

```
 git clone <your repos URL> . 
```

您的项目在另一个文件夹中，然后：

第2步。

```
git reset --hard <the commit you wanna go to> 
```

然后步骤 3。

在您的最新（和主要）项目目录（最后一次提交有问题的目录）中粘贴步骤 2 的文件

第4步。

```
git commit -m "Fixing the previous messy commit" 
```

步骤 5。

享受

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-04-15T01:21:41.327

正如其他人所说，通常你想使用`hg backout`or `git revert`。然而，有时你真的想摆脱一个提交。

首先，您需要转到存储库的设置。点击`Strip commits`链接。

[![去除 bitbucket 设置中的提交链接](../Images/7413aa2825efffad42b43aaab60a0638.png)](https://i.stack.imgur.com/yRWg6.png)

输入要销毁的变更集的变更集 ID，然后单击`Preview strip`。这会让你在做之前看到你将要造成什么样的伤害。然后只需单击`Confirm`，您的提交就不再是历史了。确保你告诉所有合作者你做了什么，这样他们就不会不小心把有问题的提交推回去。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-06-24T13:05:40.483

您也可以为[Dustin](https://stackoverflow.com/a/449070/8370915)提到的 Bitbucket 编写命令：

```
git push -f origin HEAD^:master 
```

> 注意：您可以使用任何分支代替 master。它删除只是推送 Bitbucket。

要在 git 中[本地](https://stackoverflow.com/questions/1338728/delete-commits-from-a-branch-in-git)删除最后一次提交，请使用：

```
git reset --hard HEAD~1 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-24T07:50:43.407

一旦提交更改，它将无法删除。因为提交的基本性质是不删除。

您可以做的事情（简单安全的方法），

**交互式变基：**

1) `git rebase -i HEAD~2` #将显示你最近的 2 次提交

2) 你的提交将像这样列出，最近将出现在页面底部 LILO(last in Last Out)

[![在此处输入图像描述](../Images/42e1aabf1c0f0c70640879250c313e4c.png)](https://i.stack.imgur.com/kjkjI.png)

完全删除最后一个提交行

3) 通过`ctrl+X`或保存`ESC:wq`

现在您的分支将在没有您最后一次提交的情况下更新..

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-07T11:36:42.053

到目前为止，cloud bitbucket（我不确定哪个版本）允许从文件系统恢复提交，如下所示（我看不到如何从 Chrome 浏览器中的 Bitbucket 界面恢复）。

-备份您的整个目录以保护您无意中提交的更改

-选择签出目录

- 鼠标右键：乌龟 git 菜单

-repo-browser（菜单选项“revert”仅撤消未提交的更改）

- 按下 HEAD 按钮

-选择最上面一行（最后一次提交）

- 鼠标右键：通过此提交恢复更改

-在它撤消文件系统上的更改后，按提交

- 这会更新 GIT 并显示一条消息“恢复（您之前的消息）。这会恢复提交某某'

- 选择“提交并推送”。

# java - 编程重力

> ID：14836699
> 
> 赞同：-3
> 
> 时间：2013-02-12T16:07:56.500
> 
> 标签：java, simulation, game-physics, gravity, 2d-games

我正在编写游戏（JAVA），我想添加一些重力。我试图找到一个公式或类似的东西，但有很多不同的方法可以做到这一点。我正在寻找一个可以模拟真实重力并在物体接触地板时产生一些反弹的公式。对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:19:35.687

在地球表面附近，所有落体的重力加速度是恒定的（忽略空气阻力）。给定初始位置、初始（垂直）速度和物体下落的时间，该公式`xf = x0 + v0*t + (1/2)*g*t^2`将为您提供最终位置。是一个常数，在技术上取决于您的海拔高度和其他因素，但在.`xf``x0``v0``t``g``9.81 m/s`

要进行反弹，您首先需要进行一些碰撞检测。当您检测到碰撞时，您需要计算垂直于表面的矢量（如果您的表面是水平面则很容易），然后*通过*该矢量“反射”（某种程度）您的速度矢量（如果法线矢量指向直接向上，即，您正在从平坦的表面反弹，这相当于反转速度`v`）。请注意，为了实现这一点，您可能应该在反弹后应用一些阻尼：除了反映速度矢量外，您还需要缩小它（取决于它在反弹后的反射方式，这可能涉及减少一个或两个组件）。

要实际模拟这种情况，您可以使用多种技术：预先计算点列表，然后通过它们运行动画，*或者*您可以使用欧拉法或其他一些数字求积技术（梯形规则）模拟所有这些、龙格库塔等）。

# erlang - 杀死erlang应用程序时捕获

> ID：14836700
> 
> 赞同：3
> 
> 时间：2013-02-12T16:08:01.617
> 
> 标签：erlang, terminate, erlang-otp

我有erlang应用程序。我运行它，没关系，一切正常。当我用我的应用程序杀死 erlang shell 时`Ctrl+C`，我的应用程序也停止了，这是正确的行为，但我怎样才能抓住这一刻？当我的应用程序停止时，我需要清除一些资源，正常或有错误都没关系。我尝试清理资源`gen_server:terminate`，但是当我杀死 erlang shell 时它没有执行。我在哪里可以捕捉到我的应用程序停止/终止的时刻？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:24:12.840

当你这样做时，`^C`你并没有杀死 Erlang shell，而是杀死了整个 Erlang 系统，整个操作系统进程。所以在那之后所有的 Erlang 都死了。你想做什么？如果您想以受控方式关闭整个系统，请使用`init:stop/0/1`. 它将首先停止所有应用程序及其监督树，以允许行为正确终止。

# c# - WPF 附加行为错误 | 在使用 ItemsSource 之前，项目集合必须为空

> ID：14836704
> 
> 赞同：0
> 
> 时间：2013-02-12T16:08:17.050
> 
> 标签：c#, wpf

我正在尝试编写一个多选择树视图行为，但是在这样做时我收到了这个神秘的错误“在使用 ItemsSource 之前，项目集合必须为空。”

以下是我的 xaml 代码：

```
<Window x:Class="TreeView.Spike.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:Spike="clr-namespace:TreeView.Spike" 
         Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width=".5*"/>
            <ColumnDefinition Width=".5*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="40"></RowDefinition>
        </Grid.RowDefinitions>

        <TreeView ItemsSource="{Binding Nodes}" Grid.Row="0" x:Name="treeView" Grid.Column="0">
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Nodes}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Name}">                  
                    </TextBlock>
                    </StackPanel>
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
            <TreeView.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Add"></MenuItem>
                    <MenuItem Header="Delete"></MenuItem>
                </ContextMenu>
            </TreeView.ContextMenu>
            <Spike:MultipleItemSelectionAttachedBehavior AllSelectedItems="{Binding Path=AllSelectedNodes}"/>
        </TreeView>

    </Grid>
</Window> 
```

我的附加行为：

```
 public class MultipleItemSelectionAttachedBehavior:Behavior<System.Windows.Controls.TreeView>
    {
        public static DependencyProperty AllSelectedItemsProperty =
        DependencyProperty.RegisterAttached("AllSelectedItems", typeof(object), typeof(MultipleItemSelectionAttachedBehavior),
    new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault | FrameworkPropertyMetadataOptions.Inherits));

        private static readonly PropertyInfo IsSelectionChangeActiveProperty = typeof(System.Windows.Controls.TreeView).GetProperty("IsSelectionChangeActive",
          BindingFlags.NonPublic | BindingFlags.Instance);

        public object AllSelectedItems
        {
            get
            {
                return (object)GetValue(AllSelectedItemsProperty);
            }
            set
            {
                SetValue(AllSelectedItemsProperty, value);
            }
        }

        public static bool GetAllSelectedItems(DependencyObject obj)
        {
            return (bool)obj.GetValue(AllSelectedItemsProperty);
        }

        public static void SetAllSelectedItems(DependencyObject obj, bool value)
        {
            obj.SetValue(AllSelectedItemsProperty, value);
        }

        protected override void OnAttached()
        {
            base.OnAttached();
            AssociatedObject.SelectedItemChanged += AssociatedObject_SelectedItemChanged;
        }

        protected override void OnDetaching()
        {
            base.OnDetaching();
            AssociatedObject.SelectedItemChanged -= AssociatedObject_SelectedItemChanged;
        }

        void AssociatedObject_SelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
        {
            if (IsSelectionChangeActiveProperty == null) return;

            var selectedItems = new List<Node>();

            var treeViewItem = AssociatedObject.SelectedItem as Node;
            if (treeViewItem == null) return;

            // allow multiple selection
            // when control key is pressed
            if (Keyboard.IsKeyDown(Key.LeftCtrl) || Keyboard.IsKeyDown(Key.RightCtrl))
            {
                var isSelectionChangeActive = IsSelectionChangeActiveProperty.GetValue(AssociatedObject, null);

                IsSelectionChangeActiveProperty.SetValue(AssociatedObject, true, null);
                selectedItems.ForEach(item => item.IsSelected = true);

                IsSelectionChangeActiveProperty.SetValue(AssociatedObject, isSelectionChangeActive, null);
            }
            else
            {
                // deselect all selected items except the current one
                selectedItems.ForEach(item => item.IsSelected = (item == treeViewItem));
                selectedItems.Clear();
            }

            if (!selectedItems.Contains(treeViewItem))
            {
                selectedItems.Add(treeViewItem);
            }
            else
            {
                // deselect if already selected
                treeViewItem.IsSelected = false;
                selectedItems.Remove(treeViewItem);
            }

            AllSelectedItems = selectedItems;
        }
    } 
```

..和我的 ViewModel

```
public class ViewModel :NotificationObject
    {
        public ViewModel()
        {
            AllSelectedNodes = new ObservableCollection<Node>();
        }
 private ObservableCollection<Node> _allSelectedNodes;
        public ObservableCollection<Node> AllSelectedNodes
        {
            get { return _allSelectedNodes; }
            set
            {
                _allSelectedNodes = value;
                RaisePropertyChanged(() => AllSelectedNodes);   
            }
        }
} 
```

我的模型：

```
public class Node:NotificationObject
    {

        private string _name;
        public string Name
        {
            get { return _name; }
            set
            {
                _name = value;
                RaisePropertyChanged(() => Name);   
            }
        }

        private bool _isExpanded = true;
        public bool IsExpanded
        {
            get { return _isExpanded; }
            set
            {
                _isExpanded = value;
                RaisePropertyChanged(() => IsExpanded); 
            }
        }

        private bool _isSelected;

        public bool IsSelected
        {
            get { return _isSelected; }
            set
            {
                _isSelected = value;
                RaisePropertyChanged(() => IsSelected);

            }
        }

        private ObservableCollection<Node> _nodes;
        public ObservableCollection<Node> Nodes
        {
            get { return _nodes; }
            set
            {
                _nodes = value;
                RaisePropertyChanged(() => Nodes);  
            }
        }

        public static IList<Node> Create()
        {
            return new List<Node>()
                       {
                           new Node()
                               {
                                   Name = "Activity",
                                   Nodes = new ObservableCollection<Node>()
                                               {
                                                   new Node() {Name = "Company",Nodes = new ObservableCollection<Node>(){  new Node() {Name = "Company1",Existing = false}}},
                                                     new Node() {Name = "Strategy",Nodes = new ObservableCollection<Node>(){  new Node() {Name = "Strategy1"}}},
                                                        new Node() {Name = "Vehicle",Nodes = new ObservableCollection<Node>(){  new Node() {Name = "Vehicle1",Existing = false}}}
                                               }
                               }
                       };
        }
    } 
```

..和我的初始化代码：

```
 public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            var viewModel = new ViewModel();
            this.DataContext = viewModel;
            viewModel.Nodes = new ObservableCollection<Node>(Node.Create());

        }
} 
```

我不知道这里出了什么问题，你能帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:13:12.137

您缺少以下`<i:Interaction.Behaviors>`元素：

代替：

`<Spike:MultipleItemSelectionAttachedBehavior AllSelectedItems="{Binding Path=AllSelectedNodes}"/>`

为了：

```
<i:Interaction.Behaviors>
    <Spike:MultipleItemSelectionAttachedBehavior AllSelectedItems="{Binding Path=AllSelectedNodes}"/>
</i:Interaction.Behaviors> 
```

问题是 TreeView 的默认内容属性是它的`Items`属性，因此将行为的 XAML 元素放在 TreeView 元素内部而不指定`<i:Interaction.Behaviors>`Attached 属性，是告诉 WPF 您希望您的行为作为 T​​reeView 中的项目，因此尝试设置其`ItemsSource`属性时，您会收到错误消息，因为其中已经有一个 Item 。

# php - While循环存储在数组php中

> ID：14836707
> 
> 赞同：-1
> 
> 时间：2013-02-12T16:08:32.103
> 
> 标签：php

我对 php 非常陌生，我想知道是否有人可以帮助我

大家好，我想将while循环存储在数组中怎么可能？

例如代码（文本）：

```
<?php
$i=1;
while($i<=5)
  {
  echo $i . "<br>";
  $i++;
  }
?> 
```

我的要求 $store_array=[1,2,3,4,5];

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:10:04.573

使用[`range()`](http://php.net/range)：

```
$store_array = range( 1, 5); 
```

完毕！

如果您真的想使用`while`循环，则语法为：

```
$i = 1; 
$store_array = array();
while( $i <= 5)
{
     $store_array[] = $i;
     $i++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:11:35.060

```
<?php
$i=1;
$store_array= array();
while($i<=5)
  {
  echo $i . "<br>";
  array_push($store_array,$i);
  $i++;
  }
 print_r($store_array);
?> 
```

# c++ - VC C++ DLL 文件未在预期文件夹中生成以用于 VBA

> ID：14836713
> 
> 赞同：0
> 
> 时间：2013-02-12T16:08:47.693
> 
> 标签：c++, excel, debugging, vba, dll

我刚刚观看了有关如何设置 C++ DLL 文件以在 Excel VBA 中调用的视频教程。我只是做一个简单的开始。所以我打开一个新的win32项目并在应用程序向导中选择DLL和空项目并继续。然后我制作了一个 .cpp 文件和一个 .def 文件，如下所示：

square.cpp 文件：

```
double __stdcall square(double & x)
{
          return x*x;
} 
```

定义文件.def：

```
LIBRARY "square"
EXPORTS
square 
```

然后到项目属性->链接器->输入->模块定义文件：defFile.def

然后我编译。

现在，一个 .dll 文件应该出现在项目 Debug 文件夹中，但它没有。任何想法有什么问题吗？

PS我对编程还很陌生，所以尽量简单地使用术语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:13:16.493

默认情况下，VC++ 在编译项目时使用两个名为 Debug 的文件夹，一个在解决方案的目录中，另一个在项目的目录中。

首先你应该检查编译过程中是否有任何错误。如果成功，则可以继续检查**解决方案**路径中名为 Debug 的文件夹。

您只需在解决方案资源管理器中右键单击`Solution 'square' (1 project)`并选择`Open folder in Windows Explorer`. 然后进入第一个文件夹名称Debug。默认情况下，这是 VC++ 存储最终可执行文件的地方。位于项目目录中的另一个 Debug 文件夹仅用于存放中间文件。

# ios - 如何在 iOS 上使用 OpenSSL 库制作 CSR

> ID：14836716
> 
> 赞同：2
> 
> 时间：2013-02-12T16:09:00.307
> 
> 标签：ios, xcode, include, openssl

我在 iOS 上创建 CSR 时遇到了困难。我将如何实际使用该库将我们自己的信息输入到 CSR 中。

什么 C 代码会为 iOS 产品生成保存的 csr 文件？

# java - 从 Java 创建 C 代码

> ID：14836721
> 
> 赞同：3
> 
> 时间：2013-02-12T16:09:15.017
> 
> 标签：java, c, code-generation, libraries

我想从 Java 创建一些简单的 C 代码，我想知道是否有一些库可以帮助我。可悲的是，我的谷歌技能不太好，我的结果也很差。（“Java 的 C 库”、“在 java 中创建 c 代码”等）。

我的想法类似于创建 C 文件并使用方法 `createMethod(name, argument, return, code)`，而不必只创建一个文档并编写类似的字符串

```
return name(argument) {
   code
} 
```

尽管如此，我还是有点悲观，我认为很可能我只需要通过创建一个文档来创建 C 代码，然后将 c 行写入其中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:17:05.563

可以使用[JCodeModel](http://codemodel.java.net/nonav/apidocs/com/sun/codemodel/JCodeModel.html)创建 (Java) 源代码。您可以创建自己的 C 目标 API 来模仿 JCodeModel API。甚至可能扩展 JCodeModel 类。

# php - 协助 php 中嵌套循环的逻辑

> ID：14836723
> 
> 赞同：0
> 
> 时间：2013-02-12T16:09:21.560
> 
> 标签：php, loops, nested, logic, nested-loops

假设我有 8 个 php 对象，我需要遍历它们并根据它们的位置不同地将各种信息输出到 html 中。我已经开发了 css 和 html 的结构，你可以在这里看到它：http: [//jsfiddle.net/v3qcc/9/](http://jsfiddle.net/v3qcc/9/) 我只需要动态放置它们的逻辑方面的帮助。

我需要取每两个对象并将它们放在这个包装器中：

```
<div class="col">
    <div class="third">
        <div class="col-content">         
          **...Object One Here**
        </div>
    </div>

    <div class="fourth">
        <div class="col-content">         
          **...Object Two Here**
        </div>
    </div>
</div>

<div class="col">
    <div class="third">
        <div class="col-content">         
          **...Object Three Here**
        </div>
    </div>

    <div class="fourth">
        <div class="col-content">         
          **...Object Four Here**
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:42:54.297

```
// heres a class
class thing {
public $ybob = 23;
}

// create an array of 8 of them
$i = 0;
$a= array();
while(8> $i){
$a[$i] = new thing;
$i++;
}
//var_dump($a);

// loop thru the array of objects
$rows = 1;
foreach($a as $ob){

// use modulus operator to work out if a row is odd or even
echo ( ($rows % 2)  === 1 ) ?  '<br />NEW ROW' : '' ;
echo $ob->ybob . ' - ' ;  // output the objects data in any case
$rows++;
} 
```

在 4 行以上的三元运算符中，您可以添加额外的行标记，或者如果您想使用更多行标记，则可以还原 if/else。

给出：

```
NEW ROW 23 - 23 - 
NEW ROW 23 - 23 - 
NEW ROW 23 - 23 - 
NEW ROW 23 - 23 - 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:05:21.457

试试这个 ：

```
<?php

echo '<div class="col">';

for ($i=0; $i<$max_elements; $i++)
{
    $class = ($i&1) ? "third" : "fourth";

    echo '<div class="'.$class.'">
              <div class="col-content">         
               **...Object num : '.$i.' Here**
              </div>
         </div>';
}

echo '</div>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:31:03.153

个人而言，我将在循环中测试一个每次递增的指标，如果它是偶数或奇数，并根据此显示模板需要。

# python - 如何使用 Squish 查找 qml 元素的 id 属性？

> ID：14836726
> 
> 赞同：1
> 
> 时间：2013-02-12T16:09:26.190
> 
> 标签：python, qt, qml, squish

我被分配了自动化 qml 程序的任务。我对 python 和 Squish 都很陌生。我试图找到一种方法来获取文本元素的 id 属性，例如：

```
Text{
id:testLabel
text:"Hello"
} 
```

所以在 Squish 中捕获我得到的对象（通过 Spy）

```
waitForObject(":GAMES.Hello_Text") 
```

但相反，我想将其捕获为

```
waitForObject(":GAMES.testLabel_Text") 
```

这有可能实现吗？如果不是，我可以采取哪些其他方法。

**注意**：我需要比较不同语言的文本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T18:53:25.380

**诊断**

我认为您将“真实姓名”与“象征性名称”混淆了。我建议查看[Squish](http://www.froglogic.com/squish/gui-testing/)[关于 objects map](http://doc.froglogic.com/squish/latest/rg-objectmap.html)的官方文档，但我的理解是 Squish 符号名称（以冒号开头的名称）本质上等同于变量名称。它们是用于在 objects.map 中查找标识符的键。

objects.map 包括符号名称和 Squish 所指的“真实名称”。真实名称是一种匹配模式，可用于查找 Qt 对象。例如，您的 objects.map 文件中可能有如下所示的行：

```
:GAMES.Hello_Text    {name='Hello_Text' type='QLineEdit' visible='1' window=':GAMES'}
:GAMES.testLabel_Text    {name='testLabel_Text' type='QLineEdit' visible='1' window=':GAMES'} 
```

如您所见，这表明 ":GAMES.Hello_Text" 和 ":GAMES.testLabel_Text" 都是 ":GAMES" 窗口中的 QLineEdit 字段（它本身是一个符号名称，在 objects.map 的其他地方具有真实规范）。

**潜在的解决方案**

要获得全面帮助，我建议您从您的 objects.map 中发布相关条目。相关条目将是您感兴趣的对象的条目，并且可能是它们的直接父项。

需要注意的是，我不确定您到底需要什么，如果您要在“:GAMES”符号名称指定的对象中查找任意和以编程方式确定的元素，这里有三种方法。

**1.** *查找父对象并检查其属性*

```
games = waitForObject(":GAMES")
mytext = games.testLabel_Text 
```

**2.** *查找父对象的属性*

```
mytext = waitForObjectAttribute(":GAMES", "testLabel_Text") 
```

注意，在这种情况下，“testLabel_Text”是一个任意文本字符串，它引用由“:GAMES”符号名称指定的对象的属性。你可以认为`waitForObjectAttribute()`它类似于 Python 内置的`getattr()`.

**3.** *使用真实姓名查找所需信息*

```
mytext = waitForObject("{name='testLabel_Text' type='QLineEdit' visible='1' window=':GAMES'}") 
```

# jquery - 与 iframe 交互（我得到“权限被拒绝”）

> ID：14836730
> 
> 赞同：0
> 
> 时间：2013-02-12T16:09:37.923
> 
> 标签：jquery, iframe

我正在尝试在我的网页中加入演讲。为此，我尝试使用指向[http://text-to-speech.imtranslator.net/](http://text-to-speech.imtranslator.net/)的 iframe， 我计划使其不可见，因此它不会影响布局，然后与 javascript 交互以设置值的文本区域并单击按钮使其说话。

这里的答案说要做“myframes.window.getDocumentById”。但是，使用 window/getDocumentById 会导致访问该属性时“权限被拒绝”。可能是网站/浏览器（我使用 firefox）禁用了此类交互吗？还是我只是做错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:10:52.937

如果 IFRAME 位于其他域名中，则您无法访问该文件。

如果您可以控制在 iframe 中打开的网站，则可以使用以下方法：

```
http://stackoverflow.com/questions/6460200/can-cross-origin-resource-sharing-headers-authorize-x-domain-iframe-access 
```

# sql-server - 带有浮点数的 SQL Server 日期数学（如 Oracle 中的 sysdate + 1.4793625 天）

> ID：14836731
> 
> 赞同：1
> 
> 时间：2013-02-12T16:09:41.803
> 
> 标签：sql-server

将数据库从 Oracle 转换为 SQL Server。我需要类似于 Oracle 让我处理日期的东西：

```
... WHERE tbl.date_col < sysdate - 1.234 
```

其中 float 代表小数天数（将传入 float 值）。

DATEADD 只接受整数作为第二个参数，所以这不起作用。提前做一些数学然后有

```
DATEADD(year, ?, DATEADD(month, ?, DATEADD(day, ?, DATEADD(hour, ?, 
  DATEADD(well, you get the picture))))) 
```

请告诉我有一个更优雅和可读的解决方案。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:18:29.507

SQL Server 正在完全放弃此功能。例如，您可以说：

```
SELECT GETDATE() + 1; 
```

但是您不能再使用较新的日期/时间类型来执行此操作，例如：

```
SELECT CONVERT(DATE, GETDATE()) + 1; 
```

产量：

> 消息 206，级别 16，状态 2，第 1 行
> 操作数类型冲突：日期与 int 不兼容

So I strongly recommend stop using `FLOAT` and shorthand date math for this. If you are trying to subtract some fractional number of days, convert it to the most important granularity first, and then use `DATEADD` with that granularity. e.g. the following works just fine:

```
WHERE tbl.date_col < DATEADD(SECOND, 86400*-1.234, GETDATE()); 
```

# javascript - 使用 WebkitGTK 泄漏

> ID：14836733
> 
> 赞同：1
> 
> 时间：2013-02-12T16:09:44.270
> 
> 标签：javascript, c, webkit, webkitgtk

我正在尝试使用 WebkitGTK。使用一个简单的“hello world”风格的应用程序，它只下载一个网页然后退出，WebKit 在运行程序后报告泄漏的对象：

```
LEAK: 1 CachedResource
LEAK: 12 WebCoreNode 
```

WebkitGTK 程序是一个简单的 C 程序：

```
#include <gtk/gtk.h>
#include <webkit/webkit.h>
#include <stdio.h>

static void load_status_callback(GObject* object, GParamSpec* pspec, void* window)
{
        WebKitWebView* view = WEBKIT_WEB_VIEW(object);
        WebKitLoadStatus status = webkit_web_view_get_load_status(view);

        switch (status) 
        {
            case WEBKIT_LOAD_FINISHED:
            {
                printf("WEBKIT_LOAD_FINISHED\n");
                gtk_main_quit();
                break;
            }
            default: g_assert_not_reached();
        }
};

int main(int argc, char* argv[])
{
    gtk_init(&argc, &argv);
    GtkWidget *main_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
    gtk_window_set_default_size(GTK_WINDOW(main_window), 800, 600);
    WebKitWebView *webView = WEBKIT_WEB_VIEW(webkit_web_view_new());

    GtkWidget *scrolledWindow = gtk_scrolled_window_new(NULL, NULL);
    gtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(scrolledWindow),
    GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);
    gtk_container_add(GTK_CONTAINER(scrolledWindow), GTK_WIDGET(webView));
    g_signal_connect(webView, "notify::load-status", G_CALLBACK(load_status_callback), main_window);
    gtk_container_add(GTK_CONTAINER(main_window), scrolledWindow);

    webkit_web_view_load_uri(webView, "http://127.0.0.1/test.html");
    gtk_widget_grab_focus(GTK_WIDGET(webView));
    gtk_widget_show_all(main_window);

    gtk_main(); // Run main event loop

    gtk_widget_destroy(main_window);

    return 0;
} 
```

我下载的 HTML 很简单：

```
<html>
<head>
<script type = "text/javascript"></script>
</head>
<body>
<div id = "foo"></div>
</body>
</html> 
```

经过一些实验，我观察到如果我删除标签就不会发生泄漏`<script>`，这让我相信我应该做一些事情来关闭 JavaScriptCore。那么，为什么 WebKit 会报告泄漏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-03T03:23:30.400

这不是您在代码中做错的任何事情。您的问题是您正在使用 WebKit 的调试版本，因此它报告了 WebKit 错误：应该在 WebKit 内部修复的内存泄漏。

您应该切换到使用 WebKit 的发布版本，除非您实际上是在尝试调试特定的东西。调试构建速度较慢，并且在启用断言的情况下运行，实践使它们比发布构建更频繁地崩溃。

# css - 带有循环编号的有序列表

> ID：14836737
> 
> 赞同：0
> 
> 时间：2013-02-12T16:09:51.753
> 
> 标签：css, fonts, font-face

我正在尝试使用 CSS 设置有序列表的样式，并使用圆形背景上的数字字体，因此试图在黑色背景上找到每个设置为白色/透明数字的 1234567890 的字体。

任何人都可以推荐一种字体吗，我在 dafont.com 之类的网站上磕磕绊绊，但对于我的生活，不能偶然发现实际数字 0-9 映射到光盘上的数字的字体？

像 Wingdings 这样的字体确实包含这些四舍五入的数字，但它们位于完全不同的字符上，而不是数字本身，因此无法用于有序列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:24:23.747

如果您找不到符合您希望的字体，这可能会有所帮助...

[http://jsfiddle.net/H5Xyz/](http://jsfiddle.net/H5Xyz/)

```
<ul>
    <li><span>1</span></li>
    <li><span>2</span></li>
    <li><span>3</span></li>
    <li><span>4</span></li>
    <li><span>5</span></li>
    <li><span>6</span></li>
    <li><span>7</span></li>
    <li><span>8</span></li>
    <li><span>9</span></li>
</ul>

ul > li {
    list-style-type: none;
    margin: 0 0 0 25px;
}

ul > li > span {
    display: table-cell;
    vertical-align: middle;
    width: 30px;
    height: 30px;
    border-radius: 25px;
    background: #000;
    text-align: center;
    color: #fff;
} 
```

# vb.net - 悬停时设置面板背景色

> ID：14836738
> 
> 赞同：2
> 
> 时间：2013-02-12T16:09:53.943
> 
> 标签：vb.net, vb.net-2010

我正在以编程方式创建一个`Panel`with `labels`and in it。`pictureboxes`

我想做的是，每当鼠标*悬停时，背景色将设置为 Steelblue*，并且每当**MouseLeave**发生**时**，背景色都会设置回透明`Panel``Panel`

 ***我的问题是，每当我将 a或 a的**子**项**悬停**时，我都会失去背景色，因为代码将其视为.`Panel``Label``Picturebox`**`Panel`**

 **因此，我试图做一个功能，每当我 **悬停**一个孩子时，`Panel`它会将背景色设置`Panel`为*SteelBlue*。

现在的问题是，BackColor 闪烁，因为每当我悬停 a`Label`或 a`Picturebox`时，它都认为这是一个**MouseLeave**事件`Panel`

在我真正*离开*边界之前，如何使 BackColor`Panel`保持不变？*`Panel`*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:19:11.143

您可以使用`MouseMove`事件并检查表单上的位置：

```
Sub Panel1_MouseEnter(sender As Object, e As EventArgs) Handles Panel1.MouseEnter
    Panel1.BackColor = Color.SteelBlue
End Sub

Sub Form1_MouseMove(sender As Object, e As MouseEventArgs) Handles Me.MouseMove
    If Not Panel1.Bounds.Contains(e.Location) Then
        Panel1.BackColor = SystemColors.Control
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:20:48.730

我不知道这样做的真正简单方法。最好的方法是创建一个继承自 Panel 控件的新控件。如果这样做，则可以覆盖该`OnMouseLeave`方法，如下所示：

```
Protected Overrides Sub OnMouseLeave(e As EventArgs)
    If Not Me.ClientRectangle.Contains(Me.PointToClient(Control.MousePosition)) Then
        MyBase.OnMouseLeave(e)
    End If
End Sub 
```******

# c - 警告：非法将指针转换为带有字符和结构的整数到字符串

> ID：14836739
> 
> 赞同：0
> 
> 时间：2013-02-12T16:09:57.543
> 
> 标签：c, microcontroller, mplab

我有一个非常烦人的问题...

我必须能够将结构中的一些文本显示到微控制器的 LCD 显示器上。

这些是受影响的地区：

```
struct menu_id {
    char id;
    char menu[11];
    char submenu;
};

void main (void){
    struct menu_id mainmenu[5] = {
    {0, "CHNL1", 1},
{0, "CHNL2", 2},
{0, "Mal Codes", 3},

{1, "CHNL1...", 0},
{2, "CHNL2...", 0},
};

    print(mainmenu[0].id, mainmenu[0].menu);
}

void print (char line1, char line2)
{
    char temp[11];

    LCD_Register_Com();                                                      //Set to Command Register
    OutputChar(LCD_Line0);                                                  //Line 0,0
    LCD_Register_Data();                                                    //Set to Data Register
    sprintf(temp, "%c", line1);
    OutputString(temp);

    LCD_Register_Com();                                                     //Set to Command Register
    OutputChar(LCD_Line1);                                                  //Line 1,0
    LCD_Register_Data();                                                    //Set to Data Register
    sprintf(temp, "%c", line2);
    OutputString(temp);
} 
```

每次我尝试构建代码时，它都会抛出此错误 Main_Test.c:108: 警告：当我调用打印函数时，指针非法转换为整数，“print(mainmenu[0].id, mainmenu[0].menu );"。

任何帮助将非常感激。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:11:57.267

```
void print (char line1, char line2) 
```

改成

```
void print (char line1, char* line2) 
```

和

```
sprintf(temp, "%c", line2); 
```

到

```
sprintf(temp, "%s", line2); 
```

和

```
mainmenu[0].menu 
```

您正在将字符串而不是 char 传递给函数。

```
struct menu_id {
    char id;
    char menu[11];  <- string
   char submenu;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:12:08.790

在你的函数声明`void print (char line1, char line2)`中，`line2`应该是类型`char *`，因为菜单是一个字符数组

# android - 某些 Android 设备上缺少 Heart ❤ 符号

> ID：14836741
> 
> 赞同：6
> 
> 时间：2013-02-12T16:10:00.527
> 
> 标签：android, unicode, symbols

我在我的[android 小部件](https://play.google.com/store/apps/details?id=com.artemzin.android.love)中使用 ❤ 符号，但在某些 Android 2.x 设备和 Android 2.x 模拟器上，我得到了一个像这样的方形符号 □ 而不是 ❤</p>

你会向我推荐什么？我正在考虑使用带有该符号的自定义字体...

可能有些公司只是从系统字体中删除了不必要的符号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T16:14:01.767

好吧，我只是加载自定义字体，甚至可能是以后设备中使用的默认 android 字体的较新版本...或者您甚至可以根据您的工作和目标而摆脱显示图片.. .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:00:59.770

Android 附带的字体似乎不包含心形符号；即使是额外收费的[Droid Sans Pro](http://www.droidfonts.com/info/droid-sans-fonts/)字体也没有。

如果您只需要一个普通字体未涵盖的特殊字符，则最好使用图像。创建一个带有大尺寸符号的图像（例如，普通文本字体大小的 5 或 10 倍），然后使用缩小来复制文本大小。

有包含“❤”字符的免费字体，但使用一种字体（通常是大字体，需要以不同的字体格式提供服务）只是为了显示一个符号听起来毫无意义。

# sql - 找不到正确的查询

> ID：14836742
> 
> 赞同：0
> 
> 时间：2013-02-12T16:10:02.170
> 
> 标签：sql

对不起，我的英语不好。我必须检索所有值为 evalWaarde 3 的记录，同时它们必须同时属于 agLkrid 1、293​​5 和 2932。我知道 (1,2932,2935) 中的 agLkrid 不是一个好的解决方案但我没有找到另一个。所以实际上只有一条记录：WJLUITV015 有帮助吗？

SELECT agClid, aglkrid, evalWaarde FROM Agenda2 作为 JOIN evaluaties2 作为 e ON a.agclid = e.evalclid 和 agLkrid = evallkrid WHERE（agSchoolid='18' and agclid like 'WJLUI%' and agLkrid in (1,2932,2935)和 agDatum >= '2013/01/01' 和 agDatum <= '2013/02/12' AND (evalWaarde = 3)) 按 agclid、aglkrid、evalWaarde 分组

agClid agLkrid evalWaarde WJLUIAT005 1 3 WJLUIBV005 1 3 WJLUIDV010 1 3 WJLUIDV030 1 3 WJLUITV015 1 3 WJLUIBV005 2932 3 WJLUITV015 2932 3 WJLUITV015 2935 3 WJLUITV02

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:13:36.500

我想你想要这样的东西使用`GROUP BY`and `HAVING`：

```
SELECT agClid, evalWaarde 
FROM agenda2 as a 
    JOIN evaluaties2 as e 
        ON a.agclid = e.evalclid and agLkrid = evallkrid 
WHERE agSchoolid='18' 
    and agclid like 'WJLUI%' 
    and agLkrid in (1,2932,2935) 
    and agDatum >= '2013/01/01' 
    and agDatum <= '2013/02/12' 
    AND evalWaarde = 3
GROUP BY agclid, evalWaarde
HAVING COUNT(DISTINCT agLkrid) = 3 
```

如果该表中的这些字段存在唯一约束，则不需要`DISTINCT`in 。`COUNT`

而且我不确定`JOIN`其他`WHERE`标准——我假设这对你来说是正确的，你的问题是关于 agLkrid 的。

这是一个只有一个表返回单个结果的[SQL Fiddle 。](http://sqlfiddle.com/#!2/171d9/1)还有那个查询：

```
SELECT agClid, evalWaarde 
FROM agenda2 
WHERE agclid like 'WJLUI%' 
    and agLkrid in (1,2932,2935) 
    AND evalWaarde = 3
GROUP BY agclid, evalWaarde
HAVING COUNT(DISTINCT agLkrid) = 3 
```

这将返回 WJLUITV015。

# ios - Air iOS、Flash Pro、外接mp3无法播放

> ID：14836744
> 
> 赞同：1
> 
> 时间：2013-02-12T16:10:05.053
> 
> 标签：ios, flash, audio, air, mp3

我的 Flash 应用程序具有以下代码。本地测试时播放声音，但在 iOS 上发布时不播放。

mp3 文件位于 components/sound 目录中，该目录通过 Adob​​e Flash cs6 专业版中的 Air iOS3.6 发布设置包含在内。

我做了一些测试，当 mp3 文件和目录在 iOS 中存在（用 File.exists 测试）时，sound.bytesLoaded 显示 0 值。在本地测试时，它会显示实际文件大小。

谁能帮我这个？

```
var path= File.applicationDirectory.resolvePath("components/sound/click.mp3").nativePath;
var sound = new Sound(new URLRequest(path));
sound.play(); 
```

[编辑]

当我简单地将 new URLRequest(path) 替换为 new URLRequest("components/sound/click.mp3") 时，它起作用了。

但是，如果有人能解释为什么前一个（nativePath）不起作用，我仍然会很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:18:44.063

[在 Adob​​e 社区论坛上](http://forums.adobe.com/message/4857732)阅读有关在 iOS 上加载外部声音的帖子，您的代码似乎还可以，我看到的唯一可疑之处是您应该以“/”开头的文件路径，例如：

```
var path= File.applicationDirectory.resolvePath("/components/sound/click.mp3").nativePath; 
```

希望这可以帮助！

# javascript - 我如何根据 addEventListener ass 触发器将两个几乎相同的 javascript 函数合二为一

> ID：14836746
> 
> 赞同：1
> 
> 时间：2013-02-12T16:10:14.313
> 
> 标签：javascript, file, function

我今天大部分时间都在思考这个问题。我有两种触发同一事件的方法。1\. 通过单击输入：文件选择器，或 2\. 通过将文件拖放到“dropzone”中

事件之间的唯一区别是文件 API 使用不同的方法。似乎 eventListeners 函数调用中允许的唯一参数是（事件）。我可能错过了一些东西，但非常感谢任何帮助

但只是复制粘贴几乎相同的代码真的很烦人。有没有办法将这两个函数“fileSelect(event) 和 dropSelect(event)”合二为一？

编码：

```
function fileSelect(event){

    event.stopPropagation();
    event.preventDefault();

    selectedFile = event.target.files[0];       //Uses ".files" from the file API in HTML5\. In this case accessing info on a single file (files[0]).

    //Insert file info
    document.getElementById('filename').innerHTML = "filename: " + selectedFile.name;
    document.getElementById('filetype').innerHTML = "filetype: " + selectedFile.type;
    document.getElementById('filesize').innerHTML = "filesize: " + parseFloat(selectedFile.size/1024).toFixed(1) + " kb";
}

//parse the info from a drag'n'drop-selected image. WRITE THESE 2 FUNCTIONS INTO ONE!
function dropSelect(event){

    event.stopPropagation();
    event.preventDefault();

    selectedFile = event.dataTransfer.files[0];     //Uses ".files" from the file API in HTML5\. In this case accessing info on a single file (files[0]).

    //Insert file info
    document.getElementById('filename').innerHTML = "filename: " + selectedFile.name;
    document.getElementById('filetype').innerHTML = "filetype: " + selectedFile.type;
    document.getElementById('filesize').innerHTML = "filesize: " + parseFloat(selectedFile.size/1024).toFixed(1) + " kb";
}

//add onchange event to the file_select input:file. This will run function "fileSelect", onChange. 
document.getElementById('file_select').addEventListener('change', fileSelect, false);

//start fileselect when drag'n'drop.
function handleDragOver(event){
    event.stopPropagation();
    event.preventDefault();
    event.dataTransfer.dropEffect = 'copy';
}

document.getElementById('upload_box').addEventListener('dragover', handleDragOver, false);
document.getElementById('upload_box').addEventListener('drop', dropSelect, false); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:15:41.117

```
function select(event){
    event.stopPropagation();
    event.preventDefault();

    selectedFile = (event.dataTransfer || event.target).files[0];

    //Insert file info
    document.getElementById('filename').innerHTML = "filename: " + selectedFile.name;
    document.getElementById('filetype').innerHTML = "filetype: " + selectedFile.type;
    document.getElementById('filesize').innerHTML = "filesize: " + parseFloat(selectedFile.size/1024).toFixed(1) + " kb";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:13:43.537

分解出通用代码：

```
function insertFileInfo(file) {
    //Insert file info
    document.getElementById('filename').innerHTML = "filename: " + file.name;
    document.getElementById('filetype').innerHTML = "filetype: " + file.type;
    document.getElementById('filesize').innerHTML = "filesize: " + parseFloat(file.size/1024).toFixed(1) + " kb";
}

function fileSelect(event){
    event.stopPropagation();
    event.preventDefault();
    insertFileInfo(event.target.files[0]);
}

function dropSelect(event){
    event.stopPropagation();
    event.preventDefault();
    insertFileInfo(event.dataTransfer.files[0]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:21:13.537

这可能会在 @andreas 代码中更改 selectedFile = (event.dataTransfer || event.target).files[0];

到

```
selectedFile = (event.dataTransfer ? event.dataTransfer.files[0] : event.target.files[0]); 
```

# javascript - jQuery hover 仅适用于 Internet Explorer

> ID：14836750
> 
> 赞同：0
> 
> 时间：2013-02-12T16:10:22.150
> 
> 标签：javascript, jquery, css, cross-browser, hover

我对悬停有疑问。它们在 IE 中运行良好，但不能在 Mozilla Firefox 或 Chrome 中运行。我猜这是因为它相当模糊，每个 td 但现在这就是我需要的。这是小提琴（不工作）[http://jsfiddle.net/233qG/](http://jsfiddle.net/233qG/)在此先感谢。

**的HTML**

```
<table>
    <tr>
        <td>one</td>
    </tr>
    <tr>
        <td>two</td>
    </tr>
    <tr>
        <td>three</td>
    </tr>
</table>
<div class="modalPop">Modal Information</div> 
```

**CSS**

```
div.modalPop
{
    display:none;
    position:absolute;
    border:solid 1px black;
    padding:8px;
    background-color:white;
    margin: 280px 50px 0 0;
    z-index: 9999;
}
a.modalPop:hover + div.modalPop
{
    display:block;
}
div.modalPop:hover
{
    display:block;
} 
```

**jQuery**

```
$(document).ready(function(){
    $('td').hover(
      function(){$('.modalPop' + this).stop().hide().fadeIn('slow');},
      function(){$('.modalPop' + this).stop(true, true).fadeOut('slow');}
    );  
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T16:13:53.350

`$('.modalPop' + this)`是无效的。`this`是一个对象。您正在尝试将字符串与对象连接起来。只需使用`$('.modalPop')`

如果您在控制台（chrome 工具或 firebug）上打开，您应该会看到如下错误：

> 未捕获的错误：语法错误，无法识别的表达式：.modalPop [object HTMLTableCellElement]

坦率地说，我不明白为什么它甚至可以在 IE 中工作。你为什么要添加`this`到字符串中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:15:44.150

我认为你的意思是这样的：

```
$('td').hover(
  function(){$('.modalPop').stop().hide().fadeIn('slow').html("Modal Information : " + $(this).text());},
  function(){$('.modalPop').stop(true, true).fadeOut('slow');}
); 
```

[http://jsfiddle.net/233qG/3/](http://jsfiddle.net/233qG/3/)

# php - 创建 AR 模型实例的范围

> ID：14836751
> 
> 赞同：0
> 
> 时间：2013-02-12T16:10:23.480
> 
> 标签：php, model, yii

我可以在我的应用程序的任何地方创建每个模型的实例吗，或者这样做有限制。例如，我可以在我的应用程序的任何地方使用以下代码吗？

```
$issue = Issue::model()->findByPk($id); 
```

或者

```
$issue = new Issue; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:08:06.130

是的，这些代码在你的应用程序中的任何地方都可以使用，因为 Yii 使用“延迟加载”方法在需要时加载问题模型。请注意保持代码井井有条。如果您正在访问关联类的控制器或模型之外的记录（例如，在名为 ArticleController 的控制器中使用上面的第一行），您可能需要使用[关系](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#performing-relational-query)来代替。

# xslt - 如何复制具有给定名称的先前兄弟姐妹？

> ID：14836752
> 
> 赞同：0
> 
> 时间：2013-02-12T16:10:24.463
> 
> 标签：xslt

鉴于这样的事情：

```
<source>
 <somestuff>
  <thead>
   <row>C1</row>
  </thead>
  <tbody>
  <row>C2</row>
  <row>C3</row>
  </tbody>
 </somestuff>
 <somestuff>
  <tbody>
   <row>C4</row>
   <row>C5</row>
  </tbody>
 </somestuff>
 <somestuff>
  <tbody>
   <row>C6</row>
   <row>C7</row>
  </tbody>
 </somestuff>
</source> 
```

我需要将 thead 元素的内容作为第一个子元素复制到以下 tbody 元素。（可能有任意数量的 thead 元素。）导致：

```
<source>
 <somestuff>
  <tbody>
  <row>C1</row>
  <row>C2</row>
  <row>C3</row>
  </tbody>
 </somestuff>
 <somestuff>
  <tbody>
   <row>C4</row>
   <row>C5</row>
  </tbody>
 </somestuff>
 <somestuff>
  <tbody>
   <row>C6</row>
   <row>C7</row>
  </tbody>
 </somestuff>
</source> 
```

我试过这个

```
 <xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*" name="identity" >
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

<xsl:template match="tbody/*[1]">
 <xsl:copy-of select=
     "preceding-sibling::*[1]
                      [name()='thead']/row"/>
<xsl:call-template name="identity"/>
 </xsl:template>

<!-- deleting the Head node  -->
 <xsl:template match="//thead"/>
</xsl:stylesheet> 
```

但失败了。谢谢你。拉尔夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:34:44.447

试试这个：

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*" name="identity" >
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="tbody/*[1]">
  <xsl:apply-templates select="../preceding-sibling::thead[1]/node()" />
  <xsl:call-template name="identity" />
 </xsl:template>

 <!-- deleting the Head node  -->
 <xsl:template match="thead"/>
</xsl:stylesheet> 
```

原始样式表的关键问题是您试图选择

```
preceding-sibling::*[1][name()='thead'] 
```

当上下文节点是 的*子*节点时`tbody`，不是`tbody`它自己。我的版本在寻找它之前添加`..`了一个。`tbody``preceding-sibling::thead[1]`

请注意，这不包括您有空`tbody`或`thead`没有以下内容的情况`tbody`。为了捕捉这些情况，您最好将模板`thead`改为

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*" name="identity" >
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <!-- ignore a tbody that immediately follows a thead -->
 <xsl:template match="tbody[preceding-sibling::*[1]/self::thead]"/>

 <xsl:template match="thead">
  <tbody>
   <xsl:apply-templates select="@*|node()" />
   <xsl:apply-templates select="following-sibling::*[1]/self::tbody/node()" />
  </tbody>
 </xsl:template>
</xsl:stylesheet> 
```

这会在您的原始 XML 上产生相同的结果，但也可以处理诸如

```
 <somestuff>
  <thead>
   <row>C9</row>
  </thead>
 </somestuff> 
```

或者

```
 <somestuff>
  <thead>
   <row>C9</row>
  </thead>
  <tbody>
  </tbody>
 </somestuff> 
```

# regex - 是否有 R 函数来转义正则表达式字符的字符串

> ID：14836754
> 
> 赞同：26
> 
> 时间：2013-02-12T16:10:30.183
> 
> 标签：regex, string, r

我想建立一个正则表达式替换一些字符串来搜索，所以这些字符串需要在我可以将它们放入正则表达式之前进行转义，这样如果搜索的字符串包含正则表达式字符，它仍然可以工作。

某些语言具有可以为您执行此操作的功能（例如 python `re.escape`：[https](https://stackoverflow.com/a/10013356/1900520) ://stackoverflow.com/a/10013356/1900520 ）。R有这样的功能吗？

例如（组成函数）：

```
x = "foo[bar]"
y = escape(x) # y should now be "foo\\[bar\\]" 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-12T17:57:57.417

我编写了 Perl`quotemeta`函数的 R 版本：

```
library(stringr)
quotemeta <- function(string) {
  str_replace_all(string, "(\\W)", "\\\\\\1")
} 
```

我总是使用 perl 风格的正则表达式，所以这对我有用。我不知道它是否适用于 R 中的“正常”正则表达式。

编辑：我找到了解释为什么这样做的来源。它在[perlre 手册页的](http://perldoc.perl.org/perlre.html#Quoting-metacharacters)[*引用元字符*](http://perldoc.perl.org/perlre.html#Quoting-metacharacters)部分：

> 这曾经在一个常见的习惯用法中用于禁用或引用要用于模式的字符串中正则表达式元字符的特殊含义。简单地引用所有非“单词”字符：
> 
> ```
> $pattern =~ s/(\W)/\\$1/g; 
> ```

正如你所看到的，上面的 R 代码是这个替换的直接翻译（在经历了反斜杠地狱之后）。手册页还说（强调我的）：

> *与其他一些正则表达式语言不同*，没有不是字母数字的反斜杠符号。

这强化了我的观点，即该解决方案仅适用于 PCRE。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-12T17:31:44.917

显然`escapeRegex`在 Hmisc 包中调用了一个函数。函数本身对“字符串”的输入值具有以下定义：

```
gsub("([.|()\\^{}+$*?]|\\[|\\])", "\\\\\\1", string) 
```

我之前的回答：

我不确定是否有内置功能，但您可以制作一个来做您想做的事。这基本上只是创建了一个包含要替换的值的向量和一个包含要替换它们的向量，然后循环遍历那些进行必要替换的值。

```
re.escape <- function(strings){
    vals <- c("\\\\", "\\[", "\\]", "\\(", "\\)", 
              "\\{", "\\}", "\\^", "\\$","\\*", 
              "\\+", "\\?", "\\.", "\\|")
    replace.vals <- paste0("\\\\", vals)
    for(i in seq_along(vals)){
        strings <- gsub(vals[i], replace.vals[i], strings)
    }
    strings
} 
```

一些输出

```
> test.strings <- c("What the $^&(){}.*|?", "foo[bar]")
> re.escape(test.strings)
[1] "What the \\$\\^&\\(\\)\\{\\}\\.\\*\\|\\?"
[2] "foo\\[bar\\]" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-04-23T11:48:08.940

比@ryanthompson 函数更简单的方法是简单地为字符串添加前缀`\\Q`和后缀`\\E`。请参阅帮助文件`?base::regex`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-05-06T05:24:27.100

# 使用[rex](https://cran.r-project.org/web/packages/rex/index.html)包

这些天来，我使用`rex`. 对于您的具体示例，`rex`完全符合您的要求：

```
library(rex)
library(assertthat)
x = "foo[bar]"
y = rex(x)
assert_that(y == "foo\\[bar\\]") 
```

但当然，`rex`做的远不止这些。这个问题提到了构建一个正则表达式，这正是`rex`设计的目的。例如，假设我们想要匹配 中的确切字符串`x`，之前或之后没有任何内容：

```
x = "foo[bar]"
y = rex(start, x, end) 
```

现在 y 是`^foo\[bar\]$`并且只会匹配 x 中包含的确切字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-10T13:32:34.263

根据`?regex`：

> 该符号`\w`匹配“单词”字符（ 的同义词`[[:alnum:]_]`，扩展名）并且`\W`是它的否定（`[^[:alnum:]_]`）。

因此，使用捕获组，`(\\W)`我们可以检测到非单词字符的出现并使用`\\1`-syntax 对其进行转义：

```
> gsub("(\\W)", "\\\\\\1", "[](){}.|^+$*?\\These are words")
[1] "\\[\\]\\(\\)\\{\\}\\.\\|\\^\\+\\$\\*\\?\\\\These\\ are\\ words" 
```

或者类似地，替换`"([^[:alnum:]_])"`for `"(\\W)"`。

# google-chrome - Chrome 中的透明字体渲染问题

> ID：14836762
> 
> 赞同：0
> 
> 时间：2013-02-12T16:10:53.707
> 
> 标签：google-chrome, flex4, transparency, alpha

编辑/解决：这似乎已经神秘地解决了。我仍在运行相同的 Chrome 版本，相同的机器，而且我还没有重建 SWF。我能做到的唯一区别是关闭浏览器并在夜间休眠......

我在 Chrome 中在 ButtonBarButton 中呈现标签时遇到问题，我正在尝试找到一种解决方法（不成功）。如您所见，透明度通常起作用 - 未选择选项卡的背景具有 alpha=0，因此它只是字体周围的区域导致问题。

有谁知道解决方法？已在 Windows 和 OS X 上的 Chrome 中验证为问题。所有其他浏览器都可以正常显示选项卡，这并不奇怪，因为 Chrome 附带了自己的 Flash 插件......

**Firefox 中透明标签的正确呈现**

![火狐](../Images/d529ed1058486473b71a240eef0c9b54.png)

**Chrome 对同一事物的渲染**

![铬合金](../Images/0533c57b68d57aa83c873c4e094391f7.png)

使用 OS X 10.6.8、Flex SDK 4.6、FlashBuilder 4.7、Firefox 18.02、Chrome 24.0.1312.57。截至 2013 年 2 月，所有内容均已更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T10:42:45.087

这可能是 Chrome 有缺陷的 Pepper Flash 播放器的另一个问题。它有很多问题。您可以通过禁用它来确认 Pepper Flash 是否是问题所在。当您这样做时，Chrome 将使用更标准的 Flash 插件，该插件也应该被安装。

要禁用它，请转到： chrome://plugins

单击加号图标（详细信息图标）并找到 Flash 插件。禁用路径中有“PepperFlash”的那个。

Pepper Flash 是一个好主意，但它不如常规 Flash 插件稳定。

# c# - 用另一个对象替换当前绑定源对象

> ID：14836765
> 
> 赞同：1
> 
> 时间：2013-02-12T16:11:08.687
> 
> 标签：c#, wpf, data-binding

我对 C# 和 WPF 完全陌生，我正在努力使用数据绑定。我有一个实现 INotifyPropertyChanged 的​​ MyClass；所以每次我更改属性值时，都会在我的 UI 中更新。然后我将堆栈面板的 DataContext 绑定到 MyClass 的对象。像这样：

```
<StackPanel Name="stackPanel1" DataContext="{Binding}">
        <TextBlock Name="textBlock1" Text="{Binding Path=Title, Mode=OneWay}" />
</StackPanel> 
```

在后面的代码中我这样做：

```
item = new MyClass();
stackPanel1.DataContext = item; 
```

并且绑定工作正常。如果我用另一个替换我当前的绑定源对象，我必须通过再次键入 datacontext 绑定来手动设置它：

```
item = new MyClass();
stackPanel1.DataContext = item;
item1 = new MyClass();
.
. //manipulate item1
.
if (item1 is ok)
   item=item1;
   stackPanel1.DataContext = item; 
```

有没有更好的方法来替换我的源对象并更新所有关联的绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:43:16.330

当您说 时`stackPanel1.DataContext = item;`，您是在***设置***属性，而不是***绑定***它。

*设置*属性时，您将其设置为等于对象的实例。当你*绑定*它时，你告诉它它将从其他位置获取它的值，所以在它需要获取值的任何时候查看那个位置。

提供包含绑定属性的类实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)，然后 UI 将在绑定属性更改时收到警报，这会导致重新评估绑定。

例如，如果您已将`DataContext`初始设置为

```
MyWindow.DataContext = this; 
```

你的窗口在哪里`this`，你的窗口有一个`MyClass`名为的属性`Item`，那么你可以`DataContext`使用以下方法绑定

```
<StackPanel DataContext="{Binding Item}" ...> 
```

并且每当您更新属性`Item`时，您的 StackPanel`DataContext`也会更新（前提是您实施[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)）。

如果您有兴趣，我喜欢在博客中介绍 WPF 中的初学者概念，您可能有兴趣查看我的文章[您所说的“DataContext”是什么？](http://rachel53461.wordpress.com/2012/07/14/what-is-this-datacontext-you-speak-of/)`DataContext`，这是对它是什么以及如何使用它的一个非常简单的解释。

总而言之，WPF 有两层：UI 层和数据层。`DataContext`是数据层，当你写的时候，`{Binding SomeProperty}`你实际上是在绑定数据层。通常，您`DataContext`在后面的代码中设置一次数据层 ( )，然后在 XAML 中使用绑定来使您的 UI 层显示来自数据层的信息。

（您可能也有兴趣查看我的[Simple MVVM Example](http://rachel53461.wordpress.com/2011/05/08/simplemvvmexample/)，其中包含一个非常简单的工作代码示例，并说明了一些如何`INotifyPropertyChanged`实现以及 UI 层和数据层如何完全分离的示例）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:19:53.573

`CurrentItem`您可以在 MainWindow（或 UserControl 或其他任何内容）中添加一个属性，并`INotifyPropertyChange`为该属性实现。然后设置

```
DataContext = this; 
```

在 MainWindow 的构造函数中并像这样绑定：

```
Text="{Binding Path=CurrentItem.Title}" 
```

现在每当你设置

```
var item = new MyClass();
...
CurrentItem = item; 
```

绑定将被更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:20:39.197

```
DataContext="{Binding}" 
```

和

```
stackPanel1.DataContext = item; 
```

两者基本上做同样的事情。不同之处在于一个是在 XAML 中完成的，另一个是在代码中完成的。虽然第一个示例允许在给定绑定父级的情况下更新绑定，但每次您想要更改堆栈面板所附加的内容时，都必须更新第二个示例。恕我直言，您应该创建一个通用的绑定父级来绑定。这将允许您更改子绑定，而不必每次都设置上下文。

```
<StackPanel Name="parentPanel">
    <StackPanel Name="stackPanel1" DataContext="{Binding Path=Child}">
            <TextBlock Name="textBlock1" Text="{Binding Path=Title, Mode=OneWay}" />
    </StackPanel>
</StackPanel>

parent = new ParentClass();
parent.Child= new MyClass();
parentPanel.DataContext = parent ; 
```

现在，如果在 ParentClass 上正确创建了 notify 属性更改，您可以更改子堆栈面板的绑定

```
parent.Child= new NewClass(); 
```

# bash - AND 和 OR 运算符在 Bash 中如何工作？

> ID：14836768
> 
> 赞同：12
> 
> 时间：2013-02-12T16:11:16.453
> 
> 标签：bash, shell

我在 bash 上尝试了以下命令

```
echo this || echo that && echo other 
```

这给出了输出

```
this
other 
```

我不明白！

我的试运行是这样的：

1.  `echo this || echo that && echo other`暗示`true || true && true`
2.  因为, `&&`has `more precedence`than `||`, 第二个表达式首先计算
3.  因为，`both are true`，`||`被评估，这也给出了真实的。
4.  因此，我得出的结论是：

> 那
> 
> 其他
> 
> 这

`&&`来自优先级高于的 Java 背景`||`，我无法将其与 bash 联系起来。

任何输入都会非常有帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-12T16:15:28.980

从[`man bash`](http://www.gnu.org/software/bash/manual/bashref.html#Lists)

> 3.2.3 命令列表
> 
> 列表是一个或多个管道的序列，由运算符“;”、“&”、“&&”或“||”中的一个分隔，并可选地由“;”、“&”中的一个终止。 '，或换行符。
> 
> 在这些列表运算符中，**'&&' 和 '||' 具有相同的优先级**，后跟 ';' 和 '&'，它们具有相同的优先级。

所以，你的例子

```
echo this || echo that && echo other 
```

可以读成

```
(this || that) && other 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T16:14:47.307

在 bash 中，`&&`具有`||`相同*的*优先级并关联到左侧。详细信息请参见[手册中的第 3.2.3 节](http://www.gnu.org/software/bash/manual/bashref.html#Lists)。

因此，您的示例被解析为

```
$ (echo this || echo that) && echo other 
```

因此只有 or 的左侧运行，因为成功了右侧不需要运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T16:15:16.293

布尔评估`bash`是短路的：`true || false`永远不会评估`false`操作数，因为`true`操作数足以确定操作的结果。同样，`false && true`不会计算`true`操作数，因为它不能更改表达式的值。

布尔求`bash`值实际上*主要*用于控制操作数的条件求值，而不是它们的顺序。典型用法是`do_foo || do_bar_if_foo_fails`或`do_foo && do_bar_only_if_foo_has_succeeded`。

在任何情况下都`echo that`不会执行您的命令，因为`echo this`is `true`and 决定了整个`echo this || echo that`子表达式的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-12T16:13:56.020

来自[`man bash`](http://linux.die.net/man/1/bash)：

> 在这些列表运算符中，&& 和 || 具有相同的优先级，其次是 ; 和 &，它们具有相同的优先级。

所以你的输出是预期的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T16:14:01.383

我想你已经想通了。运算符优先级在`bash`. 在您的示例中，一切都从左到右。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-12T16:17:13.747

让我们解释一下这是做什么的：

```
echo this || echo that && echo other 
```

`echo this || echo that`->`echo that`仅在`echo this`失败时。

`&& echo other`->`echo other`仅当前面的命令`&&`成功时。

所以基本上：

`echo this`---> SUCCESS ----> `echo that`----> 成功后未执行`echo this`---> `echo other`---> 已执行 原因`echo this || echo that`已正确执行。

# ruby - 这些方法命名方法中哪一种更好，为什么？

> ID：14836769
> 
> 赞同：3
> 
> 时间：2013-02-12T16:11:22.627
> 
> 标签：ruby, oop, methods, state-machine, method-names

在我的应用程序中，我们的用户可以相互执行操作——比如在 Facebook 上*戳戳。*

我现在正在编写方法，并不确定要采用哪种方法。我的意思是，我知道它们都可以接受，但有没有更惯用的方法？

## 选项1

```
if @current_user.may_poke?(@other_user)
  @current_user.poke!(@other_user)
end 
```

## 选项 2

```
if @current_user.may_poke?(@other_user)
  @other_user.poke!(@current_user)
end 
```

第一个选项用英语读起来更好，几乎完美地作为一个句子。第二个选项在方法命名方面更有意义，“poke”是在`@other_user`. 这`@current_user`只是提供额外信息的一个论点 - 谁做了戳。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:16:20.420

我会在那里坚持使用选项 1.. 如果您遵循条件的逻辑，那么您会问“如果 current_user 可以戳 other_user，那么让 current_user 戳 other_user”。从这些方面考虑时，选项 2 没有多大意义。

此外.. Ruby 的作者 matz 指出“bang [感叹号] 符号意味着”bang 版本比非 bang 版本更危险；小心轻放”。” （[http://www.ruby-forum.com/topic/176830#773946](http://www.ruby-forum.com/topic/176830#773946)）。我可能只是使用`poke`该方法名称而不是`poke!`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:16:39.277

第一个选项似乎更正确，因为`may_poke?`表示执行操作。对于第二个选项，使用名称`pokable?`（或者`pokeable?`，此任何人的正确拼写？）来指示其自身的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T16:16:15.877

我说选择你通过阅读最快理解的选项。它使代码更具可读性，从而改进它（IMO）。

就我而言（对于这种特定情况），我会选择选项 1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T16:44:51.893

如果`poke`是改变状态的东西`@other_user`，那么选择选项 2。但是方法名称`poke`表明接收者和参数是相反的，所以为了避免混淆，将名称更改为类似`poke_by`. 我认为将接收者和论点颠倒过来并不好`may_poke`。也许以同样的方式拥有它会更好：

```
if @other_user.pokable_by?(@current_user)
  @other_user.poke_by(@current_user)
end 
```

# php - mysql 插入值：通过 til mysql 函数从链接一回显 $profile_id？

> ID：14836771
> 
> 赞同：0
> 
> 时间：2013-02-12T16:11:39.730
> 
> 标签：php, mysql

我的用户个人资料页面上基本上有图片，人们需要获得许可才能查看。我基本上是让用户单击一个链接以打开一个 jQuery 窗口，然后在该 jQuery 窗口中，用户需要单击另一个链接，这将运行 mysql 函数，并假设插入用户 $_session [ 'user_id'] 到表 'ptb_permissions' 和用户试图查看其图片的用户的个人资料 ID。所以这意味着用户 $profile_id 需要插入到 'private_id.

目前虽然只有 user_id 被插入。有人可以告诉我哪里出错了我想我在第一个链接处失去了回声，我认为我没有在这里编写代码：

```
<?php            
    $photo = "data/private_photos/0/_default.jpg";
    if (!file_exists($photo)) {
        $photo = "data/photos/0/_default.jpg";
    }
    $thumb = "data/private_photos/0/_default.jpg";
    if (!file_exists($thumb)) {
        $thumb = "data/photos/0/_default.jpg";
    }
    echo
    "<li><a href=\"privileges.php?to=\"$profile_id\" rel=\"shadowbox;height=300;width=500\" title=\"$profile[2]'s Photo's\"><img src=\"$thumb\" width=\"90\" height=\"90\" alt=\"<strong>{$profile[2]}'s Photos</strong>\"  /></a></li>";

    ?> 
```

单击此链接后，将打开一个 jquery 窗口，用户需要单击：

```
<a href="request_priv_pix.php?to=?to=<?php echo "$profile_id"; ?>" class="link">Let Me See</a> 
```

然后我运行我的功能：

```
<?php 

// CONNECT TO THE DATABASE
    require('includes/_config/connection.php');
// LOAD FUNCTIONS
    require('includes/functions.php');
    require_once("includes/session.php");
// GET IP ADDRESS
    $ip_address = $_SERVER['REMOTE_ADDR'];

    session_start();

    if (isset ($_GET['to'])) {
    $user_to_id = $_GET['to'];

}

if (!isset($_GET['to']))
    exit('No user specified.');

$user_id = $_GET['to'];

$sql = "INSERT INTO ptb_permissions (id, user_id, private_id) VALUES (NULL, '".$_SESSION['user_id']."', '".$user_to_id."');";
            mysql_query($sql, $connection);

            echo "<div class=\"infobox2\"><strong>Your message has successfully been sent.</strong></div>";

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:16:34.547

我不知道，但链接语法不正确：

```
request_priv_pix.php?to=?to=... 
```

或许：

```
request_priv_pix.php?to=... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:19:54.867

看起来您可能在第二个链接中有错字？

```
href="request_priv_pix.php?to=?to=" 
```

# android - 将现有 Android 项目导入 Eclipse 重命名项目

> ID：14836776
> 
> 赞同：5
> 
> 时间：2013-02-12T16:12:04.157
> 
> 标签：android, eclipse, import, project

每次我将现有的 Android 应用程序项目导入 Eclipse 时，它​​都会将该项目重命名为我的启动器活动的名称。

这两种方法我都试过了：

```
File -> Import -> Existing Android Code Into Workspace

File -> New -> Android Project From Existing Code 
```

在这两种情况下，我都会浏览到项目文件夹并选择它，这会导致它在“项目”窗口中显示为可用于导入。但是，该项目显示为名为“LauncherActivity”或类似名称。

**编辑：**将项目名称改回原来的名称很容易，我知道该怎么做：

```
Right-click on Project -> Refactor -> Rename 
```

但是，每次都必须这样做很烦人。

**编辑 2：** .project 文件包含正确的项目名称，但问题仍然存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:15:59.727

项目名称可能是在项目文件中设置的。尝试编辑 .project 文件，并更改名称标签：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>Projectname</name>
    <projects> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-18T10:04:57.793

您使用的是哪个版本的 Eclipse？

我在android SDK中使用Eclipse，没有这个问题。

导入项目，右键->重构->重命名，项目名称改了。

下次我导入这个项目时，名称不会回退到原始名称。

您可以尝试包含 Eclipse 的最新 SDK[下载 Android SDK](http://developer.android.com/sdk/index.html)

# java - 超类中的 jXPath 查询属性

> ID：14836781
> 
> 赞同：4
> 
> 时间：2013-02-12T16:12:15.597
> 
> 标签：java, inheritance, attributes, jxpath

我有几个域类都继承了 BaseDomain 类。

在这个 BaseDomain 类中，我有一个公共最终字符串名称字段；

name 的值在构造函数中设置。

```
public class BaseDomain {
    public final String name;
    public BaseDomain() {
    this.name = this.getClass().getCanonicalName();
    }
} 
```

这个 BaseDomain 由几个类扩展

```
public class Trip extends BaseDomain {
    private int id;
    public Trip(int id){
        this.id = id;
    }

} 
```

到目前为止，一切都很好。

我想在 JXPath 的帮助下获取 Trip 的对象实例中字段“名称”的值，但不能。我可以访问“id”字段，但不能访问“name”字段。

```
JXPathContext jxPathContext = JXPathContext.newContext(trip);
jxPathContext.setLenient(true);
int id = (int)jxPathContext.getValue("/@id"); // This works. 
String name = (String)jxPathContext.getValue("/@name"); // This does not work. 
```

是否可以使用此设置和 JXPath 获取“名称”的值？

代码可能有一些语法错误和/或其他错误。我希望你们都明白我的想法并理解我的问题。

欢迎任何帮助或指示。

首先：我要感谢 Kelly S. French 的快速回放。这让我意识到我必须解释更多。

我想使用 jxpath，因为我最终会进行更深入的搜索。例如：Trip 可能包含一个位置列表，该列表也扩展了 BaseDomain。每个位置都可以包含扩展 BaseDomain 的 PointOfInterest 列表。

通过代码其他部分的反射，我希望能够根据它们的类型（class.getCanonicalName（））获取 BaseDomain 列表

对象树不是基于 xml，它是纯 POJO。

据我所知，没有办法编写 jxpath-query 来根据对象的类型、类名等查找对象列表。

这个对吗？有人知道这样做的方法吗？

最简单的方法，即使它很丑陋，也是在超类中拥有一个包含类名的字段。这就是为什么我做了这个丑陋的解决方案。

最终，我想创建一个基于行程的 jxpath 查询返回一个迭代器，该迭代器是任何深度的 BaseDomain 实例，而不取决于节点位于对象树中的哪个分支，只要我能获取我正在寻找的对象的类名。

有谁知道是否可以通过 jxpath-query 实现这一目标？

欢迎和赞赏代码示例、博客链接或其他文档。

和以前一样，我非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:21:19.320

如果您有旅行实例，为什么不能这样做

```
 string n = trip.name; 
```

我可以看到您有旅行的 XML 表示，但是当您只有“旅行”的 XML 时使用 XPath。

如果您仍需要使用 XPath 获取名称，请发布生成的 XML。我愿意打赌 name 属性不是 Trip 的一部分，而是封闭 BaseDomain 的一部分。如果您将 jxPathContext 基于 Trip，则您已经传递了 BaseDomain 的节点。您必须以某种方式向后导航（例如 node.parent），或者在创建上下文时执行此操作，

```
// not sure about this approach
JXPathContext jxPathContext = JXPathContext.newContext(trip.super); 
```

在查看了关于父/子关系的[JXPath 手册](http://commons.apache.org/jxpath/users-guide.html#Parentchild_Relationship)之后，为什么不试试这个：

```
String name = (String)jxPathContext.getValue("/Trip/../@name");    
// or use "../@name", not sure it wouldn't need to be "/../@name" 
```

# jquery - 通过 Jquery 控制 iframe 中的点击

> ID：14836784
> 
> 赞同：1
> 
> 时间：2013-02-12T16:12:22.193
> 
> 标签：jquery, iframe

我有这个代码：

```
$("#iframeID").load(function () {
    var iframeDoc = $('#iframeID').contents().get(0);
    $(iframeDoc).bind('click', function() {
        alert('clicked');
    });
}); 
```

及其检测 iframe 中的点击，但我如何检测点击是否在例如 javascript 函数中，例如：

```
<a href="#" onclick="save(100);">save 100</a> 
```

我想通过 Jquery 检测并获取保存功能的信息

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:53:34.970

您可以查找属性 onclick：

```
$("#iframeID").load(function () {
    var iframeDoc = $('#iframeID').contents().get(0);
    $(iframeDoc).bind('click', function(event) {
        if($(event.target).attr("onclick")) {
            var onclickStr = $(event.target).attr("onclick").toString();
            // containing whatever is inside the onclick attribute, 
            // now you could compare it to whatever you want 
            // might be that you need some kind of regular expression to 
            // etract the function name.
            console.log(onclickStr);

        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:33:03.853

使用 jQuery 的`.on()`事件处理程序。

```
$("#iframeID").load(function () {
    var iframeDoc = $('#iframeID').contents().get(0);
    $(iframeDoc).on('click', 'a[onclick^="save"]', function(e) {
        e.preventDefault();
        alert('clicked');
    });
}); 
```

第一个参数是事件，第二个是选择器，第三个是你的匿名函数。

**示例**：http: [//jsfiddle.net/bR52H/](http://jsfiddle.net/bR52H/)

# javascript - 在 CRM 2011 中查找自定义实体上的地址字段

> ID：14836787
> 
> 赞同：1
> 
> 时间：2013-02-12T16:12:36.513
> 
> 标签：javascript, dynamics-crm-2011, dynamics-crm, lookup

我有一个名为客户站点的实体，我从中存储站点信息。从这个站点我创建设备（另一个自定义实体）。我已经在我的客户站点实体中创建了与地址实体相关的地址字段，并且我正在尝试（基于帐户）用来自帐户的选定地址的地址字段填充我的站点字段。

我为此参考了这篇文章， http: [//xrmexpertz.com/2012/01/24/lookup-address-for-custom-entities-in-crm-2011/](http://xrmexpertz.com/2012/01/24/lookup-address-for-custom-entities-in-crm-2011/)

我更改了链接中提供的 javascript 和 xml 以反映我的实体和我的网络资源。

我的问题是，当我单击应该执行 JavaScript 的按钮时，它什么也不做，如果我尝试在没有帐户的情况下保存网站，它会向我发送错误消息。

这是我的java脚本。

```
function CustomLookup() {
'use strict';
var aoItems = getFieldValue("kez_SiteInfo_AccountId");

if (aoItems == null) {

    alert(“Account is not Selected”);

    return;

}

var _object = openStdDlg(“ / sfa / quotes / dlg_lookupaddress.aspx ? headerForm = 1 & parentType = 1 & parentId = ” + aoItems[0].id + “ & willCall = 0″, “LookupAddress”, 500, 330, true);

if (object) {

    setFieldValue(“kez_address1_name”, object.Address.Name);

    setFieldValue(“kez_address1_line1″, object.Address.Line1);

    setFieldValue(“kez_address1_line2″, object.Address.Line2);

    setFieldValue(“kez_address1_line3″, object.Address.Line3);

    setFieldValue(“kez_address1_city”, object.Address.City);

    setFieldValue(“kez_address1_province”, object.Address.StateOrProvince);

    setFieldValue(“kez_address1_postalcode”, object.Address.PostalCode);

    setFieldValue(“kez_address1_country”, object.Address.Country);

}

}

function setFieldValue(fieldName, fieldValue) {

Xrm.Page.getAttribute(fieldName).setValue(fieldValue);

} 
```

这是给出的错误

```
Microsoft Dynamics CRM Error Report Contents

<CrmScriptErrorReport>
  <ReportVersion>1.0</ReportVersion>
  <ScriptErrorDetails>
   <Message>Uncaught SyntaxError: Unexpected token ILLEGAL</Message>
   <Line>7</Line>
   <URL>/%7B634962800260003236%7D/WebResources/kez_GetLocation</URL>
   <PageURL>/userdefined/edit.aspx?_gridType=10018&etc=10018&id=%7b1F8E02F0-766C-E211-934E-   00155D018211%7d&pagemode=iframe&preloadcache=1360684076423&rskey=69426415</PageURL>
   <Function></Function>
   <CallStack>
   </CallStack>
  </ScriptErrorDetails>
  <ClientInformation>
   <BrowserUserAgent>Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.30 (KHTML, like Gecko)       Chrome/26.0.1403.0 Safari/537.30</BrowserUserAgent>
   <BrowserLanguage>undefined</BrowserLanguage>
   <SystemLanguage>undefined</SystemLanguage>
   <UserLanguage>undefined</UserLanguage>
   <ScreenResolution>1366x768</ScreenResolution>
   <ClientName>Web</ClientName>
   <ClientTime>2013-02-12T10:47:58</ClientTime>
  </ClientInformation>
  <ServerInformation>
    <OrgLanguage>1033</OrgLanguage>
    <OrgCulture>1033</OrgCulture>
    <UserLanguage>1033</UserLanguage>
    <UserCulture>1033</UserCulture>
    <OrgID>{BC278BC1-EEEA-4D24-B5C6-F0720B343A1F}</OrgID>
    <UserID>{D76EEA89-D760-E211-921F-00155D018211}</UserID>
    <CRMVersion>5.0.9690.3236</CRMVersion>
  </ServerInformation>
</CrmScriptErrorReport> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:07:11.453

我最终解决了这个问题，因为我列出的来源之一使用了 CRM 无法识别的报价。接下来我必须使用 XRM.getAttribute 而不是 getFieldValue。

最终和工作代码如下：

```
function CustomLookup() {
'use strict';
var aoItems = Xrm.Page.getAttribute('kez_siteinfo_accountid').getValue();
if (aoItems == null) {

    alert("Account is not Selected");

    return;

}

var _object = openStdDlg("/sfa/quotes/dlg_lookupaddress.aspx?headerForm=1&parentType=1&parentId=" + aoItems[0].id + "&willCall=0", "LookupAddress", 500, 330, true);

    if (object) {

    setFieldValue("kez_address1_name", object.Address.Name);

    setFieldValue("kez_address1_line1", object.Address.Line1);

    setFieldValue("kez_address1_line2", object.Address.Line2);

    setFieldValue("kez_address1_line3", object.Address.Line3);

        setFieldValue("kez_address1_city", object.Address.City);

        setFieldValue("kez_address1_province", object.Address.StateOrProvince);

        setFieldValue("kez_address1_postalcode", object.Address.PostalCode);

        setFieldValue("kez_address1_country", object.Address.Country);

    }

}

function setFieldValue(fieldName, fieldValue) {

    Xrm.Page.getAttribute(fieldName).setValue(fieldValue);

} 
```

# iphone - iOS 开发者计划：个人 vs 公司

> ID：14836793
> 
> 赞同：5
> 
> 时间：2013-02-12T16:12:57.640
> 
> 标签：iphone, account

这似乎是一个微不足道的问题。我需要知道，如果我在**iOS Developer Program : Company**下注册我的公司，价值 99 美元，我现在可以在同一公司下添加开发人员。

我的问题是，这些开发者是否也需要有**iOS 开发者计划：单独**价值 99 美元的个人？还是一个简单的 Apple ID 就足够了？？

编辑：所以实际上我需要支付 99 美元（公司）+ 99 美元（个人）还有一个问题是：我可以使用个人 IOS 开发人员计划附加多少设备？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T16:46:35.043

每个开发者都将使用他的免费 Apple ID，并加入您的团队，并附在您的公司订阅中。因此，您的所有团队每年“仅”99 美元。

您可以在 100 台设备上使用该帐户

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:20:49.320

要将他们添加到公司，他们将需要开发人员帐户。但是，您可以使用公司帐户并将最多 100 台设备附加到该帐户以进行测试并在所有开发人员之间共享证书。

更多信息请访问： [https ://developer.apple.com/support/ios/enrollment.html](https://developer.apple.com/support/ios/enrollment.html)

# java - 是否可以将子数据集中的值传递给 JasperReports 中的子报表？

> ID：14836806
> 
> 赞同：0
> 
> 时间：2013-02-12T16:13:36.780
> 
> 标签：java, jasper-reports

在 iReport 指南中或在互联网上搜索了一段时间后，我似乎无法找到答案。所以我就问问。我在子数据集中有一个字段，我希望将其传递给子报表中的参数。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:23:54.837

这不可能。子数据集绑定到可以在报表运行时保存子数据集的报表元素。它们不提供返回值。

# ios - 如何在 iOS 上禁用 MPMoviePlayerViewController 上的单指双击缩放？

> ID：14836808
> 
> 赞同：2
> 
> 时间：2013-02-12T16:13:43.163
> 
> 标签：ios, ios5, ios6

使用 MPMoviePlayerViewController 时，默认行为是用单指双击视频时，视频会放大一点。

如何禁用此功能？因为我想双击以触发除放大之外的不同行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-06T23:33:32.647

只需做类似的事情（它对我来说很好！:)）：

```
[[[self.moviePlayer view] subviews] enumerateObjectsUsingBlock:^(id view, NSUInteger idx, BOOL *stop) {
    [[view gestureRecognizers] enumerateObjectsUsingBlock:^(id tap, NSUInteger idx, BOOL *stop) {
        if([tap isKindOfClass:[UITapGestureRecognizer class]]) {

            if([tap numberOfTapsRequired]==2)
            {
                [view removeGestureRecognizer:tap];

            }
        }
    }];
}]; 
```

# java - 为什么这不起作用[试图用所有常量打印出一个新句子]

> ID：14836811
> 
> 赞同：0
> 
> 时间：2013-02-12T16:13:48.153
> 
> 标签：java, string, indexof

```
import javax.swing.JOptionPane;

public class Indexof {

public static void main(String[] args) {
    String newSentance = "";
    String sentance = JOptionPane.showInputDialog("Enter sentance");
    String vowels = "AEIOU";
  int len = sentance.length();
  for (int i = 0; i >=len; i++)
  {
     if(vowels.indexOf(sentance.toUpperCase().charAt(i))>0)
             {
               newSentance+=sentance.charAt(i);                                                 
     }      
}
  System.out.println(newSentance);

}

} 
```

我在 NetBeans 中没有收到任何错误，但在打印 newSentance 时它仍然没有返回任何内容，.length 肯定可以正常工作，因为如果打印它会正确返回数字

还能是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:21:10.340

修改代码

```
int i = 0; i < len; i++ 
```

和

```
vowels.indexOf(sentance.toUpperCase().charAt(i)) < 0 
```

只打印常量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:16:45.897

这段代码::

```
 for (int i = 0; i >= len; i++) {
        if (vowels.indexOf(sentance.toUpperCase().charAt(i)) > 0) {
            newSentance += sentance.charAt(i);
        }
    } 
```

应该是这样的：

```
 for (int i = 0; i < len; i++) {
        if (vowels.indexOf(sentance.toUpperCase().charAt(i)) >= 0) {
            newSentance += sentance.charAt(i);
        }
    } 
```

# vb.net - 从 Menustrip 的单击子菜单项中提取文本

> ID：14836812
> 
> 赞同：1
> 
> 时间：2013-02-12T16:13:52.297
> 
> 标签：vb.net, menustrip, subitem

我一直在处理并寻找一种在单击并在 textbox1 中写入文本时提取任何给定子项的文本的方法。

这是我到目前为止的代码，但它似乎不起作用。

```
Private Sub MenuStrip1_ItemClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.ToolStripItemClickedEventArgs) Handles MenuStrip1.ItemClicked

    Dim result As String

    If AccionAToolStripMenuItem.Checked = True Then
        result = AccionAToolStripMenuItem.Text
        TextBox1.Text = result
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:38:56.787

您使用了错误的事件。ItemClicked 事件适用于菜单上的项目。您需要为每个子项添加一个事件：

```
Sub SomeToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles SomeTSMenuItem.Click
    TextBox1.Text = Ctype(sender, ToolStripMenuItem).Text
End Sub 
```

您可以为每个子项创建一个函数或处理同一函数上的每个事件：

```
Handles item1.Click, item2.Click, item3.CLick 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:21:24.077

尝试阅读`e.ClickedItem.Text`。

# javascript - 客户端 CGI、JavaScript / Python

> ID：14836820
> 
> 赞同：0
> 
> 时间：2013-02-12T16:14:07.950
> 
> 标签：javascript, python, cgi

是否可以将信息从使用 JavaScript 的客户端浏览器传递到使用 Python CGI 的客户端 Python 脚本？我做了一些简单的谷歌搜索，所有内容都指向从客户端浏览器接收信息的服务器端 Python 脚本。我有一个有点独特的项目，需要能够将这些信息从浏览器本地传递到本地脚本。

例如，我会有一个带有表格的网页。在表格中的每个单元格中都会有一个图像，旁边有一个复选框。当我点击提交时，每个选中的复选框中选中的唯一值将被传递到本地 python 脚本，从中会发生进一步的处理。

对此有什么想法吗？谢谢！

编辑 - 作为我的古怪问题，可能会有一些混淆，所以稍微澄清一下。我的 python 脚本首先安装和遍历一个 NTFS 卷，列出找到的每个图形文件的路径。然后它会安装一个 RAM 磁盘。然后，python 脚本会生成找到的每个图像的缩略图。然后，python 脚本会生成一个“主”html 页面，然后生成要在 iframe 中使用的动态 html 页面数量。HTML 文件和缩略图文件存储在 RAM 磁盘中。iframe 页面包含计算机上找到的所有图像的表格中的缩略图，每个缩略图旁边都有复选框。生成所有这些信息后，Python 脚本会打开一个浏览器，调用 RAM 磁盘中的该页面。然后用户应该检查感兴趣的图像，选中的复选框值存储在数组中。当用户完成选择所有项目时，用户将提交。然后我想要将数组值传递给 python 脚本，然后 python 脚本将从数组中的值引用的每个项目并对它们进行哈希处理，然后将缩略图粘贴到 PDF 上，每个 8页面，每个缩略图都带有原始文件的哈希值、路径和来自操作系统的修改/访问/创建时间。为了生成本地图像文件的哈希值并获取 MAC 时间，我需要使用 Python 访问本地机器，因为 JS 存在于它的小沙箱中。希望这是有道理的！然后python脚本将从数组中的值中获取引用的每个项目并对它们进行哈希处理，然后将缩略图粘贴到PDF上，每页8个，每个缩略图带有原始文件的哈希值、路径和修改/访问/创建时间操作系统。为了生成本地图像文件的哈希值并获取 MAC 时间，我需要使用 Python 访问本地机器，因为 JS 存在于它的小沙箱中。希望这是有道理的！然后python脚本将从数组中的值中获取引用的每个项目并对它们进行哈希处理，然后将缩略图粘贴到PDF上，每页8个，每个缩略图带有原始文件的哈希值、路径和修改/访问/创建时间操作系统。为了生成本地图像文件的哈希值并获取 MAC 时间，我需要使用 Python 访问本地机器，因为 JS 存在于它的小沙箱中。希望这是有道理的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:19:21.500

您可以设置自己的本地服务器并将浏览器连接到它。有些东西必须打开连接，有些东西必须监听连接。因此，无论听起来如何，您的 python 客户端都会自动变成服务器。

无论如何，为什么你不只使用 javascript？大多数事情都可以用单独的 js 完成。

**更新**：

您也可以忘记 html 和 javascript，并在 python 中制作所有内容。检查[PyQt4](http://www.riverbankcomputing.com/software/pyqt/download)，你可以很容易地制作你自己的 gui 来检查图像。

# forms - TForm.Close 和通过表单句柄关闭有什么区别？

> ID：14836826
> 
> 赞同：4
> 
> 时间：2013-02-12T16:14:21.330
> 
> 标签：forms, delphi, winapi

我的应用程序有一个主表单，我在该表单上有一个按钮来关闭/退出应用程序。目前它是通过调用 Windows 来关闭句柄的：

```
SendMessage(Handle, WM_CLOSE, 0, 0); 
```

但我想知道使用有什么害处：

```
formName.Close; 
```

这里的正确用法是什么？有什么理由使用 SendMessage 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T16:18:12.640

他们做同样的事情。事实上，在`Forms.pas`你发现

```
procedure WMClose(var Message: TWMClose); message WM_CLOSE;

...

implementation

...

procedure TCustomForm.WMClose(var Message: TWMClose);
begin
  Close;
end; 
```

显示该`WM_CLOSE`消息仅转换为`Self.Close`.

一般来说，如果可以的话，你应该使用`Close`它，因为它更像 Delphi 并且更短。

# iphone - 我如何知道 AppDelegate 中更改的方向

> ID：14836828
> 
> 赞同：3
> 
> 时间：2013-02-12T16:14:35.840
> 
> 标签：iphone, ios, objective-c, screen-orientation

设备如何知道方向变化的功能是 -(void)viewWillLayoutSubviews 和 -(void)viewDidLayoutSubviews 但是，它们只是在控制器中；现在我想知道有没有像这样的函数来知道文件 AppDelegate.m 中方向的变化

```
- (void)navigationController:(UINavigationController *)navigationController
      willShowViewController:(UIViewController *)viewController
                    animated:(BOOL)animated {

    UINavigationBar *morenavbar = navigationController.navigationBar;
    UINavigationItem *morenavitem = morenavbar.topItem;
    //We don't need Edit button in More screen.
    morenavitem.rightBarButtonItem = nil;
    morenavitem.title = nil;
    UIImage *backgroundImage = [UIImage imageNamed:@"nav.png"];

    [morenavbar setBackgroundImage:backgroundImage 
         forBarMetrics:UIBarMetricsDefault];

    UIDeviceOrientation currentDeviceOrientation = 
           [[UIDevice currentDevice] orientation];
    UIInterfaceOrientation currentInterfaceOrientation = 
           [[UIApplication sharedApplication] statusBarOrientation];
    if (UIDeviceOrientationIsLandscape(currentDeviceOrientation)||
        UIDeviceOrientationIsLandscape(currentInterfaceOrientation)){
        UIImage *backgroundImageLandscape = [UIImage imageNamed:@"navbar_landscape.png"];
        [morenavbar setBackgroundImage:backgroundImageLandscape forBarMetrics:UIBarMetricsDefault];
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T16:20:14.190

您可以在轮换发生时注册通知

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(handleDidChangeStatusBarOrientationNotification:) 
                                             name:UIApplicationDidChangeStatusBarOrientationNotification 
                                           object:nil]; 
```

然后实现发送消息时调用的方法

```
- (void)handleDidChangeStatusBarOrientationNotification:(NSNotification *)notification;
{
  // Do something interesting
  NSLog(@"The orientation is %@", [notification.userInfo objectForKey: UIApplicationStatusBarOrientationUserInfoKey]);
} 
```

或者查看[UIApplicationDidChangeStatusBarOrientationNotification](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006728-CH3-SW40)的文档，它将为您提供

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:20:16.887

如果您正在谈论界面方向，您可以观察`UIApplicationDidChangeStatusBarOrientationNotification`，如果您想在设备方向更改时收到通知，您可以观察`UIDeviceOrientationDidChangeNotification`

# cookies - 如何在同一域上为 iframe 设置 cookie

> ID：14836834
> 
> 赞同：7
> 
> 时间：2013-02-12T16:14:55.500
> 
> 标签：cookies, session-cookies, etherpad

我正在尝试在 CMS Plone 中集成 etherpad-lite，遵循官方文档[http://etherpad.org/doc/v1.2.7/的示例 1](http://etherpad.org/doc/v1.2.7/)

```
Portal places the cookie "sessionID" with the given value on the client and creates an iframe including the pad. 
```

一切都很顺利，除了饼干。阅读文档的最佳实践似乎使 etherpad-lite 在特定路径下的同一域中。这就是我使用 /pad/ 路径所做的。

如果没有创建会话，我创建了 Plone 端，我添加了一个 cookie，然后我正在重定向到同一页面以确保 cookie 在浏览器中。

结果，我的 cookie 被添加到主页的请求中，而不是 iframe 请求中。

这是主页和 iframe 的 google chrome 控制台网络选项卡：

[http://toutpt.makina-corpus.org/en/images/cookie-in-iframe/](http://toutpt.makina-corpus.org/en/images/cookie-in-iframe/)

setCookie 对应的代码在[https://github.com/toutpt/collective.etherpad/blob/master/collective/etherpad/archetypes.py#L100](https://github.com/toutpt/collective.etherpad/blob/master/collective/etherpad/archetypes.py#L100)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-08-26T17:15:15.537

对于后代，这是@AskoSoukka[在](https://stackoverflow.com/users/1129979/asko-soukka)上面的评论中确定并“接受”[的答案：](https://stackoverflow.com/questions/14836834/how-to-set-a-cookie-for-iframe-on-the-same-domain/32232767?noredirect=1#comment20790324_14836834)

> 存储在浏览器中的实际 cookie 是什么样的？可能，您需要在 setCookie kwargs 中明确指定 path="/" 以使其适用于整个域。

# rest - Youtube REST API v3 - 在搜索查询结果中包含视频的统计信息

> ID：14836838
> 
> 赞同：11
> 
> 时间：2013-02-12T16:15:11.430
> 
> 标签：rest, youtube, youtube-api

我想使用 Youtube API v3 执行搜索查询。我需要的是检索每个视频的视频 ID 和统计信息。从[文档](https://developers.google.com/youtube/v3/docs/search#resource)中我可以看到视频项目没有返回统计信息。如果我尝试使用此查询询问统计信息：

```
https://www.googleapis.com/youtube/v3/search?type=video&part=snippet,statistics&q=kittens&key={MY_KEY} 
```

我收到一个错误：

```
{
 "error": {
  "errors": [
   {
    "domain": "youtube.part",
    "reason": "unknownPart",
    "message": "statistics",
    "locationType": "parameter",
    "location": "part"
   }
  ],
  "code": 400,
  "message": "statistics"
 }
} 
```

所以我想我需要提出两个请求：

1.  执行实际搜索并检索视频 ID 列表。
2.  发出 API 请求[https://developers.google.com/youtube/v3/docs/videos/list](https://developers.google.com/youtube/v3/docs/videos/list)以检索每个视频的统计信息。

或者也许我遗漏了一些东西，并且有一种方法可以在一个搜索查询中获取视频的统计信息？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-12T16:22:51.290

[在指南中，他们在使用https://www.googleapis.com/youtube/v3/search](https://www.googleapis.com/youtube/v3/search)时指定“您可以在参数值中包含的部分名称是 id 和 snippet” 。（统计数据不是一个可接受的值）。

所以我认为你必须按照你所说的提出两个请求，至少我正在这样做。我找不到任何其他解决方案。我很想知道是否有解决方法...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:45:25.337

为了避免返回数据的冗余，并且不使用额外数据的带宽，API中将“视频搜索数据”和“视频统计”数据解耦。关于两个电话，你是对的。通常，为了获得更快的响应，请仅使用您将在应用程序中使用的请求中的“部分”。

# java - 是否可以在 java 项目中使用 lupdate（QtLinguist）？

> ID：14836843
> 
> 赞同：2
> 
> 时间：2013-02-12T16:15:22.643
> 
> 标签：java, qt, internationalization, qt-jambi

我需要对现有 Java 项目进行国际化。我已经在使用 Qt 的 C++ 项目中使用 Qt Linguist，我希望（并且必须）为我的 Java 项目保留相同的过程，而不是使用 java RessourceBundles。

lupdate 的帮助指定可以使用 Java 文件作为输入，但我不知道如何执行此操作。甚至可能吗？或者这个目的在 Qt Jambi 中已经失效了？

谢谢，

罗兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-10T16:01:37.530

由于*Jambi*项目已停止，您可能无法将当前版本的 Qt Linguist 用于任何 Java 项目。大多数功能都严重依赖于 C++ 特定的语言功能（例如，翻译方法的签名、宏），因此如果没有特定的 Java 端口，它看起来很黯淡。

**TLDR：**很可能：没有。您将使用不同的东西进行翻译（或用 C++ 编写:)）。

# postgresql - 如何为 Postgres 中按插入顺序排序的查询优化表

> ID：14836844
> 
> 赞同：2
> 
> 时间：2013-02-12T16:15:25.247
> 
> 标签：postgresql, database-schema

我有一个时间序列数据表，对于几乎所有查询，我希望选择按收集时间排序的数据。我确实有一个时间戳列，但我不想为此使用实际的时间戳，因为如果两个条目具有相同的时间戳，那么我能够按照它们被收集的顺序对它们进行排序是至关重要的，这是我在插入时间。

我当前的模式只有一个时间戳列。我将如何更改我的架构以确保我可以根据收集/插入时间进行排序，并确保按收集/插入顺序进行查询是有效的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T19:35:10.173

根据序列（即序列）添加列，并在（timestamp_column，serial_column）上创建索引。然后，您可以通过执行以下操作来获得插入订单（或多或少）：

```
ORDER BY timestamp_column, serial_column; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:17:13.493

您可以使用名为 insert_order 的 SERIAL 列。这样就不会有两行具有相同的值。但是，我不确定您是否可以实现绝对时间顺序的要求。

例如，假设有两个事务，T1 和 T2，并且它们确实同时发生，并且您在具有多个处理器的机器上运行，所以实际上 T1 和 T2 都在完全相同的时刻进行了插入。这是您关心的案例吗？您的问题没有足够的信息确切地知道。

同样对于序列列，您会遇到间隙问题，例如 T1 云抓取序列值 14 并且 T2 可以抓取值 15，然后 T1 回滚而 T2 不会，因此您必须期望 insert_order 列中可能有间隙.

# php - 如何使用数组更新 SimpleXMLElement

> ID：14836849
> 
> 赞同：1
> 
> 时间：2013-02-12T16:15:30.677
> 
> 标签：php, xml, arrays, simplexml

我有这个适用于 Flash 编码器的 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<flashmedialiveencoder_profile>
    <preset>
        <name></name>
        <description></description>
    </preset>
    <capture>
        <video>
            <device></device> 
            <crossbar_input>1</crossbar_input>
            <frame_rate>25.00</frame_rate>
            <size>
                <width></width>
                <height></height>
            </size>
        </video>
        <audio>
            <device></device> 
            <crossbar_input>2</crossbar_input>
            <sample_rate></sample_rate>
            <channels>1</channels>
            <input_volume>60</input_volume>
        </audio>
    </capture>
    <encode>
        <video>
            <format>H.264</format>
            <datarate></datarate>
            <outputsize></outputsize>
            <advanced>
                <profile></profile>
                <level></level>
                <keyframe_frequency>5 Seconds</keyframe_frequency>
            </advanced>
            <autoadjust>
                <enable>false</enable>
                <maxbuffersize>1</maxbuffersize>
                <dropframes>
                <enable>false</enable>
                </dropframes>
                <degradequality>
                <enable>false</enable>
                <minvideobitrate></minvideobitrate>
                <preservepfq>false</preservepfq>
                </degradequality>
            </autoadjust>
        </video>
        <audio>
            <format>MP3</format>
            <datarate></datarate>
        </audio>
    </encode>
    <restartinterval>
        <days></days>
        <hours></hours>
        <minutes></minutes>
    </restartinterval>
    <reconnectinterval>
        <attempts></attempts>
        <interval></interval>
    </reconnectinterval>
    <output>
        <rtmp>
        <url></url>
        <backup_url></backup_url>
        <stream></stream>
        </rtmp>
    </output>
    <metadata>
        <entry>
        <key>author</key>
        <value></value>
        </entry>
        <entry>
        <key>copyright</key>
        <value></value>
        </entry>
        <entry>
        <key>description</key>
        <value></value>
        </entry>
        <entry>
        <key>keywords</key>
        <value></value>
        </entry>
        <entry>
        <key>rating</key>
        <value></value>
        </entry>
        <entry>
        <key>title</key>
        <value></value>
        </entry>
    </metadata>
    <preview>
        <video>
        <input>
            <zoom>50%</zoom>
        </input>
        <output>
            <zoom>50%</zoom>
        </output>
        </video>
        <audio></audio>
    </preview>
    <log>
        <level>100</level>
        <directory></directory>
    </log>
</flashmedialiveencoder_profile> 
```

而且我需要根据用户需要的 xml 类型更新一些数据。所以我想做这样的事情：

```
$data = array (
    'preset' => array (
        'name' => 'Low Bandwidth (150 Kbps) - H.264',
    ),
    'capture' => array (
        'audio'  => array (
            'sample_rate' => 44100
        )
    ),
    'encode' => array (
        'video' => array (
            'datarate' => '300;',
            'outputsize' => '480x360;',
            'advanced' => array (
                'profile' => 'Main',
                'level' => 2.1,
            )
         ),
         'audio' => array (
            'datarate' => 48
         )
    ),
); 
```

我知道这棵树有效，因为我可以手动完成，但问题是我不想那样做，所以如果将来我需要更改 xml 中的其他想法，我只需添加它到阵列配置。

我该怎么做？我可以编写一个递归函数来做到这一点，但我真的不想那样做。还有其他方法吗？我不知道......可能是这样的：

```
$xml->updateFromArray($data); 
```

正如我重复的那样，我可以编写该函数并扩展 SimpleXMLElement，但如果有任何其他本机 php 方法可以做到这一点，那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:29:32.033

考虑`$xml`将文档元素作为 a`SimpleXMLElement`并且`$data`是您的数组（如问题中所示），如果您担心对子项进行编号，例如元数据，我将它以这种方式在数组中编号：

```
'metadata' => array(
    'entry' => array(
        5 => array(
            'value' => 'Sunny Days',
        ),
    ),
), 
```

下面展示了如何在堆栈的帮助下以非递归方式解决问题：

```
while (list($set, $node) = array_pop($stack)) {
    if (!is_array($set)) {
        $node[0] = $set;
        continue;
    }

    foreach ($set as $element => $value) {
        $parent = $node->$element;
        if ($parent[0] == NULL) {
            throw new Exception(sprintf("Child-Element '%s' not found.", $element));
        }
        $stack[] = array($value, $parent);
    }
} 
```

一些注意事项：

*   我更改了具体的异常类型以删除依赖项。
*   `$parent[0] == NULL`测试元素`$parent`是否为空（比较/参见[SimpleXML Type Cheatsheet](https://stackoverflow.com/a/14829309/367456)）。
*   由于元素节点入栈后取回，`$node[0]`需要在出栈后设置（编号元素已经在`$node`（默认第一个），稍后更改，编号`0`需要用作偏移量）。

和[在线演示](http://eval.in/9627)。

* * *

到目前为止的示例不允许创建新元素，如果它们到目前为止不存在。要添加新元素，则会为不存在的子元素引发异常：

```
 if ($parent[0] == NULL) {
            throw new Exception(sprintf("Child-Element '%s' not found.", $element));
        } 
```

需要用一些添加新子代的代码替换，包括第一个：

```
 if ($parent[0] == NULL) {
            if (is_int($element)) {
                if ($element != $node->count()) {
                    throw new Exception(sprintf("Element Number out of order: %d unfitting for %d elements so far.", $element, $node->count()));
                }
                $node[] = '';
                $parent = $node->$element;
            } else {
                $parent[0] = $node->addChild($element);
            }
        } 
```

仍然存在的例外是添加新元素但其数量大于现有元素数量加一的情况。例如，您有 4 个元素，然后“添加”编号为 6 的元素，这将不起作用。该值是从零开始的，这通常不会有任何问题。

[演示](http://eval.in/11819)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:32:46.300

我已经使这个对象扩展了 SimpleXMLElement，但是如果有更好的方法来做到这一点，我将非常感激 :)

```
/**
 * Object to manipulate and add information to an xml object
 *
 * @package Stream
 * @subpackage SimpleXMLElement
 * @author abraham.sustaita@gmail.com
 * @author Abraham Cruz
 * @version 2 Added functionality to update data with array 
 * @example $this->rows[0] = array (); now can be edited
 */
class Stream_SimpleXMLElement extends SimpleXMLElement 
{
    /** 
     * Method to update the information of the xml
     * from an array
     * 
     * @throws Core_Exception
     * @param array $array
     * @return Stream_SimpleXMLElement
     */
    public function updateFromArray(array $array) {
        foreach ($array as $key => $data) {
            if ($this->$key->count() == 0) {
                throw new Core_Exception("The key {$key} does not exists within the XML object.");
            } else if ($this->$key->count() > 1) {
                foreach ($data as $i => $value) {
                    $tmpData = &$this->$key;
                    $tmpkey = &$tmpData [$i];
                    if (is_array($value)) {
                        foreach ($value as $key2 => $value2) {
                            if ($tmpkey->$key2 instanceof Stream_SimpleXMLElement && is_array($value2)) {
                                $tmpkey->$key2->updateFromArray($value2);
                            } else {
                                $tmpkey->$key2 = $value2;
                            }
                        }
                    } else {
                        $tmpkey = $value;
                    }
                    unset ($tmpData, $tmpkey);
                }
            } else {
                if (is_array($data)) {
                    $this->$key->updateFromArray($data);
                } else {
                    $this->$key = $data;
                }
            }
        }
        return $this;
    }
} 
```

随着对象的`Stream_SimpleXMLElement`扩展`SimpleXMLElement`，对象的每个子对象都将是 的实例`Stream_SimpleXMLElement`，因此我们可以使用相同的方法...

# sql - 在 MS ACCESS 查询中优化一堆嵌套的 SELECT

> ID：14836854
> 
> 赞同：0
> 
> 时间：2013-02-12T16:15:48.407
> 
> 标签：sql, performance, ms-access

这是一个运行速度非常慢的 MS Access 查询。该`Results`表是主表`P`，`B`、`S`和`C`表是子表。列组合在所有这些表中都是唯一的`Index`。因此，例如，表中`ResultID`只能有一行是“1”和2。我没有使用 JOIN，因为 MS Access 仅支持内部联接，而我需要的是外部联接，因为我想显示表中的所有记录，即使在任何其他表中都没有相应的记录。`C``Index``ResultID``Results`

```
SELECT 
    [Results].[Id],
    [Results].[Name],
    [Results].[OfferPrice],
    [Results].[RegPrice],
    [Results].[ImageFileName],
    [Results].[Image],
    [Results].[URL],
    (SELECT P.P FROM P WHERE P.ResultID = Results.Id AND P.Index = "0") as P0,
    (SELECT P.P FROM P WHERE P.ResultID = Results.Id AND P.Index = "1") as P1,
    (SELECT P.P FROM P WHERE P.ResultID = Results.Id AND P.Index = "2") as P2,
    (SELECT P.P FROM P WHERE P.ResultID = Results.Id AND P.Index = "3") as P3,
    (SELECT P.P FROM P WHERE P.ResultID = Results.Id AND P.Index = "4") as P4,
    (SELECT P.P FROM P WHERE P.ResultID = Results.Id AND P.Index = "5") as P5,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "0") as B0,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "1") as B1,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "2") as B2,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "3") as B3,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "4") as B4,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "5") as B5,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "6") as B6,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "7") as B7,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "8") as B8,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "9") as B9,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "10") as B10,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "11") as B11,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "12") as B12,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "13") as B13,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "14") as B14,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "15") as B15,
    (SELECT B.B FROM B WHERE B.ResultID = Results.Id AND B.Index = "16") as B16,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "1") as S1,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "2") as S2,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "3") as S3,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "4") as S4,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "5") as S5,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "6") as S6,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "7") as S7,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "8") as S8,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "9") as S9,
    (SELECT S.S FROM S WHERE S.ResultID = Results.Id AND S.Index = "10") as S10,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "0") as C0,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "1") as C1,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "2") as C2,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "3") as C3,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "4") as C4,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "5") as C5,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "6") as C6,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "7") as C7,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "8") as C8,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "9") as C9,
    (SELECT C.C FROM C WHERE C.ResultID = Results.Id AND C.Index = "10") as C10
FROM 
    Results 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:27:16.013

我不确定您从哪里得到以下信息：

> *我没有使用 JOIN，因为 MS Access 仅支持内部联接，而我需要的是外部联接*

MS Access 支持[`OUTER JOIN`语法](http://office.microsoft.com/en-us/access-help/creating-an-outer-join-query-in-access-HA001034555.aspx)。

`LEFT JOIN`您可以用每个表之间的 a 替换您的相关子查询。您的代码将与此类似：

```
SELECT 
    [Results].[Id],
    [Results].[Name],
    [Results].[OfferPrice],
    [Results].[RegPrice],
    [Results].[ImageFileName],
    [Results].[Image],
    [Results].[URL],
    max(IIF(P.Index = "0", P.P, null)) as P0,
    max(IIF(P.Index = "1", P.P, null)) as P1,
    max(IIF(P.Index = "2", P.P, null)) as P2,
    max(IIF(P.Index = "3", P.P, null)) as P3,
    max(IIF(P.Index = "4", P.P, null)) as P4,
    max(IIF(P.Index = "5", P.P, null)) as P5,
    max(IIF(B.Index = "0", B.B, null)) as B0,
    max(IIF(B.Index = "1", B.B, null)) as B1,
    max(IIF(B.Index = "8", B.B, null)) as B8,
    max(IIF(S.Index = "2", S.S, null)) as S2,
    max(IIF(C.Index = "1", C.C, null)) as C1
FROM Results
LEFT JOIN P
    on P.ResultID = Results.Id
LEFT JOIN B
    on B.ResultID = Results.Id
LEFT JOIN S
    on S.ResultID = Results.Id
LEFT JOIN C
    on C.ResultID = Results.Id
GROUP BY [Results].[Id],
    [Results].[Name],
    [Results].[OfferPrice],
    [Results].[RegPrice],
    [Results].[ImageFileName],
    [Results].[Image],
    [Results].[URL] 
```

您还应该能够使用该函数对数据进行*透视*`TRANSFORM`，代码将与此类似：

```
TRANSFORM Max(Src.Value)
select 
    [Results].[Id],
    [Results].[Name],
    [Results].[OfferPrice],
    [Results].[RegPrice],
    [Results].[ImageFileName],
    [Results].[Image],
    [Results].[URL]
from results as R
left join
(
    select ResultID, P as Value, "P"&Index as col
    from p
    union all
    select ResultID, B as Value, "B"&Index as col
    from B
    union all
    select ResultID, C as Value, "C"&Index as col
    from C
    union all
    select ResultID, S as Value, "S"&Index as col
    from S
) as Src
    on R.id = Src.ResultID
GROUP BY [Results].[Id], [Results].[Name],
    [Results].[OfferPrice],[Results].[RegPrice],
    [Results].[ImageFileName], [Results].[Image],
    [Results].[URL]
PIVOT Src.col 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:25:29.063

如果您明确连接，您的查询将运行得更快。这是模板：

```
SELECT 
    [Results].[Id],
    [Results].[Name],
    [Results].[OfferPrice],
    [Results].[RegPrice],
    [Results].[ImageFileName],
    [Results].[Image],
    [Results].[URL],
    max(iif(p.index = "0", p.p, "")) as p0,
    . . .
FROM results left outer join
     p
     on results.id = p.resultid left outer join
     . . .
group by [Results].[Id],
    [Results].[Name],
    [Results].[OfferPrice],
    [Results].[RegPrice],
    [Results].[ImageFileName],
    [Results].[Image],
    [Results].[URL] 
```

这个想法是用来`left outer join`引入表并在正确的条件下加入它们，并使用聚合将它们缩小到每个结果一行。中的逻辑`SELECT`根据您设置的逻辑选择值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T16:39:54.750

这应该运行得很快。看起来您正试图对一个表和多个表的联合之间的连接进行透视。下`unionized`表替换了您的所有联接。并且这是旋转的事实取代了执行任何相关子查询的需要。

```
TRANSFORM Max(unionized.DataColumn) AS MaxOfDataColumn
SELECT Results.ResName, Results.OfferPrice, Results.RegPrice, Results.Image, Results.URL
FROM (
    Select B.ID, B.B as DataColumn, "B"&B.B as tableName from B
    union all select C.ID, C.C, "C"&C.C from C
    union all select P.ID, P.P, "P"&P.P from P
    union all select S.ID, S.S, "S"&S.S from S)  AS unionized 
RIGHT JOIN Results ON unionized.ID = Results.ID
GROUP BY Results.ResName, Results.OfferPrice, Results.RegPrice, Results.Image, Results.URL
PIVOT unionized.tableName; 
```

您需要稍微清理一下，因为我假设您使用的是示例列，但希望您明白这一点。

# c# - 无法获取控制器的输入参数，Ajax.ActionLink

> ID：14836863
> 
> 赞同：1
> 
> 时间：2013-02-12T16:16:03.243
> 
> 标签：c#, asp.net-mvc, asp.net-ajax

我在将数据传递到 MVC3 中的控制器时遇到问题

我有一个看起来像这样的视图

```
@Ajax.ActionLink("MyController", "Myfunction", new {id =item.data},  
     new AjaxOptions
                    {
                      UpdateTargetId = "myDiv",
                      InsertionMode = InsertionMode.Replace,
                     })

<div id="myDiv"> </div> 
```

还有一个看起来像这样的控制器

```
 public ActionResult Myfunction(string data)
       {
              //some code
              return PartialView(chart);
       } 
```

一切正常，但数据没有进入控制器（当我设置断点时它为空），当我将鼠标悬停在链接上时，我看到地址字段中的数据。我必须在路由表中进行一些调整吗？

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:17:24.253

> 一切正常，但数据没有进入控制器（当我设置断点时它为空）

* * *

更改此行：

```
@Ajax.ActionLink("MyController", "Myfunction", new {id=item.data}, 
```

成为：

```
@Ajax.ActionLink("MyController", "Myfunction", new {data =item.data}, 
```

在 POST 中声明的变量名称需要与服务器捕获的名称相匹配，换句话说，您`Controller Action method`期望一个参数`data`并且它被传递`id`

# .net - VB.NET、INFER ON 和 Enum.GetValues

> ID：14836864
> 
> 赞同：0
> 
> 时间：2013-02-12T16:16:02.893
> 
> 标签：.net, vb.net, reflection, enumeration, type-inference

我的项目经理要求我从我们的解决方案中删除所有“Option Infer On”指令（在他看来，为了没有未定义的类型）。

```
Dim enums = [Enum].GetValues(enumType) ' here I will use "As Array" 

For Each item In enums ' <================== WHAT TYPE TO USE HERE?
  Dim ienum As [Enum] = CType(item, [Enum])

  Dim name As String
  Dim caption As String

  name = ienum.GetPropertyName
  caption = ienum.GetStringValue

  myDict.Add(caption, name)
Next item 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:21:25.157

GetValues 的返回类型是一个对象数组。因此，For Each 循环中“项目”变量的类型将是 Object。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:26:17.957

根据[MSDN](http://msdn.microsoft.com/en-GB/library/system.enum.getvalues.aspx)，它是一个常量数组，因此它将是一个可以转换为 Integer 的对象数组。

FWIW 我有一些代码可以完成类似的工作，它会获取针对每个 Enum 值存储的属性。为此，我使用了[GetNames](http://msdn.microsoft.com/en-us/library/system.enum.getnames.aspx)，然后反射回支持 Enum 字段，我可以在其中搜索存储各种元数据的自定义属性，例如“DisplayName”等。然后可以使用`[Enum].Parse()`.

希望有帮助！另外，我认为必须更改所有代码是一个愚蠢的主意，因为您的经理不信任语言/开发人员！

# regex - 右 gsub 正则表达式条目

> ID：14836865
> 
> 赞同：0
> 
> 时间：2013-02-12T16:16:08.690
> 
> 标签：regex, r, sed

有这样的字符串：

```
 "structure(list(a = 5, f = 6), .Names = c(\"a\", \"f\"))" 
```

哪部分

```
 "structure(list(            ), .Names = c(            ))" 
```

始终保持不变。括号内的 x=y 条目和 c() 内的对应条目也在改变内容 y、标签 x 和计数。

什么是正确的全局替换，例如在 sed 或 R gsub 中，以获得结果

```
 "a = 5, f = 6" 
```

只使用一个 gsub 调用？即，之前和之后的一切都消失了。

其目的是像一个单词一样“按原样”获取 R 省略号内容，并将其组合成报告中某个位置的文本。所以来源来自“……”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:30:57.533

解决方案之一：

```
gsub("structure\\(list\\((.*)\\), .*$", "\\1", x)
# [1] "a = 5, f = 6" 
```

或等效地：

```
gsub(".*list\\((.*)\\), .*$", "\\1", x) 
```

# php - 是否有用于 PHP 的数据库建模库，我可以将其用作支持从表生成模型的第三方？

> ID：14836866
> 
> 赞同：0
> 
> 时间：2013-02-12T16:16:12.793
> 
> 标签：php, database, activerecord, model, code-generation

我有一个编写程序的旧 php 项目。我正在寻找一个可以从 mysql 数据库表中生成模型的库，以便我可以将它们用作代码中的对象并避免大量重复。类似于现代 PHP 框架中的 ActiveRecord 建模类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:19:11.353

[Doctrine 1.2](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/index.html)，[Doctrine2](http://docs.doctrine-project.org/en/latest/index.html)（与[CodeGenerator 项目](https://github.com/beberlei/DoctrineCodeGenerator)）。我认为[Propel](http://propelorm.org/documentation/#project_setup)仍然支持这一点。

# ios - UIButton touch 在目标 c 中的 xcode 4.5 中没有响应

> ID：14836867
> 
> 赞同：-6
> 
> 时间：2013-02-12T16:16:14.353
> 
> 标签：ios, objective-c, ios5, ios6, uibutton

我在 xcode 4.3 中创建了一个开发目标为 5.1 的项目。现在我想为 iphone 5 更新我的应用程序。我刚刚在 xcode 4.5 中运行代码，它编译并成功运行，但屏幕顶部和底部的一些按钮没有响应任何触摸事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T09:36:45.917

不知道这个问题，但删除了旧的 UIButtons 并添加了对我有用的新按钮。

# mysql - 我正在使用 mysql dumper，我想从 web 禁用数据库备份 *.sql.gz

> ID：14836869
> 
> 赞同：2
> 
> 时间：2013-02-12T16:16:17.270
> 
> 标签：mysql, security, .htaccess

我正在使用来自 mysqldumper.net 的 mysql dumper 脚本。

脚本本身有一个 BasicAuth 保护，它生成它，因此我必须使用用户名和密码登录到 mysql 转储面板。

今天我复制了保存在其目录中的一个数据库备份文件的 url，我能够下载备份文件。

这是一个令人担忧的原因，因为我不希望任何人直接下载数据库文件。我只想在输入 HTTP BasicAuth 中设置的用户名和密码后下载。

这是由 mysql dumper 创建的 .htaccess 文件的代码

```
 <IfModule mod_rewrite.c>
RewriteEngine off
</IfModule>
AuthName "MySQLDumper"
AuthType Basic
AuthUserFile "/home/wwwpsk/public_html/admin/msd/.htpasswd"
require valid-user 
```

这是 .htpasswd 的代码

```
dbadmin:{SHA}+xdsf94LDKFDLJIODDK 
```

我尝试使用deny from all，但这会禁用我认为的所有内容，并且我不想从ip等使用allow，因为我的ISP ip每天都在变化。

所以伙计们，解决方案是禁用直接下载到目录中所有 *.sql.gz 文件的功能。

请帮帮我。

# java - Java ArrayList：使用字符串名称添加对象

> ID：14836870
> 
> 赞同：-3
> 
> 时间：2013-02-12T16:16:17.460
> 
> 标签：java, string, for-loop, arraylist

这是一个非常简单的任务，但我觉得我忽略了一些东西。我有多个要添加到 ArrayList 的对象，每个对象都有一个字符串形式的标识名称。我需要能够通过调用字符串名称来查找（交互）ArrayList 中的对象。所以我尝试了这个：

在我的项目类中，我有： private String itemName;

```
public Item(String name)
{
    itemName = name;
} 
```

所以我可以给它一个名字供用户使用。

* * *

然后在与对象交互的类中，我创建了一个 ArrayList：

```
private ArrayList<Item> items = new ArrayList<Item>(); 
```

我首先通过它的实际对象名称将对象添加到arrayList，但我需要能够使用它的字符串名称与它进行交互，所以我尝试了这个：

```
public void removeItem(String itemName)
{
    for (int i = 0; i < items.size(); i++)
    {
        if (items.get(i).toString() == itemName)
        {
            items.remove(i);
        }
        break;
    }

} 
```

但它不会删除该项目。如果所有这些都令人困惑，那么本质上我正在尝试创建一个可以给 STRING 名称命名的 OBJECT（就像我对上面的项目所做的那样），然后能够将 OBJECT 添加到 ArrayList，然后最终成为能够通过调用 STRING 名称来删除、获取或对 ArrayList 中的 OBJECTS 执行某些操作。我知道我需要遍历 ArrayList，但我实际上无法获取该对象。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:18:56.813

你在这里犯了三个错误：

*   您正在使用`items.get(i).toString()`which 不会为您`itemName`提供`Item`. 如果你不覆盖一个，它只会给你一个类的字符串表示`Item`，由`Object`类的方法返回。`toString`但是，如果您重写了一个`toString`方法并`itemName`从中返回，这可能会起作用。但是，我没有看到。即使您已经覆盖了它，我建议您为您的字段设置*getter*和*setter*`itemName`，并使用它来返回`itemName`.

*   您正在使用`==`运算符比较字符串，这不会给您正确的结果。`equals`您应该始终使用方法比较字符串。

所以，你`if statement`应该看起来像：

```
 if (items.get(i).getName().equals(itemName)) 
```

*   第三个问题是，您正在尝试修改`List`您正在迭代的内容。这不会成功，并且可能会抛出`ConcurrentModificationException`. 您应该使用`Iterator`从`List`迭代中删除元素。

**有关这两个问题以及如何解决它们的更多详细信息，请参阅：**

*   [如何比较 Java 中的字符串？](https://stackoverflow.com/q/513832/1679863)
*   [遍历集合，在循环中删除时避免 ConcurrentModificationException](https://stackoverflow.com/q/223918/1679863)

此外，您可以考虑在您的 中覆盖`equals`方法`class`，然后您可以使用`equals`方法直接比较您的实例。

* * *

现在，已经指出了您的代码的一些*逻辑问题*，是时候指出一些*设计问题*了。

鉴于您的要求，您似乎需要使用 a `HashMap`，而不是 a`List`存储您的属性的某些自定义类型。您可以创建一个`map`这样的：

```
Map<String, Integer> map = new HashMap<String, Integer>(); 
```

它将包含`itemName`到各自的映射`Item`，然后`Item`为特定的 itemName 获取就像`map.get(itemName)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T16:21:14.070

听起来您应该`Map`为此使用 a ，例如`java.util.HashMap<String, Item>`。该`Map`接口提供了您正在寻找的那些操作，并且它也是可迭代的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T16:20:07.163

向您的对象添加一个 getter 以获取名称，如下所示：

```
public class Item {
   private final String name; //once given cannot change
   public Item(String name) {
      this.name = name; //yhis.name to distinguish between 2 variabled both called "name"
   }
   public String getName() {
      return name; //this.name not required as no other variable called "name" is in scope
   }
} 
```

那么你可以像这样找到你的项目：

```
for (Item item : theList) {
   if (item.getName.equals(requiredName)) {
      //got you!
   }
} 
```

一般来说，永远不要将字符串与`==`. 此外，如果你想从你正在迭代的列表中删除一个项目，你必须使用（旧的）迭代器语法：

```
Iterator<Item> iter = theList.iterator();
while (iter.hasNext()) {
   Item item = iter.next();
   if (item.getName.equals(requiredName)) {
      //got you!
      iter.remove();
      break; //no need to go over the rest of the list
   }
} 
```

最后，如果您只想按名称查找项目，则列表不是您最好的集合，因为查找项目可能需要遍历整个列表。地图（特别是哈希图）将为您提供此类操作的更好性能。您可以使用名称作为键

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T16:29:45.990

有这个 - 你实现 removeItem 的方式，你也可以直接使用 [ArrayList.remove(item.itemName) 来做](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#remove%28java.lang.Object)- 就在你坚持`ConcurrentModificationException`并重新实现已经存在的东西之前 - 看看图书馆！阅读 ArrayList 的文档！

澄清一下：在 Java 中（并且实际上仅在 Java 中）：`==`表示参考比较。

所以：

```
String a = "A";
String b = new StringBuilder("A").toString();
if (a == b) // --> false
if (a.equals(b)) // --> true 
```

您也可以考虑使用[org.apache.commons.lang.StringUtils.equals](http://commons.apache.org/lang/api-2.3/org/apache/commons/lang/StringUtils.html#equals%28java.lang.String,%20java.lang.String%29) - 这对于空指针是安全的。

正如其他人已经指出的那样 -`toString`只有在正确实现它的情况下 - 方法才能正常工作（在您的情况下返回名称）。By original`toString`返回一个类名和一个 ID。这可能不是您想要的（只需尝试将其打印出来）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T16:19:43.187

我的猜测是你 items.get(i).toString() 没有做你认为它做的事情。为什么不使用 items.get(i).name 之类的东西，或者在 Item 对象中为 name 创建 getter 或 setter 并通过 items.get(i).getName() 检索名称

# ios - 如何在 ios 6 应用程序中禁用标准顶栏（带电池、时间信息）

> ID：14836872
> 
> 赞同：4
> 
> 时间：2013-02-12T16:16:21.840
> 
> 标签：ios

我的问题是：如何在 ios 6 应用程序中禁用标准顶栏（带电池、时间信息）？

我的意思是那个：

![在此处输入图像描述](../Images/24e36b5e624a0e6c6d5b151791db49ab.png)

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:19:17.217

那是状态栏。您可以通过设置属性“ `Status Bar Initially hidden`。”来隐藏它。到`YES`info.plist 文件中的“”

你也可以通过代码隐藏，像这样

```
 [ UIApplication application setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone]; 
```

# c - 在 ARM 上将参数从 asm 传递给 C

> ID：14836874
> 
> 赞同：3
> 
> 时间：2013-02-12T16:16:25.670
> 
> 标签：c, assembly, arm

我在这个论坛上阅读了很多主题，并找到了很多关于这个主题的答案。我实现了从我的汇编代码中将 5 个参数传递给 C 函数。为此，我使用了以下说明：

```
mov r0, #0
mov r1, #1
mov r2, #2
mov r3, #3
mov r4, #4
STR r4, [sp, #-4]!
BL displayRegistersValue 
```

但是今天我试图将整个寄存器传递给 C 函数以将它们保存在 C 结构中。我试过这个指令：

```
STMDB sp!, {registers that i want to save} 
```

我的 C 函数：

```
displayRegistersValue(int registers[number_of_registers])
char printable = registers[0] + (int)'0'; // Convert in a printable character
print_uart0(&printable); 
```

但是我的显示器不好。那么，如何访问 C 代码中的寄存器呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T16:32:41.917

很确定 ARM 标准只允许 R0-R3 按值传递，因此最多 4 个。如果您需要更多值，则将它们压入堆栈并以这种方式访问​​它们 - 就像编译器一样。或者制作一个结构并传递它的地址。

好的，仔细检查了一下，我在[这里](http://en.wikipedia.org/wiki/Calling_convention)是指向 ARM 调用约定的链接 - 在页面下方。

要执行您想要的操作，请将某个内存位置（数组）的地址传递到您的汇编例程中。一旦你有了那个地址，可能在 r0 之内，你就可以 stmdb！到那个位置你所有的寄存器值和那个内存将在 C 级别上是可见的。

当心，这可能不会像你想象的那样做。根据上面的调用约定链接，允许这些值进行相当大的更改。如果这是为了调试，最好使用调试器并以这种方式观察寄存器。

好吧，你还是不明白这里：

```
 {
    int registerValues[14];

    myAsmRoutine(registerValues);

    print_uart0(& registerValues);
}

myAsmRoutine:
    stmia  r0!, {r1-r14}
    blx   lr 
```

我跳过了 R0 和 PC，但你明白了。此外，您需要做一些复杂的事情来将值更改为可打印的格式 - sprintf 或 itoa os 之类的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:13:03.110

```
displayRegistersValue(int registers[number_of_registers]) 
```

这是一个数组而不是结构，它作为指向某个东西的指针传递，而不是作为一长串项目。顺便说一句，结构也是如此。

通常最简单的方法是在 asm 中构造一个 C 函数来执行您想要的操作，然后查看编译器生成的内容，然后从那里开始（使用 ABI 文档进行确认等）。

```
#define NUMREGS 13
void displayRegistersValue(unsigned int registers[NUMREGS]);
void outer ( void )
{
    unsigned int regs[NUMREGS];
    displayRegistersValue(regs);
}

> arm-none-linux-gnueabi-gcc -O2 -c fun.c -o fun.o
> arm-none-linux-gnueabi-objdump -D fun.o

fun.o:     file format elf32-littlearm

Disassembly of section .text:

00000000 <outer>:
   0:   e52de004    push    {lr}        ; (str lr, [sp, #-4]!)
   4:   e24dd03c    sub sp, sp, #60 ; 0x3c
   8:   e28d0004    add r0, sp, #4
   c:   ebfffffe    bl  0 <displayRegistersValue>
  10:   e28dd03c    add sp, sp, #60 ; 0x3c
  14:   e49df004    pop {pc}        ; (ldr pc, [sp], #4) 
```

您将需要做类似的事情，通过添加堆栈指针在堆栈上腾出空间，保存 lr 这样您就不会使用分支链接将其丢弃，将寄存器复制到该内存（堆栈）点 r0 到开头要传递的内存/数组，然后调用函数（r0 是传递给函数的第一个也是唯一的参数）。

```
push {lr} 
mov lr,sp 
stmdb sp!,{r0-r12} 
mov r0,lr 
bl displayRegistersValue
add sp,sp,#52
pop {lr} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:44:28.113

引用 ARM APCS 文档：

“前四个寄存器 r0-r3 (a1-a4) 用于将参数值传递给子例程并从函数返回结果值。它们也可用于保存例程中的中间值（但通常，仅在子程序调用之间）。”

因此，如果您想将超过 4 个值传递给 C 函数，则需要传递堆栈中的其余值。更好的办法是将寄存器值放在已静态分配的内存区域中，并将内存地址（指针）传递给 C 函数。函数可以取消引用指针以获取寄存器值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T16:24:44.273

数组作为指针传递到单个寄存器中。如果你想要 5 个寄存器，那么你需要有 5 个参数（int i1、int i2 等）。

# jquery - 如何使用 Require.js 配置库插件？

> ID：14836875
> 
> 赞同：2
> 
> 时间：2013-02-12T16:16:28.953
> 
> 标签：jquery, backbone.js, datatables, requirejs, dependency-management

我有一个 jQuery / Require.js / Backbone 项目，它加载 jQuery Datatables 库及其几个插件。下面的配置工作正常，但看起来有点恶心。

**有没有更优雅的方式来加载所有依赖于 Datatables 的插件？**

如果加载给定库后加载子插件的“deps” shim 属性的倒数会很酷。

此外，在下面的配置中，我将所有外部依赖项加载到 App 范围中，因为它们实际上被我的应用程序中的每个 Backbone 视图使用，我不想在每个模块中定义/包含它们。

**在 App 范围内加载所有外部库而不是在每个视图中都包含它们是愚蠢的吗？**

我将非常感谢这里提供的任何最佳实践指导。我已经阅读了该站点上的很多相关主题，但在人们加载大量这样的依赖项的示例方式中找不到太多。

```
require.config({
    baseUrl: 'js/com/mycompany/',
    paths: {
        jquery: '/js/lib/jquery',
        underscore: '/js/lib/underscore/underscore',
        backbone: '/js/lib/backbone/backbone',
        text: '/js/lib/require/text',

        jqueryui: '/js/lib/ui/jquery-ui-1.10.0.custom.min',
        json: '/js/lib/json/jquery.json-2.3.min',
        datatables: '/js/lib/datatables/js/jquery.dataTables.min',
        datatablesSelectable: '/js/lib/datatables/js/datatables.Selectable',
        datatablesToggle: '/js/lib/datatables/js/jquery.groupToggle',
        datatablesResize: '/js/lib/datatables/js/ColReorderWithResize',
        datatablesTableTools: '/js/lib/datatables/tabletools/js/TableTools.min',
        toaster: '/js/lib/toaster/javascript/jquery.toastmessage',
        cookie: '/js/lib/cookie/jquery.cookie',
        validation: '/js/lib/validation/jquery.validate',
        validationAdditional: '/js/lib/validation/additional-methods',
        alerts: '/js/lib/alerts/jquery.alerts',
        loadmask: '/js/lib/loadmask/jquery.loadmask.min',
        qtip: '/js/lib/qtip/jquery.qtip.min',
        dropdown: '/js/lib/dropdown/jquery.dropdown',

        extensions: '/js/com/mycompany/common/extensions',
        app: 'app'
    }, 
    shim: {
        jquery: {
            exports: '$'
        },
        underscore: {
            exports: '_'
        },
        backbone: {
            deps: ["underscore", "jquery"],
            exports: "Backbone"
        },
        jqueryui: { deps: ["jquery"] },

        datatables: { deps: ["jquery"] },
        datatablesSelectable: { deps: ["datatables"] },
        datatablesToggle: { deps: ["datatables"] },
        datatablesResize: { deps: ["datatables"] },
        datatablesTableTools: { deps: ["datatables"] },

        toaster: { deps: ["jquery"] },
        cookie: { deps: ["jquery"] },
        validation: { deps: ["jquery"] },
        validationAdditional: { deps: ["validation"] },
        alerts: { deps: ["jquery"] },
        loadmask: { deps: ["jquery"] },
        qtip: { deps: ["jquery"] },
        dropdown: { deps: ["jquery"] },
        json: { deps: ["jquery"] },

        extensions: { deps: ["jquery", "datatables"] }
    }
});

require([

    'app',
    'extensions',

    'backbone',
    'jqueryui',
    'datatables',
    'datatablesSelectable',
    'datatablesToggle',
    'datatablesResize',
    'datatablesTableTools',
    'toaster',
    'validation',
    'validationAdditional',
    'alerts',
    'loadmask',
    'qtip',
    'json'

], function(
    App,
    extensions,

    // including all these here because they are used by literally
    // every view in the app. seems kinda gross
    Backbone,
    jqueryui,
    datatables,
    datatablesSelectable,
    datatablesToggle,
    datatablesResize,
    datatablesTableTools,
    toaster,
    validation,
    validationAdditional,
    alerts,
    loadmask,
    qtip,
    json

    ){

    App.initialize();

}); 
```

路径配置可能看起来有点奇怪，因为我在网络服务器的根“/”上下文中有一个基本应用程序（所有常见的外部 Javascript 库都位于该位置）。这个应用程序存在于一个子上下文中（例如“/myapp”），它有自己的自定义脚本的本地 js 目录。

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:31:35.207

既然所有插件都是“普通 JS”文件，为什么不将所有插件连接 + 缩小到一个文件中呢？称它为“myjqplugins.js”并且只有一个条目`paths`和一个条目`shims`

或者，至少将它们连接到有凝聚力的组中：validation + validationAdditional Toaster + qtip + others Datatables*** 作为一个文件。

^ 3`paths`个条目 + 3`shims`个条目。

# android - Android java.lang.StackOverflowError TransitionDrawable

> ID：14836879
> 
> 赞同：1
> 
> 时间：2013-02-12T16:16:38.613
> 
> 标签：android, stack-overflow, transitiondrawable

在 textview 上应用 TransitionDrawable 时出现 stackoverflow 错误：

```
private static void applyAnimationTransitionBackground(String descriptorValue, final Resources resources, View view){
Drawable currentBackground;
TransitionDrawable td;

if (view!=null){

    //Get current background or transparent color
    currentBackground = view.getBackground();
    if (currentBackground==null){
        currentBackground = new ColorDrawable(android.R.color.transparent);
    }

    //Create transition depend on trend
    if (descriptorValue.equals("1")){
        td= new TransitionDrawable (new Drawable []{currentBackground, new ColorDrawable(resources.getColor(R.color.positive_animation))}); 
    }else if (descriptorValue.equals("2")){
        td= new TransitionDrawable (new Drawable []{currentBackground, new ColorDrawable(resources.getColor(R.color.neutral_animation))});
    }else{
        td= new TransitionDrawable (new Drawable []{currentBackground, new ColorDrawable(resources.getColor(R.color.negative_animation))});
    }

    //Apply animation
    if (td!=null){
        view.setBackgroundDrawable(td);
        td.startTransition(500);
        //td.reverseTransition(500);            
    }else{
        Logger.error("applyAnimationTransitionBackground: TransitionDrawable is NULL");
    }   

} 
```

}

```
02-12 17:00:12.899: I/System.out(11217): ---> M SAN nuevo valor 1,52%
02-12 17:00:12.907: I/System.out(11217): ---> M SAN nuevo valor SANTANDER
02-12 17:00:12.907: W/Resources(11217): Converting to string: TypedValue{t=0x11/d=0x55 a=-1}
02-12 17:00:12.907: W/Resources(11217): Converting to string: TypedValue{t=0x10/d=0xfffffffe a=-1}
02-12 17:00:12.915: I/System.out(11217): ---> M SAN nuevo valor 1,52%
02-12 17:00:12.915: I/System.out(11217): ---> M SAN nuevo valor SANTANDER
02-12 17:00:12.915: W/Resources(11217): Converting to string: TypedValue{t=0x11/d=0x55 a=-1}
02-12 17:00:12.915: W/Resources(11217): Converting to string: TypedValue{t=0x10/d=0xfffffffe a=-1}
02-12 17:00:12.915: I/dalvikvm(11217): threadid=1: stack overflow on call to Landroid/view/GLES20Canvas;.setupModifiers:IL
02-12 17:00:12.915: I/dalvikvm(11217):   method requires 40+20+20=80 bytes, fp is 0x4016b324 (36 left)
02-12 17:00:12.915: I/dalvikvm(11217):   expanding stack end (0x4016b300 to 0x4016b000)
02-12 17:00:12.915: I/dalvikvm(11217): Shrank stack (to 0x4016b300, curFrame is 0x4016e420)
02-12 17:00:12.915: D/AndroidRuntime(11217): Shutting down VM
02-12 17:00:12.915: W/dalvikvm(11217): threadid=1: thread exiting with uncaught exception (group=0x40bd91f8)
02-12 17:00:12.961: E/AndroidRuntime(11217): FATAL EXCEPTION: main
02-12 17:00:12.961: E/AndroidRuntime(11217): java.lang.StackOverflowError
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.view.GLES20Canvas.drawRect(GLES20Canvas.java:942)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.view.GLES20RecordingCanvas.drawRect(GLES20RecordingCanvas.java:226)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.view.GLES20Canvas.drawRect(GLES20Canvas.java:952)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.view.GLES20RecordingCanvas.drawRect(GLES20RecordingCanvas.java:232)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.ColorDrawable.draw(ColorDrawable.java:70)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195)
02-12 17:00:12.961: E/AndroidRuntime(11217):    at android.graphics.drawable.TransitionDrawable.draw(TransitionDrawable.java:195) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:36:18.810

我几乎可以肯定你会调用`applyAnimationTransitionBackground()`一个循环，例如`onDrawFrame()`a `Renderer`（我这么说只是因为我在那里看到了 GL ES 的用法，但它可能是某种动画或其他东西）。

我这么认为是因为您设置了`view`. 首先背景`view`是两种颜色之间的可绘制过渡 - 我们称之为`T(C1, C2)`。对于每个连续调用，背景`view`设置为可在以下之间绘制的过渡：

1.  目前的背景`view`和
2.  一些颜色可绘制

有效：

1.  第二次调用后，`view`背景设置为过渡`T(T(C1, C2), C3)`。
2.  第三次调用后，`view`背景设置为 transition `T(T(T(C1, C2), C3), C4)`。
3.  等等...

实际上，即使在 100 次调用之后，您仍然可以将背景可绘制对象设置为 100 个过渡可绘制对象的*大量*组合。您可以想象在对您的方法进行 1000 或 10000 次调用之后会发生什么。由于过渡可绘制对象只是将绘图委托给其组件可绘制对象，因此最终会导致堆栈溢出。

检查是否确实如此的最简单方法是将行`Logger.info("call");`放在`applyAnimationTransitionBackground()`. 如果您在日志 (LogCat) 中看到大量`call`消息，那么就是这种情况。

要解决此问题，您只需放弃这种组合可绘制对象的模式。例如，您可以保存用于过渡的最后颜色值及其开始时间。然后，当您需要在当前颜色和新颜色之间创建过渡时，可以使用保存的开始时间和颜色来插入背景的当前颜色。然后，您可以简单地创建一个新的可绘制过渡 - 在当前颜色和新颜色之间。

# svn - svn merge --reintegrate 在“缺失范围”上失败

> ID：14836880
> 
> 赞同：2
> 
> 时间：2013-02-12T16:16:40.547
> 
> 标签：svn, merge, conflict, svn-reintegrate

情况是这样的：

一个团队致力于长期的功能分支（18 个月）。定期将主干合并回此功能分支（每月开始，之后每两/三个月）。

今天我们想使用 reintegrate 功能将功能分支合并回主干。

问题是我们得到了很多（数千！）：

```
branches/feature/dir/file.foo
Missing ranges: /trunk/dir/file.foo:94959 
```

但是，当我检查 svn 日志时，我可以看到 94000-96500 范围确实在过去的某个时间被合并了。

这里发生了什么？如果不是真的，为什么 svn 会抱怨“缺少范围”？如果我在 94000-96500 上看到合并信息，是否会有 r94959 丢失的原因？我该如何解决这个问题（正如我所说，我们正在谈论数千个“缺失”的修订）？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T19:56:09.713

这通常发生在以下场景中：

1.  你的树干有两个类似的分支`branch1`并且`branch2`并行工作。
2.  `branch1`先创建后`branch2`创建。但是，`branch2`更改首先完成，然后重新集成到主干。
3.  在重新整合之前`branch1`，我们需要做一个`svn merge`（不是`svn merge --reintegrate`）从主干到`branch1`并解决冲突。
4.  在此期间，我们可能会获得一些文件夹，其中一些文件夹的属性也发生了变化，其中一些`merge-info`. 如果我们不要提交这些文件夹，因为这些只是`merge-info`属性更改，那么在`reintegrate`合并`branch1`.

如果这是您的情况，您可以尝试的解决方案是`svn merge`从您的主干`branch1`再次执行一次，您将再次`merge-info`在您的文件夹中更新您的属性并将其提交到`branch1`. 然后，使用`svn merge --reintegrate`from `branch1`to trunk 重试。

# python - python扭曲套接字失败

> ID：14836881
> 
> 赞同：1
> 
> 时间：2013-02-12T16:16:45.447
> 
> 标签：python, ssl

我正在尝试使用 ssl 对服务器进行编码，但是有一个我不明白的错误。这是代码：

```
import socket, ssl, select, sys, exceptions

def do_something(connstream, data):
if not data:
    return False
connstream.write(data)
print data
return True

def deal_with_client(connstream):
data = connstream.read()
# null data means the client is finished with us
while data:
    if not do_something(connstream, data):
        # we'll assume do_something returns False
        # when we're finished with client
        break
    data = connstream.read()
# finished with client

bindsocket = socket.socket()
bindsocket.bind(('127.0.0.1', 240))
bindsocket.listen(5)

while True:
newsocket, fromaddr = bindsocket.accept()
try:
    connstream = ssl.wrap_socket(newsocket, server_side=True, certfile="E:\oromenetwork\test\cert", keyfile="E:\oromenetwork\test\key", ca_certs=None, ssl_version=ssl.PROTOCOL_TLSv1)
    connstream.write("Bonjour")
    deal_with_client(connstream)
except ssl.SSLError as e:
    print "warp error "
    print e
    newsocket.shutdown(socket.SHUT_RDWR)
    newsocket.close()
    exit()
except exceptions.TypeError as e:
    print "other error"
    #print "Unexpected error:", sys.exc_info()[0]
    print e
    newsocket.shutdown(socket.SHUT_RDWR)
    newsocket.close()
    exit() 
```

所以我用 openssl s_client -connect 127.0.0.1:240 测试它

这是错误：[Errno 336265218] _ssl.c:351 error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system lib

我已经检查了权限和路径

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:20:15.677

在您的证书文件和密钥文件的字符串中，您使用`"\t",`的是 Tab 的别名。转义反斜杠（如`"\\"`）、使用[`os.path.join`](http://docs.python.org/dev/library/os.path.html#os.path.join)或[原始字符串](http://docs.python.org/dev/reference/lexical_analysis.html#string-and-bytes-literals)：

```
connstream = ssl.wrap_socket(newsocket, server_side=True,
                             certfile=r"E:\oromenetwork\test\cert",
                             #       v^
                             keyfile=r"E:\oromenetwork\test\key",
                             ca_certs=None,ssl_version=ssl.PROTOCOL_TLSv1) 
```

# javascript - SVG 元素出现在 DOM 中，但在屏幕上不可见

> ID：14836888
> 
> 赞同：4
> 
> 时间：2013-02-12T16:17:12.340
> 
> 标签：javascript, svg, raphael

我尝试使用[Vexflow](http://www.vexflow.com)和[Raphael.js](http://raphaeljs.com)使用 SVG 绘制五线谱，当我加载页面时，SVG 元素出现在 DOM 中，但它们没有出现在屏幕上。

我检查了是否有任何可以隐藏元素的 CSS 规则，但没有任何.. 还检查了不同的浏览器，不同的 lib 版本，什么都没有......

这是出现在 DOM 中的 SVG：

```
<html lang="en"><head>
    <meta charset="utf-8">
    <title>Fermata</title>

    <!-- Raphael.js -->
    <script src="../deps/raphael/raphael-min.js"></script>

    <!-- VexFlow Uncompiled Sources -->
    <script src="../deps/vexflow/src/header.js"></script>
    <script src="../deps/vexflow/src/vex.js"></script>
    <script src="../deps/vexflow/src/flow.js"></script>
    <script src="../deps/vexflow/src/fraction.js"></script>
    <script src="../deps/vexflow/src/fonts/vexflow_font.js"></script>
    <script src="../deps/vexflow/src/glyph.js"></script>
    <script src="../deps/vexflow/src/tables.js"></script>
    <script src="../deps/vexflow/src/stave.js"></script>
    <script src="../deps/vexflow/src/staveconnector.js"></script>
    <script src="../deps/vexflow/src/tabstave.js"></script>
    <script src="../deps/vexflow/src/voice.js"></script>
    <script src="../deps/vexflow/src/voicegroup.js"></script>
    <script src="../deps/vexflow/src/modifier.js"></script>
    <script src="../deps/vexflow/src/modifiercontext.js"></script>
    <script src="../deps/vexflow/src/accidental.js"></script>
    <script src="../deps/vexflow/src/dot.js"></script>
    <script src="../deps/vexflow/src/tickcontext.js"></script>
    <script src="../deps/vexflow/src/tickable.js"></script>
    <script src="../deps/vexflow/src/note.js"></script>
    <script src="../deps/vexflow/src/bend.js"></script>
    <script src="../deps/vexflow/src/stavenote.js"></script>
    <script src="../deps/vexflow/src/tabnote.js"></script>
    <script src="../deps/vexflow/src/barnote.js"></script>
    <script src="../deps/vexflow/src/ghostnote.js"></script>
    <script src="../deps/vexflow/src/formatter.js"></script>
    <script src="../deps/vexflow/src/stavetie.js"></script>
    <script src="../deps/vexflow/src/stavehairpin.js"></script>
    <script src="../deps/vexflow/src/tabtie.js"></script>
    <script src="../deps/vexflow/src/tabslide.js"></script>
    <script src="../deps/vexflow/src/beam.js"></script>
    <script src="../deps/vexflow/src/vibrato.js"></script>
    <script src="../deps/vexflow/src/annotation.js"></script>
    <script src="../deps/vexflow/src/tuning.js"></script>
    <script src="../deps/vexflow/src/stavemodifier.js"></script>
    <script src="../deps/vexflow/src/keysignature.js"></script>
    <script src="../deps/vexflow/src/timesignature.js"></script>
    <script src="../deps/vexflow/src/clef.js"></script>
    <script src="../deps/vexflow/src/music.js"></script>
    <script src="../deps/vexflow/src/keymanager.js"></script>
    <script src="../deps/vexflow/src/renderer.js"></script>
    <script src="../deps/vexflow/src/stavebarline.js"></script>
    <script src="../deps/vexflow/src/stavevolta.js"></script>
    <script src="../deps/vexflow/src/staverepetition.js"></script>
    <script src="../deps/vexflow/src/stavesection.js"></script>
    <script src="../deps/vexflow/src/stavetempo.js"></script>
    <script src="../deps/vexflow/src/articulation.js"></script>
    <script src="../deps/vexflow/src/tremolo.js"></script>
    <script src="../deps/vexflow/src/raphaelcontext.js"></script>
    <script src="../deps/vexflow/src/tuplet.js"></script>
    <script src="../deps/vexflow/src/boundingbox.js"></script>
    <script src="../deps/vexflow/src/textnote.js"></script>
    <script src="../deps/vexflow/src/strokes.js"></script>
    <script src="../deps/vexflow/src/stringnumber.js"></script>
    <script src="../deps/vexflow/src/frethandfinger.js"></script>

    <!-- Fermat srcs -->
    <script src="../src/Fermata.js"></script>
    <script src="../src/Fermata.Utils.js"></script>
    <script src="../src/Fermata.Data.js"></script>
    <script src="../src/Fermata.Mapping.Clef.js"></script>
    <script src="../src/Fermata.Mapping.Direction.js"></script>
    <script src="../src/Fermata.Mapping.Connector.js"></script>
    <script src="../src/Fermata.Mapping.Barline.js"></script>
    <script src="../src/Fermata.Render.js"></script>
    <script src="../src/Fermata.Render.Call.js"></script>
    <script src="../src/Fermata.Render.SymbolSize.js"></script>
    <script src="../src/Fermata.Render.NoteStorage.js"></script>
    <script src="../src/Fermata.Render.NoteType.js"></script>
    <script src="../src/Fermata.Render.SoundType.js"></script>
    <script src="../src/Fermata.Render.PitchPitched.js"></script>
    <script src="../src/Fermata.Render.PitchRest.js"></script>
    <script src="../src/Fermata.Render.PitchUnpitched.js"></script>
    <script src="../src/Fermata.Render.NoteConverter.js"></script>
    <script src="../src/Fermata.Render.TieRenderer.js"></script>
    <script src="../src/Fermata.Render.GraceNote.js"></script>
    <script src="../src/Fermata.Render.CueNote.js"></script>
    <script src="../src/Fermata.Render.NormalNote.js"></script>
    <script src="../src/Fermata.Render.Note.js"></script>
    <script src="../src/Fermata.Render.RenderAttribute.js"></script>
    <script src="../src/Fermata.Render.Direction.js"></script>
    <script src="../src/Fermata.Render.Barline.js"></script>
    <script src="../src/Fermata.Render.Backup.js"></script>
    <script src="../src/Fermata.Render.PartList.js"></script>
    <script src="../src/Fermata.Render.Header.js"></script>
    <script src="../src/Fermata.Render.Score.js"></script>
    <script src="../src/Fermata.Drawer.js"></script>
    <script src="../src/Fermata.Drawer.Score.js"></script>
  </head>
  <body>
    <div class="container-score">
        <canvas id="canvas-score" width="1700px" height="250">
            <svg style="overflow: hidden; position: relative;" height="150" version="1.1" width="1700" xmlns="http://www.w3.org/2000/svg">
                <desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.0</desc>
                <defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></defs>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="20" y="40" width="0" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="20" y="50" width="0" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="20" y="60" width="0" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="20" y="70" width="0" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="20" y="80" width="0" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" fill="#000000" stroke="#000000" d="M25,70M39.0544,26.8288C39.112,26.800000000000004,39.1696,26.800000000000004,39.256,26.800000000000004C39.6016,26.800000000000004,40.0048,27.088,40.580799999999996,27.808C42.9136,30.486400000000003,44.5552,35.152,44.5552,38.9536C44.5552,39.241600000000005,44.4976,39.472,44.4976,39.760000000000005C44.2384,44.2816,42.3952,47.9968,38.7376,51.510400000000004L37.7584,52.4608L37.4128,52.8352L37.4128,52.9504L37.6144,53.8144L37.931200000000004,55.3696L38.248,56.8096C38.68,58.768,38.8528,59.775999999999996,38.8528,59.775999999999996C38.8528,59.775999999999996,38.8528,59.775999999999996,38.8528,59.775999999999996C38.8528,59.775999999999996,38.968,59.775999999999996,39.112,59.7472C39.256,59.7472,39.7168,59.6896,40.2064,59.6896C40.552,59.6896,40.8976,59.7472,41.0704,59.7472C45.1312,60.2656,48.270399999999995,63.1744,49.1632,67.264C49.336,67.9264,49.3936,68.6464,49.3936,69.3664C49.3936,73.2544,47.0608,76.9696,43.172799999999995,78.7264C42.9424,78.8704,42.855999999999995,78.89920000000001,42.855999999999995,78.89920000000001L42.855999999999995,78.928C42.855999999999995,78.928,43.028800000000004,79.5904,43.172799999999995,80.3392L43.6048,82.528L44.007999999999996,84.2848C44.2384,85.408,44.3536,86.2144,44.3536,86.9344C44.3536,87.568,44.2672,88.144,44.1232,88.8064C43.144,92.8096,39.6592,95.2,36.0304,95.2C34.2448,95.2,32.4016,94.624,30.788800000000002,93.328C29.3488,92.11840000000001,28.7152,91.024,28.7152,89.584C28.7152,87.0496,30.759999999999998,85.264,32.8912,85.264C33.64,85.264,34.3888,85.4944,35.1088,85.9264C36.3184,86.7616,36.8656,88.0288,36.8656,89.2672C36.8656,91.168,35.5408,93.03999999999999,33.2656,93.184L33.0352,93.184L33.208,93.2992C34.1584,93.7024,35.1088,93.904,36.0304,93.904C38.3632,93.904,40.552,92.72319999999999,41.8768,90.6784C42.6256,89.5264,43.028800000000004,88.1728,43.028800000000004,86.8192C43.028800000000004,86.3008,42.9424,85.7824,42.827200000000005,85.2064C42.827200000000005,85.1488,42.7408,84.688,42.6256,84.256C41.992000000000004,81.1456,41.617599999999996,79.3312,41.617599999999996,79.3312C41.617599999999996,79.3312,41.617599999999996,79.3312,41.617599999999996,79.3312C41.56,79.3312,41.4448,79.3312,41.3584,79.3888C41.0704,79.4464,40.4656,79.5904,40.2064,79.6192C39.5728,79.7056,38.968,79.7344,38.391999999999996,79.7344C32.7472,79.7344,27.5056,75.9328,25.6912,70.3168C25.2304,68.8192,24.9712,67.3216,24.9712,65.824C24.9712,62.8288,25.9216,59.8912,27.7648,57.2704C29.7808,54.419200000000004,31.7968,51.971199999999996,34.2736,49.436800000000005L35.1376,48.544L34.936,47.4784L34.5616,45.7216L34.072,43.4752C33.928,42.64,33.7552,41.833600000000004,33.7264,41.6608C33.5824,40.7104,33.496,39.7888,33.496,38.8384C33.496,35.2096,34.6768,31.724800000000002,36.8944,28.931200000000004C37.556799999999996,28.0672,38.7376,26.9152,39.0544,26.8288M40.8112,32.5312C40.7536,32.5312,40.6672,32.5312,40.580799999999996,32.5312C39.4,32.5312,37.873599999999996,33.6256,36.8368,35.2384C35.7712,36.8224,35.224000000000004,38.924800000000005,35.224000000000004,41.0848C35.224000000000004,41.6608,35.2528,42.2656,35.3392,42.870400000000004C35.4256,43.302400000000006,35.4544,43.5904,35.684799999999996,44.6272L36.088,46.4416C36.203199999999995,46.9888,36.2896,47.4208,36.2896,47.4784L36.2896,47.4784C36.3184,47.4784,37.2112,46.4992,37.4992,46.1536C40.3792,42.8992,42.1072,39.472,42.4816,36.448C42.510400000000004,36.160000000000004,42.510400000000004,35.9296,42.510400000000004,35.641600000000004C42.510400000000004,34.7488,42.3952,33.8848,42.1936,33.424C41.9632,32.9632,41.4448,32.5888,40.8112,32.5312M36.4624,54.7936C36.4048,54.3904,36.3184,54.0736,36.3184,54.016C36.3184,54.016,36.3184,54.016,36.2896,54.016C36.232,54.016,34.9936,55.456,34.129599999999996,56.464C32.6608,58.2496,31.1056,60.3808,30.472,61.4176C29.2624,63.4624,28.6576,65.7376,28.6576,67.984C28.6576,69.4528,28.9456,70.864,29.464,72.2176C31.019199999999998,76.2208,34.5904,78.7264,38.4784,78.7264C38.9392,78.7264,39.4576,78.6976,39.947199999999995,78.6112C40.580799999999996,78.496,41.3584,78.2656,41.3584,78.1792L41.3584,78.1792C41.3584,78.1792,41.300799999999995,77.8912,41.2144,77.5744L40.3792,73.456L39.7168,70.3744L39.2848,68.2432L38.824,66.1696C38.5936,64.9312,38.5072,64.6144,38.5072,64.6144C38.5072,64.6144,38.5072,64.5856,38.4784,64.5856C38.3056,64.5856,37.384,65.0464,36.9808,65.3344C35.4832,66.3712,34.705600000000004,68.0128,34.705600000000004,69.6256C34.705600000000004,71.152,35.4544,72.6784,36.8944,73.5712C37.2112,73.7728,37.3264,73.9456,37.3264,74.1472C37.3264,74.176,37.3264,74.2624,37.3264,74.2912C37.2688,74.6368,37.0672,74.7808,36.7792,74.7808C36.664,74.7808,36.519999999999996,74.752,36.3472,74.6656C33.6976,73.5136,31.912,70.7776,31.912,67.7824L31.912,67.7824C31.912,64.3264,34.072,61.3312,37.384,60.1504L37.556799999999996,60.0928L37.2688,58.6528L36.4624,54.7936M40.782399999999996,64.4128C40.552,64.384,40.321600000000004,64.384,40.1488,64.384C40.0912,64.384,40.0048,64.384,39.947199999999995,64.384L39.803200000000004,64.384L39.9184,64.9024L40.5232,67.7248L40.8976,69.568L41.300799999999995,71.3824L42.1072,75.3856L42.424,76.912C42.5392,77.3152,42.5968,77.6608,42.6256,77.6608C42.6256,77.6608,42.6256,77.6608,42.6256,77.6608C42.654399999999995,77.6608,43.144,77.3728,43.4608,77.1424C44.9296,76.1056,46.024,74.4928,46.4272,72.8224C46.571200000000005,72.2752,46.6288,71.6992,46.6288,71.152C46.6288,67.8112,44.152,64.7872,40.782399999999996,64.4128" stroke-width="0" font="10pt Arial"></path>
                <path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" fill="#000000" stroke="#000000" d="M64.46065,60M69.47185,41.654399999999995C69.50065000000001,41.625600000000006,69.90385,41.625600000000006,71.14225,41.625600000000006C71.51665,41.625600000000006,71.91985,41.625600000000006,72.43825,41.625600000000006L75.34705,41.625600000000006L75.43345,41.712C75.57745,41.7984,75.66385,41.9424,75.66385,42.0576C75.66385,42.2304,75.57745,42.345600000000005,75.46225,42.4608C75.43345,42.547200000000004,75.17425,42.7776,75.00145,43.0368L73.47505,44.7936L71.51665,47.0112L70.47985,48.192L68.92465,49.9776L66.87985,52.3104C66.53425,52.7424,66.15985,53.088,66.15985,53.088C66.15985,53.088,66.15985,53.088,66.15985,53.088C66.15985,53.1456,66.41905,53.1456,68.80945,53.1456L71.43025,53.1456L71.43025,51.2736C71.43025,49.3728,71.43025,49.344,71.45905,49.315200000000004C71.51665,49.2288,71.77585,48.912,72.78385,47.7312L73.18705,47.2992L73.59025,46.8672L74.19505,46.089600000000004L74.82865,45.4272L75.14545,45.024C75.26065,44.8512,75.43345,44.8224,75.57745,44.8224C75.75025,44.8224,75.89425,44.9088,75.98065,45.052800000000005C76.00945,45.1392,76.00945,45.196799999999996,76.00945,47.328C76.00945,47.8176,76.00945,48.422399999999996,76.00945,49.1424L76.00945,53.1456L76.72945,53.1456C77.39185,53.1456,77.42065,53.1456,77.50705,53.1744C77.73745,53.2608,77.85265,53.4912,77.85265,53.7504C77.85265,53.8944,77.82385,54.0672,77.70865,54.1824C77.53585,54.3264,77.50705,54.3264,76.72945,54.3264L76.00945,54.3264L76.00945,54.816C76.03825,56.2848,76.32625,56.8608,77.44945,57.4656C77.85265,57.6672,77.93905,57.7248,77.93905,58.0128C77.93905,58.2144,77.88145,58.3008,77.73745,58.416L77.65105,58.4448L73.70545,58.4448L69.78865,58.4448L69.70225,58.416C69.52945,58.3008,69.50065000000001,58.2144,69.50065000000001,58.0128C69.50065000000001,57.7248,69.52945,57.6672,69.96145,57.4656C71.08465,56.8608,71.37265000000001,56.2848,71.37265000000001,54.816L71.37265000000001,54.3264L68.06065,54.3264C67.45585,54.384,66.96625,54.384,66.56305,54.384C64.74865,54.384,64.71985000000001,54.3264,64.69105,54.3264C64.51825,54.2688,64.46065,54.096000000000004,64.46065,53.8944C64.46065,53.8944,64.46065,53.8944,64.46065,53.8944C64.46065,53.6928,64.46065,53.6928,65.03665,53.0304C67.45585,50.0928,69.15505,45.8304,69.15505,42.432C69.15505,41.9136,69.24145,41.7408,69.47185,41.654399999999995M71.19985,60.0288L71.22865,60.0288L71.14225,60.0288L71.19985,60.0288M71.19985,40.617599999999996L71.22865,40.617599999999996L71.14225,40.617599999999996L71.19985,40.617599999999996" stroke-width="0" font="10pt Arial"></path>
                <path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" fill="#000000" stroke="#000000" d="M64.46065,80M69.47185,61.654399999999995C69.50065000000001,61.625600000000006,69.90385,61.625600000000006,71.14225,61.625600000000006C71.51665,61.625600000000006,71.91985,61.625600000000006,72.43825,61.625600000000006L75.34705,61.625600000000006L75.43345,61.712C75.57745,61.7984,75.66385,61.9424,75.66385,62.0576C75.66385,62.2304,75.57745,62.345600000000005,75.46225,62.4608C75.43345,62.547200000000004,75.17425,62.7776,75.00145,63.0368L73.47505,64.7936L71.51665,67.0112L70.47985,68.19200000000001L68.92465,69.9776L66.87985,72.3104C66.53425,72.7424,66.15985,73.088,66.15985,73.088C66.15985,73.088,66.15985,73.088,66.15985,73.088C66.15985,73.1456,66.41905,73.1456,68.80945,73.1456L71.43025,73.1456L71.43025,71.2736C71.43025,69.3728,71.43025,69.344,71.45905,69.3152C71.51665,69.2288,71.77585,68.912,72.78385,67.7312L73.18705,67.2992L73.59025,66.8672L74.19505,66.0896L74.82865,65.4272L75.14545,65.024C75.26065,64.8512,75.43345,64.8224,75.57745,64.8224C75.75025,64.8224,75.89425,64.9088,75.98065,65.0528C76.00945,65.1392,76.00945,65.1968,76.00945,67.328C76.00945,67.8176,76.00945,68.4224,76.00945,69.1424L76.00945,73.1456L76.72945,73.1456C77.39185,73.1456,77.42065,73.1456,77.50705,73.1744C77.73745,73.2608,77.85265,73.4912,77.85265,73.7504C77.85265,73.8944,77.82385,74.0672,77.70865,74.1824C77.53585,74.3264,77.50705,74.3264,76.72945,74.3264L76.00945,74.3264L76.00945,74.816C76.03825,76.2848,76.32625,76.8608,77.44945,77.4656C77.85265,77.6672,77.93905,77.7248,77.93905,78.0128C77.93905,78.2144,77.88145,78.3008,77.73745,78.416L77.65105,78.4448L73.70545,78.4448L69.78865,78.4448L69.70225,78.416C69.52945,78.3008,69.50065000000001,78.2144,69.50065000000001,78.0128C69.50065000000001,77.7248,69.52945,77.6672,69.96145,77.4656C71.08465,76.8608,71.37265000000001,76.2848,71.37265000000001,74.816L71.37265000000001,74.3264L68.06065,74.3264C67.45585,74.384,66.96625,74.384,66.56305,74.384C64.74865,74.384,64.71985000000001,74.3264,64.69105,74.3264C64.51825,74.2688,64.46065,74.096,64.46065,73.8944C64.46065,73.8944,64.46065,73.8944,64.46065,73.8944C64.46065,73.6928,64.46065,73.6928,65.03665,73.0304C67.45585,70.0928,69.15505,65.8304,69.15505,62.432C69.15505,61.9136,69.24145,61.7408,69.47185,61.654399999999995M71.19985,80.0288L71.22865,80.0288L71.14225,80.0288L71.19985,80.0288M71.19985,60.617599999999996L71.22865,60.617599999999996L71.14225,60.617599999999996L71.19985,60.617599999999996" stroke-width="0" font="10pt Arial"></path>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="20" y="40" width="0.5" height="40.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="0" y="40" width="0.5" height="40.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" fill="#000000" stroke="#000000" d="M90,90M97.49664,84.96576C97.7976,84.91104,98.09855999999999,84.91104,98.39952,84.91104C102.7224,84.91104,106.33392,86.82624,106.85376,89.39808C106.88112,89.64432,106.93584,89.8632,106.93584,90.02736C106.93584,92.84544,103.21488,95.11632,98.42688,95.11632C93.63888,95.11632,90,92.79072,90,90.02736C90,89.69904,90.02736,89.37072,90.1368,89.01504C90.79344,86.8536,93.85776,85.18464,97.49664,84.96576M97.90704,85.59504C97.77024,85.56768,97.57872,85.56768,97.44192,85.56768C95.71824,85.56768,94.67856,87.04512,94.67856,88.87824C94.67856,89.8632,94.97952,90.93024,95.6088,91.99728C96.64848,93.63888,98.15328,94.45968,99.4392,94.45968C100.5336,94.45968,101.49119999999999,93.88512,101.92896,92.68128C102.12048,92.1888,102.20256,91.69632,102.20256,91.17648C102.20256,88.71408,100.31472,85.97808,97.90704,85.59504" stroke-width="0" font="10pt Arial"></path>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="87" y="90" width="22" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
                <rect style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-family: Arial;" x="87" y="90" width="22" height="0.5" r="0" rx="0" ry="0" fill="#000000" stroke="#000000" stroke-width="0.3" font="10pt Arial"></rect>
            </svg>
        </canvas>
    </div>

    <script>
        // Hello World
        var score = {"score-partwise":{"$version":"3.0","part-list":{"score-part":[{"$id":"P1","part-name":"Music"}]},"part":[{"$id":"P1","measure":[{"$number":"1","attributes":[{"divisions":"1","key":{"fifths":"0"},"time":{"beats":"4","beat-type":"4"},"clef":{"sign":"G","line":"2"}}],"note":[{"pitch":{"step":"C","octave":"4"},"duration":"4","type":"whole"}]}]}]}};
        var data = new Fermata.Data(score);
        var render = new Fermata.Render(data);
        render.renderAll();
        var drawer = new Fermata.Drawer(data, document.getElementById('canvas-score'));
        drawer.drawAll();
    </script><i title="Raphaël Colour Picker" style="display: none; color: black;"></i> 
</body>
</html> 
```

并且没有链接到页面的 CSS。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T16:19:42.793

如果通过 JavaScript 添加 SVG 元素，则必须为每个元素指定命名空间“ [http://www.w3.org/2000/svg ”。](http://www.w3.org/2000/svg)

例子

```
 path = document.createElementNS('http://www.w3.org/2000/svg', 'path'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T17:45:07.983

错误很明显，我将我的 svg 标签放在画布标签中（我刚刚从画布绘图切换到 svg 绘图），它无法在任何浏览器中工作。

答案：只需将*canvas*标签更改为*div*标签，它就像一个魅力。

# jquery - 我可以在 jQuery 中缓存 $(window) 和 $(document) 吗？

> ID：14836897
> 
> 赞同：8
> 
> 时间：2013-02-12T16:17:44.433
> 
> 标签：jquery, performance, caching

我最近阅读了一些关于 jQuery 性能的文章，并提出了一些奇怪的问题。

*   我可以/应该缓存`$(window)`吗？

    如果我这样做了，它会影响`resize`, `scroll`, `width`, `scrollTop`...等吗？

*   我可以/应该缓存`$(document)`吗？

    由于我们使用了很多鼠标操作，我应该这样做`var doc = $(document);`吗？

*   我可以*一直*缓存`$(this)`在一大块代码中吗？

    至于`var self = $(this);`，在什么情况下`self`可能会有所不同`$(this)`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T16:22:46.833

**所有三个问题：**是的，你可以！

**必需品：** 没有

**更好的表现：**也许

你可以尝试做一个基准测试。但是缓存的原因并不是要在整个 DOM 中搜索您的选择器。查找文档和窗口不是问题，因为它们是 2 个根变量。缓存 $(this) 取决于情况。请参阅我的第二个提示。

**始终缓存您对其运行查询的父对象：**

```
var header = $('#header');

var menu = header.find('.menu');
// or
var menu = $('.menu', header); 
```

**链接 jQuery 方法比缓存选择器更好：**

```
$('li.menu-item').click(function () {alert('test click');})
                     .css('display', 'block')
                     .css('color', 'red')
                     fadeTo(2, 0.7); 
```

**缓存您经常查询的元素：**

```
var header = $('#header');
var divs = header.find('div');
var forms = header.find('form'); 
```

**免费的额外性能提示：**

选择器从快到慢：

```
Id > Tag > classes 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-21T22:06:48.613

1.  是的，您可以缓存 $(window)，它确实有助于提高性能。
    有人已经在 jsperf 中做过测试。 [http://jsperf.com/jquery-window-cache](http://jsperf.com/jquery-window-cache)

    测试结果有点乱，但您仍然可以在浏览器上“运行测试”以查看差异。

2.  是的，您也可以缓存 $(document) 。我很少使用 $(document)，但是根据我在 jsperf ( [http://jsperf.com/document-vs-cache](http://jsperf.com/document-vs-cache) ) 中所做的测试，缓存 $(document) 对性能也有一些帮助。

3.  是的，您可以缓存 $(this)。但这一个与其他 cahces 不同。如您所知，$(this) 的值会根据不同的情况而变化。例如，如果您在这样的鼠标侦听器中使用 $(this) ......

    ```
    $(".button").on("click",function(){
       var $this = $(this);
    }); 
    ```

    $(this) 将在用户单击具有“button”类的按钮时发生变化，并且 $("this") 将成为用户单击的对象。

    如果在函数中大量使用 $(this)，缓存 $(this) 有助于提高性能。但是请记住，如果您在函数内部缓存 $(this)，缓存将成为局部变量而不是全局变量，并在函数结束时被销毁。所以你不能在函数之外使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-29T10:18:32.137

实际问题是，`Can I cache $(window) and $(document) in jQuery?`

如果您想缓存窗口或文档以便在同一会话中进一步使用，是的，您可以。

如果用户关闭窗口/会话，您创建的所有变量/函数都将被垃圾收集。

# android - 在 onCreate() 之前，Activity 无法使用 Android 系统服务

> ID：14836898
> 
> 赞同：-7
> 
> 时间：2013-02-12T16:17:48.293
> 
> 标签：android, runtime-error

```
....    

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ...

done = true;
}

...

public class addcontacts extends ListActivity {

     protected void onCreate() {

     }
     protected void execute(final Boolean success) {
if (done) {
         adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, listItems);
         setListAdapter(adapter);
}
     }

 }

public class UserLoginTask extends AsyncTask<Void, Void, Boolean> {

@Override
    protected Boolean doInBackground(Void... params) {

...

}
 @Override
    protected void onPostExecute(final Boolean success) {

            setContentView(R.layout.main);

            ac = new addcontacts();
            ac.execute(true);

    }

...

public class getcontacts extends AsyncTask<Void, Void, Boolean> {
    @Override
    protected Boolean doInBackground(Void... params) {

...
listItems.add(json_data.getString("login") + " " + derp);
...
}

...
}

 @Override
    protected void onPostExecute(final Boolean success) {
        getc = null;
        //showProgress(false);
        adapter.notifyDataSetChanged();
} 
```

运行时错误：

```
 02-12 15:59:35.274: E/AndroidRuntime(1308): FATAL EXCEPTION: main
 02-12 15:59:35.274: E/AndroidRuntime(1308): java.lang.IllegalStateException: System services not available to Activities before onCreate()
 02-12 15:59:35.274: E/AndroidRuntime(1308):    at android.app.Activity.getSystemService(Activity.java:3989)

 02-12 15:59:35.274: E/AndroidRuntime(1308):    at android.widget.ArrayAdapter.init(ArrayAdapter.java:310)
 02-12 15:59:35.274: E/AndroidRuntime(1308):    at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:153) 
```

任何想法如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:22:21.870

唯一被破坏的是你的代码。修复将是避免在 onCreate() 完成之前访问系统服务，否则还没有对活动对象进行设置，因此您面临自我解释的原因异常。

# mongodb - 在 mongos start 上配置配置服务器重试次数？

> ID：14836899
> 
> 赞同：1
> 
> 时间：2013-02-12T16:17:49.427
> 
> 标签：mongodb

`mongos`如果配置服务器不可用，我正在尝试快速启动和失败。现在，由于配置服务器不可用，我看到：

`Tue Feb 12 11:09:13 [mongosMain] can't resolve DNS for [compute-1-3] sleeping and trying 10 more times`

如何配置`10`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:54:29.467

10 次重试是硬编码的，不可配置。你可以在这里看到它：

[https://github.com/mongodb/mongo/blob/master/src/mongo/s/config.cpp#L742](https://github.com/mongodb/mongo/blob/master/src/mongo/s/config.cpp#L742)

以防万一行号发生变化，这是相关的计数器/循环：

```
for ( int x=10; x>0; x-- ) {
                if ( ! hostbyname( host.c_str() ).empty() ) {
                    ok = true;
                    break;
                }
                log() << "can't resolve DNS for [" << host << "]  sleeping and trying " << x << " more times" << endl;
                sleepsecs( 10 ); 
```

因此，理论上您可以更改代码并重新构建自己，但是您必须为新版本维护它。相反，我建议您保持配置服务器可用，或者至少在 mongos 启动后约 100 秒内启动它。

# javascript - 处理表单元素值的函数

> ID：14836905
> 
> 赞同：0
> 
> 时间：2013-02-12T16:17:57.617
> 
> 标签：javascript, jquery, html, css, forms

我正在尝试编写一个小函数来`placeholder`稍微“伪造”HTML5 属性的行为。我知道已经有插件可以做到这一点，但我想自己编写它，因为我真的想在 jQuery 上做得更好。

到目前为止，这是我认为应该发生的事情。如果您发现任何不必要的东西，请告诉我。

1.  在函数调用时，它会在 DOM 中搜索给定的表单，并将 CSS 类添加到任何输入字段/文本区域，省略`input[type="submit"]`和`<button>`.
2.  如果有值，则将该值与输入/文本区域的 ID 一起放入数组或对象中，例如`#myInputID => initial value`.
3.  在焦点上，CSS 类被移除，并检查当前值是否存在于数组/对象中。如果找到该值，则将其删除，以便 input/textarea 为空。如果未找到，则不会发生任何事情，并且该值保持不变。
4.  模糊时检查该字段是否为空或是否在数组/对象中找到当前值。如果找到或输入的/textarea 的值为空，则重新放置来自对象/数组的初始值，并重新添加 CSS 类。如果在数组或对象中找不到值，则该值将保留并且不会重新添加 CSS 类。

在可能如下所示的代码中：

```
function placeholder( element ) {
  var values = [];
  console.log( values );

    $( element ).find( ":input" ).each( function() {
      var $this = $( this );

      // adding CSS class
      $this.addClass( "light" );

      if( $this.val() ){
        // adding value to array
        // the key is missing, maybe add an id to the elements?
        values.push( $this.val() );
      }

      $this.focus( function(){
        // remove CSS class
        $this.removeClass( "light" );

        // if value is in array  
        var i = $.inArray( $this.val() , values );
        if( i != -1 ) {
          $this.val( "" );
        }
      })// focus

      $this.blur(function(){
        // setting value to inital value if needed
        // add CSS class
        var i = $.inArray( $this.val() , values );
        if( i == -1 ) {
          $this.val( "initalValue" );
          $this.addClass( "light" );
        }
      })// blur

    }) // each
} // function

placeholder( "form" ); 
```

当然它还没有完成，还有几个问题（它甚至不工作......），但我无法自己解决。这些是我的主要问题：

*   我应该使用数组还是对象（哈希图？）来保存键 => 值对？我发现对此有不同的看法，即使在 SO 上也是如此。以及如何比较这些值？如何在这样的数组/对象中推送值？
*   在某些时候，缓存是个好主意`$this.val()`。最好的地方是什么？
*   代码有任何主要的性能问题吗？
*   当触发模糊事件时，如果用户没有输入任何内容，则需要将值重置为其初始值。这不起作用，因为我的数组中没有任何键来识别元素。

这是一个用于快速测试的小提琴：[小提琴](http://jsfiddle.net/RZgvL/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:28:28.690

要保存键值对，请使用您可以访问的对象，例如关联数组。键应该是包含值的输入字段的唯一内容（可能像它的 ID）。因此，从您的以下示例中获取....

```
if( $this.val() ){
     // adding value to array
     values[$this.attr('id')] = $this.val();
} 
```

此时检索任何值都变得很简单：只需使用元素的 ID。您还无需搜索整个值数组来查找值，现在您可以按 ID 搜索。所以那里的性能也会得到改善。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:29:34.447

没有你说的那么复杂...

**jQuery** :

```
$('#myform').
on('focus', '.autoclear', function () {
    if (this.value === this.defaultValue) {
        this.value = '';
    }
    $(this).removeClass('blur').addClass('focus');
}).
on('blur', '.autoclear', function () {
    if (this.value === '') {
        this.value = this.defaultValue;
    }
    $(this).removeClass('focus').addClass('blur');
}); 
```

**HTML**：

**工作演示：http: [//jsfiddle.net/L2pfW/](http://jsfiddle.net/L2pfW/)**

```
<input type="text" name="field" value="name" class="autoclear" /> 
```

# character-encoding - 停止 Firebird 修改基于 Windows 字符集的字符串

> ID：14836909
> 
> 赞同：2
> 
> 时间：2013-02-12T16:18:23.153
> 
> 标签：character-encoding, firebird, firebird1.5, uib

我有一个使用 1.5.5 Firebird 嵌入式引擎的应用程序（用 Delphi 编写）。我正在使用这个引擎，因为该应用程序适用于当前部署的 Firebird 数据库，并且较新的嵌入式引擎无法正确打开数据库文件（ODS 10.1）。数据库中的所有字符串都定义为 VARCHAR(N)，其中 N 不同。该应用程序曾经是一个 ANSI 应用程序，因此数据包含 ISO-latin-1 字符。现在应用程序已升级为 unicode 应用程序。为了将 Unicode 字符存储在现有数据库中（大约 10k 个实例），我编写了一个 UTF8-BOM（如果你可以这样称呼它），然后字符串的其余部分被认为是 UTF8 并由数据库层解码。这样我们就可以使用所有现有的数据库，并且仍然使用所有 Unicode 字符。

这适用于西欧的所有机器。但是当应用程序在罗马尼亚（具有罗马尼亚语设置的 Windows PC）中运行时：数据库引擎会更改字符。例如：UTF8 字符串以字符 octet EF (ï) 开头。数据库引擎将其返回为八位字节 69 (i)。

现有数据库如何解决这个问题？

注意：我在打开数据库（使用 UIB 库）时尝试指定字符集 OCTETS，但由于字符集未知，因此失败。

发现问题出在 UIB（本例中使用的数据库层）。UIB 处理 csNONE 的方式是，如果你给它一个字节字符串（数据类型 AnsiString），它会通过简单地将字节扩展为单词并使用当前线程代码页进一步减少它来转换为 UnicodeString。由于罗马尼亚没有使用 iso-latin-1 作为它的代码页......数据在那里被破坏了。

现在我在 UIBLib 中更改了以下例程（例如，当给出 ansistring 并且 charset 为 none 并且请求 ansistring 参数时 -> 根本不进行转换）：

```
 procedure TSQLDA.EncodeStringA(Code: Smallint; Index: Word; const str: AnsiString);
  begin
  {$IFDEF UNICODE}
    if FCharacterSet = csNONE then begin // new
      EncodeStringB( Code, Index, str ); // new
    end else begin                       // new
      EncodeStringB(Code, Index, MBUEncode(UniCodeString(str), CharacterSetCP[FCharacterSet]));
    end;                                 // new
  {$ELSE}
    EncodeStringB(Code, Index, str);
  {$ENDIF}
  end; 
```

现在我需要检查这个行为对于库是否正确，并给维护者一个补丁。

# python - Django 基于类的视图：在调度中验证对象

> ID：14836913
> 
> 赞同：6
> 
> 时间：2013-02-12T16:18:42.860
> 
> 标签：python, django, django-class-based-views

`self.get_object()`有没有一种既定的方法可以在稍后在 get/post 中调用时验证调度中的对象而不进行额外的数据库调用？

这是我到目前为止的内容（针对这个问题略有改动）：

```
class CourseUpdateView(UpdateView):
    def dispatch(self, request, *args, **kwargs):

        self.request = request
        self.kwargs = kwargs
        self.object = self.get_object()

        if self.object.is_online:
            messages.warning(request, "Sorry this one can't be updated")
            return redirect("course:detail", pk=self.kwargs['pk'])

        # this is going to call self.get_object again isn't it?
        return UpdateView.dispatch(self, request, *args, **kwargs) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T16:21:56.340

您可以缓存`get_object()`.

这是一个简单的例子：

```
class CourseUpdateView(UpdateView):
    # [...] your dispatch method

    def get_object(self):
        # it doesn't matter how many times get_object is called per request
        # it should not do more than one request
        if not hasattr(self, '_object'):
            self._object = super(CourseUpdateView, self).get_object()
        return self._object 
```

# php - PHP currentarray 编号和含义

> ID：14836914
> 
> 赞同：0
> 
> 时间：2013-02-12T16:18:46.793
> 
> 标签：php, arrays

这是一个业余问题（如果我忽略了一些非常明显的事情，请提前道歉，但我一直在 PHP.net 上寻找一些线索但还没有弄清楚），我正在破译其他人为朋友网站和种类所做的代码刚刚迷路了。

代码所做的是为数据库创建一个数组，然后站点根据时间戳和排序调用信息。出于某种原因，有些事情没有出现，所以我只是想弄清楚：

```
$TYPES_EXPO = array("Type1","Type2","Type3","Type4","Type5","Type6","Type7");

$currentarray = $debe->runSql("SELECT * FROM expositions WHERE from<='$nu' AND to>='$nu' ORDER BY from");

if(count($currentarray)>0)
    echo "<h1>Current Exhibitions</h1>";

for($i=0; $i<count($currentarray);$i++)
{
    echo "<b>" . $currentarray[$i][3] . "</b>"; 
```

那么在最后一行中，[3] 引用的是什么？在代码的其他部分还有更多，不同的整数，例如 [6] 和 [7]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:28:24.453

我怀疑该调用`$debe->runSql`正在返回一组记录。[3] 是返回中的第 3 列。

很可能它是数据库表中的第三列。但是`SELECT * FROM`不能保证第三列是相同的。你会想把它改成`SELECT first, second, third FROM`

同样，这是假设`$debe->runSql`返回类似于[http://php.net/manual/en/function.mysql-fetch-row.php](http://php.net/manual/en/function.mysql-fetch-row.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:25:06.870

3 引用多维数组中的第 4 个元素（0 是第一个元素）`$currentarray`。

所以例如你有一个数组`$person`

```
mike
    male
    blue
    75
    31
jack
    male
    brown
    80
    21 
```

`$person[1][3]`将引用整数 21。

我希望这有帮助 ：）

//编辑：作为提示，不要在 foreach 中使用 count()。分配一个变量 vefore，这样当您有数千个数组项时，该函数就不会被调用一千次。

# java - 如何使用 Cloudera CDH4 和 Maven 获取正在运行的 Spring-Data-Hadoop 项目

> ID：14836915
> 
> 赞同：5
> 
> 时间：2013-02-12T16:18:47.683
> 
> 标签：java, hadoop, spring-data, cloudera

由于 Spring-Data-Hadoop 尚未发布，因此很难找到运行示例配置以将其与 cloudera 一起使用。

我需要选择哪些依赖项才能与 CDH4（Hadoop 2.0.0-cdh4.1.3）一起运行 Spring-Data-Hadoop？

通过选择不同的方法，我得到了这个例外：

1.  空指针

    ```
    Exception in thread "SimpleAsyncTaskExecutor-1" java.lang.ExceptionInInitializerError
        at org.springframework.data.hadoop.mapreduce.JobExecutor$2.run(JobExecutor.java:183)
        at java.lang.Thread.run(Thread.java:722)
        Caused by: java.lang.NullPointerException
        at org.springframework.util.ReflectionUtils.makeAccessible(ReflectionUtils.java:405)
        at org.springframework.data.hadoop.mapreduce.JobUtils.<clinit>(JobUtils.java:123)
        ... 2 more 
    ```

2.  版本不匹配 7 到 4

    ```
    Caused by: org.apache.hadoop.ipc.RemoteException: Server IPC version 7 cannot communicate with client version 4
        at org.apache.hadoop.ipc.Client.call(Client.java:1070)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:225)
        at $Proxy1.getProtocolVersion(Unknown Source)
        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:396)
        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:379)
        at org.apache.hadoop.hdfs.DFSClient.createRPCNamenode(DFSClient.java:119)
        at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:238)
        at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:203)
        at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:89)
        at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:1386)
        at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:66)
        at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:1404)
        at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:254)
        at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:123)
        at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:238)
        at org.apache.hadoop.fs.Path.getFileSystem(Path.java:187)
        at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.addInputPath(FileInputFormat.java:372)
        at org.springframework.data.hadoop.mapreduce.JobFactoryBean.afterPropertiesSet(JobFactoryBean.java:208)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    ... 12 more 
    ```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T16:18:47.683

这是一个如何配置它的示例。

**Maven 设置：**

笔记：

*   （可选）从 spring-data-hadoop 中排除 hadoop-streaming 和 hadoop-tools
*   使用通用版本添加 hadoop-common 和 hadoop-hdfs：2.0.0-cdhX.XX
*   使用 mr1 版本添加 hadoop-tools 和 hadoop-streaming：2.0.0-mr1-cdhX.XX
*   Spring Data Hadoop 目前仅支持 MR1。所以请确保您没有将 MR2 包含在其他依赖项中。检查这个`mvn dependency:tree`！

Pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>com.example.main</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>jar</packaging>

    <properties>
        <java-version>1.7</java-version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <spring.version>3.2.0.RELEASE</spring.version>
        <spring.hadoop.version>1.0.0.BUILD-SNAPSHOT</spring.hadoop.version>
        <hadoop.version.generic>2.0.0-cdh4.1.3</hadoop.version.generic>
        <hadoop.version.mr1>2.0.0-mr1-cdh4.1.3</hadoop.version.mr1>
    </properties>

    <dependencies>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-hadoop</artifactId>
            <version>${spring.hadoop.version}</version>

            <exclusions>
                <!-- Excluded the Hadoop dependencies to be sure that they are not mixed 
                    with them provided by cloudera. -->
                <exclusion>
                    <artifactId>hadoop-streaming</artifactId>
                    <groupId>org.apache.hadoop</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>hadoop-tools</artifactId>
                    <groupId>org.apache.hadoop</groupId>
                </exclusion>
            </exclusions>

        </dependency>

        <!-- Hadoop Cloudera Dependencies -->
        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-common</artifactId>
            <version>${hadoop.version.generic}</version>
        </dependency>

        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-hdfs</artifactId>
            <version>${hadoop.version.generic}</version>
        </dependency>

        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-tools</artifactId>
            <version>2.0.0-mr1-cdh4.1.3</version>
        </dependency>

        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-streaming</artifactId>
            <version>2.0.0-mr1-cdh4.1.3</version>
        </dependency>

    </dependencies>

    <build>
        <plugins>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>${java-version}</source>
                    <target>${java-version}</target>
                </configuration>
            </plugin>

        </plugins>
    </build>

    <repositories>
        <repository>
            <id>spring-milestones</id>
            <url>http://repo.springsource.org/libs-milestone</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>

        <repository>
            <id>cloudera</id>
            <url>https://repository.cloudera.com/artifactory/cloudera-repos/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>

        <repository>
            <id>spring-snapshot</id>
            <name>Spring Maven SNAPSHOT Repository</name>
            <url>http://repo.springframework.org/snapshot</url>
        </repository>
    </repositories>
</project> 
```

**弹簧设置（applicationContext.xml）：**

替换为`fs.default.name`您的名称节点域

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:hdp="http://www.springframework.org/schema/hadoop"
    xsi:schemaLocation="
                    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                    http://www.springframework.org/schema/hadoop http://www.springframework.org/schema/hadoop/spring-hadoop.xsd
                    http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/integration
                    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <hdp:configuration id="hadoopConfiguration">
        fs.default.name=hdfs://example.com:8020
    </hdp:configuration>

    <hdp:job id="wordCountJob" 
        mapper="com.example.WordMapper"
        reducer="com.example.WordReducer" 
        input-path="/user/christian/input/test"
        output-path="/user/christian/output2" />

    <hdp:job-runner job-ref="wordCountJob" run-at-startup="true"
        wait-for-completion="true" /> 
```

有了这个，您应该能够访问您的集群。

一些参考资料：

*   [Springsource 论坛 - Nullpointer 异常](http://forum.springsource.org/showthread.php?134821-NullPointerException-in-Spring-Data-Hadoop-with-CDH4)
*   [Cloudera Maven 存储库](https://ccp.cloudera.com/display/CDH4DOC/Using+the+CDH4+Maven+Repository)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T04:28:21.853

嘿，你可以从[https://github.com/spring-projects/spring-data-book](https://github.com/spring-projects/spring-data-book)下载它。

自述文件中给出了构建和运行它。

# ruby-on-rails - 为什么我的浮点数在 Rails 中四舍五入？

> ID：14836916
> 
> 赞同：2
> 
> 时间：2013-02-12T16:18:49.157
> 
> 标签：ruby-on-rails, floating-point, rails-activerecord

我有一个使用浮点存储地理位置的模型。它使用 ActiveRecord、Rails 3.2.x 将数据存储在 MySQL 中。

```
c = Camping.new()
c.latitude=51.77802459999999
c.save
c.latitude
=> 51.77802459999999
c.reload
c.latitude
=> 51.778 
```

在查看数据库时，我确认它存储为 51.778。其他数字的存储精度更高，我的想法`0`是 ActiveRecord 或 MySQL 决定忽略其余数字。

是什么决定了这个数字可以或应该在三位数之后被砍掉？有什么可以控制的吗？浮动是存储它的正确类型吗？

我想要一个 6 的精度，永远不会更高，但可以更少，或者填充。因此，当`51.7780`提供时，它可能存储为`51.7780`或`51.778000`。当`51.77802459999999`提供时，它可以存储为`51.778025`或完全精度的数字；我真的不在乎。

相关部分来自`schema.rb`：

```
 create_table "campings", :force => true do |t|
    #...
    t.float    "latitude"
    t.float    "longitude"
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:06:47.510

显然，MySQL 是问题所在，因为 float 被描述为[近似值](http://dev.mysql.com/doc/refman/5.0/en/floating-point-types.html)。

您可以改用小数，并指定精度和小数位数：

```
create_table "campings", :force => true do |t|
  #...
  t.decimal    "latitude",  :precision => 15, :scale => 10
  t.decimal    "longitude", :precision => 15, :scale => 10
end 
```

# asp.net - 您可以将包含 Dictionary 属性的对象绑定到下拉列表吗？

> ID：14836921
> 
> 赞同：2
> 
> 时间：2013-02-12T16:19:00.957
> 
> 标签：asp.net, data-binding

例如，我有以下类声明的一个实例：

```
public class Person
{
    public string Name = "";
    public Dictionary<string, string> Properties = new Dictionary<string, string>();
} 
```

我有一个我希望绑定到 Asp.NET 下拉列表的人员列表。

```
List<Person> people = new List<Person>();
//fill the list etc..

//bind to the drop down list
ddlPeople.DataSource = people;
ddlPeople.DataTextField = "Name";
ddlPeople.DataTextField = "Properties['Age']"; //this is what I would like! 
```

年龄总是存在的。我无法控制 person 类。有谁知道我想做的事情是否可以实现？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:29:36.130

据我所知，你不能那样做。

我想我会去：

```
ddlPeople.Items.Clear();
ddlPeople.Items.AddRange(people.Select(p => new ListItem(p.Name, p.Properties["Age"])).ToArray()); 
```

但我不确定这是你问题的重点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:25:15.720

也许您可以在您的人员类上创建一个只读属性？

```
public class Person
{
    public string Name = "";
    public Dictionary<string, string> Properties = new Dictionary<string, string>();

    public int Age
    {
        get
        {
            // ... code to handle situations where Properties
            //     is null or does not contain key
            return (int)this.Properties["Age"];
        }
    }
} 
```

我相信您正在寻找的那种绑定在 WPF 中是可能的，但我认为我从未见过它在 ASP.NET 中完成。

# c++ - 选择性地忽略 VS2005 中特定文件的调试中断

> ID：14836922
> 
> 赞同：0
> 
> 时间：2013-02-12T16:19:00.303
> 
> 标签：c++, visual-studio, debugging, break

每次我在调试模式下运行项目时，我都会在开始时连续中断 4 次，每次都必须点击继续。它们在同一点位于同一文件中。

如果我可以说简单地忽略这些，那就太好了，因为它们不会影响功能。

显然更好的方法是尝试解决它，这样它就不会导致中断/继续提示，但我认为目前值得付出更多的努力。

如果该解决方案仅与我的特定环境相关，那就太好了，这样我就不必每次拉/推构建时都撤消/执行它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:32:30.170

尝试使用断点条件或断点过滤器。

# python - 如何只模拟您正在测试的对象中调用的一种方法

> ID：14836923
> 
> 赞同：1
> 
> 时间：2013-02-12T16:19:03.460
> 
> 标签：python, mocking, mox, partial-mocks

我想测试一个方法，但要模拟它调用的其他方法。我创建了这个简单的例子来说明这个概念：

```
class myClass():
    def one_method(self):
        print "hey"
    def two_deep(self):
        self.one_method()
    def three_deep(self):
        self.two_deep() 
```

我使用了一个名为 Mox 的 python 模拟框架并编写了以下代码来执行此操作：

```
def test_partial(self):
        self_mox = mox.Mox()
        some_object = myClass()
        ## 1\. make your mock                 
        my_mock = mox.MockObject(some_object)
        my_mock.one_method().AndReturn('some_value')
        self_mox.ReplayAll()
        ret = my_mock.three_deep()        ## *** SEE NOTE BELOW called "comment":
        self_mox.VerifyAll() 
```

评论：

我想如果我在一个没有被覆盖的方法上调用这个模拟，那么模拟将默认为原始代码，然后我可以获得我想要的调用链，最后一个调用被替换......但是它不这样做。我不知道如何在没有插入方法的测试对象中嵌入模拟对象。

我研究了 Partial Mocks 和 Chained Mocks 来解决这个问题，但我找不到解决这个问题的方法。

谢谢你的帮助 ：）

——彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T14:49:11.063

检查 StubOutWithMock 的文档： [https ://code.google.com/p/pymox/wiki/MoxDocumentation#Stub_Out](https://code.google.com/p/pymox/wiki/MoxDocumentation#Stub_Out) [https://code.google.com/p/pymox/wiki/MoxRecipes#Mock_a_method_in_the_class_under_test。](https://code.google.com/p/pymox/wiki/MoxRecipes#Mock_a_method_in_the_class_under_test.)

所以你需要的是：

```
def test_partial(self):
    self_mox = mox.Mox()   

    # Create the class as is, instead of doing mock.
    some_object = myClass()

    # Stub your particular method using the StubOutWithMock.
    m.StubOutWithMock(some_object, "one_method")
    some_object.one_method().AndReturn('some_value')

    self_mox.ReplayAll()
    ret = some_object.three_deep()
    self_mox.UnsetStubs()
    self_mox.VerifyAll() 
```

# jquery - ajax调用后绑定jQuery函数

> ID：14836930
> 
> 赞同：0
> 
> 时间：2013-02-12T16:19:14.110
> 
> 标签：jquery

好的，我已经尝试让这个工作好几天了。我有一个缩略图滚动器，当窗口加载下面提供的代码时它工作正常。但是在ajax调用之后它没有。

这是最初加载的函数。

```
 (function($){
     window.onload=function(){ 
    $("#tS2").thumbnailScroller({ 
        scrollerType:"clickButtons", 
        scrollerOrientation:"horizontal", 
        scrollSpeed:2, 
        scrollEasing:"easeOutCirc", 
        scrollEasingAmount:800, 
        acceleration:4, 
        scrollSpeed:800, 
        noScrollCenterSpace:10, 
        autoScrolling:0, 
        autoScrollingSpeed:2000, 
        autoScrollingEasing:"easeInOutQuad", 
        autoScrollingDelay:500 
    });
}
})(jQuery); 
```

我尝试在我的 ajax 函数回调中将其添加到下面的部分，但仍然不起作用。

```
$("#tS2").thumbnailScroller({ 
            scrollerType:"clickButtons", 
            scrollerOrientation:"horizontal", 
            scrollSpeed:2, 
            scrollEasing:"easeOutCirc", 
            scrollEasingAmount:800, 
            acceleration:4, 
            scrollSpeed:800, 
            noScrollCenterSpace:10, 
            autoScrolling:0, 
            autoScrollingSpeed:2000, 
            autoScrollingEasing:"easeInOutQuad", 
            autoScrollingDelay:500 
        });
    } 
```

我该如何重新初始化它或者有什么方法可以使用 On？问题是在完成 ajax 调用之前不会加载 ID/元素，然后我需要重新附加 thumbnailScoller 函数。顺便说一句，我单击以执行已经使用 .On 的 ajax 调用，但将这个函数放在那里不起作用。欢迎任何帮助。

编辑：这是ajax调用。

```
$.ajax({
            type: "POST",
            url: "/ajax.php",
            data: {"pho_id": pho_id, "alb_id": alb_id},
            success: function(response){
                $("#phoajax").html(response);
                $("#tS2").thumbnailScroller({ 
                scrollerType:"clickButtons", 
                scrollerOrientation:"horizontal", 
                scrollSpeed:2, 
                scrollEasing:"easeOutCirc", 
                scrollEasingAmount:800, 
                acceleration:4, 
                scrollSpeed:800, 
                noScrollCenterSpace:10, 
                autoScrolling:0, 
                autoScrollingSpeed:2000, 
                autoScrollingEasing:"easeInOutQuad", 
                autoScrollingDelay:500 
                });
                pslide(alb_id);
            }
        }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:21:31.543

你必须在 ajax 调用的回调函数中调用它，而不是在它之后：

```
$.post("some_url", {var: var1 .... etc}, function(data){ //the same with $.ajax, $.get
     //HERE !
}); 
```

回调函数在您的 ajax 调用完成后执行，如果您使用 ajax 调用修改或添加了任何 DOM 元素，您需要在修改后应用 jquery 函数。

# jquery - Jasny Twitter Bootstrap 实现在工具提示脚本上给出错误

> ID：14836934
> 
> 赞同：1
> 
> 时间：2013-02-12T16:19:23.767
> 
> 标签：jquery, css, twitter-bootstrap, tooltip, popover

当我为 make a popover 调用验证时，我一直在实施[Jasny Twitter Bootstrap](http://jasny.github.com/bootstrap) ，并且它给了我一个关于未定义变量的错误。

我附上我的代码，以便您可以帮助我解决这个问题

```
 $('#ReferalAdminAddForm').validate({
                    rules: {
                            'data[Referal][CustomerTypeId]': {
                                    required: true
                            },
                            'data[Referal][town_id]': {
                                    required: true
                            },
                            'data[Referal][nit]': {
                                    required: true,
                                    minlength: 11,
                                    maxlength: 11,
                                    digits: true
                            },
                            'data[Referal][name]': {
                                    required: true,
                                    minlength: 2,
                                    maxlength: 128
                            },
                            'data[Referal][address]': {
                                    required: true
                            },
                            'data[Referal][phone]':{
                                    required:false,
                                    minlength: 6,
                                    maxlength: 16
                            }
                    },
                    highlight: function(element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error').popover('toggle');
                    },
                    success: function(element) {
                            element
                            .text('OK!').addClass('valid')
                            .closest('.control-group').removeClass('error').addClass('success');
                    }
            }); 
```

控制台给出这个消息

```
TypeError: b is undefined
.../2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.wi...

bootst....min.js (línea 7) 
```

我的javascript调用是：

```
<script src="/ikarus/j_query/js/jquery.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-transition.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-alert.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-modal.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-dropdown.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-scrollspy.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-tab.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-tooltip.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-popover.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-button.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-collapse.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-typeahead.min.js"></script>
<script src="/ikarus/twitter_bootstrap/js/jasny/bootstrap-fileupload.min.js"></script> 
```

# powershell - PowerShell 中的 DotNetZip ExtractProgress 事件

> ID：14836936
> 
> 赞同：1
> 
> 时间：2013-02-12T16:19:26.783
> 
> 标签：powershell, dotnetzip

我正在使用[DotNetZip](http://dotnetzip.codeplex.com/)库在 PowerShell 中提取 ZIP 文件，并且我想显示进度。我正在使用以下代码：

```
try {
    $zip = [Ionic.Zip.ZipFile]::Read($ZipFileName)

    Register-ObjectEvent `
            -InputObject $zip `
            -EventName ExtractProgress `
            -SourceIdentifier ExtractProgress `
            -Action {
                [Console]::Beep()
                Write-Host $Sender
                Write-Host $SourceEventArgs
            } | Out-Null

    $zip.ExtractAll($Destination, 'OverwriteSilently')
}
finally {
    Unregister-Event -SourceIdentifier ExtractProgress
    $zip.Dispose()
} 
```

`Write-Host`我的问题是直到最后我才看到事件（没有哔哔声，没有）。我希望在此过程中看到进度事件。

最初，我认为这是因为`Register-ObjectEvent`将事件排入队列，但 PowerShell 帮助说`-Action`立即调用该事件，而没有将事件排入队列。

如果我在 C# 控制台应用程序中编写等效代码，那么我会在提取每个文件时看到进度事件，正如预期的那样，这意味着（据我所知）DotNetZip 正在做正确的事情。请注意，这些事件是在调用`ExtractAll`.

我究竟做错了什么？

（Windows 7 x64，PowerShell 2.0，配置为使用 .NET 4.0）

# android - 键盘重置无线电组值

> ID：14836937
> 
> 赞同：1
> 
> 时间：2013-02-12T16:19:27.333
> 
> 标签：android, listview, keyboard, radio-button, radio-group

我有一个自定义 ListView，每行都有一个 radiogroup。当我更改选中的单选按钮时，我会调用一个带有一些编辑文本字段的对话框（使用 onCheckedChanged() 方法）。但是，当我专注于编辑文本来写东西时，我丢失了所有被键盘**覆盖**的选中单选按钮，并且该组返回到选择的默认选项。有人能帮我吗？

*列表适配器*

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    ContractItemHolder cih = new ContractItemHolder();
    if (row == null){
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(R.layout.row_proposals_item, parent, false);
        cih.setTvItemTitle((TextView)row.findViewById(R.id.textViewItemTitle));
        cih.setRgItemStatus((RadioGroup)row.findViewById(R.id.radioGroupStatus));

        row.setTag(cih);
    }else {
        cih=(ContractItemHolder)row.getTag();
    }
    final ContractItem ci = list.get(position);
    cih.getRgItemStatus().setOnCheckedChangeListener(new OnCheckedChangeListener() {

        @Override
        public void onCheckedChanged(RadioGroup group, int checkedId) {
            groupSel = group;
            int selected = group.getCheckedRadioButtonId();
            Dialog d;
            switch (selected) {
            case R.id.radioAccepted:
                d = createDialog(context, ACCEPTED_CODE, ci, selected);
                d.show();
                break;
            case R.id.radioRefused:
                d = createDialog(context, REFUSED_CODE, ci, selected);
                d.show();
                break;
            default:
                break;
            }
        }
    });
    cih.getTvItemTitle().setText(ci.getDescItem());
    return row;
} 
```

*列表项布局（行..）*

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:padding="5dp" 
    android:gravity="center">

    <TextView
        android:id="@+id/textViewItemTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:layout_weight="3"
        android:textAppearance="?android:attr/textAppearanceLarge"/> 

    <RadioGroup
        android:id="@+id/radioGroupStatus"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:orientation="horizontal"
        android:layout_weight="1"
        android:showDividers="middle">

        <RadioButton
            android:id="@+id/radioNull"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Non Proposto" 
            android:checked="true"
            android:textAppearance="?android:attr/textAppearanceLarge"/>

        <RadioButton
            android:id="@+id/radioPending"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="In trattativa" 
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textColor="@color/Blue"/>

        <RadioButton
            android:id="@+id/radioAccepted"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Accettato" 
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textColor="@color/Green"/>

        <RadioButton
            android:id="@+id/radioRefused"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Rifiutato" 
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textColor="@color/Red"/>

    </RadioGroup> 

</LinearLayout> 
```

*对话实现*

```
private Dialog createDialog(Context context, final int code, ContractItem item,final int selected){ //type: refused, accepted
    d = new Dialog(context);
    d.setTitle(item.getDescItem());
    d.setContentView(R.layout.layout_dialog_prop);
    d.getWindow().setLayout(900, LayoutParams.WRAP_CONTENT);
    d.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN);

    Button btnOK = (Button)d.findViewById(R.id.buttonPropOK);
    Button btnCancel = (Button)d.findViewById(R.id.buttonPropCancel);
    btnCancel.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            d.dismiss();
        }
    });
    btnOK.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            d.dismiss();

        }
    });
    return d;
} 
```

*对话框布局*

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="50dp" >

        <EditText
            android:id="@+id/editTextDiscount"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="30dp"
            android:ems="10"
            android:hint="Sconto proposto"
            android:inputType="number"
            android:textAppearance="?android:attr/textAppearanceLarge" >

            <requestFocus />
        </EditText>

        <Spinner
            android:id="@+id/spinnerScuse"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="30dp"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:visibility="gone" />

        <EditText
            android:id="@+id/editText1"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_marginTop="30dp"
            android:ems="10"
            android:gravity="top"
            android:hint="Note"
            android:inputType="textMultiLine"
            android:textAppearance="?android:attr/textAppearanceLarge" />
    </LinearLayout>

    <View
        android:id="@+id/view2"
        android:layout_width="match_parent"
        android:layout_height="2dp"
        android:layout_marginTop="30dp"
        android:background="@android:color/holo_blue_light" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/buttonPropCancel"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:background="@android:color/transparent"
            android:text="Annulla"
            android:textColor="@android:color/holo_blue_light" />

        <View
            android:id="@+id/view1"
            android:layout_width="1dp"
            android:layout_height="match_parent"
            android:background="@android:color/holo_blue_light" />

        <Button
            android:id="@+id/buttonPropOK"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:background="@android:color/transparent"
            android:text="Ok"
            android:textColor="@android:color/holo_blue_light" />

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-12T18:19:33.137

您部分了解列表项视图回收过程。

该`ListView`组件不会为列表中的每个项目生成视图。所以，在你的情况下不会有`15`他们。屏幕上将有尽可能多的内容。当您滚动列表时，不再可见的旧项目将*被回收*。然后`getView`调用`convertView != null`并且适配器为您提供*更新*此回收项目视图的机会。这样做是出于性能原因 - 想象一下一个具有 10000 个项目的适配器（在商业应用中并不罕见）。它应该创建所有 10000 个列表项视图吗？想象一下滚动这样一个列表时的表现......

在您的`getView()`代码中，您仅部分更新项目视图 - 您始终在此行中设置项目标题：

```
cih.getTvItemTitle().setText(ci.getDescItem()); 
```

创建新项目视图（即`convertView == null`）时，单选组具有默认选择，这在您的情况下可能没问题。

但是，当项目视图被回收（即`convertView != null`）时，您：

*   在此行中设置更改侦听器：

    ```
    cih.getRgItemStatus().setOnCheckedChangeListener(...); 
    ```

*   设置项目标题：

    ```
    cih.getTvItemTitle().setText(ci.getDescItem()); 
    ```

但是您从未设置选中的单选组项目。这意味着，它将有一个最后为这个项目视图实例设置的值——*而不是那个位置*。您应该存储该信息 - 可能在 中`ContractItem`，在选择单选组项目时更新它，最后 - 检索它`convertView != null`并将单选组的选定项目设置为正确的值。

当您打开一个对话框时，您可能会看到这个缺陷 -`ListView`随着软键盘的打开，a 的可见区域会变小。这会导致`ListView`删除不必要的（技术上：不再可见）项目视图。当您隐藏软键盘时，该`ListView`区域再次变大，从而导致它创建丢失的项目视图。不幸的是，您没有保存和恢复单选组的最后一个选定项目，因此，在创建新可见项目后，在单选组中选择了默认项目。

# python - 输出子进程调用的命令行？

> ID：14836947
> 
> 赞同：61
> 
> 时间：2013-02-12T16:19:56.957
> 
> 标签：python, command-line, subprocess, popen

我正在使用该`subprocess.Popen`调用，在另一个问题中，我发现我一直误解 Python 是如何为命令行生成参数的。

**我的问题**
有没有办法找出实际的命令行是什么？

示例代码：-

```
proc = subprocess.popen(....)
print "the commandline is %s" % proc.getCommandLine() 
```

你会怎么写`getCommandLine`？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-02-12T16:33:43.060

这取决于您使用的 Python 版本。[在 Python3.3](http://hg.python.org/cpython/file/7727be7613f9/Lib/subprocess.py#l757)中，arg 保存在`proc.args`：

```
proc = subprocess.Popen(....)
print("the commandline is {}".format(proc.args)) 
```

在 Python2.7 中，[未`args`保存](http://hg.python.org/cpython/file/035cbc654889/Lib/subprocess.py#l618)的，它只是传递给其他函数，如`_execute_child`. 因此，在这种情况下，获取命令行的最佳方法是在拥有它时保存它：

```
proc = subprocess.Popen(shlex.split(cmd))
print "the commandline is %s" % cmd 
```

* * *

请注意，如果您有参数*列表*（例如返回的事物的类型`shlex.split(cmd)`，则可以`cmd`使用未记录的函数恢复命令行字符串`subprocess.list2cmdline`：

```
In [14]: import subprocess

In [15]: import shlex

In [16]: cmd = 'foo -a -b --bar baz'

In [17]: shlex.split(cmd)
Out[17]: ['foo', '-a', '-b', '--bar', 'baz']

In [18]: subprocess.list2cmdline(['foo', '-a', '-b', '--bar', 'baz'])
Out[19]: 'foo -a -b --bar baz' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T20:26:10.573

我的问题的正确答案实际上**是**没有命令行。subprocess 的重点是它通过 IPC 完成所有工作。list2cmdline 确实与预期的一样接近，但实际上最好的办法是查看“args”列表，并知道这将是被调用程序中的 argv。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-16T13:48:14.100

**美丽且可扩展的方法**

我一直在使用这样的东西：

```
#!/usr/bin/env python3

import os
import shlex
import subprocess
import sys

def run_cmd(cmd, cwd=None, extra_env=None, extra_paths=None, dry_run=False):
    if extra_env is None:
        extra_env = {}
    newline_separator = ' \\\n'
    out = []
    kwargs = {}
    env = os.environ.copy()

    # cwd
    if 'cwd' is not None:
        kwargs['cwd'] = cwd

    # extra_env
    env.update(extra_env)
    for key in extra_env:
        out.append('{}={}'.format(shlex.quote(key), shlex.quote(extra_env[key])) + newline_separator)

    # extra_paths
    if extra_paths is not None:
        path = ':'.join(extra_paths)
        if 'PATH' in env:
            path += ':' + env['PATH']
        env['PATH'] = path
        out.append('PATH="{}:${{PATH}}"'.format(':'.join(extra_paths)) + newline_separator)

    # Command itself.
    for arg in cmd:
        out.append(shlex.quote(arg) + newline_separator)

    # Print and run.
    kwargs['env'] = env
    print('+ ' + '  '.join(out) + ';')
    if not dry_run:
        subprocess.check_call(cmd, **kwargs)

run_cmd(
    sys.argv[1:],
    cwd='/bin',
    extra_env={'ASDF': 'QW ER'},
    extra_paths=['/some/path1', '/some/path2']
) 
```

样品运行：

```
./a.py echo 'a b' 'c d' 
```

输出：

```
+ ASDF='QW ER' \
  PATH="/some/path1:/some/path2:${PATH}" \
  echo \
  'a b' \
  'c d' \
;
a b c d 
```

功能总结：

*   使巨大的命令行可读，每行一个选项
*   `+`在命令中添加一个，`sh -x`这样用户就可以轻松地将命令与其输出区分开来
*   show`cd`和额外的环境变量（如果它们被提供给命令）。这些仅在给定时打印，生成最小的 shell 命令。

所有这些都允许用户轻松地手动复制命令以在出现故障时运行它们，或者查看发生了什么。

在 Python 3.5.2、Ubuntu 16.04 上测试。[GitHub 上游](https://github.com/cirosantilli/linux-kernel-module-cheat/blob/8815312cad053d0284c4d91bfbf36a1e9ea207af/common.py#L344).

# ios - NSURLConnection（作为 AFNetworking 的一部分）不调用 NSURLConnectionDataDelegate 委托

> ID：14836948
> 
> 赞同：3
> 
> 时间：2013-02-12T16:20:03.023
> 
> 标签：ios, objective-c, nsurlconnection, afnetworking

# 问题

我正在使用生成 NSURLConnection 对象的[AFNetworking](https://github.com/AFNetworking/)来上传照片。

NSURLConnection 没有对

```
- (void)connection:(NSURLConnection __unused *)connection
   didSendBodyData:(NSInteger)bytesWritten
 totalBytesWritten:(NSInteger)totalBytesWritten
totalBytesExpectedToWrite:(NSInteger)totalBytesExpectedToWrite 
```

方法。[（它是NSURLConnectionDataDelegate 协议](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSURLConnectionDataDelegate_protocol/Reference/Reference.html)的一部分，在NSURLConnection.h中定义）

该请求是带有照片附件的 HTTP POST 请求（Content-Disposition “form-data”，Mime 类型“image/jpeg”）。随着上传的进行，这应该（我认为）会导致定期调用此方法。

我需要向用户显示进度条的方法。但是，该方法没有被调用。

笔记：

*   委托设置正确；调用其他委托方法
*   文件上传成功

# AF网络代码

我很确定这是 NSURLConnection 问题，而不是 AFNetworking 问题。

但以防万一，这是我的`AFHTTPClient`子类中的相关代码：

```
NSMutableURLRequest *request = [self multipartFormRequestWithMethod:@"POST" path:path parameters:parameters constructingBodyWithBlock:constructor];
AFHTTPRequestOperation *operation = [self HTTPRequestOperationWithRequest:request success:success failure:failure];

if (constructor) {
    [operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
        NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);
    }];
}

[self enqueueHTTPRequestOperation:operation]; 
```

我的 AFHTTPClient 子类不会覆盖我调用的任何方法：

*   `multipartFormRequestWithMethod: path: parameters: constructingBodyWithBlock:`
*   `HTTPRequestOperationWithRequest: success: failure:`
*   `setUploadProgressBlock:`
*   `enqueueHTTPRequestOperation:`

`constructor`是一个有类型的块，`(void (^)(id<AFMultipartFormData>))`而不是`nil`（通过单步执行代码验证）。

当我输入`po operation.uploadProgress`调试器时，我看到了，`$0 = 0x1301d9f0 <__NSMallocBlock__: 0x1301d9f0>`所以我认为该块设置正确。

文件总是上传成功，但是上传进度块中的代码没有运行，所以我的进度条永远不会更新。

# 问题

为什么 NSURLConnection 不调用这个方法？

NSURLConnection 应该在什么情况下？（它似乎没有很好的记录。）

最重要的是，如何向用户显示上传进度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:25:09.797

A third-party error reporting library was overriding that delegate method on NSURLConnection. Removing the library resolved the issue. (There was no issue with either AFNetworking or NSURLConnection.)

If you can provide troubleshooting steps that would have isolated this issue faster, I will award the bounty to you. (Keep in mind that the third-party library is compiled, so a source code search wouldn't have worked.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:39:11.820

The library maybe implements a `connection:didSendBodyData:totalBytesWritten:totalBytesExpectedToWrite:` method in a category on `NSObject`. That would be very nasty but that could explain why the method of `AFURLConnectionOperation` is not called.

In order to check this assumption, you can run [class-dump](http://stevenygard.com/projects/class-dump/) on your compiled binary. Search for `didSendBodyData:` in the output. If there’s a match in a category, the library is clearly responsible. The library could also be messing with the Objective-C runtime, but that would be harder to detect than just running class-dump.

# php - 如何使用 Twitter API 1.1 获取用户图像？

> ID：14836956
> 
> 赞同：26
> 
> 时间：2013-02-12T16:20:21.743
> 
> 标签：php, twitter

在 API 1.0 中，我们可以使用`users/profile_image/:screen_name`

例如 ：`http://api.twitter.com/1/users/profile_image/EA_FIFA_FRANCE`

**但是，它在API 1.1**中不再起作用。

 **请问你有解决办法吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2015-04-17T12:44:08.607

您还可以通过调用这种 url 来获取 twitter 个人资料图片：

[https://twitter.com/[screen_name]/profile_image?size=original](https://twitter.com/[screen_name]/profile_image?size=original)

例如：[https ://twitter.com/VancityReynolds/profile_image?size=original](https://twitter.com/VancityReynolds/profile_image?size=original)

从这篇文章中得到信息：

[https://twittercommunity.com/t/how-to-get-user-image-original-size-with-api-1-1/10187/14](https://twittercommunity.com/t/how-to-get-user-image-original-size-with-api-1-1/10187/14)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-06-14T14:32:15.827

## 用户的个人资料图片

好的，所以您需要用户的个人资料图片。您将需要查看[twitter REST API 1.1 文档](https://dev.twitter.com/docs/api/1.1)。这是您可以对他们的 API 发出的所有不同请求的列表（别担心，稍后我会*介绍*您如何实际执行此操作）。

有多种方法可以获取用户的头像，但最值得注意的一种是：[users/show](https://dev.twitter.com/docs/api/1.1/get/users/show)。根据文档， users/show 方法：

> 返回由必需的 user_id 或 screen_name 参数指定的有关用户的各种信息。作者的最新推文将尽可能内联返回。

好吧，用户个人资料图像必须在某个地方，对吗？

让我们看一下对该信息请求的典型响应，使用 users/show url（我们将使用我的个人资料作为示例）。

![来自 twitter 1.1 api 的用户/节目的示例响应](../Images/08751ac5c842feb37997648901ff59c6.png)

我已经从底部切掉了一些，因为有**很多**数据要经过。最重要的是，你会看到你需要什么：

![profile_image_url 键](../Images/f6fa937ae1871144fea4726fb848287b.png)

这是您需要访问的**profile_image_url**键。

那么，你是如何做到这一切的呢？实际上，这很简单。

## 经过身份验证的请求

正如您正确指出的那样，截至 2013 年 6 月 11 日，您不能再向 1.0 API 发出未经身份验证的请求或任何请求，因为它已被淘汰。所以 OAuth 是向 1.1 API 发出请求的方式。

我写了一篇**[堆栈溢出帖子](https://stackoverflow.com/questions/12916539/simplest-php-example-retrieving-user-timeline-with-twitter-api-version-1-1/15314662#15314662)**，目的是帮助大家毫不费力地向 1.1 API 发出经过身份验证的请求。

当你使用它时，你会得到上面看到的响应。按照帖子的说明，一步一步地，你可以在[这里](https://github.com/J7mbo/twitter-api-php)获取库（你只需要在你的项目中包含一个文件）。

基本上，上一篇文章解释了您需要执行以下操作：

*   创建一个 Twitter 开发者帐户
*   从 twitter 获取一组唯一键（总共 4 个键）。
*   将您的应用程序设置为具有读/写访问权限
*   包括 TwitterApiExchange.php（库）
*   把你的钥匙放在一个`$settings`数组中
*   从文档中选择您的 URL 和请求方法（发布/获取）（我把链接放在上面！）
*   提出要求，就是这样！

## 一个实际的例子

我将假设您按照上述帖子中的分步说明进行操作（包含漂亮的彩色图片）。这是您用来获得所需内容的代码。

```
// Require the library file, obviously
require_once('TwitterAPIExchange.php');

// Set up your settings with the keys you get from the dev site
$settings = array(
    'oauth_access_token' => "YOUR_ACCESS_TOKEN",
    'oauth_access_token_secret' => "YOUR_ACCESS_TOKEN_SECRET",
    'consumer_key' => "YOUR_CONSUMER_KEY",
    'consumer_secret' => "YOUR_CONSUMER_SECRET"
);

// Chooose the url you want from the docs, this is the users/show
$url = 'https://api.twitter.com/1.1/users/show.json';
// The request method, according to the docs, is GET, not POST
$requestMethod = 'GET';

// Set up your get string, we're using my screen name here
$getfield = '?screen_name=j7mbo';

// Create the object
$twitter = new TwitterAPIExchange($settings);

// Make the request and get the response into the $json variable
$json =  $twitter->setGetfield($getfield)
                 ->buildOauth($url, $requestMethod)
                 ->performRequest();

// It's json, so decode it into an array
$result = json_decode($json);

// Access the profile_image_url element in the array
echo $result->profile_image_url; 
```

差不多就是这样！非常简单。还有[用户/查找](https://dev.twitter.com/docs/api/1.1/get/users/lookup)有效地做同样的事情，但你可以：

> 根据传递给 user_id 和/或 screen_name 参数的逗号分隔值指定，为每个请求返回最多 100 个用户的完全水合用户对象。

如果您需要获取多个用户的详细信息，请使用它，但由于您只需要一个用户的详细信息，请使用 users/show 如上所述。

我希望能把事情弄清楚一点！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-12T18:08:34.730

您说您想使用 Twitter API 1.1，但您不想验证您的请求。 **API v1.1 不支持未经身份验证的请求。**所以请适应 API 的变化。查看更新：

*   [https://dev.twitter.com/blog/planning-for-api-v1-retirement](https://dev.twitter.com/blog/planning-for-api-v1-retirement)
*   [https://dev.twitter.com/docs/rate-limiting/1.1](https://dev.twitter.com/docs/rate-limiting/1.1)

您可以从请求`profile_image_url`字段中获取图像。此方法需要`https://api.twitter.com/1.1/users/show.json`a`id`或。`screen_name`例如 ：

```
GET    https://api.twitter.com/1.1/users/show.json?screen_name=rsarver 
```

在此处查看详细信息[https://dev.twitter.com/docs/api/1.1/get/users/show](https://dev.twitter.com/docs/api/1.1/get/users/show)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-13T16:35:07.177

正如之前的答案和评论指出的那样：

1.  Twitter API v1.0 已弃用
2.  Twitter API v1.1 需要 OAuth
3.  OP（@Steffi）不想进行身份验证

选择任意两个；这三个都是不行的。@Jimbo 的答案是正确的（以及正确的方法），但不包括＃3。扔掉#1意味着时光倒流。但是，我们可以扔掉#2，直接去源码：

```
curl -s https://twitter.com/EA_FIFA_FRANCE |
  sed -ne 's/^.*ProfileAvatar-image.*\(https:[^"]*\).*$/\1/p' 
```

该`sed`命令只是说，找到包含“ProfileAvatar-image”的行并打印看起来像引用 URL 的子字符串。

这不如经过身份验证的 API 调用稳定，因为 Twitter 可能随时更改其 HTML，但它比处理 OAuth 更容易，而且没有官方速率限制！

[PHP](http://php.net/manual/en/book.curl.php)翻译应该很简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-22T09:11:32.100

我尝试上述方法来获取配置文件 URL，但它对我不起作用。我认为是因为 Twitter 将 API v1.1 更改为 API v2.0。

我找到了一种获取个人资料 URL 的简单方法。

我在那里使用 Twitter API v2 User Lookup -> User by Username API 部分

代码示例：

```
https://api.twitter.com/2/users/by/username/{user_name}?user.fields=profile_image_url 
```

例如：

```
https://api.twitter.com/2/users/by/username/TwitterDev?user.fields=profile_image_url 
```

当然，您应该使用您的 Bearer Token 请求它才能正常工作。为此，我推荐一个名为**postman**的平台。它确实有助于调用 API。

上面的示例代码返回 JSON，如下所示：

```
{
"data": {
    "name": "Twitter Dev",
    "profile_image_url": "https://pbs.twimg.com/profile_images/1445764922474827784/W2zEPN7U_normal.jpg",
    "username": "TwitterDev",
    "id": "2244994945"
} 
```

}

*额外的：*

如果您希望配置文件图像的尺寸更大。然后，您可以在 URL 中将 size 替换为*normal*。[有关更多详细信息，请阅读此](https://developer.twitter.com/en/docs/twitter-api/v1/accounts-and-users/user-profile-images-and-banners)

像这样：

```
https://pbs.twimg.com/profile_images/1445764922474827784/W2zEPN7U_400x400.jpg 
```

投票帮助更多的开发者。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-12T16:23:56.817

试试这个

```
http://api.twitter.com/1/users/profile_image/{twitter_account}.xml?size=bigger 
```

在 API 1.1 中，唯一的方法是连接您的应用程序，通过以下方式检索用户

```
https://dev.twitter.com/docs/api/1.1/get/users/show 
```

并检索他的照片

```
profile_image_url 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-01-05T09:49:34.073

Hare 是一种获取 Twitter 个人资料图片的非常简单的方法。

[http://res.cloudinary.com/demo/image/twitter_name/w_300/](http://res.cloudinary.com/demo/image/twitter_name/w_300/) {User_Name}.jpg

这是我的个人资料图片：大：[http ://res.cloudinary.com/demo/image/twitter_name/w_300/avto_key.jpg](http://res.cloudinary.com/demo/image/twitter_name/w_300/avto_key.jpg)

小：[http ://res.cloudinary.com/demo/image/twitter_name/w_100/avto_key.jpg](http://res.cloudinary.com/demo/image/twitter_name/w_100/avto_key.jpg)

您可以通过这部分 URL 来调节大小 - w_100、w_200、w_500 等。**

# emacs - 在 Emacs 中更新包

> ID：14836958
> 
> 赞同：164
> 
> 时间：2013-02-12T16:20:29.710
> 
> 标签：emacs, elpa

我有以下软件包设置（不确定是否有更好的推荐）：

```
(require 'package)
(setq package-archives '(("ELPA" . "http://tromey.com/elpa/") 
                          ("gnu" . "http://elpa.gnu.org/packages/")
                          ("marmalade" . "http://marmalade-repo.org/packages/")))

; Apparently needed for the package auto-complete (why?)
(add-to-list 'package-archives
             '("melpa" . "http://melpa.milkbox.net/packages/") t)

(package-initialize)
(setq url-http-attempt-keepalives nil) 
```

我有三个与软件包安装和更新有关的问题。

**Q1。**有没有办法更新可用软件包（和最新版本）列表并更新特定软件包？

**Q.2**以下包源有什么区别？：

*   埃尔帕,
*   GNU
*   果酱
*   梅尔帕

**Q.3**添加它们的顺序是否重要`package-archives`？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2013-02-12T17:21:35.297

1.  为了自动更新包列表，*只有在没有包列表*的情况下，才使用以下命令：

    ```
    (when (not package-archive-contents)
        (package-refresh-contents)) 
    ```

    要更新所有已安装的包，请键入`package-list-packages`，这会将您带到`*Packages*`缓冲区（并且还会更新包列表），然后键入`U x`。

    `package-refresh-contents`无条件地尝试从您添加到的所有存储库中下载包列表`package-archives`；`package-archive-contents`如果您已经下载了包列表，则为非 nil。

2.  **ELPA**是原创的。我不认为它真的被维护了，但我不确定。我不使用它。

    **GNU**是“官方的”。它与 Emacs 一起维护，这意味着事情应该总是可以工作，但更新和新包不会经常出现。

    **Marmalade**基本上是一个网站，您可以在其中上传完整的包，并将其添加到 marmalade 存储库中。您不只是提交到包上游的链接，它并不能完全自动化包的创建。我认为这是正确的，因为您不一定要跟踪上游。不幸的是，它已经有一段时间没有维护了，但是最近有人接管了它，所以它应该会在某个时候恢复并变得更好。

    **Melpa**获取一个 URL，例如 EmacsWiki lisp 区域或 github 存储库，并从它自动构建一个包。因此，它通常最多比它跟踪的任何东西晚一天。虽然它跟踪上游，但我在实践中从来没有遇到过问题，这就是我的大部分包裹的来源。还有**Melpa Stable**，它类似于 Melpa，但抓取上游 repo 的标记修订而不是最新修订。Melpa stable 的软件包比 Melpa 少。

    **Org 模式**有自己的`package.el`repo ( [http://orgmode.org/elpa/](http://orgmode.org/elpa/) )。

    所有包 repos 的工作方式都是一样的，您只需将它们添加到您的`package-archives`.

    这是关于这个主题的更深入的[博客文章](http://blog.jorgenschaefer.de/2014/06/the-sorry-state-of-emacs-lisp-package.html)，我非常同意。

3.  我不确定，但我认为如果一个包在不同的 repos 中重复，repos 出现的顺序`package-archives`决定了优先级。我不知道更高的优先级是在列表的开头还是结尾。

    更新：在 Emacs 25 中，您可以使用一个变量`package-archive-priorities`来确定包存储库的优先级（例如，ELPA 优于 MELPA）。

* * *

`init.el`如果您有兴趣，这是我的相关部分：

```
(setq jpk-packages
      '(
        ac-dabbrev
        ...
        yasnippet
        ))

(package-initialize)
(add-to-list 'package-archives
             '("melpa" . "http://melpa.org/packages/"))
(add-to-list 'package-archives
             '("org" . "http://orgmode.org/elpa/"))

;; install any packages in jpk-packages, if they are not installed already
(let ((refreshed nil))
  (when (not package-archive-contents)
    (package-refresh-contents)
    (setq refreshed t))
  (dolist (pkg jpk-packages)
    (when (and (not (package-installed-p pkg))
             (assoc pkg package-archive-contents))
      (unless refreshed
        (package-refresh-contents)
        (setq refreshed t))
      (package-install pkg))))

(defun package-list-unaccounted-packages ()
  "Like `package-list-packages', but shows only the packages that
  are installed and are not in `jpk-packages'.  Useful for
  cleaning out unwanted packages."
  (interactive)
  (package-show-package-list
   (remove-if-not (lambda (x) (and (not (memq x jpk-packages))
                            (not (package-built-in-p x))
                            (package-installed-p x)))
                  (mapcar 'car package-archive-contents)))) 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2013-02-12T17:59:20.673

在 Emacs 中，用于`M-x list-packages`列出所有将自动刷新存档内容的包。之后用于`U`标记所有要升级的可升级包，并`x`实际执行新的更新。然后，Emacs 将获取并安装所有升级，并询问您之后是否删除旧的、过时的版本。

您可能还想看看[Carton](https://github.com/rejeep/carton)，它通过在专用文件中声明它们提供了一种更方便的方式来管理您的包，并包括一个方便的命令行客户端来自动安装和升级以这种方式声明的包。

* * *

**的**顺序`package-archives`无关紧要。Emacs 将所有档案的内容聚合成一个可用包及其版本的连贯列表，存储在.**`package-archive-contents`**

 **在 之后`package-install`，Emacs 将简单地选择包的最新版本，而不管原始存档。为了更好地控制包的来源，MELPA 提供了[melpa 包](https://github.com/milkypostman/melpa#melpa-package)，它允许将来自指定档案的包列入黑名单或白名单。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2017-10-01T00:19:49.077

在终端：

```
emacs

M-x list-packages 
```

这会让你进入 *packages* 缓冲区

```
shift-u x 
```

emacs 会问你（y/n），等待更新

```
C-x k <ret> 
```

这将杀死 *packages* 缓冲区并将您返回到 *scratch*

```
C-x-C-c 
```

这将退出emacs，并让您通过重新启动，但您可能需要调试:(

```
emacs 
```

我的 2¢

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-10T09:45:18.350

这更像是对 jpkotta 答案的扩展评论。

这是我正在尝试针对 jpkotta 上面的答案进行的调整：

```
(setq n 0)                                  ; set n as 0
(dolist (pkg pkgs-2b-present)               ; for each pkg in list
  (unless (or                               ; unless
           (package-installed-p pkg)        ; pkg is installed or
           (assoc pkg                       ; pkg is in the archive list
                  package-archive-contents))
    (setq n (+ n 1))))                      ; add one to n
(when (> n 0)                               ; if n > 0, 
  (package-refresh-contents))               ; refresh packages 
```

（替换`(when (not package-archive-contents) (package-refresh-contents))`）。

对于我的用例，包列表的刷新频率不够高。

我没有考虑是否有更有效的解决方案来解决我的问题；首先，我要看看这个调整是否会解决问题。**

# javascript - Javascript换行符不起作用

> ID：14836959
> 
> 赞同：1
> 
> 时间：2013-02-12T16:20:29.780
> 
> 标签：javascript, html, line-breaks

我有这个非常大的文本，我想在其中添加换行符以便在我的应用程序上看起来更好。我试过使用

`"<br>", "\n"`

将文本切割成碎片。我什至试图改变跨度的宽度，但似乎没有任何效果。我究竟做错了什么？任何帮助表示赞赏。

```
<span id="instr" style="color: white; font-size: 15pt;"></span>

<script type="text/javascript">
function instructions(){
....

document.getElementById("instr").textContent = "Really biiiiiiiiiiiiiiiiiiiiiiiiig text here";

}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:22:30.247

要设置`<br />`换行符，您需要使用`innerHTML`属性：

```
document.getElementById("instr").innerHTML = "Really<br />biiiiiiiiiiiiiiiiiiiiiiiiig<br/ >text here"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:26:41.630

You could use the CSS `white-space` property to wrap text. See here for more information: [https://developer.mozilla.org/en-US/docs/CSS/white-space](https://developer.mozilla.org/en-US/docs/CSS/white-space)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:22:12.440

用于`document.getElementById("instr").innerHTML`插入`<br>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T16:25:22.487

因为 span 是内联元素，所以我不会使用它。我会尝试 div 或 p 元素。如果必须，请查看自动换行属性

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-12T16:26:26.573

只需使用`innerText`而不是`textContent`. 然后你可以使用`\n`.

```
document.getElementById("instr").innerText = "Really biiiiiiiiiiiiiiiiiiiiiiiiig\n text here"; 
```

或`innerHTML`与`<br/>`.

```
document.getElementById("instr").innerHTML = "Really biiiiiiiiiiiiiiiiiiiiiiiiig<br/> text here"; 
```

jsFiddle：http: [//jsfiddle.net/phCmH/](http://jsfiddle.net/phCmH/)

# jquery-mobile - 带有后退按钮的jquery移动对话框

> ID：14836960
> 
> 赞同：1
> 
> 时间：2013-02-12T16:20:32.573
> 
> 标签：jquery-mobile, mobile

我有一个站点，其用户登录表单显示在 data-rel='dialog' 链接中。问题是当您点击浏览器后退按钮时，该对话框出现在历史记录中。[此处截屏](http://solomon.ie/so/backbutton.gif)- a) 显示初始未登录状态，b) 单击“登录”按钮后打开对话框，c) 成功登录，d) 我已点击后退按钮并获取我的对话框，e) 我已关闭带有默认“x”按钮的对话框被带回我的主页，但处于注销状态。

在下面的代码中，登录按钮/链接（到 '/php/mobile_login.php' ）被替换为一个人的名字是在服务器端检测到登录 cookie。

另外，鉴于我在禁用 data-dom-cache 的情况下返回主页，它不应该再次从服务器获取它吗？

非常感谢，凯文

```
<!DOCTYPE html>

<html lang='en'>
<head>
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<title>title</title>
<meta name='viewport' content='width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no;' />

<script src='//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
<script src='/js/jquery_mobile_global_defaults.js'></script>
<script src='http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js'></script>
<link rel='stylesheet' href='/design/mobile_style.css'>
<link rel='stylesheet' href='http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css' />
</head>
<body>

<div data-role='page' data-dom-cache='false' id='homepage'>

    <div class='header'>
        <div class='logo'></div>
        <div class='login'><a href='/php/mobile_login.php' data-overlay-theme='b' data-transition='none' data-rel='dialog' data-role='button' data-inline='true' data-icon='arrow-r' data-iconpos='right' data-theme='a' data-mini='false'>Login</a></div>
    </div>

    <div class='mobile_content'>
    content
    </div>

</div>

</body>
</html> 
```

对话：

```
<!DOCTYPE html>

<html lang='en'>
<head>
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<title>title</title>
<link rel='stylesheet' href='/design/mobile_style.css'>
<link rel='stylesheet' href='http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css' />
<script src='//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
<script src='/js/jquery_mobile_global_defaults.js'></script>
<script src='http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js'></script>
</head>

<body>

<div data-role='dialog'  id='member_login_div' data-overlay-theme='b'>
        <div data-role='header' data-theme='d'>
            <h1>Login</h1>

        </div>

        <div data-role='content' data-theme='c'>
        Login below to apply for jobs with your stored CV (use the desktop version of the site to upload your CV if you have not already done so).
        <form data-ajax='false'  method='POST' action='/php/mobile_do_login.php'>
        <label for='cjloginemail' class='ui-hidden-accessible'>Email Address</label>
        <input type='text' name='user_email' id='cjloginemail' value='kevin@solomon.ie' placeholder='Email Address'>
        <label for='cjloginpass' class='ui-hidden-accessible'>Password</label>
        <input type='password' name='password' id='cjloginpass' value='' placeholder='Password'>
        <input name='Submit' type='submit' value='Login'>
        </form>
        <p><a href='/php/mobile_forgot_pass.php'>I forgot my password - email it to me.</a>

    </div>

</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:05:15.117

也许您可以尝试使用关闭任何 dailog onload`$('.ui-dialog').dialog('close').`

REF：[JQuery 移动端 - Dailogs](http://jquerymobile.com/demos/1.2.0/docs/pages/dialog/index.html)

我在同一页上读过这个，很奇怪它发生在你身上。

**

## 历史记录和后退按钮行为

**

由于对话框通常用于支持页面内的操作，因此该框架不包括哈希状态历史跟踪中的对话框。这意味着单击“后退”按钮时，对话框不会出现在您的浏览历史年表中。例如，如果您在一个页面上，单击一个链接打开一个对话框，关闭对话框，然后导航到另一个页面，如果您此时单击浏览器的“后退”按钮，您将导航回第一页，而不是对话框。

**更新**：对话框出现在 FireFox 浏览器的后退按钮上。在 IE9 和 Chrome 上运行良好。

# git - 如何将嵌套的 git repo 合并到父 repo 中，保留历史记录？

> ID：14836964
> 
> 赞同：8
> 
> 时间：2013-02-12T16:20:44.303
> 
> 标签：git

现在我知道大多数 git 专家会立即想到`git rebase`，但我在更一般的意义上使用“rebase”这个词：我的项目结构如下：

```
.
..
.git
tools
lib
src
    .git
build 
```

`.`和`./src`目录显然都是存储`git`库，并且每个都有很长的历史和大量的提交。`.`忽略目录中的存储库`src`（这是它自己的存储库）。

我刚刚意识到，我宁愿只使用一个 repo 来`.`跟踪包括源文件在内的所有内容，因为坦率地说，构建系统随着源代码的发展而发展，并且已经变得相当广泛。

我的问题是我不知道如何让这个存储库保留现在是`src`. 甚至可能吗？这就是我所说的“变基”的意思——如果在一些 N 提交`./src/main.c`中跟踪更改`./src/.git`，那么我想保留这些更改并让它们成为新存储库的一部分`./.git`。相同的历史记录，重新设置文件路径。

**更新**

从我在 SO 上收集的内容来看，子树合并不是我想要的。简而言之，它比我需要的要多得多。我只需要旧 repo 的内容，**所有开发分支**和所有提交、标签等看起来好像它们总是父 repo 的一部分。从本质上讲，唯一的变化是文件本身的路径——在跟踪子仓库之前`./main.c`，新的仓库现在将跟踪`./src/main.c`，因为正如我所听说的那样，`git`跟踪内容，而不是文件，然后像上面那样更改文件路径和对这些的引用路径，应该相当琐碎，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:51:38.217

**快速简便的方法：**

重命名 src 中的所有文件，因此它们将以`src/`. 将 src repo 添加为远程，获取和合并。删除旧的 src 存储库，现在一切都在`./`.

这将使您将此操作记录在历史中。

**历史改写：**

要使此合并不可见，您需要使用在 src 存储库`git filter-branch --tree-filter`中添加`src/`前缀。然后将此作为远程添加到`./`存储库并获取它（尚未合并）。为了很好地融合历史，您需要重新排序提交。用于`git log --date-order master src/master`以正确的顺序检索这些提交并挑选它们：

```
git checkout -b new-master your-first-commit
git log --format='%H' --date-order --reverse master src/master | xargs git cherry-pick 
```

这基本上会对您的提交进行合并排序并将它们排列到线性历史记录中。

这不会保留您的合并，因此除非您有平坦的历史记录，否则不要这样做。在这种情况下，仅使用过滤器分支，然后进行正常合并。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:28:29.250

使用子树合并。

我会列出这些步骤，但它们在这个问题的答案中：[你如何合并两个 git 存储库？](https://stackoverflow.com/questions/1425892/how-do-you-merge-two-git-repositories)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:26:36.613

如果这可行，则没有真正的用处，但值得一试。假设 src 在远程服务器上，而父级在远程服务器上。您可以尝试以下方法。

*   git clone url 到远程服务器以使用工具、lib 和构建克隆 repo
*   git 将远程 src url 添加到 src 远程仓库
*   创建 src 远程 repo 的跟踪分支，然后在父 repo 上检查它
*   将远程跟踪分支合并到您的主分支中。
*   删除第二个遥控器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-29T23:17:46.510

我需要做同样的事情，这对我有用：

从父回购，

```
git remote add -f subrepo git@github.com:sub/repo.git
git merge -s ours --no-commit subrepo/master
git read-tree --prefix=subrepo/ -u subrepo/master
git commit -m "Subtree merged" 
```

这来自 GitHub 帖子，其中也有更多详细信息： [https ://help.github.com/articles/about-git-subtree-merges/](https://help.github.com/articles/about-git-subtree-merges/)

# jquery - 使用 JQuery 函数减少重复代码

> ID：14836965
> 
> 赞同：4
> 
> 时间：2013-02-12T16:20:47.183
> 
> 标签：jquery

在这里找到了一个很好的jquery弹出功能：

```
 JAVASCRIPT
 $(function() {
    $("#word1234").live('click', function(event) {
        $(this).addClass("selected").parent().append('
          <div class="messagepop pop">"Lorem ipsum dolor sit amet, 
          consectetur adipisicing elit, sed do eiusmod tempor incididunt</div>');
        $(".pop").slideFadeToggle()
        $("#email").focus();
        return false;
    });
    $(".close").live('click', function() {
        $(".pop").slideFadeToggle();
        $("#contact").removeClass("selected");
        return false;
    });

 HTML
 <a href='/word1234' id='word1234'>Supercalifragilisticexpialidocious</a> 
```

有没有更有效的方法来调用这个弹出窗口？如果我在一个页面上有数百个定义，我会重复很多看似不必要的代码。

如果我在本机 JS 中执行此操作，我只需为 href 标记设置一个 onClick 函数，类似于

```
 <a href="#" id="word1234" onClick="doPop(this, 'Lorem ipsum, ect.')">Supercalifragilisticexpialidocious</a> 
```

在 JQuery 中是否有类似的调用函数的方法？

**编辑** 经过一些调试，可以在此处找到更新/修复脚本的工作版本：http: [//jsfiddle.net/N4QCZ/13/hth](http://jsfiddle.net/N4QCZ/13/) 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:38:24.080

您可以像这样将代码转换为[jQuery 插件](http://docs.jquery.com/Plugins/Authoring)：

```
$.fn.myPopup = function(popupText){
    var popupHtml = '<div class="messagepop pop">' + popupText + '</div>';
    this.each(function(){
        $(this).click(function(){

            // Create the popup
            $(this).addClass("selected").parent().append(popupHtml);

            // Find the close button and attach click handler
            $(this).find(".close").click(
                // Find, hide, then delete the popup
                $(this).closest(".pop").slideFadeToggle().remove();;
            );

        });
        return false;
    });

    return this;
}; 
```

然后您的代码将如下所示：

```
$("#word1234").myPopup("Lorem Ipsum");
$("#wordABCD").myPopup("Hello World"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:24:17.773

不要使用`live`use `on`，从 1.7 开始不推荐使用 live ：

您可以为您的链接提供一个弹出类并执行以下操作：

```
$(".popup").on("click", function() {
    // Your code
}); 
```

这样您就可以捕获`popup`该类的所有链接，并且不绑定到 100 个事件，即：

```
$("#id1").click() { }
$("#id2").click() { } 
```

等等

# jquery - 我怎样才能用图像设置单选按钮

> ID：14836969
> 
> 赞同：3
> 
> 时间：2013-02-12T16:20:58.577
> 
> 标签：jquery, css, radio-button

我想设置我的单选按钮的样式，以便它们使用未选中和选中的图像。

以下是我使用的css：

```
 input[type="radio"]
        {
            background: url("https://where-to-buy.co/content/images/selector.png")no-repeat;
            padding: 0;
            display: inline-block;
            appearance: none;
            -moz-appearance: none;
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            vertical-align: middle;
            border: 1px solid black;
        }
        input[type="radio"]:checked
        {
            background: url("https://where-to-buy.co/content/images/selectorhighlighted.png")no-repeat;
        } 
```

我使用的代码似乎已经拾取了未选择的图像，但它周围有一个奇怪的边框，当我点击它而不是用新的背景图像替换未选择的图像时，它只是在那里放了一个大黑点请看：

[http://jsfiddle.net/afnguyen/mMr9e/](http://jsfiddle.net/afnguyen/mMr9e/)

跨浏览器（包括 ie7 和 8）工作很重要，我正在使用 jquery，所以很乐意使用 jquery 选项。

**编辑**

最终解决如下：

[http://jsfiddle.net/afnguyen/GSrZp/](http://jsfiddle.net/afnguyen/GSrZp/)

使用 jquery 库：[http ://code.jquery.com/jquery-1.8.3.min.js](http://code.jquery.com/jquery-1.8.3.min.js)

jQuery：

```
 $(document).ready(function () {

            $(function () {

                $('input:radio').hide().each(function () {

                    var label = $("label[for=" + '"' + this.id + '"' + "]").text();

                    $('<a title=" ' + label + ' " class="radio-fx ' + this.name + '" href="#"><span class="radio"></span></a>').insertAfter(this);

                });

                $('.radio-fx').on('click', function (e) {

                    $check = $(this).prev('input:radio');

                    var unique = '.' + this.className.split(' ')[1] + ' span';

                    $(unique).attr('class', 'radio');

                    $(this).find('span').attr('class', 'radio-checked');

                    $check.attr('checked', true);

                    var selValue = $('input[name=rbnNumber]:checked').val().split(",")[0];

                    var rpValue = $('input[name=rbnNumber]:checked').val().split(",")[1];

                    $('input[name=retailerProductId]').val(selValue);

                    $('span[class=actualPrice]').text(rpValue);

                     $('input[name=rbnNumber]').attr('disabled', 'disabled' );

                    $(".radio").attr('disabled', 'disabled' );

                      $(".radio").css("opacity", "0.3")

                    $(".radio-checked").css("opacity", "1")

                    $("#332527").css("opacity", "0.5")

                    $("#114578").css("opacity", "0.5")

                    $("#108660").css("opacity", "0.5")

                    $("#373455").css("opacity", "0.5")

                    var rpSelected = $("#retailerProductId").val();

                    $('#' + rpSelected).css("opacity", "1");

                }).on('keydown', function (e) {

                    if (e.which == 32) {

                        $(this).trigger('click');

                    }

                });

            });

        }); 
```

HTML：

```
 <div class="divRadiobtns">
                        <input class="radioOptions" type="radio" name="rbnNumber" value="332527, £2.89" />
                        <input class="radioOptions" type="radio" name="rbnNumber" value="114578, £2.59" />
                        <input class="radioOptions" type="radio" name="rbnNumber" value="108660, £2.60" />
                    </div>
                    <div class="divInputs">
                        <input type="hidden" name="retailerProductId" id="retailerProductId" class="retailerProductId"></input>
                        <span class="actualPrice"></span>
                    </div> 
```

CSS：

```
 .radioOptions
        {
        }

        .divRadiobtns
        {
            float: left;
            width: 20px;
        }

        a.radio-fx span, a.radio-fx
        {
            display: inline-block;
            padding-bottom: 14px;
            padding-top: 14px;
            float: left;
        }

        .divRadiobtns .radio, .divRadiobtns .radio-checked, .divRadiobtns a.radio-fx
        {
            height: 18px;
            padding-bottom: 14px;
            padding-top: 14px;
            width: 32px;
            float: left;
        }

        .divRadiobtns .radio
        {
            background: url(https://where-to-buy.co/content/images/selector.png) no-repeat;
        }

        .divRadiobtns .radio-checked
        {
            background: url(https://where-to-buy.co/content/images/selectorhighlighted.png) no-repeat;
        } 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T16:27:43.260

普遍接受的方法是使用带有“for”属性的标签，该标签与相关无线电输入的“ID”相匹配。

然后你只需给收音机输入位置：绝对和隐藏的可见性，并将你想要的图像/文本等放在标签内。

```
<input type="radio" id="radio1" name="radio">

<label for="radio1"><img src=my-image.jpg></label> 
```

为了在选择单选按钮时更改图像，我在此处修改了您的小提琴：

[http://jsfiddle.net/mMr9e/3/](http://jsfiddle.net/mMr9e/3/)

您可以使用该小提琴中的主体将图像设置为标签的背景或标签内的跨度，并在检查时更改背景，就像我在示例中使用背景颜色一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:28:32.847

之前有人问过这个问题：

*   [如何设置 (css) 单选按钮和标签的样式？](https://stackoverflow.com/questions/43643/how-do-i-style-css-radio-buttons-and-labels)
*   [我如何为带有图像的单选按钮设置样式 - 笑的笑脸是好的，悲伤的笑脸是坏的？](https://stackoverflow.com/questions/3896156/how-do-i-style-radio-buttons-with-images-laughing-smiley-for-good-sad-smiley)
*   [与 <input type="radio"> 一起使用的良好 HTML 和 CSS？](https://stackoverflow.com/questions/3133506/good-html-and-css-to-use-with-input-type-radio)
*   [CSS3 - 在旧版浏览器 (ie7/ie8) 上使用 :checked 选择器设置单选输入样式](https://stackoverflow.com/questions/7461756/css3-style-radio-inputs-using-the-checked-selector-on-older-browsers-ie7-ie8)

你会找到所有你需要知道的。

再看看 Stackoverflow ： ![在此处输入图像描述](../Images/46c03444368b51c2e8e46a0c6ca07e26.png)

附言。互联网变得可悲的是，它充满了广告（垃圾），以至于没有人再关心旁白的内容了。

# c - 需要解释 Word2 变量

> ID：14836978
> 
> 赞同：0
> 
> 时间：2013-02-12T16:21:24.157
> 
> 标签：c, cstring, strcpy

我明白这个程序没有分配足够的内存。

我需要帮助的是描述执行此代码时发生的情况的解释。

我输入“由于只分配了 4 个空间，因此没有提供足够的空间，因此会导致错误。” 这对我来说听起来不对。谢谢。

```
#include <stdio.h> 
#include <string.h>

int main()
{ 
    char word1[20];
    char *word2;

    word2 = (char*)malloc(sizeof(char)*20);

    printf("Sizeof word 1: %d\n", sizeof (word1));  //This line outputs 20
    printf("Sizeof word 2: %d\n", sizeof (word2));  //This line outputs 4
                                                    //before & after I used malloc
    strcpy(word1, "string number 1");
    strcpy(word2, "string number 2"); <---- What is this doing

    printf("%s\n", word1);
    printf("%s\n", word2);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T16:23:12.493

word2 是一个未初始化的指针。向其写入数据会产生未定义的后果，但可能会崩溃。您需要在堆栈上（如 for `word1`）或动态地使用`malloc`.

```
char *word2 = malloc(20); // arbitrary value. could use strlen(some_str)+1 also
strcpy(word2, "string number 2"); // works now 
```

或者，对于 posix 系统

```
char *word2 = strdup("string number 2"); 
```

无论哪种情况，请确保稍后调用`free`以将此内存返回给系统。

请注意，即使在分配内存之后，`sizeof(word2)`仍将保持 4。这是因为`word2`has 类型`char*`因此`sizeof`报告的大小`char*`而不是它指向的内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:24:14.647

sizeof( word2 ) 返回 4 因为这是指针的大小

```
char *word2; 
```

是一个指针，为它分配了 0 个字节（不是你提到的 4 个）

sizeof( word1 ) 返回 20 因为这是数组的大小

```
char word1[20] 
```

是一个数组，为它保留了 20 个字节

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T16:28:14.613

在你的程序`word2`中会有一些以前的值或者可能是一个垃圾值。当您执行时`strcpy(word2, "string number 2");`，您正在尝试写入您无权访问的位置，因此您的程序崩溃。因此，您需要分配足够的内存供程序写入。

# pyqt - 基本 GUI 中的 QThread 解决方法

> ID：14836980
> 
> 赞同：0
> 
> 时间：2013-02-12T16:21:26.577
> 
> 标签：pyqt

这是示例代码

```
import sys, time
from PyQt4 import QtCore, QtGui

class MyApp(QtGui.QWidget):

    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        self.setGeometry(300, 300, 280, 600)
        self.setWindowTitle('threads')
        self.layout = QtGui.QVBoxLayout(self)
        self.testButton = QtGui.QPushButton("test")
        self.connect(self.testButton, QtCore.SIGNAL("released()"), self.test)
        self.listwidget = QtGui.QListWidget(self)
        self.layout.addWidget(self.testButton)
        self.layout.addWidget(self.listwidget)

    def add(self, text):
        print "Add: ", text
        self.listwidget.addItems(text)
        self.listwidget.sortItems()

#    def addBatch(self, text="test", iters=6, delay=0.3):
#        for i in range(iters):
#            time.sleep(delay)
#            self.add(text + "  " + str(i))

    def test(self):
        self.listwidget.clear()
        #self.addBatch("_non_thread", iters=6, delay=0.3)
        self.workThread = WorkThread()
        self.connect(self.workThread, QtCore.SIGNAL("update(QString"), self.add)
        self.workThread.start()

class WorkThread(QtCore.QThread):

    def __init__(self):
        QtCore.QThread.__init__(self)

    def __del__(self):
        self.wait()

    def run(self):
        for i in range(6):
            time.sleep(0.3)
            self.emit(QtCore.SIGNAL('update(QString'), "from work thread " + str(i))
        return

app = QtGui.QApplication(sys.argv)
test = MyApp()
test.show()
app.exec_() 
```

在这里，我有一个带有列表小部件和一个按钮的基本 GUI。当我按下按钮时，我的程序应该稍等片刻，并在该列表小部件中显示一个字符串。WorkThread 类执行等待的工作，等待后它会发出一个信号。但是当我运行程序时，只有我可以看到 GUI，而 listwidget 中什么也没有显示。

有人能告诉我这背后的原因是什么以及如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T19:12:32.543

[`QListWidget.addItems`](http://qt-project.org/doc/qt-4.8/qlistwidget.html#addItems)需要一个项目列表，但你给它一个`QString`. 你应该使用[`.addItem`](http://qt-project.org/doc/qt-4.8/qlistwidget.html#addItem).

还有一些小的更正。你不需要`__del__`在你的线程中实现。`__init__`如果你不做额外的事情，你可以跳过。你应该使用[新风格的信号和连接](http://pyqt.sourceforge.net/Docs/PyQt4/new_style_signals_slots.html)。

这是所有更正的结果：

```
import sys, time
from PyQt4 import QtCore, QtGui

class MyApp(QtGui.QWidget):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        self.setGeometry(300, 300, 280, 600)
        self.setWindowTitle('threads')
        self.layout = QtGui.QVBoxLayout(self)
        self.testButton = QtGui.QPushButton("test")
        self.testButton.clicked.connect(self.test)
        self.listwidget = QtGui.QListWidget(self)
        self.layout.addWidget(self.testButton)
        self.layout.addWidget(self.listwidget)

    def add(self, text):
        print "Add: ", type(text)
        self.listwidget.addItem(text)
        self.listwidget.sortItems()

#    def addBatch(self, text="test", iters=6, delay=0.3):
#        for i in range(iters):
#            time.sleep(delay)
#            self.add(text + "  " + str(i))

    def test(self):
        self.listwidget.clear()
        #self.addBatch("_non_thread", iters=6, delay=0.3)
        self.workThread = WorkThread()
        self.workThread.update.connect(self.add)
        self.workThread.start()

class WorkThread(QtCore.QThread):
    update = QtCore.pyqtSignal(str)

    def run(self):
        for i in range(6):
            time.sleep(0.3)
            self.update.emit("from work thread " + str(i))

app = QtGui.QApplication(sys.argv)
test = MyApp()
test.show()
sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:43:28.630

[PyQtWiki 包含一个非常详细的示例](http://diotavelli.net/PyQtWiki/Threading,_Signals_and_Slots)，如何将信号从后台线程发送到 UI。显然，只要您`QThread`实现线程，就不需要特殊的魔法。

但我注意到您使用信号`released()`将按钮与方法连接起来`test()`。你试过了`clicked()`吗？

# vb.net - 使用 Visual Studio 即时窗口，如 VBA 即时窗口

> ID：14836982
> 
> 赞同：0
> 
> 时间：2013-02-12T16:21:28.280
> 
> 标签：vb.net, visual-studio, immediate-window

在 VBA 即时窗口中，我可以随时简单地键入以下内容：

```
?Len("Four") 
```

按回车并得到结果：

```
4 
```

如果我尝试在 Visual Studio Express (VB.NET) 中执行此操作，我会得到以下结果：

```
The name 'Len' does not exist in the current context 
```

我认为这与 VBA 是一种“脚本”语言和需要编译的 VB.Net 有关。我只是在寻找一种使用内置库中的函数来评估表达式的简单方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:33:04.990

我刚刚创建了一个新的控制台应用程序并测试了两者

```
?"Four".Length 
```

和

```
?Len("Four") 
```

`4`在我的项目运行后，这两者都会导致。

你有一个可以运行的项目吗？需要在正在运行的项目的上下文中评估即时窗口。如果是这样的话，

您是否已`Microsoft.VisualBasic`在项目属性“参考”选项卡中导入？如果我删除我得到的，

> 'Len' 没有被声明。由于其保护级别，它可能无法访问。

但是，`Length`属性`System.String`仍然有效，因为我仍在导入`System`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T16:34:32.613

确保您当前正在单步执行您的代码。

# javascript - 在 Ember.js pre-4 中填充直接 url 访问的内容

> ID：14836987
> 
> 赞同：4
> 
> 时间：2013-02-12T16:21:49.600
> 
> 标签：javascript, ember.js, ember-router

摆弄大部分工作代码：http: [//jsfiddle.net/VDA2p/16/](http://jsfiddle.net/VDA2p/16/)

Route 的摘录相信问题出在哪里：

```
// #/listings/:listing_id/videos
App.VideosRoute = Ember.Route.extend({
    model: function(params) {
        return this.modelFor('listing');
    }
}); 
```

如果我选择“视频”链接，则 url 是“/listings/1/videos”（例如），我的内容加载得很好。如果我通过地址栏直接访问此 url，则不会检索到任何视频。我一直在玩对 serialize() 的调用，但无法让它工作，我不确定我是否走在正确的道路上。我还注意到，一旦我直接访问 url 并且没有得到任何视频，如果我直接转到“/listings”url（它可以很好地加载内容）并选择任何“视频”链接，视频内容是不再为任何条目加载。但是，如果我在“/listings”网址上刷新浏览器/应用程序，则内容存在于“视频”链接下。

**更新 1：**

如果我将上面的原始代码段更改为

```
// #/listings/:listing_id/videos
App.VideosRoute = Ember.Route.extend({
    model: function(params) {
    return App.Listings.find(params.listing_id);
    }
}); 
```

它按预期工作，虽然我不明白为什么。

**更新 2：**

但是，当直接访问“/listings/1/videos”网址而不是通过链接时，它确实破坏了“查看视频”链接。它现在显示为“/listings/null/videos/1”，即使当您单击它时，单个视频也可以正常加载。使用后退按钮将带您回到“/listings/1/videos”，其中所有“查看视频”链接不再包含“null”。

例如，尝试直接访问 '/listings/1/videos/2' url 会引发错误“错误：断言失败：您在路由器中使用了动态段 video_id，但 App.Video 不存在并且您没有超越你的州的`model`钩子。” 我现在也在努力追捕。选择“查看视频”链接将很好地加载数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:14:25.253

[jsFiddle 示例](http://jsfiddle.net/VDA2p/24/)

您要做的是使用嵌套路由结构。这允许每个嵌套级别在评估路由时执行其序列化/反序列化。

例如，如果您直接输入 URL `/listings/1/videos/2`，则`App.ListingsRoute`调用 's 方法，然后是`App.ListingRoute`'s，然后`App.VideosRoute`是 's，然后是 finally `App.VideosVideoRoute`'s。在您的旧路由器中，扁平性质不允许 URL 部分`/listings`或`/listings/:listing_id`正确处理，从而导致您看到的错误。

由于添加了嵌套，一些模板和路由的名称与原始示例略有不同。如果您想了解有关嵌套路由命名方案的更多详细信息，请查看[emberjs 路由文档。](http://emberjs.com/guides/routing/defining-your-routes/)

这`renderTemplate`部分代码告诉 ember 将模板渲染到路由`{{outlet}}`提供的`application`路径中。默认情况下假设`{{outlet}}`每个嵌套路由中都有嵌套的 s。

路由器：

```
App.Router.map(function() {
    this.resource('listings', function() {
        this.resource('listing', { path: '/:listings_id' }, function(){
            this.resource('videos', function() {
                this.route('video', { path: '/:videos_id' });
            });
        });
    });
}); 
```

路线：

```
// #/index
App.IndexRoute = Ember.Route.extend({
    redirect: function(){
            this.transitionTo('listings');
    }
});

// #/listings
App.ListingsIndexRoute = Ember.Route.extend({
    model: function() {
        return App.Listings.find();
    },
    renderTemplate: function() {
        this.render({into: 'application'});   
    }
});

// #/listings/:listing_id
App.ListingRoute = Ember.Route.extend({});

// #/listings/:listings_id/videos
App.VideosIndexRoute = Ember.Route.extend({
    model: function(params) {
        return this.modelFor('listing').get("videos");
    },
    renderTemplate: function() {
        this.render({into: 'application'});   
    }
});

// #/listings/:listings_id/videos/:videos_id
App.VideosVideoRoute = Ember.Route.extend({
    renderTemplate: function() {
        this.render({into: 'application'});   
    }
}) 
```

# jquery - 使用 jQuery 的 Ajax 表单

> ID：14836992
> 
> 赞同：0
> 
> 时间：2013-02-12T16:22:07.983
> 
> 标签：jquery, ajax, forms, symfony

我正在制作一个功能，使我网站中的每个表单都提交但“从后面”提交，因此网站不会被重定向。

这是代码：

```
$('form').each(function(data){
    var el = $(this);
    $(el).submit(function(){
        var action = el.attr('action');
        $.post(action, function(){
            console.log(action);
        });
        return false;    
    });
}); 
```

“console.log”日志de URL没有问题，同一个URL有表单的数据。但是 $.post 函数不会提交它。

任何想法？，这是在 symfony2 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:25:08.130

不要忘记发布您的表单数据

我用 $.ajax 举了一个例子

```
$(".yourform").submit(function(e){
  e.preventDefault();
  var data = $(this).serialize();
  var action = $(this).attr('action');

  $.ajax({
       url: action,
       type: "POST",
       data: data,
       success: function(result) {                        
         //logic here
       }); 
   });

}); 
```

# c# - 有没有办法将通过 TaskCompletionSource 驱动的任务设置为状态“正在运行”？

> ID：14836995
> 
> 赞同：9
> 
> 时间：2013-02-12T16:22:13.840
> 
> 标签：c#, task-parallel-library

我`TaskCompletionSource`用来提供和驱动`Task`. 我希望能够将`Task`状态设置`Running`为指示任务正在...“运行”但是我看不到通过`TaskCompletionSource`.

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-03T18:18:26.623

不，没有办法。

然而，不管你喜不喜欢我的回答，它都是正确的。:-)

以下是我的意见，并试图帮助您感觉更好。

Task.Status 有几个状态，只有在任务是计划任务时才设置和有用。TaskCompletionSource 中的任务不是计划任务。WaitingToRun、Running 等概念因此不适用于传统的计划任务意义。如果您确实有能力设置这些值，则必须决定将哪些语义应用于这些值，这可能与其他人对它们的解释方式相冲突。

最终，我认为您的代码无论如何都不应该根据这些中间状态做出任何决定。这样做听起来像是“代码味道”。

# matlab - Matlab GUI 中的星级评定

> ID：14836997
> 
> 赞同：1
> 
> 时间：2013-02-12T16:22:15.933
> 
> 标签：matlab, matlab-guide

有没有办法在 matlab GUI 中添加评分按钮？

类似的东西 [http://www.fyneworks.com/jquery/star-rating/](http://www.fyneworks.com/jquery/star-rating/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:09:07.970

AFAIK 没有提供此功能的内置 UIControl。我能想到的最接近的控件是[滑块](http://www.mathworks.com/help/matlab/ref/uicontrol_props.html#bqxoip6)。指定 MIN、MAX 和步长，用户将被迫选择几个特定值之一。

将 JAVA 组件集成到 GUI 中的其他选项

*   [http://blog.noblemaster.com/2010/08/31/star-rating-panel-for-java-swing/](http://blog.noblemaster.com/2010/08/31/star-rating-panel-for-java-swing/)
*   [http://code.google.com/p/starrating/](http://code.google.com/p/starrating/)

或者你可以想出一个聪明的方法在 matlab 中使用单选按钮和图像的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-05T16:36:40.620

我最终编写了自己的评分系统 [http://www.mathworks.com/matlabcentral/fileexchange/41997-star-rating](http://www.mathworks.com/matlabcentral/fileexchange/41997-star-rating)

# c++ - 插槽后的 Qt 访问冲突 0xC0000005

> ID：14836999
> 
> 赞同：1
> 
> 时间：2013-02-12T16:22:23.617
> 
> 标签：c++, qt, qt4

我有一个问题，我刚刚想出该怎么做，所以也许你可以帮助我。

我正在开发一个连接到数据库、显示值并允许用户更新/插入值的应用程序。

我有一个`QTabView`，其中一个选项卡中有四个`QTableWidget`。在这个表里面有时（取决于数据库的值）`QComboBox`选择一些预定义的值。`QComboBox::selectedIndexChanged(int)`我用 a捕获`QSignalMapper`并`slot`连接到`QSignalMapper`以提供一些信息它是什么表以及更改了哪些设置。我不时创建新的 SettingsMapper（并在此之前将其删除）以重置“过时的”映射器组合框连接。

所以问题是，当我更改组合框中的索引时，插槽被调用，我可以调试到信号/插槽连接开关所在的 moc_*.cpp，但之后我得到`access violation on address 0xC0000005`了 dll 的内部。

这里是调用堆栈：

```
QtCored4.dll!6721af70()     
[Frames below may be incorrect and/or missing, no symbols loaded for QtCored4.dll]  
QtCored4.dll!67219fe5()     
QtCored4.dll!67218f14()     
QtCored4.dll!67218e48()     
QtCored4.dll!6721903d()     
QtCored4.dll!6720f874()     
QtCored4.dll!6702429b()     
QtCored4.dll!670316f3()     
QtGuid4.dll!655b93f1()  
QtGuid4.dll!650f99d0()  
user32.dll!7e41885a()   
user32.dll!7e41882a()   
user32.dll!7e42b326()   
msctf.dll!7472467f()    
user32.dll!7e43e1ad()   
user32.dll!7e43e18a()   
QtCored4.dll!67234b9c()     
user32.dll!7e42b372()   
user32.dll!7e418734()   
user32.dll!7e418816()   
user32.dll!7e4189cd()   
user32.dll!7e418a10()   
QtCored4.dll!672359b6()     
ntdll.dll!7c90cfdc()    
ntdll.dll!7c958e0d()    
ntdll.dll!7c95932a()    
ntdll.dll!7c90cfdc()    
ntdll.dll!7c9594ca()    
ntdll.dll!7c919ca7()    
ntdll.dll!7c918f01()    
ntdll.dll!7c91925d()    
ntdll.dll!7c918f01()    
ntdll.dll!7c9101bb()    
ntdll.dll!7c9192ef()    
ntdll.dll!7c918f01()    
ntdll.dll!7c9101bb()    
user32.dll!7e4277b0()   
user32.dll!7e4277f7()   
ntdll.dll!7c90da0c()    
kernel32.dll!7c8024c7()     
msctf.dll!74725951()    
msctf.dll!74725956()    
user32.dll!7e418a80()   
user32.dll!7e418734()   
user32.dll!7e418816()   
ntdll.dll!7c96c6a7()    
QtCored4.dll!6723c8f6()     
datProgram.exe!__tmainCRTStartup()  Line 578 + 0x35 bytes   C
datProgram.exe.exe!WinMainCRTStartup()  Line 403    C
kernel32.dll!7c817067() 
```

`

让我感到好奇的是，在另一个选项卡中`QTableWidget`具有与上述相同的方法，但问题不会在那里发生。在发布版本（Ctrl+F5）中运行时，问题似乎也消失了......ò.Ó

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:09:20.107

> 我不时创建新的 SettingsMapper（并在此之前将其删除）以重置“过时的”映射器组合框连接。

您是否有机会从由该信号映射器发送的信号调用的插槽中删除信号映射器？这是不允许的，当您当前处于该实例的方法中时，无法删除该实例。

解决方案是改用 deleteLater() 。当控制返回事件循环时，这将导致对象被删除。