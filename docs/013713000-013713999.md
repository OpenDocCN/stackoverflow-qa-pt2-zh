# StackOverflow 问答 13713000-13713999

# c++ - XCode 4.5 是否支持 lambda？

> ID：13713004
> 
> 赞同：1
> 
> 时间：2012-12-04T22:22:47.250
> 
> 标签：c++, xcode, xcode4.5

我无法在 XCode 4.5.2 中获得以下测试代码：

```
#include<algorithm>
#include<vector>
using namespace std;
int main()
{
  vector<int> v = {1, 2, 3};
  for_each(v.begin(), v.end(), [](int e){cout<<e;});
  return 0;
} 
```

语法检查器在`[]`符号前说“预期表达式”。
这是否意味着 XCode 4.5.2 不支持 lambda？

是否有任何项目设置、编译标志或其他可以启用 lambdas 的东西？

我的编译器是否有可能不是正确的版本？（苹果 LLVM 编译器 4.1）

我在 SO 和其他论坛上阅读了很多，他们说版本号令人困惑，但每个人似乎都同意 XCode 4.4+ 支持 lambdas。这里的真相是什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:26:37.937

Xcode 4.5.2 确实支持 lambda。您确定您处于 C++11 模式吗？转到您的构建设置。有一个 C++ 语言方言选项。它应该设置为`C++11`或`GNU++11`。其他任何事情都意味着您没有使用 C++11，因此没有 lambda。

# php - 使用 PHP 的 imagejpeg() 目录写入错误

> ID：13713010
> 
> 赞同：0
> 
> 时间：2012-12-04T22:23:03.530
> 
> 标签：php, mysql, file-upload, file-io

尝试保存图像时出现以下错误

```
Unable to open '/Applications/XAMPP/xamppfiles/htdocs/profile_images/' for writing:
Is a directory in /Applications/XAMPP/xamppfiles/htdocs/user.php on line 538 
```

这是给我带来麻烦的代码行

```
imagejpeg($image, "/Applications/XAMPP/xamppfiles/htdocs/profile_images/".$userid); 
```

我在 mac 和 mysql 上运行 XAMPP。

到目前为止，我已经完成了以下工作：

1.  打开目录选项并将每个人的访问权限设置为读/写
2.  检查 php.ini 并确保将 safe_mode 设置为关闭
3.  chmod 777 到该文件夹

还有其他建议吗？

以防万一我使用 chmod 错误，这正是我输入的

```
su root
chmod -R 777 /Applications/XAMPP/xamppfiles/htdocs/profile_images 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:33:30.063

imagejpeg 在第二个参数处需要一个文件名

```
imagejpeg ( resource $image [, string $filename [, int $quality ]] ) 
```

您指向的是目录，而不是文件名

# google-app-engine - 无法访问应用程序引擎java中的文件

> ID：13713019
> 
> 赞同：1
> 
> 时间：2012-12-04T22:23:27.353
> 
> 标签：google-app-engine

我意识到已经提出并回答了类似的问题，但是做那里提到的所有事情我似乎都无法让它发挥作用。

在 appengine-web 中。我有xml文件

```
<resource-files>
  <include path="war/WEB-INF/StaticFiles/*" />
</resource-files> 
```

我在 StaticFiles/ 中有一个要读取的 Test.txt 文件，所以我

```
BufferedReader reader = new BufferedReader(new FileReader("war/WEB-INF/StaticFiles/Test.txt")); 
```

我得到一个 FileNotFoundException。如果我将 FileReader 的路径更改为“/WEB-INF/StaticFiles/Test.txt”，我会收到一个无法访问被拒绝的错误。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T05:24:45.680

试着去掉`war/`这两个部分。

# git - 如何修改或删除远程 git repo 上的提交？

> ID：13713022
> 
> 赞同：0
> 
> 时间：2012-12-04T22:23:35.097
> 
> 标签：git

如果我在我的本地 repo 上提交了更改，那么 git push'ed 更改。我知道您可以修改和删除对本地存储库的提交，但是我输入哪些命令来为我的远程存储库执行类似的操作：

1）从远程仓库中删除我的最后一次推送。2）修改我最后一次推送到远程仓库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:24:33.243

您必须强制推送您的新参考：

```
vim yourfile
git add yourfile
git commit --amend --no-edit
git push -f origin yourbranch 
```

如果其他人正在使用您的存储库，请小心 - 特别是如果它是其他存储库的子模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:26:01.870

你必须先在本地做事。

一种选择是进行交互式变基并根据需要更改提交`push -f`。

`git rebase -i HEAD~10`最后 10 次提交

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:26:20.093

最后一次提交可能会为您提供更好的服务`revert`（即引入一个恢复前一个提交的新提交）。一旦你推送到远程仓库，你不应该重写历史。使用 git，revert 有一个非常具体的含义：创建一个带有反向补丁的提交以取消它。这样你就不会重写任何历史。

```
git revert sha 
```

然后正常推送，因为您的还原是一个新的提交，它不是一个特殊情况`push`，不需要强制任何东西。

[`git-revert`手册页](http://schacon.github.com/git/git-revert.html)在其描述中涵盖了很多内容。Git Community Book 中讨论 git-revert 的另一个有用链接在这里。

# c# - NullReference 异常未处理

> ID：13713025
> 
> 赞同：0
> 
> 时间：2012-12-04T22:23:46.500
> 
> 标签：c#, ado.net

将新团队添加到数据表时遇到问题。VisualStudio 指向带有 NullReference 错误的行 teams.Rows.Add(dr)。你能帮我么？

```
 private void addTeam(String nazwa)
    {

        DataRow dr = players.NewRow();
        //dr["playerID"] = nazwa;

        dr["nazwa"] = nazwa;
        teams.Rows.Add(dr); //<--there is en error
    }

class Program
{
    static DataTable players ;
    static DataTable teams;
    private DataSet teamMenager;

    static void Main(string[] args)
    { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:26:31.607

`DataTable`尚未[初始化](http://msdn.microsoft.com/en-us/library/ms173115%28v=vs.80%29.aspx)_

```
static DataTable teams; 
```

例如，您可以使用[默认构造函数](http://msdn.microsoft.com/en-us/library/aa645608%28v=vs.71%29.aspx)对其进行初始化：

```
static DataTable teams = new DataTable();
static DataTable players = new DataTable(); 
```

尽管尚不清楚您为什么将它们设为静态。这意味着每个实例都`Program`将共享相同的`DataTable`内容，这可能会给多个线程带来问题，因为您需要提供锁定机制。只需删除静态并创建一个实例`Program`：

```
static void Main(string[] args)
{ 
    Program p = new Program();
    p.Start(); // open your form(s) there and add teams or what else
    // ... 
```

**编辑**：还有其他问题。您正在创建新的`DataRow`via，`players.NewRow`但将其添加到 DataTable `teams`。这是不允许的。每个 DataRow 都属于一个 DataTable。这无法更改，并且会导致`ArgumentException`.

```
DataRow dr = players.NewRow();
dr["nazwa"] = nazwa; 
```

所以将其添加到播放器中：

```
players.Rows.Add(dr); //<--there is en error 
```

# yeoman - 使用 Yeoman 时的 app/templates 目录是什么？

> ID：13713026
> 
> 赞同：1
> 
> 时间：2012-12-04T22:23:58.257
> 
> 标签：yeoman

正如标题所示，我想知道使用 Yeoman 时 app/templates 目录的用途。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T21:30:42.893

Yeoman 团队成员在这里。

它只是用来放入您的模板。就像您的 Handlebar.js 模板或 Mustache 等。

当你这样做时，没有什么神奇的事情发生，至少现在还没有。只是我们想要执行的最佳实践。

# php - 为什么我不能在最近创建的目录中创建目录？

> ID：13713030
> 
> 赞同：2
> 
> 时间：2012-12-04T22:24:05.267
> 
> 标签：php, directory, mkdir, safe-mode, umask

> **可能重复：**
> [PHP mkdir 和 apache 所有权](https://stackoverflow.com/questions/2560762/php-mkdir-and-apache-ownership)

编辑反映新问题：

感谢您的帮助，我可以递归地在目录中创建一个目录，但我无法在这些创建的文件夹中创建多个文件夹。

代码：

```
$timelineID = trim(mysql_prep($_POST['timelineID']));
mkdir("timelines/{$timelineID}/audio", 0777, true);
mkdir("timelines/{$timelineID}/image", 0777, true);
mkdir("timelines/{$timelineID}/product", 0777, true); 
```

同样，第一个 mkdir() 成功执行，第二个没有。

错误：警告：mkdir() [function.mkdir]：安全模式限制生效。uid/gid 为 206601/206601 的脚本不允许访问第 13 行 (file.php) 中的 uid/gid 25000/25000 拥有的（我刚刚创建的目录）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:28:26.840

```
mkdir(path,mode,recursive,context) 
```

递归和上下文是可选参数

例如

```
mkdir("timelines/{$timelineID}/audio", 0777, true); 
```

适用于 PHP 5+

见： http: [//php.net/manual/en/function.mkdir.php](http://php.net/manual/en/function.mkdir.php)

# linux - 使用 shell 脚本从文件中提取唯一的行块

> ID：13713032
> 
> 赞同：3
> 
> 时间：2012-12-04T22:24:15.847
> 
> 标签：linux, bash, shell, unix

从文件中提取行块时，我遇到了一些问题。考虑以下两个文件

```
File-1
1.20/abc/this_is_test_1
perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess2
exec perl/RRP/RRP-1.30/JEDI/CommonReq/confAbvExp
perl/LRP/BaseLibs/close-MMM
exec perl/LRP/BaseLibs/launchLRPCHURRTA("TYRE")
this/or/that

File-2
exec 1.20/setup/testird
exec 1.20/sql/temp/Test3
exec 1.20/setup/testxyz
exec 1.20/sql/fondle_opr_sql_labels
exec 1.20/setup/testird
exec 1.20/sql/temp/NEWTest
exec 1.20/setup/testxyz
exec 1.20/sql/fondle_opr_sql_xfer
exec 1.20/setup/testird
exec 1.20/sql/set_sec_not_0
exec 1.20/setup/testpqr
exec 1.20/sql/sql_ba_statuses_on_mult
exec perl/RRP/SetupReq/testdef_ijk
exec perl/RRP/RRP-1.30/JEDI/SetupReq/confAbvExp
exec perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess1
exec perl/RRP/SetupReq/testdef_ijk
exec perl/RRP/RRP-1.30/JEDI/SetupReq/confAbvExp
exec perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess2
exec perl/RRP/SetupReq/testdef_ijk
exec perl/RRP/RRP-1.30/JEDI/SetupReq/confAbvExp
exec perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess3
exec 1.20/setup/testird
exec 1.20/sql/sqlmenu_purr_labl
exec 1.20/sql/est_time_at_non_drp_plc
exec 1.20/sql/half_Brd_Supply_mix_single
exec 1.20/setup/testird
exec 1.20/sql/temp/Test
exec 1.20/setup/testird
exec 1.20/sql/temp/Test2
exec perl/LRP/SetupReq/testird_LRP("LRP")
exec perl/BaseLibs/launch_client("LRP")
exec perl/LRP/LRP-classic-4.14/churrip/chorSingle
exec perl/LRP/BaseLibs/setupLRPMMMTab
exec perl/LRP/BaseLibs/launchMMM
exec perl/LRP/BaseLibs/launchLRPCHURRTA("TYRE")
#PAUSE Expand Churrip tree view & open all nodes
exec perl/LRP/LRP-classic-4.14/Corrugator/multipleSeriesWeb
exec perl/BaseLibs/ShutApp("Self Destruction System")
exec perl/LRP/BaseLibs/close-MMM
exec 1.20/setup/testmiddle
exec 1.20/sql/collective_reads
exec 1.20/setup/testinit
exec 1.20/abc/this_is_test_1
exec 1.20/abc/this_is_test_1
exec perl/LRP/SetupReq/abcDEF
exec perl/BaseLibs/launch_client("sqlC","LRP")
exec perl/LRP/LRP-perl-4.20/fireTrigger 
```

现在对于 File-1 中的每一行，我想从 File-2 中提取相关的行块。File-2 中的块定义如下

```
exec 1.20/setup/xxxxx
blah blah blah
blah blah blah
.
.
.
all lines till next setup line is found 
```

例如

```
exec 1.20/setup/testinit
exec 1.20/abc/this_is_test_1
exec 1.20/abc/this_is_test_1 
```

或者

```
exec perl/LRP/SetupReq/xxxxx
blah blah blah
blah blah blah
.
.
.
all lines till next setup line is found 
```

例如

```
exec perl/LRP/SetupReq/testird_LRP("LRP")
exec perl/BaseLibs/launch_client("LRP")
exec perl/LRP/LRP-classic-4.14/churrip/chorSingle
exec perl/LRP/BaseLibs/setupLRPMMMTab
exec perl/LRP/BaseLibs/launchMMM
exec perl/LRP/BaseLibs/launchLRPCHURRTA("TYRE")
#PAUSE Expand Churrip tree view & open all nodes
exec perl/LRP/LRP-classic-4.14/Corrugator/multipleSeriesWeb
exec perl/BaseLibs/ShutApp("Self Destruction System")
exec perl/LRP/BaseLibs/close-MMM 
```

到目前为止，我已经设法在以下脚本的帮助下从 File-2 中提取了相关块

```
Shell Script
#set -x
FLBATCHLIST=$1
BATCHFILE=$2

TEMPDIR="/usr/tmp/tempBatchDir"
rm -rf $TEMPDIR/*

WORKFILE="$TEMPDIR/failedTestList.txt"
CPBATCHFILE="$TEMPDIR/orig.test"
TESTSETFILE="$TEMPDIR/testset.txt"
TEMPFILE="$TEMPDIR/temp.txt"
DIFFFILE="$TEMPDIR/diff.txt"

#Output
FAILEDBATCH="$TEMPDIR/FailedBatch.test"
LOGFILE="$TEMPDIR/log.txt"

createBatch ()
{

TESTNAME=$1
#First process the $CPBATCHFILE to not have any blank lines, leading and trailing whitespaces
# delete BOTH leading and trailing whitespace from each line and blank lines from file
sed -i 's/^[[:space:]]*//;s/[[:space:]]*$//g;/^$/d' $CPBATCHFILE
FOUND=0
STATUS=1
while [ $STATUS -ne "0" ]
do
        if [ ! -s $CPBATCHFILE ]; then
                echo "$CPBATCHFILE is empty" >> $LOGFILE
                STATUS=0
        fi
        awk '/[Ss]etup.*[Tt]est/ || /perl\/[[:alpha:]]*\/[Ss]etup[rR]eq/{if(b) exit; else b=1}1' $CPBATCHFILE > $TESTSETFILE
        grep -i "$TESTNAME$" $TESTSETFILE >> $LOGFILE 2>&1
        if [ $? -eq "0" ]; then
                echo "test found" >> $LOGFILE
                cat $TESTSETFILE >> $FAILEDBATCH
                FOUND=1
        fi
        TSTFLLINES=`wc -l < $TESTSETFILE`
        CPBTCHLINES=`wc -l < $CPBATCHFILE`
        DIFF=`expr $CPBTCHLINES - $TSTFLLINES`
        tail -n $DIFF $CPBATCHFILE > $DIFFFILE
        mv $DIFFFILE $CPBATCHFILE
done

if [ $FOUND -eq 0 ]; then
        echo $TESTNAME > $TEMPDIR/test.txt
        ABSTEST=$(echo $TESTNAME | sed 's/\\//g')
        echo "FATAL ERROR: Test \"$ABSTEST\" not found in batch" | tee -a $LOGFILE
fi

}

####STARTS HERE####
mkdir -p $TEMPDIR
#cat  $TEMPDIR/test.txt
#FLBATCHLIST="$TEMPDIR/test.txt"
# delete run, BOTH leading and trailing whitespace and blank lines from file
sed 's/^[eE][xX][eE][cC]//g;s/^[[:space:]]*//;s/[[:space:]]*$//g;/^$/d' $FLBATCHLIST > $WORKFILE

# escaping special characters like '\' and '.' in the path names for better grepping
sed -i 's/\([\/\.\"]\)/\\\1/g' $WORKFILE

for fltest in $(cat $WORKFILE)
do
        echo $fltest >> $LOGFILE
        cp $BATCHFILE $CPBATCHFILE
        createBatch $fltest
done

sed -i 's/\//\\/g' $FAILEDBATCH
## Clean up
cp $FAILEDBATCH . 
```

这个脚本的问题是

1.  为 File-1 的每一行遍历 File-2 需要一些时间。我想知道是否有更好的解决方案，我只需要遍历 File-2 一次。

2.  该脚本确实解决了我的问题，但我留下了其中包含重复行块的文件。我想知道有没有办法删除重复的行块。

这是我执行脚本时的输出

```
exec 1.20\setup\testinit
exec 1.20\abc\this_is_test_1
exec 1.20\abc\this_is_test_1
exec perl\RRP\SetupReq\testdef_ijk
exec perl\RRP\RRP-1.30\JEDI\SetupReq\confAbvExp
exec perl\RRP\RRP-1.30\JEDI\JEDIExportSuccess2
exec perl\RRP\SetupReq\testdef_ijk
exec perl\RRP\RRP-1.30\JEDI\SetupReq\confAbvExp
exec perl\RRP\RRP-1.30\JEDI\JEDIExportSuccess1
exec perl\RRP\SetupReq\testdef_ijk
exec perl\RRP\RRP-1.30\JEDI\SetupReq\confAbvExp
exec perl\RRP\RRP-1.30\JEDI\JEDIExportSuccess2
exec perl\RRP\SetupReq\testdef_ijk
exec perl\RRP\RRP-1.30\JEDI\SetupReq\confAbvExp
exec perl\RRP\RRP-1.30\JEDI\JEDIExportSuccess3
exec perl\LRP\SetupReq\testird_LRP("LRP")
exec perl\BaseLibs\launch_client("LRP")
exec perl\LRP\LRP-classic-4.14\churrip\chorSingle
exec perl\LRP\BaseLibs\setupLRPMMMTab
exec perl\LRP\BaseLibs\launchMMM
exec perl\LRP\BaseLibs\launchLRPCHURRTA("TYRE")
#PAUSE Expand Churrip tree view & open all nodes
exec perl\LRP\LRP-classic-4.14\Corrugator\multipleSeriesWeb
exec perl\BaseLibs\ShutApp("Self Destruction System")
exec perl\LRP\BaseLibs\close-MMM
exec perl\LRP\SetupReq\testird_LRP("LRP")
exec perl\BaseLibs\launch_client("LRP")
exec perl\LRP\LRP-classic-4.14\churrip\chorSingle
exec perl\LRP\BaseLibs\setupLRPMMMTab
exec perl\LRP\BaseLibs\launchMMM
exec perl\LRP\BaseLibs\launchLRPCHURRTA("TYRE")
#PAUSE Expand Churrip tree view & open all nodes
exec perl\LRP\LRP-classic-4.14\Corrugator\multipleSeriesWeb
exec perl\BaseLibs\ShutApp("Self Destruction System")
exec perl\LRP\BaseLibs\close-MMM 
```

我尝试通过网络搜索我的答案，但找不到适合我需求的答案。

给定 File-1 和 File-2 这是我期望我的脚本输出的内容（我已经列出了我期望 FILE-1 中每一行的输出）

```
For line "1.20/abc/this_is_test_1" in FILE-1
Output
exec 1.20/setup/testinit
exec 1.20/abc/this_is_test_1
exec 1.20/abc/this_is_test_1

For line "perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess2" in FILE-1
Output
exec perl/RRP/SetupReq/testdef_ijk
exec perl/RRP/RRP-1.30/JEDI/SetupReq/confAbvExp
exec perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess2

For line "exec perl/RRP/RRP-1.30/JEDI/CommonReq/confAbvExp" in FILE-1
Output
do nothing as there is no line matching this is in FILE-2

For line "perl/LRP/BaseLibs/close-MMM" in FILE-1
Output
exec perl/LRP/SetupReq/testird_LRP("LRP")
exec perl/BaseLibs/launch_client("LRP")
exec perl/LRP/LRP-classic-4.14/churrip/chorSingle
exec perl/LRP/BaseLibs/setupLRPMMMTab
exec perl/LRP/BaseLibs/launchMMM
exec perl/LRP/BaseLibs/launchLRPCHURRTA("TYRE")
#PAUSE Expand Churrip tree view & open all nodes
exec perl/LRP/LRP-classic-4.14/Corrugator/multipleSeriesWeb
exec perl/BaseLibs/ShutApp("Self Destruction System")
exec perl/LRP/BaseLibs/close-MMM    

For line "exec perl/LRP/BaseLibs/launchLRPCHURRTA("TYRE")" in FILE-1
Output
Do nothing as it would generate the same black as line "perl/LRP/BaseLibs/close-MMM" in FILE-1 did

For Line "this/or/that" in FILE-1
Output
Do nothing as there is no line matching this is in FILE-2 
```

所以我的最终输出应该类似于（块的顺序无关紧要）

```
exec 1.20/setup/testinit
exec 1.20/abc/this_is_test_1
exec 1.20/abc/this_is_test_1

exec perl/RRP/SetupReq/testdef_ijk
exec perl/RRP/RRP-1.30/JEDI/SetupReq/confAbvExp
exec perl/RRP/RRP-1.30/JEDI/JEDIExportSuccess2

exec perl/LRP/SetupReq/testird_LRP("LRP")
exec perl/BaseLibs/launch_client("LRP")
exec perl/LRP/LRP-classic-4.14/churrip/chorSingle
exec perl/LRP/BaseLibs/setupLRPMMMTab
exec perl/LRP/BaseLibs/launchMMM
exec perl/LRP/BaseLibs/launchLRPCHURRTA("TYRE")
#PAUSE Expand Churrip tree view & open all nodes
exec perl/LRP/LRP-classic-4.14/Corrugator/multipleSeriesWeb
exec perl/BaseLibs/ShutApp("Self Destruction System")
exec perl/LRP/BaseLibs/close-MMM 
```

如果有人能给我一些关于如何进行的指示，那就太好了。是的，我忘了提，这不是作业问题:-)。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T12:36:43.763

以下假设“设置”行对于每个块都是唯一的。我们将此行用作关联数组的键，该数组跟踪我们已经打印了哪些块。

脚本的第一行将第一个文件读取到一个名为的变量中，该变量从第一个文件`regex`中收集我们想要匹配的行（成语`NR==FNR`表示当当前文件的行号等于收集的所有文件的行号时，即是，只有当我们从参数列表中读取第一个文件时才是真的）。我希望脚本的其余部分相当简单。

```
awk 'NR==FNR { gsub(/\//,"\\/"); regex = regex sep $0; sep = "|" ; next}
    /[Ss]etup/ { label = $0; printing = 0; collected = nl = "" }
    { collected = collected nl $0; nl=RS }
    $0 ~ regex { if(!printed[label]) {
        printed[label] = printing = 1; print collected } }
    printing { print }' File-1 File-2 
```

如果“设置”行不一定是唯一的，也许您可​​以使用值`collected`作为键。

这应该（我希望）对`File-1`匹配中相同块的多行具有鲁棒性`File-2`。

我知道我`sed`在评论中暗示了一个解决方案，但事实证明这是一种`awk`感觉更自然的问题。当然，它也可以用 Perl 或 Python 或您拥有的任何东西来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:36:58.983

如果行顺序无关紧要，您可以通过命令提示符以这种方式从文件中删除重复项：

```
sort filename | uniq 
```

为了找出这两个文件中存在哪些行，我使用了一个创建散列（或关联数组，如果你愿意的话）的 perl 脚本。然后我扫描文件 A，将每一行添加到哈希中，使用该行作为键，并将值设置为 1。然后我对文件 A 做了同样的事情，但将值设置为 2，如果键已经存在，我加了 2 个。结果将只遍历每个文件一次，最后我知道如果密钥的值为 1，它只存在于文件 A 中，如果它的值为 2，它只存在于文件 B 中，并且如果它的值为 3，则它存在于两者中。

**编辑：** 我在一个项目中发现了一些 perl 代码，完全按照我上面描述的方式。在这段代码中，我只关注差异，但应该很容易根据您的需要修改它

```
my %found;
foreach my $item (@qlist) { $found{$item} += 2 };
foreach my $item (@xlist) { $found{$item} += 1 };

foreach my $found (keys(%found))
{
  if    ($found{$found} == 3)
  {
    # It's in both files. Not doing anything.
  }
  elsif ($found{$found} == 2)
  {
    print "$found found in the QC-list, but not the x-list.\n";
  }
  elsif ($found{$found} == 1)
  {
    print "$found found in the x-list, but not the QC-list.\n";
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T03:57:38.930

感谢@tripleee 和@Jarmund 的建议。从您的输入中，我终于能够找出我的问题的解决方案。我从关联数组中得到了为每个块创建唯一键的提示，所以这就是我所做的

*   取 file-2 并将每个块转换为单行

    awk '/[Ss] 设置。*[Tt]测试/|| /perl/[[:alpha:]]* /[Ss]etup[Rr]eq/{if(b) 退出；否则 b=1}1' file-2 > $TESTSETFILE cat $TESTSETFILE | sed ':a;N;$!ba;s/\n//g;s/ //g' >> $SINGLELINEFILE

*   现在这个文件中的每一行都是一个唯一的条目

*   在此之后，我对 File-1 中的每一行使用 grep 并现在找到相应的块（转换为单行）
*   然后我使用 awk 或 sort -u 在我的解决方案文件中查找唯一条目

也许这个解决方案不是最好的，但它比前一个要快得多。

这是我的新脚本

```
FLBATCHLIST=$1
BATCHFILE=$2

TEMPDIR="./tempBatchdir"
rm -rf $TEMPDIR/*
WORKFILE="$TEMPDIR/failedTestList.txt"
CPBATCHFILE="$TEMPDIR/orig.test"
TESTSETFILE="$TEMPDIR/testset.txt"
DIFFFILE="$TEMPDIR/diff.txt"
SINGLELINEFILE="$TEMPDIR/singleline.txt"
TEMPFILE="$TEMPDIR/temp.txt"
#Output
FAILEDBATCH="$TEMPDIR/FailedBatch.test"
LOGFILE="$TEMPDIR/log.txt"

convertSingleLine ()
{
sed -i 's/^[[:space:]]*//;s/[[:space:]]*$//g;/^$/d' $CPBATCHFILE
STATUS=1
while [ $STATUS -ne "0" ]
do
        if [ ! -s $CPBATCHFILE ]; then
                echo "$CPBATCHFILE is empty" >> $LOGFILE
                STATUS=0
        fi
        awk '/[Ss]etup.*[Tt]est/ || /perl\/[[:alpha:]]*\/[Ss]etup[Rr]eq/{if(b) exit; else b=1}1' $CPBATCHFILE > $TESTSETFILE
        cat $TESTSETFILE | sed ':a;N;$!ba;s/\n//g;s/ //g' >> $SINGLELINEFILE
        echo "**" >> $SINGLELINEFILE
        TSTFLLINES=`wc -l < $TESTSETFILE`
        CPBTCHLINES=`wc -l < $CPBATCHFILE`
        DIFF=`expr $CPBTCHLINES - $TSTFLLINES`
        tail -n $DIFF $CPBATCHFILE > $DIFFFILE
        mv $DIFFFILE $CPBATCHFILE
done
}

####STARTS HERE####
mkdir -p $TEMPDIR

sed 's/^[eE][xX][eE][cC]//g;s/^[[:space:]]*//;s/[[:space:]]*$//g;/^$/d' $FLBATCHLIST > $WORKFILE
sed -i 's/\([\/\.\"]\)/\\\1/g' $WORKFILE

cp $BATCHFILE $CPBATCHFILE
convertSingleLine

for fltest in $(cat $WORKFILE)
do
        echo $fltest >> $LOGFILE
        grep "$fltest" $SINGLELINEFILE >> $FAILEDBATCH
        if [ $? -eq "0" ]; then
                echo "TEST FOUND" >> $LOGFILE
        else
                ABSTEST=$(echo $fltest | sed 's/\\//g')
                echo "FATAL ERROR: Test \"$ABSTEST\" not found in $BATCHFILE" | tee -a $LOGFILE
        fi
done

awk '!x[$0]++' $FAILEDBATCH > $TEMPFILE
mv $TEMPFILE $FAILEDBATCH

sed -i "s/exec/\\nexec /g;s/#/\\n#/g" $FAILEDBATCH
sed -i '1d;s/\//\\/g' $FAILEDBATCH 
```

这是输出

```
$ crflbatch file-1 file-2
FATAL ERROR: Test "perl/RRP/RRP-1.30/JEDI/CommonReq/confAbvExp" not found in file-2
FATAL ERROR: Test "this/or/that" not found in file-2

$ cat tempBatchdir/FailedBatch.test
exec 1.20\setup\testinit
exec 1.20\abc\this_is_test_1
exec 1.20\abc\this_is_test_1

exec perl\RRP\SetupReq\testdef_ijk
exec perl\RRP\RRP-1.30\JEDI\SetupReq\confAbvExp
exec perl\RRP\RRP-1.30\JEDI\JEDIExportSuccess2

exec perl\LRP\SetupReq\testird_LRP("LRP")
exec perl\BaseLibs\launch_client("LRP")
exec perl\LRP\LRP-classic-4.14\churrip\chorSingle
exec perl\LRP\BaseLibs\setupLRPMMMTab
exec perl\LRP\BaseLibs\launchMMM
exec perl\LRP\BaseLibs\launchLRPCHURRTA("TYRE")
#PAUSEExpandChurriptreeview&openallnodes
exec perl\LRP\LRP-classic-4.14\Corrugator\multipleSeriesWeb
exec perl\BaseLibs\ShutApp("SelfDestructionSystem")
exec perl\LRP\BaseLibs\close-MMM
$ 
```

# ios - 是否可以将具有重复键的值添加到 NSDictionary？

> ID：13713034
> 
> 赞同：0
> 
> 时间：2012-12-04T22:24:29.857
> 
> 标签：ios, nsmutablearray, nsmutabledictionary

我有这样的事情：

```
@interface Person : NSObject
{
  NSString *fname;
  NSString *lname;
}

NSString *keys = @"a","a","b","b","b"....";
for(NSString *key in keys)
{
    Person *newPerson; //alloc new person
    [myMutableDictionary setValue:newPerson forKey:key];
} 
```

上面的代码将使用相同的键覆盖值，因为 NSDictionary 不允许重复键。我怎样才能做到这一点？我可以通过 NSMutableArray 完成上述代码，如 [array addObject:newPerson]; 但是与 NSDictionary 相比，获取 (Key,value) 需要更长的时间？我的数据大约是 400,000 项，关于如何有效地做到这一点的任何想法？我需要加载一次并对其进行多次提取 - 没有 coreData，我试过了，它很慢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T22:31:18.747

如果您使用 an`NSMutableArray`作为键，您可以`Person`为同一个键添加多个对象。

```
NSString *keys = @"a","a","b","b","b", ...;
for(NSString *key in keys)
{
    Person *newPerson; //alloc new person
    NSMutableArray *people;
    if(!(people = [myMutableDictionary objectForKey:key]))
    {
        people = [NSMutableArray array];
        [myMutableDictionary setValue:people forKey:key];
    }

    [people addObject:newPerson];
} 
```

# asp.net-mvc - 添加到控制器内的集合时出现 NullReferenceException

> ID：13713042
> 
> 赞同：0
> 
> 时间：2012-12-04T22:25:04.133
> 
> 标签：asp.net-mvc

```
[HttpPost]
public ActionResult Create(Playlist playlist)
{
    if (ModelState.IsValid)
    {
        if (Session["Playlist"] != null)
        {
            List<int> musicIds = new List<int>();
            musicIds = Session["Playlist"] as List<int>;
            if (musicIds.Count > 0)
            {
                UserProfileRepository UserProfileRepository = new UserProfileRepository(db);
                string Name = this.User.Identity.Name;
                UserProfile User = UserProfileRepository.getModelByName(Name);
                playlist.UserId = User.UserId;

                db.Playlists.Add(playlist);
                db.SaveChanges();

                foreach (var item in musicIds)
                {
                    Music music = db.Musics.Find(item);
                    /*
                     * Error in the line below, it says: 
                     *  Object reference not set to an instance of an object. 
                     * */
                    playlist.Musics.Add(music);
                }

                db.SaveChanges();
                return RedirectToAction("Index");
            }
        }
    }

    return View(playlist);
} 
```

大家好，有人能告诉我的代码有什么问题吗？我似乎无法弄清楚为什么它说“对象引用未设置为对象的实例。”当播放列表和音乐都被实例化时。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:27:46.663

那意味着那`playlist.Musics`是空的。
您应该在构造函数中对其进行初始化。

# continuous-integration - TeamCity 自解压 zip 作为工件

> ID：13713047
> 
> 赞同：1
> 
> 时间：2012-12-04T22:25:24.620
> 
> 标签：continuous-integration, teamcity, winzip

是否可以让 teamcity 生成一个自解压的 zip 文件作为构建的工件？

我可以创建一个调用 winzip 和 winzip 自解压器的构建步骤，还是可以以某种方式创建一个链接构建来为我执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:33:58.493

是的。构建步骤可以运行任何命令行功能，包括脚本和程序。根据创建存档所涉及的程度，您可能需要编写一个简单的 shell 脚本（或批处理，视情况而定）来复制文件、创建 SFX 存档，然后将其复制到已知位置。然后，在 Teamcity 的工件过滤器中，将存档添加为工件，它将与构建一起发布。

您还可以调整构建步骤以仅在其余构建成功后创建存档，或为存档脚本提供参数（或让脚本通知 Teamcity，查看消息传递文档以了解如何处理）。

# c# - 使用 MongoDB、文本文件和 SQL 服务器进行性能测试的结果应该如下所示吗？（文本文件更快）

> ID：13713049
> 
> 赞同：0
> 
> 时间：2012-12-04T22:25:29.703
> 
> 标签：c#, performance, sql-server-2008, mongodb

我有大约 236000 个单词的完整词典。

我将文本文件中的所有单词插入到 SQL 服务器 DB 和 MongoDb 中，确保在单词字段上的两个 DB 上都有索引。

我遍历所有 mongo 文档，将每个单词插入 C# 中的 Dictionary 需要 2.5 秒。有时略少有时略多。

我循环遍历文本文件中的所有单词，将它们插入到 C# 中的字典中，这需要 0.9 秒。有时略少有时略多。

我遍历 SQL DB 中的所有单词，将单词插入 C# 中的 Dictionary 需要 1.1 秒。有时略少有时略多。

MongoDB应该更快吗？

MongoDB：

```
var connectionString = "mongodb://localhost";
            var client = new MongoClient(connectionString);
            var server = client.GetServer();
            var database = server.GetDatabase("test");
            var collection = database.GetCollection<Entity>("entities");

            var cursor = collection.FindAll();

            foreach (Entity book in cursor)
            {
                string name = book.Name;
                string a = Alphabetize(name);
                string value;
                if (dictionary.TryGetValue(a, out value))//http://www.dotnetperls.com/anagram
                {
                    dictionary[a] = value + " " + name;
                }
                else
                {

                    dictionary.Add(a, name);

                }
            } 
```

忽略它说“书”和“名字”的事实，我还没有改变它们。

SQL 服务器：

```
 connection.ConnectionString = ConnectionStrings.connectionString1;
            using (connection)
            using (SqlCommand command = new SqlCommand())
            {
                command.Connection = connection;
                command.CommandText = "SELECT Word FROM Dictionary";
                if (connection.State != ConnectionState.Open) connection.Open();
                using (SqlDataReader sqlReader = command.ExecuteReader())
                {
                    while (sqlReader.Read())
                    {
                        string line = sqlReader.GetString(0);

                        // Alphabetize the line for the key
                        // Then add to the value string
                        string a = Alphabetize(line);
                        string value;
                        if (dictionary.TryGetValue(a, out value))//http://www.dotnetperls.com/anagram
                        {
                            dictionary[a] = value + " " + line;
                        }
                        else
                        {

                            dictionary.Add(a, line);

                        }

                    } 
```

} }

每次 SQL 服务器的执行速度都比 MongoDB 快，而文本文件方法的执行速度比两者都快。

然而，我确实注意到，对于 mongo，所有单词的插入都更快，但这不是我想要做的。

有没有更快的方法来循环遍历 mongo 中的集合？

查询特定单词的文本文件显然要慢得多，但 mongo 和 SQL 的性能差异并不太显着。0.0450026-ish 使用 mongo。使用 SQl 服务器通常更快 0.0480027-ish

我应该用这个 mongo 循环做一些不同的事情吗？它比 SQL 服务器慢 2 倍以上...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T09:11:30.830

SQL Server 和 MongoDB 都需要设置与客户端的网络连接、执行查询和序列化/反序列化结果。如果您不使用任何索引或执行更复杂的查询，这总是比从普通文件中读取要慢。对于数据库来说，它也是一个毫无意义的用例。对于 MongoDB，性能更差，因为它是一个无模式的数据库，它需要在结果中动态创建记录，而不是遵循固定的表模式。

# c# - 管理 DDD 中的持久性

> ID：13713060
> 
> 赞同：3
> 
> 时间：2012-12-04T22:26:21.500
> 
> 标签：c#, .net, architecture, domain-driven-design, persistence

假设我想创建一个博客应用程序，其中包含这两个与 EF Code First 或 NHibernate 一起使用并从存储库层返回的简单持久性类：

```
public class PostPersistence
{
   public int Id { get; set; }
   public string Text { get; set; }
   public IList<LikePersistence> Likes { get; set; }
}

public class LikePersistence
{
    public int Id { get; set; }
    //... some other properties
} 
```

我想不出一种将持久性模型映射到域模型的干净方法。我希望我的`Post`域模型界面看起来像这样：

```
public interface IPost
{
   int Id { get; }
   string Text { get; set; }
   public IEnumerable<ILike> Likes { get; }
   void Like();
} 
```

现在下面的实现会是什么样子？也许是这样的：

```
public class Post : IPost
{
   private readonly PostPersistence _postPersistence;
   private readonly INotificationService _notificationService;

   public int Id 
   { 
       get { return _postPersistence.Id }
   }

   public string Text 
   { 
       get { return _postPersistence.Text; }
       set { _postPersistence.Text = value; }
   }

   public IEnumerable<ILike> Likes
   {
       //this seems really out of place
       return _postPersistence.Likes.Select(likePersistence => new Like(likePersistence ));
   }

   public Post(PostPersistence postPersistence, INotificationService notificationService)
   {
       _postPersistence = postPersistence;
       _notificationService = notificationService;
   }

   public void Like()
   {
       _postPersistence.Likes.Add(new LikePersistence());
       _notificationService.NotifyPostLiked(Id);
   }
} 
```

我花了一些时间阅读有关 DDD 的内容，但大多数示例都是理论上的或在域层中使用了相同的 ORM 类。我的解决方案似乎真的很丑，因为实际上域模型只是 ORM 类的包装器，它似乎不是以域为中心的方法。实现方式`IEnumerable<ILike> Likes`也让我感到困扰，因为它不会从 LINQ to SQL 中受益。有哪些其他（具体的！）选项可以创建具有更透明持久性实现的域对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:06:40.783

DDD 中持久化的目标之一是[持久化无知](http://gorodinski.com/blog/2012/08/10/toward-persistence-ignorance-with-nhibernate-in-domain-driven-design/)在某种程度上，这似乎是您正在努力的目标。我在您的代码示例中看到的问题之一是您的实体实现了接口并引用了存储库和服务。在 DDD 中，实体不应该实现只是自身抽象并且对存储库或服务具有实例依赖关系的接口。如果实体上的特定行为需要服务，则将该服务直接传递给相应的方法。否则，与服务和存储库的所有交互都应在实体之外完成；通常在应用程序服务中。应用程序服务在存储库和服务之间进行协调，以便调用域实体上的行为。结果，实体不' 不需要直接引用服务或存储库——它们所拥有的只是一些修改该状态并保持其完整性的状态和行为。然后，ORM 的工作就是将此状态映射到关系数据库中的表。诸如 NHibernate 之类的 ORM 允许您获得相对较大程度的[执着无知](http://gorodinski.com/blog/2012/08/10/toward-persistence-ignorance-with-nhibernate-in-domain-driven-design/)。

**更新**

> 我仍然不想公开带有 INotificationService 作为参数的方法，因为这个服务应该是内部的，上面的层不需要知道它。

在您当前的类实现中，与`Post`类`INotificationService`具有相同或更高的可见性。如果`INotificationService`在基础设施层中实现，则它必须具有足够的可见性。查看[六边形架构](http://alistair.cockburn.us/Hexagonal+architecture)，了解现代架构中的分层概述。

作为旁注，与通知相关的功能通常可以放入[域事件](http://lostechies.com/jimmybogard/2010/04/08/strengthening-your-domain-domain-events/)的处理程序中。这是实现高度解耦的强大技术。

> 当域对象不知道其底层 DTO 时，如果使用单独的 DTO 和域类，您将如何解决持久性同步问题？如何跟踪变化？

DTO 和相应的域类存在的原因非常不同。DTO 的目的是跨系统边界传送数据。DTO 与域对象不是一一对应的——它们可以表示域对象的一部分或对域对象的更改。跟踪更改的一种方法是让 DTO 明确其包含的更改。例如，假设您有一个允许编辑`Post`. 该屏幕可以捕获所做的所有更改，并将这些更改以命令 (DTO) 的形式发送到服务。该服务将加载适当的`Post`实体并应用命令指定的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T02:04:59.920

我认为您需要进行更多研究，查看所有选项并确定是否真的值得为完整的 DDD 实施而烦恼，过去几天我自己也去过那里，所以我会告诉你我的经验。

EF Code first 很有希望，但它也有很多问题，我在这里有一个关于这个 [实体框架和领域驱动设计](https://stackoverflow.com/questions/13688750/entity-framework-and-domain-driven-design/13712316#13712316)的条目。使用 EF，您的域模型可以由 EF 持久化，而无需创建单独的“持久性”类。您可以使用 POCO（普通旧对象）并启动并运行一个简单的应用程序，但正如我对我所说，它还没有完全成熟。

如果您使用 LINQ to SQL，那么最常见的方法是将“数据传输对象”手动映射到业务对象。对于大型应用程序而言，手动执行此操作可能会很困难，因此请检查 Automapper 之类的工具。或者，您可以简单地将 DTO 包装在一个业务对象中，例如

```
 public class Post
   {
      PostPersistence Post { get; set;}
      public IList<LikePersistence> Likes { get; set; }
       .....
   } 
```

NHibernate：不确定，好久没用了。

我对此的感觉（这只是一个观点，我可能是错的）是你总是不得不做出妥协，你不会在那里找到完美的解决方案。如果你再给 EF 几年，它可能会到达那里。我认为将 DTO 映射到 DDD 对象的方法可能是最灵活的，因此寻找自动映射工具可能值得您花时间。如果你想保持简单，我最喜欢的是在需要时围绕 DTO 的一些简单包装器。

# ruby-on-rails - Ruby on Rails 中视图中对象之间的区别

> ID：13713061
> 
> 赞同：1
> 
> 时间：2012-12-04T22:26:24.460
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json

`show.html.erb`有人知道Rails中初始对象和 对象之间的区别`index.html.erb`吗？我问的原因是因为我正在使用 javascript 库 d3.js，为此我需要一个 json 对象。总之`index.html.erb`，我可以通过调用来创建它们：
`<% @commits.to_json %>`但是如果我尝试在任何`show.html.erb`浏览器中使用该语句，浏览器会告诉我结果只是一个对象（似乎不是 json），所以我以后不能调用`forEach`（我需要打电话）。

提前致谢！

好的，为了更好地理解，我附加了更多代码：

```
<%= javascript_tag do %>

d3.json('<% @commit.jobs.to_json %>', 
            function(data){

      var margin = {top: 20, right: 80, bottom: 30, left: 50},
          width = 960 - margin.left - margin.right,
          height = 500 - margin.top - margin.bottom;

      var format = d3.time.format("%Y-%m-%dT%H:%M:%SZ");

      //parse time format correct
      data.forEach(function(d) {
          console.log(d.finished_at);
          d.finished_at = format.parse(d.finished_at);
          console.log(d.finished_at);
        });

   //more code!     

<% end %> 
```

问题是，我有一个提交对象，`show.html.erb`其中有所属的工作，现在我想用`d3.js`. 我测试了这是否：`@commit.jobs.to_json`创建了一个有效的 json 并且确实如此！但是控制台抛出错误：`Uncaught TypeError: Object #<Object> has no method 'forEach'`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T22:31:25.853

在表演中，您通常只有一个`@commit`要展示的。

在索引中，您通常将 all`@commits`作为对象数组。

```
def index
   @commits = Commit.all # all
end

def show
   @commit = Commit.find(params[:id]) # only one
end 
```

`show.html.erb`如果你想要do中的所有提交`<%= Commit.all.to_json %>`

因此，根据它们所在的视图，对象之间在技术上没有区别。它们只是根据调用视图之前在方法中的初始化方式表示不同的 ( `@commit`, ) 事物。`@commits`

# c - 如何在 stm32f107 芯片上禁用/启用中断？

> ID：13713064
> 
> 赞同：1
> 
> 时间：2012-12-04T22:26:40.730
> 
> 标签：c, gcc, assembly, embedded, iar

我有一个 ARM stm32f107 芯片。我正在将一个项目从 IAR 移植到 GCC

IAR 提供以下函数来启用和禁用中断：

```
#define __disable_interrupt() ...
#define __enable_interrupt() ... 
```

如何使用 GCC 为我的芯片启用/禁用中断？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T18:43:39.967

在为 STM32 开发时，[RM0008](http://www.st.com/internet/com/TECHNICAL_RESOURCES/TECHNICAL_LITERATURE/REFERENCE_MANUAL/CD00171190.pdf)是您最好的朋友。从第 199 页的第 10.2.4 节：

> 要产生中断，应配置并启用中断线。这是通过使用所需的边沿检测对两个触发寄存器进行编程并通过将“1”写入中断屏蔽寄存器中的相应位来启用中断请求来完成的。

所以你需要在适当的寄存器中设置适当的屏蔽位。对于外部中断，即 EXTI_IMR 和 EXTI_EMR 寄存器。还有很多其他的。

![EXTI 寄存器](../Images/85e12a8170ac05681619078cdbc8b41a.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T10:02:22.873

我无法回答 ARM，但 Coldfire 中的相同功能归结为设置/清除 CPU 中的中断优先级屏蔽寄存器。将其设置为最高数字会禁用/忽略除不可屏蔽之外的所有内容，将其设置为 0 会启用所有 (YMMV)。

值得注意的是，在“禁用”时回读值并在“启用”时恢复以确保堆栈中断不会相互中断，这很方便：

```
ipl = DisableInts(); // Remember what the IPL was
<"Risky" code happens here>
EnableInts(ipl); // Restore value 
```

这在玩弄中断掩码时很有用，这可能会导致虚假中断，或者做不应该被中断的事情。

功能如下：

```
uint8 DisableInts(void)
{
    return(asm_set_ipl(7));
}

uint8 EnableInts(uint8 ipl)
{
    return(asm_set_ipl(ipl));
} 
```

两者都映射到这个 asm：

```
asm_set_ipl:
_asm_set_ipl:
/* Modified for CW7.2! */
    link    A6,#-8
    movem.l D6-D7,(SP)

    move.l  D0,D6           /* save argument                 */

    move.w  SR,D7           /* current sr                    */

    move.l  D7,D0           /* prepare return value          */
    andi.l  #0x0700,D0      /* mask out IPL                  */
    lsr.l   #8,D0           /* IPL                           */

    andi.l  #0x07,D6        /* least significant three bits  */
    lsl.l   #8,D6           /* move over to make mask        */

    andi.l  #0x0000F8FF,D7  /* zero out current IPL          */
    or.l    D6,D7           /* place new IPL in sr           */
    move.w  D7,SR

    movem.l (SP),D6-D7
    //lea     8(SP),SP
    unlk    A6
    rts 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-02T16:57:23.287

[ARM 文档](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dai0321a/BIHBFEIB.html)说编译为“ `_enable_irq();`CPSIE I”，意思是清除所有掩码。另一方面`_disable_irq();`编译为设置掩码。

# xml - 我的清单是否缺少 Windows Market 发布的任何内容

> ID：13713065
> 
> 赞同：0
> 
> 时间：2012-12-04T22:26:42.373
> 
> 标签：xml, windows-phone-7, publishing

我的清单是否缺少 Windows Market 发布的任何内容？

* * *

```
 <?xml version="1.0" encoding="utf-8"?>
    <Deployment xmlns="http://schemas.microsoft.com/windowsphone/2009/deployment" AppPlatformVersion="7.1">
      <App xmlns="" ProductID="{fdfc7d73-10e1-49ce-8961-81728d0983b2}" Title="Car News RSS" RuntimeType="Silverlight" Version="1.0.0.0" Genre="apps.normal"  Author="Robert Kilar" Description="RSS Client which provides latest news from the motorworld." Publisher="Robert Kilar">
        <IconPath IsRelative="true" IsResource="false">ApplicationIcon.png</IconPath>
        <Capabilities>
          <Capability Name="ID_CAP_GAMERSERVICES"/>
          <Capability Name="ID_CAP_IDENTITY_DEVICE"/>
          <Capability Name="ID_CAP_IDENTITY_USER"/>
          <Capability Name="ID_CAP_LOCATION"/>
          <Capability Name="ID_CAP_MEDIALIB"/>
          <Capability Name="ID_CAP_MICROPHONE"/>
          <Capability Name="ID_CAP_NETWORKING"/>
          <Capability Name="ID_CAP_PHONEDIALER"/>
          <Capability Name="ID_CAP_PUSH_NOTIFICATION"/>
          <Capability Name="ID_CAP_SENSORS"/>
          <Capability Name="ID_CAP_WEBBROWSERCOMPONENT"/>
          <Capability Name="ID_CAP_ISV_CAMERA"/>
          <Capability Name="ID_CAP_CONTACTS"/>
          <Capability Name="ID_CAP_APPOINTMENTS"/>
        </Capabilities>
        <Tasks>
          <DefaultTask  Name ="_default" NavigationPage="MainPage.xaml"/>
        </Tasks>
        <Tokens>
          <PrimaryToken TokenID="RSSToken" TaskName="_default">
            <TemplateType5>
              <BackgroundImageURI IsRelative="true" IsResource="false">Background.png</BackgroundImageURI>
              <Count>0</Count>
              <Title>RSS car</Title>
            </TemplateType5>
          </PrimaryToken>
        </Tokens>
      </App>
    </Deployment> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:37:22.790

因为我确定您不想为您钓鱼，而是想学习如何处理自己的鱼竿和渔线轮：

微软发布[这些](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff769509%28v=vs.105%29.aspx)针对 Windows 市场发布应用程序的建议

[本指南](http://www.windowsphonegeek.com/tips/5-tips-for-a-successful-wp7-marketplace-submission)可能有些过时，但提供了非常方便的一般信息。

最后，[这份](http://solutions.developer.com/ms/mobile/submissions-and-marketplace/the-windows-8-store-certification-process-for-windows-phone-developers.html)在 Windows 市场中发布应用程序的指南有一些非常中肯的建议。

# android-mapview - 添加大量标记时，Google Maps Android API v2 非常慢

> ID：13713066
> 
> 赞同：32
> 
> 时间：2012-12-04T22:26:46.960
> 
> 标签：android-mapview, google-maps-android-api-2

我正在更新现有的 Android 应用程序以使用新的 Google Maps Android API v2。我有大约 2500 个标记要添加到地图中。在旧版本的 API 中，当有 2500 个标记时，我发现地图的响应能力非常糟糕，因此我不得不通过仅添加地图当前可见区域中的标记来解决这个问题。

我希望使用新 API 可以更快地处理 2500 个标记，但它仍然很糟糕，即使在 Nexus 4 上也是如此，而且我没有看到任何类型的集群选项。

所以我的问题是：如何确定某个纬度/经度点是否包含在地图的可见区域内？

我在文档中查看了[VisibleRegion](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/VisibleRegion)，但到目前为止我还没有运气。任何帮助是极大的赞赏。

*旁注：即使使用 iPhone 3gs，iOS MKMapView（谷歌地图或苹果地图）上的 2500 个标记也非常流畅且响应迅速。即使使用最新最好的硬件，我仍然无法理解为什么它在 Android 上这么慢。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-04T22:45:55.593

好吧，在尝试了更多的事情之后，我想出了如何确定给定点是否在可见区域中，这很简单：

```
//Note: this.mMap is an instance of GoogleMap

LatLngBounds bounds = this.mMap.getProjection().getVisibleRegion().latLngBounds;

LatLng markerPoint = new LatLng(item.getLatitude(), item.getLongitude());

if(bounds.contains(markerPoint))
{
    this.mMap.addMarker(new MarkerOptions(...));    
} 
```

*请注意，获取 GoogleMap 的投影是一项昂贵的操作，因此，如果您要遍历一长串项目以创建标记并将它们添加到地图中，就像我一样，在循环之前只抓取一次投影。

**更新**

我决定写一篇博文，详细说明如何显示地图可见区域中的标记并在标记移出屏幕时隐藏它们。这不是一个完美的解决方案，但如果您要显示数千个标记并且知道您的用户不需要同时查看所有标记（除非他们缩小），那么这是一个很好的解决方法。

[使用 Google Maps Android API V2 隐藏和显示屏幕标记](http://discgolfsoftware.wordpress.com/2012/12/06/hiding-and-showing-on-screen-markers-with-google-maps-android-api-v2/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-18T19:37:30.873

对于 Android 上的集群解决方案，您可能想尝试 Android Maps Extensions： [https ://github.com/mg6maciej/android-maps-extensions](https://github.com/mg6maciej/android-maps-extensions)

# c# - 使用递归将控件加载到表单中

> ID：13713070
> 
> 赞同：0
> 
> 时间：2012-12-04T22:27:09.923
> 
> 标签：c#, winforms

我有一个使用递归从 XML 生成控件的过程。系统很复杂。我已经尽可能小了。最后一个插件是可见的，其余的不可见。我怀疑`GenerateControls()`是坏了。为什么不显示所有插件？

形式：

```
public partial class PdLoadingForm : Form
{        
    public PdLoadingForm()
    {
        InitializeComponent();

        PhysDocDocument document = MockDocument();//Generate some mock data
        GenerateControls(document.Nodes);//Generate controls using recursion.
    }

    private PhysDocDocument MockDocument()
    {
        PhysDocDocument document = new PhysDocDocument();
        PhysDocNode outerNode = new PhysDocNode();
        outerNode.Display = "outer Node";

        //Generate 3 plugins.  Each plugin generates a textbox.  I only see 1 Textbox.
        //I expect to see 3 textboxes.
        for(int i = 0; i < 3; i++)
        {
            PhysDocNode innerNode = new PhysDocNode() { Display = "test" + i };

            PhysDocNode innerNodeContent = new PhysDocNode() { Display = "IO" };
            innerNodeContent.Plugins.Add(new Plugin());

            innerNode.Nodes.Add(innerNodeContent);
            outerNode.Nodes.Add(innerNode);
        }

        document.Nodes.Add(outerNode);

        return document;

    }

    private void GenerateControls(List<PhysDocNode> children, CustomControl parent = null)
    {
        foreach (PhysDocNode node in children)
        {
            CustomControl parentControl = new CustomControl(node);                

            if (node.Nodes != null && node.Nodes.Count > 0)
                GenerateControls(children: node.Nodes, parent: parentControl);

            foreach (Plugin plugin in node.Plugins)
            {  
                Control childControl = plugin.CreateUIControl();//Ask the plugin for a control
                AddControl(childControl: childControl, parent: parentControl);
            }

            AddControl(childControl: parentControl, parent: parent);
        }
    }

    private void AddControl(Control childControl, Control parent)
    {
        childControl.Dock = DockStyle.Top;

        if(parent == null)//add to form
            Controls.Add(childControl);
        else//add to parent
            parent.Controls.Add(childControl);
    }
} 
```

插入：

```
public class Plugin
{
    [XmlAttribute]
    public string type { get; set; }

    public Control CreateUIControl()
    {
        TextBox testBox = new TextBox();
        testBox.Text = "plugin";

        return testBox;
    }
} 
```

自定义控件：

```
public class CustomControl: UserControl
{    
    public CustomControl(PhysDocNode nodeInfo)
    {
        InitializeComponent();
        Label label = new Label();
        label.Text = "Rtb..." + nodeInfo.Display;
        label.Dock = DockStyle.Top;
        contentPanel.Controls.Add(label);//just drop a panel on the user control in design view
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:30:28.953

查看文档，似乎[Dock 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx)管理标签相对于其父级的定位。

例如，您可以尝试通过将其[Top 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.top.aspx)的值设置为控件列表中其索引的倍数来指定标签位置。

# django - 在 django 模板中获取用户信息

> ID：13713077
> 
> 赞同：62
> 
> 时间：2012-12-04T22:27:35.120
> 
> 标签：django, django-authentication, django-registration

从 django 模板获取用户信息的最佳方法是什么？

例如，如果我只想：

1.  如果用户已登录，则显示“欢迎 [用户名]”
2.  否则，显示登录按钮。

我正在使用 django-registration/authentication

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2014-04-06T09:32:11.030

当前 Django 版本的另一种方法：

```
{% if user.is_authenticated %}
    <p>Welcome, {{ user.get_username }}. Thanks for logging in.</p>
{% else %}
    <p>Welcome, new user. Please log in.</p>
{% endif %} 
```

笔记：

*   `request.user.get_username()`在视图和`user.get_username`模板中使用。优先于`username`直接引用属性。[来源](https://docs.djangoproject.com/en/dev/ref/contrib/auth/#django.contrib.auth.models.User.get_username)
*   如果使用 RequestContext，则此模板上下文变量可用。
*   `django.contrib.auth.context_processors.auth`默认启用并包含变量用户
*   您不需要启用`django.core.context_processors.request`模板上下文处理器。

来源：[https ://docs.djangoproject.com/en/dev/topics/auth/default/#authentication-data-in-templates](https://docs.djangoproject.com/en/dev/topics/auth/default/#authentication-data-in-templates)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-12-04T22:34:45.447

```
{% if request.user.is_authenticated %}Welcome '{{ request.user.username }}'
{% else %}<a href="{% url django.contrib.auth.login %}">Login</a>{% endif %} 
```

并确保您的`request`模板上下文处理器安装在您的`settings.py`：

```
TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    'django.core.context_processors.request',
    ...
) 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2018-04-16T16:34:33.380

根据问题标题，以下内容可能对某人很方便。在我的模板中使用了以下内容：

**用户名**：`{{ user.username }}`

**用户全名**：`{{ user.get_full_name }}`

**用户组**：`{{ user.groups.all.0 }}`

**电子邮件**：`{{ user.email }}`

**会话开始于**：`{{ user.last_login }}`

谢谢 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-22T03:42:57.823

首先，首先，如果您的字段更改了名称，您必须以这种方式覆盖函数（get_full_name()、get_short_name() 等）：

```
def get_full_name(self):
    return self.names + ' ' + self.lastnames

def get_short_name(self):
    return self.names 
```

在模板中，你可以这样显示

```
{% if user.is_authenticated %}
<strong>{{ user.get_short_name }}</strong>
{% endif %} 
```

这些是身份验证中的方法[https://docs.djangoproject.com/es/2.1/topics/auth/customizing/](https://docs.djangoproject.com/es/2.1/topics/auth/customizing/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-12T16:14:59.873

以下是一个完整的工作解决方案，它也考虑了翻译：

`template.html`：

```
{% blocktrans %}Welcome {{ USER_NAME }}!{% endblocktrans %} 
```

`context_processors.py`：

```
def template_constants(request):
    return {
        'USER_NAME': '' if request.user.is_anonymous else request.user.first_name,
        # other values here...
    } 
```

提醒在以下位置正确设置您的自定义 context_processors `settings.py`：

```
TEMPLATES = [
    {
        # ...
        'OPTIONS': {
            'context_processors': [
                # ...
                'your_app.context_processors.template_constants',
            ],
        },
    },
] 
```

这就是你得到的`django.po`：

```
#: templates/home.html:11
#, python-format
msgid "Hi %(USER_NAME)s!"
msgstr "..." 
```

一个好的做法是将逻辑保留在模板之外：为此，您可以轻松自定义直接在`context_processors.py`.

# python - 解释（并使用）Fabric 本地命令的输出

> ID：13713085
> 
> 赞同：6
> 
> 时间：2012-12-04T22:28:09.733
> 
> 标签：python, fabric

我想使用 Fabric 命令来设置本地开发环境，作为其中的一部分，我希望能够设置 git 远程。这工作正常：

```
from fabric.api import local

def set_remote():
    """ Set up git remote for pushing to dev."""
    local('git remote add myremote git@myremote.com:myrepo.git') 
```

第二次运行时会出现问题 - 当本地命令因为远程已经存在而爆炸时。我想通过首先检查遥控器是否存在来防止这种情况：

在伪代码中，我想做以下事情：

```
if 'myremote' in local('git remote'):
    print 'Remote \'myremote\' already exists.'
else:
    local('git remote add myremote git@myremote.com:myrepo.git') 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-04T22:32:37.550

您可以使用[`settings`](http://docs.fabfile.org/en/1.5/api/core/context_managers.html#fabric.context_managers.settings)上下文管理器`warn_only`：

```
from fabric.context_managers import settings

with settings(warn_only=True):
    # some command we are all right with having fail 
```

或者，您可以将命令`capture`上的关键字 arg设置为：[`local`](http://docs.fabfile.org/en/1.5/api/core/operations.html#fabric.operations.local)`True`

```
if 'myremote' in local('git remote', capture=True):
    print 'Remote \'myremote\' already exists.'
else:
    local('git remote add myremote git@myremote.com:myrepo.git') 
```

# c# - 如何从 DoubleClick 事件处理程序中的 DevExpress GridControl 获取点？

> ID：13713087
> 
> 赞同：0
> 
> 时间：2012-12-04T22:28:19.503
> 
> 标签：c#, parameters, casting, devexpress

我正在使用`DevExpress.XtraGrid.GridControl`c# 中的 a 和双击事件。事件处理程序签名接受一个对象和 EventArgs 作为它的参数：

```
 private void gvHL7_DoubleClick(object sender, EventArgs e){
     .
     .
     .
  } 
```

但是，我想使用 .Point 属性，而 EventArgs 没有该属性。我知道 DevExpress.XtraGrid.Views.Grid.GridMenuEventArgs 确实如此，但它说这是一个无效的转换。如果我想访问 .Point 属性，我应该将 EventArgs 实例转换为什么类型？

编辑：我正在使用的双击功能是由 devexpress 为他们的网格提供的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:41:53.780

[请参阅DevExpress 支持站点](http://www.devexpress.com/Support/Center/KB/p/A2934.aspx)中的此示例。您需要强制`sender`转换才能获得`Point`.

```
private void gridView1_DoubleClick(object sender, EventArgs e)
{
    GridView view = (GridView)sender;    
    Point pt = view.GridControl.PointToClient(Control.MousePosition);    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:37:05.957

C# 中的[`DoubleClick`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.doubleclick.aspx)事件仅告诉您发生了双击。如果您需要鼠标坐标，则需要捕获[`MouseClick`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseclick.aspx)事件或使用[`MousePosition`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseposition.aspx)引发事件的控件的属性（在这种情况下，`gvHL7.MousePosition`很可能）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:47:08.447

我解决了这个问题，但无法获得点属性。相反，我将 EventArgs 转换为 MouseEventArgs 并通过 .X 和 .Y 属性将坐标传递给函数。

# msbuild - 在 MSBuild 中为数据库项目使用 PublishProfile

> ID：13713093
> 
> 赞同：5
> 
> 时间：2012-12-04T22:29:13.357
> 
> 标签：msbuild, visual-studio-2012, database-project

我在 Visual Studio 2012 中有一个数据库项目。我正在尝试创建一个 MSBuild 项目以在构建服务器上发布数据库。在我的解决方案中，我有一个我想在构建服务器上使用的发布配置文件。

我有以下目标设置：

```
<Target Name="BuildDatabases">       
        <MSBuild Projects="$(DBProjectPath)" Targets="Build;Deploy" Properties="DeployOnBuild=true;SqlPublishProfilePath=BuildServer.publish">
        </MSBuild>
    </Target> 
```

我尝试了 PublishProfile 和 SqlPublishProfilePath 的组合，但无济于事。我总是收到：

```
Deploy Error: The connection string is not valid 
```

我可以在 VS 中使用发布配置文件而没有连接问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T22:38:07.093

弄清楚了：

```
<Target Name="BuildDatabases">
    <MSBuild Projects="$(DBProjectPath)" Targets="Build;Publish" Properties="DeployOnBuild=true;SqlPublishProfilePath=BuildServer.publish.xml">
    </MSBuild>
</Target> 
```

我必须使用“构建；发布”作为目标，我使用的是“构建；部署”

# c++ - 试图理解“模板 朋友类 B;" 语法

> ID：13713097
> 
> 赞同：1
> 
> 时间：2012-12-04T22:29:47.113
> 
> 标签：c++, syntax, grammar, friend

以下是一个简单的 c++ 程序，它使用我的 MinGW 编译器编译，并按预期执行：

```
#include <iostream>

template <class T> class A {
    T a;
    template <class U> friend class B;

  public:
    A<T> (T t) : a(t) {}
};

template <class T> class B {
   A<T> aa;

  public:

    B<T> (T t) : aa(t) {}

    T getT() const {return aa.a;}
};

int main() {
    B<int> b(5);
    std::cout << "> " << b.getT() << std::endl;
} 
```

既然`B<T>::getT()`访问*私人* `A<T>::a`会员，`A<T>`就`B<T>`用`template <class U> friend class B;`line交朋友。

不幸的是，我不知道*为什么*这一行需要这样写。直觉上，我会期待类似的东西`friend class B<T>`，但是，这不会编译。

新引入的含义`U`也不清楚，因为`A`' 和`B`' 的依赖类型`T`在这两种情况下都是。

所以，简而言之，我会很感激任何关于这条线的语法是如何派生或推导的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T22:38:04.170

友谊和模板有许多不同的排列。

您当前的代码将的*任何*模板特`B`化为 的朋友`A<T>`，例如`B<char>`的朋友`A<int>`。

如果你只是想让匹配`A<T>`的人成为朋友，你可以这样说：

```
template <typename> class B;  // forward declare above!

template <typename T>
class A
{
    // ...

    friend class B<T>;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T22:36:23.370

恕我直言，`friend class B<T>;`如果您插入前向声明会起作用

```
template<class T> class B; 
```

在那个之前`class A<T>`。

让`template <class U> friend class B;`每个人都`class B<U>`成为朋友，而不仅仅是`class B<T>`。

# rtp - RTP MCU（媒体投影仪）设计

> ID：13713100
> 
> 赞同：1
> 
> 时间：2012-12-04T22:30:11.207
> 
> 标签：rtp

我正在尝试仅为音频流构建 RTP 媒体投影仪。用户将创建与服务器的会话并可能广播音频流。服务器将向用户发送所有其他活动用户的音频流。

服务器可以从单个端口发送媒体还是需要能够使用一系列端口进行发送？（我知道它需要监听端口 1024 - 65535）。服务器是否需要使用 ICE 或者是否可以立即响应 SDP 请求？

RTCP 在这种情况下如何工作？服务器是以客户的名义发送服务质量反馈还是作为客户自己发送反馈？服务器如何处理来自客户端的服务质量反馈？

假设所有客户端都使用 G.711 编解码器，服务器是否需要对媒体数据包做一些事情，例如更改时间戳或按原样交付它们？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-29T16:07:13.057

如果 MCU 是对等连接中的被动端，则 MCU 可以使用单个端口，如果它是主动端，则可以为每个会话使用单独的端口。

MCU 可以充当转换器并仅转发来自客户端的 RTCP 数据包，但这可能会导致高带宽使用。更复杂的 MCU 可以解析 RTCP 数据包并根据此信息生成 RTCP 报告。

MCU 需要对 RTP 数据包进行解密和重新加密，但只要所有参与者使用相同的编解码器，就不需要转码。

该信息可以在 RTP rfc [http://www.ietf.org/rfc/rfc3550.txt中找到](http://www.ietf.org/rfc/rfc3550.txt)

# git - rsync 排除根据 .gitignore & .hgignore & svn:ignore like --filter=:C

> ID：13713101
> 
> 赞同：137
> 
> 时间：2012-12-04T22:30:17.193
> 
> 标签：git, svn, mercurial, rsync

Rsync 包含一个`--cvs-exclude`“以与 CVS 相同的方式忽略文件”的漂亮选项，但 CVS 已过时多年。有没有办法让它也排除现代版本控制系统（Git、Mercurial、Subversion）会忽略的文件？

例如，我有很多从 GitHub 签出的 Maven 项目。通常，它们`.gitignore`至少包含一个列表`target`，即默认的 Maven 构建目录（可能存在于顶层或子模块中）。由于这些目录的内容完全是一次性的，而且它们可能比源代码大得多，所以我想在使用 rsync 进行备份时将它们排除在外。

当然我可以明确地`--exclude=target/`但是这会意外地抑制不相关的目录，这些目录恰好被命名`target`并且不应该被忽略。

我可以为磁盘上任何 、 或 属性中提到的所有文件名和模式提供完整的绝对路径列表`.gitignore`，`.hgignore`但这`svn:ignore`将是一个巨大的列表，必须由某种脚本生成。

由于 rsync 除了 CVS 之外没有对 VCS 检出的内置支持，有没有什么好的技巧可以给它提供忽略模式？或者某种回调系统，可以询问用户脚本是否应该包含给定的文件/目录？

*更新*：`--filter=':- .gitignore'`正如 LordJavac 所建议的那样，Git`--filter=:C`似乎与 CVS 一样适用，至少在我找到的示例中，尽管尚不清楚语法是否完全匹配。`--filter=':- .hgignore'`对于 Mercurial 来说效果不佳；例如，`.hgignore`包含类似`^target$`（Git 的 Mercurial 等效项`/target/`）的行不被 rsync 识别为正则表达式。Subversion 似乎没有任何效果，您必须解析`.svn/dir-prop-base`1.6 或更早版本的工作副本，并沮丧地举手寻找 1.7 或更高版本的工作副本。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2013-03-12T22:48:15.263

正如 luksan 所说，您可以通过`--filter`切换到`rsync`. 我通过`--filter=':- .gitignore'`（“.gitignore”之前有一个空格）实现了这一点，它告诉`rsync`与`.gitignore`文件进行目录合并，并根据 git 的规则将它们排除在外。如果有的话，您可能还想添加全局忽略文件。为了使其更易于使用，我创建了一个`rsync`包含过滤器的别名。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-03-10T21:21:30.063

您可以使用`git ls-files`构建存储库文件排除的`.gitignore`文件列表。 [https://git-scm.com/docs/git-ls-files](https://git-scm.com/docs/git-ls-tree)

选项：

*   `--exclude-standard`考虑所有`.gitignore`文件。
*   `-o`不要忽略未分级的更改。
*   `-i`只输出被忽略的文件。
*   `--directory`仅在忽略整个目录时才输出目录路径。

我唯一可以忽略的是`.git`。

```
rsync -azP --exclude=.git --exclude=`git -C <SRC> ls-files --exclude-standard -oi --directory` <SRC> <DEST> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2020-08-16T15:13:40.380

经过数小时的研究，我找到了我所需要的：将目标文件夹与源文件夹同步（如果它们在源中被删除，也会删除目标中的文件），而不是将被忽略的文件复制到目标通过`.gitignore`，**但也不要在目标中删除此文件**：

```
rsync -vhra /source/project/ /destination/project/ --include='**.gitignore' --exclude='/.git' --filter=':- .gitignore' --delete-after 
```

换句话说，这个命令**完全忽略了来自 .gitignore 的文件，包括源文件和目标文件**。`--exclude='/.git'`如果也想复制文件夹，您可以省略部分`.git`。

您**必须**`.gitignore`从源中复制文件。如果您将使用 LordJavac 的命令，`.gitignore`则不会被复制。如果您在目标文件夹中创建一个文件，该文件应该被 忽略`.gitignore`，尽管`.gitignore`. 这是因为您在目标中没有`.gitignore`-files。但是如果你会有这些文件，那么这些文件中描述的文件`.gitignore`不会被删除，它们会被忽略，只是意料之中的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-09-30T06:09:54.627

怎么样`rsync --exclude-from='path/.gitignore' --exclude-from='path/myignore.txt' source destination`？
它对我有用。
我相信你也可以有更多的`--exclude-from`参数。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-04-27T09:41:49.717

## 2018年解决方案[确认](https://github.com/pycontribs/rtox/blob/master/rtox/rtox.py#L69)

```
rsync -ah --delete 
    --include .git --exclude-from="$(git -C SRC ls-files \
        --exclude-standard -oi --directory >.git/ignores.tmp && \
        echo .git/ignores.tmp')" \
    SRC DST 
```

详细信息：`--exclude-from`是强制性的，而不是 --exclude 因为排除列表的可能情况不会被解析为参数。从需要文件中排除并且不能使用管道。

当前的解决方案将排除文件保存在 .git 文件夹中，以确保它`git status`在保持独立的同时不会受到影响。如果你愿意，欢迎使用 /tmp。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-12-27T21:00:18.997

对于**mercurial**，您可以使用

```
hg status -i | sed 's/^I //' > /tmp/tmpfile.txt 
```

收集由于*.hgignore*限制而不受 mercurial 控制的文件列表，然后运行

```
rsync -avm --exclude-from=/tmp/tmpfile.txt --delete source_dir/ target_dir/ 
```

rsync 除了忽略的文件之外的所有文件。注意rsync 中的**-m**标志，它将从同步中排除空目录，因为*hg status -i*只会列出排除的文件，而不是目录

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-18T09:24:54.760

尝试这个：

`rsync -azP --delete --filter=":- .gitignore" <SRC> <DEST>`

它可以将所有文件复制到远程目录，不包括“.gitignore”中的文件，并删除不在当前目录中的文件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-09-23T22:01:33.690

我有许多非常大的`.gitignore`文件，没有一个“纯 rsync”解决方案对我有用。我编写了这个[rsync 包装脚本](https://github.com/cobbzilla/cobbzilla-utils/blob/master/bin/gsync)，它完全遵守`.gitignore`规则（包括`!`- 样式的异常和`.gitignore`子目录中的文件），并且对我来说就像一个魅力。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-09T11:46:19.340

查看 rsync(1) 中的 MERGE-FILES FILTER RULES 部分。

看起来可以创建一个 rsync --filter 规则，该规则将包含 .gitignore 文件作为遍历目录结构。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-07-15T13:49:42.637

根据`rsync`手册页，除了文件模式的标准列表：

> $HOME/.cvsignore 中列出的文件将添加到列表中，并且 CVSIGNORE 环境变量中列出的所有文件

因此，我的 $HOME/.cvsignore 文件如下所示：

```
.git/
.sass-cache/ 
```

排除 .git 和[Sass](http://sass-lang.com/)生成的文件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-06-06T14:45:03.310

备择方案：

`git ls-files -zi --exclude-standard |rsync -0 --exclude-from=- ...`

`git ls-files -zi --exclude-per-directory=".gitignore" |...`

（rsync 只能部分理解 .gitignore）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-25T20:11:47.377

简短的回答

```
rsync -r --info=progress2 --filter=':- .gitignore' SOURCE DEST/ 
```

参数含义：

`-r`: 递归

`--info=...`: 显示进度

`--filter=...`: 按 .gitignore 文件中列出的规则排除

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-11-02T16:02:38.477

`git ls-files`您可以使用选择要 rsync 的每个文件，而不是创建排除过滤器：

```
#!/usr/bin/env bash

if [[ ! $# -eq 2 ]] ; then
    echo "Usage: $(basename $0) <local source> <rsync destination>"
    exit 1
fi

cd $1
versioned=$(git ls-files --exclude-standard)
rsync --verbose --links --times --relative --protect-args ${versioned} $2 
```

即使`git ls-files`返回换行符分隔的路径，这也有效。如果您有文件名中带有空格的版本化文件，则可能无法正常工作。

# java - 将字符串从 excel 文件转换为 .xml 文件时出错

> ID：13713103
> 
> 赞同：-1
> 
> 时间：2012-12-04T22:30:20.210
> 
> 标签：java, xml, xlsx

我从 .xlsx 文件中获取一些字符串（字符串是简单字符）。然后我试图将这些字符串放在一个 .xml 文件中。但不幸的是，当我将这些字符串放在“createElement(StringVariableHere)”方法中时，我收到以下错误：“org.w3c.dom.DOMException: INVALID_CHARACTER_ERR: 指定了无效或非法的 XML 字符。”

我以这种方式获取字符串值：

```
switch (tempCell.getCellType()) {
    case Cell.CELL_TYPE_STRING:
    String tempColValue = tempCell.getStringCellValue();
} 
```

这是我尝试添加字符串值的行，它给了我错误。

```
Element titleChild = doc.createElement(StringVariableHere); 
```

我什至尝试使用我在网上找到的以下方法清理字符串：

```
public String stripNonValidXMLCharacters(String in) {
    StringBuffer out = new StringBuffer(); // Used to hold the output.
    char current; // Used to reference the current character.

    if (in == null || ("".equals(in))) return ""; // vacancy test.
    for (int i = 0; i < in.length(); i++) {
        current = in.charAt(i); // NOTE: No IndexOutOfBoundsException caught here; it should not happen.
        if ((current == 0x9) ||
            (current == 0xA) ||
            (current == 0xD) ||
            ((current >= 0x20) && (current <= 0xD7FF)) ||
            ((current >= 0xE000) && (current <= 0xFFFD)) ||
            ((current >= 0x10000) && (current <= 0x10FFFF)))
            out.append(current);
    }
    return out.toString();
} 
```

另外我正在使用以下内容来检查它是否有效，当我添加我的字符​​串时它返回false：

```
XMLChar.isValidName(StringVariableHere) 
```

非常感谢大家的时间。斯特凡诺斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:36:51.077

您是否尝试查看您在 java 中得到的字符串？将其打印到控制台等？

它让我想起了我在解析 office 文档时遇到的类似问题。解析器（apache POI）有时会给出破坏 xml 的 unicode 无效字符（一个例子是换行符）。

我不知道您使用的是什么解析器，但您可能必须在尝试填充您的 xml 之前清理您的字符串。

添加详细信息后进行编辑。

你想写什么样的xml？你能举个例子吗？doc.createElement(StringVariableHere) 表示您尝试创建一个名为 StringVariableHere 的元素。IE

```
<StringVariableHere>there could be something here</StringVariableHere> 
```

不是

```
<aRandomTag>StringVariableHere</aRandomTag> 
```

# r - 有没有办法从R内部关闭计算机

> ID：13713104
> 
> 赞同：3
> 
> 时间：2012-12-04T22:30:21.297
> 
> 标签：r

> **可能重复：**
> [模拟后关闭 Windows](https://stackoverflow.com/questions/11981270/shutdown-windows-after-simulation)

我想知道是否有办法在 R 中的某个进程结束后关闭 PC？

```
somefunction()
Sys.shut.down() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-04T22:33:57.923

您可以尝试运行这样的系统命令（仅适用于 Windows）：

```
system("shutdown -f -t 1") 
```

对于 Mac/Linux 尝试（但权限可能不允许这样做）：

```
system("shutdown -h now") 
```

警告：此命令将强制关闭所有正在运行的进程...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-04T22:41:45.667

[fun](http://cran.r-project.org/web/packages/fun/index.html)`shutdown`包中有一个函数，它将使用适当的系统命令来执行此操作。

# jenkins - 如何在 jenkins 大师中安装一个工具并在药膏上使用它

> ID：13713105
> 
> 赞同：0
> 
> 时间：2012-12-04T22:30:24.987
> 
> 标签：jenkins, jenkins-plugins

如何在 jenkins 大师中安装一个工具并在药膏上使用它

所以我想做的是，假设我在我的 Master 上安装了一个工具（例如 NodeJs 或其他任何东西）和

现在有没有办法让药膏（从主服务器自动安装工具，或使用主服务器工具），而我不必在从服务器上安装工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:46:49.123

一种方法是使用“通过在主设备上执行命令启动从设备”方法来启动您的从设备，并在该主命令中调用一个脚本，该脚本使用 rsync 或类似工具将主工具目录树复制到从设备。有关更多详细信息，请参阅[Jenkins Wiki](https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds#Distributedbuilds-WriteyourownscripttolaunchJenkinsslaves)。

# html - 在表格单元格内尽可能多地拉伸 div

> ID：13713107
> 
> 赞同：2
> 
> 时间：2012-12-04T22:30:28.057
> 
> 标签：html, css, html-table, stretch

我目前正在开发一个包含图片的个人网站。我想为这些图片创建一个框架，所以我将框架的照片切成小块并将每一块做成一个 div，因为我希望框架图片的某个部分可以拉伸而不是边缘，例如这是我的桌子：

```
<table>
  <tr>
    <td height="93px" width="93px"><div id="photo_corner_topleft"></div></td>
    <td height="93px"><div id="photo_beggining_top"></div><div id="photo_side_top"></div><div id="photo_ending_top"></div></td>
    <td height="93px" width="93px"><div id="photo_corner_topright"></div></td>
 </tr>
 <tr>
  <td width="93px"><div id="photo_beggining_left"></div><div id="photo_side_left"></div><div id="photo_ending_left"></div></td>
  <td>
   <div id="photo_content" align="center">

<!-- HERE goes the photo. -->

   </div>
  </td>
  <td width="93px"><div id="photo_beggining_right"></div><div id="photo_side_right"></div>   <div id="photo_ending_right"></div></td>
 </tr>
 <tr>
  <td height="93px" width="93px"><div id="photo_corner_bottomleft"></div></td>
  <td><div id="photo_beggining_bottom"></div><div id="photo_side_bottom"></div><div id="photo_ending_bottom"></div></td>
  <td height="93px" width="93px"><div id="photo_corner_bottomright"></div></td>
 </tr>
</table> 
```

所以，我希望 div 的“photo_side_whatever”尽可能长，而不会推出“结束”和“开始”的 div。我已经检查了其他问题，但我仍然没有成功。这是我的div：

```
#photo_side_left {
    min-height: 224px;
    width: 93px;
    height: auto;
    background-image: url(img/dynamic_frame/frame_09.png);
    background-position: center;
    background-repeat: no-repeat;
    background-size: contain;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:39:49.253

将其插入 div 的开头。这是现场直播，所以我可以更好地理解你的问题吗？

```
 position:absolute; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:40:17.447

没有办法在所有浏览器中都可以使用（CSS3`background-size`属性应该可以做到，但 AFAIK 尚不完全支持）。我认为最简单的做法是将`<td>`s 内的背景图像设置为帧的一小部分（我的意思是最短边大约 1-2px），设置为重复。

就像是：

```
#photo_side_left {
background-image: url('img/dynamic_frame/frameslice.png');
background-repeat:repeat-y;
min-height: 224px;
width: 93px;
height: auto;
background-position: center;
background-repeat: no-repeat;
} 
```

编辑：将其应用于`<td>`，而不是打扰`<div>`s。td 永远是正确的大小^^

# java - 使用 Hibernate 多租户的分布式查询

> ID：13713109
> 
> 赞同：2
> 
> 时间：2012-12-04T22:30:44.493
> 
> 标签：java, hibernate, jpa, multi-tenant

我通过 JPA使用[Hibernate 的多租户功能，](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch16.html)[每个租户策略都有一个数据库](http://msdn.microsoft.com/en-us/library/aa479086.aspx)。我的要求之一是能够对每个数据库中存在但显然具有不同数据的表运行查询。这可能吗？

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T11:02:33.173

没有。这是不可能的，因为当 hibernate 运行查询时，它已经使用连接进行了初始化。Hibernate 中的 MT 支持基本上是在“Hibernate 之外”完成的。这是一种通过适当的连接来喂休眠，当它被喂时:)它绑定到那个连接。

如果您需要跨租户查询，您可能需要重新考虑多租户或将 JPA 提供程序更改为支持“共享模式方法”的提供程序，例如 EclipseLink。使用共享 shema 方法，您有两种选择：

1.  对包含 mt 感知实体的表运行本机查询
2.  创建附加实体 - 不要将其标记为多租户 - 将其映射到包含 mt-ware 实体的表并以标准方式运行 JPQL 查询

# visual-studio-2008 - 迁移到 64 位 - 如何修复 ddl 依赖项？[视觉工作室 2008]

> ID：13713110
> 
> 赞同：0
> 
> 时间：2012-12-04T22:30:44.993
> 
> 标签：visual-studio-2008, dll, dependencies

我目前正在开发一个基于 Visual Studio 32 位 ( `x86`) 平台的软件。但是，我认为迁移到 64 位 ( `x64`) 将提供实质性优势，因为我们可以使用 4GB 的内存，而不是 32 位的 2GB 限制。我正在使用 Visual Studio 2008。

作为第一步 - 我`x64`使用安装盘安装了 Visual Studio 的编译器和工具。当我现在编译它并运行使用`x64`平台创建的新可执行文件时，我得到了`0xc000007b error`. 在谷歌上搜索时，我发现一个潜在的解决方案是追溯依赖关系。所以我使用了`dependencywalker`. 这是输出：

![依赖行者输出](../Images/b4c60c0d6fa74d02a999b2e5e1f42d0b.png)

您会注意到 - 所有 dll 都将 CPU 显示为`x86`. 此外，始终从我`system32`的文件夹而不是`syswow64`文件夹访问所有 dll。这里发生了什么？我可以通过将它指向 x64 dll 来解决这个问题 - 这怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:54:50.293

您**无需**指定“dll 文件夹”。您需要正确设置项目，例如链接器属性中的目标机器类型。

# asp.net-mvc - 如何创建一个允许在 asp.net mvc jQuery 中搜索的多选列表框

> ID：13713114
> 
> 赞同：3
> 
> 时间：2012-12-04T22:31:08.490
> 
> 标签：asp.net-mvc, jquery-ui, jquery-plugins

有人可以向我提供有关如何创建支持搜索其项目的多选列表框/下拉列表的信息吗？

我正在为这个项目使用 ASP.Net MVC 3、JQuery。请注意，我对 ASP.NET MVC 非常陌生。非常感谢详细信息。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:27:15.850

我已经使用 Chosen JQuery 插件实现了这一点 - [http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

# r - 基准测试：使用 `expression` `quote` 或不使用

> ID：13713116
> 
> 赞同：9
> 
> 时间：2012-12-04T22:31:11.060
> 
> 标签：r, expression, benchmarking

通常，当我运行基准测试时，我将我的语句包装在`expression`. 最近，有人建议（a）不这样做或（b）使用`quote`代替表达。

我发现包装语句有两个好处：

*   与整个语句相比，它们更容易换出。
*   我可以遍历输入列表，并比较这些结果

但是，在探索不同的方法时，我注意到这三种方法之间存在差异（包裹`expression`、包裹`quote`或根本不包裹）

**问题是：**
为什么会出现差异？
（似乎包裹`quote`实际上并没有评估呼叫。）

## 例子：

```
# SAMPLE DATA
  mat <-  matrix(sample(seq(1e6), 4^2*1e4, T), ncol=400) 

# RAW EXPRESSION TO BENCHMARK IS: 
  # apply(mat, 2, mean)

# WRAPPED EXPRESSION: 
  expr <- expression(apply(mat, 2, mean))
  quot <- quote(apply(mat, 2, mean))

# BENCHMARKS
  benchmark(raw=apply(mat, 2, mean), expr, quot)[, -(7:8)]
  #    test replications elapsed relative user.self sys.self
  #  2 expr          100   1.269       NA     1.256    0.019
  #  3 quot          100   0.000       NA     0.001    0.000
  #  1  raw          100   1.494       NA     1.286    0.021

# BENCHMARKED INDIVIDUALLY 
  benchmark(raw=apply(mat, 2, mean))[, -(7:8)]
  benchmark(expr)[, -(7:8)]
  benchmark(quot)[, -(7:8)]

  # results
  #    test replications elapsed relative user.self sys.self
  #  1  raw          100   1.274        1      1.26    0.018
  #    test replications elapsed relative user.self sys.self
  #  1 expr          100   1.476        1     1.342    0.021
  #    test replications elapsed relative user.self sys.self
  #  1 quot          100   0.006        1     0.006    0.001 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T22:38:14.040

您的问题是它`quote`不会产生表达式而是 a `call`，因此在对基准的调用中，没有要评估的表达式。

如果您评估 `call 它实际上会被评估，并且时间安排是合理的。

```
class(quot)
[1] "call"
>class(expr)
[1] "expression"

 benchmark(raw=apply(mat, 2, mean), expr, eval(quot))[, -(7:8)]
        test replications elapsed relative user.self sys.self
3 eval(quot)          100    0.76    1.000      0.77        0
2       expr          100    0.83    1.092      0.83        0
1        raw          100    0.78    1.026      0.78        0 
```

一般来说，我倾向于创建一个包含我希望进行基准测试的调用/进程的函数。请注意，最好包含诸如将结果分配给值之类的内容。

例如

```
 raw <- function() {x <- apply(mat, 2, mean)} 
```

在这种情况下，看起来会有轻微的改善`eval(quote(...))`。

```
benchmark(raw(), eval(quote(raw()))

                test replications elapsed relative user.self sys.self 
2 eval(quote(raw()))          100    0.76    1.000      0.75     0.01        
1              raw()          100    0.80    1.053      0.80     0.00 
```

但通常这些微小的差异可能是由于函数开销造成的，并且可能无法反映性能如何扩展到更大的问题。查看解决方案基准测试的许多问题`data.table`，使用少量复制，但大数据可能更好地反映性能。

# c - C中的函数指针实际上是如何工作的？

> ID：13713117
> 
> 赞同：2
> 
> 时间：2012-12-04T22:31:11.790
> 
> 标签：c, function-pointers

> **可能重复：**
> [C 中的函数指针如何工作？](https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work)

我已经看到 C 中函数指针的用法。我想知道它们是如何在 C 的幕后实现的？他们只是指向功能指令的存储位置吗？如果是这样或其他情况，我将不胜感激，如果有人可以图解地展示/详细说明（或指向一些在线资源）它们是如何工作的？

提前致谢 ！

编辑：这个问题不是关于函数指针的使用，如“ [C 中的函数指针如何工作？](https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work) ”中所述。这是关于它们如何实现的内部工作原理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:34:05.707

是的，它们只是指向函数位置的指针，与指向数据的指针相同。但是，根据 CPU 体系结构，当使用函数指针时，实际的程序集可能会完全不同，因为与数据相比，函数可以存储在不同类型的内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:35:42.937

维基百科上的文章（[http://en.wikipedia.org/wiki/Function_pointer](http://en.wikipedia.org/wiki/Function_pointer)）充分解释了它；“函数指针不是引用数据值，而是指向内存中的可执行代码。取消引用时，函数指针可用于调用它指向的函数并传递参数，就像普通函数调用一样。”

# c# - 从分隔字符串填充列表属性

> ID：13713119
> 
> 赞同：1
> 
> 时间：2012-12-04T22:31:19.940
> 
> 标签：c#, sql-server-2008, entity-framework, linq-to-entities, ef-code-first

这是一个简单的应用程序，但我对 ASP.NET MVC 有点陌生，所以我在思考如何完成这个问题时遇到了一些麻烦，因为

我有两个课程：

```
public class BugAssignment
{
    public int BugAssignmentID { get; set; }
    public int BugNumber { get; set; }
    public int UserID { get; set; }
    public virtual User User { get; set; }
}

public class BugAssignmentList
{
    public int BugAssignmentListID { get; set; }
    public string Name { get; set; }
    public List<BugAssignment> BugAssignments { get; set; }
} 
```

我想要做的是填充给定用户输入的BugNumbers 分隔字符串的BugAssignments 列表（即208,576,403）。我猜它会爆炸字符串，循环并创建 BugAssignment 对象，存储到列表中并设置 BugAssignments 属性。我怎么能做到这一点？

另外，我使用 Entity Framework Code-first 和 SQL server 2008 作为我的数据库引擎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:37:19.860

如果您坚持将字符串转换为字符串数组...

在 C# 中使用[String.Split()](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)将逗号分隔的字符串拆分为字符串对象数组非常简单。

```
string[] StringArray = String.Split(BugAssignments , ",".ToCharArray(), StringSplitOptions.RemoveEmptyEntries); 
```

从那里，应该可以直接循环遍历数组并完成剩余的工作。如果您遇到其他问题，请告诉我们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:39:25.077

使用 string.Split 和 Linq Select，你可以这样写：

```
string BugNumbers = "208,576,403";
int currentUserID = 0;

BugAssignmentList list = new BugAssignmentList
{
    BugAssignments = BugNumbers.Split(',')

        // convert list of numbers to list of BugAssignment objects
        .Select(num => new BugAssignment 
        { 
            BugNumber = int.Parse(num.Trim()),
            UserID = currentUserID 
        })
        .ToList(),
    Name = "assignment list name"
}; 
```

# python - 有没有办法在 GET 函数中获取 App Engine 中的表单信息

> ID：13713126
> 
> 赞同：0
> 
> 时间：2012-12-04T22:32:06.043
> 
> 标签：python, html, google-app-engine

我的问题很简单...

例如，在 def post(self) 函数中，我可以使用 self.request.get 来提取表单信息。

有什么方法可以在“def get(self)”函数中完成同样的事情吗？

谢谢！！！

编辑：

我想要完成的有点像 facebook。如果你可以想象一个 facebook 墙，每个人都有自己的展示图片，这些图片是动态变化的。我正在尝试完成同样的事情......我认为如果我选择将它们扔到 url 中，太多的变量最终会出现在 url 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:42:21.637

```
 def get(self):
    id = self.request.get('id') 
```

您在 URL 中对其进行编码的位置，例如

```
/play?id=some_id 
```

webapp2[处理程序的更多信息](http://webapp-improved.appspot.com/guide/handlers.html)

# ruby - 使用终端进行 ruby rails an ruby mine 的权限问题

> ID：13713127
> 
> 赞同：0
> 
> 时间：2012-12-04T22:32:09.933
> 
> 标签：ruby, macos, permissions, rubygems, terminal

刚开始在rails上学习ruby。目前正在尝试安装一些有权限问题的 gem

```
Last login: Tue Dec  4 19:21:30 on ttys000
unknown-00-1c-b3-c0-49-e2:~ Wushu$ gem install
ERROR:  While executing gem ... (Gem::CommandLineError)
Please specify at least one gem name (e.g. gem build GEMNAME)
unknown-00-1c-b3-c0-49-e2:~ Wushu$ 
```

我使用 mac os x 10.6。
我尝试使用我的 Mac 上的实用程序清理我的权限，但仍然遇到同样的问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:30:59.430

就像@simonmorley 所说，您绝对应该在 rails 应用程序中使用 Gemfile 来处理安装 gem 等以及捆绑程序。

您可能还想研究 rvm 来管理不同项目的 ruby​​ 版本和 gemset。

至于您的错误，您需要在执行命令时提供一个 gem 名称`gem install <some_gem_name>`请注意，gem 不会在 Rails 应用程序的上下文中运行，并且当您决定在另一台计算机/服务器上使用您的应用程序时，它不会知道使用您正在安装的宝石。所以就像我说的，将它包含在你的 Gemfile 中，它会在以后为你省去任何麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:58:26.043

这不应该是：

```
 gem install << name of gem here >> 
```

不只是：

```
 gem install 
```

- 编辑 -

安装单个 gem 的更好方法是使用 bunder。当然，如果您使用的是 Ruby on Rails。

在您的 gemfile 中，添加相关的 gem：

来源“http://rubygems.org”

```
gem 'rails'
gem 'mysql2', '~> 0.3.10'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end 
```

然后运行

```
bundle install 
```

在 Rails 应用程序根目录中

# java - 以正确的顺序向 JTable 添加行。

> ID：13713132
> 
> 赞同：3
> 
> 时间：2012-12-04T22:32:32.903
> 
> 标签：java, swing, object, arraylist, jtable

我正在编写一个代码，其中数据是从数组的arraylist 中收集的，我将其添加到JTable 中。但是，代码总是将数据从底部向上添加，因此如果有两行数据，它会将它们添加到最后两行，而不是前两行。这是相关代码，

```
public class RegistrationView extends GUIDesign implements ActionListener {

//variable declarations here. 

public RegistrationView (GTPort gport){

    super("Student Report", 3);

    gtPort = gport;

    setLayout(new BoxLayout(this,BoxLayout.PAGE_AXIS));
    setPreferredSize(new Dimension(500,800));

    header = new JPanel();
    header.setSize(getWidth(), 30);
    body = new JPanel();
    body.setLayout(new BoxLayout(body,BoxLayout.Y_AXIS));

    header.setBackground(color);
    title.setFont(new Font("Helvetica", 1,20));
    header.add(title);

    data = new Object[15][4];

    model = new DefaultTableModel(data, columns);

    table = new JTable(model);

    body.add(table.getTableHeader()); 
    body.add(table);

    backButton.addActionListener(this);
    buttonPanel.add(backButton);

    buttonPanel.add(backButton);
    add(header);
    add(body);
    add(buttonPanel);

}

public void refresh()
{
           //this is the data to be added. it is an arraylist of object arrays. 
    ArrayList<Object[]> selectedData = gtPort.selectedData;

           //i use this code to erase all the data in the table, if there is any. this                   //method may be called later, so the data must be erased. 
    model.setRowCount(0);
    table = new JTable(model);
    model.setRowCount(35);

    //adding the rows to the model, which is then added to the table. 

    for (Object[] objects: selectedData)
    {
        model.addRow(objects);

    }

    table = new JTable(model);

} 
```

//谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-04T22:38:50.677

更改`model.addRow(objects);`为`model.insertRow(0, objects);`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:42:15.940

在通过设置行数两次将元素添加到 JTable 之后，看起来好像是在添加行。它应该为您填充，而不必设置行数。要在更改后刷新表格，请尝试使用`fireTableDataChanged();`并查看[http://docs.oracle.com/javase/tutorial/uiswing/components/table.html](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)以了解如何正确构建布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T07:53:23.827

在表格底部添加行，因为 DefaultTableModel 将在末尾添加行，如果您使用javadoc 中所述的.. [addRow(..) 方法。](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/table/DefaultTableModel.html#addRow%28java.lang.Object%5B%5D%29)使用[insertRow(..)](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/table/DefaultTableModel.html#insertRow%28int,%20java.lang.Object%5B%5D%29)方法在特定位置插入行。但请注意[ArrayOutOfBoundException。](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/ArrayIndexOutOfBoundsException.html)

如javadoc中所述，

```
 public void insertRow(int row, Object[] rowData) 
```

在模型中的 row 处插入一行。除非指定了 rowData，否则新行将包含空值。将生成正在添加的行的通知。

```
 public void addRow(Object[] rowData) 
```

在模型末尾添加一行。除非指定了 rowData，否则新行将包含空值。将生成正在添加的行的通知。

# sql - 没有返回行时使用合并函数

> ID：13713134
> 
> 赞同：0
> 
> 时间：2012-12-04T22:32:38.160
> 
> 标签：sql

[这是使用以下语句的帖子](https://groups.google.com/d/msg/comp.databases.theory/Gphu01jz4H0/YpVE4DoBUjQJ)：

```
CREATE FUNCTION ValidateExclVehicle_check (
 @vin           CHAR(17),
 @vehicle_type  CHAR(3)
)
RETURNS TINYINT
AS
-- Exists     = 1
-- Not Exists = Null, 0 substituted
RETURN ( 
SELECT COALESCE(1, 0)
 FROM  Vehicle
 WHERE vin          = @vin
 AND   vehicle_type = @vehicle_type 
) 
```

我不明白为什么表达式 COALESCE(1,0) 会返回 1 以外的任何值，除非 where 子句不返回任何行，在这种情况下，整个语句不返回任何行，并且 coalesce 表达式的值无关紧要。我没有看到“0 替换”。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:36:50.577

我同意你的看法。该语句应该返回 1 或 NULL/无行。这可能是特定于数据库的现象，假设您确实看到它返回 0。

我认为意图是：

```
return (select (case when count(*) = 0 then 0 else 1 end)
        from Vehicle
        where vin = @vin and vehicle_type = @vehicle_type
       ) 
```

# content-management-system - Sitecore 在发布期间跳过项目。如何排除故障并找出原因？

> ID：13713135
> 
> 赞同：2
> 
> 时间：2012-12-04T22:32:38.983
> 
> 标签：content-management-system, sitecore, publishing

我在 Sitecore 的测试实例中有一系列项目，我需要将它们发布到 Sitecore 开发实例以对它们进行一些调试。从测试到开发中的主数据库的所有发布工作正常。然后我将这些项目发布到 dev 中的 Web 数据库中。辅助项目（模板、布局、渲染、子布局、媒体库项目等）的所有发布工作正常，但我的实际内容项目被跳过（好吧，从技术上讲，我正在发布的部分的根节点被跳过，所以它下面的任何内容都不会被发布）。我不知道为什么它会被跳过 - 有没有办法让人们看到它？

这是我到目前为止所尝试的：

*   制作内容项节点的副本并尝试发布它。跳过。
*   在与内容节点具有相同模板类型的内容树中添加新项目并尝试发布该项目。跳过。
*   打包，而不是发布，测试中的项目，在开发中安装并尝试发布。跳过。
*   从 Web 数据库中删除所有相关项目并以不同的顺序重新发布（布局文件夹中的所有内容都在任何模板之前）。所有辅助项目都可以重新发布。内容项目被跳过。

我有点卡住了，日志中没有任何有用的内容（它只是显示发布开始和结束，但没有任何内容表明为什么会跳过任何内容）。

感谢有关如何找出这些特定项目未发布的原因的任何帮助或想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T02:34:16.433

您可以直接将项目从 master 传输到 web db 吗？

从 Sitecore 控制面板 -> 数据库 -> 将项目传输到另一个数据库。

正如 idisposable11 所说，这听起来确实像是一个工作流/发布限制问题。检查没有附加工作流，检查工作框以确保队列中没有任何内容，确保项目已提交以供审核/批准（如果它们在工作流中），并检查没有为发布限制设置日期/时间。

您可能可以在 publish:itemXXX 事件中添加一个处理程序，或者您可以在发布管道中添加一些内容来帮助记录/调试并逐步完成，当我在安装了 Sitecore 的机器前面时需要看看.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-17T19:08:40.093

试试这个：

1.  转到内容编辑器中的项目，然后在**发布**选项卡上，单击限制部分中的**更改**。
2.  单击**目标**选项卡。
3.  在目标选项卡上，检查允许的目标。检查您需要发布到的目标。

我相信如果您没有任何检查，Sitecore 将发布到所有可用目标。[在这里](http://www.sitecore.net/learn/blogs/technical-blogs/john-west-sitecore-blog/posts/2011/05/all-about-publishing-targets-in-the-sitecore-aspnet-cms.aspx)查看更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-10T20:40:33.737

还有另一种情况可能导致这种情况。希望这可以在将来拯救某人。

如果更高级别的项目设置为从不发布（即使更改仅保存到主数据库），无论尝试什么，任何子项目（嵌套）都将自动取消发布。

如果您右键单击内容树的左侧并选择“发布警告”，则可以追踪罪魁祸首。警告标志不会像您想象的那样向下级联，但会影响任何嵌套的子级。

在我们的例子中，不知何故 /sitecore 项目被意外设置为这个，这导致网站上的任何发布都删除项目。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-10T12:11:34.037

确保要发布的项目所在的文件夹具有版本。如果没有，项目将被跳过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T00:41:14.120

您是否查看过定义的任何发布限制？也可能是为要发布的内容项定义了一个工作流。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-04T08:01:10.770

Sitecore.config 中有一个设置，即 Publishing.PublishEmptyItems。默认情况下，它设置为 false。对我来说，将其设置为 true 可以解决问题。

```
<setting name="Publishing.PublishEmptyItems" value="true"/> 
```

# filemaker - 从列表中的第一项创建新记录

> ID：13713138
> 
> 赞同：0
> 
> 时间：2012-12-04T22:33:24.217
> 
> 标签：filemaker

我有一张包含一长串产品的表格。每个产品都有一个 sku 和一个款式编号。麦粒肿编号对于一组 sku 编号是通用的。例如，一件 North Face 夹克会有一个通用的款式编号，每种尺寸和颜色都有单独的 sku 编号。我需要在一个很长的列表中获取样式编号的第一个实例，并在单独的表中创建一个新记录。这样，我可以设置一个关系，将所有单独的 sku 编号与主要样式编号挂钩。我不是 Filemaker 专业人士，因此对于如何执行此操作的任何建议将不胜感激。我假设有一种方法可以遍历列表并从新样式编号的第一个实例创建新记录？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T04:02:55.667

这应该是 FileMaker 中的一个小技巧。

首先，与处理大量数据时一样，**创建 filemaker 文件的备份：**

```
File > Save a copy as... 
```

确保您没有选择克隆作为您的类型，否则您最终将没有数据。

**这些说明假设您有两个表，如下所示：**

产品（有记录）

*   ID
*   库存单位
*   风格

样式（空）

*   ID
*   风格

**创建关系**

```
File > Manage Database > Define Relationship 
```

*   从 product::style 中拖出一个关系到 style::style。
*   双击等号。
*   在关系的*样式*方面，选中“允许通过此关系在此表中创建记录”。
*   单击*确定*两次。

**编写脚本来创建记录**

`Scripts > Manage Scripts`

*   点击“新建”
*   重新创建以下脚本：

![用于创建样式记录的 FileMaker 脚本](../Images/e50720e75d1479fffa1f8962498db5eb.png)

如果您有任何问题，请在此处回信。我添加了评论，所以希望一切都简单易懂。

并且不要忘记先备份您的数据！祝你好运。

# c# - 内部类需要访问外部类。好吗？

> ID：13713142
> 
> 赞同：2
> 
> 时间：2012-12-04T22:33:37.130
> 
> 标签：c#, .net, oop, class, object

我有课

```
class TournamentManager
{
    public List<Target> Targets = new List<Target>();
    public List<Player> Players = new List<Player>();
    public List<Club> Clubs = new List<Club>();
    public List<Round> Rounds = new List<Round>();
} 
```

现在有问题了。许多回合功能需要访问所有玩家和俱乐部列表。还。玩家类中有需要访问回合列表的功能。

如何解决这个问题？我知道我没有表现出太多。但我宁愿阅读一些一般规则。如何组织它？我是否应该将对 TorunamentManager 的引用传递给需要访问这些列表的 Player 和 Round 的那些方法？我应该完全不同地组织它吗？

我是 OOP 和那种编程的新手。我也找不到任何可以向我展示如何解决此类问题的好书。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T22:41:04.530

您可能应该以不同的方式组织它。考虑*关系*。

存在哪些关系？这就是我要看的

*   锦标赛有一组回合
*   每轮都有一组团队
*   每支球队都有一组球员

（不确定目标适合的位置）

对我来说，这意味着

```
public class Tournament
{
 public List<Round> Rounds { get; set; }
 public List<Team> Teams { get; set; }
}

public class Team
{
 public List<Player> Players { get; set; }
}

public class Round
{
 public Team Home { get; set; }
 public Team Away { get; set; }
}

public class Player
{
 public string Name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T22:58:20.703

如果您的 TournamentManager 类是非静态的（也许这样您可以拥有多个实例）并且您的 Round 和 Player 类具有需要引用 TournamentManager 类的属性的方法，您可以将对 TournamentManager 实例的引用传递给Round 和 Player 类的构造函数（然后可以将该引用保存在私有字段中）。

此外，如果您不需要 TournamentManager 类的多个实例，则可以将其设为静态类。然后， Round 和 Player 类方法可以直接引用列表。

```
public class Player
{
    ...

    public void SomeMethod()
    {
        int numRounds = TournamentManager.Rounds.Count;

        ...
    }

    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T22:37:35.463

有很多方法可以组织你的代码，而且在不知道你想要做什么以及你的代码有多复杂的情况下，很难推荐一个实现。如果您希望 Round 和 Player 类函数能够访问 TournamentManager 类中的公共列表，则需要将列表声明为静态元素。然后您可以通过 TournamentManager.listName 引用其他课程中的列表

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-04T22:54:58.650

如果这是您要查找的内容，我将发布特定代码。

我有一个包含用户和组的应用程序。
在用户中，我想添加和删除组。
并且在组中想要添加和删除用户但想要添加和删除组。
想要一个同步另一个。

创建了一个类 UserGroup 和一个 UserGroup 的 HashSet 调用 UsersGroups。
将 UsersGroups 传递给用户和组。
然后从用户 LINQ where(x => x.User = this)
获取组并获取用户组使用 LINQ where(x => x.Group = this)

# css - 选择行和子项

> ID：13713143
> 
> 赞同：1
> 
> 时间：2012-12-04T22:33:42.870
> 
> 标签：css, selector, parent-child

我可以选择一个`tr`。

我可以选择 a`tr`的孩子。

我如何选择一个`tr` *和*它的孩子？

例如，`background-color`当行或其任何子级悬停时，我想更改整行及其子级的 。

我也可以。我不能两者都做。

提前谢谢了！

**特异性**

我应该补充一点，我想包括*所有*子项，例如输入。

绝对应该更清楚。：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T22:39:03.757

```
tr:hover, td:hover, tr:hover td {
   background-color:green;
} 
```

对于其他孩子来说

```
tr:hover, td:hover, tr:hover * {
   background-color:green;
} 
```

女巫会为所有孩子工作（你可能会因为这个想法而得到不想要的结果......）

或者，更具体一点，列出你真正希望效果发生的女巫中的所有孩子

前任：

```
tr:hover, td:hover, tr:hover td, , tr:hover input[text], tr:hover .myHoverClass {
   background-color:green;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:38:44.307

当您将鼠标悬停在 a 的子元素上时，`tr`您也有效地将鼠标悬停在 the`tr`上，因此您只需要定位最高元素（*the`tr`*）

```
tr:hover,
tr:hover td{
   background-color:red;
} 
```

# ssh - 使用 SSH 将文件移动到不同的服务器？

> ID：13713146
> 
> 赞同：0
> 
> 时间：2012-12-04T22:33:50.687
> 
> 标签：ssh

我有大量文件想从一台服务器移动到另一台服务器。

在不使原始服务器超载的情况下，最好的方法是什么？

我是否应该对每个文件夹进行 tar，然后下载到我的计算机，然后再上传到另一台服务器？

这样做的 SSH 命令是什么？

或者有没有更好的方法来做到这一点？

谢谢安迪

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T09:32:04.353

来自 SCP 参考手册：

> 任何文件名都可以包含主机和用户规范，以指示文件将被复制到该主机/从该主机复制。允许在两个远程主机之间进行复制。
> 
> -p 保留原始文件的修改时间、访问时间和模式。
> 
> -r 递归复制整个目录。

```
scp -rp username@source:/foldername/ username@destination:/foldername 
```

使用 tar 创建一个文件可能会稍微减少负载，因为在一个文件上不会有太多的文件处理开销...ymmv。使用 gzip 压缩会减少带宽，但会在源服务器上增加更大的负载来压缩文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:40:17.523

我认为您对“服务器超载”的担忧是没有根据的。移动文件的任何方式都会稍微加载服务器，但这是微不足道的。

`tar`首先对文件进行ing 和`gzip`ing 会减少网络流量，但是`tar`ing 和`gzip`ing 的操作将需要第一台服务器的工作。

简单`tar`的 ing 可能没有多大价值——它是一个大文件而不是许多小文件（总大小相同）。

下载然后上传几乎没有实际价值——除非你也想要一个副本——你到每台服务器的网络连接可能比两台服务器之间的网络连接更差。

不过，这对于 SuperUser 来说更像是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T08:35:02.720

1.  tar+gzip/bzip2 和 scp 复制

2.  rsync（它可以通过 ssh 工作）

# python - 在不使用数据库软件的情况下从表中获取项目列表

> ID：13713147
> 
> 赞同：0
> 
> 时间：2012-12-04T22:33:52.573
> 
> 标签：python, sql, linux, bash, bioinformatics

我想在一张表上做一些简单的数据库操作，而不需要使用数据库软件，例如，我可以使用来自 GitHub 的“filo”包来做一些类似于“groupby”功能的事情。我想知道是否有类似的东西可以实现一些简单的“加入”功能？或者我可以用 Python 或 Bash 来做吗？具体来说，我有一个像这样的表：

```
Col5a2  NM_007737   chr1    -   45447828    45447829
Slc40a1 NM_016917   chr1    -   45870140    45870141
Gm3852  NM_001177356    chr1    -   45956809    45956810
Slc39a10    NM_172653   chr1    -   46798055    46798056
Obfc2a  NM_028696   chr1    -   51422944    51422945
Myo1b   NM_001161817,NM_010863  chr1    -   51860519    51860520
.
.
. 
```

我有一个清单

```
Slc40a1
Myo1b
Col5a2
Obfc2a
.
.
. 
```

我想从表中获取列表中的项目，这样我会得到：

```
Slc39a10    NM_172653   chr1    -   46798055    46798056
Myo1b   NM_001161817,NM_010863  chr1    -   51860519    51860520
Col5a2  NM_007737   chr1    -   45447828    45447829
Obfc2a  NM_028696   chr1    -   51422944    51422945
.
.
. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:09:22.863

Here's one way using `awk`:

```
awk 'FNR==NR { a[$1]=$0; next } $1 in a { print a[$1] }' table list 
```

or with formatting:

```
awk 'FNR==NR { a[$1]=$0; next } $1 in a { print a[$1] }' table list | column -t 
```

Results:

```
Slc40a1  NM_016917               chr1  -  45870140  45870141
Myo1b    NM_001161817,NM_010863  chr1  -  51860519  51860520
Col5a2   NM_007737               chr1  -  45447828  45447829
Obfc2a   NM_028696               chr1  -  51422944  51422945 
```

Explanation:

> 'FNR==NR { ... }' is a conditional that is only true for the first file in the argument list.
> 
> > So for each line in the file called 'table', the first column ($1) is added to an array (called 'a') and this is assigned the value of the whole line ($0). 'next' then skips to remainder of the code and jumps to the next line of input, until all lines in the 'table' file have been processed.
> 
> '$1 in a' is another conditional.
> 
> > This is asking if column one of the 'list' file is a key in the array. If it is, then print out the value of column one that we just stored in the array (a[$1]).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T23:10:21.143

You can indeed accomplish this with two standard unix tools, `join(1)` and `sort(1)`:

```
$ join <(sort table) <(sort list)

Col5a2 NM_007737 chr1 - 45447828 45447829
Myo1b NM_001161817,NM_010863 chr1 - 51860519 51860520
Obfc2a NM_028696 chr1 - 51422944 51422945
Slc40a1 NM_016917 chr1 - 45870140 45870141 
```

The call to `sort` is needed because (from [join man page](http://linux.die.net/man/1/join)):

> Important: FILE1 and FILE2 must be sorted on the join fields. E.g., use 'sort -k 1b,1' if 'join' has no options. Note, comparisons honor the rules specified by 'LC_COLLATE'. If the input is not sorted and some lines cannot be joined, a warning message will be given.

**Update:** A solution inspired by [this answer](https://stackoverflow.com/a/9806738/295262), keeping order:

```
$ join -1 2 <(cat -n list | sort -k2,2) <(sort table) | sort -nk2,2 | cut -d\  -f1,3- 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T23:00:23.687

如果您只是通过表的第一列进行非常简单的查找，那么 python`dict`可能就足够了一个数据结构。

像这样构建它：

```
table = {}
with open(table_file) as f:
    for line in f:
        row = line.split()
        table[row[0]] = row 
```

You can then do your "join" against this dictionary using a list comprehension:

```
results = [table[key] for key in keys_list] 
```

Or if your second list is also a data file, you can do this instead:

```
with open(second_file) as f:
    results = [table[line.strip] for line in f] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T23:00:00.350

```
import numpy as np
data = []
with open("file1.txt") as f:  #the data file
   for row in f:
      data.append(row.split())
with open("file2.txt") as f:  #the keys file
   keys = map(str.strip,f.readlines())
np_data = np.array(data,np.str)
mask = np.in1d(np_data[:,0],keys)
print np_data[mask] 
```

如果我真的不想使用数据库，那我该怎么做

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T23:21:58.560

You can use pandas which work like a database to "select" and pivot. This is an example that works:

```
import pandas as pd
data = pd.DataFrame({ 
        'Col5a2'  : ['NM_007737',    '-',         'chr1', 45447828, 45447829],
        'Slc40a1' : ['NM_016917',    '-',         'chr1', 45870140, 45870141],
        'Gm3852'  : ['NM_001177356', '-',         'chr1', 45956809, 45956810],
        'Slc39a10': ['NM_172653',    '-',         'chr1', 46798055, 46798056],
        'Obfc2a'  : ['NM_028696',    '-',         'chr1', 51422944, 51422945],
        'Myo1b'   : ['NM_001161817', 'NM_010863', 'chr1', 51860519, 51860520],
    })
data.get(['Slc40a1', 'Myo1b', 'Col5a2', 'Obfc2a'])

# Output:

     Slc40a1         Myo1b     Col5a2     Obfc2a
0  NM_016917  NM_001161817  NM_007737  NM_028696
1          -     NM_010863          -          -
2       chr1          chr1       chr1       chr1
3   45870140      51860519   45447828   51422944
4   45870141      51860520   45447829   51422945 
```

# haskell - Haskell Vector Typeclass：[a] -> [a] -> a 的函数

> ID：13713151
> 
> 赞同：6
> 
> 时间：2012-12-04T22:34:02.577
> 
> 标签：haskell, typeclass

好吧，我正在尝试围绕类型类进行思考，因此我正在尝试为几何向量操作定义一个类型类。我设法让它在组件方面工作，`+,-,*,/;`但我在点积上苦苦挣扎。

```
class GeomVector a where
  (>+) :: a -> a -> a
  (>-) :: a -> a -> a
  (>*) :: a -> a -> a
  (>/) :: a -> a -> a

  (>.) :: a -> a -> Double

data Vector a = Vec [a]
              deriving Show

instance (Fractional a) => GeomVector (Vector a) where
  (>+) (Vec u) (Vec v) = Vec $ zipWith (+) u v
  (>-) (Vec u) (Vec v) = Vec $ zipWith (-) u v
  (>*) (Vec u) (Vec v) = Vec $ zipWith (*) u v
  (>/) (Vec u) (Vec v) = Vec $ zipWith (/) u v

  (>.) (Vec u) (Vec v) = sum $ u >* v 
```

显然，我对 (>.) 的实例定义不起作用，因为结果是 type `Fractional a`，而不是`Double`。

但我不知道如何从类中的声明中获得这种行为。

我想做*的*是：

```
class GeomVector [a] where
  (>.) :: [a] -> [a] -> a 
```

但这是无效的，因为`[a]`是类型而不是类型变量。

我希望我能更好地解释这一点，但老实说，我理解得还不够。希望该代码将使我正在努力解决的问题更加明显。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T00:57:07.093

这是一个可行的选择：

```
class GeomVector v where
  (>+) :: Num a=> v a -> v a -> v a
  (>-) :: Num a=> v a -> v a -> v a
  (>*) :: Num a=> v a -> v a -> v a
  (>/) :: Fractional a=> v a -> v a -> v a
  (>.) :: Num a=> v a -> v a -> a

data Vector a = Vec { vecList :: [a] }
              deriving Show

instance GeomVector Vector where
  (>+) (Vec u) (Vec v) = Vec $ zipWith (+) u v
  (>-) (Vec u) (Vec v) = Vec $ zipWith (-) u v
  (>*) (Vec u) (Vec v) = Vec $ zipWith (*) u v
  (>/) (Vec u) (Vec v) = Vec $ zipWith (/) u v

  (>.) u v = sum $ vecList (u >* v) 
```

所以你所有的实例`GeomVector`都会有一个`* -> *`类`Monad`。并且方法的类型并没有不必要地限制为`Fractional`类型，因为您在其中的某个地方进行了划分。

您还可以考虑使您的类尽可能小（`>.`在类之外创建一个多态函数）以及您真正想要的是否是一个类型类。但这一切都取决于你在设计什么，我不想假设我比你更了解这一点！

# c++ - 如何避免使用 TCP 进行序列化/反序列化时的跨语言依赖？

> ID：13713153
> 
> 赞同：3
> 
> 时间：2012-12-04T22:34:11.573
> 
> 标签：c++, python, algorithm, tcp, protocols

我需要创建与 C++ 客户端和 Python 服务器的 TCP 聊天（已经开始），我在 C++ 类中有消息，例如

```
class Message{
public:
uint64 utc_time;
uint64 token;
string content;
}; 
```

我将这个从客户端发送到服务器，在服务器上我有 utc_time 的优先级队列，需要广播给其他人。我的问题是如何序列化这个，使用哪种格式以避免对大小类型 size 的任何跨语言依赖？（也许将来会有更多元数据，所以需要有点通用）？谁能给我建议使用哪种格式进行序列化（或仅刷新字节）？

```
class Persistent:
public:
    Persistent(int sz):objSize(sz){}
    void write(std::ostream& out)const{out.write((char*)this, objSize);}
    void read(std::istream& in){in.read((char*)this, objSize);}
private:
    int objSize;
}; 
```

我想到了在服务器上使用 c++ 反序列化器并在可能的情况下从 python 调用的其他可能性。这个问题有什么优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T04:50:09.020

如果您真的想跨语言和跨平台而不必担心消息在哪里结束，请查看[Google Protobuf](http://code.google.com/p/protobuf/)和[ZeroMQ](http://www.zeromq.org/)的组合。

使用常规套接字时，您将首先读取消息的大小（您将在前面添加它），然后您会知道字节数组从哪里到哪里是一个完整的消息。

protobuf + zmq 用法示例：

```
message Message {
    optional uint64 utc_time = 1;
    required uint64 token = 2;
    optional string content = 3;
} 
```

使用 protobuf 编译器生成 C++ 代码（或 ruby​​/python/etc）。

要在您的代码中使用它：

```
#include <Message.pb.h>

Message msg;
msg.set_token(1);
msg.set_content("Hello world"); 
```

要使用 zmq 发送它：

```
std::string serialized = msg.SerializeAsString();
zmq::message_t reply(serialized.size());
memcpy(reply.data(), serialized.data(), serialized.size());
zmq_socket.send(reply); 
```

要使用 zmq 接收它：

```
zmq::message_t request;
zmq_socket.recv(&request); // blocking
Message recv_msg;
recv_msg.ParseFromArray(request.data(), request.size()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T19:25:21.317

使用 ZeroMQ 是一个好的开始，因为它会为您处理所有传输工作。序列化的最佳方式取决于您正在做的工作类型。由于您正在做一个聊天应用程序，效率不是问题，所以我会使用自描述文本格式，它最易于调试、跟踪、记录和使用。像 protobufs 或 msgpack 这样的任何东西都将是额外的工作，没有可衡量的回报。您可以使用 XML、JSON、HTTP 样式的标头、名称=值对等。

当您开始制作非常大量的消息（每秒数十万条）或非常大的消息（例如超过 1K 字节）时，您可以开始考虑减少消息大小的不同方法。我个人建议坚持使用最简单的文本格式，直到您确实遇到性能问题，然后在需要它的情况下切换到最有效的二进制格式。但不是在聊天应用程序中...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T20:45:09.043

我喜欢使用 JSON，假设您有一个良好的套接字缓冲接口和一个基于流的 JSON 解析器。JSON 的好处是您不需要指定每条消息的长度。正确编写的 JSON 解析器可以判断它何时到达“对象”的末尾。因此，您的阅读器对象可以只解析通过网络传输的 JSON，当您到达初始对象的末尾时，将其作为一条消息返回给系统。

如果 JSON 对于您的数据来说太过分了，那么总会有纯文本。大多数互联网以纯文本（POP、IMAP、HTTP、FTP 等）运行。那是因为纯文本是使用跨平台/跨语言最简单的方法。

# actionscript-3 - 如何更改文本框 AS3 中的文本？

> ID：13713154
> 
> 赞同：2
> 
> 时间：2012-12-04T22:34:13.120
> 
> 标签：actionscript-3, flash, apache-flex, actionscript, textfield

我有一个名为“文本框”的文本字段。我有这个代码：

```
textbox.text = 'hello'; 
```

代码是正确的，但播放时不会改变文本。以前的文本会清除，但新文本 ( **hello** ) 不会出现。我猜它与属性有关，但我只是不知道是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T17:01:16.603

1）您正在使用的字体尚未嵌入您正在编写的那些字符 - 解决方案是单击 Flash IDE 中的文本字段，选择“嵌入字体”并选择要嵌入的字符（基本拉丁语应该做给你的伎俩）

2）文本字段不可见：通过 textbox.visible = true 访问它

3) 文本框太小无法显示文本，请确保使其足够大以显示文本

这是基本的东西，如果没有解决，请告诉我

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:39:56.860

由于它的一个小描述，我可以想到很多事情。- 文本框是否添加到舞台？- 文本框可见吗？- 你调用函数吗？

尝试在行中插入断点，在调试模式下启动，看看会发生什么。

代码本身应该可以工作。只要确保它被调用。一个很好的工具是 trace(); 例如：

```
trace("calling textbox:", textbox.text); //the output panel should say the current text in textbox
textbox.text = 'hello'; //set text
trace("calling textbox:", textbox.text); //see it the text is being set. 
```

如果您在输出面板中看不到任何内容，则不会调用函数。如果您看到它发生变化，则表示文本框不可见。如果它有效，它就有效。:)

# shell - 如何使用 Fabric 设置环境变量

> ID：13713156
> 
> 赞同：13
> 
> 时间：2012-12-04T22:34:19.843
> 
> 标签：shell, ubuntu, fabric

我有一个严重依赖系统环境变量的本地开发环境（它遵循 Heroku 12 因素应用程序模型），我目前使用 shell 脚本设置这些。shell 脚本还设置了 git 遥控器，并激活了 virtualenv 环境，如果可能的话，我希望将所有这些都移到 Fabric 命令（或一系列命令）中，因为我们正在使用 Fabric 来处理其他一些东西，并且我想停用 shell 脚本。

运行`local('export FOO=bar')`不起作用：

```
$ fab set_default_env_vars
Using fabfile '/home/hugo/Projects/test/fabfile.py'
[localhost] local: export FOO=bar

Done.

$ echo $FOO

$ 
```

这是可能的 - 如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-05T04:14:42.677

您可以使用一个变量[`fabric.context_managers.shell_env`](http://docs.fabfile.org/en/1.5/api/core/context_managers.html#fabric.context_managers.shell_env)来`export`为您的 shell 以及由此产生的所有子 shell 进行 bash - 但这些变量不会持续存在于它们定义的 shell 之外（因此您不能从结构脚本为父 shell 设置环境变量你的例子有它的方式）。

您*可以*为本地环境设置一个 bash 脚本，该脚本与您[在生产 slug中](https://superuser.com/a/183980/11909)[添加的`~/.profile`](https://superuser.com/a/183980/11909)内容相同（在其键中，不一定是其值），并[`fabric.context_managers.prefix`](http://docs.fabfile.org/en/1.5/api/core/context_managers.html#fabric.context_managers.prefix)在运行本地命令之前用于获取该文件。

# d3.js - 在 D3.js 中合并节点

> ID：13713160
> 
> 赞同：0
> 
> 时间：2012-12-04T22:34:31.073
> 
> 标签：d3.js

我正在使用一个相互关联的概念数据库，我想在 D3 中进行可视化，但我也想让用户说，对于他们在这个数据库中的搜索，一些概念可能会被合并。例如，“良好的可视化”和“漂亮的视觉效果”实际上对他们来说可能意味着相同，并且希望看到他们合并的连接。

我会想象他们把一个拉到另一个，然后决定我是想让它成为父母、孩子还是同义词。在交互之后，用户只想看到一个节点，以及它们两个的聚合连接。理想情况下，我可以存储这些用户建立的连接，以便也能够为下一个用户提供。

D3 中是否已经为此开发了解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:17:59.393

d3 AFAIK 中没有这样的功能，但您可以实现它。

当用户指出某事是同义词或诸如此类的东西时，您将在模型级别进行更改（即在底层 json/csv 数据中），然后您将重新绑定修改后的数据以重新呈现可视化。

用于后续用户的数据持久化；您将修改后的位发布到您的服务器并将其存储在您的数据库中。

无论您使用的是 d3 还是其他任何东西，这些都是要遵循的模式。

# android - Android 服务：绑定还是启动？

> ID：13713161
> 
> 赞同：25
> 
> 时间：2012-12-04T22:34:32.133
> 
> 标签：android, service

什么情况下应该启动Service，什么情况下绑定Service？例如 - 音乐服务的 android 客户端？系统的优先级是否有任何差异；是否有共同的规则；还要别的吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-04T23:36:04.650

用于`startService()`启动后将独立运行的服务。音乐播放器就是一个很好的例子。这些运行直到他们打电话`stopSelf()`或有人打电话`stopService()`。

您可以通过来回发送 Intent 与正在运行的服务进行通信，但在大多数情况下，您只需启动服务并让它自行运行。

`bind()`当服务和客户端将通过持久连接来回通信时使用。一个很好的例子是导航服务，它将位置更新传输回客户端。Binder 比 Intent 更难编写，但它们确实是这个用例的必经之路。

关于优先级：当进程的所有活动都失去可见性时，如果该进程托管了一个以 启动的服务，则该进程将成为*服务进程*`onStart()`，否则将成为*后台进程*。服务进程的优先级高于后台进程。更多细节在[android 开发者网站](http://developer.android.com/guide/components/processes-and-threads.html#Lifecycle)。

如果没有可见活动的服务进程需要更高的优先级（例如，确实不应该中断的音乐播放器），则服务可以调用`startForeground()`.

# ruby - 如何测试与 Web 服务通信的 Ruby 命令行程序？

> ID：13713162
> 
> 赞同：4
> 
> 时间：2012-12-04T22:34:31.723
> 
> 标签：ruby, cucumber, aruba, webmock

我正在构建一个与 Web 服务通信的 Ruby 命令行程序。我正在使用 Cucumber 和 Aruba 来测试程序。问题是我需要控制从 Web 服务返回的数据；该程序会抓取用户评论流，因此随着新评论的添加，这可能会经常更改。我尝试使用 WebMock 模拟 Web 服务，但这不起作用，因为 Aruba 将命令行程序转为不受 WebMock 影响的单独进程（因此它仍然与*真正的*Web 服务通信）。

如何使用 Cucumber 测试该程序的输出？

* * *

编辑：Web 服务将流作为 JSON 数据返回。我已经捕获了用于测试的数据快照；简而言之，我正在寻找一种方法来替换我的静态数据来代替对 Web 服务的实际调用。

或者，如果有完全不同的方式来实现这个目标，我会全神贯注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-12T07:28:07.523

Aruba 提供了一种模式，可让您在“进程中”运行事物，从而允许您使用 WebMock 或 VCR。这是一篇博客文章，解释了如何做到这一点：

[http://georgemcintosh.com/vcr-and-aruba/](http://georgemcintosh.com/vcr-and-aruba/)

或者，您可以考虑编写一个新的二进制文件，首先加载 VCR 或 WebMock，然后加载并执行您的主二进制文件，并让您的测试运行这个二进制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T16:55:38.867

You could use vcr (cf. [https://github.com/vcr/vcr](https://github.com/vcr/vcr))

It will turn your json response into a fixture.

I will copy the beginning of their Readme so you can get the idea:

* * *

```
require 'rubygems'
require 'test/unit'
require 'vcr'

VCR.configure do |c|
  c.cassette_library_dir = 'fixtures/vcr_cassettes'
  c.hook_into :webmock # or :fakeweb
end

class VCRTest < Test::Unit::TestCase
  def test_example_dot_com
    VCR.use_cassette('synopsis') do
      response = Net::HTTP.get_response(URI('http://www.iana.org/domains/reserved'))
      assert_match /Example domains/, response.body
    end
  end
end 
```

Run this test once, and VCR will record the http request to fixtures/vcr_cassettes/synopsis.yml. Run it again, and VCR will replay the response from iana.org when the http request is made. This test is now fast (no real HTTP requests are made anymore), deterministic (the test will continue to pass, even if you are offline, or iana.org goes down for maintenance) and accurate (the response will contain the same headers and body you get from a real request).

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-04T22:43:14.803

命令行程序需要参数，所以我会编写程序以将 URL 作为指向您想要的任何服务的 arg。然后，我将使用不变的种子数据制作您的 Web 服务的测试版本。然后我会编写黄瓜测试以使用测试 URL 调用程序，并针对预期数据进行测试。

# python - 使用 contextlib.contextmanager 继承

> ID：13713172
> 
> 赞同：2
> 
> 时间：2012-12-04T22:35:26.647
> 
> 标签：python, contextmanager

给定一个班级

```
class SomeClass:
    @contextlib.contextmanager
    def on_connection(self, target_terminal, source_terminal):
        ...
        yield
        ... 
```

你如何继承它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:36:34.417

可以将`contextlib.contextmanager`模式与`with`块组合以引入超类的上下文管理器：

```
class SomeDerivedClass(SomeClass):
    @contextlib.contextmanager
    def on_connection(self, target_terminal, source_terminal):
        with super().on_connection(target_terminal, source_terminal):
            ...
            try:
                yield
            finally:
                ... 
```

# javascript - Jquery mobile：缩放以适应所有移动屏幕尺寸

> ID：13713180
> 
> 赞同：1
> 
> 时间：2012-12-04T22:36:03.823
> 
> 标签：javascript, jquery, jquery-mobile, mobile

我是 jquery mobile 的新手，但我有一个我似乎无法弄清楚的问题：

我设计了一个移动页面，它从上到下完全适合屏幕尺寸 800x480。当我在大小为 1280x720 的屏幕上测试此页面时，背景色必须填充大约三分之一的空间（页面底部到屏幕末尾）。

我怎样才能提取它，使其适合整个屏幕，就像它在 800x480 屏幕上一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T09:34:05.023

需要您的代码以获得更多解释。但是你仍然可以尝试使用

1) 标题

2) 内容

3) Jquery mobile 页面格式的页脚。

4) 然后包括它的 css & js。

根据您的要求自定义它们。希望这会有所帮助。

# c - 写入文件时，新行出现在旧行之前

> ID：13713182
> 
> 赞同：1
> 
> 时间：2012-12-04T22:36:07.457
> 
> 标签：c, file-io

在这个程序中，我试图在文件中输入文本数据，但它没有正确写入。

在我的主要，我得到数据的地方......

```
FILE *fp1 = NULL;
fp1 = fopen("accounts.dat", "a+");

printf ("\nEnter an account number (between 1000 and 5999): ");
        accounts[i] = validateaccount();

printf ("Enter title for new account %d: ", accounts2[i]);
        validatestring(accname, &i);
        scan(accounts, accname, &i); 
```

其中“validateaccount()”和“validatestring()”调用其他函数，这是我获取帐户/字符串值的地方。在里面

```
scan(accounts, accname, &i); 
```

我正在将验证函数给出的值写入我的文件中。

```
void scan (int accounts[MAX], char accname[MAX][MAXSTRING], int *i) {

FILE *fp1;

fp1 = fopen("accounts.dat", "a+");

fprintf(fp1, "%d", accounts[*i]);
fprintf(fp1, ":");
fprintf(fp1, "%s\n", accname[*i]);

} 
```

所以我的文件输入的格式应该是

```
1000:First
1200:Second 
```

如果我的帐号 # 是 1000，名字是“First”。而输入的第二个账号是1200，“第二个”

但我得到的是这样的：

```
1200:Second
1000:First 
```

当我'cat accounts.dat' ..第二个输入在我的第一个输入之前。为什么是这样？

* * *

问题是我在做

```
fp1 = fopen("accounts.dat", "a+"); 
```

每次我调用该函数时，我都可以在文件调用中传递参数，但在我摆脱它之后它可以正常工作。

解决它。

# c++ - QGLWidget：使用 setFormat() 启用多重采样 = 窗口不关闭

> ID：13713184
> 
> 赞同：1
> 
> 时间：2012-12-04T22:36:20.730
> 
> 标签：c++, qt, events, opengl

我正在使用 Qt4 在 OpenGL 中制作一个简单的三角形，它工作正常，直到我使用设置格式来启用多重采样。这是我的代码：

```
#include <QApplication>
#include <QtOpenGL>
// gl window class
class GLWindow : public QGLWidget
{
public:
    GLWindow(QWidget *parent = nullptr)
        : QGLWidget(parent){}
protected:
    // ALL THE FOLLOWING FUNCTIONS ARE OVERRIDDEN FROM QGLWIDGET 
    void initializeGL()
    {
        QGLFormat newFormat = this->format();
        newFormat.setSampleBuffers(true);
        newFormat.setSamples(16);
        this->setFormat(newFormat);
    }
    void resizeGL(int w, int h)
    {
        glViewport(0, 0, w, h);
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        glOrtho(-1, 1, -1, 1, -1, 1);
        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
    }
    void paintGL()
    {
        glClear(GL_COLOR_BUFFER_BIT);
        glBegin(GL_TRIANGLES);
            glColor3f(1, 0, 0);
            glVertex2f(0, 1);
            glColor3f(0, 1, 0);
            glVertex2f(1, -1);
            glColor3f(0, 0, 1);
            glVertex2f(-1, -1);
        glEnd();
    }
};
// main function
int main(int argc, char **argv)
{
    QApplication app(argc, argv);
    GLWindow window;
    window.resize(640, 480);
    window.show();
    return app.exec();
} 
```

在我在“initlializeGL”中添加格式内容之前，它工作正常（显然除了没有多重采样）。

然后，我添加格式的东西，窗口没有关闭。当我这么说的时候，我的意思是当我按下右上角的“X”按钮时它不会关闭，或者当我调用窗口的“close()”函数时它甚至不会关闭。

此外，当您按下“X”按钮（我检查过）时，它会调用“closeEvent（）”，但实际上没有关闭。我尝试在覆盖的“closeEvent()”函数中调用“close()”，但它什么也没做。

再一次，我删除了“initializeGL()”中的代码，然后它就正常关闭了。因此，我尝试将“initializeGL()”中的代码移动到构造函数中。多重采样有效，当我按“X”时它会关闭。伟大的！除了我在窗口关闭后得到这个：

![在此处输入图像描述](../Images/a83945a4deda136cc5f69107dfa672f7.png)

就是这样。简而言之：

*   当“initializeGL()”中没有“setFormat()”相关代码时，一切正常。
*   当我将“setFormat()”相关代码放入“initializeGL()”时，窗口不会关闭。
*   当我将“setFormat()”相关代码放入构造函数中时，窗口关闭时出现上图中显示的奇怪错误；

那么如何让窗口关闭，同时保持启用多重采样并且在窗口关闭后不会出现一些愚蠢的错误？

编辑：这是我的 .pro 文件中的文本

```
QT += core
QT += gui
QT += opengl

SOURCES += \
    main.cpp 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T00:40:03.477

您不应该调用`setFormat`from `initializeGL`，因为它会触发对`initializeGL`自身的调用。由于在 Qt 4.8`QGLWidget::setFormat`中已[过时](http://qt-project.org/doc/qt-4.8/qglwidget-obsolete.html)，因此您根本不应该使用它。

因此，首先尝试从构造函数调用`setFormat`，然后，如果它不起作用（或者即使它起作用），请尝试将格式传递给`QGLWidget`from的构造函数`main()`。

# sql - SQL 查询 - 当它 =1 时返回最大值

> ID：13713189
> 
> 赞同：2
> 
> 时间：2012-12-04T22:36:30.433
> 
> 标签：sql

我有一个这样的表格报告：

```
DBSCODE   RPTDATE     DBSSEQ
AAA       2012-01-31  1
AAA       2012-02-29  1
AAA       2012-02-29  2
AAA       2012-03-31  1
BBB       2012-01-31  1
BBB       2012-01-31  2 
```

我想返回每个`dbscode`for each的最大序列的详细信息`rptdate`。但是，我现在正在运行的查询仅在 max `dbsseq`> 1 时返回。

我正在执行：

```
select a.dbscode, a.rptdate, a.dbseq
from REPORTS as a 
inner join 
    (select rptdate, max(dbsseq) as 'Last'
    from REPORTS
    group by rptdate) as b
  on a.rprtdate = b.last 
```

我的结果是：

```
DBSCODE, RPTDATE, DBSSEQ
AAA, 2012-02-29, 2
BBB, 2012-01-31, 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:49:15.867

**更新**

我重新阅读了您的问题，我相信您正在寻找的是这个简单的查询..

```
SELECT 
  dbscode, rptdate, max(dbsseq)
FROM 
  REPORTS
GROUP BY
  dbscode, 
  rptdate 
```

**演示在** [http://sqlfiddle.com/#!3/b16ba/13](http://sqlfiddle.com/#!3/b16ba/13)

* * *

**初步答案**

~~在子查询中，您还需要按`DBSCODE`.~~

 ~~```
SELECT 
    a.dbscode, a.rptdate, a.dbsseq
FROM 
    REPORTS as a 
INNER JOIN
    (SELECT 
        dbscode, rptdate, MAX(dbsseq) AS 'Last'
    FROM 
        REPORTS
    GROUP BY dbscode, rptdate) as b
    ON a.dbsseq = b.last 
      AND a.dbscode = b.dbscode
      AND a.rptdate = b.rptdate 
```~~  ~~* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:48:49.663

```
select dbscode, 
       rptdate, 
       dbseq
from (
   select dbscode, rptdate, dbseq,
          row_number() over (partition by dbscode order by rptdate desc) as rn
    from reports
) t
where rn = 1; 
```

如果有多行具有相同的 rptdate，则只返回一个。如果您不希望那样，请使用`dense_rank()`而不是`row_number()`~~

# javascript - 圆形和矩形之间的 HTML5 Canvas 碰撞

> ID：13713190
> 
> 赞同：1
> 
> 时间：2012-12-04T22:36:32.027
> 
> 标签：javascript, html, canvas, html5-canvas

> **可能重复：**
> [Circle-Rectangle 碰撞检测（交叉点）](https://stackoverflow.com/questions/401847/circle-rectangle-collision-detection-intersection)
> [JavaScript 中直线和圆之间的碰撞检测](https://stackoverflow.com/questions/10957689/collision-detection-between-a-line-and-a-circle-in-javascript)

这比实际的工作代码更伪......

```
var dX = rectanlge.x - circle.x;
var dY = rectangle.y - circle.y;
var distance = Math.sqrt((dX*dX)+(dY*dY));
if(distance < circle.radius){
     //Collision
} 
```

到目前为止，这就是我在画布动画中检测圆形和矩形是否碰撞的全部内容。我显然错了，有人能指出我正确的方向吗？

```
rectangles = [];    
var rectangle = function(x,y,width,height){
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
        }; 
```

然后我会遍历这个数组

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:53:06.837

你会在那里找到非常好的算法：http: [//www.migapro.com/circle-and-rotated-rectangle-collision-detection/](http://www.migapro.com/circle-and-rotated-rectangle-collision-detection/)

# azure - 如何在 sql azure 上更新日期时间？

> ID：13713195
> 
> 赞同：2
> 
> 时间：2012-12-04T22:36:54.887
> 
> 标签：azure, azure-sql-database

我一直在尝试对 sql azure 数据库上的 datetime 列进行简单更新，但无济于事，不知道为什么它不起作用。

```
UPDATE MYDB
SET EndDate = CONVERT(datetime, '2012/12/04 24:00:00', 102)
where ItemId = 30
GO 
```

**错误：**将 varchar 数据类型转换为 datetime 数据类型导致值超出范围。该语句已终止。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T00:13:36.113

您的语法没问题 - 但 24:00:00 的时间值超出范围。如果您指的是午夜，请使用 00:00:00。

# email - 控制 cron 作业复杂性的方法或软件系统？

> ID：13713203
> 
> 赞同：3
> 
> 时间：2012-12-04T22:37:09.533
> 
> 标签：email, logging, automation, cron, analytics

在我的工作中，我们大量使用 cron 来自动化许多系统管理任务，从备份到报告生成。问题在于，我们的 50 多个 cron 作业系统的复杂性开始因自身的重量而崩溃。让我描述一下我们的设置：

*   约 15 名开发人员，其中一些负责通过他们的个人 crontab 运行的 cron 作业
*   30 多台机器，其中一些正在运行 cron 作业，有时由几个人运行
*   许多 cron 作业没有被记录，他们所有的 stdout 和 stderr 都被传送到 /dev/null （让我懊恼）
*   一些 cron 作业太嘈杂，吐出大量文本，使来自 cron 的电子邮件难以筛选
*   大多数 cron 作业（如果它们受到监控）会转到群组电子邮件别名，因此许多人看到与他们无关的消息并习惯于忽略它们
*   经常 cron 作业失败，我们没有及时注意到
*   我们的备份系统正在跟踪一些 cron 作业，而另一些则没有。没有源代码控制。
*   当我们的一台服务器出现故障时，这意味着存储在该机器上用户的 crontab 文件中的任何 cron 作业都不会运行，而且我们没有意识到 cron 作业无法运行

理想情况下，我们需要一个设置或软件系统，其中：

*   任何开发人员都可以轻松进入并调整/修复 cron-job，而不是将其限制为个人 crontab
*   对 cron 作业在哪台机器上运行具有灵活性，即使 crontab 以某种方式集中在特定机器上
*   所有成功的 cron 作业运行都被简洁地记录下来，所以我们知道发生了一些事情
*   所有错误都被捕获并根据错误消息和 cron 作业报告给相关开发人员的细粒度列表
*   可以将用户设置为监视某些 cron 作业，无论它们是成功还是失败
*   用户可以收到一份摘要（电子邮件或网页），详细说明在特定时间窗口内哪些作业失败以及哪些作业成功
*   [使用RRDtool](http://oss.oetiker.ch/rrdtool/)之类的工具记录 cron 作业统计信息（运行时间、退出状态、输出量）以进行分析
    *   健壮性：一台服务器宕机不会破坏整个 cron 作业系统

在网上搜索，我看到一些关于[“cron 作业最佳实践”](http://blog.endpoint.com/2008/12/best-practices-for-cron.html)的讨论，但它似乎只解决了我们的一些要求。在对其中一些功能的软件支持方面，似乎有 cronic、shush 和 cronwrap 之类的工具（对不起，我是新用户，仅限于 2 个超链接）。我敢肯定还有更多我想念的。

似乎我可以编写这样的代码，但似乎肯定已经创建了这样的东西。任何关于现有系统/方法的建议，或关于如何构建这样一个系统的指针，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:59:22.943

我不是这个主题的专家，但我希望这可以帮助你，我最近听说了这项新技术：

[作业调度程序](http://en.wikipedia.org/wiki/Job_scheduler)、[工作负载自动化](http://en.wikipedia.org/wiki/Workload_Automation)解决方案以及此[作业调度程序软件列表](http://en.wikipedia.org/wiki/List_of_job_scheduler_software)。

实际上我对此一无所知，但我认为这个作业调度程序和工作负载自动化软件是用于 SOA 或企业集成架构的企业级作业调度程序，通常可以与 ERP 系统集成。

老实说，我必须承认，我不确定这项技术是否适合您的需求，您必须对此主题进行深入研究，我希望此回复扩大您的“解决方案全景”。

# ruby-on-rails-3 - Ruby on Rails 使用视图中的值/变量创建新记录

> ID：13713208
> 
> 赞同：1
> 
> 时间：2012-12-04T22:37:30.860
> 
> 标签：ruby-on-rails-3, web-applications, activerecord, actioncontroller

我正在使用 RoR 3.2.9。感谢这里的帮助，我设法完成了一些事情！现在我正在尝试从视图中的 button_to 创建新记录：

```
<%= button_to "Do IT", :controller => :apos, 
                           :method => :match %> 
```

控制器如下所示：

```
class AposController < ApplicationController

...

def new
-> standard
end

def create
-> standard
end

def match
    #@apo = Apo.new(:auftrnr => $aktuelleID, :artikelnummer => @artikel.artikelnummer, :beschreibung => @artikel.name, :menge => 0)
    #@apo = Apo.new(:auftrnr => 2)
    @user = User.new do |apo|
        apo.auftrnr = 1
        apo.artikelnummer = 1
    end
    @apo.save
  end
end 
```

新纪录的创造奏效了。但奇怪的第一件事是，我收到了消息：

*Apo 已成功创建。*

...这是在控制器的创建方法中定义的（我没有调用它，是吗？）好吧，然后记录被创建为空，尽管我尝试用一​​些值创建它（尝试了 3 种可能性，你可以见上文，所以我认为这不是 ActiveRecord 语法错误）

*Apo 已成功创建。Auftragsnummer：15

扎隆萨：

银行交易：

利弗拉德雷斯：

开始购物

编辑 | 后退*

（'15' 是这个类的 ID）

我期待这个新创建的记录中有一些内容:-(

我尝试在其他控制器中定义方法并获得相同的结果。知道我又做错了什么吗？

太棒了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:39:42.367

改变

```
:controller => :apos, :method => :match 
```

至

```
:controller => :apos, :action=> :match 
```

并确保您保存实际记录 - 您当前`@apo`在构建记录时将变量保存为`@user`

# c# - 使用三元运算符的字符串连接

> ID：13713212
> 
> 赞同：10
> 
> 时间：2012-12-04T22:37:42.937
> 
> 标签：c#, asp.net-mvc

我正在创建`SelectList`各种联系人。我希望显示的文本是`FirstName`, `MiddleInit`（如果可能的话）和`LastName`.

```
IEnumerable<SelectListItem> items = contacts
.Select(r => new SelectListItem()
{
    Value = r.ContactID.ToString(),
    Text = r.FirstName + " " 
    + string.IsNullOrEmpty(r.MiddleInit) ? r.MiddleInit + ". " : ""
    + r.LastName
}); 
```

我收到错误消息：

```
Error   4   Cannot implicitly convert type 'string' to 'bool'   C:\Users\cu551d\Documents\Visual Studio 2010\Projects\WVM\WVM\Controllers\SOWController.cs  181 15  WVM 
```

我猜这与我的语法有关。我可以在 C# 中做这样的事情吗？

另外，我应该包括一个`Trim()`声明`MiddleInit`吗？我认为这个错误很奇怪`IsNullOrEmpty`，实际上返回一个布尔值。我也试过`(string.IsNullOrEmpty(r.MiddleInit) == true ) ..`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-04T22:41:23.877

尝试在括号中分组。看起来您正在向后执行条件运算符：

```
IEnumerable<SelectListItem> items = contacts
.Select(r => new SelectListItem()
{
    Value = r.ContactID.ToString(),
    Text = r.FirstName + " " +
        (string.IsNullOrEmpty(r.MiddleInit) ? "" : (r.MiddleInit + ". ")) +
        r.LastName
}); 
```

### 另一种技术

由于无论如何您都将其转换为空字符串，因此您也可以考虑这一点：

```
Text = r.FirstName + " " + (r.MiddleInit ?? "") + r.LastName 
```

被`??`称为`Null Coalescing Operator`. 如果该值不为空，它将返回左侧的任何内容，否则返回右侧的任何内容。

[http://msdn.microsoft.com/en-us/library/ms173224.aspx](http://msdn.microsoft.com/en-us/library/ms173224.aspx)

**编辑**：虽然更干净，但这对您的情况不太适用，因为您需要初始时间之后的时间。但请注意它确实存在！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-04T22:42:01.143

问题是由于运算符优先级导致编译器以您不期望的方式解析表达式。只需将三元表达式包装在括号中即可礼貌地向编译器解释您的意思。

作为旁注，查看表达式的逻辑，我认为结果项的顺序不正确。我已经在下面的代码中切换了它们。

```
IEnumerable<SelectListItem> items = contacts
.Select(r => new SelectListItem()
{
    Value = r.ContactID.ToString(),
    Text = r.FirstName + " " 
    + (string.IsNullOrEmpty(r.MiddleInit) ? "" : r.MiddleInit + ". ")
    + r.LastName
}); 
```

**更多解释**

没有`(`,`+`的优先级高于`?:`，因此您问题中的表达式正在被解析，就好像它说：

```
Test = (r.FirstName + " " + string.IsNullOrEmpty(r.MiddleInit)) ? (r.MiddleInit + ". ") : ("" + r.LastName) 
```

所以你的错误的根源是`?:`运算符的条件部分实际上是一个字符串 - 它将包含类似“Andrew true”的内容。另请注意，`r.LastName`gets 与运算符的第三项相结合`?:`。

**Trim() 问题**

如果有`r.MiddleInit`可能包含空格，那么 using`Trim()`会有所帮助，但最好将测试更改为`String.IsNullOrWhiteSpace(r.MiddleInit)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T22:43:13.317

尝试将你的论点包装在你的三元组中

```
IEnumerable<SelectListItem> items = contacts
.Select(r => new SelectListItem()
{
    Value = r.ContactID.ToString(),
    Text = r.FirstName + " " 
    + (string.IsNullOrEmpty(r.MiddleInit) ? (r.MiddleInit + ". ") : ("" + r.LastName))
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-04T22:57:09.773

你不需要包装参数，只需要三元......

```
IEnumerable<SelectListItem> items = contacts
.Select(r => new SelectListItem()
{
    Value = r.ContactID.ToString(),
    Text = r.FirstName + " " 
    + (string.IsNullOrEmpty(r.MiddleInit) ? r.MiddleInit + ". " : "")
    + r.LastName
}); 
```

我通过尝试发现我实际上需要...

```
(!string.IsNullOrEmpty(r.MiddleInit) ? r.MiddleInit + ". " : "") 
```

让它正常工作。

# asp.net - 在 asp.net 中禁用 csrf 保护

> ID：13713219
> 
> 赞同：1
> 
> 时间：2012-12-04T22:38:06.380
> 
> 标签：asp.net, web-applications, cross-browser, csrf

我开发了一个 Web 应用程序，该应用程序已发布到生产环境中，并且在公司的 Intranet 中有一个链接。现在他们正试图将其发送到移动设备，但 Intranet 团队回来告诉我禁用 CSRF 保护作为应用程序仅在公司内部使用，因此没有巨大的风险。那么我该怎么做呢？请帮忙。我的应用程序是使用 c#,asp.net,sql,javascript,ajax 开发的

谢谢

# c++ - 继承和隐藏父属性

> ID：13713222
> 
> 赞同：0
> 
> 时间：2012-12-04T22:38:17.730
> 
> 标签：c++, inheritance, attributes, virtual, using-declaration

做这样的事情合理吗？

注意：这是一个最小的工作示例

```
class A {
    public:
        int getX() { return x; }
    protected:
        int x;
        virtual void setX(int newX) = 0;
};

// Children can modify X
class Can_Modify_X : public A {
     protected:
         void setX(int newX) { x = newX; }
     private:
         using A::x;
};

// Children can't modify X
class Can_Not_Modify_X : public A {
     private:
         void setX(int newX) { }
         using A::x;
}; 
```

我知道我[不能简单地隐藏](https://stackoverflow.com/questions/4908539/a-way-in-c-to-hide-a-specific-function)一个函数，因为这会违反 Liskov 原则，但是进行`private`继承并再次指定所有公共方法似乎真的是多余的。

这两个类必须有一个共同的父类（即使它直接是其中之一），并且不能`x`直接修改。

`using`奖金：有人可以指出我在这种情况下定义确切行为的地方吗？我尝试用谷歌搜索它，但收效甚微。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:48:36.717

> 我知道我不能简单地隐藏一个函数，因为这会违反 Liskov 原则。

完全相同的概念适用于数据成员。

假设您有一个指向 or 实例的指针（或引用`Can_Modify_X`）`Can_Not_Modify_X`。您`x`不能通过此引用访问或修改数据成员。如果你将这个派生类指针向上转换为指向类的指针，`A`你突然可以修改数据成员`x`。通过设为`x`私有，您违反了 Liskov 替换原则。`x`是数据成员、成员函数还是类型定义都没有关系。你违反了 Liskov 替换，纯粹而简单。

派生类不应隐藏父类提供的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:06:46.687

这是一个主观的问题，所以我的回答也相应地是主观的。

我要说不，这不合理。`protected`属性使子类很容易意外地改变状态并违反不变量，因此我建议完全避免它们。然后，您的父类将`x`通过其公共或受保护的接口进行维护（希望通过一组有意义的方法，而不仅仅是修改器）。

然后，您无需更改子项的可访问性，因为您的界面已经适当地控制了访问。

不仅如此，更改成员或方法的可访问性违反了最小意外原则，并且很可能会给您未来的维护者带来问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:41:56.777

您希望以下代码做什么？

```
A * a = new Can_Not_Modify_X();
a->setX(10); 
```

# java - JAVA-SQL- 数据迁移 - 比较失败的 JUnit 测试的结果集

> ID：13713223
> 
> 赞同：0
> 
> 时间：2012-12-04T22:38:24.893
> 
> 标签：java, sql, jdbc, data-migration

我不能让这个 JUnit 测试通过我的生活。有人可以指出哪里出了问题。我正在进行数据迁移（MSSQL SERVER 2005），但我的 sourceDBUrl 和 targetDCUrl 具有相同的 URL，以便将其缩小到语法错误。这就是我所拥有的，一个语法错误。我正在比较查询表的结果

```
SELECT programmeapproval, resourceapproval FROM tr_timesheet WHERE timesheetid = ? 
```

并且测试总是失败，但通过了我开发的其他junit测试。我创建了 3 个不同的 resultSetsEqual 方法，但没有一个工作。然而，我开发的其他一些 JUnit 测试已经通过。查询：

**从 tr_timesheet 中选择 timesheetid、programapproval、resourceapproval**

**返回三列**

*   **timesheetid** (PK,int, not null) (填充数字 2240 - 2282)
*   **programapproval** (smallint,not null) （在每个字段中填充数字 1）
*   **resourceapproval** （smallint，not null）（在每个字段中填充数字 1）

当我运行嵌入在代码中的查询时，它只返回一行，其中包含 programapproval 和 resourceapproval 列，并且两个字段都填充了数字 1。

我已正确安装并测试了所有 jdbc 驱动程序的连接性。根据 IDE，此时 JUnit 测试失败。

```
assertTrue(helper.resultSetsEqual2(sourceVal,targetVal)); 
```

**这是代码：**

/ ****这是一个JUNIT类*******？

```
package a7.unittests.dao;

import static org.junit.Assert.assertTrue;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Types;
import org.junit.Test;
import artemispm.tritonalerts.TimesheetAlert;

public class UnitTestTimesheetAlert {

@Test
public void testQUERY_CHECKALERT() throws Exception{

UnitTestHelper helper = new UnitTestHelper();
Connection con = helper.getConnection(helper.sourceDBUrl);
Connection conTarget = helper.getConnection(helper.targetDBUrl);

PreparedStatement stmt = con.prepareStatement("select programmeapproval, resourceapproval from tr_timesheet where timesheetid = ?");
stmt.setInt(1, 2240);
ResultSet sourceVal = stmt.executeQuery();

stmt = conTarget.prepareStatement("select programmeapproval, resourceapproval from tr_timesheet where timesheetid = ?");
stmt.setInt(1,2240);
ResultSet targetVal = stmt.executeQuery();
assertTrue(helper.resultSetsEqual2(sourceVal,targetVal));
}} 
```

/ ********结束********* / **_**

/ ****这是一个普通班***** /

```
package a7.unittests.dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;

public class UnitTestHelper {

static String sourceDBUrl = "jdbc:sqlserver://127.0.0.1:1433;databaseName=a7itm;user=a7user;password=a7user";
static String targetDBUrl = "jdbc:sqlserver://127.0.0.1:1433;databaseName=a7itm;user=a7user;password=a7user";

public Connection getConnection(String url)throws Exception{
    return DriverManager.getConnection(url);
}
public boolean resultSetsEqual3 (ResultSet rs1, ResultSet rs2) throws SQLException {
    int col = 1;
    //ResultSetMetaData metadata = rs1.getMetaData();
    //int count = metadata.getColumnCount();
    while (rs1.next() && rs2.next()) {
        final Object res1 = rs1.getObject(col);
        final Object res2 = rs2.getObject(col);
        // Check values
        if (!res1.equals(res2)) {
            throw new RuntimeException(String.format("%s and %s aren't equal at common position %d",
                res1, res2, col));
        }

        // rs1 and rs2 must reach last row in the same iteration
        if ((rs1.isLast() != rs2.isLast())) {
            throw new RuntimeException("The two ResultSets contains different number of columns!");
        }

    }
    return true;
}
public boolean resultSetsEqual (ResultSet source, ResultSet target) throws SQLException{
    while(source.next())
    {
        target.next();
        ResultSetMetaData metadata = source.getMetaData();
        int count = metadata.getColumnCount();
        for (int i =1; i<=count; i++)
        {
            if(source.getObject(i) != target.getObject(i))
            {

                return false;

            }

        }

    }

    return true;
}

public boolean resultSetsEqual2 (ResultSet source, ResultSet target) throws SQLException{
    while(source.next())
    {
        target.next();
        ResultSetMetaData metadata = source.getMetaData();
        int count = metadata.getColumnCount();
        for (int i =1; i<=count; i++)
        {
            if(source.getObject(i).equals(target.getObject(i)))
            {

                return false;

            }

        }

    }

    return true;
}
} 
```

/***结束*** ***** /

/ ****粘贴新课程 - 这是一个 JUNIT 测试课程**** /

```
package a7.unittests.dao;

import static org.junit.Assert.*;
import java.sql.Connection;
import java.sql.DriverManager;
import org.junit.Test;

public class TestDatabaseConnection {

@Test

public void testConnection() throws Exception{

    UnitTestHelper helper = new UnitTestHelper();
    Connection con = helper.getConnection(helper.sourceDBUrl);
    Connection conTarget = helper.getConnection(helper.targetDBUrl);
    assertTrue(con != null && conTarget != null);

} 
```

}

/ *****结束****** /

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T22:57:20.460

`false`当物体`equal`彼此接近时，你回来了。在这种方法中，我将条件更改为`not equals`.

```
public boolean resultSetsEqual2 (ResultSet source, ResultSet target) throws SQLException{
    while(source.next())
    {
        target.next();
        ResultSetMetaData metadata = source.getMetaData();
        int count = metadata.getColumnCount();
        for (int i =1; i<=count; i++)
        {
             if(!source.getObject(i).equals(target.getObject(i))) //added !
             {
                  return false;
             }
        }
    }
    return true;
} 
```

# cocos2d-iphone - 如何将 CCLayerColor 及其子项淡化为给定的不透明度？Cocos2d

> ID：13713224
> 
> 赞同：0
> 
> 时间：2012-12-04T22:38:25.933
> 
> 标签：cocos2d-iphone, opacity, cclayer

我试图弄清楚如何将图层及其子级淡化为给定的不透明度。这就是我正在做的事情。

```
 - (id)init
    {

        if( (self=[super initWithColor:ccc4(0, 0, 255, 255)] )) {

            CCSprite *background = [CCSprite spriteWithFile:@"LevelsBackGround.png"];
            background.position = ccp([UIScreen mainScreen].bounds.size.height * .5f ,160);
            [self addChild:background];

            CCSprite *text = [CCSprite spriteWithFile:@"SwipeText.png"];
            text.position = ccp([UIScreen mainScreen].bounds.size.height *.5, 17);
            [self addChild:text];

            sceneText = [CCLabelTTF labelWithString:@"Yard" fontName:@"Baskerville-Bold" fontSize:20];
            sceneText.position = ccp([UIScreen mainScreen].bounds.size.height *.5, 300);
            sceneText.color = ccc3(172, 169, 164);
            [self addChild:sceneText];

        [self performSelector:@selector(LaunchLevel:) withObject:nil afterDelay:2.f];

}
    - (void ) LaunchLevel: (id) sender {

        [self runAction:[CCFadeTo actionWithDuration:.5 opacity:127]];
    } 
```

但这似乎没有任何作用。如果我删除背景精灵以查看我设置图层的蓝色然后构建它，那么蓝色背景会完全褪色。所以我的问题是，为什么淡出所有图层子级不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-27T00:31:57.103

从 Cocos2d-x v3-ish 开始（我使用的是 v3.4）；如果您`Sprite`要向 a 添加多个 s，`Layer`您现在可以在图层上设置一个标志，以指示不透明度应该使用以下命令级联到其各自的子级：

```
local layer = cc.Layer:create()
layer:addChild(cc.Sprite("hero-dude.png"))
layer:setCascadeOpacityEnabled(true)
layer:runAction(cc.FadeTo:create(0.5, 127)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-31T06:25:05.320

递归设置孩子的不透明度并不能很好地渲染（“不透明度重叠”效果）。

如果您想“作为一个整体”淡化整个节点层次结构，您可以使用`CCRenderTexture`（渲染您的节点图并将其淡化为单个图像）。

而且，如果您的孩子以某种方式动画，您需要`CCRenderTexture`经常更新您的（相当消耗 CPU）。

更多细节在这里：http: [//2sa-studio.blogspot.com/2013/01/fading-node-hierarchy-with.html](http://2sa-studio.blogspot.com/2013/01/fading-node-hierarchy-with.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-04T22:55:28.047

opacity 属性不会传播给孩子。如果你愿意，你可以重写 setOpacity 方法：

```
// in your .h file, an iVar 

GLubyte _opacity;

// in you .m, the overrides

- (void)setOpacity:(GLubyte)opacity {

    for (id child in self.children) {
        id <CCRGBAProtocol> opaqueChild = (id <CCRGBAProtocol>) child;
        if ([opaqueChild respondsToSelector:@selector(setOpacity:)]) {
            opaqueChild.opacity = opacity;
        } else {
            // you must decide here what to do for your own situation
            // and the children you are likely to have in there
        }
    }
    _opacity = opacity;
}

- (GLubyte)opacity {
    return _opacity;
} 
```

编辑：扩展一个 CCLayerColor （这个编译，并没有实际测试它，但应该工作）。只需将其添加到您的 .m 文件（您的类的实现）中：

```
- (void)setOpacity:(GLubyte)opacity {

    for (id child in self.children) {
        id <CCRGBAProtocol> opaqueChild = (id <CCRGBAProtocol>) child;
        if ([opaqueChild respondsToSelector:@selector(setOpacity:)]) {
            opaqueChild.opacity = opacity;
        } else {
            // you must decide here what to do for your own situation
            // and the children you are likely to have in there
        }
    }
    [super setOpacity:opacity];
} 
```

# php - 在 javascript 中为 php 获取 Checkbox[] 值

> ID：13713227
> 
> 赞同：2
> 
> 时间：2012-12-04T22:38:30.840
> 
> 标签：php, javascript, checkboxlist

我在检查复选框中的值时遇到问题。我试图清理代码。

我已经能够选择所有选定的复选框（不是每行），或者我可以获得每行的复选框 ID，但不能获得选定的值。我很确定我可以将这些值转移到另一个页面，但不知道如何获取它们。

在这里的任何帮助将不胜感激！

```
 //php variables used
 $pages = 2
 $size = 4 
```

```
 <form id="form" name="cb">
  <div style=" width:800px; height:500px; overflow:auto">
  <h2>Select Editions</h2>
  <table id='table' name='table' border=1 cellpadding=7 width=50% height=50% align='center'>\n 
```

```
 for($x = 1; $x <= $pages; $x++) :
      print "<td id='page_$x' class='page_button' align='center' custom='0' >Page $x - ";
        for($i = 1; $i <= $size; $i++) :
          print "<input type='checkbox' class='ebutton' id='etype_$x' name='checks[]' value='$i' /> $i";
        endfor; 
```

```
 </td>
      </tr> 
```

```
 //php end for loop
    endfor; 
```

```
 </div>
  </form> 
```

这是基于复选框类的类更新的Javascript

```
 $(document).ready(function() {
      $(".ebutton").change(function() {

        var idp = $(this).attr("id").split("_");
        var page_num = idp[1];

        //  I need to find out how to get the checkboxes that are checked per row. Ex: 01,02
        //var editions = ?;
        //alert(editions);

        var hidden_id = "#etype_page_" + page_num;
          if($(hidden_id).length < 1) {
            $("#base").append('<input type="hidden" id="etype_page_'+ page_num +'" name="'+ page_num +'"  value="'+ editions +'" class="hidden_edtype" custom="' + editions +'">');
          } else {
            $(hidden_id).val($(this).val());
          }
        update_eShow();
      });
    });

    function update_eShow() {
      $("#eShow").html('');
        $(".hidden_edtype").each(function() {
         var page = $(this).attr("name");
         var value = $(this).attr("custom");
         $("#eShow").append('page:' + page + ' values:' + value +'<br>');
      });
    } 
```

页面如下所示：

## | 第 1 页 - []1 []2 []3 []4 |

## | 第 2 页 - []1 []2 []3 []4 |

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:34:07.367

现在，知道这是一个将支票发送给父母的弹出窗口......

进行如下检查：

```
print "<input type='checkbox' class='ebutton checks$x' id='etype_$x' name='checks".$x."[]' value='$i' /> $i"; 
```

将第 1 页的支票类别设为“checks1”，将第 2 页的支票类别设为“checks2”，...

并得到检查：

```
 var page_num = idp[1];
 var checks=$('checks'+page_num).attr('checked',true); //to get all checked checkboxes of the class checks+page_num
 var editions="";
 checks.each(function(ch) {
     editions+=$(ch).val()+',';
 } 
```

并且 editions 具有该页面的所有检查值，由“，”分隔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:48:02.887

名称应该有不同的数字，以它应该是唯一的形式发送的名称，就像您的 id 一样。

尝试将名称设置为 id ：`name='etype_$x'`

然后使用调试控制台（如果使用 chrome hit f12）然后去网络并可视化在表单中发送的变量和值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:50:16.983

```
var $editions = $("#page_"+page_num+" input[checked=checked]");
var editions = [];
$editions.each(function(input) {
  editions.push($(input).val());
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T22:50:53.457

您不需要 javascript 将复选框发送到 php

您可以将检查命名为`checks[$page][]`：

```
print "<input type='checkbox' class='ebutton' id='etype_$x' name='checks[$x][]' value='$i' /> $i"; 
```

在您的操作页面中，您将在 $_POST(pr $_GET)["checks"][1] 中拥有一个数组，其中包含为第 1 页检查的值（如果有）

# r - 在 R 中使用列作为组

> ID：13713228
> 
> 赞同：0
> 
> 时间：2012-12-04T22:38:36.340
> 
> 标签：r

我的数据安排如下。我的组在列中，下面说明了两个组。我的实际数据集包含大约 15 个配对变量。

如何在 R 中操作这些数据（导入的 csv），以便比较两组？例如，如果我想制作一个条形图（使用`sciplot`库）`bargraph.CI (var_x, group, data=mydata)`，我怎样才能让这些列用作组？

```
Time var_x var_y var_x_2 var_y_2 var_z var_z_2 
10:00 2 5 .33 .36 1.1 1.5
10:01 2 6 .34 .35 1.2 1.4
etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:11:11.380

Here's an answer using `reshape`in base，但我确信有多种方法可以解决这个问题。

首先，重新创建测试数据：

```
test <- read.table(header=TRUE,textConnection("Time var_x var_y var_x_2 var_y_2 var_z var_z_2 
10:00 2 5 .33 .36 1.1 1.5
10:01 2 6 .34 .35 1.2 1.4"))

> test
   Time var_x var_y var_x_2 var_y_2 var_z var_z_2
1 10:00     2     5    0.33    0.36   1.1     1.5
2 10:01     2     6    0.34    0.35   1.2     1.4 
```

重塑数据并保存到新的 data.frame

```
testreshape <- reshape(test,
                   idvar="Time",
                   varying=list(c("var_x","var_x_2"),
                                c("var_y","var_y_2"),
                                c("var_z","var_z_2")),
                   v.names=c("var_x",  "var_y", "var_z"),
                   direction="long")
> testreshape
         Time time var_x var_y var_z
10:00.1 10:00    1  2.00  5.00   1.1
10:01.1 10:01    1  2.00  6.00   1.2
10:00.2 10:00    2  0.33  0.36   1.5
10:01.2 10:01    2  0.34  0.35   1.4 
```

运行条形图代码：

```
library(sciplot)
bargraph.CI(var_x, time, data=testreshape) 
```

# ajax - Magento - AJAX 将产品页面元素调用到类别页面。选择未填充的框

> ID：13713231
> 
> 赞同：0
> 
> 时间：2012-12-04T22:38:47.100
> 
> 标签：ajax, magento, jquery, magento-1.5

我正在尝试在我的 Magento 商店中创建一个 ajax '快速视图' 或 '快速购物车' 类型的功能。将鼠标悬停在产品上并可以选择在灯箱中“快速查看”它而不是转到产品页面的那种。

我正在使用一个非常简单的 jQuery Ajax 调用，如下所示：

```
$j('#ajaxquickviewcontent').load("http://websiteaddress/category/productname.html .product-view").ajaxComplete(function(){alert ('Done');}); 
```

使用这种方法，我得到了我想要的所有内容（即产品图片、描述、可配置的属性选项（尺寸）下拉列表、数量选择器和添加到购物车按钮） - 但属性选项（尺寸）下拉列表未填充任何内容。我只是得到下拉菜单，但没有选项，显然无法将任何产品添加到购物车。

如果我更改调用以加载整个产品页面，例如

```
$j('#ajaxquickviewcontent').load("http://websiteaddress/category/productname.html").ajaxComplete(function(){alert ('Done');}); 
```

然后下拉确实有大小。我假设页面上可能有一些我应该加载的 javascript，但我找不到它。

任何人都可以为我指出正确的方向，因为我会错过产品基本 div 之外的脚本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:10:15.713

看一看 @

[Magento 快速查看 Ajax 加载器](https://github.com/czettnersandor/magento-quick-view-ajax)

[http://ecommercedeveloper.com/articles/1875-create-a-quick-view-for-product-images/](http://ecommercedeveloper.com/articles/1875-create-a-quick-view-for-product-images/)

# domain-driven-design - 在领域驱动设计中正确使用规范类

> ID：13713237
> 
> 赞同：4
> 
> 时间：2012-12-04T22:39:11.983
> 
> 标签：domain-driven-design

我正在使用 DDD 构建一个应用程序，但是我很难理解你应该在哪里实例化规范类或使用它们。

我的应用大量使用预订窗口，因此我有一个规范，可确保即将添加到聚合中的预订窗口不会与当前处于聚合中的另一个窗口重叠。像下面这样。

```
 /// <summary>
/// A specification that determines if the window passed in collides with other windows.
/// </summary>
public class BookingTemplateWindowDoesNotCollideSpecification : ISpecification<BookingScheduleTemplateWindow>
{
    /// <summary>
    /// The other windows to check the passed in window against.
    /// </summary>
    private readonly IEnumerable<BookingScheduleTemplateWindow> otherWindows;

    /// <summary>
    /// Initializes a new instance of the <see cref="BookingTemplateWindowDoesNotCollideSpecification" /> class.
    /// </summary>
    /// <param name="otherWindows">The other windows.</param>
    public BookingTemplateWindowDoesNotCollideSpecification(IEnumerable<BookingScheduleTemplateWindow> otherWindows)
    {
        this.otherWindows = otherWindows;
    }

    /// <summary>
    /// Determines whether the window passed in collides with other windows held inside this class.
    /// </summary>
    /// <param name="obj">The obj.</param>
    /// <returns>
    ///  <c>true</c> if [is satisfied by] [the specified obj]; otherwise, <c>false</c>.
    /// </returns>
    public bool IsSatisfiedBy(BookingScheduleTemplateWindow obj)
    {
        return !this.otherWindows.Any(w => obj.DayOfWeek == w.DayOfWeek && w.WindowPeriod.IsOverlap(obj.WindowPeriod));
    }
} 
```

然后我有一个聚合方法，允许使用规范添加新窗口。已经持久化的聚合窗口被传递到规范构造函数中。

```
 public virtual void AddWindow(DayOfWeek dayOfWeek, int startTime, int endTime)
    {
        var nonCollidingWindowSpecification = new BookingTemplateWindowDoesNotCollideSpecification(this.Windows);
        var bookingWindow = new BookingScheduleTemplateWindow(this){
                                                                       DayOfWeek = dayOfWeek,
                                                                       WindowPeriod = new Range<int>(startTime, endTime)
                                                                   };

        if (nonCollidingWindowSpecification.IsSatisfiedBy(bookingWindow))
        {
            this.Windows.Add(bookingWindow);
        }
    } 
```

我正在苦苦挣扎的是，我的一部分认为我应该将此规范注入到类中，而不是直接实例化（作为我的应用程序的一般规则，而不仅仅是在这种情况下），因为规范的类型可能需要根据实体的状态而改变。但是从 MVC 层注入规范感觉很脏，就好像我稍后有另一个应用程序接口（如 REST API）然后重复使用哪个规范的逻辑。

您如何确保所使用的规范保持灵活，同时确保有关使用哪个规范的逻辑不会在另一个应用程序界面中重复。

在这种情况下，您是否希望将工厂注入实体并从那里返回规范，从而不允许域逻辑溢出到更高层？还是有更好/更清洁/更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T15:47:27.307

将域服务注入实体是完全可以接受的。最好在聚合的相应方法中将对服务的依赖项明确作为参数。例如，该`AddWindow`方法可能如下所示：

```
 public virtual void AddWindow(ISpecification<BookingScheduleTemplateWindow> nonCollidingWindowSpecification, DayOfWeek dayOfWeek, int startTime, int endTime)
  {
        var bookingWindow = new BookingScheduleTemplateWindow(this){
                                                                       DayOfWeek = dayOfWeek,
                                                                       WindowPeriod = new Range<int>(startTime, endTime)
                                                                   };

        if (nonCollidingWindowSpecification.IsSatisfiedBy(bookingWindow))
        {
            this.Windows.Add(bookingWindow);
        }
    } 
```

在这种情况下，规范充当域服务。现在由周围的基础设施来通过适当的规范。这就是应用程序服务的用武之地。应用程序服务在您的领域层上建立一个外观，并包含特定用例的方法。反过来，该应用程序服务将被控制器引用。也可以让控制器传递所需的依赖关系，但是应用程序服务提供的封装可能是有益的。

示例应用程序服务代码：

```
public class AddWindow(string aggregateId, DayOfWeek dayOfWeek, int startTime, int endTime)
{
    var aggregate = this.repository.Get(aggregateId);
    var specification = // instantiate specification
    aggregate.AddWindow(specification, dayOfWeek, startTime, endTime);
    this.repository.Commit();
} 
```

这是典型的应用程序服务代码：获取适当的聚合，实例化所需的依赖项（如果有），并调用聚合上的行为。

# iphone - 传递数据供 iOS 模拟器在运行时使用

> ID：13713239
> 
> 赞同：1
> 
> 时间：2012-12-04T22:39:30.577
> 
> 标签：iphone, xcode, ios-simulator

当我在模拟器中运行应用程序时，我可以获得应用程序安装目录的环境变量吗？这是目前为我安装的位置，但iOS版本和GUID（即'112318C3-A508-482D-9A1D-0A55B3B16FDB'）会改变，我想在构建后将它作为变量。

`/Library/Application Support/iPhone Simulator/6.0/Applications/112318C3-A508-482D-9A1D-0A55B3B16FDB`

如果没有办法将其作为环境变量，我可以只获取它命名目录的 GUID 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T04:01:52.897

你能解释一下你想要完成的事情吗？

我不确定包含该路径的环境变量，但是您可以在应用程序中添加以下方法并打印它的输出以查看应用程序文档目录的路径（这是您要查找的路径内的文件夹）。

```
// Returns the URL to the application's Documents directory.
- (NSURL *)applicationDocumentsDirectory
{
    return [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
} 
```

然后，您可以根据需要使用 URL。

`NSLog(@"%@", [[self applicationDocumentsDirectory] path]);`

如果您真的是指环境变量，还有另一篇文章包含一个非常详尽的环境变量列表，您可以在这里找到：[如何在 Xcode 项目中打印“构建设置”列表？](https://stackoverflow.com/questions/6910901/canonical-list-of-xcode-environment-variables)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:01:42.897

如果您想查看环境中的内容，请使用以下代码：

```
 NSDictionary *env = [[NSProcessInfo processInfo] environment]; 
```

# objective-c - PrepareForSegue 与 UIImagePickerController

> ID：13713242
> 
> 赞同：1
> 
> 时间：2012-12-04T22:39:45.987
> 
> 标签：objective-c, ios, xcode, uiimagepickercontroller

我正在尝试将 prepareForSegue 与使用 UIImagePickerController 从相机胶卷或相机拍摄的图像一起使用。这就是我现在所拥有的，我不知道如何完成它，我希望你能帮助我

视图控制器.h

```
 @interface ViewController : UIViewController
<UIImagePickerControllerDelegate, UINavigationControllerDelegate>

-(IBAction)escoger:(id)sender;
-(IBAction)camara:(id)sender;
@property(strong,nonatomic) UIImagePickerController *imagepicker;
@property(strong,nonatomic)IBOutlet UIImageView *image; 
```

视图控制器.m

```
 -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

    if ([segue.identifier isEqualToString:@"escoger"]) {

        //UIImagePickerController *intro = [UIImagePickerController  ]

        imagepicker = [[UIImagePickerController alloc]init];

        imagepicker.delegate = self;

        imagepicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;

        [self presentViewController:imagepicker animated:YES completion:nil];

}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:45:07.887

你不能在里面显示图像选择器`prepareForSegue`。如果您想实际使用已拍摄的照片，则不是。您需要做的是重新连接，以便当前触发 segue 的操作改为打开图像选择器。然后，在您的选择器委托中`didFinishPickingMediaWithInfo`，您手动触发 segue ( `performSegueWithIdentifier:sender:`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:20:01.013

好吧，如果您将 UIImagePickerController 与故事板一起使用，这相对简单。只需在故事板中创建一个新的视图控制器并添加一个 segue。然后在身份检查器中将 viewcontroller 类设置为 UIImagePickerController。

![在此处输入图像描述](../Images/deee9dc0d87ea743f6db8d0ee38e25a3.png)

然后实现 prepareForSegue: 方法并将源设置为相机；

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    UIImagePickerController *controller = [segue destinationViewController];
    controller.sourceType = UIImagePickerControllerSourceTypeCamera;   
} 
```

这就像一个魅力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:47:41.887

我不建议这样做。本质上，您是在尝试使用 segue 来做其他事情（但不执行实际的 segue）。相反，将您的按钮或其他任何东西连接到`IBAction`，因此它会导致图像选择器出现，然后，当实际想要执行 segue 时，调用

```
 [self performSegueWithIdentifier:@"escoger" sender:self]; 
```

[更新] 回应您的评论。您需要做几件事来完成这项工作：

1) 从情节提要中删除 segue

**2）通过从视图控制器而不是按钮拖动来**创建另一个segue 。这将在两个视图控制器之间创建一个 segue，但它不会附加到任何按钮。

3）在IB中为你的按钮创建一个IBAction方法（[一个教程](http://oleb.net/blog/2011/06/creating-outlets-and-actions-via-drag-and-drop-in-xcode-4/)）

4）在该方法中，显示您的图像选择器

5）当您从图像选择器返回时，在代码中执行segue（通过调用`performSegueWithIdentifier`）。6) 现在，您可以在 `prepareForSegue`方法中将图像传递给目标视图控制器。

# ruby - 如何使用具有大量输出的 Cucumber 测试 Ruby 命令行程序？

> ID：13713248
> 
> 赞同：4
> 
> 时间：2012-12-04T22:40:11.660
> 
> 标签：ruby, cucumber, aruba

我正在构建一个 Ruby 命令行程序，并使用 Cucumber 和 Aruba 对其进行测试。Aruba 包含一些非常方便的匹配器，因此我可以使用文件中的几行来测试输出`.feature`：

```
When I run `myprogram`
Then it should pass with:
  """
  my program output
  """ 
```

问题是我的程序可能包含几十行甚至上百行的输出；将所有这些都放在`.feature`文件中会使阅读和导航变得更加困难（并且有点令人讨厌）。在这种情况下测试输出的推荐方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-11T23:20:20.297

简短的回答是：你不应该那样做。

Cucumber 测试应该是面向用户的和可读的。它们描述了特征。用户不会关心错误输出是否逐字节匹配某个已知值。

你需要问自己：我在测试什么？答案是错误信息吗？可能不是。您正在测试应用程序中的某些功能。如果您真的想确保它失败，那么您在 Cucumber 场景中想要的是以下行：

```
Then the exit status should not be 0 
```

这假设脚本遵循标准约定，即非零退出状态表示错误。

如果您的场景要求输出中有特定消息，您可以添加它：

```
Then it should fail with
"""
Some error message
""" 
```

但这不必是*整个*输出，只是部分匹配。（请注意，在 aruba 中定义了一个“它应该完全失败：”，但我不建议使用它。）

**编辑**：您已将示例更改为测试通过而不是失败，但我的基本建议是相同的：

1.  将输出的细节与场景的逻辑分开。使用评论中的示例，如果您有一个测试确认您可以输出*单个*用户生成的评论，并且另一个测试确认您输出了正确的 100 条评论，那么就足够了，您不需要 100 Cucumber 场景中评论的输出价值。
2.  保持从用户的角度编写 Cucumber 场景。每个场景都应该测试对用户很重要的东西。当用户不关心时，尝试通过删除从实现中泄漏的任何内容来使它们最小化。
3.  使用测试部分匹配的内置 Aruba 构造来实现此目的。在输出中寻找关键词或短语。Cucumber 测试不仅更容易阅读，而且更健壮，不受无关输出变化的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:09:05.960

要测试您的程序，您有 2 个选项：

1.  仅检查消息的相关部分（您实际希望通过此测试检查的内容）。Aruba 为其[内置了 stepdef](https://github.com/cucumber/aruba/blob/master/lib/aruba/cucumber.rb#L162)，因此非常简单

2.  检查完整消息。如果消息很短，您可以使用 Aruba 的[内置 stepdef](https://github.com/cucumber/aruba/blob/master/lib/aruba/cucumber.rb#L166)。但是，如果消息很长，您可能希望将其放在单独的文件中。由于 Aruba 不包含此类方法，因此您应该自己编写此 stepdef。

它可能看起来像：

```
# Require aruba/api before that
Then /^it should (pass|fail) with message from file "(.*)"$/ do |pass_fail, filename|
  exact_output = File.read(filename)
  Aruba::API::assert_exit_status_and_output(pass_fail == "pass", exact_output, true)
end 
```

如果你想写很多测试并且很多消息是相似的，你最终可能会得到很多[WET](https://softwareengineering.stackexchange.com/questions/131180/what-is-the-meaning-of-wet-code)消息。如果发生更改，断言完整消息将使支持测试变得更加困难。

因此，您可能希望使用某种模板引擎来断言这些消息以进行 DRYer 测试。

您可以以不同的方式设计测试。
如果您只使用第一种方法，那么您的测试可能不会发现一些回归错误，因为它们不会测试所有内容。如果您将使用第二种方法，如果消息之间有很多重复，那么支持它们可能会更加困难。

因此，这两个选项之间需要权衡取舍。通常您使用方法 1 构建一些测试，使用方法 2 构建另一个测试。您应该考虑在您的情况下什么会更好。我不知道任何黄金法则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T05:54:51.023

在一个应用程序中，数百个输出并不奇怪。是的，您需要使它们易于阅读。如果你不能在 Cucumber 特性文件中做到这一点，恐怕没有更好的地方可以替换。毕竟 Cucumber 完全是简单的英语，并且可以作为实时文档。

您所需要的只是组织它们。如果您忽略了它们，这里有一些基本提示。

1.  编写每个`.feature`文件仅涵盖一个主题的特定功能。虽然我知道你提到`When I run my program`的是为了演示目的，但如此广泛的话题是不可接受的。

2.  将`.feature`文件放入`features/`文件夹。并且，如有必要，进一步将它们拆分为子文件夹，例如`features/user/user_login.feature`.

3.  在一个场景中使用`Scenario Outline`和`Examples`组织类似的输出。这些示例将有行来清楚地表示它们中的每一个。

希望这些帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-15T14:49:36.730

我会推荐以下内容：

```
When I run `my_app`
Then the exit status should not be 0
And the output should contain:
"""
some output
""" 
```

这样，只要您的程序输出“一些输出”，测试就通过了，但*额外*的输出会被忽略，您的测试不需要所有输出。

如果您想在一个步骤中断言所有这些，只需自己制作，尽管我认为这更清楚。

# ruby-on-rails - 控制器中的 render_to_string 部分格式错误

> ID：13713250
> 
> 赞同：10
> 
> 时间：2012-12-04T22:40:16.713
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在控制器上运行以下代码时出现以下错误。请注意`:formats=>[:json]`错误中的，即使`:formats=>[:html]`被传递到 render_to_string

我究竟做错了什么？有任何想法吗？实际上，下面的代码之前运行良好，不确定是什么更改影响了这个错误。导轨版本：3.2.8

顺便说一句，模板肯定到位：loc/_search_details.html.erb

额外的问题：我在哪里可以找到显示哪些参数可以传递给 render_to_string 以及它是如何工作的 api 文档？

错误： **ActionView::MissingTemplate（缺少部分 loc/search_details 和 {:locale=>[:en], :formats=>[:json], :handlers=>[:erb, :builder, :coffee]}。**

```
 respond_to do |format|
    format.json { 
      @detail_str = render_to_string(:partial => 'loc/search_details', :layout => false, :formats=>[:html], :locals => {:beer_results => @beer_results})
      @list_str = render_to_string(:partial => 'loc/search_list', :layout => false,:formats=>[:html], :locals => {:beer_results => @beer_results})
      render :json => {:results => @results_hash, :result_details => @detail_str, :result_list => @list_str }

      }
  end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T22:56:52.203

如果你尝试怎么办

```
render_to_string(:partial => 'loc/search_details.html.erb', :layout => false, :locals => {:beer_results => @beer_results}) 
```

或者

```
with_format("html") { render_to_string(:partial => 'loc/search_details', :layout => false, :locals => {:beer_results => @beer_results}) } 
```

并添加方法

```
private
def with_format(format, &block)
  old_format = @template_format
  @template_format = format
  result = block.call
  @template_format = old_format
  return result
end 
```

资料来源：[如何在 Rails 中呈现不同格式的部分内容？](https://stackoverflow.com/questions/339130/how-do-i-render-a-partial-of-a-different-format-in-rails)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T00:11:48.953

看到[这个问题](https://stackoverflow.com/questions/339130/how-do-i-render-a-partial-of-a-different-format-in-rails/5074120#5074120)和[这个问题](https://github.com/rails/rails/issues/4841)。由于您正在发出 JSON 请求，因此您`render_to_string`期望您的部分是`_search_details.json.erb`. 您可以提供额外的 JSON 部分，重命名部分或将其添加到部分`<% self.formats = [:json, :html] %>`，或者，尝试在该问题的已接受答案中的解决方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-25T20:45:03.513

以防万一其他人对此感到困惑，如果您要渲染到字符串，则只需在 format.json 块的上下文之外进行渲染。在您的示例中：

```
respond_to do |format|
  @detail_str = render_to_string(:partial => 'loc/search_details', :locals => {:beer_results => @beer_results})
  @list_str = render_to_string(:partial => 'loc/search_list', :locals => {:beer_results => @beer_results})
  format.json {     
      render :json => {
        :results => @results_hash, 
        :result_details => @detail_str, 
        :result_list => @list_str 
      }

  }
end 
```

这样，您不必指定格式或布局为假。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-04T22:41:55.190

尝试通过

```
:format => :html 
```

代替

```
:formats => [:html] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-16T11:11:08.327

以防万一有人遇到同样的问题，这对我有用。

我使用时收到的错误消息`render_to_string`与问题中的完全一样，完全`format`不匹配。然而，这并不是问题的真正根源。

问题是我的应用程序是 i18n-ed 并且在 URL 中给出了语言环境。我的`routes.rb`样子是这样的：

```
Quoties::Application.routes.draw do

  scope "(:locale)", locale: /en|pl/ do
    # all routes go here
  end

end 
```

我`application_controller.rb`看起来像这样：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :set_locale

  def default_url_options(options={})
    locale = I18n.locale
    locale = nil if locale == :en
    { locale: locale  }
  end

  def set_locale
    parsed_locale = params[:locale] || 'en'
    I18n.locale = I18n.available_locales.include?(parsed_locale.to_sym) ? parsed_locale : nil
  end
end 
```

（这是我在 Internet 某处找到的解决方案的略微调整版本。）

它在大多数地方都工作得很好。但是，当我在部分中使用路径帮助器时，结果是“缺少部分”错误的原因，比如说

```
<%= item_path(item) %> 
```

有帮助的解决方法是将上述行替换为：

```
<%= item_path(item, locale: params[:locale]) %> 
```

我不知道为什么`default_url_options`在这种情况下不起作用以及为什么 Rails 会引发如此奇怪的异常。

`<% self.formats = [:html, :json] %>`上面建议的解决方案只会使错误消息更清晰，因此至少它更改为在`item_path`.

# html - JSF h:dataTable 在没有记录时创建单个空单元格

> ID：13713252
> 
> 赞同：9
> 
> 时间：2012-12-04T22:40:16.783
> 
> 标签：html, jsf, datatable

当支持值为空时，有什么方法可以防止 h:datatable 创建空行？更具体地说：我有一组数据要显示在带有列标题的 h:dataTable 中的 3 列中。无论列表中是否有元素，都需要显示标题。这很好用，但是当列表中没有元素时，会在 tbody 中创建一个空行/单元格。有没有办法防止这种情况？

谢谢！

来自 backing bean 的示例方法。为了测试，我尝试返回 null 或空列表。两者的结果相同。

```
 public List<LocationsDecorator> getLocations() {
    return null;
} 
```

JSF 片段：

```
<h:dataTable styleClass="locations" id="locations1"
    var="nearestLoc" value="#{confirmationBean.locations}">
    <h:column>
        <!-- column header -->
        <f:facet name="header">Address</f:facet>
        <!-- row record -->
            #{nearestLoc.adddress}
        </h:column>
    <h:column>
        <!-- column header -->
        <f:facet name="header">Distance</f:facet>
        <!-- row record -->
            #{nearestLoc.distance}
        </h:column>
    <h:column>
        <!-- column header -->
        <f:facet name="header">Hours of Operation</f:facet>
        <!-- row record -->
        <h:dataTable styleClass="locations" var="data"
            value="#{nearestLoc.hoursOfOperation}">
            <h:column>     
                #{data}
                </h:column>
        </h:dataTable>

    </h:column>

</h:dataTable> 
```

生成的 HTML（`<tr><td></td></tr>`tbody 中的“”是问题）：

```
<table id="contact:locations1" class="locations">
<thead>
<tr>
<th scope="col">Address</th>
<th scope="col">Distance</th>
<th scope="col">Hours of Operation</th>
</tr>
</thead>
<tbody>
<tr><td></td></tr></tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T17:54:09.647

为空表指定单独的样式。例如

```
table.empty tbody td {
    border: 0;
} 
```

并有条件地添加它。

```
<h:dataTable ... styleClass="locations #{empty component.value ? 'empty' : ''}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T01:00:28.183

如果您将方法包装在 outputText 标记中，则可以避免列标题消失

例子：

```
 <h:column>
    <!-- column header -->
    <f:facet name="header">Address</f:facet>
    <!-- row record -->
       <h:outputText value="#{nearestLoc.adddress}" />
    </h:column> 
```

这样列本身不依赖于值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-15T17:55:34.810

感谢BalusC的建议，但我试过了，还是不行。可能是其他原因导致的。我稍微修复了 BalusC 的代码，它现在可以工作了：

```
table.locations.empty tbody td {
    border-color: rgba(0, 0, 0, 0);
} 
```

# git - Git：重置原始/主分支

> ID：13713253
> 
> 赞同：0
> 
> 时间：2012-12-04T22:40:18.303
> 
> 标签：git

我对 Git 完全陌生。我提交了一些错误的代码，然后为了纠正它，我将当前分支重置为前一个分支。但不知何故，这并没有做我想要的！现在我的主人有一个额外的分支名称previous_master（这是我希望分支指向的地方）。我错误提交的代码具有分支名称 original/master！我不知道如何纠正我的错误。我希望主人也有分支名称 original/master。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:46:22.897

**小基础**

首先请记住，git 中的所有内容都是由哈希标识的。您在历史中提交的所有内容都可以通过此哈希访问（`git checkout $hash`将应用程序状态更改为它，`git show $hash`显示该提交中的更改等等......）。

分支名称的工作方式类似于标签 - 它们可以轻松组织您的工作树，但它们都只是散列指针。如果需要，您可以使用`git checkout <hash id>`.

**起源/***

看起来像`something/something`（例如`origin/master`）的分支是远程分支。因此`origin/master`，这意味着在“原点”远程分支上的“主”。

您可以通过以下方式显示您当地的分支机构：

```
git branch 
```

和远程：

```
git branch -r 
```

您可以将您的发送`master`到由以下方式调用的远程仓库`origin`：

```
git push origin master 
```

如果推送中两个分支的历史有冲突，git 不会允许推送它，它会提示你手动解决冲突才允许推送。

* * *

在您的情况下，您需要找到哪个提交（哪个哈希）是您想要的应用程序状态，然后将您的分支重置为该提交。

您可以通过以下方式在终端中显示您的提交历史记录：

```
git log --graph --decorate --pretty=oneline --abbrev-commit --all 
```

这看起来很疯狂，但它是我最喜欢的 git 命令，我有它的短别名

您可以通过以下方式将您的应用程序状态切换到该提交：

```
git checkout $hash 
```

**HEAD**现在在那个哈希上。

找到您想要的状态并将您的主人重置为：

```
git checkout master
git reset --hard $hash 
```

请小心，因为这将删除所有未提交的更改。

所有提交的历史都将保留 - 只需告诉它会将您当前的分支和状态重置为历史中的该哈希值。

如果您想将其发送到 repo 调用：

```
git push --force origin master 
```

*   这将明确地将您的主状态反映到源/主（将其发送到源远程）。 **不要使用 --force 除非您绝对确定**要更改该遥控器上的历史记录，并且如果其他开发人员已经使用已经从 origin/master 拉取，则永远不要使用它，因为这会更改`origin/master`. 它会做你想做的事，但你应该更详细地阅读它：

    人 git 推送

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T22:58:19.053

如果您知道您希望 master 指向的提交的 sha，只需执行以下操作：

```
$ git checkout master
$ git reset <sha> 
```

如果你执行

```
$ git reflog 
```

您将获得有关您所做工作的历史记录。左列中的字符串是 shas。这些信息起初可能有点吓人，但应该很容易找出你想要的信息。实验！

# haskell - zipWith Haskell

> ID：13713254
> 
> 赞同：1
> 
> 时间：2012-12-04T22:40:23.117
> 
> 标签：haskell

我创建了这个数据类型和函数：

```
type Bit = Int

randomFloatList :: Int -> [Float]
randomFloatList seed = randoms (mkStdGen seed) 
```

我想创建一个使用`zipWith`. 该函数有一个`seed`作为用于 的参数`randomFloatList`，如果随机元素介于 0 和噪声之间，则该位会更改。我正在尝试这样做，但我遇到了困难`zipWith`：

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:57:26.380

我相信您想获取`Bit`s 列表并使用随机列表来决定是否更改原始列表。（如果不是，请澄清。）

```
channel :: Int -> Float -> [Bit] -> [Bit]
channel seed noise xs = zipWith (alterBit noise) (randomFloatList seed) xs 
```

请注意，您不需要某些括号 - 您不需要用于函数应用的括号，仅用于分组。

```
alterBit :: Float -> Float -> Bit -> Bit
alterBit noise random bit | random <= noise = alter bit
                          | otherwise = bit 
```

同样，我已经删除了对我正在使用它的列表的任何引用 -`zipWith`将把这个函数从浮点数和位列表中发送它需要的*单个元素。*

我冒昧地定义

```
data Bit = O | I deriving Show 
```

并且只能想到一个改变功能：

```
alter :: Bit -> Bit
alter O = I
alter I = O 
```

让我们测试一下：

```
> take 6 $ randomFloatList 3
[0.10321328,0.98988104,0.46191382,0.8553592,0.7980472,0.35561606]

> map (<= 0.5) $ take 6 $ randomFloatList 3
[True,False,True,False,False,True]

> channel 3 0.5 [O,O,O,O,O,O]
[I,O,I,O,O,I] 
```

是的，这改变了它应该的那些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:55:46.817

`zipWith`的签名是`(a -> b -> c) -> [a] -> [b] -> [c]`。这意味着它对于映射一个在两个列表上接受两个参数的函数很有用。

我认为，在您的情况下，您只想将一个函数映射到一个列表上（因为您的函数`alterBit`只接受一个参数），所以您必须使用`map`，而不是`zipWith`.

另请注意`seed`，除非您将它们定义为模块中的常量或将它们显式传递`noise`给.`alterBit``alterBit`

# java - 将其更改为使用直线？进行中

> ID：13713257
> 
> 赞同：-1
> 
> 时间：2012-12-04T22:40:40.860
> 
> 标签：java, processing

我有一个程序，它必须制作一个三角形螺旋。有谁知道我可以如何改变这个程序，而是让一条整条线形成螺旋，它是由直线段组成的吗？以下是我到目前为止的代码...

```
void setup(){
  int len=100;
  int startx =250;
  int starty= 250;
  float angle = PI;
  size (500,500);
  spiral_triangle(len, startx,starty,angle);

}

void spiral_triangle(int len, int startx, int starty, float angle){

   if (len>1) 
        {line( startx, starty ,int(startx+len*cos(angle)),int(starty + len*sin(angle))  );
        int new_startx = int(startx+len*cos(angle));
        int new_starty = int(starty+len*sin(angle));
        int new_len = len -10;
        float new_angle = angle + PI/1.5;
        spiral_triangle(new_len, new_startx,new_starty,new_angle);
        } 
} 
```

示例......而不是每边一条线，我需要这个--------每边......单独的线段（有点像虚线或虚线）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:03:09.783

如果我理解正确，您需要圆形螺旋而不是三角形螺旋。下面的代码应该实现这一点。

```
void spiral_triangle(float len, int startx, int starty, float angle){
   if (len>1) {
      float new_len = len - 0.1;
      float new_angle = angle + PI/100;
      int oldx = int(startx+len*cos(angle));
      int oldy = int(starty+len*sin(angle));
      int newx = int(startx+new_len*cos(new_angle));
      int newy = int(starty+new_len*sin(new_angle));
      line( oldx,oldy,newx,newy);   
      spiral_triangle(new_len, startx,starty,new_angle);
   } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T04:45:20.237

如果您要绘制虚线而不是实线，则必须根据此线程编写自己的代码：

[http://processing.org/discourse/beta/num_1202486379.html](http://processing.org/discourse/beta/num_1202486379.html)

奇怪的是，库中没有虚线函数。使用该线程中的一个函数，您可以执行以下操作：

```
void setup() {
  int len=100;
  int startx =250;
  int starty= 250;
  float angle = PI;
  size (500, 500);
  spiral_triangle(len, startx, starty, angle);
}

void spiral_triangle(int len, int startx, int starty, float angle) {
  if (len>1) {
    float[] spacing = {2,2};
    dashline( startx, starty, int(startx+len*cos(angle)), int(starty + len*sin(angle)), spacing);
    int new_startx = int(startx+len*cos(angle));
    int new_starty = int(starty+len*sin(angle));
    int new_len = len -10;
    float new_angle = angle + PI/1.5;
    spiral_triangle(new_len, new_startx, new_starty, new_angle);
  }
}

/* 
 * Draw a dashed line with given set of dashes and gap lengths. 
 * x0 starting x-coordinate of line. 
 * y0 starting y-coordinate of line. 
 * x1 ending x-coordinate of line. 
 * y1 ending y-coordinate of line. 
 * spacing array giving lengths of dashes and gaps in pixels; 
 *  an array with values {5, 3, 9, 4} will draw a line with a 
 *  5-pixel dash, 3-pixel gap, 9-pixel dash, and 4-pixel gap. 
 *  if the array has an odd number of entries, the values are 
 *  recycled, so an array of {5, 3, 2} will draw a line with a 
 *  5-pixel dash, 3-pixel gap, 2-pixel dash, 5-pixel gap, 
 *  3-pixel dash, and 2-pixel gap, then repeat. 
 */ 
void dashline(float x0, float y0, float x1, float y1, float[ ] spacing) 
{ 
  float distance = dist(x0, y0, x1, y1); 
  float [ ] xSpacing = new float[spacing.length]; 
  float [ ] ySpacing = new float[spacing.length]; 
  float drawn = 0.0;  // amount of distance drawn 

  if (distance > 0) 
  { 
    int i; 
    boolean drawLine = true; // alternate between dashes and gaps 

    /* 
      Figure out x and y distances for each of the spacing values 
      I decided to trade memory for time; I'd rather allocate 
      a few dozen bytes than have to do a calculation every time 
      I draw. 
    */ 
    for (i = 0; i < spacing.length; i++) 
    { 
      xSpacing[i] = lerp(0, (x1 - x0), spacing[i] / distance); 
      ySpacing[i] = lerp(0, (y1 - y0), spacing[i] / distance); 
    } 

    i = 0; 
    while (drawn < distance) 
    { 
      if (drawLine) 
      { 
        line(x0, y0, x0 + xSpacing[i], y0 + ySpacing[i]); 
      } 
      x0 += xSpacing[i]; 
      y0 += ySpacing[i]; 
      /* Add distance "drawn" by this line or gap */ 
      drawn = drawn + mag(xSpacing[i], ySpacing[i]); 
      i = (i + 1) % spacing.length;  // cycle through array 
      drawLine = !drawLine;  // switch between dash and gap 
    } 
  } 
} 
```

我希望这有帮助。

# emacs - 在循环中生成唯一的随机数

> ID：13713258
> 
> 赞同：4
> 
> 时间：2012-12-04T22:40:45.230
> 
> 标签：emacs, random, lisp, elisp

好的，经过几个小时的疯狂调试，我终于有了这个：

```
(defmacro assoc-bind (bindings expression &rest body)
  (let* ((i (gensym))
         (exp (gensym))
         (abindings
          (let ((cursor bindings) result)
            (while cursor
              (push (caar cursor) result)
              (push (cdar cursor) result)
              (setq cursor (cdr cursor)))
            (setq result (nreverse result))
            (cons (list i `(quote ,result))
                  (cons (list exp expression) result)))))
    `(let (,@abindings)
       (while ,i
         (set (car ,i) (caar ,exp))
         (setq ,i (cdr ,i))
         (set (car ,i) (cdar ,exp))
         (setq ,i (cdr ,i) ,exp (cdr ,exp)))
       ,@body)))

(let ((i 0) (limit 100) (test (make-string 100 ?-))
      bag bag-iter next-random last)
  (while (< i limit)
    ;; bag is an alist of a format of ((min . max) ...)
    (setq bag-iter bag next-random (random limit))
    (message "original-random: %d" next-random)
    (if bag-iter
        (catch 't
          (setq last nil)
          (while bag-iter
            ;; cannot use `destructuring-bind' here,
            ;; it errors if not enough conses
            (assoc-bind
                ((lower-a . upper-a) (lower-b . upper-b))
                bag-iter
              (cond
               ;; CASE 0: ============ no more conses
               ((and (null lower-b) (>= next-random upper-a))
                (cond
                 ((= next-random upper-a)
                  (if (< (1+ next-random) limit)
                      (setcdr (car bag-iter) (incf next-random))
                    (setcar (car bag-iter) (incf next-random))
                    (when (and last (= 1 (- (cdar last) next-random)))
                      (setcdr (car last) upper-a)
                      (setcdr last nil))))
                 ;; increase right
                 ((= (- next-random upper-a) 1)
                    (setcdr (car bag-iter) next-random))
                  ;; add new cons
                  (t (setcdr bag-iter
                             (list (cons next-random next-random)))))
                (message "case 0")
                (throw 't nil))
               ;; CASE 1: ============ before the first
               ((< next-random lower-a)
                (if (= (1+ next-random) lower-a)
                    (setcar (car bag-iter) next-random)
                  (if last
                      (setcdr last
                              (cons (cons next-random next-random)
                                    bag-iter))
                    (setq bag (cons (cons next-random next-random) bag))))
                (message "case 1")
                (throw 't nil))
               ;; CASE 2: ============ in the first range
               ((< next-random upper-a)
                (if (or (and (> (- next-random lower-a)
                                (- upper-a next-random))
                             (< (1+ upper-a) limit))
                        (= lower-a 0))
                    ;; modify right
                    (progn
                      (setq next-random (1+ upper-a))
                      (setcdr (car bag-iter) next-random)
                      (when (and lower-b (= (- lower-b next-random) 1))
                        ;; converge right
                        (setcdr (car bag-iter) upper-b)
                        (setcdr bag-iter (cddr bag-iter))))
                  ;; modify left
                  (setq next-random (1- lower-a))
                  (setcar (car bag-iter) next-random)
                  (when (and last (= (- next-random (cdar last)) 1))
                    ;; converge left
                    (setcdr (car last) upper-a)
                    (setcdr last (cdr bag-iter))))
                (message "case 2")
                (throw 't nil))
               ;; CASE 3: ============ in the middle
               ((< next-random lower-b)
                (cond
                 ;; increase previous
                 ((= next-random upper-a)
                  (setq next-random (1+ next-random))
                  (setcdr (car bag-iter) next-random)
                  (when (= (- lower-b next-random) 1)
                    ;; converge left, if needed
                    (setcdr (car bag-iter) upper-b)
                    (setcdr bag-iter (cddr bag-iter))))
                 ;; converge right
                 ((= (- lower-b upper-a) 1)
                  (setcdr (car bag-iter) upper-b)
                  (setcdr bag-iter (cddr bag-iter)))
                 ;; increase left
                 ((= (- next-random 1) upper-a)
                  (setcdr (car bag-iter) next-random)
                  (when (= next-random (1- lower-b))
                    (setcdr (car bag-iter) upper-b)
                    (setcdr bag-iter (cddr bag-iter))))
                 ;; decrease right
                 ((= (- lower-b next-random) 1)
                  (setcar (cadr bag-iter) next-random))
                 ;; we have room for a new cons
                 (t (setcdr bag-iter
                            (cons (cons next-random next-random)
                                  (cdr bag-iter)))))
                (message "case 3")
                (throw 't nil)))
              (setq last bag-iter bag-iter (cdr bag-iter)))))
      (setq bag (list (cons next-random next-random))))
    (message "next-random: %d" next-random)
    (message "bag: %s" bag)
    (when (char-equal (aref test next-random) ?x)
      (throw nil nil))
    (aset test next-random ?x)
    (incf i))
  (message test)) 
```

它有效，但它**超级丑陋**。当我开始研究这个时，我想这个函数不应该超过几十行代码。非常希望我最初的假设并没有那么遥远，我要求您尝试帮助整理一下。

如果阅读我的代码让你头疼（我完全可以理解它！）这里是对上述内容的描述：

在给定的间隔内生成随机数（为简单起见从零开始，直到`limit`）。每次迭代通过对照已经生成的预先记录的数字范围来验证新生成的数字是唯一的。这些范围以 的形式存储`alist`，即`((min-0 . max-0) (min-1 . max-1) ... (min-N . max-N))`。在检查新生成的随机数不在任何范围内后，使用该数字，并使用生成的数字更新范围。否则，该数字将替换为与其所在范围的最小值或最大值更接近的数字，但不能超过`limit`或为负数。

更新范围的规则：

给定 N = 新随机数，以及两个范围`((a . b) (c . d))` ，可能会发生以下变化：

```
if N < a - 1: ((N . N) (a . b) (c . d))
if N < a + (b - a) / 2: (((1- a) . b) (c . d))
if N < b and (c - b) > 2: ((a . (1+ b)) (c . d))
if N < b and (c - b) = 2: ((a . d))
if N = c - 1: ((a . b) ((1- c) . d))
if N < c: ((a . b) (N . N) (c . d)) 
```

我希望我涵盖了所有情况。

如果您有办法描述算法的时间/空间复杂性，则可以加分 :) 另外，如果您可以考虑解决问题的另一种方法，或者您可以肯定地说在这种情况下分布均匀性存在问题，请执行告诉！

**编辑：**

现在太累了，无法测试它，但这是我的另一个想法，以防万一：

```
(defun pprint-bytearray
  (array &optional bigendian bits-per-byte byte-separator)
  (unless bits-per-byte (setq bits-per-byte 32))
  (unless byte-separator (setq byte-separator ","))
  (let ((result
         (with-output-to-string
           (princ "[")
           (++ (for i across array)
             (if bigendian
                 (++ (for j from 0 downto (- bits-per-byte))
                   (princ (logand 1 (lsh i j))))
               (++ (for j from (- bits-per-byte) to 0)
                 (princ (logand 1 (lsh i j)))))
             (princ byte-separator)))))
    (if (> (length result) 1)
        (aset result (1- (length result)) ?\])
      (setq result (concat result "]")))
    result))

(defun random-in-range (limit &optional bits)
  (unless bits (setq bits 31))
  (let ((i 0) (test (make-string limit ?-))
        (cache (make-vector (ceiling limit bits) 0))
        next-random searching
        left-shift right-shift)
    (while (< i limit)
      (setq next-random (random limit))
      (let* ((divisor (floor next-random bits))
             (reminder (lsh 1 (- next-random (* divisor bits)))))
        (if (= (logand (aref cache divisor) reminder) 0)
            ;; we have a good random
            (aset cache divisor (logior (aref cache divisor) reminder))
          ;; will search for closest unset bit
          (setq left-shift (1- next-random)
                right-shift (1+ next-random)
                searching t)
          (message "have collision %s" next-random)
          (while searching
            ;; step left and try again
            (when (> left-shift 0)
              (setq divisor (floor left-shift bits)
                    reminder (lsh 1 (- left-shift (* divisor bits))))
              (if (= (logand (aref cache divisor) reminder) 0)
                  (setf next-random left-shift
                        searching nil
                        (aref cache divisor)
                        (logior (aref cache divisor) reminder))
                (decf left-shift)))
            ;; step right and try again
            (when (and searching (< right-shift limit))
              (setq divisor (floor right-shift bits)
                    reminder (lsh 1 (- right-shift (* divisor bits))))
              (if (= (logand (aref cache divisor) reminder) 0)
                  (setf next-random right-shift
                        searching nil
                        (aref cache divisor)
                        (logior (aref cache divisor) reminder))
                (incf right-shift))))))
      (incf i)
      (message "cache: %s" (pprint-bytearray cache t 31 ""))
      (when (char-equal (aref test next-random) ?x)
        (throw nil next-random))
      (aset test next-random ?x)
      (message "next-random: %d" next-random))))

(random-in-range 100) 
```

这应该将内存使用量减少 31 倍（也许可以是 32，我不知道在 eLisp 中使用多少位 int 是安全的，int 似乎取决于平台）。

即我们可以将自然数分成每组 31 个数字，并且在每个这样的组中，可以将其所有成员（或它们的组合）存储为单个 int（每个数字只需要一位来显示它的在场）。这使得搜索最近的未使用邻居更加复杂，但是减少 31 倍内存的好处（并且不需要动态分配）看起来是一个很好的视角......

编辑2：

好的，我终于想出了如何使用位掩码来做到这一点。更新了上面的代码。这可以节省内存高达范围的 64 倍（我想是的......），您可以在其中生成随机数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:43:28.887

对于更简单的方法，只需生成所需间隔内的数字序列，然后将它们打乱。然后，当您需要一个随机数时，只需从该列表中取出下一个即可。

这样可以确保所需区间中的所有数字都存在一次且仅一次，并且获得的每个随机数都是唯一的，并且如果您经过它，整个区间将被耗尽。

据我了解，这些满足您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:50:02.167

下面的代码经过了轻微的测试，可能不是最漂亮的风格，但我仍然认为它应该可以工作并且比你的简单一点。我的算法可以被视为与您的相反：我没有将随机数添加到已选择的数字集合中，而是从完整的可能整数集开始并`i`从中删除 th （这是由 完成的`pick`）。我使用与您相同的存储来存储整数集。

```
(defun pick (index bag)
  "Pick integer at position INDEX in the set described by BAG

BAG is of the form ((min0 . max0) (min1 . max1) ...)

The result is returned in the form: (n . new-bag)
where N is the integer picked, and NEW-BAG is the set obtained by
removing N from BAG."
  (let* ((range (car bag))   ;; The first range in the set,
         (beg (car range))   ;; of the form (beg . end)
         (end (cdr range))   ;;
         (last (- end beg))) ;; index of the last element in the range

    (if (<= index last)
        ;; We are picking an element of the first range
        (let ((n (+ beg index)))
          (cons n
                (cond
                 ;; Case of a singleton (n . n)
                 ((= last 0)
                  (rest bag))

                 ;; If we are picking the first element of the range
                 ((= index 0)
                  (cons `(,(1+ beg) . ,end) (rest bag)))

                 ;; If we are picking the last element
                 ((= index last)
                  (cons `(,beg . ,(- end 1)) (rest bag)))

                 ;; Otherwise, the range is split into two parts
                 (t
                  (concatenate 'list
                               `((,beg . ,(- n 1))
                                 (,(1+ n) . ,end))
                               (rest bag))))))

      ;; We will pick an element from a range further down the list
      ;; by recursively calling `pick' on the tail
      (let* ((rec     (pick (- index last 1) (rest bag)))
             (n       (car rec))
             (new-bag (cdr rec)))
        (cons n (cons range new-bag))))))

(defun generate (count limit)
  (let ((bag `((1 . ,limit)))
        (result nil)
        n pick-result)
    (dotimes (i count)
      (setq pick-result (pick (random (- limit i)) bag))
      (setq n   (car pick-result))
      (setq bag (cdr pick-result))
      (setq result (cons n result)))
    result))

(generate 10 100)
;; ==> (64 26 43 44 55 5 89 20 12 25) 
```

你可能是一个比我更好的 LISP 编码器，所以我相信你将能够以更清晰的方式重写这段代码。

# django - 多表继承；仅限儿童的唯一标题

> ID：13713259
> 
> 赞同：0
> 
> 时间：2012-12-04T22:40:56.830
> 
> 标签：django, django-models

我有几个使用多表继承的模型。像这样。

```
class Group(models.Model):  
    title =  models.CharField(unique=True,max_length=255)

class UserGroup(Group):  
   user = models.ForeignKey(User)  
   def save(self, *args, **kwargs):  
       self.title = self.user.username  
       return super(Group, self).save(*args, **kwargs) 
```

UserGroups 需要有唯一的标题，Groups 也是如此。但是用户组是否与组具有相同的标题并不重要。事实上，这应该在某些情况下发生。我怎样才能做到这一点？

编辑：如果我使用 save 方法创建一个命名空间怎么办。

```
class UserGroup(Group):  
   user = models.ForeignKey(User)  
   def save(self, *args, **kwargs):  
       self.title = "user:" + self.user.username  
       return super(UserGroup, self).save(*args, **kwargs) 

class Group(models.Model):  
    title =  models.CharField(unique=True,max_length=255)
    def save(self, *args, **kwargs):  
       self.title = "group:" + self.title
       return super(Group, self).save(*args, **kwargs) 
```

这会是一个很好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:33:12.770

你需要的是`Group.title`独立`UserGroup.title`的桌子。您设计的问题在于，在 Django 多表继承中，子表*永远不会*独立于它们的父表；您将需要同时创建`Group`并`UserGroup`从另一个模型继承，无论是具体的还是抽象的，然后让两个孩子都声明一个`title`字段。

# jquery - 将文本复制到另一个文本上

> ID：13713261
> 
> 赞同：0
> 
> 时间：2012-12-04T22:41:00.050
> 
> 标签：jquery, replace, append, clone

我希望我的 categorySidebarLabelSelected 替换 areaTitle 内的文本但不移动它，我尝试了移动它的 .html，我尝试了移动它的 append，我做了 .clone 但它创建了 2 个链接。我已经用尽了我的尝试。这是我的jQuery。

```
$(".areaTitle").html($( ".categorySidebarLabelSelected").html(function() {
  $(this).removeClass('categorySidebarLabelSelected')
  }
    )).show();
   };

HTML CODE ADDED

 <td class="categorySidebarLabelLevel1 categorySidebarLabel" width="100%">
       <a class="categorySidebarLabelLevel1 categorySidebarLabel" title="" href="UserContentStart.aspx?category=6">MENU</a>
 </td>

  <div class="areaTitle" style="display: block;">
    </div> 
```

我希望将垂直菜单中的 MENU 也放置在 areaTitle 内（作为标题，以便人们知道他们在哪里）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:46:34.150

试试这个 - 但我在你的 html 中看不到任何有`class=categorySidebarLabelSelected`

```
// changes .areaTitle's text to same as .categorySidebarLabel's text
$(".areaTitle").text($("a.categorySidebarLabel").text()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:47:43.200

尝试这个

```
 $(".areaTitle")
             .text($("td.categorySidebarLabel  a.categorySidebarLabel").text()); 
```

# iphone - AVFoundation 相机预览方向错误

> ID：13713262
> 
> 赞同：4
> 
> 时间：2012-12-04T22:41:01.260
> 
> 标签：iphone, objective-c, xcode, ipad, avfoundation

我在 iPad 内部制作了一个带有小预览区域的自定义相机，但是，该预览中的流是顺时针旋转的。

我已经查看了 Apple 上的 AVCam 演示和 SquareCam 演示，但我都没有看到任何解决方案。StackOverflow 上的所有 AVFoundation 方向线程都专门讨论输出方向，而不是输入方向。

这是我正在使用的会话代码：

```
AVCaptureDevice *frontalCamera = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    _session = [[AVCaptureSession alloc] init];
    [_session beginConfiguration];
    NSError *error;
    AVCaptureDeviceInput *input = [AVCaptureDeviceInput deviceInputWithDevice:frontalCamera error:&error];
    [_session addInput:input];
    _output = [[AVCaptureStillImageOutput alloc] init];
    [_output setOutputSettings:[[NSDictionary alloc] initWithObjectsAndKeys:AVVideoCodecJPEG,AVVideoCodecKey,nil]];
    [_session addOutput:_output];
    AVCaptureVideoPreviewLayer *previewLayer = [AVCaptureVideoPreviewLayer layerWithSession:_session];
    previewLayer.frame = self.imageViewCamera.bounds;
    previewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;
    [self.imageViewCamera.layer addSublayer:previewLayer];
    _session.sessionPreset = AVCaptureSessionPreset640x480;
    [_session commitConfiguration];
    [_session startRunning]; 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T02:10:23.340

iOS 6 的 Apple 文档说要`videoOrientation (AVCaptureConnection)`改用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:47:36.820

这已被弃用，但您可以逆时针更改 previewLayer 的方向。

```
previewLayer.orientation = AVCaptureVideoOrientationLandscapeRight; 
```

我不确定不推荐使用的解决方案是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-26T08:01:58.903

> 图层的方向。（在 iOS 6.0 中已弃用。请改用[videoOrientation](http://developer.apple.com/library/ios/#Documentation/AVFoundation/Reference/AVCaptureConnection_Class/Reference/Reference.html#//apple_ref/occ/instm/AVCaptureConnection/videoOrientation) (AVCaptureConnection)。）

所以使用：

```
[[AVCaptureVideoPreviewLayer connection] setVideoOrientation: AVCaptureVideoOrientationLandscapeRight]; 
```

或者

```
AVCaptureVideoPreviewLayer.connection.videoOrientation= AVCaptureVideoOrientationLandscapeRight; 
```

# excel - Excel 创建 Outlook 日历事件

> ID：13713266
> 
> 赞同：5
> 
> 时间：2012-12-04T22:41:12.313
> 
> 标签：excel, vba, outlook, calendar

你能从 Excel 运行一个宏，它可以与 Outlook 交互并在日历上创建和事件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-08T12:59:18.837

其他答案略有改进

```
Sub createappt()

Const olFolderCalendar = 9
Const olAppointmentItem = 1 '1 = Appointment

Set objOutlook = CreateObject("Outlook.Application")

'Set objOutlook = GetObject(, "Outlook.Application")  ' outlook already open
Set objNamespace = objOutlook.GetNamespace("MAPI")
Set Items = objNamespace.GetDefaultFolder(olFolderCalendar).Items

Set objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar).Folders("subfolder")
Set objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar) ' main calender
Set objapt = objCalendar.Items.Add(olAppointmentItem)
objapt.Subject = "Test" 'Owner
objapt.Start = Date + TimeValue("08:00:00")
objapt.Duration = 60 * 8 'Duration(in minutes) OR End(I'm not sure so try both)
objapt.End = Date + TimeValue("16:00:00")
objapt.Save
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-10T18:45:57.393

只要您有权在其中写入，这将允许您将约会添加到任何文件夹中的共享日历。

将日历视为文件夹

```
Const olFolderInbox = 6
Const olAppointmentItem = 1 '1 = Appointment

Set objOutlook = CreateObject("Outlook.Application")
Set objNamespace = objOutlook.GetNamespace("MAPI")
'Finds your Inbox
Set objInbox = objNamespace.GetDefaultFolder(olFolderInbox)

'Gets the parent of your Inbox which gives the Users email
strFolderName = objInbox.Parent
Set objCalendar = objNamespace.Folders("Public folders - " & strFolderName).Folders("SubFolder1").Folders("subfolder of subfolder 1").Folders("Your Calendar")

Set objapt = objCalendar.Items.Add(olAppointmentItem)
objapt.Subject = "Test" 'Owner
objapt.Start = Date + TimeValue("08:00:00")
objapt.Duration = 60 * 8 'Duration(in minutes) OR End(I'm not sure so try both)
objapt.End= Date + TimeValue("16:00:00")
objapt.Save 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-07T21:22:07.223

*蒂姆评论的链接 - [http://excelexperts.com/Creating-appointments-for-outlook-in-VBA](http://excelexperts.com/Creating-appointments-for-outlook-in-VBA)*

```
Sub AddAppointments2()
    ' Create the Outlook session
    Set myOutlook = CreateObject("Outlook.Application")

    ' Start at row 2
    r = 2

    Do Until Trim(Cells(r, 1).Value) = ""
        For Each olapt In olFldr.Items
            If TypeName(myApt) = "AppointmentItem" Then
                If InStr(1, myApt.Subject, "Test and Tag", vbTextCompare) Then
                    myApt.Body = appt.Body & Cells(r, 2)
                    myApt.Save
                Else
                    ' Create the AppointmentItem
                    Set myApt = myOutlook.createitem(1)
                    ' Set the appointment properties
                    myApt.Subject = Cells(r, 1).Value
                    myApt.Location = Cells(r, 2).Value
                    myApt.Start = Cells(r, 4).Value + TimeValue("08:00:00")
                    myApt.Duration = Cells(r, 5).Value
                    ' If Busy Status is not specified, default to 2 (Busy)
                    If Trim(Cells(r, 6).Value) = "" Then
                        myApt.BusyStatus = 2
                    Else
                        myApt.BusyStatus = Cells(r, 6).Value
                    End If
                    If Cells(r, 7).Value > 0 Then
                        myApt.ReminderSet = True
                        myApt.ReminderMinutesBeforeStart = Cells(r, 7).Value
                    Else
                        myApt.ReminderSet = False
                    End If
                    myApt.Body = Cells(r, 12).Value
                    myApt.Save
                    r = r + 1
                End If
            End If
        Next olapt
    Loop
End Sub 
```

这是其他链接[https://stackoverflow.com/a/49121400/4539709](https://stackoverflow.com/a/49121400/4539709)

# jquery - 自定义可扩展 jquery 引导手风琴动画在 chrome/ff 中中断。

> ID：13713269
> 
> 赞同：0
> 
> 时间：2012-12-04T22:41:26.590
> 
> 标签：jquery, twitter-bootstrap, jquery-animate

**问题**

我无休止地尝试让我网站的这个手风琴部分兼容/响应跨浏览器。Firefox 上的这个演示中的可扩展手风琴就像它应该的那样工作：
[http](http://www.kinetik.us/test.php)
://www.kinetik.us/test.php 但是当你在 chrome 中尝试它时，第二项向下的宽度计算不正确。我似乎无法理解为什么这只发生在 chrome 中。

对于每个打开的手风琴，我都有这个代码：

```
 $(document).ready(function(){
$('#collapse_link1').click(function() {
  if($('#collapse1').hasClass('in')){
    $('#collapse1').animate({ padding: 0 }).delay(100).removeClass('visible');
    }else{
        $('#collapse1').animate({ padding: "0px 20px 20px 20px" });
        setTimeout(function() {
            $('#collapse1').addClass('visible');
        }, 1);
    }
}); 
```

});

任何想法都会有很大帮助，因为我学习 jquery 非常快，但是小错误往往会导致我卡住！呵！无论如何希望你能帮忙:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T03:05:57.880

看不到您提供的链接，因为除了 html 没有加载任何内容。

鉴于您提供的内容，我在小提琴中快速模拟了一些东西。让我知道这是否符合您的需求。

[http://jsfiddle.net/jmsessink/U6Y9b/](http://jsfiddle.net/jmsessink/U6Y9b/)

```
 if($('#collapse1').hasClass('in')){

        $('#collapse1').stop(true, false).animate({ padding: 0 }).delay(100).removeClass('in');

    } else {

        $('#collapse1').stop(true, false).animate({ padding: "0px 20px 20px 20px" });
        setTimeout(function() {
            $('#collapse1').addClass('in');
        }, 1);

    } 
```

# c# - 调整预设日历大小

> ID：13713270
> 
> 赞同：1
> 
> 时间：2012-12-04T22:41:31.427
> 
> 标签：c#, winforms, calendar, size

我想制作一个日历，在 c# winforms 中只有一个月的视图，大小比预设的大。我使用的控件是 MonthCalendar。

如果我在属性中更改大小或使用鼠标调整大小，日历会及时延长（例如显示 3 个月而不是 1 个月）但不会变大、字体大小相同等...

我试图更改字体大小，但没有任何反应。

**我如何调整它的缩放字体并显示相同但更大的比例？**

# javascript - 如何使用 Grunt.js (0.3.x) 连接和缩小多个 CSS 和 JavaScript 文件

> ID：13713273
> 
> 赞同：99
> 
> 时间：2012-12-04T22:41:36.060
> 
> 标签：javascript, css, concatenation, minify, gruntjs

*注意：这个问题只与 Grunt 0.3.x 相关，留作参考。有关最新 Grunt 1.x 版本的帮助，请参阅我在此问题下方的评论。*

我目前正在尝试使用 Grunt.js 设置一个自动构建过程，以首先连接然后缩小 CSS 和 JavaScript 文件。

我已经能够成功地连接和缩小我的 JavaScript 文件，尽管每次我运行 grunt 时它似乎只是附加到文件而不是覆盖它们。

至于缩小甚至连接 CSS，我目前还无法做到这一点！

就 grunt CSS 模块而言，我尝试使用`consolidate-css`, `grunt-css`&`cssmin`但无济于事。无法理解如何使用它们！

我的目录结构如下（作为典型的 node.js 应用程序）：

*   应用程序.js
*   咕噜声
*   /public/index.html
*   /public/css/[各种css文件]
*   /public/js/[各种javascript文件]

这是我的 grunt.js 文件当前在我的应用程序的根文件夹中的样子：

```
module.exports = function(grunt) {

  // Project configuration.
  grunt.initConfig({
    pkg: '<json:package.json>',
    concat: {
      dist: {
        src: 'public/js/*.js',
        dest: 'public/js/concat.js'
      }
    },
    min: {
      dist: {
        src: 'public/js/concat.js',
        dest: 'public/js/concat.min.js'
      }
    },
    jshint: {
      options: {
        curly: true,
        eqeqeq: true,
        immed: true,
        latedef: true,
        newcap: true,
        noarg: true,
        sub: true,
        undef: true,
        boss: true,
        eqnull: true,
        node: true
      },
      globals: {
        exports: true,
        module: false
      }
    },
    uglify: {}
  });

  // Default task.
  grunt.registerTask('default', 'concat min');

}; 
```

因此，总结一下，我需要两个问题的帮助：

1.  如何将文件夹下的所有css文件连接并缩小`/public/css/`到一个文件中，比如说`main.min.css`
2.  为什么 grunt.js 继续附加到连接和缩小的 javascript 文件`concat.js`，而不是`concat.min.js`在`/public/js/`每次`grunt`运行命令时覆盖它们？

* * *

**2016 年 7 月 5 日更新 - 从 Grunt 0.3.x 升级到 Grunt 0.4.x 或 1.x**

`Grunt.js`已移至新结构中`Grunt 0.4.x`（该文件现在称为`Gruntfile.js`）。请参阅我的开源项目[Grunt.js Skeleton](https://github.com/jasdeepkhalsa/gruntjs-skeleton)以获取有关为`Grunt 1.x`.

从`Grunt 0.4.x`到移动`Grunt 1.x` [不应 引入 很多 重大 变化](http://gruntjs.com/upgrading-from-0.4-to-1.0).

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-12-06T17:33:02.797

concat.js 包含在`concat`任务的源文件`public/js/*.js`中。您可以有一个任务在再次连接之前删除`concat.js`（如果文件存在），传递一个数组来明确定义要连接的文件及其顺序，或者更改项目的结构。

如果做后者，你可以把你所有的源代码`./src`和你的构建文件放在下面`./dest`

```
src
├── css
│   ├── 1.css
│   ├── 2.css
│   └── 3.css
└── js
    ├── 1.js
    ├── 2.js
    └── 3.js 
```

然后设置你的**concat**任务

```
concat: {
  js: {
    src: 'src/js/*.js',
    dest: 'dest/js/concat.js'
  },
  css: {
    src: 'src/css/*.css',
    dest: 'dest/css/concat.css'
  }
}, 
```

你的**最小**任务

```
min: {
  js: {
    src: 'dest/js/concat.js',
    dest: 'dest/js/concat.min.js'
  }
}, 
```

内置**min**任务使用 UglifyJS，因此您需要替换。我发现**grunt-css**非常好。安装后，将其加载到您的 grunt 文件中

```
grunt.loadNpmTasks('grunt-css'); 
```

然后设置它

```
cssmin: {
  css:{
    src: 'dest/css/concat.css',
    dest: 'dest/css/concat.min.css'
  }
} 
```

请注意，用法类似于内置的 min。

`default`将您的任务更改为

```
grunt.registerTask('default', 'concat min cssmin'); 
```

现在，运行`grunt`将产生您想要的结果。

```
dest
├── css
│   ├── concat.css
│   └── concat.min.css
└── js
    ├── concat.js
    └── concat.min.js 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-11-28T00:56:23.500

我想在这里提一个非常非常有趣的技术，它被用于像 jQuery 和 Modernizr 这样的大型项目中用于连接事物。

这两个项目都是完全用 requirejs 模块开发的（你可以在他们的 github repos 中看到），然后他们使用 requirejs 优化器作为一个非常智能的连接器。有趣的是，正如您所见，无论是 jQuery，Modernizr 都不需要在 requirejs 上工作，这是因为他们删除了 requirejs 语法仪式以摆脱代码中的 requirejs。所以他们最终得到了一个使用 requirejs 模块开发的独立库！多亏了这一点，他们能够执行库的 cutsom 构建，以及其他优势。

对于所有对使用 requirejs 优化器进行连接感兴趣的人，请查看[这篇文章](http://augustoaltman.tumblr.com/post/103432024045/from-requirejs-modules-to-standalone-javascript)

还有一个小工具可以抽象出流程的所有样板：[AlbanilJS](https://www.npmjs.com/package/albaniljs)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-11T21:08:05.873

我同意楼上的回答。但这是 CSS 压缩的另一种方式。

您可以使用**YUI 压缩器**连接您的 CSS ：

```
module.exports = function(grunt) {
  var exec = require('child_process').exec;
   grunt.registerTask('cssmin', function() {
    var cmd = 'java -jar -Xss2048k '
      + __dirname + '/../yuicompressor-2.4.7.jar --type css '
      + grunt.template.process('/css/style.css') + ' -o '
      + grunt.template.process('/css/style.min.css')
    exec(cmd, function(err, stdout, stderr) {
      if(err) throw err;
    });
  });
}; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-21T17:08:39.940

您不需要添加 concat 包，您可以通过 cssmin 执行此操作，如下所示：

```
cssmin : {
      options: {
            keepSpecialComments: 0
      },
      minify : {
            expand : true,
            cwd : '/library/css',
            src : ['*.css', '!*.min.css'],
            dest : '/library/css',
            ext : '.min.css'
      },
      combine : {
        files: {
            '/library/css/app.combined.min.css': ['/library/css/main.min.css', '/library/css/font-awesome.min.css']
        }
      }
    } 
```

对于 js，像这样使用 uglify：

```
uglify: {
      my_target: {
        files: {
            '/library/js/app.combined.min.js' : ['/app.js', '/controllers/*.js']
        }
      }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-02T17:05:44.057

我认为可能更自动化，grunt task usemin 会为您完成所有这些工作，只需要一些配置：

[https://stackoverflow.com/a/33481683/1897196](https://stackoverflow.com/a/33481683/1897196)

# php - Erase everything but last X entries from an SQL table?

> ID：13713276
> 
> 赞同：0
> 
> 时间：2012-12-04T22:41:49.263
> 
> 标签：php, mysqli

Is there an MySQL query which would delete all values from a table, except the latest 20 entries (ordered by `id`)?

So let's say I have a table `notifications`, where 1000 notifications reside and I want to keep only latest 20.

If SQL is not enough for this, using `php` is optional.

I have a few ideas how to do this, but I don't really consider them efficient.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:51:20.517

You can find the latest id, store it into local variable and then delete everything below this id:

```
set @tmp_id := (select id from notifications order by id desc limit 20,1);
delete from notifications where id <= @tmp_id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:58:59.697

I have not ran this, so I apologize if it doesn't work, but according to the SQL syntax for delete this *should* work.

~~DELETE FROM notifications ORDER BY id ASC LIMIT ((SELECT COUNT(*) FROM notifications)-20);~~

```
$result = $mysqli->query("SELECT ids FROM notifications");
$count = $result->num_rows;
$count -=20;
$result = $mysqli->query("DELETE FROM notifications ORDER BY id ASC LIMIT $count"); 
```

# windows - 从 C++/Cx 中的框架对象转换为模板类

> ID：13713278
> 
> 赞同：2
> 
> 时间：2012-12-04T22:41:54.047
> 
> 标签：windows, visual-c++, casting, windows-runtime, c++-cx

我目前正在我的 WinRT 项目中创建一个新容器。此容器的行为类似于 ListView，因此我决定在其属性中使用相似的名称。

我为 ItemsSource 创建了一个 DependencyProperty 来模仿内置 ItemsControl 的（抽象父级到其他列表）。ItemsControl 将 ItemsSource 定义为`Platform::Object^`，所以我也这样做了。这工作正常。

稍后，是时候创建要进入列表的项目，使用指定 ItemsTemplate 的实例填充它们，并设置它们的数据上下文。这意味着我需要将 ItemsSource 实际`Platform::Object^`转换为可迭代的东西。不幸的是，要将其转换为可迭代的东西，我需要在转换中指定模板类型（例如`IIterable<UIElement^>^`or `IIterable<Object^>^`）。在这个阶段，我并不特别关心它是什么类型的对象，因为我只是将它用作新列表项的 DataContext，所以转换为`IIterable<Object^>^`就可以了。不幸的是，除非最初设置为 ItemsSource 的东西也被模板化为 a`IIterable<Object^>^`或某些子项，例如`IVectorView<Object^>^`.

使用现有容器（例如 ListView），您可以将 ItemsSource 设置为 a`Vector<MyCustomViewModel^>^`而无需先将其转换为 a`Vector<Object^>^`并且它工作得很好。那么他们是怎么做到的呢？他们不使用safe_cast吗？我很确定在这里使用不太安全的演员表会产生不利影响。还有其他想法吗？

**TL;博士：**

我有一些`Platform::Object^`我知道的参考指向其他参考的 IIterable。`IIterable<Platform::Object^>^`即使 iterable 最初是使用其他模板（例如）创建的，是否可以以某种方式将其转换为`IIterable<MyCustomViewModel^>^`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T01:44:10.033

因为 C++/CX 不支持类型协/逆变（`Platform::Vector<T^>`不实现`IVector<Object^>`），Xaml 团队添加了一个特殊的非泛型接口`Windows.UI.Xaml.Interop.IBindableObservableVector`，它为您提供了一个基于对象的集合进行迭代。Platform::Vector 专门实现了这个接口来处理你遇到的问题。因此，在您的情况下，您应该能够转换并使用这个特殊的接口。

我不确定 .NET 集合是否支持此接口，因此为了让您的自定义控件支持 C#/VB，您可能需要对 IBindableObservableVector 进行 dynamic_cast，如果结果为 nullptr，则尝试转换为其他集合类型（例如`IVector<Object^>`）。

# c# - 使用 Automapper 仅映射某些属性

> ID：13713287
> 
> 赞同：0
> 
> 时间：2012-12-04T22:42:39.453
> 
> 标签：c#, entity-framework, automapper

我正在尝试将模型映射到实体对象，但是当我映射从 DB 接收到的实体对象时 - 我的更改不会保存在数据库中。

这是一些代码：

映射配置：

```
Mapper.CreateMap<WalletUpdateModel, Wallet>()
    .ForMember(o => o.Name, m => m.MapFrom(d => d.Name))
    .ForMember(o => o.Currency, m => m.MapFrom(d => d.Currency)); 
```

实体对象：

```
public partial class Wallet
{
    public Wallet()
    {
        this.Transactions = new HashSet<Transaction>();
    }

    public int Id { get; set; }
    public int Owner { get; set; }
    public string Name { get; set; }
    public string Currency { get; set; }

    public virtual ICollection<Transaction> Transactions { get; set; }
} 
```

型号声明：

```
public class WalletUpdateModel
{
    [Required]
    [Range(1, int.MaxValue)]
    public int Id { get; set; }

    [Required]
    [MaxLength(128)]
    public string Name { get; set; }

    [Required]
    [MaxLength(3)]
    [DataType(DataType.Currency)]
    public string Currency { get; set; }
} 
```

以及来自即时窗口的一些调试信息：

```
w (before mapping)
{System.Data.Entity.DynamicProxies.Wallet_E3CA830BB5384920A3E07D4B44F15D2409093A34BFCED7CA33F9EC4102445554}
    [System.Data.Entity.DynamicProxies.Wallet_E3CA830BB5384920A3E07D4B44F15D2409093A34BFCED7CA33F9EC4102445554]: {System.Data.Entity.DynamicProxies.Wallet_E3CA830BB5384920A3E07D4B44F15D2409093A34BFCED7CA33F9EC4102445554}
    Currency: "PLN"
    Id: 2
    Name: "Cash"
    Owner: 1
    Transactions: Count = 0
w (after mapping)
{Financica.WebServices.Wallet}
    Currency: "PLN"
    Id: 2
    Name: "BZWBK"
    Owner: 0
    Transactions: Count = 0 
```

请帮我解决这个问题，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T22:14:58.397

对不起，但你还没有说哪个值被错误地映射。

由于具有相同名称的属性会按照约定自动映射，因此您当前的映射可以更改为：

```
Mapper.CreateMap<WalletUpdateModel, Wallet>(); 
```

如果您希望避免更新目标属性，可以使用该`UseDestinationValue`指令。如果您想对更新应用条件，您可以使用该`Condition`指令。如果您希望完全忽略该属性，可以使用该`Ignore`指令。

最后，您是否测试过您的映射以确保您没有遗漏任何内容？例如，您的映射看起来可能有问题，`Owner`因为`Transactions`它们没有在`WalletUpdateModel`类上定义。您可以使用以下内容测试您的映射：

```
Mapper.AssertConfigurationIsValid(); 
```

# jquery - 如何将 jQuery 的 serialize() 用于克罗地亚语字符？

> ID：13713298
> 
> 赞同：1
> 
> 时间：2012-12-04T22:43:29.993
> 
> 标签：jquery, ajax, character-encoding

我正在使用 jQuery 的`.serialize()`函数来发送数据`.ajax()`。我有一些克罗地亚语字符，例如 čćžšđ，但它们没有被正确发送。我如何对它们进行编码，以便在服务器端正确接收它们？

# java - Invoke a subclass method of an anonymous class

> ID：13713301
> 
> 赞同：0
> 
> 时间：2012-12-04T22:43:36.283
> 
> 标签：java, polymorphism, inner-classes, anonymous-class

I am trying right now to dig into anonymous classes and one question was just arised I'd prefer not to refer to much details and to pose my question straightforward: How can I invoke the method `sizzle()` in the following anonymous class:

```
public class Popcorn {
    public void pop() {
        System.out.println("popcorn");
    }
}

class Food {
    Popcorn p = new Popcorn() {
        public void sizzle() {
            System.out.println("anonymous sizzling popcorn");
        }

        public void pop() {
            System.out.println("anonymous popcorn");
        }
    };

    public void popIt() {
        p.pop(); // OK, Popcorn has a pop() method
        p.sizzle(); // Not Legal! Popcorn does not have sizzle()
    }
} 
```

It is known and definite in polymorphism rules that a refernce of a superclass cannot invoke methods of subclass without downcasting (even if it refers to an object of the given subclass). However in the above case what is the "key" to invoke the `sizzle()` method?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:48:47.197

The `sizzle()` method simply cannot be accessed from the outside, because the class is anonymous.

The `p` reference is a type `Popcorn`, and that doesn't define `sizzle()`.

Anonymous classes are meant to be one-shot, and are heavily used in some design patterns (like *Observer*) because Java doesn't have first class function, ie you can't pass function objects around.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T01:28:50.420

I kind of didn't expect this to work, but it does:

```
new Object() {
    public void foo() {}
}.foo(); 
```

The above will compile and work as expected. The explanation is that the type of the **expression** `new Object() {}` is the anonymous type that expression defines, not `Object`. However, you can't have a **variable** (or method parameter) of that type, which means that you can't invoke the method anywhere else except chained after the `new` expression.

Since this doesn't really solve your (unsolvable) problem, I admit it's more of a supplementary answer.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T22:54:46.073

When you call `p.sizzle()`, you need to have the `p` variable to be of a type that has the `sizzle()` method. The only way is to use a subclass or an interface. You can even cast, if you don't want to change the type of `p`, but you can't cast to a anonymous type.

If you need that class only inside the `Food` class, you should declare it in there

```
class Food {
    EdiblePopcorn p = new EdiblePopcorn() {

        @Override
        public void sizzle() {
            System.out.println("anonymous sizzling popcorn");
        }

        @Override
        public void pop() {
            System.out.println("anonymous popcorn");
        }
    };

    public void popIt() {
        p.pop(); // OK, Popcorn has a pop() method
        p.sizzle(); // Also legal! EdiblePopcorn now has sizzle()
    }

    private abstract class EdiblePopcorn extends Popcorn {
        // if the sizzle body is always the same, you can declare it here.
        void sizzle();
    }
} 
```

# facebook - 加载应用程序时打开登录屏幕

> ID：13713302
> 
> 赞同：1
> 
> 时间：2012-12-04T22:43:42.803
> 
> 标签：facebook, facebook-like, facebook-login

我的网站上有一个喜欢、分享、赢取的应用程序。

观看示例： [https ://www.facebook.com/ExpertLemmer/app_358973127531240](https://www.facebook.com/ExpertLemmer/app_358973127531240)

问题是，当您单击`like`并且您未登录时，FB 会打开登录屏幕，登录后它会重定向到我通常的 FB 粉丝页面，而不是下一个应用程序页面。当已经登录时，它应该像它一样工作。

有没有办法在第一页打开时强制人们登录？

# php - Magento 自定义购物车/结帐值在“下订单”时重置

> ID：13713307
> 
> 赞同：0
> 
> 时间：2012-12-04T22:43:51.850
> 
> 标签：php, oop, magento

我们正在使用 Magento Enterprise 1.10，并且一直在实施一种自定义方式来提供免费送货，并且对特定产品不征税。我已经成功地在购物车和 Onepage 结帐中实现了显示部分（第 5 步）。我遇到的问题是，当您单击“下订单”时，它会删除（或重置）subTotal、grandTotal 和 taxAmount 的自定义值。我可以在 sales_flat_quote 和 sales_flat_quote_item 表中看到，这些值是使用我给它的自定义值设置的。但是sales_flat_quote_address 表中的grandTotal 和taxAmount 设置不正确（不确定这是否相关，但假设）。它们正在按照 Magento 计算它们的默认方式重新计算。

因此，例如，我可能会将TaxAmount 设置为自定义值，例如 20 美元。但 Magento 采用产品价格和税率并重新计算。如果这是有道理的。

我已经在我们的 OnepageController.php 中的 saveOrderAction() 方法中指出了这一点

```
if ($data = $this->getRequest()->getPost('payment', false)) {
   $this->getOnepage()->getQuote()->getPayment()->importData($data);
} 
```

这部分代码正在用 Magento 通常设置它们的方式替换我设置的自定义值：

我的问题是为什么要阻止上述代码块重新计算值而只使用我已经设置的值：

```
Mage::getSingleton('checkout/session')->getQuote() 
```

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T09:37:38.573

您不能像下面这样设置订单金额。

`$quote->setGrandTotal(999.99)->save();`

因为小计，总计，税额是订单总额，并在以下代码调用时计算。

`$quote->collectTotals();`

这将合并您的价值。

只需检查 Mage_Sales_Model_Quote_Address_Total_Abstract 中名为 collect 的函数，并在函数开头添加以下代码。

```
foreach (Mage::getSingleton('checkout/cart')->getQuote()->getAllVisibleItems() as $item ) {
                 if ($item->getParentItem()) {
                     $item = $item->getParentItem();
                 }

                    $item->setTaxAmount(20);

                    $item->getProduct()->setIsSuperMode(true);
            } 
```

当然你应该重写这个方法。如果您想在模块的 config.xml 中覆盖，请使用下面

```
<sales>
            <quote>
                <totals>
                    <wrapping>
                        <class>pay/total_taksit</class>
                        <before>subtotal</before>
                    </wrapping>
                </totals>
            </quote>
        </sales> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:32:04.027

我不认为覆盖 onepage-controller 是应用自定义折扣/税收的最佳方式。最好在事件中放置一个观察者并在`sales_quote_collect_totals_after`此处重新计算订单总数/修改项目/应用折扣。

另外，我经常看到人们犯的错误是他们忘记调用 collectTotals()，或者他们忘记保存更改，即

```
$quote = Mage::getSingleton('checkout/session')->getQuote();
$quote->setGrandTotal(999.99)->save(); 
```

如果我错过了您的问题的要点，请提供更多详细信息。您在订单表中使用自定义列吗？

此致

# html - CSS3 悬停过渡奇怪的行为

> ID：13713309
> 
> 赞同：1
> 
> 时间：2012-12-04T22:44:00.823
> 
> 标签：html, css, hover, transition

所以我在玩转场/悬停效果，这就是代码。

HTML

```
 <section>
    <a href="#" title="button">CLICK!</a>
    <a href="#" title="button">CLICK!</a>
    <a href="#" title="button">CLICK!</a>
    <a href="#" title="button">CLICK!</a>
  </section> 
```

较少的

```
section {
    width: 700px;
    height: 500px;
    margin: 250px auto;
    position:  relative;
    background: #08c;

    a {
      border-radius: 51px;
      background: #e60;
      line-height: 100px;
      text-align: center;
      color: #04e;
      font-size: 24px;
      font-weight: bold;
      font-family: tahoma;
      text-decoration: none;
      display: block;
      width: 100px;
      height: 100px;

      &:nth-child(1){
          position: absolute;
          top: -100px;
          left: -100px;
          -webkit-transition: left 2s ease;

          &:hover,
          &:focus{
            left: 800px;
          }
      }
      &:nth-child(2){
          position: absolute;
          top: -100px;
          right: -100px;
          -webkit-transition: top 2s ease;

          &:hover{
            top: 600px;
          }
      }
      &:nth-child(3){
          position: absolute;
          bottom: -100px;
          right: -100px;
          -webkit-transition: right 2s ease;

          &:hover{
            right: 600px;
          }
      }
      &:nth-child(4){
          position: absolute;
          bottom: -100px;
          left: -100px;
          -webkit-transition: bottom 2s ease;

          &:hover{
            bottom: 600px;
          }
      }
  }
} 
```

示例：http: [//jsbin.com/anitob/1](http://jsbin.com/anitob/1)

但是，我偶然发现了一件奇怪的事情。当我将鼠标悬停在链接上时，它开始到达悬停应用的正确位置，但在某些时候（总是不同）效果停止并返回到原始位置！

有没有人看到这个并知道是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:02:29.217

@zeMinimalist 是对的。

绕过这个的方法（如果你想保持悬停效果）是移动图像而不是元素。

因此，基本上您的图像将是放置在具有悬停效果的元素顶部的虚拟元素。然后，当他们将鼠标悬停在“图像”上时，它会按预期移动并且不会重置，因为带有悬停触发器的元素没有移动。

所以是这样的：

```
.moving_element{
    left: 0px;
    -webkit-transition: bottom 2s ease;
} 
.static_element:hover .moving_element{
   left: 800px; 
} 
```

因此，用户将鼠标悬停在 上，`.static_element`但`.moving_element`是转换的那个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T22:50:11.930

问题是您的悬停效果是在移动的对象上。因此，一旦您完全移动鼠标，它就会自行重置，因为浏览器会识别出鼠标不再位于元素上。也许有时浏览器不需要您移动鼠标，这就是它看起来随机的原因。

# c - 函数调用上的段违规错误

> ID：13713311
> 
> 赞同：0
> 
> 时间：2012-12-04T22:44:02.377
> 
> 标签：c, windows, segmentation-fault

我编写了一个 C 程序来查找给定点集（随机生成）中所有点的 k 个最近邻居。问题是当我将点数（因此数组大小）增加到 10000 时，只要我调用该函数以找出最近的邻居，程序就会给出段冲突错误。我无法使用调试器进入函数内部。一旦我执行“Step Into”，程序就会崩溃。

我使用了代码块和 Eclipse CDT（在 Windows 7 上）并且都在同一点给出了错误。在代码块的情况下，它会给出段冲突，在 Eclipse 的情况下，它首先显示 - “在 0x4039a7 处没有可用于 __chkstk_ms() 的源”，然后错误来自操作系统本身 - “KNN.exe 已停止工作”但是程序在 Linux（Ubuntu 32 位）上运行良好。

这是代码片段：

#define MAX_SIZE 10000

```
 int main()
    {
        int n = MAX_SIZE;
        int k = 3;
        int i;

        double points[MAX_SIZE*2];  //2-D array in row-major order
        double result[MAX_SIZE*3*2];

        srand(time(NULL));

        for(i=0; i < n; i++)
        {
            points[i*2] = (double)rand()/(double)RAND_MAX;
            points[i*2 + 1] = (double)rand()/(double)RAND_MAX;
        }

        seek(points,n,k,result);   //<---------- ERROR

        seek(points,n,k,result);   //<------------ NO ERROR 
   ....
  }

 void seek(const double * const points, int n, int k, double *result)
 {

  TreeNode qtree[MAX_SIZE];
  int order_array[MAX_SIZE];

  int num_nodes = build_quadtree(a, n, k, qtree,order_array);   
  ......
  } 
```

结构树节点 { int id; 整数点；int start_order; int end_order; 诠释父母；诠释孩子[4]；结构矩形矩形；enum boolean is_leaf; };

结构点 { 双 x; 双 y; };

结构矩形 { int id; 双倍 xmin,xmax,ymin, ymax; 结构点中点；};

更令人困惑的是，我有另一个具有相同参数的函数正在运行，没有任何问题。请提供有关如何调试此问题的建议。

编辑：- 。我已经发布了 seek() 函数的前几行。正如回复所指出的那样，我实际上在 seek 函数上分配了很多内存，但我想知道为什么这在 linux 中不是问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:04:23.087

我认为您超出了可用堆栈（请参阅[_chkstk](http://support.microsoft.com/kb/100775)上的 MSDN 文档）。尝试动态分配数组

```
int main()
{
    double* points = malloc(sizeof(double) * MAX_SIZE*2];
    double* result = malloc(sizeof(double) * MAX_SIZE*3*2];
    ...
    free(points);
    free(result);
} 
```

当您调用`seek`. 您尚未发布它的代码，但可能还必须对其进行返工以减少其堆栈使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T04:53:30.390

也许下面的代码是真正的罪魁祸首。qtree 和 orderarray 也是堆栈分配的。我会将 MAX_SIZE 更改为较低的值，然后再查看问题。

TreeNode qtree[MAX_SIZE]; int order_array[MAX_SIZE];

# iphone - iphone - 在 UIScrollView 中滚动时缩小图像

> ID：13713313
> 
> 赞同：0
> 
> 时间：2012-12-04T22:44:17.000
> 
> 标签：iphone, objective-c, ios, user-interface

所以我的`UIScrollView`应用程序菜单中有一个。我启用了分页，每个页面都包含一个按钮和一个图像。我想添加一个小动画，当它们从屏幕上消失时（当用户滚动到下一页时）它们开始缩小。

我知道我可以通过为每个按钮和图像创建一个属性然后手动更改`scrollViewDidScroll`方法中的帧大小来做到这一点。

有没有人有一个更优雅的解决方案，这样我就不必对每一个都进行硬编码？这可能有一个预定义的属性或什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:47:11.323

滚动视图中的每个“页面”实际上是视图还是视图控制器？不管它是什么，希望它是某个类的一个实例，因此是可重用的。向自定义视图/视图控制器添加一个方法，该方法使用 UIView animateWithDuration: 方法使按钮和图像缩小。当您确定滚动视图已足够移动时调用该方法。

# sql - 在 PostgreSQL 中使用 CASE 一次影响多个列

> ID：13713316
> 
> 赞同：31
> 
> 时间：2012-12-04T22:44:20.867
> 
> 标签：sql, postgresql, case

我有一个`SELECT`带有这些表达式的 Postgres 语句：

```
,CASE WHEN (rtp.team_id = rtp.sub_team_id)
 THEN 'testing'
 ELSE TRIM(rtd2.team_name)
 END AS testing_testing
,CASE WHEN (rtp.team_id = rtp.sub_team_id)
 THEN 'test example'
 ELSE TRIM(rtd2.normal_data)
 END AS test_response
,CASE WHEN (rtp.team_id = rtp.sub_team_id)
 THEN 'test example #2'
 ELSE TRIM(rtd2.normal_data_2)
 END AS another_example 
```

在我的特定查询中，有 5 个字段的输出取决于`rtp.team_id = rtp.sub_team_id`评估是否为真。我`CASE`一遍又一遍地重复具有相同条件的语句。

有什么方法可以组合这些`CASE`表达式来一次切换多列的输出？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-05T00:03:47.760

## 1\. Standard-SQL：`LEFT JOIN`单行值

您可以[`LEFT JOIN`](https://www.postgresql.org/docs/current/sql-select.html#SQL-FROM)使用条件的一行值（从而评估一次）。然后，您可以使用[`COALESCE()`](https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL).

这种语法变体更短，并且具有多个值，速度稍快 - 对于昂贵/冗长的条件特别有趣：

```
SELECT COALESCE(x.txt1, trim(r2.team_name))     AS testing_testing
     , COALESCE(x.txt2, trim(r2.normal_data))   AS test_response
     , COALESCE(x.txt3, trim(r2.normal_data_2)) AS another_example
FROM   rtp
JOIN   rtd2 r2 ON <unknown condition> -- missing context in question
LEFT   JOIN (
   SELECT 'testing'::text         AS txt1
        , 'test example'::text    AS txt2
        , 'test example #2'::text AS txt3
   ) x ON rtp.team_id = rtp.sub_team_id; 
```

由于派生表`x`由*单行*组成，因此无需其他条件即可连接。

*子查询中需要*显式类型转换。*我`text`在示例中使用（无论如何这是字符串文字的默认值）。使用您的实际数据类型。语法快捷方式`value::type`是 Postgres 特有的，`cast(value AS type)`用于标准 SQL。*

 *如果条件不是`TRUE`，则所有值`x`都为 NULL，并`COALESCE`开始执行。

**或者**`rtd2`，由于在您的特定情况下所有候选值都来自表`LEFT JOIN`，`rtd2`因此使用原始`CASE`条件和`CROSS JOIN`具有默认值的行：

```
SELECT COALESCE(trim(r2.team_name),     x.txt1) AS testing_testing
     , COALESCE(trim(r2.normal_data),   x.txt2) AS test_response
     , COALESCE(trim(r2.normal_data_2), x.txt3) AS another_example
FROM   rtp
LEFT   JOIN rtd2 r2 ON <unknown condition>  -- missing context in question
                   AND rtp.team_id = rtp.sub_team_id
CROSS  JOIN (
   SELECT 'testing'::text         AS txt1
        , 'test example'::text    AS txt2
        , 'test example #2'::text AS txt3
   ) x; 
```

这取决于连接条件和查询的其余部分。

## 2\. PostgreSQL 特有的

### 2a。展开数组

如果您的各个列共享***相同的数据类型***，您可以在子查询中使用数组并在外部扩展它`SELECT`：

```
SELECT x.combo[1], x.combo[2], x.combo[3]
FROM  (
   SELECT CASE WHEN rtp.team_id = rtp.sub_team_id
            THEN '{test1,test2,test3}'::text[]
            ELSE ARRAY[trim(r2.team_name)
                     , trim(r2.normal_data)
                     , trim(r2.normal_data_2)]
          END AS combo
   FROM   rtp
   JOIN   rtd2 r2 ON <unknown condition>
   ) x; 
```

如果列不共享相同的数据类型，它会变得更加复杂。您可以将它们全部转换为`text`（并可选择转换回外部`SELECT`），或者您可以...

### 2b。分解行类型

您可以使用自定义复合类型（行类型）来保存各种类型的值，并简单地将其 *-expand 到 external 中`SELECT`。假设我们有三列`text`：`integer`和`date`。为了*重复*使用，创建一个自定义复合类型：

```
CREATE TYPE my_type (t1 text, t2 int, t3 date); 
```

**或者**，如果现有表的类型匹配，您可以只使用表名作为复合类型。

**或者**，如果您只需要*临时*类型，您可以创建一个，在*会话*`TEMPORARY TABLE`期间注册一个临时类型：

 *```
CREATE TEMP TABLE my_type (t1 text, t2 int, t3 date); 
```

您甚至可以为*单个事务*执行此操作：

```
CREATE TEMP TABLE my_type (t1 text, t2 int, t3 date) ON COMMIT DROP; 
```

然后你可以使用这个查询：

```
SELECT (x.combo).*  -- parenthesis required
FROM  (
   SELECT CASE WHEN rtp.team_id = rtp.sub_team_id
             THEN ('test', 3, now()::date)::my_type  -- example values
             ELSE (r2.team_name
                 , r2.int_col
                 , r2.date_col)::my_type
          END AS combo
   FROM   rtp
   JOIN   rtd2 r2 ON <unknown condition>
   ) x; 
```

甚至只是（与上面相同，更简单，更短，可能不太容易理解）：

```
SELECT (CASE WHEN rtp.team_id = rtp.sub_team_id
           THEN ('test', 3, now()::date)::my_type
           ELSE (r2.team_name, r2.int_col, r2.date_col)::my_type
        END).*
FROM   rtp
JOIN   rtd2 r2 ON <unknown condition>; 
```

以这种`CASE`方式对每一列计算一次表达式。如果评估不是微不足道的，那么带有子查询的另一个变体会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:11:29.480

不确定这是否会有所改进，但您可以将`SELECT`一种方式与另一种方式结合起来：

```
SELECT 
  ...,
  'testing' AS testing_testing,
  'test example' AS test_response,
  'test example #2' AS another_example, ...
FROM ...
WHERE rtp.team_id = rtp.sub_team_id AND ...
UNION 
SELECT
  ...,
  TRIM(rtd2.team_name) AS testing_testing,
  TRIM(rtd2.normal_data) AS test_response,
  TRIM(rtd2.normal_data_2) AS another_example, ...
WHERE rtp.team_id <> rtp.sub_team_id AND ...; 
```

列名可以安全地从第二个查询中省略，假设您以与第一个相同的顺序将它们取出。

您可能希望使用公用表表达式 (CTE) 将其中的每一个都设为单独的查询。如果您担心这会更改顺序，可以将其设为子查询并`ORDER BY`在其周围应用。**

# c - 在压缩的 PE 中，数据部分的虚拟大小必须与原始大小相匹配吗？

> ID：13713317
> 
> 赞同：0
> 
> 时间：2012-12-04T22:44:22.880
> 
> 标签：c, windows, linker, executable, portable-executable

在使用具有 4 个字节的文件对齐和节对齐的压缩 PE（Windows 控制台 EXE）时，我注意到如果节的虚拟大小和原始大小匹配，则程序加载，但如果数据节的虚拟大小，最后一部分不匹配，则 Windows 拒绝加载它，即使按照规范，您应该能够拥有大于原始大小的虚拟大小。

这是对压缩 PE 的某种隐藏约束吗？

我在下面粘贴了一个 exe 的垃圾箱/标题：

```
Microsoft (R) COFF/PE Dumper Version 10.00.30319.01
Copyright (C) Microsoft Corporation.  All rights reserved.

Dump of file ba42x.exe

PE signature found

File Type: EXECUTABLE IMAGE

FILE HEADER VALUES
             14C machine (x86)
               2 number of sections
        50AABC14 time date stamp Mon Nov 19 18:09:08 2012
               0 file pointer to symbol table
               0 number of symbols
              60 size of optional header
             10F characteristics
                   Relocations stripped
                   Executable
                   Line numbers stripped
                   Symbols stripped
                   32 bit word machine

OPTIONAL HEADER VALUES
             10B magic # (PE32)
            2.03 linker version
             BD0 size of code
            5000 size of initialized data
               0 size of uninitialized data
              CC entry point (004000CC)
              CC base of code
             C9C base of data
          400000 image base (00400000 to 00403FFF)
               4 section alignment
               4 file alignment
            4.00 operating system version
            0.00 image version
            4.00 subsystem version
               0 Win32 version
            4000 size of image
              CC size of headers
               0 checksum
               3 subsystem (Windows CUI)
               0 DLL characteristics
           10000 size of stack reserve
            1000 size of stack commit
               0 size of heap reserve
               0 size of heap commit
               0 loader flags
               0 number of directories

SECTION HEADER #1
   .text name
     BD0 virtual size
      CC virtual address (004000CC to 00400C9B)
     BD0 size of raw data
      CC file pointer to raw data (000000CC to 00000C9B)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
E0000020 flags
         Code
         Execute Read Write

SECTION HEADER #2
   .data name
    3102 virtual size
     C9C virtual address (00400C9C to 00403D9D)
    3102 size of raw data
     C9C file pointer to raw data (00000C9C to 00003D9D)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
C0000040 flags
         Initialized Data
         Read Write

  Summary

        3104 .data
         BD0 .text 
```

例如，如果您将上述 .data 部分的虚拟大小更改为 3106，则程序将不会加载，即使初始化数据 (0x5000) 的大小足以容纳额外的内存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T08:06:23.073

不，没有与压缩图像相关的特殊限制，因为只要您的图像符合 PE，加载程序就不会关心压缩。压缩由存根处理，而不是加载程序。

您能否提供您的图像以供进一步分析？

只看dumpbin的输出，图像看起来很不寻常。。根本没有目录，很奇怪。看起来加载器的问题与对齐没有直接关系，而是图像文件的格式错误。您是否尝试使用其他 PE 工具（例如 PeStudio、CFF Explorer ..）查看您的图像文件？

# windows - ping 网络、windows 中的所有地址

> ID：13713318
> 
> 赞同：58
> 
> 时间：2012-12-04T22:44:24.210
> 
> 标签：windows, batch-file, cmd

是否可以在 windows cmd 行中检查所有网络地址（使用 ping 或类似地址）以查看哪些网络地址被占用/有活动设备：

IE。执行以下操作的操作：

```
for i = 0 to 255
    ping 192.168.1.i //Print this
end 
```

这显然是伪代码。我想知道是否可以在 windows cmd 中执行类似的操作。如果您不需要批处理文件，那就太好了，但我知道这是否不可能。

PS。另外请提及是否有程序可以执行此操作，但最好在 cmd 中执行此操作。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2012-12-04T22:50:03.533

打开命令提示符并输入以下内容：

```
FOR /L %i IN (1,1,254) DO ping -n 1 192.168.10.%i | FIND /i "Reply">>c:\ipaddresses.txt 
```

更改 192.168.10 以匹配您自己的网络。

通过使用 -n 1，您只要求向每台计算机发送 1 个数据包，而不是通常的 4 个数据包。

上述命令将 ping 192.168.10.0 网络上的所有 IP 地址，并在 C:\ 驱动器中创建一个名为 ipaddresses.txt 的文本文档。此文本文档应仅包含回复 ping 请求的 IP 地址。

虽然完成需要相当长的时间，但您也可以通过在 ping 命令中添加 -a 来将 IP 地址解析为主机名称。

```
FOR /L %i IN (1,1,254) DO ping -a -n 1 192.168.10.%i | FIND /i "Reply">>c:\ipaddresses.txt 
```

这是从[这里](http://www.itresource.com.au/2008/04/11/find-all-activeused-ip-addresses-on-your-network/)

希望这可以帮助

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-05-27T15:42:45.637

我知道这是一个迟到的响应，但一个巧妙的方法是 ping 填充本地 arp 缓存的广播地址。

然后可以通过运行 arp -a 来显示这将列出本地 arp 表中的所有地址。

```
ping 192.168.1.255
arp -a 
```

希望这是人们可以使用的一个不错的选择。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-09-30T13:49:02.183

就速度而言，最佳实用程序是**Nmap**。

写@cmd提示：

> nmap -sn -oG ip.txt 192.168.1.1-255

这只会 ping 给定范围内的所有 IP 地址并将其存储在简单的文本文件中

使用 Nmap扫描**255**台主机仅需**2秒。**

 *** * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-04-21T15:21:22.393

如果 windows 框位于同一子网中：

```
for /L %a in (1,1,254) do start ping 192.168.0.%a 
```

这将在 15 秒内完成，并且

```
arp -a 
```

将返回任何活着的主机。

我在 Windows 中知道的最快的本地方式。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-04T22:54:20.567

这篇文章提出了同样的问题，但对于 linux - 您可能会发现它很有帮助。 [向子网上的每个 IP 发送 ping](https://stackoverflow.com/questions/503171/send-a-ping-to-each-ip-on-a-subnet)

nmap 可能是最好的工具，因为它可以帮助识别主机操作系统并且速度更快。它可用于 nmap.org 站点上的 windows 平台

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-04T22:48:38.893

您要做的就是查看计算机是否连接到网络并收集它们的 IP 地址。您可以使用angeryIP 扫描器：[http](http://angryip.org/) ://angryip.org/查看特定子网或子网组上正在使用的IP 地址。

在尝试查看正在使用的 IP 不在我的 DHCP 内时，我发现此工具非常有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-09T18:17:01.103

egmackenzie 针对 Windows 的“arp -a”解决方案的扩展和有用的补充 -

**在 WiFi 网络上搜索我的 iPhone 的 Windows 示例**

(pre: iPhone WiFi 禁用)

*   [在管理员模式下打开命令提示符](http://www.thewindowsclub.com/how-to-run-command-prompt-as-an-administrator)（RC 开始并查看菜单）
*   arp -d <- 清除 arp 列表！
*   ping 10.1.10.255 <- 使用您的子网，然后 ping '255'，每个人
*   ARP -a
*   iPhone WiFi 开启
*   平 10.1.10.255
*   ARP -a

请参见下面的示例：

[![在此处输入图像描述](../Images/908316c210a313ced38578e5ea391b35.png)](http://www.thewindowsclub.com/how-to-run-command-prompt-as-an-administrator)

如果有兴趣，这里有一篇关于使用 'arp -d' 的好文章——

*   [TechRepublic - 快速提示 在 Windows 7 中刷新 ARP 缓存](http://www.techrepublic.com/blog/windows-and-office/quick-tips-flush-the-arp-cache-in-windows-7/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-11T19:05:08.580

在 Windows 8 上的批处理脚本中似乎有些事情发生了变化，而 DGG 上面的解决方案现在导致命令提示符崩溃。

以下解决方案对我有用：

```
@echo off
set /a n=0
:repeat
set /a n+=1
echo 192.168.1.%n%
ping -n 1 -w 500 192.168.1.%n% | FIND /i "Reply">>ipaddresses.txt
if %n% lss 254 goto repeat
type ipaddresses.txt 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-03-26T07:55:01.743

[aping](https://www.iea-software.com/aping)可以提供主机列表以及每个主机是否已响应 ping。

```
 aping -show all 192.168.1.* 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-08T16:33:42.853

```
@ECHO OFF

IF "%SUBNET%"=="" SET SUBNET=10

:ARGUMENTS
ECHO SUBNET=%SUBNET%
ECHO ARGUMENT %1 
IF "%1"=="SUM" GOTO SUM
IF "%1"=="SLOW" GOTO SLOW
IF "%1"=="ARP" GOTO ARP
IF "%1"=="FAST" GOTO FAST

REM PRINT ARP TABLE BY DEFAULT
:DEFAULT
ARP -a
GOTO END

REM METHOD 1 ADDRESS AT A TIME
:SLOW
ECHO START SCAN
ECHO %0 > ipaddresses.txt
DATE /T >> ipaddresses.txt
TIME /T >> ipaddresses.txt
FOR /L %%i IN (1,1,254) DO ping -a -n 2 192.168.%SUBNET%.%%i | FIND /i "TTL="  >> ipaddresses.txt
GOTO END

REM METHOD 2 MULTITASKING ALL ADDRESS AT SAME TIME
:FAST
ECHO START FAST SCANNING 192.168.%SUBNET%.X
set /a n=0
:FASTLOOP
set /a n+=1
ECHO 192.168.%SUBNET%.%n%
START CMD.exe /c call ipaddress.bat 192.168.%SUBNET%.%n% 
IF %n% lss 254 GOTO FASTLOOP
GOTO END

:SUM
ECHO START SUM
ECHO %0 > ipaddresses.txt
DATE /T >> ipaddresses.txt
TIME /T >> ipaddresses.txt
FOR /L %%i IN (1,1,254) DO TYPE ip192.168.%SUBNET%.%%i.txt | FIND /i "TTL=" >> ipaddresses.txt
FOR /L %%i IN (1,1,254) DO DEL ip192.168.%SUBNET%.%%i.txt
type ipaddresses.txt
GOTO END

:ARP
ARP -a >> ipaddresses.txt
type ipaddresses.txt
GOTO END

:END
ECHO DONE WITH IP SCANNING
ECHO OPTION "%0 SLOW" FOR SCANNING 1 AT A TIME
ECHO OPTION "%0 SUM" FOR COMBINE ALL TO FILE
ECHO OPTION "%0 ARP" FOR ADD ARP - IP LIST
ECHO PARAMETER "SET SUBNET=X" FOR SUBNET
ECHO. 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2014-12-02T17:29:27.213

```
for /l %%a in (254, -1, 1) do ( 
    for /l %%b in (1, 1, 254) do (
        for %%c in (20, 168) do (
            for %%e in (172, 192) do (
                ping /n 1 %%e.%%c.%%b.%%a>>ping.txt
            )
        )
    )
)
pause>nul 
```**

# ios - 关于标签和行高动态调整大小的问题 (iOS)

> ID：13713322
> 
> 赞同：1
> 
> 时间：2012-12-04T22:44:36.033
> 
> 标签：ios, cocoa-touch, uitableview, dynamic, resize

语境：

*   构建一个应用程序，该应用程序填充一个从 asyc json 转储中获取数据的表。
*   单元格属于自定义类（我定义）。单元格中的主标签可以很长。
*   它被“放置”在原型单元中的情节提要中，但通过代码（非常标准的东西）进行定制。
*   标签在 cellForRowAtIndexPath 中调整大小，行通过 heightForRowAtIndexPath 调整大小 - 通过强制调用 cellForRowAtIndex 来调整行大小，就像 Massimo [在此处的回答](https://stackoverflow.com/questions/4823197/iphone-when-to-calculate-heightforrowatindexpath-for-a-tableview-when-each-cel/13696359#13696359)

所以根据手头的问题 - 我注意到发生了一些有趣的（坏的）事情。

第一个问题：当表格加载时，行和标签会正确地动态调整大小！伟大的！但是，当我向下滚动然后向上滚动时，标签高度将不正确——（例如）第一行在加载时是正确的。然后当我向下滚动然后向上滚动以再次查看它时，它将被截断。具体来说，行大小会很好，但标签高度会改变并被截断为仅 2 行。想知道这是否是因为我同时进行了故事板和编码来自定义单元格。有人以前看过这个吗？

第二个问题：当我向下滚动时，虽然行的大小正确（大），但标签很短（被截断。）想知道它是否与上述“潜在答案”相反。

*   *“可能的答案”*是所有行都是“预先”计算和存储的，因此向下滚动/然后向后滚动不会影响它。但是，当单元格“不在视野范围内”并出列时，当它们重新查看（向下滚动/然后向后滚动）时，它将依赖故事板。（不恰当？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:57:41.750

您的所有三个问题都是在 heightForRowAtIndexPath 中返回错误高度的症状。在我的数据模型类中，我有一个在 heightForRowAtIndexPath 中调用的 calculateHeight 方法。该模型还缓存了答案，因此它不必在第一次调用后重新计算它。单元类使用模型的计算高度来布局其子视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:41:51.377

通过从情节提要中删除原型单元并将它们完全用代码来“回答”，问题就消失了。基本的工作原理仍未被理解（即当单元被放入队列然后再次查看时故事板与代码之间的交互）

# ms-access - 从 Access DB 发送包含动态名称附件的电子邮件

> ID：13713327
> 
> 赞同：2
> 
> 时间：2012-12-04T22:45:15.167
> 
> 标签：ms-access, vba

我不知道如何让这件事超出这一点。我下面的代码会发送一封电子邮件，其中包含 MS Access 2010 的附件。

问题是如果它需要一个固定的文件名，我的文件名会随着我使用每个文件末尾的日期而改变。例如：green_12_04_2012.csv。如果文件夹为空或目录更改，我也不知道如何使它不会失败。如果它只是跳到下一个子而不是崩溃，那就太好了。

我的代码：

```
Dim strGetFilePath As String
Dim strGetFileName As String

strGetFilePath = "C:\datafiles\myfolder\*.csv"

strGetFileName = Dir(strGetFilePath)

Dim appOutLook As Outlook.Application
Dim MailOutLook As Outlook.MailItem
Set appOutLook = CreateObject("Outlook.Application")
Set MailOutLook = appOutLook.CreateItem(olMailItem)
With MailOutLook
    .BodyFormat = olFormatRichText
    .To = "bob@builder.com"
    ''.cc = ""
    ''.bcc = ""
    .Subject = "text here"
    .HTMLBody = "text here"
    .Attachments.Add (strGetFileName & "*.csv")
    .Send
End With
End Sub 
```

我想我快到了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:42:48.047

我找到了一个合适的解决方案，除了发布的解决方案之外，我还想添加这个以防万一有人在寻找解决方案。我一直到凌晨 3 点，这是一个非常受欢迎的问题，但没有任何关于循环附加特定文件夹中的所有文件的解决方案。

这是代码：

```
Public Sub sendEmail()
    Dim appOutLook As Outlook.Application
    Dim MailOutLook As Outlook.MailItem
    Dim strPath As String
    Dim strFilter As String
    Dim strFile As String

    strPath = "C:\Users\User\Desktop\"      'Edit to your path
    strFilter = "*.csv"
    strFile = Dir(strPath & strFilter)

    If strFile <> "" Then

        Set appOutLook = CreateObject("Outlook.Application")
        Set MailOutLook = appOutLook.CreateItem(olMailItem)

        With MailOutLook
            .BodyFormat = olFormatRichText
            .To = "bob@builder.com"
            ''.cc = ""
            ''.bcc = ""
            .Subject = "text here"
            .HTMLBody = "text here"
            .Attachments.Add (strPath & strFile)
            .Send
            '.Display    'Used during testing without sending (Comment out .Send if using this line)
        End With
    Else
        MsgBox "No file matching " & strPath & strFilter & " found." & vbCrLf & _
                "Processing terminated.
        Exit Sub    'This line only required if more code past End If
    End If

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T04:31:58.107

这是我在一个论坛上找到的代码，不记得在哪里，但我稍微修改了一下，这给了你文件的完整路径，它使用通配符搜索文件夹和子文件夹

```
Function fSearchFileWild(FileName As String, Extenstion As String)
Dim strFileName As String
Dim strDirectory As String

strFileName = "*" & FileName & "*." & Extenstion
strDirectory = "C:\Documents and Settings\"

fSearchFileWild = ListFiles(strDirectory, strFileName, True)

End Function

Public Function ListFiles(strPath As String, Optional strFileSpec As String, _
    Optional bIncludeSubfolders As Boolean, Optional lst As ListBox)
On Error GoTo Err_Handler

Dim colDirList As New Collection
Dim varItem As Variant

Call FillDir(colDirList, strPath, strFileSpec, bIncludeSubfolders)

Dim counter As Integer
counter = 0
Dim file1 As String
Dim file2 As String
Dim file3 As String

For Each varItem In colDirList
    If file1 = "" Then
    file1 = varItem
    counter = 1
    ElseIf file2 = "" Then
    file2 = varItem
    counter = 2
    ElseIf file3 = "" Then
    file3 = varItem
    counter = 3
    End If
Next
'if there is more than 1 file, msgbox displays first 3 files
If counter = 1 Then
ListFiles = file1
ElseIf counter > 1 Then
MsgBox "Search has found Multiple files for '" & strFileSpec & "', first 3 files are: " & vbNewLine _
        & vbNewLine & "file1: " & file1 & vbNewLine _
        & vbNewLine & "file2: " & file2 & vbNewLine _
        & vbNewLine & "file3: " & file3
ListFiles = "null"
Else
ListFiles = "null"
End If

Exit_Handler:

    Exit Function

Err_Handler:

    MsgBox "Error " & Err.Number & ": " & Err.Description

    Resume Exit_Handler

End Function

Private Function FillDir(colDirList As Collection, ByVal strFolder As String, strFileSpec As String, _
    bIncludeSubfolders As Boolean)
    'Build up a list of files, and then add add to this list, any additional folders
    Dim strTemp As String
    Dim colFolders As New Collection
    Dim vFolderName As Variant

    'Add the files to the folder.
    strFolder = TrailingSlash(strFolder)
    strTemp = Dir(strFolder & strFileSpec)
    Do While strTemp <> vbNullString
        colDirList.Add strFolder & strTemp
        strTemp = Dir
    Loop

    If bIncludeSubfolders Then
        'Build collection of additional subfolders.
        strTemp = Dir(strFolder, vbDirectory)
        Do While strTemp <> vbNullString
            If (strTemp <> ".") And (strTemp <> "..") Then
                If (GetAttr(strFolder & strTemp) And vbDirectory) <> 0& Then
                    colFolders.Add strTemp
                End If
            End If
            strTemp = Dir
        Loop
        'Call function recursively for each subfolder.
        For Each vFolderName In colFolders
            Call FillDir(colDirList, strFolder & TrailingSlash(vFolderName), strFileSpec, True)
        Next vFolderName
    End If
End Function

Public Function TrailingSlash(varIn As Variant) As String
    If Len(varIn) > 0& Then
        If Right(varIn, 1&) = "\" Then
            TrailingSlash = varIn
        Else
            TrailingSlash = varIn & "\"
        End If
    End If
End Function 
```

# sql-server - 删除内部以空格分隔的字段部分

> ID：13713331
> 
> 赞同：1
> 
> 时间：2012-12-04T22:45:43.793
> 
> 标签：sql-server, sql-server-2008, tsql, csv

我在 SQL Server 2008 数据库中有大量行

对于每一行，我有 3 列我关心

典型的行如下所示：

```
AccountNumber    | basecode                      | subcode
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
9689787209368901 | AQTXG AQTXG AQTXG AQTXG ACC5Z | ZQ596 ZQ596 ZQ596 ZQ655 ZC655 
```

某些基码需要连同其相应的子码一起被删除。basecode 和 supcode 都是由空格分隔的有序列表。我需要一个输入基本代码的查询，它会删除基本代码和子代码，并使列表的其余部分保持不变。

每行具有相同数量的基码和子码项。代码的数量可以从 0 到 45 不等。相同的基码可以出现多次。所有字段都是 varchars。

这样数据最终（动态解析）如下：（因为每个账户有可变数量的基码/子码（对）。

如果我想删除“ACC5Z”，那么我应该有

```
AccountNumber    | basecode                | subcode
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
9689787209368901 | AQTXG AQTXG AQTXG AQTXG | ZQ596 ZQ596 ZQ596 ZQ655 
```

如果我想删除“AQTXG”，那么我应该

```
AccountNumber    | basecode   | subcode
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
9689787209368901 | ACC5Z      | ZC655 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T03:28:21.767

试试这个

```
DECLARE @t TABLE (AccountNumber VARCHAR(100),Basecode VARCHAR(100),Subcode VARCHAR(100))
INSERT INTO @t SELECT 9689787209368901,'AQTXG AQTXG AQTXG AQTXG ACC5Z','ZQ596 ZQ596 ZQ596 ZQ655 ZC655'

DECLARE @BaseCodetoRemove VARCHAR(10) = 'AQTXG'

;WITH CTE AS(
SELECT  
    AccountNumber
    ,LTRIM(RTRIM(SUBSTRING(Basecode, Number ,CHARINDEX(' ', Basecode + ' ', Number ) - Number))) AS Basecode
    , LTRIM(RTRIM(SUBSTRING(Subcode, Number ,CHARINDEX(' ', Subcode + ' ', Number ) - Number))) AS Subcode
FROM @t 
JOIN master..spt_values ON Number <= DATALENGTH(Basecode) + 1  AND type='P'
AND SUBSTRING(' ' + Basecode, Number , 1) = ' ')
,CTE2 AS(
SELECT * 
FROM CTE 
WHERE BaseCode <> @BaseCodetoRemove)

SELECT AccountNumber
    ,STUFF((SELECT  ' ' + CAST(Basecode AS vARCHAR(MAX))
      FROM CTE2 t2 WHERE t1.AccountNumber = t2.AccountNumber
      FOR XML PATH('')),1,1,'')Basecode

    ,STUFF((SELECT ' ' + CAST(Subcode AS vARCHAR(MAX))
      FROM CTE2 t2 WHERE t1.AccountNumber = t2.AccountNumber
      FOR XML PATH('')),1,1,'')Subcode
FROM CTE2  t1
GROUP BY t1.AccountNumber 
```

# java - 控制字谜词

> ID：13713337
> 
> 赞同：1
> 
> 时间：2012-12-04T22:45:58.313
> 
> 标签：java, algorithm

这是我的代码。但它不起作用。请帮助我了解我的问题在哪里。这对我来说很复杂。我的代码必须发现我的 2 个输入是否是字谜。（例如：沉默和倾听）

```
 import java.util.Scanner ;
    import java.lang.String ;
    public class Anagram {

public static void main(String[] args) {
    Scanner scanner = new Scanner (System.in) ;

    System.out.println("Enter your firs word: ");
    String s1= scanner.nextLine() ;
    System.out.println("Enter your second word: ");
    String s2 = scanner.nextLine() ;

    if(isAnagram(s1,s2)){

        System.out.println("Your words are anagram") ;

  }
}

public static boolean isAnagram(String s1, String s2) {

   int a = s1.length() ;
   int b= s2.length() ;
    if (a==b){
        int count=0;
        int i,j ;
        char x, y ;
        for (i=0, j=0; i<=a; i++){

         x = s1.charAt(i) ;

        y = s2.charAt(j);

        j++;
        if (x==y){
            count++ ;
      while (count==a){
          return true;
      }
                    return false;
        }
    }  
    }

} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:14:08.103

由于您不能使用数组，因此一种方法可以是：

```
public boolean isAnagram(String a, String b) {

    if(a.length() != b.length()) return false;

    for (int i=0; i < a.length(); i++) {
        for (int j=0; j <b.length(); j++) {

            if (a.charAt(i) == b.charAt(j))
            {

               a = removeCharAt(a,i);
               b = removeCharAt(b,j);
                i=0;
                j=0;
            }
        }
    }
    return a.equals(b);
} 
```

其中 removeCharAt 是：

```
public static String removeCharAt(String s, int pos) {
   return s.substring(0,pos)+s.substring(pos+1);

} 
```

第一个测试是验证两个字符串是否具有相同的大小。如果有，那么您首先从第一个字符串中获取一个字符，然后检查该字符是否存在于第二个字符串中。如果存在，则从两个字符串中删除此字符。并从第一个字符串中取出另一个字符并重复该过程，直到没有更多字符可供比较。最后，如果最终结果字符串等于它们是字谜。

您应该删除两个字符串的字符以避免这种情况，例如 string a ="AAAAA" 和 string b ="Abbbb" 它会给你一个字谜。由于字符串“a”的每个字符都将匹配字符串“b”的第一个位置。

您的代码中存在一些问题：

```
public static boolean isAnagram(String s1, String s2) {

   int a = s1.length() ;
   int b= s2.length() ;

if (a==b){
    int count=0;
    int i,j ;
    char x, y ;
    for (i=0, j=0; i<=a; i++){

     x = s1.charAt(i) ;

    y = s2.charAt(j);

    j++;
    if (x==y){
        count++ ;
  while (count==a){
      return true;
  }
                return false;
    }
}  
} 
```

}

`i<=a`由于在 for 和. 内，您将遇到超出范围的错误`a = s1.length()`，在 . 的情况下您不会返回任何内容`if (a!=b)`。除此之外，您还通过比较同一位置上的每个字符是否相等来比较两个字符串。这种方法不适用于搜索字谜，如果两个字符串相等，它可能会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T22:55:22.220

我可能会尝试对字符串进行排序，然后检查它们是否在同一位置具有相同的字母。这将是一个使用 java.util.Arrays 的简单解决方案：

```
public static boolean isAnagram(String s1, String s2) {
    char[] string1 = s1.toCharArray();
    char[] string2 = s2.toCharArray();
    Arrays.sort(string1);
    Arrays.sort(string2);
    return Arrays.equals(string1, string2);
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-04T22:56:27.320

您可能需要在方法中声明一个布尔类型 isAnagram 并同时将其设置为 true 或 false，例如

```
boolean isAnagram;

// Do other stuff
      while (count == a) 
      { 
        isAnagram = true;
      }
        isAnagram = false;
      }
      }
    }
    return isAnagram;
 } 
```

否则你会得到编译错误

# sql - 简单 SQL 中的子查询返回多行

> ID：13713338
> 
> 赞同：0
> 
> 时间：2012-12-04T22:46:21.093
> 
> 标签：sql

我有这些表：

人（pid，姓名，电子邮件，电话，城市）

Ride(rid,pid,date,spots,start,target) [rideID, personID- 提供乘车的人，spots= 乘车中的空位，]

参与（pid，rid）- 人 pid 参与 Ride rid

我必须找到查询 findRidesForUser (pid,date)

这给了我所有建议在 pid 居住的城市开始的特定日期乘车的人的联系方式，例如，ride.start=pid.city。

我正在尝试使用

```
"SELECT person.name, person.email, person.phone, person.city \
 FROM person WHERE pid=(\
    SELECT pid FROM ride WHERE date='%s' AND \
    ride.start= (SELECT city FROM person WHERE person.pid=pid))" 
```

但它给了我错误：执行查询时出错：错误：用作表达式的子查询返回的不止一行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:52:31.027

使用 person.pid 和 pid 与说 1=1 是一回事。此外，pid= 意味着您只想要一个结果，但您得到的结果不止一个，因此要么使用 top 或 limit 将子查询限制为一个，要么将 = 更改为“in”。使用 in 并修复子子查询如下：

```
"SELECT person.name, person.email, person.phone, person.city \
 FROM person WHERE pid in (\
    SELECT pid FROM ride WHERE date='%s' AND \
    ride.start= (SELECT city FROM person as person1 WHERE person.pid=person1.pid))" 
```

我认为这是同一件事

```
"SELECT person.name, person.email, person.phone, person.city \
 FROM person WHERE pid in (\
    SELECT pid FROM ride WHERE date='%s' AND \
    ride.start= city)" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:09:38.770

您应该希望在适当的键上加入两个表：

```
SELECT
    p.name,
    p.email,
    p.phone,
    p.city
FROM person p
JOIN ride r
ON (p.pid = r.pid)
WHERE r.date = 'desiredDate'
AND r.start = (SELECT city FROM person WHERE pid = 'userPid') 
```

其中 'desiredDate' 和 'userPid' 是`findRidesForUser (pid,date)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:51:17.527

尝试使用“In”而不是使用“=”

# sql - 在 JOIN 子句之后指定 WHERE 子句 - Active Record - CodeIgniter

> ID：13713343
> 
> 赞同：0
> 
> 时间：2012-12-04T22:46:32.840
> 
> 标签：sql, codeigniter, activerecord

我想问是否可以在连接后指定 where 子句，以便将数据与用户输入匹配。比如说我有以下代码：

```
 $this->db->select('user.*,role.*')
  $this->db->from('user');
  $this->db->where('user.username', $username);
  $this->db->where('user.password', $password);
  $this->db->join('role','role.id = user.role_id')
  $result = $this->db->get(); 
```

我想从表'role'中查询匹配的数据：

```
 $this->db->select('user.*,role.*')
  $this->db->from('user');
  $this->db->where('user.username', $username);
  $this->db->where('user.password', $password);
  $this->db->join('role','role.id = user.role_id')
  $this->db->where('role.speaker', $speaker); //want to know if this is correct
  $result = $this->db->get(); 
```

这可能吗？我可以在 JOIN 之后比较结果（使用 WHERE）吗？这会产生与 WHERE 子句匹配的结果吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T22:47:53.087

CodeIgniter 直到`->get()`被调用才真正构建查询。您可以按您想要的任何顺序调用这些方法。

# python - 检测 GUI 中的特定按键

> ID：13713347
> 
> 赞同：0
> 
> 时间：2012-12-04T22:46:49.133
> 
> 标签：python, linux, gtk, keypress

我正在寻找一种在 Gtk/Python 中让应用程序监听按键的方法，当按下一些特殊键时，执行一个操作（重新创建一个具有不同标签的菜单，因为它是一个 appindicator）。我真的找不到办法做到这一点。如果有人能够提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T06:00:29.493

您可能需要处理 GtkWidget 的[“key-press-event”](http://developer.gnome.org/gtk3/stable/GtkWidget.html#GtkWidget-key-press-event)（也可能还有[“key-release-event”](http://developer.gnome.org/gtk3/stable/GtkWidget.html#GtkWidget-key-release-event)）。PyGtk 知道[这一点](http://www.pygtk.org/docs/pygtk/class-gtkwidget.html#signal-gtkwidget--key-press-event)。

它应该在一些“窗口”小部件中，因此您可能需要使用[GtkEventBox](http://developer.gnome.org/gtk3/stable/GtkEventBox.html)作为容器。

# sql - sql server - 批量插入错误

> ID：13713351
> 
> 赞同：7
> 
> 时间：2012-12-04T22:47:16.177
> 
> 标签：sql, sql-server

我正在使用批量插入并出现以下错误：

注意：加载文件中的数据*不*超出配置的列长

# 运行命令：

使用 (firstrow = 1, fieldterminator = '0x09', rowterminator = '\n',MAXERRORS = 0, ERRORFILE = 'C:\temp\dataload\load_file 从 'C:\temp\dataload\load_file.txt' 批量插入 load_data ')

# 加载文件内容：

```
user_name   file_path   asset_owner   city      import_date    
admin       C:\         admin         toronto   04/12/2012 
```

# 错误：

消息 4863，级别 16，状态 1，第 1
行第 1 行第 6 列的批量加载数据转换错误（截断）（已验证）。
消息 7399，级别 16，状态 1，第 1 行
链接服务器“（null）”的 OLE DB 提供程序“BULK”报告了错误。提供商没有提供有关该错误的任何信息。消息 7330，级别 16，状态 2，第 1
行无法从链接服务器“（null）”的 OLE DB 提供程序“BULK”获取行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T20:05:17.687

列数不正确。我最近更改了表架构，但忘记对表进行刷新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-03T13:16:14.253

我通过更改架构中的数据类型解决了同样的问题。我将日期类型更改为 nvarchar ......它有效

# spring - 如何使用 HibernateValidator 验证 MultipartFile？

> ID：13713353
> 
> 赞同：4
> 
> 时间：2012-12-04T22:47:28.360
> 
> 标签：spring, hibernate, validation, multipartform-data, hibernate-validator

[`MultipartFile`](http://static.springsource.org/spring/docs/1.2.x/api/org/springframework/web/multipart/MultipartFile.html)我在绑定到 Spring 表单（我正在使用[`MultipartFilter`](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/web/multipart/support/MultipartFilter.html)）的支持 bean 中有一个类型字段，

```
<form:form htmlEscape="false" action="${pageContext.request.contextPath}/admin_side/Category.htm" id="dataForm" name="dataForm" method="post" commandName="categoryBean" enctype="multipart/form-data">

    <input type="file" id="txtCatImage" name="txtCatImage"/>

</form:form> 
```

支持豆，

```
final public class CategoryBean
{
     private MultipartFile txtCatImage=null;

     public MultipartFile getTxtCatImage()
     {
          return txtCatImage;
     }

     public void setTxtCatImage(MultipartFile txtCatImage)
     {
         this.txtCatImage = txtCatImage;
     }
} 
```

我试图应用注释，`@NotEmpty`但没有奏效。他们以一个例外告终。

> javax.validation.UnexpectedTypeException：找不到类型的验证器：org.springframework.web.multipart.MultipartFile

我正在使用验证 API 1.0.0。如果用户没有上传文件并使用[HibernateValidator](http://sourceforge.net/projects/hibernate/files/hibernate-validator/4.0.2.GA/hibernate-validator-4.0.2.GA-dist.zip/download?use_mirror=nchc)按下提交按钮，这是否可以执行验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T04:36:04.000

现在，我了解您要具体完成的工作。好吧，您可以实现自己的自定义验证。例如，不是实现 Spring 验证器接口，而是实现一个 Hibernate `ConstraintValidator`，用于您为此特定情况定义的特定注释。检查此[链接](http://docs.jboss.org/hibernate/validator/4.0/reference/en-US/html/validator-customconstraints.html#validator-customconstraints-constraintannotation)。`@NotNull`在这种情况下，您可以为对象的验证器添加实现`MultipartFile`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-10T11:03:51.157

对空的bean方法检查文件施加约束对我有用：

```
final public class CategoryBean
{
  private MultipartFile txtCatImage = null;
  public MultipartFile getTxtCatImage() { return txtCatImage; }
  public void setTxtCatImage(MultipartFile txtCatImage) { this.txtCatImage = txtCatImage; }

  @AssertTrue(message = "File must be provided")
  public boolean isFileProvided() {
    return (txtCatImage != null) && ( ! txtCatImage.isEmpty());
  }
} 
```

# linux - 增加 ssh 超时

> ID：13713355
> 
> 赞同：0
> 
> 时间：2012-12-04T22:47:39.610
> 
> 标签：linux, ssh, timeout

我正在尝试从 linux 连接到通过 3G 蜂窝路由器连接的移动主机

```
ssh root@74.198.25.XXX -p 2200 
```

我立即得到的只是（甚至似乎没有超时）

```
ssh: connect to host 74.198.25.220 port 2200: Network is unreachable 
```

但是，当我在 Windows 上使用 putty 在端口 2200 上尝试相同的 IP 时，它会向我提供密码提示，正如我所期望的那样。这是怎么回事，我是否需要增加我的 ssh 超时时间才能让这一切顺利进行？

谢谢你，罗恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:57:16.663

网络不可达意味着以下内容：

1.  主机不在您的本地网络上
2.  无法从您的本地网络访问主机所在的网络

造成这种情况的原因可能很多，但要检查的事情是：

*   确保您要连接的设备具有正确的网络连接
*   确保您连接的设备具有正确的网关设置
*   确保您连接的设备有一条通往目标的路线（通常按 abvoe 排序）
*   确保您和目标设备防火墙端口 2200 之间没有任何东西

# c# - 有没有办法延长 SqlConnection GetSchema() 查询的超时时间？

> ID：13713365
> 
> 赞同：4
> 
> 时间：2012-12-04T22:48:20.693
> 
> 标签：c#, sql, sql-server, schema

我试图打的电话是

```
DataTable dt = connection.GetSchema("Columns"); 
```

但我的查询超时。有没有办法增加这个调用的超时时间？

与数据库本身的连接打开得很好，所以连接超时对我没有任何帮助。

我还看到 SqlCommand 有一个 CommandTimeout 属性，但我不知道这是否真的适用于此。

那么有没有办法可以延长`GetSchema`通话的超时时间？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:10:13.390

我猜您当前的用户可能没有此命令所需的权限。

你有没有尝试过：

```
DataTable dt = connection.GetSchema("Columns", new string[] {null, null, "MyTable"); 
```

这有什么结果吗？

此外，您应该尝试使用用户描述来避免所有 sys 表。它可能会使查询变小。

```
DataTable dt = connection.GetSchema("Columns", new string[] {null, "dbo", null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T23:18:06.663

不，无法更改 .getschema() 的超时时间。我想它是这样设计的，虽然我不知道为什么。它是 180 秒。

但是，您可以使用可以使用超时的 sqlcommand 查询模式表以获取相同的信息。

# c# - C#：DateTime.DayOfWeek 到字符串比较

> ID：13713366
> 
> 赞同：12
> 
> 时间：2012-12-04T22:48:21.707
> 
> 标签：c#, datetime

这段代码是我正在尝试做的简化版本：

```
string day = Thursday;
DateTime dt = DateTime.Now;

if (day == dt.DayOfWeek)
{
     // start the program
} 
```

我需要从数据库中读取星期几的值，将其分配给一个字符串，然后将该字符串与 dt.DayOfWeek 进行比较以检查程序是否应该执行。

我的错误是：**“运算符'=='不能应用于'string'和'System.DayOfWeek'类型的操作数”**

任何人都知道如何将字符串与 DateTime.DayOfWeek 值进行比较？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-04T22:51:14.733

用于`Enum.Parse`获取枚举值：

```
if ((DayOfWeek)Enum.Parse(typeof(DayOfWeek), day) == dt.DayOfWeek) 
```

如果您不确定它是否是有效值，则有`TryParse<T>`：

```
Enum val;
if (Enum.TryParse<DayOfWeek>(day, out val) && val == dt.DayOfWeek) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-04T22:51:12.733

最简单的是将枚举转换为字符串：

```
if (day == dt.DayOfWeek.ToString())... 
```

笔记：

*   如果您可以将类型更改`day`为`DayOfWeek`枚举，则可以避免字符串比较（及其相关的本地化/比较问题）。
*   如果您必须使用字符串，请确保确定大小写是否重要（即“星期四”是否应该等于`DayOfWeek.Thursday`）并使用相应的`String.Equals`方法。
*   考虑`Parse`按照其他答案中的建议将字符串转换为枚举：`((DayOfWeek)Enum.Parse(typeof(DayOfWeek), day)`
*   确保传入的字符串始终是英语 - 如果它可能是其他语言，您需要查看手动匹配值与[CultureInfo.DateTimeFormat.DayNames](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.daynames%28v=vs.110%29.aspx)中提供的值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-04T22:50:48.740

尝试`DayOfWeek day = DayOfWeek.Thursday;`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-04T22:53:27.770

您可以使用[`Enum.TryParse<DayOfWeek>`](http://msdn.microsoft.com/en-us/library/dd783499.aspx)：

```
string strDay = "Wednesday";
DayOfWeek day;
if (Enum.TryParse<DayOfWeek>(strDay, out day)
    && day == DateTime.Today.DayOfWeek)
{
    // ...
} 
```

# r - 使用 TTR 包拉取 HLOC 数据

> ID：13713373
> 
> 赞同：2
> 
> 时间：2012-12-04T22:48:56.417
> 
> 标签：r

对 R 和 TTR 来说非常新。我已经创建了我认为是由 R 中的 TTR 包检索到的所有股票代码的向量，其中包含以下内容：

```
stockDataFrame <- stockSymbols()
symbs <- stockDataFrame[["Symbol"]] 
```

所以我在变量“symbs”中得到了所有的符号。如何在此向量的每个元素上应用 TTR 函数“getYahooData”，尤其是因为该函数不仅需要股票代码，还需要 start、end、freq、type、adjust 和 quiet 参数值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:42:33.023

只需使用将为您加载[**TTR的**](http://cran.r-project.org/package=TTR)[**quantmod**](http://cran.r-project.org/package=quantmod)。你不会伤害@JoshuaUlrich 的感情，因为他也是 quantmod 项目的开发者。查看网站上的示例：[http ://www.quantmod.com/](http://www.quantmod.com/)[](http://cran.r-project.org/package=TTR)

 **`getSymbols`是一种“通用”函数，它具有针对不同数据源的“方法”。默认情况下，`src=yahoo`这意味着`getSymbols.yahoo`被调用。这可以处理符号向量。

默认情况下`auto.assign=TRUE`，这意味着返回的数据是在`.GlobalEnv`（默认情况下）分配的，并返回分配的对象的*名称。*

```
> library(quantmod)
> getSymbols(symbs[1:5])
[1] "AA-P" "AAU"  "ACU"  "ACY"  "ADGE"

> head(ACY)
           ACY.Open ACY.High ACY.Low ACY.Close ACY.Volume ACY.Adjusted
2007-01-03     6.58     7.15    6.58      6.99      31700         6.99
2007-01-04     7.24     7.35    7.15      7.35      18600         7.35
2007-01-05     7.39     7.55    7.25      7.45      15200         7.45 
2007-01-08     7.32     7.35    7.01      7.26      16100         7.26
2007-01-09     7.15     7.50    7.15      7.16      12100         7.16
2007-01-10     7.30     7.45    7.21      7.24      13700         7.24 
```

* * *

如果您真的不想下载 6,000 多只股票的数据，还有一个方便的选择： `attachSymbols`通过惰性评估使所有这些符号按需可用。第一次使用 Symbol 时，它将被下载并缓存，以便下次使用它时，将从内存（或磁盘，具体取决于您使用的参数`attachSymbols`）中读取。

```
> attachSymbols()
> tail(GS)
           GS.Open GS.High GS.Low GS.Close GS.Volume GS.Adjusted
2012-11-26  119.16  120.95 118.50   120.94   3371000      120.43
2012-11-27  120.50  121.34 118.38   118.41   3875200      117.91
2012-11-28  117.25  119.33 116.57   119.33   3811200      119.33
2012-11-29  120.00  120.45 118.52   118.73   2980800      118.73
2012-11-30  117.96  119.44 117.69   117.79   4264300      117.79
2012-12-03  118.42  119.64 118.07   118.40   3613900      118.40 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:17:55.767

您可以使用 plyr 包来遍历您的符号列表。

我不确定 getYahooData 是否可以加载所有符号的数据。我认为应该有更好的方法来使用 TTR。但是这里我展示了**plyr**包的使用。这是一种通用方法。

我调用 llply 来获取两个日期之间前 6 个市场符号的所有数据（您可以添加其他函数参数，..）

```
 library(plyr)
    ll <- llply(symbs[1:6],getYahooData ,start=20081201, end=20081207)

$`AA-P`
               Open     High      Low    Close   Volume Unadj.Close Div Split Adj.Div
2008-12-01 49.39233 49.39233 49.39233 49.39233 243.9650       60.25  NA    NA      NA
2008-12-02 49.39233 49.39233 49.39233 49.39233 243.9650       60.25  NA    NA      NA
2008-12-03 49.39233 49.39233 49.39233 49.39233   0.0000       60.25  NA    NA      NA
2008-12-04 49.80223 51.64676 49.80223 51.64676 487.9300       63.00  NA    NA      NA
2008-12-05 49.79403 49.79403 49.79403 49.79403 121.9825       60.74  NA    NA      NA

$AAU
           Open High  Low Close Volume
2008-12-01 0.49 0.53 0.49  0.50  57100
2008-12-02 0.52 0.54 0.51  0.52  33400
2008-12-03 0.50 0.54 0.49  0.49  52800
2008-12-04 0.49 0.49 0.44  0.44  62400
2008-12-05 0.44 0.48 0.42  0.47  87600

$ACU
               Open     High      Low    Close   Volume Unadj.Close Div Split Adj.Div
2008-12-01 6.168596 6.168596 5.823880 5.823880 3196.838        6.42  NA    NA      NA
2008-12-02 5.987166 6.077881 5.814809 5.987166 8157.448        6.60  NA    NA      NA
2008-12-03 6.068810 6.068810 5.896452 5.987166 1984.244        6.60  NA    NA      NA 
```**

# android - 印象笔记之类的操作栏下拉菜单

> ID：13713381
> 
> 赞同：2
> 
> 时间：2012-12-04T22:50:10.370
> 
> 标签：android, android-actionbar

我试图弄清楚如何创建一个用户信息下拉菜单，就像下面的屏幕截图中使用的印象笔记一样。

下拉菜单和普通微调器似乎不支持用户名所在的 Header 值。

有没有人知道如何使用标题、下拉列表中的自定义字段和标题右下角的微调器图标来实现这样的东西。

[此外，http: //developer.android.com/guide/topics/ui/actionbar.html#Dropdown](http://developer.android.com/guide/topics/ui/actionbar.html#Dropdown)上的示例不是我需要的，除非它可以扩展为标题和自定义条目。

支持安卓3.1+

这是[屏幕截图](http://imgur.com/oCHjc)

# .htaccess - .htaccess 自定义重定向非“www”到带有参数的“www”

> ID：13713386
> 
> 赞同：0
> 
> 时间：2012-12-04T22:50:25.010
> 
> 标签：.htaccess, redirect

我需要使用 HTTP、HTTPS 和 SSL 进行这项工作，这是我的实际（工作）重写：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^(.*)$ index.php?url=$1 [L,QSA]
</IfModule> 
```

但我需要强制将非“www”网址（如[http://domain.com](http://domain.com)）重定向到与“www”相同的网址，并且仍然可以使用 index.php?url=$1 因为我的“路由器”引擎。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T03:02:21.460

只需在开头添加非 www 到 www 规则，如下所示：

```
#non-www to www
RewriteEngine On
RewriteCond %{HTTP_HOST} ^domain\.com/?$ [NC]
RewriteRule ^(.*)$ http://www.domain.com/$1 [L,R=301]

<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^(.*)$ index.php?url=$1 [L,QSA]
</IfModule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T22:54:43.430

这应该可以完成工作（在任何其他重写规则之前）：

```
<IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteCond %{REQUEST_FILENAME} !-d
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteCond %{HTTPS} !=on
   RewriteCond %{HTTP_HOST} !^www.*$
   RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [L,R=301]
   RewriteCond %{HTTPS} =on
   RewriteCond %{HTTP_HOST} !^www.*$
   RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [L,R=301]
   RewriteRule ^(.*)$ index.php?url=$1 [L,QSA]
</IfModule> 
```

# aptana - 防止我的javascript中的正则表达式格式

> ID：13713393
> 
> 赞同：2
> 
> 时间：2012-12-04T22:50:54.420
> 
> 标签：aptana

我确定其他人已经问过这个问题，但我的 Google foo 让我失望了，我找不到它。当我在这样的等式中多次划分时：

```
this.active[i].pos(last.pos()+(last.width()/2)+10+(this.active[i].width()/2)); 
```

“ **/2)+10+(this.active[i].width()/** ”将在编辑器中显示正则表达式格式（全橙色），这让我发疯。:(

有没有办法可以更改我的设置来防止这种情况发生？我根本不使用正则表达式，因此完全在编辑器中禁用它的格式是可以接受的。

任何人都可以提供或指出我的答案吗？

如果您在 Google 上找到它，我将不胜感激学习您的搜索词。

谢谢你。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-11T06:07:35.493

当我在堆栈溢出时遇到这个问题时，我已经在网上搜索了大约 45 分钟，试图找到这个问题的解决方案。我几乎开始对其进行赏金，但我决定看看我是否能自己解决这个问题。

我想出了两种可能的解决方案，尽管它们都比我简单得多。

**解决方案1：**将公式分成两部分，可以存储在变量中，并在需要时相加。比如我正好在写一个计算表面积的公式，形成一个正则表达式，返回了错误的答案：

> > 返回 [(this.base * this.height)/2] + [(this.perimeter * this.slant)/2];

我在 处拆分公式`+`并将它们存储在变量中：

```
var a = (this.base * this.height)/2;
    var b = (this.perimeter * this.slant)/2;    
    return  a + b 
```

这个解决方案工作得很好。但是后来我开始认为必须有一个我忽略的更简单的解决方案，这导致我：

**解决方案 2：**除以 2 与乘以 0.5 (duh!) 相同。就我而言——几乎在任何情况下——除以 2 再乘以 0.5 都会得到相同的答案。然后我的代码如下所示：

> > 返回 [(this.base * this.height) * 0.5] + [(this.perimeter * this.slant) * 0.5];

我对两者都进行了测试，并且两者都有效，但显然解决方案 2 更有效（代码更少）。

我唯一能想象需要使用解决方案 1 的情况是，如果您要除以一个非常长的数字或一个素数（除以 3 比乘以 0.33 得到的结果更准确）。

无论如何，我知道您几个月前发布了这个问题，并且可能想出了一个解决方案或继续前进，但我想我还是会发布这个答案，作为未来任何具有相同想法的问题的参考。

（此外，这是在 JavaScript 中，但我无法想象这么简单的东西在类似的语言中有什么不同）。

# unicode - 如何使用 response.write 在经典 ASP 中显示汉字

> ID：13713395
> 
> 赞同：0
> 
> 时间：2012-12-04T22:51:04.510
> 
> 标签：unicode, asp-classic, response, cjk, chinese-locale

如何使用response.write在ASP中显示汉字？

```
<%
  Response.CodePage=51936
  Response.Charset="UTF-8"
  Response.ContentType = "text/html"
  Dim Msg
  Msg="简"
%>
<%Response.Write Msg%> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T04:10:45.017

[代码页 51936](http://wiki.whatwg.org/wiki/Web_Encodings)是 EUC-CN。不是 UTF-8，即 65001。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-06T00:52:11.557

这个长期安静的问题，仍然需要一个经过验证的解决方案！我成功地从 UTF-8 编码的 Classic ASP 脚本中显示中文和韩文字符。我所做的只是在文档头部添加元字符集标签，如下所示：

```
<%@ Language=VBScript %>
<% 
  chinese="欢迎" 
%>
<html>
<head>
  <meta charset="UTF-8" />
  ...
</head>
<body>
  <%= chinese %>
</body>
</html> 
```

# sql-server - 如何摆脱 SSDT 中的 localdb？

> ID：13713398
> 
> 赞同：1
> 
> 时间：2012-12-04T22:51:15.307
> 
> 标签：sql-server, database, visual-studio-2012, sql-server-data-tools

从 VS2010 迁移到 2012 后，我无法使用我的数据库项目。

项目中数据库对象的所有脚本都连接到自动创建的 localdb 数据库。我对 localdb 不感兴趣，因为数据库很大，我在 SQL Server 2008 R2 的完整实例中维护它。

我尝试了工具-选项-数据库工具-数据连接-SQL Server 实例名称中的所有可能设置，但无济于事。重新加载项目后，它总是恢复到 localdb 的相同连接。

我的问题是我需要从一个数据库引用到另一个数据库。我用同义词做：CREATE SYNONYM [pcg].[practice] FOR [PcgDb].[Portal].[practice]; 此脚本自动链接到 localdb，并且 localdb 上的 PcgDb 没有表。因此，我得到一个未解决的参考错误 71501。

我还尝试了添加数据库引用中的所有组合，甚至将我的 SQL Server 实例添加到 localdb 链接服务器，仍然是同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-03T18:29:02.847

首次创建 SSDT 项目时，第一步应该是导入目标数据库；那时您可以指定 SQL Server 的实时实例。您不需要“摆脱”本地数据库，此时应该忽略它。自从您迁移了现有的 2010 项目后，这可能正在发生吗？在这种情况下，我建议您创建一个新项目并从实时服务器进行导入。

# wso2 - WSO2 数据服务 - 当我使用 try 工具时，是否可能在“响应”块中收到完整的异常？

> ID：13713402
> 
> 赞同：0
> 
> 时间：2012-12-04T22:51:45.030
> 
> 标签：wso2, wso2dss

当我在链接中使用 WSO2 Data Services 的 try 工具时：

> .../services/User_DataService?tryit

为数据服务生成的异常只能在服务器中的日志文件中访问 (.../repository/log/wso2carbon.log)。

当我使用 try 工具时，是否可能在“响应”块中收到完整的异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T02:54:43.510

通常，当发生异常时，您会在数据服务中收到一条合理推理的 SOAP 错误消息。您不会得到完整的错误日志，但理解它是有意义的。

# sql-server - 将空格分隔的 varchar 旋转到多行（名称 - 值对）

> ID：13713404
> 
> 赞同：0
> 
> 时间：2012-12-04T22:52:00.927
> 
> 标签：sql-server, sql-server-2008, tsql

我在 SQL Server 2008 数据库中有大量行

对于每一行，我有 3 列我关心

典型的行如下所示：

```
AccountNumber    | basecode                      | subcode
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
9689787209368901 | AQTXG AQTXG AQTXG AQTXG ACC5Z | ZQ596 ZQ596 ZQ596 ZQ655 ZC655 
```

我需要一个 SQL 查询，将其转换为以下内容：

```
AccountNumber      |    basecode| subcode
+++++++++++++++++++++++++++++++++++++++++++
9689787209368901   |    AQTXG   | ZQ596
9689787209368901   |    AQTXG   | ZQ596
9689787209368901   |    AQTXG   | ZQ596
9689787209368901   |    AQTXG   | ZQ655
9689787209368901   |    ACC5Z   | ZC655 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:04:33.847

如果行总是用 5 个序列填充，这应该有效

```
Select TableAccountNumber,SubString(basecode,1,5) as BC,SubString(Subcode,1,5) as SC
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,7,5) as BC,SubString(Subcode,7,5) as SC
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,13,5) as BC,SubString(Subcode,13,5) as SC
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,19,5) as BC,SubString(Subcode,19,5) as SC
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,25,5) as BC,SubString(Subcode,25,5) as SC
from @test 
```

可以包装为

```
Select * from
(
Select TableAccountNumber,SubString(basecode,1,5) as BC,SubString(Subcode,1,5) as SC,0 as Sequence
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,7,5) as BC,SubString(Subcode,7,5) as SC,1
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,13,5) as BC,SubString(Subcode,13,5) as SC,2
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,19,5) as BC,SubString(Subcode,19,5) as SC,3
from @test
UNION ALL
Select TableAccountNumber,SubString(basecode,25,5) as BC,SubString(Subcode,25,5) as SC,4
from @test
) a
order by TableAccountNumber,Sequence 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T10:13:19.613

由于您使用的是 SQL Server，因此可以使用递归查询来拆分数据。在此查询中，您可以有未知数量的项目，这些项目用空格 ( `' '`) 分隔，如果您的分隔符更改，那么这很容易更改。您的查询将与此类似：

```
;with cte (AccountNumber, basecodeItem, basecode, subcodeItem, subcode) as
(
  select AccountNumber,
    cast(left(basecode, charindex(' ',basecode+' ')-1) as varchar(50)) basecodeItem,
         stuff(basecode, 1, charindex(' ',basecode+' '), '') basecode,
    cast(left(subcode, charindex(' ',subcode+' ')-1) as varchar(50)) subcodeItem,
         stuff(subcode, 1, charindex(' ',subcode+' '), '') subcode
  from yourtable
  union all
  select AccountNumber,
    cast(left(basecode, charindex(' ',basecode+' ')-1) as varchar(50)) basecodeItem,
    stuff(basecode, 1, charindex(' ',basecode+' '), '') basecode,
    cast(left(subcode, charindex(' ',subcode+' ')-1) as varchar(50)) subcodeItem,
    stuff(subcode, 1, charindex(' ',subcode+' '), '') subcode
  from cte
  where basecode > '' or subcode > ''
)
select AccountNumber, basecodeItem, subcodeitem
from cte; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/a477c/2)

结果是：

```
|    ACCOUNTNUMBER | BASECODEITEM | SUBCODEITEM |
-------------------------------------------------
| 9689787209368900 |        AQTXG |       ZQ596 |
| 9689787209368900 |        AQTXG |       ZQ596 |
| 9689787209368900 |        AQTXG |       ZQ596 |
| 9689787209368900 |        AQTXG |       ZQ655 |
| 9689787209368900 |        ACC5Z |       ZC655 | 
```

# rss - DotnetNuke RSS 源模块

> ID：13713407
> 
> 赞同：1
> 
> 时间：2012-12-04T22:52:16.680
> 
> 标签：rss, dotnetnuke-module

我正在寻找有关如何使 DotNetNuke RSS 源模块工作的信息。

我已经尝试过 DotNetNuke Modules 4.0.1 和 4.2.1 并且我得到了错误。我在模块中尝试了不同的设置，但没有任何效果。当我获取链接并将其发布到浏览器中（我尝试过 IE 和 Firefox）时，它可以工作，所以它不应该是 RSS 问题。

我尝试了几个 RSS 提要 URL 并得到相同的错误。提前感谢您的帮助！我已经查看了几个有关此问题的网站，但到目前为止我还没有找到答案。

**错误信息**

System.Web.HttpException：无法加载类型“DotNetNuke.Modules.XML.XmlController”。在 System.Web.Compilation.BuildManager.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase) 在 DotNetNuke.Framework.Reflection.CreateType(String TypeName, String CacheKey, Boolean UseCache, Boolean IgnoreErrors)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T19:39:57.660

查看错误消息，模块的安装似乎缺少某些内容。您需要确认 DotNetNuke.Modules.XML.dll 存在于您站点的 /bin 文件夹中。

# android - Android MediaRecorder 记录表面（不是相机）

> ID：13713408
> 
> 赞同：8
> 
> 时间：2012-12-04T22:52:19.180
> 
> 标签：android, video, java-native-interface, mediarecorder

我正在查看 Android SDK 的[MediaRecorder](http://developer.android.com/reference/android/media/MediaRecorder.html)类，我想知道它是否可用于录制由 Surface 制作的视频。示例：我想将我在表面（视频游戏？）上显示的内容记录到文件中。正如我在标题中所说：我不想从相机中记录任何东西。

我认为通过覆盖大部分课程是可能的，但我非常喜欢一些想法......此外，我不确定 Camera 类在 MediaRecorder 中的使用方式，以及我应该从 Surface 中得到什么来替换它。

感谢您的关注！

PS：我正在查看使用我的 MediaRecorder 的本机代码有一些线索，也许它会启发其他人： http: [//www.netmite.com/android/mydroid/frameworks/base/media/jni/](http://www.netmite.com/android/mydroid/frameworks/base/media/jni/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-06T20:20:57.870

Android Lollipop 中添加了从 Surface 录制的功能。这是文档：

[http://developer.android.com/about/versions/android-5.0.html#ScreenCapture](http://developer.android.com/about/versions/android-5.0.html#ScreenCapture)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-24T23:26:47.397

Android 4.3 (API 18) 添加了一些新功能，可以完全满足您的需求。具体来说，从 Surface 提供数据`MediaCodec`的能力，以及将编码视频存储为 .mp4 文件的能力（通过[MediaMuxer](http://developer.android.com/reference/android/media/MediaMuxer.html)）。

[此处](http://bigflake.com/mediacodec/)提供了一些示例代码，包括用于在您玩游戏时记录游戏的 Breakout 游戏补丁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T04:19:07.863

不幸的是，这在 Java 层是不可能的。相机和媒体记录器之间的所有通信都发生在本机代码层中，无法将非相机数据注入该管道。

虽然 Android 4.1 添加了允许访问设备的视频编码器的[媒体编解码器 API](http://developer.android.com/reference/android/media/MediaCodec.html)，但没有易于使用的方法来获取生成的编码流并将其保存为标准视频文件。您必须找到一个库来执行此操作或自己编写一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-02T20:43:09.173

只要熟悉 NDK（C/C++，JNI，...）和 Android（权限，...），您可能希望从 AOSP frameworks/av/media 中的不同文件夹跟踪兔子洞

走得很深，不确定在无根设备上可以走多远。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-28T06:51:24.710

这是一篇关于如何在 EGLSurface 上绘图并使用 MediaCodec 生成视频的文章：

[https://www.sisik.eu/blog/android/media/images-to-video](https://www.sisik.eu/blog/android/media/images-to-video)

这使用 OpenGL ES，但您可以让 MediaCodec 提供一个表面，然后您可以从中获取画布以进行绘制。不需要 OpenGL ES。

# matlab - 在从脚本文件加载的函数中使用全局变量

> ID：13713410
> 
> 赞同：3
> 
> 时间：2012-12-04T22:52:25.123
> 
> 标签：matlab, gnu, octave

所以我得到了这个功能：

```
function M = getA(X)
global h;
QPL96 =  h;
M = QPL96;
endfunction 
```

现在：

```
octave:115> h
h =  0.10000
octave:116> getA(X)
ans = [](0x0) 
```

这不是很奇怪吗？只要没有涉及 h 的表达式就可以工作。否则返回垃圾。为什么我不能这样做？我必须通过使 h 争论来解决它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:07:35.093

您必须在`h`要使用 "global" 的任何地方声明为全局`h`，包括您的主体。所以`global h`在提示符下输入，你会没事的。请参阅[文档](http://www.gnu.org/software/octave/doc/interpreter/Global-Variables.html)。以下对我来说很好：

```
octave> function M = getA(X)
> global h;
> M = h;
> endfunction
octave> h = 0.01
h =  0.0010000
octave> getA
ans = [](0x0)
octave> global h
octave> h
h = [](0x0)
octave> h = 0.01
h =  0.010000
octave> h
h =  0.010000
octave> getA
ans =  0.010000 
```

但实际上，您不应该使用全局变量，这是非常糟糕的做法。将变量作为参数传递。如果您发现自己传递了同一组变量，请传递一个结构，但仍然不要使用全局变量。

**编辑：** [这](https://stackoverflow.com/questions/8414283)是同一个问题。

# c - 似乎无法正确获取 C TCP 服务器-客户端通信

> ID：13713415
> 
> 赞同：3
> 
> 时间：2012-12-04T22:53:13.840
> 
> 标签：c, tcp, client-server

好的，我需要一些认真的帮助。我必须制作一个 TCP 服务器客户端。当客户端使用三阶段握手连接到服务器时。之后......当客户端在终端中运行时，用户输入 linux shell 命令，如 xinput list、ls -1 等......使用标准输出的东西。服务器接受命令并使用 system()（在无限循环中的 fork() 中）运行命令，标准输出被重定向到客户端，客户端打印出每一行。

之后服务器发送“\377\n”的完成信号。其中客户端返回命令提示符询问新命令并在输入“退出”时关闭其连接和 exit()。

我知道您必须将 STDOUT_FILENO 和 STDERR_FILENO 都 dup2() 到客户端文件描述符 {dup2(client_FD, STDOUT_FILENO)。一切正常，除了客户端检索系统（）的标准输出并将其打印出来......我得到的只是一个带有闪烁光标的空白行（客户端在标准输入上等待）。我尝试了各种不同的路线，并在互联网上进行了广泛的搜索，但无济于事......如果有人能指出我正确的方向，我将不胜感激

TCP 服务器代码

```
#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <string.h>
#include <netinet/in.h>
#include <signal.h>
#include <unistd.h>
#include <stdlib.h>
#include <errno.h>

//Prototype
void handle_client(int connect_fd);

int main()
{
    int server_sockfd, client_sockfd;
    socklen_t server_len, client_len;
    struct sockaddr_in server_address;
    struct sockaddr_in client_address;

    server_sockfd = socket(AF_INET, SOCK_STREAM, 0);

    server_address.sin_family = AF_INET;
    server_address.sin_addr.s_addr = htonl(INADDR_ANY);
    server_address.sin_port = htons(9734);
    server_len = sizeof(server_address);
    bind(server_sockfd, (struct sockaddr *)&server_address, server_len);

/*  Create a connection queue, ignore child exit details and wait for clients.  */

    listen(server_sockfd, 10);

    signal(SIGCHLD, SIG_IGN);

    while(1) {

        printf("server waiting\n");

        client_len = sizeof(client_address);
        client_sockfd = accept(server_sockfd,
            (struct sockaddr *)&client_address, &client_len);

        if(fork() == 0)
            handle_client(client_sockfd);
        else
            close(client_sockfd);
    }
}

void handle_client(int connect_fd) {

    const char* remsh         = "<remsh>\n";
    const char* ready         = "<ready>\n";
    const char* ok            = "<ok>\n";
    const char* command       = "<command>\n";
    const char* complete      = "<\377\n";
    const char* shared_secret = "<shapoopi>\n";

    static char server_msg[201];
    static char client_msg[201];
    static char commands[201];

    int sys_return;

    //memset client_msg, server_msg, commands
    memset(&client_msg, 0, sizeof(client_msg));
    memset(&server_msg, 0, sizeof(client_msg));
    memset(&commands, 0, sizeof(commands));
    //read remsh from client
    read(connect_fd, &client_msg, 200);
    //check remsh validity from client
    if(strcmp(client_msg, remsh) != 0) {
        errno++;
        perror("Error Establishing Handshake");
        close(connect_fd);
        exit(1);
    }
    //memset client_msg
    memset(&client_msg, 0, sizeof(client_msg));
    //write remsh to client
    write(connect_fd, remsh, strlen(remsh));
    //read shared_secret from client
    read(connect_fd, &client_msg, 200);
    //check shared_secret validity from client
    if(strcmp(client_msg, shared_secret) != 0) {
        errno++;
        perror("Invalid Security Passphrase");
        write(connect_fd, "no", 2);
        close(connect_fd);
        exit(1);
    }
    //memset client_msg
    memset(&client_msg, 0, sizeof(client_msg));
    //write ok to client
    write(connect_fd, ok, strlen(ok));
    // dup2  STDOUT_FILENO <= client fd, STDERR_FILENO <= client fd
    dup2(connect_fd, STDOUT_FILENO);
    dup2(connect_fd, STDERR_FILENO);
    //begin while... while read (client_msg) from server and >0
    while(read(connect_fd, &client_msg, 200) > 0) {
        //check command validity from client
        if(strcmp(client_msg, command) != 0) {
            errno++;
            perror("Error, unable to retrieve data");
            close(connect_fd);
            exit(1);
        }
        //memset client_msg
        memset(&client_msg, 0, sizeof(client_msg));
        //write ready to client
        write(connect_fd, ready, strlen(ready));
        //read commands from client
        read(connect_fd, &commands, 200);
        //run commands using system( )
        sys_return = system(commands);
        //check success of system( )
        if(sys_return < 0) {
            perror("Invalid Commands");
            errno++;
        }
        //memset commands
        memset(commands, 0, sizeof(commands));
        //write complete to client
        write(connect_fd, complete, sizeof(complete));

    }
} 
```

TCP 客户端代码

```
#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <string.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>
#include <stdlib.h>
#include <errno.h>
#include "readline.c"

int main(int argc, char *argv[])

{
    int sockfd;
    int len;
    struct sockaddr_in address;
    int result;

    const char* remsh         = "<remsh>\n";
    const char* ready         = "<ready>\n";
    const char* ok            = "<ok>\n";
    const char* command       = "<command>\n";
    const char* complete      = "<\377\n";
    const char* shared_secret = "<shapoopi>\n";

    static char server_msg[201];
    static char client_msg[201];

    memset(&client_msg, 0, sizeof(client_msg));
    memset(&server_msg, 0, sizeof(server_msg));

/*  Create a socket for the client.  */

    sockfd = socket(AF_INET, SOCK_STREAM, 0);

/*  Name the socket, as agreed with the server.  */
    memset(&address, 0, sizeof(address));

    address.sin_family = AF_INET;
    address.sin_addr.s_addr = inet_addr(argv[1]);
    address.sin_port = htons(9734);
    len = sizeof(address);

/*  Now connect our socket to the server's socket.  */

    result = connect(sockfd, (struct sockaddr *)&address, len);

    if(result == -1) {
        perror("ACCESS DENIED");
        exit(1);
    }

    //write remsh to server
    write(sockfd, remsh, strlen(remsh));
    //read remsh from server
    read(sockfd, &server_msg, 200);
    //check remsh validity from server
    if(strcmp(server_msg, remsh) != 0) {
        errno++;
        perror("Error Establishing Initial Handshake");
        close(sockfd);
        exit(1);
    }
    //memset server_msg
    memset(&server_msg, 0, sizeof(server_msg));
    //write shared secret text to server
    write(sockfd, shared_secret, strlen(shared_secret));
    //read ok from server
    read(sockfd, &server_msg, 200);
    //check ok velidity from server
    if(strcmp(server_msg, ok) != 0 ) {
        errno++;
        perror("Incorrect security phrase");
        close(sockfd);
        exit(1);
    }
    //? dup2 STDIN_FILENO = server socket fd?
    //dup2(sockfd, STDIN_FILENO);
    //begin while(1)///////////////////////////////////////
    while(1){
        //memset both msg arrays
        memset(&client_msg, 0, sizeof(client_msg));
        memset(&server_msg, 0, sizeof(server_msg));
        //print Enter Command, scan input, fflush to stdout
        printf("<<Enter Command>> ");
        scanf("%s", client_msg);
        fflush(stdout);
        //check quit input, if true close and exit successfully
        if(strcmp(client_msg, "quit") == 0) {
            printf("Exiting\n");
            close(sockfd);
            exit(EXIT_SUCCESS);
        }
        //write command to server
        write(sockfd, command, strlen(command));
        //read ready from server
        read(sockfd, &server_msg, 200);
        //check ready validity from server
        if(strcmp(server_msg, ready) != 0) {
            errno++;
            perror("Failed Server Communications");
            close(sockfd);
            exit(1);
        }
        //memset server_msg
        memset(&server_msg, 0, sizeof(server_msg));
        //begin looping and retrieving from stdin,
        //break loop at EOF or complete
        while((read(sockfd, server_msg, 200) != 0) && (strcmp(server_msg, complete) != 0)) {
        //while((fgets(server_msg, 4096, stdin) != EOF) || (strcmp(server_msg, complete) == 0)) {
            printf("%s", server_msg);
            memset(&server_msg, 0, sizeof(server_msg));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:07:18.893

我正在浏览代码并在我的 Ubuntu 机器上进行了尝试，我得到了与 Vincent Czubatiuk 描述的相同的结果。然后我决定查看代码并对其进行一些调试。我发现需要进行两次更正才能使其按预期工作。

1) TCP 客户端代码在 memset server_msg 之后缺少一行，其中通过 scanf 输入的命令没有发送到服务器，即：

```
//memset server_msg
write(sockfd, client_msg, strlen(client_msg));
memset(&server_msg, 0, sizeof(server_msg)); 
```

2）第一次更正后，命令在服务器端执行并将输出发送回客户端。但是它无法继续，因为系统返回错误。解决方案可在此处获得[C++： system(0) Returns 0](https://stackoverflow.com/questions/9080311/c-system0-returns-0)。这需要进行以下更改：

```
listen(server_sockfd, 10);
//signal(SIGCHLD, SIG_IGN); 
```

希望这可以帮助。

# android - 从纵向切换到横向时保存视图状态

> ID：13713416
> 
> 赞同：1
> 
> 时间：2012-12-04T22:53:15.437
> 
> 标签：android, orientation, savestate

我创建了一个简单的日历`GridView`，每当我从纵向视图切换到横向（或返回）时，它都不会保留状态。例如，我在纵向视图中更改为 1 月，而在横向视图中更改为 12 月。我试图解决这个问题并将这段代码添加到我的`OnCreate()`：

```
 if(savedInstanceState != null && savedInstanceState.containsKey(CALENDAR)){
        mCalendar = (Calendar) savedInstanceState.getSerializable(CALENDAR);
   }else{
    mCalendar = Calendar.getInstance();
   } 
```

并将此方法添加到类中：

```
@Override
    public void onSaveInstanceState(Bundle outState){
        super.onSaveInstanceState(outState);

        //Save the calendar instance in case the user changed it
        outState.putSerializable(CALENDAR, mCalendar);
    } 
```

不幸的是，它不想工作，并且在更改手机方向时，几个月仍然会切换到初始状态。有人可以帮帮我吗？

* * *

代码：

```
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_calendar);

    mCalendar = Calendar.getInstance(Locale.getDefault());
    month = mCalendar.get(Calendar.MONTH) + 1;
    year = mCalendar.get(Calendar.YEAR);

    previous = (Button) findViewById(R.id.b_prevMonth);
    next = (Button) findViewById(R.id.b_nextMonth);
    displayMonth = (TextView) findViewById(R.id.et_displayMonth);
    gv_daysOfWeek = (GridView) findViewById(R.id.gv_daysOfWeek);
    gv_calendar = (GridView) findViewById(R.id.gv_calendar);

    previous.setOnClickListener(this);
    next.setOnClickListener(this);
    displayMonth.setText(DateFormat.format(monthDisplay, mCalendar.getTime()));

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.weekdays_grid, R.id.grid_item_label, WEEK_DAYS);
    gv_daysOfWeek.setAdapter(adapter);

    setGridCellAdapter(month, year);

    if(savedInstanceState != null && savedInstanceState.containsKey(CALENDAR)){
        mCalendar = (Calendar) savedInstanceState.getSerializable(CALENDAR);
    }else{
        mCalendar = Calendar.getInstance();
    }
}

/**
 * Method responsible for intialising the adapter
 */
 private void setGridCellAdapter(int month, int year) {
     cellAdapter = new GridCellAdapter(getApplicationContext(),R.id.day_gridcell, month, year);
     mCalendar.set(year, month - 1 , mCalendar.get(Calendar.DAY_OF_MONTH));
     displayMonth.setText(DateFormat.format(monthDisplay, mCalendar.getTime()));
     cellAdapter.notifyDataSetChanged();
     gv_calendar.setAdapter(cellAdapter);
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:32:11.020

在设置 GridView之前*，*您不会读取已保存的状态...更改您的代码以*首先*读取已保存的状态：

```
if(savedInstanceState != null && savedInstanceState.containsKey(CALENDAR)){
    mCalendar = (Calendar) savedInstanceState.getSerializable(CALENDAR);
}else{
    mCalendar = Calendar.getInstance(Locale.getDefault());
}
month = mCalendar.get(Calendar.MONTH) + 1;
year = mCalendar.get(Calendar.YEAR);

// Initialize your Buttons and such...

setGridCellAdapter(month, year); 
```

删除任何其他试图设置`mCalendar`的代码`onCreate()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T05:45:25.087

试试这个：

```
mCalendar.set(year, month - 1 , 1); 
```

建议：如果你使用月份作为保存和恢复对象而不是日历会更简单。

# javascript - 在画布中调整图像大小时，浏览器如何处理图像重采样？

> ID：13713425
> 
> 赞同：3
> 
> 时间：2012-12-04T22:53:33.520
> 
> 标签：javascript, jquery, html, canvas, image-scaling

嗨，我正在使用画布元素和 jQuery 创建视频游戏。其中一部分需要绘制拱形路径和圆圈。不幸的是，这会产生子像素和抗锯齿问题。没有浏览器允许您简单地禁用抗锯齿，所以我一直在考虑使用其中有圆圈的图像。另一部分是游戏窗口可以根据浏览器窗口改变大小，因此会改变其中图像的大小。

我的问题的一个更彻底的例子是：如果我创建一个（例如）80px 的图像并且游戏想要将它缩放到 37px，我可以将它作为我游戏中对象的预渲染吗？此外，如果我这样做，画布会用子像素渲染它吗？

PS 我不是在寻找任何代码示例，这只是一个技术问题，我似乎找不到任何文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T13:10:10.147

这可以帮助您扩展使用图像而不是路径来绘制非插值图像的想法。

```
ctx.imageSmoothingEnabled       = false;
ctx.mozImageSmoothingEnabled    = false;
ctx.oImageSmoothingEnabled      = false;
ctx.webkitImageSmoothingEnabled = false; 
```

在提供位置和尺寸时还要确保使用整数；

`ctx.drawImage(something, x | 0, y | 0);`

# python - 为什么这个 python WMI 调用给我一个错误？

> ID：13713428
> 
> 赞同：1
> 
> 时间：2012-12-04T22:53:50.300
> 
> 标签：python, windows, windows-xp, wmi, python-2.5

好吧，我在这里很无知。我使用 python WMI 模块执行以下命令：

```
 sj = wmi.Win32_ScheduledJob
    sj.Create("cmd", 0x40000000, 32, 1, 0, "******153000.000000-420") 
```

这给了我以下错误：

```
 Traceback (most recent call last):
      File "<pyshell#56>", line 1, in <module>
        sj.Create("cmd", 0x40000000, 32, 1, 0, "******153000.000000-420")
      File "C:\Python25\lib\site-packages\wmi.py", line 431, in __call__
        handle_com_error ()
      File "C:\Python25\lib\site-packages\wmi.py", line 241, in handle_com_error
        raise klass (com_error=err)
    x_wmi: <x_wmi: Unexpected COM Error (-2147352567, 'Exception occurred.', (0,         u'SWbemProperty', u'Type mismatch ', None, 0, -2147217403), None)> 
```

好的，你能告诉我我提供的论据是错误的吗？请给我示例代码。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:14:16.127

**如果您使用8**个初始`*`字符而不是 6 个字符来格式化 StartTime 参数，会有什么不同吗？

我只是注意到[Win32_ScheduledJob](http://msdn.microsoft.com/en-us/library/windows/desktop/aa389389%28v=vs.85%29.aspx)文档似乎指示 8 *s，而不是省略的`YYYYMMDD`字符...

# javascript - 每页两个谷歌分析帐户

> ID：13713431
> 
> 赞同：1
> 
> 时间：2012-12-04T22:54:19.183
> 
> 标签：javascript, google-analytics

> **可能重复：**
> [谷歌分析 - 一页上有多个跟踪器（cookie 冲突）](https://stackoverflow.com/questions/1239042/google-analytics-multiple-trackers-on-one-page-cookie-conflict)

我在互联网上搜索过这个问题，但找不到我正在寻找的答案。

我开发了一个博客，具有一些特殊功能。每个用户在注册时都会获得自己的子域。

一切都是免费的，但有广告。我目前使用谷歌分析来跟踪访问者总数和浏览量。

我开发了一个小计数器，以便每个用户可以查看他们有多少访问者和浏览量，但是对于更详细的信息，他们需要使用自己的“谷歌分析”，或者他们想要使用的任何东西。

所以。我现在使用的代码：

```
<script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-xxxxxx1-1']);
        _gaq.push(['_setDomainName', 'sub.domain.com']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script> 
```

我不知道每个用户将使用哪种类型的分析服务，我让他们在 HEAD 中插入自己的代码。那么，如果他们使用谷歌分析，我们在谷歌分析的两个帐户会获得正确数量的访问者吗？然后代码将是：

```
<script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-xxxxxx1-1']);
        _gaq.push(['_setDomainName', 'sub.domain.com']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
<script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-xxxxxx2-1']);
        _gaq.push(['_setDomainName', 'sub.domain.com']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script> 
```

还是我必须这样做：

```
_gaq.push(
    ['_setAccount', 'UA-XXXXXXXX-1'],
    ['_trackPageview'],
    ['b._setAccount', 'UA-XXXXXXXX-2'],
    ['b._trackPageview'] 
); 
```

两个跟踪器都在同一个 . ??

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:25:52.607

这是一个例子，它有效。我的代码相同。

```
_gaq.push(
  ['_setAccount', 'UA-XXXXX-1'],
  ['_trackPageview'],
  ['b._setAccount', 'UA-XXXXX-2'],
  ['b._trackPageview']
); 
```

# c++ - 安装超过 1 个对象时出现分段错误

> ID：13713434
> 
> 赞同：-1
> 
> 时间：2012-12-04T22:54:31.170
> 
> 标签：c++, oop, class, graph, instantiation

我有一个名为“Vertex.hpp”的类，如下所示：

```
 #include <iostream>
 #include "Edge.hpp"
 #include <vector>
   using namespace std;

/** A class, instances of which are nodes in an HCTree.
 */
class Vertex {
public:
Vertex(char * str){
 *name=*str;
 }

vector<Vertex*> adjecency_list;
vector<Edge*> edge_weights;
char *name;

 };

#endif 
```

当我按如下方式实例化 Vector 类型的对象时：

```
 Vertex *first_read;
 Vertex *second_read;

  in.getline(input,256);

  str=strtok(input," ");
  first_read->name=str;

  str=strtok(NULL, " ");
  second_read->name=str; 
```

当实例化超过 1 个 Vector 类型的对象时，会发生分段错误。如果实例化超过 1 个对象，为什么会发生这种情况，如何允许实例化多个对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:02:25.983

```
*name=*str; 
```

在你首先使它指向某个东西之前，你不能取消引用一个指针。

你的意思可能是这样的：

```
Vertex(char * str) {
    name=strdup(str);
} 
```

但你真的应该使用[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:19:53.900

我认为你复制字符串的方式是错误的。

```
*name=*str; 
```

两个`name`ans`str`都是 char* 类型。您正在取消引用这些指针。这意味着您查看它们指向的内存位置并将其解释为字符。

当您第一次调用它时，某些东西位于指向的位置，`str`并且它的第一个字符被复制到随机地址（因为您从未初始化过`name`）。

第二次你就没那么幸运了。`strtok`在 cplusplus上调用 NULL 返回 NULL [strtok](http://www.cplusplus.com/reference/cstring/strtok/)

现在您尝试使用空指针指向的内存，这很糟糕。

您需要分配内存`name`并使用正确的复制功能。

```
name = new char[SomeMaxLenght];
strcpy(name, str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:20:51.007

这是一种非常 C 的做事方式，在现代 C++ 中是非常不推荐的。请记住，C++ 应该被视为一种*不同的语言*，而不是 C 的严格超集。

首先，您应该通过查看[该列表](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)真正获得一本好书，因为您似乎缺少许多基础知识。

至于您的问题，主要问题是`name`未初始化，因此您遇到了所谓的*未定义行为*（即任何事情都可能发生；在您的情况下，它在第二次实例化时崩溃）。我可以深入探讨如何通过动态分配内存来修复它，但是为什么要麻烦呢？只需使用`std::string`：

```
class Vertex {
    std::string name; // string instead of char *
public:
    Vertex(const std::string &str) { // pass by const reference
        name = str; // I should really use an initializer list there, but oh well
    }

    // the rest of the class is the same
}; 
```

看看这有多简单？现在您不必乱用指针，使用起来很痛苦。所以，简而言之：使用标准库。并获得一本好书。真的。

# java - 简单的 JFrame 程序但看不到 JTextfield

> ID：13713435
> 
> 赞同：0
> 
> 时间：2012-12-04T22:54:35.527
> 
> 标签：java, swing, jframe, jpanel, jtextfield

我正在尝试自学 Swing。我正在玩一个玩具程序，要求用户输入他们的名字。我将 JLabel 和 JTextfield 放入 JPanel 中，用户可以在其中输入他们的姓名并提交。然而，我的 JTextfield 被压扁并且不可见，我无法让它显示（我试过“setSize”无济于事）。

![不可见的 JTextField](../Images/424a879d275f71ab8dd6e0419535ef7c.png)

这是我的代码：

```
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class NamePrompt extends JFrame{

    private static final long serialVersionUID = 1L;

    String name;

    public NamePrompt(){

        setLayout(new BorderLayout());

        JLabel enterYourName = new JLabel("Enter Your Name Here:");
        JTextField textBoxToEnterName = new JTextField();
        textBoxToEnterName.setSize(40, 10);
        JPanel panelTop = new JPanel();
        panelTop.add(enterYourName);
        panelTop.add(textBoxToEnterName);

        JButton submit = new JButton("Submit");
        submit.addActionListener(new SubmitButton());
        JPanel panelBottom = new JPanel();
        panelBottom.add(submit);

        //Add panelTop to JFrame
        add(panelTop, BorderLayout.NORTH);
        add(panelBottom, BorderLayout.SOUTH);

        //JFrame set-up
        setTitle("Name Prompt Program");
        setSize(300, 150);
        setLocationRelativeTo(null);

    }

    public static void main(String[] args) {
        NamePrompt promptForName = new NamePrompt();
        promptForName.setVisible(true);

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:57:31.310

```
JTextField textBoxToEnterName = new JTextField(20); 
```

见[`new JTextField(columns)`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextField.html#JTextField%28int%29)解释。例如

![名称提示](../Images/d64d0d2757cf6de8ed2a95e7cd9b471d.png)

```
import java.awt.BorderLayout;
import javax.swing.*;

public class NamePrompt extends JFrame{

    private static final long serialVersionUID = 1L;

    String name;

    public NamePrompt(){

        setLayout(new BorderLayout());

        JLabel enterYourName = new JLabel("Enter Your Name Here:");
        JTextField textBoxToEnterName = new JTextField(21);
        //textBoxToEnterName.setSize(40, 10);
        JPanel panelTop = new JPanel();
        panelTop.add(enterYourName);
        panelTop.add(textBoxToEnterName);

        JButton submit = new JButton("Submit");
        //submit.addActionListener(new SubmitButton());
        JPanel panelBottom = new JPanel();
        panelBottom.add(submit);

        //Add panelTop to JFrame
        add(panelTop, BorderLayout.NORTH);
        add(panelBottom, BorderLayout.SOUTH);

        //JFrame set-up
        setTitle("Name Prompt Program");
        //setSize(300, 150);
        pack();
        setLocationRelativeTo(null);
    }

    public static void main(String[] args) {
        NamePrompt promptForName = new NamePrompt();
        promptForName.setVisible(true);
    }
} 
```

# objective-c - 无法让 addObject 在 NSMutableArray 上工作

> ID：13713446
> 
> 赞同：0
> 
> 时间：2012-12-04T22:54:59.153
> 
> 标签：objective-c, ios, xcode

我正在尝试将 UIButton 对象添加到数组中，但他们没有这样做。每当我调用 [pixels count] 或 [colors count] 时，它都会返回 0。我尝试使用 [self.arrayName addObject:myObject] 和 [arrayName addObject:myObject] 但似乎都不起作用。我对 Objective-C 很陌生，所以我可能觉得它很愚蠢，但这已经让我难了一个多小时。

这是 ViewController.h 的代码

```
 #import <UIKit/UIKit.h>

 @interface ViewController : UIViewController {
 NSMutableArray *pixels;
 NSMutableArray *colors;
 }
 @property (nonatomic, retain) NSMutableArray *pixels;
 @property (nonatomic, retain) NSMutableArray *colors;
 @end 
```

这是来自 ViewController.m 的相关代码

```
 int x = 30;
 int y = 60;
 for(int i=0; i<10; i++ ) {
      UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake(x,y,20,20)];
      [self.pixels addObject:button];
      x += 20;
      y += 20;
 } 
```

我把整个项目都压缩了，可以在这里下载：http: [//mdl.fm/pixelated.zip](http://mdl.fm/pixelated.zip)

提前感谢任何可以提供帮助的人！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:01:19.470

在尝试使用数组之前尝试添加：

```
NSMutableArray *pixels = [[NSMutableArray alloc] init]; 
```

Obj-C 中的数组需要在使用前进行初始化。由于在 Obj-C 中调用 nil 实例上的方法只会返回零，因此很容易做到这一点，并且在您的数组没有存储您认为应该存储的内容之前不会注意到。

编辑以添加评论中的信息：

您可以将初始化放入`-ViewDidLoad`方法中，以便在`ViewController`自身准备好后它们就可以开始了。确保你`retain`是他们，所以他们不会自动被垃圾收集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:05:41.070

您在 init 方法中初始化了像素——您在情节提要中设置的控制器不会调用 init。将其更改为 initWithCoder: 或将数组初始化移动到 viewDidLoad。

# magento - 在 getRefererUrl 中调用 htmlspecialchars 的目的是什么？

> ID：13713448
> 
> 赞同：1
> 
> 时间：2012-12-04T22:55:18.663
> 
> 标签：magento

我在 Magento 中遇到了一个看似错误的问题，但我希望比我更聪明的人能解释一下。

在 VoteController.php 中，函数`addAction`调用`_redirectReferer`它的最后一行。这样做的目的是在 Magento 投票后将用户重定向回原始页面。

`_redirectReferer`call `_getRefererUrl`，它从几个地方获取引用 url。此函数所做的最后一件事是调用`escapeUrl`URL 字符串。 `escapeUrl`是`htmlspecialchars`.

结果是一个类似于`example.com/?a=b&c=d`变成的 URL `example.com/?a=b&amp;c=d`（注意损坏的 & 符号）。

在 URL 上调用 htmlspecialchars 的目的是什么？

* * *

**资源**

`addAction`：/app/code/core/Mage/Poll/controllers/VoteController.php
`_redirectReferer`和`_getRefererUrl`：/app/code/core/Mage/Core/Controller/Varien/Action.php
`escapeUrl`：/app/code/core/Mage/Core/Helper /摘要.php

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:36:58.077

**背景：** `&amp;`是和号字符所需的html实体表示；否则浏览器会假定`&`源代码中的任何内容都是实体表示。参考[http://www.w3.org/QA/2005/04/php-session#background](http://www.w3.org/QA/2005/04/php-session#background)。

这在呈现 URL 时很好，但在服务器端计算重定向并将其应用于响应对象时并不理想。因此**，这是一个错误**，也是一个很好的借口来重写`core/data`帮助程序以以正确的方式逃避这种情况。

任何人都懒得 POC :-) 来设置民意调查：

```
<?php
include 'app/Mage.php';
Mage::app();

$p = Mage::app()->getRequest()->getParams();

if (empty($p)) {
    $refererUrl = Mage::app()->getRequest()->getServer('HTTP_REFERER').'?foo=bar&baz=bip';
    $refererUrl = Mage::helper('core')->escapeUrl($refererUrl);
    Mage::app()->getResponse()->setRedirect($refererUrl);
    Mage::app()->getResponse()->sendResponse();
    exit;
}

var_dump($p); 
```

# wpf - WPF & Windows Form 是否有一些类似于 div 的控制行为

> ID：13713460
> 
> 赞同：1
> 
> 时间：2012-12-04T22:56:01.957
> 
> 标签：wpf, winforms, html, controls

在 HTML 中，我们有元素 div，不知道 WPF 或窗口窗体中是否有等效控件？谢谢

编辑

我正在寻找一个行为类似于以下 HTML 代码的控件。假设我有一个“添加列”按钮，当单击该按钮时，按钮下方会显示一个窗口，该窗口具有复选框、按钮、标签，当用户单击窗口中的按钮时，它将在单击事件处理程序中运行代码.

还有一件事，窗口不是模态的，应该保持打开状态。当窗口打开时，用户可以单击父 UI 的其他部分。

```
<button class="btn" id='add_columns'>Add Columns</button>
<div id="addcolumns_dropdown"  class="columns_dropdown">
  <div class="arrow"></div>
  <div id='columns'> 
    <table id='cols'></table>
  </div>
  <div class="buttons_div" style="display:none" id="select_cols_done_div">    
    <button class="btns" id='done_cols'>Done</button>
    <button class="btns" id='cancel_cols'>Cancel</button>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:14:37.677

`<div>`只是一个布局容器，WPF 有很多布局容器`Grid`，`StackPanel`等等。每个都有一定的布局，所以你可以选择最适合你需要的一个。

# java - 如何在 Java 中以 0.1f 增量在 0.1f 和 1.0f 之间进行迭代？

> ID：13713465
> 
> 赞同：2
> 
> 时间：2012-12-04T22:56:34.043
> 
> 标签：java

> **可能重复：**
> [Java 浮点数和双精度数，如何避免 0.0 + 0.1 + ... + 0.1 == 0.9000001？](https://stackoverflow.com/questions/5257166/java-floats-and-doubles-how-to-avoid-that-0-0-0-1-0-1-0-9000001)

我在 Java 中遇到以下问题 - 我需要以 0.1f 的增量在 0.1f 和 1.0f 之间进行迭代，所以我希望我的输出看起来像这样：

```
 0.1
    0.2
    0.3
    0.4
    ...
    0.9 
```

相反，当我这样做时：

```
for(float i = 0.1f; i < 1f; i += 0.1f)
    System.out.println(i); 
```

我明白了

```
0.1
0.2
0.3
0.4
0.5
0.6
0.70000005
0.8000001
0.9000001 
```

我想这与计算机表示分数的方式有关，但我想知道为什么会这样，如果有什么我能做的来阻止它。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T23:01:05.663

在 for 循环中使用整数以避免重复的浮点数学运算，这会导致浮点错误。

```
for (int i = 1; i < 10; i++)
{
   float f = (float) i / 10.0f;
   System.err.println(f);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:01:16.970

你可以试试这个：

```
for(int i = 1; i < 10; i++)
    System.out.println(i/10f); 
```

```
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9

```

您所看到的是浮点数固有的不准确性的产物，如果您连续添加它们，就会自然地建立起来，就像您在发布的代码中所做的那样。如果我们`int`在循环中使用 s 代替，我们避免了浮点加法，因此也避免了错误累积。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:58:34.653

浮点数是二进制的，不能很好地表示小数

如果适用，请改为以 1/8 或 0.125 迭代。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-04T23:00:56.600

```
for(float i =1.0f;i<10f;i+=1f)
System.out.println(i/10f);` 
```

丑得要命，但在这里工作（Ubuntu AMD64 OpenJDK）

# javascript - 使用 JavaScript 获取 div 的背景图像的实际大小

> ID：13713466
> 
> 赞同：3
> 
> 时间：2012-12-04T22:56:42.390
> 
> 标签：javascript, image, image-size

因此，我想获取一个 div 的背景图像的实际大小，并在该站点中搜索我在这个 url 中发现了一些很棒的 JavaScript 代码：http: [//jsbin.com/olozu/2/edit](http://jsbin.com/olozu/2/edit)。

但是，它似乎在我的网站上不起作用，我不知道为什么，尽管我的代码与上面的代码相同。

这是我的代码（[JS Bin](http://jsbin.com/uzejah/2/edit)）

HTML：

```
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>JS Bin</title>
</head>
<body onclick="picture()">
  <img id="topicinfo" src="http://pierre.chachatelier.fr/programmation/images/mozodojo-original-image.jpg"><
</body>
</html> 
```

JavaScript：

```
function picture()
{
  var a=document.getElementById("topicinfo").height;
  alert(a);
} 
```

如果单击左侧的图像，它会显示 0 宽 0 高。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:17:13.997

您正在尝试从`style`属性中获取信息，但由于您没有将图像背景声明为内联，`style`因此为空。你必须得到计算的样式。在这里看到这个线程；最佳答案提供了全面的解释。

[使用 JavaScript 读取元素的 CSS 属性](https://stackoverflow.com/questions/7894577/read-css-property-of-an-element-using-javascript)

另一个好资源：

[http://javascript.info/tutorial/styles-and-classes-getcomputedstyle#getcomputedstyle-and-currentstyle](http://javascript.info/tutorial/styles-and-classes-getcomputedstyle#getcomputedstyle-and-currentstyle)

编辑：更具体地说，您要做的是：

```
var imageUrl = getComputedStyle(document.getElementById('topicinfo'));
var imageSrc = imageUrl.replace(/"/g,"")
                       .replace(/url\(|\)$/ig, ""); 
```

不过，我仍然建议查看这些资源，因为它们提供了一种很好的方法来实现使此类操作易于重复的功能。

# ios - 每天使用的应用程序向 TableView 添加一行

> ID：13713471
> 
> 赞同：3
> 
> 时间：2012-12-04T22:56:55.140
> 
> 标签：ios, xcode, uitableview, xml-parsing

我正在构建一个将用作日常阅读指南的应用程序。数据全部存储在一个 XML 中，该 XML 将存储在应用程序中，并根据 pubDate 进行排序。关于每个部分代码中的行数，如果我只输入一个数字，我会得到错误，但如果我输入

```
[array count]; 
```

它显示了每一个项目。我能得到一些关于如何实现我的目标的建议吗？

编辑：这是我的应用程序的更多代码。我使用 ASIHTTPRequest 和 GDataXML 来解析 XML 并将每个项目存储在一个数组中。我想要做的是只显示最早的条目第 1 天，添加第二天的第 2 天，依此类推。如果我在 numberOfRowsInSection 中输入除数组计数之外的任何其他数字，它就会崩溃。我相信这是由于用于按日期对数组条目进行排序的代码。

```
- (void)requestFinished:(ASIHTTPRequest *)request {

    [_queue addOperationWithBlock:^{

        NSError *error;
        GDataXMLDocument *doc = [[GDataXMLDocument alloc] initWithData:[request responseData] 
                                                               options:0 error:&error];
        if (doc == nil) { 
            NSLog(@"Failed to parse %@", request.url);
        } else {

            NSMutableArray *entries = [NSMutableArray array];
            [self parseFeed:doc.rootElement entries:entries];                

            [[NSOperationQueue mainQueue] addOperationWithBlock:^{

                for (RSSEntry *entry in entries) {

                    int insertIdx = [_allEntries indexForInsertingObject:entry sortedUsingBlock:^(id a, id b) {
                        RSSEntry *entry1 = (RSSEntry *) a;
                        RSSEntry *entry2 = (RSSEntry *) b;
                        return [entry1.articleDate compare:entry2.articleDate];
                    }];

                    [_allEntries insertObject:entry atIndex:insertIdx];
                    [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:[NSIndexPath indexPathForRow:insertIdx inSection:0]]
                                          withRowAnimation:UITableViewRowAnimationRight];

                }                            

            }];

        }        
    }];
    [self.refreshControl endRefreshing];

} 
```

如何将其更改为按日期排序，在第一天显示最早的，并每天添加一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T00:15:38.407

我会将日期值存储到您的 NSUserDefaults 中并使用它来比较并查看日期是否已更改，然后使用它来修改该部分中的行数。我已经对这段代码进行了大量评论，希望它能更好地解释。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    NSCalendar *calendar = [NSCalendar autoupdatingCurrentCalendar];

    int numberOfDays = 0;   //initialize integer variable    

    //get the current date from the user's device
    NSDate *now = [NSDate date];

    //create a dateformatter to handle string conversion
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateStyle:NSDateFormatterMediumStyle];

    // String to store in defaults.
    NSString *todaysDateString = [dateFormatter stringFromDate:now];

    // get access to the user defaults
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    if (![defaults valueForKey:@"date_last_opened"]) {

        // if there is no value for the key, save today's date as the string we formatted
        [defaults setValue:todaysDateString forKey:@"date_last_opened"];

    } else {

        // there is already a value for date-last-opened, so pull it from the defaults, and convert it from a string back into a date.
        NSDate *dateLastOpened = [dateFormatter dateFromString:[defaults valueForKey:@"date_last_opened"]];

        if ([dateLastOpened compare:now] == NSOrderedAscending) {

            // if the date_last_opened is before todays date, get the number of days difference.

            unsigned int unitFlags = NSDayCalendarUnit;
            NSDateComponents *comps = [calendar components:unitFlags fromDate:dateLastOpened  toDate:now options:0];

            numberOfDays = [defaults integerForKey:@"totalDays"] + [comps day];
        [defaults setInteger:numberOfDays forKey:@"totalDays"];
        }
    }

return numberOfDays;

} 
```

**编辑：**此代码假定，当应用程序首次启动时，您已经将类似于 @"totalDays" 的键的 NSUserDefault 值设置为 1，例如在 viewDidLoad 中可能：

```
if (![defaults integerForKey:@"totalDays"]) {

        // if there is no value for the key, set it to 1
        [defaults setInteger:1 forKey:@"totalDays"];

    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T05:34:06.187

在您的课程 AppDelegate.m 中，您可以这样做：

```
//Application did launch
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
  int count = [[NSUserDefaults standardUserDefaults] integerForKey:@"LaunchCount"];
  if(count < 0) count = 0;
  [[NSUserDefaults standardUserDefaults] setInteger:count+1 forKey:@"LaunchCount"];
}

//The application was in background and become active
- (void)applicationWillEnterForeground:(UIApplication *)application
{
  int count = [[NSUserDefaults standardUserDefaults] integerForKey:@"LaunchCount"];
  if(count < 0) count = 0;
  [[NSUserDefaults standardUserDefaults] setInteger:count+1 forKey:@"LaunchCount"];
} 
```

然后使用 NSUserDefault Key @"LaunchCount" 你可以添加一个 Table-Row。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T02:40:29.083

`NSTimeInterval`像24小时这样的东西怎么样 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T22:58:49.287

听起来您想要一个带有 [array count] 行的部分，而现在您要返回 [array count] 部分和 [array count] 行。

# graphics - 创建一个 Matrix3d 矩阵，将 vector3d 围绕一个圆锥进行变换

> ID：13713478
> 
> 赞同：1
> 
> 时间：2012-12-04T22:57:30.707
> 
> 标签：graphics, raytracing

我正在尝试制作分布式递归光线追踪器。我有一个 Vector3d 对象（代表完美/理想反射），我想在其上创建一个随机变换，以便获得与原始向量偏移一个角度的新向量。

有点像这样： ![在此处输入图像描述](../Images/e70822ae8fb508a132a63576fc3df0ec.png)

我认为正确的方法是以某种方式将矢量投影到 X 轴，沿 y 轴旋转随机角度，然后沿 x 轴旋转，然后进行逆投影。我不确定这些转换的矩阵是什么。

（基本上，我想创建与 OpenGL 的 glRotated() 相同的矩阵，而不需要为矩阵的每个元素手动输入巨大的公式）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T05:33:51.337

偶然发现[Rodrigues 的旋转公式](http://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula)，它可能提供一种更简单的矩阵计算方法。维基百科说它消除了对矩阵指数的需求，这听起来令人印象深刻。

[这里](http://en.wikipedia.org/wiki/Axis-angle_representation#Relationship_to_other_representations)还有其他三种方法。使用四元数的那个似乎具有符号最少的优势（？）。

# xcode - xcode 并从 NSDictionary (objectForKey & valueForKey) 中提取数据值

> ID：13713480
> 
> 赞同：0
> 
> 时间：2012-12-04T22:57:40.147
> 
> 标签：xcode, json, ios5

我对数据类型 NSDictionary 有点困惑，因为它与 JSON 结构有关并且需要帮助。这是我的 JSON 输出：

```
{
    "requestDetails":
    {
        "timeStamp":"2001-12-17T09:30:47-08:00",
        "transactionType":"QUERY",
        "action":"GET INVOICES",
    },
    "Payload":
    {
        "event":
        {
            "sourceRecordType":"INVOICE INQUIRY",
            "serviceRecordType":"INVOICE",
            "ownershipType":"EXPLICIT",
        },
    },
    "executionDetails":
    {
        "timeStamp":"2012-12-04T13:48:21-08:00",
        "statusType":   "SUCCESSFUL_TRANSACTION",
        "statusCode":"0",
        "DBRecordCount":"0",
        "processedRecordCount":"0",
        "warning":
        [
            {
                "errorCode":"257",
                "errorDescription":"Criteria specified is incorrect. Please Verify that the criteria is correct.",
                "__hashCodeCalc":false
            },
            {   "errorCode":"60",
                "errorDescription":"No results were found.  Please enter new search criteria.",
                "__hashCodeCalc":false
            }
        ],
    },
} 
```

现在我的理解是这整件事是字典和 objectForKey:@"executionDetails" 将给出以下输出：

```
{
        "timeStamp":"2012-12-04T13:48:21-08:00",
        "statusType":   "SUCCESSFUL_TRANSACTION",
        "statusCode":"0",
        "DBRecordCount":"0",
        "processedRecordCount":"0",
        "warning":
        [
            {
                "errorCode":"257",
                "errorDescription":"Criteria specified is incorrect. Please Verify that the criteria is correct.",
                "__hashCodeCalc":false
            },
            {   "errorCode":"60",
                "errorDescription":"No results were found.  Please enter new search criteria.",
                "__hashCodeCalc":false
            }
        ],
    } 
```

如何在 [] 括号内选择值。我尝试了 valueForKey 和 ObjectForKey。我不清楚处理结构并感谢帮助

```
warning":
        [
            {
                "errorCode":"257",
                "errorDescription":"Criteria specified is incorrect. Please Verify that the criteria is correct.",
                "__hashCodeCalc":false
            },
            {   "errorCode":"60",
                "errorDescription":"No results were found.  Please enter new search criteria.",
                "__hashCodeCalc":false
            }
        ], 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:06:37.463

这只是一个数组。您可以像这样访问其内容。

```
NSDictionary *executionDetails = [json objectForKey:@"executionDetails"];
NSArray *warnings = [executionDetails objectForKey:@"warning"];

for (NSDictionary *warning in warnings) {
    NSLog(@"%@", warning);
}
// To access an individual warning use: [warnings objectAtIndex:0] 
```

您还可以使用现代 Objective-C 语法使其更清晰：

```
NSDictionary *executionDetails = json[@"executionDetails"];
NSArray *warnings = executionDetails[@"warning"];
NSLog(warnings[0]); 
```

# ruby - 如何在 Rails 应用程序中获取 Stocktwits access_token？

> ID：13713483
> 
> 赞同：0
> 
> 时间：2012-12-04T22:57:59.100
> 
> 标签：ruby, access-token, stocktwits

我需要帮助解决问题。我的网站使用omniauth-stocktwits gem 与Stocktwits 集成。我想使用 Stocktwits API 来获取评论流。所以，我需要access_token！

用户在 StockTwits 授权我的应用程序后，我看到我使用“code”参数重定向到我的 /callback URL。正如我在omniauth 代码中看到的那样，这个“代码”字段不用于任何事情。所以我决定尝试获取 api 文档中推荐的 access_token：

```
curl -X POST https://api.stocktwits.com/api/2/oauth/token -d 'client_id=MY_CLIENT_ID&client_secret=MY_SECRET&code=CODE_FROM_REDIRECT_PARAMS&grant_type=authorization_code&redirect_uri=http://my.site.url' 
```

我尝试了很多次。使用 gurl，使用 HTTParty（我的网站是用 Ruby 编写的）- 一个结果：

```
"errors"=>["code doesn't exist or has expired"]} 
```

或 {"response":{"status":403},"errors":[{"message":"Permission denied"}]}

我真的确定使用了所有范围，并且我授权应用程序读取流，所以我不知道什么权限被拒绝...

我不知道如果我得到它，代码会如何过期:(

错误在哪里？如何获得 access_token？拜托，任何帮助都会很好:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T01:38:29.277

这是获得代码后获取访问令牌的正确流程和正确端点。这是我们的身份验证流程：[http ://stocktwits.com/developers/docs/authentication](http://stocktwits.com/developers/docs/authentication)

我不确定您为什么收到无效代码，您可以尝试在没有omniauth gem 的情况下获取用户代码吗？或者尝试向omniauth-stocktwits gem 作者传授知识：[https ://github.com/jesseyoungmann/omniauth-stocktwits](https://github.com/jesseyoungmann/omniauth-stocktwits)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:09:55.427

如果再次出现这种情况，对于未来的问题：[https ://github.com/jesseyoungmann/omniauth-stocktwits/issues/1#issuecomment-11139157](https://github.com/jesseyoungmann/omniauth-stocktwits/issues/1#issuecomment-11139157)

# linux - RPM 使用专有安装程序打包 tarball

> ID：13713488
> 
> 赞同：2
> 
> 时间：2012-12-04T22:58:23.453
> 
> 标签：linux, rpm, rpmbuild, rpm-spec

我目前正在尝试从使用专有二进制安装程序在文件系统中转储一堆文件的 tarball 创建一个 RPM。这个安装程序不允许*我*指定文件的去向（所以我不能将它们转储到构建文件夹中）。我想知道的是可靠打包文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:05:10.757

有一个名为[checkinstall](http://checkinstall.izto.org/)的实用程序基本上可以执行此操作，但相信它是特定于 Makefile 的。

但是，再深入一点，您会发现一个名为[installwatch](http://asic-linux.com.mx/~izto/checkinstall/installwatch.html)的库。虽然有点旧，但它可以用来包装系统调用，并希望能告诉你什么被安装在哪里。

您的最终结果本身不会是 rpm，但这应该为您提供足够的信息来构建 rpmbuild(8) 规范文件。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:40:14.567

您可以让安装程序在`%post`. 许多问题之一是 RPM 数据库不知道您在其背后安装的任何文件。但是我已经看到这样做了，特别是对于驱动程序，因此他们不需要为每个内核发布一个版本。

# php - 第一次调整大小时无法裁剪图像

> ID：13713489
> 
> 赞同：1
> 
> 时间：2012-12-04T22:58:24.747
> 
> 标签：php, codeigniter

我正在使用 Codeigniter 中的图像操作库，我需要将图像的大小调整为最大宽度为 278px，同时保持比例。我还需要确保图像不超过 400 像素。

我试图通过使用`$this->image_lib->resize()`然后再次运行它来做到这一点`$this->image_lib->crop()`，但是我在调​​整大小干扰作物时遇到了麻烦。

这是两个模型：

```
public function create_thumb($path) {

    $data = $this->upload->data();

    if ($data['image_width'] >= 278):

        $config['image_library'] = 'gd2';
        $config['source_image'] = $path;
        $config['create_thumb'] = FALSE;
        $config['maintain_ratio'] = TRUE;
        $config['width'] = 278;
        $config['height'] = 400;
        $config['quality'] = '90%';
        $config['master_dim'] = 'width';

        $this->load->library('image_lib', $config);

        if ($this->image_lib->resize()):

            $this->image_lib->clear();

        endif;

    endif;

    $this->crop_image($path);

    return false;
}

// Make max image size 278x400
public function crop_image($path) {

    list($width, $height) = getimagesize($path);

    $config['image_library'] = 'gd2';
    $config['source_image'] = $path;
    $config['x_axis'] = '0';
    $config['y_axis'] = '0';
    $config['maintain_ratio'] = FALSE;
    $config['width'] = $width;
    $config['height'] = 400;
    $config['quality'] = '100%';

    $this->load->library('image_lib', $config);

    if ($this->image_lib->crop())
    {
        return true;
    }
    return false;
} 
```

如果我直接从控制器调用crop_image()，它会按预期进行裁剪。但是，当从 create_thumb() 调用它时，我收到错误`Your server does not support the GD function required to process this type of image.`由于我之前能够裁剪图像并且根据 phpinfo() 安装了 GD，我对为什么会收到此错误感到困惑。

我认为这个问题与两次加载 image_lib 有关，但我认为这`$this->image_lib->clear();`会解决这个问题？

我究竟做错了什么？有没有更好的方法可以将图像大小调整为最大 278 像素宽度和最大 400 像素高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T11:32:49.523

尝试这个 ：-

```
 //Resize Image
            $config = array();
            $config['image_library'] = 'gd2';
            $config['source_image'] = './assets/uploaded_files/gallery/original/'.$image_name;
            $config['new_image'] = './assets/uploaded_files/gallery/banner/'.$image_name;
            $config['create_thumb'] = FALSE;
            $config['maintain_ratio'] = TRUE;
            $config['master_dim']= 'width';
            $config['quality']  = '100';
            $config['width'] = 1260;
            $config['height']= 645;
            $this->image_lib->initialize($config);
            $this->image_lib->resize();
            //Crop image
            $config = array();
            $config['image_library'] = 'gd2';
            $config['source_image'] = './assets/uploaded_files/gallery/banner/'.$image_name;
            $config['new_image'] = './assets/uploaded_files/gallery/banner/'.$image_name;
            $config['create_thumb'] = FALSE;
            $config['maintain_ratio'] = FALSE;
            $config['quality']  = '100';
            $config['x_axis'] = 0;
            $config['y_axis'] = 0;
            $config['width'] = 1260;
            $config['height']= 645;
            $this->image_lib->initialize($config);
            $this->image_lib->crop(); 
```

根据您的需要调整宽度和高度。

# php - 每次单击图像时更新 mysql 表中的分数 (+1) ( )。使用 php

> ID：13713492
> 
> 赞同：1
> 
> 时间：2012-12-04T22:58:31.753
> 
> 标签：php, mysql, database, onclick

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:31:38.557

PHP 代码在页面加载时执行，除非另有说明（通过某些 IF 语句等）。因此，如果您将任何类型的 PHP 代码放入 HTML 标记中，如下所示：

```
<a href="<?php mysql_query("UPDATE `table2` SET `score` = `score` + 1 WHERE `id` = $id_cat2"); echo $random_btn; ?>"><?php echo $image_cat2; ?></a><br/> 
```

无论是否单击链接，您在 href 属性中编写的代码都会被执行。

解决方法如下：在 href 属性中写入**"?update_photo=1"**，在其他锚点中写入**href="?update_photo=2"**。

在 PHP 标记内写入以下内容：

```
if(isset($_GET['update_photo'])){
    $id = (int)$_GET['update_photo'];
    mysql_query("UPDATE `table2` SET `score` = `score` + 1 WHERE `id` = {$id}");
} 
```

# javascript - IE8/9 $.get 和 .html() 返回未呈现的数据

> ID：13713499
> 
> 赞同：1
> 
> 时间：2012-12-04T22:59:05.773
> 
> 标签：javascript, ajax, jquery

我有以下 JavaScript，

```
$(".refresh").on("click touch", function () {
    $.get($("a.suggest-date").attr('href') + '#suggestedDate', null, function (result) {
        console.log(result);
        $("#ajax-loaded").html(result)
    });
    return false;
}); 
```

$.get 得到响应，

```
<!DOCTYPE html>
<html class="">
    <head>
        <title>Suggest</title>
    </head>
    <body>
        <div id="suggestedDate">
                                    <script type="text/javascript">
                        var map;
                        var places;
                        var iw;
                        var markers = [];

                        function initialize() {
                            var options = {
                                zoom: 15,
                                center: new google.maps.LatLng(51.45390,-0.12246),
                                mapTypeId: google.maps.MapTypeId.ROADMAP,
                                streetViewControl: false
                            };
                            var mapCanvas = document.getElementById('map_canvas');
                            map = new google.maps.Map(mapCanvas, options);

                            var myLatlng = new google.maps.LatLng(51.45390,-0.12246);
                            markers[0] = new google.maps.Marker({
                                position: myLatlng,
                                animation: google.maps.Animation.DROP,
                                icon: 'http://maps.gstatic.com/intl/en_us/mapfiles/marker.png'
                            });
                            google.maps.event.addListener( markers[0], 'click', '');
                            dropMarker(markers[0], 0 * 100);
                    //addResult(results[i], i);
                        }

              function clearMarkers() {
                for (var i = 0; i < markers.length; i++) {
                  if (markers[i]) {
                    markers[i].setMap(null);
                    delete markers[i]

                  }
                }
              }

              function dropMarker(marker, delay) {
                window.setTimeout(function() {
                  marker.setMap(map);
                }, delay);
              }

              function addResult(result, i) {
                var results = document.getElementById('results');
                var tr = document.createElement('tr');
                tr.style.backgroundColor = i % 2 == 0 ? '#F0F0F0' : '#FFFFFF';
                tr.onclick = function() {
                  google.maps.event.trigger(markers[i], 'click');
                };

                var iconTd = document.createElement('td');
                var nameTd = document.createElement('td');
                var icon = document.createElement('img');
                icon.src = result.icon;
                icon.className = 'placeIcon';
                var name = document.createTextNode(result.name);
                iconTd.appendChild(icon);
                nameTd.appendChild(name);
                tr.appendChild(iconTd);
                tr.appendChild(nameTd);
                results.appendChild(tr);
              }

              function clearResults() { 
                var results = document.getElementById('results');
                while (results.childNodes[0]) {
                  results.removeChild(results.childNodes[0]);
                }
              }

              function getDetails(result, i) {
                return function() {
                  places.getDetails({
                    reference: result.reference
                  }, showInfoWindow(i));
                }
              }

              function showInfoWindow(i) {
                return function(place, status) {
                  if (iw) {
                    iw.close();
                    iw = null;
                  }

                  if (status == google.maps.places.PlacesServiceStatus.OK) {
                    iw = new google.maps.InfoWindow({
                      content: getIWContent(place)
                    });
                    iw.open(map, markers[i]);
                  }
                }
              }

              function getIWContent(place) {
                var content = '<table style="border:0"><tr><td style="border:0;">';
                //content += '<img class="placeIcon" src="' + place.icon + '"></td>';
                content += '<td style="border:0;"><b>';
                content += 'PLACE NAME' + '</a></b>';
                content += '</td></tr></table>';
                return content;
              }

        //show_place();
        </script>
                    <div class="date-wrapper">
            <header>
            <h3>Suggest A Date</h3>
            <a href="#" class="close-date">
                <img src="http://dev64238.loveflutter.com/assets/img/close-suggest-date.jpg" alt="close" />
            </a>
            </header>
            <div class="date-details">
                <strong> Windmill Brixton</strong><br />
                 22 Bleinheim Gdns.,Brixton,Greater London,SW2 5BZ <br>Tel: +442086710700<br/>
                <span class="type">Music Venue</span>
            </div>
                            <a href="" class="suggest-message">Suggest this date</a>
                            <div class="clear"></div>
            <div id="map_canvas"></div>
                            <div class="suggestions">
                <header>
                    <h3>Tips</h3>
                </header>
                <ul>
                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs2.4sqi.net/img/user/40x40/BX4LJ4AWOITAKFEP.png" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>Time Out London</strong> <span class="date">Mar 28, 2012</span><br />
                            The Windmill?s been revelling in its rough-around-the-edges eccentricity for years, its unprepossessing exterior a cloak for its dedication to new leftfield music.                         </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs2.4sqi.net/img/user/40x40/CZ4LAAECPOPSLWFO.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>lojinx</strong> <span class="date">Nov 14, 2011</span><br />
                            Quite possibly the best music venue in London.                          </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs0.4sqi.net/img/user/40x40/DSZOC3K4QKAPXSJR.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>Sonja F.</strong> <span class="date">Sep 17, 2011</span><br />
                            Voted one of the best live music venues in London                           </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs3.4sqi.net/img/user/40x40/WA34MTKMKJO1KCHQ.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>Thrash Hits</strong> <span class="date">Jan 26, 2011</span><br />
                            Famous for the rock 'n' roll all-dayers with the saltiest barbecues ever. It's a(nother) good excuse to drink more beer. Great gigs happen here. Plus there is a dog on the roof. A Roof Dog.                           </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs0.4sqi.net/img/user/40x40/EKEP42S0ULCMYI44.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>Drowned in Sound</strong> <span class="date">Jan 26, 2011</span><br />
                            Home of some early DiS nights and alldayers. Great little venue. Usually a free bbq on Sundays, and yeah, DOG ON THE ROOF! Like, a real Dog.                            </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs2.4sqi.net/img/user/40x40/YHCPQIZ0W31MZBPM.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>Jonathan D.</strong> <span class="date">Nov 24, 2010</span><br />
                            Mind the Rottweiler on the roof! That's a bit mental!                           </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs3.4sqi.net/img/user/40x40/1F3XOCML0ZKKQJOU.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>aurora</strong> <span class="date">Sep 08, 2010</span><br />
                            Looking forward to the pine hill haints gig                         </div>
                    </li>

                                        <li>
                        <div class="thumbnail">

                            <img src="https://irs1.4sqi.net/img/user/40x40/4N5O4KYF54WUYBCW.jpg" alt="user"/>
                        </div>
                        <div class="content">
                            <strong>Jack P.</strong> <span class="date">Jul 18, 2010</span><br />
                            Quite simply Brixton's finest venue... Hook up a summer BBQ/ roofdog spotting/ awesome gig for good times...                            </div>
                    </li>

                </ul>
            </div>  
                            <div class="clear"></div>
                            <div class="refresh">
                <a href="" class="refresh-date"><img src="http://dev64238.loveflutter.com/assets/img/refresh-date.png" alt="refresh"/></a>
            </div>
                            <div class="accreditation">
                <img src="http://dev64238.loveflutter.com/assets/img/date-accreditation.png" alt="accreditation"/>
            </div>
        </div>
    </div>
    <script>
      initialize();
    </script>
            <div id="send-date">
        <header>
            <h3>Suggest A Date</h3>
            <a href="#" class="close-date">
                <img src="http://dev64238.loveflutter.com/assets/img/close-suggest-date.jpg" alt="close" />
            </a>
        </header>
                    <form action="http://dev64238.loveflutter.com/ajax/suggestion" name="save_suggestion" id="save_suggestion" method="post">
                            <input type="hidden" name="id" id="id" value="4be57938bcef2d7fc3ce03e5" />
                            <input type="hidden" name="name" id="name" value="Windmill Brixton" />
                            <input type="hidden" name="phone" id="phone" value="+442086710700" />
                            <input type="hidden" name="address" id="address" value="22 Bleinheim Gdns." />
                            <input type="hidden" name="lat" id="lat" value="51.45390" />
                            <input type="hidden" name="lng" id="lng" value="-0.12246" />
                            <input type="hidden" name="postcode" id="postcode" value="SW2 5BZ" />
                            <input type="hidden" name="city" id="city" value="Brixton" />
                            <input type="hidden" name="state" id="state" value="Greater London" />
                            <input type="hidden" name="country" id="country" value="United Kingdom" />
                            <input type="hidden" name="cc" id="cc" value="GB" />
                            <input type="hidden" name="type" id="type" value="Music Venue" />
                            <input type="hidden" name="tips" id="tips" value="8" />
                            <input type="hidden" name="user_to" id="user_to" value="597" />
                                <fieldset>
                    <textarea name="message" class="wysiwyg" id="messages_message">How about we meet up at Windmill Brixton, 22 Bleinheim Gdns.,Brixton,Greater London,SW2 5BZ. Sound good? <a href="http://dev64238.loveflutter.com/dating_place/541" class="suggest-date-msg">See it on map</a></textarea>
                </fieldset>
                <div class="clear"></div>
                <div id="bottom">
                    <table>
                        <tr>
                            <td><input name="username" id="messages_username" value="john_dig" type="hidden">
                    <input type="submit" class="button green rounded_5 small" value="Suggest This Date" id="senddate"/>
                    <em>or</em>
                    <a href="" id="hide-send">Back to Map</a></td>
                        </tr>
                    </table>
                </div>
        </form>
    </div>
        </body> 
```

我无法弄清楚为什么返回数据被插入到`#ajax-loaded`元素中。谁能告诉我为什么这不起作用？它在 FF/Chrome/Safari 中完美运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:00:57.987

使 ajax 缓存为 false，因为 IE 存在 ajax 缓存问题

```
$.ajaxSetup({cache:false}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:06:18.240

添加回调函数作为第二个参数，而不是第三个参数（少即是多！）：

```
 $(".refresh").on("click touch", function () {
      $.get($("a.suggest-date").attr('href') + '#suggestedDate', function (result) {
          console.log(result);
          $("#ajax-loaded").html(result)
      });
      return false;
  }); 
```

# php - 在 PHP_CodeSniffer 1.4.3 中加载嗅探子集时出错

> ID：13713500
> 
> 赞同：0
> 
> 时间：2012-12-04T22:59:07.310
> 
> 标签：php, codesniffer

我在标准中包含外部嗅探时遇到了麻烦。使用最新版本的 PHP_CodeSniffer 1.4.3，我不能包含一组嗅探。我可以单独包含它们，但我想减少维护，只列出我不想要的。

工作规则集.xml

```
<?xml version="1.0"?>
<ruleset name="ICAP Standards">
    <description>ICAP Coding Standards for PHP_CodeSniffer</description>

    <rule ref="Generic.PHP.UpperCaseConstant" />
</ruleset> 
```

这有效并包括简单的测试。但是，我想将所有内容都包含在该组中，并排除一次嗅探。

也适用于 PHP_CodeSniffer 的 ruleset.xml ICAP 编码标准

```
 <rule ref="Generic">
        <exclude name="Generic.PHP.LowerCaseConstant"/>
    </rule>
</ruleset> 
```

非工作规则集.xml

```
<?xml version="1.0"?>
<ruleset name="ICAP Standards">
    <description>ICAP Coding Standards for PHP_CodeSniffer</description>

    <rule ref="Generic.PHP">
        <exclude name="Generic.PHP.LowerCaseConstant"/>
    </rule>
</ruleset> 
```

此规则集不起作用，并在运行 PHPCS 时返回异常。

```
PHP_CodeSniffer_Exception: Referenced sniff Generic.PHP does not exist in C:\Program Files (x86)\PHP\pear\PHP\CodeSniffer.php on line 845 
```

这是刚刚发布的版本 1.4.3 和 PHP 5.4.8。

我的 PHPCS -i 确实将 Generic 显示为已安装的标准：

```
The installed coding standards are ICAP, MySource, PEAR, PHPCS, PSR1, PSR2, Squiz and Zend. 
```

我在混合环境中工作，并试图尽可能避免使用路径，因为它们在 Windows 和 Ubuntu 12.10 之间有很大不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T21:33:36.527

PHP_CodeSniffer 不支持这种排除方法。ruleset.xml 文件的文档在这里：[https ://github.com/squizlabs/PHP_CodeSniffer/wiki/Annotated-ruleset.xml](https://github.com/squizlabs/PHP_CodeSniffer/wiki/Annotated-ruleset.xml)

总之，您只能排除特定的嗅探或特定的错误消息。

我注意到您也建议将此作为功能请求：[http ://pear.php.net/bugs/bug.php?id=19731](http://pear.php.net/bugs/bug.php?id=19731)

当我和妻子生下另一个孩子时，我将要进行长时间的休息，但我希望在新的一年回来时能够研究这种新型的排斥。

感谢您发布功能请求。

# multithreading - Groovy：找不到“子类”的匹配构造函数

> ID：13713502
> 
> 赞同：1
> 
> 时间：2012-12-04T22:59:09.457
> 
> 标签：multithreading, groovy, constructor, subclass

我收到以下错误：

> 找不到匹配的构造函数：org.crawler.CrawlerUtils$fetch(org.series.crawler.site.SubSiteA)。

我正在尝试使用线程。我只使用了一次线程，我正在尝试做与在另一个项目中所做的相同的事情。

我有：

```
Class CrawlerUtils {
    public static void crawlSites(List<Site> sites) {
        def pool = Executors.newFixedThreadPool(MAX_THREADS)
        def ecs = new ExecutorCompletionService<Void>(pool);
        sites.each { ecs.submit(new fetch(it), Void) }
        sites.each { ecs.take().get() }
        pool.shutdown()
    }

    class fetch implements Runnable {
        Site site
        fetch(Site site) {
            this.site = site
        }
        public void run() {
            site.parse()
        }
    }
} 
```

我尝试了这些（丑陋的）方法：

*   创建一个接口（使用*ISite 站点*而不是*fetch*构造函数中的*站点站点）*
**   *在fetch*类中的每个子类中放置一个构造函数*   *在调用super()*的每个子类中放置一个构造函数*

 **任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T23:08:26.547

作为`crawlSites`静态类`Fetch`（应该有一个大写字母以遵循任何形式的通用命名方案）也需要是静态的。

```
static class Fetch implements Runnable 
```

不过我会使用 GPars ......看看[指南的这一部分](http://www.gpars.org/guide/guide/3.%20Data%20Parallelism.html#3.1.1%20GParsPool)

你应该能够做到：

```
GParsPool.withPool {
  sites.eachParallel { site -> site.parse() }
} 
```**

# c - 使用 2 的补码从 int 转换为二进制字符串到 int

> ID：13713506
> 
> 赞同：-1
> 
> 时间：2012-12-04T22:59:28.147
> 
> 标签：c, binary, int, bit-manipulation, twos-complement

我知道有一个二进制字符串`10001110`正在使用 2 的补码。我知道它将是 8 位。

`unsigned int`它以等于 142的形式提供给我。

然后我需要将其转换回`10001110`

然后反转所有位并添加一个导致它等于`01110010`

然后将其转换为`signed int`等于 -114。

我怎样才能做到这一点？我对 C 语言比较陌生，并且花了很长时间试图弄清楚它！

本质上，我想编写一个接受`unsigned int`142 并返回`signed int`-114的函数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:07:42.460

您无需更改位模式。您只需要进行符号扩展以匹配已签名 int 结果的位长度。最简单的方法是检查输入的符号位，然后如果设置了位长度，则将 -1 向左筛选。

```
int toSignedInt(unsigned int value, int bitLength)
{
    int signedValue = value;
    if (value >> (bitLength - 1))
        signedValue |= -1 << bitLength;
    return signedValue;
} 
```

**解释**

在 8 位二进制补码中，无符号 142 和有符号 -114 的位模式相同。所以如果你的整数类型是 8 位，你只需要转换类型。但是，如果您有 32 位整数，但您想将它们视为 8 位二进制补码，那么您需要将左侧 24 位设置为 1，如果符号位是1.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:09:48.053

想想你可以用位运算符做什么。您可以像这样测试一个位是 1 还是 0：

```
int bit = value & 1; 
```

您还可以像这样移动 int 中的位：

```
val = val >> 1; 
```

要测试 int 中的第 i 位，您可以这样做：

```
int bit = (value >> i) & 1; 
```

因此，使用此信息，您可以将给定的整数转换为二进制并将其存储在一个 char 数组中（如果您向上计数，它将以相反的顺序排列！）然后根据您的喜好操作 char。希望这是一个足够大的提示，可以让您站起来并开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:25:06.600

你不能从给定的任何值中减去 256 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T03:55:21.303

伙计 - 你为什么关闭你原来的问题？？？？

*   [https://stackoverflow.com/questions/13713020/2s-complement-conversion-in-c/13713071#comment18835229_13713071](https://stackoverflow.com/questions/13713020/2s-complement-conversion-in-c/13713071#comment18835229_13713071)

我的回答和第一个一样：

*   整数是整数。无论是“签名”还是“未签名”；无论是“一个补码”还是“二进制补码” - 位总是相同的。

*   如果您想将有符号值“转换”为无符号值，C 转换通常是最好、最简单、最有效和最清晰的方法（下面的代码示例）。

*   绝大多数 CPU 架构都是二进制补码

*   如果出于某种原因，您想检查您的 CPU 架构是否是互补的，那么只需测试`-0 == +0`. 二进制补码没有“负零”（只有零）*。*一个补码可以。

PS：

> 问：本质上我想写一个函数，它接受无符号整数 142 并返回有符号整数 -114

A：

```
int silly_convert (int i)
{
  return (signed char)i;
} 
```

这与我在回复您的原始帖子时所建议的完全相同。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-05T14:55:31.947

这是我最终想出的解决方案。

```
#include <stdio.h>
#include <stdlib.h>

int getBit(int no, int bit) // get bit at certain position
{
    bit--;
    return (no & (1 << bit)) >> bit;
}

void complementNBits(int *no, int count) // invert certain number of bits
{
    int i;
    for(i=0; i<count; i++)
    {
        *no ^= 1 << i;
    };
}

int main() 
{
    unsigned int unsignedNo=142;

    int negative = 0;   
    signed int signedNo=0;

    // check if MSB is set to determine if negative

    if (getBit(unsignedNo, 8)) // if MSB is set
    {
        negative = 1;
        // invert these 8 bits and add 1\. the rest of the MSBs will already be 0
        complementNBits(&unsignedNo, 8);
        unsignedNo++;
    }

    signedNo = unsignedNo;
    if (negative)
    {
        signedNo = signedNo * -1;
    }

    printf("THE SIGNED INTEGER: %i\n", signedNo);

} 
```

感谢大家的帮助！

# codeigniter - 提交表单后不会加载codeigniter视图

> ID：13713509
> 
> 赞同：0
> 
> 时间：2012-12-04T23:00:05.823
> 
> 标签：codeigniter, twitter-bootstrap, codeigniter-2

我有一个奇怪的错误，除非我遗漏了什么：

我正在尝试使用[https://github.com/jackilyn/bootstrap-contact/](https://github.com/jackilyn/bootstrap-contact/)将引导联系表添加到我的 codeigniter 项目中。

表格提交如下：

```
<form method="post" action="index.php/my_controller/my_contact_form_handler" id="contactform"> 
```

在 my_controller 类中，我有：

```
public function contact_form_handler() 
{
     $this->load->view('sub_directory/contact_form');  
    // reload contact form it just came from
    echo 'hello';
    exit;
} 
```

输出是“你好”。为什么这个视图不会加载（PS 我也在同一个地方尝试过其他视图。它们也不会显示！）

提前致谢，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:16:39.823

删除`exit;`线。此时您的视图尚未呈现。

# spring-amqp - 事务回滚时在队列末尾重新排队消息

> ID：13713510
> 
> 赞同：2
> 
> 时间：2012-12-04T23:00:07.790
> 
> 标签：spring-amqp

我正在使用`SimpleMessageListenerContainer`. 该消息调用我的服务层上的方法，我故意抛出异常以测试事务的回滚。我希望将消息发送回队列的末尾，但它不会发生。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-20T20:52:21.037

确保已将 setChannelTransacted 设置为 true，并且在 SimpleMessageListenerContainer 上设置了 RabbitTransactionManager。如果您发布了配置，将会很有帮助。此外，在抛出异常时，请确保您没有抛出 AMQPRejectAndDontRequeueException，因为这明确告诉 spring-amqp 无论您的整体配置如何都不要重新排队。

```
@Bean
public SimpleMessageListenerContainer messageListenerContainer()
{
    SimpleMessageListenerContainer result = new SimpleMessageListenerContainer();
    result.setConnectionFactory(connectionFactory);
    result.setTransactionManager(rabbitTxManager);
    result.setChannelTransacted(true);
    result.setMessageListener(myMessageListener);
    result.setConcurrentConsumers(1);
    result.setQueues(myQueues);
    return result;
} 
```

# selenium - Selenium 与 Chromedriver：模仿 page_load_timeout

> ID：13713511
> 
> 赞同：1
> 
> 时间：2012-12-04T23:00:08.923
> 
> 标签：selenium, timeout, selenium-chromedriver, webpage-screenshot

尝试使用 Selenium webdriver 抓取网页，并使用 chromedriver 截取带有 flash 元素的页面。

不利的一面是，我抓取的页面可能会遇到永远不会加载的元素，因此脚本会等待 driver.get() 命令完成加载。以下不适用于 Chromedriver（我认为由于缺乏支持，根据 Selenium 问题跟踪器）

```
browser = webdriver.Chrome()
browser.set_page_load_timeout(15) 
```

但是，更改浏览器确实有效（但我需要将页面的内容放在 chrome 上才能截取带有 Flash 内容的页面）。

有什么方法可以模拟 set_page_load_timeout，或者忽略 get() 方法在继续之前完成加载所有内容的强烈愿望？

# php - SELECT COUNT(*) 是否适用于 MySQLi 准备好的语句？

> ID：13713512
> 
> 赞同：10
> 
> 时间：2012-12-04T23:00:21.483
> 
> 标签：php, mysqli, prepared-statement

我正在一个测试页面上工作，并且在阅读后在我的查询中使用 MySQLi 准备好的语句，它们使我的代码免受 SQL 注入的影响。到目前为止，我已经成功地使用准备好的语句从我的数据库中检索数据，这一切都很好。

我现在要做的是使用 SELECT COUNT(*) 计算项目中的画廊数量。而已。

在不使用准备好的语句的情况下，我的旧查询如下所示：

```
// count number of galleries per project
$conn = dbConnect('query');
$galNumb = "SELECT COUNT(*) FROM pj_galleries WHERE project = {$pjInfo['pj_id']}";
$gNumb = $conn->query($galNumb);
$row = $gNumb->fetch_row();
$galTotal = $row[0]; 
```

但是对于我所有的阅读和搜索互联网，我找不到将其写为准备好的陈述的正确方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-04T23:02:12.163

是的，它应该工作得很好。

但是，请记住，执行 a`COUNT(primary_key)`通常会提供更好的性能。

所以你上面的查询看起来像

```
// first, setup your DB-connection
$mysqli = new mysqli('example.com', 'user', '********', 'database');

// Preparing the statement
$stmt = $mysqli->prepare('SELECT COUNT(*) FROM pj_galleries WHERE project = ?');

// binding the parameters
$stmt->bind_param('i', $pjInfo['pj_id']); // 'i' signals an integer

// Executing the query
if ( ! $stmt->execute()) {
    trigger_error('The query execution failed; MySQL said ('.$stmt->errno.') '.$stmt->error, E_USER_ERROR);
}

// fetching the results
$col1 = null;
$stmt->bind_result($col1); // you can bind multiple colums in one function call
while ($stmt->fetch()) { // for this query, there will only be one row, but it makes for a more complete example
    echo "counted {$col1} records\n";
}

$stmt->close(); // explicitly closing your statements is good practice 
```

要获得更好和更完整的解释，请查看：[http](http://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php) ://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php （示例应该让您加快速度）。

另请记住，如果需要，您可以多次执行准备好的语句。您还可以在重新执行查询之前绑定新参数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-04T23:02:50.480

你可能想多了，因为它与任何其他准备好的语句没有什么不同：

```
$conn = new mysqli;
$sql = "SELECT COUNT(*) FROM pj_galleries WHERE project = ?";
$stmt = $conn->prepare($sql);
$stmt->bind_param('i', $pjInfo['pj_id']);
$stmt->execute();
$row = $stmt->get_result()->fetch_row();
$galTotal = $row[0]; 
```

# android - 如何在 SimpleCursorAdapter 中使用自定义字体作为可搜索字典应用程序的列表视图？

> ID：13713513
> 
> 赞同：1
> 
> 时间：2012-12-04T23:00:20.507
> 
> 标签：android, simplecursoradapter

我是安卓新手。这是我的第一个项目。我正在尝试用孟加拉语制作名称字典，所以我需要更改列表视图字体。我已经将字体添加到资产文件夹中..

```
 private void showResults(String query) {

    Cursor cursor = managedQuery(DictionaryProvider.CONTENT_URI, null, null,
                            new String[] {query}, null);

    if (cursor == null) {
        // There are no results
        mTextView.setText(getString(R.string.no_results, new Object[] {query}));
    } else {
        // Display the number of results
        int count = cursor.getCount();
        String countString = getResources().getQuantityString(R.plurals.search_results,count, new Object[] {count, query});
        mTextView.setText(countString);

        // Specify the columns we want to display in the result
        String[] from = new String[] { DictionaryDatabase.KEY_WORD,
                                       DictionaryDatabase.KEY_DEFINITION };

        // Specify the corresponding layout elements where we want the columns to go
        int[] to = new int[] { R.id.word,
                               R.id.definition };

        // Create a simple cursor adapter for the definitions and apply them to the ListView          

        SimpleCursorAdapter words = new SimpleCursorAdapter(this, R.layout.result, cursor, from, to);

        mListView.getAdapter();

        // Define the on-click listener for the list items
        mListView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                // Build the Intent used to open WordActivity with a specific word Uri
                Intent wordIntent = new Intent(getApplicationContext(), WordActivity.class);
                Uri data = Uri.withAppendedPath(DictionaryProvider.CONTENT_URI,
                                                String.valueOf(id));
                wordIntent.setData(data);
                startActivity(wordIntent);
            }
        });
    }     
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:57:34.590

```
public class myAdapter extends CursorAdapter {

public myAdapter(Context context, Cursor c) {
    super(context, c);
}

@Override
public void bindView(View view, Context context, Cursor cursor) {

   Typeface tf = Typeface.createFromAsset(context.getAssets(), "font/Rupali.ttf");
   TextView tv = (TextView)view.findViewById(R.id.definition);           
   String s = cursor.getString(cursor.getColumnIndex(DictionaryDatabase.KEY_DEFINITION));
   tv.setText(s);
   tv.setTypeface(tf);
   //Any other modifications you want 
 }
@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {
    LayoutInflater infl = LayoutInflater.from(context);
    View v = infl.inflate(R.layout.result, parent, false);
    bindView(v, context, cursor);
    return v;
} 
```

}

# php - 为什么 gmagick::thumbnailimage 比 exec(gm) 慢？

> ID：13713514
> 
> 赞同：4
> 
> 时间：2012-12-04T23:00:22.580
> 
> 标签：php, graphicsmagick, gmagick

在尝试简单地在 PHP 中对图像进行缩略图时，我使用了：

```
$image = new Gmagick('/tmp/large.jpg');
$image->thumbnailImage(0, 100);
$image->writeImage('/tmp/small.jpg'); 
```

它在大约 15 秒内运行。

然后我尝试了：

```
exec('gm convert -size 200x100 /tmp/large.jpg -resize 200x100 +profile "*" /tmp/small.jpg'); 
```

它在不到一秒钟的时间内运行。

有人可以尽可能详细地解释原因吗？另外，我“不应该”使用第二种方法有什么原因吗？或者有没有办法让 gmagick 扩展更快？

**版本详情：**

gmagick - 1.1.0RC3
GraphicsMagick - GraphicsMagick 1.3.17 2012-10-13 Q8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:50:22.260

I figured out that the '-size' option isn't part of the php thumbnailing method. Once I added it manually, the following php code actually ran slightly **faster** than the command line.

```
$image = new Gmagick();
$image->setSize(200,200);    // This sets the size of the canvas. Should be roughly twice the dimensions of the desired thumbnail for antialiasing to work well.
$image->readImage('/tmp/large.jpg');
$image->thumbnailImage(0, 100);
$image->writeImage('/tmp/small.jpg'); 
```

[This post](http://sourceforge.net/mailarchive/message.php?msg_id=24752385) helped quite a bit.

# ruby - Ruby 与 csv.open 如何添加更多行？

> ID：13713516
> 
> 赞同：0
> 
> 时间：2012-12-04T23:00:40.210
> 
> 标签：ruby, csv

我想要做的是在我的 sampleid 文本文档中获取我所有的产品 ID，并让我的脚本在每个创建具有该 ID 的产品 URL 中循环。我还希望将 id 和完整的 url 输出到一个 csv 文件中，但我下面的代码似乎只在我的文档中生成最后一个 id ......我假设它不会移动到下一行`each_line do`

```
#!/usr/bin/ruby
# ProductID script
puts "Enter current token"
auth_token = gets.chomp
File.open("sampleid.txt", "r").each_line do |line|
productNumber = line
  restcall = "mywebsite.com&token=" + auth_token + "&something.com/" + productNumber + ""
require 'csv'
CSV.open("/Users/Documents/scripts/ruby/rb_output.csv", "wb") do |csv|
  csv << ["Product ID", "Full Call"]
  csv << [productNumber, restcall]
end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:50:30.043

您正在为每一行重新打开文件，这意味着您正在为 .each_line 的每次迭代重写文件。尝试这个：

```
require 'csv'

puts "Enter current token"
auth_token = gets.chomp
CSV.open("/Users/Documents/scripts/ruby/rb_output.csv", "wb") do |csv|
    File.open("sampleid.txt", "r").each_line do |line|
        productNumber = line
        restcall = "mywebsite.com&token=" + auth_token + "&something.com/" + productNumber + ""

        csv << ["Product ID", "Full Call"]
        csv << [productNumber, restcall]
    end
end 
```

# d3.js - 如何禁用 d3.behavior.zoom 的平移？

> ID：13713528
> 
> 赞同：29
> 
> 时间：2012-12-04T23:01:20.257
> 
> 标签：d3.js

[这个问题看起来与这个](https://stackoverflow.com/questions/11786023/how-to-disable-double-click-zoom-for-d3-behavior-zoom)问题非常相似，但我仍然无法弄清楚是否可以使用 d3.behavior.zoom 但没有平移功能。换句话说，我只想使用滚轮放大/缩小。

这样做的原因是我希望能够在“可缩放”区域上刷。

谢谢！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-11T16:59:23.507

假设您已经定义了缩放行为：

```
var zoom = d3.behavior.zoom().on('zoom', update); 
```

当您将缩放行为应用于选择时，您可以取消注册它在内部用于检测和响应某些交互的事件侦听器。在你的情况下，你想做这样的事情：

```
selection.call(zoom)
    .on("mousedown.zoom", null)
    .on("touchstart.zoom", null)
    .on("touchmove.zoom", null)
    .on("touchend.zoom", null); 
```

我不确定您是否要删除触摸事件。这样做可能会消除双击缩放。你应该尝试这些。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T01:11:12.610

我想分享我发现的解决此问题的解决方法会很好。我所做的是在画笔开始时使用监听器来“停用”缩放：

```
zoom.on("zoom",null);
selection.call(zoom); 
```

*并在刷端*事件中再次激活它。

还有一个技巧需要考虑，它来自于保存最后一次有效缩放交互的*比例*和*过渡*值很重要的事实，以便您在像这样在*brushend*事件上激活画笔时使用这些值

```
zoom.scale(lastEventScale).translate(lastEventTranslate).on("zoom",drawZoom);
selection.call(scatterZoom); 
```

我很想听到这个问题的其他更“优雅”的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-26T15:34:38.443

我发现的一种解决方案是在启用缩放的元素（它们必须是同级元素）前面粘贴一个矩形元素，并将其填充设置为“透明”，当我想禁用缩放交互或设置为“无”时，当我想要启用缩放交互。它看起来像这样：

```
if (chart._disableZoom) {
    var rootPanel = d3.select('.rootPanel'); // this is the parent of the element that can be zoomed and panned
    if (!rootPanel.select('.stopEventPanel').node()) { // create panel if it doesn't exist yet
       //.stopEventPanel is appended next to the zoom-enabled element
        rootPanel.append('rect').attr('class', 'stopEventPanel').attr('width', renderConfig.width).attr('height', renderConfig.height).attr('fill', 'transparent');
    } else { // disable zoom and pan
        rootPanel.select('.stopEventPanel').attr('fill', 'transparent');
    }
} else { // enable zoom and pan
    d3.select('.rootPanel').select('.stopEventPanel').attr('fill', 'none');
} 
```

# php - PHP 和 XPath 循环

> ID：13713531
> 
> 赞同：2
> 
> 时间：2012-12-04T23:01:28.037
> 
> 标签：php, soap, xpath, namespaces, xml-namespaces

谢谢大家。对于我有时愚蠢的问题，我得到了一些很好的答案，所以再次感谢你。

我正在尝试使用 PHP、Xpath（命名空间）和 SimpleXML 解析 SOAP 响应。下面是响应的片段。我需要做的是遍历每个`<ns1:file></ns1:file>`并将其添加到数据库中。但我不知道该怎么做。请帮忙！

**命名空间的东西**

```
 $x = simplexml_load_string($response);    
                $x->registerXPathNamespace('ns1', 'http://ws.icontent.idefense.com/V3/2'); 
```

**这是回应：**

```
 <ns1:mal_files>
              <ns1:file>
                 <ns1:id>2895144</ns1:id>
                 <ns1:md5>2189c3d3857ba0cabd19c8aa031d63cd</ns1:md5>
                 <ns1:sha1>c20b26148caa059ecf85e9b29df4e28e8354d655</ns1:sha1>
                 <ns1:path>%WINDIR%\Temp\Temporary Internet Files\Content.IE5\K9ANOPQB\1219831[1].htm</ns1:path>
                 <ns1:size>110</ns1:size>
                 <ns1:code_available>true</ns1:code_available>
                 <ns1:len_char>fixed</ns1:len_char>
              </ns1:file>
              <ns1:file>
                 <ns1:id>2895147</ns1:id>
                 <ns1:md5>a533825ef1752630a300125b3eef6825</ns1:md5>
                 <ns1:sha1>ec7feb1414b3c2e720f6c06e2750421b73634f87</ns1:sha1>
                 <ns1:path>%WINDIR%\Temp\Temporary Internet Files\Content.IE5\4PMB8T67\bg[1].jpg</ns1:path>
                 <ns1:size>707</ns1:size>
                 <ns1:code_available>true</ns1:code_available>
                 <ns1:len_char>fixed</ns1:len_char>
              </ns1:file>
              <ns1:file>
                 <ns1:id>2895155</ns1:id>
                 <ns1:md5>c88724e985efcc82173c0d3aa0b77dfd</ns1:md5>
                 <ns1:sha1>ecc042ca06aac988cd4593bb2b25fa39c4b2a819</ns1:sha1>
                 <ns1:path>%WINDIR%\Prefetch\24604775.EXE-3ADEC0C2.pf</ns1:path>
                 <ns1:size>44940</ns1:size>
                 <ns1:code_available>true</ns1:code_available>
                 <ns1:len_char>fixed</ns1:len_char>
              </ns1:file>
              <ns1:file>
                 <ns1:id>2895158</ns1:id>
                 <ns1:md5>422a011793af6195ea517c2c4a26bdbc</ns1:md5>
                 <ns1:sha1>f449240c091c27e2531342d6b291d6a7e4655834</ns1:sha1>
                 <ns1:path>%WINDIR%\Temp\Temporary Internet Files\Content.IE5\KPYV0TM7\gamesleap[1].png</ns1:path>
                 <ns1:size>2676</ns1:size>
                 <ns1:code_available>true</ns1:code_available>
                 <ns1:len_char>fixed</ns1:len_char>
              </ns1:file>
         </ns1:mal_files> 
```

**PHP 代码**

```
$md5 = $x->xpath('//ns1:mal_files/ns1:file/ns1:md5'); // Returns array :( 
```

PHP 代码为每个返回一个包含所有 MD5 的数组，`<ns1:file></ns1:file>`这不是我需要的。

我需要的是循环遍历每个（节点？）上的每个`<ns1:file>`键，`<ns1:id>`并将其所有关联元素（id、md5、sha1 等）添加为记录，然后移至下一个`<ns1:file>`并重复。很明显，我使用的 PHP 返回一个数组，在这里不起作用。

希望我已经把我的问题说清楚了......我很感激任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:14:10.610

您应该选择所有`ns1:file`元素并遍历它们，在循环中检索您需要的每个值：

```
foreach($x->xpath('//ns1:mal_files/ns1:file) as $file) {
   $id = $file->xpath('ns1:id')[0];
   $md5 = $file->xpath('ns1:md5')[0];
    // etc.
} 
```

# ruby-on-rails - Ruby on Rails 数据表不工作

> ID：13713533
> 
> 赞同：-1
> 
> 时间：2012-12-04T23:01:47.483
> 
> 标签：ruby-on-rails, ruby, datatable

[DataTable Ruby on Rails 指南](https://github.com/phronos/rails_datatables/blob/master/README.md)

我正在遵循上述内容，并通过运行安装了 git 插件

```
rails plugin install https://github.com/phronos/rails_datatables.git 
```

我只是想在我的 Rails 页面上获得一些漂亮的表格。如果有更简单的方法可以在不使用插件的情况下实现这一点，请告诉我。

我得到的只是 <%= datatable() %> 在我的页面上输出此文本

```
`<script type="text/javascript"> $(function() { $('#expenses').dataTable({ "oLanguage": { "sSearch": "Search", "sProcessing": 'Processing' }, "sPaginationType": "full_numbers", "iDisplayLength": 25, "bProcessing": true, "bServerSide": false, "bLengthChange": false, "bStateSave": true, "bFilter": true, "bAutoWidth": true, 'aaSorting': [[0, 'desc']], "aoColumns": [ { 'sType': 'html', 'bSortable':true, 'bSearchable':true ,'sClass':'first' },{ 'sType': 'html', 'bSortable':true, 'bSearchable':true },{ 'sType': 'html', 'bSortable':true, 'bSearchable':true },{ 'sType': 'string', 'bSortable':true, 'bSearchable':true ,'sClass':'last' } ], "fnServerData": function ( sSource, aoData, fnCallback ) { aoData.push( ); $.getJSON( sSource, aoData, function (json) { fnCallback(json); } ); } }); }); </script>"`. 
```

我的 .html.erb 看起来像这样：

```
<% @page_title="User Page"%> 

   <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
     <%=javascript_include_tag "jquery.dataTables" %>
     <%=stylesheet_link_tag "jquery-ui-1.9.2.custom" %>

    <script>
    $(function() {
        $( "#tabs" ).tabs();
    });
    </script>

<% if current_user %>
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Expenses</a></li>
        <li><a href="#tabs-2">Accountant</a></li>
        <li><a href="#tabs-3">Requests (<%=@requests.count%>)</a></li>    
    </ul>
     <div id="tabs-3">
       <p>
        <% if @requests.count != 0 %>
        <h2> Accountant Requests </h2>

        <table >
          <tr>
              <thead>

            <th>First Name</th>
            <th>Last Name</th>
            <th>Email Address</th>
            <th>Accept</th>
            <th>Reject</th>
                </thead>
          </tr>

          <% @requests.each do |request| %>
            <tr>
            <td><%= request.accountant.first_name %></td>
            <td><%= request.accountant.last_name %></td>
            <td><%= request.accountant.email %></td>
            <td><%= link_to 'accept', confirm_accountant_path(:accountant_id => request.accountant_id) %></td>
            <td><%= link_to 'Edit', edit_expense_path(request) %></td>      
            </tr>
          <% end %>
        </tbody>
        </table>
        <% else %>
            <h4> You have no pending requests <h4>
        <% end %>
        </p>
    </div>
    <div id="tabs-2">
       <p>
        <% if @accountants.count != 0 %>
        <h2> Accountant Info </h2>

        <table>
          <tr>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Email Address</th>
          </tr>
          <% @accountants.each do |accountant| %>
            <tr>
            <td><%= accountant.first_name %></td>
            <td><%= accountant.last_name %></td>
            <td><%= accountant.email %></td>        
            </tr>
          <% end %>
        </table>
        <% else %>
            <h4> Add Accountant  <h4>
            <p> You don't have an accountant yet, perhaps consider adding one by e-mail </p>
            <%= render 'add_accountant_form' %>
            <% end %>
        <% end %>
        </p>
    </div>
    <div id="tabs-1">
        <p><% if current_user %>
    <h4> Submit new expense </h4>
    <%= render 'expenses/form' %>
     <% columns = [{:type => 'html', :class => "first"}, {:type => 'html'}, 
    {:type => 'html'}, {:type => nil, :class => "last"}] %>
<%= datatable(columns, {:sort_by => "[0, 'desc']", table_dom_id:"expenses" }) %>
    <table id="expenses" class="datatable">
        <thead>
      <tr>
        <th>Entry Date</th>
        <th>Last Update</th>
        <th>Amount</th>
        <th>User</th>
        <th>Receipt</th>
        <th></th>
        <th></th>
      </tr>
        </thead>
        <% @expenses.each do |user_expense| %>

<tbody>
      <tr>
        <td><%= user_expense.created_at %></td>
        <td><%= user_expense.updated_at %></td>
        <td><%= user_expense.amount %></td>
        <td><%= user_expense.user.username %></td>
            <% if !user_expense.receipt_img.nil? %>
                <td><%= image_tag user_expense.receipt_img.url(:thumb) %></td>
            <% else %>
                <td>Future Button Here</td>
            <% end %>
        <td><%= link_to 'Show', user_expense %></td>
        <td><%= link_to 'Edit', edit_expense_path(user_expense) %></td>
      </tr>
     </tbody>
        <% end %>
    </table>
<% end %></p>
    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:31:39.577

我找到了一个更简单的选择：[Rails: Spice Up Your Tables with DataTables](http://www.jacoulter.com/2012/01/03/rails-spice-up-your-tables-with-datatables/)

效果很好，我要卸载没用的插件。

这是我更新的 html.erb：

```
<% @page_title="User Page"%> 

   <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
 <%=javascript_include_tag "jquery.dataTables"%>
     <%=stylesheet_link_tag "jquery-ui-1.9.2.custom"%>
      <%=stylesheet_link_tag "demo_table"%>

    <script>
    $(function() {
        $( "#tabs" ).tabs();
    });
    $(document).ready(function() {
    $('#expenses').dataTable();
  } );
    </script>

<% if current_user %>
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Expenses</a></li>
        <li><a href="#tabs-2">Accountant</a></li>
        <li><a href="#tabs-3">Requests (<%=@requests.count%>)</a></li>    
    </ul>
     <div id="tabs-3">
       <p>
        <% if @requests.count != 0 %>
        <h2> Accountant Requests </h2>

        <table >
          <tr>
              <thead>

            <th>First Name</th>
            <th>Last Name</th>
            <th>Email Address</th>
            <th>Accept</th>
            <th>Reject</th>
                </thead>
          </tr>

          <% @requests.each do |request| %>
            <tr>
            <td><%= request.accountant.first_name %></td>
            <td><%= request.accountant.last_name %></td>
            <td><%= request.accountant.email %></td>
            <td><%= link_to 'accept', confirm_accountant_path(:accountant_id => request.accountant_id) %></td>
            <td><%= link_to 'Edit', edit_expense_path(request) %></td>      
            </tr>
          <% end %>
        </tbody>
        </table>
        <% else %>
            <h4> You have no pending requests <h4>
        <% end %>
        </p>
    </div>
    <div id="tabs-2">
       <p>
        <% if @accountants.count != 0 %>
        <h2> Accountant Info </h2>

        <table>
          <tr>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Email Address</th>
          </tr>
          <% @accountants.each do |accountant| %>
            <tr>
            <td><%= accountant.first_name %></td>
            <td><%= accountant.last_name %></td>
            <td><%= accountant.email %></td>        
            </tr>
          <% end %>
        </table>
        <% else %>
            <h4> Add Accountant  <h4>
            <p> You don't have an accountant yet, perhaps consider adding one by e-mail </p>
            <%= render 'add_accountant_form' %>
            <% end %>
        <% end %>
        </p>
    </div>
    <div id="tabs-1">
        <p><% if current_user %>
    <h4> Submit new expense </h4>
    <%= render 'expenses/form' %>
    <table id="expenses" class="display">
        <thead>
      <tr>
        <th>Entry Date</th>
        <th>Last Update</th>
        <th>Amount</th>
        <th>User</th>
        <th>Receipt</th>
        <th></th>
        <th></th>
      </tr>
        </thead>

            <tbody>
        <% @expenses.each do |user_expense| %>

      <tr>
        <td><%= user_expense.created_at %></td>
        <td><%= user_expense.updated_at %></td>
        <td><%= user_expense.amount %></td>
        <td><%= user_expense.user.username %></td>
            <% if !user_expense.receipt_img.nil? %>
                <td><%= image_tag user_expense.receipt_img.url(:thumb) %></td>
            <% else %>
                <td>Future Button Here</td>
            <% end %>
        <td><%= link_to 'Show', user_expense %></td>
        <td><%= link_to 'Edit', edit_expense_path(user_expense) %></td>
      </tr>

        <% end %>
    </tbody>
    </table>
<% end %></p>
    </div>

</div> 
```

# android - Google Play 仅分发到手机

> ID：13713547
> 
> 赞同：0
> 
> 时间：2012-12-04T23:03:02.633
> 
> 标签：android, android-manifest, google-play

我阅读了[分发到特定屏幕](http://developer.android.com/guide/practices/screens-distribution.html)的指南，我都尝试了

```
<compatible-screens
   android:smallScreens="false"
   android:normalScreens="false" 
   android:largeScreens="true"
   android:xlargeScreens="true"/> 
```

和

```
<supports-screens
   android:smallScreens="false"
   android:normalScreens="false" 
   android:largeScreens="true"
   android:xlargeScreens="true"/> 
```

甚至结合起来（知道......我知道......：D）

但我似乎无法限制我的应用程序出现在我的平板电脑的搜索中（当然它也会安装）

反向设置虽然有效..

```
<supports-screens
   android:smallScreens="false"
   android:normalScreens="false" 
   android:largeScreens="true"
   android:xlargeScreens="true"/> 
```

我的手机似乎与 APK 的平板电脑版本不兼容。是什么赋予了？有什么我没有妨碍使用清单的谷歌播放过滤器的方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:11:11.457

您应该使用此语法进行过滤，允许仅分发到手机（如果您想为平板电脑制作版本，您可以推断并为 large 和 xlarge 制作相同的版本）。

```
<compatible-screens>
    <!-- all small size screens -->
    <screen android:screenSize="small" android:screenDensity="ldpi" />
    <screen android:screenSize="small" android:screenDensity="mdpi" />
    <screen android:screenSize="small" android:screenDensity="hdpi" />
    <screen android:screenSize="small" android:screenDensity="xhdpi" />
    <!-- all normal size screens -->
    <screen android:screenSize="normal" android:screenDensity="ldpi" />
    <screen android:screenSize="normal" android:screenDensity="mdpi" />
    <screen android:screenSize="normal" android:screenDensity="hdpi" />
    <screen android:screenSize="normal" android:screenDensity="xhdpi" />
</compatible-screens> 
```

# .net - TrackBar：表单上的tickbar当前（x，y）位置

> ID：13713550
> 
> 赞同：1
> 
> 时间：2012-12-04T23:03:09.327
> 
> 标签：.net, winforms

是否可以在引用控件中获取刻度条（点）的当前位置？

我的意思是：|----[tic​​kbar]-----------------|

编辑：

好的。我想到了。这只是简单的数学。我只需要测试偏移量，尤其是左边。

```
var value = trackBar1.Value;
var width = trackBar1.Width - 26; //Real width without margins. 26 = right and left offset
var locationX = trackBar1.Location.X + 13; //Real X location. 13 is left offset.
var maxValue = trackBar1.Maximum;
var delta = (double)width / (double)maxValue;

var tickBarLocationX = (int)(locationX + (delta * value)); 
```

我可以用 Y 位置做同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-10T18:41:00.027

在开发 WinForms 实现时，[Mono 项目](http://www.mono-project.com)必须经历很多痛苦才能弄清楚所有这些细节。通过查看他们的代码，您可以得到这个问题以及许多其他问题的答案。

您的具体问题在[ThemeWin32Classic.cs](https://github.com/mono/mono/blob/master/mcs/class/Managed.Windows.Forms/System.Windows.Forms/ThemeWin32Classic.cs)中的 GetTrackBarDrawingInfo() 方法中得到解答。

# requirejs - 将 appDir 条目添加到 requirejs 优化器构建文件结果错误

> ID：13713551
> 
> 赞同：1
> 
> 时间：2012-12-04T23:03:12.413
> 
> 标签：requirejs

当我在构建文件中添加 appDir 条目时，出现以下错误。

```
C:\Users\Thupten\Development\experiments>node r.js -o build.js 
```

```
    TypeError：无法读取未定义的属性“长度”
        在 Function.build.makeAbsPath (C:\Users\Thupten\Development\experiments\r.js:22452:51)

```

这是我的构建文件

```
({
    appDir:"./SimpleRequireJsProject",
    baseUrl: "scripts",
    mainConfigFile: './SimpleRequireJsProject/scripts/main.js',
    include:'entrance.js',  //relative to baseUrl
    name:"main",
    out:"main-built.js",
    optimize:"none"
    }) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:14:28.770

解决了，`appDir`选项与选项不兼容`out`，改用`dir`选项。例如：

```
({
  appDir: '.',
  baseUrl: 'lib',
  dir: '../demo-build'
}) 
```

# jquery - jQuery 错误：xxx 不是函数

> ID：13713552
> 
> 赞同：0
> 
> 时间：2012-12-04T23:03:13.153
> 
> 标签：jquery

这一直让我发疯。我不断收到**“TypeError：$(".yoxview").yoxview 不是函数”。**

任何线索我的格式或逻辑有什么问题？

```
<script type="text/javascript">
        $(document).ready(function () {
            $('.yoxview').yoxview({
                skin: "top_menu",
                dataUrl: "http://www.youtube.com/results?search_query=decemberists&aq=f",
                thumbnailsOptions: {
                    setTitles: true,
                    thumbnailsClass: "thumbnail"
                }
            });
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T00:48:29.303

当您调用它时，很可能`.yoxview`插件没有正确加载。

确保在尝试调用它*之前*包含适当的脚本，例如：

```
<script src="yoxview.js"></script>
<script>
   $("#elem").yoxview();
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:19:19.627

您是否在代码中使用任何其他库，即。原型？如果是这样，“$”将发生冲突。做。

```
 jQuery(document).ready(function ($) {
        $('.yoxview').yoxview({
            skin: "top_menu",
            dataUrl: "http://www.youtube.com/results?search_query=decemberists&aq=f",
            thumbnailsOptions: {
                setTitles: true,
                thumbnailsClass: "thumbnail"
            }
        });
    }); 
```

此外，不要使用 '.yoxview' 尝试为同一元素分配 ID 并使用：

```
$('#yournewID').yoxview 
```

# java - 关于文件解析java

> ID：13713553
> 
> 赞同：-1
> 
> 时间：2012-12-04T23:03:25.657
> 
> 标签：java, string

我有一个需要解析的文件。虽然问题很简单，但我没有取得任何进展。问题如下。该文件包含大约 20-22 行的数据块，然后是未知数量的空白行，然后是 20-22 行的块。我需要为这些数据块制作数据结构。我试过以下

```
File f1 = new File(PATH_TO_TRAINING_FILE);
FileInputStream fis1 = new FileInputStream(f1);
readerTrainingFile = new BufferedReader(new InputStreamReader(fis1));
String trainLine;
while (( trainLine =readerTrainingFile.readLine()) != null) {
    ArrayList<String> train = new ArrayList<String>();
    while (!trainLine.trim().equals("")) {
        train.add(trainLine);
        trainLine =readerTrainingFile.readLine();
    }
    while (readerTrainingFile.readLine().trim().equals("")) {
    }
} 
```

所以上面代码的问题是在第三个while循环中，当我完成对空行的检查时，读取行的指针移动到下一个块的第一个非空格行。因此，当我的控件到达第一个 while 循环时，它会跳过我想要的两行数据。如果这个问题真的很简单，我真的很抱歉。我现在坚持了2天。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:06:06.027

重构它，使该行在`readerTrainingFile.readLine()`您的程序中只出现一次。嵌套的 while 循环是让自己的生活变得悲惨的好方法。`continue`如果您需要跳过行，请使用语句。对于调试，`System.out.println(trainLine)`查看您正在阅读的内容并可能每次都跳过。这些步骤应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:20:24.457

考虑这样的事情

```
List<List<String>> trains = new ArrayList<List<String>>();
List<String> curTrain = null;
while (( trainLine=readerTrainingFile.readLine()) != null) {
    if (!trainLine.trim().equals(""))
        curTrain = null;
    else 
    {
        if (curTrain == null)
        {
            curTrain = new ArrayList<String>();
            trains.add(curTrain);
        }
        curTrain.add(trainLine)
    }
} 
```

`trains`是一个包含所有块的列表。读取数据时，`curTrain`指的是当前正在添加行的块。每次你得到一个非空行时，你将它添加到当前块中，但是如果没有当前块（因为你在开始，或者一个或多个之前的行是空白的）你创建一个新的并且将其添加到块列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:24:32.867

```
Scanner scanner = new Scanner(f1);
ArrayList<String> train = new ArrayList<String>();
while(scanner.hasNextLine()){
    String temp = scanner.nextLine();
    if(!temp.trim().equals(""))
        train.add(temp);
} 
```

您可以用等效的缓冲阅读器替换scanner.hasNextLine

```
(temp = reader.nextLine()) != null 
```

但是 Scanner 更易于使用 + 理解。您正在从第一个 while 循环中添加字符串，因此 arraylist 是本地的，并且在循环完成后不会持续存在（reader.nextLine() == null）。

请注意，您在同一类型上使用 != 和 !.equals() 。这对字符串很好，但通常 .equals 用于对象， == 用于基元（java 将字符串视为对象和基元之间的某处）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T23:26:38.253

我不知道那些“块”代表什么，但我会首先想象比字符串列表更好的抽象。

这是您可以解决的一种方法：

```
package cruft;

import org.apache.commons.io.IOUtils;
import org.apache.commons.lang3.StringUtils;

import java.io.*;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.TreeMap;

/**
 * FileChunkParser description here
 * @author Michael
 * @link
 * @since 12/4/12 6:06 PM
 */
public class FileChunkParser {

    public static void main(String[] args) {
        try {
            File f = new File((args.length > 0) ? args[0] : "resources/chunk.txt");
            Reader reader = new FileReader(f);
            FileChunkParser parser = new FileChunkParser();
            Map<Integer, List<String>> chunks = parser.parse(reader);
            for (int index : chunks.keySet()) {
                System.out.println(String.format("index: %d chunk: %s", index, chunks.get(index)));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public Map<Integer, List<String>> parse(Reader reader) throws IOException {
        Map<Integer, List<String>> chunks = new TreeMap<Integer, List<String>>();
        BufferedReader br = null;
        try {
            if (reader != null) {
                br = new BufferedReader(reader);
                int chunkCount = 0;
                String line = "";
                List<String> chunk = null;
                while ((line = br.readLine()) != null) {
                    if (StringUtils.isBlank(line)) {
                        if (chunk != null) {
                            chunks.put(chunkCount++, new LinkedList<String>(chunk));
                            chunk = null;
                        }
                        continue;
                    } else {
                        if (chunk == null) {
                            chunk = new LinkedList<String>();
                        }
                        chunk.add(line);
                    }
                }
                if (chunk != null) {
                    chunks.put(chunkCount++, chunk);
                }
            }
        } finally {
            IOUtils.closeQuietly(reader);
        }
        return chunks;
    }
} 
```

我用这个输入文件运行它：

```
this
is
how
you
do
it

see
how
it
handles
arbitrary
sized
chunks
with
any
blank
lines
between

try
it
and
see 
```

这是输出：

```
index: 0 chunk: [this, is, how, you, do, it]
index: 1 chunk: [see, how, it, handles, arbitrary, sized, chunks, with, any, blank, lines, between]
index: 2 chunk: [try, it, and, see] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T23:08:22.683

```
while (( trainLine =readerTrainingFile.readLine()) != null) {
            ArrayList<String> train = new ArrayList<String>();
            while (!trainLine.trim().equals("")) {
                train.add(trainLine);
                trainLine =readerTrainingFile.readLine();
            }
            while (readerTrainingFile.readLine().trim().equals("")) {

            }
 } 
```

那是你的问题。你读了两遍。只需将此代码放在第一个`while`循环中：

```
if (trainLine.trim().equals("")) {
    train.add(trainLine);
} 
```

另外，另一个问题：移动这个：

```
ArrayList<String> train = new ArrayList<String>(); 
```

跳出循环。否则每次阅读一行时都会创建一个新的。

# scala - Scala：访问伴生对象特征的受保护字段

> ID：13713557
> 
> 赞同：5
> 
> 时间：2012-12-04T23:03:40.870
> 
> 标签：scala

我在 Scala 中有一个特征、一个伴侣对象和一个类：

```
trait A {
    protected var foo = "Foo"
}

object B extends A {
}

class B {
     println(B.foo)
} 
```

为什么我无法访问 foo？我认为 foo 会成为对象“B”的一个字段。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T01:41:33.903

该规范说您可以从以下位置访问受保护的成员：

> 任何这些类的伴随模块[以定义模板为基础]。

也就是说，不是来自以定义模板为基础的对象的伴随类。棘手。

由于“模块”命名法，这并不明显，其中模块仅表示对象。偶尔有人谈论改变这一点。虽然类和模块可以是伙伴关系，但关系不是对称的；考虑隐式搜索。

```
trait A {
  protected var foo = "Foo"
  protected def bar = "Bar"
}

object B extends A {
  //override protected var foo = super.foo // no
  override protected def bar = super.bar
}

class B {
  //println(B.foo) // no
  println(B.bar) // ok
}

class C extends A

object C {
  println(new C().foo)  // ok
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T23:12:14.017

Scala 默认使用公共字段。它也有私有和受保护的。私有修饰符的工作方式与 Java 相同，但受保护的工作方式截然不同。

第一个区别是 protected 可以有两种形式：`protected`和`protected[bar]`. where`bar`可以是类、包或对象。

来自[Scala 语言规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)：

> 仅当满足以下条件之一时，受保护的标识符 x 才可以用作选择 r.x 中的成员名称：
> 
> – 访问在定义成员的模板内，或者，如果给定了限定 C，则在包 C、类 C、或它的伴随模块内，或
> 
> – r 是 this 和 super 的保留字之一，或者
> 
> – r 的类型符合包含访问权限的类的类型实例。

换句话说，**非参数化的受保护字段仅对来自同一个包的子类不可见**。

# ruby - 在 pry 中导航多行命令历史记录的奇怪错误

> ID：13713559
> 
> 赞同：5
> 
> 时间：2012-12-04T23:03:56.787
> 
> 标签：ruby, pry

当我在一个 pry 或常规 irb 控制台中输入一个对于控制台宽度来说太长的字符串时，它会像往常一样包装，见下文（在 OS X 10.8.2 terminal.app 中使用 pry）：

![撬 - 进入确定](../Images/5c081c2d1aa90e4a8bf58ff36f131d2e.png)

但是，当我尝试使用向上箭头重播命令时，我得到了这个： ![在此处输入图像描述](../Images/f08d930e50570941eb61163f94720231.png) Pry 切断了一些命令并重复提示。另一方面， Irb 表现得很好，甚至在需要时向上滚动缓冲区： ![irb - 好的重播](../Images/01f304ba3e5fb3db7defd6e675181f02.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T03:05:12.547

Kyrylo：如果你在 master 分支中修复了这个问题`Pry.auto_resize!`

但这里的问题是（正如 ryanf 在 Freenode #pry 上指出的那样），提示中有颜色转义。

`\e[XXn`不占用空格，但算作 5 个字节，所以 Readline 会混淆。

有谁知道没有这个问题的任何 Ruby 使用 Readline？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T02:00:18.873

输入第一个表达式后，您似乎调整了终端窗口的大小。目前，Pry 并没有真正考虑到这个事件，而是将窗口大小视为一个常数值。不幸的是，唯一的解决方案是每次需要调整窗口大小时重新启动 Pry。这是一个错误，迟早会被修复。

# c# - C# - 从不同的类调用函数

> ID：13713560
> 
> 赞同：0
> 
> 时间：2012-12-04T23:03:59.283
> 
> 标签：c#, silverlight, windows-phone-7, events, static

我有 4 节课

评论类：

```
public class comment
    {
        public string Username { get; set; }
        public string Comment { get; set; }

        public comment(string _username, string _comment)
        {
            this.Username = _username;
            this.Comment = _comment;
        } 
    } 
```

针类：

```
 public class Pin : PhoneApplicationPage

        public List<comment> Comment_List;        

    public Pin(){

        this.Comment_List = new List<comment>();
    }
} 
```

留言页面：

```
public partial class MessagePage : PhoneApplicationPage
{
   Pin _Pin;

   public MessagePage(Pin _pin)
 {        
    this._Pin = _pin;
 }

 public void Refresh()
 {
   this.textbox1.Text = "";
   foreach (comment c in this._Pin.List)
   {
    this.textbox1.Text += c.Username;
   }

  }

public void function()
{
     //Call static function in another class to download new pin info
} 
```

然后静态函数更新一个名为 PinList() 的静态类。

当其静态引脚列表更新时，我在 PinList() 类中触发了一个事件，如何解决当前 MessagePage 的对象以调用函数以使用 Pin.comments 中的新值更新文本框。

即我有：

```
public class PinList
    {
        public ObservableCollection<Pin> list;
        public static ObservableCollection<Pin> MainPinList = new ObservableCollection<Pin>();
        public event PropertyChangingEventHandler PropertyChanged;

public PinList()
        {
            list = new ObservableCollection<Pin>();
            list.CollectionChanged += listChanged;            

            ((INotifyPropertyChanged)list).PropertyChanged += new PropertyChangedEventHandler(list_Property_Changed);

        }

    private void list_Property_Changed(object sender, PropertyChangedEventArgs args)
            {
                  //Need to call
                  //MessagePage.Refresh();
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:26:36.007

从您获得的代码和您的措辞方式来看，听起来您正在尝试`MessagePage`静态访问，就好像它是一个单例一样，但那里没有一个静态属性。如果你死心塌地这样做，你需要声明一个`MessagePage`.

但是，我建议您简单地绑定`ItemsControl`某种类型的`Pin.Comment_List`an以对 看起来你正在做的是试图重新发明轮子。`ObservableCollection<comment>``List<comment>``INotifyPropertyChanged`

**编辑：根据您的评论**

```
public class Comment : INotifyPropertyChanged
{
    private string username;
    private string comment;

    public comment(string _username, string _comment)
    {
        this.Username = _username;
        this.Comment = _comment;
    }                 

    public string Username
    {
        get
        {
            return username;
        }

        set
        {
            if(value != username)
            {
                username = value;
                NotifyPropertyChanged("Username");
            }
        }
    }                   

    public string Comment
    {
        get
        {
            return comment;
        }

        set
        {
            if(value != comment)
            {
                comment= value;
                NotifyPropertyChanged("Comment");
            }
        }
    }       

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

针类：

```
public class Pin
{
    private readonly ObservableCollection<Comment> commentList = new ObservableCollection<Comment>();        

    public ObservableCollection<Comment> CommentList
    {
        get
        {
            return commentList;
        }
    }
} 
```

留言页面：

```
public partial class MessagePage : PhoneApplicationPage
{
    private readonly Pin pin;

    public MessagePage(Pin _pin)
    {        
        this.pin = _pin;
    }

    public Pin Pin
    {
        get
        {
            return pin;
        }
    } 
```

还有你的数据源

```
public class PinList
{
    public ObservableCollection<Pin> list;
    public static ObservableCollection<Pin> MainPinList = new ObservableCollection<Pin>();

    public void Refresh()
    {
         // Here you update the comments list of each of your Pins - The comment
         //     list is an ObservableCollection so your display will automatically
         //     update itself. If you have to change an existing comment due to
         //     an edit or something that will automatically update as well since
         //     we've implemented INotifyPropertyChanged
    }
} 
```

只要您`INotifyPropertyChanged`在评论上实现并将 Comment_List 更改为`ObservableCollection<comment>`. 为了更新消息，您需要做的就是将任何新消息添加到该 pin 的 Comments_List 中，UI 将做出反应，而无需您在单例中执行任何操作或订阅一堆事件。

```
<ItemsControl DataContext={Binding Pin} ItemsSource="{Binding CommentList}"">
  <ItemsControl.ItemTemplate>
    <DataTemplate>
      <StackPanel Margin="0 0 0 10">
        <TextBlock Text="{Binding Username, StringFormat='{0} said:'}" FontWeight="Bold" />
        <TextBlock Text="{Binding Comment}" />
      </StackPanel>
    </DataTemplate>
  </ItemsControl.ItemTemplate>
</ItemsControl> 
```

# google-chrome - Chrome 中的 CSS 滚动条问题 - 滚动条及其空间分配是单独触发的？

> ID：13713561
> 
> 赞同：1
> 
> 时间：2012-12-04T23:04:18.153
> 
> 标签：google-chrome, scrollbar

我有一个简单的 HTML 和 CSS 标记。有一个 100% 宽度和 33.3333333% 高度的固定 div，位于页面底部下方，顶部向外窥视。（底部：-28.21%；） - 我在此代码的另一个版本中使用 Javascript 来完全显示它。（底部：0；）

它看起来很好，除了：当主要内容 div 的底部靠近/与窗口底部相交时。此时，100% 宽度的固定 div 非常奇怪地缩小到了 95% 左右。它的下方也出现了一个小空间。

它只发生在 Chrome 中。有没有人经历过这个？任何CSS修复？或者它是浏览器中的错误？（在我看来就是这样……）

这是一张图片[http://s12.postimage.org/er7ld88d9/Capture.jpg](http://s12.postimage.org/er7ld88d9/Capture.jpg)。

这是代码：

[小提琴](http://jsfiddle.net/RUMjD/1/)

CSS：

```
html,body {
    margin: 0;
    padding: 0;
}

.squareDiv {
    float: left;
    width: 15%;
    margin-right: 1%;
    margin-bottom: 1%;
}

.squareDiv img {
    width: 100%;
}

.bottomBar {
    background-color: red;
    bottom: -28.21%;
    height: 33.333333333%;
    position: fixed;
    width: 100%;
} 
```

HTML：

```
<div class="midMid">
    <div class="squareDiv"><img src="Watermelons.jpg" class="mainImg" /></div>
    <div class="squareDiv"><img src="Watermelons.jpg" class="mainImg" /></div>
    <div class="squareDiv"><img src="Watermelons.jpg" class="mainImg" /></div>
    <div class="squareDiv"><img src="Watermelons.jpg" class="mainImg" /></div>
    <div class="squareDiv"><img src="Watermelons.jpg" class="mainImg" /></div>
    <div class="squareDiv"><img src="Watermelons.jpg" class="mainImg" /></div>
</div>

<div class="bottomBar">
    <div class="bottomBarTop"></div>
    <div class="bottomBarMain"></div>
</div> 
```

# intellij-idea - 是否可以在 IDEA 中导出（然后导入）插件及其设置？

> ID：13713563
> 
> 赞同：2
> 
> 时间：2012-12-04T23:04:23.270
> 
> 标签：intellij-idea

我的 IDEA 中有几个不错的插件，现在切换到新版本。所有设置都已导出然后导入，但插件。我怎样才能轻松地将它们从 11 移动到 12 版本？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T01:16:23.393

[IntelliJ IDEA 在从存储库安装](http://www.jetbrains.com/idea/webhelp/updating-installing-and-uninstalling-plugins-from-a-repository.html)插件时管理插件兼容性，下载时会自动查找最新的兼容版本。

但是，如果您只是将版本 11 兼容的插件复制到 IDEA 12，它很可能会中断甚至无法启动，因为有很多 API 更改并且许多插件需要升级才能与 IDEA 12 完全兼容。

正是这种情况，当您从旧版本导入设置时，插件不会自动复制到新版本。

即使一个插件被列为兼容，如果维护者没有限制兼容的构建号上限或做错了，它可能仍然无法工作。

我强烈建议您从存储库中安装您需要的插件，仔细检查最新的发布日期和兼容性信息。如果某些东西中断并且 IDEA 停止工作，请从[plugins 目录](http://devnet.jetbrains.net/docs/DOC-181)中手动删除不兼容的插件。

考虑到在撰写本文时 IDEA 12 甚至还没有发布（RC3 可用），您需要的所有插件都更新到与此版本兼容可能需要一些时间。您可能希望继续使用 IDEA 11 版本，直到它发生。

* * *

如果您想冒险，只需将[插件目录](http://devnet.jetbrains.net/docs/DOC-181)从旧版本复制到新版本，但您已被警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T00:52:28.830

它会像 maven 对依赖项所做的那样更聪明，只需管理一个带有已安装插件的 xml 文件，然后在导出/导入设置过程中执行插件兼容性检查想法所做的任何事情并下载/安装兼容的插件。

在 IDEA 12 的进一步更新中听起来并不难实现。

同时，您可以设法制作一个插件列表检查旧文件夹并逐个下载，因为将旧插件文件夹复制到新的最有可能使idea 12崩溃......

祝你好运。

如果有人知道如何向 jetbrains 报告 jira/ticket，请指出正确的方向，我很乐意将其报告为改进。

# c# - 为每个复选框列表选择触发单独的插入。

> ID：13713565
> 
> 赞同：0
> 
> 时间：2012-12-04T23:04:28.063
> 
> 标签：c#, asp.net, sql-server, checkboxlist

我有一个表单，用户选择要设置一些信息的行。我希望用户能够选择他们需要的所有行，然后为每个选择执行单独的插入语句作为参数的值。例如用户选择第 2,3 和 25 行。我需要执行 3 次插入语句，并且每次将 @line 参数更改为选中的下一行。我该怎么做？这是我所得到的。

```
 protected void btn_test_Click(object sender, EventArgs e)
        {

            SqlCommand cmd = new SqlCommand();
            cmd.CommandText = "Insert into t_ap_line_setup  (line,date) values (@line,getdate())";
            //string strLines = "";

            // cmd.Parameters.Add("@line", SqlDbType.Int).Value = Convert.ToInt32(strLines);

            cmd.Connection = this.sqlConnection1;
            this.sqlConnection1.Open();

            for (int i = 0; i < lines_list.Items.Count; i++)
            {
                if (lines_list.Items[i].Selected)
                {
                    cmd.Parameters.Add("@line", SqlDbType.Int).Value = Convert.ToInt32(lines_list.Items[i].Text);
                    cmd.ExecuteNonQuery();
                }
            }
            this.sqlConnection1.Close();
        } 
```

上述逻辑的另一件事是我得到两个插入，它只适用于一个选择。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:17:44.243

您可以使用循环：

```
var selectedLines = CheckBoxList1.Items.Cast<ListItem>()
             .Where(li => li.Selected)
             .Select(li => li.Text);
using (var con = new SqlConnection(connectionString))
using (var cmd = new SqlCommand("Insert into t_ap_line_setup  (line,date) values (@line,getdate())", con))
{
    con.Open();
    foreach (string line in selectedLines)
    {
        cmd.Parameters.Clear();
        cmd.Parameters.AddWithValue("@line", int.Parse(line));
        cmd.ExecuteNonQuery();
    }
} 
```

请注意，我已经使用`using-statement`来确保在我完成连接后立即处理（关闭）连接（即使在出现异常的情况下）。这比使用“全局”连接更好（我[希望它不是静态的）](https://stackoverflow.com/a/9707060/284240)。在 ASP.NET 中更是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T08:51:12.057

最好使用批量插入而不是插入每条记录。

我会在这里给你发送代码。

创建一个数据表，说 dtDetail，它在 t_ap_line_setup 表中具有相同的字段。遍历 checkboxlist 并用值填充 dtDetail 数据表。

```
// Code for bulk insert
if (dtDetail.Rows.Count > 0)
{
    string connectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
    SqlBulkCopy bulk = new SqlBulkCopy(connectionString);
    bulk.DestinationTableName = "t_ap_line_setup";
    bulk.WriteToServer(dtDetail);
} 
```

上面代码的好处是减少了sql server的跳闸，提高了生产力。

# javascript - 有谁知道为什么我的视频不会出现在我的网站上？

> ID：13713571
> 
> 赞同：0
> 
> 时间：2012-12-04T23:05:14.967
> 
> 标签：javascript, html, video, html5-video

> 我一直在为我的一个家庭作业项目制作自己的网站，但我不确定为什么我的视频在我将它们上传到我的域网站时不会显示。当我在本地测试它们时，它们在 Dreamweaver 中运行良好。这是我的网站[http://zackvivier.com/portfolio.html](http://zackvivier.com/portfolio.html)如果有帮助，这是我的视频 javascript 代码

```
var myVid;

function init() {
    myVid = document.getElementById('myVideo');
}

function addVideo(whichVideo) {

    myVid.innerHTML = "<source src='video/" + whichVideo + ".mp4' type='video/mp4'/><source src='video/" + whichVideo + ".webm' type='video/webm'/><source src='video/" + whichVideo + ".ogv' type='video/ogg'/><object width='540' height='304'> <param name='movie' value='http://fpdownload.adobe.com/strobe/FlashMediaPlayback.swf'></param><param name='flashvars' value='src=http://www.halvas.ca/Outbox/" + whichVideo + ".mp4'></param><param name='allowFullScreen' value='true'></param><param name='allowscriptaccess' value='always'></param><embed src='http://fpdownload.adobe.com/strobe/FlashMediaPlayback.swf' type='application/x-shockwave-flash' allowscriptaccess='always' allowfullscreen='true' width='540' height='304' flashvars='src=http://www.halvas.ca/Outbox/" + whichVideo + ".mp4'></embed></object>";
    myVid.load();
    myVid.play();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:54:21.543

您尚未将所有文件上传到您的网络服务器。

这个就在那里，所以它在 Chrome 中运行良好。 [http://zackvivier.com/video/demoreel.mp4](http://zackvivier.com/video/demoreel.mp4)

但它不能在 Firefox 中播放，因为这是 404 的：http: [//zackvivier.com/video/demoreel.mp4](http://zackvivier.com/video/demoreel.mp4)

# algorithm - 动态规划与贪心算法有何不同？

> ID：13713572
> 
> 赞同：43
> 
> 时间：2012-12-04T23:05:14.373
> 
> 标签：algorithm, dynamic-programming, greedy

在我正在使用[的《算法设计与分析简介](https://rads.stackoverflow.com/amzn/click/com/0201743957)》一书中，据说*动态规划关注的***是最优性原理**，“任何优化问题实例的最优解都由其子实例的最优解组成”。

而*贪心技术*则侧重于扩展部分构造的解决方案，直到您找到完整问题的解决方案。然后说，它必须是“在该步骤可用的所有可行选择中的最佳本地选择”。

由于两者都涉及局部最优性，所以不是另一个的子集吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-12-04T23:18:59.200

动态规划适用于表现出以下性质的问题：

*   重叠子问题，以及
*   最优子结构。

最优子结构意味着你可以贪婪地解决子问题，并结合解决方案来解决更大的问题。 **动态规划和贪心算法的区别在于，动态规划有重叠的子问题，这些子问题是通过记忆化来解决的**。“记忆化”是一种利用子问题的解决方案更快地解决其他子问题的技术。

这个答案已经引起了一些关注，所以我会举一些例子。

考虑“用美元、镍和便士找零”这个问题。这是一个贪婪的问题。它展示了最优的子结构，因为您可以求解美元的数量。然后，求解镍的数量。然后是硬币的数量。然后，您可以有效地结合这些子问题的解决方案。它并没有真正表现出重叠的子问题，因为解决每个子问题对其他子问题没有多大帮助（可能有点）。

考虑问题“斐波那契数”。它表现出最佳子结构，因为您可以有效地（通过加法）从 F(9) 和 F(8) 求解 F(10)。这些子问题重叠，因为它们都共享 F(7)。如果在求解 F(8) 时记住 F(7) 的结果，则可以更快地求解 F(9)。

回应关于动态规划与“重新考虑决策”有关的评论：这显然不适用于任何线性动态规划算法，如[最大子数组问题](http://en.wikipedia.org/wiki/Maximum_subarray_problem)或上面的斐波那契问题。

本质上，将具有最优子结构的问题想象为一个有向无环图，其节点表示子问题（其中整个问题由入度为零的节点表示），其有向边表示子问题之间的依赖关系。然后，贪心问题是一棵树（除根以外的所有节点都有单位入度）。动态规划问题有一些入度大于 1 的节点。这说明了重叠的子问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-04T23:13:21.740

不同之处在于，动态编程要求您记住较小状态的答案，而贪心算法是本地的，因为所需的所有信息都处于当前状态。当然，也有一些交集。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-05T00:14:43.790

关键区别在于，贪心算法“静态地”组成解决方案，即解决方案中的每个本地选择都可以最终确定，而无需了解有关其他本地选择的任何信息。然而，动态算法为子问题创建了一组可能的解决方案，并且仅在考虑了所有子问题后才为全局问题生成单个解决方案。关于贪心算法的[维基百科页面](http://en.wikipedia.org/wiki/Greedy_algorithm)说得很好：

> 贪心算法做出的选择可能取决于到目前为止所做的选择，但不取决于未来的选择或子问题的所有解决方案。它迭代地做出一个又一个贪婪的选择，将每个给定的问题减少为一个较小的问题。换句话说，贪心算法永远不会重新考虑它的选择。这是与动态规划的主要区别，动态规划是详尽的并且保证能找到解决方案。在每个阶段之后，动态规划都会根据前一阶段做出的所有决策做出决策，并且可能会重新考虑前一阶段的算法路径来解决问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-04T23:10:54.283

DP 算法使用以下事实（对于某些问题） - 大小问题的最佳解决方案由大小问题的`n`最佳解决方案组成`n'<n`，并使用它自下而上构建解决方案，从最小问题到所需尺寸。

它非常符合递归的相同原理（将问题简化为较小的子问题，并递归调用），实际上 - DP 解决方案通常表示为递归公式。

贪心算法正在查看一个**局部**点，并在这一点上对数据进行一些选择。对于某些问题（例如，没有负权重的最短路径） - 这种本地选择将导致最佳解决方案。

两种方法之间差异的一个很好的例子是[最短路径问题](http://en.wikipedia.org/wiki/Shortest_path_problem)：

*   [Dijsktra 的算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)是一种贪心方法（在每一步，选择路径当前最小化的节点 - 选择是基于算法的本地状态贪心地完成的）。
*   [Bellman-Ford 算法](http://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm)是一种 DP 解决方案（“放松”所有边缘，有效地减少了问题）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-28T18:23:18.097

贪心法：

1.  贪心方法侧重于扩展部分构造的解决方案。
2.  它提供了许多结果，例如可行的解决方案。
3.  更高效

动态规划：

1.  关注最优性原则。
2.  它提供了具体的答案。
3.  效率较低

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-20T21:19:14.583

DP和greedy的区别在于DP会在每个子问题上寻找全局最优，而greedy只会寻找局部最优。所以，关于这种情况：

假设你正在爬一座山，你想爬得尽可能高。山上的路有好几条支路，在每个路口你需要决定走哪条支路，这是这个攀登问题的子问题（目标相同，只是起点不同）

For the greedy algorithm, you will always choose whichever one seems more steeply up. This is a **local** optimal decision and is not guaranteed to lead to the best result

For the DP, at each intersection, you should already know the highest altitude each branch will lead you to (suppose your evaluation order is reversed, a.k.a from end points to the starting point), and choose the one with the largest altitude. This decision is build upon the global optimum of the future subproblems and there for will be **globally** optimum for this subproblem

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-09-18T13:51:52.193

贪婪和动态解决方案的概念并不相互排斥，我认为这在大多数答案中造成了很多混乱。我相信阿米特的回答强调最重要的属性：贪婪的解决方案会根据**本地**信息做出决策。因此，贪婪的解决方案最终可能会找到**局部**最优而不是全局最优。动态解决方案将问题分解为更小的子问题，然后聚合结果以获得更大更复杂问题的答案。那么-问题是否可能既是**动态**的又是**贪婪的**? 答案是——是的，这是可能的。一个例子是 Dijkstra 的算法。对于此算法，您在每一步都做出了贪婪的选择，但您将问题简化为更简单的子问题。

还有一些不是 DP-s 的贪心算法的例子：比如爬山是一种贪心算法，它不会将一个问题分解为多个子问题——它总是只解决一个子问题。还有一些不贪心的 DP 示例 - 例如，使用记忆化计算第 n 个斐波那契数不是贪心的。

# fortran - 如何在 Sublime Text 2 中为 Fortran 90 获得正确的文本颜色突出显示？

> ID：13713577
> 
> 赞同：26
> 
> 时间：2012-12-04T23:05:50.367
> 
> 标签：fortran, sublimetext2, fortran90

sublime 论坛上有几个链接，关于如何让 Sublime Text 2 与 Fortran 90 在这里[http://www.sublimetext.com/forum/viewtopic.php?f=4&t=770](http://www.sublimetext.com/forum/viewtopic.php?f=4&t=770)一起工作，但他们没有似乎可以作为评论标识符“！” 没有得到很好的对待。

我使用原始建议的 Punchcard.tmLanguage 文件快速组装了一个解决方案，并修改了字典中的第一个块来处理“！” 作为评论（可在此处获得：[https](https://gist.github.com/4209445) ://gist.github.com/4209445 ）。

Sublime Text 2 是一个很棒的文本编辑器，它支持 Fortran 可能对理论物理和金融领域的许多人有帮助。所以如果有人知道更好的解决方案，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-05T02:29:46.667

[fortran.tmBundle](https://github.com/textmate/fortran.tmbundle)中的插件对我有用。我在其中创建了一个`Fortran`子文件夹`Packages`并将所有文件放在 tmBundle 中（不仅仅是`.tmLanguage`文件）。它选择 Fortran - Punchcard 作为文件的默认类型`.for`和 Fortran - Modern 的`.f90`文件。这两个`!`在我的系统上都很好 - 你有什么问题？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-28T17:47:03.497

我还将 Fortran (Modern) 与 Sublime Text 一起使用（现在我使用的是第 3 版），处理评论时出现了一些小故障。看这个例子：

![](../Images/1bec6356230a3df2a53f5d22fae61a19.png)

如您所见，第二行以感叹号开头，但无法识别。但是，如果我以“！”（包括空格）开始第一行，那么一切正常：

![](../Images/5a2d7503cccbcbf6fec318e902756ba7.png)

如果我在后面加上一个破折号！在第二行中，它将其重新调整为注释，但问题出现在第三行：

![](../Images/b2a0ce0b716aac54c65b8e951a5f9381.png)

我不理解语法文件的语言，但我查看了[MinimalFortran 包](https://github.com/315234/MinimalFortran)来解决这个问题（这个包效果很好，可以使用包控制安装，但它错过了很多语法）。我只是改变了

```
<string>!-</string> 
```

到

```
<string>[!]</string> 
```

在“Fortran - Modern.tmLanguage”文件上，一切正常：

![](../Images/71305e04154b073230fc9f2d8f3758f0.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-28T06:43:08.857

另请查看[Minimal Fortran](https://packagecontrol.io/packages/MinimalFortran)。已经使用了几个月，可以保证。使用 Package Control 也易于安装。

# math - 光子映射的渲染方程

> ID：13713580
> 
> 赞同：2
> 
> 时间：2012-12-04T23:06:02.027
> 
> 标签：math, graphics, 3d, rendering, raytracing

这是一篇很长的文章，所以感谢所有阅读本文的人！

因此，对于我自己的个人项目，我正在实现一个光子贴图以与我构建的光线追踪器一起使用，但我无法理解渲染方程。我已经编写了代码来分散一般光子和焦散光子，将它们存储在 KD 树中，并在树中有效地查找它们以用于渲染。

所以渲染方程为： Lr(x,w) = Integral( fr(x, w', w) * Li(x, w') cos(Theta i) * dw'i )

其中 x 是场景中的给定点，w' 是入射光的方向，w 是反射光，Theta_i 是入射角（我认为）。

第一个问题：

这涉及术语 fr(x, w', w)，它是 BRDF（双向反射率分布函数）。现在我不确定我是否理解正确，但基本上 BRDF 基本上是一个着色功能？也就是说，对于我的程序的基本光线追踪功能，我使用了 phong 反射模型来进行直接照明和反射。重新调整我的 phong 反射代码并用它来表示积分中的 BRDF 是否有效？

第二个问题：我的另一个问题与我们何时将渲染方程分解为其组件有关。例如，要计算漫反射相互反射，我们这样做：

漫反射 = 积分（fr,d(x, w', w), * Li,d(x,w') cos(theta_i) dw'i)

因此，在任何给定点上，我已经在其周围存储了一堆漫反射光子。根据我从这个方程的理解，我是否只需将每个光子的强度乘以 phong 模型的漫反射分量乘以角度的余弦并将它们全部加起来？

我为该特定部分提供的代码如下所示：

```
Color result = Color(0,0,0) // r = g = b = 0;
for(int i = 0; i < # photons surrounding point x; i ++)
{
   result += Phong_Diffuse(photon_i, x, camera_ray) * photon_i.color * photon_i.angle
} 
```

然后我将它添加到我从直接照明 ( Phong_DIFF_&_SPEC(light_source, x, camera_ray) ) 中获得的颜色和我从镜面反射中获得的颜色中。我在这里做的正确吗？

我只是似乎没有得到想要的效果。一个原因是，如果我缩放我的光子以使每个光子具有 Light_source / num_Photons 的强度，那么即使每个位置有数百个光子，它也几乎不会对我的场景产生明显的影响，因为我总共有 500,000 个光子。如果我不缩放我的光子或捏造缩放，颜色仍然看起来不正确。

此外，当我在 Cornell_box 上进行测试时，即使使用漫反射，天花板仍然明显非常暗，根据我看到的其他康奈尔盒子的图片，它应该更亮。

我也不认为我存储光子的方式有问题，因为我尝试直接可视化我的光子（所以整个场景只是由光子所在的彩色点组成）而且它们似乎大致均匀分布并在正确的位置，当我测试看到我正在收集最接近给定点的光子时，这似乎也能正常工作。

感谢所有费心阅读这冗长杂乱无章的混乱的人，感谢任何花时间回复的人！=)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T07:47:25.453

对于你的第一个问题，答案是肯定的。BRDF 只是一个概率分布，它描述了具有入射方向的光子`i`被反射到一个方向`o`（或被吸收）的概率。这也是您的 Phong 模型所描述的。

对于您的第二个问题，我想您的问题在于比例因子。当您在半径附近收集光子时`R`（无论`R`是恒定的，还是随 k 个最近的邻居而变化），您必须将累积的能量除以半径圆盘的面积`R`（因此，如果这个面积小得多比一个，这将提高你的强度）。Appart 由此看来，您的计算似乎是正确的：您拍摄所有光子及其方向，在 BRDF 中使用它们来查看它们被反射到相机的概率（或者说，当反射到相机时光子的剩余能量有多少） )，然后总结一切。我猜你`Phong_Diffuse`包含一个漫反射组件（因此它的名字），如果是这样，那也是正确的。
另一种可能性是您的漫反射太弱而无法产生可见的漫反射。

# java - 集成类

> ID：13713585
> 
> 赞同：-3
> 
> 时间：2012-12-04T23:06:31.703
> 
> 标签：java, inheritance

大家好，这里是我的代码：

```
package Chapter5;

import java.util.Scanner;

public class MainMenu extends Integration
{

static Scanner s = new Scanner(System.in);
static int c;
static double lower, upper;
static double Curves;
static double sum = 0;

public static void main(String[] args) 
{

    while(true)
    {
        System.out.println("Please choose one of the options");
        System.out.println("1: Calculate the area between two curves");
        System.out.println("2: Calculate the volume when two curves are revolved about a disk");
        System.out.println("3: Calculate the volume when a single curve is revolved about a shell");
        System.out.println("4: Quit");
        c = s.nextInt();
        if(c == 1)
        {
            System.out.println("Area between two curves");
            System.out.println("Please enter the lower limit");
            lower = s.nextInt();
            System.out.println("Please enter the upper limit");
            upper = s.nextInt();
            System.out.print("Lower limit: " + lower);
            System.out.println("  Upper limit: " + upper);
            System.out.println("The area under the f curve: " + sumf);
            System.out.println("The area under the g curve: " + sumg);
            sum = sumf - sumg;
            System.out.println("Area between the two curves = " + sum);
        }
        if(c == 2)
        {
            System.out.println("Working");
        }
        if(c == 3)
        {
            System.out.println("Working");
        }
        if(c == 4)
        {
            break;

        }
    }
} 
```

这是我的集成课程：

```
 package Chapter5;

   /*Author: Cory Zander
   * Purpose: Find the area and volume between two curves
   */
   public class Integration 
   {

static double x;
static double dx;
static double f, g;
static double sumg = 0;
static double sumf = 0;
public static double f(double x) 
{
    f = x * Math.exp(x);
    return x;

}
public static double g(double x) 
{
    g = Math.pow(x, 2);
    return x;

}

public static double Areaf(double lower, double upper)
{
    int i;
    x = lower;
    dx = (upper - lower)/2000;
    for(i = 0; i <= 2000; i++)
    {
        if(i == 0 || i == 2000)
        {
            sumf += f;
        }
        else
        {
            sumf += 2 * f;
        }
        x += dx;

    }
    sumf *= dx/2;
    return sumf;

}
public static double Areag(double lower, double upper)
{
    int i;
    x = lower;
    dx = (upper - lower)/2000;
    for(i = 0; i <= 2000; i++)
    {
        if(i == 0 || i == 2000)
        {
            sumg += g;
        }
        else
        {
            sumg += 2 * g;
        }
        x += dx;

    }
    sumg *= dx/2;
    return sumg;
} 
```

好的，我刚刚编辑了这个并修复了areaf和areag问题，但是由于某种原因，当我得到f曲线下的面积时，我仍然得到0。为什么它不从Integration类中获取sumf

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:10:49.557

```
public static void main(String[] args){
    if (c == 1){
        //...
        double area1 = Integration.Areaf(lower, upper);
        double area2 = Integration.Areag(lower, upper);
        sum = area1 - area2;//sum and minus used?
        System.out.println("Area between the two curves = " + sum);
   }
} 
```

此外，您错误地使用了继承，导致基类 ( `Integration`) 中的所有方法都是`static`. 您可以简单地`extends`从子类中删除子句或以正确的方式对其进行调整。

# bing-maps - 在 Bing 地图中使用图钉附加自定义 ID

> ID：13713588
> 
> 赞同：1
> 
> 时间：2012-12-04T23:06:37.747
> 
> 标签：bing-maps, pushpin

我想将一个唯一的 ID 号（取自 DB）添加到我放在 Bing 地图上的图钉中。当我不使用任何主题（如 Bing 主题）时，它可以完美运行，如下所示：

```
var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(lat, lon), 
{icon: some_icon, width: 34, height: 43});

pushpin.customid = 13;
map.entities.push(pushpin); 
```

然后我可以稍后通过 Pushpin 对象访问这个“customid”属性。

但是，当我激活 Bing 主题时，一切正常，除了这些对我的应用程序至关重要的自定义值。

关于将某些唯一 ID 附加到这些图钉的其他方法的任何想法，或解决此问题的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-29T22:38:04.423

只需将自定义属性添加到图钉，如下所示：

pushpin.MyID = '一些id';

然后，您可以使用此博客文章中描述的方法按 id 检索图钉：[http ://rbrundritt.wordpress.com/2012/04/02/get-entity-by-property-in-bing-maps-v7/](http://rbrundritt.wordpress.com/2012/04/02/get-entity-by-property-in-bing-maps-v7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T22:14:14.140

我使用一个普通的 JavaScript 对象来包装 Pushpin 及其功能，因此我没有将自定义属性存储在 Pushpin 上，而是将它们存储在包装器对象上。

例如，假设我们指定了地图和位置，然后我们可以创建我们的对象：

```
var Pin = function(location, map) {
    this._pushpin = new Microsoft.Maps.Pushpin(location);
    map.entities.push(this._pushpin);
    this.id = (new Date).valueOf();
    var self = this;
    Microsoft.Maps.Events.addHandler(this._pushpin, 'click', function() {
        console.log(self.id);
    })
}; 
```

这样，当我们稍后需要引用图钉的 id 时，例如当图钉被点击时，我们就可以获取包装对象的 id。

使用公共 API 扩展 Bing 地图对象是一种很好的做法。

[在这里](http://learningbingmaps.com/tutorials/2014/01/06/how-to-extend-bing-maps-entities "这里")写了一篇关于它的博客文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-20T17:18:17.570

除了使用 pushpin.custid 属性，您可以使用 pushpin.getId() 默认方法并重新定义它以返回 custid

```
var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(lat, lon), 
                                        {icon: some_icon, width: 34, height: 43});

var custid=13;
pushpin.getId = function (){
    return custid;
}
map.entities.push(pushpin); 
```

# jquery - jquery div框出现在按钮顶部

> ID：13713589
> 
> 赞同：0
> 
> 时间：2012-12-04T23:06:39.540
> 
> 标签：jquery

这是我正在研究的小提琴 [http://jsfiddle.net/d0okie0612/22cTn/](http://jsfiddle.net/d0okie0612/22cTn/)

我试图让框出现在按钮的顶部，但在现有的 div 框的底部。

```
 <div id="top_form">
  <form>
    Street: <input name="titles[]" type="text" placeholder="eg: 123 Fake st."><br><br>
    City: <input name="titles[]" type="text" placeholder="eg: Bellflower">
    <select>
    <option value=" ">State</option>
    <option value="ca">CA</option>
    <option value="az">AZ</option>
    <option value="de">DE</option>
  </select>
     Zip: <input name="titles[]" type="text" placeholder="eg: 91745"><br />

 </form>

 </div>
    <br />
 <a id="awsomeButton" href="#">+ Add Loction</a> 
```

这是脚本

```
var tpl = ""
 + "<div id='location_div_<%= id %>'><h1>My Location #<%= id %></h1></div>";

  var newId = new Date().getTime();
 var template = _.template(tpl);
   var compiled = template({id: newId});

 var form = ""
+ "<div id='added_form'><a href='#' class='close_btn'>x</a><form> Street: <input       name='titles' type='text'><br /><br />City: <input name='titles' type='text'><select><option value=' '>State</option><option value='ca'>CA</option></select>Zip: <input name='titles' type='text'></form></div>"

 $('#awsomeButton').on('click', 
    function(e){
    $(form).hide().appendTo('body').fadeIn('slow');
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:09:14.060

代替

```
.appendTo('body') 
```

**将其附加**到

```
.appendTo('#top_form') 
```

最好将您的 top_form 包含在另一个 div 中

```
<div id="container" >
    <div id="top_form"> 
```

并将其附加到容器...

```
.appendTo('#container') 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/22cTn/5/)**

# php - Yii：如何计算模型中的记录？

> ID：13713590
> 
> 赞同：15
> 
> 时间：2012-12-04T23:06:40.020
> 
> 标签：php, yii

我有以下代码从模型中获取数据。

```
$notifyModel = Notification::model()->findByAttributes(array(
                  'user_id'=> Yii::app()->user->uid
               )); 
```

现在我想计算提取的行数。既不`$notifyModel->count()`工作也不`count($notifyModel)`。这很简单，但谷歌搜索没有帮助。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-04T23:10:49.630

```
$notifyModels = Notification::model()->findAllByAttributes(array(
            'user_id'=> Yii::app()->user->uid
        ));

$count = count($notifyModels); 
```

或者

```
$count = Notification::model()->countByAttributes(array(
            'user_id'=> Yii::app()->user->uid
        )); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-02-21T19:26:31.380

count() 的正确用法：

```
 $userid =  Yii::app()->user->uid;
    $count = Notification::model()->count( 'user_id=:userid', array(':userid' => $userid)); 
```

请参阅[http://www.yiiframework.com/doc/api/1.1/CActiveRecord#count-detail](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#count-detail)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-05T10:58:51.993

尝试这个：

```
$userid =  Yii::app()->user->uid;

$notifyModel = Notification::model()->count(
           array('condition' => 'user_id=:userid', 
                 'params'=>array(':userid' => $userid)
                )); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-12T11:11:30.763

```
$count = Notification::model()->countByAttributes(array(
    'user_id'=> Yii::app()->user->uid
)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-08T03:35:11.267

简单的方法：

```
$model = News::model()->findAll(); //returns AR objects
         $count = count($model); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-06-18T09:46:41.297

因为问题`title`是关于调用计数函数的`in a model`，所以我会为那些阅读本文的初学者添加一些:)

模型内的函数可能如下所示：

```
/**
 * Count the number of rows which match the user ID
 * @param int $uid The user ID
 * @return int The number of found rows
 */
public function getCountByUserID($uid)
{
    $count = $this->count(array(
        'condition'=>'user_id = :uid',
        'params'=>array(
            ':uid'=>$uid,
        ),
    ));
    return $count;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-06-03T16:31:06.083

我认为它比其他人快得多

```
$userTable=User::model()->tableName();
$userid =  Yii::app()->user->uid;
$criteria=new CDbCriteria();
$criteria->select=count(id);
$criteria->compare('user_id',$userid);
$count=Yii::app()->db->commandBuilder->createFindCommand($userTable,$criteria)->queryScalar(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-08-08T21:54:37.463

那个方法是错误的！您试图通过从数据库中选择所有行来加载服务器，但这是错误的方式！所有你需要做的：

```
$sql = "SELECT COUNT(*) FROM {{...table_name...}}";

$count = intval(Yii::app()->db
  ->createCommand($sql)
  ->queryScalar()); 
```

或者您可以在模型中创建函数：

```
Class User extends CActiveRecord
{
    private $_total;

    public function getTotalItems()
    {
        if( empty( $this->_total )) {
            $this->_total = intval(Yii::app()->db
                ->createCommand($sql)->queryScalar());
        }
        return $this->_total;
    }

} 
```

那么你可以像这样使用这个函数：

```
$totalItems = User::model()->totalItems; 
```

或者 ：

```
$model = User::model()->findByPk( $uid );
$totalItems = $model->totalItems; 
```

或者 ：

```
$model = new User;
$totalItems = $model->totalItems; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-29T06:36:28.910

这是最简单的方法：

```
$count = Table::Model()
         ->count("field=:field", array("field" => $fildID));
echo $count; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-12T09:31:51.767

我强烈建议您使用 SQL 查询查找计数，否则它会降低您的系统性能。有三种方法可以通过 SQL 查询本身找出计数`Yii 1` `CActiveRecord`，它们是：

**1.count()方法**

查找满足指定查询条件的行数。

*例子 ：*

```
$count = Notification::model()->count('user_id'=> Yii::app()->user->uid); 
```

**2\. countByAttributes() 方法（从 v1.1.4 开始可用）**

查找具有指定属性值的行数。

*例子 ：*

```
$count = Notification::model()->countByAttributes(array(
    'user_id'=> Yii::app()->user->uid
)); 
```

**3.countBySql()方法**

使用给定的 SQL 语句查找行数。这相当于`CDbCommand::queryScalar`使用指定的 SQL 语句和参数调用。

*例子：*

```
$count = Notification::model()
         ->countBySql("select *from notification where user_id=:userId",
            array(':userId'=>Yii::app()->user->uid)
           ); 
```

> 不要使用以下代码，会降低系统性能：
> 
> ```
> $notifyModels = Notification::model()->findAllByAttributes(array(
>             'user_id'=> Yii::app()->user->uid
>         ));
> $count = count($notifyModels); 
> ```
> 
> 因为，有两个函数调用来查找计数

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-04-09T07:26:46.123

在我的研究中，最简单和最佳实践如下所示。

```
$notifyModel = Notification::model()->count(array('user_id'=> Yii::app()->user->uid)); 
```

# r - 如何更改ggplot中的默认日期间隔？

> ID：13713592
> 
> 赞同：-4
> 
> 时间：2012-12-04T23:06:47.917
> 
> 标签：r, ggplot2

我不确定 ggplot 中的默认日期间隔是多少。我的数据有五个数据点，包括 2011 年 9 月、2011 年 12 月、2012 年 3 月、2012 年 6 月和 2012 年 9 月。

ggplot 显示与我的数据不同的数据点，我觉得这有点烦人。我错过了什么吗？

您能帮忙显示“2011 年 9 月、2011 年 12 月、2012 年 3 月、2012 年 6 月和 2012 年 9 月

```
x4.1.m<- structure(list(Var.1=structure(c(1L,2L,3L,4L,5L,6L,1L,2L,3L,4L,5L,6L,1L,2L,3L,4L,5L,6L,1L,2L,3L,4L,5L,6L,1L,2L,3L,4L,5L,6L),.Label=c("I'vechangedforwork/anewjob/goneonaworkplan","IwantaphonethatVodafonedoesn'toffer","IwantBestMates/Favourites","Iwasofferedorsawabetterofferonanothernetwork","Issueswiththe2degreesnetwork(poorcoverage)","Other"),class="factor"),YearQuarter=structure(c(1L,1L,1L,1L,1L,1L,2L,2L,2L,2L,2L,2L,3L,3L,3L,3L,3L,3L,4L,4L,4L,4L,4L,4L,5L,5L,5L,5L,5L,5L),.Label=c("2011-09-01","2011-12-01","2012-03-01","2012-06-01","2012-09-01"),class="factor"),value=c(0.23,0.23,0.121,0.25,0.223,0.14,0.39,0.22,0.05,0.37,0.25,0.2,0.09,0.14,0.05,0.3,0.4,0.12,0.13,0.1,0.26,0.38,0.28,0.15,0.33,0.05,0.06,0.44,0.32,0.43)),.Names=c("Var.1","YearQuarter","value"),row.names=c(NA,-30L),class="data.frame")

library(scales)
library(ggplot2)
###data 
x4.1.m$YearQuarter <- as.Date(x4.1.m$YearQuarter)
x4.1.m$label       <- paste(round(x4.1.m$value*100,0), "%", sep="")

### plot
x4.line <- ggplot(data=x4.1.m, aes(x=YearQuarter, y=value,colour=Var.1)) +
        geom_smooth(se=F, size=1.5)
x4.line <- x4.line + geom_text(aes(label = label),size = 3, hjust = 0.5, vjust =1.5) 

### theme  
x4.line <- x4.line +  theme(axis.line = element_line(colour = "black"),
       panel.grid.major = element_blank(),
       panel.background=element_blank(),
       panel.grid.minor = element_blank(),
       panel.border = element_blank()) 

x4.line <- x4.line +  ggtitle("Percentages:Main Reasons for Leaving Vodafone by Quarter") +
  theme(plot.title = element_text(size=rel(1.2)))+ 
scale_y_continuous(labels=percent, limits=c(0,0.5)) +
  scale_x_date(labels = date_format("%b-%y"),breaks = date_breaks("3 months"))+
  labs(y="Percentage",x="Year Quarter")

x4.line 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:17:27.380

您需要将所需的休息时间传递给 `breaks`参数`scale_x_date`（这真是令人惊讶。）

```
# your breaks 
d <- unique(x4.1.m[['YearQuarter']])
themestuff <-  theme(axis.line = element_line(colour = "black"),
                        panel.grid.major = element_blank(),
                        panel.background=element_blank(),
                        panel.grid.minor = element_blank(),
                        panel.border = element_blank())  

x4.line <- ggplot(data=x4.1.m, aes(x=YearQuarter, y=value,colour=Var.1)) +
 geom_smooth(se=F, size=1.5) + 
 geom_text(aes(label = label),size = 3, hjust = 0.5, vjust =1.5) +
 themestuff +  ggtitle("Percentages:Main Reasons for Leaving Vodafone by Quarter") +
 theme(plot.title = element_text(size=rel(1.2))) +
 scale_y_continuous(labels=percent, limits=c(0,0.5)) +
 scale_x_date(labels = date_format("%b-%y"), breaks = d)+
 labs(y="Percentage",x="Year Quarter")
x4.line 
```

![在此处输入图像描述](../Images/3ccf9ae469e857b3c217493f6d8db839.png)

# dart - 有人可以给出一个示例代码，如何在 dart 中将请求处理程序添加到 HttpServer 对象？

> ID：13713593
> 
> 赞同：4
> 
> 时间：2012-12-04T23:06:48.240
> 
> 标签：dart

我对飞镖编程非常陌生，感谢您的帮助。

```
void main() {
  var server = new HttpServer();
  server.listen('127.0.0.1', 8080);
  server.
  addRequestHandler(
  accept(HttpRequest function) => acceptInput(request, response), handler);
 } 
```

我想将下面的函数添加到请求处理程序中。 **server.addrequestHandler()** 我想这样做，这样我就可以添加许多请求处理程序，包括一个用于 websockets 的示例或教程将非常有帮助。

为了简单起见，我想将每个处理程序保留在单独的函数中。

```
void acceptInput(HttpRequest request,HttpResponse response){
  print(request.connectionInfo.toString());
  print(request.queryParameters.toString());
  response.outputStream.write('Hello dude'.charCodes);
  response.outputStream.close();
} 
```

**注意：我知道我的 void 主代码是错误的，我需要帮助以使其正确，以便它包含 acceptInput 函数。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T05:51:54.760

事实上，你真的很亲近。

尝试这个：

```
 var server = new HttpServer();
  server.addRequestHandler(
      (req) => req.path == '/save',
      handleSave);
  server.addRequestHandler(
      (req) => req.path == '/delete',
      handleDelete);
  server.defaultRequestHandler = new StaticFileHandler(basePath).onRequest; 
```

Where`handleSave`和`handleDelete`are 只是函数，例如：

```
handleSave(HttpRequest req, HttpResponse resp) {
  // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:31:22.433

以下是提供文件和处理 Web 套接字连接的 Web 服务器的代码：

[https://github.com/dart-lang/web-components-code-lab/blob/master/step04/bin/chat_server.dart](https://github.com/dart-lang/web-components-code-lab/blob/master/step04/bin/chat_server.dart)

这是否回答你的问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T00:45:07.157

您应该查看我的[Express.dart](https://github.com/mythz/DartExpress/blob/master/Express.dart)实现，它是一个类似于 Express 的 Web 框架，适合单个文件，因此易于阅读。

查看[HttpServer 文档](http://api.dartlang.org/docs/bleeding_edge/dart_io/HttpServer.html)以查看每种方法的正确签名。这是 addRequestHandler 的 API：

```
abstract addRequestHandler(
    bool matcher(HttpRequest request), 
    void handler(HttpRequest request, HttpResponse response)
) 
```

第一个参数是这是否应该处理请求，而第二个参数是如果匹配器为真则处理请求的处理程序。

所以 Dart 中的 Http 应用程序看起来像：

```
var server = new HttpServer();

server.addRequestHandler(
   (HttpRequest req) => true, 
   acceptInput);

server.listen('127.0.0.1', 8080); 
```

# ldap - 针对 LDAP 验证 weblogic 安全领域用户失败

> ID：13713594
> 
> 赞同：1
> 
> 时间：2012-12-04T23:06:50.227
> 
> 标签：ldap, weblogic, openldap, ldap-query, ldapconnection

我已经安装了 weblogic '10.3.4.0' 并创建了一个域并在默认安全领域`business`创建了一个用户。身份验证器与 weblogic 中的一样。现在，我想在我的独立 java 应用程序中使用 LDAP 对用户进行身份验证。我也尝试过更改 LDAP 凭据。执行应用程序后，系统响应以下错误：。`businessuser``myrealm``DefaultAuthenticator``javax.naming.AuthenticationException: [LDAP: error code 49 - Invalid Credentials]`

代码：

```
Properties l_props = new Properties();
LdapContext l_ctx = null;
l_props.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
l_props.put(Context.PROVIDER_URL, "ldap://localhost:7001");
l_props.put(Context.SECURITY_AUTHENTICATION, "simple");
l_props.put(Context.SECURITY_PRINCIPAL, "cn=username");
l_props.put(Context.SECURITY_CREDENTIALS, "password");
l_ctx = new InitialLdapContext(l_props, null); 
```

错误：

```
javax.naming.AuthenticationException: [LDAP: error code 49 - Invalid Credentials]
    at com.sun.jndi.ldap.LdapCtx.mapErrorCode(LdapCtx.java:3041)
    at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2987)
    at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2789)
    at com.sun.jndi.ldap.LdapCtx.connect(LdapCtx.java:2703)
    at com.sun.jndi.ldap.LdapCtx.<init>(LdapCtx.java:293)
    at com.sun.jndi.ldap.LdapCtxFactory.getUsingURL(LdapCtxFactory.java:175)
    at com.sun.jndi.ldap.LdapCtxFactory.getUsingURLs(LdapCtxFactory.java:193)
    at com.sun.jndi.ldap.LdapCtxFactory.getLdapCtxInstance(LdapCtxFactory.java:136)
    at com.sun.jndi.ldap.LdapCtxFactory.getInitialContext(LdapCtxFactory.java:66)
    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:667)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)
    at javax.naming.InitialContext.init(InitialContext.java:223)
    at javax.naming.ldap.InitialLdapContext.<init>(InitialLdapContext.java:134)
    at com.iflex.fcat.misc.TestLDAP.createInitialLdapContext(TestLDAP.java:258)
    at com.iflex.fcat.misc.TestLDAP.authenticate(TestLDAP.java:170)
    at com.iflex.fcat.misc.TestLDAP.main(TestLDAP.java:125) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-24T17:43:41.620

尝试这个：

```
package br.com.cliente.projeto;

import java.util.Hashtable;

import javax.naming.Context;
import javax.naming.InitialContext;

public class Autenticacao
{
  @SuppressWarnings({ "unchecked", "deprecation" })
public static void main(String args[])
  {

      String username = "jstein";  
      String password = "welcome1";  

      Hashtable env = new Hashtable();
      env.put(Context.INITIAL_CONTEXT_FACTORY,"weblogic.jndi.WLInitialContextFactory"); 
      env.put(Context.SECURITY_PRINCIPAL, username);
      env.put(Context.SECURITY_CREDENTIALS, password);
      env.put(Context.PROVIDER_URL, "t3://10.19.2.99:7001");
      try {  
          InitialContext ctx = new InitialContext(env);
          System.out.println("Autenticado");  
      } catch (Exception e) {  
          e.printStackTrace();  
      }  

  }
} 
```

# c - 如何在套接字上使用 lex 扫描仪？

> ID：13713600
> 
> 赞同：1
> 
> 时间：2012-12-04T23:07:22.830
> 
> 标签：c, parsing, sockets, lex

是否可以使用 lex 扫描/解析来自套接字的数据？我该如何定义套接字？应该是 SOCK_STREAM 吗？我是否需要对我的 YY_INPUT 宏做任何花哨的事情，例如定义一个 select() 循环以确保解析器有数据？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T03:39:42.810

如果您使用的是 flex，那么您可以重新定义`YY_INPUT`为您想要的任何内容。

它应该如下所示：

```
#define YY_INPUT(buf,result,max_size)  \
read up to max_size characters into buf \
result = (read worked) ? (number of characters read) : YY_NULL; 
```

即使您在内存中的某处有字符，您也必须将它们复制到`buf`. 这有点烦人，但它与`flex`每个输入块末尾需要两个 NUL 字符的事实有关，而且它不相信你把它们放在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:45:20.697

您可以尝试[`fdopen(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/fopen.3.html)使用 a `SOCK_STREAM`，即 TCP 套接字（您不能在 UDP 套接字上真正做到这一点，因为您永远不会得到 a `EOF`），尽管使用带有[`stdio(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/stdio.3.html)流的套接字很容易出现问题，因为自动双缓冲（在内核中）并在流中）。

您可以考虑滚动您自己的流，[`fmemopen(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/fmemopen.3.html)或者，如果您在 Linux 上，甚至可以使用[`fopencookie(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/fopencookie.3.html).

# c - 通过 C 函数创建和返回文件

> ID：13713602
> 
> 赞同：2
> 
> 时间：2012-12-04T23:07:32.563
> 
> 标签：c, file, file-io

我要做的是编写一个函数来创建一个文件，用数据填充它并将文件返回给 main()。问题是 - “返回文件”的正确方法是什么。我应该传递指针/文件描述符还是忽略所有这些并使用文件名？

编辑：做正确的方式（我希望）：

```
int mkrandfile(const char *name, int range, int qnt) 
{
    FILE *afile;
    int i = 0;

    if (afile = fopen(name, "w+"))
    {
        while((i <= qnt) && fprintf(afile, "%d ", rand() % range - range/2))
            i++;
        fclose(afile);
        if (i != qnt + 1)
            return -2;
    }
    else
        return -1;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:18:38.733

您是正确的，`afile`从该函数返回是错误的。一旦文件关闭，该文件句柄就不再有效。调用者使用它会导致未定义的行为。

虽然从模块化的角度来看这可能不是最好的主意，但您可以让文件保持打开状态，然后返回句柄。但我认为以下之一可能会更好：

*   将打开的文件句柄传递给函数（让调用者打开和关闭它）。
*   让调用者自己再次打开文件。

考虑到操作系统的文件缓存（如果在此处适用）时，第一个选项可能更有效。

# c - 我在比较什么类型的数据？

> ID：13713607
> 
> 赞同：0
> 
> 时间：2012-12-04T23:07:45.607
> 
> 标签：c, stack, compare

我必须检查s1和s2的顶牌。s1 是一摞牌，s2 也是。我已经拥有的 stack_top 函数如下：

```
/* Retrive data from the top of the stack */
node_data stack_top(stack *s){
  if(!stack_empty(s)){      /* If the stack is not empty */
    return (s->top->data);  /* Return the data */
  }
  else{             /* Otherwise there is an error */
    cardlist_error("stack_top called on empty stack");
  }
} 
```

我有

```
while (strcmp (stack_top(s1), stack_top(s2)) ==0 )
//then do the following.. 
```

但我有一个`segmentation fault`，我应该如何比较它们 2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:16:09.527

如果要检查两个`stack`指针​​是否都指向同一个实例，只需检查它们的地址是否匹配`s1 == s2`。

如果要检查两个`stack`指针​​是否都保存相同的数据并且结构只有非指针成员，可以检查`memcmp(s1, s2, sizeof(*s1)) == 0`.

如果您想检查两个`stack`指针​​是否都保存相同的数据并且结构具有指针（例如字符串），您可能需要编写一个函数，通过依次比较它们的每个成员来比较两个实例。

# mysql - MySql.Data.dll 中的 System.OverflowException

> ID：13713609
> 
> 赞同：0
> 
> 时间：2012-12-04T23:07:46.463
> 
> 标签：mysql, vb.net

我正在尝试连接到 VB.Net 2010 中的 MySQL 数据库，这里的问题是在我们更改服务器之前相同的代码可以正常工作。这是代码：

```
 Private Function Validar_Acceso(ByVal sUsuario As String, ByVal sContrasena As String, ByRef sResultado As String) As Boolean
    Dim bRetorno As Boolean
    Dim query As String = "SELECT * FROM Usuario WHERE usuario LIKE '" & sUsuario & "'"
    Dim MySqlConn As New MySqlConnection("Server=; Uid=; Pwd=; Database=RepMasivos; Port=3306;")

    Try
        MySqlConn.Open() 'HERE IS THE System.OverflowException

        Dim dbCommand As MySqlCommand = MySqlConn.CreateCommand()
        dbCommand.CommandText = query
        Dim dbReader As MySqlDataReader = dbCommand.ExecuteReader()
        If dbReader.Read() Then

            If dbReader("password") = getMD5Hash(sContrasena) Then
                sResultado = dbReader("usuario")
                bRetorno = True
            End If
        End If

    Catch ex As Exception
        sResultado = ex.Message
    Finally
        If MySqlConn IsNot Nothing Then
            MySqlConn.Close()
        End If
    End Try
    Return bRetorno

End Function 
```

这是返回错误：La operación aritmética ha provocado un desbordamiento。

谢谢！

# sql - 如何使用 PK 和 FK 从上次交易中获取先前的值

> ID：13713612
> 
> 赞同：2
> 
> 时间：2012-12-04T23:08:11.550
> 
> 标签：sql, tsql, union

我有这个 SQL 查询，

```
SELECT PaymentID, CustomerID, PaymentDate, Amount, Balance, Credit 
FROM Payment 
WHERE (PaymentDate = '2012-11-03') 
```

我还喜欢打印客户上次交易的余额和信用表格。
这是我的尝试。

```
SELECT DISTINCT TOP 1 Balance, Credit, PaymentID 
FROM Payment 
WHERE CustomerID = '??' AND PaymentID < '??'
ORDER BY PaymentID DESC 
```

如您所见，这没有任何作用，因为不喜欢查询。我想我必须使用 T-SQL 或 UNION 但不知道如何实现它。

### 我试图实现的这种输出。

![在此处输入图像描述](../Images/db61f3d3ac83580441991a0b9929322a.png)

### 付款表

```
PaymentID   int 
CustomerID  varchar(50)
PaymentDate date
Amount  decimal(18, 2)
Balance     decimal(18, 2)
Credit  decimal(18, 2) 
```

### 笔记：

这不仅适用于单个客户，还适用于所有客户，就像销售报告一样。每位客户一天内可以进行多次付款。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:17:15.527

这可能会让你开始

```
SELECT P1.paymentID, P1.CustomerID, P1.PaymentDate, max(PP.paymentID)
FROM Payment P1 
Join Payment PP 
  on PP.paymentID < P1.paymentID 
 and PP.CustomerID = P1.CustomerID
 and P1.PaymentDate = '2012-11-03'
GroupBy P1.paymentID, P1.CustomerID, P1.PaymentDate

not test but I think this will pull in the other data

select PC.*, PL.PaymentDate,  PL.Amount,  PL.Balance,  PL.Credit 
from 
(SELECT P1.paymentID, P1.CustomerID, P1.PaymentDate, max(PP.paymentID) as PriorPID
FROM Payment P1 
Join Payment PP 
  on PP.paymentID < P1.paymentID 
 and PP.CustomerID = P1.CustomerID
 and P1.PaymentDate = '2012-11-03'
GroupBy P1.paymentID, P1.CustomerID, P1.PaymentDate) as PC 
join Payment PL 
  on PL.paymentID = PC.PriorPID 
 and PL.CustomerID = PC.CustomerID 
```

# excel - Excel公式获取一行中的最后一个条目

> ID：13713615
> 
> 赞同：0
> 
> 时间：2012-12-04T23:08:22.593
> 
> 标签：excel, excel-formula

我有一个工作表，其中每一行都以字符串标识符开头，然后是自工作表创建以来每周的一系列值：

```
XXX    15    20    25
YYY    11    15    19
ZZZ    18    22    22 
```

在另一张纸上，我想从第一页（不是全部）中获取一些字符串标识符，并且只有该项目的最新值：

```
XXX    25
ZZZ    22 
```

我实际上想要多张第二种纸，每个字符串 id 可能出现在不止一张纸上。

我不能使用 VBA，因为必须在我的 Windows Phone 7 上查看（以及添加和更改的值）（我不相信移动版本的 excel 支持 VBA，但如果我错了，请纠正我）。有没有一个公式可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:18:34.320

ROW 范围内最后一个非空白单元格的值

```
=LOOKUP(2,1/(A1:M1<>""),A1:M1) 
```

1.  在您的主表上，您应该指定一个隐藏列，如 ZZ 以包含公式：`=LOOKUP(2,1/(A1:ZY1<>""),A1:ZY1)`这将在 ZZ 列中放入该特定行的所有 LAST 值
2.  在依赖于您的主表的所有其他表上，您可以使用 vlookup 从主表中检索 ZZ 中的信息

# ruby-on-rails - 条件逻辑的问题 - Ruby on Rails

> ID：13713622
> 
> 赞同：0
> 
> 时间：2012-12-04T23:08:59.047
> 
> 标签：ruby-on-rails, ruby

我对 Ruby 的一些条件逻辑有疑问。诚然，我是所有 Ruby 的新手。

此代码导致网站无法加载：

```
<body style="background-image:url("<%= if @is_home_page.present? '/images/bg-main-power-bg.jpg' else '/images/bg-inner-power-bg.jpg' end %>"); background-repeat:repeat-x;"> 
```

没有条件的 CSS 加载就好了。

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:12:41.347

对内联条件使用三元运算符。

```
condition ? branch_a : branch_b

a == b ? "foo" : "bar"
# is the same as
if a == b
  "foo"
else
  "bar"
end 
```

对于您的具体情况：

```
@is_home_page ? '/images/bg-main-power-bg.jpg' : '/images/bg-inner-power-bg.jpg' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:33:15.463

您的原始代码：您可能遇到的错误可能是由于`"`此代码段中的第二个`"background-image:url("<%= ...`。尝试更改它，以便`<%= ... %>`在单引号内，而不是双引号内，因为整个字符串已经由双引号分隔。

理想情况下，您应该努力：

*   从视图中删除逻辑
*   避免内联样式。

所以：

一些.html.erb

```
<body class='<%= body_class %>'> 
```

some_helper.rb

```
class SomeHelper
  def body_class
    @is_home_page.present? ? "has_homepage" : "no_homepage"
  end
end 
```

一些.css：

```
body.has_homepage
  background-image:url('/images/bg-main-power-bg.jpg')
  .......
body.no_homepage
  background-image:url(/images/bg-inner-power-bg.jpg')
  ....... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T23:26:13.823

您也可以考虑将其移至帮助文件。您可以将以下内容添加到`app/helpers/application_helper.rb`

```
def bg_path
  return '/images/bg-main-power-bg.jpg' if current_page? root_path
  '/images/bg-inner-power-bg.jpg'
end 
```

这使您的视图更清晰。

```
<body style="background-image:url("<%= bg_path %>"); background-repeat:repeat-x;"> 
```

阅读：[http ://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-current_page-3F](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-current_page-3F)

# c++ - cv::Mat 类是否存在设计缺陷？

> ID：13713625
> 
> 赞同：19
> 
> 时间：2012-12-04T23:09:31.803
> 
> 标签：c++, oop, opencv, resources

我使用 OpenCV C++ 接口做了很多工作，并设计了许多使用 Mat 作为私有资源的类。

最近，我开始关注 Mat 类，因为它总是使用图像数据作为共享资源，除非我明确调用 clone。**即使我写`const Mat`了，我也不能确定图像数据以后不会从外部改变。**

所以我需要克隆以确保封装。但是需要显式克隆一个 Mat 的问题是它通常是不必要且昂贵的。另一方面，我知道对共享图像数据的需求源于 roi 选择器，并且能够编写如下内容： `Mat m_small = m_big(my_roi)`.

我的问题是：

1.) **cv::Mat 类不应该被懒惰地克隆吗？**因此，用户不会从外部将 Mat 视为共享资源处理程序。`SharedMat`当需要真正的共享图像数据时，用户不应该显式地实例化一个类吗？2.)在将 cv::Mat 作为类的私有资源的情况下，
您有什么**比总是克隆更好的策略吗？**

* * *

`Mat::clone()` 更新：“除非您打算修改数据，否则不要使用。” (by Vadim Pisarevsky)
*这个想法有问题。* 考虑你有这个类的情况：

```
class Res_handler{
public:
  const Mat emit_mat(){ return m_treasure; } // I argue you are compelled to clone here.
private:
  Mat m_treasure;
}; 
```

如果你`clone`在这种情况下不这样做，你可以写

```
Mat m_pirate = res_handler.emit_mat(); m_pirate = Scalar(0,0,0); 
```

这通过和之间的共享图像数据导致`m_treasure`内部完全停电。:) 所以为了避免意外修改内部，*你需要**它*。`res_handler``m_pirate``m_treasure``m_treasure`*`clone`*

另一方面，这个解决方案也有缺陷：

```
const Mat m_pirate = res_handler.emit_mat(); 
```

因为`m_treasure`也可以修改，所以`m_pirate`后台修改的内容，让盗版的程序员很头疼。:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-04T23:36:56.407

是的，这是一个糟糕的设计。因为`Mat`在内部实现了共享所有权，所以它与选择所有权策略的标准方式，即智能指针不兼容。基本问题是数据和所有权是正交的，应该分开。

因为它是可变的，所以甚至 a`const Mat`更像是 a `const shared_ptr<Mat>`，无法描述所包含的内容`Mat`应该是可变的，即`shared_ptr<const Mat>`。`final`如果您熟悉的话，这与 Java 中的问题非常相似。

我相信你可以通过包装`Mat`一个类来解决这些问题，该类公开与 相同的接口`Mat`，但在默认共享实现之上实现写时复制行为。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-05T08:10:57.557

***[无耻广告]**我们现在有了 answers.opencv.org，这是一种针对 OpenCV 特定问题的 StackOverflow。*

现在的问题：

1.  不，我们没有看到一种有效的方法来实现这一点。如果你这样做，让我们讨论一下。

2.  是的。`Mat::clone()`除非您打算修改数据，否则请勿使用。引用计数负责在不再使用数据时对数据进行适当的释放。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-02T11:37:30.790

要回答 OP 问题：

是的，绝对是！正如一些人指出的那样：*OpenCV 使您无法描述对图像的 const 引用*。这确实是一个缺陷。“const cv::Mat&”不是 C++ 程序员所期望的，我经常发现自己在我的代码中到处调用 clone()，以至于我失去了数据共享的好处。

要回答 Vadims 如何有效地做到这一点的问题：

绝对有可能有效地做到这一点，尽管并非没有 API 更改。看看 Qt 如何成功地放弃了它在 Qt 4 之前的**显式共享**模型（类似于 OpenCV 的当前模型）到它当前的**隐式共享**（写入时复制）。基本上所有改变对象的函数调用，或者返回一个以后可能改变对象的引用都必须“deref”它。如果有多个参考，那就制作一份副本。

与图像操作的平均成本相比，这样做的成本微不足道。如果必须按像素执行，它只会变得令人望而却步。这就是为什么类需要分成两个。很像 cv::Mat 和 cv::Mat_。一种负责隐式共享和复制，另一种只是 IplImage 的模板包装器。下面是 API 的示例**（**为了清楚起见，我选择了过于明确的名称）：

```
// The following makes no unnecessary copies. Only a 
// couple of atomic increments and decrements.
const cv::Image img = cv::Image("lenna.bmp").toGray().brighter(0.3).inverted();

cv::Image copy(img);// Still no deep copy.

cv::ConstImageRef<char> src = img.constRef<char>();// Still no deep copy.

// This is where the copy(detach) happens.
// "img" is left untouched
cv::MutableImageRef<char> dst = copy.ref<char>();

// The following is as efficient as it has ever been.
for(int y = 0; y<dst.height(); y++)
    for(int x = 0; x<dst.width(); x++)
        dst.at(x, y) += src.at(x, y); 
```

我意识到有太多的 OpenCV 代码浮动，无法进行任何根本性的更改，并且使用 OpenCV 3 进行 API 更改的窗口已关闭，但我不明白为什么不能添加新的改进接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T21:17:00.877

添加和扩展 Vadim 的答案，这里有一些关于这个话题的想法。

我还以多种方式广泛使用了 cv::Mat，并享受了它的好处。

编程中的一个普遍事实是，您必须平衡项目的不同相反需求。其中之一是性能与可维护性。并且通过“过早的优化是邪恶的”一劳永逸地解决了这个问题。这种方法很棒，但是很多程序员只是盲目地遵循它。

对于图像处理，性能至关重要。没有它，许多项目根本不可行。因此，在处理图像时进行优化永远不会为时过早。它是为数不多的以毫秒计的领域之一，您所做的一切都是通过质量和速度来衡量的。而且，如果您来自 C#、Java 或用户界面设计，可能很难消化它，但是为了提高速度，牺牲一些面向对象设计的既定实践是值得的。

如果您浏览 OpenCV 的源代码，您会看到对优化的难以置信的强调：基于 SSE 的函数、NEON 函数、指针技巧、各种算法奇观、图形处理器实现、OpenCL 实现、查找表等等在其他类型的项目中，这将被视为矫枉过正、难以维护或“过早优化”。

应用架构中的一个小改动（如 cv::Mat 分配策略）在性能方面会产生非常大的影响。在嵌入式设备上共享图像而不是克隆可能会在一个伟大的小工具和一个死胡同的概念验证之间产生差异。

因此，当 Vadim 说他们没有看到实施您建议的更改的有效方法时，他建议这些更改的性能损失不会涵盖收益。

**这样的**项目更难编写和维护，但它是好的。通常，成像项目的困难部分是编写正确的算法。封装它只是最后 1% 的工作。

# events - Symfony2 DoctrineExtensions preSoftDelete 事件调用

> ID：13713627
> 
> 赞同：3
> 
> 时间：2012-12-04T23:09:39.140
> 
> 标签：events, symfony, doctrine

我在为 Symfony2 实现 L3pp4ard DoctrineExtensions Bundle 中的 preSoftDelete 事件时遇到问题。softDelete 函数工作得很好，但我想在 deletedAt （日期时间）旁边添加一个 deletedBy （用户 ID）。为此，我想听被称为 (preSoftDelete) 的事件，但我无法让它工作。`

（应该）调用事件的文件可以在[github](https://github.com/l3pp4rd/DoctrineExtensions/blob/master/lib/Gedmo/SoftDeleteable/SoftDeleteableListener.php)找到。我已确认此脚本运行。

我已经在 config.yml 中添加了一项服务：

```
utwente.idbbundle.presoftdelete:
  class: Utwente\IdbBundle\EventListener\UtwenteIdbSoftDeleteListener
  tags: 
    - { name: gedmo.listener.softdeleteable, event: preSoftDelete, method: onPreSoftDelete } 
```

我已经制作了应该做某事的类/方法。现在它回显你好，并停止脚本执行（用于测试）。

```
<?php    
namespace Utwente\IdbBundle\EventListener;

class UtwenteIdbSoftDeleteListener {
  public function onPreSoftDelete(LifecycleEventArgs $args){
    echo "Hoi";
    die();
  }
}
?> 
```

但它不起作用。有任何想法吗？

（当我使用时它确实有效`name: kernel.event_listener, event: kernel.request`，并且`LifecycleEventArgs $args`省略了）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T20:00:36.487

使用

```
tags: 
      - { name: doctrine.event_listener, event: preSoftDelete, connection: default } 
```

答案是……

# java - 解决方法：如何以编程方式编辑原生谷歌文档？

> ID：13713630
> 
> 赞同：2
> 
> 时间：2012-12-04T23:09:52.197
> 
> 标签：java, google-app-engine, google-apps-script, google-drive-api

我在这里发现很少有令人沮丧的 QA 提到无法在 Google Drive API 中以编程方式修改 Google 文档 - 只有上传/下载选项。

我检查了那些类似的主题：

1)[如何以编程方式操作原生 google doc 文件](https://stackoverflow.com/questions/11578020/how-to-programmatically-manipulate-native-google-doc-files)

2)[如何以编程方式在 Google Docs 中创建文档？](https://stackoverflow.com/questions/2704902/how-do-you-create-a-document-in-google-docs-programmatically)

我想我们不能直接下载和上传原生谷歌文档格式。有没有其他方法可以解决这个要求？

**有没有人试图在选定的文档上以编程方式触发谷歌应用脚​​本，这可能吗？是否可以使用输入中的一些参数以编程方式启动 google app 脚本？**

我只需要替换本机谷歌文档中的几段文本，但我不能使用下载->修改->上传（例如使用 word/html/pdf 格式）流程，因为我会破坏图片、边框等的格式... （客户要求：完全谷歌集成，没有专有格式）

您有什么值得探索的创新想法或技巧吗？

*我们正在尝试将 Google Drive 用作某种非常简单的模板系统（大约有数千个用户，数百个 google 文档），但这似乎是一个非常错误的想法，因为这样做有很多限制。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:32:57.223

您不能使用 Drive API 以编程方式管理 Google 文档的内容，但您可以使用 Apps 脚本中的文档服务来执行文本替换和其他编辑：

[https://developers.google.com/apps-script/service_document](https://developers.google.com/apps-script/service_document)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T03:57:09.740

我们调用部署在与 webapp 相同域上的 google app 脚本，该脚本会在我们将文档内容下载为专有格式之前更改它们的内容。我们只是替换了几个没有复杂的字符串。

此解决方案有效，但有点脆弱（您必须在一个域中安装 g app 脚本 + google app engine 应用程序），我们不确定触发脚本后更改的传播速度有多快，因此我们总是等待一小段时间，例如 10 秒在我们尝试下载修改后的文档之前。

重要的缺点是您不能从 localhost 调用 GScript，因此开发速度有点慢，因为我们每次都必须将我们的应用程序上传到谷歌应用程序引擎中。

# objective-c - 如何在objective-c中的子视图上制作类似溢出：隐藏在CSS中的东西？

> ID：13713631
> 
> 赞同：1
> 
> 时间：2012-12-04T23:09:57.320
> 
> 标签：objective-c, view, visibility, xib

我在 XIB 中看到了开始 43 像素高度的视图。此视图的 UIImage 低于 43 像素高度（位置 0、44）。当我点击视图时，它会增长并且它的高度是 187 并且图像被加载并且可见。当我第二次点击视图时，视图的高度为 43 像素，但此视图上的图像仍然可见（y = 43 之后的内容可见）。是否可以隐藏高于 43 像素高度的内容？（看不见）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:23:12.387

好的，我解决了！

答案是：

```
 [self setClipsToBounds:YES]; 
```

# php - 删除 PHP 中 URL 的最后一个与号之后的链接

> ID：13713637
> 
> 赞同：0
> 
> 时间：2012-12-04T23:10:17.240
> 
> 标签：php, url

所以我认为拆分不再好或应该避免。

有没有办法删除最后一个＆符号和链接的其余部分。

之前的链接： [http ://www.websitehere.com/subdir?var=somevariable&someotherstuff&textiwanttoremove](http://www.websitehere.com/subdir?var=somevariable&someotherstuff&textiwanttoremove)

链接后： [http ://www.websitehere.com/subdir?var=somevariable&someotherstuff](http://www.websitehere.com/subdir?var=somevariable&someotherstuff)

现在我正在使用这个脚本：

```
<?php
    $name = http_build_query($_GET);
    // which you would then may want to strip away the first 'name='
    $name = substr($name, strlen('name='));
    //change link to a nice URL
    $url = rawurldecode($name);
?>

<?php echo "$url"; ?> 
```

它需要整个 URL（包括所有与符号）...问题是，链接来自的站点添加了一个返回值 &RETURNVALUEHERE，我需要删除最后一个“&”和它后面的其余文本。

谢谢！

罗布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:21:21.177

使用`substr`和`strrpos`

```
$url = substr($url, 0, strrpos($url, '&')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:17:22.973

如果您的输入已经是 $_GET，则删除最后一个值对可能只是这样：

```
http_build_query(array_slice($_GET, 0, -1)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:21:03.227

你可以使用`strrpos()`喜欢

```
$url = substr($orig_url, 0, strrpos($orig_url, "&")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T23:22:36.613

在不知道真实 URL 的情况下，我能够想出这个：

```
<?php

// The string:
$string = "http://www.websitehere.com/subdir?var=somevariable&someotherstuff&textiwanttoremove";

// get the position of the last "&"
$lastPos = strrpos($string, "&");

// echo out the final string:
echo substr($string, 0, $lastPos); 
```

# c# - 灯开关 VIN 自定义验证

> ID：13713639
> 
> 赞同：1
> 
> 时间：2012-12-04T23:10:32.360
> 
> 标签：c#, silverlight, visual-studio-lightswitch

我正在构建一些自定义验证来验证小型 LightSitch 应用程序中的车辆识别号 (VIN)。自定义验证在大多数情况下非常简单，但我使用的代码类似于下面从 Rusty Davis 的帖子中复制的代码： http: [//shapemetrics.wordpress.com/2010/08/23/vin-validation/](http://shapemetrics.wordpress.com/2010/08/23/vin-validation/) .

```
public class VIN
    {
        //Make sure no instance of this class is created... only method is static. 
        private VIN() { }

        public static bool IsValidVin(string p_strVin)
        {
            bool blnIsValid = false;
            int intValue = 0;
            int[] intWeights = { 8, 7, 6, 5, 4, 3, 2, 10, 0, 9, 8, 7, 6, 5, 4, 3, 2 };

            if (p_strVin == null)
            {
                return false;
            }
            else if (p_strVin.Length != 17)
            {
                return blnIsValid;
            }

            p_strVin = p_strVin.ToUpper().Trim();
            int intCheckValue = 0;
            char check = p_strVin[8];
            char year = p_strVin[9];

            if (!char.IsDigit(check) && check != 'X')
            {
                return blnIsValid;
            }
            else
            {
                if (check != 'X')
                {
                    char[] d = new char[] { check };
                    intCheckValue = int.Parse(Encoding.ASCII.GetString(Encoding.ASCII.GetBytes(d)));
                }
                else
                {
                    intCheckValue = 10;
                }
            }

            Hashtable replaceValues = new Hashtable();
            replaceValues.Add('A', 1);
            replaceValues.Add('B', 2);
            replaceValues.Add('C', 3);
            replaceValues.Add('D', 4);
            replaceValues.Add('E', 5);
            replaceValues.Add('F', 6);
            replaceValues.Add('G', 7);
            replaceValues.Add('H', 8);
            replaceValues.Add('J', 1);
            replaceValues.Add('K', 2);
            replaceValues.Add('L', 3);
            replaceValues.Add('M', 4);
            replaceValues.Add('N', 5);
            replaceValues.Add('P', 7);
            replaceValues.Add('R', 9);
            replaceValues.Add('S', 2);
            replaceValues.Add('T', 3);
            replaceValues.Add('U', 4);
            replaceValues.Add('V', 5);
            replaceValues.Add('W', 6);
            replaceValues.Add('X', 7);
            replaceValues.Add('Y', 8);
            replaceValues.Add('Z', 9);
            replaceValues.Add('1', 1);
            replaceValues.Add('2', 2);
            replaceValues.Add('3', 3);
            replaceValues.Add('4', 4);
            replaceValues.Add('5', 5);
            replaceValues.Add('6', 6);
            replaceValues.Add('7', 7);
            replaceValues.Add('8', 8);
            replaceValues.Add('9', 9);
            replaceValues.Add('0', 0);

            //Make sure it is a Valid Year 
            if (!replaceValues.Contains(year) && year != '0')
            {
                return blnIsValid;
            }

            //Make sure characters that are in the VIN are the ones allowed. 
            for (int i = 0; i < p_strVin.Length; i++)
            {
                if (!replaceValues.Contains(p_strVin[i]))
                {
                    return false;
                }
                intValue += (intWeights[i] * ((int)replaceValues[p_strVin[i]]));
            }

            if ((intValue % 11) == intCheckValue)
            {
                blnIsValid = true;
            }

            return blnIsValid;
        }
    } 
```

我遇到的问题是 Visual Studio 告诉我“'System.Text.Encoding' 不包含 'ASCII' 的定义”。它还说找不到类型或命名空间“Hashtable”。

这些在 LightSwitch 项目中不可用吗？我有所有正确的 using 语句。我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T03:10:40.590

由于 Lightswitch 是 Silverlight 应用程序，因此 ascii 编码不可用，[请参阅此链接。](https://stackoverflow.com/questions/10010840/encoding-ascii-not-available-in-silverlight-is-there-a-alternative)它建议您尝试`Encoding.UTF8`改用。

至于 Hashtable，Silverlight 也不支持它。另一种方法是`Dictionary <Tkey, TValue>`改用。[请参阅此链接。](https://stackoverflow.com/questions/5011149/need-hashtable-and-arraylist)

更新后的代码如下所示（未经测试的代码）：

```
 bool blnIsValid = false;
        int intValue = 0;
        int[] intWeights = { 8, 7, 6, 5, 4, 3, 2, 10, 0, 9, 8, 7, 6, 5, 4, 3, 2 };

        if (p_strVin == null)
        {
            return false;
        }
        else if (p_strVin.Length != 17)
        {
            return blnIsValid;
        }

        p_strVin = p_strVin.ToUpper().Trim();
        int intCheckValue = 0;
        char check = p_strVin[8];
        char year = p_strVin[9];

        if (!char.IsDigit(check) && check != 'X')
        {
            return blnIsValid;
        }
        else
        {
            if (check != 'X')
            {
                char[] d = new char[] { check };
                var bytes = Encoding.UTF8.GetBytes(d);
                intCheckValue = int.Parse(Encoding.UTF8.GetString(bytes, 0, bytes.Length));
            }
            else
            {
                intCheckValue = 10;
            }
        }

        Dictionary<char, int> replaceValues = new Dictionary<char, int>();
        replaceValues.Add('A', 1);
        replaceValues.Add('B', 2);
        replaceValues.Add('C', 3);
        replaceValues.Add('D', 4);
        replaceValues.Add('E', 5);
        replaceValues.Add('F', 6);
        replaceValues.Add('G', 7);
        replaceValues.Add('H', 8);
        replaceValues.Add('J', 1);
        replaceValues.Add('K', 2);
        replaceValues.Add('L', 3);
        replaceValues.Add('M', 4);
        replaceValues.Add('N', 5);
        replaceValues.Add('P', 7);
        replaceValues.Add('R', 9);
        replaceValues.Add('S', 2);
        replaceValues.Add('T', 3);
        replaceValues.Add('U', 4);
        replaceValues.Add('V', 5);
        replaceValues.Add('W', 6);
        replaceValues.Add('X', 7);
        replaceValues.Add('Y', 8);
        replaceValues.Add('Z', 9);
        replaceValues.Add('1', 1);
        replaceValues.Add('2', 2);
        replaceValues.Add('3', 3);
        replaceValues.Add('4', 4);
        replaceValues.Add('5', 5);
        replaceValues.Add('6', 6);
        replaceValues.Add('7', 7);
        replaceValues.Add('8', 8);
        replaceValues.Add('9', 9);
        replaceValues.Add('0', 0);

        //Make sure it is a Valid Year 
        if (!replaceValues.ContainsKey(year) && year != '0')
        {
            return blnIsValid;
        }

        //Make sure characters that are in the VIN are the ones allowed. 
        for (int i = 0; i < p_strVin.Length; i++)
        {
            if (!replaceValues.ContainsKey(p_strVin[i]))
            {
                return false;
            }
            intValue += (intWeights[i] * ((int)replaceValues[p_strVin[i]]));
        }

        if ((intValue % 11) == intCheckValue)
        {
            blnIsValid = true;
        }

        return blnIsValid; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T18:02:54.220

您可能还想查看更新版本的代码。你在那里的那个给出了一个基本的布尔答案。

相反，网站上有另一个反映更详细信息的信息：http: [//shapemetrics.wordpress.com/2011/12/05/vin-validate-improved](http://shapemetrics.wordpress.com/2011/12/05/vin-validate-improved)

# c# - 动态规划：修改后的背包

> ID：13713641
> 
> 赞同：2
> 
> 时间：2012-12-04T23:10:35.340
> 
> 标签：c#, floating, knapsack-problem

我正在尝试使用动态编程解决背包问题的变体：

所以我所拥有的是一个具有尺寸的正方形区域：N*N（就像一个棋盘）。在每个方格上，我都有一些值。我能做的是在正方形的值上加一（+1）或删除一（-1）。有一个特殊的规则，如果有相邻的正方形（有共同边的正方形 - 对角线正方形不计算在内）的值等于正方形的新值，则设置所有这些相邻正方形的值归零

目标是尽可能减少所有方格的总值。

例如，如果我有一个 3x3 矩阵，代表一个 3*3 正方形的字段，那么我们可以有这样的东西：

```
int[3,3] 字段 = { 1, 2, 3,
                   5, 1, 6,
                   7, 3, 9 }

```

现在，如果我将值为 2 的元素 [0, 1] 减少一个，那么所有元素 [0, 0] [0, 1] 和 [1, 1] 都会将它们的值设置为 0。

所以到目前为止，基本上我所做的就是对每个方格的每个动作以及动作的深度进行评分（这意味着如果一个动作在一个方格上重复多次，我已经计算了评分）并且我将这些评分保存在四个维数组，`ratings[action, depth, row, col]`。

等级表示平方的总值将减少的数量。

我想要的是找到从字段中删除尽可能多的值的最佳操作顺序。这必须在预定义数量的动作中发生（或者有定义的回合数，我每回合只能做一个动作）。最后一点很明显，我必须从正方形的评级中找出深度子集的哪个组合会给我最高的总评级。

首先，我认为这可以通过子集总和问题来完成，然后通过它们的评级对收到的项目列表进行排序，但之后我意识到这可以通过背包问题来实现，除了评级相互依赖，这里是我的问题来了。例如，如果有一个方块改变了它的值，那么它的相邻方块可能会自动改变它们的评级。我可以写一个方法来检查广场的邻居是否会在行动后改变他们的评级，但这不是让我烦恼的事情。让我担心的是如何通过改变值（正方形的评级）来实现背包问题？

总结一下我到目前为止所拥有的：

*   我有一个定义的转数（动作）C - 可以表示为矩阵的最大权重
*   我有每个方块的动作深度（从 1 到 C） - 可以表示为每个项目的权重
*   我对所有平方（非负整数）都有评级 - 可以表示为项目的值。

对我来说，主要问题是要放入背包的物品的价值可能会根据保留的物品而改变。

我不得不承认我不是从头开始编写我的背包算法，而是我使用了一个已经编写好的算法并根据我的需要对其进行了转换。我从这里得到算法： http: [//sriwantha.blogspot.com/2011/07/knapsack-problem-in-c.html](http://sriwantha.blogspot.com/2011/07/knapsack-problem-in-c.html)

这是我的代码：

```
//Knapsack problem:

//class for the items in the knapsack
public class Item 
{
    public int row;
    public int col;
    public int action;
    public int depth;
    public int rating;
    public Item(int row, int col, int action, int depth, int rating)
    {
        this.row = row;
        this.col = col;
        this.action = action;
        this.depth = depth;
        this.rating = rating;
    }

    public override string ToString()
    {
        return "row,col,action=" + row + "," + col + "," + action + ", depth=" + depth + ", rating=" + rating;
    }
}

class KnapSackProblem
{
    public static List<Item> FindItemsToPack(List<Item> items, int depthCapacity, out int totalRatingValue)
    {
        int[,] ratings = new int[items.Count + 1, depthCapacity + 1];
        bool[,] keep = new bool[items.Count + 1, depthCapacity + 1];

        for (int i = 1; i <= items.Count; i++)
        {
            Item currentItem = items[i - 1];
            for (int depth = 1; depth <= depthCapacity; depth++)
            {
                if (depth >= currentItem.depth)
                {
                    int remainingDepth = depth - currentItem.depth;
                    int remainingDepthRating = 0;
                    if (remainingDepth > 0)
                    {
                        remainingDepthRating = ratings[i - 1, remainingDepth];
                    }
                    int currentItemTotalRating = currentItem.rating + remainingDepthRating;
                    if (currentItemTotalRating > ratings[i - 1, depth])
                    {
                        keep[i, depth] = true;
                        ratings[i, depth] = currentItemTotalRating;
                    }
                    else
                    {
                        keep[i, depth] = false;
                        ratings[i, depth] = ratings[i - 1, depth];
                    }
                }
            }
        }

        List<Item> itemsToBePacked = new List<Item>();

        int remainDepth = depthCapacity;
        int item = items.Count;
        while (item > 0)
        {
            bool toBePacked = keep[item, remainDepth];
            if (toBePacked)
            {
                itemsToBePacked.Add(items[item - 1]);
                remainDepth = remainDepth - items[item - 1].depth;
            }
            item--;
        }

        totalRatingValue = ratings[items.Count, depthCapacity];
        return itemsToBePacked;
    }
} 
```

从另一种方法我调用背包算法：

```
List<Item> actionsToDo = new List<Item>();
Item newItemTake;
Item newItemAdd;

for (int depth = 0; depth < maxDepth; depth++)
    {
    for (int row = 0; row < dimension; row++)
    {
        for (int col = 0; col < dimension; col++)
        {
            if (ratings[Take, depth, row, col] >= 0)
            {
                newItemTake = new Item(row, col, Take, depth + 1, ratings[Take, depth, row, col]);
                actionsToDo.Add(newItemTake);
            }
            if (ratings[Add, depth, row, col] >= 0)
            {
                newItemAdd = new Item(row, col, Add, depth + 1, ratings[Add, depth, row, col]);
                actionsToDo.Add(newItemAdd);
            }
        }
    }
}

int totalRating = 0;

List<Item> itemsToBePacked = KnapSackProblem.FindItemsToPack(actionsToDo, maxDepth, out totalRating);

foreach (var item in itemsToBePacked)
{
    Console.WriteLine(item);
}
Console.WriteLine(totalRating); 
```

# android - Android SQlite 日期没有一年？

> ID：13713642
> 
> 赞同：0
> 
> 时间：2012-12-04T23:10:36.127
> 
> 标签：android, sqlite

在我的 Android 应用程序中，我试图根据日期从我的数据库中检索一个字符串。但我不想要日期中的年份（那样我只需要 365 行）。我让它工作的唯一方法是在我的数据库中，让日期列中的日期采用 yyyyMMdd 格式。如果我将“日期”列中的所有日期更改为 MMdd 格式，则两位数月份（如 10 月、11 月、12 月）有效，但单位数月份如 1 月或 9 月（01、09）会使应用程序崩溃与错误`CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0`。我已经在数据库中尝试了 MM-dd、yyyy-MM-dd 格式，但它们使应用程序因上面列出的错误而崩溃。在 Sqlite 数据库中是否不能仅使用 MMdd 格式化日期？有任何想法吗？

**主要活动：**

```
 DBT = new SimpleDateFormat("MMdd", Locale.US);
tMMddStr = DBT.format(new Date(System.currentTimeMillis()));

private void getTH() {

    dba.open();
    tArray = dba.getTHA(tMMddStr);
    dba.close();
    optionB_TV.setText(todayArray[2]);
    hideDayAtv.setText(todayArray[1]);
    hideYearAtv.setText(todayArray[0]);

} 
```

**数据库适配器：**

```
 public String[] getTHA(String tMMddStr) {   
    String[] columns = new String[] { KEY_Y, KEY_MD, KEY_HA };
    Cursor cursor = db.query(DB_TABLE, columns, KEY_DATE + "=" + tMMddStr,
            null, null, null, null);

    if (cursor != null) {
        cursor.moveToFirst();
        String hapT[] = new String[3];
        hapT[0] = cursor.getString(0);
        hapT[1] = cursor.getString(1);
        hapT[2] = cursor.getString(2);
        cursor.close();
        this.db.close();
        return hapT;
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:13:21.740

```
CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0 
```

此错误表示您正在尝试读取*空*光标，只需在尝试读取之前检查光标是否有任何数据：

```
if (cursor != null && cursor.moveToFirst()) { 
```

* * *

至于个位数月份问题，这可能与`KEY_DATE`列的数据类型有关。如果`KEY_DATE`是任何类型的数字，它将去掉第一个`0`. 尝试对`tMMddStr`.
（如果这没有帮助，请发布您的表 CREATE 语句和一些如何将数据放入数据库并将其拉出的示例。）

# android - StopSelf 不会停止我的服务

> ID：13713646
> 
> 赞同：20
> 
> 时间：2012-12-04T23:10:51.143
> 
> 标签：android, service

谷歌搜索，我已经多次看到这个问题，过去几年在这个论坛上的一些帖子。我从未见过有人得到直接的答案。

我有一个前台服务，它在运行 2 小时后尝试通过执行 this.StopSelf() 自行停止。我在绑定和未绑定时都试过了。在 AVD 和设备上。

它根本行不通。这是Android中的错误吗？（运行 2.3.3）。

服务如何自行停止？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-08-26T18:45:40.180

如果你使用前台服务，你应该调用：

[`stopForeground(true);`](http://developer.android.com/reference/android/app/Service.html#stopForeground%28boolean%29)

就像你开始它一样`startForeground`。

`stopSelf`旨在用于正常服务。前台服务很特别... :)

顺便说一句，如果您的应用应该在旧设备上运行，您应该检查[**此处**](http://developer.android.com/reference/android/app/Service.html#startForeground%28int,%20android.app.Notification%29)提供的兼容性代码。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-26T18:38:43.390

我发现确定停止服务的唯一方法是使用：

```
android.os.Process.killProcess(android.os.Process.myPid()); 
```

此行为可能是由于使用调用时尚未完成的工作线程造成的`stopSelf`。如果您正在使用工作线程，请**注意**如何使用它 - 如果您在执行该行之前不清理，您可能会泄漏内存。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-09-29T05:54:00.647

我遇到了类似的问题。通过搜索发现：在其他活动的onCreate方法中，我绑定了服务，但没有**取消绑定**onDestory方法。修复后，当我调用stopSelf时，调用服务的onDestory方法。我希望它可以帮助你。

同时，我从Android gover文档中找到了base。

> [服务既可以启动，也可以绑定连接。在这种情况下，只要服务已启动或有一个或多个使用 Context.BIND_AUTO_CREATE 标志的连接，系统就会保持服务运行。一旦这两种情况都不成立，就会调用服务的 onDestroy() 方法并有效地终止服务。从 onDestroy() 返回时，所有清理（停止线程、注销接收器）都应该完成。](https://developer.android.com/reference/android/app/Service.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-01T04:34:56.887

我有这个问题，搜索我找到了这个线程。我的应用程序的问题是，当服务调用 stopSelf() 时，绑定服务的前台活动仍在运行。调用了 stopSelf 但服务没有被破坏，因为前台活动仍然被绑定。当我通过按返回或转到主屏幕离开活动时，服务将被破坏。简而言之，当绑定前台活动时，stopSelf 将不起作用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-02-08T21:27:21.423

我也遇到了这个问题`selfStop()`。

要理解的主要思想是服务不会停止，

如果正在运行的循环仍在运行（`while(mDoWhile)`例如）。

或任何其他需要首先销毁/注销的问题。

所以要制作`stopSelf()`or`stopService(intent)`作品，

`onDestroy()`在您的服务中实施：

```
@Override
public void onDestroy()
{
    // Unregistered or disconnect what you need to
    // For example: mGoogleApiClient.disconnect();

    // Or break the while loop condition
    // mDoWhile = false;

    super.onDestroy();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-05T10:50:10.187

我也面临同样的问题。

众所周知，它`Service`运行在 App 的`UI Thread`. 因此，除非您`Thread`在服务的后台运行并且您正在调用`stopSelf()`它，否则它将无法正常工作。为此，您必须先停止该操作`Thread`，然后再执行`stopSelf()`.

`Thread`从您的`Service` `stopSelf()`方法中停止所有背景后，肯定会起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-04T14:00:01.070

我必须杀死前台服务的唯一方法是在清单中设置 stopwithtask=true

```
 <service
        android:name="my.package.MyForegroundService"
        android:foregroundServiceType="location"
        android:stopWithTask="true"
        android:permission="android.permission.BIND_NOTIFICATION_LISTENER_SERVICE">
    </service> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-22T01:03:01.217

如果你同时调用了 startService 和 bindService。你应该首先取消绑定服务，否则 stopSelf 将不起作用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-05-22T23:02:25.313

`stopSelf`如果条件不利，可能不会破坏服务，但您可以`stopService`使用应用程序上下文。但请确保在调用`stopService`内部服务之前服务不会重新启动。

```
stopService(applicationContext, MyService::class.java) 
```

# nuget - 在便携式库上安装 protobuf-net 时出现 nuget 错误

> ID：13713651
> 
> 赞同：5
> 
> 时间：2012-12-04T23:11:01.890
> 
> 标签：nuget, protobuf-net, portable-class-library

我正在尝试在可移植类库中安装 protobuf-net (2.0.0.602)，但我似乎无法让它工作。我收到此错误：

```
PM> install-package protobuf-net
'protobuf-net 2.0.0.602' already installed.
install-package : Could not install package 'protobuf-net 2.0.0.602'. You are trying to install this package into a project that targets '.NETPortable,Version=v4.0,Profile=Profile4', but 
the package does not contain any assembly references or content files that are compatible with that framework. For more information, contact the package author. 
```

检查它似乎针对portable-sl4 + wp71 + windows8的包，但是当我创建一个针对这些框架的vinalla项目时，我无法让它工作（上面列出了profile4，但我尝试了一些不同的来看看什么坚持）。我刚刚在工作室更新了 nuget。从包管理器控制台运行“nuget”会显示 nuget 版本为 2.1.31022.9038。

如果我浏览到包中的 protobuf-net.dll（在 lib\portable-sl4+wp71+windows8 下），它将允许我引用它，一切都很好。

我可以手动添加它，但我错过了一些明显的东西。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T09:57:48.617

这似乎只是对 nuget 配置的轻微调整；`portable-sl4+wp71+windows8`当我实际上需要指定时，我已经指定`portable-sl4+net4+wp7+windows8`包括常规 .NET。

这已在 2.0.0.611 中修复，该版本已推送到 NuGet。

# vb.net - 在 cmd 窗口中启动一个进程

> ID：13713659
> 
> 赞同：0
> 
> 时间：2012-12-04T23:11:51.287
> 
> 标签：vb.net

我必须在 cmd 窗口中启动一个进程。但是在所示的情况下，由于某些错误 cmd 窗口只是闪烁，我看不到会发生什么。如果 cmd 窗口在某些按键或类似操作之前一直打开，那将是最好的。

```
Dim q As String = Chr(34)
Dim p As New Process
With p.StartInfo
      .FileName = q & whereis7z & "\7z.exe" & q
      .Arguments = " e " & q & tempArch & fNameStr & q & " -y"
      .WindowStyle = ProcessWindowStyle.Normal
      .CreateNoWindow = False
      .WorkingDirectory = tempArch
       Debug.Print(.FileName & .Arguments)
End With
p.Start()
If p.ExitCode <> 0 Then
       MsgBox(p.ExitCode, MsgBoxStyle.Critical)
End If 
```

这里有什么方法可以让 cmd 窗口保持打开状态，直到按键来查看我的“StartInfo”有什么问题，因为“ExitCode”还不够。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:34:47.953

您应该直接执行 cmd.com 应用程序而不是您的程序。

如果您从开始菜单“cmd /k dir”尝试，您将收到目录列表并且窗口将保持打开状态。

我认为您必须在参数（参数）中传递您的应用程序

希望这有助于塞尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:36:34.470

或者，您可以重定向窗口的标准输出以捕获程序输出。

```
p.StartInfo.RedirectStandardOutput = True 
```

然后只需读入程序输出的内容，您就可以自己显示它，

```
Dim Output as String = p.StandardOutput.ReadToEnd 
```

# linq - 扩展基于 LINQ 的规范模式以实现包容

> ID：13713664
> 
> 赞同：4
> 
> 时间：2012-12-04T23:12:24.537
> 
> 标签：linq, boolean-logic, boolean-expression, linq-expressions, specification-pattern

复合规范模式有很多基于 LINQ 的实现。我还没有见过使用 Subsumption 的。

是否有任何此类示例已被记录（博客等）或作为开源发布？我有一个想法和概念证明，通过让 ExpressionVisitor 将每个规范转换为规范逻辑形式 (CNF/DNF) 来实现这一点，但我担心这过于复杂。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T20:12:16.087

> 我担心这过于复杂。有没有更好的办法？

简短的回答是“不，没有” ¹

长答案：“过于复杂”抓住了问题的本质：它是 NP 难的。这是一个简短的非正式证明，它依赖于[*可满足性问题*是 NP-complete](http://en.wikipedia.org/wiki/Boolean_satisfiability_problem)的事实：

*   假设您有两个布尔公式，`A`并且`B`
*   您需要测试 if`A`暗示`B`，或等效地测试和依赖`¬A | B`的所有变量分配。换句话说，您需要一个*重言式*的证明。`A``B``F = ¬A | B`
**   假设重言式检验可以在多项式时间内进行*   考虑`¬F`， 的倒数`F`。`F`是*可满足*的当且仅当`¬F`不是*重言式**   使用假设多项式算法测试`¬F`是否是重言式*   “`F`可满足”的答案与“是`¬F`重言式”的答案相反*   因此，多项式重言式检查器的存在意味着可满足性问题在`P`，并且`P=NP`。*

 *当然，问题是 NP-hard 的事实并不意味着对于实际情况没有解决方案：事实上，您转换为规范形式的方法可能会在许多现实世界的情况下产生良好的结果。然而，缺乏已知的“好”算法通常会阻碍实际解决方案的积极开发²。

* * *

¹带有强制性的“除非`P=NP`”免责声明。

²除非有一个“相当好的”解决方案，如果您允许“假阴性”，那么您的问题很可能就是这种情况。*

# azure - Azure VIP 交换到不同数量的端点

> ID：13713665
> 
> 赞同：0
> 
> 时间：2012-12-04T23:12:37.843
> 
> 标签：azure, azure-web-roles

我正在尝试用空的重定向项目替换托管服务，但是当我尝试这样做时，出现以下错误；

> *Windows Azure 无法在端点数量不同的部署之间执行 VIP 交换。*

我相信我唯一可用的解决方案如下；

1.  将 DNS 指向临时部署，在传播 48 小时后删除生产实例并将我的 DNS 更改为空重定向项目的新部署。
2.  删除生产实例，然后立即翻转 staging。这当然会导致停机。

不幸的是，在这个阶段更改 DNS 记录对我来说不是一个选项，所以除非有人能提出替代方案，否则我将不得不选择第 2 点。

虽然我唯一的查询是一旦我删除生产和翻转登台，新的生产实例是否会保留旧 IP，就像我上面所说的那样，我无法更改 DNS 记录。

谢谢，有任何疑问请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T04:12:22.893

我通过将额外的端点添加到通过另一个部署进行暂存来解决了这个问题。尽管应用程序永远不会使用它们，但它允许我在不停机的情况下进行部署。

我的问题中包含替代解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T00:30:49.390

删除生产槽中的当前部署后，应将 IP 地址分配回池（对您不可用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T11:05:52.013

为了省去重新部署的麻烦和额外的 15 分钟等待，

您可以在一分钟内删除 PRODCTION 插槽（如果适用！），然后您将从 PROD 进行 VIP 交换：Empty STAGING ：您的部署

“OK 删除了云服务od的生产部署...”

并最终拥有

“成功交换了云服务中的部署...”

文森特·塔沃内克姆

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-18T16:27:40.853

这通常是由于在一个插槽中启用了 RDP（远程桌面）而在另一个插槽中未启用。RDP 创建额外的端点，从而产生错误消息。您可以 (a) 在没有 RDP 的那个上启用 RDP，或者 (b) 在有它的那个上禁用 RDP。然后 VIP 交换应该可以工作。

# sql - 从 MS Access 或 SQL 中的字符串中删除字母数字

> ID：13713670
> 
> 赞同：2
> 
> 时间：2012-12-04T23:12:56.937
> 
> 标签：sql, ms-access

我在 MS Access 中有一个包含街道地址的列。我需要从例如第 21、第 32、第 33、第 44 中删除“st”、“nd”、“rd”和“th”......并保留数字......有什么想法我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:19:32.557

该`Val()`功能在这里可能很有用。它将从字符串中读取数字，直到遇到无法识别为数字一部分的字符。有关详细信息，请参阅帮助主题。

```
? Val("21st")
 21 
? Val("32nd")
 32 
? Val("33rd")
 33 
? Val("44th")
 44 
```

# http - 冒号是否需要在 URI 查询参数中进行编码？

> ID：13713671
> 
> 赞同：26
> 
> 时间：2012-12-04T23:12:58.730
> 
> 标签：http, url, web, uri, urlencode

我注意到 Java没有对包含在我的查询参数值（ISO 8601 格式的字符串）中`UriBuilder`的字符进行编码。`:`

根据维基百科，似乎应该对冒号进行编码。

> 特别是，对查询字符串进行编码使用以下规则：
> 
> *   字母（AZ 和 az）、数字 (0-9) 和字符 '.'、'-'、'~' 和 '_' 保持原样
> *   SPACE 编码为 '+' 或 %20[需要引用]
> *   所有其他字符都编码为 %FF 十六进制表示，任何非 ASCII 字符首先编码为 UTF-8（或其他指定的编码）

那么，有什么关系呢？查询参数中的冒号是否应该编码？

* * *

**更新：**

我查阅了 URI 语法规范（[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)），看起来确实没有必要在查询参数中编码冒号。这是 URI 的 ABNF 的摘录：

```
URI         = scheme ":" hier-part [ "?" query ] [ "#" fragment ]
query       = *( pchar / "/" / "?" )
pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"
unreserved    = ALPHA / DIGIT / "-" / "." / "_" / "~"
pct-encoded   = "%" HEXDIG HEXDIG
sub-delims    = "!" / "$" / "&" / "'" / "(" / ")" / "*" / "+" / "," / ";" / "= 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-04T23:19:47.003

是的，它们应该被编码在查询字符串中。正确的编码是`%3A`

但是，我可以理解为什么 UriBuilder 不编码`:`。您不想在绝对 URI 中的协议之后（例如`http:`）或用户名和密码之间（例如 ）对冒号进行编码。`ftp://username:password@domain.com`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-26T08:24:40.937

Java SDK 中没有`UriBuilder`，它是由 JAX-RS 定义的。它的[文档](http://docs.oracle.com/javaee/6/api/javax/ws/rs/core/UriBuilder.html)指出查询参数应该是 URL 编码的，其他组件是使用 RFC 3986 编码的。

> 构建器方法执行相应 URI 组件中不允许的字符的上下文编码，遵循**`application/x-www-form-urlencoded`查询参数的媒体类型规则和所有其他组件的 RFC 3986**

但是，JAX-RS 的 Jersey 实现不符合此规范，并根据 RFC 3986 对所有内容进行编码。这是一个错误，请参阅[JIRA 票证](https://java.net/jira/browse/JERSEY-2469)。

# java - JBehave模棱两可的步骤

> ID：13713679
> 
> 赞同：6
> 
> 时间：2012-12-04T23:13:35.967
> 
> 标签：java, ambiguity, jbehave

说我有：

```
@Given("first name is $firstName")
@Given("first name is $firstName and last name is $lastName") 
```

以下步骤将被标记为模棱两可：

```
Given first name is John and last name is Smith 
```

如果不使用引号将第一个参数括起来，如何修复此步骤使其仅匹配第二个参数？使用引号将两个参数分别括起来也有同样的歧义问题。

每个参数的长度是否有限制？是否有某些字符不能传入？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T10:18:55.557

您可以通过使用步骤优先级来解决此问题，如此处所述：http: [//jbehave.org/reference/stable/prioritising-steps.html](http://jbehave.org/reference/stable/prioritising-steps.html)

您的问题可以通过使用两个参数为变体设置更高的优先级来解决：

```
@Given("first name is $firstName")
@Given(value = "first name is $firstName and last name is $lastName", priority = 1) 
```

我尝试了您的示例，并且通过这种组合，这两个步骤被分开了。

（编辑：我最初的解决方案有参数的引号，但它也可以正常工作）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T11:32:17.553

我认为这种情况可以这样写：

```
Given first name is John
And last name is Smith 
```

和步骤：

```
@Given("first name is $firstName")
@And("last name is $lastName") 
```

您可以先创建人员对象，然后在“@Given”步骤中设置名称和姓氏。
如果您需要添加其他属性，例如电子邮件，您只需要创建另一个步骤：

```
@And("the email is $email")
public addEmail(String email) {
    person.setEmail(email);
} 
```

所以这个问题不会发生，你的代码将更可重用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-09T14:59:32.597

对我有用的是用脚踝括号（<>）代替美元符号（$），即

```
@Given("a person with first name <firstName>") 
```

和

```
@Given("a person with first name <firstName> and last name <lastName>") 
```

# google-chrome-extension - Chrome 扩展程序。加载模糊失败。

> ID：13713682
> 
> 赞同：3
> 
> 时间：2012-12-04T23:14:01.257
> 
> 标签：google-chrome-extension, blur

我正在创建一个 Chrome 扩展程序，它在加载时会模糊页面的任何文本区域，但它不起作用。有任何想法吗？这是代码：

清单.json：

```
{
"name":"foo",
"version":"1.0",
"manifest_version":2,
"description":"foo",
"content_scripts":[{
     "matches":["http://*/*"],
     "js":["content.js", "jquery-1.8.3.min.js"]}]
 } 
```

内容.js：

```
$(document).ready(function(){
$("input").blur}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:36:59.407

```
$("input").blur(); 
```

[模糊](http://api.jquery.com/blur/)是一种方法。

# css - 字体速记 line-height 不继承子元素

> ID：13713685
> 
> 赞同：1
> 
> 时间：2012-12-04T23:14:09.793
> 
> 标签：css

我有这个声明

```
body {font: normal .625em/1.2em Arial, sans-serif;} 
```

我通常希望任何段落标签等都会继承行高并将其调整为特定的大小。例如

```
p {font-size: 2.0em} 
```

假设基本 16px 浏览器字体大小 * .625 = 10px * 2.0em = 20px 20px 上的 1.2em 行高为 24，则行高应为 24px。

奇怪的是它似乎只渲染为 1em

如果我将正文声明更改为

```
body {font: normal .625em/1.2 Arial, sans-serif;} 
```

省略它正确呈现的 em 单位。所以我想我的问题已经解决了，但我以前从未见过这种情况，而且我很困惑为什么会这样。有谁知道它的原因？抱歉，我无法指向我在本地构建的网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:15:37.163

Eric Meyer 几年前写过关于“无单位线高”的主题：http: [//meyerweb.com/eric/thoughts/2006/02/08/unitless-line-heights/](http://meyerweb.com/eric/thoughts/2006/02/08/unitless-line-heights/)

基本上，如果包含单位，则行高基于祖先元素的字体大小，而不是当前元素的字体大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T06:54:39.997

继承属性时，继承的值是“<a href="http://www.w3.org/TR/CSS21/cascade.html#computed-value" rel="nofollow">计算值”。这意味着如果您声明一个值`1.2em`for `body`，那么`body`字体大小将乘以 1.2，结果是任何`body`没有设置属性的子级将继承的值。不管他们自己的字体大小是多少。

对于[`line-height`](http://www.w3.org/TR/CSS21/visudet.html#propdef-line-height)，有一个关于使用纯（无单位）数字的特殊规则：“属性的使用值是这个数字乘以元素的字体大小。[…] 计算值与指定值相同。” 这意味着当您将值指定为 时， （“使用值”）的行高与使用`1.2`获得的行高相同，但继承的值（“计算值”）是纯数字 1.2。这意味着它将乘以每个元素自己的字体大小。`body``1.2em`

士气是`line-height`通常应该使用纯数字来设置的。此外，通常最好为所有元素设置它，避免对其进行所有继承，例如`* { line-height: 1.3; }`. （顺便说一句，Arial 1.3 一般比 1.2 好。StackOverflow 使用 1.3 对应的值，以 Arial 为主要字体，这里的行高几乎不会过分。但这当然取决于行长等因素。）

# tsql - T-SQL DateMath：对于任何给定的日期，查找月份中出现的日期名称，例如第三个星期六

> ID：13713692
> 
> 赞同：0
> 
> 时间：2012-12-04T23:14:43.757
> 
> 标签：tsql, dayofweek, days, date-math

我正在尝试开发一个需要表示规则的调度应用程序，例如“此事件发生在该月的第 2 和第 4 个星期三”或“此事件发生在该月的奇数星期六（即第 1、3 和第 5 个星期六）。

为此，我需要在 T-SQL 中编写一个函数，该函数接受一个 Date 输入并返回一个整数，该整数表示该日期在月份中的哪个日期。

例如，如果我发送函数 2012 DEC 21，它将返回 3，因为 2012 年 12 月 21 日是该月的第三个星期五。鉴于 2012 DEC 29，它将返回 5，因为 2012 年 12 月 29 日是该月的第 5 个星期六。

我想在不求助于预先填充的日历表的情况下执行此操作。我可能想使用该函数来处理历史日期，例如计算 1958 年 7 月 16 日是哪个星期三。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:39:02.287

试试这个：

```
SELECT ((DATEPART(d, @input) - 1) / 7) + 1 
```

我们不关心一周中的实际日期，只关心每月第一天过去的天数（即天值 - 1）。然后一个整数除以 7 得到一个月第一天之后的*周数，最后 + 1 让它从 1 而不是 0 开始。*

# apache - 2 apache vhosts 永久重定向

> ID：13713695
> 
> 赞同：1
> 
> 时间：2012-12-04T23:15:22.867
> 
> 标签：apache, redirect

我有 2 个域，分别在 2 个 vhosts 文件中配置。我需要其中一个域永久重定向到第二个域。在重新加载 apache 之前，我已经运行了 'configtest' 并且得到了“Syntax Ok”。但是显然我有一个重定向循环。顺便说一句，该网站是一个drupal安装，不确定这有多少。

这是我的 2 个 conf 文件。

```
[root@prod ~]# cat meh-1_com.conf
<VirtualHost *:80>

    ServerName meh-1.com
    ServerAlias www.meh-1.com
    DocumentRoot    /var/www/html/meh1/

    <Directory /var/www/html/meh1/>
        Options +FollowSymLinks Indexes
        AllowOverride All
        order allow,deny
        allow from all
    </Directory>

    RewriteEngine On
    RewriteOptions inherit
    CustomLog /var/log/httpd/meh1.log combined

</VirtualHost>

<VirtualHost *:443>

    ServerName meh-1.com
    ServerAlias www.meh-1.com
    DocumentRoot    /var/www/html/meh1/

    <Directory /var/www/html/meh1/>
                Options +FollowSymLinks Indexes
                AllowOverride All
                order allow,deny
                allow from all
        </Directory>    

    RewriteEngine On
    RewriteOptions inherit
    CustomLog /var/log/httpd/meh1.log combined

    SSLEngine on
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
    SSLCertificateFile  /etc/httpd/ssl/meh1_com.crt
    SSLCertificateKeyFile   /etc/httpd/ssl/meh1_com.key
    SSLCertificateChainFile /etc/httpd/ssl/meh1_com.ca-bundle.crt
    SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown

</VirtualHost>

[root@prod ~]# cat meh-2_com.conf 
<VirtualHost *:80>

    ServerName meh-2.com
    ServerAlias www.meh-2.com
    Redirect permanent / http://meh-1.com

</VirtualHost>

<VirtualHost *:443>

        ServerName meh-2.com
        ServerAlias www.meh-2.com
        Redirect permanent / https://meh-1.com

</VirtualHost> 
```

# php - 在 PHP 中使用 CURL API 模拟浏览器 HTTP 请求方法

> ID：13713696
> 
> 赞同：1
> 
> 时间：2012-12-04T23:15:29.697
> 
> 标签：php, curl

这是非常基本的，但我有点困惑我哪里出错了（学习如何实现一个 RESTful Web 服务）。上下文是，我有一个简单的simulator.php 文件，它模拟对我的本地PHP 文件之一的HTTP 请求。本地 PHP 文件 (index.php) 只返回一个带有值的变量。所以它几乎是这样的：

```
<?php
$variable = 'hello';
return $variable;
?> 
```

我的simulator.php 文件有以下内容：

```
?php

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://localhost/kixeye/index.php');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$contents = curl_exec($ch);
var_dump($contents);
curl_close($ch);
?> 
```

但是，var_dump($contents) 并没有完全吐出从 index.php 返回的 $variable 的值。我不太明白为什么不。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:36:31.810

`return`函数之外的东西实际上不会做任何事情。您发出的 cURL 请求将返回来自请求页面的 HTML 响应，因此您真正想要做的是`echo`响应而不是使用`return`.

只需将`index.php`脚本更改为：

```
<?php
$variable = 'hello';
echo $variable;
?> 
```

而你`var_dump()`在第二个脚本中将输出`hello`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:32:29.970

该`$contents`变量将包含使用 Curl 完成的 http 请求返回的网页。如果您只需要一个来自 的值`index.php`，只需回显它，它的值将以`$contents`字符串形式结束。

如果要检索多个变量，可以尝试 json 编码它们，然后将结果回显到`index.php`. 然后你必须通过 json 解码在你的第二个脚本中做相反的事情`$contents`。

或者，您可以在第一个脚本中生成并回显有效的 php 代码，然后在第二个脚本中对其进行评估，但这是非常糟糕的做法（`eval`强烈建议不要使用 ）。

看：

*   [json_encode](http://php.net/manual/en/function.json-encode.php)
*   [评估](http://php.net/manual/en/function.eval.php)

# ruby - 如何有一个允许重复的有序模型关联

> ID：13713698
> 
> 赞同：2
> 
> 时间：2012-12-04T23:15:50.733
> 
> 标签：ruby, activerecord, model, associations

我有两个模型，Song 和 Show。一个节目是一个有序的歌曲列表，其中同一首歌曲可以被多次列出。

也就是说，在 Show 中的某处应该有一个有序数组（或哈希或任何东西）可以包含 Song1、Song2、Song1、Song3 并允许从该数组重新排序、插入或删除。

我无法弄清楚如何使用 ActiveRecord 关联对其进行建模。我猜我需要某种带有索引列的特殊连接表，但是除了开始直接编写我的 SQL 之外，有没有办法用 Rails 关联来做到这一点？

我现在拥有的一些代码（但不能正常工作）：

```
class Song < ActiveRecord::Base
  attr_accessible :title
  has_and_belongs_to_many :shows
end

class Show < ActiveRecord::Base
  attr_accessible :date
  has_and_belongs_to_many :songs
end

song1 = Song.create(title: 'Foo')
song2 = Song.create(title: 'Bar')
show1 = Show.create(date: 'Tomorrow')

show1.songs << song1 << song2 << song1

puts "show1 size = #{show1.songs.size}" # 3
show1.delete_at(0) # Should delete the first instance of song1, but leave the second instance
puts "show1 size = #{show1.songs.size}" # 2
show1.reload
puts "show1 size = #{show1.songs.size}" # 3 again, annoyingly 
```

插入可能如下所示：

```
show1.songs # Foo, Bar, Foo
song3 = Song.create(title: 'Baz')
show1.insert(1, song3)
show1.songs # Foo, Baz, Bar, Foo 
```

重新排序可能（有点神奇）看起来像：

```
show1.songs # Foo, Bar, Foo
show1.move_song_from(0, to: 1)
show1.songs # Bar, Foo, Foo 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:27:47.340

您在连接表的想法上走在了正确的轨道上：

```
class Song < ActiveRecord::Base
  attr_accessible :title
  has_many :playlist_items
  has_many :shows, :through => :playlist_items
end

class PlaylistItem < ActiveRecord::Base
  belongs_to :shows #foreign_key show_id
  belongs_to :songs #foreign_key song_id
end

class Show < ActiveRecord::Base
  attr_accessible :date
  has_many :playlist_items
  has_many :songs, :through => :playlist_items
end 
```

然后你可以做类似的事情`user.playlist_items.create :song => Song.last`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T05:03:30.773

我目前对此的解决方案是 has_many :through 和acts_as_list 的组合。找到正确组合两者的信息并不是最容易的事情。例如，其中一个障碍是acts_as_list 使用从1 开始的索引，而由ActiveRecord 关联创建的类似数组的方法从0 开始。

这就是我的代码的最终结果。请注意，我必须指定显式方法来修改连接表（无论如何，对于大多数）；我不确定是否有更清洁的方法可以使这些工作。

```
class Song < ActiveRecord::Base
  attr_accessible :title
  has_many :playlist_items, :order => :position
  has_many :shows, :through => :playlist_items
end

class PlaylistItem < ActiveRecord::Base
  attr_accessible :position, :show_id, :song_id
  belongs_to :shows 
  belongs_to :songs
  acts_as_list :scope => :show
end

class Show < ActiveRecord::Base
  attr_accessible :date
  has_many :playlist_items, :order => :position
  has_many :songs, :through => :playlist_items, :order => :position

  def song_at(index)
    self.songs.find_by_id(self.playlist_items[index].song_id)
  end

  def move_song(index, options={})
    raise "A :to option is required." unless options.has_key? :to
    self.playlist_items[index].insert_at(options[:to] + 1) # Compensate for acts_as_list starting at 1
  end

  def add_song(location)
    self.songs << location
  end

  def remove_song_at(index)
    self.playlist_items.delete(self.playlist_items[index])
  end
end 
```

根据acts_as_list 附带的说明，我在“playlist_items”表中添加了一个“位置”列。值得注意的是，我必须深入研究acts_as_list 的API 才能找到insert_at 方法。

# java - Java如何从UDP数据包中解析原始数据

> ID：13713699
> 
> 赞同：1
> 
> 时间：2012-12-04T23:15:53.450
> 
> 标签：java, udp

我有来自二进制形式的 UDP 连接的假设数据。

它由5个字段组成，大小为25位

它们的偏移量如下

```
 1\. 0-4 ID
 2\. 5-10 payload
 3\. 11-12 status
 4\. 13-23 location
 5\. 23-25 checksum 
```

**我如何读入这些数据？**

```
 DatagramSocket serverSocket = new DatagramSocket(18000);
        byte[] receiveData = new byte[1024];

        while (true)
        {
            DatagramPacket receivePacket = new DatagramPacket(receiveData, receiveData.length);
            serverSocket.receive(receivePacket);

           //not sure how I should be reading the raw binary data back in

        } 
```

**我将如何存储这些数据？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:29:30.363

DatagramPacket 的[getData](http://docs.oracle.com/javase/6/docs/api/java/net/DatagramPacket.html#getData%28%29)以 byte[] 形式返回有效负载。您可以使用[Arrays.copyOfRange](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange%28byte%5B%5D,%20int,%20int%29)来获取各个字段（我假设您的问题是**bytes**，而不是**bits**）：

```
while (true) {
    DatagramPacket receivePacket = new DatagramPacket(receiveData, receiveData.length);
    serverSocket.receive(receivePacket);
    // get the entire content
    byte telegramContent[] = receivePacket.getData();
    // and slice it up:

    byte ID[] = Arrays.copyOfRange(telegramContent,0,5); 
    byte payload[] = Arrays.copyOfRange(telegramContent,6,11);
    // and so on.
} 
```

在这一步之后，您将把字段作为单独的字节数组，可能需要进行一些后处理/重新组装成其他类型。在这一步中，最烦人的可能是所有 Java 的类型都是**签名**的，而在许多通信协议中使用的是未签名的实体，所以在这一步要小心。

您的问题中未提及，但您稍后可能需要它：用于传输的消息组合。我喜欢使用[GNU Trove 的 TByteArrayList](http://trove4j.sourceforge.net/javadocs/gnu/trove/list/array/TByteArrayList.html)来完成该任务，因为您不必担心在开始之前保留正确长度的 byte[]，只需复制字节或消息段，一旦完成调用[toArray](http://trove4j.sourceforge.net/javadocs/gnu/trove/list/array/TByteArrayList.html#toArray%28%29)和瞧，您的 byte[] 已准备好传输。

# c# - 在 C# 中生成 sql 语句 - 将表值插入新表

> ID：13713700
> 
> 赞同：0
> 
> 时间：2012-12-04T23:16:01.337
> 
> 标签：c#, sql

我正在编写一个小程序，将 csv 文件转换为一系列插入语句到数据库中。该程序不了解数据库，因此编写的语句是一次性的，它们不可能是动态的。

现在，每个数据集都有自己的 guid，我想让语句根据其名称查询数据库以确定数据集是否存在。所以我有：

```
sw.WriteLine("-- Determine if dataset exists from school name");
sw.WriteLine(string.Format(
"INSERT INTO DataSets (Guid, DataSets ) VALUES ('{0}', '{1}') WHERE NOT EXISTS (SELECT * FROM DataSets WHERE DataSetName = '{1}')",
Guid,
DataSetName 
)); 
```

（如果我错了请纠正我，sql真的不是我的强项）现在，下一个问题是数据集的Guid在其他一些表中使用，例如：

```
string sql = string.Format(
                    "INSERT INTO Table1 VALUES ('{0}', '{1}', '{2}', {3}, '{4}');",
                    object.value1
                    object.value1
                    object.value1
                    object.value1
                    Guid 
```

'Guid' 不能在 c# 中用作变量，它可以是新的 Guid（如果数据库中不存在'datasets'）或现有的 guid（如果存在'datasets'，则获取现有的 guid）

所以我需要类似的东西：

```
string sql = string.Format(
                    "INSERT INTO Table1 (Data1, Data2, Data3, Data4) VALUES ('{0}', '{1}', '{2}', {3});",
                    object.value1
                    object.value1
                    object.value1
                    object.value1
string sql2 = string.Format("INSERT INTO Table1 (Data5) VALUES (SELECT Guid FROM Datasets WHERE DataSetName = '{0}');
                    Guid
                    ); 
```

这是一个好的（甚至是有效的？）方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:34:21.090

首先，就像其他人指出的那样，您对 SQL 注入持开放态度，因此，使用 SqlCommand 参数是一个更好的选择。你可以找到很多例子。

但是，如果代码只是用于将 csv 转换为插入，并且真的不太可能有人试图破解程序，我会说没关系。

基本上，你描述的没问题。但

```
 string sql2 = string.Format("INSERT INTO Table1 (Data5) VALUES (SELECT Guid FROM Datasets WHERE DataSetName = '{0}');
                Guid
                ); 
```

您应该首先检查它是否返回 guid 或 null

```
 SELECT Guid FROM Datasets WHERE DataSetName = '{0}' 
```

然后决定是否创建一个新的 guid 并插入。

如果您只进行一次导入，您甚至不需要检查 guid 是否存在。您从代码创建一个 guid，将其插入到 sql 中。正因为是guid，所以理论上，虽然不为零，但是一批创建同一个guid的概率确实很小。

*   如果您不需要知道数据库中已经存在什么 guid（即您只需要导入一次），则您不必连接到数据库。您可以使用跟踪您使用的所有 guid 的列表。

# cmake - 抑制 cmake 自定义目标中的自动消息

> ID：13713704
> 
> 赞同：1
> 
> 时间：2012-12-04T23:16:19.863
> 
> 标签：cmake

我想用 cmake 添加自定义目标，但是其中一些必须是“静默的”，因为它不是必需的。例如，对于干净的自定义命令：

```
// In CMakeLists.txt
add_custom_target(clean-temporaries
   ${CMAKE_COMMAND} -P clean-temporaries.cmake
   COMMENT "Deleting temporary files"
)

// clean-temporaries.cmake
file(GLOB_RECURSE temporary_files "*[~#]")
file(REMOVE ${temporary_files})

$ cmake .
$ make clean-temporals
[100%] Deleting temporary files
[100%] Built target clean-temporaries
$ make clean
$ 
```

我们可以看到 CMake 准备“make clean”以不显示消息，但是，我怎么能对 CMake 说我不希望自定义目标中的消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T13:14:26.397

要处理乱扔源代码树的临时文件：

*   鼓励贡献者配置他们的编辑器，以便临时文件最终位于他们的公共目录中`$HOME`（例如：[vim](http://vim.wikia.com/wiki/Remove_swap_and_backup_files_from_your_working_directory)、[emacs](http://emacswiki.org/emacs/BackupDirectory)）。
*   鼓励贡献者配置他们的全局版本控制忽略文件以始终忽略他们自己工作环境的临时文件（例如，对于 git：[vim](https://github.com/github/gitignore/blob/master/Global/vim.gitignore)、[emacs](https://github.com/github/gitignore/blob/master/Global/Emacs.gitignore)）。
*   此外，在每个项目的版本控制的忽略文件中排除众所周知的临时文件模式，以对尚未实施前两个步骤的贡献者友好。

如果您这样做，您可能不必在构建系统中添加额外的“可选”（即高度特定于环境的）步骤，您最终会得到一个更普遍适用的问题解决方案。

作为对您的示例代码的附加评论，我会避免在源代码树中构建，而是使用[源外构建](http://www.cmake.org/Wiki/CMake_FAQ#Out-of-source_build_trees)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:52:20.347

尝试在要从控制台隐藏的命令的开头添加减号。

```
-make clean 
```

# php - 在命名空间中扩展 PHP 类

> ID：13713706
> 
> 赞同：1
> 
> 时间：2012-12-04T23:16:28.050
> 
> 标签：php, class, namespaces

我有一个 PHP 类——一个通用的 ODBC 数据库接口。虽然方法永远不会改变（因为它使用 PDO），但连接字符串会。为了避免让用户手动传递整个连接字符串或指定要放入连接字符串的 ODBC 驱动程序，我扩展了该类并创建了一个 SQL Server 特定版本。

**通用 PDO ODBC 驱动程序**

```
class PDO_ODBC implements DBDriver{
    private $driver;
    private $connection_string;

    public function connect(){
        if(!$this->driver || !$this->connection_string){
            throw new \Exception("Invalid connection string or database driver.");
        }
    }
} 
```

**SQL Server 特定版本**

```
class PDO_ODBC_SQL_Server extends PDO_ODBC{
    public function __construct(){
        $this->driver = 'SQL Server';
        $this->connection_string = 'odbc:Driver={[Driver]};Server=[Host];Database=[DBName];Uid=[Username];Pwd=[Password]';
    }
} 
```

问题是，当我创建一个新`PDO_ODBC_SQL_Server`对象并调用`connect()`时，抛出异常是因为`$this->driver`并且`$this->connection_string`不存在。但这怎么可能呢？如果我使用`print_r`，我会*看到*这两个属性。需要注意的一点是，`print_r` *它还显示了**除*驱动程序和连接字符串之外的所有属性的类的命名空间，如下所示：http: [//pastebin.com/qh40eDpa](http://pastebin.com/qh40eDpa)。实际上，命名空间下有连接字符串和驱动的*独立*变量。

如何解决此问题并防止引发异常，同时仍然能够通过扩展基本 ODBC 类来使用类似的设计模式？如果没有，那么替代方法是允许开发人员传入驱动程序和连接字符串......

*请注意，为简洁起见，我在上面的代码示例中省略了大部分私有变量。这两个类都位于单独的文件中，并且位于命名空间下`Lib\Database`*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:20:15.287

`protected`如果您想让它们保持私有，请制作类属性或制作 getter 和 setter。私有属性只能从声明它们的类访问，不能从派生类访问。

```
class PDO_ODBC implements DBDriver{
    protected $driver;
    protected $connection_string;

    public function connect(){
        if(!$this->driver || !$this->connection_string){
            throw new \Exception("Invalid connection string or database driver.");
        }
    }
} 
```

[http://php.net/manual/en/language.oop5.visibility.php#language.oop5.visibility-members](http://php.net/manual/en/language.oop5.visibility.php#language.oop5.visibility-members)

# java - 从数组更新 JPanel

> ID：13713709
> 
> 赞同：2
> 
> 时间：2012-12-04T23:17:07.693
> 
> 标签：java, swing, user-interface, jtable

在这个程序中，我必须创建一个 GUI，将联系人的对象保存到一个数组中，然后将其转换为一个数组以传递给默认表模型的构造函数。我知道我在这里做了一个额外的步骤。

备份按钮实际上将联系人向量中的任何内容保存到二进制文件中。加载按钮会将您在用户名中输入的任何文件名加载回向量中。查看所有联系人应显示向量中的所有内容（从技术上讲是`contactListArray`）。

我遇到了无法`JTable`更新视图卡的问题。如果我加载联系人，然后单击它显示的加载联系人，那么我知道数据正在正确写入 .dat 文件。问题似乎是，一旦我单击视图按钮，它`JTable`正在创建并且不会更改，即使我已将其设置为更改方法。

我认为问题出在哪里，`if(source == viewBut)` 我认为整个街区可能是问题所在。提前感谢您的帮助，我真的很感激。

```
/*
* Lab number: Final Project
* Robert Lopez
* Section number: 4
*/

import javax.swing.*;
import javax.swing.table.*;
import java.awt.*;
import java.awt.event.*;
import java.io.*;
import java.util.*;
import javax.swing.event.*;
import javax.swing.table.TableModel;

class Contact implements Serializable{ String firstName, lastName, eAddress, address, phoneNum; }

public class finalLab implements ActionListener{
    static CardLayout layout;

    static private JFrame frame = new JFrame("Address Book");

    static private JButton[] topMenuButton = new JButton[5];

    static private Vector<Contact> contactList = new Vector<Contact>();
    static private int contactSize = 0;

    static private String[] columnNames = {"First Name", "Last Name","E-Mail Address", "Address", "Phone Number"};

    static private String[][] contactListArray;

//START--------------------------Menu Card----------------------------------------------

        static JPanel menuCard = new JPanel(new BorderLayout());

    static JPanel menuTop = new JPanel( new GridLayout(2,1) );

    static private JLabel firstLabel = new JLabel("Use The Buttons Below To Manage Contacts");

    static JPanel menuMid = new JPanel(new FlowLayout());
    static private JLabel userName = new JLabel("User Name:");
    static private JTextField userNameField = new JTextField("", 15);
    static private JLabel numContacts = new JLabel("Number of Contacts:");
    static private JTextField numContactsField= new JTextField("", 15);

    static private JPanel menuLower = new JPanel(new GridLayout(2,8));
    static private JButton loadBut = new JButton("Load Contacts");
    static private JButton addBut = new JButton("Add New Contacts");
    static private JButton searchBut = new JButton("Search Contacts");
    static private JButton sortBut = new JButton("Sort Contacts");
    static private JButton deleteBut = new JButton("Delete Contacts");
    static private JButton viewBut = new JButton("View All Contacts");
    static private JButton backupBut = new JButton("Backup Contacts");
    static private JButton blankBut = new JButton("");

//END---------------------------------Menu Card------------------------------------

//START---------------------------------View Card------------------------------------

    //View Panel

    static private JPanel viewCard = new JPanel(new BorderLayout());
    static private JPanel viewCardLower = new JPanel();

    static private JLabel viewLabel = new JLabel("Contact List");

    static private JTable viewContacts;

    static private JPanel viewCardMid = new JPanel(new BorderLayout());
    static private JTableHeader header;
    static private JScrollPane scrollPane = new JScrollPane();

//END---------------------------------View Card------------------------------------

//START-----------------------------------Delete Card------------------------------------

         //Delete Panel
    static private JPanel deleteCard = new JPanel(new GridLayout (3,1));
    static private JPanel deleteMid = new JPanel();
    static private JPanel deleteLower = new JPanel();

    static private JLabel deleteLabel = new JLabel("Delete Contacts");
    static private JLabel contactInfoLabel = new JLabel("Contact Phone #");
    static private JTextField contactInfoField = new JTextField("", 15);

//END-----------------------------------Delete Card---------------------------------

//START-----------------------------------Add Contact-------------------------------

    static private JPanel addCard = new JPanel(new GridLayout(6,2));
    static private JLabel firstNameLabel = new JLabel("First Name");
    static private JLabel lastNameLabel = new JLabel("Last Name");
    static private JLabel eAddressLabel = new JLabel(" E-Mail Address");
    static private JLabel addressLabel = new JLabel("Address");
    static private JLabel phoneNumLabel = new JLabel("Phone No.");

    static private JTextField firstNameField = new JTextField("", 10);
    static private JTextField lastNameField = new JTextField("", 10);
    static private JTextField eAddressField = new JTextField("", 10);
    static private JTextField addressField = new JTextField("", 10);
    static private JTextField phoneNumField = new JTextField("", 10);

    static private JButton saveContactBut = new JButton("Save New Contact");

    static private JPanel addLowerLeft = new JPanel();
    static private JPanel addLowerRight = new JPanel();

//END------------------------------------Add Contact-----------------------------

//******************************   MAIN METHOD   *******************************

    static JPanel contentPane = (JPanel)frame.getContentPane();

    static private JPanel mainPanel = new JPanel();

    public static void main(String[] args){
        ActionListener AL = new finalLab();

        mainPanel.setLayout(layout = new CardLayout() );

        contentPane.setLayout(new BorderLayout());

        //Buttons, Labels
        loadBut.addActionListener(AL);
        for(int i = 0; i < 5; i++){
            topMenuButton[i] = new JButton("Top Menu");
            topMenuButton[i].addActionListener(AL);
        }
        backupBut.addActionListener(AL);
        viewBut.addActionListener(AL);
        addBut.addActionListener(AL);
        deleteBut.addActionListener(AL);
        saveContactBut.addActionListener(AL);

//-------------------------------------------------------

        //Top Menu

        firstLabel.setHorizontalAlignment(JTextField.CENTER);
        firstLabel.setFont(new Font( "serif", Font.BOLD, 25 ));
        menuTop.add(firstLabel);

        numContactsField.setEditable(false);
        numContactsField.setText("" + contactSize);

        //Adding Middle Content
        menuMid.add(userName);
        menuMid.add(userNameField);
        menuMid.add(numContacts);
        menuMid.add(numContactsField);

        //Adding Lower Content
        menuLower.add(loadBut);
        menuLower.add(addBut);
        menuLower.add(searchBut);
        menuLower.add(sortBut);
        menuLower.add(deleteBut);
        menuLower.add(viewBut);
        menuLower.add(backupBut);
        menuLower.add(blankBut);

        menuCard.add(menuTop, BorderLayout.NORTH);
        menuCard.add(menuMid, BorderLayout.CENTER);
        menuCard.add(menuLower, BorderLayout.SOUTH);

//-------------------------------------------------------

        //Delete Card
        deleteLabel.setHorizontalAlignment(JTextField.CENTER);
        deleteLabel.setFont(new Font( "serif", Font.BOLD, 25 ));
        deleteCard.add(deleteLabel);
        deleteMid.add(contactInfoLabel);
        deleteMid.add(contactInfoField);
        deleteCard.add(deleteMid);
        deleteLower.add(topMenuButton[0]);
        deleteCard.add(deleteLower);

//-------------------------------------------------------

        //Add Card
        firstNameLabel.setHorizontalAlignment(JTextField.RIGHT);
        lastNameLabel.setHorizontalAlignment(JTextField.RIGHT);
        eAddressLabel.setHorizontalAlignment(JTextField.RIGHT);
        addressLabel.setHorizontalAlignment(JTextField.RIGHT);
        phoneNumLabel.setHorizontalAlignment(JTextField.RIGHT);

        addCard.add(firstNameLabel);
        addCard.add(firstNameField);
        addCard.add(lastNameLabel);
        addCard.add(lastNameField);
        addCard.add(eAddressLabel);
        addCard.add(eAddressField);
        addCard.add(addressLabel);
        addCard.add(addressField);
        addCard.add(phoneNumLabel);
        addCard.add(phoneNumField);

        addLowerLeft.add(saveContactBut);
        addLowerRight.add(topMenuButton[1]);

        addCard.add(addLowerLeft);
        addCard.add(addLowerRight);

//----------------------------------------------------------

        //View Card

        viewLabel.setHorizontalAlignment(JTextField.CENTER);
        viewLabel.setFont(new Font( "serif", Font.BOLD, 25 ));
        viewCard.add(viewLabel, BorderLayout.NORTH);
        viewCardLower.add(topMenuButton[2]);
        viewCard.add(viewCardLower, BorderLayout.SOUTH);

        //Adding to frame

        mainPanel.add("Menu Card", menuCard);
        mainPanel.add("Delete Card", deleteCard);
        mainPanel.add("Add Card", addCard);
        //mainPanel.add("View Card", viewCard);

        contentPane.add(mainPanel); 
        layout.show(mainPanel, "Menu Card");

        frame.pack();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(700, 275);
        frame.setResizable(false);
        frame.setVisible(true);

    }

public void actionPerformed(ActionEvent e){
    Object source =e.getSource();

    if(source == loadBut){
        try {
            FileInputStream fis = new FileInputStream (userNameField.getText());
            ObjectInputStream ois = new ObjectInputStream(fis);
            contactList.clear();
            contactSize = 0;
            for(; true; contactSize++){
                 contactList.add( (Contact) ois.readObject() );

            numContactsField.setText("" + (contactSize+1) );

            }
        } catch(EOFException e2){
        } catch(Exception e2){ 
            e2.printStackTrace();
        } 

    }
    if(source == addBut)
        layout.show(mainPanel, "Add Card");

    if(source == viewBut){
        contactListArray = new String[contactSize][5];

        for(int i = 0; i < contactSize; i++){
            contactListArray[i][0] = contactList.get(i).firstName;
            contactListArray[i][1] = contactList.get(i).lastName;
            contactListArray[i][2] = contactList.get(i).eAddress;
            contactListArray[i][3] = contactList.get(i).address;
            contactListArray[i][4] = contactList.get(i).phoneNum;
        }

        DefaultTableModel model = new DefaultTableModel(contactListArray,columnNames);
        viewContacts = new JTable(model);

        header = viewContacts.getTableHeader();

        viewContacts.setFillsViewportHeight(true);

        viewContacts.revalidate();
        viewCardMid.add(header, BorderLayout.NORTH);
        viewCardMid.add(viewContacts, BorderLayout.CENTER);

        viewCard.add(viewCardMid, BorderLayout.CENTER);

        mainPanel.add("View Card", viewCard);

        layout.show(mainPanel, "View Card");
    }

    if(source == deleteBut)
        layout.show(mainPanel, "Delete Card");

    if(source == saveContactBut){
        contactList.add(new Contact());

        contactList.get(contactSize).firstName = firstNameField.getText();
        contactList.get(contactSize).lastName = lastNameField.getText();
        contactList.get(contactSize).eAddress = eAddressField.getText();
        contactList.get(contactSize).address = addressField.getText();
        contactList.get(contactSize).phoneNum = phoneNumField.getText();

        contactSize++;

        firstNameField.setText("");
        lastNameField.setText("");
        eAddressField.setText("");
        addressField.setText("");
        phoneNumField.setText("");
    }

    if(source == backupBut){
        try{
            FileOutputStream fos = new FileOutputStream (userNameField.getText(), false);
            ObjectOutputStream oos = new ObjectOutputStream(fos);

            for(int i = 0; i < contactSize; i++)
                oos.writeObject(contactList.get(i));
            oos.close();
        }
        catch (IOException e2){
            System.out.println("IO Exception " + e2);
        }
    }

    for(int i = 0; i < 5; i++)
        if(source == topMenuButton[i]){
            layout.show(mainPanel, "Menu Card");
            numContactsField.setText("" + contactSize);
        }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:45:43.063

问题在于您对表格和工作原理缺乏了解`CardLayout`。

```
// This is good...
DefaultTableModel model = new DefaultTableModel(contactListArray, columnNames);
// This is bad...
viewContacts = new JTable(model);

// This is bad...and raises some eyebrows
header = viewContacts.getTableHeader();

// This okay, but doesn't belong here, and is pointless given the following code...
viewContacts.setFillsViewportHeight(true);

// Pointless, you've not added the component to anything yet..
viewContacts.revalidate();
// ??  What ??
viewCardMid.add(header, BorderLayout.NORTH);
// Not good.  The table should be added to a JScrollPane first and the scroll
// pane added to the card
viewCardMid.add(viewContacts, BorderLayout.CENTER);

// Okay, but wrong place...
viewCard.add(viewCardMid, BorderLayout.CENTER);

// Here is your main problem.  The card layout only allows one component to exist
// for a given name.  If you try and add another card, it is discarded and the first
// component with that name remains
mainPanel.add("View Card", viewCard);

// Not bad...
layout.show(mainPanel, "View Card"); 
```

与其在按下视图按钮时创建表视图，不如在首次创建 UI 时初始化视图并在单击视图按钮时替换/更新表模型...

在您的构造函数中，您应该添加...

```
viewContacts = new JTable(); // Don't need the model at this stage
viewContacts.setFillsViewportHeight(true);
viewCardMid.add(new JScrollPane(viewContacts), BorderLayout.CENTER);
mainPanel.add("View Card", viewCard); 
```

在您的视图中按钮操作代码...

```
DefaultTableModel model = new DefaultTableModel(contactListArray, columnNames);
viewContacts.setModel(model);
mainPanel.add("View Card", viewCard); 
```

此外，正如开始指出的那样，您不应该使用`static`类字段，它在您的情况下不是必需的，并且随着程序复杂性的增加会导致您出现问题。

您应该`if-else`在您的操作执行方法中使用语句，这将减少逻辑错误的可能性并有助于提高性能

您还应该研究将每个视图的逻辑移动到它自己的类中，以减少主类中的混乱

花时间阅读[使用 JFC/Swing 创建 GUI](http://docs.oracle.com/javase/tutorial/uiswing/)，特别是，我会研究[如何使用表格](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)和[如何使用 CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:36:58.437

你让你的变量是静态的。静态变量的内存不是在堆栈上分配，而是在常规内存中。我没有详细查看您的代码，但我会尝试删除您类中的所有静态变量并从那里重试。

# python - 如何在numpy中获得n维数组切片的总和？

> ID：13713710
> 
> 赞同：0
> 
> 时间：2012-12-04T23:17:11.760
> 
> 标签：python, arrays, multidimensional-array, numpy

我在 NumPy 中有一个 n 维数组。我想计算一个切片中所有元素的总和。例如：

如果我有以下具有值的 2x2x2 3D 数组：

```
z = 1
1 2
3 4

z = 2
5 6
7 8 
```

当我得到 z = 1 的切片时，我想得到 10，而 z = 2 我想得到 26。

我可以将以下内容用于 3D 空间，但如何为 n 维空间执行此操作？

```
(array.sum(axis = 0)).sum(axis = 0) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:58:50.520

我认为你过于复杂了：

```
>>> a=(np.arange(8)+1).reshape(2,2,2)
>>> a
array([[[1, 2],
        [3, 4]],

       [[5, 6],
        [7, 8]]])
>>> np.sum(a[0])
10
>>> np.sum(a[1])
26
>>> a[:,0]
array([[1, 2],
       [5, 6]])
>>> np.sum(a[:,0])
14 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:30:50.203

`i`沿第`d`th 维求和第th 切片：`arr.take([i], axis=d).sum()`

# ruby - 使用 Mail gem，我的 ruby 代码没有渲染。有任何想法吗？

> ID：13713714
> 
> 赞同：0
> 
> 时间：2012-12-04T23:17:19.767
> 
> 标签：ruby, email

我使用 Sinatra 和这个 gem，我可以发送电子邮件。但是，当我发送 ERB 文件时，它以纯文本形式出现，并且不会呈现 ruby​​ 代码。例如：

```
mail = Mail.deliver do
  to user_email
  from 'support@iconosites.com'
  subject 'Your Upgrade is being processed'
  body File.read('views/email.erb')
end 
```

有没有办法让它呈现 Ruby 代码？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T03:15:09.977

我尚未对此进行测试，但您似乎正在尝试将 erb 模板呈现为电子邮件的正文。

我认为你需要做更多的事情：

```
require 'erb'
template = ERB.new(File.read('views/email.erb'))

mail = Mail.deliver do
  to user_email
  from 'support@iconosites.com'
  subject 'Your Upgrade is being processed'
  body template.result
end 
```

在 ruby​​-docs 页面上还有一些电子邮件示例，用于 erb 模板：[http ://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html)

# android - 具有不同标记操作的 Maps API v2

> ID：13713726
> 
> 赞同：21
> 
> 时间：2012-12-04T23:18:11.577
> 
> 标签：android, google-maps, google-maps-markers

我正在尝试将我的应用程序移植到新的 Google Maps API v2，但在与标记交互时遇到了问题。

我的背景：我有一张显示公共汽车和公共汽车站的地图。在旧图书馆中，我有自己的 ItemizedOverlay 用于公共汽车站，另一个用于公共汽车。每个都有一个不同的 OnTapListener （实际上我使用外部库来显示气球），所以当用户点击公交车标记时没有任何反应，但是当他点击公交车站标记时，会打开一个带有其信息的活动。此外，在我的 ItemizedOverlay 中，我将每个标记与模型的巴士站对象进行了映射。

现在有了新的 API，我有两个主要问题：

*   您可以使用 GoogleMap 对象的 setOnInfoWindowClickListener() 或 setOnMarkerClickListener() 方法设置侦听器。换句话说，您只能为整个地图设置一个侦听器，因此我无法区分公共汽车站或公共汽车上的水龙头。
*   两个标记的 onClick 方法只接收 Marker 对象，从中我无法获得太多信息，例如公交车站号来打开其活动（我希望有比解析标题字符串更好的方法！O_O）

我认为这两个问题可以使用 Marker 的不同子类来解决，但是它没有构造函数，并且在将其添加到地图时会得到它的引用，所以我不知道是否可以使用自定义实现。

该 API 是新的，因此网络上没有太多关于类似问题的信息。我一直试图弄清楚如何解决这个问题，但我什么也没得到。有谁知道可能的解决方案？

谢谢。

编辑：我当前应用程序地图的屏幕截图，带有两种类型的标记： ![我当前应用程序地图的屏幕截图，带有两种类型的标记](../Images/984b37e47eaed1671092e7351a1459f7.png)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-05T00:10:06.423

我也遇到过这个问题。我的解决方案是：

```
private Map<Marker, MyModel> markerMap = new HashMap<>();
private GoogleMap mMap;

private void doMarkers(){
    MarkerOptions opt = new MarkerOptions();
    //Fill out opt from MyModel
    Marker marker = mMap.addMarker(opt);
    markerMap.put(marker, myModel);
} 
```

然后在 OnMarkerClickListener 回调中，使用单击的标记将模型从 HashMap 中拉出。还有一种方法 Marker.getId() 出于某种原因返回一个字符串。我不明白为什么在制作标记时不能指定 int id，或者为什么在将标记对象添加到地图之前不能访问它。

更新：近*4 年*后，谷歌添加了一种`Marker.setTag(Object tag)`将任意数据与标记相关联的方法。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-06T19:16:13.907

好的，这是我决定使用的解决方案，AFAIK 应该适用于任何情况：

```
private HashMap<String, MyModel> markers= new HashMap<String, MyModel>();

MyModel item = ...
MarkerOptions markerOptions = ...
markers.put(mMap.addMarker(markerOptions).getId(), item);

@Override
public void onInfoWindowClick(Marker marker) {
   MyModel mapItem = (MyModel) markers.get(marker.getId());.
   ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T10:06:12.447

您可以使用标记的`getId`方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-24T23:15:10.820

您可以像这样使用 HashMarker。在这个例子中， Arraylist 中的 y 个充电点，每个点都包含一个带有坐标的新 ArrayList。这个想法是你得到点ID。

创建一个哈希映射

标记 = 新的 HashMap();

然后你创建一个标记并添加到地图

最终标记标记 = map.addMarker(new MarkerOptions().position(new LatLng(coordinates.get(j).getLat(),coordinates.get(j).getLon())).title(point.getName()) );

然后您可以使用 de 标记值保存点 id

Markers.put(marker, point.getId());

最后，您可以在单击 InfoWindow 时获取 id 值

公共无效onInfoWindowClick（标记标记）{

```
 final long id = Marcadores.get(marker);
    Log.e("Real Marker ID", id+"");
} 
```

或者

当您单击标记时

公共布尔 onMarkerClick（标记 arg0）{

```
 final long id = Marcadores.get(marker);
    Log.e("Real Marker ID", id+"");
    return false;
} 
```

# webkit-transform - webkit-transform rotate 属性在每个单词后显示黑色伪影

> ID：13713729
> 
> 赞同：2
> 
> 时间：2012-12-04T23:18:36.440
> 
> 标签：webkit-transform

我正在尝试在 .mobi 文件中使用 webkits 转换旋转属性来获取亚马逊的电子书。当我在 css 中使用该属性时，它会在每个单词的右下角显示非常小的但明显的黑色伪影。这就像句末的句号，但不那么干净。如果我不得不这样解释的话，它看起来就像你的相机镜头上的小灰尘颗粒。这个问题是“仅”在第一代 Kindle Fire 上显示，而不是 Kindle Fire HD 8.9”，看起来很棒。浏览器也没有显示这种行为。我什至用其他字体尝试过，所以我知道它不是字体.删除transform属性后它就消失了，这很明显。我还需要添加什么吗？主要是它在KF HD上不显示。也许是' HD 的结果是双屏 ppi 吗？所以也许它仍然存在，但你只是看不到它？任何指针和建议将不胜感激。

```
Html:
div id="fs0-1-txt" class="txt fs0-txt1"
<p>text</p></div>

CSS:
fs0-txt1 
top: 82%;
left: 68%;
width: 40%;
transform: rotate(-3deg);
-webkit-transform: rotate(-3deg);

@font-face 
font-family: "font";
font-style: normal;
font-weight: normal;
src: url(../fonts/font.ttf); 
```

# r - 改进 GBM 包的运行时间

> ID：13713732
> 
> 赞同：1
> 
> 时间：2012-12-04T23:18:45.740
> 
> 标签：r

我正在构建一个具有相当大数据集的 GBM 模型。`data.table`非常适合处理数据。但是当我运行 GBM 模型时，它需要很长时间才能完成。查看活动监视器（在 Mac 中），我可以看到该进程并没有用完所有内存，也没有最大化处理器。

由于 GBM 是单核的，我无法修改它以在多核上运行，我有哪些选择来提高我的运行时间？现在我正在使用 4BG RAM 和 1.7GHz i5 的 Macbook Air。

我不确定以下哪个选项最有助于提高性能： (i) 购买具有更大内存的计算机；(ii) 获得更强大的芯片 (i7)，或 (iii) 使用 Amazon AWS 并在那里安装 R。这些将如何帮助？

根据 Brandson 的要求添加示例代码：

```
library(gbm) 

GBM_NTREES = 100 
GBM_SHRINKAGE = 0.05 
GBM_DEPTH = 4 
GBM_MINOBS = 50

GBM_model <- gbm.fit(
  x = data[,-target] ,
  y = data[,target] ,
  #var.monotone = TRUE, #NN added
  distribution = "gaussian"
  ,n.trees = GBM_NTREES ,
  shrinkage = GBM_SHRINKAGE ,
  interaction.depth = GBM_DEPTH ,
  n.minobsinnode = GBM_MINOBS ,
  verbose = TRUE) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-31T06:05:03.707

也许值得考虑的是使用[XGBoost 库](https://github.com/dmlc/xgboost)。根据 Github 回购：

“XGBoost 提供了一种并行树提升（也称为 GBDT、GBM），可以快速准确地解决许多数据科学问题。”

我也意识到最初的问题已经很老了，但也许这会对以后的人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T14:21:58.800

这似乎更多地是关于 R 中的并行计算，而不是关于 gbm 的特定问题。我将从这里开始：http: [//cran.r-project.org/web/views/HighPerformanceComputing.html](http://cran.r-project.org/web/views/HighPerformanceComputing.html)。

# python - 正则表达式匹配空格和字符串，直到正斜杠

> ID：13713734
> 
> 赞同：4
> 
> 时间：2012-12-04T23:18:53.697
> 
> 标签：python, regex, django

我有两个 django 网址，

```
(r'^groups/(?P<group>[\w|\W\-\.]{1,60})$')
(r'^groups/(?P<group>[\w|\W\-\.]{1,60})/users$' 
```

url 中的正则表达式`([\w|\W\-\.])$`匹配`soccer players`和`soccer players/users`。有人可以帮助获得与`groups`和之间的任何内容匹配的正则表达式`/`。我希望正则表达式匹配组之后的任何内容，直到遇到 /

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T23:22:36.967

您只需要执行以下操作，这将匹配任何与斜杠匹配的内容：-

```
regexp = re.compile(r'^group/(?P<group>[^/]+)$') 
```

如果您需要将示例中的 url 与尾随 匹配`/user`，您只需将其添加到表达式中：-

```
regexp = re.compile(r'^group/(?P<group>[^/]+)/users$') 
```

例如，如果您需要获取用户 ID，您也可以使用相同的匹配：-

```
regexp = re.compile(r'^group/(?P<group>[^/]+)/users/(?P<user>[^/]+)$') 
```

然后你可以得到结果：-

```
match = regexp.match(url) # "group/soccer players/users/123"
if match:
    group = match.group("group") # "soccer players"
    user = match.group("user") # "123" 
```

# winforms - 在有状态的应用程序中，我应该在哪里画出视图和控制器之间的界限？

> ID：13713739
> 
> 赞同：0
> 
> 时间：2012-12-04T23:19:25.677
> 
> 标签：winforms, model-view-controller, design-patterns

在 Web 上的 MVC 应用程序中，很容易在视图和控制器之间划清界限——视图向用户显示数据，而控制器收集输入并根据提供的输入将用户路由到视图。但是在有状态（例如桌面）应用程序中，要知道在哪里划界有点困难，因为操作之间的界限不像 Web 应用程序那样清晰。那么我在哪里画线呢？

例如，我的应用程序中有一个视图，它允许用户将项目放置在网格上。现在我在视图本身中有“在网格上放置项目”代码（访问网格模型以进行实际放置）。但我也可以将它放在控制器中，并将必要的信息从视图传递给控制器​​。两者似乎都不是一个明确的选择 - 将代码放在视图中最终会使视图膨胀，因为用户可以执行大量操作，而不仅仅是放置项目；但是将它放在控制器中似乎只是额外的间接级别，使代码更难遵循。

还是我对这一切都错了？这是一个 WinForms 应用程序；我的“视图”实际上是一个表单，表单本身既可以接收输入，也可以显示信息。那么区分就没有意义了吗？或者我应该让视图与表单分开吗？还是 MVC 模式与 WinForms 完全不兼容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:41:20.867

MVC 是关注点分离。它旨在帮助程序员将这两个区域的细节分开。模型和视图是对象的集合/分组。

VIEW 中的每个对象都可能是 BUTTON、WINDOW、TEXTAREA 等类集的一部分。

模型中的每个对象都将具有与您的域相对应的类型，例如 CUSTOMER_DETAILS、ADDRESS、POSTCODE 等

CONTROLLER 对象为您的 MODEL 对象提供了一个接口，您的 VIEW 对象将使用该接口与您的系统进行通信。CONTROLLER 还可能包含无法存储在您的 MODEL 对象中的功能。

传统的 MVC 还允许 VIEW 对象绕过 CONTROLLER 并直接与 MODEL 对象对话，但不建议这样做。

所有的对象都符合OO原则，都是完整的、功能齐全的对象。

# c# - C# 抽象和数据库层和委托

> ID：13713746
> 
> 赞同：1
> 
> 时间：2012-12-04T23:20:02.633
> 
> 标签：c#, .net, .net-3.5, data-access-layer, sqlcommand

我可以得到一些帮助来解释下面的答案以及它如何与代表一起工作。它的答案来自这里：[C# abstraction and database layer](https://stackoverflow.com/questions/13712872/c-sharp-abstraction-and-database-layer/13713046#13713046)

...如果您坚持使用 DataReader 的想法，您可以将委托传递给助手，该助手在 using 语句中被调用：

```
public string GetMySpecId(string dataId)
{
    return _dbHelper.ExecuteQuery(
        dr => 
           {
               if(dr.Read())
               {
                   return dr[0].ToString();
               }
               // do whatever makes sense here.
           },
        @"select ""specId"" from ""MyTable"" where ""dataId"" = :dataId",
        new SqlParameter("dataId", dataId));
    return result.Rows[0][0].ToString();
} 
```

您还可以使用像 Dapper 这样的轻量级工具来简化一些语法并负责映射到您的数据类型。（您仍然需要处理打开连接等问题。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:50:56.373

从上面声明`ExecuteQuery`方法应该是这样的：

```
public DataTable ExecuteQuery(Func<DataReader, DataTable> delegateMethod, string sqlQuery, SqlParameter param)
    {
        using (SqlConnection conn = new SqlConnection(this.MyConnectionString))
        {
            conn.Open();

            // Declare the parameter in the query string
            using (SqlCommand command = new SqlCommand(sqlQuery, conn))
            {
                // Now add the parameter to the parameter collection of the command specifying its type.
                command.Parameters.Add(param);

                command.Prepare();

                // Now, add a value to it and later execute the command as usual.
                command.Parameters[0].Value = dataId;

                using (SqlDataReader dr = command.ExecuteReader())
                {
                   return delegateMethod(dr);
                }
            }
        }
    } 
```

那应该是对的，您可能必须在 Func 中交换 DataReader 和 DataTable，我不记得参数类型或返回类型哪个先出现。

这是使用委托的另一个示例，如果您不需要返回类型`Func`，还有委托。`Action`

[Func 委托阅读](https://stackoverflow.com/questions/2082615/pass-method-as-parameter-using-c-sharp) [普通委托阅读](http://msdn.microsoft.com/en-us/library/aa288459%28v=vs.71%29.aspx)

# android - 有没有办法使用 Python 模拟不可见的外部监视器，并从中捕获视频数据？

> ID：13713749
> 
> 赞同：1
> 
> 时间：2012-12-04T23:20:17.790
> 
> 标签：android, python, external, monitor, multiple-monitors

以终为始，我正在考虑创建一个类似于 iDisplay 或 AirDisplay 的 Android 应用程序。

上述两个应用程序都在 Android 设备上用作 Mac/Windows 计算机的辅助屏幕。然而，由于它们都花费 10-4 美元，我正在考虑免费创建它们的免费版本，可能还有更多功能。但是，我试图为充当外部监视器并从“看不见的”外部屏幕获取视频数据的 Python 客户端找到任何库的尝试都没有成功，更不用说为任何远程类似的代码示例了。

（请注意，我知道我可以抓取屏幕数据，并让它镜像显示，但我正在尝试找到一种扩展桌面的方法）

有没有办法在 Python 中做到这一点？或者我应该看看其他语言？最终，我更希望它是跨平台的，但如果您只能提供适用于 Windows、Linux 或 OSX 的解决方案，他们都会受到赞赏。

# android - JSON 对象 null Android AsyncTask

> ID：13713751
> 
> 赞同：1
> 
> 时间：2012-12-04T23:20:29.820
> 
> 标签：android, json, rest

我想消费一个休息服务，下载json并将其放入一个对象中，然后返回它，但该对象总是返回我null，这是类：

```
public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";
Context ctx;

// constructor
public JSONParser(Context ctx) {

    this.ctx = ctx;

}

public JSONObject getJSONFromUrl(String url) {

    AsyncjSONTask task = new AsyncjSONTask();

    task.execute(url);

    return jObj;

}

private class AsyncjSONTask extends AsyncTask<String, Void, JSONObject>{

    @Override
    protected JSONObject doInBackground(String... params) {

        String url = params[0];
        InputStream is = null;
        // Making HTTP request
                try {
                    // defaultHttpClient
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    HttpPost httpPost = new HttpPost(url);

                    HttpResponse httpResponse = httpClient.execute(httpPost);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();           

                } catch (UnsupportedEncodingException e) {
                    e.printStackTrace();
                } catch (ClientProtocolException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
                JSONObject jObjOut = null;
                try {
                    BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
                    StringBuilder sb = new StringBuilder();
                    String line = null;
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    json = sb.toString();
                } catch (Exception e) {
                    Log.e("Buffer Error", "Error converting result " + e.toString());
                }

                // try parse the string to a JSON object
                try {
                    jObjOut = new JSONObject(json);

                } catch (JSONException e) {
                    Log.e("JSON Parser", "Error parsing data " + e.toString());
                }
        return jObjOut;
    }

    @Override
    protected void onPostExecute(JSONObject jObjIn) {

        jObj = jObjIn;
    }

}

} 
```

如果还有其他消费休息服务的方式，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:32:17.943

1.  请确保您要进行 HTTP POST 而不是 GET。
2.  在阅读响应之前，最好检查一下 HTTP 响应状态是什么
3.  不要将您的异步代码包装在非异步类中？似乎您感到困惑并把它称为好像它不是异步的。

您的 JSONParser 类假设 AsyncTask 不是异步的，而实际上它是。这是一个示例，说明您将如何做您正在尝试做的事情：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        new AsyncJsonTask(this).execute();

    }

    public void doSomethingWithTheResult(JsonObject result) {
        // Show the result on the View or do whatever with it.
    }

    private class AsyncJsonTask extends AsyncTask<String, Void, JsonObject> {

        private MainActivity _activity;

        public AsyncJsonTask(MainActivity activity) {
            this._activity = activity;
        }

        @Override
        protected JsonObject doInBackground(String... params) {
            JsonObject outputObject = null;

            // Call your web service to return the output 
            // ...

            return outputObject
        }

        @Override
        protected void onPostExecute(JsonObject result) {
            _activity.doSomethingWithTheResult(result);
        }

    }
} 
```

# python - Filtering a CSV file in python

> ID：13713752
> 
> 赞同：1
> 
> 时间：2012-12-04T23:20:31.290
> 
> 标签：python, csv, formatting, bioinformatics

I have downloaded this [csv file](http://www.ncbi.nlm.nih.gov/gv/mhc/ihwg.cgi?cmd=page&user_id=0&probe_id=0&source_id=0&locus_id=0&locus_group=1&proto_id=0&kit_id=0&page=RAmain), which creates a spreadsheet of gene information. What is important is that in the `HLA-*` columns, there is gene information. If the gene is too low of a resolution e.g. `DQB1*03` then the row should be deleted. If the data is too high resoltuion e.g. `DQB1*03:02:01`, then the `:01` tag at the end needs to be removed. So, ideally I want to proteins to be in the format `DQB1*03:02`, so that it has two levels of resolution after `DQB1*`. How can I tell python to look for these formats, and ignore the data stored in them. e.g.

```
if (csvCell is of format DQB1*03:02:01):
   delete the :01 # but do this in a general format
elif (csvCell is of format DQB1*03):
   delete row
else:
   goto next line 
```

UPDATE: Edited code I referenced

```
import csv
import re
import sys

csvdictreader = csv.DictReader(open('mhc.csv','r+b'), delimiter=',')
csvdictwriter = csv.DictWriter(file('mhc_fixed.csv','r+b'), fieldnames=csvdictreader.fieldnames, delimiter=',')
csvdictwriter.writeheader()
targets = [name for name in csvdictreader.fieldnames if name.startswith('HLA-D')]

for rowfields in csvdictreader:
  keep = True
  for field in targets:
    value = rowfields[field]
    if re.match(r'^\w+\*\d\d$', value):
      keep = False
      break # quit processing target fields
    elif re.match(r'^(\w+)\*(\d+):(\d+):(\d+):(\d+)$', value):
      rowfields[field] = re.sub(r'^(\w+)\*(\d+):(\d+):(\d+):(\d+)$',r'\1*\2:\3', value)
    else: # reduce gene resolution if too high
              # by only keeping first two alles if three are present
      rowfields[field] = re.sub(r'^(\w+)\*(\d+):(\d+):(\d+)$',r'\1*\2:\3', value)
  if keep:
     csvdictwriter.writerow(rowfields) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:47:16.557

Here's an ultra-simple filter:

```
import sys

for line in sys.stdin:
  line = line.replace( ',DQB1*03:02:01,', ',DQB1*03:02,' )

  if line.find( ',DQB1*03,' ) == -1:
    sys.stdout.write( line ) 
```

Or, if you want to use regular expressions

```
import re
import sys

for line in sys.stdin:
  line = re.sub( ',DQB1\\*03:02:01,', ',DQB1*03:02,', line )
  if re.search( ',DQB1\\*03,', line ) == None:
    sys.stdout.write( line ) 
```

Run it as

```
python script.py < data.csv 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T05:22:14.760

Here's something that I think will do what you want. It's not as simple as Peter's answer because it uses Python's `csv` module to process the file. It could probably be rewritten and simplified to just treat the file as a plain text as his does, but that should be easy.

```
import csv
import re
import sys

csvdictreader = csv.DictReader(sys.stdin, delimiter=',')
csvdictwriter = csv.DictWriter(sys.stdout, fieldnames=csvdictreader.fieldnames, delimiter=',')
csvdictwriter.writeheader()
targets = [name for name in csvdictreader.fieldnames if name.startswith('HLA-')]

for rowfields in csvdictreader:
    keep = True
    for field in targets:
        value = rowfields[field]
        if re.match(r'^DQB1\*\d\d$', value): # gene resolution too low?
            keep = False
            break # quit processing target fields
        else: # reduce gene resolution if too high
              # by only keeping first two alles if three are present
            rowfields[field] = re.sub(r'^DQB1\*(\d\d):(\d\d):(\d\d)$',
                                      r'DQB1*\1:\2', value)
    if keep:
        csvdictwriter.writerow(rowfields) 
```

The hardest part for me was determining what you wanted to do.

# c# - LINQifying 我的代码是否值得在闭包中访问 foreach 变量？

> ID：13713754
> 
> 赞同：3
> 
> 时间：2012-12-04T23:20:38.000
> 
> 标签：c#, linq, sqlite, closures, resharper

Resharper 让人想起过去滚石乐队的盗版现场录音，比以往任何时候都更敏锐；当我让它检查我的代码时，它告诉我关于闭包的信息：

1）“循环：

```
 foreach (var item in PlatypiIds)
        {
            var query = db.Table<Locations>().Where(l => l.PlatypusId == item).
                Where(l=> l.SentTimeUTC >= EarliestToShow).
                Where(l=> l.SentTimeUTC <= LatestToShow).
                OrderBy(l => l.SentTimeUTC);

            if (query != null)
            {
                foreach (var q in query)
                {
                    listLocs.Add(q);
                }
            }
        } 
```

...可以转换为 LINQ 表达式：

```
listLocs.AddRange(from item in PlatypiIds select db.Table<Locations>().Where(l => l.PlatypusId == item).Where(l => l.SentTimeUTC >= EarliestToShow).Where(l => l.SentTimeUTC <= LatestToShow).OrderBy(l => l.SentTimeUTC) into query 
where query != null from q in query select q);" 
```

...但后来 Resharper 告诉我关于“新的和改进的”代码：“在闭包中访问 foreach 变量。使用不同版本的编译器编译时可能会有不同的行为”

那么使用不同版本的编译器进行编译的可能性是什么？我的意思是，我不会在版本方面倒退，例如从 VS2012 到 VS2010……？？？

2）在这些线上：

```
 if (db != null)
                db.Insert(new PlatypiRequested() 
```

...这段代码：

```
 using (var db = new SQLiteConnection(SQLitePath))
    {
        db.CreateTable<PlatypiRequested>();

        db.RunInTransaction(() =>
        {
            if (db != null)
                db.Insert(new PlatypiRequested()
                              {
                                  PlatypusId = PlatypusId,
                                  PlatypusName = PlatypusName,
                                  InvitationSentLocal = invitationSentLocal
                              });
        });
    } 
```

...Resharper 告诉我，“访问已处置的关闭”

这是什么意思，我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:30:18.377

您在这里有两个不同的问题，一个是 LINQ 与 foreach，另一个是不同的情况。

关于 ReSharper 在代码是 LINQified 时通知您“访问闭包中的 foreach 变量...” - 我只是从不冒险，并将其保留为 foreach 循环。在大多数情况下，它也更具可读性和可维护性，实际上，缩短代码并不是什么大不了的事。

关于第二种情况 - 您需要丢失该`using`语句，因为该`db`对象将被处理得太早。`RunInTransaction`您应该在lambda 表达式的末尾以“老式方式”关闭并处理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T09:00:58.523

在 foreach 循环和 LINQ 查询中会出现真正的差异。

它与定义变量的闭包（作用域）的生命周期有关（在 foreach 循环或 LINQ 表达式中）。在某些版本中，变量在循环的每次迭代中都会重新定义，而在其他情况下，它的生命周期会跨越循环的整个执行过程，在迭代之间保持旧值。这可能会对结果产生很大影响，具体取决于代码。

我无法比 Eric Lippert（为 Microsoft 工作了 16 年，开发编译器，包括 C# 编译器）更好地解释它：

[http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closure-over-the-loop-variable-considered-harmful.aspx](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)

我确实看到了行为方式不同的代码，具体取决于 traget 框架（以及 C# 版本）。必须考虑到这一点。

大多数时候 R# 是正确的，就像在这个场合一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:35:12.183

您可以使用 Linq`ForEach`删除开环。

```
db.Table<Locations>().Where(l => l.PlatypusId == item).
Where(l=> l.SentTimeUTC >= EarliestToShow).
Where(l=> l.SentTimeUTC <= LatestToShow).
OrderBy(l => l.SentTimeUTC).ToList().
ForEach(q => listLocs.Add(q)); 
```

# html - HTML输入时间，步骤属性设置时间步长（比如说）x分钟？

> ID：13713755
> 
> 赞同：9
> 
> 时间：2012-12-04T23:20:49.360
> 
> 标签：html, input

我有一个时间输入，基本上只是：

```
Time: <input type="time" name="timeinput"/> 
```

[http://jsfiddle.net/X8E9N/](http://jsfiddle.net/X8E9N/)

根据 [http://www.w3.org/TR/html-markup/input.time.html](http://www.w3.org/TR/html-markup/input.time.html) 它支持 step 属性。是否可以使用此属性（或其他方式）将步长设置为 10 分钟？如果是这样，怎么做？

我知道其他一些解决方案（例如 datebox 插件），但如果可能的话，我希望有一个纯粹的 html 解决方案。我有时会使用 datebox 插件，但在移动设备上似乎很慢，所以我尽可能使用本地时间选择器。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-04-20T15:41:08.797

这是可能的。您只需要在 step 参数中输入秒数，例如。

```
<input type="time" step="300"> <!-- 5 min step -->
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-05T10:51:56.943

是的。[您可以在 seconds 中指定 step 属性](http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#time-state-%28type=time%29)。

但是，Opera、iOS Safari 和 Google Chrome 不会拒绝未对齐的用户输入。用户可以为此类时间字段指定 11:59。然后，当他尝试提交表单时，Opera 和 Google Chrome 会显示验证错误消息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-10-28T08:17:12.530

好像 Chrome 86 不支持这个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-04T17:09:32.770

从 iOS 9.1 开始，iOS 不支持 max min 或 step。

[http://caniuse.com/#feat=input-datetime](http://caniuse.com/#feat=input-datetime)

# jquery - 在jQuery中获取相对于祖先的偏移量

> ID：13713758
> 
> 赞同：1
> 
> 时间：2012-12-04T23:20:56.830
> 
> 标签：jquery, scroll

我有一个小的可滚动 div，其中包含一个非常大的结果树，分层嵌套并显示为一个巨大的缩进列表。当单击页面上其他位置的自动完成建议时，我希望该 div 向下滚动到树项目之一。问题是计算在可滚动 div 内滚动到的偏移量。我需要获取目标顶部和可滚动 div 顶部之间的距离，但是有几个复杂性。

我的代码如下所示：

```
$('#coltree').animate({
    scrollTop: $node.offset().top - $('#coltree').offset().top
}, 800); 
```

包含的可滚动 div 的 id在哪里`coltree`，$node 是一个 jQuery 对象，其中包含我要滚动到的元素（在`coltree`div 内）。

现在，并发症。我需要获取可滚动 div 的顶部和目标元素的顶部之间的距离。我上面使用的方法只有在`coltree`已经一直向上滚动的情况下才有效。例如，如果您已经滚动到一个元素，单击另一个建议将滚动到错误的位置，因为内容`coltree`已相对于页面移动。

我不想将树从可滚动 div 中取出，因为它之前和之后都有内容，而且树可能有很多页长。使用 jQuery 的`.position()`方法将不起作用，因为`coltree`它不是目标的直接父级。我需要一种方法来获取或计算元素相对于某个任意祖先的垂直位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T15:00:43.443

我想出的解决方案是包装`coltree`在另一个 div 中，并使该包装器成为滚动 div。由于`coltree`现在与目标 div 一起移动，因此每次减去它们的偏移量都会得到正确的值。对上述代码唯一需要的更改是为可滚动包装器设置动画，而不是`coltree`.

# ruby-on-rails - 如何防止 jquery UI ajax 选项卡在 Rails 3 中无休止地将请求发送回服务器？

> ID：13713760
> 
> 赞同：0
> 
> 时间：2012-12-04T23:21:09.080
> 
> 标签：ruby-on-rails, ajax, jquery-ui, jquery-ui-tabs

我遇到了这样的问题：我正在使用 Rails 3.2.9 和 jqueryUI 1.9.0 我有一个选项卡 UI 并为每个选项卡使用 ajax。html 和 Javascript 代码是这样的：

```
<!-- index.html.erb -->
<div id="tabs">
  <ul>
    <li><a href="home/page1">page1</a></li>
    <li><a href="home/page2">page2</a></li>
  </ul>
</div>

<!-- page1.html.erb-->
<p>this is page 1</p>

<!-- page2.html.erb-->
<p>this is page 2</p> 
```

在 home.js 中：

```
$(document).ready(function () {
  $( "#tabs" ).tabs();
}); 
```

因此，当我启动服务器并尝试激活任何选项卡时，前端将继续将请求发送回服务器。有谁知道这件事发生了什么？

谢谢

* * *

**更新**

我像这样更改 home.js 但仍然不起作用：

```
$(document).ready(function () {
  $( "#tabs" ).tabs({
    beforeLoad: function( event, ui ) {
      if ( ui.tab.data( "loaded" ) ) {
      event.preventDefault();
      return;
      }

      ui.jqXHR.success(function() {
        ui.tab.data( "loaded", true );
      });
    }
  });
}); 
```

我仍然找不到发生这种情况的原因。非常感谢你，如果有人能弄清楚。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T01:56:20.807

在你的控制器中试试这个

```
respond_to do |format|
      format.html { render :layout => false }
end 
```

这阻止了我继续循环请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T22:48:57.997

因为您在 href 链接中指定了`home/page1`和`home/page2`，所以每次单击相关选项卡时都会加载它们。

相反，您可以`index.html.erb`通过将部分渲染到页面中来加载页面一次。如果您重命名`page1.html.erb`为`_page1.html.erb`，`page2.html.erb`您`_page2.html.erb`可以将代码更改为：

```
<div id="tabs">
    <ul>
        <li><a href="#page1">Page 1</a></li>
        <li><a href="#page2">Page 2</a></li>
    </ul>
    <div id="page1">
         <%= render 'home/page1' %>
    </div>
    <div id="page2">
         <%= render 'home/page2' %>
    </div>
</div> 
```

**编辑**

如果您仍然想在单击每个选项卡时动态加载页面但只加载一次，那么不要使用部分 - 您可以只使用缓存选项：

```
 $( "#tabs" ).tabs({ 
            cache: true 
            //some other options 
  }); 
```

# javascript - Knockout.js ObservableArray 未绑定

> ID：13713761
> 
> 赞同：2
> 
> 时间：2012-12-04T23:21:11.623
> 
> 标签：javascript, knockout.js

我将此代码作为整个页面的全局代码：

```
<script type="text/javascript">
    var data = [];
    var VM_FiltroSeguros =
        {
            seguros: ko.observableArray(data)
        };
    ko.applyBindings(VM_FiltroSeguros.seguros);
</script> 
```

然后当成功调用 ajax 时，执行以下命令：

```
function okFiltrarSeguros(data)
    {
        var parsedData = parse(data);
        if (parsedData.Ok)
        {
            toastr.success('Se encontraron ' + parsedData.Value.length.toString() + ' Seguros.');

            $('#liResultsFiltroSeguro').show();

            VM_FiltroSeguros.seguros = parsedData.Value;
}; 
```

Html 是这些：

```
<table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Ramo</th>
                            <th>Poliza</th>
                        </tr>
                   </thead>
                   <tbody data-bind="foreach: seguros">
                     <tr>
                       <td><span data-bind="text: NroRamo"></span></td>
                       <td><span data-bind="text: NroSeguro"></span></td>
                     </tr>
                   </tbody>
                  </table> 
```

VM_FiltroSeguros.seguros = parsedData.Value 之后；执行我可以在调试器中看到 viewModel 填充了对象，但从未更新。有什么问题？谢谢！！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:27:59.260

你在这里做错了几件事。首先，需要绑定整个 ViewModel：

```
var data = [];
var VM_FiltroSeguros =
{
   seguros: ko.observableArray(data)
};
ko.applyBindings(VM_FiltroSeguros); 
```

然后，您需要使用如下函数调用将数据添加到“seguros”属性：

```
VM_FiltroSeguros.seguros(parsedData.Value); 
```

# eclipse - 将“外部工具配置”从一个 Eclipse 安装转移到另一个安装的快速方法？

> ID：13713765
> 
> 赞同：18
> 
> 时间：2012-12-04T23:21:32.397
> 
> 标签：eclipse, configuration, export, external

有没有一种快速的方法可以将“外部工具配置”从一个 Eclipse 安装转移到另一个？

它似乎没有提供导入/导出设置...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-09-25T13:11:14.623

我设法通过复制*.launch*文件将我的“外部工具配置”配置（即我的 Ant 参数和环境变量）从一个工作区复制到另一个

```
<workspace>\.metadata\.plugins\org.eclipse.debug.core\.launches 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-02-16T13:56:39.180

我找到了一种更简单的方法，您可以从中导出启动配置

```
File -> Export-> Run/Debug -> Launch Configurations 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-04T23:29:57.070

1.  打开“外部工具配置”对话框。
2.  打开“常用”选项卡。
3.  选择“共享文件”单选按钮并输入配置文件位置的路径。

Eclipse 会将您的外部工具配置存储在您指定的文件中。您可以在另一个 Eclipse 实例中使用此文件来加载配置。将您创建的“您的工具配置”.launch 文件添加到目标项目的根目录。下次刷新项目时，Eclipse 将加载配置。

# android - 来自外部 XML 的 Android 本地化

> ID：13713767
> 
> 赞同：2
> 
> 时间：2012-12-04T23:21:45.033
> 
> 标签：android, xml, web-services, localization

是否可以使用从服务接收的 XML 在运行时翻译 android 应用程序？如果可能的话，有人可以指出我正确的方向。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:03:03.967

**警告**

我读过的所有内容都表明，让您的应用更改语言不是一个好主意，因为 Android 框架不支持它，并且可能会导致问题。

话虽如此，我已经在我的应用程序中完成了它，虽然它有点痛苦，但它似乎到目前为止还有效。如果你想这样做，我就是这样做的。您需要为每种语言创建一个单独的`strings.xml`文件。`strings.xml`在`values`文件夹中作为您的默认值，然后可能是`strings.xml`在说`values-es`西班牙语字符串的文件夹中。我使用以下代码根据`RadioButton`用户选择来更改配置设置

```
final Configuration LANG_CONFIG = ChooseLocale.this.getResources().getConfiguration();
Locale newLocale = new Locale("English");
curLang = ChooseLocale.this.getLanguage();
if ((curLang.equals("English")) || (curLang.equalsIgnoreCase("Ingles")))
{
    newLocale = new Locale("en_US");
}
else
{
    newLocale = new Locale("es");
}
Toast.makeText(getApplicationContext(), newLangToast + " " + curLang , Toast.LENGTH_SHORT).show();
Configuration config = getBaseContext().getResources().getConfiguration();
Locale.setDefault(newLocale);
config.locale = newLocale;
getBaseContext().getResources().updateConfiguration(config, 
        getBaseContext().getResources().getDisplayMetrics());

SharedPreferences.Editor editor = langPref.edit();
editor.putString(LANG_PREF, curLang);
editor.commit(); 
```

这条线是更新配置最重要的

```
getBaseContext().getResources().updateConfiguration(config, 
        getBaseContext().getResources().getDisplayMetrics()); 
```

我从我的`getLanguage()`函数中获取语言环境，可以根据需要进行处理。我还必须添加

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    newConfig = Globals.getUserLanguage(this);
    super.onConfigurationChanged(newConfig); 
```

到每个允许方向改变的活动，并将其添加到我`onCreate()`的每个活动中

```
final SharedPreferences langPref = getSharedPreferences (LANG_PREF, 0);
if (Globals.langConfig != null)
    this.onConfigurationChanged(Globals.langConfig); 
```

我还添加`android:configChanges="orientation|locale"`到清单中允许改变方向的每个活动

[关于本地化的 Android 文档](http://developer.android.com/guide/topics/resources/localization.html)

# http - 如何使用asp.net获取网页的标题

> ID：13713768
> 
> 赞同：0
> 
> 时间：2012-12-04T23:21:53.617
> 
> 标签：http, http-headers

我正在尝试获取网页的标题。下面的代码块完成了这项工作。
但是，当页面被 401 拒绝时，我根本无法获得任何标题。有办法吗？

谢谢

```
public Int32 CheckURLStatus(string uri, out HttpWebResponse _response)
    {
        //Get response header
        _response = null;
        ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;
        HttpWebRequest _request = (HttpWebRequest)WebRequest.Create(uri);
        _request.Method = "GET";
        _request.AllowAutoRedirect = true;
        _request.Accept = "*/*";
        _request.MaximumAutomaticRedirections = 4;
        _request.UseDefaultCredentials = true;
        _request.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;
        Int32 statusCode = 404;
        try
        {
            _response = (HttpWebResponse)_request.GetResponse();
            statusCode = Convert.ToInt32(_response.StatusCode);
        }
        catch (Exception ex)
        {
            _response = null;
        }
        return statusCode;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:39:06.700

如果任何 StatusCode 不是 200，GetResponse() 方法将引发 WebException。要获取状态代码，您必须处理此异常并从异常中的响应中获取状态代码。

即使在 WebException 的情况下，我也更改了您的代码以获取响应代码：

```
public Int32 CheckURLStatus(string uri, out HttpWebResponse _response)
    {
        //Get response header
        _response = null;
        ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;
        HttpWebRequest _request = (HttpWebRequest)WebRequest.Create(uri);
        _request.Method = "GET";
        _request.AllowAutoRedirect = true;
        _request.Accept = "*/*";
        _request.MaximumAutomaticRedirections = 4;
        _request.UseDefaultCredentials = true;
        _request.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;
        Int32 statusCode = 404;
        try
        {
            _response = (HttpWebResponse)_request.GetResponse();
            statusCode = Convert.ToInt32(_response.StatusCode);
        }
        catch (WebException ex)
        {
            statusCode = Convert.ToInt32(((HttpWebResponse)ex.Response).StatusCode);
            _response = null;
        }
        return statusCode;
    } 
```

您还可以检查 ex.Response.Headers 并且您将获得响应的 HTTP 标头。

# java - 通过 RestFB 评论 Facebook 社交插件

> ID：13713772
> 
> 赞同：-2
> 
> 时间：2012-12-04T23:22:25.820
> 
> 标签：java, facebook, plugins, restfb

我正在尝试通过以下页面上的社交媒体插件对 RestFB 发表评论： [http ://www.zuberi.me/2011/facebook-social-plugin-comments.html](http://www.zuberi.me/2011/facebook-social-plugin-comments.html)

但我不知道该怎么做。我可以使用以下代码在我的墙上发布和评论帖子：

```
facebookClient.publish("fbid"+"/comments", String.class, Parameter.with("message", "my comment here")); 
```

我不确定`fbid`社交插件的权限以及权限，知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:30:04.437

无法以编程方式在评论插件上发帖。

# hibernate - Hibernate Search 写入锁定使查询变慢

> ID：13713776
> 
> 赞同：0
> 
> 时间：2012-12-04T23:23:02.057
> 
> 标签：hibernate, lucene, load-balancing, hibernate-search

我正在使用休眠搜索项目，它大量写入数据库，因此写入 lucene 索引。

有时我会遇到查询太慢的情况，这发生在应用程序使用量很大的情况下。

我正在考虑迁移到集群配置，并每 10 分钟同步一次。

根据您的经验，这是一个好的方法吗？我应该同步多长时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T09:46:07.413

如果索引和数据库更新是减速的真正原因，集群确实可以成为解决方案。您将不得不尝试并可能进行更多分析以找到问题的根源。

关于集群配置同步时间。让我们先从这里开始[文档](http://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/)

> 刷新周期的推荐值（至少）比复制信息的时间（默认 3600 秒 - 60 分钟）高 50%。

和

> 如果在经过下一个刷新周期后仍在进行复制，则将跳过第二次复制操作。

所以问题是，你的索引有多大，同步索引到从服务器需要多长时间。同样，这是您需要尝试的。另一个因素是您可以/想要等待多长时间才能搜索到更改。从这个意义上说，刷新周期是非常特定于应用程序的。

# xcode - 如何在 xcode 中为 4 英寸屏幕制作应用程序而不是将其拉伸

> ID：13713777
> 
> 赞同：0
> 
> 时间：2012-12-04T23:23:09.750
> 
> 标签：xcode

当我为 4 英寸屏幕制作应用程序时，我只是把它拉长了！我不想这样做，我希望它在 iphone 4 和 5 上运行时看起来相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:12:10.507

您需要让图像的一部分可拉伸，例如，如果您有一个圆角背景，您可以拉伸它的中心而不会使角变形。任何其他类型的背景也是如此（我假设您有一个需要拉伸的背景）。一旦决定了要变形的部分，就可以使用 UIImage`stretchableImageWithLeftCapWidth:topCapHeight:`来避免拉伸其余部分。

如果您还没有准备好妥协和拉伸图像的一部分，恐怕您将不得不使用 2 张不同的图像，一张用于 4 英寸（iPhone 5），一张用于 3.5 英寸（iPhone <5）。

# ios - 使用 facebook 开放图的无摩擦共享间歇性失败 - iOS

> ID：13713780
> 
> 赞同：2
> 
> 时间：2012-12-04T23:23:22.497
> 
> 标签：ios, facebook, facebook-graph-api

当我执行我想在 facebook 活动中显示的操作时，有时会收到此错误代码（尤其是对于我以前或最近未与之交互的对象）：

> 打开图表日志：错误：域 = com.facebook.sdk，代码 = 5

重复该操作后，它最终会起作用，在 facebook 上正确显示该活​​动并返回如下所示的消息：

> 打开图表日志：发布打开图表操作，id：10151538299634942

打开的图形信息嵌入在我们的 Web 服务器上的页面中，self.recipe.URLatThisApp 是对象的 URL。我一直在尝试调试它，但我不确定错误在哪里。将不胜感激任何指针。

注意：我们刚刚在我们的网站上对此进行了测试，并且网站上的开放图无摩擦共享的行为方式相同。所以我们不认为问题是特定于 iOS 的，或者我们在 iOS 和 Web 实现中都犯了同样的错误。

```
NSMutableDictionary *params = [[NSMutableDictionary alloc] init];
    [params setObject:self.recipe.URLatThisApp forKey:@"recipe"];
    NSLog(@"OPEN GRAPH SAVE");
    [FBRequestConnection startWithGraphPath:@"me/ThisAppns:save" parameters:params HTTPMethod:@"POST" completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
        NSString *alertText;
        if (!error) {
            alertText = [NSString stringWithFormat:
                         @"Posted Open Graph action, id: %@",
                         [result objectForKey:@"id"]];
        } else {
            alertText = [NSString stringWithFormat:
                         @"error: domain = %@, code = %d",
                         error.domain, error.code];
        }
        /*
        [[[UIAlertView alloc] initWithTitle:@"Result"
                                    message:alertText
                                   delegate:nil
                          cancelButtonTitle:@"Thanks!"
                          otherButtonTitles:nil]
         show];
         */
        NSLog(@"open graph log: %@", alertText);
    }

     ];

} 
```

# php - 使用 .htaccess 将子页面重定向到新域

> ID：13713782
> 
> 赞同：0
> 
> 时间：2012-12-04T23:23:44.753
> 
> 标签：php, .htaccess, redirect

我用过

```
RewriteEngine on
RewriteRule (.*) http://newdomain.com/$1 [R=301,L] 
```

成功地从 重定向`http://olddomain.com`到`http://newdomain.com`。但是子页面`http://olddomain.com/subpage`仍然没有重定向到`http://newdomain.com/subpage`

如何做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T13:19:47.167

最简单的解决方案可能是在 RewriteEngine 上线之前放置以下规则：

```
RedirectMatch 301 (.*) http://newdomain.com$1 
```

这应该绕过您可能拥有的任何重定向规则或冲突，并强制所有内容重定向。

# apache - 有条件的 ModRewrite

> ID：13713783
> 
> 赞同：0
> 
> 时间：2012-12-04T23:23:54.993
> 
> 标签：apache, mod-rewrite

我正在尝试创建一个条件规则，如果它匹配（图像、样式表、javascript）然后对 url 不做任何事情，如果 url 不包括捐赠从 https 到 http 的更改

她就是我现在拥有的。

```
 RewriteEngine On

    RewriteCond %{QUERY_STRING} images [OR]
    RewriteCond %{QUERY_STRING} stylesheets [OR]
    RewriteCond %{QUERY_STRING} javascript
    RewriteRule ^.*$ - [NC,L] 

RewriteCond %{QUERY_STRING} !donate
    RewriteCond %{REQUEST_URI} !donate
RewriteRule (.*) http://www.creative-capital.org$1/ [R] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:34:12.227

我不确定您要实现什么，但对于初学者来说，QUERY_STRING 仅包括 ? 在网址中。如果这不是您想要的，那么您可能想要使用 THE_REQUEST。此外，您为什么不将所有条件（是否定的）放在第二条规则上，而不是创建“什么都不做”规则。

# javascript - 使用 d3.nest() 在 JavaScript 中对数组求和第二部分

> ID：13713784
> 
> 赞同：0
> 
> 时间：2012-12-04T23:24:00.447
> 
> 标签：javascript, d3.js

我最近发布了[这个](https://stackoverflow.com/questions/13379912/javascript-summing-arrays-using-d3-nest)关于使用 d3.nest() 在 JavaScript 中对数组求和的问题

我得到了一个很好的解决方案（实际上是两个），但事实证明，当适应附加附加信息时，两者都有问题：

```
data = [
  {
    continent: 'africa',
    country: 'gabon',
    values: [1, 2]
  }, {
    continent: 'africa',
    country: 'chad',
    values: [3, 4]
  }, {
    continent: 'asia',
    country: 'china',
    values: [1, 2]
  }
];

sum_by = 'continent';

rollupAgg = function(data, sum_by) {
  return d3.nest().key(function(d) {
    return d[sum_by];
  }).rollup(function(group) {
    return group.reduce(function(prev, cur, index, arr) {
      return {
        values: prev.values.map(function(d, i) {
          return d + cur.values[i];
        }),
        sum_by: sum_by       // additional information
      };
    });
  }).entries(data);
}; 
```

如果该组中只有一行，reduce() 不会运行，因此返回以下内容：

```
[
  {
    "key": "africa",
    "values": {
      "values": [4, 6],
      "sum_by": "continent"
    }
  }, {
    "key": "asia",
    "values": {
      "continent": "asia",
      "country": "china",   // country information shouldn't have been retained
      "values": [1, 2]
    }                       // sum_by information should have been added
  }
]; 
```

您能找到一种修改此函数以使其返回所需结果的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T00:15:11.703

到目前为止，我还没有想到单个元素数组不会执行该函数；但这是有道理的，因为您使用的是单个参数：

```
[].reduce(function(prev, curr, i, arr) {});// <-- function is the only param 
```

当与单个参数一起使用时，行为是函数第一次执行时，`i`等于 1（不是 0），并且`prev`是`curr`数组的第一个和第二个元素。由于您只有一个元素，因此无法以这种形式调用它。

如果您将 reduce 与第二个参数一起使用：

```
[].reduce(function(prev, curr, i, arr) {}, { foo:'bar' });// <-- 2nd param {foo:bar} 
```

它确实调用了该函数，第一个调用传递`i`等于 0 和`prev`equaling `{ foo:'bar' }`。

所以我猜你有两个选择：

1.  要么修改它以传递第二个参数，在你的情况下需要它`{ values:[0,0] }`（并且硬编码始终是 2 个元素的事实，`values`如果它更长会导致问题）。

2.  检查是否`group.length == 1`和如果是`return group`，而不是调用reduce。

# objective-c - 使用预处理器检测 iPhone 5

> ID：13713787
> 
> 赞同：0
> 
> 时间：2012-12-04T23:24:32.943
> 
> 标签：objective-c, ios, ios5

有什么方法可以将设备类型设为#define？我想为通用应用程序获取这个，我想知道它是 iPad、iPhone4 还是 iPhone5。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:25:54.650

```
#define IS_WIDESCREEN ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON )
#define IS_IPHONE ( UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone )
#define IS_IPHONE_5 ( IS_IPHONE && IS_WIDESCREEN )
#define IPAD (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T00:07:52.980

反问：

当有可用的方法时，为什么要使用宏？
该宏以任何方式转换为方法调用，因为在编译时您无法知道在运行时您将遇到什么设备。

您正在运行的设备是 iPad，如果它这样说：

```
BOOL isThisAnIPad = [[UIDevice currentDevice] userInterfaceIdiom] == UIInterfaceIdiomPad; 
```

除此之外，您可以通过使用正确的值加上通常用于视网膜图形的[后缀来自动获得正确的资源。](http://developer.apple.com/library/ios/documentation/CoreFoundation/Conceptual/CFBundles/AccessingaBundlesContents/AccessingaBundlesContents.html#//apple_ref/doc/uid/10000123i-CH104-SW16)`@2x`

# c - 具有灵活数组成员的常量结构

> ID：13713788
> 
> 赞同：1
> 
> 时间：2012-12-04T23:24:36.200
> 
> 标签：c, struct, constants, variable-length-array

请考虑以下两种结构：

```
typedef struct { 
    int num_data;
    char * name_data;
    int data[]; 
} part_t; 
typedef struct { 
    int num_parts;
    char * name_parts;
    part_t parts[]; 
} container_t; 
```

理想情况下，我可以像这样初始化一个容器：

```
const container_t container = { 
    2,
    "Name of first container", 
    { 
            { 4, "Name of first part", { 1, 2, 3, 4 } }, 
            { 5, "Name of first part", { 1, 2, 3, 4, 5 } } 
    } 
}; 
```

我的编译器说：“错误：初始化程序太多”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:48:23.117

**ISO/IEC 9899:2011 §6.7.2.1 结构和联合说明符**

> 3 结构或联合不应包含不完整或函数类型的成员（因此，结构不应包含自身的实例，但可能包含指向自身实例的指针），但结构的最后一个成员具有更多一个命名成员可能具有不完整的数组类型；这样的结构（以及任何可能递归地包含此类结构的成员的联合）不应是结构的成员或数组的元素。
> 
> 18 作为一种特殊情况，具有多个命名成员的结构的最后一个元素可能具有不完整的数组类型；这称为灵活数组成员。在大多数情况下，灵活数组成员被忽略。特别是，结构的大小就像省略了柔性数组成员一样，只是它可能具有比省略所暗示的更多的尾随填充。然而，当一个 . （或->）运算符的左操作数是（指向）具有灵活数组成员的结构，右操作数命名该成员，它的行为就像该成员被替换为最长的数组（具有相同的元素类型) 不会使结构大于被访问的对象；数组的偏移量应保持灵活数组成员的偏移量，即使这与替换阵列的不同。如果这个数组没有元素，它的行为就好像它有一个元素，但如果尝试访问该元素或生成一个越过它的指针，则行为是不确定的。

问题是您不能将具有灵活数组成员的结构嵌入到数组或其他结构中。您可以拥有指向此类结构的指针，但不能拥有此类结构的实例。

# python - matplotlib 中特定于图形的属性与一般属性

> ID：13713792
> 
> 赞同：2
> 
> 时间：2012-12-04T23:25:42.820
> 
> 标签：python, matplotlib, figure

我试图了解 matplotlib 中方法和属性的组织方式。例如，假设我有一个图：

```
import matplotlib.pyplot as plt
my_fig = plt.imshow(image) 
```

我注意到一些图形属性是通过模块方法设置的，例如：

```
plt.axis('off') 
```

而其他人则使用对象方法为图形本身设置：

```
my_fig.set_cmap('hot') 
```

可以以任何一种方式指定图形属性吗？

如何通过调用我的对象上的方法来`off`打开？`axis``my_fig`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:25:04.490

这些`plt`方法是[pyplot API](http://matplotlib.org/api/pyplot_api.html)的一部分，它旨在为交互使用提供类似 Matlab 的便利（当然似乎受到 Matlab 的很大影响）。[但这只是整个matplotlib API](http://matplotlib.org/api/index.html)的一小部分（更多的是 OOP）。在实践中，我似乎最终自己在 SW 中混合了它们。无论您是通过 pyplot API 还是访问对象，这在很大程度上是一个品味问题。pyplot 当然非常方便，尽管当您想做更复杂/异国情调的事情时，您会发现单独使用 pyplot 可以做的事情是有限的，您至少需要了解完整的 API 的 Axes、Figure、Legend 和 Path 对象更好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:19:36.420

[Pyplot](http://matplotlib.org/api/pyplot_api.html#module-matplotlib.pyplot)是使 matplotlib 像 MATLAB 一样工作的命令样式函数的集合，matplotlib.figure.Figure 是面向对象 API 的一部分。

在大多数情况下，您可以像这样通过自身配置图形设置：

```
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
image=mpimg.imread('stinkbug.png')
my_fig = plt.imshow(image)
my_fig.axes.axes.get_xaxis().set_visible(False)
my_fig.axes.axes.get_yaxis().set_visible(False)
plt.show()
enter code here 
```

**所需的臭虫.png：**

![臭虫.png](../Images/2cd60c8def244d8c74b4bb92a4009e9b.png)

**结果：**

![屏幕.jpg](../Images/9422a37d5987f17716e9c794f09ff81d.png)

# python - Django：unicode字符串作为非unicode写入数据库

> ID：13713793
> 
> 赞同：0
> 
> 时间：2012-12-04T23:25:44.087
> 
> 标签：python, django

我编写了一个基本脚本，将数千个值导入 Django 数据库。这是它的样子：[链接](http://pastebin.com/FDAyYLGs)。

这些位置以西里尔字母表示，并表示为 unicode 文字。但是，一旦我将它们保存到数据库中，它们就会以某种十六进制编码转换为看似编码的简单字符串：

```
>>> Region.objects.all()[0].parent
'\xd0\xbe\xd0\xb1\xd0\xbb\xd0\xb0\xd1\x81\xd1\x82 \xd0\xa1\xd0\xbb\xd0\xb8\xd0\xb2\xd0\xb5\xd0\xbd' 
```

令人惊讶的是，它们在管理面板中正确显示，但我在尝试使用它们时遇到了麻烦。如何以 Unicode 格式存储和检索它们？

我在 MySQL 上运行 Django 1.4.0，排序规则设置为 utf8_bin。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:39:38.017

看起来数据是作为 UTF-8 字节字符串而不是 Unicode 字符串返回的。尝试解码：

```
>>> x='\xd0\xbe\xd0\xb1\xd0\xbb\xd0\xb0\xd1\x81\xd1\x82 \xd0\xa1\xd0\xbb\xd0\xb8\xd0\xb2\xd0\xb5\xd0\xbd'
>>> x.decode('utf-8')
u'\u043e\u0431\u043b\u0430\u0441\u0442 \u0421\u043b\u0438\u0432\u0435\u043d'
>>> print x.decode('utf-8')
област Сливен 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:45:13.233

这是 Django/MySQL 的“错误”。请参阅问题[#16052](https://code.djangoproject.com/ticket/16052)。它实际上[记录在这里](https://docs.djangoproject.com/en/1.5/ref/databases/#collation-settings)。

# perl - Perl 合并两个文件并删除重复项 - 令人困惑的问题

> ID：13713796
> 
> 赞同：-2
> 
> 时间：2012-12-04T23:26:13.137
> 
> 标签：perl, merge, text-files

**我目前正在尝试在 perl 脚本中合并两个不同的文本文件**- 但是它比这更复杂一些。

问题（为了便于解释略有改动）：

我有两个不同的文本文件，一个命名`dog1.txt`一个命名`dog2.txt`（如下所示）。

```
dog1.txt
    poodle     8888
    jackrussel    5743
    beagle     6784

dog2.txt 
    spaniel    9843
    poodle    3756
    germanshepard    3267
    beagle    3478 
```

如您所见，poodle 和 beagle 都包含在两个文本文件中，但与它们关联的四位代码不同。

我想要的是创建一个将这两个文件合并在一起的新文件，如果有任何重复项，例如贵宾犬和比格犬，我希望新文件包含与贵宾犬和比格犬相关的四位数字来自 dog1.txt 文件而不是 dog2.txt。

新文件需要如下所示（狗名的顺序无关紧要，与它们相关的数字需要正确）：

```
final_dog.txt
    poodle    8888
    germanshepard    3267
    jackrussel    5743
    beagle    6784
    spaniel    9843 
```

我尝试了许多不同的解决方案，但没有一个能像我需要的那样可靠地工作。

非常感谢任何帮助，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:49:56.533

您基本上想打印遇到的第一个实例。因此，您可以使用标准习语来删除重复项。

```
perl -lane'print if !$seen{$F[0]}++' dog1.txt dog2.txt >final_dog.txt 
```

这种方法使用的内存最少。它还尽可能早地开始产生输出（如果您正在管道输出，则很有用）。

* * *

为了满足新的要求，使用

```
perl -lane'print if @F==2 && $F[1]=~/^\d+\z/ && !$seen{$F[0]}++' \
   dog1.txt dog2.txt >final_dog.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:44:24.743

作为一个单行：

```
perl -MData::Dumper -lwe '
           $d = pop;             # save filename for later
           %d = map split, <>;   # process dog1.txt
           push @ARGV, $d;       # put the second file name back
           while (<>) {          # add new entries, unless already defined
               my ($dog,$num) = split; $d{$dog} //= $num; 
           } 
           print Dumper \%d' dog1.txt dog2.txt 
```

**输出：**

```
$VAR1 = {
          'poodle' => '8888',
          'spaniel' => '9843',
          'germanshepard' => '3267',
          'beagle' => '6784',
          'jackrussel' => '5743'
        }; 
```

`@ARGV`此解决方案使用菱形运算符对参数进行的隐式打开`<>`。`//=`定义或赋值运算符不会覆盖已经定义的值。

正如 ikegami 巧妙地指出的那样，可以通过颠倒参数来消除检查值的必要性。那么这变得非常简单：

```
perl -MData::Dumper -lwe '
           %d = map split, <>; 
           print Dumper \%d' dog2.txt dog1.txt   # note reversed args 
```

我将把打印语句留给你，因为你没有指定你的文件是制表符分隔的还是其他的。但是您可能会执行以下操作：

```
print join "\t", $_, $d{$_} for keys %d;      # tab separated
printf "%-20s %s\n", $_, $d{$_} for keys %d;  # fixed width 
```

请注意，这是一种破坏性的解决方案，与 ikegami 保留原始格式的答案不同。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-05T01:08:15.937

该解决方案可以满足您的要求，此外它还满足每行值可能包含空格的情况。

```
use strict;
use warnings;

my %data;

for my $file (qw/ dog2.txt dog1.txt /) {

  open my $fh, '<', $file or die $!;

  while (<$fh>) {
    $data{$1} = $2 if /(\S+)\s+(\S(?:.*\S)?)/;
  }
}

while (my ($key, $val) = each %data) {
  print "$key $val\n";
} 
```

**输出**

```
poodle 8888
spaniel 9843
germanshepard 3267
beagle 6784
jackrussel 5743 
```

# php - 如何在 Wordpress 中安排任务每周运行一次

> ID：13713804
> 
> 赞同：0
> 
> 时间：2012-12-04T23:26:40.813
> 
> 标签：php, wordpress, cron

wp_schedule_event($timestamp, $recurrence, $hook, $args);

$recurrence (string) (required) 事件应该多久重新发生一次。有效值如下。您可以使用 wp_get_schedules() 中的 cron_schedules 过滤器创建自定义间隔。

```
 hourly
    twicedaily
    daily

    Default: None 
```

但是如果我想每周运行一次任务怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:40:39.003

来自手册：[http ://codex.wordpress.org/Function_Reference/wp_get_schedules](http://codex.wordpress.org/Function_Reference/wp_get_schedules)

```
add_filter( 'cron_schedules', 'cron_add_weekly' );

 function cron_add_weekly( $schedules ) {
    // Adds once weekly to the existing schedules.
    $schedules['weekly'] = array(
        'interval' => 604800,
        'display' => __( 'Once Weekly' )
    );
    return $schedules;
 } 
```

# vim - 在 vim 中为 Latex 插件添加语法高亮

> ID：13713806
> 
> 赞同：4
> 
> 时间：2012-12-04T23:26:50.983
> 
> 标签：vim, latex, syntax-highlighting

我正在使用一个名为`outlines`LaTeX 的包。它添加了诸如此类的命令`\1` `\2` `\3`。

默认情况下，它们在 vim 中不突出显示。因此，我在 .vimrc/syntax 文件夹中创建了一个名为`tex.vim`的文件，并将其放入文件中：

```
:syn match outline /\\[1-9]/
hi link outline Label 
```

这**仅在顶层有效，而不是在 block 内**。换句话说，它在 my 之前有效`\begin{document}`，但不在`\begin{document}`and之间`\end{document}`。

这几乎没用。无论它出现在文档中的什么位置，如何让 vim 识别语法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T07:43:15.067

您需要找到由 Tex 语法定义的语法组或集群，然后使用`contained containedin=...`，但在您的情况下，已经有一个语句的语法组，只是它不包含数字。因此，您可以仅搭载现有组并仅添加数字匹配：

```
:syn match texStatement /\\\d/ 
```

# asp.net-mvc - 关于elmah的一些问题

> ID：13713808
> 
> 赞同：1
> 
> 时间：2012-12-04T23:27:01.250
> 
> 标签：asp.net-mvc, elmah, elmah.mvc

我刚刚在我的 MVC4 应用程序中设置了 elmah，并且对此有一些疑问。以前我推出了自己的异常处理，所以我是新手。

是否可以设置 elmah 将某些异常记录到事件日志或/和文本文件中？还是需要像 nlog 这样的东西来补充 elmah？

当发生异常时，我会将用户重定向到错误页面。我想在错误页面上包含异常的唯一 ID。这样我就可以让用户报告一个 ID，并且我可以检查我的日志以了解错误是什么。elmah 是否为错误创建一个唯一的 ID？如果是这样如何访问它。如果没有，是否容易添加？

最后，是否可以将自定义信息添加到 elmah 捕获的错误中？例如，在我的系统上，所有用户都标有唯一的 id，这可以包含在 elmah 记录的内容中吗？

# c# - WPF CommandParameter MultiBinding 值 null

> ID：13713814
> 
> 赞同：9
> 
> 时间：2012-12-04T23:27:56.647
> 
> 标签：c#, wpf, binding, .net-4.0, multibinding

我只是想将两个控件绑定为命令参数，并将它们作为`object[]`.

XAML：

```
<UserControl.Resources>
        <C:MultiValueConverter x:Key="MultiParamConverter"></C:MultiValueConverter>
    </UserControl.Resources>

    <StackPanel Orientation="Vertical">
        <StackPanel Orientation="Horizontal">
            <Button Name="Expander" Content="+" Width="25" Margin="4,0,4,0" Command="{Binding ExpanderCommand}">
                <Button.CommandParameter>
                    <MultiBinding Converter="{StaticResource MultiParamConverter}">
                        <Binding ElementName="Content"/>
                        <Binding ElementName="Expander"/>
                    </MultiBinding>
                </Button.CommandParameter>
            </Button>
            <Label FontWeight="Bold">GENERAL INFORMATION</Label>
        </StackPanel>
        <StackPanel Name="Content" Orientation="Vertical" Visibility="Collapsed">
            <Label>Test</Label>
        </StackPanel>
    </StackPanel> 
```

命令：

```
public ICommand ExpanderCommand
        {
            get
            {
                return new RelayCommand(delegate(object param)
                    {
                        var args = (object[])param;
                        var content = (UIElement)args[0];
                        var button = (Button)args[1];
                        content.Visibility = (content.Visibility == Visibility.Visible) ? Visibility.Collapsed : Visibility.Visible;
                        button.Content = (content.Visibility == Visibility.Visible) ? "-" : "+";
                    });
            }
        } 
```

转换器：

```
public class MultiValueConverter : IMultiValueConverter
    {
        public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return values;
        }

        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException("No two way conversion, one way binding only.");
        }
    } 
```

基本上发生的事情是绑定似乎工作正常并且转换器返回一个`object[]`包含正确值的值，但是当命令执行时，参数是一个`object[]`包含相同数量的元素，除了它们是`null`。

有人可以告诉我为什么将`object[]`参数的值设置为`null`？

谢谢，亚历克斯。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-05T11:30:36.503

这会做到：

```
public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
{
    return values.ToArray();
} 
```

看看这个[问题](https://stackoverflow.com/questions/10759523/using-imultivalueconverter-to-pass-multiple-commandparameters-to-viewmodel)的解释。

# javascript - 从不同的上下文调用 JQuery 函数

> ID：13713815
> 
> 赞同：0
> 
> 时间：2012-12-04T23:27:56.230
> 
> 标签：javascript, jquery

这可能是一个非常基本的问题，但我试图理解这种行为

这是我的 JavaScript 代码。我想知道为什么第二次调用 foo 不起作用。这是[JSFiddle 链接](http://jsfiddle.net/kwdxa/)

```
$.fn.foo = function(somestring){
  var $this = this;
  $this.html(somestring);
}

$(function(){
    $('#container').foo("within function"); //this works
});

$('#container').foo("outside"); //this does not 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:29:15.057

满载..这`DOM is not`就是它不起作用的原因..

因此，当您将代码封装在`DOM Ready`处理程序中时，它会等待文档被加载，然后在其中运行代码。

这确保元素在其上运行任何代码之前可用。

当 时`HTML document is parsed`，它自上而下解析。

因此，如果脚本包含在 head 部分中，则首先加载脚本，然后加载 HTML 结构。当您尝试运行代码时，它显然无法正常工作，因为该元素仍未被解析。

因此，将其封装在处理程序中将确保元素在调用它们的方法之前可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:32:22.667

这是因为在处理`$('#container').foo("outside");`之前评估`body`。`$('#container')`将返回长度为 0。这在下面演示。

```
$.fn.foo = function(somestring){
  var $this = this;
  $this.html(somestring);
}

$(function(){
    $('#container').foo("within function");
});

var element = $('#container');
console.log(element.length); //prints 0
element.foo("outside"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:49:52.927

如果脚本位于页面的开头，则 HTML 文档的其余部分尚未被解析，因此该文档在脚本看来是空的，因此还没有 #container。

```
$(function() { ... }); 
```

（大致）相当于

```
Wait till the whole HTML file is loaded and ready
Then execute function 
```

所以#container 会在那里并且它会工作。使其工作的另一种方法是将脚本放在页面的其余部分下方或至少在#container 下方。

# python - Twitter情绪分析技术

> ID：13713817
> 
> 赞同：4
> 
> 时间：2012-12-04T23:28:13.130
> 
> 标签：python, nltk

我正在做一个关于 twitter 情绪分析的项目，但有些事情我正在思考。

由于推文非常短（少于 140 个字符），因此文本分析技术最适用。例如。词干提取和在长篇文章中一样有效吗？

那么 n-gram 呢？推文的简短性对他们来说是最好的还是最坏的？

k-nearest 会比词性标注更准确吗？

随着时间的推移，我的自定义 Twitter 数据集会变得无关紧要/损坏吗？由于 Twitter 及其上的信息变化如此之快，这对我来说也是一个主要问题。

非常感谢您的时间。

PS：你有什么好的推特情绪数据集吗？如果能定期更新就好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T00:23:42.570

我做了一些课堂作业，分析名人的推文并比较他们的相似之处。

您认为最重要的是推文的长度。在 140 个字符处，许多单词被缩短，或不寻常的“txt-speech”。[因此，即使是像Porter](http://tartarus.org/martin/PorterStemmer/index-old.html)这样知名的词干分析器也会给出一些奇怪的结果。最好保留几乎所有内容，仅在字数、向量等之后进行规范化。

对于从单词进行推断，n-gram 和后续链接是质量推理的一个重要因素。我只能容忍 4 克的空间和时间要求，但即使创建简单的 2 克也有很大的改进。

如果你注意到我之前说的“几乎所有”。在我只关注流行的名人推文的情况下，我遇到了一个问题，即他们的很多推文都是指向他们的活动或赞助商等的链接或大喊大叫。所以很大一部分是删除大量重复的垃圾邮件。

对于提取准确情绪或您正在寻找的任何衡量标准的方法，我会首先尝试基于朴素贝叶斯的方法。它是简单且相对准确的基线。K-means 会做得相当好，但请记住，它没有考虑方差和协方差，但仍然是另一个可以尝试的基准。

希望能提供一些见解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T08:51:57.957

我最近在推特的基础上对一部电影进行了分析，以了解人们在推特上关于这部电影的内容，他们喜欢与否的天气。这个链接[http://www.laurentluce.com/posts/twitter-sentiment-analysis-using-python-and-nltk/](http://www.laurentluce.com/posts/twitter-sentiment-analysis-using-python-and-nltk/)帮助了我很多。此外，我还必须收集在推文时通常使用的快捷方式列表，其中涵盖了情绪。

另外，一个人的推文只能保存到 3000 条（或 3.5k 不确定？），您自己的时间线流也有类似的限制。[因此，您可以使用http://topsy.com](http://topsy.com)获取您选择或主题的推文，并从那里获取特定主题的旧推文进行分析。您可能还希望定期保存推文以供将来参考，因为 twitter 不会为您保存。

:)

# php - PHP 字符串和连接

> ID：13713821
> 
> 赞同：0
> 
> 时间：2012-12-04T23:28:32.577
> 
> 标签：php, string, quotes

我已经更改了代码，现在出现了一个新错误：

```
Parse error: syntax error, unexpected '<' in
 /webroot/c/o/..../...../www/a/drop_down_car_test.php on line 19 
```

这是代码：

```
<?php

//////connecting to our sql server
$db_connect=mysql_connect("xxxx", "xxxxxxxxx", "xxxxxxxxxx")     or die("not logged in");
//////now selecting our database
$db_select=mysql_select_db("coden003_car") or die(mysql_error());
////this query is used the first time the page loads
$query = mysql_query("SELECT * FROM car "); 

echo '<form action="drop_down_car_test.php?" method="GET">';
echo '<table border = \"1\">';
echo '<tr><td>id</td><td>car</td><td>name</td>';

while($row=mysql_fetch_array($query)){
echo "<tr><td>";
echo $row['id'];
echo "</td><td>";
echo "<select name='carDropDown." . $row['id'] . "' >";
<option value="1">ford</option>;  <---------line 19
<option value="2">toyota</option>;
<option value="3">gmc</option>;
</select>";
echo "</td><td>";
echo $row['name'];
echo "</td><td>";
}////end while
echo"<table>";

echo '<td bgcolor=#7FFF00><input type="submit" value="Update"></td>';
echo "</form>";

?> 
```

我习惯于 C++ 使用引号，而 PHP 让我感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T00:32:01.673

在您的代码中：

```
echo '<select name="carDropDown.$row['id']"> 
```

你需要做到：

```
echo "<select name=\"carDropDown.{$row['id']}\"> 
```

您没有转义`'`，而且您不能在单引号内使用变量，但可以在双引号内使用一个变量（数组调用必须包含在 { 和 } 中）。

当然`'`，该字符串末尾的关闭需要更改为`"`

而且您在该字符串的末尾缺少一个分号。

而且您没有关闭该块（您忘记了关闭`}`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T00:38:27.320

试试这些：

```
echo "<select name='carDropDown." . $row['id'] . "' >"; 
```

或者

```
echo "<select name=carDropDown.$row['id'] >"; 
```

* * *

在 PHP 中，您可以像这样 CONCAT 字符串：

```
echo "hello" . "world" . $yourVariable . " Something else "; 
```

[http://php.net/manual/en/internals2.opcodes.concat.php](http://php.net/manual/en/internals2.opcodes.concat.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T01:05:47.970

命名的另一种方法是使用作为数组键的数组创建一个数组`<select>`，这将使它更容易阅读。`$_GET[]``carDropDown``$row['id']`

```
echo '<select name="carDropDown['.$row['id'].']"> 
```

现在在 php 方面你可以做 -

```
foreach ($row['id'] as $id){
$carName=$_GET['carDropDown'][$id]];
echo $carName;} 
```

# ruby-on-rails - Rails：Messages_Users 加入模型无法正常运行？

> ID：13713826
> 
> 赞同：0
> 
> 时间：2012-12-04T23:29:09.290
> 
> 标签：ruby-on-rails

我正在尝试使用`Message`和`User`. 由于它是多对多关系，我有一个名为的连接模型`messages_users`

架构：

```
ActiveRecord::Schema.define(:version => 20121204230411) do

  create_table "messageattachments", :force => true do |t|
    t.string   "picture"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  create_table "messages", :force => true do |t|
    t.string   "content"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  create_table "messages_users", :force => true do |t|
    t.integer  "receiver_id"
    t.integer  "sender_id"
    t.datetime "created_at",          :null => false
    t.datetime "updated_at",          :null => false
    t.integer  "sent_message_id"
    t.integer  "received_message_id"
  end

  create_table "users", :force => true do |t|
    t.string   "name"
    t.string   "email"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

end 
```

楷模：

```
class Message < ActiveRecord::Base
  attr_accessible :content

  has_many :messages_users
  has_many :receivers, :through => :messages_users
  has_many :senders, :through => :messages_users

end

class User < ActiveRecord::Base
  attr_accessible :email, :name

  has_many :messages_users
  has_many :sent_messages, :through => :messages_users
  has_many :received_messages, :through => :messages_users
end

class MessagesUsers < ActiveRecord::Base
  attr_accessible :sent_messages_id, :received_messages_id, :receiver_id, :sender_id

  belongs_to :sent_messages, :class_name => "Message", :foreign_key => "sent_message_id"
  belongs_to :received_messages, :class_name => "Message", :foreign_key => "received_message_id"
  belongs_to :receivers, :class_name => "User", :foreign_key => "receiver_id"
  belongs_to :senders, :class_name => "User", :foreign_key => "sender_id"
end 
```

我正在尝试运行一个简单的测试：

```
require 'test_helper'

class MessageTest < ActiveSupport::TestCase
  test "has senders" do
    message = Message.create(:content => "hi")
    message.sender = User.first #Am I allowed to an instance of another Model in unit tests?
    assert message.sender.valid?
  end 
```

无论我测试什么，我总是会得到这个错误：

```
# Running tests:

E

Finished tests in 0.083961s, 11.9103 tests/s, 0.0000 assertions/s.

  1) Error:
test_has_senders(MessageTest):
ActiveRecord::StatementInvalid: PG::Error: ERROR:  column "receiver_id" of relation "messages" does not exist
LINE 1: INSERT INTO "messages" ("content", "receiver_id", "sender_id...
end 
```

有人可以帮我吗？我没有看到我的模型有任何问题..

```
Loading development environment (Rails 3.2.8)
1.9.3-p194 :001 > message = Message.create(:content => "hi")
   (0.2ms)  BEGIN
  SQL (22.6ms)  INSERT INTO "messages" ("content", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["content", "hi"], ["created_at", Tue, 04 Dec 2012 23:58:19 UTC +00:00], ["updated_at", Tue, 04 Dec 2012 23:58:19 UTC +00:00]]
   (0.8ms)  COMMIT
 => #<Message id: 1, content: "hi", created_at: "2012-12-04 23:58:19", updated_at: "2012-12-04 23:58:19"> 
1.9.3-p194 :002 > message.sender = User.first
  User Load (0.6ms)  SELECT "users".* FROM "users" LIMIT 1
NoMethodError: undefined method `sender=' for #<Message:0x007f92441ac538>
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activemodel-3.2.8/lib/active_model/attribute_methods.rb:407:in `method_missing'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/attribute_methods.rb:149:in `method_missing'
    from (irb):2
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'
1.9.3-p194 :003 > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:39:10.590

似乎您的测试数据库尚未正确创建或迁移。

尝试运行`rake db:create`并`rake db:migrate RAILS_ENV=test`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T00:08:19.877

您似乎混淆了单数和复数形式。您有`belongs_to :receivers`（复数），但您将外键命名为`receiver_id`：

```
belongs_to :receivers, :class_name => "User", :foreign_key => "receiver_id" 
```

您当然可以随意命名这些东西，但默认（更明智，恕我直言）的措辞是命名关联`receiver`。

从有关[以下`foreign_key`选项`belongs_to`](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to)的文档中：

> 指定用于关联的外键。默认情况下，这被猜测为带有“_id”后缀的关联名称。所以定义了belongs_to :person 关联的类将使用“person_id”作为默认的:foreign_key。同样，belongs_to :favorite_person, :class_name => "Person" 将使用“favorite_person_id”的外键。

同样，在你 assign `message.sender = User.first`，但你的`Message`模型没有`sender`，它有`senders`（复数）。这就是您在控制台中收到错误的原因`NoMethodError: undefined method 'sender=' for #<Message:0x007f92441ac538>`。

如果您想要做的是将发件人添加到邮件并检查邮件是否有发件人，那么我认为这会起作用：

```
test "has senders" do
  message = Message.create(:content => "hi")
  user = User.create(...)
  message.senders << user
  assert message.senders.first.valid?
end 
```

虽然，老实说，我真的不明白这个测试的意义。我也不太明白为什么一条消息有多个发件人。这不应该只是简单的一对多关系吗？即一条消息`has_one :sender`。这对我来说很有意义。事实上，这里的整个模型设置有点令人困惑，如果你能弄清楚为什么要这样设置它会有所帮助。

# ios - 如何在 XCode 4.5 中更改产品名称？

> ID：13713830
> 
> 赞同：2
> 
> 时间：2012-12-04T23:29:33.143
> 
> 标签：ios, xcode

我有一个包含库和项目 A 的工作区，我想创建一个与 A 相同的项目 B，除了一些小调整。所以我复制了 A 的整个源文件集并制作了一个副本，将它们重命名为 B，然后将 B 项目添加到工作区中。

我为 B 创建了一个新方案，但是当我构建和运行应用程序时，应用程序具有 A 的名称。

我在看这个过去的问题 [Change product name macro in iOS XCode project](https://stackoverflow.com/questions/7016788/change-product-name-macro-in-ios-xcode-project)

但是在使用 XCode 4.5.2 时，我在 Packaging 设置中找不到 Product Name 行

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T23:33:02.233

单击侧栏中的项目名称（根节点）一次以将其选中。然后再次单击它进行编辑。

![在此处输入图像描述](../Images/d6e7dbfbf366723d0ae6c9eef6e200d0.png)

当您按回车键保存时，它会弹出一个确认对话框，显示将要进行的更改。

您可能需要更新您的开发者凭据以支持新应用。

编辑添加：

这应该是每个与 Xcode 相关的问题末尾的警告：重新启动 Xcode。它解决了疯狂的问题。:-)

# python - 使用静态点的贝塞尔曲线

> ID：13713831
> 
> 赞同：3
> 
> 时间：2012-12-04T23:29:34.723
> 
> 标签：python, python-imaging-library, bezier, curve

所以我在网上找到了这段代码，它做了一个使用随机点的随机贝塞尔曲线。我试图让它非随机，以便它使用静态点我让它只使用 4 个点，这很容易。我以前从未在 python 中使用过 PIL，实际上我正在慢慢学习 python。而且我只做过前端工作（html、javascript、css 等），我只是想知道是否有人可以帮助我。这是我在网上找到的代码：

```
# Random Bezier Curve using De Casteljau's algorithm
# http://en.wikipedia.org/wiki/Bezier_curve
# http://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm
# FB - 201111244
import random
from PIL import Image, ImageDraw
imgx = 500
imgy = 500
image = Image.new("RGB", (imgx, imgy))
draw = ImageDraw.Draw(image)

def B(coorArr, i, j, t):
    if j == 0:
        return coorArr[i]
    return B(coorArr, i, j - 1, t) * (1 - t) + B(coorArr, i + 1, j - 1, t) * t

n = 4 # number of control points
coorArrX = []
coorArrY = []
for k in range(n):
    x = (0, imgx - 1)
    y = (0, imgy - 1)
    coorArrX.append(x)
    coorArrY.append(y)

# plot the curve
numSteps = 10000    
for k in range(numSteps):
    t = float(k) / (numSteps - 1)
    x = int(B(coorArrX, 0, n - 1, t))
    y = int(B(coorArrY, 0, n - 1, t))
    try:
        image.putpixel((x, y), (0, 255, 0))
    except:
        pass

# plot the control points
cr = 3 # circle radius
for k in range(n):
    x = coorArrX[k]
    y = coorArrY[k]
    try:
        draw.ellipse((x - cr, y - cr, x + cr, y + cr), (255, 0, 0))
    except:
        pass

# image.save("BezierCurve.png", "PNG")
image.show() I add this so I can see it right away 
```

如果有任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:34:27.277

好的，开始这一切的详细的 BS 在长线下方。得到的答案在这里。

您的静态点是 x,y 坐标，其中 x 值和 y 值放置在单独的数组中（分别为 coorArrx 和 coorArrY）确保永远不要使用 value = imgx 或 imy。

```
# Random Bezier Curve using De Casteljau's algorithm
# http://en.wikipedia.org/wiki/Bezier_curve
# http://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm
# FB - 201111244
import random
from PIL import Image, ImageDraw
imgx = 500
imgy = 500
image = Image.new("RGB", (imgx, imgy))
draw = ImageDraw.Draw(image)

def B(coorArr, i, j, t):
    if j == 0:
        return coorArr[i]
    return B(coorArr, i, j - 1, t) * (1 - t) + B(coorArr, i + 1, j - 1, t) * t

# n = random.randint(3, 6) # number of control points
n=4
#coorArrX = []
#coorArrY = []
#for k in range(n):
#    x = random.randint(0, imgx - 1)
#    y = random.randint(0, imgy - 1)
#    coorArrX.append(x)
#    coorArrY.append(y)
coorArrX=[3,129,12,77]
coorArrY=[128,52,12,491]

# plot the curve
numSteps = 10000
for k in range(numSteps):
    t = float(k) / (numSteps - 1)
    x = int(B(coorArrX, 0, n - 1, t))
    y = int(B(coorArrY, 0, n - 1, t))
    try:
        image.putpixel((x, y), (0, 255, 0))
    except:
        pass

# plot the control points
cr = 3 # circle radius
for k in range(n):
    x = coorArrX[k]
    y = coorArrY[k]
    try:
        draw.ellipse((x - cr, y - cr, x + cr, y + cr), (255, 0, 0))
    except:
        pass
image.show() 
```

=.................................................. .........................................= 我对所有人来说也是一个新手对此，我拒绝像您一样查看它……学习经验。

但是当我查看这段代码时，我看到了一些奇怪的东西

```
for k in range(n):
    x = (0, imgx - 1)
    y = (0, imgy - 1)
    coorArrX.append(x)
    coorArrY.append(y) 
```

你确定这部分是正确的吗？imgx 在其他地方被定义为 500，而 n 是 4。所以这可以读作

```
for k in range(4):
    x = (0, 500 - 1)
    y = (0, 500 - 1) 
```

其中（因为这些值在此代码中根本不会改变）意味着：

```
x = (0, 499)
y = (0, 499) 
```

在每一次传球。所以每次他们到达：

```
coorArrX.append(x)
coorArrY.append(y) 
```

他们只是不断地将相同数据的新副本添加到数组中，所以当它完成时，数组看起来像这样（内部）

```
[(0, 499), (0, 499), (0, 499), (0,499)] 
```

更令人困惑的是， coorArrX 和 coorArrY 是 A) 相同的，并且 B) 其基本部分相同（即每个元素都是相同的）。因此，当您进入这部分代码时：

```
# plot the control points
cr = 3 # circle radius
for k in range(n):
    x = coorArrX[k]
    y = coorArrY[k]
    try:
        draw.ellipse((x - cr, y - cr, x + cr, y + cr), (255, 0, 0))
    except:
        pass 
```

并且你替换数组中的值，你得到：

```
# plot the control points
cr = 3 # circle radius
for k in range(n):
    x = coorArrX[k]
    y = coorArrY[k]
    try:
        draw.ellipse(((0, 499) - 3, (0, 499) - 3, (0, 499) + 3, (0, 499) + 3), (255, 0, 0))
    except:
        pass 
```

现在这是控制绘图曲线段绘制的部分，但我看不出将 elispe 居中在那些不可能的坐标集上如何绘制任何东西？！

分解并进行了复制粘贴测试。 ~~该代码纯粹是伪造的，要么是为了欺骗人们浪费时间，要么是出于同样的原因放置在 OP 发现它的地方。~~

但是尝试很有趣！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T01:10:21.967

根据您的描述，唯一的问题似乎与 Python 基础有关。我已经将代码重新排列如下，所以唯一需要触及的东西在底部。现在，如果您想手动指定 4 个控制点，请继续执行（在下面的代码中，我自己指定了其中的 4 个作为示例）。您需要了解，在原始代码中，`coorArrX`它们`coorArrY`只是列表，每个包含 4 个点（分别为 x 和 y 坐标）。如果您手动指定它们，则使用循环来编写它们是没有意义的。我希望这段代码足够清楚：

```
# Random Bezier Curve using De Casteljau's algorithm
# http://en.wikipedia.org/wiki/Bezier_curve
# http://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm
# FB - 201111244
from PIL import Image, ImageDraw

def plot_curve(image, px, py, steps=1000, color=(0, 255, 0)):
    def B(coord, i, j, t):
        if j == 0:
            return coord[i]
        return (B(coord, i, j - 1, t) * (1 - t) +
                B(coord, i + 1, j - 1, t) * t)

    img = image.load()
    for k in range(steps):
        t = float(k) / (steps - 1)
        x = int(B(px, 0, n - 1, t))
        y = int(B(py, 0, n - 1, t))
        try:
            img[x, y] = color
        except IndexError:
            pass

def plot_control_points(image, px, py, radi=3, color=(255, 0, 0)):
    draw = ImageDraw.Draw(image)
    for x, y in zip(px, py):
        draw.ellipse((x - radi, y - radi, x + radi, y + radi), color)

# Your fixed, manually specified, points.
n = 4
coord_x = [25, 220, 430, 410]
coord_y = [250, 10, 450, 40]

image = Image.new("RGB", (500, 500))

plot_curve(image, coord_x, coord_y)
plot_control_points(image, coord_x, coord_y)

image.save("BezierCurve.png") 
```

# ms-access - 为框架内的字段添加值

> ID：13713838
> 
> 赞同：0
> 
> 时间：2012-12-04T23:30:24.530
> 
> 标签：ms-access, vba

```
 Dim IE As InternetExplorer
    Set IE = New InternetExplorer
    Dim hDocument As MSHTML.HTMLDocument
    Dim hElementCollection As MSHTML.IHTMLElementCollection
    Dim hInputElement As MSHTML.htmlInputElement

    IE.Visible = True

    Dim url As String
    url = "www.blah.com"

    IE.Navigate url

    Call SleepIE(IE)
    PauseApp 3

    Dim xSom, xFrame As Object 
```

'这是检查原始链接是否导致登录页面，如果是则登录，否则重定向

```
If IE.LocationURL = url Then
Set xFrame = IE.Document.getElementById("infoView")
        PauseApp 3 ' pausing application for 3 seconds for everything to load
        Do While True
        xFrame.contentWindow.Document.getElementById("username").Value = "username"
         If Err.Number = 0 Then
                Exit Do
            ElseIf Err.Number > 0 And Err.Number <> 91 Then
                Exit Function
            End If
            Err.Clear
        Loop

        Do While True
        xFrame.contentWindow.Document.getElementById("password").Value = "password"
         If Err.Number = 0 Then
                Exit Do
            ElseIf Err.Number > 0 And Err.Number <> 91 Then
                Exit Function
            End If
            Err.Clear
        Loop
        xFrame.contentWindow.Document.Forms(0).submit
    End If

    PauseApp 3
    Call SleepIE(IE) ' awaiting ie ready state 
```

'这是我卡住的地方'我试图为“ListingURE_searchText”赋值，下面不起作用

```
 Set hElementCollection = IE.Document.frames("mainFrameSet").Document.frames("dataFrame").Document.frames("dataFrameSet").Document.frames("workspaceFrameSet").Document.all
        For Each hInputElement In hElementCollection
            If hInputElement.getAttribute("id") = "ListingURE_searchText" Then
            hInputElement.Value = "555"
            End If
        Next hInputElement 
```

我也试过

```
 Set hElementCollection = hDocument.getElementsByTagName("INPUT")
        For Each hInputElement In hElementCollection
            If hInputElement.getAttribute("id")
               hInputElement.Value = "test"
            End If
        Next hInputElement 
```

blow 是 20 页长的页面源代码的简短版本

```
<head>
<frameset id="mainFrameSet" rows="*">
<frame id="headerPlusFrame" scrolling="no" marginwidth="0" marginheight="0"     src="../listing
<iframe id="dataFrame"
<html>
<head>
<frameset id="dataFrameSet" rows="*,20">
<frameset id="centerFrameset" cols="*,0">
<frame id="workspaceFrame" frameborder="0" border="0" framespacing="2"    title="Workspace" src="workspace.do" name="workspaceFrame">
<html>
<head>
<frameset id="workspaceFrameSet" class="panelFrame" border="0" framespacing="0"     frameborder="0" rows="18,*">
<frame id="workspaceHeaderFrame" scrolling="no" noresize="" marginwidth="0"  marginheight="0" src="workspaceHeader.do?title=" title="Workspace Header" name="workspaceHeaderFrame">
<frame id="workspaceBodyFrame" noresize=""
<html>
<head>
<body onresize="resizeUreWithTimeout()" onload="onLoad()">
<form id="listingForm"
<table id="ListingURE" cellspacing="0" cellpadding="1" style="width: 1249px; height: 376px;">
<script type="text/javascript">
<tbody>
<tr>
<td valign="top">
<table id="ListingURE_toolbar0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<script type="text/javascript">
<td>
<script type="text/javascript">
<div id="ListingURE_toolbar0Container"
<table cellspacing="0" cellpadding="0">
<tbody>
<tr valign="middle">
<td>
<input id="**ListingURE_searchText**" class="textinputs" type="text" value=""  name="ListingURE_searchText" onselectstart="ev 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:20:48.863

您使用的看起来更像 oldskool VBscript。你真的不应该使用它。

下面是一个如何使用 getElementById 和 JavaScript 来设置文本框值的示例：

```
<div>
    <input type="text" id="ListingURE_searchText" />
    <input type="button" onclick="fnSetValue()" title="Set value" />
</div>

<script language="javascript" type="text/javascript">
    function fnSetValue() {
        document.getElementById('ListingURE_searchText').value = 'testing 123';
    }
</script> 
```

# javascript - 用于日期范围验证的 javascript

> ID：13713839
> 
> 赞同：0
> 
> 时间：2012-12-04T23:30:26.503
> 
> 标签：javascript, date

我有一个表单用户可以输入任何日期，但我想设置一个日期范围验证。例如：从 2012 年 1 月 12 日到 2013 年 1 月 1 日，系统无法接受来自用户的任何不在该范围内的日期。我试过这个 javascript 代码，但它甚至没有给我任何警报当日期不在范围内时..

这是我的表格的一部分：

```
 echo "<tr><th> Date </th>
  <td> <input type='date' id ='v2' name='v2' value=''   ></td></tr>";

echo "<tr><th> Time </th>
    <td> <input type='time' name='v3' value=''   ></td></tr>";

    echo "<tr><th> Place </th>
<td> <input type='text' name='v4' value=''   ></td></tr>"; 
```

这是javascript代码

```
<script language="javascript">

function validation(form)
 {
 var v2 = document.getElementById('v2');
 var date = v2.value;
 if ( v2 > new Date('1/12/2012') && 
    v2 < new Date('1/1/2013')) {
    // date is in your valid range
     return true;
} else {
    // date is not in your valid range
    alert("date is not in the range")
     return false;
}

}

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T00:59:07.090

您需要更改以下三行：

```
var date = v2.value;
 if ( v2 > new Date('1/12/2012') && 
    v2 < new Date('1/1/2013')) { 
```

至：

```
var date = new Date(v2.value);
if (date > new Date('1/12/2012') && 
    date < new Date('1/1/2013')) { 
```

看到它在这里工作：http: [//jsfiddle.net/xGWpW/1/](http://jsfiddle.net/xGWpW/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:35:10.213

您需要获取 v2 输入字段的值。目前您的代码不知道 v2 是什么。我建议您为输入提供一个 ID 并使用 document.getElementById。

```
<td> <input type='date' id= 'v2input' name='v2' value=''   ></td></tr>"; 
```

然后你可以得到它的值并在你的脚本中进行比较。

```
var v2 = document.getElementById('v2input');
var date = new Date(v2.value); 
```

一旦你真正有了日期值，你应该能够比较它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:36:14.193

除了必须设置变量“v2”的值外，您还必须将其转换为 Date 对象，以便能够比较它们。

# c# - SQL登录系统

> ID：13713853
> 
> 赞同：3
> 
> 时间：2012-12-04T23:32:20.140
> 
> 标签：c#, sql, database, login

这是我第一次在 StackOverflow 上提问，所以如果我问了不恰当的人，我提前道歉。在过去的几天里，我在研究这个问题时找不到任何可以帮助我的东西，所以提前感谢任何试图提供帮助的人。

我正在制作一个允许人们注册和登录的数据库。我在 VS2012 中使用 C#。下面是我的登录代码，我在测试时遇到了一些麻烦。它遍历数据库中的每个人，并告诉我登录失败，直到它到达正确的用户。

```
 private void button1_Click_1(object sender, EventArgs e)
    {
        try
        {
            cn.Open();
        }
        catch (Exception)
        {
            MessageBox.Show("Did not connect");
        }

        SqlCommand cmd = new SqlCommand("SELECT * FROM [Users]", cn);
        cmd.Connection = cn;
        SqlDataReader reader = null;
        reader = cmd.ExecuteReader();
        while (reader.Read())
        {
            if (textBox1.Text == (reader["Username"].ToString()) && textBox2.Text == (reader["Password"].ToString()))
            {
                MessageBox.Show("Logged in");
            }
            else
            {
                MessageBox.Show("Login has failed. Please check your Username and Password.");
            }
        }
        cn.Close();
    } 
```

至于我的注册部分，我不确定它是 VS2012 还是什么，但是在我结束调试后信息并没有保存到数据库中，然后再次返回调试。

```
 private void button1_Click_1(object sender, EventArgs e)
    {
        cn.Open();
        SqlCommand cm1 = new SqlCommand("INSERT INTO Users (Username, Password) VALUES (@Username, @Password)", cn);
        SqlCommand cm2 = new SqlCommand("INSERT INTO Contact(Name, Address, City, State, PostalCode, Email, PhoneNumber) VALUES(@Name, @Address, @City, @State, @PostalCode, @Email, @PhoneNumber)", cn);

        cm1.Parameters.AddWithValue("@Username", textBox1.Text);
        cm1.Parameters.AddWithValue("@Password", textBox2.Text);
        cm2.Parameters.AddWithValue("@Name", textBox3);
        cm2.Parameters.AddWithValue("@Address", textBox4);
        cm2.Parameters.AddWithValue("@City", textBox5);
        cm2.Parameters.AddWithValue("@State", textBox6);
        cm2.Parameters.AddWithValue("@PostalCode", textBox7);
        cm2.Parameters.AddWithValue("@Email", textBox8);
        cm2.Parameters.AddWithValue("@PhoneNumber", textBox9);

        try
        {
            int affectedRows =  cm1.ExecuteNonQuery(); //+cm2.ExecuteNonQuery();

            if (affectedRows > 0)
            {
                MessageBox.Show("Insert Sucsess!", Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
            else
            {
                MessageBox.Show("Insert Failed!", Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
        cn.Close();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:46:12.443

当您的项目中有数据库文件并构建项目时，可以将数据库文件从根项目文件夹复制到输出（bin\debug 或 bin\release）文件夹。
此行为由`Copy To Output Directory`数据库文件的属性控制。

如果您将此属性设置为`Copy Always`then，则每次构建项目时，都会将数据库文件的新副本从根项目文件夹复制到输出目录，覆盖已经存在的目录并破坏您在上一个调试会话中所做的更改.

建议的解决方法是将此属性更改为`Copy Never`或`Copy if Newer`

[在此页面上查看 MSDN 上](http://msdn.microsoft.com/en-us/library/ms246989.aspx)的详细说明

对于您问题的第一部分，您可以避免在每个用户上循环，将 WHERE 子句添加到您的 sql 文本中。请注意，您永远不应该使用字符串连接来构建您的 sql 字符串，而是始终使用参数。（为什么？你避免[了 Sql 注入](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)和文本单引号解析/加倍）

```
string sqlText = "SELECT * FROM [Users] WHERE Username = @usr AND [Password] = @psw";
SqlCommand cmd = new SqlCommand(sqlText, cn);
cmd.Parameters.AddWithValue("@usr", textbox1.Text);
cmd.Parameters.AddWithValue("@psw", textbox2.Text);
SqlDataReader reader = cmd.ExecuteReader();
if(reader.HasRows)
    // You have found the user.... 
```

还有一点建议。不要将密码以明文形式存储在数据库中。始终存储此字符串的哈希值，并在搜索时计算哈希值并搜索它，而不是使用明文密码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:46:28.417

为了让你得到这个工作，你需要`WHERE`在你的`SELECT`. 但是，我不建议使用

```
SqlCommand cmd = new SqlCommand("SELECT * FROM [Users] WHERE Username='" + textBox1.Text + "'", cn); 
```

因为可能的[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

请了解如何使用[存储过程](http://msdn.microsoft.com/en-us/library/aa174792%28v=sql.80%29.aspx)以及[如何从您的 C# 代码中执行它们](https://stackoverflow.com/questions/1260952/how-to-execute-a-stored-procedure-from-c-sharp-program)。

# iphone - 应用内购买 - 了解用户何时点击“购买”

> ID：13713854
> 
> 赞同：0
> 
> 时间：2012-12-04T23:32:20.693
> 
> 标签：iphone, ios, in-app-purchase, uialertview, storekit

我试图在交易过程中的适当时间显示/隐藏活动指示器，并且我想在用户单击确认警报上的“购买”后显示活动指示器。这就是我想做的：

1.  点击“购买”后显示
2.  显示 Apple ID 密码对话框时隐藏
3.  输入密码后显示

我已经涵盖了其他部分，但我找不到处理这些事件的正确方法。仅供参考，我正在使用 DejalBezelActivityView 库。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T06:20:04.010

check out this, It may help you in finding what you want

[http://www.raywenderlich.com/2797/introduction-to-in-app-purchases](http://www.raywenderlich.com/2797/introduction-to-in-app-purchases)

# python - 如何在 Python 中使用循环返回值？

> ID：13713857
> 
> 赞同：1
> 
> 时间：2012-12-04T23:32:38.567
> 
> 标签：python, loops

我正在尝试学习基本的 python，但我似乎无法使用 while 循环返回值。我正在从正在阅读的指南中复制语法，但是当我运行它时它似乎不起作用。我可能有不同的版本，我不确定。

无论如何，我只是在乱搞并得到了这个代码

```
def fact(x):
 count = 1
 sum = 0
 while count <= x:
     sum =  count * sum
     count + 1
 else:
     return sum 
```

我什至不知道这是否正确计算阶乘，我不在乎，我只是想让它返回一个值。怎么了？为什么我不能使用返回？当我将 return 替换为时，我不确定出了什么问题

```
 display, 
```

它仍然不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:39:29.413

在您的`while`循环中，您实际上并没有设置`count`等于`count + 1`- 您只是在说明`count + 1`，它不会重新分配变量：

```
In [1]: count = 1

In [2]: count + 1
Out[2]: 2

In [3]: count
Out[3]: 1 
```

你会想要使用类似的东西`count += 1`。此外，您将遇到以下问题：

```
sum =  count * sum 
```

由于它最初为 0，因此您每次都将其重置为 0，而不管计数是多少。如果这仍然适用于您，您可以尝试将其设置为 1，但您可能需要仔细考虑您要执行的操作。使用`else`了 with 语句`while`，但在这里您可能可以在`while`满足条件后退出块并以这种方式返回变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:38:35.030

尝试：

```
def fact(x):
    count = 1
    sum = 1
    while count <= x:
        sum *= count
        count += 1
    return sum 
```

虽然这可能更好：

```
def fact(x):
    prod = 1
    for i in range(1, x+1):
        prod *= i
    return prod 
```

如果您从 开始计数变量，`0`您将`0`退出，因为`0 * n == 0`对于所有`n`.

在`else`这里也完全没用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T23:44:06.250

```
def fact(x):
    count = 1
    sumi = 1
    while count <= x:
        sumi =  count * sumi
        count = count + 1

    return sumi 
```

这里有一些错误：

*   开头的 sumi = 0 是错误的，它会让你的函数总是返回 0
*   count + 1 如果您不将其分配给任何内容，则不会更改 count 的值
*   把你的`return`陈述放在一会儿之后。循环完成后，它将返回 sumi 的值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T23:40:06.783

所以我不知道你在使用 python 结构时要遵循什么，但你不能单独调用 else 。您将永远不会返回，因为您没有判断值来测试 else 语句。它需要附加到 if 语句才能工作。

例如，您想要执行以下操作：

```
if x == 1:
   return blah
else:
   return foo 
```

我也不确定，但该代码甚至可能根本无法运行。我也不知道显示器是什么，但我很确定它不是你想要的。

请阅读：[http ://docs.python.org/2/tutorial/controlflow.html](http://docs.python.org/2/tutorial/controlflow.html)

这将帮助您了解控制结构，以便您可以使循环执行您想要的操作。

# google-docs - 谷歌电子表格中的转置函数引用错误

> ID：13713858
> 
> 赞同：2
> 
> 时间：2012-12-04T23:32:54.530
> 
> 标签：google-docs, google-sheets, transpose, referenceerror

我正在使用表单电子表格从用户那里获取数据，并在单独的工作表上使用书中另一张工作表上的“=transpose()”函数转置数据。当我从第一张表上的先前表单提交中删除数据时，我收到参考错误。当新数据导入到第一张表时，转置功能仍然会产生参考错误。

看起来一旦产生错误，我就必须手动将单元格引用放回转置函数......非常烦人。

原文：=TRANSPOSE(Sheet1!B2:F25)

我的转置函数都变成了这个------------> =TRANSPOSE({})

这是否发生在其他人身上？有什么解决方法吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T18:26:14.617

在这里得到了很好的答案，而且效果很好！

[http://productforums.google.com/forum/#!msg/docs/E5pE0-9kliU/j2cnXffV1XoJ](http://productforums.google.com/forum/#!msg/docs/E5pE0-9kliU/j2cnXffV1XoJ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-17T14:02:15.467

只需`TRANSPOSE`在要转置数组的单元格中使用该函数，然后将要转置的数组添加到函数的参数中示例：

> =转置（A166:L174）

# ios - UIPageViewController 不允许选择 uitextfield

> ID：13713862
> 
> 赞同：3
> 
> 时间：2012-12-04T23:33:12.080
> 
> 标签：ios, uipageviewcontroller

我遇到了一个非常有趣的 UIPageViewController 问题。如果您单击其中一个页面内的 UITextfield，该页面将闪烁然后消失。

这似乎只发生在过渡样式设置为

`UIPageViewControllerTransitionStyleScroll`

复制问题的最简单方法是创建一个新的基于页面视图的项目，更改过渡样式，添加`UITextField`到情节提要。滚动几页，然后单击`UITextField`，该页面将消失。这只会在您第一次运行应用程序时发生，因此您需要重新启动以复制问题。

我不知道出了什么问题，但是有人知道解决方法吗？

# php - PHP计算文本文件中所有在同一行的分隔值

> ID：13713866
> 
> 赞同：0
> 
> 时间：2012-12-04T23:33:29.610
> 
> 标签：php, file, text, count, delimited

我需要一个脚本来计算文本文件中所有在一行上的管道分隔条目的数量。我找到了一个计算行数的脚本并对其进行了修改，以为我可以让它工作，但遗憾的是它仍然计算行数，所以目前将值设为 1。请你看看并帮助我解决问题吗？文本文件如下所示：

```
Fred|Keith|Steve|James 
```

我正在尝试的脚本是这样的：

```
$file1 = "names.txt";
$line = file($file1); 
$count = count(explode("|", $line));
echo "$file1 contains $count words"; 
```

非常感谢任何帮助。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:53:22.590

有多种方法可以解决此类问题，打开文件的不同方式以及解释数据的不同方式。

但是，您将要寻找与此类似的东西：

```
<?php
    $data = file_get_contents("names.txt");
    $count = count(preg_split("/|/", $data));
    echo "The file contains $count words.";
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:04:07.663

最快的方法就是数一数管道并添加一个。修剪字符串以确保开头和结尾的管道不计为一个项目。

```
<?php
   $contents = file_get_contents('names.txt');
   $count = substr_count(trim($contents, "|\n "), '|') + 1;
   echo "$file1 contains $count words"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T00:10:27.907

有很多方法可以做到这一点，这是我的看法...

```
// get lines as array from file
$lines = file('names.txt');

// get a count for the number of words on each line (PHP > 5.3) 
$counts = array_map(function($line) { return count(explode('|', $line)); }, $lines);
// OR (PHP < 5.3) get a count for the number of words on each line (PHP < 5.3) 
//$counts = array_map(create_function('$line', 'return count(explode("|", $line));'), $lines);

// get the sum of all counts
$count = array_sum($counts);

// putting it all together as a one liner (PHP > 5.3)...
$count = array_sum(array_map(function($line) { return count(explode('|', $line)); }, file('names.txt')));
// or (PHP < 5.3)...
// $count = array_sum(array_map(create_function('$line', 'return count(explode("|", $line));'), file('names.txt'))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T00:14:34.683

您几乎做到了，对工作原理只有一个小误解`file`：

您的行变量中没有单行而是所有行，您可以访问数字索引从 0 开始的单行

```
$nunWords = count( explode ('|', $line[0] ) ); 
```

因此，要计算单词，假设第 10 行，您只需将索引更改为 9 （因为我们从 0 开始）

另一个例子

```
$lines = file ('yourfile');
foreach ( $lines as $curLine => $line )
{
      echo  "On line " . $curLine+1 . " we got " . count( explode ('|', $line ) ) . " words<br/>\n";
} 
```

# c# - 如何在构造函数中通过统一传递参数来解决依赖关系？

> ID：13713868
> 
> 赞同：1
> 
> 时间：2012-12-04T23:33:45.337
> 
> 标签：c#, .net, dependency-injection, unity-container

> **可能重复：**
> [我可以将构造函数参数传递给 Unity 的 Resolve() 方法吗？](https://stackoverflow.com/questions/787001/can-i-pass-constructor-parameters-to-unitys-resolve-method)
> [C#/Unity 中的构造函数注入？](https://stackoverflow.com/questions/2015308/constructor-injection-in-c-unity)

可以在服务的构造函数中通过统一传递参数来解决依赖关系来解决？

如果是我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T23:35:13.743

创建一个`InjectionConstructor`并将其传递给`RegisterType()`：

```
var unityContainer = new UnityContainer();

ISnuh snuh = new Snuh();
InjectionConstructor injectionConstructor = new InjectionConstructor(snuh);

unityContainer.RegisterType<ICalculator, SimpleCalculator>(injectionConstructor); 
```

如果您只有在解析类型时才需要这样做，那就是何时`ResolverOverride[]`使用：

```
public static T Resolve<T>(this IUnityContainer container, params ResolverOverride[] overrides); 
```

根据[MSDN](http://msdn.microsoft.com/en-us/library/ff660920%28v=pandp.20%29.aspx)：

> 使用 ParameterOverride 覆盖指定的构造函数参数或参数。

# ajax - 是否可以在 ajax 获取请求中获取页面的一部分？

> ID：13713870
> 
> 赞同：2
> 
> 时间：2012-12-04T23:34:03.533
> 
> 标签：ajax, http, jquery, get

我知道我们可以在向服务器发出 GET 请求时获取整个页面，但是如果我只对该页面上的一个特定 div 感兴趣，或者更确切地说是对其内容感兴趣怎么办。这里唯一的选择是获取整个页面，例如使用 jquery find() 从中获取 div 内容吗？或者是否有可能对服务器设置某种查询以要求返回这个特定的 div。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T23:46:55.687

```
$.ajax({
    'type': 'get'
    ...some params...
    success: function(response){
        $(response).find('div you are looking for').appendTo('div you want to append it');
    } 
}); 
```

对于一些参数检查[jQuery ajax](http://api.jquery.com/jQuery.ajax/)。

并回答您的问题：不，如果不制作特殊的服务器端服务，就无法获得 HTML 的某些部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:14:11.360

对于这种情况，您可能希望使用更简单的 jQuery 的 AJAX 工具，`.load`.

```
$('#wrapper').load(href+fragmentSelector, function() {
    // callback to do stuff afterward
}); 
```

在这里，我们将`fragmentSelector`来自 url中 ID 的元素中的内容加载`href`到 `#wrapper`当前页面上。

整个页面仍在被请求，但只返回您请求的内容。

参考：[http ://api.jquery.com/load/#loading-page-fragments](http://api.jquery.com/load/#loading-page-fragments)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T16:56:23.370

您可以使用[HTTP RANGE Header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)，但您可以选择要下载的字节范围，而不是通过 DIV 选择内容。

例子：

```
curl -r 0-1000 http://localhost -v 
```

请参阅[将 HTTP 范围标头与字节以外的范围说明符一起使用？](https://stackoverflow.com/questions/1434647/using-the-http-range-header-with-a-range-specifier-other-than-bytes)

# java - Java - 在 Jtable 的单元格中添加一个按钮

> ID：13713879
> 
> 赞同：2
> 
> 时间：2012-12-04T23:35:04.913
> 
> 标签：java, swing, netbeans, jtable, jbutton

我需要在 Jtable 的单元格中添加一个按钮来做某事。我搜索了很多方法，但不适用于 Netbeans。我希望你的帮助，因为我也为社区做出贡献。提前致谢。！！

VL

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T23:37:01.977

本教程应该可以帮助您：[http ://www.java2s.com/Code/Java/Swing-Components/ButtonTableExample.htm](http://www.java2s.com/Code/Java/Swing-Components/ButtonTableExample.htm)

# c - SSE 中的 Seg Fault，不确定是什么原因造成的

> ID：13713886
> 
> 赞同：0
> 
> 时间：2012-12-04T23:35:20.717
> 
> 标签：c, sse, simd

我们试图做一些 SSE 操作，然而，在 add_sse 函数的末尾，我们试图读回刚刚计算的值，它会给我们一个 seg 错误。但是，如果我们只是在 for 循环中打印值，结果是可以的。也可以只读取每个数组中的元素 0。读取元素 1 及以后将导致 seg 错误。

任何人都可以帮助我们确定问题吗？我们尝试了一切，但仍然不明白我们会有一个段错误。谢谢

```
void main()
{
    ResultCounter *c_sse=(ResultCounter *)memalign(16,sizeof(ResultCounter)*4);    

    resetCounter (c_sse);  //initial struct to all 0

    add_sse (1,2, 3,4, c_sse);
}

void add_sse (unsigned int first, unsigned int second, unsigned int third, unsigned int fourth, ResultCounter *c)
{
    __attribute__((align(16))) int m_intarray[4] = {first, second, third,fourth};

    __attribute__((align(16))) int m_Larray[4] = {c[0].L, c[1].L, c[2].L,c[3].L};
    __attribute__((align(16))) int m_Marray[4] = {c[0].M, c[1].M, c[2].M,c[3].M};
    __attribute__((align(16))) int m_Harray[4] = {c[0].H, c[1].H, c[2].H,c[3].H};

    __m128i N = _mm_load_si128(&m_intarray[0]);
    __m128i L = _mm_load_si128(&m_Larray[0]);
    __m128i M = _mm_load_si128(&m_Marray[0]);
    __m128i H = _mm_load_si128(&m_Harray[0]);

    __m128i Lcarry = _mm_and_si128 (L, N);

    L = _mm_xor_si128 (L, N);

    __m128i Mcarry = _mm_and_si128 (M, Lcarry); 

    M = _mm_xor_si128 (M, Lcarry);

    H = _mm_or_si128 (H,Mcarry);

    _mm_store_si128(&m_Larray[0], L);
    _mm_store_si128(&m_Marray[0], M);
    _mm_store_si128(&m_Harray[0], H);

    for(i = 0; i < 4; i++) {
        //printf ("L:%d,addr=%u,M:%u,addr=%u,H:%u,addr=%u\n",m_Larray[i],&m_Larray[i],m_Marray[i],&m_Marray[i],m_Harray[i],&m_Harray[i]);
        c[i].L=m_Larray[i];
        c[i].M=m_Marray[i];
        c[i].H=m_Harray[i];
    }
}

//The struct used in main function.
typedef struct
{
    unsigned int L;
    unsigned int M;
    unsigned int H;
} ResultCounter; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T08:17:49.483

问题是该`ResultCounter`结构的大小为 12 字节，因此尽管数组的第一个元素`c[0]`是 16 字节对齐的，但第二个元素 ,`c[1]`不是。目前最快/最简单的解决方法是向这个结构添加 4 个字节的填充，例如一个额外的未使用的 int：

```
typedef struct
{
    unsigned int L;
    unsigned int M;
    unsigned int H;
    unsigned int unused;
} ResultCounter; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-04T23:40:25.987

_mm_load_si128 需要 16 字节对齐的数据。

# asp.net-mvc - Razor 语法说明

> ID：13713887
> 
> 赞同：0
> 
> 时间：2012-12-04T23:35:21.760
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

[http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3razor.aspx](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3razor.aspx)

在上面的链接中......

代码块 Foreach

```
@{
    <h3>Team Members</h3> string[] teamMembers = {"Matt", "Joanne", "Robert", "Nancy"};
    foreach (var person in teamMembers)
    {
        <p>@person</p>
    }
  } 
```

为什么 h3 标签“团队成员”没有抛出 C# 错误说未声明？这是在代码块内，它说它是 C# 代码。代码块内的所有 HTML 标签都被忽略了吗？

同样，为什么@登录@person？是不是这段代码也在代码块里面？谢谢你，史密斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:44:08.177

@ 符号是 Razor 语法的核心，是 Razor 用来区分代码和标记的字符。@ 符号标志着开发人员打算从标记切换到代码的点。在简单的情况下，不需要额外的字符来指示代码何时停止而标记何时恢复。Razor 的智能解析器确定模板的哪些部分是代码，哪些是标记。什么是有效的代码语句？Razor 使用以下算法在读取 @ 符号触发器后查找代码语句的结尾：

1.  读取到有效标识符（即 C# 或 VB 关键字）或变量名的末尾。
2.  如果下一个字符是左括号（ ( 或 [ )...</p>

    一个。继续解析，直到找到相应的右括号。嵌套的括号也被跟踪以避免块的过早关闭。

    湾。循环回到#2。

3.  如果下一个字符是 . （句点）并在有效标识符之前，跳转到#1。
4.  完成代码语句并继续处理标记的其余部分。

@person 存在的原因是告诉 Razor 视图引擎它们是标记和代码之间的转换

# java - 访问 rest 资源时出现错误 404

> ID：13713889
> 
> 赞同：0
> 
> 时间：2012-12-04T23:35:46.690
> 
> 标签：java, resteasy

我在使用这个简单的 RestEasy 服务时遇到了问题：

```
@Path("/")
public interface UserService {

    @POST
    @Path("/add")
    @Consumes(MediaType.APPLICATION_JSON)
    Response add(User user);

    @POST
    @Path("/update")
    @Consumes(MediaType.APPLICATION_JSON)
    Response update(User user);

    @GET
    @Path("/get/{id}")
    @Produces(MediaType.APPLICATION_JSON)
    Response get(@PathParam("id") long id);

    @GET
    @Path("/getAll")
    @Produces(MediaType.APPLICATION_JSON)
    Response getAll();

} 
```

基本上，上面的代码有效，但是当我更改`@Path("/")`为`@Path("/user")`并访问以下资源时：

```
http://localhost:8080/user/add 
```

它抛出错误`404`。不同于原来`http://localhost:8080/UserService/add`的作品。

我在代码中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:47:27.167

也许你可以试试

```
http://localhost:8080/UserService/user/add 
```

对于@Path（/用户）

# java - 如何将线程安全参数/对象传递给我的 Fitnesse Fixture？

> ID：13713894
> 
> 赞同：1
> 
> 时间：2012-12-04T23:36:04.003
> 
> 标签：java, fitnesse

类似于[我如何在 Java 中为我的 Fitnesse Fixture 传递程序参数？](https://stackoverflow.com/questions/9021071/how-do-i-pass-program-arguments-in-java-for-my-fitnesse-fixture)

..我希望使用fitnesseMain.FitNesseMain.launchFitNesse(Arguments arguments)并行启动我的Fitnesse测试...并将线程安全对象传递给每个测试，以便稍后由Fitnesse运行的测试代码访问。

测试代码本身是普通的旧 Java，使用 givwenzen 从 Fitnesse 调用。Java 测试代码继续动态启动 Selenium 测试。

我需要通过 Fitnesse 将这些线程安全对象一直传递给 Java 测试脚本，以便它们使用正确的 org.openqa.selenium.remote.DesiredCapabilities 启动 Selenium RemoteWebDriver。

我曾尝试使用旧的 java.lang.ThreadLocal，但似乎 Fitnesse 正在生成自己的线程来运行测试，从而有效地消除了此选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:29:22.280

考虑到 Givwenzen 是使用 Slim 编写的，我认为您想要做的事情是不可能的。如果可能的话，这肯定不容易，因为 Slim 通过在单独的进程中运行测试来工作。

因此，当您运行 FitNesse 时，它​​会创建 Web 服务器和 wiki。它作为一个 java 任务运行。当您单击“测试”或“套件”按钮（或使用 URL）时，它会创建一个新的 Java 进程，即 SlimServer。然后 FitNesse 服务器将指令作为字符串发送到 SlimServer，然后 SlimServer 将这些指令处理为运行测试的指令。因此，通过 FitNesseMain 启动的代码与 slim 测试之间的耦合实际上有点松散。这是有目的的，因为它让 SlimServer 实现与语言无关。

在 SlimServer 中，可以处理实际的对象引用，这可能没问题，但我怀疑监管链在每一步都是线程安全的。

对不起。也许其他人会对如何解决我所描述的问题有所了解。

# mysql - MySQL 语法错误

> ID：13713897
> 
> 赞同：0
> 
> 时间：2012-12-04T23:36:18.427
> 
> 标签：mysql, phpmyadmin

我正在尝试在同时从事一个项目的同时自学 MySQL。我正在使用 phpMyAdmin。

我收到错误消息：“#1064 - 您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，了解在 ''ps_category' ('id_category', 'id_parent', 'id_shop_default'、'level_depth'、'nl' 在第 1 行"

我的代码：

```
INSERT INTO 'ps_category' 
  ('id_category', 'id_parent', 'id_shop_default',
   'level_depth', 'nleft', 'nright', 'active', 
   'date_add', 'date_upd', 'position', 'is_root_category')
  VALUES (6,2,1,0,0,0,1,'2012-04-12 15:12:54','2012-04-12 15:12:54',1,0) 
```

更新：

我去掉了单引号，仍然得到同样的错误：

```
 INSERT INTO ps_category 
   ('id_category', 'id_parent', 'id_shop_default', 
    'level_depth', 'nleft', 'nright', 'active', 
    'date_add', 'date_upd', 'position', 'is_root_category')
 VALUES (6,2,1,0,0,0,1,'2012-04-12 15:12:54','2012-04-12 15:12:54',1,0) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:38:10.793

```
INSERT INTO `ps_category` (`id_category`, `id_parent`, `id_shop_default`, `level_depth`, `nleft`, `nright`, `active`, `date_add`, `date_upd`, `position`, `is_root_category`) VALUES (6,2,1,0,0,0,1,'2012-04-12 15:12:54','2012-04-12 15:12:54',1,0) 
```

您在表名上使用单引号。它应该是蜱虫或什么都没有。需要注意的是，勾号有助于确保正确读取表名。如果你把你的表命名为[mysql保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，勾号将防止它出错

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T23:38:38.273

表名不应作为字符串文字输入，要么删除这些，要么像这样在其周围`''`放置两个 ' '`' and '`

```
 INSERT INTO ps_category ... 
```

或者

```
 INSERT INTO `ps_category` ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:39:17.440

不应引用表名

# apache - 如何在 nanoc 中重定向

> ID：13713906
> 
> 赞同：1
> 
> 时间：2012-12-04T23:37:18.047
> 
> 标签：apache, nanoc

我是 nanoc 的新手，我只是通过博客设置的。

我所有的帖子都在 下`/blog/post/Month/Post_name.html`，但每次我访问时`/post/`，它都会向我显示 Apache 文件列表视图。

相反，我想`/blog/post/*`重定向到`/blog/`（其中包含所有博客文章的列表），但是当访问 时`/blog/post/Month/Post_name.html`，它应该显示正确。

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T06:32:30.223

这是一个关于 Apache 的问题，而不是关于 nanoc 的问题。

在您的配置文件中，确保`Options`不包含`Indexes`. 这将关闭目录列表。

对于重定向，您可以使用`mod_alias`. [查看redirect](http://httpd.apache.org/docs/2.4/mod/mod_alias.html#redirect)的文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T22:05:02.137

*Arjan van der Gaag*为这样的重定向提供了一个非常好的解决方案。根据[他`nanoc-template`关于该主题的 wiki](https://github.com/avdgaag/nanoc-template/wiki/Configure-HTTP-redirects)，您只需向您的 : 添加一些信息`config.yaml`：

```
redirects:
  -
    from: /foo
    to: /bar
  -
    from: /baz
    to: /qux 
```

然后配置您的`htaccess`文件以包含以下设置：

```
<% if @site.config[:redirects] %>
# Set up URL redirects<% @site.config[:redirects].each do |h| %>
Redirect 301 <%= h[:from] %> <%= h[:to] %>
<% end %><% end %> 
```

（授予[https://github.com/avdgaag/nanoc-template/blob/master/content/htaccess.txt](https://github.com/avdgaag/nanoc-template/blob/master/content/htaccess.txt)）

结果将如下所示：

```
Redirect 301 /foo /bar
Redirect 301 /baz /quz 
```

但是，在这种情况下， A `301`（“永久移动”）将过于苛刻： **您需要 303 重定向（“查看其他”）。**

# c# - 无法将 XML 文件反序列化为列表

> ID：13713908
> 
> 赞同：0
> 
> 时间：2012-12-04T23:37:22.140
> 
> 标签：c#, xml

我的问题是，我的程序没有从我的 XML 文件中获取数据并将其放入列表中

我可以很好地保存数据，但我无法将其加载回来。

这是我的保存功能

```
 public void Save_Data_Click(object sender, EventArgs e)
    {
        XmlSerializer PSR = new XmlSerializer(typeof(Pickup));
        XmlSerializer DSR = new XmlSerializer(typeof(Delivery));

        TextWriter PickupStream = new StreamWriter(@"Pickup Save Data.xml");
        TextWriter DeliveryStream = new StreamWriter(@"Delivery Save Data.xml");
        PSR.Serialize(PickupStream, thePickup);
        DSR.Serialize(DeliveryStream, theDelivery);
        DeliveryStream.Close();
        PickupStream.Close();

        MessageBox.Show("All data saved!");
    } 
```

这是我的 xml 加载代码

```
 XmlSerializer SerializerObj = new XmlSerializer(typeof(Pickup));
  FileStream ReadFileStream = new FileStream(@"Pickup Save Data.xml", FileMode.Open, FileAccess.Read, FileShare.Read);
  Pickup LoadedObj = (Pickup)SerializerObj.Deserialize(ReadFileStream);
  ReadFileStream.Close(); 
```

这是我的接送班

```
 namespace Vans
 {
     [Serializable]
     public class Pickup
     {

    public List<Pickups> Pickups = new List<Pickups>();

    public void addPickup(Pickups Pic)
    {
        Pickups.Add(Pic);
    }

    public List<String> listPickups()
    {
        List<String> listPickups = new List<string>();
        foreach (Pickups pick in Pickups)
        {
            String pickupString = pick.ToString();
            listPickups.Add(pickupString);
        }

        return listPickups;

    }

    public Pickups getPickup(int i)
    {

        int c = 0;
        foreach (Pickups Pic in Pickups)
        {
            if (i == c)
                return Pic;
            c++;
        }
        return null;
    }
 }
} 
```

我的 Delivery 类与 Pickup 类相同。

编辑

```
 <?xml version="1.0" encoding="utf-8"?>
    <Pickup xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <Pickups>
     <Pickups>
      <pickupfirstname>dsf</pickupfirstname>
      <pickuplastname>sdf</pickuplastname>
      <pickupdeliveryaddress>sd</pickupdeliveryaddress>
      <pickuptime>dsf</pickuptime>
    </Pickups>
  </Pickups>
</Pickup> 
```

这是一些示例 XML 代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:51:19.233

在[这个](http://msdn.microsoft.com/en-us/library/dsh84875.aspx)例子中，每个应该（反）序列化的字段都有一个注释`[XmlElement]`，也许这就是原因......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T09:43:28.113

确保您的`Pickups`类如下以正确*反序列化*它：

```
public class Pickups
{
    public string pickupfirstname;
    public string pickuplastname;
    public string pickupdeliveryaddress;
    public string pickuptime;
} 
```

**注意：**我已经在包含此类的情况下在本地测试了您的代码，并且运行良好。

# php - 用值传递数组php

> ID：13713909
> 
> 赞同：1
> 
> 时间：2012-12-04T23:37:57.863
> 
> 标签：php, arrays, post

是否可以通过 $_POST 或 $_GET 一个数组，其中包含值，而不使用 serialize() 和 unserialize() ？这是一个示例代码，试图找到一个数字..我输入值 4 而不是 rand，只是为了进行测试..我想到了使用 foreach 隐藏多个输入的潜力，以防我可以传递所有变量每一次，但它似乎不起作用..任何想法..??? 或者如果没有序列化就不可能？

```
<?php
$x = $_POST['x'];
$Num = $_POST['Num'];
$first_name[] = $_POST['first_name'];
if (!$x)
{
Echo "Please Choose a Number 1-100 <p>";
$x = 4; //rand (1,4) ;
} 
else {
if ($Num >$x)
{Echo "Your number, $Num, is too high. Please try again<p>";}
elseif ($Num == $x)
{Echo "Congratulations you have won!<p>";
Echo "To play again, please Choose a Number 1-100 <p>";
$x = 4;// rand (1,4) ;
}
else 
{Echo "Your number, $Num, is too low. Please try again<p>";}
}
?> 
<form action = "<?php echo $_SERVER['PHP_SELF']; ?>" method = "post"> <p> 
Your Guess:<input name="Num" /> 
<input type = "submit" name = "Guess"/> <p> 
<input type = "hidden" name = "x" value=<?php echo $x ?>> 
<?php
foreach($first_name as $val){
echo "<input type=\"hidden\" name=\"first_name[]\" value=$val />";
}
?>
</form> 
</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:46:49.850

```
<?php
    foreach($first_name as $k => $val)
        echo "<input type='hidden' name='first_name[$k]' value='$val' />"; 
```

应该管用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T18:14:57.207

这是我想出的解决方案...

```
 $x = $_POST['x'];
    $Num = $_POST['Num'];
    $first_name = $_POST['first_name']; //creating array from the begining
    $first_name[] = $Num; // add current num to next available slot in array
    $counter = $_POST['counter'] +1;
    if (!$x) // below this is the same..
    ....
    ....
    <input type = "hidden" name = "x" value=<?php echo $x; ?>> 
    <input type = "hidden" name = "counter" value=<?php echo $counter; ?>> //add a counter to count loops
    <?php 
    if ($counter>=2){ //counter in first load of page will be 1, so we need to read enter value from the next load of page
    for ($i=0; $i<=($counter-2); $i++){  // counter-2 gives us the actual number of elements
    echo "<input type=\"hidden\" name=\"first_name[]\" value=$first_name[$i] />";
    }
    }
    ?>
     </form> 
```

# php - MySQL 查询返回带有 AES_ENCRYPT 的空白字段

> ID：13713912
> 
> 赞同：0
> 
> 时间：2012-12-04T23:38:02.683
> 
> 标签：php, mysql, aes, encryption

我的查询字符串是`$SQLstring = "SELECT name, address, city, state, zip, homephone, cellphone, position, shift, status, workedherebefore, previousemploymentdate, referred, empname, under18, friends, empname2, currentlyemployed, contactemployer, lawful, worktime, workweekends, dateavailable, desiredsalary, position1, from1, to1, duties1, company1, cophone1, startsalary, endsalary, reasonleaving1, supervisor1, contact1, position2, from2, to2, duties2, company2, cophone2, startsalary2, endsalary2, reasonleaving2, supervisor2, contact2, position3, from3, to3, duties3, company3, cophone3, startsalary3, endsalary3, reasonleaving3, supervisor3, contact3, comments, training, otherqual, documents, dltype, dlstate, expdate, yearsdriving, movingviolations, hsname, hscity, hsstate, hsdates, collegename, collegecity, collegestate, collegedates, othername, othercity, otherstate, otherdates, licenseorcert, refname1, refbusiness1, reftitle1, refaddress1, refphone1, refname2, refbusiness2, reftitle2, refaddress2, refphone2, refname3, refbusiness3, reftitle3, refaddress3, refphone3,felony, iffelony, fired, iffired, resident, explanation, signed, q1, q2, q3, q4, mq1, mq2, mq3, mq4, mq5, mq6, mq7, mq8, mq9, mq10, mq11, mq12, mq13, mq14, mq15, mq16, mq17, mq18, mq19, mq20, mq21, mq22, mq23, mq24, mq24b, mq25, mq25b, mq26, mq27a, mq27b, mq27c, mq28, mq29, mq30answer, disclosuresig, verify_name, other_names, dob, AES_DECRYPT(ssn,'$key') AS ssn FROM applications";`

我查询结果，然后将它们返回到表中。除了 AES_DECRYPT 字段 (ssn) 之外，所有这些都有效。在数据库中，它似乎已被很好地加密，但查询中的此字段返回为空白。这是其余的代码，以防万一：

`$key="88b871WZ3SntWK67rN3l2J1SvMqsOjyk";
$QueryResult = @mysql_query($SQLstring, $conn) or die("Query Problem - " . mysql_error($conn) . " - Error Number - " . mysql_errno($conn));`

 ````
 $num_result = mysql_num_rows($QueryResult);

        echo "<table>";

        for ($i = 0; $i < $num_result; $i++)    
        {
            $row = mysql_fetch_array($QueryResult);

            echo "<tr>";
            echo "<td>" . $row["name"] . "</td>";
            echo "<td>" . $row["email"] . "</td>"; 
            echo "<td>" . $row["address"] . "</td>";
            echo "<td>" . $row["city"] . "</td>";
            echo "<td>" . $row["state"] . "</td>";
            echo "<td>" . $row["zip"] . "</td>";
            echo "<td>" . $row["homephone"] . "</td>";
            echo "<td>" . $row["cellphone"] . "</td>";
            echo "<td>" . $row["position"] . "</td>";
            echo "<td>" . $row["shift"] . "</td>";
            echo "<td>" . $row["status"] . "</td>";
            echo "<td>" . $row["workedherebefore"] . "</td>";
            echo "<td>" . $row["previousemploymentdate"] . "</td>";
            echo "<td>" . $row["referred"] . "</td>";
            echo "<td>" . $row["empname"] . "</td>";
            echo "<td>" . $row["under18"] . "</td>";
            echo "<td>" . $row["friends"] . "</td>";
            echo "<td>" . $row["empname2"] . "</td>";
            echo "<td>" . $row["currentlyemployed"] . "</td>";
            echo "<td>" . $row["contactemployer"] . "</td>";
            echo "<td>" . $row["lawful"] . "</td>";
            echo "<td>" . $row["worktime"] . "</td>";
            echo "<td>" . $row["workweekends"] . "</td>";
            echo "<td>" . $row["dateavailable"] . "</td>";
            echo "<td>" . $row["desiredsalary"] . "</td>";
            echo "<td>" . $row["position1"] . "</td>";
            echo "<td>" . $row["from1"] . "</td>";
            echo "<td>" . $row["to1"] . "</td>";
            echo "<td>" . $row["duties1"] . "</td>";
            echo "<td>" . $row["company1"] . "</td>";
            echo "<td>" . $row["cophone1"] . "</td>";
            echo "<td>" . $row["startsalary"] . "</td>";
            echo "<td>" . $row["endsalary"] . "</td>";
            echo "<td>" . $row["reasonleaving1"] . "</td>";
            echo "<td>" . $row["supervisor1"] . "</td>";
            echo "<td>" . $row["contact1"] . "</td>";
            echo "<td>" . $row["position2"] . "</td>";
            echo "<td>" . $row["from2"] . "</td>";
            echo "<td>" . $row["to2"] . "</td>";
            echo "<td>" . $row["duties2"] . "</td>";
            echo "<td>" . $row["company2"] . "</td>";
            echo "<td>" . $row["cophone2"] . "</td>";
            echo "<td>" . $row["startsalary2"] . "</td>";
            echo "<td>" . $row["endsalary2"] . "</td>";
            echo "<td>" . $row["reasonleaving2"] . "</td>"; 
            echo "<td>" . $row["supervisor2"] . "</td>"; 
            echo "<td>" . $row["contact2"] . "</td>"; 
            echo "<td>" . $row["position3"] . "</td>"; 
            echo "<td>" . $row["from3"] . "</td>"; 
            echo "<td>" . $row["to3"] . "</td>"; 
            echo "<td>" . $row["duties3"] . "</td>"; 
            echo "<td>" . $row["company3"] . "</td>"; 
            echo "<td>" . $row["cophone3"] . "</td>"; 
            echo "<td>" . $row["startsalary3"] . "</td>"; 
            echo "<td>" . $row["endsalary3"] . "</td>"; 
            echo "<td>" . $row["reasonleaving3"] . "</td>"; 
            echo "<td>" . $row["supervisor3"] . "</td>"; 
            echo "<td>" . $row["contact3"] . "</td>"; 
            echo "<td>" . $row["comments"] . "</td>"; 
            echo "<td>" . $row["training"] . "</td>"; 
            echo "<td>" . $row["otherqual"] . "</td>"; 
            echo "<td>" . $row["documents"] . "</td>"; 
            echo "<td>" . $row["dltype"] . "</td>"; 
            echo "<td>" . $row["dlstate"] . "</td>"; 
            echo "<td>" . $row["expdate"] . "</td>"; 
            echo "<td>" . $row["yearsdriving"] . "</td>"; 
            echo "<td>" . $row["movingviolations"] . "</td>"; 
            echo "<td>" . $row["hsname"] . "</td>"; 
            echo "<td>" . $row["hscity"] . "</td>"; 
            echo "<td>" . $row["hsstate"] . "</td>"; 
            echo "<td>" . $row["hsdates"] . "</td>"; 
            echo "<td>" . $row["collegename"] . "</td>"; 
            echo "<td>" . $row["collegecity"] . "</td>"; 
            echo "<td>" . $row["collegestate"] . "</td>"; 
            echo "<td>" . $row["collegedates"] . "</td>"; 
            echo "<td>" . $row["othername"] . "</td>"; 
            echo "<td>" . $row["othercity"] . "</td>"; 
            echo "<td>" . $row["otherstate"] . "</td>"; 
            echo "<td>" . $row["otherdates"] . "</td>"; 
            echo "<td>" . $row["licenseorcert"] . "</td>"; 
            echo "<td>" . $row["refname1"] . "</td>"; 
            echo "<td>" . $row["refbusiness1"] . "</td>"; 
            echo "<td>" . $row["reftitle1"] . "</td>"; 
            echo "<td>" . $row["refaddress1"] . "</td>"; 
            echo "<td>" . $row["refphone1"] . "</td>"; 
            echo "<td>" . $row["refname2"] . "</td>"; 
            echo "<td>" . $row["refbusiness2"] . "</td>"; 
            echo "<td>" . $row["reftitle2"] . "</td>"; 
            echo "<td>" . $row["refaddress2"] . "</td>"; 
            echo "<td>" . $row["refphone2"] . "</td>"; 
            echo "<td>" . $row["refname3"] . "</td>"; 
            echo "<td>" . $row["refbusiness3"] . "</td>"; 
            echo "<td>" . $row["reftitle3"] . "</td>"; 
            echo "<td>" . $row["refaddress3"] . "</td>"; 
            echo "<td>" . $row["refphone3,felony"] . "</td>"; 
            echo "<td>" . $row["iffelony"] . "</td>"; 
            echo "<td>" . $row["fired"] . "</td>"; 
            echo "<td>" . $row["iffired"] . "</td>"; 
            echo "<td>" . $row["resident"] . "</td>"; 
            echo "<td>" . $row["explanation"] . "</td>"; 
            echo "<td>" . $row["signed"] . "</td>"; 
            echo "<td>" . $row["q1"] . "</td>"; 
            echo "<td>" . $row["q2"] . "</td>"; 
            echo "<td>" . $row["q3"] . "</td>"; 
            echo "<td>" . $row["q4"] . "</td>"; 
            echo "<td>" . $row["mq1"] . "</td>"; 
            echo "<td>" . $row["mq2"] . "</td>"; 
            echo "<td>" . $row["mq3"] . "</td>"; 
            echo "<td>" . $row["mq4"] . "</td>"; 
            echo "<td>" . $row["mq5"] . "</td>"; 
            echo "<td>" . $row["mq6"] . "</td>"; 
            echo "<td>" . $row["mq7"] . "</td>"; 
            echo "<td>" . $row["mq8"] . "</td>"; 
            echo "<td>" . $row["mq9"] . "</td>"; 
            echo "<td>" . $row["mq10"] . "</td>"; 
            echo "<td>" . $row["mq11"] . "</td>"; 
            echo "<td>" . $row["mq12"] . "</td>"; 
            echo "<td>" . $row["mq13"] . "</td>"; 
            echo "<td>" . $row["mq14"] . "</td>"; 
            echo "<td>" . $row["mq15"] . "</td>"; 
            echo "<td>" . $row["mq16"] . "</td>";
            echo "<td>" . $row["mq17"] . "</td>"; 
            echo "<td>" . $row["mq18"] . "</td>"; 
            echo "<td>" . $row["mq19"] . "</td>"; 
            echo "<td>" . $row["mq20"] . "</td>"; 
            echo "<td>" . $row["mq21"] . "</td>"; 
            echo "<td>" . $row["mq22"] . "</td>"; 
            echo "<td>" . $row["mq23"] . "</td>"; 
            echo "<td>" . $row["mq24"] . "</td>"; 
            echo "<td>" . $row["mq24b"] . "</td>"; 
            echo "<td>" . $row["mq25"] . "</td>"; 
            echo "<td>" . $row["mq25b"] . "</td>"; 
            echo "<td>" . $row["mq26"] . "</td>"; 
            echo "<td>" . $row["mq27a"] . "</td>"; 
            echo "<td>" . $row["mq27b"] . "</td>"; 
            echo "<td>" . $row["mq27c"] . "</td>"; 
            echo "<td>" . $row["mq28"] . "</td>"; 
            echo "<td>" . $row["mq29"] . "</td>"; 
            echo "<td>" . $row["mq30answer"] . "</td>"; 
            echo "<td>" . $row["disclosuresig"] . "</td>"; 
            echo "<td>" . $row["verify_name"] . "</td>"; 
            echo "<td>" . $row["other_names"] . "</td>"; 
            echo "<td>" . $row['ssn'] . "</td>"; 
            echo "<td>" . $row["dob"] . "</td>";
            echo "</tr>";
        }
        echo "</table>";
    } 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T15:17:47.193

要使用 AES_ENCRYPT 和 AES_DECRYPT，字段类型必须是 BLOB。我将它设置为 VARCHAR 并且它无法识别某些字符。将字段类型更改为 blob 效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T00:51:35.273

如果检测到无效数据，MySQL AES_DECRYPT() 返回 NULL。
所以传递给 AES_DECRYPT() 的字符串是无效的。
在这种情况下，我建议 ECHO/alert 查询，以便您可以看到一切都是正确的。最可能的错误是 AD7six 指出的...... $key 可能是空的。

```
$key="88b871WZ3SntWK67rN3l2J1SvMqsOjyk";
$SQLstring = "SELECT * FROM table"; // Replace with your Query
echo $SQLstring;
$QueryResult = @mysql_query($SQLstring, $conn) or die("Query Problem - " . mysql_error($conn) . " - Error Number - " . mysql_errno($conn)); 
```

警报器：

```
echo "<script type='text/javascript'>
alert($SQLstring);
</script>"; 
```

我还建议您阅读有关[mysqli的信息](http://php.net/manual/en/book.mysqli.php)`

# selenium-webdriver - 还有其他人在使用 Selenium Grid 注册 Ghostdriver 时遇到问题吗？

> ID：13713913
> 
> 赞同：5
> 
> 时间：2012-12-04T23:38:05.940
> 
> 标签：selenium-webdriver, phantomjs, selenium-grid

我知道 ghostdriver wiki 上有关于如何将其附加到 selenium 网格的文档。不知道的可以看[这里](https://github.com/detro/ghostdriver#register-ghostdriver-with-a-selenium-grid-hub)

我已经编译了两次特殊的 phantomjs，尝试将它附加到本地的 selenium 服务器，并使用 Selenium 版本 2.24 和 2.25 进行远程操作，但无济于事。它会像您期望的那样在本地启动 Ghostdriver，但肯定不会进行注册。

我尝试了 ip/localhost:4444 和 ip/localhost:4444/grid/register 都没有结果。我还想也许它只是没有出现在网格控制台上，并且无论如何都试图对它运行测试，但失败表明没有任何东西填充网格。

我在 CentOS 6 和 Ubuntu 12.04 上都试过了，但没有成功。

我没主意了。有没有其他人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T12:51:10.833

我遇到了完全相同的问题，并使用最新版本的 selenium-grid 修复了它。

好网站：[https](https://code.google.com/p/selenium/wiki/Grid2) ://code.google.com/p/selenium/wiki/Grid2 （这不再是[http://selenium-grid.seleniumhq.org/](http://selenium-grid.seleniumhq.org/)）。

这里的步骤（版本 2.31.0）：

下载硒服务器：

```
wget https://selenium.googlecode.com/files/selenium-server-standalone-2.31.0.jar
```

启动 selenium 网格服务器：

```
java -jar selenium-server-standalone-2.31.0.jar -role hub
```

在新终端中，启动 GhostDriver：

```
phantomjs --webdriver=5555 --webdriver-selenium-grid-hub=http://localhost:4444
```

在 上查看可用的遥控器`http://localhost:4444/grid/console`。

你应该看到类似的东西：

```
收听 http://127.0.0.1:5555
300 秒后测试会话超时。
最多支持 1 个并发测试：
幻影
```

我在 CentOS 6.3 上测试了这个命令，我希望它对你有用！

# c++ - 我是否错误地使用了默认参数？

> ID：13713916
> 
> 赞同：10
> 
> 时间：2012-12-04T23:38:11.700
> 
> 标签：c++, function, default-arguments

我刚刚开始阅读一本 C++ 初学者书籍。我有一些 java 经验（但是说实话，我从来没有在 java 中使用过默认参数）

所以，如前所述，我的问题是默认参数..

这是我正在使用的代码片段：

```
#include <iostream>

using namespace std;

//add declaration
int add(int a, int b);

int main (void)
{
        int number1;

        cout << "Enter the first value to be summed: ";
        cin >> number1;
        cout << "\nThe sum is: " << add(number1) << endl;
}

int add(int a=10, int b=5)
{
        return a+b;
} 
```

我从 g++ 编译器得到的响应是：“函数 'int add(int, int)' 的参数太少”

我做错了吗？（我也尝试过使用文字参数）

PS我似乎无法正确显示代码片段？系统变了吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-04T23:40:23.257

这是相反的方式

```
//add declaration
int add(int a=10, int b=5);

int add(int a, int b)
{
   return a+b;
} 
```

> § 8.3.6 默认参数 默认参数只能在函数声明的参数声明子句或模板参数中指定。不应为参数包指定默认参数。

# vb.net - VB 2010如何通过Form1.vb中的按钮控制元素主机

> ID：13713917
> 
> 赞同：1
> 
> 时间：2012-12-04T23:38:15.077
> 
> 标签：vb.net, visual-studio-2010

我正在尝试通过放置在 Form1.vb 中的按钮来启动我在 elemnthost1 中的动画

Elementhost 已经包含一个正在工作的按钮，但我基本上需要通过单击 Form.vb 按钮来单击它

元素宿主中的按钮也需要通过单击表单中的开始按钮来单击，或者通过单击 Form.vb 中的开始按钮来启动动画会更好

我一直在试图解决这个问题，但我无法做到

谢谢 Ste 这是我的 xaml：

```
<UserControl x:Class="UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" Height="372" Width="640">
    <UserControl.Resources>
        <PathGeometry x:Key="Daytona">
            <PathFigure IsClosed="True" StartPoint="290,320">
                <ArcSegment Point="290,320" Size="10,10" SweepDirection="Counterclockwise"></ArcSegment>
                <ArcSegment Point="430,250" Size="200,75"></ArcSegment>
                <ArcSegment Point="400,225" Size="30,25"></ArcSegment>
                <ArcSegment Point="370,215" Size="200,200" SweepDirection="Clockwise" ></ArcSegment>
                <ArcSegment Point="320,207" Size="150,200"></ArcSegment>
                <BezierSegment Point1="305,207" Point2="230,200" Point3="295,175"></BezierSegment>
                <ArcSegment Point="420,175" Size="570,500" SweepDirection="Clockwise"></ArcSegment>
                <BezierSegment Point1="437,177" Point2="452,162" Point3="462,152"></BezierSegment>
                <BezierSegment Point1="470,140" Point2="555,75" Point3="527,140"></BezierSegment>
                <ArcSegment Point="455,210" Size="500,500" SweepDirection="Clockwise"></ArcSegment>
                <BezierSegment Point1="445,220" Point2="450,280" Point3="545,220"></BezierSegment>
                <ArcSegment Point="480,18" Size="120,115"></ArcSegment>
                <ArcSegment Point="270,17" Size="520,100"></ArcSegment>
                <BezierSegment Point1="260,17" Point2="250,15" Point3="228,34"></BezierSegment>
                <BezierSegment Point1="218,34" Point2="200,33" Point3="180,20"></BezierSegment>
                <ArcSegment Point="40,220" Size="140,121"></ArcSegment>
                <ArcSegment Point="290,320" Size="690,600"></ArcSegment>
            </PathFigure>
        </PathGeometry>
    </UserControl.Resources>
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="Button.Click">
            <EventTrigger.Actions>
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimationUsingPath Storyboard.TargetName="Ellipse1"
                                  Storyboard.TargetProperty="(Canvas.Left)"
                                  PathGeometry="{DynamicResource Daytona}"
                                  Duration="0:0:20" RepeatBehavior="Forever" Source="X" FillBehavior="Stop" />
                        <DoubleAnimationUsingPath Storyboard.TargetName="Ellipse1"
                                  Storyboard.TargetProperty="(Canvas.Top)"
                                  PathGeometry="{StaticResource Daytona}"
                                  Duration="0:0:20" RepeatBehavior="Forever" Source="Y" FillBehavior="Stop" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger.Actions>
        </EventTrigger>
    </UserControl.Triggers>
    <Canvas Height="357" Name="Canvas1" Width="631">
        <Canvas.Background>
            <ImageBrush ImageSource="/WpfCircuitLibrary;component/Images/Daytona2.png" />
        </Canvas.Background>
        <Ellipse Canvas.Left="292" Canvas.Top="328" Height="29" Name="Ellipse1" Stroke="Black" Width="29" Fill="#FF3DCA1F" />
        <Path Canvas.Left="12" Canvas.Top="12" Height="336" Name="Daytona" Data="{StaticResource Daytona}" Stroke="Black" Width="607" StrokeThickness="5" />

        <Button Content="Button" Height="30" Name="Button1" Width="92" DataContext="{Binding}" Canvas.Left="263" Canvas.Top="382" IsEnabled="{Binding}" />
    </Canvas>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T04:58:47.813

ElementHost 控件是您的 Wpf UserControl 的容器，您创建的任何公共方法都可以从 Windows.Form 应用程序访问。我将采用您的 userControls Button Click 事件中的代码并创建一个 Public Sub，然后从您的 Windows 窗体的 Button Click 事件中调用它。我将假设您在后面的代码中创建了动画。

**Windows窗体Form1.vb**

```
Public Class Form1
    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        UserControl11.runAnimation()
    End Sub

    Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
        UserControl11.runXamlStoryBoard()
    End Sub
End Class 
```

**Wpf 用户控件**

```
Imports System.Windows.Media.Animation
Imports System.Windows.Controls

Public Class UserControl1
    Public Sub runAnimation()
        Dim da As DoubleAnimation = New DoubleAnimation
        da.From = 30
        da.To = 100
        da.Duration = New Windows.Duration(TimeSpan.FromSeconds(1))
        da.AutoReverse = True
        Button1.BeginAnimation(Button.HeightProperty, da)
    End Sub
    Public Sub runXamlStoryBoard()
        Dim sb As Storyboard = CType(FindResource("growButton"), Storyboard)
        sb.Begin()
    End Sub

    Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button1.Click
        runAnimation()
    End Sub 
```

结束类

**用户控件1.Xaml**

```
<UserControl x:Class="UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="116" d:DesignWidth="246">
    <UserControl.Resources>
        <Storyboard x:Key="growButton">
            <DoubleAnimation
                Storyboard.TargetName="Button1"
                Storyboard.TargetProperty="Height"
                From="30"
                To="100"
                Duration="0:0:1"
                RepeatBehavior="4x" />
        </Storyboard>
    </UserControl.Resources>
    <Grid>
        <Button Content="Button" Height="23" HorizontalAlignment="Center" Name="Button1" VerticalAlignment="Center" Width="75" />
    </Grid>
</UserControl> 
```

* * *

这是您想要的工作示例。我将您的情节提要移到了 UserControl.Resources 中，因此可以分配 ax:Key 以便在 CodeBehind 中使用它。然后我在您的触发器中将其引用为静态资源。

**UserControl1.xaml"

```
<UserControl x:Class="UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" Height="372" Width="640">
    <UserControl.Resources>
        <PathGeometry x:Key="Daytona">
            <PathFigure IsClosed="True" StartPoint="290,320">
                <ArcSegment Point="290,320" Size="10,10" SweepDirection="Counterclockwise"></ArcSegment>
                <ArcSegment Point="430,250" Size="200,75"></ArcSegment>
                <ArcSegment Point="400,225" Size="30,25"></ArcSegment>
                <ArcSegment Point="370,215" Size="200,200" SweepDirection="Clockwise" ></ArcSegment>
                <ArcSegment Point="320,207" Size="150,200"></ArcSegment>
                <BezierSegment Point1="305,207" Point2="230,200" Point3="295,175"></BezierSegment>
                <ArcSegment Point="420,175" Size="570,500" SweepDirection="Clockwise"></ArcSegment>
                <BezierSegment Point1="437,177" Point2="452,162" Point3="462,152"></BezierSegment>
                <BezierSegment Point1="470,140" Point2="555,75" Point3="527,140"></BezierSegment>
                <ArcSegment Point="455,210" Size="500,500" SweepDirection="Clockwise"></ArcSegment>
                <BezierSegment Point1="445,220" Point2="450,280" Point3="545,220"></BezierSegment>
                <ArcSegment Point="480,18" Size="120,115"></ArcSegment>
                <ArcSegment Point="270,17" Size="520,100"></ArcSegment>
                <BezierSegment Point1="260,17" Point2="250,15" Point3="228,34"></BezierSegment>
                <BezierSegment Point1="218,34" Point2="200,33" Point3="180,20"></BezierSegment>
                <ArcSegment Point="40,220" Size="140,121"></ArcSegment>
                <ArcSegment Point="290,320" Size="690,600"></ArcSegment>
            </PathFigure>
        </PathGeometry>

        <Storyboard x:Key="MyPathAnimation">
            <DoubleAnimationUsingPath Storyboard.TargetName="Ellipse1"
                                  Storyboard.TargetProperty="(Canvas.Left)"
                                 PathGeometry="{DynamicResource Daytona}"
                                  Duration="0:0:20" RepeatBehavior="Forever" Source="X" FillBehavior="Stop" />
            <DoubleAnimationUsingPath Storyboard.TargetName="Ellipse1"
                                  Storyboard.TargetProperty="(Canvas.Top)"
                                 PathGeometry="{StaticResource Daytona}"
                                  Duration="0:0:20" RepeatBehavior="Forever" Source="Y" FillBehavior="Stop" />
        </Storyboard>

    </UserControl.Resources>
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="Button.Click">
            <EventTrigger.Actions>
                <BeginStoryboard Storyboard="{StaticResource MyPathAnimation}" />
            </EventTrigger.Actions>
        </EventTrigger>
    </UserControl.Triggers>
    <Canvas Height="357" Name="Canvas1" Width="631">
        <Canvas.Background>
            <ImageBrush ImageSource="/WpfCircuitLibrary;component/Images/Daytona2.png" />
        </Canvas.Background>
        <Ellipse Canvas.Left="292" Canvas.Top="328" Height="29" Name="Ellipse1" Stroke="Black" Width="29" Fill="#FF3DCA1F" />
        <Path Canvas.Left="12" Canvas.Top="12" Height="336" Name="Daytona" Data="{StaticResource Daytona}" Stroke="Black" Width="607" StrokeThickness="5" />
        <Button Content="Button" Height="30" Name="Button1" Width="92" DataContext="{Binding}" Canvas.Left="263" Canvas.Top="382" IsEnabled="{Binding}" />
    </Canvas>
</UserControl> 
```

**UserControl1.Xaml.vb**

```
Imports System.Windows.Media.Animation

Public Class UserControl1
    Public Sub runPathAnimation()
        Dim sb As Storyboard = CType(FindResource("MyPathAnimation"), Storyboard)
        sb.Begin()
    End Sub
End Class 
```

**表格1**

```
Public Class Form1
    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        UserControl11.runPathAnimation()
    End Sub
End Class 
```

# java - 使用 PDF 渲染器打开后无法删除 pdf 文件

> ID：13713919
> 
> 赞同：0
> 
> 时间：2012-12-04T23:38:28.197
> 
> 标签：java, pdf, pdfrenderer

我正在打开一个我用 iText 创建的 PDF 文件。无需在 PDF Renderer 中打开它，只需正常打开并关闭它，我就可以删除并覆盖文件。但是，一旦我使用 PDF Renderer 打开它，我就会关闭它。我无法删除 PDF 或替换它。

```
ByteBuffer buf;

...

randomAccessFile = new RandomAccessFile(new File(file), "r");
fileChannel = randomAccessFile.getChannel();
buf = fileChannel.map(FileChannel.MapMode.READ_ONLY, 0, fileChannel.size());
pdfFile = new PDFFile(buf); 
```

然后这里的代码获取图像并将其放入面板中。

然后我关闭上述项目。

它仍然在某个地方打开，但我不知道在哪里，感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T08:20:44.830

该错误似乎在未显示的其余部分（或关闭 fileChannel）中。

```
PDFFile pdfFile = new PDFFile(new File(file));
PdfReader pdfReader = pdfFile.getPdfReader();
try {
    ...
} finally {
    pdfReader.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T08:11:14.010

你关闭文件吗？如果你还有一个打开的文件，Java 不能删除它。

# image - 如何在 wordpress 中调整/访问原始图像的大小？

> ID：13713924
> 
> 赞同：1
> 
> 时间：2012-12-04T23:38:50.837
> 
> 标签：image, wordpress

图片在wordpress中的哪里调整大小？在数据库中？在文件夹中？

我将如何调整*原始*图像的大小（而不是创建新版本）。我问这个，因为我在 wordpress 网站上上传了很多太大的图像并且减慢了加载时间，我想调整它们的大小，所以没有任何尺寸大于 1500 像素。

我已经查看了一些插件，包括“重新生成缩略图”，但可能有一个实际上可以做我想要的，但我还没有找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T01:09:19.580

好吧，图像“即时”调整大小，然后存储在服务器中，并将其信息记录在数据库中。

生成原始遗骸和所有“缩略图”。在这种情况下，“缩略图”是指所有 WP 生成的图像大小，无论大小。

我在 WordPress StackExchange 上回答了[同样的问题。](https://wordpress.stackexchange.com/q/48882/12615)解决方案来自这篇文章：[如何自动使用调整大小的图像而不是原件](http://www.wprecipes.com/how-to-automatically-use-resized-image-instead-of-originals)。

> 此脚本将用 WordPress 生成的大图像替换上传的图像（如果大于您设置中定义的较大尺寸），以节省服务器空间，如果您将缩略图链接到原始图像，则可以节省带宽，例如灯箱使用插件。

```
add_filter('wp_generate_attachment_metadata','replace_uploaded_image');

function replace_uploaded_image($image_data) 
{
    // if there is no large image : return
    if ( !isset($image_data['sizes']['large']) ) 
        return $image_data;

    // paths to the uploaded image and the large image
    $upload_dir              = wp_upload_dir();
    $uploaded_image_location = $upload_dir['basedir'] . '/' . $image_data['file'];
    $large_image_location    = $upload_dir['path'] . '/' . $image_data['sizes']['large']['file'];

    // delete the uploaded image
    unlink($uploaded_image_location);

    // rename the large image
    rename($large_image_location, $uploaded_image_location);

    // update image metadata and return them
    $image_data['width']  = $image_data['sizes']['large']['width'];
    $image_data['height'] = $image_data['sizes']['large']['height'];
    unset($image_data['sizes']['large']);

    return $image_data;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:51:10.590

您可以使用 WordPress 的[add_theme_support](http://codex.wordpress.org/Function_Reference/add_theme_support)和[add_image_size](http://codex.wordpress.org/Function_Reference/add_image_size)为图像添加多种尺寸，这意味着当您上传新的缩略图时，WordPress 将创建具有指定尺寸的帖子缩略图的副本。要了解有关这些技术的更多信息，您可以[阅读本教程](http://www.wpbeginner.com/wp-tutorials/how-to-create-additional-image-sizes-in-wordpress/)。

WordPress 中还有另一个功能，它是[image_resize](http://codex.wordpress.org/Function_Reference/image_resize)，可用于缩小图像以适应特定大小并保存图像的新副本。

大多数开发人员使用`add_image_size`添加多个图像尺寸来显示在不同的位置，即您可以`featured image`在主页中使用一个图像，也可以在页面中使用另一个尺寸的相同图像`single.php`。为此，您必须使用

```
add_theme_support( 'post-thumbnails' );
add_image_size( 'homepage-thumb', 220, 180 ); // 220 pix width,180 pix height
add_image_size( 'singlepost-thumb', 590, 9999 ); // Unlimited Height Mode 
```

要`homepage-thumb`在主页中显示图像，您可以使用

```
if ( has_post_thumbnail() ) { the_post_thumbnail( 'homepage-thumb' ); } 
```

或者在`single.php`模板中你可以使用

```
if ( has_post_thumbnail() ) { the_post_thumbnail( 'singlepost-thumb' ); } 
```

你也可以看看[这个插件](http://wordpress.org/extend/plugins/image-pro-wordpress-image-media-management-and-resizing-done-right/)，[这篇文章](http://www.seedprod.com/dynamically-resize-wordpress-images-on-the-fly/)也很有用。希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-31T20:07:04.753

据我所知，没有插件可以直接调整原始图像的大小并更改其元数据，但是我找到了一种不需要编码的解决方法（我遇到了与您类似的问题）。

1.  通过 FTP 下载图像（图像存储在 wp-content/uploads/ 目录中）
2.  使用您选择的软件进行调整大小/编辑操作，并使用 FTP 将图像重新上传到与之前完全相同的位置（您不应更改文件夹结构或文件名中的任何内容）
3.  在您的 Wordpress 管理员中安装[WPR Rebuild Meta Data 插件。](https://github.com/WPRanger/wpr-rebuild-meta-data)转到“工具-> 重建元”。这将重建所有修改后的图像元数据（例如，它将新的图像大小更新到数据库中）
4.  在您的 Wordpress 管理员中安装[Force Regenerate Thumbnails 插件。](https://wordpress.org/plugins/force-regenerate-thumbnails/)您可以从“工具 -> 强制重新生成缩略图”中使用它来为您的所有图像执行此操作，或者从 Wordpress 媒体管理器中为您更改的图像执行此操作。这将删除旧的缩略图和自定义图像大小，并从新图像中创建新的。

# css - WordPress 主题，右侧空白

> ID：13713925
> 
> 赞同：0
> 
> 时间：2012-12-04T23:38:59.933
> 
> 标签：css, wordpress, scroll, margins

我一直在寻找解决方案，但到目前为止还没有提出任何解决方案。

我正在 wordpress 上建立我的网站。一切都很好，但我在右边的整个身体上有一个边缘。您可以向右滚动并查看我的标题在哪里切断并且有一个空白边缘。它不会在顶部的管理栏上做到这一点，只有我的主题主体。我没有在正文中添加任何边距，宽度为 100%。有人有解决方案的想法或链接吗？我在不同的计算机和浏览器上看过它，它做同样的事情。

这是我的网站（正在进行中）

[http://www.thewaymultimedia.com/wordpress/](http://www.thewaymultimedia.com/wordpress/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:46:40.003

问题似乎是你的`footer`元素。它的宽度为 100%，并且还具有左右填充。如果您在此元素上设置填充样式，`padding: 10px 0px`问题就会消失。

# c# - 在 C# 中，我的 Common.Logging 记录器应该是实例成员还是静态的？

> ID：13713930
> 
> 赞同：10
> 
> 时间：2012-12-04T23:39:17.873
> 
> 标签：c#, logging, common.logging

查看[一个](https://github.com/quartznet/quartznet/tree/master/src/Quartz.Examples/example1)使用[Common.Logging](http://netcommon.sourceforge.net/index.html) for .NET 的项目，我注意到一些类将记录器实例声明为类静态成员。例如：

```
public class HelloJob : IJob
{
    private static ILog _log = LogManager.GetLogger(typeof(HelloJob));

    public HelloJob()
    {
    }

    public virtual void  Execute(IJobExecutionContext context)
    {
        _log.Info(string.Format("Hello World! - {0}", System.DateTime.Now.ToString("r")));
    }
} 
```

在其他类中，记录器被声明为实例成员：

```
public class SimpleExample : IExample
{
    public virtual void Run()
    {
        ILog log = LogManager.GetLogger(typeof (SimpleExample));

        log.Info("------- Initializing ----------------------");

        // etc
    }
} 
```

有理由偏爱一种方法吗？

在哪些情况下推荐每种方法？它与线程安全有关吗？

如果我刚刚声明了一个带有静态“记录器”成员的“记录器”类并且整个项目都使用了它（除了我实际上有一个全局变量的问题），这会不会有问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-04T23:48:13.077

大多数记录器都是线程安全的，创建它们的实例几乎没有开销，无论是在时间还是内存方面。所以真正的问题需要是从编程和可维护性的角度来看什么是有意义的。

一方面，由于记录器在概念上与您的*类*相关联，而不是与类的*实例*相关联，因此很多人更喜欢将其保持为静态。这是一个完全有效的论点。例如，如果`HelloWorldJob`extends `HelloJob`，我想大多数人都希望代码写入的日志消息`HelloJob`与`HelloJob`类相关联，即使您有一个更具体的子类实例。能够从静态方法访问您的记录器也很好，如果它不在静态字段上，这是不可能的。

另一方面，您的 HelloJob 没有理由负责获取自己的记录器实例。使用依赖注入有很多话要说（单元可测试性、额外的可配置性和更简单的代码）。因此，我个人建议让您的记录器由 DI 框架注入，在这种情况下，需要在每个实例字段中引用它。

```
public class HelloJob : IJob
{
    private readonly ILog _log;

    public HelloJob(ILog log)
    {
        _log = log;
    }
    ...
} 
```

您的 DI 框架可以根据它在运行时知道的详细信息设置记录器，或者您可以在单元测试中提供一个假的或模拟的记录器，以确保生成预期的日志消息。请注意，即使您指的是每个实例的字段，您仍然可以完全自由地使用每个类（甚至是单例）实例——这些只是不需要成为此类的一部分的细节忧虑。

### 更新

随着时间的推移，我的观点更多地转向了使用静态记录器的方向。更具体地说，我真的很喜欢使用[Fody Anotar](https://github.com/Fody/Anotar)库为我生成静态记录器（和其他有用的代码），所以我必须在源代码中编写记录语句，例如：

```
LogTo.Info("This is a message"); 
```

# date - 有没有一种编程方式来获取特定坐标的谷歌地球图像日期？

> ID：13713932
> 
> 赞同：1
> 
> 时间：2012-12-04T23:39:18.530
> 
> 标签：date, gis, google-earth

对于使用此引用模型的项目，我需要在 Google 地球中引用大约 400 个图像位置：[https ://sites.google.com/a/tas.tw/mscitation/how/ge](https://sites.google.com/a/tas.tw/mscitation/how/ge). 这要求我有每个位置的图像日期（方便地存储在 KML 中。不幸的是，对我来说，当我最初创建 KML 地标时我不知道我需要这个。有没有办法以某种方式提取图像日期在 KML 或地标坐标上？如果我可以获得按日期显示图像覆盖范围的 KML 文件，那就足够了。我是一名 GIS 专家，可以轻松地将 KML 转换为 ArcGIS 中的 shapefile 并进行简单的位置查​​询获取日期。但是，我无法找到任何此类 KML。否则，我将不得不重新访问每个地标并从 GE 的信息栏中手动复制图像日期。没什么大不了的（我有已经为大约四分之一的人这样做了），

这似乎对需要引用数百或数千个 Google 地球位置的任何人都有帮助。我怀疑这也将是我最后一次需要这样做。

任何建议表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:01:44.147

如果我正确理解您的问题，您需要 Google 拍摄/更新您所在位置下方特定图像的日期（如 1.2.2012）？

在 GoogleEarth 中，除了为您的每个书签手动执行此操作外，我看不到任何机会。根本没有脚本功能。

作为一个机会，您可能想查看用于网络浏览器的 GoogleEarth 插件（仅限 Windows 和 MacOS）。它有一个 javascript-API，记录在这里：[https](https://developers.google.com/earth/documentation/reference/interface_g_e_plugin) ://developers.google.com/earth/documentation/reference/interface_g_e_plugin 也许在这里深入挖掘......可以解决您的问题。

最后一点：GoogleMaps 也有一个 API，但图像有时与 GoogleEarth 不同。

# xslt - 使用参数的两步 XSLT 转换

> ID：13713938
> 
> 赞同：0
> 
> 时间：2012-12-04T23:39:51.887
> 
> 标签：xslt, dynamic

我正在尝试动态生成将输出模板的样式表，该模板将使用参数，但解析器正在尝试在第一步中插入用于第二步的变量。我要从 XSLT 到 XSLT（别名 axsl），然后到 XSL-FO

```
<xsl:template match="/">
    <axsl:stylesheet version="1.0" xmlns:fo="http://www.w3.org/1999/XSL/Format">
        <axsl:template match="/">

            <axsl:param name="region-before-height" select="'1.75in'"/>

            <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
                <fo:layout-master-set>
                    <fo:simple-page-master master-name="single-transcript" axsl:use-attribute-sets="page-portrait">
                        <fo:region-body />
                        <fo:region-before extent="{$region-before-height}"/>

                    </fo:simple-page-master>
                </fo:layout-master-set>
                <axsl:apply-templates/>
            </fo:root>
        </axsl:template>
    </axsl:stylesheet>
</xsl:template> 
```

我收到一个运行时错误，提示“尚未声明变量 'region-before-height'”。什么是正确的语法，以便 {$region-before-height} 仅在第二次转换期间被解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T03:18:51.390

我认为你需要双大括号：

```
<fo:region-before extent="{{$region-before-height}}"/> 
```

# sql - 使用 SQL 检查日期之间的日期

> ID：13713939
> 
> 赞同：1
> 
> 时间：2012-12-04T23:40:05.980
> 
> 标签：sql, between

运行此查询时出现错误：

```
SELECT '06/30/' + 
 CASE WHEN GETDATE() BETWEEN Cast('1/01/' + YEAR(GETDATE()) + ' 12:01:01' As DateTime) And Cast('6/30/' + YEAR(GETDATE()) + ' 12:01:01' as DateTime)
      THEN CAST(
           YEAR(DATEADD(YY, 2, GETDATE())) AS VARCHAR(4))
      WHEN GETDATE() BETWEEN Cast('7/01/' + YEAR(GETDATE()) + ' 12:01:01' As DateTime) And Cast('12/31/' + YEAR(GETDATE()) + ' 12:01:01' as DateTime)
      THEN CAST(
           YEAR(DATEADD(YY, 3, GETDATE())) AS VARCHAR(4))
      END
      AS DateEnding FOR XML RAW 
```

`Conversion failed when converting the varchar value '1/01/' to data type int.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:46:00.837

`YEAR(GETDATE())`尝试将其与文本组合时，您需要将其 CAST 或 CONVERT 转换为 varchar(4)，否则，它会尝试将文本转换为 int。

```
SELECT '06/30/' + 
 CASE WHEN GETDATE() BETWEEN Cast('1/01/' + CAST(YEAR(GETDATE()) AS VARCHAR(4)) + ' 12:01:01' As DateTime) And Cast('6/30/' + CAST(YEAR(GETDATE()) AS VARCHAR(4)) + ' 12:01:01' as DateTime)
      THEN CAST(
           YEAR(DATEADD(YY, 2, GETDATE())) AS VARCHAR(4))
      WHEN GETDATE() BETWEEN Cast('7/01/' + CAST(YEAR(GETDATE()) AS VARCHAR(4)) + ' 12:01:01' As DateTime) And Cast('12/31/' + CAST(YEAR(GETDATE()) AS VARCHAR(4)) + ' 12:01:01' as DateTime)
      THEN CAST(
           YEAR(DATEADD(YY, 3, GETDATE())) AS VARCHAR(4))
      END
      AS DateEnding FOR XML RAW 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T23:55:03.027

JamieSee 将其转换为 VARCHAR(4) 是正确的。更好的方法是使用明确的日期进行格式化。SQL 将始终将 2012 年 6 月 30 日计算为 2012 年 6 月 30 日，但 2012 年 1 月 7 日是 7 月 1 日（美国格式）还是 1 月 7 日（英国格式）？

```
SELECT '06/30/' + 
 CASE WHEN GETDATE() BETWEEN Cast(CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '-01-01 12:01:01' As DateTime) And Cast(CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '-06-30 12:01:01' as DateTime)
      THEN CAST(
           YEAR(DATEADD(YY, 2, GETDATE())) AS VARCHAR(4))
      WHEN GETDATE() BETWEEN Cast(CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '-07-01 12:01:01' As DateTime) And Cast(CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '-12-31 12:01:01' as DateTime)
      THEN CAST(
           YEAR(DATEADD(YY, 3, GETDATE())) AS VARCHAR(4))
      END
      AS DateEnding FOR XML RAW 
```

# html - 仅 IE 中的 CSS 边距问题

> ID：13713943
> 
> 赞同：0
> 
> 时间：2012-12-04T23:40:18.473
> 
> 标签：html, css, internet-explorer

[我正在使用网格系统作为我们公司网站 ( lexisnexis.stacklaw.com.au](http://lexisnexis.stacklaw.com.au) )上单个网页的响应式布局，并且在 IE 中遇到了一些 css 问题。

jquery 插入的 [+]/[-] 链接在它们应该出现的位置上方移动 20-30px。如果您在 FireFox 或 Chrome 中查看该页面，它们是完全正确的。我怎样才能解决这个问题？

另一个快速的问题，我怎样才能让每个部分也切换更改类，或者将 [-] 移动到与展开时相同的行上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:46:06.027

第一部分给出`float:left`规则`.sectionShort`。

对于第二个

```
var anchor = $("<a href=\"#\" class=\"read more\">[+]</a>").add($(this).find('h3'))
                .click(function(e){
                    //surpress the normal anchor click events
                    e.preventDefault();
                    //fire off our class switching function
                    doSwitch(thisID);
                }).filter('a'); 
```

# c - 在函数内部使用 goto 作为退出的手段

> ID：13713946
> 
> 赞同：0
> 
> 时间：2012-12-04T23:40:28.387
> 
> 标签：c, function, goto

我一直在为一个开源项目 BRL-CAD 编写代码，这是一个已经开发了 30 多年的受人尊敬的项目。在修改文件时，我注意到一些奇怪的逻辑，特别是在出现错误时使用 goto 作为退出函数的一种方式。我读过的每一本书都宣扬这样一个事实，即每个 goto 都有更好的替代品，但在这种情况下，我同意 goto 可能是最佳选择的来源。鉴于：

tables.c 是一个大文件，包含程序中用于排序和获取数据表的 3 个函数。下面是检查错误并在遇到错误时点击 goto 的代码片段，整个文件： http: [//pastebin.com/u4jnNbLu](http://pastebin.com/u4jnNbLu)

```
if ((tabptr=fopen(argv[1], "w+")) == NULL) { //takes place 300-400 lines before the end goto is declared
    bu_vls_printf(gedp->ged_result_str, "%s:  Can't open %s\n", argv[0], argv[1]);
    status = GED_ERROR;
    goto end;} 
```

转到结束：

```
end: //frees memory used in function and returns the status(which became an error above)
    bu_vls_free(&cmd);
    bu_vls_free(&tmp_vls);
    bu_ptbl_free(&cur_path);

    return status; 
```

使用 goto 作为函数中止可以**吗**？我以前从未想过这样的 goto，但对我来说，这似乎比将代码放在一堆令人困惑的大括号中更合乎逻辑，而 while's / if's / else's 会不断地插入代码以检查是否有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:44:33.160

这是纯 C 中的常见构造（以及一些使用返回值而不是错误异常的 C++），并且在 IMO 中是完全可以接受的。这将所有清理工作保持在一个地方（或根据函数的结构尽可能靠近一个地方），并且比使用嵌套 ifs 的错综复杂的网络来验证一切是否正常工作更容易阅读和维护.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T23:44:22.713

goto 名声不好，但这并不意味着不应该使用它。多年来，我一直在 C 语言中使用 goto 来处理特定的错误情况。

您可以在 Linux 内核的编码风格中找到 goto 也用于这些情况：[http ://www.kernel.org/doc/Documentation/CodingStyle](http://www.kernel.org/doc/Documentation/CodingStyle)

你可以在这里找到关于在 C 中使用 goto 的讨论：[GOTO 仍然被认为是有害的吗？](https://stackoverflow.com/questions/46586/goto-still-considered-harmful)

# wpf - 在播放 mp3 或 wav 时结合 NAudio Pan 和 JSNet SuperPitch

> ID：13713950
> 
> 赞同：1
> 
> 时间：2012-12-04T23:40:44.943
> 
> 标签：wpf, naudio

我一直在使用C#/WPF 桌面应用程序中出色的[NAudio库开发专门的 mp3/wav/（wma 后？）播放器。](http://naudio.codeplex.com/)我还添加了[Skype Voice Changer](http://channel9.msdn.com/coding4fun/articles/Skype-Voice-Changer)中使用的 JSNet 库。

*我的目标是能够在播放时修改声音文件的**Pan**和**Pitch**。*

我在播放过程中成功修改了 Pan 属性。我还想出了如何使用 JSNet SuperPitch 对象来修改音高。但是，我只设法**在播放之前**修改音高。播放开始后，SuperPitch 对象上的控件似乎对声音没有影响。

**有没有人成功地将使用 SuperPitch 的音高控制和平移控制与 WaveChannel32.Pan 结合起来？**

问题源于这样一个事实，即效果应用于 a `WaveStream`，然后将其转换为 a`WaveChannel32`以公开`.Pan`属性。但是，一旦发生到 WaveChannel32 的转换，`EffectChain`似乎就不再连接了。

这是一个精简的 WPF 项目，它说明了我的基本方法：

### 简单的 WPF 窗口：

```
<Window x:Class="NAudioDebug.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Slider x:Name="sldPan" TickFrequency="0.2" Minimum="-1.0" Maximum="1.0" ToolTip="Balance" 
                Grid.Row="0" TickPlacement="Both" IsSnapToTickEnabled="True" 
                Value="{Binding Path=Pan, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
        <Slider x:Name="sldPitch" TickFrequency="1" Minimum="-12" Maximum="12.0" ToolTip="Pitch" 
                Grid.Row="1" TickPlacement="Both" IsSnapToTickEnabled="True" 
                Value="{Binding Path=Pitch, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
        <Button x:Name="btnPlayStop" Content="Play/Stop" Grid.Row="2" Click="btnPlayStop_Click" />
    </Grid>
</Window> 
```

这是上面 XAML 的代码隐藏...

```
using System.Windows;

namespace NAudioDebug
{
    public partial class MainWindow : Window
    {
        private Player _Player;

        public MainWindow()
        {
            InitializeComponent();
            _Player = new Player();
            this.DataContext = _Player;
        }

        private void btnPlayStop_Click(object sender, RoutedEventArgs e)
        {
            _Player.PlayStop();
        }
    }
} 
```

### 声音文件播放对象

代码的重要部分是这个对象，它控制播放并提供 WPF 控件可以绑定到的属性。我认为`PlayStop()`方法是问题所在。

```
using System;
using System.ComponentModel;
using JSNet;
using NAudio.Wave;

namespace NAudioDebug
{
    public class Player : INotifyPropertyChanged, IDisposable
    {
        private IWavePlayer _WaveOutDevice;
        private WaveChannel32 _MainOutputStream;
        private EffectStream _EffectStream;
        private EffectChain _Effects;
        private SuperPitch _PitchEffect;
        private bool _bDisposed = false;

        public Player()
        {
            Pan = 0.0f;
            Pitch = 0.0f;
        }

        private float _Pan;
        public float Pan
        {
            get { return _Pan; }
            set
            {
                _Pan = value;
                if (_MainOutputStream != null)
                {
                    _MainOutputStream.Pan = _Pan;
                }
                OnPropertyChanged("Pan");
            }
        }

        private float _Pitch;
        public float Pitch
        {
            get { return _Pitch; }
            set
            {
                _Pitch = value;
                if (_PitchEffect != null)
                {
                    _PitchEffect.Sliders[1].Value = value;  // Slider 1 is the pitch bend in semitones from -12 to +12;
                }
                OnPropertyChanged("Pitch");
            }
        }

        public void PlayStop()
        {
            if (_WaveOutDevice != null && _WaveOutDevice.PlaybackState == PlaybackState.Playing)
            {
                _WaveOutDevice.Stop();
                DisposeAudioResources();
            }
            else
            {   // Starting a new stream...
                DisposeAudioResources();

                _Effects = new EffectChain();
                _PitchEffect = new SuperPitch();
                _PitchEffect.Sliders[1].Value = _Pitch;      // Slider 1 is the pitch bend in semitones from -12 to +12;
                _PitchEffect.Sliders[2].Value = 0.0F;        // Slider 2 is the pitch bend in octaves.
                _Effects.Add(_PitchEffect);

                WaveStream inputStream;     // NOTE: Use a WaveStream here because the input might be .mp3 or .wav (and later .wma?)
                WaveStream mp3Reader = new Mp3FileReader(@"C:\Temp\Test.mp3");
                if (mp3Reader.WaveFormat.Encoding != WaveFormatEncoding.Pcm)
                {
                    mp3Reader = WaveFormatConversionStream.CreatePcmStream(mp3Reader);
                }
                inputStream = mp3Reader;

                _EffectStream = new EffectStream(_Effects, inputStream);

                _MainOutputStream = new WaveChannel32(_EffectStream);
                _MainOutputStream.PadWithZeroes = false;
                _MainOutputStream.Pan = Pan;

                _WaveOutDevice = new WaveOut();
                _WaveOutDevice.Init(_MainOutputStream);
                _WaveOutDevice.Play();

                this._WaveOutDevice.PlaybackStopped += OnPlaybackStopped;
            }
        }

        private void OnPlaybackStopped(object sender, EventArgs e)
        {   // Clean up the audio stream resources...
            DisposeAudioResources();
        }

        private void DisposeAudioResources()
        {
            if (_WaveOutDevice != null) { _WaveOutDevice.Stop(); }
            if (_MainOutputStream != null) { _MainOutputStream.Close(); _MainOutputStream = null; }
            if (_PitchEffect != null) { _PitchEffect = null; }
            if (_Effects != null) { _Effects = null; }
            if (_EffectStream != null) { _EffectStream = null; }
            if (_WaveOutDevice != null) { _WaveOutDevice.Dispose(); _WaveOutDevice = null; }
        }

        protected void OnPropertyChanged(PropertyChangedEventArgs e)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) { handler(this, e); }
        }

        protected void OnPropertyChanged(string sPropertyName)
        {
            OnPropertyChanged(new PropertyChangedEventArgs(sPropertyName));
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool bDisposing)
        {   // Check to see if Dispose has already been called...
            if (!_bDisposed)
            {
                DisposeAudioResources();
                _bDisposed = true;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T09:04:04.657

您必须记住`effect.Slider()`在滑块的值更改后调用。每当滑块更改时，许多效果都必须重新计算参数，因此出于性能原因，您必须在更改值后通知它。

我希望通过`ISampleProvider`界面重新实现我为 SkypeFx 制作的许多效果，这将使它们在 NAudio 中更容易使用。

# java - 将 JPanel 和paintComponent 链接在一起

> ID：13713951
> 
> 赞同：1
> 
> 时间：2012-12-04T23:40:59.267
> 
> 标签：java, swing, jpanel, actionlistener, paintcomponent

如何让paintComponent 在我的drawArea JPanel 中工作？此外，我设置 drawArea 尺寸的尝试失败了。运行后不会进行绘图，并且 JPanel 是最小尺寸。这与 MigLayout 有关系吗？

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import net.miginfocom.layout.*;
import net.miginfocom.swing.MigLayout;
import java.awt.geom.*;

public class OvalDrawer extends JApplet
{
private JLabel numberL;
private JTextField numberTF;

private NumHandler numHandler;

public static final int WIDTH = 500;
public static final int HEIGHT = 500;

public int number;

//Create Layout
public void init()
{
    setLayout(new MigLayout("wrap 2"));
    numberL = new JLabel("Enter number of ovals to draw:");
    numberTF = new JTextField(7);

    add(numberL);
    add(numberTF);

    numHandler = new NumHandler();
    numberTF.addActionListener(numHandler);

    JPanel drawArea = new JPanel();
    drawArea.setSize(400, 400);
    drawArea.setBorder(BorderFactory.createTitledBorder("Draw Area"));
    add(drawArea, "span 2");

    setSize(WIDTH, HEIGHT);
}

//Event Handler
public class NumHandler implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        number = Integer.parseInt(numberTF.getText());
        repaint();
    }

}

//Draw Ovals
public void paintComponent (Graphics g)
{
    super.paintComponents(g);
    int x = 10;
    int y = 10;
    int width = 200;
    int height = 100;

    for (int i = 0; i < number; i++)
    {
        g.drawOval(x, y, width, height);

        x += 5;
        y += 5;
        width += 5;
        height += 5;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:51:44.763

中没有`paintComponent`方法`JApplet`。

您应该避免直接在顶级容器上绘画，例如`JApplet`，它只是一个单层容器。

相反，创建第二个类，从某些东西扩展`JPanel`并在那里执行您的自定义绘画。

**更新**

您还应该避免使用`setPreferred/Minimum/MaximumSize`，它很容易被其他人规避。

```
public class OvalDrawer extends JApplet {

    private JLabel numberL;
    private JTextField numberTF;
    private NumHandler numHandler;
    public static final int WIDTH = 500;
    public static final int HEIGHT = 500;
    public int number;

    //Create Layout
    public void init() {
//        setLayout(new MigLayout("wrap 2"));
        setLayout(new BorderLayout());
        numberL = new JLabel("Enter number of ovals to draw:");
        numberTF = new JTextField(7);

        JPanel header = new JPanel();
        header.add(numberL);
        header.add(numberTF);

        add(header, BorderLayout.NORTH);
        add(new PaintPane());

        numHandler = new NumHandler();
        numberTF.addActionListener(numHandler);

//        JPanel drawArea = new JPanel();
//        drawArea.setSize(400, 400);
//        drawArea.setBorder(BorderFactory.createTitledBorder("Draw Area"));
//        add(drawArea, "span 2");

        setSize(WIDTH, HEIGHT);
    }

    //Event Handler
    public class NumHandler implements ActionListener {
        public void actionPerformed(ActionEvent e) {
            number = Integer.parseInt(numberTF.getText());
            repaint();
        }
    }

    //Draw Ovals
    public class PaintPane extends JPanel {

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        @Override
        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            int x = 10;
            int y = 10;
            int width = 200;
            int height = 100;

            for (int i = 0; i < number; i++) {
                g.drawOval(x, y, width, height);

                x += 5;
                y += 5;
                width += 5;
                height += 5;
            }
        }
    }
} 
```

# mysql - 试图从 SQL Server 2008 二进制类型中提取数据

> ID：13713952
> 
> 赞同：1
> 
> 时间：2012-12-04T23:41:00.813
> 
> 标签：mysql, vb.net, sql-server-2008

我有一台运行 Server SQL 2008 的计算机。它不是我设置的，是我为保持库存而购买的这个软件设置的。它有一个我想转移到 MYSQL 数据库的表（因为我的网站使用 mysql——我想做转移的原因。）

所以我决定使用 VB.NET 制作一个程序，它从 SQL Server 2008 读取数据，然后插入到 MYSQL 中的表中。我确保表的设置相同，并且每列具有相同的列和数据类型。

我有一张桌子可以完全转移。但是，我试图转移这个特定的表，它有一个 BINARY(8) 类型的列。我应该提到，当我使用 MSSM 本身在服务器计算机上进行选择时，它会在 binary(8) 列行中显示十六进制值。所以这些值类似于 0x3920409F332D234。

所以我显然在 MYSQL 中设置了一个相同的表，但是当我试图将它从服务器 sql 中拉出并插入到 mysql 时，它会抛出错误（只是这个特定的列。）

在 VB.NET 中，我尝试创建一个 Byte() 数组以在选择数据后检索数据，然后将带有查询语句的数据插入 MYSQL，但它显示“太长”。我不确定这是否是保存二进制数据的正确变量。

老实说，我不确定我是否需要这个专栏。我不确定它是什么。但是我需要的大多数表都有这些数据，所以我想安全并保留它。

泰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:29:11.377

首先，您为什么要将数据传输到您的网站数据库？如果您只是将它移到那里以便您可以读取它并显示值，那么您可以跳过尝试复制该列。简而言之，如果您甚至不知道数据是什么，您将如何以及为什么要显示数据？

其次，我看到购买的软件使用了小的二进制列（在我的软件中，列名是 Timestamp），基本上是在多用户环境中作为保存检查。基本上，软件会在您打开记录时读取值，然后在保存时检查以确保数据库中的值没有更改。如果没有，它会更新。如果是这样，它会显示类似“另一个用户已修改此记录，请重做更改并重试”之类的警告。所以它可能就是这个二进制列。

但是，如果您仍想复制数据，或者至少想弄清楚如何使用二进制列，则必须显示一些代码并更具体地说明您遇到的错误。或者您可以查看以下资源：

[MySQL 中的二进制数据](https://stackoverflow.com/questions/17/binary-data-in-mysql)

[简单的 MySQL 二进制数据插入](https://stackoverflow.com/questions/9547412/simple-mysql-binary-data-inserting)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T00:23:59.747

听起来像是“时间戳”或“行版本”列，用于检测编辑冲突。您可能可以忽略它。

但是，如果您确实想复制它，则需要将二进制文件编码为 SQL。我不确定 MySQL 语法，但对于 SQL Server，我使用以下内容：

```
 ''' <summary>'
 ''' Converts binary data to a String for use in an SQLS2005 SQL statement (e.g. "0x000000000000006A")'
 ''' </summary>'
 ''' <param name="data">Required Byte(). 0-based 1-dimensional array of binary data to convert</param>'
 ''' <returns></returns>'
 ''' <remarks></remarks>'
 Public Function Byte2SQL(ByVal data() As Byte) As String
   Dim sbl As New System.Text.StringBuilder("0x")
   For i As Integer = data.GetLowerBound(0) To data.GetUpperBound(0)
     sbl.Append(Right("00" & Hex(data(i)), 2))
   Next i
   Return sbl.ToString
 End Function 
```

# objective-c - CBperipheral uuid 在 i-phone5 上的 ios 6.0.1 中为空

> ID：13713953
> 
> 赞同：9
> 
> 时间：2012-12-04T23:41:06.987
> 
> 标签：objective-c, ios6, iphone-5, core-bluetooth, bluetooth-lowenergy

好吧，我有一个应用程序可以扫描并连接到 ios 6.0.1 下但在 iphone 4s 上的“蓝牙 le”设备，它运行良好。将应用程序上传到苹果商店时，他们返回给我一个应用程序崩溃，bat 编程，但我只了解当我在 iphone5 上尝试应用程序时崩溃

```
 - (void)centralManager:(CBCentralManager *)central didDiscoverPeripheral:(CBPeripheral *)peripheral advertisementData:(NSDictionary *)advertisementData RSSI:(NSNumber *)RSSI; 
```

给我一个带有空 uuid 的外围设备。

我打印外围设备、名称、uuid、rssi 和 advertData，一切都很好，但 uuid 为空，我在应用程序中使用 uuid。这使我的应用程序崩溃，我可以控制 null uuid，这意味着我无法控制应用程序。

有人知道会发生什么，以及可能的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T11:17:41.790

接下来我们要做的是：你不能用 NSLog 写外设对象，但是在执行 connect 之前我们不能有外设的 uuid 属性。它始终为空。我们在服务读取完成时请求 uuid，而不是之前，然后我们无法在 i-phone5 上运行应用程序而不会崩溃。

我在 TI（德克萨斯仪器）上读到它是一个 ios 错误，但我认为这是一个 ble 安全更新，我们需要在询问 uuid 之前进行连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:36:49.723

第一次连接后，设备会记住/缓存 UUID。如果稍后发现相同的外围设备，则 UUID 将在连接之前可用。您可以通过调用“retrievePeripherals”来请求所有记住的外围设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-03T09:59:41.240

它似乎是 iOS 6 中的一个错误/功能增强，我认为由于代码的异步性质，它在 iPhone 5 上更加明显。我也有适用于 4S 但不适用于 5 的代码。

大多数人发布的解决方法是确保您在找到时连接到您找到的每台设备。解释是在建立连接之前不会分配 UUID。

您可以在 TI 传感器标签代码中看到一个示例，您可以从 TI 网站下载该代码

```
-(void)centralManager:(CBCentralManager *)central didDiscoverPeripheral:(CBPeripheral *)peripheral advertisementData:(NSDictionary *)advertisementData RSSI:(NSNumber *)RSSI {

    NSLog(@"Found a BLE Device : %@",peripheral);

    /* iOS 6.0 bug workaround : connect to device before displaying UUID !
       The reason for this is that the CFUUID .UUID property of CBPeripheral
       here is null the first time an unkown (never connected before in any app)
       peripheral is connected. So therefore we connect to all peripherals we find.
    */

    peripheral.delegate = self;
    [central connectPeripheral:peripheral options:nil];

    [self.nDevices addObject:peripheral];

} 
```

但是值得注意的是，您还可以执行以下操作

```
- (void)centralManager:(CBCentralManager *)central didDiscoverPeripheral:(CBPeripheral *)peripheral advertisementData:(NSDictionary *)advertisementData RSSI:(NSNumber *)RSSI
{
    NSLog(@"didDiscoverPeripheral");

    if (![foundPeripherals containsObject:peripheral]) {
        NSLog(@"foundPeripherals addObject %@", peripheral.name);
        [foundPeripherals addObject:peripheral];
    } else {
        NSInteger index = [foundPeripherals indexOfObject:peripheral];
        NSLog(@"foundPeripherals replaceObject %@", peripheral.name);
        [foundPeripherals replaceObjectAtIndex:index withObject:peripheral];
    }

} 
```

as`didDiscoverPeripheral`为每个设备调用不止一次（我在 iPhone 5 上看到它调用了两次），第二次外围设备详细信息完成。

# php - 比较或查看 PHP 中的散列密码

> ID：13713954
> 
> 赞同：0
> 
> 时间：2012-12-04T23:41:12.397
> 
> 标签：php, hash, whirlpool

我有以下 PHP 脚本来散列用户的密码，但是，当我尝试将散列变量与原始密码进行比较时，它返回 false。

```
$hash=hash("whirlpool","hello");

if("hello"===$hash){echo "TRUE";}
else{echo "FALSE";} 
```

有谁知道我做错了什么或者我可以做些什么来改进这段代码以使其正常工作？我需要哈希与变量相同，所以我可以实际使用它。

**旁注**：我想使用大小合适的加密（这就是我使用“漩涡”算法的原因），所以我不想使用 md5、sha1 等...

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:45:54.547

您不应该将这些值比较为

```
if(hash('whirlpool', 'hello') === $hash) echo 'true';
else echo 'false'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:07:04.553

散列函数是一种单向加密算法（单向意味着您无法从给定输出计算输入）。它需要一个输入并输出一个相当长的数字（通常以十六进制格式表示）。So when you apply a hash algorithm on a given input (in your case you apply the whirlpool algorithm on "hello") it returns a digest (in your case digest hex string would be 0a25f55d7308eca6b9567a7ed3bd1b46327f0f1ffdc804dd8bb5af40e88d78b88df0d002a89e2fdbd5876c523f1b67bc44e9f87047598e7548298ea1c81cfd73). 显然“你好”不等于“0a25f..”。使用哈希算法的一个常见场景是保护保存在数据库或其他某种身份存储中的密码。因此，在比较给定密码时（例如

因此，您不想将“hello”与先前生成的哈希进行比较，而是将“hello”的哈希与先前生成的哈希进行比较。

```
$hash = hash("whirlpool","hello");
if(hash("whirlpool","hello") === $hash){
    echo "true";
} 
```

假设你想检查一个提交的密码，你可以这样写：

```
$pw_stored = "0a25f..." //(... left out some chars) that's the hash you got from the db
if(hash('whirpool', $_POST['password']) === $pw_stored){ // $_POST['password'] is the password a user has entered in a login form 
    echo "true";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T23:44:18.013

比较哈希时，您可能还想对比较值进行哈希处理，例如

```
$hashed_password = hash("whirlpool", "hello");
$input = "hello";

if (hash("whirlpool", $input) === $hashed_password) {
    echo "TRUE";
} else {
    echo "FALSE";
} 
```

PS：如果你真的想用漩涡，加个*盐*。此外，请遵循[OWASP](https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet)上的最佳实践。

# .net - 指向不同网站的子目录 - 可能吗？

> ID：13713961
> 
> 赞同：2
> 
> 时间：2012-12-04T23:41:56.973
> 
> 标签：.net, wordpress, apache, iis, subdomain

我认为我要问的是不可能的，但是就这样。

我有两个站点，一个是托管在 apache 服务器上的 wordpress。让我们称之为 mydomain.com

另一个在 IIS 上，我们称之为 blog.mydomain.com

是否有可能以某种方式在 blog.mydomain.com 上有一个子目录，例如 mydomain.com/blog 点？

由于这两个站点建立在不同的平台上，我目前不得不将它们保存在不同的域中，但理想情况下我希望它们的行为像这样 - wordpress 作为我的主站点，子文件夹是我的 .Net 站点。

我知道如果全部是 .Net 和 IIS，则可以在不同的应用程序上拥有一个虚拟目录点，但这对我来说是不现实的可能性。

我认为这将是不可能实现的，但任何建议或建议都会受到欢迎。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T06:09:44.170

反向代理应该通过透明地从另一台服务器获取数据来解决您的问题：

[http://en.wikipedia.org/wiki/Reverse_proxy](http://en.wikipedia.org/wiki/Reverse_proxy)

Nginx 是 Linux 平台的流行选择，我刚刚注意到它也适用于 Windows 平台：

[http://wiki.nginx.org/Main](http://wiki.nginx.org/Main)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T13:24:45.243

Apache 有一个`ProxyPass`指令可以让您执行此操作。

`VirtualHost`在您的配置中定义它，`mydomain.com`如下所示：

```
<VirtualHost *:80>
        ServerName mydomain.com
        ServerAlias mydomain.com

        ProxyPass /blog http://blog.mydomain.com/ retry=0
        ProxyPassReverse /blog http://blog.mydomain.com/

        # other directives

</VirtualHost> 
```

您还需要启用`mod_proxy`Apache（可能还有其他模块），如此处 Apache 文档中[所列](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)。

我仍然会说，您尝试做的并不是访问该站点的理想方式。除了由于代理操作会产生性能开销之外，某些站点配置还绑定到单个域和文件夹路径。在这种情况下，该站点将使用怪癖（危险）或根本不为用户工作（不太危险）。当我说危险时，我的意思是用户可能会被欺骗认为该站点正在运行并执行不可逆的站点操作，这可能会陷入困境或导致数据损坏。

# dojo - 如何在 dojox.grid._Builder 中覆盖 doResizeColumn

> ID：13713962
> 
> 赞同：1
> 
> 时间：2012-12-04T23:41:58.797
> 
> 标签：dojo, overriding

如何在 dojox.grid._Builder 中覆盖 doResizeColumn。我不确定如何处理它，因为它是变量 dg._HeaderBuilder 中的一个方法。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T10:49:33.997

如果您想为所有实例覆盖它，可以使用`dojo/aspect`'s来完成`around()`（有关更多信息，请参阅[参考指南](http://dojotoolkit.org/reference-guide/1.8/dojo/aspect.html)），如下所示：

```
 define(["dojo/aspect"], function(aspect) {
        aspect.around(dojox.grid._builder, "doResizeColumn", function(originalDoResizeColumn) {
            return function(/* needs the original signature(params) of the original doResizeColumn */) {
                // Your code here
                /* you could call the original doResizeColumn (which you 'kinda override' here) anytime if you want just here
                 * originalDoResizeColumn(...);
                 */
                // and even do sth. after it.
            };
        });
    }); 
```

**编辑：** 对于 dojo `V1.6`，这有点实验性，但您可以尝试一下：

```
 dojo.require("dojox.lang.aspect");
    var aop = dojox.lang.aspect; //define the namespace...

    aop.advise(dojox.grid._Builder, 'doResizeColumn', {
        around: function( /*originalparameters*/ ) {

            // your code here
            // the original coll looks as sth. like the following i dunno exactly

            aop.proceed( /*fitting params*/ ); 
            // some other code after it maybe...
        }
    }); 
```

查看[这个有趣的博客条目](http://lazutkin.com/blog/2008/may/18/aop-aspect-javascript-dojo/)或此类[文档](http://higginsforpresident.net/api/dojox/lang/aspect.html)以`dojox.lang.aspect`获取更多信息。也许`dojox.lang.aspect.advise`'s`before`会更好地满足您的需求。请参阅上面的链接。希望这可以帮助。

# python - 输出打印多次

> ID：13713966
> 
> 赞同：1
> 
> 时间：2012-12-04T23:42:25.723
> 
> 标签：python, pyqt4, beautifulsoup, qwebview

下面的代码工作正常，除了一件事：所需的输出打印几次=）

```
#! /usr/bin/env python2.7

from PyQt4.QtCore import *
from PyQt4.QtGui import *
from PyQt4.QtWebKit import *
from bs4 import BeautifulSoup as bs
from random import choice
from urllib import urlretrieve
from urllib2 import *
import sys
import os

# Settings for browser
class MyBrowser(QWebPage):
    def __init__(self):
        QWebPage.__init__(self)
        # Specifies whether images are automatically loaded in web pages.
        self.settings().setAttribute(QWebSettings.AutoLoadImages, False)

    def userAgentForUrl(self, url):
        return "Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.15 (KHTML, like Gecko) Chrome/24.0.1295.0 Safari/537.15"

class Name_Creater(QWebView):
    def __init__(self):
        QWebView.__init__(self)
        self.setPage(MyBrowser())
        self.loadFinished.connect(self.grab_first_name)
        self.frame = self.page().mainFrame()

    def grab_first_name(self):
        html = unicode(self.frame.toHtml()).encode('utf-8')
        soup = bs(html)
        for name in soup.findAll('li', text=True):
            print name

if __name__ == '__main__':
    app = QApplication(sys.argv)
    url_first_names = QUrl("http://www.genealogyroadtrip.com/Census/male_names_1.htm")
    br = Name_Creater()
    br.load(url_first_names)
    br.show()
    app.exec_() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T01:56:35.933

问题是您正在连接到 的`loadFinished`信号，该信号将为*每个*加载的页面`QWebView`发出一次。所以如果有多个帧，就会发出多个信号。*`loadFinished`*

 *解决方案是连接到[mainFrame](https://qt-project.org/doc/qt-4.8/qwebpage.html#mainFrame)`loadFinished`的信号：

```
self.setPage(MyBrowser())
self.frame = self.page().mainFrame()
self.frame.loadFinished.connect(self.grab_first_name) 
```*

# neo4j - Neo4J / Cypher 需要编写一个查询，显示通过特定数量的路径连接到初始节点的所有结果节点

> ID：13713970
> 
> 赞同：1
> 
> 时间：2012-12-04T23:42:58.577
> 
> 标签：neo4j, cypher

在 Neo4J 中，如何编写一个 Cypher 查询来显示通过特定数量的路径连接到初始节点的所有节点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T02:03:37.707

路径数还是跳数？

```
start n=node(x)
match path = n-[:TYPE*..3]->end // number of hops *..3 is up to 3 hops
return path
limit 10 // number of paths 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T02:19:15.487

我想也许他正在寻找：

```
start n=node(x) 
match path = n-[*]->end      // maybe specify a max length and type?
with count(path) as cnt, end // group by end node, get count of paths
where cnt = <numpaths>       // replace <numpaths> with the number of paths you want to match
return end 
```

# php - PHP MYSQL使用表中的数组插入多个数据

> ID：13713971
> 
> 赞同：1
> 
> 时间：2012-12-04T23:43:04.007
> 
> 标签：php, mysql

我的代码有问题：

```
$size = count($_POST['tv_id']);
$size = count($_POST['Season']);
$size = count($_POST['EpisodeNumber']);
$size = count($_POST['EpisodeName']);

$i = 0;
while ($i < $size) {
    $Season = mysql_real_escape_string($_POST['tv_id'][$i]);
    $Season = mysql_real_escape_string($_POST['Season'][$i]);
    $EpisodeNumber= mysql_real_escape_string($_POST['EpisodeNumber'][$i]);
    $EpisodeName= mysql_real_escape_string($_POST['EpisodeName'][$i]);

    $sql="INSERT INTO tvshows SET fk_id = '".$fk_id."', tv_id ='".$tv_id."', Season ='".$Season."', EpisodeNumber='".$EpisodeNumber."', EpisodeName='".$EpisodeName."'";
    $query = mysql_query($sql) or die(mysql_error());
 } 
```

如果我只在表单中填写我的一个输入并点击提交，它会提交一个但还有 16 个空白记录，其中只有 playlist_id 和其他列为空白。如果我填写了 5 列，它会提交它们，但也会提交 11 个空白以及 fk_id

我的表格布局是这样的：

```
echo '<tr>';
echo "<td><input type='hidden' name='tv_id[]' id='tv_id' value='' /></td>";
echo "<td><input type='text' name='Season[]' id='Season[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeNumber[]' id='EpisodeNumber[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeName[]' id='EpisodeName[]' value='' /></td>";
echo '</tr>';

echo '<tr>';
echo "<td><input type='hidden' name='tv_id[]' id='tv_id' value='' /></td>";
echo "<td><input type='text' name='Season[]' id='Season[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeNumber[]' id='EpisodeNumber[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeName[]' id='EpisodeName[]' value='' /></td>";
echo '</tr>';

echo '<tr>';
echo "<td><input type='hidden' name='tv_id[]' id='tv_id' value='' /></td>";
echo "<td><input type='text' name='Season[]' id='Season[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeNumber[]' id='EpisodeNumber[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeName[]' id='EpisodeName[]' value='' /></td>";
echo '</tr>';

echo '<tr>';
echo "<td><input type='hidden' name='tv_id[]' id='tv_id' value='' /></td>";
echo "<td><input type='text' name='Season[]' id='Season[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeNumber[]' id='EpisodeNumber[]' value='' /></td>";
echo "<td><input type='text' name='EpisodeName[]' id='EpisodeName[]' value='' /></td>";
echo '</tr>'; 
```

并继续前进大约 10 个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:56:19.083

您需要做的是有一个 if 语句来验证您的表单，只要您有表单操作的 php 代码。您可以使用以下代码的一些变体。

```
for($i = 0; $i < count($thisVar); $i++) {
    if(!empty($thisVar[$i])) {
        <insert query>
    }
} 
```

$thisVar 是存储表单输入的数组，而 i 是数组中存储值的位置。

作为旁注，当您`$size`连续定义多次时，最后一个将是唯一的值。如果在这种情况下您需要另一个 for 循环，`$j`并且 if 语句将在那里，您可以做一个 2D 数组`$thisVar[$i][$j]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T00:00:16.150

我不明白为什么您将所有计数都放在相同的 var 大小中，但是对于空记录，您可以执行以下操作：

```
while ($i < $size) {
    $Season = mysql_real_escape_string($_POST['tv_id'][$i]);
    $Season = mysql_real_escape_string($_POST['Season'][$i]);
    $EpisodeNumber= mysql_real_escape_string($_POST['EpisodeNumber'][$i]);
    $EpisodeName= mysql_real_escape_string($_POST['EpisodeName'][$i]);
    //....
    if(!empty($Season) and !empty($EpisodeNumber) and ...)
    {
    $sql="INSERT INTO tvshows SET fk_id = '".$fk_id."', tv_id ='".$tv_id."', Season ='".$Season."', EpisodeNumber='".$EpisodeNumber."', EpisodeName='".$EpisodeName."'";
    $query = mysql_query($sql) or die(mysql_error());
    }
    $i++;  } 
```

# javascript - 一个锚，两个目标

> ID：13713978
> 
> 赞同：0
> 
> 时间：2012-12-04T23:44:05.993
> 
> 标签：javascript, html, http

我有一个网页应该控制两个不同服务器上的两个不同脚本，以便开始和结束音频流。只需访问 URL 即可启动和停止脚本。“控制器”页面如下所示：

* * *

开始和停止流媒体！

**去现场！**

**去死吧！**

* * *

我的代码是这样的：

```
<!DOCTYPE html>
<html lang="en">
<head>
<script language="javascript">
   <!--
    function goLive(){
    parent.targetname.location.href = "http://URL.1server.1";
    parent.targetname.location.href = "http://URL.2server.1";
 }

function goDead(){
   parent.targetname.location.href = "http://URL.1server.2";
   parent.targetname.location.href = "http://URL.2server.2";
}

//-->
</script>
</head>

<body>

   <h1>Start and Stop the Streaming!</h1>
   <br>
   <a target="_blank" href="javascript: goLive();">Go LIVE</a>
   <br>
   <a target="_blank" href="javascript: goDead();">Go Dead</a>
 </body></html> 
```

脚本在 JavaScript 控制台中失败并出现此错误：

> 未捕获类型错误：无法读取未定义本地主机的属性“位置”：57 goLive 本地主机：57（匿名函数）本地主机：1 未捕获类型错误：无法读取未定义本地主机的属性“位置”：62 goDead 本地主机：62

我究竟做错了什么？我什至走在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T01:45:25.863

```
var newWin = "open_1"
window.open("http://URL.1server.1", newWin);
newWin = "close_2" 
window.open("http://URL.2server.1", newWin); //etc. 
```

(window).parent 是指打开当前窗口的网页。

# ios - 如何在关闭 UIAlertView 后防止 UIKeyboard 动画消失和返回

> ID：13713979
> 
> 赞同：2
> 
> 时间：2012-12-04T23:44:05.730
> 
> 标签：ios, uitextview, uikeyboard

我想知道这里是否有任何 iOS 开发人员遇到了这个问题，并且可能能够提出解决方案。它涉及 UIKeyboard 的行为，因为它与 UITextView 和 UIAlertView 相关。

在应用程序中，点击 UITextView 会调用 UIKeyboard。在 UITextView 的附件视图中点击一个按钮会调用具有 UIAlertViewStyleLoginAndPasswordInput 样式的 UIAlertView。到目前为止一切都很好。

这是不好的：解除 UIAlertView 会导致 UIKeyboard 动画消失，然后在 UITextView 再次成为第一响应者时返回。期望的行为是跳过动画。在 UIAlertViewDelegate 方法中调用 [textView becomeFirstResponder] 似乎不起作用。

这是一个说明该行为 [的示例项目，下面发布了相关的代码片段和日志。](https://github.com/aerych/responder-test)

对此有什么想法？

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UIBarButtonItem *alertButton = [[UIBarButtonItem alloc] initWithTitle:@"Alert" style:UIBarButtonItemStyleBordered target:self action:@selector(handleAlertButtonTapped:)];
    UIBarButtonItem *spacer = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
    UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithTitle:@"Done" style:UIBarButtonItemStyleBordered target:self action:@selector(handleDoneButtonTapped:)];
    UIToolbar *toolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0.0, 0.0, self.view.frame.size.width, 44.0)];
    toolbar.barStyle = UIBarStyleBlack;
    toolbar.items = @[alertButton, spacer, doneButton];

    UIView *accessoryView = [[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, self.view.frame.size.width, 44.0)];
    [accessoryView addSubview:toolbar];
    textView.inputAccessoryView = toolbar;

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(handleKeyboardWillShow:) name:UIKeyboardWillShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(handleKeyboardDidShow:) name:UIKeyboardDidShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(handleKeyboardWillHide:) name:UIKeyboardWillHideNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(handleKeyboardDidHide:) name:UIKeyboardDidHideNotification object:nil];

}

- (void)handleAlertButtonTapped:(id)sender {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Styled AlertView"
                                                        message:nil
                                                       delegate:self
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles:nil, nil];
    [alertView setAlertViewStyle:UIAlertViewStyleLoginAndPasswordInput];
    [alertView show];
}

- (void)handleDoneButtonTapped:(id)sender {
    [textView resignFirstResponder];
}

#pragma mark -
#pragma mark TextView Delegate Methods

- (BOOL)textViewShouldEndEditing:(UITextView *)textView {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    return YES;
}

- (void)textViewDidEndEditing:(UITextView *)textView {
    NSLog(@"%@", NSStringFromSelector(_cmd));
}

#pragma mark -
#pragma mark AlertView Delegate methods

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
}

- (void)alertView:(UIAlertView *)alertView willDismissWithButtonIndex:(NSInteger)buttonIndex {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
}

- (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
}

#pragma mark -
#pragma mark Keyboard Notification Methods

- (void)handleKeyboardWillShow:(NSNotification *)notification {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
}

- (void)handleKeyboardDidShow:(NSNotification *)notification {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
}

- (void)handleKeyboardWillHide:(NSNotification *)notification {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
}

- (void)handleKeyboardDidHide:(NSNotification *)notification {
    NSLog(@"%@", NSStringFromSelector(_cmd));
    [textView becomeFirstResponder]; // Not a solution.
} 
```

日志的结果是这样的：

```
ResponderTest[1228:11303] handleKeyboardWillShow:
ResponderTest[1228:11303] handleKeyboardDidShow:
ResponderTest[1228:11303] handleAlertButtonTapped:
ResponderTest[1228:11303] handleKeyboardWillShow:
ResponderTest[1228:11303] handleKeyboardDidShow:
ResponderTest[1228:11303] alertView:clickedButtonAtIndex:
ResponderTest[1228:11303] alertView:willDismissWithButtonIndex:
ResponderTest[1228:11303] handleKeyboardWillHide:
ResponderTest[1228:11303] handleKeyboardDidHide:
ResponderTest[1228:11303] handleKeyboardWillShow:
ResponderTest[1228:11303] handleKeyboardDidShow:
ResponderTest[1228:11303] handleKeyboardWillHide:
ResponderTest[1228:11303] handleKeyboardDidHide:
ResponderTest[1228:11303] handleKeyboardWillShow:
ResponderTest[1228:11303] alertView:didDismissWithButtonIndex:
ResponderTest[1228:11303] handleKeyboardDidShow: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T02:08:16.337

除非我误解了您的应用程序结构，否则您似乎将所有那些 resignFirstResponder 和成为 UIAlertView 解雇的成为FirstResponder 的事情复杂化了。

基本上你有一个带有用户名和密码字段的 UIAlertView 是吗？

添加一个带有“完成”按钮的 UIToolBar，该按钮具有如下回调方法：

```
// ------------------------------------------
// Setup keyboard done button as input
// accessory view for your two fields
// ------------------------------------------
UIToolbar *toolBar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
[toolBar setBarStyle:UIBarStyleBlackTranslucent];

UIButton *btnDone = [[UIButton alloc] initWithFrame:CGRectMake(230, 4, 66, 35)];
[btnDone setImage:[UIImage imageNamed:@"btnDoneOff.png"] forState:UIControlStateNormal];
[btnDone setImage:[UIImage imageNamed:@"btnDoneOn.png"] forState:UIControlStateHighlighted];

// ------------------------------------------
// Done button calls hideKeyboard method
// when tapped, this is the only place you
// need to call resign first responder
// ------------------------------------------
[btnDone addTarget:self action:@selector(hideKeyboard) forControlEvents:UIControlEventTouchUpInside];

[toolBar addSubview:btnDone];

[btnDone release];

fldUsername.inputAccessoryView = toolBar;
fldPassword.inputAccessoryView = toolBar;

...

// ------------------------------------------
// Resigns first responder for the two fields
// ------------------------------------------
-(void)hideKeyboard
{
    [fldUsername resignFirstResponder];
    [fldPassword resignFirstResponder];
} 
```

这样做，您可以点击用户名字段或密码字段，键盘不应关闭。输入用户名和密码后，在键盘输入附件视图中按“完成”按钮将隐藏键盘，而不会导致键盘滑入和滑出。

# php - 在 Varnish 缓存页面中包含 req.http.referer

> ID：13713981
> 
> 赞同：0
> 
> 时间：2012-12-04T23:44:13.800
> 
> 标签：php, ubuntu, varnish

我有一个网站只有少数几个来源的流量高峰。该站点还需要能够通过猜测用户是否刚刚使用 PHP $_SERVER["HTTP_REFERER"] 到达站点来向用户显示内容。

是否可以在清漆缓存中包含 req.http.referer 的值，以便这种行为更多地基于个人用户？我相信某些用户正在显示错误的内容，因为另一个用户缓存了具有不同引荐来源值的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T16:52:11.893

如果您希望缓存在所有可能的引用上都不同，那么 http 协议 Vary-header 是您的解决方案。如果您的流量与来自极少数唯一 URL 的引荐来源不太一致，那实际上会杀死您的缓存命中率。

我认为更好的解决方案是从php层去除猜测谁是新用户的逻辑并将其添加到varnish中。这可以通过在 vcl_recv 中为请求设置一个自定义标头来完成，然后使用该标头在 vcl_hash 中通过添加类似这样的内容到 vcl_recv

```
if ((req.http.referer ~ "www.newuserhost1.com" || req.http.referer ~ "www.newuserhost2.com") &&
    req.url == "/") {
       req.http.X-New-User = 1;
} 
```

并将其添加到 vcl_hash

```
 hash_data(req.http.X-New-User); 
```

当用户到达您的后端时，您可以从那里检查 X-New-User 的值而不是referer。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T12:35:38.193

HTTP 规范对此有解决方案。Vary 响应标头指示在生成内容时考虑了哪些请求标头。

在后端响应中添加“Vary:Referer”标头，Varnish 将为每个客户端提供正确的变体。

# magento - 我的免费送货是在加税后计算的

> ID：13713982
> 
> 赞同：4
> 
> 时间：2012-12-04T23:44:13.460
> 
> 标签：magento

我正在尝试设置 50 美元的免费送货，但是当我添加的产品加起来达到 47.00 美元时，税收就会取消并允许免费送货。我不敢相信这是标准的，所以我必须设置错误。我在运营商 FedEx 和 USPS 下设置了免费送货。

我在 Config/Sales/Tax 中设置了“对价格应用折扣 = 不含税”，这似乎是我所追求的。我还尝试了配送方式中的免费配送方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-10T22:59:01.857

3 个步骤： **1\. 编辑 Freeshipping.php** app/code/core/Mage/Shipping/Model/Carrier/Freeshipping.php 查找**getBaseSubtotalInclTax**并更改为**getBaseSubtotal**

**2.设置购物车定价规则。** 转到促销 > 购物车定价规则 > 设置“小计等于或大于 50”。

**3\. 启用 Freeshipping Module** System > Configuration > Shipping Methods > Setup "Minimum Order Amount" = 50。

繁荣！您的免费送货计算将不含税。

如果您不想修改核心文件。将 Freeshipping.php 复制到 app/code/local/Mage/Shipping/Model/Carrier/Freeshipping.php

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T09:21:53.053

我的费率有这个配置，它可以按你的意愿工作：

**税种** 税种：运费

**计算设置：**

基于“总价”的计税方法

基于“送货地址”的税收计算

目录价格“含税”

运费“含税”

“折扣前”申请客户税

对“不含税”的价格应用折扣

对“个性化价格（如果有）”征税

**价格显示设置**

在“含税”目录中显示产品价格

显示运费“含税”

**购物车显示设置**

“含税”

“不含税”

“不含税”

“不”

“不”

“不”

**订单、发票、贷项通知单显示设置**

“含税”

“不含税”

“不含税”

“不”

“不”

“不”

**固定产品税**

“不”

“仅包括 FPT”

“仅包括 FPT”

“仅包括 FPT”

“仅包括 FPT”

“不”

“不”

“不”

这个配置对我来说很好......希望这会有所帮助！

# ssl - 一个 NFC 设备是否能够在不再次点击手机的情况下应答 P2P？

> ID：13713983
> 
> 赞同：0
> 
> 时间：2012-12-04T23:44:17.097
> 
> 标签：ssl, p2p, tap

与 NFC 进行 P2P 通信时是否可能出现以下情况：点击 Device1 到 Device2 在应用程序中推送某些内容（也安装在设备 2 上），并且 Device2 能够在应用程序内应答而无需再次点击它们？

另一个问题：P2P模式没有加密，对吧？是否可以使用应用于 P2P 的 SSL/TSL 创建某种通信？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T00:26:51.467

如果您严格谈论 android，第一个问题的答案是否定的。Android 不允许用户发送 NFC 波束，除非出于安全原因他们使用触摸发送功能，不幸的是，没有其他方法可以绕过它。

第二个问题的答案是，在没有 P2P 协议支持的情况下，您始终可以加密要封装的数据。至于一般的安全性，IETF 正在研究使用 TLS 改进 LLCP 的 LLCPS。但它仍在开发中。

# regex - 有没有更好的方法来删除 perl 中字符串数组的字符串？

> ID：13713988
> 
> 赞同：2
> 
> 时间：2012-12-04T23:44:28.580
> 
> 标签：regex, arrays, perl

我有一个 Perl 的 URL 数组，它们都包含“http://”。我想从每个字符串中删除该字符串，只留下域。我正在使用以下`for`循环：

```
#!/usr/bin/perl

### Load a test array
my @test_array = qw (http://example.com http://example.net http://example.org);

### Do the removal
for (my $i=0; $i<=$#test_array; $i++) {
    ($test_array[$i] = $test_array[$i]) =~ s{http://}{};
}

### Show the updates
print join(" ", @test_array);

### Output: 
### example.com example.net example.org 
```

它工作正常，但我想知道是否有更有效的方法（无论是在处理方面还是在减少打字方面）。有没有更好的方法从字符串数组中删除给定的字符串？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T00:00:10.527

当我解析 uris 时，我使用[URI](http://search.cpan.org/perldoc?URI)。

```
use URI qw( );
my @urls = qw( http://example.com:80/ ... );
my @hosts = map { URI->new($_)->host } @urls;
print "@hosts\n"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-04T23:49:54.150

您不需要此行中的分配：

```
($test_array[$i] = $test_array[$i]) =~ s{http://}{}; 
```

你可以使用：

```
$test_array[$i] =~ s{http://}{}; 
```

为了减少打字，利用`$_`变量：

```
for (@test_array) {
  s{http://}{};
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T23:54:51.173

我建议使用该`map`功能。它将动作应用于数组中的每个元素。您可以将 for 循环压缩为一行：

```
map s{http://}{}, @test_array; 
```

另外，作为旁注，以空格分隔的格式打印数组内容的更简单方法是将数组简单地放在双引号字符串中：

```
print "@test_array"; 
```

# javascript - JavaScript 创建元素

> ID：13713989
> 
> 赞同：1
> 
> 时间：2012-12-04T23:44:30.557
> 
> 标签：javascript

我为我的网站下载了一个 livesearch javascript 插件，它可以正常工作，但我需要帮助对其进行一些修改。

这是代码：

```
$.ajax({url: $('base').attr('href') + 'index.php?route=product/search/ajax&keyword=' + keywords, dataType: 'json', type: 'GET', success: function(result) {
    if( result.length > 0 ) {
        var eList = document.createElement( 'ul' );
        eList.id = 'livesearch_search_results';
        var eListElem;
        var eLink;
        var eHref;
        for( var i in result ) {
            eListElem = document.createElement( 'li' );
            eLink = document.createElement( 'a' );
            if( result[i].img != null ) {
                eImg = new Image();
                eImg.src = result[i].img;
            }
            else {
                eImg = document.createElement( 'span' );
                eImg.innerHTML = '&nbsp;';
            }
            eDiv = document.createElement( 'div' );
            eLink.appendChild( document.createTextNode(result[i].name) );
            if( typeof(result[i].href) != 'undefined' ) {
                eHref = result[i].href;
            }
            else {
                eHref = $('base').attr('href') + 'index.php?route=product/product&product_id=' + result[i].product_id + '&keyword=' + keywords;
            }
            eLink.href = eHref;
            eDiv.appendChild( eLink );
            eDiv.innerHTML = eDiv.innerHTML + result[i].desc;
            eListElem.appendChild( eImg );
            eListElem.appendChild( eDiv );
            eListElem.appendChild( document.createElement('br') );
            eListElem.setAttribute( 'rel', eHref );
            $(eListElem).bind('click', function(){
                var gto = $(this).attr( 'rel' );
                try {
                    if( gto != false && gto.length > 0 ) {
                        document.location = gto;
                    }
                }
                catch( e ) {}
            });
            eList.appendChild( eListElem );
        }
        if( $('#livesearch_search_results').length > 0 ) {
            $('#livesearch_search_results').remove();
        }
        $('#search_menu').append(eList);
    }
}}); 
```

输出是这样的：

```
<li rel="http://url"><img src="http://url.jpg">
<div><a href="url">TITLE</a>Description</div>
<br></li> 
```

有没有办法在标签中添加元素？像这样：

```
<li rel="http://url"> <span class="img_container"><img src="http://url.jpg"> </span>
<div><a href="url">TITLE</a>Description</div>
<br></li> 
```

我知道，我可以用 来创建一个标签`document.createElement( 'span' )`，但我不知道在这种情况下到底要去哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:06:16.927

只需替换行

```
eImg = new Image();
eImg.src = result[i].img; 
```

和

```
var eImg = document.createElement( 'span' );
eImg.className = "img_container";
var img = new Image();
img.src = result[i].img;
eImg.appendChild( img ); 
```

顺便说一句，脚本作者忘记将变量声明`eImg`为本地变量。我怀疑这是故意的。

# java - BadPaddingException：无效的密文

> ID：13713991
> 
> 赞同：0
> 
> 时间：2012-12-04T23:44:43.770
> 
> 标签：java, android, encryption, encryption-asymmetric, encryption-symmetric

我需要一些帮助，因为这是我第一次编写密码学代码。

加密代码似乎工作正常，但解密会引发错误。

我得到的错误是：

**de.flexiprovider.api.exceptions.BadPaddingException：无效密文**

在代码末尾的**解密函数中，标记为注释**

// 这里抛出错误！.........................................

我已经包括了所有的进口，请原谅这个，因为我认为它可能与这个问题有关。

对于我做错的任何帮助将不胜感激，非常感谢。

**代码：**

```
import java.io.UnsupportedEncodingException;
import java.security.KeyFactory;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.SecureRandom;
import java.security.Security;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;

import android.app.Activity;
import android.os.Bundle;
import android.util.Base64;
import android.util.Log;
import de.flexiprovider.common.ies.IESParameterSpec;
import de.flexiprovider.core.FlexiCoreProvider;
import de.flexiprovider.ec.FlexiECProvider;
import de.flexiprovider.ec.parameters.CurveParams;
import de.flexiprovider.ec.parameters.CurveRegistry.BrainpoolP384r1;
import de.flexiprovider.pki.PKCS8EncodedKeySpec;
import de.flexiprovider.pki.X509EncodedKeySpec;

public class MainActivity extends Activity {

private static PublicKey PublicKey;
private static PrivateKey PrivateKey;
private static String PubKey;
private static String PrvKey;
private static String message = "Hello World";
private static String encryptedMessage;
private static String decryptedMessage;

private final static String TAG = "ERROR: ";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    try {
        Security.addProvider(new FlexiCoreProvider());
        Security.addProvider(new FlexiECProvider());

        // instantiate the elliptic curve key pair generator
        KeyPairGenerator kpg = KeyPairGenerator.getInstance("ECIES", "FlexiEC");

        // choose the curve
        CurveParams ecParams = new BrainpoolP384r1();

        // Initialize the key pair generator
        kpg.initialize(ecParams, new SecureRandom());
        KeyPair keyPair = kpg.generateKeyPair();

        // generate the public key
        PublicKey = keyPair.getPublic();

        // generate private key
        PrivateKey = keyPair.getPrivate();
    }
    catch (Exception e) {
        Log.e(TAG, e.toString());
    }

    // I'm converting keys to strings here as the public keys will be stored on a server
    // database and the private keys will be stored in the application preferences file
    // this private key storage is maybe not optimum, but at this point I just want to
    // simulate a messaging encryption/decryption process for testing purposes

    // convert public key to a string
    PubKey = Base64.encodeToString(PublicKey.getEncoded(), Base64.DEFAULT);
    Log.d("PubKey: ", PubKey);

    // convert private key to a string
    PrvKey = Base64.encodeToString(PrivateKey.getEncoded(), Base64.DEFAULT);
    Log.d("PrvKey: ", PrvKey);

    // encrypt the message with the public key
    encryptedMessage = encryptMessage(PubKey, message);

    // report if the public key has not been regenerated correctly
    if (encryptedMessage == null) {
        Log.d("PUBLIC_KEY_REGENERATE_ERROR: ", encryptedMessage);
    }

    // decrypt the message with the private key
    decryptedMessage = decryptMessage(PrvKey, encryptedMessage);

    // report if the private key has not been regenerated correctly
    if (encryptedMessage == null) {
        Log.d("PRIVATE_KEY_REGENERATE_ERROR: ", decryptedMessage);
    }
}

// encrypt function
public static String encryptMessage(String publicKey, String message) {

    KeyFactory keyFactory = null;
    PublicKey pubkey = null;
    Cipher cipher = null;

    byte[] PLAINTEXT_MESSAGE = message.getBytes();
    Log.d("PLAINTEXT_MESSAGE: ", message);

    Security.addProvider(new FlexiCoreProvider());
    Security.addProvider(new FlexiECProvider());

    // Base64 decode the publicKey string into a byte array
    byte[] decodedPublicKey = Base64.decode(publicKey, Base64.DEFAULT);

    try {
        // instantiate a X509EncodedKeySpec
        X509EncodedKeySpec X509spec = new X509EncodedKeySpec(decodedPublicKey);

        keyFactory = KeyFactory.getInstance("ECIES", "FlexiEC");

        // re-generate the public key
        pubkey = keyFactory.generatePublic(X509spec);

        // sanity check, return null on inequality
        if (!pubkey.equals(PublicKey)) {
            return null;
        }

        cipher = Cipher.getInstance("ECIES", "FlexiEC");
        IESParameterSpec IESspec = new IESParameterSpec("AES256_CBC", "HmacSHA512", null, null);
        cipher.init(Cipher.ENCRYPT_MODE, pubkey, IESspec);
    }
    catch (Exception e) {
        Log.e(TAG, e.toString());
    }

    // encrypt the message
    byte[] encryptedData = null;

    try {
        encryptedData = cipher.doFinal(PLAINTEXT_MESSAGE);
    }
    catch (IllegalBlockSizeException e) {
        Log.e(TAG, e.toString());
    }
    catch (BadPaddingException e) {
        Log.e(TAG, e.toString());
    }

    String encryptedMessage = null;

    try {
        encryptedMessage = new String(encryptedData, "UTF-8");
    }
    catch (UnsupportedEncodingException e) {
        Log.e(TAG, e.toString());
    }
    Log.d("encryptedMessage: ", encryptedMessage);
    return encryptedMessage;
}

// decrypt function
public static String decryptMessage(String privateKey, String message) {

    KeyFactory keyFactory = null;
    PrivateKey prvkey = null;
    Cipher cipher = null;

    byte[] ENCRYPTED_MESSAGE = message.getBytes();
    Log.d("ENCRYPTED_MESSAGE: ", message);

    Security.addProvider(new FlexiCoreProvider());
    Security.addProvider(new FlexiECProvider());

    try {
        // Base64 decode the privateKey string into a byte array
        byte[] decodedPrivateKey = Base64.decode(privateKey, Base64.DEFAULT);

        // instantiate a PKCS8EncodedKeySpec
        PKCS8EncodedKeySpec PKCS8spec = new PKCS8EncodedKeySpec(decodedPrivateKey);

        keyFactory = KeyFactory.getInstance("ECIES", "FlexiEC");

        // re-generate the private key
        prvkey = keyFactory.generatePrivate(PKCS8spec);

        // sanity check, return null on inequality
        if (!prvkey.equals(PrivateKey)) {
            return null;
        }

        cipher = Cipher.getInstance("ECIES", "FlexiEC");
        IESParameterSpec IESspec = new IESParameterSpec("AES256_CBC", "HmacSHA512", null, null);
        cipher.init(Cipher.DECRYPT_MODE, prvkey, IESspec);
    }
    catch (Exception e) {
        Log.e(TAG, e.toString());
    }

    // decrypt the message
    byte[] decryptedData = null;

    try {
        decryptedData = cipher.doFinal(ENCRYPTED_MESSAGE);

        // ERROR THROWN HERE! ..............................
        // de.flexiprovider.api.exceptions.BadPaddingException: invalid ciphertext
    }
    catch (IllegalBlockSizeException e) {
        Log.e(TAG, e.toString());
    }
    catch (BadPaddingException e) {
        Log.e(TAG, e.toString());
    }

    String decryptedMessage = null;

    try {
        decryptedMessage = new String(decryptedData, "UTF-8");
    }
    catch (UnsupportedEncodingException e) {
        Log.e(TAG, e.toString());
    }
    Log.d("decryptedMessage: ", decryptedMessage);
    return decryptedMessage;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T23:53:56.263

您不能只使用密文作为`String`构造函数的输入，就像在这一行中所做的那样：

```
encryptedMessage = new String(encryptedData, "UTF-8"); 
```

*如果*您想使用字符串而不是字节来传达密文，则必须像使用密钥一样使用 Base 64 之类的编码。

加密将产生看起来像随机字节的数据。并非所有字节都具有等效字符。转换的结果取决于字符编码。UTF-8 可能使用很多字节，并且很多组合不会产生正确的字符。Java 默默地转换这些，检查`Charset`和相关的类以获取更多信息。

# objective-c - UINavigationController 推送到不同的 UIViewController

> ID：13713992
> 
> 赞同：0
> 
> 时间：2012-12-04T23:44:47.603
> 
> 标签：objective-c, ios, uinavigationcontroller

我确信有一种简单的方法可以做到这一点，我显然错过了。

我的 UINavigation 控制器中有三个类：

1.  MasterNavViewController - UINavigationController 类型 - 拥有所有后续视图控制器的属性。
2.  FirstNavViewController - UIViewController 类型。
3.  SecondNavViewController - UIViewController 类型。

由于我不想在这里讨论线程的原因，我想使用代码从 FirstNavViewController 移动到 SecondNavViewController。我试过了：

```
[self.navigationController pushViewController:SecondNavViewController animated:YES]; 
```

但我的代码中出现错误：使用未声明的标识符“SecondNavViewController”是指 MasterNavViewController 吗？

我不完全确定如何进行此操作。我曾尝试导入我的 SecondNavViewController.h，但这似乎也不起作用。

我在想也许我正试图以错误的方式做到这一点。任何指针将不胜感激！詹姆士

根据要求：我没有在代码中明确创建 SecondNavViewController，我不确定如何......但这就是我最有可能出错的地方，对吧？我已经创建了这些类，然后将它们与我拖入 IB 的 UIViewController 链接起来。通常我只会在两者之间创建一个 push segue，但在这种情况下我不想这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:11:33.163

如果您在界面构建器中创建 UIViewController 并以编程方式初始化和显示它，那么您必须使用创建类的实例`-initWithNibName:bundle:`并将其传递给`-pushViewController:animated:`而不是类名。

当您出于线程原因执行此操作时，您必须小心进行 UI 的所有更新，包括在主线程上推送新的视图控制器。这可以很容易地完成，如下所示：

```
dispatch_async(dispatch_get_main_queue(), ^(void)
{
    // update ui or push view controller etc.
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T02:02:59.357

`SecondNavViewController`不等于`secondNavViewController`。Objective-C 区分大小写。

所以你需要 SecondNavViewController 实例，如：

```
SecondNavViewController * secondNavViewController = [[SecondNavViewController alloc] ...];
[self.navigationController pushViewController:secondNavViewController animated:YES];
... 
```

# c++ - c ++：如何将双精度格式设置为带有美元符号的货币？

> ID：13713993
> 
> 赞同：3
> 
> 时间：2012-12-04T23:44:50.597
> 
> 标签：c++, string, string-formatting, currency, dollar-sign

我有一个函数，它接受一个双精度并将其作为带有千位分隔符的字符串返回。你可以在这里看到它：[c++：用逗号格式化数字？](https://stackoverflow.com/questions/7276826/c-format-number-with-commas)

```
#include <iomanip>
#include <locale>

template<class T>
std::string FormatWithCommas(T value)
{
    std::stringstream ss;
    ss.imbue(std::locale(""));
    ss << std::fixed << value;
    return ss.str();
} 
```

现在我希望能够将其格式化为带有美元符号的货币。具体来说，如果给定 20500 的两倍，我想得到一个字符串，例如“$20,500”。

在负数的情况下添加美元符号不起作用，因为我需要“-$5,000”而不是“$-5,000”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T23:48:59.867

```
if(value < 0){
   ss << "-$" << std::fixed << -value; 
} else {
   ss << "$" << std::fixed << value; 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T23:48:07.343

我认为你唯一能做的就是

```
ss << (value < 0 ? "-" : "") << "$" << std::fixed << std::abs(value); 
```

您需要使用千位分隔符打印特定的语言环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T23:49:39.743

这是我用来学习从[此处](http://arachnoid.com/cpptutor/student3.html)提取的格式化货币的示例程序。试着把这个程序分开，看看你能用什么。

```
#include <iostream>
#include <iomanip>
#include <string>

using namespace std;

void showCurrency(double dv, int width = 14)
{
    const string radix = ".";
    const string thousands = ",";
    const string unit = "$";
    unsigned long v = (unsigned long) ((dv * 100.0) + .5);
    string fmt,digit;
    int i = -2;
    do {
        if(i == 0) {
            fmt = radix + fmt;
        }
        if((i > 0) && (!(i % 3))) {
            fmt = thousands + fmt;
        }
        digit = (v % 10) + '0';
        fmt = digit + fmt;
        v /= 10;
        i++;
    }
    while((v) || (i < 1));
    cout << unit << setw(width) << fmt.c_str() << endl;
}

int main()
{
    double x = 12345678.90;
    while(x > .001) {
        showCurrency(x);
        x /= 10.0;
    }
    return 0;
} 
```

# android - ScrollView 不滚动

> ID：13713998
> 
> 赞同：1
> 
> 时间：2012-12-04T23:45:29.710
> 
> 标签：android, scrollview

我的`ScrollView`不滚动。当我删除它`weightSum`并且`layout_weight`工作正常时，或者如果我将高度设置为`scrollView`to `fixed dip`，但是我的布局全部搞砸了。

如果有人可以帮助我或给我一些其他解决方案来解决我的问题，我将不胜感激。

这是我正在使用的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/crni03_pozadina"
    android:keepScreenOn="true"
    android:orientation="vertical"
    android:padding="10dp" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="2sp"
        android:text="by Crni03"
        android:textSize="20sp"
        android:textStyle="bold" />

    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal"
                android:weightSum="100" >

                <TextView
                    android:id="@+id/tvNo"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:text="@string/tvNo"
                    android:textSize="15sp" />

                <TextView
                    android:id="@+id/tvSt"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:text="@string/tvSt"
                    android:textSize="15sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal"
                android:weightSum="100" >

                <EditText
                    android:id="@+id/etNo"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:hint="@string/tvNo"
                    android:inputType="number"
                    android:nextFocusDown="@+id/etSt"
                    android:nextFocusRight="@+id/etSt"
                    android:textSize="12sp" >

                    <requestFocus />
                </EditText>

                <EditText
                    android:id="@+id/etSt"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:hint="@string/tvSt"
                    android:inputType="number"
                    android:textSize="12sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal"
                android:weightSum="100" >

                <TextView
                    android:id="@+id/tvKu"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="29"
                    android:text="@string/tvKu"
                    android:textSize="15sp" />

                <TextView
                    android:id="@+id/tvOt"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="42"
                    android:gravity="center_horizontal"
                    android:text="@string/tvOt"
                    android:textSize="15sp" />

                <TextView
                    android:id="@+id/tvZa"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="29"
                    android:gravity="right"
                    android:text="@string/tvZa"
                    android:textSize="15sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal"
                android:weightSum="100" >

                <EditText
                    android:id="@+id/etKu"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="29"
                    android:inputType="number"
                    android:textSize="12sp" />

                <EditText
                    android:id="@+id/etOt"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="42"
                    android:gravity="center_vertical|center_horizontal"
                    android:inputType="number"
                    android:textSize="12sp" />

                <EditText
                    android:id="@+id/etZa"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="29"
                    android:gravity="right|center_vertical"
                    android:inputType="number"
                    android:textSize="12sp" />
            </LinearLayout>

            <Button
                android:id="@+id/bTotal"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/bIzracunaj" />

            <Button
                android:id="@+id/bPovratak"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/bPovratak" />

            <EditText
                android:id="@+id/etPostotak"
                android:layout_width="45dp"
                android:layout_height="wrap_content"
                android:inputType="number"
                android:text="@string/etCijena5"
                android:textSize="10sp" />
        </LinearLayout>
    </ScrollView>

</LinearLayout> 
```

# objective-c - func(160.0-90.0) 和 func((160.0-90.0)) （宏）有什么区别？

> ID：13713999
> 
> 赞同：1
> 
> 时间：2012-12-04T23:45:33.673
> 
> 标签：objective-c, cocoa

我一无所知，为什么在为宏提供参数时两个额外的大括号会产生不同的结果。

给定以下宏：

```
#define   DEGREES_TO_RADIANS(degrees)  ((M_PI * degrees)/ 180) 
```

为什么下面的代码：

```
NSLog(@"test 1: %f", DEGREES_TO_RADIANS(70.0));
NSLog(@"test 2: %f", DEGREES_TO_RADIANS(160.0-90.0));
NSLog(@"test 3: %f", DEGREES_TO_RADIANS((160.0-90.0))); 
```

有不同的结果：

```
2012-12-05 00:43:07.177 test[9267:11603] test 1: 1.221730
2012-12-05 00:43:07.179 test[9267:11603] test 2: 2.292527
2012-12-05 00:43:07.180 test[9267:11603] test 3: 1.221730 
```

测试 1 和 3 是正确的。但是为什么“测试 2”有一个*错误*的答案，打败了我。也许一位大师可以对此有所了解。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T23:53:15.130

因为`M_PI * 160.0 - 90.0`！=`M_PI * (160.0-90.0)`

这正是为什么强烈建议用括号编写宏的原因：

```
#define   DEGREES_TO_RADIANS(degrees)  ((M_PI * (degrees))/ 180) 
```