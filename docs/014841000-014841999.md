# StackOverflow 问答 14841000-14841999

# javascript - 填写表格，然后向左滑动以显示另一个与 jquery

> ID：14841009
> 
> 赞同：0
> 
> 时间：2013-02-12T20:15:56.753
> 
> 标签：javascript, jquery, jquery-animate

我有 3 个表格。我想分别展示每个。让用户填写，然后让完成的表单向左滑动，然后显示正在处理的表单。

```
$('.button-action').click(function() {
    $('.firstForm').animate({left: '-=150px'}, 500);
}); 
```

我将如何实现这一目标？

这是我尝试使用的**[小提琴。](http://jsfiddle.net/SQaSr/13/)**

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:34:40.987

我已经将 div 更改为有一个名为“wizard”的类（因为这是我看到你想要做的事情的方式）你可以随意改变它。

HTML

```
<div class="promo">
    <div class="wrapper">
        <div id="signup" class="wizard">
            <div class="heading">
                 <h1>Just need your email to get started</h1>

            </div>
            <ul>
                <li>
                    <input class="signup-email" type="text" placeholder="Email address" />
                </li>
                <li>
                    <button data-next-id="form1" validationDiv="signup" class="continue button button-action">Apply</button>
                </li>
            </ul>
        </div>
        <div id="form1" class="wizard">
             <h1>One more to go</h1>

            <input type="text" placeholder="First Name" />
            <input type="text" placeholder="Last Name" />
            <input type="text" placeholder="Country" />
            <button data-next-id="form2" validationDiv="form1" class="continue button button-action">One more</button>
        </div>
        <div id="form2" class="wizard">
             <h1>Last one</h1>

            <input type="text" class="input-text" placeholder="Company Name" />
            <button validationDiv="form2" class="button button-action">Done</button>
        </div>
    </div>
</div> 
```

jQuery

```
$(".wizard").hide();
$("#signup").show();
$(".continue").click(function () {
    var valid = true;
    $("#" + $(this).attr("validationDiv")).find("input").each(function () {
        if ($(this).val() == "") valid = false;
    });
    if (valid) {
        $(".wizard").slideUp();
        $("#" + $(this).attr("data-next-id")).slideDown();
    }
}); 
```

[JSFiddle](http://jsfiddle.net/SQaSr/14/)

# python - 使用 import inline 可能会产生负面影响吗？

> ID：14841014
> 
> 赞同：2
> 
> 时间：2013-02-12T20:16:18.963
> 
> 标签：python

我正在开发一个 Python 程序，即使缺少某些功能所需的一些库，它也需要能够运行。（编辑：我写了一些代码来实现最好的建议解决方案，它在[这里，](https://github.com/rec/echomesh/blob/master/code/python/echomesh/util/Importer.py)[这里](https://github.com/rec/echomesh/blob/master/code/python/echomesh/util/ImporterTest.py)有一个文档测试。）

我通过将此类库的导入语句内联到使用它们的函数而不是 Python 文件的顶部来解决这个问题。这意味着即使您没有库，您也可以很好地加载文件，当然，如果您尝试调用其中一个函数，您会抛出 ImportError。

这工作得非常好，以至于我发现自己有时也会为标准库模块这样做——但现在我想知道这样做是否会产生一些隐性成本？

基线代码：

```
import numpy

def foo(): 
  return numpy.array([])

def bar(): 
  return numpy.array([1, 2, 3]) 
```

内联导入的代码：

```
def foo(): 
  import numpy
  return numpy.array([])

def bar(): 
  import numpy
  return numpy.array([1, 2, 3]) 
```

编辑：

我完全同意不内联标准库代码 - 显然很糟糕。

我现在认为受保护的导入是正确的解决方案。

特别是，我对调用进行了一些时间测试，虽然时间差异对于大多数应用程序可能并不显着，但它是可观的（细线，我知道！）

在琐碎的情况下

```
import numpy
def f():
  return numpy 
```

在我的机器上重复 100,000 次大约需要 180 毫秒，但是

```
def f():
  import numpy
  return numpy 
```

大约需要 870 毫秒。

非常粗略的一点是，这会花费多达四个微不足道的函数调用——在大多数情况下很明显但并不重要。不过，如果这样做不花钱，最好避免。

在实验中，我还意识到内联导入的另一个缺点——这些导入在函数被调用时会在不可预测的时间发生。在我的具有实时元素的应用程序中，这是不可接受的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T20:19:54.607

没有明显的性能影响，但它会使您的代码混乱。如果您决定添加新的导入或必须更改旧的导入，则必须在各处进行更改，而不仅仅是在一个地方进行更改。

此外，您应该确保这已记录在案。如果库似乎正确导入但稍后在调用特定函数时失败，一些用户可能会感到恼火。此外，虽然没有整体性能受到影响，但可能会出现性能“重新洗牌”，从而导致意外地方的减速。第一次调用导入的函数时`numpy`，它必须进行导入，这需要时间。用户也可能会发现这不受欢迎，并希望预先完成所有缓慢的导入。

您可以通过 all-at-the-top 导入轻松获得类似的效果：

```
try:
    import numpy
except ImportError:
    warnings.warn("Numpy not available, some functions may not work!") 
```

稍后尝试使用尝试访问的函数`numpy`现在将失败并出现 NameError。通过使用警告（或仅打印/记录的消息），您还可以提前通知某些事情将无法正常工作，而不是稍后突然失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:21:15.183

你这样做并没有遵循 PEP 8。在标准库导入的情况下，您这样做是没有充分理由的，这是双重错误，足以让某些人回避您的代码（或者至少礼貌地唠叨您不应该这样做）。

当然，PEP 8 并不是无缘无故这么说的。在这种情况下，有一个比个人偏好和统一性更好的理由：如果将所有导入放在顶部，可以很容易地找到模块的依赖关系。如果导入分布在整个文件中，这将变得更加麻烦。此外，现在几乎每次调用您的库都可以 raise `ImportError`，这是相当不幸的：通常的工作流程是导入所有内容，如果可以导入，则假定它可以工作（这是设置 virtualenv 时有用的手动测试）。写得不太好的代码可能会开始做 I/O 之类的事情，在两者之间调用你的函数（不期望一个`ImportError`），然后对错误感到惊讶并且无法正确清理。

还有*一点*开销，因为每次调用包含导入的函数时都会执行一些额外的指令。但是，对于大多数用途而言，这种开销相当小，并且不会两次（或三次或无数次）导入模块。当然，它也违反了 DRY。

当遇到这个问题时，我和其他人无论如何都选择将导入放在文件的顶部，并用`try: ... except ImportError:`. 然后你可以分配一个虚拟值，发出警告，记录一些东西，或者做任何对你的情况有意义的事情。您甚至可以导入替换模块（例如，当支持没有某些模块的旧 Python 版本时）或您自己提供的存根模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T20:19:47.727

并不真地。

导入只会发生一次，但它可能发生在意外的时间（对于用户而言），即第一次调用执行导入的函数。

此外，这是一个可读性的问题——如果你按照约定在顶部进行导入，你的代码的每个读者都会立即知道它的依赖关系是什么。当模块的第 284 行发生导入时，这种清晰度可能会丢失......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T20:19:10.643

不，这样做应该没有缺点或隐藏成本。模块被缓存并且只执行一次，即使您多次导入它们。然后导入只是（重新）设置对模块的本地引用。

# wix - WIX MSI 软件包

> ID：14841017
> 
> 赞同：0
> 
> 时间：2013-02-12T20:16:21.443
> 
> 标签：wix

我是 WIX 新手，正在尝试为我的 Web 应用程序创建 WIX。

我已`heat.exe`作为安装程序设置项目的 PreBuild Event 运行。

```
"C:\Program Files (x86)\WiX Toolset v3.7\bin\heat.exe" dir "$(Wixdest)" -cg BUDirect -gg -scom -sreg -sfrag -srd -dr INSTALLLOCATION -var env.Wixdest -out "C:\Workspaces\Chatra\BUFragment.wxs" 
```

如上所述`BUfragment.wxs`创建，所有的参考结构都 在编译后`dll,xml,pdb`看到；`BUfragment.wxs`并且包在文件夹`CAB`中创建。`MSI``Bin\Release`

但是，当我尝试查看 Cab 与 Web 应用程序相关的文件时，或者`TARGETDIR`不是他们的文件时。

如果我错过了一些配置设置，可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T13:53:53.830

您是否已将`<ComponentGroupRef Id="BUDirect" />`BUFragment.wxs 中创建的内容添加到功能中？

只有当您引用片段中的元素之一时，片段才会包含在构建中。

# java - TomEE 上的 Java Eclipselink 给出“缺少所需的 persistence.xml”

> ID：14841022
> 
> 赞同：2
> 
> 时间：2013-02-12T20:16:39.023
> 
> 标签：java, jpa, eclipselink

我正在尝试在 TomEE 上设置 Eclipselink，但遇到了一个问题，即我收到有关丢失 persistence.xml 的错误。但是 persistence.xml 存在于 ProjectPath/META-INF/persistence.xml 中。

我正在使用 Jersey 和 Eclipselink 在 IntelliJ 上运行 Maven 项目。这是我的persistence.xml：

```
<persistence-unit name="DietMakerPostgres">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>database.DietEntity</class>
    <class>database.DietSavedEntity</class>
    <class>database.DietSentenceEntity</class>
    <class>database.UserEntity</class>
    <properties>
        <property name="eclipselink.jdbc.url" value="jdbc:postgresql://xxxxxxx:5432/dietmaker"/>
        <property name="eclipselink.jdbc.driver" value="org.postgresql.Driver"/>
        <property name="eclipselink.jdbc.user" value="postgres"/>
        <property name="eclipselink.jdbc.password" value="xxxxxxxxx"/>
    </properties>
</persistence-unit> 
```

这是我宁静的网络服务：

```
@Path("/api")
@Stateless
public class DietService {
    @PersistenceContext(unitName = "DietMakerPostgres")
    private EntityManager em;
    // The Java method will process HTTP GET requests
    @GET
    // The Java method will produce content identified by the MIME Media type "text/plain"
    @Produces("text/plain")
    public String getClichedMessage() {
        return "Hello World";
    }

} 
```

堆栈跟踪：

```
feb 12, 2013 9:08:07 PM org.apache.tomee.catalina.TomcatWebAppBuilder init
INFO: -------------------------
TomcatWebAppBuilder.init 
feb 12, 2013 9:08:07 PM org.apache.openejb.config.ConfigurationFactory configureApplication
INFO: Configuring enterprise application: C:\Users\Maikel\IdeaProjects\DieetMakerPro\out\artifacts\DieetMakerPro_war_exploded
feb 12, 2013 9:08:07 PM org.apache.openejb.config.InitEjbDeployments deploy
INFO: Auto-deploying ejb DietService: EjbDeployment(deployment-id=DietService)
feb 12, 2013 9:08:07 PM org.apache.openejb.config.OutputGeneratedDescriptors writeEjbJar
INFO: Dumping Generated ejb-jar.xml to: D:\Developer Tools\apache-tomee-plus-1.5.1\temp\ejb-jar-1529900398401626568.xml
feb 12, 2013 9:08:07 PM org.apache.openejb.config.OutputGeneratedDescriptors writeOpenejbJar
INFO: Dumping Generated openejb-jar.xml to: D:\Developer Tools\apache-tomee-plus-1.5.1\temp\openejb-jar-8207889764066155084.xml
feb 12, 2013 9:08:07 PM org.apache.openejb.config.ReportValidationResults logResults
SEVERE: FAIL ... DietService:   Missing required persistence.xml for @PersistenceContext ref "em" to unit "DietMakerPostgres"
feb 12, 2013 9:08:07 PM org.apache.openejb.config.ReportValidationResults logResults
SEVERE: Invalid EjbModule(name=, path=C:\Users\Maikel\IdeaProjects\DieetMakerPro\out\artifacts\DieetMakerPro_war_exploded)
feb 12, 2013 9:08:07 PM org.apache.openejb.config.ReportValidationResults logResults
SEVERE: FAIL ... :  Missing required persistence.xml for @PersistenceContext ref "em" to unit "DietMakerPostgres"
feb 12, 2013 9:08:07 PM org.apache.openejb.config.ReportValidationResults logResults
SEVERE: Invalid WebModule(name=, path=C:\Users\Maikel\IdeaProjects\DieetMakerPro\out\artifacts\DieetMakerPro_war_exploded)
feb 12, 2013 9:08:07 PM org.apache.openejb.config.ReportValidationResults deploy
INFO: Set the 'openejb.validation.output.level' system property to VERBOSE for increased validation details.
feb 12, 2013 9:08:07 PM org.apache.tomee.catalina.TomcatWebAppBuilder startInternal
SEVERE: Unable to deploy collapsed ear in war StandardEngine[Catalina].StandardHost[localhost].StandardContext[]
org.apache.openejb.config.ValidationFailedException: Module failed validation. AppModule(name=DieetMakerPro_war_exploded)
    at org.apache.openejb.config.ReportValidationResults.deploy(ReportValidationResults.java:82)
    at org.apache.openejb.config.AppInfoBuilder.build(AppInfoBuilder.java:293)
    at org.apache.openejb.config.ConfigurationFactory.configureApplication(ConfigurationFactory.java:830)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal(TomcatWebAppBuilder.java:974)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.configureStart(TomcatWebAppBuilder.java:901)
    at org.apache.tomee.catalina.GlobalListenerSupport.lifecycleEvent(GlobalListenerSupport.java:118)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:622)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:569)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1486)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:96)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1327)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1419)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:847)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:322)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)

feb 12, 2013 9:08:07 PM org.apache.catalina.core.ContainerBase removeChild
SEVERE: ContainerBase.removeChild: destroy: 
org.apache.catalina.LifecycleException: An invalid Lifecycle transition was attempted ([before_destroy]) for component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]] in state [STARTING_PREP]
    at org.apache.catalina.util.LifecycleBase.invalidTransition(LifecycleBase.java:409)
    at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:299)
    at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:1041)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.undeploy(TomcatWebAppBuilder.java:1167)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.undeploy(TomcatWebAppBuilder.java:1148)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal(TomcatWebAppBuilder.java:986)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.configureStart(TomcatWebAppBuilder.java:901)
    at org.apache.tomee.catalina.GlobalListenerSupport.lifecycleEvent(GlobalListenerSupport.java:118)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:622)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:569)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1486)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:96)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1327)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1419)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:847)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:322)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)

feb 12, 2013 9:08:07 PM org.apache.catalina.core.ContainerBase addChildInternal
SEVERE: ContainerBase.addChild: start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:622)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:569)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1486)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:96)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1327)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1419)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:847)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:322)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.apache.tomee.catalina.TomEERuntimeException: org.apache.openejb.config.ValidationFailedException: Module failed validation. AppModule(name=DieetMakerPro_war_exploded)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal(TomcatWebAppBuilder.java:989)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.configureStart(TomcatWebAppBuilder.java:901)
    at org.apache.tomee.catalina.GlobalListenerSupport.lifecycleEvent(GlobalListenerSupport.java:118)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 40 more
Caused by: org.apache.openejb.config.ValidationFailedException: Module failed validation. AppModule(name=DieetMakerPro_war_exploded)
    at org.apache.openejb.config.ReportValidationResults.deploy(ReportValidationResults.java:82)
    at org.apache.openejb.config.AppInfoBuilder.build(AppInfoBuilder.java:293)
    at org.apache.openejb.config.ConfigurationFactory.configureApplication(ConfigurationFactory.java:830)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal(TomcatWebAppBuilder.java:974)
    ... 46 more

feb 12, 2013 9:08:07 PM org.apache.tomcat.util.modeler.BaseModelMBean invoke
SEVERE: Exception invoking method manageApp
java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]]
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:904)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:622)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:569)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1486)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:96)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1327)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1419)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:847)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:322)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)

feb 12, 2013 9:08:07 PM org.apache.tomcat.util.modeler.BaseModelMBean invoke
SEVERE: Exception invoking method createStandardContext
javax.management.RuntimeOperationsException: Exception invoking method manageApp
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:309)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:622)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:569)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1486)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:96)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1327)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1419)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:847)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:322)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]]
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:904)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    ... 31 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T20:21:05.460

你说你正在运行一个 Maven 项目。

默认情况下，maven 不会将该奇怪的路径打包到您的应用程序中。

将 persistence.xml 放入：`ProjectPath/src/main/resources/META-INF/persistence.xml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-28T07:27:22.563

我遇到了类似的问题。有一天，生成的战争文件丢失了 persistence.xml。它以前工作过。获取旧版本的项目也没有帮助。

似乎本地 Maven 存储库中的某些内容已损坏。所以我删除了 .m2 文件夹下的存储库文件夹，并重建项目（使用 mvn install）。该工具再次下载了所有必需的存储库，问题得到解决。

希望它可以帮助面临类似情况的人。

# typescript - 将多个打字稿编译成一个闭包

> ID：14841026
> 
> 赞同：3
> 
> 时间：2013-02-12T20:16:55.423
> 
> 标签：typescript, tsc

当编译（--out）多个 *.ts 文件时，每个文件都包含一个具有相同模块标识符的类，会创建一个 *.js 文件，其中每个类都包装在自己的闭包中，并将模块的引用传递给每个闭包。

例子：

*酒吧.ts：*

```
module baz {export class Bar {}} 
```

*脚：*

```
module baz { export class Foo {}} 
```

*out.js*

```
var baz
(function(baz){ var Bar = ... })(baz);
(function(baz){ var Foo = ... })(baz); 
```

有没有办法将两个类都包含在一个文件中，以便编译器创建一个闭包来声明两个类？将所有类放在一个 *.ts 文件中似乎是一个非常糟糕的主意。

目的是：

1.  每个类使用一个 *.ts 文件
2.  在模块的所有类中使用未导出的类
3.  为模块提供一个干净的接口

我实际意思的类似 Dart 的伪代码：

*baz.ts*

```
module baz {
    part "Foo.ts";
    part "Bar.ts";
} 
```

*脚*

```
part of "baz.ts";
export class Foo {} 
```

*巴茨*

```
part of "baz.ts";
export class Bar {} 
```

谢谢阅读，

马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T10:09:43.477

在 TypeScript 中，问题的症结在于第 2 点。如果将模块拆分到多个文件中，则需要导出要对其他文件可用的类。

当然，这也意味着消费者将看到列出的所有这些类，我理解这会影响您关于为模块提供干净接口的观点。在给定约束的情况下构建模块和类的答案将根据您的个人情况而有所不同。我倾向于不将模块视为宽的命名空间，我将它们做得非常狭窄和具体，所以我会有一个`Ajax`模块，而不是一个`Communication`具有不同类的模块来表示不同的通信方式。

# database - 转换为 BCNF

> ID：14841027
> 
> 赞同：4
> 
> 时间：2013-02-12T20:17:04.383
> 
> 标签：database, relational-database, database-normalization

我得到以下关系：

```
R(A,B,C,D,E) 
```

以及以下功能依赖项：

```
F1 - AC -> D
F2 - D -> E
F3 - E -> A 
```

我正在尝试将其转换为 BCNF 形式。

我采取的第一步是找出关系的可能键。

```
Keys: ABC, BCD, BCE 
```

然后我检查了函数依赖项是否符合 BCNF 形式，它们不符合。所以我尝试分解并得到以下结果：

```
R1(A,C,D) AC->D Keys: AC
R2(D, E) D->E Keys: D 
```

我相信在这一点上，关系是 BCNF 形式并且是无损的，但不是保持依赖关系。

这似乎是这类事情的正确技术吗？我可能错过了一两步吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T20:08:11.020

我相信你的 BCNF 有错误。在 R1 和 R2 之间，你失去了 B。

密钥、ABC、BCD 和 BCE 是正确的。（您需要 B、C 和 A、D 或 E 之一）。

R1 (A, B, C, D)，密钥 ABC 和 R2 (D, E) 与密钥 D 是有效的规范化。

# bash - 将搜索字符串作为 shell 变量传递给 grep

> ID：14841032
> 
> 赞同：4
> 
> 时间：2013-02-12T20:17:22.473
> 
> 标签：bash, grep

我必须编写一个小的 bash 脚本来确定字符串是否对 bash 变量命名规则有效。我的脚本接受变量名作为参数。我正在尝试使用我的正则表达式将该参数传递给 grep 命令，但我尝试的一切，grep 都试图打开作为文件传递的值。

```
I tried placing it after the command as such
grep "$regex" "$1"

and also tried passing it as redirected input, both with and without quotes
grep "$regex" <"$1" 
```

并且两次 grep 都尝试将其作为文件打开。有没有办法将变量传递给 grep 命令？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T20:20:55.480

您的两个示例都将“$1”解释为文件名。要使用字符串，您可以使用

```
echo "$1" | grep "$regex" 
```

或特定于 bash 的“此处字符串”

```
grep "$regex" <<< "$1" 
```

你也可以在没有 grep 的情况下更快地完成它

```
[[ $1 =~ $regex ]]  # regex syntax may not be the same as grep's 
```

或者，如果您只是检查子字符串，

```
[[ $1 == *someword* ]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:21:11.197

您可以使用 bash 内置功能`=~`。像这样：

```
if [[ "$string" =~ $regex ]] ; then 
    echo "match"
else 
    echo "dont match"
fi 
```

# android - 使用堆大小很小的 StringEntity 通过 http post 方法发送大文件

> ID：14841033
> 
> 赞同：0
> 
> 时间：2013-02-12T20:17:27.250
> 
> 标签：android, http, post, out-of-memory

让我们考虑一下这种情况。你有一个小堆，大约 15-16MB，你想发送一个大文件，但没有通过 REST post 的堆大小那么大。在 Android 中，有一个完整的 API 可以执行此操作，但它要求您将数据包含在 StringEntity 中，其中最多只有两个参数。字符串是正文和字符集。假设您有一个大约 10MB 的文件。一切都很顺利，直到您将数据放入发生异常的 StringEntity 中：OutOfMemory 以及有关完整堆栈的描述。

如何在不分块数据的情况下解决此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:22:09.547

改用 a `FileEntity`。这会将数据流式传输到请求中，而不是将其加载到内存中。

# python - 有没有一种pythonic方法来获取字典内列表中的变量总数？

> ID：14841037
> 
> 赞同：2
> 
> 时间：2013-02-12T20:17:44.687
> 
> 标签：python, list, dictionary, python-2.7

我有一本字典，其中每个键都有一个项目列表（向量）：

```
from collections import defaultdict
dict = defaultdict(list)
dict[133] = [2,4,64,312]
dict[4] = [2,3,5,12,45,32]
dict[54] = [12,2,443,223]

def getTotalVectorItems(items):
  total = 0
  for v in items.values():
    total += len(v)
  return total

print getTotalVectorItems(dict) 
```

这将打印：

```
14 # number of items in the 3 dict keys. 
```

除了创建这个“getTotalVectorItems”函数之外，还有更简单的 Pythonic 方式吗？我觉得已经有一种快速的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T20:19:20.390

您正在寻找带有[生成器表达式](http://www.youtube.com/watch?v=pShL9DCSIUw)[的`sum()`内置](http://docs.python.org/3/library/functions.html#sum)函数：

```
sum(len(v) for v in items.values()) 
```

该`sum()`函数对给定迭代器的值求和，生成器表达式产生列表中每个值的长度。

请注意，调用列表向量可能会让大多数 Python 程序员感到困惑，除非您在问题领域的上下文中使用术语向量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:33:11.623

```
print sum(map(len,dic.itervalues())) 
```

# python - Optparse 和 sys.argv - Python

> ID：14841038
> 
> 赞同：3
> 
> 时间：2013-02-12T20:17:45.173
> 
> 标签：python, linux

我编写了一个 python 脚本，它通过`optparse`python 模块接受输入。我也接受输入`sys.argv`。

当我使用其中任何一个时，程序都可以正常工作。例如：

```
python dperf.py -m 1 -c 2 -n 3
python dperf.py foobar 
```

但是，当我以这种方式输入时，它不会。

```
python dperf.py foobar -m 1 -c 2 -n 3 
```

我使用的方式有错误`sys.argv`吗？

```
parser = optparse.OptionParser()
#migration
parser.add_option("-m", type="float", dest="migr")
#collection
parser.add_option("-c", type="float", dest="coll")
#num of lines to read
parser.add_option("-n", type="float", dest="fileread")
(options, args) = parser.parse_args()

ti =  options.migr
colle =  options.coll
linereadfiles =  options.fileread

apps = sys.argv[1:] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T20:23:45.943

如果您通过 的 解析选项`parse_args()`，`OptionParser`请不要`sys.argv`直接使用，而是返回`args`的应该包含 . 尚未解析的部分`OptionParser`。

例如在您的代码替换

```
 apps = sys.argv[1:] 
```

经过

```
apps = args 
```

（或者只是废弃`apps`并继续`args`）。

# rest - Sencha ExtJS RESTful 网格示例混淆

> ID：14841040
> 
> 赞同：2
> 
> 时间：2013-02-12T20:17:49.060
> 
> 标签：rest, extjs

我对 ExtJS 的 Sencha 文档感到非常困惑。该文档以入门指南开头，该指南突出并说明了为应用程序的类和源代码设计合适的结构的重要性。但是提供的示例打破了入门指南中规定的所有约定。示例不是将代码分解为适当的模型、存储、视图等类文件，而是作为单个文件提供的，示例源代码在单独的源文件中不易重用。

我从 Portal 示例 ( [http://docs.sencha.com/ext-js/4-1/#!/example/portal/portal.html](http://docs.sencha.com/ext-js/4-1/#!/example/portal/portal.html) ) 开始，因为这是我想要创建的那种应用程序。我想增强 Portal 示例并添加一个屏幕，该屏幕将显示一个网格并使用 RESTful Web 服务作为数据后端。我已经创建了我只想创建前端的后端。所以我查看了 RESTful 示例（[http://docs.sencha.com/ext-js/4-1/#!/example/restful/restful.html](http://docs.sencha.com/ext-js/4-1/#!/example/restful/restful.html)）

我试图将 RESTful 示例复制到推荐的单独类模式中，例如模型、存储、视图：

模型：

```
Ext.define('MyLodge.model.Member', {
    extend: 'Ext.data.Model',
    fields: [
        {name: 'name',       type: 'string'},
        {name: 'email',      type: 'string'},
        {name: 'href',       type: 'string'}
    ]
}); 
```

店铺：

```
Ext.require('MyLodge.model.Member');

Ext.define('MyLodge.store.Members', {
    autoLoad: true,
    autoSync: true,
    model: 'MyLodge.model.Member',
    proxy: {
        type: 'rest',
        url: 'http://localhost:8888/rest/memberapi/members' ,
        reader: {
            type: 'json',
            root: 'data'
        },
        writer: {
            type: 'json'
        }
    },
    listeners: {
        write: function(store, operation){
            var record = operation.getRecords()[0],
                name = Ext.String.capitalize(operation.action),
                verb;

            if (name == 'Destroy' ) {
                record = operation.records[0];
                verb = 'Destroyed';
            } else {
                verb = name + 'd';
            }
            Ext.example.msg(name, Ext.String.format( "{0} member: {1}", verb, record.getId()));

        }
    }
}); 
```

看法：

```
Ext.define('MyLodge.view.content.MemberGrid', {
    extend: 'Ext.grid.Panel',
    alias: 'widget.membergrid',

    initComponent: function(){

        var store = Ext.create('MyLodge.store.Members' );

        Ext.apply( this, {
            height: this.height,
            store: store,
            stripeRows: true,
            columnLines: true,
            columns: [{
                id       : 'name',
                text   : 'Name',
                flex: 1,
                sortable : true,
                dataIndex: 'name'
            },{
                text   : 'E-Mail',
                width    : 150,
                sortable : true,
                dataIndex: 'email'
            },{
                text   : 'Href',
                width    : 200,
                sortable : true,
                dataIndex: 'href'
            }],
            dockedItems: [{
                xtype: 'toolbar',
                items: [{
                    text: 'Add',
                    iconCls: 'icon-add',
                    handler: function(){
                        // empty record
                        store.insert(0, new MyLodge.model.Member());
                        rowEditing.startEdit(0, 0);
                    }
                }, '-', {
                    itemId: 'delete',
                    text: 'Delete',
                    iconCls: 'icon-delete',
                    disabled: true,
                    handler: function(){
                        var selection = grid.getView().getSelectionModel().getSelection()[0];
                        if (selection) {
                            store.remove(selection);
                        }
                    }
                }]
            }]
        });

        this.callParent(arguments);
    }
}); 
```

但我不确定将代码放在哪里来控制网格行选择并启用删除按钮：

```
grid.getSelectionModel().on('selectionchange', function(selModel, selections){
    grid.down('#delete').setDisabled(selections.length === 0);
}); 
```

此外，当我按下添加按钮时，我收到以下错误：

```
Uncaught TypeError: Object [object Object] has no method 'insert'. 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:49:38.093

您遇到范围界定问题。基本上，该变量`store`仅在 initComponent 函数中定义，因此在局部函数范围内。你的处理函数有它自己的范围。它在工具栏按钮的范围内触发。因此，如果您`this`在处理程序中说，它将指的是按钮。因此，您可以说`this.up('panel').store`- 这为您提供了对支持网格面板的商店的正确引用。

另一个建议是不要一次实施所有事情。写一点看看有没有用，然后一点一点的添加进去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T01:04:52.587

RE：文档示例，我同意这令人沮丧，但没有太多选择。对每个示例进行完全 MVC 样式的实现不仅难以生成，而且可能会使示例在结构中丢失。

RE：您关于“放置”代码以控制网格的位置的问题，我建议在 control() 部分中为网格上的事件设置一个带有侦听器的控制器。这将使您可以将网格触发的事件的处理与视图本身分离。

# c# - 仅显示列表框中的图像文件扩展名

> ID：14841042
> 
> 赞同：0
> 
> 时间：2013-02-12T20:17:56.923
> 
> 标签：c#, winforms, file, listbox, image

是否可以仅显示具有特定格式的某些文件的列表框内容？就像我想在列表框中`BMP|*.bmp|GIF|*.gif|JPG|*.jpg;*.jpeg|PNG|*.png|TIFF|*.tif;*.tiff`显示的具有这些扩展名的文件一样。`lstFiles`

我试过了，

```
lstFiles.Filter = "BMP|*.bmp|GIF|*.gif|JPG|*.jpg;*.jpeg|PNG|*.png|TIFF|*.tif;*.tiff"; 
```

但这不起作用，有可能吗？

编辑：

**我有三个联合列表框来显示系统驱动器、文件夹及其内容**

```
private void lstDrive_SelectedIndexChanged_1(object sender, EventArgs e)
        {
            lstFolders.Items.Clear();

            try
            {
                DriveInfo drive = (DriveInfo)lstDrive.SelectedItem;

                foreach (DirectoryInfo dirInfo in drive.RootDirectory.GetDirectories())
                    lstFolders.Items.Add(dirInfo);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void lstFolders_SelectedIndexChanged_1(object sender, EventArgs e)
        {
            lstFiles.Items.Clear();

            DirectoryInfo dir = (DirectoryInfo)lstFolders.SelectedItem;

            foreach (FileInfo fi in dir.GetFiles())
                lstFiles.Items.Add(fi);
        }

        private void lstFiles_SelectedIndexChanged(object sender, EventArgs e)
        {
            pictureBox1.Image = Image.FromFile(((FileInfo)lstFiles.SelectedItem).FullName);

        }

        private int lastIndex = 0;

        private void lstFiles_KeyUp(object sender, KeyEventArgs e)
        {

            if (lstFiles.SelectedIndex == lastIndex)
            {
                if (e.KeyCode == Keys.Up)
                {
                    lstFiles.SelectedIndex = lstFiles.Items.Count - 1;
                }

                if (e.KeyCode == Keys.Down)
                {
                    lstFiles.SelectedIndex = 0;
                }

            }

            lastIndex = lstFiles.SelectedIndex;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:56:52.053

您正在使用`FileInfo`对象自己填充列表框。`FileInfo`有财产[`Extension`](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.extension.aspx)。您可以使用该过滤器：

```
 private void lstFolders_SelectedIndexChanged_1(object sender, EventArgs e)
    {
        lstFiles.Items.Clear();

        DirectoryInfo dir = (DirectoryInfo)lstFolders.SelectedItem;

        foreach (FileInfo fi in dir.GetFiles())
            switch(fi.Extension.ToUpperInvariant())
            {
               case ".BMP":
               case ".JPG":
               ...
                    lstFiles.Items.Add(fi);
                    break;
             }
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:02:39.550

好的，我个人不知道，也从未听说过在列表框中使用“过滤器”。当你有列表时，为什么不直接添加你想要的项目？

```
lstFiles.Items.Clear();

List<string> allowedExtensions = new List<string>() {".jpg", ".png", ".gif"};

DirectoryInfo dir = (DirectoryInfo)lstFolders.SelectedItem;

foreach (FileInfo fi in dir.GetFiles().Where((x)=>allowedExtensions.Contains(x)))
{
    lstFiles.Items.Add(fi);
} 
```

# javascript - emberjs hasMany 返回 undefined

> ID：14841047
> 
> 赞同：1
> 
> 时间：2013-02-12T20:18:27.263
> 
> 标签：javascript, ember.js

我正在尝试使用固定装置和两个模型之间的一对多关系来实现一个最小的 emberJs 应用程序：

```
App.store = DS.Store.create({
  revision: 11,
  adapter: 'DS.FixtureAdapter'
});

App.Album = DS.Model.extend({
  Name: DS.attr("string"),
  Songs: DS.hasMany('App.Song')
});

App.Song = DS.Model.extend({
  Name: DS.attr("string"),
  Album: DS.belongsTo('App.Album')
});

App.Album.FIXTURES = [
  {
    id: 1,
    Name: 'foo'
  },
  {
    id: 2,
    Name: 'bar'
  }
];

App.Song.FIXTURES = [
  {
    id: 1,
    Album_id: 1,
    Name: "asdf"
  },
  {
    id: 2,
    Album_id: 2,
    Name: "Test"
  }
]; 
```

我可以像这样通过控制台访问专辑模型 App.Album.find(1).get('Name') # => foo

每当我尝试通过专辑和歌曲之间的关系访问 Songs 属性时，我都会得到未定义：

```
App.Album.find(1).get('Songs').objectAt(0) # undefined 
```

任何提示我在这里可能做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T22:27:18.137

你还没有定义 which `Song`s an `Album`has。您需要`Songs: [1,2,3]`在`Album`模型中指定。

*（很确定它是`Songs`，但它可能`Song_ids`。）*

# c++ - 虚函数调用

> ID：14841050
> 
> 赞同：1
> 
> 时间：2013-02-12T20:18:44.367
> 
> 标签：c++, abstract-class, multiple-inheritance, virtual-functions

## 这是我的类层次结构。

我已经声明了以下抽象接口类，它只有一个功能：

```
class IAuthenticator
{
public:
    virtual void CreateJson() = 0;
}; 
```

在我创建更多类'UIData'并从接口类继承它之后，在这种情况下：

```
class UIData : public IAuthenticator
{
protected:
    UIData() : mWindowHandle(0) 
    { /* Constructor do nothing. **/ }

private:
    integer mWindowHandle;

public:
    void CreateJson()
    {
        std::cout<<"UIData::CreateJson\n";
    }

}; 
```

我还有一个类继承自`UIData`

```
class AuthenticateIn : public UIData
{
private:
    string mOrigin;
    string mLogoURL;
    string mUserID;

public:
    void CreateJson()
    {
        std::cout<<"AuthenticateIn::CreateJson\n";
    }
}; 
```

## 问题

在我的主要功能中，我编写了这样的代码。

```
int main()
{
    AuthenticateIn* ai = new AuthenticateIn();
    ai->CreateJson();
} 
```

当我调用`CreateJson()`函数时，我看到 log `"AuthenticateIn::CreateJson"`。我想找到一种调用方法`CreateJson()`，它将为所有基类调用。

我知道我可以`this->UIData::CreateJson()`从`AuthenticateIn`类`CreateJson`函数中调用，但是有没有其他方法可以做到这一点，一些自动的方法？谢谢 ！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:21:04.833

> 有没有其他方法可以做到这一点，一些自动的方式

不，没有。您必须从派生类调用基类的实现。编译器不会自动执行此操作，因为它不知道您是否真的*想要*这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:22:21.893

您必须在派生类中调用基类函数，如下所示：

```
void CreateJson() {
    UIData::CreateJSon();
} 
```

ETC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:21:07.630

不，没有这样的方法。如果你想从基类调用虚函数，你应该直接这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T01:00:39.540

您可能无法强制调用虚拟基类，但您可以使用间接来模拟行为。

```
typedef int integer;

#include <iostream>
#include <string>

using std::string;
using std::cout;
class IAuthenticator
{
public:
    virtual void CreateJson() = 0;
};

class UIData : public IAuthenticator
{
protected:
    UIData() : mWindowHandle(0)
    { /* Constructor do nothing. **/ }

private:
    integer mWindowHandle;
    virtual void CreateJsonPrivate() = 0;

public:
    void CreateJson()
    {
        CreateJsonPrivate();
        std::cout<<"UIData::CreateJson\n";
    }

};

class AuthenticateIn : public UIData
{
private:
    string mOrigin;
    string mLogoURL;
    string mUserID;

    virtual void CreateJsonPrivate()
    {
        std::cout<<"AuthenticateIn::CreateJson\n";
    }
};

int main()
{
    AuthenticateIn* ai = new AuthenticateIn();
    ai->CreateJson();
} 
```

输出：

```
AuthenticateIn::CreateJson
UIData::CreateJson 
```

# django - django-avatar 难度覆盖模板

> ID：14841053
> 
> 赞同：0
> 
> 时间：2013-02-12T20:18:52.453
> 
> 标签：django, django-templates, http-status-code-403, django-csrf

当我转到`http://127.0.0.1:8000/avatar/change/`并单击“上传新图像”按钮时出现此错误： `Forbidden (403) CSRF verification failed. Request aborted.`

所以我去`python27/Lib/site-packages/avatar/templates/avatar/change.html`并 `{% csrf_token %}`在之后添加`<form ... POST...>`。

当我刷新浏览器并查看源代码时，我没有看到 CSRF 令牌，并且仍然会生成 403 消息。

如何修改“正确”的 django-avatar 模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:30:48.660

模板中显然存在两个`<form></form>`部分。傻我。我只添加了`{% csrf_token %}`第一个表单，我认为在 change.html 下只定义了一个表单。

# ruby-on-rails - 尝试首先让经过身份验证的用户登陆他们的个人资料页面而不是 home#index - 使用设计

> ID：14841054
> 
> 赞同：1
> 
> 时间：2013-02-12T20:18:54.307
> 
> 标签：ruby-on-rails, ruby, devise

我的思绪变慢了……这是一个简单的问题……我知道。请原谅我这里的菜鸟...

我想将经过身份验证的用户定向到该用户的个人资料页面。

注意：我正在使用设计。

注 2：您可以在此处查看整个 routes.rb 文件....pastie.org/6142383

当我做“耙路线”时，我把它作为路线信息......

```
profile GET        /profiles/:id(.:format)                       profiles#show 
```

所以在我的 routes.rb 文件中我试过这个......

```
authenticated :user do
  root :to => 'profiles#show'
end 
```

但我收到一个错误“app/controllers/profiles_controller.rb line 17”，这是……

```
@profile = Profile.find(params[:id]) 
```

所以我需要以某种方式在我的 routes.rb 中指出 params[:id] 但我对如何......

```
authenticated :user do
  root :to => '?'  # how to land user on www.website.com/profile/1
end 
```

感谢您的时间...

更新：

我正在使用 gem '更好的错误'（在这里了解这个 gem）[http://selfless-singleton.rickwinfrey.com/2012/12/13/better-errors/](http://selfless-singleton.rickwinfrey.com/2012/12/13/better-errors/)错误读取....

```
ActiveRecord::RecordNotFound at /
Couldn't find Profile without an ID

ProfileControllers#show
app/controllers/profiles_controller.rb, line 17 
```

然后告诉我确切的线......

```
12   end
13 
14   # GET /profiles/1
15   # GET /profiles/1.json
16   def show
17     @profile = Profile.find(params[:id])
18 
19     respond_to do |format|
20       format.html # show.html.erb
21       format.json { render json: @profile }
22     end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T20:43:55.643

听起来您除了其他配置文件之外还想要一个[单一资源](http://guides.rubyonrails.org/routing.html#singular-resources)。以下在设计中起作用：

```
resources :users

authenticate(:user) do
  get '/profile', to: 'users#show'
end 
```

然后在你的`users_controller.rb`：

```
def show
  if params[:id]
      @user = User.find(params[:id])
  else
    # Show the currently logged in user
    @user = current_user
  end
  ....
end 
```

要在成功登录后自定义用户登陆的位置，请在您的`ApplicationController`：

```
def after_sign_in_path_for(resource)
 current_user_path
end 
```

其他有用的指南：[https ://github.com/plataformatec/devise/wiki/_pages](https://github.com/plataformatec/devise/wiki/_pages)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T23:00:07.173

这是答案：

```
def after_sign_in_path_for(resource)
  profile_path(resource.profile)
end 
```

# javascript - 如果对其中一个成员的引用仍然存在，可以对对象进行垃圾收集吗？

> ID：14841055
> 
> 赞同：2
> 
> 时间：2013-02-12T20:18:55.270
> 
> 标签：javascript, garbage-collection

在 Javascript 中，我的理解是，当页面上不存在对它们的引用时，它们会被垃圾收集。

```
var obj = {
   arr: [1,2,3]
};
var arr = obj.arr;
obj = "hello"; 
```

在上面的代码中，我已经替换了对初始 obj 对象的引用。我不再有对该对象的任何引用。但是，我确实引用了该对象上的数组。对象是否保留直到 arr 未被引用？或者它可以被垃圾收集吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T20:21:11.583

可以收集作为“obj”值的对象，但它与作为“arr”值的对象（数组）不同。那个不会收的。

一个对象可以独立于其属性所引用的对象进行收集。

（严格来说，这一切都取决于收集器的详细信息，但由于属性值不是包含对象的一部分，如果知道有一个收集器会这样做，我会感到非常惊讶。）

# php - mysql的jquery ajax调用

> ID：14841057
> 
> 赞同：1
> 
> 时间：2013-02-12T20:18:55.677
> 
> 标签：php, javascript, jquery

我发现了很多关于这个问题的线程，但不幸的是我无法让它运行。问题是我对 JQuery 了解不多。

我正在尝试使用 JQuery 进行 Ajax 调用，以便从 mysql 数据库中获取多条记录。我有以下功能：

```
function updateWebpage () 
{
$.ajax({                                      
url: './sale/api.php',                  //the script to call to get data          
data: "",                  //you can insert url argumnets here to pass to  api.php
                                   //for example "id=5&parent=6"
  dataType: 'json',                //data format      
  success: function(rows)          //on recieve of reply
  {
        for (var i in rows)
        {
          var row = rows[i];          

          var username = row[0];
          var stateId = row[1];
          $('#output').append("<b>id: </b>"+username+"<b> stateId: </b>"+stateId)
                      .append("<hr />");
        } 
    } 
}); 
```

};

我的 api.php 正在执行一个类似这样的 mysql 查询：

```
$array = retrieveUsersInfo('%');                          //fetch result    
echo json_encode($array); 
```

我的主要问题是如何调试这样的问题？由于 ajax 正在异步调用另一个文件，因此我无法查看任何错误。从我的 Firefox 调试器中，我可以看到 $.ajax 函数已输入，但未成功。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:22:41.357

有几件事要尝试。

1.  直接在浏览器中（而不是通过 ajax）点击 api url 并确保它返回有效的响应。
2.  在您的 jquery ajax 调用中添加一个错误：function(err){}。如果服务器返回的响应不是 200 响应，则会调用此方法。
3.  我使用 Chrome 的开发者工具多于 firefox/firebug。它有一个网络选项卡，向我显示客户端和服务器之间的所有通信。您应该在该选项卡中看到对您的 api 的调用。

就在手边，我认为您需要确保在您的 php 文件中将 mime-type 设置为 text/json。

# document - XSLT 1.0 如何使用 xsl:key 和 document() 函数

> ID：14841059
> 
> 赞同：7
> 
> 时间：2013-02-12T20:18:58.903
> 
> 标签：document, xslt-1.0, xslkey

我正在尝试使用 xsl:key 使用 XSL document() 函数在外部 XML 文档中查找项目。如果我不使用 document()，而是合并两个 XML 文件（在 C# 中使用 XmlDocument），我就可以让 xsl:key 部分工作。但是，这两个 XML 文件都非常大，在某些情况下我开始出现“内存不足”错误。我还需要能够使用 xls:key，否则这个过程需要几个小时。

在 XSLT 2.0 中，我相信你可以这样做：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:variable name="lookupDoc" select="document('CodeDescriptions.xml')" />
    <xsl:key name="LookupDescriptionByCode" match="Code/@description" use="../@code" />

    <xsl:template match="ItemCode">
        <xsl:call-template name="MakeSpanForCode">
            <xsl:with-param name="code" select="text()" />
        </xsl:call-template>
    </xsl:template>

    <xsl:template name="MakeSpanForCode">
        <xsl:param name="code" />
        <xsl:element name="span">
            <xsl:attribute name="title">
                <xsl:value-of select="$lookupDoc/key('LookupDescriptionByCode', $code)" />
            </xsl:attribute>
            <xsl:value-of select="$code" />
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

但是，您如何在 XSLT 1.0 中实现这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-10-30T09:56:53.823

你有两种可能：

### 没有钥匙

```
<xsl:template name="MakeSpanForCode">
    <xsl:param name="code" />

    <xsl:element name="span">
        <xsl:attribute name="title">
            <xsl:value-of select="$lookupDoc/*/Code[@code = $code]/@description" />
        </xsl:attribute>
        <xsl:value-of select="$code" />
    </xsl:element>
</xsl:template> 
```

### 带钥匙

键定义适用于所有文档，但您需要在使用 key() 函数之前更改上下文节点：

```
<xsl:template name="MakeSpanForCode">
    <xsl:param name="code" />

    <xsl:element name="span">
        <xsl:attribute name="title">
            <!-- trick: change context node to external document -->
            <xsl:for-each select="$lookupDoc">
                <xsl:value-of select="key('LookupDescriptionByCode', $code)"/>
            </xsl:for-each>
        </xsl:attribute>
        <xsl:value-of select="$code" />
    </xsl:element>
</xsl:template> 
```

[另请参阅Mike Kay](http://oxygenxml.com/archives/xsl-list/200105/msg00546.html)和[Jeni Tennison](http://oxygenxml.com/archives/xsl-list/200101/msg00217.html)关于此主题的两个出色的邮件列表答案

# android - Android Syncadapter 不允许用户选择同步或不同步

> ID：14841064
> 
> 赞同：3
> 
> 时间：2013-02-12T20:19:13.990
> 
> 标签：android, sync, android-syncadapter

我已经阅读了有关存在的同步适配器的所有详细信息，并且我了解它是如何工作的，但是我找不到任何关于是否可以不让用户取消同步数据的信息。

例如，如果我使用同步适配器将我的应用程序的所有数据与服务器同步，显然我不希望用户能够从帐户屏幕中检查“不同步数据”，所以我想知道是否有一种方法可以将所有这些数据与同步适配器同步，要么不选择取消同步复选框，要么创建用户无法修改的隐藏同步帐户。

如果在这种情况下使用同步适配器是错误的上下文，我会欣赏一些更好的方法来实现我需要的东西或朝着正确方向前进的例子。我认为使用同步适配器**可能**是错误的，我可能必须实现自己的自定义服务，我只需要一个示例或其他东西来让我朝着正确的方向前进。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T04:55:47.533

我找到了解决方案，您可以在 xml 布局中指定一个标签

安卓：userVisible="假"

这使用户无法选择取消选中同步。尽管 2.3.3 中仍然存在一个错误，表明服务未同步，即使它正在同步。很可能是因为用户没有选择复选框。

# jquery - 如何在jquery中向动态表添加动态启用/禁用复选框？

> ID：14841070
> 
> 赞同：0
> 
> 时间：2013-02-12T20:19:39.767
> 
> 标签：jquery, forms, checkbox

我正在构建一个带有动态行的表单（我已经解决了）和我无法解决的动态启用-禁用复选框

这段代码应该像这样工作：我选择“which-cruise”，然后我可以添加一个/六个类，但我应该首先单击“your-extra-options”以启用 6 个复选框。在第一行它工作得很好但是当我添加（通过克隆）更多行时，每个“your-extra-options”复选框只处理从第一行启用/禁用 6 个复选框

**HTML**

```
<table class="reference" id="secondaryEmails" style="width: 800px;">
    <tr>
        <td>
            <select name="which-cruise">
                <option>First Cruise</option>
                <option>Second Cruise</option>
                <option>Third Cruise</option>
                <option>Fourth Cruise</option>
            </select>
        </td>
        <td>
            <input type="checkbox" name="your-extra-options" value="Your Extra Options" onclick="enableDisable(this,'extra_class','first_class','second_class','third_class','lower_class','rock-bottom_class')" />
        </td>
        <td>
            <input disabled="disabled" type="checkbox" name="extra_class" value="Extra Class" />
        </td>
        <td>
            <input disabled="disabled" type="checkbox" name="first_class" value="First Class" />
        </td>
        <td>
            <input disabled="disabled" type="checkbox" name="second_class" value="Second Class" />
        </td>
        <td>
            <input disabled="disabled" type="checkbox" name="third_class" value="Third Class" />
        </td>
        <td>
            <input disabled="disabled" type="checkbox" name="lower_class" value="Lower Class" />
        </td>
        <td>
            <input disabled="disabled" type="checkbox" name="rock-bottom_class" value="Rock-Bottom Class" />
        </td>
        <td>
            <input type="checkbox" name="breakfast" value="Breakfast" />
        </td>
        <td>
            <input type="checkbox" name="lunch" value="Lunch" />
        </td>
        <td>
            <input type="button" name="add" value="ADD" class="tr_clone_add2">
        </td>
    </tr>
</table> 
```

**脚本**

```
<script src="http://code.jquery.com/jquery-1.6.4.js"></script>
<script type="text/javascript">
    $("input.tr_clone_add").live('click', function () {
        var $tr = $(this).closest('.tr_clone');
        var $clone = $tr.clone();
        $clone.find(':text').val('');
        $tr.after($clone);
    });

    var count = $("table.reference tr").length;

    $("input.tr_clone_add2").live('click', function () {
        count++;
        var $clone = $("#secondaryEmails tbody tr:first").clone();
        $clone.attr({
            id: "emlRow_" + count,
            name: "emlRow_" + count,
            style: "" // remove "display:none"
        });
        $clone.find("input,select").each(function () {
            $(this).attr({
                id: $(this).attr("id") + count,
                name: $(this).attr("name") + count
            });
        });
        $("#secondaryEmails tbody").append($clone);
    });

    function enableDisable(oChk) {
        var disable = !oChk.checked;
        var arglen = arguments.length;
        var obj, startIndex = 1;
        var frm = oChk.form;
        for (var i = startIndex; i < arglen; i++) {
            obj = frm.elements[arguments[i]];
            if (typeof obj == "object") {
                if (document.layers) {
                    if (disable) {
                        obj.onfocus = new Function("this.blur()");
                        if (obj.type == "text") obj.onchange = new Function("this.value=this.defaultValue");
                    } else {
                        obj.onfocus = new Function("return");
                        if (obj.type == "text") obj.onchange = new Function("return");
                    }
                } else obj.disabled = disable;
            }
        }
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:00:00.507

我的解决方案依赖于 jQuery >= v1.7，但您应该能够使用已弃用的 live() 方法而不是较新的 on() 方法来做类似的事情。

基本上，我们向表本身添加了一个事件侦听器，因此动态向表中添加多少行并不重要。每次检测到单击带有“your-extra-options”类的复选框时，我们都会在该特定行中查找相关的类复选框并根据需要启用/禁用它们。就像是：

```
$(document).ready(function() {
    var table = $('#secondaryEmails');
    table.on('click', '.your-extra-options', function() {
        var checkbox = $(this);
        // Find all relevant checkboxes in the same row as the clicked "your-extra-options" checkbox
        var class_checkboxes = checkbox.closest('tr').find('.class-checkbox');
        var disable_classes = checkbox.prop('checked') ? false : true;
        class_checkboxes.prop('disabled', disable_classes);
    });
}); 
```

就您的 HTML 而言，这需要您将“your-extra-options”类添加到名为“your-extra-options”的第一行输入中，并将“class-checkbox”类添加到每个相关的复选框到预订舱位（例如头等舱、低等舱等）

您还应该从“your-extra-options”复选框中删除 onclick=""，因为它将不再使用。

示例小提琴[在这里](http://jsfiddle.net/Kw3Ru/)

# jquery - 如何获取颜色选择器值？

> ID：14841085
> 
> 赞同：0
> 
> 时间：2013-02-12T20:20:28.747
> 
> 标签：jquery, jquery-ui, color-picker

如何在红色、绿色、蓝色的颜色变化时获得输入中的颜色选择器值？
[http://jsbin.com/alefok/1/edit](http://jsbin.com/alefok/1/edit)

```
<body>
<div id="red"></div>
<div id="green"></div>
<div id="blue"></div>
<div id="swatch" class="ui-widget-content ui-corner-all"></div>
<input type="text" id="colour">
<script>
  $(".ui-slider-handle").on('change', function(){
var valA = $("#red").slider("value");
var valB = $("#green").slider("value");
var valC = $("#blue").slider("value");
$("#colour").append(valA+","+ valB+","+ valC)
})
</script>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:30:27.047

尝试如下更改您的事件绑定：[JSBin](http://jsbin.com/alefok/10/edit)

```
<script>
      $("#red, #green, #blue").on('slidestop', function(){
        var valA = $("#red").slider("value");
        var valB = $("#green").slider("value");
        var valC = $("#blue").slider("value");
        $("#colour").val(valA+","+ valB+","+ valC)
        })
    </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:31:13.663

将其设置在`refreshSwatch`将在更新时触发jQuery UI 滑块的`slide`和事件的功能上。`change``background-color`

```
function refreshSwatch(evt, ui) {
    var red = $("#red").slider("value"),
        green = $("#green").slider("option", "value"),
        blue = $("#blue").slider("value"),
        hex = hexFromRGB(red, green, blue);
    $("#swatch").css("background-color", "#" + hex);
    $("#colour").val("#" + hex);
} 
```

使用这些事件可以让您执行实时更新。您可以调整设置为文本输入的值的格式。

[看这里。](http://jsbin.com/alefok/4/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:26:48.447

您需要获取 swach 的 BG：

```
$('#red, #blue, #green').change(function(){

    $('#swatch').css('background-color');

}); 
```

# windows - cmd环境变量行为不清楚

> ID：14841086
> 
> 赞同：1
> 
> 时间：2013-02-12T20:20:31.670
> 
> 标签：windows, command-line, call, environment-variables, cmd

我对 cmd.exe 有点挣扎，所以让我把它放在代码中：

```
 :: Set an environment variable var to `pwd` 
           :: (forget about the backslashes)
C:\somedir>set var=C:\\\somedir\\\ & call echo %var%
C:\\\somedir\\\    

           :: great! works.
           :: Is the environment variable really there?
C:\somedir>set v
var=C:\\\somedir\\\    

           :: yes. ok.
           :: Traverse directory recursively, find class files ending with T, 
           :: delete `pwd` from filenames:
C:\somedir>dir /s /b *T.class | grep T\. | sed 's/%var%//g'
C:\somedir\domain\test\ClassT.class  

           :: uh oh no! Didn't work.
           :: Wait a minute. Is the environment variable really there?
C:\somedir>set v
var=C:\\\somedir\\\                 

           :: hmm...yes, indeed?
           :: ok. Take a breath. Start over. Empty/Delete var.
C:\somedir>set var=

           :: Manually fill var
C:\somedir>set var=C:\\\somedir\\\

           :: Try again...
C:\somedir>dir /s /b *T.class | grep T\. | sed 's/%var%//g'
domain\test\ClassT.class         

           ::YES! uh...oh...no...w**hy does it not work above? 
```

问题是，为什么我不能`var`在管道中使用它，尽管它在环境中可用，以及当我设置 var “手动”时发生了什么变化，而不是`set var=C:\\\somedir\\\ & call echo %var%`第一部分完全合法，完全手动，如清单后面.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:53:16.800

在这种情况下，您实际上将 var 设置为`c:\\\somedir\\\<whitespace>` Yes，cmd 设置变量并不是很聪明。

在后一个示例中，您可能一到达“\”就按回车键。可以肯定的是 - 使用（）：

```
(SET VAR=c:\\\windows\\\) & echo %VAR%
:: Test for trailing space...
echo [%VAR%] 
```

# javascript - 如何在angularjs中重定向

> ID：14841088
> 
> 赞同：2
> 
> 时间：2013-02-12T20:20:39.730
> 
> 标签：javascript, redirect, angularjs, angularjs-directive

这可能是一件微不足道的事情，但我是一个 angularjs 新手。这是我的 angularjs 控制器代码

```
 function MyCtrl1($scope, $location, $rootScope) {
  $scope.$on('$locationChangeStart', function (event, next, current) {
    event.preventDefault();
    var answer = confirm("Are you sure you want to leave this page?");
    if (answer) {

    }
  });
}
MyCtrl1.$inject = ['$scope', '$location', '$rootScope']; 
```

在`next`变量中，我有要重定向的 url，确认 OK。但是如何在 angularjs 中完成这件事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T20:22:39.093

您不必手动执行此操作。只有在他们*不*确认时才取消活动：

```
$scope.$on('$locationChangeStart', function (event, next, current) {
    if ( ! confirm("Are you sure you want to leave this page?") ) {
        event.preventDefault();
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T20:27:56.990

您可以使用其他答案中提到的纯 javascript，也可以像这样使用 Angular 提供的 $location 服务

```
 $location.path(next) 
```

或者

```
 $location.replace(next) 
```

第一个添加到您当前的路径（主要是部分路径）

第二个替换当前路径（如 google.com 到 yahoo.com）

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-02-12T20:22:39.710

`window.location = 'myURL'`

[这是 MDN 文档](https://developer.mozilla.org/en-US/docs/DOM/window.location)

# maven - 传递测试依赖和 Maven 依赖循环

> ID：14841094
> 
> 赞同：0
> 
> 时间：2013-02-12T20:21:00.293
> 
> 标签：maven, maven-dependency-plugin

我有3个模块A，B，C。A对B有编译/默认依赖，B对C有测试依赖，C对A有编译/默认依赖。

Maven 将此检测为一个循环，但只有 B 的测试（不是非测试代码）依赖于 C，而 C 和 A 都不依赖于 B 的测试。

maven 仍然将其检测为循环是否有原因？有没有办法解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:37:44.560

您可以在 api 和实现中分解您的一个项目。

您可以创建一个 B-api 项目。将 A 与 B-api 链接以进行编译。如果需要，您可以将 B 添加为运行时依赖项。那应该让你摆脱困境。

B-api 项目应提供由 B 实现的接口。您将针对接口进行编码并在运行时将其与实现连接。

# powershell - 在 PowerShell 中异步调用 System.Action 实例

> ID：14841095
> 
> 赞同：2
> 
> 时间：2013-02-12T20:21:01.123
> 
> 标签：powershell, asynchronous, lambda, begininvoke

# 背景

首先我创建一个[`System.Action`](http://msdn.microsoft.com/library/system.action.aspx)实例：

```
PS C:\Users\KnutKristian> $a = [Action]{} 
```

看看成员：

```
PS C:\Users\KnutKristian> $a | gm

   TypeName: System.Action

Name              MemberType Definition                                        
----              ---------- ----------                                        
BeginInvoke       Method     System.IAsyncResult BeginInvoke(System.AsyncCal...
Clone             Method     System.Object Clone(), System.Object ICloneable...
DynamicInvoke     Method     System.Object DynamicInvoke(Params System.Objec...
EndInvoke         Method     void EndInvoke(System.IAsyncResult result)        
Equals            Method     bool Equals(System.Object obj)                    
GetHashCode       Method     int GetHashCode()                                 
GetInvocationList Method     System.Delegate[] GetInvocationList()             
GetObjectData     Method     void GetObjectData(System.Runtime.Serialization...
GetType           Method     type GetType()                                    
Invoke            Method     void Invoke()                                     
ToString          Method     string ToString()                                 
Method            Property   System.Reflection.MethodInfo Method {get;}        
Target            Property   System.Object Target {get;} 
```

[`BeginInvoke`](http://msdn.microsoft.com/en-US/library/2e08f6yc)签名：

```
PS C:\Users\KnutKristian> $a.BeginInvoke.OverloadDefinitions
System.IAsyncResult BeginInvoke(System.AsyncCallback callback, System.Object ob
ject) 
```

当我尝试开始调用时，我收到此错误：

```
PS C:\Users\KnutKristian> $a.BeginInvoke($null, $null)
Exception calling "BeginInvoke" with "2" argument(s): "The object must be a run
time Reflection object."
At line:1 char:1
+ $a.BeginInvoke($null, $null)
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : ArgumentException 
```

指定东西没有帮助：

```
PS C:\Users\…&gt; $a.BeginInvoke([AsyncCallback]{param([IAsyncResult] $a)}, '')
Exception calling "BeginInvoke" with "2" argument(s): "The object must be a run
time Reflection object."
At line:1 char:1
+ $a.BeginInvoke([AsyncCallback]{param([IAsyncResult] $a)}, '')
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : ArgumentException 
```

一些异常信息：

```
PS C:\Users\KnutKristian> $Error[0].Exception.InnerException | gm

   TypeName: System.ArgumentException

Name             MemberType Definition                                         
----             ---------- ----------                                         
Equals           Method     bool Equals(System.Object obj), bool _Exception....
GetBaseException Method     System.Exception GetBaseException(), System.Exce...
GetHashCode      Method     int GetHashCode(), int _Exception.GetHashCode()    
GetObjectData    Method     void GetObjectData(System.Runtime.Serialization....
GetType          Method     type GetType(), type _Exception.GetType()          
ToString         Method     string ToString(), string _Exception.ToString()    
Data             Property   System.Collections.IDictionary Data {get;}         
HelpLink         Property   string HelpLink {get;set;}                         
HResult          Property   int HResult {get;}                                 
InnerException   Property   System.Exception InnerException {get;}             
Message          Property   string Message {get;}                              
ParamName        Property   string ParamName {get;}                            
Source           Property   string Source {get;set;}                           
StackTrace       Property   string StackTrace {get;}                           
TargetSite       Property   System.Reflection.MethodBase TargetSite {get;}

PS C:\Users\KnutKristian> $Error[0].Exception.InnerException |
    fl Message, ParamName, InnerException -Force

Message        : The object must be a runtime Reflection object.
ParamName      : 
InnerException : 
```

# 问题

1.  消息是什么

    > 该对象必须是运行时反射对象。

    在这种情况下是什么意思？据我所知，这里只有 .NET 对象。也许抱怨一些 PowerShell 的具体细节？

2.  如何成功运行该`BeginInvoke`方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:20:02.887

试试下面的代码。

```
[Action]{}|%{$_.BeginInvoke($null, $null)}

IsCompleted            : True
AsyncDelegate          : System.Action
AsyncState             :
CompletedSynchronously : False
EndInvokeCalled        : False
AsyncWaitHandle        : System.Threading.ManualResetEvent
NextSink               : 
```

请查看以下文章以了解 RunTimeType [http://msdn.microsoft.com/en-us/library/ms172329.aspx](http://msdn.microsoft.com/en-us/library/ms172329.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:02:17.047

要异步运行，您可以尝试`jobs`（多进程方式，效率不高），或者您可以尝试创建，如[本文](https://stackoverflow.com/a/14058804/608772)`RunspacePool`所示。

# javascript - Sencha touch 2 中的动画 Ext.Panel

> ID：14841106
> 
> 赞同：1
> 
> 时间：2013-02-12T20:21:25.693
> 
> 标签：javascript, extjs, sencha-touch, sencha-touch-2

我有这个想要滑入的视图：

```
Ext.define('GS.view.AddBidView', {
extend: 'Ext.Panel',
    config: {   
        xtype: 'panel',
        modal: true,
        width: '100%',
        height: '50%', 
        bottom: '0%',
        hideOnMaskTap: true,
        items: [{
            xtype: 'textareafield',
            name: 'bio',        
            clearIcon: false,
            id: 'textarea',
            placeHolder: 'Ange ditt bud här...'
        },
        {
            xtype:'button',
            text: 'Lägg bud',
            docked:'bottom',
            maxWidth: '95%',
            minHeight: '45px',
            cls: 'saveBidBtn'
        }]
    },
    initialize: function() {
        this.down('#textarea').on('keyup', this.grow, this);
        this.textarea = this.element.down('textarea');
        this.textarea.dom.style['overflow'] = 'hidden';
    },

    grow: function() {
        this.textarea.setHeight(this.textarea.dom.scrollHeight); // scrollHeight is height of all the content
        this.getScrollable().getScroller().scrollToEnd();
    }
}); 
```

它由此控制器呈现：

```
Ext.define('GS.controller.ShowModal', {
    extend : 'Ext.app.Controller',    
    config : {   
        control : {
            'button[action="showBidModal"]' : {
                tap : 'showModal'
            },
        }
    },
    showModal : function() {
        var addBidPanel = Ext.create('GS.view.AddBidView');
        Ext.Viewport.add(addBidPanel);
    }
}); 
```

如何通过向上/向下滑动或类似的方式设置动画？尝试了一堆东西，但似乎没有任何效果。

感谢所有帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T05:55:38.723

一种方法是默认隐藏模式：

```
hidden: true 
```

然后，您可以将[**showAnimation**](http://docs.sencha.com/touch/2-1/#!/api/Ext.Panel-cfg-showAnimation)和[**hideAnimation**](http://docs.sencha.com/touch/2-1/#!/api/Ext.Panel-cfg-hideAnimation)应用于具有指定动画的模态，例如：`show``hide`

```
showAnimation: {
    type: 'slideIn',
    duration: 1000,
    direction: 'down'
}, 

hideAnimation: {
    type: 'slideOut',
    duration: 1000,
    direction: 'up'
}, 
```

这是一个工作小提琴：[http ://www.senchafiddle.com/#6tN6b](http://www.senchafiddle.com/#6tN6b)

# jasmine - 是否可以将 Jasmine 的 toHaveBeenCalledWith 匹配器与正则表达式一起使用？

> ID：14841115
> 
> 赞同：75
> 
> 时间：2013-02-12T20:22:15.880
> 
> 标签：jasmine

我已经查看了 Jasmine 的[toHaveBeenCalledWith](http://pivotal.github.com/jasmine/jsdoc/symbols/jasmine.Matchers.html#toHaveBeenCalledWith)匹配器文档，以了解是否可以为参数传递正则表达式，如果该参数预期为字符串。不幸的是，这是不受支持的功能。[在 github](https://github.com/pivotal/jasmine/issues/243)上还存在一个请求此功能的问题。

我已经对代码库进行了一些研究，并且看到了如何在[现有的 matcher](https://github.com/pivotal/jasmine/blob/master/src/core/Matchers.js#L235)中实现它。我认为将它实现为单独的匹配器会更合适，以便单独捕获抽象。

与此同时，什么可能是一个好的解决方法？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-02-12T20:22:15.880

经过一番挖掘，我发现[Jasmine 间谍](http://jasmine.github.io/2.0/introduction.html#section-Spies)对象具有一个`calls`属性，该属性又具有[mostRecent()](http://jasmine.github.io/2.0/introduction.html#section-28)函数。这个函数还有一个子属性`args`，它返回一个调用参数数组。

因此，当人们想要检查字符串参数是否匹配特定的正则表达式时，可以使用以下序列对调用参数执行正则表达式匹配：

```
var mySpy = jasmine.createSpy('foo');
mySpy("bar", "baz");
expect(mySpy.calls.mostRecent().args[0]).toMatch(/bar/);
expect(mySpy.calls.mostRecent().args[1]).toMatch(/baz/); 
```

很简单。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2017-03-21T02:28:25.043

从 Jasmine 2.2 开始，您可以使用[`jasmine.stringMatching`](https://jasmine.github.io/2.2/introduction.html#section-String_Matching_with_%3Ccode%3Ejasmine.stringMatching%3C/code%3E)：

```
var mySpy = jasmine.createSpy('foo');
mySpy('bar', 'baz');
expect(mySpy).toHaveBeenCalledWith(
  jasmine.stringMatching(/bar/),
  jasmine.stringMatching(/baz/)
); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-06-08T05:02:28.230

在 Jasmine 2.0 中，[签名发生了一些变化](http://jasmine.github.io/2.0/introduction.html#section-28)。这将是：

```
var mySpy = jasmine.createSpy('foo');
mySpy("bar", "baz");
expect(mySpy.calls.mostRecent().args[0]).toMatch(/bar/);
expect(mySpy.calls.mostRecent().args[1]).toMatch(/baz/); 
```

[Jasmine 1.3](http://jasmine.github.io/1.3/introduction.html#section-Spies)的文档已经移动。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-02-19T07:30:32.097

或者，如果您正在监视对象上的方法：

```
spyOn(obj, 'method');
obj.method('bar', 'baz');
expect(obj.method.argsForCall[0][0]).toMatch(/bar/);
expect(obj.method.argsForCall[0][1]).toMatch(/baz/); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-09-23T10:42:15.910

有时以这种方式编写它更具可读性：

```
spyOn(obj, 'method').and.callFake(function(arg1, arg2) {
    expect(arg1).toMatch(/bar/);
    expect(arg2).toMatch(/baz/);
});
obj.method('bar', 'baz');
expect(obj.method).toHaveBeenCalled(); 
```

它提供了更清晰的方法参数可见性（而不是使用数组）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-09-24T20:38:58.600

正如 jammon 所提到的，Jasmine 2.0 签名已经改变。如果您在 Jasmine 2.0 中监视对象的方法，则应将 Nick 的解决方案更改为使用类似 -

```
spyOn(obj, 'method');
obj.method('bar', 'baz');
expect(obj.method.calls.mostRecent().args[0]).toMatch(/bar/);
expect(obj.method.calls.mostRecent().args[1]).toMatch(/baz/); 
```

# html5-video - MediaElement Uncaught TypeError：无法读取 null 的属性“tagName”

> ID：14841116
> 
> 赞同：2
> 
> 时间：2013-02-12T20:22:16.620
> 
> 标签：html5-video, mediaelement

我想使用 MediaElement 来提供我们拥有的所有视频/格式，而无需创建不同的播放器。我的第一次尝试是使用 .mwv 文件，该文件会引发本文标题中列出的错误。接下来我尝试了一个似乎可以正常工作的 MP4。然后我尝试了一个 .flv 文件，它也抛出了标题中列出的相同错误。

在 Chrome 中，我在第 40 行的 mediaelement-and-player.min.js 中看到“未捕获的 TypeError：无法读取属性 'tagName' of null”的控制台，但播放器的查看器部分根本不显示。在 Firefox 中，我在控制台中的同一行号处看到“TypeError: d is null”，但播放器的查看器部分显示：“不支持视频格式或 MIME 类型”。MediaElement 文档表明支持这些类型，但我似乎无法让它们播放。

要么我错误地配置了播放器，要么我传递了错误的内容类型（我尝试了几个），或者这是一个错误。我看到了一个类似的帖子，但是那里发布的解决方案有点含糊。我将尝试不同的文件、格式​​和 mime 类型，看看是否可以解决问题，但我认为这是一个代码问题。有没有其他人能够使用 mediaElement 播放 flv 或 wmv 文件？有没有让它发挥作用的诀窍？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T21:14:07.133

我错过了配置中的一个步骤（或指令）。“tagName”错误与我使用的内容类型有关，并且未在 Glassfish 中定义。没有播放的原因是我忘记在视频标签中将类列为“mejs-player”。

清理这两个东西让玩家开始工作。

# windows - 无法指定存储库位置

> ID：14841127
> 
> 赞同：0
> 
> 时间：2013-02-12T20:22:43.397
> 
> 标签：windows, svn, netbeans, version-control

我想将一个部分制作的项目添加到本地存储库中。

首先，我打开了 cmd.exe 并提示：

> svnadmin 创建 E:\repo\GC

然后，在 NetBeans 项目窗口中：

[项目名称]->版本控制->导入Subversion Repository

弹出一个三步向导。在 (1) 我已将路径指定为

> 文件：///E:\repo\GC

，但它给了我一个不言自明的错误：

> 无可用信息：file:///E:\repo\GC

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:35:19.683

URL 需要斜杠，而不是反斜杠。您的存储库 URL 应该是`file:///E:/repo/GC`. 在尝试提交/导入之前运行`svn info file:///E:/repo/GC`以确保它已正确设置。

# objective-c - 在自定义类上使用 -mutableCopyWithZone: 使其不可变

> ID：14841130
> 
> 赞同：1
> 
> 时间：2013-02-12T20:22:50.643
> 
> 标签：objective-c, cocoa, class, nscopying, nsmutablecopying

我创建了一个符合`NSCopying`and的自定义类`NSMutableCopying`。

`-copyWithZone:`我已经为and添加了一个实现`-mutableCopyWithZone:`，但是每当我调用`-mutableCopy`我的对象并尝试调用另一个方法时，它就会崩溃，因为一些 ivars 已经变得不可变，即使我调用`-mutableCopyWithZone:`了 ivars。

这是我复制课程的方式：

```
MyObject *flipped = [list mutableCopy];
[MyObject flip:flipped]; 
```

（代码在 上失败`+flip:`，因为它试图在ivar上使用`removeObjectAtIndex:`和）`addObject:``NSMutableArray`

这是我复制课程的方式：

```
- (id)mutableCopyWithZone:(NSZone *)zone {

    id instance = nil;

    if ((instance = [[[self class] alloc] init])) {

        [instance setArray:[self.array mutableCopyWithZone:zone]];
        [instance setObjects:[self.objects mutableCopyWithZone:zone]];

        [instance setItemCount:self.itemCount];

    }

    return instance;

} 
```

我不确定它为什么会失败，但我真的不明白为什么它不生成`array`和`objects`可变。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:42:29.693

我的最后一个想法：如果`setArray:`and`setObjects:`方法实际上是声明为的属性的设置器`@property (copy)`，那么它们将复制传入的数组 - 并`copy`始终返回一个不可变对象。在这种情况下，解决此问题的简单方法是将它们声明为`(retain)`而不是`(copy)`.

# matlab - MATLAB - 为什么 HP+LP=NOTCH？

> ID：14841133
> 
> 赞同：2
> 
> 时间：2013-02-12T20:22:53.927
> 
> 标签：matlab, signals, signal-processing

我遇到了陷波滤波器的概念问题。据我了解，陷波滤波器输出等于高通和低通滤波器输出的总和。但是，MATLAB 中的快速测试并没有显示这一点。下面是一些测试代码：

```
% Load a simple signal and specify constants
load handel; % this loads the signal, y, and its sampling rate, Fs
nData=y;
nFreq=[55 65];
nOrder=4;

% Create a lowpassed signal
[b a]=butter(nOrder,nFreq(1)/(Fs/2),'low');
nLP_Data=filter(b,a,nData);

% Create a highpassed signal
[b a]=butter(nOrder,nFreq(2)/(Fs/2),'high');
nHP_Data=filter(b,a,nData);

% Combine LP and HP signals
nCombinedHPLP=nLP_Data+nHP_Data;

% Create a notch filtered signal
[b a]=butter(nOrder/2,nFreq/(Fs/2),'stop'); % The notch filter uses twice the first input argument for its order, hence the "/2"
nN_Data=filter(b,a,nData);

% Plot each and output the total difference in the signals to the Command Window
plot(nN_Data,'r')
hold all
plot(nCombinedHPLP,'b')
legend({'Notched signal','Combined HP, LP signals'});
sum(abs(nCombinedHPLP-nN_Data)) 
```

我认为差异是由于滤波器的相位效应，因为改变`filter`为`filtfilt`产生两个相同的信号。有没有办法（使用“过滤器”）用高通和低通滤波器重新创建陷波滤波器的效果？谢谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:28:49.360

罗加雷，

您已经创建了一个陷波滤波器；正如您所怀疑的，您刚刚创建了一个相位与单个黄油过滤器不同的相位。

您的两个 BUTTER 过滤器都有自己的相位响应，并且无法保证使用这两个过滤器处理您的数据与使用手工制作的带通过滤器处理一次数据具有相同的净相位。没有规则说黄油会花费时间和精力试图让低通和高通滤波器的相位表现得像带通滤波器的相位（事实上，如果这样做会很奇怪！ )

然而，结果数据的 FFT 的 MAGNITUDE 非常吻合：

```
subplot(2,1,1); 
plot(abs(fftshift(fft(nCombinedHPLP)))); 
title('My Notch')
subplot(2,1,2); 
plot(abs(fftshift(fft(nN_Data)))); 
title('Real Notch') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:52:08.637

你确实有一个概念问题：在你问题的开头段落中你说

> 据我了解，陷波滤波器输出等于高通和低通滤波器输出的总和

如果是这种情况，那么任何通过低通或高通的信号都将通过（在低频下，低通让它通过，因此低通+高通的输出之和让低频通过。高频同上，如果你交换“低”和“高”这两个词......）。

*串联*应用与*求和输出*之间存在差异。我认为这就是您的困惑的来源。是的 - 根据过滤器的构造方式，它的陡峭程度等，当您将它们串联应用时，您将获得各种效果......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T08:00:16.823

由于陷波滤波器的阶数是 LP 或 HP 滤波器阶数的两倍，这应该表明 NF 也可以导出为 conv(LP,HP)。

The concept that you asking is that of superposition, which would presuppose equal length filters.

# php - " " 在 codeigniter 2.1.3 上不起作用

> ID：14841136
> 
> 赞同：0
> 
> 时间：2013-02-12T20:23:43.930
> 
> 标签：php

`"<?= site_url('user/profile') ?>"`不适用于codeigniter 2.1.3

问题在于

site_url 在服务器上不起作用

```
<a href="<?= site_url('user/profile') ?>"><img src="<?php echo base_url()." alt="profile"></a> 
```

如果我这样做，它会起作用

```
<a href="<?php echo site_url('user/profile') ?>"><img src="<?php echo base_url()."alt="profile"></a> 
```

在本地主机上它可以工作，在另一台服务器上

也许服务器应该在 php 上安装一些东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:27:22.040

不同之处在于服务器配置。如果你这么说

```
<a href="<?php echo site_url('user/profile') ?>"><img src="<?php echo base_url()."alt="profile"></a> 
```

有效，这意味着`short_open_tag`指令在`php.ini`文件中已关闭，因此您必须始终使用完整的标签`<?php`。

有关更多信息，请查看这个老问题。[可以使用 PHP 短标签吗？](https://stackoverflow.com/questions/200640/are-php-short-tags-acceptable-to-use)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:27:34.380

由于您声明`<?php echo`有效但`<?=`无效，因此您的目标环境的 php.ini 中似乎禁用了短标签。

请注意，[不鼓励使用短标签](http://php.net/manual/en/language.basic-syntax.phptags.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T20:25:55.783

您的服务器`php.ini`文件似乎没有启用[`short_open_tag`s](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T20:26:01.980

您必须在 php.ini 中设置为才能正常工作`short_open_tag`。`on`

# ruby - 如何从安装在 linux 上的 ruby 在 Windows 操作系统上执行控制台应用程序？

> ID：14841142
> 
> 赞同：0
> 
> 时间：2013-02-12T20:23:57.440
> 
> 标签：ruby, linux, windows, cross-platform

我正在尝试从 linux 上的 ruby​​ 脚本（比如 lin_r.rb）运行控制台应用程序（比如 win_a.exe；它的命令行参数很少）。win_a.exe 正在与 windows server 2008 上的 windows 服务交互。我想通过 lin_r.rb 在特定点运行 win_a.exe（原因是，此时；我几乎没有需要传递给 win_a.exe 的参数并得到一些结果）

![目标](../Images/b0962763522d7202dbdba7ac28efc3d5.png)

我在网上搜索，但没有得到任何有用的链接。 **我想到的一种解决方案是：**

1.  在 Windows 上创建 NFS 共享并将其映射到 linux。

2.  Linux：从 lin_r.rb 将参数/命令写入新文件（应在 NFS 共享上创建）

3.  窗口：看门狗程序（需要写这个）寻找新文件。如果找到执行带有参数的 win_a.exe 并将结果写入新的输出文件。

4.  Linux：是的！得到结果

这是好方法吗？你怎么看？

谢谢， 维普尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:40:37.550

你的方法可以工作，但是如果我实现这个，我会使用 HTTP 而不是 NFS。可能涉及的两台计算机都已经能够发出和接收 HTTP 请求，因此设置应该小于 NFS。

基本方法是让基于 linux 的脚本向 Windows 机器发出 HTTP 请求，并将 .exe 的参数指定为查询参数（如果您使用 GET 请求）。在 Windows 端，您的“看门狗”程序将是一个小型 Web 服务，它将响应来自 linux 机器的请求，使用指定的选项执行程序，并返回结果。

Windows 机器上的 Web 服务可以使用您喜欢的任何技术。我可能会使用 Sinatra+Thin，但选择取决于您。

**无论您采用哪种方法**，基于 NFS、基于 HTTP 或其他方法，您都应该**确保考虑到安全性**。这意味着您不应盲目地将您从 lin_r.rb 收到的参数传递给 win_a.exe 程序。您应该**只接受特定的参数**，并且您应该努力验证发出请求（或如果您使用 NFS，则编写文件）的**人是否是您有权**访问的人。

# html - h:commandbutton 类型之间到底有什么区别？

> ID：14841145
> 
> 赞同：1
> 
> 时间：2013-02-12T20:24:08.560
> 
> 标签：html, jsf, button

嗨，我有一个问题一直想问。我说的是不同类型的`type`标签。我读了一点，但大多数页面只有不同标签的名称，仅此而已。这种命令按钮的范围是什么`forms`，也许`tags`？`textfields`使用标签`reset`按钮后清洁哪些？特别是（如果有一些差异`HTML button`）我想知道`JavaServer Faces` `commandButton.`

我正在寻找一些高级规范或其他东西。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T02:53:43.027

（`<h:commandButton type="submit">`默认）生成 HTML生成 HTML`<input type="submit">`并生成HTML 。`<h:commandButton type="reset">``<input type="reset">``<h:commandButton type="button">``<input type="button">`

就是这样，真的。这也在[`<h:commandButton>`标签文档](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/commandButton.html)中指定。对于 HTML 表示之间的功能差异，只需查看[HTML 表单规范](http://www.w3.org/TR/html401/interact/forms.html)。请注意，这部分完全超出了 JSF 的范围。

毕竟，如果您在学习 JSF 之前学习[基本的 HTML](http://www.htmldog.com/guides/htmlbeginner/)可能会有所帮助，因为这基本上是 JSF 生成的。

# sql-server-2008 - SQL Server 2008R2 合并

> ID：14841147
> 
> 赞同：0
> 
> 时间：2013-02-12T20:24:22.887
> 
> 标签：sql-server-2008, merge

如何在没有最终表具有主键的情况下在 SQL Server 中使用合并命令合并阶段表和最终表？

我应该在合并语句中比较 ON 之后的所有列字段吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:31:58.157

`MERGE`不需要显式主键。您应该能够使用*任何*可以唯一标识行的条件来做到这一点。（这引出了一个问题——为什么你的表没有主键？）

# c# - 使函数在 Linq 函数中被调用

> ID：14841150
> 
> 赞同：4
> 
> 时间：2013-02-12T20:24:38.500
> 
> 标签：c#, .net, linq, entity-framework

我可以使用 EF 在 Linq 函数中调用函数吗？

例如

```
int GetEmployeeStatus(string empID)
{
     using (DB = new db())
     {
           var status = db.EmployeeStatus
                        .Where(e => e.EmpID == empID && e.StatusEndDate == null)
                        .Select(e => e.Status)
                        .SingleOrDefault();
           return status;
     }
} 
```

现在有没有办法以某种方式在我的应用程序中的任何地方使用上面的函数，如下所示：

```
 ....
    var empList = db.Employees
                  .Where(e => e.CostCenterID == 123 
                         && GetEmployeeStatus(e.EmpID) == 1);
    .... 
```

我不想写一遍又一遍地查找员工状态的标准，有没有办法做到这一点或概念上类似的东西？

还有一件事，我知道我编写函数的方式会导致每一行的数据库之旅，我希望有办法避免这种情况，只需将查询嵌入到 Linq 中，这样它就会被调用一次。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T20:28:39.403

您可以使用扩展功能：

```
public static class DbContextExtensions 
{
    public static IQueryable<Employee> WhereX(this IQueryable<Employee> queryable, int id)
    {
        return queryable.Where(e => e.CostCenterID == 123);
    }
} 
```

# c# - 使用相同的控件在数据网格中添加和编辑项目

> ID：14841151
> 
> 赞同：0
> 
> 时间：2013-02-12T20:24:39.947
> 
> 标签：c#, wpf, mvvm, datagrid

嘿，

我在我的 wpf 应用程序中使用 MVVM。我有显示项目列表的 DataGrid，并且我已绑定`SelectedItem`到`CurrentSequence`ViewModel 中的属性。当`CurrentSequence`该对象的更改属性显示在其他控件中进行编辑时。

这是我的xaml：

```
<DataGrid AutoGenerateColumns="False" ItemsSource="{Binding Path=ColorSettingsSequences}"
                  SelectedItem="{Binding Path=CurrentSequence, Mode=TwoWay}">
    .... more things here ...
</DataGrid>

<StackPanel Grid.Column="0" Grid.Row="0">
    <Grid>
        <Label Content="Start temperature (°C)" Height="28" HorizontalAlignment="Left" x:Name="lblSeqStartTemp" VerticalAlignment="Top" />
        <TextBox Height="23" Margin="0,28,10,0" x:Name="tbSeqStartTemp" VerticalAlignment="Top" Text="{Binding Path=CurrentSequence.StartTemp}" />
    </Grid>
    <Grid>
        <Label Content="Start color" Height="28" HorizontalAlignment="Left" x:Name="lblSeqHue" VerticalAlignment="Top" />
        <xctk:ColorPicker Margin="0,28,10,0" x:Name="clrpSeqHue" SelectedColor="{Binding Path=CurrentSequence.StartHue, Converter={StaticResource hueToColor}, ConverterParameter=False}" ShowStandardColors="False" />
    </Grid>
</StackPanel>
<StackPanel Grid.Column="1" Grid.Row="0">
    <Grid>
        <Label Content="End temperature (°C)" Height="28" HorizontalAlignment="Left" x:Name="lblSeqEndTemp" VerticalAlignment="Top" />
        <TextBox Height="23" Margin="0,28,10,0" x:Name="tbSeqEndTemp" VerticalAlignment="Top" Text="{Binding Path=CurrentSequence.EndTemp}" />
    </Grid>
    <Grid>
        <Label Content="End color" Height="28" HorizontalAlignment="Left" x:Name="lblSeqEndHue" VerticalAlignment="Top" />
        <xctk:ColorPicker Margin="0,28,10,0" x:Name="clrpSeqEndHue" SelectedColor="{Binding Path=CurrentSequence.EndHue, Converter={StaticResource hueToColor}, ConverterParameter=False}" ShowStandardColors="False" />
    </Grid>
</StackPanel> 
```

代码：

```
private ColorSettingsSequencesSequence _currentSequence;
public ColorSettingsSequencesSequence CurrentSequence
{
    get
    {
        return this._currentSequence;
    }
    set
    {
        this._currentSequence = value;
        OnPropertyChanged("CurrentSequence");
    }
} 
```

现在的问题是，我如何添加一个按钮来保存更改或添加一个全新的项目。我知道如何做一个或另一个，但是 2 与相同的控件一起呢......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:36:35.777

您可以在视图模型上创建一个名为 CurrentSequenceEdit 的 ColorSettingsSequencesSequence 类型的属性，并且您可以在更改选择时设置此对象的值。

然后单击添加按钮后，您可以创建一个新的 ColorSettingsSequencesSequence 对象并将其设置为 CurrentSequenceEdit 的值。

通常在新对象上，您将有一个未设置或设置为负数的 ID，您可以在“保存”命令中使用它来确定是否需要将其添加到网格中。

# wpf - Silverlight - 按名称查找控件（字符串）

> ID：14841153
> 
> 赞同：1
> 
> 时间：2013-02-12T20:24:48.393
> 
> 标签：wpf, silverlight, silverlight-4.0, silverlight-5.0

我搜索了一种通过字符串属性查找控件的方法：

```
private void AnimationCallback(string objectName, string value)
{

} 
```

是否可以在此动画回调方法中找到关于属性“objectName”的控件？？（例如椭圆1）

控件应该成为 value 属性的另一种颜色。控件的类型也是未知的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-23T07:50:56.633

使用必须使用任何控件的实例作为 FameworkElement 才能使用 FindName 方法。来自 MSDN 的示例：

```
private System.Windows.Controls.Grid LayoutRoot;
public Page()
{
    System.Windows.Application.LoadComponent(this, new System.Uri(
        "/SilverlightApplication1;component/Page.xaml", 
        System.UriKind.Relative));
    this.LayoutRoot = ((System.Windows.Controls.Grid)
        (this.FindName("LayoutRoot")));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:39:21.920

如果您的方法是在派生自 FrameworkElement 的类型中定义的，则[FindName](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.findname%28v=vs.95%29.aspx)方法应该执行您想要的操作。

# ruby-on-rails - 如何改进 ActiveRecord 查询

> ID：14841160
> 
> 赞同：1
> 
> 时间：2013-02-12T20:25:12.557
> 
> 标签：ruby-on-rails, ruby, rails-activerecord, worker, sidekiq

我有一个从查询返回结果的方法。然后调用该方法的代码循环遍历每个结果并启动一个 sidekiq 工作程序。我遇到的问题是循环实际上需要相当长的时间（几乎与运行所有工作人员所需的时间相同）。这是查询：

```
Object.where("last_updated > ?" , 1.days.ago.midnight ) 
```

然后我执行以下操作：

```
objects.each { |o| o.perform_async(something) } 
```

我试图弄清楚如何使这个过程更有效率。结果是完成此过程大约需要 10 分钟，每次启动实际上需要 20 毫秒（如果查询返回 30,000 个结果）。有什么办法可以让这更快吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:52:11.503

我看到您已经将 last_updated 编入索引。下一个：

```
Object.select('id, only_columns_you_need').where(...).find_each do |object|
  object.perform_async(something)
end 
```

如果“对象”表有很多列，但您只需要几个列来执行此操作，那么仅选择*这些列*可以真正加快 db 和 Ruby 领域的速度。

`find_each`默认情况下，将分批加载 1000 条记录。使用该`:batch_size`选项进行调整。

**更新**

```
def do_stuff_to_objects(&stuff)
  Object.select('id, only_columns_you_need').where(...).find_each(&stuff)
end

...

do_stuff_to_objects do |object|
  object.perform_async(something)
end 
```

# opencv - 用于从扫描文档中提取字段的图像配准算法/技术？

> ID：14841161
> 
> 赞同：7
> 
> 时间：2013-02-12T20:25:12.767
> 
> 标签：opencv, image-processing, computer-vision

![在此处输入图像描述](../Images/4a08a1313d6aedc7b4da6eac03ad57da.png) 我正在尝试确定从扫描文档中提取手写数据的最佳方法。

手写数据位于特定的加框区域。我生成了文档的数字版本，因此我知道加框区域的坐标，并且如果需要，还可以生成文档的其他变体（即，被屏蔽以使字段更易于提取的版本）

我不能只使用文档生成中的坐标提取字段的原因是在扫描过程中发生了移位/缩放/透视修改，这可以不同地推/拉每个单独框的坐标（扫描的文档确实有用于对齐的角标记，但即使如此，通常也会发生意外的转换）。

我假设有两种方法可以解决这个问题：逐步检查页面上每个框的坐标，并尝试用一些技术/算法“纠正”它们，或者将完成的表格与空白表格进行比较（蒙面？ ) 并尝试以这种方式提取正确的字段。

什么是最有效的技术/算法来调整这些修改并准确提取包含手写的区域？还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-02T01:43:48.870

有许多可能的[技术](http://www.sciencedirect.com/science/article/pii/S0262885603001379 "技术")可以为您的问题实现近 100% 的准确度。

只需按照此页面[http://www.codeproject.com/Articles/24809/Image-Alignment-Algorithms](http://www.codeproject.com/Articles/24809/Image-Alignment-Algorithms)中描述的步骤操作即可。简而言之，您首先计算两个图像之间的光流，然后估计产生这种光流的变换。

注意：当匹配的图像几乎相同时，这种方法效果最好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-24T18:33:39.743

你的第二种方法可以。更多细节：由于您已经打印了诸如“Section A”、“A6”和“other”之类的字母，并且您提到您有用于对齐的角标记，您可以将它们用作地标，执行 a`template matching`来查找坐标原始和扫描文档中的地标。然后使用这两组地标（角标记可能就足够了）生成仿射变换`M = cv2.getAffineTransform(landmarks1, landmarks2)`，应用于`cv2.warpAffine(img, M, ...)`扫描的图像，将其变换为与原始文档匹配。这样，盒子将正确对齐（可能仍有一点偏移），然后您可以正确定位每个盒子。见[https://www.geeksforgeeks.org/python-opencv-affine-transformation/](https://www.geeksforgeeks.org/python-opencv-affine-transformation/)

输入以上所有内容后，我发现这个网页用代码谈论同样的事情：[https ://learnopencv.com/feature-based-image-alignment-using-opencv-c-python/](https://learnopencv.com/feature-based-image-alignment-using-opencv-c-python/)

# .net - OutOfMemoryException 使用内存密集型项目

> ID：14841164
> 
> 赞同：1
> 
> 时间：2013-02-12T20:25:22.480
> 
> 标签：.net, clr, out-of-memory

我已经阅读了几个关于这个主题的问题/答案，但是它们让我更加困惑。这是交易：

我有一个从磁盘读取许多图像的应用程序。即使我有足够的 RAM 来读取这么多字节，我`System.OutOfMemoryException`还是在读取数据时得到了，甚至在开始处理它们之前。

这是我的阅读过程，基本上：

```
class Image
{
    float[,] pixels;
}

public static void ReadImages()
{
    List<Image> images = new List<Image>();
    for(int i=0;i<length;i++)
    {
         Image image = ReadImageFromDisk(); // Reads image from the disk.
         if ( Do I need this image? ) // Check whether to store on the memory or not
         {
              images.Add(image);
         }
    }
} 
```

我使用的原因`List<Image>`基本上是我不知道`Image`我要在内存中存储多少。我正在`Image`从磁盘读取图像，然后决定是否将该图像存储在内存中。

进行基本的内存计算：

```
= 28 (image width) x 28 (image height) x 4 (float) x 500,000 (number of images)
= 1568000000 bytes = 1.568 Gigabyte 
```

我使用的是 64 位 Windows 7，并且安装了 16 GB 的 RAM。为什么我得到`OutOfMemory`异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:37:37.697

在不确切知道 ReadImageFromDisk 函数的作用的情况下，我的第一个猜测是您可能没有正确[处理非托管资源](http://msdn.microsoft.com/en-us/library/yh598w02%28v=VS.100%29.aspx)，即访问文件系统的资源。

如果您有 500k 未处理的文件系统句柄浮动（更不用说用于将图像读入 Image 对象的内存流），则 OOM 异常的可能性很高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:39:19.237

您的目标是为 x86-64 位 CPU 构建 .NET 项目吗？

您是否进行了任何调试以找出 OOM 异常发生的确切位置。

```
Process proc = System.Diagnostics.Process.GetCurrentProcess();
List<Image> images = new List<Image>();
for(int i=0;i<length;i++)
{
    /* DEBUG */
    if((i % 1000) == 0) Console.WriteLine("Image#: " + i + " " + proc.WorkingSet64); 
```

# python - 有没有办法在 django 中同时循环两个列表？

> ID：14841165
> 
> 赞同：20
> 
> 时间：2013-02-12T20:25:23.947
> 
> 标签：python, django, django-templates, django-views

我有两个长度相同的列表对象以及我想要渲染的互补数据是否有办法同时渲染两者，即。

```
{% for i,j in table, total %} 
 {{ i }} 
 {{ j }}
{% endfor %} 
```

或类似的东西？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-12T20:44:51.370

如果两个列表的长度相同，您可以`zipped_data = zip(table, total)`在视图中作为模板上下文返回，这会生成一个 2 值元组列表。

例子：

```
>>> lst1 = ['a', 'b', 'c']
>>> lst2 = [1, 2, 3]
>>> zip(lst1, lst2)
[('a', 1), ('b', 2), ('c', 3)] 
```

在您的模板中，您可以编写：

```
{% for i, j in zipped_data %}
    {{ i }}, {{ j }}
{% endfor %} 
```

[另外，请在此处](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#for)查看 Django 关于`for`模板标签的文档。它提到了你使用它的所有可能性，包括很好的例子。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-06-13T17:04:48.370

对于此问题的任何最近访问者，[forloop.parentloop](https://docs.djangoproject.com/en/1.11/ref/templates/builtins/#for)可以模拟两个列表的压缩：

```
{% for a in list_a %}{% for b in list_b %}
    {% if forloop.counter == forloop.parentloop.counter %}
        {{a}} {{b}}
    {% endif %}
{% endfor %}{% endfor %} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-12T20:41:42.610

如果它只是变量`i`并且`j`您正在查看，那么这应该有效 -

```
return render_to_response('results.html',
    {'data': zip(table, list)})

{% for i, j in data %}
    <tr>
        <td> {{ i }}: </td> <td> {{ j }} </td>
    </tr>
{% endfor %} 
```

（感谢所有回答这个问题的人）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-12T20:44:15.680

使用 python 的 zip 函数并将 2 个列表压缩在一起。

在您看来：

```
zip(table, list) 
```

在您的模板中，您可以像简单列表一样对其进行迭代，并使用 .0 和 .1 属性分别访问表和列表中的数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T20:43:23.193

不要使用字典（不保证任何排序），而是`zip`在两个列表上使用 python 函数并将其传递给模板。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-12T20:45:12.930

您必须在视图中执行此操作 - 使用内置 zip 函数创建一个元组列表，然后在模板中对其进行迭代。

模板逻辑很简单，任何稍微复杂的事情都应该在视图中完成。

# mysql - SED 查找和替换 - MapReduce 文件

> ID：14841167
> 
> 赞同：1
> 
> 时间：2013-02-12T20:25:36.187
> 
> 标签：mysql, hadoop, mapreduce, hive

我试图用“\t”查找并替换所有“^A”字符，以便可以将数据导入 mysql 数据库。我在 OSX 上使用的命令是：

```
sed -i '' 's/^A/\t/' item_info_20130203 > item_info_20130203_tab 
```

这只是删除文件中的所有内容。我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:39:45.453

该命令实际上应该是这样的：

```
sed 's/'`echo "\001"`'/\t/g' item_info_20130203 > item_info_20130203_tab 
```

或更现代的方式

```
sed 's/'$(echo "\001")'/\t/g' item_info_20130203 > item_info_20130203_tab 
```

或影响原始文件：

```
sed -i 's/'`echo "\001"`'/\t/g' item_info_20130203 
```

如果你使用的是 GNU sed，你可以使用这个：

```
sed -i 's/\x01/\t/g' item_info_20130203 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:32:05.040

根据[这篇文章](http://www.unix.com/unix-dummies-questions-answers/161979-sed-i-option-example.html)，sed 的 -i 选项查找/替换原始文件中的文本，因此`> item_info_20120203_tab`命令末尾的语法是 NOP，因此输出文件为空。

# sas - 如何为 sas 数据集中的每个观察执行宏？

> ID：14841168
> 
> 赞同：0
> 
> 时间：2013-02-12T20:25:37.217
> 
> 标签：sas, sas-macro

这是宏代码......

```
libname myfmt "&FBRMrootPath./Formats";
%macro CreateFormat(DSN,Label,Start,fmtname,type);
options mprint mlogic symbolgen;
%If &type='n' %then %do;
    proc sort data=&DSN out=Out; by &Label;
        Run;
    Data ctrl;
        set Out(rename=(&Label=label &Start=start )) end=last;
        retain fmtname &fmtname type &type;
        output;
    If last then do;
        hlo='O';
        label='*ERROR';
        output;
    End;
Run;
%End;
%Else  %do;
    proc sort data=&DSN out=Out; by &Start;
        Run;
    Data ctrl;
        set Out(rename=(&Start=label &Label=start )) end=last;
        retain fmtname &fmtname type &type;
        output;
    If last then do;
        hlo='O';
        label='*ERROR';
        output;
    End;
Run;
%End;
proc format library=myfmt cntlin=ctrl;
Run;
%Mend CreateFormat; 
```

这是控制数据集的代码，上述宏应通过该代码对数据集的每个观察值运行，并且观察值的值是宏中变量的输入....

```
Data OPER.format_control;
Input DSN :$12\.  Label :$15\. Start :$15\. fmtName :$8\. type :$1\. fmt_Startdt :mmddyy. fmt_Enddt :mmddyy.;
format fmt_Startdt fmt_Enddt date9.;
Datalines;
ssin.prd prd_nm prd_id mealnm n . 12/31/9999
ssin.prd prd_id prd_nm mealid c . 12/31/9999
ssin.fac fac_nm onesrc_fac_id fac1SRnm n . 12/31/9999
ssin.fac fac_nm D3_fac_id facD3nm n . 12/31/9999
ssin.fac onesrc_fac_id D3_fac_id facD31SR n . 12/31/9999
oper.wrkgrp wrkgrp_nm wrkgrp_id grpnm n . 12/31/9999
; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:59:27.220

像这样的东西。

```
proc sql;
select catx(',',cats('%CreateFormat(',DSN),Label,Start,fmtname,cats(type,')');
into :formcreatelist separated by ' '
from oper.format_control;
quit; 
```

您可能需要 PUT 一些变量才能将所需的格式放入宏变量中。我在这里使用稍微笨拙的猫/catx 组合，你可以用 ',' 加多次猫一次。

您在这里确实有一个限制 - 宏变量中总共有大约 20,000 个字符。如果结束了，您要么必须使用 CALL EXECUTE（它具有一些古怪的功能），要么可以将宏调用放入文本文件并 %INCLUDE 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T20:42:56.337

有一种更好的方法可以做到这一点，而不是将 ... 选择到宏变量中。使用这样的临时文件：

```
filename dyncode temp;

data _null_;
   file dyncode;
   set OPER.format_control;
   put '%createformat ....';
run;

%include dyncode;

filename dyncode clear; 
```

此技术不受宏变量 32k 长度限制的限制。

请注意，您绝对应该在 %createformat 周围使用单引号，以防止 SAS 在数据步骤编译之前调用宏。您希望宏在 %include 运行时运行。

上述方法类似于调用execute，但调用execute 是邪恶的，因为它没有按预期顺序执行宏和宏中嵌入的data/proc 代码。避免调用执行。

最后，如果您正在运行交互式 SAS 并使用该技术，那么您可以使用一个巧妙的技巧进行调试。注释掉最后两行代码——明确的包含和文件名。运行剩余代码后，在命令窗口中输入 SAS 命令“fslist dyncode”。这将在您刚刚生成的动态代码上弹出一个记事本视图。您可以查看它并确保您得到了您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-15T00:00:38.247

这是一个调用执行解决方案，只是为了完整性：

```
data _null_;
  set OPER.format_control;
  call execute('%CreateFormat(' || DSN || ',' || Label || ',' || Start || ',' || fmtname || ',' || type || ');');
run; 
```

# assembly - JNZ & CMP 组装说明

> ID：14841169
> 
> 赞同：28
> 
> 时间：2013-02-12T20:25:43.973
> 
> 标签：assembly, x86, reverse-engineering, ollydbg, cmp

如果我错了，请纠正我。

这是我对`JNZ`和的理解`CMP`。

`JNZ``Z`- 如果标志不为零 (1) ，将发生跳转

`CMP`- 如果两个值相等，`Z`则设置标志 (1)，否则不设置 (0)

![奥利 DBG](../Images/cc898bdd444a1956bde5a5e1946ee5f1.png)

这是我正在观看的 Flash 教程。它正在教一个简单的 CrackMe 的解决方案。

如您所见，前面的指令`AL`与`47h`. 他们是平等的，树立了`Z`旗帜。（您可以在右侧的寄存器窗口中看到它）

下一条指令是`JNZ`. `Z`我的理解是，如果设置了标志，就会发生跳跃。设置了`Z`标志，但没有发生跳转！

为什么？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-12T20:40:14.483

JNZ 是“如果不为零则跳转 (ZF = 0)”的缩写，而**不是**“如果设置了 ZF 则跳转”。

如果更容易记住，请考虑 JNZ 和 JNE（如果不相等则跳转）是等价的。因此，当你在做`cmp al, 47`并且 的内容`AL`等于 47 时，ZF 已设置，因此不应进行跳转（如果 Not Equal - JNE）。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-02-12T21:26:38.593

我会在这里做一个更广泛的答案。

在 x86 中，一般来说有两种类型的条件跳转：

1.  算术跳转 - 如 JZ（如果为零则跳转）、JC（如果进位则跳转）、JNC（如果不进位则跳转）等。

2.  比较跳跃 - JE（如果相等则跳跃）、JB（如果低于则跳跃）、JAE（如果高于或相等则跳跃）等。

因此，仅在算术或逻辑指令之后使用第一种类型：

```
sub  eax, ebx
jnz  .result_is_not_zero 

and  ecx, edx
jz   .the_bit_is_not_set 
```

仅在 CMP 指令后使用第二组：

```
cmp  eax, ebx
jne  .eax_is_not_equal_to_ebx

cmp  ecx, edx
ja   .ecx_is_above_than_edx 
```

这样，程序变得更具可读性，您将永远不会感到困惑。

请注意，有时这些说明实际上是同义词。JZ == 乙脑；JC == JB; JNC == JAE 等等。完整的表格如下。如您所见，只有 16 个条件跳转指令，但有 30 个助记符 - 提供它们以允许创建更具可读性的源代码：

```
Mnemonic        Condition tested  Description  

jo              OF = 1            overflow 
jno             OF = 0            not overflow 
jc, jb, jnae    CF = 1            carry / below / not above nor equal
jnc, jae, jnb   CF = 0            not carry / above or equal / not below
je, jz          ZF = 1            equal / zero
jne, jnz        ZF = 0            not equal / not zero
jbe, jna        CF or ZF = 1      below or equal / not above
ja, jnbe        CF and ZF = 0      above / not below or equal
js              SF = 1            sign 
jns             SF = 0            not sign 
jp, jpe         PF = 1            parity / parity even 
jnp, jpo        PF = 0            not parity / parity odd 
jl, jnge        SF xor OF = 1     less / not greater nor equal
jge, jnl        SF xor OF = 0     greater or equal / not less
jle, jng    (SF xor OF) or ZF = 1 less or equal / not greater
jg, jnle    (SF xor OF) or ZF = 0 greater / not less nor equal 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T23:14:01.757

起初，JNZ 似乎意味着如果不是零 (0) 则跳转，就像在零标志为 1/set 时跳转一样。

但实际上它意味着跳转（如果）不是零（设置）。

如果 0 = 未设置且 1 = 已设置，请记住：
如果未设置零标志 (0)，则 JNZ 跳转

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-18T13:49:49.883

您可以将 JNE/Z 解读为 *

> ****如果E** **qual** / **Z** ero 标志上的状态为“未设置”，则**跳转****

 ******“未设置”**是 CPU 中的“相等/零标志”设置为 0 时的状态，仅在满足条件或相等匹配时才会发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-26T03:37:29.280

```
JNZ     Jump if Not Zero    ZF=0 
```

确实，这很令人困惑。

为了更容易理解，将**Not Zero**替换为**Not Set**。（请注意这是为了您自己的理解）

因此，

```
JNZ     Jump if Not Set     ZF=0 
```

未设置意味着标志 Z = 0。所以跳转（如果未设置则跳转）

设置意味着标志 Z = 1。所以，不要跳转****

# wso2 - 如何使用应用程序服务器功能解决 WSO2 Carbon 4.0.3 中的“未定义包”？

> ID：14841170
> 
> 赞同：8
> 
> 时间：2013-02-12T20:25:45.413
> 
> 标签：wso2, rhino, wso2carbon

我正在尝试从 WSO2 Carbon 3.0.0 升级到 Carbon 4.0.3。使用 Carbon 3.0.0，在安装了必要的特性之后，我可以编写可以调用外部 Java 库的 JavaScript Mashup 服务——而且由于 WSO2 carbon 使用 Rhino，我可以使用 importPackage。我无法在 Carbon 4.0.3 上获得相同的功能。

我遵循的程序是：

1.  下载并解压 WSO2 Carbon 4.0.3
2.  启动碳
3.  导航到“功能管理”页面
4.  添加 4.0.3 Carbon p2 存储库 ( [http://dist.wso2.org/p2/carbon/releases/4.0.3/](http://dist.wso2.org/p2/carbon/releases/4.0.3/) )
5.  搜索并安装“应用服务器”功能
6.  重启碳
7.  部署我的测试 Mashup 服务
8.  使用“tryit”工具执行我的测试 Mashup 服务的 echo 操作。

我的测试混搭服务（TestMashup.js）：

```
this.serviceName = "TestMashup";

echo.inputTypes = "#raw";
echo.outputType = "#raw";
function echo(parameter) {
    var javaDate = new Packages.java.util.Date();
    var response = "<echo><value>" + parameter.toXMLString() + "</value><timestamp>" + javaDate.getTime() + "</timestamp></echo>";

    return new XML(response);
} 
```

我已将此 Mashup 服务安装到 CARBON_HOME/repository/deployment/server/jsservices/admin/

当我在 Carbon 3.0.0 上运行此操作时，我得到以下响应：

```
<echo>
  <value>
    <r>test</r>
  </value>
  <timestamp>1360699125311</timestamp>
</echo> 
```

当我尝试在 Carbon 4.0.3 上运行此操作时，我得到以下堆栈跟踪：

```
[2013-02-12 14:46:32,511] ERROR {org.jaggeryjs.scriptengine.engine.RhinoEngine} -  org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined.(//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
[2013-02-12 14:46:32,512] ERROR {org.jaggeryjs.scriptengine.engine.RhinoEngine} -  org.jaggeryjs.scriptengine.exceptions.ScriptException: org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined. (//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
[2013-02-12 14:46:32,512] ERROR {org.apache.axis2.receivers.AbstractMessageReceiver} -  org.jaggeryjs.scriptengine.exceptions.ScriptException: org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined. (//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
org.apache.axis2.AxisFault: org.jaggeryjs.scriptengine.exceptions.ScriptException: org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined.(//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
        at org.apache.axis2.AxisFault.makeFault(AxisFault.java:430)
        at org.wso2.carbon.mashup.javascript.messagereceiver.JavaScriptEngine.call(JavaScriptEngine.java:176)
        at org.wso2.carbon.mashup.javascript.messagereceiver.JavaScriptEngine.call(JavaScriptEngine.java:208)
        at org.wso2.carbon.mashup.javascript.messagereceiver.JavaScriptReceiver.invokeBusinessLogic(JavaScriptReceiver.java:185)
        at org.apache.axis2.receivers.AbstractInOutMessageReceiver.invokeBusinessLogic(AbstractInOutMessageReceiver.java:40)
        at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
        at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
        at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
        at org.apache.axis2.transport.http.AxisServlet.doPost(AxisServlet.java:146)
        at org.wso2.carbon.core.transports.CarbonServlet.doPost(CarbonServlet.java:231)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.eclipse.equinox.http.helper.FilterServletAdaptor$FilterChainImpl.doFilter(FilterServletAdaptor.java:56)
        at org.wso2.carbon.mashup.jsservices.custom.ui.CustomUIServletFilter.doFilter(CustomUIServletFilter.java:233)
        at org.eclipse.equinox.http.helper.FilterServletAdaptor.service(FilterServletAdaptor.java:37)
        at org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:90)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:111)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:67)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.wso2.carbon.tomcat.ext.servlet.DelegationServlet.service(DelegationServlet.java:68)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.wso2.carbon.tomcat.ext.filter.CharacterSetFilter.doFilter(CharacterSetFilter.java:61)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
        at org.wso2.carbon.tomcat.ext.valves.CompositeValve.invoke(CompositeValve.java:172)
        at org.wso2.carbon.tomcat.ext.valves.CarbonStuckThreadDetectionValve.invoke(CarbonStuckThreadDetectionValve.java:156)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
        at org.wso2.carbon.tomcat.ext.valves.CarbonContextCreatorValve.invoke(CarbonContextCreatorValve.java:52)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
Caused by: org.jaggeryjs.scriptengine.exceptions.ScriptException: org.jaggeryjs.scriptengine.exceptions.ScriptException: org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined. (//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
        at org.jaggeryjs.scriptengine.engine.RhinoEngine.execFunc(RhinoEngine.java:383)
        at org.jaggeryjs.scriptengine.engine.RhinoEngine.call(RhinoEngine.java:251)
        at org.wso2.carbon.mashup.javascript.messagereceiver.JavaScriptEngine.call(JavaScriptEngine.java:169)
        ... 40 more
Caused by: org.jaggeryjs.scriptengine.exceptions.ScriptException: org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined. (//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
        at org.jaggeryjs.scriptengine.engine.RhinoEngine.execFunc(RhinoEngine.java:401)
        at org.jaggeryjs.scriptengine.engine.RhinoEngine.execFunc(RhinoEngine.java:380)
        ... 42 more
Caused by: org.mozilla.javascript.EcmaError: ReferenceError: "Packages" is not defined. (//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js#6)
        at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3557)
        at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3535)
        at org.mozilla.javascript.ScriptRuntime.notFoundError(ScriptRuntime.java:3620)
        at org.mozilla.javascript.ScriptRuntime.name(ScriptRuntime.java:1652)
        at org.jaggeryjs.rhino.c0._c1(//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js:6)
        at org.jaggeryjs.rhino.c0.call(//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js)
        at org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:401)
        at org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3003)
        at org.jaggeryjs.rhino.c0.call(//C:\WSO2CA~1\WSO2CA~1.3\bin\..\repository\deployment\server\jsservices\admin\TestMashup.js)
        at org.jaggeryjs.scriptengine.engine.RhinoEngine.execFunc(RhinoEngine.java:398)
        ... 43 more 
```

如何解决此问题，以便我可以继续使用我的 JavaScript Mashup 服务中的 Java 库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:11:34.840

允许此功能工作的代码已被禁用。

我花了一些时间查看 carbon SVN 存储库，发现`message-receiver`mashup 组件的修改方式阻止了 JavaScript Mashup 服务使用`ImporterTopLevel`上下文创建。这在 中直接可见`org.wso2.carbon.mashup.javascript.messagereceiver.JavaScriptEngine`，其中以前的版本扩展`ImporterTopLevel`但较新的版本没有。为了将来参考，此更改是针对修订版 129254 提交的。

我已经能够将`ImporterTopLevel`3.2.2 中的代码合并到 4.0.3 版本中`messagereceiver`来解决这个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-24T16:49:08.417

将所需功能安装到 Carbon 服务器时，请查看控制台中是否打印了任何错误。可能存在一些依赖性问题。安装功能后，使用命令启动 WSO2 AS，`./wso2server.sh -DosgiConsole`并使用`ss`命令和`comp`命令查看是否有任何未解决的 OSGi 依赖项。如果有，请尝试将所需的包放入 repository/components/dropins 并重新启动服务器。

而且我不确定是否仅安装应用程序服务器功能会满足您的 Mashup 要求。因此，在该存储库中查看是否有任何可用的 Mashup Server 相关功能。如果是这样，也安装它们。在您的服务器中，主机对象“Packages”似乎有一些问题。

当您由于依赖问题而无法安装某些功能时，您可以尝试将所需的捆绑包放在 dropins 目录中。如果这也失败了，您可能必须检查与该组件相关的代码并将其反向移植到您的服务器版本。

# arrays - “）此时出乎意料。”经过搜索

> ID：14841174
> 
> 赞同：-2
> 
> 时间：2013-02-12T20:25:59.903
> 
> 标签：arrays, batch-file, dos

----- 评论仅针对此“请求帮助”发布。感谢您对这个问题的考虑和帮助！

----------------- 概述 “搜索和替换”的业余且繁琐的实现 搜索输入文件“2arc!XJ!.txt”中包含的行对于各种子字符串，'XSUBSTG' 当找到包含子字符串的数组元素 !ARY[%%j]! 时，将被标记为 'void'，因此当文件在 'Point B' 处重组时，子字符串被省略。

这是我的回忆，已经为此苦苦挣扎了好几个星期，在将代码块包含在“C点”之前，所有现有代码都可以正常工作且没有错误。当添加“点 C”处的代码块时，“）此时出乎意料。发生了错误。

标签 ':TWO' 上面的唯一代码是一些用于初始化变量的 set 语句，一个带有匹配括号的 FOR /F 循环，以及一个与 'TWO' 块相同的块代码，它只是搜索不同的子串。

目前，此代码段的功能直至删除“点 A”，即此时“”是意料之外的。发生错误并停止执行。

我希望能找到解决办法。其次，如果这个论坛的读者如此感动地告诉我如何改进这段代码，以及我的整体编码能力，知识，让我提前感谢大家。非常欢迎您的帮助和建议。

由于严重缺乏知识和理解，请在任何说明、改进的同时附上简单、详细的解释。

再次感谢大家的帮助！

```
 :TWO
            echo :  ------------------ Search: Two
            set XS2=1
            set XSTG=
 :TEST2
            If !XS2! GTR !XMAX! Goto LOOP
               FOR /L %%j in (%XS2%,1,%XMAX%) do (
                  set XSTG=!ARY[%%j]!
                  set XSUBSTG=!XSTG:~22,%X10%!
                  echo : --------- 10 Begin
                  echo :     XS2=  "!XS2!"
                  echo :     XSTG= "!XSTG!"
                  echo :     XSUBSTG= "!XSUBSTG!"
               call d:\bat\sleep 1
                  If [!XSUBSTG!]==[EOF--Disk:] Goto SKIP2
                     echo : 10 Included - B
                     echo :       ary= "!XSTG!"
                     Goto END
 :SKIP2
                     echo : 10 Skipped - B
                     set ARY[!XS2!]=void
                     set XSTG=!ARY[%XS2%]!
                     echo :     ary= "!XSTG!"
 :END
                     set /a XS2+=1
               )
               echo : --- End For10 -j
               Goto TEST2

 :LOOP
 :: -----  Point 'A'
         If EXIST !XDRV!!XPTHt!2arc!XJ!.txt del !XDRV!!XPTHt!2arc!XJ!.txt> NUL
 :: -----  Point 'B'
         FOR /L %%k in (1,1,%XMAX%) do (
             if !ARY[%%k]!==[void] Goto JUMP
                echo !ARY[%%k]!>> "!XDRV!!XPTHt!2arc!XJ!.txt"
 :JUMP
         )
         set ARY
         pause

 :: -----  Point 'C' - Start of Block
         cls
         echo :
         echo :      Compostion of 2arc!XJ!.txt
         echo :
         FOR /L %%m in (1,1,%XMAX%) do (
             set ARY[%%m]=
         )
         cls
         echo :
         echo :      Array after Flush / Reset
         echo :
         set ARY
         pause
 ::  -----  End of Block

         set /A XJ+=1
         Goto FILTER 
```

无法弄清楚如何附加文件，因此此时带有“）的调试输出是意外的。此处插入错误。

```
 :  ------------------ Two
 : --------- 10 Begin
 :     XS2=  "1"
 :     XSTG= "void"
 :     XSUBSTG= ""
 : 10 Included - B
 :       ary= "void"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "2"
 :     XSTG= "    Atlanta 2960.txt                                                 2"
 :     XSUBSTG= "          "
 : 10 Included - B
 :       ary= "    Atlanta 2960.txt                                                 2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "3"
 :     XSTG= "    Boston 2961.txt                                                  2"
 :     XSUBSTG= "          "
 : 10 Included - B
 :       ary= "    Boston 2961.txt                                                  2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "4"
 :     XSTG= "    Cancun 29 62.txt                                                 2"
 :     XSUBSTG= "          "
 : 10 Included - B
 :       ary= "    Cancun 29 62.txt                                                 2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "5"
 :     XSTG= "    Denver 2963.txt                                                  2"
 :     XSUBSTG= "          "
 : 10 Included - B
 :       ary= "    Denver 2963.txt                                                  2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "6"
 :     XSTG= "    Eaton 265.txt                                                    2"
 :     XSUBSTG= "          "
 : 10 Included - B
 :       ary= "    Eaton 265.txt                                                    2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "7"
 :     XSTG= "    Glasgow 2 9 6 7.txt                                              2"
 :     XSUBSTG= "t         "
 : 10 Included - B
 :       ary= "    Glasgow 2 9 6 7.txt                                              2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "8"
 :     XSTG= "    Hartford 269.txt                                                 2"
 :     XSUBSTG= "          "
 : 10 Included - B
 :       ary= "    Hartford 269.txt                                                 2"
 : --- End For10 -j
 : --------- 10 Begin
 :     XS2=  "9"
 :     XSTG= "                      EOF--Disk:2  Sun 02/10/2013  ---               2"
 :     XSUBSTG= "EOF--Disk:"
 : 10 Skipped - B
 :     ary= "void"
 : --- End For10 -j
 ) was unexpected at this time. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:41:33.903

不要尝试在块内设置标签，它们不会按预期工作，因为它们会破坏每个循环。

如果标签后的下一行以`)`您的语法错误开头。

`:JUMP`在您的情况下，它是导致错误的标签。
但就像我说的，其余的都行不通。

# javascript - 如何在 xCharts 的图形中添加 3 行？

> ID：14841180
> 
> 赞同：2
> 
> 时间：2013-02-12T20:26:29.580
> 
> 标签：javascript

如何在[xCharts](http://tenxer.github.com/xcharts/)的图形中添加 3 行？为了制作带有 2 行的图形，我应该写：

```
var data = {
    "xScale": "time",
    "yScale": "linear",
    "type": "line",
    "main": [
        {
            "data": getStatistic(), // Some JSON data
        },
    ],
    "comp": [
        {
            "type": "line",
            "data": getStatistic(), // Some JSON data
        },
    ],
}; 
```

但是再添加一个“comp”元素是行不通的。在图书馆网站上，我没有找到超过两行的图形......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-17T15:13:41.260

答案可以在这里找到：[https ://github.com/tenXer/xcharts/issues/21](https://github.com/tenXer/xcharts/issues/21)

`main`data 和`comp`are data 都是`Array`s。他们可以采用许多不同的数据集。该[文档](http://tenxer.github.com/xcharts/docs/#data-main)可能无法很好地解释这一点......

您可以向`main`Array 提供多个数据集以完成您想要的操作。例如，这里是你可以画出比萨饼和炸玉米饼的方法：

```
{
  "main": [
    {
      "className": ".pizza",
      "data": [
        {
          "x": "2012-11-05",
          "y": 12
        },
        {
          "x": "2012-11-06",
          "y": 8
        }
      ]
    },
    {
      "className": ".tacos",
      "data": [
        {
          "x": "2012-11-05",
          "y": 8
        },
        {
          "x": "2012-11-06",
          "y": 11
        }
      ]
    }
  ]
} 
```

`main`您可以向此数组添加更多数据集。没有限制。

# latex - 在 reStructuredText 希腊字母需要“\\”，当目标是 pdf 时，其他希腊字母只有“\”

> ID：14841182
> 
> 赞同：4
> 
> 时间：2013-02-12T20:26:39.343
> 
> 标签：latex, python-sphinx, restructuredtext

我最近发现了 reST/Sphinx 并试图用它来记录我之前写过的一个 python 类。

经过一些实验后，我发现我需要在使用目标时写下`:math:`K_\\alpha``标中的希腊字母。`make latexpdf`单`\`有错误。奇怪的是，每个其他希腊字母只需要一个`\`即可产生所需的输出。

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-14T13:42:15.790

非常感谢你提出这个问题。它终于帮助我解决了我的相关问题。

对我来说，\alpha 和 \beta 都失败了。即使没有下标部分发挥作用，它们都失败了。但是，如果我使用花括号，它可以工作：

```
:math:`\alpha` 
```

不编译

```
:math:`{\alpha}` 
```

给了我想要的符号

```
:math:`{\\alpha}` 
```

给我单词'alpha'，写成相邻的数学变量a，l，p，h，a。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-27T15:21:49.067

> 怎么了？

\a 被解释为控制字符（“bell”，就像 \n “end of line”）。值得注意的是，\b（退格）也可以是一个控制字符，但由于某种原因没有被解释为这样。

请注意，另一种可能的解决方法是使用*原始字符串*( `r"""some text"""`)，如 sphinx 数学文档[2](http://sphinx-doc.org/latest/ext/math.html)中所述。

资料来源：[维基百科](http://en.wikipedia.org/wiki/Control_character)、[Sphinx 文档、“Sphinx 中的数学支持”](http://sphinx-doc.org/latest/ext/math.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-13T19:27:10.740

要获得`K`后跟`α`内联文本的下标，请使用

```
:math:`K_{\alpha}` 
```

注意花括号和反引号。它工作正常，是您根据这些参考资料所期望的：

*   [http://www.emerson.emory.edu/services/latex/latex_117.html](http://www.emerson.emory.edu/services/latex/latex_117.html)
*   [http://sphinx-doc.org/ext/math.html#role-math](http://sphinx-doc.org/ext/math.html#role-math)

在 Python 文档字符串中使用的数学标记中，您需要两个反斜杠（或使用“原始”字符串）：

```
:math:`K_{\\alpha}` 
```

* * *

编辑：我错了花括号。事实证明，这两个样本在 PDF 输出中给出了相同的结果：

```
:math:`K_{\alpha}` 
```

和

```
:math:`K_\alpha` 
```

# php - 如果 is_post 只影响 WordPress 中的所有帖子而不是页面

> ID：14841183
> 
> 赞同：0
> 
> 时间：2013-02-12T20:26:42.947
> 
> 标签：php, wordpress, post, html, if-statement

我正在使用 WordPress 3.5.1。我在每页的底部放了一张小图片，不包括一些由 is_page('') if 语句在 footer.php

有没有办法只从所有帖子中排除这张图片？

尝试 is_single 无济于事...

希望对你有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T07:39:43.577

我不确定您要完成什么。但是例如，如果您想在 post_type 页面的每个页面上放置一张图片，您可以按如下方式进行：

```
<?php if (is_page()): ?>
<img src="image_source" />
<?php endif; ?> 
```

执行 is_page('') 可能不起作用，因为它将搜索具有空标题或 slug 的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T11:00:52.703

改用 is_single 修复。

# javascript - Internet Explorer 10 - 插入空格的换行符

> ID：14841184
> 
> 赞同：0
> 
> 时间：2013-02-12T20:26:43.643
> 
> 标签：javascript, internet-explorer-10

我有一个基于 JavaScript 的页面菜单，其中菜单项是从数据库生成的。简单的菜单系统看起来像

```
function LoadMenus() {
window.fw_menu_1 = new Menu("root",165,17,"Verdana, Arial, Helvetica, sans-serif",11,"#ffffff","#000000","#597B7B","#FFF9DC","left","middle",4,0,1000,-5,7,true,true,true,5,true,true);

       fw_menu_1.addMenuItem("Menu Item 1","location='#'");

       fw_menu_1.addMenuItem("Menu Item 2","location='#'");

       fw_menu_1.addMenuItem("Menu Item 3","location='#'");

       fw_menu_1.addMenuItem("Menu Item 4","location='#'");

       fw_menu_1.addMenuItem("Menu Item 5","location='#'");

       fw_menu_1.addMenuItem("Menu&nbsp;Item&nbsp;6","location='#'");

      fw_menu_1.hideOnMouseOut=true;
} 
```

首先，在我使用之前，IE10 上根本没有显示该菜单

```
<meta http-equiv="X-UA-Compatible" content="IE=9"> 
```

但是当我能够显示菜单时，所有项目都有新的换行符而不是间隔，除了菜单项 6，我用非中断空间的标签替换了常规空间。

任何线索为什么 IE10 将所有常规空格切换到新的换行符？

谢谢

根据请求

```
function Menu(label, mw, mh, fnt, fs, fclr, fhclr, bg, bgh, halgn, valgn, pad, space, to, sx, sy, srel, opq, vert, idt, aw, ah) 
{
    this.version = "020320 [Menu; mm_menu.js]";
    this.type = "Menu";
    this.menuWidth = mw;
    this.menuItemHeight = mh;
    this.fontSize = fs;
    this.fontWeight = "plain";
    this.fontFamily = fnt;
    this.fontColor = fclr;
    this.fontColorHilite = fhclr;
    this.bgColor = "#ffffff";
    this.menuBorder = 1;
    this.menuBgOpaque=opq;
    this.menuItemBorder = 1;
    this.menuItemIndent = idt;
    this.menuItemBgColor = bg;
    this.menuItemVAlign = valgn;
    this.menuItemHAlign = halgn;
    this.menuItemPadding = pad;
    this.menuItemSpacing = space;
    this.menuLiteBgColor = "#ffffff";
    this.menuBorderBgColor = "#777777";
    this.menuHiliteBgColor = bgh;
    this.menuContainerBgColor = "#ffffff";
    this.childMenuIcon = "arrows.gif";
    this.submenuXOffset = sx;
    this.submenuYOffset = sy;
    this.submenuRelativeToItem = srel;
    this.vertical = vert;
    this.items = new Array();
    this.actions = new Array();
    this.childMenus = new Array();
    this.hideOnMouseOut = true;
    this.hideTimeout = to;
    this.addMenuItem = addMenuItem;
    this.writeMenus = writeMenus;
    this.MM_showMenu = MM_showMenu;
    this.onMenuItemOver = onMenuItemOver;
    this.onMenuItemAction = onMenuItemAction;
    this.hideMenu = hideMenu;
    this.hideChildMenu = hideChildMenu;
    if (!window.menus) window.menus = new Array();
    this.label = " " + label;
    window.menus[this.label] = this;
    window.menus[window.menus.length] = this;
    if (!window.activeMenus) window.activeMenus = new Array();
}

function addMenuItem(label, action) {
    this.items[this.items.length] = label;
    this.actions[this.actions.length] = action;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T00:20:20.793

您可能需要按照以下 Microsoft 文档中的步骤操作：http: [//msdn.microsoft.com/en-us/hh779632.aspx](http://msdn.microsoft.com/en-us/hh779632.aspx)。还可以尝试通过modern.ie 上的扫描仪运行它：[http](http://www.modern.ie/report#http%3A%2F%2Fuscib.org%20) ://www.modern.ie/report#http%3A%2F%2Fuscib.org%20这会检测到常见问题。

例如，您正在使用强制 IE10 以 IE8 模式呈现的 X-UA 兼容元标记。将内容更改为值到边缘将告诉 IE 使用可用的最新模式

然后你没有文档类型，所以它将以 quirksmode 呈现，而不是标准模式。由于脚本很旧并且有各种像 document.all 这样的非标准代码，如果你把它放在标准模式下，IE 可能会在这个和它应该使用的正确代码之间跳闸。将 HTML5 文档类型添加到页面的最顶部以尝试缓解这些问题：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:38:14.387

从您在评论中提供的链接中，您缺少 DOCTYPE。

[http://www.w3.org/QA/2002/04/valid-dtd-list.html](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

试试这个：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd"> 
```

这在您的开始标签之前。

# c++ - 重新定义断言是邪恶的吗？

> ID：14841185
> 
> 赞同：15
> 
> 时间：2013-02-12T20:26:44.350
> 
> 标签：c++, c, macros, assert

**重新定义 assert 宏是不是很邪恶？**

有些人建议使用您自己的宏 ASSERT(cond) 而不是重新定义现有的标准 assert(cond) 宏。但是，如果你有很多使用 assert() 的遗留代码，你不想对源代码进行更改，你想拦截、规范化断言报告，这将无济于事。

我已经做好了

```
 #undef assert
 #define assert(cond)  ... my own assert code ... 
```

在上述情况下 - 代码已经使用了断言，我想扩展断言失败的行为 - 当我想做类似的事情时

1) 打印额外的错误信息以使断言更有用

2) 在断言上自动调用调试器或堆栈跟踪

... this, 2)，可以通过实现 SIGABRT 信号处理程序来完成，而无需重新定义断言。

3) 将断言失败转换为抛出。

... this, 3) 不能由信号处理程序完成 - 因为您不能从信号处理程序抛出 C++ 异常。（至少不可靠。）

**为什么我要进行断言抛出？堆叠错误处理。**

我这样做通常不是因为我希望程序在断言之后继续运行（尽管见下文），而是因为我喜欢使用异常来提供更好的错误上下文。我经常这样做：

```
int main() {
  try { some_code(); }
  catch(...) { 
     std::string err = "exception caught in command foo";
     std::cerr << err;
     exit(1);;
  }
}

void some_code() { 
  try { some_other_code(); }
  catch(...) { 
     std::string err = "exception caught when trying to set up directories";
     std::cerr << err;
     throw "unhandled exception, throwing to add more context";
  }
}

void some_other_code() { 
  try { some_other2_code(); }
  catch(...) { 
     std::string err = "exception caught when trying to open log file " + logfilename;
     std::cerr << err;
     throw "unhandled exception, throwing to add more context";
  }
} 
```

等等

即异常处理程序添加了更多的错误上下文，然后重新抛出。

有时我会打印异常处理程序，例如打印到 stderr。

有时我让异常处理程序推送到一堆错误消息上。（显然，当问题内存不足时，这将不起作用。）

** 这些断言异常仍然存在 ... **

对此帖子发表评论的人@IanGoldby 说：“不退出的断言的想法对我来说没有任何意义。”

以免我不清楚：我通常有这样的异常退出。但最终，也许不是立即。

例如，而不是

```
#include <iostream>
#include <assert.h>

#define OS_CYGWIN 1

void baz(int n)
{
#if OS_CYGWIN
  assert( n == 1 && "I don't know how to do baz(1) on Cygwin). Should not call baz(1) on Cygwin." );
#else
  std::cout << "I know how to do baz(n) most places, and baz(n), n!=1 on Cygwin, but not baz(1) on Cygwin.\n";
#endif
}
void bar(int n)
{
  baz(n);
}
void foo(int n)
{
  bar(n);
}

int main(int argc, char** argv)
{
  foo( argv[0] == std::string("1") );
} 
```

只生产

```
% ./assert-exceptions
assertion "n == 1 && "I don't know how to do baz(1) on Cygwin). Should not call baz(1) on Cygwin."" failed: file "assert-exceptions.cpp", line 9, function: void baz(int)
/bin/sh: line 1: 22180 Aborted                 (core dumped) ./assert-exceptions/
% 
```

你可能会

```
#include <iostream>
//#include <assert.h>
#define assert_error_report_helper(cond) "assertion failed: " #cond
#define assert(cond)  {if(!(cond)) { std::cerr << assert_error_report_helper(cond) "\n"; throw assert_error_report_helper(cond); } }
     //^ TBD: yes, I know assert needs more stuff to match the definition: void, etc.

#define OS_CYGWIN 1

void baz(int n)
{
#if OS_CYGWIN
  assert( n == 1 && "I don't know how to do baz(1) on Cygwin). Should not call baz(1) on Cygwin." );
#else
  std::cout << "I know how to do baz(n) most places, and baz(n), n!=1 on Cygwin, but not baz(1) on Cygwin.\n";
#endif
}
void bar(int n)
{
  try {
baz(n);
  }
  catch(...) {
std::cerr << "trying to accomplish bar by baz\n";
    throw "bar";
  }
}
void foo(int n)
{
  bar(n);
}

int secondary_main(int argc, char** argv)
{
     foo( argv[0] == std::string("1") );
}
int main(int argc, char** argv)
{
  try {
return secondary_main(argc,argv);
  }
  catch(...) {
std::cerr << "main exiting because of unknown exception ...\n";
  }
} 
```

并获得更有意义的错误消息

```
assertion failed: n == 1 && "I don't know how to do baz(1) on Cygwin). Should not call baz(1) on Cygwin."
trying to accomplish bar by baz
main exiting because of unknown exception ... 
```

我不必解释为什么这些上下文相关的错误消息更有意义。例如，用户可能根本不知道为什么要调用 baz(1)。这很可能是一个 pogram 错误 - 在 cygwin 上，您可能必须调用 cygwin_alternative_to_baz(1)。

但是用户可能会理解什么是“条”。

是的：这不能保证有效。但是，就此而言，如果断言执行的操作比调用中止处理程序更复杂，则不能保证断言有效。

```
write(2,"error baz(1) has occurred",64); 
```

即使这样也不能保证有效（此调用中有一个安全错误。）

例如，如果 malloc 或 sbrk 失败。

**为什么我要进行断言抛出？测试**

我偶尔重新定义断言的另一个重要原因是为遗留代码编写单元测试，使用断言来表示错误的代码，我不允许重写。

如果这段代码是库代码，那么通过 try/catch 包装调用很方便。查看是否检测到错误，然后继续。

哦，见鬼，我不妨承认：有时我写了这段遗留代码。我故意使用 assert() 来表示错误。因为我不能依赖用户执行 try/catch/throw - 事实上，通常必须在 C/C++ 环境中使用相同的代码。我不想使用我自己的 ASSERT 宏——因为不管你信不信，ASSERT 经常发生冲突。我发现到处都是 FOOBAR_ASSERT() 和 A_SPECIAL_ASSERT() 丑陋的代码。不......简单地使用 assert() 本身很优雅，基本上可以工作。并且可以扩展....如果可以覆盖assert()。

无论如何，使用 assert() 的代码是我的还是来自其他人的：有时您希望代码失败，通过调用 SIGABRT 或 exit(1) - 有时您希望它抛出。

我知道如何测试因 exit(a) 或 SIGABRT 失败的代码 - 类似于

```
for all  tests do
   fork
      ... run test in child
   wait
   check exit status 
```

但是这段代码很慢。并不总是便携的。并且经常运行慢几千倍

```
for all  tests do
   try {
      ... run test in child
   } catch (... ) {
      ...
   } 
```

这比仅仅堆叠错误消息上下文风险更大，因为您可能会继续操作。但是您始终可以选择要捕获的异常类型。

**元观察**

我和 Andrei Alexandresciu 一起认为，异常是报告想要安全的代码中的错误的最知名方法。（因为程序员不会忘记检查错误返回码。）

如果这是正确的……如果错误报告发生阶段性变化，从 exit(1)/signals/ 到异常……仍然存在如何使用遗留代码的问题。

而且，总的来说 - 有几种错误报告方案。如果不同的库使用不同的方案，如何让它们一起生活。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T05:37:36.893

重新定义标准宏是一个丑陋的想法，您可以确定该行为在技术上是未定义的，但最终宏只是源代码替换，很难看出它如何导致问题，只要断言导致您的程序退出.

也就是说，如果您的定义本身重新定义后翻译单元中的任何代码，您的预期替换可能无法可靠地使用`assert`，这表明需要包含特定顺序等 - 该死的脆弱。

如果你的`assert`替代代码没有`exit`，你就会打开新的问题。在某些病态的边缘情况下，您关于投掷的想法可能会失败，例如：

```
int f(int n)
{
    try
    {
        assert(n != 0);
        call_some_library_that_might_throw(n);
    }
    catch (...)
    {
        // ignore errors...
    }
    return 12 / n;
} 
```

上面，值 0 表示`n`开始崩溃应用程序，而不是通过合理的错误消息停止它：将看不到抛出消息中的任何解释。

> 我和 Andrei Alexandresciu 一起认为，异常是报告想要安全的代码中的错误的最知名方法。（因为程序员不会忘记检查错误返回码。）

我不记得安德烈说过那样的话——你有报价吗？他当然非常仔细地考虑过如何创建鼓励可靠异常处理的对象，但我从未听过/见过他建议停止程序断言在某些情况下是不合适的。断言是强制执行不变量的一种正常方式——对于哪些潜在的断言可以继续，哪些不能继续，肯定有一条线要划定，但在这条线的一侧，断言仍然是有用的。

返回错误值和使用异常之间的选择是您提到的那种参数/偏好的传统基础，因为它们是更合理的选择。

> 如果这是正确的……如果错误报告发生阶段性变化，从 exit(1)/signals/ 到异常……仍然存在如何使用遗留代码的问题。

如上所述，您不应该尝试将所有现有`exit()`/断言等迁移到异常。在许多情况下，将无法有意义地继续处理，抛出异常只会让人怀疑问题是否会被正确记录并导致预期的终止。

> 而且，总的来说 - 有几种错误报告方案。如果不同的库使用不同的方案，如何让它们一起生活。

如果这成为一个真正的问题，您通常会选择一种方法并将不符合要求的库与提供您喜欢的错误处理的层一起包装。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-13T08:26:20.033

我编写了一个在嵌入式系统上运行的应用程序。在早期，我在代码中随意地使用断言，表面上是为了记录代码中应该不可能的条件（但在一些地方作为惰性错误检查）。

事实证明，断言偶尔会被击中，但没有人看到输出到控制台的包含文件和行号的消息，因为控制台串行端口通常没有连接任何东西。我后来重新定义了 assert 宏，这样它不会向控制台输出消息，而是通过网络向错误记录器发送消息。

无论您是否认为重新定义断言是“邪恶的”，这对我们都很有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T20:32:26.217

如果您包含任何使用`assert`.

我的建议是基于个人意见，在任何情况下，您都可以定义自己的断言，而无需重新定义现有的断言。重新定义现有的，而不是用新名称定义新的，你永远不会获得额外的好处。

# ruby-on-rails - 在 windows 8 下选择一个 Ruby/rails 环境

> ID：14841192
> 
> 赞同：0
> 
> 时间：2013-02-12T20:27:06.513
> 
> 标签：ruby-on-rails, windows, development-environment, environment

我是一名初级程序员和初学 Web 开发人员，寻求在 Windows 8 下构建一个合理的开发环境。几天前我买了一台新电脑，由于各种不同的原因，我在 Win8 中停留了一段时间（让我们不要进入细节）。

从我在网上找到的情况来看，在 Windows 中间开发充其量是不值得的，所以我正在寻求设置某种运行 unix 系统的 VM。我可以自己处理设置，但我对我应该设置的 VM-ware 系统有点迷茫。

我想要一个带有数据包管理器和终端的 unix（我想是 Fedora）系统，还想要一个图形文本编辑器以及在我的 Windows 文件系统上存储（使用）文件的选项。

有人对我应该考虑什么样的系统有建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:32:13.457

Windows 上的 Ruby 没问题，但 VM 是要走的路。

[这是我关于如何在 Windows 上获取 VM 的文章](http://serv.github.com/chapter/1-overview/#1_overview)

一直到 Windows 部分。

在 Windows 上安装 Ubuntu VM 后，请按照获取 Ruby 中的 Ubuntu 部分进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:29:26.357

[流浪](http://www.vagrantup.com/)是你想要的。他们将徽标从实际的流浪者更改为合成的 V :-(

# ios - iOS计算tableView单元格中的文本高度

> ID：14841193
> 
> 赞同：11
> 
> 时间：2013-02-12T20:27:08.540
> 
> 标签：ios, ipad, uitableview, storyboard, cell

我目前正在开发一个应用程序，该应用程序在表格视图中显示一些推文。在情节提要上，我创建了一个原型单元，其中包括推文条目的基本 gui 概念。

它看起来大约是这样的：

```
++++++++++++++
++Username++++
++++++++++++++
++Tweet+++++++
++++++++++++++
++Time-Ago++++
++++++++++++++ 
```

现在我正在使用以下代码计算单元格的高度，但不知何故它失败了。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    NSDictionary * currentTweet = [tweetArray objectAtIndex: indexPath.row];
    NSString * tweetTextString = [currentTweet objectForKey: @"text"];
    CGSize textSize = [tweetTextString sizeWithFont:[UIFont systemFontOfSize:15.0f] constrainedToSize:CGSizeMake(630, 1000) lineBreakMode: NSLineBreakByWordWrapping];

    float heightToAdd = 24 + textSize.height + 15 + 45;
    if(heightToAdd < 90) {
        heightToAdd = 90;
    }

    return heightToAdd;
} 
```

顺便说一句，还有别的东西，很奇怪。如果我滚动 tableview 整个应用程序似乎冻结。这是正常的还是我做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-12T20:39:14.090

试试这个解决你的问题：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {

    NSDictionary * currentTweet = [tweetArray objectAtIndex: indexPath.row];

    NSString * tweetTextString = [currentTweet objectForKey: @"text"];

    CGSize textSize = [tweetTextString sizeWithFont:[UIFont systemFontOfSize:15.0f] constrainedToSize:CGSizeMake(240, 20000) lineBreakMode: UILineBreakModeWordWrap]; //Assuming your width is 240

    float heightToAdd = MIN(textSize.height, 100.0f); //Some fix height is returned if height is small or change it to MAX(textSize.height, 150.0f); // whatever best fits for you

    return heightToAdd;
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-16T00:43:45.277

如果您正在寻找我在这里遇到的 iOS 7 答案：

[iOS 7 sizeWithAttributes：替换 sizeWithFont:constrainedToSize](https://stackoverflow.com/questions/19145078/ios-7-sizewithattributes-replacement-for-sizewithfontconstrainedtosize)

# sharepoint - 有没有比迭代 Workbooks.Open() 更快的方法从工作簿中收集数据？

> ID：14841194
> 
> 赞同：5
> 
> 时间：2013-02-12T20:27:10.400
> 
> 标签：sharepoint, excel, vba

我正在处理一个项目，其中数据集存储在 Sharepoint 服务器上的一个文件夹中的数千个 Excel 工作簿（目前约为 14000 个）中，每个工作簿都会定期修改以反映对该工作簿中数据子集的更改。我知道这不是存储和更新这些数据的好方法，但情况就是这样。

我必须执行各种查询，这些查询涉及从文件夹中的所有工作簿中提取一个或多个字段的内容。我一直在通过迭代一组工作簿来做到这一点，如下所示：

```
Function getData() As Workbook

Dim resultBk As Workbook
Dim fldr As Folder
Dim fso As New FileSystemObject
Dim fileObj As File
Dim filePath As String
Dim queryBk As Workbook

'create a workbook for storing the query results
Set resultBk = Workbooks.Add(resultBkTemplatePath)

'get the folder with all the workbooks to be queried
Set fldr = fso.GetFolder(sharepointFolderPath)

For Each fileObj In fldr.Files
    'try opening each of the workbooks
    Set queryBk = Workbooks.Open(fileObj.Path, ReadOnly:=True)

    'get data from queryBk and add it to resultBk, or add a row with an error message if queryBk failed to open
    addBkDataToResults resultBk, queryBk

    queryBk.Close False
    Set queryBk = Nothing
Next

getData = resultBk

End Function 
```

通过 Sharepoint 连接打开和关闭这么多工作簿的过程非常缓慢；运行一个完整的查询通常需要 12-14 小时。有没有更快的方法从不需要打开/关闭的 Excel 书中读取数据？或者有没有办法可以处理打开/关闭过程以使其更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:15:34.093

我将使用 ADO 并将 Excel 工作簿作为数据库连接，允许您针对它们发出 SQL 语句。我肯定会这样做是为了读取数据，也为了写作（见[这里](https://stackoverflow.com/a/13911760/111794)）。

将数据保存在 Access 中肯定会比保存在 Excel 中有所改进，您可以考虑每隔一段时间安排一次压缩以减小数据库大小。

# php - 通过 sqlsrv (codeigniter) 使用活动记录

> ID：14841196
> 
> 赞同：0
> 
> 时间：2013-02-12T20:27:22.180
> 
> 标签：php, codeigniter

我在 PHP 中的很多代码都是使用活动记录构建的：

```
 $this->db->select('CAST(Cns.Name AS TEXT) as PName, CPn1.Chil_Id, CPns.Id');
  $this->db->join('CPns', 'CPn1.CPns_Id=CPns.Id'); 
```

我想知道这是否与 Microsoft 的 sqlsrv 驱动程序不兼容，其语法传统上是这样的：

```
 $tsql = "SELECT * FROM Customer";
$stmt = sqlsrv_query( $conn, $tsql);
if( $stmt === false )
{
     echo "Error in executing query.</br>";
     die( print_r( sqlsrv_errors(), true));
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:33:37.843

答案是肯定的

您可以将带有 Active Records 的 Codeigniter 连接到您的 SQL Server。

只需在这里查看一些详细信息：[https ://bitbucket.org/alexbilbie/codeigniter-reactor-sqlsrvr/src/c2779ea3207d/system/database/drivers/sqlsrv?at=default](https://bitbucket.org/alexbilbie/codeigniter-reactor-sqlsrvr/src/c2779ea3207d/system/database/drivers/sqlsrv?at=default)

# python - Python 在类定义中实例化类

> ID：14841203
> 
> 赞同：5
> 
> 时间：2013-02-12T20:28:14.013
> 
> 标签：python, class, constructor, initialization, static-variables

我正在尝试将一个变量添加到一个包含该类实例的类中。以下是我的代码的缩短版本。

```
class Classy :
    def __init__(self) :
        self.hi = "HI!"
    # "CLASSIES" variable holds instances of class "Classy"
    CLASSIES = []
    for i in xrange(0,4) :
        CLASSIES.append(Classy()) 
```

运行代码后，我收到以下错误。

```
Traceback (most recent call last):
  File "classy.py", line 6, in Classy
    CLASSIES.append(Classy())
NameError: name 'Classy' is not defined 
```

是否有另一种方法可以将类的实例添加到该类中的类/静态变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:29:37.607

最简单的方法是在创建类之后执行此操作，在定义类时执行此操作，因此可以使用：

```
class Classy :
    CLASSIES = []

    def __init__(self) :
        self.hi = "HI!"

Classy.CLASSIES = [Classy() for _ in xrange(0,4)] 
```

（为了方便起见，这里使用[列表](http://www.youtube.com/watch?v=pShL9DCSIUw)推导，因为它是构建列表的最易读和最有效的方式）。

另请注意，如果这打算成为一个常量，您可能应该将其设为元组而不是列表，如果不打算这样做，您可能不应该使用`ALL_CAPS`按照惯例暗示常量的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:31:53.093

类主体在创建类之前执行。因此，您正在尝试在该类存在之前对其进行实例化。您仍然可以将实例附加到类，但您必须在类主体完成后创建它们，例如：

```
class Classy(object):
    def __init__(self):
        self.hi = "HI!"
    CLASSIES = []

for i in xrange(4):
    Classy.CLASSIES.append(Classy()) 
```

但是，我建议您首先仔细考虑一下您是否真的需要这个有效的全局列表，以及您是否需要它成为类对象的一部分。就个人而言，我几乎从不做这样的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T21:00:05.590

在我看来，您想要获得：

```
class Classy :
    CLASSIES = []
    def __init__(self) :
        self.hi = "HI!"
        Classy.CLASSIES.append(self)

for i in xrange(4):
    Classy()

for x in  Classy.CLASSIES:
    print x 
```

结果

```
<__main__.Classy instance at 0x011DF3F0>
<__main__.Classy instance at 0x011DF440>
<__main__.Classy instance at 0x011DF418>
<__main__.Classy instance at 0x011DF2B0> 
```

# 编辑

请注意，使用 Lattyware 的代码：

```
class Classy :
    CLASSIES = []
    idC = id(CLASSIES)
    def __init__(self) :
        self.hi = "HI!"
        #Classy.CLASSIES.append(self)

Classy.CLASSIES = [Classy() for _ in xrange(0,4)]

print Classy.idC
print id(Classy.CLASSIES)
print 'Classy.idC==id(Classy.CLASSIES) :',Classy.idC==id(Classy.CLASSIES) 
```

结果

```
18713576
10755928
Classy.idC==id(Classy.CLASSIES) : False 
```

而使用delnan'code的for循环，它不会出现。

然而，它很容易纠正：
写作
`Classy.CLASSIES[:] = [Classy() for _ in xrange(0,4)]`
或
`Classy.CLASSIES.extend(Classy() for _ in xrange(0,4))`
代替
`Classy.CLASSIES = [Classy() for _ in xrange(0,4)]`
它取决于所需的内容。

# 编辑 2

> 方法可以像普通函数一样引用全局名称。与方法关联的全局范围是包含其定义的模块。（类从不用作全局范围。）
> 
> [http://docs.python.org/2/tutorial/classes.html#class-definition-syntax](http://docs.python.org/2/tutorial/classes.html#class-definition-syntax)
> 
> 一个类有一个由字典对象实现的命名空间。类属性引用被翻译成这个字典中的查找，例如，`C.x`被翻译成`C.__dict__["x"]`
> 
> [http://docs.python.org/2/reference/datamodel.html#new-style-and-classic-classes](http://docs.python.org/2/reference/datamodel.html#new-style-and-classic-classes)

```
class Classy :
    CLASSIES = []

print '"CLASSIES" in globals()',"CLASSIES" in globals()
print '"CLASSIES" in Classy.__dict__ ==',"CLASSIES" in Classy.__dict__ 
```

结果

```
"CLASSIES" in globals() False
"CLASSIES" in Classy.__dict__ == True 
```

Delnan，你将如何继续假装 CLASSIES 是全球性的？
在您与 Lattyware 的辩论中，我是否误解了某些内容？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T20:29:44.753

直到类块完成执行后才定义类本身，因此您不能在其自己的定义中使用该类。

创建类后，您可以使用类装饰器或元类添加所需的类变量。这是一个带有装饰器的示例。

```
def addClassy(cls):
    cls.CLASSIES = [cls() for a in xrange(4)]
    return cls

@addClassy
class Classy(object):
    pass

>>> Classy.CLASSIES
0: [<__main__.Classy object at 0x000000000289A240>,
 <__main__.Classy object at 0x000000000289A518>,
 <__main__.Classy object at 0x000000000289A198>,
 <__main__.Classy object at 0x000000000289A208>] 
```

# linux - 来自 vim 的 Bash 命令

> ID：14841208
> 
> 赞同：5
> 
> 时间：2013-02-12T20:28:31.723
> 
> 标签：linux, vim, path, terminal

当我从 vim 内部运行 bash 命令时，我注意到路径全错了。我的 .vimrc 内部有没有办法让它加载我的 .bash_profile 或者只是从它启动的终端继承 PATH 和别名设置？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T20:55:25.343

如果您将 shell 定义为交互式，vim 将加载您的 .bashrc 或 .bash_profile。默认不加载。

这可以通过以下方式完成：

```
:set shellcmdflag=-ic 
```

默认为 only `-c`，`:h shellcmdflag`查看详细信息。当然你可以将它添加到你的 .vimrc 文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T07:57:16.420

如果您`export PATH`在配置文件中正确完成，Vim 应该继承 shell 的`PATH`设置。你可以从 Vim 内部检查 via `:echo $PATH`，也可以通过`:let $PATH .= ':/additional/path'`.

如果您还需要别名，则必须使用 Kent 的解决方案。提醒一句：通过对 的这种修改`'shellcmdflag'`，您可能（取决于您的 shell 环境的复杂性）为来自 Vim 的*每个*shell 调用招致运行时损失。

# php - Joomla 模块构建。带有数据库连接的下拉列表

> ID：14841209
> 
> 赞同：0
> 
> 时间：2013-02-12T20:28:31.350
> 
> 标签：php, mysql, joomla, module

我正在尝试为 joomla 2.5 制作一个简单的模块。本质上，我希望能够有一个人骑的下拉列表。一旦选定。该地区办公室/个人办公室的信息将显示在下拉框下方的 div 中。

我最终希望有第二个下拉列表，允许用户在第一次选择骑行后选择办公室电话、个人电话、办公室电子邮件、个人电子邮件、办公室地址或个人地址。该决定的信息将显示在两个下拉框下方。到目前为止，我已经设置并安装了模块（结构正确）。只是在我的 helper.php 和 tmpl/default.php 中没有正确的代码

助手.PHP

```
<?php
// No Access
defined('_JEXEC') or die ;

//Add database Instance
$db = JFactory::getDBO();
//Pass in query
$query = "SELECT * FROM #__mlainfo"; 
//Run it
$db -> setQuery($query);

//Load it as an object into variable "$ridings"
$riding = $db -> loadObjectList(); 
```

默认.PHP

```
<?php defined('_JEXEC') or die; ?>

<div class="moduletable<?php echo $params->get( 'moduleclass_sfx' ) ?>">
<select>
    <?php foreach ($riding as $riding_name => $ridings): ?>
    <option value="<?php echo $riding_name ?>">
    <?php endforeach; ?>
</select>
</div> 
```

我意识到我只成功了一半。我得到一个选择列表来显示这个安装。但是它只有 40 个空格。任何帮助，将不胜感激。

所有信息都存储在数据库中，标题为；

骑行（号码）、骑行名、全名、off_address、per_address、off_email、per_email、off_phone、per_phone

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:44:01.900

```
loadObjectList() returns an indexed array of PHP objects

<div class="moduletable<?php echo $params->get( 'moduleclass_sfx' ) ?>">
<select>
    <?php foreach ($riding as $key => $ridings): ?>
    <option value="<?php echo $ridings->riding?>"><?php echo $ridings->riding_name?></option>
    <?php endforeach; ?>
</select>
</div> 
```

[http://docs.joomla.org/Accessing_the_database_using_JDatabase/1.5#loadObjectList.28.29](http://docs.joomla.org/Accessing_the_database_using_JDatabase/1.5#loadObjectList.28.29)

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:37:34.357

您只需要填写选项字段：

```
<?php defined('_JEXEC') or die; ?>

<div class="moduletable<?php echo $params->get( 'moduleclass_sfx' ) ?>">
<select>
    <?php foreach ($riding as $riding_name => $ridings): ?>
    <option value="<?php echo $ridings->riding ?>"><?php echo $ridings->riding_name ?></option>
    <?php endforeach; ?>
</select>
</div> 
```

# android - 在模拟内容解析器中插入缺少的值

> ID：14841213
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:03.410
> 
> 标签：android, junit, android-contentprovider

我创建了一个扩展 ProviderTestCase2 的具体类，并且我正在编写测试方法来测试内容提供者对插入、删除、查询、更新、getType 的实现。

我使用`getMockContentResolver`并传入了一些随机值，比如

```
ContentValues cv = new ContentValues();
cv.put("key1", "value1");
cv.put("key2", "value2");

Uri uri = getMockContentResolver.insert(table.content_uri, cv);
//table.content_uri defined earlier
assertNotNull(uri); 
```

但是当我运行测试时，我发现跟踪显示：

```
INSERT INTO table.content_uri("key1","key2") VALUES(?,?); 
```

我很好奇价值观去哪儿了。谁知道如何检查测试数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:31:46.010

问号用作 Android 中 SQLite 查询的占位符。内容值被自动替换

# html - IE 中的样式问题 - 分层导航

> ID：14841215
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:05.640
> 
> 标签：html, css, styles, stylesheet

嘿伙计们，我有以下几点：

```
 <ul class='main_nav'>
        <li class='first' style='padding-top:0;'><a href='#' onclick='return false;'><span class='shaper'>Tools</span></a>
            <ul>
                <li class='second'><a href='emailfunction.php'>Email Tool</a></li>
                <li class='second'><a href='insurancetool.php'>Insurance Tool</a></li>
                <li class='second'><a href='monthlyreport.php'>Monthly Report Tool</a></li>
                <li class='second'><a href='statuschanger.php'>Status Change Tool</a></li>
                <li class='second'><a href='addtool.php'>Add Tool</a></li>
                <li class='second'><a href='revisetool.php'>Revise Tool</a></li>
                <li class='second'><a href='csvuploaderform.php'>Upload an Employee List (.csv file)</a></li>
                <li class='second'><a href='csvmanualuploaderform.php'>Upload a Single Employee</a></li>
                <li class='second'><a href='insuranceverificationviewer.php'>View Employee Car Insurance Information</a></li>
            </ul>
        </li>       
 </ul> 
```

所以这是我的导航，这里是样式：

```
.main_nav {
    display: block;
    float: left;
    width: 118px;
    height: 60px;
    background: #009;
    margin: 0 .5% 0 0;
    padding:0;
    color:black;

}
.main_nav:hover{
    background: lightgray;
    border-top:1px solid #009;
    border-right:1px solid #009;
    border-left:1px solid #009;
    color:#009;
}
.main_nav .first {
    text-align: center;
    width: 100%;
    color:white;
    z-index:9999;
}
.main_nav li a {
    color:white;
    height:60px;
    display: block; 
    z-index:9999;
}
.main_nav a:hover {
    color:black;    
}
.main_nav li {
    list-style:none;
    z-index:9999;
}
.main_nav li:hover {

}
.main_nav ul {
    display:none;
    list-style:none;    
    position:relative;
    float: left;
    z-index:9999;
}
.main_nav li:hover > ul {
    display: block;
    padding:0;
    margin:0;
    position:absolute;
    background: lightgray;
    }
.main_nav  li ul li {
    border-left:1px solid #009;
    border-right:1px solid #009;
    border-bottom:1px solid #009;
    z-index:9999;
} 
```

所以这很好用，除了在 IE 中，我有这个问题是我有一个绝对的 div，它在它的底部添加了一条线。事情是在 IE 中，当您将鼠标悬停在上方时，该行会放在显示的顶部导航之前。在谷歌，火狐这一切都很棒。

这里是酒吧：

```
<div class="top-backgroundwrap">

</div><!-- top-backgroundwrap -->

.top-backgroundwrap {
    width: 100%;
    height: 20px;
    background: lightgray;
    margin-top: -24px;  
} 
```

我尝试过使用 z-index，但没有成功。我注意到 IE 将其视为最上一个位置：绝对；并在减少索引后将其显示在前面。如果你能帮我一把，我将不胜感激。需要帮助请叫我。

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:56:53.937

想通了...我必须摆脱绝对位置并在单独的 IE 样式表中更改一些填充。

# c# - 为什么一个与另一个程序集没有直接依赖关系的程序集必须引用它？

> ID：14841216
> 
> 赞同：1
> 
> 时间：2013-02-12T20:29:04.640
> 
> 标签：c#, inheritance, .net-assembly

我对 c# 编程很陌生。因此，假设我们有两个程序集 Asm1、Asm2，其中两个类定义如下：

```
//Asm1
namespace ClassLibrary1
{
public class A//: B
  {
    B b = new B { i = 2};
    public int MyProperty { get { return b.i; } }
  }
}

//Asm2
namespace ClassLibrary2
{
  public class B
  {
    public int i;
  } 
} 
```

Asm1 引用 Asm2 现在我们有一个可运行的程序集，比如 asm3，它使用 Asm1 和以下代码：

```
//Asm3
A a = new A();
System.Console.Write(a.MyProperty.ToString()); 
```

上面的代码编译正确，没有错误。

但是当我们在类 A 中做很少的改变并让它从类 B 继承时，事情就出错了。在这种情况下，行：A a = new A(); 不编译并产生错误。但是当我们添加 asm2 作为对 asm3 的引用时，它可以工作。请告诉我为什么会这样。为什么没有直接依赖于另一个程序集的程序集必须引用它？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T22:38:10.497

在这种情况下，编译器需要访问声明了您使用的类型（即`A`）的基类的程序集。确切的规则有些复杂。

据报道，使用 .NET 4.0 和 Visual Studio 2010，如果您在一个程序集中从第二个程序集继承了一个类，该类从未引用的第三个程序集公开了类型（并且您自己的项目没有公开任何这些类型），它会起作用美好的。但是当升级到 .NET 4.5 和 Visual Studio 2012 时，相同的代码和引用组合失败，您必须引用第三个程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:49:56.680

好吧，如果您从 Asm3 到 Asm1 进行了项目引用，则无需将 Asm2 引用到您的项目。编译时会抓取asm2，放到bin文件夹下。但是，如果您在 Asm3 中直接对 Asm1 进行二进制引用，则它需要 bin 中的 asm2（因为 asm1 需要它）。这不一定需要引用 asm2，但它必须在 asm3 的 bin 中。因此，您不需要手动将 Asm2 复制到 bin，因此您可以引用它，它会为您复制它。但是，我会执行以下操作，

我将 Asm1 和 Asm2 放在一个文件夹中说依赖项（对于 asm3），然后我将在 asm3 中仅引用 Asm1，在构建期间，asm2 将被复制到 bin 目录中，你会很好

所以简而言之，你的 asm1 无论走到哪里都需要 asm2。这就是你需要它的原因

# objective-c - if 语句没有按我的预期工作

> ID：14841217
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:05.550
> 
> 标签：objective-c, cocoa, if-statement

以下代码不起作用。没有错误消息或任何东西..它只是正常工作。（图像未显示在应有的位置） imgdtl 是 NSMutableDictionary

```
 if ([NSString stringWithFormat:@"%@",[filePath pathExtension]] == @".jpg")
        {
            NSImage *myimage = [[NSImage alloc] initWithContentsOfFile:[NSString stringWithFormat:@"%@" ,filePath]];
            [imgdtl setObject: myimage forKey: @"image"];
            [imgdtl setObject:[NSString stringWithFormat:@"%@" ,fileName] forKey: @"filename"];
        }
        else{
            NSImage *myimage = [[NSImage alloc] initWithContentsOfFile:@"no_image.gif"];
            [imgdtl setObject: myimage forKey: @"image"];
            [imgdtl setObject:[NSString stringWithFormat:@"%@" ,fileName] forKey: @"filename"];
        } 
```

但这一个正在工作：

```
 NSImage *myimage = [[NSImage alloc] initWithContentsOfFile:[NSString stringWithFormat:@"%@" ,filePath]];
            [imgdtl setObject: myimage forKey: @"image"];
            [imgdtl setObject:[NSString stringWithFormat:@"%@" ,fileName] forKey: @"filename"]; 
```

我只想在格式为 .jpg 的情况下加载图像，并且如果文件有任何其他扩展名，我希望它不加载。有人可以告诉我我做错了什么吗？谢谢！

**- -编辑 - -**

感谢所有的评论，但下面的代码给出了与上面相同的问题：

```
 if ([[NSString stringWithFormat:@"%@",[filePath pathExtension]] isEqualToString @".jpg"]) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T20:35:57.080

有数百个重复项。

您想比较字符串的内容，而不是指针。== 比较指针。比较内容使用 NSString 的`-isEqualToString:`方法

```
if ([string isEqualToString :@"other string"]) ..... 
```

**编辑**

附带说明一下，将重复的代码移出条件块，它们是相同的，因此无需将它们放在那里两次：

```
NSImage *myImage;

if ([[filePath pathExtension] isEqualToString: @"jpg"])
    {
        myImage = [[NSImage alloc] initWithContentsOfFile: filePath]];

    }
    else{
        myImage = [[NSImage alloc] initWithContentsOfFile:@"no_image.gif"];
    }

[imgdtl setObject: myImage forKey: @"image"];
[imgdtl setObject: fileName forKey: @"filename"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:35:57.627

您是否尝试过在 if 语句中使用方法“isEqualToString:”？NSString 有一个 isEqualToString 方法，它比较两个字符串的字符而不是使用 == 运算符。它有时会返回不同的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T20:36:03.017

使用以下objective-c方法： [someString isEqualToString:someOtherString] 比较你的字符串

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T20:41:52.097

```
if ([[NSString stringWithFormat:@"%@",[filePath pathExtension]] isEqualToString @".jpg"])
        {
            NSImage *myimage = [[NSImage alloc] initWithContentsOfFile:[NSString stringWithFormat:@"%@" ,filePath]];
            [imgdtl setObject: myimage forKey: @"image"];
            [imgdtl setObject:[NSString stringWithFormat:@"%@" ,fileName] forKey: @"filename"];
        }
        else{
            NSImage *myimage = [[NSImage alloc] initWithContentsOfFile:@"no_image.gif"];
            [imgdtl setObject: myimage forKey: @"image"];
            [imgdtl setObject:[NSString stringWithFormat:@"%@" ,fileName] forKey: @"filename"];
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T20:42:20.393

您应该像这样比较字符串：

```
if ([[NSString stringWithFormat:@"%@",
    [filePath pathExtension]] isEqualToString:@"jpg"]) 
```

...因为`==`是指针比较，并且您（这次）对两个文本字符串的内容感兴趣，而不是它们是否指向相同的内存位置。

# c# - 为什么 NDepend 不产生稳定的 LOC 计数？

> ID：14841218
> 
> 赞同：2
> 
> 时间：2013-02-12T20:29:06.780
> 
> 标签：c#, static-analysis, ndepend, lines-of-code

我正在使用 NDepend 4.1 API 来计算 Visual Studio 2010 解决方案中的代码行数，该解决方案有几个项目，这些项目都针对 .NET Framework 4。这是我的代码：

```
var servicesProvider = new NDependServicesProvider();
var projectManager = servicesProvider.ProjectManager;
var project = projectManager.CreateTemporaryProject( ... );
var analysisResult = project.RunAnalysis();

var methods = analysisResult.CodeBase.Application.Methods;
var totalLoc = methods.Where( i => i.NbLinesOfCode.HasValue ).Sum( i => i.NbLinesOfCode.Value ); 
```

如果我在我的解决方案上反复运行此分析，`totalLoc`即使*我没有以任何方式更改解决方案或其编译的程序集，我也会得到不同的结果。*例如，如果我运行 3 次分析，我可能会得到`totalLoc`12100、12220 和 12075 的值。

再深入一点，我已经开始遍历`analysisResult.CodeBase.Application.Methods`并将每个方法的名称写入`NbLinesOfCode`文本文件。当我从任何两次分析运行中对文件进行比较时，我注意到大多数方法都显示出一致的 LOC 计数，但也有少数方法没有。我在其中看不到任何模式，而且每次似乎都不是同一组方法。

什么可能导致这种奇怪的行为？

**更新 1：**如果我对任何*单个*程序集运行分析，我会得到一致的 LOC 计数。只有当我将多个程序集传递给`CreateTemporaryProject`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-20T08:18:47.430

[这是现在在NDepend 版本 5](http://www.ndepend.com/NDependV5.aspx)中修复的错误！

有趣的是，这个 bug 来自一个 subtil 并发访问问题，当在两个不同的线程上分析 2 个大型程序集时，会出现不同的分析结果！

# iphone - 在 NSDictionary 中抓取随机条目

> ID：14841219
> 
> 赞同：3
> 
> 时间：2013-02-12T20:29:08.227
> 
> 标签：iphone, ios, nsdictionary, nsset

有没有办法在 NSDictionary 中获取完全随机的密钥？

```
NSString *key = [enumeratorForKeysInDictionary nextObject]; 
```

我有这个以非随机方式迭代字典的代码。

我应该将所有密钥添加到 NSSet 中，然后从那里随机拉取吗？

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T20:36:05.163

看到这个：

```
NSArray *array = [dictionary allKeys];
int random = arc4random()%[array count];
NSString *key = [array objectAtIndex:random]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:37:38.723

```
NSArray* allKeys = [dictionary allKeys];
id randomKey = allKeys[arc4random_uniform([allKeys count])];
id randomObject = dictionary[randomKey]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T20:33:10.943

你也可以尝试这样的事情：

```
NSArray* allKeys = [myDictionary allKeys]; 
```

然后可以通过c方法rand()在上面的NSArray中获取随机索引来获取随机key。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T21:03:44.960

这里的想法相同，在键中使用随机索引，但有一些改进：(1) 字典类别，(2) 块枚举器，如本机，(3) 最重要 - 要随机枚举，我们必须消除已经访问过的键. 这将随机访问每个键，恰好一次（除非调用者在块中设置 stop=YES）：

```
//
//  NSDictionary+RandBlockEnum.h
//

#import <Foundation/Foundation.h>

@interface NSDictionary (RandBlockEnum)

- (void)enumerateKeysAndObjectsRandomlyUsingBlock:(void (^)(id, id, BOOL *))block;

@end

//
//  NSDictionary+RandBlockEnum.m
//

#import "NSDictionary+RandBlockEnum.h"

@implementation NSDictionary (RandBlockEnum)

- (void)enumerateKeysAndObjectsRandomlyUsingBlock:(void (^)(id, id, BOOL *))block {

    NSMutableArray *keys = [NSMutableArray arrayWithArray:[self allKeys]];
    BOOL stop = NO;;

    while (keys.count && !stop) {
        id randomKey = keys[arc4random_uniform(keys.count)];
        block(randomKey, self[randomKey], &stop);
        [keys removeObject:randomKey];
    }
}

@end 
```

像这样称呼它：

```
#import "NSDictionary+RandBlockEnum.h"

NSDictionary *dict = @{ @"k1" : @"o1", @"k2" : @"o2", @"k3" : @"o3" };
[dict enumerateKeysAndObjectsRandomlyUsingBlock:^(id key, id object, BOOL *stop) {
    NSLog(@"%@, %@", key, object);
}]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-22T20:51:29.473

@BestCoder 答案的现代单行版本：

### Objective-C

```
dictionary.allKeys[arc4random_uniform(dictionary.allKeys.count)] 
```

### 迅速

```
Array(dictionary.keys)[Int(arc4random_uniform(UInt32(dictionary.keys.count)))] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-12T21:06:26.030

您可以创建一个集合，然后从集合中抓取任何对象。

```
NSSet *set = [NSSet setWithArray:[myDictionary allKeys]];
NSString *randomKey = [set anyObject]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-03T08:22:30.780

斯威夫特 4

你有一本字典

```
 let ads = _segueDataFromHomeToGuessMatch_NSType[Constants.Matches.ads] as! NSDictionary 
```

得到一个像这样的随机键值

```
 let rd_ad_key = ads.allKeys[Int(arc4random_uniform(UInt32(ads.count)))] as! String 
```

像这样获取随机键的值

```
 let rd_ad_value = ads[rd_ad_key] as! String 
```

# c# - 是否有 C# 方法重载参数排序约定？

> ID：14841223
> 
> 赞同：14
> 
> 时间：2013-02-12T20:29:25.337
> 
> 标签：c#, coding-style, conventions, overloading

对于以下情况，C#（或任何支持方法重载的面向对象语言）中是否有任何约定？

假设我有一个方法 foo：

```
public void Foo(int a){//does stuff} 
```

但实际上我有 3 种方法 foo：

```
public void Foo(int a){}
public void Foo(int a, double b){}
public void Foo(float c, int a, double b){} 
```

是否有规定参数的顺序在重载方法中是否重要的​​约定？注意第三种方法不是一个明显的逻辑进展（a，b，c）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-12T20:32:09.180

就在这里。看看[https://msdn.microsoft.com/en-us/library/ms229029(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/ms229029(v=vs.110).aspx)

> 重载成员中参数的顺序要保持一致。同名的参数应该出现在所有重载中的相同位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:37:40.533

虽然不需要维护特定的顺序，但为了可读性，这样做通常是一个好主意。然而，参数的顺序对于方法签名确实很重要。例如，

```
public void DoStuff(int a, bool b, string c)
{

}

public void DoStuff(bool b, string c, int a)
{

} 
```

是有效的并且编译得很好，即使参数的数量，甚至它们的名字都是一样的。

更新：我不建议这样做。这可能会导致混乱。我只是说它在技术上是有效的。

# bash - bash 脚本的新手；试图找出为什么 SOURCE 命令不执行

> ID：14841228
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:35.160
> 
> 标签：bash

我已经做出了非常真诚的努力来解决这个问题，但我做不到。这是我非常简单的 bash 脚本。以“export”和“echo”开头的行似乎有效，所以我知道我的脚本正在执行。如果我在终端的提示符处输入以“source”开头的行，我会得到很多打印输出，表明该命令正在运行，但是如果我执行我的脚本，则什么也没有发生（事实上，随后使用 Freesurfer 的努力表明它没有工作）。我有一种感觉，可能有一些非常基本的东西我不了解 bash 脚本，但我无法通过查看教程来弄清楚那是什么。

```
#!/bin/bash

export FREESURFER_HOME=/foo/freesurfer
echo "starting freesurfer"
echo $FREESURFER_HOME
source $FREESURFER_HOME/SetUpFreeSurfer.sh
export SUBJECTS_DIR=/bar/my_dir 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:33:52.580

如果您使用`./scriptname.sh`它运行脚本，则会在子shell 中执行。在那里设置的每个变量等都不能改变父 shell 的环境。为此，您需要`source`脚本。

参见例如。这个关于[超级用户的问题](https://superuser.com/questions/176783/what-is-the-difference-between-executing-a-bash-script-and-sourcing-a-bash-scrip)

# ios - 我可以在没有自定义 URL 架构的情况下从另一个项目单击按钮打开 Xcode 项目吗？

> ID：14841231
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:39.210
> 
> 标签：ios, objective-c, xcode

我想将两个 Xcode 项目集成在一起，它们都是带有 UI 的完整 Xcode 项目。例如，假设我有一个应用程序“A”，它有一个 UIButton，点击它应该打开应用程序“B”，它有自己的 UI。我知道我们可以通过自定义 URL 架构从另一个应用程序打开一个应用程序，但是有没有一种方法可以在没有自定义 URL 架构并通过连接 Xcode 项目的情况下做到这一点。

我知道这是一个有点模糊的问题，但我没有更好的方法来提出这个问题。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:44:43.023

你的问题没有任何意义。你在谈论两个非常不同的事情。是的，您可以将一个 Xcode 项目导入另一个 Xcode 项目并在它们之间建立依赖关系。但是，这绝不会影响应用程序之间的协作方式。如果您想将一个应用程序嵌入到另一个应用程序中，则必须在视图控制器/代码级别进行。您不能简单地将一个项目添加到另一个项目中并期望两者相互交流。您必须将一个应用程序的功能转移到另一个应用程序。应用程序在设备上被沙盒化，因此除了使用您提到的自定义 URL 方案外，它们之间不能相互通信。

# vb.net - 如何检查日期是 00:00:00

> ID：14841235
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:55.563
> 
> 标签：vb.net

我有一张我正在查询的表格，`DeliveryDate`但有些记录没有，`DeliveryDate`所以 VB 将其视为 00:00:00。

如何`IF`设置条件来检查日期并查看它是否为 00:00:00？因为我想在日期为空（00:00:00）时将变量设置为**TRUE 。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:13:24.057

看起来您想检查是否将 date 分配给`Nothing`，在这种情况下，它将默认为[Date.MinValue](http://msdn.microsoft.com/en-us/library/system.datetime.minvalue.aspx)。快速而肮脏的方法是检查：

```
If DeliveryDate = Date.MinValue Then 
```

它适用于在午夜交付的包裹，因为您不太可能在公元前 1 年安排任何包裹交付。

正确的方法是使用`DeliveryDate`type `Nullable(Of Date)`，因此您实际上可以在其中存储`Convert.DBNull`(= `Nothing`)。在这种情况下，代码变得更容易阅读：

```
If DeliveryDate Is Nothing Then 
```

请注意，您*可以*在开始时使用类似的行（`DeliveryDate`类型为`Date`）：

```
If DeliveryDate = Nothing Then 
```

但是，您宁愿避免 to 的隐式转换`Nothing`，`Date.MinValue`这在这种情况下会在幕后发生，即使它看起来与 . 一样可读`Is Nothing`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:27:27.503

您可以检查您的日期是否等于日期部分：

`If DeliveryDate.Date = DeliveryDate Then ...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T03:15:04.140

我个人使用`New Date`，但它是一种风格选择——你也可以使用 Nothing。

```
If DeliveryDate = New Date Then 
```

或者

```
If DeliveryDate = Nothing Then 
```

# javascript - Ext.ux.grid.CheckColumn -- 远程触发事件

> ID：14841236
> 
> 赞同：0
> 
> 时间：2013-02-12T20:29:56.400
> 
> 标签：javascript, events, extjs

我有一个使用 Ext.ux.grid.CheckColumn 和 Ext.ux.grid.RowExpander 的 Ext.grid.GridPanel。

我已经向 RowExpander 添加了一个侦听器，并且我试图在展开行后“检查”由 Ext.ux.grid.CheckColumn 创建的复选框（使用 RowExpander）。关于我如何做到这一点的任何想法？

我的代码如下：

```
var expander = new Ext.ux.grid.RowExpander({
    width: 15,
    selectRowOnExpand: true,
    align: 'left',
    tpl : new Ext.Template(
       ........
    ),
    listeners: {
        expand: function (row,record,body,rowIndex) { 
     ------>>>>>> what do I put here to fire an event into checkcolumn ?
         }
    }
  }
  var checkbox = new Ext.ux.grid.CheckColumn({
    header: 'Read',
    dataIndex: 'read',
    id: 'read',
    width: 30
  });

  var mygrid = new Ext.grid.GridPanel({
    renderTo: document.getElementById('inbox'),
    plugins: [new Ext.ux.IconMenu(), search, expander, checkbox],
    ..............
    ..............
    columns:[
       checkbox,
       { other column definition }
   etc etc 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:01:25.743

检查状态由模型中的读取字段控制，因此您需要对其进行修改：

```
expand: function(row, record) {
    record.set('read', true);
} 
```

# wordpress - 自定义帖子类型与父自定义帖子类型的永久链接

> ID：14841237
> 
> 赞同：3
> 
> 时间：2013-02-12T20:30:00.727
> 
> 标签：wordpress, custom-post-type, permalinks

很难定义这个问题的标题......

我想为我的 2 种自定义帖子类型 (CPT) 创建一个易于阅读的永久链接结构。我的第一个 CPT“family”有以下 rewrite-slug“ **family/%postname%** ”（一切正常）

第二个 CPT“childs”有一个元框，我可以通过选择 child-CPT 所属的 CPT“family”来选择 parent_id-field。这也很好用。

现在我将“childs”的 rewrite-slug 设置为“ **%parent_post_url%/child/%postname%** ”，这样我就可以获得以下 URL“ **family/the-griffons/child/peter** ”。但是当我调用这个 URL 时，wordpress 会显示一个未找到的页面。疯狂的是，如果我将 rewrite-slug 设置为“ **family/the-griffons/child/%postname%** ”，我可以调用 URL（两个 URL 相同！！！）

那么，为什么当我尝试动态获取 URL 时脚趾 WP 会引发错误，而当我对 URL 进行硬编码时却不会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T01:00:37.017

你认为你拥有的孩子与父母的关系并不完全存在。根据您到目前为止告诉我们的内容，您似乎只有一个表示“伪父”ID 的自定义字段。所以你的问题应该真正阅读的是

*如何根据 cpt 自定义字段值重写 cpt url 的第一部分？*

因为，就您的情况而言，就 wordpress 而言，这就是“父 ID”真正的全部内容 - 自定义字段值。

您可以尝试按照[本教程的](http://3doordigital.com/custom-fields-and-posts-in-wordpress-permalink-urls/)**最后一部分**（第 3 部分）进行操作，请记住，您需要“父 id”的 url 的实际路径，而不是 cf“父 id”值本身，你'必须按照以下方式实施一些事情：

```
$parent_id = get_post_meta($post_id, "your_cf_key_for_parent_id", true);
$full_parent_post_url =  parse_url( get_permalink( $parent_id ) );
$parent_post_url =  $full_parent_post_url['path'];
if(!$parent_post_url) { $parent_post_url = "default-fallback" }
$permalink = str_replace(‘%parent_post_url%’, $parent_post_url, $permalink);
return $permalink; 
```

另一个相关的 stackexchange 答案：

[using-custom-fields-in-custom-post-type-url](https://wordpress.stackexchange.com/questions/67021/using-custom-fields-in-custom-post-type-url)

但正如@c0ns0l3 提到的，使用自定义分类法是解决此问题的正确方法。

# sql - sql规范化一个表

> ID：14841239
> 
> 赞同：0
> 
> 时间：2013-02-12T20:30:11.407
> 
> 标签：sql

我有一个名为服务条目的表。在一个服务条目中可能有多个部分。所以表服务入口部分的每个部分都会有一行。零件存储在零件表中。服务条目表有一个逗号分隔的列，其中包含用于在页面上显示的部件信息。

Dbo.Part

```
ID   PartDescription
270  Syringe assembly
282  LPH pcb 
287  Valve block assembly 
```

**Dbo.ServiceEntry**

```
ServiceEntryID, Description
     1200         270 ~ Syringe assembly  ~ 7,3 ~ Increase drive current from 3 --> 1.|282 ~ LPH pcb ~ 8 ~  | 287 ~ Valve block
   assembly ~ null ~ 
```

在上面这里是列的结构：

```
PartID ~ PartDescription ~ ServiceType ~ Comment 
```

对于多个部分，添加此字符`|`并重复结构。

**`ServiceEntryPart`：**

```
ID  ServiceEntryID   PartID  ServiceTypev Comment
1    1200            270      7,3         Increase drive current from 3
2    1200            282      8          
3    1200            287      null 
```

**问题**

Dbo.Part

```
ID   PartDescription       OldID
331  Syringe assembly      270
335  LPH pcb               282
336  Valve block assembly  287 
```

因此，如果您查看上面的零件表，发生的事情是零件表正在更新。将添加新部件，对于现有部件，它们的 id 将更新为新 id，并且可能会有新的部件描述。如您所见，带有列部分描述的服务条目表将不会与之前创建的服务条目同步。我要做的是使用新的部件 ID 及其 dcescriptions 更新现有的服务条目部件表，最后更新服务条目表中称为部件描述的列。更新服务条目部分表很简单，但问题是如何更新服务条目表中的分隔列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:45:27.757

如果我理解正确，您正在使用包含多个分隔值的列（如 PICK 数据库）：

```
`For multiple parts, this character | is added and the structure is repeated.` 
```

通常，在规范化数据库中，会有：

```
UNIT  (something that might need service or repair)
UnitId  PK
UnitDescription

PARTS  (repair / replacement parts)
PartId PK
PartDescription

UNIT_SERVICES  (instances of repair visits/ service)
ServiceID   int primary key
UnitId      foreign key references UNIT
ServiceDate
TechnicianID
etc

SERVICE_PART   (part used in the service)
ID          primary key
ServiceID   foreign key references SERVICE
PartID      foreign key references PART
Quantity 
```

与一个 UNIT 相关联的 UNIT_SERVICES 可能有零个、一个或多个。可以有零个、一个或多个与 SERVICE 关联的 SERVICE_PARTS。

在规范化数据库中，用于为一个单元提供服务的每个部分都将存在于 SERVICE_PART 表中自己的行中。我们不会在同一个 SERVICE_PART 元组中找到两个或多个部分，它们由一些分隔符分隔，就像在现代 OODBMS 的前身所谓的多值数据库中通常所做的那样。

# algorithm - 党职 - 面试解决方案

> ID：14841241
> 
> 赞同：4
> 
> 时间：2013-02-12T20:30:13.627
> 
> 标签：algorithm

假设您是派对顾问，并受雇准备和举办公司派对。公司中的每个员工都是 B 树式层次结构的一部分，并被赋予了党级价值。为了防止员工在直接主管在场的情况下受到抑制，主管及其直接员工都不会被邀请。但是，可以邀请任一组。

设计一种算法来生成最大派对等级和的客人列表。

我的解决方案是

*   主管将包含一个字段，用于直接员工的党职总和

执行自下而上的广度优先搜索以访问树中最低的主管子树。对于每个主管，计算主管党级别与直接雇员总和之间的差异。如果员工党排名总和大于主管排名，所有受影响的员工将被添加到客人列表中。

如果主管和员工排名之间的差异小于或等于零，则向上移动一级并针对下一级子树执行上述比较。

逐级往上，直到分析出公司负责人，并打印出党员总和和宾客名单。

我对运行时间的分析是`O(n log n -1)`由于

`log n-1`- 下降到最低子树的时间

`n`- 最大比较次数

我在一次采访中想到了这个，但不禁觉得我错过了一些东西。我的分析和步骤正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:51:22.793

我会以自下而上的方式为层次结构中的每个人计算两个数字：

1.  如果那个人没有参加，他的及物下属有多少可以参加。
2.  如果那个人确实参加了，他的及物下属（包括他自己）有多少可以参加。

对于每个人，给定每个直接下属的两个数字，这很容易计算（在 O(B) 时间内，B 是下属的数量）。只需为该人尝试两种方式，并为每个下属使用适当的数字。

因此，通过自下而上的步行，我认为总共需要 O(n) 时间。

# java - 编辑文本框上的错误文本显示为白色

> ID：14841244
> 
> 赞同：0
> 
> 时间：2013-02-12T20:30:28.447
> 
> 标签：java, android

我有以下代码：

```
EditText edit = (EditText) findViewById(R.id.bluetractor);
         if (edit.getText().toString().equals("Blue Tractor"))
         {
         Toast.makeText(getApplicationContext(), "Correct", Toast.LENGTH_LONG).show();
         }
         else
         {
       edit.setError("Incorrect");
         } 
```

但是，当我单击执行代码的按钮时，除了书写（“不正确”）看起来是白色的事实之外，一切都很好，因此它在错误弹出窗口的白色背景上不可见。任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:52:00.647

您不能更改该视图的 XML 中的颜色吗？

```
setError("error").setTextColor(bleh) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:57:25.357

可以通过设置在xml中完成

```
<item name="android:textColorSecondaryInverse"></item> 
```

或者，您可以将 setError 与 Spannable String 一起使用

# jquery - 控制器和滑块中的 flexslider 方向导航不起作用

> ID：14841245
> 
> 赞同：1
> 
> 时间：2013-02-12T20:30:28.170
> 
> 标签：jquery, custom-controls, flexslider

我已经研究和测试了几个星期，但我无法让这段代码工作。我正在使用我正在自定义的主题中的 flexslider (1.8)。我想有两个我理解的定向导航是手动控制。我首先使用 spans 构建了自定义控制器，然后使用了 UL > LI 结构。方向导航箭头在滑块中效果很好，但我无法在自定义控制器中复制该功能。我昨天获得了可以工作的功能，但它只是将方向导航箭头移动到控制器所在的位置......如果可能的话，我希望两者都拥有。我尝试更新到当前的 flexslider.js，但这会破坏主题中使用的其他 flexslider。

我在 custom.js 文件中有这个：

```
$slider.flexslider( { 
slideshow: false, 
controlNav: false, 
directionNav: true, 
manualControls: '.custom-controls li a',
controlsContainer: '.flex-container'
} ); 
```

我在创建 flexslider 的 functions.php 文件中有这个：

```
echo '<div class="et_media flex-container">';
if ( $media ){
echo '<div class="flexslider"><ul class="slides">';
foreach( (array) $media as $et_media ){
echo '<li class="slide">';

// if else to get the slides

echo '</li>';
}
echo '</ul></div>';

/***
 * ul flexslider controller
 */           

echo '<div class="slider_controller">'; // use flexslider custom-controls in ul 
echo '<ul class="custom-controls">';
echo '<li class="photo-title">' . get_the_title() . '</li>'; 
echo '<li class="right">' . '<a href="#" class="next next-nav">' . "next" . '</a>' .  '</li>';
echo '<li class="right">' . '<a href="#" class="next viewnext">' . "view next" . '</a>' . '</li>';
echo '<li class="right">' . '<a href="#" class="prev prev-nav">' . "previous" . '</a>' . '</li>';
echo '</ul>';
echo '</div> <!-- end .slider_controller -->'; 
```

这是网址（开发网址）：

```
http://174.132.168.130/~samlewis/?page_id=400# 
```

建议非常感谢！

# jquery - jQuery：当 animate() 生效时，我们可以获得不断变化的值吗？

> ID：14841250
> 
> 赞同：1
> 
> 时间：2013-02-12T20:30:52.147
> 
> 标签：jquery

我正在使用此代码来扩大 div：

```
$("#bar").animate({width: '50%'}, 3000); 
```

我还想完全按照 $("#bar") div 中的变化来显示从 0% 到 50% 的 % 值。

请指教，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:36:06.057

这就是该`step`选项的用途。看看文档：

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

```
$("#bar").animate({
    width: '50%'
}, 
{
    duration: 3000,
    step: function(now, fx){
        // update here, now is the current value
        // something like this
        $(this).text(Math.floor(now) + "%");
    }
}); 
```

[http://jsfiddle.net/yFGm4/](http://jsfiddle.net/yFGm4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:42:55.803

```
$('#bar').animate({width: '50%'}, {
    duration: 3000,
    step: function(now, fx) {
        $('#bar_pct').text(now + '%');
    }
}); 
```

# php - 组织网站根目录的最佳方式

> ID：14841251
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:01.600
> 
> 标签：php, wordpress, http-headers, directory-structure

我制作了一个网站（基于 WP）并将所有内容都放在`/site`文件夹中。

我这样做了，考虑创建“自定义”系统，并将每个系统放在一个文件夹中，例如：`/promo`会去网站以外的其他地方......

但是，我已经尝试过`.htaccess`重定向和 PHP`location`重定向，当我尝试“共享”网站时，如果不包含 /site 文件夹，Facebook 不会检测到网站元...

`/site`另外，谷歌在没有WP 主文件夹的情况下访问网站时使用重定向是否有问题？我的意思是，一个来自 www.onesite.com 的人会将其“referer”标头作为 onesite 或 mysite？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:00:10.397

我觉得你在制造自己的问题。只需将 WordPress 放在文档根目录中，不必费心重写到子目录。WordPress 在更新时不会删除任何自定义文件或文件夹。

如果您有一些想要通过[http://www.example.com/promo 访问](http://www.example.com/promo)的自定义部分。将它放在`promo`文档根目录下的文件夹中。

如果想通过[http://promo.example.com](http://promo.example.com)访问自定义部分，只需创建新的[虚拟主机](http://httpd.apache.org/docs/2.2/vhosts/)。

# php - 在任何地方显示服务条款 (Joomla/Virtuemart 2.x)

> ID：14841252
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:02.007
> 
> 标签：php, joomla, virtuemart

我在显示服务条款时遇到了一些麻烦。

在购物车页面上一切正常：[http](http://mtxt.ibroken.ru/component/virtuemart/cart.html?Itemid=0) ://mtxt.ibroken.ru/component/virtuemart/cart.html?Itemid=0 （底部链接）打开带有文本的弹出窗口，由生成

```
<?php echo $this->cart->vendor->vendor_terms_of_service; ?> 
```

代码。

但是我在商店页面[http://mtxt.ibroken.ru/magazin.html](http://mtxt.ibroken.ru/magazin.html)上有按钮（右侧的顶部按钮），它必须显示相同的文本...

目前文本写入 /modules/mod_virtuemart_cart/tmpl/default.php 文件。但是如何使用 PHP 从商店界面中获取它？

pps。丑陋的英语，对不起:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:57:04.723

您需要修改 /modules/mod_virtuemart_cart/tmpl/default.php （或您的覆盖）并在第 3 行之后添加此代码：

```
vmJsApi::js ('facebox');
vmJsApi::css ('facebox');
$document = JFactory::getDocument ();
$document->addScriptDeclaration ("

    jQuery(document).ready(function($) {
        $('div#full-tos').hide();
        $('a#terms-of-service').click(function(event) {
            event.preventDefault();
            $.facebox( { div: '#full-tos' }, 'my-groovy-style');
        });
    });

"); 
```

并在第 53 行之后添加此代码

```
<div class="show_cart">
<?php
    if(!class_exists('VirtueMartModelVendor'))
        require(JPATH_VM_ADMINISTRATOR.DS.'models'.DS.'vendor.php');

    $vendor = VmModel::getModel('vendor');
   $vendor = $vendor->getVendor();
?>
    <br />
    <span style="z-index: 0;">
      <a href="<?php JRoute::_ ('index.php?option=com_virtuemart&view=vendor&layout=tos&virtuemart_vendor_id=1') ?>" class="terms-of-service" id="terms-of-service" rel="facebox" target="_blank">
        <?php echo JText::_ ('COM_VIRTUEMART_CART_TOS_READ_AND_ACCEPTED'); ?>
      </a>
    </span>
    <div id="full-tos">
      <h2><?php echo JText::_ ('COM_VIRTUEMART_CART_TOS'); ?></h2>
      <?php echo $vendor->vendor_terms_of_service; ?>
    </div>
</div> 
```

那应该做的伎俩！

# intersystems-ensemble - 在 when 条件下使用“In”

> ID：14841253
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:05.987
> 
> 标签：intersystems-ensemble

好的，所以我想确定 MSA 1 中的一个值是否在字符串列表中。我有

```
HL7.{MSA:1} In ("AE", "AR", "CE", "CR") 
```

这不起作用，那应该是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T00:46:06.410

想通了。它是

```
HL7.{MSA:1} In ("AE,AR,CE,CR") 
```

# google-chrome - 更改 Chrome 4xx 页面

> ID：14841256
> 
> 赞同：6
> 
> 时间：2013-02-12T20:31:10.160
> 
> 标签：google-chrome, google-chrome-extension, kiosk, kiosk-mode

我正在部署一个自助服务终端系统，该系统使用 Chrome 来显示一个在码头中运行的 java web 应用程序，该应用程序从一个 Windows 服务包装器开始。系统启动后，码头需要一些时间才能准备好提供内容，所以现在我有一个等待，然后在 kiosk 模式下启动 Chrome。这非常丑陋，不可靠且缓慢。

为了使其运行更顺畅，我正在尝试使用 Chrome 扩展程序来检测 4xx 错误并设置重新加载页面的超时。我按原样工作，但它仍然是一个丑陋的解决方案，因为页面每 3 秒刷新一次，并且在用户等待时向用户显示“糟糕！谷歌浏览器找不到...”页面。我可以在后台使用 ajax 请求解决第一个问题，以检测页面何时准备就绪，但我真的想向用户显示一个漂亮的“正在加载”屏幕而不是错误页面。我不是 Chrome 扩展程序开发人员，到目前为止，我所有使用扩展程序解决此问题的尝试都失败了。

我认为可以自定义错误页面，但我找不到有关如何执行此操作的任何信息，因为我在该主题上找到的所有搜索结果都围绕 512 最小尺寸问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T06:55:48.463

您可以使用自定义错误页面`webNavigation API`。为 onErrorOccurred 事件添加事件监听器并更新相关细节。

检查示例代码作为参考。

# 示范

### 清单.json

注册后台页面并将所有相关权限添加到清单文件。

```
{
    "name": "Customize error page",
    "description": "",
    "version": "1",
    "manifest_version": 2,
    "background": {
        "scripts": [
            "background.js"
        ]
    },
    "permissions": [
        "webNavigation",
        "<all_urls>"
    ],
    "web_accessible_resources": [
        "page.html"
    ]
} 
```

### 背景.js

如果出现任何错误，将重定向到我们的自定义页面，您可以将其自定义到所需的级别。

```
//Adding a Listener to Error Occured Event
chrome.webNavigation.onErrorOccurred.addListener(function (details) {
    // Updating the browser window with desired URL
    chrome.tabs.update(details.tabId, {
        url: chrome.extension.getURL("page.html")
    });
}); 
```

### page.html

一些琐碎的代码

```
<html>
    <style>
        body {
            background:yellow;
            position:absolute;
        }
    </style>

    <body>
        <div style="top: 200px;position: absolute;left: 500px;width: 500;font-size: 40px;">This is a Nice Description</div>
    </body>

</html> 
```

# 参考

*   [webNavigation.onErrorOccurred](https://developer.chrome.com/extensions/webNavigation.html#event-onErrorOccurred)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:00:02.977

转到选项，隐私设置，然后取消选中该框：

“使用网络服务帮助解决导航错误”

详细说明[在这里](http://www.dereuromark.de/2011/01/15/prevent-friendly-error-page/)。

# java - AsyncTask 进程

> ID：14841260
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:16.807
> 
> 标签：java, android, multithreading, user-interface, android-asynctask

我正在创建一个应用程序，当您使用用户名和密码登录时，它会从服务器请求信息。服务器的请求需要时间（15-20 秒），同时我想用几个词显示一个旋转条。但是我尝试了很多不同的`AsyncTask`课程，但我无法让它发挥作用。它可以获取信息，但会冻结屏幕直到响应。现在我只有一个新线程实现`runnable`. 我不确定我需要从代码中的哪个位置调用`AsyncTask`.

`onClick`触发`attemptLogin()`函数：

```
 public void onClick(View view) {
        attemptLogin();
    } 
```

在`attemptLogin()`功能上：

```
// more code
showProgress(true);
new Thread(new GetServerResponseRunnable()).start();
while (wait) {}
// more code 
```

Runnable 是：

```
public class GetServerResponseRunnable implements Runnable {
    @Override
    public void run() {
        response = getInfo.getTours(mUsername, mPassword);
        wait = false;   
    }       

} 
```

如您所见，它从不同的类中调用另一个函数。这是功能：

```
public String getTours(String username, String password) {
    String req = "GETALLDATA";
    String retStr = "";
    try {
        url = getURL(req, username, password);
        sendOutputLine(url, "");
        retStr = getReturnString();
        Log.d(LoginActivity.DEBUG_TAG, "getTours() return: " + retStr);
    } catch (Exception e) {
        Log.d(LoginActivity.DEBUG_TAG, "programm bommed client: " + e.getMessage());
    }
    return retStr;
} 
```

**我需要帮助，请**。主要是我想做的是：

```
 response = getInfo.getTours(mUsername, mPassword);
    wait = false; 
```

同时显示旋转杆。

谢谢

* * *

更新：2013 年 2 月 13 日

我使用了这段代码，但我得到了一个

```
02-13 09:07:16.142: E/AndroidRuntime(1046): java.lang.NullPointerException 
```

在行中：

```
this.dialog.setMessage(getResources().getString(R.string.login_progress_signing_in)); 
```

知道为什么吗？

```
public class LoginTask extends AsyncTask<Object, Void, String> {

    public Context context;
    public ProgressDialog dialog;

    public void BaseTask(Context context) {
        this.context = context;
        this.dialog = new ProgressDialog(context);
    }

    @Override
    protected void onPreExecute() {
        this.dialog.setMessage(getResources().getString(R.string.login_progress_signing_in));
        this.dialog.show();

    }

    @Override
    protected String doInBackground(Object... objects) {
        String name = (String) objects[0];
        String password = (String) objects[1];
        String response = getInfo.getTours(name , password );
        return response;
    }

    @Override
    protected void onPostExecute(String response) {
        if (dialog != null && dialog.isShowing())
            dialog.dismiss();

        LoginActivity.response = response; 

        // process response as you need
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:41:21.233

我想你需要这样的东西

```
public class LoginTask extends AsyncTask<Object, Void, String> {

    public Context context;
    public ProgressDialog dialog;

    public BaseTask(Context context) {
        this.context = context;
        this.dialog = new ProgressDialog(context);
    }

    @Override
    protected void onPreExecute() {
        this.dialog.setMessage(context.getResources().getString(R.string.loading));
        this.dialog.show();

    }

    @Override
    protected String doInBackground(Object... objects) {
        String name = (String) objects[0];
        String password = (String) objects[1];
        String response = getInfo.getTours(name , password );
        return response;
    }

    @Override
    protected void onPostExecute(String response) {
        if (dialog != null && dialog.isShowing())
            dialog.dismiss();

        // process response as you need
    }
} 
```

称之为任务

```
public void onClick(View view) {
    new LoginTask(YourActivity.this).execute(name, password);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:43:18.930

您的 AsyncTask 可能看起来像这样：

```
 private class DownloadFilesTask extends AsyncTask<Login, Void, Tours> {
     protected void onPreExecute(){
        //show the dialog here
     }

     protected Long doInBackground(URL... urls) {
         Tours response = getInfo.getTours(Login.mUsername, Login.mPassword);
         return response;
     }

     protected void onPostExecute(Long result) {
         //hide the dialog here
     }
 } 
```

我对您的项目了解得不够多，无法将其纳入其中，您必须对其进行一些自定义，但整体“方式”将与此类似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:40:43.453

尝试实现android登录活动。在你的 ADT 下创建新的活动选择：登录活动这将为你生成以下模板代码：

```
/**
 * Activity which displays a login screen to the user, offering registration as
 * well.
 */
public class LoginActivityTest extends Activity {
    /**
     * A dummy authentication store containing known user names and passwords.
     * TODO: remove after connecting to a real authentication system.
     */
    private static final String[] DUMMY_CREDENTIALS = new String[] {
            "foo@example.com:hello", "bar@example.com:world" };

    /**

         * The default email to populate the email field with.
         */
        public static final String EXTRA_EMAIL = "com.example.android.authenticatordemo.extra.EMAIL";

        /**
         * Keep track of the login task to ensure we can cancel it if requested.
         */
        private UserLoginTask mAuthTask = null;

        // Values for email and password at the time of the login attempt.
        private String mEmail;
        private String mPassword;

        // UI references.
        private EditText mEmailView;
        private EditText mPasswordView;
        private View mLoginFormView;
        private View mLoginStatusView;
        private TextView mLoginStatusMessageView;

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            setContentView(R.layout.activity_login_activity_test);

            // Set up the login form.
            mEmail = getIntent().getStringExtra(EXTRA_EMAIL);
            mEmailView = (EditText) findViewById(R.id.email);
            mEmailView.setText(mEmail);

            mPasswordView = (EditText) findViewById(R.id.password);
            mPasswordView
                    .setOnEditorActionListener(new TextView.OnEditorActionListener() {
                        @Override
                        public boolean onEditorAction(TextView textView, int id,
                                KeyEvent keyEvent) {
                            if (id == R.id.login || id == EditorInfo.IME_NULL) {
                                attemptLogin();
                                return true;
                            }
                            return false;
                        }
                    });

            mLoginFormView = findViewById(R.id.login_form);
            mLoginStatusView = findViewById(R.id.login_status);
            mLoginStatusMessageView = (TextView) findViewById(R.id.login_status_message);

            findViewById(R.id.sign_in_button).setOnClickListener(
                    new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            attemptLogin();
                        }
                    });
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            super.onCreateOptionsMenu(menu);
            getMenuInflater().inflate(R.menu.activity_login_activity_test, menu);
            return true;
        }

        /**
         * Attempts to sign in or register the account specified by the login form.
         * If there are form errors (invalid email, missing fields, etc.), the
         * errors are presented and no actual login attempt is made.
         */
        public void attemptLogin() {
            if (mAuthTask != null) {
                return;
            }

            // Reset errors.
            mEmailView.setError(null);
            mPasswordView.setError(null);

            // Store values at the time of the login attempt.
            mEmail = mEmailView.getText().toString();
            mPassword = mPasswordView.getText().toString();

            boolean cancel = false;
            View focusView = null;

            // Check for a valid password.
            if (TextUtils.isEmpty(mPassword)) {
                mPasswordView.setError(getString(R.string.error_field_required));
                focusView = mPasswordView;
                cancel = true;
            } else if (mPassword.length() < 4) {
                mPasswordView.setError(getString(R.string.error_invalid_password));
                focusView = mPasswordView;
                cancel = true;
            }

            // Check for a valid email address.
            if (TextUtils.isEmpty(mEmail)) {
                mEmailView.setError(getString(R.string.error_field_required));
                focusView = mEmailView;
                cancel = true;
            } else if (!mEmail.contains("@")) {
                mEmailView.setError(getString(R.string.error_invalid_email));
                focusView = mEmailView;
                cancel = true;
            }

            if (cancel) {
                // There was an error; don't attempt login and focus the first
                // form field with an error.
                focusView.requestFocus();
            } else {
                // Show a progress spinner, and kick off a background task to
                // perform the user login attempt.
                mLoginStatusMessageView.setText(R.string.login_progress_signing_in);
                showProgress(true);
                mAuthTask = new UserLoginTask();
                mAuthTask.execute((Void) null);
            }
        }

        /**
         * Shows the progress UI and hides the login form.
         */
        @TargetApi(Build.VERSION_CODES.HONEYCOMB_MR2)
        private void showProgress(final boolean show) {
            // On Honeycomb MR2 we have the ViewPropertyAnimator APIs, which allow
            // for very easy animations. If available, use these APIs to fade-in
            // the progress spinner.
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR2) {
                int shortAnimTime = getResources().getInteger(
                        android.R.integer.config_shortAnimTime);

                mLoginStatusView.setVisibility(View.VISIBLE);
                mLoginStatusView.animate().setDuration(shortAnimTime)
                        .alpha(show ? 1 : 0)
                        .setListener(new AnimatorListenerAdapter() {
                            @Override
                            public void onAnimationEnd(Animator animation) {
                                mLoginStatusView.setVisibility(show ? View.VISIBLE
                                        : View.GONE);
                            }
                        });

                mLoginFormView.setVisibility(View.VISIBLE);
                mLoginFormView.animate().setDuration(shortAnimTime)
                        .alpha(show ? 0 : 1)
                        .setListener(new AnimatorListenerAdapter() {
                            @Override
                            public void onAnimationEnd(Animator animation) {
                                mLoginFormView.setVisibility(show ? View.GONE
                                        : View.VISIBLE);
                            }
                        });
            } else {
                // The ViewPropertyAnimator APIs are not available, so simply show
                // and hide the relevant UI components.
                mLoginStatusView.setVisibility(show ? View.VISIBLE : View.GONE);
                mLoginFormView.setVisibility(show ? View.GONE : View.VISIBLE);
            }
        }

        /**
         * Represents an asynchronous login/registration task used to authenticate
         * the user.
         */
        public class UserLoginTask extends AsyncTask<Void, Void, Boolean> {
            @Override
            protected Boolean doInBackground(Void... params) {
                // TODO: attempt authentication against a network service.

                try {
                    // Simulate network access.
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    return false;
                }

                for (String credential : DUMMY_CREDENTIALS) {
                    String[] pieces = credential.split(":");
                    if (pieces[0].equals(mEmail)) {
                        // Account exists, return true if the password matches.
                        return pieces[1].equals(mPassword);
                    }
                }

                // TODO: register the new account here.
                return true;
            }

            @Override
            protected void onPostExecute(final Boolean success) {
                mAuthTask = null;
                showProgress(false);

                if (success) {
                    finish();
                } else {
                    mPasswordView
                            .setError(getString(R.string.error_incorrect_password));
                    mPasswordView.requestFocus();
                }
            }

            @Override
            protected void onCancelled() {
                mAuthTask = null;
                showProgress(false);
            }
        }
    } 
```

这`UserLoginTask`是您要进行身份验证的地方。这将允许您在尝试登录时显示微调器。“onPostExecute”将是您在验证后移至下一个活动的地方，或者返回登录屏幕并为用户显示一条消息，例如密码无效。

请注意，该模板包含 dummy_credentials，如果您使用服务器进行身份验证则不需要这些，并且它带有电子邮件和密码 textEdits，但您可以将它们更改为您想要的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T20:42:25.060

您需要实现一个新的扩展类，`AsyncTask`在一个名为的函数内完成所有广泛的工作`doInBackground`，并使用其他一些常用方法（如`onProgressUpdate`. 在网络上快速搜索“android asynctask tutorial”会产生一些不错的结果供您学习。

# c# - 存储浮点类型的大型二维数组的最佳方法

> ID：14841261
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:19.730
> 
> 标签：c#, sql-server, acoustics

我目前正在研究一个用 C# 编写的声学分析项目。

在能够正确计算用户选择的 wav 文件的特征之后，我现在开始进行模板匹配，该模板匹配将用于识别用户选择的 wav 文件中的关键事件。

作为下一步的一部分，我将读取 wav 文件，计算这些 wav 文件的特征，并且我必须存储特征计算的结果。

例如，由此创建的二维数组通常具有大小，`array[1800][30]`并且需要保存这些值。

我的问题是您建议存储这种比例的数组的最佳方法是什么，以便稍后在比较为用户选择的 wav 文件生成的特征（数组）与保存的数组的值时可以读取其中的值.

为了与当前选择的 wav 文件进行比较，我保存的数组越多，模板匹配的准确性就越高。所以我可能有需要保存`> 100`的大小数组。`array[1800][30]`

在此先感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:59:52.953

您可以使用**序列化**将任何对象从 RAM（随机存取存储器）保存到硬盘。
在序列化过程中，任何*可序列化*的对象都可以转换为字节流，这个字节流可以存储在文件或数据库中。反转操作称为**DeSerialization**。
[序列化基本概念](http://msdn.microsoft.com/en-us/library/vstudio/ms233843.aspx)
[.NET 和使用 C#](http://www.codeproject.com/Articles/1789/Object-Serialization-using-C)
[序列化的对象序列化](http://en.wikipedia.org/wiki/Serialization)

# ios - 在 Core Data 的表中设置默认 UITableViewCellAccessoryCheckmark，然后允许捕获新的选择

> ID：14841263
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:37.487
> 
> 标签：ios, core-data, uitableview

我有`SoundTableViewController`3 个静态行，表示声音选择选项。我想`UITableViewCellAccessoryCheckmark`从 Core Data 中的对象中加载具有相应名称/字符串值的行上的选定/默认值。不太难。但是，一旦成功添加复选标记，我希望用户能够选择和取消选择任何其他声音并添加/删除复选标记。用户做出最终选择后，我想将所选声音添加/更新到 Core Data 中的相应对象并保存。此外，如果用户离开`SoundTableViewController`并返回，我希望保持此选择。

我可以使用 indexPath in 中的标记来“检查和取消选中”一行`didSelectRowAtIndexPath`。在 Core Data 中加载属性时，我可以让默认选择被“选中”。但是，我不确定如何让这两件事同时发生。

这是我的`cellForRowAtIndexPath`和`didSelectRowAtIndexPath`方法。

**`cellForRowAtIndexPath`**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"sound";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath]; 

if(cell == nil )
{
    cell =[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

// Getting file name from path for title of cell
NSString *fileName = [soundsArray objectAtIndex:indexPath.row];
fileName = [[fileName lastPathComponent] stringByDeletingPathExtension];
cell.textLabel.text = fileName;
NSLog(@"FILENAME HAS A VALUE OF:   %@", fileName);

if ([indexPath compare:self.lastIndexPath] == NSOrderedSame)
    {

        //If sound has been selected previously, set sound selection
        if ([cell.textLabel.text isEqualToString:self.selectedSound])
            {
                cell.accessoryType = UITableViewCellAccessoryCheckmark;
            }

        //if no sound has been selected previously, set 'Bells' as default sound
        if ([cell.textLabel.text isEqualToString:@"Bells"])
            {
                cell.accessoryType = UITableViewCellAccessoryCheckmark;
            }
    }
else
    {
    cell.accessoryType = UITableViewCellAccessoryNone;
    }    

//The following is the original code to 'check and uncheck' rows
/*
if ([indexPath compare:self.lastIndexPath] == NSOrderedSame)
    {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    }
    else
    {
        cell.accessoryType = UITableViewCellAccessoryNone;
    }
*/

return cell;
} 
```

**`didSelectRowAtIndexPath`**

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

self.lastIndexPath = indexPath;
[self.tableView reloadData];

} 
```

我假设我需要的逻辑都应该进入`cellForRowAtIndexPath`. 但是，也许最好的方法是进行`didSelectRowAtIndexPath`新的选择并保存到 Core Data？

同样，我想：

1.  在开始时在选定/默认行上加载复选标记

2.  允许用户从表中选择任何声音并仅对当前选定行进行复选标记

3.  最终选择时将所选行从 Core Data 保存到当前对象

任何见解或指示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:42:36.573

首先，您甚至在创建单元格之前就设置了单元格文本。

```
// Getting file name from path for title of cell
NSString *fileName = [soundsArray objectAtIndex:indexPath.row];
fileName = [[fileName lastPathComponent] stringByDeletingPathExtension];
cell.textLabel.text = fileName;
NSLog(@"FILENAME HAS A VALUE OF:   %@", fileName);

if(cell == nil )
{
    cell =[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
} 
```

我认为您的第一个单元格中可能没有任何文字？可以？另外，当视图首次出现时，您是如何初始化 self.lastIndexPath 和 self.selectedSound 的？

# multithreading - 多线程 IDirect3DDevice9::CreateDevice 冻结

> ID：14841267
> 
> 赞同：0
> 
> 时间：2013-02-12T20:31:55.027
> 
> 标签：multithreading, directx, directx-9

我正在将我的渲染器移动到另一个线程。在此过程中，我对 IDirect3D9::CreateDevice: 进行了两次调用： 1\. 从“渲染线程” - 为了创建渲染设备并正确调整其大小 2\. 从“主线程” - 这里我正在创建一个用于编译着色器等的空设备。

这些调用当然可以重叠（同时进行），所以我将它们与关键部分同步。

问题是其中一个调用有时会冻结。DirectX 在此之前不会发出任何警告，因此我怀疑存在内部死锁。

我研究了文档，其中提到在单个设备上运行的所有调用，尤其是 IDirect3D9::CreateDevice、IDirect3DDevice9::TestCooperativeLevel 和 IDirect3DDevice9::Reset，都需要从同一个线程调用 - 但我已经涵盖了。

那么我错过了什么？谁能告诉我？

谢谢， 帕克萨斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:22:09.040

我对此只有模糊的记忆，但是：

1.  [文档](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb174313%28v=vs.85%29.aspx)声明“任何创建、释放或重置设备的调用都必须使用与焦点窗口的窗口过程相同的线程来完成。”
2.  我记得，即使您尝试使用 NULL HWND 创建设备，Direct3D 还是会在内部为您的应用程序挖掘一个。

因此，您的一个线程肯定违反了第一点。

# android - 带有滑动菜单的 Android MapView 隐藏菜单

> ID：14841272
> 
> 赞同：5
> 
> 时间：2013-02-12T20:32:03.840
> 
> 标签：android, android-layout, android-mapview, android-maps-v2

我在使用此滑动菜单[https://github.com/iPaulPro/SlidingMenu](https://github.com/iPaulPro/SlidingMenu)的活动中有一个 android maps api v2 的地图视图。除了在地图页面上，滑动菜单效果很好。滑动菜单上有一个黑色视图，它是地图的确切大小。这是一个将地图高度设置为 100dp 的示例，以概述我的意思。

![查看问题](../Images/272e08973e5b9950b58021acac123a59.png)

如果我触摸那个视图，它就会消失。我将如何摆脱它或使其透明？我已经尝试过 requestTransparentRegion() 技巧。那里没有骰子。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-15T15:10:34.933

发现这个堆栈溢出帖子[ViewPager with Google Maps API v2：神秘的黑色视图](https://stackoverflow.com/questions/13837697/viewpager-with-google-maps-api-v2-mysterious-black-view)并使用这个类代替法线贴图片段。

```
package com.myapp.gms.maps;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.widget.FrameLayout;
import com.google.android.gms.maps.SupportMapFragment;

/**
 * @author btate
 */
public class TransparentSupportMapFragment extends SupportMapFragment {

    public TransparentSupportMapFragment() {}

    @Override
    public View onCreateView(LayoutInflater inflater, 
                                 ViewGroup view, 
                                 Bundle savedInstance) {

        View layout = super.onCreateView(inflater, view, savedInstance);
        FrameLayout frameLayout = new FrameLayout(getActivity());
        frameLayout.setBackgroundColor(
           getResources().getColor(android.R.color.transparent));
        ((ViewGroup) layout).addView(frameLayout,
            new ViewGroup.LayoutParams(
               LayoutParams.MATCH_PARENT, 
               LayoutParams.MATCH_PARENT
            )
        );
        return layout;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T09:19:22.837

这个问题还有另一种解决方案。我在另一个片段中显示 MapFragment。MapFragment 被动态添加到 FrameLayout 中。

解决方案是使用滑动菜单的打开和关闭事件`frameLayout.setVisibility(View.Visible)`。`frameLayout.setVisibility(View.Gone)`它不需要添加额外的视图。黑色区域完全消失了。

```
getSlidingMenu().setOnOpenListener(
    new OnOpenListener() {
        @Override
        public void onOpen() {
            frameLayout.setVisibility(View.GONE);
        }
    }
);

getSlidingMenu().setOnClosedListener(
    new OnClosedListener() {

        @Override
        public void onClosed() {
            frameLayout.setVisibility(View.VISIBLE);
        }
    }
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T04:43:34.953

TransparentSupportMapFragment 解决了 android 2.3.7 的问题 谢谢！

# r - 使用 xpathapply 只取 webscrapes 向量中每一行的第一个 h2 节点

> ID：14841278
> 
> 赞同：0
> 
> 时间：2013-02-12T20:32:19.297
> 
> 标签：r, xpath, web-scraping, sapply

我正在尝试解析抓取的 html 的（大）向量，更具体地说是 ，但向量中的某些页面中有两个，因此替换最终会得到比数据更多的行。我的问题：我如何只取每个 obs 中的第一个 //h2 ？

这是我尝试过的代码：

```
data$header = unlist(xpathSApply(htmlParse(data$html, asText=TRUE), '(//h2)[1]', xmlValue)) 
```

这只给了我第一个。这段代码给了我所有的h2：

```
data$header = xpathApply(htmlParse(philly$html, asText=TRUE), '//descendant::h2[1]', xmlValue) 
```

任何帮助表示赞赏

样品有两个：

```
<div id="tutors">

 <h1>Tutors</h1>
<div class="tutor">
<h2>John</h2>
 <p>...</p> 
```

```
<div class="tutor">
<h2>Mary</h2>
<p>...</p>
</div>

<div class="tutor">
<h2>David</h2>
<p>...</p>
</div>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:24:23.960

通过包含整个根路径来解决它：

```
data$header = unlist(xpathApply(htmlParse(data$html, asText=TRUE), '/html/body/h2', xmlValue)) 
```

# macos - 使用 IOKit 获取 USB 设备的 BSD 名称以写入设备？

> ID：14841279
> 
> 赞同：7
> 
> 时间：2013-02-12T20:32:19.210
> 
> 标签：macos, core-foundation, iokit

我正在尝试在 MacOS 下使用 IOKit 确定虚拟串口的 BSD 名称。

我有一个看起来像虚拟串行端口的 USB CDC 设备，我想获取 BSD 设备路径，以便我可以执行 fopen("/dev/tty.usbmodem123")。我有一个程序，它获取 VID 和 PID 并等待设备插入，然后我想使用 BSD 名称写入设备。该设备在每个系统上的安装方式都不同，我正在尝试将其用作教学工具，因此我需要在写入之前搜索设备，而无需手动检查 /dev/tty.* 以了解设备的安装位置。

我有 3 个问题。

首先，可以使用 获取虚拟串行端口的 BSD 名称`CFSTR(kIOBSDNameKey)`吗？ `IORegistryEntrySearchCFProperty()`并`FindProp()`始终返回“null”。有谁知道非块设备是否可以返回 BSD 名称？我目前正在这样做：

`bsdName = IORegistryEntrySearchCFProperty(p_usb_ref, kIOServicePlane, CFSTR(kIOBSDNameKey), kCFAllocatorDefault, kIORegistryIterateRecursively );`

其次，我已经能够获得服务平面名称：IOService:/AppleACPIPlatformExpert/PCI0@0/AppleACPIPCI/OHC1@4/AppleUSBOHCI/Intro to Electronics@4100000 这对应于一个挂载点：/dev/tty.usbmodem411有人知道如何将服务平面名称翻译成开发树名称吗？

第三，我是不是太复杂了？我已经知道设备 io 句柄，有没有办法使用它将数据写入设备？我只需要发送一些 ASCII 字节来闪烁一些 LED。

任何建议将不胜感激。

`EDIT:`

在花了更多时间查看这个之后，我发现我的问题是我在加载 CDC 驱动程序之前查询 BSD 名称。我目前正在获取 BSD 名称，然后整理出 VID 和 PID。

解决我上面问题的代码是：

```
matchingDictionary = IOServiceMatching(kIOSerialBSDServiceValue);
CFDictionarySetValue(matchingDictionary, CFSTR(kIOSerialBSDTypeKey), CFSTR(kIOSerialBSDModemType));
kernResult = IOServiceGetMatchingServices(kIOMasterPortDefault, matchingDictionary, &iter); 
```

然后您遍历`iter`以找到具有正确 ID 的设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-30T23:10:36.057

这是我在添加 USB 串行设备时与 IONotification 一起使用的：在 10.11 下它是空的。在尝试了很多事情之后，这是我的解决方案：

```
while ((usbDevice = IOIteratorNext(iterator)))
{
  //when hotplugging under OSX 10.11:
  sleep(1);//otherwise the property will be empty.

  CFStringRef deviceBSDName_cf = (CFStringRef) IORegistryEntrySearchCFProperty (usbDevice,
  kIOServicePlane,
  CFSTR (kIOCalloutDeviceKey),
  kCFAllocatorDefault,
  kIORegistryIterateRecursively );

  NSLog(@"device path: %@", deviceBSDName_cf);

} 
```

它应该找到类似的内容：/dev/cu.xxxxx
希望它对某人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-05T23:27:58.627

也许在 OS X 10.10 中情况发生了变化？您的最后一个代码段似乎`/dev/tty.usbmodem00054741`在我的系统上找不到该设备：

```
io_iterator_t devlisthndl = 0;
CFMutableDictionaryRef matchingDictionary = IOServiceMatching(kIOSerialBSDServiceValue);
CFIndex dict_count = CFDictionaryGetCount(matchingDictionary);
CFDictionarySetValue(matchingDictionary, CFSTR(kIOSerialBSDTypeKey), CFSTR(kIOSerialBSDModemType));
kern_return_t kernResult = IOServiceGetMatchingServices(kIOMasterPortDefault, matchingDictionary, &devlisthndl);

(lldb) p matchingDictionary
(CFMutableDictionaryRef) $3 = 0x0000610000267780 @"0 entries" 
```

您最终是如何获得挂载点字符串的？

# algorithm - 一个聪明的自制模数实现

> ID：14841280
> 
> 赞同：9
> 
> 时间：2013-02-12T20:32:25.037
> 
> 标签：algorithm, math, modulus, plc

我正在用一些遗留软件（RSLogix 500，别问）对 PLC 进行编程，它本身不支持模数运算，但我需要一个。我无权访问：模数、整数除法、局部变量、截断操作（尽管我可以通过舍入来破解它）。此外，我可以使用的所有变量都按数据类型排列在表格中。最后，它应该适用于浮点小数，例如`12345.678 MOD 10000 = 2345.678`.

如果我们做我们的等式：

```
dividend / divisor = integer quotient, remainder 
```

有两个明显的实现。

实现1：进行浮点除法：`dividend / divisor = decimal quotient`. 然后拼凑一个截断操作，这样你就可以找到`integer quotient`. 将它乘以`divisor`并找到 和 之间的差异`dividend`，从而得到`remainder`。

我不喜欢这样，因为它涉及到一堆不同类型的变量。我不能将变量“传递”给子程序，所以我只需要分配位于多个不同变量表中的一些全局变量，这很难理解。不幸的是，“难以理解”很重要，因为它需要足够简单，让维护人员可以搞砸。

实现 2：创建一个循环，使得 while `dividend > divisor` `divisor = dividend - divisor`. 这是非常干净的，但它违反了 PLC 编程的一条重要规则，即永远不要使用循环，因为如果有人无意中修改了索引计数器，你可能会陷入无限循环，机器会发疯或出现不可恢复的故障。Plus 回路很难进行维护故障排除。另外，我什至没有循环指令，我必须使用标签和跳转。哇。

所以我想知道是否有人有任何聪明的数学技巧或比这些更聪明的模数实现。我可以访问 + - * /、指数、sqrt、三角函数、日志、abs 值和 AND/OR/NOT/XOR。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T22:22:27.087

你要处理多少位？您可以执行以下操作：

```
if dividend > 32 * divisor  dividend -= 32 * divisor
if dividend > 16 * divisor  dividend -= 16 * divisor
if dividend > 8 * divisor  dividend -= 8 * divisor
if dividend > 4 * divisor  dividend -= 4 * divisor
if dividend > 2 * divisor  dividend -= 2 * divisor
if dividend > 1 * divisor  dividend -= 1 * divisor
quotient = dividend 
```

只需展开与`dividend`. 一定要小心那些溢出的乘法。这就像您的 #2 一样，只是它需要 log(n) 而不是 n 次迭代，因此完全展开是可行的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-13T18:13:52.190

如果您不介意过于复杂的事情并浪费计算机时间，您可以使用周期性三角函数计算模数：

```
atan(tan(( 12345.678 -5000)*pi/10000))*10000/pi+5000   =   2345.678 
```

不过说真的，减去 10000 一次或两次（你的“实现 2”）会更好。一般浮点模数的常用算法需要许多位级操作，这对您来说可能是不可行的。参见例如[http://www.netlib.org/fdlibm/e_fmod.c](http://www.netlib.org/fdlibm/e_fmod.c)（算法很简单，但由于特殊情况，代码很复杂，因为它是为 IEEE 754 双精度数编写的，假设没有 64 位整数类型）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-13T11:43:24.160

这一切似乎都过于复杂了。您有一个在 10000 处滚动的编码器索引，并且对象沿着您在任何给定点跟踪其位置的线滚动。如果您需要沿线转发项目停止点或动作点，只需添加所需的英寸数，如果您的目标结果大于 10000，则立即减去 10000。

或者或另外，每次 PLC 扫描时，您总是会获得一个新的编码器值。如果当前值和上一个值之间的差异为负值，您可以激活工作触点以标记回绕事件并对该扫描中的任何计算进行适当的更正。（**或增加一个辅助计数器，如下所示）

在不了解实际问题的情况下，很难提出更具体的解决方案，但肯定有更好的解决方案。我认为这里根本不需要 MOD。此外，地板上的人会感谢你没有用模糊的巫师东西填满机器。

我引用 ：

> 最后，它必须适用于浮点小数，例如 12345.678 MOD 10000 = 2345.678

有一个出色的功能可以做到这一点 - 它是**减法**。为什么它需要比这更复杂？如果您的输送线实际上长于 833 英尺，则滚动第二个计数器，该计数器在主索引翻转时递增，直到您有足够的距离覆盖您需要的地面。

例如，如果您需要 100000 英寸的传送带内存，您可以有一个在 10 处翻转的辅助计数器。如上所述，可以轻松检测到主编码器翻转，并且每次都增加辅助计数器。那么，您的工作编码器位置是计数器值加上当前编码器值的 10000 倍。仅在扩展单元中工作，并使辅助计数器以您需要的任何值翻转，以免丢失任何部件。问题再次简化为一个简单的减法（如上所述）。

例如，我将此技术与行星齿轮旋转零件支架一起使用。我有一个编码器，每次初级旋转都会翻转一次，而行星齿轮卫星部件（它们本身围绕定子齿轮旋转）需要 43 次初级旋转才能返回到相同的起始方向。使用在主编码器翻转点处递增（或递减，取决于方向）的简单计数器，它可以让您完全绝对地测量零件所在的位置。在这种情况下，辅助计数器在 43 处翻转。

这对于直线输送机的工作原理相同，唯一的区别是直线输送机可以无限行驶。那么问题只需要受到线路上最坏情况部分所采用的最长线性路径的限制。

需要注意的是我从未使用过 RSLogix，这是一般的想法（我在这里使用了通用符号，我的语法可能有点错误，但你应该明白）

![RSLogix 示例](../Images/6054e02f7dc4a046cac9466d79b5c796.png)

有了上述内容，您最终会得到一个值，该值`ENC_EXT`基本上将您的编码器从 10k 英寸的编码器转换为 100k 英寸的编码器。我不知道您的输送机是否可以反向运行，如果可以，您还需要处理向下计数。如果您的程序的整个其余部分仅适用于该`ENC_EXT`值，那么您甚至不必担心您的编码器仅达到 10k 的事实。它现在达到 100k（或任何你想要的），并且可以用减法而不是模数来处理环绕。

后记：

PLC首先是状态机。PLC 程序的最佳解决方案通常是与此想法一致的解决方案。如果你的硬件不足以完全代表机器的状态，那么 PLC 程序应该尽最大努力用它所拥有的信息来填补缺失的状态信息的空白。上述解决方案做到了这一点——它采用了不足 10000 英寸的状态信息并将其扩展以适应流程的要求。

这种方法的好处是您现在保留了绝对状态信息，不仅针对输送机，还针对生产线上的任何部件。您可以向前和向后跟踪它们以进行故障排除和调试，并且您有一个更简单、更清晰的坐标系可用于未来的扩展。通过模数计算，您将丢弃状态信息并尝试以功能方式解决个别问题 - 这通常不是使用 PLC 的最佳方式。你不得不忘记你从其他编程语言中学到的东西，并以不同的方式工作。PLC 是一种不同的野兽，它们在这样处理时效果最好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-16T20:45:34.557

您可以使用子例程来完成您正在谈论的事情。你可以把棘手的代码藏起来，这样维护技术人员就永远不会遇到它。对于您和您的维护人员来说，这几乎肯定是最容易理解的。

自从我使用 RSLogix500 以来已经有一段时间了，所以我可能会弄错几个术语，但你会明白的。

为您的浮点和整数分别定义一个数据文件，并按照 MOD_F 和 MOD_N 的行给它们一些符号。如果你让这些足够吓人，维护技术人员就不要管它们了，你所需要的只是在数学过程中传递参数和工作空间。

如果你真的担心它们会弄乱数据表，有办法保护它们，但我忘记了它们在 SLC/500 上是什么。

接下来，如果可能的话，定义一个子程序，在数字上远离现在使用的子程序。将其命名为 MODULUS。同样，维护人员几乎总是远离 SBR，如果它们听起来像编程名称。

在 JSR 指令之前的梯级中，将要处理的变量加载到 MOD_N 和 MOD_F 数据文件中。注释这些梯级，说明它们为 MODULUS SBR 加载数据。让任何有编程背景的人都能清楚地看到这些评论。

仅在需要时有条件地调用您的 JSR。维护技术人员不会打扰非执行逻辑的故障排除，因此如果您的 JSR 未处于活动状态，他们很少会查看它。

现在，您拥有了自己的围墙小花园，您可以在其中编写循环而无需维护。只使用那些数据文件，不要假设任何东西的状态，但那些文件是你所期望的。换句话说，您不能信任间接寻址。只要您在 MODULUS JSR 中定义索引，索引寻址就可以。不要相信任何传入的索引。使用 MOD_N 文件中的一个单词、一个跳转和一个标签来编写 FOR 循环非常容易。您的整个实施#2 应该少于十个梯级左右。我会考虑使用表达式指令或其他东西......让您只需输入表达式的指令。该指令可能需要 504 或 505。适用于组合的浮点/整数数学。检查结果以确保四舍五入不会杀死您。

完成后，尽可能完美地验证您的代码。如果此代码曾经导致数学溢出并使处理器出现故障，您将永远不会听到它的结束。如果你有一个模拟器，用奇怪的值在模拟器上运行它（以防它们以某种方式弄乱函数输入的加载），并确保 PLC 没有故障。

如果你做了所有这些，没有人会意识到你在 PLC 中使用了常规的编程技术，你会没事的。只要它有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T12:21:25.253

这是一个基于@Keith Randall 答案的循环，但它也保留了减法除法的结果。为了清楚起见，我保留了 printf。

```
#include <stdio.h>
#include <limits.h>
#define NBIT (CHAR_BIT * sizeof (unsigned int))

unsigned modulo(unsigned dividend, unsigned divisor)
{
unsigned quotient, bit;

printf("%u / %u:", dividend, divisor);

for (bit = NBIT, quotient=0; bit-- && dividend >= divisor; ) {
        if (dividend < (1ul << bit) * divisor) continue;
        dividend -= (1ul << bit) * divisor;
        quotient += (1ul << bit);
        }
printf("%u, %u\n", quotient, dividend);
return dividend; // the remainder *is* the modulo
}

int main(void)
{
modulo( 13,5);
modulo( 33,11);
return 0;
} 
```

# matlab - 如何使用 CSVIMPORT 获取一行

> ID：14841294
> 
> 赞同：1
> 
> 时间：2013-02-12T20:33:43.910
> 
> 标签：matlab

如何在matlab中使用CSVIMPORT函数将一行csv文件作为一维向量访问？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:44:40.777

像这样

```
 [C1 C2 C3] = CSVIMPORT( fileName, 'columns', {'C1', 'C2', C3'}, ... ) 
```

阅读此内容以了解您可以在[csvimport中设置的参数](http://www.mathworks.com/matlabcentral/fileexchange/23573-csvimport)

# php - 如何使用 href 提交表单？

> ID：14841295
> 
> 赞同：0
> 
> 时间：2013-02-12T20:33:47.420
> 
> 标签：php, javascript, html, anchor

我正在使用它`onclick='document.forms['form_name'].submit(); return false;'`，但这并不像我拥有的​​那样工作`href=results.php?page_no=1`，有动态链接，示例显示使这项工作我需要使用`href="#"`，但知道如何提交表单而不是导航到`page2`？因为我想在会话中保存复选框值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:53:44.210

将类添加到您的 hrefs (class="pagination") 和 id (id="form") 到您的表单。然后你可以使用 Jquery 框架来处理这些东西。

```
$(".pagination").click(function(){  
// get page id, set form action with params
$("#formId").submit();

return false;  
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:03:22.417

**一些选项：**

1）使用jQuery AJAX，序列化并发布表单数据，然后在onSuccess回调上重定向（location.href）。像这样的东西：

```
$.post("submitform.php", 
       $("form").serialize(),  
       function(data){location.href='results.php?page_no=2';}
      ); 
```

2) 使用表单标签上的“目标”将表单发布到一个命名的隐藏 iFrame。如果这真的只是一种尽力而为的记录，您不需要等待页面加载，请求应该足够了，您可以继续到下一页。像这样的东西：

```
<iframe="targetname" style="display:none;" />
<form name="myform" target="targetname" method="post" action="submitform.php">
....
</form>
<a href="page2.php" onClick="document.forms['myform'].submit(); return true;">
Click Here
</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:42:38.087

在这里，我将 page2 替换为 Google 只是为了测试

```
<a href="#" onclick="document.forms['test'].submit(); return false;">Submit</a>
<form method="get" action="https://www.google.com/search?q=test" name="test">
<input name="Checkbox1" type="checkbox" />
</form> 
```

编辑：

```
<a href="page2.php?page=2" onclick="document.test.action =encodeURIComponent(this.getAttribute('href')); document.forms['test'].submit(); return false;">Submit</a>
<form method="get" action="" name="test">
<input name="Checkbox1" type="checkbox" />
</form> 
```

没有 encodeURIComponent(this.getAttribute('href') 参数会丢失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T20:57:22.147

你有一个糟糕的设计。

您不能在表单单击上执行多个竞争操作并期望它起作用。

您需要让链接被点击并让它加载另一个页面，或者如果您只是设置一些会话变量（尽管使用查询字符串参数或 cookie 设置它会好得多），您可以使用 Ajax 请求异步发送。

# git - 詹金斯和吉特？

> ID：14841298
> 
> 赞同：18
> 
> 时间：2013-02-12T20:33:54.777
> 
> 标签：git, github, jenkins

我的公司现在正在使用 Subversion，我们让 Jenkins 拉动 SCM 进行更改，如果有任何更改，它将执行 Maven 构建。

我们正在迁移到 Git，但我看不到任何方法可以拉动 Git 存储库以进行更改……我错过了什么吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-12T21:10:36.377

您可以配置 Jenkins Git 插件来轮询您的存储库以进行更改，但推荐的方法是在您的存储库中添加一个 post-receive（也称为 post-commit）挂钩。这样，Jenkins 在每次提交时都会立即收到通知。

你可以在这里阅读更多：[https ://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-01T10:33:09.953

您可能没有安装 Git 插件，这就是您看不到选项的原因。您将永远不必为 subversion 执行此操作，因为默认情况下是该插件。您可以使用 Jenkins 中提供的自动安装程序来安装插件，也可以手动安装（如果您在公司防火墙后面很有用）。

一些有用的链接：Git 插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)

GitHub 插件：[https ://wiki.jenkins-ci.org/display/JENKINS/GitHub+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/GitHub+Plugin)

Bitbucket 插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Bitbucket+OAuth+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Bitbucket+OAuth+Plugin)

谷歌代码插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Repo+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Repo+Plugin)

Git 参数插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Git+Parameter+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Git+Parameter+Plugin)

GitLab 钩子插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Gitlab+Hook+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Gitlab+Hook+Plugin)

所有插件的大列表：[https ://wiki.jenkins-ci.org/display/JENKINS/Plugins#Plugins-Sourcecodemanagement](https://wiki.jenkins-ci.org/display/JENKINS/Plugins#Plugins-Sourcecodemanagement)

[CloudBees](https://en.wikipedia.org/wiki/CloudBees)提供 Jenkins 持续集成和 Git 托管即服务 - 这也可能对您有所帮助[http://www.cloudbees.com/#slide-2](http://www.cloudbees.com/#slide-2)。

祝您迁移顺利。在执行类似迁移时，我们在 Maven 发布插件中发现了一些问题——如果我必须再次这样做，我会事先发布一些专业版本。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-07-04T07:33:31.713

首先您需要配置 Jenkins Git 插件，其中包括 Git 客户端、Git hook up 等。然后转到 GitHub 帐户并导航到

设置 → 服务挂钩 → WebHook URL。

您需要提供运行 Jenkins 的机器主机名以及 Jenkins 端口号。

> WebHook URL 类似于 - http://host_name:8080/github-webhook/（其中 8080 是默认的 Jenkins 端口）

当您将更改推送到 GitHub 时，GitHub 将使用 POST 请求访问这些 WebHook URL，并传递有关推送的信息。

Jenkins 提供了一些构建触发器选项，如下所示 -

1.  将更改推送到 GitHub 时构建。
2.  轮询单片机
3.  以一定的时间间隔构建
4.  ETC...

选择最适合您要求的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T21:11:16.677

Jenkins 有一个[Git 插件](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)，其中包含许多您可能需要的有用信息。[这](http://kohsuke.org/2011/12/01/polling-must-die-triggering-jenkins-builds-from-a-git-hook/)是一个可能对您也有帮助的帖子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-19T08:54:08.037

为了在 Jenkins 中使用 Git，需要安装以下两个插件：

```
1\. Git-Client-plugin
2\. Git-plugin 
```

第一个插件（Git-Client-plugin）是执行 git 操作（git add、git commit、git push、git clone 等）的低级 API。

第二个插件 (Git-plugin) 添加 Git 作为 Jenkins 作业的 SCM 选项。

第二个插件依赖于第一个插件的功能，因此两者都必须存在，Git 才能与 Jenkins 一起工作。

# grails - 如何有条件地禁用表单输入字段

> ID：14841302
> 
> 赞同：4
> 
> 时间：2013-02-12T20:34:03.927
> 
> 标签：grails, grails-2.0

假设我有一个域对象 Teacher，它有两个字段 String 名称、TeacherType TeacherType，其中 TeacherType 是一个包含 AssitantProfessor、AssociateProfessor、Professor 的枚举。

在我使用 grails run-target generate-all Teacher 生成视图后，它会生成一个用于创建和编辑 Teacher 的 _form.gsp。在编辑视图中，我只希望名称是可编辑的，但 TeacherType 一旦创建就不可修改（这只是一个示例，要求某些字段在创建后不能更新）。在创建视图中，TeacherType 和 name 都应该是可编辑的。

由于 create.gsp 和 edit.gsp 都呈现 _form 模板，这里首选的方法是什么？

1.  创建两个单独的模板，即 _formCreate.gsp 、 _formEdit.gsp；或者
2.  在 create.gsp 和 edit.gsp 中传入模型映射并在 _form.gsp 中使用它们来有条件地渲染视图？例如

在 create.gsp 中：

```
 <fieldset class="form">
        <g:render template="form" model="[teacherInstance: teacherInstance, 'mode':'create']"/>
    </fieldset> 
```

在edit.gsp

```
 <fieldset class="form">
        <g:render template="form" model="[teacherInstance: teacherInstance, 'mode':'edit']"/>
    </fieldset> 
```

在 _form.gsp 中

```
 <g:if test="${mode == 'edit'}">
        <g:select name="teacherType" from="${TeacherType?.values()}" keys="${TeacherType.values()*.name()}" required="" value="${teacherInstance?.teacherType?.name()}" disabled="disabled"/>
    </g:if>
    <g:else>
        <g:select name="teacherType" from="${TeacherType?.values()}" keys="${TeacherType.values()*.name()}" required="" value="${teacherInstance?.teacherType?.name()}" disabled="false"/>
    </g:else> 
```

方法 2 有效，但我想如果条件语句的数量增加，遵循方法 1 并拆分表格可能会更好。

还有另一种我不知道的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T22:28:10.197

（以及许多其他表单字段标签）的`disabled`属性可以是布尔值表达式：`<g:select>``<g:...>`

```
<g:select name="teacherType" from="${TeacherType?.values()}"
  keys="${TeacherType.values()*.name()}" required=""
  value="${teacherInstance?.teacherType?.name()}"
  disabled="${mode == 'edit'}"/> 
```

这将呈现为`disabled="disabled"`好像表达式的计算结果为 true，并且如果表达式为 false，则呈现为缺少`disabled`属性（即不会禁用该字段）。您甚至可以在模型中使用布尔条目，例如使用

```
model="[teacherInstance: teacherInstance, editing:true]" 
```

（或`editing:false`分别）然后`disabled="${editing}"`在 上说`<g:select>`。

# javascript - 如何测试 JavaScript 缩小输出

> ID：14841304
> 
> 赞同：16
> 
> 时间：2013-02-12T20:34:08.757
> 
> 标签：javascript, unit-testing

我们最近升级到了 JavaScript 缩小库的更新版本。

在测试团队进行了大量的质量保证工作后，我们发现我们的 minifier 的新版本存在一个问题，改变了代码块背后的意图和含义。

（人生教训：除非你真的确信你需要新版本，否则不要升级 JS 缩小器。）

minifier 用于客户端 JavaScript 代码，重点强调 DOM 相关活动，而不是“业务逻辑”。

缩小器升级破坏的简化示例：

```
function process(count)
{
     var value = ""; 
     value += count; //1\. Two consecutive += statements
     value += count;
     count++;        //2\. Some other statement
     return value;   //3\. Return
} 
```

被错误地缩小为以下内容：

```
function process(n){var t="";return t+n+n,n++,t} 
```

虽然我们可以编写一些单元测试来潜在地捕捉一些问题，但鉴于 JavaScript 对 DOM 交互（数据输入等）的影响很大，如果没有用户测试（非自动化），很难进行彻底的测试。我们曾考虑使用像 Esprima 这样的 JS 到 AST 库，但考虑到可以对缩小代码进行的更改的性质，它会产生太多的误报。

我们还考虑尝试编写具有代表性的测试，但这似乎是一项永无止境的任务（并且可能会漏掉案例）。

仅供参考：这是一个非常复杂的 Web 应用程序，包含数十万行 JavaScript 代码。

我们正在寻找一种方法来测试缩小过程，而不是“再次彻底地测试所有内容，然后重复”。我们想在这个过程中应用更多的严谨/科学。

理想情况下，如果我们有更好的科学测试方法，我们可以尝试多个 minifier，而不必担心每个 minifier 都会以新的微妙方式破坏我们的代码。

更新：

我们的一个想法是：

1.  用旧版本缩小
2.  美化它
3.  用新版本缩小，
4.  美化，和
5.  视觉上的差异。

这看起来确实是个好主意，但是差异如此普遍，以至于差异工具几乎将每一行都标记为不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:16:01.370

在我看来，您需要开始在 CI（持续集成环境）中使用自动化单元测试。QUnit 已经被抛弃了，但实际上 QUnit 是一个非常弱的测试系统，它的断言至少是准系统（它甚至没有真正使用好的基于断言的语法）。它只能勉强称得上 TDD，也不能很好地处理 BDD。

就我个人而言，我推荐[Jasmine](http://pivotal.github.com/jasmine/)和[JsTestDriver](http://code.google.com/p/js-test-driver/wiki/GettingStarted)（它可以使用其他 UT 框架或它自己的框架，并且速度非常快......尽管它有一些我真的希望他们能解决的稳定性问题），并设置可以检查的单元测试通过多重比较缩小过程。

一些比较可能需要：

*   原始代码及其功能按预期运行
*   与缩小代码相比（这是 BDD 的用武之地，期望在缩小代码中具有相同的功能性能/结果）
*   我什至会更进一步（取决于您的缩小方法），并进行一个测试，然后美化缩小并进行另一次比较（这使您的测试更加健壮，更加确保有效性）。

这些类型的测试是为什么您可能会受益于像 Jasmine 这样支持 BDD 的框架，而不仅仅是纯 TDD（你发现视觉差异的结果是一团糟），因为您正在测试行为和比较和功能/行为的前/后状态，不仅仅是 a 为真并且在解析后仍然为真。

设置这些单元测试可能需要一段时间，但它是一种具有如此大代码库的迭代方法......快速和早期测试您的初始关键阻塞点或脆弱点，然后将测试扩展到所有内容（我一直设置的方式我的团队认为，从这一点开始的任何东西都不会被认为是完整的，并且 RC 除非它有单元测试......任何没有单元测试并且必须更新/触摸/维护的旧东西都必须在被触摸时编写单元测试，以便您以更易于管理和逻辑的方式不断改进和减少未经测试的代码量，同时增加代码覆盖率）。

一旦你在 CI 中启动并运行了单元测试，你就可以将它们绑定到你的构建过程中：失败没有单元测试的构建，或者当单元测试失败时发送警报，主动监控每个签入等等。使用 JSDoc3 等自动生成文档等。

您所描述的问题是构建 CI 和单元测试的目的，更具体地说，在您的情况下，该方法最大限度地减少了代码库大小的影响......大小不会使其更复杂，只会使持续时间让测试全面工作更长时间。

然后，将它与 JSDoc3 结合起来，你的样式比 90% 的大多数前端商店都好。在那时，它对工程师来说非常强大和有用，并且可以自我延续。

我真的可以继续谈论这个话题，你如何处理它并让一个团队团结在它背后并使其自我形成和自我延续，其中最重要的是编写可测试的代码，这有很多细微差别。 ..但从概念层面...**编写单元测试并自动化它们**。总是。

长期以来，前端开发人员一直在半途而废，没有应用实际的工程严谨性和纪律。随着前端变得越来越强大和热门，这必须改变，并且正在改变。前端/RIA 应用程序的良好测试、良好覆盖、自动化测试和持续集成的概念是这种变化的巨大需求之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:51:06.113

您是否考虑过单元测试框架，例如[QUnitjs](http://qunitjs.com/)？编写单元测试将是相当多的工作，但最终您将拥有一个可重复的测试过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:02:30.317

我们在高级模式下使用闭包编译器来缩小和更改代码，因此我们也会编译我们的单元测试，因此您可以考虑将您的测试与您的代码一起缩小并像这样运行它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T17:43:08.997

不是一个测试解决方案，但是切换到 TypeScript 来编写像你这样的大型 JS 应用程序怎么样？

我用 TypeScript 及其默认的最小引擎对其进行了测试，它运行良好。

假设您的`count`arg 是一个数字。

类型脚本将是：

```
class ProcessorX {
    ProcessX(count: number): string {
        var value = '';
        value += count.toString();
        value += count.toString();
        count++;
        return value;
    }
} 
```

产生这样的js：

```
var ProcessorX = (function () {
    function ProcessorX() { }
    ProcessorX.prototype.ProcessX = function (count) {
        var value = '';
        value += count.toString();
        value += count.toString();
        count++;
        return value;
    };
    return ProcessorX;
})(); 
```

然后缩小为：

```
var ProcessorX=function(){function n(){}return n.prototype.ProcessX=function(n){var t="";return t+=n.toString(),t+=n.toString(),n++,t},n}() 
```

它在[jsfiddle](http://jsfiddle.net/Vm9LF/)上。

如果你`count`是一个`string`，那么这个[小提琴](http://jsfiddle.net/qHFDj/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T16:50:15.990

您可以查看[Selenium Web Driver](http://seleniumhq.org/)之类的东西，它允许您在各种环境中自动测试 Web 应用程序。有一些云托管 VM 解决方案可用于进行多环境测试，因此当它在 Webkit 中工作但在 IE 中不工作时，您不会被抓到。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T06:01:35.463

您绝对应该考虑使用源映射来帮助调试最小化的 JavaScript。源映射也适用于 JavaScript 的超集，例如 CoffeeScript 或我最喜欢的 TypeScript。

我使用闭包编译器，它不仅会缩小，还会创建源映射。更不用说它是最激进的并且产生最小的文件。最后，您必须知道缩小过程中发生了什么并编写兼容的代码，您的示例代码可以使用一些重构。

在源地图上查看这篇文章：http: [//www.html5rocks.com/en/tutorials/developertools/sourcemaps/](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/)

还可以查看闭包编译器的文档，它有关于如何编写更好的缩小代码的建议： [https ://developers.google.com/closure/compiler/](https://developers.google.com/closure/compiler/)

# .net - 如何编辑来自 log4net 的敏感信息？

> ID：14841310
> 
> 赞同：4
> 
> 时间：2013-02-12T20:35:05.313
> 
> 标签：.net, log4net

我们应用程序中的一些异常消息包含不应进入错误日志的凭据/私钥或其他敏感信息。我想在写入之前过滤记录的消息的内容，以便可以用 [redacted] 或某些此类文本值替换已知的敏感值和/或模式。几次搜索都没有发现任何东西。有没有办法做到这一点并以通用方式将其应用于所有配置的附加程序？

我不想通过知道所有这些异常可能发生在哪里并为此编写异常处理程序来进行过滤。我们的代码不会抛出异常，因此“不这样做”不是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:38:22.843

很简单：首先不要把它们放在那里。

当然，您可以编写一些正则表达式和启发式等，并在您的日志上定期运行它们 - 所有这些都容易失败或破坏。

并且没有任何理由在日志中包含密码和私钥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:30:29.193

我希望（但没有尝试过）您可以`BufferingAppender`根据[此处的示例](http://svn.apache.org/viewvc/logging/log4net/trunk/src/Appender/BufferingAppenderSkeleton.cs?view=markup)编写一个，并可以使用该方法`override protected void Append(LoggingEvent loggingEvent)`更改 loggingEvent 以删除敏感信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-06T11:33:11.883

还有另一种选择。

由于“违规”代码是第三方库，因此您不能简单地“从异常中删除信息”是正确的。

但是，您可以创建一个外观类来使用相同的 API 调用该库，然后将错误处理/编辑添加到新类中。然后只需在整个代码中使用该类代替原始库即可。

# javascript - ASP.NET 代码隐藏文件在哪里执行？（客户端或服务器）

> ID：14841316
> 
> 赞同：0
> 
> 时间：2013-02-12T20:35:26.673
> 
> 标签：javascript, asp.net, code-behind, execution

我的朋友是一位经验丰富的开发人员（但不熟悉 .NET）问我 ASP.NET 代码隐藏代码实际在哪里执行；在服务器或客户端上。我的假设是它在客户端上执行并因此编译为 JavaScript，因为代码隐藏文件中的方法将响应客户端事件，例如选择下拉列表，这不会导致回发。

我真正想要的是更深入地了解代码隐藏文件中的代码相对于应用程序的其余部分是如何/在何处执行的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T20:46:27.430

Codebehind 始终在服务器上执行。这就是原因，它也被称为`ASP.NET WebForms`。执行网页时，简而言之，以下是发生的情况。

1.  网页作为 HTML 表单刷新
2.  Web 控件通过必要的 Javascript 被刷新为 HTML 输入元素
3.  Javascript 保持原样（除非动态注入）

下一个问题...... **ASP.NET 服务器端如何知道我在客户端执行了哪些事件以在服务器端执行适当的事件？**

答案是，ASP.NET 将每个 Web 控件转换为一个或多个 html 元素并对其进行唯一命名，以便它可以取回生成事件的 HTML 元素的名称并采取相应的行动。它使用`ViewState`（除了各种其他用途）来确保 html 控件名称在往返过程中不被篡改。

另一个答案中给出的链接应该可以帮助您了解更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:49:15.603

TLDR：.NET 代码编译成程序集 (.DLL) 文件，这些文件在服务器上运行和执行。

JavaScript 在客户端执行（通常参见[node.js](http://nodejs.org/)），.NET 代码在服务器上运行。这两种技术通过 HTTP 请求/响应相互通信。

当第一次从服务器请求页面时，它会运行所有 .NET 代码，并且来自服务器的响应是要呈现的 HTML。此 HTML 可能包含指向其他文件的链接，例如脚本或样式表文件。一旦服务器发送响应，它就与页面无关了。

JavaScript 等客户端语言可以通过整页回发、部分回发（UpdatePanels、gross）或 AJAX 与服务器通信。他们向服务器发送新请求，服务器以新页面/HTML/数据/等响应。

看有关客户端/服务器与 Web 应用程序交互的更多信息，[本文。](http://edndoc.esri.com/arcobjects/9.2/net_server_doc/developer/adf/pagepost_clientcall.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T20:38:39.977

[http://msdn.microsoft.com/en-us/magazine/cc163675.aspx](http://msdn.microsoft.com/en-us/magazine/cc163675.aspx)

文件后面的代码在服务器端执行。除了 .aspx 文件中的呈现方法之外，ASP.NET 可以轻松地生成所有控制变量声明作为分部类，然后可以将其与简化的代码隐藏类合并。这正是 Windows 窗体在 .NET Framework 2.0 中的工作方式。所有设计器生成的代码都放置在同级部分类中，然后与您的应用程序逻辑和事件处理程序合并到一个表单派生类中，从而在机器生成的代码和开发人员代码之间建立清晰的分离，而无需求助于继承。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T20:47:08.630

文件背后的代码在服务器上执行。互联网上有很多可用的资源。其中之一可能是这个[链接](http://odetocode.com/articles/406.aspx)

希望你得到你的答案

# c++ - 使用参数声明类对象而不使用 if...else

> ID：14841318
> 
> 赞同：0
> 
> 时间：2013-02-12T20:35:37.353
> 
> 标签：c++

我是 C++ 新手，并尝试编写缓存模拟器。CACHE 类的构造函数是

```
CACHE (int, int, int, int, CACHE *);   //declare 
```

在中`main()`，我试图根据一些变量创建对象：

```
int main()
{
       if ( L2_size == 0 )      //only one level of cache   
       {
        CACHE L1(L1_size, blocksize, L1_assoc, inclusion, 0);
       }
       else                     //2 level of caches
       {
        CACHE L2(L2_size, blocksize, L2_assoc, inclusion, 0);
        CACHE L1(L1_size, blocksize, L1_assoc, inclusion, &L2);
       }
} 
```

问题是我无法访问 L1 和 L2，因为它们的范围在 if...else 内。

此外，我尝试过使用 ? ：运营商来实现这一点，仍然得到错误：

三元运算符不匹配。

有没有办法做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:40:01.627

像这样的东西，也许：

```
 CACHE *L2 = 0;
    CACHE *L1 = 0;

    if (L2_size)
    {
        L2 = new CACHE(L2_size, blocksize, L2_assoc, inclusion, 0);
    }
    L1 = new CACHE(L1_size, blocksize, L1_assoc, inclusion, L2); 
```

我确信还有其他可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:40:10.457

`std::list`您可以在语句之前或`std::vector`之前使用容器，然后`if`根据需要 push_back 尽可能多的 CACHE 对象。

例子：

```
int main()
    {
       std::list<CACHE> caches;
       if (L2_size == 0)
       {
          caches.push_front(CACHE(L1_size, blocksize, L1_assoc, inclusion, 0));
       }
       else
       {
          caches.push_front(CACHE(L2_size, blocksize, L2_assoc, inclusion, 0);
          caches.push_front(CACHE(L1_size, blocksize, L1_assoc, inclusion, &(*caches.begin());
       }
    } 
```

无论您使用哪种方法，其想法都是在您的语句之前创建堆栈变量（`list`、`pointer`或其他）`if`，以便它保持在范围内。

# c - C 语言中的链接库，未识别的引用

> ID：14841319
> 
> 赞同：0
> 
> 时间：2013-02-12T20:35:38.633
> 
> 标签：c, gcc

我正在尝试将一个库链接到我的 c 程序，以便我的主程序可以使用我正在创建的库中的函数，但是我遇到了错误。

这是我的一些库代码（称为这个文件 lib.c）：

```
#include <bfd.h>
#include <stdio.h>

static void doDump ( bfd *abfd )
{
    printf (_("\n%s:     file format %s\n"), bfd_get_filename (abfd), abfd->xvec->name);
    doHeaders ( abfd );
} 
```

这是我的主程序（也称这个文件为 main.c）：

```
#include "bfd.h"

static void getFile ( char *filename, char *target )
{
    bfd *file;
    file = bfd_openr (filename, target);
    doDump (file);
    bfd_close (file);
}

int main (int argc, char **argv)
{
    char *target = NULL;
    bfd_init ();
    getFile ("a.out", target);
} 
```

这些是我运行以链接库的命令：

> cc -Wall -c lib.c
> 
> ar -cvq libdata.a lib.o
> 
> cc -o mainprog main.c lib.a -lbfd

但是，我收到此错误：

> 未定义对 doDump 的引用

这是指向该行：

> doDump（文件）；

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T20:38:07.227

您已将 lib.c 中的 doDump 定义为`static`. 这意味着它在该文件之外是不可见的。删除`static`关键字，问题应该会消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:39:08.250

因为您已经声明它在您的主程序`doDump`中`static`不会“可见”。删除限定符并在您的（或其他一些标题）`static`中提供有效的声明：`main.c`

```
extern void doDump(bfd * file);

static void getFile ( char *filename, char *target )
{
    bfd *file;
    file = bfd_openr (filename, target);
    doDump (file);
    bfd_close (file);
} 
```

# javascript - 使用 node.js 在生产模式下缩小脚本/CSS

> ID：14841320
> 
> 赞同：11
> 
> 时间：2013-02-12T20:35:42.080
> 
> 标签：javascript, css, node.js, minify, production

我有一个在节点中运行的网络应用程序。所有（客户端）Javascript/CSS 文件目前都没有被缩小以使其更易于调试。

当我开始生产时，我想缩小这些脚本。有类似的东西会很好：

`node app.js -production`

如何在不更改 html 文件中的脚本标签的情况下提供脚本的缩小版本？应该有类似的东西：如果我在生产中，请使用这两个缩小（组合）脚本，否则使用我所有未缩小的脚本..

这可能吗？也许我想得太复杂了？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-12T20:47:17.993

您可能对[Piler](https://github.com/epeli/piler)感兴趣。它是一个 Node.js 模块，可在调试模式下像往常一样提供您指定的所有 JavaScript（和 CSS）文件，但在生产模式下会连接和缩小。

作为一项特殊功能，您可以通过 Socket.io 强制 CSS 更新实时显示在您的浏览器中（在 Piler 中称为“CSS Live Updated”），这非常棒:-)。

诀窍是在你的模板中只有`script`and`link`元素的占位符，并且 Piler 在运行时渲染这些元素——在调试模式下作为单个元素，在生产模式下作为动态生成的单个元素。

通过这种方式，您可以忘记手动或使用构建工具创建资产的串联和缩小版本，它只是在运行时存在，但在开发和调试时您始终拥有分离的完整版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T20:47:17.503

您可以为静态文件使用 2 个单独的位置

这是一些快速代码：

```
if (process.env.MODE === "production") {
  app.use(express['static'](__dirname + '/min'));
} else {
  app.use(express['static'](__dirname + '/normal'));
} 
```

并开始节点

```
MODE=production node app.js 
```

此外，如果您不想复制所有文件，您可以利用 express static router 在第一个文件处停止的事实，并执行以下操作：

```
if (process.env.MODE === "production") {
  app.use(express['static'](__dirname + '/min'));  // if minized version exists, serves it
}
app.use(express['static'](__dirname + '/normal'));  // fallback to regular files 
```

但是，是否最小化使用相同的名称会导致浏览器缓存出现问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-17T06:29:52.187

我想与你们分享我的最终解决方案。

我使用 JSHTML 进行 Express（[在此处输入链接描述](https://github.com/elmerbulthuis/jshtml-express)）

在我的主节点文件中，我使用了一个特殊的路由：

```
app.get('/**:type(html)', function (req, res, next) {
var renderingUrl = req.url.substring(1, req.url.lastIndexOf("."));
//TODO: Find a better solution
    try{
        var assetUrl = req.url.substring(req.url.lastIndexOf("/") + 1, req.url.lastIndexOf("."));
        var assets = config.getResourceBundle(assetUrl);
        assets.production = config.getEnviroment() === "production";
        res.locals(assets);
        res.render(renderingUrl);
    }catch(e){
        res.redirect("/");
    }
}); 
```

如您所见，我从 config.getResourceBundle 获取我的资产。这是一个简单的函数：

```
exports.getResourceBundle = function(identifier){
    switch(enviroment){
        case "development":
            return devConfig.getResourceBundle(identifier);
        case "production":
            return prodConfig.getResourceBundle(identifier);
        default:
            return devConfig.getResourceBundle(identifier);
    }
} 
```

最后是资产文件集合的示例：

```
exports.getResourceBundle = function (identifier) {
    return resourceBundle[identifier];
};

resourceBundle = {
    index:{
        cssFiles:[
            "resources/dev/css/login.css",
            "resources/dev/css/logonDlg.css",
            "resources/dev/css/footer.css"
        ],
        jsFiles:[
            "resources/dev/js/lib/jquery/jquery.183.js",
            "resources/dev/js/utilities.js",
            "resources/dev/js/lib/crypto.3.1.2.js"
        ]
    },
    register:{
        cssFiles:[
            "resources/dev/css/login.css",
            "resources/dev/css/modalDialog.css",
            "resources/dev/css/footer.css"
        ],
        jsFiles:[
            "resources/dev/js/lib/jquery/jquery.183.js",
            "resources/dev/js/utilities.js",
            "resources/dev/js/lib/crypto.3.1.2.js",
            "resources/dev/js/lib/jquery.simplemodal.js",
            "resources/dev/js/xfiles.register.js"
        ]
    }
(...) 
```

我有 2 个文件夹。开发/产品。grunt 会将缩小后的文件复制到 prod/.. 并从 dev/.. 中删除文件。如果 NODE_ENV 变量设置为生产，我将发送我的脚本/css 的缩小版本。我认为这是目前最优雅的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-01T16:08:35.133

有适合您的构建工具插件，可以帮助您优雅地解决这个问题：

对于 Gulp： [https ://www.npmjs.org/package/gulp-useref/](https://www.npmjs.org/package/gulp-useref/)

对于咕噜声： [https ://github.com/pajtai/grunt-useref](https://github.com/pajtai/grunt-useref)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-18T15:48:50.877

另一个可能相关的 Node.js 模块是[connect-cachify](https://github.com/mozilla/connect-cachify)。

它似乎并没有为您做实际的缩小，但它确实让您在生产中提供缩小版本，或在开发中提供所有原始脚本，而无需更改模板（感谢`cachify_js`和`cachify_css`）。

似乎它不像 Piler 那样功能丰富，但可能更简单一些，并且应该满足问题中提到的所有要求。

# javascript - 使用javascript从输入循环从开始日期到结束日期

> ID：14841328
> 
> 赞同：2
> 
> 时间：2013-02-12T20:36:01.363
> 
> 标签：javascript, sql, date, loops

我从输入中得到了开始日期和结束日期。我需要将所有从 startdate 到 enddate 的日期放入数据库中。因此我需要做一个这样的循环：

```
FOR i = startdate; i <= enddate; i + 1 day 
{
   here i use the date
} 
```

如何使用输入框中的日期进行这样的循环？

如果我尝试这样做，我会得到“无效日期”：

```
var endDate = new Date($("#enddate").val()); 
```

如果我这样做，我不能像你在答案中所说的那样使用 endDate.getTime() 。

```
var endDate = $("#enddate").val());
var endDateTime = endDate.getTime(); 
```

**所以基本上：**如何将输入转换为日期？enddate 的输入是这样的：dd/mm/yyyy。

不，这不是 SQL 问题，我需要这样做是 javascript，因为我需要先检查日期。

谢谢你帮助我；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:47:23.957

像这样的循环会起作用吗？：

```
var current_date = new Date("01/13/2013");
var end_date = new Date("01/20/2013");
var end_date_time = end_date.getTime();

while (current_date.getTime() < end_date_time) {
    console.log(current_date);
    current_date.setDate(current_date.getDate()+1);
} 
```

[http://jsfiddle.net/Sn6Ws/](http://jsfiddle.net/Sn6Ws/)

根据文本框值的格式，您可以像这样设置它：

```
$(document).ready(function () {
    $("#btn").on("click", function () {
        dateLooper(function (cur, end) {
            console.log("Current date: " + cur.toString() + ", End Date: " + end.toString());
        });
    });
});

function dateLooper(callback) {
    var start_date_text = document.getElementById("start_date").value;
    var end_date_text = document.getElementById("end_date").value;

    var current_date = new Date(start_date_text);
    var end_date = new Date(end_date_text);
    var end_date_time = end_date.getTime();

    while (current_date.getTime() < end_date_time) {
        //console.log(current_date);
        callback.call(this, current_date, end_date);
        current_date.setDate(current_date.getDate()+1);
    }
} 
```

[http://jsfiddle.net/Sn6Ws/1/](http://jsfiddle.net/Sn6Ws/1/)

根据您解释日期的评论格式为“dd/mm/yyyy”，您可以使用以下内容：

```
var start_date_text = document.getElementById("start_date").value;
var start_split = start_date_text.split("/");
if (start_split.length != 3) {
    return false;
}
start_date_text = start_split[1] + "/" + start_split[0] + "/" + start_split[2];

var end_date_text = document.getElementById("end_date").value;
var end_split = end_date_text.split("/");
if (end_split.length != 3) {
    return false;
}
end_date_text = end_split[1] + "/" + end_split[0] + "/" + end_split[2]; 
```

在将日期传递给`new Date`. 这是一个更新的 jsFiddle 演示它：

[http://jsfiddle.net/Sn6Ws/4/](http://jsfiddle.net/Sn6Ws/4/)

当然，要小心，如果日期没有以指定的格式出现（以防用户可以输入这个或其他东西），代码很可能会抛出错误。您显然可以进行更多检查以确保在进行某些操作之前设置某些内容（例如确保每个项目都是数字/整数，确保天数在 1 到 31 之间，等等）。因此，出于这个原因，您可能想要走正则表达式的路线。至少使用正则表达式，您可以指定特定模式并知道它是否完全匹配，并立即获得构建日期所需的值。

使用正则表达式，这是一个不完整的示例，但希望对您有所帮助：

```
function dateLooper(callback) {
    var re = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;

    var start_date_text = document.getElementById("start_date").value;
    var start_match = re.exec(start_date_text);
    if (start_match) {
        var valid = true;
        // Set `valid` variable based on the following
        // Validate start_match[1] is valid day
        // Validate start_match[2] is valid month
        // Validate start_match[3] is valid year
        if (valid) {
            start_date_text = combineDate(start_match);
        } else {
            return false;
        }
    } else {
        return false;
    }

    var end_date_text = document.getElementById("end_date").value;
    var end_match = re.exec(end_date_text);
    if (end_match) {
        var valid = true;
        // Set `valid` variable based on the following
        // Validate end_match[1] is valid day
        // Validate end_match[2] is valid month
        // Validate end_match[3] is valid year
        if (valid) {
            end_date_text = combineDate(end_match);
        } else {
            return false;
        }
    } else {
        return false;
    }

    var current_date = new Date(start_date_text);
    var end_date = new Date(end_date_text);
    var end_date_time = end_date.getTime();
    var days_spent = 0;

    while (current_date.getTime() < end_date_time) {
        days_spent++;
        callback.call(this, current_date, end_date, days_spent);
        current_date.setDate(current_date.getDate()+1);
    }

    return days_spent;
}

function combineDate(re_match) {
    return re_match[2] + "/" + re_match[1] + "/" + re_match[3];
} 
```

[http://jsfiddle.net/Sn6Ws/6/](http://jsfiddle.net/Sn6Ws/6/)

# php - mysql PDO多参数插入语句

> ID：14841333
> 
> 赞同：2
> 
> 时间：2013-02-12T20:36:28.990
> 
> 标签：php, mysql, pdo

我不知道出了什么问题..我已经看到了很多不同的方法，有人可以告诉我这到底是怎么回事..它抛出这个错误“错误：SQLSTATE [42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以了解在“desc”附近使用正确的语法）VALUES（“30.59”、“blue shirt”、“a really cool blue shirt ')' 在第 1 行"。我已经尝试了多种方法，结果相同..

```
<?php
$title = 'blue shirt';
$desc = 'a really cool blue shirt';
$price = 30.59;

$user = 'foo';
$pass = 'Bar';

try{
$conn = new PDO('mysql:host=examplehost;dbname=exampledb_name',$user,$pass);
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
if(!$conn){
    echo"couldnt connect to db";
}else {
    echo 'connected like a boss!!' . '<br>';
    $stmt = $conn->prepare("INSERT INTO 68_items (price, title, desc) VALUES (:price,:title,:desc)");
    if(!$stmt->execute(array(
            ':price' => $price,
            ':title' => $title,
            ':desc' => $desc))
    ) {
        echo'statment failed';
    }else {
        echo 'statment success, ' .  $stmt->rowCount() . 'rows affected.';
    }
}
} catch (PDOException $e) {
echo 'ERROR: ' . $e->getMessage();
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T20:41:48.117

`desc`是[mysql 中的保留字，](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)因此您应该使用反引号将其转义：

```
"INSERT INTO 68_items (price, title, `desc`) VALUES (:price,:title,:desc)" 
```

# c# - 为什么不是 0==0？

> ID：14841336
> 
> 赞同：4
> 
> 时间：2013-02-12T20:36:40.893
> 
> 标签：c#, system.reflection

`Activator.CreateInstance(p.PropertyType) == value`是假的

给定一个类型 T：

```
public class ODataTestHelper
        {
            public int DataId { get; set; }
            public string DataItem { get; set; }
        } 
```

以及对属性的 foreach：

```
public string BuildQuery<T>(T searchModel,int page, int pageSize)
{
  var type=typeof(T);
  var filters = new List<string>();
  foreach (var p in type.GetProperties())
  {
    var value=p.GetValue(searchModel,null);
    if(value == null || value.ToString().IsNullOrEmpty() || (p.PropertyType.IsValueType && Activator.CreateInstance(p.PropertyType) == value ))
        continue;
     filters.Add(string.Format("{0} eq {1}", p.Name, WrapTypeValue(p.PropertyType, value)));
  }
   if (filters.Any())
        {
            result += "&$filter=" + filters.Aggregate((s1, s2) => s1 + " and ");
        }
        return result;
 } 
```

给定一个测试方法

```
[TestMethod]
        public void BuildQuery_StringProperty_ItRendersTheFilter()
        {
            const string x = "foo";
            string expected =String.Format( "&$filter={0} eq '{1}'",LinqOp.PropertyOf(() => default(ODataTestHelper).DataItem).Name , x);
            var od = new ODataBinder("http://localhost/");
            var q = od.BuildQuery(new ODataTestHelper { DataItem = x}, 0, 0);
            Assert.IsTrue(q.Contains(expected), string.Format("{0} did not contain {1}", q, expected));

        } 
```

即时窗口确认出现的默认`0`值为 ，实例中的值为`0`。这也证实了`p.PropertyType.IsValueType`

`0`没有`==`调用， `Activator.CreateInstance(p.PropertyType)`所以它不会跳过 unintiailized `DataId`。[这是根据How can I call default(T) with a type?](https://stackoverflow.com/questions/3707302/how-can-i-call-defaultt-with-a-type)创建默认值的答案？并[创建类型的默认实例，](https://stackoverflow.com/questions/10351385/create-default-instance-of-type)但我似乎无法`==`或`.Equals`无法测试是否相等？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T20:45:34.567

这里的简单答案是它们是不同的对象。此上下文中的`==`运算符检查两个表达式是否引用相同的对象。虽然两个对象的值可能相同，但对象不是同一个对象，因此不相等。

要确定两个对象是否具有相同的值，您应该使用： `(<expression 1>).Equals(<expression2)` 而不是`<expression 1> == <expression 2>`

您可能需要重写该`Equals`方法以使其在 C# 中工作，因为我看到默认情况下该方法检查与`==`. 见[这里](http://msdn.microsoft.com/en-gb/library/53k8ybth.aspx)。

# python - 尝试导入新安装的 python 包时收到错误消息

> ID：14841337
> 
> 赞同：0
> 
> 时间：2013-02-12T20:36:41.417
> 
> 标签：python, installation, package

我刚刚下载了一个 python 包并使用以下命令将其安装在 Linux 机器上：

```
python setup.py install --prefix=/home/ubuntu/dev/git/nx 
```

也就是说，我没有使用默认的安装目录。然后我将现有`PYTHONPATH`变量附加`~/.bashrc`​​如下：

```
export PYTHONPATH=/some/previous/path:/home/ubuntu/dev/git/nx 
```

但是当我`import`在 python 中运行包时，我得到一个`ImportError: No module named`错误。

我是否指定了错误的路径`PYTHONPATH`？如果是这样，我如何确定放在那里的路径？还是有不同的错误？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:52:08.017

如果你把它放在 bashrc 中，你要么需要 source ~/.bashrc 要么再次登录。根据您的发行版，bashrc 可能不是放置它的正确位置。您使用的是 Ubuntu，所以它可以工作。

在导出路径类型变量时包含当前变量通常也是一种很好的做法。

```
export PYTHONPATH=$PYTHONPATH:/home/ubuntu/dev/git/nx 
```

您可以使用 echo $PYTHONPATH 验证您的路径是否正确。您还可以运行上述命令以查看它是否会修复它（尽管是暂时的并且仅在您当前的 shell 中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T22:00:28.907

冉

```
sudo python setup.py install 
```

不必乱来`PYTHONPATH`。工作很棒！

# jquery - Jquery 承诺：是否有可重用的替代方案？

> ID：14841338
> 
> 赞同：5
> 
> 时间：2013-02-12T20:36:46.277
> 
> 标签：jquery, javascript-events, javascript

我正在构建一个 Web 应用程序，该应用程序具有一组功能，用户可能会执行几次，但涉及足够的异步操作以使回调有点失控。

什么是现实的替代品`$.Deffered`并且`$.when`可以多次“使用”？

*   我不是在寻找一个完整的框架
*   我不想（直接）使用回调

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-24T01:03:54.007

我认为您正在寻找的是事件。[jQuery 中使用on](http://api.jquery.com/on/)和[trigger](http://api.jquery.com/trigger/)的示例：

```
var data_handler = $({});

function get_data(new_foo) {
   // Do stuff, then send the event
   data_handler.trigger('new_data', {foo: new_foo});
}

data_handler.on('new_data', function(e, data) {
   console.log('Handler 1: ' + data.foo);
});

data_handler.on('new_data', function(e, data) {
   console.log('Handler 2: ' + data.foo);
});

get_data(1);
get_data(2); 
```

输出：

```
Handler 1: 1
Handler 2: 1
Handler 1: 2
Handler 2: 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:45:50.230

这里有 3 个这样的库：

1.  [问](https://github.com/kriskowal/q)
2.  [rsvp.js](https://github.com/tildeio/rsvp.js)
3.  [当.js](https://github.com/cujojs/when)

这些库不是“成熟的”。他们只是执行承诺。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T16:33:41.010

除了直接附加到 Promise 之外，您还可以对 Promise 进行包装，允许回调订阅重复的 Promise 或以设定的时间间隔进行的 Ajax 调用：

```
var cycle = function(func, interval){
    var _this = this;

    // Use jQuery's triggers to manage subscriptions
    var o = $({});
    this.publish = o.trigger.bind(o);
    this.subscribe = o.on.bind(o);
    this.unsubscribe = o.off.bind(o);

    var call = function(func){

        clearTimeout(_this.timeout);

        func().done(function(response){
            _this.publish('ajax:update', response);
            _this.timeout = setTimeout(function(){
                call(func);
            }, interval);
        });
    };
    call(func);

    return this;
};

var ajax_promise = function(){
    return $.getJSON('http://localhost/some/data.json');
};

var my_callback = function(response){
    // Do stuff
};

cycle(ajax_promise, 10000).subscribe('ajax:update', my_callback); 
```

# java - 只存储最近的 n 个条目的字典或类似数据结构？

> ID：14841341
> 
> 赞同：1
> 
> 时间：2013-02-12T20:36:51.400
> 
> 标签：java, dictionary, hashmap

我想知道是否有一个内置的 Java 数据结构，其行为类似于字典*，但*只保留固定数量的最近条目。所以我可以保持大小或多或少不变，但也让它表现得像字典或哈希图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:42:44.260

您可以通过扩展 LinkedHashMap 轻松创建一个。添加条目时，请检查大小并删除最旧的项目（如果已达到最大大小）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T13:04:07.183

我认为[LRUMap](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/map/LRUMap.html)将满足您的需要。

# trac - trac 可定制工单工作流程中的不变量

> ID：14841342
> 
> 赞同：0
> 
> 时间：2013-02-12T20:36:57.103
> 
> 标签：trac

我尝试查看 Trac (0.12) 可定制工单工作流程的文档。

作者声称它是完全可定制的，但有些东西我当时不明白。我猜必须有一个票开始的“初始状态”。这是硬编码为“新”的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:50:24.517

我记得，这在 trac 中是不可修改的。工作流的“新”状态入口点是固定的。但是你可以使用它而不是反对它。

我认为 trac 的设计方式，以未分配的“新”状态开始的意图是相当合乎逻辑的，但是您需要从某个并不总是明确说明的角度看待事物。

考虑一个错误的生命周期。它在代码中引入，用户发现它，用户报告它，分配开发人员，开发人员开始处理它，等等。我喜欢将“新”状态视为存在错误并且刚刚被报告的部分。

当您将错误通知开发团队时，他们通常不会立即开始处理它。例如，该错误仍然需要评估其严重性和技术深度。在您报告错误后，开发团队仍然需要消化您的报告以了解如何将其引入错误解决流程。在我看来，这是 trac 中“新”状态的意图。

在我设计和使用的 trac 工作流程中，我喜欢让“已接受”的初始状态将工单分配给开发协调员，该协调员对工单进行鉴定并与报告者来回踢，以提高报告的质量并弄清楚下一步将其发送到何处，将其分配给哪个里程碑，等等。

因此，处于已分配状态的工单是开发协调员正在处理的工单。New 状态的票是开发协调员尚未处理的票。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:18:33.653

不仅“新”，“关闭”是其他硬编码的 Trac 票证状态。

出于不同的原因，过去和现在都是如此，其中这些标签用于使用固定名称的 CSS 类进行条件格式设置，默认报告使用“未关闭”作为打开工单的同义词等。

As a related note, there is [some work on the way](http://trac.edgewall.org/wiki/TracDev/Proposals/ConfigEnumTranslation) to possibly lift this limitation in later versions (Trac 1.2 and beyond). Until then its really better to "work with it rather than against it", as JosefAssad said.

# jquery - 事件侦听器不适用于动态添加的元素

> ID：14841344
> 
> 赞同：4
> 
> 时间：2013-02-12T20:37:12.847
> 
> 标签：jquery, events, handler, onclicklistener

当按下提交按钮时，我正在使用 jQuery 在我的文档中添加一个 h1 标记。我想稍后与这个 h1 标签交互（通过鼠标点击），所以我需要向它添加一个事件处理程序。但是，它似乎没有记录点击次数。

我以前在 SO 上看到过这个问题，他们都说使用 .on()，我有，但仍然没有运气。我也没有收到任何错误，所以不知道从哪里开始。

这是一个非常简化版本的[jsFiddle](http://jsfiddle.net/fXVeW/)。谢谢。

```
$("h1").on("click", function(){
    alert("test");
    $("h1").css("color","red");
}) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-12T20:37:57.570

用这个 ：

```
$(document.body).on("click", "h1", function(){
    alert("test");
    $("h1").css("color","red");
}) 
```

当您调用`on`它时，jquery 集必须包含将包含`h1`. 您可以替换`document.body`为您确定`h1`将在其中的任何元素。

**边注 ：**

你确定你不想`$(this).css("color","red");`代替`$("h1").css("color","red");`吗？使用`$(this)`会改变点击的颜色`h1`而不是全部的颜色`h1`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:48:22.260

试试这个

***JS代码***

```
$(document.body).on("click", "h1", function(){
    alert("test");
    $(this).css("color","red");
}); 
```

***[现场演示](http://jsfiddle.net/fXVeW/2/)***

# c# - 执行 ExecuteStoreQuery 时将通配符作为 sqlparameter.Value 传递

> ID：14841347
> 
> 赞同：0
> 
> 时间：2013-02-12T20:37:27.400
> 
> 标签：c#, sql-server, asp.net-mvc

我正在使用数据库模型并尝试使用`.ExecuteStoreQuery`函数查询一些数据。

我的 SQL 语句看起来像这样

```
SELECT * FROM t WHERE f1 LIKE @pr1 AND f2 LIKE @pr2 AND f3 LIKE @pr3 
```

现在如您所见，我使用 3 个参数：@pr1,2,3

```
context.ExecuteStoreQuery(SQL_string,
new SqlParameter {
  ParameterName = "pr1",
  Value = filterVal1
},
new SqlParameter {
  ParameterName = "pr2",
  Value = filterVal2
},
new SqlParameter {
  ParameterName = "pr3",
  Value = filterVal3 == 0 ? filterVal3.ToString() : "%"
}); 
```

如您所见，根据条件，我想使用 filterVal3 的实际值或通配符 % 所以最后当执行 sql 语句时，它将根据其他 2 个参数选择记录。

问题是，“%”被翻译成我所期望的东西，并且查询返回空集。我试图用 SQL_string 中的 '%' 替换 @pr3，它实际上给了我我需要的结果。

那么如何使用 SqlParameter 让它工作呢？

希望我很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:46:04.883

您可以在存储过程中执行此操作

```
SELECT * 
FROM t 
WHERE f1 LIKE @pr1 + '%' 
    AND f2 LIKE '%' + @pr2 + '%' --if you want to search this way
    AND f3 LIKE @pr3 + '%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:06:07.457

这里的问题是睡眠不足。

它实际上按预期工作。在向 SO 询问之前花了将近 2 个小时的谷歌搜索，现在我的眼睛终于睁开了。

```
new SqlParameter {
  ParameterName = "pr3",
  Value = filterVal3 == 0 ? filterVal3.ToString() : "%"
}); 
```

这里的连续陈述是错误的。我在调试时期望值为`filterVal3`0，在这种情况下，想法是在执行查询时“忽略” f3 字段，但我不小心切换了 true : false 并导致错误结果。

正确的一种是：

```
new SqlParameter {
  ParameterName = "pr3",
  Value = filterVal3 != 0 ? filterVal3.ToString() : "%"
}); 
```

对不起各位浪费你们的时间:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:44:41.197

我在 Access DB 上遇到了一个类似的问题 - 解决方案是在 c# 代码中用 * 替换 % 。我不知道为什么它会起作用：-/

# drools - 持久流口水知识会议

> ID：14841355
> 
> 赞同：5
> 
> 时间：2013-02-12T20:37:55.357
> 
> 标签：drools, drools-fusion

我在一个学区工作，我们计划使用 Drools 为学区组成学校的学生群体实施以下类型的规则：

*   如果学生在一年中有 3 次缺勤，其出勤指标将变为 WARN 状态。
*   如果学生在一年中有 6 次缺勤，他们的出勤指标将变为 CRITICAL 状态。
*   如果学生在一年中发生 3 次重大行为事件，他们的行为指标将变为 WARN 状态。
*   如果学生在一年中发生 2 次轻微和 2 次主要行为事件，他们的行为指标将变为 CRITICAL 状态。
*   ...这些只是我脑海中的例子，但还有更多类似性质的规则。

所有这些规则都可以用 Drools 专家简单地表达出来。此外，学生的规则处理不需要是同步的。我有几个关于实现这一点的最佳方法的问题。

1.  从一个角度来看，这可以被视为事件流的监控系统。这让我想到了创建一个有状态的会话，每个新事件都将插入其中。然而，这些事件发生在 9 个月的过程中，并且相对罕见。此外，我们可以为每所学校建立一个会话，或为每个学生建立一个会话。

    *   将会话保留在内存中这么长时间会是一个问题吗？
    *   如果服务器发生故障，我们是否需要从头开始重建会话状态，或者是否建议定期拍摄快照并仅恢复自快照时间以来发生的事实。
2.  另一种选择是在为每个学生处理事件后为每个学生保留一个会话。当下一个事件出现时，我们将从存储中检索他们的会话并插入新的事实。这样，我们就不需要为每次运行引擎检索所有事实来获取学生的状态。会支持这样的配置吗？这样做有什么缺点吗？

3.  第三种方法是通过检索规则需要运行的所有其他事实、创建新的 KnowledgeSession 并运行规则来响应学生的新事实。

任何关于什么可能是最好的方法的建议将不胜感激。

戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T08:52:34.730

我会选择解决方案 2：每个学生一节课。鉴于您不会与会话进行太多交互，我会将其保存在数据库中，并且仅在需要时恢复它：新的缺席/事件到达，该学生的会话从数据库恢复，事实插入，执行规则并检索结果状态。

我在这种情况下看到的主要缺点是为多个学生创建规则并不简单，您必须将事实提供给多个会话。例如，如果您想在单个班级中有超过 10 名处于 CRITICAL 状态的学生时发出警报。在这种情况下，每堂课一次就足够了。因此，如您所见，您必须决定什么对您更好。但无论您选择哪个“单位”（学校、班级、学生），我仍然会向您推荐我之前提到的执行流程。

Drools 已经支持使用 JPA 的数据库持久性。您可以在此处获得有关此功能的更多信息：http: [//docs.jboss.org/drools/release/5.5.0.Final/drools-expert-docs/html_single/#d0e3961](http://docs.jboss.org/drools/release/5.5.0.Final/drools-expert-docs/html_single/#d0e3961)

基本思想是`kbase.newStatefulKnowledgeSession()`使用名为`JPAKnowledgeService`. 此类将返回 a 的包装器，该包装器`StatefulKnowledgeSession`将在每次方法调用后保持其状态。在本课程中，您将找到 2 个重要的方法：`newStatefulKnowledgeSession()`创建新的 ksession 并`loadStatefulKnowledgeSession()`从数据库中检索现有会话。

希望能帮助到你，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-06T17:00:40.903

还有第四个选项可以使维护更简单。为所有学生为整个学区建立一个单一的状态知识会话。在成功处理每个事件后，保持会话，以防 JVM 发生故障时需要重建工作内存。您将需要更大的 RAM 和堆空间分配，但在今天，RAM 很便宜。（我们使用 32 GB RAM 并分配 16 GB XM 和 Xmx）如果您有 24x7 的服务器，您的 JVM 很可能永远不会崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T12:09:24.967

懒惰我会选择第三种方法。我会将所有事件存储在数据库中，然后我将按天、周、月（根据需要）批量处理所有学生。这将允许您只创建一个包含多个学生、班级等规则的会话。如果您没有 3+ 百万学生，您会很好，它将是一个高性能的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T17:05:34.060

感谢您的建议和建议。我倾向于＃2有几个原因：

*   我认为为给定的学生收集所有事实，然后从头开始为每个发生的事件重新运行它们将是一个我宁愿避免的繁重过程。
*   我将模型作为一个非常长时间运行的监控过程来处理的用例，这使我相信（在阅读了 Fusion 的用例之后）将事件插入持久 KnowledgeSession 是可行的方法。
*   我不认为问题空间的范围（即学生与教室、学校或整个学区）是个问题。如果我们需要课堂指标，那么我们将拥有一个新的课程规则库，该规则库也消耗相关事件（测试、缺勤等）

需要注意的是，如果规则发生变化，我们需要根据新规则库重新评估所有受影响的学生，这意味着收集所有事实并从学年开始。这根本不应该发生太多，但如果它变得更频繁，那么我可能会转向第三种方法。

再次感谢您的帮助。

# linux - ad-hoc WLAN 的预定义小区 ID 分配

> ID：14841358
> 
> 赞同：6
> 
> 时间：2013-02-12T20:38:14.890
> 
> 标签：linux, adhoc, wireless

我有一个 debian/ubuntu 板，我通过具有以下设置的 ad-hoc 网络连接它们

```
board:~# cat /etc/network/interfaces
auto wlan0
iface wlan0 inet static
        address 10.0.0.2
        netmask 255.255.255.0
        wpa-driver nl80211
        wpa-conf /etc/wpa_supplicant.conf

board:~# cat /etc/wpa_supplicant.conf
# IBSS/ad-hoc network with WPA-None/TKIP.
ctrl_interface=/var/run/wpa_supplicant
ap_scan=1

network={
        ssid="adhoc_test"
        mode=1
        frequency=2412
        proto=WPA
        key_mgmt=WPA-NONE
        pairwise=NONE
        group=TKIP
        psk="abcdefgh"
        bssid=F8:D1:11:52:0C:4E
} 
```

这些配置创建了一个 ad-hoc wlan，但是，节点通常会获得不同的小区 ID，因此它们无法相互通信。为了防止它，我添加了`bssid=F8:D1:11:52:0C:4E`行，但是，当节点获得单元 ID 时，没有节点获得这个预定义的单元 ID。

**我的问题**是如何防止节点获得不同的单元 ID？为什么`bssid`线路在 ad-hoc 模式下不起作用？

PS 我在 ubuntu 和 debian dist 上尝试了这些设置。具有 3.2 和 3.4 内核。我使用的 wpa_supplicant 版本是 0.7、1.0 和 2.0 都不起作用。对于芯片组，我将 Atheros AR9271 芯片组用于 wifi 模块。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T21:02:31.430

使用 ap_scan=2 并从配置中删除 bssid= 行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T19:34:35.847

问题是以前的wpa_supplicant 版本不支持bssid，安装wpa_Supplicant 2.0 解决了这个问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-22T11:11:28.320

[我在https://superuser.com/questions/552935/while-using-ad-hoc-networking-how-to-i-force-nodes-to-use-the-same-cell-ids-bs](https://superuser.com/questions/552935/while-using-ad-hoc-networking-how-to-i-force-nodes-to-use-the-same-cell-ids-bs/569860#569860)回答了同样的问题[/569860#569860](https://superuser.com/questions/552935/while-using-ad-hoc-networking-how-to-i-force-nodes-to-use-the-same-cell-ids-bs/569860#569860)

简单版：临时配置后：

sudo iwconfig ath0 ap 11:22:33:44:55:66

# android - 从后台线程添加视图

> ID：14841365
> 
> 赞同：5
> 
> 时间：2013-02-12T20:38:37.267
> 
> 标签：android, android-layout

我正在尝试将多个文本视图添加到已经膨胀的布局中。显示的信息是从数据库中提取的，为数据库中的每一行创建一个文本视图。由于数据库可能非常大，我在后台线程中一次创建每个文本视图，并将其添加到前台。

这是在后台线程中调用以更新前台的函数：

```
private TextView temp;
private void addClickableEvent(ReviewHistoryEvent e){
    if(e == null){
        Log.e(tag,"Attempted to add a null event to review history");
        return;
    }
    TextView t = new TextView(getBaseContext());
    t.setTag(e);
    t.setText(e.getTime()+"  "+e.getEvent());
    t.setClickable(true);
    t.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
    t.setTextAppearance(getBaseContext(), R.style.Information_RegularText);
    t.setGravity(Gravity.CENTER);
    t.setOnClickListener(this);

    temp = t;
    runOnUiThread(new Runnable() {
         public void run() {
             LinearLayout display = (LinearLayout) findViewById(R.id.reviewHistory_display);
            display.addView(temp);
        }
    });
} 
```

此函数成功运行一次，并出现第一个文本视图。但是，当它被第二次调用时，它在 display.addView(temp); 上失败了。符合以下错误：

```
java.lang.IllegalStateException: The specified child already has a parent. You must call removeView() on the childs's parent first. 
```

我不确定为什么我的 textview 已经有一个父级，如果它应该是新实例化的。此外，我使用临时文本视图来解决我的可运行文件无法引用本地文本视图 t 的问题。它是否正确？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T22:21:11.907

不要使用成员变量（当然，它可以修改并且不是本地的），`final TextView`而是使用 a ：

```
final TextView t = new TextView(getBaseContext());
// ...

temp = t; // Remove this
runOnUiThread(new Runnable() {
     public void run() {
        // ...
        display.addView(t);
    }
}); 
```

# node.js - Node.js 聊天应用程序不加载

> ID：14841369
> 
> 赞同：0
> 
> 时间：2013-02-12T20:38:53.783
> 
> 标签：node.js

我刚刚创建了一个 node.js 聊天应用程序.. 但该应用程序没有加载。代码是非常基本的 node.js 聊天应用程序：

```
// Load the TCP Library
var net = require('net');

// Keep track of the chat clients
var clients = [];

// Start a TCP Server
net.createServer(function (client) {

    console.log("Connected!");

    clients.push(client);

    client.on('data', function (data) {
        clients.forEach(function (client) {
            client.write(data);
        });
    });

}).listen(5000);

// Put a friendly message on the terminal of the server.
console.log("Chat server is running\n"); 
```

编译后，我在 chrome 浏览器中编写，`localhost:5000`但页面一直在加载，永远不会完成。

但是，以下代码可以完美运行：

```
// Load the TCP Library
net = require('net');

// Start a TCP Server
net.createServer(function (client) {
    client.write("Hello World");
    client.end();
}).listen(5000); 
```

我在我的电脑上运行 Windows 7 64 位，并且我使用的是 chrome。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:01:32.037

您正在使用该`net`模块创建 TCP/IP 服务器，但您正在使用 Web 浏览器使用 http 协议访问它。

这彼此不匹配。

尝试使用`telnet`例如连接到您的服务器，一切都应该没问题。

或者，如果您希望能够使用网络浏览器进行连接，则需要使用`http`模块而不是`net`模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:02:14.203

网络库如果用于 TCP，而不是用于 HTTP。如果您使用 TCS，您应该能够使用 telnet 访问您的聊天，但不能使用浏览器。

这是一个关于如何为 HTTP 编写一个示例（来自[http://nodejs.org/](http://nodejs.org/)）

```
var http = require('http');
http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hello World\n');
}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T21:07:33.660

打开 tcp 连接时不要用浏览器测试。

只需 `telnet localhost 5000`在您的控制台中进行测试。

# ruby-on-rails - 找不到记录但不确定如何 - 如何取回引发此问题的特定 sql 调用？

> ID：14841374
> 
> 赞同：0
> 
> 时间：2013-02-12T20:39:17.647
> 
> 标签：ruby-on-rails, rails-activerecord

我认为主题说明了一切。像这样的东西会起作用吗？

```
class ApplicationController < ActionController::Base
  rescue_from Exception, :with => :bad_call

  def bad_call
    # how would I log the specific sql for ActiveRecord::RecordNotFound
  end
end 
```

抱歉问题含糊不清，但应该从问题中弄清楚，这将是一个巨大的帮助。我将如何在开发中记录这些信息？

提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:17:44.913

如果我确实理解你的话，那就应该是这样。

```
rescue_from ActiveRecord::RecordNotFound do |exception|
  Rails.logger.info exception
end 
```

我还建议阅读有关[为什么从 Exception 中营救不好](https://stackoverflow.com/questions/10048173/why-is-it-bad-style-to-rescue-exception-e-in-ruby)的主题。

**UPD**：哦，我想我错了。如果这是您需要的，那不会给您 SQL 查询。

# android - 有没有办法为不同的设备强制不同的方向？

> ID：14841380
> 
> 赞同：0
> 
> 时间：2013-02-12T20:39:36.430
> 
> 标签：android, device-orientation

我希望我的应用程序始终在平板电脑上横向显示，但在手机上应该可以正常旋转。有没有办法做到这一点（除了有2个不同的apk）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:42:57.757

使用方法[检查设备是否为平板电脑](https://stackoverflow.com/questions/5832368/tablet-or-phone-android)，如果是则[强制定向。](https://stackoverflow.com/questions/2150287/force-an-android-activity-to-always-use-landscape-mode)

```
// From https://stackoverflow.com/questions/5832368/tablet-or-phone-android
public boolean isTablet(Context context) {
    boolean xlarge = ((context.getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == 4);
    boolean large = ((context.getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE);
    return (xlarge || large);
}

// ...

// Do this from any Activity you do not wish to rotate on tablets:
if (isTablet(this))
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE); 
```

# git - Git diff/隐藏分支的副本针对/到当前分支

> ID：14841382
> 
> 赞同：1
> 
> 时间：2013-02-12T20:39:57.667
> 
> 标签：git, diff

我在分支上工作`XYZ`。我想知道`foo.c`这个分支与`stash{0}`on相比如何`master`。就像是

```
git diff master@stash@{0} foo.c 
```

这是行不通的。现在我希望这些 stash`foo.c`替换我的本地文件。就像是

```
git checkout master@stash@{0} foo.c 
```

**编辑：**我没有意识到存储不属于分支，但存储本身标识它是哪个分支的存储。问题解决了。

# .net - 记录 CLR JIT 策略

> ID：14841384
> 
> 赞同：3
> 
> 时间：2013-02-12T20:40:03.063
> 
> 标签：.net, clr, jit

我想知道 CLR 适用于 JIT 编译的范围和顺序。

例如，如果我的应用程序只调用给定类的单个方法，那么该类的未使用方法是否会不必要地进行 JIT 编译？如果是的话，它们都是在执行我需要的一种方法之前编译的，还是在事后懒惰编译？

那么方法中的分支呢？CLR 是否允许编译方法中的一半代码，同时允许同一方法中的单独分支在需要时保持未编译状态？

似乎随着时间的推移，我发现了一些文章，这些文章提供了其中一些细节的一瞥，但现在我没有找到任何东西可以提供关于 CLR 如何以及何时选择 JIT 一段代码的统一、可读的摘要。有推荐的书籍或链接吗？

如果任何这样的指南能够按 .net 版本分解这种 JIT 决策逻辑，那将是最好的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T20:43:01.393

JIT 在 .NET 中的工作方式是，在方法被 jit 之前，方法表入口指向一个小存根，该存根将在调用时 JIT 方法。之后更新方法表以引用 JIT 编译代码的位置。

鉴于只有被调用的方法是 JIT 编译的，所以没有被调用的方法没有 JIT 开销。

JIT 编译器将在需要时编译整个方法。如果是发布版本，则可能会优化构建代码，否则将完整编译该方法。

您可以使用 WinDbg/SOS 检查方法表。考虑以下：

```
class SomeType
{
    public void Called()
    {
        Console.WriteLine("called");
    }

    public void NotCalled()
    {
        Console.WriteLine("not called");
    }
} 
```

假设我们创建一个实例`SomeType`，调用`Called`然后检查方法表`SomeType`。在 x86 上，您会看到如下内容：

```
0:000> !dumpmt -md 00a7381c
EEClass:         00a712d0
Module:          00a72e94
Name:            ConsoleApplication1.SomeType
mdToken:         02000002
File:            c:\temp\ConsoleApplication1\ConsoleApplication1\bin\Debug\ConsoleApplication1.exe
BaseSize:        0xc
ComponentSize:   0x0
Slots in VTable: 7
Number of IFaces in IFaceMap: 0
--------------------------------------
MethodDesc Table
   Entry MethodDe    JIT Name
72ca4960 729a6728 PreJIT System.Object.ToString()
72c98790 729a6730 PreJIT System.Object.Equals(System.Object)
72c98360 729a6750 PreJIT System.Object.GetHashCode()
72c916f0 729a6764 PreJIT System.Object.Finalize()
00df00d8 00a73814    JIT ConsoleApplication1.SomeType..ctor()
00df0110 00a737fc    JIT ConsoleApplication1.SomeType.Called()
00a7c031 00a73808   NONE ConsoleApplication1.SomeType.NotCalled() 
```

请注意，它`Called`是 JIT 编译的，但由于我们还没有调用`NotCalled`它，所以它还没有被 JIT 编译。

另外，请注意，来自的方法`object`都已经过 PreJIT 编译。

请记住，在发布构建中，短方法​​可能会被内联，在这种情况下，它们不会被称为方法，而只是作为调用站点生成代码的一部分包含在内。

# php - 有没有人有完全重新编码 Wordpress 管理部分的布局的经验？

> ID：14841385
> 
> 赞同：2
> 
> 时间：2013-02-12T20:40:06.380
> 
> 标签：php, html, css, wordpress, admin

我只是在研究如何将 Wordpress 管理面板完全重新设计为完全不同的布局，并想知道这里是否有人曾经尝试过这个？

我知道您可以注入一个自定义样式表，该样式表可用于覆盖当前样式并移动某些内容，但我想知道如何也可以使用不同的 HTML 标记？

任何有关它的见解或文章链接将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:51:26.850

恐怕你不能轻易改变 wp-admin 的 HTML。与将逻辑与可视化分开的前端不同，wp-admin 脚本包含 HTML 和执行代码，如您在[wp-admin/users.php](https://github.com/WordPress/WordPress/blob/master/wp-admin/users.php)中所见。

您可以对 CSS 和其他重用项目（如菜单和页眉/页脚）进行相当大的更改。[如何轻松自定义 WordPress 管理员](http://wp.smashingmagazine.com/2012/05/17/customize-wordpress-admin-easily/)一文中描述了您可以更改的许多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:45:29.533

在 Wordpress 文件中，您拥有所有代码，因此您可以随心所欲地使用它。下载 Wordpress 时查看 wp-admin 文件夹中的文件。并尝试[在 Google 上搜索](http://www.google.co.uk/search?q=develop%20wordpress%20admin%20ui&sourceid=ie7&rls=com.microsoft%3aen-GB%3a%7Breferrer%3asource%7D&ie=UTF-8&oe=&rlz=1I7SUNC_en&redir_esc=&ei=5agaUYOvJsjQ0QWK-oDQCQ#hl=en&tbo=d&rls=com.microsoft%3aen-GB%3a%7Breferrer%3asource%7D&rlz=1I7SUNC_en&sclient=psy-ab&q=redesign%20wordpress%20admin%20ui&oq=redesign%20wordpress%20admin%20ui&gs_l=serp.3...4361.5378.0.5621.8.8.0.0.0.4.232.1125.1j6j1.8.0.les;..0.0...1c.1.2.serp.iPGghYo3eo8&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&bvm=bv.42261806,d.d2k&fp=686385675783a4fd&biw=1366&bih=600)。或者去[插件路线](http://www.1stwebdesigner.com/wordpress/awesome-wordpress-plugin-your-dashboard/)。

但是，当管理方面的功能很重要时，为什么要重新设计 Wordpress 管理 UI。当您可以创建自定义帖子类型并使用自定义字段等出色插件时，您真的需要重新设计用户界面吗？

# knockout.js - KnockoutJS 和 Autocomplete 保存值和选定的文本

> ID：14841391
> 
> 赞同：0
> 
> 时间：2013-02-12T20:40:22.013
> 
> 标签：knockout.js, jquery-ui-autocomplete

我正在使用此处找到的 KnockoutJS 自动完成代码：

[如何创建一个自动完成的组合框？](https://stackoverflow.com/questions/7537002/autocomplete-combobox-with-knockout-js-template-jquery)

一般来说，它工作得很好。我正在使用 JQuery Ajax 调用来获取自动完成的数据。当我在输入字段中键入，然后从列表中选择一个值时，相应的值会在 Knockout ViewModel 中设置。但是，我无法让它从自动完成中设置选定的文本值。

（这是为了能够查找 SIC 编号，给出部分描述）

我已经定义：

```
function Sic(SICCode, SICDescription) {
    var self = this;
    self.SICCode = ko.observable(SICCode);
    self.SICDescription = ko.observable(SICDescription);
} 
```

我的 ViewModel 有：

```
 self.SICCode = ko.observable("");
    self.SICDescription = ko.observable("");
    self.SicCodes = ko.observableArray(); 
```

查找功能是：

```
 self.getSicCode = function (searchTerm, sourceArray) {
        $.getJSON(_serviceURL + "/GetSicFromDescription/" + searchTerm, function (data) {
            if (data.length > 0) {
                var result = [];
                $.map(data, function (item) {
                    result.push(new Sic(item.SicCode, item.Description));
                });
                sourceArray(result);
            }
        });
    } 
```

在输入标签中（它实际上是一个 .NET 页面（实际上是一个 DotNetNuke 自定义模块，但这并不重要））我有：

```
 <div>SIC:<br />
        <input type="text" maxlength="30" 
            data-bind="value: SICDescription, 
            jqAuto: {minLength: 3, autoFocus: true}, jqAutoQuery:getSicCode,
            jqAutoSource: SicCodes, jqAutoSourceLabel: SICDescription, 
            jqAutoValue: SICCode, jqAutoSourceInputValue: 'SICDescription', 
            jqAutoSourceValue: 'SICCode'" />
        <span data-bind="text: SICCode"></span>
    </div> 
```

（我尝试过使用和不使用 value: binding）在输入框中输入内容将正确进行查找并显示匹配项的列表。然后我可以选择一个并在跨度中查看相应的数字。

但是，当我单击一个按钮，然后将 ViewModel 数据发送到服务器时，self.SICDescription() 为空...... self.SICCode() 包含正确的值。

那么，如何将选定的描述填充到 ViewModel 中？我会假设使用输入字段的值绑定应该可以解决问题。但是不行。

无论如何我需要做一些事情，还是我必须做一些工作（循环遍历返回值的数组并提取正确的描述）？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T07:11:11.243

因为敲除 observables 是函数，所以你可以在其中存储任意数量的对象。我会将您的描述值存储在 SICCode 中。像这样更改绑定代码的 writeValueToModel & option.select 部分：

```
 //function that is shared by both select and change event handlers
        function writeValueToModel(valueToWrite,name) {
            if (ko.isWriteableObservable(modelValue)) {
               modelValue(valueToWrite);         
               modelValue.nameProp = ko.observable(name);             
            } else {  //write to non-observable
               if (allBindings['_ko_property_writers'] && allBindings['_ko_property_writers']['jqAutoValue'])
                        allBindings['_ko_property_writers']['jqAutoValue'](valueToWrite );    
            }
        }

        //on a selection write the proper value to the model
        options.select = function(event, ui) {
            var actualValue = ui.item ? ui.item.actualValue : null;
            var value = ui.item ? ui.item.value : null;
            writeValueToModel(actualValue,value);
        }; 
```

我将您的描述值存储在 SICCode 中，并使用另一个可观察的名称，例如“nameProp”。

您可以像这样获得它的描述 SICCode.nameProp();

实际上，对于您的情况，您可以通过调用 $("#yourInputID").val() 来获取描述值

但对于更复杂的情况，您可以使用上面的代码。

[JSFIDDLE 演示](http://jsfiddle.net/gurkavcu/ujp3r/)

选择项目后单击测试按钮。

# jquery - 获取所有空输入并将每个输入存储在唯一变量中

> ID：14841393
> 
> 赞同：0
> 
> 时间：2013-02-12T20:40:25.887
> 
> 标签：jquery, forms, event-handling

我有一个包含多个输入的表单，在它被发送之前我检查是否有任何输入为空：

```
 <input type="text" name="number" id="number" style="float:left;clear:both;"/>
    <input type="text" name="road" id="road" style="float:left;clear:both;" />
    <input type="text" name="town" id="town" style="float:left;clear:both;" />
    <input type="submit" name="submit" value="submit" id="submit" /> 
```

jQuery：

```
$('#submit').on('click', submitForm);
function submitForm(){
    if($('#number, #road, #town').val() ==''){
        $('#error-box').show();
        $('#error-box p').text('not all fields are complete - please complete to progress');
        return false;
    }
    else{
        alert('part 1 complete OK');
        $('#add-listing-part1').hide();
        $('#add-listing-part2').show();
        return false;
    }
} 
```

我想在错误框中准确显示哪些字段是空的（带有很好的用户友好消息），但我不确定如何在没有大量 if() 语句的情况下最有效地做到这一点？

逻辑如下：

1.  检查是否有任何字段为空
2.  如果“城镇”为空，则将“城镇”存储在变量中，如果“道路”为空..等
3.  将错误框中的文本更改为“并非所有字段都完整，请填写 $town 和 $road...”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:45:39.370

您可以使用以下代码：

```
function submitForm() {
    var empty = $('form input[value=""]');
    if (empty.length > 0) {
        $('#error-box').show();
        empty.each(function (index, element) {
            $('#error-box p').text($('#error-box p').text() + $(this).attr('name') + ' ');
        });
        $('#error-box p').text($('#error-box p').text() + 'fields are not filled');
    } else {
        // complete your submit
    }
} 
```

# c++ - std::unique_ptr、删除器和 Win32 API

> ID：14841396
> 
> 赞同：26
> 
> 时间：2013-02-12T20:40:42.440
> 
> 标签：c++, winapi, c++11, unique-ptr

在 VC2012 中，我想使用唯一指针和删除器在构造函数中创建互斥锁，这样我就不需要创建析构函数来调用 CloseHandle。

我原以为这会起作用：

```
struct foo
{
    std::unique_ptr<HANDLE, BOOL(*)(HANDLE)> m_mutex;
    foo() : m_mutex(CreateMutex(NULL, FALSE, NULL), CloseHandle) {}
} 
```

但在编译时出现错误：

```
error C2664: 'std::unique_ptr<_Ty,_Dx>::unique_ptr(void *,int 
(__cdecl *const &)(HANDLE)) throw()' : cannot convert parameter 1 from 
'HANDLE' to 'void *' 
```

当我这样修改构造函数时：

```
foo() : m_mutex((void*)CreateMutex(NULL, FALSE, 
    (name + " buffer mutex").c_str()), CloseHandle) {} 
```

我得到更不寻常的：

```
error C2664: 'std::unique_ptr<_Ty,_Dx>::unique_ptr(void *,
int (__cdecl *const &)(HANDLE)) throw()' : cannot convert 
parameter 1 from 'void *' to 'void *' 
```

我现在很茫然。HANDLE 是 void* 的 typedef：我需要了解一些转换魔法吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-02-12T20:50:59.447

现在忘记自定义删除器。当您说`std::unique_ptr<T>`时，`unique_ptr`构造函数期望接收 a `T*`，但`CreateMutex`返回 a `HANDLE`，而不是 a `HANDLE *`。

有 3 种方法可以解决此问题：

```
std::unique_ptr<void, deleter> m_mutex; 
```

您必须将返回值`CreateMutex`转换为 a `void *`。

另一种方法是使用[`std::remove_pointer`](http://en.cppreference.com/w/cpp/types/remove_pointer)获取`HANDLE`的基础类型。

```
std::unique_ptr<std::remove_pointer<HANDLE>::type, deleter> m_mutex; 
```

另一种方法是利用这样一个事实，即如果`unique_ptr`的删除器包含一个名为 的嵌套类型`pointer`，那么`unique_ptr`将使用该类型作为其托管对象指针而不是`T*`.

```
struct mutex_deleter {
  void operator()( HANDLE h ) 
  {
    ::CloseHandle( h );
  }
  typedef HANDLE pointer;
};
std::unique_ptr<HANDLE, mutex_deleter> m_mutex;
foo() : m_mutex(::CreateMutex(NULL, FALSE, NULL), mutex_deleter()) {} 
```

* * *

现在，如果您想将函数类型的指针作为删除器传递，那么在处理 Windows API 时，您还需要注意创建函数指针时的调用约定。

因此，指向的函数指针[`CloseHandle`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724211%28v=vs.85%29.aspx)必须如下所示

```
BOOL(WINAPI *)(HANDLE) 
```

结合这一切，

```
std::unique_ptr<std::remove_pointer<HANDLE>::type, 
                BOOL(WINAPI *)(HANDLE)> m_mutex(::CreateMutex(NULL, FALSE, NULL),
                                                &::CloseHandle); 
```

我发现使用 lambda 更容易

```
std::unique_ptr<std::remove_pointer<HANDLE>::type, 
                void(*)( HANDLE )> m_mutex;
foo() : m_mutex(::CreateMutex(NULL, FALSE, NULL), 
                []( HANDLE h ) { ::CloseHandle( h ); }) {} 
```

或者按照@hjmd 在评论中的建议，`decltype`用于推断函数指针的类型。

```
std::unique_ptr<std::remove_pointer<HANDLE>::type, 
                decltype(&::CloseHandle)> m_mutex(::CreateMutex(NULL, FALSE, NULL),
                                                  &::CloseHandle); 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-02-12T21:20:17.157

其他人指出了整个`HANDLE`/`HANDLE*`问题是如何运作的。这是一个更聪明的方法来处理它，使用`std::unique_pointer`.

```
struct WndHandleDeleter
{
  typedef HANDLE pointer;

  void operator()(HANDLE h) {::CloseHandle(h);}
};

typedef std::unique_ptr<HANDLE, WndHandleDeleter> unique_handle; 
```

这允许`unique_handle::get`返回`HANDLE`而不是返回`HANDLE*`，没有任何花哨`std::remove_pointer`或其他类似的东西。

这是有效的，因为`HANDLE`它是一个指针，因此满足 NullablePointer。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T20:51:25.160

问题是您实际上定义了保存指向句柄 (HANDLE*) 类型的指针的 unque_ptr，但您只传递了 HANDLE，而不是指向它的指针。

# visual-studio-2010 - VS C# sql 无法连接到任何 sql 主机

> ID：14841398
> 
> 赞同：0
> 
> 时间：2013-02-12T20:40:49.097
> 
> 标签：visual-studio-2010, database-connection, mysqlconnection

我正在拼凑一个简短的程序，主要是为了尝试学习一些基础知识。我发现这部分代码有问题：

```
{
    MySqlConnection connection = new MySqlConnection("server=serverT;User Id=user;password=password;database=healer");
    connection.Open();
    MySqlDataReader reader = new MySqlCommand("SELECT version FROM version", connection).ExecuteReader();
    reader.Read();
etc etc etc
} 
```

现在，当我构建并运行它时，它运行良好，没有任何问题，它连接起来，我可以毫无问题地阅读......（顺便说一句，服务器是在线托管的）

当我将 exe/mysql.data.dll 分发给任何人运行时，他们会抛出无法连接到任何 sql 主机的异常。

我只是不明白为什么我可以连接，而他们不能。我现在已经在其他 3 台远程机器上尝试过，它们都无法连接，但我的工作正常。

托管的 sql 数据库上没有访问规则，我允许从所有 IP 访问

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:15:56.000

您正在将连接字符串硬编码到您的代码中。您的客户有不同的服务器，因此他们需要不同的连接字符串。

您需要创建从中检索连接参数的表单或配置文件。

请阅读这个：

[http://msdn.microsoft.com/en-us/library/ms254494.aspx](http://msdn.microsoft.com/en-us/library/ms254494.aspx)

# html - 刷新 div 或加载文本而不刷新整个页面

> ID：14841399
> 
> 赞同：-2
> 
> 时间：2013-02-12T20:40:50.547
> 
> 标签：html, text, refresh

我想大约每 5 秒重新加载一次我的文本，以便我的用户看到他们有新邮件......我的代码如下所示：

```
If C_Mess "0" Then <span class="message-count"> C_Mess </ span> Else 0 End If 
```

任何人都可以帮助我每 5 秒重新加载一次吗？Javacript / jQuery 之类的。

我要刷新`<span class="message-count"> C_Mess </ span>`。

非常感谢解答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:50:26.117

```
<html>
<head>
<!-- For ease i'm just using a JQuery version hosted by JQuery- you can download any   version and link to it locally -->
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>

    var refreshId = setInterval(function(){
       $('#responsecontainer').fadeOut("slow").load('response.php').fadeIn("slow");
    }, 5000);

</script>
</head>
<body>

    <div id="responsecontainer">
    </div>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:57:10.990

我会将以下内容放在`setTimeout`函数中：

```
$(".message-count").hide().html('the new message count').fadeIn('fast'); 
```

# log4net - 有没有办法让 log4net 仅在有日志记录活动时创建日志文件？

> ID：14841403
> 
> 赞同：4
> 
> 时间：2013-02-12T20:41:13.137
> 
> 标签：log4net, log4net-configuration, log4net-appender

我们更改了 log4net 文件名以包含当前日期，但只希望在记录活动的日期创建日志文件。这是我们当前的配置：

```
<log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
        <file type="log4net.Util.PatternString" value="{0}\\logfiles\\log%date{{yyyyMMdd}}-${{COMPUTERNAME}}.log" />
        <appendToFile value="true" />
        <lockingModel type="log4net.Appender.FileAppender+MinimalLock" /> 
        <rollingStyle value="Size" />
        <maxSizeRollBackups value="10" />
        <maximumFileSize value="10MB" />
        <staticLogFileName value="true" />
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date %-5level %logger %message%newline" />
        </layout>
    </appender>
    <root>
        <level value="WARN" />
        <appender-ref ref="RollingFileAppender" />
    </root>
</log4net> 
```

它在创建记录器但未写入 WARN 或更大消息的日子产生空文件。是否有防止空文件的配置？

# svn - 无法在 opengrok 上获取历史和注释作品

> ID：14841404
> 
> 赞同：3
> 
> 时间：2013-02-12T20:41:13.403
> 
> 标签：svn, tfs, opengrok

我只是按照这里的步骤操作： [http](http://www.hierax.org/2009/10/opengrok-on-ubuntu-w-tomcat6.html) ://www.hierax.org/2009/10/opengrok-on-ubuntu-w-tomcat6.html 并让 opengrok 与索引搜索一起工作，但历史记录和注释不起作用。

具体来说，在查看文件时，“主页”、“历史记录”、“注释”、“行号”等按钮出现在显示的源文件上方的功能区中，大多数是按照他们说的做的链接，但是历史和注释不是链接。

当我单击文件夹名称以显示文件列表时，每个文件都有微小的 HAD 链接，其中 H 和 A 分别代表历史和注释。这次它们是链接（例如，“A”用 a=true 扩充 URL），但是当我单击它时，显示的文件没有任何注释。

SVN 和 TFS 都可能发生这种情况。

在同一个 opengrok 安装中，可能只有一些文件受到影响（这在仅 TFS 的安装中观察到）。

这是我生成 configuration.xml 的命令

sudo java -jar /var/lib/opengrok/bin/opengrok.jar -W /var/lib/opengrok/configuration.xml -c /usr/bin/ctages -P -S -v -s /var/lib/opengrok /src/ -d /var/lib/opengrok/data -w opengrok -L 抛光 -r on

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-18T09:29:16.203

我找到了解决方法。

在我的设置中，当我通过搜索特定分支查看文件时，历史记录和注释工作。当从一组分支中查看同一个文件时，历史记录和注释不可用。

我不确定这是设置问题还是捆绑包的固有限制。

# actionscript-3 - AS3 访问未定义属性错误

> ID：14841410
> 
> 赞同：-1
> 
> 时间：2013-02-12T20:41:31.653
> 
> 标签：actionscript-3, flash

我有读取 JSON 文件的代码来导入有关我正在制作的游戏中关卡的信息。代码运行和编译都很好，直到每次我尝试构建时，FlashDevelop 都开始报错“构建失败”，但实际上并没有给出错误。

我通过 mxmlc 编译器运行代码，给了我一条错误消息，它返回了一条错误消息：“错误：访问未定义的属性 JSON”：

变量级别：对象 = JSON.decode(json);

这很令人困惑，因为 JSON 库显然包含在文件顶部，“import com.adobe.serialization.json.JSON;”，并且这个错误开始完全自行发生，这很奇怪......

```
package
{
import flash.geom.Point;
import flash.geom.Rectangle;
import flash.utils.ByteArray;
import net.flashpunk.Entity;
import com.adobe.serialization.json.JSON;

public class LevelParser
{
    public static function GetLevelByID(ID:int, source:Class):Level
    {
        // Store new entity
        var populated:Vector.<Entity> = new Vector.<Entity>();

        // Parse file into string
        var bytes:ByteArray = new source();
        var json:String = bytes.readUTFBytes(bytes.length);
        var level:Object = JSON.decode(json);

        // Find correct level
                    ... 
```

编辑：奇怪的是，如果我注释掉调用它的行，并且这个函数，代码在 mxmlc 中编译得很好，但在 Flashdevelop 中说“构建失败”没有错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:04:30.090

这实际上是一个参考错误。

从 AS3 SDK 4.5 开始，JSON 成为 SDK 中的原生类。在以前的版本中，您必须下载 adobe 序列化类才能访问 JSON - 这可能是您的问题。

使用 mxmlc 时，它将使用您的 sdk flex-config.xml 中指定的所有包含库进行编译。在 FlashDevelop 中，它只会使用您包含的类。

解决方案：将 adobe serialize 类添加到您的项目中

# java - 如何在 Java 类中找到使用特定方法的所有执行路径？

> ID：14841421
> 
> 赞同：3
> 
> 时间：2013-02-12T20:42:17.690
> 
> 标签：java, code-analysis, static-analysis, execution

给定某个 java 方法，我需要确定从入口类到目标方法的所有执行路径。

例子：

**目标方法**：MyClass.myMethod()

**执行路径**：

EntryClass *--calls-->* Class1.method1() *--calls-->* Class2.method1() *--calls-->* Class2.method2() *--calls-->* **MyClass.myMethod()**

EntryClass *--calls-->* Class1.method1() *--calls-->* Class3.method1() *--calls-->* Class2.method2() *--calls-->* **MyClass.myMethod()**

EntryClass *--calls-->* Class3.method1() *--calls-->* **MyClass.myMethod()**

等等

是否有任何工具可以在我的代码库上运行静态分析以确定所有这些代码执行路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:50:34.663

eclipse 的调用层次结构是否符合要求？它显示一个方法的所有调用者或方法的所有被调用者的树（它只显示源代码可用的调用者或被调用者，不显示反射进行的调用）。

要打开它，只需单击方法名称，然后按`Ctrl``Alt``H`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:09:27.970

[FindBugs](http://findbugs.sourceforge.net) 是由马里兰大学编写的。这是

> 使用静态分析来查找 Java 代码中的错误的程序

[Cobetura](http://cobertura.sourceforge.net)是一个

> free Java tool that calculates the percentage of code accessed by tests. It can be used to identify which parts of your Java program are lacking test coverage.

I hadn't ever heard of them until one of the senior devs where I work did a code review. You can install them as maven plugins. Run the command

> mvn site

to run your code coverage reports. I can't tell you any more about actually configuring it, because I didn't do that. They documentation is supposed to be pretty good though.

# ios - IOS - 使用 MPMoviePlayerController 的实时流媒体丢失视频但没有音频

> ID：14841424
> 
> 赞同：1
> 
> 时间：2013-02-12T20:42:26.477
> 
> 标签：ios, streaming, video-streaming, mpmovieplayercontroller, audio-streaming

我正在使用 MPMoviePlayerViewController 流式传输实时视频 (.m3u8)，但是在播放过程中，有时视频会丢失并且仅显示 Quicktime 徽标，但音频仍在继续。

这发生在随机时间，有时永远不会发生，也许当互联网没有它需要的那么强大时，但控制台不会记录任何错误或播放中的更改。

有没有办法注意到这种情况何时发生并从流媒体中恢复视频图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:17:12.620

这就是 HTTP 实时流的设计方式。它将根据互联网连接的强度逐步选择更高或更低质量的流。如果连接速度不够快，“最后的手段”是继续播放音频但不播放视频。在这种情况下恢复视频图像的唯一方法是提高互联网连接的速度。

# tfs - 源代码控制文件夹不断弹出

> ID：14841425
> 
> 赞同：0
> 
> 时间：2013-02-12T20:42:27.123
> 
> 标签：tfs, visual-studio-2012

我玩过 Team Foundation Server 和 Visual Studio 2012，现在我的桌面上有 2 个文件夹，我一直在删除它们，但是在打开 vs 2012 时又弹回来了。

我在哪里永远删除它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:35:38.790

检查您的工作区以查看它们是否是映射文件夹。如果是，请删除这些映射。

# c# - asp图像根本不显示

> ID：14841426
> 
> 赞同：1
> 
> 时间：2013-02-12T20:42:29.257
> 
> 标签：c#, asp.net, webforms

我有这个简单的 asp.net 页面，其中包含定义 IMG 控件的这一行

> ```
>  <asp:Image src="~/Pics/about.png" ID="about" runat="server" /> 
> ```

图像文件的正确路径是：

[http://www.khaterah.com/Pics/about.png](http://www.khaterah.com/Pics/about.png)

但是此图像根本不显示在本地服务器或 Web 服务器上，我不知道为什么？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:45:27.783

您想使用该`ImageUrl`物业。不是`src`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:45:52.367

[asp:Image](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.image.aspx)控件使用[`ImageUrl`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.image.imageurl.aspx)属性而不是`src`

试试这个：

```
<asp:Image ImageUrl="~/Pics/about.png" ID="about" runat="server" /> 
```

# python - 从文件中编译由某个元素分隔的行。Python

> ID：14841428
> 
> 赞同：1
> 
> 时间：2013-02-12T20:42:30.910
> 
> 标签：python, function, indexing, line, fasta

文件：

```
>1
ATTTTttttGGGG
ccCgCgGAgggGGT
gggggttttTTTTTTTTT
>2
ATcggGGGGGGA
>3
ATCGGGGGGATTT
gggggttAGTAttt 
```

我正在构建一个读取具有这种格式的文件的函数。该格式中嵌入了多个文件，由'>'+名称分隔（例如'>1'，'>2'）

我正在尝试获取'>'行两侧的文本行并将它们编译成每个部分的一个字符串

所以这看起来像

```
name_list = ['>1','>2','>3']
sequence_list = ['ATTTTttttGGGGccCgCgGAgggGGTgggggttttTTTTTTTTT','ATcggGGGGGGA','ATCGGGGGGATTTgggggttAGTAttt']

import os
import re

# Open File

in_file=open(FASTA,'r')
dir,file=os.path.split(FASTA)
temp = os.path.join(dir,output)
out_file=open(temp,'w')

# Generating lines

lines = []
name_list = []
seq_list = []

for line in in_file:
    line = line.strip()
    lines.append(line)

in_file.close()

indx = range(0,len(lines))

# Organizing the elements
for line in lines:
    for i in line:
        if i == '>':
            name_list.append(line)
        else:
            break 
```

我不知道该怎么做 else: 语句我尝试用 range(0,len(lines)) 创建一个索引，所以也许我可以在它找到 '>' 的地方做一些事情，并为以下索引编译所有行，直到它找到下一个 '>' 并将它们添加到名为 seq_list 的列表中

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:48:15.237

您应该看一下具有解析器的[Biopython](http://biopython.org/wiki/SeqIO)`FASTA`，但这里有一个使用标准库的示例：

```
import re
with open('filename') as f:
    print [i.replace('\n','') for i in re.split(r'\>\d+',f.read()) if i] 
```

出去：

```
['ATTTTttttGGGGccCgCgGAgggGGTgggggttttTTTTTTTTT',
 'ATcggGGGGGGA',
 'ATCGGGGGGATTTgggggttAGTAttt'] 
```

* * *

使用`Biopython`[ `sudo pip install biopython`]：

```
from Bio import SeqIO
with open("example.fasta", "rU") as handle:
    print list(SeqIO.parse(handle, "fasta")) 
```

出去：

```
[SeqRecord(seq=Seq('ATTTTttttGGGGccCgCgGAgggGGTgggggttttTTTTTTTTT', SingleLetterAlphabet()), id='1', name='1', description='1', dbxrefs=[]), 
 SeqRecord(seq=Seq('ATcggGGGGGGA', SingleLetterAlphabet()), id='2', name='2', description='2', dbxrefs=[]),
 SeqRecord(seq=Seq('ATCGGGGGGATTTgggggttAGTAttt', SingleLetterAlphabet()), id='3', name='3', description='3', dbxrefs=[])] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:51:18.327

字典会让生活更轻松：

```
>>> d = {}
>>> with open('t.txt') as f:
...   for line in f:
...      if line.startswith('>'):
...         key = line.strip()
...         if key not in d:
...             d[key] = []
...      else:
...         d[key].append(line.strip())
... 
>>> d
{'>1': ['ATTTTttttGGGG', 'ccCgCgGAgggGGT', 'gggggttttTTTTTTTTT'],
 '>2': ['ATcggGGGGGGA'], '>3': ['ATCGGGGGGATTT', 'gggggttAGTAttt']}
>>> sequence_list = [''.join(k) for k in d.values()]
>>> sequence_list
['ATTTTttttGGGGccCgCgGAgggGGTgggggttttTTTTTTTTT',
 'ATcggGGGGGGA', 'ATCGGGGGGATTTgggggttAGTAttt'] 
```

# spring - JNDI spring嵌入式tomcat：maven多模块项目

> ID：14841431
> 
> 赞同：1
> 
> 时间：2013-02-12T20:42:39.033
> 
> 标签：spring, maven, jndi, multi-module, maven-tomcat-plugin

我仍然无法理解这件事：

这就是我的项目的样子：

```
--app
--app-core     (spring)
--app-model    (pojo)
--app-service  (jersey)  >> final package as war  (dependencies (appcore+appmodel)) 
```

现在我的 applicationContext.xml 应该放在哪里？？？Spring 的依赖项仅适用于 app-core ???? ...

**更新**

app-core (spring) 有 applicationContext.xml，知道我想将 JNDI 与嵌入式 tomcat (tomcat-maven-plugin) 一起使用。

在 webapp/META-INF 中创建了`context.xml` 它看起来像：-

```
<?xml version='1.0' encoding='utf-8'?>
<Context docBase="nweb" path="/nweb" reloadable="true">  
<WatchedResource>WEB-INF/web.xml</WatchedResource>  
<Resource name="jdbc/TestDS" auth="Container"
        type="javax.sql.DataSource"
        driverClass="net.sourceforge.jtds.jdbc.Driver"
        url="jdbc:sqlserver://localhost:1433;DatabaseName=TestData"
        username="sa" password=""/>     
  </Context> 
```

..

我的 applicationContext.xml ： -

```
 <?xml version="1.0" encoding="UTF-8"?>
 <beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans   
    http://www.springframework.org/schema/beans/spring-beans-3.2.xsd">

  <bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="java:/TestDS"></property>
</bean>     
 </beans> 
```

有了上面我得到以下错误：

```
 at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
   Caused by: javax.naming.NameNotFoundException: Name TestDSis not bound in this 
    Context
    at org.apache.naming.NamingContext.lookup(NamingContext.java:770)
    at org.apache.naming.NamingContext.lookup(NamingContext.java:153)
    at org.apache.naming.SelectorContext.lookup(SelectorContext.java:152)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at org.springframework.jndi.JndiTemplate$1.doInContext(JndiTemplate.java:154)
    at org.springframework.jndi.JndiTemplate.execute(JndiTemplate.java:87)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:152)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:178)
    at org.springframework.jndi.JndiLocatorSupport.lookup(JndiLocatorSupport.java:95)
    at org.springframework.jndi.JndiObjectLocator.lookup(JndiObjectLocator.java:105)
    at 
```

如果我错过了什么，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:52:26.950

通常，您会在您的 web.xml 上为您的根应用程序上下文配置一个 ContextLoaderListener：

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 
```

此类使用参数值 contextConfigLocation - 您可以从中显式指定 applicationContext.xml 的位置：

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath*:META-INF/spring/applicationContext*.xml</param-value>
</context-param> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T11:05:11.467

尝试

```
 <plugin>
    <groupId>org.apache.tomcat.maven</groupId>
    <artifactId>tomcat7-maven-plugin</artifactId>
    <configuration>
      <contextFile>webapp/META-INF/context.xml</contextFile>
    </configuration>
  </plugin> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-20T08:42:05.143

[您在这里](https://github.com/CloudBees-community/bees-shop-clickstart)有一个使用 JNDI 的应用程序。我一直在 PaaS 上使用 JNDI，他们解释了如何在您的应用程序和数据库之间进行绑定。您可以了解本[教程](https://developer.cloudbees.com/bin/view/RUN/Springframework)的更多详细信息。

基本上你需要把它放在你的 datasource.xml 文件中：

```
 <jee:jndi-lookup id="dataSource" jndi-name="jdbc/mydb" resource-ref="true"
   expected-type="javax.sql.DataSource"/> 
```

然后，在您的 Tomcat 服务器上，您有多种可能性，正如您在我放置链接的 Spring 教程中看到的那样。最简单的方法是转到 $CATALINA_HOME/conf/context.xml 并放置类似的内容。

```
<Resource auth="Container" driverClassName="com.mysql.jdbc.Driver" factory="org.apache.tomcat.jdbc.pool.DataSourceFactory" maxActive="20" maxIdle="10" minIdle="1" name="jdbc/mydb" password="dbUserPassword" testOnBorrow="true" testWhileIdle="true" type="javax.sql.DataSource" url="jdbc:mysql://localhost:3306/dbName" username="dbUserName" validationInterval="5000" validationQuery="select 1"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T19:15:58.840

尝试`<property name="jndiName" value="java:comp/env/TestDS"></property>`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-15T18:13:45.200

如果您使用的是嵌入式 tomcat 7，那么您应该调用

```
tomcat.enableNaming(); 
```

# ruby-on-rails - Rails 理论——没有数据库依赖？

> ID：14841432
> 
> 赞同：0
> 
> 时间：2013-02-12T20:42:39.900
> 
> 标签：ruby-on-rails, database, theory, rails-activerecord

我的印象是，使用 Rails，您不应该在数据库中定义任何依赖项，而只是使用您的 has_many 和 belongs_to 东西来定义关系。但是，我正在浏览rails guide，它有以下内容。

```
class CreateComments < ActiveRecord::Migration
  def change
    create_table :comments do |t|
      t.string :commenter
      t.text :body
      t.references :post

      t.timestamps
    end

    add_index :comments, :post_id
  end
end 
```

我以为这样不行……？我正在尝试做一些类似于评论字段的事情，每次调用 show 方法时都会创建一个新实例，但我认为没有这些“引用”和“add_index”，它不会将 post_id 存储在评论行中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:51:03.543

这个迁移所做的就是创建 post_id 并告诉数据库它应该索引这个列（提高性能）

`t.references :post`和so基本一样`t.integer :post_id`，是的，就是把post_id存储在comment里面。您仍然需要在模型中定义您的关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:53:05.760

你在哲学上实际上是错误的。

Rails 的魔力很好，只有在数据库级别由实际外键支持时。

[文档](http://guides.rubyonrails.org/association_basics.html#updating-the-schema)清楚地说明了这一点

当您正确命名外键时，Rails 的魔力就会出现，这样它就可以使用约定来找出关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:56:22.257

在 ORM 中表达关系有什么问题，这就是它应该完成的地方。我相信您在数据库供应商细节（例如外键约束和关系）之间混淆了。

```
 class Comment < ActiveRecord::Base
  attr_accessible :post, :post_id
  belongs_to :post
end

class Post < ActiveRecord::Base
  has_many :comments
end

class CommentsController < ApplicationController
  def create
    @comment = Comment.create(params[:comment])  # where params[:comment] = {post_id: 1, message: ''}
    @post = comment.post
    respond_with(@comment)
  end
end 
```

# vb.net - 试图在 Visual Basic 中删除以前创建的边框

> ID：14841441
> 
> 赞同：2
> 
> 时间：2013-02-12T20:43:04.310
> 
> 标签：vb.net, winforms, border

我有这个代码：

```
Sub drawborder()
    Dim objGraphics As Graphics
    objGraphics = Me.CreateGraphics
    objGraphics.Clear(System.Drawing.SystemColors.Control)
    objGraphics.DrawRectangle(System.Drawing.Pens.Red, picShowPicture.Left - 1,    picShowPicture.Top - 1, picShowPicture.Width + 1, picShowPicture.Height + 1)
    objGraphics.Dispose()
    borderstatus.Text = "Border Drawn"
End Sub 
```

这会在 PictureBox 周围绘制边框。现在我想使用另一个按钮再次删除它，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T22:35:15.653

不要使用`CreateGraphics`，这只是一个临时绘图，当您最小化表单或将其移出屏幕等时会被删除。

尝试持有一个变量，然后使表单无效：

```
Private _ShowBorder As Boolean

Public Sub New()
  InitializeComponent()
  Me.DoubleBuffered = True
End Sub

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
  _ShowBorder = Not _ShowBorder
  Me.Invalidate()
End Sub

Protected Overrides Sub OnPaint(e As PaintEventArgs)
  e.Graphics.Clear(Me.BackColor)

  If _ShowBorder Then
    e.Graphics.DrawRectangle(Pens.Red, PictureBox1.Left - 1, PictureBox1.Top - 1, PictureBox1.Width + 1, PictureBox1.Height + 1)
  End If

  MyBase.OnPaint(e)
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T22:26:51.300

使您的图形对象全局化。然后你可以调用 objGraphics.Clear(...) 来清除任何绘制图形的屏幕。例如：

```
Dim objGraphics as Grahpics

Public Sub Form1_Load(...) Handles Form1.Load
    objGraphics = Me.CreateGraphics()
End Sub

Public Sub DrawBorder()
    objGraphics.Clear(System.Drawing.SystemColors.Control)
    objGraphics.DrawRectangle(System.Drawing.Pens.Red, picShowPicture.Left - 1,       picShowPicture.Top - 1, picShowPicture.Width + 1, picShowPicture.Height + 1)
    borderstatus.Text = "Border Drawn"
End Sub

Public Sub ClearScreen()
    objGraphics.Clear(System.Drawing.SystemColors.Control)
    borderstatus.Text = "No Border"
End Sub 
```

# java - jtab中的组合框

> ID：14841442
> 
> 赞同：0
> 
> 时间：2013-02-12T20:43:05.747
> 
> 标签：java, jcombobox, jtabbedpane

我正在尝试在一个选项卡中创建一个组合框，而在另一个选项卡中创建一个按钮.. 但我面临的问题是我看不到组合框的项目..请帮助.. 还告诉我如何在另一个选项卡中导入图像..

```
import java.awt.*;
import java.awt.event.*;
//import java.swing.*;
import java.util.*;

import javax.swing.*;
class c_box extends JFrame {
    public static void main(String args[])
    {
        JFrame frame = new JFrame("Combo Box Demo");

        Panel p=new Panel();
        //  GridLayout gl=new GridLayout(1, 3, 30, 30);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(800, 800);

        Vector comboBoxItems=new Vector();
        Vector comboBoxItems2=new Vector();
        Vector comboBoxItems3=new Vector();

        comboBoxItems.add("A");
        comboBoxItems.add("B");
        comboBoxItems.add("C");
        comboBoxItems.add("D");
        comboBoxItems.add("E");

        comboBoxItems2.add("1");
        comboBoxItems2.add("2");
        comboBoxItems2.add("3");
        comboBoxItems2.add("4");

        comboBoxItems3.add("1a");
        comboBoxItems3.add("2b");
        comboBoxItems3.add("3c");
        comboBoxItems3.add("4d");

        final DefaultComboBoxModel model = new DefaultComboBoxModel(comboBoxItems);
        final DefaultComboBoxModel model2 = new DefaultComboBoxModel(comboBoxItems2);
        final DefaultComboBoxModel model3 = new DefaultComboBoxModel(comboBoxItems3);

        JComboBox comboBox = new JComboBox(model);
        JComboBox comboBox2 = new JComboBox(model2);
        JComboBox comboBox3 = new JComboBox(model3);

        p.add(comboBox,BorderLayout.WEST);
        p.add(comboBox2);
        p.add(comboBox3);

        JTabbedPane tab=new JTabbedPane();
        frame.add(tab, BorderLayout.CENTER);

        JButton button = new JButton("Add new element in combo box");
        tab.add("tab1",p);
        tab.add("tab1",button);

        frame.setVisible(true);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T13:16:42.790

您不能直接将 JButton 添加到 JTabbedPane 中，您需要将 JBuuton 附加到 JPanel，然后将 JPanel 添加到 JTabbedPane，如下所示。

```
JPanel panel = new JPanel();
JButton button = new JButton("Add new element in combo box");
panel.add( button);
tab.add("tab1",panel); 
```

# c# - 如果文件的内容长度大于本地副本或此后已被修改，如何指定应获取文件？

> ID：14841444
> 
> 赞同：0
> 
> 时间：2013-02-12T20:43:07.793
> 
> 标签：c#, http, http-headers, httpwebrequest, httpwebresponse

我知道如何提出“仅当文件自特定日期以来已被修改时才获取文件”的请求。

```
HttpWebRequest request = (HttpWebRequest) WebRequest.create(url);
request.IfModifiedSince = lastWriteTime; // lastWriteTime is the time when 
                                         // the local file was last written.

try
 {
    HttpWebResponse response = (HttpWebResponse) request.GetResponse();
    ... 
```

但是，假设发生这种情况 -

本地文件自上次写入后没有修改，但上次从服务器下载时，**文件不完整**。换句话说，本地文件中的内容长度与服务器上文件中的内容长度不同。

所以我想指定应该从服务器获取文件，如果服务器上的内容长度与本地机器上的内容长度不同。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:43:06.740

对于您的场景并且仅使用 HTTP，我将检查文件长度标头：

```
 string length = response.Headers[HttpResponseHeader.ContentLength]; 
```

所以你会从一开始就知道这个文件应该有什么长度。如果太短则不完整，您需要重新下载。

如果您更关心文件的内容，您还可以查看 MD5：

```
 string md5 = response.Headers[HttpResponseHeader.ContentMd5]; 
```

如果您坚持请求条件，您可以尝试 HTTP 标头**If-Range**。W3C 将其描述为：

> ... 非正式地，它的意思是`如果实体没有改变，把我丢失的部分发给我；否则，把整个新实体发给我”。...

检查[标头字段定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)和[HTTP 标头字段](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields)以查看您的选项。

# python - python导入与来自...导入

> ID：14841452
> 
> 赞同：0
> 
> 时间：2013-02-12T20:43:39.450
> 
> 标签：python

为什么我必须这样做：

`from entertainment_website.models import Event`

代替

`import entertainment_website.models.Event`

我得到的第二个：

```
 ImportError: No module named Event 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T20:45:15.940

因为`Event`似乎不是可导入的模块/命名空间，而是前者的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:45:19.950

`Event`不是一个模块，它是一个类（好吧，我按照命名约定假设一个类）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:46:52.333

在 Python 中，第一个从模块中导入类。第二个导入 MODULE 而不是类。

# jquery - jquery：更短的代码（if & var）

> ID：14841459
> 
> 赞同：0
> 
> 时间：2013-02-12T20:44:24.440
> 
> 标签：jquery, variables, if-statement, shortcut, shorthand-if

这可能是一个愚蠢的问题，但我有一个问题不是代码无法运行 - 而是代码太长了......

一切正常，但例如有没有办法缩短**if/else**？或者是否可以使用更短的代码跟踪 4 个不同的**var ？**

```
var transitionState_N = '-';
var transitionState_X = '-';
var transitionState_Y = '-';
var transitionState_Z= '-';

// carousel 4way
function carousel_4way_N (n, el, m) {
    var carousel = '#carousel-4way-nav-' + n
    var carousel_content = '#carousel-4way-' + n
        if (transitionState_N == '-')
          {
          transitionState_N = '+';
          }
          else
          {
          transitionState_N = '-';
          }
        $(carousel_reset).hide();
        $(carousel).transition(
        {y: m + '=10',delay:200}
        );
        };

function carousel_4way_X (n, el, m) {
    var carousel = '#carousel-4way-nav-' + n
    var carousel_content = '#carousel-4way-' + n
        if (transitionState_X == '-')
          {
          transitionState_X = '+';
          }
          else
          {
          transitionState_X = '-';
          }
        $(carousel_reset).hide();
        $(carousel).transition(
        {y: m + '=10',delay:200}
        );
        };

function carousel_4way_Y (n, el, m) {
    var carousel = '#carousel-4way-nav-' + n
    var carousel_content = '#carousel-4way-' + n
        if (transitionState_Y == '-')
          {
          transitionState_Y = '+';
          }
          else
          {
          transitionState_Y = '-';
          }
        $(carousel_reset).hide();
        $(carousel).transition(
        {y: m + '=10',delay:200}
        );
        };

function carousel_4way_Z (n, el, m) {
    var carousel = '#carousel-4way-nav-' + n
    var carousel_content = '#carousel-4way-' + n
        if (transitionState_Z == '-')
          {
          transitionState_Z = '+';
          }
          else
          {
          transitionState_Z = '-';
          }
        $(carousel_reset).hide();
        $(carousel).transition(
        {y: m + '=10',delay:200}
        );
        };

$('#carousel-4way-nav-1').click(function(event){
    $(carousel_reset_nav).not(this).transition(
    {y:0});
    return carousel_4way_N(1, this, (transitionState == '-') ? '+' : '-');
    event.preventDefault();
});

$('#carousel-4way-nav-2').click(function(event){
    $(carousel_reset_nav).not(this).transition(
    {y:0});
    return carousel_4way_X(2, this, (transitionState == '-') ? '+' : '-');
    event.preventDefault();
});

$('#carousel-4way-nav-3').click(function(event){
    $(carousel_reset_nav).not(this).transition(
    {y:0});
    return carousel_4way_Y(3, this, (transitionState == '-') ? '+' : '-');
    event.preventDefault();
});

$('#carousel-4way-nav-4').click(function(event){
    $(carousel_reset_nav).not(this).transition(
    {y:0});
    return carousel_4way_Z(4, this, (transitionState == '-') ? '+' : '-');
    event.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:45:57.270

三元运算符使其更具可读性：

```
transitionState_N  = (transitionState_N == '-') ? '+' : '-'; 
```

您的功能确实是重复的。寻找您经常重复的代码并编写一个函数来替换它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:30:42.587

这是我要做的：首先，您可以将 click() 函数分配给所有元素。然后，您可以获取每个元素的 id 并提取最后一个数字字符。

```
$('#carousel-4way-nav-1, #carousel-4way-nav-2,#carousel-4way-nav-3, #carousel-4way-nav-4').click(function(event){
    $(carousel_reset_nav).not(this).transition(
    {y:0});
    return carousel_4way(($(this).attr('id')).substring(this.length -1), this, (transitionState == '-') ? '+' : '-');
    event.preventDefault();
}); 
```

现在所有这些都将调用相同的函数：

```
function carousel_4way(n, el, m) {
    var carousel = '#carousel-4way-nav-' + n
    var carousel_content = '#carousel-4way-' + n
        switch(n){
            case 1:
               transitionState_N  = (transitionState_N == '-') ? '+' : '-';
            case 2:
               transitionState_X = ...
            ...
        }
     $(carousel_reset).hide();
     $(carousel).transition(
        {y: m + '=10',delay:200}
     );
}; 
```

您可能需要处理语法，但您会明白一般的想法

# python - 使用 'yield' 进行上下文切换

> ID：14841460
> 
> 赞同：5
> 
> 时间：2013-02-12T20:44:32.113
> 
> 标签：python, gevent

我正在阅读 gevent 教程并看到了这个有趣的片段：

```
import gevent

def foo():
    print('Running in foo')
    gevent.sleep(0)
    print('Explicit context switch to foo again')

def bar():
    print('Explicit context to bar')
    gevent.sleep(0)
    print('Implicit context switch back to bar')

gevent.joinall([
    gevent.spawn(foo),
    gevent.spawn(bar),
]) 
```

其中执行流程是这样的 foo -> bar -> foo -> bar 。如果没有 gevent 模块但使用 yield 语句就不能做同样的事情吗？我一直在尝试用'yield'来做到这一点，但由于某种原因我无法让它工作...... :(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T21:28:03.913

用于此目的的生成器通常称为*任务*（在许多其他术语中），为了清楚起见，我将在此处使用该术语。是的，有可能。事实上，有几种方法在某些情况下有效且有意义。但是，没有（我知道的）至少有一个`gevent.spawn`和`gevent.joinall`. 更强大和设计良好的那些需要两者的等价物。

根本问题是这样的：生成器可以暂停（当它们命中时`yield`），但仅此而已。要再次启动它们，您需要一些其他代码来调用`next()`它们。事实上，你甚至需要调用`next()`一个新创建的生成器，让它开始做*任何事情*。同样，生成器本身也不是决定接下来应该运行什么的最佳位置。因此，您需要一个循环来启动每个任务的时间片（将它们运行到下一个`yield`）并无限期地在它们之间切换。这通常称为调度程序。它们往往很快就会变得非常多毛，所以我不会尝试在一个答案中编写完整的调度程序。但是，我可以尝试解释一些核心概念：

*   通常将`yield`控制权交还给调度程序（实际上类似于`gevent.sleep(0)`您的代码）。这意味着，生成器会做它想做的任何事情，并且当它处于上下文切换方便且可能有用的地方时，它就是`yield`。
*   在 Python 3.3+ 中，`yield from`它是一个非常有用的工具，可以委托给另一个生成器。如果您不能使用它，您必须让调度程序模拟调用堆栈并将返回值路由到正确的位置，并`result = yield subtasks()`在您的任务中执行类似的操作。这更慢，实现起来更复杂，并且不太可能产生有用的堆栈跟踪（`yield from`免费这样做）。但直到最近，这是我们拥有的最好的。
*   根据您的用例，您可能需要各种工具来管理任务。常见的例子是产生更多的任务，等待一个任务完成，等待几个任务中的任何一个完成，检测其他任务的失败（未捕获的异常）等。这些通常由调度程序处理，任务被赋予一个 API与调度程序通信。进行这种交流的一种简洁（但并不总是完美）的方式是制定`yield`特殊价值观。
*   基于生成器的任务和 gevent（以及类似的库）之间的一个相当重要的区别是后者中的上下文切换是隐式的，而任务使得识别上下文切换变得微不足道：只有`yield [from]`可能运行调度程序代码的事情。例如，您可以通过查看代码来确定一段代码是否是原子的（针对其他任务；如果您将线程添加到混合中，您必须独立担心它们），而无需检查它调用的*任何内容。*

最后，您可能对 Greg Ewing关于创建此类调度程序的[教程感兴趣。](http://www.cosc.canterbury.ac.nz/greg.ewing/python/generators/yf_current/Examples/Scheduler/scheduler.txt)（这是在`python-ideas`对现在的 PEP 3156 进行头脑风暴时出现的。这些邮件线程也可能对您感兴趣，尽管基于 Web 的存档并不真正适合阅读半年前编写的数十个线程中的数百封邮件。 )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T21:09:58.147

关键是要意识到你必须提供自己的驾驶循环——我在下面提供了一个简单的演示。我很懒，使用 Queue 对象来提供 FIFO，我已经有一段时间没有将 python 用于重大项目了。

```
#!/usr/bin/python

import Queue

def foo():
    print('Constructing foo')
    yield
    print('Running in foo')
    yield
    print('Explicit context switch to foo again')

def bar():
    print('Constructing bar')
    yield
    print('Explicit context to bar')
    yield
    print('Implicit context switch back to bar')

def trampoline(taskq):
    while not taskq.empty():
        task = taskq.get()
        try:
            task.next()
            taskq.put(task)
        except StopIteration:
            pass

tasks = Queue.Queue()
tasks.put(foo())
tasks.put(bar())

trampoline(tasks)

print('Finished') 
```

运行时：

```
$ ./coroutines.py 
Constructing foo
Constructing bar
Running in foo
Explicit context to bar
Explicit context switch to foo again
Implicit context switch back to bar
Finished 
```

# c# - 在特定条件下显示错误消息（空列表）

> ID：14841461
> 
> 赞同：4
> 
> 时间：2013-02-12T20:44:38.210
> 
> 标签：c#, asp.net-mvc

在我的控制器中，我根据用户首先选择的参数过滤列表。它就像一个搜索引擎。

该列表有可能返回 0 值。虽然这不是错误，但我想显示某种消息，例如错误消息，但到目前为止我发现的只是在 c# 中使用 ModelState 或 ModelStateDictionary，这也需要异常。但这也不例外，只是一个条件，所以我有点疑惑。

我将写出一些代码，以便您直观地看到我想要的内容：

```
 if(listOBJS.count == 0)
    {
        // DISPLAY THE ERROR!
        PopulateDDL1();
        PopulateDDL2();
        return View(listOBJS);
    } 
```

对，这就是我想做的事情。我该如何继续？感谢您的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T20:47:41.383

ModelState 不需要例外。您可以使用任何您想要的消息添加 Modelstate 错误，并使用常规方法检查 ModelState.isValid 以决定是继续还是返回视图以显示错误。

```
ModelState.AddModelError("", "Your Error Message"); 
```

或者，您也可以使用`ViewBag`或`ViewData`隐藏消息。

```
ViewBag.ErrorMessage = "Your Error Message";
ViewData["ErrorMessage"] = "Your Error Message"; 
```

然后在视图中它们可以显示

```
@Html.ValidationMessage("ModelName")
@ViewData["ErrorMessage"]
@ViewBag.ErrorMessage 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-12T18:06:03.583

如果您没有传递 Model 并且不想使用 ModelState 检查，则可以将任何消息传递给 ViewBag 并在视图中检查它的值。如果它在那里，则在视图中显示它。

控制器：

```
public FileResult Download(string fileName)
{
   if (string.IsNullOrEmpty(fileName) || !File.Exists(fileName))
   {
       ViewBag.Error = "Invalid file name or file path";
       RedirectToAction("Index");
   }

   // rest of the code
} 
```

索引视图

```
@if (ViewBag.Error != null)
{
    <h3 style="color:red">@ViewBag.Error</h3>
} 
```

# xml - 使用 Perl 的 XML::Simple 时不是数组引用

> ID：14841464
> 
> 赞同：1
> 
> 时间：2013-02-12T20:44:46.553
> 
> 标签：xml, perl, parsing

我正在进入 XML::Simple 并且在解析一条记录时遇到了 XML::Simple 模块阻塞的问题。perl代码如下......

```
#!/usr/bin/perl
# use module
use warnings;
use strict;
use XML::Simple;
use Data::Dumper;

# create object
my $xml = new XML::Simple;

# read XML file
my $data = $xml->XMLin("owners.xml");

foreach my $e (@{$data->{Owner}})
{
     print $e->{OwnerId}->{OwnerCik}."\n";
     print $e->{OwnerId}->{OwnerName}."\n";
     print "\n";
} 
```

当我使用这个 XML 时，它工作得很好......

```
<?xml version="1.0"?>
<ownershipDocument>
    <Owner>
        <OwnerId>
            <OwnerCik>0001234878</OwnerCik>
            <OwnerName>PUBLIC JOHN Q</OwnerName>
        </OwnerId>
    </Owner>
    <Owner>
        <OwnerId>
            <OwnerCik>0001234877</OwnerCik>
            <OwnerName>PUBLIC JANE Q</OwnerName>
        </OwnerId>
    </Owner>
</ownershipDocument> 
```

当我有一个记录时，我有问题......下面的 XML 是一个例子......

```
<?xml version="1.0"?>
<ownershipDocument>
    <Owner>
        <OwnerId>
            <OwnerCik>0001234878</OwnerCik>
            <OwnerName>PUBLIC JOHN Q</OwnerName>
        </OwnerId>
    </Owner>
</ownershipDocument> 
```

我在解析时得到的错误是......

```
Not an ARRAY reference at ./so_parse.pl line 14. 
```

我认为解决方案是使用 ForceArray，我将其更改为包含 ForceArray..

```
my $data = $xml->XMLin("so_single.xml", ForceArray=>1); 
```

现在我得到......

```
Not a HASH reference at ./so_parse.pl line 16. 
```

诚然，我对复杂的数据结构有点模糊，但我想要解决的是当我们只有一个时如何解析这些所有者。

任何帮助都会很棒！珍妮

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T20:57:59.743

试试这个：

```
my $data = $xml->XMLin("so_single.xml", ForceArray=>['Owner']); 
```

它应该只[强制](http://search.cpan.org/~grantm/XML-Simple-2.20/lib/XML/Simple.pm#ForceArray_=%3E_%5B_names_%5D_#_in_-_important)“所有者”元素上的数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:46:46.970

这是逻辑和正常的。在第一个 XML 文件中，您有多个所有者，而在第二个 XML 文件中没有。当你这样做

```
my $data = $xml->XMLin("owners.xml"); 
```

您在 Perl 数据结构中“转换”XML，重复的节点位于 Perl 数组中，而不是其他节点。

你可以做什么：

```
#!/usr/bin/perl
# use module
use warnings;
use strict;
use XML::Simple;
use Data::Dumper;

# create object
my $xml = new XML::Simple;

# read XML file
my $data = $xml->XMLin("owners.xml");

# if $data->{Owner} is an ARRAY ref
if (ref($data->{Owner}) =~ /ARRAY/) {
    foreach my $e (@{$data->{Owner}}) {
         print $e->{OwnerId}->{OwnerCik}."\n";
         print $e->{OwnerId}->{OwnerName}."\n";
         print "\n";
    }
} else {
    print $data->{Owner}->{OwnerId}->{OwnerCik}."\n";
    print $data->{Owner}->{OwnerId}->{OwnerName}."\n";
} 
```

# c# - 从 C# 类到 JavaScript 等价物的自动代码生成

> ID：14841465
> 
> 赞同：7
> 
> 时间：2013-02-12T20:44:50.487
> 
> 标签：c#, javascript, code-generation, json.net

我想将我用 C# 编写的类公开给 javascript 等价物。

例如我有一个像这样的类：

```
// C# class to represent an Appriaser
public class Appraiser
{
    public Appraiser(appraiserId, appraiserName)
    {
         AppraiserId = appraiserId;
         AppraiserName = appraiserName;
    }
    public int AppraiserId { get; set; }
    public string AppraiserName { get; set; }
} 
```

我希望能够在 javascript 中自动生成此类的一个版本

```
// javascript class to represent an Appraiser
function Appraiser(appraiserId, appraiserName) {
    var self = this;
    self.appraiserid= appraiserId;
    self.appraisername= appraisername;
} 
```

JSON.NET 或其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-10-23T02:10:53.770

你可以试试[sharp2Js](https://github.com/castle-it/sharp2Js)。您将类型传递给它，然后它将其转换为 C# 字符串。`T4`如果您希望它输出到 js 文件，请将其与模板一起使用。对于您示例中的类，它产生：

将它与您的示例一起使用：

```
var str = Castle.Sharp2Js.JsGenerator.
              GenerateJsModelFromTypeWithDescendants(typeof(Appraiser), true, "example"); 
```

输出：

```
example = {};

example.Appraiser = function (cons, overrideObj) {
    if (!overrideObj) { overrideObj = { }; }
    if (!cons) { cons = { }; }
    var i, length;
    this.appraiserId = cons.appraiserId;
    this.appraiserName = cons.appraiserName;

    this.$merge = function (mergeObj) {
        if (!mergeObj) { mergeObj = { }; }
        this.appraiserId = mergeObj.appraiserId;
        this.appraiserName = mergeObj.appraiserName;
    }
} 
```

注意：我是 的维护者`sharp2Js`，它还很年轻，所以功能还不丰富（欢迎任何建议），但它可能适合您对简单用途的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T22:17:38.657

你可以试试[JSIL](http://jsil.org/)。它将允许您从 .Net IL 转换为 JavaScript。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T21:59:39.407

是和不是。但更多的是“不”而不是“是”。

没有什么可以直接从您的 .NET 类创建 javascript 类。您可以来回传递*数据*，这就是@jbabey 的链接的意义所在，但您不能互换使用它们。

您*可以*编写 C# 代码，在页面呈现时将类写入页面（以便您可以将 JSON 转换回另一端的对象），方法是使用反射迭代所有公共属性和构造函数，但您仍然不会不能在它们之间复制**功能**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-22T14:25:01.553

我知道我正在解决一个老问题，但是这些天有一些选择。

有一个用于 Visual Studio[的淘汰生成器类](https://visualstudiogallery.msdn.microsoft.com/32c15a80-1c54-4e96-a83f-7cd57573a5d2)，它将为您创建淘汰视图模型。此外，如果您进入 Typescript - 在课堂上使用 Web Essentials“生成 Typescript”选项将使您获得很多帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-27T18:06:11.180

发现 Nik Hilk 有一个名为 Script# 的项目，它将从 C# 2.0 代码生成 javascript 等效项。这有效地解决了我对简单 C# 类到 javascript 组件的问题。真正巧妙的是 Script# 也可以很好地与 jQuery 和我的 Knockout 视图模型一起使用！:-)

[链接到脚本#](http://scriptsharp.com/)

# r - 如何基于当前因子创建新因子？

> ID：14841468
> 
> 赞同：1
> 
> 时间：2013-02-12T20:45:07.173
> 
> 标签：r, r-factor

在`R`中，我想做的是通过在另一个因子或字符串中“分组”值来创建一个因子。

```
 factor1 <- as.factor(c("A","B","C","D")) 
```

我想要的是创建一个`factor2`这样的`A`& `B`are`E`和`C`& `D`are `F`。我尝试过循环，但无法让它工作，但相信必须有一种优雅的`R`方式来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:02:31.713

```
 library(car)
 fac2 <- recode( factor1, " c('A', 'B') = 'E';
                            c('C', 'D') = 'F' ")
 fac2

# [1] E E F F
Levels: E F 
```

注意需要跟踪两种引号和需要使用“;” 分组子句之间。还有一个“else”参数，帮助页面`?car::recode`将描述。对于修改后的问题，`recode`策略会起作用，但也会成功：

```
fac2 <- 0 + factor1 %in%  c('CA', 'OR', 'WA', 'AK')  # numeric result
fac2 <- factor(fac2) # factor result which displays like a character vector 
```

注意 state.abb 实际上是一个系统常数，尽管它是字符向量而不是一个因子：

```
 sts <- state.abb[sample(50)]   # a scrambled version
 sts[ sts %in% c('CA', 'OR', 'WA', 'AK')]
#[1] "CA" "AK" "OR" "WA" 
```

对于 car::recode 的使用，此代码成功（请注意，`recode`如果给定一个因子作为输入，则返回一个因子，我没有这样做）：

```
 recode(sts, " c('CA', 'OR', 'WA', 'AK') = 1; else=0")
#-------
 [1] 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1
[45] 0 0 0 0 0 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:47:51.590

这是你所期待的吗？

```
factor2 <- factor1
levels(factor2) <- rep(c("E","F"), each=2)

# [1] E E F F
# Levels: E F 
```

使用@DWin 的例子，我会做这样的事情：

```
set.seed(2)
sts <- state.abb[sample(50)]
# your factor1 would be
factor1 <- factor(sts)
# you would construct factor2 as 
factor2 <- factor(0 + factor1 %in% c('CA', 'OR', 'WA', 'AK')) 
```

# cuda - 我可以同时为“cublas”导入第 4 版，同时为“cudart”库导入第 5 版吗？

> ID：14841472
> 
> 赞同：0
> 
> 时间：2013-02-12T20:45:21.197
> 
> 标签：cuda, cublas

听起来可能很奇怪，但情况是，在将 CUDA4 升级到 CUDA5 后，我发现自己的内核运行得更快，但 cublas 函数（例如 cublasDgemm）变得更慢。此外，cublasDgemm 似乎在版本 5 中调用了一些岩浆材料。

所以，我想知道我是否可以为“cublas”导入版本 4，而为“cudart”库导入版本 5。作为一个简单的试验，我有一个代码（mycode.cc）：

```
#include <iostream>
#include <stdio.h>
#include <cublas.h>
#include <cublas_v2.h>

using namespace std;

int main()
{
    int ver;
    cudaRuntimeGetVersion(&ver);
    cout<<"cudart version: "<<ver<<endl;

    cublasHandle_t hdl;
    cublasCreate(&hdl);
    cublasGetVersion(hdl, &ver);
    cout<<"cublas version: "<<ver<<endl;
} 
```

并尝试：

```
g++ -I /opt/cuda/include/ -L /opt/cuda/lib64/ -lcudart -I /opt/cuda-5.0/include/ -L /opt/cuda-5.0/lib64/ -lcublas mycode.cc 
```

我的系统有一个“模块”设置，我尝试了“模块加载 cuda4”和“模块加载 cuda5”。有趣的是，它在“module load cuda4”时编译，然后它报告：

```
cudart version: 4010
cublas version: 4010 
```

这不是我想要的cudart。此外，当我“模块加载 cuda5”时，它仍然编译，但运行可执行文件失败：

```
./a.out: error while loading shared libraries: libcudart.so.4: cannot open shared object file: No such file or directory 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-08T15:25:15.653

运行时有verisoning，你不能混合运行时版本，也不能在不同的运行时版本上构建库。所以，不，这不起作用，因为 CUBLAS 4.2 需要 CUDA 4.2 运行时库并且不能与 CUDA 5.0 一起使用。

[这个答案从评论中添加为社区 wiki 答案，以将问题从未回答列表中删除]

# java - 无法在 JSP 中显示 servlet 值

> ID：14841473
> 
> 赞同：0
> 
> 时间：2013-02-12T20:45:23.850
> 
> 标签：java, html, jsp, servlets

长话短说，我无法让我的 servlet 变量显示在我的 JSP 页面中。我尝试过类似的方法

```
 <p><$= request.getAttribute("foo") %></p> 
```

也

```
 <p>"${foo}"</p> 
```

并在顶部导入页面，无论有无。

我的 servlet（在底部注释了测试变量的位置）：

```
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException
{
    //String that gets returned as HTML
    StringBuilder returnAsHTML = new StringBuilder();

    //Cycles through the parameter(s) sent from the serialized form
    Enumeration<String> parameterNames;

    //Holds all of the parameter(s) values
    LinkedList<String> valuesIn = new LinkedList<String>();

    //Gets all of the parameter names from the serialized form
    parameterNames = request.getParameterNames();

    //Iterate through the enumeration of the parameters
    while(parameterNames.hasMoreElements())
    {
        String currentParameter = parameterNames.nextElement();
        String currentValue = request.getParameter(currentParameter);

        //Prevent a blank value from being added from the text fields (which is what they default to
        //if the user didn't enter anything for "Section:" or "Teacher:").
        if(!currentValue.contentEquals(""))
        {
            valuesIn.add(currentValue);
        }//Else doNothing();
    }

    //Set the section to query, if the user wanted one to search for
    if(request.getParameter("section").isEmpty())
    {
        sectionToQuery = "";
    }
    else
    {
        sectionToQuery = request.getParameter("section").toUpperCase();
    }

    //Set the teacher to query, if the user wanted one to search for
    if(request.getParameter("teacher").isEmpty())
    {
        teacherToQuery = "";
    }
    else
    {
        teacherToQuery = request.getParameter("teacher").toUpperCase();
    }

    //THIS BEGINS THE QUERY - BE SURE TO BREAK THIS DOWN TO OTHER METHODS

    //STAGE 1 See what semesters they are needing, eliminate the ones they don't need.
    resultSet = determineSemesters(valuesIn);

    //STAGE 2 See what locations they are needing, eliminate the ones they don't need.
    determineLocations(resultSet, valuesIn);

    //STAGE 3 See what sections they are needing, eliminate the ones they don't need.
    determineSections(resultSet, valuesIn);

    //STAGE 4 See what instructors they are needing, eliminate the ones they don't need.
    determineInstructors(resultSet, valuesIn);

    //STAGE 5 See if they want to include closed classes or not, eliminate what they don't need.
    determineClosedOrNotClosedCourses(resultSet, valuesIn);

    //SEARCH IS DONE, the remaining elements in "resultSet" are the product of their search. Find
    //The enrollment and the credits that is in resultSet.

    //THIS IS WHERE I AM TESTING IT////////////////
    int foo = 20;
    request.setAttribute("foo", foo);

    //Check to see if the result set is empty
    if(resultSet.isEmpty())
    {
        returnAsHTML.setLength(0);
        returnAsHTML.append("<tr><td colspan='15'><h1>No Results...</h1></tr>");
    }
    else//It's not empty, so style the classes.
    {
        //Make sure results are sorted
        Collections.sort(resultSet);

        //Style all the classes
        for(ClassInfo classes : resultSet)
        {
           returnAsHTML.append(styleClass(classes));
        }//End styling of classes
    }

    //Send back the result
    response.getWriter().write(returnAsHTML.toString());

} 
```

作为 JSP 的新手，我有一些想法。在我看到的示例中，似乎人们使用 response.sendRedirect() 或类似的东西来重定向或转发页面。另一个可能是因为我没有将 int 转换为字符串。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:06:22.393

首先，要将您的 Servlet 重定向到适当的 JSP 页面，您应该使用[RequestDispatcher](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html)，如下所示：

```
RequestDispatcher rd = request.getRequestDispatcher("/someJsp.jsp"); 
rd.forward(request, response); 
```

要获得您应该使用的值：

```
<p><%= request.getAttribute("foo") %></p> 
```

但这是旧的而不是正确的做法。您应该避免在 JSP 页面中使用脚本。为此，我们有[表达语言。](http://docs.oracle.com/javaee/1.4/tutorial/doc/JSPIntro7.html)例如：

```
<p>
   <c:out value="${requestScope['foo']}"/>
</p> 
```

**也可以看看：**

*   [SO Servlets Wiki 页面](https://stackoverflow.com/tags/servlets/info)
*   [JavaServer Pages 标准标签库](http://www.oracle.com/technetwork/java/index-jsp-135995.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:07:15.370

在你的 doGet() 实现中试试这个：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response)
{
    Object data = "Some data, can be a String or a Javabean";
    request.setAttribute("data", data);
    request.getRequestDispatcher("/WEB-INF/page.jsp").forward(request, response);
} 
```

然后在您的 JSP 中：

```
<p>The data from servlet: ${data}</p> 
```

希望有帮助！

# objective-c - 使用 ARC 传递指向 NSArray 内部对象的指针

> ID：14841477
> 
> 赞同：1
> 
> 时间：2013-02-12T20:45:33.307
> 
> 标签：objective-c, pointers, reference, automatic-ref-counting, bridge

我正在转换为 ARC，并且找不到任何方法来摆脱这个编译器错误而不破坏代码。

我需要将 2 个对象传递给选择器，因此我将它们都添加到数组中，如下所示，并将该数组发送到选择器：

```
LWPagerContent* content = nil;
NSArray* args = [NSArray arrayWithObjects:article, [NSValue valueWithPointer:&content], nil];

[self performSelectorOnMainThread:@selector(initArticlePagerContent:) withObject:args waitUntilDone:YES]; 
```

该方法访问数组，但需要修改数组中引用的地址处的对象。它应该初始化 LWPagerContent 对象，如图所示，然后该对象将由调用 performSelector 的原始方法使用。

```
- (void)initArticlePagerContent:(NSArray*)args {
Article* article = [args objectAtIndex:0];

LWPagerContent** contentPtr = [[args objectAtIndex:1] pointerValue];
*contentPtr = [[NSClassFromString([StyleSheet articleContentClass]) alloc] initWithArticle:article]; 
```

}

这很好用，但是当我尝试转换为 ARC 时，我立即被告知`"Implicit conversion of a non-Objective-C type 'void *' to 'LWPagerContent *__strong *' is disallowed with ARC"`. 此错误发生在以（上面显示的倒数第二个）开头的行上`"LWPagerContent **..."`。我已经尝试过使用`__bridge`和`__autoreleasing`其他帖子中的建议，但似乎没有任何效果。任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T21:13:37.300

使用块进入主线程，消除了 -performSelector: 调用所隐含的元编程。

然后使用回调来设置生成的内容。

IE

```
dispatch_sync(dispatch_get_main_queue(), ^{
    LWPagerContent *newContent = ... do something ...
    [self setPagerContent:newContent];
}); 
```

一些注意事项：

*   `init...`除非是初始化方法，否则不应调用方法

*   通常要避免通过引用传递

*   元编程破坏了编译器进行完整性检查的能力。躲开它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:17:42.330

编译器不知道如何处理您的原始指针。您应该明确说明您期望什么样的内存管理策略。在您的情况下，它可能类似于

```
LWPagerContent * __strong *contentPtr = (LWPagerContent * __strong *)[[args objectAtIndex:1] pointerValue]; 
```

类型是“指向强指针的指针`LWPagerContent`”。从现在开始`*contentPtr`将被 ARC 视为强指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:10:08.737

你有没有尝试过：

```
NSValue* contentPtrPtr = [args objectAtIndex:1];
LWPagerContent** contentPtr = [contentPtrPtr pointerValue]; 
```

# sql - 从源插入多行

> ID：14841482
> 
> 赞同：0
> 
> 时间：2013-02-12T20:45:39.753
> 
> 标签：sql, sql-server-2008

运行 SQL Server 2008。

每次执行此查询时，我都会创建一个临时表，并尝试找到一种方法，如果要输入多于 1 行，如何添加多行。我有客户的收据信息。

```
create table #temp (col1 varchar(100),col2 varchar(100),col3 varchar(100))

insert into #temp (col1, col2, col3)values('Store ID', '01', '')
insert into #temp (col1, col2, col3)values('Product','Quantity','Amount')
insert into #temp (col1, col2, col3)values
(
  (select product from receipt where receiptnum = 1),
  (select quantity from receipt where receiptnum = 1),
  (select amount from receipt where receiptnum = 1),
)
select * from #temp 
```

给我输出（这是我的整个数据结构，但相同的概念只是为了不让代码泛滥）： ![在此处输入图像描述](../Images/26f22bfb47cb1b7d4eea9b40fa74bb1e.png)

我的问题是，如果收据有超过 1 个产品，我该怎么做，而事先不知道。显示此数据所需的只是收据编号和商店编号，因此我不知道要输入的行数。

环顾四周，似乎我将不得不使用光标，但我对光标的知识一无所知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:52:22.533

用下面的语句替换第三个插入语句会将所有记录插入到选择中返回的临时表中。

```
insert into #temp
select product, quality, amount from receipt where receiptnum = 1 
```

# html - 如何使用 Nokogiri 解析 TABLE 文本？

> ID：14841489
> 
> 赞同：2
> 
> 时间：2013-02-12T20:46:07.223
> 
> 标签：html, ruby, parsing, nokogiri

我正在使用 nokogiri gem 来解析一个 html 表格内容，其中我有一个包含名称列表的列，其中一些名称是超链接的，而有些则不是。当我使用此代码时：

```
puts doc.xpath("//table//tr//td[1]/text()") 
```

它会跳过超链接名称。我还可以通过以下方式获取超链接名称：

```
doc.xpath('//table//tr//td[1]//a[@href]').each do |link|
   puts link.text.strip
end 
```

我怎样才能得到所有的名字而不必做两次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:09:36.793

如果您想要单元格中的所有文本，无论是否超链接：

```
doc.xpath('//td[1]').each do |cell|
   puts cell.text.strip
end 
```

注意：在有效的 HTML 文档中， a`td`将始终位于 a`table`和 a`tr`中。如果您没有任何其他选择器要求，则可以如上所述简化。

# sql - 哪个是更快的非规范化数据库或第三范式数据库

> ID：14841490
> 
> 赞同：-2
> 
> 时间：2013-02-12T20:46:08.347
> 
> 标签：sql, database, normalization

干草我正在写一篇关于数据库速度的论文，因为我被告知有几家公司已将具有第三种正常表单布局的表单切换到单个表以保存数据，因为我被告知访问速度更快和数据。

所以在我的论文中，我决定通过创建 3 个包含相同数据的独立数据库来测试这一点

1.  所有数据都在 1 个表中
2.  将数据分隔在 2 个具有关系的表中
3.  将数据分隔在 3 个具有关系的表中

我将在每个地方运行一个查询，该查询将选择一个值并拉回整行和连接的记录。

无论如何，我想知道您是否可以给我任何网站/页面或书籍/jernals，它们会说标准化数据库比非标准化数据库更快

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:16:54.740

我有几年在数据仓库领域使用高度非规范化数据库的经验（如果你想了解应用非规范化的场景，你应该阅读它），以及几年使用传统应用程序执行 OLTP。

您说公司选择切换到单个非规范化表是因为它的读写速度更快。**在大多数情况下，写作**绝对**不会**更快**. 想象一下，如果您对区域/员工表进行非规范化。区域记录将在此表中重复数千次。如果必须更改单个区域（例如它的名称），那么您将在数千条记录中应用该更新，而规范化数据库只需要更新一条记录。这有许多严重的性能问题。第一，在任何类型的事务中，对区域的更新都会导致成千上万的员工记录以某种方式被锁定（取决于事务的类型）。快照事务将消耗大量内存。区域列上的索引将比必要的大得多。由于每个表只有一个聚集索引，您的索引优化策略会受到限制。使用规范化的数据库，**

 **要理解的最重要的事情是，您不能评估一个用例（例如选择单个记录）然后得出设计 1、2 或 3 是最好的结论。这样的测试并不代表典型的使用场景。如果您正在选择单个记录，那么您很可能正在处理一个 OLTP 场景，您选择并可能编辑单个记录。在这种情况下，如果您的测试中没有包含最常见的 CRUD 操作，那么您的测试将非常不切实际：

*   单刀片
*   单次更新
*   单次删除
*   数以千计的并发操作

此外，您还必须考虑这样一个事实，即数以千计的此类操作将同时发生，因此死锁和等待锁将导致非规范化数据库的性能非常差。当您考虑到常见的使用场景时，这将产生巨大的差异。

“单个”不是指整个非规范化记录，我指的是它代表一个实体的部分。例如，更新或删除一个区域，但保留记录的员工部分，这将使您的代码更加复杂，并且性能不佳。

您可以评估的另一个场景（而不是 OLTP）是 OLAP，它是数据仓库的一个主题领域。虽然存在使用多维数据集的 OLAP 数据库引擎，但您可以使用 OLTP 引擎实现数据仓库，但使用非规范化设计。但是，通常情况下，您不会将所有内容非规范化为单个表。通常你有一个非规范化的事实表，然后连接到它的其他表也被非规范化以防止出现从事实表到任何其他数据的多个连接的场景。 **这种非规范化设计的使用场景几乎没有一条记录！** 通常，您正在聚合大量记录（大约数百万）并以一种方式对结构进行非规范化以做两件事，最小化连接和最小化记录大小（最大化每页记录）。因此，您可以从“事实”表中获得最大吞吐量。还有更多的东西。数据仓库领域非常广阔，在决定如何对数据进行非规范化时，有很多事情需要评估。好消息是它几乎被归结为一门科学。Kimball 的“Date Warehousing Toolkit”是一本很棒的书，尽管它在概念方面有点过分，并且不会详细介绍实现细节。

**关键是，您应该认识到，没有一种设计是最好的，有很多混合设计，并且每种设计都针对使用场景进行定制。**

如果我是你，我会澄清我的建议，只涵盖对一种使用场景的调查，并承认在其他使用场景中其他数据库设计可能会表现得更好。但在我看来，单条记录选择并不能涵盖完整的使用场景，它应该包括我为 OLTP 列出的其他常见操作。

或者你可以做数据仓库的使用场景，但这里的问题是你真的需要良好的数据仓库设计技能才能进行公平的比较。很容易对数据库进行非规范化，即使在最适用的聚合报告使用场景中也会产生糟糕的结果。**

# matlab - 为 MATLAB 符号分配数值范围

> ID：14841500
> 
> 赞同：0
> 
> 时间：2013-02-12T20:46:54.010
> 
> 标签：matlab, symbolic-math

我有常量符号，例如

```
t = sym('t')
c = sym ('c') 
```

但我必须用一个约束来限制这些符号，即 t 介于 0 和 1 之间（大于等于 0，小于等于 1）。对于 c 刚好大于等于零。

我可以通过仅表示轻松地在 matlab 中分配一个数字

```
t = 0; 
```

但我需要帮助才能将这些符号放在一个区间内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T09:27:30.393

```
assume(t > 0);
assumeAlso(t < 1); 
```

然后，您可以决定诸如

```
isAlways(t^2 < 1) 
```

对于`> 0`零件，您可以使用缩写

```
c = sym('c', 'positive') 
```

# sql - 每个数据库的 groovy sql 连接

> ID：14841503
> 
> 赞同：1
> 
> 时间：2013-02-12T20:47:13.210
> 
> 标签：sql, database, jdbc, groovy, connection-pooling

我有一个 SQL 查询服务，可以根据用户参数查询不同的 SQL 数据库。是否已经存在基于它所连接的数据库重用 SQL 连接的功能？

例如，我想做类似的事情：

```
def executeQueryAgainstDatabase(dbName) {
    if ( connectionExistsFor(dbName)) { 
        sql = getConnectionFor(dbName)
    }
    else {
        sql = Sql.newInstance(...)
    }       
} 
```

这实际上并不难实现，但我不确定是否有可以利用现有连接池功能的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:16:48.823

整个 java 生态系统都在 groovy 中可用……为什么不使用 DBCP？[http://commons.apache.org/dbcp/](http://commons.apache.org/dbcp/)

# java - 使用 64 位 JDK 1.7.0 加载 64 位 dll

> ID：14841504
> 
> 赞同：2
> 
> 时间：2013-02-12T20:47:16.733
> 
> 标签：java, dll

我在 Windows 7 上使用 Java 1.7.0 并尝试加载位于`C:/Program Files (x86)/Common Files/app_name/`. 我收到以下错误

```
 Exception in thread "main" java.lang.UnsatisfiedLinkError:
 C:\Program Files (x86)\Common Files\app_name\app.dll: %1
 is not a valid Win32 application 
```

我将 dll 复制到不同的目录（即`C:\Temp`），并且能够很好地加载 dll。我认为这个错误是由于 dll 位于下面`Program Files (x86)`，而 java 正试图将它作为 32 位 dll 加载。JVM 是否对 dll 的 under`Program Files`和做出某些假设`Program Files (x86)`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:12:31.163

这当然不是路径的问题。唯一的问题是您使用的是什么版本的 JavaVM。如果是 32 位版本的 Java，它将尝试将任何 DLL 作为 32 位 DLL 加载，如果是 64 位版本的 Java，它将尝试将任何 DLL 作为 64 位 DLL 加载。

所以，要么 - 您的系统上只安装了 32 位 Java，并尝试加载 64 位 DLL；或 - 您同时安装了 32 位和 64 位 Java，那么您需要确保使用 64 位版本进行测试。

您声称您已成功使用来自不同文件夹的 DLL 的事实表明后者，因此请确保您使用的 java 可执行文件是 64 位版本。

# c++ - 结构值不保留，值更改为 -858993460

> ID：14841507
> 
> 赞同：0
> 
> 时间：2013-02-12T20:47:21.903
> 
> 标签：c++, function, mfc, struct, dialog

我显然做错了什么或忘记了什么。我在带有四个变量的头文件中定义了一个结构。然后，我将值分配给位于不同 .cpp 中的函数中的这些变量，然后尝试从结构中获取新值并分配给另一个函数中的不同变量。问题是，我能够为结构中的变量赋值，但是当我尝试将这些值传递给其他变量时，它们会变成 -858993460（这是根据调试器和观察线程）。我该如何解决？

**结构用它的功能定义（即使不是它当前没有被使用）**

```
struct Setting {
    int Max;
    int Min;
    int Sample;
    int Points;
} Set1, Set2; 
```

** 为结构变量赋值**

```
void Settings::OnBnClickSet() {
    GetDlgItemText(ID_Points,str4);
    CW2A buf3((LPCWSTR)str4);
    Serial Value;
    Value.Set1.Points = atoi(buf3);
} 
```

**尝试将这些值转移到另一个变量**

```
bool Serial::Temperature(CString) {
    int Max,Min,SampleTime,Points;
    Max = Set1.Max;
    Min = Set1.Min;
    SampleTime = Set1.Sample;
    Points = Set1.Points;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:08:20.570

您正在为本地（自动）变量设置值。这些更改对于声明变量的函数是局部的 ( `OnBnClickSet()`)。

如果要使用 的单个实例`Serial`，则需要将其传递给`OnBnclickSet()`函数，或通过其他方式使其可用（例如使用全局变量或单例）。

```
void Settings::OnBnClickSet() {
    GetDlgItemText(ID_Points,str4);
    CW2A buf3((LPCWSTR)str4);

    // This creates a Serial object with automatic storage duration
    Serial Value;

    // You're setting the value on the local (automatic) variable.
    Value.Set1.Points = atoi(buf3);

    // Value will now go out of scope, all changes to it were
    // local to this function
}

bool Serial::Temperature(CString) {
    int Max,Min,SampleTime,Points;

    // The member (?) variable Set1 was never modified on this instance of `Serial`
    Max = Set1.Max;
    Min = Set1.Min;
    SampleTime = Set1.Sample;
    Points = Set1.Points;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T21:09:04.100

> 但是当我尝试将这些值转移到其他变量时，它们会变成 -858993460

那是一个神奇的数字。将其转换为十六进制得到 0xcccccccc。当您使用调试配置设置构建程序时，这是用于初始化变量的值。

所以每当你在调试器中看到它时，你会说“啊！我正在使用一个未初始化的变量！” 我们可以从代码片段中真正看到的是您的 Set1 结构从未被初始化。专注于应该执行此操作的代码，您刚刚忘记编写该代码或使用错误的结构对象的可能性不为零。

# jquery - 只执行最后一个ajax请求

> ID：14841512
> 
> 赞同：0
> 
> 时间：2013-02-12T20:47:32.153
> 
> 标签：jquery, ajax, request, abort

我想使用 jQuery ajax 和 php 验证一个字段。

当我开始录制超过 3 个字符时，它会将请求发送到 php 文件，但我的问题是当我点击 3 个有效字符而第 4 个字符无效时，我必须等待执行请求 4 次。

我只想执行最后一个请求并终止另一个待处理的请求

我试过：

```
xhr = $.ajax(//...);
xhr.abort(); 
```

和

```
if(typeof xhr !== 'undefined')
 xhr.abort();
xhr = $.ajax(//...); 
```

但它不起作用

这是我的代码：

```
// Check validation errors
var minLength = 3;
$('input[name^="data"][type=text]').on('keyup', function(){
    var input = $(this);
    var value = $.trim(input.val());
    var url = input.data('url');
    var div = input.parent();
    var serialized = input.serialize();
    if(value.length >= minLength){
        $.ajax({
            type: 'POST',
            url: url+'.json',
            data: serialized,
            dataType: 'json',
            success: function(data){
                var error = data.error;

                if(error){
                    div.removeClass('valid').addClass('invalid');
                }else{
                    div.removeClass('invalid').addClass('valid');
                }
            }
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:58:20.950

您可以尝试的东西，如果在一段时间内按下另一个键，则不要发送请求：

```
var minLength = 3;
var time_out_id=0;
$('input[name^="data"][type=text]').on('keyup', function(){
    var input = $(this);
    var value = $.trim(input.val());
    var url = input.data('url');
    var div = input.parent();
    var serialized = input.serialize();
    if(value.length >= minLength){

        if(time_out_id != 0) clearTimeout(time_out_id);

        time_out_id = setTimeout(function(){

            time_out_id=0;
            $.ajax({
                type: 'POST',
                url: url+'.json',
                data: serialized,
                dataType: 'json',
                success: function(data){
                    var error = data.error;

                    if(error){
                        div.removeClass('valid').addClass('invalid');
                    }else{
                        div.removeClass('invalid').addClass('valid');
                    }
                }

            });

        }, 250);

    }
}); 
```

这将在自上次按键后 250 毫秒后发送请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:03:13.530

你是说这行不通吗？

```
var xhr = null;
// Check validation errors
var minLength = 3;
$('input[name^="data"][type=text]').on('keyup', function(){
    var input = $(this);
    var value = $.trim(input.val());
    var url = input.data('url');
    var div = input.parent();
    var serialized = input.serialize();
    if(value.length >= minLength){
        if (xhr) xhr.abort();           
        xhr = $.ajax({
            type: 'POST',
            url: url+'.json',
            data: serialized,
            dataType: 'json',
            success: function(data){
                // your code ...
                xhr = null;
            }
        });
    }
}); 
```

# javascript - 以编程方式将图像保存在 HTML5/Java 脚本中

> ID：14841513
> 
> 赞同：3
> 
> 时间：2013-02-12T20:47:34.973
> 
> 标签：javascript, html

我想有一个按钮来保存 png 格式的图像。图片可以来自 URL、资源或来自 web api

我是 Web 开发领域的初学者。我知道任何按钮操作都可以这样完成：

```
<input type="button" value="Save image"       onclick="saveimage();" /> 
```

或者像这样（我不确定哪个是更好的实现）

```
<button type="button" onclick="saveimage();">Save Image</button> 
```

我不知道在 Javascript 标头中放入什么才能将图像保存在 png 中。有什么线索吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:30:07.450

我知道的唯一解决方案是这个：

```
<script> 
function saveImageAs (imgOrURL) {
    if (typeof imgOrURL == 'object')
      imgOrURL = imgOrURL.src;
    window.win = open (imgOrURL);
    setTimeout('win.document.execCommand("SaveAs")', 500);
  }
</script>
<body>

  <A HREF="javascript: void 0"
     ONCLICK="saveImageAs(document.anImage); return false" >
  save image</A>
  <IMG NAME="anImage" SRC="../apache_pb2.gif">
</body> 
```

但它只适用于 IE。如果您使用服务器端脚本（php、asp），情况会有所不同。然后您可以设置响应标头以强制用户下载文件（获取另存为.. 对话框）

# java - 在 JAXB 中处理格式不正确的（数字）元素标签

> ID：14841515
> 
> 赞同：2
> 
> 时间：2013-02-12T20:47:39.683
> 
> 标签：java, xml, xsd, jaxb

我正在尝试将 JAXB 与技术上不符合 XML 标准的数据一起使用；特别是，元素的名称在技术上是无效的，因为它们以数字字符开头。以下是架构外观的概述。

```
<xs:element name = "ITEM">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="01" />
            <xs:element name="08" />
            <xs:element name="10">
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="10_A" />
                        <xs:element name="10_B" />
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
            ...
            ...Many more elements...
            ...
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

不幸的是，我没有能力修改它。由于完整的 ITEM 非常庞大并且具有许多层次的深度，因此必须使用像 JAXB 这样的自动化工具来创建类。为此，我在元素名称前加上一个字符（在本例中为“m”），以便 XJC 接受它。我希望在运行时，我可以将 XML 标记映射到我的 Java 类，以便将输入解组为 Java 对象。特别是这样的：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = {
    "m01",
    "m08",
    "m10",
    ...
})
@XmlRootElement(name = "ITEM")
public class ITEM {
    @XmlElement(name = "01")
    protected String m01;
    @XmlElement(name = "08")
    protected String m08;
    @XmlElement(name = "10")
    protected M10 m10;
    ...
} 
```

M10 看起来像：

```
@XmlAccessorType(XmlAccessType.FIELD)
    @XmlType(name = "", propOrder = {
        "m10a",
        "m10b",
        ...
})
public static class M10 {
    @XmlElement(name = "10_A")
    protected String m10a;
    @XmlElement(name = "10_B")
    protected String m10b;
    ...
} 
```

我希望 JAXB 能够将 @XmlElement 标记与输入中的标记匹配，但不幸的是，这对我来说不起作用，因为 JAXB 不会有任何带有不正确标记的业务。如果有人感兴趣，特别的例外是：

```
org.xml.sax.SAXParseException: The content of elements must consist of well-formed character data or markup 
```

有人对如何解决这个问题有任何建议吗？我觉得我可能会在 JAXB 解析输入 XML 之前对输入 XML 运行正则表达式交换（从而完全绕过这个问题），但是以这种方式修改输入是相当不可取的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:09:06.107

抱怨的不是 JAXB (JSR-222) 实现，而是正在使用的底层解析器。诀窍是找到一个容错的 XML 解析器。

**斯塔克斯**

如果您可以找到能够处理此内容的 StAX (JSR-173) 解析器，那么您可以执行以下操作：

```
import java.io.StringReader;
import javax.xml.bind.*;
import javax.xml.stream.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(ITEM.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        StringReader xml = new StringReader("<ITEM><01>Hello World</01></ITEM");
        XMLStreamReader xsr = XMLInputFactory.newFactory().createXMLStreamReader(xml);
        ITEM item = (ITEM) unmarshaller.unmarshal(xsr);
    }

} 
```

**萨克斯**

或者，如果您找到 SAX 解析器，那么您可以执行以下操作：

```
import java.io.StringReader;
import javax.xml.bind.*;
import javax.xml.parsers.*;
import org.xml.sax.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();

        JAXBContext jc = JAXBContext.newInstance(ITEM.class);
        UnmarshallerHandler unmarshallerHandler = jc.createUnmarshaller().getUnmarshallerHandler();
        xr.setContentHandler(unmarshallerHandler);

        StringReader xml = new StringReader("<ITEM><01>Hello World</01></ITEM");
        InputSource inputSource = new InputSource(xml);
        xr.parse(inputSource);

        ITEM item = (ITEM) unmarshallerHandler.getResult();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T13:11:54.170

这不是“技术上无效的 XML”。它根本不是 XML。没有办法处理遵循某些 XML 规则但不遵循其他规则的东西 - 除非找到一个可以转换为正确 XML 的 XML 修复工具。

# c# - 如何在不以任何方式修改的情况下添加 InnerXml？

> ID：14841517
> 
> 赞同：1
> 
> 时间：2013-02-12T20:47:42.400
> 
> 标签：c#, .net, xml, xml-namespaces

我试图找到一种*简单*的方法来将 XML 添加到 XML-with-xmlns 而无需每次都`xmlns=""`指定。`xmlns`

我都尝试了`XDocument`，`XmlDocument`但找不到简单的方法。我得到的最接近的是这样做：

```
XmlDocument xml = new XmlDocument();

XmlNode docNode = xml.CreateXmlDeclaration("1.0", "UTF-8", null);
xml.AppendChild(docNode);
XmlElement root = xml.CreateElement("root", @"http://example.com");
xml.AppendChild(root);

root.InnerXml = "<a>b</a>"; 
```

但我得到的是：

```
<root xmlns="http://example.com">
  <a xmlns="">b</a>
</root> 
```

那么：有没有办法在`InnerXml`不修改的情况下设置它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:55:42.040

您可以`a` `XmlElement`按照创建元素的相同方式创建`root`，并指定该`InnerText`元素的。

选项1：

```
string ns = @"http://example.com";

XmlDocument xml = new XmlDocument();

XmlNode docNode = xml.CreateXmlDeclaration("1.0", "UTF-8", null);
xml.AppendChild(docNode);

XmlElement root = xml.CreateElement("root", ns);
xml.AppendChild(root);

XmlElement a = xml.CreateElement("a", ns);
a.InnerText = "b";
root.AppendChild(a); 
```

选项 2：

```
XmlDocument xml = new XmlDocument();

XmlNode docNode = xml.CreateXmlDeclaration("1.0", "UTF-8", null);
xml.AppendChild(docNode);

XmlElement root = xml.CreateElement("root");
xml.AppendChild(root);
root.SetAttribute("xmlns", @"http://example.com");

XmlElement a = xml.CreateElement("a");
a.InnerText = "b";
root.AppendChild(a); 
```

生成的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns="http://example.com">
    <a>b</a>
</root> 
```

如果您使用`root.InnerXml = "<a>b</a>";`而不是`XmlElement`从`XmlDocument`生成的 XML 中创建，则为：

选项1：

```
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns="http://example.com">
    <a xmlns="">b</a>
</root> 
```

选项 2：

```
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns="http://example.com">
    <a xmlns="http://example.com">b</a>
</root> 
```

# gps - 测量我用 lua 跑了多远

> ID：14841524
> 
> 赞同：-1
> 
> 时间：2013-02-12T20:48:14.477
> 
> 标签：gps, lua, location

如何测量我使用**lua**程序运行了多远？最好来自gps位置。我有经度和纬度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:47:38.520

我会使用闭包和勾股定理来做到这一点：

```
function odometer(curx, cury)
    local x = curx or 0
    local y = cury or 0
    local total = 0
    return function(newx, newy)
        local difx = math.abs(newx - x)
        local dify = math.abs(newy - y)
        total = total + math.sqrt(difx * difx + dify * dify)
        x, y = newx, newy
        return total
    end
end 
```

在您的应用程序启动时，您将调用`odometer`并传入您当前的经度和纬度（或默认为 0）：

```
myodometer = odometer(longitude, latitude) 
```

之后，您将应用程序设置为`myodometer`每隔 1000 毫秒调用一次，同时传入您的新经度和纬度：

```
myodometer(newlongitude, newlatitude) 
```

[这是 Lua 闭包的链接](http://www.lua.org/pil/6.1.html)

# java - Java：我可以反序列化一个对象而不调用它的构造函数吗？

> ID：14841526
> 
> 赞同：2
> 
> 时间：2013-02-12T20:48:19.993
> 
> 标签：java, serialization

我有一个四叉树*，我想在多台不同的机器上使用它。调用构造函数（即构建树）需要很长时间。我不想每次需要使用它时都构建树。

我正在寻找一种方法将我的树保存在硬盘中，将其发送到每个节点，然后快速将其加载到内存中，以便我可以执行查找。

序列化可以帮助我吗？我知道我可以序列化树，将其保存到磁盘然后反序列化（这就是我所知道的关于序列化的全部内容）。据我所知，反序列化步骤需要一个默认构造函数来构建树。由于构建树的计算成本很高，所以这对我没有用。

有什么方法可以导入持久树而不必每次都重建它？

*我使用的四叉树基础代码：[https ://bitbucket.org/utcompling/textgrounder/src/f38150c7f33a/src/main/java/ags/utils/KdTree.java](https://bitbucket.org/utcompling/textgrounder/src/f38150c7f33a/src/main/java/ags/utils/KdTree.java)

抱歉，如果这太基本了，它与以下内容密切相关：[https ://stackoverflow.com/questions/14701245/how-do-i-perform-kd-tree-lookups-in-hadoop](https://stackoverflow.com/questions/14701245/how-do-i-perform-kd-tree-lookups-in-hadoop)

**编辑**：所以，看起来最少继承类的无参数构造函数是将被调用的构造函数。这是我的雇佣关系：

抽象的KDTree

QuadTree 扩展 KdTree

SpecialQuadTree（有一个 QuadTree 实例）

现在，当我使所有内容都可序列化时，我只能序列化 SpecialQuadTree（否则我得到 NotSerizable 或 InvalidClassException 没有有效的构造函数）：

抽象 KDTree 实现 Serializable

QuadTree 扩展 KdTree 实现 Serializable

SpecialQuadTree 实现 Serializable （有一个 QuadTree 的实例）

所以，我想我可以将 Serializable 从 KdTree 中取出，然后给它一个不做任何事情的无参数构造函数？这不容易，我没有写，也不懂KdTree类。我想我可以对它进行子类化，给子类一个不做任何事情的无参数构造函数，并从中继承 QuadTree ...

**编辑**：好的，我有一个抽象类抽象KDTree实现可序列化

并由此扩展：QuadTree extends KdTree implements Serializable

从我所有的实验中，我需要在两者上实现 Serializable。现在，

```
public QuadTree() {
    super(2, 1000000);
    System.out.println("QuadTree no-args!");
} 
```

和

```
protected KdTree(int dimensions, Integer sizeLimit) {
    System.out.println("KdTree, constructor!"); 
```

因为我从来没有看到它打印出来（除了最初的构造......），我想这一切都很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:58:48.007

当一个对象在 Java 中反序列化时，只会调用一些无参数的构造函数（参见[这篇文章](https://stackoverflow.com/questions/8141440/how-are-constructors-called-during-serialization-and-deserialization)）。

最简单的方法是制作所有涉及的类`Serializable`。那么你的任何构造函数都不会被调用。如果您不能这样做，请确保您的`Serializable`类[可以访问第一个 non-Serializable 类的无参数构造函数](http://docs.oracle.com/javase/6/docs/platform/serialization/spec/serial-arch.html#4539)。

如果是您控制的非`Serializable`基类，您可以将昂贵的逻辑移动到不同的构造函数（比如说，使用一个虚拟`boolean`参数）并提供一个简单的无参数构造函数，它什么都不做。然后在反序列化后，您的所有字段都将在那里，而没有计算开销。

信息的最终来源是[序列化规范](http://docs.oracle.com/javase/6/docs/platform/serialization/spec/serialTOC.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:56:54.957

> 据我所知，反序列化步骤需要一个默认构造函数来构建树

如果您正在考虑 Java 对象序列化，则不会。

> 看起来继承最少的类的无参数构造函数将被调用。

不会。调用最近的*不可序列化*基类的无参数构造函数。

> 我想我可以将 Serializable 从 KdTree 中取出，然后给它一个无所事事的无参数构造函数？

为什么？别管它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-24T19:15:51.060

如果您使用的是 Jackson，那么拥有一个自定义反序列化器并附加到您尝试反序列化的类怎么样？

# c++ - 使用 lambda 定义哈希函数会引发异常

> ID：14841528
> 
> 赞同：1
> 
> 时间：2013-02-12T20:48:25.097
> 
> 标签：c++, hash, c++11, std, unordered-set

下面的代码定义了一个`unordered_set`. 代码编译得很好。但是在调用 find 时使用 lambda 函数而不是仿函数 throw：

> libc++abi.dylib：终止调用抛出异常

```
#include <unordered_set>

class pair_hash {
    public:
        size_t operator() (const std::pair<int, int> &x) const {
            return std::hash<int>()(x.first) ^ std::hash<int>()(x.second);
        }
};

int main() {
    std::unordered_set<std::pair<int, int>, pair_hash> temp;
    temp.find(std::make_pair(0,0));

    std::function<std::size_t(std::pair<int , int>)> fpair_hash;
    fpair_hash = [](const std::pair<int, int>& v) -> std::size_t
    {
        return std::hash<int>()(v.first) ^ std::hash<int>()(v.second);
    };

    std::unordered_set<std::pair<int, int>, decltype(fpair_hash)> temp2;
    //why does this not work?
    temp2.find(std::make_pair(0,0));
    return 0;
} 
```

> clang++ -std=c++11 -stdlib=libc++ -o test test.cpp

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:17:05.140

`decltype(fpair_hash)`所以`std::function<std::size_t(std::pair<int , int>)>`你只是用空哈希函数构建集合。

您需要向以下构造函数提供函数`std::unordered_set`：

```
std::unordered_set<std::pair<int, int>, decltype(fpair_hash)> temp2(10, fpair_hash); 
```

这应该可以使它工作，但是使用`std::function`会产生多态调用的开销，并且您可能不需要它：

```
auto fpair_hash = [](const std::pair<int, int>& v) -> std::size_t
{
    return std::hash<int>()(v.first) ^ std::hash<int>()(v.second);
}; 
```

最后，您的哈希函数不是很好 - 它会将所有对映射`(x, x)`到`0`. 也许使用类似的东西`x * 17 + y * 13`代替`x ^ y`会减少碰撞的可能性。

# sql - 子查询上的 Groupwise MAX()

> ID：14841529
> 
> 赞同：3
> 
> 时间：2013-02-12T20:48:31.650
> 
> 标签：sql, sql-server, sqlite

我正在尝试计算返回表中的最大值，以及该表中的其他值。但是，我正在为其执行此操作的表不是“真实”表，它是由子查询生成的表。这给我带来了问题，因为我不认为我可以加入它两次，而不重新指定整个子查询。

我目前有一个 SQL Server 解决方案，使用`ROW_NUMBER() OVER (PARTITION BY providerId ORDER BY partnershipSetScore DESC) rnk`，但如果可能的话，我正在寻找一个与 DBMS 无关的版本，因为项目的单元测试在没有此功能的 Sqlite DB 中运行。

这是架构和我的 SQL Server 特定查询，以防它们有用：

**课程：**

*   内部编号
*   varchar 名称
*   诠释学校ID

**学校：**

*   内部编号
*   varchar 名称

**合伙：**

*   内部编号
*   varchar 合伙人名称

**学校合作：**

*   内部编号
*   诠释学校ID
*   内部伙伴关系 ID

这是查询：

```
SELECT
    schoolId,
    partnershipId AS bestPartnershipSetId,
    partnershipScore AS bestPartnershipScore
FROM
(
    SELECT
        pp.schoolId,
        partnershipScores.partnershipId,
        partnershipScores.partnershipScore,
        ROW_NUMBER() OVER (PARTITION BY schoolId ORDER BY partnershipScore DESC) rnk
    FROM schoolPartnership pp
    INNER JOIN (
        SELECT
            pp.partnershipId,
            (
                (CASE WHEN SUM(CASE WHEN c.name LIKE '%French%' THEN 1 ELSE 0 END) > 0 THEN 1 ELSE 0 END)
                + (CASE WHEN SUM(CASE WHEN c.name LIKE '%History%' THEN 1 ELSE 0 END) > 0 THEN 1 ELSE 0 END)
            ) AS partnershipScore
        FROM schoolPartnership pp
        INNER JOIN course c ON c.schoolId = pp.schoolId
        GROUP BY partnershipId
    ) AS partnershipScores ON partnershipScores.partnershipId = pp.partnershipId
) AS schoolPartnershipScores
WHERE rnk = 1 
```

如果您需要有关我要实现的目标的更多信息，请参阅[针对大量数据的自定义排序算法](https://stackoverflow.com/questions/14790457/custom-sorting-algorithm-for-a-large-amount-of-data)：此查询将是较大查询的子查询，该查询通过最合适的合作伙伴对学校进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:35:59.270

也许，当谈到两次加入子查询时，您的脑海中会出现这种技术：

```
SELECT a.*
FROM atable a
INNER JOIN (
  SELECT
    col1,
    MAX(col2) AS max_col2
  FROM atable
  GROUP BY col1
) m
ON a.col1 = m.col1 AND a.col2 = m.max_col2
; 
```

*如果*这是关于单个表的，那将完全可以用作与 DBMS 无关的方式（至少，一种在 SQL Server 和 SQLite 中工作的方式）来完成这项工作。

相反，您有一个子查询。但是，我看不到其他方法可以完成您的要求。因此，在这种情况下，我可以为您看到两个选项（一个可能不适用于您的特定情况，但通常仍然是一个选项）：

1.  做你试图避免的事情，即专门复制子查询以查找每个组的聚合值，然后将其加入到同一个子查询中，如上所示。

2.  暂时保留子查询的结果，然后将上述技术应用于临时结果集。

第一个选项确实不是很有吸引力，更不用说因为第二个选项可能会起作用。

第二种选择的一个问题是临时数据集在 SQL Server 和 SQLite 中的实现方式不同。在 SQLite 中，您为此使用了一个`CREATE TEMPORARY TABLE`语句。SQL Server 不支持语句`TEMPORARY`上下文中的关键字，`CREATE TABLE`而是在表名的开头使用特殊字符 ( `#`) 来表示该表实际上是一个临时表。

所以，我能看到的唯一解决方法是使用*普通*表作为临时存储。您可以在每次运行查询时创建一次，然后在插入临时结果集之前删除其内容：

```
DELETE FROM TempTable;
INSERT INTO TempTable (
  schoolId,
  bestPartnershipSetId,
  bestPartnershipScore
)
SELECT
  pp.schoolId,
  partnershipScores.partnershipId,
  partnershipScores.partnershipScore,
FROM
  ...
;
SELECT ...
FROM TempTable
...
; 
```

或者您可以在每次运行查询时创建并删除它：

```
CREATE TABLE TempTable (
  ...
);
INSERT INTO TempTable (...)
SELECT ...
FROM ...
;
SELECT ...
FROM TempTable
...
;
DROP TABLE TempTable; 
```

请注意，像这样使用普通表作为临时存储在 SQL Server 中对并发不友好。如果这可能会造成问题，您可能不得不放弃此选项并最终选择第一个选项。（但这可能是您想要一个独立于平台的解决方案时必须支付的成本，尤其是当平台与 SQL Server 和 SQLite 一样不同时。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T20:54:36.317

这是你想要的结构：

```
with t as (<subquery goes here>)
select t.*,
       max(col) over () as MaxVal
from t 
```

很难看出它如何适合您的查询，因为我不知道基本子查询是什么。

至于多次加入子查询，您可以使用 SQL Server 所谓的“公用表表达式”——`with`上面的子句来做到这一点。大多数其他合理的数据库都支持这一点（MySQL 和 MS Access 开始有两个值得注意的例外）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:34:26.437

最与 SQL 无关的方法是使用“NON EXISTS”：

```
SELECT * FROM schoolPartnership t1
WHERE NOT EXISTS 
       (SELECT * FROM schoolPartnership t2 
        WHERE t1.schoolId = t2.schoolId 
              AND t1.partnershipScore < t2.partnershipScore) 
```

这将为您提供来自 schoolPartnership 的行，每个 schoolId 的最大合作伙伴分数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T22:43:28.210

我找不到解决方案（除了复制子查询，这是我试图避免的），所以我刚刚确定了 PHP 中每个合作伙伴分数的 MAX 行，并丢弃了任何其他行。这不是一个理想的解决方案，但由于我需要一种跨平台的方法，因此我没有太多其他选择。

# xcode - 在选择器中将子视图添加到主 uiview

> ID：14841530
> 
> 赞同：1
> 
> 时间：2013-02-12T20:48:33.417
> 
> 标签：xcode, drag-and-drop, addsubview

我正在开发拖放应用程序，当用户放下图像时，我想从它的拖放点复制它，然后原始图像返回到它的初始点。我决定在执行 touchesEnded 后将 uiimageview 添加到我的视图控制器中，

我有包含该方法的拖动视图类：

```
 - (void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{

CGPoint activePoint = [[touches anyObject] locationInView:self];
UIImageView *myimage;
myimage.image = self.image;
myimage.center = activePoint;

ViewController *cview ;
cview = [[ViewController alloc]init];
[cview getpoint: myimage];

} 
```

现在在视图控制器中，这是 getpoint 选择器：

```
-(void) getpoint : (UIImageView *) mine{
UIImageView *newimage;
newimage = mine;
[self.view addSubview:newimage];

NSLog(@" in getpoint");

} 
```

当我放下对象时，出现此错误：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[__NSArrayM insertObject:atIndex:]: object cannot be nil' 
```

但是当我删除 addsubview 语句时，NSlog 是正确的

任何解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:39:03.520

你实际上并没有为你的 UIImageViews 分配内存。这段代码是可疑的：

```
CGPoint activePoint = [[touches anyObject] locationInView:self];
UIImageView *myimage;
myimage.image = self.image;
myimage.center = activePoint; 
```

你需要分配/初始化你的图像视图

```
CGPoint activePoint = [[touches anyObject] locationInView:self];
UIImageView *myimage = [[UIImageView alloc] initWithFrame:rect];
myimage.image = self.image;
myimage.center = activePoint; 
```

其中`rect`变量保存要添加到层次结构的图像视图的矩形尺寸。您不能将 nil 对象添加到 NSArray。因此，由于 UIImageView 为 nil，因此此调用将失败：

```
[self.view addSubview:newimage]; 
```

# cython - 如何分发从 cython 生成的 .so 文件

> ID：14841535
> 
> 赞同：4
> 
> 时间：2013-02-12T20:49:09.887
> 
> 标签：cython

我已经能够在我的 .pyx 脚本上使用 cython 在 linux 上创建一个 .so 文件。我也可以成功地在我的 python 解释器上进行导入。

我的问题是如何在不使用 cython 的情况下将这个 .so 安装在最终用户的机器上？我不想将任何 .pyx 或 .py 或 .c 文件分发给最终用户。而且我不希望最终用户安装 cython 或任何东西来使用我的 .so 文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-20T21:18:39.583

您可以使用`ldd`检查 .so 的静态依赖项。这是我在 Ubuntu 桌面上使用 cython 构建的 .so 的依赖项：

```
$ ldd iksolver.so 
linux-vdso.so.1 =>  (0x00007fffc07fe000)
libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fdcabc08000)
libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007fdcab903000)
libpython2.7.so.1.0 => /usr/lib/x86_64-linux-gnu/libpython2.7.so.1.0 (0x00007fdcab3d3000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fdcab00b000)
/lib64/ld-linux-x86-64.so.2 (0x00007fdcac068000)
libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007fdcaadf4000)
libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fdcaabef000)
libutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007fdcaa9ec000)
$ 
```

您可以看到它依赖于安装的许多其他库，并且需要安装 python2.7，但这里的所有内容都安装在默认的 Ubuntu 部署中。请注意，此处不需要安装 Cython。

如果使用相同的处理器架构和相同版本的操作系统，您将能够将 .so 复制到`/usr/local/lib/python2.7/dist-packages`目标计算机上，然后您将能够导入它。

当然，如果您`import`的 Cython 模块中有任何语句，则需要确保这些模块也存在于目标系统上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-09T10:44:23.213

分发 python 轮更容易和最好。你的目标机器上需要 pip3，但 Cython 不需要。

**在建筑机器上：**

用这种 setup.py 构建你的轮子：

```
from Cython.Build import cythonize
from setuptools import setup, Extension

setup(  name='myPackage',
        version='1.0',
        py_modules=['myPackage'],
        ext_modules =
            cythonize(Extension("myPackageExtension",
                        # the extension name
                sources=["myPackageExtension.pyx", "Tool1.cpp", "Tool2.cpp"],
                        # the Cython source and additional C++ source files
                language="c++", # generate and compile C++ code
                                )
                        )
    ) 
```

以及以下命令行：

```
python3 setup.py bdist_wheel 
```

您将`.whl`在文件夹中获得一个文件`dist`。

**在目标机器上：**

将wheel文件复制到您的目标机器，然后使用以下命令行安装它：

```
pip3 install myPackage-*-cp34-cp34m-linux_x86_64.whl 
```

（注意你的包是为python版本（cp34）和专用平台（linux_x86_64）构建的，所以你需要和构建机器一样（或者你可以使用[manylinux](https://github.com/pypa/manylinux)来解决这个问题））。

# oop - 将面向对象模型映射到 Clojure

> ID：14841541
> 
> 赞同：4
> 
> 时间：2013-02-12T20:49:39.427
> 
> 标签：oop, clojure

假设我们正在使用面向对象的语言，并且有两个类 X 和 Y，并且这些类之间存在双向关系。

所以 X 的一个实例可以指向 Y 的一个实例，反之亦然。

在 Clojure 中，类通常转换为映射，因此我们可以：

```
{:type :x :name "instance of X"}
{:type :y :name "instance of Y"} 
```

我们如何表示这些“对象”之间的双向关系，而不使用“外键”之类的东西？或者这通常是直接委托给数据库的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:08:48.200

在 Clojure 中看到与面向对象语言中的分层对象树相对应的深度嵌套映射是很常见的，例如

```
{:type :x
 :name "instance of X"
 :y {:type :y
     :name "instance of Y"}} 
```

事实上，这很常见，它提供了诸如、和之类的`clojure.core`核心功能，以方便使用此类结构。`get-in``assoc-in``update-in`

当然，当被建模的对象之间存在自然的层次结构或所有权关系时，这种方法效果最好。在循环引用的情况下，这种结构会崩溃（假设您坚持使用持久数据结构）——要了解原因，请尝试构建一个包含自身作为值的 Clojure 映射。

我通常看到处理这种情况的方式是使用以下方法引入一个间接层`atom`：

```
(def x {:type :x, :name "x instance", :y (atom nil)})
(def y {:type :y, :name "y instance", :x (atom nil)})
(set! *print-level* 3) ;; do this in the REPL to avoid stack overflow
                       ;; when printing the results of the following calls
(reset! (:y x) y)
(reset! (:x y) x) 
```

# ruby-on-rails - 查看/显示在 Many2Many 模型中有未知列

> ID：14841542
> 
> 赞同：0
> 
> 时间：2013-02-12T20:49:46.190
> 
> 标签：ruby-on-rails, model-associations

我以为我可以通过系统地浏览选项来打败它。它赢了。

index.html.erb 和 form.html.erb 就像现在一样工作。

我在 Bids 和 Contacts 之间有多对多的关系，bids_contacts 在该表中的 bid_id 和 customer_contact_id 之间。

这是联系人然后出价模型：

```
has_and_belongs_to_many :bid_customer_contacts, :class_name => 'Bid',
  :association_foreign_key => 'bid_id'

has_and_belongs_to_many :customer_contacts, :class_name => 'Contact', :foreign_key => 'customer_contact_id' 
```

bids_controller.rb 没什么特别的

show.html.erb 文件错误：

```
Mysql2::Error: Unknown column 'bids_contacts.contact_id' in 'on clause':   
SELECT  `contacts`.* FROM `contacts` INNER JOIN `bids_contacts'  
    ON  `contacts`.`id` = `bids_contacts`.`contact_id'  
 WHERE  'bids_contacts`.`customer_contact_id` = 15 
```

代码是：

```
<b>Customer Contacts:</b>
<% if !@bid.customer_contacts.empty? %>   <<===============
  <ul>
    <% @bid.contacts.each do |bc| %>
        <li><%= link_to(bc.name, bc) %></li>
    <% end %>
</ul>
<% else %>
    No Customer Contacts<br/>
<% end %> 
```

我在 M2M 表中尝试了**contact_id**而不是**customer_contact_id**，但我得到了不同的错误。

如果我需要分享其他内容来解决这个谜团，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:59:02.297

在你看来，你在打电话

```
@bid.customer_contacts 
```

然后稍后

```
@bid.contacts 
```

你可能想要

```
@bid.customer_contacts 
```

两次，因为你用这种方式定义了方法

```
has_and_belongs_to_many :customer_contacts ... 
```

我假设您将 customer_contact_id 作为数据库中的字段，但是当您调用 .contacts 时，您的视图会查找不存在的 contact_id 字段。

# transactionscope - TransactionScope 不会回滚异常 CSLA 4.3

> ID：14841543
> 
> 赞同：0
> 
> 时间：2013-02-12T20:49:49.617
> 
> 标签：transactionscope, csla

我有一个 BO（国家）和一个孩子 BO（州），还有一个孩子 BO（城市）。当我更新父 BO（国家），添加子状态并运行保存时，当 DAL 中发生异常（故意）时，事务不会回滚。我正在使用 SqlCE。我附上了一个演示该问题的精简项目示例。我究竟做错了什么？

测试代码：

```
 Country originalCountry = null;
    try
    {
        originalCountry = Country.GetCountry(1);
        var country = Country.GetCountry(1);
        country.CountryName = "My new name";
        var state = country.States.AddNew();
        state.StateName = "Dummy state";
        country.States.EndNew(country.States.IndexOf(state));
        country.Save();
    }
    catch (Exception exception)
    {
        var country = Country.GetCountry(1);
        if (originalCountry.CountryName != country.CountryName)
        {
            System.Console.WriteLine("Values ARE NOT the same: " + originalCountry.CountryName + " vs. " + country.CountryName);
        }
        else
        {
            System.Console.WriteLine("Values are the same: " + originalCountry.CountryName + " vs. " + country.CountryName);
        }
    } 
```

国家.cs

```
[Transactional(TransactionalTypes.TransactionScope)]
protected override void DataPortal_Update()
{
    Update();
}

private void Update()
{
    using (var ctx = DalFactory.GetManager())
    {
        var dal = ctx.GetProvider<ICountryDal>();
        using (BypassPropertyChecks)
        {
            var dto = new CountryDto();
            TransferToDto(dto);
            dal.Update(dto);
        }
        FieldManager.UpdateChildren(this);
        throw new Exception("Rollback should occur.");
    }
} 
```

[示例项目](https://sites.google.com/site/thepublicsite/Home/Csla4.3Test.zip?attredirects=0&d=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:57:20.580

根据我对 SQL CE 和事务的理解，它们在使用 TransactionScope 时仅支持单个数据库连接上的事务。

看起来您的代码遵循某些 CSLA 示例提出的模型，但数据库连接的实际打开/关闭隐藏在 GetManager 或 GetProvider 抽象中，因此无法确定如何处理。

不过，SQL CE 似乎对 TransactionScope 的事务有一些限制，所以你应该确保你没有以某种方式违反他们的限制之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T13:58:04.560

DalManager（和 ConnectionManager）依靠引用计数来确定何时关闭实际连接。

规则没有确保处理 DalManager，因此 DalManager 和引用计数已关闭。导致更新发生在在 Fetch 操作之一中创建和打开的连接上，因此未在 Update 方法的 TransactionScope 中登记。

请参阅：http: [//msdn.microsoft.com/en-us/library/bb896149%28v=sql.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb896149%28v=sql.100%29.aspx)

必须更改所有规则以处置 DalManager。原规则：

```
 protected override void Execute(RuleContext context)
    {
        var name = (string)context.InputPropertyValues[_nameProperty];
        var id = (int)context.InputPropertyValues[_idProperty];
        var dal = DalFactory.GetManager();
        var countryDal = dal.GetProvider<ICountryDal>();
        var exists = countryDal.Exists(id, name);
        if (exists)
        {
            context.AddErrorResult("Country with the same name already exists in the database.");
        }
    } 
```

DalManager 是 IDisposable 但未在此处显式设置，因此它取决于 GC 何时实际收集对象。

应该：

```
 protected override void Execute(RuleContext context)
    {
        var name = (string)context.InputPropertyValues[_nameProperty];
        var id = (int)context.InputPropertyValues[_idProperty];
        using (var dal = DalFactory.GetManager())
        {
            var countryDal = dal.GetProvider<ICountryDal>();
            var exists = countryDal.Exists(id, name);
            if (exists)
            {
                context.AddErrorResult("Country with the same name already exists in the database.");
            }
        }
    } 
```

# javascript - 对列表视图中的分组项目进行排序

> ID：14841547
> 
> 赞同：0
> 
> 时间：2013-02-12T20:50:05.327
> 
> 标签：javascript, windows-8, winjs

我需要对组中的单个项目进行排序。Listview api 让我可以创建排序组或排序整个列表。我需要对各个组中的项目进行排序。

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-11-22T23:15:50.237

我在同一个问题上苦苦挣扎，既没有找到有用的例子，也没有找到提示。然后我开始将 SortedListProjection 和 GroupedSortedListProjection 结合起来，最终让它发挥作用。

我的用例是按字母升序排列组，但在一个组内，项目按时间戳降序排列。

以下是我在 JavaScript 文件中的设置方式：

```
var list = new WinJS.Binding.List(); // list gets populated later in the code
var sortedList = list.createSorted(compareItems);
var groupedList = list.createGrouped(getGroupKey, getGroupData, compareGroups);

WinJS.Namespace.define("my.stuff", {
    sortedList: sortedList,
    groupedList: groupedList
}); 
```

重要的是保持项目排序与分组同步。因此项目排序函数调用分组函数。

以下是用于排序和分组的所有四个函数：

```
compareItems = function (leftItem, rightItem) {
    let leftKey = getGroupKey(leftItem);
    let rightKey = getGroupKey(rightItem);
    let compare = compareGroups(leftKey, rightKey);
    if (compare == 0) { // if keys are equal compare timestamps
        return leftItem.timestamp < rightItem.timestamp ? 1
            : leftItem.timestamp > rightItem.timestamp ? -1 : 0;
    }
    return compare;
};

getGroupKey = function (item) {
    return item.name + item.category;
};

getGroupData = function (item) {
    return {
    name: item.name + " (" + item.category + ")"
    };
};

compareGroups = function (leftKey, rightKey) {
    return leftKey.toUpperCase().localeCompare(rightKey);
}; 
```

最后，ListView 的两个列表的组合声明：

```
<div id="dataDeliveriesList" class="hidden"
    data-win-control="WinJS.UI.ListView"
    data-win-options="{
        itemDataSource: my.stuff.sortedList.dataSource,
        itemTemplate: select('#itemTemplate'),
        groupDataSource: my.stuff.groupedList.groups.dataSource,
        groupHeaderTemplate: select('#groupHeaderTemplate'),
        layout: {
            type: WinJS.UI.ListLayout
        }
    }">
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T06:02:45.057

这是可能的。ObservableCollection 不提供排序选项，因此您必须创建一个在选定属性上排序的新集合。请参阅下面的示例代码。[有关其他排序选项，请阅读此处](http://kiwigis.blogspot.com/2010/03/how-to-sort-obversablecollection.html)的博客文章和[另一个 stackoverflow 线程](https://stackoverflow.com/questions/1945461/how-do-i-sort-an-observable-collection)。

```
// TODO: Create an appropriate data model for your problem domain to replace the sample data
var group = SampleDataSource.GetGroup((String)navigationParameter);
this.DefaultViewModel["Group"] = group;
//this.DefaultViewModel["Items"] = group.Items;

// Sort items by creating a new collection
ObservableCollection<SampleDataItem> grpSorted = new ObservableCollection<SampleDataItem>(
group.Items.OrderBy(grp => grp.Title));

this.DefaultViewModel["Items"] = grpSorted; 
```

# asp.net - 带有可选参数的 RouteTable.Routes.MapPageRoute

> ID：14841554
> 
> 赞同：1
> 
> 时间：2013-02-12T20:50:29.037
> 
> 标签：asp.net, routes

我在一个 ASP.Net 4.0 Web 表单应用程序中。

我在 Global.asax 中已经有了这个路由并且正在工作：

```
RouteTable.Routes.MapPageRoute("status", "members/{userid}/{status}", "~/members/status.aspx"); 
```

'status' 参数可以让我将页面上的活动选项卡设置为状态、博客、照片或关于（默认为状态）。

所以当我发布到：/members/status.aspx?userId=first.last

当页面加载时，我会看到 /members/first.last/status。

我需要做的是呈现一些链接，这些链接会将用户带到带有博客 ID 的博客选项卡，这样我就可以登陆显示多个博客的博客选项卡，并按 ID 滚动到特定的博客。我正在尝试设置类似于我们在 MVC 中的操作方式的 href：/members/first.last/blog/1000（其中 1000 是博客 ID）-我的另一个尝试是 /members/first.last/blog/?id = 1000 但我永远无法在 Page_Load 的查询字符串键中看到 Id。

我尝试添加此路由无济于事：

```
RouteTable.Routes.MapPageRoute("status",
    "members/{userid}/{status}/{*queryvalues}", "~/members/status.aspx",
    false,
    new RouteValueDictionary { { "id", @"\d{4}" } }); 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:59:16.297

我认为您应该查看项目集合。

```
 this.Context.Items["userid"] 
```

或在 4.0 的 RoutData 集合中

```
 Page.RouteData.Values["userid"] 
```

有关信息，请参阅此链接[如何：访问路由页面中的 URL 参数](http://msdn.microsoft.com/en-us/library/dd535620%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-03T10:38:13.393

使用如下：

```
routes.MapPageRoute(
       "ProductsBrowse",
        "browse/{BrowseBy}/{Category}/{*queryvalues}",
        "~/Pages/Products/Browse.aspx"
    ); 
```

Thx：[asp.net webforms 路由：可选参数](https://stackoverflow.com/questions/3781092/asp-net-webforms-routing-optional-parameters)

# android-layout - 为什么 Fragment setRetainInstance 和布局更改有效？

> ID：14841556
> 
> 赞同：0
> 
> 时间：2013-02-12T20:50:33.783
> 
> 标签：android-layout, android-fragments, screen-orientation

当我在 Fragment 上使用 setRetainInstance(true) 时，我总是这样，它的布局不能改变，因为不会调用 onCreateView。我今天尝试了这个作为试用，我看到我的肖像布局被使用了。这怎么可能？

对我来说，API 在这一点上很清楚，但看起来我错过了一些重要的东西。

谢谢，风筝冲浪者

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:40:57.057

onCreateView 方法仍然会被调用，onCreate 方法是在片段创建后不会被多次调用的方法。

Android javadoc 注释：

*   onDestroy() 将不会被调用（但 onDetach() 仍然会被调用，因为片段正在与其当前活动分离）。
*   onCreate(Bundle) 不会被调用，因为片段没有被重新创建。
*   onAttach(Activity) 和 onActivityCreated(Bundle) 仍将被调用。

[Android javadoc 链接](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)

# python - 在 django/python 中调试

> ID：14841561
> 
> 赞同：0
> 
> 时间：2013-02-12T20:50:52.397
> 
> 标签：python, django

我来自 php 背景，喜欢我可以在代码中的几乎任何地方执行 var_dump 并获得结果。

如果我使用 shell (./manage.py shell)，似乎在 python/django 中我可以这样调试方法，但速度没有那么快。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:53:06.907

在 PHP 中，您可能已经习惯了很棒的[xdebug](http://xdebug.org)扩展。

在 Python 中，使用 (把它放在任何你放[xdebug_break()](http://xdebug.org/docs/all_functions)的地方) 产生经典的调试器：

```
import pdb; pdb.set_trace() 
```

我最喜欢的是 ipdb 模块 ( `pip install ipdb`)：

```
import ipdb; ipdb.set_trace() 
```

您还可以使用提供命令的[werkzeug](http://werkzeug.pocoo.org/) ( `pip install werkzeug`) 和[django-extensions](https://github.com/django-extensions/django-extensions) (`pip install django-extensions`和 add `django_extensions`to `settings.INSTALLED_APPS`) `runserver_plus`。

真的，真的很棒。这可能是让你再也不会回头看 php 的事情之一。无论如何，`runserver_plus`就像`runserver`但是它将用堆栈跟踪的每一帧都可用的 ajax 交互式 shell 替换默认的 django 堆栈跟踪页面。当然，您可以通过在代码中放置类似`crash`或任何地方的内容来获取它。`random_undefined_variable_name`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:53:35.523

Python 通过名为[pdb](http://docs.python.org/2/library/pdb.html)的调试器有一个很棒的步骤。如果您使用内置的网络服务器在前台运行 Django 进行开发，您可以在代码中抛出语句，例如

```
import pdb; pdb.set_trace() 
```

和其他 pdb 命令，它会将您置于调试器中。还有一个[django 插件](https://github.com/tomchristie/django-pdb)。

# highcharts - Highcharts：在图表上叠加标签

> ID：14841565
> 
> 赞同：2
> 
> 时间：2013-02-12T20:51:00.147
> 
> 标签：highcharts

我想在图表上覆盖一个自定义层（例如评论、作者）。阅读 API 似乎已经[有一个用于此目的的对象](http://api.highcharts.com/highcharts#labels)：

> 可以放置在图表区域中任何位置的 HTML 标签。

我尝试在其中一个示例图表上使用它，但它没有效果（见下文），尽管解释器没有发出任何错误。我做错了什么还是应该以其他方式创建这种标签？

谢谢你。

```
 chart = new Highcharts.Chart({
        chart: {
            renderTo: 'pie-container',
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
        },
        title: {
            text: 'Browser market shares at a specific website, 2010'
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage}%',
            percentageDecimals: 1
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    color: '#FFFFFF',
                    connectorColor: '#FFFFFF',
                    formatter: function() {
                        return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                    }
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'Browser share',
            data: [
                ['Firefox',   45.0],
                ['IE',       26.8],
                {
                    name: 'Chrome',
                    y: 12.8,
                    sliced: true,
                    selected: true
                },
                ['Safari',    8.5],
                ['Opera',     6.2],
                ['Others',   0.7]
            ]
        }],
        labels: [
            {html: "<b>This is a label!</b>", 
            style: {
                left: '100px', 
                top: '100px',
                width: '50px'}}],
      });
   });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:25:13.600

`labels`应该是一个对象。
然后你必须将每个标签添加为`items`.

```
labels: {
    items: [{
        html: "<b>This is a label!</b>",
        style: {
            left: '100px',
            top: '100px',
            width: '50px'
        }
    }]
} 
```

[**演示**](http://jsfiddle.net/ricardolohmann/Q6yQs/)

# ruby-on-rails - RESTful 操作的控制器测试

> ID：14841566
> 
> 赞同：1
> 
> 时间：2013-02-12T20:51:01.387
> 
> 标签：ruby-on-rails, ruby, rspec, bdd

虽然我通常使用 Fat Model, Skinny Controller 方法，但我可以看到测试复杂控制器动作的意义，但我想知道：是否有任何理由为 rails 脚手架生成的 RESTful 动作编写控制器测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:56:21.697

根据我的经验，您的控制器规范或测试有助于调试操作中的路径或值。通常，您会看到：

```
@post = some_logic_gets_a_post
if @post.present?
   # happy path
else
   # failure path
end 
```

通过控制器测试，您可以确保您将在假设下进入正确的状态，或者您遇到正确的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T22:04:26.727

一般来说，我发现它在测试身份验证和授权时很有用，此时我并不真正关心内容返回什么，但如果我得到正确的重定向、状态代码等，我会更关心。

我重视控制器测试的第二种情况是控制器可以用多种方言回答。例如 JSON、XML 和/或 HTML。但是，当格式变得复杂时，最好使用构建器来执行此操作，而不是将这种复杂性隐藏在控制器中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T18:54:46.340

简单地说：如果您的应用程序中有代码，由您维护，请测试该代码。

我避免为 InheritedResources 或其他 REST gem 提供的操作或行为编写测试，但是一旦有逻辑，尤其是重定向和身份验证/资源所有权逻辑，就应该对其进行测试。值得注意的是，我上次使用脚手架和 rspec 时，它也为我生成了所有这些测试。

# selenium - Selenium：在隐藏时获取dom中元素的值

> ID：14841570
> 
> 赞同：0
> 
> 时间：2013-02-12T20:51:22.180
> 
> 标签：selenium

我正在迭代找到 ByClassName() 的元素列表。对于该列表中的每个项目，我需要提取其子元素的文本值。我已经看到了一些使用 javascript 获取值的解决方案，但我一定遗漏了一些东西。在这个特定的例子中，我有一个跨度，我需要它的文本或 innerhtml。我已经用 Firebug 验证了里面有文字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:18:58.387

事实证明 GetAttribute("innerHTML") 不受隐藏 html 的限制。

```
 public string GetChildElementTextByClassName(IWebElement element, string className)
    {
        string returnValue = string.Empty;

        try
        {
            IWebElement childElement = element.FindElement((By.ClassName(className)));
            if (childElement != null)
            {
                returnValue = childElement.GetAttribute("innerHTML").Replace(Environment.NewLine, "").Trim();
            }
        }
        catch (Exception)
        {

            //throw;
        }

        return returnValue;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:22:14.310

如果您只想访问子元素，您还可以使用 xpath `//div[@class='Class']/child::div`，您可以在其中更改类名和子类型。如果要访问父元素的**所有**子元素，可以返回与选择器匹配的元素列表，如下所示：

```
ReadOnlyCollection<IWebElement> elements = _driver.FindElements(By.XPath("//div[@class='ClassName']/child::div")); 
```

在这一点上，是的，如果您可以访问元素，您应该能够访问 innerHTML。请注意，我已经用 C# 编写了我的代码，我相信这也是您的代码所在。

# spring - 基于 java 的 web 配置，带有 spring mvc 3 和 tile

> ID：14841572
> 
> 赞同：1
> 
> 时间：2013-02-12T20:51:22.620
> 
> 标签：spring, config, tiles

听说我很难让 mvc 3 和瓷砖一起工作

 `````
 import org.springframework.context.annotation.Bean;
    import org.springframework.context.annotation.ComponentScan;
    import org.springframework.context.annotation.Configuration;
    import org.springframework.web.servlet.config.annotation.*;
    import org.springframework.web.servlet.view.tiles2.TilesConfigurer;
    import org.springframework.web.servlet.view.tiles2.TilesViewResolver;

    @Configuration
    @EnableWebMvc
    @ComponentScan(basePackages = {"foo"})
    public class WebMvcConfig extends WebMvcConfigurationSupport {

    @Override
    public void configureDefaultServletHandling(final DefaultServletHandlerConfigurer configurer) {
        configurer.enable();
    }

} 
```` 

 `和 ...` 

 ``````
 @Configuration
    public class ViewConfiguration {
        @Bean
        public TilesConfigurer tilesConfigurer() {
        return new TilesConfigurer();
    }

    @Bean
    public TilesViewResolver tilesViewResolver() {
        TilesViewResolver tilesViewResolver = new TilesViewResolver();
        tilesViewResolver.setOrder(2);
        return tilesViewResolver;
    } 
````  `和下面的瓷砖配置

 `````
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE tiles-definitions PUBLIC
        "-//Apache Software Foundation//DTD Tiles Configuration 2.0//EN"
        "http://tiles.apache.org/dtds/tiles-config_2_0.dtd">

<tiles-definitions>

    <definition name="mainLayout" template="/view/layout/layout.jsp">
        <put-attribute name="header" value="/view/layout/header.jsp"/>
        <put-attribute name="menu" value="/view/layout/menu.jsp"/>
        <put-attribute name="footer" value="/view/layout/footer.jsp"/>
        <put-attribute name="body" value="/view//layout/body.jsp"/>
    </definition>
    <definition name="test" extends="mainLayout">
        <put-attribute name="body" value="/view/test.jsp"/>
    </definition>
</tiles-definitions> 
````  `这是我的测试控制器

 `````
@Controller
public class TestController {

    @RequestMapping("/hello")
    public String helloWorld() {
        return "test";
    }
} 
```` 

 `这是输出` 

 ````
DispatcherServlet.initContextHolders(986) | Bound request context to thread: org.apache.catalina.connector.RequestFacade@1b4c72c8                                                                                                                                                                                               
DispatcherServlet.doService(823) | DispatcherServlet with name 'dispatcher' processing GET request for [/trd/hello]                                                                                                                                                                                                             
DispatcherServlet.getHandler(1088) | Testing handler map [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping@eca5a40] in DispatcherServlet with name 'dispatcher'                                                                                                                               
RequestMappingHandlerMapping.getHandlerInternal(219) | Looking up handler method for path /hello                                                                                                                                                                                                                                
RequestMappingHandlerMapping.lookupHandlerMethod(263) | Found 1 matching mapping(s) for [/hello] : [{[/hello],methods=[],params=[],headers=[],consumes=[],produces=[],custom=[]}]                                                                                                                                               
RequestMappingHandlerMapping.getHandlerInternal(226) | Returning handler method [public java.lang.String ir.parsdeveloper.web.controller.TestController.helloWorld()]                                                                                                                                                           
DefaultListableBeanFactory.doGetBean(246) | Returning cached instance of singleton bean 'testController'                                                                                                                                                                                                                        
DispatcherServlet.getHandlerAdapter(1122) | Testing handler adapter [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter@6eb2756]                                                                                                                                                                
DispatcherServlet.doDispatch(912) | Last-Modified value for [/trd/hello] is: -1                                                                                                                                                                                                                                                 
HandlerMethod.invokeForRequest(129) | Invoking [helloWorld] method with arguments []                                                                                                                                                                                                                                            
HandlerMethod.invokeForRequest(135) | Method [helloWorld] returned [test]                                                                                                                                                                                                                                                       
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.ModelAndViewMethodReturnValueHandler@2903ccd9] supports [class java.lang.String]                                                                                    
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.method.annotation.ModelMethodProcessor@387dcf98] supports [class java.lang.String]                                                                                                                
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.ViewMethodReturnValueHandler@4bc82121] supports [class java.lang.String]                                                                                            
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor@3ff72465] supports [class java.lang.String]                                                                                               
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.CallableMethodReturnValueHandler@5979da9f] supports [class java.lang.String]                                                                                        
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.DeferredResultMethodReturnValueHandler@4f002a9d] supports [class java.lang.String]                                                                                  
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.AsyncTaskMethodReturnValueHandler@6271edc8] supports [class java.lang.String]                                                                                       
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.method.annotation.ModelAttributeMethodProcessor@4f432acf] supports [class java.lang.String]                                                                                                       
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor@468f7aa2] supports [class java.lang.String]                                                                                      
HandlerMethodReturnValueHandlerComposite.getReturnValueHandler(78) | Testing if return value handler [org.springframework.web.servlet.mvc.method.annotation.ViewNameMethodReturnValueHandler@5522a7b5] supports [class java.lang.String]                                                                                        
DispatcherServlet.render(1206) | Rendering view [org.springframework.web.servlet.view.tiles2.TilesView: name 'test'; URL [test]] in DispatcherServlet with name 'dispatcher'                                                                                                                                                    
TilesView.render(257) | Rendering view with name 'test' with model {} and static attributes {}                                                                                                                                                                                                                                  
DefaultListableBeanFactory.getBeanDefinition(566) | No bean named 'requestDataValueProcessor' found in org.springframework.beans.factory.support.DefaultListableBeanFactory@5f1c34fb: defining beans [org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,webMvcConfig,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor,viewConfiguration,testController,tilesConfigurer,tilesViewResolver,org.springframework.web.servlet.config.annotation.DelegatingWebMvcConfiguration,requestMappingHandlerMapping,mvcContentNegotiationManager,viewControllerHandlerMapping,beanNameHandlerMapping,resourceHandlerMapping,defaultServletHandlerMapping,requestMappingHandlerAdapter,mvcConversionService,mvcValidator,httpRequestHandlerAdapter,simpleControllerHandlerAdapter,handlerExceptionResolver]; root of factory hierarchy
BasicTilesContainer.render(615) | Render request recieved for definition 'test'                                                                                                                                                                                                                                                 
DispatcherServlet.initContextHolders(986) | Bound request context to thread: org.apache.catalina.core.ApplicationHttpRequest@a750bb9                                                                                                                                                                                            
DispatcherServlet.doService(823) | DispatcherServlet with name 'dispatcher' processing GET request for [/trd/view/thirdParty/layout/layout.jsp]                                                                                                                                                                                 
DispatcherServlet.getHandler(1088) | Testing handler map [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping@eca5a40] in DispatcherServlet with name 'dispatcher'                                                                                                                               
RequestMappingHandlerMapping.getHandlerInternal(219) | Looking up handler method for path /view/thirdParty/layout/layout.jsp                                                                                                                                                                                                    
RequestMappingHandlerMapping.getHandlerInternal(229) | Did not find handler method for [/view/thirdParty/layout/layout.jsp]                                                                                                                                                                                                     
DispatcherServlet.getHandler(1088) | Testing handler map [org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping@696911f6] in DispatcherServlet with name 'dispatcher'                                                                                                                                               
BeanNameUrlHandlerMapping.getHandlerInternal(127) | No handler mapping found for [/view/thirdParty/layout/layout.jsp]                                                                                                                                                                                                           
DispatcherServlet.getHandler(1088) | Testing handler map [org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport$EmptyHandlerMapping@10f98160] in DispatcherServlet with name 'dispatcher'                                                                                                                
DispatcherServlet.getHandler(1088) | Testing handler map [org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport$EmptyHandlerMapping@6c9cce54] in DispatcherServlet with name 'dispatcher'                                                                                                                
DispatcherServlet.getHandler(1088) | Testing handler map [org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport$EmptyHandlerMapping@2aae2481] in DispatcherServlet with name 'dispatcher'                                                                                                                
ageNotFound.noHandlerFound(1108) | No mapping found for HTTP request with URI [/trd/view/thirdParty/layout/layout.jsp] in DispatcherServlet with name 'dispatcher'                                                                                                                                                              
DispatcherServlet.resetContextHolders(996) | Cleared thread-bound request context: org.apache.catalina.core.ApplicationHttpRequest@a750bb9                                                                                                                                                                                      
DispatcherServlet.processRequest(951) | Successfully completed request                                                                                                                                                                                                                                                          
AnnotationConfigWebApplicationContext.publishEvent(332) | Publishing event in WebApplicationContext for namespace 'dispatcher-servlet': ServletRequestHandledEvent: url=[/trd/view/thirdParty/layout/layout.jsp]; client=[127.0.0.1]; method=[GET]; servlet=[dispatcher]; session=[null]; user=[null]; time=[804ms]; status=[OK]
DispatcherServlet.resetContextHolders(996) | Cleared thread-bound request context: org.apache.catalina.connector.RequestFacade@1b4c72c8                                                                                                                                                                                         
DispatcherServlet.processRequest(951) | Successfully completed request                                                                                                                                                                                                                                                          
AnnotationConfigWebApplicationContext.publishEvent(332) | Publishing event in WebApplicationContext for namespace 'dispatcher-servlet': ServletRequestHandledEvent: url=[/trd/hello]; client=[127.0.0.1]; method=[GET]; servlet=[dispatcher]; session=[null]; user=[null]; time=[7716ms]; status=[OK] 
```

 ``我知道控制器正在工作并返回“测试”作为输出但是当弹簧去寻找视图时有一些问题。我认为 /trd/view/layout/layout.jsp 会找到但无法检测到资源的位置。我不知道更多。请帮忙`

 `* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-26T19:04:33.147

您需要告诉您的瓷砖配置在哪里可以找到定义文件。您可以执行 `new TilesConfigurer().setCompleteAutoload(true);`which 启用完整的自动加载功能，该功能将在您的`WEB-INF`文件夹中查找任何以结尾`-definitions.xml`或明确指向您的文件的定义文件`new TilesConfigurer().setDefinitions("path/to/defitions.xml");`。``````````

# ruby-on-rails - Rails 4 未检测到应用程序

> ID：14841575
> 
> 赞同：15
> 
> 时间：2013-02-12T20:51:27.090
> 
> 标签：ruby-on-rails, ruby-on-rails-4

更新到 Rails 4 后，我试图启动服务器，但它不会启动。简而言之，应用程序似乎没有被“检测到”，就像那里没有应用程序一样。

```
~ $ bundle exec rails server
Usage:
  rails new APP_PATH [options]

Options:
  -r, [--ruby=PATH]              # Path to the Ruby binary of your choice
                                 # Default: /app/vendor/ruby-2.0.0/bin/ruby
  -b, [--builder=BUILDER]        # Path to some application builder (...
  -m, [--template=TEMPLATE]      # Path to some application template (...
      [--skip-gemfile]           # Don't create a Gemfile
  -B, [--skip-bundle]            # Don't run bundle install 
```

奇怪的是（旧的）系统 gem 可以让它启动得很好，但不能使用 Bundler。

为什么 Rails 无法启动？

我尝试浏览 CLI 源代码，但我无法掌握正在发生的事情。

（使用 Edge Rails 4.0.0.beta 和 Ruby 2.0.0.rc）

如果您想知道，这里是目录列表：

```
~ $ ls
app  config db    Gemfile   lib  mock    Rakefile   script  tmp
bin  config.ru  features  Gemfile.lock  log  public  README.md  spec    vendor 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-19T09:38:36.137

Rails 4 确实改变了它的启动方式。

幸运的是，您不必运行`rails-new`，因为有一个方便的任务。

[Rails 4 发行说明](http://edgeguides.rubyonrails.org/4_0_release_notes.html#railties-notable-changes)：

> ### 6.1 显着变化
> 
> *   您的应用程序的可执行文件现在位于该`bin/`目录中。运行`rake rails:update:bin`以获取`bin/bundle`、`bin/rails`和`bin/rake`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T22:31:10.543

大多数情况下，我一直被自己的懒惰所占据。（尽管懒惰是效率之母；o））我已经指出在运行Rails 服务器[时不要使用 Bundle 。](https://stackoverflow.com/a/7553276/720164)

Rails 4.0.0.beta[改变了它的启动方式](https://github.com/rails/rails/commit/009873aec89a4b843b41accf616b42b7a9917ba8)。但是，由于我使用的是“旧”版本的 Rails，一个旧的 4.0.0-beta 我躺在我的本地 gems 中，它没有改变，我没有注意到什么时候对我的捆。

现在，到了部署的时候，强制`bundle-exec`无法启动，因为我的代码用于启动旧方式。

## 解决方案

像消息所说的那样做：`bundle exec rails new .`。这次使用Bundle！此时，Rails 将生成样板文件，即缺少的引导文件，如`./bin/rails`.

它还会更新一些配置文件，并尝试覆盖一些东西。就我而言，所有内容都已检查到源代码管理中，因此有一些差异并选择是否覆盖并在之后恢复。

一个可能更好的想法（我没有费心）是在 Git 中分支，运行“升级” `rails-new`，覆盖所有内容，提交，然后与主分支进行三向合并。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-25T03:54:40.000

如果您的 bin 文件夹已经存在，您可能只需`bundle install`要先运行。在克隆了在另一台机器上完美运行的存储库后，这解决了我的问题。

# mysql - 在mysql中插入浮点数

> ID：14841577
> 
> 赞同：0
> 
> 时间：2013-02-12T20:51:27.343
> 
> 标签：mysql, numbers, decimal

您好，我正在尝试通过抓取方法插入从另一个网站复制的号码。

例如，这就是我试图插入的数字：

140.000

所以我用下一个信息制作了一张表格：

```
Create table IF NOT EXISTS LJugador(
Fecha date,
vm float(10,6),
nom_jugador varchar(80),
FOREIGN KEY (nom_jugador) REFERENCES Jugadores(nombre),
PRIMARY KEY(Fecha, nom_jugador) 
```

其中 vm 是我放置信息的字段。我要介绍的更大的数字是 20.000.000。问题是我只能插入带有浮点数或小数的完整数字，将 6 个数字放在小数侧（这是我要插入的数字的最大值，数百万）例如，如果我将 1.230.000 放入数据库中，则另存为：1.230000，但是当我尝试将此数量与另一个（例如 160.000）相加时，它给我的结果为 161.620000，所以我不知道如何插入百万个数字，我可以将百个数字添加为 180.000,240.000 等。 .

我不知道该怎么做：S，感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:21:38.283

尝试 FLOAT(15,6) 或 DOUBLE(15,6)

# c# - 更新 IBM.Data.Informix.dll 后，项目给出“未设置对象引用”错误

> ID：14841578
> 
> 赞同：1
> 
> 时间：2013-02-12T20:51:34.200
> 
> 标签：c#, asp.net, informix

我最初使用 IBM.Data.Informix.Dll (2.81) 的原始版本为工作中的 ASP.NET 应用程序开发了一个 ASP.NET 2.0 替代品。替换大部分工作正常，但连接到数据库时间歇性挂起（这是原来的问题。）我决定升级到最新版本的 dll（3.70），但删除旧版本并替换使用新的，然后添加引用，现在每当我构建应用程序时都会收到“未设置对象引用”错误。

该错误未指定行或提供任何有用的信息。如果我在构建之前打开其中一个 .aspx 页面，我也会收到关于文件本身的警告。

这是整个错误：

```
: Build (web): Object reference not set to an instance of an object. 
```

和警告，特别是一页：

```
Warning 2   \\io\wwwroot\intranet\cwsheet-test2\Selection.aspx: ASP.NET runtime error: Object reference not set to an instance of an object.    \\io\wwwroot\intranet\cwsheet-test2\Selection.aspx  1   1   cwsheet-test2 
```

此外，当 aspx 文件打开时，它在顶部带有下划线：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Selection.aspx.cs" Inherits="XXX.Selection" %> 
```

同样，这仅适用于较新版本的 dll。dll 是我系统的正确版本（取自 64 位 SDK）。如果我删除这个 dll 然后用旧的替换它，它会再次开始正常工作。

只是为了解决我不使用 IBM.Data.Db2 的原因：我们拥有的 Informix 服务器是 10.0，而 DB2 仅适用于 11.10 及更高版本。

关于 Satyan 的问题：网站中的 GAC 参考设置为 3.0.0.2；我去添加引用时DLL的版本号是3.00.05000.2。如果这可能是问题所在，我该如何纠正？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T18:43:40.483

其中一个很可能是导致此问题的原因。GAC 上的提供程序 DLL 可能不是正确的。或者`machine.config`可能有错误的版本信息。它很可能位于（但取决于您的设置） `C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG\machine.config`。

正确的 CSDK 安装应该更新了这两个条目。您是否尝试通过简单的副本替换提供程序 DLL，如果是这样，它将无法正常工作。仅供参考：您提到的“间歇性挂起”是不同的；不知道为什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T21:07:38.433

事实证明，驱动程序版本的问题很奇怪。在厌倦了尝试使 64 位版本工作（这是在 Server 2008 R2 64 位上，所以这是正确的版本）之后，我尝试卸载它并改用 32 位版本（这是 2.90 版本。）它工作完美。不知道为什么即使将 64 位添加到空白项目中也会立即出现问题。虽然我宁愿使用那个版本而不是 32 位，但花了几天时间试图找到一个解决方案，我只打算使用 32 位，因为它确实有效。

# ios - 使用 kSecAttrAccessibleAfterFirstUnlockThisDeviceOnly 防止备份钥匙串数据

> ID：14841579
> 
> 赞同：1
> 
> 时间：2013-02-12T20:51:36.767
> 
> 标签：ios, file, synchronization, backup, keychain

我想阻止用户购买积分、同步他们的设备、使用积分然后从备份中恢复他们的设备，从而将他们的信用级别重置为他们同步设备时的水平。我读到带有 `kSecAttrAccessibleAfterFirstUnlockThisDeviceOnly`“......不要迁移到新设备或新安装”的钥匙串项目。但这绝不是重复的，也不是为非常相似而写的`kSecAttrAccessibleThisDeviceOnly`。任何人都可以确认不会备份此类钥匙串项目吗？

（我不想使用缓存目录中的文件，因为如果他们删除并重新安装应用程序，用户将失去他们的信用。）

# codeigniter - Codeigniter 高级会员系统

> ID：14841580
> 
> 赞同：-2
> 
> 时间：2013-02-12T20:51:37.017
> 
> 标签：codeigniter, membership

我目前正在开发一个文件托管网站，就像 filehippo.com。我已经完成了。但是，我的客户想要一个类似于 rapidshare pro 的高级会员系统。因此，只有高级会员才能在一段时间内（例如一个月左右）获得下载访问权限。

我现在有两张桌子：

*   用户
*   文件

我应该为会员状态创建一个新表吗？最好的做法是什么？逻辑，也许还有数据库结构。请给我一些建议。

多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:02:57.980

看起来您只是在用户表和文件中开发或添加一些列。

在user表中添加列user_id、level_access、inactive period。然后你可以在文件表中添加用于连接用户表的列 id_user。

可以设置到期日期间隔，您可以使用如下函数：

```
function expiration($date) {
    /* $date = time is a register as user */
$sql=mysql_query("select ('$date' - INTERVAL 1 week ) as expired");
$row = mysql_fetch_array($sql);
$output=$row['expired'];
return $output;
}` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T22:30:57.020

如果他们为高级会员付费，我会创建另一个表并将其与付款的交易 ID 相关联。这将是许多 premium_access 行的一个用户行。这样，您就可以获得服务天数/月使用的付款的历史记录，并允许为 6 个月或每年的会员资格收取折扣，并且仍然可以进行准确的跟踪，以确保您可以跟踪任何漏洞或漏洞。

那么当你想知道它们什么时候到期时

> select * from premium_access where user_id = '$id' limit 1 order by end_date desc

编辑：这是一个可能的表结构的快速模型。对您需要的列和正确的命名约定使用您自己的判断：

```
CREATE  TABLE IF NOT EXISTS premium_access (
  id INT NOT NULL AUTO_INCREMENT ,
  user_id INT NOT NULL , --fk to USERS
  payment_id VARCHAR(45) NULL , --fk to PAYMENTS/INVOICES
  start_date TIMESTAMP NOT NULL ,
  end_date TIMESTAMP NOT NULL ,
  PRIMARY KEY (id) ) 
```

# jquery - Rails AJAX 多个同时 PUT 调用失败

> ID：14841581
> 
> 赞同：0
> 
> 时间：2013-02-12T20:51:38.307
> 
> 标签：jquery, ruby-on-rails, ruby, ajax

我的 Rails 应用程序在一个页面上包含多个表单，这些表单都与同一个控制器（实际上是同一个关联）相关。我有一个提交按钮，它使用 jQuery 通过 AJAX 一次性提交所有表单。问题是只有一些更新实际上在数据库中显示为生效。它们都使用相同的逻辑和相同的方法，一次一个，数据保持良好。但是一次全部发送，实际上只有大约一半的数据保存在数据库中。

Javascript 看起来像这样：

```
$(document).on('click', '.submit', function(event){
  $('form').submit();
}); 
```

这样就可以一键通过 AJAX 提交所有表单。（图约10个表格）

Rails 控制器看起来像这样（简化）：

```
#prepare the JSON data

adapter = DataMapper.repository(:default).adapter
adapter.execute("UPDATE person SET facets=? WHERE id=?", JSON.generate(facets), id)

render :text => 'OK' 
```

我认为问题可能涉及多个进程试图同时访问该方法并使用旧数据更新该字段的事实。我得到每个请求的响应“ok”，但只有大约一半的结果生效。

有什么建议么？谢谢！

**编辑：**

就像更新一样，以防万一有人遇到同样的问题。我通过将 async 设置为 false 来解决 jQuery 中的问题。这需要浏览器多一点时间来发送，并且可能会阻止其他 javascript 事件直到它完成，但没有一个请求会相互干扰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T23:10:40.007

这一切都取决于您的浏览器，最大并行 HTTP 请求数是有上限的，如此处所问：[Official references for default values of concurrent HTTP/1.1 connections per server?](https://stackoverflow.com/questions/5751515/official-references-for-default-values-of-concurrent-http-1-1-connections-per-se) 我一直无法找到最新的参考资料，所以如果您遇到任何我很想看的资料！

希望这可以帮助。

# nservicebus - 重新安装 NServiceBus 端点会停止服务

> ID：14841582
> 
> 赞同：0
> 
> 时间：2013-02-12T20:51:40.277
> 
> 标签：nservicebus, psake

当我重新运行基于 psake 的部署过程时，我的 NServiceBus (3.3.0) 端点不会恢复处理消息。在 services.msc 下，状态为空白。

这是我的 psake 脚本（删除了不相关的内容）：

```
function global:deploy_endpoint($name) {

    $project = "$BaseDir\src\$name\$name.csproj"
    $buildPath = "$DeployBaseDir\$name"
    $deployPath = "c:\ReloDotNet2_ServiceEndpoints\$name"

    exec { msbuild $project "/p:Configuration=Debug;OutputPath=$buildPath" "/t:Build" }
    exec { & "$deployPath\NServiceBus.Host.exe" /uninstall }
    exec { msdeploy "-verb:sync" "-source:contentPath=$buildPath" "-dest:contentPath=$deployPath" }
    exec { & "$deployPath\NServiceBus.Host.exe" /install }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:11:33.720

/install 不会自动为您启动服务。

运行 /install 后需要启动服务

# asp.net-mvc - 在 MVC 的控制器中使用 ActionLinks 构建 URL

> ID：14841583
> 
> 赞同：2
> 
> 时间：2013-02-12T20:51:59.440
> 
> 标签：asp.net-mvc, asp.net-mvc-3, twitter-bootstrap, asp.net-mvc-4

我正在构建一个基本的抽认卡应用程序 - 一个集合包含卡片和其他集合。当导航到 Set1 > Set2 > Set3 之类的东西时，我希望每个父“集”链接到它们各自的详细信息页面。我正在向 Details viewModel 传递一个名为“breadcrumbs”的字符串，其中包含如下内容：

```
var stringBuilder = "";
            var parent = model.ParentSet;

            while (parent != null)
            {
                stringBuilder += "<li><a href=\"@Url.Action('Detail', 'Set', new {SetId = \" + parentSetId + \"}, null)'>" + parent.Name + "</a> <span class='divider'>/</span></li>";
                parent = parent.ParentSet;
            }
            model.Breadcrumbs =
                "<li><a href=\"@Url.Action('Index', 'Home')\">Home</a> <span class='divider'>/</span></li>" +
                stringBuilder + "<li class='active'>New Set</li>";
            model.Name = "New Set"; 
```

生成的 URL 是文字的 - 包含“@Url.Action”。

有谁知道我怎样才能让它工作，或者是否有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:55:01.090

简单评价一下：

```
"<li><a href='" + Url.Action('Index', 'Home') + "'>..." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:04:39.180

我认为这里的一个重要问题是，“你的观点是什么样的？”

如果您的视图正在使用该 model.Breadcrumbs 字段，如下所示：

```
...
<div id="breadcrumbs">
    @model.Breadcrumbs
</div>
... 
```

您构建的字符串中的@Url.Action 调用将永远不会被执行。Razor 引擎对它在视图文件中找到的代码进行操作，而不是对模型中的字段进行操作。

您需要做以下两件事之一：

1.  而是将“@Url.Action(...)”放入您正在构建的字符串中，使用 Url.Link() 之类的东西找出服务器端的 Url 并直接插入。

2.  （这更好）将这些父级作为视图模型的一部分传递给视图，并在视图中循环它们*，在*你去的时候构造标签。通常，您不想将 html 放入模型中。该模型用于保存*数据*，而不是演示代码。

# java - Java SWT 小部件会影响线程性能吗？

> ID：14841587
> 
> 赞同：2
> 
> 时间：2013-02-12T20:52:21.167
> 
> 标签：java, multithreading, performance, widget, swt

我正在使用 StyledText 400x100 小部件，它的工作方式类似于程序与用户交互的控制台。

这就是我更新小部件的方式：

```
private static Shell MainShell = null;

public void createPartControl(Composite parent){
   MainShell = parent.getShell();
}

public static void updateConsole(final String newMessage){
   if(MainShell.isDisposed() || myStyledText.isDisposed() ) return;

   MainShell.getDisplay().syncExec(new Runnable(){
      myStyledText.setText( newMessage + "\n" + myStyledText.getText() );
   });
} 
```

类似于 append()，但这个插入到第一行并插入换行符“\n”。

我正在使用 CycleBarrier 来处理线程。目前它正在运行 300 多个线程，我只允许 10 个线程/周期不会杀死 CPU。

```
// divide 300/10 because there is an inner for() which runs 10 threads / cycle
for(int n = 0; n < 300/10; n++){

   // allow only 10 threads to work
   final CycleBarrier br = new CycleBarrier(10);

   for(int i = 0; i < 10; i++){
      new Thread(new MyClass(cb).start();
   }

   //waiting for Threads to reach the barrier
   br.await();
} 
```

现在是**MyClass**类：

```
public MyClass implements Runnable{
   private CycleBarrier cb;

   public MyClass(CycleBarrier cb){
      this.cb = cb;
   }

   @Override
   public void run(){
      for(int i = 0; i < 256; i++){
         for(int j = 0; j < 256; j++){
            //View is the main class (eclipse RCP) and updateing the widget
            View.updateConsole("matrix["+i+"]["+j+"]");

            // Just an integer which counts the number of the loops
            View.TOTAL_LOOPS++;
         }
      }
      cb.await();
   }
} 
```

这是一个例子。它应该以异步方式（不是按顺序）写入 View 小部件，因为线程没有按顺序到达屏障。

我正在使用 Eclipse RCP (3.8)。

**问题**

为什么程序在 DEBUG 模式下工作正常？我已经设置了一个断点，我将在其中启动新线程（在内部 for() 中），然后单击 Resume 按钮以逐个启动线程。当我尝试以正常模式（运行或导出）打开时，会出现“泄漏”（我不知道如何命名），控制台中的行数较少。View.TOTAL_LOOPS 总共应该有：

> 256*256*10*30 = 19660800 // View.TOTAL_LOOPS++; 在我的班级

在正常运行中，它具有动态结果：174614904、17025759 等。在调试模式下，它达到了精确值。

**问题：**

线程被杀死了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:28:04.150

它与 SWT 无关。您一次从 10 个线程中增加一个共享变量。这是竞态条件的经典示例。由于`++`不是原子操作，因此可能会发生以下情况：

```
int temp = View.TOTAL_LOOPS; // in thread 1
int temp = View.TOTAL_LOOPS; // in thread 2
int temp2 = temp + 1; // in thread 1
View.TOTAL_LOOPS = temp2; // in thread 1
int temp2 = temp + 1; // in thread 2
View.TOTAL_LOOPS = temp2; // in thread 2 
```

Note`View.TOTAL_LOOPS`在此之后仅增加 1，如果您一个接一个地启动线程，显然不会发生这种情况。

`AtomicInteger`如果您只想要一个线程安全的计数器或以其他方式正确同步您的线程，请改用。

# c++ - 将 c++ exe 与 C 库 (GNU) 链接时出现问题

> ID：14841592
> 
> 赞同：3
> 
> 时间：2013-02-12T20:52:33.653
> 
> 标签：c++, c, gcc, linker, g++

我创建了一些简单的基本代码来说明我的问题。

标头.h：

```
#ifdef __cplusplus
#   define API extern "C"
#else
#   define API
#endif

void callback();
API void libFunction(); 
```

测试库.c：

```
#include "header.h"

void libFunction()
{
    Callback();
} 
```

我将其编译为静态库，如下所示：

```
gcc -c testlib.c
ar rsc libtest.a testlib.o 
```

然后我的示例 C++ 代码是

主.cpp：

```
extern  "C"{
#include  <lib/header.h>
}
#include  <stdio.h>

main()
{
    libFunction();
}

void Callback()
{
    printf("Callback is called \n");
} 
```

我尝试像这样构建我的exe

```
g++ -I. -L. main.cpp -ltest 
```

并得到以下错误

```
./lib/libtest.a(testlib.o): In function `libFunction':
testlib.c:(.text+0x7): undefined reference to `Callback'
collect2: ld returned 1 exit status 
```

我花了一整天的时间试图找出原因。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:55:59.487

如果`Callback`要从 C 文件调用，则需要`extern "C"`在 C++ 文件中构建它 - 否则 C++ 名称修改将导致符号不对齐。您需要将`Callback()`in的定义更改`main.cpp`为：

```
extern "C" void Callback() 
```

你也有大小写不匹配。标题中的原型说明`callback`，但在您使用的其他任何地方`Callback`。在重新阅读您的代码时，我认为只需修复这种大小写不匹配即可解决您的所有问题。我没有看到第一次阅读的`extern "C"`包装。`#include <lib/header.h>`

# class - 在 TypeScript 的类中实现索引器

> ID：14841598
> 
> 赞同：43
> 
> 时间：2013-02-12T20:52:59.030
> 
> 标签：class, typescript, indexer

目前是否可以在 TypeScript 中的类上实现索引器？

```
class MyCollection {
   [name: string]: MyType;       
} 
```

这不编译。当然，我可以在接口上指定一个索引器，但是我需要这种类型的方法以及索引器，所以一个接口是不够的。

谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-13T10:21:05.197

您不能使用索引器实现类。您可以创建一个接口，但该接口不能由类实现。它可以用纯 JavaScript 实现，您可以在接口上指定函数以及索引器：

```
class MyType {
    constructor(public someVal: string) {

    }
}

interface MyCollection {   
   [name: string]: MyType;
}

var collection: MyCollection = {};

collection['First'] = new MyType('Val');
collection['Second'] = new MyType('Another');

var a = collection['First'];

alert(a.someVal); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-07-10T14:00:58.707

对于那些正在寻找答案的人来说，这是一个老问题：现在可以定义一个索引属性，例如：

`let lookup : {[key:string]:AnyType};`

密钥的签名必须是字符串或整数，请参阅：

[www.typescriptlang.org 上的接口](https://www.typescriptlang.org/docs/handbook/interfaces.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-09-28T08:09:24.063

无法在类中定义索引属性 getter/setter，但您可以使用[Proxy](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)以这样的方式“模拟”它：

```
class IndexedPropSample  {
  [name: string | symbol]: any;

  private static indexedHandler: ProxyHandler<IndexedPropSample> = {
    get(target, property) {
      return target[property];
    },
    set(target, property, value): boolean {
        target[property] = value;
        return true;
    }
  };

  constructor() {
      return new Proxy(this, IndexedPropSample.indexedHandler);
  }

  readIndexedProp = (prop: string | symbol): any => {
      return this[prop];
  }

}

var test = new IndexedPropSample();

test["propCustom"] = "valueCustom";

console.log(test["propCustom"]); // "valueCustom"
console.log(test.readIndexedProp("propCustom")); // "valueCustom"
console.log(test instanceof IndexedPropSample); // true
console.log(Object.keys(test)); // ["propCustom", "readIndexedProp"] 
```

你可以在[Typescript Playground中尝试一下](https://www.typescriptlang.org/play?pretty=true#code/LAKAxgNghgzjAEBJAdgEwKYA92oAoCcB7ABwGUoBbYideeAb1DoG1lL0AueGAF3wEtkAc3gAfbgE8KAI0IQAulyjIJAblBN4xAQDcoPWr338w8QRmyoAEstQ18XAoUwSbaewB4UFnE7KVqdAA+eABeBk06IXQeAAoeKHxongAaLSJidHweCQBKCJA6Ivh8GIBXfGR4BKSY5m0SLJz5dUKigF8UyO4Y+MTktIbM7Ik0vQgy9FyuWTl0ZQLi4prk+oymiXkw+HHJ1qWi0p4Kqr497vbNdtbNMEJkXnwysB5CfFj8xjbio5P4ZHQAHd4E4XPEABb8GBpbxYXwZchUGgAOnMcOstnsuX28EuIE0pSgqFhlj821iQy4j0EInEMCksgg03gygkYRCXwOv0q1UhMDWJBaVw0IDxIr0+Gq6F42wBwJJ8JIiMCHxuIAMvGYACIhgBhMq8QgULVbcJa3bofWG41qu4PObIiCEITxaU8bV6g2vY3ybHwAD0-vg5qgE0tXqNWtAdpgDqdLo1PGRhOJaHRfliOoyVu9WtyfsDwYtOcj0fusZR8ddMsERmQYHQhAAZkg06SEQEaAWg2d0GX7ZXnbEAPLSABW6BeyIA1ugJDBqzx86oA0HtSmFXgMlq0lmSCWffBQEA)

# mysql - MySQL自动更新表数据

> ID：14841609
> 
> 赞同：0
> 
> 时间：2013-02-12T20:53:33.603
> 
> 标签：mysql

我有两张桌子，一张是临时的，叫做 Persons，第二张是永久的，叫做雇员。

临时表每隔几个小时就会有人更新一次，其中包含两个字段，名字和姓氏。

永久表称为雇员。这是我们对员工的永久记录，包括他们的所有联系信息等。重要的是，它包括两个字段名和姓。

我有这个查询，它向我显示人员中的记录是否与员工中的记录匹配。

SELECT T.FirstName, CASE WHEN P.FirstName IS NULL THEN 'DOES NOT EXIST' ELSE 'DOES EXIST' END FROM employee T LEFT JOIN Persons P ON T.FirstName = P.FirstName AND T.LastName = P.LastName

我希望在 MySQL 中持续运行一些东西并做两件事：

1.  如果名称在 Persons 表和员工表中的名字和姓氏匹配，我想收到一封电子邮件，上面写着“找到重复的员工”。并且，我希望它只将这两个字段添加到员工表中，然后从 Persons 表中删除记录。

2.  如果没有匹配项，我只想将这两个字段添加到员工表中的新行并从 Persons 中删除该行。

我知道这听起来倒退，但我已经考虑过了。我可以进行查询，但我需要 MySQL 以某种方式定期自动执行此操作。

很想得到你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:05:08.100

MySQL 5.1 引入了一个名为**Events**的功能，它允许您按计划执行一段过程代码（如 cron）。

见[http://dev.mysql.com/doc/refman/5.5/en/events.html](http://dev.mysql.com/doc/refman/5.5/en/events.html)

# c# - 无法在服务器上上传文件

> ID：14841611
> 
> 赞同：0
> 
> 时间：2013-02-12T20:53:36.947
> 
> 标签：c#, asp.net-mvc, io

我正在尝试上传图像。当我从本地主机执行此操作时它可以正常工作，但是当我发布它时它会从服务器引发错误：

当我使用此代码时：

```
public string ImagePath(HttpPostedFileBase imgfile)
        {
            var path = "";
            // code for saving the image file to a physical location.
            var fileName = Path.GetFileName(imgfile.FileName);

            path = Path.Combine(HttpContext.Server.MapPath("~/Images/Sections/Developer/ClientLogo"), fileName);

            string fileNameWithoutExtension = System.IO.Path.GetFileNameWithoutExtension(imgfile.FileName);
            int iteration = 1;
            while (System.IO.File.Exists((path)))
            {
                fileName = string.Concat(fileNameWithoutExtension, "-", iteration, System.IO.Path.GetExtension(imgfile.FileName));

                path = Path.Combine(HttpContext.Server.MapPath("~/Images/Sections/Developer/ClientLogo"), fileName);
                iteration++;
            }
            imgfile.SaveAs(path);
            // prepare a relative path to be stored in the database and used to display later on.
            path = Url.Content(Path.Combine("~/Images/Sections/Developer/ClientLogo", fileName));
            return path;
        } 
```

错误是

System.UnauthorizedAccessException：对路径“D:\InetPub\vhosts\xx.com\httpdocs\Images\Sections\Developer\ClientLogo\circle-small-empty.18x18.png”的访问被拒绝。在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) 在 System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs , String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost) at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy) at System。 System.Web.HttpPostedFile.SaveAs(String filename) 在 System.Web.HttpPostedFileWrapper 的 IO.FileStream..ctor(String path, FileMode mode)。

```
And when I use Server.MapPath instead of HttpContext.Server.MapPath it throw different error: 
```

错误是：

System.IO.DirectoryNotFoundException：找不到路径“D:\InetPub\vhosts\xx.com\httpdocs\Images\Sections\Developer\ClientLogo\demo.png”的一部分。在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) 在 System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs , String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost) at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy) at System。 IO.FileStream..ctor(String path, FileMode mode) at System.Web.HttpPostedFile.SaveAs(String filename) at System.Web.HttpPostedFileWrapper.SaveAs(String filename) at xx。

我试图从我的本地主机更改权限，但没有任何效果...请给我一些建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:26:18.500

您的 Web 应用程序无权写入您尝试保存图像的位置。这通常通过在您的 web.config 中添加一个条目来处理，该条目指向保存所有上传的文件夹

```
<appSettings>
  ...
  <add key="uploadPath" value="C:\Uploads"/>
  ...
</appSettings> 
```

然后在您的代码中，您将读取该配置条目以识别将保存图像的路径：

```
....
string path = ConfigurationManager.AppSettings["uploadPath"];
string filePath = Path.Combine(path, fileName);
.... 
```

然后为了将文件保存到此目录，您需要设置该目录的权限，以便运行 Web 应用程序的用户对该目录具有写入权限。这将允许您将文件从 Web 应用程序写入该文件夹。

这样，作为开发人员的您就不会指定文件的去向。系统管理员可以决定文件的去向，以及支持您的 Web 应用程序所需的权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T20:13:41.233

检查文件夹的只读属性是否处于活动状态。如果这是一台Windows机器，则在文件夹的属性中取消选中它。

如果它不断恢复，您可能需要通过转到安全性->高级->有效权限->单击选择...->输入您的用户名并检查完全控制->然后单击确定来获得该文件夹的所有权。

# opengl - 即使使用兼容的显卡和更新的驱动程序，nvidia OpenGL 扩展也不可用

> ID：14841614
> 
> 赞同：0
> 
> 时间：2013-02-12T20:53:48.300
> 
> 标签：opengl, gpu, nvidia, opengl-4

我有一张 440 GT Nvidia 卡。我需要对 opengl 4.3 的支持，其中包含我需要使用的新 GL_NV_bindless_texture 扩展。

我升级了我的驱动程序，正如它所说，OpenGL 4.3 将可用于所有基于 Kepler 或 Fermi 的 GPU。我的在名单上。你可以在这里看到它：

[官方更新站点](https://developer.nvidia.com/opengl-driver)

但无论我做什么，我都没有 OpenGL 4.3 支持。我升级了，但它仍然说我在 opengl 4.2 -> 不允许扩展。

怎么会这样？Aren'ti 能够使用这个特殊的扩展？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:38:40.020

> 我需要对 opengl 4.3 的支持，其中包含我需要使用的新 GL_NV_bindless_texture 扩展。

这是错误的，也是您问题的根源。NV_bindless_texture 并非来自 OpenGL 4.3。事实上，[扩展规范](http://www.opengl.org/registry/specs/NV/bindless_texture.txt)甚至不需要 4.3；它是针对它需要的 4.0 编写的。

对您来说更重要的是，NV_bindless_texture[需要 Kepler (GeForce GT6xx+) 硬件](http://en.wikipedia.org/wiki/Nvidia_Kepler#Features)。因此，没有驱动程序更新将使您可以使用它。

# matlab - 使用 Matlab 编辑多个 Matlab .m 文件

> ID：14841617
> 
> 赞同：4
> 
> 时间：2013-02-12T20:53:57.033
> 
> 标签：matlab

我有一些 50+ m 文件在以前的驱动程序版本中工作，但对于较新的驱动程序版本已经过时。因此，我需要查找和替换各种变量或字段名称，有时还要编辑所有这些文件的变量输入。例如，我想找到这条线

```
src.aaaa = 100; 
```

并将其替换为：

```
src.bbbb = 100; 
```

另一个例子是替换：

```
vid = videoinput('xxxx' ,1, 'yyy') 
```

和：

```
vid = videoinput('kkkkkk' ,1, 'zzzz') 
```

我搜索并找到[了这个讨论](https://stackoverflow.com/questions/12595662/search-for-text-across-multiple-m-files-within-the-matlab-user-interface)，它允许搜索多个文件，但不能真正编辑或替换任何内容。我可以处理matlab，所以我正在寻找一种在matlab中做到这一点的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:13:45.957

您可以使用您发布的“查找文件”对话框 (Ctrl-Shift-F) 查找您要查找的每个文件，然后“查找并替换”(Ctrl+F) 您要更改的特定行。

例如，`src.aaaa = 100;`使用 Ctrl+Shift+F 查找文件。然后 Ctrl+F 并添加`src.aaaa = 100;`到上面的文本框和`src.bbbb = 100;`下面的文本框。

从您的帖子中，尚不清楚这是否可行，因为我不知道您想在这些 m 文件中更改多少不同的行。那里有多少？m 文件是相似的还是都不同？

如果您正在搜索特定的变量，您可以编写一个脚本来循环搜索使用该`dir`函数的所有 m 文件。使用 . 将 m 文件读入字符串变量`fscanf`。然后使用 替换字符串中的变量`strrep`。最后使用`fprintf`更正的变量写入新的 .m 文件。

**参考：**

*   [http://www.mathworks.com/help/matlab/ref/dir.html](http://www.mathworks.com/help/matlab/ref/dir.html)
*   [http://www.mathworks.com/help/matlab/ref/fscanf.html](http://www.mathworks.com/help/matlab/ref/fscanf.html)
*   [http://www.mathworks.com/help/matlab/ref/strrep.html](http://www.mathworks.com/help/matlab/ref/strrep.html)
*   [http://www.mathworks.com/help/matlab/ref/fprintf.html](http://www.mathworks.com/help/matlab/ref/fprintf.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T23:15:30.547

有点开箱即用 - 但我会使用[sed](http://en.wikipedia.org/wiki/Sed)命令 - 它完全符合您的要求并且速度很快，但是您需要调用它`system`并构建命令字符串。如果您在 Windows 上，您可能需要通过[msys](http://www.mingw.org/wiki/MSYS)或[cygwin](http://www.cygwin.com)安装它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-21T06:43:29.357

实施 Sekkou 建议的 m 文件：

```
clear all;
clc;

%% Parameter

directory           = 'd:\xxx';
oldString           = 'the old text';
newString           = 'the new text';
regularExpression   = '[\w]+\.m';

%% Determine files to manipulate

cd(directory)

allFilesInDirectory = dir;

%% Manipulieren der verweneten Dateien

disp('Manipulated Files:');

for idx = 1 : length(allFilesInDirectory)

    if (~isempty ( regexp(allFilesInDirectory(idx).name, '[\w]+\.m','match') ))

        disp(allFilesInDirectory(idx).name);

        % Read and manipulate Text
        fileIdRead  = fopen(allFilesInDirectory(idx).name, 'r');
        fileText    = fscanf(fileIdRead,'%c');

        fileTextNew = strrep(fileText, oldString, newString);

        fclose(fileIdRead);

        % Write Text
        fileIdWrite = fopen(allFilesInDirectory(idx).name, 'w');

        fprintf(fileIdWrite, '%c', fileTextNew);

        fclose(fileIdWrite);
    end

end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-28T07:05:56.557

Ergodicity 回复了一些很棒的代码，但是：

*   有些评论是德语而不是英语
*   普遍缺乏评论，这使得难以理解

我试图用下面的代码解决这些问题（我似乎无法使用“语言：lang-matlab”很好地以 MATLAB 格式显示代码，因此将其粘贴到 MATLAB 中以便于阅读）：

```
close all;
clear all;
clc;
%% Parameters
% The directory in which to replace files. Currently this code does not modify files in
% sub-directories
directory           = 'C:\Users\Name\Wonderful code folder';
% The string that will be replaced
oldString           = sprintf('terrible mistake');
% The replacement string
newString           = sprintf('all fixed now');
% The file name condition - what type of files will be examined
% It must contain any of the English character set (letters, numbers or underscore
% character i.e. a-zA-Z_0-9) and ends with a ".m" MATLAB extension (use \.txt for text files)
regularExpression   = '[\w]+\.m';

%% Determine files to update, and update them as necessary
% Change the current directory to the user-specified one
cd(directory)
% Put the details of all files and folders in that current directory into a structure
allFilesInDirectory = dir;
% Initialise indexes for files that do and do not contain oldString
filesWithStringIndex = 1;
filesWithoutStringIndex = 1;
% For the number of files and folders in the directory
for idx = 1 : length(allFilesInDirectory)

    % If the file name contains any of the English character set (letters, numbers or
    % underscore character i.e. a-zA-Z_0-9) and ends with a ".m" filetype...
    if (~isempty ( regexp(allFilesInDirectory(idx).name, '[\w]+\.m','match') ))

        % Open the file for reading
        fileIdRead  = fopen(allFilesInDirectory(idx).name, 'r');

        % Extract the text
        fileText = fscanf(fileIdRead,'%c');

        % Close the file
        fclose(fileIdRead);

        % Search for occurrences of oldString
        occurrences = strfind(fileText,oldString);

        % If an occurrence is found...
        if ~isempty(occurrences)

            % Replace any occurrences of oldString with newString
            fileTextNew = strrep(fileText, oldString, newString);

            % Open the file for writing
            fileIdWrite = fopen(allFilesInDirectory(idx).name, 'w');

            % Write the modified text
            fprintf(fileIdWrite, '%c', fileTextNew);

            % Close the file
            fclose(fileIdWrite);

            % Update the list of files that contained oldString
            filesWithString{filesWithStringIndex} = allFilesInDirectory(idx).name;

            % Update the index for files that contained oldString
            filesWithStringIndex = filesWithStringIndex + 1;

        else
            % Update the list of files that did not contain oldString
            filesWithoutString{filesWithoutStringIndex} = allFilesInDirectory(idx).name;

            % Update the index for files that did not contain oldString
            filesWithoutStringIndex = filesWithoutStringIndex + 1;

        end
    end
end
%% Display what files were changed, and what were not
% If the variable filesWithString exists in the workspace
if exist('filesWithString','var')
    disp('Files that contained the target string that were updated:');
    % Display their names
    for i = 1:filesWithStringIndex-1, disp(filesWithString{i}); end
else
    disp('No files contained the target string');
end
% Insert a clear line between lists
disp(' ');
% If the variable fileWithoutString exists in the workspace
if exist('filesWithoutString','var')
    disp('Files that were not updated:');
    % Display their names
    for j = 1:filesWithoutStringIndex-1, disp(filesWithoutString{j}); end
else
    disp('All files contained the target string.');
end 
```

# javascript - 我什么时候应该拒绝承诺？

> ID：14841619
> 
> 赞同：24
> 
> 时间：2013-02-12T20:54:11.253
> 
> 标签：javascript, jquery, jquery-deferred, promise

我正在编写一些使用承诺的 JS 代码。例如，我打开一个表单弹出窗口并返回一个[jQuery Deferred](http://api.jquery.com/jQuery.Deferred/)对象。它是这样工作的：

*   如果用户在表单上单击“确定”并进行验证，则 Deferred 将解析为表示表单数据的对象。

*   如果用户单击 Cancel，则 Deferred 解析为 null。

我想要决定的是 Deferred 是否应该拒绝而不是解决？更一般地说，我想知道什么时候应该解决类似空对象的问题，什么时候应该拒绝？

这是一些演示这两个位置的代码：

```
// Resolve with null.
var promise = form.open()
    .done(function (result) {
        if (result) {
            // Do something with result.
        } else {
            // Log lack of result.
        }
    });

// Reject.
var promise = form.open()
    .done(function (result) {            
        // Do something with result.            
    })
    .fail(function () {
        // Log lack of result.
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:03:25.517

您的两种策略的语义并不完全相同。明确拒绝延迟是有意义的。

例如，只要传递的延迟对象成功， [$.when()就会继续累积结果，但会在第一个失败的对象处退出。](http://api.jquery.com/jQuery.when/)

这意味着，如果我们分别重命名您的两个承诺`promise1`和`promise2`：

```
$.when(promise1, promise2).then(function() {
    // Success...
}, function() {
    // Failure...
}); 
```

上面的代码将等到第二个表单关闭，即使第一个表单被取消，然后调用传递给的回调之一`then()`。调用的回调（成功或失败）将仅取决于第二种形式的结果。

但是，如果取消第二个表单，则该代码*不会在调用失败回调之前等待第一个表单关闭。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T20:57:29.620

由于它是用户控制的，我不会将其视为“失败”。第一个选项似乎更干净。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:57:49.253

好吧，在这两种情况下你都会做一些不同的事情，所以我会说总是要么解决它，要么拒绝它。在解决时发布您的表单，在拒绝时什么也不做。然后，始终关闭表单。

```
var promise = form.open()
.done(function (result) {            
    // Do something with result.            
})
.fail(function () {
    // Log lack of result.
})
.always(function() {
    // close the form.
}) 
```

如果您在取消时没有拒绝，那么您什么时候拒绝过？那时，为什么要使用延迟对象？你可以拒绝输入错误，但如果你想让他们修复它，你必须生成一个全新的承诺。

* * *

延期似乎并不适合在这里使用。我只是使用事件。

# c# - 通过后面的 c# 代码发布到 URL vales

> ID：14841621
> 
> 赞同：1
> 
> 时间：2013-02-12T20:54:14.840
> 
> 标签：c#, .net

我正在尝试制作一个通用登录页面，该页面采用登录信息实际提交到的 redirectPage。

应用程序的流程是这样的：

1.  输入用户名并登录并进行我自己的身份验证
2.  一旦通过身份验证，我会检索 2 个不相关的变量（ varA、varB ）
3.  现在我需要通过 post 将 varA 和 varB 提交到 redirectPage。我不想做会话变量或查询字符串。我想做重定向和发布，就像您从表单发布一样。

到目前为止，我在 SO 上看到的是客户刚刚发布并获得回复的地方。我不关心我也想重定向到此页面的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:01:05.967

这将花费往返（就像`Response.Redirect()`那样），但这是一种理智的方式来做你想做的事。

```
public void ReirectPost(string redirectUrl, Dictionary<string,string> vars)
{
  Response.Clear();

  StringBuilder sb = new StringBuilder();
  sb.Append("<html>");
  sb.AppendFormat(@"<body onload='document.forms[""form""].submit()'>");
  sb.AppendFormat("<form name='form' action='{0}' method='post'>", redirectUrl);
  foreach(var v in vars)
    sb.AppendFormat("<input type='hidden' name='{0}' value='{1}'>", v.Key, v.Value);

  sb.Append("</form></body></html>");

  Response.Write(sb.ToString());
  Response.End();
} 
```

# javafx-2 - JavaFx：对话后，两个文本字段获得焦点而不是一个

> ID：14841622
> 
> 赞同：1
> 
> 时间：2013-02-12T20:54:14.940
> 
> 标签：javafx-2

以下问题：changeListener中的指令导致两个TextFields在Dialog之后获得焦点的行为。

当 Postleitzahl 失去焦点时，它会打开一个对话框。如果单击确定，则只需第一个文本字段获得焦点。但真正发生的是下面的文本字段也获得了焦点。

方法“controlMinChar”设置数字的最小数量。方法 setMinCharacter 使用方法并使用了focusedProperty

```
 private void setMinCharacter(){

    plz.focusedProperty().addListener(new ChangeListener<Boolean>() {

        @Override
        public void changed(ObservableValue<? extends Boolean> ov, Boolean lostFocus, Boolean getFocus) {

            if(lostFocus){

                     generalControler.controlMinChar(plz, 5, 
                    (Stage) anchorPane.getScene().getWindow(), 
                    errorMessage);

            }

        }
    });

} 
```

我希望你能帮助我。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:05:09.160

问题是：http: [//javafx-jira.kenai.com/browse/RT-28363](http://javafx-jira.kenai.com/browse/RT-28363)

解决方法：

```
 tf1.focusedProperty().addListener(new ChangeListener<Boolean>() {
        @Override
        public void changed(ObservableValue<? extends Boolean> ov, Boolean lostFocus, Boolean getFocus) {
            if (lostFocus) {
                Platform.runLater(new Runnable() {
                    @Override
                    public void run() {
                        tf1.requestFocus();
                    }
                });
            }
        }
    }); 
```

# arm - 将 libdaemon 交叉编译到 ARM 不起作用？

> ID：14841625
> 
> 赞同：0
> 
> 时间：2013-02-12T20:54:26.817
> 
> 标签：arm, cross-compiling

我试图为 ARM 架构交叉编译库 [libdaemon](http://0pointer.de/lennart/projects/libdaemon/)，但我面临 libdeamon 没有被交叉编译的问题，我不明白为什么。在对库 libdeamon 进行交叉编译（制作 ./conf 并进行安装）之后，我已经能够检查该库是否针对 arm 进行了交叉编译，因为它已被“交叉编译”用于构建英特尔，因为它可以看到

```
:~/libdaemon-0.14$ file -F usr/*/*.*
    usr/lib/libdaemon.lausr/lib/libdaemon.a       libtool library file,
    usr/lib/libdaemon.sousr/lib/libdaemon.a       symbolic link to `libdaemon.so.0.5.0'
    usr/lib/libdaemon.so.0usr/lib/libdaemon.a     symbolic link to `libdaemon.so.0.5.0'
    usr/lib/libdaemon.so.0.5.0usr/lib/libdaemon.a ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, BuildID[sha1]=0xe4959941fb153e1dec5ec84f798dc32928219ae2, not stripped 
```

libdaemon 的配置是这样的

```
~/libdaemon-0.14$ ./configure --build=i686-linux --host=arm-linux-gnueabi --enable-shared --prefix=/usr
~/libdaemon-0.14$ sudo make DESTDIR=/home/j/libdaemon-0.14 install 
```

我做错了什么的任何提示？

提前致谢！

# c++ - 使用 Luabind 比较存储的 C++ 对象指针时，Lua 函数崩溃

> ID：14841626
> 
> 赞同：2
> 
> 时间：2013-02-12T20:54:27.753
> 
> 标签：c++, lua, luabind

我刚刚开始使用 Luabind 和 C++。我的目标很简单：

我想创建一个 Lua 函数，它将 C++ 对象指针作为参数并将对象存储在 Lua 变量中。每次调用 Lua 函数时，它应该首先检查传递给它的对象指针是否与上一次调用期间存储的对象指针相同。

这是完整的代码：

```
extern "C" {
  #include "lua.h"
  #include "lualib.h"
}
#include <luabind/luabind.hpp>

class Obj {
};

int main(int argc, char **argv) {
  lua_State* cLuaState = luaL_newstate();
  luabind::open(cLuaState);
  luaL_openlibs(cLuaState);

  luabind::module(cLuaState) [
    luabind::class_<Obj>("Obj")
  ];

  luaL_dostring(cLuaState, "\
    function func(v)\n\
      print (\"Before: x is same as v?\")\n\
      print (x == v)\n\
      x = v\n\
      print (\"After: x is same as v?\")\n\
      print (x == v)\n\
    end");

  Obj* o = new Obj();
  try {
    luabind::call_function<void>(cLuaState, "func", o);
    luabind::call_function<void>(cLuaState, "func", o);
  } catch (std::exception &e) {
    std::cout << "Exception thrown: " << e.what() << std::endl;
    return 1;
  }
  return 0;
} 
```

当我运行这个程序时，我希望看到以下输出：

```
Before: x is same as v?
false
Setting v
After: x is same as v?
true
Before: x is same as v?
true 
Setting v
After: x is same as v?
true 
```

但是，当我运行该程序时，它在“x”和“v”之间的比较期间第二次调用 Lua 函数时崩溃。这是程序的实际输出：

```
Before: x is same as v?
false
Setting v
After: x is same as v?
true
Before: x is same as v?
Exception thrown: lua runtime error
*** Exited with return code: 1 *** 
```

可以看出，在设置“v”之前和之后的第一个函数调用期间，比较都有效。但是，在调用第二个函数期间，第一次比较失败。

我一定错过了一些非常明显的东西，但我真的不知道它是什么。谁能看到我做错了什么？非常感谢任何建议！

非常感谢你，马丁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T06:49:22.417

我找到了解决方案。似乎出于某种原因，Lua 想使用重载的 C++ 等于运算符来对两个对象执行比较，而不是执行指针本身的比较。通过创建一个简单地比较两个对象的地址并将其绑定到 Lua 的重载相等运算符，我可以使它工作。

我仍然不确定为什么 Lua 只会在第二个函数调用而不是第一个函数调用中进行比较，但至少我现在有一个可行的解决方案。

完整修改的工作版本如下：

```
extern "C" {
  #include "lua.h"
  #include "lualib.h"
}
#include <luabind/luabind.hpp>
#include <luabind/operator.hpp>

class Obj {
};

bool operator==(const Obj& a, const Obj& b) {
  return &a == &b;
}

int main(int argc, char **argv) {
  lua_State* cLuaState = luaL_newstate();
  luabind::open(cLuaState);
  luaL_openlibs(cLuaState);

  luabind::module(cLuaState) [
    luabind::class_<Obj>("Obj")
      .def(luabind::const_self == luabind::const_self)
  ];

  luaL_dostring(cLuaState, "\
    function func(v)\n\
      print (\"Before: x is same as v?\")\n\
      print (x == v)\n\
      x = v\n\
      print (\"After: x is same as v?\")\n\
      print (x == v)\n\
    end");

  Obj* o = new Obj();
  try {
    luabind::call_function<void>(cLuaState, "func", o);
    luabind::call_function<void>(cLuaState, "func", o);
  } catch (std::exception &e) {
    std::cout << "Exception thrown: " << e.what() << std::endl;
    return 1;
  }
  return 0;
} 
```

# c# - firebird c# 连接到远程数据库

> ID：14841630
> 
> 赞同：0
> 
> 时间：2013-02-12T20:54:45.273
> 
> 标签：c#, firebird

我正在处理一些现有的项目，并且试图将其从客户端的许多 firebird 数据库转移到一个基于服务器的数据库。

不幸的是，我在连接字符串方面遇到了一些问题。

是否可以连接到远程服务器上的 .fdb 文件？

目前代码如下：

```
var builder = new FbConnectionStringBuilder
        {
            Database = @"C:\test.db",
            ServerType = FbServerType.Embedded,
            Pooling = isPooled
        }; 
```

我已经阅读了一些关于如何像下面这样完成但它不起作用的示例：

```
FbConnectionStringBuilder(@"Database=192.168.1.235:C:\share\test.fdb;User ID=sysdba;Password=masterkey;") 
```

它仍然只连接到本地目录 C:\share\test.fdb。因为那不是我的IP地址。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T08:46:30.480

该`Database`属性仅用于数据库文件名或别名，您需要`DataSource`用于主机名或 IP 地址以及`Port`Firebird 端口。查看[.NET — 使用示例](http://www.firebirdsql.org/en/net-examples-of-use/)和[连接字符串参数](http://web.firebirdsql.org/firebirdtutorial/connection-string-parameters.html)

此外，该类[`FbConnectionStringBuilder`](http://web.firebirdsql.org/firebirdtutorial/fbconnectionstringbuilder.html)旨在简化构建连接字符串（它具有各种连接字符串属性的属性），因此您的第一次使用是正确的，但第二次使用有点奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:13:12.913

好的，所以我想我解决了。您无法远程访问嵌入式数据库。因此，一旦安装了服务器软件并将其删除，一切正常。在远程驱动器上连接它会是一个方便的功能，但哦，好吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-26T20:47:41.053

确保 fireBird 正在侦听端口 3050，取消注释此行`firebird.conf`

```
RemoteServiceName=gds_db
RemoteServicePort=3050 
```

重新启动服务。

# google-chrome - 无法在 chrome 上启用 RTCDataChannel

> ID：14841632
> 
> 赞同：1
> 
> 时间：2013-02-12T20:54:54.570
> 
> 标签：google-chrome, webrtc

我的 chrome 版本是 26.0.1410.0 金丝雀。我在浏览器中输入“chrome://flags/”，然后尝试找到 RTCDataChannel。该标志不在列表中。这个标志是被删除还是我需要更新版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T11:41:55.140

从版本 26 开始，RTCDataChannel 无需设置标志即可在 Canary 中运行。**版本 25中**有一个标志。

要对其进行测试，请尝试[simpl.info/dc](http://simpl.info/dc)演示。这仅演示了同一页面上的“同行”之间的通信，但它是一个很好的起点。

# java - Java-如何将一串数字转换为字母数组

> ID：14841635
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:02.993
> 
> 标签：java, split

这就是我想要做的：

我希望能够在提示符下输入一些数字，例如

> 输入
> 
> 10 10 20 30

之后，我想将每个数字转换为一个字母，这样我的输出就像

杰特

这是我的代码。目前我得到的都是空的。

```
import java.util.Scanner;
public class mainClass {
    public static void main(String[] args) {
       System.out.println("Past in code here: ");
       Scanner inputM=new Scanner(System.in);
       String  input=inputM.nextLine();
       String[] Emessage=input.split(" ");
       String[] eMessage=new String[Emessage.length];

       for(int i = 0; i < Emessage.length; i++) {
          if(Emessage[i]=="10"){eMessage[i]="a";}
          if(Emessage[i]=="20"){eMessage[i]="b";}
          if(Emessage[i]=="30"){eMessage[i]="c";}
          if(Emessage[i]==" "){eMessage[i]=" ";}           
       } 

       System.out.println(" ");

       for(int i=0;i<eMessage.length;i++){
           System.out.print(eMessage[i]);
       }
    }
} 
```

这是一个示例运行：......................

> 过去的代码在这里：
> 
> 10 20 30
> 
> nullnullnull

注意：nullnullnull 应该等于 abc

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:59:04.063

尝试

```
 if (Emessage[i].equals("10") {
        //code
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T13:21:24.203

由于 String 是一个对象，因此您无法使用 == 运算符检查字符串的相等性。您需要使用 equals 方法来检查相等性，如下所示

```
if( "10".equals( Emessage[i] ) ){ eMessage[i]="a"; } 
```

# jquery - 使用 $.getJSON 检索 CSV 数据

> ID：14841637
> 
> 赞同：3
> 
> 时间：2013-02-12T20:55:07.443
> 
> 标签：jquery, ajax, csv, getjson

我正在尝试使用 Yahoo 的 Finance API 检索股票数据：

```
 $.ajax({
            dataType: "json",
            url: 'http://download.finance.yahoo.com/d/quotes.csv',
            data: 's=RHT+MSFT&f=sb2b3jk&callback=?',
            success: function (d) {
                console.log(JSON.stringify(d));
            },
            error: function (d, a, b) {
                console.log(JSON.stringify(d));
                console.log(JSON.stringify(a));
                console.log(JSON.stringify(b));
            },
            complete: function (d, a, b) {
                console.log(JSON.stringify(d));
                console.log(JSON.stringify(a));
                console.log(JSON.stringify(b));
            }
        }); 
```

调用有效，我可以在响应中看到 csv 文本（使用 Chrome 的开发人员工具）：

![在此处输入图像描述](../Images/b3415afbd46c7b8e5d84013ccfdaf6c6.png)

现在，我的问题是我无法访问响应中包含的文本。

正如您在原始脚本中看到的，我尝试在 、 和 回调中捕获响应`"success"`，`"error"`但`"complete"`响应文本不包含在其中任何一个中。此外，仅引发`"error"`and`"complete"`回调。

我会很感激对此的任何见解，在此先感谢！

附言。我使用 CSV 查询而不是 YQL 查询的原因是 CSV 查询更容易指定我需要的字段。我发现 YQL 查询使用起来更加麻烦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T20:57:35.937

该[`$.getJSON()`](http://api.jquery.com/jQuery.getJSON/)方法接受`text/json`内容类型并且`CSV`不是这种类型。

> 这是一个简写的 Ajax 函数，相当于：
> 
> ```
> $.ajax({
>   dataType: "json",
>   url: url,
>   data: data,
>   success: success
> }); 
> ```

`complete`执行，因为无论请求是否导致 a`success`或，它都会执行`error`。

# javascript - Dijit 第一个教程

> ID：14841640
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:22.000
> 
> 标签：javascript, dojo

我知道这将是一个非常愚蠢的问题，但是自从我上次开发一些 javascript 以来已经过去了几年。我想刷一下，所以我决定学习一些 Dojo。问题是我无法让这个简单的 Dijit 示例正常工作据我所知，它应该生成一个带有 Click Me 标签的按钮，但我得到的唯一东西是一个空按钮。似乎脚本没有执行。我究竟做错了什么？

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Dijit</title>
    <!-- load Dojo -->
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/dojo/1.8.1/dijit/themes/claro/claro.css">
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.8.1/dojo/dojo.js" data-dojo-config="isDebug: true, async: true, parseOnLoad: true"></script>
</head>
<body class="claro">
    <button id="btn"></button>
        <script>
        require(["dijit/form/Button", "dojo/domReady!"], function(Button) {
            var button = new Button({
                label: "Click Me!",
                onClick: function(){ console.log("First button was clicked!"); }
            }, "btn");
            button.startup();
        });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:30:24.243

如果您使用 file:// URL 加载页面（或双击文件），由于您用于加载样式表和 dojo 的无模式 URI，它将无法工作。

尝试在相应的链接和脚本标记中的前导斜杠对之前添加协议“http”。

另请参阅[我可以将所有 http:// 链接更改为 // 吗？](https://stackoverflow.com/questions/4831741/can-i-change-all-my-http-links-to-just)

# c++ - 试图在mac上编译C++代码

> ID：14841642
> 
> 赞同：-2
> 
> 时间：2013-02-12T20:55:30.230
> 
> 标签：c++, macos, compilation

我正在尝试在我的 Mac 上编译一些 C++ 代码。我可以使用 Xcode 运行它，但是当我尝试使用 gcc 从终端编译时，出现以下错误：

```
Undefined symbols for architecture x86_64:
  "std::cout", referenced from:
      _main in ccOJDOlb.o
  "std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*)", referenced from:
      _main in ccOJDOlb.o
  "std::ios_base::Init::Init()", referenced from:
      __static_initialization_and_destruction_0(int, int)in ccOJDOlb.o
  "std::ios_base::Init::~Init()", referenced from:
      ___tcf_0 in ccOJDOlb.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

有谁知道可能会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:58:18.920

> 我尝试使用 gcc 从终端编译

然后尝试`g++`代替普通的 ol' `gcc`。前者会自动链接到 C++ 标准库，后者不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:20:59.967

> ld：未找到架构 x86_64 的符号

这就是说链接器“ld”无法找到程序使用的某些符号的定义。所以你知道编译成功了。

ld 列出了具体的符号。请注意，它们都来自标准库。这应该告诉您链接器可能找不到标准库。

通常，当您使用库时，您必须使用链接标志告诉编译器工具链。但是对于一种语言的标准库，GNU 编译器集合中的编译器通常只是假设您需要该语言的库。所以运行 gcc 命令会自动包含 C 标准库，运行 g++ 会自动包含 C++ 标准库等。但是请注意，运行 'gcc' 不会自动链接到 C++ 标准库中。您很可能正在运行命令“gcc”，而只是没有为 C++ 标准库添加正确的链接器标志。

如果由于某种原因你想使用 gcc 而不是 g++，你必须明确声明你想要标准库，使用像`-lstdc++`.

* * *

此外，除非您真的需要 gcc 并且您自己在 OS X 上安装它的最新版本，否则您可能需要切换到 clang/clang++ 和 C++ 标准库的 libc++ 实现。Xcode 自带的 gcc 是基于老版本的，标准库也同样老。Xcode 已经过渡到 clang 作为系统编译器已经有一段时间了。clang 编译器驱动程序与 gcc 具有基本兼容性，因此您可以使用许多相同的基本标志。这是一个很好的开始：

```
clang++ -std=c++11 -stdlib=libc++ -Wall -Wextra 
```

# ios - iOS 和后台任务中的套接字连接

> ID：14841644
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:33.753
> 
> 标签：ios, sockets, background-process, nsstream

我正在设计一个需要通过网络实时交换数据的应用程序，我计划使用套接字连接来实现这一点。为了在后台保持套接字连接打开，我计划将我的应用程序声明为 VOIP 应用程序（我已经知道苹果的规则禁止这样做并愿意承担风险），并使用 keepAliveTimeout 保持连接活动。现在我可以声明并拥有一个可以监听任何传入数据的套接字，还是必须使用 Apple 提供的现有/特定套接字？每个应用程序或每个电话的端口也是唯一的吗？意味着如果我的应用程序在后台继续运行，并且通过 Skype 打来电话，它们会相互干扰吗？提前感谢您的回复。帮助将不胜感激。

# android - 滚动时Android浏览器上的顶部固定导航栏抖动？

> ID：14841645
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:34.623
> 
> 标签：android, html, css

使用 Android 设备访问使用固定在顶部的导航栏的网页。

[示例 1：下一个 Web](http://thenextweb.com/ "示例 1")

[示例 2：我构建的测试页面（您必须向下滚动一点才能获得固定的导航栏）](http://andrew-oh.com/testpage/ "示例 2")

只有我，还是其他人在您滚动页面时看到导航栏“抖动”？有什么可以解决的吗？我在三星 Galaxy S3 上看到了这个问题，它使用 Chrome、Dolphin Browser HD 和普通浏览器运行 Jelly Bean。出于某种原因，我无法用我的 Asus Transformer TF101 平板电脑复制这个问题。

# javascript - 奇怪的 Google 地图行为：弹出框和缩放栏未正确显示

> ID：14841647
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:37.437
> 
> 标签：javascript, php, google-maps

首先，我认为一张图片最能说明我的问题：

![在此处输入图像描述](../Images/a23cd08a54149ccc261d15035af2b4fe.png)

在图片中你可以看到我的气球上的弹出框是多么的乱七八糟，左边的缩放栏也几乎不存在。

我有 php 生成我的地图代码，我的代码如下所示：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.3&amp;sensor=false"></script>
                    <div class="span9 space"><div id="map" style="width: 600px; height: 400px;"></div><script type="text/javascript">
    var locations = [['21st Amendment Brewery', 37.7824175, -122.3925921] ,['Allagash Brewing Company', 43.702697, -70.317975] ,['Anheuser-Busch', 38.5986606, -90.208751] ,['Ayinger Brewery', , ] ,['Bass Brewery', 52.8045853, -1.6281372] ,['Bear Republic Brewery', 38.6040452, -122.8599961] ,['Boston Beer Company', 42.314449, -71.103365] ,['Boulevard Brewing Company', 39.0821348, -94.5966532] ,['Brasserie des Franches-Montagnes', 47.2542808, 7.0025782] ,['Breckenridge Brewery', 39.723597, -105.000614] ,['Brewery Ommegang', 42.6818046, -74.9254739] ,['Brooklyn Brewery', 40.721535, -73.95745] ,['Brouwerij Artois', 50.8870692, 4.7025108] ,['Brouwerij Huyghe', 50.99832, 3.79404] ,['Buffalo Bills Brewery', 37.6738157, -122.0813029] ,['Butternuts Beer and Ale', 42.6290648, -75.1854868] ,['Caldera Brewing', 42.184409, -122.663147] ,['Cervecera Cuauhtmoc-Moctezuma', 25.6375417, -100.2946801] ,['Clipper City Brewing Company', 39.230827, -76.6751309] ,['Coors Brewing Company', 39.759876, -105.219026] ,['Cricket Hill Brewing Company', 40.872566, -74.296359] ,['D.G. Yuengling and Son', 40.6999592, -76.1747169] ,['Dogfish Head Craft Brewery', 38.770622, -75.310893] ,['DuClaw Brewing Company', 39.496656, -76.329843] ,['Erie Brewing Company', 42.111185, -80.112978] ,['Evolution Craft Brewing Company', 38.4622609, -75.5741469] ,['Firestone Walker Brewing Company', 35.595325, -120.693728] ,['Flying Dog Brewery', 39.361926, -77.424677] ,['Fordham Brewing Company', 39.1540034, -75.4883626] ,['Founders Brewing Company', 42.958468, -85.673516] ,['Fulton Brewing Company', 44.9849423, -93.2790206] ,['Goose Island Beer Company', 41.887107, -87.6720969] ,['Gordon Biersch Brewing', 37.354139, -121.89286] ,['Great Divide Brewing Company', 39.753646, -104.9884698] ,['Green Flash Brewing Company', 32.905722, -117.176517] ,['Grupo Modelo S.A. de C.V.', 19.422447, -99.209758] ,['Guinness', 53.34309, -6.290799] ,['Harpoon Brewery', 43.512997, -72.401527] ,['Heavy Seas', 39.230827, -76.6751309] ,['Heineken International', , ] ,['Hoppin Frog Brewery', 41.0245928, -81.4677107] ,['Jacob Leinenkugel Brewing Company', 44.943321, -91.3953049] ,['Lagunitas Brewing Company', 38.272435, -122.662346] ,['Magic Hat Brewing Company', 44.428405, -73.213148] ,['Maui Brewing Company', 20.972149, -156.677334] ,['Mendocino Brewing Company', 38.9734335, -123.1162429] ,['MillerCoors Brewing Company', 43.044464, -87.962562] ,['Narragansett Brewing Company', 41.8190249, -71.4097368] ,['New Belgium Brewing', 40.593415, -105.066874] ,['North Coast Brewing Company', 39.446471, -123.806238] ,['Old Dominion Brewing Company', 39.1540034, -75.4883626] ,['Oskar Blues Brewery', 40.139056, -105.121887] ,['Pabst Brewing Company', 29.4497864, -98.5386319] ,['Port Brewing Company', 33.141417, -117.150076] ,['Port City Brewing Company', 38.8081958, -77.1014693] ,['RJ Rockers Brewing Company', 34.948639, -81.935726] ,['Rock Art Brewery', 44.557791, -72.608085] ,['Rogue Ales', 44.620173, -124.0520565] ,['Schneider Weisse', 48.91755, 11.87451] ,['Scottish & Newcastle Breweries', 55.954155, -3.202774] ,['Shipyard Brewing', 43.6618784, -70.2489402] ,['Sierra Nevada Brewing Company', 39.7246028, -121.8157154] ,['Sixpoint Craft Ales', 40.6739317, -74.0119473] ,['Sleeman Breweries Ltd.', 43.4870365, -80.2067709] ,['Smuttynose Brewing Co.', 43.032502, -70.7947688] ,['Southern Tier Brewing Company', 42.088931, -79.350342] ,['Spaten-Franziskaner-Bräu', 48.14501, 11.55419] ,['Staatliches Hofbräuhaus (Hofbräu München)', 48.1373073, 11.580357] ,['Stone Brewing Company', 33.115682, -117.119552] ,['Stoudts Brewery', 40.2422441, -76.0540026] ,['Surly Brewing Company', 45.04285, -93.324557] ,['The Bronx Brewery', 40.80828, -73.930669] ,['The Duck-Rabbit Craft Brewery', 35.600267, -77.597058] ,['The Lost Abbey', 33.141417, -117.150076] ,['The Saint Louis Brewery', 38.632968, -90.209769] ,['Tröegs Brewing Company', 40.304, -76.643519] ,['Unibroue', 45.466125, -73.290924] ,['Union Craft Brewing Company', 39.331938, -76.641971] ,['Victory Brewing Company', 40.0061038, -75.6941546] ,['Wells and Young&#39;s Brewing Company', 52.132011, -0.481523] ,['Weyerbacher Brewing Company', 40.673181, -75.224926] ,['Widmer Brothers Brewing', 45.540795, -122.675594] ,['Yards Brewing Company', 39.962616, -75.136253]  

        ];

    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 10,
      center: new google.maps.LatLng(-33.92, 151.25),
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

        var bounds = new google.maps.LatLngBounds();
    var infowindow = new google.maps.InfoWindow();

    var marker, i;

    for (i = 0; i < locations.length; i++) {
        var position = new google.maps.LatLng(locations[i][1], locations[i][2]);  
      marker = new google.maps.Marker({
        position: position,
        map: map
      });

      google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          infowindow.setContent(locations[i][0]);
          infowindow.open(map, marker);
        }
      })(marker, i));

      bounds.extend(position);

    } //end for loop

    map.fitBounds(bounds);

  </script> 
```

您还可以看到我在 chrome 控制台中收到此错误消息：

资源解释为图像，但使用 MIME 类型 text/html 传输：

我在尝试更新我的网站并将其引入我正在使用的新模板和 css 时遇到了这个问题。我在两个网站上都使用相同的函数调用来生成我的地图，所以我不明白为什么它在一个站点上而不是另一个站点上坏了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:58:09.487

它与 css 样式有关`img`

Bootstrap 在元素上有一个特定的样式，`img`它弄乱了 Google Maps Image 的

在您的样式表中找到该`img`样式并对其进行编辑，直到它不再出现为止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:11:44.900

感谢@RPM 的评论，我被指出了研究什么的正确方向。我在这个线程上找到了我的答案：

[Twitter Bootstrap CSS 影响谷歌地图](https://stackoverflow.com/questions/9141249/twitter-bootstrap-css-affecting-google-maps)

谢谢转！

# maven - Junit 由于 Aspect 而失败

> ID：14841648
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:38.630
> 
> 标签：maven, aspectj, compile-time, load-time-weaving, compile-time-weaving

我有一个基于注释的自定义安全框架。当遇到方法的安全注释时，我使用 aspectj maven 插件来编织方面。

我使用 jenkins 来构建项目，并且为编译设置了 aspectj maven 插件目标，如下所示。

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>aspectj-maven-plugin</artifactId>
            <version>1.4</version>
            <dependencies>
                <dependency>
                    <groupId>org.aspectj</groupId>
                    <artifactId>aspectjrt</artifactId>
                    <version>1.6.5</version>
                </dependency>
                <dependency>
                    <groupId>org.aspectj</groupId>
                    <artifactId>aspectjtools</artifactId>
                    <version>1.6.5</version>
                </dependency>
            </dependencies>
            <configuration>
                <showWeaveInfo>true</showWeaveInfo>
                <complianceLevel>1.6</complianceLevel>
                <!-- <weaveDirectories> <weaveDirectory>${project.build.directory}/classes</weaveDirectory> 
                    </weaveDirectories> -->
            </configuration>
            <executions>
                <execution>
                    <!-- Compile and weave aspects after all classes compiled by javac -->
                    <phase>process-classes</phase>
                    <goals>
                        <goal>compile</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

当junit运行时出现问题。由于它已经在方法中编织了与安全相关的注释，因此单元测试失败。

有没有办法让junits工作然后进行aspectj编织？由于我单独使用 .aj 文件，我不确定如何设置加载时间编织。

对此的任何帮助表示赞赏。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-10T18:30:37.463

我将我的 maven 目标重组为

干净编译测试aspectj：编译

所以在测试aspectj编织完成后，这就是我想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:36:22.587

我认为，您需要将测试编译添加到您的目标中。

```
<goals>
    <goal>compile</goal>
    <goal>test-compile</goal>
</goals> 
```

# compiler-construction - 如何管理编译器生成的代码中使用的堆栈？

> ID：14841649
> 
> 赞同：2
> 
> 时间：2013-02-12T20:55:41.480
> 
> 标签：compiler-construction, antlr

我正在开发一个为堆栈机器生成“类似汇编器”指令的编译器。（更准确地说，我以文本形式生成 Java 字节码指令，例如，我可以将其嵌入到一个文件中，然后我可以使用[Jasmin](http://jasmin.sourceforge.net "茉莉")将其编译为一个 java .class 文件）。我做这一切完全是为了教育目的。

假设以下类似 java 的表达式：

```
a = 1+2 
```

ANTLR 将生成一个看起来像这样的解析树：

```
 a=
           |
           |
           +
          / \
         /   \
        1     2 
```

走树后顺序给了我“1,2,+,a=”，我将其转换为：

```
lcd 1 // push integer 1 on top of stack
lcd 2 // push integer 2 on top of stack
iadd  // remove the top two numbers from stack, perform addition with those numbers, and push the result on stack
istore 0 // pop top element from stack and store it in variable space number zero. 
```

指令从一个空堆栈开始，最后堆栈又是……空的。这是我的编译器目前可以做的。它通过遍历 ANTLR 为我生成的语法树生成这些指令。

现在的问题：假设我有以下表达式：

```
a = b = 1+2 
```

甚至

```
callToSomeFunctionWhichReturnsAValue(); 
```

在第一个表达式中，生成了两个“istore”指令，都试图从堆栈中弹出一个值。第一个将成功，第二个找到一个空堆栈，一切都淹没了下水道。

另一方面，第二个示例将一个值添加到从不弹出的堆栈中。如果我碰巧在一个循环中这样做，我最终会得到一个堆栈溢出（我不是在谈论一个问答网站）。

解决方案当然是添加“dup”指令（复制堆栈顶部的项目）或“pop”指令（丢弃堆栈顶部的值）。但我怎么知道何时何地？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T04:15:55.000

如果不看一些语法，很难确切地知道要建议什么。我在这里对您所写的内容做出了一些假设，这些假设可能不正确。但是，我认为您遇到的问题很笼统，可以这样解决，即使我没有严格解决您的问题。如果不出意外，我希望提供的示例能够满足您的需求。

* * *

从左到右计算算术运算符。您似乎遇到的问题是正在从左到右评估`=`运算符，因为这是节点出现在 AST 中的顺序，也是您访问它们的顺序。`a = b = 1 + 2`

但是`=`操作数表达式是从右到左计算的。可以通过更改节点顺序使您的树表示这一点。但我认为更有意义的是改变 tree walker 以适应所需的评估顺序，同时保留 AST 中输入的自然顺序。

例如，假设您的 AST 如下所示：

```
 =
     / \
    a   =
       / \
      b   +
         / \
        1   2 
```

以正确的顺序评估运算符按以下步骤进行：

*   树步行者击中第一个`=`。它知道首先计算右侧，因此它跳过处理`a`。它继续到第二个孩子，`=`。
*   它击中了第二个`=`。它评估第二个孩子 ( `+`)，现在跳过`b`。
*   被`+`评估。现在`3`在堆栈上，它是堆栈上唯一的东西。
*   待处理的逻辑在最后一个子 ( ) 评估`=`后接管。被呼唤，被呼唤。在堆栈上。`+``dup``istore``b``3`
*   待处理的逻辑在最后一个子 ( ) 评估`=`后接管。被呼唤，被呼唤。在堆栈上。`=``dup``istore``a``3`
*   语句结束，因此`pop`被调用。堆栈现在是空的。

注意：在这个过程中，每条语句——无论它是否执行赋值——都应该以堆栈上的*一个且只有一个值结束。*只有语句的结尾才会弹出它。没有自然推送价值的表达式，例如对 的调用`void foo()`，仍然期望推送一些东西，即使它是`null`、`0`或某些保留`void`对象。确保不分配这些表达式是早期编译器阶段的工作。

下面是一个简短的示例令牌解析器和一个树解析器，以及一些测试输入和输出，演示了如何在 ANTLR (v3) 中完成此操作。为了简单起见，我使用了伪指令，并没有尝试优化输出。

### 有序.g

```
grammar Ordered;

options 
{
    output = AST; 
}

tokens {
 COMPUNIT;
 STAT;
 REFID;
}

compilationUnit : statement* EOF -> ^(COMPUNIT statement*);
statement: assign_expr SEMI -> ^(STAT assign_expr)
         | expr SEMI -> ^(STAT expr)
         ;
assign_expr: ID EQ^ (assign_expr | expr); //call recursively to keep the tree simple.
expr : add_expr;
add_expr : primary_expr (PLUS^ primary_expr)*;
primary_expr 
    : NUM 
    | (ID -> REFID[$ID.text]) //An ID expr is a reference to the thing named in ID. 
    | LPAR! expr RPAR!
    ;

SEMI: ';';
EQ : '=';
LPAR : '(';
RPAR : ')';
PLUS : '+';
ID : ('a'..'z'|'A'..'Z')+;
NUM: ('0'..'9')+;
WS : (' '|'\t'|'\f'|'\r'|'\n')+ {skip();}; 
```

### OrderedTreeParser.g

```
tree grammar OrderedTreeParser;

options { 
    output = AST;
    tokenVocab = Ordered;
    ASTLabelType = CommonTree;
    filter = true;
}

@members {
    private java.util.LinkedList<String> assigningIds = new java.util.LinkedList<String>(); 
}

topdown
    : enter_assign
    ;

enter_assign
    : ^(EQ ID {assigningIds.push($ID.getText());} .+) //Push our ID and handle assignment during bottomup.
    ;   

bottomup 
    : NUM {System.out.println("lcd " + $NUM.getText());}
    | EQ 
        {
            System.out.println("dup");
            System.out.println("istore " + assigningIds.pop());
        }
    | PLUS {System.out.println("iadd");}
    | REFID {System.out.println("iload " + $REFID.getText());}
    | STAT {System.out.println("pop");}
    ; 
```

### OrderedTest.java

```
import java.io.IOException;
import org.antlr.runtime.ANTLRStringStream;
import org.antlr.runtime.CharStream;
import org.antlr.runtime.CommonTokenStream;
import org.antlr.runtime.RecognitionException;
import org.antlr.runtime.tree.CommonTreeNodeStream;
import org.antlr.runtime.tree.Tree;

public class OrderedTest {
    public static void main(String[] args) throws Exception {

        test("a = 1;");
        test("a = 1 + 2;");
        test("a = b = 1 + 2;");
        test("a = b = 1 + c;");
        test("x = y = z = 1 + 2;");
        test("1 + 2;"); //no assignment
    }

    private static void test(String str) throws RecognitionException, Exception, IOException {
        CharStream input = new ANTLRStringStream(str);
        OrderedLexer lexer = new OrderedLexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);

        OrderedParser parser = new OrderedParser(tokens);

        OrderedParser.compilationUnit_return result = parser.compilationUnit();

        if (lexer.getNumberOfSyntaxErrors() > 0 || parser.getNumberOfSyntaxErrors() > 0){
            throw new Exception("Syntax Errors encountered!");
        }

        OrderedTreeParser tparser = new OrderedTreeParser(new CommonTreeNodeStream(result.getTree()));
        tparser.downup(result.getTree());
        System.out.println("---------");
    }

} 
```

### 测试用例

**输入**

```
a = 1; 
```

**输出**

```
lcd 1
dup
istore a
pop 
```

**输入**

```
a = 1 + 2; 
```

**输出**

```
lcd 1
lcd 2
iadd
dup
istore a
pop 
```

**输入**

```
a = b = 1 + 2; 
```

**输出**

```
lcd 1
lcd 2
iadd
dup
istore b
dup
istore a
pop 
```

**输入**

```
a = b = 1 + c; 
```

**输出**

```
lcd 1
iload c
iadd
dup
istore b
dup
istore a
pop 
```

**输入**

```
x = y = z = 1 + 2; 
```

**输出**

```
lcd 1
lcd 2
iadd
dup
istore z
dup
istore y
dup
istore x
pop 
```

**输入**

```
1 + 2; 
```

**输出**

```
lcd 1
lcd 2
iadd
pop 
```

# android - 机器人和安卓注解

> ID：14841651
> 
> 赞同：1
> 
> 时间：2013-02-12T20:55:46.467
> 
> 标签：android, android-annotations

我正在尝试测试一个活动，包括来自 android-annotations 2.7 的注释，如 @EActivity、@ViewById 等。由于 NoClassDefFoundError，每个测试都失败了。有没有人有一个工作示例如何将 Robotium 与 A​​ndroid 注释相结合？这是我的测试用例：

```
package de.abc.view;

import android.test.ActivityInstrumentationTestCase2;
import android.widget.Button;

import com.jayway.android.robotium.solo.Solo;

import de.abc.R;

public class WorktimeActivityTest extends ActivityInstrumentationTestCase2<WorktimeActivity_>{

    private Solo solo;

    public WorktimeActivityTest() {
        super(WorktimeActivity_.class);
    }

    public void setUp() throws Exception{
        solo = new Solo(getInstrumentation(), getActivity());
    }

    public void testSelectWorkday() {
        Button button = (Button) solo.getView(R.id.selectWorkday);
        solo.clickOnView(button);
    }

    @Override
    public void tearDown() throws Exception{
        solo.finishOpenedActivities();
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T16:57:33.303

我发现了我的错误。找不到的类未包含在构建路径中。所以我不得不改变我的构建路径并包含来自android-annotations的生成源......愚蠢的错误......

# python - 字符串替换组合

> ID：14841652
> 
> 赞同：4
> 
> 时间：2013-02-12T20:55:48.843
> 
> 标签：python, string, combinations

所以我有一个字符串'1xxx1'，我想用一个字符替换一定数量（可能全部都没有）的x，比如说'5'。我想要字符串的所有可能组合（...可能是排列），其中 x 被替换或保留为 x。我希望将这些结果存储在列表中。

所以想要的结果是

```
>>> myList = GenerateCombinations('1xxx1', '5')
>>> print myList
['1xxx1','15xx1','155x1','15551','1x5x1','1x551','1xx51'] 
```

显然，我希望它能够处理任意长度的字符串和任意数量的 x，以及能够替换任意数字。我尝试使用循环和递归来解决这个问题，但无济于事。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-12T21:03:24.407

怎么样：

```
from itertools import product

def filler(word, from_char, to_char):
    options = [(c,) if c != from_char else (from_char, to_char) for c in word]
    return (''.join(o) for o in product(*options)) 
```

这使

```
>>> filler("1xxx1", "x", "5")
<generator object <genexpr> at 0x8fa798c>
>>> list(filler("1xxx1", "x", "5"))
['1xxx1', '1xx51', '1x5x1', '1x551', '15xx1', '15x51', '155x1', '15551'] 
```

（请注意，您似乎错过了`15x51`。）基本上，首先我们为源单词中的每个字母列出每个可能的目标：

```
>>> word = '1xxx1'
>>> from_char = 'x'
>>> to_char = '5'
>>> [(c,) if c != from_char else (from_char, to_char) for c in word]
[('1',), ('x', '5'), ('x', '5'), ('x', '5'), ('1',)] 
```

然后我们使用`itertools.product`得到这些可能性的笛卡尔积并将结果连接在一起。

对于奖励积分，修改以接受替换字典。:^)

# wpf - 将自定义样式添加到 WPF 中现有主题中的元素

> ID：14841653
> 
> 赞同：0
> 
> 时间：2013-02-12T20:55:56.123
> 
> 标签：wpf, xaml

我不认为以前有人问过这个问题，如果有，请重定向我。我是 WPF 的新手，我已经尝试了我能想到的一切，但没有成功，我被困住了。

我正在使用**WPF Theme**，我想添加一些我创建的**自定义样式。**例如，所有人`TextBlock`都应该有*Red*前景，但我有一组`TextBlock`我想要的*Blue*。

到目前为止，我一直在 xaml 中执行此操作，`<Style></Style>`在**资源**中创建一个，并使用`Style="{StaticResource StyleName}"`. 但是我想将它添加到主题文件中，并且我不知道如何给它命名并从 xaml 中调用它。

我想我会从这样的东西开始，但是我如何链接这两个元素呢？

在主题文件（MyStyles.xaml 或 TextEdit.xaml 或类似文件）中：

```
<Style TargetType="{x:Type TextBlock}" x:Key="KeyName" ???>
      <Setter Property="Foreground" Value="Blue" />
</Style> 
```

然后在**我的**xaml 中：

```
<TextBlock Name="TextBlockName"
      Style="{???}">
</TextBlock> 
```

我需要将这种样式放在主题中，因为程序将允许用户更改主题，并且这些样式不能硬编码在 xaml 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:16:43.180

如果您已经加载了主题文件，您可以像访问本地样式/资源一样访问任何样式/资源

如果您使用`Style="{StaticResource StyleName}"`它，它将首先在 Window/UserControl 中查找，如果没有找到，它将通过加载的资源字典查找。因此，只要您加载了主题（资源字典），它就可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:22:53.103

您想首先将该资源文件合并到您的资源中：

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="MyStyles.xaml" />
        </ResourceDictionary.MergedDictionaries>
        <dxc:IntToBooleanConverter x:Key="IntToBooleanConverter" />
        (...)
    </ResourceDictionary>
</UserControl.Resources> 
```

然后你可以使用它

```
<TextBlock Name="TextBlockName" Style="{StaticResource KeyName}" /> 
```

# post - 为什么 GM_xmlhttpRequest 忽略它的 data 参数？

> ID：14841656
> 
> 赞同：1
> 
> 时间：2013-02-12T20:56:00.553
> 
> 标签：post, greasemonkey, gm-xmlhttprequest

根据[其文档](http://wiki.greasespot.net/GM_xmlhttpRequest)，`GM_xmlhttpRequest`应该能够将`data`参数作为其参数的一部分。

但是，我似乎无法让它工作。

我有一个简单的服务器来回显给它的参数：

```
require 'sinatra'
require 'json'
get '/' do
  JSON.dump params
end
post '/' do
  JSON.dump params
end 
```

还有一个简单的greasemonkey 脚本，它只是尝试将一些数据发布到服务器。它尝试将数据作为 URL 中的查询参数和 postdata 传递：

```
// ==UserScript==
// @name        PostDataTest
// @namespace   Test
// @description Simple test of GM_xmlhttpRequest's data parameter
// @include     http://localhost:4567/
// @version     1
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js
// @grant       metadata
// @grant       GM_xmlhttpRequest
// ==/UserScript==

var url = '/?q0=0&q1=1';
var data = 'd0=0&d1=1'

GM_xmlhttpRequest({ method: 'POST', url: url, data: data, onload: function(r){
  console.log('gm:' + r.responseText);
}});
$.post(url, data, function(d,s,r){
  console.log('jq:' + r.responseText);
}); 
```

当我使用 jQuery 发布 postdata 时，它工作正常，但我使用的任何 postdata 都会`GM_xmlhttpRequest`被忽略：

```
jq:{"q0":"0","q1":"1","d0":"0","d1":"1"}
gm:{"q0":"0","q1":"1"} 
```

这让我相信这`GM_xmlhttpRequest`实际上并没有使用`data`我给它的参数。（我不确定 b/c 我无法`GM_xmlhttpRequest`在 Firebug 中监控网络活动）。

这里发生了什么？我搞砸了什么吗？API是否发生了变化？如何`GM_xmlhttpRequest`在不将数据打包到 URL 的情况下发布数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:19:55.590

好的，我使用[TamperData firefox 插件](https://addons.mozilla.org/en-us/firefox/addon/tamper-data/)来监控我的`GM_xmlhttpRequests`（发送 postdata 的），看看他们做了什么不同的事情。

不同的是四个标题。jQuery 发送到哪里

```
Accept:             */*
Content-Type:       application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With:   XMLHttpRequest
Referer:            http://localhost:4567/ 
```

`GM_xmlhttpRequest`发送：

```
Accept:             text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Content-Type:       text/plain; charset=UTF-8 
```

使用该`headers:`参数，我可以指定`Content-Type`my 的`GM_xmlhttpRequest`，从而使其工作。

```
// ==UserScript==
// @name        PostDataTest
// @namespace   Test
// @description Simple test of GM_xmlhttpRequest's data parameter
// @include     http://localhost:4567/
// @version     1
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js
// @grant       metadata
// @grant       GM_xmlhttpRequest
// ==/UserScript==

var url = '/?q0=0&q1=1';
var data = 'd0=0&d1=1'

GM_xmlhttpRequest({
  method: 'POST',
  url: url+'gm',
  data: data+'gm',
  headers: { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' },
  onload: function(r){
    console.log('gm:' + r.responseText);
}});
$.post(url+'jq', data+'jq', function(d,s,r){
  console.log('jq:' + r.responseText);
}); 
```

# ruby-on-rails - 每当不运行方法都可以

> ID：14841657
> 
> 赞同：0
> 
> 时间：2013-02-12T20:56:03.093
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cron, whenever

我需要每分钟发出一个 XML 请求，然后将数据存储在一个`Medida`对象中。每个`Meter`对象都有许多`Medidas`（测量值）。

```
class Meter < ActiveRecord::Base

  has_one :user_type
  has_one :user
  has_many :medidas
  attr_accessible :user_type_id, :user_id, :address, :etc

  def read_data
      u = User.find(self.user_id)
      Medida.get_data(self.address,u.user_key, self.id) 
  end

  class << self
    def all_read_data
      meters = Meter.all
      meters.each do |meter|
        meter.read_data
      end  
    end
  end
end 
```

Medidas.rb 看起来像

```
class Medida < ActiveRecord::Base
  belongs_to :meter
  attr_accessible  :some_attr

  class << self
    def get_data(address,user_key, meter_id)
      url="some_url_with#{variables}.xml?#{a_key}"

      response = HTTParty.get(url)

      hash = Hash.from_xml(response.to_s)
      hash = Medida.some_funct(hash)
      data = hash["ekmMeterReads"]["meter"]["read"]

      #Save hash to bd
    end
    #def some_funct
  end
end 
```

我正在为此使用任何时候。这就是我的`schedule.rb`样子

```
set :output, "#{path}/log/cron.log"

every 1.minutes do
    runner "Meter.all_read_data, :environment => 'development'
end 
```

问题是实际上只有一个仪表每分钟获取数据，而其他所有仪表都没有。[这是](http://pastebin.com/ieRZHRrd)我的内容`cron.log`（它有问题，但我未能找到有关它的有用信息。）

我错过了什么？感谢您的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T13:27:22.943

我知道了。给我打电话的网址是错误的。现在一切顺利。

如果您依赖其他人的信息（如代码、密钥、网址），请务必对这些信息格外好奇。比花一天时间去做你不应该做的事情要好得多。

# python - 在 Python 中查找运行时间

> ID：14841665
> 
> 赞同：0
> 
> 时间：2013-02-12T20:56:36.400
> 
> 标签：python, finance, timeit

我有以下完美的代码：

```
 from __future__ import division
    from math import log, sqrt
    from scipy.stats import norm
    from datetime import datetime

    #Default values used for testing
    s1 = 10; s2 = 20
    sigma1 = 1.25; sigma2 = 1.45
    t = 0.5; rho = 0.89
    rate=0.05; y=0; k0 = 0.000001

    sigma = lambda sig1=sigma1, sig2=sigma2, corr=rho: sqrt(sig1**2+sig2**2 -2*corr*sig1*sig2)
    m_d1 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: (log(stock1/stock2)+1/2*sigma()**2*time)/(sigma()*sqrt(time))
    m_d2 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: m_d1() -sigma()*sqrt(time)
    m_delta1 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: norm.cdf(m_d1())
    m_delta2 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: -norm.cdf(m_d2())
    m_gamma11 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: norm.pdf(m_d1())/(stock1*sigma()*sqrt(time))
    m_gamma22 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: norm.pdf(m_d2())/(stock2*sigma()*sqrt(time))
    m_gamma12 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho:-norm.pdf(m_d1())/(stock2*sigma()*sqrt(time))
    m_theta = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: -stock1*sigma()*norm.pdf(m_d1())/(2*sqrt(time))
    m_vega1 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: stock1*sqrt(t)*norm.pdf(m_d1())*((sig1-(corr*sig2))/sigma())
    m_vega2 = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: stock1*sqrt(t)*norm.pdf(m_d1())*((sig2-(corr*sig1))/sigma()) 
    m_correlation = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: -stock1*sqrt(t)*norm.pdf(m_d1())*((sig1*sig2)/sigma()) 
    m_margrabe = lambda stock1=s1, stock2=s2, sig1=sigma1, sig2=sigma2, time=t, corr=rho: stock1*norm.cdf(m_d1())-stock2*norm.cdf(m_d2())

    print "Margrabe = "+str(m_margrabe()) + "\n"
    print "THE GREEKS \n"
    print "Delta Asset 1 = "+str(m_delta1())
    print "Delta Stock 2 = "+str(m_delta2()) +"\n"
    print "Gamma Asset 11 = "+str(m_gamma11())
    print "Gamma Stock 12 = "+str(m_gamma12())
    print "Gamma Stock 22 = "+str(m_gamma22()) + "\n"
    print "Theta = "+str(m_theta()) +"\n"
    print "Vega sigma 1 = "+str(m_vega1())
    print "Vega sigma 2 = "+str(m_vega2()) + "\n"
    print "Correlation = "+str(m_correlation()) + "\n" 
```

它工作得很好，但现在我想看看我的电脑运行这个程序需要多长时间。因此，在谷歌搜索问题后，我发现了 2 个替代方案：

1) 从 timeit 导入 Timer 。在我打印结果的部分，我添加了：

```
 print "Margrabe = "+str(m_margrabe()) +"\n"
    t1 = Timer(lambda: m_margrabe()).timeit(number=1)
    print "THE GREEKS \n"
    print "Delta Asset 1 = "+str(m_delta1())
    t2 = Timer(lambda: m_delta1()).timeit(number=1)
    print "Delta Stock 2 = "+str(m_delta2()) +"\n"
    t3 = Timer(lambda: m_delta2()).timeit(number=1)
    print "Gamma Asset 11 = "+str(m_gamma11())
    t4 = Timer(lambda: m_gamma11()).timeit(number=1)
    print "Gamma Stock 12 = "+str(m_gamma12())
    t5 = Timer(lambda: m_gamma12()).timeit(number=1)
    print "Gamma Stock 22 = "+str(m_gamma22()) +"\n"
    t6 = Timer(lambda: m_gamma22()).timeit(number=1)
    print "Theta = "+str(m_theta()) + "\n"
    t7 = Timer(lambda: m_theta()).timeit(number=1)
    print "Vega sigma 1 = "+str(m_vega1())
    t8 = Timer(lambda: m_vega1()).timeit(number=1)
    print "Vega sigma 2 = "+str(m_vega2()) +"\n"
    t9 = Timer(lambda: m_vega2()).timeit(number=1)
    print "Correlation = "+str(m_correlation()) + "\n"
    t10 = Timer(lambda: m_correlation()).timeit(number=1)
    print "Running Time = " + str(t1+t2+t3+t4+t5+t6+t7+t8+t9+t10) 
```

这很好用：我得到**Running Time = 0.00682769470029**

2）从日期时间导入日期时间和：

```
 startTime = datetime.now()
    # Same code as before"
    print(datetime.now()-startTime) 
```

这也可以正常工作，我得到：**0：00：00.010000**

我的问题是：为什么两种方法不同？为什么我会得到不同的结果？有没有办法在一行中“计算运行时间”？

谢谢

更新：

```
 def printit():  
        print "Margrabe = "+str(m_margrabe()) + "\n"
        print "THE GREEKS \n"
        print "Delta Asset 1 = "+str(m_delta1())
        print "Delta Stock 2 = "+str(m_delta2()) +"\n"
        print "Gamma Asset 11 = "+str(m_gamma11())
        print "Gamma Stock 12 = "+str(m_gamma12())
        print "Gamma Stock 22 = "+str(m_gamma22()) + "\n"
        print "Theta = "+str(m_theta()) +"\n"
        print "Vega sigma 1 = "+str(m_vega1())
        print "Vega sigma 2 = "+str(m_vega2()) + "\n"
        print "Correlation = "+str(m_correlation()) + "\n"

    if __name__=='__main__':
        printit() 
```

所以我可以输入（我的文件保存为 time1.py）

```
 python -m timeit -s "import time1; time1.main()" 
```

但我收到一个错误：“属性错误：‘模块’对象没有属性‘主’

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:01:31.020

您无需检测或更改程序中的任何内容即可对其进行测量。从命令行，

```
python -m timeit -s "import mymodule; mymodule.main()" 
```

会告诉你模块的运行时间`main()`。修改语句以准确衡量您的需求。

timeit 和 datetime 的结果之间的差异可能是由于 datetime 支持的精度低，但它应该具有微秒精度，所以我不能肯定地说。无论如何，timeit 是手头工作的正确工具。

# jquery - 如果在页面上选中多个，则隐藏/显示

> ID：14841670
> 
> 赞同：0
> 
> 时间：2013-02-12T20:56:52.273
> 
> 标签：jquery

我有 2 个是/否复选框。复选框将根据选中的复选框隐藏一个 div。我有一个使用选择器 ID 工作的函数，但是我将动态引入其中的多个，并且需要此函数使用类来选择与单击的复选框最接近的类。

此函数使用 ID，但我想使用类：http: [//jsfiddle.net/infatti/mNQK7/](http://jsfiddle.net/infatti/mNQK7/)

```
$('#solutionImplemented1').click(function () {
    // uncheck the other checkbox and hide other content if this is checked
    if (this.checked) {
        $('#solutionImplemented2').attr('checked',false);
        $('#solutionImplementedContent2').hide(this.checked);
    }
    // show correct content
    $('#solutionImplementedContent1').toggle(this.checked);
});
$('#solutionImplemented2').click(function () {
    // uncheck the other checkbox and hide other content if this is checked
    if (this.checked) {
        $('#solutionImplemented1').attr('checked',false);
        $('#solutionImplementedContent1').hide(this.checked);
    }
    // show correct content
    $('#solutionImplementedContent2').toggle(this.checked);
}); 
```

这不起作用，但需要使用与单击的复选框相关的选择器：http: [//jsfiddle.net/infatti/n6gW5/](http://jsfiddle.net/infatti/n6gW5/)

```
$('.check-hide-show input:checkbox').click(function () {

    var firstCheckbox = $(this).parent().find('input:checkbox').eq(0);
    var secondCheckbox = $(this).parent().find('input:checkbox').eq(1);
    var checkboxContent1 = $(this).parent().find().nextAll('.check-hide-show-content:gt(0)');
    var checkboxContent2 = $(this).parent().find().nextAll('.check-hide-show-content:gt(1)');

    // uncheck the other checkbox and hide other content if this is checked
    if ($(firstCheckbox).checked) {
        $(secondCheckbox).attr('checked',false);
        $(checkboxContent2).hide();
        $(checkboxContent1).show();
    }

}); 
```

如何选择与单击的复选框相关的元素？我在这里没有做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:10:54.373

你会发现这种方法非常难以维护。想象一下如果你有 50 个复选框会发生什么；50 条带有 50 行`.hide()`和`.show()`?的 if 语句 我建议将每个复选框链接到它的`div`，也许是通过一个`name=`属性。

然后，你可以这样做：

```
<input type='checkbox' name='check-div1' />
<input type='checkbox' name='check-div2' />
<input type='checkbox' name='check-div3' />

<div class='check-hide-show-content' name='div-div1'> ... </div>
<div class='check-hide-show-content' name='div-div2'> ... </div>
<div class='check-hide-show-content' name='div-div3'> ... </div> 
```

然后，在您的代码中：

```
$('.check-hide-show input:checkbox').click(function () {
    var divName = $(this).attr("name").substring(6); // Shave "check-" off the start
    var $targetDiv = $("div[name='div-" + divName + "']");
    $("div.check-hide-show-content").hide();
    $targetDiv.show();
}); 
```

由于 jsFiddle 目前不适合我，这里有一个[**关于 jsBin 的例子**](http://jsbin.com/ejogit/1/edit)。请注意，如果您同时选中两个复选框，它将仅使用最新选中的一个。您可以通过添加以下内容来规避它：

```
$(".check-hide-show input[type='checkbox']").not(this).prop("checked", false); 
```

*（更新：这里是[**jsFiddle**](http://jsfiddle.net/n6gW5/17/)。）*

# actionscript-3 - 哪个手风琴孩子被选中了？

> ID：14841673
> 
> 赞同：0
> 
> 时间：2013-02-12T20:56:58.207
> 
> 标签：actionscript-3, apache-flex

有没有办法通过 Accordion headerRenderer 发现选择了哪个孩子？

我正在使用来自 flexlib 的 CanvasButtonAccordionHeader，我只想在 selectedChild 的标题中显示一个组件。

感谢您提供任何有用的提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T13:43:48.947

您可以使用定义内联`headerRenderer`并使用该`outerDocument`属性。这是一个例子：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600" xmlns:ns="http://code.google.com/p/flexlib/">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>

    <mx:Accordion id="acc" width="400" height="400" headerHeight="40">
        <mx:headerRenderer>
            <fx:Component>
                <ns:CanvasButtonAccordionHeader label="{'selected ' +outerDocument.acc.selectedChild.label}">   
                </ns:CanvasButtonAccordionHeader>
            </fx:Component>
        </mx:headerRenderer>
        <mx:Canvas   label="Personal"  toolTip="Child number one">
            <mx:Label text="Contents of Child 1" />
        </mx:Canvas>
        <mx:Canvas label="Accounts" toolTip="Child number two">
            <mx:Label text="Contents of Child 2" />
        </mx:Canvas>
        <mx:Canvas label="Help" toolTip="Child number three">
            <mx:Label text="Contents of Child 3" />
        </mx:Canvas>
    </mx:Accordion>
</s:Application> 
```

戴维德

# binding - Windows Phone 绑定

> ID：14841677
> 
> 赞同：0
> 
> 时间：2013-02-12T20:57:25.643
> 
> 标签：binding, windows-phone

在我的 RoomView.xaml 中，我有：

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <ListBox ItemsSource="{Binding myStrings, Mode=TwoWay}"></ListBox>
</Grid> 
```

在我的构造函数中，我正在做：

```
 var myStrings = new List<string>{"Usmaan","Carl","Andy","Saul"};
 DataContext = myStrings; 
```

然而，当我加载应用程序时，页面上没有任何内容被吐出。

任何人都可以看到我要去哪里可怕的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:25:08.430

您的页面的 DataContext 已经设置为`List`对象，因此您只需像这样设置绑定：

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <ListBox ItemsSource="{Binding, Mode=TwoWay}"></ListBox>
</Grid> 
```

或者，您可以创建一个具有`MyStrings`属性的对象并将其用作页面的 DataContext。然后你可以`ListBox`像你所做的那样绑定，`{Binding myStrings, Mode=TwoWay}`同时还可以将其他控件绑定到该对象的其他属性（这就是 ViewModel 的原理）。

# android - 同时将一个动画应用于多个视图

> ID：14841679
> 
> 赞同：25
> 
> 时间：2013-02-12T20:57:27.047
> 
> 标签：android, rotation, image-rotation

所以我想同时旋转几个视图，都使用相同的旋转规范。问题是由于某种原因，第二个元素的旋转作用不同。显然，这与动画对象在这两行代码之间实际改变状态有关。显然我可以创建一个单独的动画对象并应用它，但我觉得有一种更简单的方法（我有大约 15 个视图）

仅正确旋转第一个视图：

```
Animation rotateAnim = AnimationUtils.loadAnimation(this, R.anim.rotationtoportrait);
target.startAnimation(rotateAnim);
lightBtn.startAnimation(rotateAnim); 
```

正确旋转两者

```
Animation rotateAnim = AnimationUtils.loadAnimation(this, R.anim.rotationtoportrait);
Animation rotateAnim2 = AnimationUtils.loadAnimation(this, R.anim.rotationtoportrait);
target.startAnimation(rotateAnim);
lightBtn.startAnimation(rotateAnim2); 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<rotate
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:fromDegrees="-90"
    android:toDegrees="0"
    android:pivotX="50%"
    android:pivotY="50%"
    android:duration="500" android:fillAfter="true"> 
```

有人有想法么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T21:55:08.017

像这样做：

```
ObjectAnimator anim = ObjectAnimator.ofFloat(view, "y", 100f);
arrayListObjectAnimators.add(anim);

ObjectAnimator anim1 = ObjectAnimator.ofFloat(view, "x", 0f);
arrayListObjectAnimators.add(anim1);

ObjectAnimator[] objectAnimators = arrayListObjectAnimators.toArray(new ObjectAnimator[arrayListObjectAnimators.size()]);
AnimatorSet animSetXY = new AnimatorSet();
animSetXY.playTogether(objectAnimators);
animSetXY.duration(1000);
animSetXY.start(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T21:48:02.967

所以我想这是不可能的，所以我创建了一个辅助方法来将相同的动画应用于视图列表：

```
public void doRotations(ArrayList<View> views, int start, int end, int xprop, float xscale, int yprop, float yscale, int duration, Boolean fillAfter){

    for(int i = 0; i < views.size(); i++){
        RotateAnimation temp = new RotateAnimation(start, end, xprop, xscale, yprop, yscale);
        temp.setDuration(duration);
        temp.setFillAfter(fillAfter);
        views.get(i).startAnimation(temp);
    }
} 
```

绝对是一个黑客，但我想这就是我现在能做的一切

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-29T03:55:18.050

[通过以编程方式创建一个AnimatorSet](https://developer.android.com/reference/android/animation/AnimatorSet)，我能够在 Kotlin 中做到这一点。
1\. 创建一个你想要动画的视图的 ArrayList

```
 var viewList = arrayListOf(view1,view2,view3) 
```

2.遍历ArrayList，创建一个不断增长的AnimatorSet

```
var ix = 0
var anim = AnimatorSet()
var viewList = arrayListOf(view1,view2,view3)
        viewList.forEach{
        // Initiate the animator set with one ObjectAnimator
            if(ix == 0){
                anim = AnimatorSet().apply {
                    play(ObjectAnimator.ofFloat(it, "rotation", 0F, 360F))
                }
            }
        // Add one ObjectAnimator at a time to the growing AnimatorSet
            else{
                var currentAnim = ObjectAnimator.ofFloat(it,"rotation",0F,360F)
                anim = AnimatorSet().apply {
                    play(anim).with(currentAnim)
                }
            }
            ix++
        } 
```

3.开始动画

```
button.setOnClickListener {
            AnimatorSet().apply {
                play(anim)
                start()
            } 
```

# opencv - 相机校准opencv

> ID：14841683
> 
> 赞同：4
> 
> 时间：2013-02-12T20:57:33.890
> 
> 标签：opencv, camera, camera-calibration

嗨，我正在做一个项目来进行图像 3d 重建。我是校准相机的阶段，这需要很长时间才能完成。但是当我编译代码并在相机前显示棋盘格时，它直接进入未处理的异常错误。

当图片不在框架中时，一旦进入框架就没有错误，出现未处理的错误，我不知道为什么。

我问了很多人，似乎没有人能帮上忙。

这是我的代码

```
#include <cv.h>
#include <highgui.h>
#include <vector>
#include <stdlib.h>
#include <stdio.h>

using namespace cv;
using namespace std;

int main()
{
    int numBoards = 0;
    int numCornersHor;
    int numCornersVer;

    printf("Enter number of corners along width: ");
    scanf("%d", &numCornersHor);

    printf("Enter number of corners along height: ");
    scanf("%d", &numCornersVer);

    printf("Enter number of boards: ");
    scanf("%d", &numBoards);

    int numSquares = numCornersHor * numCornersVer;
    Size board_sz = Size(numCornersHor, numCornersVer);
    VideoCapture capture = VideoCapture(0);

    vector<vector<Point3d>> object_points;
    vector<vector<Point2d>> image_points;

    vector<Point2d> corners;
    int successes=0;

    Mat image;
    Mat gray_image;
    capture >> image;

    vector<Point3d> obj;
    for(int j=0;j<numSquares;j++)
        obj.push_back(Point3d(j/numCornersHor, j%numCornersHor, 0.0f));

    while(successes<numBoards)
    {
        cvtColor(image, gray_image, CV_BGR2GRAY);

        bool found = findChessboardCorners(image, board_sz, corners, CV_CALIB_CB_ADAPTIVE_THRESH | CV_CALIB_CB_FILTER_QUADS);

        if(found)
        {
            cornerSubPix(gray_image, corners, Size(11, 11), Size(-1, -1), TermCriteria(CV_TERMCRIT_EPS | CV_TERMCRIT_ITER, 30, 0.1));
            drawChessboardCorners(gray_image, board_sz, corners, found);
        }

        imshow("win1", image);
        imshow("win2", gray_image);

        capture >> image;

        int key = waitKey(1);

        if(key==27)
            return 0;

        if(key==' ' && found!=0)
        {
            image_points.push_back(corners);
            object_points.push_back(obj);
            printf("Snap stored!\n");

            successes++;

            if(successes>=numBoards)
                break;
        }
    }

    Mat intrinsic = Mat(3, 3, CV_32FC1);
    Mat distCoeffs;
    vector<Mat> rvecs;
    vector<Mat> tvecs;

    intrinsic.ptr<float>(0)[0] = 1;
    intrinsic.ptr<float>(1)[1] = 1;

    calibrateCamera(object_points, image_points, image.size(), intrinsic, distCoeffs, rvecs, tvecs);

    Mat imageUndistorted;
    while(1)
    {
        capture >> image;
        undistort(image, imageUndistorted, intrinsic, distCoeffs);

        imshow("win1", image);
        imshow("win2", imageUndistorted);

        waitKey(1);
    }

    capture.release();

    return 0;
} 
```

我在控制台上遇到的错误是

OpenCV 错误：未知函数文件中的断言失败（ncorners >=0 && corners.depth() == CV_32F），文件.....\src\opencv\modules\imgproc\src\cornersubpix.cpp，第 257 行。

错误对话框说

basiccalibration.exe 中 0x769afc16 处未处理的异常：Microsoft C++ 异常：cv::Exception at memory location 0x0021f51c..

帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T09:26:56.540

使用 Point2f 和 Point3f 而不是 Point2d 和 Point3d。请阅读断言文本。它需要一个 CV_32F 深度结构。

# ios - OpenCV 2.4.4 和 Tesseract 3.02.02 不要链接在一起

> ID：14841685
> 
> 赞同：5
> 
> 时间：2013-02-12T20:57:35.797
> 
> 标签：ios, objective-c, opencv, tesseract

我正在使用 iOS 6.1 和 XCode 4.6

我有一个问题，OpenCV 需要用 libc++ (LLVM C++ 11) 编译，而 Tesseract 3.02.03 需要用“默认编译器”编译。

我该如何克服这个问题。此时我只能在注释掉 OpenCV 代码或注释掉 OCR 代码的情况下编译和链接。不能让他们一起工作。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T15:55:48.220

我绝不是 C++ 专家，但我遇到了同样的问题，经过反复试验和大量互联网搜索，我想我设法解决了它。

据我了解，问题在于 opencv 和 tesseract 是用不同的标准库构建的。最新的 opencv 是用 libc++ 构建的，而 tesseract 是用 stdlibc++ 构建的

解决方案是重建其中一个，以便它们都使用相同的标准库。我决定重新编译 tesseract 并按照[此处](http://tinsuke.wordpress.com/2011/11/01/how-to-compile-and-use-tesseract-3-01-on-ios-sdk-5/%20here)找到的说明进行操作，该说明引用了用于构建库的[构建脚本。](https://dl.dropbox.com/u/1745859/Blog/tesseract/ios60_tesseract302_leptonica_169/build_dependencies.sh)

我修改了这个脚本（同样，通过试错，不太确定这是最好的方法）以使用 clang++ 编译器（`CXX="/usr/bin/clang++"`）并使用 libc++（`CXXFLAGS="$CFLAGS -stdlib=libc++"`）并编译（尽管有一些警告）。您可能还需要复制一些标头，因为脚本似乎并未将它们全部复制。

然后在你的 iOS 项目中使用这个库而不是下载的库（记得在构建设置中改回 libc++），一切都会编译和链接得很好。

到目前为止，它似乎在运行时正常工作。

# forms - Drupal7 自定义表单提交处理程序不起作用

> ID：14841686
> 
> 赞同：1
> 
> 时间：2013-02-12T20:57:39.130
> 
> 标签：forms, drupal-7

我正在编写一个具有表单但提交处理程序不起作用的自定义模块，表单只是提交回自身？非常感谢任何帮助。

我有一个添加来宾自定义表单，并且工作正常。

我网站上的 URL 是：/user/booking_editguest/LBD0413/1 代码如下：

```
function uUserBookings_editGuestForm($form, &$form_state, $ManageBooking) {
//var_dump($ManageBooking);
$guestSeq = arg(3);
$masterEventCode = $ManageBooking->Contact->{'MasterEventCode'};
$eventCode = $ManageBooking->Contact->{'EventCode'};
$attendeeContact = $ManageBooking->Contact->{'AttendeeContact'};
global $user;
$account = user_load($user->uid);
$memberCode = $account->name;

// booking
$form['booking'] = array(
    //'#type' => 'vertical_tabs',
);

foreach($ManageBooking->guests as $Guest)
    {
    if ($guestSeq == $Guest->{'GuestSeq'} )
        {
            $form['guest_form']['FirstName'] = array(
                '#required' => TRUE,
                '#type' => 'textfield',
                '#title' => t('GUEST FIRST NAME'),
                '#default_value' => $Guest->{'Guest FirstName'}
            );

            $form['guest_form']['Surname'] = array(
                '#required' => TRUE,
                '#type' => 'textfield',
                '#title' => t('GUEST LAST NAME'),
                '#default_value' => $Guest->{'Guest Surname'}
            );

            $form['guest_form']['DietaryRequirements'] = array(
                '#required' => FALSE,
                '#type' => 'textfield',
                '#title' => t('SPECIAL DIETARY REQUIREMENTS'),
                '#default_value' => $Guest->{'Dietary Requirements'}
            );

            $form['guest_form']['CompanyName'] = array(
                '#required' => TRUE,
                '#type' => 'textfield',
                '#title' => t('GUEST COMPANY NAME'),
                '#default_value' => $Guest->{'Company Name'}
            );

            $form['guest_form']['Position'] = array(
                '#required' => TRUE,
                '#type' => 'textfield',
                '#title' => t('GUEST POSITION'),
                '#default_value' => $Guest->{'Attendee Position'}
            );

            $form['guest_form']['Email'] = array(
                '#required' => TRUE,
                '#type' => 'textfield',
                '#title' => t('GUEST EMAIL'),
                '#default_value' => $Guest->{'Guest Email'}
            );

            //MasterEventCode
            $form['guest_form']['masterEventCode'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $masterEventCode
            );
            //EventCode
            $form['guest_form']['eventCode'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $eventCode
            );
            //Member_code
            $form['guest_form']['memberCode'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $memberCode
            );
            //Attendee_Contact
            $form['guest_form']['Attendee_Contact'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $attendeeContact
            );
            //GuestSeq
            $form['guest_form']['GuestSeq'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $Guest->{'GuestSeq'}
            );
            //GuestID
            $form['guest_form']['GuestID'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $Guest->{'Guest Contact Counter'}
            );
            //EventNameDetailsID uniqueidentifier
            $form['guest_form']['EventNameDetailsID'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $Guest->{'EventNameDetailsID'}
            );

            //ID uniqueidentifier
            $form['guest_form']['ID'] = array(
                '#required' => TRUE,
                '#type' => 'hidden',
                '#default_value' => $Guest->{'ID'}
            );

            $form['guest_form']['Submit'] = array(
                '#type' => 'submit',
                '#value' => t('Submit'),
                '#submit' => array('tmsUserBookings_editGuestForm_submit')
            );
        }
    }
return $form;}

function userBookings_editGuestForm_validate($form, &$form_state) {
// Validation logic.
// Don't custom-validate if previous validation errors (still) exist
if (form_get_errors()) return;
// .. Otherwise, process custom form validation goes here }

function userBookings_editGuestForm_submit($form, &$form_state) {
//Get Form variables
$guestFirstname = $form_state['input']['FirstName'];
$guestSurname = $form_state['input']['Surname'];
$guestDietary = $form_state['input']['DietaryRequirements'];
$guestCompany = $form_state['input']['CompanyName'];
$guestPosition = $form_state['input']['Position'];
$guestEmail = $form_state['input']['Email'];
$memberCode = $form_state['input']['Member_code'];
$masterEventCode = $form_state['input']['MasterEventCode'];
$eventCode = $form_state['input']['EventCode'];
$bookerContactCounter = $form_state['input']['Attendee_Contact'];
$guestSeq = $form_state['input']['GuestSeq'];
$guestTitle = $form_state['input']['Title'];
$guestContactCounter = $form_state['input']['GuestID'];
$eventNameDetailsId = $form_state['input']['EventNameDetailsID'];
$id = $form_state['input']['ID'];

//Redirect back to the Booking.
$form_state['redirect'] = '/user/booking_guestupdated';} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:35:41.137

对于那些使用隐藏文本字段并根据需要进行设置的人，请确保检查输入的值！

# opencv - ROS Roboearth Ubuntu 12.04 vision_opencv 链接错误

> ID：14841689
> 
> 赞同：3
> 
> 时间：2013-02-12T20:57:54.317
> 
> 标签：opencv, computer-vision, ubuntu-12.04, ros

我试过在没有运气的情况下在 ROS 答案上问[这个问题](http://answers.ros.org/question/54777/install-errors-roboearth-ubuntu-1204-fuerte-vision_opencv/)，所以我要在这里尝试。

我正在尝试编译[ROS Roboearth 包](http://www.ros.org/wiki/roboearth)，似乎存在一些与 vision_opencv 的链接错误。

当我第一次尝试通过提供的说明进行编译时，我无法进行构建，因为我有旧的编译器并且我没有 Fuerte。所以，我将我的 Ubuntu 升级到 12.04 并更新到 ROS Fuerte。

然后我意识到 12.04 没有所需的 ros-fuerte-vision-opencv2 依赖项。所以，我从源代码编译并构建了 OpenCV 2.4.3，效果很好。然后我意识到我也无法提取我再次从[这里](http://www.ros.org/wiki/vision_opencv)得到的 ros-fuerte-vision-opencv ，检查了“fuerte”分支并在 /opt/ros/fuerte/stacks/vision_opencv 中编译。

现在，当我尝试通过

`rosmake roboearth`

我收到以下链接错误。

谢谢您的帮助。这可能只是我缺乏 C++ 知识，但我尝试了从检查依赖项到重新设置编译器标志和依赖项的顺序的所有方法，但我似乎无法让它工作。

```
[rosmake-1] Starting >>> ar_pose [ make ]                                                                                            
[ rosmake ] Last 40 lines_vision: 30.7 sec ] [ ar_pose: 4.2 sec ]                                        [ 2 Active 47/103 Complete ]
{-------------------------------------------------------------------------------
  make[3]: Leaving directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
  [ 70%] Built target rosbuild_precompile
  make[3]: Entering directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
  make[3]: Leaving directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
  make[3]: Entering directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
  Linking CXX executable ../bin/ar_multi
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `ar_pose::ARSinglePublisher::arInit()':
  /home/sasha/ros/stacks/ccny_vision/ar_pose/src/ar_multi.cpp:140: undefined reference to `cvCreateImage'
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `CvBridge':
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:67: undefined reference to `cvCreateImageHeader'
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `~CvBridge':
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:73: undefined reference to `cvReleaseImageHeader'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:78: undefined reference to `cvReleaseImage'
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `sensor_msgs::CvBridge::reallocIfNeeded_(_IplImage**, CvSize, int, int)':
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:91: undefined reference to `cvReleaseImage'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:97: undefined reference to `cvCreateImage'
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `sensor_msgs::CvBridge::reallocIfNeeded(_IplImage**, int, int)':
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:109: undefined reference to `cvGetSize'
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `sensor_msgs::CvBridge::fromImage(sensor_msgs::Image_<std::allocator<void> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> >)':
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:199: undefined reference to `cvInitMatHeader'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:200: undefined reference to `cvGetImage'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:229: undefined reference to `cvCreateMat'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:230: undefined reference to `cvConvertScale'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:236: undefined reference to `cvConvertScale'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:243: undefined reference to `cvCvtColor'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:245: undefined reference to `cvCvtColor'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:247: undefined reference to `cvCvtColor'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:249: undefined reference to `cvCvtColor'
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:253: undefined reference to `cvCvtColor'
  CMakeFiles/ar_multi.dir/src/ar_multi.o:/opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:255: more undefined references to `cvCvtColor' follow
  CMakeFiles/ar_multi.dir/src/ar_multi.o: In function `sensor_msgs::CvBridge::fromImage(sensor_msgs::Image_<std::allocator<void> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> >)':
  /opt/ros/fuerte/stacks/vision_opencv/cv_bridge/include/cv_bridge/CvBridge.h:293: undefined reference to `cvReleaseMat'
  collect2: ld returned 1 exit status
  make[3]: *** [../bin/ar_multi] Error 1
  make[3]: Leaving directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
  make[2]: *** [CMakeFiles/ar_multi.dir/all] Error 2
  make[2]: Leaving directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
  make[1]: *** [all] Error 2
  make[1]: Leaving directory `/home/sasha/ros/stacks/ccny_vision/ar_pose/build'
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package ar_pose written to:
[ rosmake ]    /home/sasha/.ros/rosmake/rosmake_output-20130212-145046/ar_pose/build_output.log
[rosmake-1] Finished <<< ar_pose [FAIL] [ 4.31 seconds ]                                                                             
[ rosmake ] Halting due to failure in package ar_pose. 
[ rosmake ] Waiting for other threads to complete.                           
[ rosmake ] Last 40 lines_vision: 182.3 sec ]                                                            [ 1 Active 47/103 Complete ]
{-------------------------------------------------------------------------------
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cvReleaseMat'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::reshape(int, int, int const*) const'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cvSetZero'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::warpPerspective(cv::_InputArray const&, cv::_OutputArray const&, cv::_InputArray const&, cv::Size_<int>, int, int, cv::Scalar_<double> const&)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::getTextSize(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, double, int, int*)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::zeros(int, int, int)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::_InputArray::_InputArray(cv::MatExpr const&)'
  ../lib/libDVision.so: undefined reference to `cv::read(cv::FileNode const&, std::vector<cv::KeyPoint, std::allocator<cv::KeyPoint> >&)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::DescriptorMatcher::DescriptorCollection::~DescriptorCollection()'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::FlannBasedMatcher::train()'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cvCvtColor'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::MatConstIterator::seek(int const*, bool)'
  ../lib/libDVision.so: undefined reference to `cv::FeatureDetector::~FeatureDetector()'
  ../lib/libDUtilsCV.so: undefined reference to `cv::line(cv::Mat&, cv::Point_<int>, cv::Point_<int>, cv::Scalar_<double> const&, int, int, int)'
  ../lib/libDVision.so: undefined reference to `cv::Exception::Exception(int, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::initUndistortRectifyMap(cv::_InputArray const&, cv::_InputArray const&, cv::_InputArray const&, cv::_InputArray const&, cv::Size_<int>, int, cv::_OutputArray const&, cv::_OutputArray const&)'
  ../lib/libDVision.so: undefined reference to `cv::WriteStructContext::~WriteStructContext()'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::copySize(cv::Mat const&)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cvCreateImageHeader'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::inv(int) const'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::copyTo(cv::_OutputArray const&) const'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::Mat(cv::Mat const&, cv::Range const&, cv::Range const&)'
  ../lib/libDVision.so: undefined reference to `cv::operator<<(cv::FileStorage&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::flann::IndexParams::~IndexParams()'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cvGetSize'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Mat::deallocate()'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::_InputArray::_InputArray(double const&)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cvCreateImage'
  ../lib/libDUtilsCV.so: undefined reference to `cv::namedWindow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::Algorithm::~Algorithm()'
  ../lib/libObjectDetectorFunctions.so: undefined reference to `cv::FlannBasedMatcher::FlannBasedMatcher(cv::Ptr<cv::flann::IndexParams> const&, cv::Ptr<cv::flann::SearchParams> const&)'
  ../lib/libDVision.so: undefined reference to `cv::Algorithm::set(char const*, bool)'
  collect2: ld returned 1 exit status
  make[3]: *** [../bin/ObjectDetector] Error 1
  make[3]: Leaving directory `/home/sasha/ros/stacks/roboearth/re_vision/build'
  make[2]: *** [CMakeFiles/ObjectDetector.dir/all] Error 2
  make[2]: Leaving directory `/home/sasha/ros/stacks/roboearth/re_vision/build'
  make[1]: *** [all] Error 2
  make[1]: Leaving directory `/home/sasha/ros/stacks/roboearth/re_vision/build'
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package re_vision written to:
[ rosmake ]    /home/sasha/.ros/rosmake/rosmake_output-20130212-145046/re_vision/build_output.log
[rosmake-0] Finished <<< re_vision [FAIL] [ 182.31 seconds ]                                                                         
[ rosmake ] Halting due to failure in package re_vision. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T22:26:07.727

好的，所以我能够解决问题。

首先我做了`sudo apt-get update`，我看到我收到以下消息：

`W: Duplicate sources.list entry http://archive.canonical.com/ubuntu/ precise/partner i386 Packages (/var/lib/apt/lists/archive.canonical.com_ubuntu_dists_precise_partner_binary-i386_Packages)`

为了解决这个问题，我去了`Synaptic Package Manager-> Settings -> Repositories -> Other Software' 并取消选中“Canonical Partners - added by software center”。

然后又做`sudo apt-get update`了。这解决了上述问题。

然后，我转到以下文件`/etc/apt/sources.list.d/ros-latest.list`，看到 url 被注释掉了。我取消注释以下行`deb http://packages.ros.org/ros/ubuntu precise main`并`sudo apt-get update`再次运行。

在此之后，我能够通过 apt-get 安装 roboearth 所需的所有依赖项，并且能够成功地制作 roboearth`rosmake roboearth`

# python - 定义一些函数运算符时出现 PicklingError

> ID：14841691
> 
> 赞同：1
> 
> 时间：2013-02-12T20:58:04.187
> 
> 标签：python, python-2.7, multiprocessing, pickle

我正在使用基于 Python 2.7 的数学软件 SageMath。以下简化代码是从初始估计开始递归计算两个函数。当我尝试在代码中引入“数值积分运算符”而不是使用内置函数时，它会给出错误：

```
> PicklingError: Can't pickle <type 'function'>: attribute lookup __ builtin__.function failed 
```

代码是：

```
reset()
forget()
from multiprocessing import Pool, cpu_count

#variables
var('x,y, x1,y1')
N=5   #number of iterations
var('q')

#functions' name definition (without specifying the rules)  # n is the level of estimation
U0=[]
U1=[]
for n in range(N+1):
    U0.append(function('U0_%s' %i, x,y))
    U1.append(function('U1_%s' %i, x,y, x1,y1))

#initial estimation of the functions
U0[0]=sin(x+y)
U1[0]=sin(x1+y1)*cos(x-y)

#numerical integrator
num=20.0  # at each call of the int function h is assigned (b-a)/num, so assigned to num here
def numint(f, x, a, b, h):
    #pickle_function(f)
    integ = 0.5*h*(f(x=a) + f(x=b))
    for i in range(1,num):
        integ = integ + h * f(x=a+i*h)
    return integ

#the integral operators
def Ix(f,x):
    return pool.apply( numint, (f,x,-1.0,+1.0,2.0/num) )
def Iy(f,y):
    return pool.apply_async( numint, (f,y,-1.0,+1.0,2.0/num) )
def IR(f,x,y):
    return Iy(Ix(f,x),y)
def N0(n,f0,f1):
    return f0[n] + IR(f1[n],x1,y1) + IR(IR(f1[n],x,y),x1,y1)
def N1(n,f0,f1):
    return f1[n] + IR(f0[n],x,y) - IR(IR(f1[n],x,y),x1,y1)

#the calculations
pool = Pool(processes=cpu_count())
for n in range(N):
    worker0 = N0(n,U0,U1)
    worker1 = N1(n,U0,U1)
    U0[n+1] = U0[n] - worker0.get()
    U1[n+1] = U1[n] - worker1.get()
    show(U0[n+1])
    show(U1[n+1]) 
```

据我通过搜索网络和阅读文档了解到，这个酸洗错误要么是由于积分运算符（无论如何是一个函数）不是 Picklable，要么是因为它的参数不是 Picklable。我试图让操作符本身可腌制但没有成功，但我想问题应该是由于积分操作符本身是它的被积函数的函数，并且由于它是一个*操作符*，它的被积函数中的函数没有被确定，因为一开始，所以也许操作符的第一个参数（它本身是一个函数）没有在顶层明确定义是操作符不能整体picklable的原因？知道如何克服这个错误吗？

**注意**。主要代码比这里提供的简约代码复杂得多，所以我宁愿定义一个整数运算符来防止代码的可读性。

# mysql - MySQL查询以在单个列中查找相似值

> ID：14841693
> 
> 赞同：11
> 
> 时间：2013-02-12T20:58:13.353
> 
> 标签：mysql, sql, similarity

我有高度相似但不准确的重复条目。这里有些例子：

```
- 2016: Obama's America
- 2016: Obama's America (VF)

- Hurt Locker
- The Hurt Locker 
```

什么是我可以用来获得可能相似的查询`titles`？

## 更新

请注意，我并不是要删除 EXACT 重复项。我只是想在单个列中选择相似的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:18:13.080

不确定这是最好的方法还是最有效的方法，这绝对取决于相似的含义。如果意思是标题包含一行中的所有文本但另一行中包含一些文本，那么这样的事情应该有效：

```
SELECT DISTINCT T.Title
FROM YourTable T
   LEFT JOIN YourTable T2 ON T.Title != T2.Title
WHERE T.Title LIKE CONCAT('%', T2.Title, '%')
UNION 
SELECT DISTINCT T2.Title
FROM YourTable T
   LEFT JOIN YourTable T2 ON T.Title != T2.Title
WHERE T.Title LIKE CONCAT('%', T2.Title, '%')
ORDER BY Title 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!2/7f439/1)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T21:18:16.357

我认为这可以通过使用一些[字符串度量](http://en.wikipedia.org/wiki/String_metric)来测量字符串之间的距离来解决。

Levenshtein 似乎是最著名的指标，我在 Oracle 中使用了它的一些实现。它也[为 MySQL 实现](https://stackoverflow.com/questions/12617348/mysql-levenshtein)。您可能会发现其他一些更适合您的指标。

# python - 为集合容器定义 __str__ 和 __repr__

> ID：14841694
> 
> 赞同：1
> 
> 时间：2013-02-12T20:58:17.350
> 
> 标签：python, string, repr

我一直在做一个大的任务，我几乎完成了，除了我需要帮助编写一个 Set 容器的`__str__`和`__repr__`函数。

我从来没有这样做过，我不知道该怎么做。在互联网上搜索，我仍然卡住了。

我试过类似的东西：

```
'%s(%r)' % (self.__class__, self) 
```

我需要打印出这样的表示：

```
'set([ELEMENT_1, ELEMENT_2,..., ELEMENT_N])' 
```

我的元素存储在一个数组类中，我围绕它编写了 set 容器。我使用类似`for item in self`或的循环访问它`if item in self`

请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:05:11.333

我怀疑以下方法会起作用：

```
def __repr__(self):
    return 'set([%s])' % ', '.join(self) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:06:48.357

请参阅此[答案](https://stackoverflow.com/a/2626364/1988505)`__str__`，详细说明和之间的区别`__repr__`。

一个基本的实现是这样的：

```
def __repr__(self):
    return 'set(%r)' % [item for item in self] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T23:18:30.990

像这样简单的事情可能已经足够好了，并且可以同时处理这两种方法：

```
class Set(object):
    def __init__(self):
        self.array = ...

    def __repr__(self):
        return '{}({!r})'.format(self.__class__.__name__, self.array)

    __str__ = __repr__ 
```

# html - 为什么 textareas 超过宽度时会破坏长词（为什么 div 不会破坏长词）？

> ID：14841696
> 
> 赞同：5
> 
> 时间：2013-02-12T20:58:19.883
> 
> 标签：html, css, overflow, word-wrap

假设我有两个盒子：`div.box`和`textarea.box`，每个盒子都有相同的固定宽度和高度。每个都有相同的文本，包括一个 verrrryyyyy 长词，然后是一系列短词。

设置可能如下所示：

**CSS：**

```
.box {
    width: 400px;
    height: 100px;
} 
```

**HTML：**

```
<div class="box">
looooooooooooooooooooooooooooooooooooooooooooooooooooooooong_word and short text
</div>

<br><br>

<textarea class="box">
looooooooooooooooooooooooooooooooooooooooooooooooooooooooong_word and short text
</textarea> 
```

使用上面的代码，`div`不会打断长字，然后从下一行开始用一系列短字：

![div.box 图像](../Images/61e41e831025e7257b4221c2b2f3863d.png)

但是，`textarea`打破了长字：

![textarea.box 图片](../Images/4414f8ef3ceffca6ed0d59ac611f1d4f.png)

我的问题：为什么会发生这种情况？什么默认 CSS 导致将`div`长单词保留在一行（即不中断单词），但是`textarea`中断它？

[JS 小提琴示例](http://jsfiddle.net/QZDe6/)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T21:12:14.787

Chrome 默认文本区域样式：

```
textarea {
    -webkit-appearance: textarea;
    background-color: white;
    border: 1px solid;
    border-image: initial;
    -webkit-rtl-ordering: logical;
    -webkit-user-select: text;
    -webkit-box-orient: vertical;
    resize: auto;
    cursor: auto;
    padding: 2px;
    white-space: pre-wrap;
    word-wrap: break-word;
} 
```

这`word-wrap: break-word;`就是原因。

该`overflow`属性只能隐藏溢出的内容或允许滚动。用来`word-wrap: break-word;`让长词被打断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T21:30:31.827

不同之处在于每个元素的[`word-wrap`属性](https://developer.mozilla.org/en-US/docs/CSS/word-wrap)的默认值。

默认情况下，浏览器的原生样式表应用于`word-wrap:normal`元素`div`，而`textarea`它应用于元素`word-wrap:break-word`。

换句话说，对于`div`元素，浏览器假设如果文本超出指定的尺寸，整个单词不能被打破以适应容器，而对于`textarea`元素，它假设单词中断是可以接受的。当（在这种情况下）溢出未被抑制时，这种差异变得非常明显。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T21:10:55.027

因为这不是溢出的作用，所以您可能想看看 word-wrap 属性（[http://www.w3.org/TR/css3-text/#overflow-wrap](http://www.w3.org/TR/css3-text/#overflow-wrap)）。

你想应用自动换行：break-word; 到元素。

# javascript - 可以从内存中创建 AudioBuffer，即 Int8Array

> ID：14841708
> 
> 赞同：2
> 
> 时间：2013-02-12T20:58:53.083
> 
> 标签：javascript, html, html5-audio, web-audio-api

有没有办法将内存中的原始数据作为样本添加到 Web Audio Api？我想添加一个 Int8Array（或 Int16Array）作为缓冲区，缓冲区只有样本，没有 WAV 或 MP3 格式。我已经尝试了 audioContext.createBuffer 等但没有成功。

像这样的东西：

```
var buffer = audioContext.createBuffer(1,8192, 22000);
var intArray = new Int8Array(....);
// -- fill intarray
buffer.buffer = intArray;
...
var source = context.createBufferSource();
source.buffer = buffer;
source.connect(context.destination); 
```

如果那不可能，是否有一种与 contetx.decodeAudio() 兼容的声音格式，它很容易在内存中“模拟”？即只是一个标题或其他东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T23:19:06.753

它既不是很直观，也不是在规范中明确记录，也不是很容易在网上找到：

但是，您可以简单地修改任何缓冲区`Float32Array`返回的`getChannelData(<idx of channel>)`。

不要忘记将样本缩放到范围 [-1, 1]

对于您的示例，您可以缩放 intArray 中的值并将其复制到通过调用获得的 floatArray：

```
floatArray = buffer.getChannelData(0) 
```

# ios - MFMailComposeViewController 发送状态

> ID：14841709
> 
> 赞同：0
> 
> 时间：2013-02-12T20:58:55.127
> 
> 标签：ios, mfmailcomposeviewcontroller

有没有办法从 MFMailComposeViewController 获取状态？假设我正在发送一封包含 20 张图片的电子邮件，我想显示一些加载，然后在发送完成后隐藏加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:02:24.547

不会。一旦用户选择发送电子邮件并且在您的应用程序中调用了委托方法，该电子邮件就会在发件箱中等待某个后台邮件守护程序发送。没有 API 可以获取此类电子邮件的状态。即使由于某种原因无法发送邮件，应用程序也无法获取此信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-12T21:08:07.300

```
try the delegate methods may be it help you.

#pragma mark - MailComposeController

- (void)mailComposeController:(MFMailComposeViewController*)controller  didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error
{
    switch (result)
    {
        case MFMailComposeResultCancelled:
            NSLog(@"Mail cancelled: you cancelled the operation and no email message was queued.");
            break;
        case MFMailComposeResultSaved:
            NSLog(@"Mail saved: you saved the email message in the drafts folder.");
            break;
        case MFMailComposeResultSent:
            NSLog(@"Mail send: the email message is queued in the outbox. It is ready to send.");
            break;
        case MFMailComposeResultFailed:
            NSLog(@"Mail failed: the email message was not saved or queued, possibly due to an error.");
            break;
        default:
            NSLog(@"Mail not sent.");
            break;
    }

} 
```

# ruby-on-rails - 客户端当前用户

> ID：14841710
> 
> 赞同：0
> 
> 时间：2013-02-12T20:58:55.997
> 
> 标签：ruby-on-rails, backbone.js

我有一个 Rails/Backbone 应用程序，它使用 JavaScript/Ajax（使用主干）实现设计身份验证。用户登录后，我将设计中的 userSession 响应对象分配给 app.currentUser 以创建客户端 currentUser。

```
app.currentUser = userSession; 
```

但是，我使用 currentUser 的方式，我不妨只给它一个布尔值，因为我不使用任何 userSession 信息。

继续，在我的应用程序的其他方法中，我通过查看是否有这样的当前用户来检查授权

```
if(!app.currentUser) {
        this.trigger("pleaseSignIn");
        return; 
    }
    else { 
     .... 
```

当我测试它时，这很好用——如果用户没有登录，他就无法继续使用应用程序的某些部分。但是，任何具有基本 javascript 技能的人都可以通过`app.currentUser = true`在控制台中进行设置来绕过登录。我不是在授权背后保护国家机密；它只是为了鼓励注册等。我的问题是，有没有办法在不检查当前用户是否存在于服务器端（即设计设置当前用户服务器端登录）的情况下稍微加强这一点。

我考虑的一个（弱）策略是为我的变量使用完全没有意义的名称。即，而不是`if(!app.currentUser) {`我可能会`if(!app.godNotDead)`这样说，至少有人必须通过废话来破解我的多孔身份验证墙。但是，我仍然希望有一些更强大的东西。

也许我应该多解释一下这个应用程序是如何工作的。它一开始没有认证墙。相反，用户可以玩应用程序的某些部分，只有当他们尝试点击应用程序的其他部分时才会被要求登录。

仅供参考，在正常的设计设置中，授权在服务器上的 Rails 控制器中检查，并且不能以这种方式绕过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:39:00.300

最好的方法是从 Rails 而不是客户端获取状态

```
UserModel.fetch()
// returns a user model if there is one, if not then you are obviously not authenticated 
```

或者，我认为更好的是，在您对服务器的请求中使用令牌作为参数

```
?token={some hash the server gave you} 
```

所以它不仅仅是一个布尔值，你需要一个令牌

# memory-mapped-files - 在内存映射文件上使用较小的临时视图与较大的持久视图有什么好处

> ID：14841712
> 
> 赞同：1
> 
> 时间：2013-02-12T20:59:03.130
> 
> 标签：memory-mapped-files

我正在摆弄自己的存储引擎，主要是为了我自己的教育。

到目前为止，我有一个非常好的内存映射文件工作解决方案，但有些事情困扰着我，我不想稍后再被这个问题困扰。我基本上是在映射我的整个文件的视图，并且只有在我必须调整文件大小时才创建一个新视图。我知道这种方法有一个明显的缺点：目前最大尺寸，但我可以忍受，我真的不打算存储超过千兆字节的数据。

但还有其他考虑吗？这个大型映射如何与操作系统内存管理例程交互，从长远来看呢？使用这种方法会遇到性能和碎片问题吗？

在我需要的文件区域上使用较小的视图肯定会消除我可以制作的数据库大小的限制，但那是我必须在我的存储引擎中做的额外管理层，如果我宁愿避免可以。

我才刚刚爬过冰山的顶部，如果有人能成为我的雷达，我肯定能避免致命的坠机！

# r - 在 lme 之后尝试成对比较时出错

> ID：14841714
> 
> 赞同：1
> 
> 时间：2013-02-12T20:59:05.160
> 
> 标签：r, modeling

这是我第一次问关于 R 的问题，如果我遗漏了必要的细节，请原谅我。我会尽量做到彻底但简洁。

我的数据有 4 列：分数（值 -1、0 或 1）；物种（至少 10 种不同的）；栖息地（三个不同的）；和站点（至少 8 个不同的站点）。所以每一行都是分数、物种、栖息地和地点的独特组合。请参阅下面的顶行：

```
score species habitat  site
0    NOCA     NAG  NAG1
0    BRTH     NAG  NAG1
0    BARS     NAG  NAG1
1    COYE     NAG  NAG1
0    HOWR     NAG  NAG1
0    SAVS     NAG  NAG1
0    CEDW     NAG  NAG1
1    CHSP     NAG  NAG1
0    EAKI     NAG  NAG1
1    MODO     NAG  NAG1
0    NOCA     NAG NAG16
0    BRTH     NAG NAG16 
```

我运行了一个 lme 来评估物种和栖息地对分数的影响，地点是随机效应。代码如下：

```
anova(model<-lme(score~species*habitat, random=~1|site)) 
```

然后，我想进行成对比较，以确定显着差异在哪里。TukeyHSD 不适用于 lme，所以我使用了 multcomp 包，如下所示：

```
summary(glht(model, linfct=mcp(habitat="Tukey"))) 
```

据我所知，这将根据栖息地类型对分数进行成对比较。我还尝试用物种代替栖息地，以根据物种进行比较。在这两种情况下，我都收到以下错误：

> contrMat(table(mf[[nm]]), type = types[pm]) 中的错误：少于两组

我看不出我怎么能在任何地方拥有少于两个组，因为我对任何列的最小组数是三个。也许我误解了 R 所指的“组”？关于可能出现的问题以及如何解决问题的任何建议？

**编辑**根据建议（谢谢），这里有一些关于我的数据的更多信息，可能会使其可重现。首先，我完整使用的代码。

```
library(nlme)
library(multcomp)
null<-read.csv("baci_null_red.csv", head=TRUE)
attach(null)
anova(model<-lme(score~species*habitat, random=~1|site))
              numDF   denDF  F-value  p-value

(Intercept)         1   1392   1.929021  0.1651

species            29   1392   2.691207    <.0001

habitat             2    48    3.412485  0.0411

species:habitat    58  1392    1.239267  0.1099 
```

摘要(glht(模型, linfct=mcp(habitat="Tukey")))

```
Error in contrMat(table(mf[[nm]]), type = types[pm]) : 
  less than two groups 
```

以下是一些关于可能有助于重现它的数据的摘要……它有点大，我不确定如何使它最小化，但仍然会出现错误。

```
str(null)

'data.frame':   1530 obs. of  4 variables:
 $ score  : int  0 0 -1 0 0 0 0 0 0 0 ...
 $ species: Factor w/ 30 levels "AMGO","AMRO",..: 27 5 7 2 18 12 22 28 6 13 ...
 $ habitat: Factor w/ 3 levels "CUM","IAG","NAG": 3 3 3 3 3 3 3 3 3 3 ...
 $ site   : Factor w/ 51 levels " CUM6","CUM1",..: 37 37 37 37 37 37 37 37 37 37 ..

summary(null)

 score             species     habitat        site     

 Min.   :-1.00000   AMGO   :  51   CUM:210    CUM6  :  30  
 1st Qu.: 0.00000   AMRO   :  51   IAG:660   CUM1   :  30  
 Median : 0.00000   BARS   :  51   NAG:660   CUM10  :  30  
 Mean   :-0.01569   BCCH   :  51             CUM12  :  30  
 3rd Qu.: 0.00000   BHCO   :  51             CUM2   :  30  
 Max.   : 1.00000   BLJA   :  51             CUM3   :  30  
                (Other):1224             (Other):1350  

dput(null[somerows,c("species","habitat","site")])

structure(list(species = structure(c(27L, 5L, 7L, 2L, 18L, 12L, 
22L, 28L, 6L, 13L, 15L, 23L, 4L, 10L, 14L, 11L, 20L, 30L, 9L, 
19L, 26L, 8L, 16L, 25L, 3L, 17L, 21L, 29L, 24L, 1L, 27L, 5L, 
7L, 2L, 18L, 12L, 22L, 28L, 6L, 13L, 15L, 23L, 4L, 10L, 14L, 
11L, 20L, 30L, 9L, 19L, 26L, 8L, 16L, 25L, 3L, 17L, 21L, 29L, 
24L, 1L, 27L, 5L, 7L, 2L, 18L, 12L, 22L, 28L, 6L, 13L, 15L, 23L, 
4L, 10L, 14L, 11L, 20L, 30L, 9L, 19L, 26L, 8L, 16L, 25L, 3L, 
17L, 21L, 29L, 24L, 1L, 27L, 5L, 7L, 2L, 18L, 12L, 22L, 28L, 
6L, 13L), .Label = c("AMGO", "AMRO", "BARS", "BCCH", "BHCO", 
"BLJA", "BOBO", "BRTH", "CEDW", "CSWA", "EABL", "EAKI", "EAWP", 
"FISP", "GCFL", "HOLA", "HOWR", "INBU", "KILL", "LEFL", "MODO", 
"NOCA", "RBGR", "RWBL", "SAVS", "SOSP", "VESP", "WIFL", "YSFL", 
"YWAR"), class = "factor"), habitat = structure(c(3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L), .Label = c("CUM", "IAG", "NAG"), class = "factor"), site = structure(c(37L, 
37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 
37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 
37L, 37L, 37L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 
46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 
46L, 46L, 46L, 46L, 46L, 46L, 46L, 47L, 47L, 47L, 47L, 47L, 47L, 
47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 
47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 48L, 48L, 
48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L), .Label = c(" CUM6", 
"CUM1", "CUM10", "CUM12", "CUM2", "CUM3", "CUM8", "IAG1", "IAG10", 
"IAG13", "IAG14", "IAG15", "IAG16", "IAG18", "IAG19", "IAG21", 
"IAG22", "IAG23", "IAG24", "IAG25", "IAG26", "IAG27", "IAG28", 
"IAG3", "IAG4", "IAG5", "IAG6", "IAG8", "IAG9", "NAG10", "NAG11", 
"NAG13", "NAG14", "NAG15", "NAG18", "NAG19", "NAG2", "NAG21", 
"NAG22", "NAG23", "NAG24", "NAG25", "NAG26", "NAG27", "NAG28", 
"NAG3", "NAG4", "NAG5", "NAG6", "NAG7", "NAG8"), class = "factor")), .Names =
  c("species", "habitat", "site"), row.names = c(NA, 100L), class = "data.frame") 
```

你有它：s 感谢您的任何指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-12T00:45:34.923

我刚刚通过避免附加数据框解决了这个问题。我在网上读到，当尝试将拟合模型传递给函数时，附加数据框会产生问题。

我建议使用这样的代码而不是使用`attach()`

```
summary(model<-lme(fix~treat*week, random=~1|rep/week, data=dataframename))
summary(glht(model, linfct=mcp(treat="Tukey"))) 
```

# date - Coffeescript：Rails 日期函数方式 - 年/月/周的开始和结束

> ID：14841715
> 
> 赞同：-1
> 
> 时间：2013-02-12T20:59:11.607
> 
> 标签：date, coffeescript

我在 coffescript 中四处走动，找不到任何好的库来使用 Rails 中的日期函数

所以我写了一些可以帮助你完成工作的东西。

如果您找到更好的方法，请发表评论:)

用法：

```
(new Date()).endOfMonth()
#=> Fri Feb 01 2013 00:00:00 GMT+0100 (CET)

(new Date()).subMonths(2).beginningOfMonth()
#=> Sat Dec 01 2012 00:00:00 GMT+0100 (CET) 
```

库：

```
Date::yesterday = () ->
  new Date(1900+@getYear(), @getMonth(), @getDate()-1)

Date::beginningOfYear = () ->
  new Date(1900+@getYear(), 1, 1)

Date::endOfYear = () ->
  new Date(1900+@getYear()+1, 0, 0)

Date::beginningOfMonth = () ->
  new Date(1900+@getYear(), @getMonth(), 1)

Date::endOfMonth = () ->
  new Date(1900+@getYear(), @getMonth()+1, 0)

Date::beginningOfWeek = () ->
  new Date(1900+@getYear(), @getMonth(), @getDate() - @getDay() + 1)  

Date::endOfWeek = () ->
  new Date(1900+@getYear(), @getMonth(), @getDate() + (7-@getDay()))  

Date::addYears = (count) ->
  new Date(1900+@getYear() + count, @getMonth(), @getDate())  

Date::addMonths = (count) ->
  new Date(1900+@getYear(), @getMonth() + count, @getDate())  

Date::addDays = (count) ->
  new Date(1900+@getYear(), @getMonth(), @getDate() + count)  

Date::subYears = (count) ->
  new Date(1900+@getYear() - count, @getMonth(), @getDate())  

Date::subMonths = (count) ->
  new Date(1900+@getYear(), @getMonth() - count, @getDate())  

Date::subDays = (count) ->
  new Date(1900+@getYear(), @getMonth(), @getDate() - count) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:03:52.257

当与时间一起工作时，我真的不能推荐[moment.js](http://momentjs.com/)。

# c# - WCF 端点配置：第二个端点根本不起作用，第一个端点似乎不受绑定影响

> ID：14841716
> 
> 赞同：0
> 
> 时间：2013-02-12T20:59:15.450
> 
> 标签：c#, wcf, wcf-binding

在 IIS 中托管的 WCF 服务中，我正在尝试设置多个端点。一种用于 SOAP，一种用于 SOAP12。根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms751515.aspx)，我编辑`Web.config`如下：

```
<services>
  <service name="MyNamespace.MyClass">
    <endpoint address="" binding="basicHttpBinding" contract="IContract" />
    <endpoint address="Endpoint2" binding="wsHttpBinding" contract="IContract" />
  </service>
</services> 
```

这似乎没有任何效果。网址上没有答案：

```
http://localhost:51454/MyClass.svc/Endpoint2 
```

如果我更改`IContract`为`IContract2`，我会收到错误消息：

```
The service '/MyClass.svc' cannot be activated due to an exception during 
compilation. 
```

所以`Web.config`我正在编辑的是正在使用的那个。

将默认地址的绑定从 更改为`basicHttpBinding`没有`wsHttpBinding`任何效果。WSDL 保持不变。

WSDL 包含这一位，这似乎表明它正在使用生成的绑定运行：

```
<wsdl:service name="TapasSim">
    <wsdl:port name="BasicHttpBinding_IContract" 
               binding="i0:BasicHttpBinding_IContract">
        <soap:address location="http://localhost:51454/MyClass.svc"/>
    </wsdl:port>
</wsdl:service> 
```

为什么 WCF 服务不使用来自的配置`Web.config`？
为什么 WCF 不监听`/Endpoint2`SOAP12 绑定？
为什么默认端点不会从`basicHttpBinding`to更改`wsHttpBinding`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:04:39.620

尝试为端点添加一个基本地址：

```
 <service name="namespace.Service">
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost:51454/myclass.svc"/>
      </baseAddresses>
    </host> 
```

// 端点omnited

或者尝试在地址前添加一个斜杠：

端点地址="/Endpoint2" 绑定="wsHttpBinding" 合同="IContract"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:38:30.533

MSDN文章是正确的，你的配置没有错。我使用 VS 创建了一个 WCF 客户端，并且能够使用成功调用

```
http://localhost:51454/MyClass.svc/Endpoint2 
```

显然，它不会显示为来自浏览器的有效 url。尝试使用第二个 url 从客户端消费，它应该可以工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T10:59:55.277

问题是服务名称：

```
<service name="MyNamespace.MyClass"> 
```

班级名称错误。当你输入错误的合约界面时，WCF 会抛出错误。但是一个错误的类名会被默默地忽略。这就解释了为什么它依赖于默认配置。

# javascript - 如果 Javascript 不是多线程的，是否有任何理由实现异步 Ajax Queuing？

> ID：14841718
> 
> 赞同：1
> 
> 时间：2013-02-12T20:59:15.627
> 
> 标签：javascript, jquery, queue, single-threaded

我的 php 服务器有问题（我的电脑是唯一的连接）。我最初认为部分原因是因为 ajax 请求太多（我有一个脚本，每次击键都会执行一个 ajax 请求），所以我实现了一个设计来控制 ajax 请求进入队列的流程。下面是我的代码：

```
//global vars:
activeAjaxThread = 0; //var describing ajax thread state
ajaxQue = [];  //array of ajax request objects in queue to be fired after the completion of the previous request

function queRequest(ajaxObj) {
  ajaxQue.push(ajaxObj);
  if (activeAjaxThread == 0) {
    fireOffAjaxQue();   
  } else {
    return 'ajax thread is running';
  }
}

function fireOffAjaxQue () {
  activeAjaxThread = 1;
  //getLastRequest();
  if ((ajaxQue.length > 0) && activeAjaxThread == 1) {
    $.ajax(ajaxQue[0]).always( function () {
      ajaxQue.shift(); 
      if (ajaxQue.length > 0) {
        fireOffAjaxQue();   //fire off another ajax request since this one has been completed. 
      }
    });
  }
  activeAjaxThread = 0;   //thread has finished executing
} 
```

执行：

```
//create ajax object
var ajaxObj = {
  url: 'someplace.php',
  data: dataVar,
  success: function (data) {...}
};
//send ajax object to que
queRequest(ajaxObj); 
```

然后我发现 Javascript 是多线程的，并阅读了一些关于 Javascript 事件处理的文章，例如John Resig在[http://ejohn.org/blog/how-javascript-timers-work/](http://ejohn.org/blog/how-javascript-timers-work/)上的这篇文章（jQuery extra-ordinaire )

既然如此，难道我在这里介绍的函数不会产生任何结果，因为 Javascript 已经在排队我的请求了吗？奇怪的是，它似乎彻底改变了它。我的服务器崩溃较少，（**并不是说它认为它是任何想象中的解决方案**......*啊*），并且在它崩溃并重新启动后，先前排队的 ajax 请求被发送，而早些时候它们似乎都被一次发送并在服务器崩溃时消失得无影无踪。

如果 Javascript 是单线程的，对异步事件进行排队：

1.  拥有 Ajax 请求管理器或队列有什么意义？
2.  为什么我的代码会产生任何结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:02:42.777

Javascript is single threaded, but once the AJAX request is sent, it is out of javascript's hands, so to speak. That's the Asynchronous part of AJAX. The request is made and then the code moves on. Then when the response is received it is processed. Requests are not queued.

# youtube-api - 在youtube的分析API中请求insightTrafficSourceDetail的正确方法是什么？

> ID：14841722
> 
> 赞同：0
> 
> 时间：2013-02-12T20:59:31.510
> 
> 标签：youtube-api, analytics

我可以从文档中看到insightTrafficSourceDetail 仅适用于维度/过滤器/结果数量的某些组合，但是我似乎无法进行合法查询。

例如：

> metrics=views&dimensions=insightTrafficSourceDetail&filter=insightTrafficSourceType==GOOGLE_SEARCH&max-results=1

根据文档，这似乎对我有用，但我明白了：

> {"errors":[{"domain":"global","re​​ason":"badRequest","message":"查询不受支持。查看支持查询的文档。"}],"code":400 ,"message":"该查询不受支持。请查看支持查询的文档。"}

尝试了许多其他组合都无济于事。

我注意到一些关于这个的错误报告，所以它可能坏了？

[https://code.google.com/p/gdata-issues/issues/detail?id=3995](https://code.google.com/p/gdata-issues/issues/detail?id=3995)

[https://code.google.com/p/gdata-issues/issues/detail?id=3963](https://code.google.com/p/gdata-issues/issues/detail?id=3963)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:02:52.070

此查询仅适用于视频级别。这意味着您必须添加到过滤器“video==%some-video-id%”

请参阅 [http://developers.google.com/apis-explorer/#p/youtubeAnalytics/v1/youtubeAnalytics.reports.query?ids=channel%253D%253DYOUR_CHANNEL_ID_HERE&start-date=2010-01-01&end-date=2013-02- 12&metrics=views&dimensions=insightTrafficSourceDetail&filters=insightTrafficSourceType%253D%253DYT_SEARCH%253Bvideo%253D%253DYOUR_VIDEO_ID_HERE&max-results=25&sort=-views&_h=8&](http://developers.google.com/apis-explorer/#p/youtubeAnalytics/v1/youtubeAnalytics.reports.query?ids=channel%253D%253DYOUR_CHANNEL_ID_HERE&start-date=2010-01-01&end-date=2013-02-12&metrics=views&dimensions=insightTrafficSourceDetail&filters=insightTrafficSourceType%253D%253DYT_SEARCH%253Bvideo%253D%253DYOUR_VIDEO_ID_HERE&max-results=25&sort=-views&_h=8&)

并且： [https](https://developers.google.com/youtube/analytics/v1/available_reports) ://developers.google.com/youtube/analytics/v1/available_reports 关于频道报告的部分 (insightTrafficSourceDetail)

干杯

# php - 对过滤查询的结果进行排序

> ID：14841723
> 
> 赞同：1
> 
> 时间：2013-02-12T20:59:34.797
> 
> 标签：php, elasticsearch, elastica

由于大量的过滤条件（1000 年代的权限系统），我必须使用`Elastic_Query_Filtered`这很好，我什至可以使用设置分页限制

```
$elasticaType->search($elasticaQueryString, $options); 
```

在我介绍排序选项之前，这一切都很好。这是我到目前为止所拥有的：

```
$options = array('from'=>$from, 'size'=>$to, 'sort'=>array("description" => array("order" => "asc")));
$elasticaResultSet = $elasticaType->search($elasticaQueryString, $options); 
```

我是在做一些愚蠢的事情还是排序还不支持。有没有替代方案。使用 bool 过滤器使事情发生在`max_clause_count`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T07:10:44.923

我用它来搜索单个查询字符串，限制和排序

```
$client = new Elastica_Client(array('host' => '192.168.0.27','port' => '9200'));

$elasticaQueryString =new Elastica_Query_QueryString();
$elasticaQueryString->setDefaultOperator('AND');
$elasticaQueryString->setQuery('100009'); // set value for where condition
$elasticaQueryString->setFields(array('increment_id','entity_id','billing_name'));  // set where fields

$elasticaQuery = new Elastica_Query();
$elasticaQuery->setQuery($elasticaQueryString);  // set query string
$elasticaQuery->setFields(array('increment_id','entity_id','billing_name','created_at'));   // set output fields

$elasticaQuery->setFrom(0); //set from point   
$elasticaQuery->setLimit(20);  //limit the record   
$sort = array("entity_id" => array("order" => "asc"));  //order by clause

$elasticaQuery->setSort($sort);  //set Sorting

echo "<br />".json_encode($elasticaQuery->toArray())."<br />";  //print the query

$search = new Elastica_Search($client); // Create the search object and inject the client
$resultSet = $search->addIndex('sales')->addType('order')->search($elasticaQuery);  // Configure and execute the search

echo "<br /><strong>Total Results Found : ".$totalResults= $resultSet->getTotalHits()."</strong><br />";            //get total result found

$data=$resultSet->getResults(); //extract the result

$result=array();

foreach ($data as $data1) 
{
  $result[]=$data1->getData();
}

print_r($result); 
```

# c# - VLC：最后移动文件

> ID：14841724
> 
> 赞同：2
> 
> 时间：2013-02-12T20:59:36.630
> 
> 标签：c#, visual-studio-2012, c#, .net, vlc, libvlc, vlcj

在 Windows 中，双击视频文件后，完成后，我希望将文件向上移动 dir 或 2，并删除任何包含的文件夹。

我只希望这会影响位于的文件`C:\Users\User1\Downloads`，比如说`%x%`。

有2种情况：

1.  如果文件是`%x%\Training.4273865.2013.avi`，则应将其移至`..\Viewed\`.

2.  如果文件是`%x%\Showcase\SomeFile.mp4`，则应将其移至同一文件夹：`..\..\Viewed\`. `Showcase`然后应删除该文件夹。目前，我必须关闭 VLC（关闭文件句柄）才能`Showcase`删除（以及其他内容）。

[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")解决方案会很好，但我不介意我可以使用[visual-studio-2012](/questions/tagged/visual-studio-2012 "显示标记为“visual-studio-2012”的问题")或类似的开源编译器编译的任何语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:45:30.927

您可以编写一个包装器并将其与您的媒体文件相关联。

这将间接启动 VLC，然后在它关闭后移动文件。

VLC 将流列表作为参数，附加`vlc://quit`到播放列表的末尾以自动退出 VLC。

用 C# 编写的包装器会更灵活，但这里有一个批量的快速示例。

```
set VLC=C:\Program Files\VideoLAN\VLC\vlc.exe
set FILE=Tig Notaro - Live.mp3
start "VLC" /WAIT "%VLC%" "%FILE%" vlc://quit
echo VLC has closed, I can move the file.
move "%FILE%" old/
pause 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T15:29:20.440

这是一个示例 C# 应用程序，可以执行您的要求。通过右键单击视频文件、选择打开方式并选择 C# 应用程序的可执行文件来启动它（您可以选中“始终使用所选程序打开此类文件”复选框以使更改永久生效）。

```
static void Main(string[] args)
{
    if (args.Length < 1)
        return;

    string vlc = @"C:\Program Files\VideoLAN\VLC\vlc.exe";
    string videoFile = args[0];
    string pathAffected = @"C:\Users\User1\Downloads";
    string destinationPath = System.IO.Directory.GetParent(pathAffected).FullName;
    destinationPath = System.IO.Path.Combine(destinationPath, @"Viewed\");

    Process vlcProcess = new Process();
    vlcProcess.StartInfo.FileName = vlc;
    vlcProcess.StartInfo.Arguments = "\"" + videoFile + "\"";
    vlcProcess.StartInfo.Arguments += " --play-and-exit";
    vlcProcess.Start();
    vlcProcess.WaitForExit();

    if (videoFile.IndexOf(pathAffected,
        StringComparison.InvariantCultureIgnoreCase) >= 0)
    {
        System.IO.File.Move(videoFile,
            System.IO.Path.Combine(destinationPath,
            System.IO.Path.GetFileName(videoFile)));

        if (IsSubfolder(pathAffected, 
            System.IO.Path.GetDirectoryName(videoFile)))
        {
            System.IO.Directory.Delete(
                System.IO.Directory.GetParent(videoFile).FullName, true);
        }
    }

} 
```

`IsSubfolder`我在[这个问题](https://stackoverflow.com/questions/3525775/how-to-check-if-directory-1-is-a-subdirectory-of-dir2-and-vice-versa)中找到了代码。

# php - Android/sencha/phonegap ajax 调用本地 php 文件返回整个代码？

> ID：14841727
> 
> 赞同：0
> 
> 时间：2013-02-12T20:59:49.993
> 
> 标签：php, android, ajax, cordova, sencha-touch

只是想知道是否有人在这里给我一点支持。我正在使用 phonegap 在 android 手机上运行 sencha 应用程序。在代码中，我正在对本地存储的 php 文件进行 ajax 调用，以检查文件是否存在......

```
 myRequest = Ext.Ajax.request({
                    url: 'resources/phpScripts/poifound.php',
                    method: 'GET',
                    params: {
                    pakname: packname,
                    poiident: poiid
                    },
                    success: function(response) {

                    console.log(response.responseText);

                    },
                    failure: function(response) {
                    console.log("failed");
                    }
                }); 
```

还有php文件……

```
<?php
   $pakname = $_GET["pakname"];
   $poiid= $_GET["poiident"];

   if (!file_exists('../../packages/' . $pakname .'/poisfound/' . $pakname . $poiid . '.txt')) {
    return "false";   
   }
   else {
    return "true";
   }

?> 
```

它不是在 LogCat 中记录“真”或“假”，而是实际上记录了整个 php 代码。在 chrome 中运行 sencha 应用程序时，它会返回“true”或“false”，并使用 echo 而不是返回。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:28:17.497

那是因为，您将 PHP 文件打包到 android 设备上。android 上没有 PHP 解释器。您需要一个运行 PHP 的服务器。

```
 myRequest = Ext.Ajax.request({
                url: 'http://myserver.com/resources/phpScripts/poifound.php',
                method: 'GET', [...] 
```

为了让您的生活更轻松，您需要将服务器添加到白名单：[http ://docs.phonegap.com/en/2.4.0/guide_whitelist_index.md.html](http://docs.phonegap.com/en/2.4.0/guide_whitelist_index.md.html)

# java - 无法实例化类：com.sun.enterprise.naming.SerialInitContextFactory 在进行查找时

> ID：14841738
> 
> 赞同：1
> 
> 时间：2013-02-12T21:00:45.620
> 
> 标签：java, jakarta-ee, jndi

我试图让这个独立的（不涉及服务器）JNDI InitialContext 查找工作。我得到了这个例外：

**无法实例化类：com.sun.enterprise.naming.SerialInitContextFactory**

```
try {  
    Hashtable <String, String> env = new Hashtable<String, String>();   
    env.put(Context.INITIAL_CONTEXT_FACTORY,
            "com.sun.enterprise.naming.SerialInitContextFactory");  
    env.put(Context.PROVIDER_URL,"localhost:1099");  
    env.put("java:comp/env/jms/RNCQueueConnectionFactory", 
            "javax.jms.QueueConnectionFactory");  
    env.put("Big", "Data");  
    Context jndiContext = new InitialContext(env);  
    jndiContext.lookup("java:comp/env/jms/RNCQueueConnectionFactory");  
    testval = (String) jndiContext.lookup("Big");
} catch (NamingException ne) {  
    System.out.println(ne.getMessage());  
} 
```

对我和我所阅读的内容而言，我可能没有正确设置我的上下文。有没有人成功设置过独立的 JNDI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-10T16:02:25.947

我有同样的问题。我正在使用一个 Maven 项目，我刚刚添加了以下依赖项：

```
 <dependency>
            <groupId>org.glassfish.main.common</groupId>
            <artifactId>glassfish-naming</artifactId>
            <version>4.1.1</version>
        </dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T13:12:47.233

JNDI 是一种用于访问命名和目录服务的 API。[JNDI 教程](http://docs.oracle.com/javase/jndi/tutorial/)可以让您快速了解 API 及其工作原理。

作为一个 API，JNDI 需要一个实现才能工作。在您的特定情况下，您需要找到带有 class 的 jar `com.sun.enterprise.naming.SerialInitContextFactory`。一旦你弄清楚它应该是什么 jar，你需要将它添加到`CLASSPATH`并重新运行应用程序。

这可能不是您访问 JNDI 服务所需要的全部，但至少可以帮助您克服最初的错误。请参阅文章和[JNDI 教程](http://docs.oracle.com/javase/jndi/tutorial/)。

# javascript - JavaScript 按键事件获取文本区域的结束值

> ID：14841739
> 
> 赞同：8
> 
> 时间：2013-02-12T21:00:49.807
> 
> 标签：javascript, mootools, dom-events, keypress, keyboard-events

我想知道是否有可能在`keypress`活动中获得最终结果？目前，我正在使用它，`keyup`因为它在用户在 texteara 中完成文本编辑*后被*激活，但我编写了一个使用 Mootools 库执行类似操作的方法：

```
input.addEvent("keypress", function (input) {
    var previous_result = this.value;
    var end_result = this.value + input.key;
}); 
```

但是，这种方法在处理特殊键（例如退格）时很糟糕，或者如果用户选择使用`CTRL`+ `a`&&`Backspace`在这种情况下输入元素的值不会是“空字符串”。

我很好奇，因为我观察到 Google 的搜索引擎在事件触发**之前发送 XMLHttpRequest 并改变页面。**`keyup`此外，他们使用的输入设法克服了我删除整个文本的问题，同时仍然享受`keypress`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T21:31:39.197

这将使它工作：

```
input.addEvent( "keypress", function ( input ) {    
    setTimeout(function () {
        input.value // returns the updated value
    }, 0 );    
}); 
```

**现场演示： http:** [//jsfiddle.net/yQQ5P/](http://jsfiddle.net/yQQ5P/)（我使用内置API，因为我不知道Mootools）

因此，您使用零超时作为产量。这使浏览器的 UI 线程有机会更新输入的值。

# android - 未触发 Android 通知操作 (PendingIntent)

> ID：14841740
> 
> 赞同：18
> 
> 时间：2013-02-12T21:00:54.330
> 
> 标签：android, android-intent, android-activity, android-notifications, android-pendingintent

我正在尝试在我的应用程序中添加一个通知操作项，该应用程序是一个音乐播放器。当流启动时，应触发通知，并且应在通知中显示流的停止按钮。到目前为止，通知工作正常，我遇到了停止操作项的问题。以下是它在启动流的服务中的声明方式：

```
Intent stopIntent = new Intent(this, MusicPlayerNew.class);
stopIntent.putExtra("STOP", "STOP");
PendingIntent stopPendingIntent = PendingIntent.getActivity(this, 0,
                stopIntent, PendingIntent.FLAG_UPDATE_CURRENT, null);
mBuilder.addAction(R.drawable.ic_stat_stop, "Stop", stopPendingIntent); 
```

现在在我的活动的 onResume() 方法中，我使用 getIntent().getStringExtra() 检查“STOP”额外内容，但我通过 getIntent() 检索到的意图没有设置额外内容:(

我还尝试检查发送广播（我有一个广播接收器，用于从服务通信到活动）

```
Intent stopIntent2 = new Intent(MusicPlayerNew.STOP_MEDIAPLAYER);
PendingIntent stopPendingIntent2 = PendingIntent.getBroadcast(this, 0,
                stopIntent2, PendingIntent.FLAG_UPDATE_CURRENT);
mBuilder.addAction(R.drawable.ic_stat_stop, "Stop", stopPendingIntent2); 
```

现在，如果活动当前处于前台，则此方法有效。如果活动在后台，停止按钮什么也不做:(

**编辑：** 我的 Activity 中有 BroadcastReceiver 作为私有类

```
private class DataUpdateReceiver extends BroadcastReceiver {
        @Override
        public void onReceive(Context context, Intent intent) {
..
}} 
```

在 onResume() 中为这个接收器注册我的应用程序：

```
intentFilter = new IntentFilter(STOP_MEDIAPLAYER);
registerReceiver(dataUpdateReceiver, intentFilter); 
```

暂停（）

```
unregisterReceiver(dataUpdateReceiver); 
```

现在，如果我从 onPause() 方法中删除取消注册，即使应用程序/活动不再处于前台，也会收到广播。但这是正确的方法吗？我认为我从网上的教程中得到了这个注册/取消注册的东西..

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2016-06-17T02:38:54.670

这是很晚的答案，但它可能会帮助某人：

您应该根据要运行的意图选择正确的待处理意图。这里有些例子：

对于以下**活动**使用：

```
Intent i = new Intent(this, YourActivity.class);
PendingIntent pi = PendingIntent.getActivity(this, 0, i, 0); 
```

用于以下**服务**：

```
Intent i = new Intent(this, YourService.class);
PendingIntent pi = PendingIntent.getService(this, 0, i, 0); 
```

对于以下**广播接收器**使用：

```
Intent i = new Intent(this, YourReciver.class);
PendingIntent pi = PendingIntent.getBroadcast(this, 0, i, 0); 
```

如果需要，您可能需要更改请求代码和标志

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-02-03T18:10:58.777

我在谷歌代码的这个线程中找到解决方案[https://code.google.com/p/android/issues/detail?id=61850](https://code.google.com/p/android/issues/detail?id=61850)

要修复它，您必须将`PendingIntent.FLAG_CANCEL_CURRENT`标志添加到您的`PendingIntent`.

```
PendingIntent stopPendingIntent2 = PendingIntent.getBroadcast(this, 0,
            stopIntent2, PendingIntent.FLAG_CANCEL_CURRENT); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-12-06T12:28:03.690

我今天遇到了这个问题。在我的例子中，它使用了来自先前意图实例的缓存意图附加，因为`pendingIntent`构造函数的所有参数都是相同的。我为此找到了两种解决方案...

1.  [使用Nik](https://stackoverflow.com/a/21534510/4218110)提到的 FLAG_CANCEL_CURRENT 。
2.  传递一个独特`requestCode`的`pendingIntent`如下

    ```
    PendingIntent pi = PendingIntent.getService(this, UNIQUE_ID, pi, 0); 
    ```

就我而言，第二种方法解决了这个问题，因为我需要保持以前的通知处于活动状态。可能这会帮助有类似问题的人。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-10-15T15:49:27.633

我今天遇到了这个问题，这是由于活动未注册或未添加到**AndroidManifest.xml**引起的。我以为我有它，但它不是。此外，通过尝试按其意图调用该操作，也没有记录任何错误。

我通过创建一个意图然后在不使用通知的情况下调用 startAcitivty(intent) 来解决这个问题。然后它给了我一个错误，说明清单中可能缺少该活动。

如果其他答案都没有解决您的问题，那么希望这会。通常棘手的问题是一些简单而愚蠢的事情的结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-29T18:51:08.167

除了使用广播接收器之外，您还应该使用服务并以这种方式在服务中声明新操作：

```
public final String ACTION_STOP = "yourpackagename.ACTION_STOP"; 
```

然后像这样创建你的意图：

```
Intent stopIntent = new Intent(this, YourService.class).setAction(YourService.ACTION_STOP);
PendingIntent stopPendingIntent = PendingIntent.getService(this, 0, stopIntent, 0); 
```

当然`startCommand`，如果 Intent 的 action 等于 ，请在服务的 function 中停止播放`ACTION_STOP`。

这应该可以解决问题；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-05-25T08:34:09.147

## 不要使用显式 Intent

在我的例子中，我创建了一个`BroadcastReceiver`在我的`Service`类中注册的动态上下文来监听通知动作。

```
 class MyService:Service(){

private val receiver: BroadcastReceiver = NotificationActionReceiver()
...

inner class NotificationActionReceiver : BroadcastReceiver() {
        override fun onReceive(context: Context, intent: Intent) {
            ...
        }
 }

override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        ...
        registerReceiver(receiver,IntentFilter("SOME_ACTION"))
        return super.onStartCommand(intent, flags, startId)
 }

override fun onDestroy() {
        ...
        unregisterReceiver(receiver)
        super.onDestroy()
 } 
```

`PendingIntent`有明确的`Intent`

```
 val nextIntent = Intent(this, NotificationActionReceiver::class.java) //Explicit Intent
val nextPendingIntent: PendingIntent= PendingIntent.getBroadcast(this,0x11,nextIntent, PendingIntent.FLAG_CANCEL_CURRENT) 
```

但是，使用此设置，`BroadcastReceiver`从未触发。

### 为了使它起作用，我需要用隐含的意图替换我的显式意图

所以我所做的只是，

```
 val nextIntent = Intent("SOME_ACTION") //Implicit Intent
val nextPendingIntent: PendingIntent= PendingIntent.getBroadcast(this,0x11,nextIntent, PendingIntent.FLAG_CANCEL_CURRENT) 
```

注意：*由于`BroadcastReceiver`是动态上下文注册的，因此您不必担心对隐式意图的限制*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-12T21:34:30.230

当广播在后台时，您不会收到广播，因为您正在取消注册 onPause。将 unregisterReceiver 代码移至 onDestroy 函数。这只会在活动被销毁时调用。或者，您可以在预期事件发生后取消注册。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-30T03:16:44.523

这里有多个问题：

**第 1 部分：为什么您的意图没有收到额外的“STOP”？** 虽然在您提供的代码中没有看到，但我想确认您是否使用标志 FLAG_ACTIVITY_SINGLE_TOP 来表示通知意图？如果是这样，您在活动中收到的意图将是启动活动的意图，因此“停止”额外内容将不可用。您将需要扩展`onNewIntent()`这种情况（发送新意图的地方）。[更多信息在这里](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29)。
如果你没有使用过 FLAG_ACTIVITY_SINGLE_TOP，那么这意味着在点击通知时会创建一个新的活动，在这种情况下，Intent 必须具有“STOP”参数。如果您可以提供所有相关代码，我可以为您提供更好的帮助。

**第 2 部分：使用广播接收器** 正如您已经发现的那样，这并不简单。您需要在 onDestroy 中注销，如果您的活动被用户关闭，则 onDestroy 可能会被调用，并且您的广播接收器可能在用户点击通知时未激活。如果您根本不取消注册，它似乎可以正常工作，但这是内存泄漏，GC 可能随时清理，这可能导致您的程序崩溃，即，您必须取消注册。如果您需要使用广播接收器方法，则需要有一项服务来执行此操作，并且服务有其自身的缺陷 -> 由系统重启、电池耗尽等。我强烈建议您使用第一种方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-20T19:37:14.157

我有一个非常相似的问题，但有一个非常不同的解决方案。`<service android:enabled="false"></service>`如果您已在 manifest.xml 文件中声明，则也不会触发待处理的意图。

替换`android:enabled="false"`为`android:enabled="true"`

这可能不是问题的直接问题。但是，如果您在 android studio 中使用默认模板创建服务，它会自动将这些属性添加到服务中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-20T14:27:24.360

对我来说，解决方案是设置意图标志：

```
resultIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |
                Intent.FLAG_ACTIVITY_CLEAR_TASK); 
```

# html - 图层滑块 WP 100% 宽度和高度

> ID：14841742
> 
> 赞同：1
> 
> 时间：2013-02-12T21:00:59.247
> 
> 标签：html, wordpress, fullscreen

有人可以指导我如何获得全屏图像，以便它像提供的链接一样保持在水平和垂直的中心。

[http://css-tricks.com/examples/FullPageBackgroundImage/progressive.php](http://css-tricks.com/examples/FullPageBackgroundImage/progressive.php)

我只是在背景位之后，我需要一个 div 中的图像，就像在示例中一样在 css 中，因为我将它用于 wordpress 中的滑块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-28T05:36:32.963

为了使您的 LayerSlider 以 100% 的高度和宽度显示，请将“滑块设置”中的“滑块高度”属性留空，然后使用如下脚本设置高度：

```
<script type="text/javascript"> 
    function resize()
    {
        var heights = window.innerHeight;
        document.getElementById("layerslider_1").style.height = heights + "px";
    }
    resize();
    window.onresize = function() {
        resize();
    };
</script> 
```

在结束 body 标记之前将脚本插入到 footer.php 文件中。如果您的滑块 ID 不是 1 号，则将“layerslider_1”更改为正确的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:05:31.320

您可以为 div 元素添加样式

```
<div style="background: url(images/xyz.jpg) no-repeat center center fixed;">...</div> 
```

我刚刚从您的示例页面中取出 css 并复制/粘贴！

# html - 从 localStorage 中删除最旧的记录

> ID：14841746
> 
> 赞同：0
> 
> 时间：2013-02-12T21:01:20.223
> 
> 标签：html, local-storage

我有一个保存到 localStorage 的 JS 应用程序。没什么大不了的。但是，存储的是相当大的 JSON。10MB 很快消失。我想做的是，如果存储已满，请删除最旧的记录。

有没有办法可靠地找到 localStorage 中最旧的记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:24:32.080

你可以做： `localStorage.removeItem(localStorage.key(0));`

您在**localStorage.key**中指定一个整数来获取索引键的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:21:49.637

并非如此，localStorage 没有任何内置功能可以处理这个问题。您总是可以自己在 localStorage 之上构建一个层；一个扩展 localStorage 的层，还可以跟踪每个键的更改时间，以便您知道哪个是最旧的记录。

# java - 为什么我会收到 IOException: 创建 PDF 时找不到 PDF 标头签名？

> ID：14841747
> 
> 赞同：1
> 
> 时间：2013-02-12T21:01:20.313
> 
> 标签：java, pdf, itext

我试图创建一个带有空页面的 PDF 文件，但是`java.io.IOException: P PDF header signature not found`当我试图读取临时文件时代码会抛出。为什么？

相关代码：

```
Document testDoc = new Document();
File testFile = File.createTempFile("pdfTemp", ".tmp");
String test = testFile.getName();
PdfWriter testWriter = PdfWriter.getInstance(document, new FileOutputStream(test));
testDoc.open();
for (int x=1; x<=pdfReader.getNumberOfPages(); x++){
    testWriter.setPageEmpty(false);
    testDoc.newPage();
}
testDoc.close();
PdfReader testReader = new PdfReader(test); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:20:08.717

这可能是编码问题。您的代码使用

```
PdfWriter testWriter = PdfWriter.getInstance(document, new FileOutputStream(test)); 
```

但是`document`变量没有在任何地方声明。我怀疑您打算改用以下内容：

```
PdfWriter testWriter = PdfWriter.getInstance(testDoc, new FileOutputStream(test)); 
```

# eclipse - 在 Papyrus UML 模型中使用 MARTE GQAM 原型

> ID：14841748
> 
> 赞同：5
> 
> 时间：2013-02-12T21:01:22.570
> 
> 标签：eclipse, uml, papyrus

我正在尝试使用 MARTE GQAM 刻板印象对模型的某些元素进行刻板印象，但在为它们的某些属性分配值时遇到了麻烦。例如，我将两条生命线之间的消息定型为 <>。我想为其 hostDemand 属性分配一个值，该属性应为 NFP_Duration 实例。我看不到如何使用 Papyrus 编辑器创建 NFP_Duration 实例并将其分配给 hostDemand 属性。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-14T13:03:33.413

在 Topcased 5.3.1 和 Modelio 3.1.1 下，我只是将这些持续时间添加为字符串...

# c# - 服务器 500：挂起的安全对话过多

> ID：14841751
> 
> 赞同：7
> 
> 时间：2013-02-12T21:01:31.783
> 
> 标签：c#, .net, wcf

我有一个相当简单的 WCF Web 服务，使用 .Net 3.5 托管在 IIS Express（最终成为完整的 IIS）中。服务方法相当无趣。

```
[ServiceContract]
public class MySvc
{
    [OperationContract]
    public Stuff MyMethod(string input)
    {
        Stuff result = DoSomething();
        return result;
    }
} 
```

服务配置也相当通用：

```
<system.serviceModel>
    <services>
        <service behaviorConfiguration="MySvcBehavior" name="MySvc">
            <endpoint address="" binding="wsHttpBinding" contract="MySvc">
                <identity>
                    <dns value="localhost"/>
                </identity>
            </endpoint>
            <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="MySvcBehavior">
                <serviceMetadata httpGetEnabled="true"/>
                <serviceDebug includeExceptionDetailInFaults="false"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

该服务由 ASPX 应用程序中的代码隐藏使用。有一个服务参考，导致一些同样无趣的代码。

```
MySvcClient svc = new MySvcClient();
Stuff result = svc.MyMethod("foo"); 
```

只要一次一个请求，一切正常，客户端代码得到预期的结果。耶。

当我进行一些非常原始的压力测试时，问题就来了。我在浏览器中加载客户端 ASPX 页面，然后按住 F5 键。观察 IIS Express 窗口，起初结果返回状态 200，但几分钟后我开始看到状态 500。此时，服务只会响应状态 500，直到我重新启动 IIS Express。（基于等待大约 10 分钟。）

在客户端代码中设置断点，我看到完整的返回消息是**“服务器上有太多待处理的安全对话。请稍后重试。”**

在服务器代码中设置断点，我发现我的代码甚至没有被调用。所以它在调用和我的代码的实际开始之间的某个地方失败了。

我的在线搜索并不是很有希望，主要导致[编写自定义绑定](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/a8f82f1d-e824-474e-84ef-b5e9ba7eca18/)以覆盖 maxPendingSessions 属性和一个以“有人告诉我有一个 [未命名] 配置文件设置”开头的线程的相同建议，然后导致声称微软承认这是一个错误的链接断开。

关于 maxPendingSessions 属性的链接确实提到了 128 个连接的限制，超时时间为两分钟，我当然可以看到我的测试方法将在哪里中断一些连接。这是公认的糟糕测试方法的预期结果吗？或者可以在配置中做些什么来改善这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T16:58:58.617

听起来您在服务器上有无数个打开的连接 - 由于客户端没有使用“使用”进行连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T09:38:37.710

我首先建议在服务器类机器上的完整 IIS 上进行测试。我不会信任客户端操作系统上的 IIS Express 来进行性能测试。
如果仍然很糟糕，请查看限制以限制 maxConcurrentCalls。[http://msdn.microsoft.com/en-us/library/vstudio/ms735114(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/vstudio/ms735114(v=vs.90).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T16:06:14.150

**对于那些推荐 using 语句的人：您不应该使用 using 语句来关闭客户端。**

请参阅[http://msdn.microsoft.com/en-us/library/aa355056.aspx](http://msdn.microsoft.com/en-us/library/aa355056.aspx)

而不是关闭客户端，您应该使用以下代码段：

```
try
{
    ...
    client.Close();
}
catch (CommunicationException e)
{
    ...
    client.Abort();
}
catch (TimeoutException e)
{
    ...
    client.Abort();
}
catch (Exception e)
{
    ...
    client.Abort();
    throw;
} 
```

如果您不想缓存显式异常，或者只是一个普通的捕获。有时您希望捕获显式异常，因为如果通信对象没有出现故障，您可以重试您的操作，这将提供资源的最佳使用。

对于您在服务器上挂起对话的问题，一旦您正确关闭客户端，这将变得不那么常见，但是如果您的服务器端代码有长时间运行的操作并且客户端正在排队，您可能仍然会看到它。在这种情况下，要增加 MaxPendingChannels 的值，您要么必须在客户端和接收方配置文件中使用自定义绑定，要么在启动服务之前以编程方式修改接收方的绑定。如果您使用的是 .NET 3.5，则 MaxPendingChannels 的默认值实际上是 4。对于 .NET 3.0，该值据称为 128。在我看来，两者都很低。

请参阅[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/745b95d2-1480-4618-89f5-1339d6ee228d](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/745b95d2-1480-4618-89f5-1339d6ee228d)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T08:18:34.417

与目标服务器的连接太多。有一些方法可以以正确的方式关闭连接。已经提到的是，应该始终`using`围绕 WCF 代理声明。

除此之外，还有（是？）一个错误，要求您在打开代理时提出请求。创建代理时，它给代理大约两分钟的机会向服务器发出请求。如果是这样，它将使计时器无效，从而允许清理代理。如果没有发出请求，代理在实际关闭连接之前仍会等待超时。这次可能不是这种情况，但为了完整性而添加。

解决此问题的一种方法是使用 (ASP.NET) 缓存。`System.Web.Caching.Cache`是一个很好的候选人。它允许您缓存给定（最终滑动）期间的结果。这样，每 2 分钟只发出一个请求。这使得网站/网络服务非常可扩展。例如，如果每分钟有 1000 个请求，则同一服务调用只使用一个连接。

另一种方法是，如果请求很昂贵且不值得等待，则提前发出请求并缓存响应（ala cron、任务调度程序或只是另一个线程）。这将允许页面快速检索。

除此之外，应该正确配置服务器。无需从一个客户端打开 128 个并发连接。尝试将其限制为，例如每个客户端 8 个连接。这允许同时处理多个客户端。也尝试设置一个体面的超时。等待 5 分钟让客户端关闭其连接，并不会真正增加吞吐量。

还要考虑[消息的异步处理](http://www.codeproject.com/Articles/234085/Fixing-WCF-to-build-highly-scalable-async-REST-API)。它使用服务必须等待 I/O 来处理其他连接的时间。我看不到 WCF 服务的作用，所以这可能不相关。

# css - 谷歌字体在某些 Mac 上不起作用

> ID：14841753
> 
> 赞同：0
> 
> 时间：2013-02-12T21:01:44.760
> 
> 标签：css, html, osx-mountain-lion, google-font-api

我在我的 HTML 中使用嵌入的谷歌字体作为我网站的标题。它适用于大多数计算机上的所有浏览器，但不适用于某些 Mac。我为此阅读了一个解决方案，该解决方案建议将声明 !important 添加到我的 CSS 中我调用字体的行中，但这不起作用。我家里有两台mac，我的和我的男朋友。该字体在他的所有浏览器中都可以正常工作，但在我的浏览器中它只能在 Firefox 中使用。我们都是奔跑的山狮。有什么建议么？？

这是该网站的链接：http: [//nataliearriolaphotography.com](http://nataliearriolaphotography.com)

我也尝试通过我的 CSS 中的 @import 方法执行此操作，但它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:13:43.927

页面使用 Lato 字体家族的粗细 100 字体，但是声明为字体中的文本具有不同的字体粗细：默认粗细`normal`，即 100。页面上指定的辅助字体是`san-serif`，这是一种不存在的字体 (`sans-serif`将表示浏览器的默认无衬线字体）。不同的浏览器可能会根据情况以不同的方式处理此问题。

所以你应该添加

```
font-weight: 100; 
```

到元素的 CSS 规则。

# bash - Shell 脚本错误：语法错误：“（”意外

> ID：14841754
> 
> 赞同：1
> 
> 时间：2013-02-12T21:01:45.680
> 
> 标签：bash, shell, scripting

有人可以向我解释为什么以下 shell 脚本行会引发此错误：

语法错误：“（”意外

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:08:12.390

Shell 脚本期望以以下模式设置变量：

```
VARIABLE=value 
```

你不能在那里有任何额外的 = 标志。但是，您可以像这样执行其他脚本：

```
VARIABLE=$(basename $1)
VARIABLE=`basename $1` 
```

任何一个都有效。

在你的情况下，我不知道你在做什么，但它根本不对。我的猜测是你需要这样做：

```
env LD_LIBRARY_PATH=$(basename $1) 
```

# asp.net - 如何使用 Dropdown Extender 触发 OnSelectedIndexChanged 事件

> ID：14841755
> 
> 赞同：1
> 
> 时间：2013-02-12T21:02:13.970
> 
> 标签：asp.net, dopostback, dropdownextender

我正在尝试使用 AjaxToolKit 的 dropdownlistextender 构建一个下拉列表。我有以下标记：

```
<asp:Label ID="ddTest" runat="server" Text="Transactions" Width="300px" BorderColor="#C0C0C0" CssClass="selecter"/>
    <ajaxToolkit:DropDownExtender runat="server" ID="ddeSections"
              TargetControlID="ddTest" DropDownControlID="panelItems" HighlightBackColor="Silver" 
              DropArrowBackColor="white" HighlightBorderColor="Silver"/> 
```

以及“列表”项目的以下内容：

```
 <table runat="server" id="ctlOptions" class="options" cellspacing="2" cellpadding="2" border="1">
     <tr><td class="item" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" onclick="clickIt(this)">Transactions</td></tr>
     <tr><td class="item" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" onclick="clickIt(this)">The second option</td></tr>
     <tr><td class="item" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" onclick="clickIt(this)">The third option</td></tr>
     <tr><td class="item" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" onclick="clickIt(this)">The fourth option</td></tr>
     <tr><td class="item" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" onclick="clickIt(this)">The fifth option</td></tr>
   </table> 
```

我的 JavaScript 看起来像这样：

```
function mouseOver(obj) {
    if (obj) obj.className = 'itemOver';
}

function mouseOut(obj) {
    if (obj) obj.className = 'item';
} 
```

其中**item**和**itemOver**是适当样式的 CSS 类。问题是我希望我的*onclick*事件在服务器上触发*SelectedIndexChanged*类型的事件。我试过这个功能：

```
function clickIt(obj) {
    var ddTest = document.getElementById("ctl00_ContentPlaceHolder1_ddTest");
    var selVal = '';
    if (ddTest) {
        selVal = obj.firstChild.nodeValue;
        ddTest.firstChild.nodeValue = selVal;
        __doPostBack('<%=ddSections.ClientID %>', '');
    }
} 
```

*ddSections*是`asp:Dropdown`我试图触发的 OnSelectedIndexChanged 事件。

这会触发页面级回发，但不会触发我想要触发的**ddSections_SelectedIndexChanged服务器端方法。**顺便说一句，ddSections 将被隐藏。

请你提供一些建议。我花了三天时间试图弄清楚这一点，却空手而归。随意重新格式化以提高可读性。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:01:20.167

我问这个问题已经两周了，我假设没有人会回答，所以为了记录，我将发布我是如何实际解决这个问题的。

1.  我从使用 html 表更改为使用无序列表。（我之前忽略了一个选项，因为我认为`<UL>`.

2.  我添加了两个隐藏字段，一个用于触发事件是否已触发，另一个用于存储所选值。

`<asp:HiddenField runat="server" ID="hidSelectionChanged" Value="false"/>` `<asp:HiddenField runat="server" ID="hidSelectionValue" Value=""/>`

我创建了“更改”事件，如下所示：

```
function onchange(param) {
    var chg = document.getElementById('<%=hidSelectionChanged.ClientID%>');
    var val = document.getElementById('<%=hidSelectionValue.ClientID%>');

    if (chg) {
        chg.value = 'true';
    }
    if (val) {
        val.value = param;
    }

    __doPostBack('pnlResults', '');
} 
```

然后在每个我都有`LI`这个`UL`代码：

```
<li class="ddl_li"><a href="javascript:onchange('Summary_1')">Summary</a></li> 
```

结果是一个完整的页面回发，但是在`Page_Load`页面的情况下，我现在可以检查`hidSelectionChanged.Value`是否由我的下拉菜单触发了回发，并且我可以检查`hidSelectionValue.Value`以获取所选值。

最后，一切顺利。

# c# - 处理这种关系的最佳方式

> ID：14841759
> 
> 赞同：1
> 
> 时间：2013-02-12T21:02:30.277
> 
> 标签：c#, nhibernate

系统有帐户，并且具有每个帐户（用户）必须同意的条款和条件。如果将来更改条款，用户将收到警报，并根据他的选择（同意/不同意），帐户将保持活动或锁定。

现在，我想跟踪用户过去同意的条款列表。

```
Account.cs
public Guid Id {get; set;}
public IList<Terms> Terms {get; set;}
public string Name {get; set;}
public bool IsActive {get; set;}
public DateTime AgreedToTerms {get; set;}

Terms.cs
public Guid Id {get; set;}
public string Text {get; set;}
public DateTime Create {get; set;} 
```

我还没有任何数据库表。

我在正确的轨道上吗？我需要建议或想法，您将如何处理这种关系？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:16:42.960

如果我理解的话，每个用户要同意的条款更多，所以这称为多对多关系（每个用户必须同意许多条款，一个条款可以被许多用户同意）。在这些情况下，需要一个连接实体。在您当前的情况下，连接实体代表协议行为，因此它看起来像这样：

```
Account.cs
public Guid Id {get; set;}
public string Name {get; set;}
public bool IsActive {get; set;}
public IEnumerable<AgreedToTerms> AgreedTerms { get; set; }

Terms.cs
public Guid Id {get; set;}
public string Text {get; set;}
public DateTime Created {get; set;}
public IEnumerable<AgreedToTerms> AgreedUsers { get; set; }

AgreedToTerms.cs
public Account User { get; set; }
public Terms Terms { get; set; }
public DateTime DateOfAgreement {get; set;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:17:28.713

我会做一些细微的修改：

将以下内容添加到您的 Account 类：

```
public Dictionary<Guid, bool> AcceptedTOS {get; set;} 
```

`Guid`是您的条款类中的字段`Id`，`bool`是他们是否接受。您可以做一个简单的检查，如果其中任何一个是错误的来锁定帐户。

```
if (AcceptedTOS.Any((x)=>x.Value == false)) 
```

现在，此解决方案仅在您想将所有内容保存在 c# 中时才有效。如果您将条目存储在数据库中，我建议您使用`szelpe`'s answer。

不使用`IList`，只使用`List`。除非有人能证明我错了，否则我认为使用接口而不是类没有任何意义。

我建议你使用`DateTimeOffset`而不是`DateTime`. 这使日期以及时区（这是重要部分）的精度更高。

您可能不想将 TOS 存储为字符串并让它在内存中飞来飞去。根据您的需要，它可能会变得非常大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:14:06.190

我只需向条款对象添加一个布尔属性，指示条款是否已被接受。您仍然可以在 Account 类上的同一列表中的术语，并在需要时查询列表中未接受的术语。如果您需要对列表中条款对象的更改进行数据绑定，则可能会涉及更多内容，具体取决于您的前端编写的内容（WinForms、WPF 等）。

# c# - 第一个 X 日期时间值和 Y 轴之间的差距

> ID：14841761
> 
> 赞同：0
> 
> 时间：2013-02-12T21:02:34.337
> 
> 标签：c#, winforms, charts, mschart

在我的应用程序中，我使用 mschart 使用带有日期时间值的 ax 轴和带有数字（双精度）值的 Y 轴来显示数据。

但是，我注意到 Y 轴和第一个 X 值之间有一个小间隙：

![在此处输入图像描述](../Images/d2b31007edc0eb7f9f2804c459e1c6ec.png)

有没有办法强制图表完全在 Y 轴上开始？

**编辑：**这是我用来填充我的系列的：

```
foreach (AggregatedValue value in line.Value)
{
    series.Points.AddXY(value.TimeStamp.ToLocalTime(), value.Value);
} 
```

聚合值是一个包含 2 个 x、y 属性、TimeStamp（日期时间）和 Value（双精度）的类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:04:32.227

我找到了答案，我必须手动设置 x 轴的最小值和最大值，使用

```
chart.ChartAreas[0].AxisX.Minimum and chart.ChartAreas[0].AxisX.Maximum 
```

# asp.net - 带有 asp.net 的 youtube api (401) 未经授权的错误

> ID：14841763
> 
> 赞同：1
> 
> 时间：2013-02-12T21:02:40.743
> 
> 标签：asp.net, youtube-api, unauthorized

每次我尝试使用 youtube api 时都会收到此错误：

> 远程服务器返回错误：(401) Unauthorized。

在这段代码上：

```
public static YouTubeRequest AuthRequest()
    {
        YouTubeRequestSettings Setting =
            new YouTubeRequestSettings("app", "key", "email", "pass");
        Setting.Timeout = 99999999;
        YouTubeRequest _request = new YouTubeRequest(Setting);
        return _request;
    } 
```

我在这里获得了密钥：[http ://code.google.com/apis/youtube/dashboard](http://code.google.com/apis/youtube/dashboard)

以及电子邮件和密码，我检查了几次，它们工作正常。

我还在这里注册了我的应用程序：[https ://code.google.com/apis/console](https://code.google.com/apis/console)

但是每次我尝试使用请求时都会出现错误，这是什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:42:21.590

`YouTubeRequestSettings`我不能发表评论，您也没有提到这一点，但是您是否在构造方法中将“app”替换为您的应用程序名称？将代码保留为“app”将阻止访问。

**编辑**：我查看了 YouTube API 的[.NET 页面](https://developers.google.com/youtube/2.0/developers_guide_dotnet)，但找不到您正在使用的构造函数。他们列出的唯一构造函数是：

*   `YouTubeRequestSettings("example app", clientID, developerKey)`
*   `YouTubeRequestSettings("example app", clientID, developerKey, (String) SessionToken)`
*   `YouTubeRequestSettings("example app", clientID, developerKey, username, password)`
*   `YouTubeRequestSettings("NETUnittests", this.ytClient, this.ytDevKey, this.ytUser, this.ytPwd)`

# android - 用PhoneGap for eclipse“掌声”的扩展制作的两个不同的应用程序被替换

> ID：14841768
> 
> 赞同：0
> 
> 时间：2013-02-12T21:02:46.063
> 
> 标签：android, applaud

我从 Eclipse 导出我的应用程序，app_name 是“ANSPE”。我正常安装。后来，我导出了另一个名为“Valora tu Vida”的应用程序。当我想安装第二个应用程序时，我收到一条消息“覆盖另一个应用程序”。ANSPE 不存在，“Valora tu Vida”安装正常。

我对两个应用程序使用相同的密钥库，但每个应用程序使用不同的密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T00:23:56.920

重命名包名，也许你叫他们一样

# php - php标头重定向不起作用

> ID：14841769
> 
> 赞同：0
> 
> 时间：2013-02-12T21:02:55.890
> 
> 标签：php, html, redirect, header

我创建了一个邮件表单。PHP 页面读取输入，将其发送到邮件，然后它应该重定向到某个页面。很直接，以前做过。邮件被发送，但您不会被重定向。

HTML 表单：

```
<form action="mailversturen.php" method="post">
<input type="text" name="naam" placeholder="Naam" class="inputtype" /><br />
<input type="text" name="email" placeholder="Email" class="inputtype" /><br />
<textarea name="bericht" placeholder="Bericht"></textarea>
<input type="reset" value="Reset" class="buttontype" />
<input type="submit" value="Verstuur" class="buttontype" />
</form> 
```

PHP代码：

```
<?php
$name = $_POST['naam'];
$email = $_POST['email'];
$message = $_POST['bericht'];

$to = "name@domain.com";
$subject = "Bericht van $name";
$headers = "From: $email \r\n";

mail($to,$subject,$message,$headers);

header('Location: http://www.newlocation.nl/');
?> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:04:24.410

尝试`@ob_start();`在您的开始`<?php`标签之后添加。

这将打开输出缓冲。我将它与所有`header(...)`重定向结合使用。

# java - 开发还可以运行 Google App Engine 的 Java Swing 应用程序？

> ID：14841770
> 
> 赞同：-2
> 
> 时间：2013-02-12T21:02:56.407
> 
> 标签：java, swing, google-app-engine, architecture

在这一点上主要是头脑风暴，经过一些研究，并不能真正找到关于这个话题的太多信息。

我正在设计一个 Swing 应用程序，它将有一个用于存储的数据库后端，并且也使用本地文件系统来存储 BLOB。此应用程序不会占用 CPU、存储或 GUI 性能密集型，它只是用于电子项目管理的专用数据库应用程序。

我的理想目标是拥有一个无需任何更改即可在 JVM 和 GAE 中执行的代码库。我知道 App Engine Datastore 是非关系型的，所以我知道我不能将 SQLite 用于桌面应用程序。我必须使用[MongoDB](http://www.mongodb.org/)或[Hypertable 之](http://hypertable.com/)类的东西。

该程序将在 GAE 上为 1 对多用户和 1 对多用户本地运行。

编辑：添加了 CRUD 要求。

*   创建或添加新项目、部件或 BLOB。
*   阅读、检索、搜索或查看现有项目、部件、原理图或任何类型的 BLOB。
*   更新/克隆或编辑现有项目、部件等。
*   删除/停用现有项目、部件等。

编辑2：简而言之，我想知道这是否可能？如果您完成了可以在桌面或 App Engine 上执行的项目。我想知道您使用了哪些工具、框架、库；即使您必须使用完全自主研发的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:45:01.083

直接在 GAE 中托管未经修改的 Swing 应用程序是不可能的。

您可以做的是让您的 swing 应用程序与[部署到 GAE 的 servlet](https://developers.google.com/appengine/docs/java/runtime)对话，并处理您的 swing 应用程序和 GAE 数据库之间的通信。

在 swing 应用程序中，您将查询 servlet 以获取数据，而不是使用任何数据库。GAE 托管的 servlet 处理请求、查询 GAE 数据库、对结果进行编码并将其流式传输回客户端。Swing 应用程序接收响应并做出相应反应。在摇摆中，类似：

```
HttpClient client = new DefaultHttpClient();
HttpPost post = new HttpPost("http://localhost:8080/YourApp/YourAction");

try {
    List<NameValuePair> params = new ArrayList<NameValuePair>(1);
    params.add(new BasicNameValuePair("name", name));
    post.setEntity(new UrlEncodedFormEntity(params));

    HttpResponse response = client.execute(post);

    HttpEntity entity = response.getEntity();
    // Server response as stream
    InputStream inputStream = entity.getContent();
} catch (ClientProtocolException cpe) {
    cpe.printStackTrace();
} 
```

如果您走这条路，请记住始终在[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)之外发出您的服务器请求（使用 SwingWorkers 很容易做到）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T22:54:43.437

我认为您不能在 GAE 中使用 swing 组件，因为它不在白名单上（[https://developers.google.com/appengine/docs/java/jrewhitelist](https://developers.google.com/appengine/docs/java/jrewhitelist)）

# objective-c - NSTextField/NSTextFieldCel 文本内的阴影

> ID：14841776
> 
> 赞同：2
> 
> 时间：2013-02-12T21:03:20.073
> 
> 标签：objective-c, cocoa, core-graphics, shadow, nstextfield

我已经尝试了一两天来尝试在 NSTextField 的文本内绘制阴影（并使前景色透明，所以你看到的只是文本内的阴影）。我还没有达到理想和实际的结果。我唯一的成功是将文本转换为`NSBezerPath`，从 NSTextFieldCell 的框架中减去它并使用该`setClip`方法进行剪辑（`addClip`在这种情况下还不够，它会留下背景）。不幸的是，将文本转换为 an`NSBezerPath`会使文本的边缘看起来参差不齐且过度拉直。是否有一种有效且体面的方法可以使用 CoreGraphics 蒙版和剪辑来实现这一点，因为我无法实现这一点。

我要寻找的一个非常相似的效果是在 Xcode IDE 中，如果您没有打开调试会话并转到调试器导航器，它会在子类 NSTextField 中显示“无调试会话”，它用 a 绘制文本里面的影子。这几乎就是我所追求的。关于从哪里开始以及如何做到这一点的任何见解都会很棒。

粘贴箱我当前的代码（工作，但次优，不工作）： http: [//pastebin.com/4pTv8ZWm](http://pastebin.com/4pTv8ZWm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:20:30.153

你玩过 IB 中 NSTextField 的 shadow 属性吗？您应该能够在文本上使用稍微偏移的阴影效果以及正确混合 Alpha 透明度来获得非常接近的效果。

# c++ - 仅在 g++ 中指定包含路径以提升到一个位置

> ID：14841780
> 
> 赞同：4
> 
> 时间：2013-02-12T21:03:25.033
> 
> 标签：c++, makefile, g++, include-path

我正在开发一个使用 boost 库的代码库。但是，我最近在新用户的机器上构建基础时遇到了问题。我能够将问题归结为以下问题。下面是构建系统的样子：

```
/root
    /SubModules_with_Makefiles_and_Code
    /thirdparty/boost 
```

子模块代码将引用像这样的 boost 内容（例如）：

```
#include <boost/property_tree/ptree.hpp> 
```

并且子模块 make 文件将构建这样的代码（例如）：

```
g++ -c -o code.o code.cpp -I/root/thirdparty/boost 
```

我们的 3rd 方 boost 库是 1.37 版。但是，一些模块已经开始使用更高版本的 boost。这个问题已被掩盖，因为构建这些模块的机器包含安装在 /usr/include/boost 中的 boost 1.41。

问题来了，因为新用户的机器没有在 /usr/include 中安装 boost 1.41。理想情况下，我希望 g++ 在第三方目录中寻找提升，而不是在其他任何地方。这样，我们可以更严格地控​​制代码库的构建方式。

-I<dir> 在查找期间将 <dir> 放置在系统包含之前，但仍会查看系统包含，并且可以根据机器安装更高版本的 boost。我可以抑制查看系统包含的内容，但这将是一个真正的痛苦。

除了替换之外，还有什么聪明的方法可以解决这个问题：

```
#include <boost/something.hpp> 
```

至

```
#include <thirdparty/boost/something.hpp> 
```

? 如果有帮助，我在 redhat linux 上使用 gnu make 3.81 和 g++ 4.4.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:12:54.230

查看“包含路径”命令行选项 (-I)。您可以设置搜索包含文件的位置。文档[在这里](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:15:52.513

您可能想查看 gcc 手册的第 2.3 节：http: [//gcc.gnu.org/onlinedocs/cpp/Search-Path.html](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)

您正在寻找的编译器开关很可能是

```
-nostdinc 
```

但最好自己看看。

编辑：哎呀，我刚刚看到你不想禁用默认搜索路径 - 在这种情况下，只需使用 -I 开关：

> 您可以使用 -Idir 命令行选项添加到此列表。在默认目录之前，按从左到右的顺序搜索所有由 -I 命名的目录。

# mysql - 如何在 MySQL 中更新过期日期？

> ID：14841782
> 
> 赞同：1
> 
> 时间：2013-02-12T21:03:33.873
> 
> 标签：mysql, magento, sql-update, magento-1.7, coupon

所以，我需要在我们的数据库中重置一堆优惠券代码的到期日期。我们的到期日期是字段“to_date”，显示如下：to_date = '2013-04-14'

我需要将 to_date 设置为 from_date 之后的 28 天。所以基本上，是这样的：

```
UPDATE salesrule
SET name = 'New coupon code', to_date = 'from_date + 28 days' 
```

我知道这适用于一个简单的 int 值，但我不确定如何做到这一点，因为数据显示为实际日期。我无法控制日期本身的显示方式，这是 Magento 的内置功能。

说到 MySQL，我是个大菜鸟，但我做了一些研究，发现了格式函数：FORMAT(Now(),'YYYY-MM-DD') 我觉得这可能是关键...有人可以指出正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:05:26.357

```
UPDATE salesrule
SET name = 'New coupon code', to_date = DATE_ADD(from_date, INTERVAL 28 DAY); 
```

`DATE_ADD()`有关此功能的更多信息：

[https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:05:07.110

```
to_date = DATE_ADD(from_date, INTERVAL 28 DAY) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T21:07:42.753

看看[这个](https://stackoverflow.com/questions/2810516/mysql-how-to-add-one-day-to-datetime-field-in-query)问题，它会做你想要的。

```
You can use the DATE_ADD() function:

... WHERE DATE(DATE_ADD(eventdate, INTERVAL -1 DAY)) = CURRENT_DATE
It can also be used in the SELECT statement: 
```

> 选择 DATE_ADD('2010-05-11', INTERVAL 1 DAY) 作为明天；

# c# - 如何不在网页网站中使用 _Layout 页面

> ID：14841787
> 
> 赞同：1
> 
> 时间：2013-02-12T21:04:04.017
> 
> 标签：c#, asp.net, .net, razor, webmatrix

我有一个基于 webmatrix 的网站并有一个测试页面。我需要它不是 _SiteLayout 页面的一部分。我该怎么做呢？

我的目录：

```
root/
--assets/
--layouts/
----_SiteLayout.cshtml
--Default.cshtml
--Test.cshtml 
```

如上所示，根目录中有两个网页，默认和测试。默认使用 _SiteLayout 页面。测试也是如此。但我不希望 Test.cshtml 使用 _SiteLayout 页面。这可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:07:42.610

尝试在 Test.cshtml 的顶部将 Layout 设置为 null。

```
@{
Layout = null;
} 
```

# emacs - Emacs 24.2 CUA 模式上 Shift-up/down 的行为

> ID：14841788
> 
> 赞同：0
> 
> 时间：2013-02-12T21:04:13.537
> 
> 标签：emacs, cua-mode, cua

我`(cua-mode t)`在 Windows XP 上的 GNU Emacs 24.2 中设置了我的 ~/.emacs。但是，当（没有选择）我输入 shift-up 或 shift-down 时，不会启动新的选择，这不是 MS Notepad、Eclipse 等中看到的 CUA 行为。如果我输入 shift-left/right 然后 shift-up /down 然后当我继续键入 shift-up/down 时，确实会创建并扩展一个新的选择。

现在，在 Emacs 23.1 中，初始化序列： `(pc-selection-mode) (load "cua-mode") (CUA-mode t)` 确实表现出预期的行为，但现在所有这些都已过时 AFAICS。那么，关于如何让初始班次选择像在其他 Windows 应用程序中一样工作的任何想法？

# ruby-on-rails - 列出索引中的搜索

> ID：14841789
> 
> 赞同：0
> 
> 时间：2013-02-12T21:04:14.360
> 
> 标签：ruby-on-rails, ruby-on-rails-3, thinking-sphinx

我在 index.html.haml 中显示我所有的饮料时遇到问题。在观看了 Ryan Bates 之后，我最近开始使用 Thinking sphinx 进行搜索（[thinking sphinx railscast](http://railscasts.com/episodes/120-thinking-sphinx-revised?view=asciicast)。作为转向 sphinx 的一部分，我改为`@drinks = Drink.all`现在`@drinks = Drink.search(params[:search])`它没有在我的索引页面上显示饮料名称

**饮料模型**

```
class Drink < ActiveRecord::Base

  attr_accessible :name, :detail, :recipe_steps_attributes

  has_many :recipe_steps, :dependent => :destroy
  has_many :ingredients, through: :recipe_steps
  has_one :glass

  validates_uniqueness_of :name, case_sensitive: false

  accepts_nested_attributes_for :recipe_steps, :reject_if => lambda { |a| a[:amount].blank? }, :allow_destroy => true

  define_index do
    indexes :name
    indexes ingredients.name as: :ingredient_name
  end
end 
```

**饮料控制器索引**

```
def index
    @drinks = Drink.search(params[:search])
    if current_user
      @cabinet = Cabinet.find(current_user.id)
    end
  end 
```

**饮料指数.haml**

```
= form_tag drinks_path, method: :get do
  .field
    = text_field_tag :search, params[:search]
    = submit_tag "Search", name: nil

- @drinks.each do |drink|
  = drink.name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:49:43.613

我能够回答我自己的问题。问题是在将记录添加到数据库后我没有重新索引。因此，当我试图将它们打印在我的块中时，它们没有出现。

正如 TomL 建议的那样，处理这个问题的最好方法是定期运行一个 cron 作业

```
rake ts:rebuild 
```

# cordova - 以纯 JavaScript 显示 AdMob 广告（或其他广告提供商）的任何方式

> ID：14841790
> 
> 赞同：6
> 
> 时间：2013-02-12T21:04:15.627
> 
> 标签：cordova, admob, phonegap-build

有没有办法只使用纯 JavaScript 来展示 AdMob 广告？或者以任何其他方式，我可以直接在使用 PhoneGap Build 构建的 PhoneGap 应用程序中使用它？

我正在使用 PhoneGap 开发移动应用程序。我已经看到了许多解决这个问题的方法和方法（比如[this](http://therockncoder.blogspot.jp/2012/05/cordova-phonegap-and-admob-together-ios.html)或[this](http://fczaja.blogspot.com/2012/09/admob-ads-in-phonegap-apps.html)）。但由于我只使用PhoneGap Build，我不能使用任何一个。我见过[AdMob Cordova Plugin](https://github.com/rajpara11/phonegap-plugins/tree/master/Android/AdMobPlugin)，但由于它是面向平台的（目前仅适用于 iOS 和 Android）并且在文档中有很多 Java 和 SDK，我很确定我不能在应用程序中使用它使用 PhoneGap Build 编译。

如果没有办法通过 JS 获取 AdMob，那么也许还有另一个广告提供商，哪个 API 可以完全通过 JavaScript 访问？

我听说[MillenialMedia](http://www.millennialmedia.com/)可以使用纯 JavaScript 显示广告，甚至允许外部广告提供商（如 AdMob）。所以这对我来说是一个完美的解决方案。但是他们的页面组织得很差（很多自我营销等等，并且没有指向某些 API、示例或文档的实际链接，至少没有，当您没有登录时），我无法确认它支持 JavaScript 和 AdMob。有人对此系统有任何经验并可以确认吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T22:19:03.403

tl;dr 使用纯 Javascript 显示移动广告：

*   [AdMob](http://www.google.com/ads/admob/)：不，
*   [移动媒体](http://mmedia.com/)：不，
*   [AdSense](https://www.google.com/adsense/)：没有（[详情](http://support.google.com/adsense/bin/answer.py?hl=en&answer=68724)），
*   [MobFox](http://mobfox.com/)：**是**的。

我已经经历了很长时间，不幸的是，mMedia 和 AdMob 都没有您的请求（JavaScript 代码）。

[mMedia](http://mmedia.com/)：它们具有以下移动网站（不是安卓应用程序）的源代码类型：ASP、Perl、PHP、JSP5、ruby on rails 和 vb.net。要获得源代码，您需要一个移动网站，并且该移动网站必须得到 mMedia 的批准，然后您会获得实时广告，我猜如果您在您的 android 应用程序中使用网站的源代码，他们将暂停帐户，因为在mMedia 每个项目都必须首先获得批准，因此他们希望他们的广告展示在他们批准的项目上。无论如何，没有您要求的 JavaScript 代码。mMedia 将提供 sdk 和说明，以便在您的应用程序中下载和安装课程外的实时广告将在他们批准后显示，我猜这是您不想要的。

[AdMob](http://www.google.com/ads/admob/)：阅读它们有点令人困惑，因为过去他们曾经通过 JavaScript 方法为移动网站提供广告，但在谷歌收购该公司后，他们删除了这个，AdMob 不再为移动网站和移动网站提供服务他们建议您使用 AdSense 的网站。令人困惑的是，仍然存在安装 AdMob JavaScript 的说明，但它不再存在。我看到了您的链接，我猜您尝试在哪里安装 AdMob for iOS 应用。我是为 Android 应用程序做的，它很简单，使用[In-App-Advertisements](https://github.com/phonegap/phonegap/wiki/In-App-Advertisements)很容易，但问题是我尝试过它在底部显示的内容。

[AdSense](https://www.google.com/adsense/)：他们有 JavaScript 方式，但不允许您在移动应用程序上使用它，如果他们发现他们将暂停您的帐户（[详细信息](http://support.google.com/adsense/bin/answer.py?hl=en&answer=68724)）。

对于[MobFox](http://mobfox.com/)：他们为移动网站提供广告，移动网站的源代码类型有：JavaScript、PHP、cURL、PHP、fSocket、J2SE 1.4、CGI/Perl 和 ASP.NET。对于应用程序，您必须下载 SDK。但是在 MobFox 中没有任何规定，您不能将他们的 JavaScript 用于移动应用程序，一旦您获得批准，您就可以像谷歌一样工作，您将获得发布者 ID，并在不违反他们的条款的情况下做任何您想做的事情。与 mMedia 不同，他们必须首先批准每件事。他们为以下公司提供广告网络中介选项 4INFO、Aditic (Sofialys)、Adfonic、AdMarvel、Admoda、BuzzCity、Hunt、Mobile Ads、InMobi、iVdopia、JumpTap、Komli Mobile (ZestAdz)、Lumata Group(bMobile)、 m-perf、Madvertise、MdotM、MobGold、MobPartner、Mocean、Mojiva、Nexage Exchange、Smaato、TapIt!、Vserv、WapStart、YOC Performance（Mocean 平台）、

就我的研究而言，您对 JavaScript 代码的唯一选择是使用 MobFox，并且您需要一种获得批准的方法，以便您拥有一个发布者 ID。我的移动网站包含 4 个页面，每天只有 20 个流量，我得到了他们的认可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-09T11:34:51.937

有一个功能强大的[AdMob Plugin Pro](https://github.com/floatinghotpot/cordova-admob-pro)（免费，尽管名称*pro*听起来很吓人），可以很容易地在 PhoneGap Build 中使用。我认为，这是解决这个问题的最先进的解决方案，因为——通过[在 PhoneGap Build 中引入 npm 插件](http://phonegap.com/blog/2015/05/26/npm-plugins-available/)——你现在可以在纯 Javascript PhoneGap Build 应用程序中使用所有需要你使用它们的广告网络原生 SDK。

主要优势（在这个问题的背景下）——开箱即用的支持：

*   [PhoneGap Build](https://github.com/floatinghotpot/cordova-admob-pro/wiki/00.-How-To-Use-with-PhoneGap-Build)（见下面的通知），
*   许多广告类型，包括全屏广告，
*   许多广告提供商和广告网络（带有插件，见下文），
*   使用纯 Javascript 投放广告，只需几行代码。

插件支持以下广告网络/提供商：

*   **广告移动**，
*   **广告管理**系统
*   Facebook受众网络，
*   乱舞，
*   广告，
*   在移动中，
*   千禧年媒体，
*   魔狐。

前两个（粗体）具有开箱即用的支持，而所有其他都需要使用额外的[插件](https://github.com/floatinghotpot/cordova-admob-pro#see-also)。

在 PhoneGap Build 中有[一篇关于使用这个插件的文章](https://github.com/floatinghotpot/cordova-admob-pro/wiki/00.-How-To-Use-with-PhoneGap-Build)。它有点过时了。您不应该使用现在已弃用`plugins.cordova.io`但新支持的[npm 存储库](https://www.npmjs.com/~floatinghotpot)。为此，只需替换：

```
<gap:plugin name="com.google.cordova.admob" source="plugins.cordova.io" /> 
```

和：

```
<gap:plugin name="cordova-plugin-admobpro" source="npm"/> 
```

Plugin 的作者提供了一个[可扩展的文档](https://github.com/floatinghotpot/cordova-admob-pro/wiki)，其中包括 API 文档、代码示例和不同开发平台之间的示例实现。真是好作品！

资源：

*   [文档](https://github.com/floatinghotpot/cordova-admob-pro/wiki)，
*   [GitHub 仓库](https://github.com/floatinghotpot/cordova-admob-pro)，
*   [npm 存储库](https://www.npmjs.com/~floatinghotpot)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T10:58:29.970

您可以尝试 InMobi，您只需要 3 行 Javascript（[详细信息](http://developer.inmobi.com/wiki/index.php?title=Main_Page#JavaScript_Ad_Code_Integration_-_Client_Side)）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-08-26T15:16:16.137

查看此[AdMob 的移动指南](http://media.admob.com/mobile_ad_guide/)。

我不知道，他们有这样的 API，直到我用谷歌搜索它。

# ajax - 处理 Ajax 的字符串

> ID：14841795
> 
> 赞同：0
> 
> 时间：2013-02-12T21:04:32.867
> 
> 标签：ajax, map, key, handle, key-value

晚安。

就个人而言，我在 Ajax 中有一个函数，它在下面的相同输出模板中向 Servlet 发送一个字符串。

```
{"Disease":["name","class"],"Ingredient":["name"]} 
```

我想知道的是，您是否可以获得此输出并以这样的方式处理它，即我可以将**Key****中方括号 []之外的值***（例如疾病）*和**方括号 [] 内**的值*（例如 ["name", "class"]，例如）*在我的**Map**的值中。

 ********每个“键”只有它们各自的属性值。我的想法是在下面构建一个地图。

```
Map<String, Set<String>> mapAjax = new LinkedHashMap<String, Set<String>>(); 
```

对于我作为示例提到的输出，我希望得到以下最终结果。

```
Map<Disease, ["name","class"]>;
Map<Ingredient, ["name"]>; 
```

有人可以给我一个提示如何操作我作为输出的这个字符串吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:06:55.690

使用您正在编写的任何语言查找 JSON 反序列化器（看起来像 Java，但它可能是 C#）。********

# javascript - 使用 jQuery 加载源文件时更新对象 HTML

> ID：14841796
> 
> 赞同：1
> 
> 时间：2013-02-12T21:04:36.157
> 
> 标签：javascript, jquery, append, document, getelementbyid

我正在通过 jQuery 导入必要的文件，并且我想更新一些文本以显示正在加载的文件，但似乎导入是在文本更新之前完成的，无论指定的顺序如何。但是，控制台日志记录会按计划更新，即使它是在 import 语句*之后调用的。*我也尝试过这种方式的文本更新调用，但它也不起作用。

这是一段代码摘录：

```
var jsFiles = new Array('some js files');
var cssFiles = new Array('some css files');

for(var i = 0; i < jsFiles.length; i++) {
    $('#loadfile').text('imported js library `' + jsFiles[i]+'`');
    $('head').append('<script type="text/javascript" src="'+jsFiles[i]+'"></script>');
    console.log('imported js library `' + jsFiles[i]+'`');
}

for(var i = 0; i < cssFiles.length; i++) {
    $('#loadfile').text('imported css library `' + cssFiles[i]+'`');
    $('head').append('<link rel="stylesheet" media="screen" type="text/css" href="'+cssFiles[i]+'" />');
    console.log('imported css library `' + cssFiles[i]+'`');
} 
```

我尝试设置超时，如果文本已更新，我还尝试将变量设置为 true，并在导入文件之前检查该变量是否为 true，但这只会使文件无法导入。

我还尝试使用`document.getElementById`调用来更新文本，但也没有骰子。javascript中是否有一些固有的东西可以设置语句的优先级，或者我只是忽略了一些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:38:06.207

在大多数浏览器中，Javascript 在 GUI 线程上运行。当您的脚本被下载和阅读时，GUI 将不会更新，直到您的脚本插入完成。window.setTimeout 将允许 gui 在下载/插入脚本之前进行更新。

```
for(var i = 0; i < jsFiles.length; i++) {
    $('#loadfile').text('imported js library `' + jsFiles[i]+'`');
    window.setTimeout(function() {
        $('head').append('<script type="text/javascript" src="'+jsFiles[i]+'"></script>');
    }, 10);
    console.log('imported js library `' + jsFiles[i]+'`');
} 
```

资料来源：[JavaScript 似乎以错误的顺序执行代码](https://stackoverflow.com/questions/8696081/javascript-seems-to-be-executing-code-in-wrong-order)

# python - 从线程的上下文调用线程对象的方法

> ID：14841802
> 
> 赞同：0
> 
> 时间：2013-02-12T21:04:49.977
> 
> 标签：python, python-multithreading

我正在尝试使用对象的句柄从线程的上下文中调用线程对象的方法之一。但是，这不起作用，而是从主线程的上下文中调用该方法。有没有办法解决？

这是一些示例代码：

```
import threading

class ThreadTest(threading.Thread):
  def __init__(self):
    threading.Thread.__init__(self)
    print '\nInitializing ThreadTest\n'

  def call_me(self):
    ident = threading.current_thread().ident
    print '\nI was called from thread ' + str(ident) + '\n'

  def run(self):
    ident = threading.current_thread().ident
    print '\nStarting thread ' + str(ident) + ' for ThreadTest\n'
    self.call_me()

ident = threading.current_thread().ident
print '\nMain thread ID is ' + str(ident) + '\n'

tt = ThreadTest()
tt.start()
tt.call_me()

# Example Output:
#   Main thread ID is 140735128459616
#
#   Initializing ThreadTest
#
#   Starting thread 4400537600 for ThreadTest
#
#   I was called from thread 4400537600
#
#   I was called from thread 140735128459616 
```

我正在寻找的是一种`tt.call_me()`从线程的上下文中创建的方法，以便`current_thread().ident`返回与从线程的 run 方法调用时相同的 ID。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:28:23.620

可以从任何线程调用 Python 类方法。这也适用于 threading.Thread 类。当你写道：

```
tt.call_me() 
```

你是说，“无论哪个线程碰巧正在运行此代码，请调用 tt.call_me”。由于您在主线程中，因此主线程进行了调用。Python 不会自动代理对线程的调用。

run 方法中的 self.call_me 行工作得很好。“运行”方法是线程，它调用的任何东西都在该线程中。

# jquery - 浮动比较条形图

> ID：14841803
> 
> 赞同：1
> 
> 时间：2013-02-12T21:04:55.587
> 
> 标签：jquery, graph, charts, flot, bar-chart

我正在尝试在 Flot 中生成一个图表，其中一个数据集具有多个彼此相邻的堆叠条，第二组堆叠条作为显示在主图表下方但倾斜角度的第二个数据集。下图显示了我所追求的

![我希望它看起来如何](../Images/a8d3910585cb800b833f3d1889221091.png)

有什么方法可以轻松做到这一点吗？我知道有一个插件可以让我将这些条并排放置，但这并不是我真正想要的。

我已经让它按照我想要的方式渲染一个数据集，但我不知道如何去做第二个数据集。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:49:23.437

您可以使用几个`div`s 和一些 css 来进行堆叠。只需在每个图表中放置一个图表，`div`然后将它们绝对定位在包装器 div 中：

```
<div id="graph_wrap">
    Comparison Chart
    <div id="graph1"></div>
    <div id="graph2"></div>
</div> 
```

CSS：

```
#graph_wrap {
    width: 700px;
    height: 400px;
}

#graph1, #graph2 {
    position: absolute;
    left: 0px;
    top: 0px;
    width: 600px;
    height: 300px;
    margin: 50px;
    z-index: 2;
}

#graph2 {
    top: -15px;
    left: 15px;
    z-index: 1;
} 
```

示例：http: [//jsfiddle.net/jtbowden/q4N4M/](http://jsfiddle.net/jtbowden/q4N4M/)

# iphone - UIPopoverController 中包含的 UIToolbar 上的渐变

> ID：14841805
> 
> 赞同：1
> 
> 时间：2013-02-12T21:05:05.037
> 
> 标签：iphone, uikit, uipopovercontroller, uitoolbar, uiappearance

当一个 UIToolbar 被放置在一个 UIPopover 里面时，有一个光泽层总是被绘制在它上面。无论是否为 UIToolbar 提供了自定义图像，都会绘制此光泽层。我也尝试通过设置不同的 shadowImage 来摆脱这种情况，但阴影图像从未显示。

![在此处输入图像描述](../Images/8c8a22e51facd167acad2d4010847f49.png) 这是一个例子。这里的 UIPopover 有一个自定义背景视图，它被绘制成黑色以显示问题。

有谁知道如何禁用此光泽或（更好）用我自己的光泽图像替换它？

# javascript - http://... 外部的正则表达式

> ID：14841812
> 
> 赞同：1
> 
> 时间：2013-02-12T21:05:20.557
> 
> 标签：javascript, regex, hyperlink

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:13:25.830

# javascript - 焦点不会隐藏浏览器后退按钮上的提示 (jquery.hint.js)

> ID：14841817
> 
> 赞同：2
> 
> 时间：2013-02-12T21:05:36.607
> 
> 标签：javascript, back-button

我使用 jquery.hint.js。在页面加载时很好，但是当我使用后退浏览器按钮时，焦点不会隐藏提示。

```
jQuery.fn.hint = function (blurClass) {
    if (!blurClass) {
        blurClass = 'blur';
    }

    return this.each(function () {
        // get jQuery version of 'this'
        var $input = jQuery(this),

        // capture the rest of the variable to allow for reuse
          title = $input.attr('title'),
          $form = jQuery(this.form),
          $win = jQuery(window);

        function remove() {
            if ($input.val() === title && $input.hasClass(blurClass)) {
                $input.val('').removeClass(blurClass);
            }
        }

        // only apply logic if the element has the attribute
        if (title) {
            // on blur, set value to title attr if text is blank
            $input.blur(function () {
                if (this.value === '') {
                    $input.val(title).addClass(blurClass);
                }
            }).focus(remove).blur(); // now change all inputs to title

            // clear the pre-defined text when form is submitted
            $form.submit(remove);
            $win.unload(remove); // handles Firefox's autocomplete
        }
    });
}; 
```

正常页面加载示例：[http](http://prntscr.com/sik0d) ://prntscr.com/sik0d 使用后退浏览器按钮后示例：http: [//prntscr.com/sikap](http://prntscr.com/sikap)（不隐藏焦点提示，它只是在输入字段中添加文本）

如何解决这个问题。如何强制此脚本在后退按钮上重新加载？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T13:15:18.073

我终于发现 jquery.hint.js 女巫包含使用浏览器后退按钮的修复程序。所以这里有一个链接：[https ://gist.github.com/madmanlear/1723896](https://gist.github.com/madmanlear/1723896)

JavaScript：

```
(function ($) {

$.fn.hint = function (blurClass) {
    if (!blurClass) blurClass = 'blur';

    return this.each(function () {
        var $input = $(this),
            title = $input.attr('placeholder'),
            $form = $(this.form),
            $win = $(window);

        function remove() {
            if ($input.val() === title) {
                $input.val('').removeClass(blurClass);
            }
        }

        // only apply logic if the element has the attribute
        if (title) { 
            // on blur, set value to title attr if text is blank

            $input.blur(function () {
                if (this.value === '' || this.value == title) {
                    $input.val(title).addClass(blurClass);
                }
            }).focus(remove).blur(); // now change all inputs to title

            // clear the pre-defined text when form is submitted
            $form.submit(remove);
            $win.unload(remove); // handles Firefox's autocomplete
        }
    });
};

})(jQuery); 
```

# vb.net - 列表框和数学的等于运算符无法正常工作

> ID：14841822
> 
> 赞同：1
> 
> 时间：2013-02-12T21:05:55.797
> 
> 标签：vb.net, math, listbox, equals

我完成了老师要求的作业。数学并没有计算出它应该是什么。数学在处理压力、时间管理和监督技能方面非常有效。当我进入谈判，以及如何面试。我得到随机数。如何采访（395）+达拉斯（110）= 505但我得到725。我认为它正在做395 +（110x3）。

```
Public Class frmMain
Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    Dim Workshops As New ArrayList()
    Workshops.Add(New Workshop("Handling Stress", "595"))
    Workshops.Add(New Workshop("Time Management", "695"))
    Workshops.Add(New Workshop("Supervision Skills", "995"))
    Workshops.Add(New Workshop("Negotiation", "1295"))
    Workshops.Add(New Workshop("How to Interview", "395"))
    lbWorkshop.DataSource = Workshops
    lbWorkshop.DisplayMember = "Workshop"
    lbWorkshop.ValueMember = "Price"
    lbWorkshop.ClearSelected()

    Dim Location As New ArrayList()
    Location.Add(New Workshop("Austin", "95"))
    Location.Add(New Workshop("Chicago", "125"))
    Location.Add(New Workshop("Dallas", "110"))
    Location.Add(New Workshop("Orlando", "100"))
    Location.Add(New Workshop("Phoenix", "92"))
    Location.Add(New Workshop("Raleigh", "90"))
    lbLocation.DataSource = Location
    lbLocation.DisplayMember = "Workshop"
    lbLocation.ValueMember = "Price"
    lbLocation.ClearSelected()

End Sub

Private Sub lblAdd_Click(sender As Object, e As EventArgs) Handles lblAdd.Click

    Dim description As String
    Dim value As Integer

    If (lbWorkshop.SelectedIndex > -1) Then
        If (lbLocation.SelectedIndex > -1) Then
            lblStatus1.Text = String.Empty
            If (lbWorkshop.SelectedItem.Equals("How to Interview")) Then
                value = lbWorkshop.SelectedValue + lbLocation.SelectedValue
            ElseIf (lbWorkshop.SelectedItem.Equals("Negotiation")) Then
                value = lbWorkshop.SelectedValue + (lbLocation.SelectedValue * 5)
            Else
                value = lbWorkshop.SelectedValue + (lbLocation.SelectedValue * 3)
            End If
            description = value.ToString

            lbTotal.Items.Add(description)
            lbTotal.ValueMember = value

            Dim total As Integer
            For Each Str As String In lbTotal.Items
                total = total + CInt(Str)
            Next
            lblTotal.Text = FormatCurrency(total.ToString)
        Else
            lblStatus1.Text = "Please Select a Location"
        End If
    Else
        lblStatus1.Text = "Please Select a Workshop"
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:17:30.753

据我所知，它正在按照您的要求进行。这是你的意图吗？

```
 Else  'Supervision Skills, Negotiation, How to Interview
            value = lbWorkshop.SelectedValue + (lbLocation.SelectedValue * 3) 
```

# c# - IIS 主机中的 WCF 库未从客户端连接

> ID：14841826
> 
> 赞同：0
> 
> 时间：2013-02-12T21:06:13.847
> 
> 标签：c#, wcf, iis

您好，我有一个 WCF 服务库项目，并且我创建了一个 WPF 应用程序来托管它以进行测试并且效果很好，但是我还创建了一个 Web 应用程序来在 IIS 中托管它以进行生产，并且当我尝试连接到 IIs 时我永远做不到。

我正在使用 net.tcp 绑定，我已进入 IIS 并将 net.tcp 绑定添加到 Web 应用程序和网站。

基本上这是一个双工服务，其方法标记为单向。当我在客户端调用该方法时，回调永远不会被调用，我最终只是坐在那里等待几分钟，然后关闭应用程序。当我自己托管服务时，我几乎立即在回调中得到响应。

我也尝试过使用 localhost:808 和 localhost。如果我使用 svcutil 生成配置，它会使端口脱离地址。我没有收到任何我知道的错误，但老实说，我真的不知道如何判断我是否收到了它从 IIS 抛出的任何错误。

此外，如果我去`http://localhost:9595/EcuWebService/Service.svc`我会得到告诉我使用 svcutil 生成我的客户端代理的页面。

正如乔克在下面建议的那样，我附加了一个调试器并收到了这个错误：服务'/EcuWebService/service'不存在。

这里也是我的 svc 文件的内容：

```
<%@ ServiceHost Language="C#" Debug="true" Service="EcuWeb.ServiceLib.Contracts.EcuWebServiceMain" %> 
```

下面是我的 Web.config：

```
<?xml version="1.0"?>
  <configuration>
<configSections>
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
</configSections>
  <appSettings>
     <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
 <system.web>
   <compilation debug="true" targetFramework="4.5" />
   <httpRuntime targetFramework="4.5"/>
 </system.web>
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" minFreeMemoryPercentageToActivateService="1" multipleSiteBindingsEnabled="true"/>
    <services>
        <service name="EcuWeb.ServiceLib.Contracts.EcuWebServiceMain">
            <endpoint address="net.tcp://localhost:808/EcuWebService/service" binding="netTcpBinding" bindingConfiguration="" name="netTcp_EcuWebServiceEndpoint" contract="EcuWeb.ServiceLib.Contracts.IEcuWebServiceMain">
                <identity>
                    <dns value="localhost" />
                </identity>
            </endpoint>
            <endpoint address="net.tcp://localhost:808/EcuWebService/mex" binding="mexTcpBinding" bindingConfiguration="" name="mexTcp_EcuWebServiceEndpoint" contract="IMetadataExchange" />
            <host>
               <baseAddresses>
                  <add baseAddress="http://localhost/EcuWebService" />
                </baseAddresses>
            </host>
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="">
                <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="true" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

这是客户端应用程序的配置。注释掉的端点是我不在 IIS 中托管时使用的端点，它可以工作。

```
<?xml version="1.0" encoding="utf-8" ?>
  <configuration>
    <system.web>
      <compilation debug="true" />
    </system.web>
     <!-- When deploying the service library project, the content of the config file    must be added to the host's 
          app.config file. System.Configuration does not support config files for libraries. -->
     <system.serviceModel>
       <bindings>
        <netTcpBinding>
          <binding name="netTcp_EcuWebServiceEndpoint" />
        </netTcpBinding>
       </bindings>
     <client>
      <!--<endpoint address="net.tcp://localhost:5555/EcuWebService/service"
       binding="netTcpBinding" bindingConfiguration="netTcp_EcuWebServiceEndpoint"
       contract="EcuWebService.IEcuWebServiceMain" name="netTcp_EcuWebServiceEndpoint">
        <identity>
         <dns value="localhost" />
        </identity>
       </endpoint>-->
         <endpoint address="net.tcp://localhost/EcuWebService/service"
            binding="netTcpBinding" bindingConfiguration="netTcp_EcuWebServiceEndpoint"
            contract="EcuWebService.IEcuWebServiceMain"    name="netTcp_EcuWebServiceEndpoint">
            <identity>
                <dns value="localhost" />
            </identity>
        </endpoint>
</client>
<services>
  <service name="Ecu.Service.Contracts.EcuServiceMain">
    <endpoint address="service" binding="netNamedPipeBinding" bindingConfiguration=""
      name="netNamedPipe_EcuClientEndpoint" contract="Ecu.Service.Contracts.IEcuServiceMain">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexNamedPipeBinding" bindingConfiguration=""
      name="mexNamedPipe_EcuClientEndpoint" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.pipe://localhost/EcuServiceClient" />
      </baseAddresses>
    </host>
  </service>
</services>
<behaviors>
   <serviceBehaviors>
     <behavior name="">
       <serviceMetadata httpGetEnabled="false" />
         <serviceDebug includeExceptionDetailInFaults="true" />
     </behavior>
   </serviceBehaviors>
 </behaviors> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:21:28.953

好的，我终于弄清楚了。

首先我必须添加：

```
<host>
 <baseAddresses>
  <add baseAddress="net.tcp://localhost:5555/EcuWebService" />
  <add baseAddress="http://localhost/EcuWebService" />
 </baseAddresses>
</host> 
```

然后对于我刚刚使用的端点：

```
<service name="EcuWeb.ServiceLib.Contracts.EcuWebServiceMain">
<endpoint address="service" binding="netTcpBinding" bindingConfiguration=""
 name="netTcp_EcuWebServiceEndpoint" contract="EcuWeb.ServiceLib.Contracts.IEcuWebServiceMain">
 <identity>
  <dns value="localhost" />
 </identity>
</endpoint> 
```

然后在客户端我不得不使用：

```
<endpoint address="net.tcp://localhost/EcuWebService/Service.svc/service"
    binding="netTcpBinding" bindingConfiguration="netTcp_EcuWebServiceEndpoint"
    contract="EcuWebService.IEcuWebServiceMain" name="netTcp_EcuWebServiceEndpoint">
            <identity>
                <dns value="localhost" />
            </identity>
        </endpoint> 
```

当我添加端口时它不起作用，但是一旦我删除它就没有问题了。我也怀疑基地址是必需的，因为 IIS 无论如何都会给出地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:50:25.663

发生什么了？你有例外吗？可以在 IIS 中浏览吗？

您的服务有：

```
endpoint address="net.tcp://localhost:808/EcuWebService/mex" 
```

和客户：

```
endpoint address="net.tcp://localhost/EcuWebService/service" 
```

我认为您需要提供更多详细信息才能获得好的答案。

# javascript - 默认情况下取消静音嵌入式 Vine

> ID：14841827
> 
> 赞同：2
> 
> 时间：2013-02-12T21:06:19.510
> 
> 标签：javascript, html5-video, vine

我想[在我的网站上嵌入 Vine 视频](http://www.schmutzie.com/weblog/2013/2/7/how-to-embed-vine-videos-just-about-anywhere.html)。默认情况下禁用音频（有充分理由），

我希望在页面加载时变得邪恶并取消静音，

该视频似乎使用了videojs，有没有办法通过他们的api做到这一点？

否则有没有办法在页面加载后模拟点击取消静音“按钮”？

检查元素给出：

```
<a href="#" class="mute-button off"></a> 
```

我在思考js`.click()`方法的思路？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-14T23:38:26.393

您可以添加参数静音如下： [https ://vine.co/v/h2t1zY5gOTB?mute=0](https://vine.co/v/h2t1zY5gOTB?mute=0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-14T19:39:17.717

到目前为止，我还没有找到任何方法。该按钮位于 iframe 内，因此无法访问以触发单击事件。您还会注意到单击嵌入链接到 Vine 网站上的视频查看器。

我在开发人员工具中将静音按钮的类更改为“静音按钮开启”，并且嵌入的 CSS 中甚至没有音频开启状态。这让我相信，目前 Vine 嵌入中没有用于取消视频静音的基础设施。

如果您深入检查器，您可以获取视频源的 url 并在您自己的自定义视频播放器中链接到它。这就是我正在采取的方法。希望将来 Vine 将为嵌入式视频提供更多选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-12T20:41:31.007

在当前版本的 Vine 中，您可以简单地选择让它自动播放音频的选项，但要自己做，请尝试`?audio=1`在 src 的末尾添加视频。

示例： [嵌入 Vine Batdad 视频](https://vine.co/v/hj7q1mqb7KH/embed)

# php - Foreach 循环不比较

> ID：14841832
> 
> 赞同：0
> 
> 时间：2013-02-12T21:06:27.627
> 
> 标签：php, arrays, loops, foreach

我有点像编程菜鸟，我遇到了一个问题，试图只回显我的数组中的几个项目，而不是数组中的所有项目。

所以我有一个包含我的数组 $products 的 products.php 文件，我现在正试图从我的索引页面调用这个数组，我不仅想调用数组，而且要让数组中的产品列出最后 4 个产品，而不是全部。

所以现在在我的 index.php 中我创建了这个代码：

```
$total_products = count($products);
$position = 0;
$list_view_html = "";
foreach($products as $product_id => $product) {
$position = $position + 1;
if($total_product - $position < 4){
$list_view_html = $list_view_html . get_list_view_html($product_id,$product);
}
} 
echo $list_view_html; 
```

现在，当我保存并加载网页时，我仍然看到列出的所有产品，而不是我应该看到的 4。

据我了解，我正在计算数组中的产品，从 0 开始循环，循环遍历数组，然后增加计数 +1。然后我说如果循环位置的产品少于我想要显示的 4 个项目。

我知道代码可能不是提高效率的最佳方式，或者它有一定的批评。我感谢所有的帮助，但我只需要弄清楚为什么我不能让它工作。

任何帮助表示赞赏，越少居高临下越好。

多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:11:02.487

这似乎是获取最后 4 个项目的一种非常复杂的方法。

我建议使用[`array_slice`](http://php.net/manual/en/function.array-slice.php)：

```
$last_four = array_slice($products, 0, -4); 
```

和一个简单的`foreach`循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T21:08:56.690

这是一个错字。将 if 更改为：

```
if($total_products - $position < 4){ 
```

请注意，var 的名称是`$total_products`. 您正在使用`$total_product`没有“s”和结尾。

# jpeg - 重新编码 JPEG 图像是幂等操作吗？

> ID：14841834
> 
> 赞同：11
> 
> 时间：2013-02-12T21:06:37.157
> 
> 标签：jpeg, codec, jpeg-xr

我知道JPEG压缩是有损的。我有两个问题：

给定一个操作 T：
1\. 获取 JPEG-80 图像
2\. 将其解码为字节缓冲区
3\. 将给定的字节缓冲区编码为 JPEG-80

就视觉质量而言，T 是幂等运算吗？或者当我重复 T 时，图像的质量会持续下降吗？JPEG-XR 编解码器也是如此吗？

谢谢！

**编辑**：由于存在相互矛盾的答案，如果您能提供参考，那就太好了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-27T21:17:31.323

这不能保证，但它可能会发生。尤其是如果你重复编码 -> 解码 -> 编码 -> 解码过程足够多次，它最终会固定在一个固定点上并停止进一步失去质量（只要你坚持相同的质量和相同的编码器）。

JPEG 编码分几个步骤完成：

1.  RGB 到 YUV 的转换
2.  DCT（变为频域）
3.  量化（丢弃 DCT 的位）
4.  无损压缩

并且解码是向后的相同过程。

步骤 1 和 2 存在舍入误差（尤其是在使用整数数学的速度优化编码器中），因此对于幂等重新编码，您需要幸运地使编码和解码舍入误差很小或相互抵消。

步骤 3 是主要的有损步骤，实际上是幂等的。如果您的解码像素转换为足够相似的 DCT，它将再次量化为相同的数据！

JPEG XR 也使用 YUV，因此它可能会遇到一些舍入错误，但 OTOH 而不是 DCT，它使用不同的变换，可以在没有舍入错误的情况下计算，所以它应该比其他格式更容易往返 JPEG-XR。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-19T13:43:33.410

根据定义，有损操作通过以一种（理想情况下）最终用户不会注意到的方式简化表示来丢弃数据。但是，编码器没有确定哪些像素重要哪些不重要的神奇方法，因此它对所有像素进行平等编码，即使它们是伪像！

换句话说，编码器会将有损压缩的图像视为无损图像。有损图像将被进一步简化，丢弃过程中的额外数据，因为就编码器所知，用户*打算*表示伪影。

以下是 JPEG 生成损失的一些示例：

[http://vimeo.com/3750507](http://vimeo.com/3750507)

[http://en.wikipedia.org/wiki/File:JPEG_Generrion_Loss_rotating_90_(stitch_of_0,100,200,500,900,2000_times).png](http://en.wikipedia.org/wiki/File:JPEG_Generarion_Loss_rotating_90_(stitch_of_0,100,200,500,900,2000_times).png)

# javascript - 了解 IE 9、firefox 和 Chrome 中事件 onmousemove 的鼠标位置

> ID：14841839
> 
> 赞同：1
> 
> 时间：2013-02-12T21:07:09.817
> 
> 标签：javascript, internet-explorer, google-chrome, firefox

我使用此函数获取事件的鼠标位置`onmousemove`，但在 Internet Explorer 9 中得到不同的结果。

```
function mouseCoords(ev){
if(ev.pageX || ev.pageY){
    return {x:ev.pageX, y:ev.pageY};
}
return {
    x:ev.clientX + document.body.scrollLeft - document.body.clientLeft,
    y:ev.clientY + document.body.scrollTop  - document.body.clientTop
};
} 
```

大多数浏览器的功能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:09:21.300

跨浏览器跟踪鼠标坐标的最一致的方法是使用 jQuery。 [http://docs.jquery.com/Tutorials:Mouse_Position](http://docs.jquery.com/Tutorials:Mouse_Position)

# c# - 我如何在同一个句子中添加（附加）一个单词，每个单词使用一个按钮（单击）

> ID：14841843
> 
> 赞同：2
> 
> 时间：2013-02-12T21:07:20.753
> 
> 标签：c#

我非常感谢任何帮助。我有 20 多个按钮，每个按钮都有一个单词、空格或句点。每次我单击一个按钮时，先前存在的单词都会被清除并替换为新单词。在单击“清除”按钮之前，我需要每个单词和/或空格保持原位。

也许这是以前在不同的搜索词下被问过/回答过的？我倾向于认为我需要识别一个字符串变量，但不知道如何开始。

===============

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class frmSentenceBuilder : Form
    {
        public frmSentenceBuilder()
        {
            InitializeComponent();
        }

        private void frmSentenceBuilder_Load(object sender, EventArgs e)
        {

        }

        private void btnA_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnA.Text;
        }

        private void btn_a_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btn_a.Text;
        }

        private void btnAn_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnAn.Text;
        }

        private void btn_an_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btn_an.Text;
        }

        private void btnThe_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnThe.Text;
        }

        private void btn_the_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btn_the.Text;
        }

        private void btnman_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnman.Text;
        }

        private void btnwoman_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnwoman.Text;
        }

        private void btndog_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btndog.Text;
        }

        private void btncat_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btncat.Text;
        }

        private void btncar_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btncar.Text;
        }

        private void btnbicycle_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnbicycle.Text;
        }

        private void btnbeautiful_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnbeautiful.Text;
        }

        private void btnbig_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnbig.Text;
        }

        private void btnsmall_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnsmall.Text;
        }

        private void btnstrange_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnstrange.Text;
        }

        private void btnlookedat_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnlookedat.Text;
        }

        private void btnrode_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnrode.Text;
        }

        private void btnspoketo_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnspoketo.Text;
        }

        private void btnlaughedat_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnlaughedat.Text;
        }

        private void btndrove_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btndrove.Text;
        }

        private void btnSpace_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = " ";
        }

        private void btnperiod_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnperiod.Text;
        }

        private void btnexclam_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = btnexclam.Text;
        }

        private void btnClear_Click(object sender, EventArgs e)
        {
            lblSentenceText.Text = "";
        }

        private void btnExit_Click(object sender, EventArgs e)
        {
            this.Close();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:08:44.453

使用`lb1SentenceText.Text+=whatever.Text;`.

+= 等价于`lbSentence.Text = lblSentenceText.Text + whatever.Text`.

基本上，它将右侧附加或连接`string`到`string`左侧。希望它有意义吗？

所以：

```
string rhs="Hello " ;
string lhs = "World";
string rhs = rhs + lhs;//Hello World 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T21:14:27.443

请受到启发。你有*很多*冗余代码。

```
 btnA.Click += AppendButtonText;
    btn_a.Click += AppendButtonText;
    ...

    private void AppendButtonText(object sender, EventArgs e)
    {
        var button = sender as Button;
        if (button != null)
        {
            lblSentenceText.Text += button.Text;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:33:25.957

```
//Simple.Create a global variable and within each button click event do this;

string yourStrVar = ""; //Must be global

yourStrVar+=  ((Button)sender).Text 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T21:11:49.173

在按钮单击事件上，将其更改为`+=`而不是`=`（清除按钮除外）。这相当于写作`something = something + newValue;`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T21:18:12.993

尝试：

```
lb1SentenceText.Text = lb1SentenceText.Text + *something*.text 
```

+= 运算符表示加到，修改后的变量等于原值（x = 1；x += 3；x 现在为 4）追加的 (Int, String)

尝试这个：

```
button.Click += new System.EventHandler(ButtonClick);
button1.Click += new System.EventHandler(ButtonClick);
// And for each button, one of those.
private void ButtonClick(object sender, System.EventArgs e)
{
// Do whatever you want to do here, you can place the TEXT to be appended on the button, if so:
lb1SentenceText.Text += sender.Text;
} 
```

# .net - 我真的需要在每个 Principal 上调用 Dispose() 吗？

> ID：14841844
> 
> 赞同：9
> 
> 时间：2013-02-12T21:07:24.923
> 
> 标签：.net, resources, dispose, iprincipal, groupprincipal

我正在使用 .NET 的`System.DirectoryServices.AccountManagement`命名空间做一些 Active Directory 工作。我注意到`Principal`implements `IDisposable`，这会引起一些头痛，因为该名称空间中的*所有内容都*继承了`Principal`。

例如，考虑以下代码来获取组中的所有用户：

```
PrincipalContext domain = new PrincipalContext(ContextType.Domain);
GroupPrincipal group = GroupPrincipal.FindByIdentity(domain, "MyGroup");
PrincipalSearchResult<Principal> users = group.GetMembers(); 
```

该片段中的每个类型都实现`IDisposable`了 ，包括搜索返回的所有用户和搜索结果集本身。

处理`domain`and`group`对象并不是什么大问题（使用块很容易`using()`），但是我该怎么处理每个结果呢？我真的必须遍历该`users`集合并处理每一个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:58:51.337

`IDisposable`契约就是这样，契约。预计会被遵循。如果您不需要“调用 Dispose”，他们就不会执行合同......

实际上，您无法真正判断特定实例正在使用哪种类型的对象，`Principal` 有时，您*确实*必须处理它，有时您*不需要*。除非您知道`Principal`. 例如，如果 Principle 实例中的基础对象是 a `DirectoryEntry`，那么您应该处置它。但是，您没有真正的方法在运行时告诉底层对象是什么。即使*可以*，简单地调用似乎也更容易`Dispose`。

# java - 使用嵌套 For 循环初始化二维数组的值

> ID：14841851
> 
> 赞同：2
> 
> 时间：2013-02-12T21:07:42.347
> 
> 标签：java, arrays, multidimensional-array, 2d

我正在尝试格式化以下数组：

```
[1] [2] [3] [4] [5]
[6] [7] [8] [9] [10]
[11] [12] [13] [14] [15] 
```

如何使用嵌套的 for 循环初始化二维数组和值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T21:17:21.173

我认为您对二维数组有误解。想想它们是包含数组的数组。

如果你真的想要这个：

```
[[1] [2] [3] [4] [5]
[6] [7] [8] [9] [10]
[11] [12] [13] [14] [15]] 
```

你可以这样初始化它：

```
int[][] array2d = new int[15][1]
for (int i = 0; i < array2d.length; i++) {
    array2d[i][0] = i + 1;
} 
```

如果在 fatc 中，你真正想要的是：

```
[[1, 2, 3, 4, 5]
[6, 7, 8, 9, 10]
[11, 12, 13, 14, 15]] 
```

你可以使用：

```
int[][] array2d = new int[3][5]
for (int i = 0; i < array2d.length; i++) {
    for (int j = 0; j < array2d[0].length; j++) {
        array2d[i][j] = (i * array2d[0].length) + j + 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:12:04.727

尝试类似：

```
int width = 5;
int height = 3;
int[][] array = new int[height][width];

for (int i = 0; i < height; i++)
{
    for (int j = 0; j < width; j++)
    {
        array[i][j] = i + j + (width * i);
    }
} 
```

# javascript - 以编程方式在 HTML5 中添加图像

> ID：14841855
> 
> 赞同：-1
> 
> 时间：2013-02-12T21:07:56.117
> 
> 标签：javascript, html, visual-studio-2012

我是网络开发世界的新手，我想知道是否有一种方法可以编程；

*   显示图像
*   隐藏/删除图像

我需要通过单击一个按钮来做到这一点（每个动作的一个按钮）

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:21:09.920

使用 javascript 你可以很容易地做到这一点。这是一个小例子：

```
<p><center><button style="background:url('someImage.jpg');width:86px;height:45px"       onclick="Test()"></button></p>
<div><img id="img1"  style="visibility:hidden" src="test.jpg" width="768" height="1280" />    </div>
<script>
function Test(){
    document.getElementById('img1').style.visibility='visible';
} 
```

您可以更改可见性值`hidden`以隐藏图像。

[这可能是您开始的好地方！](http://www.proglogic.com/learn/javascript.php)

# matlab - 如何从 Matlab 中的标量数据生成这个特定的 3D 图？

> ID：14841860
> 
> 赞同：2
> 
> 时间：2013-02-12T21:08:13.963
> 
> 标签：matlab, matlab-figure

我正在尝试使用 Matlab 生成此图。内置的椭球函数令人困惑。对于这个问题，我有两个变量（宽度和长度）和一个恒定的高度。

为了让它变得非常简单，我想表明当我们接近尖端时宽度正在变化，但高度是恒定的。w,x,h 是图中显示的变量。

如果有人可以提供帮助，我将不胜感激。

![3D 绘图](../Images/bc67377d30e6c7da77324a2998f3c44b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:33:08.863

我想，下面的代码让你走得很远。查看示例输出： ![在此处输入图像描述](../Images/23a4668f2059e97aff9c60e48755d3d0.png)

我添加了足够多的评论，您应该可以从这里获取它...

```
% plot ellipsoid in 3D

% height and width of ellipsoid:
e_h = 10;
e_w = 3;

% position where the "quivers" (arrows) go:
q_offset = 2;    % distance from axis
q_scale = 0.5;   % multiplier to give parabola some size
q_spacing = 0.5; % distance between arrows
q_height = 2.5;  % height above XY plane where arrows are drawn
N = 1000;        % number of points for drawing

theta = linspace(0, 2*pi, N); % parameter to help drawing ellipse
zerov = zeros(1, N);          % array of zeros that I will need

% coordinates of main ellipse:
x = e_w * sin(theta);
y = zeros(size(x));
z = e_h * cos(theta);

% plot main ellipse:
figure;
plot3(x, y, z)

% secondary plot
y2 = q_scale*(e_w.^2 - x.^2) + 2; % offset parabola - what your plot looked like...
hold on
plot3(x, y2, zerov+q_height);     % plotting the parabola in the XY plane at height
axis equal % make the plot dimensions isotropic

% add quivers
q_base = -e_w:q_spacing:e_w; % x coordinate; y and z are fixed
q_length = (e_w.^2 - q_base.^2)*q_scale; % length of quiver - just an equation I chose
q0 = zeros(size(q_base)); % another vector I will need multiple times
q1 = ones(size(q_base));  % ditto

% plot the arrows: the "-1" argument means "don't scale"
quiver3(q_base, q0+q_offset, q_height*q1, q0, q_length, q0, -1) 
```

# javascript - 从json变量获取值时未定义的值

> ID：14841862
> 
> 赞同：0
> 
> 时间：2013-02-12T21:08:20.270
> 
> 标签：javascript, json

我有返回 json 数据的 ac# webservice。这是正在返回的数据。

```
[ { "destination": "pandora.com", "hits": 9 }, 
{ "destination": "google.com", "hits": 2 }, 
{ "destination": "msftncsi.com", "hits": 2 }, 
{ "destination": "nmlsconsumeraccess.org", "hits": 1 }, 
{ "destination": "facebook.com", "hits": 1 }, 
{ "destination": "gravatar.com", "hits": 1 }, 
{ "destination": "iheart.com", "hits": 1 }, 
{ "destination": "kiss1041fm.com", "hits": 1 }, 
{ "destination": "live.com", "hits": 1 }, 
{ "destination": "microsoft.com", "hits": 1 }, 
{ "destination": "today.com", "hits": 1 }, 
{ "destination": "update.microsoft.com", "hits": 1 }, 
{ "destination": "xsitesnetwork.com", "hits": 1 }, 
{ "destination": "youtube-nocookie.com", "hits": 1 }, 
{ "destination": "youtube.com", "hits": 1 }, 
{ "destination": "zillow.com", "hits": 1 } ] 
```

这是我的javascript：

```
ret = Convert2Json.Convert(OnComplete, OnTimeOut, OnError); //this is my webservice

function OnComplete(arg) {

    $('#label').text(arg); //when I set this label to arg
    //I get the json data correctly as above

    var list = {
        "entries": arg
    };

    alert(list.entries[0].destination);
    //this gives me undefined when it popups
}

function OnTimeOut(arg) {
    alert("TimeOut encountered when calling server");
}

function OnError(arg) {
    alert("Error encountered when calling server");
} 
```

如果我自己定义列表如下，它可以工作：

```
var list = { "entries": [{ "destination": "pandora.com", "hits": 9 }, { "destination": "google.com", "hits": 2 }, { "destination": "youtube.com", "hits": 2 }, { "destination": "facebook.com", "hits": 1 }, { "destination": "fdic.gov", "hits": 1 }, { "destination": "GOV_new", "hits": 1 }, { "destination": "iheart.com", "hits": 1 }, { "destination": "jcpportraits.com", "hits": 1 }, { "destination": "kiss1041fm.com", "hits": 1 }, { "destination": "live.com", "hits": 1 }, { "destination": "msftncsi.com", "hits": 1 }, { "destination": "publix.com", "hits": 1 }, { "destination": "today.com", "hits": 1 }, { "destination": "xsitesnetwork.com", "hits": 1 }, { "destination": "youtube-nocookie.com", "hits": 1 }] }; 
```

这是 Convert2Json.Convert 所做的

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public string Convert() {

    using (SqlConnection conn = new SqlConnection("Server=localhost;Initial Catalog=Testing_Server;Trusted_Connection=True;"))
    {

        SqlCommand cmd = new SqlCommand("SELECT Destination as destination, count(distinct(source)) as hits FROM [Carlos_Test] where GETDATE() < DATEADD(MINUTE,5,time) and destination not in ('google-analytics.com','gstatic.com','googleadservices.com','download.windowsupdate.com') group by Destination order by hits DESC", conn);

        conn.Open();

        List<VisitedSites> slist = new List<VisitedSites>();

        SqlDataReader reader = cmd.ExecuteReader();

        while (reader.Read()) {

            VisitedSites vs = new VisitedSites();
            vs.destination = reader["destination"].ToString();
            vs.hits = Int32.Parse(reader["hits"].ToString());

            slist.Add(vs);

        }

        string jSon = JsonConvert.SerializeObject(slist, Formatting.Indented);

        return jSon;
    }

}

public class VisitedSites {

    public string destination;
    public int hits;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:15:41.217

根据您显示的内容 -`arg`是一个数组。

所以，说`alert(list.entries[0].destination);`可以工作，给你第一个元素，但`alert(list.entries.destination);`不会因为`list.entries`是一个数组，没有`.destination`指定属性。

# facebook - Facebook 图形 API 突然变得很慢

> ID：14841865
> 
> 赞同：1
> 
> 时间：2013-02-12T21:08:28.693
> 
> 标签：facebook, performance, facebook-graph-api

我不太确定发生了什么，但今天我注意到 facebook api 对我来说工作得非常慢。

起初我虽然这是我的代码中的一个错误，但我尝试了[Graph API Explorer](https://developers.facebook.com/tools/explorer/)，即使这导致了一半时间的超时错误（仅使用`/me`）：

> 加载资源失败：服务器响应状态为 504（服务器超时）

我不认为它是我的互联网连接，因为其他一切似乎都在快速运行，并且[http://speedtest.net](http://speedtest.net)给了我很好的结果。

*   我的问题是否可以以某种方式*解决*，或者这只是某种异常现象？
*   这是否发生在其他人身上？
*   我是否需要考虑在我的申请中需要很长时间才能收到回复的情况？

我目前有一个注册页面，它在显示表单之前等待 FB.api 响应（带有微调器 gif）。如果api没有响应，我*可以*使用超时等待几秒钟并显示它，但我真的不想在我的应用程序所依赖的每个api调用中都使用这种相同的逻辑......

**编辑：**它现在自发地修复了。仍然不知道发生了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T21:21:55.537

您可以使用此 URL 检查 facebook api 实时状态

[https://developers.facebook.com/live_status](https://developers.facebook.com/live_status)

> 今天晚上 11:13：API 问题我们目前遇到的问题可能会导致高 API 延迟和超时。我们现在正在努力修复。

# json - 将多个 cookie 合并为一个 cookie 的好习惯？

> ID：14841869
> 
> 赞同：1
> 
> 时间：2013-02-12T21:08:48.067
> 
> 标签：json, cookies, jquery-cookie

我在网上找不到这个问题的答案。将多个 cookie 组合成一个 cookie 以减少 http 请求是一种好习惯吗？如果是这样，我该怎么做。我应该使用 JSON 还是有更好的选择？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:56:11.410

如果将多个 cookie 组合成一个 cookie，则不会减少 http 请求的数量，而只会减少`Cookie:`每个请求的标头大小。另一方面，如果某些 Cookie 仅发送到某个路径而不发送其他路径，则将它们组合成一个实际上可能会使标头更长，因为来自所有 cookie 的信息都发送到每个页面，因为单个 cookie 必须被定义为使用组合 cookie 的所有路径中最短的。

无论如何，当您设置了三个 cookie 时，这是浏览器发送的 cookie 标头：

```
Cookie: cookie1=value1; cookie2=value2; cookie3=value3 
```

如您所见，这甚至不使用单独的标题；如果您想在一个 cookie 中发送相同的信息，它不会节省太多空间。如果你真的担心带宽，你可能会缩短 cookie 的名称，这几乎可以达到相同的效果，但老实说，我认为这不值得付出任何努力——还有其他东西比 cookie 消耗更多的带宽，所以有在那里优化几乎没有什么好处。

# php - 自定义帖子类型存档，更多页面不起作用

> ID：14841878
> 
> 赞同：0
> 
> 时间：2013-02-12T21:09:08.950
> 
> 标签：php, wordpress

我有一个网站，下周将在该网站上发布很多视频。这些视频是使用自定义帖子类型发布的，只有“to”、“from”和 yt 视频 ID。我想在档案页面上加载很多视频，但每页不超过 x。所以第 1 页有 x 个帖子，第 2 页有 x 个帖子，依此类推。不幸的是，页码没有显示，“p”容器只是保持空。这是我的代码：

```
 $args = array( 'post_type' => 'video'/*, 'posts_per_page' => 3 */);
        $loop = new WP_Query( $args );
        if (have_posts()) : 
    while ( $loop->have_posts()) : $loop->the_post(); 

                <?php endwhile; ?>
                <p><?php posts_nav_link('&#8734;','&laquo;&laquo; View newer posts','View older posts &raquo;&raquo;'); ?></p>
                <?php endif; ?> 
```

我已经清空了这段时间之间的部分，因为在那部分我只调用了基本函数，如 the_permalink 和 the_content。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:37:11.597

事实证明，将 posts_nav_link 与 WP_Query 结合使用并不能按预期工作，因为 posts_nav_link 依赖于全局 $wp_query 对象，并且无法识别自定义 WP_Query 实例。

[此答案](https://wordpress.stackexchange.com/questions/26960/posts-nav-link-not-displaying-anything)应为您提供使一切正常运行所需的详细信息。

```
<?php
global $wp_query;
$temp_wp_query = $wp_query;
$wp_query = null;

$paged = get_query_var('paged');
$args = array(
    'post_type' => 'video',
    'paged' => $paged ? $paged : 1
    /*, 'posts_per_page' => 3 */
);
$loop = new WP_Query( $args );
$wp_query = $loop;
if ($loop->have_posts()) : 
while ( $loop->have_posts()) : $loop->the_post(); 

<?php endwhile; ?>
<p><?php posts_nav_link('&#8734;','&laquo;&laquo; View newer posts','View older posts &raquo;&raquo;'); ?></p>
<?php
endif;
$wp_query = $temp_wp_query;
?> 
```

# python - 格式化打印：布尔问题

> ID：14841883
> 
> 赞同：1
> 
> 时间：2013-02-09T06:02:48.927
> 
> 标签：python

这段代码的目的是接收一个字符串并以特定格式打印出来。例如，给定：

```
s = "Hello" 
```

该程序应打印出：

```
+---+---+---+---+---+
| H | e | l | l | o |
+---+---+---+---+---+ 
```

如果字符串的大小大于控制台的列大小，则应该以这种格式打印出字符串：

```
+---+---+---+---+---+
| H | e | l | l | o |
+---+---+---+---+---+
| H | e | l | l | o |
+---+---+---+---+---+
| H | e | l | l | o |
+---+---+---+---+---+
| H | e | l | l | o |
+---+---+---+---+---+ 
```

不幸的是，第二个条件不起作用，我似乎无法弄清楚为什么。

这是我的代码：

```
import os

s = "Hello"*20
(consoleRows,consoleCol)=os.popen('stty size','r').read().split()
top = outer = "+---"*len(s)+'+'+'\n'
for i in range(len(s)):
    outer += "| "+s[i]+" "

outer += '|\n'
outer += top[:len(top)-1]

split = outer.split('\n')
if(len(split[0]) > consoleCol): #problem lies on this line. Even though the size of  
    outer = outer.split('\n') #split[0] is greater than consoleCol the if statement  
    beg = 0   #isn't entered.                                                        
    size = consoleCol
    print(outer[0][beg:size])
    while(size < len(outer[0])):
        print(outer[1][beg:size]);
        print(outer[2][beg:size]);
        beg = size
        size += size
else:
    print(outer) 
```

谁能看到我的问题是什么？我打印出 external[0] 和 consoleCol 的大小。len(output[0]) 大于 consoleCol。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T08:07:15.337

首先，我不是蟒蛇人。也就是说，我建议将逻辑与您的布局分开。创建方法`drawHorizontalLine`和。之后调试应该很容易。`drawContentLine(Char[5])``Char[5][] splitContent(String)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T09:29:43.517

代码中的错误：consoleCol 是一个字符串，而不是一个整数。

替换`(consoleRows,consoleCol)=os.popen('stty size','r').read().split()`为 `(consoleRows,consoleCol)=map(int, os.popen('stty size','r').read().split())`

这仍然不会产生预期的结果 - 您必须自己弄清楚其余部分，并可能在此过程中清理代码。

# servicestack - 将参数插入服务堆栈中的 Web 服务调用

> ID：14841889
> 
> 赞同：2
> 
> 时间：2013-02-12T21:09:43.827
> 
> 标签：servicestack, basic-authentication

假设我从服务堆栈示例中定义了 Hello World Web 服务，但我不只是将其称为 /hello/{name}，而是希望能够将其称为 /hello/{name}/id，其中我将 id 定义为一个单独的参数（通过将其存储在 refId 中，在 CustomUserSession 中）。

换句话说，我想将身份验证和实际的 Web 服务调用分成两部分，但我不想在实际的 Web 服务调用中公开这个 id，因为这是私有的，只在我的系统内。我该怎么做呢？我理想的工作流程是：

*   客户端调用网络服务：/hello/{name}
*   身份验证发生。作为此身份验证的一部分，我得到了这个秘密 ID
*   我现在将 Web 服务称为 /hello/{name}/id

就好像我想从另一个 Web 服务中调用一个 Web 服务一样。

如果这似乎是一个被误导的问题，我深表歉意，但我该如何实现这个工作流程？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:35:52.023

我建议看一下[ServiceStack routing](https://github.com/ServiceStack/ServiceStack/wiki/Routing)。您的服务只有在匹配现有路由（或使用[预定义路由](http://www.servicestack.net/ServiceStack.Hello/#predefinedroutes)）时才会被调用，这意味着如果您只有：

```
 [Route("/hello/{name}")] 
```

它不会匹配`/hello/{name}/{id}`，并且不会调用您的服务。要匹配该路由，您可以为其设置显式路由，例如：

```
 [Route("/hello/{name}/{id}")] 
```

但这是您说要隐藏的公共信息。另一种方法是使用通配符路由，例如：

```
 [Route("/hello/{name*}")] 
```

匹配任何`/hello/*`路线公司。`/hello`, `/hello/foo`, `/hello/foo/id`, `/hello/foo/id/and/more/etc`.

但是，在您的**Hello.Name**属性中填充的内容将是`foo/id`您必须在服务中检测和解析的内容。

另一种方法是在 QueryString 或 POST 表单参数中提供隐藏的 id，您可以在 ServiceStack 中使用它来进一步填充任何请求 DTO，例如使用原始路由：

```
 [Route("/hello/{name}")] 
```

`/route/foo?id=secret`如果您的 Request DTO 有一个**id**属性，将让您调用该服务`secret`。如果您没有（或不想）拥有 id 属性，您仍然可以使用以下方式访问参数：

```
base.Request.QueryString["id"];
base.Request.FormData["id"]; 
```

但是由于您希望将其隐藏，您可能应该避免将其传递到每个人都可见的 url（包括网络代理、http 日志和其他中间件）。隐藏参数的更好地方是将其作为自定义 HTTP 标头传递，例如：`X-id: secret`您可以通过以下方式在服务中访问它：

```
base.Request.Headers["X-id"]; 
```

# c# - 使用包含自定义部分的 WebConfigurationManager 读取 web.config，无法加载

> ID：14841894
> 
> 赞同：4
> 
> 时间：2013-02-12T21:10:14.897
> 
> 标签：c#

我正在尝试组合一个小型辅助工具来加密 web.config 文件。

Linqpad 示例：

```
var path = @"F:\project\";

var wcfm = new WebConfigurationFileMap();
wcfm.VirtualDirectories.Add("/",new VirtualDirectoryMapping(path,true));

var config = Configuration.WebConfigurationManager.OpenMappedWebConfiguration(wcfm,"/");

var c = config.Sections["customGroup"];

c.SectionInformation.ProtectSection(null);
config.Save(); 
```

这会引发异常：

```
Could not load file or assembly 'customGroupAssembly' or one of its dependencies. 
The system cannot find the file specified 
```

将程序集添加到 LinqPad 可修复 errpr。我认为这是因为它现在是编译时参考。

将代码移动到 winforms 应用程序，重新引入了问题。

我正在尝试使用以下方法在运行时加载所需的程序集：

```
if (this.openFileDialog1.ShowDialog() == DialogResult.OK)
{
    byte[] assemblyBuffer = File.ReadAllBytes(this.openFileDialog1.FileName);
    AppDomain.CurrentDomain.Load(assemblyBuffer);
    MessageBox.Show("Assembly loaded!");
} 
```

但是它似乎仍然没有找到该文件。

有没有办法将自定义程序集加载到运行时应用程序域中，以便可以正确加载 Web 配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:19:26.917

尝试附加程序集解析侦听器，我遇到了这样一个问题，即运行时加载的程序集没有正确解析，需要手动解决：

`AppDomain.CurrentDomain.AssemblyResolve += (s,arg)=>{ ... }`

在 (...) 处的代码根据您输入的名称返回您想要解析的程序集`arg`

# angularjs - 如何将参数传递给角度js中的过滤器函数

> ID：14841897
> 
> 赞同：10
> 
> 时间：2013-02-12T21:10:34.810
> 
> 标签：angularjs

我有两个问题。

1.  如何将参数传递给过滤器函数。

    比如说： `item in masterData|filter1:masterdata|filter2:outputFromfilter1, myparam | filter3:outputFromfilter2, myparam1,myparam2`

2.  如何访问`$scope`过滤器功能内部的控制器。

    ```
    animateAppModule.filter( 'distinct' , function(){
        return function(masterdata){
            //HOW TO ACCESS THE $scope HERE
        }
    }) 
    ```

这是一个[小提琴](http://jsfiddle.net/9t62c/)。请。查看 firebug 控制台，查看传递给过滤器的参数是`undefined`.

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-12T21:41:57.433

### 对于您的第一个问题：

您可以将参数分隔`:`为过滤器。例如，

```
{{ array | myfilter:a:b:c }} 
```

在您的过滤器定义中，

```
angular.module('app', []).
  filter('myfilter', function() {
    return function(in, param1, param2, param3) {
      // do something
    };
  }); 
```

### 对于你的第二个问题。

不确定为什么需要访问`$scope`. 您可以简单地通过参数提供任何需要的信息作为 Q1 吗？

# unix - 如何在 Linux 系统上使用 vi 以 noeol 和 dos 格式保存文本文件

> ID：14841899
> 
> 赞同：1
> 
> 时间：2013-02-12T21:10:42.337
> 
> 标签：unix, dos, vi

我在 x86_64 GNU/Linux 上运行 IBAMR 模型（一组用于解决沉浸式边界问题的代码）。启动配置文件称为 input2d。当我用 vi 打开它时，我发现：

“input2d” [noeol] [dos] 251L，11689C

如果我在不保存 input2d 的情况下编译 IBAMR 模型，它会编译并运行良好。但是，如果我保存 input2d，编译器会崩溃，说：

```
Warning in input2d at line 251 column 5 : Illegal character token in input 
```

显然，这与 unix 在文件末尾添加换行符有关。这是我的问题：如何在 unix 系统上以 dos 格式保存此文件并且在 vi 中没有尾随换行符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:15:59.053

使用`vim -b <file>`or`:set binary`告诉 vim 不要在文件末尾添加换行符。来自`:help binary`：

> 写入文件时，`<EOL>`仅当原始文件中有最后一行时才写入最后一行（通常，`<EOL>`如果没有，Vim 会在最后一行附加一个；这会使文件更长）。请参阅“下线”选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-09T21:49:51.113

我在 Vim Tips 上找到了一个脚本：

[http://vim.wikia.com/wiki/Preserve_missing_end-of-line_at_end_of_text_files](http://vim.wikia.com/wiki/Preserve_missing_end-of-line_at_end_of_text_files)

如果没有 eol，它会自动启用“二进制”，但会确保为文件的其余部分保留原始行尾。

# svn - 挂钩内的 SVN 提交消息更新

> ID：14841902
> 
> 赞同：0
> 
> 时间：2013-02-12T21:10:57.020
> 
> 标签：svn

我的最终目标如下：

我们希望在我们的问题管理软件（在我们的案例中是 Atlassion Jira）中创建代码更改的完全可追溯性。我们已经强制用户要求提供 Jira 票号（尽管这是一个软要求）。我们的开发人员经常要做的一件事是在遇到代码时修复代码中的小问题。为了获得适当的可追溯性，他们需要前往 jira 并注册一张票并使用该票号来提交更改。但这确实很乏味且耗时。

因此，我们的计划是更容易将小的固定提交到代码库，但在我们的问题管理系统中确实为这些更改提供单独的票证。

因此，最好的方法是简单地处理提交消息中定义的宏，该宏会自动创建票证。例如

```
#improvement NPE fix on whatchamacallit it. This will gracefully handle 
empty values. But in places when thingamabob expects an exception, it will
no longer receive it. 
```

这应该会在我们的 jira 项目“快速修复”上自动记录一张票。此票证生成将生成 ID 为 QF-1234 的票证。

这一切都可以通过预提交钩子实现。但是，我们希望在提交消息中包含票号 QF-1234 而不是“#improvement”宏。这样 SVN 客户端可以链接到票号。

我希望这种机制以同步和块的方式工作。明显的副作用是，如果无法达到 jira，则提交失败。但这是可以/可以接受的。

可以从预提交挂钩中实现自动票证创建。但我没有看到在提交完成之前更新提交消息的方法。

所以我的问题如下，有谁知道我将如何在 SVN 事务中更新提交消息（无需创建修改后的 SVN 库）。或者有一些其他可靠的方法来达到相同的结果。我知道我可以在新事务中更新提交消息，但这有很多不良副作用。

请注意，我对一个脆弱的解决方案非常满意，如果出现任何问题，它都会导致提交失败。重新提交很便宜，手动创建问题不到 1 分钟（但我不想浪费那一分钟）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T07:37:34.070

> 有谁知道我如何能够在 SVN 事务中更新提交消息

在挂钩中更改事务的内容是（即使*理论上*可能）**非常不安全且不推荐**的策略。简而言之：**永远不要这样做，如果您想获得可预测的结果！**

如果您必须在日志消息中进行替换，则必须在下一个独立提交（可能发生在 post-commit 钩子中）使用 propedit|propdel-propset （用于管理修订属性的第二种命令形式）

# 提交后挂钩任务的简短测试

**第 4 版的起点**

```
>svn log file:///Z:/PE-TEST/trunk
------------------------------------------------------------------------
r4 | Badger | 2013-02-16 14:41:46 +0600 (Сб, 16 фев 2013) | 1 line

Replacement
------------------------------------------------------------------------
r3 | Badger | 2013-02-16 14:33:46 +0600 (Сб, 16 фев 2013) | 1 line

Extended version
------------------------------------------------------------------------
r2 | Badger | 2013-02-16 14:32:00 +0600 (Сб, 16 фев 2013) | 1 line

Initial data
------------------------------------------------------------------------
r1 | Badger | 2013-02-16 14:27:49 +0600 (Сб, 16 фев 2013) | 1 line

Imported folder structure
------------------------------------------------------------------------ 
```

**第一次尝试**

```
>svn propset svn:log --revprop -r 4 "Replacement for #1234" file:///Z:/PE-TEST/
svn: E165006: Repository has not been enabled to accept revision propchanges;
ask the administrator to create a pre-revprop-change hook 
```

**pre-revprop-change 钩子**

```
type z:\PE-TEST\hooks\pre-revprop-change.bat
exit 0 
```

**最后的行动**

```
>svn propset svn:log --revprop -r 4 "Replacement for #1234" file:///Z:/PE-TEST/
property 'svn:log' set on repository revision 4 
```

**测试结果**

```
>svn log file:///Z:/PE-TEST/trunk -r 4
------------------------------------------------------------------------
r4 | Badger | 2013-02-16 14:41:46 +0600 (Сб, 16 фев 2013) | 1 line

Replacement for #1234
------------------------------------------------------------------------ 
```

* * *

# 一些笔记

您可能希望使用 -q 选项抑制钩子内 propset 的**所有**输出，并从文本文件中写入（使用 propget）/读取（使用 propset）日志数据（用于获取的管道，`-F file`用于设置的选项）

# haskell - 当前的 SYB 是否允许使用新类型扩展泛型函数？

> ID：14841903
> 
> 赞同：1
> 
> 时间：2013-02-12T21:10:58.380
> 
> 标签：haskell, generic-programming, scrap-your-boilerplate

[前](https://research.microsoft.com/en-us/um/people/simonpj/papers/hmap/hmap.ps) [两篇](https://research.microsoft.com/en-us/um/people/simonpj/papers/hmap/gmap2.ps)Scrap Your Boilerplate 论文描述了一种编写通用函数的方法，该函数适用于一般类型，但对特定类型有特殊情况。例如，[`fromJSON`](http://hackage.haskell.org/packages/archive/aeson/0.6.1.0/doc/html/src/Data-Aeson-Generic.html#fromJSON)在`aeson`包中，定义了一个用于从 JSON 转换的通用函数，但为 list 或 等类型提供了特殊情况`Int`：

```
parseJSON :: (Data a) => Value -> Parser a
parseJSON j = parseJSON_generic j
             `ext1R` list
             `ext1R` vector
             `ext2R'` mapAny
             `ext2R'` hashMapAny
             -- Use the standard encoding for all base types.
             `extR` (value :: F Integer)
             `extR` (value :: F Int)
              ... 
```

然而，正如[第三篇 SYB 论文](https://research.microsoft.com/en-us/um/people/simonpj/papers/hmap/gmap3.pdf)所指出的，“当泛型函数定义的递归结被捆绑时，所有类型特定的情况 [需要] 立即提供”。然后论文提出了一种通过类型类机制来解除这种限制的方法。

前两篇 SYB 论文是（经过一些修改）[`syb`](http://hackage.haskell.org/package/syb)包的一部分，但第三篇不是。是否有其他方法可以解除在 Hackage 上实施 SYB 时需要同时指定所有特定类型案例的限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:03:10.887

据我所知，没有办法绕过该系统内的限制。事实上，没有必要在第三篇论文中引入一种新方法。有工作 syb-with-class 代码，实现关于 hackage 的第三篇论文：http: [//hackage.haskell.org/package/syb-with-class](http://hackage.haskell.org/package/syb-with-class)

然而，我最近的建议是尝试使用新的泛型机制，它更快、更有原则、更灵活（尽管偶尔会很痛苦:-)）。

# php - 在 JQuery/Javascript 中使用值的问题

> ID：14841907
> 
> 赞同：6
> 
> 时间：2013-02-12T21:11:13.143
> 
> 标签：php, javascript, jquery, ajax

我有一个来自 Mysql 的 PHP 填充表，我正在使用 JQuery 来侦听是否单击了按钮，如果单击，它将获取有关他们单击的关联名称的注释。这一切都很好，只有一个问题。有时当您单击它并打开对话框（JQuery UI）窗口时，文本区域中没有任何内容。如果您再次单击它，它将弹出。所以有时似乎价值被抛弃了？我不确定，可以用手。

代码：

```
$(document).ready(function () {
    $(".NotesAccessor").click(function () {
        notes_name = $(this).parent().parent().find(".user_table");
      run();
    });

});
function run(){
    var url = '/pcg/popups/grabnotes.php';

    showUrlInDialog(url);
    sendUserfNotes();

}
    function showUrlInDialog(url)
    {
      var tag = $("#dialog-container");
      $.ajax({
        url: url,
        success: function(data) {
          tag.html(data).dialog
          ({
              width: '100%',
                modal: true
          }).dialog('open');
        }
      });
    }
    function sendUserfNotes()
    {

        $.ajax({
        type: "POST",
        dataType: "json",
        url: '/pcg/popups/getNotes.php',
        data:
        {
            'nameNotes': notes_name.text()

        },
        success: function(response) {
            $('#notes_msg').text(response.the_notes)
        }
    });

    }
    function getNewnotes(){
        new_notes = $('#notes_msg').val();
        update(new_notes);  
    }
    // if user updates notes
    function update(new_notes)
    {

            $.ajax({
        type: "POST",
        //dataType: "json",
        url: '/pcg/popups/updateNotes.php',
        data:
        {
            'nameNotes': notes_name.text(),
            'newNotes': new_notes   
        },
        success: function(response) {
            alert("Notes Updated.");
            var i;
             $("#dialog-container").effect( 'fade', 500 );

            i = setInterval(function(){
             $("#dialog-container").dialog( 'close' );
            clearInterval(i);
            }, 500);

            }
    });

    }
    /******is user closes notes ******/
    function closeNotes()
    {
        var i;
         $("#dialog-container").effect( 'fade', 500 );

        i = setInterval(function(){
         $("#dialog-container").dialog( 'close' );
        clearInterval(i);
        }, 500);

    } 
```

需要帮助请叫我！

更新：

基本布局是

```
<div>
   <div>
     other stuff...

     the table
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:22:04.520

很难从中分辨出来，尤其是没有标记的情况下，但 showUrlInDialog 和 sendUserfNotes 都是异步操作。如果 showUrlInDialog 在 sendUserfNotes 之后完成，则 showUrlInDialog 用返回的数据覆盖对话框容器的内容。这可能会或可能不会覆盖 sendUserfNotes 放入 #notes_msg 的内容 - 取决于标记的布局方式。如果是这样，那么它就可以解释为什么这些音符有时不会出现，似乎是随机的。这是一个竞赛条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:45:50.147

假设它`#notes_msg`位于 中`#dialog-container`，您必须确保操作以正确的顺序发生。

最好的方法是等待两个 ajax 调用完成然后继续。您可以使用 ajax 调用返回的 promises / jqXHR 对象来做到这一点，请参阅[手册的这一部分](http://api.jquery.com/jQuery.when/)。

你的代码看起来像（你必须测试它......）：

```
function run(){
    var url = '/pcg/popups/grabnotes.php';
    var tag = $("#dialog-container");

    var promise1 = showUrlInDialog(url);
    var promise2 = sendUserfNotes();

    $.when(promise1, promise2).done(function(data1, data2) {
      // do something with the data returned from both functions:
      // check to see what data1 and data2 contain, possibly the content is found
      // in data1[2].responseText and data2[2].responseText

      // stuff from first ajax call
      tag.html(data1).dialog({
          width: '100%',
          modal: true
        }).dialog('open');

      // stuff from second ajax call, will not fail because we just added the correct html
       $('#notes_msg').text(data2.the_notes)
    });
} 
```

您正在调用的函数应该只返回 ajax 调用的结果，不要做任何其他事情：

```
function showUrlInDialog(url)
{
  return $.ajax({
    url: url
  });
}
function sendUserfNotes()
{
  return $.ajax({
    type: "POST",
    dataType: "json",
    url: '/pcg/popups/getNotes.php',
    data: {
        'nameNotes': notes_name.text()
    }
  });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T22:44:36.127

有几种方法可以链接您的 ajax 调用，以防止 sendUserOfNotes() 在 ShowUrlInDialog() 之前完成。尝试使用 .ajaxComplete()

[jQuery.ajax 完成](http://api.jquery.com/ajaxComplete/)

您可以使用的另一种 ajax 链接技术是将下一个调用放在第一个调用的返回中。以下代码段应该让您走上正轨：

```
function ShowUrlInDialog(url){
    $.get(url,function(data){
        tag.html(data).dialog({width: '100%',modal: true}).dialog('open');
        sendUserOfNotes();
    });
}

function sendUserOfNotes(){
    $.post('/pcg/popups/getNotes.php',{'nameNotes': notes_name.text()},function(response){
        $('#notes_msg').text(response.the_notes)
    },"json");
} 
```

詹姆斯说得对。ShowUrlInDialog() 设置对话框的 html 并且 sendUserOfNotes() 更改对话框中元素的内容。每次 sendUserOfNotes() 首先返回 ShowUrlInDialog() 都会清除笔记。jeroen 的承诺示例也应该有效。

# jquery - 将单文件上传器适配为多文件上传器

> ID：14841908
> 
> 赞同：0
> 
> 时间：2013-02-12T21:11:14.593
> 
> 标签：jquery, ajax, file-upload

所以我今天一直在努力让拖放文件上传脚本工作，它适用于单个文件。我现在来尝试让它允许多个文件，但遇到了一个问题。

```
// Required for drag and drop file access
jQuery.event.props.push('dataTransfer');

// Set the dropzone
$("#dropzone-wrapper").on('drop', function(event) {
// Do something with the file(s)
var files = event.dataTransfer.files;

if (files.type.match('image.*')) {
    // If the file is an image, then run the processFileUpload function
    processFileUpload(files);
} else {
    alert("Not an image!");
}
});

// Process the file that was dropped
function processFileUpload(droppedFile) {

var uploadFormData = new FormData(); 
uploadFormData.append("image",droppedFile);

var bar = $('.bar');
var percent = $('.percent');

$.ajax({
    url : "Uploader/upload.php", // use your target
    type : "POST",
    beforeSend: function() {
        $('.progress').show();
        var percentVal = 0;
        bar.width(percentVal)
        percent.html(percentVal + '%');

        window.setInterval(function(){
            var x = (100 / (droppedFile.size / 100000));
            var x = Math.round(x);

            if (x >= 90) { clearInterval(); } else {
            percentVal = percentVal + x;
            percent.html(percentVal + '%');
            bar.width(percentVal + '%'); }
        }, 1000);

    },
    complete: function() {
        clearInterval();
        bar.width("100%");
        percent.html("100%");
    },
    data : uploadFormData,
    chache : false,
    contentType : false,
    processData : false,
    success : function(data) { 

        window.location = data;

    }
   });
} 
```

我得到的错误是 * *Cannot call method 'match' of undefined **这与第 9 行有关。现在我的猜测是它在检查多个文件时遇到问题，因为正如我所说，只检查一个就可以了。我该如何检查所有上传的文件是否都是图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:19:36.390

您必须单独添加每个文件，`files`是文件列表，您还必须更改`processFileUpload`以处理多个文件

```
var filesToUpload = [];
for (var i = 0; i < files.length; i++){
    if (files[i].type.match('image.*')) {
        filesToUpload.push(files[i]);
    } else {
        alert("Not an image!");
    }
}
processFileUpload(filesToUpload);

...

function processFileUpload(droppedFiles) {
...
var uploadFormData = new FormData(); 
for (var i = 0; i < droppedFiles.length; i++){
    uploadFormData.append("image[]",droppedFiles[i]);
}
... 
```

# jquery - 将表格行动画到另一个元素中

> ID：14841910
> 
> 赞同：0
> 
> 时间：2013-02-12T21:11:22.650
> 
> 标签：jquery, animation

我有一个页面，其中包含一个垃圾桶图像元素，以及它附近的一个表格。

我想不出一种正确执行 jquery 动画的方法，这样当我单击表格行中的链接时，表格行就会动画到垃圾桶中。

我能找到的大多数解决方案似乎只着眼于为表本身内的表行设置动画，但我想将行移出表并将其动画到我页面上的垃圾桶元素中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:32:34.550

我会做一些这样的事情。

一个重要的附带条件是，只有在表格中的所有测量值（边距、填充、字体大小、宽度、高度等）都在`ems`...下面只是代表我对这个问题的第一次尝试）。

```
var theTableRow = $(get the row);
// creating a duplicate rather than moving the original in order to preserve layout of the table
var newTable = $('<table class='same as on your original table'></table>')
                .html('<tbody class='same as on your original table'></tbody>')
                .children()
                .html(theTableRow.clone())
                .end();

newTable.css({
   // you'll need to adjust these values for padding and margin too
   left: get the left offset of the row,
   top: get the top offset of the row,
   position: 'absolute'
});

newTable.appendTo('body')
theTableRow.css('visibility', 'hidden');

newTable.animate({
   left: left offset of trashcan,
   top: top offset of trashcan,
   width: 0,
   height: 0,
   opacity: 0,
   font-size: 0
}, function () {
    theTableRow.remove(); // or you could slowly animate the height to 0 before removing
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:17:19.323

[http://jsfiddle.net/QWgRF/409/](http://jsfiddle.net/QWgRF/409/)

**这是 jsfidle 示例，可以帮助您使用 jquery dragable 来做同样的事情。** 您可以使用

```
 $(function() {
 $( "#draggable" ).draggable();
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:18:19.633

首先在窗口上找到该行的位置，然后将其`position:absolute;`放在该位置，然后将其 animate() 到垃圾箱，并使其变小。一旦它位于垃圾上方，然后将其淡出。

# web-services - CRM 2011 - 预期保持活动的连接被服务器关闭

> ID：14841914
> 
> 赞同：0
> 
> 时间：2013-02-12T21:11:48.773
> 
> 标签：web-services, dynamics-crm-2011, dynamics-crm, crm

有一天，我们遇到了从外部连接到 CRM 服务器的问题。当我们尝试使用 Web 服务与 CRM 进行通信或使用一些 Microsoft 实用程序（如 crmsvcutil.exe）时，服务器返回以下错误：

退出程序异常：底层连接已关闭：服务器关闭了预期保持活动状态的连接。

当我们使用 CRM WS 时，似乎对于第一个查询它工作正常并返回了数据。但是，当我们提出另一个查询时，它失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T19:16:34.340

如果启用了 IFD，那么我们需要检查 WPC 令牌过期时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T06:54:33.333

我们找到了以下对您有用的解决方案：

问题出在 IIS 上的 CRM 设置中。打开 IIS 并禁用“HTTP keep-alive”选项（CRM 网站 -> HTTP 响应标头 -> 在操作面板中设置通用标头） - [http://www.dotnetscraps.com/dotnetscraps/post/did-you-知道启用-http-keep-alive-in-iis-7-75.aspx](http://www.dotnetscraps.com/dotnetscraps/post/did-you-know-enable-http-keep-alive-in-iis-7-75.aspx)

如果您无法禁用整个 CRM 的保持活动选项，您可以更新使用 CRM Web 服务的代码（禁用代码中的保持活动设置）- [http://weblogs.asp.net/jan/archive/2004 /01/28/63771.aspx](http://weblogs.asp.net/jan/archive/2004/01/28/63771.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T23:39:13.367

我发现如果您尝试将`IEnumerable`某项从服务返回给客户端，也可能出现这种情况。

首先枚举它（基本上是 call `ToList()`）以确保在程序流继续之前检索所有数据并终止连接。

# appharbor - appharbor 上频繁的 504 网关超时

> ID：14841917
> 
> 赞同：0
> 
> 时间：2013-02-12T21:11:55.347
> 
> 标签：appharbor

在流量非常低的 appharbor 上部署了一个 asp.net mvc 4 应用程序。每次在部署几分钟不活动后访问应用程序时，我都会从 nginx 收到 504 网关超时错误。非常烦人，我该怎么做才能解决这个错误？

编辑：

appharbor 支持网站上的[支持票](http://support.appharbor.com/discussions/problems/21905-frequent-504-gateway-time-out)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T07:57:44.663

由于应用程序在请求超时内没有响应，因此返回 HTTP 504。应用程序启动可能需要一些时间，因此有时可能会在初始请求中返回 504。

免费计划中的应用程序在闲置 20 分钟后空闲。您可以升级到其中一个付费计划，因为它们在一段时间不活动后不会闲置。

我们（AppHarbor）正在努力减少应用程序启动所需的时间，这将进一步缓解这个问题。请注意，默认请求超时最近已增加到 120 秒，因此如果您继续遇到此问题，非常欢迎您开票并告诉我们应用程序名称，以便我们仔细查看。

# android - 单击“返回”按钮时终止启动画面

> ID：14841922
> 
> 赞同：0
> 
> 时间：2013-02-12T21:12:08.953
> 
> 标签：android, splash-screen, activity-lifecycle

我为我的 android 应用程序创建了一个启动画面。我的问题很简单。5 秒后闪屏消失，主要活动开始工作。然后，如果我单击“返回”按钮，它会再次返回启动画面。但我不想要这个。

如果用户在 mainactivity 上触摸“返回”按钮，应用程序必须进入没有启动屏幕的 android 菜单。我该如何解决？

```
package com.example.androidfirst;

import android.app.Activity;

public class SplashActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    setContentView(R.layout.splash_screen);

    Thread timer = new Thread() {   //new Thread
        @Override
        public void run() {

            try {
                sleep(5000);
            }
            catch (InterruptedException e) {

                e.printStackTrace();
            }
            finally {
                Intent MainAct = new Intent("com.example.androidfirst.MAINACTIVITY");
                startActivity(MainAct);

                try {
                    this.finalize();
                }
                catch (Throwable e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }

        }

    };

    timer.start();

}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-09-09T11:20:49.773

您可以在您的**AndroidManifest.xml**中使用启动画面的`android:noHistory="true"`in`<activity>`标记来实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T21:14:13.507

> 如果用户在 mainactivity 上触摸“返回”按钮，应用程序必须进入没有启动屏幕的 android 菜单。我该如何解决？

您可能会发现使用[Handler](https://developer.android.com/reference/android/os/Handler.html)和[Runnable](https://developer.android.com/reference/java/lang/Runnable.html)是一种更简单的方法来创建延迟，但只需调用`finish()`after `startActivity()`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T21:17:11.187

首先，不要使用闪屏。

不过，您必须使用 调用`finish()`和/或开始新活动`Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T21:17:30.533

您需要添加`onStop()`以指定在启动屏幕不再可见时要执行的操作。

`finish()`从那里打电话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T21:26:18.730

我强烈建议您不要仅仅为了拥有启动画面而使用启动画面。

如果在准备好向用户显示 UI（即从某个来源加载数据）之前需要执行一些长时间运行的任务，那么在加载该数据时显示启动画面是合适的。否则你只是在浪费你的用户时间。

5 秒似乎并不长，但是当您的用户坐在那里盯着无用的启动画面时，那段时间对他们来说似乎是永恒的。

如果您觉得必须使用闪屏，请阅读并吸收此页面上的知识：[SplashScreens Done Right](http://blog.iangclifton.com/2011/01/01/android-splash-screens-done-right/)

阅读完之后，请遵循他使用的示例，以便至少尽可能少地惹恼您的用户。

# jquery - fancybox2 媒体助手未在窗口中加载，启动 vimeo 站点

> ID：14841925
> 
> 赞同：0
> 
> 时间：2013-02-12T21:12:17.530
> 
> 标签：jquery, fancybox, fancybox-2

我不明白为什么fancybox2 媒体助手没有将我的vimeo 内容加载到fancyboc 中，而是在vimeo 网站上启动我的视频。

任何帮助是极大的赞赏。

将要

来自我的 fancybox.js 文件
`$('.fancybox-media-evcc') $(".fancybox").fancybox({ helpers : { media : {} } });`

从我的 html 文件
`<p><a class="fancybox-media-evcc" href="http://vimeo.com/58950757"> <img src="images/thumbs/video.jpg" alt="Video prepared for the NYC Landmarks Commission"></a> </p>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T11:27:34.643

这个 ：

```
$('.fancybox-media-evcc') $(".fancybox").fancybox({ helpers : { media : {} } }); 
```

...**是不正确**的，它应该是：

```
$('.fancybox-media-evcc').fancybox({ 
    helpers : { 
      media : {} 
    } 
}); 
```

或者你可以同时拥有：

```
// for elements with class fancybox
$(".fancybox").fancybox(); 

// for elements with class fancybox-media-evcc
$('.fancybox-media-evcc').fancybox({ 
    helpers : { 
      media : {} 
    } 
}); 
```

# c++ - How do I "reset" a buffer?

> ID：14841927
> 
> 赞同：1
> 
> 时间：2013-02-12T21:12:48.317
> 
> 标签：c++, pointers, memory, buffer

Say I create a member variable pointer `pBuffer`. I send this buffer into some unknown land to be filled with data. Now say pBuffer has an arbitrary amount of data in it.

Q: *Is there a way to reset pBuffer without completely deleting it, while still deallocating all unnecessary memory it was occupying?*

Example:

```
class Blah
{
public:

    unsigned char* pBuffer;

    Blah(){pBuffer = NULL;}
    ~Blah(){}

    FillBuffer()
    {
        //fill the buffer with data, doesn't matter how
    }

    ResetBuffer()
    {
        //????? reset the buffer without deleting it, still deallocate memory ?????
    }

};

int main()
{
    Blah b;
    b.FillBuffer();
    b.ResetBuffer();
    b.FillBuffer(); //if pBuffer were deleted, this wouldn't work
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:15:26.317

Try `realloc()` if you know the amount of stuff in the buffer vs the remaining space in the buffer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:16:55.977

Using only a single raw pointer, no; but if you keep a size variable you can reset the buffer relatively easily.

However, this being tagged as `C++`, I would like to caution you from doing this and will instead propose an alternative. This meets your requirement of allowing memory to be allocated then later for the buffer to be "reset", without deallocating the memory. As a side benefit, using `std::vector` means that *you* don't have to worry about the memory leaking in subsequent calls to `FillBuffer()`, specifically when the existing buffer is too small and would need to be reallocated.

```
#include <vector>

class Blah
{
public:

    std::vector<unsigned char> pBuffer;

    Blah(){}
    ~Blah(){}

    FillBuffer()
    {
        //fill the buffer with data, doesn't matter how
    }

    ResetBuffer()
    {
        pBuffer.clear();

        // if you _really_ want the memory "pointed to" to be freed to the heap
        // use the std::vector<> swap idiom:

        // std::vector<unsigned char> empty_vec;
        // pBuffer.swap(empty_vec);
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:18:01.597

Buffers typically need a maximum size and a current size. To "reset", you would set the current size to zero. When you use it again, you might need to grow or shrink the maximum size of the buffer. Use `realloc` or `malloc`/`new` and `memcpy` (which realloc does internally when growing) to move existing data to the new buffer.

Note that these are expensive operations. If you expect the buffer to need to grow from use to use, you might consider doubling its maximum size every time. This effectively amortizes the cost of the allocation and copy.

# php - SUM IF 条件真回波描述

> ID：14841931
> 
> 赞同：0
> 
> 时间：2013-02-12T21:13:05.567
> 
> 标签：php, mysql

细节：

```
lo means layout
lo_act_id ( activity id ), lo_time ( time spent ) , up_time and down_time , lo_description , lo_client_id 
```

如果活动 id < 到 99 表示正常运行时间

如果活动 id > 到 99 意味着停机但我已经停机，我想看看它的注释/原因。

这是我使用它的查询很好，但我不知道如何获取和显示`lo_description`

```
SELECT * , 
  SUM( IF( `lo_act_id` > 99 , lo_time , 0 )) AS down_time,
  SUM( IF( `lo_act_id` < 99 , lo_time , 0 ,lo_desc )) AS up_time
FROM tbl_Layout
LEFT  JOIN tbl_Client ON lo_client_id=client_code
GROUP BY lo_client_id 
```

这就是我得到的

```
Client   Spent Time  Downtime
1        216           3 
20       250           0 
16       10           16 
35       60            0
60       30            0 
```

**这就是我想要得到的：**

```
Client    Spend Time    Downtime    Note
1         216           3           Replace Network Card
20        250           0     
16        10            16          Replace Main Board
                                    Monthly Maintenance
                                    Hurricane affect facilities
35        60            0
60        30            0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:51:10.260

用于[`CAST`](http://dev.mysql.com/doc/refman/5.0/en/cast-functions.html)去掉“分钟”和“分钟”（假设该字段始终包含分钟，而不是秒或小时）。

用于[`GROUP_CONCAT`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)将描述粘在一起。

```
SELECT
  tbl_Client.*,
  SUM(IF(`lo_act_id` > 99, CAST(lo_time AS UNSIGNED), 0)) AS down_time,
  SUM(IF(`lo_act_id` < 99, CAST(lo_time AS UNSIGNED), 0)) AS up_time,
  GROUP_CONCAT(IF(`lo_act_id` > 99, lo_description, NULL) SEPARATOR "\n") AS note
FROM tbl_Layout
LEFT JOIN tbl_Client ON lo_client_id=client_code
GROUP BY lo_client_id 
```

# c# - 仅在有效登录时访问页面

> ID：14841932
> 
> 赞同：2
> 
> 时间：2013-02-12T21:13:07.080
> 
> 标签：c#, asp.net, asp.net-mvc-3

当用户输入正确的用户名和密码时，他/她将看到`MyNewPage.aspx`页面。这部分工作正常。但是，当我`http://localhost:49296/Pages/MyNewPage`直接在浏览器窗口中键入而不登录时，我仍然能够访问此页面。我想要做的是限制用户在不登录的情况下访问此页面。

我怎样才能做到这一点？

```
 [HttpPost]
        public ActionResult LogOn(LogOnModel model, string returnUrl)
        {
            if (ModelState.IsValid)
            {
                if (Membership.ValidateUser(model.UserName, model.Password))
                {
                    FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                    if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                        && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
                    {
                        return Redirect(returnUrl);
                    }
                    else
                    {
                        return RedirectToAction("MyNewPage", "Pages");

                    }
                }                
            }    
            return View(model);
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T21:15:01.023

放

```
[Authorize] 
```

在控制器/动作上

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T01:52:34.637

**确保用户登录以访问视图**

完成此操作的最简单方法是使用控制器操作方法上方的 Authorize 属性。例如，我们只希望用户在已经登录网站的情况下更改他们的密码。为了防止非授权用户访问更改密码视图，我们可以像这样限制访问：

```
[Authorize]
public ActionResult ChangePassword()
{
    ViewData["PasswordLength"] = MembershipService.MinPasswordLength;
    return View();
} 
```

您也可以通过像这样检查 User 对象来手动完成此操作：

public ActionResult ChangePassword()

```
{
    if (!User.Identity.IsAuthenticated)
        return RedirectToAction("LogOn", "Account");

    ViewData["PasswordLength"] = MembershipService.MinPasswordLength;
    return View();
} 
```

**确保用户具有特定角色以获得对视图的访问权限**

您可能有一些视图应该只能由特定角色的用户访问。这也可以使用 Authorize 属性来完成，如下所示：

```
[Authorize(Roles = "Administrator")]
public ActionResult Index()
{
    return View();
} 
```

您也可以使用以下方法在代码中完成此操作：

```
public ActionResult Index()
{
    if (!User.IsInRole("Administrator"))
        return RedirectToAction("LogOn", "Account");

    return View();
} 
```

**参考：[使用我们的角色和成员资格提供者](http://www.brianlegg.com/post/2011/05/09/Implementing-your-own-RoleProvider-and-MembershipProvider-in-MVC-3.aspx)**

# php - htaccess 重写来自不同页面的 url

> ID：14841937
> 
> 赞同：1
> 
> 时间：2013-02-12T21:13:30.167
> 
> 标签：php, .htaccess

我在 htaccess 文件中做这个 .. 用于从不同页面重写 url

```
Options +FollowSymLinks
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_-]+)$ profile.php?username=$1 [QSA]    
RewriteRule ^([a-zA-Z0-9_-]+)/$ profile.php?username=$1 [QSA] 
```

它工作正常..

现在我需要添加更多作为 facebook

你可以把 facebook.com/username

这是：facebook.com/profile.php?username=

＆你可以把 facebook.com/pagename 是：facebook.com/pages.php?username=

并且工作正常

从不同的页面..

我需要像这样..

有什么帮助吗？！

```
RewriteRule ^([a-zA-Z0-9_-]+)$ profile.php?username=$1 [QSA]    
RewriteRule ^([a-zA-Z0-9_-]+)/$ profile.php?username=$1 [QSA]   

RewriteRule ^([a-zA-Z0-9_-]+)$ index.php?username=$1 [QSA]  
RewriteRule ^([a-zA-Z0-9_-]+)/$ index.php?username=$1 [QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:25:07.590

您的正则表达式模式匹配相同，因此您将需要一些东西来区分页面和人员（或重定向到 profile.php 与 index.php）。

您可以通过以下两种方式之一完成此操作。首先，您可以全部转到一个页面，我们称之为redirect.php。在此页面上，您可以检查 id 值然后重定向。就像：

```
 RewriteRule ^([a-zA-Z0-9_-]+)/?$ redirect.php?id=$1 
```

在redirect.php 中，您抓取`$_GET['id']`并对其运行一些查询以确定它是页面还是人，然后使用以下内容进行重定向：

```
 header("Location: profile.php?username=".$_GET['id']); 
```

如果您严格查找与 Facebook 相关的内容，您可以点击图形 API 而不是数据库来确定它是页面还是个人 ID。（不确定它是否可以同时存在 - 但我认为不会）。

如果您没有数据库或数据源来确定它是一个页面还是一个人，那么您需要在 URL 字符串中添加一些内容来确定，例如 /pages/{pageid}，然后您可以重写您的规则到：

```
 RewriteRule pages/([a-zA-Z0-9_-]+)/?$ index.php?username=$1  # for pages
    RewriteRule ^([a-zA-Z0-9_-]+)/?$ profile.php?username=$1  # for people 
```

如果你不能在你的 URL 中使用某些东西并且没有办法通过数据库访问它，那么你就不走运了，因为你遇到了两个相同的模式。

# c++ - 简单程序中的无数错误

> ID：14841939
> 
> 赞同：0
> 
> 时间：2013-02-12T21:13:40.417
> 
> 标签：c++, cout, cin

当我删除 couts/cins 时，错误消失了：

> std::basic_istream<_CharT, *Traits>::* _istream_type& std::basic_istream<_CharT, _Traits>::operator>>(long double&) [with _CharT = char, _Traits = std::char_traits, std::basic_istream<_CharT,*特征>::* _istream_type = std::basic_istream]

这是代码：

```
#include <iostream>
#include <string>
using namespace std;

int main()
{
int x;   
int y;  
int z;   
cout << "Enter number of girrafes" << endl;
cin >> x >> endl;
cout << "Enter number of elephants" << endl;
cin >> y >> endl;
cout << "Enter number of tigers" << endl;
cin >> z >> endl;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:15:12.853

`cin >> x >> endl;`是非法的，它基本上是在说“读入`endl`”。

只需使用`cin >> x;`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:15:56.887

`endl`从 cin 语句中删除：

例如：`cin >> x;`而不是`cin >> x >> endl;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T21:17:17.477

你不能`>> endl`因为`endl`是一个输出流函数：[endl](http://www.cplusplus.com/reference/ios/endl/)

# c++ - C++ - 使用 fstream 将 txt 保存为 html

> ID：14841941
> 
> 赞同：-1
> 
> 时间：2013-02-12T21:13:44.900
> 
> 标签：c++, html, fstream

我正在创建一个简单的程序，用户将能够编辑程序创建的 .txt 文件，然后程序应该将该文件保存为 .html 文档。我不想使用任何库。

创建 .txt 文件：

```
std::ofstream file("save.txt"); 
```

我应该如何在不使用任何不必要的扩展的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:31:08.810

如果您有足够新的编译器：

```
std::ofstream("save.html") << std::ifstream("save.txt"); 
```

如果您有较旧的编译器：

```
std::ifstream in("save.txt");
std::ofstream out("save.html");
out << in; 
```

但是，这会生成具有不同名称的文件的完整且完全精确的副本。我真的建议使用特定于操作系统的函数调用来简单地重命名文件，或者更好的是，让用户直接将他们的数据输入到 html 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:34:27.023

将纯文本转换为 HTML 有三个注意事项。用户修改纯文本字符串后：

1.  将纯文本字符串中的所有换行符（`\n`、`\r`和`\n\r`）替换为 HTML 换行符元素（`<br/>`）。您可以使用标准库[字符串替换](http://www.cplusplus.com/reference/string/string/replace/)方法来执行此操作。
2.  将修改后的文本字符串包装在标准 HTML 文档结构中（并为文档添加标题）：`<!DOCTYPE html><html><head><title> -- TITLE GOES HERE -- </title><body> -- TEXT GOES HERE -- </body></html>`.
3.  将字符串保存为文本文件...只需使用扩展名`.html`而不是`.txt`.

# mysql - 子查询返回超过 1 行

> ID：14841945
> 
> 赞同：11
> 
> 时间：2013-02-12T21:09:53.873
> 
> 标签：mysql, mysql-5.5

```
select 
    disease_name 
from 
    disease 
where 
    disease_id=
    (select disease_id from disease_symptom where
        disease.disease_id=disease_symptom.disease_id AND 
        symptom_id=
               (select symptom_id from symptom where symptom.symptom_id=disease_symptom.symptom_id
                AND symptom_name='fever' OR symptom_name='head ache')) 
```

给出子查询返回多行的错误。原因是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-12T21:23:28.113

您的两个外部查询的结构是期望来自其子查询的单个结果。但是按照你的结构方式，你的子查询可能会返回一个以上的结果。如果您实际上*想要*多个结果，请像这样重组它：

```
... where disease_id IN (subquery returning multiple rows...) 
```

此外，子查询会导致性能下降，嵌套子查询会成倍恶化。您可能想考虑`INNER JOIN`改用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T21:23:04.290

分解你的查询，你有

主要查询：

```
select disease_name from disease where disease_id= 
```

子查询 1：

```
select disease_id from disease_symptom where
        disease.disease_id=disease_symptom.disease_id AND 
        symptom_id= 
```

子查询2：

```
select symptom_id from symptom where symptom.symptom_id=disease_symptom.symptom_id
            AND symptom_name='fever' OR symptom_name='head ache' 
```

由于您使用等号，子查询不能返回多个项目。`OR`由于正在使用，子查询 2 似乎有更大的机会返回 2 个项目。您可能希望尝试`IN`诸如`WHERE symptom_id IN (sub-query2)`with之类的子句`WHERE disease_id IN (sub-query1)`

# linux - 运行 autogen.sh 时出现问题

> ID：14841946
> 
> 赞同：7
> 
> 时间：2013-02-12T21:14:00.750
> 
> 标签：linux, bash, ubuntu

我已经从[http://libspatialindex.github.com/下载了 R 树](http://libspatialindex.github.com/)

由于在运行 ./autogen.sh 时找不到文件/文件夹，因此我从下面给出的 github 存储库下载了文件 autogen.sh：

[https://raw.github.com/libspatialindex/libspatialindex/9a5a2f4d83c3ec7be4dbf2c8a86341703d837185/autogen.sh](https://raw.github.com/libspatialindex/libspatialindex/9a5a2f4d83c3ec7be4dbf2c8a86341703d837185/autogen.sh)

现在当我运行**./autogen.sh**我得到“权限被拒绝”如果我运行**sh ./autogen.sh**我得到：

```
glibtoolize or libtoolize not found. Giving up! 
```

请建议我现在应该做什么

**编辑：我也想在我的 C++ 项目中使用 libspatialindex。我正在使用netbeans。我的意思是我想在我的 netbeans 项目中使用 libspatialindex 中的函数。我应该如何使用相同的。现在我已经在一个单独的目录中运行了 config 和 make 命令。我不知道如何在我的项目中使用它们。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T21:19:05.077

`libtool`从您的包管理器安装。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-28T05:45:06.823

要修复“权限被拒绝”错误，您需要编辑 autogen.sh 文件的权限。运行此命令： `chmod +x autogen.sh`

# forms - 如何从 Play Framework 2 模板中的值访问表单？

> ID：14841947
> 
> 赞同：2
> 
> 时间：2013-02-12T21:14:01.403
> 
> 标签：forms, scala, playframework, playframework-2.0

我只能在 Play Framework 2 模板中访问表单值，如下所示：

```
@eventForm("options[0].safeToDelete").value.toString() 
```

但我还需要能够从模板中的方法中访问它，如下所示：

```
optionFields(option: Field)(implicit handler: FieldConstructor, lang: play.api.i18n.Lang) = {
    @option("safeToDelete").value.toString()
}
@optionFields(eventForm("options[0]")) 
```

第一个示例返回`true`.

第二个返回`Some(true)`。

我怎样才能让第二个返回`true`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T22:15:52.800

在 Scala`Option[T]`中是一种处理空对象的不同方式。

它有两个子类型 -`Some[T]`和`None`. 您可以处理此问题的多种方法之一如下，

```
@option("safeToDelete").value.getOrElse(false).toString 
```

通读更多.. [http://www.tutorialspoint.com/scala/scala_options.htm](http://www.tutorialspoint.com/scala/scala_options.htm)

# java - 获取声明的方法 - Java

> ID：14841952
> 
> 赞同：1
> 
> 时间：2013-02-12T21:14:22.547
> 
> 标签：java, class, reflection

假设我有以下三个类

**爪哇**

```
public class A {
    public static void main (String[] args) {
        new C();
    }
} 
```

**B.java**

```
import java.lang.reflect.Method;
import java.util.Arrays;

public class B {
    public B() {
        Method[] m = this.getClass().getDeclaredMethods();
        System.out.println(Arrays.toString(m));
    }

    public void hello() {

    }
} 
```

**C.java**

```
public class C extends B{
    public C() {
        super();
    }
} 
```

我在 A 类中运行 main 方法。好吧，它应该实例化 C 类，而 C 类又应该调用 B 类的构造函数，以打印出声明的方法。输出是`[]`。这让我感到惊讶，因为我期望输出是（假设所有类都在 package called 中`test`）：

```
[public void test.B.hello()] 
```

那么，怎么了？我如何得到它，以便这是实际的输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T21:15:57.680

`getClass`返回实例的类。在这种情况下，这是`C`。类中没有声明的方法`C`。`Class`您还可以使用返回对象的“getSuperClass”方法来解决您的问题：

```
Class c = this.getClass();
while (c != null) {
  System.out.println(Arrays.toString(c.getDeclaredMethods()));
  c = c.getSuperClass();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:27:43.930

这里的关键是使用单词`this`That 暗示当前上下文，它 if`C`是 is 的具体子`B`类`C`。要获取`B's`方法，您需要遍历直到到达 B。这可能取决于应用程序逻辑。一种方法如下。

```
import java.lang.reflect.Method;
import java.util.Arrays;

public class B {
    public B() {
        Class<?> parent = getClass();
        while(parent.getSuperclass() != null) {
            if(parent.getSuperclass() != Object.class) {
                parent = parent.getSuperclass();
            } else {
                break;
            }
        }
        Method[] m = parent.getDeclaredMethods();
        System.out.println(Arrays.toString(m));
    }

    public void hello() {

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-04T18:55:27.713

//其实可以得到不同包下不同类中方法的个数......
//去看看结果......

```
import java.lang.reflect.Method;

    public class TestPackage {
        public static void main(String args[]) throws ClassNotFoundException
        {
            int count=0;
            Class c=Class.forName("java.util.Scanner");
            Method[] m=c.getDeclaredMethods();
            for(Method m1:m)
            {
                count++;
                System.out.println(m1.getName());
            }
            System.out.println("The no. of methods are:"+count);

        }

    } 
```

# python - 基于列表元素和列表值的字典键

> ID：14841956
> 
> 赞同：1
> 
> 时间：2013-02-12T21:14:47.577
> 
> 标签：python, list, dictionary, python-2.7

我正在扫描一个文档，列出读入的每一行。

我将其保存到一个名为

```
testList = [] 
```

当我完成填充此列表时，我想将其设置为字典中的值，其键基于另一个列表的元素。这个想法是它应该看起来像这样：

```
testList = ['InformationA', 'InformationB', 'Lastinfo']
patent_offices = ['European Office', 'Japan Office']
dict_offices[patent_offices[0]] = testList 
```

或者

```
dict_offices = {'European Office' : ['InformationA', 'InformationB', 'Lastinfo'],
'Japan Office' : ['Other list infoA', 'more infoB']} 
```

我想稍后输入`dict_offices['European Office']`并打印列表。

但是因为我在阅读文档时会动态收集它，所以我会擦除并重用它 `testList`。我所看到的是在它被清除后它也在字典的链接中被清除。

如何创建字典以便保存它以便我可以在每个循环中重用 testList？

这是我的代码：

```
patent_offices = []
dict_offices = {}
office_index = 0
testList = []

# --- other conditional code not shown

if (not patent_match and start_recording):
                if ( not re.search(r'[=]+', bString)): #Ignore ====== string

                        printString = fontsString.encode('ascii', 'ignore')   
                        testList.append(printString)                         

    elif (not start_recording and patent_match):

                dict_offices[patent_offices[office_index]] = testList
                start_recording = True
                office_index += 1
                testList[:] = [] 
```

这本字典已正确更新，并且看起来与我想要的完全一样，直到我调用

```
testList[:] = [] 
```

线。这本字典就像`testList`. 我知道字典与此相关，但我不知道如何不发生这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:21:45.227

列表是可变的；对同一列表的多次引用将看到您对其所做的所有更改。意思是：用一个空列表`testList[:] = []`替换这个列表中的每个*索引。*因为您在不同的地方（包括在字典值中）引用了同一个列表，所以您会看到随处反映的变化。

相反，只需指向`testList`一个*新*的空列表：

```
testList = [] 
```

您使用的空切片分配语法应该只在您想清除列表的*内容*时使用，而不是在您只想创建一个新的空列表时使用。

```
>>> foo = []
>>> bar = foo
>>> foo.append(1)
>>> bar
[1]
>>> foo is bar
True
>>> foo[:] = []
>>> bar
[]
>>> foo = ['new', 'list']
>>> bar
[]
>>> foo is bar
False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T21:29:19.880

你将不得不做一个深拷贝，[见 copy.html](http://docs.python.org/2/library/copy.html)

```
dict_offices[patent_offices[office_index]] = copy.deepcopy(testList) 
```

例子：

```
l = [1,2,3]
b = l
del l[:]
print(b)
 ---> []

l = [1,2,3]
b = copy.deepcopy(l)
l = []
print (b)
  ---> [1,2,3] 
```

# linq - 如何在 Linq 中组合字典？

> ID：14841971
> 
> 赞同：1
> 
> 时间：2013-02-12T21:15:32.723
> 
> 标签：linq

我是Linq的新手。我有这样的代码：

```
public class Data
{
    public Dictionary<string,int> WordFrequency; 
}
List<Data> dataList; 
```

我想要的是一个聚合字典，它为整个 Data 对象列表执行组合 WordFrequency。我知道如何使用循环来做到这一点（遍历列表，然后遍历每个字典），我的问题是，Linq 的语法是什么？谢谢你。

编辑：这是我的（未经测试的）循环方法，所以你可以明白我的意思。

```
 public static Dictionary<string, int> Combine()
    {
        Dictionary<string, int> result;
        foreach (Data data in DataList)
        {
            foreach (string key in data.WordFrequencies.Keys)
            {
                if(!result.ContainsKey(key))
                    result[key] = 0;

                result[key] += data.WordFrequencies[key];
            }
        }
   } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T21:21:18.150

因此，您想将所有字典扁平化为一个没有重复键的字典 - 当然？

您可以使用`Enumerable.SelectMany`来展平所有键和`Enumerable.GroupBy`对键进行分组。

```
Dictionary<string, int> allWordFrequency = dataList
            .SelectMany(d => d.WordFrequency)
            .GroupBy(d => d.Key)
            .ToDictionary(g => g.Key, g => g.Sum(d => d.Value)); 
```

我假设您想对所有频率求和。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:33:12.690

这是一个在大多数方面与 Tim 相同的基于查询的解决方案：

```
Dictionary<string, int> allWordFrequency =
    (from d in dataList
    from kvp in d.WordFrequency
    group kvp.Value by d.Key)
       // ^^^^^^^^^ this grouping projection...
    .ToDictionary(g => g.Key, g => g.Sum());
  // ...eliminates need for lambda here ^^ 
```

我很欣赏这两个`from`子句如何`foreach`在帖子的基于循环的方法中模仿嵌套循环。像 Tim 的解决方案一样，查询迭代 Dictionary 的 KeyValuePair，而不是迭代 Keys 集合——这样查询不需要调用索引器来获取相应的整数计数值。

# asp.net-mvc - 使用动态 .aspx 页面 ASP.NET MVC 3 将数据持久化回 ViewModel

> ID：14841976
> 
> 赞同：0
> 
> 时间：2013-02-12T21:15:53.613
> 
> 标签：asp.net-mvc, asp.net-mvc-3, mvvm

我有一个使用数据库中的对象动态创建的视图。如果它是动态创建的，如何从我的视图中获取值并将它们传递给我的视图模型？我知道这个问题很模糊，但希望通过我的代码可以帮助你。

看法

```
 <asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<% using (Html.BeginForm()) {%>
<h1>Survey Says...</h1>
<ol>       
<li>
    Name: <input type="text" disabled="true" name="name" value="<%= Model.Name %>"/> 
</li>                                                  

<li>
    Email: <input type="text" disabled="true" name="email" value="<%= Model.Email %>"/>
</li>

<%foreach(SurveyQuestions s in Model.myQuestions)
  { %>   

    <li>    <%= s.QuestionText %>    <br />
    <%
    foreach(SurveyQuestionAnswers q in s.QuestionAnswers)
    {

    %>
        <input type="radio" name="rbGroup<%= q.Id%>"/> <%= q.DisplayText %><br/>

        <% 
     if(q.IsEditable)
     {
         %>
            <input type="text" id="txtOther<%= q.Id %>"/>
         <%
     }
    }
      %>           

    </li>

 <% } 

  %>      
           <li>
    <input type="submit" value="Save" id="save-button" />
</li>

</ol>
<% } %> 
```

问卷调查类

```
public class SurveyQuestions
{
    public string QuestionText { get; set; }
    public List<SurveyQuestionAnswers> QuestionAnswers { get; set; }
    public int Id { get; set; }
} 
```

调查问题答案类

```
 public class SurveyQuestionAnswers
{
    public int Id { get; set; }
    public string DisplayText { get; set; }
    public bool IsEditable { get; set; }
} 
```

我草率的 ViewModel

```
 public class GfcPreInterventionSurveyViewModel
{
    static SurveyService myService = new SurveyService(new SurveyRepository());

    [DisplayName("Name")]
    [Required(ErrorMessage = "Name is required.")]
    public string Name { get; set; }

    [DisplayName("Work Email")]
    [Email(ErrorMessage = "The email you entered is not valid.")]
    public string Email { get; set; }

    [DisplayName("Gender")]
    [Required(ErrorMessage = "Gender is required.")]
    public string Gender { get; set; }

    [DisplayName("Country")]
    [Required(ErrorMessage = "Country is required.")]
    public string Country { get; set; }

    [DisplayName("Business")]
    [Required(ErrorMessage = "Please select a business unit.")]
    public string BusinessUnit { get; set; }

    public SelectList GenderList;
    public SelectList BusinessList;
    public SelectList CountryList;
    public SelectList RoutineList;
    public SelectList ReasonList;
    public SelectList ActivityList;
    public SelectList HealthList;
    public SelectList EnergyList;

    public SelectListItem GenderItem;
    public SelectListItem BusinessItem;
    public SelectListItem CountryItem;
    public SelectListItem RoutineItem;
    public SelectListItem ReasonItem;
    public SelectListItem ActivityItem;
    public SelectListItem HealthItem;
    public SelectListItem EnergyItem;

    public Boolean ToGetFit { get; set; }
    public Boolean ToChallengeMyself { get; set; }
    public Boolean ToIncrEnergy { get; set; } 
    public Boolean ToBuildMorale { get; set; }
    public Boolean ToBeHealthier { get; set; }
    public Boolean ChallengeOther { get; set; }

    public string OtherString { get; set; }    

    [DisplayName("Exercise Routine")]
    [Required(ErrorMessage = "Which option describes your exercise routine.")]
    public string Routine { get; set; }

    [DisplayName("Physical Activity")]
    [Required(ErrorMessage = "Which option describes your physical activity.")]
    public string Activity { get; set; }

    [DisplayName("Overall Health")]
    [Required(ErrorMessage = "Which option describes your overall health.")]
    public string Health { get; set; }

    [DisplayName("Energy")]
    [Required(ErrorMessage = "Which option best describes your energy.")]
    public string Energy{ get; set; }

    public int ReasonsForChallenge { get; set; }

    public List<SurveyQuestions> myQuestions = new List<SurveyQuestions>();
    //public List<SurveyQuestionAnswers> myAnswers;

    public void build(int id)
    {
        var myService = new SurveyService(new SurveyRepository());

        myQuestions = myService.GetSurveyQuestions(id);

            } 
```

我的 getSurveyQuestions 方法返回一个 SurveyQuestions 对象列表。

目前，在我的控制器中，当点击保存时，调用 post 方法。这是我想用视图模型中的值更新我的数据库的地方，但是因为我的页面是如此动态，我无法访问用户的输入。

我的控制器：

```
public class SurveyController : WidgetControllerBase
{
    #region Private Members
    private readonly ISurveyRepository _surveyRepository;
    #endregion

    #region Constructors

    public SurveyController(ISurveyRepository surveyRepository)
    {
        if (surveyRepository == null)
        {
            throw new ArgumentNullException("surveyRepository");
        }
        _surveyRepository = surveyRepository;
    }

    #endregion

    // GET: /Survey/GfcPreIntervention
    public ActionResult GfcPreInterventionSurvey()
    {

        var surveyService = new SurveyService();
        var vm = new GfcPreInterventionSurveyViewModel();

        vm.build(AppUserInstance.Id);

        //paymentService.SetDVDShipped(payment.PaymentId);
        return View(vm);
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult GfcPreInterventionSurvey(GfcPreInterventionSurveyViewModel viewModel)       
    {
        return View(viewModel);                     
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:34:08.783

由于您的页面是高度动态的，也许您最好编写一个**自定义模型活页夹**。虽然这个词听起来很吓人，但实际上并没有那么复杂。

您只需创建一个将实现`IModelBinder`. 在此类中，您将可以访问表单集合并可以使用它填充任何复杂的对象

以下是一些值得一看的例子

[http://dotnetslackers.com/articles/aspnet/Understanding-ASP-NET-MVC-Model-Binding.aspx](http://dotnetslackers.com/articles/aspnet/Understanding-ASP-NET-MVC-Model-Binding.aspx)

[http://ivanz.com/2010/11/03/custom-model-binding-using-imodelbinder-in-asp-net-mvc-two-gotchas/](http://ivanz.com/2010/11/03/custom-model-binding-using-imodelbinder-in-asp-net-mvc-two-gotchas/)

正如您所知道的，使用辅助方法（最好使用 Razor）将清理 UI 代码

# asp.net - IIS AAR - 反向代理的 URL 重写 - 如何发送 HTTP_HOST

> ID：14841986
> 
> 赞同：29
> 
> 时间：2013-02-12T21:16:35.800
> 
> 标签：asp.net, iis, url-rewriting, iis-7.5, arr

尝试在多个后端 IIS 服务器前使用 AAR 作为反向代理。

*   分配给运行 IIS/AAR 的服务器的一个公共 IP 地址

*   然后设置出站 URL 重写规则以根据主机名重定向到多个后端服务器之一。

有点工作，但总是返回后端服务器默认站点（不是映射到主机名的站点），因此看起来主机名（HTTP_HOST）没有从代理服务器传递到后端服务器。

*（我已经通过编辑主机验证绕过反向代理，后端服务器返回绑定到主机头的正确站点）*

这是一个规则示例（192.168.0.99 是内部服务器，site.myco.com 是主机名）

```
 <rewrite>
        <rules>
            <rule name="ReverseProxyInboundRule1" stopProcessing="true">
                <match url="(.*)" />
                <action type="Rewrite" url="http://192.168.1.99/{R:1}" />                   
            </rule>
        </rules>
    </rewrite> 
```

尝试过放置服务器变量

```
 <!-- Guessing server.myco.com is hard coded -->
    <serverVariables>
        <set name="HTTP_HOST" value="server.myco.com" />
    </serverVariables>

    <!-- Guessing picked up dynamically from incoming request host header -->
    <serverVariables>
        <set name="HTTP_HOST" value="{HTTP_HOST}" />
    </serverVariables> 
```

但唉总是返回默认绑定 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-02-12T22:15:06.693

这篇文章有答案 - [Modifying headers with IIS7 Application Request Routing](https://stackoverflow.com/questions/1842885/modifying-headers-with-iis7-application-request-routing)

需要启用 preserveHostHeader - 在 UI 中看不到你是如何做到的，但这有效

从命令行运行它以更新 Machine/webroot/apphost 配置

```
%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/proxy -preserveHostHeader:true /commit:apphost 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-05-27T13:36:42.923

您可以使用 GUI 执行此操作。在根服务器上单击配置编辑器，转到 System.webServer -> 代理并将 preserveProxyHeader 设置为 true。

[![在此处输入图像描述](../Images/7b53511b63cc3f9e24ef08105f2970ba.png)](https://i.stack.imgur.com/YhOnS.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T22:09:16.700

我的猜测是您的服务器不允许您`HTTP_HOST`在重写 URL 时更改服务器变量。

在应用 URL 重写的网站级别：

![网管](../Images/2b06a40319488b1d00d96ef33d14a18d.png)

然后单击`Add...`右侧选项卡上的链接并添加您的`HTTP_HOST`变量：

![添加 HTTP_POST](../Images/299cdc7ed76b9f5193cd943922d464de.png)

# java - GWT RPC 失败，没有错误也没有异常

> ID：14841991
> 
> 赞同：0
> 
> 时间：2013-02-12T21:16:49.427
> 
> 标签：java, gwt, rpc

我有一个登录用户的 RPC 服务。如果用户名和密码有效，一切正常。但是，如果用户名和密码无效，服务器端代码似乎可以正常执行，但`onFailure()`会触发回调方法。除了`onFailure()`方法本身之外，没有错误或异常。客户端出现的异常是通用的“500 服务器调用失败；有关详细信息，请参阅服务器日志”

我已将所有代码包装在一个 try/catch 块中，以确保在运行时不会引发异常。

这是有问题的方法：

```
public OmsConsumer login(String username, String password, String ip) {

    OmsUser user = auth.validate(username, password, ip);

    OmsConsumer consumer;

    if(user.isValid()){
        logger.info("User is Valid");

        consumer = getConsumerByPersonId(user.getPersonId());       
    }else {
        logger.info("User is INVALID");

        consumer = new OmsConsumer();

        consumer.setValid(false);
        consumer.setErrors(user.getErrors());

            logger.info("Errors: " + consumer.getErrors().size());
    }
    return consumer;
} 
```

同样，当`user.isValid()`返回 true 时，没有问题。`onFailure()`仅在返回 false 时触发`user.isValid()`。

我对此感到困惑，因此非常感谢任何调试提示或建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:11:57.157

感谢您的提示。我最终在不同的班级发现了问题。OmsError 类实现了 Serializable，但没有无参数构造函数。调试时，我将整个方法包装在 try/catch 中，所以我不确定为什么我没有从中得到异常。但是，一旦我添加`public OmsError(){}` 到 OmsError 类，一切都很好。

# c - 复杂的c代码，我需要任何人来解释它是如何工作的？

> ID：14841995
> 
> 赞同：-2
> 
> 时间：2013-02-12T21:16:58.493
> 
> 标签：c

我有以下函数，女巫获取一个整数（十进制数）并在将其转换为二进制后返回该整数的个数，（例如，如果我们传递 6，该函数将返回 2，因为十进制的 6 等于二进制的 110） . 这很好，但不幸的是我无法理解它是如何工作的。代码是：

```
int number_of_ones(int i){
    i = i - ((i >> 1) & 0x55555555);
    i = (i & 0x33333333) + ((i >> 2) & 0x33333333);
    return (((i + (i >> 4)) & 0x0F0F0F0F) * 0x01010101) >> 24;
} 
```

有没有人可以向我解释它是如何工作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:17:56.847

这是一种无需分支即可计算设置为 1 的位数的算法。这里描述：

[http://graphics.stanford.edu/~seander/bithacks.html](http://graphics.stanford.edu/~seander/bithacks.html)

# tree - 如何导航 nltk.tree.Tree？

> ID：14841997
> 
> 赞同：25
> 
> 时间：2013-02-12T21:17:08.027
> 
> 标签：tree, nltk

我已经使用以下方法分块了一个句子：

```
grammar = '''                                                                                                              
    NP:                                                                                                                    
       {<DT>*(<NN.*>|<JJ.*>)*<NN.*>}                                                                                       
     NVN:                                                                                                                  
       {<NP><VB.*><NP>}                                                                                                    
    '''
chunker = nltk.chunk.RegexpParser(grammar)
tree = chunker.parse(tagged)
print tree 
```

结果如下所示：

```
(S
  (NVN
    (NP The_Pigs/NNS)
    are/VBP
    (NP a/DT Bristol-based/JJ punk/NN rock/NN band/NN))
  that/WDT
  formed/VBN
  in/IN
  1977/CD
  ./.) 
```

但现在我一直在试图弄清楚如何导航。我希望能够找到 NVN 子树，并访问左侧的名词短语（“The_Pigs”）、动词（“are”）和右侧的名词短语（“a Bristol-based punk rock band”） . 我怎么做？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-03-08T14:10:29.687

尝试：

```
ROOT = 'ROOT'
tree = ...
def getNodes(parent):
    for node in parent:
        if type(node) is nltk.Tree:
            if node.label() == ROOT:
                print "======== Sentence ========="
                print "Sentence:", " ".join(node.leaves())
            else:
                print "Label:", node.label()
                print "Leaves:", node.leaves()

            getNodes(node)
        else:
            print "Word:", node

getNodes(tree) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-04T23:12:35.173

当然，您可以编写自己的深度优先搜索……但有一种更简单（更好）的方法。如果您希望每个子树都以 NVM 为根，请使用 Tree 的子树方法并定义过滤器参数。

```
>>> print t
(S
    (NVN
        (NP The_Pigs/NNS)
        are/VBP
        (NP a/DT Bristol-based/JJ punk/NN rock/NN band/NN))
    that/WDT
    formed/VBN
    in/IN
    1977/CD
    ./.)
>>> for i in t.subtrees(filter=lambda x: x.node == 'NVN'):
...     print i
... 
(NVN
    (NP The_Pigs/NNS)
    are/VBP
    (NP a/DT Bristol-based/JJ punk/NN rock/NN band/NN)) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-12-11T03:25:28.150

这是一个代码示例，用于生成带有标签“NP”的所有子树

```
def filt(x):
    return x.label()=='NP'

for subtree in t.subtrees(filter =  filt): # Generate all subtrees
    print subtree 
```

对于兄弟姐妹，您可能想看看方法`ParentedTree.left_siblings()`

有关更多详细信息，这里有一些有用的链接。

[http://www.nltk.org/howto/tree.html](http://www.nltk.org/howto/tree.html) #一些基本用法和示例 [http://nbviewer.ipython.org/github/gmonce/nltk_parsing/blob/master/1.%20NLTK%20Syntax%20Trees。 ipynb](http://nbviewer.ipython.org/github/gmonce/nltk_parsing/blob/master/1.%20NLTK%20Syntax%20Trees.ipynb) #a notebook playwith这些方法

[http://www.nltk.org/_modules/nltk/tree.html](http://www.nltk.org/_modules/nltk/tree.html) #all api with source

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-13T22:26:23.293

尝试这个：

```
for a in tree:
        if type(a) is nltk.Tree:
            if a.node == 'NVN': # This climbs into your NVN tree
                for b in a:
                    if type(b) is nltk.Tree and b.node == 'NP':
                        print b.leaves() # This outputs your "NP"
                    else:
                        print b # This outputs your "VB.*" 
```

它输出这个：

> [（'The_Pigs'，'NNS'）]
> 
> （'是'，'VBP'）
> 
> [('a', 'DT'), ('Bristol-based', 'JJ'), ('punk', 'NN'), ('rock', 'NN'), ('band', 'NN' ')]

# ssis - 在 SSIS 中将行转换为列。不转动？

> ID：14841998
> 
> 赞同：2
> 
> 时间：2013-02-12T21:17:08.307
> 
> 标签：ssis, bids

如果我有这样的数据

```
"","",WAREHOUSE ID,1,2,3,4,5...
"","",WAREHOUSE CODE,BOS,HOU,LAX,NYC,CHI...
"","",WAREHOUSE NAME,BOSTON,HOUSTON,LOS ANGELES,NEW YORK CITY,CHICAGO... 
```

但是想这样改造

```
 WAREHOUSE ID, WAREHOUSE CODE, WAREHOUSE NAME
 1,BOS,BOSTON
 2,HOU,HOUSTON
 3,LAX,LOS ANGELES
 ... 
```

如果如上所述，[Column 2] 是包含应该是标题行的列，并且第 3 到 40 列包含应该是行值的列，则选择哪些列并设置为通过 UNPIVOT 执行所需的转置?

还是 UNPIVOT 甚至不是我想要的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-15T04:52:27.243

使用一个数据流解决问题在技术上是可行的。[我在这里发布了解决相同问题](https://stackoverflow.com/questions/15736108/split-fixed-width-row-into-multiple-rows-in-ssis/20591207#20591207)所需的基本步骤。话虽如此，配置数据流中的所有元素需要做很多工作。