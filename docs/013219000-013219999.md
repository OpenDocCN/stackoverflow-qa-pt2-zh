# StackOverflow 问答 13219000-13219999

# http - 记录和自动化 http 请求

> ID：13219000
> 
> 赞同：0
> 
> 时间：2012-11-04T13:37:00.157
> 
> 标签：http, networking, httprequest

我有一个通用路由器，我想记录配置步骤，然后再次执行它们.. 步骤将通过 http

您能否为我提供一个可以帮助完成此任务的 reliabe 工具或开源应用程序或浏览器插件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T09:51:13.953

试试 Selenium，它是一种自动化测试工具

[http://seleniumhq.org/](http://seleniumhq.org/)

# java - Jasper 报告 - OutOfMemoryError: PermGen space

> ID：13219001
> 
> 赞同：1
> 
> 时间：2012-11-04T13:37:00.447
> 
> 标签：java, groovy, jasper-reports

最近，在重负载下进行测试时，我开始在我的新 jasper 报告应用程序中遇到 PermGen 空间问题。`language="groovy`通过在我的 jrxml 文件中指定，我使用 groovy 作为报告的表达式评估器。作为 groovy 表达式，在运行时创建类，我怀疑这是 permgen 填充的根本原因。我尝试设置 jvm 选项，例如**-XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled**，但它无助于解决问题。即使在 excpetion stacktrace（如下所示）中，类加载器也在尝试在失败时将新构建的类加载到 permgen 中。有没有人在使用 groovy 和 jasper 报告时遇到过这个问题？我的报告使用由提供的功能在单独的线程中异步填充`AsynchronousFillHandle`jasper 提供的课程。这与类加载器没有释放加载的运行时类有任何联系吗？任何建议将不胜感激。

```
 Exception in thread "Thread-563" java.lang.OutOfMemoryError: PermGen space
Exception in thread "Thread-565"        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClassCond(Unknown Source)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts.define(ClassLoaderForClassArtifacts.java:42)
        at org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts$1.run(ClassLoaderForClassArtifacts.java:86)
        at org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts$1.run(ClassLoaderForClassArtifacts.java:84)
        at java.security.AccessController.doPrivileged(Native Method)
        at org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts.defineClassAndGetConstructor(ClassLoaderForClassArtifacts.java:84)
        at org.codehaus.groovy.runtime.callsite.CallSiteGenerator.compilePogoMethod(CallSiteGenerator.java:215)
        at org.codehaus.groovy.reflection.CachedMethod.createPogoMetaMethodSite(CachedMethod.java:220)
        at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.createCachedMethodSite(PogoMetaMethodSite.java:206)
        at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.createPogoMetaMethodSite(PogoMetaMethodSite.java:182)
        at groovy.lang.MetaClassImpl.createPogoCallCurrentSite(MetaClassImpl.java:3034)
        at org.codehaus.groovy.runtime.callsite.CallSiteArray.createCallCurrentSite(CallSiteArray.java:93)
        at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:44)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:141)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:149)
        at Section_1_1348126593121_343308.evaluate(calculator_Section_1_1348126593121_343308:253)
        at net.sf.jasperreports.engine.fill.JREvaluator.evaluate(JREvaluator.java:190)
        at net.sf.jasperreports.engine.fill.JRCalculator.evaluate(JRCalculator.java:591)
        at net.sf.jasperreports.engine.fill.JRCalculator.evaluate(JRCalculator.java:559)
        at net.sf.jasperreports.engine.fill.JRFillElement.evaluateExpression(JRFillElement.java:884)
        at net.sf.jasperreports.engine.fill.JRFillTextField.evaluateText(JRFillTextField.java:421)
        at net.sf.jasperreports.engine.fill.JRFillTextField.evaluate(JRFillTextField.java:406)
        at net.sf.jasperreports.engine.fill.JRFillElementContainer.evaluate(JRFillElementContainer.java:257)
        at net.sf.jasperreports.engine.fill.JRFillBand.evaluate(JRFillBand.java:457)
        at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillColumnBand(JRVerticalFiller.java:2037)
        at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillDetail(JRVerticalFiller.java:771)
        at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReportContent(JRVerticalFiller.java:301)
        at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReport(JRVerticalFiller.java:148)
        at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:909) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:05:29.240

作为第一个赌注...尝试增加 perm gen 大小，如下所示：

```
-XX:MaxPermSize=128m 
```

默认为 64m。

希望这可以帮助

# session - Extbase：在域 B 中访问域 A 中的会话

> ID：13219002
> 
> 赞同：0
> 
> 时间：2012-11-04T13:37:04.553
> 
> 标签：session, cross-domain, typo3, extbase

我目前正在 Extbase 1.3/Typo3 4.5 中开发商店扩展，其中结帐过程将在与商店不同的域下处理（域 A 具有商店和 HTTP，域 B 具有结帐和 HTTPS）。在结帐过程中，我需要访问域 A 的前端用户会话的内容（例如，用于检索职位）。我通过将控制器中的前端用户 ID 传递给结帐来尝试这个

```
$this->uriBuilder->reset();
$this->uriBuilder->setArguments(array('fe_typo_user'=>$GLOBALS ['TSFE']->fe_user->id));
$url = $this->uriBuilder->uriFor('newCheckout');
$this->redirectToUri($url); 
```

但这似乎对域 B 中用户的创建没有任何影响（域 B 中的用户 id 与域 A 中传入的用户 id 不同）。

有没有办法通过用户会话 id 设置当前的前端用户？如果在域 A 中创建了用户会话并且我想在域 B 中重用该用户，这可能吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T11:20:10.057

朋友们，多么简单的一天，多么简单的答案。神奇的词是 FE_SESSION_KEY。有了这个，您可以在多域typo3 安装上维护会话：

```
$sessionId = $GLOBALS['TSFE']->fe_user->id;
$hash = md5($GLOBALS['TSFE']->fe_user->id.'/'.$GLOBALS['TYPO3_CONF_VARS']['SYS']['encryptionKey']);
$sessionKey = rawurlencode($sessionId.'-'.$hash);

$this->uriBuilder->reset();
$this->uriBuilder->setArguments(array('FE_SESSION_KEY'=>$sessionKey));
$url = $this->uriBuilder->uriFor('newCheckout'); 
```

# c++ - XCode 4.5 'tr1/type_traits' 文件未找到

> ID：13219007
> 
> 赞同：7
> 
> 时间：2012-11-04T13:37:35.947
> 
> 标签：c++, c++11, wxwidgets, xcode4.5

我使用 wxwidget 库，但遇到以下问题：

```
#if defined(HAVE_TYPE_TRAITS)
    #include <type_traits>
#elif defined(HAVE_TR1_TYPE_TRAITS)
    #ifdef __VISUALC__
        #include <type_traits>
    #else
        #include <tr1/type_traits>
    #endif
#endif 
```

在这里找不到#include。我使用 Apple LLVM 编译器 4.1。（使用 c++11 方言）。如果我切换到 LLVM GCC 4.2 编译器，我没有错误，但主要问题是所有 c++11 包含都不起作用。

我怎样才能使用 GCC 编译器，但使用 c++11 标准，或者让 LLVM 可以找到？

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-04T17:12:37.977

我猜您将“C++ 标准库”设置为“libc++”。如果是这种情况，您想要`<type_traits>`，而不是`<tr1/type_traits>`。libc++ 为您提供了一个 C++11 库，而 libstdc++（这也是 Xcode 4.5 中的默认值）为您提供了一个支持 tr1 的 C++03 库。

如果需要，您可以自动检测正在使用的库：

```
#include <ciso646>  // detect std::lib
#ifdef _LIBCPP_VERSION
// using libc++
#include <type_traits>
#else
// using libstdc++
#include <tr1/type_traits>
#endif 
```

或者在你的情况下，也许：

```
#include <ciso646>  // detect std::lib
#ifdef _LIBCPP_VERSION
// using libc++
#define HAVE_TYPE_TRAITS
#else
// using libstdc++
#define HAVE_TR1_TYPE_TRAITS
#endif 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-06-16T17:09:50.423

这是我用来针对 libc++（LLVM C++ 标准库）构建 wxWidgets 的命令。应该在优胜美地及以后工作（至少在苹果再次破坏一切之前）：

```
mkdir build-cocoa-debug
cd build-cocoa-debug
../configure --enable-debug --with-macosx-version-min=10.10
make -j8 #This allows make to use 8 parallel jobs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-04T15:44:59.203

稍微修改了上面的代码，以避免编译器抱怨：

将以下内容粘贴到 strvararg.h 中 #ifdefined (HAVE_TYPE_TRAITS) 之前

```
#include <ciso646>  // detect std::lib
#ifdef _LIBCPP_VERSION
// using libc++
#ifndef HAVE_TYPE_TRAITS
#define HAVE_TYPE_TRAITS 1
#endif
#else 
// using libstdc++
#ifndef HAVE_TR1_TYPE_TRAITS
#define HAVE_TR1_TYPE_TRAITS 1
#endif
#endif 
```

# mysql - 为什么 CreateEntityManager 返回 NULL

> ID：13219012
> 
> 赞同：0
> 
> 时间：2012-11-04T13:38:13.980
> 
> 标签：mysql, persistence

我是Java技术的新手，所以如果我提出一个愚蠢的问题，请原谅...

我想制作一个 JSF 2.0 servlet 并将 MySql 用于数据库引擎。

问题是我似乎无法连接到服务器。

我使用 netbeans IDE，作为指导，我使用了来自 youtube 的教程：[http ://www.youtube.com/watch?v=UBNaiVWwAZw&feature=related](http://www.youtube.com/watch?v=UBNaiVWwAZw&feature=related)

不同的是我使用的是Tomcat。

我的 persistence.xml 文件位于 Web/META-INF/persistence.xml 中，内容为：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="AnunturiJsfPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>my.servlets.Users</class>
    <class>my.servlets.UsersSessions</class>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties>
      <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/tz_cadastru_galati"/>
      <property name="javax.persistence.jdbc.password" value=""/>
      <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"/>
      <property name="javax.persistence.jdbc.user" value="root"/>
    </properties>
  </persistence-unit>
</persistence> 
```

我的 servlet 文件是：

```
package my.servlets;

import java.io.IOException;
import java.io.PrintWriter;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.PersistenceUnit;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "testOkServlet2", urlPatterns = {"/testOkServlet2"})
public class testOkServlet2 extends HttpServlet {

    @PersistenceUnit
    EntityManagerFactory emf;

    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        try {
                EntityManager em = emf.createEntityManager();
                Users u = (Users) em.createNamedQuery("Users.findAll").getResultList().get(0);
                String myUser = u.getUserNume();
                out.println("User:" + myUser);
        } catch (Exception e)
        {
            out.println(e.getMessage());
        }
        finally {           
            out.close();
        }
    }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    @Override
    public String getServletInfo() {
        return "Short description";
    }// </editor-fold>

} 
```

这是我的用户对象：

```
package my.servlets;

import java.io.Serializable;
import java.util.Date;
import javax.persistence.Basic;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import javax.xml.bind.annotation.XmlRootElement;

@Entity
@Table(name = "users")
@XmlRootElement
@NamedQueries({
    @NamedQuery(name = "Users.findAll", query = "SELECT u FROM Users u"),
    @NamedQuery(name = "Users.findByUserID", query = "SELECT u FROM Users u WHERE u.userID = :userID"),
    @NamedQuery(name = "Users.findByUserNume", query = "SELECT u FROM Users u WHERE u.userNume = :userNume"),
    @NamedQuery(name = "Users.findByNumePrenume", query = "SELECT u FROM Users u WHERE u.numePrenume = :numePrenume"),
    @NamedQuery(name = "Users.findByEmail", query = "SELECT u FROM Users u WHERE u.email = :email"),
    @NamedQuery(name = "Users.findByParola", query = "SELECT u FROM Users u WHERE u.parola = :parola"),
    @NamedQuery(name = "Users.findByContActiv", query = "SELECT u FROM Users u WHERE u.contActiv = :contActiv"),
    @NamedQuery(name = "Users.findByDataAdaugarii", query = "SELECT u FROM Users u WHERE u.dataAdaugarii = :dataAdaugarii"),
    @NamedQuery(name = "Users.findByNivelAccesID", query = "SELECT u FROM Users u WHERE u.nivelAccesID = :nivelAccesID")})
public class Users implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @Column(name = "userID")
    private Integer userID;
    @Basic(optional = false)
    @Column(name = "userNume")
    private String userNume;
    @Basic(optional = false)
    @Column(name = "numePrenume")
    private String numePrenume;
    @Basic(optional = false)
    @Column(name = "email")
    private String email;
    @Basic(optional = false)
    @Column(name = "parola")
    private String parola;
    @Basic(optional = false)
    @Column(name = "contActiv")
    private boolean contActiv;
    @Basic(optional = false)
    @Column(name = "dataAdaugarii")
    @Temporal(TemporalType.TIMESTAMP)
    private Date dataAdaugarii;
    @Basic(optional = false)
    @Column(name = "nivelAccesID")
    private short nivelAccesID;

    public Users() {
    }

    public Users(Integer userID) {
        this.userID = userID;
    }

    public Users(Integer userID, String userNume, String numePrenume, String email, String parola, boolean contActiv, Date dataAdaugarii, short nivelAccesID) {
        this.userID = userID;
        this.userNume = userNume;
        this.numePrenume = numePrenume;
        this.email = email;
        this.parola = parola;
        this.contActiv = contActiv;
        this.dataAdaugarii = dataAdaugarii;
        this.nivelAccesID = nivelAccesID;
    }

    public Integer getUserID() {
        return userID;
    }

    public void setUserID(Integer userID) {
        this.userID = userID;
    }

    public String getUserNume() {
        return userNume;
    }

    public void setUserNume(String userNume) {
        this.userNume = userNume;
    }

    public String getNumePrenume() {
        return numePrenume;
    }

    public void setNumePrenume(String numePrenume) {
        this.numePrenume = numePrenume;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getParola() {
        return parola;
    }

    public void setParola(String parola) {
        this.parola = parola;
    }

    public boolean getContActiv() {
        return contActiv;
    }

    public void setContActiv(boolean contActiv) {
        this.contActiv = contActiv;
    }

    public Date getDataAdaugarii() {
        return dataAdaugarii;
    }

    public void setDataAdaugarii(Date dataAdaugarii) {
        this.dataAdaugarii = dataAdaugarii;
    }

    public short getNivelAccesID() {
        return nivelAccesID;
    }

    public void setNivelAccesID(short nivelAccesID) {
        this.nivelAccesID = nivelAccesID;
    }

    @Override
    public int hashCode() {
        int hash = 0;
        hash += (userID != null ? userID.hashCode() : 0);
        return hash;
    }

    @Override
    public boolean equals(Object object) {
        // TODO: Warning - this method won't work in the case the id fields are not set
        if (!(object instanceof Users)) {
            return false;
        }
        Users other = (Users) object;
        if ((this.userID == null && other.userID != null) || (this.userID != null && !this.userID.equals(other.userID))) {
            return false;
        }
        return true;
    }

    @Override
    public String toString() {
        return "my.servlets.Users[ userID=" + userID + " ]";
    }

} 
```

如果我错过了发布任何其他信息，请告诉我，我会放到网上。

请帮我。提前感谢曼尼。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T03:16:53.200

在这种情况下，首先要做的是手动检查与服务器的连接，以确保您可以访问服务器。

# c++ - 如何使用 C++ 编辑文本文件

> ID：13219013
> 
> 赞同：0
> 
> 时间：2012-11-04T13:38:23.117
> 
> 标签：c++, text-files, fstream

如何在 C++ 中编辑文本文件的特定行？假设我想打开一个文件并将焦点或指针或它所调用的任何内容更改为第 17 行第 20 列。这样我可以在第 17 行第 20 列之后编辑文本。

我试过这个，但它没有用。

```
ofstream txtFile("textFile.txt");
fseek(txtFile, 17, 20);
txtFile << "New stuff to enter at this point (overwrites old not insert)"; 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:41:21.243

`fseek`不是在寻找计数行，而是在寻找字节。您指示程序不是将指针定位在第 17 行的第 20 列，而是定位在文件的第 17 + 20 = 37 字节。

该函数的第一个参数是原点，即从原点开始计算的字节数，第二个参数是偏移量。

请参阅的[参考资料](http://www.cplusplus.com/reference/clibrary/cstdio/fseek/)。`fseek`

我不知道有任何库可以针对 C++ 中的行和列进行字节定位。您可能需要使用更高级别的函数并逐行解析（例如，`getline`如果您使用 C++ 解决方案，则使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T13:43:20.327

使用 fputs，就像在[这里](http://www.cplusplus.com/reference/clibrary/cstdio/fseek/)做的一样。为了识别换行符，您必须遍历内容并计算换行符（即linux上的'\n'）。[您可以使用getc](http://www.cplusplus.com/reference/clibrary/cstdio/getc/)获取当前指向的字符。

实现这一点的一种方法是编写一个函数，该函数返回给定行开始的字节位置，如下所示：

```
#include <stdio.h>

int getRowPos(int row,FILE* fp){
  int pos=1,lines=1,currChr;
  do{
    currChr=getc(fp);
    if(currChr=='\n')
      lines++;
  }while(lines<row && currChr!=EOF && ++pos);
  return pos;
} 
```

然后可以使用`fseek`一个到返回的位置`getRowPos`加上列号（即字节数，就行），然后使用 fputs 写入想要的内容，像这样：

```
 int row=wanted row
 int col=wanted column

 FILE * pFile;
 //Open file for read and write                                                                        
 pFile = fopen ( "myfile.txt" , "rb+" );
 int rowPos=getRowPos(row,pFile);
 fseek ( pFile , rowPos+colPos , SEEK_SET );
 fputs ( "my new content" , pFile );
 fclose ( pFile ); 
```

如果你知道你的行有多宽，比如 n 宽，你可以`lseek`在调用`getc`.

# c++ - 如何制作本地化的持续时间字符串？

> ID：13219014
> 
> 赞同：2
> 
> 时间：2012-11-04T13:38:29.780
> 
> 标签：c++, time, wxwidgets, duration

我正在制作一个需要显示持续时间字符串的应用程序。几个例子：

*   离休息还有 1 小时 2 分钟，
*   离休息还有 2 分 8 秒

目前我有一个 C++ 函数，它在给定的秒/毫秒/分钟内给你一个字符串：

```
wxString getTimeStr(int value, 
                    ETimeUnit time_unit, // milliseconds or seconds or minutes or hours
                    wxString const & lang) // english or russian 
```

它由许多条件组成，具体取决于语言、时间单位和现有值。现在我正在考虑将应用程序移植到其他语言，为每种新语言编写 c++ 代码会有点痛苦。有没有办法使用标准函数制作该字符串？

该应用程序是使用 wxWidgets 用 C++ 编写的，目前只能在 Windows 上运行。我宁愿不使用依赖于平台的函数，尽管了解它们会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:45:11.430

我建议将您的功能一分为二。

第一部分将剩余时间作为 wxTimeSpan 返回。

第二部分将 wxTimeSpan '翻译'成所需的语言并返回一个字符串。这是您需要为每种语言更改的唯一部分。

为了便于解释，我们假设

*   我们只关心小时和分钟
*   克林贡人喜欢看小时/分钟
*   火神喜欢看分钟：小时
*   俄罗斯人对分钟这个词有多种形式

然后你的第二个函数会写成这样

```
// extract hours and residual minutes into CSV

wxString csv = theTimeSpan.Format("%H,%M);

// extract tokens for csv
wxString hours, mins
...

if( lang == "Klingon" ) {
  return hours + "/" + mins
} else if ( lang == "Vulcan" ) {
  return mins + ":" + hours 
} else if ( lang == "Russian" ) {
  wxString min_name;
  switch( mins.ToLong() ) {
    case 1: min_name = "---"; break;
    ...
  }
 return mins + " " + min_name;
} 
```

不幸的是，您不能使用 Format 来获得任意的“时间结构”，因为在时间跨度中的小时数等存在本质上的歧义。它可以是总小时数（例如，对于 50 小时的时间跨度，这将是 50）或只是时间跨度的小时部分，在这种情况下为 2，因为 50 小时等于 2 天和 2 小时。

wxTimeSpan 以下列方式解决了这种歧义：如果确实存在在 H 之前指定的 D 格式，则它被解释为 2。否则，它是 50。这同样适用于所有其他格式说明符：如果它们遵循较大单位的说明符，只取其余部分，否则使用完整值。

因此，您必须使用 csv 令牌，如我的代码示例中所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:21:49.247

如果不为不同的语言编写不同的代码，你将无法完美地做到这一点。例如，我敢打赌，您现有的代码不允许产生像“三点半前 5 分钟”这样的时间，但仍用于（口语）德语。即使不做这样的延伸，考虑一下英语“三点半”实际上被翻译成“半到四点”。

因此，如果使用官方时间还不够（如果是，请查看`wxLocale::GetInfo(wxLOCALE_TIME_FMT)`），您确实需要编写代码来专门处理至少一些语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T08:52:23.817

有时，最好让程序*更技术性*，而不是*更接近自然语言*。我也发现自己处于这种情况（让它看起来*很酷*）。通常情况下，客户并不关心。信息有时比它的确切形式重要得多。

程序员有时应该选择权衡——一种与编程语言/框架无关的元解决方案。换句话说，你应该权衡解决方案的正确性和期望的正确性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T14:50:16.013

解决本地化问题的传统方法是构建地图`label name -> label value`并在值中使用占位符。

1.  在代码中，您只引用标签名称，并为占位符提供值
2.  要移植到另一种语言，您只需翻译地图

根据您需要的复杂程度，您可能有一个简单的占位符机制（`snprintf`-like），或者允许迷你语言在运行时根据简单参数（例如，区分单数和复数）构建值。

在这个例子中，它很简单：

```
using LabelsType = std::map<LabelName, std::string>;
using LangToLabelsType = std::map<Language, LabelsType>; 
```

*注意：我建议为语言使用枚举，而不是纯字符串。*

如果您使用的是 Linux，我会推荐`gettext`，但我不确定它是否适用于 Windows。不过，您可以查看它并查看它是如何工作的，它可能会对您有所帮助。

# javascript - 谷歌图表外部 Javascript 问题

> ID：13219015
> 
> 赞同：4
> 
> 时间：2012-11-04T13:38:31.623
> 
> 标签：javascript, charts, external

我的问题是，当我将任何谷歌图表的 js 代码放在外部 javascript 文件中时。它开始加载页面并且不显示任何内容。如果是内联 javascripts，它的工作正常。

以下是我的 HTML 代码“google barchart.html”

```
 <html>
     <head>
       <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />    
       <script type="text/javascript" src="jquery.js"></script>
       <script type="text/javascript" src="https://www.google.com/jsapi"></script>
       <script type="text/javascript" src="test.js"></script>
       <script type="text/javascript"></script>
    </head>
    <body>
      <input type="button" id="btn" value="Show Graph" />
      <div id="chart_div" style="width: 441px; height: 300px;"></div>
    </body>
 </html> 
```

这是我的 js 文件“test.js”

```
 $(document).ready(function()  {    $('#btn').click(function()      {   //alert("hi");
       google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['', 'Your Restaurant', 'Other Restaurants'],
          ['Question1',  5, 4],
          ['Question2',  4, 5],
          ['Question3',  3, 2],
          ['Question4',  5, 1]
        ]);

        var options = {
          //title: 'Company Performance',
          hAxis: {title: 'Questions', titleTextStyle: {color: 'red'}},
          vAxis: {title: '1 = POOR, 5 = EXCELLENT', titleTextStyle: {color: '#FF0000'}, maxValue:'5', minValue:'1'},
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }     }); }); 
```

*注意：当这段代码不在任何 js 函数中时，它在外部 js 中也可以正常工作。但我想在 Javascript 函数中使用它。

提前谢谢。

莫阿兹

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-11T17:11:52.630

我将您的代码固定为您可以使用的 2 个工作解决方案（已测试与 IE、Chrome 和 Mozilla 一起使用）。

1.  JavaScript 加载索引页面
2.  单击按钮后加载 JavaScript

.

* * *

**解决方案 1：JavaScript 加载索引页面**

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="test.js"></script>
</head>
<input type="button" id="btn" value="Show Graph">
<div id="chart_div" style="width: 441px; height: 300px;"></div>
</html> 
```

测试.js

```
google.load('visualization', '1', {'packages':['corechart']});

$(document).ready(function() {    
$("#btn").click(function() {
$("#chart_div").load("", function(){
var data = google.visualization.arrayToDataTable([
           ['', 'Your Restaurant', 'Other Restaurants'],
           ['Question1',  5, 4],
           ['Question2',  4, 5],
           ['Question3',  3, 2],
           ['Question4',  5, 1]
           ]);

var options = {
    title: 'Company Performance',
    hAxis: {title: 'Questions', titleTextStyle: {color: 'red'}},
    vAxis: {title: '1 = POOR, 5 = EXCELLENT', titleTextStyle: {color: '#FF0000'}, maxValue:'5', minValue:'1'},
    tooltip: {trigger: 'hover'}};

var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
chart.draw(data, options);
});
});
}); 
```

* * *

**解决方案 2：单击按钮后加载 JavaScript**

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load('visualization', '1', {'packages':['corechart']});

function loadjsfile(filename, filetype) 
     {
  var fileref=document.createElement('script')
  fileref.setAttribute("type","text/javascript");
  fileref.setAttribute("src", filename);
  document.getElementsByTagName("head")[0].appendChild(fileref)
     }
</script>
</head>
<input type="button" id="btn" value="Show Graph" onclick="loadjsfile('test2.js','js')">
<div id="chart_div" style="width: 441px; height: 300px;"></div>
</html> 
```

test2.js

```
$("#chart_div").load("",function(){
var data = new google.visualization.arrayToDataTable([
           ['', 'Your Restaurant', 'Other Restaurants'],
           ['Question1',  5, 4],
           ['Question2',  4, 5],
           ['Question3',  3, 2],
           ['Question4',  5, 1]
           ]);

var options = {
    title: 'Company Performance',
    hAxis: {title: 'Questions', titleTextStyle: {color: 'red'}},
    vAxis: {title: '1 = POOR, 5 = EXCELLENT', titleTextStyle: {color: '#FF0000'}, maxValue:'5', minValue:'1'},
    tooltip:{trigger: 'hover'}};

var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
chart.draw(data, options)
}); 
```

# javascript - 移动应用程序中的 Ghostclicks

> ID：13219017
> 
> 赞同：3
> 
> 时间：2012-11-04T13:38:52.887
> 
> 标签：javascript, jquery, cordova, jquery-mobile

有很多关于鬼点击的材料/帖子，我正在努力更好地理解它。所以我理解它的方式，鬼点击的原因是`click`事件在触摸事件后约 300 毫秒被调度。[jQuery Mobile 建议](http://jquerymobile.com/test/docs/api/events.html)`vclick`，只要有可能更改手指位置下方的内容，就不要使用他们的事件。

*我的第一个问题*`click`是：这是否意味着只有当目标元素与最初触摸的元素不同时才会触发幽灵点击？所以，比如说，当一个按钮被触摸时，我写了一个数据库条目——没有别的。有没有鬼点击的机会？

如果是这种情况，这是否意味着如果我只使用事件而不使用任何事件，我可以完全防止*鬼* `tap`点击`click`？

我的最后一个问题是，如果我可以简单地告诉浏览器在使用 PhoneGap 时不要使用 300 毫秒延迟（这将立即解决问题），但我只是猜测我不能这样做，因为它可能是硬编码的浏览器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T17:50:11.593

点击事件延迟 300 毫秒，以检测双击或胖手指错误。

是的，您应该尽可能使用触摸事件。

是的，有很多方法可以通过做一些 JS 来实现快速点击。例如：

1.  [https://developers.google.com/mobile/articles/fast_buttons](https://developers.google.com/mobile/articles/fast_buttons)
2.  [https://forum.jquery.com/topic/how-to-remove-the-300ms-delay-when-clicking-on-a-link-in-jquery-mobile](https://forum.jquery.com/topic/how-to-remove-the-300ms-delay-when-clicking-on-a-link-in-jquery-mobile)
3.  [http://labs.ft.com/2011/08/fastclick-native-like-tapping-for-touch-apps/](http://labs.ft.com/2011/08/fastclick-native-like-tapping-for-touch-apps/)

您不必忍受 300 毫秒的延迟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-17T13:29:42.667

如果页面上所有可以点击的东西都`vclick`安装了适当的 jQuery 事件处理程序，那么阻止幻像点击的一种简单方法是`touchend`在主体上创建一个事件处理程序并`preventDefault`从中调用：

```
$(document.body).on('touchend', null, function(e) {
  e.preventDefault();
}); 
```

请注意，这将*禁用 touches 的常规点击*，因此您拥有的任何常规链接或表单输入都将停止工作，除非您向它们添加 vclick 处理程序。

# css - 无法在 jQuery Mobile 应用程序中隐藏/显示元素

> ID：13219018
> 
> 赞同：1
> 
> 时间：2012-11-04T13:39:01.000
> 
> 标签：css, jquery-mobile, hide, element, show

我在 jQuery Mobile 中有一个应用程序。每次显示页面时，必须执行一些 JavaScript 来隐藏/显示某些元素（取决于会话状态）。

我在这上面花了很多时间，无法弄清楚为什么 JavaScript 没有像预期的那样隐藏元素，它有时会，有时不会。好像有点随意。DOM 实际上看起来是一致的。应该隐藏的元素有`display: none`，而那些可见的有`display: block`，但是它与浏览器中可以看到的不匹配。

我设法将问题简化为一个非常简单的案例。它几乎是我添加的 JavaScript 的基本样板模板：

**page1.html**

```
<!DOCTYPE html> 
<html> 
    <head> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
        <script src="test.js"></script>
    </head> 
<body> 

<div data-role="page" id="page1">

    <div data-role="header">
        <h1>Page Title</h1>
        <div id="el1">ELEMENT 1</div>
        <div id="el2">ELEMENT 2</div>
    </div><!-- /header -->

    <div data-role="content">   
        <p>Page content goes here.</p>      
        <a href="page2.html">PAGE 2</a>
    </div><!-- /content -->

    <div data-role="footer">
        <h4>Page Footer</h4>
    </div><!-- /footer -->
</div><!-- /page -->

</body>
</html> 
```

**page2.html**

```
<!DOCTYPE html> 
<html> 
    <head> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
        <script src="test.js"></script>
    </head> 
<body> 

<div data-role="page" id="page2">

    <div data-role="header">
        <h1>Page Title</h1>
        <div id="el1">ELEMENT 1</div>
        <div id="el2">ELEMENT 2</div>
    </div><!-- /header -->

    <div data-role="content">   
        <p>Page content goes here.</p>
        <a href="page1.html">PAGE 1</a> 
    </div><!-- /content -->

    <div data-role="footer">
        <h4>Page Footer</h4>
    </div><!-- /footer -->
</div><!-- /page -->

</body>
</html> 
```

**测试.js**

```
$(document).bind("pagechange", function(event, data) {
    console.info('Changed to page: ' + data.toPage.attr('id'));
    $('#el1').hide();
    $('#el2').show();
}); 
```

您可以通过将这三个文件放在本地服务器上轻松地对其进行测试。`page1.html`并且`page2.html`几乎是相同的页面（仅用于测试），并且`test.js`只是 hide`#el1`和 show `#el2`。当页面更改时，此 JavaScript 始终成功执行（控制台语句始终显示），但`#el1`有时隐藏，有时不隐藏，但应始终隐藏。

同样，最让我困惑的是，如果我直接查看 DOM（在 Chrome 控制台中），一切似乎都是正确的。CSS 清晰`display: none`，但元素仍然可见。

知道什么可能导致这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T13:59:57.567

您可以尝试几件事。

1.  使用`on`而不是`bind`. 也许您正在绑定到文档并且文档正在更改，失去绑定。使用`on`应该可以摆脱这个。

2.  `on`直接在页面上使用：

    $('#page1').on('pagechange', function() {});

# php - 访问 youtube api 时出错：“警告：file_get_contents() [function.file-get-contents]: URL > file-access is disabled...”

> ID：13219020
> 
> 赞同：0
> 
> 时间：2012-11-04T13:39:04.897
> 
> 标签：php, json, video, youtube

我试图遵循这个答案：

[https://stackoverflow.com/a/3331372/1063287](https://stackoverflow.com/a/3331372/1063287)

所以在我的 php 文档中，我有以下变量：

```
$json = file_get_contents("https://gdata.youtube.com/feeds/api/videos/{$video_id}?v=2&alt=json");
$json_data = json_decode($json);
$video_title = $json_data->{'entry'}->{'title'};
$video_date = $json_data->{'entry'}->{'published'};
$video_duration = $json_data->{'entry'}->{'media:group'}->{'yt$duration'};
$video_views = $json_data->{'entry'}->{'yt$statistics'}->{'viewCount'};
$video_description = $json_data->{'entry'}->{'content'}; 
```

但这给了我错误：

> 警告：file_get_contents() [function.file-get-contents]：在第 12 行 /home/path/to//file.php 的服务器配置中禁用 URL 文件访问
> 
> 警告：file_get_contents（[https://gdata.youtube.com/feeds/api/videos/xx-xxxxxxx?v=2&alt=json](https://gdata.youtube.com/feeds/api/videos/xx-xxxxxxx?v=2&alt=json)）[function.file-get-contents]：无法打开流：可能没有合适的包装器在第 12 行的 /home/path/to/file.php 中找到

我在这里查看了开发人员指南：

[https://developers.google.com/youtube/2.0/developers_guide_php](https://developers.google.com/youtube/2.0/developers_guide_php)

并且可以在这里了解提要和条目结构：

[https://developers.google.com/youtube/2.0/developers_guide_protocol_understanding_video_feeds#Understanding_Video_Entries](https://developers.google.com/youtube/2.0/developers_guide_protocol_understanding_video_feeds#Understanding_Video_Entries)

并找到了一些解决方案（一个涉及 curl），但它们要么没有工作，要么我不知道它们是否是最好的使用方法。

谁能告诉我上面的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:42:38.830

这很可能是因为您的服务器上没有安装 OpenSSL。尝试安装它，如果仍然无法正常工作，可能是因为您在 php.ini 中禁用了 HTTP 访问（将 allow_url_fopen 设置为 true）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T13:45:15.657

我看到的最好的东西是`Zend_GData_Youtube`在 Zend 框架中。它不需要任何特殊的东西，但它比普通的 cURL 或 JSON 请求要容易得多！

见那里： http: [//framework.zend.com/downloads/latest](http://framework.zend.com/downloads/latest)

# c++ - 如何在 C 和 C++ 中设计具有并行接口的库

> ID：13219026
> 
> 赞同：1
> 
> 时间：2012-11-04T13:40:05.000
> 
> 标签：c++, c, namespaces, derived-class, interface-design

我当前的项目是一个中型库，旨在同时具有 C 和 C++ 接口。它以我希望从 C 和 C++ 函数访问的单一数据类型为中心，因为我想鼓励第三方通过用任何一种语言编写函数来扩展库。

我了解 C/C++ 混合的基础知识（例如比较[http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html](http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html)）并提出了以下解决方案：

我的基本设计围绕在 C 中创建一个所有数据都暴露的结构（这是我的 C 程序员所期望的）并从中派生一个隐藏成员访问的类，希望为 C++ 程序员更安全地访问该结构。问题来自推导：我想在 C++ 中使用命名空间并隐藏 C 接口。当然，C 结构本身不能隐藏（不使用 PIMPL 习语），但这对我来说很好。

以下示例代码在 C 和 C++“客户端”程序中编译和运行时没有明显错误。但是，我想知道这个解决方案是否有效或者是否有更好的解决方案。

示例代码：

```
#ifdef __cplusplus__
extern "C" {
#endif

struct base
{
    char * data;
}

#ifdef __cplusplus__
} // extern "C"
namespace {
extern "C" {
#endif

/* cleanly initialize struct */
struct base * new_base (struct base *);

/* cleanly destroy struct */
void del_base (struct base *);

#ifdef __cplusplus__
} } // namespace, extern "C"

#include<new>

namespace safe {

class base_plus : private base
{
public:
    base_plus () 
    { 
        if (! new_base(this)) 
            throw std::bad_alloc ();
    }

    ~base_plus ()
    {
        del_base (this);
    }
};

} // namespace safe

#endif 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:15:26.387

实际上，另一种方法是用 C++ 编写完整的代码，然后使用数据隐藏技术仅在此之上编写一个 C slim 接口。

```
namespace Foo {
    class Bar {
    public:
        int property1() const;
        std::string const& property2() const;
    };
} 
```

在与 C 兼容的标头中：

```
#ifdef __cplusplus__
extern "C" {
#endif

typedef void* Bar;

Bar foo_bar_new(int i, char const* s);

void foo_bar_delete(Bar b);

int foo_bar_property1(Bar b);

char const& foo_bar_property2(Bar b);

#ifdef __cplusplus__
}
#endif 
```

伴随着实现：

```
Bar foo_bar_new(int i, char const* s) {
    return new Foo::Bar(i, s);
}

void foo_bar_delete(Bar b) {
    delete static_cast<Foo::Bar*>(b);
}

int foo_bar_property1(Bar b) {
    return static_cast<Foo::Bar*>(b)->property1();
}

char const* foo_bar_property2(Bar b) {
    return static_cast<Foo::Bar*>(b)->property2().c_str();
} 
```

两个主要优点是：

*   成熟的 C++ 代码，具有完全封装的数据和更强大的类型系统的所有优点
*   跨版本的二进制稳定性在 C 接口中变得更容易

*注意：例如，这就是 Clang 和 LLVM 处理 C 兼容性的方式。*

# c++ - C++外部程序IO

> ID：13219027
> 
> 赞同：0
> 
> 时间：2012-11-04T13:40:29.900
> 
> 标签：c++, multithreading, macos, external

我需要从 C++ 应用程序中运行一个外部程序。我需要该程序的输出（我想在程序仍在运行时查看它），它还需要获取输入。

重定向 IO 的最佳和最优雅的方式是什么？它应该在自己的线程中运行吗？有什么例子吗？

它在 OSX 上运行。

我是这样实现的：

```
ProgramHandler::ProgramHandler(std::string prog): program(prog){
// Create two pipes
std::cout << "Created Class\n";
pipe(pipe1);
pipe(pipe2);

int id = fork();

std::cout << "id: " << id << std::endl;

if (id == 0)
{
    // In child
    // Close current `stdin` and `stdout` file handles
    close(fileno(stdin));
    close(fileno(stdout));

    // Duplicate pipes as new `stdin` and `stdout`
    dup2(pipe1[0], fileno(stdin));
    dup2(pipe2[1], fileno(stdout));

    // We don't need the other ends of the pipes, so close them
    close(pipe1[1]);
    close(pipe2[0]);

    // Run the external program
    execl("/bin/ls", "bin/ls");
    char buffer[30];
    while (read(pipe1[0], buffer, 30)) {
        std::cout << "Buf: " << buffer << std::endl;
    }
}
else
{
    // We don't need the read-end of the first pipe (the childs `stdin`)
    // or the write-end of the second pipe (the childs `stdout`)
    close(pipe1[0]);
    close(pipe2[1]);

    // Now you can write to `pipe1[1]` and it will end up as `stdin` in the child
    // Read from `pipe2[0]` to read from the childs `stdout`
} 
```

}

但作为输出我得到这个：

创建类

编号：84369

编号：0

我不明白为什么它被调用了两次，为什么它不会第一次分叉。我在做什么/理解错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T13:50:01.123

如果使用 POSIX 系统（如 OSX 或 Linux） ，那么您必须学习系统调用`pipe`、`fork`、`close`和。`dup2``exec`

您要做的是创建两个管道，一个用于从外部应用程序读取，一个用于写入。然后您`fork`创建一个新进程，并在子进程中将管道设置为`stdin`，`stdout`然后调用它使用您的新和文件句柄`exec`将子进程替换为外部程序。在父进程中，您无法读取子进程的输出并写入其输入。`stdin``stdout`

在伪代码中：

```
// Create two pipes
pipe(pipe1);
pipe(pipe2);

if (fork() == 0)
{
    // In child
    // Close current `stdin` and `stdout` file handles
    close(FILENO_STDIN);
    close(FILENO_STDOUT);

    // Duplicate pipes as new `stdin` and `stdout`
    dup2(pipe1[0], FILENO_STDIN);
    dup2(pipe2[1], FILENO_STDOUT);

    // We don't need the other ends of the pipes, so close them
    close(pipe1[1]);
    close(pipe2[0]);

    // Run the external program
    exec("/some/program", ...);
}
else
{
    // We don't need the read-end of the first pipe (the childs `stdin`)
    // or the write-end of the second pipe (the childs `stdout`)
    close(pipe1[0]);
    close(pipe2[1]);

    // Now you can write to `pipe1[1]` and it will end up as `stdin` in the child
    // Read from `pipe2[0]` to read from the childs `stdout`
} 
```

阅读系统调用的手册页以获取有关它们的更多信息。您还需要添加错误检查，因为所有这些系统调用都可能失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T13:59:45.217

好吧，有一种非常标准的方法可以做到这一点。通常，您希望分叉该进程并关闭子进程的标准 I/O (fd 0,1)。在分叉之前创建了两个管道，在分叉之后关闭子中的标准输入和输出并将它们连接到管道，使用 dup。

伪代码，仅显示连接的一侧，我相信您可以弄清楚另一侧。

```
int main(){
     int fd[2]; // file descriptors
     pipe(fd);

      // Fork child process
      if (fork() == 0){
            char buffer [80];
            close(1);
            dup(fd[1]); // this will take the first free discriptor, the one you just closed. 
            close(fd[1]); // clean up
        }else{
           close(0);
           dup(fd[0]);
           close(fd[0]);
        }    
        return 0;
    } 
```

在您设置好管道并且其中一个父线程等待选择或其他内容后，您可以为您的外部工具调用 exec 并让所有数据流动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T13:57:26.103

在 POSIX 系统上与不同程序进行通信的基本方法是设置 a `pipe()`，然后`fork()`将您的程序`close()`和`dup()`文件描述符设置到正确的位置，最后设置到`exec??()`所需的可执行文件。

完成此操作后，您就可以将两个程序与合适的流连接起来。不幸的是，这不涉及任何形式的两个程序的异步处理。也就是说，您可能希望使用合适的异步和非阻塞操作访问创建的文件描述符（即，将各种文件描述符设置为非阻塞和/或仅在`poll()`产生表明您可以的结果时访问它们访问它们）。但是，如果只有一个可执行文件，那么从单独的线程中控制它可能会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T17:26:34.287

另一种方法（如果您也在编写外部程序）是使用共享内存。类似于（伪代码）的东西

```
// create shared memory
int l_shmid = shmget(key, size ,0600 | IPC_CREAT);

if(l_shmid < 0) 
  ERROR

// attach to shared memory
dataptr* ptr = (dataptr*)shmat(l_shmid, NULL, 0600);

// run external program
pid_t l_pid = fork();

if(l_pid == (pid_t)-1)
{
  ERROR

  // detach & delete shared mem
  shmdt(ptr);
  shmctl(l_shmid, 
         IPC_RMID,
         (shmid_ds *)NULL);
  return;
}
else if(l_pid == 0)
{
    // child: 
    execl(path,
          args,
          NULL); 
    return;
}

// wait for the external program to finish
int l_stat(0);
waitpid(l_pid, &l_stat, 0);

// read from shmem
memset(mydata, ..,..);
memcpy(mydata, ptr, ...);

// detach & close shared mem
shmdt(ptr);
shmctl(l_shmid, 
       IPC_RMID,
       (shmid_ds *)NULL); 
```

您的外部程序可以以类似的方式写入共享内存。无需管道和读/写/选择等。

# vb.net - 在任务管理器的“进程”选项卡中分组

> ID：13219028
> 
> 赞同：1
> 
> 时间：2012-11-04T13:40:40.507
> 
> 标签：vb.net, windows-8

如何让我的应用程序进程显示为“Adobe Acrobat 更新服务”和其他进程也不会出现在应用程序组中，但在后台进程组中？

![](../Images/6824af36844e1576baadecded638a1cd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:10:32.043

任务管理器的进程选项卡中显示了三个不同的组：

*   应用程序 - 任何显示 UI 的进程（具有顶级窗口）
*   后台进程 - 任何非 UI、非 Windows 进程
*   Windows 进程 - 任何非 UI、Windows 进程

进程可以在运行时在组之间移动。这可以使用 Windows 资源管理器很容易地演示。Windows 资源管理器将显示在应用程序或 Windows 进程组中，具体取决于它是否显示任何 UI（例如，运行对话框或文件夹）。

# database - 产品如何存储在数据库中？

> ID：13219029
> 
> 赞同：0
> 
> 时间：2012-11-04T13:40:41.977
> 
> 标签：database, database-design, barcode

我有一个数据库来存储商店的不同类型的产品。我是否记录了产品的每个实例？还是我只是在每次售出产品时减少数量？我还想将条形码存储在数据库中。印在产品上的条形码是否对每个实例都是唯一的？或者它只是产品独有的。例如，如果我有 4 罐亨氏番茄汤，它们的条形码值是否相同？如果是，那么我如何唯一地识别每个实例？如果不是，我如何保证 Heinz 番茄汤罐头上的条形码值不会与给定商店中任何其他产品的条形码值匹配？

任何帮助将不胜感激。谢谢你。:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:51:23.367

您不需要记录产品的每个实例。

您应该有一个产品实例，其中每条记录都有一个库存数量列，并在产品售出或库存得到补充后使用数量字段。

根据定义，产品上的条形码是唯一的（不是每个实例），因此您应该安全使用它：亨氏番茄汤将有一个代码，亨氏鸡汤将有另一个代码。

这可能对您有更多帮助：[http](http://www.daveegerton.com/assets/images/database-schema-prestashop.png) ://www.daveegerton.com/assets/images/database-schema-prestashop.png 这是电子商务（Prestashop）使用的数据库模式。您的问题答案在右下角，浅棕色：）

# drupal - 无法在drupal 6中保存字段权限

> ID：13219030
> 
> 赞同：1
> 
> 时间：2012-11-04T13:40:46.737
> 
> 标签：drupal, drupal-6, drupal-permissions

我在 drupal 6 中为此类内容类型添加了新字段，然后转到权限页面以将这些字段启用到特定角色，但我无法保存新权限。

任何人都可以帮助我。

提前致谢。

# spring - 从 Spring Web 流中的 GET 读取查询字符串

> ID：13219031
> 
> 赞同：4
> 
> 时间：2012-11-04T13:40:49.727
> 
> 标签：spring, jakarta-ee, spring-mvc, spring-webflow, spring-webflow-2

海。

我使用执行键继续一个弹簧网络流。（订单贝宝付款），并且需要从 get 读取查询字符串。&TokenID 和 &PayerID

这是确认付款后 Paypal 重定向用户的 URL 的样子：

```
/sampleflow?execution=e1s1&_eventId=approved&token=EC5D7416956W8431713&PayerID=TN2RE8ZTH67JN 
```

如果 eventID 获得批准，我的流程将重定向到付款确认状态。这部分正在工作。我只需要以某种方式获取查询字符串参数。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-09T22:12:14.390

我假设您正在尝试访问流定义 xml 文件中的请求参数。您可以使用 EL 变量**requestParameters**访问参数。

```
<evaluate expression="someService.doSomething(requestParameters.TokenID, requestParameters.PayerID)" /> 
```

[http://docs.spring.io/spring-webflow/docs/2.3.x/reference/html/el.html#el-variable-requestParameters](http://docs.spring.io/spring-webflow/docs/2.3.x/reference/html/el.html#el-variable-requestParameters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-14T18:46:03.043

上面的链接对我不起作用，但我能够在这个地址找到相关页面： [4.4.6。请求参数](http://docs.spring.io/spring-webflow/docs/2.3.x/reference/html/el.html#el-variable-requestParameters)

# xna - XNA 4 - 纹理克隆

> ID：13219032
> 
> 赞同：3
> 
> 时间：2012-11-04T13:41:02.790
> 
> 标签：xna, texture2d, blit

我需要将一个texture2d 的内容复制到另一个（都存储在VRAM 中）？这甚至可以在不使用 RTT 或任何额外的 RAM-VRAM 传输的情况下实现吗？只是 VRAM 中两个纹理之间的纯 BLIT。

提前致谢！我无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:01:36.820

使用[RenderTarget](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.rendertarget%28v=xnagamestudio.31%29.aspx)不会从 VRAM 中删除数据。它可以在后续的绘制调用中作为纹理重用，而无需将其返回到 RAM。但是，如果您需要在代码中对其执行操作，例如 with `getData()`，那么它将移出显存。

# azure - 面向学生的 Windows Azure 云服务

> ID：13219038
> 
> 赞同：3
> 
> 时间：2012-11-04T13:41:35.080
> 
> 标签：azure, cloud

学生如何使用 Windows azure 在线服务？我们可以免费使用吗？至少试用版，因为我们需要将它用于IC项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T13:51:25.563

是的，您可以获得**1 个月的免费试用订阅**。免费试用版具有您作为学生需要使用的足够功能。

[阅读免费试用版中可用功能的详细信息](https://www.windowsazure.com/en-us/pricing/free-trial/)

[获得免费试用](https://account.windowsazure.com/signup?offer=ms-azr-0018p)

干杯!

**请注意**，在注册免费试用时，您需要一张有效的信用卡/借记卡，并且将进行 1 美元的交易以验证您的卡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:05:26.953

Azure 网站免费提供多达 10 个以“共享模式”运行的站点（有限的 CPU、内存、带宽、存储）： http: [//www.windowsazure.com/en-us/home/scenarios/web-sites/](http://www.windowsazure.com/en-us/home/scenarios/web-sites/)

对于您入门的内容来说，它非常强大。

如上所述，有一个免费的 90 试用版。此外，如果您的学校与 Microsoft 建立了合作伙伴关系并提供 MSDN 订阅访问……您确实可以免费获得 3,700 美元/年的 Azure。

# jquery - jquery .load() 社交按钮加载

> ID：13219039
> 
> 赞同：2
> 
> 时间：2012-11-04T13:41:45.227
> 
> 标签：jquery, wordpress, social

我`jQuery.load()`在我的 wordpress 网站中使用了方法来加载下一篇和上一篇文章。脚本工作正常，但问题是当下一篇或上一篇文章加载社交媒体按钮时，如 Facebook 之类的、Tweet 按钮但 Facebook 评论框未加载。我已经尝试过[了，但这](https://stackoverflow.com/questions/6345787/jquery-load-will-break-facebook-like-button-comment-box-how-to-workaround)不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T05:44:11.323

我已经解决了这个问题

```
 function (responseText, textStatus, XMLHttpRequest) {
        FB.XFBML.parse(); 
        #twitter and google code goes here
    }); 
```

在内容之后加载。它很好并且工作正常

# c++ - 无法将整数写入二进制文件 C++

> ID：13219040
> 
> 赞同：0
> 
> 时间：2012-11-04T13:41:48.370
> 
> 标签：c++, file-io, binary

这基本上是我用来存储整个文件的代码的一部分，并且运行良好......但是当我尝试存储大于 120 的整数或类似的东西时，程序编写的东西看起来像是一堆垃圾，而不是我想要的整数。有小费吗 ？我是一名大学生，不知道发生了什么。

```
 int* temp

    temp = (int*) malloc (sizeof(int));

    *temp = atoi( it->valor[i].c_str() );

    //Writes the integer in 4 bytes
    fwrite(temp, sizeof (int), 1, arq);

    if( ferror(arq) ){
      printf("\n\n Error \n\n");
      exit(1);
    }

    free(temp); 
```

我已经检查了该`atoi`部分，它确实返回了我想写的数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T13:55:22.997

我更改并添加了一些代码，它工作正常：

```
#include <iostream>

using namespace std;

int main()
{

    int* temp;
    FILE *file;
    file = fopen("file.bin" , "rb+"); // Opening the file using rb+ for writing
                                      // and reading binary data
    temp = (int*) malloc (sizeof(int));

    *temp = atoi( "1013" );           // replace "1013" with your string

    //Writes the integer in 4 bytes
    fwrite(temp, sizeof (int), 1, file);

    if( ferror(file) ){
      printf("\n\n Error \n\n");
      exit(1);
    }

    free(temp);
} 
```

确保您使用正确的参数打开文件，并且您提供给 atoi(str) 的字符串是正确的。

输入数字 1013 后，我使用十六进制编辑器检查了二进制文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:06:43.073

```
int i = atoi("123");
std::ofstream file("filename", std::ios::bin);
file.write(reinterpret_cast<char*>(&i), sizeof(i)); 
```

*   不要在这里使用指针。
*   **永远不要**在 C++ 中使用`malloc`/ 。`free`
*   使用 C++ 文件流，而不是 C 流。

# python - 如何加快 Numpy 中转换矩阵的创建速度？

> ID：13219041
> 
> 赞同：12
> 
> 时间：2012-11-04T13:41:54.860
> 
> 标签：python, numpy, scipy

以下是我所知道的在马尔可夫链中计算转换并使用它来填充转换矩阵的最基本方法：

```
def increment_counts_in_matrix_from_chain(markov_chain, transition_counts_matrix):
    for i in xrange(1, len(markov_chain)):
        old_state = markov_chain[i - 1]
        new_state = markov_chain[i]
        transition_counts_matrix[old_state, new_state] += 1 
```

我试过用 3 种不同的方式加速它：

1）使用基于此Matlab代码的稀疏矩阵单线：

```
transition_matrix = full(sparse(markov_chain(1:end-1), markov_chain(2:end), 1)) 
```

在 Numpy/SciPy 中，如下所示：

```
def get_sparse_counts_matrix(markov_chain, number_of_states):
    return coo_matrix(([1]*(len(markov_chain) - 1), (markov_chain[0:-1], markov_chain[1:])), shape=(number_of_states, number_of_states)) 
```

而且我尝试了更多的 Python 调整，比如使用 zip()：

```
for old_state, new_state in zip(markov_chain[0:-1], markov_chain[1:]):
    transition_counts_matrix[old_state, new_state] += 1 
```

和队列：

```
old_and_new_states_holder = Queue(maxsize=2)
old_and_new_states_holder.put(markov_chain[0])
for new_state in markov_chain[1:]:
    old_and_new_states_holder.put(new_state)
    old_state = old_and_new_states_holder.get()
    transition_counts_matrix[old_state, new_state] += 1 
```

但是这三种方法都没有加快速度。事实上，除了 zip() 解决方案之外的所有解决方案都至少比我原来的解决方案慢 10 倍。

还有其他值得研究的解决方案吗？

**从大量链构建转换矩阵的修改解决方案**
上述问题的最佳答案具体是 DSM。但是，对于任何想要根据数百万个马尔可夫链的列表填充转换矩阵的人来说，最快的方法是：

```
def fast_increment_transition_counts_from_chain(markov_chain, transition_counts_matrix):
    flat_coords = numpy.ravel_multi_index((markov_chain[:-1], markov_chain[1:]), transition_counts_matrix.shape)
    transition_counts_matrix.flat += numpy.bincount(flat_coords, minlength=transition_counts_matrix.size)

def get_fake_transitions(markov_chains):
    fake_transitions = []
    for i in xrange(1,len(markov_chains)):
        old_chain = markov_chains[i - 1]
        new_chain = markov_chains[i]
        end_of_old = old_chain[-1]
        beginning_of_new = new_chain[0]
        fake_transitions.append((end_of_old, beginning_of_new))
    return fake_transitions

def decrement_fake_transitions(fake_transitions, counts_matrix):
    for old_state, new_state in fake_transitions:
        counts_matrix[old_state, new_state] -= 1

def fast_get_transition_counts_matrix(markov_chains, number_of_states):
    """50% faster than original, but must store 2 additional slice copies of all markov chains in memory at once.
    You might need to break up the chains into manageable chunks that don't exceed your memory.
    """
    transition_counts_matrix = numpy.zeros([number_of_states, number_of_states])
    fake_transitions = get_fake_transitions(markov_chains)
    markov_chains = list(itertools.chain(*markov_chains))
    fast_increment_transition_counts_from_chain(markov_chains, transition_counts_matrix)
    decrement_fake_transitions(fake_transitions, transition_counts_matrix)
    return transition_counts_matrix 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T18:41:51.093

只是为了好玩，并且因为我一直想尝试一下，所以我将[Numba](http://numba.pydata.org/)应用于您的问题。在代码中，这仅涉及添加一个装饰器（尽管我已经进行了直接调用，所以我可以测试 numba 在这里提供的 jit 变体）：

```
import numpy as np
import numba

def increment_counts_in_matrix_from_chain(markov_chain, transition_counts_matrix):
    for i in xrange(1, len(markov_chain)):
        old_state = markov_chain[i - 1]
        new_state = markov_chain[i]
        transition_counts_matrix[old_state, new_state] += 1

autojit_func = numba.autojit()(increment_counts_in_matrix_from_chain)
jit_func = numba.jit(argtypes=[numba.int64[:,::1],numba.double[:,::1]])(increment_counts_in_matrix_from_chain)

t = np.random.randint(0,50, 500)
m1 = np.zeros((50,50))
m2 = np.zeros((50,50))
m3 = np.zeros((50,50)) 
```

然后是时间：

```
In [10]: %timeit increment_counts_in_matrix_from_chain(t,m1)
100 loops, best of 3: 2.38 ms per loop

In [11]: %timeit autojit_func(t,m2)                         

10000 loops, best of 3: 67.5 us per loop

In [12]: %timeit jit_func(t,m3)
100000 loops, best of 3: 4.93 us per loop 
```

该`autojit`方法根据运行时输入进行一些猜测，并且该`jit`函数具有指定的类型。您必须小心一点，因为在这些早期阶段的 numba 不会传达`jit`如果您为输入传递错误的类型存在错误。它只会吐出一个不正确的答案。

尽管如此，在没有任何代码更改的情况下获得 35 倍和 485 倍的加速，并且只需添加对 numba 的调用（也可以称为装饰器）在我的书中是相当令人印象深刻的。使用 cython 可能会得到类似的结果，但它需要更多样板文件并编写 setup.py 文件。

我也喜欢这个解决方案，因为代码仍然可读，并且您可以按照您最初考虑实现算法的方式编写它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-04T15:55:24.973

这样的事情怎么样，利用`np.bincount`？不是超级强大，但功能强大。[感谢@Warren Weckesser 的设置。]

```
import numpy as np
from collections import Counter

def increment_counts_in_matrix_from_chain(markov_chain, transition_counts_matrix):
    for i in xrange(1, len(markov_chain)):
        old_state = markov_chain[i - 1]
        new_state = markov_chain[i]
        transition_counts_matrix[old_state, new_state] += 1

def using_counter(chain, counts_matrix):
    counts = Counter(zip(chain[:-1], chain[1:]))
    from_, to = zip(*counts.keys())
    counts_matrix[from_, to] = counts.values()

def using_bincount(chain, counts_matrix):
    flat_coords = np.ravel_multi_index((chain[:-1], chain[1:]), counts_matrix.shape)
    counts_matrix.flat = np.bincount(flat_coords, minlength=counts_matrix.size)

def using_bincount_reshape(chain, counts_matrix):
    flat_coords = np.ravel_multi_index((chain[:-1], chain[1:]), counts_matrix.shape)
    return np.bincount(flat_coords, minlength=counts_matrix.size).reshape(counts_matrix.shape) 
```

这使：

```
In [373]: t = np.random.randint(0,50, 500)
In [374]: m1 = np.zeros((50,50))
In [375]: m2 = m1.copy()
In [376]: m3 = m1.copy()

In [377]: timeit increment_counts_in_matrix_from_chain(t, m1)
100 loops, best of 3: 2.79 ms per loop

In [378]: timeit using_counter(t, m2)
1000 loops, best of 3: 924 us per loop

In [379]: timeit using_bincount(t, m3)
10000 loops, best of 3: 57.1 us per loop 
```

[编辑]

避免`flat`（以不在原地工作为代价）可以为小型矩阵节省一些时间：

```
In [80]: timeit using_bincount_reshape(t, m3)
10000 loops, best of 3: 22.3 us per loop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:51:06.677

这是一个更快的方法。这个想法是计算每个转换的出现次数，并在矩阵的矢量化更新中使用这些计数。（我假设相同的转换可以在 中多次发生`markov_chain`。）库中的`Counter`类`collections`用于计算每个转换的出现次数。

```
from collections import Counter

def update_matrix(chain, counts_matrix):
    counts = Counter(zip(chain[:-1], chain[1:]))
    from_, to = zip(*counts.keys())
    counts_matrix[from_, to] += counts.values() 
```

时序示例，在 ipython 中：

```
In [64]: t = np.random.randint(0,50, 500)

In [65]: m1 = zeros((50,50))

In [66]: m2 = zeros((50,50))

In [67]: %timeit increment_counts_in_matrix_from_chain(t, m1)
1000 loops, best of 3: 895 us per loop

In [68]: %timeit update_matrix(t, m2)
1000 loops, best of 3: 504 us per loop 
```

它更快，但不是更快的数量级。为了真正加快速度，您可以考虑在 Cython 中实现它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T14:59:11.047

好的，很少有想法可以篡改，略有改进（以人类不理解为代价）

让我们从长度为 3000 的 0 到 9 之间的整数的随机向量开始：

```
L = 3000
N = 10
states = array(randint(N),size=L)
transitions = np.zeros((N,N)) 
```

在我的机器上，您的方法的*timeit*性能为**11.4 ms**。

一点改进的第一件事是避免两次读取数据，将其存储在临时变量中：

```
old = states[0]
for i in range(1,len(states)):
    new = states[i]
    transitions[new,old]+=1
    old=new 
```

这会给您带来约 10% 的改进，并将时间降至**10.9 ms**。

一种更内卷的方法使用步幅：

```
def rolling(a, window):
    shape = (a.size - window + 1, window)
    strides = (a.itemsize, a.itemsize)
    return np.lib.stride_tricks.as_strided(a, shape=shape, strides=strides)

state_2 = rolling(states, 2)
for i in range(len(state_2)):
    l,m = state_2[i,0],state_2[i,1]
    transitions[m,l]+=1 
```

strides 允许您读取数组的连续数字，从而欺骗数组以认为行以不同的方式开始（好的，它没有很好地描述，但是如果您花一些时间阅读有关 strides 的信息，您会明白的）这种方法性能下降，达到**12.2 ms**，但这是进一步欺骗系统的走廊。将转换矩阵和跨步数组展平为一维数组，可以进一步提高性能：

```
transitions = np.zeros(N*N)
state_2 = rolling(states, 2)
state_flat = np.sum(state_2 * array([1,10]),axis=1)
for i in state_flat:
    transitions[i]+=1
transitions.reshape((N,N)) 
```

这下降到**7.75 ms**。这不是一个数量级，但无论如何都要好 30% :)

# joomla - joomla2.5如何re quire_once

> ID：13219043
> 
> 赞同：1
> 
> 时间：2012-11-04T13:42:03.847
> 
> 标签：joomla, joomla-extensions, require-once

我对 joomla 中的 require_once 有疑问。

在这个文件 php 中：

```
components\com_test\views\__test_r5\tmpl\default.php 
```

我想使用以下代码包含一些文件：

```
require_once (JPATH_ROOT.DS.'/includes/General.php'); 
```

但 require_once 不起作用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T16:52:55.090

您尝试包含的路径将评估为：`joomla//includes/General.php`. *注意"includes"*之前的双斜杠。该常量`DS`被定义为目录分隔符。

试试：（
`require_once (JPATH_ROOT.'/includes/General.php');`
 没有`DS`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T04:57:36.587

试试这个 ：

```
require_once(JPATH_SITE.DS."includes/General.php"); 
```

JPATH_SITE 会将您的物理路径返回到：安装文件夹。

```
also JURI::root() will return your site url 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T06:18:09.467

最好的方法是使用@Fnatte 变体。

也看看[**Joomla！常量**](http://docs.joomla.org/Constants)定义并在需要时进行调整。

# api - Hadoop Mapreduce 配置（新 API）

> ID：13219052
> 
> 赞同：0
> 
> 时间：2012-11-04T13:43:07.297
> 
> 标签：api, configuration, hadoop

我只是想尝试一个教程（https://ccp.cloudera.com/display/DOC/Hadoop+Tutorial）程序WordCount V.2（页面底部），其中他们使用以下方法设置一些基本程序变量：

```
public void configure(JobConf job) {
...
} 
```

但是我正在尝试使用新的 Hadoop API，但这种方法似乎不再存在？谁能告诉我在新 API 中做这种事情的等效方法是什么？

另外，如何在运行时访问我的配置？我是否简单地调用：

```
Job.getConfiguration(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T13:48:41.490

您可以覆盖`Mapper`/中的设置方法`Reducer`，这将表现得像`configure`.

签名如下所示：

```
 @Override
 protected void setup(Context context) throws IOException,
       InterruptedException { 
```

在那里你得到一个`Context`对象，你可以在其中调用：

```
Configuration conf = context.getConfiguration(); 
```

`map`并且`cleanup`，两者都有这些上下文对象，因此您可以`Configuration`随时获取。

# sql - 触发器中的 IF 条件使用查询

> ID：13219053
> 
> 赞同：0
> 
> 时间：2012-11-04T13:43:07.843
> 
> 标签：sql, triggers

> order_placed(order_no,mess_id,...) 费率(mess_id,student_id,rating)

我想创建一个触发器来检查下订单时混乱的评级是否小于 4，如果是，则无法下订单。

```
CREATE TRIGGER new_order
AFTER INSERT ON order_placed
FOR EACH NEW ROW
BEGIN
IF((SELECT AVG(rating) FROM rates WHERE rates.mess_id = NEW.mess_id) < 4)
ROLLBACK TRAN
END; 
```

我得到一个`ERROR 1064`.

# c - 通过 args 读取字符串

> ID：13219054
> 
> 赞同：-1
> 
> 时间：2012-11-04T13:43:17.873
> 
> 标签：c

**你好，**

我正在尝试通过 args[] 参数将字符串读入我的代码，就像我在 Java 中所做的那样。所以基本上，这就是我想要做的：

```
 - read the String "machine" over launch-parameter
 - go through every letter of that string in a loop
 - while in the loop, check is current letter equals "e"
 - if letter equals "e", replace it with "a"
 - return edited string 
```

这是向 C 表达我的基本问题的最佳方式。所以如果你不接受这篇文章冒犯，我会很高兴。

我该如何实现该代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:20:05.197

这是一个（几乎）不涉及指针的解决方案，但如果您要进行中等高级的 C 编程，您应该真正了解指针。

```
void replace_e_with_a(char str[])
{
    int i, len = strlen(str);
    for (i=0; i<len; i++) {
        if (str[i] == e) str[i] = a;
    }
}

int main(int argc, char *argv[]){
   int i;
   for (i = 1; i < argc; i++) {
     replace_e_with_a(argv[i]);
     puts(argv[i]);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:26:17.377

这是应该起作用的东西。

```
#include <stdio.h>

void replace_e_with_a(char * str)
{
    int i;
    if (NULL != str)
      while ('\0' != *str ) {
          if (*str == 'e')
              *str = 'a';
          ++str;
      }
}

int main(int argc, char **argv){
   int i;
   for (i = 1; i < argc; ++i) {
     replace_e_with_a(argv[i]);
     puts(argv[i]);
   }
} 
```

# php - PHP regex：检查文本行是否有重复行

> ID：13219057
> 
> 赞同：-1
> 
> 时间：2012-11-04T13:43:36.887
> 
> 标签：php, regex

有线条

```
(01) Some text
(10) Foo Bar
(11) ?
(13) Foo Bar
(13) ?
(20) Something else 
```

批量检查 4 行。如果第 1 行和第 3 行相同，第 2 行和第 4 行相同`(XX) ?`，则将第 2-4 行替换`...`为

```
(01) Some text
(10) Foo Bar
...
(20) Something else 
```

* * *

**代码：**

```
$arr = explode("\n", $t);
if ( count($arr) > 3 )  {
    for ($i=1; $i<count($arr); $i++) { // check 4 rows
        if( ($arr[$i-1] == $arr[$i+1]) // if row 1 and 3 are the same
           && preg_match('/\(\d+\) \?$/', $arr[$i]) // and row 2 is "(XX) ?"
        && preg_match('/\(\d+\) \?$/', $arr[$i+2])  // and row 4 is "(XX) ?"
       ) {
            print "Match!"; //test. later replace rows 2-4 with a row "..."
         }
     }
} 
```

这目前给了我一个偏移错误。

测试：[http ://codepad.viper-7.com/iMO3BW](http://codepad.viper-7.com/iMO3BW)

这怎么可能解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T13:48:28.590

您正在扫描最多两个元素到未来，同时迭代到最后一个元素。你可以在这里看到这种情况。

```
preg_match('/\(\d+\) \?$/', $arr[$i+2]) 
```

将您的 FOR 语句更改为以下内容。

```
for($i=1; $i<count($arr) - 2; $i++) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:24:08.417

使用**正则表达式**模式

```
^(\(\d+\)\s+)(.*)[\n\r]\(\d+\)\s+\?[\n\r]\(\d+\)\s+\2[\n\r]\(\d+\)\s+\?[\n\r] 
```

带有**多行**和**全局**修饰符。

* * *

请参阅**[此正则表达式测试](http://regexr.com?32mr4)**。

# android - 为什么我的 OnLongClickListener 不工作？

> ID：13219060
> 
> 赞同：2
> 
> 时间：2012-11-04T13:44:05.103
> 
> 标签：android, imageview, onlongclicklistener

我想在长按图片时显示图片的 EXIF。所以我实现了这个：

```
 picture.setOnLongClickListener(new OnLongClickListener() { 
        public boolean onLongClick(View v) {
            ...
            return true;
        }
    }); 
```

问题是代码没有被执行。我添加`android:longClickable="true"`到xml中，没有成功。

有趣的是它适用于`OnClick`，但它不适用于`OnLongClick`......也许这与我的图片是 ImageView 的扩展有关，这里的（非常好！）类 TouchImageView：

[https://github.com/MikeOrtiz/TouchImageView/blob/master/src/com/example/touch/TouchImageView.java](https://github.com/MikeOrtiz/TouchImageView/blob/master/src/com/example/touch/TouchImageView.java)

我究竟做错了什么？？

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T13:57:20.573

`TouchImageView`在`OnTouchListener`总是调用`return true;`（文件中的第 112 行）。这就是为什么`OnLongClickListener`不工作。

# windows - 即使用户正在浏览文件夹，也可以删除文件/文件夹。

> ID：13219062
> 
> 赞同：1
> 
> 时间：2012-11-04T13:44:27.100
> 
> 标签：windows, powershell, cmd, delete-file

我有一个安装脚本，我不时需要删除文件和文件夹。但是，我的问题是某些用户可能正在浏览此文件夹或文件。这将引发错误“目录不为空”。有没有一种方法或方式会忽略用户浏览？像蛮力删除一样？

我想要在 PowersShell 或 Cmd 中执行此操作。

例如`cmd /c rmdir "folder"`

Remove-Item 给出了相同的错误。无论如何，我都需要能够删除。

(Windows 服务器 2008R2)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:03:53.323

如果另一个用户正在管理其内容，您真的不应该删除一个目录。从技术上讲，它需要卸载程序强制关闭所有文件/目录句柄。这可能会导致意想不到的副作用，因此完全不推荐。

话虽如此，您可以使用`handle.exe`Sysinterals Suite 强制关闭打开的文件句柄。汇总基于的自定义操作`handle`并不复杂。

我仍然建议您避免强制删除。相反，指示用户关闭所有打开的文件。

# macos - osX 10.8.2 检查 gcc 错误位置

> ID：13219063
> 
> 赞同：0
> 
> 时间：2012-11-04T13:44:56.067
> 
> 标签：macos, gcc

我遇到了 Apache ab 的问题，我正在尝试使用更新的版本对其进行更新。

在 apache 下载上运行 ./configure 时，此行出现错误

```
checking for gcc... /Applications/Xcode.app/Contents/Developer/Toolchains/OSX10.8.xctoolchain/usr/bin/cc 
```

该位置不存在，而是在

```
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc 
```

如何更改它以查看正确的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T00:38:21.020

我在尝试构建 tk 时遇到了同样的问题。

我可以通过创建从 OSX10.8.xctoolchain 到 XcodeDefault.xctoolchain 的符号链接来运行 make。使用以下命令可以轻松完成此操作：

```
sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain /Applications/Xcode.app/Contents/Developer/Toolchains/OSX10.8.xctoolchain 
```

如果它正在寻找错误的位置，这也应该可以解决问题，因为它将被重定向到正确的位置。

# java - 如何知道屏幕上容器或窗口的确切大小？

> ID：13219065
> 
> 赞同：0
> 
> 时间：2012-11-04T13:45:12.163
> 
> 标签：java, swing, size, jframe, containers

我有一个`JFrame`包含一个`JButton`当`JFrame`出现时，用户将调整大小`JFrame`，然后单击`JButton`哪个会做：

```
System.out.print("actual size now = "+JFrame.getsize"); 
```

但尺寸不会导致`JFrame`屏幕上的实际尺寸。

我使用时尺寸仍然错误：

*   `JFrame.getSize`

*   `JFrame.getPrefferedSize`

*   `JFrame.getMinimumSize`

*   `JFrame.getMaximumSize`

*   `JFrame.getBounds`

*   `JFrame.getHeight`&`getwidth`

我应该怎么办？

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:34:16.797

您获得的大小是`JFrame`s contentPane 的大小和`Inset`添加的 s 的大小。只需调用并从您可以通过s获得的*宽度*和*高度*`JFrame#getInsets()`中减去它们。`JFrame`**`JFrame#getSize()`**

 **这是一个例子：

```
import java.awt.Dimension;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Test {

    public Test() {
        initComponents();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }

    private void initComponents() {
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel panel = new JPanel() {
            @Override
            public Dimension getPreferredSize() {//the frame should now return a width and height of 300
                return new Dimension(300, 300);
            }
        };

        JButton button = new JButton("Get JFrame real width and height");
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {

                Dimension frameSize = frame.getSize();
                Insets insets = frame.getInsets();

                System.out.println("Frame size via getSize(): " + frameSize);
                System.out.println("Insets: " + insets);

                double width = frameSize.getWidth();
                double height = frameSize.getHeight();

                //calculate real width/height
                double realWidth = width - (insets.left + insets.right);
                double realHeight = height - (insets.top + insets.bottom);

                System.out.println("Width: " + realWidth + " Height: " + realHeight);
            }
        });

        panel.add(button);
        frame.add(panel);

        frame.pack();
        frame.setVisible(true);

    }
} 
```

输出：

> 通过 getSize() 获得的帧大小：java.awt.Dimension[width=316,height=338]
> 
> 插图：java.awt.Insets[top=30,left=8,bottom=8,right=8]
> 
> 宽度：300.0 高度：300.0**

# sql - Backbone.js + Twitter 引导程序

> ID：13219067
> 
> 赞同：1
> 
> 时间：2012-11-04T13:45:19.560
> 
> 标签：sql, web-applications, backbone.js, twitter-bootstrap, typeahead

我一直在尝试遵循[http://coenraets.org/directory/上的指南](http://coenraets.org/directory/)

我将“Web”文件夹的内容复制到我网站的根目录，页面看起来很好，我还将他的 sql 脚本安装到我的数据库中。搜索栏不起作用（可能是因为我的 SQL 数据库需要用户名和密码？）。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T13:54:28.557

我假设您已经设置了 slim 来运行从主干.js 接收 javascript 调用的 php 应用程序？

参考 - [https://github.com/ccoenraets/backbone-directory/blob/master/api/index.php](https://github.com/ccoenraets/backbone-directory/blob/master/api/index.php)

API 目录包含一个名为`index.php`. 对于这个应用程序中的 php slim 框架（http://www.slimframework.com/），它应该包含您的数据库 IP、用户名和密码。

文件中从第 148 行开始`index.php`。

```
function getConnection() {
    $dbhost="127.0.0.1";
    $dbuser="root";
    $dbpass="";
    $dbname="directory";
    $dbh = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass);  
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    return $dbh;
} 
```

您的服务器位置 - 98.214.131.200 - 如果您在该服务器本身上设置了此 php 应用程序，则无关紧要。 `127.0.0.1`指服务器 localhost 本身。

您需要配置的是`$dbuser`和`$dbpass`（您`$dbname`显然是正确的，因为您提到这是您通过运行提供的 sql 脚本创建的 MySQL 数据库），它对应于您为此演示应用程序设置的 MySQL 数据库。

如果您使用`apache`的是运行 slim，请确保`mod_rewrite`已启用并将您的 apache 虚拟主机配置为：-

```
<Directory "C:\Path\To\Your\slimphp">
    Allow From All
    AllowOverride All
</Directory>
<VirtualHost *:80>
    ServerName "slim.php"
    DocumentRoot "C:\Path\To\Your\slimphp"
</VirtualHost> 
```

啊，如果@vicvicvic 指出使用 IIS，请使用 ModRewrite - [http://www.micronovae.com/ModRewrite/ModRewrite.html](http://www.micronovae.com/ModRewrite/ModRewrite.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T13:53:20.183

您需要在`api`文件夹中配置后端，以便它实际与您的 SQL 数据库通信。在`getConnection`函数中执行此操作`api/index.php`：

```
function getConnection() {
    $dbhost="127.0.0.1";
    $dbuser="root";
    $dbpass="";
    $dbname="directory";
    $dbh = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass);  
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    return $dbh;
} 
```

# android - 如何使用加速度计获得角度变化？

> ID：13219070
> 
> 赞同：1
> 
> 时间：2012-11-04T13:45:39.990
> 
> 标签：android, accelerometer, android-sensors, angle

我正在尝试使用加速度计获取 Android 设备围绕设备 Z 轴和 X 轴的角度变化。（相对于应用程序首次启动或校准完成时设备的角度）

现在我知道我应该用陀螺仪来做，但由于陀螺仪漂移，这是不可能的。我试过用旋转矩阵和函数 getAngleChange() 来做，但它不起作用，因为据我了解，这个函数给出了世界坐标的角度变化，而不是设备坐标（这是我需要的）。

因此，如果有人可以帮助我解决这个问题，那就太棒了。

谢谢。

# c - 用户级程序应该捕捉哪些“致命”信号？

> ID：13219071
> 
> 赞同：9
> 
> 时间：2012-11-04T13:46:13.303
> 
> 标签：c, linux, signals, posix

首先，[我确实知道过去这里有一个类似的问题](https://stackoverflow.com/questions/5297062/recommended-signals-to-catch)。

但是这个问题没有得到正确的回答。相反，它转而建议如何捕捉信号。

所以只是澄清一下：我已经做了任何需要做的事情来处理信号。我有一个应用程序，它派生一个通过管道监视主进程的守护进程。如果一个主进程崩溃（例如分段错误），它有一个信号处理程序将所有需要的信息写入管道并中止。

*目标是在应用程序发生不良情况时*获得尽可能多的信息，而不会干扰“正常”操作，例如 SIGHUP、SIGUSR1 等。

所以我的问题是：**我应该捕捉哪些信号？** 我的意思是如果我没有捕捉到它们的信号，无论如何都会导致应用程序中止。

到目前为止，我已经提出了以下列表：

*   SIGINT（^C，用户启动，但仍需了解）
*   SIGTERM（`kill <pid>`来自 shell 或 AFAIK，可能是 OutOfMemory 的结果）
*   SIGSEGV
*   西吉尔
*   SIGFPE
*   信号总线
*   SIGQUIT

有人知道我是否想念什么吗？`kill -l`有很多... :)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T14:06:37.103

我正在查看我的 unix 环境高级编程副本 (Stevens)。根据信号部分中的表格，如果您没有捕捉到以下 POSIX 信号，则默认情况下会终止进程。监视所有您不使用的所有这些并不是不合理的：

*   SIGABRT
*   SIGALRM
*   SIGFPE
*   SIGHUP
*   西吉尔
*   信号情报
*   杀戮
*   SIGPIPE
*   SIGQUIT
*   SIGSEGV
*   SIGTERM
*   SIGUSR1
*   SIGUSR2

您可以捕获除 SIGKILL 之外的所有这些，但希望 SIGKILL 不会经常出现。

请注意，您的信号手册页`man 7 signal`（

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T13:59:23.423

您不应该捕获信号并将代码写入管道。这既是不必要的，也不是故障安全的。

让我从您链接的问题中引用一个答案，以指出为什么它不是故障安全的：*“是什么让您认为 SEGV 尚未损坏您的程序内存”*

现在您可能想知道如何做得更好，以及为什么我说它是“不必要的”。

`waitpid`可以检查系统调用的返回码，`WIFSIGNALED()`以确定进程是正常终止还是通过信号终止，`WTERMSIG()`并将返回信号号。

这是故障安全的*，*它不需要处理程序或管道。另外，您不必担心要捕获什么，因为它会报告终止您的进程的*每个信号。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T13:49:49.277

这取决于：您喜欢的任何信号是否有助于通知用户刚刚发生了不好的事情。但是 SIGKILL 和 SIGSTOP 不能被捕获。

# php - Wamp 服务器 - curl 不工作

> ID：13219074
> 
> 赞同：2
> 
> 时间：2012-11-04T13:46:33.593
> 
> 标签：php, curl, wampserver

我已经在我的 Windows 7 64 位上安装了 wamp 服务器。即使我从 wamp 启用 cURL 也无法正常工作。对于 php 和 apache 文件夹，我还在 php.ini 中取消了 extension=php_curl.dll 的注释。

它仍然显示 CURL 不起作用的消息

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-04T13:47:47.813

1.  关闭 WAMP（如果正在运行）
2.  导航`WAMP\bin\php\(your version of php)\`
3.  编辑`php.ini`
4.  搜索 curl，取消注释`extension=php_curl.dll`
5.  导航`WAMP\bin\Apache\(your version of apache)\bin\`
6.  编辑`php.ini`
7.  搜索 curl，取消注释`extension=php_curl.dll`
8.  保存两者
9.  重启 WAMP

# c++ - 计算非轴对齐正方形周围的 voronoi 区域

> ID：13219086
> 
> 赞同：0
> 
> 时间：2012-11-04T13:48:05.983
> 
> 标签：c++, collision, sfml, voronoi

我正在尝试使用 SAT 进行圆多边形碰撞。[http://www.metanetsoftware.com/technique/tutorialA.html#section3](http://www.metanetsoftware.com/technique/tutorialA.html#section3)建议 voronoi 区域通过查找圆的中心所在的 VR 来找到要测试的轴，然后使用侧面的轴或顶点带走圆心。

我如何计算这个 VR？所有多边形都是正方形，但不一定是轴对齐的。什么是一种廉价的计算方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:06:18.523

试试这篇文章。例子很少。 [http://www.codeproject.com/Articles/413452/Create-a-Voronoi-diagram-2-of-3](http://www.codeproject.com/Articles/413452/Create-a-Voronoi-diagram-2-of-3)

# ember.js - Ember：如何让路由器和控制器一起工作？

> ID：13219087
> 
> 赞同：0
> 
> 时间：2012-11-04T13:48:17.323
> 
> 标签：ember.js

对于我的登录/注销场景，我在 ember 中实现了条件路由：

```
 App.Router = Ember.Router.extend({

    //needs controller handling
    //goLoggedIn: Ember.Route.transitionTo('loggedIn'),
    goLoggedOut: Ember.Route.transitionTo('loggedOut'),

    root: Ember.Route.extend({
      index: Ember.Route.extend({
        route: '/',
          enter: function(router) {
              var logged = getLoginState();
              Ember.run.next(function() {
                  if (logged) {
                      router.transitionTo('loggedIn');
                  } else {
                      router.transitionTo('loggedOut');
                  }
              });
          }
      }),

      loggedIn: Ember.Route.extend({
        connectOutlets: function(router, context){
          ...
        }
      }),

      loggedOut: Ember.Route.extend({
        connectOutlets: function(router, context){
          ...
        }
      })
      ... 
```

我的 index.html 表示已登录视图

```
 <!-- Template for out -->
    <script type="text/x-handlebars" data-template-name="out">
      <hr /><br />
      <h1>Logged Out</h1>
      <span>Login with "test/test"</span><br /><br />
      <label>Username: </label>{{view Ember.TextField valueBinding="App.OutController.username"}}<br />
      <label>Password: </label>{{view Ember.TextField valueBinding="App.OutController.password" type="password"}}<br />

      {{#if App.loginController.isError}}
        <span class="login-error">Error: Invalid username or password.</span><br />
      {{/if}}

      <br /><button {{action goLoggedIn href=true}}>Login</button>
    </script> 
```

现在我将这个动作简单地委托给我的路由器。我知道我也可以将其委托给我的控制器：

```
 action login target="controller" 
```

但在那之后，如何在我的路由器中执行 transitionTo 功能？因为我知道这不应该在我的控制器中完成。那么如何将它传递给我的路由器？

可能我错了，我不得不让`{{action goLoggedIn href=true}}`。然后我的路由器将这个功能委托给我的控制器，我得到一个响应。而不是让`goLoggedIn: Ember.Route.transitionTo('loggedIn')`我需要像 App.LoginController.doLogin 和之后的东西`goLoggedIn: Ember.Route.transitionTo('loggedIn')`。这种情况下怎么执行呢？

**编辑：**

像这样？

```
 App.Router = Ember.Router.extend({

    //needs controller handling
    goLoggedIn: Ember.Route.transitionTo('loggedIn'),
    goLoggedOut: Ember.Route.transitionTo('loggedOut'),

    root: Ember.Route.extend({
      index: Ember.Route.extend({
        route: '/',
          enter: function(router) {
              var logged = getLoginState();
              Ember.run.next(function() {
                  if (logged) {
                      router.transitionTo('loggedIn');
                  } else {
                      router.transitionTo('loggedOut');
                  }
              });
          }
      }),

      loggedIn: Ember.Route.extend({
        connectOutlets: function(router, context){
          ...
        }
      }),

      loggedOut: Ember.Route.extend({
        connectOutlets: function(router, context){
          ...
        },
        goLoggedIn: function(router, evt) {
          router.get('inController').tryLogin()
          router.transitionTo('loggedIn')
        }
      })
      ... 
```

我得到：`Cannot call method 'split' of undefined`

编辑2：

它现在正在工作。我不得不删除`href=true`. 谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T17:30:08.853

在典型的 Ember 应用程序中，`target`每个控制器的属性都设置为 Router 实例。如果你想向控制器发送一个动作，然后再发送到路由器，你可以在控制器方法中通过说`this.get('target').send('goLoggedIn', optionalEvt)`

我建议您让操作直接发送到路由器。在转换之前，您可以让函数处理可以在一个或多个控制器上调用方法的操作。例如：

```
...
{{action log href=true}}
...

logIn: function(router, evt) {
  router.get('userController').prepareForLogin()
  router.transitionTo('loggedIn')
} 
```

# javascript - 用于可以离线工作并支持标记的自定义图片地图的 JavaScript API？

> ID：13219088
> 
> 赞同：1
> 
> 时间：2012-11-04T13:48:18.600
> 
> 标签：javascript, html, google-maps

我有一个城市的图像，我想制作一个类似于地图的 HTML5 应用程序，
我想添加我自己的图片，添加标记，它需要可缩放，并且需要离线工作。

我想到了 Google Maps API，虽然它不能离线工作，有没有 JavaScript API 可以？

# java - Java中的Int到英语单词

> ID：13219091
> 
> 赞同：3
> 
> 时间：2012-11-04T13:48:34.117
> 
> 标签：java

在这里我要问一些奇怪的事情。

我想问一下，是否有任何方法/逻辑可以将整数值转换为包含数字的英文单词的字符串值？

例如，用户输入 22 并获得输出 22 或 2。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T13:51:41.770

查看[此](http://www.rgagnon.com/javadetails/java-0426.html)代码，它可能是您正在寻找的。例如，在 main 方法中，如果我们有：

```
System.out.println(convert(22)); 
```

输出：

```
twenty two 
```

* * *

***编辑***我已经复制了下面的代码，稍微清理了格式（主要方法在底部）：

```
import java.text.DecimalFormat;

public class EnglishNumberToWords {

    private static final String[] tensNames = { "", " ten", " twenty",
            " thirty", " forty", " fifty", " sixty", " seventy", " eighty",
            " ninety" };

    private static final String[] numNames = { "", " one", " two", " three",
            " four", " five", " six", " seven", " eight", " nine", " ten",
            " eleven", " twelve", " thirteen", " fourteen", " fifteen",
            " sixteen", " seventeen", " eighteen", " nineteen" };

    private static String convertLessThanOneThousand(int number) {
        String soFar;

        if (number % 100 < 20) {
            soFar = numNames[number % 100];
            number /= 100;
        } else {
            soFar = numNames[number % 10];
            number /= 10;

            soFar = tensNames[number % 10] + soFar;
            number /= 10;
        }
        if (number == 0)
            return soFar;
        return numNames[number] + " hundred" + soFar;
    }

    public static String convert(long number) {
        // 0 to 999 999 999 999
        if (number == 0) {
            return "zero";
        }

        String snumber = Long.toString(number);

        // pad with "0"
        String mask = "000000000000";
        DecimalFormat df = new DecimalFormat(mask);
        snumber = df.format(number);

        // XXXnnnnnnnnn
        int billions = Integer.parseInt(snumber.substring(0, 3));
        // nnnXXXnnnnnn
        int millions = Integer.parseInt(snumber.substring(3, 6));
        // nnnnnnXXXnnn
        int hundredThousands = Integer.parseInt(snumber.substring(6, 9));
        // nnnnnnnnnXXX
        int thousands = Integer.parseInt(snumber.substring(9, 12));

        String tradBillions;
        switch (billions) {
        case 0:
            tradBillions = "";
            break;
        case 1:
            tradBillions = convertLessThanOneThousand(billions) + " billion ";
            break;
        default:
            tradBillions = convertLessThanOneThousand(billions) + " billion ";
        }
        String result = tradBillions;

        String tradMillions;
        switch (millions) {
        case 0:
            tradMillions = "";
            break;
        case 1:
            tradMillions = convertLessThanOneThousand(millions) + " million ";
            break;
        default:
            tradMillions = convertLessThanOneThousand(millions) + " million ";
        }
        result = result + tradMillions;

        String tradHundredThousands;
        switch (hundredThousands) {
        case 0:
            tradHundredThousands = "";
            break;
        case 1:
            tradHundredThousands = "one thousand ";
            break;
        default:
            tradHundredThousands = convertLessThanOneThousand(hundredThousands)
                    + " thousand ";
        }
        result = result + tradHundredThousands;

        String tradThousand;
        tradThousand = convertLessThanOneThousand(thousands);
        result = result + tradThousand;

        // remove extra spaces!
        return result.replaceAll("^\\s+", "").replaceAll("\\b\\s{2,}\\b", " ");
    }

    public static void main(String[] args) {
        System.out.println(convert(22));  // "twenty two"
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-05T08:57:07.067

虽然公认的答案有效，但最好使用已经实现的函数来执行此操作。[ICU4J](http://site.icu-project.org)包含一个`com.ibm.icu.text.RuleBasedNumberFormat`可用于执行此操作的类。它还支持英语以外的语言，以及反向操作，将文本字符串解析为整数值。

这是一个示例，假设我们在类路径中有[ICU4J 依赖项](https://mvnrepository.com/artifact/com.ibm.icu/icu4j)：

```
import com.ibm.icu.text.RuleBasedNumberFormat;
import java.util.Locale;

RuleBasedNumberFormat nf = new RuleBasedNumberFormat (Locale.UK, RuleBasedNumberFormat.SPELLOUT);
nf.format(24);
// The result is "twenty-four" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-17T12:34:01.457

我有一个非常简单的解决方案，可以将 java 中的整个整数范围转换为英语表示法

```
 String h1[] = { "Zero", "One", "Two", "Three", "Four", "Five", "Six",
                "Seven", "Eight", "Nine", "Ten", "Eleven", "Tweleve", "Thirteen",
                "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen",
                "Nineteen" };
        String h2[] = { "Twenty", "Thirty", "Fourty", "Fifty", "Sixty", "Seventy",
                "Eighty", "Ninety" };
        String h3[] = { "Hundred", "Thousand", "Lakh", "Crore", "Arab" };

public String parseToHinglishNotation(int num) {
        String word = "";

        if (num < 0) {
            word += "Minus ";
            num = -num;
        }

        if (num < 20) {
            word += h1[num];
        } else if (num < 100) {
            int temp = num / 10 - 2;
            word += h2[temp];

            temp = num % 10;
            if (temp > 0) {
                word += " " + parseToHinglishNotation(temp);
            }
        } else if (num < 1000) {
            int temp = num / 100;
            word += parseToHinglishNotation(temp) + " " + h3[0];

            temp = num % 100;
            if (temp > 0) {
                word += " " + parseToHinglishNotation(temp);
            }
        } else if (num < 100000) {
            int temp = num / 1000;
            word += parseToHinglishNotation(temp) + " " + h3[1];

            temp = num % 1000;
            if (temp > 0) {
                word += " " + parseToHinglishNotation(temp);
            }
        } else if (num < 10000000) {
            int temp = num / 100000;
            word += parseToHinglishNotation(temp) + " " + h3[2];

            temp = num % 100000;
            if (temp > 0) {
                word += " " + parseToHinglishNotation(temp);
            }
        } else if (num < 1000000000) {
            int temp = num / 10000000;
            word += parseToHinglishNotation(temp) + " " + h3[3];

            temp = num % 10000000;
            if (temp > 0) {
                word += " " + parseToHinglishNotation(temp);
            }
        } else if (num <= 2147483647) {
            int temp = num / 1000000000;
            word += parseToHinglishNotation(temp) + " " + h3[4];

            temp = num % 1000000000;
            if (temp > 0) {
                word += " " + parseToHinglishNotation(temp);
            }
        }

        return word;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-16T03:59:08.950

我知道这篇文章有点老了，但我最近想出了自己的解决方案，并认为它可能值得分享。主函数`numToWords`取`Integer`1 到 9999（含）之间的任何一个，并输出其对应的英文单词，然后是`String`括号中的数字。

示例：如果`Integer x = 2614;`，则`numToText(x);`返回`"Two Thousand Six Hundred Fourteen (2614)"`：

数字等价词存储在 HashMap 中，具体取决于它们是 1 还是 10 的倍数（例如`6 --> "Six"`， ），而青少年则通过语句`60 --> "Sixty"`独立处理。`switch`

```
import java.util.HashMap;

public class Converter{

    public Converter(){
        hm1.put(0, "");
        hm1.put(1, "One");
        hm1.put(2, "Two");
        hm1.put(3, "Three");
        hm1.put(4, "Four");
        hm1.put(5, "Five");
        hm1.put(6, "Six");
        hm1.put(7, "Seven");
        hm1.put(8, "Eight");
        hm1.put(9, "Nine");

        hm10.put(0, "");
        hm10.put(1, "");
        hm10.put(2, "Twenty ");
        hm10.put(3, "Thirty ");
        hm10.put(4, "Fourty ");
        hm10.put(5, "Fifty ");
        hm10.put(6, "Sixty ");
        hm10.put(7, "Seventy ");
        hm10.put(8, "Eighty ");
        hm10.put(9, "Ninety ");
    }

    public static String numToWords(Integer x){
            // Obtain a char[] of the Integer to analyze each digit.
        String s = x.toString();
        char[] cArray = s.toCharArray();

            // Refer to the length of the Integer as its final index.
        int l = cArray.length-1;
        String retStr = "";
            // The loop counts backwards from the right-most digit. 
        for(int i = l; i >= 0; i--){
                // Determine the numeric value at the left-most index, then move rightward.
                // This setup is attributed to the nuances of the English language.
            int j = Character.getNumericValue(cArray[l-i]);
                //
            if(i == 3){
                retStr += hm1.get(j);
                retStr += " Thousand ";
            } else if(i == 2){
                retStr += hm1.get(j);
                retStr += " Hundred ";    
            } else if(i == 1){
                    //If the 10s digit is 1, the final word is 10 <= x <= 19.
                if(j == 1){
                    String tens = "";
                        // Check the 1s digit to determine x (10 <= x <= 19)
                    switch(Character.getNumericValue(cArray[l])){
                        case 0: tens = "Ten";                   
                                break;  
                        case 1: tens = "Eleven";                    
                                break;
                        case 2: tens = "Twelve";
                                break;
                        case 3: tens = "Thirteen";
                                break;
                        case 4: tens = "Fourteen";
                                break;
                        case 5: tens = "Fifteen";
                                break;
                        case 6: tens = "Sixteen";
                                break;
                        case 7: tens = "Seventeen";
                                break;
                        case 8: tens = "Eighteen";
                                break;
                        case 9: tens = "Nineteen";
                                break;
                        }
                    i = -1; // Ensure it's the last word by indexing out of the loop.
                    retStr += tens;
                } else {
                        //If the 10s digit is 2 <= x <= 9, the 10s word is 20 <= x <= 90.
                    retStr += hm10.get(j);
                }
            } else if(i == 0){
                retStr += hm1.get(j);
            }
        }
        return retStr + " (" + x + ") ";
    }

    private HashMap<Integer, String> hm1 = new HashMap<Integer, String>();
    private HashMap<Integer, String> hm10 = new HashMap<Integer, String>();
} 
```

# javascript - jQuery append() for 循环后的多个元素而不展平为 HTML

> ID：13219094
> 
> 赞同：1
> 
> 时间：2012-11-04T13:48:42.520
> 
> 标签：javascript, jquery, optimization, loops, append

我有一个循环：

```
for (index = 0; index < total_groups; index += 1) {

    groups[index].list_item = $(list_item_snippet);

    // Closure to bind the index for event handling
    (function (new_index) {

        groups[index].list_item.find('.listing-group-title')
                               .html(groups[index].Group.Name)
                               .click(function(e){

            fns.manageActiveGroup(new_index, groups);
            return false;
        });

    })(index);

    // Append to DOM
    mkp.$group_listing.append(groups[index].list_item);
}; 
```

我宁愿不要`append()`在每次循环触发时调用。

我知道我可以使用字符串并将标记与每个循环迭代连接起来，并将字符串附加到`mkp.$group_listing`末尾，但是这会使对象变平并且绑定丢失（我不依赖于 ID）。

有没有一种方法可以将我的对象添加到一个数组中，并在底部一次性将它们全部附加到 HTML 中？

假设：

*   `$(list_item_snippet)`包含一些定义列表项的 HTML（并包含一个带有 class 的元素`.listing-group-title`）。
*   `groups`是在我的脚本中定义“组”的 JSON 块
*   关闭工作完美

编辑：

发现我可以使用以下语法来追加多个元素：

```
mkp.$group_listing.append(groups[0].list_item, groups[1].list_item ); 
```

但我显然需要自动化它——它不是一个数组，它只是可选的附加函数参数，所以我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:32:39.293

要将元素数组附加到选择器，您可以使用以下命令：

```
$.fn.append.apply($sel, myArray); 
```

在您的情况下，由于它实际上`.list_item`是您需要的每个数组元素的属性，因此您可以`$.map`先使用它来提取它们：

```
$.fn.append.apply(mkp.$group_listing, $.map(groups, function(value) {
     return value.list_item;
})); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T13:55:48.550

`on()`如果您使用如下方式绑定它，而不是按照您所做的方式绑定它，

```
$(document).on('click', '.listing-group-title', function() {
    // click handler code here
}); 
```

您可以展平 HTML 并将其附加到一个语句中，它仍然可以工作。

**注意：**为提高效率，请将`document`上述语句中的选择器替换为匹配最近的父级的选择器`.listing-group-title`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:07:02.243

是的。使用 jQuery`add`方法将所有项目添加到 jQuery 对象。然后附加那个对象。

[http://api.jquery.com/add/](http://api.jquery.com/add/)

编辑：示例：

```
var arr = $();

for (index = 0; index < total_groups; index += 1) {

    groups[index].list_item = $(list_item_snippet);

    // Closure to bind the index for event handling
    (function (new_index) {
        ...
    })(index);

    // Add to jQuery object.
    arr.add(groups[index].list_item));
};

mkp.$group_listing.append(arr); 
```

# java - 接口之间的转换

> ID：13219097
> 
> 赞同：4
> 
> 时间：2012-11-04T13:48:50.023
> 
> 标签：java, interface, casting

我的问题与 Java 语言有关。这就是我得到的：

```
interface I1{}
interface I2{}
class C1 implements I1{}
class C3 extends C1 implements I2{} 
```

什么时候

```
 C1 01;
     C3 o3;
     I1 i1; 
```

ETC

现在事实证明这`I2 i2 = (I2) i1;`是正确的，因为在运行时 i1 实际上是指实现 I2 的对象。但我不明白。接口之间没有任何关系，那么如何将其转换为相邻的接口呢？没有更多的代码，它只是为了准备Java认证的练习。此致

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:09:39.613

如果您将 an强制转换`Integer`为 a `String`，编译器可以将其视为非法的，但是，由于一个类可以实现多种接口，因此当您将一种接口类型强制转换为另一种时，编译器无法知道您是否违规。考虑这段代码：

```
I1 i1 = getI1();
if (i1 instanceof I2) {
  I2 i2 = (I2) i1;
} 
```

如果 Java 编译器不允许从一个接口转换到另一个接口，那么这段完全合法的代码将无法编译。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T14:01:40.347

`I2 i2 = (I2) i1;`意思是：我知道被引用的对象的具体运行时类型`i1`实现了`I2`接口，所以我想将其引用为`I2`. 如果具体的运行时类型`i1`确实 implements `I2`，则转换将成功。

`I1`和`I2`没有共同点的事实并不重要。重要的是 . 引用的对象的实际具体运行时类型`i1`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:03:09.693

你自己回答了这个问题;-)

```
"[... ]is right because at run time i1 actually refers to an object that implements I2" 
```

类型转换是在运行时而不是在编译时评估的。`i1`因此，如果在运行时指向的对象是类型`I2`，则没有错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T14:09:15.633

简单地说，接口是一种类型，就像鸟一样——不是鹰或鸭。采取这些类的具体实现（这很愚蠢，但请耐心等待）

```
interface Bird {fly();}
interface Swimmer {swim();}
class Eagle implements Bird {fly(){...};}
class Duck extends Eagle implements Swimmer {swim(){...};}

Swimmer i2 = (Swimmer) i1; 
```

这意味着您的代码认为 i1 是一个可以游泳的实体。如果 i1 是鸭子，此代码将起作用，如果它是鹰，则此代码将失败。类型转换是在运行时而不是编译时完成的。

# xna - XNA 擦除/移除 Texture2D

> ID：13219098
> 
> 赞同：0
> 
> 时间：2012-11-04T13:48:55.213
> 
> 标签：xna

我是 XNA 4.0 的新手，我想创建一个太空飞船射击游戏。当我杀死敌人时，我想在它死亡的地方绘制一个爆炸纹理，并且爆炸纹理将消失 2 秒。当敌人死亡时，我设法绘制了一个爆炸纹理，如果敌人在 Draw 方法中是否死亡，则使用布尔值，但我不知道如何在 2 秒后将其移除。谢谢您的帮助。

```
if (alive)
sp.Draw(enemyTexture, enemyPos, Color.White);

else
sp.Draw(explode, enemyPos, Color.White); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:57:42.523

对爆炸开始和结束之间的两秒间隔进行类似的检查。您可以只保存爆炸时间并检查它是否比当前时间早 2 秒或更早，如下所示：

```
TimeSpan explosionTime;
if (itsTimeToExplode)
    explosionTime = gameTime.TotalGameTime; 
```

然后你检查一下是否是时候移除爆炸动画：

```
if (gameTime.TotalGameTime.TotalMilliseconds - explosionTime.TotalMilliseconds >= 2000) // 2000 milliseconds is 2 seconds
    RemoveExplosionAnimation(); 
```

你可以把`explosionTime`你的敌人类放在里面，只有在敌人死了并且播放了爆炸动画后才删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T13:55:58.447

您需要使用 gameTime 变量计算 Update 方法中的时间。当您的计数器达到 2s 时，只需 make alive = false; 但更好的想法是使用更新和绘制方法为您的爆炸精灵创建类，并从那里处理计数和渲染。

# android - 从 SD 卡加载和播放声音？

> ID：13219099
> 
> 赞同：2
> 
> 时间：2012-11-04T13:48:56.047
> 
> 标签：android, soundpool

我有使用 SoundPool 播放声音的按钮。我想打开我的应用程序并从 SD 卡加载声音，然后用我的按钮播放它们。谁能给我一个例子如何做到这一点？这是我的 Java 代码：

```
package com.example.idea;

import android.media.SoundPool;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;

public class MainActivity extends Activity {
SoundPool sp;
int mSoundId;
int mStreamId;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    mSoundId = sp.load(this, R.raw.sound1, 1);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
public void button1(View view){
    if (mStreamId != 0) {
        sp.stop(mStreamId);
    }
    mStreamId = sp.play(mSoundId, 1, 1, 1, 0, 1f);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:08:31.540

为什么不使用[`SoundPool.load(String path, int priority)`](http://developer.android.com/reference/android/media/SoundPool.html#load%28java.lang.String,%20int%29)？

使用它，您应该能够从 SD 卡打开文件。

# android - 在 Android 的蓝牙中，BluetoothSocket.connect 是否调用 SDP 来获取新通道

> ID：13219102
> 
> 赞同：1
> 
> 时间：2012-11-04T13:49:31.103
> 
> 标签：android, sockets, bluetooth, sdp

作为问题标题的延续，我通过从配对设备中选择一个*BluetoothDevice*设备并执行以下操作来获取 BluetoothSocket：

```
bSocket = device.createInsecureRfcommSocketToServiceRecord(myUUID);
bSocket.connect(); 
```

我的问题是这样的：假设在通过 UUID 进行通信的通道配对时被记录为通道 2，但在连接时，另一个设备已将其侦听器切换到通道 3，并在通道 3 上为相同的 myUUID。

当我进行*连接*时，它会尝试连接到通道 2（在缓存中，请参阅我的另一个[问题](https://stackoverflow.com/questions/13218252/modify-android-server-bluetoothservice-java-to-update-cached-service-channel-no)）还是会（.connect 命令）执行新的 SDP 以获取当前通道，即 3 并尝试连接到频道 3（和 myUUID）。

是否可以通过*connect*命令查看尝试了哪个通道。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T12:50:02.490

Android 上有一些用于蓝牙的隐藏（模糊）功能可能会有所帮助。它被称为 IBluetooth。 **[这里](http://snipplr.com/view/49526/get-ibluetooth-instance/)**是如何使用它的描述。

一旦你让它运行，尝试*getRemoteServiceChannel*函数和*onRfcommChannelFound*回调 - 它会得到正确的通道并分别显示为你的 UUID 找到的通道。

通常，由于您的错误，我希望您在第一次连接时获得通道 2，然后什么也得不到。这意味着 Android 很懒惰，没有进行另一次 SDP 浏览。

如何让它们正确连接？也许运气好的话，在通道 2 连接后，调用这些隐藏函数会刷新它的 SDP 数据库？！另一种方法是解除绑定并以编程方式重新绑定它们 - 我怀疑这将使它进行另一个 SDP 浏览......

有用别忘了点赞

# scala - 使用 squeryl 存储案例对象

> ID：13219104
> 
> 赞同：3
> 
> 时间：2012-11-04T13:49:40.650
> 
> 标签：scala, squeryl

如何使用 squeryl 存储用户案例对象？我有一个 Account 对象，其权限字段类型为 Permission（定义为密封特征）。我还有 2 个案例对象（Administrator 和 NormalUser）从 Permission 扩展而来。如何使用 Squeryl 持久化 Account 类。下面的示例代码：

```
sealed trait Permission
case object Administrator extends Permission
case object NormalUser extends Permission

case class Account(
        id: Long, 
        email: String,
        permission: Permission
) extends KeyedEntity[Long] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T21:11:38.133

扩展我的评论，如果您使用自定义类型来检索权限类型，以便它作为整数保存到数据库中（在下面的示例中 1 和 0），您可以覆盖 unapply 方法来查找案例对象和模式匹配应该可以正常工作。我想像下面这样的东西应该可以工作：

```
class Permission(identifier:Int) extends org.squeryl.customtypes.IntField(identifier) {
  self: CustomType[Int] =>

  private lazy val permissions = 
    List(Administrator, NormalUser).
      map(p => p.value -> p).
      toMap

  def unapply = permissions.get(value)
}

case object Administrator extends Permission(1)
case object NormalUser extends Permission(0) 
```

然后您应该能够使用您的实体定义将权限直接存储在您的代码中：

```
case class Account(
        id: Long, 
        email: String,
        permission: Permission
) extends KeyedEntity[Long] 
```

您可以将`permission`字段直接设置为`Administrator`or`NormalUser`并且您还应该能够进行模式匹配，例如：

```
account.permission match {
  case Administrator => ..
  case NormalUser => ..
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:34:53.680

您需要定义架构：

```
 object Library extends Schema {

     val authors = table[Author]("AUTHORS")
 } 
```

然后插入实体：

```
 authors.insert(new Author("Herby Hancock")) 
```

[http://squeryl.org/schema-definition.html](http://squeryl.org/schema-definition.html)

[http://squeryl.org/inserts-updates-delete.html](http://squeryl.org/inserts-updates-delete.html)

为了存储 Permission，它必须继承包 org.squeryl.customtypes 中 CustomType 的子类型之一，并将 org.squeryl.customtypes.CustomTypesMode._ 导入到定义语句的范围内。有关详细信息，请阅读此处的自定义类型部分：http: [//squeryl.org/schema-definition.html](http://squeryl.org/schema-definition.html)

# c++ - Linux 是否记录守护程序抛出的未捕获异常？

> ID：13219105
> 
> 赞同：3
> 
> 时间：2012-11-04T13:49:42.127
> 
> 标签：c++, linux, events, exception, daemon

我用 C++ 编写了一个 Linux 守护进程。代码是这样的：

```
int main(int argc, char** argv)
{
    daemon(1, 0); // Daemonize itself, retaining the current working directory and redirecting stdin, stdout and stderr to /dev/null.
    // My program logic goes here
} 
```

问题是，我的程序逻辑偶尔会抛出异常。如何捕获异常以便知道哪里出错了？

我知道对于一个普通的控制台应用程序，未捕获的异常将被转储到控制台。在我的情况下，调用 daemon(1, 0) 后，控制台不再可访问。

在 Windows 上，任何未捕获的异常都将由操作系统保存，并且可以通过计算机管理中的事件查看器查看。Linux上有类似的机制吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T14:03:02.800

你有两个解决方案：

*   一：您将对守护程序函数的调用更改为

    ```
    daemon(1,1); 
    ```

    这将使程序仍然可以访问标准输出，随后将保留将未捕获的异常转储到控制台的默认行为。

*   二：您不更改调用，但添加一个全局`try { /* main code here */ } catch(...){ /* logging code here */ }`以将任何未捕获的异常记录到文件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T14:14:50.413

[假设您按照didierc 的建议](https://stackoverflow.com/a/13219203/283302)弄清楚您的日志记录，您可能会考虑安装一个`std::set_terminate()`处理程序，以便您可以[从未处理的异常中查看堆栈跟踪](https://stackoverflow.com/a/3356421/283302)

```
#include <iostream>
#include <stdexcept>

#include <execinfo.h>

void
handler()
{
    void *trace_elems[20];
    int trace_elem_count(backtrace( trace_elems, 20 ));
    char **stack_syms(backtrace_symbols( trace_elems, trace_elem_count ));
    for ( int i = 0 ; i < trace_elem_count ; ++i )
    {
        std::cout << stack_syms[i] << "\n";
    }
    free( stack_syms );

    exit(1);
}   

int foo()
{
    throw std::runtime_error( );
}

int
main()
{
    std::set_terminate( handler );
    foo();
} 
```

# facebook - 自定义社交分享按钮策略

> ID：13219108
> 
> 赞同：-1
> 
> 时间：2012-11-04T13:50:15.373
> 
> 标签：facebook, twitter, google-plus

我在我的网站上从 facebook、g+ 和 twitter 添加了用于社交分享的自定义按钮。它们包括关注/添加到油炸和喜欢/+1/tweet。我已使用 Internet 上提供的 URL 来实现该功能。

我的问题是，我是否违反了这些公司的任何许可条款。请。审查并告诉我。

[网站](http://www.javaexperience.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T15:47:25.667

您的 Google+ 关注按钮未遵循[Google+ 徽章政策，该政策规定](https://developers.google.com/+/plugins/badge/branding-guidelines)您不应创建或使用非 Google 提供的按钮。

抱歉，不知道其他服务的答案。

# python - 如何将 python 表达式嵌入到 vim 中的 :s 命令中？

> ID：13219111
> 
> 赞同：5
> 
> 时间：2012-11-04T13:50:55.187
> 
> 标签：python, vim

我可以`\=expr`在`:s`命令中使用。例如，要就地转换时间戳格式：

```
:%s/\v<\d{10}>/\=strftime('%c', submatch(0))/g 
```

* * *

但是内置函数的功能非常有限。要解析时间戳，我想使用这样的 python 脚本：

```
$ python
>>> import datetime
>>> d = 'Apr 11 2012'
>>> datetime.datetime.strptime(d, '%b %d %Y').isoformat()
'2012-04-11T00:00:00' 
```

* * *

如何将其嵌入`py-expr`到`:s`命令中？

```
:%s/\v\w+ \d{2} \d{4}/\={?py-expr?}/g 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T17:20:04.250

如果您至少有 vim-7.3.569 那么您可以执行以下操作：

```
:python import datetime
:%s/\v\w+\ \d{2}\ \d{4}/\=pyeval('datetime.datetime.strptime(vim.eval("submatch(0)"), "%b %d %Y").isoformat()')/g 
```

. 如果你没有最近的 vim，你可以在这种情况下模拟 pyeval：

```
function Pyeval(expr)
    python import json
    python vim.command('return '+json.dumps(eval(vim.eval('a:expr'))))
endfunction 
```

, 然后`pyeval`在上面的代码中替换为`Pyeval`.

# php - 无法通过 Cpanel (WHM) 或 SSH 安装任何 PHP PECL

> ID：13219112
> 
> 赞同：2
> 
> 时间：2012-11-04T13:50:56.670
> 
> 标签：php, module, installation, centos, pecl

当我尝试通过 cpanel 或 whm (CENTOS 6.3 x86_64 / WHM 11.34.0 (build 7)) 通过 PHP PECL 安装模块时，我总是得到以下结果：

> 错误：`/root/tmp/pear/imagick/configure --with-imagick' 失败 Imagick.so 对象不在 /usr/local/lib/php/extensions/no-debug-non-zts-20090626

在另一个带有 html_parse 的示例中：

> 错误：`/root/tmp/pear/html_parse/configure --with-ekhtml' 失败 html_parse.so 对象不在 /usr/local/lib/php/extensions/no-debug-non-zts-20090626

我用谷歌搜索了它，提出了建议，结果总是一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-08T21:40:39.583

我有一个类似的服务器设置，我需要 pecl_http。我没有使用 WHM（主页 » 软件 » 模块安装程序），而是使用命令行。只需输入：pecl install pecl_http

其他模块如 html_parse 应该是一样的，只需更改模块名称，如：pecl install html_parse

想我会为其他寻找此信息的人添加此信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:06:21.733

您要安装什么库？

如果我曾经使用 yum 安装他们的 PHP 库版本，我发现在 Redhat、centos 或 fedora 机器上使用 pecl 的结果好坏参半。解决您的问题的最简单方法是查看它是否在 Yum 存储库中并以​​这种方式安装：

```
 yum search 'modulename'
 yum install 'packagename' 
```

我通常只是做一个`yum search php`并扫描模块列表。

如果你想使用 pecl 或者因为库不是 yum 的一部分而不能使用，我会删除本机包含的版本并从头开始构建你的 PHP。您也可以通过 yum 删除随发行版安装的 PHP 和相关库。

# c# - 从excel导入sql格式错误

> ID：13219113
> 
> 赞同：0
> 
> 时间：2012-11-04T13:51:17.557
> 
> 标签：c#, asp.net, sql

嗨，我正在尝试从网页的 excel 电子表格将数据加载到 sql 中，我收到“无法将类型隐式转换为 ' `string`' `decimal`”错误我尝试了不同的方法来纠正此问题，但没有任何效果。

```
namespace CarpartsStore.Dealers
{

partial class DealerHome : System.Web.UI.Page
{

    protected void ButtonUpload_Click(object sender, System.EventArgs e)
    {
        PanelUpload.Visible = true;
        PanelView.Visible = false;
        PanelImport.Visible = false;
    }

    protected OleDbCommand ExcelConnection()
    {

        // Connect to the Excel Spreadsheet
        string xConnStr = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Server.MapPath("~/ExcelImport.xls") + ";" + "Extended Properties=Excel 8.0;";

        // create your excel connection object using the connection string
        OleDbConnection objXConn = new OleDbConnection(xConnStr);
        objXConn.Open();

        // use a SQL Select command to retrieve the data from the Excel Spreadsheet
        // the "table name" is the name of the worksheet within the spreadsheet
        // in this case, the worksheet name is "Members" and is coded as: [Members$]
        OleDbCommand objCommand = new OleDbCommand("SELECT * FROM [Products$]", objXConn);
        return objCommand;

    }

    protected void ButtonView_Click(object sender, System.EventArgs e)
    {
        PanelUpload.Visible = false;
        PanelView.Visible = true;
        PanelImport.Visible = false;

        // Create a new Adapter
        OleDbDataAdapter objDataAdapter = new OleDbDataAdapter();

        // retrieve the Select command for the Spreadsheet
        objDataAdapter.SelectCommand = ExcelConnection();

        // Create a DataSet
        DataSet objDataSet = new DataSet();
        // Populate the DataSet with the spreadsheet worksheet data
        objDataAdapter.Fill(objDataSet);

        // Bind the data to the GridView
        GridViewExcel.DataSource = objDataSet.Tables[0].DefaultView;
        GridViewExcel.DataBind();
    }

    protected void ButtonImport_Click(object sender, System.EventArgs e)
    {
        PanelUpload.Visible = false;
        PanelView.Visible = false;
        PanelImport.Visible = true;
        LabelImport.Text = "";
        // reset to blank

        // retrieve the Select Command for the worksheet data
        OleDbCommand objCommand = new OleDbCommand();
        objCommand = ExcelConnection();

        //  create a DataReader
        OleDbDataReader reader;
        reader = objCommand.ExecuteReader();

        //  create variables for the spreadsheet columns
        int ProductID = 0;
        int MakeID = 0;
        int DealerID = 0;
        string PartNumber = "";
        string Description = "";
        decimal UnitCost = 0.00M;
        decimal Postage = 0.00M;
        int QtyAvailable = 0;
        string UserName = "";
        string Make = "";

        int counter = 0;
        // used for testing your import in smaller increments

        while (reader.Read())
        {
            counter = counter + 1;
            // counter to exit early for testing...

            // set default values for loop
            ProductID = 0;
            MakeID = 0;
            DealerID = 0;

            PartNumber = GetValueFromReader(reader,"PartNumber");
            Description = GetValueFromReader(reader,"Description");

            UnitCost = GetValueFromReader(reader,"UnitCost");
            Postage = GetValueFromReader(reader, "Postage"); 

            QtyAvailable = GetValueFromReader(reader,"QtyAvailable");
            UserName = GetValueFromReader(reader,"UserName");
            Make = GetValueFromReader(reader,"Make");

            // Insert any required validations here...

            MakeID = GetMakeID(Make);
            DealerID = GetDealerID(UserName); 

            //retrieve the MakeID
            ProductID = ImportIntoProducts(PartNumber, Description, UnitCost, Postage, QtyAvailable, MakeID, DealerID);

            LabelImport.Text = LabelImport.Text + ProductID + PartNumber + " " + Description + " " + UnitCost + " " + Postage + " " + QtyAvailable + " " + UserName + " Make_id: " + MakeID + " " + Make + "<br>";
            //If counter > 2 Then ' exit early for testing, comment later...
            //    Exit While
            //End If

        }
        reader.Close();

    }

    protected string GetValueFromReader(OleDbDataReader myreader, string stringValue)
    {
        object val = myreader[stringValue];
        if (val != DBNull.Value)
            return val.ToString();
        else
            return "";
    }

    protected void ButtonUploadFile_Click(object sender, System.EventArgs e)
    {

        if (FileUploadExcel.HasFile)
        {

            try
            {
                // alter path for your project

                FileUploadExcel.SaveAs(Server.MapPath("~/ExcelImport.xls"));
                LabelUpload.Text = "Upload File Name: " +
                    FileUploadExcel.PostedFile.FileName + "<br>" +
                    "Type: " + FileUploadExcel.PostedFile.ContentType +
                    " File Size: " + FileUploadExcel.PostedFile.ContentLength +
                    " kb<br>";
            }
            catch (System.NullReferenceException ex)
            {
                LabelUpload.Text = "Error: " + ex.Message;
            }
        }
        else
        {
            LabelUpload.Text = "Please select a file to upload.";
        }

    }

    protected int GetMakeID(string MakeName)
    {

        int makeID = 0;
        try
        {
            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.MakesTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.MakesTableAdapter();
            SSSProductsDataSet.MakesDataTable SSDataTable = null;
            SSDataTable = SSAdapter.GetMakeByName(MakeName);
            // see if the category already exists in the table, if not insert it
            if (SSDataTable != null)
            {
                if (SSDataTable.Rows.Count > 0)
                {
                    if (SSDataTable[0].MakeID > 0)
                    {
                        makeID = SSDataTable[0].MakeID;
                    }
                }
            }
            if (makeID == 0)
            {
                // if it is still 0, then insert it into the table
                // retrieve the identity key category_id from the insert
                makeID = (int)SSAdapter.InsertMakeQuery(MakeName);
                // if this fails to return the proper category_id, make sure to 
                // set the InsertCategoryQuery ExecuteMode Property to Scalar
            }
            return makeID;
        }
        catch (System.NullReferenceException ex)
        {
            LabelImport.Text = LabelImport.Text + ex.Message;
            return 0;
        }

    }

    protected int GetDealerID(string UserName)
    {

        int DealerID = 0;
        try
        {
            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.DealersTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.DealersTableAdapter();
            SSSProductsDataSet.DealersDataTable SSDataTable = null;
            SSDataTable = SSAdapter.GetDealersByUserName(UserName);
            // see if the User already exists in the table, if not insert it
            if (SSDataTable != null)
            {
                if (SSDataTable.Rows.Count > 0)
                {
                    if (SSDataTable[0].DealerID > 0)
                    {
                        DealerID = SSDataTable[0].DealerID;
                    }
                }
            }
            if (DealerID == 0)
            {
                // if it is still 0, then insert it into the table
                // retrieve the identity key category_id from the insert
                DealerID = 0;
                // if this fails to return the proper category_id, make sure to 
                // set the InsertCategoryQuery ExecuteMode Property to Scalar
            }
            return DealerID;
        }
        catch (System.NullReferenceException ex)
        {
            LabelImport.Text = LabelImport.Text + ex.Message;
            return 0;
        }

    }

    protected int ImportIntoProducts(string PartNumber, string Description, decimal UnitCost, decimal Postage, int QtyAvailable, int MakeID, int DealerID)
    {

        // make sure values don't exceed column limits
        PartNumber = Left(PartNumber, 50);
        Description = Left(Description, 300);
        UnitCost = Convert.ToDecimal(UnitCost);

        int ProductID = 0;
        try
        {
            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.ProductsTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.ProductsTableAdapter();
            SSSProductsDataSet.ProductsDataTable SSDataTable = null;
            SSDataTable = SSAdapter.GetProductsByPartNumberDealer(PartNumber, DealerID);
            // see if the category already exists in the table, if not insert it
            if (SSDataTable != null)
            {
                if (SSDataTable.Rows.Count > 0)
                {
                    if (SSDataTable[0].ProductID > 0)
                    {
                        ProductID = SSDataTable[0].ProductID;
                        LabelImport.Text = LabelImport.Text + "<font color=blue>PartNumber Found, Not Imported: " + " ID: " + ProductID + " " + PartNumber + " " + Description + "" + UnitCost + "" + Postage + ".</font><br>";
                    }
                }
            }
            if (ProductID == 0)
            {
                // if it is still 0, then insert it into the table
                // retrieve the identity key ProductID from the insert
                ProductID = Convert.ToInt32(SSAdapter.InsertProductQuery(PartNumber, Description,UnitCost, Postage, QtyAvailable, MakeID, DealerID));
                LabelImport.Text = LabelImport.Text + "<font color=white>Part Number Imported: " + " ID: " + ProductID + " " + PartNumber + " " + Description + " Cost: " + UnitCost + ".</font><br>";
            }
            return ProductID;
        }
        catch (System.NullReferenceException ex)
        {
            LabelImport.Text = LabelImport.Text + "<font color=red>" + ex.Message      + "</font><br>";
            return 0;
        }

    }

    // http://www.mgbrown.com/PermaLink68.aspx
    public static string Left(string text, int length)
    {
        if (length < 0)
            throw new ArgumentOutOfRangeException("length", length, "length must be > 0");
        else if (length == 0 || text.Length == 0)
            return "";
        else if (text.Length <= length)
            return text;
        else
            return text.Substring(0, length);

    }

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:23:51.350

以下代码更改将允许您的代码运行：

```
try
{
    UnitCost = GetValueFromReader(reader,"UnitCost");
}
catch(Exception)
{
   // put a breakpoint here to find the problem using the debugger
}

try
{
    Postage = GetValueFromReader(reader, "Postage"); 
}
catch(Exception)
{
   // put a breakpoint here to find the problem using the debugger
} 
```

您真正想要做的是了解源数据是如何导致错误的。（也许您在源数据中有一个空值或非数字值。）

保留这样的代码可能（并且可能会）将数据错误引入系统的其他部分。

# sql - PostgreSQL 中字符串文字 'x' 的“列 'x' 不存在”错误

> ID：13219121
> 
> 赞同：12
> 
> 时间：2012-11-04T13:52:10.477
> 
> 标签：sql, postgresql, constraints

> **可能重复：**
> [列 'mary' 不存在](https://stackoverflow.com/questions/13196572/column-mary-does-not-exist)

我需要通过检查约束检查列可以接受的值。我需要使用检查约束，因为这是大学作业。

我使用此代码创建约束并将其添加到表中。

```
CREATE TABLE Ereignis(
  E_Id Serial PRIMARY KEY,
  Typ varchar(15),
  Zeitpunkt timestamp,
  Ort varchar(32),
  Anzahl_Pers int
);

ALTER TABLE Ereignis ADD 
CONSTRAINT typ_ch CHECK (Typ in (’Verkehrsunfall’, ’Hochwasser’, ’Sonstiges’)); 
```

这是我得到的错误：

```
 ERROR:  column "’verkehrsunfall’" does not exist 
```

当我从这个错误中得到它尝试将列 typ 与列 verkehrsunfall 进行比较时，当我尝试检查列 try 可以获得的值时，它是 ('Verkehrsunfall', 'Hochwasser', 'Sonstiges') 字符串之一。

这与我们的讲师在讲座中向我们展示的语法完全相同。我不确定是否可以将 varchars 与检查进行比较？或者我做错了什么？

以下是讲座中的示例：

```
CREATE TABLE Professoren 
(PersNr INTEGER PRIMARYKEY,
 Name VARCHAR( 3 0 ) NOT NULL ,
 Rang CHAR(2) CHECK (Rang in ('C2' ,'C3' ,'C4')) , 
 Raum INTEGER UNIQUE) ; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-04T14:02:38.423

# facebook - Facebook 身份验证，如何修复 API 错误代码：191

> ID：13219126
> 
> 赞同：1
> 
> 时间：2012-11-04T13:52:56.107
> 
> 标签：facebook, facebook-graph-api

> **可能重复：**
> [Facebook API 错误 191](https://stackoverflow.com/questions/4691782/facebook-api-error-191)

我想在我的网站上使用 facebook autentication。如果我使用真实域名在服务器上测试我的应用程序，一切正常。

但是，如果我在本地测试它。我不断收到此错误消息

http://localhost:60627/account/FacebookLogin?returnUrl=

```
Error
An error occurred with Put a straw in it. Please try again later.

API Error Code: 191
API Error Description: The specified URL is not owned by the application
Error Message: Invalid redirect_uri: Given URL is not allowed by the Application configuration. 
```

我很确定我的代码很好，因为它可以在生产服务器上运行。它必须是facebook中的设置。

我在谷歌上搜索，有很多关于这个问题的帖子。

这就是我尝试过的。

1.  沙盒模式设置为禁用。我已经这样做了。

2.  设置画布 URL 的值。我的不是 facebook 上的应用程序，我认为这对我不起作用。

3.  尝试将 localhost 添加到应用程序域，但 facebook 不会让我。

请帮我弄清楚为什么我只在本地机器上收到此消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T13:54:31.843

您需要使用在应用程序域设置中设置的域。只有该域可用于拨打电话和进行身份验证。

域设置必须是面向公众的域，“无本地主机”

本地主机在大多数情况下不起作用。

# php - php：将数组导出到 xml 麻烦

> ID：13219128
> 
> 赞同：0
> 
> 时间：2012-11-04T13:53:19.190
> 
> 标签：php, xml, arrays, simplexml

我有一个需要使用 SimpleXML 将其转换为 XML 的数组。下面的方法几乎可以完成工作，但有一个问题。它不能生成这样的结构：

```
 $xmlFields = array(  
        'rootElt' => array(
            'field1' => '',
            'field2' => '',                
            'field3' => array(                  
                'field4'  => array(
                    'income' => array(
                        'owner' => '',                            
                        'description' => '', 
                    ),
                    'income' => array(
                        'owner' => '',                            
                        'description' => '', 
                    ),
                ),
            )
        )
    ); 
```

它只写“field4”部分的最后一个“收入”，但我需要如下输出：

```
<field4>
    <income>
        <owner>....</owner>            
        <description>....</description>
    </income>
    <income>
        <owner>....</owner>            
        <description>....</description>
    </income>
</field4> 
```

有人可以帮我修复这个功能：

```
/**     
 * @param array $dataArr
 * @param SimpleXMLElement $xmlObj 
 */
private function array2xml( $dataArr, $xmlObj ) {
    foreach ( $dataArr as $key => $value ) {          
        if ( is_array($value) ) {                        
            if ( !is_numeric($key) ) {                    
                $subnode = $xmlObj->addChild( $key );                    
                self::array2xml( $value, $subnode );                    
            } else {                                        
                self::array2xml( $value, $xmlObj );      
            }
        } else {
            $xmlObj->addChild( $key, $value );                       
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:24:12.643

代码在 SimpleXML 方面看起来不错，但是您对数组在 PHP 中的工作方式存在误解：

```
'field4'  => array(
    'income' => array(
        'owner' => '',                            
        'description' => '', 
    ),
    'income' => array(
        'owner' => '',                            
        'description' => '', 
    ), 
```

这不是向`field4`数组添加两个值，而是一个。请参阅[http://php.net/array](http://php.net/array)，例如*Example #2*。键的第二个定义`income`替换了第一个。

在这种情况下，您*可能*想要做的是对数组使用不同的结构：

```
'field4'  => array(
    array('income' => array(
        'owner' => '',                            
        'description' => '', 
    )),
    array('income' => array(
        'owner' => '',                            
        'description' => '', 
    )), 
```

如果您将每个元素包装在它自己的数组元素中，您的代码甚至不会有任何特殊情况，因为每个元素都是相同的。但是，这意味着您将 - 如果您手动创建数组 - 编写更多代码来定义它。

想到的另一种选择是：

```
'field4'  => array(
    'income' => array(
        array(
            'owner' => '',                            
            'description' => '', 
        ),
        array(
            'owner' => '',                            
            'description' => '', 
        ),            
    ), 
```

这仍然不允许您拥有多个具有相同元素名称的组，但编写它可能会更容易。

对于后面的数组结构（我认为这就是您想要使用的），我创建了一个 simplexml 数组导入器/转换器（[Gist](https://gist.github.com/4012538)）。其基本形式的用法非常简单，但您可以用它做更多差异化的事情：

```
/* Example 1: Create a new SimpleXMLElement based on an array */

$import = new SimpleXMLArrayImport();

$xml = $import->importArray(['root' => '']);

/* <?xml version="1.0"?>
 * <root/>                                                    */

/* Example 2: Add an empty child element to the root          */

$new = $import->addArray($xml, ['numbers' => '']);

/* <?xml version="1.0"?>
 * <root>
 *   <numbers/>
 * </root>                                                    */

/* Example 3: Add a list of same-named elements to the root   */

$last = $import->addArray($new, ['number' => [0, 1, 42]]);

/* <?xml version="1.0"?>
 * <root>
 *     <numbers>
 *         <number>0</number>
 *         <number>1</number>
 *         <number>42</number>
 *     </numbers>
 * </root>                                                    */

/* Example 4: Set attribute of last added element             */

$last['note'] = 'The Answer to the Ultimate Question of Life, the Universe, and Everything';

/* <?xml version="1.0"?>
 * <root>
 *   <numbers>
 *     <number>0</number>
 *     <number>1</number>
 *     <number note="The Answer to the ...">42</number>
 *   </numbers>
 * </root>                                                    */

/* Example 5: Create a full document                          */

$xmlFields = array(
    'rootElt' => array(
        'field1' => '',
        'field2' => '',
        'field3' => array(
            'field4' => array(
                'income' => array(
                    array(
                        'owner'       => '',
                        'description' => '',
                    ),
                    array(
                        'owner'       => '',
                        'description' => '',
                    ),
                ),
            ),
        )
    )
);

$import = new SimpleXMLArrayImport($xmlFields);

$xml = $import->getDocument(); # The SimpleXML Root Element

/* <?xml version="1.0"?>
 * <rootElt>
 *   <field1/>
 *   <field2/>
 *   <field3>
 *     <field4>
 *       <income>
 *         <owner/>
 *         <description/>
 *       </income>
 *       <income>
 *         <owner/>
 *         <description/>
 *       </income>
 *     </field4>
 *   </field3>
 * </rootElt>                                                 */ 
```

# javascript - Google Map Autosuggest - 点击自动建议触发地理编码

> ID：13219130
> 
> 赞同：-1
> 
> 时间：2012-11-04T13:53:21.583
> 
> 标签：javascript, google-maps, google-maps-api-3

目前，当您单击位置字段中的自动建议建议时，它只会将其加载到输入框中。我想对其进行调整，因此当您单击自动建议框中的结果时，它不仅会将其值加载到输入框中，而且还会触发地理编码。不过，我无法理解我将如何做到这一点，所以我会很感激一些帮助。

这是代码：http: [//jsfiddle.net/njDvn/130/](http://jsfiddle.net/njDvn/130/)

```
<!-- Geocode -->
$(document).ready(function () {
    var GeoCoded = { done: false };
    autosuggest();
    $('#myform').on('submit', function (e) {
    if (GeoCoded.done) return true;

        e.preventDefault();
        var geocoder = new google.maps.Geocoder();
        var address = document.getElementById('location').value;

        $('#myform input[type="submit"]').attr('disabled', true);

        geocoder.geocode({
            'address': address
        },

        function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                var latLng = results[0].geometry.location;
                $('#lat').val(results[0].geometry.location.lat());
                $('#lng').val(results[0].geometry.location.lng());
                GeoCoded.done = true;
                $('#myform').submit();
            } else {
                console.log("Geocode failed: " + status);
                //enable the submit button
                $('#myform input[type="submit"]').attr('disabled', false);
            }

        });

    });

}); 
```

并且自动建议：

```
<!-- AutoSuggest -->
function autosuggest() {
    var input = document.getElementById('location');
    var options = {
        types: [],
    };
    var autocomplete = new google.maps.places.Autocomplete(input, options);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:10:04.837

您可以做的是仅使用 Places API 库并简单地侦听`place_changed`此示例中的事件：

[https://developers.google.com/maps/documentation/javascript/places#getting_place_information](https://developers.google.com/maps/documentation/javascript/places#getting_place_information)

您可以使用以下方法获取地理编码：`place.geometry.location`

# initialization - 用 Go 中的类型声明替换包装结构

> ID：13219132
> 
> 赞同：5
> 
> 时间：2012-11-04T13:53:29.523
> 
> 标签：initialization, go, type-conversion

我想`regexp`从 Go 标准库扩展，以便能够定义我自己的方法。我使用以下结构：

```
type RichRegexp struct {
    *regexp.Regexp
} 
```

正如你所看到的，这个结构只包含被包裹的`regexp.Regexp`. 所以我想知道我是否可以用这样的简单类型声明来替换它：

```
type RichRegexp regexp.Regexp 
```

但是我应该怎么写下面的函数呢？

```
func Compile(expression string) (*RichRegexp, error) {
    regex, err := regexp.Compile(expression)
    if err != nil {
        return nil, err
    }
    return &RichRegexp{regex}, nil // How to do this?
} 
```

我试图转换`regexp.Regexp`为我的`RichRegexp`，但它没有编译。返回包装基础类型的自定义类型的一般模式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T14:27:38.830

您可以使用转换，但在这种情况下，您的类型定义必须不是指针：

```
type MyRegexp *regexp.Regexp // Doesn't work 
```

这是由[规范支持的](http://golang.org/ref/spec#Method_declarations)：

> 接收器类型必须是 T 或 *T 形式，其中 T 是类型名称。T 表示的类型称为接收者基类型；**它不能是指针或接口类型**，并且必须在与方法相同的包中声明。该方法被称为绑定到基本类型，并且方法名称仅在该类型的选择器中可见。

但是，您可以这样做：

```
type MyRegexp regexp.Regexp 
```

当您现在处理值时，您可以执行以下操作：

```
x := regexp.MustCompile(".*")
y := MyRegexp(*x) 
```

你有自己的正则表达式类型。

完整代码：[http ://play.golang.org/p/OWNdA2FinN](http://play.golang.org/p/OWNdA2FinN)

作为一般模式，我会说：

*   如果它不太可能改变并且您不需要存储任意值，请使用类型转换。
*   如果您需要将值与嵌入类型一起存储，请使用`struct`.
*   如果您的代码可能会更改并且需要支持多种事物，请定义一个接口并且不要使用嵌入/类型转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T14:11:21.227

```
package main

import (
        "regexp"
)

type RichRegexp regexp.Regexp

func Compile(expression string) (*RichRegexp, error) {
        regex, err := regexp.Compile(expression)
        if err != nil {
                return nil, err
        }

        return (*RichRegexp)(regex), nil
}

func main() {
    Compile("foo")
} 
```

也在这里：[http ://play.golang.org/p/cgpi8z2CfF](http://play.golang.org/p/cgpi8z2CfF)

# r - 如何使用 R 计算二进制文件中特定区域的空间平均值？

> ID：13219133
> 
> 赞同：0
> 
> 时间：2012-11-04T13:53:52.657
> 
> 标签：r, binary

我一直在寻找很长时间来找出如何通过 R 计算空间平均值。但是，我找不到东西。我有一个二进制文件，有 720 列和 360 行，气温浮动。我想首先计算整个区域的空间平均值并计算（500-600 colu 和 200-250rows）区域的空间平均值，然后提取该区域。

```
t<- file("C:annual_Prc2000_without999_1.img","rb")
 e=readBin(t, double(), size=4,n=720*360, signed=TRUE) 
```

从答案1：

```
 mean(e)
                I got 
                NaN 
```

从答案 2：我得到

```
 spat_mean = apply(e, c(2,1), mean)
            Error in apply(e, c(2, 1), mean) : dim(X) must have a positive length 
```

让我解释一下：假设

```
 m <- matrix(rnorm(10000),4,4)
         > m
            [,1]       [,2]         [,3]       [,4]
   [1,]  0.7930132  2.1973895  0.063493345 -0.5484056
   [2,]  0.5222513  0.4331308 -0.002393336  0.1725495
   [3,]  1.7462222 -1.5701996 -2.276781240  0.5628531
   [4,] -1.2713361 -0.9349057  0.757412225  1.5118180
        > mean(m)
      [1] 0.134757
        now I want this:
          [,1]       [,2]         [,3]       [,4]
   [1,] 0.134757   0.134757     0.134757    0.134757
   [2,]  0.134757   0.134757     0.134757   0.134757
    [3,]  0.134757   0.134757       0.134757   0.134757
    [4,] 0.134757    0.134757     0.134757     0.134757 
```

我手动执行此操作，但我想通过 R 执行此操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:04:09.163

假设你有一个规则的空间网格，你可能想要这样的东西：

```
set.seed(42)
m <- matrix(rnorm(10000),100,100)

#calculate mean of all values
mean(m)

#calculate mean of region 1:10 * 1:10
mean(m[1:10,1:10]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:39:29.167

从您对另一个答案的评论中，我了解到您想要计算每个 x,y 对的平均值。为此，您可以使用`apply`. 假设您有一个具有 x,y,time 维度的多维数组，获取每个 x,y 对的平均值是这样的：

```
spat_mean = apply(multi_dim_array, c(1,2), mean) 
```

`spat_mean`现在是一个具有 x,y 维度的二维数组，给出空间均值。

# android - 如何创建未签名的应用程序并将其复制到其他手机？

> ID：13219134
> 
> 赞同：-2
> 
> 时间：2012-11-04T13:54:05.470
> 
> 标签：android, sharing

有没有办法将自己编写的应用程序从我的手机复制到另一台设备以进行测试？像在打开应用程序的情况下放入 SD 卡并从那里安装之类的东西？我知道反盗版措施会阻止这种情况，但也许有一个我不知道的调试选项？（我希望！）

编辑：如果其他人有同样的问题，我会添加我发现的内容。您可以通过右键单击项目 > Android 工具 > 导出未签名的应用程序包从 Eclipse 导出未签名的 .apk 文件。这会产生一个.apk。可以将其复制到 SD 卡，然后如下所述从文件中安装。理论上。我尝试我的应用程序时安装 SD 失败。

编辑2：**最终答案**。未签名的应用程序不会安装，因此导出未签名的应用程序包功能没有多大用处。您需要按照 SDK 说明对应用程序进行签名，这在 Eclipse 中仅表示 r-click 包并导出为 Android 应用程序并填写一些详细信息以创建密钥库文件。可以使用文件管理器从手机/平板电脑中安装签名的 .apk。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:23:43.377

您只需将 .apk 文件发送到任何设备并进行测试即可。但是，如果您已经安装了自己手机的应用程序并且无法访问.apk，您可以使用此应用程序通过蓝牙将其发送到其他手机。

[共享应用程序](https://play.google.com/store/apps/details?id=com.theronrogers.shareapps&hl=en)

请记住，您还必须通过启用以下选项来允许安装不安全的应用程序：

> 设置 > 应用程序 > 未知来源

因此您可以在除您的设备之外的任何其他设备上安装 .apk 文件。

# h2 - MVCC=true时H2数据库更新表执行耗时过长

> ID：13219136
> 
> 赞同：1
> 
> 时间：2012-11-04T13:54:21.810
> 
> 标签：h2

我有一个包含 18 列的表，其中包含一个主键和 8 个索引。如果我通常连接到 H2 DB（嵌入式模式）并更新此表的非索引字段，则在 H2 控制台中更新 50000 条记录大约需要 20 秒。但是，如果我在连接字符串中设置 MVCC=true，然后尝试更新 SAME 50000 条记录，则该表甚至超过 30 分钟都不会更新

下面的架构

```
CREATE TABLE
    TEMP
    (
        SWITCHIPADDRESS VARCHAR(16),
        ID BIGINT NOT NULL IDENTITY,
        MACADDRESS VARCHAR(14),
        USERID VARCHAR(32),
        TIMESTMP TIMESTAMP NOT NULL,
        LINKCOUNT INTEGER,
        HASLINKTOSWITCH BOOLEAN,
        LINKIPADDR VARCHAR(16),
        IFINDEX INTEGER,
        PORT INTEGER,
        SLOT INTEGER,
        VLANID INTEGER,
        IFSPEED INTEGER,
        IFADMINSTATUS INTEGER,
        PORTDUPLEXMODE INTEGER,
        UNP VARCHAR(32),
        DOMAIN INTEGER,
        DISPOSITION INTEGER,
        PRIMARY KEY (ID)
    ) 
```

索引

```
KEY `ForwardIdx` (`SwitchIPAddress`,`MACAddress`,`slot`,`port`),
KEY `ForwardSwIPIdx` (`SwitchIPAddress`),
KEY `ForwardMACIdx` (`MACAddress`),
KEY `ForwardSlotIdx` (`slot`),
KEY `ForwardPortIdx` (`port`),
KEY `ForwardVlanIdx` (`VlanID`),
KEY `UserIdIdx` (`UserId`),
KEY `UNPIdx` (`UNP`) 
```

我可以在跟踪日志文件中看到，数千个密钥首先被删除然后被添加，这可能需要一些时间。但我想知道，当正在做的事情是对非 idx 字段的简单更新时，为什么需要重新调整密钥。

即使我只有 1 个在 where 子句中使用的索引，问题仍然存在。

有人可以让我知道如何加快速度并提高更新性能。是设计删除然后添加leys>>

我们的应用程序是多线程的，我们遇到了“尝试锁定表的超时错误”问题，我在连接行中添加了 MVCC=true，现在又遇到了另一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T09:51:30.623

MVCC 模式是实验性的。此外，我们将在某个时间点用不同的引擎替换它，因此使用它确实是一个“风险自负”的解决方案。

我建议您关闭 MVCC 模式，并尝试以其他方式解决您的超时问题。

# javascript - 为 php 之类的键填充 javascript 数组简写

> ID：13219144
> 
> 赞同：5
> 
> 时间：2012-11-04T13:55:32.823
> 
> 标签：javascript, arrays, shorthand, array-key

在 Javascript 中，知道我可以设置一个数组，以便键是一个自动编号（从 0 开始）分配的数组：

```
var d_names = new Array("Sunday", "Monday", "Tuesday", 
              "Wednesday", "Thursday", "Friday", "Saturday");

// Key for Sunday is '0' 
```

如果我想分配密钥，我可以这样做：

```
 var d_names={};
    d_names[5]="Sunday";
    d_names[6]="Monday";
    d_names[7]="Tuesday";
    d_names[8]="Wednesday";
    d_names[9]="Thursday";
    d_names[10]="Friday";
    d_names[11]="Saturday";

    // Key for Sunday is '5' 
```

但是有没有像 PHP 那样分配键的速记方法？

```
var d_names = new Array(5=>"Sunday", 6=>"Monday", 7=>"Tuesday", 8=>"Wednesday", 
            9=>"Thursday", 10=>"Friday", 11=>"Saturday"); 

// Doesn't work 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-04T14:00:02.763

你想要的是一个对象：

```
var d_names = {
    5: "Sunday",
    6: "Monday"
    //...
}; 
```

然后你可以得到`"Sunday"`这样的：

```
var sunday = d_names[5]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T14:04:19.150

在 PHP 中，具有手动定义键的数组（与以 0 开头的连续整数相反）称为“关联数组” - 这就是您在上面的示例中使用 '=>' 分隔键和值的内容。

在 Javascript 中，“关联数组”在技术上是一个“对象”（尽管 JS 中的所有内容都是一个对象——尽管这是一个更详细的主题）。

JS 中“索引数组”（连续整数键）的简写是：

```
var d_names = [
  'Sunday',
  'Monday',
  // etc.
]; 
```

而 JS 中对象（如关联数组）的简写是：

```
var d_names = {
  5: 'Sunday',
  6: 'Monday',
  // etc.
}; 
```

但是，在 Javascript 中使用索引数组 -vs- 对象/关联时应该小心。Javascript 不是 PHP，“一切都是对象”这一事实在循环时会产生影响。一个显着的区别是`for(var i=0; i<arr.length; ++i){}`迭代数组*键*但`for(var x in obj) {}`迭代对象“成员”，这可能因环境/浏览器/等而异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:15:24.057

php中的以下内容：

```
echo json_encode(new Array(5=>"Sunday", 6=>"Monday", 7=>"Tuesday",...11=>"Saturday")); 
```

将产生看起来像的 JSON

```
 {"5":"Sunday","6":"Monday" , "7":"Tuesday"..."11":"Saturday"} 
```

如果通过 ajax 发送并且结果是 json 解析，它将返回一个对象：

```
 obj= { "5": "Sunday", "6": "Monday",....  "11": "Saturday"} 
```

现在您可以使用 javascript 对象表示法访问：

```
 alert( obj['5'] )/* SUnday*/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T14:24:10.713

JavaScript中[没有关联数组](http://andrewdupont.net/2006/05/18/javascript-associative-arrays-considered-harmful/)。你有两个选择：

一个简单的对象，用作（未排序！）键值映射 - 易于编写为文字，也是 JSON 语法：

```
{
    "5": "Sunday",
    "6": "Monday",
    "7": "Tuesday",
    "8": "Wednesday",
    "9": "Thursday",
    "10": "Friday",
    "11": "Saturday"    
} 
```

或者您可以使用 sparse `Array`，即没有属性 0 到 4 的值。您可以通过以下方式轻松创建它

```
var arr = new Array(5); // creates an empty array object with length 5
arr.push("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"); 
```

这相当于文字

```
[,,,,, "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T14:04:43.453

不完全是，但你可以使用一个对象

```
var obj = {

5:"Sunday",
6:"Monday",
7:"Tuesday",
8:"Wednesday",
9:"Thursday",
10:"Friday",
11:"Saturday"    
} 
```

如果想使用数组

```
var arr = [];
arr[4] = undefined;
arr.push("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-04T14:06:00.510

你可以用这个和其他一些技巧来实现

```
 var d_names = [,,,,,"Sunday", "Monday", "Tuesday", 
          "Wednesday", "Thursday", "Friday", "Saturday"];

 alert(d_names[5]); //prints "Sunday" 
```

# sse - 如何水平求和 __m256？

> ID：13219146
> 
> 赞同：17
> 
> 时间：2012-11-04T13:55:49.090
> 
> 标签：sse, vectorization, intrinsics, avx

我想`__m256`使用 AVX 指令对向量的分量进行水平求和。在 SSE 我可以使用

```
_mm_hadd_ps(xmm,xmm);
_mm_hadd_ps(xmm,xmm); 
```

在向量的第一个分量处得到结果，但这不能与 256 位版本的函数 ( `_mm256_hadd_ps`) 一起缩放。

计算`__m256`向量水平和的最佳方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-04T20:12:20.283

此版本应该最适合 Intel Sandy/Ivy Bridge 和 AMD Bulldozer 以及更高版本的 CPU。

```
// x = ( x7, x6, x5, x4, x3, x2, x1, x0 )
float sum8(__m256 x) {
    // hiQuad = ( x7, x6, x5, x4 )
    const __m128 hiQuad = _mm256_extractf128_ps(x, 1);
    // loQuad = ( x3, x2, x1, x0 )
    const __m128 loQuad = _mm256_castps256_ps128(x);
    // sumQuad = ( x3 + x7, x2 + x6, x1 + x5, x0 + x4 )
    const __m128 sumQuad = _mm_add_ps(loQuad, hiQuad);
    // loDual = ( -, -, x1 + x5, x0 + x4 )
    const __m128 loDual = sumQuad;
    // hiDual = ( -, -, x3 + x7, x2 + x6 )
    const __m128 hiDual = _mm_movehl_ps(sumQuad, sumQuad);
    // sumDual = ( -, -, x1 + x3 + x5 + x7, x0 + x2 + x4 + x6 )
    const __m128 sumDual = _mm_add_ps(loDual, hiDual);
    // lo = ( -, -, -, x0 + x2 + x4 + x6 )
    const __m128 lo = sumDual;
    // hi = ( -, -, -, x1 + x3 + x5 + x7 )
    const __m128 hi = _mm_shuffle_ps(sumDual, sumDual, 0x1);
    // sum = ( -, -, -, x0 + x1 + x2 + x3 + x4 + x5 + x6 + x7 )
    const __m128 sum = _mm_add_ss(lo, hi);
    return _mm_cvtss_f32(sum);
} 
```

`haddps`在任何 CPU 上都没有效率；您能做的最好的事情是一次洗牌（提取高半部分）和一次添加，重复直到剩下一个元素。缩小到 128 位作为第一步使 AMD 在 Zen2 之前受益，并且在任何地方都不是坏事。

有关效率的更多详细信息，请参阅[在 x86 上进行水平 SSE 向量求和的最快方法。](https://stackoverflow.com/questions/6996764/fastest-way-to-do-horizontal-sse-vector-sum-on-x86)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-04T15:58:29.873

这可以通过以下代码完成：

```
ymm2 = _mm256_permute2f128_ps(ymm , ymm , 1);
ymm = _mm256_add_ps(ymm, ymm2);
ymm = _mm256_hadd_ps(ymm, ymm);
ymm = _mm256_hadd_ps(ymm, ymm); 
```

但可能有更好的解决方案。

# php - 使用 PDO 和 MySQL 进行分页

> ID：13219148
> 
> 赞同：0
> 
> 时间：2012-11-04T13:56:01.330
> 
> 标签：php, mysql, pdo

我试图从我的数据库中返回所有记录并相应地对它们进行分页，

我有以下内容我已经设法仅从教程中争吵它似乎没有向我的浏览器输出任何内容所以我认为我的语法错误？

```
// No County Selected
        try
        {
        $per_page = '3';
        $res = $conn->prepare("SELECT * FROM directory WHERE user_active != ''");
        $rows = $res ->fetchAll();
        $total_records = count($rows);
        $pages = ceil($total_records / $per_page); 
        $page  = (isset ($_GET['page']))  ? (int) $_GET['page'] : 1 ;
        $start = ($page - 1) *  $per_page; 
        $query = $db->query("SELECT * FROM directory LIMIT $start , $per_page");
        while($row = $query->fetch(PDO::FETCH_ASSOC)){
        echo '<br>' . $row['id'];
        } ?>
        <br><br>
        <?php
        if ($pages >=  1 && $page <= $pages){
        //if ($page>1 && $page <= $pages){$previous=($page -1); echo '<a href="?page=' .$previous. '">Previous</a>';}
        for($x=1; $x<=$pages; $x++){ echo ($x == $page) ? ' <strong><a href="?page='.$x.'">'.$x.'</a></strong> ' : ' <a href="?page='.$x.'">'.$x.'</a> ';}
        //if ($page>1  && $page <= $pages){ $next=($page+1) ; echo '<a href="?page=' .$next. '">Next</a>';}
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:02:49.690

您的查询存在逻辑缺陷。您用于获取总计数的查询之间的条件不匹配：

```
SELECT * FROM directory WHERE user_active != '' 
```

以及用于获取有限（分页）行的查询：

```
SELECT * FROM directory LIMIT $start , $per_page 
```

两个查询应该共享相同的条件。此外，第一个查询应该只`COUNT`返回行，而不是全部返回：

```
SELECT COUNT(1) FROM directory WHERE user_active != '' 
```

然后，您将在第一个结果行的第一列中找到行数（计数）。

# qt - Qt中gluLookAt的头文件是什么？

> ID：13219150
> 
> 赞同：3
> 
> 时间：2012-11-04T13:56:02.853
> 
> 标签：qt, opengl

我得到了一些在 Qt 中使用 OpenGL 的代码。当我运行它时，出现如下错误：

```
C:\Users\Administrator\Desktop\NeHe6\NeHe6-build-desktop-Qt_4_8_1_for_Desktop_-_MinGW__Qt_SDK__Debug\..\NeHe6\nehewidget.cpp:54: error: 'gluLookAt' was not declared in this scope 
```

似乎缺少标题。当前的标题是：

```
#include "nehewidget.h"
#include <QtGui>
#include <qtopengl\QtOpenGL> 
```

并且“nehewidget.h”包含以下标题：

```
#include <qtopengl\QGLWidget>
#include <QTimer> 
```

谁能告诉我缺少的标题是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:43:29.447

看起来它找不到您需要的库。检查您安装的 openGL 帮助程序库。具体来说，它正在寻找 GLU。您需要将其添加到链接器选项中，例如`-lGLU`. 然后，您需要将其包含在您的代码中：

```
#include <GL/glu.h> 
```

可以在[此处找到跨多个平台链接和包含 GLU（和 GLUT）的示例](http://web.eecs.umich.edu/~sugih/courses/eecs487/glut-howto/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T10:58:15.353

在 .pro 文件的末尾添加这一行，然后将 lib 添加到项目中：

```
LIBS += -L/usr/local/lib -lGLU 
```

# path - 在 prolog 中的网格中创建路径

> ID：13219151
> 
> 赞同：1
> 
> 时间：2012-11-04T13:56:16.623
> 
> 标签：path, grid, prolog

我必须在 Prolog 的网格中创建两个给定点之间的路径。我到目前为止的代码是：

```
createPath(GridSize, BeginPosition, EndPosition, VisitedPoints, Path):-
    nextStep(BeginPosition, NextStep, GridSize),
    (
        NextStep \== EndPosition,
    ->
        nonmember(NextStep, VisitedPoints),
        add(NextStep, VisitedPoints, NewVisitedPoints),
        add(NextStep, Path, NewPath),
        createPath(GridSize, NextStep, EndPosition, NewVisitedPoints, NewPath)
    ;
        ???
    ). 
```

对我的代码的一点解释：

GridSize 只是一个整数。如果为 2，则网格为 2x2 网格。所以所有的网格都是正方形的。

BeginPosition 和 EndPosition 显示如下：pos(X,Y)。

函数 nextStep 查找给定位置的有效邻居。X 和 Y 的值必须介于 1 和网格大小之间。我已经声明了 nextStep 的 4 个不同谓词：X + 1、X - 1、Y + 1 和 Y - 1。这是代码：

```
nextStep(pos(X,Y),pos(X1,Y),GridSize):-
    X1 is X + 1,
    X1 =< GridSize.
nextStep(pos(X,Y),pos(X1,Y),_):-
    X1 is X - 1,
    X1 >= 1.
nextStep(pos(X,Y),pos(X,Y1),GridSize):-
    Y1 is Y + 1,
    Y1 =< GridSize.
nextStep(pos(X,Y),pos(X,Y1),_):-
    Y1 is Y - 1,
    Y1 >= 1. 
```

如果给定元素未出现在给定列表中，则 nonmember 返回 true。

add 将元素添加到给定列表中，并返回包含该元素的列表。

关于 VisitedPoints 的另一件事：最初 BeginPosition 和 EndPosition 存储在该列表中。例如，如果我想在 2x2 网格中查找路径，并且必须避开点 pos(2,1)，那么我将这样调用函数：

```
createPath(2, pos(1,1), pos(2,2), [pos(1,1),pos(2,2),pos(2,1)], X). 
```

我应该得到的结果应该是：

```
X = [pos(1,2)] 
```

因为这是连接 pos(1,1) 和 pos(2,2) 所需的点。我的问题是，当 NextStep == EndPosition 时如何阻止代码运行。换句话说，我必须在“？？？”的位置输入什么？? 还是我以错误的方式处理这个问题？

我对 Prolog 还是很陌生，从面向对象语言迈出这一步非常困难。

我希望有人能回答我的问题。

亲切的问候，

瓦勒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T13:11:35.370

我认为您只是将路径的“分配”放置在错误的位置

```
createPath(GridSize, BeginPosition, EndPosition, VisitedPoints, Path):-
    nextStep(BeginPosition, NextStep, GridSize),
    (
        NextStep \== EndPosition,
    ->
        nonmember(NextStep, VisitedPoints),
        add(NextStep, VisitedPoints, NewVisitedPoints),
        % add(NextStep, Path, NewPath),
        % createPath(GridSize, NextStep, EndPosition, NewVisitedPoints, NewPath)
        createPath(GridSize, NextStep, EndPosition, NewVisitedPoints, Path)
    ;
        % ???
        % bind on success the output variable, maybe add EndPosition
        Path = VisitedPoints
    ). 
```

也许这并不完全值得回答，但评论会有点“模糊”

# php - 撇号在 mysql/PHP 中不起作用

> ID：13219153
> 
> 赞同：-2
> 
> 时间：2012-11-04T13:56:36.327
> 
> 标签：php, android, mysql

> **可能重复：**
> [撇号在 PHP 中破坏了我的 mysql 查询](https://stackoverflow.com/questions/1961308/apostrophes-are-breaking-my-mysql-query-in-php)

我的 Android 应用程序正在向我的服务器发送消息（PHP 脚本） PHP 脚本正在将消息写入 MySQL。

它工作正常，但所有包含撇号 ' 的消息（例如他要去上学）都不会写入数据库。

这里的php脚本：

```
function deq($s)
{
    if($s == null)
        return null;
    return
        get_magic_quotes_gpc() ?
        stripslashes($s) : $s;
}

  if(md5(deq($_REQUEST['blub']).deq($_REQUEST['blub'])."blabla") == $_REQUEST['hash']){
    mysql_connect("localhost", "blub", "blub") or die(mysql_error());
    mysql_select_db("blub") or die(mysql_error());

   // mysql_set_charset('UTF8');  // does not work as too old php
   mysql_query("SET NAMES 'utf8'");
mysql_query("SET CHARACTER SET utf8");
mysql_query("SET COLLATION_CONNECTION = 'utf8_unicode_ci'");

    $mysqldate = gmdate( 'Y-m-d H:i:s');

    $language = (int) $_REQUEST['language'];

    $device = $_REQUEST['device'];

    $ipaddress = $_SERVER['REMOTE_ADDR'];

    mysql_query("INSERT INTO test(username, text, language, rating, checked, date)
    VALUES('".$_REQUEST['username']."', '".$_REQUEST['text']."', '".$language."', '0' , 'false', '".$mysqldate."') ")
    or die(mysql_error());

    mysql_close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T13:59:51.223

所有你需要`'`像下面这样逃跑

```
$_REQUEST['text'] = mysql_real_escape_string($_REQUEST['text']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:02:40.503

不要使用魔术引号。如果您不想使用 mysqli，请使用[mysqli_real_escape_string](http://php.net/manual/en/mysqli.real-escape-string.php)或[mysql_real_escape_string 。](http://php.net/manual/en/mysql.real-escape-string.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:03:28.977

您已经发现了[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)：输入中的撇号“脱离”了您在查询中输入的撇号。这会导致某些输入被视为查询的一部分。`mysql_real_escape_string`在查询中使用输入之前，您可以使用它来保护输入。但总的来说，对此有更好的解决方案（例如准备好的语句）。

^(顺便说一句，您正在使用 PHP 中的过时`mysql_`函数（请参阅[http://php.net/mysql_query](http://php.net/mysql_query)上的大红色警告）)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T14:20:10.597

查看上面的描述，您需要使用 mysql_real_escape_string 函数用斜杠转义输入数据

在 sql 查询中使用输入数据中的撇号会破坏 sql 查询导致 sql 注入

因此，在使用 sql 查询之前，请始终使用 mysql_real_escape_string() 函数清理输入数据

有关 mysql_real_escape_string() 函数的更多文档，请参阅下面 url 中提到的文档

[http://php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)

# .net - 通过 PowerShell 脚本将文件从本地复制到共享文件夹的最简单方法是什么？

> ID：13219155
> 
> 赞同：0
> 
> 时间：2012-11-04T13:56:42.997
> 
> 标签：.net, powershell, shared-directory

（我作为开发人员在没有非常深入的系统管理员知识的情况下问这个问题。）

我需要将我生成的一个文件（csv）复制到网络中的共享文件夹中。

**在我的 PS 脚本中实现这一目标的最简单、最安全和有保证的方法是**什么？

（将文件从一个目录复制到另一个目录的方法是否相同 - 或者为了毫无问题地完成此操作需要注意一些事项？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:09:54.403

> 将文件从一个目录复制到另一个目录是否相同

是的。

`Copy-Item`

（或其`copy`别名）。

> 或者有什么事情需要注意才能毫无问题地做到这一点？

不是特别。跨网络确实会引入额外的错误情况（例如，网络连接丢失），但这些情况会被视为失败`Copy-Item`（例如，无论是本地还是远程目标都可能没有足够的空间）。

# bash - 将查找结果传递给自定义函数

> ID：13219156
> 
> 赞同：1
> 
> 时间：2012-11-04T13:56:59.587
> 
> 标签：bash, find, exec

我写了一个bash脚本：

```
 #!/bin/bash
    function test_echo
    {
        echo $0
        echo $1
        echo $2
        echo $#
    }
    test_echo 
```

我尝试：

```
find test.sh -type f -exec test_echo '{}' \; 
```

或者

```
find . -type f -exec `./test.sh {}` \; 
```

但它不起作用。

我需要一种从文件夹中扫描文件的方法（我使用 find），并为每个文件调用一个函数（ foo_fonction() ），其中参数为文件的完整路径。

```
 find . -type f -exec foo_fonction '{}' \; 
```

以及如何在 foo_fonction() 中有参数（完整路径）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:24:14.393

Find 无法执行内部命令。

它只能执行在磁盘上找到的命令。

解释很简单：当进程`find`启动时，它无法在启动它的进程的环境中看到（`bash`在这种情况下由分叉）内部命令。

该过程`bash`在查找 $PATH 的环境中通过，但不通过它的内部。

您需要将该函数添加到 a`file.sh`中，使其可执行，在 $PATH 中添加脚本的路径 [如“。” 如果`pwd`of与 ]`bash`的位置相同，`file.sh`则在这些条件下执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:36:53.847

有两种方法可以解决这个问题：

1：您可以将函数定义作为查找文件脚本的一部分：

（我们称之为`find_stuff.sh`）

```
#!/bin/bash

test_echo() {
    echo $0
    echo $1
    echo $2
    echo $#
}

files=$(find $(pwd) -type f)
for f in $files
do
    test_echo "$f"
done 
```

解释这是做什么的：

*   如果您这样做，则会生成一个新的 shell 来运行此脚本`./find_stuff.sh`
*   首先它定义了`test_echo()`函数，
*   然后递归查找当前工作目录下的所有文件
*   请注意，由于我们`$(pwd)`将搜索目录指定为绝对路径，因此返回的结果`find`也将是绝对路径 - 如您所愿。
*   然后对于这些文件中的每一个，将其文件路径传递给`test_echo`函数

2：把函数定义放在别处，但你还是想要一个`find_stuff.sh`脚本：

```
#!/bin/bash

files=$(find $(pwd) -type f)
for f in $files
do
    ./test.sh "$f"
done 
```

`test.sh`应该是这样的：

```
#!/bin/bash

test_echo () {
    echo $0
    echo $1
    echo $2
    echo $#
}

test_echo $@ 
```

请注意最后一行`test_echo $@`- 这`$@`部分是您之前缺少的部分。

# java - JLabel 在显示 HTML 时垂直向下移动文本

> ID：13219158
> 
> 赞同：3
> 
> 时间：2012-11-04T13:57:04.657
> 
> 标签：java, html, swing, rendering, jlabel

我想了解为什么呈现 HTML 的 JLabel 会改变其输出文本的垂直位置，而呈现非 HTML 的 JLabel 不会。

*   **使用的 Java 版本**：1.6.0_37
*   **使用的 Swing 外观**：Windows ("com.sun.java.swing.plaf.windows.WindowsLookAndFeel")
*   **操作系统**：Windows 7 64 位

我没有把 SSCCE 放在一起，因为代码真的很简单。但如果有帮助，请说出来。

我宁愿使用显示行为的图像来举例说明：

![JLabel 示例，呈现纯文本和 HTML](../Images/da9695a1dfd2552ac96d5b16cba41c52.png)

我将 JPanel 作为 JLabel 周围的容器，以可视化标签的边界。为 JLabel 设置字体和文本后，

```
jLabel.getPreferredSize() 
```

方法返回呈现的纯文本或 HTML 的边界（这是我为周围的 JPanel 设置的确切大小）。您可以清楚地看到，如果呈现 HTML，整个文本会向下移动一小部分。

我想知道为什么会发生这种情况以及我可以做些什么来纠正这个位置。

一种解决方法是转换要在其上呈现文本的 Graphics2D，以补偿垂直偏移，如下所示：

```
g2d.translate( 0, -20 ); 
```

但我不知道与字体度量（例如字体大小）相关的正确 y 值。无论如何，这种解决方法也感觉“错误”。

非常感谢您的回答，非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:21:22.013

似乎如果我们使用字体为`Font`HTML 设置（family,size 等），则不会呈现为正确的.`JLabel``setFont(..)``JLabel`

这是我演示的示例（`JLabel`显示的两个都使用 HTML）：

![在此处输入图像描述](../Images/d987299fa7ae358da7937c0b8370e823.png)

一个简单的解决方法是 HTML 中的字体大小、系列等。

我们可以看到*青色*的HTML`JLabel`使用`setFont(..)`（并且被错误地渲染），而*绿色*的HTML`JLabel`使用 HTML 来设置字体并且被正确地渲染：

```
JLabel labelHtml2 = new JLabel("<html><font size=10 family='Calibri'>" + text + "</font></html>"); 
```

**测试.java：**

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Font;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class Test {

    public static Font font = new Font("Calibri", Font.PLAIN, 38);

    public Test() {
        initComponents();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel("com.sun.java.swing.plaf.windows.WindowsLookAndFeel");
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                    ex.printStackTrace();

                }
                new Test();
            }
        });
    }

    private void initComponents() {
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        String text = "Hello world";

        //this label will not render correctly due to setting font via setFont(..)
        JLabel labelHtml1 = new JLabel("<html>" + text + "</html>");
        labelHtml1.setBackground(Color.CYAN);
        labelHtml1.setOpaque(true);//so background will be painted
        labelHtml1.setFont(font);

        //this label will render correcty font is set via html
        JLabel labelHtml2 = new JLabel("<html><font size=10 family='Calibri'>" + text + "</font></html>");
        labelHtml2.setBackground(Color.GREEN);
        labelHtml2.setOpaque(true);
        //labelHtml2.setFont(font);

        frame.add(labelHtml1, BorderLayout.NORTH);
        frame.add(labelHtml2, BorderLayout.SOUTH);

        frame.pack();
        frame.setVisible(true);

    }
} 
```

# sqlite - 在项目单击时覆盖我的字符串，我无法从数据库中删除

> ID：13219160
> 
> 赞同：0
> 
> 时间：2012-11-04T13:57:14.977
> 
> 标签：sqlite

当我按“Lägg till(Add)”时，我将文本放入我的三个编辑文本框中，然后我将按确定，它应该将其保存在数据库中并将其显示在我的列表视图中，并将第一个编辑框文本作为 tite。当我按下列表视图中的某个项目时，我希望能够显示输入的文本，如果我按下“RADERA（删除）”，我希望能够从数据库和列表视图中删除它。

我的数据库适配器

```
 package com.projekt;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DBAdapter {
    static final String KEY_ROWID = "id";
    static final String KEY_PASS = "pass";
    static final String KEY_USERNAME = "user";
    static final String KEY_TITLE = "title";
    static final String TAG = "DBAdapter";
    static final String DATABASE_NAME = "DBPASS";
    static final String DATABASE_TABLE = "information";
    static final int DATABASE_VERSION = 1;
    static final String DATABASE_CREATE = "create table information (id integer primary key autoincrement, "
            + "user text not null, pass text not null, title text not null);";
    final Context context;
    DatabaseHelper DBHelper;
    SQLiteDatabase db;

    public DBAdapter(Context ctx) {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper {
        DatabaseHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            try {
                db.execSQL(DATABASE_CREATE);
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                    + newVersion + ", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS contacts");
            onCreate(db);
        }
    }

    // ---opens the database---
    public DBAdapter open() throws SQLException {
        db = DBHelper.getWritableDatabase();
        return this;
    }

    public void close() {
        DBHelper.close();
    }

    public long insertInfo(String title, String user, String pass) {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_TITLE, title);
        initialValues.put(KEY_USERNAME, user);
        initialValues.put(KEY_PASS, pass);

        return db.insert(DATABASE_TABLE, null, initialValues);
    }

    public boolean deleteInfo(long rowId) {
        return db.delete(DATABASE_TABLE, KEY_ROWID + "=" + rowId, null) > 0;
    }

    public void delete_byID(int id){
         db.delete(DATABASE_TABLE, KEY_ROWID+"="+id, null);
        }

    public Cursor getAllInfo() {
        return db.query(DATABASE_TABLE, new String[] { KEY_ROWID, KEY_USERNAME,
                KEY_PASS, KEY_TITLE }, null, null, null, null, null);
    }

    public Cursor getInfo(String title) throws SQLException {
        Cursor mCursor = db.query(true, DATABASE_TABLE, new String[] {
                KEY_ROWID, KEY_USERNAME, KEY_PASS, KEY_TITLE }, KEY_PASS + "= '" + title + "'",
                null, null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public boolean updateInfo(long rowId, String title, String user, String pass) {
        ContentValues args = new ContentValues();
        args.put(KEY_TITLE, title);
        args.put(KEY_USERNAME, user);
        args.put(KEY_PASS, pass);
        return db.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowId, null) > 0;
    }
}

my program

    package com.projekt;

import java.util.ArrayList;

//import java.util.Arrays;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
//import android.text.Editable;
import android.view.View.OnClickListener;
import android.view.View;
import android.widget.*;
import android.widget.AdapterView.OnItemClickListener;

public class layout2 extends Activity implements OnClickListener, OnItemClickListener {
    Button btn3;
    ListView lv;
    private ArrayAdapter<String> listAdapter;
    String titleInfo;
    ArrayList<String> nameList;
    EditText anvNamn;
    EditText pass;
    EditText title;
    DBAdapter db = new DBAdapter(this);
    String passInfo = ""; 
    String anv = "";
    String titleInfo2 = "";
    String visa;
    int del;
    Cursor c;
    Button btn5;

    public void onCreate(Bundle savedInstanceState) {

        //Start
        super.onCreate(savedInstanceState);
        setContentView(R.layout.program_layout);
        btn3 = (Button) findViewById(R.id.button3);
        btn3.setOnClickListener(this);
        btn5 = (Button) findViewById(R.id.button5);
        btn5.setOnClickListener(this);
        lv = (ListView) findViewById(R.id.listView1);
        nameList = new ArrayList<String>();
        listAdapter = new ArrayAdapter<String>(this, R.layout.row, nameList);
        lv.setAdapter(listAdapter);
        lv.setOnItemClickListener(this);
        getAllData();
                //Stop

    }

    private ArrayList<String> getAllData() {

        // ---get all contacts---
        db.open();
        c = db.getAllInfo();
        if (c.moveToFirst()) {
            do {
                anv = c.getString(1);
                passInfo = c.getString(2);
                titleInfo2 = c.getString(3);
                //in = new String (anv, passInfo, titleInfo2);
                //nameList.add(in);
                listAdapter.add(titleInfo2);
                //updateList();
            } while (c.moveToNext());
            //listAdapter.add(titleInfo2);
            //del = c.getInt(c.getColumnIndex(db.KEY_ROWID));
        }
        db.close();
        //listAdapter.add(titleInfo2);
        return nameList;
    }

    public void inputDialog() {
        AlertDialog.Builder alert = new AlertDialog.Builder(this);
        LinearLayout lila1 = new LinearLayout(this);
        lila1.setOrientation(1);
        anvNamn = new EditText(this);
        pass = new EditText(this);
        title = new EditText(this);
        lila1.addView(title);
        lila1.addView(anvNamn);
        lila1.addView(pass);

        title.setText("Titel");
        anvNamn.setText("Användarnamn");
        pass.setText("Lösenord");
        alert.setView(lila1);

        title.setOnClickListener(new OnClickListener(){
            public void onClick(View v) {
                title.setText("");
            }
        });

        anvNamn.setOnClickListener(new OnClickListener(){
            public void onClick(View v) {
                anvNamn.setText("");
            }
        });

        pass.setOnClickListener(new OnClickListener(){
            public void onClick(View v) {
                pass.setText("");
            }
        });

        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {

                String titleDB = title.getText().toString();
                String userDB = anvNamn.getText().toString();
                String passDB = pass.getText().toString();

                listAdapter.add(titleDB);

                db.open();  
                db.insertInfo(titleDB, userDB, passDB);
                db.close();
            }
        });

        alert.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        dialog.cancel();
                    }
                });
        alert.show();
    }

    public void onClick(View v) {
        // TODO Auto-generated method stub
        switch (v.getId()) {
        case R.id.button3:
            inputDialog();
            break;
        case R.id.button5:
            Intent nextActivity = new Intent(this, MainActivity.class);
            startActivity(nextActivity);
        }
    }

    @Override
    public void onItemClick(AdapterView<?> arg0, View arg1, final int arg2, long arg3) {
        // TODO Auto-generated method stub

        String text = nameList.get(arg2);
        //final int ar = arg2;
        Toast.makeText(this, text, Toast.LENGTH_SHORT).show();
        AlertDialog.Builder alert = new AlertDialog.Builder(this);

        alert.setTitle(titleInfo2);
        alert.setMessage("Användarnamn: " + anv + "\nLösenord: "+ passInfo);
        final String radera = listAdapter.getItem(arg2).toString();
        final long raderaPos = listAdapter.getItemId(arg2);

        alert.setNegativeButton("RADERA",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {

                        //String s = (String) arg0.getItemAtPosition(arg2);
                        db.open();
                        //db.updateInfo(arg2, anv, passInfo, titleInfo);
                        db.deleteInfo(arg2);
                        db.updateInfo(arg2, anv, passInfo, titleInfo);
                        db.close();
                        listAdapter.remove(radera); 
                    }
                });
        alert.show();
    }

}

im from sweden my string names may be confusing. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:33:21.780

永远不要使用像`arg0`, `1`,... 这样的参数名称。使用这些名称的代码是不可能理解的。

显然，在某些地方，代码使用`arg2`（适配器中视图的位置）它应该使用的位置`arg3`（项目的行 ID）。

# xml - 在 vb .NET 中读取和解析 XML

> ID：13219162
> 
> 赞同：2
> 
> 时间：2012-11-04T13:57:22.587
> 
> 标签：xml, vb.net, xml-parsing

```
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<HorseRacingCard>
  <Meeting status="Dormant" id="51894" country="South Africa" course="Vaal" date="20121101">
    <DrawAdvantage>Outside draws hold an advantage on the straight course.</DrawAdvantage>
    <AdvancedGoing>Good</AdvancedGoing>
    <Race trifecta="No" id="433065" date="20121101" time="1010+0000" raceType="Flat" trackType="Turf" handicap="No" class="" showcase="No" maxRunners="16">
      <Title>Save The Date Sansui Summer Cup 1 December Maiden Plate</Title>
      <AddedMoney currency="ZAR" amount="74996"/>
      <PenaltyValue currency="ZAR" amount="51622"/>
      <Prizes currency="ZAR">
        <Prize position="1" amount="51622"/>
        <Prize position="2" amount="14833"/>
        <Prize position="3" amount="7410"/>
      </Prizes>
      <Eligibility type="3YO plus"/>
      <Distance units="yards" value="1094" text="0m 4f 214y"/>
      <LastWinner year="2011" noRace="No corresponding race"/>
      <Horse id="1515186" name="Magic Of Rome" bred="SAF">
    <Cloth number="1"/>
    <Drawn stall="8"/>
    <FormFigures figures="598793" type="FlatSix"/>
    <LastRunDays type="Flat" days="21"/>
    <Age years="5"/>
    <Weight text="9 6" units="pounds" value="132"/>
    <Trainer id="41207" name="Chris Erasmus" nationality="SAF"/>
    <Owner name="Messrs Werner Kuhn &amp; Tjaart Strydom"/>
    <Jockey id="82671" name="J V'd Merwe"/>
    <JockeyColours filename="20121101vaa101001.png" description="Yellow, purple epaulettes, armbands and cuffs, checked cap"/>
    <Tackle type="Blinkers" count="21"/>
    <Colour type="b"/>
    <Sex type="g"/>
    <Breeding type="Sire" name="Caesour" bred="USA" yearBorn="1990"/><Breeding type="Dam" name="Magic Filly" bred="AUS"/><Breeding type="DamSire" name="Bletchley Park" bred="IRE" yearBorn="1989"/>
    <FoalDate date="20070815"/>
    <ForecastPrice>
      <Price numerator="14" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1632709" name="Enblazoned Star" bred="SAF">
    <Cloth number="2"/>
    <Drawn stall="9"/>
    <FormFigures figures="306740" type="FlatSix"/>
    <LastRunDays type="Flat" days="51"/>
    <Age years="4"/>
    <Weight text="9 6" units="pounds" value="132"/>
    <Trainer id="41348" name="Leon Erasmus" nationality="SAF"/>
    <Owner name="Mr L J &amp; Mrs M J Erasmus"/>
    <Jockey id="1144567" name="Wesley Marwing"><Allowance units="pounds" value="9"/></Jockey>
    <JockeyColours filename="20121101vaa101002.png" description="Red, blue epaulettes and sleeves, red cap"/>
    <Tackle type="Blinkers" count="14"/>
    <Colour type="ch"/>
    <Sex type="g"/>
    <Breeding type="Sire" name="Bezrin" bred="USA" yearBorn="1999"/><Breeding type="Dam" name="Starbright" bred="SAF" yearBorn="1995"/><Breeding type="DamSire" name="Fluorescent Light" bred="USA"/>
    <FoalDate date="20080926"/>
    <ForecastPrice>
      <Price numerator="14" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1736936" name="Mboweni" bred="SAF">
    <Cloth number="3"/>
    <Drawn stall="14"/>
    <FormFigures figures="742234" type="FlatSix"/>
    <LastRunDays type="Flat" days="21"/>
    <RaceHistoryStat type="BeatenFavourite" value="2"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="41348" name="Leon Erasmus" nationality="SAF"/>
    <Owner name="Mr F D A Menezes"/>
    <Jockey id="21795" name="G Lerena"/>
    <JockeyColours filename="20121101vaa101003.png" description="White, black and orange striped sleeves, orange cap"/>
    <Colour type="b"/>
    <Sex type="c"/>
    <Breeding type="Sire" name="Lecture" bred="USA" yearBorn="1996"/><Breeding type="Dam" name="Ad Valorem" bred="SAF" yearBorn="2000"/><Breeding type="DamSire" name="Caesour" bred="USA" yearBorn="1990"/>
    <FoalDate date="20090907"/>
    <ForecastPrice>
      <Price numerator="3" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1774005" name="Make My Majesty" bred="SAF">
    <Cloth number="4"/>
    <Drawn stall="4"/>
    <FormFigures figures="878755" type="FlatSix"/>
    <LastRunDays type="Flat" days="5"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="45437" name="Romeo Francis"/>
    <Owner name="Mr R Francis"/>
    <Jockey id="60482" name="Derreck David"/>
    <JockeyColours filename="20121101vaa101004.png" description="Red, black chevrons and sleeves, red armbands and cap"/>
    <Tackle type="Blinkers" count="5"/>
    <Colour type="b"/>
    <Sex type="c"/>
    <Breeding type="Sire" name="The Sheik" bred="SAF" yearBorn="1996"/><Breeding type="Dam" name="Mamzelle Magique" bred="SAF" yearBorn="1999"/><Breeding type="DamSire" name="Badger Land" bred="USA"/>
    <FoalDate date="20091102"/>
    <ForecastPrice>
      <Price numerator="14" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1806596" name="All The Ones" bred="SAF">
    <Cloth number="5"/>
    <Drawn stall="12"/>
    <FormFigures figures="54" type="FlatSix"/>
    <LastRunDays type="Flat" days="5"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="41151" name="Paul Matchett"/>
    <Owner name="Messrs P J Magee &amp; J J Van Niekerk"/>
    <Jockey id="28125" name="R Simons"/>
    <JockeyColours filename="20121101vaa101005.png" description="Red, silver stars"/>
    <Colour type="b"/>
    <Sex type="g"/>
    <Breeding type="Sire" name="Carpocrates" bred="USA" yearBorn="2003"/><Breeding type="Dam" name="Kal Sufi" bred="SAF"/><Breeding type="DamSire" name="Al Mufti" bred="USA" yearBorn="1985"/>
    <FoalDate date="20091111"/>
    <ForecastPrice>
      <Price numerator="4" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819715" name="Dis'llbetheday" bred="SAF">
    <Cloth number="6"/>
    <Drawn stall="7"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="41149" name="Roy Magner"/>
    <Owner name="Mr &amp; Mrs E Prinsloo &amp; Messes A T &amp; E T Joseph &amp; Me"/>
    <Jockey id="30057" name="G Wrogemann"/>
    <JockeyColours filename="20121101vaa101006.png" description="Oyster grey, claret collar, cuffs and cap"/>
    <Colour type="b"/>
    <Sex type="g"/>
    <Breeding type="Sire" name="Daylami" bred="IRE" yearBorn="1994"/><Breeding type="Dam" name="World Premiere" bred="SAF" yearBorn="1996"/><Breeding type="DamSire" name="Model Man" bred="SAF"/>
    <FoalDate date="20091111"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819716" name="Inews" bred="SAF">
    <Cloth number="7"/>
    <Drawn stall="11"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="41207" name="Chris Erasmus" nationality="SAF"/>
    <Owner name="Messrs Werner Kuhn &amp; Tjaart Strydom"/>
    <Jockey id="22000" name="S Veale"/>
    <JockeyColours filename="20121101vaa101007.png" description="Yellow, purple epaulettes, armbands and cuffs, checked cap"/>
    <Colour type="b"/>
    <Sex type="c"/>
    <Breeding type="Sire" name="Winter Romance" bred="UK" yearBorn="1993"/><Breeding type="Dam" name="Readallaboutit" bred="SAF"/><Breeding type="DamSire" name="Gallic League" bred="IRE"/>
    <FoalDate date="20090915"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819717" name="Magic Lad" bred="SAF">
    <Cloth number="8"/>
    <Drawn stall="10"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="100130" name="Stanley M Ferreira"/>
    <Owner name="Mr M J Nunes"/>
    <Jockey id="28344" name="Menno Malherbe"/>
    <JockeyColours filename="20121101vaa101008.png" description="Black, white maltese cross, black and white striped sleeves and cap"/>
    <Colour type="ch"/>
    <Sex type="c"/>
    <Breeding type="Sire" name="Jallad" bred="USA" yearBorn="1988"/><Breeding type="Dam" name="Magic Filly" bred="AUS"/><Breeding type="DamSire" name="Bletchley Park" bred="IRE" yearBorn="1989"/>
    <FoalDate date="20090921"/>
    <ForecastPrice>
      <Price numerator="10" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819718" name="Menacing" bred="SAF">
    <Cloth number="9"/>
    <Drawn stall="2"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="55813" name="Michael Nicholas Houdalakis" nationality="SAF"/>
    <Owner name="Mr Colin Bird"/>
    <Jockey id="28018" name="C Maujean"/>
    <JockeyColours filename="20121101vaa101009.png" description="Black, red chevron, black sleeves, red cap"/>
    <Colour type="ch"/>
    <Sex type="g"/>
    <Breeding type="Sire" name="Go Deputy" bred="USA" yearBorn="2000"/><Breeding type="Dam" name="Fearsome" bred="SAF" yearBorn="1997"/><Breeding type="DamSire" name="Centenary" bred="USA"/>
    <FoalDate date="20090906"/>
    <ForecastPrice>
      <Price numerator="14" denominator="1"/>
      </ForecastPrice>        
  </Horse>
    </Race>
    <Race trifecta="No" id="433066" date="20121101" time="1045+0000" raceType="Flat" trackType="Turf" handicap="No" class="" showcase="No" maxRunners="16">
      <Title>All To Come Maiden Plate (F &amp; M)</Title>
      <AddedMoney currency="ZAR" amount="74996"/>
      <PenaltyValue currency="ZAR" amount="51622"/>
      <Prizes currency="ZAR">
        <Prize position="1" amount="51622"/>
        <Prize position="2" amount="14833"/>
        <Prize position="3" amount="7410"/>
      </Prizes>
      <Eligibility type="3YO plus"/>
      <Distance units="yards" value="1312" text="0m 5f 212y"/>
      <LastWinner year="2011" noRace="No corresponding race"/>
      <Horse id="1702450" name="Festive Interlude" bred="SAF">
    <Cloth number="1"/>
    <Drawn stall="3"/>
    <FormFigures figures="272533" type="FlatSix"/>
    <LastRunDays type="Flat" days="5"/>
    <Age years="4"/>
    <Weight text="9 6" units="pounds" value="132"/>
    <Trainer id="15533" name="D Gray St John"/>
    <Owner name="Mr St John D Gray"/>
    <Jockey id="21795" name="G Lerena"/>
    <JockeyColours filename="20121101vaa104501.png" description="Green, white rings, quartered cap"/>
    <Tackle type="Blinkers" count="10"/>
    <Colour type="b"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Sarge" bred="SAF" yearBorn="1999"/><Breeding type="Dam" name="Festive Ways" bred="SAF" yearBorn="2000"/><Breeding type="DamSire" name="Model Man" bred="SAF"/>
    <FoalDate date="20080920"/>
    <ForecastPrice>
      <Price numerator="5" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1682817" name="Snow Go" bred="SAF">
    <Cloth number="2"/>
    <Drawn stall="12"/>
    <FormFigures figures="789850" type="FlatSix"/>
    <LastRunDays type="Flat" days="28"/>
    <Age years="4"/>
    <Weight text="9 6" units="pounds" value="132"/>
    <Trainer id="41198" name="Dominic Zaki"/>
    <Owner name="Messrs G, K &amp; M M Nassif &amp; Messrs A G Eaton, R Kay"/>
    <Jockey id="81293" name="Grant Van Niekerk"/>
    <JockeyColours filename="20121101vaa104502.png" description="Red, red and grey checked sleeves, grey cap, red star"/>
    <Colour type="ch"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Go Deputy" bred="USA" yearBorn="2000"/><Breeding type="Dam" name="Frostbite" bred="SAF" yearBorn="2002"/><Breeding type="DamSire" name="Western Winter" bred="USA" yearBorn="1900"/>
    <FoalDate date="20081003"/>
    <ForecastPrice>
      <Price numerator="14" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1756220" name="Margot On Stage" bred="SAF">
    <Cloth number="3"/>
    <Drawn stall="8"/>
    <FormFigures figures="345342" type="FlatSix"/>
    <LastRunDays type="Flat" days="16"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="41149" name="Roy Magner"/>
    <Owner name="Messers M Zackey, S Sheik &amp; D G Zackey"/>
    <Jockey id="28799" name="K Zechner"/>
    <JockeyColours filename="20121101vaa104503.png" description="Black and turquoise halved vertically, turquoise sleeves, halved cap"/>
    <Colour type="b"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Stagelight" bred="IRE" yearBorn="2002"/><Breeding type="Dam" name="Sweet Margot" bred="SAF" yearBorn="2003"/><Breeding type="DamSire" name="Saumarez" bred="UK" yearBorn="1987"/>
    <FoalDate date="20090920"/>
    <ForecastPrice>
      <Price numerator="7" denominator="4"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1736110" name="Where Eagles Dare" bred="SAF">
    <Cloth number="4"/>
    <Drawn stall="14"/>
    <FormFigures figures="5602" type="FlatSix"/>
    <LastRunDays type="Flat" days="37"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="101933" name="Paul Peter" nationality="SAF"/>
    <Owner name="Messrs G T Peter &amp; Joel Peter"/>
    <Jockey id="28071" name="Chad Little"/>
    <JockeyColours filename="20121101vaa104504.png" description="Red and white checks, striped sleeves, white cap"/>
    <Colour type="ch"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Silvano" bred="GER" yearBorn="1996"/><Breeding type="Dam" name="Aerial Dancer" bred="SAF" yearBorn="1991"/><Breeding type="DamSire" name="Dancing Champ" bred="USA"/>
    <FoalDate date="20091025"/>
    <ForecastPrice>
      <Price numerator="5" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1796892" name="Always Camille" bred="SAF">
    <Cloth number="5"/>
    <Drawn stall="16"/>
    <FormFigures figures="9" type="FlatSix"/>
    <LastRunDays type="Flat" days="37"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="46483" name="Barend Daniel Botes"/>
    <Owner name="Mr S J D Mynhardt"/>
    <Jockey id="28083" name="Francois Herholdt"/>
    <JockeyColours filename="20121101vaa104505.png" description="White, pink diamond hoop, white sleeves, pink collar and cuffs, diamonds on cap, white peak"/>
    <Colour type="b"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Caesour" bred="USA" yearBorn="1990"/><Breeding type="Dam" name="Truely Yours" bred="SAF"/><Breeding type="DamSire" name="Northern Guest" bred="USA" yearBorn="1977"/>
    <FoalDate date="20091022"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819719" name="Apple At Us" bred="SAF">
    <Cloth number="6"/>
    <Drawn stall="6"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="104350" name="Scott Kenny" nationality="SAF"/>
    <Owner name="Messrs N S W Cullingworth, G D E Kahan, W McLean &amp;"/>
    <Jockey id="41571" name="Timothy Pretorius"/>
    <JockeyColours filename="20121101vaa104506.png" description="Black, gold chevron, black sleeves, gold seams, black cap, gold diamond"/>
    <Colour type="b"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Eyeofthetiger" bred="BRZ" yearBorn="2002"/><Breeding type="Dam" name="Apple At 'em" bred="SAF" yearBorn="2001"/><Breeding type="DamSire" name="Up And At 'em" bred="UK" yearBorn="1990"/>
    <FoalDate date="20090919"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819720" name="Brave Princess" bred="SAF">
    <Cloth number="7"/>
    <Drawn stall="1"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="100130" name="Stanley M Ferreira"/>
    <Owner name="Messrs S Rudd &amp; M J Nunes"/>
    <Jockey id="28344" name="Menno Malherbe"/>
    <JockeyColours filename="20121101vaa104507.png" description="Red, pale blue v bib, red sleeves, pale blue cap"/>
    <Colour type="b"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Mogok" bred="USA"/><Breeding type="Dam" name="Bravo Bamby" bred="SAF" yearBorn="1993"/><Breeding type="DamSire" name="Dolpour" bred="FR"/>
    <FoalDate date="20090818"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819721" name="Dying Thunder" bred="SAF">
    <Cloth number="8"/>
    <Drawn stall="2"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="43065" name="Wallace Tolmay"/>
    <Owner name="Mrs H E Truter"/>
    <Jockey id="28088" name="Fanie Chambers"/>
    <JockeyColours filename="20121101vaa104508.png" description="Red, white crossed sashes, black sleeves, black and white checked cap"/>
    <Colour type="ch"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Fort Boyard" bred="SAF" yearBorn="1999"/><Breeding type="Dam" name="Wild Cat Strike" bred="SAF" yearBorn="2002"/><Breeding type="DamSire" name="Restructure" bred="IRE" yearBorn="1992"/>
    <FoalDate date="20091101"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1736913" name="Fine Victory" bred="SAF">
    <Cloth number="9"/>
    <Drawn stall="11"/>
    <FormFigures figures="6" type="FlatSix"/>
    <LastRunDays type="Flat" days="205"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="61673" name="Grant Maroun"/>
    <Owner name="Mr &amp; Mrs Mark Aboud &amp; Mesdames L J Schouten, Y J V"/>
    <Jockey id="28377" name="M Yeni"/>
    <JockeyColours filename="20121101vaa104509.png" description="Shocking pink, black diamonds, black collar and cuffs, shocking pink cap, black diamonds and peak"/>
    <Colour type="ch"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Victory Moon" bred="SAF" yearBorn="1999"/><Breeding type="Dam" name="Fine Image" bred="SAF" yearBorn="2000"/><Breeding type="DamSire" name="Jallad" bred="USA" yearBorn="1988"/>
    <FoalDate date="20090828"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1805775" name="Fortitude" bred="SAF">
    <Cloth number="10"/>
    <Drawn stall="9"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="55813" name="Michael Nicholas Houdalakis" nationality="SAF"/>
    <Owner name="Stone Hill Stud (nom: Mr H C W Rix)"/>
    <Jockey id="28018" name="C Maujean"/>
    <JockeyColours filename="20121101vaa104510.png" description="Lime green, black diamond, lime green sleeves and cap, black diamond"/>
    <Colour type="b"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Stronghold" bred="UK" yearBorn="2002"/><Breeding type="Dam" name="Mininski" bred="SNL"/><Breeding type="DamSire" name="Ahonoora" bred="UK"/>
    <FoalDate date="20091010"/>
    <ForecastPrice>
      <Price numerator="3" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1819722" name="Idle Hour" bred="SAF">
    <Cloth number="11"/>
    <Drawn stall="4"/>
    <FormFigures figures="" type="FlatSix"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="55813" name="Michael Nicholas Houdalakis" nationality="SAF"/>
    <Owner name="Stone Hill Stud (nom: Mr H C W Rix)"/>
    <Jockey id="28069" name="Francois Naude"/>
    <JockeyColours filename="20121101vaa104511.png" description="Lime green, black diamond, lime green sleeves and cap, black diamond"/>
    <Colour type="gr"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Imperial Stride" bred="UK" yearBorn="2001"/><Breeding type="Dam" name="Time Of My Life" bred="SAF" yearBorn="1994"/><Breeding type="DamSire" name="Royal Messenger" bred="SAF"/>
    <FoalDate date="20091023"/>
    <ForecastPrice>
      <Price numerator="14" denominator="1"/>
      </ForecastPrice>
  </Horse>
      <Horse id="1736926" name="Lady Jallad" bred="SAF">
    <Cloth number="12"/>
    <Drawn stall="5"/>
    <FormFigures figures="075" type="FlatSix"/>
    <LastRunDays type="Flat" days="5"/>
    <Age years="3"/>
    <Weight text="9 4" units="pounds" value="130"/>
    <Trainer id="61673" name="Grant Maroun"/>
    <Owner name="Mr G J Maroun"/>
    <Jockey id="28082" name="Marco V'Rensburg"/>
    <JockeyColours filename="20121101vaa104512.png" description="White, purple maltese cross and cap"/>
    <Colour type="ch"/>
    <Sex type="f"/>
    <Breeding type="Sire" name="Announce" bred="SAF" yearBorn="1997"/><Breeding type="Dam" name="Hey Miss Jallad" bred="SAF" yearBorn="1994"/><Breeding type="DamSire" name="Jallad" bred="USA" yearBorn="1988"/>
    <FoalDate date="20091014"/>
    <ForecastPrice>
      <Price numerator="20" denominator="1"/>
      </ForecastPrice>

  </Horse>
    </Race>
  </Meeting>
</HorseRacingCard> 
```

抱歉，XML 文件很长，但这是我正在使用的文件 :) - 它实际上在每场比赛中包含更多的比赛和马匹，但我已经将它缩短到只有几场比赛 - 我超过了发布限制。基本上是一个马匹会议，其中包含它的比赛和在每场比赛中运行的马匹。

我习惯于处理和分离 .csv 文件并确保了这一点，但事情的进展看起来我将不得不开始读取 XML 文件并相应地更新数据库。无论如何，我是 XML 和 vb .NET 的初学者（几个月的经验），可能不应该这么早就跳入如此复杂的 XML 文件 - 我将在下面发布我的代码，如果有人可以指出我在哪里出错（可能很多）的正确方向，并可能为我提供一些代码/教程来帮助我处理这个 XML 文件，那么将不胜感激。

我要做的是填充三个不同的结构；Meeting、Race 和 Horse，以及 XML 文件中的相应信息。我可以自己解决数据库更新问题，我相信（希望如此）：D

```
Public Sub ExtractionService(ByVal spfile As FileInfo)
        Dim strreader As New StreamReader(_sendpathname & spfile.Name, System.Text.Encoding.UTF8)
        Dim xmlreader As XmlTextReader = New XmlTextReader(strreader)
        xmlreader.WhitespaceHandling = WhitespaceHandling.None

        Dim xmldoc As New XmlDocument()
        xmldoc.Load(xmlreader)

        Dim xml_nodelist As XmlNodeList = xmldoc.GetElementsByTagName("/HorseRacingCard/Meeting/Race/Horse")

        Dim mStatus As String
        Dim mID As Integer
        Dim mCountry As String
        Dim mCourse As String
        Dim mDate As Integer
        Dim mDrawAdvantage As String
        Dim mAdvancedGoing As String

        For Each mxmlnode As XmlNode In xmldoc.GetElementsByTagName("Meeting")
            mStatus = mxmlnode.Attributes.ItemOf("status").InnerText
            mID = mxmlnode.Attributes.ItemOf("id").InnerText
            mCountry = mxmlnode.Attributes.ItemOf("country").InnerText
            mCourse = mxmlnode.Attributes.ItemOf("course").InnerText
            mDate = mxmlnode.Attributes.ItemOf("date").InnerText
            mDrawAdvantage = mxmlnode.SelectSingleNode("DrawAdvantage").InnerText
            mAdvancedGoing = mxmlnode.SelectSingleNode("AdvancedGoing").InnerText

            _meeting.meetingStatus = mStatus
            _meeting.meetingID = mID
            _meeting.country = mCountry
            _meeting.course = mCourse
            _meeting.meetingDate = mDate
            _meeting.drawAdvantage = mDrawAdvantage
            _meeting.advancedGoing = mAdvancedGoing
        Next

    End Sub 
```

这段代码成功地填充了我的会议结构，但我不知道我会去填充 Race 和 Horse 结构:( - 我已经学习了一些教程，但似乎无法理解它。我明白我可能在这里采取了错误的路线，并且可能需要添加/更改更多内容才能使其按我希望的方式运行。一旦突出显示了这些添加和更改，我相信我可以然后研究这些领域，并使用你们希望能提供给我的代码来尝试解决这个问题。

再次感谢所有帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:41:43.513

在这种情况下，通常最好让每个类都有自己的解析函数。层次结构中较高的类可以解析它们自己的信息并将包含的类的元素传递给相应的方法。

此外，我更喜欢 VB 为 XLINQ 类（`XElement`和朋友）提供的 API 和额外语法，而不是`XmlDocument`类，所以我将在我的示例中使用它们。总本金不变。

```
Class Meeting
    'properties, etc

    Public Shared Function Parse(element As XElement) As Meeting
        'argument error checking here

        Dim ret As New Meeting()

        ret.Status = element.@status
        ret.DrawAdvantage = element.<DrawAdvantage>.Value
        'other properties

        Dim parsedRaces = From re In element.<Race>
                          Select Race.Parse(re)
        For Each r In parsedRaces
            'add to meeting race collection
        Next

        Return ret
    End Function
End Class

Class Race
    'properties, etc

    Public Shared Function Parse(element As XElement) As Race
        'parse and return race data
    End Function
End Class 
```

通常，我不会将直接打开文件的方法放在类本身上。相反，确定文件名的任何类（窗体、窗口、视图模型、应用程序）都将负责读取和写入`XElement`文件。如果有多种存储对象的方式或存在其他分层问题，有时我什至会将`Parse`（和关联的）方法移动到不同的类。`Save`在任何一种情况下，我都会让 parse 方法创建并返回类的新实例，因此如果抛出异常，我不必担心部分变异的状态。

# iphone - SignalR：尝试加载图像时有时没有数据返回

> ID：13219166
> 
> 赞同：1
> 
> 时间：2012-11-04T13:57:50.290
> 
> 标签：iphone, objective-c, ios, signalr, long-polling

偶尔加载这样的图像时：

```
dispatch_async(dispatch_get_global_queue(0, 0), ^
{
    NSData *data = [[NSData alloc] initWithContentsOfURL:someImgUrl.jpg];
    if (data == nil)
    {
        NSLog( @"data is nil with img url:%@"  ,imgUrl);
        return;
    }
    dispatch_async(dispatch_get_main_queue(), ^
    {
        img.image = [UIImage imageWithData:data];
    });
}); 
```

我的数据为零。我用提琴手来嗅探，发现每次发生时提琴手中都没有显示请求！

它永远不会发生的唯一时间是

1.  当我不在我的应用程序中使用 SignalR 客户端时。
2.  同步下载镜像：

    ```
    NSData * imageData = [[NSData alloc] initWithContentsOfURL:someImgUrl.jpg ];
    img.image = [UIImage imageWithData: imageData]; 
    ```

我初始化 SignalR 的方式是这样的：

```
NSString *listenurl = [NSString stringWithFormat:@"%@/%@", SERVICE_URL, @"/echo"];
mConnection = [SRConnection connectionWithURL:listenurl];
[mConnection setDelegate:self];
[mConnection start:[[SRLongPollingTransport alloc] init]]; 
```

还有其他人在 ios 中使用 signalR 客户端并体验这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:36:56.350

似乎只有当 SignalR 使用相同的域名侦听您尝试从中加载图像的服务器时才会出现问题。

因此，到目前为止，我发现的（蹩脚的）解决方案是购买第二个域名并收听该域名。虽然不知道为什么会这样...

# iphone - 可达性是实时更新的（reachabilityWithHostName）吗？

> ID：13219169
> 
> 赞同：0
> 
> 时间：2012-11-04T13:58:42.360
> 
> 标签：iphone, objective-c, ios, xcode

> **可能重复：**
> [reachabilityWithHostName 示例](https://stackoverflow.com/questions/13217964/reachabilitywithhostname-example)

我有这个代码：

```
[[NSNotificationCenter defaultCenter] addObserver: self selector: @selector(reachabilityChanged:) name: kReachabilityChangedNotification object: nil];
hostReach = [Reachability reachabilityWithHostName: @"www.apple.com"];
[hostReach startNotifier];    

- (void) reachabilityChanged: (NSNotification* )note{
Reachability* curReach = [note object];
NSParameterAssert([curReach isKindOfClass: [Reachability class]]);
} 
```

我的问题是：如果 www.apple.com 不响应某些响应，会自动调用reachabilityChanged 函数吗？

# excel - 是否可以在 Excel 公式中结合 AND() 和 OR()？

> ID：13219177
> 
> 赞同：2
> 
> 时间：2012-11-04T13:59:57.413
> 
> 标签：excel, excel-formula, excel-2010

有没有一种简单的方法来组合`AND()`和`OR()`在 Excel 公式中。IE：

```
IF(OR(AND(A2="",B2=""),AND(A2="(blank)",B2="(blank)")),"BLANK","NOT BLANK") 
```

或者您是否需要使用嵌套来实现相同的最终目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T14:14:23.387

如果你是一名程序员，这个语法可能对你更有吸引力：

```
=IF((A2="")*(B2="")+(A2="(blank)")*(B2="(blank)"),"BLANK","NOT BLANK") 
```

如果您确实需要检查一些任意大小的范围，无论它是否为空（使用`"(blank)`" 作为空值的别名），您可以改用以下公式：

```
=IF(COUNTIF(CheckedRange,"(blank)")=COUNTA(CheckedRange),"BLANK","NOT BLANK") 
```

您只需添加更多 COUNTIFS 即可轻松扩展空值别名列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:08:36.500

您提供的公式有效且有效。此外，在您发布的公式中，您已经在使用嵌套（AND 嵌套在 OR 中）。

附带说明，只有 A2 和 B2 都为空白，或者 A2 和 B2 都设置为 时，公式才有效`(blank)`。对于您尝试做的事情，一个可能更好的公式是先 AND()，然后是 OR()，如下所示：

```
=IF(AND(OR(A2="", A2="(blank)"), OR(B2="", B2="(blank)")), "BLANK", "NOT BLANK") 
```

`BLANK`使用这个新公式，如果 A2 为空且 B2 为，您将得到结果`(blank)`，反之亦然。

# python - Python lxml.html XPath“属性不等于”运算符未按预期工作

> ID：13219180
> 
> 赞同：2
> 
> 时间：2012-11-04T14:00:07.720
> 
> 标签：python, html, xpath, screen-scraping, lxml

我正在尝试运行以下脚本：

```
#!python

from urllib import urlopen #urllib.request for python3
from lxml import html

url =   'http://mpk.lodz.pl/rozklady/1_11_D2D3/00d2/00d2t001.htm?r=KOZINY'+\
        '%20-%20Srebrzy%F1ska,%20Cmentarna,%20Legion%F3w,%20pl.%20Wolno%B6ci'+\
        ',%20Pomorska,%20Kili%F1skiego,%20Przybyszewskiego%20-%20LODOWA'

raw_html = urlopen(url).read()
tree = html.fromstring(raw_html) #need to .decode('windows-1250') in python3
ret = tree.xpath('//td [@class!="naglczas"]')
print ret
assert(len(ret)==1) 
```

我希望它选择一个没有将其类设置为“naglczas”的 td。相反，它返回给我一个空列表。这是为什么？我想有一些愚蠢的原因，但我尝试使用谷歌搜索并没有发现任何可以解释的原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T15:26:20.413

你的 xpath 表达式会找到

> 具有非“naglczas”类的 td 元素

你似乎想要（因为只有 3 个 td-s 有一个班级有你不想要的相同班级）

> 没有“naglczas”类的 td 元素

这些听起来可能相似，但它们是不同的。就像是

```
tree.xpath('//td[not(@class="naglczas")]') 
```

应该得到你想要的。

此外，您不需要使用 urllib 来打开 url，lxml 可以为您做到这一点，使用`lxml.html.parse()`.

# indexing - Eclipse Juno CDT 中的“预先索引的文件”

> ID：13219181
> 
> 赞同：3
> 
> 时间：2012-11-04T14:00:20.767
> 
> 标签：indexing, eclipse-cdt, eclipse-juno

正如在[这个线程](http://www.eclipse.org/forums/index.php/mv/msg/400465/945008/)中提到的，eclipse 已经删除了在 Juno 中“预先”索引文件的选项。

不幸的是，这是我项目中的一个关键特性，我正在寻找一种解决方法来添加要索引的头文件，即使它们可能没有直接包含在代码中。

有没有人熟悉这样做的方法？我可以通过在项目外部添加文件以某种方式“破解”索引器吗？将它添加到项目文件中？

# c++ - 使用字符串在 C++ 中设置控制台标题

> ID：13219182
> 
> 赞同：3
> 
> 时间：2012-11-04T14:00:20.990
> 
> 标签：c++, windows, console, java-native-interface, title

我想知道如何使用字符串作为新参数来更改 C++ 中的控制台标题。
我知道您可以使用`SetConsoleTitle`Win32 API 的功能，但它不带字符串参数。
我需要这个，因为我正在做一个带有控制台效果和命令的 Java 本机界面项目。
我正在使用 Windows，它只需要与 Windows 兼容。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-04T14:05:45.590

该[`SetConsoleTitle`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686050%28v=vs.85%29.aspx)函数*确实*接受了一个字符串参数。只是字符串的*种类*取决于是否使用UNICODE。

您必须使用例如`T`宏来确保文字字符串的格式正确（宽字符或单字节）：

```
SetConsoleTitle(T("Some title")); 
```

如果您正在使用例如`std::string`，事情会变得更复杂一些，因为您可能必须在宏之间进行转换`std::string`，`std::wstring`具体取决于`UNICODE`宏。

不必进行该转换的一种方法是始终仅`std::string`在`UNICODE`未定义时使用，或者仅`std::wstring`在已定义时使用。这可以通过`typedef`在`"stdafx.h"`头文件中添加一个来完成：

```
#ifdef UNICODE
typedef std::wstring tstring;
#else
typedef std::string tstring;
#endif 
```

如果您的问题是`SetConsoleTitle`不需要`std::string`(or `std::wstring`)，那是因为它必须与没有字符串类（或根本没有类）的 C 程序兼容。在这种情况下，您使用[`c_str`](http://en.cppreference.com/w/cpp/string/basic_string/c_str)字符串类的 来获取指向要与需要旧式 C 字符串的函数一起使用的字符串的指针：

```
tstring title = T("Some title");
SetConsoleTitle(title.c_str()); 
```

* * *

还有另一种解决方案，那就是使用函数的显式窄字符“ASCII”版本，它有一个`A`后缀：

```
SetConsoleTitleA("Some title"); 
```

当然还有一个宽字符变体，带有`W`后缀：

```
SetConsoleTitleW(L"Some title"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T14:05:28.260

```
string str(L"Console title");
SetConsoleTitle(str.c_str()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-01T21:28:54.577

评论很旧，但你可以用系统方法来做......

```
#include <iostream>

int main(){
    system("title This is a title");
} 
```

# java - 需要帮助将 awt 应用程序与 MS Access 数据库连接起来

> ID：13219191
> 
> 赞同：0
> 
> 时间：2012-11-04T14:01:40.890
> 
> 标签：java, exception, jdbc, odbc, awt

我已经开发了一个 awt 程序，现在我正在尝试使用 ODBC 桥将它连接到 MS Access 数据库。

这是代码：-

```
import java.awt.*;
import java.awt.event.*;
import java.awt.GridLayout;
import java.sql.DriverManager;
import java.sql.Connection;
import java.sql.SQLException;
import java.sql.*;

class MyClass
{
  public static void main(String args[])
  {
     Project prj=new Project();
  }
}

class Project
{
Statement s;
Connection con;
String s1,s2;
TextField t1,t2;
Button b1,b2;

Project()
{
Frame f=new Frame("Registration");
f.setLayout(new GridLayout(2,1));
f.setSize(400,400);

Panel p1=new Panel();
p1.setLayout(new FlowLayout());
t1=new TextField(15);
t2=new TextField(30);
p1.add(new Label("Roll :"));
p1.add(t1);
p1.add(new Label("Name :"));
p1.add(t2);
f.add(p1);

Panel p2=new Panel();
p2.setLayout(new FlowLayout());
s1=t1.getText();
s2=t2.getText();

try{
   try
      {Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
      }
       catch(Exception e){}
   con=DriverManager.getConnection("jdbc:odbc:testdb");
   s=con.createStatement();
   }catch(SQLException e){System.out.println("Error in connecting to database"); }

b1=new Button("Submit");
b1.addActionListener(new ActionListener(){
  public void actionPerformed(ActionEvent e){
  try{
 s.executeUpdate("insert into college(Roll,Names) values("+Integer.parseInt(s1)+","+s2+")");        
  }catch(SQLException se){
  System.out.println(se);}
}});
b2=new Button("Quit");
 b2.addActionListener(new ActionListener(){
   public void actionPerformed(ActionEvent e){System.exit(0);
   }});
p2.add(b1);
p2.add(b2);
f.add(p2);
f.pack();

    f.setVisible(true);
}
} 
```

当我在 actionListener 中使用以下语句时

```
 s.executeUpdate("insert into college(Roll,Names) values (555,'Naveen')"); 
```

这些值被插入到数据库中。但是当我使用该语句时，它现在从文本字段中获取值，

```
s.executeUpdate("insert into college(Roll,Names) values ("+Integer.parseInt(s1)+","+s2+")"); 
```

正如上面代码中使用的那样，我得到了异常，我使用 try catch 块捕获了该异常。

```
java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Too few parameters. Expected 1. 
```

sql语句肯定有问题。我错在哪里？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:05:51.983

检查 s1 里面的值，它不能是有效的 String 解析成 int

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:20:03.513

就像您在第一个插入语句中所做的那样，将您的 s2 包含在单引号（''）中。

试试这个：

```
s.executeUpdate("insert into college(Roll,Names) values ("+Integer.parseInt(s1)+",'"+s2+"')"); 
```

# mysql - 复制表格行并将它们粘贴到同一个表格中

> ID：13219197
> 
> 赞同：0
> 
> 时间：2012-11-04T14:02:47.007
> 
> 标签：mysql, database

我想从表中复制所有行并将这些行插入到这个表中，也就是说，如果表中有行

```
column
--------
A
B 
```

我想获得

```
column
--------
A
B
A
B 
```

这可能是用php（或其他语言）制作的，对吗？但我感兴趣，可以将其作为 1 个查询吗？自己的mysql可以这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:06:52.017

试试这个：

```
INSERT INTO `table` ( `column` )
    SELECT `column` FROM `table`; 
```

# php - 面向对象的搜索功能 PHP

> ID：13219198
> 
> 赞同：0
> 
> 时间：2012-11-04T14:02:47.953
> 
> 标签：php, search, mysqli

您好我正在尝试使用 OOP PHP 创建搜索功能，但是当我运行查询并输入错误数据时，我仍然得到结果。不在数据库中的结果。

我觉得我的代码中缺少一些东西，

也许我的查询是错误的我不确定，因为我是整个编程方面的新手。

欢迎任何帮助！

索引.php

```
 <?php
 include("classes/class.House.inc"); 
 ?>
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>UndergradPad</title>
 <link rel="stylesheet" type="text/css" href="css/style.css" />

 </head>
 <body>
 <div id="bodyWrapper">
 <div id"header">
 <img id="banner" alt="UnderGradPad Logo" src="images/banner.png"/>
 </div> <!-- End header -->

 <div id="search">
<h1>Find student accomodation</h1><br/>
<p> Location  </p>
    <form method="post" action="search.php" name="search" id="searchform">
    <input type="text" name="term" id="searchinput"/>
    <input type="submit" name="submit" id="searchsubmit" value=""/>
    </form>
 <div class="help">e.g. 'PO5' or 'Portsmouth'</div>
 </div> <!--End search -->
 </body>
 </html> 
```

类/class.House.inc

```
 <?php 
     include("connect/class.Database.inc");

    class House extends Database {

     public function search (){

        $query = "SELECT * FROM houses WHERE postcode like '%$term%'";

                $result = $this->mysqli->query($query);

                $num_result = $result->num_rows;    
                if($num_result > 0){
                    while($rows =$result->fetch_assoc()){               
                        $this->data[]=$rows;
                        //print_r($rows);
                    }           
                    return $this->data;
            } 
    } else {
        echo 'No Records Found';    
        }
             } }
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:42:54.527

第一点，`$term`变量没有定义。

你的意思可能是`$_POST['term']`？这是 PHP 为发布的数据定义的全局变量。

但是，我建议将变量作为函数的参数，因为它可以让您灵活地使用它而无需依赖发布数据。

例如：

```
function Search($term) {
    // now you can use $term as a local variable within the function.
} 
```

...并在您调用它的代码中，`$_POST['term']`作为参数传递。使用这样的东西：

```
$houseobject->Search($_POST['term']); 
```

其次，您需要对您的 SQL 数据进行转义，否则您将面临 SQL 注入的风险。由于您使用 MySQLi 类进行数据库访问，因此这里有两种方法：自己转义变量，或使用参数化查询并让 MySQLi 为您完成工作。

*   自己逃避：

    ```
    $query = "SELECT * FROM houses WHERE postcode like '%".$this->mysqli->real_escape_string($term)."%'";
    $result = $this->mysqli->query($query); 
    ```

*   参数化查询：

    ```
    $query = "SELECT * FROM houses WHERE postcode like ?";  // ? placeholder in query
    $stmt = $this->mysqli->prepare($query);
    $stmt->bind_param("s", "%$term%");       // insert your variable into the placeholder (still need to add % wildcards)
    $stmt->execute(); 
    ```

    有关准备好的语句的更多信息，请参阅[PHP 手册](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)。

参数化查询被认为是更安全和更现代的方法，但无论哪种方式都可以正常工作。但是，您必须做其中之一；没有它们，一旦有人在代码中输入引号，您的程序就会中断，并且很容易被用来入侵网站。

最后一点：在 SQL 中使用`%`字符串两端的 a 进行通配符搜索非常慢。如果你的数据库很小，你会没事的，但是随着它的增长，查询会越来越慢。如果您希望表中有超过几百条记录，您应该认真考虑替代搜索方法。（这里有很多选项，具体取决于您的需要，所以我现在不会介绍它们，但做一些研究，看看什么最适合您）。

希望有帮助。

# jquery - jQuery 数据表 + Twitter 引导 CSS 问题

> ID：13219200
> 
> 赞同：0
> 
> 时间：2012-11-04T14:02:50.603
> 
> 标签：jquery, css, twitter-bootstrap, datatable

我对附加了 jquery 数据表的表的样式有一个非常奇怪的问题。有人可以帮我解决这个问题吗？我把页面放在这里：

[http://aldee07.eu5.org/test/](http://aldee07.eu5.org/test/)

PS：对于上面的链接，请忽略javascript错误和脚本故障。我只关心那个页面的 CSS。

非常感谢您提前。我真的被这个问题困住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:08:01.540

您的问题源于引导 css 设置`input`为 260px 的默认宽度，这对于您的表格列来说太多了，并且导致列比脚本告诉他们的要宽

这不是 100% 的 css 解决方案，但会向您展示创建更强大的 css 规则以覆盖默认值的路径。

在所有 css 链接标签之后添加以下内容：

```
<style type="text/css">
    input { width: 85%} 
</style> 
```

您的表格将缩小以适合父级，您只需要为 header`input`标签和可能的`<TH>`padding 编写一些 css 改进。我会添加一个特殊的类来使用输入元素并从那里开始工作。bootsrap API 的大小也有不同的类`input`

演示：http: [//jsfiddle.net/PSvyz/](http://jsfiddle.net/PSvyz/)

# javascript - 我想标记我的帖子，使用 javascript 和 json

> ID：13219201
> 
> 赞同：0
> 
> 时间：2012-11-04T14:03:00.637
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, json

我正在尝试生成类似于 SO 的标记系统。我正在使用 Select2 gem。当用户最初进入新页面时，表单应该只显示他们的标签。在页面上，他们可以通过输入标签名称并用空格或逗号分隔它们来创建新标签。

我的问题是，当我提交此表单时，标签没有正确链接到 ID。我收到错误“找不到 id = 0 的标签”，或者如果我将数字 12 作为标签，“找不到 id = 12 的标签”

一个用户有多个标签；一个帖子有很多标签；一篇文章通过标签有很多标签；一个标签有很多标签；一个标签通过标签有很多帖子；一个标签属于一个用户

如何指定标签 ID 名称并且只显示标签名称？

我的标签控制器看起来像这样

```
 respond_to :json
  def index
    @tags = current_user.tags
    respond_with(@tags.map{|tag| {:id => tag.id, :name => tag.name, :user_id => tag.user_id} })
  end 
```

我的 JavaScript 看起来像这样

```
var items = [];
$.getJSON('http://localhost:3000/tags.json', function(data) {
        $.each(data, function(i, obj) {
             return items.push(obj.name);
        });
   $("#post_tag_ids").select2({
        tags: items,
        tokenSeparators: [",", " "]
        });
   }); 
```

我的表格看起来像这样

```
= semantic_form_for([@user, @post], :html => { :class => 'form-horizontal' }) do |f|
  = f.inputs do
    = f.input :summary, :label => false, :placeholder => "Title"
    = f.input :tag_ids, :as => :string, :label => false, :placeholder => "Tags", input_html: {:id => "post_tag_ids", :cols => 71}
  = f.buttons do
    .action
  = f.commit_button :button_html => { :class => "btn btn-primary" } 
```

我的 Post Controller 看起来有点像这样

```
def create
 @post = Post.new(params[:post])
 @post.user = current_user
 @post.save
 @post.tag!(params[:tag_ids], current_user.id)
end 
```

我的帖子模型有一个标签！方法

```
def tag!(tags, user)
  tags = tags.split(",").map do |tag|
    Tag.find_or_create_by_name_and_user_id(tag, user)
  end
self.tags << tags
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T04:17:51.733

解决这个问题的诀窍是在模型中设置 setter 方法。我最终使用了这样的东西：

```
 def tag_ids=(tags_string)
    self.taggings.destroy_all
    tag_names = tags_string.split(",").collect{|s| s.strip.downcase}.uniq
    tag_names.each do |tag_name|
      tag = Tag.find_or_create_by_name_and_user_id(tag_name, self.user.id)
      tagging = self.taggings.new
      tagging.tag_id = tag.id
    end
 end 
```

在控制器中，我必须将用户密钥合并到表单参数哈希中。

# php - 从子窗口或 Ajax 在新窗口中打开链接

> ID：13219202
> 
> 赞同：0
> 
> 时间：2012-11-04T14:03:00.923
> 
> 标签：php, javascript, firefox

我需要你的快速帮助。

在我的网站上，我有一个客户列表，其中包含指向其用户详细信息的链接。

我用了

```
window.open();return false; 
```

这将在新窗口中打开每个配置文件。

1.  现在在新的打开窗口中我有链接，我想在另一个新窗口中打开/

我试过了

```
window.opener.open();return false; 
```

但它在同一个窗口中打开。

如何在另一个新窗口（FF，explorer）中打开它？？

1.  我还想在我的搜索页面中将上述代码与**Ajax一起使用。**问题是，它也没有打开新窗口，因为链接位于 Ajax 中。如何在新窗口中打开来自 Ajax 的链接？

有任何想法吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:20:12.210

所以你有：（1）带有链接的页面->（2）打开带有链接的弹出窗口->（3）打开另一个弹出窗口

每个必须打开弹出窗口的链接都会调用 javascript 函数*window.open*。正如@Sushil 指出的那样，如果新窗口必须看起来像一个常规弹出窗口，请为其设置宽度和高度。

如果要使用 AJax 实现弹出窗口，请使用 jQuery。[这是一个非常好的简单弹出实现示例。](https://stackoverflow.com/questions/1328723/how-to-generate-a-simple-popup-using-jquery)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:07:59.140

提供打开的高度和宽度。这将确保新窗口始终作为弹出窗口打开。

```
window.open(url, 'name', "height=500,width=700"); return false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:08:08.267

那么您可以从您的窗口对象访问 window.parent 并调用将打开另一个窗口的函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T14:10:55.897

在打开的窗口中使用 Window.open()。

# ruby-on-rails - rails-i18n date_select 错误

> ID：13219204
> 
> 赞同：4
> 
> 时间：2012-11-04T14:03:05.917
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, rails-i18n

在我看来，我有：

`<%= f.date_select :start %>`

我收到错误消息：`can't convert Symbol into String`

我知道它与`it.date.order`规则有关，但我看到它`rails-i18n`包括它： [https ://github.com/svenfuchs/rails-i18n/blob/master/rails/locale/it.yml#L51](https://github.com/svenfuchs/rails-i18n/blob/master/rails/locale/it.yml#L51)

这里有什么问题？

完整回溯：[https ://gist.github.com/4007557](https://gist.github.com/4007557)

编辑：`I18n.t 'date.order'`在控制台中运行给我`=> [:day, :month, :year]`. 这是正确的......那为什么`date_select`不起作用？

GitHub repo 上的问题：[https ://github.com/svenfuchs/rails-i18n/issues/273](https://github.com/svenfuchs/rails-i18n/issues/273)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:51:20.657

我过去有类似的问题，如果不是相同的问题。当时我使用以下方法修复了它：

```
date:
  order: [ !ruby/symbol day, !ruby/symbol month, !ruby/symbol year ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-25T08:21:03.293

这是一个翻译问题：您必须在文件中添加`:order`规则`it.yml`或在表单中使用这一行。

```
<%= f.date_select(:start, :order => [:day, :month, :year]) %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T15:11:47.463

据我了解有关它的[rails 文档](http://api.rubyonrails.org/)`date_select`想要一个字符串。

如果`:start`是你的 I18n 的名字，你应该`<%= f.date_select t(:start) %>`按照我的记忆去做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T10:06:04.420

您不必触摸表格：这是一个翻译问题。您应该在 it.yml 文件中添加您将在此处找到的行：[https](https://github.com/svenfuchs/rails-i18n/blob/master/rails/locale) ://github.com/svenfuchs/rails-i18n/blob/master/rails/locale 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-30T19:04:08.067

如果像我的情况一样，您只使用年份并且不想为 i18n 的每种语言添加翻译只是为了选择年份，您可以添加**:locale => 'en'**仅针对该日期，如下所示：

```
<%= f.date_select :start, :start_year => 1940, :end_year => Date.today.year, :discard_day => true, :discard_month => true, :locale => 'en' %> 
```

# curl - 使用 ec2-upload-bundle 时 Amazon EC2/S3“自签名证书”SSL 失败

> ID：13219210
> 
> 赞同：2
> 
> 时间：2012-11-04T14:03:54.223
> 
> 标签：curl, amazon-web-services

尝试将 AMI 捆绑包上传到 S3 时，是否有其他人看到此错误？

```
Error talking to S3: Curl.Error(60): SSL certificate problem: self signed certificate in certificate chain 
```

昨天刚开始，周五还好好的。使用 PHP 工具包时报告了一些类似的问题 -

*   [AWS SDK for PHP 可以在不禁用 osx 上的 SSL 验证的情况下工作吗？](https://stackoverflow.com/questions/11587420/can-aws-sdk-for-php-work-without-disabling-ssl-verification-on-osx)
*   [https://forums.aws.amazon.com/thread.jspa?threadID=86186](https://forums.aws.amazon.com/thread.jspa?threadID=86186)
*   [https://forums.aws.amazon.com/thread.jspa?threadID=69108](https://forums.aws.amazon.com/thread.jspa?threadID=69108)

但我认为它们与我的问题并不完全相同。我没有在我的存储桶名称中使用点...

更多追溯：

```
Created image.part.174
Created image.part.175
Generating digests for each part...
Digests generated.
Unable to read instance meta-data for ramdisk-id
Unable to read instance meta-data for product-codes
Creating bundle manifest...
ec2-bundle-vol complete.
ERROR: Error talking to S3: Curl.Error(60): SSL certificate problem: self signed certificate in certificate chain 
```

是否有某种环境变量可以用来（临时）在运行之前为 curl 切换 SSL 验证`ec2-upload-bundle`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-08T05:51:28.380

看起来您可能是`ec2-upload-bundle`从以前使用 打包的 AMI运行的`ec2-bundle-vol`，它在创建系统映像之前剥离了系统上的许多不同文件（以避免敏感信息进入映像）。来自[AWS 文档](http://docs.aws.amazon.com/AWSEC2/latest/CommandLineReference/CLTRG-ami-bundle-vol.html)：

> 默认情况下，捆绑过程会排除可能包含敏感信息的文件。这些文件包括`*.sw`, `*.swo`, `*.swp`, `*.pem`, *.priv `,`*id_rsa* `,`*id_dsa* ``*.gpg`, `*.jks`, `*/.ssh/authorized_keys`, 和`*/.bash_history`. 要包含所有这些文件，请使用该`--no-filter`选项。要包含其中一些文件，请使用`--include option`.

在这种情况下，您系统上的根证书数据库似乎被搞砸了。在 Ubuntu（可能还有其他发行版）上，运行此命令会在系统上重新加载根证书，从而解决问题：

```
update-ca-certificates 
```

# mysql - 使用 group by 加速 mysql 查询

> ID：13219212
> 
> 赞同：1
> 
> 时间：2012-11-04T14:04:05.277
> 
> 标签：mysql

我有一个 MySQL 查询：

```
SELECT date(FROM_UNIXTIME(time)) as date,  
count(view) as views  
FROM ('table_1')  
WHERE 'address' = 1  
GROUP BY date(FROM_UNIXTIME(time)) 
```

在哪里

`view`：自动增量和主键，（int（11））
`address`：索引，（int（11））
`time`：索引，（int（11））

表的总行数为：`270k`

这个查询执行缓慢，在 mysql-slow.log 我得到：

> Query_time：1.839096
> Lock_time：0.000042
> Rows_sent：155
> Rows_examined：286435

使用`EXPLAIN`如下所示：

```
id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE table_1 ref address address 5 const 139138 使用 where；使用临时的；使用文件排序

```

如何改进此查询以加快执行速度？如果我在 PHP 中更改日期可能会更好？但我认为在 PHP 中将日期作为时间戳，然后转换为人类可读，并使“分组依据”比 MySQL 中的一个查询花费更多时间。

也许有人知道如何使这个查询更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:10:29.897

当您将函数 date() 和 FROM_UNIXTIME() 应用于组中的时间时，您会杀死您在该字段上可能拥有的任何索引优势。

如果您需要按天分组，添加日期列将是我可以加快速度的唯一方法。没有它，您将需要减少您尝试分组的整体设置。您可以添加开始/结束日期来限制日期范围。这将减少被转换和分组的日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:11:22.993

您应该考虑向`DATE`您的表中添加一个额外的列并为其编制索引。

# android - file.delete() 错误 30

> ID：13219225
> 
> 赞同：0
> 
> 时间：2012-11-04T14:05:30.677
> 
> 标签：android, file, text-files, delete-file

我尝试删除我创建的文本文件：

```
FileOutputStream fOut = openFileOutput("game.txt", MODE_PRIVATE); 
```

通过使用

```
File file = new File(filename);
        if (!file.exists())
        {
        Log.d(TAG,"gonna delete game.txt");
        file.delete();
        } 
```

但不断收到错误消息：

> 无法取消链接“/game.txt”：只读文件系统 (errno=30)

你知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T08:20:28.110

现在它运作良好。文件名不包含文件的完整路径（尽管它在根目录中）它必须具有完整路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:09:59.910

```
File file = new File(filename);

if (file.exists()){
    Log.d(TAG,"gonna delete game.txt");  
     file.delete(); } 
```

试试这个。

# architecture - cqrs 没有事件溯源和 LMAX 风格的单线程设计审查

> ID：13219226
> 
> 赞同：2
> 
> 时间：2012-11-04T14:05:34.670
> 
> 标签：architecture, cqrs

只是回顾一下我的计划，看看它是否可行。

我正在使用 RDBMS 并计划在没有事件源的情况下使用 CQRS。我认为事件溯源对于第一次尝试来说有点先进，我不得不使用 RDBMS。

基于任务的 UI 由许多命令组成，其中大多数不需要响应。

建筑基本上是

```
 /---- RDBMS ( EF ) 
     IO  ops                 \
            |                 \
  Single threaded Domains   Fascade(DTO) Queries
            |                /
  Event/Command Dispatcher  /
             \             /
                MVC client 
```

单线程域不相互通信，它们通过中断器（基本上是环形缓冲区）与外界通信。

命令调度程序将外部事件和命令复制到磁盘并在崩溃时重新加载它们。完成被明确标记（通过 IO Ops）。

命令基本上将被持久化（具有命令的事务范围），IO Ops 层将抓取所有事件并处理它们，并在 1 个事务中标记命令完成。（请注意，该命令是通过日志服务而不是域持久化的，但它与 IO opps 对话，后者将其与命令的工作相匹配）。如果命令失败并且其标记为持续存在（并非所有都将持续存在），则可以重播它。（它只有在拥有命令并收到 DoTransation 消息时才会保留命令。）

命令调度程序通过中断器连接到域。

问题

1.  我应该将整个域加载到内存中（大约 300 - 500 Meg）并运行吗？显然域只会在数据库更新后更新。

2.  是否可以将外部事件混合回命令调度程序（因此它被单线程拾取并处理）。例如，事件变成命令。

3.  对域和用户代码进行编码看起来很简单（而且我得到了一个很好的丰富域），至少从我正在研究的原型来看是这样。是吗？

4.  当域进行 IO 时，它们会向破坏者发送消息，并且可以

    *   指定命令 guid，命令与事务匹配
    *   假设完成（射击和祈祷）
    *   提供一个回调命令，该命令传递给命令调度程序，然后重新出现在域中。创建 IO 消息后，系统可以继续执行当前命令或完成它并​​接收下一个命令。
        这够好吗？
5.  系统运行在一个进程和共享内存中，但域资源只能由自己和1个线程访问。这个可以吗？

这是一个实验性的混合网格。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T00:51:34.410

首先，这种架构相当复杂。仔细检查项目的预计寿命是否值得在架构上的所有初始投资。底线：这个项目会在 5 年或 10 年内支付账单吗？客户会允许您在架构上花费数月时间而不提供业务价值吗？

**问题**

你没有提到你的命令调度程序是什么主机。不管这块是什么，它很可能是您应用程序的瓶颈。除非它从非常高性能的队列（例如 ZeroMQ）中提取消息，否则我认为您不需要环形缓冲区。队列在大多数情况下都可以正常工作，而且要简单得多。

**你的问题**

我假设 IO Ops 是指事件/事件处理程序。可能还有其他我没有注意到的细微差别。

1.  我怀疑这对于 Web 应用程序是否真的有意义。如果您的数据库是性能瓶颈，则将域加载到内存中是有益的。根据您的应用程序的性能配置文件，它可能不是，管理所有这些线程的努力可能会浪费开发人员的时间。（主要是因为您必须确保在应用程序关闭时停止线程，否则应用程序将永远不会关闭。）关于在更新数据库后更新域的部分对我来说没有意义。您只想在启动时加载域。保存域的状态更改只是为了在下次启动时重新加载它。我认为您需要先更改域的状态，然后才能将其持久化。此外，如果数据库是那么大的瓶颈，我可能会异步保存状态。

2.  我认为您在这里缺少一些步骤。您可能想要接收事件并将其作为命令发送的地方听起来像是流程管理器（或 Saga，如果您愿意）应该去的地方。很少有业务流程像总是将事件转换为命令那样简单。例如，当后续命令无法完成时会发生什么？或者在发出命令之前需要发生多个事件时。（例如 OrderPlaced 和 PaymentReceived 必须在发送 ShipOrder 之前发生）

3.  域的难点通常是找出最合适的建模方式。如果您的域模型不适合实际域，那么代码会变得更加笨拙和复杂。除此之外，这实际上取决于您的域。如果您对微积分求解器进行编程，那么您可能会喜欢它。但是通常，一旦理解了业务逻辑，就可以将其编成合理的代码。

4.  我真的不确定您要对事务位做什么。您是否尝试将多个命令包装到一个事务中？这可能代表可以更好地建模域或您正在进行批处理的地方。由于希望没有那么多命令被批处理，所以总是使用一个似乎是一种浪费。如果您的所有操作都是批处理的，并且批处理中的每个操作只是设置单个字段，那么您真的错过了使用 DDD 和基于任务的 UI 的意义。

5.  另见#1。如果需要这种级别的性能，这应该没问题。您的域很可能作为接收命令的 MVC 应用程序上的单例托管在内存中。我假设您在访问共享内存时使用了适当的锁定技术。请注意，[此站点](http://www.albahari.com/threading/)是此类主题的绝佳资源。特别是，不要被`volatile`关键字所迷惑！

请记住，一切都是权衡。不要浪费大量时间开发对您的应用程序没有真正好处的架构。

# java - MongoDB使用大量内存

> ID：13219234
> 
> 赞同：2
> 
> 时间：2012-11-04T14:06:01.547
> 
> 标签：java, mongodb, memory-management, morphia

我正在尝试将 mysql 表迁移到 mongodb。我的表有 600 万个条目。我使用带有 morphia 的 java。当我节省大约 120 万时，我的内存几乎全部耗尽。

我读过 mongo 将数据存储在内存中，然后保存在磁盘中。是否可以发送诸如提交之类的内容以释放一些内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T20:15:21.860

1）在持久性方面，可以告诉MongoDB java驱动（Morphia使用的是哪个），使用哪种策略，见[https://github.com/mongodb/mongo-java-driver/blob/master/src/main /com/mongodb/WriteConcern.java#L53](https://github.com/mongodb/mongo-java-driver/blob/master/src/main/com/mongodb/WriteConcern.java#L53)。这只是速度之间的权衡：（`NONE`甚至连接问题都不会导致错误）到`FSYNC_SAFE`（数据肯定会写入磁盘）。有关内部详细信息，请查看[http://www.kchodorow.com/blog/2012/10/04/how-mongodbs-journaling-works/](http://www.kchodorow.com/blog/2012/10/04/how-mongodbs-journaling-works/)

2）您的整个数据都映射到内存（这就是 32 位版本的大小限制为 2GB 的原因），但是它仅在需要时才实际加载。MongoDB 使用 mmap 将其留给操作系统。因此，只要有更多可用的 RAM，MongoDB 就会很乐意将它需要的所有数据加载到 RAM 中以非常快速地进行查询。如果没有更多可用内存，则由操作系统来换掉旧的东西。这有一个很好的效果，即使您重新启动 MongoDB 进程，您的数据也会保留在内存中；仅当您重新启动服务器本身时，才必须再次从磁盘获取数据。我认为不利的一面是，与操作系统相比，数据库进程可能对首先应该换出的内容有更好的理解。我没有在 Windows 上使用 MongoDB 并且没有 在 Mac 或 Linux 上（尚未）看到该消息，但操作系统应该为您处理该消息（并根据需要自动换出信息片段）。您是否尝试将驱动程序设置为`JOURNAL_SAFE`（应该是数据安全和速度之间的一个很好的折衷方案）？在这种情况下，即使 MongoDB 进程终止，也不会丢失任何数据。

3) 一般来说，MongoDB 是为了使用尽可能多的可用内存而构建的，但您可以使用[http://captaincodeman.com/2011/02/27/limit-mongodb-memory-use-windows/](http://captaincodeman.com/2011/02/27/limit-mongodb-memory-use-windows/)来限制它-我没有测试过，因为我们正在使用（虚拟）Linux服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:59:37.780

如果你只是想释放一些mongodb使用的内存，在你的数据被处理并且mongod空闲之后，你可以运行这个命令

```
use admin
db.runCommand({closeAllDatabases: 1}) 
```

然后，你会看到输出的mapped,vsize,res`mongostat`下降了很多。

我试过了，它有效。希望能帮到你，^_^

# python - 便携式 python 3.x 和 pygame

> ID：13219237
> 
> 赞同：0
> 
> 时间：2012-11-04T14:06:26.737
> 
> 标签：python, python-3.x, pygame, portable-executable

我正在寻找可移植 python 的版本（自定义/测试版？），它是 python 3.x，包括 pygame。我知道 pygame 还没有完全转换为 3.x，但是对于我所需要的，它可以完美地工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T01:02:03.623

安装 Pygame，然后将你的整个 Python 文件夹放到你想要的位置。

如果您的意思是希望能够`python (filename).py`在终端上使用，那么您将不得不更改`PATH`终端中的变量，或者将 shebang 行添加`#!usr\bin\python`到您的程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:10:01.857

也许我还没有完全理解你在追求什么。不过，让我试着回答：

[Python 3.3](http://www.python.org/download/)的发布现在在标准库中包含了 VirtualEnv，现在称为[venv](http://docs.python.org/3/library/venv.html)。

所以在命令行中你可以输入

```
/path/to/python3.3/bin/pyvenv /path/to/new/virtual/environment 
```

创建一个包含指向您的 python 3.3 安装链接的文件夹。这个新文件夹可以很容易地安装任何[PyPi 包](http://pypi.python.org/pypi)，例如：

```
cd /path/to/new/virtual/environment
./bin/pip install adventure 
```

安装[冒险](http://pypi.python.org/pypi/adventure/1.3)。

然后，您可能希望按照[PyGames 文档安装 Py3 分支](http://www.pygame.org/wiki/python3porting)

然后，就像用户 beary605 已经回答一样，您可以通过 tar'ing、rsync'ing 或您设想的任何分发方式捆绑整个 Python 虚拟环境。

还有一个较早的问题涉及[Mac OS 上的 Python 3 和 Pygame 兼容性](https://stackoverflow.com/questions/12362449/pygame-for-python-3-on-osx-mountain-lion)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-10T05:49:27.907

据我所知，没有什么比得上您正在寻找的可用的，但是通过一点 DIY，您可能能够更改 Portable Python 的一个版本（它不再更新，但有一个 Python 3 的版本）。通过这样说，我假设您想从闪存驱动器操作它。根据您正在运行的 Windows，这些步骤可能会有所不同，但我猜它们会类似于此线程中的步骤：[pygame not working with portable python](https://stackoverflow.com/questions/13119671/pygame-not-working-with-portable-python)

# java - 为什么这会在旋转时泄漏？

> ID：13219257
> 
> 赞同：4
> 
> 时间：2012-11-04T14:09:01.507
> 
> 标签：java, android, memory-leaks

我遇到了以下内存泄漏示例

```
package com.justinschultz.android;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.os.Bundle;

public class LeakedDialogActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setIcon(android.R.drawable.ic_dialog_alert);
        builder.setMessage("This dialog leaks!").setTitle("Leaky Dialog").setCancelable(false).setPositiveButton("Ok", new DialogInterface.OnClickListener()
        {
            public void onClick(DialogInterface dialog, int which) {}
        });

        AlertDialog alert = builder.create();
        alert.show();
    }
} 
```

我不明白为什么它会在旋转时泄漏。我了解，当对话框仍在屏幕上时会创建一个新活动（包含对旧活动的引用）。假设您关闭对话框并再次旋转。对最旧活动的引用不应该消失，从而允许回收内存吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:45:54.493

AlertDialogs（如果在 Fragments 之外使用）应通过`onCreateDialog()`/实例化`showDialog()`以避免泄漏。

此实现已弃用，应替换为[DialogFragment](http://developer.android.com/reference/android/app/DialogFragment.html)，但对您有用：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    showDialog(YOUR_DIALOG_ID);
}

@Override
protected Dialog onCreateDialog(int id) {
    switch(id) {
    case YOUR_DIALOG_ID:
        return new AlertDialog.Builder(LeakedDialogActivity.this)
        .setIcon(android.R.drawable.ic_dialog_alert)
        .setMessage("This dialog leaks!")
        .setTitle("Leaky Dialog")
        .setCancelable(false)
        .setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {}
        })
        .create();
    }
    return super.onCreateDialog(id);
} 
```

* * *

**添加**

当您不创建对话框时，`onCreateDialog`它基本上不附加到（或拥有）活动，因此，它是生命周期。当 Activity 被销毁或重新创建时，Dialog 会维护对它的引用。

理论上，如果您在（我相信）中使用`setOwnerActivity()`和关闭，对话框不应该泄漏。`onPause()`

就一般泄漏而言，我不确定您是否必须担心这个*问题。*对话框是一种特殊情况。

# sql - 确定仅存在于两个表之一或两个表中的值

> ID：13219260
> 
> 赞同：2
> 
> 时间：2012-11-04T14:09:22.527
> 
> 标签：sql, sql-server-2008

我在 SQL Server 2008 数据库中有两个表，我想在其中查找：

*   两个表中都存在值（两个表中都存在所有列）
*   第一个表中存在但第二个表中不存在的值
*   第二个表中存在但第一个表中没有的值

代码：

```
CREATE TABLE #_temp
(ATM INT, Fault INT)

CREATE TABLE #_temp1
(ATM INT, Fault INT)

INSERT INTO #_temp  VALUES (10,101), (11,101), (12,101), (12,101), (10,105), (13,101)
INSERT INTO #_temp1 VALUES (10,102), (11,101), (12,103), (12,100), (10,105), (13,101)

/* My Try

SELECT * FROM #_temp t RIGHT JOIN #_temp1 t1 ON t.ATM=t1.ATM AND t.Fault=t.Fault AND t.ATM IS NULL AND t.Fault IS NULL

SELECT * FROM #_temp t JOIN #_temp1 t1 ON t.ATM=t1.ATM AND t.Fault=t.Fault

*/

DROP Table #_temp
DROP Table #_temp1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:22:47.030

要查找存在于一个表中而不存在于另一个表中的值，您应该使用 where 子句来确定空值：

```
Create Table #_temp
(ATM Int,Fault Int)

Create Table #_temp1
(ATM Int,Fault Int)

Insert Into #_temp Values(10,101),(11,101),(12,101),(12,101),(10,105),(13,101)
Insert Into #_temp1 Values(10,102),(11,101),(12,103),(12,100),(10,105),(13,101)

--Values Present in both Table

SELECT t.* 
FROM #temp t
    INNER JOIN #_temp1 t1
        ON t.[ATM Int] = t1.[ATM Int]
        AND t.[Fault Int] = t1.[Fault Int]

--Values Present in First Table But not in Second

SELECT t.* 
FROM #temp t
    LEFT JOIN #_temp1 t1
        ON t.[ATM Int] = t1.[ATM Int]
        AND t.[Fault Int] = t1.[Fault Int]
WHERE t1.[ATM Int] IS NULL

--Values Present in Second Table But not in First

SELECT t.* 
FROM #_temp1 t
    LEFT JOIN #temp t1
        ON t.[ATM Int] = t1.[ATM Int]
        AND t.[Fault Int] = t1.[Fault Int]
WHERE t1.[ATM Int] IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:18:24.853

```
Insert Into #_temp Values(10,101),(11,101),(12,101),(12,101),(10,105),(13,101)
Insert Into #_temp1 Values(10,102),(11,101),(12,103),(12,100),(10,105),(13,101)

Select t.* From #_temp t LEFT join #_temp1 t1 on t.ATM=t1.ATM and t.Fault is null
UNION
Select t.* From #_temp1 t  left join #_temp t1 on t.ATM=t1.ATM and t.Fault is NULL

Drop Table #_temp
Drop Table #_temp1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:16:01.243

将列重命名为表应该可以工作：

```
SELECT A.ATM AS ATM1, A.FAULT AS FAULT1, B.ATM AS ATM2, B.FAULT AS FAULT2
FROM #_temp as A, #_temp1 as B
ON A.ATM = BUT.ATM

SELECT * FROM #_temp

SELECT * FROM #_temp1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T14:32:39.203

没有确切的舒尔你在搜索什么，另一个

```
Create Table #_temp
(ATM Int,Fault Int)

Create Table #_temp1
(ATM Int,Fault Int)

Insert Into #_temp Values(10,101),(11,101),(12,101),(12,101),(10,105),(13,101)
Insert Into #_temp1 Values(10,102),(11,101),(12,103),(12,100),(10,105),(13,101)

Select a.*,t.ATM as tATM,t.Fault as tFault,t1.ATM as t1ATM,t1.Fault as t1Fault from
(
Select t.* From #_temp t 
UNION
Select t.* From #_temp1 t 
) a
LEFT join #_temp t on t.ATM=a.ATM and T.Fault = a.Fault
LEFT join #_temp1 t1 on t1.ATM=a.ATM and T1.Fault = a.Fault 

Drop Table #_temp
Drop Table #_temp1 
```

# machine-learning - 电子邮件中垃圾邮件检测的神经网络方法

> ID：13219261
> 
> 赞同：0
> 
> 时间：2012-11-04T14:09:24.223
> 
> 标签：machine-learning, neural-network, spam-prevention

我正在使用神经网络构建垃圾邮件检测系统。我无法理解如何继续我目前的工作。

我有 - 未读邮件被标记为已读并使用 tf-idf 加权转换为邮件向量。所以基本上，我的电子邮件看起来像

```
Email : (Word1,Score1),(Word2,Score2)... 
```

完成后（解析、词干提取、停用词删除和 tf-idf 转换）。我已经阅读了通过反向传播训练的反馈网络，这似乎是最常用的方法。基本上，我如何进一步减少我拥有的向量的维数以及如何将其作为输入提供。此外，隐藏层的行为如何以及隐藏层神经元的数量如何影响神经网络的性能。另外，特征向量与我所拥有的有何不同？如何形成特征向量？

谢谢。期待一些清晰。

# ios - Facebook iOS SDK 3.1 认证后不返回应用

> ID：13219263
> 
> 赞同：0
> 
> 时间：2012-11-04T14:09:26.743
> 
> 标签：ios, facebook

我正在使用 Facebook iOS SDK 3.1，它在身份验证后不会返回到我的应用程序。我确定已经输入了捆绑 ID，并且从昨晚开始就启用了登录和深层链接。有人知道可能的原因或有同样的问题吗？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:37:12.667

确保您添加了这两个功能。还要检查您的产品名称是否与您的 Facebook 应用名称匹配。在 plist 中使用“URL 类型”。

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
    Facebook *fb = [self sharedFacebook];    
return [fb handleOpenURL:url];
}

- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    Facebook *fb = [self sharedFacebook];    
    return [fb handleOpenURL:url];
} 
```

# asynchronous - 执行几个 mongoose 查询：如何改用 Promise？

> ID：13219266
> 
> 赞同：1
> 
> 时间：2012-11-04T14:09:35.143
> 
> 标签：asynchronous, coffeescript, express, mongoose, promise

我有以下代码，我想避免嵌套回调：

```
app.get '/performers', (req, res) ->
    conductor = require('models/conductor').init().model
    soloist = require('models/soloist').init().model
    orchestra = require('models/orchestra').init().model
    chamber = require('models/chamber').init().model
    performers = {}
    conductor.find {}, (err, result) ->
        performers.conductor = result
        soloist.find {}, (err, result) ->
            performers.soloist = result
            orchestra.find {}, (err, result) ->
                performers.orchestra = result
                chamber.find {}, (err, result) ->
                    performers.chamber = result
                    res.json performers 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T14:18:48.230

我发现[`async`](https://github.com/caolan/async)图书馆是一个比这类事情的承诺更干净的解决方案。对于这种特定情况，[`async.parallel`](https://github.com/caolan/async#parallel)效果很好。

我对coffeescript不太熟悉，但它看起来像这样：

```
performers = {}
async.parallel [
    (callback) ->
        conductor.find {}, (err, result) ->
            performers.conductor = result
            callback err
    (callback) ->
        soloist.find {}, (err, result) ->
            performers.soloist = result
            callback err
    (callback) ->
        orchestra.find {}, (err, result) ->
            performers.orchestra = result
            callback err
    (callback) ->
        chamber.find {}, (err, result) ->
            performers.chamber = result
            callback err
    ], (err) ->
        res.json performers 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:25:01.077

你也可以像这样组织你的代码：

```
exports.index = function(req, res){
    var _self = {};

    var foundItems = function(err, items){
      _self.items = items;
      res.render('index', { user: _self.user, items: _self.items, lists: _self.lists });
    };

    var foundLists = function(err, lists){
      _self.lists = lists;
      Items.find().exec(foundItems);
    };

    var foundUser = function(err, user){
      _self.user = user;
      List.find().exec(foundLists);
    };

    User.findById(user).exec(foundUser);
}; 
```

# tridion - Tridion 2011 - 在 Formatting Feature 窗口中过滤 XSLT

> ID：13219267
> 
> 赞同：4
> 
> 时间：2012-11-04T14:09:37.283
> 
> 标签：tridion, tridion-2011, tridion2009

目前我们正在从 2009 年到 2011 年进行 Tridion 升级。

我看到一个奇怪的问题，想知道为什么它的更新方式不同。

## 我的问题：

在许多 Schema 中，我们都有自己的内容字段（即富文本字段）过滤 XSLT。

**例子：**

```
<xsl:stylesheet ... >
...
...
...
</xsl:stylesheet> 
```

升级到 Tridion 2011 后，我看到架构更新为以下格式

```
<stylesheet... >
...
...
...
</stylesheet> 
```

因此，不会出现在组件上的富文本字段。

> **请让我知道这种行为背后的原因。**

## 如何解决这个问题？

我已经修复了这个解决方案，下面是修复。

> 将当前 XSLT 替换为 Filtering XSLT 选项卡上的适当 XSLT，使用 Tridion 2009 上的 XSLT。

```
<xsl:stylesheet ... >
...
...
...
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T19:45:07.177

正如您似乎发现的那样 - 只需将 SDL Tridion 2009 中的旧 XSLT 复制并粘贴到 2011 年的新 XSLT 上（或者简单地添加一个与`xsl`原始 XSLT 中的前缀匹配的默认命名空间）。我的猜测是当您迁移数据库时出了点问题。

# c - SCTP 多宿主未按预期工作

> ID：13219268
> 
> 赞同：1
> 
> 时间：2012-11-04T14:09:37.700
> 
> 标签：c, sctp

我在作为服务器端在 SCTP 中实现多宿主时遇到了问题。服务器有 2 个正在侦听的 IP。我快到了，但有两个问题：

1.  第一个 IP 在标头中返回带有 2 个不同 IP 的 INIT-ACK，但另一个 IP 在 INIT-ACK 标头中返回两倍相同的 IP。
2.  好像我不支持 100% 的多宿主，例如，如果其中一个链接断开，我看不到故障转移。

所以我不知道除了带有选项 SCTP_SOCKOPT_BINDX_ADD 的 setsockopt 我是否还需要其他任何东西（可能是 SCTP_PRIMARY_ADDR？）或者我的实现有什么问题。

以下是代码，我输入此代码两次，第一次绑定，然后保存套接字和第一个地址，第二次再次绑定（用于第二个 IP），然后为地址和套接字运行 setsockopt。

```
 bind(socket, &sock_addr.addr.sock_addr,  sock_addr_len);
  if(SHARED.num_used_entries_in_sockaddr_array  == 0)
  {
      SHARED.saved_socket = socket;
      SHARED.sockaddr_array[1] = sock_addr.addr.sock_addr;
  }
  else
  {
      SHARED.sockaddr_array[0] = sock_addr.addr.sock_addr;
  }

  if(SHARED.num_used_entries_in_sockaddr_array > 0)
  {

  sock_rc = setsockopt(SHARED.saved_socket,
                                  IPPROTO_SCTP,
                                  SCTP_SOCKOPT_BINDX_ADD,
                                  (char*)SHARED.sockaddr_array,
                                  sizeof(SCKOS_SOCK_ADDR));

  sock_rc = setsockopt(socket,
                                  IPPROTO_SCTP,
                                  SCTP_SOCKOPT_BINDX_ADD,
                                  (char*)SHARED.sockaddr_array,
                                  sizeof(SCKOS_SOCK_ADDR));

  }
  SHARED.num_used_entries_in_sockaddr_array++; 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:01:46.253

SCTP_SOCKOPT_BINDX_ADD 适用于多宿主。您的代码有一些未使用的行。

```
 if(SHARED.num_used_entries_in_sockaddr_array  == 0)
  {
    bind(socket, &sock_addr.addr.sock_addr,  sock_addr_len);
  }
  else
  {
    sock_rc = setsockopt(socket,
                              IPPROTO_SCTP,
                              SCTP_SOCKOPT_BINDX_ADD,
                              (char*)sock_addr.addr.sock_addr,
                              sizeof(SCKOS_SOCK_ADDR));
    }enter code here 
```

可以参考linux sctp implementation。你看到所有路径上的心跳了吗？你在哪个盒子上测试？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-30T12:34:49.420

感谢您的回答，最后我使用了更容易实现的 sctp_bindx

# cassandra - 在 Cassandra 中动态添加新节点

> ID：13219270
> 
> 赞同：9
> 
> 时间：2012-11-04T14:09:40.023
> 
> 标签：cassandra

是否可以动态地将新主机添加到 Cassandra 集群？

我想要做的是建立一个程序，它可以：

*   为每个用户设置数据库的本地版本
*   每个用户的机器都将成为集群的一部分（这些机器将成为主机）
*   数据将在所有集群中复制

构建多主机集群通常需要[配置 cassandra.yaml](http://www.datastax.com/docs/0.7/getting_started/configuring)来存储每个主机的种子、listen_address 和 rpc_address。

我的想法是通过 java 编辑这些文件并根据需要插入新的主机地址，但确保每个用户的 cassandra.yaml 文件中的数据准确无误将具有挑战性。

我想知道是否有人做过类似的事情或对实现这一目标的更好方法有任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T13:23:14.187

是的是可能的。查看[Netflix 的 Priam](https://github.com/Netflix/Priam/wiki)了解动态 cassandra 集群管理的完整示例（但设计用于与 Amazon EC2 一起使用）。

对于 rpc_address 和 listen_address，您可以设置一个启动脚本来配置 cassandra.yaml 如果它不正常。

对于种子，您可以配置自定义种子提供程序。查看[用于 Netflix Priam 的种子提供程序，](https://github.com/Netflix/Priam/blob/master/priam-cass-extensions/src/main/java/com/netflix/priam/cassandra/extensions/NFSeedProvider.java)了解如何实现它

最困难的部分是以有效的方式管理分配给每个节点的令牌。Cassandra 1.2 即将推出，它将包含一个称为虚拟节点的功能，IMO 将在您的情况下运行良好。请参阅[有关它的 Acunu 演示文稿](http://www.youtube.com/watch?v=GddZ3pXiDys)

# css - 具有复杂定位案例的精灵

> ID：13219273
> 
> 赞同：0
> 
> 时间：2012-11-04T14:10:14.853
> 
> 标签：css, css-sprites

当我用精灵图像 sprite_mbg.png 替换背景图像 mbg.jpg,mbgg.jpg,mbgr.jpg,mbgh.jpg 并将背景位置添加到输入的 css 时，按钮颜色由于宽度和位置而变得混合。

```
/*Sprite Image generated by Instant Sprite - Generate CSS Sprites Instantly*/

.sprite { background: url('http://s13.postimage.org/xmzbbctt1/sprite_mbg.png') no-repeat top left; width: 40px; height: 40px;  }
.sprite.mbg { background-position: 0px 0px;  }
.sprite.mbgh { background-position: -50px 0px;  }
.sprite.mbgg { background-position: -100px 0px;  }
.sprite.mbgr { background-position: -150px 0px;  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:03:20.703

我改为垂直精灵，它解决了这个问题。

# macos - OS X 上的 Bitbucket 权限被拒绝（公钥）Git

> ID：13219276
> 
> 赞同：1
> 
> 时间：2012-11-04T14:10:44.263
> 
> 标签：macos, git, ssh, terminal, bitbucket

我正在尝试使用三个位置的 Git 存储库设置

1.  当地的
2.  远程（Bitbucket）
3.  网络服务器

我已经成功地在本地创建了我的 SSH 密钥、我的 Git 存储库并将其推送到我的远程。我正在尝试从我的网络服务器到我的远程执行相同的操作，但收到错误：

> 权限被拒绝（公钥）。
> 致命：远端意外挂断

我对 Git/Terminal/SSH 比较陌生，可能缺少从 Web 服务器推送到远程所需的明显内容。我已经浏览了整个 Bitbucket SSH FAQ 无济于事。我不确定为什么我可以通过 SSH 从本地推送到远程，但无法从我的 Web 服务器推送到远程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T14:27:24.200

你可以在你的网络服务器上做几件事（我假设它正在运行 Linux）：

*   尝试从网络服务器 ssh-ing 到 bitbucket - 成功了吗？也尝试**ssh -vvv**（非常详细） - 看看你得到什么样的错误
*   检查您的网络服务器上**~/.ssh**目录的权限。他们应该是 0600
*   还可以尝试从网络服务器 ssh-ing 到您知道您可以 ssh 访问的其他主机

# macos - OS X 中的 AUCTeX 信息文件

> ID：13219281
> 
> 赞同：1
> 
> 时间：2012-11-04T14:11:12.723
> 
> 标签：macos, emacs, homebrew, auctex

我从[http://emacsformacosx.com/](http://emacsformacosx.com/)安装了 Emacs ，从自制软件安装了 AUCTeX。我`--with-emacs=/Applications/Emacs.app/Contents/MacOS/Emacs`在安装 AUCTeX 时使用了该选项。我能够成功加载`auctex.el`和`preview-latex.el`使用：

```
(add-to-list 'load-path "/usr/local/share/emacs/site-lisp")
(require 'tex-site)
(load "auctex.el" nil t t)
(load "preview-latex.el" nil t t) 
```

但是，AUCTeX 的信息文件似乎不可用。我检查了`/usr/share/info/`和`/Applications/Emacs.app/Contents/Resources/info/`，信息程序搜索信息文件的两个默认位置，但与 AUCTeX 相关的位置不存在。

[我从源代码](http://www.gnu.org/software/auctex/download-for-macosx.html)中查看了 AUCTeX 压缩包，它确实有信息文件`doc/`，安装说明声称应该在安装过程中自动安装。

所以我要问的是：

1.  自制软件会为 AUCTeX 安装信息文件吗？如果是，它们位于何处？
2.  如果自制软件没有安装必要的信息文件，我如何将它们从源代码复制到上述目录。我想我需要对它们进行 gzip 压缩，所以我应该只包含`doc/`目录下的所有内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:08:46.853

homebrew 在安装软件包时会删除信息文件。您可以通过设置强制自制软件保留信息文件`$HOMEBREW_KEEP_INFO`（如 中所述`man brew`）。

设置环境变量`$HOMEBREW_KEEP_INFO`并重新安装AUCTeX。由于您已经在使用自制软件，我建议您也从自制软件安装 Emacs：

```
$ brew uninstall auctex
$ brew cleanup
$ export HOMEBREWW_KEEP_INFO=1
$ brew install emacs --cocoa --srgb
$ brew install auctex 
```

您现在应该可以看到 .AUCTeX 信息文件`C-h i`。

您可能还需要考虑通过`package.el`( `M-x package-install auctex`) 安装 AUCTeX。

# android - 跟踪用户位置

> ID：13219285
> 
> 赞同：0
> 
> 时间：2012-11-04T14:11:30.243
> 
> 标签：android, service, broadcastreceiver, tracking, locationlistener

问题：

用户可以选择开始跟踪您的位置的时间和时间（例如今天从 08:00 到 16:00）。因此，在此间隔期间，我的应用程序将每 5 分钟侦听一次位置（此时间可以更改，这是用户的偏好）。

我在想什么：

使服务在用户定义的时间间隔内运行并监听 GPS 或网络位置的到来。

问题：

服务运行时间长了可以去掉吗？

我需要在启动服务时将侦听器注册到 GPS 和网络（即使它们尚未启用），或者我需要根据 GPS 和网络的状态注册和删除侦听器？

即使用户很长时间（比如一个小时）不使用手机，我的服务也会继续运行，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:56:57.850

您无需为此注册服务。您可以使用 Mak Murphy 的[cwac-locpoll](https://github.com/commonsguy/cwac-locpoll)库。

这是从上面链接的页面中获取的库的​​简短描述。您还可以在那里找到代码示例。

> 您只需设置一个 AlarmManager 警报，以您希望的任何频率联系 LocationPoller，它将从那里处理所有定位工作，并通过广播 Intent 向您发送结果。然后，您的 BroadcastReceiver 可以根据需要使用位置数据。

# python - 表达式的十进制近似值（平方根）

> ID：13219286
> 
> 赞同：-2
> 
> 时间：2012-11-04T14:12:02.680
> 
> 标签：python, math

我想知道是否有一些模块可以将小数转换为根，例如：

```
>>> x = 1.7320508075688772
>>> f(x)
'√3' 
```

作为一个字符串。希望你能帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:25:47.010

假设我猜对了您的要求，您可以使用`sympy.nsimplify` [[docs]](http://docs.sympy.org/0.7.0/modules/simplify.html#nsimplify)来识别并简化数字（使用幕后的`identify`功能）：`mpmath`

```
>>> import sympy
>>> sympy.nsimplify(1.7320508075688772)
sqrt(3) 
```

但是有很多关于精确和虚假识别的警告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T14:27:56.023

像这样，使用`math`模块：

```
In [16]: strs="1,7320508075688772"

In [17]: num=float(".".join(strs.split(",")))

In [19]: math.ceil(num**2)
Out[19]: 3.0 
```

**相似地：**

```
In [25]: math.ceil(1.414**2)
Out[25]: 2.0

In [26]: math.ceil(2.23606**2)
Out[26]: 5.0

In [28]: math.ceil(1.7320508075688772**2)
Out[28]: 3.0 
```

# php - 将逗号分隔文件导入mysql

> ID：13219288
> 
> 赞同：1
> 
> 时间：2012-11-04T14:12:21.757
> 
> 标签：php, mysql

我正在下载远程文本文件并将其导入本地 mysql 数据库。

格式最近已更改为在其中一列内有一个逗号，并导致导入失败，并出现错误“第 1 行 CSV 输入中的字段计数无效”。数据现在看起来像：

```
"bonita","FL","212025920","2012929","Hooker,Bill" 
```

如何更新此代码片段以允许引号内有逗号？

```
foreach(explode($lineseparator,$csvcontent) as $line) {

    $lines++;

    $line = trim($line," \t");

    $line = str_replace("\r","",$line);

    /************************************
    This line escapes the special character. remove it if entries are already escaped in the csv file
    ************************************/
    $line = str_replace("'","\'",$line);
    /*************************************/

    $linearray = explode($fieldseparator,$line);

    $linemysql = implode("','",$linearray);

    $linemysql = str_replace("\"","",$linemysql);###code added

        $query = "insert ignore into $databasetable values('$linemysql');"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:18:20.337

`LOAD DATA LOCAL INFILE`with `FIELDS TERMINATED BY ',' ENCLOSED BY '"'`options 应该直接读取文件。`LOAD DATA INFILE`也比标准`INSERT`语句快。

[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

这很接近，但我不认为 TRIM() 正在删除标签：

`LOAD DATA LOCAL INFILE '/my/local/file/path.csv' IGNORE INTO TABLE mytable FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\r\n' (@a, @b, @c, @d, @e) SET col1=TRIM(@a), col2=TRIM(@b), col3=TRIM(@c), col4=TRIM(@d) col5=TRIM(@e)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T14:31:06.107

将您的函数重写为：

```
 foreach(explode($lineseparator,$csvcontent) as $line) {

        $lines++;
        $line = trim($line," \t");
        $line = str_replace("\r","",$line);

        $lineArray = str_getcsv($line, ",", '"');
        $linemysql = implode("','",$lineArray);
         $query = "insert ignore into $databasetable values('$linemysql');";
        //.. Handle  the rest

     } 
```

php getcsv 函数负责处理分隔符并跟踪附件 - 为您省去这些麻烦。

以下片段：

```
 $line = '"bonita","FL","212025920","2012929","Hooker,Bill"';
   $array = str_getcsv($line, ",", '"');
   print_r($array); 
```

输出：

```
 Array ( [0] => bonita [1] => FL [2] => 212025920 [3] => 2012929 [4] => Hooker,Bill ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:19:17.720

**样品表：**

```
CREATE TABLE `table1` (
    `id` VARCHAR(50) NULL DEFAULT NULL,
    `a1` VARCHAR(50) NULL DEFAULT NULL,
    `b1` VARCHAR(50) NULL DEFAULT NULL,
    `c1` VARCHAR(50) NULL DEFAULT NULL,
    `d1` VARCHAR(50) NULL DEFAULT NULL
)
COLLATE='utf8_general_ci'
ENGINE=InnoD1B; 
```

**进口查询：**

```
load data local infile 'd:/import.csv' into table table1 fields terminated by ','
enclosed by '"'
lines terminated by '\r\n'
(id, a1, b1, c1, d1) 
```

**导入.csv**

```
"bonita1","FL1","212025920","2012929","Hooker,Bill"
"bonita2","FL2","212025920","2012929","Hooker,Bill"
"bonita3","FL3","212025920","2012929","Hooker,Bill" 
```

# class - 接口和类中的函数重载 - 如何？

> ID：13219289
> 
> 赞同：8
> 
> 时间：2012-11-04T14:12:25.503
> 
> 标签：class, interface, overloading, typescript

我有这个界面：

```
interface IPoint {
    getDist(): string;
    getDist(x: number): any;
} 
```

我需要一个类来实现它，但我无法获得正确的语法来实现类中的 getDist() 方法。

```
class Point implements IPoint {
    // Constructor
    constructor (public x: number, public y: number) { }

    pointMethod() { }

    getDist() {
        Math.sqrt(this.x * this.x + this.y * this.y);
    }
    // Static member
    static origin = new Point(0, 0);
} 
```

它说：

> “Point”类声明了“IPoint”接口，但没有实现它：“Point”和“IPoint”类型的属性“getDist”类型不兼容：“() => void”和“{()”类型的调用签名：细绳; （x：数字）：任何；}' 不兼容

这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T14:34:40.757

当你在类中声明函数时，你需要用重载来装饰它：

```
getDist(): string;
getDist(x: number): any;
getDist(x?: number): any {
    // your code
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T14:16:25.060

[这个答案](https://stackoverflow.com/a/12689054/139010)描述了如何在 TypeScript 中实现方法重载，它并不漂亮：

```
interface IPoint {
    getDist(): string;
    getDist(x: number): any;
}

class Point implements IPoint {
    // Constructor
    constructor (public x: number, public y: number) { }

    pointMethod() { }

    getDist(x?: number) {
         if (x && typeof x == "number") {
             return 'foo';
         } else {
             return 'bar';
         }
    }
} 
```

注意在接口中声明返回类型的特定组合，您只能从`getDist`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-16T11:23:59.910

你也可以使用默认值

```
interface Foo{
    next()
    next(steps: number)
    prev()
    prev(steps: number)
}

next(steps: number = 1) {
    // ...
}

prev(steps: number = 1) {
    // ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-09T17:36:58.277

以下是上述部分内容的变体

```
class Position {
    x: number;
    y: number;

    constructor(x : number = 0, y : number = 0) {
        this.x = x;
        this.y = y;
    }    
}

class Pen {
    colour: string;

    constructor(colour: string) {
        this.colour = colour;
    }
}

class PlottingHead {
    isPenUp: boolean;
    pen: Pen;
    position: Position;

    constructor() {     
       this.penUp();
   }

   move(p: Position): void;
   move(x: number, y: number): void;
   move(x: number | Position, y?: number): void {
        if (typeof x === "number")
        {
            x = new Position(x, y);
        }
        this.penUp();
        this.position = x;
    }

    draw(x: number | Position, y?: number): void {
        if (typeof x === "number")
        {
            x = new Position(x, y);
        }
        this.penDown();
        this.position = x;
    }

    penDown(): void {
        this.isPenUp = false;
     }

    penUp(): void {
        this.isPenUp = true;
    }

    onChangePen(newPen: Pen) {
        this.penUp();
        this.pen = newPen;
    }    
} 
```

该`move`函数采用单个位置对象或一对数值。这显然可以根据需要进行扩展。

# java - 在android中更改Imageview的大小

> ID：13219291
> 
> 赞同：5
> 
> 时间：2012-11-04T14:12:52.963
> 
> 标签：java, android, android-imageview

我将图像视图的默认大小设置为`width=511`和`height=385`。imageview的来源来自drawable。基于动态值，我需要更改图像视图的大小或适合它的图像。例如，我想将其中的图像视图或图像的大小更改为`width=140`和`height=100`

```
ImageView scale=(ImageView) findViewById(R.id.scaleimage); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T14:20:50.457

如果您将 ImageView 的宽度和高度属性设置为特定值，系统将自动缩放您的图像以适合。

除非我不明白你的问题，否则我认为它很简单：

```
<ImageView
    android:layout_width="140dp"
    android:layout_height="100dp"
    android:scale_type="fitXY"
/> 
```

要在代码中设置它，请尝试：

```
LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(140,100);
yourView.setLayoutParams(layoutParams); 
```

# matlab - 如何检索mat文件数据？

> ID：13219293
> 
> 赞同：0
> 
> 时间：2012-11-04T14:13:11.213
> 
> 标签：matlab, function

我有一个包含 10（列）x 3（行）数据的 mat 文件，我想检索这些数据以通过某些函数产生一些可读的输出。例如，第一列数据为 1 0 0，输出为 Yes。

我可以知道如何执行第一步，即如何从保存在笔记本电脑中的 mat 文件中检索/读取数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:42:23.137

假设您的“.mat”文件的名称为“xyz.mat”，并且存储在 .mat 文件中的变量与该文件具有相同的名称。

```
load('xyz.mat') % loads xyz.mat into workspace.
if xyz(:,1)==[1;0;0],
answer='yes'
end 
```

注意：这里我假设数组 xyz 存储为 xyz.mat ，如果数组名称与 .mat 文件的文件名不同，那么您将不得不在 if 语句中使用数组名称。例如，如果您将一个名为 abcd 的数组存储为 xyz.mat，那么当您使用 load('xyz.mat') 时，该数组将以其原始名称 (abcd) 而不是文件名 xyz 加载

# android - 执行数据加载单元成功或用户中断

> ID：13219295
> 
> 赞同：0
> 
> 时间：2012-11-04T14:13:54.740
> 
> 标签：android, android-annotations

在我的应用程序中，我执行从网络加载数据，然后将其显示给用户。在加载数据应用程序显示进度对话框之前。如果用户在加载操作过程中锁定手机，或者服务器超载并且无法及时响应我的应用程序冻结，因为它没有关闭进度对话框，或者在某些情况下由于缺少所需的数据而崩溃，我会遇到问题。

如果在加载数据时发生了一些错误，我想向用户显示一些对话框，让他知道错误并询问他应用程序是否应该重复上一个请求。我尝试使用 AlertDialog ，但我没有成功。

这是一项活动的代码（这里没有进度对话框，但它演示了我如何加载数据）：

```
 @EActivity(R.layout.layout_splash)
    @RoboGuice
    public class SplashScreenActivity extends Activity {

    @Inject
    private AvtopoiskParserImpl parser;

    @Bean
    BrandsAndRegionsHolder brandsAndRegionsHolder;

    @ViewById(R.id.splash_progress)
    ProgressBar progressBar;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        loadData();
    }

    @Background
    protected void loadData() {
        publishProgress(10);
        LinkedHashMap<String, Integer> brands = null;
        try {
            brands = parser.getBrands();
        } catch (IOException e) {
            Log.e(e.getMessage());
        }
        publishProgress(50);

        LinkedHashMap<String, Integer> regions = null;
        try {
            regions = parser.getRegions();
        } catch (IOException e) {
            Log.e(e.getMessage());
        }

        publishProgress(70);
        populateData(brands, regions);
    }

    @UiThread
    protected void populateData(LinkedHashMap<String, Integer> brands, LinkedHashMap<String, Integer> regions) {
        Intent intent = new Intent(SplashScreenActivity.this, SearchActivity_.class);
        brandsAndRegionsHolder.brandsMap = brands;
        brandsAndRegionsHolder.regionsMap = regions;
        publishProgress(100);
        startActivity(intent);
        finish();
    }

    @UiThread
    void publishProgress(int progress) {
        progressBar.setProgress(progress);
    }

} 
```

`parser.getBrands()`并且`parser.getRegions()`正在从网络加载数据。

我想做这样的事情：

```
 boolean repeatRequest = true;
    while (repeatRequest) {
        try {
            brands = parser.getBrands();
            repeatRequest = false;
        } catch (IOException e) {
            Log.e(e.getMessage());
            repeatRequest = showErrorDialog();
        }
    } 
```

但我没有设法这样做，因为这段代码在后台线程中执行，但对话框应该显示在 UI 线程中。我相信这应该是这样做的标准方法，但没有设法找到它。任何想法我该如何实现这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:39:40.547

最好的方法是使用[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html).

```
private class LoadDataTask extends AsyncTask<Void, Integer, Object> {
    private ProgressDialog mProgress;

    protected Object doInBackground(Void... params) {
        // This method runs in background
        Object result = null;
        try {
            result = parser.parse();
        } catch (Exception e) {
            result = e.getMessage();
        }
        return result;
    }

    protected void onProgressUpdate(Integer... progress) {
        // This method runs in UI thread
        mProgress.setProgress(progress[0]);
    }

    protected void onPreExecute() {
        // This method runs in UI thread
        mProgress = new ProgressDialog(context);
        mProgress.show();
    }

    protected void onPostExecute(Object result) {
        // This method runs in UI thread
        mProgress.dismiss();

        if (result instance of String) {
            // Here you can launch AlertDialog with error message and proposal to retry
            showErrorDialog((String) result);
        } else {
            populateData(result);
        }
    }
} 
```

# c++ - 为什么我应该使用 io_service::work？

> ID：13219296
> 
> 赞同：7
> 
> 时间：2012-11-04T14:13:58.270
> 
> 标签：c++, boost, boost-asio

我是 boost 编程的新手，我一直在寻找使用 的理由`io_service::work`，但我想不通；在我的一些测试中，我删除了它并且*工作*正常。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T14:24:40.303

`io_service::run()`只要有异步操作要执行，就会运行操作。如果在任何时候都没有异步操作挂起（或正在调用的处理程序），则`run()`调用将返回。

但是，有些设计希望在`run()`完成所有工作`io_service`并且明确指示可以退出之前调用不退出。这`io_service::work`就是用途。通过创建`work`对象（我通常在堆和 shared_ptr 上创建），io_service 认为自己总是有一些待处理的东西，因此该`run()`方法不会返回。一旦我希望服务能够退出（通常在关闭期间），我将销毁工作对象。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T14:27:00.193

`io_service::work`是所有可以`io_service`发布`work`到`io_service`. 所以你通常从不`work`直接使用，但有一个例外：

`io_service::run`一旦没有更多工作要做就会返回，所以考虑一个有一些生产者和消费者线程的应用程序，生产者偶尔会产生工作并将它们发布到消费者线程`io_service::post`，但如果所有工作完成，那么`io_service::run`将返回并且可能是你的消费者线程将被停止，所以你需要一个任意的工作来保持`io_service`忙碌，这种情况下你可以`io_service::work`直接使用。

# java - 操作数堆栈上的错误类型...使用 jdk 8，带有匿名内部类的 lambdas 失败，为什么？

> ID：13219297
> 
> 赞同：13
> 
> 时间：2012-11-04T14:14:02.090
> 
> 标签：java, lambda, java-8

运行下面的代码会导致错误消息`Bad type on operand stack`。

```
public static void main(String args[]) {
        TransformService transformService = (inputs) -> {
            return new ArrayList<String>(3) {{
                add("one");
                add("two");
                add("three");
            }};
        };

        Collection<Integer> inputs = new HashSet<Integer>(2) {{
            add(5);
            add(7);
        }};
        Collection<String> results = transformService.transform(inputs);
        System.out.println(results.size());
    }

    public interface TransformService {
        Collection<String> transform(Collection<Integer> inputs);
    } 
```

但是删除 lamda 中的双括号初始化（匿名内部类）允许代码按预期运行，为什么？以下作品：

```
public class SecondLambda {
    public static void main(String args[]) {
        TransformService transformService = (inputs) -> {
            Collection<String> results = new ArrayList<String>(3);
            results.add("one");
            results.add("two");
            results.add("three");

            return results;
        };

        Collection<Integer> inputs = new HashSet<Integer>(2) {{
            add(5);
            add(7);
        }};
        Collection<String> results = transformService.transform(inputs);
        System.out.println(results.size());
    }

    public interface TransformService {
        Collection<String> transform(Collection<Integer> inputs);
    }
} 
```

编译器错误？毕竟是抢先体验版……

[（除非你有最新的jdk 8 lambda 下载](http://jdk8.java.net/lambda/)，否则它不会编译。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T09:43:00.543

看来，这个问题不仅发生在`lambda`返回`anonymous`类型的情况下，而且即使在内部构造了任何匿名类`lambda`。IE：

```
public class TestLambda {
    public static void main(String[] args) {
        xxx();
    }
    static void xxx() {
        Functional1 f  = () -> {
            Object o = new Object() { };
            return new A();
        };
    }
    static class A { }
    static interface Functional1 { A func(); }
} 
```

这实际上导致`Exception in thread "main" java.lang.VerifyError: Bad local variable type`(...) `Reason: Type top (current frame, locals[0]) is not assignable to reference type`。

进一步调查表明，如果我们将参数引入方法`xxx`，异常的原因将包含其类型。例如：

`Type 'java/lang/Integer' (current frame, stack[0]) is not assignable to 'lambda/TestLambda'`

这已经很有趣了。让我们将`xxx`参数类型（实际上并未使用）更改为**顶级**类型，即`TestLambda`：

```
...
    xxx(new TestLambda());
}
private static void xxx(TestLambda x) {
... 
```

你觉得怎么样？**这解决了问题！**一切都开始运作良好。即使，如果我们将更`return A();`改为`return new A() {};`. 检查这个！

* * *

我的结论是这是真正的**JVM 错误**。看来，问题出在加载的类堆栈上。它出现在 combine with 方法中，`Java`用于翻译`lambda`表达式（[http://cr.openjdk.java.net/~briangoetz/lambda/lambda-translation.html](http://cr.openjdk.java.net/~briangoetz/lambda/lambda-translation.html)） - 它在顶级类中生成合成方法。似乎，当在`lambda`堆栈中引入匿名类时，它会被破坏。可以使用提到的解决方法修复它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T00:44:34.180

> 编译器错误？毕竟是抢先体验版……

我想说任何提到操作数堆栈的错误消息*很可能*是由于编译器错误或 JVM 中的错误。特别是如果您可以使用纯 Java 示例获得它。

（看起来 JVM 正在报告应该由编译器和/或字节码验证器在类加载时检测到的类型安全问题。）

通过 Java 8 错误的推荐渠道报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-18T16:28:41.157

与您的问题没有直接关系，但我*强烈*建议不要以这种方式使用匿名类。您创建一个全新的 HashSet 子类型只是为了向它添加两个值。这不仅会使系统膨胀（它永远保留在内存中），而且还会混淆 JVM 的 JIT，因为它从不只是在调用站点上看到 HashSet……它会看到您创建的许多子类型之一。

# php - 如果在 codeigniter 中加载视图时视图为空值怎么办？

> ID：13219300
> 
> 赞同：0
> 
> 时间：2012-11-04T14:14:24.127
> 
> 标签：php, codeigniter

我正在构建一个需要动态加载视图的应用程序。view 的值是一个变量，它取决于控制器设置它的内容。有时我的值作为空值或空值返回，即我不希望加载任何视图。但随后我的代码在同一个地方中断，屏幕的一半变为空白。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:39:43.070

我自己找到了解决方案。在我看来，我之前所做的是：

```
$this->load->view($viewname); 
```

用于来自控制器的视图名称的值是：

```
$data['viewname'] = 'dynamicview'; 
$this->load->vars($data); 
```

我现在正在做的是，在我的控制器中：

```
$data['viewname'] = $this->load->view('dynamicview',null,TRUE);
$this->load->vars($data); 
```

现在在我看来，我只是写：

```
echo $viewname; 
```

实际上，这会将视图作为数据传递给控制器​​，然后在我们实际打印它的视图中解析它。我希望这可以帮助那里的人。至少节省了我的一天...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:20:47.570

检查控制器中的值，如果值为空不加载视图？

```
if($variable== something)
{
    $this->load->view('myView');
} else {
    do something else;
} 
```

# java - ServerSocket 停止接收命令，java/android

> ID：13219301
> 
> 赞同：0
> 
> 时间：2012-11-04T14:14:35.690
> 
> 标签：java, android, serversocket

我已经使用 Socket 框架在我的手机和计算机之间建立了连接。只要我只需要发送一个命令，它就可以正常工作。然后我必须重新启动服务器才能接收新命令。你能帮我弄清楚为什么吗？我希望能够发送多个命令。

我正在从 GUI 主类调用类方法。

我的服务器代码：

```
public class Server {

    private static PrintWriter out;
    private static BufferedReader in;
    private static ServerSocket serverSocket = null;
    private static Socket clientSocket = null;
    private static String inputLine, outputLine;

    public static void main() throws IOException {

        try {
            serverSocket = new ServerSocket(4444);
            System.out.println(serverSocket.getInetAddress().toString());
        } catch (IOException e) {
            System.err.println("Could not listen on port: 4444.");
            System.exit(1);
        }

        try {
            clientSocket = serverSocket.accept();
        } catch (IOException e) {
            System.err.println("Accept failed.");
            System.exit(1);
        }

        out = new PrintWriter(clientSocket.getOutputStream(), true);
        in = new BufferedReader(
                new InputStreamReader(
                clientSocket.getInputStream()));
        Protocol kkp = new Protocol();

        outputLine = kkp.processInput(null);
        out.println(outputLine);

        while ((inputLine = in.readLine()) != null) {
             System.out.println(inputLine);
             outputLine = kkp.processInput(inputLine);
             out.println(outputLine);
        }

    }

    public static void shutDown() throws IOException
    {
        System.exit(1);
        out.close();
        in.close();
        clientSocket.close();
        serverSocket.close();
    }

} 
```

我的客户代码：

```
class ClientThread implements Runnable {

        public void run() {
            Socket kkSocket = null;
            PrintWriter out = null;
            BufferedReader in = null;

            try {
                InetAddress serverAddr = InetAddress.getByName(serverIpAddress);
                kkSocket = new Socket(serverAddr, 4444);
                out = new PrintWriter(kkSocket.getOutputStream(), true);
                in = new BufferedReader(new InputStreamReader(kkSocket.getInputStream()));
            } catch (UnknownHostException e) {
                showToast("Kan ikke finde host fra: "+settings.getString("ip", "86.52.16.102"));
                System.err.println("Don't know about host: taranis.");
                System.exit(1);
            } catch (IOException e) {
                showToast("Kan ikke udveksle oplysninger med: "+settings.getString("ip", "86.52.16.102"));
                System.err.println("Couldn't get I/O for the connection to: taranis.");
                System.exit(1);
            }

            String fromServer;
            String fromUser;

            try {
                while ((fromServer = in.readLine()) != null) {
                    System.out.println("Server: " + fromServer);
                    if (fromServer.equals("Shutting down") || fromServer.equals("Wrong pin!"))
                    {
                        showToast(fromServer);

                        break;
                    }

                    //fromUser = stdIn.readLine();
                    fromUser = pinkode.getText().toString()+","+time;
                    if (fromUser != null) {
                        System.out.println("Client: " + fromUser);
                        out.println(fromUser);
                        fromUser = null;
                    }
                }
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            out.close();
            try {
                in.close();
                kkSocket.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:27:22.147

尝试把这部分代码：

```
 try {
        clientSocket = serverSocket.accept();
        } catch (IOException e) {
             System.err.println("Accept failed.");
            System.exit(1);
         }

    out = new PrintWriter(clientSocket.getOutputStream(), true);
    in = new BufferedReader(
            new InputStreamReader(
            clientSocket.getInputStream()));
    Protocol kkp = new Protocol();

    outputLine = kkp.processInput(null);
    out.println(outputLine);

    while ((inputLine = in.readLine()) != null) {
         System.out.println(inputLine);
         outputLine = kkp.processInput(inputLine);
         out.println(outputLine);
    } 
```

在一个`while(true){ ... }`.

# c# - 用作类的用户控件

> ID：13219305
> 
> 赞同：0
> 
> 时间：2012-11-04T14:15:05.250
> 
> 标签：c#, user-controls

我有一个类和一个用户控件。用户控件应该代表该类并包含其所有属性。我对如何处理这个问题有点迷茫

非常感谢所有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:42:14.690

似乎您需要使用数据绑定。创建一个用您的类键入的属性，例如`MyClass Data {get; set;}`，然后添加新的 BindingSource 并作为 BindingSource.DataSource 设置您的 Data 属性。然后设计你的控件。不要忘记在构造函数中创建 MyClass 的新实例。

# javascript - 如何使用 OAuth 2.0 实现 Web 小部件

> ID：13219308
> 
> 赞同：14
> 
> 时间：2012-11-04T14:15:36.113
> 
> 标签：javascript, ajax, ruby-on-rails-3, oauth-2.0

我想创建一个 Web 小部件来显示来自我的站点的信息。

该小部件将使用 JavaScript 包含在客户的网站 HTML 中，并且应该只对我的客户可用——在我的网站上注册的网站。

小部件中的信息应该特定于当前正在访问客户站点的用户。

因此，我需要对客户端（网站所有者）和资源所有者（网站访问者）进行身份验证。这似乎很好地映射到 OAuth 2.0，但我找不到这种实现的完整示例或解释。

任何资源或指向此类信息的指针将不胜感激。

**更新：**我偶然发现了[这篇文章](http://supercollider.dk/2009/01/oauth-and-client-side-widgets-154)，它提供了使用 OAuth 的方法的大纲。但是，对于我来说，它还不够详细，无法真正理解如何将其与 OAuth 2 一起使用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T12:47:50.680

有许多大型组织已经这样做了，我很遗憾没有看到这个问题的其他答案，因为它是一个如此重要的网络模式。

我将假设您不会从头开始滚动自己的 OAuth 2.0 提供程序，如果您这样做的话 - 做得好，否则您应该使用像[Doorkeeper](https://github.com/applicake/doorkeeper)这样的工具来为您做这件事。

现在，在 OAuth 2.0 中，您拥有以下实体：

1.  在您的网站上注册的用户
2.  在您的网站上注册的应用程序（订阅您的 oauth2）
3.  用户权限，这是用户“允许”的应用程序列表
4.  开发人员（正在使用您的身份验证 API/小部件并构建应用程序）

首先要注意的是**您必须有**一个与每个应用程序相关联的域名。因此，如果开发人员在您的网站上注册 API 令牌/机密，他创建的应用程序将映射到**唯一**域。

现在，我认为应用程序通过您的网站对用户进行身份验证的流程已经很清楚了。话虽这么说，你不需要做太多的工作。

当应用程序将用户发送到您的网站（以便登录）时，您会在用户的计算机上放置一个会话 cookie。让我们称之为“Cookie-X”。

现在用户已通过您的网站的身份验证并返回到应用程序。在那里，我们想要显示一个自定义小部件，其中包含与该用户有关的信息。

开发人员需要将一些代码复制粘贴到此应用程序中。

流程是这样的：

1.  该代码将包含一个指向您网站的 URL，其中包含他在您的网站上注册他的应用程序时获得的应用程序 ID（不是秘密）。

2.  当该代码运行时，它将使用他的 appId ping 您的网站。您需要使用您的数据库检查该 AppID，并另外检查引荐来源网址是否来自与在您的网站中为该 AppID 注册的域名相同的域。**编辑：**或者或另外，代码可以检查`document.domain`并将其包含在对您网站的 ping 中，允许您验证请求是否来自已使用给定 AppID 注册的域。

3.  如果这是正确的，你会回复一些 JS 代码。

4.  您的 JS 代码会查找您的网站在用户登录时设置的会话 cookie。如果找到该 cookie，它会通过会话 ping 回您的网站，并且您的网站会使用自定义视图内容进行响应。

**编辑：**正如评论中正确提到的，cookie 应该是 HttpOnly 以防止常见的 XSS 攻击。

**补充说明**

这是一种安全方法的原因：

1.  AppId 和域名是一个足够好的组合来验证其他人没有获取此信息。即使 appId 在应用程序 html 源代码中可见，域名也必须被任何试图使用其他人的 AppID 的人欺骗。

2.  假设某人获取了一个不是他的 AppID，并在请求您的小部件时编写代码来欺骗引用者的域名，他仍然无法看到任何信息。由于您正在显示用户特定信息，因此只有当您的网站可以找到它放置在用户浏览器上的会话 cookie 时，该小部件才会呈现，而该会话 cookie 不能真正被欺骗。有诸如会话劫持等方法。但我认为这超出了这个问题的范围。

**其他方法** 只需查看 Facebook 的社交插件，您就可以知道还有其他选择。

例如，可能是使用 Iframe。如果你要求开发者在他的应用程序中添加一个 iframe，你甚至可以减少上面提到的一些步骤。但是您必须将 JS 连同它一起添加（在 iframe 之外）以获取正确的域等。当然，从可访问性和界面的角度来看，我不太了解 iframe。

# web-services - 在 JAX WS 中开发 Web 服务的策略

> ID：13219309
> 
> 赞同：0
> 
> 时间：2012-11-04T14:15:46.590
> 
> 标签：web-services, maven, jax-ws

我希望你能帮助设计一个 wb 服务，但我不知道我怎么做不到。事实上，我的应用程序处理数据管理客户端。我的应用程序是在 struts 1.0、spring、weblogic 和内置 maven 中开发的。他被要求对我进行演进，因为外部应用程序需要访问数据，例如显示客户端的地址或显示数据库。为此，计划创建一个实时检索的 Web 服务。我想知道用于设计 Web 服务的策略。我是否需要为我的 web 服务创建一个新的 Dynamite projet maven + JAX WS 并将我的战争部署在我的 weblogic 服务器上？还是他们有别的事情要做？

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T11:04:26.270

我不确定这个问题是否与 Maven 有关。

[使用 springframework 和 apache cxf ( http://cxf.apache.org/](http://cxf.apache.org/) )添加 WebService（或 RestService）可能非常容易

有关更多信息，请参见 jaxws 或 jaxrs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-14T20:53:42.493

使用 jax-ws Web 服务以两种类型创建 Web 服务但实时应用程序的原因是消费者希望将数据发送到提供者。消费者可以通过查看提供者的 WSDL 文档来了解有关提供者的全部信息。

# c++ - 我可以在 Cocos2D 中弯曲精灵吗？

> ID：13219314
> 
> 赞同：0
> 
> 时间：2012-11-04T14:16:36.030
> 
> 标签：c++, ios, sprite

我正在使用 Cocos2D，或者更具体地说是 Cocos2D-x 来制作平台射击游戏。我已经有了平台游戏部分，但我想让我的角色拍摄。我在许多 ios 游戏中看到角色能够随心所欲地射击，我想知道，他们是否为此制作了大量的精灵，因为他们在瞄准其他方面也很有趣，或者他们是否会弯曲他们的精灵。我怎样才能达到这个效果？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:42:53.617

[这个 SO question](https://stackoverflow.com/questions/9358273/cocos2d-help-how-to-rotate-a-sprite-continuously-and-generate-child-sprites-in)涉及轮换。

我相信用一个以身体为特征的精灵和另一个在关节顶部旋转并由手臂和枪组成的精灵组成一个射击人物是可行的。它看起来不错吗？要使关节看起来自然，肯定需要一些艺术技巧。不过，一个 alpha 通道可能就足够了——或者有些人故意让英雄穿着带有球形关节的未来盔甲。

# ruby-on-rails - 如何禁用 Ruby on Rails 应用程序中的所有 form_for 输入字段？

> ID：13219315
> 
> 赞同：10
> 
> 时间：2012-11-04T14:16:39.667
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试稍微干燥一下我的 Rails 应用程序，所以我想在我的`show`视图中呈现一个表单，但*禁用*所有输入字段。

```
// show.html.erb

<%= form_for(@project) do |f| %>
  <%= render 'fields', :f => f %>
<% end %> 
```

最好的方法是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-04T14:53:04.380

## Javascript

一种方法是使用 JS 来实现。在显示视图中包含`div`具有特定类的 a：

```
// show.html.erb

<div class='disable_input'>
  <%= form_for(@project) do |f| %>
    <%= render 'fields', :f => f %>
  <% end %>
</div> 
```

然后在你的 JS 文件中：

```
$('.disable_input :input').prop('disabled', true); 
```

## 导轨

如果您想在服务器端实际生成它，您可以将一个变量传递给您的部分，该变量将告诉部分是否必须在每个字段上添加禁用选项。不过工作量有点大！

使用变量，您可以执行以下操作：

```
<%= form_for(@project) do |f| %>
  <%= render 'fields', :f => f, :disabled => true %>
<% end %> 
```

在部分：

```
<% disabled ||= false  
   #We do this so if disabled is not passed to the partial it doesn't crash. 
   # We default it to false 
%>

<% # Then for all your fields, add disabled: disabled %>
<%= f.text_field :some_attribute, disabled: disabled %> 
```

## 表单生成器

编辑：实际上，避免在`disabled`任何地方显式传递的一种方法是创建一个`Custom form builder`. 有一些很好的资源在谈论它，比如这个：http: [//johnford.is/writing-a-custom-formbuilder-in-rails/](http://johnford.is/writing-a-custom-formbuilder-in-rails/)

在这个例子中，它已经完成了`onkeypress`，应该不难适应你的情况！

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-01-21T13:46:29.647

您可以将所有字段包装在`<fieldset disabled>`

```
// show.html.erb

<%= form_for(@project) do |f| %>
  <fieldset disabled>
    <%= render 'fields', :f => f %>
  </fieldset>
<% end %> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-04T14:47:57.503

您可以为此使用样式表。

显示操作可能在控制器中说“项目”，因此您可能在样式表中有一个带有控制器名称的文件。

现在将您的表单包含在一个 div 中的 show.html.erb 中，并给它一个唯一的 id，比如“disable_input”，您不会给任何页面中的任何元素。

现在禁用此 div 下的 CSS 中的所有输入字段。可以这样写。。

disable_input input{
# 你想做什么
}

因此无需编码。

# uiview - 无法在 UIview 上显示 UITextview

> ID：13219316
> 
> 赞同：0
> 
> 时间：2012-11-04T14:16:51.060
> 
> 标签：uiview, uitextfield

我创建了一个生成器，例如创建一个文本字段。

```
-(UITextField *)generateTextField
{
    UITextField *textfield = [[UITextField alloc]initWithFrame:CGRectMake(100, 150, 100, 40)];
    textfield.layer.borderColor = [[UIColor colorWithRed:171.0/255.0 green:171.0/255.0 blue:171.0/255.0 alpha:1.0] CGColor];

    return textfield;
} 
```

现在，我在另一个类中使用 UIView 调用此函数。但它没有在屏幕上显示我的文本字段：

```
- (void)viewDidLoad
{

    [super viewDidLoad];
    // Do any additional setup after loading the view.
    SubtaskGenerator *scg = [[SubtaskGenerator alloc]init];
    UITextField * textfield = [scg generateTextField];

    [self.view addSubview:textfield];
} 
```

我必须以其他方式进行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T09:46:38.047

它确实在那里，但你看不到它。默认 UITextField 边框宽度为 0.0，因此您将看不到它或它框起的文本字段。只需将此行添加到 generateTextField 函数：

```
 textfield.layer.borderWidth = 2.0; 
```

# python - Python避免了需要两个可调用的键的lambda（函数组合）

> ID：13219320
> 
> 赞同：5
> 
> 时间：2012-11-04T14:17:33.333
> 
> 标签：python, lambda, key, max

我正在研究[项目欧拉问题 14](http://projecteuler.net/problem=14)，作为第一次尝试，我提出了这个蛮力解决方案：

```
def collatz(n, memo={1: [1]}):
    if n not in memo:
        memo[n] = [n] + collatz(3 * n + 1 if n % 2 else n // 2)
    return memo[n]

def p014():
    return max(xrange(1, 10**6), key=lambda n: len(collatz(n))) 
```

我的问题是关于那个 lambda，我通常不愿意使用它们，但在这种情况下我不知道有什么优雅的方法可以避免它。是否有一些东西`functools`可以链接两个可调用对象，或者我缺少任何其他简洁的替代方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T14:27:29.080

如果有一个`compose`函数，那就太好了——也许在`functools`. 没有，我也不期望会有，[唉](http://bugs.python.org/issue1506122)。用雷蒙德·海廷格的话来说，

> 之前已经在其他论坛讨论过并拒绝了。问题之一是通常的数学顺序是不直观的并且不是自我记录的——即与or`compose(f,g)` 相同？此外，创建自己的合成功能或直接进行合成已经很简单了： .`f(g(x))``g(f(x))``h = lambda x: f(g(x))`

以下是作为可调用类的两个简单[实现](http://code.activestate.com/recipes/52902-function-composition/)`compose`，您可能会发现它们很有用：

```
# Scott Daniels, http://code.activestate.com/recipes/52902-function-composition/
# Lightly edited for style.
class Compose(object):
    '''Compose functions. compose(f,g,x...)(y...) = f(g(y...),x...))'''
    def __init__(self, f, g, *args, **kwargs):
        self.f = f
        self.g = g
        self.pending = args[:]
        self.kwargs = kwargs.copy()

    def __call__(self, *args, **kwargs):
        return self.f(self.g(*args, **kwargs), *self.pending, **self.kwargs)

class Starcompose:
    '''Compose functions. Starcompose(f,g,x...)(y...) = f(*g(y...),x...))'''
    TupleType = type(())

    def __init__(self, f, g, *args, **kwargs):
        self.f = f
        self.g = g
        self.pending = args[:]
        self.kwargs = kwargs.copy()

    def __call__(self, *args, **kwargs):
        mid = self.g(*args, **kwargs)
        if isinstance(mid, self.TupleType):
            return self.f(*(mid + self.pending), **self.kwargs)
        return self.f(mid, *self.pending, **self.kwargs) 
```

另外，请参阅[`functional`](http://pypi.python.org/pypi/functional/0.7.0)包，它启发[`compose_many`](https://stackoverflow.com/a/6393208/577088)了我不久前的这个非常简单的功能：

```
def compose(f1, f2):
    def composition(*args, **kwargs):
        return f1(f2(*args, **kwargs))
    return composition

def compose_many(*funcs):
    return reduce(compose, funcs) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T14:43:20.237

把它写成生成器可能更 Pythonic：

```
def p014():
    length, n = max(
        (len(collatz(n)), n)
        for n in xrange(1, 10**6)
    )
    return n 
```

# wpf - 在 WPF 中仅使用 XAML 将元素定位在 Canvas 内的中心（而不是左上角）

> ID：13219321
> 
> 赞同：14
> 
> 时间：2012-11-04T14:17:51.043
> 
> 标签：wpf, xaml, canvas, centering

关于在 a 中定位元素的常见问题`Canvas`是“如何定位元素的中心（而不是左上角）”。

*   [WPF：调整圆的大小，保持中心点而不是 TopLeft？](https://stackoverflow.com/questions/3423834/wpf-resizing-a-circle-keeping-the-center-point-instead-of-topleft)
*   [WPF X, Y 处的中心椭圆](https://stackoverflow.com/questions/5422897/wpf-center-ellipse-at-x-y)
*   [画布上的 WPF 元素定位](https://stackoverflow.com/questions/3682111/wpf-element-positioning-on-a-canvas)

提出了几种解决方案，但它们都有缺点。

`Canvas.Left`最简单的解决方案是在以编程方式设置和`Canvas.Top`属性期间适应元素大小。这有效，但只有一次。此解决方案不支持绑定，并且在更改元素大小时会中断。您也不能设置`Canvas.Left`或`Canvas.Top`使用

另一组解决方案涉及使用`RenderTransform`或的平移转换`Margin`。这些解决方案需要将一些属性绑定到`-0.5 * Width`or `-0.5 * Height`。此类绑定需要创建自定义`ValueConverter`并且仅使用 XAML 是不可能创建的。

**那么，有没有一种简单的方法可以在画布内定位元素，以便它`Canvas.Left`与`Canvas.Top`元素的中心相对应，并且大小和位置属性都可以绑定到其他一些属性？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T14:17:51.043

*XAML 和绑定看起来非常强大，但有时一些简单的问题需要非常复杂的解决方案。在我的绑定库中，创建这样的绑定就像编写`element.Center = position`or一样简单`element.TopLeft = position - element.Size / 2`，但不要让我得意忘形。*

我找到了一个非常简单的解决方案，它只使用 XAML 并支持绑定元素的大小和位置属性。似乎当 WPF 控件也设置了对齐`Stretch`或`Center`放置在画布内时，元素“倾向于”作为`(Canvas.Left, Canvas.Top)`点居中（我们想要的状态），但被放置在同`(Canvas.Left, Canvas.Top)`一点的“角板”停止. 我怎么知道这个“万有引力”？`Margin`当您通过将元素的 设置为负值来缓和块时，这一点很明显。设置负边距允许元素向其中心目标移动。元素移动直到`Margin`到达`(-Height / 2, -Width / 2)`，使元素完全居中在`(Canvas.Left, Canvas.Top)`观点。进一步的更改不会导致任何移动，因为元素已经完美定位。

**解决方案：设置`Margin="-1000000"`.**

所以在下面的代码中，椭圆都以 (200, 200) 点为中心。第一个椭圆具有对应于椭圆中心`Left`的`Top`属性，可以轻松地将它们与其他一些对象的属性绑定。

```
<Canvas>
    <Ellipse Width="100" Height="100" Canvas.Left="200" Canvas.Top="200" Opacity="0.5" Fill="Red" Margin="-100000" />
    <Ellipse Width="100" Height="100" Canvas.Left="150" Canvas.Top="150" Opacity="0.5" Fill="Blue" />
</Canvas> 
```

不好的是这个解决方案只适用于 WPF。Silverlight 和 WinRT 没有所描述的行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T15:33:11.587

至少对于 Shapes 来说，更简单的是使用带有适当几何图形的路径：

```
<Canvas>
    <Path Canvas.Left="200" Canvas.Top="200" Fill="Red" Opacity="0.5">
        <Path.Data>
            <EllipseGeometry RadiusX="50" RadiusY="50"/>
        </Path.Data>
    </Path>
</Canvas> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-26T05:07:47.580

我通过将画布放入 2x2 网格的右下角单元格来解决这个问题。这使得 0,0 坐标成为网格的中心，然后您可以相对于它进行所有绘图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-24T19:58:26.360

该解决方案对我[有用 在 WPF Canvas 上的给定点居中文本](https://stackoverflow.com/questions/9778294/center-text-at-a-given-point-on-a-wpf-canvas)。他使用 MultiBinding 和自定义 Converter 来调整元素的边距。杰出的！

# magento - 在 magento 标题的快速访问链接上添加块下拉链接（菜单）

> ID：13219334
> 
> 赞同：0
> 
> 时间：2012-11-04T14:19:14.093
> 
> 标签：magento

我想在标题链接（快速访问）上添加一个新的下拉链接（菜单），并在客户登录时在其上移动链接在快速访问时显示此下拉链接，当客户是客人时不显示或注销，当客户登录时，将客户名称显示为下拉链接的主题。对于这种情况，我现在该怎么办？我为下拉块制作静态块并删除注销、我的愿望清单、我的帐户从 page.xml 上的 top.links 并在标题上调用静态块但我不知道如何避免向所有客户显示（阵风或日志in) 和我测试的另一种方式我想在标签中调用 local.xml 上的静态块，但我不知道如何调用静态块 静态块上的另一个问题我不能使用 php 代码，我不使用 getWelcome() ？>下拉链接的主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:00:07.127

1.  您不能在静态块中使用 php 代码，因此您需要创建自己的模板文件。
2.  如果您创建自己的模板文件，您可以使用：

    ```
    <?php if (Mage::getSingleton('customer/session')->isLoggedIn()): ?>
        //put Welcome message with $this->getWelcome() or anything you needed
        <?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('your_indentifer')->toHtml() ?>
    <?php else: ?>
       //if needed, display something for not logged-in usersY here 
     <?php endif; ?> 
    ```

3.  您还可以`<customer_logged_in></customer_logged_in>`在 local.xml 中使用 node 而不是 isLoggedIn() 方法来添加您的 .phtml 模板或 statick 块（请注意，它是顶级节点，不应包含在`<default>`节点中）

# mysql - mysql中的CloudFoundry vcap负载平衡

> ID：13219337
> 
> 赞同：0
> 
> 时间：2012-11-04T14:19:42.443
> 
> 标签：mysql, load-balancing, cloud-foundry

有谁知道云铸造中的mysql（vcap.me，不是cloudfoundry.com）如何进行负载平衡？

我的意思是，Cloud Foundry 可以自动接受这个吗？或者我们需要做一些事情来手动发送我们的数据？

非常感谢你能给我一些建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T18:07:05.003

到目前为止，还没有对 MySQL 的多个实例之间的负载平衡或集群的支持。这可能是未来版本考虑的功能。

# javascript - 在 jQuery 中克隆和扩展对象？

> ID：13219344
> 
> 赞同：1
> 
> 时间：2012-11-04T14:20:30.073
> 
> 标签：javascript, object, extend

好的，这是我想要做的基础知识：

```
var Hi = function(name){
    this.name = name;
};

Hi.prototype = {
    message: function(){
        $('body').append('Hi '+this.name);
    }
};

var hi = new Hi('There '); 
```

效果很好，但现在我想复制它，这样我就可以把它改成“再见”，

```
var Bye = Hi;
Bye.prototype.message = function(){
    $('body').append('Bye '+this.name);
};

var bye = new Bye('There'); 
```

所以然后得到`Hi There Bye There`我认为这应该工作的输出：

```
hi.message();
bye.message(); 
```

但是输出`Bye There Bye There`又是我的修改覆盖了原始对象。

我怎样才能让它按我的预期工作？注意，jQuery/jQuery UI 解决方案很好，但我想要一个香草和一个 jQuery 版本来了解发生了什么！

我的代码的jsFiddle：http: [//jsfiddle.net/YGa7p/](http://jsfiddle.net/YGa7p/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:47:15.230

线

```
var Bye = Hi; 
```

确实只是引用您的原始功能，它不会复制。通常你会

```
var Hi = function(name){
    this.name = name;
};

Hi.prototype.message = function() {
    $('body').append('Hi '+this.name);
};

var Bye = function(name){
    Hi.call(this, name); // re-call base constructor
};

Bye.prototype = new Hi(); // create base object

// overwrite Hi's message
Bye.prototype.message = function() {
    $('body').append('Bye '+this.name);
};

var hi = new Hi("there");
var bye = new Bye("there");

// See also instanceof:

// hi instanceof Hi      // true
// hi instanceof Object  // true

// bye instanceof Bye    // true
// bye instanceof Hi     // true
// bye instanceof Object // true 
```

[http://jsfiddle.net/YGa7p/1/](http://jsfiddle.net/YGa7p/1/)。

在 JavaScript 中，很难进行 OOP。要制作派生对象，使用“简单”方法会遇到麻烦，至少在第 3 级...n 继承中。如果您对 javaScript 中的扩展继承感兴趣，请阅读我关于[V javaScript 类函数的文章。](http://metadea.de/V/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:21:34.427

为原型实例化新对象。这解决了这个问题。像 Bye.prototype=new Hi();

```
 var Hi = function(name) {
    this.name = name;
};

Hi.prototype = {
    message: function() {
        $('body').append('Hi ' + this.name);
    }
};

var hi = new Hi('There ');

var Bye = Hi;
Bye.prototype=new Hi();
Bye.prototype.message = function() {
    $('body').append('Bye ' + this.name);
};

var bye = new Bye('There');

hi.message();
bye.message();​ 
```

# javascript - 在javascript中向单个数组项添加多个值

> ID：13219348
> 
> 赞同：4
> 
> 时间：2012-11-04T14:20:48.323
> 
> 标签：javascript, arrays, global-variables

我想，我在输出数组时遇到了麻烦。

我希望输出看起来像：

```
1\. FirstName LastName DOB 
```

但我最终得到的是：

```
1\. FirstName
2\. LastName
3\. DOB 
```

这是我到目前为止所拥有的，但我没有看到我做错了什么。

```
// global variable:
var tasks = []; 

// Function called when the form is submitted.
// Function adds a task to the global array.
function addTask() {
    'use strict';

    // Get the task:
    var firstName = document.getElementById('firstName');
    var lastName = document.getElementById('lastName');
    var dob = document.getElementById('dob');

    // numerical value of dob
    var dateofBirth = new Date(dob.value);

    // Reference to where the output goes:
    var output = document.getElementById('output');

    // For the output:
    var message = '';

    if (firstName.value && lastName.value && dob.value) {

        // Add the item to the array:
        tasks.push(firstName.value, lastName.value, dateofBirth.toString());

        // Update the page:
        message = '<h2>Persons Entered</h2><ol>';
        for (var i = 0, count = tasks.length; i < count; i++) {
            message += '<li>' + tasks[i] + '</li>';
        }
        message += '</ol>';
        output.innerHTML = message;

    } // End of IF.

    // Return false to prevent submission:
    return false;

} // End of addTask() function.

// Initial setup:
function init() {
    'use strict';
    document.getElementById('theForm').onsubmit = addTask;
} // End of init() function.
window.onload = init; 
```

谢谢，我希望这可以帮助你帮助我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T14:24:24.567

```
tasks.push({firstName: firstName.value, lastName: lastName.value, DOB: dateofBirth.toString()}) 
```

进而

```
tasks[0].firstName will output firstName.value
tasks[0].lastName will output lastName.value 
```

ETC..

编辑

使用它，您可以像这样构建您的消息：

```
for (var i = 0, count = tasks.length; i < count; i++) {
    message += '<li><span>' + tasks[i].firstName + '</span><span> ' 
    + tasks[i].lastName + '</span><span>' + tasks[i].DOB + '</span></li>';
} 
```

当然，span 标签是可选的，但这将允许您将样式应用于 css 中信息的每个部分（宽度、填充等），并且您将始终能够通过以下方式轻松选择任务的属性指数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:26:14.043

您的问题是您正在向`li`数组中的每个元素添加元素，而不是只添加一次 teh li

```
 // Update the page:
    message = '<h2>Persons Entered</h2><ol><li>' + tasks.join(' ') + '</li></ol>';
    output.innerHTML = message; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:26:41.827

为什么你把每个元素都放在自己的位置`<li>`？

如果你不把它放在不同的地方，`<li>`而是放在一个共同的地方，一切都会好起来的

```
message = '<h2>Persons Entered</h2><ol><li>';

        for (var i = 0, count = tasks.length; i < count; i++) {
            message += tasks[i];
            message += " ";
        }
        message += '</li></ol>';
        output.innerHTML = message; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T14:26:12.470

使用跨度。你可以使用 Array.join

```
output.innerHTML= '<h2>Persons Entered</h2><div><span>' + tasks.join("</span> <span>") +"</span>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T14:27:05.493

您想将它们作为数组添加到数组中，而不是作为值添加到数组中

你有的是这样的：

```
tasks.push(firstName.value, lastName.value, dateofBirth.toString()); 
```

我认为你想要的是：

```
tasks.push([firstName.value, lastName.value, dateofBirth.toString()]); 
```

[上面](https://stackoverflow.com/a/13219375/565514)的答案是相同的，但使用的是对象，而不是数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-04T14:27:58.463

您正在做的是将多个值推送到您的数组中。您要做的是将不同的值转换为单个值，然后将该值推送到您的数组中。要获得您请求的确切输出，您可以通过将这些值连接成一个字符串来将它们转换为一个：

改变这个：

```
tasks.push(firstName.value, lastName.value, dateofBirth.toString()); 
```

进入这个：

```
tasks.push(firstName.value + ' ' + lastName.value + ' ' + dateofBirth.toString()); 
```

但是，这确实意味着您将无法访问各个值。如果你想访问这些，你可以将它们组装成一个对象：

```
tasks.push({"firstName" : firstName.value,
            "lastName" : lastName.value,
            "dateOfBirth" : dateofBirth.toString()); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-04T14:28:30.850

你在问什么有点令人困惑。如果你只是想要这个：

```
1\. FirstName LastName DOB 
```

对此：

```
1\. FirstName
2\. LastName
3\. DOB 
```

那么您的问题不在于数组，而在于您如何定义循环代码。试试这个：

```
// Update the page:
message = '<h2>Persons Entered</h2><ol><li>';
for (var i = 0, count = tasks.length; i < count; i++) {
    message += tasks[i] + ' ';
}
message += '</li></ol>'; 
```

这样，您将数组元素放在单个列表元素中，而不是跨越三个元素。

* * *

**编辑 - 用于多维数组遍历**

这是假设数组是这样定义的（根据[Dan Steingart 的](https://stackoverflow.com/a/13219397/705055)回答）：

```
tasks.push([firstName.value, lastName.value, dateofBirth.toString()]); 
```

然后我们可以有以下内容：

```
// Update the page:
message = '<h2>Persons Entered</h2><ol>';

for (var i = 0, count = tasks.length; i < count; i++) {
    message += '<li> + tasks[i].toString().replace(',',' ') + '</li>';
}

message += '</ol>'; 
```

在这里，您正在遍历的每个元素`tasks`本身`tasks`也是一个数组。内部`toString()`数组上的 将以逗号分隔的方式显示值，然后该`replace()`函数只需将逗号替换为空格。

# c++ - 如何通过 QString 和 Qt 的其他隐式共享数据结构产生内存泄漏

> ID：13219350
> 
> 赞同：0
> 
> 时间：2012-11-04T14:21:02.180
> 
> 标签：c++, qt

QString和Qt的很多数据结构都是隐式共享的

我怎么能让他们的内存泄漏？

如果是shared_ptr，循环依赖会导致内存泄漏 QString 和其他类似QString 的数据结构在Qt 内存中也会泄漏吗？我想知道如何使 QString 的内存泄漏，这样我就不会陷入它的陷阱。

经过一番研究，看起来我不必担心它是QString时的循环依赖？感谢您的回复，现在我不必担心了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T14:13:09.903

在 4 之前的 Qt 版本中，对共享相同数据的 QString 的两个副本的并发访问可能会导致问题，因为 QString 是 COW 但没有锁定引用计数。这是一个问题。从版本 4 开始，引用计数是使用解决问题的原子处理的。您可以通过将一些东西放入其中来破坏一些 Qt 容器，这些东西可能会放在奇怪的地方，但我想不出一种可能影响 QString 的方法。警惕 Qt 中的异常处理，文档非常模糊，这通常意味着要小心；）

[http://doc-snapshot.qt-project.org/4.8/exceptionsafety.html](http://doc-snapshot.qt-project.org/4.8/exceptionsafety.html)

如果您在运行 Qt 时内存不足，预计世界会结束，在这种情况下，QString 是否泄漏可能并不重要。

# c# - 在 Visual Studio 解决方案资源管理器中将菜单项添加到 .cs 文件（仅）？

> ID：13219351
> 
> 赞同：2
> 
> 时间：2012-11-04T14:21:07.990
> 
> 标签：c#, visual-studio-2010, visual-studio-addins

我想在 VS 2010 的解决方案资源管理器中向 .cs 文件添加上下文菜单项？我可以将它添加到项目中，但不仅可以添加到 .cs 文件中吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-18T01:43:49.370

在您的`OnBeforeQueryStatus`方法中，您需要获取当前选择的对象并确定文件类型，然后您可以为`MenuCommand`.

要启用`OnBeforeQueryStatus`，您需要将以下属性添加到您的包中：

```
[ProvideAutoLoad(Microsoft.VisualStudio.Shell.Interop.UIContextGuids.SolutionExists)]
public sealed class YourPackage : Package 
```

然后在您的命令构造函数中，您需要将回调绑定到`BeforeQueryStatus`：

```
... 
    var commandService = this.ServiceProvider.GetService(typeof(IMenuCommandService)) as OleMenuCommandService;
    if (commandService == null) return;
    var menuCommandId = new CommandID(CommandSet, CommandId);
    var menuItem = new OleMenuCommand(this.MenuItemCallback, menuCommandId);
    menuItem.BeforeQueryStatus +=
        new EventHandler(OnBeforeQueryStatus);
    commandService.AddCommand(menuItem);
... 
```

OnBeforeQuery 状态：

```
private void OnBeforeQueryStatus(object sender, EventArgs e)
{
    var myCommand = sender as OleMenuCommand;
    if (null == myCommand) return;
    var selectedObject = Util.GetProjectItem();
    myCommand.Visible = selectedObject.Name.EndsWith(".cs") && this.Enabled;
} 
```

获取项目项：

```
public static ProjectItem GetProjectItem()
{
    IntPtr hierarchyPointer, selectionContainerPointer;
    Object selectedObject = null;
    IVsMultiItemSelect multiItemSelect;
    uint projectItemId;

    var monitorSelection =
        (IVsMonitorSelection)Package.GetGlobalService(
            typeof(SVsShellMonitorSelection));

    monitorSelection.GetCurrentSelection(out hierarchyPointer,
        out projectItemId,
        out multiItemSelect,
        out selectionContainerPointer);

    var selectedHierarchy = Marshal.GetTypedObjectForIUnknown(
        hierarchyPointer,
        typeof(IVsHierarchy)) as IVsHierarchy;

    if (selectedHierarchy != null)
    {
        ErrorHandler.ThrowOnFailure(selectedHierarchy.GetProperty(
            projectItemId,
            (int)__VSHPROPID.VSHPROPID_ExtObject,
            out selectedObject));

    }
    return selectedObject as ProjectItem;
} 
```

有了所有这些，您应该只在以结尾的项目文件上看到您的按钮`.cs`

# ruby-on-rails - Rails：如何检查 access_token 是否过期？

> ID：13219352
> 
> 赞同：0
> 
> 时间：2012-11-04T14:21:17.437
> 
> 标签：ruby-on-rails, access-token

我正在为带有rails的android应用程序编写一个api。由于我对 rails 和 android 都是新手，所以我无法弄清楚 access_token 的东西。

我有一个 Token 模型，每次用户登录时，都会在 tokens 表中添加一个新的 access_token。我的问题是，如果我在创建令牌后设置过期日期 == 3 天，那么当用户发送带有 access_token 的请求时，验证这一点的正确方法是什么？如何删除那些过期的令牌？

这是我的代币模型：

```
# Table name: tokens
#
#  id           :integer          not null, primary key
#  access_token :string(255)
#  user_id      :integer
#  created_at   :datetime         not null
#  updated_at   :datetime         not null

class Token < ActiveRecord::Base
  attr_accessible   :access_token, :user_id
  before_validation :generate_access_token
  belongs_to        :user

  validates :access_token, presence: true, uniqueness: true
  validates :user_id,      presence: true, uniqueness: true

private

  def generate_access_token
    begin
      self.access_token = SecureRandom.hex
    end while self.class.exists?(access_token: access_token)
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:26:56.007

您可以`expires_at`向 Token 模型添加一列来处理它。您还需要一种检索新令牌的方法，该方法可以更新现有令牌的密钥和过期时间，或者您可以为用户生成新的令牌记录并将其返回。后者更多是 Facebook 为其访问令牌所采用的方法。

# android - 我在哪里可以下载 MotoDev Studio？

> ID：13219353
> 
> 赞同：3
> 
> 时间：2012-11-04T14:21:31.330
> 
> 标签：android, motorola-droid, motodev-studio

在新的摩托罗拉网站中，我找不到任何指向 MotoDev Studio 的链接。我在去年使用它，现在它似乎消失了。

你知道我在哪里可以找到最后的构建吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T14:24:07.600

他们不再支持 MotoDev 工作室。这与从谷歌购买后的重组有关。

我不确定是否要下载旧版本，但摩托罗拉不再积极开发此版本（并解雇了大部分从事此工作的团队）。

您可能会搜索“MOTODEV Core Plugins”，因为他们将工作室重命名为 - 但您可能不想再使用这些工具，因为它们不再受到支持。

# html - 从特定 DIV 中删除所有 CSS

> ID：13219362
> 
> 赞同：5
> 
> 时间：2012-11-04T14:23:27.500
> 
> 标签：html, css

> **可能重复：**
> [取消继承（重置）特定元素的 CSS 样式？](https://stackoverflow.com/questions/9515534/disinherit-reset-the-css-style-of-a-specific-element)

我有一个页面加载具有不同 CSS 属性的外部 CSS 文件。

是否可以在同一页面内创建一个元素，并且专门针对该元素不加载任何 CSS？

例如：

```
<style type="text/css">
p {
    background-color:#000000;
    width:550px;
}
</style>
<p>This should get the P styling from the style tag</p>
<p>This should NOT get the P styling</p> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:41:19.720

正如其他人所说，通常有更好的方法来隔离元素。但是，也有用于此目的的 CSS 选择器。

见[否定伪类](http://www.w3.org/TR/selectors/#negation)

## HTML

```
<p>A paragraph</p>
<p class="nostyle">Don't style me</p>
<p>A paragraph</p>
<p>A paragraph</p> 
```

## CSS

```
P:not(.nostyle) { color: red; } 
```

示例：http: [//jsfiddle.net/LMDLE/](http://jsfiddle.net/LMDLE/)

这*很少*是正确的解决方案，但它对于处理难以与另一个选择器匹配的边缘情况很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:36:22.493

这正是类的设计目的。

```
<style type="text/css">
.class1{
background-color:#000000;
width:550px;
}
</style>
<p class="class1">This should get the P styling from the style tag</p>
<p>This should NOT get the P styling</p> 
```

为了记录，不要使用 class1 之类的名称，仅用于演示。对有意义的类使用描述性名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:39:17.940

您可以肯定地隔离您想要样式的 P：

```
<p class="hasStyle"></p
<p></p> 
```

或者你可以覆盖那些你想保持无样式的：

```
<style>
p {
    background-color:#000000;
    width:550px;
}

.noStyle {
 background-color: none;
 width: none /* or whatever you want here */;
}
</style>

<p>has a style</p>
<p class="noStyle"></p> 
```

后者更难维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T14:37:59.833

正如我所评论的，*使用类、ID 和伪选择器有什么问题？*

例如，这很好用：

```
p:first-child {
    background-color:#000000;
    width:550px;
} 
```

一样

```
.first {background-color: #000; width: 550px;}

<p class="first">Some styled text</p>
<p>Some default text</p> 
```

# c# - 如何使用 c# 或 XNA 测量声音频率？

> ID：13219365
> 
> 赞同：0
> 
> 时间：2012-11-04T14:23:48.113
> 
> 标签：c#, xna-4.0, audio

如何使用 c# 或 XNA 测量声音频率？有图书馆做吗？我想录制声音并识别这种声音的频率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:45:30.033

你说*的*频率是什么意思？大多数声音，例如语音、音乐等，都包含整个频谱。因此，您实际上要寻找的是[频谱分析仪](http://en.wikipedia.org/wiki/Spectrum_analyzer)。可以使用快速傅里叶变换 (FFT) 计算这样的频谱。完成此操作后，您可以在频谱中寻找主频率（如果有的话）。

您可能需要查看[NAudio](http://naudio.codeplex.com/)和相关库（例如[WPF Sound Visualizer](http://wpfsvl.codeplex.com/)），以了解如何在 C# 中完成此操作。还有一篇[CodeProject 文章](http://www.codeproject.com/Articles/154625/Professional-Audio-Recorder)使用 XNA 捕获麦克风输入，然后使用 NAudio 进行进一步处理。虽然那篇文章中的示例是针对 Windows Phone 的，但我想它也应该在稍加修改的桌面应用程序中工作。

# javascript - 使用 jQuery 删除类的正确方法

> ID：13219367
> 
> 赞同：2
> 
> 时间：2012-11-04T14:24:00.603
> 
> 标签：javascript, jquery, css, performance, frontend

我有一个很让我感兴趣的简单问题：如果我想用 jQuery 删除一个 CSS 类，那么正确的方法是什么？1.检查类是否存在后删除？

```
if($(div).hasClass('css-class')) {
  $(div).removeClass('css-class');
} 
```

2.只是删除它？

```
$(div).removeClass('css-class'); 
```

3.还有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T14:25:04.090

只需将其删除。如果元素没有您要删除的类，jQuery 不会抛出错误（或类似的东西）。

```
$(div).removeClass('css-class'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:35:25.270

对于使用 jquery 删除类，我更喜欢第一个选项来检查特定 dom 元素的类是否存在，然后删除应用于该 DOM 元素的类，即使 jquery 不会抛出任何错误，即使该 DOM 元素尚未应用于该类

例如

```
 if($(div).hasClass('css-class')) {
   $(div).removeClass('css-class');
 } 
```

# php - 静态链接页面的 URL mod_rewrite

> ID：13219376
> 
> 赞同：0
> 
> 时间：2012-11-04T14:24:24.870
> 
> 标签：php, url, mod-rewrite

如何使用 mod_rewrite 实现这一点？

```
from:
.com/index.php?menu=home
to:
.com/home 
```

和

```
from:
.com/index.php?menu=home&list=hello
to:
.com/home/hello 
```

ALSO（没有文件夹 hierarki）

```
from:
.com/index.php?menu=home&list=hello
to:
.com/hello 
```

我将它用于第一个：

```
 RewriteRule ^([^/\.]+)/?$ index.php?menu=$1 [L] 
```

但是如果有多个变量，我如何连接它们？

试过这个：

```
RewriteRule ^([^/]*)/([^/]*)?$ index.php?home=$1&list=$2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:59:14.473

您误解了应该如何进行 URL 重写。当您使用该`MVC`模式时，您的 URL 会告诉框架/引导程序要执行哪个控制器和方法。因此，您的 URL 应该类似于：`http://host.com/CONTROLLER/ACTION/what/ever`. 这就是为什么你不能`.com/index.php?menu=home&list=hello`重写为`.com/hello`. 没有办法区分什么时候`http://host.com/hello`是 a什么时候是`controller`一个`action`（控制器类的方法）。

下面的代码将重写：

1.  `.com/whatever`作为`.com/index.php?menu=whatever`
2.  `.com/whatever/youwant`作为`.com/index.php?menu=whatever&list=youwant`
3.  `.com/whatever/youwant/with/additional/parameters`作为`.com/index.php?menu=whatever&list=youwant&additional=$5`.

.

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)([/])?([^/]*)?([/])?(.*)$ index.php?menu=$1&list=$3&additional=$5 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:36:36.667

很多令人头疼的问题，为什么不创建**1**条规则并将路由传递给您的脚本，然后使用 explode() 来拆分和定义：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?route=$1 [L,QSA] 
```

然后在你的 PHP

```
<?php 
$route = explode('/',$_GET['route']);

$menu = (!empty($route[0])?:null);
$list = (!empty($route[1])?:null);
?> 
```

顺便说一句，你的第三个例子是不可能的。

# javascript - jquery 行高动态调整大小

> ID：13219379
> 
> 赞同：1
> 
> 时间：2012-11-04T14:25:09.267
> 
> 标签：javascript, jquery, html, css

有一个用于列动态调整大小的 jquery 插件 - colResizable: [http://quocity.com/colresizable/](http://quocity.com/colresizable/)。

行高动态调整大小是否有类似的插件？

![例子](../Images/8bf8773f4ede394347b93f7760fc21e4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T16:49:46.823

也许[Jquery UI Resizable](http://jqueryui.com/resizable/)可以为您实现这一目标。我从来没有用过它，但它似乎可以工作。

您也可以在单元级别执行此操作。

# python - py2exe 未正确编译 VideoCapture

> ID：13219380
> 
> 赞同：4
> 
> 时间：2012-11-04T14:25:32.397
> 
> 标签：python, pygame, py2exe

我创建了一个使用您的网络摄像头拍照的程序。

我使用了 Pygame 和 VideoCapture。这一切都可以作为`.pyw`文件正常工作，但是在使用 py2exe 编译后它就不起作用了。

根据我的研究，错误来自尝试编译 VideoCapture 模块。请帮帮我！！！（Pyinstaller 也会出现同样的错误）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:31:34.350

你试过用 cx_freeze 编译吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-15T17:36:49.827

嘿伙计们，我终于可以使用 cx_freeze 制作一个可执行文件，该文件可以与相机一起使用，解决方案是您应该将 vidcapture.pyd 复制到包含您的程序的文件中

[这张图片是我的文件，它有 vidcapture.pyd](https://i.stack.imgur.com/Njur0.png)

# r - 世界地图 - 将国家的一半映射为不同的颜色

> ID：13219387
> 
> 赞同：21
> 
> 时间：2012-11-04T14:26:08.643
> 
> 标签：r, map, ggplot2

我在这里使用示例进行讨论： [ggplot map with l](https://stackoverflow.com/questions/9558040/ggplot-map-with-l)

```
library(rgdal)
library(ggplot2)
library(maptools)

# Data from http://thematicmapping.org/downloads/world_borders.php.
# Direct link: http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip
# Unpack and put the files in a dir 'data'

gpclibPermit()
world.map <- readOGR(dsn="data", layer="TM_WORLD_BORDERS_SIMPL-0.3")
world.ggmap <- fortify(world.map, region = "NAME")

n <- length(unique(world.ggmap$id))
df <- data.frame(id = unique(world.ggmap$id),
                 growth = 4*runif(n),
                 category = factor(sample(1:5, n, replace=T)))

## noise
df[c(sample(1:100,40)),c("growth", "category")] <- NA

ggplot(df, aes(map_id = id)) +
     geom_map(aes(fill = growth, color = category), map =world.ggmap) +
     expand_limits(x = world.ggmap$long, y = world.ggmap$lat) +
     scale_fill_gradient(low = "red", high = "blue", guide = "colorbar") 
```

给出以下结果： ![在此处输入图像描述](../Images/6c44c59ff599cbf62b62704ed5144271.png)

我想将一个变量映射到一个国家的左侧“一半”，并将一个不同的变量映射到该国家的右侧“一半”。我将“一半”放在引号中，因为它没有明确定义（或者至少我没有明确定义它）。Ian Fellows 的回答可能会有所帮助（这提供了一种获取质心的简单方法）。我希望有一些东西可以`aes(left_half_color = growth, right_half_color = category)`在这个例子中做。如果不同的话，我也对上半部分和下半部分感兴趣。

如果可能的话，我还想将两半的各个质心映射到某个东西。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-07T11:56:31.260

这是一个不`ggplot`依赖于`plot`函数的解决方案。`rgeos`除了 OP 中的代码之外，它还需要该包：

**立即编辑**，视觉疼痛减少 10%

**编辑 2**现在有东半部*和*西半部的质心

```
library(rgeos)
library(RColorBrewer)

# Get centroids of countries
theCents <- coordinates(world.map)

# extract the polygons objects
pl <- slot(world.map, "polygons")

# Create square polygons that cover the east (left) half of each country's bbox
lpolys <- lapply(seq_along(pl), function(x) {
  lbox <- bbox(pl[[x]])
  lbox[1, 2] <- theCents[x, 1]
  Polygon(expand.grid(lbox[1,], lbox[2,])[c(1,3,4,2,1),])
})

# Slightly different data handling
wmRN <- row.names(world.map)

n <- nrow(world.map@data)
world.map@data[, c("growth", "category")] <- list(growth = 4*runif(n),
                 category = factor(sample(1:5, n, replace=TRUE)))

# Determine the intersection of each country with the respective "left polygon"
lPolys <- lapply(seq_along(lpolys), function(x) {
  curLPol <- SpatialPolygons(list(Polygons(lpolys[x], wmRN[x])),
    proj4string=CRS(proj4string(world.map)))
  curPl <- SpatialPolygons(pl[x], proj4string=CRS(proj4string(world.map)))
  theInt <- gIntersection(curLPol, curPl, id = wmRN[x])
  theInt
})

# Create a SpatialPolygonDataFrame of the intersections
lSPDF <- SpatialPolygonsDataFrame(SpatialPolygons(unlist(lapply(lPolys,
  slot, "polygons")), proj4string = CRS(proj4string(world.map))),
  world.map@data)

##########
## EDIT ##
##########
# Create a slightly less harsh color set
s_growth <- scale(world.map@data$growth,
  center = min(world.map@data$growth), scale = max(world.map@data$growth))
growthRGB <- colorRamp(c("red", "blue"))(s_growth)
growthCols <- apply(growthRGB, 1, function(x) rgb(x[1], x[2], x[3],
  maxColorValue = 255))
catCols <- brewer.pal(nlevels(lSPDF@data$category), "Pastel2")

# and plot
plot(world.map, col = growthCols, bg = "grey90")

plot(lSPDF, col = catCols[lSPDF@data$category], add = TRUE) 
```

![在此处输入图像描述](../Images/76ca005634548c088b44c11e522a1516.png)

也许有人可以使用`ggplot2`. 但是，基于对有关单个图形的多个填充比例的问题的[回答](http://osdir.com/ml/ggplot2/2012-01/msg00116.html)（“你不能”），如果`ggplot2`没有分面，解决方案似乎不太可能（这可能是一个好方法，如上面的评论中所建议的那样）。

* * *

**编辑重新：将两半**的质心映射到某物：东（“左”）半的质心可以通过以下方式获得

```
coordinates(lSPDF) 
```

西（“右”）半部分可以通过`rSPDF`以类似方式创建对象来获得：

```
# Create square polygons that cover west (right) half of each country's bbox
rpolys <- lapply(seq_along(pl), function(x) {
  rbox <- bbox(pl[[x]])
  rbox[1, 1] <- theCents[x, 1]
  Polygon(expand.grid(rbox[1,], rbox[2,])[c(1,3,4,2,1),])
})

# Determine the intersection of each country with the respective "right polygon"
rPolys <- lapply(seq_along(rpolys), function(x) {
  curRPol <- SpatialPolygons(list(Polygons(rpolys[x], wmRN[x])),
    proj4string=CRS(proj4string(world.map)))
  curPl <- SpatialPolygons(pl[x], proj4string=CRS(proj4string(world.map)))
  theInt <- gIntersection(curRPol, curPl, id = wmRN[x])
  theInt
})

# Create a SpatialPolygonDataFrame of the western (right) intersections
rSPDF <- SpatialPolygonsDataFrame(SpatialPolygons(unlist(lapply(rPolys,
  slot, "polygons")), proj4string = CRS(proj4string(world.map))),
  world.map@data) 
```

然后可以根据`lSPDF`或的质心在地图上绘制信息`rSPDF`：

```
points(coordinates(rSPDF), col = factor(rSPDF@data$REGION))
# or
text(coordinates(lSPDF), labels = lSPDF@data$FIPS, cex = .7) 
```

# javascript - 如何在 JavaScript 中触发隐藏的 JSF commandLink？

> ID：13219391
> 
> 赞同：1
> 
> 时间：2012-11-04T14:26:20.697
> 
> 标签：javascript, jsf-2, facelets, managed-bean

[我在这个线程](https://stackoverflow.com/questions/13206421/why-click-event-working-fine-in-firefox-but-not-ie)上有一个类似的问题，我有一个 JavaScript 函数，它将触发一个 hidden 的点击事件`commandLink`。隐藏命令将触发 Java Bean 中的操作。此代码在 IE 中运行良好，但在 Firefox 中运行良好。关于这个问题有什么线索吗？

**JavaScript**

```
<h:outputScript target="head">
    HTMLElement.prototype.click = function() {
    var evt = this.ownerDocument.createEvent('MouseEvents');
    evt.initMouseEvent('click', true, true, this.ownerDocument.defaultView, 1, 0, 0, 0, 0, false, false, false, false, 0, null);
    this.dispatchEvent(evt);
  }

  function triggerHiddenEvent() {
    alert("triggerHiddenEvent is trigger");
    document.getElementById("theForm:hiddenCommand").click();
  }
</h:outputScript> 
```

**XHTML**

```
<h:form id="theForm">
  <h:commandLink id="tri_HiddenEvent" value="Trigger Hidden Event" onclick="triggerHiddenEvent"/>

  <p style="display:none">
    <h:commandLink id="hiddenCommand" styleClass="button" action="#{helloBean.doHiddenCommand}"/>
  </p>
  ... 
```

**豆子**

```
@ManagedBean
@SessionScoped
public class HelloBean implements Serializable {
  public String doHiddenCommand() {
    System.out.println("doHiddenCommand is called");
    return "";
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:05:34.860

改变

`onclick="triggerHiddenEvent"`

进入

`onclick="triggerHiddenEvent(); return false;"`

您需要添加`return false;`代码段以阻止页面提交/重新加载...

> h:commadLink 标签：
> 
> 此标签生成 HTML 的 `<a href`链接标签和一些 JavaScript 函数，这些函数使链接充当提交按钮。为防止页面提交，您必须`return false;`在 onclick 函数中显式添加 simple

[JSF 中 h:commandButton 、 h:commandLink 和 h:outputLink 之间的区别](http://www.skill-guru.com/blog/2009/09/07/difference-between-hcommandbutton-hcommandlink-and-houtputlink-in-jsf/)

# php - Ajax 不显示服务器响应

> ID：13219395
> 
> 赞同：0
> 
> 时间：2012-11-04T14:26:59.680
> 
> 标签：php, jquery

我正在尝试建立一个订阅表单。我不能在我的网站上运行 php，并且我不希望用户离开主网站来订阅时事通讯。我[将此示例用作服务器端](https://gist.github.com/1488819)。如果您尝试输入电子邮件，即使电子邮件已添加到 mailchimp 列表，您也会被重定向并显示错误消息。

```
<div id="email">
<span>Your email..</span>
<form action="http://simondahla.com/jolliassets/notify.php" id="notify" method="POST">
    <input type="text" placeholder="your@email.com" name="email" id="address" data-validate="validate(required, email)"/>
    <span>We'll never spam or give this address away</span>
    <button type="submit">&#187;</button>
</form>
<span id="result"></span> 
```

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#notify').submit(function() {
        var action = $(this).attr('action');
        $.ajax({
            url: action,
            type: 'POST',
            data: {
                email: $('#address').attr('value')
            },
            success: function(data){
                $('#result').html(data).css('color', 'green');
            },
            error: function() {
                $('#result').html('Sorry, an error occurred.').css('color', 'red');
            }
        });
    });
});
</script> 
```

[问题的活生生的例子](http://jsfiddle.net/FAmFF/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:29:30.223

您需要`false`从您的提交处理程序返回。这是为了防止浏览器执行默认操作，即以正常方式提交表单。

```
$('#notify').submit(function() {
   // .. your ajax call
   return false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:50:00.413

从您的 PHP 函数中，您将根据代码的成功或失败返回所需的值。

成功：

```
print json_encode(array("status"=>"success","message"=>'Successfully added')); 
```

失败的：

```
print json_encode(array("status"=>"error","message"=>'There was an error')); 
```

然后在 HTML 中返回该消息，如下所示：

```
success: function(data){
            $('#result').html(content.message).css('color', 'green');
        },
        error: function() {
            $('#result').html(content.message).css('color', 'red');
        } 
```

# c++ - 类型定义和强制转换

> ID：13219400
> 
> 赞同：5
> 
> 时间：2012-11-04T14:27:26.460
> 
> 标签：c++, casting, typedef

`typedef`似乎是 C++ 特定的（也许在其他一些语言中）。我发现它隐藏了值的真实数据类型，因此使项目新手感到困惑。也许有时缩短打字时间很有用。您建议什么时候使用`typedef`？

我还注意到我不能将 typedef-ed 值传递给接受基础类型的函数？

就像是：

```
typedef string VAL;
VAL s = "x";
func(string x); // if I try to pass `s`, I get something like no instance of function template match argument list 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:43:31.980

`typedef`是用于从现有类型创建新类型的 C 和 C++ 语言标签。最好的地方是将它与具有以下示例的结构的 C 编程语言一起使用，或者使用它从现有的原始类型（短、长等）创建一个新的、更抽象的类型。

```
typedef struct {
    int iValue;
    int jValue;
} MyValues;
// declare a variable with this struct
MyValues aMyValuesStruct; 
```

在将 typedef 引入 C 之前，为了将上述结构用作类型，您必须执行以下操作：

```
struct _MyValuesStruct {
    int iValue;
    int jValue;
};
// declare a variable with this struct
struct _MyValuesStruct aMyValuesStruct; 
```

在 C++ 中，结构和类是创建新类型的类似结构，因此`typedef`对于这些类型的变量没有那么有用。但是，如果您使用内置的原始类型来表示其他更抽象的类型，那么 typedef 语句可以帮助您以更抽象的方式指定类型。

这种使用`typedef`使得为类型指定标签变得更加容易，因此当程序员阅读源代码时，他们可以理解特定变量代表什么。例如，如果您有一个颜色值`unsigned short`变量`typedef`适合`unsigned short`.

还允许的是`typedef`，它可以更容易地找到源中使用特定抽象类型的所有位置，并且更容易更改底层类型。例如，如果您的颜色值类型以字节开始，因此您`typedef`用来创建抽象类型，例如`typedef unsigned char ColorValue;`，然后您发现需要将其从 an`unsigned char`更改`unsigned short`为该类型的使用相当严格，这将是您需要进行更改的唯一地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:31:43.247

> 也许有时缩短打字时间很有用。什么时候推荐使用 typedef？

一个很好的用例是当您希望能够在不编辑代码库的情况下重新映射类型：

```
typedef int32_t pixel_t; 
```

另一个是您希望类型更明确，以便代码的使用变得更清晰：

```
typedef int distance_t;

typedef int angular_momentum_t; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:42:57.430

您的问题在另一个[问题](https://stackoverflow.com/questions/516237/when-should-i-use-typedef-in-c)中得到了回答。

`typedef`s 对于抽象实现细节很有用（在 C 和 C++ 中，也许还有 Objective-C？）。将类型隐藏到程序中不需要知道类型是如何实现的部分是一种很好的做法，以避免由于与其功能无关的问题而污染代码，并且可以更容易地更改类型实现而不不得不更改该代码。

如果在可能的情况下隐藏了不必要的细节，那么该项目的新手可能会发现处理代码实际上更容易。

至于你的问题，`func(string x);`是函数原型声明，而不是函数调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T15:00:24.120

`typedef`在某些情况下，用于隐藏表示数据的基础类型。

例如，标准未指定 a 的典型大小`short int`，`int`或者`long int`是，这可能是一个问题。另一方面，实现应该（现在）提供`int8_t`、`int16_t`和（`int32_t`并且`int64_t`可能`int128_t`取决于平台），以便您可以拥有具有已知值范围的整数。

但什么是`int32_t`？嗯，它是一个有符号整数，宽度为 32 位。它可以是`char`, `short int`, `int`,`long int`或`long long int`理论上的任何一个……这无关紧要：*它是一个实现细节*。

因此，在您的标准库头文件中的某个时刻，您会看到：

```
typedef int int32_t; // most likely representation 
```

这个定义是基于平台的。

在您的代码中，使用可以`int32_t`让您摆脱那些可怕的平台特性，专注于手头的业务：*您的业务*。

# java - 在哪里以及如何开始实现一个在文本文件中搜索短语示例“红色或绿色”的 Java 程序，

> ID：13219403
> 
> 赞同：0
> 
> 时间：2012-11-04T14:27:51.480
> 
> 标签：java

我想实现一个 Java 程序，它在文本文件中搜索短语示例“red or green, blue car, red and blue”，并返回一个匹配，即使它不是该短语的完全匹配，如果没有即使是半场比赛，程序也不应该返回任何比赛。

如果我正在搜索“红色汽车”并且文本文件中的字符串行包含“红色和蓝色”，我希望程序返回红色，这是我正在搜索的一半匹配。

很感谢任何形式的帮助

这就是我到目前为止所做的，所做的就是找到确切的单词

```
public class StringSearch 
   {
    public static void main(String[] args) 
      {
        String key = "red yellow";
        String strLine;
        try
          {
    FileInputStream fstream = new FileInputStream("C:\\textfile.txt");
    DataInputStream in = new DataInputStream(fstream);
          BufferedReader br = new BufferedReader(new InputStreamReader(in));
    while ((strLine = br.readLine()) != null) {    
          if(key.equals(strLine))
         {
          System.out.println(" Match For " + strLine );
        }
        else 
         {
         System.out.println( "No Match For "   + key);

        }
     // Print the content on the console
    }
        //Close the input stream
        in.close();

        }catch (Exception e){//Catch exception if any
            System.err.println("Error: " + e.getMessage());
        }
    }
} 
```

但我想找到的是，如果我正在搜索“red”并且我正在搜索的文本文件中字符串的第一行包含“red car was stollen”，而第二行只包含“red”。我想返回两个匹配项，第一个匹配 100%，第二个匹配 50%。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:34:43.617

首先，您需要更好地定义您的问题，并为此考虑如果您告诉其他人（按照字面意思解释事情），您会怎么做。他们一次应该检查多少输入？他们应该检查跨度线吗？究竟什么是“半场比赛”？他们应该采取的步骤顺序是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:36:30.343

此代码可能对您有所帮助

```
import java.io.*;

public class searchfile {
    public static void main(String args[]) {
        try {
            // Open the file c:\test.txt as a buffered reader
            BufferedReader bf = new BufferedReader(new FileReader("c:\\test.txt"));

            // Start a line count and declare a string to hold our current line.
            int linecount = 0;
                String line;

            // Let the user know what we are searching for
            System.out.println("Searching for " + args[0] + " in file...");

            // Loop through each line, stashing the line into our line variable.
            while (( line = bf.readLine()) != null)
            {
                    // Increment the count and find the index of the word
                    linecount++;
                    int indexfound = line.indexOf(args[0]);

                    // If greater than -1, means we found the word
                    if (indexfound > -1) {
                         System.out.println("Word was found at position " + indexfound + " on line " + linecount);
                    }
            }

            // Close the file after done searching
            bf.close();
        }
        catch (IOException e) {
            System.out.println("IO Error Occurred: " + e.toString());
        }
    }
} 
```

并将其运行为 `c:\>java searchfile "bluecar"`

# java - 根据鼠标位置旋转三角形多边形？

> ID：13219408
> 
> 赞同：0
> 
> 时间：2012-11-04T14:28:33.713
> 
> 标签：java, rotation, mouse

我正在用 Java 编写自己的多人游戏；我需要根据鼠标位置旋转三角形多边形的帮助。我有这个三角形，它代表角色，玩家可以单击鼠标右键，子弹将从船的顶部发射（我指定为顶部的那个点），但我想要玩家的旋转（三角形），用于瞄准等，由鼠标控制以及它在屏幕上的位置。我该怎么做呢，我想展示一个动画，它也相对于鼠标所在的位置旋转，而不仅仅是出现在那里。

额外：还有一件事，在那之后，我很可能希望将鼠标锁定在屏幕上，这样它就不会掉线。如何将鼠标锁定在屏幕中央？

我正在使用`drawPolygon`来自的方法`java.awt.Graphics`，也许这是最好的方法？

# matlab - MATLAB：不可见的图形手柄在 Windows 和 Linux 上的行为不同？

> ID：13219413
> 
> 赞同：3
> 
> 时间：2012-11-04T14:29:25.740
> 
> 标签：matlab, matlab-figure

我一直认为，在 MATLAB 中，一个图形句柄`X`，其属性`HandleVisibility`设置为任何其他值，而不是`on`在使用`findobj(h)`或作为. 然而，这似乎只在 Windows 下才成立，而在 Linux 下则不然。我在 Debian 6.0.6（挤压）和 Windows 7 上都使用 MATLAB R2011b。如果我在 Windows 下运行以下代码：`get(h, 'Children')``h``X`

```
figure;plot(randn(1,1000));
h = get(gcf, 'Children'); 
```

然后我在 中得到一个句柄`h`，它对应于包含我的随机图的轴。这是我所期望的。但是，如果我在 Linux 中运行完全相同的代码，则`h`包含 10 个句柄的数组。实际上，这些句柄中的大多数只是 UI 元素，其`HandleVisibility`属性设置为`off`. 例如：

```
get(h(end), 'Type')   % returns: 'uitoolbar'
get(h(end), 'HandleVisibility') % returns 'off' 
```

这种明显不一致的行为是否有原因？这可以被其他人复制吗？如果可能相关，我使用的 Debian 服务器运行 Sun JAVA 1.6.0_26，这不是 Debian (openJDK) 的默认设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:53:46.203

我无法使用 Sun JAVA 在 r2011a 或 r2012b 上进行复制。

一种解决方法可能是根据可见性进行过滤：

```
visibleChildren = findobj(get(h,'children'),'HandleVisibility','on') 
```

听起来像是特定于您的安装的东西。

# ios - 如果我的 JSON 未加载，是否显示 UIAlertView？

> ID：13219415
> 
> 赞同：0
> 
> 时间：2012-11-04T14:29:48.663
> 
> 标签：ios, error-handling, uialertview

这是我的问题。如果我的应用无法加载远程 JSON 文件，我该如何显示错误？我在我的电脑上关闭了我的 wifi 并在模拟器中运行了应用程序。如果有连接，它 NSLogs 应该显示的消息。我怎样才能解决这个问题？谢谢。

这是我的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSString *jsonStr = @"http://xxx.com/server.php?json=1";
    NSURL *jsonURL = [NSURL URLWithString:jsonStr];
   // NSData *jsonData = [NSData dataWithContentsOfURL:jsonURL];
   // NSError *jsonError = nil;
    NSURLRequest *jsonLoaded = [NSURLRequest requestWithURL:jsonURL];

    if(!jsonLoaded) {

        UIAlertView *alertView = [[UIAlertView alloc] init];
        alertView.title = @"Error!";
        alertView.message = @"A server with the specified hostname could not be found.\n\nPlease check your internet connection.";
        [alertView addButtonWithTitle:@"Ok"];
        [alertView show];
        [alertView release];
        NSLog(@"No connection, JSON not loaded...");

    }
    else {
        NSLog(@"JSON loaded and ready to process...");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:06:09.067

您的代码只是创建请求。它实际上并没有获取数据。您需要使用`NSURLConnection`来获取数据。

有多种方法可以获取数据。此示例适用于 iOS 5.0 或更高版本：

```
NSOperationQueue *q = [[[NSOperationQueue alloc] init] autorelease];
NSURLRequest *jsonRequest = [NSURLRequest requestWithURL:jsonURL];
[NSURLConnection sendAsynchronousRequest:jsonRequest
                                   queue:q
                       completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                           // data was received
                           if (data)
                           {
                               NSLog(@"JSON loaded and ready to process...");
                               // ... process the data
                           }
                           // No data received
                           else
                           {
                               NSLog(@"No connection, JSON not loaded...");
                               // ... display your alert view
                           }
                       }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:50:58.317

你实际上还没有请求任何东西。阅读[此处](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html#//apple_ref/doc/uid/20001836-BAJEAIEE)了解如何提出请求。

基本上，您要做的是实现[NSURLConnectionDelegate](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/NSURLConnectionDelegate)协议并覆盖`connection:didFailWithError:`函数以侦听失败事件。

# android - Android 服务通信

> ID：13219416
> 
> 赞同：0
> 
> 时间：2012-11-04T14:29:54.030
> 
> 标签：android, listview, service

我正在编写一个运行与远程服务器通信的后台服务的应用程序。当服务器向我发送新消息时，我需要更新 UI 中表示的对象，然后更新 UI 视图以表示对象的新状态（例如，如果对象的背景属性为真 - 设置背景的视图为绿色，如果为假，则将视图的背景设置为红色）。

我正在使用列表视图来显示所有这些对象的所有 ArrayList 抛出一个 ArrayAdapter。

我有一个用于静态引用的 Application 对象（名为 app），并且我有一个 CurrentActivity 属性，用于存储当前正在运行的活动（如果 UI 关闭，则为 null）。

我正在使用此代码来更新 UI：

在我的服务中：

```
onNewMessage(boolean backgruond)
{
  if (app.getCurrentActivity != null)
     app.getCurrentActivity.onNewMessage(background);
} 
```

在我的活动中：

```
onNewMessage(boolean background)
{
  object.setBackground(bacground);
  Log.d("Background", String.valueof(background));
  runOnUiThread(new Runnable() {
      @Override
      public void run()
      {
        arrayAdapter.notifyDataSetChanged();
      }
  });
} 
```

尽管 Log 返回了正确的背景状态，但视图并没有通过 notifyDataSetChanged() 刷新；

我试图向 Activity throw BroadcastRecevier 发送消息，但它要复杂得多，因为我有很多来自服务器的消息，我将不得不注册许多接收器。此外 - 我不明白为什么接收器会工作而这个机制不会..

更新 ListView 的工作方法示例：

ListViewActivity - 从 BaseActivity 继承：

```
@Override
public void onUnFriend(FacebookUser facebookUser, boolean isYouRemovedClient) 
{               
    super.onUnFriend(facebookUser, isYouRemovedClient);
    updateView();
} 
```

BaseActivity（继承Activity的超类）：

```
public void onUnFriend(FacebookUser facebookUser, boolean isYouRemovedClient)
{                           
    facebookUser.setApplicationFriend(false);
    app.getApplicationFriends().remove(facebookUser);
    app.getDatabaseManager().deleteApplicationFriend(facebookUser.getId());     
    if (isYouRemovedClient)
        app.showToast(facebookUser.getName() + " has removed from your friends", true);
    else
        app.showToast(facebookUser.getName() + " has removed you from friends", true);
} 
```

这一个有效并且确实改变了 ListView 中的背景颜色。

不工作示例 ListViewActivity：

```
@Override
public void onFriendRequestAccepted(FacebookUser facebookUser, boolean showDialog) {
    super.onFriendRequestAccepted(facebookUser, showDialog);
    updateView();
} 
```

基本活动：

```
public void onFriendRequestAccepted(FacebookUser facebookUser, boolean showDialog) 
{   
    facebookUser.setApplicationFriend(true);
    app.getApplicationFriends().add(facebookUser);
    app.getDatabaseManager().addApplicationFriend(facebookUser);
    if (showDialog)
        app.showNewEventActivity(facebookUser, EventDialogManager.EVENT_FRIEND_ACCEPTED);
} 
```

没有更新……我真的不明白为什么……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:09:19.807

> 我有一个 CurrentActivity 属性，它存储当前正在运行的活动（如果 UI 关闭，则为 null）

我不推荐这种做法。它依赖于您一致且可靠地更新该`Application`数据成员，并且它增加了您的服务和您的 UI 之间的耦合。

> 尽管 Log 返回了正确的背景状态，但视图并没有通过 notifyDataSetChanged() 刷新；

您似乎没有更改适配器中的数据。当然，代码中没有证据表明您在此处更新了适配器中的数据。

顺便说一句，您在此处显示的代码片段都不太可能编译（第一个不是有效的 Java，第二个有错字）。

> 我有很多来自服务器的消息，我将不得不注册许多接收者

不，您必须注册一个接收者，并在`onReceive()`中使用`if`语句（或者`switch`，如果您愿意，也可以使用 ）将一条消息与另一条消息区分开来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:56:36.757

除了 CommonsWare 所说的，我假设`object`您的第一行`onNewMessage`是视图。`setBackround`接受一个`int`参数，而不是一个`boolean`.

用于`0xFF00FF00`绿色和`0xFFFF0000`红色。

顺便说一句，保留`Context`对象及其派生类的静态引用是一种非常糟糕的做法（`Application`并且`Activity`都派生自`Context`，并且保留它们的静态引用可能会导致严重的内存泄漏。阅读更多[here](http://android-developers.blogspot.co.il/2009/01/avoiding-memory-leaks.html)。）

改用 a `BroadcastReceiver`。与您描述它们的方式相比，它们要简单得多-您只需要一个。

# node.js - 如何填充地图减少的结果

> ID：13219420
> 
> 赞同：1
> 
> 时间：2012-11-04T14:30:31.990
> 
> 标签：node.js, mongodb, mongoose

```
TestSessionSchema.statics.getTopTesters = function(callback){
    var o = {};
    o.map = function(){
        emit(this._customer, this.points);
    };

    o.reduce = function(_customer, values){
        var result = {_customer: _customer, sum_points: 0, };
        values.forEach(function(point){
            result.sum_points += point;
        });
        return result;
    };

    o.out = { replace: 'createdCollectionNameForResults' };
    o.verbose = true;

    this.mapReduce(o,function(err, model, stats){
        model.find().sort({'value.sum_points': "desc"}).limit(5).populate("_customer").exec(function(error, results){

            log(results);

        })
    });

} 
```

在 map-reduce 部分，我得到了 _customers 的积分。

现在我想填充 _customer 以获取客户的信息 `model.find().sort({'value.sum_points': "desc"}).limit(5).populate("_customer")`不起作用

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:05:54.010

当您在 MongoDB 中执行 mapReduce 时，您必须确保您的发出值与您的 reduce 返回值具有相同的格式。

这意味着在您的情况下，如果`map`调用`emit(customer, points)`then`reduce`必须仅返回`points`.

要更改您的具体示例，您的 map 函数是可以的，但您的 reduce 函数应该是：

```
reduce = function(_customer, values) {
        var result =  0;
        values.forEach(function(point){
            result += point;
        });
        return result;
    }; 
```

然后，您的 reduce 函数将汇总每个 _customer 的所有值（点），这就是您想要的。输出将是 _customer，作为带有字段名称的键值对指向`_id`，`value`其中 value 将是该 _id (_customer) 的所有点值的总和。

要查询您将运行的结果：

`db.createdCollectionNameForResults.find().sort({value:-1}).limit(5)`

# seo - 运行具有相同配置文件的多个网站

> ID：13219421
> 
> 赞同：0
> 
> 时间：2012-11-04T14:30:47.897
> 
> 标签：seo, social-networking

就搜索流量而言，在同一个细分市场中维护多个网站是否是一种不好的做法。例如，使用来自 twitter、facebook 和 g+ 的同一组社交资料，并在与笔记本电脑购物相关的两个网站上使用它们。

我很想知道使用和不使用社交分享对搜索流量的影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:39:10.133

根本不是 SEO 的坏习惯。您可能会因重复内容而受到处罚，但社交资料不会这样做。每天都更重要的是，在社交网络中的影响只是为了获得更多的声誉和更多的流量。您的 Google+ 个人资料就可以了，您的个人资料将作为作者得到改善。很快，作者的声誉将变得很重要，如果您作为作者的位置很好，那么如果您的网站没有良好的 SEO 位置，那么您将合作的网站将拥有更好的声誉。我希望它会对你有所帮助。

# http - 使用 Fiddler 在 localhost 上捕获 SOAP 消息

> ID：13219423
> 
> 赞同：4
> 
> 时间：2012-11-04T14:31:13.567
> 
> 标签：http, soap, fiddler

当我的 Java 客户端向我的本地 Tomcat 实例发出 SOAP 请求时，我无法捕获本地 HTTP 流量。

**我目前的配置是**

*   Tomcat 实例 - 在 localhost:8080 上运行
*   本地 Java 客户端 - 从 Windows cmd 行运行
*   Fiddler - 在 localhost:8888 上运行

我使用 Axis2`wsdl2java`创建我的客户端 SOAP 存根，并在指定 WSDL（托管在 Tomcat 上）时使用我的机器 IP 地址

```
wsdl2java -uri http://192.168.0.5:8080/axis2/services/Version?wsdl -p sample.axisversion -d adb -s 
```

因此，生成的代码在整个过程中都有这样的行：

```
 public VersionStub(org.apache.axis2.context.ConfigurationContext configurationContext) throws org.apache.axis2.AxisFault {
    this(configurationContext,"http://192.168.0.5:8080/axis2/services/Version.VersionHttpSoap12Endpoint/" );
} 
```

我的客户端应用程序使用生成的存根，并使用以下代码（在实际使用 SOAP 存根之前调用）将 Java 代理设置为 Fiddler：

```
System.getProperties().put("proxySet", "true");
System.getProperties().put("proxyHost", "localhost");
System.getProperties().put("proxyPort", "8888"); 
```

...但我仍然没有在 Fiddler 中看到任何请求或响应流量。少了什么东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T04:19:57.623

而不是`localhost`，请尝试使用`ipv4.fiddler`，这可以确保您的本地主机流量通过提琴手。另见：[http ://www.fiddler2.com/Fiddler/Help/hookup.asp#Q-LocalTraffic](http://www.fiddler2.com/Fiddler/Help/hookup.asp#Q-LocalTraffic)

# php - 从 Zend Bootstrap 重定向？

> ID：13219426
> 
> 赞同：3
> 
> 时间：2012-11-04T14:31:31.443
> 
> 标签：php, zend-framework

> **可能重复：**
> [有没有办法从 Zend 框架中的引导程序重定向浏览器？](https://stackoverflow.com/questions/926361/is-there-a-way-to-redirect-the-browser-from-the-bootstrap-in-zend-framework)

我正在尝试在引导文件中重定向...

```
$this->_redirector->gotoUrl($url); 
```

我收到此错误：

```
Fatal error: Call to a member function gotoUrl() on a non-object 
```

如何从引导程序调用 gotoUrl()？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:50:33.913

```
 $frontController = Zend_Controller_Front::getInstance();
    $response = new Zend_Controller_Response_Http();
    $response->setRedirect('/');
    $frontController->setResponse($response); 
```

# node.js - node.js require("mongodb") 抛出异常

> ID：13219429
> 
> 赞同：1
> 
> 时间：2012-11-04T14:32:13.037
> 
> 标签：node.js, mongodb

我是新手`node.js`（但有 10 年的 C# 经验）我有以下代码

```
var http = require("http");
var url = require("url");
var path = require('path');
var fs = require("fs");
var express = require("express");
var mongo = require("./node_modules/mongo");
var Server = mongo.Server;
var Db = mongo.Db;
var server = new Server('localhost', 27017, {auto_reconnect: true});
var db = new Db('mydb', server); 
```

我得到这个例外：

> 错误：找不到模块“./node_modules/mongo”
> 
> ```
> at Function.Module._resolveFilename (module.js:338:15) 
> ```

我也试过：

```
var mongo = require("mongo"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:34:07.133

试试这个：

```
var mongodb = require('mongodb'); 
```

# iphone - 使用 RubyMotion 单击按钮时如何加载控制器？

> ID：13219433
> 
> 赞同：1
> 
> 时间：2012-11-04T14:32:51.443
> 
> 标签：iphone, ios, ruby, uiviewcontroller, rubymotion

假设我有 2 个控制器 A 和 B。

在 AI 中有：

```
def viewDidLoad
  super
  button = UIButton.buttonWithType UIButtonTypeRoundedRect
  button.setTitle "Open B", forState: UIControlStateNormal
  button.addTarget(self, action: :open_b, forControlEvents: UIControlEventTouchUpInside)
  self.view.addSubview button
end

def open_b
  # ?????
end 
```

在 BI 中有另一种观点，有自己的逻辑，这并不重要。

**我想在单击按钮时打开 B。我应该怎么去做？**

对于具有一定 iOS 经验的任何人来说，这一定是显而易见的，但我找不到你应该怎么做。任何指针表示赞赏。Objectve-C 中的解决方案是可以接受的，并且会得到我的支持，即使我更希望它与 RubyMotion 一起使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T17:01:20.667

以下是使用模态视图控制器的方法：

app_delegate.rb：

```
class AppDelegate
  def application(application, didFinishLaunchingWithOptions:launchOptions)
    @window = UIWindow.alloc.initWithFrame(UIScreen.mainScreen.bounds)
    @window.rootViewController = MyViewA.alloc.init
    @window.makeKeyAndVisible
    true
  end
end 
```

视图a.rb：

```
class MyViewA < UIViewController

  def viewDidLoad
    super
    button = UIButton.buttonWithType UIButtonTypeRoundedRect
    button.setTitle "Open B", forState: UIControlStateNormal
    button.frame = [[10, 50], [300, 50]]
    button.addTarget(self, action: "open_b", forControlEvents: UIControlEventTouchUpInside)
    self.view.addSubview button
  end

  def open_b
    view_b = MyViewB.alloc.init
    view_b.delegate = self
    self.presentViewController view_b, animated:true, completion:nil
  end

  def done_with_b
    self.dismissViewControllerAnimated true, completion:nil
  end

end 
```

视图b.rb：

```
class MyViewB < UIViewController

  attr_accessor :delegate

  def viewDidLoad
    super
    button = UIButton.buttonWithType UIButtonTypeRoundedRect
    button.setTitle "Return to A", forState: UIControlStateNormal
    button.frame = [[10, 50], [300, 50]]
    button.addTarget(self, action: "press_button", forControlEvents: UIControlEventTouchUpInside)
    self.view.addSubview button
  end

  def press_button
    delegate.done_with_b
  end

end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T15:32:52.413

这是有关如何执行此操作的示例：[https ://github.com/IconoclastLabs/rubymotion_cookbook/tree/master/ch_2/11_navbarbuttons](https://github.com/IconoclastLabs/rubymotion_cookbook/tree/master/ch_2/11_navbarbuttons)

具体来说，您的方法将使用这部分：

```
def performAdd
    @secondary_controller = SecondaryController.alloc.init
    self.navigationController.pushViewController(@secondary_controller, animated:'YES')
end 
```

每当您需要一些基础知识时，我强烈建议您参考这个 repo（是的，它是我的）！

[http://iconoclastlabs.github.com/rubymotion_cookbook/](http://iconoclastlabs.github.com/rubymotion_cookbook/)

希望对你有用！

# objective-c - 当我设置 mapCenterRegion 时，我如何知道该区域是否确实发生了变化？

> ID：13219434
> 
> 赞同：1
> 
> 时间：2012-11-04T14:32:57.197
> 
> 标签：objective-c, xcode4.5

我正在设置一个应该在以下情况下调用的动画：

1.  用户重新加载地图
2.  用户更改地图区域
3.  theMapView didAppear 被调用。

要处理 1 和 3，我有：

```
[self.theMapView setCenterCoordinate:[BGMDCachedProperties singleton].mapCenterLocation.coordinate animated:YES]; 
```

现在，我可以在那之后立即调用“doanimation”。

问题是如果 [self.theMapView setCenterCoordinate:[BGMDCachedProperties singleton].mapCenterLocation.coordinate animated:YES]; 更改区域然后 doanimation 将已经被调用。再次调用 doanimation 会使它被调用两次。

我希望 doanimation 被调用一次，而不是快速连续调用两次。

# node.js - 安装 testacular 时出错

> ID：13219435
> 
> 赞同：1
> 
> 时间：2012-11-04T14:33:02.453
> 
> 标签：node.js, angularjs, karma-runner

我正在关注 testatcular 视频教程[http://vojtajina.github.com/testacular/](http://vojtajina.github.com/testacular/)。

我安装了 nodejs，当我尝试安装 testacular 时

`sudo npm install -g testacular` 我收到此错误：

```
npm http GET https://registry.npmjs.org/testacular
npm http 304 https://registry.npmjs.org/testacular
npm http GET https://registry.npmjs.org/chokidar
npm http GET https://registry.npmjs.org/minimatch
npm http GET https://registry.npmjs.org/socket.io
npm http GET https://registry.npmjs.org/glob
npm http GET https://registry.npmjs.org/optimist
npm http 304 https://registry.npmjs.org/glob
npm http 304 https://registry.npmjs.org/socket.io
npm http 304 https://registry.npmjs.org/optimist
npm http 304 https://registry.npmjs.org/chokidar
npm http 304 https://registry.npmjs.org/minimatch

> chokidar@0.4.0 postinstall /usr/local/lib/node_modules/testacular/node_modules/chokidar
> node setup.js postinstall

npm ERR! error installing chokidar@0.4.0
npm WARN This failure might be due to the use of legacy binary "node" 
npm WARN For further explanations, please read
npm WARN /usr/share/doc/nodejs/README.Debian
npm WARN 
npm ERR! error installing testacular@0.0.17

npm ERR! Error: ENOENT, lstat '/usr/local/lib/node_modules/testacular/node_modules/___minimatch.npm/package/minimatch.js'
npm ERR! You may report this log at:
npm ERR!     <http://bugs.debian.org/npm>
npm ERR! or use
npm ERR!     reportbug --attach /home/adio/workspace/java/tutorial/angularJS/npm-debug.log npm
npm ERR! 
npm ERR! System Linux 3.5.0-17-generic
npm ERR! command "/usr/bin/nodejs" "/usr/bin/npm" "install" "-g" "testacular"
npm ERR! cwd /home/adio/workspace/java/tutorial/angularJS
npm ERR! node -v v0.6.19
npm ERR! npm -v 1.1.4
npm ERR! path /usr/local/lib/node_modules/testacular/node_modules/___minimatch.npm/package/minimatch.js
npm ERR! fstream_path /usr/local/lib/node_modules/testacular/node_modules/___minimatch.npm/package/minimatch.js
npm ERR! fstream_type File
npm ERR! fstream_class FileWriter
npm ERR! code ENOENT
npm ERR! message ENOENT, lstat '/usr/local/lib/node_modules/testacular/node_modules/___minimatch.npm/package/minimatch.js'
npm ERR! errno {}
npm ERR! fstream_stack Object.oncomplete (/usr/lib/nodejs/fstream/lib/writer.js:204:26)
npm ERR! error rolling back testacular@0.0.17 Error: ENOTEMPTY, rmdir '/usr/local/lib/node_modules/testacular/node_modules/___glob.npm/package/test'

npm ERR! chokidar@0.4.0 postinstall: `node setup.js postinstall`
npm ERR! `sh "-c" "node setup.js postinstall"` failed with 1
npm ERR! 
npm ERR! Failed at the chokidar@0.4.0 postinstall script.
npm ERR! This is most likely a problem with the chokidar package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node setup.js postinstall
npm ERR! You can get their info via:
npm ERR!     npm owner ls chokidar
npm ERR! There is likely additional logging output above.
npm ERR! 
npm ERR! System Linux 3.5.0-17-generic
npm ERR! command "/usr/bin/nodejs" "/usr/bin/npm" "install" "-g" "testacular"
npm ERR! cwd /home/adio/workspace/java/tutorial/angularJS
npm ERR! node -v v0.6.19
npm ERR! npm -v 1.1.4
npm ERR! code ELIFECYCLE
npm ERR! message chokidar@0.4.0 postinstall: `node setup.js postinstall`
npm ERR! message `sh "-c" "node setup.js postinstall"` failed with 1
npm ERR! errno {}
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /home/adio/workspace/java/tutorial/angularJS/npm-debug.log
npm not ok 
```

有人遇到这个问题吗？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T11:29:27.837

让我猜猜，它是否发生在 64 位 Win7 机器上？

我得到了同样的错误，它已经在[testacular github上报告了](https://github.com/vojtajina/testacular/issues/46)

我发现的唯一解决方法是安装 node.js 32 位而不是 64 位版本。我鼓励你在他们的 github 上发表另一条评论，所以也许会重新考虑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T16:11:07.940

正如错误日志所暗示的那样，问题出在版本中。在 Ubuntu 12.10 上使用 sudo apt-get install nodejs 安装 NodeJS 将导致安装 nodejs 0.6，但您需要 nodejs 版本 0.8 来安装 testacular 所以我按照本教程安装 nodejs 0.8

```
http://davidtsadler.com/archives/2012/05/06/installing-node-js-on-ubuntu/ 
```

# antlr - 我可以使用 antlr 解析部分数据吗？

> ID：13219438
> 
> 赞同：7
> 
> 时间：2012-11-04T14:34:04.700
> 
> 标签：antlr

我正在尝试使用 antlr 来解析日志文件。因为我只对部分日志感兴趣，所以我只想写一个部分解析器来处理重要的部分。

例如：我想解析段：

```
[ 123 begin ] 
```

所以我写了语法：

```
log :   
    '[' INT 'begin' ']'
    ;

INT : '0'..'9'+
    ;

NEWLINE
    : '\r'? '\n'
    ;

WS
    : (' '|'\t')+ {skip();}
    ; 
```

但是该段可能出现在一行的中间，例如：

```
 111 [ 123 begin ] 222 
```

根据讨论： [简单的ANTLR语法有什么问题？](https://stackoverflow.com/questions/13125935/what-is-the-wrong-with-the-simple-antlr-grammar) 我知道为什么我的语法无法处理上述语句。

我想知道，有没有办法让antlr忽略任何错误，继续处理剩余的文本？

感谢您的任何建议！莱昂

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T18:35:17.333

由于`'['`在 之外的某些情况下也可能会被跳过`[ 123 begin ]`，因此无法在词法分析器中处理此问题。您必须创建一个与要跳过的令牌匹配的解析器规则（请参阅`noise`规则）。

如果没有其他词法分析器规则匹配，您还需要创建一个匹配任何字符*的贯穿规则*`ANY`（请参阅规则）。

快速演示：

```
grammar T;

parse
    : ( log {System.out.println("log=" + $log.text);}
      | noise
      )*
      EOF
    ;

log : OBRACK INT BEGIN CBRACK
    ;

noise
    : ~OBRACK                  // any token except '['
    | OBRACK ~INT              // a '[' followed by any token except an INT
    | OBRACK INT ~BEGIN        // a '[', an INT and any token except an BEGIN
    | OBRACK INT BEGIN ~CBRACK // a '[', an INT, a BEGIN and any token except ']'
    ;

BEGIN   : 'begin';
OBRACK  : '[';
CBRACK  : ']';
INT     : '0'..'9'+;
NEWLINE : '\r'? '\n';
WS      : (' '|'\t')+ {skip();};
ANY     : .; 
```

# perl - 查找未使用的“已使用”Perl 模块

> ID：13219442
> 
> 赞同：14
> 
> 时间：2012-11-04T14:34:38.940
> 
> 标签：perl, module

我正在研究一个非常大、非常古老的“历史悠久”的代码库。过去经常有人想“哦，我可能需要这个那个模块，所以我只包含它......”，后来人们经常“缓存”模块内部的数据（“使用ThisAndThat”需要几个几秒钟就可以将几百 MB 从 DB 加载到 RAM，是的，这真是一个愚蠢的想法，我们也在努力）所以，我们经常有一个小模块使用 20 或 30 个模块，其中 90% 是在源本身中完全未使用，并且由于在几个使用的子模块中“缓存”，模块往往需要一分钟甚至更多的时间来加载，这当然是不可接受的。

所以，我试图把它做得更好。现在，我的方式是浏览所有模块，尽可能地理解它们，然后我会查看包括它们在内的所有模块，看看是否需要它们。

有没有更简单的方法？我的意思是：有些函数会返回一个模块喜欢的所有子类

```
...
return grep { defined &{"$module\::$_"} } keys %{"$module\::"} 
```

，那么，没有任何简单的方法可以查看哪些是默认导出的，哪些来自哪里并在其他模块中使用？

一个简单的例子是 Data::Dumper，它几乎包含在每个文件中，甚至当所有调试警告和打印等不再在脚本中时。但是模块仍然必须加载 Data::Dumper。

有什么简单的方法可以检查吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T16:40:43.510

以下代码可能是您解决方案的一部分 - 它会显示为每个实例导入了哪些符号`use`：

```
package traceuse;
use strict;
use warnings;
use Devel::Symdump;

sub import {
  my $class = shift;
  my $module = shift;

  my $caller = caller();

  my $before = Devel::Symdump->new($caller);

  my $args = \@_;
  # more robust way of emulating use?
  eval "package $caller; require $module; $module\->import(\@\$args)";

  my $after = Devel::Symdump->new($caller);

  my @added;
  my @after_subs = $after->functions;
  my %before_subs = map { ($_,1) } $before->functions;
  for my $k (@after_subs) {
    push(@added, $k) unless $before_subs{$k};
  }

  if (@added) {
    warn "using module $module added: ".join(' ', @added)."\n";
  } else {
    warn "no new symbols from using module $module\n";
  }
}
1; 
```

然后只需将“use module ...”替换为“use traceuse module ...”，您将获得已导入函数的列表。

使用示例：

```
package main;

sub foo { print "debug: foo called with: ".Dumper(\@_)."\n"; }

use traceuse Data::Dumper; 
```

这将输出：

```
using module Data::Dumper added: main::Dumper 
```

即，您可以分辨出哪些函数是以稳健的方式导入的。您可以轻松扩展它以报告导入的标量、数组和散列变量 - 检查`Devel::Symdump`.

确定实际使用哪些函数是等式的另一半。为此，您可能可以使用源代码的简单 grep 来逃脱 - 即确实`Dumper`出现在模块的源代码中，而不是在`use`一行中。这取决于您对源代码的了解。

笔记：

*   可能有一个模块可以执行 traceuse 的操作 - 我没有检查

*   可能有更好的方法来模拟另一个包中的“使用”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T14:55:31.067

我有点得到它与 PPI 合作。它看起来像这样：

```
#!/usr/local/bin/perl
use strict;
use warnings;

use Data::Dumper;
use Term::ANSIColor;

use PPI;
use PPI::Dumper;

my %doneAlready = ();
$" = ", ";

our $maxDepth = 2;
my $showStuffOtherThanUsedOrNot = 0;

parse("/modules/Test.pm", undef, undef, 0);

sub parse {
        my $file = shift;
        my $indent = shift || 0;
        my $caller = shift || $file;
        my $depth = shift || 0;

        if($depth && $depth >= $maxDepth) {
                return;
        }
        return unless -e $file;
        if(exists($doneAlready{$file}) == 1) {
                return;
        }
        $doneAlready{$file} = 1;
        my $skript = PPI::Document->new($file);

        my @included = ();

        eval {
                foreach my $x (@{$skript->find("PPI::Statement::Include")}) {
                        foreach my $y (@{$x->{children}}) {
                                push @included, $y->{content} if (ref $y eq "PPI::Token::Word" && $y->{content} !~ /^(use|vars|constant|strict|warnings|base|Carp|no)$/);
                        }
                }
        };

        my %double = ();

        print "===== $file".($file ne $caller ? " (Aufgerufen von $caller)" : "")."\n" if $showStuffOtherThanUsedOrNot;
        if($showStuffOtherThanUsedOrNot) {
                foreach my $modul (@included) {
                        next unless -e createFileName($modul);
                        my $is_crap = ((exists($double{$modul})) ? 1 : 0);
                        print "\t" x $indent;
                        print color("blink red") if($is_crap);
                        print $modul;
                        print color("reset") if($is_crap);
                        print "\n";
                        $double{$modul} = 1;
                }
        }

        foreach my $modul (@included) {
                next unless -e createFileName($modul);
                my $anyUsed = 0;
                my $modulDoc = parse(createFileName($modul), $indent + 1, $file, $depth + 1);
                if($modulDoc) {
                        my @exported = getExported($modulDoc);
                        print "Exported: \n" if(scalar @exported && $showStuffOtherThanUsedOrNot);
                        foreach (@exported) {
                                print(("\t" x $indent)."\t");
                                if(callerUsesIt($_, $file)) {
                                        $anyUsed = 1;
                                        print color("green"), "$_, ", color("reset") if $showStuffOtherThanUsedOrNot;
                                } else {
                                        print color("red"), "$_, ", color("reset") if $showStuffOtherThanUsedOrNot;
                                }
                                print "\n" if $showStuffOtherThanUsedOrNot;
                        }

                        print(("\t" x $indent)."\t") if $showStuffOtherThanUsedOrNot;
                        print "Subs: " if $showStuffOtherThanUsedOrNot;
                        foreach my $s (findAllSubs($modulDoc)) {
                                my $isExported = grep($s eq $_, @exported) ? 1 : 0;
                                my $rot = callerUsesIt($s, $caller, $modul, $isExported) ? 0 : 1;
                                $anyUsed = 1 unless $rot;
                                if($showStuffOtherThanUsedOrNot) {
                                        print color("red") if $rot;
                                        print color("green") if !$rot;
                                        print "$s, ";
                                        print color("reset");
                                }
                        }
                        print "\n" if $showStuffOtherThanUsedOrNot;
                        print color("red"), "=========== $modul wahrscheinlich nicht in Benutzung!!!\n", color("reset") unless $anyUsed;
                        print color("green"), "=========== $modul in Benutzung!!!\n", color("reset") if $anyUsed;
                }
        }

        return $skript;
}

sub createFileName {
        my $file = shift;
        $file =~ s#::#/#g;
        $file .= ".pm";
        $file = "/modules/$file";
        return $file;
}

sub getExported {
        my $doc = shift;

        my @exported = ();
        eval {
                foreach my $x (@{$doc->find("PPI::Statement")}) {
                        my $worthATry = 0;
                        my $isMatch = 0;
                        foreach my $y (@{$x->{children}}) {
                                $worthATry = 1 if(ref $y eq "PPI::Token::Symbol");
                                if($y eq '@EXPORT') {
                                        $isMatch = 1;
                                } elsif($isMatch && ref($y) ne "PPI::Token::Whitespace" && ref($y) ne "PPI::Token::Operator" && $y->{content} ne ";") {
                                        push @exported, $y->{content};
                                }
                        }
                }
        };

        my @realExported = ();
        foreach (@exported) {
                eval "\@realExported = $_";
        }

        return @realExported;
}

sub callerUsesIt {
        my $subname = shift;
        my $caller = shift;

        my $namespace = shift || undef;
        my $isExported = shift || 0;

        $caller = `cat $caller`;

        unless($namespace) {
                return 1 if($caller =~ /\b$subname\b/);
        } else {
                $namespace = createPackageName($namespace);
                my $regex = qr#$namespace(?:::|->)$subname#;
                if($caller =~ $regex) {
                        return 1;
                }
        }
        return 0;
}

sub findAllSubs {
        my $doc = shift;

        my @subs = ();

        eval {
                foreach my $x (@{$doc->find("PPI::Statement::Sub")}) {
                        my $foundName = 0;
                        foreach my $y (@{$x->{children}}) {
                                no warnings;
                                if($y->{content} ne "sub" && ref($y) eq "PPI::Token::Word") {
                                        push @subs, $y;
                                }
                                use warnings;
                        }
                }
        };

        return @subs;
}

sub createPackageName {
        my $name = shift;
        $name =~ s#/modules/##g;
        $name =~ s/\.pm$//g;
        $name =~ s/\//::/g;
        return $name;
} 
```

它真的很丑，也许不是 100% 工作，但似乎，通过我现在所做的测试，它对一个开始很有好处。

# r - 样本函数 R 不会产生均匀分布的样本

> ID：13219444
> 
> 赞同：4
> 
> 时间：2012-11-04T14:34:42.640
> 
> 标签：r, simulation, sample, random-sample

我正在创建一个调查。有 31 个可能的问题，我希望每个受访者回答 3 个子集。我希望它们以随机顺序进行管理。参与者不应两次回答相同的问题

我创建了一个包含参与者索引的表格矩阵，以及第一个、第二个和第三个问题的问题索引列。

使用下面的代码，索引 31 在我的示例中的代表性不足。

我认为我错误地使用了示例函数。我希望有人可以帮助我吗？

```
SgPassCode <- data.frame(PassCode=rep(0,10000), QIndex1=rep(0,10000),
  QIndex2=rep(0,10000), QIndex3=rep(0,10000))

set.seed(123)
for (n in 1:10000){
  temp <- sample(31,3,FALSE)
  SgPassCode[n,1] <- n 
  SgPassCode[n,-1] <- temp
}

d <- c(SgPassCode[,2],SgPassCode[,3],SgPassCode[,4])
hist(d) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T14:55:33.533

问题在于`hist`它挑选垃圾箱的方式和方式，而不是`sample`. 证明是 的输出`table`：

```
table(d)
#    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
# 1003  967  938  958  989  969  988  956  983  990  921 1001  982 1016 1013  959 
#   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31 
#  907  918  918  991  931  945  998 1017 1029  980  959  886  947  987  954 
```

如果你想`hist`“工作”，`hist(d, breaks = 0:31)`（当然还有很多其他的事情）会工作。

# object - 克隆 VBScript Err 对象

> ID：13219451
> 
> 赞同：0
> 
> 时间：2012-11-04T14:35:32.047
> 
> 标签：object, error-handling, vbscript, clone

下面的代码`Variable is undefined (500)`在尝试连接 echo 中的 error.no 时给出错误：

```
'Raise an error to represent an issue with the main code
err.raise 999

dim error
set error = err

'Call another function that could also throw an error
SendMail "To=me","From=me","Subject=Failure in main code"

'Report both errors
wscript.echo "First problem was - Error code:" & error & vbcrlf & "Subsequent problem was - Error code:" & err 
```

是否可以克隆 err 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:57:34.307

除了 Ekkehard.Horner，您还可以创建与错误对象具有相同行为的自定义错误类。因为 err 对象是全局的，所以您可以在类中加载它，而无需在方法中将其传递给它。

```
On error resume Next
a = 1 / 0
Set myErr = new ErrClone
On error goto 0

WScript.Echo myErr  
' returns 11, the default property
WScript.Echo myErr.Number & vbTab & myErr.Description & vbTab & myErr.Source
' returns 11      Division by zero      Microsoft VBScript runtime error

Class ErrClone

    private description_, number_, source_

    Public Sub Class_Initialize
        description_ = Err.Description
        number_ = Err.Number
        source_ = Err.Source
    End Sub

    Public Property Get Description
        Description = description_
    End Property
    Public Default Property Get Number
        Number = number_
    End Property
    Public Property Get Source
        Source = source_
    End Property
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:45:13.033

要将全局 Err 对象的属性复制到新变量以供以后使用（在全局 Err 被新的灾难更改之后。.Clear 或“On Error GoTo 0”）您应该使用数组：

```
>> On Error Resume Next
>> a = 1 / 0
>> Dim aErr : aErr = Array(Err.Number, Err.Description, Err.Source)
>> On Error GoTo 0
>> WScript.Echo Join(aErr, "-")
>>
11-Division by zero-Microsoft VBScript runtime error 
```

因为你不能在 VBScript 中创建一个空的 Err 对象。

# java - getRGB() 结果与从 MS Paint Eyedropper 收到的结果不匹配

> ID：13219453
> 
> 赞同：1
> 
> 时间：2012-11-04T14:35:57.777
> 
> 标签：java, colors, rgb, bufferedimage

当我使用 getRGB() 并获得像素颜色红色或绿色或蓝色分量后（没关系，因为它们在灰色图像中相等）并将结果与​​ MS Paint Eyedropper 结果进行比较，这是不同的事情。

```
import java.awt.Color;
import java.awt.color.ColorSpace;
import java.awt.image.BufferedImage;
import java.awt.image.ColorConvertOp;
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.imageio.ImageIO;

public class Separator {

BufferedImage inputImg;

private int _inpupImgWidth;
private int _inpupImgHeight;                  

 public Separator(){

    try {
        inputImg = ImageIO.read(new File("inputImg.bmp"));
        _inpupImgWidth = inputImg.getWidth();
        _inpupImgHeight = inputImg.getHeight();

    } catch (IOException e) {
        e.printStackTrace();
    }
    System.out.println(getGrayPixelData(60, 44));
    try {
        ImageIO.write(inputImg, "BMP", new File("outputImg.bmp"));
    } catch (IOException e) {
        e.printStackTrace();
    }
     }

 public void getGrayPixelData(int x, int y){
     Color myColor = new Color(inputImg.getRGB(x, y));       
     System.out.println("Red: " + myColor.getRed());
     System.out.println("Green: " + myColor.getGreen());
     System.out.println("Blue: " + myColor.getBlue());
     }

public static void main(String[] args) {
    new Separator();
    System.out.println("The End");
}
} 
```

这是我使用的图片链接[http://postimage.org/image/t6tvlv941/](http://postimage.org/image/t6tvlv941/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:34:47.860

图像处于灰度模式。

如何将灰度值转换为 R、G、B 是非常随意的。

一种天真的方法是为每个 R、G 和 B 分量分配相同的灰度值。

更复杂的方法是使用一些转换，考虑到眼睛对这些不同组件的敏感度，或者考虑到显示器或其他显示设备的配置文件。

很明显，Java 和您的程序正在使用不同的转换。但无论哪种情况，精确的 R、G 和 B 值本质上是没有意义的：原始数据不是 R、G、B 格式。

# perl - Perl 模块使用的参数

> ID：13219456
> 
> 赞同：0
> 
> 时间：2012-11-04T14:36:23.023
> 
> 标签：perl, perl-module

有 C 背景，我可能试图用错误的方式写一些东西，所以请原谅初学者的问题。这是我正在寻找的：

我愿意有一个 perl 模块`Verbose`（不是一个类）来定义一个名为`verbose_print()`. `$verbose`仅当模块的变量为真时，此子例程才会打印它的参数（字符串） 。当然，我愿意做的是从命令行（使用`Getopt::Long`）获取 -V 选项，然后，如果 -V 开关打开，调用`Verbose`模块，将 'true' 作为`$Verbose::verbose`.

一种解决方法是在模块内使用一个`verbose_init`函数将`$Verbose::verbose`变量设置为 true `Verbose`。

另一种是`$verbose`在我的模块中使用`our`然后`$Verbose::verbose = $command_line_verbose_switch`在主脚本中声明。

我想知道在 perl 中是否有另一种方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T16:07:56.783

不要那么害怕 Perl 中的*类*，它们只是包和模块的处理方式略有不同。他们不咬人。但是，您说不上课，所以不上课。

我不喜欢直接接触包变量。相反，我将使用一个子程序来设置它们。

这是我的`Local::Verbose`（存储在 下`Local/Verbose.pm`）

```
package Local::Verbose;

use strict;
use warnings;
use Exporter 'import';

# Could have used just '@EXPORT', but that's bad manners
our @EXPORT_OK = qw(verbose verbose_switch);

# Use "our", so $verbose_value is a package variable.
# This makes it survive between calls to this package

our $verbose_value;

# prints out message, but only if $verbose_value is set to non-blank/zero value
sub verbose {
    my $message = shift;

    if ( $verbose_value ) {
        print "VERBOSE: $message\n";
        return $message;
    }
    else {
        return;
    }
}

sub verbose_switch  {
    my $switch_value = shift;
    $verbose_value = $switch_value;
    return $switch_value;
}
1; 
```

注意`our`. 这会产生`$verbose_value`一个*包*变量，这意味着它在调用之间位于包之外。

注意我如何使用`Exporter`和`@EXPORT_OK`数组。您可以使用`@EXPORT`which 将自动导出所有命名的子例程，但现在它被认为是*不礼貌*的，因为您最终可能会覆盖某人的同名本地子例程。最好说清楚。如果有问题，他们可以使用`Local::Verbose::verbose`详细子例程的名称。

以及它是如何使用的

```
use strict;
use warnings;

use Local::Verbose qw(verbose verbose_switch);

verbose ("This is a test");

verbose_switch(1);

verbose ("This is a second test"); 
```

顺便说一下，想象一下像这样调用详细的子例程：

```
 verbose($message, $my_verbose_level); 
```

现在，您的详细子例程可能如下所示：

```
 sub verbose {
    my $message =       shift;
    my $verbose_level = shift;

    if (not defined $verbose) {
       $verbose_level = 1;
    }

    if ( $verbose_value =< $verbose_level ) {
        print "VERBOSE: $message\n";
        return $message;
    }
    else {
        return;
    }
} 
```

现在，您可以将详细级别设置为各种值，并让详细语句为您提供不同级别的详细程度。（我做同样的事情，但称之为`debug`）。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-04T14:47:21.423

“另一种方法”之一是创建一个`import`函数：

```
package Verbose;
my $verbose_on;
sub import {
    $verbose_on = shift;
}
#... Your code. 
```

现在你可以像这样设置你的详细信息：

```
if( ... ) { #check getopt
    use Verbose (1); #This will require package Verbose and call "import"
} 
```

但是，我认为更简单和更明显的进一步使用是制作一个函数设置器。

# jquery - google maps + jquery 自动关闭最后一个信息窗口

> ID：13219457
> 
> 赞同：1
> 
> 时间：2012-11-04T14:36:28.083
> 
> 标签：jquery, google-maps, mouseover

当用户将鼠标悬停在地址上时，我试图在标记上调用鼠标悬停事件。当打开新的信息窗口需要关闭最后一个信息窗口，但不知道如何开始。打开这个页面：

[http://fiddle.jshell.net/spYYh/12/](http://fiddle.jshell.net/spYYh/12/)

请帮帮我！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:41:26.363

这个问题类似于这个问题 - [Google Maps API v3: Close infowindow when DOM element is clicked](https://stackoverflow.com/questions/3432486/google-maps-api-v3-close-infowindow-when-dom-element-is-clicked?rq=1) - 所以答案适用。

关键区别在于您要检测鼠标悬停事件，这将是一个`"mouseover"`事件，而不是`"click"`参考问题和答案中提到的事件。

```
google.maps.event.addListener(marker, 'mouseover', function() {
   infowindow.setContent(contentString);
   infowindow.open(map, marker);
}); 
```

您的问题是提供多个标记并不重要。我们做得到：-

```
var infowindow = null;
.
.
.
/* now inside your initialise function */
infowindow = new google.maps.InfoWindow({
    content: "holding..."
});

for (var i = 0; i < markers.length; i++) {
    var marker = markers[i];
    google.maps.event.addListener(marker, 'mouseover', function() {
        //open the infowindow when it's not open yet
        if(contentStringCal!=infowindow.getContent())
        {
          infowindow.setContent(contentStringCal);
          infowindow.open(map, marker);
        }
    });

    google.maps.event.addListener(marker, 'click', function() {
        //when the infowindow is open, close it an clear the contents
        if(contentStringCal==infowindow.getContent())
        {
          infowindow.close(map, marker);
          infowindow.setContent('');
        }
        //otherwise trigger mouseover to open the infowindow
        else
        {
          google.maps.event.trigger(marker, 'mouseover');
        }
    });

    //clear the contents of the infwindow on closeclick
    google.maps.event.addListener(infowindow, 'closeclick', function() {
          infowindow.setContent('');
    });
} 
```

# python - mongoengine 中的问题：ReferenceFields 将默认使用 ObjectId

> ID：13219461
> 
> 赞同：1
> 
> 时间：2012-11-04T14:37:01.863
> 
> 标签：python, mongodb, mongoengine

按照这个官方[教程](https://mongoengine-odm.readthedocs.org/en/latest/tutorial.html)，我编写了这个：

```
#! /usr/bin/env python

from mongoengine import *

connect('tumbleblog')

class User(Document):
  email = StringField(required=True)
  first_name = StringField(max_length=50)
  last_name = StringField(max_length=50)

class Comment(EmbeddedDocument):
  content = StringField()
  name = StringField(max_length=120)

class Post(Document):
  title = StringField(max_length=120, required=True)
  author = ReferenceField(User, reverse_delete_rule=CASCADE)
  tags = ListField(StringField(max_length=30))
  comments = ListField(EmbeddedDocumentField(Comment))

class TextPost(Post):
  content = StringField()

class ImagePost(Post):
  image_path = StringField()

class LinkPost(Post):
  link_url = StringField()

john = User(email="example@gmail.com",first_name='john', last_name='doe')
john.save() 
```

但我不知道为什么在尝试运行它时它说：

```
/Library/Python/2.7/site-packages/mongoengine/fields.py:736: FutureWarning: ReferenceFields will default to using ObjectId  strings in 0.8, set DBRef=True if this isn't desired
  warnings.warn(msg, FutureWarning)
/Library/Python/2.7/site-packages/mongoengine/base.py:589: FutureWarning: TextPost uses inheritance, the default for allow_inheritance is changing to off by default. Please add it to the document meta.
  FutureWarning
/Library/Python/2.7/site-packages/mongoengine/base.py:589: FutureWarning: ImagePost uses inheritance, the default for allow_inheritance is changing to off by default. Please add it to the document meta.
  FutureWarning
/Library/Python/2.7/site-packages/mongoengine/base.py:589: FutureWarning: LinkPost uses inheritance, the default for allow_inheritance is changing to off by default. Please add it to the document meta.
  FutureWarning
[Finished in 0.2s] 
```

我哪里出错了？我遵循了官方教程..我错过了什么吗？

PS Mongodb 已启动并运行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T08:26:47.123

未来的警告用于提醒您升级之前需要解决的 MongoEngine 未来版本的更改。

警告是：

> ReferenceFields 将默认使用 0.8 中的 ObjectId 字符串，如果不需要，请设置 DBRef=True

这意味着 - 如果您不想更改和迁移数据，则应将定义更改为：

```
ReferenceField(User, dbref=False)  # Uses the original way of storing dbrefs
ReferenceField(User, dbref=True)   # Uses a simpler way of storing dbrefs 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:24:45.087

好吧，如果你不喜欢这些警告，你可以让 Post 看起来像：

```
class Post(Document):
    meta = {'allow_inheritance': True}
    ...
    author = ReferenceField(User, reverse_delete_rule=CASCADE, dbref=False)
    ... 
```

有关更多信息，请参阅[http://mongoengine-odm.readthedocs.org/en/latest/upgrade.html](http://mongoengine-odm.readthedocs.org/en/latest/upgrade.html)和[https://github.com/hmarr/mongoengine/issues/437](https://github.com/hmarr/mongoengine/issues/437)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T14:48:37.010

您的代码在定义之前使用了 Comment。Python 中的顺序很重要。

参见例如[https://stackoverflow.com/a/2985085/1256394](https://stackoverflow.com/a/2985085/1256394)。

# c# - 使用未分配的局部变量？

> ID：13219462
> 
> 赞同：4
> 
> 时间：2012-11-04T14:37:16.133
> 
> 标签：c#

Visual Studio 一直在说`Use of unassigned variable`for`iVal`和`iNumber`. 谁能告诉我哪里出错了？

这是一个代码，要求用户继续输入整数并将它们相加，直到用户想要停止。然后整数的总和显示在控制台上。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace AddFive
{
    class Program
    {
        static void Main(string[] args)
        {
           int iNumber;
           int iVal;
           int iTotal = 0;

            while (iVal > 0)
            {
                Console.WriteLine("Enter number " + iNumber);
                iVal = Convert.ToInt32(Console.ReadLine());
                iTotal = iTotal + iVal;
            }

            if (iNumber <= 0)
            {
                Console.WriteLine("Total = " + iTotal);
                iVal = Convert.ToInt32(Console.ReadLine());
                iTotal = iTotal + iVal;
            }

            Console.WriteLine("Total = " + iTotal);
            Console.WriteLine();
            Console.WriteLine("Press any key to close");
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T14:39:40.837

为这些变量赋值。您需要在使用局部变量之前为其赋值

```
 int iNumber = 0;
    int iVal = 0; 
```

当你写的时候`while (iVal > 0)`，`iVal`还没有设置的值

您只能使用实例/类变量来解决这个问题，因为它们被初始化为默认值

```
public class Program
{
    int i; //this was not implicitly initialized to zero (0)

    public Program()
    {
        int j; //need to initialize this before use

        Console.Write(j);  //this throws "Use of unassigned variable" error
        Console.Write(i);  //this prints 0, the default value
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T14:39:34.503

Visual Studio 是正确的，您正在尝试引用未初始化的变量。

尝试这个：

```
 int iNumber = 0;
 int iVal = 0; 
```

这样，您将变量初始化为初始值 0。原始问题出现在以下几行：

`while (iVal > 0)` 和 `if (iNumber <= 0)`

在给变量赋值之前，您尝试在其中访问变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-04T14:39:31.563

在 C# 中，您必须在使用变量之前为其赋值。

例如

```
 int iNumber = 0;
 int iVal = 0; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-04T14:39:42.007

您需要初始化`iNumber`和`iVal`。想想`while`在你当前的代码中，他们第一次通过循环会有什么价值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-04T14:39:49.780

您的 iVal 参数在您的 while 循环中未分配。您需要在初始化时给出一个值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-31T11:36:24.070

正如您在第一次使用 iNumber 或 iVal 之前（在您的 while 语句中）之前未为 iNumber 或 iVal 分配值的几个地方所指出的那样。在这种特殊情况下，它是良性的，并分配默认值来改变事物。这个错误虽然是适当的。在允许使用未分配变量的语言中，历史上未分配的变量一直是一个令人头疼的问题。特别是在不将存储位置初始化为默认值的语言中。在这种情况下，C# 确实会初始化为默认值，但它仍可能导致难以发现错误。编译器足够聪明，可以在到达本地的特定用途之前检查代码所采用的路径，如果你可以在不分配值的情况下到达那里，它会抱怨。

# arrays - 在matlab中将数据保存到文件中

> ID：13219467
> 
> 赞同：0
> 
> 时间：2012-11-04T14:38:37.833
> 
> 标签：arrays, file, matlab, input

我有几个数值数组，我想以某种方式将它们写入文件。我使用了以下代码：

```
file=fopen('d:\file.txt','w');
for i=1:3
fprintf(file, '%6.4e\t%6.4e\r\n', a(i), b(i));
end 
```

但它不起作用。我有一个错误：

```
Error using fprintf
Invalid file identifier.  Use fopen to generate a valid file
identifier. 
```

这是什么意思？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:43:39.017

在 Octave（与 Matlab 的语法非常相似）中，您可以执行

```
function wfile()

    a = [1;2;3];
    b = [10; 20; 30];

    file=fopen('file.txt','w');
    for i=1:3
        line_to_write = sprintf('%d and %d\r\n', a(i), b(i));
        fprintf(file, line_to_write);
    end
    fclose(file);
end 
```

使用路径`d:\`可能会更好地设置`pwd = d:\`

# jquery - 在动态选择元素中使用 JSON 变量

> ID：13219469
> 
> 赞同：0
> 
> 时间：2012-11-04T14:38:54.950
> 
> 标签：jquery

我有这个 JSON 字符串（来自 DataSet，1 列，几行 - 示例中仅显示 2 -）

```
{"Tables":[{"Rows":[{"Column1":"UserNumer1"},{"Column1":"UserNumber2"}]}]} 
```

如何在我的动态填充中使用这些值`select value`？

```
$('<option>').val('UserNumer1').text('UserNumer1').appendTo('#selectID'); 
```

我想附加所有值，如果 JSON 字符串有 10 行（在这种情况下为用户），我希望 jquery 将所有行附加到我的 selectID 中。被告知最好`appendTo`只做一次而不是做一次互动。

谢谢！

**根据答案编辑。**

为了快速测试，我在我的页面上设置了这个。

```
jsonString = GetParsedData(); 
```

现在，jQuery 脚本。

```
$(function () {
        var obj = <%=jsonString%>;
        var html = "";
        for (var i = 0; i < obj.Tables.length; i++) {
            html += '<option value="' + obj.Tables[i].Column1 + '"> ' + obj.Tables[i].Column1 + '</option>';
        }
        $(html).appendTo('#selectID');
    }); 
```

列表没有被填充，所以我尝试了 firebug，在断点之后我得到了变量 html 的结果

```
"<option value="undefined"> undefined</option>" 
```

var obj 没问题

```
{"Tables":[{"Rows":[{"Column1":"UserName1"},{"Column1":"UserName2"}]}]}; 
```

我在这里错过了什么吗？非常感谢。

除了错误的 de "undefined" 之外，它甚至都没有附加它。菜单列表 y 为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:42:26.077

```
 var table;   for (var i=0; i< resp.Tables.length; i++){
     table = resp.Tables[i];
     for(var j=0;j<table.Rows.length; j++ ){
          $('<option>').val( table.Rows[j].Column1).text(table.Rows[j].Column1).appendTo('#selectID');
    }
    } 
```

我建议你更快的方式。

```
var html = "";
    for (var i=0; i< resp.Tables.length; i++){
    table = resp.Tables[i];
     for(var j=0;j<table.Rows.length; j++ ){
         html +='<option value="'+  table.Rows[j].Column1 +'"> '+  table.Rows[j].Column1 +'</option>';
    }
    }
$(html).appendTo('#selectID'); 
```

# locationlistener - 如何在我的 LocationListener 中停止 onLocationChanged()

> ID：13219470
> 
> 赞同：1
> 
> 时间：2012-11-04T14:38:57.983
> 
> 标签：locationlistener

如何在我的 LocationListener 中停止 onLocationChanged()，当我按下按钮时，onLocationChanged 中的 Toastbox 不断出现，即使我离开应用程序也无法停止。

```
Button btn_location =(Button) findViewById(R.id.button4);
btn_location.setOnClickListener(new OnClickListener() {
public void onClick(View v) { 

               LocationManager mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
               LocationListener mlocListener = new MyLocationListener(); 
               mlocManager.requestLocationUpdates( LocationManager.GPS_PROVIDER, 0, 0, mlocListener); 
        }

    });

 public class MyLocationListener implements LocationListener     {  

            public void onLocationChanged(Location loc)       
            {   

                loc.getLatitude();         
                loc.getLongitude();          
                String Text = "My current location is: " +         "Latitud = " + loc.getLatitude() +         "Longitud = " + loc.getLongitude();          
                Toast.makeText( getApplicationContext(), Text, Toast.LENGTH_SHORT).show();       
             }        
            public void onProviderDisabled(String provider)       
            {         
                Toast.makeText( getApplicationContext(), "Gps Disabled", Toast.LENGTH_SHORT ).show();       
             }        
            public void onProviderEnabled(String provider)       
            {         
                Toast.makeText( getApplicationContext(), "Gps Enabled", Toast.LENGTH_SHORT).show();       
             }        
            public void onStatusChanged(String provider, int status, Bundle extras)       
            {        

            }     
         } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T18:53:23.330

你可以应用这个：

mlocManager.removeUpdates(mlocListener);

到按钮或放入 onDestroy() 或 onPause()

参考：[Android 活动](http://developer.android.com/reference/android/app/Activity.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-18T14:22:51.403

以下代码对我有用：

```
@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    aLocationManager.removeUpdates(aLocationListener);
} 
```

只需在要停止更新的任何地方调用 removeUpdates() 方法！

# sql - 为什么选择 0, ... 而不是 SELECT

> ID：13219472
> 
> 赞同：22
> 
> 时间：2012-11-04T14:39:28.397
> 
> 标签：sql, sqlite, core-data

假设我有一个包含表的 SQLite 数据库：

```
sqlite> create table person (id integer, firstname varchar, lastname varchar); 
```

现在我想获取表中的每个条目。

```
sqlite> select t0.id, t0.firstname, t0.lastname from person t0; 
```

这很好用，这就是我要使用的。但是，我使用了来自 Apple（Core Data）的生成 SQL 的框架。这个框架生成一个稍微不同的 SQL 查询：

```
sqlite> select 0, t0.id, t0.firstname, t0.lastname from person t0; 
```

此框架生成的每个 SQL 查询都以“select 0”开头。这是为什么？

我试图使用解释命令来查看发生了什么，但这还没有定论——至少对我来说是这样。

```
sqlite> explain select t0.id, t0.firstname, t0.lastname from person t0;
addr        opcode      p1          p2          p3          p4          p5          comment   
----------  ----------  ----------  ----------  ----------  ----------  ----------  ----------
0           Trace       0           0           0                       00          NULL      
1           Goto        0           11          0                       00          NULL      
2           OpenRead    0           2           0           3           00          NULL      
3           Rewind      0           9           0                       00          NULL      
4           Column      0           0           1                       00          NULL      
5           Column      0           1           2                       00          NULL      
6           Column      0           2           3                       00          NULL      
7           ResultRow   1           3           0                       00          NULL      
8           Next        0           4           0                       01          NULL      
9           Close       0           0           0                       00          NULL      
10          Halt        0           0           0                       00          NULL      
11          Transactio  0           0           0                       00          NULL      
12          VerifyCook  0           1           0                       00          NULL      
13          TableLock   0           2           0           person      00          NULL      
14          Goto        0           2           0                       00          NULL 
```

第二个查询的表如下所示：

```
sqlite> explain select 0, t0.id, t0.firstname, t0.lastname from person t0;
addr        opcode      p1          p2          p3          p4          p5          comment   
----------  ----------  ----------  ----------  ----------  ----------  ----------  ----------
0           Trace       0           0           0                       00          NULL      
1           Goto        0           12          0                       00          NULL      
2           OpenRead    0           2           0           3           00          NULL      
3           Rewind      0           10          0                       00          NULL      
4           Integer     0           1           0                       00          NULL      
5           Column      0           0           2                       00          NULL      
6           Column      0           1           3                       00          NULL      
7           Column      0           2           4                       00          NULL      
8           ResultRow   1           4           0                       00          NULL      
9           Next        0           4           0                       01          NULL      
10          Close       0           0           0                       00          NULL      
11          Halt        0           0           0                       00          NULL      
12          Transactio  0           0           0                       00          NULL      
13          VerifyCook  0           1           0                       00          NULL      
14          TableLock   0           2           0           person      00          NULL      
15          Goto        0           2           0                       00          NULL 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-04T14:55:55.300

一些框架这样做是为了毫无疑问地判断是否返回了该表中的一行。

考虑

```
 A      B
+---+  +---+------+
| a |  | a | b    |
+---+  +---+------+
| 0 |  | 0 |    1 |
+---+  +---+------+
| 1 |  | 1 | NULL |
+---+  +---+------+
| 2 |
+---+

SELECT A.a, B.b
FROM A
LEFT JOIN B
ON B.a = A.a

  Results
+---+------+
| a | b    |
+---+------+
| 0 |    1 |
+---+------+
| 1 | NULL |
+---+------+
| 2 | NULL |
+---+------+ 
```

在这个结果集中，不可能看到`a = 1`表 B 中存在，但`a = 2`不存在。要获取该信息，您需要从表 b 中选择一个不可为空的表达式，而最简单的方法是选择一个简单的常量值。

```
SELECT A.a, B.x, B.b
FROM A
LEFT JOIN (SELECT 0 AS x, B.a, B.b FROM B) AS B
ON B.a = A.a

  Results
+---+------+------+
| a | x    | b    |
+---+------+------+
| 0 |    0 |    1 |
+---+------+------+
| 1 |    0 | NULL |
+---+------+------+
| 2 | NULL | NULL |
+---+------+------+ 
```

在很多情况下，这些常量值并不是严格要求的，例如当您没有连接时，或者当您可以从 b 中选择一个不可为空的列时，但它们也不会造成任何伤害，因此它们可以只是无条件地被包括在内。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-04T16:38:37.193

当我有代码来动态生成一个`WHERE`子句时，我通常以一个子句开头：

```
WHERE 1 = 1 
```

然后添加附加条件的循环总是以相同的格式添加每个条件：

```
AND x = y 
```

无需放置条件逻辑来检查这是否是第一个条件：“如果这是第一个条件，则以`WHERE`关键字开头，否则添加`AND`关键字。

所以我可以想象一个框架出于类似的原因这样做。如果以 a 开始语句，`SELECT 0`则添加后续列的代码可以在没有任何条件语句的循环中。`, colx`每次只添加没有任何条件检查的“如果这是第一列，不要在列名之前放逗号，否则做”。

示例伪代码：

```
String query = "SELECT 0";

for (Column col in columnList)
    query += ", col"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T15:38:45.017

只有苹果知道……但我看到了两种可能性：

1.  插入一个虚拟列可确保*实际*输出列从 1 开始编号，而不是 0。如果某些现有接口已经采用基于 1 的编号，那么在 SQL 后端这样做可能是最简单的解决方案。

2.  如果您使用多个子查询对多个对象进行查询，则可以使用这样的值来确定记录源自哪个子查询：

    ```
    SELECT 0, t0.firstname, ... FROM PERSON t0 WHERE t0.id = 123
    UNION ALL
    SELECT 1, t0.firstname, ... FROM PERSON t0 WHERE t0.id = 456 
    ```

    （我不知道 Core Data 是否真的这样做。）

* * *

您的`EXPLAIN`输出显示唯一的区别是（在地址 4）第二个程序将额外列设置为零，因此只有最小的性能差异。

# ruby-on-rails - 使用 ERB 打印数组元素

> ID：13219475
> 
> 赞同：5
> 
> 时间：2012-11-04T14:39:32.420
> 
> 标签：ruby-on-rails, ruby, arrays, erb

我正在尝试将控制器中定义的简单数组打印到我的视图中，每个元素都有一个新行。但它所做的是在一行上打印整个数组。

这是我的控制器：

```
class TodosController < ApplicationController
  def index
    @todo_array = [ "Buy Milk", "Buy Soap", "Pay bill", "Draw Money" ]
  end
end 
```

这是我的看法：

```
<%= @todo_array.each do |t| %>
<%= puts t %><\br>
<% end %> 
```

结果如下：

```
<\br> <\br> <\br> <\br> ["Buy Milk", "Buy Soap", "Pay bill", "Draw Money"] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-04T14:56:38.260

Erb，您在视图中使用的模板引擎，有几种不同的方式将 ruby​​ 代码嵌入到模板中。

When you put code inside `<%= %>` blocks, erb evaluates the code inside and prints the value of the last statement in the HTML. Since `.each` in ruby returns the collection you iterated over, the loop using `<%= %>` attempts to print a string representation of the entire array.

When you put code inside `<% %>` blocks, erb just evaluates the code, not printing anything. This allows you to do conditional statements, loops, or modify variables in the view.

You can also remove the `puts` from `puts t`. Erb knows to try to convert the last value it saw inside `<%= %>` into a string for display.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-04T14:55:42.883

嘿，你为什么在第一行加上'='符号。<% %> 用于告诉rails该字符串下的字符串是ruby代码，评估它。其中 <%= %> 这告诉 Rails 这些标签中的字符串是 ruby​​ 格式的，评估它并将结果也打印到 html 文件中。

因此尝试检查您正在编写的代码

`<%=`@todo_array.each 做 |t| %> 虽然此行仅用于迭代 @todo_array 因此我们不需要打印该行。所以最终的代码应该是

```
<% @todo_array.each do |t| %>
 <%= puts t %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-18T16:28:22.133

Just try:

`<%= @todo_array.join('<br />').html_safe %>`

instead of

```
<%= @todo_array.each do |t| %>
   <%= puts t %><\br>
<% end %> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-04T14:49:19.680

你的观点有两个问题：

1.  您在应该使用“<%”的地方使用“<%=”。
2.  你不需要'puts'

这应该会改善您的结果：

```
<% @todo_array.each do |t| %>
  <%= t %><\br>
<% end %> 
```

我会进一步考虑使用一些 HTML 结构来更好地构建你的待办事项列表（而不是在行尾使用 br 标记），也许是一个像这样的无序列表：

```
<ul>
  <% @todo_array.each do |t| %>
    <li><%= t %></li>
  <% end %>
</ul> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-04T14:42:51.487

从每个语句中删除等号：

```
<% @todo_array.each do |t| %>
  <%= t %><\br>
<% end %> 
```

# xcode - iPhone5 模拟器未出现在 xcode 4.5 预览 (4G78z) 中

> ID：13219483
> 
> 赞同：1
> 
> 时间：2012-11-04T14:39:54.880
> 
> 标签：xcode

我在 Mountain Lion 上安装了 xcode 4.5 预览版。当我转到硬件-> 设备时，我有 iPhone Retina 选项，但没有 iPhone Retina-4inch 选项。我是否需要升级我的 xcod e 或安装其他任何东西才能拥有 iphone 视网膜 4 英寸模拟器？

![这是ios 6模拟器的屏幕截图和我在硬件中的选项->设备](../Images/661089ddc1ab71408c23753e043d6bb6.png)

# c++ - 我可以通常/总是使用 std::forward 而不是 std::move 吗？

> ID：13219484
> 
> 赞同：64
> 
> 时间：2012-11-04T14:40:10.743
> 
> 标签：c++, c++11, move-semantics, rvalue-reference, perfect-forwarding

我一直在观看 Scott Meyers在 C++ 和 Beyond 2012 会议[上关于通用引用的演讲，](http://channel9.msdn.com/Shows/Going+Deep/Cpp-and-Beyond-2012-Scott-Meyers-Universal-References-in-Cpp11)到目前为止一切都很有意义。然而，一位观众在大约 50 分钟时提出了一个我也想知道的问题。迈耶斯说他不关心答案，因为它是非惯用的并且会让他的头脑变得愚蠢，但我仍然感兴趣。

呈现的代码如下：

```
// Typical function bodies with overloading:
void doWork(const Widget& param)   // copy
{
  // ops and exprs using param
}
void doWork(Widget&& param)        // move
{
  // ops and exprs using std::move(param)
}

// Typical function implementations with universal reference:
template <typename T>
void doWork(T&& param)             // forward => copy and move
{
  // ops and exprs using std::forward<T>(param)
} 
```

关键是当我们采用右值引用时，我们知道我们有一个右值，所以我们应该`std::move`保留它是一个右值的事实。当我们采用通用引用（`T&&`，其中`T`是推导类型）时，我们希望`std::forward`保留它可能是左值或右值的事实。

所以问题是：既然`std::forward`保留了传递给函数的值是左值还是右值，并且`std::move`只是将其参数转换为右值，我们可以`std::forward`在任何地方使用吗？在我们使用 的所有情况下都会`std::forward`表现得像，还是迈耶斯的概括遗漏了一些重要的行为差异？`std::move``std::move`

我并不是建议任何人都应该这样做，因为正如 Meyers 正确所说，它完全不是惯用的，但以下也是 的有效用法`std::move`：

```
void doWork(Widget&& param)         // move
{
  // ops and exprs using std::forward<Widget>(param)
} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-11-04T14:55:55.957

两者是非常不同且*互补*的工具。

*   `std::move` *推导出*参数并无条件地创建一个右值表达式。这适用于实际的对象或变量是有意义的。

*   `std::forward`接受一个强制性的模板参数（你必须指定这个！）并根据类型（通过添加`&&`和折叠规则）神奇地创建一个左值或右值表达式。这仅适用于推导的模板化函数参数。

也许下面的例子能更好地说明这一点：

```
#include <utility>
#include <memory>
#include <vector>
#include "foo.hpp"

std::vector<std::unique_ptr<Foo>> v;

template <typename T, typename ...Args>
std::unique_ptr<T> make_unique(Args &&... args)
{
    return std::unique_ptr<T>(new T(std::forward<Args>(args)...));  // #1
}

int main()
{
    {
        std::unique_ptr<Foo> p(new Foo('a', true, Bar(1,2,3)));
        v.push_back(std::move(p));                                  // #2
    }

    {
        v.push_back(make_unique<Foo>('b', false, Bar(5,6,7)));      // #3
    }

    {
        Bar b(4,5,6);
        char c = 'x';
        v.push_back(make_unique<Foo>(c, b.ready(), b));             // #4
    }
} 
```

在情况 #2 中，我们有一个现有的具体对象`p`，我们想无条件地离开它。只有`std::move`有意义。这里没有什么可以“转发”的。我们有一个命名变量，我们想从它移动。

另一方面，情况 #1 接受任何类型的参数列表，并且每个参数都需要作为与原始调用中相同的值类别进行转发。例如，在#3 中，参数是临时表达式，因此它们将作为右值转发。但是我们也可以在构造函数调用中混合命名对象，就像情况 #4 一样，然后我们需要作为左值转发。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-04T14:55:43.257

是的，如果`param`是 a `Widget&&`，那么以下三个表达式是等价的（假设它`Widget`不是引用类型）：

```
std::move(param)
std::forward<Widget>(param)
static_cast<Widget&&>(param) 
```

一般来说（when`Widget`可能是参考），`std::move(param)`等价于以下两个表达式：

```
std::forward<std::remove_reference<Widget>::type>(param)
static_cast<std::remove_reference<Widget>::type&&>(param) 
```

注意移动东西有多好`std::move`。关键`std::forward`是它与模板类型推导规则很好地混合：

```
template<typename T>
void foo(T&& t) {
    std::forward<T>(t);
    std::move(t);
}

int main() {
    int a{};
    int const b{};
               //Deduced T   Signature    Result of `forward<T>` Result of `move`
    foo(a);    //int&        foo(int&)       lvalue int          xvalue int
    foo(b);    //int const&  foo(int const&) lvalue int const    xvalue int const
    foo(int{});//int         foo(int&&)      xvalue int          xvalue int
} 
```

# c# - 从 JSON 输出中删除不需要的空格

> ID：13219486
> 
> 赞同：5
> 
> 时间：2012-11-04T14:40:55.533
> 
> 标签：c#, .net, json, formatting, json.net

我正在对 JSON.Net 对象进行消毒，它包含许多数组。这是我目前得到的输出：

```
"children": [ 
{ 
      "children": [ 
      {
      },
      {
      }
} 
```

但是，为了便于阅读和比较，我想删除每个大括号和括号之间以及逗号和下一个大括号之间的换行符，所以它看起来像这样：

```
"children": [ { 
      "children": [ {

      }, {
      }
} 
```

我已经用`Formatting.Indented`参数对我的 JSON 进行了消毒，所以我想知道是否有其他设置可以更改，以便 JSON.Net 在没有额外线路制动器的情况下进行消毒，但保留缩进格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T08:46:14.213

Json.NET 中没有提供这种缩进的功能。你要么必须在 Json.NET 之外自己做，要么修改源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:15:45.057

你可以在'{'上拆分然后用空格再次加入数组吗？

# expressionengine - 如何使用条目和类别有条件地应用图像？

> ID：13219487
> 
> 赞同：7
> 
> 时间：2012-11-04T14:41:01.923
> 
> 标签：expressionengine

使用 ExpressionEngine 2.5.3 版，我有一个按类别显示的产品列表，但我需要此列表中的优质产品带有小星形图像。除了 {title} 之外，您如何有条件地调用这些小星星？

目前，此代码显示所有产品的星标，这并不理想。

```
<ol class="voices-list">
{exp:channel:entries channel="product" orderby="title" sort="asc" category="2&6" dynamic="no"}  
<li><a href="{page_url}">{title}<img class="feature_icon medium" src="{root_url}img/audio/smallstar.png" alt="star"></a></li>   
{/exp:channel:entries}
</ol> 
```

我需要你的帮助，拜托。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T14:52:23.563

最好设置一个名为“is_premium”的新复选框字段，并将值设置为“y”。

接下来，编辑每个高级产品条目并选中该框并保存。

最后，在您的模板中使用此条件。{if is_premium == "y"}加星码{/if}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T16:58:24.223

我喜欢@MediaGirl 发布的答案中显示的方法，并且已经使用过很多次。

另一种方法是使用自定义状态而不是自定义字段来处理它，只要能够在主编辑屏幕上快速轻松地按“高级”查看和排序列表（Zenbu 可以将自定义字段添加到当然是编辑屏幕）。条件类似，当然条目循环需要具有“open|premium”的状态参数。

# css - 标题背景颜色问题

> ID：13219488
> 
> 赞同：0
> 
> 时间：2012-11-04T14:41:09.003
> 
> 标签：css

你知道我看不到标题的白色背景颜色吗？出于某种原因，我只能看到用作身体背景的背景图像。谢谢

```
body { 
overflow: hidden; 
background:url(../images/81107173.jpg) no-repeat center fixed;
-webkit-background-size: cover;
-moz-background-size: cover;
-ms-background-size: cover;
-o-background-size: cover;
background-size: cover;} 

#header {position:absolute; top:0px; left:0px; height:100px; overflow:hidden; background-color:#FFF; }

#container {position:absolute; top:100px; bottom:60px; left:0px; overflow:auto; background:#639;}

#footer {position:absolute; bottom:0px; height:60px; left:0px; overflow:hidden; background:#FC6;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:46:39.793

你有`overflow:hidden;`并且没有定义宽度。我也没有看到您的任何 HTML，所以我不知道您是否在标题 div 中有内容。

为您的标题添加宽度，您至少应该看到白色背景。例如

```
#header {
   /* all your current css */
   width:100%;
} 
```

# java - 对不同类型的对象进行排序（性能）

> ID：13219491
> 
> 赞同：0
> 
> 时间：2012-11-04T14:41:32.803
> 
> 标签：java, performance, sorting

假设我有一个名为 Unit 的类（带有位置变量 x）并将该类扩展到 UnitA、UnitB、UnitC 等。

这是我想出的：

```
Unit[] ordered = new Unit[a_num+b_num+c_num];
ordered = Arrays.copyOf(a_units, a_num); //and add b_units, c_units, etc
Arrays.sort(ordered); //sort using compareTo method 
```

*   为了获得最佳性能和简洁的编程，从左到右（x 变量）对这些值进行排序的最佳方法是什么？
*   对数组进行排序时，为了访问特定于单元的变量，我如何找出每个条目是什么类型的对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T14:44:36.530

如果您必须找出每个条目是什么类型的对象，那么您做错了。

多态是唯一的出路。这就是面向对象语言的用途。

你没有说你想如何对单位进行排序。您是指物理单位，例如长度为米，质量为千克，时间为秒？如果是，“排序”它们是什么意思？当然，您可以按字母顺序排列它们，但我不知道这有多大意义。

什么是“位置变量”？你的意思是你会有一个长度单位，在不同的“位置”有米、英尺、埃和弗隆等基本值？你将如何订购它们？靠人气？答案的变化取决于您是在少数几个仍然使用英制单位的国家之一（例如美国；甚至英国也放弃了英制单位！）或公制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T14:48:00.323

`Arrays.sort(ordered)`将根据单位的自然顺序（由 compareTo 方法定义）进行排序。如果自然排序不是您想要的，则使用`Arrays.sort(array, Comparator)`并传递一个比较单元位置的比较器。

关于你的第二个问题：你不应该知道单位的类型。您的 Unit 类应该提供您可以调用的多态方法，这些方法由每个子类实现以执行适当的操作。`instanceof`操作符和方法总是有的`getClass()`，但使用它们表明缺乏 OO 设计，因此是不好的做法。

# android - 当前 listView 变空时显示新的 ListView

> ID：13219492
> 
> 赞同：2
> 
> 时间：2012-11-04T14:41:35.837
> 
> 标签：android, listview, textwatcher

在我的应用程序中，我正在从用户的电话簿中读取联系人，并根据用户的需求执行一些操作。从用户电话簿中导入联系人的 Activity 还包含一个 editText 字段，用户可以使用该字段过滤联系人并搜索联系人。代码如下：

```
public class InviteFriendsFromContactsActivity extends Activity implements
    TextWatcher {

private EditText friendSearch;

private ArrayList<ContactInfo> contacts;

private ListView contactsListView;

private ContactsListviewAdapter clvAdapter;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.invite_from_contacts);

    friendSearch = (EditText) findViewById(R.id.friendsearch);
    friendSearch.addTextChangedListener(this);

    contactsListView = (ListView) findViewById(R.id.ContactsListView);

    ReadContacts();

}

void ReadContacts() {

    contacts = new ArrayList<ContactInfo>();

    Cursor cursor = getContentResolver().query(
            ContactsContract.Contacts.CONTENT_URI, null, null, null, null);
    while (cursor.moveToNext()) {
        long contactId = cursor.getLong(cursor
                .getColumnIndex(ContactsContract.Contacts._ID));
        String name = cursor.getString(cursor
                .getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
        Cursor emails = getContentResolver().query(
                ContactsContract.CommonDataKinds.Email.CONTENT_URI,
                null,
                ContactsContract.CommonDataKinds.Email.CONTACT_ID + " = "
                        + contactId, null, null);
        while (emails.moveToNext()) {
            // This would allow to get several email addresses, so if 1
            // contact has 2 emails, will be listed as 2 rows
            String emailAddress = emails
                    .getString(emails
                            .getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
            if (emailAddress != null)
                contacts.add(new ContactInfo(contactId, name, emailAddress));
        }
        emails.close();
    }
    cursor.close();

    clvAdapter = new ContactsListviewAdapter(getApplicationContext(),
            contacts);

    contactsListView.setAdapter(clvAdapter);

}

public void onTextChanged(CharSequence s, int start, int before, int count) {
    if (clvAdapter != null) {
        clvAdapter.getFilter().filter(s);
        contactsListView.setAdapter(clvAdapter);
    }
    if (clvAdapter.getCount() == 0) {
        ListView list = (ListView) findViewById(R.id.ContactsListView);
        list.setClickable(false);

        final List<ContactInfo> listItems = new ArrayList<ContactInfo>();
        listItems.add(new ContactInfo("No results", ""));

        ContactsListviewAdapter adapter = new ContactsListviewAdapter(
                InviteFriendsFromContactsActivity.this, listItems) {

            @Override
            public View getView(int position, View convertView,
                    ViewGroup viewGroup) {
                ContactInfo entry = listItems.get(position);

                CheckBox checkBox;
                TextView nameText;
                TextView emailText;

                LayoutInflater inflater = (LayoutInflater) InviteFriendsFromContactsActivity.this
                        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                convertView = inflater.inflate(R.layout.row, null);

                nameText = (TextView) convertView
                        .findViewById(R.id.toptext);

                emailText = (TextView) convertView
                        .findViewById(R.id.bottomtext);

                checkBox = (CheckBox) convertView
                        .findViewById(R.id.checkBox_invited);

                checkBox.setVisibility(View.GONE);
                nameText.setText(entry.getName());
                emailText.setVisibility(View.GONE);

                convertView.setBackgroundColor(Color.WHITE);

                return convertView;
            }
        };
        list.setAdapter(adapter);
    }

}
} 
```

另外，我的 ContactsListViewAdapter 类如下。这是一个相当大的课程，但我认为与这个问题最相关的部分是`getFilter`方法。

```
class ContactsViewHolder {

public ContactsViewHolder(TextView nameTextView, TextView emailTextView,
        CheckBox checkBox, ImageView iv) {
    super();
    this.nameTextView = nameTextView;
    this.emailTextView = emailTextView;
    this.checkBox = checkBox;
    this.iv = iv;
}

public TextView getNameTextView() {
    return nameTextView;
}

public void setNameTextView(TextView nameTextView) {
    this.nameTextView = nameTextView;
}

public TextView getEmailTextView() {
    return emailTextView;
}

public void setEmailTextView(TextView emailTextView) {
    this.emailTextView = emailTextView;
}

public CheckBox getCheckBox() {
    return checkBox;
}

public void setCheckBox(CheckBox checkBox) {
    this.checkBox = checkBox;
}

public ImageView getIv() {
    return iv;
}

public void setIv(ImageView iv) {
    this.iv = iv;
}

private TextView nameTextView;
private TextView emailTextView;
private CheckBox checkBox;
private ImageView iv;

}

public class ContactsListviewAdapter extends BaseAdapter implements Filterable {
private Context context;

private List<ContactInfo> contacts;

private List<ContactInfo> originalContacts;

private List<String> selectedEmails = new ArrayList<String>();

public ContactsListviewAdapter(Context context, List<ContactInfo> contacts) {
    this.context = context;
    this.contacts = contacts;
}

public int getCount() {
    return contacts.size();
}

public Object getItem(int position) {
    return contacts.get(position);
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup viewGroup) {
    ContactInfo entry = contacts.get(position);

    CheckBox checkBox;
    TextView nameText;
    TextView emailText;
    ImageView contactPic;

    if (convertView == null) {
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = inflater.inflate(R.layout.row, null);

        nameText = (TextView) convertView.findViewById(R.id.toptext);

        emailText = (TextView) convertView.findViewById(R.id.bottomtext);

        contactPic = (ImageView) convertView.findViewById(R.id.pic);

        checkBox = (CheckBox) convertView
                .findViewById(R.id.checkBox_invited);

        // Optimization: Tag the row with it's child views, so we don't have
        // to
        // call findViewById() later when we reuse the row.
        convertView.setTag(new ContactsViewHolder(nameText, emailText,
                checkBox, contactPic));

        // If CheckBox is toggled, update the planet it is tagged with.
        checkBox.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                CheckBox cb = (CheckBox) v;
                ContactInfo contact = (ContactInfo) cb.getTag();
                contact.setChecked(cb.isChecked());

                if(contact.isChecked())
                {
                    selectedEmails.add(contact.getEmail());
                }
            }
        });
    }
    // Reuse existing row view
    else {
        // Because we use a ViewHolder, we avoid having to call
        // findViewById().
        ContactsViewHolder viewHolder = (ContactsViewHolder) convertView
                .getTag();
        checkBox = viewHolder.getCheckBox();
        nameText = viewHolder.getNameTextView();
        emailText = viewHolder.getEmailTextView();
        contactPic = viewHolder.getIv();
    }

    // Tag the CheckBox with the Contact it is displaying, so that we can
    // access the Contact in onClick() when the CheckBox is toggled.
    checkBox.setTag(entry);

    // Display contact data
    checkBox.setChecked(entry.isChecked());
    nameText.setText(entry.getName());
    emailText.setText(entry.getEmail());

    Bitmap bitmap = People.loadContactPhoto(context,
            ContentUris.withAppendedId(People.CONTENT_URI, entry.getId()),
            R.drawable.contacts, null);
    contactPic.setImageBitmap(bitmap);

    return convertView;
}

@Override
public Filter getFilter() {
    Filter filter = new Filter() {

        @SuppressWarnings("unchecked")
        @Override
        protected void publishResults(CharSequence constraint,
                FilterResults results) {

            contacts = (List<ContactInfo>) results.values; // has the filtered values
            notifyDataSetChanged(); // notifies the data with new filtered values
        }

        @Override
        protected FilterResults performFiltering(CharSequence constraint) {
            FilterResults results = new FilterResults(); // Holds the
                                                            // results of a
                                                            // filtering
                                                            // operation in
                                                            // values
            List<ContactInfo> FilteredArrList = new ArrayList<ContactInfo>();

            if (originalContacts == null) {
                originalContacts = new ArrayList<ContactInfo>(contacts); 
            }

            /********
             * 
             * If constraint(CharSequence that is received) is null returns
             * the mOriginalValues(Original) values else does the Filtering
             * and returns FilteredArrList(Filtered)
             * 
             ********/
            if (constraint == null || constraint.length() == 0) {

                // set the Original result to return
                results.count = originalContacts.size();
                results.values = originalContacts;
            } else {
                constraint = constraint.toString().toLowerCase();
                for (int i = 0; i < originalContacts.size(); i++) {
                    String name = originalContacts.get(i).getName();
                    if (name.toLowerCase()
                            .startsWith(constraint.toString())) {
                        FilteredArrList.add(originalContacts.get(i));
                    }
                }
                // set the Filtered result to return
                results.count = FilteredArrList.size();
                results.values = FilteredArrList;
            }
            return results;
        }
    };
    return filter;
}

public List<String> getSelectedEmails() {
    return selectedEmails;
}
} 
```

联系人在活动中导入就好了。当我尝试搜索联系人时出现问题。当我在搜索字段中输入“x”（我的电话簿中没有以 x 开头的联系人）时，显示了 0 个联系人，`No results found`但未显示消息。它只会在我在“x”之后键入另一个字母后显示。通常，消息`No results found`总是在实际应该显示的 1 个字母之后显示。

出了什么问题，消息是如何延迟的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-12T11:14:19.413

我遇到了完全相同的问题，我真的需要将页脚添加到列表中，然后在过滤完成后将其删除。TextWatcher 会给我一个字符延迟的结果。所以我从一个稍微不同的角度来处理这个问题。首先，我创建了一个方法并将一个添加`GLobalLayoutListener`到该方法中的列表视图中。

```
public void DoGlobalListener(){
        mTextList.getViewTreeObserver().addOnGlobalLayoutListener(
                new ViewTreeObserver.OnGlobalLayoutListener() {
                    @Override
                    public void onGlobalLayout() {
                       if(mListAdapter.isEmpty() && !mFooterAdded){
                        mTextList.addFooterView(mFooter);
                        mFooterAdded = true;
                       }else{
                        mTextList.removeFooterView(mFooter);
                        mFooterAdded = false;
                       }
                       mTextList.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                    }
                });
    } 
```

在这里，我检查`adapter`设置是否`ListView`为空，然后`boolean`我设置查看是否添加页脚是否设置为 false。如果两个条件都满足，我添加页脚并将其设置`boolean`为 true。如果不满足条件，则执行相反的操作。在它结束时，我停止它`GlobalLayoutListener`以确保只完成一次。然后可以在 textWatcher 的`afterTextChanged`方法中调用此方法，以便在每次`EditText`更改中的文本时运行它。

```
 @Override
    public void afterTextChanged(Editable s) {
    DoGlobalListener();
} 
```

这可能不是最整洁和最优化的做事方式，但它确实可以完成工作。我意识到这个问题发布已经有一段时间了，但希望它能够帮助任何面临这个问题的人。干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T16:34:43.727

无需过多查看您的代码，我会说延迟的原因是您在方法中设置过滤的`onTextChanged`方式。适配器中的过滤是在后台线程中完成的（在该线程上运行），并且在调用方法（在主 UI 线程上运行`performFiltering`）之前，适配器不会看到新值和过滤结果。`publishResults`

现在，在`onTextchanged`您调用`filter`带有约束的方法，然后立即重新设置相同的适配器`ListView`（为什么要这样做？！）。到您进行测试`if (clvAdapter.getCount() == 0)`时，过滤很可能尚未完成，并且您的适配器仍然具有旧值，因此`if`测试失败并且您看不到您在此处设置的适配器以及未*找到结果*文本。当您输入另一个字母时，`onTextChanged`将再次调用该方法，这一次适配器确实是空的，在这种`if`情况下将是`true`.

清理`onTextchanged`方法（只调用`filter`）并尝试直接在适配器中实现该特殊行。

# javascript - 强制脚本在 AJAX 加载页面中运行

> ID：13219495
> 
> 赞同：2
> 
> 时间：2012-11-04T14:41:48.570
> 
> 标签：javascript, jquery, ajax

所以我在我的 WP 安装中使用了 AJAX 加载程序，并且我正在加载的页面之一中有一个脚本。

```
<div id="register-form">
    <div id="register-one"></div>
    <div style="text-align:center;padding-top:10px;"></div> 
    <div class="horizontal-rule"></div>
    <div id='register'>
        <div id="register-character">
        </div>
    </div>

    <div class="post">  
        <form action="" method="post" id="register-form" >
        What's your Name:
            <input class=in id='register_name' name="register_name" onkeydown='register_step1_keydown();' onkeyup='register_step1_keyup();'>
            <input class="next-submit-button" type="submit" id="register-step-one" value="" />
            <input type="hidden" name="submit" />
        </form>  
    </div>
</div>

<script type="text/javascript">

$("#register-step-one").click(function() {
    $.ajax({
      type: "POST",
      success: function() {
        $('#register-form').html("Test");
      }
     });
    return false;
});

</script> 
```

但是，问题是，当通过 AJAX 加载页面时，脚本不起作用。但是，如果我刷新页面，脚本就可以工作。显然脚本不喜欢从 AJAX 调用中运行。

当通过 AJAX 调用加载脚本时，有没有办法使脚本工作？我知道我可以将脚本放入主页的页脚或其他东西，但我希望我能解决这个问题，因为我最终会在主页中获得大量脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T14:46:38.483

首先，您应该将函数包装在 a`.ready()`中，以确保在对这些元素执行某些操作之前加载所有 DOM 元素

此外，通过 jQuery 中的 ajax 函数返回的 HTML 中的脚本***仅在 HTML 附加到 DOM 时***才会执行。由于您没有附加包含代码的 html，因此返回内容中的脚本将不会运行。

看看[`.ajax()`](http://api.jquery.com/jQuery.ajax/)函数的参数，在`dataType`

> **数据类型：**
> 
> ...
> 
> “html”：以纯文本形式返回 HTML；包含的脚本标签**在插入 DOM 时进行评估。**
> 
> ...

# c# - 2D 数据结构 - 固定列 - 动态行

> ID：13219498
> 
> 赞同：0
> 
> 时间：2012-11-04T14:42:20.900
> 
> 标签：c#

我需要将字符串数据以表格的形式存储在内存中，列是固定的，但行会被添加到末尾。

`string[][]`如果我事先知道行，我想我可以使用二维字符串数组，但事实并非如此。

我目前已经创建了一个包含 3 个字段的自定义类并将它们存储在一个列表中，但我意识到这不是很优雅的解决方案，数据看起来像这样

> 艺术家名 1、专辑名 1、文件名
> 1 艺术家名 2、专辑名 2、文件名 2
> 艺术家名 3、专辑名 3、文件名 3
> 等等。

哪种数据结构最适合这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:46:14.823

你有很多选择取决于你想用它做什么。

```
// Usefull if it's not all strings
List<Tuple<int, string, string>> 
```

或者

```
// A list of array.
List<string[]> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T14:56:06.320

您应该创建一个自定义类：

```
public class Song 
{
    public string ArtistName { get; set; }
    public string AlbumName { get; set; }
    public string Filename { get; set; }
} 
```

然后你应该有一个列表：

```
var songs = new List<Song>(); 
```

这就是类的*用途*——不要回避它们。

如果您需要将每首歌曲作为字符串“获取”，您可以`.ToString`覆盖`Song`：

```
public override string ToString()
{
    return string.Format("{0}, {1}, {2}", ArtistName, AlbumName, Filename);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:46:00.577

您可以使用`List<string[]>`或`List<List<string>>`。第一种情况将允许您添加任意数量的行，并且列将被固定。第二种解决方案更加灵活，可以让您添加任意数量的列。

```
List<string[]> list = new List<string[]>();
string[] row = new string[3];
row[0] = "artist-name1";
row[1] = "album-name1";
row[2] = "filename1";
list.Add(row); 
```

或者

```
List<List<string>> list = new List<List<string>>();
List<string> row = new List<string>();
row.Add("artist-name1");
row.Add("album-name1");
row.Add("filename1");
list.Add(row); 
```

# c - 直接从用户程序访问系统调用

> ID：13219501
> 
> 赞同：11
> 
> 时间：2012-11-04T14:42:24.510
> 
> 标签：c, posix, system-calls

在 Ubuntu 上 - 内核 2.6.32.2

如何在没有任何库帮助的情况下直接从用户代码调用已经存在的系统调用？我在书籍和互联网上阅读以解决此问题，然后编写以下代码但仍然出现错误。请帮忙

想找出当前进程的进程id

```
#include <stdio.h>
#include<linux/unistd.h> // for __NR_getpid
_syscall0(int, getpid)

int main() {
 printf("Current Process ID : %d\n",getpid());
 return 0;
} 
```

编译时出错：

```
root@Omkant:~/os# gcc -Wall getpid.c -o getpid
getpid.c:5:16: error: expected declaration specifiers or ‘...’ before ‘getpid’
getpid.c:5:1: warning: data definition has no type or storage class
getpid.c:5:1: warning: type defaults to ‘int’ in declaration of ‘_syscall0’
getpid.c: In function ‘main’:
getpid.c:8:2: warning: implicit declaration of function ‘getpid’ 
```

代码中有什么问题？请帮忙...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-04T14:57:40.730

状态的联机帮助页`_syscall(2)`：

> 从内核 2.6.18 开始，_syscall 宏已从提供给用户空间的头文件中删除。请改用 syscall(2)。（一些架构，尤其是 ia64，从未提供 _syscall 宏；在那些架构上，总是需要 syscall(2)。）

因此，您想要的方法不适用于更现代的内核。（您可以清楚地看到，如果您在代码上运行预处理器。它不会解析`_syscall0`宏）尝试改用该`syscall`函数：

这是一个用法示例，引用自`syscall(2)`：

```
#define _GNU_SOURCE
#include <unistd.h>
#include <sys/syscall.h>
#include <sys/types.h>

int
main(int argc, char *argv[])
{
    pid_t tid;
    tid = syscall(SYS_gettid);
} 
```

当您要求在没有任何用户空间包装器的情况下直接调用 Linux 内核时，我将向您展示 80386 和 amd64 架构的示例。

首先，您必须从表中获取系统调用号，例如[这个](http://syscalls.kernelgrok.com/)表。在 的情况下`getpid`，amd64 的系统调用号为 39，80386 的系统调用号为 20。接下来，我们创建一个为我们调用系统的函数。在 80386 处理器上使用中断 128 来调用系统，在 amd64 上我们使用特殊`syscall`指令。系统调用号进入寄存器 eax，输出也写入该寄存器。为了使程序更简单，我们用汇编编写它。您可以稍后使用 strace 来验证它是否正常工作。

这是 80386 的代码。它应该返回其 pid 的最低字节作为退出状态。

```
 .global _start
_start: mov $20,%eax       #system call number 20:
        int $128           #call the system
        mov %eax,%ebx      #move pid into register ebx
        mov $1,%eax        #system call number 1: exit, argument in ebx
        int $128           #exit 
```

组装：

```
as -m32 -o 80386.o 80386.s
ld -m elf_i386 -o 80386 80386.o 
```

这是 amd64 的相同代码：

```
 .global _start
_start: mov $39,%eax    #system call 39: getpid
        syscall         #call the system
        mov %eax,%edi   #move pid into register edi
        mov $60,%eax    #system call 60: exit
        syscall         #call the system 
```

组装：

```
as -o amd64.o amd64.s
ld -o amd64 amd64.o 
```

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2012-11-05T11:28:37.210

“如何在没有任何库帮助的情况下直接从用户代码调用现有的系统调用？我在书籍和互联网上阅读以解决这个问题，然后编写以下代码但仍然出现错误”

您的问题就像询问如何在不使用 glibc/libc 的情况下使用 printf ，我想只有一种解决方案获取 printf 的源代码，将其粘贴到您的代码中并使用它

想找出当前进程的进程id

可以通过使用 libc 中的 getpid 函数找到进程 ID，该函数负责您的系统调用。

库中没有定义系统调用，这些是为访问内核数据而编写的函数。

问候，祖布拉伊

# php - DOMDocument - 如何替换嵌套元素

> ID：13219505
> 
> 赞同：1
> 
> 时间：2012-11-04T14:42:51.320
> 
> 标签：php, domdocument, domxpath

我有这个 html 片段：

```
<font color="#ff0000">Lorem <font size="4">ipsum dolor</font> sit amet</font> 
```

我想用 DOMDocument替换每个`font`标签。`span`那是我的功能 atm：

```
$fonts = $xPath->query('//font');
foreach($fonts as $font){
    $style = '';
    $newFont = $dom->createElement('span',$font->nodeValue);
    if($font->hasAttribute('size')){
        $size = $font->getAttribute('size');
        $style.='font-size:'.round($size/2,1).'em; ';
    }
    if($font->hasAttribute('color')){
        $style.='color:'.$font->getAttribute('color').'; ';
    }
    if($style!='') $newFont->setAttribute('style',$style);
    $font->parentNode->replaceChild($newFont,$font);
} 
```

我期望这个输出：

```
<span style="color:#ff0000; ">Lorem <span style="font-size:2em;">ipsum etc.. 
```

但我得到：

```
<span style="color:#ff0000; ">Lorem ipsum dolor sit amet</span> 
```

为什么？

* * *

我猜它的发生是因为`$font->parentNode->replaceChild($newFont,$font);`以某种方式用它的文本值替换了外部跨度......或者这个查询可能`$xPath->query('//font')`是错误的。我喜欢有经验的建议...谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T03:21:48.423

## 介绍

从以下对话

重新开始

> 为什么不简单地使用正则表达式？–

GionaF

> rekire 我已经这样做了很长时间，但我正在尝试切换到 DOMDocument / html5lib ...codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html`

我完全同意这就是为什么我认为这不是一个适合两者的工作，`DomDocument`因为`Regular Expresstion`您正在处理`depreciated HTML Tags`HTML 5 不再支持的问题

## 含义

这意味着这`font`不是您可能还必须更换的唯一问题

*   首字母缩略词
*   小程序
*   基本字体
*   大的
*   中央
*   目录
*   框架
*   框架集
*   无框
*   s
*   罢工
*   tt
*   xmp

## 使用整洁

我会推荐[Tidy](http://www.php.net/manual/en/intro.tidy.php)，它的设计目的是让你不必做你将要做的事情

**形成 PHP 文档**

> Tidy 是 Tidy HTML **clean** and **repair**实用程序的绑定，它不仅允许您清理和以其他方式操作 HTML 文档，**还可以遍历文档树**。

## 例子

```
$html = '<font color="#ff0000">Lorem <font size="4">ipsum dolor</font> sit amet</font>';
$config = array(
        'indent' => true,
        'show-body-only' => false,
        'clean' => true,
        'output-xhtml' => true,
        'preserve-entities' => true);

$tidy = new tidy();
echo $tidy->repairString($html, $config, 'UTF8'); 
```

输出

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
        <style type="text/css">
            /*<![CDATA[*/
            span.c2 {
                color: #FF0000
            }
            span.c1 {
                font-size: 120%
            }
            /*]]>*/
        </style>
    </head>
    <body><span class="c2">Lorem <span class="c1">ipsum dolor</span> sit amet</span>
    </body>
</html> 
```

另请参阅[通过删除额外/冗余格式标记来清理 HTML 以](https://stackoverflow.com/questions/10248166/cleaning-html-by-removing-extra-redundant-formatting-tags/10308209#10308209)获取示例

## 更好的门槛：HTMLPurifier

您可以使用**[HTMLPurifier](http://htmlpurifier.org/)**，它也使用 Tidy 来清理 HTML，您只需设置 TidyLevel

HTML Purifier 是一个用 PHP 编写的符合标准的 HTML 过滤器库。HTML Purifier 不仅会使用经过彻底审核、安全且允许的白名单**删除所有恶意代码**（更广为人知的 XSS），它还将确保您的**文档符合标准**，这只有通过全面了解 W3C 规范才能实现

```
require_once 'htmlpurifier-4.4.0/library/HTMLPurifier.auto.php';

$html = '<font color="#ff0000">Lorem <font size="4">ipsum dolor</font> sit amet</font>';
$config = HTMLPurifier_Config::createDefault();
$config->set('HTML.TidyLevel', 'heavy'); 
$purifier = new HTMLPurifier($config);
$clean = $purifier->purify($html);

var_dump($clean); 
```

输出

```
string '<span style="color:#ff0000;">Lorem <span style="font-size:large;">ipsum dolor</span> sit amet</span>' (length=100) 
```

## 我想要 DOMDocument

如果你想要的只是 dom 而你不关心我的所有解释，那么你可以使用

```
$html = '<font color="#ff0000">Lorem <font size="4">ipsum dolor</font> sit amet</font>';
$dom = new DOMDocument();
$dom->loadHTML($html);
$nodes = iterator_to_array($dom->getElementsByTagName('font'));
foreach ( $nodes as $font ) {
    $css = array();
    $font->hasAttribute('size') and $css[] = 'font-size:' . round($font->getAttribute('size') / 2, 1) . 'em;';
    $font->hasAttribute('color') and $css[]  = 'color:' . $font->getAttribute('color') . ';';
    $span = $dom->createElement('span');
    $children = array();
    foreach ( $font->childNodes as $child )
        $children[] = $child;
    foreach ( $children as $child )
        $span->appendChild($child);
    $span->setAttribute('style', implode('; ', $css));
    $font->parentNode->replaceChild($span, $font);
}
echo "<pre>";
$dom->formatOutput = true;
print(htmlentities($dom->saveXML())); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T19:03:28.057

使用 XSL 可以将标签更改为跨度。

```
<?php

$dom = new DOMDocument();

$dom->loadXML('<font color="#ff0000">Lorem <font size="4">ipsum dolor</font> sit amet</font>');

echo "Starting Point:" . $dom->saveXML() . PHP_EOL;

$xsl = new DOMDocument('1.0', 'UTF-8');
// Could be a seperate file
$xsl->loadXML(<<<XSLT
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0">

    <!-- Identity rule -->
    <xsl:template match="@*|node()"><xsl:copy><xsl:apply-templates select="@*|node()"/></xsl:copy></xsl:template>
    <xsl:template match="text()"><xsl:value-of disable-output-escaping="yes" select="."/></xsl:template>

    <xsl:template match="font">
        <xsl:element name="span">
            <xsl:attribute name="style" xsl:space="default">
                <xsl:if test="@size">font-size: <xsl:value-of select="round(@size * 10 div 2) div 10" /> em;</xsl:if>
                <xsl:if test="@color">color: <xsl:value-of select="@color" />;</xsl:if>
            </xsl:attribute>
            <xsl:apply-templates select="node()"/>
        </xsl:element>
    </xsl:template>
</xsl:stylesheet>
XSLT
);

$proc = new XSLTProcessor();
$proc->importStylesheet($xsl);
echo $proc->transformToXML($dom); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T17:28:18.323

您的代码示例似乎遇到了几个不同的问题。

1.  查询结果包含正在更改的项目
2.  $node->nodValue 不包含子节点

发现从 foreach 更改为一段时间，并多次运行查询解决了在更改树中查找节点的问题。

```
$fonts = $xPath->query('//font');
while ($fonts->length > 0) {
    $font = $fonts->item(0);

    // Get bits of data before touching the tree

    $style   = '';
    if($font->hasAttribute('size')){
        $size   = $font->getAttribute('size');
        $style .= 'font-size:' . round($size/2, 1) . 'em; ';
    }
    if($font->hasAttribute('color')){
        $style .= 'color:' . $font->getAttribute('color') . '; ';
    }

    // Create the new node

    $newFont = $dom->createElement('span');
    if(!empty($style)) {
        $newFont->setAttribute('style', $style);
    }

    // Copy all children into a basic array to avoid an iterator
    // on a changing tree
    $children = iterator_to_array($font->childNodes);
    foreach ($children as $child) {
        // This has a side effect of removing the child from its old
        // location, which changes the tree
        $newFont->appendChild($child);
    }

    // Replace the parent's child, which changes the tree
    $font->parentNode->replaceChild($newFont, $font);

    // query again on the new tree
    $fonts = $xPath->query('//font');
} 
```

# html - 发送一个执行 cmd 行的参数

> ID：13219512
> 
> 赞同：0
> 
> 时间：2012-11-04T14:43:17.677
> 
> 标签：html, cmd

大家好，我有一个带有一个参数“草稿”的表单，我想用发送按钮发送草稿以在命令行中执行一项功能。

```
 C:\PDF>pdfprint.exe -printer "docPrint" -firstpage 1 -lastpage 1 -wtext "Draft"
    -wo 100 -wa 50 -wf "Arial" C:\readme.pdf 
```

html表单代码

```
<FORM 
   ACTION="..........." 
   onReset="return confirm('Do you really want to reset the form?')"  >
     <INPUT TYPE=TEXT NAME="query">
     <INPUT TYPE=SUBMIT> 
     <INPUT TYPE=RESET VALUE="Start All Over">
</FORM> 
```

我应该在动作中插入什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:55:38.953

一旦该 HTML 成为常规网页的一部分，那么仅使用 HTML/JS 就无法做到这一点。您还需要一些服务器端语言来接受浏览器的请求，阅读发布的表格并根据收到的值做一些事情（在您的情况下 - 从 cmd 行运行打印机）。看看 PHP、asp.net 或其他任何你喜欢的东西（此外，它会打印在服务器上，而不是客户端机器上。JS 不允许你控制页面外客户端 PC 上发生的事情）。用户可能决定打印您的页面，在这种情况下，您可以添加特殊样式表链接：

```
<link rel="stylesheet" type="text/css" media="print" href="/css/print_message.css" /> 
```

例如，在我的项目中，当我不希望某些页面上的内容可用于打印时，我有这一行（print_message.css 将隐藏所有内容并显示有关打印受限的消息）。

# java - 视频检索技术

> ID：13219520
> 
> 赞同：0
> 
> 时间：2012-11-04T14:44:55.067
> 
> 标签：java, matlab, opencv, information-retrieval

嗨，用于视频检索的所有技术和算法。我应该选择 opencv 还是 matlab 哪个平台？我的输入是文本或图像查询，输出应该是包含文本或图像的相关视频，建议我这个项目的确切主题是哪种技术适合这个。请给我这个参考，也参考简单的视频检索源代码。帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:16:01.663

对于视频检索，您必须从索引数据集中的视频开始。这是逐帧完成以获取特征描述符（通常没有发表的论文仅选择动态特征丰富的帧）。

可以使用 Opencv 或 matlab 计算图像（视频帧）的特征描述符。在 c++ 和 matlab 实现中都有一个库，如 SURF、SIFT、MSER ..

之后，您必须为从视频中提取的特征建立一个所谓的“数据库”，一个选择是使用“词袋”模型。这也在 opencv 中实现，并且有 matlab 库，如 check [vlfeat.org](http://vlfeat.org)。在这种情况下，可以使用 image 进行查询。

对于视频中的文本搜索，可能你可以尝试提取视频的语义内容并将其与文本上下文匹配。或者在从视频帧中提取特征的同时，尝试提取文本，而不是使用“词袋”模型的某种数据库。

# android - 有没有办法让 android 设备回答寻址到广播地址的 icmp ping？

> ID：13219522
> 
> 赞同：3
> 
> 时间：2012-11-04T14:45:26.553
> 
> 标签：android, ping, broadcast, android-networking, icmp

我想以编程方式让我的设备在连接到 wifi 网络时响应广播 ping（即 ping 192.178.1.255）。

有没有办法我可以做到这一点？也许是一个会回复的侦听器，或者是在某处设置的标志？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:23:40.473

> 有没有办法我可以做到这一点？

简而言之：是的。但是集成必要的组件需要付出很大的努力。

关键问题是您需要侦听 ICMP 网络数据包。此类功能无法从 Java 访问，并且需要 JNI 代码或外部程序。（据我所知，它还需要有根设备。）

您将需要一个可以处理网络流量的库或程序，例如[Jpcap](http://netresearch.ics.uci.edu/kfujii/Jpcap/doc/)（需要进行[一些修改](https://stackoverflow.com/questions/8260977/is-it-possible-to-use-jpcap-with-android)才能在 Android 上运行）。您还可以在后台安装和运行 的实例[`tcpdump`](http://www.kandroid.org/online-pdk/guide/tcpdump.html)并解析其输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T16:06:38.650

应用程序无法在 Android 上发送/接收 ICMP Echo 请求。（也许有根设备上的方法）

但是，如果您的基本目标是实现某种本地设备发现功能（并且您的代码在所有设备上运行），则可以改用 UDP 广播/多播消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-20T15:00:05.603

我知道这个问题现在已经很老了，但是我遇到了这个问题来寻找答案并设法自己解决了。

我所做的是下载一个根文件资源管理器（我使用 JRummy Apps 的根浏览器）并导航到**/proc/sys/net/ipv4**编辑**icmp_echo_ignore_all**以便它是一个 1 行 1 个字符的文件，简单地说**0**（当我打开文件，它设置为1）

无需重新启动，ICMP 请求在保存后开始工作。

# uitableview - UIRefreshControl EXC_BAD_ACCESS

> ID：13219524
> 
> 赞同：2
> 
> 时间：2012-11-04T14:45:31.483
> 
> 标签：uitableview, uiviewcontroller, exc-bad-access, uirefreshcontrol

我正在尝试在 UIViewController 中实现 UIRefreshControl。我不能使用 UITableViewController 因为 tableView 只是我的 viewController 的一部分。

在大多数情况下，这种解决方法就像魅力一样。但有时（随机发生）应用程序崩溃`EXC_BAD_ACCESS code=1`

```
- (void)viewDidLoad {
    [super viewDidLoad];

    UIRefreshControl * refCon = [[UIRefreshControl alloc] init];
    [refCon addTarget:self selector:@selector(refresh:) forControlEvent:UIControlEventValueChanged];
    [tableView addSubView:refCon];
}

- (void)refresh:(UIRefreshControl *)sender {
    [NSThred detachNewThreadSelector:@selector(doRefresh:) toTarget:self withObject:sender];
}

- (void)doRefresh:(UIRefreshControl *)sender {
    [self checkUpdate];
    [self loadData];
    [sender endRefreshing];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T23:55:29.067

您正在`-endRefreshing`后台线程上调用。不要那样做。

而且，不能保证`UIRefreshControl`直接添加 a 作为子视图。`UITableView`您应该使用`UITableViewController`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-29T14:44:12.147

首先你在 UIRefreshControl 上放置一个标签

```
UIRefreshControl * refCon = [[UIRefreshControl alloc] init];
[refCon addTarget:self selector:@selector(refresh:) forControlEvent:UIControlEventValueChanged];
refCon.tag = 101 //for example
[tableView addSubView:refCon]; 
```

当 tableView 完成重新加载时，您输入：

```
UIRefreshControl *getRefreshControl = (UIRefreshControl*)[self.tablaPildoras viewWithTag:101];
[getRefreshControl endRefreshing]; 
```

# graphics - 通过 Windows Phone 模拟器使用专用图形

> ID：13219525
> 
> 赞同：1
> 
> 时间：2012-11-04T14:45:41.073
> 
> 标签：graphics, windows-phone-7.1

我的笔记本电脑上有两张卡：Intel HD 4000 和 GeForce 630。我想设置 Windows Phone Emulator 将只使用 GeForce 而不是 Intel。经理已阻止首选项（见屏幕）

[http://postimage.org/image/l1l3qpz31/](http://postimage.org/image/l1l3qpz31/)

使用 Intel 显卡会在模拟器中产生错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-07T21:58:19.890

我有完全相同的问题，所以这就是我所做的：

1.  在开始菜单中找到“Windows Phone Emulator”快捷方式。
2.  右键单击它并选择“使用图形处理器运行”->“高性能 NVIDIA...”。
3.  在加载了图像的模拟器后，我去了 VS 并选择在模拟器上运行我的应用程序。

# c - 在 Unix 中被中断时的行为 Read()

> ID：13219526
> 
> 赞同：0
> 
> 时间：2012-11-04T14:45:42.920
> 
> 标签：c, file, unix, file-handling

> **可能重复：**
> [Unix 系统中的文件 read() 函数](https://stackoverflow.com/questions/13218477/file-read-function-in-unix-systems)

假设 read() 函数读取了 10 个字节的数据并存储在缓冲区中。现在如果 unix 中的 read() 函数被信号中断，我重新启动 read 函数，如下所示，下一个字节将存储在哪里缓冲区，当前位置+1 或将从缓冲区的开头写入。

```
int r_read(int fd, void *buf, int size)
{
   while((retval=read(fd,buf,size))==-1 && errno ==EINTR);
  return retval;
} 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:53:04.880

正如您编码的那样，在得到`EINTR`它之后会`read`再次调用它，并`buf`作为内存的起始地址来存储数据。这看起来很合适。

但是，`read`当它读取部分数据时，可能会返回正数，在这种情况下你`while()`会中断。

# jquery - 使滑块响应 html5 音频时间更新

> ID：13219532
> 
> 赞同：2
> 
> 时间：2012-11-04T14:46:19.077
> 
> 标签：jquery, jquery-ui

我使用 jQuery UI 为 html5 音频播放器创建了一个滑块。我遇到的问题是滑块本身不响应`timeupdate`轨道本身的时间变化（）。然而，它确实会响应拖动滑块和歌曲，并`time`通过更改音频的时间来对此做出响应。

对我来说，在播放曲目时，滑块似乎受到了其他因素的影响，因为在播放`left: 0%`时滑块上有一个不变的样式，即使 jQuery 声明这应该改变。当我将 jQuery 设置`right: pos +'%`为正确时，样式会随音频动态变化，但`left: 0%`样式仍然存在。控制台中没有显示错误，所以我真的不知道发生了什么。

```
$(song).on('timeupdate', function() {

  var rem = parseInt(song.duration - song.currentTime, 10),
  pos = (song.currentTime / song.duration) * 100,
  mins = Math.floor(rem/60,10),
  secs = rem - mins*60;

  $('.body_container .player .time').text('-' + mins + ':' + (secs > 9 ? secs : '0' + secs));
  if(manualSeek = true){$('.body_container .player .ui-slider-handle').css({left: pos + '%'}); }
  if (loaded = true) {
  loaded = true;

    $('.body_container .player .slider').slider({

      max: song.duration,

      slide: function() {             
        manualSeek = true;
      },
      stop:function(e,ui) {
        manualSeek = false;         
        song.currentTime = ui.value;
      }

    });
   }

}); 
```

**旁注：**就像有人在上一个问题上提出的那样，我只是想我会说。`song`已定义我只是没有包含它，因为它不需要。从播放器的数据属性中获取的曲目 url 在`song = new Audio(url);`哪里。`url`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:05:13.377

你试过用'bind'代替'on'吗？前任：`$(song).bind('timeupdate',function(){})`

“on”我认为是针对点击事件的事件委托。

# ios6 - 如何在 iOS6 上创建深度纹理。R16F 是一个选项吗？

> ID：13219533
> 
> 赞同：0
> 
> 时间：2012-11-04T14:46:25.333
> 
> 标签：ios6, opengl-es-2.0, xcode4.5, depth-buffer

我正在尝试将深度写入纹理。我想要线性深度，所以我尝试使用我尝试使用 R16F 纹理。我定义了这样的纹理：

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_R16F_EXT, g_bufferWidth, g_bufferHeight, 0, 
             GL_RED_EXT, GL_HALF_FLOAT_OES, NULL);
glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0,
                       GL_TEXTURE_2D, g_texture, 0);    
glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, 
                      g_bufferWidth, g_bufferHeight); 
```

但是当在 iPhone5 上使用帧捕获在 Xcode 上进行调试时，我在颜色缓冲区中得到一个未知纹理，并且没有任何内容写入深度缓冲区。

我也尝试过创建深度纹理：

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_DEPTH_COMPONENT,  g_bufferWidth, g_bufferHeight, 0, GL_DEPTH_COMPONENT, GL_UNSIGNED_INT, NULL);
glFramebufferTexture2D(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_TEXTURE_2D, g_texture, 0); 
```

但在这种情况下，深度缓冲区中似乎也没有写入任何内容。

我可以将事物渲染到深度缓冲区的唯一方法似乎是将第一个纹理定义为 RGBA32 ...

EXT_color_buffer_half_float 和 depth 扩展在 iOS6 中不是处于活动状态吗？

# eclipse - 使用eclipse在tomcat中部署我的应用程序时出错

> ID：13219538
> 
> 赞同：0
> 
> 时间：2012-11-04T14:46:40.407
> 
> 标签：eclipse, tomcat

我有一个 Eclipse 动态网络项目。我有一个 Tomcat v7.0，我正在其上部署我的应用程序。当我启动我的 tomcat 服务器时，它会出现以下错误。

```
SEVERE: Error configuring application listener of class 
        com.sun.faces.config.ConfigureListener
        java.lang.ClassNotFoundException: com.sun.faces.config.ConfigureListener 
```

我知道它正在尝试读取 JSF 配置文件。我的库中没有 jsf-api.jar 和 jsf-impl.jar。我不想拥有它，因为它不是 JSF 项目。

它试图从哪里读取它？我该如何解决？我已经搜索过，但是大多数论坛都以“问题已解决”结束，而没有任何解释或解决步骤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:52:41.677

如果您的项目不需要 JSF，那么 Tomcat 是否说需要 JSF？尝试将这些 JAR 放在 Tomcat /lib 中。

或者，更好的是，只是告诉 Eclipse 他们暂时在哪里。您不需要以这种方式将它们放在您的 Tomcat 或 WAR 文件中。当您不使用 Eclipse 时，它​​会给您留下如何解决它的问题，但这将是前进的一步。

# android - 如何从 SD 卡加载和播放声音

> ID：13219539
> 
> 赞同：0
> 
> 时间：2012-11-04T14:46:50.167
> 
> 标签：android

我有使用 soundpool 播放声音的按钮。我想打开我的应用程序，然后从 SD 卡手动加载 .mp3 文件并用我的按钮播放。我的Java代码：

```
package com.example.idea;

    import android.media.SoundPool;
    import android.os.Bundle;
    import android.app.Activity;
    import android.view.Menu;
    import android.view.View;

    public class MainActivity extends Activity {
    SoundPool sp;
    int mSoundId;
    int mStreamId;
    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    mSoundId = sp.load(this, R.raw.sound1, 1);

}

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

    public void button1(View view){
    if (mStreamId != 0) {
    sp.stop(mStreamId);
}
    `mStreamId = sp.play(mSoundId, 1, 1, 1, 0, 1f);`
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:24:57.537

由于您的 SD 卡通常（但必须）是您的外部存储设备，因此我将在下面介绍这样的解决方案。（如果您的外部存储指向设备中的内部卡——例如在平板电脑上——我的代码将返回该文件夹的路径。）

因此，您应该使用另一个版本的 load 方法`SoundPool`，它需要文件路径（作为 a `String`）而不是资源 ID。这是该方法文档的[官方链接。](http://developer.android.com/reference/android/media/SoundPool.html#load%28java.lang.String,%20int%29)要获取文件的路径，可以使用以下方法：

```
private String getFullFilePath(Context context, String filename) {  
    File directory = context.getExternalFilesDir(null);
    File file = new File(directory, filename);
    if (!file.canRead()) {
        // error handling
    }
    return file.getAbsolutePath();  
} 
```

在这种情况下，您的相关代码段将如下所示：

```
String path = getFullFilePath(getApplicationContext(), "sound1.wav");
mSoundId = sp.load(path, 1); 
```

综上所述，上面的代码会在你的应用程序的外部存储目录中搜索文件。这是访问非内部存储文件的标准方式（即，如果外部存储是您的 SD 卡或其他东西，则取决于设备）。

* * *

**更新**：

当然，在使用外部存储之前，您应该检查媒体是否可读（如果有写入要求，可写）。[您可以在此官方页面](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)上找到更多信息。

# php - 如何在公共函数的数组中返回两个不同的结果？

> ID：13219541
> 
> 赞同：0
> 
> 时间：2012-11-04T14:46:59.380
> 
> 标签：php, zend-framework

我正在为搜索引擎制作 Zend 框架方法。因为我搜索不同的表，所以我还必须创建两个不同的选择变量并返回它。我的问题是：对于具有不同表格的搜索引擎来说，这是一个好主意吗？

以及如何在数组中返回不同的结果？( `fetchall->$selectMovies`, `fetchall->$selectPosts`)

谢谢和问候埃里克

```
public function search($keyword) {
        $selectPosts = $this->select();
        $selectPosts->from('posts', array('*'));
        $selectPosts->where('posts.post_title LIKE ? OR  posts.post_body LIKE ?', '%'. $keyword . '%' );

        $tblMovies = new Model_DbTable_Film();
        $selectMovies = $tblMovies->select();
        $selectMovies->from('film', array('*'));
        $selectMovies->where('film.titel LIKE ? OR  film.omschrijving LIKE ?', '%'. $keyword . '%' );

        //var_dump($this->fetchAll($selectPosts, $selectMovies)); die;
        return $this->fetchAll($selectMovies);
        return $this->fetchAll($selectPosts); 

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:51:29.640

您只能返回一次，但您可以做的是返回结果数组的数组。

```
<?php 
public function search($keyword) {
    $selectPosts = $this->select();
    $selectPosts->from('posts', array('*'));
    $selectPosts->where('posts.post_title LIKE ? OR  posts.post_body LIKE ?', '%'. $keyword . '%' );

    $tblMovies = new Model_DbTable_Film();
    $selectMovies = $tblMovies->select();
    $selectMovies->from('film', array('*'));
    $selectMovies->where('film.titel LIKE ? OR  film.omschrijving LIKE ?', '%'. $keyword . '%' );

    //var_dump($this->fetchAll($selectPosts, $selectMovies)); die;

    return array('movies'=>$this->fetchAll($selectMovies),
                 'posts'=>$this->fetchAll($selectPosts));
}
?> 
```

或者将您的方法拆分为 2 并将一种搜索类型作为参数传递给主搜索方法：

```
<?php 
public function search($keyword,$type) {
    return $this->{$type}($keyword);
}

public function search_movies($keyword) {
    $tblMovies = new Model_DbTable_Film();
    $selectMovies = $tblMovies->select();
    $selectMovies->from('film', array('*'));
    $selectMovies->where('film.titel LIKE ? OR  film.omschrijving LIKE ?', '%'. $keyword . '%' );
    return $this->fetchAll($selectMovies);
}

public function search_posts($keyword) {
    $selectPosts = $this->select();
    $selectPosts->from('posts', array('*'));
    $selectPosts->where('posts.post_title LIKE ? OR  posts.post_body LIKE ?', '%'. $keyword . '%' );
    return $this->fetchAll($selectPosts);
}
?>

<?php 
$result['movies'] = $model->search($keyword,'search_movies');
$result['posts'] = $model->search($keyword,'search_posts');
?> 
```

# jquery - 相对于另一个 div 移动一个 div

> ID：13219545
> 
> 赞同：0
> 
> 时间：2012-11-04T14:47:47.187
> 
> 标签：jquery, jquery-ui, html

我不完全知道如何制定这个问题，但基本上我的问题如下：我有 2 个可拖动的 div，我希望它们之间由较小的 div 链接。因此，假设 div A 是位置 0 的正方形，而 div B 是位置 10 的另一个正方形。我怎样才能将 div C 放在它们之间，这样如果我移动 div B 或 A ，C 就会留在它们之间。

由此 ：

```
A - - - - C - - - - B 
```

对此

```
A
  -
    -
      - 
        -
          C
             -
               -
                 -
                   -
                     B 
```

这甚至可能与divs？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:55:00.250

一个基本的算法是：

```
xCoord_ofC = (xCoord_ofA + xCoord_ofB) / 2;
yCoord_ofC = (yCoord_ofA + yCoord_ofB) / 2; 
```

如果您使用的是 jQuery UI，您可以在`drag`侦听器中执行此操作。

# python - 为每次迭代创建一个新的 csv 列列表

> ID：13219546
> 
> 赞同：1
> 
> 时间：2012-11-04T14:47:49.827
> 
> 标签：python, csv, multiple-columns

我正在尝试编写一个看起来像[这样](http://imgur.com/Dw1no)的 csv 文件。我得到的是[这个](http://imgur.com/eKDuW)，所有数据都输出为两个长列。这是代码。

```
import requests
import csv

item_dictionary = {'10350': 'Third-Age Full', '560':'Death Rune'}
item_ids = item_dictionary.keys()
url_template = 'http://www.grandexchangecentral.com/include/gecgraphjson.php?jsid=%r'

sites = []
for i in range(0, len(item_ids)):
    result = url_template % item_ids[i]
    sites.append(result)

def data_grabber(item): 
    url = item
    r = requests.get(url, headers={'Referer': 'www.grandexchangecentral.com'})
    data = r.json  
    prices = [i[1] for i in data]
    return prices

data = map(data_grabber, sites)

names = item_dictionary.values()

filler = []
for i in range(0,365):
    filler.append(None)

myfile = open('prices.csv', 'wb')
headers = [names[0], 'Percent Change', None, names[1], 'Percent Change', None]
wr = csv.writer(myfile)
wr.writerow(headers)   

for x in data:
    q = data.index(x) 
    a = data[q]
    percents = [100.0 * a1 / a2 - 100 for a1, a2 in zip(a[1:], a)]
    percents.insert(0, None)
    f = zip(data[q], percents, filler)
    wr.writerows(f)

myfile.close() 
```

我认为问题在于`f = zip(data[q], percents, filler)`. 当我希望它创建两个新列时，它似乎在它下面写了`data[0]`又写。`data[1]`有没有人对如何纠正这个有任何想法？谢谢。

# android - 如何使用 Achartengine 删除动态更新图表中的自动缩放？

> ID：13219549
> 
> 赞同：1
> 
> 时间：2012-11-04T14:48:00.980
> 
> 标签：android, charts, achartengine

我想在更新图表期间取消自动缩放并获得“移动”图表（当我添加新数据时）而不缩放它的效果。我希望你知道我想要达到的目标。

这是我声明图表的一段代码：

```
 mDataset = new XYMultipleSeriesDataset();

    mRenderer = new XYMultipleSeriesRenderer();
    mRenderer.setAxesColor(Color.BLUE);
    mRenderer.setAxisTitleTextSize(16);
    mRenderer.setChartTitle("Accelerometer monitor");
    mRenderer.setChartTitleTextSize(15);
    mRenderer.setFitLegend(true);
    mRenderer.setGridColor(Color.LTGRAY);
    mRenderer.setPanEnabled(true, false);
    mRenderer.setZoomEnabled(false, true);
    mRenderer.setPointSize(1);
    mRenderer.setXTitle("Time");
    mRenderer.setYTitle("Value");
    mRenderer.setMargins(new int []{20, 30, 15, 0});
    mRenderer.setZoomButtonsVisible(true);
    mRenderer.setBarSpacing(10);
    mRenderer.setShowGrid(true);

    mSeriesRendererX = new XYSeriesRenderer();
    mSeriesRendererX.setColor(Color.RED);

    mSeriesRendererY = new XYSeriesRenderer();
    mSeriesRendererY.setColor(Color.GREEN);

    mSeriesRendererZ = new XYSeriesRenderer();
    mSeriesRendererZ.setColor(Color.BLUE);

    mRenderer.addSeriesRenderer(mSeriesRendererX);
    mRenderer.addSeriesRenderer(mSeriesRendererY);
    mRenderer.addSeriesRenderer(mSeriesRendererZ);

    mSeriesRendererX.setFillPoints(true);
    mSeriesRendererX.setPointStyle(PointStyle.CIRCLE);
    mSeriesRendererY.setFillPoints(true);
    mSeriesRendererY.setPointStyle(PointStyle.CIRCLE);
    mSeriesRendererZ.setFillPoints(true);
    mSeriesRendererZ.setPointStyle(PointStyle.CIRCLE);

    mTimeSeriesX = new TimeSeries("x");
    mTimeSeriesY = new TimeSeries("y");
    mTimeSeriesZ = new TimeSeries("z"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T16:18:44.303

您可以通过手动设置轴上的可见范围来控制缩放：

```
mRenderer.setXAxisMin(xMinValue);
mRenderer.setXAxisMax(xMaxValue);
mRenderer.setYAxisMin(yMinValue);
mRenderer.setYAxisMax(yMaxValue); 
```

# php - 使用 git 自动将 php 部署到多台机器

> ID：13219555
> 
> 赞同：0
> 
> 时间：2012-11-04T14:49:21.667
> 
> 标签：php, deployment

我有 40 台服务器遍布全球。所有运行 centos 灯。
我正在使用 git，我希望对`production`分支的每个更改都部署到每台机器上。每台机器都有自己的`config.php`文件和很少的其他机器特定文件。

目前提交`production`使用 phing 运行 phpunit 测试、php-md、cpd 等来分支触发 hudson 构建任务。问题是，如何将它部署到我的每台机器上，最好在每台更新的服务器上运行 selenium 测试，在使它成为现实之前。

我研究了 capistrano，但我完全不想混合 ruby​​ 并在我的团队中添加这个依赖项。

您对 php 多服务器 CI 部署的建议？

## 变体 1

作为一个选项，在提交时运行 web-hook，`phing`在每台机器上启动构建，在构建配置中，我将指定要克隆的存储库、要保留的文件以及要替换的文件。
虽然如果我突然推送一个错误的`build.xml`文件，这会失败，这将阻止我在没有 40 次手动中断的情况下重建/恢复。+ 没有还原选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T08:34:58.283

最后得到了一点定制的[git flow](http://nvie.com/posts/a-successful-git-branching-model/)，其中一个`post-receive`钩子通过 CI 服务器触发了构建脚本。构建结果放置在最近与[`rsync`](http://rsync.samba.org/)所有这 40 台服务器同步的文件夹中。

每个服务器的 config.php 已留在 git repo 本身中
，并且 php 的`auto_perpend_file`指令在配置中设置为为当前服务器`vhost`加载正确的 文件。`config.php`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T16:43:24.637

如果您当前正在使用 Phing，您可以简单地使用[Jenkins](http://jenkins-ci.org/)每隔几分钟轮询您的存储库以获取更改，然后使用 Phing 开始部署。

我假设您的构建脚本正在使用正确的配置文件将文件上传到您的每个环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-05T15:57:09.170

好吧，如果你想部署到服务器上，你可以使用 deployhq.com 之类的服务，或者如果你更喜欢自己做，可以看看[deployogi](https://github.com/coderofsalvation/deployogi)。它基于 bash 和 deployogi-hooks，这些钩子可以是 phpscripts（或任何具有 755 模式的东西）。

# jsf - 在数据表中调用托管 bean 方法

> ID：13219558
> 
> 赞同：1
> 
> 时间：2012-11-04T14:49:30.213
> 
> 标签：jsf

我遇到了这个问题：我有一个包含类型测试类对象列表的数据表，并且我有一个名为“分配给”的列，我想在其中显示该行中显示的测试分配给的用户的名称，所以我写了一个方法来做到这一点：

```
<p:column headerText="Assigned to">  
    <h:outputText value="#{projectCampaignManagementMB.initAssignedToData(test)}" />
</p:column> 
```

我收到此错误： `nov. 04, 2012 4:42:06 PM com.sun.faces.context.PartialViewContextImpl$PhaseAwareVisitCallback visit Grave: javax.el.ELException: /campaingManagement.xhtml @2388,132 value="#{projectCampaignManagementMB.initAssignedToData(test)}": java.lang.NullPointerException`

这是所有代码：

```
<p:dataTable var="test" value="#{projectCampaignManagementMB.campaignTestList}" >  
    <p:column headerText="User">  
    </p:column>  

    <p:column headerText="Assigned to">  
        <h:outputText value="#{projectCampaignManagementMB.initAssignedToData(test)}" />
    </p:column>

</dataTable> 
```

方法 ：

```
public String initAssignedToData(Test pTest){

    int assigendID = currentCampaign.getAssignedUserID(pTest);

    User pUser = (User) userByID.get(new Integer(assigendID));

    System.out.println("User assigned is = " + pUser + " , assigendID = " + assigendID);

    return(((User) userByID.get(new Integer(assigendID))).getLoginFromModel()); // TO CHANGE

} 
```

那么有没有另一种方法来实现这一点。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T16:42:39.503

检查您的`projectCampaignManagementMB`bean 是否`@ViewScoped`至少是并且`initAssignedToData`方法中的所有元素都不`null`是通过调试或使用日志系统。

`String`在调用数据表之前将其加载到对象的属性中会更好（为了性能）`Test`（您有 bean 构造函数和`@PostConstruct public void init()`）。否则，`initAssignedToData`JSF 框架可能会多次调用它。有关此的更多信息：

*   [为什么 JSF 多次调用 getter](https://stackoverflow.com/q/2090033/1065197)。

# objective-c - 以编程方式创建的 Tableview 为空

> ID：13219559
> 
> 赞同：0
> 
> 时间：2012-11-04T14:49:30.580
> 
> 标签：objective-c, uitableview, ios6

Tableview 显示但为空，无法理解我忘记了什么：

```
#import <UIKit/UIKit.h>

@interface MenuViewController : UIViewController<UITableViewDataSource, UITableViewDelegate>
@property (strong, nonatomic) UITableView *table;
@end

#import "MenuViewController.h"

@interface MenuViewController ()

@end

@implementation MenuViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    _table.delegate = self;
    _table.dataSource = self;
    _table = [[UITableView alloc]initWithFrame:self.view.bounds style:UITableViewStylePlain];
    [self.view addSubview:_table];
    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}
- (void)viewWillAppear:(BOOL)animated{
    [super viewWillAppear:animated];
    NSLog(@"%s",__PRETTY_FUNCTION__);
    [_table reloadData];
}
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return 4;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    if (cell == nil) {

        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    }

    cell.textLabel.text = @"text";

    // Configure the cell...

    return cell;
}
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return 25;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:57:36.000

在实例化它之前，`viewDidLoad`您正在分配变量的`dataSource`and 。因此，当您初始化变量时，它会覆盖已经存在的任何内容。`delegate``_table``_table`

如果您在分配委托和数据源之前移动初始化调用，它应该可以正常工作：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    _table = [[UITableView alloc]initWithFrame:self.view.bounds style:UITableViewStylePlain];
    _table.delegate = self;
    _table.dataSource = self;
    [self.view addSubview:_table];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:58:27.720

只需评论这一行：

```
[self.view addSubview:_table]; 
```

# javascript - Javascript 使用类而不是 id

> ID：13219560
> 
> 赞同：1
> 
> 时间：2012-11-04T14:49:30.813
> 
> 标签：javascript

我有下面的代码，因为它不验证我想从输入框中删除 id 并使 Javascript 使用类 (class="filterCat") 而不是 id。我怎么做？

谢谢。

```
<form id="adv_searchform" action="/" method="get" name="adv_searchform" onsubmit="return manageMultipleCategoriesSearch()">
  Search: 
  <input id="adv_s" class="input input_large" type="text" name="s" value="" />
  <h3>Category filter:</h3>
  <ul id="catSearchFilters">
<li><input type="checkbox" id="filterCat" class="filterCat" value="38">Announcements</li>
<li><input type="checkbox" id="filterCat" class="filterCat" value="39">Commentary</li>
<li><input type="checkbox" id="filterCat" class="filterCat" value="1">Uncategorized</li></ul>  <div class="clear"></div>
  <input type="hidden" name="cat" value="" />
  <input type="submit" id="searchsubmit" value="Search" />
</form>

<script>
function manageMultipleCategoriesSearch(){

  var selectedCats = "";
  var isFirst = true;

  for (i=0; i<document.adv_searchform.filterCat.length; i++){
    if (document.adv_searchform.filterCat[i].checked == true){

    if (!isFirst)
      selectedCats += ',';

      selectedCats += document.adv_searchform.filterCat[i].value;
      isFirst = false;
    }
  }

  document.adv_searchform.cat.value = selectedCats;

  return true;
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:51:47.730

使用名称而不是 ID。并且您应该为不同的复选框使用不同的名称。

```
<li><input type="checkbox" name="filterCat1" class="filterCat" value="38">Announcements</li>
<li><input type="checkbox" name="filterCat2" class="filterCat" value="39">Commentary</li>
<li><input type="checkbox" name="filterCat3" class="filterCat" value="1">Uncategorized</li></ul>  <div class="clear"></div> 
```

JS

```
var check = document.getElementsByClassName("filterCat");
for (i=0; i<check .length; i++){
    if (check[i].checked == true){

    if (!isFirst)
      selectedCats += ',';

      selectedCats += check [i].value;
      isFirst = false;
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:52:18.447

采用：

```
document.getElementsByClassName('filterCat') 
```

# function - 将 haskell 函数转换为使用字节字符串

> ID：13219563
> 
> 赞同：3
> 
> 时间：2012-11-04T14:49:47.070
> 
> 标签：function, haskell, binary

我得到了这个代码，它接受一个整数“n”和一个列表，然后将列表拆分为“n”个列表。

```
chunk n xs = chunk' i xs
  where
    chunk' _ [] = []
    chunk' n xs = a : chunk' n b where (a,b) = splitAt n xs
    i = ceiling (fromIntegral (length xs) / fromIntegral n) 
```

这是它如何工作的一个例子：

```
*Main> chunk 5 [1..10]
[[1,2],[3,4],[5,6],[7,8],[9,10]] 
```

我一直试图让它与 Data.ByteString 库一起使用，但无法弄清楚。

这是我一直在尝试使用的代码。

```
import qualified Data.ByteString as B
B.readFile "meow.txt" >>= (\x -> return $ chunk 4 x) 
```

这是它给我的错误：

```
<interactive>:402:51:
    Couldn't match expected type `[a10]'
                with actual type `B.ByteString'
    In the second argument of `chunk', namely `x'
    In the second argument of `($)', namely `chunk 4 x'
    In the expression: return $ chunk 4 x 
```

这似乎是一个类型不匹配的问题，我假设是因为`fromIntegral`. 有没有办法让块函数接受字节字符串？

我使用此功能的目标是严格接受任意长度的二进制文件，然后将其拆分为长度大致相等的 4 段，而不会丢失过程中的任何数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:10:10.867

字节字符串不是列表。您将不得不编写一个单独的函数。

但这是一个简单的翻译。假设你有`import qualified Data.ByteString as B`，那么

```
chunkBytes :: Int -> B.ByteString -> [B.ByteString]
chunkBytes n xs = chunk' i xs
  where
    chunk' n xs
        | B.null xs = []
        | otherwise = a : chunk' n b where (a,b) = B.splitAt n xs
    i = ceiling (fromIntegral (B.length xs) / fromIntegral n) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T16:23:08.223

您也可以使用[listlike](http://hackage.haskell.org/package/ListLike-3.1.6)包。它创建了一个统一的 API 来处理列表、`ByteString`s`Text`等。所以你可以这样写：

```
import qualified Data.ListLike as LL

chunk :: (Integral n, LL.ListLike l a) => n -> l -> [l]
chunk n xs = chunk' i xs
  where
    chunk' n xs | LL.null xs = []
                | otherwise = a : chunk' n b where (a,b) = LL.splitAt n xs
    i = ceiling (fromIntegral (LL.length xs) / fromIntegral n) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T15:10:47.853

ByteString 不是一个列表，所以你不能用它来遍历它`Prelude.splitAt`，它是从 Data.List 导出的，你应该使用它`B.splitAt`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T10:51:18.860

模式匹配是低级的，它严格使用值构造函数来匹配它。[] 和 (:) 是列表类型 [a] 的值构造函数。字节串构造器是不同的，通常对用户不是很有用。

我们已经看到对基于值的形状的更高级别匹配形式的一些兴趣，例如“可遍历”值。但据我所知，目前还没有任何实现。

# asp.net - 使用多个 HttpContext.Current.Server.Execute 时出错

> ID：13219566
> 
> 赞同：0
> 
> 时间：2012-11-04T14:50:14.570
> 
> 标签：asp.net

我有模板，比如`cart.aspx`和`mail.aspx`。我正在向它们传递一些变量并使用此代码获取结果视图

```
MySession2.Current.customer = customer;
StringWriter _writer = new StringWriter();
HttpContext.Current.Server.Execute("mail.aspx", _writer);
modal_info_text.InnerHtml = _writer.ToString(); 
```

在第一行中，我将变量放入会话中。在我的`mail.aspx`文件中，我得到了这个变量。在其他行中，我得到了我的结果视图`mail.aspx`并将其放入我的 div。

所以，如果我只使用它就没有问题。但我需要使用另一个模板 - `cart.aspx`-。因此，如果我使用相同的代码`cart.aspx`并将其放入我的购物车 div，则会出现错误。这是错误：

`The state information is invalid for this page and might be corrupted.`

当我使用不止一个时有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:31:31.987

一个可能的罪魁祸首可能是 ViewState。在 cart.aspx（或 mail.aspx）中对其进行任何更改（在 ViewState 中添加或删除项目）都可能导致这种情况发生。我猜您正在尝试将相同的模板（购物车和邮件）重新用于完整页面视图以及注入另一个页面。更好的方法可能是将可重用组件放入用户控件 (ascx) 并根据需要进行渲染。

# lua - LuaLanes 和 LuaSockets

> ID：13219570
> 
> 赞同：6
> 
> 时间：2012-11-04T14:50:53.607
> 
> 标签：lua, luasocket, lua-lanes

我正在开发一个使用套接字与外界通信的小型 Lua 应用程序（在 Lua for Windows 下，如果这很重要）。(LuaSocket)

我正在尝试同时提出几个请求。所以我认为 LuaLanes 是要走的路。（当然，如果有更好的解决方案，我愿意接受替代方案，但不希望为此处理协程。）

像这样的东西：

```
server = assert (socket.bind ('*', 1234))
client = server : accept ()
-- set id to some unique value
allClients [id] = client
theLane = lanes.gen ("", laneTest) ( id )
print (theLane [1]) 
```

其中`laneTest`函数定义如下：

```
function laneTest (id)
    local client = allClients [id]
    print ('peer: ', client:getpeername())
end 
```

我的问题是，在`laneTest`函数内部，当作为车道运行时，我收到这个可爱的错误消息：

> 尝试索引本地“客户端”（用户数据值）

（从线`client:getpeername()`）

所以..我不确定这里发生了什么？通道与套接字不兼容，还是我做错了什么？

我想这可能是 Lua for Windows 附带的通道版本是古老的（[luaforwindows](http://code.google.com/p/luaforwindows/)）并且不适用于套接字，但最新版本可能？（车道 2.0.4 与更新的 3.xx）

我真的不知道如何更新我拥有的 Lanes 版本，否则我现在已经尝试过了，所以。如果那是我可能要去的地方，或者有更明显的事情表明我做错了，我将不胜感激。

*编辑*：我继续通过 luarocks 安装了车道，并且使用安装为岩石的车道 3.1.6-1 遇到了同样的问题。

*编辑2*：试过这个（但仍然失败）：

```
require ('socket')
require ('lanes')
local allClients = {}

function theLane (id)
    print ('the id:', id) -- correctly prints out the id passed to the function
    local SOCKET = require ('socket')
    local client = allClients [id]
    print ('peer:', client:getpeername())
    client : close ()
end

local server = assert (SOCKET.bind ('*', 1234))
local ip, port = server:getsockname ()
local laneFunc = lanes.gen('', theLane)
local client = server:accept ()
allClients [1] = client
local x = laneFunc (1)
print (x[1]) 
```

1.  这未能声称：`attempt to call global 'require' (a nil value)`
2.  删除`require ('socket')`函数内的行并重试也失败说：`attempt to index local 'client' (a userdata value)`

我为错过明显的事情提前道歉，但是......你如何让套接字与车道一起工作？

编辑3：

好吧，我正在编辑它以供将来参考:)

据我所知，没有修补luasockets就无法使用带有套接字的通道。有关更多信息，请参见[此处](http://kepler-platform-mailing-list.1133559.n2.nabble.com/Lanes-and-Luasocket-an-evil-little-patch-td5537882.html)的讨论；但简而言之（正如德科的回答中所解释的那样）：车道不适用于用户数据。luasocket 不提供任何其他访问套接字/套接字信息的方式。

我不想修补 luasocket，就像我宁愿使用车道一样，我会继续坚持使用 copas 或 couroutines。

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T20:30:50.350

Lua Lanes 为每个通道创建一个全新的（但最小的）Lua 状态。任何传递的上值或参数都被复制，而不是被引用；这意味着正在复制您的 allClients 表以及它包含的套接字。

发生错误是因为套接字是用户数据，如果没有 C 模块的一些建议，Lua Lanes 不知道如何复制。不幸的是，LuaSocket 没有提供这样的建议。（有一些方法可以解决这个问题，但要小心：LuaSocket*不是*线程安全的，同步错误很难追踪。）

虽然它不能解决您的问题，但您应该注意，您需要在生成的通道中使用 LuaSocket；默认情况下不复制。

# 解决方案！

这些是从易到难排序的（主要是从我的其他答案转录而来[）](https://stackoverflow.com/a/12890914/837856)。

## 单线程轮询

LuaSocket中反复调用轮询函数：

*   阻塞：`socket.select`不带时间参数的调用并等待套接字可读。
*   非阻塞：`socket.select`使用超时参数调用`0`，并`sock:settimeout(0)`在您正在读取的套接字上使用。

只需重复调用这些。我建议对非阻塞版本使用[协程调度程序，以允许程序的其他部分继续执行而不会造成太多延迟。](https://gist.github.com/1818054)

（如果您选择此解决方案，我建议您查看[Paul 的回答](https://stackoverflow.com/questions/13219570/lualanes-and-luasockets/13223515#13223515)。）

## 双线程轮询

您的主线程根本不处理套接字。相反，它产生了另一个需要 LuaSocket 的通道，处理所有客户端并通过[linda](http://kotisivu.dnainternet.net/askok/bin/lanes/#lindas)与主线程通信。

这可能是您最可行的选择。

## 多线程轮询

与上面相同，除了每个线程处理所有客户端的一个子集（1 比 1 是可能的，但是随着大量客户端的出现收益递减）。

我已经做了一个简单的例子，可以[在这里找到](https://gist.github.com/4026258)。它依赖于 Lua Lanes 3.4.0 ( [GitHub repo](https://github.com/LuaLanes/lanes/) ) 和修补过的 LuaSocket 2.0.2 ( [source](http://luarocks.org/repositories/rocks/#luasocket) , [patch](http://www.net-core.org/dl/luasocket-2.0.2-acceptfd.patch) , [blog post re' patch](http://www.net-core.org/39/lua/patching-luasocket-to-make-it-compatible) )

结果是有希望的，但如果你从中派生出我的示例代码，你肯定应该重构它。

## [LuaJIT](http://luajit.org/luajit.html) + ENet

[ENet](http://enet.bespin.org/)是一个很棒的库。它提供了 TCP 和 UDP 之间的完美组合：需要时可靠，否则不可靠。它还抽象了操作系统特定的细节，就像 LuaSocket 一样。你可以使用 Lua API 来绑定它，或者直接通过[LuaJIT 的 FFI](http://luajit.org/ext_ffi.html)访问它（推荐）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T22:18:27.203

Programming Lua 有关于[非抢占式多线程](http://www.lua.org/pil/9.4.html)（使用协程）的示例，您几乎可以直接使用它。在我看来，协程将是您用例的更好解决方案。

还有一个[copas 库](http://keplerproject.github.com/copas/index.html)，它把自己描述为“一个基于协程的调度程序，可以被 TCP/IP 服务器使用”，但实际上你也可以使用它来异步发送请求（使用`addthread`和`step`调用的组合）。

# prolog - Prolog 填字游戏约束

> ID：13219576
> 
> 赞同：0
> 
> 时间：2012-11-04T14:51:24.607
> 
> 标签：prolog, logic

我在下面有一个相当简单的问题，我必须回答：

```
crossword(V1, H1) :- word(V1, X, X, X), word(H1, X, X, X). 
```

任何合理的词都会满足这条规则的约束吗？

我对此的反应是，对三个字母词的三重约束肯定不是“合理的”，而且据我所知不存在这样的词。

我这样说对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T11:02:42.120

不，你不正确。

在您为 Word/4 定义规则之前，约束可以是任何东西，并且肯定有一组 3 个可以满足的约束。

喜欢

```
word(Var,A,B,C):- A=c,B=a,C=t. 
```

你确定你问的是你想回答的问题吗？

```
crossword(V1, H1) :- word(V1, X, X, X), word(H1, X, X, X). 
```

如果没有为 word/4 定义规则（可能还有事实），则意味着什么

# java - 对所有 JPA 查询进行分页

> ID：13219578
> 
> 赞同：0
> 
> 时间：2012-11-04T14:51:29.813
> 
> 标签：java, jakarta-ee, jpa

我正在创建一个 Web 服务，我想知道是否有解决方案来对所有查询进行分页。目前我正在创建诸如`findAll(int offset, int limit)`etc 之类的重载方法。但我想知道是否有另一种解决方案不会在查找器中创建太多的逻辑重复。我想在数据库级别做到这一点。还是我想出一个好的方法的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:02:21.927

如果重复是主要问题，我认为您可能希望使用方法重载来避免逻辑重复。

1.  如您所述，更改所有现有`findAll`方法以支持分页：

    ```
    findAll(int offset, int limit) 
    ```

2.  然后创建重载方法并使用默认值在`findAll()`内部调用步骤 1 中创建的方法，例如：`findAll`

    ```
    findAll(){
      //set appropriate defaults, Integer.MAX_VALUE is just an example 
      findAll(0, Integer.MAX_VALUE);
    } 
    ```

# tomcat - grails战争文件与tomcat上的常规java战争文件冲突

> ID：13219579
> 
> 赞同：0
> 
> 时间：2012-11-04T14:51:41.297
> 
> 标签：tomcat, grails, war

我有两个项目：一个是用 spring 框架编写的，另一个是用 grails 编写的。我尝试将它们部署在 tomcat （版本 6 和 7 ）中。每个都运作良好。但是，当我同时放置它们时，Tomcat 卡住了。日志中没有错误。它只是挂在那里。

当我从tomcat的webapp中删除任何一个项目时。Tomcat 又开始工作了。

有人可以给我一些提示或建议吗？

谢谢。

# sql - SQL 查询 - 结合 DISTINCT 和 TOP？

> ID：13219582
> 
> 赞同：8
> 
> 时间：2012-11-04T14:51:51.850
> 
> 标签：sql, sql-server, join, distinct

我有以下要触发的查询：

```
SELECT DISTINCT TOP(5) fp.PostId FROM dbForumPosts fp
LEFT JOIN dbForumEntry fe ON fp.PostId = fe.PostId
Order by fe.Datemade DESC 
```

但是，当我触发它时，我得到了错误：

```
Msg 145, Level 15, State 1, Line 1
ORDER BY items must appear in the select list if SELECT DISTINCT is specified. 
```

我试图更改查询，所以它改用 GROUP BY，但后来我遇到了以下问题：

```
Msg 8127, Level 16, State 1, Line 4
Column "dbForumEntry.Datemade" is invalid in the ORDER BY clause because it is not contained in either an aggregate function or the GROUP BY clause. 
```

**我想要什么：**

把它想象成一个论坛。有帖子 (dbForumPosts) 和条目 (dbForumEntry)。公关帖子有 0 多个条目。

我想要的是获取具有最新活动的帖子（包含最新更新条目的帖子）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T14:59:09.590

您可以`Datemade`使用`PostId`. `row_number`然后您可以搜索最近的 5 个帖子：

```
select  top 5 PostId
from    (
        select  PostId
        ,       Datemade
        ,       row_number() over (partition by PostId
                    order by Datemade) as rn
        from    dbForumEntry
        ) SubQueryAlias
where   rn = 1 -- Most recent row per PostId
order by
        Datemade desc 
```

或者，您可以使用`group by`子查询实现相同的目的：

```
select  top 5 PostId
from    (
        select  PostId
        ,       max(Datemade) as LastDate
        from    dbForumEntry
        group by
                PostId
        ) SubQueryAlias
order by
        LastDate desc 
```

如果`dbForumEntry`有一个 ID 列（比如`ForumEntryId`），这样的查询可能会执行得更好。数据库可以在不编译整个表的`row_number`情况下运行它。`max(Datemade)`

```
select  top 5 PostId
from    dbForumPosts fp
where   not exists -- No later entry for the same post exists
        (
        select  *
        from    dbForumPosts fp2
        where   fp2.PostId = fp.PostId
                and fp2.ForumEntryId > fp.ForumEntryId
        )
order by
        Datemade desc 
```

# python-2.7 - Python函数练习题

> ID：13219585
> 
> 赞同：0
> 
> 时间：2012-11-04T14:52:20.587
> 
> 标签：python-2.7

我自学python，我有点困惑

```
#!/usr/bin/python

def Age():
        age_ = int(input("How old are you? "))

def Name():
        name_ = raw_input("What is your name? ")

def Sex():
        sex_ = raw_input("Are you a man(1) or a woman(2)? ")
        if sex_ == 1:
                man = 1

        elif sex_ == 2:
                woman = 2

        else:
                print "Please enter 1 for man or 2 for woman "

Age()
Name()
Sex()
print "Your name is " + name_ + " you are " + age_ + " years old and you are a " + sex_ + "." 
```

**错误**

> 文件“./functions2.py”，第 25 行，打印“你的名字是”+name_+“你是”+age_+“岁，你是”+sex_+“。” NameError：名称'name_'未定义

当然它是在`Name()`函数中定义的？我很困惑 ：（

* * *

Arr 我现在感谢它提供了更多的新证明，我现在在 Sex() 函数中遇到了问题。它在打印中返回一个数字而不是“男人”或“女人”这个词，所以我更改了代码以尝试修复它。但是我现在收到以下错误文件

```
"./functions2.py", line 16
    2 = woman
SyntaxError: can't assign to literal 
```

我试图使 2 成为 str(2) 但它给了我另一个错误。感谢您到目前为止的帮助

```
#!/usr/bin/python

def Age():
    age_ = raw_input("How old are you? ")
    return age_
def Name():
    name_ = raw_input("What is your name? ")
    return name_
def Sex():
    sex_ = str(raw_input("Are you a man or a woman? "))
    if sex_ == 1:
            1 = man
            return sex_

    elif sex_ == 2:
            2 = woman
            return sex_

    else:
            print "Please enter man or woman "

age_ = Age()
name_ = Name()
sex_ = Sex()

print "Your name is " + name_ + " you are " + age_ + " years old and you are a " + sex_ + "." 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T09:08:22.867

我已经更改了 "man" "1" 1 等以匹配问题。我也更改`str(raw_input("Are you a man..."))`为`input("Are you a man...")`反映数据类型。

```
def Age():
    age_ = raw_input("How old are you? ")
    return age_
def Name():
    name_ = raw_input("What is your name? ")
return name_
def Sex():
    sex_ = input("Are you a man(1) or a woman(2)? ")
    if sex_ == 1:
        sex_ = "man"
        return sex_

    elif sex_ == 2:
        sex_ = "woman"
        return sex_
    else:
        print "Please enter 1 for man or 2 for woman "

age_ = Age()
name_ = Name()
sex_ = Sex()

print "Your name is " + name_ + " you are " + age_ + " years old and you are a " + sex_ + "." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:12:19.503

最终的工作代码，以防有人遇到同样的问题

```
#!/usr/bin/python

def Age():
    age_ = raw_input("How old are you? ")
    return age_
def Name():
    name_ = raw_input("What is your name? ")
    return name_
def Sex():
    sex_ = str(raw_input("Are you a man or a woman? "))
    if sex_ == "man":
            sex_ = "man"
            return sex_

    elif sex_ == "woman":
            sex_ = "woman"
            return sex_

    else:
            print "Please enter man or woman "

age_ = Age()
name_ = Name()
sex_ = Sex()

print "Your name is " + name_ + " you are " + age_ + " years old and you are a " + sex_ + "." 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:55:38.127

是，但`_name`的范围仅延伸到`Name()`函数的末尾。一旦`Name()`函数退出，`_name`变量就消失了。

尝试这样的事情：

```
def Name():
    name = raw_input("What is your name? ")
    return name

_name = Name()

print "Your name is " + _name 
```

你需要对年龄和性别做类似的事情。

# silverlight - 在 Silverlight/WinRT 中仅使用 XAML 将元素定位在画布内的中心（而不是左上角）

> ID：13219591
> 
> 赞同：5
> 
> 时间：2012-11-04T14:52:54.723
> 
> 标签：silverlight, xaml, canvas, windows-runtime, centering

关于在 a 中定位元素的常见问题`Canvas`是“如何定位元素的中心（而不是左上角）”。

*   [WPF：调整圆的大小，保持中心点而不是 TopLeft？](https://stackoverflow.com/questions/3423834/wpf-resizing-a-circle-keeping-the-center-point-instead-of-topleft)
*   [WPF X, Y 处的中心椭圆](https://stackoverflow.com/questions/5422897/wpf-center-ellipse-at-x-y)
*   [画布上的 WPF 元素定位](https://stackoverflow.com/questions/3682111/wpf-element-positioning-on-a-canvas)

提出了几种解决方案，但它们都有缺点。

**是否有一种简单的（仅限 XAML）方法来定位画布内的元素，以便其`Canvas.Left`和`Canvas.Top`对应于元素的中心，并且大小和位置属性都可以绑定到其他一些属性？**

我在 WPF 中找到了一种非常简单的方法（只需在 WPF`Margin="-1000000"` [中仅使用 XAML 设置将 Canvas 内的元素定位在其中心（而不是左上角）](https://stackoverflow.com/questions/13219321/wpf-positioning-an-element-by-its-center-instead-of-the-top-left-corner-insid/13219322#13219322)），但它不适用于 Silverlight/WinRT . 我知道的唯一其他方法需要创建`ValueConverter`来执行`x *= -0.5`计算（这不是仅 XAML）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:14:59.760

虽然它并不漂亮，但这里有一个使用`RenderTransform`不同来源的嵌套 s 来偏移对象的位置以使其居中的示例：

```
<UserControl x:Class="UrlTest.Center"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">

    <Canvas x:Name="LayoutRoot" Background="White">
        <ContentControl Canvas.Top="100" Content="{Binding ActualWidth,ElementName=Center, StringFormat=Width \{0\}}"/>
        <ContentControl Canvas.Top="120" Content="{Binding ActualHeight,ElementName=Center, StringFormat=Height \{0\}}"/>
        <Grid x:Name="Center" RenderTransformOrigin="-.5,-.5" Canvas.Left="40" Canvas.Top="25">
            <Grid.RenderTransform>
                <ScaleTransform ScaleX="-1" ScaleY="-1"/>
            </Grid.RenderTransform>
            <Grid RenderTransformOrigin="-.25,-.25">
                <Grid.RenderTransform>
                    <ScaleTransform ScaleX="-1" ScaleY="-1"/>
                </Grid.RenderTransform>
                <Ellipse Width="80" Height="50" Fill="Aquamarine"/>
                <ContentControl FontSize="20" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">Center</ContentControl>
            </Grid>
        </Grid>
    </Canvas>
</UserControl> 
```

内部`Grid`s 用于创建转换，而外部 s 用于`Canvas`确保其`Grid`内部将其大小设置为内部内容的大小。

# haskell - 功能替代品

> ID：13219592
> 
> 赞同：2
> 
> 时间：2012-11-04T14:52:55.147
> 
> 标签：haskell

我怎样才能做一个函数（递归），用参数 b(1) 代替列表上的参数 a(0)？例如：

```
 substitute 0 1 [1,0,3,0,4,0,0]
    [1,1,3,1,4,1,1] 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T15:01:40.870

不需要递归！

```
substitute :: Eq a => a -> a -> [a] -> [a]
substitute old new = map subs where
    subs x | x == old  = new
           | otherwise = x 
```

*如果这是*家庭作业，您可以轻松地替换（递归）的[定义。`map`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/GHC-Base.html#map)

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T15:30:32.430

最简单的是使用列表推导：

`subst a b xs = [c | x<-xs, let c=if x==a then b else x]`.

但这不是递归。使用递归，只是对列表结构（即结构递归）的案例分析：

```
subst a b [] = []
subst a b (x:xs) 
   | x==a      = b:subst a b xs
   | otherwise = x:subst a b xs 
```

这是`foldr`(or `map`) 模式的一个实例：

```
subst a b = foldr (\x xs-> (if x==a then b else x) : xs) [] 
subst a b = map   (\x   ->  if x==a then b else x      ) 
```

通常建议在递归定义中使用“worker”函数，如下所示：

```
subst a b xs = go xs
  where
    go [] = []
    go (x:xs) 
       | x==a      = b:go xs
       | otherwise = x:go xs 
```

但如果你凝视它片刻，你就会发现它是遵循`map`模式的。在 Haskell 中，递归模式由高阶函数捕获，例如`map`等`filter`。*

# jquery - replaceWith 和 textarea 选择

> ID：13219593
> 
> 赞同：0
> 
> 时间：2012-11-04T14:52:58.060
> 
> 标签：jquery, replacewith

是否可以分配`select()`给一个`replaceWith()`？

```
$('#foo').one('click', function() {
 $(this).replaceWith('<textarea id="copy">'+$(this).text()+'</textarea>');
});

$('#copy').click(function() {
 $(this).select();
}); 
```

我已经尝试过上面的代码，但它不起作用（我认为这是因为这`replaceWith()`是一个虚构的元素（如果你明白我的意思的话））。

但是，我通过将其`onclick="this.focus();this.select()"`放入`replaceWith()`

```
$('#foo').one('click', function() {
 $(this).replaceWith('<textarea id="copy" onclick="this.focus();this.select()">'+$(this).text()+'</textarea>');
}); 
```

但更喜欢它在`replaceWith()`代码之外，就像第一个代码试图做的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:33:56.300

在您的原始代码中，您将单击事件绑定到一个不存在的对象（在绑定时不存在）。

以下在将 textarea 插入 DOM*后绑定了 click 事件，并且应该可以工作。*

```
$('#foo').one('click', function() {
  $(this).replaceWith('<textarea id="copy">'+$(this).text()+'</textarea>');

  // at this point, the textarea exists and the binding will work.
  $('#copy').click(function() {
    $(this).select();
  });
}); 
```

另一种方法是使用 on() 对文档对象上的任何单击 #copy 进行绑定。

```
$('#foo').one('click', function() {
  $(this).replaceWith('<textarea id="copy">'+$(this).text()+'</textarea>');
});

// in this case, it will work even if #copy is non-existant at the time of binding
$(document).on('click', '#copy', function() {
  $(this).select();
}); 
```

# c# - SocketAsyncEventArgs 和每秒很少接受

> ID：13219598
> 
> 赞同：1
> 
> 时间：2012-11-04T14:53:31.323
> 
> 标签：c#, sockets, asynchronous, socketasynceventargs

我正在使用 SocketAsyncEventArgs，我每秒只能执行几次接受（我不知道为什么）。

如何最大化每秒接受的数量？我应该多次调用 Accept(null) 吗？

代码：在监听套接字上调用 Listen 后，我调用 Accept(null)，这是我的代码：

```
void Accept(SocketAsyncEventArgs acceptEventArg)
{
    if (acceptEventArg == null)
    {
        acceptEventArg = new SocketAsyncEventArgs();
        acceptEventArg.Completed += AcceptCompleted;
    }
    else
    {
        // socket must be cleared since the context object is being reused
        acceptEventArg.AcceptSocket = null;
    }

    bool willRaiseEvent = _listener.AcceptAsync(acceptEventArg);
    if (!willRaiseEvent)
    {
        Accepted(acceptEventArg);
    }
}

void AcceptCompleted(object sender, SocketAsyncEventArgs e)
{
    if (_onAccepted != null) _onAccepted(e);
}

void Accepted(SocketAsyncEventArgs e)
{
    if (!e.AcceptSocket.Connected) return;

    //1
    var acceptSocket = e.AcceptSocket;
    var readEventArgs = CreateArg(null, e.AcceptSocket, null);

    bool willRaiseEvent = true;
    if (acceptSocket.Connected)
        willRaiseEvent = acceptSocket.ReceiveAsync(readEventArgs);

    //2
    Accept(e);

    //3
    if (!willRaiseEvent)
    {
        Received(readEventArgs);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:10:31.200

默认情况下有连接限制。您可以使用 DefaultConnectionLimit [http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx更改它](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx)

# php - Kohana 没有加载结果行？

> ID：13219599
> 
> 赞同：2
> 
> 时间：2012-11-04T14:53:48.207
> 
> 标签：php, sql, orm, kohana

如果我尝试使用 Kohana ORM 加载结果，则查询是正确的，但结果为空。如果我复制查询并在 phpmyadmin 中使用它，我会收到 2 行。

这是 Kohana 代码 (ORM)

```
 // DB work
        $ftps = ORM::factory('ftp');

        // if we activate many (we load only ready)
        if ($this->request->param('mode') == 'activate') {
            $ftps->where('ready', '=', '1');

        // if we activate many (we load only ready)
        } elseif ($this->request->param('mode') == 'not_ready') {
            $ftps->where('ready', '=', '0');
        }

        // DB work
        $ftps->and_where('activated', '=', '0')
             ->order_by('lastcheck', 'ASC')
             ->limit(intval($post['number']))
             ->find_all(); 
```

这是 SQL 查询（调试）

```
SELECT `ftp`.* FROM `ftps` AS `ftp` WHERE `activated` = '0' ORDER BY `lastcheck` ASC LIMIT 100 (1) 
```

为什么 Kohana 不能像 phpmyadmin 那样加载相同的结果？这是同一个查询。我没有找到解决方案。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T11:24:22.197

这是我在使用 Kohana 时经常遇到的问题。您的问题有一个简单但不那么直观的解释。如果你只是在做...

```
$ftps->find_all(); 
```

然后尝试`$ftp`用作您的结果集，这将不起作用，因为该`find_all()`函数仅*返回*结果集，并且`$ftps`正在重置查询对象。相反，你需要做...

```
$ftps = $ftps->find_all(); 
```

然后*将* `$ftps`包含结果集。

希望有帮助！

# visual-studio-2010 - Visual Studio 针对发布模式下的不同行为进行了优化

> ID：13219603
> 
> 赞同：0
> 
> 时间：2012-11-04T14:53:59.190
> 
> 标签：visual-studio-2010, visual-c++, release-mode

我有一个用 Visual Studio 2010 开发的 C++ 应用程序。我有一个静态方法，调用它来解码通过串行硬件接收到的消息。

当我使用“发布”配置时，编译器以某种奇怪的方式优化了该方法，并且该方法无法按预期工作。当我使用“调试”配置时，一切都很好。

这是方法：

```
std::vector<BYTE> CMsg::DecodeMsg(std::vector<BYTE> & msg)
{
    std::vector<BYTE> asciiDecoded;
    for (size_t i = 0; i < msg.size() - 1; i++)
    {
        auto val2 = BaseUtils::hex2Ascii(msg.at(i++), msg.at(i));
        asciiDecoded.push_back(val2);
    }

    return asciiDecoded;
} 
```

我认为发布配置中的一些优化（我使用 /O2）导致 i 变量出现问题。

# javascript - 使用 jquery 验证表单的问题

> ID：13219608
> 
> 赞同：0
> 
> 时间：2012-11-04T14:54:43.800
> 
> 标签：javascript, jquery

我正在使用 jquery 的 each 循环遍历表单中的所有输入文本字段。共有 4 个输入字段。但我收到以下错误

```
Cannot call method 'toLowerCase' of undefined in jquery.js:2153 
```

这是我的代码

```
loadViews: function (view, flag) {
            if( flag ) {
                if ( View.validate() ) {
                    $('.search').animate({left: '-350px'}, 100, 'easeInOutQuad', function () {
                        container.empty().load(view + '.html');
                    });
                } else {

                }
            } else {
                container.empty().load(view + '.html');
            }
        },
        validate: function () {
            $.each('#form input[type="text"]', function (i) {
                console.log($(this).val());
            });
            return false;
        } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:51:49.277

您正在传入一个`selector`when[`$.each`](http://api.jquery.com/jQuery.each/)需要一个集合。从 API 文档：

> $.each() 函数与 $(selector).each() 不同，后者用于以独占方式遍历 jQuery 对象。$.each() 函数可用于迭代任何集合，无论是映射（JavaScript 对象）还是数组。

要修复它，请执行以下操作：

```
$('#form input[type="text"]').each(function (i, elem) {
    console.log($(this).val());
}); 
```

或这个：

```
var inputs = $('#form input[type="text"]');
$.each(inputs, function (i, elem) {
    console.log($(this).val());
}); 
```

# java - Guice “Throwing Providers”：如何使用泛型绑定到类型？

> ID：13219610
> 
> 赞同：1
> 
> 时间：2012-11-04T14:54:57.453
> 
> 标签：java, guice, guice-3

使用 Guice 3.0，我尝试注入一个可以抛出特定检查异常的 Provider。所以我使用[Throwing Providers 扩展](http://code.google.com/p/google-guice/wiki/ThrowingProviders)。

我为 Provider 创建了一个接口：

```
public interface IMyProvider<T> extends CheckedProvider<T> 
{
    @Override
    T get() throws MyException;
} 
```

及其实施：

```
public class MyProvider implements IMyProvider<List<SomeType>> 
{
    @Override
    public List<SomeType> get() throws MyException                        
    {
        //...
    }
} 
```

我在要注入 Provider 的对象上使用 @Inject 注释：

```
@Inject
public SomeConstructor(IMyProvider<List<SomeType>> myProvider)
{
    //...
} 
```

现在，我的问题是：*如何绑定这个 Provider*？

由于使用了泛型，我想使用`TypeLiteral`：

```
bind(MyProvider.class);
ThrowingProviderBinder.create(binder())
                      .bind(IMyProvider.class, new TypeLiteral<List<SomeType>>(){})
                      .to(MyProvider.class); 
```

但这似乎`TypeLiteral`不是此 bind() 方法的有效参数。

我错过了什么吗？

**更新 ：**

我找到了解决方法。通过创建一个扩展类`ArrayList<SomeType>`，我可以绑定提供者：

```
public class SomeTypeList extends ArrayList<SomeType> 
```

和

```
bind(MyProvider.class);
ThrowingProviderBinder.create(binder())
                      .bind(IMyProvider.class, SomeTypeList.class)
                      .to(MyProvider.class); 
```

但是，如果`SomeTypeList`不需要该课程，那就更容易了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:47:02.857

您正在寻找一个本身没有实现的`Type`实例。`TypeLiteral`

我没有直接使用这个，但 Guice 确实提供了一个[`Types`](http://google-guice.googlecode.com/git/javadoc/com/google/inject/util/Types.html#newParameterizedType%28java.lang.reflect.Type,%20java.lang.reflect.Type...%29)类，并且还有一个方法[`TypeLiteral.getType`](http://google-guice.googlecode.com/git/javadoc/com/google/inject/TypeLiteral.html#getType%28%29)。尝试以下方法之一：

*   `Types.listOf(SomeType.class)`
*   `Types.newParameterizedType(List.class, SomeType.class)`
*   `(new TypeLiteral<List<SomeType>>() {}).getType()`

我的偏好是第一个，它看起来像这样：

```
ThrowingProviderBinder
    .create(binder())
    .bind(IMyProvider.class, Types.listOf(SomeType.class))
    .to(MyProvider.class); 
```

# php - 比较两个字符串并以百分比表示它们之间的差异（php）

> ID：13219622
> 
> 赞同：4
> 
> 时间：2012-11-04T14:56:04.210
> 
> 标签：php, string, compare

请帮助比较两个字符串并以百分比表示它们之间的差异

我有两个字符串，例如：

```
first string:
253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,253.0.0.0,247.0.0.24,197.0.0.35,189.0.0.98....
second string:
255.255.255.127,255.255.255.127,255.255.255.127,255.255.255.127,255.255.255.127,255.255.255.127,255.255.255.127,255.255.255.127,255.255.255.127....

$first_array = explode(",", $out_string);
$second_array = explode(",", $out_string_1);
$result_array = array_merge(array_diff($first_array, $second_array), array_diff($second_array, $first_array));

$result = implode(",",$result_array);
echo $result; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T15:04:45.383

为此目的，有两个有趣的本机函数，[similar_text()](http://www.php.net/manual/pt_BR/function.similar-text.php)和[levenshtein()](http://br1.php.net/levenshtein)

similar_text() 示例：

```
$string1 = 'AAAb';
$string2 = 'aaab';

similar_text ( $string1, $string2, $percentege );

echo $percentege . '%'; // Output: 25% 
```

levenshtein() 示例：

```
levenshtein($string1, $string2, 1, 1000, 1000000); 
```

**编辑 1**

考虑到第一个字符串总是与第二个字符串具有相同数量的条目，您可以尝试以下代码。我为测试目的创建了两个字符串，第二个字符串有两个相等的条目和 7 个不同的条目，总共 9 个。

```
$first_string = '253.0.0.1,253.0.0.2,253.0.0.3,253.0.0.4,253.0.0.5,253.0.0.6,253.0.0.7,253.0.0.8,253.0.0.9';

$second_string = '253.0.0.1,253.0.0.2,255.255.255.127,255.255.255.128,255.255.255.129,255.255.255.130,255.255.255.131,255.255.255.132,255.255.255.133';

$first_array = explode(',', $first_string);

$second_array = explode(',', $second_string);

$total_entries = count($first_array);

$array_differences = array_diff($first_array, $second_array);

$different_entries = count($array_differences);

$percentage = ( $different_entries / $total_entries ) * 100 ;

echo 'Difference: ' . round($percentage, 2) . '%'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:00:05.167

怎么这么简单...

```
$difference = count($result_array) / count($first_array) * 100; 
```

例如：

```
$arr1 = array(1, 2, 3, 4);
$arr2 = array(5, 2, 4, 8);
$res  = array_diff($arr1, $arr2); 
printf("%.02f%%", count($res) / count($arr1) * 100);    # 50.00% 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T16:07:36.603

相似度函数很大程度上取决于将要实现的上下文。如果没有解释你想对比较结果做什么（即你的上下文），几乎不可能给你一个开箱即用的相似性函数。尽管我能想到的所有相似函数都可能有效，但它们都不适合您的问题。

# java - 在java中动态更新SystemTray

> ID：13219624
> 
> 赞同：3
> 
> 时间：2012-11-04T14:56:19.057
> 
> 标签：java, swing, system-tray, jpopupmenu

`PopUpMenu`是否可以在`SystemTray`java中添加一个项目？我试图将该项目添加到菜单中，但这不起作用。也不会添加它并调用`TrayIcon.setPopMenu(PopUpMenu)`and 之后的`SystemTray.add(TrayIcon)`方法。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T16:25:27.477

当然可以。

看我做的这个例子：

![在此处输入图像描述](../Images/068b667e058e0d1e46cbdfb5cae254e2.png)

```
import java.awt.AWTException;
import java.awt.CheckboxMenuItem;
import java.awt.Image;
import java.awt.Menu;
import java.awt.MenuItem;
import java.awt.PopupMenu;
import java.awt.SystemTray;
import java.awt.TrayIcon;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;

public class Test {

    public Test() throws Exception {
        initComponents();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    new Test();
                } catch (Exception ex) {
                    ex.printStackTrace();
                }
            }
        });
    }

    private void initComponents() throws Exception {

        createAndShowTray();

    }

    private void createAndShowTray() throws Exception {

        //Check the SystemTray is supported
        if (!SystemTray.isSupported()) {
            System.out.println("SystemTray is not supported");
            return;
        }

        PopupMenu popup = new PopupMenu();
        //retieve icon form url and scale it to 32 x 32
        final TrayIcon trayIcon = new TrayIcon(ImageIO.read(
                new URL("http://www.optical-illusions.in/illusions/blue_rotation_optical_illusion.jpg"))
                .getScaledInstance(32, 32, Image.SCALE_SMOOTH), null);

        //get the system tray
        final SystemTray tray = SystemTray.getSystemTray();

        // Create a pop-up menu components
        MenuItem aboutItem = new MenuItem("About");
        aboutItem.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                JOptionPane.showMessageDialog(null, "About");
            }
        });

        final  CheckboxMenuItem cb1 = new CheckboxMenuItem("Set tooltip");
        cb1.addItemListener(new ItemListener() {

            @Override
            public void itemStateChanged(ItemEvent ie) {
                if(cb1.getState()==true) {
                trayIcon.setToolTip("Hello, world");
                }else {
                trayIcon.setToolTip("");
                }
            }
        });

        Menu displayMenu = new Menu("Display");
        MenuItem infoItem = new MenuItem("Info");

        MenuItem exitItem = new MenuItem("Exit");
        //add actionlistner to exit menu item
        exitItem.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                System.exit(0);
            }
        });

        //Add components to pop-up menu
        popup.add(aboutItem);
        popup.addSeparator();
        popup.add(cb1);
        popup.addSeparator();
        popup.add(displayMenu);
        displayMenu.add(infoItem);
        popup.add(exitItem);

        trayIcon.setPopupMenu(popup);

        try {
            tray.add(trayIcon);
        } catch (AWTException e) {
            System.out.println("TrayIcon could not be added.");
        }
    }
} 
```

**参考：**

*   [如何使用系统托盘](http://docs.oracle.com/javase/tutorial/uiswing/misc/systemtray.html)

# javascript - 使用 javascript 进行 URL 操作

> ID：13219627
> 
> 赞同：-2
> 
> 时间：2012-11-04T14:56:22.290
> 
> 标签：javascript, url

我是 javascript 新手，有点菜鸟......我的第一个代码将是一个 url 操纵器......

我想做以下事情：我想要一个像

```
http://www.example.com/index.php?show=vods&play=1234 
```

进行操作，因此每次我浏览 X 介于 0 到 9 之间`"&res=480p"`的站点时都会添加 a ...`"?show=vods&play=XXXX"`

```
Example: 
http://www.example.com/index.php?show=vods&play=1234 [original url]
-->
http://www.example.com/index.php?show=vods&play=1234&res=480p [manipulated url] 
```

我知道，我处于初学者水平，所以请有人给我一个提示，解决我的问题或者可以给我一些阅读，以便我自己解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:59:26.573

您可以使用 window.location.href 在 javascript 中更改 url

像这样：window.location.href = window.location.href + '&res=480p'

# batch-file - 批处理：替换文本文件中的一行

> ID：13219628
> 
> 赞同：4
> 
> 时间：2012-11-04T14:56:35.560
> 
> 标签：batch-file, replace, line, text-files

我正在尝试替换这一行：

```
#        forward-socks5   /               127.0.0.1:9050 . 
```

有了这个：

```
 forward-socks5   /               127.0.0.1:9050 . 
```

此行属于必须通过从开头删除 # 符号来启用（未注释）的配置文件，除了用没有 # 符号的另一行替换该行之外，我想不出更好的方法。
任何其他想法或方法都会非常有用。

顺便说一句，文本前的空格也在那里。
我已将文本粘贴在原始文件中。

提前致谢

* * *

编辑：
我以某种方式设法使用我发现的两种代码来添加和删除行。我唯一的问题是以下代码删除了输出文件中的每一位感叹号！

```
@echo off

:Variables
SETLOCAL ENABLEDELAYEDEXPANSION
set InputFile=config.txt
set OutputFile=config-new.txt
set _strFind=#        forward-socks5   /               127.0.0.1:9050 .
set _strInsert=        forward-socks5   /               127.0.0.1:9050 .
set i=0

:Replace
for /f "usebackq tokens=1 delims=[]" %%A in (`find /n "%_strFind%" "%InputFile%"`) do (set _strNum=%%A)
for /f "usebackq delims=" %%A in ("%InputFile%") do (
  set /a i = !i! + 1
  echo %%A>>"%OutputFile%"
  if [!i!] == [%_strNum%] (echo %_strInsert%>>"%OutputFile%")
)
type %OutputFile% | findstr /i /v /c:"%_strFind%">config-new2.txt 
```

我想知道是否有任何方法可以一步完成查找/删除/添加行（而不是像我的两个步骤）...

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-04T17:26:26.593

包含的行`!`已损坏，因为在 FOR 变量 ( `%%A`) 扩展之后发生延迟扩展。这可以通过禁用延迟扩展来解决。在循环中，您将 的值保存`%%A`在变量中，然后打开延迟扩展，处理该行，然后将其关闭。

您不需要在 SET /A 计算中扩展变量。

您可以通过在循环中添加 IF 语句一步完成所有操作。

事实上，您甚至根本不需要 SET /A 或 FINDSTR。您的 IF 语句可以测试该行是否与您的搜索字符串匹配。你真的不需要延迟扩展来解决你的问题。

将整个循环包含在括号内并重定向到您的输出文件一次会更有效。

```
@echo off
setlocal disableDelayedExpansion

:Variables
set InputFile=config.txt
set OutputFile=config-new.txt
set "_strFind=#        forward-socks5   /               127.0.0.1:9050 ."
set "_strInsert=        forward-socks5   /               127.0.0.1:9050 ."

:Replace
>"%OutputFile%" (
  for /f "usebackq delims=" %%A in ("%InputFile%") do (
    if "%%A" equ "%_strFind%" (echo %_strInsert%) else (echo %%A)
  )
) 
```

# django - Django Feed.item_link：URL 取决于 item 和 get_object 参数

> ID：13219630
> 
> 赞同：0
> 
> 时间：2012-11-04T14:56:49.123
> 
> 标签：django

我有一个带有条目和容器的应用程序。它们之间存在ManyToMany关系：

*   一个容器包含 0 个或多个条目
*   一个条目在 0 个或多个容器中

我对 URI 使用以下架构：

*   前缀/容器
*   前缀/容器/条目

这意味着多个 URL 可以指向同一个条目。每个 URL 定义不同的上下文。

我正在尝试为每个容器创建一个 RSS/Atom Feed。我的问题是如何实现`Feed.item_link`返回正确 URL 的方法。我需要`urlresolvers.reverse`使用两个参数进行调用：容器标识符和条目标识符。不幸的是 item_link 只接收条目作为参数。只有`Feed.get_object`方法知道容器。解决此问题的最干净的解决方案是什么？

示例代码如下：

### 楷模

```
 class Entry(models.Model):
        pass

    class Container(models.Model):
        entries = models.ManyToManyField("Entries",
                related_name='containers',
                null=True,
                blank=True
        ) 
```

### 网址

```
 url(r'^prefix/(?P<container_slug>[-\w]+)/rss$', feeds.LatestEntries()), 
```

### 喂养

```
 class LatestEntries(Feed):
        title = "foo"
        description = "bar"

        def get_object(self, request, container_slug):
            return get_object_or_404(models.Container, slug=container_slug)

        def item_link(self, entry):
            # TODO: How to pass container_slug to reverse() ?
            return urlresolvers.reverse('up.views.portfolio_image', kwargs={
                    'container_slug': 'FIXME',
                    'entry_slug': entry.slug,
                }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T02:02:07.453

使用联合时，由于使用单个实例`Feed`来处理所有请求，因此情况变得复杂，因此您不能可靠地将值存储为`Feed`实例的属性，相反，您必须以某种方式使用您创建的对象来传递向前的价值。在这种情况下，我只能想到一种前进的方式，而不是`Feed`自己重新实现整个班级。

您需要将参数附加到由 返回的对象`get_object`，例如像这样（尽管在这种情况下此步骤似乎是多余的，因为您的`Container`实例已经将其作为常规模型字段包含）：

```
def get_object(self, request, container_slug):
    object = get_object_or_404(models.Container, slug=container_slug)
    object.container_slug = container_slug
    return object 
```

然后，在 中`items`，您必须从容器实例中获取此值并将其附加到返回的每个项目，例如：

```
def items(self, container):
    result = list(Entry.objects.filter(field__exact=container.something)[:10])
    for entry in result:
        entry.container_slug = container.container_slug
    return result 
```

如果您愿意，可以通过使用闭包和条目列表的生成器来避免在此步骤中枚举查询集，尽管在这种情况下，如果您只返回少数条目，则无关紧要。

然后，最后，您可以`item_link`像这样实现：

```
def item_link(self, entry):
    return urlresolvers.reverse('up.views.portfolio_image', kwargs={
            'container_slug': entry.container_slug,
            'entry_slug': entry.slug,
        }) 
```

# android - Android 应用程序在 Android 2 中工作，但在 Android 4 中抛出异常

> ID：13219633
> 
> 赞同：0
> 
> 时间：2012-11-04T14:57:01.533
> 
> 标签：android

我有一个在 Android 2 中运行良好的 android 应用程序，但是当我尝试在 Android 4 上运行它时，它崩溃并抛出异常。贝娄是我得到的日志

```
11-04 16:50:01.015: E/AndroidRuntime(753): FATAL EXCEPTION: main 11-04
 16:50:01.015: E/AndroidRuntime(753): java.lang.RuntimeException:
 Unable to start activity
 ComponentInfo{com.example.huda.elklob/com.example.huda.elklob.options}:
 android.view.InflateException: Binary XML file line #22: Error
 inflating class android.widget.Button 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.app.ActivityThread.access$600(ActivityThread.java:123) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.os.Handler.dispatchMessage(Handler.java:99) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.os.Looper.loop(Looper.java:137) 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 android.app.ActivityThread.main(ActivityThread.java:4424) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 java.lang.reflect.Method.invokeNative(Native Method) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 java.lang.reflect.Method.invoke(Method.java:511) 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 dalvik.system.NativeStart.main(Native Method) 11-04 16:50:01.015:
 E/AndroidRuntime(753): Caused by: android.view.InflateException:
 Binary XML file line #22: Error inflating class android.widget.Button
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.view.LayoutInflater.createView(LayoutInflater.java:606) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.view.LayoutInflater.onCreateView(LayoutInflater.java:653)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:678)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.view.LayoutInflater.rInflate(LayoutInflater.java:739) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.view.LayoutInflater.rInflate(LayoutInflater.java:742) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.view.LayoutInflater.inflate(LayoutInflater.java:489) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.view.LayoutInflater.inflate(LayoutInflater.java:396) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.view.LayoutInflater.inflate(LayoutInflater.java:352) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:251)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.app.Activity.setContentView(Activity.java:1835) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 com.example.huda.elklob.options.onCreate(options.java:17) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.app.Activity.performCreate(Activity.java:4465) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
 11-04 16:50:01.015: E/AndroidRuntime(753):     ... 11 more 11-04
 16:50:01.015: E/AndroidRuntime(753): Caused by:
 java.lang.reflect.InvocationTargetException 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 java.lang.reflect.Constructor.constructNative(Native Method) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 java.lang.reflect.Constructor.newInstance(Constructor.java:417) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.view.LayoutInflater.createView(LayoutInflater.java:586) 11-04
 16:50:01.015: E/AndroidRuntime(753):   ... 25 more 11-04 16:50:01.015:
 E/AndroidRuntime(753): Caused by: java.lang.OutOfMemoryError 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.graphics.BitmapFactory.nativeDecodeAsset(Native Method) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:483)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:351)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:773)
 11-04 16:50:01.015: E/AndroidRuntime(753):     at
 android.content.res.Resources.loadDrawable(Resources.java:1935) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.content.res.TypedArray.getDrawable(TypedArray.java:601) 11-04
 16:50:01.015: E/AndroidRuntime(753):   at
 android.view.View.<init>(View.java:2785) 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 android.widget.TextView.<init>(TextView.java:449) 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 android.widget.Button.<init>(Button.java:108) 11-04 16:50:01.015:
 E/AndroidRuntime(753):     at
 android.widget.Button.<init>(Button.java:104) 11-04 16:50:01.015:
 E/AndroidRuntime(753):     ... 28 more 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:08:10.053

叶赫。下次，请将您的 LogCat 转储格式化为“代码”而不是“引用”。至少换行符将在其应有的位置。

也就是说，相关位在这里：

```
Caused by: java.lang.OutOfMemoryError
11-04 16:50:01.015: E/AndroidRuntime(753): at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
11-04 16:50:01.015: E/AndroidRuntime(753): at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:483) 
```

解码位图时出现内存不足错误。使其成为较小的位图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:11:37.730

如您的日志所示，错误（异常）的根源是`OutOfMemoryError`. 位图太大而无法放入内存（即在 Dalvik 托管堆上没有足够的空间供它使用）。此外，加载位图可能需要比存储更多的内存（见下文）。

很可能在您的 Android 4 设备的显示中，您的图像需要比您的 Android 2 设备更多的像素，并且 Android 正在扩大内存中的图像，导致在加载位图时甚至更高的内存消耗.

因此，要么你需要为这种显示类型（即你的 Android 4 设备使用的显示器）缩小你的位图，或者你可以尝试手动加载和设置位图（参见这个关于加载大位图的[官方页面）。](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

# arrays - 检查数组中的索引或键的最简单方法？

> ID：13219634
> 
> 赞同：110
> 
> 时间：2012-11-04T14:57:04.413
> 
> 标签：arrays, bash, indexing, key

使用：

```
set -o nounset 
```

1.  有一个索引数组，如：

    ```
    myArray=( "red" "black" "blue" ) 
    ```

    检查是否设置了元素 1 的最短方法是什么？
    我有时会使用以下内容：

    ```
    test "${#myArray[@]}" -gt "1" && echo "1 exists" || echo "1 doesn't exist" 
    ```

    我想知道是否有首选。

2.  如何处理不连续的索引？

    ```
    myArray=()
    myArray[12]="red"
    myArray[51]="black"
    myArray[129]="blue" 
    ```

    例如，如何快速检查`51`已经设置的？

3.  如何处理关联数组？

    ```
    declare -A myArray
    myArray["key1"]="red"
    myArray["key2"]="black"
    myArray["key3"]="blue" 
    ```

    例如，如何快速检查`key2`已经使用的？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-11-04T18:25:07.793

To check if the element is set (applies to both indexed and associative array)

```
[ "${array[key]+abc}" ] && echo "exists" 
```

Basically what `${array[key]+abc}` does is

*   if `array[key]` is set, return `abc`
*   if `array[key]` is not set, return nothing

* * *

References:

1.  See [Parameter Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion) in Bash manual and the little note

> if the colon is omitted, the operator tests only for existence [of *parameter*]

2.  This answer is actually adapted from the answers for this SO question: [How to tell if a string is not defined in a bash shell script](https://stackoverflow.com/questions/228544/how-to-tell-if-a-string-is-not-defined-in-a-bash-shell-script)?

* * *

A wrapper function:

```
exists(){
  if [ "$2" != in ]; then
    echo "Incorrect usage."
    echo "Correct usage: exists {key} in {array}"
    return
  fi   
  eval '[ ${'$3'[$1]+muahaha} ]'  
} 
```

For example

```
if ! exists key in array; then echo "No such array element"; fi 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2017-07-29T05:00:27.120

从[man bash](https://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html#Bash-Conditional-Expressions)，条件表达式：

```
-v varname
              True if the shell variable varname is set (has been assigned a value). 
```

例子：

```
declare -A foo
foo[bar]="this is bar"
foo[baz]=""
if [[ -v "foo[bar]" ]] ; then
  echo "foo[bar] is set"
fi
if [[ -v "foo[baz]" ]] ; then
  echo "foo[baz] is set"
fi
if [[ -v "foo[quux]" ]] ; then
  echo "foo[quux] is set"
fi 
```

这将表明 foo[bar] 和 foo[baz] 都已设置（即使后者设置为空值）而 foo[quux] 未设置。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-11-04T15:15:32.250

## 新答案

从[bash](/questions/tagged/bash "显示标记为“bash”的问题")**`-v`**的 4.2 版（和更高版本）开始，内置 ***`test`***命令有一个新选项。

从 4.3 版开始，此测试可以处理数组元素。

```
array=([12]="red" [51]="black" [129]="blue")

for i in 10 12 30 {50..52} {128..131};do
    if [ -v 'array[i]' ];then
        echo "Variable 'array[$i]' is defined"
    else
        echo "Variable 'array[$i]' not exist"
    fi
done 
```

```
Variable 'array[10]' not exist
Variable 'array[12]' is defined
Variable 'array[30]' not exist
Variable 'array[50]' not exist
Variable 'array[51]' is defined
Variable 'array[52]' not exist
Variable 'array[128]' not exist
Variable 'array[129]' is defined
Variable 'array[130]' not exist
Variable 'array[131]' not exist 
```

注意：关于[ssc 的注释](https://stackoverflow.com/posts/comments/121983662?noredirect=1)，我在test 中**单**引号，以满足 shellcheck 的*错误*[SC2208](https://github.com/koalaman/shellcheck/wiki/SC2208)。这似乎在这里并不是真正需要的，因为无论如何都没有 glob 字符......`'array[i]'``-v` *`array[i]`*

 *这以相同的方式与*关联数组*一起工作：

```
declare -A aArray=([foo]="bar" [bar]="baz" [baz]=$'Hello world\041')

for i in alpha bar baz dummy foo test;do
    if [ -v 'aArray[$i]' ];then
        echo "Variable 'aArray[$i]' is defined"
    else
        echo "Variable 'aArray[$i]' not exist"
    fi
done 
```

```
Variable 'aArray[alpha]' not exist
Variable 'aArray[bar]' is defined
Variable 'aArray[baz]' is defined
Variable 'aArray[dummy]' not exist
Variable 'aArray[foo]' is defined
Variable 'aArray[test]' not exist 
```

**有一点不同：**
在常规数组中，括号（`[i]`）之间的变量是整数，所以`$`不需要美元符号（），但是对于关联数组，因为*key*是一个单词，`$`所以需要（`[$i]`）！

## V4.2 之前[bash](/questions/tagged/bash "显示标记为“bash”的问题")的旧答案

不幸的是，bash 无法区分*空*变量和*未定义*变量。

但是有一些方法：

```
$ array=()
$ array[12]="red"
$ array[51]="black"
$ array[129]="blue"

$ echo ${array[@]}
red black blue

$ echo ${!array[@]}
12 51 129

$ echo "${#array[@]}"
3

$ printf "%s\n" ${!array[@]}|grep -q ^51$ && echo 51 exist
51 exist

$ printf "%s\n" ${!array[@]}|grep -q ^52$ && echo 52 exist 
```

（不回答）

对于关联数组，您可以使用相同的：

```
$ unset array
$ declare -A array
$ array["key1"]="red"
$ array["key2"]="black"
$ array["key3"]="blue"
$ echo ${array[@]}
blue black red

$ echo ${!array[@]}
key3 key2 key1

$ echo ${#array[@]}
3

$ set | grep ^array=
array=([key3]="blue" [key2]="black" [key1]="red" )

$ printf "%s\n" ${!array[@]}|grep -q ^key2$ && echo key2 exist || echo key2 not exist
key2 exist

$ printf "%s\n" ${!array[@]}|grep -q ^key5$ && echo key5 exist || echo key5 not exist
key5 not exist 
```

您可以在不需要外部工具的情况下完成这项工作（没有 printf|grep 作为*纯 bash*），为什么不将**checkIfExist()**构建为新的 bash 函数：

```
$ checkIfExist() {
    eval 'local keys=${!'$1'[@]}';
    eval "case '$2' in
        ${keys// /|}) return 0 ;;
        * ) return 1 ;;
      esac";
}

$ checkIfExist array key2 && echo exist || echo don\'t
exist

$ checkIfExist array key5 && echo exist || echo don\'t
don't 
```

甚至创建一个新的**getIfExist** bash 函数，该函数返回所需的值并在所需的值不存在时以错误的结果代码退出：

```
$ getIfExist() {
    eval 'local keys=${!'$1'[@]}';
    eval "case '$2' in
        ${keys// /|}) echo \${$1[$2]};return 0 ;;
        * ) return 1 ;;
      esac";
}

$ getIfExist array key1
red
$ echo $?
0

$ # now with an empty defined value
$ array["key4"]=""
$ getIfExist array key4

$ echo $?
0
$ getIfExist array key5
$ echo $?
1 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-07-01T19:25:47.007

`-n`测试和操作员呢`:-`？

例如，这个脚本：

```
#!/usr/bin/env bash

set -e
set -u

declare -A sample

sample["ABC"]=2
sample["DEF"]=3

if [[ -n "${sample['ABC']:-}" ]]; then
  echo "ABC is set"
fi

if [[ -n "${sample['DEF']:-}" ]]; then
  echo "DEF is set"
fi

if [[ -n "${sample['GHI']:-}" ]]; then
  echo "GHI is set"
fi 
```

印刷：

```
ABC is set
DEF is set 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-11-13T03:28:48.937

在 bash 4.3.39(1)-release 中测试

```
declare -A fmap
fmap['foo']="boo"

key='foo'
# should echo foo is set to 'boo'
if [[ -z "${fmap[${key}]}" ]]; then echo "$key is unset in fmap"; else echo "${key} is set to '${fmap[${key}]}'"; fi
key='blah'
# should echo blah is unset in fmap
if [[ -z "${fmap[${key}]}" ]]; then echo "$key is unset in fmap"; else echo "${key} is set to '${fmap[${key}]}'"; fi 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-02-23T12:37:02.240

从Thamme重申这一点：

```
[[ ${array[key]+Y} ]] && echo Y || echo N 
```

这将测试变量/数组元素是否存在，包括它是否设置为空值。这适用于比 -v 更广泛的 bash 版本，并且似乎对 set -u 之类的东西不敏感。如果您使用此方法看到“错误的数组下标”，请发布示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-22T10:45:34.070

我写了一个函数来检查一个键是否存在于 Bash 的数组中：

```
# Check if array key exists
# Usage: array_key_exists $array_name $key
# Returns: 0 = key exists, 1 = key does NOT exist
function array_key_exists() {
    local _array_name="$1"
    local _key="$2"
    local _cmd='echo ${!'$_array_name'[@]}'
    local _array_keys=($(eval $_cmd))
    local _key_exists=$(echo " ${_array_keys[@]} " | grep " $_key " &>/dev/null; echo $?)
    [[ "$_key_exists" = "0" ]] && return 0 || return 1
} 
```

**例子**

```
declare -A my_array
my_array['foo']="bar"

if [[ "$(array_key_exists 'my_array' 'foo'; echo $?)" = "0" ]]; then
    echo "OK"
else
    echo "ERROR"
fi 
```

使用 GNU bash 测试，版本 4.1.5(1)-release (i486-pc-linux-gnu)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-08-08T14:11:39.317

## 对于所有时间的人，一劳永逸。

有一个“干净的代码”很长的路要走，还有一个更短、更简洁、以 bash 为中心的方式。

`$1`= 您要查找的索引或键。

`$2`*=通过引用*传入的数组/映射。

```
function hasKey ()
{
    local -r needle="${1:?}"
    local -nr haystack=${2:?}

    for key in "${!haystack[@]}"; do
        if [[ $key == $needle ]] ;
            return 0
        fi
    done

    return 1
} 
```

线性搜索可以用二分搜索代替，二分搜索在更大的数据集上表现更好。只需先对键进行计数和排序，然后随着您越来越接近答案，将干草堆进行经典的二进制减半。

现在，对于纯粹主义者来说，就像“不，我想要性能更高的版本，因为我可能不得不在 bash 中处理大型数组”，让我们看看一个更以 bash 为中心的解决方案，但它可以保持干净的代码和灵活性处理数组或映射。

```
function hasKey ()
{
    local -r needle="${1:?}"
    local -nr haystack=${2:?}

    [ -n ${haystack["$needle"]+found} ]
} 
```

该行`[ -n ${haystack["$needle"]+found} ]`使用`${parameter+word}`bash 变量扩展的形式，而不是`${parameter:+word}`形式，它也试图测试一个键的值，*这不是手头的事情*。

## 用法

```
local -A person=(firstname Anthony lastname Rutledge)

if hasMapKey "firstname" person; then
     # Do something
fi 
```

> 当不执行子字符串扩展时，使用下面描述的形式（例如，':-'），Bash 测试未设置或为空的参数。省略冒号会导致仅对未设置的参数进行测试。换句话说，如果包含冒号，则运算符会测试两个参数的存在以及它的值是否不为空；如果省略冒号，则运算符仅测试是否存在。
> 
> ${参数：-字}
> 
> ```
> If parameter is unset or null, the expansion of word is substituted. Otherwise, the value of parameter is substituted. 
> ```
> 
> ${参数：=字}
> 
> ```
> If parameter is unset or null, the expansion of word is assigned to parameter. The value of parameter is then substituted. Positional 
> ```
> 
> 不能以这种方式分配参数和特殊参数。${参数:?word}
> 
> ```
> If parameter is null or unset, the expansion of word (or a message to that effect if word is not present) is written to the standard 
> ```
> 
> 错误和外壳，如果它不是交互式的，则退出。否则，参数的值被替换。${参数：+字}
> 
> ```
> If parameter is null or unset, nothing is substituted, otherwise the expansion of word is substituted. 
> ```

[https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Shell-Parameter-Expansion](https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Shell-Parameter-Expansion)

如果`$needle`不存在则展开为空，否则展开为长度非零的字符串“found”。如果事实确实存在（正如我所说的“找到”），这将使`-n`测试成功，否则失败。`$needle`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-15T14:58:36.537

这是我为脚本找到的最简单的方法。

**`<search>`**是您要查找的字符串，**`ASSOC_ARRAY`**是保存关联数组的变量的名称。

取决于您想要实现的目标：

*密钥存在*：

```
if grep -qe "<search>" <(echo "${!ASSOC_ARRAY[@]}"); then echo key is present; fi 
```

*键不存在*：

```
if ! grep -qe "<search>" <(echo "${!ASSOC_ARRAY[@]}"); then echo key not present; fi 
```

*值存在*：

```
if grep -qe "<search>" <(echo "${ASSOC_ARRAY[@]}"); then echo value is present; fi 
```

*值不存在*：

```
if ! grep -qe "<search>" <(echo "${ASSOC_ARRAY[@]}"); then echo value not present; fi 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-09T17:41:19.697

`bad array subscript`当我正在检查的密钥未设置时，我收到错误消息。所以，我写了一个循环遍历键的函数：

```
#!/usr/bin/env bash
declare -A helpList 

function get_help(){
    target="$1"

    for key in "${!helpList[@]}";do
        if [[ "$key" == "$target" ]];then
            echo "${helpList["$target"]}"
            return;
        fi
    done
}

targetValue="$(get_help command_name)"
if [[ -z "$targetvalue" ]];then
    echo "command_name is not set"
fi 
```

它在找到时回显该值，而在未找到时不回显。我尝试过的所有其他解决方案都给了我这个错误。*

# azure - Azure 管理门户 Silverlight 版本

> ID：13219637
> 
> 赞同：1
> 
> 时间：2012-11-04T14:57:21.900
> 
> 标签：azure, acs

我需要为我的 ACS 服务使用旧的 Silverlight Windows Azure 管理门户。我记得，那个网站的网址是[http://windows.azure.com](http://windows.azure.com)。但它一直重定向到[http://manage.windowsazure.com](http://manage.windowsazure.com)。

无论如何我可以找到silverlight网站吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:35:02.860

我是新门户，您可以单击右上角（显示您的电子邮件的位置），这将打开头像栏，其中包含指向先前 Silverlight 门户的链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T15:06:36.733

我有同样的结果。要访问您的 ACS Web 管理门户，请使用此 URL 并将第一个域替换为您的服务。

```
 https://YOURSERVICE.accesscontrol.windows.net/v2/mgmt/web 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T15:23:35.633

将您重定向到 manage.windowsazure.com 后，转到右上角 - 显示您的姓名，然后单击您的姓名后，出现“上一个门户”选项。

# facebook - Facebook 实时更新

> ID：13219638
> 
> 赞同：1
> 
> 时间：2012-11-04T14:57:24.667
> 
> 标签：facebook, facebook-graph-api, real-time-updates

我无法在 Facebook 应用程序的“实时更新订阅”中添加“通知”。在developers.facebook.com 应用程序设置的“实时更新API”页面中，我有以下设置：

```
Object: user
Fields: notifications
Callback: http://myserver/callback
Verify token: my_token 
```

如果字段设置为“提要”，它可以工作，但如果我尝试将字段设置为“通知”进行保存，则失败并出现以下错误：

错误无法保存“用户”：应用程序无法订阅通知

有什么我需要配置的吗？我尝试在“权限”页面下添加所有“权限”。

任何输入将不胜感激！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T13:44:40.250

“请注意，您不能订阅用户对象的所有属性和连接的更改。您可以订阅的连接包括：提要、朋友、活动、兴趣、音乐、书籍、电影、电视、喜欢、签到、位置、事件。”

[https://developers.facebook.com/docs/reference/api/realtime/](https://developers.facebook.com/docs/reference/api/realtime/)

@CBroe 确实是正确的......我的错：|

# android - 未知的铬错误：-6（jquery mobile）

> ID：13219639
> 
> 赞同：3
> 
> 时间：2012-11-04T14:57:26.357
> 
> 标签：android, jquery, mobile, chromium

我正在开发一个 android 本机应用程序，并且正在使用 Webview 加载我的 android_asset/www/index.html 文件：

```
import android.app.Activity;
import android.os.Bundle;
import android.view.Window;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MainActivity extends Activity
{
    final Activity activity = this;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        WebView webView = (WebView) findViewById(R.id.webview);
        webView.getSettings().setJavaScriptEnabled(true);

        webView.setWebChromeClient(new WebChromeClient() {

        });

        webView.setWebViewClient(new WebViewClient() {
            @Override
            public void onReceivedError(WebView view, int errorCode, String description, String failingUrl)
            {
                // Handle the error
            }
        });

        webView.loadUrl("file:///android_asset/www/index.html");
    }
} 
```

这一切都很好，直到我将 jquery-mobile js 的导入放在标题中：

```
<html>
<head>
    <link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css" />
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery.mobile-1.2.0.min.js"></script>
</head>

<body>
</body> 
```

当我将 jquery mobile js 包含到我的 html 文档中时，logcat 给了我一个未知的铬错误 -6。当我包含正常的 jquery js 时，这不会发生。

我正在使用 android 4.0.3 在 nexus S 上运行我的应用程序

有没有人有使用这个框架的经验？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T05:08:29.930

如果您还没有找到解决方案，我在搜索相同问题时遇到了以下链接：

[Phonegap讨论组](http://comments.gmane.org/gmane.comp.handhelds.phonegap/20979)

[关于 Stackoverflow 的问题](https://stackoverflow.com/questions/12436627/unknown-chromium-error-6-sencha-and-phonegap)

# javascript - $("body").scrollTop() 在 safari 中不更新

> ID：13219640
> 
> 赞同：4
> 
> 时间：2012-11-04T14:57:27.810
> 
> 标签：javascript, jquery

我在一个网站上工作：

[http://beta.projektopia.se/](http://beta.projektopia.se/)

正文有几个背景图像，它们在滚动时更新，如下所示：

```
$(document).ready(function(){

    $(document).scroll(function(){
        var scrollfactor=$("body").scrollTop()*0.2;
        var centerscrollpos =scrollfactor+613;
        var docheight = $(document).height();
        var windowheight = $(window).height();
        var bottompos = (docheight-980)-((docheight-windowheight)*0.2)+scrollfactor;
        var scrollpos = 'center '+scrollfactor+'px,center '+bottompos+'px, center '+ centerscrollpos+'px,center 0px';
        $("body").css("background-position", scrollpos);
    });
}); 
```

很多计算，但重要的是创建了一个滚动位置，它应该在滚动时改变背景的位置，以创建视差效果。它在 chrome 中运行良好，但在 Firefox 中，假设获取当前滚动位置的变量滚动因子不会更新。

ps，有些人由于缺少正确的文档类型而遇到此问题。我相信我已经像这样正确地声明了它：

```
<!DOCTYPE html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:06:49.507

众所周知，`scrollTop`jQuery 方法[存在问题](http://api.jquery.com/scrollTop/)。

根据浏览器的不同，您可能需要使用`$('html, body').scrollTop()`or`$(document).scrollTop()`或`$(window).scrollTop()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-10T08:11:23.550

对我来说，问题是元素上的任何类型的`overflow`属性。`html`在我删除它的那一刻，我`.scrollTop()`开始正常工作。我仍然想要`overflow-x: hidden`页面上的全局属性，所以我只是在`body`元素上设置它。

# .htaccess - htaccess ModRewrite 上的主干 JS 404

> ID：13219643
> 
> 赞同：1
> 
> 时间：2012-11-04T14:57:37.803
> 
> 标签：.htaccess, backbone.js

我的 .htaccess 文件中有以下内容：

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond  %{REQUEST_FILENAME} !-f
RewriteCond  %{REQUEST_FILENAME} !-d

RewriteRule ^api api.php [QSA,L] 
```

我可以浏览到就好了 - 两者`/api`和类似的东西`/api/5`

但是，当我尝试通过骨干网访问 url 时，出现 404 错误。真的不知道该去哪里...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:34:06.413

一些想法：

1.  当您说“我尝试通过骨干网访问网址”时，您确定请求的是正确的网址吗？我可以假设您知道自己在做什么，并且确实通过 Firebug、Chrome Inspector 检查了请求是否与您所说的相同，但是您对为什么会发生这种情况一无所知这一事实使我想明确基线事实。
2.  您的重写规则之前是否有任何`RewriteCond`可能使 url 仅针对某些请求重写？也许您不小心包含了一些条件，这意味着 ajax 请求不会被重写（ajax 请求通常可以通过一些请求标头识别）。
3.  Backbone.js 确实使用了`PUT`/ `DELETE`http 动词，这在某些 http 服务器上可能会出现问题，而无需对您的网站进行额外配置。我假设您正在使用 Apache，因为您提到了 .htaccess ——有一个工具可以将 .htaccess 与 IIS 一起使用，但您没有提到它。但是您似乎甚至没有`GET`任何数据成功。

# html - 内部样式表中的 HTML 注释标签

> ID：13219650
> 
> 赞同：3
> 
> 时间：2012-11-04T14:58:30.707
> 
> 标签：html, css, stylesheet

> **可能重复：**
> [注释掉 HTML 文档中的样式表以支持旧浏览器](https://stackoverflow.com/questions/6825773/commenting-out-stylesheets-in-html-documents-to-support-older-browsers)

我正在阅读 Wrox 发布的 Professional ASP.NET 2.0。见下面的代码。

```
 <head>
    <style type="text/css">

    <!--

    body {
    font-family:Verdana;
    }

    -->
    </style>
 </head> 
```

以下几行来自书中：

> 包含 HTML 注释标签是因为并非所有浏览器都支持内部样式表。通常是较旧的浏览器不接受它们。在样式定义周围放置 HTML 注释可以隐藏这些定义，使其对非常旧的浏览器不可见。

现在我的问题是，评论之间的内容怎么可能只隐藏到旧浏览器而不是新浏览器？新浏览器不会受到评论的影响吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T15:08:05.333

旧的（或者更确切地说，古老的）浏览器无法识别`<style>`，因此它被视为任何其他未知元素，其内容被视为 HTML。评论被视为评论，因此不会呈现任何内容。

支持的浏览器`<style>`知道将内容视为 CSS 并忽略 HTML 注释（根据[规范](http://www.w3.org/TR/html4/present/styles.html#hiding)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T15:05:30.257

这个想法是，这是一种内置于新浏览器支持内联样式表的技术。这只是在内部样式表中忽略 html 注释分隔符 (`<!--`和`-->`) 的规则，因此此方法将起作用。（如果我没记错的话，它们只会在样式表的开头和结尾被忽略，但我对此并不完全确定。）

在较旧的浏览器中，它不知道如何处理脚本标签，因此它会将所有内容直接放在页面上。但是，其中除了评论之外什么都没有，因此用户将看不到任何内容。如果您确实想在 CSS 中使用注释，请使用 CSS 注释样式（`/*`和`*/`）。

另请注意，这种方法适用于非常古老（或古老）的浏览器。如今，这种技术不再很普遍，我敢说它也不再需要了（旧的浏览器可能无论如何都无法正确显示您的页面）。

# qt - 快速桌面组件

> ID：13219653
> 
> 赞同：1
> 
> 时间：2012-11-04T14:59:04.823
> 
> 标签：qt, plugins, desktop

我尝试安装 Qt Quick Desktop Components，但出现如下错误：

> 未找到模块“QtDesktop”插件“styleplugin”

```
 import QtDesktop 0.1 
 ^ 
```

有人可以帮我吗？

# php - 在php中将文本文件转换为xml

> ID：13219658
> 
> 赞同：0
> 
> 时间：2012-11-04T14:59:36.623
> 
> 标签：php, xml, file, text

我有一个 file.txt，其中包含以下内容：

```
[General]
FileVersion=3
NumberOfWaypoints=12
[Point1]
Latitude=50.8799722
Longitude=4.7008664
Radius=10
Altitude=25
ClimbRate=30
DelayTime=2
WP_Event_Channel_Value=100
Heading=0
Speed=30
CAM-Nick=0
Type=1
Prefix=P
[Point2]
... 
```

我想从中提取数据，以便稍后将其解析为 xml 文件或数据库。

我试过使用像 substr 和 strrpos 这样的 php 函数，但我总是遇到麻烦，因为像高度和爬升率这样的值的长度可能是“20”或“2”或“200”。同样当使用 strrpos 并且“needle”的值出现多次时；我没有得到正确的价值。

以前有人遇到过这种类型的问题吗？

（编辑：我将文件加载到 php 字符串中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:07:40.880

你可以试试这个：

```
<?php
$array = parse_ini_string($string);

$xml = new SimpleXMLElement('<root/>');
array_walk_recursive($array, array ($xml, 'addChild'));
echo $xml->asXML();
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:13:30.300

或者你可以试试这个：

```
<?php
//or create $file from file_get_contents('file.txt');
$file = "[General]
FileVersion=3
NumberOfWaypoints=12
[Point1]
Latitude=50.8799722
Longitude=4.7008664
Radius=10
Altitude=25
ClimbRate=30
DelayTime=2
WP_Event_Channel_Value=100
Heading=0
Speed=30
CAM-Nick=0
Type=1
Prefix=P
[Point2]";

//or create $array with file('file.txt');
$array = explode("\n",$file);

//Create and output xml from the given array
header('Content-Type: text/xml');
$xml = new SimpleXMLElement('<?xml version="1.0" encoding="UTF-8"?><points/>');

foreach($array as $k=>$v){
    if(substr($v,0,1)=='['){
        $node = $xml->addChild(str_replace(array('[',']'),'',$v));
    }else{
        list($key,$value) = explode('=',$v,2);
        $node->addChild($key, trim($value));
    }
}

//DOMDocument to format code output
$dom = new DOMDocument('1.0');
$dom->preserveWhiteSpace = false;
$dom->formatOutput = true;
$dom->loadXML($xml->asXML());

echo $dom->saveXML();

/*Result:
<?xml version="1.0" encoding="UTF-8"?>
<points>
  <General>
    <FileVersion>3</FileVersion>
    <NumberOfWaypoints>12</NumberOfWaypoints>
  </General>
  <Point1>
    <Latitude>50.8799722</Latitude>
    <Longitude>4.7008664</Longitude>
    <Radius>10</Radius>
    <Altitude>25</Altitude>
    <ClimbRate>30</ClimbRate>
    <DelayTime>2</DelayTime>
    <WP_Event_Channel_Value>100</WP_Event_Channel_Value>
    <Heading>0</Heading>
    <Speed>30</Speed>
    <CAM-Nick>0</CAM-Nick>
    <Type>1</Type>
    <Prefix>P</Prefix>
  </Point1>
  <Point2/>
</points>
*/ 
```

# java - 在java中读取xml - 所有节点和数据排序

> ID：13219660
> 
> 赞同：2
> 
> 时间：2012-11-04T14:59:55.193
> 
> 标签：java

现在我的软件将显示来自 xml 文件的（根元素：数据），但我需要节点列表。这是 Xml 文件所拥有的，例如：

（数据有“count”和“person”）

（计数 = 1）

（人有“名字”和“汽车”）

（名字=“亚当”）

（汽车有“Porshe”和“minimini”）

软装

```
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.DocumentBuilder;
import org.w3c.dom.Document;
import org.w3c.dom.NodeList;
import org.w3c.dom.Node;
import org.w3c.dom.Element;
import java.io.File;
public void Ada()
{
File fXmlFile = new File("c:\\file.xml");
            DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
            DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
            Document doc = dBuilder.parse(fXmlFile);
            doc.getDocumentElement().normalize();

            System.out.println("Root element :" + doc.getDocumentElement().getNodeName());
} 
```

XML 文件：

```
<data>
    <count>1</count>
    <person>
        <name>Adam<name>
        <cars>
            <fast>Porshe</fast>
            <slow>MiniMini</slow>
        </cars>
    </person>
</data> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:04:49.657

您可以使用：

```
doc.getChildNodes() 
```

深入并递归钻取，直到没有孩子。

它将返回一个`NodeList`你可以使用`size()`'power'一个for循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:10:06.367

看看 XPath：http: [//developer.android.com/reference/javax/xml/xpath/package-summary.html](http://developer.android.com/reference/javax/xml/xpath/package-summary.html)

您基本上可以使用它在 Android 上使用 XML 做任何您需要的事情。

所以像：

```
XPath x = XPathFactory.newInstance().newXPath();
String expression = "/data";
InputSource source = new InputSource("someXML.xml");
NodeSet nodes = (NodeSet)xpath.evaluate(expression, source, XPathConstants.NODESET); 
```

那应该给你一个节点的 NodeSet。

希望有帮助。

# javascript - Javascript 'this' 和异步发布方法

> ID：13219661
> 
> 赞同：0
> 
> 时间：2012-11-04T14:59:56.840
> 
> 标签：javascript, post, asynchronous

我对 javascript 有点陌生，我在实施以下内容时遇到了困难（现在已经有 2 天了）：

考虑我有一个 Object()，'engine'，我希望它根据帖子的内容做出不同的响应。即用户有一个动作，引擎解释动作，向服务器发送请求，服务器响应，“引擎”相应地采取行动。

作为所需行为的一个最小示例，我展示了一个“引擎”，它假设正在接收鼠标点击的位置（receiveClickEvent），通过“帖子”（requestByAsyncPost）发送它，并根据其内容做出响应（respondToRequest）：

做post的一个小功能

```
function requestByAsyncPost(content, funct)
{
/* some initialization missing here to not confuse the reader */
xmlhttp.onreadystatechange = function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            funct(xmlhttp.response);
        }
    }
xmlhttp.open("POST","foobar.php", true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send(content);
}

var engine = new Object()
engine.respondToRequest = function(content) {/*implementation*/ } 
```

当鼠标点击发生时我想激活的一小段代码（现在不管它是如何触发的）

```
engine.receiveClickEvent = function(position)
{
    var funct = function(content)
    {
         this.respondToRequest(content); //<<<---- I want to refer engine's 'this'
    }
    requestByAsyncPost('request=click&position=['+position[0]+','+position[1]+')', funct);
} 
```

这不是我想要的方式，因为“this”在函数函数内部。我怎样才能实现这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:03:41.147

`this`你必须通过这种或其他方式记住外部。像：

```
engine.receiveClickEvent = function(position)
{
    var self = this;
    var funct = function(content)
    {
         self.respondToRequest(content); //<<<---- 'self' refers engine's 'this'
    }; // <<<--- btw, missed semicolon
    requestByAsyncPost('request=click&position=['+position[0]+','+position[1]+')', funct);
}; // <<<--- btw, here, too :-) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:04:58.527

在大量使用匿名 AJAX 回调函数时，我经常遇到同样的问题。

这就是我“解决”此类问题的方式：

```
var engine = function (args) {
    // store a reference to "this" inside a variable for reuse in another scope
    var me = this;
    var fetchSomething = function (args) {
        var req = $.ajax({
            method: 'POST',
            url: url,
            success: function(data) {
                // use "me" instead of "this", because "this" is scope dependant
                me.doSomething(data);
            }
        });
    }
    var doSomething = function (data) {
        // some logic here.
    }  
} 
foo = new engine({arg: 'foo', arg2: 'bar'});
foo.fetchSomething(url); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T15:02:44.730

您始终可以将当前的 this 保存在一个变量中，然后在任何您想要的地方使用它：

```
var that = this; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T15:03:18.633

试试这个：

```
engine.receiveClickEvent = function(position)
{

    var me = this;
    var funct = function(content)
    {
         me.respondToRequest(content); //<<<---- I want to refer engine's 'this'
    }
    requestByAsyncPost('request=click&position=['+position[0]+','+position[1]+')', funct);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T15:05:20.397

我不确定我是否完全理解这个问题，但我认为您可能正在寻找的是在引擎对象中定义一个 var this .. 然后在您的函数中使用该变量而不是 this ..

IE ：

```
var engine = function(){
var self = this;

receiveClickEvent = function(position)
{
    var funct = function(content)
    {
         **self**.respondToRequest(content); //<<<---- I want to refer engine's 'this'
    }
    requestByAsyncPost('request=click&position=['+position[0]+','+position[1]+')',   funct);
}

} 
```

# java - Java 数组中每个元素的多个值

> ID：13219666
> 
> 赞同：0
> 
> 时间：2012-11-04T15:00:09.857
> 
> 标签：java, android, arrays, multidimensional-array

我想知道是否有一种方法可以将每个项目的信息元素超过 2 个元素存储在一个项目数组中。

例如，对于一个城市数组，我想存储人口（int）、名称（字符串）、市长（字符串）、是否有机场（布尔值）。

我需要一个可修改的列表，例如一个我可以通过它们的位置轻松添加和访问元素的列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:03:50.673

创建一个名为 的类`City`，并包含必要的字段：`population`、`name`、`mayor`、`airportPresent`。

使用 a `java.util.List<City>`(`java.util.ArrayList`通常是作为实现的最佳选择)。

Java 是一种面向对象的语言。使用对象来存储您的信息，并封装行为。使用多维数组不是合适的解决方案。

# c++ - 瘦的实现安全吗（用 auto 和 type_traits 重新实现 max）

> ID：13219667
> 
> 赞同：0
> 
> 时间：2012-11-04T15:00:11.443
> 
> 标签：c++

```
#include <iostream>
#include <type_traits>

#include <boost/type_traits.hpp>

template<typename T, typename U>
struct promote
{
  private:
    typedef typename std::conditional<(sizeof(T) > sizeof(U)), T, U>::type Bigger;
    typedef typename std::add_const<Bigger>::type BConst;

  public:
    //because mingw4.6.2 do not implement std::add_reference
    typedef typename boost::add_reference<BConst>::type type;
};

template<typename T, typename U>
auto max(T const &a, U const &b)->typename promote<T, U>::type
{
  return a > b ? a : b;
}

int main(int argc, char *argv[])
{
  std::cout<<max(3, 4.5)<<std::endl;
  std::cout<<max(4.5, 3)<<std::endl;

  return 0;
} 
```

mingw4.6.2 的 std::max

```
template<typename T>
inline T const& max(T const &a, T const &b)
{
  return a > b ? a : b;
} 
```

这会给我警告信息

main.cpp:27:24：警告：返回对临时的引用 [默认启用]

main.cpp:27:24：警告：返回对临时的引用 [默认启用]

编译器是migw4.6.2，操作系统是win7 64bits

第二个版本，只支持标量类型

```
template<typename T, typename U>
struct promote
{
   typedef typename std::conditional<(sizeof(T) > sizeof(U)), T, U>::type type;

};

template<typename T, typename U>
inline typename promote<T, U>::type max(T a, U b)
{
  static_assert(std::is_scalar<T>::value, "inhomogeneous max only support scalar type");
  static_assert(std::is_scalar<U>::value, "inhomogeneous max only support scalar type");

  return a > b ? a : b;
} 
```

另一个解决方案是使用 SFINAE 和 boost::mpl 来做一些“过载”。我想我会在实际情况下明确命名 std::max 的类型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:18:10.507

不，这不安全。这正是编译器警告您的内容。您返回对临时值的引用（在本例中为 4.5）。如果将结果分配给类似`int &x = max(3, 4,5);`,`x`将在此行之后立即成为悬空引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:20:34.160

一般来说，问题`max()`是您希望它做以下两件事之一：

1.  选择同质值的最大值并返回对该值的引用。
2.  选择最大的非同质值并将结果值转换为最一般的类型。

在非同质情况下返回引用不起作用，因为返回了对临时的引用，该引用在函数调用可以抓住它之前将不复存在。在同质情况下返回一个值可能是不可取的。

# java - 是否有一种有效的算法可以将多组数字打包到几个桶中？

> ID：13219675
> 
> 赞同：1
> 
> 时间：2012-11-04T15:01:17.637
> 
> 标签：java, algorithm, set

例如，您有几个`double`s 列表，您需要将它们分布在几个固定大小的“桶”中（桶大小也是 a `double`）。还有两个额外的约束：

*   某些列表中的值只能进入某些（预先指定的）存储桶：

    ```
    bucket1 <-\
               |--- list1
              /
             /
    bucket2 <--\
    bucket3 <---- list2
    bucket4 <--/

    bucket5 <--- list3 
    ```

*   生成的分布必须尽可能均匀（例如，所有桶的负载因子为`0.5`）。

此类问题的具体示例：假设您有多个电源单元（“桶”）和几块灯板。每个供电单元连接到一个或多个板，每个供电单元的容量不同，灯消耗的能量不同。如果某些板连接到多个电源单元，那么您可以将一些灯“分配”到第一个电源，一些 - 到第二个，等等。

对于大量元素，使用蛮力快速执行此操作变得不可行。

有没有有效的方法？

**编辑：**我设计了以下方法-似乎很快就收敛到所需的结果。思路如下：

*   首先，对于每个列表，我使用最小加载桶启发式将项目分配到允许的桶中。
*   然后，我执行以下操作：
    *   对于每个列表：
        *   从桶中删除与列表对应的项目
        *   使用相同的最小负载启发式再次分发它们
        *   计算最大负载桶大小与最小负载的比率（对于允许的桶）
    *   如果 ratio 小于某个常数（我采用`1.02`），或者通过了太多步骤，则终止循环。

一般的想法是“平滑”桶，直到分布变得足够平坦，这通常意味着我们达到了所需的目标。

这是一个好的算法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:15:20.597

在我看来，这听起来像是[装箱问题](http://en.wikipedia.org/wiki/Bin_packing_problem)或带有额外约束的背包问题（某些列表只能转到特定的桶），您需要一个解决方案，将所有桶装满至少特定的负载因子。说到“高效”，我会说你所描述的应该是 NP 难的（“应该”，因为我还没有时间考虑从 NP 问题减少到你的具体问题，但我很确定有一个）。

你可以尝试什么：首先解决约束问题并确定哪些行可以进入哪些桶，然后贪婪地填充桶。如果您的约束很难，您可以进行回溯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:15:03.157

简短的回答：没有。这是NP完全的。有关更多信息，请阅读以下维基百科：

[http://en.wikipedia.org/wiki/Bin_packing_problem](http://en.wikipedia.org/wiki/Bin_packing_problem)

[http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)

# java - 枚举、单例和反序列化

> ID：13219678
> 
> 赞同：8
> 
> 时间：2012-11-04T15:01:35.440
> 
> 标签：java, enums, singleton, deserialization

枚举被认为是单例的最佳方式，原因之一是它隐式继承`Serializable`。

但是枚举如何防止单例的反序列化问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T15:41:03.903

序列化机制以一种[特殊的、特定的方式](http://docs.oracle.com/javase/1.5.0/docs/guide/serialization/spec/serial-arch.html#enum)处理它们。但是传统的单例可以通过定义一个`readResolve()`返回唯一实例的方法来很好地反序列化。有关示例，请参见[http://www.oodesign.com/singleton-pattern.html 。](http://www.oodesign.com/singleton-pattern.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:39:46.203

将序列化作为将枚举用于单例的参数是无稽之谈。

如果枚举单例是有状态的，则在序列化/反序列化期间状态会丢失。

如果单例是无国籍的，谁在乎它的身份？

# ruby-on-rails - 如何通过 Rails 中的模型定义表单选择值？

> ID：13219679
> 
> 赞同：1
> 
> 时间：2012-11-04T15:01:35.497
> 
> 标签：ruby-on-rails, forms, activerecord, model, scaffolding

我创建了一个名为 Categories 的简单模型，它连接到 Platforms 模型。

```
class Platform < ActiveRecord::Base
    attr_accessible :name, :url, :country, :categories
   belongs_to  :category
end 
```

和

```
class Category < ActiveRecord::Base
  attr_accessible :name
  has_many :platforms
end 
```

我也成功地拥有了创建新平台的表格：

```
<%= simple_form_for(@platform) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :name %>
    <%= f.input :url %>
    <%= f.input :country %>
    <%= f.label :category %>
    <%= f.collection_select(:category_id, @categories, :id, :name, :include_blank => "Please select") %>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %> 
```

不幸的是，由于模型类别是新的，下拉列表目前只有 1 个值“请选择”。如何向此选择添加新值，最好是通过模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:15:16.320

请注意，使用 simple_form，您可以使用自动生成下拉列表

```
<%= f.association :category %> 
```

这将使用数据库中的类别自动填充列表。有关更多提示，请参阅[文档](https://github.com/plataformatec/simple_form)。

编辑：类别只需单独添加。您可以使用 db/seeds.rb 脚本或通过 rails 控制台手动为数据库添加类别。或者您可以允许用户通过单独的表单和控制器添加类别。

例如，要在控制台中创建几个类别，`rails c`请从命令行运行并运行`Category.create!(name: "Name")`几个名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:12:09.087

在`new`PlatformsController 的操作中，添加`@categories = Category.all`，因此您将拥有所有类别。

# c++ - 将位集转换为 ASCII 字符串

> ID：13219683
> 
> 赞同：1
> 
> 时间：2012-11-04T15:02:27.933
> 
> 标签：c++, string, bitset

如何将二进制转换回字符串？

```
std::string test1("Hello");
std::bitset<8> test2;
test2 = std::bitset<8>(test1.c_str()[0]);

std::cout << test2 << std::endl;
std::string test3=test2.to_string<char,std::char_traits<char>,std::allocator<char> >(); 
std::cout << test3 << std::endl; 
```

这将输出：01001000 01001000

我如何输出回“你好”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:12:52.060

你`std::bitset<8>`分明无法容纳这个世界`"Hello"`。毕竟，你只代表 8 位。您可以做的是将每个转换`char`为 a `std::bitset<8>`（假设`char`是 8 位，当然，这通常是这种情况，但不能保证）并`std::bitset<8>`使用`to_ulong()`. 将由此获得的这个值转换为`char`应该产生原始字符：

```
std::bitset<8> c(test1[0]);
std::cout << "c=" << c << " char(c.to_ulong())=" << char(c.to_ulong()) << "\n"; 
```

要`"Hello"`回来，您需要更大的`std::bitset<N>`，并且您需要确保提取正确的位以重新组装正确的单个字符。

# scala - Scala 无法访问对象类

> ID：13219685
> 
> 赞同：0
> 
> 时间：2012-11-04T15:02:32.573
> 
> 标签：scala, object, methods

我显然在这里遗漏了一些基本的东西。我有以下 Scala 代码：

```
package org.carlskii

import java.io._
import java.security.cert.CertificateFactory
import java.security.Security
import org.bouncycastle.jce.provider._

object Main extends App {

  Security.addProvider(new BouncyCastleProvider)
  val provider = new BouncyCastleProvider
  val in = new FileInputStream("cert.cer")
  val certificateFactory = CertificateFactory.getInstance("X509", provider)
  val certificate = certificateFactory.generateCertificate(file)
  println(certificate.getClass)

} 
```

产生这个：

```
class org.bouncycastle.jce.provider.X509CertificateObject 
```

所以我有一个充气城堡`X509CertificateObject`对象。如果我调用该`certificate.getPublicKey`方法，它会正确返回证书的公钥。

但是，如果我调用`certificate.getSerialNumber`它会引发以下错误：

```
error: value getSerialNumber is not a member of java.security.cert.Certificate
println(certificate.getSerialNumber) 
```

有趣的是，Scala 认为它是一个对象`java.security.cert.Certificate`，而不是一个`org.bouncycastle.jce.provider.X509CertificateObject`对象。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:23:06.597

[generateCertificate](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/cert/CertificateFactory.html#generateCertificate%28java.io.InputStream%29)方法返回一个[Certificate](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/cert/Certificate.html)对象，如果你确定你会得到一个`org.bouncycastle.jce.provider.X509CertificateObject`刚刚转换的结果：

```
package org.carlskii

import java.io._
import java.security.cert.CertificateFactory
import java.security.Security
import org.bouncycastle.jce.provider._

object Main extends App {

  Security.addProvider(new BouncyCastleProvider)
  val provider = new BouncyCastleProvider
  val in = new FileInputStream("cert.cer")
  val certificateFactory = CertificateFactory.getInstance("X509", provider)
  val certificate = certificateFactory.generateCertificate(file).asInstanceOf[X509CertificateObject]
  println(certificate.getClass)

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:07:06.733

方法 generateCertificate 返回类型证书，因此推断 val 证书具有类型证书。方法 generateCertificate 具有以下方法签名：

```
Certificate generateCertificate(InputStream inStream) 
```

当您将此调用的结果分配给 val scala 编译器将推断证书的类型，即方法 generateCertificate 返回的证书类型。

因此，如果您想调用在 X509CertificateObject 类型上定义的方法，您必须首先将其转换为正确的类型：

```
certificate.asInstanceOf[X509CertificateObject] 
```

你从 getClass 得到的是一个对象的运行时类。

# java - 初学者：试图让一个具有接口的类扩展另一个类

> ID：13219690
> 
> 赞同：1
> 
> 时间：2012-11-04T15:03:00.257
> 
> 标签：java

我有两节课，我希望我的第二节课能够访问第一节课的私人数据。

通常我会有：

```
public class GenericDictionary<T> implements GenericDictionary_interface<T> {

public class Iterator<T> extends GenericDictionary<T> { 
```

但是我有一个界面，我不完全知道它们是如何工作的，有时它们似乎没有必要。

```
public class Iterator<T> implements Iterator_interface<T> { 
```

如何扩展另一个类并拥有一个接口？不需要接口吗？我`Iterator<T>`班级的界面应该在晚餐的界面吗？如果是这样……怎么办？

**PS**请不要告诉我为什么我在做我正在做的事情（也就是制作我自己的东西而不是使用java.util中的东西。*）

**编辑：**即使我决定使用内部类，我的问题的答案是扩展和实现的顺序，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:06:51.680

> 如何扩展另一个类并拥有一个接口？

你把第`extends`一个，然后是`implements`：

```
public class Iterator<T>
    extends GenericDictionary<T>
    implements Iterator_interface<T>
{ 
```

例如，在 JDK 中，`java.util.ArrayList`给出为

```
public class ArrayList<E>
extends AbstractList<E>
implements List<E>, RandomAccess, Cloneable, Serializable 
```

（参见[它的 Javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:08:02.957

`How can I extend another class and have an interface ?`如果您的意思是，一个类如何在实现接口的同时扩展另一个类。

```
 public class Iterator<T> extends anotherClass implements Iterator_interface<T> { 
```

当您有两个或多个具有相同行为但行为略有不同的类时，请使用接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T15:17:37.143

如果您希望另一个类访问第一个类的私有数据，您可以将其设为内部类。它将能够访问外部类的私有成员。继承就是在编程世界中反映现实世界的问题，而 `Iterator extends GenericDictionary`不是通常做的事情。对于接口，它们的限制最少，可以在任何地方使用。

# java - 在 IDL + Java 中访问变量和参数

> ID：13219692
> 
> 赞同：2
> 
> 时间：2012-11-04T15:03:19.240
> 
> 标签：java, variables, arguments, corba, idl

我现在正在研究分布式系统，所以...我必须学习 IDL 的东西。:D 我有这个要求：

*在 IDL 中定义 - 一个结构体的帐户 - 一个帐户序列的帐户 - 具有一些帐户操作的客户接口： **payIn (amount, accountId), - 如果成功则返回 true，否则返回 false getAccounts (name), - 返回一个序列帐户（属于该人）** - 具有帐户操作的界面管理员： **创建一个新帐户删除一个帐户***

这是我的 .idl 文件：

```
module AccountNaming
{
    struct Account
    {
        long id;
        double balance;
        string name;    
    };

    typedef sequence<Account> accounts;

    interface Customer
    {
        boolean payIn(in double amount, in long accountId);
        accounts getAccounts(in string name);
        string helloCust();
    };
    interface Administrator
    {
        void createAcc();
        void deleteAcc();
        string helloAdmin();
    };
}; 
```

我已经为 IDL 生成了所有的 POA、Helper、Holder 类。

在我的 Java 代码中，我有一个使用 IDL 代码的类：

```
import AccountNaming.*;
public class CustomerImpl extends CustomerPOA
{
   public String helloCust()
   {
      return "Hello, dear Customer! :) ";
   }

   @Override
   public boolean payIn(double amount, int accountId)
   {
      // how to get to the Customer's local variables ?
      super.Customer.setAmount... // or something like that, because this doesn't work... etc.
      return false;
   }

   @Override
   public Account[] getAccounts(String name)
   {
      // TODO Auto-generated method stub
      return null;
   }
} 
```

我知道 .idl 文件是正确的。“helloCust/admin”方法有效。我的问题是如何访问 Customer/Administrator 的变量，以便我可以将它们设置为*payIn 、 getAccounts*方法中的参数......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:30:30.033

你可以添加一个外观或工厂来允许你访问你的`Customer/Administrator`接口，所以在你的 IDL 中你还可以：

```
interface UserFactory 
{
   Customer getCustomer(String customerName);
   Administrator getAdministrator(String credentials); 
} 
```

这个接口的实现会让你从数据库等中查找任何细节。

使用它，您可能不需要该`name`字段`getAccounts()`（除非它用于过滤），您可以执行以下操作：

```
Account[] accounts = getAccounts("not-needed-anymore");
for (Account account : accounts) {
   if (account.id == accountId) {
      account.balance += amount;
      break;
   }
} 
```

这将更新您的`Account`数组信息，但您仍需要保留数据结构。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-09T20:41:54.810

感谢 Reimeus 的快速回答，但我想到了一个更简单的解决方案：

```
public boolean payIn(double amount, int accountNumber)
    {
        boolean success = false;
        for(int i = 0; i < accountList.length; i++)
        {
            if(accountList[i].accountNumber == accountNumber)
            {
                accountList[i].balance += amount;
                success = true;
            }
        }
        return success;
    }

    @Override
    public account[] getAccounts(String name)
    {
        account[] accounts;
        int numberOfAccounts = 0;
        int count = 0;
        for(int i = 0; i < accountList.length; i++)
        {
           if(accountList[i] != null)
            if(accountList[i].name.equalsIgnoreCase(name))
            {
                numberOfAccounts++;
            }
        }
        if(numberOfAccounts != 0)
        {
            accounts = new account[numberOfAccounts];
            for(int i = 0; i < accountList.length; i++)
            {
                if(accountList[i].name.equalsIgnoreCase(name))
                {
                    accounts[count] = accountList[i];
                    count++;
                }
            }
            return accounts;
        }
        else
        {
            return null;
        }

    } 
```

# jakarta-ee - 如何为每个重定向到 https 而不是 http 的请求使用 Struts2 拦截器

> ID：13219694
> 
> 赞同：1
> 
> 时间：2012-11-04T15:03:44.913
> 
> 标签：jakarta-ee, struts2, interceptor

我正在开发 jsp,struts2 Web 应用程序，我只需要 HTTPS。那么你能告诉我如何用struts2拦截器做到这一点。请不要建议 tomcat 配置或 web.xml 文件更改，因为我对该解决方案不满意。我只希望它在 struts2 拦截器中

有没有人对此有想法（这应该是一种过滤器，将为每个请求完成执行）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:12:31.577

恕我直言，您要求使用 https 而不是 http 显然是一种 web.xml 安全措施，它与 Struts2 无关。

要将每个请求重定向到 HTTPS 而不是 HTTP，只需将以下代码放入您的 web.xml

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>All Under HTTPS</web-resource-name>
        <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
</security-constraint> 
```

# php - 在 foreach 中显示除

> ID：13219698
> 
> 赞同：0
> 
> 时间：2012-11-04T15:04:15.077
> 
> 标签：php, wordpress, taxonomy

有没有办法我从这个 foreach 循环的列表中排除一位老师（“罗伯特”）并将他的条目单独放在顶部？

```
$teachers = get_terms('teacher');
foreach($teachers as $teacher) {
  $link = get_term_link(intval($teacher->term_id),'teacher');
  $description = term_description(intval($teacher->term_id),'teacher');
  echo "<h3><a href=\"{$link}\">{$teacher->name}</a></h3>";
  echo substr($description,0,200) . "...";
  } 
```

“老师”是一个 Wordpress 分类术语。我正在尝试创建一个所有教师的列表，其中 Robert 位于顶部，因为他是班主任。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:16:32.230

由于显而易见的原因，这种解决方案是浪费的，例如，您可以将内部细节放入部分中以节省重复回显代码两次（不要重复自己，干）。修改生成查询也会更好，因此校长始终是第一个结果，但请理解您使用的框架可能无法做到这一点。

最好使用抽象的“校长”值进行检查，而不是对名称进行硬编码。

```
$teachers = get_terms('teacher');
foreach($teachers as $teacher) {
    if($teacher->name == 'Robert') {
      $link = get_term_link(intval($teacher->term_id),'teacher');
      $description = term_description(intval($teacher->term_id),'teacher');
      echo "<h3><a href=\"{$link}\">{$teacher->name}</a></h3>";
      echo substr($description,0,200) . "...";
    }
}

foreach($teachers as $teacher) {
    if($teacher->name != 'Robert') {
      $link = get_term_link(intval($teacher->term_id),'teacher');
      $description = term_description(intval($teacher->term_id),'teacher');
      echo "<h3><a href=\"{$link}\">{$teacher->name}</a></h3>";
      echo substr($description,0,200) . "...";
    }
} 
```

# jquery - 更改页面上的按钮单击而不是列表框单击 Jquery

> ID：13219699
> 
> 赞同：0
> 
> 时间：2012-11-04T15:04:17.050
> 
> 标签：jquery, html, button

我有一个列表框和列表框旁边的按钮。我正在尝试对选定的列表框项目进行页面更改。因此，选择了一个项目，然后按下按钮，这会更改页面并将项目传递到搜索页面。

目前，当我按下列表框中的按钮时，它会更改页面。它不会等你按下按钮。提供的 HTML 在这里

```
 <div style="margin:auto">
<h3 style="text-align:center">
 Or Search By Home Town: 
 <select id="myTown">
 <?php 
   include("scripts/dbconnect.php"); 
   include("scripts/lists.php"); 
 ?>
 </select>
 <input type="button" value="Search" />
</h3> 
```

我的选择器在这里：

```
 $('#myTown option').click(getTown);
function getTown(){
 var town=$(this).val();
 window.location='searchresults.php?querystring='+town+'&querydesc=Town= &querytype=4';} 
```

我认为“这个”应该改为按钮或类似的东西。

或者需要更改选择器“选项”。如果有人可以提供帮助，那就太好了。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:06:21.877

为什么不为按钮分配一个事件处理程序：

```
$('#button1').click(function() { getTown(); });

<input id="button1" type="button" value="Search" /> 
```

然后摆脱选项标签的事件处理程序

更新（如果你不能改变 html）：

```
$('#myTown').parent().find('input').click(function() { getTown(); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:08:42.563

使用选择框更改事件。每次更改选项时都会触发更改。

```
 <input type="button" id="btn" value="Search" />

 $('#btn').click(getTown);
function getTown(){
 var town=$("#myTown").val();
 window.location='searchresults.php?querystring='+town+'&querydesc=Town= &querytype=4';} 
```

# c++ - 为什么eclipse找不到g++？

> ID：13219700
> 
> 赞同：0
> 
> 时间：2012-11-04T15:04:21.937
> 
> 标签：c++, eclipse, ubuntu, g++, eclipse-juno

我正在运行 ubuntu 和 eclipse juno。我已经安装了 ctd、g++ 和 gcc。

一切正常，但是：

我有一个简单的 hello world 程序，可以编译、运行和打印，但是当我在 eclipse 中看到该项目时，我看到 std、namespace、cout 上的错误。

在我得到的错误中：在路径中找不到 g++

但 g++ 已安装。

这是代码：

```
#include <iostream>
using namespace std;

int main() {
cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
return 0;
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:50:24.343

在 Eclipse 配置环境中，在 $PATH 变量中添加 g++ 的路径

# php - fsockopen 无法使用 FastCGI (PHP)

> ID：13219701
> 
> 赞同：3
> 
> 时间：2012-11-04T15:04:30.657
> 
> 标签：php, centos, fastcgi, fsockopen

我有一个关于 fsockopen 的 php 问题

服务器：

VPS CentOS 6.3（最终版）PLESK 11

问题：

如果我使用 FastCGI 函数 fsockopen 不起作用。我得到：警告：fsockopen（）：无法连接到 xx.xx.xx.xx:80（权限被拒绝）

如果我在 plesk 11 中编辑网站（用于测试）并将其设置为 apache 它可以工作。

我找不到解决此问题的方法。有人有线索吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T15:46:26.147

禁用selinux或添加新规则让apache打开远程连接

添加规则使用

```
setsebool -P httpd_can_network_connect 1 
```

要禁用 selinux 或将其设置为许可模式，请编辑您的

```
/etc/selinux/config 
```

# asp.net-mvc - 如何通过操作方法在浏览器选项卡中显示 pdf 文件

> ID：13219704
> 
> 赞同：1
> 
> 时间：2012-11-04T15:04:49.200
> 
> 标签：asp.net-mvc

我正在尝试在 mvc 应用程序中执行 pdf 查看器功能。当用户单击“阅读 pdf”链接时，它应该打开一个新选项卡/窗口，并且用户应该能够查看 pdf 文件。因此，我检查了示例，但找不到。你能给我推荐任何文章或例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:12:18.517

在您的第一个视图中显示锚标记并传递一个 id（以识别要显示的 PDF）

```
@Html.ActionLink("read the pdf","view","doc",new { @id=123},null) 
```

现在在 doc 控制器中，有一个 action 方法，该方法调用了一个参数`id`，并使用该[`File`](http://msdn.microsoft.com/en-us/library/dd460208%28v=vs.98%29.aspx)方法返回 pdf。

```
public ActionResult View(int id)
{
  byte[] byteArrayOfFile=GetFieInByteArrayFormatFromId(id);
  return File(byteArrayOfFile,"application/pdf");
} 
```

假设`GetFileInByteArrayFormatFromId`是返回PDF文件的字节数组格式的方法。

如果您知道物理存储的 PDF 文件的完整路径，也可以使用此[重载](http://msdn.microsoft.com/en-us/library/dd492492%28v=vs.98%29.aspx)返回 PDF 。

```
public ActionResult Show()
{
  string path="FullPAthTosomePDFfile.pdf";
  return File(path, "application/pdf","someFriendlyName.pdf");
} 
```

**在浏览器中显示 PDF 而无需下载**

根据最终用户的浏览器设置，上述解决方案将询问用户他/她是否希望下载或打开文件，或者只是下载/打开文件。如果您希望直接在浏览器中显示文件内容而不将其下载到用户的计算机，您可以将文件流发送到浏览器。

```
public ActionResult Show(int id)
{
    // to do : Using the id passed in,build the path to your pdf file

    var pathToTheFile=Server.MapPath("~/Content/Downloads/sampleFile.pdf");
    var fileStream = new FileStream(pathToTheFile,
                                        FileMode.Open,
                                        FileAccess.Read
                                    );
    return  new FileStreamResult(fileStream, "application/pdf");           
} 
```

上面的代码希望你有一个名为location`sampleFile.pdf`的pdf 文件。`~/Content/Downloads/`如果您使用不同的名称/命名约定存储文件，您可以更新代码以从传入的 Id 构建唯一的文件名/路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T01:17:45.273

如果要在浏览器中显示 PDF 内容，可以使用 iTextShare dll。

请参阅链接[http://www.codeproject.com/Tips/387327/Convert-PDF-file-content-into-string-using-Csharp](http://www.codeproject.com/Tips/387327/Convert-PDF-file-content-into-string-using-Csharp)。

[在 VB.NET 或 C# 中使用 itextsharp dll 读取 PDF 内容](https://stackoverflow.com/questions/2550796/reading-pdf-content-with-itextsharp-dll-in-vb-net-or-c-sharp)

# ruby - 将字符串拆分为 N 个字符的子字符串

> ID：13219706
> 
> 赞同：2
> 
> 时间：2012-11-04T15:04:51.793
> 
> 标签：ruby

我只是想知道是否有更好的方法将字符串拆分为 N 个字符的子字符串：

```
"something" (by 4 characters) -> ["some", "omet", "meth", "ethi", "thin", "hing"] 
```

这是我的代码：

```
n = 4
s = "something"
result = []

0.upto(s.size - n) do | idx |
    result << s[idx..idx+n-1]
end

p result 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:12:05.090

```
"something".chars.each_cons(4).map(&:join)
=> ["some", "omet", "meth", "ethi", "thin", "hing"] 
```

# css - Firefox 的边框高度为 而铬没有

> ID：13219709
> 
> 赞同：3
> 
> 时间：2012-11-04T15:05:08.977
> 
> 标签：css, firefox

我正在尝试设置边框的样式，使其包含

1px 白线下方 1px 绿线

```
hr{
    height: 1px;
    border: 0;
    background-color: #89a889;
    border-bottom: 1px solid #fafafa;
} 
```

这在 webkit 中有效，但 Firefox 似乎将边框包含在行的总高度中。这使得底部边框覆盖绿线。我能做些什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:07:34.360

```
hr {
    height: 0;
    border: 0;
    border-top: 1px solid #89a889;
    border-bottom: 1px solid #fafafa;
} 
```

使用两个边框。

[演示](http://jsfiddle.net/eCaxz/)

或者，如果您真的希望它与背景颜色一起使用，请使用`box-sizing: content-box`Firefox 以`hr`使用正常的 CSS 框模型显示。

您可能希望包含其他供应商前缀。

```
hr {
    height: 1px;
    border: 0;
    background-color: red;
    border-bottom: 1px solid blue;
    -moz-box-sizing: content-box;
} 
```

[演示](http://jsfiddle.net/eCaxz/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T03:34:30.153

你可以设置`-moz-box-sizing: content-box; box-sizing: content-box;`. UA 样式表将其设置为边框大小。

# c - 使用 imagemagick API 截取屏幕截图

> ID：13219710
> 
> 赞同：3
> 
> 时间：2012-11-04T15:05:17.103
> 
> 标签：c, imagemagick

我正在使用 GCC 4.7.2、C89 和 ImageMagick-6.8.0-4。

我正在尝试使用 ImageMagick API 截屏。我已经下载、编译并安装了头文件和库。

但是，我在文档中看不到执行屏幕截图的 API 调用。我将链接并包含标题，以便我可以从我的 C 程序调用 API。我只想要我必须用来执行此操作的函数的名称。

谁能指出我正确的方向？ImageMagick 可以截图吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-06T14:42:25.443

## 使用“x:”特殊文件格式

如果你想要一个不刺激的屏幕抓取；您可以通过将“ **x:root** ”作为源参数传入来调用 ImageMagick 的导入命令`MagickReadImage`。[x: 格式](http://www.imagemagick.org/Usage/files/#x)通过传递`pid`或窗口标签允许完整的屏幕截图或单个窗口。额外的[修饰符](http://www.imagemagick.org/Usage/files/#read_mods)可以捕获区域和分页。

```
#include <wand/MagickWand.h>

int main(int argc, char **argv) 
{
    MagickWandGenesis();
    MagickWand *wand = NULL;
    wand = NewMagickWand();
    MagickReadImage(wand,"x:root"); // <-- Invoke ImportImageCommand
    MagickWriteImage(wand,"screen_shot.png");
    if(wand)wand = DestroyMagickWand(wand);
    MagickWandTerminus();
    return 0;
} 
```

## 使用额外的“魔术”库

`wand`在库之外，`magick/xwindow.h`允许您使用`XImportImage`, `XImportInfo`&`XGetImportInfo`方法导入图像。[您可以在 ImageMagick 的源文件wand/import.c](http://www.imagemagick.org/api/MagickWand/import_8c.html)中检查这些方法是如何工作的。

## 直接使用 X 和像素迭代器

MagickWand 还包括 PixelWand；其中，可以遍历内存中的图像指针。更多的工作，但更大的灵活性。

```
#include <stdio.h>
#include <wand/MagickWand.h>
#include <X11/Xlib.h>

int main(int argc, char **argv) {
    int x,y;
    unsigned long pixel;
    char hex[128];

    // X11 items
    Display *display = XOpenDisplay(NULL);
    Window root = DefaultRootWindow(display);
    XWindowAttributes attr;
    XGetWindowAttributes(display, root, &attr);

    // MagickWand items
    MagickWand *wand = NULL;
    PixelWand *pwand = NULL;
    PixelIterator *pitr = NULL;
    PixelWand **wand_pixels = NULL;

    // Set-up Wand
    MagickWandGenesis();
    pwand = NewPixelWand();
    PixelSetColor(pwand,"white"); // Set default;
    wand = NewMagickWand();
    MagickNewImage(wand,attr.width,attr.height,pwand);
    pitr = NewPixelIterator(wand);

    // Get image from display server
    XImage *image = XGetImage(display,root, 0,0 , 
                                attr.width, attr.height,
                                XAllPlanes(), ZPixmap);

    unsigned long nwands; // May also be size_t

    for (y=0; y < image->height; y++) {
        wand_pixels=PixelGetNextIteratorRow(pitr,&nwands);
            for ( x=0; x < image->width; x++) {
                pixel = XGetPixel(image,x,y);
                sprintf(hex, "#%02x%02x%02x",
                                pixel>>16,           // Red
                                (pixel&0x00ff00)>>8, // Green
                                pixel&0x0000ff       // Blue
                                );
                PixelSetColor(wand_pixels[x],hex);
            }
            (void) PixelSyncIterator(pitr);
    }

    // Write to disk
    MagickWriteImages(wand,"screen_test.png");

    // Clean-Up
    XDestroyImage(image);
    pitr=DestroyPixelIterator(pitr);
    wand=DestroyMagickWand(wand);
    MagickWandTerminus();
    XCloseDisplay(display);
    return 0;
} 
```

## 有帮助的提示

确保 ImageMagick 能够连接到您的显示系统。尝试一些`import`CLI 命令来验证您的本地安装是否正常工作。[这个问题](https://superuser.com/questions/179284/imagemagick-import-command-gives-error-on-windows)就是一个很好的例子。

```
import -display localhost:0.0 -window root test_out.png
import -display ::0 -window root test_out.png
import -display :0.0 -window root test_out.png
import -display :0 -window root test_out.png 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T15:15:16.763

imagemagick 的cli 程序`import`可以像这样运行来截取屏幕截图：

`import -window root screenshot.png`

所以输入图像可以指定为文件或-window root

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T10:14:28.147

1.  类型：import fileName.fileType（例如：import screen.png）
2.  将出现一个十字光标：单击并将其拖动到您要捕获的屏幕部分（确保终端窗口没有覆盖您要捕获的内容）

# php - 当Relation是同一张表中的键时，使用CGridView在Yii中按相关模型搜索和排序

> ID：13219716
> 
> 赞同：0
> 
> 时间：2012-11-04T15:06:06.517
> 
> 标签：php, yii, mysql-error-1066

这里有一篇关于在 CGridView 中按相关模型搜索和排序的综合文章：[http](http://www.yiiframework.com/wiki/281/searching-and-sorting-by-related-model-in-cgridview/) ://www.yiiframework.com/wiki/281/searching-and-sorting-by-related-model-in-cgridview/ 我已经成功多次实施此配方。

但是，现在我正在尝试按同一个表中的关系进行搜索和排序（它定义了 parent_id）。请参阅下面的“父”关系：

```
public function relations()
{
    return array(
        'parent' => array(self::BELONGS_TO, 'Category', 'parent_id'),
        'children' => array(self::HAS_MANY, 'Category', 'parent_id'),
        'childCount' => array(self::STAT, 'Category', 'parent_id'),
        'author0' => array(self::BELONGS_TO, 'User', 'author'),
        'contents' => array(self::MANY_MANY, 'Content', 'content_category(content_id, category_id)'),
        'crsContents' => array(self::MANY_MANY, 'ContentCrs', 'content_category(content_id, category_id)'),
    );
}

public function defaultScope()
{
    return array(
        'alias'=>'cat',
        'order'=>"cat.name ASC",
    );
} 
```

当我实现 wiki 指定的方法时，我收到以下错误：

```
CDbCommand failed to execute the SQL statement: SQLSTATE[42000]: Syntax error or access violation: 1066 Not unique table/alias: 'cat'. The SQL statement executed was: SELECT COUNT(DISTINCT `cat`.`id`) FROM `category` `cat` LEFT OUTER JOIN `category` `cat` ON (`cat`.`parent_id`=`cat`.`id`) WHERE (cat.parent_id <> 257) 
```

如何确保 LEFT OUTER JOIN 使用唯一的表别名，例如`parent`关系，以便我可以正确定义我`CDbCriteria`的 in`search()`

**编辑**：

根据@tereško 的要求，这是我的 search() 函数。我知道它是有缺陷的，因为`parent`我没有定义它时指定的表别名......我只是不知道怎么做！

```
public function search()
{
    $criteria=new CDbCriteria;
    $criteria->with = array('parent');

    $criteria->compare('id',$this->id,true);
    $criteria->compare('author',$this->author,true);
    $criteria->compare('name',$this->name,true);
    $criteria->compare('description',$this->description,true);
    $criteria->compare('parent_id',$this->parent_id,true);
    $criteria->compare('parent.name', $this->parent_search, true );
    $criteria->compare('type',$this->type,true);
    $criteria->compare('slug',$this->slug,true);
    $criteria->compare('created',$this->created,true);
    $criteria->compare('updated',$this->updated,true);

    return new CActiveDataProvider($this, array(
        'criteria'=>$criteria,
            'sort'=>array(
                'attributes'=>array(
                    'parent_search'=>array(
                        'asc'=>'parent.name',
                        'desc'=>'parent.name DESC',
                    ),
                    '*',
                ),
            ),
        )
    );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:05:41.290

您可以为父关系提供别名，如下所示

```
$criteria->with = array(
   'parent'=>array(
      'alias'=>'parent'
    )
); 
```

# apache - Apache反向代理：如何将外部站点中的相对URL重定向回自身？

> ID：13219724
> 
> 赞同：5
> 
> 时间：2012-11-04T15:06:53.610
> 
> 标签：apache, cross-domain, mod-proxy, cross-domain-proxy

我需要绕过跨站点脚本限制，以便在用户单击我在 iframe (external.com/onlyforme) 中加载的外部站点的链接时向他们显示地图。我了解到，最简单的方法是设置反向代理，以便 Apache 在我访问 local.com/external 时检索 external.com/onlyforme，并使其看起来像是来自我的域。

这主要是有效的，但是当 external.com/onlyforme/index.html 尝试访问 external.com/onlyforme/site_media/script.js 时，这会被重定向到 local.com/site_media/script.js，这不是我想要的. 相反，我希望将其重定向到 external.com/onlyforme 中的正确 URL，以便外部站点按预期工作。

我怎样才能做到这一点？

我在我的 httpd.conf 中有这个，在任何其他配置语句之外：

```
ProxyRequests Off
ProxyPass /external/ http://www.external.com/onlyforme
ProxyPassReverse /external/ http://www.external.com/onlyforme 
```

我正在运行 Apache 2.2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T18:56:05.550

您需要在上面添加几个[ProxyHTMLURLMap](http://httpd.apache.org/docs/2.4/mod/mod_proxy_html.html)指令，以检查和重写返回的 HTML 中的任何硬编码 URL，例如

```
ProxyRequests Off
ProxyPass        /external/         http://www.external.com/onlyforme
ProxyHTMLURLMap http://www.external.com/onlyforme     /external

<Location /external/>
  ProxyPassReverse  http://www.external.com/onlyforme
  SetOutputFilter proxy-html
  ProxyHTMLURLMap /            /external/
  ProxyHTMLURLMap /site_media  /external/site_media/
</Location> 
```

另见：[http ://wiki.uniformserver.com/index.php/Reverse_Proxy_Server:_mod_proxy_html](http://wiki.uniformserver.com/index.php/Reverse_Proxy_Server:_mod_proxy_html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-10T00:19:18.573

[arober11](https://stackoverflow.com/users/1443513/arober11)的回答极大地帮助解决了我的类似问题。我试图将其缩小到可能的最短规则集，并且我自己的配置是在[https://my-domain-name.wtf/pad](https://my-domain-name.wtf/pad)上运行[Etherpad](http://etherpad.org)：

```
<Location /pad>
  ProxyPass http://localhost:9001 retry=0
  # retry=0 => avoid 503's when restarting etherpad-lite
  ProxyPassReverse http://localhost:9001
  SetOutputFilter proxy-html
  ProxyHTMLURLMap http://localhost:9001
</Location>
RewriteRule ^/pad$ /pad/ [R] 
```

# ios - 在 SQLite3 中插入 多行

> ID：13219726
> 
> 赞同：2
> 
> 时间：2012-11-04T15:07:22.927
> 
> 标签：ios, xcode, sqlite

我如何以编程方式将几行插入到 iOS 的 sqlite3 表中？这是我当前方法的代码片段：

```
sqlite3 *database;

if(sqlite3_open([filePath UTF8String], &database) == SQLITE_OK) {
    const char *sqlStatement = "insert into TestTable (id, colorId) VALUES (?, ?)";
    sqlite3_stmt *compiledStatement;

    if(sqlite3_prepare_v2(database, sqlStatement, -1, &compiledStatement, NULL) == SQLITE_OK)
    {
        for (int i = 0; i < colorsArray.count; i++) {
            sqlite3_bind_int(compiledStatement, 1, elementId);
            long element = [[colorsArray objectAtIndex:i] longValue];
            sqlite3_bind_int64(compiledStatement, 2, element);
        }
    }

    if(sqlite3_step(compiledStatement) == SQLITE_DONE) {
        sqlite3_finalize(compiledStatement);
    }
    else {
        NSLog(@"%d",sqlite3_step(compiledStatement));
    }
}
sqlite3_close(database); 
```

这样我只插入了第一行，我如何告诉 sqlite 我希望每个“for”循环都是一个行插入？我找不到任何这样的例子......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:19:01.953

您必须运行此语句：

```
sqlite3_step(compiledStatement) == SQLITE_DONE 
```

每次插入后，在您的代码中，我看到您最后只运行一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:40:03.133

我得到了它的工作，这现在是我的代码：

```
sqlite3 *database;

if(sqlite3_open([filePath UTF8String], &database) == SQLITE_OK) {
    const char *sqlStatement = "insert into TestTable (id, colorId) VALUES (?, ?)";
    sqlite3_stmt *compiledStatement;

    if(sqlite3_prepare_v2(database, sqlStatement, -1, &compiledStatement, NULL) == SQLITE_OK)
    {
        for (int i = 0; i < colorsArray.count; i++) {
            sqlite3_bind_int(compiledStatement, 1, elementId);
            long element = [[colorsArray objectAtIndex:i] longValue];
            sqlite3_bind_int64(compiledStatement, 2, element);

            if (sqlite3_step(compiledStatement) == SQLITE_DONE) {
                if (i == (colorsArray.count - 1))
                    sqlite3_finalize(compiledStatement);
                else
                    sqlite3_reset(compiledStatement);
            }
            else {
                NSLog(@"row insertion error");
            }
        }
    }
}
sqlite3_close(database); 
```

# css-transitions - CSS3 过渡弄乱了布局？

> ID：13219729
> 
> 赞同：2
> 
> 时间：2012-11-04T15:07:47.963
> 
> 标签：css-transitions

所以我试图与 CSS3 达成协议，并认为我会从过渡开始，因为它会给我的布局带来很好的效果，我使用了代码；

```
<!DOCTYPE html>
<html>
<head>
<style>

div
{
width:40px;
height:60px;
opacity:0.4;
background:black;
transition:all 2s;
-moz-transition:all 2s; /* Firefox 4 */
-webkit-transition:all 2s; /* Safari and Chrome */
-o-transition:all 2s; /* Opera */
}

div:hover
{
width:90px;
opacity:0.9;
}
</style>
</head>
<body>
<br>
<u><b><center>TEST</center></b></u>

<div></div>

</body>
</html>
<br> 
```

每当我使用该代码时，布局就会完全混乱，让我几乎一无所有，只是所有的东西都是过渡和错误的位置。任何人都可以发现编码有什么问题吗？

[编辑] 这就是发生的事情 - [http://testingforsite.weebly.com/](http://testingforsite.weebly.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:52:00.303

给你的 div 一个 id 会有所帮助。因为如果你这样写，CSS 会改变你网站上的所有 div。

HTML：

```
<div id="div-of-transition"></div> 
```

CSS：

```
#div-of-transition{
   transition:all 2s;
   -moz-transition:all 2s; /* Firefox 4 */
   -webkit-transition:all 2s; /* Safari and Chrome */
   -o-transition:all 2s; /* Opera */ 
```

这只会更改您命名的 div`div-of-transition`

# javascript - 如何在 data_bind = "checked" 绑定中运行 javascript 函数

> ID：13219734
> 
> 赞同：0
> 
> 时间：2012-11-04T15:08:09.867
> 
> 标签：javascript, knockout.js

我有带有 data_bind = "checked" 绑定的单选按钮。当检查一个Radiobuttons时，我需要调用自定义功能来自定义UI。html

每日 每周 每月

```
<div data-bind="visible: FrequencyType() == 1">
    Message 1
</div>
<div data-bind="visible: FrequencyType() == 2">
    Message 2
</div>
<div data-bind="visible: FrequencyType() == 3">
    //Before show html here I want to call js function
</div> 
```

js

```
 function AppViewModel() {
    this.FrequencyType = ko.observable("0");    
}

$(document).ready(function () {
    viewModel = new AppViewModel();

    // Activates knockout.js
    ko.applyBindings(viewModel);   
}); 
```

[jsfiddler](http://jsfiddle.net/TuBzb/2/) 我怎么能用淘汰赛做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:26:41.690

最简单的方法是在`FrequencyType`.

[http://jsfiddle.net/jearles/TuBzb/1/](http://jsfiddle.net/jearles/TuBzb/1/)

```
this.FrequencyType.subscribe(function(newValue) {
    if (newValue == 3) {
        alert('3 is clicked');
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:30:01.693

我不确定这是否是您的问题，但您提供的 jsFiddle 示例不起作用，因为找不到链接的敲除库。这是 knockoutjs 的 CDN 链接，我[在此处更新了您的小提琴](http://jsfiddle.net/TuBzb/2/)

```
http://cdnjs.cloudflare.com/ajax/libs/knockout/1.2.1/knockout-min.js 
```

为了根据值运行 javascript 函数，请订阅 ko.observable，如此[处所述](http://knockoutjs.com/documentation/observables.html)

# java - Java 错误“不能从静态上下文引用非静态变量”

> ID：13219745
> 
> 赞同：-3
> 
> 时间：2012-11-04T15:09:51.790
> 
> 标签：java, networking, static, static-methods

> **可能重复：**
> [java：无法从静态上下文错误中引用非静态变量](https://stackoverflow.com/questions/926822/java-non-static-variable-cannot-be-referenced-from-a-static-context-error)

我的目标是为客户端服务器聊天创建一个程序。我为服务器编写了以下代码[https://github.com/jinujd/Java-networking/blob/master/Server.java](https://github.com/jinujd/Java-networking/blob/master/Server.java) 。编译后出现以下错误.

> 非静态变量 this 不能从静态上下文中引用。那里有什么问题？我的另一个疑问是

```
/*A.java*/
class A {
    String a;
    class B {
    }
    public static void main() {
    }
} 
```

B 和 main() 可以访问变量 a 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:11:21.190

`Static functions/variables`与类定义本身相关联，而类`non-static`变量`class instance`（

`Static functions/variables`可以在没有类实例的情况下使用：

```
 A.main(); 
```

在访问`non-static`函数/变量时，**您需要先创建对象实例**：

```
 A a = new A();
        a.getA(); 
```

由于`static`范围在层次结构中（在定义级别），并且它没有实例级别方法/变量的可见性，因此会抱怨。**但相反是可以的，即您应该能够从非静态方法访问静态方法/变量。**

解释了原因后，我相信您将能够自己更正类/方法/变量的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:12:43.473

你需要

```
static class ClientReceiver extends Thread { 
```

不是

```
class ClientReceiver extends Thread { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T15:13:08.900

`non-static variable this cannot be referenced from a static context. What is the problem there?`

您需要一个类的实例来从静态上下文访问非静态数据。

```
 public class Sample {
     String var="nonstatic variable";
    public static void main(String...args){
      Sample s= new sample();
      system.out.println(s.var);

}

} 
```

您的 B 类可以直接访问您的字符串 a，但您的静态 main 方法需要 A 类的实例才能访问它。

# javascript - 如何在照片之间制作滑动的东西？

> ID：13219748
> 
> 赞同：0
> 
> 时间：2012-11-04T15:09:55.393
> 
> 标签：javascript, jquery

在此处查看文章中照片中的效果：

[http://www.popsci.com/science/article/2012-11/and-after-images-show-hurricane-sandys-devastation](http://www.popsci.com/science/article/2012-11/and-after-images-show-hurricane-sandys-devastation)

有谁知道这是怎么做到的？我想我可以在一个固定框架内制作两个宽度可调的框架，但是手柄呢？当鼠标悬停时，框架线和手柄变亮和放大的方式？可以肯定的是，悬停事件，但是什么样的悬停事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:14:29.087

这很简单。你有 2 `DIV`s 与 2 个不同的图像（如`background-image`在 css 中）相互重叠（例如绝对定位。）（也许是上面的“之前”图片）然后你有一个滑块，当拖动它时会减小重叠`DIV`的宽度，使底层DIV秀！此功能可以在名为“Before/After”的 jQuery 插件中找到

链接：[jQuery之前/之后](http://www.catchmyfame.com/2009/06/25/jquery-beforeafter-plugin/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:28:09.327

您当然可以编写自己的不依赖于 jQuery UI 的代码。

```
;(function($){
    $.fn.slidingThingamajig = function () {

        return this.each(function(){

            var $this = $(this);

            $this.find('.handle')
                 .css({cursor:'ew-resize'}) // Here's your fancy cursor with directional arrows
                 .on('mousedown', function(e) {
                     $this.addClass('resizable');

                     $this.parents().on('mousemove', function (e) {
                         $('.resizable').css({width:e.pageX - $('.resizable').offset().left});
                     }).on('mouseup', function(e) {
                         $('.resizable').removeClass('resizable');
                 });
                e.preventDefault();
            });
        });
    }
})(jQuery); 
```

你可能需要稍微调整一下，但它大部分都在那里。

# assembly - 汇编中的两条线放在一起没有任何意义

> ID：13219752
> 
> 赞同：0
> 
> 时间：2012-11-04T15:10:13.310
> 
> 标签：assembly

我必须通读一些随机生成的程序集并输入一些正确的输入才能到达最后，而无需调用 explode_bomb 函数。问题是有两条线似乎直接相互矛盾，我担心我的分配实际上可能由于随机生成而不可能。

这是完整的代码：

```
 08048d1b <phase_2>:
 8048d1b:       55                      push   %ebp
 8048d1c:       89 e5                   mov    %esp,%ebp
 8048d1e:       56                      push   %esi
 8048d1f:       53                      push   %ebx
 8048d20:       83 ec 30                sub    $0x30,%esp
 8048d23:       8d 45 e0                lea    0xffffffe0(%ebp),%eax
 8048d26:       89 44 24 04             mov    %eax,0x4(%esp)
 8048d2a:       8b 45 08                mov    0x8(%ebp),%eax
 8048d2d:       89 04 24                mov    %eax,(%esp)
 8048d30:       e8 42 04 00 00          call   8049177 <read_six_numbers>
 8048d35:       83 7d e0 00             cmpl   $0x0,0xffffffe0(%ebp)
 8048d39:       79 05                   jns    8048d40 <phase_2+0x25>
 8048d3b:       e8 f5 03 00 00          call   8049135 <explode_bomb>
 8048d40:       bb 01 00 00 00          mov    $0x1,%ebx
 8048d45:       8d 75 e0                lea    0xffffffe0(%ebp),%esi
 8048d48:       89 d8                   mov    %ebx,%eax
 8048d4a:       03 44 9e fc             add    0xfffffffc(%esi,%ebx,4),%eax
 8048d4e:       39 04 9e                cmp    %eax,(%esi,%ebx,4)
 8048d51:       74 05                   je     8048d58 <phase_2+0x3d>
 8048d53:       e8 dd 03 00 00          call   8049135 <explode_bomb>
 8048d58:       83 c3 01                add    $0x1,%ebx
 8048d5b:       83 fb 06                cmp    $0x6,%ebx
 8048d5e:       75 e8                   jne    8048d48 <phase_2+0x2d>
 8048d60:       83 c4 30                add    $0x30,%esp
 8048d63:       5b                      pop    %ebx
 8048d64:       5e                      pop    %esi
 8048d65:       5d                      pop    %ebp
 8048d66:       c3                      ret 
```

有问题的线路是 8048d4a 和 8048d4e。因为这是 2 的恭维，第一个数字是 -4，第二个数字是我的第一个输入（这甚至会更改为我的第二个和第三个吗？），第三个将是我们循环的任何迭代开，第四个也一样。

现在以直接顺序比较这些值基本上意味着我正在将一个数字与其自身进行比较 - 4，对吗？我怎么可能成功地通过那个测试？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:17:51.790

我的 AT&T 语法不是最好的，但它似乎在做：

```
ADD EAX,[ESI + EBX * 4 - 4]
CMP EAX,[ESI + EBX * 4] 
```

又名，它将前一个计数器和某个计数器的总和与当前条目进行比较。请参阅[this](http://www.imada.sdu.dk/Courses/DM18/Litteratur/IntelnATT.htm)以供参考，特别是：

```
Example:
Intel Syntax
instr   foo,segreg:[base+index*scale+disp]
mov     eax,[ebx+20h]
add     eax,[ebx+ecx*2h
lea     eax,[ebx+ecx]
sub     eax,[ebx+ecx*4h-20h]
AT&T Syntax
instr   %segreg:disp(base,index,scale),foo
movl    0x20(%ebx),%eax
addl    (%ebx,%ecx,0x2),%eax
leal    (%ebx,%ecx),%eax
subl    -0x20(%ebx,%ecx,0x4),%eax 
```

至于为什么这样做，它似乎是一种优化以避免寄存器溢出或递减数组索引然后递增它的替代方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:29:18.717

```
mov    $0x1,%ebx                        ; i = 1
lea    0xffffffe0(%ebp),%esi            ; ESI = address of array of 6 numbers
mov    %ebx,%eax                        
add    0xfffffffc(%esi,%ebx,4),%eax     ; add to element
cmp    %eax,(%esi,%ebx,4)

add    0xfffffffc(%esi,%ebx,4),%eax 
```

上面的指令是访问数组的元素。这在 x86 中称为**SIB**寻址，用于 Scale、Index、Base。还有一个 Offset 组件。该数组基于由基址寄存器（`EBX`此处）加上偏移量（此处为-4）确定的地址。元素编号位于索引寄存器（`ESI`此处）。每个元素的大小由 Scale（此处为 4）确定。

```
lea    0xffffffe0(%ebp),%esi            ; ESI = address of array of 6 numbers 
```

如果你再往上看，你会看到数组的地址是如何移动到`%ESI`. 数组是一个局部变量，位于帧指针下方 32 个字节（当使用帧指针时，包括数组在内的局部变量被寻址为相对于帧指针的偏移量）

```
add    0xfffffffc(%esi,%ebx,4),%eax 
```

因此，该指令访问一个“虚拟”数组，该数组在实际数组之前 4 个字节开始。这是因为循环索引从 1 开始，但访问的元素是 0，所以使用“虚拟数组”一切都到位。

```
mov    $0x1,%ebx                        ; i = 1
lea    0xffffffe0(%ebp),%esi            ; ESI = address of array of 6 numbers
mov    %ebx,%eax                        
add    0xfffffffc(%esi,%ebx,4),%eax     ; add to element i-1
cmp    %eax,(%esi,%ebx,4)               ; compare against element i 
```

# algorithm - 建立一个特定的左派树？

> ID：13219753
> 
> 赞同：1
> 
> 时间：2012-11-04T15:10:15.727
> 
> 标签：algorithm, tree, insertion

我在练习左派树，在教科书上看到了一个最小高度偏左派树的例子：

```
 2
      /   \
     7    50
    /    /
   11   80
  /
13 
```

问题是，我可以只使用插入来构建这个例子吗？

我尝试了以下插入顺序：

```
2  7  11  13  50  80 
```

结果是这个：

```
 2
    /   \
  11     7
 /  \   /
13  50 80 
```

那么我该如何实现呢？如果不可能，为什么？
此外，在允许其他操作的情况下，是否可以构建教科书上的示例树？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T00:32:35.973

我想到了！以下顺序很好：

```
13  11  7  2  50  80 
```

这个想法是当序列下降时树会变得不平衡。例如，

```
4  3  2  1 
```

建立一个不平衡的树

```
 1
     /
    2
   /
  3
 /
4 
```

# web-services - SOA 服务组合如何在代码级别工作？

> ID：13219759
> 
> 赞同：0
> 
> 时间：2012-11-04T15:10:48.990
> 
> 标签：web-services, soa

服务组合是 SOA 的基本组成部分。服务清单提供的所有功能都有望在必要时利用该清单中的其他服务，以构建它们从较小的组件部分完成的任务。不过，这一切都来自架构级别：这种组合是如何在实现级别发生的？

考虑这种情况。我有一个“任务服务”，它涉及发布一个`/process-request`资源，该资源将管理异步处理大文件以生成“真实”资源所涉及的其他资源。我们将最终的“真实”资源称为 PartsInventory。因此，您向服务提供了 PartsInventory 的 URL 和名称`/process-request`，然后该服务创建 PartsInventory“占位符”并启动异步 ETL，将 URL 中的大量 csv 文件转换为真实的 PartsInventory。如果此异步作业失败，它将删除占位符，并且对`/process-request`服务的查询将反映失败。如果成功了，`/process-request`

现在， 从代码的角度来看，*PartsInventory*`/process-request`和 PartsInventory之间的交互实现如何？我是在向已发布的 服务发送请求，还是在调用 ORM 对象来创建占位符？如果是前者，我将遵守已发布的合同，并且表现得像我自己的服务的消费者，这似乎符合可组合性原则——但在同一个代码库中以这种方式进行交互感觉真的很尴尬。另一方面，后者假定处理程序将知道如何自行创建 PartsInventory 占位符，这本身就很尴尬。第三个选项是在 PartsInventory 对象上创建一个专门的静态工厂方法，称为类似的东西，以便 *`/parts-inventory``/process-request``PartsInventory.create_placeholder()``/process-request`代码至少不知道 PartsInventory 对象的构造函数依赖项。不过，这仍然将创建分为两个位置。*

 *你遇到过这种情况吗？这个问题有规范的“正确答案”吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T17:39:32.903

您应该区分服务端点（在您的情况下是由各种服务公开的 url）和服务。服务基本上是具有明确定义的边界的组件，这些边界暴露了一个或多个端点，它们在其中交付合同（由消息组成）。

在服务内进行的调用不必通过服务接口调用跨服务边界的调用必须通过服务接口。

您的问题是流程请求和 PartsInventory 是否是同一服务的不同方面。我无法从您的服务中的详细信息中了解它们是否存在，但如果它们作为不同的服务真的有意义，您应该通过服务接口。*

# c# - 如何获取活动目录用户的“ntSecurityDescriptor”对象

> ID：13219760
> 
> 赞同：0
> 
> 时间：2012-11-04T15:11:03.387
> 
> 标签：c#, asp.net, openldap

我正在做一个网站。我必须找到用户的值不能更改用户的密码属性。我得到这个链接 http://msdn.microsoft.com/en-us/library/aa746448(v=vs.85).aspx[^] 根据它我必须找到那个用户的“ntSecurityDescriptor”值。他们正在使用 DirectoryEntry 类来查找，但在我的情况下，我使用的是 LdapConnection 类。如果我使用入口类，我将无法与服务器建立连接，因此我将其更改为 LdapConnection 类。现在我不知道如何找到价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T06:42:19.280

我找到了我的解决方案。

```
 SearchResponse response = (SearchResponse)connection.SendRequest(request);
            DirectoryAttribute attribute = response.Entries[0].Attributes["ntSecurityDescriptor"];

            if (attribute != null)
            {
                const string PASSWORD_GUID = "{ab721a53-1e2f-11d0-9819-00aa0040529b}";
                const int ADS_ACETYPE_ACCESS_DENIED_OBJECT = 6;
                bool fEveryone = false;
                bool fSelf = false;

                ActiveDs.ADsSecurityUtility secUtility = new ActiveDs.ADsSecurityUtility();
                ActiveDs.IADsSecurityDescriptor sd = (IADsSecurityDescriptor)secUtility.ConvertSecurityDescriptor((byte[])attribute[0], (int)ADS_SD_FORMAT_ENUM.ADS_SD_FORMAT_RAW, (int)ADS_SD_FORMAT_ENUM.ADS_SD_FORMAT_IID);
                ActiveDs.IADsAccessControlList acl = (ActiveDs.IADsAccessControlList)sd.DiscretionaryAcl;

                foreach (ActiveDs.IADsAccessControlEntry ace in acl)
                {
                    if ((ace.ObjectType != null) && (ace.ObjectType.ToUpper() == PASSWORD_GUID.ToUpper()))
                    {
                        if ((ace.Trustee == "Everyone") && (ace.AceType == ADS_ACETYPE_ACCESS_DENIED_OBJECT))
                        {
                            fEveryone = true;
                        }
                        if ((ace.Trustee == @"NT AUTHORITY\SELF") && (ace.AceType == ADS_ACETYPE_ACCESS_DENIED_OBJECT))
                        {
                            fSelf = true;
                        }

                        break;
                    }
                }

                if (fEveryone || fSelf)
                {
                    return Global.RequestContants.CANT_CHANGE_PASSWORD;
                }
                else
                {
                    return string.Empty;
                }
            } 
```

# f# - 将电子邮件附件转换为 base64

> ID：13219761
> 
> 赞同：0
> 
> 时间：2012-11-04T15:11:04.490
> 
> 标签：f#, stream, base64, bytearray, c#-to-f#

我想从电子邮件中获取附件并将​​其转换为 base64 字符串，以便可以将其存储为 JSON。

在 C# 中，我将附件作为`System.IO.Stream`.，将其读入字节数组，然后使用`Convert.ToBase64String`.

不过，在 F# 中，我不知道该怎么做（我是初学者），感觉可能有一种更实用的做事方式......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:37:40.443

F# 将函数式风格与面向对象风格相结合，让您可以轻松地从 F# 调用 .NET 库。有时，有一些特定于 F# 的库可以为某些任务（如列表处理）提供更多功能样式，但我认为 base64 编码和流没有类似的东西。

因此，给定一个流，您可以将其读入缓冲区，然后使用 .NET 类型转换为 base64，如下所示：

```
open System
open System.IO

let stream = // Some stream, for example: new MemoryStream([| 1uy; 2uy; 3uy; 4uy |])
let buffer = Array.zeroCreate (int stream.Length)
stream.Read(buffer, 0, buffer.Length)
Convert.ToBase64String(buffer) 
```

# jquery - jquery 执行追加/前置但在中间，如 midpend，或指定挂起位置？

> ID：13219763
> 
> 赞同：5
> 
> 时间：2012-11-04T15:11:13.557
> 
> 标签：jquery

[http://jsfiddle.net/motocomdigital/6DeAC/](http://jsfiddle.net/motocomdigital/6DeAC/)

我喜欢在 div 上添加一些标记。但我需要 pend 出现在我的 div 的子元素之间。这可能吗？

请看我下面的例子。

```
<div class="bx-wrapper">

    <div class="bx-window">window</div>

    <a href="" class="bx-prev">prev</a>
    <a href="" class="bx-next">next</a>

</div> 
```

所以我需要挂起的 div 出现在这里...

```
<div class="bx-wrapper">

    <div class="bx-window">window</div>

    <div id="pendHere">pend</div>

    <a href="" class="bx-prev">prev</a>
    <a href="" class="bx-next">next</a>

</div> 
```

任何人都可以帮我解决这个问题，将不胜感激。

在这里看小提琴...... [http://jsfiddle.net/motocomdigital/6DeAC/](http://jsfiddle.net/motocomdigital/6DeAC/)

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-04T15:13:31.607

```
$('<div id="pendHere">pend</div>').insertAfter('.bx-wrapper .bx-window'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:30:10.643

像这样尝试 $(pend_element).after('element#id or element.class[n]') ：

```
var elementToPendAfter = $('selector'); 
```

如果要挂起的元素具有类名以缩短 css 声明的数量或重用单个声明并消除不必要的 css 选择器，jQuery 将返回一个文字对象数组或元素的集合，其中包含元素的 className。反过来，您可以通过调用包含 className 选择器及其在集合中的位置的变量来挑选出任何元素，如下所示：

```
var specificElement = $(elementToPendAfter[2]); // is the third $(element.class)

var pendElement = $(element#id or element.class[n]);
pendElement.after(specificElement);// one line no hassle :) 
```

这是 jQuery api： [jQuery 的 after() API](http://api.jquery.com/after/)

确保在元素被挂起后检查您的浏览器开发人员工具中的 HTML，以查看它是否在正确的位置。

# c# - C# 在接口及其实现类中使用泛型

> ID：13219770
> 
> 赞同：3
> 
> 时间：2012-11-04T15:11:53.873
> 
> 标签：c#, generics, interface

我想创建一个适用于所有 IComparable 类型的接口。例如

```
public interface SortAlgorithm<T> where T : System.IComparable<T>
{
    List<T> Sort(List<T> input);
} 
```

而且我希望它的实现者也是通用的，并且具有我在接口中提供的相同规范。就像下面的例子

```
public class InsertionSort<T> : SortAlgorithm<T> 
```

这是我这样做的目的。我希望我的所有排序算法都适用于实现 IComparable 接口的所有类型。并且想在接口中提供一次 T 是 IComparable 的子类的规范。但是当我这样做时，我收到以下错误。

错误 1 ​​类型“T”不能用作泛型类型或方法“Algorithms.SortingAlgorithm.SortAlgorithm”中的类型参数“T”。没有从“T”到“System.IComparable”的装箱转换或类型参数转换。

我不明白这是为什么。我可以实现一个通用接口并使其实现类也通用，但是在接口中给出规范时我不能做同样的事情（其中 T：System.IComparable）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T15:15:33.890

所有派生的泛型类也必须实现泛型约束。

因此，您应该将类​​声明为：

```
public class InsertionSort<T> : SortAlgorithm<T> where T : System.IComparable<T> 
```

错误基本上说的是泛型参数`T`（此时可以是任何类或结构）不能保证实现`IComparable<T>`，因为受基类（`SortAlgorithm`接口）的约束。

您也可以通过在类上指定约束来提供此保证`InsertionSort`，如上所示。

# regex - 正则表达式 preg_split()

> ID：13219771
> 
> 赞同：2
> 
> 时间：2012-11-04T15:11:55.903
> 
> 标签：regex

我有一个充满字符串的数组，其中可能包含一个或多个下划线、破折号和句点。我想将其拆分为由下划线、破折号和句点分隔的字符。到目前为止，我在下划线和破折号方面取得了成功，但在句点方面却没有。

这有效：

```
$family02 = preg_split('/_|-/', $row['family'], -1, PREG_SPLIT_NO_EMPTY); 
```

当我尝试...

```
'/_|-./'
'/_|-\./'
'/_|-|./' 
```

...或以不同的方式对分隔符进行排序，我会在 3 个中的 1 个或 3 个中的 2 个或空数组上进行拆分。

感谢您提供任何帮助或良好的正则表达式链接。

路

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:17:22.477

只需使用

```
preg_split('/[-_.]/', $str) 
```

这意味着您正在拆分`-`, `_`,`.`

如果要删除字符串中的空组，请使用

```
preg_split('/[-_.]+/', $str) 
```

所以多个确定器作为一个应用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:15:30.570

你应该使用：

```
// [_.-] stands for a character of underscore or dash or period.
$family02 = preg_split('/[_.-]/', $row['family'], -1, PREG_SPLIT_NO_EMPTY); 
```

# joomla - J2.5中如何设置组件参数？

> ID：13219774
> 
> 赞同：3
> 
> 时间：2012-11-04T15:12:14.350
> 
> 标签：joomla, joomla2.5

我使用组件的管理文件夹中的 config.xml 创建了一个带有一些配置字段的 J2.5 组件。

如何以编程方式在配置中设置参数？

我已经尝试了下面的代码，但它显然没有将结果保存到数据库：

```
$params = & JComponentHelper::getParams('com_mycomponent');
$params->set('myvar', $the_value); 
```

谁能展示一些如何实现这一目标的例子？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T18:21:55.143

最安全的方法是包含`com_config/models/component.php`并使用它来验证和保存参数。但是，如果您可以以某种方式自己验证数据参数，我会坚持以下（更简单的解决方案）：

```
// Get the params and set the new values
$params = JComponentHelper::getParams('com_mycomponent');
$params->set('myvar', $the_value);

// Get a new database query instance
$db = JFactory::getDBO();
$query = $db->getQuery(true);

// Build the query
$query->update('#__extensions AS a');
$query->set('a.params = ' . $db->quote((string)$params));
$query->where('a.element = "com_mycomponent"');

// Execute the query
$db->setQuery($query);
$db->query(); 
```

请注意我如何将参数转换为字符串（在构建查询时），它将 JRegistry 对象转换为 JSON 格式的字符串。

如果遇到任何缓存问题，您可能希望在编辑参数后运行以下命令：

从模型：

```
 $this->cleanCache('_system'); 
```

或者，其他地方：

```
$conf = JFactory::getConfig();

$options = array(
    'defaultgroup' => '_system',
    'cachebase' => $conf->get('cache_path', JPATH_SITE . '/cache')
);

$cache = JCache::getInstance('callback', $options);
$cache->clean(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-10T15:32:15.743

解决方案在这里...

[http://www.webtechriser.com/tutorials/82-joomla-3-0/86-how-to-save-component-parameters-to-database-programmatically](http://www.webtechriser.com/tutorials/82-joomla-3-0/86-how-to-save-component-parameters-to-database-programmatically)

您可以在 Joomla 2.5+ 中替换

```
// check for error
if (!$table->check()) {
    $this->setError('lastcreatedate: check: ' . $table->getError());
    return false;
}
if (!$table->store()) {
    $this->setError('lastcreatedate: store: ' . $table->getError());
    return false;
} 
```

和

```
if (!$table->save()) {
    $this->setError('Save Error: ' . $table->getError());
    return false;
} 
```

# java - 读取具有不同名称但类型相同的元素列表

> ID：13219778
> 
> 赞同：1
> 
> 时间：2012-11-04T15:12:32.683
> 
> 标签：java, xml, jaxb

我正在尝试将 JAXB 注释添加到一个类中，以便解组看起来类似于此的 XML（注意我不需要将 java bean 编组为 XML ......）：

```
 <fixture_statistics id="3812596">
      <home_team_stats id="2">
        <id>2</id>
        <tackles>58</tackles>
        <possession>1868</possession>
        <territory>2603</territory>
        <minutes_in_22>1316</minutes_in_22>
        ...
      </home_team_stats>
      <guest_team_stats id="21061">
        <id>21061</id>
        <tackles>20</tackles>
        <possession>3114</possession>
        <territory>2379</territory>
        <minutes_in_22>1171</minutes_in_22>
        ...
      </guest_team_stats>
      <home_player_1 id="2306143" teamid="2">
        <id>2306143</id>
        <tackles>3</tackles>
        <metres_gained>38</metres_gained>
        ...
      </home_player_1>
      <home_player_1 id="2306143" teamid="2">
        <id>2306143</id>
        <tackles>3</tackles>
        <metres_gained>38</metres_gained>
        ...
      </home_player_1>
      <home_player_1 id="2306143" teamid="2">
        <id>2306143</id>
        <tackles>3</tackles>
        <metres_gained>38</metres_gained>
        ...
      </home_player_1>
      ...
      <guest_player_1 id="2306143" teamid="2">
        <id>2306143</id>
        <tackles>3</tackles>
        <metres_gained>38</metres_gained>
        ...
      </guest_player_1>
      <guest_player_2 id="2306143" teamid="2">
        <id>2306143</id>
        <tackles>3</tackles>
        <metres_gained>38</metres_gained>
        ...
      </guest_player_2>
      <guest_player_3 id="2306143" teamid="2">
        <id>2306143</id>
        <tackles>3</tackles>
        <metres_gained>38</metres_gained>
        ...
      </guest_player_3>
      ...
</fixture_statistics> 
```

* 请注意，当我为这个问题复制和粘贴时，请忽略一些元素值...

我已经设法将“fixture_statistics”、“home_team_stats”和“guest_team_stats”元素映射到它们各自的类，并且我能够正确解组这些元素，但我遇到了“home_player_n”和“guest_player_n”元素的问题. 我创建了一个包含在这些元素中找到的属性的类，但我不知道如何处理元素具有不同名称的事实 - “home_player_1”到“home_player_22”，对于来宾玩家也是如此。

这是我的夹具统计类的示例，以及我的夹具玩家统计类，以便有人可以指出我哪里出错了......

```
@XmlRootElement(name = "fixture_statistics")
@XmlAccessorType(XmlAccessType.FIELD)
public class FixtureStatistics {

    private Collection<FixturePlayerStatistics> homeTeamPlayerStatistics = new ArrayList<>();

    private Collection<FixturePlayerStatistics> guestTeamPlayerStatistics = new ArrayList<>();
}

@XmlAccessorType(XmlAccessType.FIELD)
public class FixturePlayerStatistics {
    @XmlElement(name="id")
    private Long playerId;
    private Integer tackles;
    @XmlElement(name="metres_gained")
    private Integer metresGained;
} 
```

在 FixturePlayerStatistics 类上，我无法添加 XMlRootElement 注释，因为该元素可能是 44 个字符串中的 1 个，而且我还暂时从 FixtureStatistics 类的集合中删除了任何注释，因为我真的不确定那里有什么。我尝试使用@XmlElementRef，指定所有可能的元素名称，但这对我来说还没有用，XML 也无法更改，而且我没有可使用的架构，只有 API 调用生成的 XML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:35:40.237

有一些不同的选项可以支持此用例。但总的来说，我建议避免将索引用于元素名称的情况。

**选项 #1 - 单独的字段/属性**

处理此用例的一种方法是为 22 名客人和 22 名主场球员中的每一个拥有一个单独的字段/属性。

```
package forum13219778;

import javax.xml.bind.annotation.*;

@XmlRootElement(name = "fixture_statistics")
@XmlAccessorType(XmlAccessType.FIELD)
public class FixtureStatistics {

    FixturePlayerStatistics guest_player_1;
    FixturePlayerStatistics guest_player_2;
    FixturePlayerStatistics guest_player_3;
    ...
    FixturePlayerStatistics guest_player_22;

    FixturePlayerStatistics home_player_1;
    FixturePlayerStatistics home_player_2;
    FixturePlayerStatistics home_player_3;
    ...
    FixturePlayerStatistics home_player_22;     
} 
```

* * *

**选项 #2 - 使用 SAX`XMLFilter`去除 _# 后缀**

如果您的用例只处理解组，那么您可以使用 SAX`XMLFilter`去除每个元素上的唯一后缀，并在您的 JAXB 注释中简单地映射到`home_player`和`guest_player`. 有关`XMLFilter`示例，请参见：

*   [如何使 JAXB 解组器忽略前缀？](https://stackoverflow.com/questions/11968399/how-to-make-jaxb-unmarshaller-to-ignore-prefixes/11970622#11970622)

* * *

**选项 #3 - 使用`@XmlElementRefs`和`ObjectFactory`**

***夹具统计***

要使用`@XmlElementRefs`/`@XmlElementRef`注释，您需要更改您的集合以保存`JAXBElement<FixturePlayerStatistics>`. 将`JAXBElement`用于保存元素名称信息。

```
package forum13219778;

import java.util.*;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;

@XmlRootElement(name = "fixture_statistics")
@XmlAccessorType(XmlAccessType.FIELD)
public class FixtureStatistics {

    @XmlElementRefs({ 
        @XmlElementRef(name="home_player_1"),
        @XmlElementRef(name="home_player_2"),
        @XmlElementRef(name="home_player_3")
    })
    private Collection<JAXBElement<FixturePlayerStatistics>> homeTeamPlayerStatistics = new ArrayList<>();

    @XmlElementRefs({ 
        @XmlElementRef(name="guest_player_1"),
        @XmlElementRef(name="guest_player_2"),
        @XmlElementRef(name="guest_player_3")
    })
    private Collection<JAXBElement<FixturePlayerStatistics>> guestTeamPlayerStatistics = new ArrayList<>();

} 
```

***对象工厂***

结合`@XmlElementRef`您需要使用`@XmlElementDecl`注释声明根元素。这是通过用 注释的对象工厂类完成的`@XmlRegistry`。

```
package forum13219778;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;
import javax.xml.namespace.QName;

@XmlRegistry
public class ObjectFactory {

    @XmlElementDecl(name = "home_player_1")
    public JAXBElement<FixturePlayerStatistics> createHomePlayer1(FixturePlayerStatistics player) {
        return new JAXBElement<FixturePlayerStatistics>(new QName("home_player_1"), FixturePlayerStatistics.class, player);
    }

    @XmlElementDecl(name = "home_player_2")
    public JAXBElement<FixturePlayerStatistics> createHomePlayer2(FixturePlayerStatistics player) {
        return new JAXBElement<FixturePlayerStatistics>(new QName("home_player_2"), FixturePlayerStatistics.class, player);
    }

    @XmlElementDecl(name = "home_player_3")
    public JAXBElement<FixturePlayerStatistics> createHomePlayer3(FixturePlayerStatistics player) {
        return new JAXBElement<FixturePlayerStatistics>(new QName("home_player_3"), FixturePlayerStatistics.class, player);
    }

    @XmlElementDecl(name = "guest_player_1")
    public JAXBElement<FixturePlayerStatistics> createGuestPlayer1(FixturePlayerStatistics player) {
        return new JAXBElement<FixturePlayerStatistics>(new QName("guest_player_1"), FixturePlayerStatistics.class, player);
    }

    @XmlElementDecl(name = "guest_player_2")
    public JAXBElement<FixturePlayerStatistics> createGuestPlayer2(FixturePlayerStatistics player) {
        return new JAXBElement<FixturePlayerStatistics>(new QName("guest_player_2"), FixturePlayerStatistics.class, player);
    }

    @XmlElementDecl(name = "guest_player_3")
    public JAXBElement<FixturePlayerStatistics> createGuestPlayer3(FixturePlayerStatistics player) {
        return new JAXBElement<FixturePlayerStatistics>(new QName("guest_player_3"), FixturePlayerStatistics.class, player);
    }

} 
```

***演示***

```
package forum13219778;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(FixtureStatistics.class, ObjectFactory.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum13219778/input.xml");
        FixtureStatistics fs = (FixtureStatistics) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(fs,  System.out);
    }

} 
```

# twitter-bootstrap - 固定宽度的导航栏中的下拉菜单

> ID：13219779
> 
> 赞同：1
> 
> 时间：2012-11-04T15:12:40.633
> 
> 标签：twitter-bootstrap, navbar

我正在使用固定宽度的引导程序构建导航栏，下面是我正在使用的代码，但右侧的下拉菜单不起作用

```
 <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="/">PROJECT</a>
                <div class="nav-collapse">
                    <ul id="menu" class="nav">
                        <li><a href="#">Home</a></li>
                        <li><a href="#">About</a></li>
                        <li><a href="#">Contanct</a></li>
                    </ul>
                </div><!-- /.nav-collapse -->
                <ul class="nav pull-right"> <!-- user-menu dropdown --> 
                    <li class="dropdown" id="user-menu">
                        <a href="#user-menu" class="dropdown-toggle" data-toggle="dropdown">
                            <i style="opacity: 0.40;" class="icon-user icon-white">&nbsp;</i>&nbsp;Anonymous
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li data-name="user-activity"><a href="#">Preferences</a></li>
                            <li class="divider"></li>
                            <li><a href="#">Logout</a></li>
                        </ul>
                    </li>
                </ul> <!-- /user-menu dropdown --> 
            </div>
        </div><!-- /navbar-inner -->
    </div> 
```

我按顺序将css和js包含在下面：

*   bootstrap.min.css
*   引导响应.min.css
*   jquery-1.4.1.js
*   bootstrap.min.js
*   引导-dropdown.js

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:17:58.310

删除`<div class="container">`它，它会工作。

[http://jsfiddle.net/XXwnH/](http://jsfiddle.net/XXwnH/)

# jakarta-ee - Java EE 应用程序和 red5 服务器集成

> ID：13219780
> 
> 赞同：2
> 
> 时间：2012-11-04T15:12:41.907
> 
> 标签：jakarta-ee, integration, red5

我有一个现有的 Java EE 应用程序（spring+hibernate）。我想为其添加视频录制/流媒体功能。我想使用Red5。如何将 Red5 集成到现有应用程序（也在 tomcat 上运行）。（注意：在现有应用程序上完成身份验证）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:22:27.237

Red5 基本上是一个修改后的 Apache Tomcat 服务器，Red5 也使用 Spring。与其将 Red5 功能合并到您的应用程序中，不如将您的应用程序合并到 Red5 应用程序服务器并将其用作 Servlet 容器可能更容易。如果您不喜欢 Tomcat，也可以将 Red5 编译为 Jetty。如果您使用 JBoss 或其他应用程序服务器并且需要将 Red5 合并到您的应用程序中，这将更加困难。但是，您*可以将*Red5 编译为 .war 包并将其部署到 JBoss。但是 Red5 .war 包没有正式发布，并且该 .war 中可能存在的错误也没有发布或记录。如果您从 googlecode 签出项目，我认为有一个 ANT 任务目标来编译 .war 包。

塞巴斯蒂安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T14:20:57.153

第 1 步：下载“Red5War_1.0”或最新版本。

第 2 步：解压缩 Red5War_1.0.war

第三步：复制膨胀的war文件夹“/WEB-INF/classes”的内容，粘贴到“Source Packages”中。

第4步：导航到膨胀的war文件夹的“/WEB-INF/lib”，选择所有依赖jar并将其粘贴到您的“Library”文件夹中。

第五步：将WEB-INF/web.xml的内容复制到你项目的web.xml中。

第 6 步：将膨胀文件夹的剩余内容（“除 /META-INF、/WEB-INF/classes”和“/WEB-INF/lib”）复制到项目的“Web 文件夹”。

第七步：在防火墙中打开以下端口 TCP/843,TCP/1935,TCP/5229,TCP/5080

如果需要更改程序，请告知。

阿鲁姆甘 AV

# java - 从另一个对象访问一个对象？

> ID：13219787
> 
> 赞同：2
> 
> 时间：2012-11-04T15:13:18.117
> 
> 标签：java

我知道这绝对是个无聊的问题（所以新手），但我被困住了。如何从另一个对象访问一个对象的字段？问题 => 如何避免两次创建 Test02 对象？（第一次 => 来自 main() 循环，第二次 => 来自 Test01 的构造函数）？

```
class Main
{
    public static void main(String[] args)
    {
        Test02 test02 = new Test02();
        Test01 test01 = new Test01(); //NullPointerException => can't access test02.x from test01
        System.out.println(test01.x); 

    }
}

class Test01
{
    int x;
    Test02 test02; //can't access this, why? I creat test02 object in main() loop before test01

    public Test01()
    {
        x = test02.x;
    }
}

class Test02
{
    int x = 10;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:18:29.143

您必须在 Test01 中实例化 test02 （例如在构造函数中）或将 main 中的实例化对象传递给 Test01

所以要么：

```
public Test01()
    {
        x = new Test02();
//...
    } 
```

或者

```
class Test01
{
    int x;
    Test02 test02; //the default value for objects is null you have to instantiate with new operator or pass it as a reference variable

    public Test01(Test02 test02)
    {
        this.test02 = test02; // this case test02 shadows the field variable test02 that is why 'this' is used
        x = test02.x;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:14:50.317

您没有创建 的实例`Test02`，因此`NullPointerException`每当您尝试`test02`从`Test01`的构造函数访问时都会得到 a 。

为了解决这个问题，`Test01`像这样重新定义你的类的构造函数 -

```
class Test01
{
    int x;
    Test02 test02; // need to assign an instance to this reference.

    public Test01()
    {
        test02 = new Test02();    // create instance.
        x = test02.x;
    }
} 
```

或者，您可以传递`Test02`from的实例`Main`-

```
class Main
{
    public static void main(String[] args)
    {
        Test02 test02 = new Test02();
        Test01 test01 = new Test01(test02); //NullPointerException => can't access test02.x from test01
        System.out.println(test01.x); 

    }
}

class Test01
{
    int x;
    Test02 test02; //can't access this, why? I creat test02 object in main() loop before test01

    public Test01(Test02 test02)
    {
        this.test02 = test02;
        x = test02.x;
    }
}

class Test02
{
    int x = 10;
} 
```

原因是每当您尝试创建 的实例时`Test01`，它都会尝试访问`test02`其构造函数中的变量。但此时该`test02`变量并未指向任何有效对象。这就是为什么你会得到`NullPointerException`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T15:16:44.570

```
Test02 test02 = new Test02(); 
```

创建的 test02 对象仅适用于 main 方法。

`x = test02.x;`它会给出空指针，因为没有创建对象！

# c++ - C++ Arduino 串行连接超时

> ID：13219792
> 
> 赞同：3
> 
> 时间：2012-11-04T15:13:59.347
> 
> 标签：c++, com, timeout, serial-port, arduino

最初，我使用[AutoHotkey](http://en.wikipedia.org/wiki/AutoHotkey)与 Arduino 进行通信，但我发现在没有向 Arduino 发送任何内容的几个小时后（Arduino 每十秒发送一次“心跳”），连接将冻结或失败。

[现在我正在尝试通过带有RS-232 库](http://www.teuniz.net/RS-232/)的 C++ 程序的串行连接来控制 Arduino 。

但我遇到了同样的问题。程序每 20 秒 ping 一次 Arduino，然后 Arduino 应该报告一小串信息。几个小时后，连接断开，我的 C++ 程序只是坐在那里 ping 没有响应。Arduino有一个看门狗，当连接不存在时，我可以验证它是否仍在工作，所以我相信我的问题在于串行的某种固有超时......除了正在积极使用连接......

我将不胜感激任何帮助弄清楚我需要做什么才能保持串行连接处于活动状态，计算机必须能够 24/7 向 Arduino 发送数据。

我正在编译`Code::Blocks`，并在 Windows 7 上运行该程序。

我对 C++ 或 C 不是很熟悉，所以如果你发现我在程序中做的其他愚蠢的事情，请告诉我。

### 主文件

```
/**************************************************

  File: main.cpp
  Purpose: Simple demo that receives characters from
           the serial port and print them on the
           screen.

**************************************************/

#include <stdlib.h>
#include <iostream>

#ifdef _WIN32
    #include <Windows.h>
#else
    #include <unistd.h>
#endif

#include "rs232.h"

using namespace std;

int main()
{
    int debug = 0;
    int i = 0, n,
    cport_nr = 5,        /* /dev/ttyS5 (COM6 on Windows) */
    bdrate = 9600;       /* 9600 baud */

    unsigned char buf[4096];

    if(OpenComport(cport_nr, bdrate))
    {
        cout << "Can not open comport\n";
        return(0);
    }

    while(1)
    {
        if (debug)
        {
            printf("Entering While(1) loop. \n");
        }

        n = PollComport(cport_nr, buf, 4095);

        if(n > 0)
        {
            buf[n] = 0;   /* always put a "null" at the end of a string! */

            /* for(i=0; i < n; i++)
            {
                if(buf[i] < 32)  // replace unreadable control-codes by dots
                {
                  buf[i] = '.';
                }
            } */

            //printf("\n\n\nreceived %i bytes: %s\n\n", n, (char *)buf);
            cout << endl << endl << endl << (char *)buf;
        }

        if (SendByte(cport_nr, 83))
        {
            printf("\n\nSending data didn't work. \n\n");
        }
        else
        {
            cout << "\nSent [S]\n";
        }

        i = 0;

        #ifdef _WIN32
            Sleep(10000);  /* It's ugly to use a sleeptimer, in a real program, change
                              the while-loop into a (interrupt) timerroutine. */
        #else
            usleep(10000000);  /* Sleep for 100 milliSeconds */
        #endif
    }
    return(0);
} 
```

### Arduino文件

```
//
// SuiteLock v.2.1a
// By: Chris Bero (bigbero@gmail.com)
// Last Updated: 11.4.2012
//

#include <Servo.h>
#include <avr/wdt.h>

// Pin Constants:
const int servoPin = 9;
const int doorbtn = 3;

// Not sure if I'm still going to use these...
const int ledGND = 4;
const int ledVCC = 5;
const int servDelay = 600; // The delay allowing for the servo to complete an action.

//Variables:
int doorState = 0;  // The value returned by the door button (0 or 1).
int servState = 90;  // The position of the servo in degrees (0 through 180).
unsigned long prevMillis = 0;
unsigned long progCycles = 0;
int serialByte = 0;
int lastSerial = 0;
int smallBlink = 0;
bool dostatus = false; // Determine whether to send sys status.
Servo serv;

// Set up the environment.
void setup()
{
    wdt_enable(WDTO_4S);
    pinMode(doorbtn, INPUT);
    pinMode(ledGND, OUTPUT);
    pinMode(ledVCC, OUTPUT);
    pinMode(servoPin, OUTPUT);
    digitalWrite(ledGND, LOW);
    serv.attach(servoPin);
    Serial.begin(9600);
    prevMillis = millis();
}

////////////////////////////////////////////////
// Statuser - Sends system status to Serial
/////////////////////////////////////////////
int statuser ()
{
    wdt_reset();
    Serial.println("[Start]"); //Start Of Transmission
    delay(15);
    unsigned long currentMillis = millis();
    refresh();
    Serial.print("\tTime Alive: ");
    int hr = ((currentMillis/1000)/3600);
    int mn = (((currentMillis/1000)-(hr*3600))/60);
    int sc = ((currentMillis/1000)-(hr*3600)-(mn*60));
    Serial.print(hr);
    Serial.print(":");
    Serial.print(mn);
    Serial.print(":");
    Serial.println(sc);
    Serial.print("\tNum of Program Cycles: ");
    Serial.println(progCycles);
    Serial.print("\tAvg Cycles per Second: ");
    int cps = (progCycles/(currentMillis/1000));
    Serial.println(cps);
    Serial.print("\tDoorState: ");
    Serial.println(doorState);
    Serial.print("\tServo Position: ");
    Serial.println(servState);
    Serial.print("\tLast Serial Byte: ");
    Serial.println(lastSerial);
    delay(15);
    Serial.println("[End]"); //End Of Transmission
    return(0);
}

////////////////////////
// Lock the door.
/////////////////////
int locker()
{
    wdt_reset();

    // Check the button states.
    refresh();

    // Make sure the door is closed.
    do
    {
        wdt_reset();
        delay(500);
        refresh();
    } while(doorState == LOW);

    // Turn on the locking LED during the servo movement.
    digitalWrite(ledVCC, HIGH);

    wdt_reset();

    // Tell the servo to turn to 20 degrees.
    serv.write(20);

    // Give the servo time to complete the turn.
    delay(servDelay);

    wdt_reset();

    // Turn the servo opp direction to reset.
    serv.write(90);

    // Wait for the servo to reach it's reset point.
    delay(servDelay);

    // Turn off the cool little LED.
    digitalWrite(ledVCC, LOW);

    // Call parents for 11pm checkup and tell them everything's A-OK.
    return(0);
}

/////////////////////////
// Unlock the door.
//////////////////////
int unlocker ()
{
    wdt_reset();

    // Check the pin states.
    refresh();

    // Turn on the status LED.
    digitalWrite(ledVCC, HIGH);

    wdt_reset();

    // Turn servo to 170 degrees to unlock the door.
    serv.write(170);

    // Wait for servo motion to complete.
    delay(servDelay);

    wdt_reset();

    // Reset the servo to 90 degrees.
    serv.write(90);

    // Wait for reset motion to complete.
    delay(servDelay);

    // Turn off LED.
    digitalWrite(ledVCC, LOW);

    return(0);
}

///////////////////////////////
// Refresh button states.
/////////////////////////////
void refresh ()
{
    wdt_reset();
    doorState = digitalRead(doorbtn);
    servState = serv.read();
}

///////////////////////
// Main function.
////////////////////
void loop()
{
    wdt_reset();

    // Blink the LED every so many turn overs of the function.
    if (smallBlink == 5)
    {
        smallBlink = 0;
        digitalWrite(ledVCC, HIGH);
        delay(300);
        digitalWrite(ledVCC, LOW);
    }

    // Status.
    if(dostatus == true)
    {
        unsigned long currentMillis = millis();
        if ((currentMillis - prevMillis) > 4000)
        {
            prevMillis = currentMillis;
            statuser();
        }
    }

    // Refresh button states.
    refresh();

    // Is the door closed and not locked? *Gasp*
    if ((doorState == LOW))
    {
        // Fix it.
        while (doorState == LOW)
        {
            wdt_reset();
            delay(500);
            refresh();
        }
        locker();
    }

    // Check for available communications.
    if (Serial.available() > 0)
    {
        // Reset the serialByte, done for debugging.
        serialByte = 0;
        wdt_reset();
        // Read the serialByte.
        serialByte = Serial.read();
        lastSerial = serialByte;
    }

    // Act on the byte data.
    if (serialByte == 'U')
    {
        // Let someone in.
        unlocker();
        // Wait for the door to change states.
        delay(1000);
    }
    if (serialByte == 'L')
    {
        locker();
        delay(1000);
    }
    if (serialByte == 'S')
    {
        statuser();
        delay(200);
    }

    // Clean serialByte for debugging.
    serialByte = 0;

    // Count through program cycles.
    progCycles++;
    smallBlink++;
} 
```

我调整了 C++ 程序以打开 comport，发送“S”，然后关闭 comport 并等待。然后我让它循环这个过程，这样它就可以继续打开和关闭端口。我的希望是，这将使连接不会达到几个小时的标记和超时或其他什么。结果程序成功循环了一个小时，然后突然无法打开COM端口……这完全把我吓坏了，我不知道该怎么办……

如果 CrazyCasta 是对的，而且只是我的 Arduino 与笔记本电脑的连接有问题，有没有办法在无需先重新启动计算机的情况下重置连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T14:09:15.317

正如 CrazyCasta 所说，这是一个硬件问题。我可以通过移除我的 Arduino 和计算机之间的 9 英尺（2.7 m）USB 延长线来解决这个问题。

截至今天早上，该连接已经运行了十个小时，比之前的测试长了七个小时。我希望可以安全地说这是固定的。

# python - enable-app-engine-project 有点乱

> ID：13219794
> 
> 赞同：1
> 
> 时间：2012-11-04T15:14:11.470
> 
> 标签：python, google-app-engine, oauth-2.0, google-bigquery, google-api-python-client

我正在关注本教程 [https://developers.google.com/bigquery/articles/dashboard#downloadinstalllibraries](https://developers.google.com/bigquery/articles/dashboard#downloadinstalllibraries)

他们在这里说

```
cd source/
enable-app-engine-project hellodashboard/ 
```

这会将大约 60 个文件复制到项目目录中。但我只看到复制了大约 10 个文件。项目目录中的 oauth2client 文件夹只有`__init__.py`文件，因为我正在使用

```
from oauth2client.appengine import oauth2decorator_from_clientsecrets 
```

当我运行我的程序时，它显示一个错误

```
from oauth2client.appengine import oauth2decorator_from_clientsecrets
ImportError: No module named appengine 
```

所以我手动将所有文件从 oauth2client zip 复制到项目 oauth2client 目录。现在，当我运行我的程序时，它没有显示任何错误并且似乎运行良好。是 enable-app-engine-project 命令弄乱了一些东西还是我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:15:48.880

`enable-app-engine-project`尝试根据本地系统上安装模块的路径来定位源。您是否在本地安装了这些模块？

作为替代方案，您可以简单地将以下目录手动复制到您的 App Engine 项目中：

```
SOURCES = [
    'gflags',
    'gflags_validators',
    'httplib2',
    'oauth2client',
    'oauth2',
    'apiclient',
    'uritemplate',
    ] 
```

# java - x mod -3 返回正数

> ID：13219795
> 
> 赞同：3
> 
> 时间：2012-11-04T15:14:16.410
> 
> 标签：java, modulo

我想从 Java 中的 x mod -3 中得到负数。例如：1 mod -3 = -2 或 2 mod -3 = -1

有什么方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:22:58.457

Java 中的`%`运算符不是取*模*运算符，而是*余数*。（他们*不是*一回事）这解释了你得到的不同迹象。从当前的[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/index.html)，第[15.17.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17.3)节：

> 据说二进制 % 运算符从隐含的除法中产生其操作数的其余部分；左边的操作数是被除数，右边的操作数是除数。
> 
> 在 C 和 C++ 中，余数运算符只接受整数操作数，但在 Java 编程语言中，它也接受浮点操作数。
> 
> 在二进制数值提升（第 5.6.2 节）之后，整数操作数的余数运算产生一个结果值，使得 (a/b)*b+(a%b) 等于 a。
> 
> 即使在被除数是其类型的最大可能量级的负整数并且除数是-1（余数是0）的特殊情况下，这个恒等式也成立。
> 
> 由这个规则得出，余数运算的结果只有当被除数为负时才能为负，只有当被除数为正时才能为正。此外，结果的大小总是小于除数的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T15:17:32.633

`X mod -Y`正如您所定义的，它可以通过求解`-X mod Y`然后否定答案来计算。

示例：`1 mod -3`-> `-1 mod 3 = 2`->`-2`

特别是在 Java 中， do `-X % Y`，如果非零则添加`Y`，然后否定答案。

```
public static int negativeMod(int x, int y) {
   if (y > 0) return x % y;

   int newAnswer = (-1 * x) % (-1 * y);
   if (newAnswer != 0) newAnswer -= y;

   return -1 * newAnswer;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T01:20:34.057

这很容易。如果余数不为 0，则减去模数。对于示例 1 mod -3, 1 - 3 是 -2，即您想要的答案。这是数学恒等式 a == a - n (mod n) 的简单结果。

# html - HTML 敏捷包，无法选择节点

> ID：13219814
> 
> 赞同：0
> 
> 时间：2012-11-04T15:15:54.620
> 
> 标签：html, vb.net, html-agility-pack, nodes

我有以下 HTML 代码

```
<a href="http://www.google.de/products/catalog?hl=de&amp;newwindow=1&amp;q=6411920054105&amp;um=1&amp;ie=UTF-8&amp;cid=12216375657503902223&amp;sa=X&amp;ei=8nWWUOvADonntQbP3IHgDw&amp;ved=0CEgQ8gIwAA" class="psliimg" target="_blank">
<img src="https://lh5.googleusercontent.com/public/OCXiCAAYqFb859nA0DsbPbBSBR2EYU8IFnl_xtJxG2t1_z_xlLiRjxt5HPa0XFZBT1nch4a1j8PAAr4SVs974R_KnJI83sDB303YlcZQD9L5kmKUdTKXfLfJM_lovWyQcf4UlZkXb8sMarIamxSytCjB-aM=s90-c" alt="iittala Aalto Vase apfelgrün 16cm">
</a> 
```

基本上它的

```
<a href="" class="" target=""><img src="" alt=""></a> 
```

使用 html 敏捷包我无法获得具有以下内容的节点`xpath`

```
//a[@class="psliimg] 
```

但是我可以通过选择它的孩子来获得它，`<img>`但是当我尝试访问除 href 之外的任何其他属性时，它永远不会起作用！如果我尝试获取属性的数量，即使有 3 个，它也会给我一个！

这是原始[链接](https://www.google.de/search?hl=de&tbm=shop&q=6411920054105&oq=6411920054105&gs_l=products-cc.12...3450.3450.0.4463.1.1.0.0.0.0.334.334.3-1.1.0...0.0...1ac.1.fBfILtFfII0)，因此您可以进行测试，这可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T20:54:56.667

你想从你发布的 htlm 代码中得到什么？

我运行它并尝试测试自己并得到同样的错误。所以我在下面运行了这段代码，写入控制台的文本甚至不包含该属性`class = psliimg`，所以我不确定从页面读取原始 html 代码和 HAP 如何处理它之间发生了什么。

```
Sub Main()
    Dim web As HtmlWeb = New HtmlWeb
    Dim doc As HtmlDocument = web.Load("https://www.google.de/search?hl=de&tbm=shop&q=6411920054105&oq=6411920054105&gs_l=products-cc.12...3450.3450.0.4463.1.1.0.0.0.0.334.334.3-1.1.0...0.0...1ac.1.fBfILtFfII0")

    Dim str = doc.DocumentNode.SelectSingleNode("//a[contains(@href,'12216375657503902223')]").ParentNode.InnerHtml
    'The long munber is contained in the html line and is just used to identify the node I want to select.
    Console.WriteLine(Str)
    Console.ReadKey()
End Sub 
```

这是输出：

```
<a href="http://www.google.de/products/catalog?hl=de&amp;q=6411920054105&amp;um=1&amp;ie=UTF-8&amp;cid=12216375657503902223">
<img src="https://lh5.googleusercontent.com/public/OCXiCAAYqFb859nA0DsbPbBSBR2EYU8IFnl_xtJxG2t1_z_xlLiRjxt5HPa0XFZBT1nch4a1j8PAAr4SVs974R_KnJI83sDB303YlcZQD9L5kmKUdTKXfLfJM_lovWyQcf4UlZkXb8sMarIamxSytCjB-aM=s90-c" alt="iittala Aalto Vase apfelgrün 16cm" height="90" width="90">
</a> 
```

所以不幸的是，你可能不得不按照`xpath`上面的内容而不是网站所说的来编写代码，如果我错了，请纠正我。

您还可以遍历每个节点并选择您喜欢的内容。

```
 For Each link As HtmlNode In doc.DocumentNode.SelectNodes("//a[@href]")
        'Console.WriteLine(link.ParentNode.InnerHtml)
    Next 
```

抱歉，这不是一个真正的答案，但不知道发布代码片段的最佳方式。

# wpf - 如何防止面板被关闭？

> ID：13219815
> 
> 赞同：0
> 
> 时间：2012-11-04T15:16:00.797
> 
> 标签：wpf, xaml, mvvm, avalondock

我正在使用带有 DocumentsSource 的 AvalonDock (V2)：

```
<a:DockingManager DocumentsSource="{Binding Items}"/> 
```

我想禁用使用样式或与DocuemntsSource一起使用的东西关闭面板的可能性。

如果可能的话，我希望关闭元素以折叠方式停靠到 DocumentManager 而不是关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T09:41:47.870

对于那些有兴趣的人：有一个可以绑定的 CanClose 属性......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:52:18.180

CanClose() 属性不适用于 LayoutAnchorable 控件。

但如果您可以更改源代码以禁用关闭按钮，它就可以工作。

就我而言，我不得不走那条路。

# vb6 - # 数字前的符号

> ID：13219818
> 
> 赞同：0
> 
> 时间：2012-11-04T15:16:16.360
> 
> 标签：vb6, vb6-migration

我收到了将一个旧的和胡思乱想的（和它的代码一样多的）VB6 应用程序升级到 c# 的不幸任务。在代码的许多地方，我在数字前看到了这个 # 符号，这似乎是某种可行的。

例如：

```
Dim line As String 

f$ = File.Path + "\" + File.FileName 
Open f$ For Input As #2 
Line Input #2, a$ 
```

稍后他将使用 a$ 作为行值，但我看不到 #2 的任何用途。那么2#到底是做什么用的呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:20:47.743

是`#2`一个文件句柄。

该文件在此处打开并与文件句柄相关联：

```
Open f$ For Input As #2 
```

然后输入语句从该文件中读取一行并放入`a$`变量中：

```
Line Input #2, a$ 
```

# entity-framework - 如何首先在 EF 代码中创建新的基线/重置？

> ID：13219819
> 
> 赞同：2
> 
> 时间：2012-11-04T15:16:20.710
> 
> 标签：entity-framework

因此，当首先使用实体​​框架代码对应用程序进行原型设计时，我最终进行了大量迁移。

我对保留所有生成的类不感兴趣，我想说：好的，这是我的 v1 基线。

如何先重置 EF 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T10:46:49.170

如果您想返回数据库中的第一个迁移，您只需要：

```
Update-Database –TargetMigration:"YourFirstMigrationName" 
```

在您的停车场管理控制台中。

但它只返回您的数据库版本，而不是您的代码优先 POCO 类。要控制版本，您需要另一个工具，例如 Team Foundation 或 git。

# c++ - 如何访问和管理块存储数据

> ID：13219821
> 
> 赞同：5
> 
> 时间：2012-11-04T15:16:30.347
> 
> 标签：c++, performance, design-patterns, data-structures, iterator

**我想要做什么：**我需要以块形式存储单元格数据，即

*cell_member1[cell0] .. cell_member1[cellN] ... cell_memberM[cell0] .. cell_memberM[cellN]*

然后我需要有效地访问这些数据，如果可能的话，使用一个好的语法。如果我可以轻松地定义要存储的数据，那就太好了，即通过将具有成员的对象定义为我想要存储的数据并将其传递给为我做所有事情的“魔法”。

**动机：**为什么我需要这样做？缓存垃圾。在某些内部循环中，仅访问对象的某些成员。用未使用的内存浪费一半的缓存行不是我的应用程序的选择。我可以将指针存储在指向某个顺序内存区域的对象中。这会浪费内存并迫使我在该区域使用不同的语法。

**我目前是如何做的：**我有一个表格的容器：

```
template<class T> struct Container {
  char* data;
  Container(const int n) {
    data = new char[n*T::spaceRequirements()]; //< Data stored "block-wise"
    new(data) typename T::Flags[n]; //< Flags stored "cell-wise"
  }
  /// Destructor ommited for briefness.
}; 
```

我在其中存储 T 类型的某些单元格的数据。每个单元格需要一些标志，现在我正在使用 std::bitset 来存储它们，这意味着我需要以单元格形式存储这些位集：

*cell_member1[cell0] ... cell_memberM[cell0] ... cell_member1[cellN] .. cell_memberM[cellN]*

我正在描述每个单元格需要在以下类中存储多少数据，该类还提供对数据的访问：

```
template<int nd> struct CellAccessor {
  /// Cell flags are stored cell-wise:
  typedef std::bitset<64> Flags;
  enum { DELETE = 0, ///< Cell marked for deletion
         REFINE = 1 ///< Cell marked for refinement
         //...
  }; ///< Enum for the flags.
  static inline Flags& flags(const int cellId) {
    return *reinterpret_cast<Flags*>(data + sizeof(Flags)*cellId); }
  template<int pId> static inline Flags::reference flags(const int cellId) {
    return flags(cellId)[pId]; } //< Cell-wise access to the properties

  /// The rest of the data is stored block-wise:
  static inline int& order(const int cellId) { ///< One int field.
    return *reinterpret_cast<int*>
        (data + maxNoCells*sizeof(Flags) + sizeof(int)*cellId);}

  /// Coordinate vector with nd components:
  static inline double& coordinates(const int cellId, const int i) {
    return *reinterpret_cast<double*>
        (data + maxNoCells*(sizeof(Flags)+sizeof(int))
         + maxNoCells*i*sizeof(double) + sizeof(double)*cellId); }
  template<int i> static inline double& coordinates(const int cellId) {
    return *reinterpret_cast<double*>
        (data +maxNoCells*(sizeof(Flags)+sizeof(int)+i*sizeof(double))
         + sizeof(double)*cellId); }

  /// Total amount of memory to allocate per cell: (used by Container)
  static inline int spaceRequirements() { return
        sizeof(Flags) // Flags
        + sizeof(int) // order
        + nd*sizeof(double) // coordinates
        ;}

  /// Constructor gets pointer to the beginning of the container 
  /// and the offset for the member variables:
  CellAccessor(char* d, int n){data = d; maxNoCells = n;}
 private:
  static char* data;  ///< Pointer to the beginning of the container.
  static int maxNoCells;  ///< Cell offset for the member variables.
};
template<int nd> char* CellAccessor<nd>::data = nullptr;
template<int nd> int CellAccessor<nd>::maxNoCells = 0; 
```

我像这样使用它：

```
int main() {
  int maxNoCells = 10000;   ///< Maximum number of cells (=cell offset).
  typedef CellAccessor<2> A;
  Container< A > cellData(maxNoCells);  ///< Allocate cell data.
  A cells(cellData.data,maxNoCells);  ///< Provides access to cell data.

  for(int i = 0; i < maxNoCells; ++i){
    cells.flags<A::DELETE>(i) = i%2==0 ? true : false;
    cells.flags<A::REFINE>(i) = i%2==0 ? false : true;
    cells.coordinates(i,0) = i;
    cells.coordinates<1>(i) = -((double)i);
    cells.order(i) = 2;
  }
} 
```

**优点：**

*   数据是逐块形式的，这正是我所需要的。

*   语法没问题。

**问题：**

*   我的课程做的太多了：为用户提供对数据的访问，提供需要为容器存储多少数据，提供数据应该如何移动/复制/交换我的数据结构（它们是树...... )...

*   我不能使用没有迭代器的 STL 算法。我通过让迭代器存储单元索引并在其中重新实现 CellAccessor 类来实现迭代器（糟糕！干！）。

*   Bitset 仍以单元格形式存储。我可以为我的块数据结构重新实现位集......

*   data 和 maxNoCells 是静态变量，但如果需要，我可以将它们设为普通成员变量。

**问题：**是否有任何有效的方法以块形式存储“对象”（或我们在概念上理解的对象）并访问它们，就好像它们存储在诸如向量之类的标准容器中一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T19:50:00.933

你想要的是一种“基于列”的内存访问风格

您可以使用自己的列类型轻松实现它`std::vector`，或者使用自己的底层内存管理创建自己的“列”类型 - 但`std::vector`应该可以正常工作

现在，一旦您有了列类型，就可以创建“TABLE”类型。

在某种程度上，您的表 cab 只是向量的向量。您当然可以将其包装起来以获得更好看的访问器（如果您想先按行（对象）访问，然后按列（属性）访问。

这是我认为最好的通用方法。

即使在您的特定情况下-由于您想使用位长标志来节省内存，正如 Bart van Ingen Schenau 所提到的，您可以使用 a`vector<bool>`所以一般方法是

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T20:43:53.250

不确定是否正确理解了这个问题。看起来您正在尝试在顺序字节数组中分配数据。为什么？但无论如何你都可以通过使用数组来做到这一点：

```
class Cell {
   std::bitset<64> flags;
   int order;
   double coordinates[2];
}

int main() {
   const int maxNoCells = 10000;
   Cell cells[maxNoCells];

   for(int i = 0; i < maxNoCells; i++) {
       cells[i].flags = ...;
       cells[i].coordinates[0] = i;
       cells[i].coordinates[1] = -i;
       cells[i].order=2;
   }
} 
```

如果需要，然后将其转换为 (char *) 单元格。您的类将在连续的内存条中以分段方式分配。您可以将其用于读/写/网络。唯一的问题是您必须注意 32/64 位对齐，特别是如果它在不同架构之间共享。

这是另一个版本，如果您坚持在单独的循环中使用不同的字段，它会更好地进行缓存：

```
template<int size>
class CellAccessor {
    std::bitset<64> flags[size];
    int order[size];
    double coordinates[size][2];
 public:
    std::bitset<64> &getFlags(int id) {
        return flags[id];
    }
    int &getOrder(int id) {
        return order[id];
    }
    ...
 }

main() {

    CellAccessor<10000> ca;

    for(...i++) {
        ca.getOrder(i) = 2;
        ca.getCoordinates(i)[0] = i;
        ...
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:00:51.890

我会使用并行数组来满足要求：

```
template <int nd>
class CellAccessor {
public:
    enum { DELETE = 0, ///< Cell marked for deletion
           REFINE = 1, ///< Cell marked for refinement
           //...
           NUM_FLAGS
    }; ///< Enum for the flags.
    CellAccessor(int numCells) {
        for (int i=0; i<NUM_FLAGS; i++) { m_flags[i] = new bool[numCells]; }
        m_order = new int[numCells];
        for (int i=0; i<nd; i++) { m_coordinates[i] = new double[numCells]; }
    }
    // Destructor, copy-constructor & assignment operator omitted for brevity

    template<int F> inline bool& flags(const int cellId) {
        return m_flags[F][cellId]; }
    inline bool& flags(const int cellId, int flag) {
        return m_flags[flag][cellId]; }
    inline int& order(const int cellId) {
        return m_order[cellId]; }
    template<int i> inline double& coordinates(const int cellId) {
        return m_coordinates[i][cellId]; }
    inline double& coordinates(const int cellId, int i) {
        return m_coordinates[i][cellId]; }

private:
    bool* m_flags[NUM_FLAGS];
    int*  m_order;
    double* m_coordinates[nd];
}; 
```

# expressionengine - 在 Expression Engine 上使用 Exp:resso 的商店时，如何更改产品表单以显示改性剂库存？

> ID：13219826
> 
> 赞同：4
> 
> 时间：2012-11-04T15:17:02.833
> 
> 标签：expressionengine, expresso-store

为我的商店创建产品页面时，很容易显示 {total_stock}。但是如何显示修改器的库存，或根据其库存禁用修改器？

例如，在卖衣服时，我只想启用有货的尺寸。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:32:07.227

这样做的问题是库存与 SKU 相关联，而 SKU 并不总是直接映射到修饰符。例如，如果“衬衫”产品同时具有尺码和颜色，那么您无法确定“大码”是否缺货，因为它也取决于颜色。

也就是说，如果您的产品只有一个修饰符，则存在 1-1 映射。您应该能够使用循环`{option_stock_level}`内部访问库存水平，如下所示：`{modifier_options}`

```
{modifiers}
    <select name="{modifier_input_name}">
        {modifier_options}
            <option value="{option_id}">
                {option_name} ({option_stock_level} remaining)
            </option>
        {/modifier_options}
    </select>
{/modifiers} 
```

# php - 使用 cli args 调用 php 脚本的 bash 脚本

> ID：13219831
> 
> 赞同：0
> 
> 时间：2012-11-04T15:17:37.800
> 
> 标签：php, bash, command-line-interface, args

我需要编写一个包装 php 脚本的 bash 脚本，我有一些需要转发到 php 脚本的变量以及一些我在内部需要用于 bash 脚本自身的变量。

对 shell 脚本的调用应该是这样的，但是 php 文件可以有更多的参数，所以它需要是通用的：

```
bash  /tmp/test.sh -c -l /tmp/aaa -php aaa.php -d -p 3 -f 2012-10-23 
```

该`-php`选项是强制性的，因为它包含需要调用的 php 文件，`-c`并且`-l`是可选标志，需要在 bash 脚本内部使用，之后的所有内容`aaa.php`都是 php 文件的参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:41:10.550

`bash /tmp/test.sh -c -l /tmp/aaa -php "aaa.php -d -p 3 -f 2012-10-23"`?

不知道你是如何在 bash 脚本中传递任何东西的，但基本上用撇号包裹的所有东西都被视为 bash 脚本中的一个参数，进一步传递给 php 解释器被视为单独的参数，除非你当然不再包装它。

# iphone - 在 textFieldDidEndEditing 中隐藏 UITextField

> ID：13219837
> 
> 赞同：0
> 
> 时间：2012-11-04T15:18:01.843
> 
> 标签：iphone, ios, xcode, uitextfield

我试图在我的应用程序中隐藏我的 UITextField。我第一次尝试用 UIButton 来做。

为此我做了这个：

```
-(IBAction)hide:(id)sender {

_textField.hidden = !_textField.hidden;

} 
```

这行得通，但现在我试图在编辑后自动完成，所以我写了这段代码：

```
 -(void)textFieldDidEndEditing:(UITextField *)textField {

 textField.hidden = YES;

 } 
```

在 .h 我把这段代码：

```
-(void)textFieldDidEndEditing:(UITextField *)textField; 
```

谁能告诉我为什么这不起作用？

是否可以用动画隐藏它？我试过这个不起作用：

```
[UIView animateWithDuration:2.0 animations:^
{ code.. }
] 
```

谢谢你帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:27:44.717

您应该操纵 textField 的 alpha 值以对其进行动画处理例如：

```
textField.alpha = 1;
[UIView animateWithDuration:2.0 animations:^{
    textField.alpha = 0;
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:34:50.917

UITextField 的*hidden*属性是 BOOL 并且不能动画。尝试使用文本字段的*alpha*属性。它接受浮点值，其中 0.0 表示完全透明，1.0 表示完全不透明。

所以你可以为 UITextField 的 alpha 设置动画来隐藏它：

```
[UIView animateWithDuration: 2.0 
                 animations:^{ 
      textField.alpha = 0.0;
 }]; 
```

正如铍所说，您还应该检查您的文本字段是否确实设置了其委托，以便调用*-textFieldDidEndEditing:*方法。

我假设您有一个视图控制器设置如下：

```
@interface ViewController : UIViewController<UITextFieldDelegate>
@property (weak, nonatomic) IBOutlet UITextField *textField;
@end 
```

然后，您应该将情节提要中的 UITextField 的*委托*出口连接到视图控制器，如下所示：

![在此处输入图像描述](../Images/4d6ce7396d7b7aa887efdfa102ad1abc.png)

或者您可以在视图控制器的*-viewDidLoad方法中以编程方式执行此操作：*

```
- (void) viewDidLoad 
{
     self.textField.delegate = self;
} 
```

# facebook - 使用 Codeigniter 登录 Facebook 突然停止工作

> ID：13219839
> 
> 赞同：3
> 
> 时间：2012-11-04T15:18:17.420
> 
> 标签：facebook, codeigniter

我正在使用带有 Codeigniter 的 Facebook 并且工作正常但突然停止工作，Facebook 是否改变了任何东西

脸书功能

```
public function takofacebook($page = TRUE, $name = TRUE) {

    if (isset($page) and (($page != TRUE) or ($page != 1)) and isset($name)) {
        $data['page'] = $page;
        $data['name'] = $name;
    }

    $this -> load -> library('fb');
    if (!$this -> fb -> is_connected()) {
        redirect($this -> fb -> login_url(current_url()));
    }

    $fb_user = $this -> fb -> client -> api('/me');

    if (empty($fb_user)) {
        $error = "FACEBOOK LOGIN FAILED - USER US EMPTY. FILE: " . __FILE__ . " LINE: " . __LINE__;
        $this -> session -> set_flashdata('register_error', $error);
    } else {
        $this -> user -> set_facebook_id($fb_user['id']);
        $user = $this -> user -> get_by_facebook();
        if (!empty($user) && !empty($user -> id) && is_numeric($user -> id)) {

            //TODO: Make things a bit more secure here
            //Login & Redirect home

            $this -> _login($user -> id, 'facebook');
            $this -> load -> view('users/redirect_home2', $data);
            return;
        }
    }
    //Go to the registeration page
    $this -> load -> view('users/redirect2', array('method' => 'facebook'));
}

/**
 * Logs user in with facebook
 */

 //tako facebook
public function zangafacebook() {

    $this -> load -> library('fb');
    if (!$this -> fb -> is_connected()) {
        redirect($this -> fb -> login_url(current_url()));
    }

    $fb_user = $this -> fb -> client -> api('/me');

    if (empty($fb_user)) {
        $error = "FACEBOOK LOGIN FAILED - USER US EMPTY. FILE: " . __FILE__ . " LINE: " . __LINE__;
        $this -> session -> set_flashdata('register_error', $error);
    } else {
        $this -> user -> set_facebook_id($fb_user['id']);
        $user = $this -> user -> get_by_facebook();
        if (!empty($user) && !empty($user -> id) && is_numeric($user -> id)) {

            //TODO: Make things a bit more secure here
            //Login & Redirect home

            $this -> _login($user -> id, 'facebook');
            $this -> load -> view('users/redirect_home3');
            return;
        }
    }
    //Go to the registeration page
    $this -> load -> view('users/redirect3', array('method' => 'facebook'));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:58:45.750

我在我的 CodeIgniter 网站上测试了 Facebook 的官方 php sdk，它运行良好。$fb_user 是空的吗？错误在哪里？你在使用 Facebook 的官方 PHP SDK 吗？有很多变量可以弄清楚这里出了什么问题。就像 ifaour 建议的那样，如果您还没有，请在此处使用官方 php sdk：[https ://github.com/facebook/facebook-php-sdk/tree/master/src](https://github.com/facebook/facebook-php-sdk/tree/master/src)

将库目录中的文件拖放并正常调用

```
$this -> load -> library('facebook'); 
```

然后你可以像这样获取 facebook 数据：

```
$fb_user = $this -> facebook -> api('/me'); 
```

再次我不确定你的错误在哪里所以你在这里缺少一个参数吗？

$user = $this -> 用户 -> get_by_facebook( **$fb_user['id']** );

这就是我在我的网站上所做的一切，它工作得很好。这还有一个好处是，如果 Facebook 确实更改了任何内容，您只需要下载新的 SDK，并且您的代码应该保持不变。

# ios - iOS 在关闭时从 MPMoviePlayerViewController 调用父视图控制器中的 void

> ID：13219842
> 
> 赞同：0
> 
> 时间：2012-11-04T15:18:33.357
> 
> 标签：ios, mpmovieplayercontroller, dismiss, parentviewcontroller

当被解雇时，如何在 MPMoviePlayerViewCotroller 的 parentViewController 中调用自定义 -(void)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:57:11.107

尝试在 parentViewController 的 viewDidAppear 中调用它。

在显示 MPMoviePlayerViewController 之前设置一个标志并在 viewDidAppear 中检查它。然后相应地调用您自己的方法。

希望这可以帮助。

# java - 227 进入被动模式重播 FTPServer 到 IP 地址和端口

> ID：13219843
> 
> 赞同：0
> 
> 时间：2012-11-04T15:18:40.887
> 
> 标签：java, string, ftp

当我发送 PASV 命令时，我收到了来自 FTPServer 的重播消息，如下所示

227进入被动模式（159,153,197,77,194,82）

我将如何从这个字符串重播消息中获取 IP 地址。并将其转换为 InternetAddress....

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:30:55.483

`227 Entering Passive Mode (h1,h2,h3,h4,p1,p2)`是语法，h1-h4 是 IP 地址的 4 个字节，p1 和 p2 是 2 个字节的端口号，但我不明白你如何将其转换为 rsc822 互联网地址，它的`local@domain`形式是。哦，顺便说一句，您可以使用`string.substring(27,string.length-2).split(",")`将参数作为单独的字符串获取，然后`Byte.parseByte(string)`用于每个值

# javascript - 用 Javascript 生成 SVG

> ID：13219846
> 
> 赞同：0
> 
> 时间：2012-11-04T15:18:56.283
> 
> 标签：javascript, svg

我正在尝试使用 Javascript 加载 SVG。我经常成功地做到这一点，但这一次它有一个奇怪的回报。

这是我的 JS

```
var xmlns = 'http://www.w3.org/2000/svg';
var container = document.getElementById('svgContainer');
var svg = document.createElementNS(xmlns, 'svg');
svg.setAttribute('xmlns', xmlns);
svg.setAttribute('version', '1.2');
var defs = document.createElementNS(xmlns, 'defs');
var lg = document.createElementNS(xmlns, 'linearGradient');
lg.setAttribute('id', 'lg');
defs.appendChild(lg);
var stop1 = document.createElementNS(xmlns, 'stop');
stop1.setAttribute('offset', '0');
stop1.setAttribute('style', 'stop-color:#ffffff;stop-opacity:1');
lg.appendChild(stop1);
var stop2 = document.createElementNS(xmlns, 'stop');
stop2.setAttribute('offset', '1');
stop2.setAttribute('style', 'stop-color:#000000;stop-opacity:1');
lg.appendChild(stop2);
var rg = document.createElementNS(xmlns, 'radialGradient');
rg.setAttribute('cx', '171.20810');
rg.setAttribute('cy', '196.85463');
rg.setAttribute('r', '200.00000');
rg.setAttribute('fx', '171.20810');
rg.setAttribute('fy', '196.85463');
rg.setAttribute('id', 'rg');
rg.setAttribute('xlink:href', '#lg');
rg.setAttribute('gradientUnits', 'userSpaceOnUse');
rg.setAttribute('gradientTransform', 'matrix(1.040418,0.796229,-0.814518,1.064316,153.4218,-150.4353)');
defs.appendChild(rg);
svg.appendChild(defs);
var g = document.createElementNS (xmlns, 'g');
g.setAttribute('transform', 'scale(0.2,0.2)');
svg.appendChild(g);
container.appendChild(svg);
var path = document.createElementNS (xmlns, 'path');
path.setAttribute('d', 'M 450.00000 255.00000 A 200.00000 205.00000 0 1 1  50.000000,255.00000 A 200.00000 205.00000 0 1 1  450.00000 255.00000 z');
path.setAttribute('style', 'opacity:1.0000000;fill:url(#rg);fill-opacity:1.0000000;fill-rule:evenodd;stroke:none;stroke-width:8.0000000;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1');
g.appendChild(path); 
```

所以它以正确的顺序生成完美的 HTML DOM 元素，但它不显示任何内容。当我从源代码复制 HTML 并将其粘贴时，它会呈现 HTML 而不是 Javascript，但它是完全相同的代码。

您可以在[此处](http://jsfiddle.net/jLN6h/)查看源代码。

奇怪的是，当我将radialGradient 放入DOM 时，它就起作用了。你可以在[这里](http://jsfiddle.net/jLN6h/3/)看到它。

那么我该怎么做呢？这个问题出现在所有浏览器上。

谢谢您的帮助。

=== 编辑 ===
在 Robert Longson 的帮助下，我设法解决了这个问题，在[这里查看](http://jsfiddle.net/jLN6h/4/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T16:58:40.153

您不能使用 setAttribute 设置 xlink:href，您必须使用 setAttributeNS 例如

```
var xlinkns = 'http://www.w3.org/1999/xlink';
rg.setAttributeNS(xlinkns, 'xlink:href', '#lg'); 
```

以这种方式更改您的 jsfiddle 使其可以在 Firefox 上运行。我没有测试过其他 UA，但它们也应该可以工作。

# visual-studio-2010 - Blend 4 将与 Visual Studio Ultimate 2012 一起使用吗

> ID：13219847
> 
> 赞同：1
> 
> 时间：2012-11-04T15:18:57.050
> 
> 标签：visual-studio-2010, windows-phone-7, visual-studio-2012, expression-blend

Visual Studio 2010 或 2012 的最终版本是否包含 windows phone SDK 和 Expression Blend 4？即使在 Microsoft 网站上，我也找不到相关信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:18:12.020

Visual Studio 2010 和 Expression Blend 4 是配套应用程序，共享相同的 SLN 和 .csproj、vbproj 文件。Visual Studio 2012 还具有 Blend 的配套版本（Blend for MS Visual Studio 2012）。

上述 IDE 都没有准备好进行电话开发。您需要先安装 SDK，然后才能创建手机项目。在安装过程中，SDK 会将适当的模板添加到您的计算机中。

如果您有 Visual Studio 2012 Ultimate，它有一个电话项目的占位符。请参阅下面的屏幕截图。

![截屏](../Images/fb901541c113da739d058358c3cd00a8.png)

新版本的 Blend(Blend for MS Visual Studio 2012) 根本不支持手机项目。

![混合项目](../Images/c1a04f20044a7fe28329165709862d37.png)

Blend有一个[Beta 版本](http://blog.wpfwonderland.com/2012/09/26/microsoft-moves-closer-to-a-unified-expression-blend-2012-release/)，有更多的项目类型，发布版本即将推出。 [有关更多详细信息，请参阅此帖子。](http://blog.wpfwonderland.com/2012/09/26/microsoft-moves-closer-to-a-unified-expression-blend-2012-release/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:13:20.850

Visual Studio 2012 的终极版本包含 Blend for Visual Studio 2012（实际上是“Blend 5”）。不知道为什么那时你需要 Blend 4。

# c++ - 通过轻量级解析器逐行解析巨大的 XML 文件

> ID：13219850
> 
> 赞同：1
> 
> 时间：2012-11-04T15:19:04.773
> 
> 标签：c++, xml, xml-parsing

我正在为 Linux 编写一个小型独立工具，它需要读取一个巨大的 xml 文件。

xml 文件具有简单的结构，并且适合它的渐进式或流式（逐行）解析器。

我想使用一个轻量级的类库，比如 TinyXML，但我不知道它是否支持渐进式解析？！

如果答案是“是”，你有样品吗？而且，如果答案是“否”，您是否知道另一种替代方案，即小型且仅标头的类库？

**更新：** RapidXML 或 pugiXML 怎么样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T15:30:48.217

听起来 libxml 的[XmlReader 接口](http://xmlsoft.org/html/libxml-xmlreader.html)正是您想要的。快速、简单和流式传输。不幸的是，轻量级和 XML 不能混合使用。我更喜欢 XmlReader 的 pull 模型而不是 SAX 的 push 模型，但它们都会做你想做的事。

在拉取模型中，您调用一个函数并获取一个新节点，然后检查自己是否匹配。在推送模型中，您提供回调，SAX 在找到与它们匹配的节点时调用它们。

我上次检查的 TinyXML 不符合标准——我会避免使用它。

# templates - symfony 1.4 重用在 component.class.php 中声明的变量

> ID：13219853
> 
> 赞同：0
> 
> 时间：2012-11-04T15:19:27.133
> 
> 标签：templates, variables, action, symfony-1.4

> **可能重复：**
> [动作并将变量传递给 symfony 1.4 中的所有动作](https://stackoverflow.com/questions/10210784/action-and-pass-variable-to-all-actions-in-symfony-1-4)

我在主布局中包含的组件中声明了一个变量。

```
$this->var 
```

可以通过与组件对应的模板中的 $var 访问

```
_component.php 
```

我怎样才能使这个变量在另一个模板中可访问。

# java - java中的方法未识别错误

> ID：13219854
> 
> 赞同：1
> 
> 时间：2012-11-04T15:19:31.357
> 
> 标签：java, arrays, class, methods

我写了一个由两个类组成的小程序。我正在尝试从第二类调用方法，但出现错误。

错误是：

> 线程“主”java.lang.Error 中的异常：未解决的编译问题：方法 getSum(int[]) 未定义 UserInteraction 类型的方法 getAverage(int[]) 未定义 UserInteraction 类型的 UserInteraction.main(UserInteraction .java:66)

这是第一类的代码：

```
import java.util.Scanner;

public class UserInteraction {

    public static void main(String[] args) {

        Scanner scan = new Scanner(System.in);
        int choice = 0;
        String[] subjects = new String[10];
        int grades[] = new int[10];
        double sum = 0.0;
        Grades method = new Grades();

    do
    {
        System.out.println("1\. Enter a course name and a grade");
        System.out.println("2\. Display all grades");
        System.out.println("3\. Calculate the average grade");
        System.out.println("4\. Exit program");

        choice = scan.nextInt();

        if ( choice == 1 ) 
        {
            Scanner scansubjects = new Scanner(System.in);
            Scanner scangrades = new Scanner(System.in);

            System.out.println("Enter 10 subjects and their corresponding grades:");
            System.out.println();

            int i = 0;

            for( i = 0; i < 10; i++ )
            {
                System.out.println("Subject:");

                String temp = scansubjects.nextLine();
                subjects[i] = temp.toLowerCase();

                System.out.println("Grade:");

                grades[i] = scangrades.nextInt();

                if( i == ( subjects.length - 1 ) )
                {
                    System.out.println("Thank you!");
                    System.out.println();
                }
            }
        }

        if ( choice == 2 )
        {
            System.out.println("Subjects" + "\tGrades");
            System.out.println("---------------------");

            for(int p = 0; p < subjects.length; p++)
            {

                System.out.println(subjects[p] + "\t" + "\t" + grades[p]);
            }
        }

        if ( choice == 3 )
        {   
              System.out.println("Total of grades: " + getSum(grades));
              System.out.println("Count of grades: " + grades.length);
              System.out.println("Average of grades: " + getAverage(grades));
              System.out.println();
        }

    } while ( choice != 4);

    } 

 } 
```

第二类是：

```
public class Grades {

    public static double getAverage(int[] array)
    {
        int sum = 0;
        for(int i : array) sum += i;
        return ( ( double ) sum )/array.length;
}

    public static double getSum(int[] array)
    {
        int sum = 0;
        for (int i : array) 
        {
         sum += i;
        }
        return sum;
    }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:23:07.453

你不需要这个，因为它只有静态方法：

```
Grades method = new Grades(); // <-- delete this line 
```

要调用静态方法，它们必须以类名开头，如下所示：

```
System.out.println("Total of grades: " + Grades.getSum(grades));
System.out.println("Count of grades: " + grades.length);
System.out.println("Average of grades: " + Grades.getAverage(grades)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:22:05.050

您的代码无法编译。不要尝试执行非编译代码。在执行代码之前修复所有编译错误。它们在 Eclipse IDE 的“问题”视图中可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T15:22:52.620

您需要致电`Grades.getSum`并`Grades.getAverage`获得正确的结果。另外，不要忘记使用类开头的`Grade`命令导入类。`import Grades;``UserInteraction`

# django - django 活塞在使用模型时发出响应时检测到循环参考

> ID：13219855
> 
> 赞同：1
> 
> 时间：2012-11-04T15:19:44.110
> 
> 标签：django, django-piston

在为 django 配置活塞时遇到问题，每次我指定它运行的模型名称时，都会出现以下错误

```
RuntimeError at /en/vehicle/api/car.json

Circular reference detected while emitting response

Request Method:     GET
Request URL:    http://127.0.0.1:8000/en/vehicle/api/car.json
Django Version:     1.4.1
Exception Type:     RuntimeError
Exception Value:    

Circular reference detected while emitting response

Exception Location:     /Users/mo/Projects/pythonic/gar-env/lib/python2.7/site-packages/piston/emitters.py in _any, line 109
Python Executable:  /Users/mo/Projects/pythonic/gar-env/bin/python 
```

下面是我的handelrs.py

```
from piston.handler import BaseHandler
from piston.utils import rc, throttle, translate_mime
from django.core.paginator import Paginator, PageNotAnInteger, EmptyPage
from django.core.urlresolvers import reverse
from django.db.models.loading import get_model
from models import (ModelLookUpI18n as ModelLookup, Image)
from forms import CarForm, ModelLookUpForm, ModelLookUpI18nForm
from django.http import HttpResponse
import logging, json, os
from piston.utils import validate
from django.conf import settings
from django.utils.translation import ugettext as _

class CarHandler(BaseHandler):
    """
    CarHandler

    """
    allowed_methods = ('GET', 'POST', 'PUT', 'DELETE')
    model           = Car
    fields          = ('id', 'model', 'description', 'primary_image', 'color', 'mileage', 'view_count', 'asking_price')

    def read(self, request):
        params = dict()
        params.update({'status' : self.model.STATUS_ACTIVE})

        return self.model.objects.filter(**params).order_by('created_at') 
```

在 url.py 这是我的代码

```
from django.conf.urls import *
from handlers import CarHandler
from piston.resource import Resource

car_resource            = Resource(CarHandler)
# API URL schema
urlpatterns += patterns('',
    # car API
    url(r'^api/car\.(?P<emitter_format>.+)',                        car_resource,  name='vehicle-api-car'),
) 
```

错误出现在运行时，我找不到问题的解决方案。我试图从 CarHandler 类中删除模型和字段属性，使其工作。我厌倦了使用 get_model 并在运行时加载，但同样，我会得到相同的运行时错误。

请指教？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T08:46:20.340

“模型”是外键引用吗？活塞是否有可能在输出中包含“模型”，它本身可能引用回它所包含的汽车模型？

# jquery - jQuery打破.each

> ID：13219856
> 
> 赞同：0
> 
> 时间：2012-11-04T15:19:50.423
> 
> 标签：jquery, jquery-ui, jquery-plugins, jquery-selectors

我有一个表单，他包含百分比数据的文本字段，在点击提交时我想使用类选择器验证所有百分比，并检查无效百分比打破每个和焦点字段，但“返回 false”不会打破这个

我的代码：

```
$('#enviarquestionario').click(function(event){
    event.preventDefault();

        $('input.percent').each(function(){
            valor = $(this).val();
            if(isNaN(valor) || valor > 100 || valor < 0 ){
                alert('Preencha corretamente os campos de porcentagem com valores entre 0 e 100');
                $(this).focus();
                return false;
            }else{
                $('#questionarioparticipacao').submit();
            }
        });

    return false;
}); 
```

不知何故，表单正在提交。

```
 #enviarquestionario is a ancor 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:28:16.300

试试这个：

```
$('#enviarquestionario').click(function(event){
    event.preventDefault();
    var isError = false;

    $('input.percent').each(function(){
        valor = $(this).val();
        if(isNaN(valor) || valor > 100 || valor < 0 ){
            alert('Preencha corretamente os campos de porcentagem com valores entre 0 e 100');
            $(this).focus();
            isError = true;
            return false;
        }
    });

    if(!isError){ $('#questionarioparticipacao').submit(); }

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:27:52.323

考虑更改代码以使用设置为 false 的有效标志，即使一次验证失败：

```
$('#enviarquestionario').click(function(event){

        event.preventDefault();

        var valid = true; // initially set to true

        $('input.percent').each(function(){
            valor = $(this).val();
            if(isNaN(valor) || valor > 100 || valor < 0 ){
                alert('Preencha corretamente os campos de porcentagem com valores entre 0 e 100');
                $(this).focus();
                valid = false; // set to false even if one fails
                return false;
            }
        });

        // submit only if all validations pass
        if(valid === true) $('#questionarioparticipacao').submit();

        return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T15:34:13.150

只是我的版本。这实际上会像您想要的那样破坏 .each 。

```
$('#enviarquestionario').click(function(event){
    event.preventDefault();
        var breakerbreaker = false;
        $('input.percent').each(function(){
            if(breakerbreaker){ return false; }

            valor = $(this).val();
            if(isNaN(valor) || valor > 100 || valor < 0 ){
                alert('Preencha corretamente os campos de porcentagem com valores entre 0 e 100');
                $(this).focus();
                breakerbreaker = true;
        });

    if(!breakerbreaker){ $('#questionarioparticipacao').submit(); }    
    return false;
}); 
```

# python - 解析python设置文件

> ID：13219857
> 
> 赞同：4
> 
> 时间：2012-11-04T15:20:04.167
> 
> 标签：python

我需要编写一个 python 脚本来读取和解析设置 python 文件。setup 包含一些变量和函数调用。

例子：

```
setup.py
x = 5
mylist [ 1, 2, 3]
myfunc(4)
myfunc(5)
myfunc(30)

main.py
.
parse_setup('setup.py')
. 
```

我想解析设置文件并“查看”定义了哪些变量以及调用了哪些函数。由于安装文件是用python编写的，我认为最简单的方法是动态导入安装文件（动态地，因为安装文件路径是main的输入）。

问题是导入失败`myfucn()`，因为调用的`setup.py`，未定义。

有没有办法让我拦截`myfunc()`调用`setup.py`并执行我自己定义的函数`main.py`？

如果我要执行的函数是成员函数怎么办？

谁能想到一种更好的方法来提取设置文件中的数据，我真的不想逐行阅读。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:51:06.707

如果您的`setup.py`文件包含这些 Python 语句：

```
x = 5
mylist = [ 1, 2, 3]
y = myfunc(4)
z = myfunc(x) 
```

你可以做这样的事情`main.py`来找出它定义了什么：

```
def myfunc(n):
    return n**2

def parse_setup(filename):
    globalsdict = {'__builtins__': None, 'myfunc': myfunc}  # put predefined things here
    localsdict = {}  # will be populated by executed script
    execfile(filename, globalsdict, localsdict)
    return localsdict

results = parse_setup('setup.py')
print results  # {'y': 16, 'x': 5, 'z': 25, 'mylist': [1, 2, 3]} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:34:53.790

如果 setup.py 文件是有效的 python，您可以使用 execfile() 或 import()。

execfile 接近您似乎正在寻找的内容。

安装程序.py

```
def function(): print "called" 
```

主文件

```
execfile("setup.py")
function() # will print called 
```

[http://docs.python.org/2/library/functions.html#execfile](http://docs.python.org/2/library/functions.html#execfile)

再次阅读您的问题后，一个更好的例子可能是：

安装程序.py

```
func("one")
func("two") 
```

主文件

```
def func(s): print s
execfile("setup.py") 
# will print:
# one
# two 
```

请注意，必须在定义函数后完成文件加载。

# java - 带有单选按钮的表单中的下一步和后退按钮

> ID：13219859
> 
> 赞同：4
> 
> 时间：2012-11-04T15:20:08.717
> 
> 标签：java, jsp

我想从数据库中提出 10 个问题，并在 html 表单上放置一个计时器。当我单击下一个按钮时，将一一显示问题，将显示下一个问题，当单击返回按钮时，应显示上一个问题

```
<form name="form1" bgcolor="red" action="resultbyme.jsp" method="POST">
    <div style="background-color:orange;"> 
        <% qno=n+1;
        ques=rs.getString(4);
        op1=rs.getString(5);
        op2=rs.getString(6);
        op3=rs.getString(7);
        op4=rs.getString(8);
        %>
        <br>Q.<%=qno%>--><%=ques%></br>
        <input type="radio" name="opt<%=qno%>" value="<%=op1%>" /><%=op1%><br>
        <input type="radio" name="opt" value="<%=op1%>" /><%=op2%><br>
        <input type="radio" name="opt" value="<%=op1%>" /><%=op3%><br>
        <input type="radio" name="opt" value="<%=op1%>" /><%=op4%><br>
        <%
            }
        } //end for
    }
    catch(SQLException e)
    {
        out.println("erorr in sql ") ;                        
    }
        %>
        <div bgcolor="blue"><input type="submit" value="submit" name="submit test" /></div>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:26:50.493

您可以将所有内容加载到不同的 div 中，并使用 JavaScript 一个接一个地显示它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:51:51.610

您将有一个通用标题，它将处理您的计时器。您的 html 正文将根据用户单击下一步或返回而动态更改（为此使用 ajax）。

更好地维护隐藏在下一步和后退按钮中的问题编号。因此，在 AJAX 调用中，您可以获得问题编号并传递给服务器以获取该特定问题。您可以在定义的 span 或 div 标签中显示它。

```
 <div id="questionId"> My question is here  </div> 
```

在javascript里面

```
 function loadQuestion(questionNo){

    $.ajax({
     type: "POST",
      url: 'projectName/showQuestion.action',
      data: "quesionNo="+questionNo
      success: function(data) {

        document.getElementById('questionId').innerHTML =data;

      }
    });

 } 
```

这只是一个指南，您可以根据自己的方法进行更改

# ios - 捏缩放自定义 UIView：线条和文本像素化，需要重新光栅化

> ID：13219862
> 
> 赞同：0
> 
> 时间：2012-11-04T15:20:42.050
> 
> 标签：ios, uiview, pinchzoom

我有一个自定义 UIView。在这个视图中，我重写了 drawRect 来绘制一些路径和一些文本。当检测到点击时，视图正在放大

```
 - (void)tapDetected:(UITapGestureRecognizer *)sender {
     float zoom = 3.;
     sender.view.transform = CGAffineTransformScale(sender.view.transform, zoom, zoom);
     ...
 } 
```

缩放工作正常，但是当我放大时线条和文本变得像素化。我希望线条宽度和文本大小保持不变，即重新光栅化，所以我在上述方法的末尾插入了一个 setNeedsDisplay，但是这没有效果，不工作。

有什么帮助吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:31:47.347

尝试更改相关`contentScale`图层的 。这对我的路径有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-09T13:18:28.647

我的地图查看器遇到了类似的问题，所以我制作了一个独立的演示项目。放大时我得到了非常重的抗锯齿。基本上，要在放大时重新光栅化，你必须这样玩`rasterizationScale`：

```
 sublayer.rasterizationScale = scale;
    sublayer.contentsScale = scale; 
```

示例项目和自述文件在这里：[https ://bitbucket.org/robvanderveer/scrollviewdemo](https://bitbucket.org/robvanderveer/scrollviewdemo)

# c# - 无法用网络浏览器填充框

> ID：13219863
> 
> 赞同：0
> 
> 时间：2012-11-04T15:20:42.270
> 
> 标签：c#, vbulletin

这是我要填写的框：

```
<textarea name="message" id="vB_Editor_001_textarea" rows="10" cols="60" style="display: block; width: 380px; height: 250px; " tabindex="1" dir="ltr"></textarea> 
```

它是论坛中的一个 PM 框，它是具体的正文，所有其他字段都可以填写：

```
wb1.Document.GetElementById("recipients").SetAttribute("value", "HAHA");
wb1.Document.GetElementById("title").SetAttribute("value", "HAHA"); 
```

但我找不到填补这个的方法。

论坛是vBulletin。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:48:35.967

看起来盒子正在获得一个自动生成的 ID。尝试使用您从中看到的 id ( ) 访问它`vB_Editor_001_textarea`，否则，尝试不通过 id 而是通过名称来查找它？

```
document.getElementByName() 
```

# iphone - 如何在不创建额外图层的情况下将多个图像绘制到 CALayer 中？

> ID：13219867
> 
> 赞同：3
> 
> 时间：2012-11-04T15:21:15.463
> 
> 标签：iphone, objective-c, uiimageview, uiimage, calayer

我正在创建一个包含多个堆叠在一起的图像的应用程序。应用程序经常移动这些图像，所以我试图将它们打包到一个大容器中。移动这个容器（当然）会导致应用程序滞后。

我已经尝试将多个 s 打包`UIImageView`成一个`UIView`（不是一个好主意），并将多个`CALayer`s 和一个 Image 打包成一个大的`CALayer`（仍然没有帮助）。

所以我正在寻找一种将多个图像（如拼图）粘贴到一个中的选项`CALayer`。我不需要重新定位这些图像，因为我只是在移动 main `Layer`.

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T13:35:14.670

好吧，一种简单的方法是自己绘制它们：拥有自己的 CALayer 自定义子类并实现 drawContext

设置 needsDisplayOnBoundsChange 所以你告诉 CA 你需要自己画东西

# c# - 播放存储在数据库 MVC 中的视频 URL 链接

> ID：13219871
> 
> 赞同：1
> 
> 时间：2012-11-04T15:21:40.360
> 
> 标签：c#, html, mysql, asp.net-mvc-3, razor

嗨，我目前正在 MVC3 中开发一个 Web 应用程序。我创建了一个名为 PlayLink 的数据库，并将媒体播放器倾斜 www.leanbackplayer.com 集成到视图中。

在我看来，用户可以向数据库添加 URL 链接，并且该链接出现在主视图中。我现在需要将播放器链接到存储在数据库中的 url，以便在单击 url 时，关联的 url 媒体文件将在播放器中播放。

这是我的 Lean Back 播放器代码，它目前只播放预编码的 URL。

```
 <div class="leanback-player-video">
 <video width="500" height="250" preload="auto" controls    p oster="http://dl.dropbox.com/u/46705018/sintel.mp4.mp4">
     <source src="http://dl.dropbox.com/u/46705018/sintel.mp4.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />

    <object class="leanback-player-flash-fallback" width="500" height="250" type="application/x-shockwave-flash" data="http://player.longtailvideo.com/player.swf">
        <param name="movie" value="http://player.longtailvideo.com/player.swf" />
        <param name="allowFullScreen" value="true" />
        <param name="wmode" value="opaque" />
        <param name="bgcolor" value="#000000" />
        <param name="flashVars" value="controlbar=over&amp;file=http://dl.dropbox.com/u/46705018/sintel.mp4.mp4
                &amp;image=http://dl.dropbox.com/u/46705018/sintel.mp4.mp4" />
    </object>

    <div class="leanback-player-html-fallback" style="width: 500px; height: 250px;">
        <img src="http://dl.dropbox.com/u/46705018/sintel.mp4.mp4" width="500" height="250" alt="Poster Image" 
            title="No HTML5-Video playback capabilities found. Please download the video(s) below." />
        <div>
            <strong>Download Video:</strong>
            <a href="http://dl.dropbox.com/u/46705018/sintel.mp4.mp4">.mp4</a>
        </div>
    </div>
  </video>
</div> 
```

MVC模型结构：

```
 using System;
 using System.Data.Entity;
 using System.Collections.Generic;
 using System.Linq;
 using System.Web;

 namespace ProjectNCI.Models
  {
    public class PlayLink
   {
    public int ID { get; set; }
    public string Title { get; set; }
    public DateTime Date { get; set; }

   }
   public class PlayLinkDBContext : DbContext
   {
       public DbSet<PlayLink> PlayLink { get; set; }
   }
} 
```

# asp.net-mvc-3 - asp.net mvc 4 个选项卡

> ID：13219874
> 
> 赞同：13
> 
> 时间：2012-11-04T15:22:08.690
> 
> 标签：asp.net-mvc-3, razor, asp.net-mvc-4

我正在使用 Visual Studio 2010 ASP.Net MVC4（引擎视图 Razor）开发一个项目，需要制作一个选项卡。我定义了这个脚本和 css：

```
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.20.min.js")" type="text/javascript"></script>
<script type="text/javascript">
$(function () {
$("#tabs").tabs();
});
</script> 
```

它还定义了选项卡的 html 格式：

```
<div id="tabs"> ..... 
```

但是当执行不显示标签时，我该如何解决这个问题。只显示格式 html，这个：

指数

标签页眉 1

标签页眉 2

标签页眉 3

Tab 1 的内容在这里。

Tab 2 的内容在这里。

Tab 3 的内容在这里。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-05T05:21:11.067

这是 Jquery Tabs 的[jsfiddle](http://jsfiddle.net/yrshaikh/puXu5/)。

**第 1 步：导入**

```
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.4.4.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script> 
```

**第 2 步：HTML 代码**

在“li”标签中，您需要定义选项卡标题，并且每个选项卡标题都存在一个选项卡内容 div，下面的代码非常自我解释。

```
<div id="tabs">

<ul>
    <li><a href="#tabs-1">Tab Header 1</a></li>
    <li><a href="#tabs-2">Tab Header 2</a></li>
    <li><a href="#tabs-3">Tab Header 3</a></li>
</ul>

<div id="tabs-1">
Content for Tab 1 goes here.<br/>
Lorem ipsum dolor sit amet, consectetuer adipiscing elit,
sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
</div>

<div id="tabs-2">
Content for Tab 2 goes here.<br/>
Lorem ipsum dolor sit amet, consectetuer adipiscing elit,
sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
</div>

<div id="tabs-3">
Content for Tab 3 goes here.<br/>
Lorem ipsum dolor sit amet, consectetuer adipiscing elit,
sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
</div>

</div> 
```

**第 3 步：Final Touch – 对 tabs() 的 Jquery 调用**

```
<script type="text/javascript">
    $(function () {
        $("#tabs").tabs();
    });
</script> 
```

**输出：**

![在此处输入图像描述](../Images/0a6939bc0f0fd81e5a5dfeb038fe48ae.png)

[来源](http://yassershaikh.com/introduction-to-jquery-ui-tab-with-asp-net-mvc/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-05T20:28:37.030

如果您使用 ASP.net MVC4 然后 config _Layout.cshtml 将此行添加到 Head html

```
@Styles.Render("~/Content/css")    
@Styles.Render("~/Content/themes/base/css")
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jqueryui")
@Scripts.Render("~/bundles/modernizr") 
```

并从正文（html）中删除这一行

```
@Scripts.Render("~/bundles/jquery") 
```

并执行程序并显示选项卡

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-12-21T07:18:22.013

Bootstrap 3.x 解决方案：

```
<ul class="nav nav-tabs">
    <li class="active">
        <a href="#tab_1" data-toggle="tab">Tab Header 1</a>
    </li>
    <li>
        <a href="#tab_2" data-toggle="tab">Tab Header 2</a>
    </li>
    <li>
        <a href="#tab_3" data-toggle="tab">Tab Header 3</a>
    </li>
</ul>
<div class="tab-content">
    <div class="tab-pane fade active" id="tab_1">
        <p>Content for Tab 1 goes here.</p>
    </div>
    <div class="tab-pane fade" id="tab_2">
        <p>Content for Tab 2 goes here.</p>
    </div>
    <div class="tab-pane fade" id="tab_3">
        <p>Content for Tab 3 goes here.</p>
    </div>
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-12T03:03:27.357

只是为了添加 Bootstrap 3.x 解决方案。*我在使用class= **"tab-pane fade active"** id="tab_1"*时遇到了问题 ，tab_1中的条目在页面加载时不会显示。

相反，我删除了 tab_1 中的**淡入淡出**（见下文）

```
<div class="tab-pane active" id="tab_1">
    <p>Content for Tab 1 goes here.</p>
</div> 
```

或将其替换为*class="tab-pane fade active **in** "*

它对我有用。

# ios - 禁用绘图视图的多点触控

> ID：13219876
> 
> 赞同：0
> 
> 时间：2012-11-04T15:22:12.050
> 
> 标签：ios, uiview, touch

我有一个我正在画线的视图。当我用两个或更多手指画一条线时，会有一种奇怪的行为。这就是为什么我想在这个视图上禁用多点触控。

我试过了 ：

```
self.drawingView.multipleTouchEnabled = NO;
self.drawingView.exclusiveTouch = YES; 
```

但是没有影响。我的 touches 方法仍然被调用。理想情况下，我想当我尝试用两根手指画画时，它什么也不做。有解决办法吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T16:40:25.403

在您的触摸方法（开始/移动）中检查屏幕上有多少触摸，并且只有一次触摸，处理它，否则将其传递。示例`touchesMoved`：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{

if ((touches.count == 1) && ([event allTouches].count == 1)) {
   // handle single finger touch moves here
    ....
} else {
    // If more than one touch, pass it along
    [super touchesBegan:touches withEvent:event];

} 
```

}

# django - Django Avatars 通过本地（django-avatar）上的绝对文件系统路径引用图像

> ID：13219879
> 
> 赞同：1
> 
> 时间：2012-11-04T15:22:23.953
> 
> 标签：django

我正在尝试在我的 Django 安装中安装 django-avatar。我一生无法弄清楚的是 MEDIA_ROOT 和 MEDIA_URL 路径哪里出错了。

头像目前正在上传到我本地的正确位置：**<* project *>/media/avatars/...**

但是，当我点击**/avatars/change/**时，正在使用本地绝对路径提供图像：

/Users/<* 用户名*>/<* project_path *>/media/avatars/....jpg

在我的 settings.py 中，我设置了以下变量：

```
PROJECT_PATH = os.path.realpath(os.path.dirname(__file__))
MEDIA_ROOT = os.path.join(PROJECT_PATH, 'media')
MEDIA_URL = '/media/'
AVATAR_STORAGE_DIR = MEDIA_ROOT + '/avatars/' 
```

在我的 urls.py 中，我有：

```
if settings.DEBUG:
    urlpatterns += patterns('',
        url(r'^media/(?P<path>.*)$', 'django.views.static.serve', {
            'document_root': settings.MEDIA_ROOT,
        }),
        url(r'^static/(?P<path>.*)$', 'django.views.static.serve', {
            'document_root': settings.STATIC_ROOT,
        }),
    ) 
```

我认为问题一定出在应用程序级别，而不是在我的项目设置中。如果有人可以提供帮助，那就太棒了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:16:24.857

根据我的经验，这是使用开发服务器时的标准行为。Django 开发服务器正在为静态文件提供服务，并从 MEDIA_ROOT（完整的本地路径）提供服务。

部署时，静态文件应与您的 Web 服务器一起提供，并且 URL 将反映您期望的 MEDIA_URL。

可能值得阅读 Django 的关于[管理静态文件](https://docs.djangoproject.com/en/dev/howto/static-files/)的文档。

# php - 检查两个字符串是否为空不起作用

> ID：13219886
> 
> 赞同：0
> 
> 时间：2012-11-04T15:23:07.813
> 
> 标签：php, ajax

我有一个条件 if 检查 ajax（和 php）正在执行提交工作的网络表单。

```
if(empty($name) or empty($message))
{
do something
} 
```

如果 2 个字符串之一为空，则上述内容有效。我想添加到上面

```
 or (empty($name) and empty($message)) 
```

用于检查两个字符串是否为空，但在某种程度上它不起作用！我想确保所有 3 个 senarios 都被覆盖，名称为空或消息为空或两者均为空。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:25:11.730

将“或”替换为“||”。例子：

```
if (empty($name) || empty($message))
{
    // Do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:25:41.737

这将检查两者`$name`和`$message`不为空，而不是 true

```
if($name != '' &&  $message != '') {
  //Do something
} 
```

如果你使用它，这将检查是否有任何 1 字段为空而不是条件为真

```
if($name == '' || $message == '') {
  //Do something
} 
```

如果你使用这个，如果两者都是空的，这将是真的

```
if($name == '' && $message == '') {
  //Do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T15:25:46.167

`or`表示“如果任一条件为真”，而不是“如果恰好有一个条件为真”。

您已经拥有的代码满足了您的要求。

# macos - 如何使用 Core Audio 设置/获取音量级别？

> ID：13219891
> 
> 赞同：2
> 
> 时间：2012-11-04T15:23:58.473
> 
> 标签：macos, audio, core-audio, volume

我希望能够使用 Core Audio 获取和设置系统音量。我遵循了另一个线程上的代码： [objective c audio Meter](https://stackoverflow.com/questions/3170002/objective-c-audio-meter)

`AudioHardwareServiceHasProperty`但是，我查找该属性的调用`kAudioHardwareServiceDeviceProperty_VirtualMasterVolume`返回 false。为什么会发生这种情况，我该如何解决？我应该采取什么方法来获取和设置 Core Audio 的系统音量级别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T06:26:09.417

您是否尝试过 kAudioDevicePropertyVolumeScalar：

```
UInt32 channel = 1; // Channel 0  is master, if available
AudioObjectPropertyAddress prop = { 
    kAudioDevicePropertyVolumeScalar, 
    kAudioDevicePropertyScopeOutput,
    channel 
};

if(!AudioObjectHasProperty(deviceID, &prop))
    // error

Float32 volume;
UInt32 dataSize = sizeof(volume);
OSStatus result = AudioObjectGetPropertyData(deviceID, &prop, 0, NULL, &dataSize, &volume);

if(kAudioHardwareNoError != result)
    // error 
```

# php - PHP 删除除字母和连字符 (-) 之外的所有内容

> ID：13219894
> 
> 赞同：3
> 
> 时间：2012-11-04T15:24:04.027
> 
> 标签：php, regex, filter

我正在制作一个表格，要求输入用户的名字和姓氏，但我不希望他们输入

```
$heil4 
```

我希望他们进入

```
Sheila 
```

我知道如何过滤除字母以外的所有内容，但我知道有些名字可以有

```
Sheila-McDonald 
```

那么，除了字母和连字符之外，我如何从字符串中删除所有内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T15:39:19.457

只需使用

```
$s = preg_replace("/[^a-z-]/i", "", $s); 
```

或者如果你想将一些非 ascii 字符转换为 ascii，例如`Jean-Rémy`to `Jean-Remy`，那么使用

```
$s = preg_replace("/[^a-z-]/i", "", iconv('UTF-8', 'ASCII//TRANSLIT//IGNORE', $s)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T15:25:14.723

`$new = preg_replace('#[^A-Z-]#iu', '', $data);`

但不是删除字母（从而修改用户的输入），而是更好地验证它并在输入无效时显示错误。这样用户就会知道他输入的正是你所拥有的值

`if(!preg_match('#[A-Z-]#iu', $data)) echo 'invalid';`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T15:40:11.020

与其一无所有，不如找点乐子。这样一个名称主要由您可以解码的数字组成；p

```
$name = '$h3il4-McD0nald';

$find    = array(0,1,3,4,5,6,7,'$');
$replace = array('o','l','e','a','s','g','t','s');
$name = str_replace($find,$replace,$name);

//Sheila-McDonald
echo ucfirst(preg_replace('/[^a-z-]/i', '', $name)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T15:49:18.070

使用它去除所有非字母数字字符，不包括非拉丁字符和[规定的](http://www.php.net/manual/en/regexp.reference.escape.php) [标点符号](http://www.php.net/manual/en/regexp.reference.unicode.php)。

`$strtochange= preg_replace("/[^\s\p{Pd}a-zA-ZÀ-ÿ]/",'',$strtochange);`

注意：这将`$heil4`变成`heil`.

# jquery - MVC 3：使用 jquery 刷新页面后，页面模型未在部分视图中更新

> ID：13219898
> 
> 赞同：1
> 
> 时间：2012-11-04T15:24:41.260
> 
> 标签：jquery, asp.net-mvc-3

我有一个奇怪的问题。我正在尝试使用 jquery 在 MVC 中执行自定义分页。我这样做是通过将我的网格放在父页面的部分视图中。当我在第一次加载后更新视图时，我的模型值不会在连续调用中更新。有人可以建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-02T11:53:42.713

我认为你需要参考这篇文章。这也可能与您的问题有关。

[在 MVC 3 中禁用局部视图上的缓存](https://stackoverflow.com/questions/8786942/disable-caching-on-a-partial-view-in-mvc-3/25620816#25620816)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:35:44.407

这可能是一个缓存问题，尝试通过将此属性放在控制器上来禁用它：

```
[OutputCache(NoStore = true, Duration = 0, VaryByParam = "*")] 
```

禁用 javascript 中所有 ajax 调用的缓存：

```
$.ajaxSetup({ cache: false }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T16:00:10.063

我将抓住术语网格。我假设您已经使用 html/razor/javascript 等构建了某种网格。然后将其放置在局部视图中。现在，您希望在执行更新后刷新该网格。

我已经为使用 ASP.NET MVC 3 和 jQuery-UI 插件 jqGrid 以网格格式显示数据的问题提供了一个全面的解决方案。

[ASP.Net MVC 3 JQGrid](https://stackoverflow.com/questions/5092866/asp-net-mvc-3-jqgrid)

该解决方案基于 ajax，并提供完整的 CRUD 功能。如果需要，您可以将网格转换为只读网格。我没有任何关于未更新模型值的问题。

# javascript - 如何使用 musatche 模板呈现线程评论？

> ID：13219900
> 
> 赞同：1
> 
> 时间：2012-11-04T15:24:47.293
> 
> 标签：javascript, mustache

我正在尝试为我正在构建的类似博客的系统实现线程评论。注释可能如下所示（JavaScript）：

```
{
    text: "whatever",
    author : "name"
    children: [ /* more comments*/ ]
} 
```

请注意，子评论本身可能有子评论。

我有一个小胡子模板，如下所示：

```
{{#comments}}
    <li><div class='comment'>
        {{author}} wrote {{text}}
    </div></li>
{{/comments}} 
```

有什么方法可以使用此方案呈现线程注释吗？胡子是无逻辑的是否意味着我不能用它来实现这样的东西？

FWIW 我正在使用[mote.js](http://satchmorun.github.com/mote/)库来呈现模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T06:14:25.257

这非常适合局部。所以你的页面模板看起来像这样：

```
...

<ul>
  {{# comments }}
    {{> comment }}
  {{/ comments }}
</ul>

... 
```

您的部分评论看起来像这样：

```
<li>
  <div class="comment">

    ... commentystuff

    <ul>
      {{# children }}
        {{> comment }}
      {{/ children }}
    </ul>
  </div>
</li> 
```

而且由于看起来您正在使用 JS，如果没有子注释，您甚至可以有条件地隐藏整个嵌入式 UL，只需将其包装在一个`{{# children.length }}`部分中：

```
<li>
  <div class="comment">

    ... commentystuff

    {{# children.length }}
      <ul>
        {{# children }}
          {{> comment }}
        {{/ children }}
      </ul>
    {{/ children.length }}
  </div>
</li> 
```

# python - 更改 tkinter OptionMenu 中的默认图标？

> ID：13219901
> 
> 赞同：16
> 
> 时间：2012-11-04T15:24:51.527
> 
> 标签：python, tkinter, optionmenu

我正在尝试从 tkinter OptionMenu 中删除默认的“box like”图标，并将其替换为我自己的图像文件。下面是我必须迄今为止的代码。它正在工作，但我必须添加最后一行才能显示箭头图像并让 OptionMenu 起作用。但是，箭头图像总是在文本之后而不是在 OptionMenu 的最右侧，并且粘性不会被应用，因此宽度 = 140。我正在使用 Python 2.6。

将图像向右移动的任何建议？

![默认](../Images/8eef64833ffa7e6f7b543244f0b1c105.png) ![我得到了什么](../Images/4cb559834cae9ee7604ca08c769029ee.png)

```
...
arrow = PhotoImage(file='arrow.gif')
om = OptionMenu(root,myVar,*myOptList)
om.grid(sticky=W+E,padx=5,pady=5)
om.config(indictoron=0,compound='right',image=arrow,width=140)
om.image=arrow
... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-03-22T22:46:50.630

您可以改用[**`ttk.Combobox`**](https://docs.python.org/2/library/ttk.html#ttk-combobox)小部件：

```
om = Combobox(root, values=*myOptList)
om.set(myVar)
om.grid(sticky=W + E, padx=5, pady=5)
om.config(compound='right', width=140) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-07-24T08:00:30.223

您可以禁用指示器，然后使用您自己的指示器图像。进一步调整适合的位置。检查下面的示例片段：

```
from Tkinter import*
import PIL
from PIL import ImageTk, Image

class MyOptionMenu(OptionMenu):
    def __init__(self, master, status, *options):
        self.var = StringVar(master)
        self.img = ImageTk.PhotoImage(Image.open("...")) #replace with your own indicator image
        self.var.set(status)
        OptionMenu.__init__(self, master, self.var, *options)
        self.config(indicatoron=0, image = self.img, font=('calibri',(10)),bg='white',width=12)
        self['menu'].config(font=('calibri',(10)),bg='white')

root = Tk()
mymenu = MyOptionMenu(root, 'Select status', 'a','b','c')
mymenu.pack()
root.mainloop() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-15T02:22:26.690

您可以关闭指示器，*而不*使用该`compound`属性。将箭头创建为带有图像且没有边框或文本的标签。然后，您可以使用`place`将标签放置在按钮的最右侧（使用`relx`属性）。这才是`place`真正擅长的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-07T21:23:03.427

那行不通，很遗憾，我看不到一个简单的解决方案。这里的主要问题是，OptionMenu 是一个复合小部件。它是 Menubutton 的后代（具有讽刺意味的是，它在 tkinter 源代码中被标记为已弃用/过时）并包含一个菜单小部件。

Afaik 您正在使用的图像选项与标签文本打包在一起，并且不会通过您的布局配置尝试“分离”。更理智的方法应该是影响您使用禁用的指标小部件/表示`IndicatorOn=0`。但是那里也没有运气，因为我只是无法弄清楚指标到底是什么......

顺便说一句，它看起来像一个可怕的黑客：

```
class OptionMenu(Menubutton): 
"""OptionMenu which allows the user to select a value from a menu.""" 
    def __init__(self, master, variable, value, *values, **kwargs):
    ...
    #'command' is the only supported keyword  <--- lol?! WTF?! why?
              callback = kwargs.get('command') 
              if kwargs.has_key('command'): 
                  del kwargs['command'] 
              if kwargs: 
                 raise TclError, 'unknown option -'+kwargs.keys()[0] # yeah sure! - unknown my a** 8-/ 
```

如果您查看 tkinter 的[来源](http://mgltools.scripps.edu/api/DejaVu/Tkinter-pysrc.html#OptionMenu)并将其与[原始](http://core.tcl.tk/tk/artifact/9745c83eec8565602f8d74610424848009ffa670). 这也是为什么必须在“初始化”之后添加第二行的原因

```
om.config(indictoron=0,compound='right',image=arrow,width=140) 
```

在真正的来源中，您可能会发现，关于按钮是某种单选按钮的最初预感并没有超出该领域，但它无助于（至少不是我）解决 tkinter 问题。:-(

对不起，我没有更好的用处……真丢脸！:(但下次我会更加努力！;-)

# entity-framework - 将给定（旧）数据库迁移到当前模型

> ID：13219903
> 
> 赞同：0
> 
> 时间：2012-11-04T15:25:04.303
> 
> 标签：entity-framework

我正在为实体框架的迁移而苦苦挣扎。以下是我计划如何使用迁移，但我没有找到有关如何完成此操作的信息：

我的用户正在使用我的软件的不同版本在他们的场所创建数据库（Sql Compact Server）。每个版本都引入了一个略有变化的 EF 模型。一旦用户更新到较新版本的软件并使用先前版本的模型打开数据库，我希望进行某种“自动迁移”将给定的数据库更新到当前模型.

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:44:31.590

使用 MigrateDatabaseToLatestVersion 数据库初始化程序。有关更多信息，请参阅此[链接](http://www.remondo.net/entity-framework-code-first-migrations-database-initializer/)。

# django - Pinax 主题引导编辑

> ID：13219904
> 
> 赞同：0
> 
> 时间：2012-11-04T15:25:09.327
> 
> 标签：django, twitter-bootstrap, pinax

Django twitter 上 Bootstrap 的 Pinax 主题缺乏明确的指南。就像您没有指定 email_host 和密码时它应该如何发送电子邮件一样。更改顶部栏以包含其他链接，例如家庭联系方式等。

我试图找到这些页面，来自 bootwatch 的其他引导主题也没有生效。你如何改变它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T16:09:10.317

电子邮件设置将与 django 相同

例子：-

```
EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'

# Host for sending e-mail.
EMAIL_HOST = 'localhost'

# Port for sending e-mail.
EMAIL_PORT = 1025

# Optional SMTP authentication information for EMAIL_HOST.
EMAIL_HOST_USER = ''
EMAIL_HOST_PASSWORD = ''
EMAIL_USE_TLS = False 
```

或者，如果您使用的是远程邮件服务器，则如下所示：-

```
EMAILS_ALLOWED = True
EMAIL_USE_TLS = True
EMAIL_HOST = 'smtp.gmail.com'
EMAIL_HOST_USER = 'no-replymysite.com'
EMAIL_HOST_PASSWORD = 'myspecialpass'
EMAIL_PORT = 587
EMAIL_SUBJECT_PREFIX = '[MySite.com]'
DEFAULT_FROM_EMAIL = 'MySite.com Auto Notification <no-reply@mysite.com>' 
```

关于关于更改主题/外观的第二个问题，我昨天在这里回答了一个类似的问题 -[如何更改 pinax(0.9a2) 模板？](https://stackoverflow.com/questions/13211233/how-to-change-the-pinax0-9a2-template/13211486#13211486)

# python - argparse：获取未定义数量的参数

> ID：13219910
> 
> 赞同：10
> 
> 时间：2012-11-04T15:25:48.763
> 
> 标签：python, argparse

我正在构建一个脚本，它使用参数来配置行为，并应读取未定义数量的文件。使用以下代码可以让我读取一个文件。有没有什么方法可以做到这一点，而不必设置另一个参数，告诉脚本应该读取多少个文件？

```
parser = argparse.ArgumentParser()
parser.add_argument("FILE", help="File to store as Gist")
parser.add_argument("-p", "--private", action="store_true", help="Make Gist private") 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-04T15:37:05.750

是的，将您的`"FILE"`行更改为：

```
parser.add_argument("FILE", help="File to store as Gist", nargs="+") 
```

这会将所有位置参数收集到一个列表中。如果没有至少一个可以操作，它也会产生错误。

查看[nargs 文档](http://docs.python.org/dev/library/argparse.html#nargs)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-04T15:41:56.537

```
import argparse

parser = argparse.ArgumentParser()

parser.add_argument('-FILE', action='append', dest='collection',
                    default=[],
                    help='Add repeated values to a list',
                    ) 
```

用法：

```
python argparse_demo.py -FILE "file1.txt" -FILE "file2.txt" -FILE "file3.txt" 
```

在你的python代码中，你可以在`collection`变量中访问这些，它本质上是一个列表，默认情况下是一个空列表；和一个列表，其中包含您提供给它的任意数量的参数。

# php - 如何根据它们是否匹配行号来填充 HTML 表格编号的行？

> ID：13219921
> 
> 赞同：1
> 
> 时间：2012-11-04T15:27:21.077
> 
> 标签：php, html, mysql, sysadmin

所以，我本周早些时候问[了这个问题，](https://stackoverflow.com/questions/13187927/php-mysql-populate-html-table-numbered-rows-based-on-whether-they-match-row-nu) *@newfurniturey*帮助了我，但现在我遇到了一个新问题：我希望能够将设备放在超过一个 U 的跨度中（因此，usize 列中的devices db table) - 一些设备可以跨越半个机柜。另外，我希望能够将设备标记为位于机柜的前部或后部，但这应该很简单，我可以弄清楚。

这是仅适用于 1U 设备的工作代码（请参阅数据库设置的旧问题）：

```
<SCRIPT LANGUAGE="JavaScript" type="text/javascript">
<!--
    function clickHandler(e)
    {
        var targetId, srcElement, targetElement;
        if (window.event) e = window.event; 
        srcElement = e.srcElement? e.srcElement: e.target;
        if (srcElement.className == "Outline")
        {
                targetId = srcElement.id + "d";
                targetElement = document.getElementById(targetId);

            if (targetElement.style.display == "none")
                {
                        targetElement.style.display = "";
                        srcElement.src = "images/minus.gif";
                    } 
            else
                {
                    targetElement.style.display = "none";
                    srcElement.src = "images/plus.gif";
                }
        }
    }
    document.onclick = clickHandler;
-->
</SCRIPT>
<noscript>You need Javascript enabled for this page to work correctly</noscript>
<?
function sql_conn()
{
    $username="root";
    $password="root";
    $database="racks";
    $server="localhost";

    @mysql_connect($server,$username,$password) or die("<h2 align=\"center\" class=\"red\">[<img src=\"images/critical.gif\" border=\"0\">] Unable to connect to $server [<img src=\"images/critical.gif\" border=\"0\">]</h2>");
    @mysql_select_db($database) or die("<h2 align=\"center\" class=\"red\">[<img src=\"images/critical.gif\" border=\"0\">] Unable to select $database as a database [<img src=\"images/critical.gif\" border=\"0\">]</h2>");
}

sql_conn();
$sql_datacenters="SELECT * FROM `datacenters`";
$result_datacenters=mysql_query($sql_datacenters);
$j=0;
echo "<table border='1' style='float:left;'>";
while ($datacenters_sqlrow=mysql_fetch_array($result_datacenters))
{
    echo "<tr><td>";
    echo "<h2 class='black' align='left'>";
    echo "<IMG SRC='images/plus.gif' ID='Out" . $j . "' CLASS='Outline' STYLE='cursor:hand;cursor:pointer'>"; // fancy icon for expanding-collapsing section
    echo " " . $datacenters_sqlrow['rack'] . ": " . $datacenters_sqlrow['cagenum'] . "</h2>"; // datacenter name and cage number
    echo "<div id=\"Out" . $j . "d\" style=\"display:none\">"; // opening of div box for section that is to be expanded-collapsed
    echo $datacenters_sqlrow['notes'] . "<br /><br />"; // datacenter notes
    $sql_cabinets="SELECT * FROM `cabinets` WHERE `datacenter` = '$datacenters_sqlrow[0]' ORDER BY `cabinetnumber` ASC";
    $result_cabinets=mysql_query($sql_cabinets);
    while ($cabinets_sqlrow=mysql_fetch_array($result_cabinets))
    {
        $sql_devices="SELECT * FROM `devices` WHERE `datacenter` = '$datacenters_sqlrow[0]' AND `cabinet` = '$cabinets_sqlrow[1]' ORDER BY `ustartlocation` ASC";
        $result_devices=mysql_query($sql_devices);
        echo "<table border='1' style='float:left;'>"; // opening of table for all cabinets in datacenter
        echo "<tr><td colspan='2' align='middle'>" . $cabinets_sqlrow[1] . "</td></tr>"; // cabinet number, spans U column and device name column
        $devices = array();
        while($row = mysql_fetch_array($result_devices)) {
            $devices[$row['ustartlocation']] = $row['devicename'];
        }
        for ($i = 0; $i < $cabinets_sqlrow[2]; $i++) // iterates through number of U in cabinet     
        {   
            $u = $cabinets_sqlrow[2] - $i; // subtracts current $i value from number of U in cabinet since cabinets start their numbers from the bottom up
            echo "<tr>";
            echo "<td width='15px' align='right'>$u</td>"; // U number
            echo (isset($devices[$u]) ? "<td width='150px' align='middle'>$devices[$u]</td>" : "<td width='150px' align='middle'>empty</td>");
            echo "</tr>";
        }
        echo "</table>"; // closes table opened earlier
    }
    echo "</td></tr>";
    echo "</div>"; // close for div box that needs expanding-collapsing by fancy java
    $j++; // iteration for the fancy java expand-collapse
}
echo "</table>";
mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:10:17.223

根据您之前的问题，每个`ustartlocation`都是唯一的（因此您可以将其用作`$devices`数组中的索引）。使用相同的概念，您可以将`$devices`数组从“`ustartlocation`到`(ustartlocation + (usize - 1))`”填充。

```
$devices = array();
while($row = mysql_fetch_array($result_devices)) {
    $endLocation = ($row['ustartlocation'] + ($row['usize'] - 1));
    for ($location = $row['ustartlocation']; $location <= $endLocation; $location++) {
        $devices[$location] = $row['devicename'];
    }
} 
```

因为您的显示循环已经遍历每个`U`并显​​示分配的设备，所以您不需要修改任何其他部分。但是，需要注意的是，设备名称将*重复*每个`U`而不是*跨越*它。为了*跨越*它，我们需要做更多的工作。

首先，我们可以将 存储`usize`在`$devices`数组中，而不是填充每个单独的位置。此外，为了防止以后进行大量额外的工作/计算，我们还将为每个额外的位置存储一个“占位符”设备。

```
while($row = mysql_fetch_array($result_devices)) {
    // get the "top" location for the current device
    $topLocation = ($row['ustartlocation'] + $row['usize'] - 1);

    // populate the real position
    $devices[$topLocation] = $row;

    // generate a list of "placeholder" positions
    for ($location = ($topLocation - 1); $location >= $row['ustartlocation']; $location--) {
        $devices[$location] = 'placeholder';
    }
} 
```

接下来，在您的显示循环中，您将检查当前位置是否是占位符（如果是，则只显示`U`并且对设备不执行任何操作；如果不是，则显示设备或“空”）。为了实现每个设备的“跨度”效果，我们将单元格设置为`rowspan`等于设备的`usize`. 如果是`1`，它将是一个单元格；`2`，它将跨越 2 行，等等（这就是为什么占位符行上的设备“什么都不做”会起作用）：

```
for ($i = 0; $i < $cabinets_sqlrow[2]; $i++) {   
    $u = $cabinets_sqlrow[2] - $i;
    echo "<tr>";
    echo '<td width="15px" align="right">' . $u . '</td>';
    if (isset($devices[$u])) {
        // we have a "device" here; if it's a "placeholder", do nothing!
        if ($devices[$u] != 'placeholder') {
            echo '<td width="150px" align="middle" rowspan="' . $devices[$u]['usize'] . '">' . $devices[$u]['devicename'] . '</td>';
        }
    } else {
        echo '<td width="150px" align="middle">empty</td>';
    }
    echo "</tr>";
} 
```

因此，可以看出 - 上面的*第*一种方法只是简单地为每个`U`跨越的设备重复设备要简单得多。但是，第二种方法将呈现更加用户友好的显示。这是您对要使用哪种方法以及您认为将来更易于维护的方法的偏好。

**更新**（代码修复和多方向跨越）
我没有意识到您的表格是按降序构建的，所以我将它`ustartlocation`作为“顶部位置”，导致错误的行/单元格移位。`ustartlocation`我已经修复了上面的代码，以便根据`usize`每个将解决该问题的设备正确设置“顶部位置” 。

或者，由于方向可能重要也可能不重要，我自定义了-populating 循环（如下）以支持创建向上*或*`$devices`向下的行跨度，完全取决于您指定的标志。您需要更改的唯一代码（如果您已经从上面自定义了显示循环）将是填充的循环：*`while``$devices`*

 *```
$spanDevicesUpwards = true;
while($row = mysql_fetch_array($result_devices)) {
    if ($row['usize'] == 1) {
        $devices[$row['ustartlocation']] = $row;
    } else {
        $topLocation = ($spanDevicesUpwards ? ($row['ustartlocation'] + $row['usize'] - 1) : $row['ustartlocation']);
        $bottomLocation = ($spanDevicesUpwards ? $row['ustartlocation'] : ($row['ustartlocation'] - $row['usize'] + 1));

        $devices[$topLocation] = $row;
        for ($location = ($topLocation - 1); $location >= $bottomLocation; $location--) {
            $devices[$location] = 'placeholder';
        }
    }
} 
```

`usize`如果跨度大于 1，则此新代码块将确定当前设备的“顶部单元格”和“底部单元格”。如果您*向上*跨越，则顶部单元格是`ustartlocation + usize - 1`; 如果你*向下*跨越，那很简单`ustartlocation`。底部位置也以这种方式确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:06:16.890

希望这对您有用............对于前/后，您可以将设备命名为 SERVER3/front 或 SERVER3/rear：

```
<SCRIPT LANGUAGE="JavaScript" type="text/javascript">
    <!--
        function clickHandler(e)
        {
            var targetId, srcElement, targetElement;
            if (window.event) e = window.event; 
            srcElement = e.srcElement? e.srcElement: e.target;
            if (srcElement.className == "Outline")
            {
                    targetId = srcElement.id + "d";
                    targetElement = document.getElementById(targetId);

                if (targetElement.style.display == "none")
                    {
                            targetElement.style.display = "";
                            srcElement.src = "images/minus.gif";
                        } 
                else
                    {
                        targetElement.style.display = "none";
                        srcElement.src = "images/plus.gif";
                    }
            }
        }
        document.onclick = clickHandler;
    -->
    </SCRIPT>
    <noscript>You need Javascript enabled for this page to work correctly</noscript>
    <?
    function sql_conn()
    {
        $username="root";
        $password="root";
        $database="racks";
        $server="localhost";

        @mysql_connect($server,$username,$password) or die("<h2 align=\"center\" class=\"red\">[<img src=\"images/critical.gif\" border=\"0\">] Unable to connect to $server [<img src=\"images/critical.gif\" border=\"0\">]</h2>");
        @mysql_select_db($database) or die("<h2 align=\"center\" class=\"red\">[<img src=\"images/critical.gif\" border=\"0\">] Unable to select $database as a database [<img src=\"images/critical.gif\" border=\"0\">]</h2>");
    }

    sql_conn();
    $sql_datacenters="SELECT * FROM `datacenters`";
    $result_datacenters=mysql_query($sql_datacenters);
    $j=0;
    echo "<table border='1' style='float:left;'>";
    while ($datacenters_sqlrow=mysql_fetch_array($result_datacenters))
    {
        echo "<tr><td>";
        echo "<h2 class='black' align='left'>";
        echo "<IMG SRC='images/plus.gif' ID='Out" . $j . "' CLASS='Outline' STYLE='cursor:hand;cursor:pointer'>"; // fancy icon for expanding-collapsing section
        echo " " . $datacenters_sqlrow['rack'] . ": " . $datacenters_sqlrow['cagenum'] . "</h2>"; // datacenter name and cage number
        echo "<div id=\"Out" . $j . "d\" style=\"display:none\">"; // opening of div box for section that is to be expanded-collapsed
        echo $datacenters_sqlrow['notes'] . "<br /><br />"; // datacenter notes
        $sql_cabinets="SELECT * FROM `cabinets` WHERE `datacenter` = '$datacenters_sqlrow[0]' ORDER BY `cabinetnumber` ASC";
        $result_cabinets=mysql_query($sql_cabinets);
        while ($cabinets_sqlrow=mysql_fetch_array($result_cabinets))
        {
            $sql_devices="SELECT * FROM `devices` WHERE `datacenter` = '$datacenters_sqlrow[0]' AND `cabinet` = '$cabinets_sqlrow[1]' ORDER BY `ustartlocation` ASC";
            $result_devices=mysql_query($sql_devices);
            echo "<table border='1' style='float:left;'>"; // opening of table for all cabinets in datacenter
            echo "<tr><td colspan='2' align='middle'>" . $cabinets_sqlrow[1] . "</td></tr>"; // cabinet number, spans U column and device name column
            $devices = array();
            $devices_size=array();
            while($row = mysql_fetch_array($result_devices)) {
                $devices[$row['ustartlocation']] = $row['devicename'];
                //$devices_size[$row['ustartlocation']+$row['usize']-1] = $row['usize'];
                  $devices_size[$row['ustartlocation']] = $row['usize']; 
            }
            $start="";
            $new="";
            for ($i = 0; $i < $cabinets_sqlrow[2]; $i++) // iterates through number of U in cabinet     
            {   
                $u = $cabinets_sqlrow[2] - $i; // subtracts current $i value from number of U in cabinet since cabinets start their numbers from the bottom up

                echo "<tr>";
                echo "<td width='15px' align='right'>$u</td>"; // U number

                $rowspan=$devices_size[$u];

                //$rowspan1=$
                if($rowspan>1)
                {
                      $start=$u;   
                      $new=$u-$rowspan+1;
                echo (isset($devices[$u]) ? "<td width='150px' align='middle' rowspan='".$rowspan."'>$devices[$u]</td>" : "<td width='150px' align='middle' rowspan='".$rowspan."'>$devices[$new]</td>");

                }
                else{
                   if($u<=$start && $u>=$new)
                   {

                   }
                   else
                   {

                echo (isset($devices[$u]) ? "<td width='150px' align='middle' >$devices[$u]</td>" : "<td width='150px' align='middle'>empty".$row."".$u."</td>");
                }

                }

                echo "</tr>";
            }
            echo "</table>"; // closes table opened earlier
        }
        echo "</td></tr>";
        echo "</div>"; // close for div box that needs expanding-collapsing by fancy java
        $j++; // iteration for the fancy java expand-collapse
    }
    echo "</table>";
    mysql_close();
    ?> 
```*

# c - 使用 malloc 和 scanf 的困难

> ID：13219923
> 
> 赞同：-1
> 
> 时间：2012-11-04T15:27:38.730
> 
> 标签：c

我很难使用`malloc`和`fscanf`。我只想读取一个文件并使用执行此代码时出现分段错误错误来打印结果。我不确定我做错了什么。如果有人指出解决方法，我将不胜感激。这是我的代码：

```
#include <stdio.h> 
#include <stdlib.h>

int main(int argc, char* argv[]){
    char* buffer = (char*)malloc(*argv[1]); // Allocate memory 
    if(buffer=NULL) // if *argv[1] is not existed, exit the program    
        exit(1);

    int n = 0;
    FILE* fp=fopen("file.txt","r"); // Open the file
    do {
        buffer[n] =fscanf(fp,"%c",buffer); // read from file until it gets EOF
    } while(buffer[n] != EOF);
    fclose(fp); // Close the file

    printf("%s",buffer); // Print the stored string

    free(buffer); // Return the memory
    return 0;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:34:31.343

知道了。这：

```
if(buffer=NULL) 
```

应该是这样的：

```
if(buffer==NULL) 
```

你*设置* `buffer`为`NULL`. 我相信你可以看到接下来会发生什么。

更一般地说，这段代码试图做几件事，而且充满了错误。您应该已经分别测试了不同的功能并在此过程中解决了这些错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:32:25.103

这似乎是错误的：

```
 char* buffer = (char*)malloc(*argv[1]); 
```

命令行参数是一个字符串，但您需要一个数字。您必须先将字符串转换为数字。

另一个问题：在你的循环中 n 永远不会增加，这就是为什么只写入缓冲区的第一个字节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T15:47:48.573

请找到固定代码和内联注释：

```
#include <stdio.h> 
#include <stdlib.h> 

int main(int argc, char* argv[])
{
  // Add the check if *argv[1] does not exist, exit the program    
  long mem_sz=strtol(argv[1],NULL,10);//Safer to atoi
  char* buffer = (char*)malloc(mem_sz); // properly allocate memory 

  //You missed the == in the NULL check.
  if(buffer==NULL) 
   exit(1);

  int n = 0; 
  FILE* fp=fopen("file.txt","r"); // Open the file
  if (fp == NULL)//Check fp too
   exit(1);

  do 
  { 
    buffer[n++]=fscanf(fp,"%c",buffer);
  } // read from file until it gets EOF and n++
  while(buffer[n-1] != EOF);//Check the last read character

  buffer[n]=0;//Put an end of string, so that printf later will work correct

  fclose(fp); // Close the file
  printf("%s\n",buffer); // Print the stored string
  free(buffer); // Return the memory
  return 0;    
} 
```

# javascript - 检查 Javascript 中的正整数：性能和安全性

> ID：13219926
> 
> 赞同：5
> 
> 时间：2012-11-04T15:27:50.547
> 
> 标签：javascript, jquery, jquery-selectors, javascript-security

我已经编写（并复制）了几行 Javascript，它很好地满足了我的目的。但我试图找出一种更好的方法（跨浏览器和更好的性能）来做到这一点。我从朋友那里复制了该`isInteger`函数，但我不明白为什么我们在以下情况下检查字符串值：

```
if (((c < "0") || (c > "9"))) return false; 
```

上述条件工作正常，但是当我将其更改为检查数值时，功能会中断。输入字段开始接受字母字符。这是我更改它时的样子：

```
if ((( c < 0 ) || ( c > 9 ) return false; 
```

我试图注释掉部分，以便您了解正在发生的事情。此代码中是否还有任何安全漏洞？我读到 1innerHTML1 方法可以打开一些安全漏洞，因此我们需要对其执行“干净”操作。因此我选择使用 jQuery 的`.html`方法（我是 JavaScript 新手）

有问题的页面：[http ://thehotdeal.net/clients/wehtmlit/index.php?order/](http://thehotdeal.net/clients/wehtmlit/index.php?order/)

```
$(document).ready(function() {
  var total = 0;
  function calcTotal() {
  /* fetching some values from PHP variables and then performing calculations.
    essentially this is multiplying number of pages by price per page
  */
  /* <![CDATA[ */
    var total_price_main_pages = ($("#pages").attr("value")) * (<?php echo $main_price; ?>),
    total_price_sub_pages = ($("#subpages").attr("value")) * (<?php echo $sub_price; ?>);
    /*  ]] > */
    $("input.calculate:checked").each(function() {
    // This happens for each checked input field
    // These are few additional otions available to the user. If selected then
    // the price stored in their "data" attribute is added to the total
      var value = $(this).attr("data");
      total += parseInt(value); 
    });
    total += (parseInt(total_price_main_pages)) + (parseInt(total_price_sub_pages));
    $("#total").html("Total: <strong>" + total + "</strong>");
  }
  // This happens when the page loads
  calcTotal();
  $("input.calculate").click(function() {
    total = 0;
    calcTotal();
  });
  // function to check if an input is positive number(s). returns true if [ 0 <= s <= 9 ]
  function isInteger(s) {
    var i;
    for (i = 0; i < s.length; i++) {
      var c = s.charAt(i);
      if (((c < "0") || (c > "9"))) return false;
    }
    return true;
  }
  // Checking the mainpage input (default value 1)
  // (valid value is greater than or equal to 1 and less than 10)
  $("#pages").keyup(function() {
    var page = $(this).val();
    // if user deletes the value in this input (blank)
    // then just display a warning message and do nothing
    if(page == ""){
      this.value = "";
      $("#pageError").html("Please enter a value equal or greater than 1.");
      return false;
    }
    // if value is less than or equal to zero then
    // then set 1 as the new value, remove the error message and call the calcTotal function
    else if(page <= 0){
      this.value =1;
      $("#pageError").empty();
      total = 0;
      calcTotal();
    }
    // check if value is not a positive integer by calling the isInteger function
    // if not a positive integer then set 1 as the new value,
    //remove the error message and call the calcTotal function
    else if(!isInteger(page)){
      this.value =1;
      $("#pageError").empty();
      total = 0;
      calcTotal();
    }
    // if value does not fall in any of the if statements i.e. value is acceptable
    // remove the error message and call the calcTotal function
    $("#pageError").empty();
    total = 0;
    calcTotal();
  });
  // check if value is not empty when user exits the input
  // if empty then set value as 1, remove error message and call calcTotal function
  $("#pages").blur(function() {
    var page = $(this).val();
    if(page == ""){
      this.value = 1;
      $("#pageError").empty();
      total = 0;
      calcTotal();
    }
  });
  // Checking the subpage input (default value 0)
  // (valid value is greater than or equal to 0 but less than 10)
  $("#subpages").keyup(function() {
    var page = $(this).val();
    if(page == ""){
      this.value = "";
      return false;
    } else if(!isInteger(page)){
      this.value = 0;
      total = 0;
      calcTotal();
    }
    total = 0;
    calcTotal();
  });
  $("#subpages").blur(function() {
    var page = $(this).val();
    if(page == ""){
      this.value = 0;
      total = 0;
      calcTotal();
    }
  });
}); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-04T15:29:47.337

> 我不明白为什么我们在以下条件下检查字符串值

因为`c`是一个字符（实际上是一个 1 字符的字符串），因为这就是[`String.charAt`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/charAt)返回的内容。也就是说，`isInteger`可以使用正则表达式更简单地编写函数：

```
function isPositiveInteger(s)
{
    return !!s.match(/^[0-9]+$/);
    // or Rob W suggests
    return /^\d+$/.test(s);
} 
```

或者您可以采取另一种方法：将字符串转换为数字，确保它是正数，并确保数字的下限与原始数字相同（因此它是整数）：

```
function isPositiveInteger(s)
{
    var i = +s; // convert to a number
    if (i < 0) return false; // make sure it's positive
    if (i != ~~i) return false; // make sure there's no decimal part
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:32:20.887

关于什么..

```
if( +inputString > 0 ) {
} 
```

如果它只是要找出输入是否为正整数。如果您也不想允许带有小数点/浮点值的数字，您应该使用输入字段验证，例如

```
<input type="text" pattern="\d+" required/> 
```

这告诉*输入*字段只有*numbers*。该标志是可选的，如果存在，除非满足所有*模式*`required`，否则它将不允许任何*提交*按钮继续。

# iphone - 让 iPhone 5 布局完全独立

> ID：13219929
> 
> 赞同：1
> 
> 时间：2012-11-04T15:28:12.137
> 
> 标签：iphone, ios, xcode, uistoryboard, iphone-5

我正在为我的应用程序使用 Storyboard，并且正在尝试使其与 iPhone 5 兼容。但是，启用自动布局会搞砸一切 - 代码中的框架更改不起作用等等......有什么办法可以让 iPhone 5 布局完全独立于旧的 iPhone 4 及以下布局（比如为 iPhone 5 创建一个单独的故事板）？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:39:07.267

如果你不想使用苹果提供的自动布局，你可以检查设备的屏幕尺寸。这是来自stackoverflow另一篇文章的宏

```
#define IS_IPHONE_5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON ) 
```

使用该宏，您可以仅为 iPhone 5 构建一个单独的故事板，并在您的 AppDelegate 中使用它初始化它

```
NSString *storyboardName;
if (IS_IPHONE_5)
    storyboardName = @"MainStoryboard_iPhone5";
else storyboardName = @"MainStoryboard_iPhone";
storyboard = [UIStoryboard storyboardWithName:storyboardName bundle:nil]; 
```

# mysql - MySQL：显示表中的特定记录？

> ID：13219933
> 
> 赞同：3
> 
> 时间：2012-11-04T15:28:27.440
> 
> 标签：mysql, sql, select, duplicates

我有以下结构的表：

**表格1**

```
| ID1 | NAME | GROUP_ID |
-------------------------
|   1 |  AAA |      101 |
|   2 |  A_A |      101 |
|   3 |  BBB |        0 |
|   4 |  CCC |      103 |
|   5 |  C_C |      103 |
|   6 |  DDD |        0 |
|   7 |  EEE |        0 |
|   8 |  FFF |        0 |
|   9 |  GGG |        0 |
|   10|  HHH |      104 |
|   11|  H_H |      104 | 
```

**表2**

```
| ID2 | NAME |
--------------
|   1 |  AAA |
|   2 |  BBB |
|   3 |  C_C | 
```

**团体**

```
| GROUP_ID | NAME |
-------------------
|      101 |  AAA |
|      101 |  A_A |
|      103 |  CCC |
|      103 |  C_C |
|      104 |  HHH |
|      104 |  H_H | 
```

'table1' 是一个包含所有元素的表格。在此表中，有由标准创建的重复记录，并且此元素插入到表“组”中。在 table2 有与 table1 中的元素匹配的元素。

我想显示 table1 中不在 table2 中的所有记录。如果 table2 中的元素在表组中，则不会在结果表中显示该组中的所有元素。在这种情况下，元素是 AAA/A_A (group_id 101) 和 CCC/C_C(group_id 103)

**结果表**

```
| ID1 | NAME | GROUP_ID |
-------------------------
|   6 |  DDD |        0 |
|   7 |  EEE |        0 |
|   8 |  FFF |        0 |
|   9 |  GGG |        0 |
|   10|  HHH |      104 |
|   11|  H_H |      104 | 
```

名称为 A_A 和 C_C 的元素不在 RESULT TABLE 中，因为这些项目是重复的。

我试过这个： [http ://sqlfiddle.com/#!2/70253/3](http://sqlfiddle.com/#!2/70253/3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T16:10:16.037

怎么样：

对于已使用的组：

```
select * from table1
where NAME not in (SELECT distinct(name) FROM TABLE2) 
```

对于所有组，无论使用如何：

```
select * from table1
where NAME not in (SELECT distinct(name) FROM groups) 
```

[http://sqlfiddle.com/#!2/83b7c/45](http://sqlfiddle.com/#!2/83b7c/45)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T16:16:01.737

此查询将显示所有`table1`未按`table2`名称包含的元素，并且还将过滤掉与存在的条目具有相同 id 的所有`group`条目`table2`（在您的情况下为重复项）。

```
select t1.* from table1 t1 left join groups g on t1.name=g.name 
left join table2 t2 on t2.name=t1.name
where (g.group_id is null or g.group_id not in (SELECT gg.group_id FROM TABLE2 t2 inner join groups gg on gg.name=t2.name))
and t2.id2 is null; 
```

查看您的[sqlFiddle](http://sqlfiddle.com/#!2/427bf/15)更新。

# html - 表格高度属性似乎没有任何效果

> ID：13219935
> 
> 赞同：0
> 
> 时间：2012-11-04T15:29:07.297
> 
> 标签：html, css

我有这样的 HTML 结构：

```
<div class="wrapper">
<table>
<tbody>
<tr>
<td>some content</td>
</tr>
</tbody>
</table>
</div> 
```

我的包装风格是这样的：

```
.wrapper{
color: #444444;
    height: 165px;
    line-height: 135%;
    margin-top: 10px;
    padding-bottom: 10px;
    width: 270px;
} 
```

我的表只定义了宽度以及一些继承的样式：

```
.wrapper> table {
    width: 100%;
}
table {
    background-color: transparent;
    border-collapse: collapse;
    border-spacing: 0;
    max-width: 100%;
}
table {
    border-collapse: collapse;
    border-spacing: 0;
} 
```

我想要做的是我的表格消耗了父元素的最大高度，`.wrapper`其高度值是`165px`但由于某种原因表格高度没有减少。

我的最终目标是设置一个`y-overflow`包装器，所以如果表格变得更大以至于`.wrapper`用户可以滚动，我在这里缺少什么提示？

当我将表格高度更改为 > 然后 190 像素时，表格会做出反应，它会变大，但如果我更改为较小的尺寸，即 165 像素或低于 190 像素，它似乎没有反应

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:32:42.790

如果你想要它`100%`高，给它`height: 100%`。目前您根本没有指定高度。

请记住，桌子往往不遵守所有高度规则。如果内容不合适，他们可能会有点固执。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:56:29.943

添加`height: 100%`到表格样式确实使它继承了父元素的高度：

```
.wrapper> table {
  width: 100%;
  height: 100%;
} 
```

演示：http: [//jsfiddle.net/WDFa2/](http://jsfiddle.net/WDFa2/)

注意：表格继承的高度是父级的指定高度，即`165px`，而不是包括填充的高度，即`175px`。

# c# - 在 windows phone 7 中发出警报通知时如何启动应用程序页面？

> ID：13219936
> 
> 赞同：0
> 
> 时间：2012-11-04T15:29:13.147
> 
> 标签：c#, windows-phone-7

我正在制作一个应用程序，当警报在 Windows 手机上发出时，我必须启动一个游戏页面实际上你看到有人在帖子中回复 nm 真的很想知道这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:48:01.730

您可以通过设置提醒来做到这一点。使用以下代码执行此操作 -

```
//Create a reminder
Reminder myReminder = new Reminder("buy milk");
myReminder.Title = "Buy Milk";
myReminder.Content = "Don't forget to buy milk!";
myReminder.BeginTime = DateTime.Now.AddSeconds(10);
myReminder.ExpirationTime = DateTime.Now.AddSeconds(15);
myReminder.RecurrenceType = RecurrenceInterval.None;
myReminder.NavigationUri = new Uri("/MainPage.xaml?fromReminder=1",         UriKind.Relative);

//Add the reminder to the ScheduledActionService
ScheduledActionService.Add(myReminder); 
```

NavigationUri 属性用于指定要将应用程序启动到的页面。这里有几个链接以获取更多信息

[教程](http://blog.markarteaga.com/WindowsPhoneMultitaskingndashScheduledNotifications.aspx)

[MSDN](http://msdn.microsoft.com/en-us/library/microsoft.phone.scheduler.reminder%28v=vs.92%29.aspx)

# playn - PlayN 在 Eclipse 中导出可运行的 .jar 文件

> ID：13219937
> 
> 赞同：2
> 
> 时间：2012-11-04T15:29:14.937
> 
> 标签：playn

我无法导出可运行的 .jar 文件。当我导出 java 项目（使用 eclipse 导出向导）然后尝试运行生成的 .jar 文件时，我只会收到找不到 jwgl 库的错误！我可以做些什么来获得一个工作的 .jar 文件？

提前致谢！问候弗莱克达尔姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-13T13:11:46.023

您可以使用 maven 导出可运行的 jar。赶紧跑

```
mvn package 
```

并且*projectname.jar*和*projectname-jar-with-dependencies.jar*将出现在*目标*目录下。

# joomla - google分析跟踪子域错误

> ID：13219940
> 
> 赞同：1
> 
> 时间：2012-11-04T15:29:22.177
> 
> 标签：joomla, google-analytics, joomla2.5

我在具有不同子域的不同文件夹中有两个不同的 joomla 网站。

例如，public_html/chinese 和 public_html/english

域预览 `http://chinese.mydomain.com` 和 `http://english.mydomain.com`

我希望在谷歌分析中分别跟踪这两个网站。像往常一样，我首先创建了一个帐户，并创建了两个网络资源来为这两个网站提供服务。

两个网络属性详细信息如下

```
Property ID: UA-XXXXXXX-1
Default URL: http://chinese.mydomain.com 
```

跟踪代码

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXX-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

和

```
Property ID: UA-XXXXXXX-2
Default URL: http://english.mydomain.com 
```

跟踪代码

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXX-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

两个站点都显示“状态：未安装跟踪”。我完全糊涂了，不知道发生了什么。

在调试最后一行代码后出现如下信息

> 应用程序配置不允许给定 URL。：应用程序的设置不允许一个或多个给定 URL。它必须与网站 URL 或画布 URL 匹配，或者域必须是应用程序域之一的子域。

我没有在我的主域 www.mydomain.com 中安装任何 GA 代码，因为它只是在重定向页面提供到我的子域。我希望这不会造成任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:25:55.930

您采取了错误的方式，没有两个单独的跟踪代码，您需要一个。

登录 GA，然后选择您创建的帐户，然后选择管理员，然后您需要创建 2 个配置文件，一个用于中文。和一个英语。您会注意到您只有一个跟踪代码可以实施，而要查看每个站点的流量，您只需单击相应的配置文件即可。

您完成它的方式可能会毫无问题地工作，但是您将受到限制，因为我认为这是您网站的本地化版本，您不想在脑海中加起来每次找出总访客人数。

# c - 如何通过套接字发送数据：一个缓冲区、scatter/gatter 或 readdir 之类的？

> ID：13219943
> 
> 赞同：0
> 
> 时间：2012-11-04T15:29:55.647
> 
> 标签：c, sockets, buffer, readdir, chunks

我正在编写一个 FUSE 覆盖 fs (notifyfs)，它可以是一个数据库客户端可以通过查询从中获取数据。我的目的是让它成为一个缓存/overlayfs/数据库，客户端可以在显示条目及其属性（属性，还有 mimetype、图标等）时从中获取数据。

查询是获取目录的内容。已经与 notifyfs 建立连接 (=fd) 的客户端通过“list_message”请求数据。我现在的问题是如何对 notifyfs 必须给出的响应进行编程。我正在考虑三种/两种不同的方法。请注意以下事项：

notifyfs 以具有不同条目的基本形式响应，其中每个条目都是这样的：

```
int mode
uid_t uid
gid_t gid
size_t size
timespec ctime
timespec mtime
timespec atime
int lenname
char name[] 
```

（调用这个 notifyfs_entry_struct）

请注意，名称的 len 不是固定的，最大为 255。Futher 客户端要求一定数量的条目，最大。我不确定这个最大值到底是多少，但应该是 80 左右。

一个。一大缓冲。大小类似于：

80 x (255+sizeof(struct notifyfs_entry_struct))

可以肯定的是，这将超过 20400 个字节。

湾。固定大小的块，使用 iovec 或 readdir 之类的东西。

什么是最好的选择？第一种方法使用至少 20400 字节的缓冲区，它很多，但它仍然可行吗？

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T17:33:52.907

既然您提到了“连接”，我假设您正在谈论 TCP 套接字。

您选择哪种方法并不重要。`a.`更容易一些 - 连续内存，缓冲区的简单偏移量。

您需要注意的是**TCP 套接字是字节流**。它不知道您的消息边界，因此由于您的消息是可变大小的，因此您不知道是否从`read(2)`or的返回值中获得了完整的消息`recv(2)`。您将不得不处理部分消息读取并缓冲未处理的字节。

# android - 调用位置/GPS 时的广播接收器

> ID：13219957
> 
> 赞同：0
> 
> 时间：2012-11-04T15:31:19.307
> 
> 标签：android, gps, location, broadcast

是否有任何用于位置、网络、gps、谷歌的广播、意图过滤器？我的意思是像防火墙。我想拦截任何试图本地化您的手机的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:37:29.613

Android 的设计使得每个应用程序都在自己的世界中，并且对其他应用程序一无所知。所以不行。

您只能知道互联网、定位服务等何时可用。

因此，您可以知道您的位置何时发生变化并捕获该更新，但您无法知道其他应用程序是否正在使用该数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:44:39.787

每次应用收到位置更新时，您都可以使用被动位置提供程序来获取通知。

[http://developer.android.com/reference/android/location/LocationManager.html#PASSIVE_PROVIDER](http://developer.android.com/reference/android/location/LocationManager.html#PASSIVE_PROVIDER)

但是，这不会让您以“消耗”它们的方式拦截位置更新。

# c# - 是否可以为 Windows Phone 创建文件资源管理器？

> ID：13219960
> 
> 赞同：1
> 
> 时间：2012-11-04T15:31:53.117
> 
> 标签：c#, vb.net, windows-phone-7

我在 Windows 手机的市场上四处寻找文件资源管理器，但找不到任何文件（我说的是你在 Android 上得到的那种文件资源管理器......探索你的文件）。这是因为微软对此类应用程序进行了限制吗？

如果是这样，你会假设他们只是不会在市场上接受它，还是有本地限制阻止它在你的手机上开发和使用？

期待感谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:18:24.763

有 api 限制阻止您的应用程序访问除本地隔离存储之外的所有内容。但是有一些特殊的方法/黑客可以为您的应用程序提供特殊权限（类似于 iPhone 越狱），以便您可以访问文件系统，例如 [http://www.wp7roottools.com/](http://www.wp7roottools.com/)

但这绝对是一个 hack，所以答案是否定的，你将无法实现这样的应用程序并提交给市场。

# c# - 如何将首选计数器添加到系统被测资源（vs2012负载测试）

> ID：13219971
> 
> 赞同：1
> 
> 时间：2012-11-04T15:33:03.323
> 
> 标签：c#, web-services, testing, visual-studio-2012, load-testing

我运行负载测试（vs2012）。

如何将首选计数器添加到被测机器？

在负载测试摘要中，我看到一个带有标题的表格：

`System Under Test Resources`

但我在表格本身中看不到任何数据

如何为正在测试的远程机器（通过 LAN）设置计数器？

我试图添加`qa-srv17`为：

![在此处输入图像描述](../Images/ffb919309a69f15bcd2c62ab4a5af247.png)

# android - “oauth.signpost.jetty.JettyOAuthConsumer”NoClassDefFoundError

> ID：13219974
> 
> 赞同：0
> 
> 时间：2012-11-04T15:33:34.727
> 
> 标签：android, eclipse, jar

直接，我将“signpost-jetty6-1.2.1.1.jar”导入到我的项目中，并且它已成功添加到“项目构建路径”中，但是当我尝试从包含在 JettyOAuthConsumer 中创建一个实例时罐子，像这样：

`JettyOAuthConsumer consumer = new JettyOAuthConsumer(consumerKey, consumerSecret);`

ps :- jar 放在我的项目目录下的“libs”目录中，添加到“项目构建路径”中，并自动创建了一个“引用库”目录，包括 jar 引用。

我收到以下异常：-

```
11-04 17:00:26.960: E/AndroidRuntime(21732): java.lang.NoClassDefFoundError: oauth.signpost.jetty.JettyOAuthConsumer. 
```

“signpost-commonshttp4-1.2.1.1.jar”也出现了这个问题。

希望找到解决方案，在此先感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T15:54:30.847

在您的项目文件夹下创建一个名为的新文件`libs`夹，并将此库添加到该文件夹​​。

我在使用 kSOAP 库时遇到了同样的问题，这解决了我的问题......

# python - 在列表中的每个项目之后插入一个项目（Python）

> ID：13219981
> 
> 赞同：1
> 
> 时间：2012-11-04T15:34:11.710
> 
> 标签：python, list, insert

假设我有一个这样的列表：

```
a = [[1, 2, 3], [4, 5, 6]]
filler = ['cat'] 
```

我怎么能得到

```
b = [[1 ,2 ,3], ['cat'], [4, 5, 6], ['cat']] 
```

作为输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:42:58.817

我更喜欢使用 itertools 来处理这样的事情：

```
>>> import itertools as it
>>> a = [[1, 2, 3], [4, 5, 6]]
>>> filler = ['cat']
>>> list(it.chain.from_iterable(it.izip(a, it.repeat(filler))))
[[1, 2, 3], ['cat'], [4, 5, 6], ['cat']] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T16:19:22.290

我喜欢`itertools`这里发布的基于 - 的解决方案，但这是一种不需要列表理解或的方法`itertools`，我敢打赌它非常快。

```
new_list = [filler] * (len(a) * 2)
new_list[0::2] = a 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T15:39:24.853

不是pythonic，但似乎有效。

```
list = [[1, 2, 3], [4, 5, 6]]
result = []
for e in list:
    result.append(e)
    result.append(['cat'])
result.pop() 
```

在这篇文章中找到： [在列表中已有的每个项目之间添加一个项目](https://stackoverflow.com/questions/5920643/add-an-item-between-each-item-already-in-the-list?rq=1)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-04T15:40:00.940

这是一个想法：

```
import itertools

a = [[1, 2, 3], [4, 5, 6]]
filler = ['cat']
print list(itertools.chain.from_iterable(zip(a, [filler] * len(a)))) 
```

输出：

```
[[1, 2, 3], ['cat'], [4, 5, 6], ['cat']] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-04T15:52:31.130

像这样使用[`itertools.islice()`](http://docs.python.org/2/library/itertools.html#itertools.islice)和[`itertools.cycle()`](http://docs.python.org/2/library/itertools.html#itertools.cycle)：

`cycle()`用于重复一个项目，并用于将重复`islice()`次数切割为`len(a)`，然后使用[`izip()`](http://docs.python.org/2/library/itertools.html#itertools.izip)or 简单`zip()`over`a`和返回的迭代器`islice()`，这将返回元组列表。

然后，您可以使用[`itertools.chain()`](http://docs.python.org/2/library/itertools.html#itertools.chain).

```
In [72]: a
Out[72]: [[1, 2, 3], [4, 5, 6]]

In [73]: b
Out[73]: ['cat']

In [74]: cyc=islice(cycle(b),len(a))

In [75]: lis=[]

In [76]: for x in a:
    lis.append(x)
    lis.append([next(cyc)])
   ....:     

In [77]: lis
Out[77]: [[1, 2, 3], ['cat'], [4, 5, 6], ['cat']] 
```

或者：

```
In [108]: a
Out[108]: [[1, 2, 3], [4, 5, 6]]

In [109]: b
Out[109]: ['cat']

In [110]: cyc=islice(cycle(b),len(a))

In [111]: list(chain(*[(x,[y]) for x,y in izip(a,cyc)]))
Out[111]: [[1, 2, 3], ['cat'], [4, 5, 6], ['cat']] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-04T15:40:16.017

```
a = [[1, 2, 3], [4, 5, 6]]
filler = ['cat']
out = []

for i in a:
    out.append(i)
    out.append(filler) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-04T15:42:22.830

```
result = [si for i in zip(a, [filler]*len(a)) for si in i] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-04T15:46:05.093

试试这个，作为一个单行：

```
from operator import add
a = [[1, 2, 3], [4, 5, 6]]
filler = ['cat']

reduce(add, ([x, filler] for x in a))
> [[1, 2, 3], ['cat'], [4, 5, 6], ['cat']] 
```

甚至更简单，不使用`reduce`：

```
sum(([x, filler] for x in a), [])
> [[1, 2, 3], ['cat'], [4, 5, 6], ['cat']] 
```

两种解决方案都做同样的事情：首先，创建一个生成器，`[element, filler]`然后展平生成的对流。为了提高效率，第一步是使用生成器来避免不必要的中间列表。

**更新：**

这篇文章是一个教科书示例，说明为什么不能在在线论坛中喂食巨魔。请参阅评论以了解我的意思。最好忽略巨魔。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-11-04T17:08:12.387

```
 python 3.2

    a = [[1, 2, 3], [4, 5, 6]]
    b = ['cat']
    _=[a.insert(x,b) for x in range(1,len(a)*2,2)] 
```

# php - 带有php变量的jquery mobile href

> ID：13219984
> 
> 赞同：1
> 
> 时间：2012-11-04T15:34:17.697
> 
> 标签：php, jquery, mobile, href

我在 jquery mobile 上尝试了一下，效果非常好：D

但是我在将 href 链接到带有参数的 php 时遇到了一个问题：

如果我做

```
echo "<a href='deletemessages.php?token=".$row['messagetoken']."'></a>"; 
```

它总是在屏幕上显示“未定义”的新页面返回

但如果我用一个 html 文件来做它，它就可以正常工作。

如何解决这个问题？

问候

# javascript - 谷歌图表，时间从 8:00 开始，到 7:45 结束

> ID：13219985
> 
> 赞同：1
> 
> 时间：2012-11-04T15:34:22.493
> 
> 标签：javascript, html, google-visualization

我在使用 Google 图表时遇到了一些问题。我有一个谷歌面积图：

```
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = new google.visualization.DataTable();
     data.addColumn('timeofday','time');
     data.addColumn('number','temp');
     data.addRows([
       [[8,0,0],7.875],
       [[8,15,0],7.9399996],
       [[8,30,0],8.1],
       [[8,45,0],8.160001],
       [[9,0,0],8.139999],
       // data every quarter of an hour
       [[7,15,0],9.26],
       [[7,30,0],9.26],
       [[7,45,0],9.18]
     ]);

    var options = {
      title: 'Title',
      vAxis: {
        title: 'AvgTemp',
        titleTextStyle: {color: 'red'},
      }
      hAxis: {
        title: 'Time',
        titleTextStyle: {color: 'red'},
      }
    };

    var chart = new google.visualization.AreaChart(document.getElementById('chart_div2'));
    chart.draw(data, options);
  }
</script> 
```

现在，当我加载页面时，图表的 hAxis 从 0:00 开始，到 24:00 结束，它会破坏图表。我怎样才能使图表从 8:00 开始并在 7:45 结束？

我用视图窗口尝试了一些东西，但我似乎无法让它工作。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:48:47.127

答案是使用日期时间而不是一天中的时间，这样你需要添加一个日期，这就是 API 知道哪个时间先到的方式。

像这样：

```
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = new google.visualization.DataTable();
     data.addColumn('datetime','time');
     data.addColumn('number','temp');
     data.addRows([

    [new Date(2012,11,3,8,0,0),7.875],
    [new Date(2012,11,3,8,15,0),7.9399996],
    [new Date(2012,11,3,8,30,0),8.1],
    [new Date(2012,11,3,8,45,0),8.160001],
    [new Date(2012,11,3,9,0,0),8.139999],
    //new data every quarter of an hour
    [new Date(2012,11,4,7,0,0),9.42],
    [new Date(2012,11,4,7,15,0),9.26],
    [new Date(2012,11,4,7,30,0),9.26],
    [new Date(2012,11,4,7,45,0),9.18]

     ]);

    var options = {
      title: 'Title',
      vAxis: {  title: 'AvgTemp',
                titleTextStyle: {color: 'red'},

            },
      hAxis: {  title: 'Time',
                titleTextStyle: {color: 'red'},                 
            }

    };

    var chart = new google.visualization.AreaChart(document.getElementById('chart_div2'));
    chart.draw(data, options);
  }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-08T05:05:08.333

```
@oaklodge
producerCountDatatable = new google.visualization.DataTable();
// producerCountDatatable.addColumn('timeofday', 'Timestamp');
producerCountDatatable.addColumn('datetime', 'Time of day(Hours:Minutes)');
producerCountDatatable.addColumn('number', 'ProducerCount');
  for(var i = 0; i < hours.length; i++){
    //If you use timeofday          //producerCountDatatable.addRow([[parseInt(hours[i]),parseInt(minutes[i]),parseInt(seconds[i])],newProducerData[i]]);

//the following is for datetime 
producerCountDatatable.addRow([new Date(timeStampData[i]),newProducerData[i]]);
} 
```

# java - Android - 如何使用 Android 4.0 下载 XML 文件？

> ID：13219986
> 
> 赞同：0
> 
> 时间：2012-11-04T15:34:25.080
> 
> 标签：java, android, xml, download

我将使用 Android 4.0 下载 XML 文件，我的旧代码在 Android 2.3.3 上工作：

```
public String getXmlFromUrl(String url) {
    String xml = null;

    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        xml = EntityUtils.toString(httpEntity);

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    // return XML
    return xml;
} 
```

我必须有一个没有 DefaultHttpClient 的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:35:17.213

从 Gingerbread (2.3) 及更高版本开始，检索 HTTP 数据的首选方法是 HttpUrlConnection。您可能想查看[此博客文章](http://android-developers.blogspot.com.br/2011/09/androids-http-clients.html)以了解详细信息。您可能还想查看[HttpUrlConnection 的 Javadoc](http://developer.android.com/reference/java/net/HttpURLConnection.html)

```
URL url = new URL("http://www.android.com/");
HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
try {
    InputStream in = new BufferedInputStream(urlConnection.getInputStream());
    readStream(in);
} finally {
    urlConnection.disconnect();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:50:45.913

您的问题可能是这里的“严格模式”。

您必须使用线程或 AsyncTask 执行 http 请求。

```
class RequestTask extends AsyncTask<String, String, String>{

        @Override
        protected String doInBackground(String... params) {
             //http request here
            //return the response as string
        }
        @Override
        protected void onPostExecute(String result) {
            //set the the data you get
        } 
```

然后：

```
new RequestTask().execute(yourHttpRequestString) 
```

# iphone - 根据另一个数组中的对象从数组中删除特定对象

> ID：13219988
> 
> 赞同：1
> 
> 时间：2012-11-04T15:34:38.053
> 
> 标签：iphone, ios, filter, nsarray

设置：有一个`UITableView`显示美国高尔夫球场的名称、街道、州等。 `UITableView's`数据源是`NSMutableArray`我班级中的一个对象，`GolfCourse`名为`allGolfCourses`.

现在我想删除所有西海岸高尔夫球场`allGolfCourses`并创建一个新的`array`名为`eastCoastGolfCourses`. 我有另一个`NSArray`与`string objects`所有西海岸州（缩写）有关，`westCoastStates`但很难将这两者联系起来。

如何遍历 allGolfCourses 并删除在 `westCoastStates`数组中找到状态缩写的所有对象？

**westCoastStates 数组：**

```
self.westCoastStates = [NSMutableArray arrayWithObjects:
                        @"CH",
                        @"OR",
                        @"WA",
                        nil]; 
```

**高尔夫球场.h**

```
@interface GolfCourse : NSObject

@property (nonatomic, strong) NSString *longitude;
@property (nonatomic, strong) NSString *latitude;
@property (nonatomic, strong) NSString *clubName;
@property (nonatomic, strong) NSString *state;
@property (nonatomic, strong) NSString *courseInfo;
@property (nonatomic, strong) NSString *street;
@property (nonatomic, strong) NSString *city;
@property (nonatomic, strong) NSString *clubID;
@property (nonatomic, strong) NSString *phone;

@end 
```

注意：NSString *state; 包含州缩写，例如：FL

我知道如何使用单个参数来执行此操作，但不知道如何检查`westCoastStates`数组中的所有字符串。希望你能帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:48:21.563

怎么样？

```
NSSet* westCoastStatesSet = [NSSet setWithArray:self.westCoastStates];
NSIndexSet* eastCoastGolfCoursesIndexSet = [allGolfCourses indexesOfObjectsPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop) {
    GolfCourse* course = (GolfCourse*)obj;
    if ([westCoastStatesSet containsObject:course.state]) {
        return NO;
    }
    return YES;
}];

NSArray* eastCoastGolfCourses = [allGolfCourses objectsAtIndexes:eastCoastGolfCoursesIndexSet]; 
```

**更新：**我相信这可以通过使用谓词来浓缩

```
NSPredicate *inPredicate = [NSPredicate predicateWithFormat: @"!(state IN %@)", self.westCoastStates];
NSArray* eastCoastGolfCourses = [allGolfCourses filteredArrayUsingPredicate:inPredicate]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:41:59.247

伪代码：

```
for (int i = 0; i < allGolfCourses.length;) {
    Course* course = [allGolfCourses objectAtIndex:i];
    if (<is course in one of the "bad" states?>) {
       [allGolfCourse removeObjectAtIndex:i];
    }
    else {
        i++;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T15:54:47.080

您可以像这样快速迭代数组：

```
[self.allGolfCourses enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {

    GolfCourse *currentGolfCourse = (GolfCourse *)obj;
    if(![self.westCoastStates containsObject:currentGolfCourse.state]){
        [self.eastCoastStates addObject:currentGolfCourse];
    }
}]; 
```

# c# - 自定义多线程 Http Server 不是线程安全的

> ID：13219996
> 
> 赞同：1
> 
> 时间：2012-11-04T15:35:18.950
> 
> 标签：c#, .net, multithreading, scheduled-tasks

我用 C# 编写了一个简单的多线程 Web 服务器（代码的一部分）：

```
 public class MyServer
    {
        private readonly HttpListener _listener = new HttpListener();
        private int  _dataId;
        public HttpServer(string prefix, string folder)
        {
            System.Threading.ThreadPool.SetMaxThreads(50, 1000);
            System.Threading.ThreadPool.SetMinThreads(50, 50);
            //........
        }

        public void Start()
        {
            _listener.Start();
            while (true)
             ThreadPool.QueueUserWorkItem(ProcessRequest, _listener.GetContext());
        }

        private void ProcessRequest(object obj)
        {
           //.....
        }

} 
```

如果通过浏览器（或仅使用一个主线程）发送请求，则一切正常。但是如果通过下面的代码来做，那么服务器通常会为不同的请求接收相同的值：

你的想法？

--**编辑**--:

简单的问题是，仅使用局部变量是否可以确保我的代码是线程安全的？反之亦然：如果我使用实例变量（不是静态的，**在我的情况下是 _dataId**），我是否必须“照顾”它们以使它们成为线程安全的（例如，通过`lock`关键字）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:45:01.053

以多线程方式使用 HttpListener 的规范方法是通过 Begin/End 异步模式，[这里是一个示例](https://gist.github.com/369432)。

如果您的处理程序方法是可重入的，即它不依赖于任何实例状态，那么代码很有可能是线程安全的。问题是您使用的任何类、方法等是否也是线程安全的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-04T15:58:27.860

您应该启动另一个线程，该线程将循环调用 GetContext，而不是多次排队同一个上下文。

```
public void Start()
{
    _listener.Start();
    ThreadPool.QueueUserWorkItem(StartImpl);
}
public void StartImpl()
{
    while (true)
        ProcessRequest(_listener.GetContext());
} 
```

# c++ - int 返回垃圾值

> ID：13219998
> 
> 赞同：0
> 
> 时间：2012-11-04T15:35:31.000
> 
> 标签：c++, netbeans, int, mingw, average

我有一个问题：执行程序时，我的 int 返回的值太大。该程序计算算术平均值。

例如：当我输入 1,2,3,4,5 时，它会*显示 2293393*。

```
/* 
 * File:   main.cpp
 * Author: Natch
 *
 * Created on 4 listopad 2012, 15:32
 */

#include <cstdlib>
#include <iostream>

using namespace std;

/*
 * 
 */
int main(int argc, char** argv) {
    int n,x;
    x = 0;
    /*
     * a - array
     * x - repeat
     * n - array fields
     * suma - array fields sum
     */
    cout << "Srednia liczb" << endl;
    cout << "Program oblicza srednia z x liczb." << endl;
    cout << "Podaj ilosc liczb do obliczenia sredniej:" << endl;
    cin >> n;
    int a[n];

    while(x<n) {
        x++;
        cout << "Podaj " << x << " liczbe:" << endl;
        cin >> a[x];
    }
    long int suma;

    for (int i = 0; i < n; i++) {
        suma += a[i];
    }

    int srednia = suma/n;
    cout << "Srednia wynosi:" << endl << srednia << endl;
    system("pause");

    return 0;
} 
```

对不起我的英语，我来自波兰。

您可以在 google translate(pl->en) 中翻译 couts。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T15:37:57.813

您的程序有一个经典的“减一”错误：`x`在将其用作 中的索引之前先递增`a[x]`，因此第零个元素保持未初始化：

```
while(x<n) {
    cout << "Podaj " << (x+1) << " liczbe:" << endl;
    cin >> a[x++];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:35:49.080

将变量 suma 初始化为零。

```
long int suma=0; 
```

与其在`x`之前`cout`递增，不如在`cout`.

```
cout << "Podaj " << x++ << " liczbe:" << endl; 
```