# StackOverflow 问答 12556000-12556999

# php - Codeigniter 文件上传器类 - 文件名作为日期和时间

> ID：12556000
> 
> 赞同：1
> 
> 时间：2012-09-23T20:30:43.817
> 
> 标签：php, codeigniter

我正在尝试修改 codeigniters 的文件上传器类，以便每个文件的文件名都是日期和时间，无论上传的文件类型如何。

我目前的上传功能是：

```
 function do_upload()
    {
        $config['upload_path'] = './uploads/';
        $config['allowed_types'] = 'gif|jpg|png';
        $config['max_size'] = '2048';
        $config['max_width']  = '1624';
        $config['max_height']  = '1268';
        $config['file_name']  = substr(md5(time()), 0, 28);

        $this->load->library('upload', $config);

        if ( ! $this->upload->do_upload())
        {
            $error = array('error' => $this->upload->display_errors());

        }
        else
        {
            $data = array('upload_data' => $this->upload->data());

            $this->load->view('upload_success', $data);
        }
    } 
```

任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:28:10.987

改变

```
$config['file_name']  = substr(md5(time()), 0, 28); 
```

成为日期和时间：

```
$config['file_name'] = date("Y_m_d H:i:s"); 
```

请参阅 PHP[`date`](http://php.net/manual/en/function.date.php)以了解如何对其进行格式化。

# apache - Apache Rewrite 在 Rewrite URL 上保留原始 QueryString

> ID：12556001
> 
> 赞同：0
> 
> 时间：2012-09-23T20:31:01.697
> 
> 标签：apache, mod-rewrite, rewrite

我有个问题。

以下代码是我的 Apache 配置：

```
RewriteRule ^/page-(.*)$ https://%{SERVER_NAME}:%{SERVER_PORT}/site/spaces/portal/page/$1 [QSA] 
```

所以，没关系。但是，当我访问我的页面时：

www.mysite.com/page-page?query=blah

它在没有 query=blah 参数的情况下重定向 URL。

我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T08:11:55.870

我不确定它们为什么丢失，但您应该可以使用 %{QUERY_STRING} 将它们放回原处。

# oracle - Oracle 跟踪优缺点

> ID：12556003
> 
> 赞同：-3
> 
> 时间：2012-09-23T20:31:13.350
> 
> 标签：oracle, oracle10g

谁能告诉我oracle traces的优缺点。如果我们启用跟踪，将对查询执行产生什么影响。它会影响数据库的性能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T20:46:19.300

我假设`oracle traces`你的意思是`sql tracing`。如果是这样，那么如果您`sql tracing`为整个实例启用它将对性能产生重大影响。最好在会话范围内启用 sql 跟踪 `Alter session set sql_trace=true`。但是，从 Oracle 10g 开始，`SQL_TRACE`不推荐使用参数。最好使用[DBMS_MONITOR](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_monitor.htm#i1003993)包。

# php - 添加 PHP 文件以在 HTML 文件中显示

> ID：12556007
> 
> 赞同：0
> 
> 时间：2012-09-23T20:31:41.500
> 
> 标签：php, html, database

我在 PHP 中有一个文件，它调用数据库中的所有行项目，它显示一个包含所有行项目的表。我有一个 HTML 页面，其中包含一个表单，可以将项目添加到餐厅菜单的数据库中。我希望 PHP 文件用于显示此 html 页面中要调用的所有行项目，因此除了我拥有的表单之外，它还将在页面上显示表格。我该怎么做呢？

这是我的 HTML 文件代码：

```
<!DOCTYPE html>
    <html>
        <head>
            <link rel="stylesheet" type="text/css" href="admin_index.css"/>
            <title>B Place</title>
        </head>

        <body id = "bodyStyler">
            <h1 id ="header">
                <img src="logo.jpg" id="logo"/>
            </h1>
            <table id = "pageLinks">
                <tr>
                    <td class="buttons"><b><a href="admin_index.html">Home</a></b></td>
                    <td class="buttons"><b><a href="admin_menu.html">Menu</a></b></td>
                    <td class="buttons"><b><a href="admin_volleyball.html">Volleyball</a></b></td>
                    <td id="endButton"><b><a href="admin_blog.html">Blog</a></b></td>
                </tr>
            </table>
            <div id="content">
                <h1 id="bodyText"> Menu </h1>
                <table>
                    <form method="post" action="input_menu.php">
                    <tr>
                        <td class="chart">Product Name:</td>
                        <td>
                        <input type="text" name="productName" value="" />
                        </td>
                    </tr>
                    <tr>
                        <td class="chart">Product Type:</td>
                        <td>
                        <input type="text" name="type" value=""  />
                        </td>
                    </tr>
                    <tr>
                        <td class="chart">Product Price:</td>
                        <td>
                        <input type="text" name="price" value=""  />
                        </td>
                    </tr>
                    <tr>
                        <td class="chart">Product is a Special:</td>
                        <td>
                        <input type="checkbox" name="isSpecial" value=""  />
                        </td>
                    </tr>
                    <tr>
                        <td class="chart">Day of the Week Product is a Special:</td>
                        <td>
                        <input type="text" name="specialDay" value=""  />
                        </td>
                    </tr>
                    <tr><td>&nbsp;</td>
                        <td>
                        <input type="submit" value="Submit" />
                        </td>
                    </tr>
                </table>
                <?php include 'admin_menu_lineitems.php';?>
        </body>
    </html> 
```

这是我想要包含的 PHP 文件（admin_menu_lineitems.php）的代码：

```
<?php
$con = mysql_connect("localhost","root","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("b_place", $con);

$result = mysql_query("SELECT * FROM menu");

echo "<table border='1'>
<tr>
<th> Type </th>
<th> Product Name </th>
<th> Price </th>
</tr>";

while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['type'] . "</td>";
  echo "<td>" . $row['productName'] . "</td>";
  echo "<td>" . $row['price'] . "</td>";
  echo "</tr>";
  }
echo "</table>";

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T20:33:07.227

最简单（也是迄今为止最常见）的方法是：

*   将您的 HTML 页面重命名为 PHP 页面
*   将您的 PHP 代码剪切并粘贴到最终页面的适当部分

这样，整个页面将作为 PHP 处理。

指向此页面的任何链接都必须指向重命名的页面。

如果您不将 .html 文件重命名为 .php 文件，PHP 处理器将不会对页面进行操作（默认情况下，无论如何），只会将 PHP 代码直接输出到浏览器而不运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:34:09.493

您可以使用 require 或 include 来实现您的目标：

[http://php.net/manual/en/function.require-once.php](http://php.net/manual/en/function.require-once.php)

或...（如果必须）

[http://www.w3schools.com/php/php_includes.asp](http://www.w3schools.com/php/php_includes.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T20:37:12.437

如果您不想重命名，可以尝试让您的服务器将 html 作为 php 文件运行。检查这篇文章： http: [//php.about.com/od/advancedphp/p/html_php.htm](http://php.about.com/od/advancedphp/p/html_php.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T21:01:35.747

为了扩展目前的一般响应，HTML 代码应该在一个文件扩展名为 .php 而不是 .html 的文件中，以便任何 PHP 工作。我对下面的 html 做了一些小改动（记得使用结束标签），但是 PHP 似乎没问题，所以包含应该可以正常工作。

```
<?php
  /** (the include file) **/
  $db = mysql_connect("localhost", "username", "password");
  mysql_select_db("database", $db);
  $result = mysql_query("SELECT * FROM menu");
  while($row = mysql_fetch_array($result)) {
    echo "<tr>".
          "<td>". $row["type"] . "</td>".
          "<td>". $row["productName"] . "</td>".
          "<td>". $row["price"] . "</td>".
         "</tr>";
  }
?>
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="admin_index.css"/>
  <title>B Place</title>
</head>

<body id="bodyStyler">
  <h1 id="header"><img src="logo.jpg" id="logo"/></h1>
  <table id="pageLinks">
    <tr>
      <td class="buttons"><b><a href="admin_index.html">Home</a></b></td>
      <td class="buttons"><b><a href="admin_menu.html">Menu</a></b></td>
      <td class="buttons"><b><a href="admin_volleyball.html">Volleyball</a></b></td>
      <td id="endButton"><b><a href="admin_blog.html">Blog</a></b></td>
    </tr>
  </table>
  <div id="content">
    <h1 id="bodyText"> Menu </h1>

    <form method="post" action="input_menu.php">
      <table>
        <tr>
          <td class="chart">Product Name:</td>
          <td><input type="text" name="productName" value=""/></td>
        </tr>
        <tr>
          <td class="chart">Product Type:</td>
          <td><input type="text" name="type" value=""/></td>
        </tr>
        <tr>
          <td class="chart">Product Price:</td>
          <td><input type="text" name="price" value=""/></td>
        </tr>
        <tr>
          <td class="chart">Product is a Special:</td>
          <td><input type="checkbox" name="isSpecial" value=""/></td>
        </tr>
        <tr>
          <td class="chart">Day of the Week Product is a Special:</td>
          <td><input type="text" name="specialDay" value=""/></td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td><input type="submit" value="Submit"/></td>
        </tr>
      </table>
    </form>
    <table border='1'>
      <tr>
        <th>Type</th>
        <th>Product Name</th>
        <th>Price</th>
      </tr>
      <?php include 'admin_menu_lineitems.php';?>
    </table>
  </div>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-23T20:56:11.497

这是老派，但为什么不使用 iframe？但是将页面重命名为 .php 并使用 Web 服务器查看页面会更简洁。如果你还没有，wamp / xamp 很容易。

# objective-c - addSubview 等待方法的其余部分

> ID：12556014
> 
> 赞同：0
> 
> 时间：2012-09-23T20:32:47.403
> 
> 标签：objective-c, uiview

我想在我打电话时立即展示我的观点。我不知道如何使视图显示。

```
-(IBAction) showProgress: (id) sender {
   progressViewController *progress = [[progressViewController alloc] initWithNibName:@"progressViewController" bundle:NULL];
   [self.view addSubview:progress.view];
   [self someFunctionWhichTakesAgesToBeDone];
} 
```

它是从当前 UIViewController 调用的。并且视图出现在长函数之后。如何在长功能之前显示它？感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:31:50.410

使用 GCD（Grand Central Dispatch），这是最简单的方法（Apple 推荐），代码将是：

```
-(IBAction) showProgress: (id) sender {
    progressViewController *progress = [[progressViewController alloc] initWithNibName:@"progressViewController" bundle:NULL];
    [self.view addSubview:progress.view];

    // Heavy work dispatched to a separate thread
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSLog(@"dispatched");
        // Do heavy or time consuming work
        [self someFunctionWhichTakesAgesToBeDone];

        // When finished call back on the main thread:
        dispatch_async(dispatch_get_main_queue(), ^{
            // Return data and update on the main thread
        });
    });

} 
```

是两个街区。第一个在单独的线程上完成繁重的工作，然后在完成繁重的工作后调用第二个块，以便在需要时在主线程上完成更改和 UI 更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:36:45.853

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)

```
- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(id)arg waitUntilDone:(BOOL)wait` 
```

采用

```
[self.view performSelectorOnMainThread:@selector(addSubview:) withObject:progress.view waitUntilDone:YES] 
```

或将您的 Sleep() 函数（我希望它是其他任何东西，Sleep() func 真的很糟糕，因为它被告知）放入另一个函数`MySleepFunc`并调用

```
[self performSelector:@selector(MySleepFunc) withObject:nil afterDelay:0.003] 
```

而不是睡眠（3）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T20:48:46.117

阅读有关多线程的信息。简而言之，有一个 UI 线程可以进行绘图、接受用户事件等。如果您使用 sleep() 或任何其他阻塞方法暂停它，则不会显示/重绘任何内容，也不会处理任何事件。您必须从后台线程发出 HTTP 请求。

# ios - Safari 中的 openURL。网络钓鱼警告

> ID：12556015
> 
> 赞同：1
> 
> 时间：2012-09-23T20:32:49.513
> 
> 标签：ios, xcode, safari

我想在 safari 中从我的应用程序打开一个 url，但是 url 页面需要登录详细信息，我宁愿自动传递这些详细信息，以便页面打开。如果我将登录详细信息添加到 URL，例如。`http://user:pass@myurl.com`它在 safari 中打开，但我收到反网络钓鱼警告。

有没有其他方法可以避免收到警告？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-09T06:42:42.897

如果您使用这样的 php 重定向，它应该可以工作：

```
<?php
function redirect($url, $statusCode = 302)
  {
     header('Location: ' . $url, true, $statusCode);
     die();
  }
$url = 'https://' . $_REQUEST['user'] . ':' . $_REQUEST['password'] . '@myurl.com';
redirect($url);
?> 
```

将该 php 文件命名为“login.php”

可能的 html 页面：

```
<form action='login.php' method='post'>
username<input type='text' name='user'><br>
password<input type='password' name='password'><br>
<input type='submit' value='login'>
</form> 
```

或打开页面：

`https://myurl.com/login.php?user=[some script to get username]&password=[password]`

这些答案需要在服务器上创建文件。我不确定您是否拥有该域，但这些文件应该可以在任何带有 php 的服务器上运行，并且可以轻松重定向到任何网站。

希望这可以帮助

# php - 在框架之上构建 CMS（仅限理论）

> ID：12556016
> 
> 赞同：-1
> 
> 时间：2012-09-23T20:32:58.497
> 
> 标签：php, zend-framework, content-management-system, abstraction

我正在寻找详细说明理论方法的答案，所以不要担心任何技术细节。

我正在研究构建简单 CMS 的概念，但我无法决定是否将纯 PHP 与各种库一起使用，或者在 Zend 或 Symfony 等 MVC 框架之上构建它。

我担心的是，通过在框架上构建它意味着模板和内容管理必须经过我自己构建的自定义抽象层，其处理将构建在框架之上，因此本质上是两层的框架。

这是一个有效的解决方案，还是应该从头开始构建路由系统，并简单地将第三方库用于 DBO 抽象和其他有用的工具用于更具体的组件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:12:13.737

如果您使用库构建 CMS，您将要做的就是重用您自己编写的代码，并且可能有一种速记方式来编写代码。如果您可以轻松地拆分代码或在时机成熟时再次从头开始编写代码，那么这应该不是问题。

但是，如果您使用框架来编写 CMS，它将为您提供已经包含在其中的编码功能，例如 MVC、测试、模板语言、ORM，也许还有脚手架、迁移和其他类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:40:45.717

还有另一种方法需要考虑，例如将 CMS 构建为服务，以支持在任何地方托管的多个网站。通过采用 REST 和 HTML5 和 CORS 的插件方法来实现这一点，这将允许您在任何服务器端技术中的任何任意内容项上进行内容管理。我最终自己为我的电子商务公司做这件事，因为我们在这些场景中支持不同的服务器端和不同的方法和框架。然后我把它作为一个副公司，但它实际上只是我更喜欢使用的一个工具，并且在收入方面并没有得到太多，因为我不推广它。如果我重新开始，我会做什么，我可能会决定让它更干净，因为它的回归是让它在安全模型和 API 样式方面更像亚马逊网络服务。

# android - 活动背景在 ldpi 密度上变黑

> ID：12556018
> 
> 赞同：0
> 
> 时间：2012-09-23T20:33:11.807
> 
> 标签：android

我有一个简单的活动，只有几行。我正在测试 ldpi 密度的应用程序，但我的问题是它看起来完全是黑色的

**1\. 它在 mdpi 和 hdpi 密度上运行良好**

**2\. 我可以在 xml 的图形视图中看到所需的设计**

布局一半是红色，另一半是绿色，中间有文字。我的代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

    android:fillViewport="true" >

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="horizontal" >

        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:background="#FF0000" //red
            android:layout_weight="1"
            android:orientation="horizontal" >
        </LinearLayout>

        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:background="#00FF01" //green
            android:layout_weight="1"
            android:orientation="horizontal" >
        </LinearLayout>

    </LinearLayout>

    <RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="300dp"
        android:layout_height="380dp"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:orientation="horizontal" >

        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/bal"
            android:layout_width="150dp"
            android:layout_height="380dp"
            android:gravity="right"
            android:orientation="vertical" >

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="right"
                android:layout_marginRight="10dp"
                android:gravity="right"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv0"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="62dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="62dp"
                    android:text="B" />
            </LinearLayout>

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="right"
                android:layout_marginRight="10dp"
                android:gravity="right"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv2"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="52dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv3"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="52dp"
                    android:text="B" />
            </LinearLayout>

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="right"
                android:layout_marginRight="10dp"
                android:gravity="right"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv4"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="42dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv5"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="42dp"
                    android:text="B" />
            </LinearLayout>

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="right"
                android:layout_marginRight="10dp"
                android:gravity="right"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv6"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="32dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv7"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="32dp"
                    android:text="B" />
            </LinearLayout>
        </LinearLayout>

        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="150dp"
            android:layout_height="380dp"
            android:layout_toRightOf="@+id/bal"
            android:layout_marginLeft="10dp"
            android:layout_centerHorizontal="true"
            android:layout_centerVertical="true"
            android:orientation="vertical" >

        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="left"
                android:gravity="left"
                android:orientation="horizontal" >

            <TextView
                android:id="@+id/tv8"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginRight="20dp"
                android:text="A"
                android:textColor="#000000"
                android:textSize="62dp" />

                <TextView
                    android:id="@+id/tv9"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="62dp"
                    android:text="B" />
            </LinearLayout>

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="left"
                android:gravity="left"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv10"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="52dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv11"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="52dp"
                    android:text="B" />
            </LinearLayout>

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="left"
                android:gravity="left"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv12"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="42dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv13"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="42dp"
                    android:text="B" />
            </LinearLayout>

            <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="left"
                android:gravity="left"
                android:orientation="horizontal" >
                <TextView
                    android:id="@+id/tv14"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:layout_marginRight="20dp"
                    android:textSize="32dp"
                    android:text="A" />
                <TextView
                    android:id="@+id/tv15"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="#000000"
                    android:textSize="32dp"
                    android:text="B" />
            </LinearLayout>
        </LinearLayout>

    </RelativeLayout>
</RelativeLayout>

</ScrollView> 
```

如果我将 android:background="#FFFFFF" 设置为滚动视图背景，我会得到一个带有黑色文本的白色背景。如果我将它设置为 android:background="#000000" （因为它在 mdpi 和 hdpi 布局中，但我现在删除了它）我只看到纯黑色，因为现在 bg 和文本都是黑色的。当我没有为滚动视图设置背景颜色时，也会发生同样的情况。

我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T16:41:18.687

我真的不知道，但事实证明滚动视图是整个事情的背后。我删除了它，一切正常。奇怪的。

# php - SQL/PHP 和表格 - 将包含文本的列制作成 URL

> ID：12556022
> 
> 赞同：1
> 
> 时间：2012-09-23T20:33:40.753
> 
> 标签：php, sql, phpmyadmin

我在数据库中有一个列，该列填充了我的幻想体育网站上获得最多的运动员的表格中的列表，在该网站上，我希望能够将“Jamal Charles”作为网址并将其链接到内部已经创建的 Jamaal 网页。在表格下方，我有一个调用“公司名称”的函数——公司名称实际上是运动员的名字。

如何使“公司名称”成为此表中其自己页面的链接？我会创建另一个调用 url 的函数吗？制作另一列接受网址并调用它？我听说有时数据库只会回显 url 文本而不是链接。有没有可能？

如果您需要更多代码，请告诉我。提前谢谢大家！

今日收入最高的运动员 1\. Jamaal Charles 0.54 % 2\. Kyle Rudolph 0.50 % 3\. AJ Green 0.48 % 4\. Michael Bush 0.48 % 5\. Jared Cook 0.47 % 6\. Christian Ponder 0.45 % 7\. Alfred Morris 0.45 % 8\. Nate Washington 0.44 % 9\. 瑞恩·苏科普 0.44 % 10\. 德马科·默里 0.43 %

```
function getTopAthletes($connection){
$i=1;
$query = "SELECT b. companyname, (a.currentprice - a.open)/a.open as performance FROM jm_market a, jm_stocks b WHERE a.symbol = b.symbol AND active = 'Y' ORDER BY performance desc LIMIT 10";
$result=mysql_query($query,$connection) or die('Problem with obtaining top PLAYERS: ' . $query); 
$output = "<table class='tab1 bborder' cellspacing='0'>";
$output.= "<th colspan='4'>Top Gaining Athletes Today</th>";
while($row=mysql_fetch_array($result)){

  // Shorten really long names
  if (strlen($row['companyname']) > 20) {
     $short = split (' ', $row['companyname']);
     $row['companyname'] = substr( $short[0],0,1 ) . ". ";
     unset($short[0]);
     foreach ($short as $n) {
        $row['companyname'] .= $n . " ";
     } 
     $row['companyname'] = rtrim($row['companyname']);         
  }

    $output .="<tr ><td width='20px'><strong>" . $i.".</strong></td>";
    $output .="<td ><strong>" . $row['companyname']."</strong></td>";
    $output .="<td><strong>" . number_format(($row['performance']) * 100,2)." %</strong></td></tr>";
    $i++;

}
$output .= "</table>";
return $output; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T20:43:04.140

尝试这个

```
$output .="<td ><strong><a href='users.php?username=" . $row['companyname']."'>". $row['companyname']."</a></strong></td>"; 
```

那应该给你

```
<a href='users.php?username=John'>John</a> 
```

# php - 扩展 JFormField 的文件

> ID：12556028
> 
> 赞同：0
> 
> 时间：2012-09-23T20:34:49.673
> 
> 标签：php, forms

我在一个名为 iconbasic 的文件中有此代码，该文件应该运行我的个人资料图片上传器，但它不工作。有人知道为什么吗？

我是新手，但是，组件前端的 agentform 文件夹有一个 edit.php 文件，其中包含以下行：

```
<?php echo $this->form->getInput('icon'); ?> 
```

然后在模型文件夹中，我们有 agent.xml 文件，它基本上使用以下行将其指向 iconbasic.php：

```
 <field name="icon" type="iconbasic" label="COM_IPROPERTY_IMAGE" readonly="true" folder="agents" /> 
```

然后在组件的管理员文件中，我在名为 fields 的子文件夹内的模型文件夹中有一个名为 iconbasic.php 的文件。在前端，该站点允许我上传文件，然后我发现它们存储在正确的目录中，但它们没有显示在站点上。我正在尝试找出原因，并且非常感谢您的帮助。没有编码经验，今天自己使用记事本++或多或少地弄清楚了这一点:)

这是 iconbasic.php 文件：

```
<?php
/**
 * @version 2.0 2012-01-20
 * @package Joomla
 * @subpackage Intellectual Property
 * @copyright (C) 2012 the Thinkery
 * @license GNU/GPL see LICENSE.php
 */

defined('JPATH_BASE') or die;

jimport('joomla.html.html');
jimport('joomla.form.formfield');

class JFormFieldIconBasic extends JFormField
{
protected $type = 'Iconbasic';

protected function getInput()
{
    $user       = JFactory::getUser();
    $document   = JFactory::getDocument();
    $folder     = $this->element['folder']; // agents or companies
    $id         = JRequest::getInt('id');
    $settings   = ipropertyAdmin::config();
    $database   = JFactory::getDBO();

    switch ($folder){
        case 'agents':
            $width = $settings->agent_photo_width;
            $table = '#__iproperty_agents';
        break;
        case 'companies':
            $width = $settings->company_photo_width;
            $table = '#__iproperty_companies';
        break;
        default:
            $width = $settings->agent_photo_width;
            $table = '#__iproperty_agents';
        break;
    }

    $sql = "SELECT icon FROM ".$table." WHERE id = ".$id;
    $database->setQuery($sql);
    $icon = $database->loadResult();

    if (!$icon) $icon = 'nopic.png';

    $document->addScript( "http://bp.yahooapis.com/2.4.21/browserplus-min.js" );
    $document->addScript( "https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" );
    $document->addScript( JURI::root()."components/com_iproperty/assets/js/plupload/js/plupload.full.js" );

    $script = 
"jQuery.noConflict();
jQuery(document).ready(function($) {
var uploader = new plupload.Uploader({
    runtimes : 'html5,flash,silverlight,browserplus',
    browse_button : 'pickfiles',
    container : 'container',
    max_file_size : '2mb',
    unique_names : true,
    multipart: true,
    urlstream_upload: true,
    url : '".JURI::root()."index.php?option=com_iproperty&task=ajax.ajaxIconUpload&format=raw&".JUtility::getToken()."=1&target=".$folder."&id=".$id."',
    flash_swf_url : '".JURI::root()."components/com_iproperty/assets/js/plupload/js/plupload.flash.swf',
    silverlight_xap_url : '".JURI::root()."components/com_iproperty/assets/js/plupload/js/plupload.silverlight.xap',
    filters : [
        {title : 'Image files', extensions : 'jpg,gif,png'}
        //{title : '".JText::_('COM_IPROPERTY_IMAGE_TYPES')."', extensions : '".JText::_('COM_IPROPERTY_IMAGE_EXTENSIONS')."'}
    ],
    resize : {width : ".$width.", height : ".$width.", quality : 90} // we use the same value for width/height so it scales proportionally
});

$('#uploadfiles').click(function(e) {
    uploader.start();
    e.preventDefault();
});

uploader.init();

uploader.bind('FilesAdded', function(up, files) {
    $.each(files, function(i, file) {
        $('#filelist').append(
            '<div id=\"' + file.id + '\">' +
            file.name + ' (' + plupload.formatSize(file.size) + ') <b></b>' +
        '</div>');
    });

    uploader.start(); // auto start when file added

    up.refresh(); // Reposition Flash/Silverlight
});

uploader.bind('UploadProgress', function(up, file) {
    $('#' + file.id + \" b\").html(file.percent + \"%\");
});

uploader.bind('Error', function(up, err) {
console.log(err);
    $('#filelist').append(\"<div>Error: \" + err.code +
        \", Message: \" + err.message +
        (err.file ? \", File: \" + err.file.name : \"\") +
        \"</div>\"
    );
    up.refresh(); // Reposition Flash/Silverlight
});

uploader.bind('FileUploaded', function(up, file, info) {
    var finfo = jQuery.parseJSON(info.response);
    if (finfo[0].status){ // successful image upload
        var path = '".JURI::root()."media/com_iproperty/".$folder."/'+finfo[0].result;
        $('#ip_photo_holder').attr('src', path);
    }
});
});"."\n";   

    $document->addScriptDeclaration($script);
    // Build image select js and load the view
    $img_path   = JURI::root(true).'/media/com_iproperty/'.$folder.'/';     
    ?>
    <div style="padding: 4px;" id="container">
        <div id="filelist"></div><br />
        <a id="pickfiles" href="javascript:void(0);">[Select files]</a>
        <a id="uploadfiles" href="javascript:void(0);">[Upload files]</a>
    </div>
    <div><img id="ip_photo_holder" src="<?php echo JURI::root(); ?>/media/com_iproperty/<?php echo $folder.'/'.$icon; ?>"></div>
    <?php
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:39:20.590

这是 manage.php 文件中的一行错误的 SQL 位

# mysql - 是否可以在 MySQl 中将 LongText 转换为十六进制

> ID：12556031
> 
> 赞同：0
> 
> 时间：2012-09-23T20:34:59.207
> 
> 标签：mysql

我有一列，比如 col1，类型为 LongText，它包含一个长整数：例如：1233456777 ......等。我需要将此数字转换为十六进制并将其插入到新列中，例如 col2。这在 MySQL 中可能吗？如何？

我试图将长文本值导出到文本文件，使用 Java 将其转换，但我很难用新的十六进制更新记录。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:39:51.587

这个怎么样：

```
UPDATE myDatabase SET col2 = HEX(col1); 
```

这将获取 col1 的值，返回其 HEX 版本并将其放在 col2 中，用于 myDatabase 中的所有行。确保您有正确大小的 col2 定义。如果 HEX() 不采用 LONGTEXT，也许你可以使用 CONVERT...

```
UPDATE myDatabase SET col2 = HEX(CONVERT(col1, CHAR(255))); 
```

# ruby-on-rails - 对于 rails actionmailer，有什么方法可以调试 ActionView::Template::Error 错误？

> ID：12556032
> 
> 赞同：5
> 
> 时间：2012-09-23T20:35:03.443
> 
> 标签：ruby-on-rails, actionmailer

在我的 rails 3.1 应用程序中，我确实有

```
config.action_mailer.raise_delivery_errors = true 
```

在我的 development.rb 文件中（是​​的，自从将其更改为 true 后，已由本地开发服务器重新启动）。

但是，当我开发新的电子邮件模板并偶尔遇到 ActionView::Template::Error 时，我没有看到任何关于哪一行引发错误的调试信息。（与我的一个正常应用程序视图出现问题相反，日志显示有问题的 haml 源代码片段）。

有没有办法为邮件打开类似的调试消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-24T20:28:50.353

我使用 Rails 控制台而不是发出 Web 请求来测试动作邮件程序。如果发生错误，它将提供更多信息。

```
$ rails c
> MyMailer::maielr_name( var1, var2 ).deliver! 
```

# java - 第一个java程序

> ID：12556037
> 
> 赞同：1
> 
> 时间：2012-09-23T20:35:27.833
> 
> 标签：java

好的..一个非常菜鸟的问题。

这是我第一次尝试用java编写一个类。

我创建了一个项目（银行）、一个包（银行）和两个类`Account`，以及`Driver`

所以，我的项目看起来像：

```
 Bank --> src-->bank --> Account.java --> Driver.java 
```

现在`Driver.java`有`main`。

我如何`Account.java`从`Driver.java`

我`bank`在两个文件中都包含了包。

```
 Account myAccount = **Account**("foobar",12345); bold is where the error is. 
```

它无法找到 Account 类。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T20:36:19.793

在 Java 中，您使用关键字创建对象`new`

```
Account myAccount = new Account("foobar",12345); 
```

作为旁注：如果您的所有类都在同一个**包**中，则不需要导入它们，但如果您`Account`在另一个包中，则必须使用导入它

```
import path.to.package.Account; 
```

您继续学习的另一个旁注，与这个问题无关：如果您只是调用 a `static method`in `Account.java`，则不需要创建对象。你会喜欢：

```
Account.mymethod() 
```

# text - 尝试在 telnet 脚本的引号之间插入文本

> ID：12556043
> 
> 赞同：1
> 
> 时间：2012-09-23T20:36:35.400
> 
> 标签：text, insert, applescript, quotes

抱歉，对 Applescript 进行编码是新手，因此不胜感激。

我正在尝试创建一个脚本，将剪贴板中的文本粘贴到 telnet 命令的中间。输出需要在同一个窗口中，看起来像这样：

```
I8,A,001
Q102,024
q448
rN
S4
D15
ZT
JF
O
R71,0
f100
N
B264,65,2,UA0,2,4,56,B,"100000000045"
A203,82,2,1,2,2,N,"xxxxx"
P1 
```

第 13 行引用的 12 位数字是我需要插入的。

这是我到目前为止编写的代码，但它不起作用：

```
tell application "Terminal"

    do script "telnet xxx.xxx.xx.xx xxxx"
    delay 1
    do script "I8,A,001" in window 1
    do script "Q102,024" in window 1
    do script "q448" in window 1
    do script "rN" in window 1
    do script "S4" in window 1
    do script "D15" in window 1
    do script "ZT" in window 1
    do script "JF" in window 1
    do script "O" in window 1
    do script "R71,0" in window 1
    do script "f100" in window 1
    do script "N" in window 1
    do script "B264,65,2,UA0,2,4,56,B,\""
    tell application "System Events"
        tell application process "Terminal" in window 1
            keystroke "v" using {command down}
        end tell
        keystroke "\""
        keystroke return
        do script "\"A203,82,2,1,2,2,N,\"xxxxx\""
        do script "P1"
        keystroke return
    end tell
end tell 
```

一旦我尝试使用命令 V 粘贴，它就会退出终端窗口并将剪贴板上的内容粘贴到脚本上，它不会让我告诉它留在终端窗口 1 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T00:39:36.850

您无需使用 command-v 即可将剪贴板内容放入终端窗口。Applescript 可以获取剪贴板，然后您只需在“执行脚本”之前将其添加到字符串的另一部分。像这样的工作......当然，您不需要代码的第一行，因为剪贴板应该已经具有该值。

```
set the clipboard to "100000000045"

set t1 to "B264,65,2,UA0,2,4,56,B,\""
set t2 to the clipboard
set t to t1 & t2 & "\""
do script t in window 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T20:43:23.843

这就是我最终用来让它工作的东西，以防其他人需要它：

 ``tell application "Terminal"

```
do script "telnet xxx.xxx.xx.xx xxxx"
delay 1
do script "I8,A,001" in window 1
do script "Q102,024" in window 1
do script "q448" in window 1
do script "rN" in window 1
do script "S4" in window 1
do script "D15" in window 1
do script "ZT" in window 1
do script "JF" in window 1
do script "O" in window 1
do script "R71,0" in window 1
do script "f100" in window 1
do script "N" in window 1
set t1 to "B264,65,2,UA0,2,4,56,B,\""
set t2 to the clipboard
set t to t1 & t2 & "\""
do script t in window 1
do script "A203,82,2,1,2,2,N,\"xxxxx\"" in window 1
do script "P1" in window 1 
```` 

`end tell`

感谢您的帮助轩辕！`

# iphone - 在 UILabel xcode 中显示 NSLog 结果

> ID：12556046
> 
> 赞同：2
> 
> 时间：2012-09-23T20:36:47.693
> 
> 标签：iphone, xcode, view, sdk, tableview

我有 RootCtrl 和 DetailCtrl。在 RootCtrl 上，我有一个 uiTableview。我使用这个函数来写出选择的结果：

```
 UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    NSLog(@"%@",cell.textLabel.text); 
```

进入**didSelectRowAtIndexPath**。我想将 UILabel 中的 NSLog 结果显示到 Detailctrl 中，所以是另一个视图。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:06:34.273

**在 中输入以下代码`RootViewController`：**

```
UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
NSString*yourStringNameHere = [NSString stringWithFormat:@"%@",cell.textLabel.text];
NSLog(@"%@",yourStringNameHere);//this isn't used in retreiving the info
NSNumber *number = [NSNumber numberWithInt:1];
NSDictionary *yourDictionaryNameHere = [NSDictionary dictionaryWithObjectsAndKeys:
                    yourStringNameHere, @"yourStringNameHereDictionary",nil]; 
```

* * *

**在 中输入以下代码`DetailViewController`：**

在头文件（.h）中放

```
IBOutlet UILabel *yourLabelNameHere; 
```

在主文件（.m）中使用

```
yourLabelNameHere.text= [yourDictionaryNameHere objectForKey:(@"yourStringNameHereDictionary")]; 
```

* * *

**笔记：**

*   **如果您无法访问字典，请输入 #import "RootViewController.h"**
*   我们使用[NSDictionary](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html)将数据存储在 iPhone 内存中，这允许我们使用来自其他类的数据，否则仅使用 #import 您只能接收来自变量初始化的数据。
*   从键接收来自 NSDictionary 的字符串
*   `DetailViewController.h`在输出到情节提要或 xib 文件的 UILabel 中设置
*   要在转换开始时加载标签，请将字典接收器`ViewDidLoad`或方法（`-(void)function)`由`ViewDidLoad`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:40:41.963

你必须`@property UILabel* myLabel`在你的`DetailCtrl`班级中设置一个。然后，使用

```
MyDetailCtrlInstance.myLabel.text = cell.textLabel.text 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T23:27:36.627

好的，首先，忘记 NSLog 输出。NSLog 是 NSLog。那是另一回事。您真正想要的是获取单元格的文本，将其存储在某个地方，在另一个类中检索它并显示它。所以我要做的是创建外部变量（一个 NSString），将新选择的单元格文本存储在 didselectrowatindexpath 中，并在 Detailctrl 中访问它。

不确定是否每个人都会这样做，但我就是这样做的，它应该可以工作。

# javascript - 用户键入时每 5 个字符插入“-”[如产品密钥]

> ID：12556051
> 
> 赞同：4
> 
> 时间：2012-09-23T20:37:35.850
> 
> 标签：javascript, jquery

> **可能重复：**
> [使用 jQuery 插件自动格式化结构化数据（电话、日期）（或无法使用原生 JavaScript）](https://stackoverflow.com/questions/109854/auto-format-structured-data-phone-date-using-jquery-plugin-or-failing-that-v)
> [在特定字符后插入空格到 javascript 字符串中](https://stackoverflow.com/questions/6579584/insert-space-after-certain-character-into-javascript-string)

我正在尝试编写一个脚本来处理您在软件和游戏背面看到的产品密钥。

我希望当用户输入他们的密钥代码时，每 5 个字符插入 5 个字符集的“-”。例如（`ABCDE-FGHIJ-KLMNO-PQRST-UVWXY`）。因此，当用户输入`ABCDE`' ' 后立即通过 jQuery 或 JavaScript 插入`E`一个 ' '。`-`

提前致谢。如果您有任何问题或我不清楚，请发表评论:)

形式：

```
<form method="post" action="process.php">
<p>Key: <input name="key" id="key" size="40"></p>
<p><input type="submit"></p>
</form> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-23T20:41:49.653

您可以使用[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

```
jQuery(function($){
   $("#key").mask("aaaaa-aaaaa-aaaaa-aaaaa-aaaaa");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T20:46:16.297

如何使用[http://digitalbush.com/projects/masked-input-plugin](http://digitalbush.com/projects/masked-input-plugin)

使用该插件，以下内容：

```
jQuery(function($){
   $("#key").mask("99999-99999-99999-99999-99999",{placeholder:" "});
}); 
```

或者，如果您的密钥是所有字母，请使用：

```
$("#key").mask("aaaaa-aaaaa-aaaaa-aaaaa-aaaaa",{placeholder:" "}); 
```

或者，如果它是字母/数字使用：

```
$("#key").mask("*****-*****-*****-*****-*****",{placeholder:" "}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T20:54:40.080

HTML：

```
<fieldset id="productkey">
    <input type="text" size="5" maxlength="5">
    <input type="text" size="5" maxlength="5">
    <input type="text" size="5" maxlength="5">
    <input type="text" size="5" maxlength="5">
    <input type="text" size="5" maxlength="5">
</fieldset> 
```

JavaScript：

```
$( '#productkey' ).on( 'keyup', 'input', function () {
    if ( this.value.length === 5 ) {
        $( this ).next().focus();            
    }
}); 
```

**现场演示：http:** [//jsfiddle.net/XXLND/3/show/](http://jsfiddle.net/XXLND/3/show/)

您还可以增强代码，以便在填写最后一个文本框时激活处理机制：

```
$( '#productkey' ).on( 'keyup', 'input', function () {
    var $field = $( this );

    if ( $field.val().length === 5 ) {
        if ( $field.is( ':last-of-type' ) ) {
            $field.blur();
            processKey();              
        } else {
            $field.next().focus();            
        }
    }
}); 
```

**现场演示：http:** [//jsfiddle.net/XXLND/4/show/](http://jsfiddle.net/XXLND/4/show/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T21:21:32.257

只是因为我不喜欢 JQuery :)

```
function insertSpace(string, part, maxParts) {
    "use strict";
    var buffer = string.split("-"), step, i;
    for (i = 0; i < buffer.length; i += 1) {
        step = buffer[i];
        if (step.length > part) {
            buffer[i] = step.substr(0, part);
            buffer[i + 1] = step.substr(part) + (buffer[i + 1] || "");
        } else if (step.length < part) {
            if (i == buffer.length - 1) {
                if (!step) {
                    buffer.pop();
                }
            } else {
                buffer[i + 1] = step + (buffer[i + 1] || "");
                buffer.splice(i, 1);
                i -= 1;
            }
        }
    }
    buffer.length = Math.min(maxParts, buffer.length);
    return buffer.join("-");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-23T20:56:59.570

这是一种方法：

```
// binds to both the 'keyup' and 'paste' events
$('input:text').on('keyup paste', function(e) {
    var that = $(this), // caches the $(this)
        val = that.val(), // access the value of the current input
        key = e.which, // determines which key was pressed
        allowed = [8, 46, 9, 16]; // defines 'allowed' keys (for editing/focusing)
                                  // backspace, delete, tab, shift
        if ($.inArray(key, allowed) == -1) {
            // if the pressed key is *not* an 'allowed' key
            if (val.length == 5) {
                // focuses the next element
                that.next().focus();
            }
            else if (val.length > 5) {
                // truncates the string, if greater than 5 characters
                that.val(val.substring(0, 5));
                that.next().focus();
            }
        }
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/JQQ9Z/1/)。

这种方法的优点是，您无需屏蔽或操作输入的字符串并考虑多种边缘情况，而是通过将焦点移动到正确的点来帮助用户。并且，在这种情况下，还允许用户重新聚焦重新编辑先前输入的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T20:49:18.940

两件事情：

在用户体验方面，我会避免在用户键入代码时在输入字段中动态添加字符。根据您运行的环境，您可能会干扰用户键入的内容。但是，“-”有助于用户键入代码，因为这是他的参考点。所以我建议有一个输入字段并在它旁边显示一个漂亮的代码版本（或者使该字段不可见并自己管理该字段的焦点）。

对于 php 代码，我不会每 5 个字符添加一个字符，而是通过删除所有不必要的字符来简化代码。类似的东西

```
if ( str_replace('-', '', $userInputKey)==str_replace('-', '', $officialKey) {
 echo 'Yeah! Valid key!';
} 
```

# java - Android - 带有 OPENGL + 纹理的 3D 立方体

> ID：12556054
> 
> 赞同：1
> 
> 时间：2012-09-23T20:38:09.623
> 
> 标签：java, android, opengl-es, bitmap, cube

我已经在 Android 上用 OPENGL 库完成了一个 3d 立方体，立方体工作得很好，但是要在立方体上打印的图像没有显示......

这是我的渲染（java类）的代码：

```
public class GLRenderEx implements Renderer {

    private GLCube cube;
    Context c;

    public GLRenderEx(Context c) {
        cube = new GLCube();
        this.c = c;
    }

    @Override
    public void onDrawFrame(GL10 gl) {
        gl.glDisable(GL10.GL_DITHER);
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
        gl.glMatrixMode(GL10.GL_MODELVIEW);
        gl.glLoadIdentity();
        GLU.gluLookAt(gl, 0, 0, -3, 0, 0, 0, 0, 2, 0);

        long time = SystemClock.uptimeMillis() % 4000L;
        float angle = .090f * ((int) time);
        gl.glRotatef(angle, 2, 4, 3);

        cube.draw(gl);

    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        // TODO Auto-generated method stub
        gl.glViewport(0, 0, width, height);
        float ratio = (float) width / height;
        gl.glMatrixMode(GL10.GL_PROJECTION);
        gl.glLoadIdentity();
        gl.glFrustumf(-ratio, ratio, -1, 1, 1, 25);
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig egl) {
        gl.glDisable(GL10.GL_DITHER);
        gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_FASTEST);
        gl.glClearColor(0f, 0f, 0f, 1);
        gl.glClearDepthf(1f);
    }

} 
```

这是我的立方体的代码：

```
 public class GLCube {

    /** The buffer holding the vertices */
    private FloatBuffer vertexBuffer;
    /** The buffer holding the texture coordinates */
    private FloatBuffer textureBuffer;
    /** The buffer holding the indices */
    private ByteBuffer indexBuffer;

    /** Our texture pointer */
    private int[] textures = new int[1];

    /**
     * The initial vertex definition
     * 
     * Note that each face is defined, even if indices are available, because of
     * the texturing we want to achieve
     */
    private float vertices[] = {
            // Vertices according to faces
            -1.0f,
            -1.0f,
            1.0f, // Vertex 0
            1.0f,
            -1.0f,
            1.0f, // v1
            -1.0f,
            1.0f,
            1.0f, // v2
            1.0f,
            1.0f,
            1.0f, // v3

            1.0f,
            -1.0f,
            1.0f, // ...
            1.0f, -1.0f, -1.0f, 1.0f, 1.0f, 1.0f, 1.0f, 1.0f, -1.0f,

            1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, 1.0f, 1.0f, -1.0f, -1.0f,
            1.0f, -1.0f,

            -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, 1.0f, -1.0f, 1.0f, -1.0f, -1.0f,
            1.0f, 1.0f,

            -1.0f, -1.0f, -1.0f, 1.0f, -1.0f, -1.0f, -1.0f, -1.0f, 1.0f, 1.0f,
            -1.0f, 1.0f,

            -1.0f, 1.0f, 1.0f, 1.0f, 1.0f, 1.0f, -1.0f, 1.0f, -1.0f, 1.0f,
            1.0f, -1.0f, };

    /** The initial texture coordinates (u, v) */
    private float texture[] = {
            // Mapping coordinates for the vertices
            0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, 1.0f,

            0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, 1.0f,

            0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, 1.0f,

            0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, 1.0f,

            0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, 1.0f,

            0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, 1.0f,

    };

    /** The initial indices definition */
    private byte indices[] = {
            // Faces definition
            0, 1, 3, 0, 3,
            2, // Face front
            4, 5, 7, 4, 7,
            6, // Face right
            8, 9, 11, 8, 11,
            10, // ...
            12, 13, 15, 12, 15, 14, 16, 17, 19, 16, 19, 18, 20, 21, 23, 20, 23,
            22, };

    /**
     * The Cube constructor.
     * 
     * Initiate the buffers.
     */
    public GLCube() {
        //
        ByteBuffer byteBuf = ByteBuffer.allocateDirect(vertices.length * 4);
        byteBuf.order(ByteOrder.nativeOrder());
        vertexBuffer = byteBuf.asFloatBuffer();
        vertexBuffer.put(vertices);
        vertexBuffer.position(0);

        //
        byteBuf = ByteBuffer.allocateDirect(texture.length * 4);
        byteBuf.order(ByteOrder.nativeOrder());
        textureBuffer = byteBuf.asFloatBuffer();
        textureBuffer.put(texture);
        textureBuffer.position(0);

        //
        indexBuffer = ByteBuffer.allocateDirect(indices.length);
        indexBuffer.put(indices);
        indexBuffer.position(0);
    }

    /**
     * The object own drawing function. Called from the renderer to redraw this
     * instance with possible changes in values.
     * 
     * @param gl
     *            - The GL Context
     */
    public void draw(GL10 gl) {
        // Bind our only previously generated texture in this case
        gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);
        gl.glEnable(GL10.GL_TEXTURE_2D);
        // Point to our buffers
        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);

        // Set the face rotation
        gl.glFrontFace(GL10.GL_CCW);

        // Enable the vertex and texture state
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, vertexBuffer);
        gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, textureBuffer);

        // Draw the vertices as triangles, based on the Index Buffer information
        gl.glDrawElements(GL10.GL_TRIANGLES, indices.length,
                GL10.GL_UNSIGNED_BYTE, indexBuffer);

        // Disable the client state before leaving
        gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
    }

    /**
     * Load the textures
     * 
     * @param gl
     *            - The GL Context
     * @param context
     *            - The Activity context
     */
    public void loadGLTexture(GL10 gl, Context context) {
        // Get the texture from the Android resource directory
        InputStream is = context.getResources().openRawResource(
                R.drawable.ic_launcher);
        Bitmap bitmap = null;
        try {
            // BitmapFactory is an Android graphics utility for images
            bitmap = BitmapFactory.decodeStream(is);

        } finally {
            // Always clear and close
            try {
                is.close();
                is = null;
            } catch (IOException e) {
            }
        }

        // Generate one texture pointer...
        gl.glGenTextures(1, textures, 0);
        // ...and bind it to our array
        gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);

        // Create Nearest Filtered Texture
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER,
                GL10.GL_NEAREST);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER,
                GL10.GL_LINEAR);

        // Different possible texture parameters, e.g. GL10.GL_CLAMP_TO_EDGE
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S,
                GL10.GL_CLAMP_TO_EDGE);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T,
                GL10.GL_CLAMP_TO_EDGE);

        // Use the Android GLUtils to specify a two-dimensional texture image
        // from our bitmap
        GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);

        // Clean up
        bitmap.recycle();
    }
} 
```

为什么我的代码上的位图没有显示在多维数据集中？？！！

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-19T06:01:21.273

我查看了您的代码，但没有找到您调用的地方`loadGLTexture()`。当我实现你的代码来制作纹理时，我只是在`cube.loadGLTexture(gl, c);`上面`cube.draw(gl);`的`onDrawFrame()`方法中添加了。希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T20:44:42.723

如果要为对象添加纹理，则必须启用纹理`glEnable(GL_TEXTURE_2D);`

我在您的代码中的任何地方都没有看到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T08:24:04.720

我和你一样有问题。

导致我的问题是纹理与立方体不完全匹配。

仔细检查您的代码，您可能会注意到一些不匹配。

# class - 两个继承的类可以访问基类中的同一个变量吗？

> ID：12556055
> 
> 赞同：0
> 
> 时间：2012-09-23T20:38:20.653
> 
> 标签：class

什么是设计类的好方法？我正在尝试创建一个简单的聊天程序。我希望封装屏幕中对象使用的所有内容。我创建了一些类，一个日志类，一个消息堆类（用于保存已接收和发送的消息），一个文本框类和一个按钮类。我希望消息堆、文本框和按钮共享相同的字符串变量，但我希望它封装在类中。

我确实尝试过创建一个 Base 类。这将保存文本框和按钮类共有的所有数据和函数。这三个类将从 Base 派生以使用其共享变量。只有当我这样做时，变量才没有共享。有没有办法做到这一点？有点像全局变量？仅在其自己的类及其派生类中？两个派生类的两个对象都应该能够访问基类对象的变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:53:30.860

您正在混淆类和对象。当您有一个带有一些成员变量的基类时，所有派生类都可以（可能）访问基类中的成员变量。

但是，当您实例化不同的派生类或其中一个派生类多次时，每个对象都有一组完整的独立成员变量，包括来自基类的成员变量，因为这正是对象的本质。

如果您希望某些对象组使用相同的“共享”变量，那么您可以将这些共享的东西粘贴到专用的“共享”类中。然后对于需要共享这些“变量”的每组对象，创建这个“共享”类的实例，并将其传递给组中的所有对象。

这也比摆弄“静态”类成员或在您使用的语言中调用它们更灵活，因为您可以通过拥有多个“共享”对象并确切地决定哪个对象来拥有多个这些对象“组” “实际”对象共享相同的“共享”数据/变量。

如果不了解更多关于正在发生的事情，就很难就如何设计类和对象层次结构提供更多建议。

# android - 如何制作网页视图？

> ID：12556056
> 
> 赞同：0
> 
> 时间：2012-09-23T20:38:34.353
> 
> 标签：android

我不知道怎么做。

让我发布我的代码。这里的代码是基本的 Hello, World! 活动。

```
 package com.apw.games.rpg.medieval;

import android.app.*;
import android.os.*;
import android.view.*;
import android.widget.*;
import android.content.*;

public class Site extends Activity
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.site);
          }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T20:41:28.527

```
WebView webView = (WebView) findViewById(R.id.webview);     
    webView.loadUrl("http://www.google.com"); 
```

然后，在您的 中`site.xml`，放置一个`WebView`带有 ID 的元素`@+id/webview`。

# ms-word - MS word 模板不会将加载项保存为活动的

> ID：12556064
> 
> 赞同：0
> 
> 时间：2012-09-23T20:39:20.377
> 
> 标签：ms-word

我有一个带有宏的文件（文件类型是启用 word 宏的模板 .dotm），同一个文件也有一个功能区修改（自定义选项卡中的一个按钮，它在同一个文件中调用宏）。

宏非常简单 - 只需在当前文档中插入静态文本。

我有一个不同的文件（相同类型的.dotm），我通过“开发人员->加载项”包含第一个文件。结果，我有了一个带有按钮的新功能区选项卡。如果我按下按钮，我在文档中有文本 - 一切正常。直到我保存/加载文件。它从不保存包含的加载项状态，此加载项始终处于非活动状态（如果我手动激活它，它可以工作）。

如果我将模板文件放入它加载的 Word 启动文件夹中，但我不想为所有文档加载它，只为那个文档加载它。

我尝试启用所有宏，签署第一个文件 - 没有任何效果。该加载项未选中（您可以在列表中看到它，但它被标记为非活动）。（显示加载项用户界面错误 - 不显示任何内容）。

为什么 Word 不能将包含的加载项保存为活动以及如何使其将加载项保存为活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T20:21:57.593

看起来您无法仅为单个文档加载模板/加载项。您可以为会话加载加载项或将其放入启动文件夹以为每个文档加载它。

# java - OpenCV Android - 如何围绕轮廓绘制圆形/矩形？

> ID：12556073
> 
> 赞同：3
> 
> 时间：2012-09-23T20:40:17.263
> 
> 标签：java, android, opencv, draw, contour

我是openCV的新手，因此我有一些问题。

一个问题是如何获得轮廓的坐标以绘制例如围绕它的圆圈。

到目前为止，我的代码如下所示：

```
List<MatOfPoint> contours = mDetector.getContours();
Imgproc.drawContours(mRgba, contours, -1, CONTOUR_COLOR, -1);
<<code that I need>>
Core.circle(mRgba, new Point(150.0,150.0), 100, CONTOUR_COLOR, 5); 
```

轮廓也被“提取”并绘制在测试圆的表面上，但是如何从轮廓中获取坐标（边界）以围绕每个轮廓绘制一个圆。

谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T21:54:05.910

我相信[boundingRect](http://opencv.itseez.com/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=boundingrect#boundingrect)和[minEnclosureCircle](http://opencv.itseez.com/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=minenclosingcircle#minenclosingcircle)也可用于 android。这些函数直接做你想做的事。[你可以在这里](http://docs.opencv.org/doc/tutorials/imgproc/shapedescriptors/bounding_rects_circles/bounding_rects_circles.html)找到一个非常好的教程。

# asp.net-mvc - 在 mono 或 windows 上托管 ServiceStack、MVC3 或 MVC4，mono 的状态是什么

> ID：12556081
> 
> 赞同：5
> 
> 时间：2012-09-23T20:42:19.170
> 
> 标签：asp.net-mvc, asp.net-mvc-3, mono, servicestack

我正在尝试决定为新的基于 Web 的后台系统使用什么堆栈。我们使用 C# 进行开发，并将使用 ServiceStack 和/或 ASP.NET MVC。我们的客户更喜欢在 Linux 服务器上托管，因此这排除了 MVC4，因为 Mono 不支持它。

[此外，由于类似https://serverfault.com/questions/330298/stopping-fastcgi-mono-server-gracefully-website](https://serverfault.com/questions/330298/stopping-fastcgi-mono-server-gracefully-website-content-updating-with-no-need-t)的帖子，我们担心在 Mono 上运行 ASP.NET 所需的 mono-fastcgi-server 的状态[-content-updating-with-no-need-t](https://serverfault.com/questions/330298/stopping-fastcgi-mono-server-gracefully-website-content-updating-with-no-need-t)并且因为我们发现很难找到有关项目状态的相关和最新信息。因此，我们也犹豫在单声道上使用 MVC3。

现在我们正在考虑使用托管在后面的控制台应用程序和 NGINX 反向代理中的 ServiceStack（带有新的 Razor 视图！）。这似乎工作正常，ServiceStack 文档表明这是一个可行的解决方案。但是单声道呢？它对于严肃的生产站点和服务是否足够稳定，垃圾收集器是否性能良好等？有没有人有在单声道上托管繁忙的服务器应用程序（使用 httplistener 的控制台应用程序）的最新经验 - 如果是这样，它是如何工作的，你会推荐它吗？你用的是什么版本的单声道？

我们的替代方案是强制我们的客户接受 Windows 服务器，然后我们将使用服务堆栈或 mvc4 与服务堆栈相结合。

总而言之，您会做什么/考虑什么？您在单声道上托管服务器应用程序的经验是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T21:28:21.963

## ServiceStack.net 一直在 Linux/Mono 上运行

[请注意，在servicestack.net](http://www.servicestack.net/)上托管的所有实时演示都**在 Ubuntu linux vServer 上运行**。servicestack.net 多年来一直托管在 Linux/Mono 上，事实上，在[从 hetzner 迁移到 Ubuntu vServer](http://www.servicestack.net/100k-downloads/#future)之前，我们的旧[CentOS 服务器的正常运行时间为 480 天](http://www.servicestack.net/mythz_blog/?p=838)。我们认为 Mono 是一个越来越重要的支持平台，因为我们预计纯 linux 云的出现将成为一项重要的竞争优势，因为它允许您以[0 美元的软件许可成本](http://www.servicestack.net/100k-downloads/#future)进行扩展。

### 使用 VS.NET 在 Windows 上开发并部署到 Mono/Linux

对于所有 ServiceStack 现场演示，我们**使用 VS.NET 在 Windows 上开发，**但我们在 Linux 上进行 git-deploy 和**构建和托管**。正如我们的[发行说明](https://github.com/ServiceStack/ServiceStack/wiki/Release-Notes)中所述，我们特别注意支持 Mono 作为一等公民，我们尽可能地应用规范化行为，因此移植现有的 IIS/ASP.NET 站点仍然是微不足道的（即您应该能够复制和运行二进制文件原样！） - 这扩展到我们采用的外部依赖项，这些依赖项受到它们对 Mono 的支持的影响。

### 包括 Razor Live 演示在内的所有演示都托管在 Mono/Linux 上

所有 ServiceStack 演示都托管在 Linux 上，这包括[Razor 示例](http://razor.servicestack.net/)，该示例在 Mono 上部署和托管了 2 个版本，即

*   [razor.servicestack.net](http://razor.servicestack.net) - 由 Linux / Nginx / MonoFastCGI 提供支持的 ASP.NET 托管现场演示
*   [razor-console.servicestack.net](http://razor-console.servicestack.net) - 托管在 Nginx 反向代理后面的自托管控制台应用程序

您可能想查看这个问题，了解[在 Linux 上托管 ServiceStack](https://stackoverflow.com/questions/12188356/what-is-the-best-way-to-run-servicestack-on-linux-mono)的不同方法。

# php - MySQL 错误 Reatest-n-per-group

> ID：12556085
> 
> 赞同：0
> 
> 时间：2012-09-23T20:42:46.533
> 
> 标签：php, greatest-n-per-group

帮我！

```
 SELECT ma_forum.*, ma_forum_cat.*

        FROM ma_forum, ma_forum_cat

        JOIN ma_forum_comentarios ON ma_forum_comentarios.not_id = ma_forum.not_id

        GROUP BY ma_forum.not_id

        WHERE ma_forum.notcat_id=ma_forum_cat.notcat_id AND ma_forum.notcat_id='".$notcat_id."' 

        AND ma_forum.not_status='Ativo'

        ORDER BY MAX(ma_forum_comentarios.comnot_data) DESC 
```

“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 9 行的 'WHERE ma_forum.notcat_id=ma_​​forum_cat.notcat_id AND ma_forum.notcat_id='1' ' 附近使用正确的语法”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T20:49:44.467

您的查询顺序错误；GROUP BY 应该在 WHERE 之后和 ORDER BY 之前：

```
SELECT ma_forum.*, ma_forum_cat.*
FROM ma_forum, ma_forum_cat
JOIN ma_forum_comentarios ON ma_forum_comentarios.not_id = ma_forum.not_id
WHERE ma_forum.notcat_id=ma_forum_cat.notcat_id AND ma_forum.notcat_id='".$notcat_id."' 
AND ma_forum.not_status='Ativo'
GROUP BY ma_forum.not_id
ORDER BY MAX(ma_forum_comentarios.comnot_data) DESC 
```

我不知道您使用的是什么数据库，但这是[MySQL 的 SELECT 语法的链接](http://dev.mysql.com/doc/refman/5.0/en/select.html)

# php - 将 findBy 参数传递给回调方法 afterFind

> ID：12556086
> 
> 赞同：0
> 
> 时间：2012-09-23T20:42:48.687
> 
> 标签：php, cakephp, cakephp-model

我正在尝试捕获某个 findBy 调用（使用 afterFind），其中：

如果 $results 为空（或者您要查找的值不存在），但在另一个表上找到了参数值，则它将修改 $results 为有效

一些控制器动作得到了这个：

```
$this->User->findByUsername("Bingo"); // yes, username Bingo doesnt exist on users table 
```

用户型号：

```
function afterFind($results, $primary){
    if(empty($results)) {
        if(in_array($findbyparameter, array("Bingo", "Bingo1", "Bingo2"))) {
            // modify $results
        }
    }
} 
```

问题是，我如何获得 $findby 参数？

谢谢！所有帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:19:25.077

我没有使用这些便捷方法，但您可以像这样将变量作为 Model 属性传递：

```
//where you search 
$this->User->searchPhrase = "Bingo";
findByUsername($this->User->searchPhrase);

//Model
function afterFind($results, $primary){
    if(empty($results)) {
        if(in_array($this->searchPhrase, array("Bingo", "Bingo1", "Bingo2"))) {
            // modify $results
        }
    }
} 
```

这不是最漂亮的方法，但我想它会起作用。尝试在 afterFind 方法中 print_r($this) 看看你是否可以在某个地方找到你搜索的短语。我相信它是在条件数组中传递的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:28:13.270

也许您正在寻找自定义查找类型。自定义查找类型有两种状态：`before`和`after`.

在之前您将设置您的条件，在之后您将检查您的数据并在必要时进行修改。在这两个州，您都可以访问查询选项。

设置自定义查找在 1.x 和 2.x 中略有不同（您没有提到您使用的是哪个版本），因此您可以在书中查找具体内容。

简而言之，您可以将您的查找类型添加到`$findMethods`模型的属性中，然后将相应的方法名称添加到您的模型中。假设您将自定义查找类型称为“byUsername”

```
protected function _findByUsername($state, $query, $results = array()) {
    if ($state === 'before') {
        // add your condition to the query, 
        return $query;
    } elseif ($state === 'after') {
        // modify $results if you need to
        return $results;
    }
} 
```

你会通过调用它`$this->User->find('byUsername', array('username' => $username));`

在`$query`您将拥有密钥“用户名”，您可以将其添加`conditions`到`$query`. 在这两个州，您都可以访问`$query['username']`.

# matlab - 使用齐次坐标实现矩阵变换

> ID：12556087
> 
> 赞同：2
> 
> 时间：2012-09-23T20:42:50.337
> 
> 标签：matlab, image-processing, matrix, transformation

目前，我需要使用matlab编写一个程序来使用这样的齐次坐标转换矩阵

```
% for translation
T = [1 0 dx; 0 1 dy; 0 0 1]; 
```

例如：

```
A =
    92    99     1     8    15    67    74    51    58    40
    98    80     7    14    16    73    55    57    64    41
     4    81    88    20    22    54    56    63    70    47
    85    87    19    21     3    60    62    69    71    28
    86    93    25     2     9    61    68    75    52    34
    17    24    76    83    90    42    49    26    33    65
    23     5    82    89    91    48    30    32    39    66
    79     6    13    95    97    29    31    38    45    72
    10    12    94    96    78    35    37    44    46    53
    11    18   100    77    84    36    43    50    27    59

>> I = translate(A, 4, 4)
I =

   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
   NaN   NaN   NaN   NaN    92    99     1     8    15    67
   NaN   NaN   NaN   NaN    98    80     7    14    16    73
   NaN   NaN   NaN   NaN     4    81    88    20    22    54
   NaN   NaN   NaN   NaN    85    87    19    21     3    60
   NaN   NaN   NaN   NaN    86    93    25     2     9    61
   NaN   NaN   NaN   NaN    17    24    76    83    90    42 
```

单元`NaN`格的意思是“空白空间”。如您所见，`A`矩阵在轴上平移 4 个单位，在`x`轴上平移 4 个单位`y`，留下`NaN`值。输出矩阵`I`的大小必须与 相同`A`。

但是，我当前的程序使用图像不能正常工作（它不会在空白处放置“NaN”值，而是放置“1”）：

所以，这是我的程序：

```
function t_matrix = translate(input_matrix, dx, dy)

    [rows cols] = size(input_matrix);

    t_matrix = input_matrix;
    t_matrix(:) = NaN;

    T = [1 0 dx; 0 1 dy; 0 0 1];

    for n = 1:numel(input_matrix)

        [x y] = ind2sub([rows cols], n);

        v = [x y 1]';

        v = T*v;

        a = floor(v(1));
        b = floor(v(2));

        if a > 0 && b > 0
            t_matrix(a, b) = input_matrix(x,y);
        end
    end

    t_matrix = t_matrix(1:rows, 1:cols); 
```

如何以更简单的方式使用 matlab 实现齐次变换？

唯一的限制：继续使用这个矩阵：

```
% for translation
T = [1 0 dx; 0 1 dy; 0 0 1]; 
```

并为空白保留 NaN 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T08:24:02.280

您的代码的问题可能是您对整数进行操作，而 NaN 是一个双精度值。您不能将 input_matrix 分配给 t_matrix。您应该使用 nan 函数创建 t_matrix：

```
 t_matrix = nan(size(input_matrix)); 
```

以下是你代码的直接翻译，我只是去掉了循环

```
function I = translate(input_matrix, dx, dy)
    % get matrix dimensions
    [rows cols] = size(input_matrix);
    T = [1 0 dx; 0 1 dy; 0 0 1];
    % create a nan's output matrix
    I = nan(size(input_matrix));

    % create row-column index pairs
    [R C] = meshgrid(1:cols, 1:rows);
    % append 1 at the end
    IDX = [R(:) C(:) ones(numel(input_matrix),1)]';
    % transform coordinates
    V = floor(T*IDX);
    % find indices that fall into [rows, cols] range
    keep = find(V(1,:)>0 & V(1,:)<=rows & V(2,:)>0 & V(2,:)<=cols);
    % assign output only to the correct indices
    I(sub2ind([rows cols], V(1,keep), V(2,keep))) = input_matrix(sub2ind([rows cols], R(keep), C(keep)))
end 
```

另一方面，您可以通过运行以下函数获得与问题相同的结果（虽然没有 T 矩阵..）

```
function I = translate(A, dx, dy)
    I = nan(size(A));
    I(dx+1:end, dy+1:end) = A(1:end-dx, 1:end-dy);
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:48:20.770

如果您有图像处理工具箱，最简单的方法是使用内置函数`maketform`和`imtransform`：

```
I = imread('cameraman.tif');
dx = 40;  
dy = 100;
tform = maketform('affine',[1 0 0; 0 1 0; dx dy 1]);  %#Create a translation matrix
J = imtransform(I,tform,'XData',[0 size(I,2)+dx],'YData',[0 size(I,1)+dy]);
imshow(I), figure, imshow(J) 
```

*   作为输入的矩阵`maketform`是你的矩阵的转置
*   `XData`设置and很重要`YData`，否则你不会得到“翻译效果”，因为会`imtransform`找到最小的输出范围。
*   如果要获得与初始图像相同的大小，请使用以下语法：

.

```
 J = imtransform(I,tform,'XData',[0 size(I,2)],'YData',[0 size(I,1)]); 
```

之前的图片：

![在此处输入图像描述](../Images/e6d64036caa491c7f291626f6b36f224.png)

图片之后：

![在此处输入图像描述](../Images/d83c529d7875aab08ac3597ad3e5d841.png)

之后的图像（保持相同的大小）：

![在此处输入图像描述](../Images/e90e8c2c81996752c2ba1f6348ad7206.png)

# mapreduce - 我怎么不能索引到reduce的值列表中？

> ID：12556090
> 
> 赞同：1
> 
> 时间：2012-09-23T20:43:41.963
> 
> 标签：mapreduce, mrjob

我正在通过 Python mrjob 模块在 Map Reduce 作业中使用映射器内组合。因为我编写了一个发出单对的 mapper_final 函数，所以我确信只有一个键值对被发送到我的 reducer。

但是，我的 reduce 函数出错了：

```
 def reducer(self, key, occurrences):
    '''
    Calculates the final value.
    '''
    yield 'Final Value: ', occurrences[0] / 2 
```

错误读取

```
File "calculateFinalValue.py", line 354, in reducer
    yield 'Final Value: ', occurrences[0] / 2
TypeError: 'generator' object has no attribute '__getitem__' 
```

为什么我不能索引`occurrences`？该列表中应该只有一对，对吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:02:41.690

`occurrences`不是一个`list`，是一个[`generator`](https://wiki.python.org/moin/Generators)。如果你想要一个`list`，你需要将生成器结果组装成一个列表。就像是：

```
list_occurrences = [ occ for occ in occurrences ] 
```

或者

```
list_occurrences = list(occurrences)

yield 'Final Value: ', list_occurrences[0] / 2 
```

或者您可以通过以下方式获得第一个出现值`occurrences.next()`：

```
yield 'Final Value: ', occurrences.next() / 2 
```

# git - Git 作为部署、开发和备份

> ID：12556091
> 
> 赞同：4
> 
> 时间：2012-09-23T20:43:55.653
> 
> 标签：git, workflow, backup

我已经使用 Git 一年多了，但我觉得我需要微调我的工作流程。希望你能帮忙！现在我有5台电脑：

**3 桌面/开发人员：**我们在哪里完成所有工作，当我们对所做的更改感到满意时，我们会将它们推送到网络服务器。

**WEBSERVER：**网络服务器接收推送，然后它有一个钩子来自动检查它们（所以一旦我们从桌面推送，它们就会直接生效）。这是所有计算机用来推入和拉出的中央单元。

**备份：**好的，我还没有这个，但我打算安装一个。首先需要一些建议。

关于这一切的一些问题：

1.  当然，有时图像等会通过 Apache 直接上传到网络服务器上。除非我们在网络服务器上进行手动添加和远程提交，否则我们不会在桌面上收到这些文件。有一个每天晚上在网络服务器上自动添加和提交的 cronjob 是个好主意吗？

2.  我打算为网站安装备份服务器。首先，我查看了 Rsync 和 rdiff-backup，但后来我突然想到，使用 Git 可能会更好。然后，我还将拥有所有提交的历史记录。这是个好主意吗？如果是这样，我只是用 git pull 做一个 cronjob 吗？

3.  由于删除和缓存的图像，一些存储库变得非常大。在台式机和备份服务器上，我们有大量的硬盘，所以这不是一个大问题，但是硬盘在网络服务器上非常昂贵。是否可以每晚自动删除和重置网络服务器上所有已删除和缓存的文件，但仍保留桌面和备份服务器上的完整历史记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T01:19:10.793

这些问题很多。最重要的答案：不要将动态图像存储在 git 中。这不是 git 的设计目的，通常是一个坏主意。这也回答了问题 3：不，这是不可能的。仅在 git 中存储属于您的代码/站点的图像。

关于备份：您的代码似乎不需要更多备份。您已经在不同位置的不同机器上拥有 4 个完整的代码副本。除非您想在防火掩体中进行另一个备份，否则我认为没有很大的改进空间:)。

如果您想在客户端上的服务器上获取动态图像，请编写一个通过 ftp 同步它们的脚本。

# vb.net - VB.net：输入字符串格式不正确？

> ID：12556092
> 
> 赞同：1
> 
> 时间：2012-09-23T20:44:07.680
> 
> 标签：vb.net, input

嘿伙计们，我的程序一直有这个崩溃问题。

我正在尝试创建一个程序，它通过输入他们的期初余额、信用额度、总费用和总信用来计算一个人的账户余额。在这种情况下，我在总费用和总积分代码方面遇到了具体问题。

我设置了一个消息框，如果“总费用”和“总积分”框为空白，它将显示“请输入 .... 的数值”。问题是当我运行它并输入一个空白时，会出现消息然后程序崩溃。

崩溃后，该程序然后以黄色突出显示特定的转换代码（在这种情况下：`decTotalCharges = Convert.ToDecimal(txtTotalCharges.Text))`并且错误显示`Input string was not in correct format`.

怎么回事，我把它转换成正确的格式了吗？（十进制到十进制？）。以下是对我的代码的深入了解：

```
Public Class frmEndingBalance

'Declare module level variables
Dim mdecEndingBalance As Decimal
Dim mdecAllCharges As Decimal
Dim mdecAllCredits As Decimal
Dim mintCustomersOverLimit As Integer

Private Sub btnClear_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClear.Click
    'clears the form
    'clears the labels
    txtAccountNumber.Text = ""
    txtBeginningBalance.Text = ""
    txtTotalCharges.Text = ""
    txtTotalCredits.Text = ""
    txtCreditLimit.Text = ""
    lblEndingBalance.Text = ""
    lblCreditMessage.Text = ""
    lblAllCharges.Text = ""
    lblAllCredits.Text = ""
    lblCustomersOverLimit.Text = ""
    lblCreditMessage.Text = ""

    'clear the textboxes
    txtAccountNumber.Clear()
    txtBeginningBalance.Clear()
    txtTotalCredits.Clear()
    txtTotalCharges.Clear()
    txtCreditLimit.Clear()

    'clear module level variables
    mdecEndingBalance = 0
    mdecAllCharges = 0
    mdecAllCredits = 0
    mintCustomersOverLimit = 0
End Sub

Private Sub btnCalculate_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCalculate.Click

    'Declare Variables
    Dim intAccountNumber As Integer
    Dim intBeginningBalance As Integer
    Dim decTotalCharges As Decimal
    Dim decTotalCredits As Decimal
    Dim decCreditLimit As Decimal
    Dim mdecEndingBalance As Decimal 'Beginning Balance + Charges - Credits()
    Dim decCreditMessage As Decimal

    'check for numeric
    If IsNumeric(txtAccountNumber.Text) = False Then 'value is not numeric
        MessageBox.Show("You can't enter anything blank!")
        Exit Sub
    End If

    'convert to a numeric data type
    intAccountNumber = Convert.ToInt32(txtAccountNumber.Text)

    'check for numeric
    If String.IsNullOrEmpty(txtBeginningBalance.Text) Then MessageBox.Show("Beginning Balance Cannot Be Blank!")

    'check for everything else
    If IsNumeric(txtBeginningBalance.Text) = False Then 'Value is not numeric
        MessageBox.Show("Please enter a numeric value for Beginning Balance!")
        Exit Sub
    End If
    'convert to a numeric data type
    intBeginningBalance = Convert.ToInt32(txtBeginningBalance.Text)

    'check for numeric
    If IsNumeric(txtTotalCharges.Text) = False Then 'value is not numeric
        MessageBox.Show("Please enter a numeric value for Total Charges!")
    End If

    'convert 
    decTotalCharges = Convert.ToDecimal(txtTotalCharges.Text)

    'check for 0 or positive
    If decTotalCharges < 0 Then
        MessageBox.Show("Please enter a positive value or zero for number of Total Charges!")
        Exit Sub
    End If

    'check for numeric
    If IsNumeric(txtTotalCredits.Text) = False Then 'value is not numeric 
        MessageBox.Show("Please enter a numeric value for Total Credits")
    End If

    'convert to a numeric data type
    decTotalCredits = Convert.ToDecimal(txtTotalCredits.Text)

    'check for 0 or positive
    If decTotalCredits < 0 Then
        MessageBox.Show("Please enter a positive value or zero for total credits!")
    End If

    'check numeric
    If IsNumeric(txtCreditLimit.Text) = False Then 'value is not numeric
        MessageBox.Show("Please enter a numeric value for the Credit Limit!")
    End If

    'convert to a numeric data type
    decCreditLimit = Convert.ToDecimal(txtCreditLimit.Text)

    'check for a 0 or positive
    If decCreditLimit < 0 Then
        MessageBox.Show("Please enter a positive value or zero for Credit Limit!")
    End If

    'check for customers over limit
    decCreditMessage = decCreditLimit - (mdecEndingBalance)

    'running totals
    mdecAllCharges += decTotalCharges
    mdecAllCredits += decTotalCredits

    'calculate Ending Balance
    mdecEndingBalance = Convert.ToDecimal(intBeginningBalance + decTotalCharges - (decTotalCredits))

    'display outputs
    lblEndingBalance.Text = mdecEndingBalance.ToString("c")
    lblAllCharges.Text = mdecAllCharges.ToString("c")
    lblAllCredits.Text = mdecAllCredits.ToString("c")
    lblCustomersOverLimit.Text = mintCustomersOverLimit.ToString("n0")
End Class 
```

任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:23:22.833

您在测试中错过了 Exit Sub

```
If IsNumeric(txtTotalCharges.Text) = False Then 'value is not numeric
 MessageBox.Show("Please enter a numeric value for Total Charges!")
End If 
```

你在其他几个地方也做过（我们都做过，事实上我们也做过:(）。值得用一个小辅助方法或类似的东西进行重构。

```
If IsValidDecimal(txtTotalCharges.Text, "Total Charges") 
  ' etc
End If 
```

# python - 从 arduino 收集“双”类型数据

> ID：12556096
> 
> 赞同：0
> 
> 时间：2012-09-23T20:44:42.697
> 
> 标签：python, c, arduino, atmega

我正在尝试将浮点数据从 arduino 发送到 python。数据作为 8 个连续字节的数据（双倍大小）发送，后跟换行符（'\n'）。如何收集这些连续字节并将其转换为python端（系统端）的正确格式

```
void USART_transmitdouble(double* d)
{
    union Sharedblock
    {
        char part[sizeof(double)];
        double data;

    }my_block;
    my_block.data = *d;
    for(int i=0;i<sizeof(double);++i)
    {
        USART_send(my_block.part[i]);
    }

    USART_send('\n');
}

int main()
{
    USART_init();
    double dble=5.5;
    while(1)
    {
       USART_transmitdouble(&dble);
    }
    return 0;
} 
```

python 代码。当然这不会以正确的格式打印数据，而只是想显示我尝试过的内容。

```
import serial,time

my_port = serial.Serial('/dev/tty.usbmodemfa131',19200)
while 1:
    print my_port.readline(),
    time.sleep(0.15) 
```

**更新**：

```
my_ser = serial.Serial('/dev/tty.usbmodemfa131',19200)

while 1:
    #a = raw_input('enter a value:')
    #my_ser.write(a)
    data = my_ser.read(5)
    f_data, = struct.unpack('<fx',data)
    print f_data
    #time.sleep(0.5) 
```

使用`struct`上面代码所示的模块可以打印浮点值。但，

50% 的时间，数据打印正确。但是如果我弄乱了 time.sleep() 或停止传输并重新启动它，打印出不正确的值。我猜在这种情况下**解包**了错误的 4 个字节集.关于我们可以在这里做什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T20:56:27.620

在 Arduino 上，a`double`与[相同`float`](http://arduino.cc/en/Reference/Double)，即占用 4 字节内存的 little-endian[单精度浮点数。](http://en.wikipedia.org/wiki/Single_precision_float)这意味着您应该准确读取 5 个字节，使用该`f`格式的 little-endian 变体来解压它，并忽略尾随的换行符`x`：

```
import struct
...

data = my_port.read(5)
num, = struct.unpack('<fx', data) 
```

请注意，您不想使用`readline`，因为浮点数表示的任何字节都可以是`'\n'`.

正如 Nikklas B. 指出的那样，您甚至根本不需要换行，只需发送 4 个字节并从 Python 中读取尽可能多的字节。在这种情况下，格式字符串将为`'<f'`.

# tsql - tsql 连接 2 个表，第二个表中有重复记录

> ID：12556097
> 
> 赞同：0
> 
> 时间：2012-09-23T20:44:47.730
> 
> 标签：tsql

我有 2 张桌子。

**表格1：**

```
Id     Name

1      John
2      Mike
3      Sam 
```

**表 2：**

```
Name   Data

John   Data1
John   Data1
John   Data1
Mike   Data2
Mike   Data2
Sam    Data3 
```

如果我写

```
select Table2.Name, Table2.Data 
from Table1 
inner join Table2 on Table1.Name= Table2.Name 
```

我得到所有重复的数据。

我希望能够检索以下内容：

```
John Data1
Mike Data2
Sam  Data3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T11:55:56.167

您可以为此使用 CTE 并应用`row_number()`

```
;with cte as
(
  select t1.name, t2.data,
    row_number() over(partition by t1.id order by t1.id) rn
  from table1 t1
  inner join table2 t2
    on t1.name = t2.name
)
select *
from cte
where rn = 1 
```

或非 CTE 版本：

```
select *
from 
(
  select t1.name, t2.data,
    row_number() over(partition by t1.id order by t1.id) rn
  from table1 t1
  inner join table2 t2
    on t1.name = t2.name
) x
where rn = 1 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/a5b10/5)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T20:56:02.497

有两种方法可以做到这一点。

您可以使用`distinct`子句：

```
select distinct t2.Name, t2.Data 
from Table1 t1
inner join Table2 t2 on t1.Name= t2.Name 
```

[这里](http://msdn.microsoft.com/pl-pl/library/ms187831%28v=sql.100%29.aspx)是 MSDN 的链接。

您可以使用`group by`：

```
select t2.Name, t2.Data 
from Table1 t1
inner join Table2 t2 on t1.Name= t2.Name
group by t2.Name, t2.Data 
```

[这里](http://msdn.microsoft.com/en-us/library/ms177673.aspx)是 MSDN 的链接。

我更喜欢第二种解决方案，因为我总是可以添加分组功能。

**注意：** 在这两个查询中，我都使用了别名 ( `t1`, `t2`)。它更具可读性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T20:59:06.883

```
SELECT DISTINCT NAME
     , DATA
  FROM Table2
 WHERE NAME IN (SELECT NAME
                  FROM Table1) 
```

这里有几个不同的选择......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T20:48:29.393

您是否正在寻找类似的东西：

```
select Table2.Name, Table2.Data, count(*) from Table1 
     inner join Table2 on Table1.Name= Table2.Name
     group by Table2.Name, Table2.Data; 
```

# c# - 评估条件表达式

> ID：12556101
> 
> 赞同：5
> 
> 时间：2012-09-23T20:45:20.193
> 
> 标签：c#

我有一个场景，我将数据库中的“if”条件保存为字符串。例如：

```
String condition = "(([age] >= 28) && ([nationality] == 'US'))"; 
```

或者

```
String condition = "([age] >= 28)"; 
```

现在，我想评估用户输入的条件*语法*是否正确。这些是不正确语法的示例：

```
String condition = "(([age] >= 28) && ([nationality] == 'US')"; //Missed ')' bracket

String condition = "[age] >= 28)"; //Missed Opening bracket '(' 
```

就像我们在评估查询表达式中一样。可能是表达式树可能会有所帮助。但是怎么做？在这方面需要帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T20:52:54.667

看看[NCalc](http://ncalc.codeplex.com/)。它是评估数学表达式的框架。

当表达式有语法错误时，评估将抛出一个 EvaluationException。

```
try
{
    new Expression("(3 + 2").Evaluate();
}
catch(EvaluationException e)
{
    Console.WriteLine("Error catched: " + e.Message);
} 
```

`HasErrors()`不过，您也可以使用该方法在评估之前检测语法错误。

```
Expression e = new Expression("a + b * (");
if(e.HasErrors())
{
    Console.WriteLine(e.Error);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T14:55:25.003

我找到了这个解决方案

[计算存储在字符串中的算术表达式 (C#)](https://stackoverflow.com/questions/4620437/evaluate-an-arithmetic-expression-stored-in-a-string-c)

解决方案：

```
string conditiontext = "(([age] >= 28) && ([nationality] == \"US\"))";
conditiontext = conditiontext.Replace("[age]", 32)
                             .Replace("[nationality]","US");

/*VsaEngine*/
var engine = Microsoft.JScript.Vsa.VsaEngine.CreateEngine();

/** Result will be either true or false based on evaluation string*/
var result = Microsoft.JScript.Eval.JScriptEvaluate(conditiontext, engine); 
```

[注意：此接口已弃用。但它评估任何算术表达式和 c# 表达式]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:01:13.873

Visual Studio 并不真正知道字符串代表什么，因此据我所知，字符串本身没有进行解析。

通常在使用 C# 和使用 sql 进行编程时，您会尝试在 C# 本身中进行尽可能多的计算（如果可行，请选择整个表，然后使用 C# 处理结果）。

如果数据库真的很慢（这种情况很常见），那么编写一个 SQL Builder 类来处理硬编码的字符串可能会很有用。

如果您不使用这两种方法，那么不幸的是，您真正希望的最好结果是运行时异常（由于显而易见的原因，这并不是最佳的）。

编辑：对于我建议的第二种情况，似乎已经存在[SelectQueryBuilder 库。](http://www.codeproject.com/Articles/13419/SelectQueryBuilder-Building-complex-and-flexible-S)

# xcode - 设备上的捏手势识别器延迟

> ID：12556107
> 
> 赞同：0
> 
> 时间：2012-09-23T20:46:19.387
> 
> 标签：xcode, zooming, uipinchgesturerecognizer

我在我的应用程序中放了一个捏手势识别器。它在模拟器上运行良好。但是在手势通过和更新之前，设备上有很长的延迟。有什么想法可能导致这种情况吗？这也在新 iPhone 上，所以它不应该是处理速度。

# java - 从 Ant 运行时，期望输入的 Java 程序不起作用？

> ID：12556113
> 
> 赞同：2
> 
> 时间：2012-09-23T20:47:13.797
> 
> 标签：java, ant

所以我有一个简单的 java 程序，它打印一条消息并要求用户输入。该程序运行良好，直到我尝试通过 ant 运行它。

当我使用下面的构建文件时，程序从不打印消息。

当我使用 ant -verbose 运行时，它说“可执行文件周围的 ' 字符和参数不是命令的一部分”

我在构建文件中做错了什么？我很困惑，因为这个构建文件适用于不要求用户输入的程序。

```
<project name="lab4" default="run" basedir=".">

    <property name="src" value="."/> 

    <target name="clean">
       <delete>
              <fileset dir="${src}" includes="**/*.class,META-INF,*/**.jar"/>
           </delete>
    </target>

    <target name="compile" depends="clean">
        <javac srcdir="${src}" destdir="${src}" includes="**/*.java"  includeantruntime="false"/>
    </target>

    <target name="run" depends="compile">
      <java classpath="${src}" classname="CountLetters1" failonerror="yes"/>
    </target>

</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:16:44.570

总结从评论到问题的“解决方案”：

这里的问题似乎是程序在其输入提示中不包含换行符。这会导致 Ant 不显示提示（它正在等待换行符）。

除此之外，该示例实际上运行良好。

# javascript - max-device-width 是指 document.body.clientWidth 吗？

> ID：12556115
> 
> 赞同：11
> 
> 时间：2012-09-23T20:47:27.057
> 
> 标签：javascript, css, responsive-design, media-queries

在媒体查询中，我见过`max-width`、`min-width`、 `max-device-width`和。`min-device-width``orientation`

从 JavaScript 的角度来看，这些是指`document.body.clientWidth`? 或者`window.outerWidth`？我也看到有`document.body.offsetWidth`。

是否有资源列出所有有效的 css 媒体查询参数以及与之匹配的 JavaScript 属性？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-26T18:29:32.047

因此，您需要一个在 JavaScript 中等效的所有有效 css 媒体查询参数的列表。

让我们尝试这样做，依靠 [媒体查询 W3C 规范](http://www.w3.org/TR/css3-mediaqueries/)。

* * *

# 媒体类型

似乎无法[直接使用 JavaScript 属性/方法](http://lists.apple.com/archives/web-dev/2006/Sep/msg00000.html)检索媒体类型（屏幕、打印等） ，因此您必须依赖变通方法、脚本或插件。

我发现：

1.  **[matchMedia polyfill](https://github.com/scottjehl/matchMedia.js)**似乎是最好的解决方案（Modernizr 和 Respond.js 也使用）
2.  [CSS 媒体检测脚本](http://cssmedia.pemor.pl/)（似乎有点老了）
3.  [jMediaType](http://code.google.com/p/jmediatype/)（仍然依赖于 css）

* * *

# 媒体功能（可直接检测）

### 1.宽度

`window.innerWidth`// `document.body.clientWidth`（`document.documentElement.clientWidth`见下文）

### 2.高度

`window.innerHeight`// `document.body.clientHeight`（`document.documentElement.clientHeight`见下文）

### 3\. 设备宽度

`screen.width`

### 4\. 设备高度

`screen.height`

### 5\. 定位

`window.orientation`（见下文）

### 6\. 颜色

`screen.colorDepth`

### 7\. 分辨率

`screen.pixelDepth`/ `window.devicePixelRatio`（见下文）

* * *

# 媒体功能（间接检测）

### 1.宽度/高度

鉴于浏览器之间的差异，您需要一个函数来获取`width`和`height`. 前段时间我发现了这个跨浏览器的片段（不记得在哪里）：

```
var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName('body')[0];

var width = w.innerWidth||e.clientWidth||g.clientWidth;

var height = w.innerHeight||e.clientHeight||g.clientHeight; 
```

### 2\. 纵横比

> “宽度”媒体特征的值与“高度”媒体特征的值的比率

`width`/ `height`（见上文）

### 3\. 设备纵横比

> 'device-width' 值与 'device-height' 值的比值</p>

`screen.width`/`screen.height`

### 4.分辨率

> 输出设备的像素密度。“dpi”和“dpcm”单位描述了输出设备的分辨率，即设备像素的密度。

所以它不是许多人认为的屏幕尺寸（宽 x 高）！

```
var resolution = window.devicePixelRatio||screen.pixelDepth||screen.colorDepth; 
```

`screen.pixelDepth`仅适用于 Firefox，您可以[在 quirksmode.org 上](http://www.quirksmode.org/blog/archives/2012/06/devicepixelrati.html)`window.devicePixelRatio`找到兼容性。

[在这里](http://www.javascriptkit.com/howto/newtech3.shtml)，我读到这`screen.colorDepth`可以作为后备。

### 5.单色

> 单色帧缓冲区​​中每个像素的位数。如果设备不是单色设备，则输出设备值为 0

```
if ( screen.colorDepth == 2) {
    var monochrome = /* retrieve resolution here, see above */;
}else{
    var monochrome = 0;
} 
```

### 6\. 定位

> 当“高度”媒体特征的值大于或等于“宽度”媒体特征的值时为“纵向”。否则“方向”就是“风景”。

```
if ( width > height ) {
    var orientation = 'landscape';
}else{
    var orientation  = 'potrait';
} 
```

并非所有浏览器都支持该**`window.orientation`**属性，它返回一个数值，因此它与W3C 所期望的*方向没有直接关系。*在 SO 上查看[此答案以](https://stackoverflow.com/questions/1649086/detect-rotation-of-android-phone-in-the-browser-with-javascript)获取更多信息。

* * *

# 媒体功能（检测不到）

我找不到使用 JavaScript 检测以下媒体功能的方法（我认为不可能）：

*   颜色索引
*   扫描
*   网格

* * *

# 更多有趣的东西

*   `screen.availHeight`= 屏幕高度减去界面功能（例如任务栏）
*   `screen.availWidth`= 屏幕宽度减去界面功能（例如任务栏）
*   要使用 JavaScript 模拟媒体查询，可以使用[Modernizr 的 mq() 方法](http://modernizr.com/docs/#mq)，但请注意：如果浏览器不支持媒体查询，它~~根本不会执行代码，~~总是会返回*false*。

* * *

# 来源

1.  宽度/高度： http: [//www.howtocreate.co.uk/tutorials/javascript/browserwindow](http://www.howtocreate.co.uk/tutorials/javascript/browserwindow)
2.  设备宽度/高度：[http ://responsejs.com/labs/dimensions/](http://responsejs.com/labs/dimensions/)
3.  方向：[使用 JavaScript 在浏览器中检测 Android 手机的旋转](https://stackoverflow.com/questions/1649086/detect-rotation-of-android-phone-in-the-browser-with-javascript)
4.  分辨率和颜色相关的东西：[http ://www.javascriptkit.com/howto/newtech3.shtml](http://www.javascriptkit.com/howto/newtech3.shtml)
5.  单色：[Javascript：检测单色显示](https://stackoverflow.com/questions/11461336/javascript-detect-monochrome-display)
6.  像素比：[http ://www.quirksmode.org/blog/archives/2012/06/devicepixelrati.html](http://www.quirksmode.org/blog/archives/2012/06/devicepixelrati.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:21:57.990

min-width: 和 max-width: 查询指的是逻辑窗口（其大小随着用户更改浏览器窗口的大小而变化），而 min-device-width: 和 max-device-width （和方向： ) 查询是指物理屏幕/视口（一旦“meta...viewport...”语句修复它，其大小就不会改变）。

根据您的目标和受众，您可能会找到比媒体查询更适合的替代方法。您可能会发现细读[http://www.ckollars.org/alternative-to-media-queries.html很有帮助](http://www.ckollars.org/alternative-to-media-queries.html)

# php - 表格过帐数据

> ID：12556116
> 
> 赞同：0
> 
> 时间：2012-09-23T20:47:36.013
> 
> 标签：php, jquery, html, forms, post

我有一个 3 页的注册页面。用户在第一页选择一个选项并单击提交后，表单使用 jquery 的 animate 方法**转换**为下一个表单，这意味着它保持在同一页面上。我的问题是如何从第一种形式获取数据，因为第二种形式的内容取决于该信息。这是我的html：

```
<div id="Registration" style="display:none;">
        <div class="box">
            <form id="frmtype1" action="#" name="frmtype1" method="post">
                <header>Registration Options</header><br/>
                 <label for="Reg_type1"><input type="radio" name="Reg_type" id="Reg_type1" value="1"/> Option 1</label> <br/><br/>

                 <label for="Reg_type2"><input type="radio" name="Reg_type" id="Reg_type2" value="2"/> Option 2</label><br/><br/>

                 <label for="Reg_type3"><input type="radio" name="Reg_type" id="Reg_type3" value="3"/> Option 3</label><br/><br/>
                 <p id="error_message" style="display:none">Please choose an option</p><input type="submit" class="button" name="Submit" value="Submit"/>
            </form>

            <form name="everything" id="everything" action="#" method="post">
                <header>Registration Information</header><br/>
                <label>First Name<font color="red">*</font>: <input type="text" name="fname" id="fname" /> </label><br/>
                Last Name*: <input type="text" name="lname" id="lname" /> <br/>
                Address*: <input type="text" name="address" id="address" /> <br/>
        </form>
        </div>
    </div> 
```

因此，一旦选择了一个选项，第一个表单就会消失，而下一个会出现。那么如何获取他们选择的选项的数据呢？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:26:06.087

由于它们依赖于一种形式的信息，因此“页面”实际上应该是相同的形式。您使用 jQuery/JavaScript 来显示/隐藏“当前页面”。这将允许您一次性提交所有数据。

1.  将所有输入元素包装在一个 html 表单标签中
2.  对于每个表单“段”，您将需要使用您的 js 来隐藏/显示包装 HTML 容器。默认为表单的“第 1 页”，其余为隐藏。
3.  将您的提交按钮更改为一个按钮，并在其上有一个点击事件。当用户单击按钮时，输入被验证，然后 jQuery 取消隐藏“第 2 页”。
4.  在您的最后一个“页面”上有一个正常的提交按钮，然后所有表单数据都发布在一个中。

例如，html 可能如下所示：

```
<script type="text/javascript">
  $(document).ready(function{

    $(".next-page").click(function(){
      $(".box-wrapper").hide();
      $("#page-" + $(this).data("page")).show();
    });

  });
</script>

<div class="registration">
  <form name="regform" action="" method="post">
    <!-- Page 1 -->
    <div class="box-wrapper" id="page-1">  
      <div class="box">
        <!-- form inputs go here -->
        <input type="button" name="next-page" class="next-page" value="Continue" data-page="2"/>
      </div>
    </div>
    <!-- Page 2 -->
    <div class="box-wrapper" id="page-2" style="display: none;">  
      <div class="box">
        <!-- form inputs go here -->
        <input type="button" name="next-page" class="next-page" value="Continue" data-page="3"/>
      </div>
    </div>
    <!-- Page 3 -->
    <div class="box-wrapper" id="page-3" style="display: none;">  
      <div class="box">
        <!-- form inputs go here -->
        <input type="submit" name="submit" class="submit" value="Complete Registration"/>
      </div>
    </div>
  </form>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:51:42.953

使用 jquery ---`$('input[name=Reg_type]:checked').val()`这将为您提供选定的值。

# java - JAX-WS 生成的类到数据库表的映射

> ID：12556123
> 
> 赞同：-1
> 
> 时间：2012-09-23T20:48:38.520
> 
> 标签：java, oracle, jpa, orm, jax-ws

将类生成到 oracle 数据库的最简单方法是什么`JAX-WS`（换句话说，我需要为每个 Java 对象设置一组插入语句）？只有ORM之类的`jpa/hibernate`？有什么选择吗？

迂回的方式是通过反射检查每个类的字段，得到它们的名字（带有`@XMLElement`注解，当前等于列名），从而得到`INSERT`语句的列名。

优点缺点？）

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:44:27.373

最简单的方法是持久化 XML，因为这不需要映射到任何其他模型，也不需要任何反射来确定要持久化的模型。如今，大多数数据库都将具有 XML 数据类型，这使得存储更高效，甚至查询也可以通过索引 xpath 来提高效率。

或者，您可以沿着您建议的路径前进。

最后，您可以创建自己的模型，然后使用 JPA/hibernate 将其持久化到数据库中。您需要将生成的类映射到您的模型（使用类似推土机框架的东西）。这将需要最多的工作，但是您会提供最大的灵活性（可能）。

# c - 在 C 中动态分配指定大小的数组

> ID：12556127
> 
> 赞同：0
> 
> 时间：2012-09-23T20:48:57.523
> 
> 标签：c, arrays, input, malloc

我需要创建一个大小由用户输入确定的数组，然后具有指向所述数组的指针。所有数组将包含 500-600 之间的随机数。我似乎无法正确使用 malloc。我仍然是 C 的新手，因此感谢您的帮助。

```
int main(){
        int size;
    printf("Enter size of array");
    scanf("%d", &size);

    int array[size];
    int *aPtr = (int *) malloc(sizeof(int) * array); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T20:52:05.913

你只需要：

```
int *aptr = malloc(sizeof(int) * size); 
```

然后您可以像访问数组一样访问它。

```
aptr[0] = 123; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T20:52:21.187

你可能想写：

```
int *aPtr = (int *) malloc(sizeof(int) * size); 
```

反正你不需要那个`array`变量。您可以`aPtr`像`aPtr[10]`. 最后也不要忘记`free(aPtr)`。

# objective-c - 将多维 NSMutableArray 中的数据提取到更简单的数组中

> ID：12556128
> 
> 赞同：0
> 
> 时间：2012-09-23T20:49:18.007
> 
> 标签：objective-c, ios, c, cocoa-touch, nsmutablearray

我正在学习 iOS，但在从多维中提取数据时遇到问题`NSMutableArray`，我查看了各种解决方案，但还没有找到一个..

我有一个`NSMutableArray`赞

```
{
 "service_0" = {
    "name" = "name1";
    "description" = "description1";
};
 "service_2" = {
    "name" = "name2";
    "description" = "description2";
};
Etc...
} 
```

我希望将数据提取到新的`NSMutableArray`（或`NSArray`）中以获得以下输出以用于文本标签，例如 =`[myArray objectAtIndex:indexPath.row]`

```
(
    name1,
    name2,
Etc...
) 
```

最好的解决方案是什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:07:01.280

假设这是一个字典数组，与问题不同......

```
NSArray *newArray = [oldArray valueForKeypath:@"name"]; 
```

`mutableCopy`如果您愿意，可以使用 使其可变。

# mysql - RoR - obj.reload 之后 after_initialize 回调中的不同 object_id

> ID：12556135
> 
> 赞同：3
> 
> 时间：2012-09-23T20:50:03.493
> 
> 标签：mysql, ruby-on-rails, metaprogramming

我已经为我的项目编写了一个扩展 ActiveRecord 模型行为的方法，我已经删除了大部分内容，请考虑以下代码：

```
class ActiveRecord::Base

  def self.has_translations
    after_initialize :clear_translations_cache

    def clear_translations_cache
      binding.pry
      @_translations = {}
    end
  end
end 
```

基本上，当我从数据库中获取实例时，我希望 @_translations 实例变量被清除`.reload`，但由于某种原因，在从数据库中获取现有对象后，执行填充的方法`@_translations`，然后执行`object.reload`，`@_translations`仍然包含相同的数据。

我确信回调会在第一次从数据库中获取对象和调用`.reload`. 我使用 binding.pry 在回调方法中停止执行，但由于某种原因，`self.object_id`内部与我的原始对象`.reload`不同`object_id`，因此`@_translations`原始对象不会被清除。

附件是控制台输出：

```
1.9.3p194 :008 > s = TranslatedItem.first
   76:     def clear_translations_cache
=> 77:       @_translations = {}
   78:     end

[1] pry(#<TranslatedItem>)> self.class
=> TranslatedItem(id: integer, created_at: datetime, updated_at: datetime)
[2] pry(#<TranslatedItem>)> self.object_id
=> 70254243993580
[3] pry(#<TranslatedItem>)> exit
1.9.3p194 :009 > s.object_id
 => 70254243993580
1.9.3p194 :010 > s.reload
   76:     def clear_translations_cache
=> 77:       @_translations = {}
   78:     end
[1] pry(#<ServiceLevel>)> self.class
=> TranslatedItem(id: integer, created_at: datetime, updated_at: datetime)
[2] pry(#<TranslatedItem>)> self.object_id
=> 70254259259120 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T21:34:03.540

我猜您看到的行为与[ActiveRecord 重新加载](https://github.com/rails/rails/blob/81542f95d25825a7d3eff87d6f706661bf553b18/activerecord/lib/active_record/persistence.rb#L291-292)的工作方式有关：

```
fresh_object = self.class.unscoped { self.class.find(self.id, options) }
@attributes.update(fresh_object.instance_variable_get('@attributes')) 
```

您会注意到它正在通过从数据库中找到它来创建一个新对象，这解释了为什么您在回调方法中看到两个不同的 object_id 值。在重新加载期间初始化的对象仅用于其属性，然后超出范围。

从您的问题中不清楚您是否只是好奇它为什么会这样，或者您是否正在寻找另一种方法来做到这一点。

**更新：**

如果您只是在寻找一种在重新加载模型时清除实例变量的方法，那么您有几个选择。

1）添加您自己的 reload 方法，您可以显式调用：

```
class ActiveRecord::Base
  def reload_everything
    reload
    @_translations = {}
  end
end

object.reload_everything 
```

2) 改变重载的行为

```
module ReloadTranslations
  def reload(*args)
    super
    @_translations = {}
  end
end

ActiveRecord::Base.send(:include, ReloadTranslations) 
```

# android - 以编程方式重新启动对话框

> ID：12556136
> 
> 赞同：0
> 
> 时间：2012-09-23T20:50:19.937
> 
> 标签：android, dialog, datepicker

我的应用程序使用日期选择器对话框。该对话框在实现 DatePickerDialog.OnDateSetListener 的类中实现。因此，我的班级有一个方法 OnDateSet(); 在这种方法中，我想检查所选日期是否“可接受”（在我的程序中，某些日期没有意义）如何从 OnDateSet() 中重新启动对话框；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:59:36.897

我认为你误解了它的`DatePickerDialog.OnDateSetListener`工作原理。只要用户单击“确定”按钮，就会触发此回调，表明他们已完成在对话框中设置日期。每次单击对话框确认按钮时都会调用此回调，因此这是您要调用检查方法的地方。然后，您可以向用户显示一条`Dialog`或`Toast`消息，通知他们日期无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T10:15:22.363

是的，每次用户设置日期时都会触发 OnDateListener。我确实想启动 Toast 和一个对话框， Toast 告诉用户输入的日期不正确，并且 Dialog 是同一个 DatePicker 对话框。我已经设法通过回调启动对话框的活动来做到这一点，在该对话框中我实现了一个“relauchDatePicker()”方法，该方法启动了一个日期选择器并创建了一个 toast。我希望有一种方法可以直接在我的对话框类 java 中执行此操作，而不是我的活动。

# c++ - C ++中的数独检查器算法

> ID：12556137
> 
> 赞同：1
> 
> 时间：2012-09-23T20:50:21.577
> 
> 标签：c++, algorithm, sudoku

我目前正在研究一种算法，以使用数字 1-9 查找所有 9 位数字而没有任何重复。我正在测试一个理论，我认为这样的过滤数字将使数独检查器更有效。

我实现的代码执行以下操作。它对数字中的 1-9 位置使用 for 循环，例如 (a)(b)(c)(d)(e)(f)(g)(h)(i) = ###### ###。

我的理论是，通过检查数字 (ai) 的总和是否等于 45，a 到 i 的乘积等于 9！并且 ai 的倒数之和大约等于 2.828968（或 1 + 1/2 + 1/3 ... 1/9）

问题是，在我通过 ai 的倒数之和过滤 9 位数字后，预测的可能 9 位数字的计数小于 9！（可能数字的实际数量）。我不确定它为什么过滤这么多，但它确实捕获的数字没有任何重复（这很好）。

我的想法是，我玩双打的方式搞砸了算法。

这是我的代码：

```
#include <iostream>
#include <iomanip>

using namespace std;

int main()
{
    int product;
    int sum;
    int count=0;
    double inverseSum;
    double correctInverseSum=(1.0/1.0)+(1.0/2.0)+(1.0/3.0)+(1.0/4.0)+(1.0/5.0)+
(1.0/6.0)+(1.0/7.0)+(1.0/8.0)+(1.0/9.0);
        for(double a=1.0; a<10.0; a++){
            for(double b=1.0; b<10.0; b++){
                for(double c=1.0; c<10.0; c++){
                for(double d=1.0; d<10.0; d++){
                    for(double e=1.0; e<10.0; e++){
                        for(double f=1.0; f<10.0; f++){
                            for(double g=1.0; g<10.0; g++){
                                for(double h=1.0; h<10.0; h++){
                                    for(double i=1.0; i<10.0; i++){
                                        product=a*b*c*d*e*f*g*h*i;
                                        sum=a+b+c+d+e+f+g+h+i;
                                        if(product==9*8*7*6*5*4*3*2*1 && sum==45){
                                            inverseSum=(1.0/a)+(1.0/b)+(1.0/c)+(1.0/d)+
                                            (1.0/e)+(1.0/f)+(1.0/g)+(1.0/h)+(1.0/i);
                                            if(inverseSum==correctInverseSum)
                                            {
                                                count++;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    cout<<"This is the count:"<<count<<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T20:55:54.873

现在我在看到这么多 for 循环后洗了眼睛，我会说候选人是：

```
if(inverseSum==correctInverseSum) 
```

`double`s 不能完全表示，因此您必须使用一个小的 epsilon 检查是否相等。就像是：

```
if (fabs(inverseSum - correctInverseSum) < std::numeric_limits<double>::epsilon()) 
```

你需要`#include <limits>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T06:13:33.760

你没听说过 std::bitset 吗？您只需要 9 位即可验证，这可能在您的预算之内。

我一直想对可变参数模板进行一些练习，所以我为你写了这个：（c ++ 11专家，随意将它撕成碎片。）

```
#include <bitset>
#include <iostream>

template<unsigned long i>
bool test_helper(std::bitset<i> seen) {
  return seen.count() == i;
}

template<unsigned long i, typename T, typename... Args>
bool test_helper(std::bitset<i> seen, T arg1, Args... args) {
  return test_helper(seen.set(arg1 - 1), args...);
}

template<typename... Args>
bool test(Args... args) {
  return test_helper(std::bitset<sizeof... (Args)>(), args...);
}

template<unsigned long size, bool done = false>
struct Counter {
  template<typename ... Args>
  unsigned long operator()(Args... args) {
    unsigned long count = 0;
    for (int a = 1; a < 10; ++a)
      count += Counter<size, size == sizeof...(Args)+1>()(a, args...);
    return count;
  }
};

template<unsigned long i>
struct Counter<i, true> {
  template<typename ... Args>
  unsigned long operator()(Args... args) {
    return test(args...);
  }
};

int main(int argc, char** argv) {
  std::cout << Counter<9>()() << std::endl;
  return 0;
} 
```

如果您真的坚持使用复杂的启发式算法，您还可以获得一些有理算术的经验来计算您的逆和。应该清楚 1/a [i]的总和是 Σ [j] (Π [i]  a [i] )/a [j]全部除以 Π [i]  a [i]；您已经在计算分母，因此只需要计算分子，其最大值为 9 ⁹。但是，bitset 解决方案对我来说似乎要简单得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:13:40.053

一句古老的格言，但请：不要重复自己。

保持干燥。

当你发现自己在编写这种代码时，你应该问自己为什么我需要以这种方式重复自己。

还有很多其他选择。

1 - 递归。让自己对这个概念感到满意。

2 - i = 0 到 100 的 mod 运算符 r = i % 10, c = i / 10

3 - 重新评估问题。您正在尝试解决比必要更难的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T20:57:43.930

您在检查中需要一些容错能力：

```
if(fabs(inverseSum-correctInverseSum) < 1e-6) count++ 
```

或者，乘以 9!，你得到

```
b*c*d*e*f*g*h*i + a*c*d*e*f*g*h*i ... 
```

（每一项总和中缺少一个因素）。然后你可以使用整数算术而不是浮点数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T21:11:22.390

让我们进行一个快速实验：让我们尝试从大到小并以相反的顺序计算逆和：

```
#include <algorithm>
#include <numeric>
#include <iostream>
#include <iterator>
#include <vector>

struct generator
{
    generator(): d_value() {}
    double operator()() { return 1.0 / ++this->d_value; }
    double d_value;
};

int main()
{
    std::vector<double> values;
    std::generate_n(std::back_inserter(values), 9, generator());
    double ordered(std::accumulate(values.begin(), values.end(), 0.0));
    double reversed(std::accumulate(values.rbegin(), values.rend(), 0.0));
    std::cout << "ordered=" << ordered << " "
              << "reversed=" << reversed << " "
              << "difference=" << (reversed - ordered) << " "
              << "\n";
} 
```

如果这是精确的数学运算，显然这应该产生相同的总和。毕竟，它们是同一组值。不幸的是，事实证明这些值并不完全相同。这是它为我显示的输出：

```
ordered=2.82897 reversed=2.82897 difference=4.44089e-16 
```

问题是这些值不准确，并且添加其中两个不准确的值会引入一些错误。通常错误并不重要，但尝试比较结果的身份将不起作用：根据操作的顺序，涉及具有不同舍入结果的不同操作数。

# jquery - 三个 jquery coffeescript 函数相互冲突

> ID：12556143
> 
> 赞同：1
> 
> 时间：2012-09-23T20:50:51.080
> 
> 标签：jquery, ruby-on-rails-3, coffeescript, asset-pipeline

我是 coffeescript/javascript 的相对业余爱好者，但我无法弄清楚如何构建它，以便三个不同的函数（两个[Select2](http://ivaynberg.github.com/select2/)函数和一个加载[Best in Place](https://github.com/bernat/best_in_place)的函数）在 Rails 中同时工作3 应用。我在资产管道文件中有以下代码，当应用程序运行时，它肯定会被加载并转换为 javascript：

```
jQuery ->
    $('#foo').select2()
        placeholder: "Choose an option.",
        allowClear: true
    $('#bar').select2()
        placeholder: "Choose an option.",
        allowClear: true
    $('.best_in_place').best_in_place() 
```

但是当我像这样将所有三个功能放在一起时，它们都不起作用。当我只运行一个时，例如：

```
jQuery ->
    $('#foo').select2()
        placeholder: "Choose a diagnosis.",
        allowClear: true 
```

Presto，该功能工作得很好。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:16:46.613

我怀疑您的代码根本无法正常工作，当您尝试运行该代码时，您可能希望查看 JavaScript 控制台。

这：

```
$('#foo').select2()
    placeholder: "Choose an option.",
    allowClear: true 
```

与此 JavaScript 相同：

```
$('#foo').select2()({
    placeholder: "Choose an option.",
    allowClear: true
}); 
```

但你几乎肯定想要这个 JavaScript：

```
$('#foo').select2({
    placeholder: "Choose an option.",
    allowClear: true
}); 
```

为此，您的 CoffeeScript 将如下所示：

```
$('#foo').select2
    placeholder: "Choose an option."
    allowClear: true 
```

或像这样：

```
$('#foo').select2(
    placeholder: "Choose an option."
    allowClear: true
) 
```

这个咖啡脚本：

```
$('#foo').select2()
    placeholder: "Choose an option.",
    allowClear: true
$('#bar').select2()
    placeholder: "Choose an option.",
    allowClear: true
$('.best_in_place').best_in_place() 
```

应该成功执行`$('#foo').select2()`然后触发 TypeError 因为`select2()`没有返回函数但你试图像调用它一样调用它。然后，`$('#bar').select2()`and`$('.best_in_place').best_in_place()`甚至不会运行。

# c - 我在 C 程序中有一个错误。它说 %d 需要 int，但正在读取 int *。int * 到底是什么？

> ID：12556144
> 
> 赞同：0
> 
> 时间：2012-09-23T20:51:33.713
> 
> 标签：c

我在 C 程序中有一个错误。它说 %d 需要 int，但正在读取 int *。我之前使用了一些 mod10 函数，用于分隔一个 4 位数字。在处理完每个数字之后，除了除法和其他 mod10 之外，我将这些数字重新组合成一个 4 位整数，并告诉它打印出来。在 printf 行中使用 %d 时，我收到一条错误消息，说 %d 正在寻找一个“int”，而它正在寻找一个“int *”。究竟什么是'int *'，以及关于这里出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T20:55:15.913

一个`int *`是一个`pointer to an int`。

要获取指向变量的指针的值，请`*`在变量名前面使用。要获取变量的地址，请`&`在其名称之前使用。

例子;

```
int c = 1, d= 0;  
int *e = &c;     // assign address of c to pointer e
d = *e;          // assign value that c points to, to d
printf("%d",d);  // print int value of d
printf("%d",*e); // same output as line above. print value c points to 
```

[这](http://www.cs.cf.ac.uk/Dave/C/node10.html)是一个关于指针的小教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T20:57:37.230

An`int*`是*指向*整数而不是整数本身的指针。C 有指针的概念，指针是可以指向其他变量的变量，允许你做各种奇妙的事情。

没有看到你的代码，很难看出你做错了什么，但你可以通过声明它来获得一个指针：

```
int * pInt; 
```

或使用地址运算符：

```
doSomethingWith (&myInt); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T20:58:01.940

int* 是指向整数的指针，而不是整数变量。这意味着它不是保存一些数据，而是保存对内存中某些数据所在位置的引用。如果您想在它引用的位置访问数据，那么您需要取消引用指针。

要做到这一点，你这样做：

```
int a = 100; //an integer variable
int* b= &a; //b is now the location of a in memory
cout << *b; //This dereferences b to the data in a, and prints 100 
```

希望这会有所帮助，任何更正的人请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T20:54:44.077

向我们展示（通过将其编辑到您的问题中）它抱怨的代码行。

要回答您的问题， an`int*`是指向 an 的指针`int`。例如，给定

```
int i;
int *p; 
```

`i`和`*p`是 类型`int`，`&i`和`p`是 类型`int*`。

在 C 教科书中查找“指针”。

此外，[comp.lang.c 常见问题解答](http://www.c-faq.com/)是一个极好的资源；第 4 节讨论指针。（但它主要是为了回答您在开始理解这些概念后会遇到的问题。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T21:00:57.203

`int *`是一个指向整数的指针。

请发布标记的代码行、错误消息和声明变量的行。

# ruby - 创建了一个简单的 gem，但是 irb 看不到它

> ID：12556145
> 
> 赞同：1
> 
> 时间：2012-09-23T20:51:37.610
> 
> 标签：ruby, gem

我通过以下方式创建了一个简单的宝石：

1.  testgem.gemspec

    ```
    Gem::Specification.new do |s|
      s.name = 'testgem'
      s.version = '0.0.1'
      s.summary = "code generation"
      s.authors = ['asdf']
    end 
    ```

2.  创建了以下文件布局：

    ```
    testgem.gemspec
    Gemfile
    lib/
    lib/testgem.rb
    lib/testgem/other.rb 
    ```

3.  运行以下内容：

    ```
    gem build testgem.gemspec

    WARNING:  no description specified
    WARNING:  no email specified
    WARNING:  no homepage specified
    Successfully built RubyGem
    Name: testgem
    Version: 0.0.1
    File: testgem-0.0.1.gem 
    ```

4.  安装它：

    ```
    gem install ./testgem-0.0.1.gem 
    Successfully installed testgem-0.0.1
    1 gem installed 
    ```

5.  测试 irb 是否可以看到：

    ```
    irb
    require 'testgem'
    oadError: cannot load such file -- testgem 
    ```

我正在使用 Ruby 1.9.3-p194

如果我这样做，它似乎已安装：

```
gem list
..
testgem (0.0.1)
.. 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T04:08:43.687

您需要将您的库添加到搜索路径。只需添加

```
$:.push File.expand_path("../lib", __FILE__) 
```

在您的 .gemspec 之上

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:05:11.470

当您`require`在 Ruby 中使用时，您正在尝试加载*文件*，而不是*gem*。该文件当然可以包含在 gem 中，按照惯例，gem 将具有与 gem 本身同名的文件，因此如果您想使用 gem `foo`，您可以使用`require 'foo'`. 但情况并非总是如此，例如使用[`bcrypt-ruby`](https://rubygems.org/gems/bcrypt-ruby)您需要的 gem `require 'bcrypt'`。

此外，宝石不一定必须包含*任何*填充物。gem就是一个例子`rails`，它本身不包含任何文件（至少在 3.2 版中），但依赖于各种 Rails 组件，因此您可以一步安装它们。

在您的情况下，虽然您`lib/testgem.rb`的 gems 项目目录中有一个文件，但您并没有将它包含在您的 gem 中。您需要指定[应包含哪些文件](http://guides.rubygems.org/specification-reference/#files)，默认为不包含任何内容。

要简单地将所有文件包含在项目目录中，您可以添加如下内容：

```
s.files = Dir.glob '**/*' 
```

到你的 gemspec。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-23T21:00:08.967

你需要`require 'rubygems'`先。

# python - 使用 selenium webdriver 获取浏览器版本

> ID：12556163
> 
> 赞同：36
> 
> 时间：2012-09-23T20:54:12.450
> 
> 标签：python, selenium, selenium-webdriver, firefox, geckodriver

我将如何获得正在使用的浏览器版本？

```
>>> from selenium import webdriver
>>> driver = webdriver.Firefox()
>>> print version <-- how to do this?
    Firefox 12.0 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-28T18:30:02.523

这个答案使我走上了正确的道路，但特定于python，而且主题更广泛。所以，我正在为 Java 添加一个更棘手的答案。此时我使用的是 selenium 2.25.0。

```
//make sure have correct import statements - I had to add these
import org.openqa.selenium.Capabilities;
import org.openqa.selenium.remote.RemoteWebDriver;

WebDriver driver = new FirefoxDriver();

Capabilities caps = ((RemoteWebDriver) driver).getCapabilities();
String browserName = caps.getBrowserName();
String browserVersion = caps.getVersion();
System.out.println(browserName+" "+browserVersion); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-09-24T05:47:25.937

该[`capabilities`](https://github.com/SeleniumHQ/selenium/wiki/DesiredCapabilities)属性是一个包含有关浏览器本身信息的字典，因此应该可以：

```
print(driver.capabilities['version']) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-08-23T12:41:37.097

如果您使用的是 Chrome，您可以执行以下操作：

```
driver.capabilities['version'] 
```

如果您使用的是 Firefox：

```
driver.capabilities['browserVersion'] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-08-12T19:09:23.773

如果`driver.capabilities['version']`对您不起作用，请检查功能。版本号在那里，但它可能在不同的密钥下。例如，当我尝试使用密钥访问版本号时，我在 Windows 10 上遇到了密钥错误`version`。

要检查功能：

```
print driver.capabilities 
```

对我来说，这适用于 Chrome/Linux

```
driver.capabilities['version'] 
```

这适用于 Chrome/Windows 10

```
driver.capabilities['browserVersion'] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-02-12T22:22:33.213

虽然这可能不能完全回答上面的问题，但这对于那些正在寻找一种基于从不同浏览器（即 Firefox 与 Chrome）接收到的不同行为来编写测试代码的人来说仍然很有用。当我偶然发现这个线程时，我正在寻找这个，所以我想我会添加它以防它可以帮助其他人。

在 Python 上，如果您只是在寻找您正在测试的浏览器（即 firefox、chrome、ie 等），那么您可以使用...

```
driver.name 
```

...在**if**语句中。这假设您已经为您正在测试的网络浏览器（即 Firefox、Chrome、IE 等）分配了**驱动程序。**但是，如果您的任务是测试同一浏览器的多个版本，那么您将需要更多的东西来**驱动程序版本**。希望这可以帮助某人。当我发现这个线程时，我正在寻找这个解决方案，所以我想我会添加它以防万一其他人需要它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-07-09T17:59:24.827

您可以通过访问返回[字典的](/questions/tagged/dictionary "show questions tagged 'dictionary'")[功能](https://github.com/SeleniumHQ/selenium/wiki/DesiredCapabilities#used-by-the-selenium-server-for-browser-selection)对象来提取[GeckoDriver](https://stackoverflow.com/questions/45329528/which-firefox-browser-versions-supported-for-given-geckodriver-version/45331403#45331403)启动的[firefox](/questions/tagged/firefox "show questions tagged 'firefox'")会话的**浏览器版本**，您可以使用以下解决方案：

```
from selenium import webdriver
from selenium.webdriver.firefox.options import Options

options = Options()
options.binary_location = r'C:\Program Files\Mozilla Firefox\firefox.exe'
driver = webdriver.Firefox(firefox_options=options, executable_path=r'C:\WebDrivers\geckodriver.exe')
my_dict = driver.capabilities
print("Mozilla Firefox browser version is: " + str(my_dict['browserVersion']))
driver.quit() 
```

控制台输出：

```
Mozilla Firefox browser version is: 77.0.1 
```

* * *

## 提取所有能力

同样，您可以从字典中提取所有属性，如下所示：

```
from selenium import webdriver
from selenium.webdriver.firefox.options import Options

options = Options()
options.binary_location = r'C:\Program Files\Mozilla Firefox\firefox.exe'
driver = webdriver.Firefox(firefox_options=options, executable_path=r'C:\WebDrivers\geckodriver.exe')
my_dict = driver.capabilities
for key,val in my_dict.items():
    print (key, "=>", val)
driver.quit() 
```

控制台输出：

```
acceptInsecureCerts => True
browserName => firefox
browserVersion => 77.0.1
moz:accessibilityChecks => False
moz:buildID => 20200602222727
moz:geckodriverVersion => 0.26.0
moz:headless => False
moz:processID => 12668
moz:profile => C:\Users\Soma Bhattacharjee\AppData\Local\Temp\rust_mozprofileFc1B08
moz:shutdownTimeout => 60000
moz:useNonSpecCompliantPointerOrigin => False
moz:webdriverClick => True
pageLoadStrategy => normal
platformName => windows
platformVersion => 10.0
rotatable => False
setWindowRect => True
strictFileInteractability => False
timeouts => {'implicit': 0, 'pageLoad': 300000, 'script': 30000}
unhandledPromptBehavior => dismiss and notify 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-23T03:06:35.890

如果您将 WebDriver 包装为 EventFiring，则必须执行自定义 EventFiringWebDriver 实现。

```
import org.openqa.selenium.Capabilities;
import org.openqa.selenium.HasCapabilities;
import org.openqa.selenium.remote.RemoteWebDriver;
import org.openqa.selenium.support.events.EventFiringWebDriver;

public class MyEventFiringWebDriver extends EventFiringWebDriver implements HasCapabilities {

    private RemoteWebDriver driver;

    public MyEventFiringWebDriver(RemoteWebDriver driver) {
        super(driver);
        this.driver = driver;
    }

    @Override
    public Capabilities getCapabilities() {
        return driver.getCapabilities();
    }

} 
```

只是发布，因为这是我遇到的一个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-07-26T13:58:07.333

只是为想要打印所有功能的 Python 用户回答这个问题，因为我在不知不觉中正在搜索它。下面的命令有效。

`print driver.capabilities`

# magento - 通过管理面板在 Magento 中添加产品时将“产品名称”替换为“项目 + 产品 ID”

> ID：12556165
> 
> 赞同：0
> 
> 时间：2012-09-23T20:54:29.143
> 
> 标签：magento, title

我想在 Magento 中自动生成产品名称。

当我要添加产品时，我会为产品名称输入一些字符串。保存产品时，我希望自动生成产品名称，使*产品名称*变为**Item."productId"**。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T02:57:06.263

假设 OP 想要将实体表中的自动增量值合并到业务数据中。这通常不是一个好主意。

这是一项有趣的任务，可以通过 Magento 的 EAV 实现轻松完成 - 特别是在目录模块中工作时。首先，一些背景。

保存 EAV 实体时，它有一个漂亮、整洁的 key => value 对数组，它们表示该实体的属性和属性值：

```
Mage_Catalog_Model_Product->_data['attribute_code'] = 'attribute value'; 
```

在保存过程中，EAV 资源模型获取此数组并对其进行迭代。对于每个属性，由其代码（`attribute_code`在上面的示例中）和它的实体（`catalog_product`在产品的情况下）标识，属性本身的配置被加载。特别重要的是属性的“后端模型”，因为它被调用来对值进行预处理和后处理。

在当前情况下，有一条信息在我们保存属性时不会出现，至少不会以我们可以使用的方式出现：新产品 ID。这可用于在保存过程中调整原始值。

有一个来自核心的示例总是很好，因此，请参考`price`属性及其后端模型，`Mage_Catalog_Model_Product_Attribute_Backend_Price`可以在`eav_attribute`表中看到：

```
SELECT `attribute_code`, `backend_model`
FROM `eav_attribute`
LEFT JOIN `eav_entity_type` USING (`entity_type_id`)
WHERE `attribute_code` = 'price';

#+----------------+-----------------------------------------+
#| attribute_code | backend_model                           |
#+----------------+-----------------------------------------+
#| price          | catalog/product_attribute_backend_price |
#+----------------+-----------------------------------------+
#1 row in set (0.00 sec) 
```

保存产品时，价格属性的 backend_model 被实例化，并且（在这种情况下）该[`afterSave()`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Catalog/Model/Product/Attribute/Backend/Price.php#L75)方法被调用。顺便说一句，这种方法是根据网站范围定价的转化率更新定价的方法。可以使用相同的方法来修改`name`属性。

以下设置脚本将添加后端模型：

```
<?php

    $installer = Mage::getResourceModel('catalog/setup','default_setup');

    $installer->startSetup();

    $installer->updateAttribute(
        'catalog_product',
        'name',
        'backend_model',
        'custom/product_attribute_backend_name'
    );

    $installer->endSetup(); 
```

相应的`afterSave()`方法应该可以解决问题：

```
public function afterSave($object)
{
    $value = $object->getData($this->getAttribute()->getAttributeCode());
    $origData = $object->getOrigData();
    $origValueExist = $origData && array_key_exists($this->getAttribute()->getAttributeCode(), $origData);

    //don't do this in case of update
    if ($object->getStoreId() != 0 || !$value || $origValueExist) {
        return $this;
    }

    //append autoinc id
    $newValue = $value .'.'. $object->getId(); // or whatever

    //assume global store, otherwise the stated need is getting weird!
    $object->addAttributeUpdate($this->getAttribute()->getAttributeCode(), $newValue, 0);

    return $this;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T00:29:30.967

如果您是从管理面板产品编辑屏幕执行此操作，则必须从“名称”字段中删除“必需”类，以便可以在没有名称的情况下保存它。这意味着覆盖编辑表单以专门替换该字段。然后你必须在产品模型上重载与保存相关的方法（或者你可以从控制器中完成），但是孩子必须在保存之前生成名称，然后才能进入数据库。

例如：

```
class Module_Catalog_Model_Product extends Mage_Catalog_Model_Product
{
    protected function _beforeSave()
    {
        parent::_beforeSave();

        $productName = 'Item' . $this->getId();

        if (!$this->getId() && !$this->getName())
        {
            $this->setName('Item Unnamed');

        } elseif ($this->getId()) && strcasecmp($this->getName(), $productName) <> 0)
        {
            $this->setName($productName);
        }
    }
} 
```

唯一的问题是它需要两次保存。如果你想让它运行起来，你必须使用 _afterSave() 方法进行第二次保存。或者，再一次，您可以从控制器中执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T20:44:57.833

我会使用 Magento 事件来做到这一点：

由于 Magento 中的模型具有事件前缀（只需查看`Mage_Catalog_Model_Product`并查找`$_eventPrefix`，对于我们当前的模型， eventPrefix 设置为`catalog_product`.

如果您现在查看`Mage_Core_Model_Abstract`并搜索`_eventPrefix`. 您会看到 eventPrefix 在 _beforeLoad、_afterLoad、_beforeSave、_afterSave 和其他一些中找到。在这些方法中，您可以看到使用以下内容调度事件：

`Mage::dispatchEvent($this->_eventPrefix.'_save_before', $this->_getEventData());`

这意味着您有一个可用的事件，称为`catalog_product_save_before`. 通过这个事件，您可以在那个时候连接到 Magento 并做您的事情，在这种情况下更改字段，然后由 Magento 处理其余的事情。

查看[http://www.magentocommerce.com/wiki/5__-_modules_and_development/0__-_module_development_in_magento/customizing_magento_using_event-observer_method](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/customizing_magento_using_event-observer_method)了解如何使用这些事件并将它们转换为模块的更多信息。如果您不知道如何为 Magento 构建模块并想学习，这里有一些很棒的免费点播视频：http: [//www.magentocommerce.com/training/on-demand](http://www.magentocommerce.com/training/on-demand)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T21:12:12.377

首先，我要感谢所有在该主题中写作的用户。非常感谢你们！

我做到了，但我让它更容易。（因为我对 Magento 有非常基本的了解，而且需要更多时间）

所以......我的同事决定使用 php/jquery/ajax 来实现。

首先我们创建一个 php 文件，它返回**最后一个 id**：

```
 <?php
 header('Access-Control-Allow-Origin: *');
 require_once 'app/Mage.php';
 umask(o);
 Mage::app('default');
 Mage::getSingleton('core/session', array('name'=>'frontend'));

$model = Mage::getModel('catalog/product'); //getting product model
$collection = $model->getCollection(); //products collection
foreach ($collection as $product) //loop for getting products
{                    
    $id=$product->getId();
}
if($id)echo $id+1; //id of product
else{
    echo 0;
}
?> 
```

在第一步之后，我设置输入的值（即我自动生成名称）：

```
if($j('#name').val()=='' &&  window.location.href.indexOf("admin/catalog_product/new/") > -1) {
    $j.post('http://www.website.com/file.php', function(data) {
        $j('#name').val('Item №'+data);
    }); 
} 
```

再次感谢您的帮助。

最好的问候，乔丹！

# java - java xpath比较格式化日期和xml中的当前日期

> ID：12556167
> 
> 赞同：3
> 
> 时间：2012-09-23T20:54:36.180
> 
> 标签：java, xml, date, xpath

我有这样的 XML 文件：

```
<books>
<book>
    <id>1</id>
    <validFrom>23.11.2012</validFrom>
    <validTo>26.09.2012</validTo>
</book>
<book>
    <id>2</id>
    <validFrom>14.09.2012</validFrom>
    <validTo>01.08.2012</validTo>
</book> 
```

我想从此 xml 文件中删除所有书籍，其中 datevalidTo 早于当前日期，但我在 XPath 中查询时遇到问题。

我尝试了不同的方式。

```
XPathFactory xPathFactory = XPathFactory.newInstance();
        XPath xpath = xPathFactory.newXPath();
        XPathExpression expr 
         = xpath.compile("//book[validTo < fn:current-date()]");

Object result = expr.evaluate(doc, XPathConstants.NODESET);
    NodeList nodes = (NodeList) result;
    for (int i = 0; i < nodes.getLength(); i++) {
        removeFindNodes()
    } 
```

如何格式化 validTo 以便能够与当前日期进行比较？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:11:56.133

`xsd:date`期望格式为`yyyy-MM-dd`，而您的格式为`dd.MM.yyyy`. 您可以尝试使用 、 和 的组合`substring`来`translate`转换`concat`您的格式，但到那时您的 XPath 表达式会变得稍微复杂一些。另一种更容易阅读的解决方案是获取所有`validTo`节点，*然后*与 Java 进行比较：

```
XPathExpression expr = xpath.compile("//book/validTo");
Object result = expr.evaluate(doc, XPathConstants.NODESET);
NodeList nodes = (NodeList) result;

DateFormat df = new SimpleDateFormat("dd.MM.yyyy");
Calendar now = Calendar.getInstance();
now.set(Calendar.HOUR_OF_DAY, 0);
now.set(Calendar.MINUTE, 0);
now.set(Calendar.SECOND, 0);
now.set(Calendar.MILLISECOND, 0);

for (int i = 0; i < nodes.getLength(); i++) {
  Node validToNode = nodes.item(i);
  Date validTo = df.parse(validToNode.getTextContent());
  if (validTo.compareTo(now.getTime()) < 0) {
    Node bookNode = validToNode.getParentNode();
    removeNode(bookNode);
  }
} 
```

# c# - 在 Windows 8 应用程序中扩展启动后无法导航到页面

> ID：12556184
> 
> 赞同：2
> 
> 时间：2012-09-23T20:56:11.863
> 
> 标签：c#, xaml, windows-runtime, winrt-xaml, async-await

我按照 Microsoft 提供的指南创建了扩展的初始屏幕。屏幕显示，数据加载，但应用程序没有导航到登录页面。这怎么可能？

扩展Splash.xaml.cs

```
public sealed partial class ExtendedSplash
{

    public ExtendedSplash(SplashScreen splash)
    {
        this.InitializeComponent();

        // Position the extended splash screen image in the same location as the splash screen image.
        this.extendedSplashImage.SetValue(Canvas.LeftProperty, splash.ImageLocation.X);
        this.extendedSplashImage.SetValue(Canvas.TopProperty, splash.ImageLocation.Y);
        this.extendedSplashImage.Height = splash.ImageLocation.Height;
        this.extendedSplashImage.Width = splash.ImageLocation.Width;

        // Position the extended splash screen's progress ring.
        this.ProgressRing.SetValue(Canvas.TopProperty, splash.ImageLocation.Y + splash.ImageLocation.Height + 32);
        this.ProgressRing.SetValue(Canvas.LeftProperty,
     splash.ImageLocation.X +
             (splash.ImageLocation.Width / 2) - 15);
    }

    public void onSplashScreenDismissed(SplashScreen sender, object args)
    {

    }
} 
```

来自 App.xaml.cs

```
 protected override async void OnLaunched(LaunchActivatedEventArgs args)
    {
        _newsDataSource = (NewsDataSource)App.Current.Resources["newsDataSource"];
        _movieDataSource = (MovieDataSource)App.Current.Resources["moviesDataSource"];
        await PerformDataFetch();

        // extended splash screen loading
        ExtendedSplash eSplash = new ExtendedSplash(args.SplashScreen);
        args.SplashScreen.Dismissed +=
            new TypedEventHandler<SplashScreen, object>(eSplash.onSplashScreenDismissed);

        // Place the frame in the current Window
        Window.Current.Content = eSplash;
        Window.Current.Activate();
    }

    internal async Task PerformDataFetch()
    {
        // load news
        if (_newsDataSource != null)
        {
            if (!_newsDataSource.News.Any())
            {
                await _newsDataSource.GetNewsAsync();
            }
        }

        // load movies
        if (_movieDataSource != null)
        {
            if (!_movieDataSource.Movies.Any())
            {
                await _movieDataSource.GetMoviesAsync();
            }
        }

        RemoveExtendedSplash();
    }

    internal void RemoveExtendedSplash()
    {
        Window.Current.Content = new MainPage();
        Window.Current.Activate();
    } 
```

如果在最后一个方法上放置断点，它会触发，但不会转换到页面。我喜欢 ProgressRing 的动画，但该应用程序也应该做其他事情 :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T11:53:37.200

ExtendedSplash 必须是一个页面。所以 ExtendedSplash.xaml.cs：

```
public sealed partial class ExtendedSplash : Page
{
    public ExtendedSplash()
    {
        this.InitializeComponent();
    }

    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        SplashScreen splash = (SplashScreen) e.Parameter;

        // Position the extended splash screen image in the same location as the splash screen image.
        this.extendedSplashImage.SetValue(Canvas.LeftProperty, splash.ImageLocation.X);
        this.extendedSplashImage.SetValue(Canvas.TopProperty, splash.ImageLocation.Y);
        this.extendedSplashImage.Height = splash.ImageLocation.Height;
        this.extendedSplashImage.Width = splash.ImageLocation.Width;

        // Position the extended splash screen's progress ring.
        this.ProgressRing.SetValue(Canvas.TopProperty, splash.ImageLocation.Y + splash.ImageLocation.Height + 32);
        this.ProgressRing.SetValue(Canvas.LeftProperty,
     splash.ImageLocation.X +
             (splash.ImageLocation.Width / 2) - 15);
    }
} 
```

并且所有的数据获取操作都应该在 App.xaml.cs 中执行。完成后，只需将框架导航到登录页面即可。

```
sealed partial class App : Application
{
    private Frame _rootFrame;

    protected override async void OnLaunched(LaunchActivatedEventArgs args)
    {
        if(_rootFrame == null)
            _rootFrame = new Frame();

        // Place the frame in the current Window
        _rootFrame.Navigate(typeof (ExtendedSplash), args.SplashScreen);
        Window.Current.Content = _rootFrame;
        Window.Current.Activate();

        await PerformDataFetch();
    }

    internal async Task PerformDataFetch()
    {
        // data loading here

        RemoveExtendedSplash();
    }

    internal void RemoveExtendedSplash()
    {
        if (_rootFrame != null) _rootFrame.Navigate(typeof (MainPage));
    }
} 
```

# android - 压缩 achart 引擎 - husk 指定图表类型

> ID：12556187
> 
> 赞同：0
> 
> 时间：2012-09-23T20:56:32.713
> 
> 标签：android, compression, achartengine

它能够压缩achart引擎吗？

我不想使用所有图表类型，只使用一两个，因此包含整个库的 100KB jar 文件并不是一个好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T23:31:02.517

如果您在应用程序上使用[Proguard](http://developer.android.com/tools/help/proguard.html)，它将删除代码中未引用的类，包括库 JAR 中的类（假设已正确配置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T12:06:00.050

我建议你不要开始破解 AChartEngine jar 文件。它确实很好地解耦了，但是有些部分相互依赖，如果你开始删除一些东西，你最终会得到一个不起作用的版本。

正如上面提到的，100+ KB 并不是那么大。

# java - Java - 没有 GUI 的倒数计时器

> ID：12556190
> 
> 赞同：6
> 
> 时间：2012-09-23T20:56:49.163
> 
> 标签：java, countdown

基本上我正在制作一个基于文本的“游戏”（与其说是游戏，不如说是提高基本 Java 技能和逻辑的一种方式）。但是，作为其中的一部分，我希望有一个计时器。它会倒计时我希望从变量到 0 的时间。现在，我已经看到了几种使用 gui 的方法，但是，有没有办法在没有 gui/jframe 等的情况下做到这一点。

所以，我想知道的是。你能在不使用 gui/jframe 的情况下从 x 倒数到 0 吗？如果是这样，你会怎么做？

谢谢，一旦我有了一些想法，就会随着进度进行编辑。

**编辑**

```
// Start timer
Runnable r = new TimerEg(gameLength);
new Thread(r).start(); 
```

以上是我如何调用线程/计时器

```
public static void main(int count) { 
```

如果我在 TimerEg 类中有这个，则计时器符合要求。但是，当我在另一个线程中编译 main 时。

![错误](../Images/9e63091f9c1401ec18436185dccc8add.png)

现在，我是否完全误解了线程以及这将如何工作？还是我缺少什么？

错误：

```
constructor TimerEg in class TimerEg cannot be applied to given types;
required: no arguments; found int; reason: actual and formal arguments differ in length 
```

网上找的`Runnable r = new TimerEg(gameLength);`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T21:00:56.610

与 GUI 相同，您将使用 Timer，但在这里您将使用 java.util.Timer 而不是 Swing Timer。查看[Timer API](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html)了解详细信息。还可以查看[TimerTask API](http://docs.oracle.com/javase/7/docs/api/java/util/TimerTask.html)，因为您可以将它与 Timer 结合使用。

例如：

```
import java.util.Timer;
import java.util.TimerTask;

public class TimerEg {
   private static TimerTask myTask = null;
   public static void main(String[] args) {
      Timer timer = new Timer("My Timer", false);
      int count = 10;
      myTask = new MyTimerTask(count, new Runnable() {
         public void run() {
            System.exit(0);
         }
      });

      long delay = 1000L;
      timer.scheduleAtFixedRate(myTask, delay, delay);
   }
}

class MyTimerTask extends TimerTask {
   private int count;
   private Runnable doWhenDone;

   public MyTimerTask(int count, Runnable doWhenDone) {
      this.count = count;
      this.doWhenDone = doWhenDone;
   }

   @Override
   public void run() {
      count--;
      System.out.println("Count is: " + count);
      if (count == 0) {
         cancel();
         doWhenDone.run();
      }
   }

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T21:10:13.343

您可以编写自己的倒数计时器，如下所示：

```
public class CountDown {
    //Counts down from x to 0 in approximately
    //(little more than) s * x seconds. 
    static void countDown(int x, int s) {
        while (x > 0 ) { 
            System.out.println("x = " + x); 
            try {
                Thread.sleep(s*1000);
            } catch (Exception e) {}
            x--;
        }   
    }

    public static void main(String[] args) {
        countDown(5, 1); 
    }   
} 
```

或者你可以使用[Java Timer API](http://docs.oracle.com/javase/1.3/docs/api/java/util/Timer.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-14T12:03:37.263

**用java倒计时很简单..**

```
 int minute=10,second=60; // 10 min countdown
      int delay = 1000; //milliseconds
  ActionListener taskPerformer = new ActionListener() {
  public void actionPerformed(ActionEvent evt) {
      second--;
      // do something with second and minute. put them where you want.
      if (second==0) {
          second=59;
          minute--;

          if (minute<0) {
              minute=9;
          }
      }
  }
};
new Timer(delay, taskPerformer).start(); 
```

# jakarta-ee - Tomcat 错误 - 失败 - 无法启动上下文路径 /petclinic 处的应用程序

> ID：12556192
> 
> 赞同：1
> 
> 时间：2012-09-23T20:56:59.910
> 
> 标签：jakarta-ee, tomcat

我已经浏览了类似的问题，但没有提出任何问题，所以就这样吧。我安装了 Tomcat 7，然后用 maven 编译了 PetClinic 应用程序。我成功地将它部署到Tomcat。我已经取消部署并重新编译了war文件并部署了它，现在它抛出错误FAIL - 无法启动上下文路径/petclinic的应用程序。这是日志文件的前几行。请指教。谢谢。

```
 Sep 23, 2012 2:21:10 PM org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
Sep 23, 2012 2:21:10 PM org.apache.catalina.core.StandardContext listenerStop
SEVERE: Exception sending context destroyed event to listener instance of class org.springframework.web.context.ContextLoaderListener
java.lang.NoClassDefFoundError: org/apache/log4j/LogManager$PrivateManager
    at org.apache.log4j.LogManager.getLogger(LogManager.java:34)
    at org.slf4j.impl.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:73)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:209)
    at org.apache.commons.logging.impl.SLF4JLogFactory.getInstance(SLF4JLogFactory.java:155)
    at org.apache.commons.logging.impl.SLF4JLogFactory.getInstance(SLF4JLogFactory.java:131)
    at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:272)
at org.springframework.web.context.ContextCleanupListener.<clinit>(ContextCleanupListener.java:43)
at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:80)
at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4831)
at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5478)
at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:160)
at org.apache.catalina.manager.ManagerServlet.start(ManagerServlet.java:1255)
at org.apache.catalina.manager.HTMLManagerServlet.start(HTMLManagerServlet.java:714)
at org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:219) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:09:08.227

问题在这里：

```
SEVERE: Exception sending context destroyed event to listener instance of class org.springframework.web.context.ContextLoaderListener
java.lang.NoClassDefFoundError: org/apache/log4j/LogManager$PrivateManager
    at org.apache.log4j.LogManager.getLogger(LogManager.java:34)
    at org.slf4j.impl.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:73)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:209)
    at org.apache.commons.logging.impl.SLF4JLogFactory.getInstance(SLF4JLogFactory.java:155)
    at org.apache.commons.logging.impl.SLF4JLogFactory.getInstance(SLF4JLogFactory.java:131) 
```

问：您使用的是 log4j（这是我推荐的）还是 slf4j？

建议：

1) 确保相关的 .jar 文件（哎呀——为什么不同时包含*log4j*和 slf4j .jars）在您的 WAR 的 WEB-INF/lib 文件夹中。

2) 确保您的 Tomcat 环境中只有*一个*log4j 版本（您可能有两个相互冲突的 .jar 版本）。

# c++ - ifstream 没有创建和打开输出文件

> ID：12556193
> 
> 赞同：1
> 
> 时间：2012-09-23T20:57:15.137
> 
> 标签：c++, netbeans-6.9, ubuntu-11.04, ifstream

我在 Ubuntu 11.04 上使用 NetBeans 6.9 在 C++ 中进行开发。我已经声明了输入和输出文件名字符串和文件流

```
ifstream    fpInputFile, fpOutputFile;
string  inputFileName="", outputFileName=""; 
```

输入文件名被分配一个现有文件的名称作为应用程序的输入参数。输出文件名与输入名相同，只是在最后一个句点之前插入了“_output”。因此，输出将写入与输入所在的目录相同的目录。我也开始使用netbeans

```
su netbeans 
```

因此 IDE 对该目录具有 root 权限。我尝试打开文件，并检查它们是否被打开。

```
fpInputFile.open(inputFileName.c_str(), ifstream::in);
fpOutputFile.open(outputFileName.c_str(), ifstream::out);
if (!(fpInputFile.is_open())) throw ERROR_OPENING_FILE;
if (!(fpOutputFile.is_open())) throw ERROR_OPENING_FILE; 
```

输入文件成功打开，但输出文件没有。

任何帮助确定为什么输出文件没有打开以供写入将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:00:57.680

将输出文件声明为一个`ofstream`而不是一个`ifstream`.

您还可以将 a`fstream`用于输入和输出文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T21:26:22.353

明显的问题是您可能打算使用 a`std::ofstream`而不是`std::ifstream`. 这有助于实际写入流，尽管`std::ifstream`只要打开以供读取，就有办法写入。例如，您可以`std::streambuf`直接使用接口或使用`std::streambuf`来构造 and `std::ostream`。

更有趣的问题是：为什么在`std::ios_base::in | std::ios_base::out`使用打开模式时文件没有打开写入？`std::ifstream`自动添加`std::ios_base::in`. 事实证明，该模式`std::ios_base::in | std::ios_base::out`不会创建文件，但会成功打开现有文件。如果您真的想使用 an`std::ifstream`打开可能不存在的输出文件，则需要使用`std::ios_base::out | std::ios_base::trunc`or `std::ios_base::out | std::ios_base::app`：

*   前者将强制创建或截断文件（如果存在）
*   后者将在所有情况下强制写入附加到文件

但是，我个人的猜测是，您最好只使用`std::ofstream`，或者，如果您想打开文件以进行读取和写入`std::fstream`（但是，如果不存在文件，则还需要拥有`std::ios_base::trunc`或`std::ios_base::app`添加文件来创建文件）。

# android - GPS坐标变化太频繁

> ID：12556194
> 
> 赞同：0
> 
> 时间：2012-09-23T20:57:18.787
> 
> 标签：android, gps

我使用以下代码检查 GPS 坐标，但问题是，如果我站在同一个地方，坐标会发生变化，距离在 4 到 20 米之间。我只想在移动至少 10 米时才更改它。

```
 locationManager_gps = (LocationManager) this
                    .getSystemService(Context.LOCATION_SERVICE);
            locationManager_gps.requestLocationUpdates(
                    LocationManager.GPS_PROVIDER, 0, 0,
                    new MyLocationListener_gps());

class MyLocationListener_gps implements LocationListener {
        public void onLocationChanged(Location location) {

            clat = location.getLatitude();
            clon = location.getLongitude();

            if (clat != plat || clon != plon) {
                float[] results = new float[3];
                Location.distanceBetween(plat, plon, clat, clon, results);

                if (flag_gps == 0) {
                    flag_gps = 1;
                } else {
                    GeoPoint geoPoint = new GeoPoint((int) (clat * 1E6),
                            (int) (clon * 1E6));
                    mapView.getController().animateTo(geoPoint);
                    draw = new MyOverLay(geoPoint);
                    mapView.getOverlays().add(draw);

                    dist_mtr += results[0];

                }
                plat = clat;
                plon = clon;
            }
        } 
```

如果我使用 50 作为更新之间的最小距离，那么它工作正常。我还尝试将其设为 30，但在汽车行驶时 4 公里内的数据也有误。

请建议我应该做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:42:54.053

您需要结合使用 minTime 和 minDistance 。两者都传递零和零，因此更新之间的最短时间至少为零秒，最小距离为零。因此，将 minTime 设置为合理的时间，将 minDistance 设置为 10 十米。

```
locationManager_gps.requestLocationUpdates(
                    LocationManager.GPS_PROVIDER, 0, 0,
                    new MyLocationListener_gps()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T00:31:56.987

没有灵丹妙药可以解决这个问题……gps 不是 100% 准确的，每次获得新的位置更新时，您总会有不同的读数。

您可以对位置值使用低通滤波器来最小化问题：

```
clat = plat + (clat-plat) * 0.2; // you should adjust the 0.2 value to the best results
clon = plon + (clon-plon) * 0.2;
....
//your code
....
plat = clat;
plon = clon; 
```

这样，值的突然变化的影响将最小化，这有利于位置的虚假变化，但也会延迟对设备移动时位置的真实变化的响应。您应该仔细选择常数乘法的值（以上 0.2）以获得最佳结果。

您甚至可以做得更好，使用变量而不是常数，并根据位置更新的准确性调整它的值（良好的准确性使变量接近 1，倾倒准确性使变量接近 0）

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:21:32.313

我也看到过这种情况，在读取几个位置时我没有移动。您可以获得具有不同精度的可变结果。例如，您可以尝试获取 10 个位置读数，然后获取准确度最高的一个，而忽略其余的。然后在进行下一次读数时，确保它位于两倍于前一个位置精度的距离处。例如，如果您的第一个位置的精度为 16 米，请确保下一个读数距离前一个位置至少 32 米，并且精度优于 32 米。

# javascript - MobileSafari 未通过 JavaScript 返回正确的图像大小信息

> ID：12556198
> 
> 赞同：7
> 
> 时间：2012-09-23T20:57:37.457
> 
> 标签：javascript, image, mobile-safari

我在[这里有一个针对这个问题的 HTML 测试页](http://still-island-1941.herokuapp.com/sizetest.html)。出于某种原因**，MobileSafari 将`Image.width/height`任何超过 1700 像素的图像的属性报告为其值的一半**。也就是说，`width`JPG 的属性是 2000，但 MobileSafari JavaScript 将其报告为 1000。如果我使用 1700 像素宽的图像尝试相同的代码，我会得到正确的宽度。

[我所做的测试](http://still-island-1941.herokuapp.com/sizetest.html)加载了两个图像（不同尺寸的相同图像）并显示 JavaScript 大小值。我试过了：

*   Mac OS X 10.6.8 中的 Chrome 22、Safari 5.1.7、Firefox 15.0.1（大小正确）
*   iOS 模拟器 4.3 SDK 3.2（大小不正确）
*   装有 iOS 5.1 的 iPad 2（尺寸不正确）
*   装有 iOS 5.1 的 iPhone 4S（尺寸不正确）

任何想法为什么会发生这种情况？我在某处缺少设置吗？为什么它适用于某些图像而不适用于其他图像？

测试在这里：[http ://still-island-1941.herokuapp.com/sizetest.html](http://still-island-1941.herokuapp.com/sizetest.html)

这是 JavaScript 代码：

```
 var imgBig, imgSmall;

    function init() {
        imgBig = new Image();
        imgBig.onload = handleBig;
        imgBig.src = "/images/size.jpg";
        imgSmall = new Image();
        imgSmall.onload = handleSmall;
        imgSmall.src = "/images/test1.jpg";
        document.getElementById("browser").innerHTML = navigator.userAgent;
    }

    function handleBig() {
        document.getElementById("dimensionsBig").innerHTML = imgBig.width + "x" + imgBig.height;
        document.getElementById("testBig").src = imgBig.src;
    }

    function handleSmall() {
        document.getElementById("dimensionsSmall").innerHTML = imgSmall.width + "x" + imgSmall.height;
        document.getElementById("testSmall").src = imgSmall.src;
    } 
```

这是 HTML 代码：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/> 
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>MobileSafari image dimensions test</title>
</head>
<body onload="init()">
    <p>your browser: <strong><span id="browser"></span></strong></p>
    <p>big image dimensions: <strong><span id="dimensionsSmall"></span></strong> (should be 1700x1134)</p>
    <img id="testSmall" />
    <p>small image dimensions: <strong><span id="dimensionsBig"></span></strong> (should be 2000x1334)</p>
    <img id="testBig" />
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T14:58:19.603

是的，它存在尺寸和重量的限制。

由于 iOS 上的可用内存，它可以处理的资源数量存在限制：

对于RAM 小于 256 MB 的设备，**解码**的 GIF、PNG 和 TIFF 图像的最大大小为3 兆像素，对于 RAM 大于或等于 256 MB 的设备，最大大小为 5 兆像素。也就是说，对于 RAM 小于 256 MB 的设备，请确保**width * height ≤ 3 * 1024 * 1024 。**请注意，**解码后的大小远大于**图像的编码大小：

> JPEG的最大**解码**图像大小为 32 兆像素，使用二次采样。由于二次采样，JPEG 图像最高可达 32 兆像素，这允许 JPEG 图像解码为像素数十六分之一的大小。对大于 2 兆像素的 JPEG 图像进行二次采样，即解码为缩小的尺寸。JPEG 二次采样允许用户查看来自最新数码相机的图像。
> 
> 对于 RAM 小于 256 MB 的设备，画布元素的最大大小为 3 兆像素，而对于 RAM 大于或等于 256 MB 的设备，画布元素的最大大小为 5 兆像素。如果未指定，画布对象的高度和宽度为 150 x 300 像素。

一些可以帮助的链接：

*   [Apple 官方网站](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/CreatingContentforSafarioniPhone/CreatingContentforSafarioniPhone.html)：查看了解 iOS 资源限制部分
*   [评论中的分析和解决方案](http://www.defusion.org.uk/archives/2010/02/19/shrinking-large-background-image-bug-in-iphone-safari/)
*   [解决方法](http://roblaplaca.com/blog/2010/05/05/ipad-safari-image-limit-workaround/)

干杯

# c# - ASP.NET MVC2 实现会话超时警告

> ID：12556204
> 
> 赞同：0
> 
> 时间：2012-09-23T20:58:20.787
> 
> 标签：c#, .net, session, asp.net-mvc-2, session-timeout

我需要有关 MVC2 应用程序会话超时警告的帮助。当用户在会话超时的“n”分钟内时，应该会出现一个弹出窗口。是否有某种方法可以知道该信息或必须计算该信息。我有标准的获取/发布操作，但也有 AJAX 请求。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:20:20.823

ASP.NET sessione`n`在对服务器的最后一次请求后几分钟到期，因此只需了解是什么`n`，将其呈现到页面，并在适当的时候使用简单的 Javascript 计时器显示消息，如下所示：

```
<sctipt type="text/ecmascript">
var timeoutMins = <%= Session.Timeout %>; // HttpSessionstate.Timeout is the timeout period in minutes
setTimeout( informUser, 0.75 * ( timeoutMins * 60 * 1000 ) );
function informUser() {
    alert("Your session is expiring shortly");
}
</script> 
```

该`0.75 * ( timeoutMins * 60 * 1000)`部分将超时长度值转换为毫秒，然后将其缩小以给用户时间做出反应。您可以通过向服务器发出 AJAX 请求来自动扩展会话（使用当前的 ASP.NET 会话 cookie，这很重要）。

修改此代码以使用固定的警报周期或计算“剩余分钟数”数字是留给读者的练习。

# hbase - 我如何在猪中获得 hbase rowkey

> ID：12556220
> 
> 赞同：1
> 
> 时间：2012-09-23T21:01:48.397
> 
> 标签：hbase, apache-pig

我是 Hbase 和猪的新手。
我有一个 hbase 表，我想从我的 pig 脚本中获取最大行键。
有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T07:47:59.580

您必须询问[元](http://hbase.apache.org/book.html#arch.catalog)服务器以获取表中最后一个区域的结束行键。所有值都已排序，因此获得最后一个区域应该不难。

info:regioninfo（此区域的序列化[HRegionInfo](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/HRegionInfo.html)实例）包含您要查找的信息。

如果 pig 不直接支持这一点，您可以编写一个[用户定义的函数](http://pig.apache.org/docs/r0.10.0/udf.html)，将其放在类路径中并从您的脚本中调用它。

我不知道更好的方法。

# ios - 滚动样式 UIPageViewController 中的多个可见页面

> ID：12556224
> 
> 赞同：13
> 
> 时间：2012-09-23T21:03:03.150
> 
> 标签：ios, ios6, uipageviewcontroller

所以我想做的是有一个 UIPageViewController 最终会显示三个视图控制器视图，一个完全可见，然后两个作为左右预览。一个例子是 iOS6 App Store：

![iOS6 应用商店](../Images/8e482ed5c0ecd7d2fcefb94e4ff98a9f.png)

是否使用设置为可能的 UIPageViewController 来执行此操作 `UIPageViewControllerTransitionStyleScroll`？

基本上，我最理想的情况是，我可以拥有三个 UIViewController，当用户通过列表中的 1 个项目（n 至少为 50）进行翻页时，我可以回收它们。我知道这样的界面可以通过启用分页的 UIScrollView 来完成，但是如果 Apple 已经为我完成了这些代码，我宁愿不编写这些代码来重新使用视图。

顺便说一句，我对这只是 iOS6 的事实感到完全满意，并且如果存在替代方案，我也对它们感到满意。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T10:26:45.460

检查新的[集合视图](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionView_class/Reference/Reference.html)。我认为您可以通过重用单元格等来创建类似的东西。

# ruby-on-rails - 是否可以在 MiniTest 中将测试标记为待处理？

> ID：12556226
> 
> 赞同：89
> 
> 时间：2012-09-23T21:03:31.160
> 
> 标签：ruby-on-rails, testing, minitest

如果这是可能的，它的语法是什么？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-11-22T00:18:03.037

我花了几分钟在 RubyDocs 上四处寻找，以找出实现这一点的实际语法。想我会把它扔在这里以节省一些未来的人点击几下。

从您的测试内部，只需调用该`skip()`方法，如下所示：

```
skip("reason for skipping the test") 
```

该方法是`MiniTest::Assertions#skip`- [http://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-skip](http://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-skip)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-24T01:53:45.243

我想通了。使用 minitest，您不会将测试标记为待处理。但是你可以跳过它们：

[http://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-skip](http://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-skip)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-03-16T11:18:13.677

此外，在使用 MiniTest::Spec 时，如果您没有将块传递给 it()，则测试将被标记为已跳过。

# javascript - 我需要将空参数传递给 javascript 函数吗？

> ID：12556229
> 
> 赞同：27
> 
> 时间：2012-09-23T21:04:05.610
> 
> 标签：javascript, function, parameters, optional-parameters

假设我有一个这样的函数，我在整个脚本中调用它：

```
 function form_senden( form_name, cnf, confirm_txt, trigger_field, ,do_check, chknfcs, allow, errorMsg ){
  // do something 
  } 
```

在我的大多数函数调用中，我只传递了第一个参数。

**问题：**
在这种情况下是否可以省略传递空参数，如下所示：

```
 form_senden("abc"); 
```

或者我是否需要传递所有参数，无论它们是否像这样使用：

```
 form_senden("abc","","","","","","","",""); 
```

谢谢！

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2012-09-23T21:06:31.603

只传递第一个参数是可以的，因为不会设置所有其他参数。如果要设置第一个和第三个参数，则需要使第二个为空，如下所示：

```
form_senden("a",null,"b"); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-09-23T21:06:23.437

form_senden("abc"); 没问题

其他参数将被初始化为未定义

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T21:05:49.853

您可以`form_senden("abc");`将默认值放入函数定义中。

```
 function form_senden( form_name, cnf , confirm_txt , trigger_field , ,do_check , chknfcs, allow, errorMsg  ){

if(typeof(cnf)==='undefined') cnf = '';
if(typeof(confirm_txt)==='undefined') confirm_txt = ''; ...and so on
// do something 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T21:05:38.337

省略函数参数是可以的，缺少的参数将`undefined`在函数中具有价值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-01-20T12:05:05.830

如果你有类似的东西：

`const myFunc = (a = 1, b = 2, c = 3) => a + b + c;`

如果你打电话`myFunc();`，你会得到**6**。

但是如果你想用**c = 4**调用 myFunc并让**a**和**b**为其默认值，你可以这样调用**myFunc**：

`myFunc(undefined, undefined, 4);`这将返回**7**。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-18T01:34:25.343

为了完整起见，在 ES6 (ES2015) 及更高版本中，可以指定默认值

```
// `b` will default to 1

function multiply(a, b = 1) {
  return a * b;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-02-27T20:28:42.047

在这里，我找到了将空值或空值传递给函数的解决方案。它适用于 node.js

```
 function returnJSON(name,value1,value2,text){
        return object = {
            'name':name,
            'value1':value1,
            'value2':value2,
            'text':text
        }
    }
    returnJSON('Hello World',undefined,undefined,'This is Text'); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-21T17:59:34.987

关于默认参数设置。如果您使用函数 f(arg=1) {} 等默认参数设置，则默认值的设置将不适用于传入的 false、nulll 或零。您必须将 arg/参数留空或传入不明确的。

# java - 数据库或应用程序锁定文件

> ID：12556233
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:05:13.870
> 
> 标签：java, database

为了保证每个数据库/资源​​只有一个写入事务，我正在创建一个 .lock 文件，以防止其他 JVM 启动会话。

但是，如果应用程序崩溃，我不确定如何在 Eclipse 中处理它。我想我必须手动删除文件？！那么，这是一个常见的解决方案还是存在其他解决方案？我认为重新启动的应用程序（崩溃后）无法与通常的应用程序区分开来，我认为这是 Eclipse 困扰我一两次的一件事，它没有显示我必须删除锁的正确消息 -重新启动 Eclipse 之前的文件。但我不确定这是否是问题所在。

好的，我可能有另一种写入事务的解决方案，它必须检查一个事务日志，该事务日志被删除以确保正确提交的事务。但是，写事务是在检查*之后*使用的。是否存在其他解决方案？我想不出任何...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:08:18.620

长期以来，数据库一直在处理事务和隔离。我一生都无法理解为什么你会看到重新发明这个轮子的必要性。你没听说过JTA吗？

看看 Spring 及其事务管理器。这个问题已经被其他人更好地解决了。

更新：NoSQL 意味着设计上没有 ACID。如果您需要 ACID，请不要使用 NoSQL。您正在增加复杂性以弥补糟糕的设计决策。

Eclipse 与此有什么关系？这是一个IDE。我认为您的用户不必启动 IDE 即可运行您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:41:29.550

你真的应该试着躲避这颗子弹。

但是，如果您使用的是能够在过去使用事务的 dbms，这是应用程序或用户锁定的一种技巧

您创建一个表，例如 applicationLocks 然后您启动事务并插入/更新特定记录，但不要提交它。后面的任何人都无法进入，因为该行已锁定，您需要采取一些适当的措施。

当应用程序关闭时，回滚。

如果应用程序崩溃，连接将关闭并且事务无论如何都会回滚。

# scala - Abuse of match?

> ID：12556236
> 
> 赞同：6
> 
> 时间：2012-09-23T21:05:45.750
> 
> 标签：scala, coding-style

Would you consider the following block of code match abuse and if so what's a more elegant way to do it without a big if-else-if block?

```
def sum(base: Int, xs: List[Int]): Int = {
  base match {
    case 0 => 1
    case _ if (base < 0) => 0
    case _ if (xs.isEmpty) => 0
    case _ => xs.sum
  }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-23T21:09:57.260

Yes, this an abuse of match. You've basically just written a big if-else-if block, but in a more awkward form. What's wrong with if-statements?

I think it's much cleaner to just write this:

```
def countChange(money: Int, coins: List[Int]): Int = {
  if(money == 0) 1
  else if (money < 0) 0
  else if (coins.isEmpty) 0
  else countChange(money, coins.tail) + countChange(money - coins.head, coins)
} 
```

If you want to stick with a `match`, you can move more of the checking into the match itself, so that it's actually doing something:

```
def countChange(money: Int, coins: List[Int]): Int = {
  (money, coins) match {
    case (0, _) => 1
    case _ if (money < 0) => 0
    case (_, Nil) => 0
    case (_, coinsHead :: coinsTail) => countChange(money, coinsTail) + countChange(money - coinsHead, coins)
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T21:10:29.800

No. Why abuse? It's fairly readable IMO...

The problem I see is that `money match ...` is fairly arbitrary (you only use the direct pattern in the first case); a complete "abuse" would start like

```
() match {
  case _ if (money == 0) => 1
  ... 
```

So perhaps stick to if-else; you can combine the second and third condition (`if( money < 0 || coins.isEmpty ) ...`)

* * *

Also note that although you "know" in the end that coins is not empty and thus may "safely" call `head` and `tail` on it, this is a typical source of unexpected runtime errors. The advantage of `coins match { case Nil => ...; case head :: tail => ...}` is that you cannot make such a mistake.

# c# - Xna 与墙壁 2D 的碰撞

> ID：12556238
> 
> 赞同：0
> 
> 时间：2012-09-23T21:05:55.433
> 
> 标签：c#, xna, collision-detection

![场景草图](../Images/41dfa4f717be1e6544c5bdddb3a46cbd.png)

好的，所以我一直在互联网上检查我的（有些人可能会说简单）碰撞检测问题的答案。我有一辆车，我基本上不希望它开车穿过墙壁或卡在里面。我试图将墙分成代表四个边缘的四个矩形，但是它会导致汽车以非常错误的方式移动。

有人能告诉我在哪里可以找到信息或告诉我如何解决如图所示的矩形汽车与墙壁的碰撞吗？我希望汽车继续朝着不会使其穿过墙壁的方向移动，但就像您通常会绕过它或离开一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:24:27.273

研究[分离轴定理](http://en.wikipedia.org/wiki/Separating_axis_theorem)。

您***真的***应该从 N+ 的开发人员那里阅读本[教程](http://www.metanetsoftware.com/technique/tutorialA.html)。它有几个交互式演示，因此您可以看到它们描述的概念。

![aabb](../Images/6578dfd687f69ce116dd3db75a08c311.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:15:15.420

在以下情况下，汽车能够撞到墙壁的侧面：

```
CarYT > WallYB && CarYB < WallYT 
```

如果这是真的，它会在以下情况下击中左侧：

```
CarXL < WallXL && CarXR >= WallXL 
```

其他情况类似。

# javascript - Javascript：从函数调用函数，同时保持两个参数

> ID：12556239
> 
> 赞同：0
> 
> 时间：2012-09-23T21:05:57.407
> 
> 标签：javascript, function, call

```
function a(x) {
    //...
    return { b: b(arguments) }
}

function b(x, args) {
    // x = foo
    // args[0] = bar
}

a("foo").b("bar");
​ 
```

我怎样才能让它工作？内部函数`b`我想在此调用后`x`从函数`a`和`x`函数访问：`b``a("foo").b("bar");`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:14:25.710

如果您对同一个对象创建`a()`和方法并将其参数存储在该对象中，您可以从.`b()``a()``b()`

```
function foo() {};
foo.prototype = {
    a: function(x) {
        // do whatever you want
        this.arg = x;
        return(this);
    },
    b: function(y) {
        // y is what is passed here
        // this.arg is what was passed to a
    }
};

var obj = new foo();
obj.a("foo").b("bar");
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:10:25.387

这对你有用吗：

```
function a(x) {
    return {
        b: function(y) {
            //here you can access both x and y
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:13:17.660

由于`b(arguments)`将立即调用，`b(arguments)`因此必须返回对函数的引用才能使其工作。像这样的东西：

```
function a(x) {
    //...
    return { b: b(arguments) }
}

function b(x, args) {
    return function () {
       alert(x[0]); // Will alert foo
    };
}

a("foo").b("bar");​ 
```

像这样`b(arguments)`将立即调用，返回将是对函数的引用。然后调用时`.b("bar")`，将调用返回的函数引用。该函数在函数 b 的范围内，因为它是在其中声明的，因此传递给的参数`a`将可用。

一个工作小提琴：http: [//jsfiddle.net/XcgwV/](http://jsfiddle.net/XcgwV/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T21:18:03.117

怎么样：

```
function b(x, args) {
    document.writeln("fun b");
    // x = sup
    // args[0] = hi
}

function a(x) {
    document.writeln("fun a");
    return { b1: b }
}

a("foo").b1("bar"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T21:36:19.217

将 a(x) 的结果作为选项直接传递给 b() 怎么样？像;

```
function a(x) {
    return x
}

function b(x, y) {
    var result = y ? x + y : x;
    return result;
}

b(x, a(x)); 
```

调用 'a("foo").b("bar")' 目前不会像你写的那样工作，因为这意味着 b() 是 a{} 的子属性。对我来说，我可能需要更多地了解你想要做什么。

# ios - 如何在 iOS 上生成带有“真实”文本内容的 PDF？

> ID：12556244
> 
> 赞同：7
> 
> 时间：2012-09-23T21:07:00.103
> 
> 标签：ios, pdf, uikit, quartz-2d

我想在我的 iOS 6 应用程序中生成一个好看的 PDF。

我试过了：

*   UIView 在上下文中渲染
*   使用 CoreText
*   使用 NSString drawInRect
*   使用 UILabel drawRect

这是一个代码示例：

```
-(CGContextRef) createPDFContext:(CGRect)inMediaBox path:(NSString *) path
{
    CGContextRef myOutContext = NULL;
    NSURL * url;

    url = [NSURL fileURLWithPath:path];
    if (url != NULL) {
        myOutContext = CGPDFContextCreateWithURL ((__bridge CFURLRef) url,
                                                  &inMediaBox,
                                                  NULL);
    }

    return myOutContext;
}

-(void)savePdf:(NSString *)outputPath
{
    if (!pageViews.count)
        return;

    UIView * first = [pageViews objectAtIndex:0];

    CGContextRef pdfContext = [self createPDFContext:CGRectMake(0, 0, first.frame.size.width, first.frame.size.height) path:outputPath];

    for(UIView * v in pageViews)
    {
        CGContextBeginPage (pdfContext,nil);
        CGAffineTransform transform = CGAffineTransformIdentity;
        transform = CGAffineTransformMakeTranslation(0, (int)(v.frame.size.height));
        transform = CGAffineTransformScale(transform, 1, -1);
        CGContextConcatCTM(pdfContext, transform);

        CGContextSetFillColorWithColor(pdfContext, [UIColor whiteColor].CGColor);
        CGContextFillRect(pdfContext, v.frame);

        [v.layer renderInContext:pdfContext];

        CGContextEndPage (pdfContext);
    }

    CGContextRelease (pdfContext);
} 
```

渲染的 UIViews 只包含一个 UIImageView + 一堆 UILabels（一些有边界，一些没有边界）。

我还尝试了在 stackoverflow 上找到的建议：子类化 UILabel 并执行此操作：

```
- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx {
    BOOL isPDF = !CGRectIsEmpty(UIGraphicsGetPDFContextBounds());
    if (!layer.shouldRasterize && isPDF)
        [self drawRect:self.bounds]; // draw unrasterized
    else
        [super drawLayer:layer inContext:ctx];
} 
```

但这也没有改变任何东西。

无论我做什么，在预览中打开 PDF 时，文本部分都可以选择为一个块，但不是每个字符的字符，并且缩放 pdf 显示它实际上是一个位图图像。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:50:27.317

[Raywenderlich 的这个教程](http://www.raywenderlich.com/6818/how-to-create-a-pdf-with-quartz-2d-in-ios-5-tutorial-part-2)拯救了我的一天。希望它也对你有用。 [http://www.raywenderlich.com/6818/how-to-create-a-pdf-with-quartz-2d-in-ios-5-tutorial-part-2](http://www.raywenderlich.com/6818/how-to-create-a-pdf-with-quartz-2d-in-ios-5-tutorial-part-2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T22:18:50.613

我去年这样做时的经验是，Apple 没有提供任何库来做这件事。我最终导入了一个开源 C 库 (libHaru)。然后我在我的视图层次结构的每个类中添加了一个输出到它的函数。任何带有子视图的视图都会在其子视图上调用渲染。我的 UILabel、UITextFields、UIImageViews、UISwitches 等会将它们的内容输出为文本或图形，因此我还为某些视图渲染了背景颜色。

这并不是很令人生畏，但是 libHaru 给了我一些字体问题，所以 iirc 我最终只使用了默认字体和字体大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-19T08:45:45.217

它适用于 UILabels，除了你必须解决一个错误：

[在 iPad 上将 UIView 作为矢量呈现为 PDF - 有时呈现为位图，有时呈现为矢量](https://stackoverflow.com/questions/6423059/rendering-a-uiview-into-a-pdf-as-vectors-on-an-ipad-sometimes-renders-as-bitma)

# html - 标题后的 CSS 目标最后一段

> ID：12556248
> 
> 赞同：8
> 
> 时间：2012-09-23T21:07:46.653
> 
> 标签：html, css, css-selectors

我一直在寻找如何使用 CSS 编辑标题后的最后一段。

我认为`#div h1 ~ p:last-child`可以解决问题，但它会跳过第二个标题并编辑列表前的最后一段。我已经搜索了一段时间，并遇到了一些高级 css 帮助站点，但它们正在使用最常见的高级选择器重复自己。

的HTML：

```
<h1>Heading</h1>
<p>content</p>
<p>content</p>
<p>content</p>

<h2>Heading</h2>
<p>content</p>
<ul>
      <li>list</li>
      <li>list</li>
</ul> 
```

CSS：

```
#contentContainer > h1 ~ p:last-of-type {
    border-bottom: 1px solid #000;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:12:18.347

波浪号字符代表一般的兄弟选择器：

> 一般的兄弟组合选择器与相邻的兄弟组合选择器非常相似，不同之处在于被选择的元素不需要立即在第一个元素之后，而是可以出现在它之后的任何位置。

这意味着它可能在 100 个不同的标签（例如 h2、h3、div、img 等）之后，并且 css 仍然会影响它。

据我所知，没有选择器或选择器组合能够执行您想要执行的操作，因为元素都处于同一级别，并且 CSS 没有“做”那么先进这在它遇到不同的元素之前”。

对不起 - 如果我错了，我希望我是为了你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-27T13:04:13.890

如果您只想在标题和最后一段之间创建一个空格，您可以使用

```
p + h2, p + h3 { 
    padding-top: 20px 
} 
```

# php - Mod_rewrite 到会话控制“handler.php”？

> ID：12556254
> 
> 赞同：0
> 
> 时间：2012-09-23T21:08:32.723
> 
> 标签：php, apache, session, mod-rewrite, mod-auth

我想重写所有`http://models.example.com/*`请求`http://models.example.com/handler.php?requested_url=*`

然后，`handler.php`将检查我的`$_SESSION`变量以查看用户是否已登录。如果用户已登录，`handler.php`则将重定向到`requested_url`.

如果用户未登录，`handler.php`则将使用正则表达式来查找`requested_url`权限规则数组 ( `ruleList.php`) 之间的匹配项。如果`handler.php`看到有一条规则允许未登录的用户访问，`requested_url`那么它会重定向到`requested_url`，否则它会重定向到登录页面。

我的问题是：如何区分初始请求和重定向？（以避免无限循环）。我可以附加一个变量`&already_processed=true`，但这是完全不安全的。

我会使用 mod_auth，但问题是我希望可以通过网站的管理面板 ( `ruleList.php`) 设置权限。权限规则可能很复杂，设置它们的人不必在服务器的 httpd.conf 文件中四处寻找。mod_auth 的另一个问题是更改需要重置服务器。

我将不胜感激有关该主题的任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:18:29.640

> ...将重定向到...

重定向总是不安全的。它会将操作传递回客户端（浏览器），然后结束请求。

这意味着，下一个请求是一个新请求，并且 Apache 和您的 PHP 脚本都不知道该请求是否是新请求，*直到您将其添加到 session*。

但是，由于您希望您的 apache 网络服务器为资源提供服务，因此您需要在 apache 中验证会话。这意味着您需要扩展 apache，以便您可以检查一些环境变量或类似的重写条件。

可以想象，这有点复杂。

正如您提到的 mod_auth，IIRC 您可以查询 Mysql 数据库。完成后，您甚至可以针对请求 URI 进行验证。在您的情况下，这可能是一个简单的变体。

# android - 更改另一个活动而不打开它

> ID：12556255
> 
> 赞同：0
> 
> 时间：2012-09-23T21:08:40.587
> 
> 标签：android, android-intent, android-activity

是否可以在 Activity B 上添加一个`textView`而不显示它？

我的意思是，当我按下一个按钮（on `DiallerActivity`）时，a`textView`将被添加`HistoryActivity`而不离开`DiallerActivity`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:38:12.520

> 是否可以在 Activity B 上添加 textView 而不显示它？

不，不是直接的。

An`Activity`是一个特殊的 Android 类，不应被视为普通的 Java 类。实际上，an 的目的`Activity`是充当 UI 的框架，因此，如果 an`Activity`不可见，则基本上没有 UI。换句话说，如果用户无法看到或与之交互，它怎么能成为用户界面呢？

正如 Chimp 所暗示的那样，更改应该与某种形式的数据历史记录（数据库或`SharedPreferences`）有关，并且您有责任在下次启动时`HistoryActivity`更新其视觉元素（ ）。`TextViews`

一个`Activity`人不应该尝试修改另一个人的外观、感觉或行为，`Activity`除非通过改变某种形式的全局数据或状态或通过将数据传递给它来间接地改变另一个人的外观、感觉或行为，如果第一个`Activity`负责启动第二个的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:20:29.107

嗯 - 不确定我是否完全理解你的问题。您想在不显示的情况下将拨打的号码附加到“HistoryActivity”吗？

如果是这样，我建议您将数据（已拨号码列表）与视图（HistoryActivity）分开。然后，您只需将拨打的号码添加到用于保存它们的数据记录中（建议使用列表）。当用户打开 HistoryActivity 时，您可以根据需要绘制尽可能多的文本字段来显示数据。

# iphone - 删除 iPhone 上的电子邮件附件

> ID：12556256
> 
> 赞同：1
> 
> 时间：2012-09-23T21:08:44.993
> 
> 标签：iphone, objective-c, ios, xcode

我正在尝试创建一个 iPhone 应用程序，该应用程序将自动从 iPhone 上的电子邮件中删除特定附件，而无需用户干预……这可能吗？在此先感谢，劳森

# ruby - 开发 gem：文件写入访问问题

> ID：12556259
> 
> 赞同：1
> 
> 时间：2012-09-23T21:08:54.473
> 
> 标签：ruby, rubygems

我正在开发一个 gem，它在`tmp/`目录中创建文件。问题是，当用户使用我的 gem 时。当 gem 尝试存储`tmp`文件时，它会发出权限问题。我想知道如何在用户不需要`chown/chmod`tmp 文件夹或运行为的情况下解决这个问题`sudo`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:57:48.910

你可以使用 Ruby Tempfile 类吗？

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:23:24.197

简单的解决方法（适用于 unix 系统） - 使用`/tmp/`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T02:35:49.777

怎么样`ENV['TEMP']`？- 应该是通用的。

# ios5 - 如何从应用程序委托重新加载/刷新视图？

> ID：12556262
> 
> 赞同：0
> 
> 时间：2012-09-23T21:09:23.140
> 
> 标签：ios5, viewcontroller, appdelegate

我正在尝试用谷歌找到一种方法来从应用程序委托重新加载/刷新视图。任何解决方案都不起作用。我的想法是让 vie 重新加载内部`applicationDidBecomeActive:`，但我无法让它工作，我尝试什么都没关系。任何人？

**更新：**

我使用的最后一件事（在 AppDelegate中`applicationDidBecomeActive:`导入）是：`ViewController.h`

```
ViewController *vc = [[ViewController alloc] init];
[vc viewDidLoad] 
```

还有其他一些变化，但我认为你得到了我想要实现的目标。我是新手，所以如果这完全没用，请不要怪我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-11T06:53:38.847

您的意思是要在重新打开应用程序时执行某些操作（例如，向控制器发送刷新消息）？

覆盖的方法`-applicationDidBecomeActive:`在您的应用程序委托中。您需要保留对相关视图控制器的引用。所以：

```
@property MyViewController *myView;

- (void)applicationDidBecomeActive:(UIApplication *)application
{
    [self.myView refreshSettings];
} 
```

如果需要，您可能可以`-viewDidLoad`像在示例代码中那样使用，但我发现将要更新的部分分解出来并从两个地方调用它会更容易。

# vim - 如何防止意外退出vim？

> ID：12556267
> 
> 赞同：20
> 
> 时间：2012-09-23T21:10:05.070
> 
> 标签：vim

有没有办法将 vim 中的 :q 重新绑定到更复杂的命令，以防止意外退出 vim？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-21T09:22:28.313

你想要的是`:close`. 它的作用类似于`:q`但不会让您关闭最后一个窗口：

[http://vimdoc.sourceforge.net/htmldoc/windows.html#:close](http://vimdoc.sourceforge.net/htmldoc/windows.html#:close)

`q`您可以为要映射到的命令设置别名`close`：

```
cabbrev q <c-r>=(getcmdtype()==':' && getcmdpos()==1 ? 'close' : 'q')<CR> 
```

感谢@Paradoxial 这个 :cabrev 技巧。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-08-27T01:29:12.360

我知道，我知道，这是一个非常古老的问题，但我今天有同样的问题，我首先找到了这篇文章。我开发了一个简短的脚本来放入 .vimrc

```
function! ConfirmQuit(writeFile)
    if (a:writeFile)
        if (expand('%:t')=="")
            echo "Can't save a file with no name."
            return
        endif
        :write
    endif

    if (winnr('$')==1 && tabpagenr('$')==1)
        if (confirm("Do you really want to quit?", "&Yes\n&No", 2)==1)
            :quit
        endif
    else
        :quit
    endif
endfu

cnoremap <silent> q<CR>  :call ConfirmQuit(0)<CR>
cnoremap <silent> x<CR>  :call ConfirmQuit(1)<CR> 
```

我希望这可以帮助别人。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-24T07:49:08.120

你有什么好怕的？当您仍然有未保存的更改时， Vim 不会让您退出（`!`无论如何都没有命令修饰符），因此您唯一可能丢失的是 GVIM 的窗口位置、大小和任务栏位置。

无论如何，要覆盖内置命令，例如`:q`，您可以使用[cmdalias 插件](http://www.vim.org/scripts/script.php?script_id=746)，如下所示：

```
:Alias q if\ winnr('$')>1||tabpagenr('$')>1||confirm('Really\ quit?',\ "&OK\\n&Cancel")==1|quit|endif 
```

这将检查最后一个窗口（`:q`不一定退出 Vim），并插入确认。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-22T00:36:00.573

您可以使用这样的东西来删除`:q`命令：

```
:cabbrev q <c-r>=(getcmdtype()==':' && getcmdpos()==1 ? 'echo' : 'q')<CR> 
```

这在命令模式下缩写`q`为`echo`，但如果`q`不在第一列中，则不允许触发缩写。这样，`edit q`就不会缩写为`edit echo`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-19T10:47:42.713

ConfirmQuit.vim : 当你尝试退出 vim 时提供一个确认对话框

[http://www.vim.org/scripts/script.php?script_id=1072](http://www.vim.org/scripts/script.php?script_id=1072)

我通过使用来适应这个

```
autocmd bufenter c:/intranet/notes.txt cnoremap <silent> wq<cr> call ConfirmQuit(1)<cr> 
```

因为我只想要这个用于特定文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-19T17:44:23.993

使用[coot/cmdalias_vim](https://github.com/coot/cmdalias_vim)插件，我有效地禁用了简短的、冲动的退出命令`:q`、`:q!`和`:wq`. 希望这会让我慢下来，让我思考我是否真的想使用`:quit`，或者说，`:bdelete`. `.vimrc`这是我的文件的“autocmd 部分”的精简版本：

```
if has("autocmd")
    augroup VIMRC_aliases
        au!
        au VimEnter * CmdAlias wqu\%[it] write|quit
        au VimEnter * CmdAlias q         echo\ "Use\ :qu[it]\ instead\ of\ :q"
        au VimEnter * CmdAlias q!        echo\ "Use\ :qu[it]!\ instead\ of\ :q!"
        au VimEnter * CmdAlias wq        echo\ "Use\ :wqu[it]\ instead\ of\ :wq"
    augroup END
endif 
```

# python - 使用 mptt 在 Python / Django 中创建 JSON 以反映树结构的最快方法

> ID：12556268
> 
> 赞同：23
> 
> 时间：2012-09-23T21:10:07.353
> 
> 标签：python, django, json, tree, profiling

Python (Django) 中基于 Django 查询集创建 JSON 的最快方法是什么。[请注意，在此处](https://stackoverflow.com/questions/5072301/how-can-create-a-json-tree-from-django-mptt)建议的模板中对其进行解析不是一种选择。

背景是我创建了一个循环遍历树中所有节点的方法，但是在转换大约 300 个节点时已经非常慢了。我想到的第一个（可能也是最糟糕的）想法是以某种方式“手动”创建 json。请参阅下面的代码。

```
#! Solution 1 !!#
def quoteStr(input):
    return "\"" + smart_str(smart_unicode(input)) + "\""

def createJSONTreeDump(user, node, root=False, lastChild=False):
    q = "\""

    #open tag for object
    json = str("\n" + indent + "{" +
                  quoteStr("name") + ": " + quoteStr(node.name) + ",\n" +
                  quoteStr("id") + ": " + quoteStr(node.pk) + ",\n" +
                )

    childrenTag = "children"
    children = node.get_children()
    if children.count() > 0 :
        #create children array opening tag
        json += str(indent + quoteStr(childrenTag) + ": [")
        #for child in children:
        for idx, child in enumerate(children):
            if (idx + 1) == children.count():
                //recursive call
                json += createJSONTreeDump(user, child, False, True, layout)
            else:
                //recursive call
                json += createJSONTreeDump(user, child, False, False, layout)
        #add children closing tag
        json += "]\n"

    #closing tag for object
    if lastChild == False:
        #more children following, add ","
        json += indent + "},\n"
    else:
        #last child, do not add ","
        json += indent + "}\n"
    return json 
```

要渲染的树结构是使用[mptt](https://github.com/django-mptt/django-mptt/)构建的树，其中调用 .get_children() 返回节点的所有子节点。

模型看起来就这么简单，mptt 负责其他一切。

```
class Node(MPTTModel, ExtraManager):
    """
    Representation of a single node
    """ 
    name = models.CharField(max_length=200)
    parent = TreeForeignKey('self', null=True, blank=True, related_name='%(app_label)s_%(class)s_children') 
```

在模板中这样创建的预期 JSON[结果](http://pastebin.com/YrfxJ8kr)`var root = {{ jsonTree|safe }}`

编辑：基于[这个](https://stackoverflow.com/questions/5597136/serializing-a-tree-in-django)答案，我创建了以下代码（绝对是更好的代码），但感觉只是稍微快一点。

解决方案2：

```
def serializable_object(node):
    "Recurse into tree to build a serializable object"
    obj = {'name': node.name, 'id': node.pk, 'children': []}
    for child in node.get_children():
        obj['children'].append(serializable_object(child))
    return obj

import json
jsonTree = json.dumps(serializable_object(nodeInstance)) 
```

解决方案3：

```
def serializable_object_List_Comprehension(node):
    "Recurse into tree to build a serializable object"
    obj = {
        'name': node.name,
        'id': node.pk,
        'children': [serializable_object(ch) for ch in node.get_children()]
    }
    return obj 
```

解决方案4：

```
def recursive_node_to_dict(node):
    result = {
        'name': node.name, 'id': node.pk
    }
    children = [recursive_node_to_dict(c) for c in node.get_children()],
    if children is not None:
        result['children'] = children
    return result

from mptt.templatetags.mptt_tags import cache_tree_children
root_nodes = cache_tree_children(root.get_descendants())
dicts = []
for n in root_nodes:
    dicts.append(recursive_node_to_dict(root_nodes[0]))
    jsonTree = json.dumps(dicts, indent=4) 
```

解决方案5（使用select_related到pre_fetch，但不确定是否正确使用）

```
def serializable_object_select_related(node):
    "Recurse into tree to build a serializable object, make use of select_related"
    obj = {'name': node.get_wbs_code(), 'wbsCode': node.get_wbs_code(), 'id': node.pk, 'level': node.level, 'position': node.position, 'children': []}
    for child in node.get_children().select_related():
        obj['children'].append(serializable_object(child))
    return obj 
```

解决方案 6（改进的解决方案 4，使用子节点的缓存）：

```
def recursive_node_to_dict(node):
    return {
        'name': node.name, 'id': node.pk,
         # Notice the use of node._cached_children instead of node.get_children()
        'children' : [recursive_node_to_dict(c) for c in node._cached_children]
    } 
```

通过以下方式调用：

```
from mptt.templatetags.mptt_tags import cache_tree_children
subTrees = cache_tree_children(root.get_descendants(include_self=True))
subTreeDicts = []
for subTree in subTrees:
    subTree = recursive_node_to_dict(subTree)
    subTreeDicts.append(subTree)
jsonTree = json.dumps(subTreeDicts, indent=4)
#optional clean up, remove the [ ] at the beginning and the end, its needed for D3.js
jsonTree = jsonTree[1:len(jsonTree)]
jsonTree = jsonTree[:len(jsonTree)-1] 
```

您可以在下面看到分析结果，按照 MuMind 的建议使用 cProfile 创建，设置 Django 视图以启动独立方法 profileJSON()，该方法又调用不同的解决方案来创建 JSON 输出。

```
def startProfileJSON(request):
    print "startProfileJSON"
    import cProfile
    cProfile.runctx('profileJSON()', globals=globals(), locals=locals())
    print "endProfileJSON" 
```

结果：

**方案一：** 4.969秒内3350347次函数调用（3130372次原语调用）（[详情](http://pastebin.com/yKBre5ZC)）

**解决方案 2：** 3.630 秒内 2533705 次函数调用（2354516 次原始调用）（[详情](http://pastebin.com/zbcePF74)）

**方案3：** 3.684秒内2533621次函数调用（2354441次原语调用）（[详情](http://pastebin.com/JejGke2z)）

**解决方案 4：** 3.840 秒内 2812725 次函数调用（2466028 次原语调用）（[详情](http://pastebin.com/ANu24hSf)）

**解决方案 5：** 3.779 秒内 2536504 次函数调用（2357256 次原语调用）（[详情](http://pastebin.com/6gr9k1F7)）

**解决方案 6（改进的解决方案 4）：** 2593122 个函数调用（2299165 个原始调用）在 3.663 秒内（[详情](http://pastebin.com/NTu8z0Jm)）

**讨论：**

解决方案1：自己的编码实现。馊主意

解决方案 2 + 3：目前**最快**，但仍然非常缓慢

解决方案 4：缓存孩子看起来很有希望，但确实执行相似并且当前产生无效的 json，因为孩子被放入双 []：

```
"children": [[]] instead of "children": [] 
```

解决方案 5：使用 select_related 并没有什么不同，但可能以错误的方式使用，因为一个节点总是有一个 ForeignKey 到它的父节点，我们正在从根解析到子节点。

更新：解决方案 6：对我来说，它看起来是最干净的解决方案，使用子节点缓存。但只执行类似于解决方案 2 + 3。这对我来说很奇怪。

还有更多关于性能改进的想法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-23T22:11:09.153

我怀疑到目前为止最大的放缓是每个节点将执行 1 个数据库查询。与数据库的数百次往返相比，json 渲染是微不足道的。

您应该在每个节点上缓存子节点，以便可以一次完成所有查询。django-mptt 有一个[cache_tree_children()](https://github.com/django-mptt/django-mptt/blob/master/mptt/templatetags/mptt_tags.py#L225)函数，你可以使用它。

```
import json
from mptt.templatetags.mptt_tags import cache_tree_children

def recursive_node_to_dict(node):
    result = {
        'id': node.pk,
        'name': node.name,
    }
    children = [recursive_node_to_dict(c) for c in node.get_children()]
    if children:
        result['children'] = children
    return result

root_nodes = cache_tree_children(Node.objects.all())
dicts = []
for n in root_nodes:
    dicts.append(recursive_node_to_dict(n))

print json.dumps(dicts, indent=4) 
```

自定义 json 编码虽然在某些情况下可能会提供轻微的加速，但我非常不鼓励这样做，因为它会包含很多代码，而且很容易[出错](http://trac.osgeo.org/postgis/ticket/1996)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-23T22:09:14.380

您的更新版本看起来开销很小。我认为使用列表推导会稍微更有效（并且更具可读性！）：

```
def serializable_object(node):
    "Recurse into tree to build a serializable object"
    obj = {
        'name': node.name,
        'children': [serializable_object(ch) for ch in node.get_children()]
    }
    return obj 
```

除此之外，您所能做的就是对其进行分析以找到瓶颈。编写一些独立的代码来加载和序列化你的 300 个节点，然后运行它

```
python -m profile serialize_benchmark.py 
```

（或者`-m cProfile`如果效果更好）。

可以看到 3 个不同的潜在瓶颈：

*   数据库访问（`.get_children()`和`.name`）——我不确定幕后到底发生了什么，但我有这样的代码，它为每个节点执行数据库查询，增加了巨大的开销。如果那是您的问题，您可以将其配置为使用[select_related](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-related)或类似的东西进行“急切加载”。
*   函数调用开销（例如`serializable_object`本身）——只要确保 ncalls for`serializable_object`看起来是一个合理的数字。如果我理解你的描述，它应该在 300 附近。
*   最后序列化 ( `json.dumps(nodeInstance)`) -- 这可能不是罪魁祸首，因为您说它只有 300 个节点，但如果您确实看到这占用了大量执行时间，请确保您的 JSON 编译加速正常工作。

如果您无法从分析中得知太多信息，请制作一个精简版本，例如，递归调用`node.name`但`node.get_children()`不将结果存储在数据结构中，然后看看它的比较。

* * *

更新：解决方案 3 中有 2192 次调用`execute_sql`，解决方案 5 中有 2192 次调用，所以我认为过多的数据库查询是一个问题，并且与`select_related`上面使用的方式没有任何作用。查看[django-mptt 问题 #88: Allow select_related in model methods](https://github.com/django-mptt/django-mptt/issues/88)表明您或多或少地使用它是正确的，但我有疑问，并且`get_children`vs.`get_descendants`可能会产生巨大的差异。

还占用了大量时间`copy.deepcopy`，这令人费解，因为您没有直接调用它，而且我看不到它是从 MPTT 代码中调用的。什么是tree.py？

如果您在分析方面做了大量工作，我强烈推荐使用非常灵巧的工具[RunSnakeRun](http://www.vrplumber.com/programming/runsnakerun/)，它可以让您以非常方便的网格形式查看您的配置文件数据并更快地理解数据。

无论如何，这是简化数据库方面的又一次尝试：

```
import weakref
obj_cache = weakref.WeakValueDictionary()

def serializable_object(node):
    root_obj = {'name': node.get_wbs_code(), 'wbsCode': node.get_wbs_code(),
            'id': node.pk, 'level': node.level, 'position': node.position,
            'children': []}
    obj_cache[node.pk] = root_obj
    # don't know if the following .select_related() does anything...
    for descendant in node.get_descendants().select_related():
        # get_descendants supposedly traverses in "tree order", which I think
        # means the parent obj will always be created already
        parent_obj = obj_cache[descendant.parent.pk]    # hope parent is cached
        descendant_obj = {'name': descendant.get_wbs_code(),
            'wbsCode': descendant.get_wbs_code(), 'id': descendant.pk,
            'level': descendant.level, 'position': descendant.position,
            'children': []}
        parent_obj['children'].append(descendant_obj)
        obj_cache[descendant.pk] = descendant_obj
    return root_obj 
```

请注意，这不再是递归的。它通过节点迭代地进行，理论上在他们的父母被访问之后，并且它都使用一个大的调用`MPTTModel.get_descendants()`，所以希望这是很好的优化和缓存`.parent`等（或者也许有一种更直接的方法来获取父键？） . 它最初创建每个没有子对象的 obj，然后将所有值“嫁接”给它们的父对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:55:19.333

将数据组织到嵌套字典或列表中，然后调用[json](http://docs.python.org/library/json.html)转储方法：

```
import json   
data = ['foo', {'bar': ('baz', None, 1.0, 2)}]
json.dump(data) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-09T21:42:53.270

在玩了一会儿之后，我发现解决方案都太慢了，因为 mptt 本身正在多次扫描缓存到`get_children`.

利用 mptt 以正确的顺序返回行以轻松构建树的事实，我做了这个：

```
def flat_tree_to_dict(nodes, max_depth):
    tree = []
    last_levels = [None] * max_depth
    for n in nodes:
        d = {'name': n.name}
        if n.level == 0:
            tree.append(d)
        else:
            parent_dict = last_levels[n.level - 1]
            if 'children' not in parent_dict:
                parent_dict['children'] = []
            parent_dict['children'].append(d)
        last_levels[n.level] = d
    return tree 
```

对于我的数据集，它的运行速度比其他解决方案快 10 倍，因为它是 O(n)，只迭代数据一次。

我这样使用它：

```
json.dumps(flat_tree_to_dict(Model.objects.all(), 4), indent=4) 
```

# c# - 存储组合框的文本条目

> ID：12556275
> 
> 赞同：0
> 
> 时间：2012-09-23T21:10:38.217
> 
> 标签：c#, wpf, xaml, wpf-controls

我有一个文本框，它将保留最后输入的 10 个条目，类似于 Internet Explorer 中的搜索框。用户可以单击下拉菜单查看最后 10 个条目。下拉菜单是一个组合框。我创建了一个绑定到组合框 Itemssource 的 Observable 字符串集合。下面是代码。

**Xaml**

```
<Grid x:Name="TextBox_grid" Margin="0,0,40,0" Width="360" Height="23">
    <ComboBox Name="cb" Margin="0,0,-29,0" Style="{DynamicResource Onyx_Combo}" ItemsSource="{Binding TextEntries, ElementName=TheMainWindow, Mode=OneWay}"  IsEditable="False" Visibility="Visible" />
    <Rectangle Fill="#FF131210" Stroke="Black" RadiusX="2" RadiusY="2"/>
    <TextBox Name=UniversalTextBox Margin="0" Background="{x:Null}" BorderBrush="{x:Null}" FontSize="16" Foreground="#FFA0A0A0" TextWrapping="Wrap" PreviewKeyDown="TextBox_PreviewKeyDown"/>
</Grid> 
```

**代码**

```
public partial class Window1 : Window
{

    private ObservableCollection<string> m_TextEntries = new ObservableCollection<string>();

    public Window1()
    {
        InitializeComponent();
    }
    public ObservableCollection<string> TextEntries
    {
        get { return m_TextEntries; }
    }
    private void TextBox_PreviewKeyDown(object sender, KeyEventArgs e)
    {
        TextBox textBox = sender as TextBox;
        if (textBox == null)
            return;

        if (e.Key == Key.Enter)
        {
            PopulateHistoryList(textBox.Text);
            e.Handled = true;
        }
        if (e.Key == Key.Escape)
        {
            e.Handled = true;
        }
    }

    private void PopulateHistoryList(string text)
    {
        m_TextEntries.Add(text);
    }

    private event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(info));
    } 
```

当在文本框上按下 Enter 键时，上面的代码将填充 TextEntries 集合。我需要两件事

1.  如何设置组合框的 Selected Item 以及如何将其绑定到我的文本框。
2.  组合框（下拉菜单）应该只显示下拉菜单中的最后 10 个条目。

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:26:07.603

使用 Expesssion Blend，将一个控件的属性值绑定到另一个控件的属性值很容易，它被称为 ElementProperty 绑定，这里是您访问在 Blend 中创建它的能力的屏幕截图，请注意文本框是“对象和时间轴”面板中的选定元素，它是属性面板中文本属性右侧的“小框”，已被单击以生成如图所示的上下文菜单... ![在此处输入图像描述](../Images/c3267d4f860c7e23aa5eee272def8fcf.png)

一旦您为文本框的文本属性选择了“元素属性绑定”，您的光标将变成一个小靶心图标，您现在可以通过在设计画布或对象和时间轴面板，而光标以这种方式显示... ![在此处输入图像描述](../Images/0aa6776b3ec40b8a0ccbdddbe833f7ef.png) 在这里，我们看到组合框的“SelectedValue”属性被选为文本框中显示内容的来源。完成后，文本框将自动立即设置为显示组合中选择的任何内容。当你这样做时，一定要看看 Blend 在你的 XAML 中做了什么，因为它会帮助你更好地理解实际发生的事情，甚至可能会教你一两件事关于 XAML 的绑定语法。

至于只有最后十个条目的列表......有几种方法可以做到这一点，每一种都或多或少合适，具体取决于周围的环境，但这是一种方法；只需运行与此类似的过程，只要该框添加了条目即可：

```
// assuming 'listItems' is your ObservableCollection
string[] items = listItems.ToArray();

// prepare a new array for the current ten
string[] tenItems = new string[10];

// copy a subset of length ten, to the temp array, the set your ObservableCollection to this array.
Array.Copy(items, (items.Length - 10), tenItems, 0, 10); 
```

注意：数组 .Copy 假定将项目添加到可观察集合的唯一方法是通过某种形式的 .Add，它总是将它们添加到列表的末尾......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:50:18.377

部分答案

```
<TextBlock Text="{Binding ElementName=cb, Path=SelectedValue}" />

<ComboBox x:Name="cb" ItemsSource="{Binding Path=Fields}" SelectedValue="{Binding Path=SelectedValue}"  /> 
```

如果你设置窗口的数据上下文

```
DataContext="{Binding RelativeSource={RelativeSource self}}"> 
```

# c - 在 C 中的数组中存储和打印随机数

> ID：12556276
> 
> 赞同：0
> 
> 时间：2012-09-23T21:10:41.240
> 
> 标签：c, arrays, pointers, random

我需要使用指针将 500 到 600 之间的随机数存储到数组中，然后打印出这些数字。我得到一个分段错误......核心转储，我真的不明白这意味着什么。错误发生在 printf 语句之后 ("%15d\n", aPtr[i]);

```
int main(){
    int size;
    int j, i;
    int temp;
    int sum = 0;

    printf("Enter size of array");
    scanf("%d", &size);

    int array[size];
    int *aPtr = malloc(sizeof(int) * size);

    for (i = 0; i <= size; i++){
         srand(time(NULL));
         aPtr[i] = rand() % 500 + 100;
         printf("%15d\n", aPtr[i]); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:12:23.750

`i <= size;`应该`i < size;`

如果您有一个包含 50 个项目的数组，则有效索引为 [0,49]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:21:19.253

您需要在进入循环`srand` *之前调用。*

就目前而言，您将获得一长串相同数字，因为您每次都将随机数生成器重置为相同的种子（假设时间没有改变，这很可能）。此外，如果您想要介于 500 和 600 之间的数字，那么您的公式是错误的。试试这个片段：

```
srand(time(NULL));
for (i = 0; i < size; i++){
    aPtr[i] = (rand() % 101) + 500;
    printf("%d\n", aPtr[i]);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:21:37.413

您只需调用 srand （初始化随机数生成器）一次。把它移出for。如果你想要 500 到 600 之间的随机数，你需要在 0 到 100 之间生成它们（ rand() % 101），然后加上 500。

# c# - 如何在同一行中获取用户输入？

> ID：12556279
> 
> 赞同：8
> 
> 时间：2012-09-23T21:11:25.650
> 
> 标签：c#, user-input

我在 C# 编程中比较大所以，我只是想知道如何在同一行中获取用户输入？这是我的代码，我也想在同一行打印输出

```
using System;

namespace Wa2
{
  class BodyMassCalculation
  {
    public static void Main (string[] args)
    {
       Console.WriteLine ("BMI Calculator\n");

       double weight;
       Console.WriteLine ("Enter your weight in kilograms: ");
       weight = Convert.ToInt16(Console.ReadLine());

       double height;
       Console.WriteLine ("Enter your height in centimetres: ");
       height = Convert.ToInt16(Console.ReadLine());

       double meter;
       meter = height / 100;

       Double BMI;
       BMI = (weight) / (meter*meter);
       Console.WriteLine ("Your BMI is " , BMI);
       Console.WriteLine(BMI.ToString("00.00"));
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-23T21:13:44.377

试试这个：

```
Console.Write("Enter your input here: ");
string userinput = Console.ReadLine(); 
```

只需更改`Console.WriteLine`为`Console.Write`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:14:51.507

使用`Console.Write()`而不是`Console.WriteLine()`.

我想这就是你的意思，这个问题不是很清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:17:30.817

我想您是在问是否可以同时读取身高和体重：

```
// C equivalent
printf ("Enter height (cm) and weight (kg): ");
scanf ("%d %d\n", &h, &w); 
```

是的，有几种选择。

可以说最简单的是使用 Console.ReadLine() （就像你正在做的那样）并解析字符串。

您还可以尝试多个“Console.Read()”（每个参数一个）。

# php - 如何在忽略大小写的情况下计算字符串中单词的出现次数

> ID：12556281
> 
> 赞同：0
> 
> 时间：2012-09-23T21:12:02.957
> 
> 标签：php

我试图在忽略大小写的情况下计算给定单词的出现次数。我试过了

```
<?php 
 $string = 'Hello World! EARTh in earth and EARth';//string to look into.
  if(stristr($string, 'eartH')) {
    echo 'Found';// this just show eartH was found.
  }
  $timesfound = substr_count($string, stristr($string, 'eartH'));// this count how many times. 

  echo $timesfound; // this outputs 1 instead of 3. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:15:10.750

搜索前将字符串小写：

```
$string = 'Hello World! EARTh in earth and EARth';
$search = 'EArtH';
var_dump(substr_count(strtolower($string), strtolower($search))); // outputs 3 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-23T21:17:30.897

尝试 substr_count()

```
 <?php
     $text = 'This is a test';
     echo strlen($text); // 14

    echo substr_count($text, 'is'); // 2

    ?> 
```

# objective-c - 从 sqlite 数据库 Objective-C 播放音频文件

> ID：12556283
> 
> 赞同：2
> 
> 时间：2012-09-23T21:12:13.370
> 
> 标签：objective-c, ios, xcode, audio

我在 sqlite 数据库中存储了大约 40 000 个音频文件，每个 5K-7K。我将 blob 作为 NSData 对象获取。播放音频文件的最佳方式是什么？我一直在使用 ObjectAL 从磁盘播放音频文件，但我无法让它从内存中播放文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:49:56.927

你可以使用[`AVAudioPlayer`](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)类。
它有一个`initWithData:`方法：

```
- ( id )initWithData: ( NSData * )data error: ( NSError ** )outError; 
```

由于您已经拥有`NSData`对象，因此应该非常简单。

或者，您也可以使用数据[创建一个临时文件](https://stackoverflow.com/questions/215820/how-do-i-create-a-temporary-file-with-cocoa)。

# mysql - PHPMYADMIN 中的 MySQL 存储过程——没有任何反应

> ID：12556285
> 
> 赞同：0
> 
> 时间：2012-09-23T21:12:19.130
> 
> 标签：mysql, stored-procedures

我创建了这个测试程序：

```
DELIMITER //  
CREATE PROCEDURE `str` (IN var1 INT)  
BEGIN
    WHILE var1 < 5 DO
        SELECT var1;
        SET var1 = var1 + 1;
    END WHILE;
END //
DELIMITER ; 
```

当我通过 phpmyadmin 运行它时，没有任何反应。没有错误，没有确认信息。如果 I `CALL str(1)`，我会收到一条消息，指出该过程不存在。这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:17:20.410

如果你想获得`var1`你需要循环`SELECT`外部的迭代值。`WHILE`以下在我的 MySQL 安装中运行良好：

```
DROP PROCEDURE IF EXISTS `str`;
DELIMITER //  
CREATE PROCEDURE `str` (IN var1 INT)  
BEGIN
    WHILE var1 < 5 DO
        SET var1 = var1 + 1;
    END WHILE;
    SELECT var1;
END //
DELIMITER ; 
```

执行`CALL str(1)`退货`5`

# android - 卸载安卓应用

> ID：12556300
> 
> 赞同：4
> 
> 时间：2012-09-23T21:14:18.523
> 
> 标签：android, uninstallation

当我在 Eclipse 中创建一个 Android 项目并将其发送到我的设备进行调试时，该应用程序运行良好，但当我尝试卸载它时，我收到一条奇怪的消息。以下是重现我的问题的步骤：

Eclipse 版本：4.2.0 构建 ID：I20120608-1400

ADT 版本：2.0.3 v201208082019-427395

1.  运行 Eclipse
2.  单击文件->新建->项目...
3.  选择 Android/Android 应用项目
4.  点击下一步。
5.  输入应用程序名称：测试
6.  构建 SDK：Android 4.1
7.  最低要求 SDK：API 8 Android 2.2
8.  启用：创建自定义启动器图标/在工作区中创建项目
9.  单击下一步三次。
10.  单击完成。
11.  通过 USB 将 4.1 Android 设备连接到计算机。
12.  单击“运行”->“从菜单运行”。
13.  在弹出的“运行方式”弹出窗口中选择“Android 应用程序”。
14.  单击确定。
15.  MainActivity 应用程序在设备上运行。
16.  单击 Android 设备上的返回按钮。
17.  在设备上打开应用程序并找到“MainActivity”应用程序。
18.  **长按 MainActivity 图标**并拖动到垃圾箱。

这是令人费解的部分：

而不是得到一个标准

> 您要卸载此应用程序吗？

我得到一个包含此文本的对话框：

> MainActivity 是以下应用程序的一部分：测试您要卸载此应用程序吗？

1.  为什么我收到此消息而不是标准消息？
2.  为什么在我特别说明应用程序名称为“Test”时，MainActivity 是应用程序的名称？

附加信息：如果我转到设置-> 应用程序，应用程序显示为测试，但在我的启动器中列为 MainActivity。

AndroidManifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.test"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-29T23:41:50.737

解决方案是删除活动元素中的 android:label="@string/title_activity_main" 。

下面的 AndroidManifest.xml 解决了 Android 4.1.1 上的问题。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.test"
    android:versionCode="1"
    android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <activity
        android:name=".MainActivity" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-28T13:18:29.740

确保您的应用名称`app_name`没有样式。

由于我在应用程序的其他地方使用了应用程序名称，因此我将其设为粗体，如下所示 - 在我的 strings.xml

```
<string name="app_name"><b>We are sons<b></string> 
```

当我删除

```
<b></b> 
```

标签，它起作用了。

保留它：

```
<string name="app_name">We are sons</string> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:34:44.820

我不知道如何解决第一个问题，但可以通过以下方式解决第二个问题。该问题与Android新项目向导有关。要解决此问题，您可以通过以下方式更正清单文件并重新部署您的项目：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.test"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
android:minSdkVersion="8"
android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter android:label="@string/app_name" >
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

不要忘记检查 的值是多少`app_name`。您可以在[这篇文章中找到更多详细信息](http://zyrikby.blogspot.it/2012/09/android-labeling-issue.html)

# php - 从另一个 PHP 变量中获取百分比

> ID：12556302
> 
> 赞同：2
> 
> 时间：2012-09-23T21:14:23.603
> 
> 标签：php

我试图从另一个获取 php 变量的百分比，例如我有两个信息数据库，第一个数据库充满了身份不明的信息。第二个数据库充满了我们识别的信息。所以我想动态计算出所识别的总信息的百分比。

下面是一个计算百分比的php函数，

```
//TOTAL ENTRIES INTO Table 1 FOR total data
$result   = mysql_query( "SELECT * FROM table1" );
$num_total = mysql_num_rows( $result );

 //TOTAL ENTRIES IN Table 2  FOR THE PERCENTAGE
$result   = mysql_query( "SELECT * FROM table2" );
$num_amount = mysql_num_rows( $result );

 function percent($num_amount, $num_total) {
 $count1 = $num_amount / $num_total;
 $count2 = $count1 * 100;
 $count3 = 100 - $count2;
 $count = number_format($count3, 0);
 echo $count;
 } 
```

两个查询都返回数据库中计算的总行数的正确信息，但是 count 变量不返回任何信息。

任何想法或建议将不胜感激。

谢谢

斯坦

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T21:18:34.783

您回显结果，但您不会从函数中返回它。这大概就是问题所在。

但是，您可以全部在 SQL 中进行百分比计算：

```
SELECT 100*( SELECT COUNT(*) FROM table1 ) / ( SELECT COUNT(*) FROM table2 )
    AS percent; 
```

除此以外，

```
function percent($num, $total)
{
    return number_format((100.0*$num)/$total, 2);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:20:55.857

我的猜测是这样的事情可能会起作用（请注意，我还没有测试过这个，所以它可能需要调整）：

```
<?php

//TOTAL ENTRIES INTO Table 1 FOR total data
$result   = mysql_query("SELECT COUNT(*) AS total FROM table1");
$table1_total = mysql_result($result, 0);

 //TOTAL ENTRIES IN Table 2  FOR THE PERCENTAGE
$result2 = mysql_query("SELECT COUNT(*) AS total FROM table2");
$table2_total = mysql_result($result2, 0);

function percent($num_amount, $num_total) {
    $count1 = $num_amount / $num_total;
    $count2 = $count1 * 100;
    $count3 = 100 - $count2;
    $count = number_format($count3, 0);
    echo $count;
}

percent($table1_total, $table2_total); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:23:48.527

试试这个：

```
 <?php

    function percent($num_amount, $num_total) {
     $count1 = $num_amount / $num_total;
     $count2 = $count1 * 100;
     $count = number_format($count2, 0);
     echo $count2."<br>";
     }

     percent(50,100);
     percent(13,100);
     percent(13,200);

    ?> 
```

# javascript - 为什么 Google Docs 的回调 URL 无法与 Tumblr API 一起使用？

> ID：12556305
> 
> 赞同：2
> 
> 时间：2012-09-23T21:14:26.263
> 
> 标签：javascript, oauth, google-apps-script, tumblr, google-sheets

我编写了以下 Google Apps 脚本函数来授权 Google 电子表格查询 Tumblr API v2（它使用 Oauth 1.0a）。

我已经尝试了回调 URL 的一些变体——我已经成功地将[https://spreadsheets.google.com/macros/](https://spreadsheets.google.com/macros/)与 Twitter API 一起使用——但是在“授权”页面上单击“授权”后，回调 URL 会重定向到**www。 google.com/script/start/**并且不进行身份验证。

这是我一直在尝试的脚本 - 关于为什么这可能不起作用的任何想法？

```
function authorise() {
  var oauthConfig = UrlFetchApp.addOAuthService("tumblr");
  oauthConfig.setAccessTokenUrl("http://www.tumblr.com/oauth/access_token");
  oauthConfig.setRequestTokenUrl("http://www.tumblr.com/oauth/request_token");
  oauthConfig.setAuthorizationUrl("http://www.tumblr.com/oauth/authorize");
  oauthConfig.setConsumerKey(tumblrKey);
  oauthConfig.setConsumerSecret(tumblrSecret);
  var requestData = {
    "method": "GET",
    "oAuthServiceName": "tumblr",
    "oAuthUseToken": "always"
  }
  var result = UrlFetchApp.fetch(
      "http://api.tumblr.com/v2/blog/frankocean.com/info",
      requestData);
    Logger.log(result.getContentText());
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-15T00:28:42.157

我对 OAuth 1.0a 也有同样的问题。

为了解决这个问题，我在 Firefox 中使用了 RestClient 插件来追踪原因。

问题原来是 requestData，OAuth 工作正常，但由于 requestData 错误，提取被拒绝。

[编辑]推特：

```
var requestData = {
  "method": "POST",
  "oAuthServiceName": "twitter",
  "oAuthUseToken": "always"
}; 
```

对于 QuickBooks：

```
var requestData = {
"method": "GET",
"oAuthServiceName": "QuickBooks",
"oAuthUseToken": "always" 
```

};

# authentication - Symfony 2.1 错误凭据仅在编码密码时

> ID：12556306
> 
> 赞同：3
> 
> 时间：2012-09-23T21:14:37.493
> 
> 标签：authentication, encoding, symfony, password-protection

这是我添加管理员用户的代码：

```
public function addAction(Request $request){
    $admin=new Admin();
    $form=$this->createForm(new AdminType(), $admin);
    if($request->getMethod()=='POST'){
        $form->bindRequest($request);
        if($form->isValid()){
            $factory = $this->get('security.encoder_factory');
            $encoder = $factory->getEncoder($admin);
            $password = $encoder->encodePassword($admin->getPassword(), $admin->getSalt());
            $admin->setPassword($password);

            $em=$this->getDoctrine()->getEntityManager();
            $em->persist($admin);
            $em->flush();
        }
    }
    return $this->render('PuzzleAdminBundle:Admin:add.html.twig', array(
        'form'=>$form->createView()
    ));
} 
```

这是我的security.yml：

```
security:
encoders:
    Puzzle\AdminBundle\Entity\Admin: sha512
    Symfony\Component\Security\Core\User\User: plaintext

role_hierarchy:
    ROLE_ADMIN:       ROLE_USER
    ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

providers:
    chain_providers:
        chain:
            providers: [admin_db, in_memory]
    admin_db:
        entity: { class: Puzzle\AdminBundle\Entity\Admin, property: username }
    in_memory:
        memory:
            users:
                root: { password: 123456, roles: [ 'ROLE_SUPER_ADMIN' ] } 
```

当我想以 root 登录或将实体编码器设置为纯文本时，一切正常。为什么在将实体编码器设置为 sha512 时总是得到错误的凭据？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T11:17:22.857

检查数据库中的字段长度。如果您关注的是“The Book”，那么您的字段可能会设置为`varchar(50)`. Base64 编码的 SHA-512 将输出 88 个字符的字符串。对此进行调整，您应该一切顺利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T02:32:46.973

我指出了问题，在我的情况下，这是一件非常愚蠢的事情，数据库中字段的长度太小

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T18:40:18.927

我相信定义的“密码”值需要是编码后的值。因此，当设置为使用 sha512 编码器时，它将寻找的值将是 '123456' 的 sha512 哈希值，而不是纯文本密码。

看看这里： [http](http://symfony.com/doc/current/book/security.html#encoding-the-user-s-password) ://symfony.com/doc/current/book/security.html#encoding-the-user-s-password 。本节第一个示例之后的段落专门处理这个问题。

# python - 芹菜任务分组/聚合

> ID：12556309
> 
> 赞同：13
> 
> 时间：2012-09-23T21:14:49.523
> 
> 标签：python, asynchronous, task, celery, aggregation

我打算使用 Celery 来处理由我的主服务器的事件触发的发送推送通知和电子邮件。

这些任务需要打开与外部服务器（GCM、APS、电子邮件服务器等）的连接。它们可以一次处理一个，也可以通过单个连接批量处理以获得更好的性能。

通常会在短时间内分别触发多个这些任务的实例。例如，在一分钟内，可能有几十个推送通知需要向不同的用户发送不同的消息。

*在 Celery 中处理这个问题的最佳方法是什么？*似乎天真的方法是对每条消息简单地执行不同的任务，但这需要为每个实例打开一个连接。

我希望会有某种任务聚合器允许我处理例如“所有未完成的推送通知任务”。

这样的事情存在吗？有没有更好的方法来解决它，例如附加到活动任务组？

我错过了什么吗？

罗伯特

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-11T09:49:38.037

我最近在我的项目中发现并实现了该`celery.contrib.batches`模块。在我看来，这是一个比 Tommaso 的答案更好的解决方案，因为您不需要额外的存储层。

[这是直接来自文档](http://docs.celeryproject.org/en/latest/reference/celery.contrib.batches.html)的示例：

> 每 100 条消息或每 10 秒刷新一次缓冲区的点击计数器。不对数据做任何事情，但可以轻松修改以将其存储在数据库中。

```
# Flush after 100 messages, or 10 seconds.
@app.task(base=Batches, flush_every=100, flush_interval=10)
def count_click(requests):
    from collections import Counter
    count = Counter(request.kwargs['url'] for request in requests)
    for url, count in count.items():
        print('>>> Clicks: {0} -> {1}'.format(url, count)) 
```

不过要小心，它适合我的使用，但它在文档中提到这是一个“实验任务类”。这可能会阻止某些人使用具有这种易变描述的功能:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T09:45:43.913

实现此目的的一种简单方法是在持久存储（例如数据库）上编写任务应执行的所有操作，并让定期作业在一批中执行实际过程（使用单个连接）。注意：确保您有一些锁定以防止队列被处理两次！

有一个很好的例子说明如何在kombu级别做类似的事情（http://ask.github.com/celery/tutorials/clickcounter.html）

就我个人而言，我喜欢哨兵在数据库级别（sentry.buffers 模块）做这样的事情来批量增量的方式

# api - Freebase MQL 语法

> ID：12556315
> 
> 赞同：1
> 
> 时间：2012-09-23T21:15:39.687
> 
> 标签：api, freebase

我正在使用查询编辑器制定一个查询，该查询返回具有以下属性的人员列表：姓名、出生地和性别；提供出生日期时。我已经做到了这一点：

```
[{
  "/type/object/type": "/people/person",
  "/people/person/date_of_birth": "1981-04-19",
  "/type/object/name": null,
  "/people/person/gender": null
}] 
```

我希望看到 DOB 和对象类型具有性别、姓名和出生地的结果集。提供这些结果的 MQL 语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T23:06:10.483

看起来除了出生地你什么都有

```
[{
  "type": "/people/person",
  "date_of_birth": "1981-04-19",
  "name": null,
  "gender": null,
  "place_of_birth" : {"id":null,
                      "name":null}
}]​ 
```

但是，如果您想要对人类有用的东西，则需要做更多的工作来获取包含位置并对其进行排序以找到人们认为有用的位置（例如状态）

```
[{
  "type": "/people/person",
  "date_of_birth": "1981-04-19",
  "name": null,
  "gender": null,
  "place_of_birth" : {"id":null,
                      "name":null,
                      "containedby" : [{"id":null,"name":null}]
}]​ 
```

整理位置层次结构留给读者作为练习。

# r - 重用 R 预测包中的模型

> ID：12556317
> 
> 赞同：1
> 
> 时间：2012-09-23T20:37:29.440
> 
> 标签：r, time-series, package

有人告诉我，在使用 R 的预测包时，可以重用模型。也就是说，在代码之后，无需重新计算模型`x <- c(1,2,3,4); mod <- ets(x); f <- forecast(mod,h=1)`即可拥有`append(x, 5)`并预测下一个值。如何做到这一点？（据我所知，使用简单的指数平滑只需要知道 alpha，对吗？）

是这样`forecast(x, model=mod)`吗？如果是这种情况，我不得不说我正在使用 Java 并以编程方式调用预测代码（对于许多时间序列），所以我认为我不能一直将模型对象保留在 R 环境中。是否有一种简单的方法可以将模型对象保存在 Java 中并在需要时将其加载到 R 环境中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:31:08.890

您在这里有两个问题：

A)`forecast`包可以“增长”它的数据集吗？我无法详细说明这个包，您必须查看它的文档。*但是*，R 模型通常遵循以下结构

> ```
> fit <- someModel(formula, data)
> estfit <- predict(fit, newdata=someDataFrame) 
> ```

例如，您提供给定适合对象的更新数据。

B) 我可以将模型来回序列化到 Java 吗？是的你可以。[Rserve](http://cran.r-project.org/package=Rserve)是一个对象，您也可以尝试基本`serialize()`到（原始）字符。甚至只是`save(fit, file="someFile.RData")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T00:38:32.273

关于你的第一个问题：

```
x <- 1:4
mod <- ets(x)
f1 <- forecast(mod, h=1)
x <- append(x, 5)
mod <- ets(x, model=mod) # Reuses old mod without re-estimating parameters.
f2 <- forecast(mod, h=1) 
```

# sql - 如何摆脱选择语句的结果集中的零？

> ID：12556318
> 
> 赞同：1
> 
> 时间：2012-09-23T21:15:44.683
> 
> 标签：sql, sql-server, tsql, select

我有一个连接语句，它正在查找成本与收费的比率。查询是正确的，但返回小数点后的 5 个零。我尝试了圆形功能，但它不起作用。

查询：

```
Select Book, Year, (Round(Sum(Cost/Fee),2) As 'Ratio'
From Book B
Inner Join Fees F
On B.Fee_Code = F.Fee_Code
Group By Book, Year; 
```

它返回 15.250000000 的比率

*   15.25是正确的，我只是想敲掉零

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:17:41.617

您需要将结果转换为只有 2 位的小数

例如

```
CAST(Sum(Cost/Fee) AS DECIMAL(10,2)) As 'Ratio' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-23T21:22:57.187

我可以在 Round 函数之前看到一个括号，但无论如何试试这个：
`CAST(Sum(Cost/Fee) AS DECIMAL(10,2))`

# java - JavaMail 设置调试（真）

> ID：12556320
> 
> 赞同：9
> 
> 时间：2012-09-23T21:15:55.107
> 
> 标签：java, stream, jakarta-mail

我如何`setDebug(true)`在 JavaMail 会话中捕获流并在我的日志框架中使用它？（缺少下载源，更改方法以接受流作为参数，重新编译它，...）

更一般地说，Java 中是否有一种以这种方式“劫持和重定向”通用流输出的标准方法？请注意， System.out 可能已经被其他输出污染了，我不知道如何“过滤”...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-23T23:59:54.023

您可以将 PrintStream 链接到 ByteArrayOutputStream，告诉 JavaMail 使用您的 PrintStream，执行 JavaMail 的工作，最后将 ByteArrayOutputStream 的内容转储到您最喜欢的记录器。

```
 ByteArrayOutputStream os = new ByteArrayOutputStream();
        PrintStream ps = new PrintStream(os);
        Session mailSession = Session.getDefaultInstance(props, null);
        try {
           if (MAIL_DEBUG) {
                logger.info("JAVAMAIL debug mode is ON");
                mailSession.setDebugOut(ps);
                mailSession.setDebug(true);  
            }
            ...
            transport.close();
            if (MAIL_DEBUG) {
                logger.info(os);
            }
        }
          finally {
            ps.close();
            os.close();
        } 
```

# deployment - 网站部署技术

> ID：12556323
> 
> 赞同：1
> 
> 时间：2012-09-23T21:16:08.840
> 
> 标签：deployment, build, web, automation

我正在改进一个小型 Intranet，其中文件当前直接在服务器上编辑（通过 Samba 连接）。您可以想象，我想通过以下方式极大地改进此工作流程：

*   版本控制
*   验证 JavaScript 和 CSS（或 SAAS）文件
*   缩小 JavaScript 和 CSS（或 SAAS）文件
*   传输到实时服务器（理想情况下到安装的服务器，而不是 SSH 等）

当然，我希望这尽可能自动化。

我已经在这个主题上环顾了几个小时，遇到了类似的[问题](https://stackoverflow.com/questions/2561666/build-systems-for-php-web-apps?rq=1)，并阅读了各种工具（Ant、Capistrano、Maven、Phing 等……），但我很难对整个过程进行概述. 是否有任何好的书籍或教程可以逐步完成工作流程，也许会在此过程中指出合适的工具并展示基本示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-14T16:53:19.137

我们的网站上有很多关于部署的指南。看看吧，也许你会发现有用的。这是关于部署最佳实践的一个：

[http://guides.beanstalkapp.com/deployments/best-practices.html](http://guides.beanstalkapp.com/deployments/best-practices.html)

这是关于配置您的第一个 Capistrano 食谱的内容：

[http://guides.beanstalkapp.com/deployments/deploy-with-capistrano.html](http://guides.beanstalkapp.com/deployments/deploy-with-capistrano.html)

这是关于使用 Beanstalk 管理 Capistrano 部署的：

[http://guides.beanstalkapp.com/deployments/managing-capistrano-deployments.html](http://guides.beanstalkapp.com/deployments/managing-capistrano-deployments.html)

祝你好运！

# javascript - 身体背景改变？

> ID：12556326
> 
> 赞同：0
> 
> 时间：2012-09-23T21:16:23.710
> 
> 标签：javascript, jquery, css, background, document-body

好吧，就在这里。

简单地说，我希望能够通过 CSS 淡出身体的背景并经常改变然后循环。

有什么想法可以通过 CSS 和 jQuery 实现吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:23:09.223

您可以使用 jquery animate 方法，并在完成时使用新颜色再次调用该方法：

```
var color = ["red","green","blue"];
var i = 0;

function changeColor()
{
 // Change to the next color over 2 seconds.  When it is done, call this method again.
 $("body").animate({"background-color":color[i]}, 2000, changeColor); 
 i++;  // Increment the counter so the next color in the array is shown
 i = i % 3;   // Make sure i is never greater than 2 by using the modulous.
}

changeColor(); 
```

看到这个小提琴：http: [//jsfiddle.net/johnkoer/vDCSw/5/](http://jsfiddle.net/johnkoer/vDCSw/5/)

​</p>

# lamp - 我应该如何在 Ubuntu 12.0.4 上为 /var/www 配置 UID、GID 和权限？

> ID：12556327
> 
> 赞同：0
> 
> 时间：2012-09-23T21:16:24.050
> 
> 标签：lamp, ubuntu-12.04, virtual-hosts

我是一名 web 开发人员，对 linux 不熟悉。我刚刚将我的个人笔记本电脑配置为双启动 Windows 7 / Ubuntu 12.0.4 工作站。我按照此处的说明通过 taskel 安装了默认的 Ubuntu LAMP 堆栈：[https](https://help.ubuntu.com/community/ApacheMySQLPHP) ://help.ubuntu.com/community/ApacheMySQLPHP 。现在我想设置一些 web 项目并将它们映射到 Apache2 虚拟主机。我正在使用以下教程来设置 Apache2 虚拟主机：[http](http://www.linode.com/wiki/index.php/Configure_apache_to_use_virtual_hosts_on_ubuntu_server) ://www.linode.com/wiki/index.php/Configure_apache_to_use_virtual_hosts_on_ubuntu_server 。

我的 Linux 用户名是 neil。我想创建以下目录：/var/www/vhosts。我的每个 Web 项目都将位于 /var/www/vhosts 的子目录中。我的 IDE (PhpStorm) 应该具有对 /var/www/vhosts 的写入权限，以便我可以直接通过 IDE 创建新项目。当然，我的浏览器也应该能够查看每个 Web 项目。

我没有足够的访问权限来创建 /var/www/vhosts。显然我可以使用 sudo 创建目录，但我认为这不是我需要的解决方案。

所以这是我的问题，我应该为以下内容设置 UID、GID 和权限： 1\. /var/www 2\. /var/www/vhosts/foo （其中 foo 是项目的名称） 3\. Apache2 4 . MySQL 5\. PHP 6\. PhpStorm (IDE)？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T22:25:49.003

如果它是面向公众的（包括在公共 wifi 等不受信任的网络上），请不要偷懒，除非您使用的 LAMP 包需要特定的 chowning 和 chmoding 不要弄乱它。如果它只能由您信任的家庭网络或只有 localhost 访问，那么我会将其 chmod 为 777 并称之为好。

顺便说一句，这应该在[https://serverfault.com/](https://serverfault.com/)上询问过，您的帐户在此处可用。

# javascript - jQuery异常

> ID：12556328
> 
> 赞同：1
> 
> 时间：2012-09-23T21:16:32.273
> 
> 标签：javascript, jquery

我有这个导航菜单，其中的锚点与加载和动画内容的 jquery 片段相关联。（见演示：[http](http://d2o0t5hpnwv4c1.cloudfront.net/011_jQuerySite/sample/index.html) ://d2o0t5hpnwv4c1.cloudfront.net/011_jQuerySite/sample/index.html ）

现在，在一些导航的锚点上，我希望这个插件不会触发（因为我希望能够将一些导航菜单的锚点与 ScrollTo 插件严格关联）。

我的问题是，我可以添加什么：

```
$(document).ready(function() {

var hash = window.location.hash.substr(1);
var href = $('#nav li a').each(function(){
    var href = $(this).attr('href');
    if(hash==href.substr(0,href.length-4)){
        var toLoad = hash+'.php #content';
        $('#content').load(toLoad)
    }                                           
});

$('#nav li a').click(function(){

    var toLoad = $(this).attr('href')+' #content';
    $('#content').hide(888,loadContent);
    $('#load').remove();
    $('#wrapper').append('<span id="load">LOADING...</span>');
    $('#load').fadeIn(888);
    window.location.hash = $(this).attr('href').substr(0,$(this).attr('href').length-4);
    function loadContent() {
        $('#content').load(toLoad,'',showNewContent())
    }
    function showNewContent() {
        $('#content').show(888,hideLoader());
    }
    function hideLoader() {
        $('#load').fadeOut(888);
    }
    return false;

});

}); 
```

...这样它就不会在锚具有与之关联的 class="scroll" 时触发上述所有内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:31:58.533

您可以使用排除锚点[`.not(selector)`](http://api.jquery.com/not/)

```
$(document).ready(function() {

var hash = window.location.hash.substr(1);
var href = $('#nav li a').not('.scroll').each(function(){
    var href = $(this).attr('href');
    if(hash==href.substr(0,href.length-4)){
        var toLoad = hash+'.php #content';
        $('#content').load(toLoad)
    }                                           
});

$('#nav li a').not('.scroll').click(function(){

    var toLoad = $(this).attr('href')+' #content';
    $('#content').hide(888,loadContent);
    $('#load').remove();
    $('#wrapper').append('<span id="load">LOADING...</span>');
    $('#load').fadeIn(888);
    window.location.hash = $(this).attr('href').substr(0,$(this).attr('href').length-4);
    function loadContent() {
        $('#content').load(toLoad,'',showNewContent())
    }
    function showNewContent() {
        $('#content').show(888,hideLoader());
    }
    function hideLoader() {
        $('#load').fadeOut(888);
    }
    return false;

});

}); 
```

# c++ - Makefile 依赖项是否有“watch”/“monitor”/“guard”程序？

> ID：12556330
> 
> 赞同：3
> 
> 时间：2012-09-23T21:17:07.720
> 
> 标签：c++, build, makefile, filesystems, guard

我最近被在终端窗口中使用[nodemon](https://npmjs.org/package/nodemon)宠坏了，每当我保存更改时运行我的 Node.js 程序。

我想对我拥有的一些 C++ 代码做类似的事情。我的实际项目有很多源文件，但如果我们假设以下示例，我希望`make`在保存更改时自动运行`sample.dat`,`program.c`或`header.h`.

```
test: program sample.dat
    ./program < sample.dat

program: program.c header.h
    gcc program.c -o program 
```

是否有现有的解决方案可以做到这一点？

（无需启动 IDE。我知道很多 IDE 可以在您更改文件时重新构建项目。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-07T02:00:54.520

如果您在一个支持的平台上[`inotifywait`](http://linux.die.net/man/1/inotifywait)（据我所知，只有 Linux；但由于您询问了 Make，看来您很有可能在 Linux 上；对于 OS X，请参阅[此问题](https://stackoverflow.com/q/1515730/834176)），您可以执行以下操作：

```
inotifywait --exclude '.*\.swp|.*\.o|.*~' --event MODIFY -q -m -r . |
while read
do make
done 
```

打破它：

```
inotifywait 
```

监听文件系统事件。

```
--exclude '.*\.swp|.*\.o|.*~' 
```

`.swp`排除以,`.o`或结尾的文件`~`（您可能希望添加到此列表中）。

```
--event MODIFY 
```

当您找到一个打印出事件发生的文件的文件路径时。

```
-q 
```

不要打印启动消息（因此不会过早调用 make）。

```
-m 
```

连续聆听。

```
-r . 
```

递归监听当前目录。然后它被输送到一个简单的循环中，该循环为读取的每一行调用 make。

根据您的需求量身定制。您可能会发现`inotifywait --help`联机帮助页很有帮助。

* * *

这是一个更详细的脚本。我没有对其进行太多测试，因此请谨慎使用。它旨在防止构建一次又一次不必要地发生，例如在 Git 中切换分支时。

```
#!/bin/sh
datestampFormat="%Y%m%d%H%M%S"
lastrun=$(date +$datestampFormat)
inotifywait --exclude '.*\.swp|.*\.o|.*~' \
            --event MODIFY \
            --timefmt $datestampFormat \
            --format %T \
            -q -m -r . |
while read modified; do
    if [ $modified -gt $lastrun ]; then
        make
        lastrun=$(date +$datestampFormat)
    fi
done 
```

# jquery - jQuery onClick 动作不会第二次触发

> ID：12556338
> 
> 赞同：0
> 
> 时间：2012-09-23T21:18:00.773
> 
> 标签：jquery, onclick

根据之前在 SO 上回答的一个问题，我制作了这个脚本，它将 CSS 类添加到 onClick 元素中。问题是它只能工作一次。如何重置功能？

这是 jQuery 代码：

```
jQuery(function() {
jQuery('.close-button').click(function(){
    jQuery(".content-display").addClass("cover");
    jQuery(".close-button").addClass("cover");
});

jQuery('.project').click(function(){
    jQuery('.content-display').addClass("uncover");
    jQuery('.close-button').addClass("uncover");
    }); 
}); 
```

和一切都[摆弄](http://jsfiddle.net/7p2Av/)着。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:20:43.427

改用[`.toggleClass()`](http://api.jquery.com/toggleClass/)：

```
jQuery('.project').click(function(){
        jQuery('.content-display').toggleClass("cover");
        jQuery('.close-button').toggleClass("cover");
    }); 
}); 
```

这样，如果该类已经存在，它将被删除；否则，它将被添加。此外，您应该切换`cover`类，因为`div`s 最初是可见的。

**[演示](http://jsfiddle.net/v32B7/)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T21:27:55.450

您需要删除替代类的行动。在当前代码中同时按下 close 和 project 后，您将同时拥有覆盖和发现类

```
jQuery(function() {
   jQuery('.close-button').click(function(){
       jQuery(".content-display").addClass("cover").removeClass("uncover");
       jQuery(".close-button").addClass("cover").removeClass("uncover");
   });

   jQuery('.project').click(function(){
       jQuery('.content-display').addClass("uncover").removeClass("cover");
       jQuery('.close-button').addClass("uncover").removeClass("cover");
   }); 
 }); 
```

对于这种特殊情况，似乎没有必要使用发现类，我投票支持简单的 removeClass 解决方案（@Stuart Feldt）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:28:08.297

如果你只是想隐藏和显示 div，你可以尝试：

```
jQuery(function() {
    jQuery('.close-button').on('click', function(){
        jQuery(".content-display").addClass("cover");
        jQuery(".close-button").addClass("cover");
    });

    jQuery('.project').on('click', function(){    
        jQuery(".content-display").removeClass("cover");
        jQuery(".close-button").removeClass("cover");
    }); 
}); 
```

# c++ - 在 C++ 中使用 back_insert_iterator

> ID：12556341
> 
> 赞同：3
> 
> 时间：2012-09-23T21:18:43.547
> 
> 标签：c++, iterator, istream

我正在尝试开始使用 C++，并且应该实现以下功能：

```
std::istream& readResults(std::istream& is, std::back_insert_iterator<std::vector<Result>> insertIt) 
```

该函数从 istream 读取格式为“studentId Grade”的行，并应使用 insertIt 将它们添加到向量类型。

结果是一个结构：

```
struct Result
{
  std::string studentId;
  size_t grade;
}; 
```

你能给我一个关于如何开始的提示吗？

我尝试过这样的事情：

```
std::string studentId;
size_t grade;
Result new_result;

while(is >> studentId >> grade) {
    Result new_result = {studentId, grade};
    copy(new_result, *insertIt);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:17:12.027

您不想实现该功能

```
std::istream& readResults(
    std::istream& is,
    std::back_insert_iterator<std::vector<Result>> insertIt) 
```

你想要做的是实现模板功能

```
template<class InsertIterator>
std::istream& readResults(std::istream& is, InsertIterator insertIt) 
```

当您通过`std::back_inserter(vec)`时，模板将自动实例化为正确的类型。

这个函数的代码基本上是

```
template<class InsertIterator>
std::istream& readResults(std::istream& is, InsertIterator insertIt) {
  std::string studentId;
  size_t grade;
  while (is >> studentId >> grade) {
    Result new_result = {studentId, grade};
    *(insertIt++) = new_result;
  }
} 
```

`std::copy`*从一个迭代器*复制到另一个。但是您不是从迭代器中复制。你一次插入一个元素，你通过取消引用迭代器来做到这一点，就好像它是一个指针，然后在你完成后递增它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T21:31:58.097

std::back_insert_iterator 直接使用真的很麻烦。请改用模板函数 std::back_inserter （它会为您完成所有模板参数推断）。

你的 readResults 会变成这样：

```
std::copy(std::istream_iterator<Result>(is), std::istream_iterator<Result>(), std::back_inserter(v)); 
```

前提是您为 Result 重载了 operator>>。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:29:06.753

您想为您的`Result`, 即声明如下的内容创建一个读取函数：

```
std::istream& operator>> (std::istream& in, Result& result)
{
    // read your result here
    return in;
} 
```

有了这个，实现`readResult()`变得相当简单：

```
std::copy(std::istream_iterator<Result>(is), std::istream_iterator<Result>(), insertIt); 
```

除此之外，您只需要`readResult()`使用合适的迭代器调用您的函数。

# php - 从 Google 翻译的网页链接回原始语言

> ID：12556343
> 
> 赞同：4
> 
> 时间：2012-09-23T21:19:04.533
> 
> 标签：php, google-translate

我有一个客户的网站，我们通过标志图标提供指向 Google 翻译的链接。我想提供一个从翻译结果返回到原始语言（英语）的链接。

[你可以在tesselaar.com](http://tesselaar.com)的任何页面的右上角看到我到目前为止所做的工作

如果您单击其中一个标志，则页面会被翻译，并且标志图标将替换为英文版本。我希望这个标志链接回来，但正如你所看到的，因为谷歌翻译正在重写我给它的 URL。有谁知道如何解决这个问题？

这是我的代码：

```
<?php

echo "<ul class=\"breadcrumb pull-right\">\n";

if (stripos($_SERVER['HTTP_REFERER'], "translate.google") !== false) { // page has been translated

  if (empty($_SESSION['return_url'])) $_SESSION['return_url'] = "tesselaar.com";

  echo "<li>View page in English:</li>\n";
  echo "<li><a target=\"_top\" href=\"http://" . $_SESSION['return_url'] . "\"><img src=\"/assets/img/flags/gb.gif\" width=\"16\" height=\"11\" title=\"English\" alt=\"English\"></a></li>\n";

} else { // regular site (not translated)

  $_SESSION['return_url'] = $_SERVER['REQUEST_URI'];

  echo "<li>Translate this page:</li>\n";
  echo "<li><a href=\"http://translate.google.com/translate?sl=en&tl=fr&u=tesselaar.com". $_SERVER['REQUEST_URI'] . "\"><img src=\"/assets/img/flags/fr.gif\" width=\"16\" height=\"11\" alt=\"French\"></a></li>\n";
  echo "<li><a href=\"http://translate.google.com/translate?sl=en&tl=de&u=tesselaar.com". $_SERVER['REQUEST_URI'] . "\"><img src=\"/assets/img/flags/de.gif\" width=\"16\" height=\"11\" alt=\"German\"></a></li>\n";
  echo "<li><a href=\"http://translate.google.com/translate?sl=en&tl=nl&u=tesselaar.com". $_SERVER['REQUEST_URI'] . "\"><img src=\"/assets/img/flags/nl.gif\" width=\"16\" height=\"11\" alt=\"Dutch\"></a></li>\n";
  echo "<li><a href=\"http://translate.google.com/translate?sl=en&tl=es&u=tesselaar.com". $_SERVER['REQUEST_URI'] . "\"><img src=\"/assets/img/flags/es.gif\" width=\"16\" height=\"11\" alt=\"Spanish\"></a></li>\n";
  echo "<li><a href=\"http://translate.google.com/translate?sl=en&tl=el&u=tesselaar.com". $_SERVER['REQUEST_URI'] . "\"><img src=\"/assets/img/flags/gr.gif\" width=\"16\" height=\"11\" alt=\"Greek\"></a></li>\n";

}

echo "</ul>\n\n";

?> 
```

编辑：自从发布以来，我尝试过的事情没有成功：

*   在“notranslate”跨度中包装各种东西。
*   使用 jQuery 尝试重写“链接返回”URL。
*   使用jQuery拦截“链接返回”点击并重写父框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-06T18:25:40.380

所以我能够用 jQuery 解决你的问题。这就是我所做的：

```
<!-- inside your <head></head -->
<script src="http://code.jquery.com/jquery-1.10.0.min.js"></script>

<!-- inside your <body></body> -->
<?php $requestUri = str_replace('untranslate', '', $_SERVER['REQUEST_URI']); ?>
<ul class="breadcrumb pull-right">
    <?php if (stripos($_SERVER['HTTP_REFERER'], "translate.google") !== false && !isset($_GET['untranslate'])) : ?>
        <li class="notranslate">View page in English:</li>
        <li>
            <a class="untranslate" href="#">
                <img src="/assets/img/flags/gb.gif" width="16" height="11" alt="English" />
            </a>
        </li>
    <?php else: ?>
        <?php $uri = "http://translate.google.com/translate?sl=en&u=" . $_SERVER['HTTP_HOST']; ?>
        <li>Translate this page:</li>
        <li><a href="<?php echo $uri . $requestUri ?>&tl=fr"><img src="/assets/img/flags/fr.gif" width="16" height="11" alt="French" /></a></li>
        <li><a href="<?php echo $uri . $requestUri ?>&tl=de"><img src="/assets/img/flags/ed.gif" width="16" height="11" alt="German" /></a></li>
        <li><a href="<?php echo $uri . $requestUri ?>&tl=nl"><img src="/assets/img/flags/nl.gif" width="16" height="11" alt="Dutch" /></a></li>
        <li><a href="<?php echo $uri . $requestUri ?>&tl=es"><img src="/assets/img/flags/es.gif" width="16" height="11" alt="Spanish" /></a></li>
        <li><a href="<?php echo $uri . $requestUri ?>&tl=el"><img src="/assets/img/flags/gr.gif" width="16" height="11" alt="Greek" /></a></li>
    <?php endif; ?>
</ul>

<!-- right before your </body> or remove <script></script> and place in different js file -->
<script>
    $('.untranslate').click(function() {
        window.top.location = 'http://<?php echo $_SERVER['HTTP_HOST'] . $requestUri ?>?untranslate';
    });
</script> 
```

所以基本上有一个链接没有类的 url，`.untranslate`然后 jQuery 等待被点击。单击它后，它将将该页面重定向到您网站的原始页面未翻译版本。它还传递了一个 get 参数，`untranslate`因为重定向传递了 translate.google HTTP_REFERER。

# twitter - 如何找到给网页的推文？

> ID：12556348
> 
> 赞同：0
> 
> 时间：2012-09-23T21:19:40.743
> 
> 标签：twitter

我有一个带有小 Twitter API 代码的网页，允许任何人发布关于页面的推文。现在，我想找到这些人发布的推文。我怎么做？这是示例： [http ://www.squidoo.com/google-glass-glasses](http://www.squidoo.com/google-glass-glasses)

在左侧，它显示了 3 条推文。在 Twitter 上搜索该 URL 只会将一条真实的推文带回该页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T14:16:26.557

[http://backtweets.com](http://backtweets.com)似乎比 twitter 本身做得更好。

# c - 函数指针数组的使用

> ID：12556351
> 
> 赞同：3
> 
> 时间：2012-09-23T21:20:26.993
> 
> 标签：c, arrays, function, pointers

使用函数指针数组有什么好处？除了减少 C 中函数原型的数量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:32:59.237

正如许多人所指出的，函数指针可用于模拟 C 中的面向对象编程。

例如，可以使用简单的索引来选择适当的方法（也称为虚拟方法）。

```
#include <stdio.h>
#include <stdlib.h>

typedef void (*menu_function_t)();

void menu_error()
{
    printf("Invalid menu choice\n");
}

void menu_exit()
{
    exit(0);
}

void menu_function1()
{
    printf("You have selected 1\n");
}

void menu_function2()
{
    printf("You have selected 2\n");
}

menu_function_t menu_ptr[] = {
    menu_function1, menu_function2,  menu_exit, menu_error
};

int menu_num = sizeof(menu_ptr) / sizeof(menu_ptr[0]);

int validate_choice(int a)
{
    if(a < 0 || a > menu_num - 2) { return 3; }

    return a;
}

int main()
{
    int choice = 0;

    while(1)
    {
        printf("Choose item: \n");
        printf("0) Function 1\n");
        printf("1) Function 2\n");
        printf("2) Exit\n");
        scanf("%d", &choice);

        menu_ptr[ validate_choice(choice) ]();
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T21:23:32.270

保存函数指针的数组（或其他数据结构）有多种用例。通常，这种类型的机制允许您的程序根据运行时标准动态调用几个不同函数之一。

例如，您可以使用函数指针数组来实现类似于 OO 语言的接口。该数组将保存一个指向该接口的每个实现的指针。数组索引将用于根据某些标准选择所需的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T21:31:13.293

如果您想将数值与操作相关联，您可以使用函数指针数组，尽管它实际上被称为映射。它会节省有一个大的`switch`声明。

```
array[CMD_OPEN] = OpenFunction;
array[CMD_CLOSE] = CloseFunction; 
```

ETC

```
void HandleCommand(int aCommand)
{
    array[aCommand]();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T21:24:45.503

一个例子（很多存在）是当你想实现一系列可变的“方法”时：

```
typedef struct tag_IMAGEFORMAT
{
        struct tag_IMAGEFORMAT *next;
        const char      *name;
        IMAGEDETECTOR   *detect_routine;
        int             (*open_routine)         (DISKIMAGE *img, diskimgflags_t flags);
        size_t          (*read_routine)         (DISKIMAGE *img);
        int             (*close_routine)        (DISKIMAGE *img);
} IMAGEFORMAT; 
```

C 中的面向对象编程。然后调用 eg `object->open_routine(..)`，其实现可以在运行时动态更改（在此示例中，取决于图像格式）。

在此示例中，几种图像格式共享一个通用 API；各种“检测器”一个接一个地运行，第一个匹配的将其指针复制到“通用图像”对象。之后，您可以操作图像而无需担心其实现细节（JPG、GIF、PNG 等）。

同样，如果您需要实现一个函数的几种不同变体（例如图像过滤器），您可以将所有指针保存在一个数组中，并通过数组中的索引选择合适的指针。

# javascript - 获取图像实际大小 JS/Jquery

> ID：12556356
> 
> 赞同：0
> 
> 时间：2012-09-23T21:20:43.677
> 
> 标签：javascript, jquery, image

> **可能重复：**
> [确定图像跨浏览器的原始大小？](https://stackoverflow.com/questions/1944280/determine-original-size-of-image-cross-browser)
> [jquery获取图片大小](https://stackoverflow.com/questions/2038075/jquery-get-image-size)

有人可以告诉我如何使用 JS / JQ 获得图像的实际大小吗？谢谢 ！从这个网站尝试了很多解决方案，但没有成功......

```
var selector = $(".album_pics > img[id="+img_id+"]") ;
var old_width = selector.width() ; 
```

没用。。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T21:23:24.560

您可以使用该`naturalWidth`属性：

```
var img = document.getElementById('imageToTest'), // or whatever...
    width = img.naturalWidth; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/xh8MD/)。

当然，这确实需要在执行 JavaScript 之前有时间加载图像（因此，在 jQuery 中，使用该`$(window).load()`方法）。它也是仅 HTML5 的（直到我刚刚检查过，我才意识到这一点）。

顺便说一句，正如名称所暗示的那样，还有`naturalHeight`财产（如果有用的话）。

更新以添加功能更强大的方法：

```
function showNaturalInfo(el) {
    if (!el || el.tagName.toLowerCase() !== 'img') {
        return false;
    }
    else {
        var w = el.naturalWidth,
            h = el.naturalHeight,
            D = document,
            details = D.createElement('span'),
            detailsText = D.createTextNode('Natural width: ' + w + 'px; natural height: ' + h + 'px.');
        details.appendChild(detailsText);
        el.title = 'Natural width: ' + w + 'px; natural height: ' + h + 'px.';
        el.parentNode.insertBefore(details, el.nextSibling);
    }
}

var imgs = document.getElementsByTagName('img');

for (var i = 0, len = imgs.length; i < len; i++) {
    showNaturalInfo(imgs[i]);
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/xh8MD/1/)。

参考：

*   [`naturalWidth`](https://developer.mozilla.org/en-US/docs/DOM/HTMLImageElement).

# django - Django - 模型 Unicode 错误

> ID：12556357
> 
> 赞同：0
> 
> 时间：2012-09-23T21:20:49.637
> 
> 标签：django, django-models

这是我的模型：

```
class Profile(models.Model):
 28     owner = models.OneToOneField(User)
 29     title = models.CharField(max_length=20,null=True)
 30     slogan = models.TextField(null=True)
 31     twitter = models.CharField(max_length = 100,null=True)
 32     web_site = models.CharField(max_length=100,null=True)
 33     email = models.EmailField(max_length = 100,null=True)
 34 
 35     def create_user(sender,instance,created,**kwargs):
 36         if created:
 37             Profile.objects.create(owner=instance)
 38 
 39     post_save.connect(create_user, sender=User)
 40 
 41     def __unicode__(self):
 42         return self.title 
```

它抛出：

```
TypeError at /superadmin/auth/user/

coercing to Unicode: need string or buffer, NoneType found 
```

我试图返回每个字段。但还是一样。。

我想念什么？

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:29:37.093

该文档[特别警告](https://docs.djangoproject.com/en/1.4/ref/models/fields/#null)不要`null=True`在 CharFields 上使用。不要这样做。

# python - 似乎无法用我的 Python 脚本抓取深层目录，知道吗？

> ID：12556360
> 
> 赞同：0
> 
> 时间：2012-09-23T21:20:59.817
> 
> 标签：python, recursion, web-crawler, directory

该脚本基本上是创建一个包含所有目录中所有文件的列表。知道为什么在必须扫描大于几个文件的目录时似乎会崩溃吗？

```
import os

correctlyNamedDirectories = []

def crawlDirectories(directory):
    for dirname, dirnames, filenames in os.walk(directory):
        for subdirname in dirnames:
            correctlyNamedDirectories.append(os.path.join(dirname, subdirname))
        for filename in filenames:
            correctlyNamedDirectories.append(os.path.join(dirname, filename))

crawlDirectories('.')

print correctlyNamedDirectories 
```

另外，有没有更干净的方法来写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:24:46.517

具有列表理解的较短方法：

```
correctlyNamedDirectories = [os.path.join(path, subname) for path, dirnames, filenames in os.walk(directory) for subname in dirnames + filenames] 
```

# mysql - MySQL 错误 Greatest-n-per-group

> ID：12556362
> 
> 赞同：0
> 
> 时间：2012-09-23T21:21:19.090
> 
> 标签：mysql, greatest-n-per-group

```
 SELECT ma_forum.*, ma_forum_cat.*
    FROM ma_forum, ma_forum_cat
    JOIN ma_forum_comentarios ON ma_forum_comentarios.not_id = ma_forum.not_id
    WHERE ma_forum.notcat_id=ma_forum_cat.notcat_id AND ma_forum.notcat_id='".$notcat_id."' 
    AND ma_forum.not_status='Ativo'
    GROUP BY ma_forum.not_id
    ORDER BY MAX(ma_forum_comentarios.comnot_data) DESC 
```

“on 子句”中的未知列“ma_forum.not_id”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:26:16.183

`not_id`表中不存在该列`ma_forum`。

如果该列确实存在，请尝试以下操作并报告回来。

```
SELECT ma_forum.*, 
       ma_forum_cat.*
FROM   ma_forum JOIN 
       ma_forum_cat ON ma_forum.notcat_id = ma_forum_cat.notcat_id JOIN 
       ma_forum_comentarios ON ma_forum_comentarios.not_id = ma_forum.not_id
WHERE  ma_forum.notcat_id = '$notcat_id' AND 
       ma_forum.not_status= 'Ativo'
GROUP BY ma_forum.not_id
ORDER BY MAX(ma_forum_comentarios.comnot_data) DESC 
```

# asp.net - 一种在页面上存储视图以及何时保存在数据库中的快速方法

> ID：12556367
> 
> 赞同：2
> 
> 时间：2012-09-23T21:22:29.090
> 
> 标签：asp.net, database, performance

我想像大多数论坛、Youtube 和其他几个论坛一样实现一个视图计数器。因此，每次用户阅读一篇文章时，它都会被存储和记住。我也想知道谁看了这篇文章。

**我的问题是：你如何有效地实现这一点？最佳做法是什么？**

一种方法是为每个视图调用一个存储过程，但这会导致对数据库**进行大量不必要的调用**。

另一种方法是将其存储到某个全局应用程序对象中，然后每 5 分钟左右存储在数据库中（您甚至可以以一种好的方式做到这一点吗？）

最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:18:16.747

数据库操作非常便宜，真的不值得担心。如果 DB 操作稍微昂贵，那么您总是可以将阻塞操作委托给一个新线程，从而释放您的页面生成线程（对于从数据库中不返回任何内容的 UPDATE 和 INSERT 操作，您可以轻松地执行此操作 -它们无关紧要）。

Sprocs 现在并不是真正的时尚——它们可能从预先计算的执行计划中获得的性能优势几乎被消除了，因为现代服务器缓存了所有先前查询的计划，并且对于琐碎的 SELECT、INSERT 和 UPDATE，您开始遭受痛苦由于代码复杂性增加。现在内联 SQL 命令没有任何问题。

无论如何，回到主题并总结一下：您的假设是错误的。`UPDATE Pages SET ViewCount = ViewCount + 1 WHERE PageId = @pageId`在每个页面视图上运行都没有错。这样做也没有错：`INSERT INTO UserPageviews (UserId, PageId, DateTime) VALUES ( @userId, @pageId, NOW() )`. 这两种操作都非常便宜，即使在旧的和老化的数据库服务器上也能在 2-3 毫秒内执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:28:36.023

> 另一种方法是将其存储到某个全局应用程序对象中，然后每 5 分钟左右存储在数据库中（您甚至可以以一种好的方式做到这一点吗？）

除非您使用持久的排队机制（如 MSMQ），否则此方法很容易丢失数据。除非您预计会有大量流量，否则我什至不会考虑这种方法。

这种性质的写入成本很低，每秒数百次操作也没什么大不了的。我最近构建了一个评论/评级框架，仅在我的本地一体化工作站上就可以实现每秒 3000 多个完整事务的吞吐量。这包括处理请求、验证和在事务中创建多个记录。

请注意，您应该采取措施确保您的统计数据不易受到人为膨胀/操纵的影响。这部分过程可能比视图跟踪本身更复杂。例如，用户不应该坐下来按住 F5 键并夸大其视频的观看次数。这些值也不应该被 HTTP 操纵（例如，创建一个小脚本来一遍又一遍地发送 AJAX 请求）。

这表明每个 INSERT 之前都会有一个 SELECT，以确保在某个时间段内没有记录相同的用户 ID 或 IP。当然，这并不是万无一失的（除非您投入大量精力），但它偏向保守主义，这通常是一种好方法。

> 一种方法是为每个视图调用一个存储过程，但这会导致对数据库进行大量不必要的调用。

我必须经常提醒自己（和其他开发人员）不要害怕数据库。人们（包括我）有时会竭尽全力避免一些简单的数据库调用。保持你的表窄且索引良好，这样的操作比你想象的要快。

# sql - 在 oracle 10g 中使用多个子查询

> ID：12556369
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:22:48.293
> 
> 标签：sql, oracle, oracle10g

我有这些带有一些值的表。

```
ticket_detail
ticket_header
route_header
route_detail
fleet_header 
```

现在我有这个问题，我必须写查询。

```
Select common ticket numbers 
from ticket header and ticket detail 
where route ids are greater than route_id 
which belong to the place with id ‘04’. 
```

*编辑* 我试过用

```
select * from   
   (select ticket_number 
    from ticket_header
    union 
    select ticket_number from ticket_detail)     
where route_id > (select route_id from ticket_detail where id = 4) 
```

我尝试使用子查询来做到这一点，但这让我感到困惑。我们如何在一个查询中关联这三个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T02:38:39.657

您的查询已关闭，但您需要内部查询中的 route_id：

```
select *
from (select ticket_number, route_id 
      from ticket_header
      union 
      select ticket_number, route_id
      from ticket_detail
     ) t
where route_id > (select route_id from ticket_detail where id = 4) 
```

这假设只有一个 id = 4 的 route_id。您可能需要`max(route_id)`，只是为了确定。

此外，作为一般规则，您应该习惯 UNION ALL 而不是 UNION，因为它更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:57:45.977

我认为 UNION 关键字应该是 INTERSECT 。

INTERSECT 为您提供**共同**的价值观。联合为您提供两个结果集中的所有值，而不会重复。

这个问题仍然需要一些澄清，但你是在正确的道路上。您的查询看起来语法错误。试试这个，如果这不起作用，请发布一些输出数据与预期不符的示例案例。

```
select ticket_number 
  from ticket_header th
  where th.route_id > (select route_id from ticket_detail where id = 4)
INTERSECT
select ticket_number 
  from ticket_detail td
  where td.route_id > (select route_id from ticket_detail where id = 4) 
```

# c# - 如何使用 Regex 获得“innerHTML”？

> ID：12556371
> 
> 赞同：1
> 
> 时间：2012-09-23T21:22:52.827
> 
> 标签：c#, html, regex, html-parsing

> **可能重复：**
> [正则表达式匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

`<a href="http://abc.com/abc.htm" style="color:#005F9A;">I need it</a>`

我怎样才能得到“我需要它”的句子？我想使用正则表达式...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:26:14.483

这是您可以用来提取所需内容的正则表达式模式：

```
(?<=\<a\shref=.*?\>).*?(?=\<\/a\>) 
```

# mysql - Media Temple 的 phpMyAdmin 中有问题的土耳其语字符

> ID：12556381
> 
> 赞同：0
> 
> 时间：2012-09-23T21:23:53.380
> 
> 标签：mysql, phpmyadmin

我正在使用媒体寺庙，我使用 PHP 文件（以 UTF-8 编码，没有 BOM）创建这样的表格：

```
CREATE TABLE table_name (
...
) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_unicode_ci 
```

我有两种情况：

1 - 通过 php 代码将一些行插入到表中。土耳其语字符在 phpMyAdmin 中奇怪地显示，但是当我在浏览器上打印它们时，它们看起来是正确的。

2 - 我通过 phpMyAdmin SQL 查询选项卡将一些带有土耳其字符的数据添加到表中。这次我在 phpMyAdmin 中看到了正确的字符，但是，当我将表格行打印到浏览器时，我得到的是问号而不是土耳其语字符。

我的浏览器使用 UTF-8 作为字符编码。我尝试将“utf8_turkish_ci”作为表格的排序规则，但没有效果。我将 phpMyAdmin 语言更改为土耳其语，但它也不起作用。当我从 Media Temple 导出数据库时，所有土耳其字符都被替换为奇怪的字符。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:13:13.500

I solve my problem by using mysqli. I was in a paradox while using mysql extension in PHP such that when I get correct characters in phpMyAdmin, I get wrong on browser or vice versa. I just convert codes, nothing more (connect, set names to utf8 and do whatever you want). Every operation looks fine now. I don't why but changing extension solved the problem.

# matlab - 在具有不同输入的matlab中运行一个函数并保存多个输出

> ID：12556384
> 
> 赞同：2
> 
> 时间：2012-09-23T21:24:30.787
> 
> 标签：matlab

假设你有一些功能

```
x = foo(alpha, beta); 
```

并且您想测试不同 alpha 值的函数，同时使用与不同 alpha 值关联的名称保存不同的 x 值。

例如，如果`alpha = 1:1:10;` 那么我想另存`x_1 , x_2 ,........,x_9 , x_10`为单独的结果

我尝试过运行不同的循环等，但我不知道如何防止 x 值被替换

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:27:42.270

做这件事有很多种方法

例如，如果要将结果保存到磁盘，可以运行

```
alpha = 1:10;

for ii=1:length(alpha)

  x = foo(alpha(ii),beta);

  %# save to disk
  save(sprintf('run_%i.mat',ii),'x');

end 
```

相反，如果您想存储所有输出，以便进行绘图，例如，您可以将它们存储在数组中

```
alpha = 1:10;
x = zeros(size(alpha));

for ii=1:length(alpha)

  x(ii) = foo(alpha(ii),beta);

end

%# now you can plot the results
plot(alpha,x) 
```

请注意，以上假设 的输出`foo`是标量。如果输出始终是一个`m-by-n`数组，则初始化`x`为`zeros(m,n,length(alpha))`，并分配`x(:,:,ii)`每个循环。如果输出是不同大小的数组，则初始化`x`为元胞数组 as `x = cell(size(alpha))`，并将输出分配`foo`给`x{ii}`。

# php - xml 代码与 php？

> ID：12556389
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:25:11.603
> 
> 标签：php, xml

我有以下 xml 文件代码（来自翻页），想知道是否可以使用 php while 循环在 xml 文件中生成代码，而不必手动从 pages/ab74 输入到 pages/ab98？

```
<page src="pages/ab62.jpg"/>
<page src="pages/ab63.jpg"/>
<page src="pages/ab64.jpg"/>
<page src="pages/ab65.jpg"/>
<page src="pages/ab66.jpg"/>
<page src="pages/ab67.jpg"/>
<page src="pages/ab68.jpg"/>
<page src="pages/ab69.jpg"/>
<page src="pages/ab70.jpg"/>
<page src="pages/ab71.jpg"/>
<page src="pages/ab72.jpg"/>
<page src="pages/ab73.jpg"/>
<page src="pages/ab74.jpg"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T21:28:11.457

绝对地。如果你想经常这样做，你必须将内容类型设置为 xml 并使用 URL 重写来允许你的 file.xml 指向一个实际的 .php 文件。

```
<?php for ($i = 74; $i <= 98; $i++): ?>
<page src="pages/ab<?php echo $i; ?>.jpg"/>
<?php endfor; ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:43:46.287

这只是一些输出操作：

```
$image = "<page src=\"pages/ab%d.jpg\"/>\n";
foreach (range(62, 74) as $number) {
    printf($image, $number);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:28:23.690

从字面上回答你的问题，是的，这是可能的。如果这就是您的 XML 的全部内容（不应该是因为它缺少根节点），那么您只需要使用`for()`循环。否则，请查看 PHP [SimpleXML](http://php.net/manual/en/book.simplexml.php)库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T21:29:06.003

你可以简单地做到这一点

```
$page = "<page src=\"pages/ab%d.jpg\"/>";
for($i = 62 ; $i <= 98; $i++)
{
    printf($page,$i);
} 
```

创建翻页配置文件的完整示例

```
$xmlFile = "xml/Pages.xml";
$xml = '<content width="600" height="800" bgcolor="cccccc" loadercolor="ffffff" panelcolor="3a6dac" buttoncolor="3a6dac" textcolor="d0e5f7">';
$page = "<page src=\"pages/ab%d.jpg\"/>\n";
for($i = 62 ; $i <= 98; $i++)
{
    $xml .= sprintf($page,$i);
}
$xml .= '</content>' ;
$xml = new SimpleXMLElement($xml);
$xml->saveXML($xmlFile); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-23T21:29:52.327

你是这个意思吗？：

```
<?php
for($i=75;$i<=98;$i++)
{
    echo '<page src="pages/ab' . $i . '.jpg"/>' . "\n";
} 
```

# objective-c - 如何知道字符串是否不等于另一个 iOS

> ID：12556392
> 
> 赞同：-4
> 
> 时间：2012-09-23T21:25:43.217
> 
> 标签：objective-c, xcode

我知道

```
if([string1 isEqualToString:string2]){} 
```

但是反过来呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:29:52.450

以下是不同的组合：

*   测试字符串是否相等

    ```
    if([string1 isEqualToString:string2]) { /* equal */ } 
    ```

*   测试字符串是否**不**相等（注意`!`否定条件的运算符）

    ```
    if(![string1 isEqualToString:string2]) { /* not equal */ } 
    ```

*   或者，将结果与 进行比较`NO`是等效的：

    ```
    if([string1 isEqualToString:string2] == NO) { /* not equal */ } 
    ```

*   最后，如果您需要同时进行两个测试并执行一个或另一个代码

    ```
    if([string1 isEqualToString:string2])
    {
      /* code to execute if strings are equal */
    } else {
      /* code to execute if strings are different */
    } 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T21:29:07.583

您需要`!`操作员：

```
if (![string1 isEqualToString:string2])
{
} 
```

或者，您可以明确比较：

```
if ([string1 isEqualToString:string2] == NO)
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:28:46.257

它是

```
if(![string1 isEqualToString:string2]){} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T21:43:34.150

要扩展先前的答案（当然是完全正确的），您必须了解`isEqualToString:`返回 a **`BOOL`**，它可以是**`YES`**or **`NO`**。

所以：

```
if( [ s1 isEqualToString: s2 ] ) 
```

隐含的意思：

```
if( [ s1 isEqualToString: s2 ] == YES ) 
```

所以你可以使用：

```
if( [ s1 isEqualToString: s2 ] == NO ) 
```

这与以下内容相同：

```
if( ![ s1 isEqualToString: s2 ] ) 
```

# ios - 如何使 Xcode 4.5 项目在以前版本的 Xcode 上工作？

> ID：12556393
> 
> 赞同：1
> 
> 时间：2012-09-23T21:25:51.317
> 
> 标签：ios, xcode

如果我在 Xcode 4.5 上开发 iPhone 应用程序，有没有办法可以在 Xcode 4.4.1 上编译，或者如果在 4.4.1 上开发，在 4.3 上编译？

* * *

详细信息：我通常喜欢升级到最新版本的 Xcode，但最近猎头向我介绍了一些公司，其中一些人要求我根据他们的规范编写一个示例应用程序。他们没有具体说明他们使用什么平台，而且问题通常不是小事，所以花费的时间可能是 4、5 个小时。所以4、5个小时后，当我发给公司的时候，他们可能会花1到2分钟的时间，决定“它不能编译”并把它扔到一边，甚至没有联系我它不会编译，甚至没有告诉我他们已经通过电子邮件收到了这个项目。也许这就是生活。总是询问公司他们将使用什么 Xcode 来测试示例项目似乎是一个很好的做法。但截至目前，我有一个 Xcode 4.5 项目，面试官告诉我他们正在使用 Xcode 4.4.1，不知何故，

# javascript - wordpress 管理员中没有 DOM

> ID：12556394
> 
> 赞同：0
> 
> 时间：2012-09-23T21:25:59.720
> 
> 标签：javascript, wordpress, dom

我正确地将一个 javascript 文件插入到 wordPress 管理员中：

```
 wp_enqueue_script() 
```

我知道脚本正在加载。我用`alert()`. 然后我发现我无法访问 DOM。当我尝试：

```
document.getElementsByTagName('body')[0].addEventListener('load', function() {}); 
```

这个错误是：

```
Uncaught TypeError: Cannot call method 'addEventListener' of undefined 
```

这是我第一次使用“设置 api”或将脚本插入 WordPress 管理员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:31:04.540

您的代码可能在 DOM 完全加载`<body>`且不可用之前执行。如果你想在加载时运行一个函数，我会使用`jQuery.ready()`jQuery，因为默认情况下 jQuery 在 Wordpress 中已经可用：

```
jQuery(document).ready(function($){ /* your code */ }); 
```

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:34:17.643

您实际上想将 load 事件处理程序添加到`window`not `body`. 一方面，在解析 BODY 标记之前，正文不存在。如果您的脚本在 HEAD 中，那么将任何内容附加到正文还为时过早。因此，如果您希望脚本在加载 DOM 之前不运行，您无法通过尝试将事件处理程序添加到 DOM 中的对象来实现。

我*强烈*建议使用 JS 框架来处理这个问题。添加您自己的功能以在页面加载时运行是您希望跨浏览器兼容且易于扩展的功能。主要的 JS 框架已经解决了这个问题，尝试手动解决这个问题几乎没有什么收获。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:44:47.647

我想你可以试试这个

```
document.addEventListener('DOMContentLoaded', load, false); 
```

或者

```
window.onload=load; // onload will work in all browsers so use this 
```

和你的处理程序

```
function load(){ ... } 
```

您也可以按照`Fabrício Matté`'s 的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T21:43:52.063

将脚本排入`footer`页面。

那时您将不需要 DOM 就绪处理程序，更不用说负载侦听器了。
而且正如@Dancrumb 回答的那样，`load`是`window`事件而不是事件`body`。

默认情况下，WP 在`head`. `body`如果没有侦听器/延迟执行，则无法直接从访问元素，`head`因为 DOM 解析器根本还没有到达`body`标签。通过将脚本放在页脚中，它可以确保 DOM 已经准备好让您的脚本运行。

的语法[`wp_enqueue_script()`](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)是：

```
wp_enqueue_script( 
     $handle
    ,$src
    ,$deps
    ,$ver
    ,$in_footer 
); 
```

因此，对于您的用例，将第 5 个选项设置为`true`.

# java - 从 BigDecimal [ ] 添加值

> ID：12556400
> 
> 赞同：3
> 
> 时间：2012-09-23T21:26:39.883
> 
> 标签：java, bigdecimal

我正在努力寻找一种将 BigDecimal [ ] 中的值相加的方法，该方法是从 mysql 表中的复选框表单中获得的。

这是我到目前为止的代码，但我找不到从获得的值中只获得一个数字的方法：

```
String select[] = request.getParameterValues("id"); 
if (select != null && select.length != 0)
{
    for (int i = 0; i < select.length; i++) 
    {
        BigDecimal total[] = new BigDecimal [select.length];
        BigDecimal sum = new BigDecimal("0.00");
        sum = sum.add(new BigDecimal [total.length]);

        out.println(sum);
    }
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T21:37:07.130

假设您要添加一个`Strings`包含有效数字的数组，您可以这样做：

```
BigDecimal sum = BigDecimal.ZERO;
for (int i = 0; i < select.length; i++) 
{
   sum = sum.add(new BigDecimal(select[i]));
}
out.println(sum); 
```

该数组`total[]`几乎是多余的。您可以将`sum`声明`out.println(sum);`移出循环。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T21:37:22.717

它不起作用的原因是因为您在创建最终*sum*时没有正确添加您在*select*数组中的内容。像这样的东西会起作用：

 *```
String select[] = request.getParameterValues("id"); 
if (select != null && select.length != 0)
{
    BigDecimal sum = BigDecimal.ZERO;   
    for (int i = 0; i < select.length; i++) 
    {
        try{
            sum = sum.add(new BigDecimal(select[i]));
        }catch(NumberFormatException nxe){
            //Handle your exception
        }
    }
   out.println(sum);
} 
```*

# c# - 如何仅复制句子的一部分并将其放在文本控件上？

> ID：12556401
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:26:42.123
> 
> 标签：c#, html, parsing

好的，所以关闭一个网站（我不拥有，所以我不能修改它），我有这个：

```
<body onload="do_cd();">
<div id="main_container">
<div id="main_content">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="well">
<div class="row-fluid">
<div class="span6">
<p>
<b> 
```

然后是所有结束标签。

在那个`<b>`部分，有文字。如何在其中提取该文本并使用它设置一个字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:57:16.617

好的，所以我联系了一个我认识的人，他告诉我如何为此目的：

```
string DownloadFileName = Regex.Match(PageSource, DownloadFileLink + "\">(.*?)</a></li></div></ul>").Groups(1).Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:33:03.857

我建议使用[HTML Agility Pack。](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)它可以完美地完成工作并且非常强大。

# python - 如何在 Python 中解决此字符串问题？

> ID：12556402
> 
> 赞同：0
> 
> 时间：2012-09-23T21:26:50.800
> 
> 标签：python, string, loops

我正在尝试在某些单词中添加带有元音的文本（不是像 ie 或 ei 这样的连续元音），例如：

词：“奇怪”

在元音之前添加的文本：'ib'

结果：'wibeird'

因此，在元音“e”之前添加了文本“ib”。请注意它没有用 'ib' 替换 'i'，因为当元音是连续的时，我不希望它添加文本。

但是，当我这样做时：

词：“狗”

在元音之前添加的文本：'ob'

结果：'doboog'

正确的结果应该是：'dobog'

我一直在尝试调试我的程序，但我似乎无法弄清楚逻辑以确保它正确打印“wibeird”和“dobog”。

这是我的代码，先用 'weird.

```
first_syl = 'ib'
word = 'weird'

vowels = "aeiouAEIOU"
diction = "bcdfghjklmnpqrstvwxyz"
empty_str = ""
word_str = ""
ch_str = ""
first_vowel_count = True

for ch in word:
    if ch in diction:
        word_str += ch
    if ch in vowels and first_vowel_count == True:
        empty_str += word_str + first_syl + ch
        word_str = ""
        first_vowel_count = False
    if ch in vowels and first_vowel_count == False:
        ch_str = ch
    if word[-1] not in vowels:
        final_str = empty_str + ch_str + word_str 

print (final_str) 
```

我正在使用 Python 3.2.3。另外我不想使用任何导入的模块，试图这样做以了解python中字符串和循环的基础知识。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:31:59.770

你考虑过正则表达式吗？

```
import re

print (re.sub(r'(?<![aeiou])[aeiou]', r'ib\g<0>', 'weird')) #wibeird
print (re.sub(r'(?<![aeiou])[aeiou]', r'ob\g<0>', 'dog')) #dobog 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T23:48:08.617

不必要时不要使用正则表达式。有一句名言是这样说的

> 有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。

这可以通过基本的 if-then 语句轻松解决。这是一个注释版本，解释了所使用的逻辑：

```
first_syl = 'ib' # the characters to be added
word = 'dOg'     # the input word

vowels = "aeiou" # instead of a long list of possibilities, we'll use the 
                 # <string>.lower() func. It returns the lowercase equivalent of a 
                 # string object.
first_vowel_count = True # This will tell us if the iterator is at the first vowel
final_str = ""           # The output.

for ch in word:
    if ch.lower() not in vowels:     # If we're at a consonant, 
        first_vowel_count = True     # the next vowel to appear must be the first in 
                                     # the series.

    elif first_vowel_count:          # So the previous "if" statement was false. We're 
                                     # at a vowel. This is also the first vowel in the 
                                     # series. This means that before appending the vowel 
                                     # to output, 

        final_str += first_syl       # we need to first append the vowel-
                                     # predecessor string, or 'ib' in this case.
        first_vowel_count = False    # Additionally, any vowels following this one cannot 
                                     # be the first in the series.

    final_str += ch                  # Finally, we'll append the input character to the 
                                     # output.
print(final_str)                     # "dibOg" 
```

# scala - Scala Lift - 保护文件免遭盗链的强大方法

> ID：12556407
> 
> 赞同：4
> 
> 时间：2012-09-23T21:27:56.867
> 
> 标签：scala, lift, hotlinking

我正在尝试实施一种方法来停止热链接和/或未经授权访问我的应用程序中的资源。

我尝试添加的方法是我以前在 PHP 应用程序中使用过的方法。基本上，第一次调用页面时会设置会话。图像通过使用会话值作为参数的图像标签添加到页面：

```
<img src="/files/image/image1.jpg?session=12345" /> 
```

当请求图像时，脚本会检查会话是否已设置并与提供的值匹配。如果不满足条件，则服务页面返回 null。在代码的最后，我取消了会话，因此来自页面范围之外的进一步请求将返回 null。

在电梯框架内，这种方法的最佳实施是什么？

在此先感谢您的帮助，非常感谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T08:52:34.027

你可以使用 a`SessionVar`来达到这个目的。在`SessionVar`您存储 a`Map[SessionImageId, RealImageId]`并初始化 Session 时（即首次加载页面时），您将生成一些随机`SessionImageId`s，您将映射到真实图像 ID。在您的 html 中，您只公开阴影`SessionImageId`，因此没有人可以从 id 追溯图像。当请求图像时，您只需在`Map`.

信息：[探索电梯](http://exploring.liftweb.net/master/index-3.html#sec%3aSession-and-Request)，[电梯维基](https://www.assembla.com/spaces/liftweb/wiki/Managing_State)

当然，如果隐藏 id 并不重要，您可以简单地使用`SessionVar[Boolean]`.

# php - ajax 请求图像正在闪烁

> ID：12556416
> 
> 赞同：5
> 
> 时间：2012-09-23T21:28:26.323
> 
> 标签：php, jquery, mysql, ajax, image

我有一个基本的 ajax 请求，现在将其设置为 3 秒。会更高，但我想解决每次请求发生时发生的问题。出于某种原因，每张图片（存储在数据库中 - 不是很多，都是缩略图）它们都会闪烁。

有没有办法绕过获取请求上闪烁的图像？

```
$(document).ready(function(){
   var ajaxDelay = 3000;
   setInterval(function(){
    $('#timedContainer').load('jquery_timed.php');   
    }, ajaxDelay);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:45:02.793

据我所知，您必须在显示图像之前预加载/缓存图像，以避免闪烁。[这](https://stackoverflow.com/a/476681/1091745)是有关如何执行此操作的另一个答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:53:47.307

您可以使用两个图像，第一个引用现有的 img，不需要太多时间来加载，第二个是真实的 img。真实的img可以被隐藏或者它们的大小可以是1*1px。

```
<img id="IMG1" src="Some_light_IMG" >
<img id="IMG2"src="heavy_IMG" style="display:none;" onLoad="JavaScript:$('#IMG1').hide(); $('#IMG2').show()"> 
```

# scala - 如何在 slick 中访问多个结果集？

> ID：12556417
> 
> 赞同：1
> 
> 时间：2012-09-23T21:28:29.477
> 
> 标签：scala, jdbc

Slick 如何处理返回多个结果集的查询？

例如，如果我想使用`sp_help someTableName`

这将返回许多结果集。我可以得到第一个结果集，只需使用`scala.slick.jdbc.StaticQuery.queryNA[Tuple4[String, String, String,String]]("sp_help tblInbox_membership").first()`

如何获得第二个结果集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T10:54:18.147

您必须使用 Sybase 或 SqlServer。

我不熟悉 Slick（还），但是`ResultSet`从 JDBC 中的语句访问后续 s 的方法是调用`Statement.getMoreResults()`, then if that succeeds `Statement.getResultSet()`。Slick 为您提供了一个 Statement 对象`Session.withStatement`，因此您至少可以使用 JDBC api 来获取您的结果集，或者如果有办法将 ResultSet 提供给 Slick。

# javascript - js 验证只运行一次

> ID：12556419
> 
> 赞同：2
> 
> 时间：2012-09-23T21:28:49.597
> 
> 标签：javascript, jquery, validation

我在下面的代码中遇到问题，如果我在其中输入了无效的电子邮件地址，它将第一次正确显示 signUpWarning 警报，但如果我关闭该框并尝试相同的无效电子邮件，它将不会弹出。有任何想法吗？

```
 $(document).ready(function() {

    //if submit button is clicked
    $('#submit_btn').click(function(e) {
        e.preventDefault();
        var email = $('#email').val();
        if (!is_valid_email(email)){
            $("#signUpWarning").show();
        }else{

            $.ajax({
                url: "process.php",
                type: "post",
                data: "email=" + email,
                success: function() {
                    $("#signUpWarning").hide();
                    $("#signUpAlert").show();
                }
            });
        }
    });
});

function is_valid_email (email)
{
    return /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(email);
} 
```

警告框的代码是：

```
 <div class="alert alert-block alert-error hide" id="signUpWarning"><!--Use: $("#signUpWarning").show(); to show this alert-->
    <a class="close" data-dismiss="alert">×</a>
    <h5 class="alert-heading">Sorry!</h5>&nbsp;Your e-mail address was not valid, please try again.
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T01:13:38.557

检查您在关闭警报时是否没有从 DOM 中删除元素。

`console.log($("#signUpWarning"));`之前`$("#signUpWarning").show();`应该有助于确定是否发生了这种情况。

# c++ - 在 BGL 中恢复 a-star 搜索

> ID：12556420
> 
> 赞同：5
> 
> 时间：2012-09-23T21:28:54.177
> 
> 标签：c++, a-star, boost-graph

我在部分（？）隐式的图上运行 astar 算法 - 它是从大型分页数据源构建的，但图是持久的。每当 astar 算法到达未完全分页的区域时，我都需要在图形的新部分中处理分页 - 理想情况下，无需完全重新开始 astar 搜索。

我尝试了几种解决方案，但遇到了一些障碍，我想知道我是否遗漏了一些明显的东西，或者只是错误地解决了问题。

我目前正在使用 boost 1.45，但计划升级到 1.51。

首先，我尝试修改 astar 访问者，以便当它确定需要分页新数据时，它会调用图形上的一个函数并将其加载 - 但是，由于图形是 const，这是不可能的。我环顾四周，发现另一个问题[boostimplicit graph 和 astar_search_no_init](https://stackoverflow.com/questions/9547097/boost-implicit-graph-and-astar-search-no-init)引用了一个演示文稿，该演示文稿表明有人已经完成了使这成为可能的工作，但看起来实际代码不可用。

其次，我认为当我到达需要分页更多数据的地方时，我可能能够退出算法，并保存 distance_map、previous_map 和 color_map 的状态，以便我可以使用它们“恢复”使用 astar_search_no_init 进行搜索。我不确定这是否可行，因为一旦我切换到使用 astar_search_no_init，我看到虽然访问者似乎在做寻路工作，但前任地图是空的 - 因为我使用前任地图来构建路径访客完成后，我需要知道访客是如何构建路径的。

这是我的图表的定义以及我如何调用 astar_search，如果这有帮助的话。

```
typedef adjacency_list<
     vecS,         
     vecS,        
     undirectedS, 
     VertexInfo,        //contains geographic location     
     EdgeInfo,          //contains weight information             
     no_property,     
     setS>            
        BoostGraph;
...
ColorMap cmap = get(vertex_color_t, myGraph);           
astar_search(
     myGraph, 
     source,
     distance_heuristic(myGraph, destination), //geometric distance heuristic
     predecessor_map(&srcPredmap[0]).
     distance_map(&distMap[0]).
     color_map(cmap).
     visitor(astar_goal_visitor<vertex_descriptor>(destination, this)). //throws an exception when it finds the goal
     weight_map(make_function_property_map<edge_descriptor>(  //copied make_function_property_map functionality from boost 1.51 since I can't upgrade just yet
        EdgeWeightAdjuster(&myGraph, weightFactors))));       //modifies edge weights based on weightFactors construct 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T04:23:58.483

您写道：“但是，由于图形是 const，所以这是不可能的……”那么简单的 CAST（事件是旧的 C-cast）呢？您应该至少尝试一下这个选项。修改图可能会使迭代器等无效。这是真的。尽管如此，您仍然应该尝试。

“技术常数”和“概念常数”是有区别的。在你的情况下，你只会打破技术，而不是概念。

# c++ - 如何确定某个文件对于我在 *nix 上的进程是否为只读文件？

> ID：12556424
> 
> 赞同：0
> 
> 时间：2012-09-23T21:29:18.647
> 
> 标签：c++, linux, file-io

使用 stat 函数，我可以获得以下内容的读/写权限：

*   所有者
*   用户
*   其他

……但这不是我想要的。我想知道我的进程（即我正在编写的应用程序）的文件的读/写权限。所有者/用户/其他只有在我知道我的进程是否作为文件的所有者/用户/其他运行时才有帮助......所以也许这就是解决方案，但我不确定到达那里的步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:32:01.000

使用`getuid()`/`geteuid()`确定进程的用户 ID，同样使用`getgid()`/确定`getegid()`组 ID。然后，您可以与文件的所有者/组（您从`stat`or获得`lstat`）进行比较并交叉引用权限位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T21:34:53.237

你不想用`stat()`这个。您想使用`access()`from `<unistd.h>`：

```
char const* name = "file";
if (access(name, R_OK)) {
    std::cout << "'" << name << "' is readable\n";
}
if (access(name, W_OK)) {
    std::cout << "'" << name << "' is writable\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:33:49.707

像这样的东西：

```
if ( access( filename, W_OK )) { /* writable */ } 
```

见[`access(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/access.2.html)。

# ruby-on-rails - 拆分大型控制器文件的最简单方法

> ID：12556427
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:29:30.733
> 
> 标签：ruby-on-rails

我有一个太大的 Rails 控制器文件（~900 行 - api_controller）。我想像这样拆分它：

```
api_controller.rb
api_controller_item_admin.rb
api_controller_web.rb 
```

我不想分成多个控制器。这样做的首选方法是什么？我可以只要求最后的新零件吗？喜欢：

```
require './api_controller_item_admin'
require './api_controller_web' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:37:15.553

您始终可以重构您认为不只属于一个控制器的功能，以在`lib`目录中的某处分隔文件。然后，您可以使这些文件成为自动必需的，并且您可以在应用程序的任何位置使用它们的所有功能。就是这样：

```
# in [config/application.rb]
config.autoload_paths += %W(#{config.root}/lib) 
```

我的建议：不要考虑将一个巨大的控制器分成更小的块，而是折磨你的大脑并强迫它认为这个问题是将一个不完全属于你的控制器的功能提取到其他文件中。

# php - Foreach 循环运行 n 次

> ID：12556429
> 
> 赞同：-4
> 
> 时间：2012-09-23T21:29:51.217
> 
> 标签：php, loops, foreach

```
foreach($CarAdList as $CarAd)
{
    echo($msg .= '<tr><td>'.$CarAd->getCarAdID().'</td><td>' .$CarAd->getBrandText().'</td><td>' .$CarAd->getDescription(). '</td><td><a href="status.php?id='.$CarAd->getCarAdID().'"><img src="../images/active.png" /></a></td><td><img src="../images/delete.png" width="30px" /></td></tr>');
} 
```

例如，行数=38

n=行数*行数--

它正在运行 n 次

所以它的显示

```
5
5
4
5
4
3
5
4
3
2
5
4
3
2
1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:39:57.467

`echo($msg .= 'somecontent')`是一个非常奇怪的结构。要么你想连接值并在最后输出它，要么你立即输出。

```
foreach($a as $b) {
   echo $b;
} 
```

或者

```
$var = '';
foreach($a as $b) {
   $var .= $b;
}
echo $var 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:38:29.457

该循环仅运行请求的次数，但您的输出不匹配。那是因为您要同时向其中添加`$msg`文本`echo`。

要么`$msg`在循环中构造并稍后回显它，要么在不连接先前结果的情况下回显，如下所示：

```
foreach($CarAdList as $CarAd)
{
    echo '<tr><td>'.$CarAd->getCarAdID().'</td><td>' .$CarAd->getBrandText().'</td><td>' .$CarAd->getDescription(). '</td><td><a href="status.php?id='.$CarAd->getCarAdID().'"><img src="../images/active.png" /></a></td><td><img src="../images/delete.png" width="30px" /></td></tr>';
} 
```

# text - 禁用多行文本框中的插入行

> ID：12556432
> 
> 赞同：0
> 
> 时间：2012-09-23T21:30:01.640
> 
> 标签：text, textbox, locking, multiline

我的网页有一个多行文本框。当用户登录并输入文本并按“保存”按钮时，数据将被保存。然后，下次当同一个用户登录并搜索数据时，我希望他只编辑多行文本框中的新文本，而不是删除或替换以前输入的文本。

有没有办法让多行文本框锁定插入的行或插入的文本并只允许添加文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:34:19.130

如果通过文本框您的意思是“textarea”，那么它要么被禁用，要么被启用，它不能同时是两者。

您需要使用诸如 JavaScript 之类的客户端脚本语言来完成您所追求的工作。

您可以简单地将文本放入 HTML 而不是放入 Textarea，这样他们可以看到但不能更改它。

# python - 有没有办法在 App Engine 中实现长时间运行的事务？

> ID：12556433
> 
> 赞同：1
> 
> 时间：2012-09-23T21:30:03.000
> 
> 标签：python, google-app-engine, transactions, google-cloud-datastore, long-running-processes

我有一个函数可以发出许多 HTTP 请求来收集数据并将其存储在数据存储中。所有调用都必须成功，否则一切都必须回滚。执行时间接近 10 分钟。应用引擎上的最大交易期限似乎是默认的 60 秒。

有没有办法增加这一点，从而使函数具有事务性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:45:48.867

看起来这是不可能的。从文档：

> 在因错误中止之前等待 Datastore 返回结果的最长时间（以秒为单位）。接受整数或浮点值。**不能设置为高于默认值（60 秒），但可以向下调整以确保特定操作快速失败**（例如，向用户返回更快的响应、重试操作、尝试不同的操作或添加对任务队列的操作）。

[https://developers.google.com/appengine/docs/python/datastore/functions#create_transaction_options](https://developers.google.com/appengine/docs/python/datastore/functions#create_transaction_options)

但是，当且仅当事务成功完成时，您可以触发任务（如果有任何用处）。

[https://developers.google.com/appengine/docs/python/datastore/transactions#Transactional_Task_Enqueuing](https://developers.google.com/appengine/docs/python/datastore/transactions#Transactional_Task_Enqueuing)

> 您可以将任务作为 Datastore 事务的一部分加入队列，这样该任务仅在事务成功提交的情况下才会加入队列并保证加入队列。如果事务未提交，则保证不会将任务排入队列。如果事务确实被提交，则保证任务被排队。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:47:54.983

在前端实例中没有。

您需要为此旋转一个后端实例： [https ://developers.google.com/appengine/docs/python/backends/overview](https://developers.google.com/appengine/docs/python/backends/overview)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:47:55.553

对于 10 分钟的请求，您需要使用后端

[后端（Python）](https://developers.google.com/appengine/docs/python/backends/)

本参考介绍了如何在 Python 中使用 App Engine 后端。后端是特殊的 App Engine 实例，它们没有请求期限、更高的内存和 CPU 限制以及跨请求的持久状态。它们由 App Engine 自动启动，可以长时间连续运行。每个后端实例都有一个用于请求的唯一 URL，您可以跨多个实例对请求进行负载平衡。

后端可以处理来自用户或应用程序其他部分的 HTTP 请求，在后台连续启动和运行，或者由任务队列任务或 Cron 作业驱动。上面的链接介绍了如何配置后端、使用它们的最佳做法以及 App Engine 如何为它们计费。

# core-data - WWDC 2012 会议 214 中谈到的“相关获取”是什么？

> ID：12556434
> 
> 赞同：3
> 
> 时间：2012-09-23T21:30:03.307
> 
> 标签：core-data, nspredicate

她说的是查询

```
ANY tag.searchString == "rome" AND label == "red" 
```

“作为相关提取真的更好”，如下所示：

```
ANY tag IN FETCH(%@, %@, NO) AND label == "red" 
```

但我以前从未听说过这个东西或见过这种语法，我也无法在网上找到它们。那么什么是 Correlated Fetch，我在哪里可以找到有关它的文档？

# php - 如何在mongodb索引中使用自己的时间戳

> ID：12556436
> 
> 赞同：0
> 
> 时间：2012-09-23T21:30:07.243
> 
> 标签：php, mongodb, indexing

现在，当将数据插入 Mongodb 时，它会在 _id 字段中创建具有当前时间戳的唯一值，但我想将具有自己时间戳的唯一值插入到 _id 字段中。我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:45:36.403

默认情况下，MongoDB 驱动程序（官方支持的驱动程序，无论如何）将该`_id`字段设置为`ObjectId`，一种特殊的数据类型。如果您想覆盖它，您可以将该`_id`字段设置为具有您想要的任何值的任何数据类型。

[参考](http://www.mongodb.org/display/DOCS/Object+IDs)

# vba - 在excel中动态显示文件夹中的图片

> ID：12556438
> 
> 赞同：0
> 
> 时间：2012-09-23T21:30:37.987
> 
> 标签：vba, excel

我有一些具有某些值的单元格。该值是文件夹中图片的名称。当我单击单元格“值”时，我想显示名为“值”的正确图片。我想动态地执行此操作，以便在单击具有名称值的单元格时添加图片会导致显示它。你能告诉我应该从哪里开始吗？是否有任何教程显示如何执行此操作？我发现了很多，但他们使用列表并将图片存储在 Excel 工作表中。有没有例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-07T14:06:18.410

```
Private Sub CommandButton2_Click()
           On Error Resume Next
          Dim imageFolder As String 'this is the folder where the image is located
    Dim imagePath As String

    Cells.Find("Code").Offset(1).Select
Range(Selection, Selection.End(xlDown)).Select
For Each cell In Selection
imageFolder = cell.Value
imagePath = "C:\Documents and Settings\kollol\My Documents\Quotes\Image\" & imageFolder

cell.Offset(0, 2).Select

ActiveSheet.Pictures.Insert(imagePath & "\" & "1.jpeg").Select ' here the name of the image is 1.jpg

 With Selection
.Placement = xlMoveAndSize
 .ShapeRange.LockAspectRatio = msoTrue
.ShapeRange.Width = ActiveCell.ColumnWidth
 .ShapeRange.Height = ActiveCell.RowHeight - 5
.ShapeRange.IncrementLeft 10.5
.ShapeRange.IncrementTop 4#
 End With

Next cell

End Sub 
```

# java-me - 查找在 LWUIT 资源编辑器中定义的元素

> ID：12556445
> 
> 赞同：1
> 
> 时间：2012-09-23T21:31:46.900
> 
> 标签：java-me, lwuit, lwuit-resource-editor

我正在开发一个基于 LWUIT 的应用程序，并且我已将我的应用程序分成一个表单，该表单必须访问诸如给定示例登录对话框之类的组件。

问题是我似乎找不到访问（或初始化）在当前显示的表单之外定义的容器或对话框的方法，因为代码如下：

`findLoginDialog(Display.getInstance().getCurrent()).show();`

不起作用。我还尝试查看继承的方法，但发现这`showContainer(...)`也需要源组件。

是否有可能做到这一点或任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T14:25:54.620

您需要的是创建一个新的`Component`. 方法 findSomething 用于`Components`您在资源编辑器中创建的。如果要创建不在资源编辑器界面中的新对象，则必须使用

```
createContainer(Resources res, "Name in the Resource editor of this Component") 
```

# jquery - Jquery StopPropagation 在 Firefox 中不起作用

> ID：12556452
> 
> 赞同：4
> 
> 时间：2012-09-23T21:32:08.063
> 
> 标签：jquery, firefox, dom, twitter-bootstrap, stoppropagation

我在 Safari 和 Chrome 上有这段代码，但在 Firefox 中没有。Firefox 的 StopPropagation() 有问题吗？

```
$(function() {
    // Setup drop down menu
    $('.dropdown-toggle').dropdown();

    // Fix input element click problem
    $('.login-menu form').click(function(e) {
        alert(e.isPropagationStopped());
        e.stopPropagation();
        alert(e.isPropagationStopped());
    });
});​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T21:46:02.933

我不知道您的 HTML 看起来如何，但`stopPropagation`在 FireFox 中可以正常工作。

我认为您的期望可能不正确。

根据[**stopPropagation()的文档**](http://api.jquery.com/event.stopPropagation/)

> **event.stopPropagation()**
> 防止事件在 DOM 树中冒泡，防止任何父处理程序收到事件通知。

例如，假设 HTML 是这样的：

```
<div id="parent">
    <div class="login-menu">click anywhere</div>
</div> 
```

此代码工作正常，点击事件没有冒泡：

```
$(function() {
    // Fix input element click problem
    $('.login-menu').click(function(e) {
        alert(e.isPropagationStopped());
        e.stopPropagation();
        alert(e.isPropagationStopped());
    });

    $("#parent").click(function(e){
        alert("parent received click");
    });
});​ 
```

### [演示](http://jsfiddle.net/FranWahl/KUTxS/)- 在 FF 中工作 - 不会冒泡事件

注释掉`e.stopPropagation();`DEMO 中的行，正如预期的那样，事件会冒泡，显示来自父级的警报。

### 您的预期行为是什么？

你没有具体说明你期望发生什么。

例如，如果您希望触发事件的默认操作 no，您可以使用[**preventDefault()**](http://api.jquery.com/event.preventDefault/)

> **event.preventDefault()**
> 如果调用该方法，则不会触发事件的默认动作。

如果您想同时涵盖两者，请防止默认操作并防止事件冒泡，您可以同时调用两者或仅`return false`在方法结束时使用。

如果您可以详细说明您想要实现的目标，我们可以更具体地建议适合您的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-03T00:13:04.093

我遇到了同样的问题，并在我意识到我犯了几个“分心错误”后立即修复它，可能对某些人有帮助：

1）**记住“事件”参数**：触发事件时执行的函数（即作为参数传递给 $('.login-menu form').click() 的函数）应该接受代表事件的参数（按照惯例，在大多数教程中称为“事件”或“e”）。Chrome 允许您忘记它，而 Firefox 需要它。

2)**记得清除 Firefox 的缓存**(CTRL + F5)：如果像我一样禁用 Chrome 的缓存以进行开发（工具 -> Javascript 控制台 -> 选项 -> 禁用缓存（当 DevTools 打开时）），但不要这样做在 Firefox 中也是如此（因为这样做有点棘手，而且我很懒），记得使用 CTRL + F5 重新加载页面

它现在就像一个魅力，对我来说......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-31T18:57:34.830

这对我有用（在所有浏览器中，无论是否可以传递事件），我正在使用谷歌地图标记，并且无法将事件传递给方法：

```
var stopPropagation = function (event) {
    if (event && event.stopPropagation) {
        event.stopPropagation();
    } 
    else if (window.event) {
        window.event.cancelBubble = true;
    }
    else if (window.$.Event.prototype) {
        window.$.Event.prototype.stopPropagation();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T21:40:25.117

`stopPropagation`用于阻止事件在父元素上触发。

有关其工作原理的示例，请参见[http://jsfiddle.net/Accus/2/ 。](http://jsfiddle.net/Accus/2/)

HTML：

```
<body>
    <div>
        <span>Test</span>
    </div>​
<body> 
```

JS：

```
$('span').click(function(e) {
    console.log('span');
    console.log(e.isPropagationStopped());
});

$('div').click(function(e) {
    console.log('div');
    console.log(e.isPropagationStopped());
    e.stopPropagation();
    console.log(e.isPropagationStopped());
});

$('body').click(function(e) {
    console.log('body');
    console.log(e.isPropagationStopped());
});

​
​ 
```

# c++ - 无法使用 wxsmith 获得指向 wxwidget 对象的指针

> ID：12556454
> 
> 赞同：1
> 
> 时间：2012-09-23T21:32:40.907
> 
> 标签：c++, wxwidgets

直截了当：我正在学习 wxsmith 和 wxwidgets 工具包，我创建了一些包含一个按钮和 2 个静态文本字段的基本 GUI。到目前为止，GUI 编译正常。我的框架名称是 proba2Frame，然后我添加了我自己的函数，它不是任何类的成员，但我在 proba2Frame 的头文件中声明我的函数是一个朋友。下面是我的函数代码：

```
 wxStaticText * dawajpointera()
    {
    wxStaticText * text;
    text = proba2Frame.wxStaticText.StaticText1;
    return text;
    } 
```

我收到错误：

```
expected primary-expression before ‘.’ token 
```

如果我的解决方案完全错误，我到底做错了什么以及如何获得指针 StaticText ？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T23:41:44.990

你听起来像是`proba2Frame`继承wxFrame的类的名称？

如果是这样，您就会遇到问题，因为您还没有创建 的实例`proba2Frame`，并且您正在尝试访问其中尚未构建的部分。您的主框架类只是您的 GUI 的模板，而不是 GUI 本身。

最好的解决方法可能是将实例`proba2Frame`作为参数-

```
wxStaticText* dawajpointera(proba2Frame *frame)
{
    return frame->StaticText1;
} 
```

当然，该函数本身有点毫无意义，但我假设您之后将对指针做更多的事情，并且`text`为了简洁起见，希望将其设置为函数内命名的指针。

```
void func(proba2Frame *frame)
{
    wxStaticText *text = frame->StaticText1;
    // Do something with text
} 
```

但是，如果您这样做，请考虑将函数设为`proba2Frame`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:45:08.517

wxStaticText 是 wxWidgets 类的名称。你不应该命名你的框架'wxStaticText'的属性。尽管您发布了代码，但我怀疑您是否真的做了如此可怕的事情。我猜你可能打算写的是：

```
text =  proba2Frame.StaticText1; 
```

我猜这个属性的名字是StaticText1，一个指向wxStaticText 类实例的指针。

# matlab - 在 Matlab 中按组将 1D 转置为 2D

> ID：12556455
> 
> 赞同：0
> 
> 时间：2012-09-23T21:32:45.787
> 
> 标签：matlab, vector, matrix

我需要根据矩阵另一列中相等的一组值将向量转置为二维矩阵。例如：

```
1 x1
1 x2
1 x3
1 x4
2 x5
2 x6
2 x7
2 x8 
```

应该看起来像：

```
x1 x2 x3 x4;
x5 x6 x7 x8; 
```

这与您在 SAS 中使用 proc tabulate 执行的过程相同。Reshape 对我不起作用，因为它没有转置它，并且尝试 permute 也没有运气。除了必须使用 find、transpose 和 vertcat 对其进行编程之外，是否有任何内置命令可以执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T00:56:34.053

如果由于某种原因您想避免`reshape`，尽管注释中的解决方案会起作用，但您可以使用`sub2ind`来获取新矩阵 V 的线性索引，因为您的第一列将始终提供新行子：

```
X = [[1,1,1,1,2,2,2,2]' (1:8)'];
subs = X(:,1);

M = length(unique(subs)); % count unique ids
N = length(X)./M; % Problem assumption: M sets of size N (MxN=length(X))

V = zeros(M, N);
i = sub2ind([M, N], subs, repmat(1:N,1,M)');
V(i) = X(:,2); 
```

根据您的规格，只要 中存在相同数量的唯一元素，上述内容就可以工作`X`，因此您可以形成一个`MxN`矩阵。

# php - 随机化多维数组中的数据（第二层）

> ID：12556458
> 
> 赞同：0
> 
> 时间：2012-09-23T21:33:18.460
> 
> 标签：php, arrays

我有一个像这样的多维数组：

```
Array
(
    [site1] => Array
        (
            [0] => Array
                (
                    [0] => data
                    [1] => data
                    [2] => data
                    [3] => data
                )

            [1] => Array
                (
                    [0] => data
                    [1] => data
                    [2] => data
                    [3] => data

                )

            [2] => Array
                (
                    [0] => data
                    [1] => data
                    [2] => data
                    [3] => data

                )

    [site2] => Array
        (
            [0] => Array
                (
                    [0] => data
                    [1] => data
                    [2] => data
                    [3] => data
                )

            [1] => Array
                (
                    [0] => data
                    [1] => data
                    [2] => data
                    [3] => data
                )

            [2] => Array
                (
                    [0] => data
                    [1] => data
                    [2] => data
                    [3] => data
                )
         )
) 
```

我正在尝试随机化每个站点（[site1]、[site2]）的数据，但不要在站点之间混合数据。所以这就像第二次轮胎随机化。

例如，在随机化之后，[site1] 的位置 [0] 将具有不同的数据，可能是来自较早位置 [3] 的数据。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:38:18.333

您将[函数](http://php.net/shuffle)*映射*到数组：[`shuffle`](http://php.net/shuffle)

```
$shuffle = function($array) {
    $r = shuffle($array);
    return $array;
};

$sites = array_map($shuffle, $sites); 
```

或者：

```
foreach ($sites as &$site) shuffle($site);
unset($site); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:37:40.327

```
foreach($sites as $i => $site) {
   shuffle($sites[$i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:50:41.373

另一种（不如随机播放）方式;-)

```
foreach ($site as $key => $data) {
  $values = array();
  $rand   = array_rand($data, count($data));
  for ($i = 0; $i < count($rand); $i++)) {
    $values[] = $site[$key][$rand[$i]];  
  }
  $site[$key] = $values;
} 
```

# javascript - Javascript（JQuery/CouchDB）函数不起作用，但仅在从按钮 onClick 调用时才起作用

> ID：12556461
> 
> 赞同：0
> 
> 时间：2012-09-23T21:33:53.977
> 
> 标签：javascript, jquery, html, couchdb

在我的 HTML 头中，我首先包含 jquery.min.js、jquery.couch.js 和 twitter-bootstrap js（按此顺序），然​​后我有一个名为 logmein() 的函数，如下所示：

```
<script>
$.couch.urlPrefix = "http://127.0.0.1:5984"
function logmein() {$.couch.login({
    name: "testuser",
    password: "test",
    success: function() { alert("Success!") },
    error: function() { alert("Login failed") }
    });
}
</script> 
```

使用硬编码的用户名和密码进行测试。

然后我有一个按钮：

```
<button id="submit" class="btn btn-primary" onClick="logmein()">Sign in</button> 
```

当我尝试单击提交时，我收到此错误：

```
jquery.couch.js:216 TypeError: 'null' is not an object (evaluating 'resp.error') 
```

但是，如果我直接在 Safari 的 Web 开发人员控制台中键入 logmein()，它就可以正常工作！我在这里做错了什么？

编辑：我认为这可能与此有关：[https](https://stackoverflow.com/a/6792725/637562) ://stackoverflow.com/a/6792725/637562虽然我不太明白为什么（据我所知，我在同一个协议/主机上运行它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:44:24.290

您可以尝试更改您的 logmein 函数以在#submit 的点击事件上运行：

```
$('#submit').click(function(){
    $.couch.urlPrefix = "http://127.0.0.1:5984";
    $.couch.login({
        name: "testuser",
        password: "test",
        success: function() { alert("Success!") },
        error: function() { alert("Login failed") }
        });
}); 
```

此外，似乎 urlPrefix 应该在 logmein() 函数内

```
function logmein()
{
    $.couch.urlPrefix = "http://127.0.0.1:5984";
    $.couch.login({
        name: "testuser",
        password: "test",
        success: function() { alert("Success!") },
        error: function() { alert("Login failed") }
        });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T13:10:28.893

“解决了”

如果其他人遇到此问题，我仍然不确定是什么导致了问题。谷歌浏览器给出了更详细的错误消息，表明违反了同源政策，尽管我不认为是这种情况。

尽管如此，还有一个更简单的解决方案，无需 Javascript：CouchDB Session API。

```
<form action="http://127.0.0.1:5984/_session/" method="post">
<input type="text" name="name">
<input type="password" name="password">
<button id="submit">Sign in</button> 
```

其中 127.0.0.1 是本地 couchdb 实例，应替换为您的 couchdb 服务器地址....

更多细节在这里：[http](http://wiki.apache.org/couchdb/Session_API) ://wiki.apache.org/couchdb/Session_API包括如何在表单提交时设置自动页面重定向。

# android - Android 从 ActivityManager.RunningTaskInfo 获取 xhdpi 图标

> ID：12556464
> 
> 赞同：2
> 
> 时间：2012-09-23T21:34:04.777
> 
> 标签：android, icons, drawable, dpi

我使用以下代码成功获取了最近的应用程序图标：

```
//app is an ActivityManager.RunningTaskInfo
//image is an ImageView
ApplicationInfo appInfo = packageManager.getApplicationInfo(app.topActivity.getPackageName(), 0);
Drawable d = packageManager.getApplicationIcon(appInfo);
image.setImageDrawable(d); 
```

但是显示的图像只有 48x48 像素。我猜这是因为我的设备是 mdpi，但是它使图标非常模糊。无论设备显示密度如何，有没有办法始终获取 xhdpi 图标？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T12:05:55.200

我认为您无法从 packageManager.getApplicationIcon(appInfo); 中获得任何其他密度图标。没有一些黑客攻击。您要么破解设备报告的屏幕 DPI，要么以某种方式让 PackageManager 相信您拥有 xhdpi 屏幕尺寸（您可以指定位图的密度，但我不知道如何将其传递给 PackageManager）。

但是，可能有一种更简单的方法来获取 xhdpi 图标（以及其他 DP 图标）。如果您可以将应用程序的 apk 下载到您的计算机并解压缩，您应该可以在其中找到可以从中获取图标的 res/drawable* 文件夹。尽管如果您在应用程序运行时以及设备上的任何应用程序都需要 xhdpi 图标，但遗憾的是，这不是您问题的解决方案。如果是后者，还要注意并非每个应用程序都有 xhdpi 资源/图标。

# c# - 如何使用类的类型作为 C# 中继承的集合属性的类型参数

> ID：12556467
> 
> 赞同：3
> 
> 时间：2012-09-23T21:34:22.577
> 
> 标签：c#, .net, inheritance, covariance, type-systems

我正在尝试创建从通用卡片类继承的各种卡片的表示形式，并且所有卡片都包含对其拥有的牌组的引用。

[我尝试按照此处](https://stackoverflow.com/questions/8007973/changing-the-type-of-a-inherited-property-to-a-inherited-type)的建议重新声明它们，但它仍然不会转换为特定的卡类型。

我目前拥有的代码是这样的：

```
public class Deck<T> : List<T> 
    where T : Card 
{
    void Shuffle()
    {
        throw new NotImplementedException("Shuffle not yet implemented.");
    }
}

public class Card
{
    public Deck<Card> OwningDeck { get; set; }
}

public class FooCard : Card
{
    public Deck<FooCard> OwningDeck
    {
        get
        {
            return (Deck<FooCard>)base.OwningDeck;
        }
        set
        {
            OwningDeck = value;
        }
    }
} 
```

我得到的编译时错误：错误 2 无法将类型转换`Game.Cards.Deck<Game.Cards.Card>`为`Game.Cards.Deck<Game.Cards.FooCard>`

还有一个警告，建议我使用新的运算符来指定隐藏是故意的。这样做会违反惯例吗？有没有更好的办法？

我对 stackoverflow 的问题是：**我想做的事情可以在 .NET 类型系统中优雅地完成吗？如果是这样，可以提供一些例子吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:41:23.130

您可以为您的卡片配备一个通用参数，该参数指定您正在使用的卡片的基类：

```
public class Card<TCard>
    where TCard : Card<TCard>
{
    public Deck<TCard> OwningDeck { get; set; }
} 
```

您的`FooCard`课程将如下所示：

```
public class FooCard : Card<FooCard> 
```

与您当前代码相比的一个优势可能是您不必重新声明该`OwningDeck`属性；它是自动输入`Deck<FooCard>`的`FooCard`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T21:43:21.810

你在这里遇到的是一个常见的设计错误，你试图将属性“OwningDeck”专门化为 FooCard，这是“隐藏”“OwningDeck”的基本声明。您所做的选择，将“OwningDeck”放在 Card 类中，旨在确保所有类型的 Card 都具有 OwningDeck 属性 - 这也意味着该属性必须是最低公分母类型（即“Deck '）。

因此，您不能在派生类型（即 FooCard）中重新声明此属性，因为您随后试图更改属性的类型 - 一个糟糕的设计选择 - 并且在 .net 中实际上不受支持。

您收到警告的原因是，该属性`Deck<FooCard> OwningDeck`隐藏了该属性`Deck<Card> OwningDeck`。如果有人将变量转换为 type `Card`，然后访问该`OwningDeck`属性，他们将从 OwningDeck 获取该属性。但是，如果他们将其强制转换为`FooCard`然后访问相同的属性，他们将获得从`Deck<FooCard> OwningDeck`. 编译器不知道这些可能正在访问同一个变量，但这是非常危险的，因为程序员不会期望您的代码有这种行为。

至于更好的实现**，我看到 OR Mapper**在实际实现中击败了我。他说了什么；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T21:45:15.350

`Card`如果您愿意使类通用，您可以实现接近您正在寻找的东西，如下所示：

```
public class Deck<T> : List<Card<T>> 
    where T : Card<T>
{
    void Shuffle()
    {
        throw new NotImplementedException("Shuffle not yet implemented.");
    }
}

public class Card<T> where T : Card<T>
{
    public Deck<T> OwningDeck { get; set; }
}

public class FooCard : Card<FooCard>
{
} 
```

原始代码不起作用的原因是 a`Deck<Card>`与 a 不同`Deck<FooCard>`，反之亦然。想象一下：

```
Deck<Card> deck = new Deck<Card>();
deck.Add(new BarCard());
Deck<FooCard> fooDeck = (Deck<FooCard>)deck;  // What should happen here?
FooCard foo = deck[0];                        // or here? 
```

所以你需要问自己，“为什么`Card`班级会在意哪个牌组拥有它？” 在我知道的大多数程序中，卡片没有理由知道这些细节。如果有一个特定的原因你想让它知道一些关于它的东西`Deck`，它真的需要知道`Deck`多少？例如，一个牌组是否有可能容纳各种不同`Deck`类型的牌？当您从牌库中取出卡片时，您真的需要知道它们与您当前的卡片类型完全相同吗？

一旦你回答了这些问题，你就会更有准备地决定是否`OwningDeck`应该是一个`Deck<T>`或者可能是某个`Deck<T>`实现的协变或逆变接口，或者它甚至是否属于`Card`类。

# haskell - 在 Haskell 中很好地打印/显示二叉树

> ID：12556469
> 
> 赞同：20
> 
> 时间：2012-09-23T21:34:28.557
> 
> 标签：haskell, tree, binary-tree, show

我有一个树数据类型：

```
data Tree a b = Branch b (Tree a b) (Tree a b) | Leaf a 
```

...而且我需要使它成为 的实例`Show`，而不使用`deriving`. 我发现很好地展示一个带有两片叶子的小树枝很容易：

```
instance (Show a, Show b) => Show (Tree a b) where
   show (Leaf x) = show x
   show (Branch val l r) = " " ++ show val ++ "\n" ++ show l ++ "  " ++ show r 
```

但是如何将一个好的结构扩展到任意大小的树呢？似乎确定间距需要我知道有多少叶子在最底部（或者可能总共有多少叶子），这样我就可以在那里分配我需要的所有空间，然后继续工作。 ' 我可能需要调用一个大小函数。我可以看到这是可行的，但这会让它变得更难吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-23T23:23:21.303

您可以研究[`drawTree`](http://hackage.haskell.org/package/containers-0.5.7.1/docs/src/Data.Tree.html#drawTree)基本[`Data.Tree`](http://hackage.haskell.org/packages/archive/containers/0.3.0.0/doc/html/src/Data-Tree.html)模块中的功能。只是无耻地导入它会给你这样的东西：

```
import Data.Tree hiding (Tree )
data Tree a b = Branch b (Tree a b) (Tree a b) 
              | Leaf a deriving (Eq,Ord,Show)

toDataTree (Leaf a) = Node a []
toDataTree (Branch b cs ds) = Node b [toDataTree cs, toDataTree ds]

d = Branch "1" (Branch "11" (Leaf "111") (Leaf "112")) 
               (Branch "12" (Leaf "121") (Leaf "122"))

e = toDataTree d
f = putStrLn $ drawTree e

{-
*Main> f
1
|
+- 11
|  |
|  +- 111
|  |
|  `- 112
|
`- 12
   |
   +- 121
   |
   `- 122
-} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-10-18T05:42:40.347

使用应用程序的链接到`Data.Tree`源我想出了这个。我想写自己的，这样我就可以了解更多。源代码中的`drawTree`方法被推广到具有多个子节点的节点；我的只是用于二叉树。

注意：我的树定义与 OP 的有点不同。我不太明白`a`type 参数是做什么用的，但方法应该还是一样的

```
data Tree a
    = Branch (Tree a) a (Tree a)
    | Leaf

prettyprint (Leaf)
    = "Empty root."
-- unlines concats a list with newlines
prettyprint (Branch left node right) = unlines (prettyprint_helper (Branch left node right n h))

prettyprint_helper (Branch left node right)
    = (show node) : (prettyprint_subtree left right)
        where
            prettyprint_subtree left right =
                ((pad "+- " "|  ") (prettyprint_helper right))
                    ++ ((pad "`- " "   ") (prettyprint_helper left))
            pad first rest = zipWith (++) (first : repeat rest)
prettyprint_helper (Leaf)
    = [] 
```

这会产生一棵树

```
4
+- 8
|  +- 9
|  |  +- 10
|  `- 6
|     +- 7
|     `- 5
`- 2
   +- 3
   `- 1 
```

* * *

我只是想解释一下这个`pad`函数是如何工作的，因为这对我来说是最难理解的（`shift`在源代码中调用）。

首先，[`zipWith`](http://zvon.org/other/haskell/Outputprelude/zipWith_f.html)应用一个函数（第一个参数）来“加入”两个列表。`zipWith (+) [1, 2, 3] [4, 5, 6]`返回`[5, 7, 9]`。当列表之一为空时，它会停止。`zipWith`仅应用于一个列表返回一个可应用于压缩第二个列表的函数（我相信这被称为[函数 currying](http://www.haskell.org/haskellwiki/Currying)）。这是该函数的更简单版本`pad`：

```
> let pad = zipWith (++) (repeat "   ")
> :type pad
pad :: [[Char]] -> [[Char]]
> pad ["1", "2", "3"]
["   1", "   2", "   3"] 
```

注意：1.其中一个列表是无限的（`repeat " "`），但是当其中一个列表为空时它会停止压缩 2.`zipWith`只接受一个函数和一个列表。`pad`然后是一个函数，它接受字符/字符串列表并返回字符/字符串列表的压缩列表。因此，您申请`pad`一个列表以将其与第一个列表一起压缩

现在让我们看看

```
prettyprint_subtree left right =
    ((pad "+- " "|  ") (prettyprint_helper left))
        ++ ((pad "`- " "   ") (prettyprint_helper right)) 
```

`(pad "+- " "| ")`创建一个无限列表，如`["+- ", "| ", "| ", "| ", ...]`. `(prettyprint_helper right)`从右侧的根节点开始构建表示右侧子树的行列表。但是整棵树需要向右移动；我们通过用填充物压缩它来做到这一点。我们使用无限列表是因为我们不知道子树有多大；总会有足够`"| "`的 s 来填充额外的行（这也适用于惰性求值）。注意第一行；即子树根节点，用`"+- "`右节点的“符号”填充。

左侧几乎相同。左节点的符号是`"`- "`。唯一的其他区别是填充。`" "`而不是`"| "`. 那么为什么左节点不需要“分支”呢？好吧，您可以将其视为右侧节点*后面*（附加了填充；在左侧）到下面的左侧节点。您需要右侧后面的填充将左侧节点/子树连接到父节点。树的左侧后面没有任何东西，可能除了父树。这使我想到了最后一点；每个子树，表示为`prettyprint_helper`函数中的行列表，都会获得一个额外的填充每个父树的级别。我认为最好用一个例子来说明。

* * *

在创建上面的树时（注意，我不知道确切的执行顺序，尤其是延迟评估，但这只是为了帮助可视化它的工作原理）：

假设我们递归到`10`. 那么左边的子树和右边的子树都是空的，所以`prettyprint_helper (Branch Leaf 10 Leaf)`返回`["10"]`。

现在我们到了`9`。它的子树是：（`"9" : ([] ++ ((pad "+- " "| ") [10]))`没有左边），或`"9" : ["+- 10"]`，或：

```
9
+- 10 
```

现在我们到了`8`。`((pad "+- " "| ") (prettyprint_helper right))`创建：

```
+- 9
|  +- 10 
```

您可以自己跟踪它，但左侧是：

```
6
+- 7
`- 5 
```

哪个填充到（第一个元素`"`- "`，休息`" "`）：

```
`- 6
   +- 7
   `- 5 
```

因此，总共 8，即左侧附加到右侧，我们有：

```
8
+- 9
|  +- 10
`- 6
   +- 7
   `- 5 
```

如果我们上一步，这个`8`子树会被填充到`4`树上，你可以再次追踪另一侧来验证它是否有效。你得到

```
+- 8
|  +- 9
|  |  +- 10
|  `- 6
|     +- 7
|     `- 5 
```

最终结果如上。请记住，在整个过程中，树表示为行列表。只有在最后才与`unlines`. 也许我的图纸具有误导性，因为它可能看起来像子树作为多行字符串传递。一旦理解了这一点，就很容易像 in的函数`"|"`一样在左右节点之间添加额外的分支 ( ) 。我会让你弄清楚:)`Data.Tree``drawTree`

如果这太过分了，我深表歉意；作为初学者，我很难从源头上理解，这对我来说是一个很大的飞跃。我希望它可以帮助其他人试图解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-01-26T17:22:33.277

另一个实现：

[带解释的视频](https://www.youtube.com/watch?v=Ud-1Z0hBlB8&feature=youtu.be)

```
───"a"
    └──"b"
        └──"c"
            |                   ┌──"g"
            |               ┌──"c"
            |               |   └──"f"
            |           ┌──"a"
            |           |   |   ┌──"e"
            |           |   └──"b"
            |           |       └──"d"
            |       ┌──"x"
            |       |   |       ┌──"g"
            |       |   |   ┌──"c"
            |       |   |   |   └──"f"
            |       |   └──"a"
            |       |       |   ┌──"e"
            |       |       └──"b"
            |       |           └──"d"
            |   ┌──"f"
            └──"d"

import Data.List
data Btree a = Empty | Node a (Btree a) (Btree a) deriving Show
tr_l = Node "b" (Node "d" Empty Empty) (Node "e" Empty Empty)
tr_r = Node "c" (Node "f" Empty Empty) (Node "g" Empty Empty)
tr = Node "a" tr_l tr_r :: Btree String
tx = Node "x" tr tr

trr = Node "a" (Node "b" (Node "c" (Node "d" Empty (Node "f" Empty tx)) Empty) Empty) Empty:: Btree String

data ParentDir = PLeft | PRight | NoParent deriving (Show,Eq)
type ParentPos = Int
type Level = Int

dline = '|'
factor = 4

m c1 c2 = if c1 == dline then c1 else c2
zipWith' f xs [] = xs
zipWith' f [] xs = xs
zipWith' f (x:xs) (y:ys) = f x y : zipWith' f xs ys

build_line pd a pp level = foldl (zipWith' m) "" (((++"|").(flip replicate ' ') <$> (factor*) <$> pp)++[(replicate (factor*level) ' ')++cn++show a])
                           where cn = case pd of PLeft -> "└──"
                                                 PRight -> "┌──"
                                                 NoParent -> "───"

tprint :: Show a => ParentDir -> [ParentPos] -> Level -> Btree a -> [String]
tprint _ _ _ Empty = []
tprint pd pp level (Node a l r) = tprint PRight new_pp_r (level+1) r ++
                                  [build_line pd a pp level] ++
                                  tprint PLeft new_pp_l (level+1) l
                                  where new_pp_r = case pd of PRight -> pp
                                                              PLeft -> pp++[level]
                                                              NoParent -> pp
                                        new_pp_l = case pd of PRight -> pp++[level]
                                                              PLeft -> pp
                                                              NoParent -> pp

printt t = putStr $ (intercalate "\r\n" (tprint NoParent [] 0 t))++"\r\n" 
```

# ios6 - UICollectionViewCell imageView

> ID：12556470
> 
> 赞同：0
> 
> 时间：2012-09-23T21:34:37.460
> 
> 标签：ios6, uicollectionview

代码工作正常，直到我更改`UIViewController`为`tableView`to `UICollectionViewController`。

现在所有单元格都显示相同的图像，有时它会翻转为零。但是 textLabels 是可以的。

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"TourGridCell";
    TourGridCell *cell = (TourGridCell *)[collectionView dequeueReusableCellWithReuseIdentifier:CellIdentifier forIndexPath:indexPath];
    Guide *guideRecord = [self.fetchedResultsController objectAtIndexPath:indexPath];

    cell.titleLabel.text = [guideRecord.name uppercaseString];

    cell.titleLabel.backgroundColor = [UIColor clearColor];
    if ([guideRecord.sights count] > 0) {

        if ([[guideRecord.sights objectAtIndex:0]valueForKey:@"thumbnail"]) {
            cell.imageView.image = [UIImage drawImage:[[guideRecord.sights objectAtIndex:0]valueForKey:@"thumbnail"] inImage:[UIImage imageNamed:@"MultiplePhotos"] inRect:CGRectMake(11, 11, 63, 63)];

        }else {
            cell.imageView.image = [UIImage imageNamed:@"placeholder2"];
        }

        NSMutableString *sightsSummary = [NSMutableString stringWithCapacity:[guideRecord.sights count]];
        for (Sight *sight in guideRecord.sights) {
            if ([sight.name length]) {
                if ([sightsSummary length]) {
                    [sightsSummary appendString:@", "];
                }
                [sightsSummary appendString:sight.name];

            }
        }
        if ([sightsSummary length]) {
            [sightsSummary appendString:@"."];
        }
        cell.sightsTextLabel.text = sightsSummary;
        cell.detailTextLabel.text = [NSString stringWithFormat:NSLocalizedString(@"%i", nil) , [guideRecord.sights count]];
        cell.detailTextLabel.hidden = NO;
        //        cell.textLabel.alpha = 0.7;
        NSPredicate *enabledSightPredicate = [NSPredicate predicateWithFormat:@"notify == YES"];
        NSArray *sightsEnabled = [[[guideRecord.sights array] filteredArrayUsingPredicate:enabledSightPredicate]mutableCopy];
        NSPredicate *visitedSightPredicate = [NSPredicate predicateWithFormat:@"visited == YES"];
        NSArray *sightsVisited = [[[guideRecord.sights array] filteredArrayUsingPredicate:visitedSightPredicate]mutableCopy];

        if ([sightsEnabled count] > 0)
        {
            NSLog(@"green_badge");
            cell.notifyIV.image = [UIImage imageNamed:@"green_badge"];
        }
        else if (sightsVisited.count == 0) {
            NSLog(@"new_badge");
            cell.notifyIV.image = [UIImage imageNamed:@"new_badge"];
        }
        else
        {
            cell.notifyIV.image = nil;
        }

    }
    else {
        cell.notifyIV.hidden = YES;
        //        cell.textLabel.textColor = RGB(0, 50, 140);
        cell.detailTextLabel.hidden = YES;
        cell.sightsTextLabel.text = nil;
    }

    return cell;
} 
```

在故事板中设置单元格，

```
//  TourGridCell.h
#import <UIKit/UIKit.h>

@interface TourGridCell : UICollectionViewCell
@property (weak, nonatomic) IBOutlet UILabel *titleLabel;
@property (weak, nonatomic) IBOutlet UIImageView *imageView;
@property (weak, nonatomic) IBOutlet UIImageView *notifyIV;
@property (weak, nonatomic) IBOutlet UILabel *textLabel;
@property (weak, nonatomic) IBOutlet UILabel *detailTextLabel;
@property (weak, nonatomic) IBOutlet UILabel *sightsTextLabel;

@end

#import "TourGridCell.h"

@implementation TourGridCell

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T08:51:55.213

您可能需要提供更多数据，以便其他人能够找出问题所在。我认为您已经检查过在不同的时间这被称为条件被触发，因此实际上正在实例化不同的图像并将其添加到您的 UICollectionViewCell？另外，我认为您知道 UICollectionViewCell 没有图像属性，因此您需要在其子类中添加一个属性（如果您希望轻松访问视图而无需使用其标签 ID 检索它的开销）并确保视图被添加为子视图？

我认为，鉴于您所描述的症状，如果您没有将子视图添加到 UICollectionViewCell 的 contentView，则可能会出现此类问题。Apple 的集合视图进行了各种优化以确保高性能，并且只有 UICollectionViewCell 的内容视图（它本身是 UICollectionViewCell 的子视图）的子视图将按照您的预期始终如一地绘制。

尽管根据您提供的信息，我无法确定这是否是问题的原因。

```
@implementation UICollectionViewCellSubView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        _imageView = [[UIImageView alloc] initWithFrame:frame];
        [self.contentView addSubview:_imageView];
    }
    return self;
}

- (void)prepareForReuse
{
    [super prepareForReuse];
    // ensure you do appropriate things
    // here for when the cells are recycled
    // ...

}   

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T12:36:37.257

解决方案是每次在`cellForItemAtIndexPath:`

```
cell.imageView.image = nil; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-03T04:06:56.840

如果您在单元格中进行自定义绘图，则需要通知单元格在“重用”单元格时自行“重绘”。`prepareForReuse`这可能是通过在 UICollectionViewCell 子类中实现该方法最简单的方法。

```
- (void)prepareForReuse {
    [super prepareForReuse];
    [self setNeedsDisplay];
} 
```

从技术上讲，我们可能不需要`[super prepareForReuse]`像文档建议的那样包含“此方法的默认实现什么都不做”。但是，这是一种很好的做法，谁知道苹果将来是否会更改默认实现`prepareForReuse`。

# android - 触摸进出视图时如何更改TextView背景颜色？

> ID：12556472
> 
> 赞同：1
> 
> 时间：2012-09-23T21:34:43.903
> 
> 标签：android, textview, ontouchlistener

这必须是一个非常简单的修复，但我似乎无法弄清楚。我已经让我的程序将背景颜色更改为更改，并使用and更改`onClick`onTouch 。但我需要它在触摸屏幕和进出. 我需要它像 mouseOver/mouseOut 事件一样运行。有没有办法在android上做到这一点？还是我坚持，行动必须从内部开始？`ACTION_DOWN``ACTION_UP``TextView``onTouch``TextView`

现在我设置了`onTouchListener`它`TextView`本身。我应该将它设置在其他地方，然后检查 x 和 y 是否在`Textview`? 还是我应该使用另一个事件侦听器？我是Android新手，任何帮助将不胜感激。谢谢。

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:14:41.303

我将`OnTouchListener`在您的应用程序上实现，然后在`onTouch`方法上实现，继续检查触摸事件的当前位置是否在视图*边界框的范围内。*如果是，则应用新背景，如果不是，则应用原始背景。

由于所有视图都实现了`setBackgroundColor`我没有进行任何转换，`TextView`但示例应该足够了，至少作为进一步开发应用程序的起点。

完整的代码如下：

```
public class Main extends Activity implements OnTouchListener{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //Set the listener for the parent/container view
        findViewById(R.id.cont).setOnTouchListener(this);

        //Get a hold of the view and create the Rect for the bounds
        View target = findViewById(R.id.target);
        Rect b = new Rect();

        //Get the bounding box of the target view into `b`
        target.getGlobalVisibleRect(b);
    }

    public boolean onTouch(View v, MotionEvent event) {

        //Check if it's within the bounds or not
        if(b.contains((int)event.getRawX(),(int) event.getRawY())){
            target.setBackgroundColor(0xffff0000);
        }else{
            target.setBackgroundColor(0xff000000);
        }

        //You need to return true to keep on checking the event
        return true;
    }
} 
```

至于前面代码的用户界面，它只是一个带有 ID 的线性布局和一个带有 ID`cont`的视图（`TextView`在您的情况下为 a ）`target`。其余的完全是默认的，所以我把它贴在这里没有意义。**请注意**，我只在模拟器和*ymmv*上测试了它，但在真实设备上尝试它时，但据我所知，它应该没问题。

* * *

**相关文件：**

*   [getGlobalVisibleRect 方法](http://docs.mono-android.net/index.aspx?link=M%3AAndroid.Views.View.GetGlobalVisibleRect(Android.Graphics.Rect%2CAndroid.Graphics.Point))
*   [onTouchListener](http://developer.android.com/intl/es/reference/android/view/View.OnTouchListener.html)

# asp.net - Asp.net 单线程页面请求

> ID：12556481
> 
> 赞同：0
> 
> 时间：2012-09-23T21:36:47.787
> 
> 标签：asp.net

如何处理来自单个客户端的多个 http 请求，以便由单个 Asp.net 线程处理。当 PageAsyncTask 或 TPL 不是一个选项时，它会创建一个新线程。代码片段将有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:43:19.913

每个单独的 HTTP 请求都将在一个可能单独的线程上执行。

您无法控制 ASP.Net 页面的哪个线程执行计划。

我不相信这可以实现。

想想你为什么要这样做。您是否需要在各种 HTTP 请求之间共享一些信息？如果是这样，请考虑使用会话或 cookie 来管理该信息。

# javascript - 在 Skype 上与我联系的 Skype 脚本

> ID：12556486
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:37:26.003
> 
> 标签：javascript

我想要我网站上的链接，当有人点击它时，它会在 Skype 上开始与我聊天，或者如果我离线，它会开始与我的朋友聊天，当他离线时，它会发送一个弹出窗口说“对不起，没有人可用。” 状态必须在线，否则转到下一个人。

我找到了这个，它输出一个与状态相对应的数字。如果数字不是 2，则转到下一个人，或者如果是最后一个人，则弹出。

[http://mystatus.skype.com/username.num](http://mystatus.skype.com/username.num)

这是开始聊天必须执行的代码：

“Skype：用户名？聊天”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:52:03.053

我已经为你写了：

```
var user1 = "Your Username";
var user2 = "Friend's Username";
$.ajax({
  url: "http://mystatus.skype.com/" + user1 + ".num",
  cache: false
}).done(function( num ) {
  if(num == 2) {
    document.write('<a href="skype:"' + user1 + '"?chat"> Chat With User1 </a>');
  }else {

    $.ajax({
        url: "http://mystatus.skype.com/" + user2 + ".num",
        cache: false
    }).done(function( num2 ) {
        if(num2 == 2){
            document.write('<a href="skype:"' + user2 + '"?chat"> Chat With User2 </a>');
        } else {
            //Open Pop-up
            alert("Sorry, No one available to chat now. Try again later.");
        }
    });
  }
}); 
```

它是用 jQuery 插件和 AJAX 编写的。

# matlab - 如何在Matlab中通过一系列分段线拟合曲线？

> ID：12556491
> 
> 赞同：5
> 
> 时间：2012-09-23T21:38:15.187
> 
> 标签：matlab, plot, numerical-methods, curve-fitting

![在此处输入图像描述](../Images/0162a6036dc272ac29d0b943f38f0345.png)

我有一个简单的 loglog 曲线，如上所述。Matlab中是否有一些函数可以通过分段线拟合这条曲线并显示这些线段的起点和终点？我已经检查了matlab中的曲线拟合工具箱。他们似乎通过一条线或某些功能进行曲线拟合。我不想仅通过一条线进行曲线拟合。

如果没有直接功能，那么实现相同目标的任何替代方法对我来说都可以。我的目标是通过分段线拟合曲线并获取这些段的端点位置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T22:29:59.580

首先，您的问题不称为曲线拟合。曲线拟合是当你有数据时，你会找到描述它的最佳函数，在某种意义上。另一方面，您想要创建函数的分段线性逼近。

我建议以下策略：

1.  手动拆分为多个部分。截面大小应取决于导数，大导数 -> 小截面
2.  在部分之间的节点处对函数进行采样
3.  找到通过上述点的线性插值。

这是执行此操作的代码示例。您可以看到红线（插值）非常接近原始函数，尽管部分数量很少。这是由于自适应部分大小而发生的。

![在此处输入图像描述](../Images/79d999967a49a8ca5ea6321313500889.png)

```
function fitLogLog()
   x = 2:1000;
   y = log(log(x));

   %# Find section sizes, by using an inverse of the approximation of the derivative
   numOfSections = 20;
   indexes = round(linspace(1,numel(y),numOfSections));
   derivativeApprox = diff(y(indexes));
   inverseDerivative = 1./derivativeApprox;
   weightOfSection =  inverseDerivative/sum(inverseDerivative);   
   totalRange = max(x(:))-min(x(:));   
   sectionSize = weightOfSection.* totalRange;

   %# The relevant nodes
   xNodes = x(1) + [ 0 cumsum(sectionSize)];
   yNodes = log(log(xNodes));

   figure;plot(x,y);   
   hold on;
   plot (xNodes,yNodes,'r');
   scatter (xNodes,yNodes,'r');
   legend('log(log(x))','adaptive linear interpolation');
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T23:33:32.597

Andrey 的自适应解决方案提供了更准确的整体拟合。但是，如果您想要的是固定长度的片段，那么这里应该可以使用一种方法，该方法还返回所有拟合值的完整集。如果需要速度，可以矢量化。

```
Nsamp = 1000;     %number of data samples on x-axis
x = [1:Nsamp];    %this is your x-axis
Nlines = 5;       %number of lines to fit

fx = exp(-10*x/Nsamp);  %generate something like your current data, f(x)
gx = NaN(size(fx));     %this will hold your fitted lines, g(x)

joins = round(linspace(1, Nsamp, Nlines+1));  %define equally spaced breaks along the x-axis

dx = diff(x(joins));   %x-change
df = diff(fx(joins));  %f(x)-change

m = df./dx;   %gradient for each section

for i = 1:Nlines
   x1 = joins(i);   %start point
   x2 = joins(i+1); %end point
   gx(x1:x2) = fx(x1) + m(i)*(0:dx(i));   %compute line segment
end

subplot(2,1,1)
h(1,:) = plot(x, fx, 'b', x, gx, 'k', joins, gx(joins), 'ro');
title('Normal Plot')

subplot(2,1,2)
h(2,:) = loglog(x, fx, 'b', x, gx, 'k', joins, gx(joins), 'ro');
title('Log Log Plot')

for ip = 1:2
    subplot(2,1,ip)
    set(h(ip,:), 'LineWidth', 2)
    legend('Data', 'Piecewise Linear', 'Location', 'NorthEastOutside')
    legend boxoff
end 
```

![MATLAB 绘制的输出](../Images/64011dfe51e62bb4db90ba81df04ddd3.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-22T00:01:12.703

这不是这个问题的确切答案，但是由于我是根据搜索到达这里的，所以我想回答有关如何创建（不适合）旨在表示均值（或散点图中区间数据的中位数或其他一些函数）。

首先，使用回归的一个相关但更复杂的替代方案是[多元自适应回归样条，它显然](http://en.wikipedia.org/wiki/Multivariate_adaptive_regression_splines)[在维基百科页面上列出了一些 MATLAB 代码](http://www.cs.rtu.lv/jekabsons/regression.html)。

这里的解决方案是只计算重叠间隔的平均值以获得积分

```
function [x, y] = intervalAggregate(Xdata, Ydata, aggFun, intStep, intOverlap)
% intOverlap in [0, 1); 0 for no overlap of intervals, etc.
% intStep    this is the size of the interval being aggregated.

minX = min(Xdata);
maxX = max(Xdata);

minY = min(Ydata);
maxY = max(Ydata);

intInc = intOverlap*intStep; %How far we advance each iteraction.
if intOverlap <= 0
   intInc = intStep;
end
nInt = ceil((maxX-minX)/intInc); %Number of aggregations

parfor i = 1:nInt
    xStart = minX + (i-1)*intInc;
    xEnd   = xStart + intStep;
    intervalIndices = find((Xdata >= xStart) & (Xdata <= xEnd));
    x(i) = aggFun(Xdata(intervalIndices));
    y(i) = aggFun(Ydata(intervalIndices));
end 
```

例如，为了计算一些成对的 X 和 Y 数据的平均值，我可以方便地使用长度为 0.1 的间隔，彼此之间大约有 1/3 重叠（参见散点图）：

![Xdat 和 Ydat 的散点图示例](../Images/e2ddc2db5bee4dfb9efd96d154e1ed17.png)

> > [x,y] = intervalAggregate(Xdat, Ydat, @mean, 0.1, 0.333)

x =

第 1 至 8 列

```
0.0552    0.0868    0.1170    0.1475    0.1844    0.2173    0.2498    0.2834 
```

第 9 至 15 列

```
0.3182    0.3561    0.3875    0.4178    0.4494    0.4671    0.4822 
```

y =

第 1 至 8 列

```
0.9992    0.9983    0.9971    0.9955    0.9927    0.9905    0.9876    0.9846 
```

第 9 至 15 列

```
0.9803    0.9750    0.9707    0.9653    0.9598    0.9560    0.9537 
```

我们看到随着 x 的增加，y 趋于略微减小。从那里，很容易绘制线段和/或执行一些其他类型的平滑。

（请注意，我没有尝试对这个解决方案进行矢量化；如果对 Xdata 进行了排序，可以假设一个更快的版本。）

# c# - 如何确定哪个 SemanticModel 实例解析 ExpressionSyntax

> ID：12556492
> 
> 赞同：1
> 
> 时间：2012-09-23T21:38:16.643
> 
> 标签：c#, roslyn

为了找到我调用的 ExpressionSyntax 实例的目标，`mySemanticModel.GetSymbolInfo(myExpressionSyntax).`
我有几个 SemanticModel 实例，每个实例都与代码文件的语法树相关。

我想迭代语义模型并找到合适的模型来返回符号信息，但是我看不到如何在不使用异常的情况下测试合适的语义模型。

我需要完成以下代码：

```
SymbolInfo? Resolve(ExpressionSyntax expressionSyntax)
{
    foreach (SemanticModel semanticModel in allSemanticModels)
    {
        if ( /* test if expression syntax found in semantic model */ )
        {
            return semanticModel.GetSymbolInfo(expressionSyntax);
        }
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:48:31.803

SemanticModels 绑定到底层的 SyntaxTree，因此您只需要确保它们对齐即可。如果你有一个`IEnumerable<SemanticModel>`你只需要做：

```
var model = models.First(m => m.SyntaxTree == expressionSyntax.SyntaxTree); 
```

挑选合适的人；你可能最好有一个`Dictionary<SyntaxTree, SemanticModel>`而不是每次都枚举一个列表。我不确定您为什么要使用任何其他数据结构来保存它们。

持有 SemanticModel 的唯一主要优势是您可以获得一些缓存优势，在此过程中交易内存；不要持有不再使用的语义模型。

# vba - 在 VBA 中使用 range.formula 的问题

> ID：12556502
> 
> 赞同：0
> 
> 时间：2012-09-23T21:39:51.637
> 
> 标签：vba, excel, range, formula

我有一个问题，当我使用以下代码时，它没有显示在单元格中

> wbNew.Sheets("Sheet1").Range("g2").Formula = "=SUMPRODUCT('PC'!C2:j2;>[t1.xls]input!g14:n14)*E2"

如果我将公式直接放入单元格中，则公式可以完美运行。当我将它放入单元格时，我只会得到一个空白单元格并且没有结果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T00:52:33.790

如果您使用的 Excel 版本不是美式英语，您可能希望获取和设置对象的`FormulaLocal`属性`Range`而不是`Formula`属性。`FormulaLocal`使用您正在使用的 Excel 版本的语言，而`Formula`始终使用美式英语。

的详细信息`FormulaLocal`在[这里](http://msdn.microsoft.com/en-us/library/office/ff838851.aspx)，有关 Excel 国际化的有用页面在[这里](http://www.oaltd.co.uk/ExcelProgRef/Ch22/default.htm)

# text-editor - Sublime text 2 SASS 补全

> ID：12556509
> 
> 赞同：2
> 
> 时间：2012-09-23T21:41:16.170
> 
> 标签：text-editor, sublimetext2

我使用[sublime-text-haml-sass](https://github.com/n00ge/sublime-text-haml-sass)来获得对 sublime text 2 的[SASS](http://sass-lang.com/)支持。除了 css 完成之外，它都可以工作。

文件夹 C:\Users\USERNAME\AppData\Roaming\Sublime Text 2\Packages\css 中有文件“css_completions.py”和“css_completions.pyc”，它们负责提供补全。我厌倦了将这些文件放在包中的 SASS 文件夹中，但这没有帮助。

任何想法如何将完成从 css 包复制到 SASS ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T06:25:56.830

使用[nathos / sass-textmate-bundle](https://github.com/nathos/sass-textmate-bundle)来完成。您可以通过搜索“sass”来安装包管理器。

# python - 在开发中测试 Python 控制台脚本

> ID：12556512
> 
> 赞同：2
> 
> 时间：2012-09-23T21:41:52.560
> 
> 标签：python, testing

我正在开发一个带有一些控制台脚本的 Python 包。由于包的布局方式（参见下面的示例），控制台脚本看不到他们尝试从中导入的包。

这是一个示例布局：

```
- my_package
    bin/some_script.py
    my_package/
      __init__.py
      a_module.py 
```

我应该如何构建包，以便在处理 Python 包的内容时可以在“bin”中测试控制台脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:45:37.537

这里有一个小技巧。

```
python < bin/some_script.py 
```

从哪里`bin/some_script.py`导入`my_package`将从开发目录导入。

这假设您使用某种类似 bash 的 shell，`<`用作输入重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T13:01:34.633

我遇到了同样的问题，最后我在脚本的开头这样做了：

```
try:
    # this works after package has been installed using distutils for example
    import my_package
except ImportError:
    # this should work during dev time with the directory layout you describe
    rootpath = os.path.dirname(os.path.realpath(os.path.join(__file__, "../")))
    sys.path.insert(0, rootpath)
    try:
        import my_package
    except ImportError:
        print("*** my_package is not installed properly. Exiting.")
        sys.exit() 
```

所以现在我可以从项目根目录执行控制台脚本：

```
bin/some_script.py --help 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:54:08.860

```
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'bin')) 
```

所以，里面`__init__.py`

```
import os
import sys

sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'bin'))

import some_script

some_script.some_function() 
```

# lisp - CLOS：如何使插槽具有强制类型的符号向量？

> ID：12556513
> 
> 赞同：5
> 
> 时间：2012-09-23T21:41:56.787
> 
> 标签：lisp, common-lisp, sbcl, clos

我正在尝试创建一个可以在 SBCL 的插槽中存储符号向量的类。我无法弄清楚如何设置它。

到目前为止，我最好的猜测是

```
(defclass Individual ()
  ((discrete-decisions :type (vector symbol)))) 
```

这将返回以下错误：

```
keyword argument not a symbol:
(DISCRETE-DECISIONS :TYPE (VECTOR SYMBOL)).
   [Condition of type SB-INT:SIMPLE-PROGRAM-ERROR] 
```

一些实验表明，将类型更改为仅`symbol`返回相同的错误。我认为这`symbol`是 Common Lisp 中的有效类型......我错了吗？

我怎样才能让它工作？

[编辑]

我遇到的上述问题是在 Emacs 24.2 下的 09-22-2012 Slime 版本中运行 SBCL 1.0.58。当我从命令行运行 SBCL 1.0.58 时，没有问题。这似乎不是 SBCL 问题...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-17T06:37:53.347

您可能会考虑在插槽访问器/写入器上定义一个 :after 方法。此外，可以通过定义自己的元类和自定义 slot-value-using-class 来实现最终程度的控制

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-03T21:22:12.243

我知道我可能为时已晚，但是您应该围绕您的类声明进行安全优化。例如：

```
(locally (declare (optimize safety))
    (defclass test-class ()
      ((some-slot :type real :initarg :some-slot :accessor :test-some-slot)))) 
```

# android - 不能将 GLSurfaceView 放在 SurfaceView 上？

> ID：12556516
> 
> 赞同：1
> 
> 时间：2012-09-23T21:43:04.907
> 
> 标签：android

我的理解是，基于此讨论，您不能在 Android 中叠加两个表面视图：

[https://groups.google.com/forum/?fromgroups=#!topic/android-developers/COffLpanlz0](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/COffLpanlz0)

进一步证明这不起作用： [GLSurfaceView/SurfaceView 重叠](https://stackoverflow.com/questions/5870535/glsurfaceview-surfaceview-overlap?rq=1)

但是我想知道这里是否有解决方法？或者，如果 Android 4.1 改变了这种情况？

谷歌框架工程师的唯一建议如下所示：有谁知道这将如何完成？或者是否有任何其他方法可以实现这一目标？

" 这可能不是最好的方法，但现在你根本不能在一个窗口中有多个重叠的表面视图，所以实现这一点的唯一方法是在主窗口中渲染覆盖。仅供参考，使用单独的线程和 postInvalidate( ) 是不需要的额外工作，只需从主线程调用 invalidate() 即可。并且您需要确保至少与绘制叠加层有关的视图层次结构部分尽可能简单（不深和没有太多需要迭代的视图）以尽可能减少开销。” - 显示引用的文字 - hac...@android.com

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T23:23:01.770

对于 Android 4.0 及更高版本，您应该改用 TextureView。您可以将任意数量的 TextureView 堆叠在一起。您还可以为它们设置动画等。

# c# - 用于 NAudio 录音的音频电平表

> ID：12556520
> 
> 赞同：3
> 
> 时间：2012-09-23T21:43:37.477
> 
> 标签：c#, audio, volume

我正在使用 NAudio 库将音频录制到 WAV 文件中。我希望能够在示例数据到达时将 ProgressBar 更新为音频电平/音量的值。

```
public WaveIn Recorder_NAudio;
public WaveFileWriter Writer_NAudio;

public void record()
{
        Recorder_NAudio = new WaveIn();
                Recorder_NAudio.WaveFormat = new NAudio.Wave.WaveFormat(sampleRate, 1);
                Writer_NAudio = new WaveFileWriter(File.Open(tempPath, FileMode.Create), Recorder_NAudio.WaveFormat);

                Recorder_NAudio.DataAvailable += new EventHandler<WaveInEventArgs>(Recorder2_DataAvailable);
                Recorder_NAudio.StartRecording();
}

void Recorder2_DataAvailable(object sender, WaveInEventArgs e)
{
     if (Writer_NAudio != null) if (Writer_NAudio.CanWrite)
     {
         Writer_NAudio.WriteData(e.Buffer, 0, e.BytesRecorded);

         // I need help to create this function
         ProgressBar1.value = GetVolumeFromBytes(e.buffer);
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:55:22.423

对于 Windows 窗体示例，请查看 NAudioDemo 源代码，特别是[`AudioPlaybackPanel`](https://naudio.codeplex.com/SourceControl/changeset/view/6531ffb004f9#NAudioDemo/AudioPlaybackDemo/AudioPlaybackPanel.cs)该类，它使用 a`MeteringSampleProvider`并订阅其`StreamVolume`事件来设置自定义音量计控件（包含在 NAudio 中）的属性

对于 WPF 示例，请查看使用类似技术的[voicerecorder.codeplex.com ，并且](http://voicerecorder.codeplex.com)[本文](http://channel9.msdn.com/coding4fun/articles/NET-Voice-Recorder)中描述了音量计量。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-03T10:02:42.390

我写了一个控件，你想控制的一切都可以在[这里](http://www.pianetacodice.it/en/2012/10/21/c-vumeter-control/)找到。

与 NAudio 一起使用足以将设备定义为：

```
Private NAudio.CoreAudioApi.MMDevice device; 
```

那么在任何时候你都知道以下值的音频电平值：

掌握 ：

```
device.AudioMeterInformation.MasterPeakValue; 
```

剩下 ：

```
device.AudioMeterInformation.PeakValues[0]; 
```

正确的 ：

```
device.AudioMeterInformation.PeakValues[1]; 
```

# css - 是否可以打印出现在您网页上的 youtube 视频截图？

> ID：12556521
> 
> 赞同：2
> 
> 时间：2012-09-23T21:43:41.967
> 
> 标签：css, video, printing, youtube, stylesheet

当我尝试打印一个嵌入了 youtube 视频的页面时，它会打印出一个空白区域，而网络上会显示一个静止图像。是否可以将其打印在网络上，或者 youtube 视频在打印时总是显示为空白点？我不是要打印屏幕截图；我希望客户在单击打印图标时能够在打印后看到页面上的 youtube 静止画面，而不是空白处。

如果它总是显示为空白点，我将在其上使用我的 noprint 样式表。我嵌入了这样的视频：

```
<iframe id="ShowFrameID" width="640" height="480"            
     src="http://www.youtube.com/embed/6j6OfI9zKVQ? 
 wmode=opaque&amp;modestbranding=1&amp;rel=0">
</iframe> 
```

任何人都可以提供任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:38:05.660

[您可以使用Youtube API](https://developers.google.com/youtube/)设置背景图像。

```
http://img.youtube.com/vi/6j6OfI9zKVQ/0.jpg 
```

### 例子：

```
<iframe style="background-image:url('http://img.youtube.com/vi/6j6OfI9zKVQ/0.jpg')" id="ShowFrameID" width="640" height="480" src="http://www.youtube.com/embed/6j6OfI9zKVQ? wmode=opaque&amp;modestbranding=1&amp;rel=0">
</iframe> 
```

[关于 SO 的更多信息](https://stackoverflow.com/a/2068371/294076)

## 更新

好的，我已经验证过了。正如您在 jsfiddle 中看到的，第一个和第二个 iframe 被打印，而最后一个没有。请注意 style 属性中的其他 css 样式。我认为设置这些声明是显而易见的。对此感到抱歉。

工作小提琴：http: [//jsfiddle.net/CSvq4/](http://jsfiddle.net/CSvq4/)

打印为 pdf (Firefox) 的示例：http: [//goo.gl/zBDqt](http://goo.gl/zBDqt)

**注意＃1：** 您必须启用浏览器[才能打印背景](http://support.mozilla.org/en-US/kb/how-print-websites)！

**注意＃2：** 您还应该尝试防止内联样式。这是不好的做法，而且维护得不好。

# jquery - 组合框项目样式

> ID：12556524
> 
> 赞同：1
> 
> 时间：2012-09-23T21:44:00.597
> 
> 标签：jquery, asp.net-mvc, combobox, telerik, telerik-mvc

我的项目是 asp.net MVC，使用 Telerik MVC 组合框。如果我使用，我可以更改第一项的样式：

```
var item = combobox.dropDown.$items.first();
item.addClass('test'); 
```

或更改所有项目，使用：

```
combobox.dropDown.$items.addClass('test'); 
```

但我只需要更改特定项目（基于模型），我尝试过：

```
combobox.dropDown.$items[1].addClass('test'); 
```

我收到此错误： `Object doesn't support property or method 'addClass`'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:41:22.833

如果它是一个 jQuery 对象，你应该替换：

```
combobox.dropDown.$items[1].addClass('test'); 
```

和：

```
combobox.dropDown.$items.eq(1).addClass('test'); 
```

`$items[1]`为您提供没有 jQuery`addClass`功能的 DOM 对象。 `$items.eq(1)`为您提供具有 jQuery`addClass`功能的 jQuery 对象。

# objective-c - 交叉溶解RootViewController变化的动画？

> ID：12556526
> 
> 赞同：0
> 
> 时间：2012-09-23T21:44:20.273
> 
> 标签：objective-c, animation, view, controller, root

如何更改 UIWindow 中的 RootViewController 并将其交叉溶解到新的根目录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:01:47.393

我建议`transitionFromView`在`UIView`. 例如，您可以使用以下代码来处理您的转换：

```
- (void)transitionToViewController:(UIViewController *)viewController
                    withTransition:(UIViewAnimationOptions)transition
{
    [UIView transitionFromView:self.window.rootViewController.view
                        toView:viewController.view
                      duration:0.65f
                       options: UIViewAnimationOptionTransitionCrossDissolve
                    completion:^(BOOL finished){
                        self.window.rootViewController = viewController;
                    }];
} 
```

[您可以在此处](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)找到此方法的参考文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T02:24:04.147

让我们看一下我的示例以了解如何切换 rootviewcontroller。

```
 - (void)showTutorialsScreen:(BOOL)animated
{
   NUDTutorialsViewController *tutorialsVC = [[NUDTutorialsViewController alloc] initWithNibName:NSStringFromClass([NUDTutorialsViewController class]) bundle:nil];
   UINavigationController *tutorialsNavController = [[UINavigationController alloc] initWithRootViewController:tutorialsVC];

   [self switchRootViewController:tutorialsNavController animated:animated completion:nil]; 
```

}

```
- (void)showLoadingScreen:(BOOL)animated
{
   NUDLoadingViewController *loadingVC =  [[NUDLoadingViewController alloc]   initWithNibName:NSStringFromClass([NUDLoadingViewController class]) bundle:nil];

   [self switchRootViewController:loadingVC animated:animated completion:nil]; 
```

}

```
- (void)showMainScreen:(BOOL)animated
{
    NUDMainViewController *mainVC = [[NUDMainViewController alloc] initWithNibName:NSStringFromClass([NUDMainViewController class]) bundle:nil];
    UINavigationController *mainNavController = [[UINavigationController alloc] initWithRootViewController:mainVC];

    [self switchRootViewController:mainNavController animated:animated completion:nil]; 
```

}

```
 - (void)switchRootViewController:(UIViewController *)aRootViewController animated:(BOOL)animated completion:(void(^)())completion
 {
    if (animated) {
      [UIView transitionWithView:self.window duration:0.3 options:UIViewAnimationOptionTransitionCrossDissolve animations:^{
        BOOL oldState = [UIView areAnimationsEnabled];
        [UIView setAnimationsEnabled:NO];
        self.window.rootViewController = aRootViewController;
        [UIView setAnimationsEnabled:oldState];
    } completion:^(BOOL finished) {
        if (completion) completion();
    }];
 }
   else {
       self.window.rootViewController = aRootViewController;
        if (completion) completion();
   }
 } 
```

# c# - 代码不在嵌套的异步方法中执行

> ID：12556529
> 
> 赞同：0
> 
> 时间：2012-09-23T21:44:25.723
> 
> 标签：c#, microsoft-metro, async-await

我不知道为什么我无法从异步方法调用中获取返回值。

我没有收到任何错误。

ReadAsync方法没有完全执行，使我无法逐步完成剩余的代码行**。**

请帮忙。你是我唯一的希望...

```
 protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        QuoteParameters quote = e.Parameter as QuoteParameters;
        Debug.Assert(quote != null);

        var task = _viewModel.GenerateQuote(quote);
        string address = task.Result;
        webView.Source = new Uri(address);
    }

    public async Task<string> GenerateQuote(QuoteParameters quote)
    {
        var documentedQuote = quote.Convert();
        var task = QuoteGenerator.Execute(documentedQuote);

        string filePath = await task; **// EXECUTION STOPS AT THIS POINT!**

        return filePath;
    }

    public async static Task<string> Execute(QuoteParameters quote)
    {
        string html = string.Empty;

        foreach (var service in quote.Services)
        {
            var quoteTemplateTask = IO.ReadAsync(TEMPLATES_DIRECTORY, DOC_TEMPLATE);
            string quoteTemplate = await quoteTemplateTask;

            var serviceTemplateTask = IO.ReadAsync(TEMPLATES_DIRECTORY, SERVICE_TEMPLATE);
            string serviceTemplate = await serviceTemplateTask;

            var serviceAppliedTemplate = Apply(quoteTemplate, quote.Services, serviceTemplate);

            var materialTemplate = IO.ReadAsync(TEMPLATES_DIRECTORY, MATERIAL_TEMPLATE);
            html = Apply(serviceAppliedTemplate, service.Materials, await materialTemplate);
        }

        return await SaveAsync(html);
    }

    public static async Task<string> ReadAsync(string directoryExtension, string fileName)
    {
        string filePath = BuildPath(directoryExtension, fileName);
        string directoryName = Path.GetDirectoryName(filePath);

        StorageFolder storageFolder = await StorageFolder.GetFolderFromPathAsync(directoryName);
        StorageFile storageFile = await storageFolder.GetFileAsync(fileName); **// EXECUTION STOPS HERE**

        IRandomAccessStream randomAccessStream = await storageFile.OpenAsync(FileAccessMode.Read);
        IInputStream inputstream = randomAccessStream.GetInputStreamAt(0);
        DataReader dataReader = new DataReader(inputstream);

        var numberOfBytesLoaded = dataReader.LoadAsync((uint)randomAccessStream.Size);

        return dataReader.ReadString(await numberOfBytesLoaded);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T13:44:24.677

你的问题在`OnNavigatedTo`. 具体来说，您的调用`Task.Result`导致死锁。[不要阻塞`async`代码](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html)。

你可以试试这个，但我不确定效果如何（该方法将在设置之前返回`OnNavigatedTo`，这可能不是你想要的）：`async``webView.Source`

```
protected override async void OnNavigatedTo(NavigationEventArgs e)
{
    QuoteParameters quote = e.Parameter as QuoteParameters;
    Debug.Assert(quote != null);

    var task = _viewModel.GenerateQuote(quote);
    string address = await task;
    webView.Source = new Uri(address);
} 
```

# css - 阴影外的CSS3空间

> ID：12556532
> 
> 赞同：3
> 
> 时间：2012-09-23T21:44:37.617
> 
> 标签：css

我在 li 项目列表中有以下 CSS。

```
border: 1px solid black;
border-radius:10px; 
box-shadow: 8px 8px 4px #666;
-o-box-shadow: 10px 10px 5px #888;
-icab-box-shadow: 10px 10px 5px #888;
-khtml-box-shadow: 10px 10px 5px #888;
-moz-box-shadow: 10px 10px 5px #888;
-webkit-box-shadow: 10px 10px 5px #888;
box-shadow: 10px 10px 5px #888; 
```

我还想在元素之间留一些间距，以使投影停止与下一个元素重叠。

问题是阴影和圆角必须在li上，不能只移动到一个div里面，然后将间距放在li本身上。

这样做的原因是，我使用 ajax 更改了 li 元素的背景颜色，如果我将背景颜色应用到 li，并且阴影位于子元素上，那么背景颜色将显示在没有阴影的地方，在盒子外面，希望这是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T04:59:41.803

您可以像这样使用`height`and`margin`属性（设置一些对您有利的值）：

```
li {
    height: 35px;
    margin:0 15px 15px 0;
    border: 1px solid black;
    border-radius:10px; 
    box-shadow: 8px 8px 4px #666;
    -o-box-shadow: 10px 10px 5px #888;
    -icab-box-shadow: 10px 10px 5px #888;
    -khtml-box-shadow: 10px 10px 5px #888;
    -moz-box-shadow: 10px 10px 5px #888;
    -webkit-box-shadow: 10px 10px 5px #888;
    box-shadow: 10px 10px 5px #888;
} 
```

希望能帮助到你。

PS哦，如果你想*摆弄*它：http: [//jsfiddle.net/codenighter/FUUwG/](http://jsfiddle.net/codenighter/FUUwG/)。我添加了`padding`在边框和文本之间放置一些空间的属性，左侧的边距设置为 15px（但您可以忽略它或更改它）。

# jquery - 在谷歌地图中显示三倍

> ID：12556533
> 
> 赞同：7
> 
> 时间：2012-09-23T21:44:40.197
> 
> 标签：jquery, google-maps

我有以下问题，我目前正在尝试实施：

我想在谷歌地图（API 3）中显示三倍的信息/位置在侧窗中显示一个选定的位置并在地图上显示相应的点很容易，但我有：

*   3+ 地点同时显示 +
*   我想用折线组合/链接它们以显示它们属于一起。

这在谷歌地图中是否可行，有人有关于这种尝试的信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T13:42:24.470

您可以在画布上同时添加多个标记，但请记住，您应该将新标记推送到数组以便稍后使用它。

看看这个[http://jsfiddle.net/nSf9N/](http://jsfiddle.net/nSf9N/)。它属于这篇文章[谷歌地图折线和标记在一起](https://stackoverflow.com/questions/10237589/google-maps-polyline-and-marker-together) 我猜这正是你想要的

# python - 一次按多个键让我的角色沿对角线移动

> ID：12556535
> 
> 赞同：6
> 
> 时间：2012-09-23T21:44:56.187
> 
> 标签：python, events, pygame, keyboard-events

我遇到的问题是，当用户按下 K_UP 键和 K_RIGHT 键或 K_UP 键和 K_DOWN 键等时，我试图让我的角色在屏幕上对角移动。这是我的角色移动代码（事件处理）：

```
1\. #Event Handling
2\. for event in pygame.event.get():
3\.     if event.type == pygame.QUIT: 
4\.         sys.exit()
5\.     elif (event.type == KEYDOWN):
6\.         if ((event.key == K_ESCAPE)
7\.             or (event.key == K_q)):
8\.             sys.exit()
9\.         if (event.key == K_UP):
10\.            self.char_y = self.char_y - 10
11\.        if (event.key == K_DOWN):
12\.            self.char_y = self.char_y + 10
13\.        if (event.key == K_RIGHT):
14\.            self.char_x = self.char_x + 10
15\.        if (event.key == K_LEFT):
16\.            self.char_x = self.char_x - 10 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T22:25:31.167

你可以通过[pygame.key.get_pressed()](http://www.pygame.org/docs/ref/key.html#pygame.key.get_pressed)来做到这一点：

```
keys = pygame.key.get_pressed()

if keys[K_LEFT]:
    self.char_x += 10

if keys[K_RIGHT]:
    self.char_x -= 10

if keys[K_UP]:
    self.char_y -= 10

if keys[K_DOWN]:
    self.char_y += 10 
```

# html - 如何在图像的垂直中间显示带有前后文本的图像？

> ID：12556536
> 
> 赞同：4
> 
> 时间：2012-09-23T21:44:59.783
> 
> 标签：html, css, image, alignment, vertical-alignment

在我的一个网站上，我想显示一个简单的图片库，其中包含“上一个”和“下一个”文本链接，在每个图像之前和之后（分别）**垂直居中对齐**，以便我的用户可以轻松地在图像之间导航。

我怎样才能做到这一点？无论我尝试什么，我都无法让它发挥作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T21:49:59.327

这是一个简单的技术：

**HTML**

```
<div>
    ​&lt;span>before</span>
    <img src="https://www.google.com/images/srpr/logo3w.png">
    <span>after</span>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**CSS**

```
div span,
div img {
    display: inline-block;
    vertical-align: middle;
}​ 
```

[http://jsfiddle.net/mGpz6/](http://jsfiddle.net/mGpz6/)

这是有效的，因为您可以控制元素的`vertical-align`值。`inline-block`您不能对常规`inline`元素执行此操作，它们将始终与（文本）基线对齐，这可能是您在网站上遇到的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T22:45:41.213

简单的解决方案有什么问题？

```
<div class="myGallery">
    ​&lt;span>before</span>
    <img src="http://www.spiraluniverse.com/uploads/tx_templavoila/image1.jpg">
    <span>after</span>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**CSS**

```
.myGallery img {
    vertical-align: middle;
}​ 
```

结果如下：http: [//jsfiddle.net/6e87c/embedded/result/](http://jsfiddle.net/6e87c/embedded/result/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T22:45:07.280

请记住，该`vertical-align`属性[不适用于块级元素](http://www.w3.org/TR/CSS21/visudet.html#propdef-vertical-align)。

在这种情况下，使用相对于画廊容器的绝对定位是可以接受的。完成后使用边距调整按钮的位置，即使容器 div 垂直拉伸（例如，容纳更高的图像），这也会强制按钮保持原位

```
.gallery {/*our container element*/
  position:relative;
}
.btn-prev, .btn-next {
  width:40px;height:40px;/*we know the buttons will never change size dynamically*/
  margin:-20px 0;/*so we can use explicit px value to shift them as needed*/
  position:absolute;
  top:50%;
}
.btn-prev {/*remember to correctly position the buttons horizontally*/
  left:0;
}
.btn-next {
  right:0;
} 
```

[摆弄](http://jsfiddle.net/ovfiddle/ENuYb/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T21:50:28.653

您可以在下一个/上一个链接上使用类似的东西（如果它们有一个说 .next 和 .prev 的类）：

```
.gallery-container {
  position: relative;
}
.next { right: 0; }
.prev { left: 0; }
.next, .prev {
  position: absolute;
  top: 45%;
} 
```

元素 .next 和 .prev 绝对定位到它们的父元素（.gallery-container），并且它们的位置偏移了最大值（小于 50 的 %，如果元素高 10%，它会最高：45%，如果高度为 20%，则最高：40% 等等）。

您需要稍微调整一些值，例如 left 和 right 属性以更准确地匹配 .next / .prev 元素的宽度。如果 .prev 是 40pixels 宽，那么 left: -40px; 是你需要的。

这个解决方案是非常可定制的，几乎所有浏览器都支持。

示例 HTML：

```
<div class="gallery-container">
  <a class="prev" href="#">Prev</a>
  <img src="..." />
  <a class="next" href="#">Next</a>
</div> 
```

# iphone - 使用触摸事件的 locationInView 时，如何确定设备上 CGPoint 的有效范围是多少？

> ID：12556541
> 
> 赞同：2
> 
> 时间：2012-09-23T21:45:31.747
> 
> 标签：iphone, ios, ipad, uitouch, touchesbegan

我知道 iPhone 有 480 x 320 而 iPad 是 1024 x 768 但我不知道如何以编程方式确定。我会很感激我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:54:01.253

```
UITouch*yourTouchNameHere = [touches anyObject];
CGPoint yourPointNameHere=[touch locationInView:self.view]; 
```

这自动意味着触摸在屏幕上，因此返回的任何触摸点都是有效的，但下面的代码仍然可以帮助您理解：

* * *

## 接收屏幕尺寸：`[UIScreen mainScreen].bounds.size`

iOSDevice 的高度（以像素为单位）返回：

```
[UIScreen mainScreen].bounds.size.height 
```

iOSDevice 的宽度（以像素为单位）返回：

```
[UIScreen mainScreen].bounds.size.width 
```

iOSDevice 是 iPhone 吗：

```
if([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone){} 
```

iOSDevice 是 iPad 吗：

```
if([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad){} 
```

* * *

*此处的另一个[stackOverflow 问题](https://stackoverflow.com/questions/4779221/in-iphone-app-how-to-detect-the-screen-resolution-of-the-device)显示您也可以使用*

以点（320x400 等）为单位返回整个屏幕分辨率：

```
CGRect screenBounds = [[UIScreen mainScreen] bounds]; 
```

返回屏幕分辨率比例：

```
CGFloat screenScale = [[UIScreen mainScreen] scale]; 
```

使用上述两行获取像素宽度和高度的另一种方法包括：

```
CGSize screenSize = CGSizeMake(screenBounds.size.width * screenScale, screenBounds.size.height * screenScale); 
```

# facebook - Facebook：我如何使用访问令牌来标记照片

> ID：12556545
> 
> 赞同：0
> 
> 时间：2012-09-23T21:45:53.247
> 
> 标签：facebook, facebook-graph-api

下面的代码成功上传了照片，但是当我尝试标记时，出现以下错误：

> 未捕获的 OAuthException：无效的 OAuth 访问令牌签名

如何使用 accesstoken 标记照片？

```
$photo = $facebook->api('/'.$aid.'/photos', 'POST', $attachment);

$tags['access_token'] = $access_token;
$tags = array(
  'tag_uid'=> $re[0],
  'x'      => '30',
  'y'      => '60',
);
$response = $facebook->api('/'.$photo['id'].'/tags', 'POST', $tags); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T07:21:48.570

你错过了“到”论点

[https://developers.facebook.com/docs/reference/api/photo/#tags](https://developers.facebook.com/docs/reference/api/photo/#tags)

```
 $tags['access_token'] = $access_token;
 $tags = array(
 'to' => $user,
 'tag_uid'=> $re[0],
 'x'      => '30',
 'y'      => '60',
);
$response = $facebook->api('/'.$photo['id'].'/tags', 'POST', $tags); 
```

# javascript - 使用 RoR 资产管道将样式表添加到 Javascript

> ID：12556548
> 
> 赞同：2
> 
> 时间：2012-09-23T21:46:40.200
> 
> 标签：javascript, css, ruby-on-rails, ruby, ruby-on-rails-3

我正在开发第三方脚本。我将自己的样式表添加到嵌入脚本的页面中。当前样式是 JavaScript 中的长字符串。这很愚蠢，但它比附加样式链接并发出另一个 http 请求要快。

查看 facebook SDK，我们看到一个 php 脚本，它执行类似这样的操作，其中`JS_FILES`包含`CSS_FILES`文件名数组：

```
// all.js
foreach ($JS_FILES as $file) {
  echo file_get_contents($file);
}

$css = '';
foreach ($CSS_FILES as $file) {
  $css .= file_get_contents($file);
}
// css URLs are relative to facebook domains
$css = preg_replace('#url\(/#', 'url(http://static.ak.fbcdn.net/', $css);
echo 'FB.Dom.addCssRules(' . json_encode($css) . ', ["pkg"])'; 
```

因此 css 被转换为 JSON 并发送到`FB.Dom.addCssRules`将样式附加到页面的函数。

在 JS 字符串中编写 css 是愚蠢的。我想在我的风格中使用 SCSS，我想有语法高亮，我想在一个合理的环境中开发。

我需要做什么，如何连接到 Asset Pipeline / Sprockets / Tilt 以使这件事发生？

代码示例是一个很大的优势，因为我不是一个疯狂的优秀 ruby​​ 开发人员。

**编辑**：我浏览了 Asset Pipeline 文档，并没有看到任何实际挂钩的方法。我看到的唯一选择是创建一个调用默认转换的 Tranfsorm 类，然后将输出转换为 JS 字符串并将其发送到函数。我真的不知道该怎么做。我不知道我是否甚至可以在`.jscss`不使管道崩溃的情况下要求文件。另一种选择（非常相似）是编写一个像[Black Coffee](https://github.com/metaskills/sprockets-blackcoffee/tree/master/lib/sprockets-blackcoffee)这样的 gem ，我真的不知道我应该如何去实现它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T02:34:09.060

您可能不需要新的模板引擎来完成此操作；您可以在您的 javascript 文件中使用一些辅助方法。您可以使用#evaluate 内联呈现给定的 CSS 文件，其结果需要被 javascript 转义。根据[sprockets 文档](https://github.com/sstephenson/sprockets/blob/master/lib/sprockets/context.rb)，您可以通过直接在 js 模板中挂钩到 Sprockets 环境上下文类来包含帮助程序。因此，假设您有一个编译为“inline.css”的 css 文件，您可以包含 ActionView::Helpers::JavaScriptHelper 并执行以下操作：

```
# css_string.js.erb
<% environment.context_class.instance_eval { include ActionView::Helpers::JavaScriptHelper } %>
css_string = "<%= escape_javascript(evaluate('inline.css')) %>"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T20:51:20.347

Sprockets 并不适合解决这个问题。你最终会写出丑陋且随机失败的代码（我是从令人沮丧的个人经历中说的`Rails.application.assets.find_asset()`。）

相反，请查看[RequireJS + 文本插件](https://github.com/requirejs/text)，用于编写具有非 JS 依赖项的 Javascript（如 CSS 和 Mustache/Handlebars 模板），并将其全部构建到优化的单个文件中以用于生产。

RequireJS 使用[requires-rails](https://github.com/jwhitley/requirejs-rails) gem/engine 轻松与 Rails 集成以进行开发和生产。

请注意，虽然您可以在同一个应用程序中使用 Sprockets 和 RequireJS，但您不应该在同一个文件/依赖链中混合依赖机制`//= require ...`和。`define([...], function(...){})`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T03:11:15.580

我认为@rossta 让你在这里走上了正确的道路。不过，我建议进行一些修改。首先，如果您正在用 sass 编写样式表，并且希望将编译后的 css 插入到您的 javascript 中，那么以下是实现此目的的一种方法：

```
<%= escape_javascript(Rails.application.assets.find_asset('inline').to_s.chomp) %> 
```

where`inline.css.scss`是资产搜索路径上的某处。该方法`find_asset`将编译您的 sass 并将输出作为字符串返回。一个问题是，除非 javascript 文件本身发生更改，或者您明确标记`inline.css`为依赖项，否则您包含此内容的 javascript 不会被重新编译。您可以通过包含指令来做到这一点

```
//= depend_on inline.css 
```

# scala - 如何在 Scala 中声明类型参数化算术？

> ID：12556558
> 
> 赞同：1
> 
> 时间：2012-09-23T21:48:59.070
> 
> 标签：scala, types, covariance

如何在 Scala 中声明实现多个算术系统所需的类型签名，这些算术系统都共享相同的特征来声明操作？我以为我已经解决了，直到我尝试向基本特征/类添加一些辅助实现。在以下代码片段（可编译）中，请注意 sq() 被定义为 this*self 而不是更明显的 this*this。而且 self() 也不能在 trait 中实现（我们必须等到我们得到一个具体的扩展类来实现它）。

```
trait NumberBase [NUMBERTYPE <: NumberBase[NUMBERTYPE]] {
   // type NUMBERTYPE >: this.type
   def *(that: NUMBERTYPE):NUMBERTYPE
   def self:NUMBERTYPE
   def sq:NUMBERTYPE = { this*self }
}

class D(val v:Double) extends NumberBase[D] {
   def self:D = { this }
   def *(that: D):D = { new D(this.v*that.v) }
} 
```

问题/目标是：删除 self() 的使用或（至少将 self() 的实现移动到 NumberBase 中）而不更改 D 中 * 的类型签名。上述链接中的许多修复使派生类无法实现（像 new D() 这样的东西不是由 * 或 * 返回的类型，在 D 中具有不可猜测的类型签名）。我不介意一些签名变得更丑 - 但我希望代码表达这段代码所表达的内容：派生类仅在它们自己的类型上工作并返回它们自己类型的实例（它们不会上下移动在层次结构中）。

我在这里找到了一些讨论，列出了一些问题（但没有看到解决方案）：[http](http://www.scala-lang.org/node/839) ://www.scala-lang.org/node/839 。在看到基类和实现之前，您不会遇到一些问题。

此处给出了具有上述解决方法的完整代码（强制实现类实现 self()）：[https](https://github.com/WinVector/AutoDiff) ://github.com/WinVector/AutoDiff在这里我们使用不同的算术系统共享相同的基类或特征这一事实编写在不同算术实现上通用的函数。这让我们可以使用标准机器算术（如 D）或其他东西（如计算梯度作为副作用的数字系统）的包装。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:53:45.667

我认为您想使用自类型，这将确保`NumberBase[N]`实例*也*将是 type 的实例`N`：

```
trait NumberBase[N <: NumberBase[N]] { this: N =>
  def *(that: N): N
  def sq: N = this * this
}

class D(val v: Double) extends NumberBase[D] {
  def *(that: D): D = new D(this.v * that.v)
}

val a = new D(0.5)
val b = new D(0.25)

a * b  // D(0.125)
a.sq   // D(0.25) 
```

但是，如果你真的想定义一种新的数字类型，你应该做 Scala 库本身所做的事情并使用`Numeric`类型类。

# windows - Windows UAC 弄乱了文件缓冲区

> ID：12556559
> 
> 赞同：-1
> 
> 时间：2012-09-23T21:49:08.197
> 
> 标签：windows, uac, windows64

对于这个问题中缺少代码片段及其模糊性，我请求您耐心等待，但我完全一无所知，我对错误的位置没有任何线索，我无法粘贴整个应用程序。

`C`我有一个跨平台应用程序，它通过普通API（等）打开文件`fopen`，写入一些数据（首先将缓冲区传递给 zlib 以使其放气，但我认为这不相关）持续时间，最后冲洗并关闭它。

这在所有平台上都可以正常工作，除了打开 UAC 的 Windows OS x64 上的 64 位构建。基本上，在那个精确的设置中，文件缓冲区似乎与我在`stdout`打开文件和刷新文件之间发送的内容交错，就好像任何写入`stdout`使用另一个文件的相同缓冲区一样。

重要的是要注意，这不应该与任何文件系统虚拟化（`VirtualStore`机制）相关，正如我在`%USERPROFILE%\Saved Games\`. 这个问题肯定与 UAC 有关，因为如果我关闭它，问题就不会发生。中也没有问题`wine64`。

任何指针都是有价值的。编译器是 g++ 4.7.0（从 linux 交叉编译）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T01:52:20.617

我找到了解决此问题的方法。

第一个障碍是我用 编译了我的应用程序`-mwindows`，这阻止了我的应用程序附加到父进程控制台。但是切换到`-mconsole`不仅可以解决问题。即使进行了这种更改，我发送的所有内容都`stdout`没有发送到控制台。我没有在问题中说明这个问题，因为这没什么大不了的，应用程序中有另一种控制台。

我确信整个问题是由于`msvcrt`. 基本上，当我的应用程序启动时，`stdout`它是一个有效的指针，但它并没有真正附加到父控制台。我必须做一个`freopen( "CON", "wt", stdout );`才能看到输出。此外，`fileno(stdout)` *没有 UAC*正确返回`1`，但打开 UAC，`stdout`仍然是一个有效的指针，但调用`fileno(stdout)`return `-1`！我想知道`stdout`在第二种情况下真正指向哪里。

有趣的是，使用 编译时`-mwindows`，`fileno(stdout)`返回 3！我不知道 POSIX 标准是否要求`stdout`文件描述符编号为 1，但至少选择 3 是不寻常的。

# asp.net - System.Net.Mail 使用来自地址的 Gmail Smtp 始终是我的

> ID：12556573
> 
> 赞同：1
> 
> 时间：2012-09-23T21:51:14.413
> 
> 标签：asp.net, system.net.mail, gmail-pop

我认为 Gmail 正在重写发件人地址并使用网络凭据中提供的帐户作为发件人。

```
 MailMessage message = new MailMessage();
    message.From = new MailAddress("jimmy@gmail.com");
    message.To.Add(new MailAddress("myacct@gmail.com"));
    message.Subject = "[Yep] Contact Form";
    message.Body = msg;
    message.IsBodyHtml = false;

    SmtpClient client = new SmtpClient();
    client.UseDefaultCredentials = false;
    NetworkCredential networkCredentials = new NetworkCredential("myacct@gmail.com", "pass");
    client.Credentials = networkCredentials;
    client.EnableSsl = true;
    client.Host = "smtp.gmail.com";
    client.Port = 587;

    try
    {
        client.Send(message); 
```

这是收到的电子邮件：

> 发件人：myacct@gmail.com 收件人：myacct@gmail.com 日期：2012 年 9 月 23 日星期日 14:44:54 -0700 (PDT) 主题：[是] 联系表格内容类型：文本/纯文本；charset=us-ascii 内容传输编码：quoted-printable
> 
> 这是一个测验

我知道它曾经可以工作，但现在来自始终是我的。如果其他人都遇到这个问题或者只有我一个人，我可以得到确认吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:52:45.973

GMail（和许多其他电子邮件提供商）不允许您更改 FROM 标头。这将允许电子邮件欺骗。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T05:22:27.207

Dim attachmentFile As String = Nothing If FileUpload1.HasFile Then

```
 Try
            FileUpload1.SaveAs("C:\files\" + FileUpload1.FileName)
            attachmentFile = FileUpload1.PostedFile.FileName
        Catch ex As Exception
            litStatus.Text = "File Upload Failed !! " + ex.Message.ToString()
        End Try

        Try
            Dim mail As New MailMessage()
            Dim SmtpServer As New SmtpClient("smtp.gmail.com")

            mail.From = New MailAddress("your-gamila-ddress@gmail.com")

            'you have to provide your gmail address as from address'
            mail.[To].Add(txtTo.Text)
            mail.Subject = txtSubject.Text
            mail.Body = txtBody.Text

            Dim attachment As System.Net.Mail.Attachment
            attachment = New System.Net.Mail.Attachment(attachmentFile)
            mail.Attachments.Add(attachment)

            SmtpServer.Port = 587
            SmtpServer.Credentials = New System.Net.NetworkCredential("gamil-username", "gmail-passowrd")

            'you have to provide you gamil username and password'
            SmtpServer.EnableSsl = True
            SmtpServer.Send(mail)
            litStatus.Text = "Email successfully sent."
        Catch ex As Exception
            litStatus.Text = "Mail Send Failed ! " + ex.Message.ToString()
        End Try

    Else
        litStatus.Text = "Please select a file for uploading"
    End If 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:12:24.397

要实现此结果，您将不得不选择像 godaddy 这样的自定义电子邮件提供商或从 gmail 购买商业订阅。

您还可以参考 [使用 Godaddy SMTP 从 Windows Azure 服务发送邮件](https://stackoverflow.com/questions/12437208/sending-mail-from-windows-azure-service-using-godaddy-smtp/12487178#12487178)

# jquery - jQuery幻灯片计时器

> ID：12556578
> 
> 赞同：-5
> 
> 时间：2012-09-23T21:53:13.157
> 
> 标签：jquery, timer

我正在寻找一个带有倒计时的栏的 jquery 插件。我附上示例的图像。

谢谢你们的帮助。

[示例 http://www.rodboc.com/archivos/000-ddU5IYzzTL.png](http://www.rodboc.com/archivos/000-ddU5IYzzTL.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:57:44.963

这是 jquery 的倒计时插件：http: [//keith-wood.name/countdown.html](http://keith-wood.name/countdown.html) 它非常强大，所以阅读它的文档（**自己**做一些研究）应该可以帮助你弄清楚如何让它看起来像你想要的那样到。

# python - 使用python从文件中获取聚光灯评论

> ID：12556579
> 
> 赞同：2
> 
> 时间：2012-09-23T21:53:22.203
> 
> 标签：python, comments, applescript, spotlight

我正在尝试使用 python 获得聚光灯评论。我现在需要的只是让 popen 能够返回运行相同的东西时 shell 通常会输出的任何内容。一旦我在python中有一个字符串，我就可以正确过滤它。

```
import sys, os, glob

paths = glob.glob("*.wav")
print paths

for soundFile in paths:
    #soundFile = os.path.abspath(soundFile)
    result = os.popen("xattr -p com.apple.metadata:kMDItemFinderComment "+soundFile+" | xxd -r -p |plutil -convert xml1 -o - -")
    print result 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T06:25:20.727

我不知道这在 Python 中是什么等价物，但您可以使用 xattr[将扩展属性打印为 XML 属性列表](https://stackoverflow.com/questions/11698034/printing-string-representations-of-xattr-hex-output)。

```
#!/usr/bin/env ruby -KU

require 'cgi'

plist = `xattr -p com.apple.metadata:kMDItemFinderComment test.txt |
xxd -r -p | plutil -convert xml1 -o - -`
puts CGI.unescapeHTML(plist.scan(/<string>(.*?)<\/string>/m)[0][0]) 
```

* * *

我忘了`mdls -n kMDItemFinderComment`。无论如何， Finder[并不总是将注释存储在扩展属性中。](https://apple.stackexchange.com/questions/64412/how-can-i-have-spotlight-comments-actually-get-indexed-by-spotlight/64416#64416)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T14:33:14.767

我知道这个问题是几个月前提出的，但这就是我如何通过 Python 和 popen 来关注评论。

```
cmd = subprocess.Popen(['mdls', '-name', 'kMDItemFinderComment',pathtofile], stderr=subprocess.STDOUT,stdout = subprocess.PIPE )
out,err = cmd.communicate()

print out 
```

因此，如果这对您很重要，它使用 mdls 而不是 xattr，但是如果您只是告诉 Popen 发送到哪里`STDOUT`然后使用`.communicate()`.

# python - 在字符串列表中，在字符串中找到一个短语，并将字符串中的两个整数 (x..y) 附加到一个列表中。Python

> ID：12556584
> 
> 赞同：0
> 
> 时间：2012-09-23T21:54:11.513
> 
> 标签：python, list, append, line, findall

所以我正在尝试编写一个脚本来读取文件并在找到某个单词后提取 2 个值。在这种情况下，当遇到字符串 'exon' 时，它将保存后面的两个整数。

我从创建空字符串开始：

```
exon_start = []
exon_end = [] 
```

这是我正在使用的简化数据的示例：

```
for line in data:
    print data

>>>

 exon            1..35
                 /gene="CDKN1A"

 CDS             73..567
                 /translation="MSEPAGDVRQNPCGSKACRRLFGPVDSEQLSRDCDALMAGCIQE
                 ARERWNFDFVTETPLEGDFAWERVRGLGLPKLYLPTGPRRGRDELGGGRRPGTSPALL
                 QGTAEEDHVDLSLSCTLVPRSGEQAEGSPGGPGDSQGRKRRQTSMTDFYHSKRRLIFS
                 KRKP"

 misc_feature    76..78
                 /gene="CDKN1A"

 exon            518..2106
                 /gene="CDKN1A" 
```

我尝试为 re.findall() 函数导入正则表达式模块：

```
indx_exon = range(0,len(data))

# so this relates each line of the data to a specific number in the index 
```

我无法识别每一行中的“外显子”短语首先我只是试图确定文本的哪一行具有外显子序列，以查看 re.findall() 是否有效，然后我输入：

```
for p,line in zip(indx_line,data):

    if re.findall(r'exon',line) is True:
        print p 
```

我没有

当我放：

```
for p,line in zip(indx_line,data):

    exon_test = re.findall(r'exon',line)
    print exon_test 
```

对于不包含 'exon' 的行和确实包含 'exon' 的行，我得到了一堆 [] 他们给了我 'exon' 。所以我知道我可以使用 re.findall() 功能来查找每个字符串中每次出现的“外显子”

**我只需要确切地找出当它找到“外显子”时我该怎么说，它需要在该行中查找直到找到“..”，然后将其侧翼的整数附加到相应的列表中**；IE

```
exon_start = [1,518]
exon_end = [35,2106] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:12:31.560

问题是`if re.findall(r'exon',line) is True:`在线的。因为`re.finall()`不会返回`True`或`False`。例子：

```
>>> mystr = '123 exon'
>>> import re
>>> re.findall(r'exon', mystr)
['exon']
>>> re.findall(r'exon', mystr) is True
False
>>> bool(re.findall(r'exon',mystr))
True
>>> if re.findall(r'exon', mystr):
...     print 'true'
... 
true 
```

将原代码改为：

```
for p,line in zip(indx_line,data):

    if re.findall(r'exon',line):
        print p 
```

应该让它工作。

* * *

编辑：正如@TimPietzcker 指出的那样，您根本不需要`re`在这种情况下使用。为了解决您获得数字侧翼的第二个问题，`..`以下代码可能会有所帮助：

```
>>> line = ' exon            1..35'
>>> if 'exon' in line:
...     ranges = line.split()[1].split('..')
...     print ranges
...
['1', '35'] 
```

# php - PHP：while 循环中的 SimpleXMLElement 仅迭代一次

> ID：12556585
> 
> 赞同：0
> 
> 时间：2012-09-23T21:54:20.630
> 
> 标签：php, simplexml

我正在尝试检索多个 .xml 文件（001.xml、002.xml、002.xml 等），从数据库表中添加新的子信息，然后将修改后的信息保存为本地新文件。

即使我在数据库中有很多行，使用 SimpleXMLElement 函数也可以防止脚本多次执行。

这是代码的简化版本：

```
$query=mysql_query('SELECT id FROM `table`');

while($row = mysql_fetch_array($query))
{    
    $contents = file_get_contents('path_to_url'.$row[0]);
    $xml = new SimpleXMLElement($contents);

    // Append information to xml data
    for($i=0; $i < count($xml->parent->children->child); $i++)
    {             
        $query=mysql_query('
            SELECT `age`
            FROM `table2`
            WHERE `name` = '.$xml->parent->children->child[$i]->name
        );
        $childage = mysql_fetch_array($query);

        $xml->parent->children->child[$i]->addChild('age',$childage[0]);
    }

    $file = 'id'.$row[0].'.xml'; 

    file_put_contents($file, $xml->asXML());      
} 
```

这是原始示例 .xml 数据：

```
001.xml    
<parent>
    <children>
        <child>
            <name>herp</name>
        </child>
        <child>
            <name>derp</name>
        </child>          
    </children>
<parent>

002.xml    
<parent>
    <children>
        <child>
            <name>manny</name>
        </child>
        <child>
            <name>joe</name>
        </child>
        <child>
            <name>jack</name>
        </child>            
    </children
</parent> 
```

这将是输出（注意 002.xml 没有写入，因为循环停止）

```
001.xml    
<parent>
    <children>
        <child>
            <name>herp</name>
            <age>10</age>
        </child>
        <child>
            <name>derp</name>
            <age>12</age>
        </child>          
    </children>
</parent> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:58:12.177

改变

```
while($row = mysql_fetch_array($query, MYSQL_NUM)) 
```

至

```
while ($row=mysql_fetch_array($query)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:58:44.550

行`for($i=0; $i < count($xml->parent1->child1); $i++)`需要更改为 `for($i=1; $i <= mysql_num_rows($query); $i++)`

```
$query=mysql_query('SELECT id FROM `table`', MYSQL_NUM);

while($row = mysql_fetch_array($query))
{    
$xml = new SimpleXMLElement('path_to_url'.$row[0].'.xml')) 

// Append information to xml data
for($i=1; $i <= mysql_num_rows($query); $i++)
{             
    $query=mysql_query('
        SELECT `id`
        FROM `table2`
        WHERE `column` = '.$xml->parent->child1[$i]
    );
    $row = mysql_fetch_assoc($query, MYSQL_NUM);

    $xml->parent->child1[$i]->addChild('child2',$row[0]);
}

$file = 'id'.$row[0].'.xml'; 

file_put_contents($file, $xml);      
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-09T13:44:06.363

尝试先将代码放入函数中，然后从循环中（在该范围之外）调用该函数。这是我能够在一个循环中多次调用 SimpleXMLElement 的唯一方法。

例子：

```
while($row = mysql_fetch_array($query))
{  
    myFunction($row);
}  

function myFunction($row){
    $xml = new SimpleXMLElement('path_to_url'.$row[0].'.xml')) 

    // Append information to xml data
    ...
} 
```

# c# - 窗口样式更改事件

> ID：12556587
> 
> 赞同：1
> 
> 时间：2012-09-23T21:54:28.007
> 
> 标签：c#, events, 3dsmax, windows-style-flags

我正在做一个项目，我在其他窗口（视口）上绘制表单以显示更多信息。我正在绘制的程序是 Autodesk 3ds max。我在 C# 中制作了一个自定义 UserControl，我将其加载到 3ds max 中以获取句柄。通过获取窗口句柄的位置/大小，我已经能够在窗口上绘制表单。问题是，当这些窗口调整大小/隐藏时，我的表单不会调整大小，因为我的 UserControl 不知道它。

Max 确实有一个用于改变视口的回调函数，但它几乎可以触发所有事情，例如在视口中移动光标。我不想每次在视口中移动鼠标时都检查大小变化或其他东西，因为那可能会很慢……</p>

我正在考虑调整大小部分的窗口消息，但是当我尝试在 Spy++ 中查看它们时没有看到任何消息。我在 Spy++ 中看到可见窗口有一种名为：'WS_VISIBLE' 的样式。我也想在风格改变时进行某种回调/事件触发……但我不知道如何实现这样的东西。这甚至可能吗？

我已经包含了一些 Spy++ 窗口属性的图片：

![可见的](../Images/154c7a81004a56b377bc7810aa21ffad.png)

![不可见的](../Images/d9d70f8f42f906d5a3d9738fc6f3ab00.png)

谢谢

# node.js - nodejs request.header dosnt 存在

> ID：12556588
> 
> 赞同：7
> 
> 时间：2012-09-23T21:54:30.940
> 
> 标签：node.js

看了很多关于从 NodeJS 获取客户端 IP 地址的教程、文章和 stackoverflow 问题。几乎所有人都使用这个`request.header('x-forwarded-for')` 我`NodeJS v0.8.7`没有那个 request.header 功能。

`typeof request.header`返回`undefined`

但是我有 request.headers 是一个包含一些信息的对象：

```
{ host: '127.0.0.1:8000',
  connection: 'keep-alive',
  accept: '*/*',
  'user-agent': 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1',
  'accept-encoding': 'gzip,deflate,sdch',
  'accept-language': 'en-US,en;q=0.8',
  'accept-charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3' } 
```

主机价值似乎值得一试。在 localhost 上运行 node 显然返回了`127.0.0.1:8000`，但后来我尝试从同一网络上的上网本访问我的 node.js 站点，指向 192.168.0.13 （我运行节点的桌面 IP），我得到了`192.168.0.13:8000`. 所以它没有给我客户端 IP，而是我使用哪个 IP 来指向应用程序。

然后我尝试`request.connection.remoteAddress`了，因为它在我找到的教程中命名。从 localhost 运行`127.0.0.1`，并从我的上网本运行`192.168.0.12`。所以它奏效了！192.168.0.12 是我的上网本 IP。但是在教程和问题中，我发现他们说正确的方法是第一个，这取决于代理是否属于您。

那么正确的方法是什么？为什么 request.header 对我不存在？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T22:03:21.877

如果你使用 express 3，你可以这样做：

```
req.ip
// => "127.0.0.1" 
```

[http://expressjs.com/api.html#req.ip](http://expressjs.com/api.html#req.ip)

如果你想要其他标题，你可以使用这个：

```
req.get(field)

req.get('Content-Type');
// => "text/plain"

req.get('content-type');
// => "text/plain"

req.get('Something');
// => undefined 
```

[http://expressjs.com/api.html#req.get](http://expressjs.com/api.html#req.get)

如果您使用的是普通节点，请使用以下命令：

```
request.headers 
```

# python - 在 Python 上打开/关闭键盘背光

> ID：12556589
> 
> 赞同：1
> 
> 时间：2012-09-23T21:55:09.537
> 
> 标签：python, keyboard, light

> **可能重复：**
> [是否可以通过编程方式为各个键打开 Macbook Pro 的键盘背光？](https://stackoverflow.com/questions/3124181/is-it-possible-to-programmatically-turn-on-the-macbook-pros-keyboard-backlight)

有没有办法用python切换键盘的背光？

# javascript - 在 github 页面上确定页面已过时

> ID：12556593
> 
> 赞同：46
> 
> 时间：2012-09-23T21:55:22.983
> 
> 标签：javascript, github, browser-cache

[Github 页面](http://pages.github.com/)在所有提供的内容上设置了非常激进的缓存标头（提前`Cache-Control: max-age=86400`1 天，提前 1 个月）。`Expires`

如果您更新页面并推送到 github，重新访问已经获得缓存副本的页面的人将不会在没有实际清理浏览器缓存的情况下获得新页面。

在页面中运行的脚本如何确定它已过时并强制更新？

步骤可能是：

1.  确定您在 github 页面上运行：*easy* , parse `window.location`for`github.com/`
2.  确定页面的当前版本：*hard*，git 不允许您将 sha1 嵌入到*提交*的页面中；没有RCS `$id$`。那么你怎么知道你是什么版本呢？
3.  在 github 中获取当前版本；*hard*， github 摆脱了未经身份验证的 v2 API。推送到 github 和 github 也开始发布之间存在时间上的脱节。那么你怎么知道你能得到什么版本呢？
4.  确定您已过时，如何使页面无效并强制重新加载？ *hard*，`window.location.reload(true)`例如在 Safari/Chrome 中不起作用...

所以它的解决这些步骤；当然可能有另一种方式？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-28T06:54:51.147

为了更好地控制您网站的缓存，您可以使用 HTML5 缓存清单。看：

*   在 HTML5 Rocks 上[使用应用程序缓存的初学者指南](http://www.html5rocks.com/en/tutorials/appcache/beginner/)
*   在 Mozilla Developer Network 上[使用应用程序缓存](https://developer.mozilla.org/en-US/docs/HTML/Using_the_application_cache)
*   在 Wikipedia 上[以 HTML5 缓存清单](http://en.wikipedia.org/wiki/Cache_manifest_in_HTML5)
*   [离线 Web 应用程序](http://www.w3.org/TR/offline-webapps/)W3C 工作组说明
*   WHATWG 的[离线 Web 应用程序](http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html)

您可以使用[`window.applicationCache.swapCache()`](http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#dom-appcache-swapcache)更新网站的缓存版本，而无需手动重新加载页面。

这是来自[HTML5 Rocks](http://www.html5rocks.com/en/)的代码示例，解释了如何将用户更新到您网站的最新版本：

```
// Check if a new cache is available on page load.
window.addEventListener('load', function(e) {

  window.applicationCache.addEventListener('updateready', function(e) {
    if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
      // Browser downloaded a new app cache.
      // Swap it in and reload the page to get the new hotness.
      window.applicationCache.swapCache();
      if (confirm('A new version of this site is available. Load it?')) {
        window.location.reload();
      }
    } else {
      // Manifest didn't changed. Nothing new to server.
    }
  }, false);

}, false); 
```

为避免混淆，我将添加 GitHub 为 cache.manifest 文件设置正确的 HTTP 标头：

```
Content-Type: text/cache-manifest
Cache-Control: max-age=0
Expires: [CURRENT TIME] 
```

所以你的浏览器知道它是一个缓存清单，并且应该总是检查它是否有新版本。

# iphone - MKAnnotationView 不可拖动，尽管我认为它已正确实现？

> ID：12556594
> 
> 赞同：1
> 
> 时间：2012-09-23T21:55:49.450
> 
> 标签：iphone, ios, mapkit, mkannotation

我尝试将 MKMapView 添加到我的新应用程序中。我创建了一个自定义 MKAnnotationView -> 所以我可以更改图钉的图像。一切正常，直到我尝试拖动图钉。不管我做什么，它都不会。只剩下一件事要说；MapView 是一个大 tableView 单元格的子视图。但是平移和缩放工作正常，所以我认为这与它无关......

这是我的代码：

**MKAnnotation**

```
@interface MyAnnotation : NSObject <MKAnnotation> {

}

//MKAnnotation
@property (nonatomic, assign) CLLocationCoordinate2D coordinate;

@end

@implementation MyAnnotation
@synthesize coordinate;

@end 
```

**MKAnnotationView**

```
@interface MyAnnotationView : MKAnnotationView {

}

@end

@implementation MyAnnotationView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:CGRectMake(self.frame.origin.x, self.frame.origin.y, 38, 43)];
    if (self) {
        // Initialization code
        UIImage* theImage = [UIImage imageNamed:@"partyPin.png"];

        if (!theImage)
            return nil;
        self.image = theImage;
    }
    return self;
}

@end 
```

**MapView 所在的视图 - 委托方法 - 不包括我初始化 MKAnnotation 和“addAnnotation”的部分**

```
- (MKAnnotationView *)mapView:(MKMapView *)lmapView viewForAnnotation:(id <MKAnnotation>)annotation {

    MyAnnotationView *myAnnotationView = (myAnnotationView *)[lmapView dequeueReusableAnnotationViewWithIdentifier:@"myView"];
    if(myAnnotationView == nil) {
        myAnnotationView = [[MyAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"myView"];
    }

    myAnnotationView.draggable = YES;
    myAnnotationView.annotation = annotation;

    return myAnnotationView;
}

- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)annotationView didChangeDragState:(MKAnnotationViewDragState)newState fromOldState:(MKAnnotationViewDragState)oldState
{
    if (newState == MKAnnotationViewDragStateEnding)
    {
        CLLocationCoordinate2D droppedAt = annotationView.annotation.coordinate;
        NSLog(@"dropped at %f,%f", droppedAt.latitude, droppedAt.longitude);
    }
} 
```

有人看到我错过了什么吗？

首先十分感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:56:38.120

要使注解可拖动，它必须实现一个`setCoordinate`方法。仅将视图的`draggable`属性设置为`YES`是不够的。

您的注释类已定义`coordinate`为`readonly`.

相反，将其定义为`readwrite`or`assign`并删除`coordinate`方法（以及`latitude`和`longitude`ivars 和属性，因为您将能够直接设置坐标）。

还要添加一个`@synthesize coordinate`，这样您就不必手动编写 getter/setter。

# c - 链表头始终为空

> ID：12556595
> 
> 赞同：0
> 
> 时间：2012-09-23T21:55:49.300
> 
> 标签：c, linked-list

我有一个实验室任务，我们必须创建一个链表。我已经编写了实现此目的的方法。我希望能够在测试时打印出我的链表。我有一个应该遍历所有节点的while循环，但测试条件总是失败，我不知道为什么。我将测试用例放入以查看是否每当我将节点推送到列表中时，新的头是否为空。这是我的链表的代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "list.h"

struct lnode {
char* word;
int count; 
int line;
struct lnode* next;
};

struct lnode* head = NULL;

struct lnode* newNode(char *word, int line) {
struct lnode* tempnode;
char* new = word;
tempnode = (struct lnode *)malloc(sizeof(struct lnode));
tempnode->word = new;
tempnode->count = 1;
tempnode->line = line;
return tempnode;
}

void pushNode(struct lnode** head, struct lnode* node) {
if(head == NULL) {
    head = node;
    head = nodeGetNext(head);
    head = NULL;
}
else {
    node->next = head;
    node = nodeGetNext(node);
    node = head;
}
}

struct lnode* nodeGetNext(struct lnode* node) {
return node->next;
}

char* nodeGetWord(struct lnode* node) {
return node->word;
}

int main() {
struct lnode* a;
struct lnode* b;
struct lnode* c;
struct lnode* d;
struct lnode* e;
a = newNode("Hello", 0);
b = newNode("Bonjour", 1);
c = newNode("Hola", 2);
d = newNode("Bonjourno", 3);
e = newNode("Hallo", 4);
pushNode(head, a);
if(head == NULL)
    printf("YES");
pushNode(head, b);
if(head == NULL)
    printf("YES");
pushNode(head, c);
if(head == NULL)
    printf("YES");
pushNode(head, d);
if(head == NULL)
    printf("YES");
pushNode(head, e);
if(head == NULL)
    printf("YES");
printList();

return 0;
}

void printList() {
printf("Hello\n");
struct lnode *currentnode;

currentnode = head;

while (currentnode != NULL) {
    printf("Hello");
    printf("%s:\n",nodeGetWord(currentnode));
    currentnode = nodeGetNext(currentnode);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:00:42.387

在`pushNode()`你做：`head = NULL;`。`head`是指向指针的指针...

并将其全部结束......在下一次运行中，head 再次为 NULL......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:05:49.460

我不会破坏正确答案（它看起来像家庭作业......？）但这里有一个提示：这些消息是由编译器给出的：

```
prova.c:31:10: warning: assignment from incompatible pointer type [enabled by default]<br>
prova.c:32:5: warning: passing argument 1 of ‘nodeGetNext’ from incompatible pointer type [enabled  by default]<br>
prova.c:25:15: note: expected ‘struct lnode *’ but argument is of type ‘struct lnode **’
prova.c:32:10: warning: assignment from incompatible pointer type [enabled by default]<br>
prova.c:36:16: warning: assignment from incompatible pointer type [enabled by default]<br>
prova.c:38:10: warning: assignment from incompatible pointer type [enabled by default]
... 
```

这表明可能有问题。

此外，修改函数参数头（而不是它指向的内存）几乎没有效果......（提示，提示！）

# android - 无法使用 Google 下载器示例下载 APK 扩展

> ID：12556597
> 
> 赞同：1
> 
> 时间：2012-09-23T21:56:08.733
> 
> 标签：android, apk-expansion-files

我正在尝试让下载器示例下载运行的 APK 扩展文件。我已经仔细阅读了[Google 文档中关于 APK 扩展文件](http://developer.android.com/guide/google/play/expansion-files.html)的说明以及此处非常详细的说明[创建 APK 扩展文件的步骤](https://stackoverflow.com/questions/11715855/steps-to-create-apk-expansion-file/11717019#11717019)

我有

*   更改了示例代码以包含我的 BASE64_PUBLIC_KEY
*   将 APK 和扩展文件上传到 Google Play，并保存应用程序
*   更改了示例的源代码以反映文件的字节大小

不过，当我在我的设备上运行示例时，我会收到消息

**由于找不到资源，下载失败**

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T08:15:10.583

它突然起作用了，我的猜测是原因是上传的应用程序的更改需要时间来传播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-07T21:37:06.747

（对不起..这是问题）我们可以在我们的应用程序中使用这个 Dowloader 示例吗？如果使用，是否有任何与许可证相关的要求？因为每个 SDK 示例都附带 apache 许可证 2.0

# ios - UINavigationController 不推送视图

> ID：12556599
> 
> 赞同：1
> 
> 时间：2012-09-23T21:56:26.697
> 
> 标签：ios, ios4, delegates, uinavigationcontroller, uitabbarcontroller

我的应用程序委托中有我的 UINavigationController 设置，我用它来推送我的登录页面。登录后，正在调用的视图将显示 UITabBarController 并为每个选项卡提供每个单独的 UINavigationController。我的问题是，当我通过标签栏中的导航控制器推送视图时，它什么也不做。它根本不会推动视图。我不知道下一步该怎么做才能使 pushViewController 正常工作。很感谢任何形式的帮助。谢谢。

这是我的代码：

登录时将调用此函数--来自 rootView 类

```
- (void) login
{
   UIViewController *_mainPageViewController = [[MainPageViewController alloc] initWithNibName:@"MainPageViewController" bundle:[NSBundle mainBundle]];
   [self.navigationController pushViewController:_mainPageViewController animated:YES];
} 
```

MainPageViewController.class--

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
   if (self) {  
        [self setUpTabBar];
    }
    return self;
}

-(void)setUpTabBar { 

MeViewController *_meViewController = [[MeViewController alloc]init];
_meViewController.tabBarItem = [[UITabBarItem alloc] initWithTitle:@"me" 
                                                             image:[UIImage imageNamed:@"img1.png"] tag:1];
UINavigationController *firstNavController = [[UINavigationController alloc]initWithRootViewController:_meViewController];

TodoViewController *_todoViewController = [[TodoViewController alloc]init];
_meViewController.tabBarItem = [[UITabBarItem alloc] initWithTitle:@"me" 
                                                             image:[UIImage imageNamed:@"img2.png"] tag:1];
UINavigationController *secondNavController = [[UINavigationController alloc]initWithRootViewController:_meViewController];

mainBarController.viewControllers = [[NSArray alloc] initWithObjects: firstNavController, secondNavController, nil];
mainBarController.delegate = self;
mainBarController.selectedIndex=0;

[firstNavController release];
[_meViewController release];   
[secondNavController release];
[_exploreViewController release];

[[[UIApplication sharedApplication]keyWindow]addSubview:mainBarController.view];
} 
```

MeViewController.class——它根本不推送视图

```
- (IBAction)showMeInfo:(id)sender {
UIViewController *_meInfoViewController = [[MeInfoViewController alloc] initWithNibName:@"MeInfoViewController" bundle:[NSBundle mainBundle]];

[self.navigationController pushViewController:_meInfoViewController animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T14:08:23.940

我不确定我是否 100% 理解，但这里是 -

我认为这`MainPageViewController`是`UITabBarController`. 如果是这种情况，则`mainBarController`不需要该变量，因为此类中的选项卡栏控制器将是`self`. 你会打电话给

```
self.viewControllers = [NSArray arrayWithObjects: firstNavController, secondNavController, nil]; 
```

此外，因为您将实例推`MainPageViewController`送到现有`UINavigationController`实例上，所以您不需要在`MainPageViewController`代码中添加任何子视图 - 例如代码行

```
[[[UIApplication sharedApplication]keyWindow]addSubview:mainBarController.view]; 
```

不是必需的，也不应该存在（`UINavigationController`自动控制哪些视图可见等，具体取决于从导航堆栈中推送/弹出哪些视图控制器。）

# ruby-on-rails - Rails：删除级联与依赖销毁

> ID：12556614
> 
> 赞同：39
> 
> 时间：2012-09-23T21:58:41.390
> 
> 标签：ruby-on-rails, postgresql, referential-integrity

假设我有两个表：`users`和`orders`. 一个用户有很多订单，所以我的订单表中自然有一个外键 user_id。

Rails 中的最佳实践是什么（在速度、样式和引用完整性方面），以确保如果删除用户，所有相关订单也被删除？我正在考虑以下选项：

案例一`:dependent => :destroy`、在用户模型中使用

案例 2\. 在 postgres 中定义表 order 并编写

```
user_id integer REFERENCES users(id) ON DELETE CASCADE 
```

我有什么理由应该使用案例 1？似乎案例 2 正在做我想做的一切？执行速度有区别吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-23T22:32:29.840

这实际上取决于您想要的行为。在情况 1 中，将在每个关联订单上调用 destroy，因此[ActiveRecord 回调](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)也将调用。在情况 2 中，不会触发这些回调，但它会更快并保证引用完整性。

在应用程序的初期，我建议您使用它，`:dependent => :destroy`因为它可以让您以独立于数据库的方式进行开发。一旦开始扩展，出于性能/完整性的原因，您应该开始在数据库中进行扩展。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-06-28T20:11:15.563

`has_many :orders, dependent: :destroy`

*   自动维护数据完整性的最安全选项。
*   您有多态关联，并且不想使用触发器。

`add_foreign_key :orders, :users, on_delete: :cascade`（在数据库迁移中）

*   您没有使用任何多态关联，或者您想为每个多态关联使用触发器。

`has_many :orders, dependent: :delete_all`

*   仅当 has_many 是关联树上的叶节点时使用（即子节点没有与外键引用的另一个 has_many 关联）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-23T22:31:13.043

我会使用选项 1。虽然它可能有效，但我可以看到选项 2 的一些问题：

1.  ActiveRecord 将不知道这些记录已被删除，这可能导致不稳定的行为
2.  阅读代码的任何人都不清楚删除用户意味着他们的所有订单也将被删除
3.  Order 上的任何`destroy`处理程序都不会触发

当然，我希望选项 2 更快，但是否值得权衡取舍取决于您。删除用户是您的应用程序中的常见操作吗？

另一种选择是使用`:dependent => :delete_all`. `:dependent => :destroy`这将比上面的缺点 1 和 2更快并避免。有关更多详细信息，请参见[此处](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_many)。

# php - 如何在复制时重命名而不更改扩展名？

> ID：12556617
> 
> 赞同：0
> 
> 时间：2012-09-23T21:58:44.503
> 
> 标签：php

我需要重命名pdf文件的文件名，同时复制它们而不更改扩展名。

```
$title = strip_tags($link1->plaintext);
$pdfLink = strip_tags($link2->title);
copy($pdfLink, $title); 
```

我想更改文件名，`$title`但扩展名也更改为 type:file。如何保存扩展文件？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:09:54.203

您可以尝试使用`pathinfo`来获取文件扩展名

```
if(file_exists($pdfLink))
{
    $titleExtention = pathinfo($pdfLink,PATHINFO_EXTENSION);
    copy($pdfLink, $title . ".". $titleExtention) ;
} 
```

# ruby-on-rails - 为什么没有显示rails错误？

> ID：12556622
> 
> 赞同：1
> 
> 时间：2012-09-23T21:59:28.960
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有这个form_for

```
<%= form_for([@post, @post.comments.build]) do |f| %>

<% if @post.errors.any? %>
   <div id="error_explanation">
     <ul>
     <% @post.errors.full_messages.each do |msg| %>
       <li><%= msg %></li>
     <% end %>
     </ul>
   </div>
<% end %>
  <div class="field">
    <%= f.label :body %><br />
    <%= f.text_area :body %>
  </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:27:33.680

您没有看到错误，因为每次加载表单时都会为表单创建一个新对象：

```
@post.comments.build 
```

您应该向控制器添加一个实例变量并在表单中使用它：

```
@comment = @post.comments.build

<%= form_for([@post, @comment]) do |f| %> 
```

# c - 按升序重新排列数组中的数字并在 C 中打印它们

> ID：12556624
> 
> 赞同：0
> 
> 时间：2012-09-23T21:59:49.860
> 
> 标签：c, arrays, pointers

到目前为止，我的程序根据用户声明的大小创建了一个数组。然后程序用 500 到 600 之间的随机数填充该数组，并打印其中的 4 个数字并创建一个新行以继续打印它们。到目前为止一切正常。在假设按升序重新打印数字的部分出现问题，它仅重新打印一些数字而不是按任何顺序。任何有关如何纠正此问题的帮助表示赞赏。

```
int main(){
            int size;
            int j, i;
        int temp;
        int a=0;
        double sum = 0;

        printf("Enter size of array ");
        scanf("%d", &size);

        int* array;
        array=malloc(size * sizeof(*array));
        int *aPtr = array;

        srand(time(NULL));
        for (i = 0; i < size; i++){
             aPtr[i] =(rand() % 101) + 500;
             printf("%d ", aPtr[i]);
             a++;
             if (a == 4){
            printf("\n");
            a = 0;
            }

      }
        printf("\n\n\nIn ascending order\n");
        for (i = 0; i< size; i++){
             for (j = 0; j < size; j++){
            if(aPtr[i] > aPtr[j]);
                temp=aPtr[i];
                aPtr[i]=aPtr[j];
                    aPtr[j]=temp;
                    }
                printf("%d\n", aPtr[i]);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:17:43.033

问题是 < 符号的结果，并且 if 语句不在其自己的括号中。用于打印的第二个 for 循环也有助于正确打印数组

```
 printf("\n\n\nIn ascending order\n");
        for (i = 0; i < size; i++){
             for (j = i+1; j < size; j++){
            if(aPtr[i] > aPtr[j]){
                temp=aPtr[i];
                aPtr[i]=aPtr[j];
                    aPtr[j]=temp;
            }
            }
            }
            for (j = 0; j<size; j++)                
            printf("%d\n", aPtr[j]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:18:21.070

问题是排序循环中的 if-test（重新格式化）：

```
for (i = 0; i< size; i++){
    for (j = 0; j < size; j++){
        if(aPtr[i] > aPtr[j]);
        temp=aPtr[i];
        aPtr[i]=aPtr[j];
        aPtr[j]=temp;
    }
    printf("%d\n", aPtr[i]);
} 
```

无论如何，您都在交换每个值，因为您没有在 if 块中放置任何内容。这应该以最少的更改来修复您的代码：

```
for (i = 0; i< size; i++){
    for (j = 0; j < size; j++){
        if(aPtr[i] > aPtr[j]) {
            temp=aPtr[i];
            aPtr[i]=aPtr[j];
            aPtr[j]=temp;
        }
    }
    printf("%d\n", aPtr[i]);
} 
```

请注意，使用冒泡排序，您只需要搜索最小元素的*索引并交换**一次*。您每次都在交换，这是非常多余的。您也不需要在内`j`循环中从零开始循环，因为之前的所有内容`i`都已经排序。

```
int minidx;
for (i = 0; i< size; i++) {
    /* Find index of smallest element in the rest of the array */
    minidx = i;
    for (j = i+1; j < size; j++) {
        if(aPtr[j] < aPtr[minidx]) minidx = j;
    }

    /* Swap if necessary */
    if (minidx != i ) {
        temp = aPtr[i];
        aPtr[i] = aPtr[minidx];
        aPtr[minidx] = temp;
    }

    /* The element at i is now sorted */
    printf("%d\n", aPtr[i]);
} 
```

# java - 按字符位置拆分字符串

> ID：12556625
> 
> 赞同：1
> 
> 时间：2012-09-23T21:59:54.453
> 
> 标签：java

假设我有一个用户输入的号码

```
Scanner input = new Scanner(System.in);

System.out.println("Input a number.");

String num = input.next(); 
```

num 的长度必须为 50，由布尔方法实现。

如何创建一个仅包含前 45 位数字的新字符串？

示例输入字符串“123456789”

只需要 String num "12345" 的前 5 个数字

我可以将字符串转换为 int 并使用模数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:04:57.783

```
try
{
   String substr = num.subString(0,45) ;
}
catch(IndexOutOfBoundsException exception)
{

   System.out.println(exception) ;

} 
```

解释：`subString(index, length)`

index 是您要开始操作的位置，长度是您想要的字符串数量。如果指定的长度大于字符串的长度，你会得到一个`IndexOutOfBoundsException`，我在 try catch 块中捕获

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T22:09:24.543

使用 java API 中的 string.substring() 方法。

字符串输出 = num.subString(0,45) ;

# java - LibGDX Box2d 将主体与对象关联

> ID：12556627
> 
> 赞同：1
> 
> 时间：2012-09-23T22:00:21.843
> 
> 标签：java, box2d, libgdx, user-data

我是初学者 Java/LibGDX 开发人员，所以如果我在这里遇到严重错误，我很抱歉，但这是我的问题：

Box2d 身体怎么可能有一些与之关联的对象呢？

例如，一个 Box2d 球体与描述球有多少能量的对象相关联，球的电荷是多少，等等。

这可能是非常错误的，但这是我一直在尝试做的：

我试图将球的用户数据设置为我的对象，如下所示：

```
Body.setUserData(MyObject); 
```

然后当我需要它时，我会用以下方法撤回它：

```
Body.getUserDate(); 
```

它返回一个对象，我不知道如何处理它，因为我不知道如何访问它的字段或方法..

我希望你理解这个问题，如果不是生病尝试修改它。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T23:59:52.377

您必须将其转换为您的类型，以便您可以像期望的那样访问它..

```
MyObject myObject = (MyObject) Body.getUserData();
myObject.property = value; 
```

# python - 在递归函数的开头声明空变量

> ID：12556629
> 
> 赞同：1
> 
> 时间：2012-09-23T22:00:37.433
> 
> 标签：python

我读过你永远不应该测试变量的存在；如果您的程序必须检查变量是否存在，则您不“知道您的变量”，这是一个设计错误。但是，我有一个递归函数，可以在每次调用该函数期间将值添加到字典和列表中。为了避免声明全局变量，我试图使变量成为函数的局部变量。但为了做到这一点，我必须在函数的开头将 myList 和 myDict 声明为 [] 和 {}。当然，这会删除我在之前的递归调用中对 dict 和 list 所做的更改，这是我不想要的。我想过在开始时设置一个 try ... catch ，检查变量是否存在，如果它们还不存在，则只将它们声明为 {} 和 [] ，但我读过这是糟糕的设计。有没有更好的方法来解决这个问题？对于没有附加任何实际代码，我深表歉意，但我仍处于规划此功能的初始阶段，因此没有什么可附加的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:03:57.930

创建新的局部变量不会覆盖以前调用的局部变量。每次调用该函数时，都会获得新的局部变量。如果函数以递归方式调用自身，则每次调用都会获得自己的局部变量。从您的解释中很难判断这是否是您问题的答案。你真的需要发布一些代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:12:38.577

你可以在这里使用一个[python “gotcha” 。](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)默认的可变参数（例如字典或列表）将在递归中发生变异：

```
def my_function(d={}):
    ...
    #recursion will mutate d 
```

*谨慎使用，但它可能很有用！*

.

一个简单的例子：

```
def f(a,d=[]):
    d.append(a)
    if a!=2:
        f(2)
    return d

print f(1) # [1,2] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T01:38:06.327

如果你真的需要在你的递归函数中访问可变状态，你可能应该使用一个类。

在这种情况下，使用不支持面向对象编程 (OOP) 的语言，最好的方法通常是简单地使用全局变量，可能包含在它们自己的模块中以避免命名空间冲突。全局变量是“坏的”，但有时它们是两个（或多个）坏处中的较小者。但是您正在用 Python 编写代码，它为您提供了一组丰富的 OOP 结构。你应该使用它们。

例如，这是一个简单的递归斐波那契函数，它使用记忆化来避免原始版本的 O(2^n) 复杂性（注意，前导下划线仅表示名称是“私有的”，不应该在没有详细知识的情况下使用其内部工作原理）：

```
class _Fib(object):
    def __init__(self):
        self.cache = {0:0, 1:1}
    def __call__(self, n):
        if n not in self.cache:
            self.cache[n] = self(n - 1) + self(n - 2)
        return self.cache[n]

fib = _Fib() 
```

快速测试；请注意，第二次调用返回时没有明显延迟：

```
>>> map(fib, xrange(10))
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
>>> fib(249)
4880197746793002076754294951020699004973287771475874L 
```

您可以看到，这个“函数”（实际上是一个可调用对象）通过在创建可变对象时创建它来解决您描述的问题。然后它通过 访问可变对象`self`。有比上述更好的编写方法`fib`，但这对于需要状态的更复杂的递归函数来说可能是一个很好的基本设计。

当然，您还有很多其他选择。使用另一个答案提到的可变默认值非常相似——但我更喜欢使用一个类，因为它更加明确。您甚至可以将对象存储为函数的属性！

```
def foo(a, b):
    if base_case(a, b):
        return
    foo.dct[a] = b
    foo.lst.append((a, b))
    foo(a - 1, b - 1)
foo.dct = {}
foo.lst = [] 
```

我不喜欢这种结构，但值得了解。最后，不要完全忽视最明显的解决方案：

```
def foo(a, b, dct, lst):
    if base_case(a, b):
        return
    dct[a] = b
    lst.append((a, b))
    foo(a - 1, b - 1, dct, lst) 
```

有时这实际上是最好的方法！这当然是简单而明确的。

作为最后一点，我将观察到您似乎误解了函数范围的性质。你说

> 我想过在开始时设置一个 try ... catch ，检查变量是否存在，如果它们还不存在，则只将它们声明为 {} 和 [] ，但我读过这是糟糕的设计。

这不是糟糕的设计。这是一个坏的设计——它就是行不通。如果您的字典和列表不是全局的，那么您`try/except`将*始终*引发异常，因为在函数的开头，*没有*定义局部变量。

这让我想到了最后一个想法。也许您想在*每次*最初调用该函数时创建一个新字典和列表，并在递归停止后将它们丢弃。在这种情况下，必须调整上面的基于类的选项；或者您可以将递归函数包装在一个外部函数中，每次调用它时都会重新创建它们：

```
def outer(a, b):
    return _inner_recursive(a, b, {}, [])

def _inner_recursive(a, b, lst, dct):
    #blah blah blah 
```

# android - 安卓文本到语音（tts）

> ID：12556630
> 
> 赞同：1
> 
> 时间：2012-09-23T22:00:39.797
> 
> 标签：android

我为我编写了这个应用程序，因为我想了解如何在 android 上使用 tts 引擎。

但是，当我在手机和模拟器上启动应用程序时：“不幸的是，您的应用程序必须停止”，我还附上了 Logcat，我希望这里的人能帮助我

```
package com.example.textspeechdemi;

import java.util.Locale;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.speech.tts.TextToSpeech;
import android.view.Menu;
import android.widget.Toast;

public class MainActivity extends Activity implements TextToSpeech.OnInitListener {

Intent mIntent;
String value;
private TextToSpeech tts;
int j;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mIntent = getIntent();
    Bundle b = getIntent().getExtras();
    final String name = b.getString("name");
    j = name.toCharArray()[0];

    Intent checkIntent = new Intent();
    checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
    startActivityForResult(checkIntent, RESULT_OK);
    tts = new TextToSpeech(this, this);
    tts.speak("Welcome", TextToSpeech.QUEUE_ADD, null);

    final Thread t1 = new Thread() {
        public void run() {
            try {

                Thread.sleep(10000);
                finish();
                // this.destroy();
            } catch (Exception e) {
                // TODO Auto-generated catch block
                Toast.makeText(getApplicationContext(), e.getMessage(),
                        Toast.LENGTH_SHORT).show();
            }
        }
    };
    t1.start();
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == RESULT_OK) {
        if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
            // success, create the TTS instance
            tts = new TextToSpeech(this, this);
        } else {
            // missing data, install it
            Intent installIntent = new Intent();
            installIntent
                    .setAction(TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
            startActivity(installIntent);
        }
    }

}

public void onInit(int status) {
    if (status == TextToSpeech.SUCCESS) {
        Toast.makeText(this,
                "Write and Listen engine is initialized & Ready",
                Toast.LENGTH_LONG).show();
    } else if (status == TextToSpeech.ERROR) {
        Toast.makeText(this,
                "Error occurred while initializing Text-To-Speech engine",
                Toast.LENGTH_LONG).show();
    }
}

protected void onDestroy() {
    super.onDestroy();
    if (tts != null) {
        tts.shutdown();
    }
}

} 
```

日志猫：

```
09-23 21:59:16.765: E/AndroidRuntime(731): FATAL EXCEPTION: main
09-23 21:59:16.765: E/AndroidRuntime(731): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.textspeechdemi/com.example.textspeechdemi.MainActivity}: java.lang.NullPointerException
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.os.Looper.loop(Looper.java:137)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-23 21:59:16.765: E/AndroidRuntime(731):  at java.lang.reflect.Method.invokeNative(Native Method)
09-23 21:59:16.765: E/AndroidRuntime(731):  at java.lang.reflect.Method.invoke(Method.java:511)
09-23 21:59:16.765: E/AndroidRuntime(731):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-23 21:59:16.765: E/AndroidRuntime(731):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-23 21:59:16.765: E/AndroidRuntime(731):  at dalvik.system.NativeStart.main(Native Method)
09-23 21:59:16.765: E/AndroidRuntime(731): Caused by: java.lang.NullPointerException
09-23 21:59:16.765: E/AndroidRuntime(731):  at com.example.textspeechdemi.MainActivity.onCreate(MainActivity.java:26)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.Activity.performCreate(Activity.java:4465)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-23 21:59:16.765: E/AndroidRuntime(731):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
09-23 21:59:16.765: E/AndroidRuntime(731):  ... 11 more 
```

这是我的清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.textspeechdemi"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
<uses-permission android:name="android.permission.READ_PHONE_STATE"/>
    <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE"/>
    <uses-permission android:name="android.permission.MODIFY_PHONE_STATE" />
    <uses-permission android:name="android.permission.UPDATE_DEVICE_STATS" />
        <uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.CALL_PHONE"></uses-permission>
    <uses-permission android:name="android.permission.READ_CONTACTS" /> 
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:12:18.643

您`NullPointerException`在方法的第 26 行有一个`onCreate(...)`。这似乎是...

```
final String name = b.getString("name"); 
```

基本上它看起来像你`Bundle b`的`null`，除非`Activity`已经通过任何额外数据的东西启动，否则无论如何都会如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:09:31.540

logcat 的相关行是这些，我认为：

```
Caused by: java.lang.NullPointerException 
09-23 21:59:16.765: E/AndroidRuntime(731):  at com.example.textspeechdemi.MainActivity.onCreate(MainActivity.java:26) 
```

崩溃的发生是因为第 26 行的某些事情。您可能想要验证`Bundle`from`getExtras()`不为 null 并且您从 the 获得的额外“名称”`Bundle`确实存在。

# python - 正则表达式 Python 数据操作——NoneType 对象

> ID：12556632
> 
> 赞同：1
> 
> 时间：2012-09-23T22:00:46.840
> 
> 标签：python, regex

我有一个 .txt 文件，其中包含以下格式的数据：

```
pq1000007 35 2 237493054 0.013328573 
```

我正在尝试使用将捕获第一个、第三个和最后一个数字的正则表达式，但前提是最后一个数字大于 0.4。出于某种原因，我收到“NoneType 对象没有属性‘组’”的消息。有任何想法吗？

代码：

```
InFileName = "PerkQP_CHGV_SCZ.txt"
InFile = open(InFileName, 'r')

OutFileName='PAZ_OUT' + ".txt"
OutFile=open(OutFileName, 'w')

for Line in InFile:
    match = re.search('(\w+)\s\d+\s(\d+)\s\d+\d+\s(\d+\.\d+)', Line)
    if match.group(2) > 0.4:
        c = match.group()
        print(c)
        OutFile.write(c+"\n")

InFile.close()
OutFile.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:04:59.630

如果搜索结果为无，则表示您的正则表达式不匹配。它似乎适用于您提供的示例，但文件中的实际数据可能与模式不匹配。（另外，我看到你的正则表达式包含`\d+\d+`应该只是`\d+`.）

此外`match.group`返回一个*字符串*。您需要将其转换为数字（例如，`float(match.group(2))`将其与数字 0.4.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:06:21.240

几个问题：

正则表达式匹配是一个字符串，因此您无法将其与浮点数进行有意义的比较（事实上，在 Python 3 中，这样做是非法的）。在 Python 2 中，任何字符串总是比较大于浮点数（因为`"str"`在 ASCII 中高于`"float"`。是的，这条规则没有意义。很好，Python 3 取消了它）。

然后，该正则表达式中的最后一个数字在*第三个* 捕获组中，所以你需要做

```
if float(match.group(3)) > 0.4: 
```

然后，您应该在正则表达式中使用逐字字符串 ( `r"..."`)。

最后，`\d+\d+`当然是多余的，`\d+`会做的。

```
match = re.search(r'(\w+)\s\d+\s(\d+)\s\d+\s(\d+\.\d+)', Line) 
```

此正则表达式与您提供的示例行匹配，因此您的错误消息（表示不匹配）必须具有不同的来源。也许您的文件中某处有一行与正则表达式不匹配。在这种情况下，您可以像这样构建您的程序：

```
for Line in InFile:
    match = re.search(r'(\w+)\s\d+\s(\d+)\s\d+\s(\d+\.\d+)', Line)
    if match:
        if float(match.group(3)) > 0.4:
            # do stuff
        else:
            print "No match: ", Line 
```

# mobile - 为移动设备禁用 Lightbox Plus

> ID：12556635
> 
> 赞同：0
> 
> 时间：2012-09-23T22:01:19.447
> 
> 标签：mobile, scroll, lightbox

我正在制作网站的移动版本，并且使用了很多灯箱。我正在尝试找到一种方法来添加滚动到移动设备上的灯箱，或者如果使用移动设备查看，则完全禁用灯箱插件。尝试了此代码，但无法使其正常工作。[http://chris-barr.com/index.php/entry/scrolling_a_overflowauto_element_on_a_touch_screen_device/](http://chris-barr.com/index.php/entry/scrolling_a_overflowauto_element_on_a_touch_screen_device/)有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T06:58:37.013

```
var lightboxOnResize = function lightboxOnResize() {
if ($(window).width() < 960) { alert();
    $('a[rel="lightbox"]')
        .removeProp('rel')
        .addClass('lightboxRemoved');
} else {
    $('a.lightboxRemoved').prop('rel', 'lightbox');
} 
```

}

$(document).ready(lightboxOnResize); $(window).resize(lightboxOnResize);

可以使用..可以根据您的要求更改视口宽度！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T22:32:51.790

我通过将以下 CSS 添加到包含 iframe、div 标签或图像的父元素来解决滚动问题：

```
#cboxLoadedContent, #cboxContent{
-webkit-overflow-scrolling: touch!important;
} 
```

# java - Java - 我想在读取文件时忽略空行

> ID：12556637
> 
> 赞同：2
> 
> 时间：2012-09-23T22:01:33.360
> 
> 标签：java

这应该真的很简单，但无论出于何种原因......

```
String line;
String question = "";
Question qObj = new Question();
line = br.readLine(); //points to where i am in the file!
if (line == null){
    System.out.println("There was no question here. ");
    System.exit(1);
} else if (line.isEmpty() || line.trim().equals("") || line.trim().equals("\n")) {
     // do nothing, i don't want empty lines
} else {
    question = line;
}

while ((line = br.readLine())!= null){
    if (line.indexOf(LoadFromDb.ANSWER_BEGIN) == 0){
        dealWithAnswer(br, qObj);
        qObj.setQuestion(question);
        break;
    } else {
    if (!line.isEmpty()){
       question += "\n" + line.trim();
    }
} 
```

如果上面的代码读取的第一行只是一个空行，那么它将空行添加到 line 对象，它不会跳过它。任何想法为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:32:18.537

关于我的回复*，这是我设想的解决方案：

```
} else if (line.isEmpty() || line.trim().equals("") || line.trim().equals("\n")) {
    do {
        line = br.readLine();
    }
    while(line.isEmpty() || line.trim().equals("") || line.trim().equals("\n"));
    question = line;
} else {
    question = line;
} 
```

虽然我确信有一种更优雅的方式。

*`Setting question to line doesn't appear to change what line is read later (if you're wanting the line to advance before it hits the while loop`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T22:12:19.783

如果我理解正确，对我有用：

```
public class BlankLine
{
    public static void main(String[] args) throws IOException
    {
        BufferedReader br = new BufferedReader(new FileReader("blankline.txt"));
        String line;
        String question = "";
        line = br.readLine();
        if (line == null){
            System.out.println("There was no question here. ");
            System.exit(1);
        } else if (line.isEmpty() || line.trim().equals("") || line.trim().equals("\n")) {
            System.out.println("Skipped a blank line");
        } else {
            question = line;
            System.out.println("Question="+question);
        }

        // Update: added this to confirm we have skipped a line
        while ((line = br.readLine())!= null){
            System.out.println("Line:"+line);
        }
    }
} 
```

**输入**：一个文本文件，第一行空白，第二行文本“Hello World”

**输出**：

```
Skipped a blank line
Line:Hello World 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-13T06:03:57.233

Java8

```
try(
    Stream<String> stream = Files.lines(
        Paths.get(INPUT_FILE_PATH), 
        Charset.defaultCharset())
){
    stream.map(line -> line.trim()) //Reading line
          .filter(line -> !line.isEmpty()) //Filtering empty lines
          .forEach(System.out::println); //Printing each line
} catch(Exception e) {  
    e.printStackTrace();            
} 
```

# c++ - STL Container：构造函数的分配器参数和作用域分配器

> ID：12556638
> 
> 赞同：14
> 
> 时间：2012-09-23T22:01:38.423
> 
> 标签：c++, stl, c++11, containers, allocator

STL 容器有一个模板参数可以选择自定义分配器。花了一段时间，但我想我明白它是如何工作的。不知何故，它并不是很好，因为给定的分配器类型没有直接使用，而是反弹到另一种类型的分配器。最后我可以使用它。

阅读[API](http://en.cppreference.com/w/cpp/container/vector/vector)后，我意识到也可以将分配器作为构造函数参数。但是，如果容器内部从模板参数重新绑定给定的分配器，我怎么知道容器使用哪种分配器？

此外，我读到 C++11 现在使用范围分配器，它允许将容器的分配器重用于其包含的容器。启用范围分配器的容器的实现与不知道范围容器的实现有何不同？

不幸的是，我找不到任何可以解释这一点的东西。感谢您的回答！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T23:51:00.497

> 但是，如果容器内部从模板参数重新绑定给定的分配器，我怎么知道容器使用哪种分配器？

始终`Allocator<T>`向构造函数提供一个（容器的在哪里`T`）`value_type`。容器会将其转换`Allocator<U>`为必要`U`的容器的一些内部数据结构。`Allocator`需要提供这样的转换构造函数，例如：

```
template <class T> class allocator {
    ...
    template <class U> allocator(const allocator<U>&); 
```

> 此外，我读到 C++11 现在使用范围分配器，它允许将容器的分配器重用于其包含的容器。

好吧，更准确地说，C++11 有一个*分配器适配器*，称为`scoped_allocator_adaptor`：

```
template <class OuterAlloc, class... InnerAllocs>
class scoped_allocator_adaptor : public OuterAlloc
{
    ...
}; 
```

从 C++11 开始：

> 类模板`scoped_allocator_adaptor`是一个分配器模板，它指定容器使用的内存资源（外部分配器）（与任何其他分配器一样），还指定要传递给容器内每个元素的构造函数的内部分配器资源。此适配器使用一个外部分配器类型和零个或多个内部分配器类型进行实例化。如果仅使用一种分配器类型进行实例化，则内部分配器将成为 `scoped_allocator_adaptor`本身，因此对容器和容器中的每个元素使用相同的分配器资源，如果元素本身是容器，则递归地使用它们的每个元素。如果使用多个分配器实例化，则第一个分配器是容器使用的外部分配器，第二个分配器传递给容器元素的构造函数，如果元素本身是容器，则第三个分配器传递给容器元素的元素等等。如果容器嵌套的深度大于分配器的数量，则会重复使用最后一个分配器，就像在单分配器的情况下一样，用于任何剩余的递归。[*注*：`scoped_allocator_adaptor`派生自外部分配器类型，因此可以在大多数表达式中替换外部分配器类型。——*尾注*]

因此，如果您将 a 指定`scoped_allocator_adaptor`为容器的分配器，您只会获得作用域分配器行为。

> 启用范围分配器的容器的实现与不知道范围容器的实现有何不同？

关键是容器现在通过一个新的类`allocator_traits`来处理它的分配器，而不是直接处理分配器。并且容器**必须**用于`allocator_traits`某些操作，例如`value_type`在容器中构造和销毁s。容器**不能**直接与分配器对话。

例如，分配器*可以*提供一个被调用的成员`construct`，它将使用给定的参数在某个地址构造一个类型：

```
template <class T> class Allocator {
     ...
    template<class U, class... Args>
        void construct(U* p, Args&&... args);
}; 
```

如果分配器不提供此成员，`allocator_traits`将提供默认实现。无论如何，容器**必须**`value_type`使用这个函数来构造所有的 s `construct`，但是通过 来使用它`allocator_traits`，而不是`allocator`直接使用：

```
allocator_traits<allocator_type>::construct(the_allocator, *ugly details*); 
```

`scoped_allocator_adaptor`提供了自定义`construct`函数，这些函数将`allocator_traits`利用`uses_allocator`特征并将正确的分配器传递给`value_type`构造函数。容器仍然对这些细节一无所知。容器只需要知道它必须构造`value_type`using`allocator_traits construct`函数。

容器必须处理更多细节才能正确处理有状态分配器。尽管这些细节也是通过让容器不做任何假设而是通过`allocator_traits`. 容器甚至不能假设`pointer`是`T*`. 而是通过询问`allocator_traits`它是什么来找到这种类型。

简而言之，要构建 C++11 容器，请研究`allocator_traits`. 然后，当您的客户使用`scoped_allocator_adaptor`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T22:22:37.817

容器使用的分配器的类型由它的构造函数参数定义：它正是容器构造函数中所期望的这种类型。但是，任何分配器都需要能够服务于与其定义的类型不同的类型。例如，对于一个`std::list<T, A>`预期的分配器来说，它能够分配`T`对象，但它永远不会用于分配这些对象，因为它`std::list<T, A>`实际上需要分配节点。也就是说，分配器将被重新分配以分配不同的类型。不幸的是，这使得使用分配器服务于特定类型变得困难：您不知道分配器将实际服务的类型。

关于作用域分配器，它的工作原理非常简单：容器确定它是否有任何成员带有构造函数，该构造函数采用匹配的分配器。如果是这种情况，它将重新绑定它使用的分配器并将此分配器传递给成员。不那么直接的是确定是否正在使用分配器的逻辑。要确定成员是否使用分配器，使用特征`std::uses_allocator<T, A>`：它确定是否`T`有嵌套的`typedef allocator_type`which 以及是否`A`可以转换为这种类型。20.6.7.2 [allocator.uses.construction] 中描述了如何构造成员对象的规则。

实际上，这意味着分配器对于处理用于容器及其成员的池很有用。在某些情况下，当分配类似大小的对象时，例如对于任何基于节点的容器，它也可以合理地工作，以保持一个大小相等的对象池。但是，从分配器使用的模式中没有必要清楚它们是否是，例如，用于节点或包含的某些字符串。此外，由于使用不同的分配策略会改变类型，所以要么坚持使用默认分配，要么使用分配器类型，它是实际定义分配策略的多态分配器的代理，这似乎是最合理的。当然，当您拥有有状态分配器时，您可能拥有具有不同分配器的对象，并且 eg`swap()`可能无法正常工作。

# makefile - 生成文件不工作

> ID：12556641
> 
> 赞同：0
> 
> 时间：2012-09-23T22:01:57.353
> 
> 标签：makefile

我正在学习 Linux 模块编程。我在 Ubuntu 12.04 上工作。我制作了一个模块，即`start.c`，并将其保存在`home/documents/module_prog`.

然后我制作了以下makefile（我不熟悉makefile，所以我只是按照教程告诉我的去做）：

```
obj-m += start.o

KDIR = /usr/src/linux-headers-3.2.0-31-generic-pae

all:
    make -C $(KDIR) SUBDIRS=$(PWD) modules

clean:
    rm -rf *.o *.ko *.mod.* *.symvers *.order 
```

但是，现在当我在终端中输入 make 时，会显示一条消息，上面写着

```
 make: Nothing to be done for `all'. 
```

请告诉我有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:05:39.890

确保 make 目标的命令用于制表符，而不是空格。IE

```
all:
<tab>make -C $(KDIR) SUBDIRS=$(PWD) modules 
```

否则`all`目标将是空的，因此什么也不做。

# iphone - TableView 不会显示提供的数据

> ID：12556642
> 
> 赞同：1
> 
> 时间：2012-09-23T22:02:16.557
> 
> 标签：iphone, ios, uitableview

我对 TableView 有一个奇怪的问题。这是一些澄清一切的代码：

我正在使用选项卡式窗格，这只是我的两个 ViewController 之一：

如您所见，我所做的只是设置一个 UIView 并在其上放置一个 tableView。

```
#import "SuchenCtrl.h"

@interface SuchenCtrl ()

@end

@implementation SuchenCtrl

@synthesize MainView;
@synthesize Standort;

- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view.
    self.view = self.MainView;

    [self.Standort.tableView setDelegate:self.Standort];
    [self.Standort.tableView setDataSource:self.Standort];

    [self.MainView addSubview:self.Standort.tableView];
}

- (id)init {
    self = [super init];

    if(self) {
        CGRect rect = [[UIScreen mainScreen] applicationFrame];
        self.MainView = [[UIView alloc] initWithFrame:rect];
        [self.MainView setBackgroundColor:[UIColor blackColor]];

        //Alloc UITableViewController
        self.Standort = [[UIStandort alloc] initWithStyle:UITableViewStylePlain];

        [self.Standort release];
        [self.MainView release];
    }

    return self;
}

@end 
```

现在 UIStandort 是另一个简单地从 UITableViewController 继承的类。它实现了显示数据所需的所有功能。我试图实现的只是让表格显示“测试”几次，但它不会。表格显示得很好，但只有空单元格。当我断点 UIStandort 类中已实现的函数之一时，什么都没有被调用，所以我的假设是委托和 sourceData 指向错误的类？不过，我在将表格放在视图上之前明确分配了这些。

如果有帮助，UIStandort* Standort 被声明为具有属性 retain 和 nonatomic。

```
#import "UIStandort.h"

@interface UIStandort ()

@end

@implementation UIStandort

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 0;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return 5;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath(NSIndexPath *)indexPath
{

    UITableViewCell* cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:nil];
    cell.textLabel.text = @"Test";

    [cell autorelease];

    return cell;
}

@end 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:27:42.273

您返回 0 表示节中的行数。该文档指出：

> tableView 中的节数。默认值为 1。

你能试一下吗：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
} 
```

# python - 在 django 中选择过滤的相关对象

> ID：12556643
> 
> 赞同：1
> 
> 时间：2012-09-23T22:02:27.010
> 
> 标签：python, sql, django, orm, django-orm

我有两个这样的模型（简化）：

```
class Post(models.Model):
    content = models.TextField('content')
    #...

class Vote(models.Model):
    user = ForeignKey(User)
    status = models.TextField(choices = some_choices, default = 'likes')
    post = models.ForeignKey(Post)
    #... 
```

我想要做的是使用一些过滤器选择（使用一个查询）帖子，该过滤器带有一个特定（假设是当前）用户对这个帖子的投票（如果他没有投票也没关系），所以我可以输出所有帖子用户可以看到他喜欢哪些，不喜欢哪些，根本没有投票。

`select_related`for `Vote`model 在这里无济于事，因为无法过滤相关对象，所以我想我应该做一些额外的事情，但我无法弄清楚我应该传递哪些参数。

所以我想，它应该是这样的：

```
Post.objects.filter(content__contains="test").extra(tables="app_vote", where={'my_vote_status': 'something here perhaps?'}) 
```

您能帮我理解如何进行这样的查询吗？

**UPD：** schacki 提供了一个很好的解决方案，唯一的问题是我想从模板中访问不同用户的投票，比如`Post.vote_by_me`和`Post.vote_by_this_user`或`Post.vote_by_top_user`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T11:30:58.293

好吧，如果您确实想要答案，有时您应该自己寻找答案:)

以下是我解决问题的方法：

```
posts = Post.objects.filter(content__contains="test"
    ).extra(select={    
                    #extra selects vote status here for current user
                    "my_vote_status":"""SELECT status FROM blog_vote as vt
                                WHERE vt.user_id = %s
                                AND   vt.post_id = blog_posts.id
                             """ % (request.user.pk) #
    }, tables=['blog_vote']) 
```

UPD：可能无需`tables`争论就可以工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T14:36:55.327

如果我正确理解您的要求，您将需要两个对象才能传递到上下文中。像这样尝试，其中 me 和 other_user 必须是有效的用户对象。

```
posts.vote_by_me=Post.objects.filter(content__contains="test",vote_set__status="something here perhaps?",vote_set__user=me)
posts.vote_by_other_user=Post.objects.filter(content__contains="test",vote_set__status="something here perhaps?",vote_set__user=other_user) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T11:57:53.280

很难理解你想要什么，但这是另一种尝试。首先，获取您的帖子：

```
posts = Post.objects.filter(whatever) 
```

现在你想要一组用户对帖子的所有投票，对吗？

```
votes = Vote.objects.filter(post__in=posts, user__in=users) 
```

现在您所要做的就是根据用户 ID 将投票与帖子相关联：

```
votes_by_user_by_post = defaultdict(lambda: defaultdict(list))
for v in votes:
    votes_by_user_by_post[post.id][v.user_id].append(v)

for post in posts:
    post.votes_by_user = votes_by_user_by_post[post.id] 
```

在性能方面，可以在两个查询和一些脚本中执行此操作。它们不是复杂的查询，脚本部分只是两个 for 循环。

# ruby-on-rails - 如何在 Rails 中进行计算

> ID：12556646
> 
> 赞同：0
> 
> 时间：2012-09-23T22:03:26.263
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一张产品表的视图，其中每种产品都有成本和价格值。我想计算并显示每种产品的销售利润率，并在表格上方放置所有产品的平均利润率。

我把计算放在哪里？你如何处理交叉引用和重复的计算，我应该以某种方式存储这些值吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:07:55.367

将计算值作为方法放入模型中：

```
def margin
  price - cost
end 
```

然后您可以直接在视图中使用边距值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:13:27.033

这取决于您是否仅在视图中使用这些计算。如果它们代表在其他任何地方使用的业务逻辑 - 模型是一个正确的地方。如果没有 - 助手会是一个更好的地方（或考虑使用装饰器/演示者）

# jquery - 从表格单元格内容中获取最高数字

> ID：12556647
> 
> 赞同：8
> 
> 时间：2012-09-23T22:03:49.463
> 
> 标签：jquery

我正在尝试从具有特定类的表格单元格中获取最高数字（在下面的示例中为 8）。我假设我必须将其转换为数组，然后对其执行 math.max ？

这是我的 HTML 代码：

```
<table>
    <tr>
        <td class="id">3</td>
    </tr>
    <tr>
        <td class="id">8</td>
    </tr>
    <tr>
        <td class="id">4</td>
    </tr>
</table> 
```

这确实是我尝试过的，但它只返回 384。所以 math.max 不起作用。

```
var varID = $('.id').text();
var varArray= jQuery.makeArray(varID);
alert (varArray); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-23T22:07:03.030

我认为最好的方法是：

```
var max = 0;
$('.id').each(function()
{
   $this = parseInt( $(this).text() );
   if ($this > max) max = $this;
});
alert(max); 
```

[jsfiddle 示例](http://jsfiddle.net/hfkSp/2/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-23T22:14:38.390

尝试这个：

```
var high = Math.max.apply(Math, $('.id').map(function(){
         return $(this).text()
})) 
```

[http://jsfiddle.net/9mQwT/](http://jsfiddle.net/9mQwT/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T22:10:42.677

检查这个 [小提琴](http://jsfiddle.net/C8wJn/)

```
$(function() {

   // Get all the elements with class id
   var $td = $('table .id');
   var max = 0;
    $.each($td , function(){
        if( parseInt($(this).text()) > max){
           max = parseInt($(this).text())
        }
    });
            console.log('Max number is : ' + max)

});​ 
```

您可以使用 parseInt 或 parseFloat 将其转换为数字，否则，它将像字符串一样将它们与它们的 ascii 值进行比较。

# python - 提高python中IMAP批量消息删除的速度

> ID：12556649
> 
> 赞同：3
> 
> 时间：2012-09-23T22:04:14.850
> 
> 标签：python, iteration, imaplib

目标是使用 imaplib 删除一堆电子邮件。电子邮件文件夹每月接收大约 300k 条新消息。仅应删除超过 1 个月的邮件。如果执行这个脚本，它会删除旧消息，但是删除需要很多时间，而且简单的迭代看起来并不有效。这需要几个小时。通过尝试通过多处理来提高速度会产生错误。

您有什么建议可以提高删除大量消息的速度？

```
import sys
import datetime
from imaplib import IMAP4

# get the date a month from the current
monthbefore = (datetime.date.today() - datetime.timedelta(365/12)).strftime("%d-%b-%Y")

m = IMAP4('mail.domain.com')
m.login('user@domain.com', 'password')

# shows how many messages in selected folder
print m.select('Folder')
typ, data = m.select('Folder')

# find old messages
typ, data = m.search(None, '(BEFORE %s)' % (monthbefore))

# delete them
print "Will be removed:\t", data[0].split()[-1],"messages"
for num in data[0].split():
  m.store(num, '+FLAGS', '\\Deleted')
  sys.stderr.write('\rRemoving message:\t %s' % num)

# now expunge marked for deletion messages, close connection and exit
print "\nGet ready for expunge"
m.expunge()
print "Expunged! Quiting."
m.close()
m.logout() 
```

**更新：**重写了部分代码，这是一个快 1000 倍的工作变体（我的服务器支持一次存储超过 1000 条消息的命令）：

```
 def chunks(l, n):
        # yields successive n-sized chunks from l.
        for i in xrange(0, len(l), n):
            yield l[i:i+n]

    mcount = data[0].split()[-1]
    print "Will be removed", mcount, "messages"
    for i in list(chunks(data[0].split(), 1000)):
        m.store(",".join(i), '+FLAGS', '\\Deleted')
        sys.stderr.write('\rdone {0:.2f}%'.format((int(i[-1])/int(mcount)*100))) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T07:39:52.960

我认为这里的主要问题是您为每条消息都调用 STORE 。到服务器的每一次往返都需要时间，当您进行大量删除时，这确实会加起来。

为了避免所有对 STORE 的调用尝试使用多个消息 ID 调用它。您可以传递逗号分隔列表（例如`"1,2,3,4"`）、消息ID 范围（例如`"1:10"`）或两者的组合（例如`"1,2,5,1:10"`）。请注意，大多数服务器似乎对每次调用允许的消息 ID 数量有限制，因此您可能仍需要将 ID 分块（例如 200 条消息）并多次调用 STORE。这仍然比每条消息调用 STORE 快得多。

如需进一步参考，请参阅 RFC 3501 的[STORE 命令](https://www.rfc-editor.org/rfc/rfc3501#section-6.4.6)部分。它显示了一个采用一系列消息 ID 的 STORE 命令的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:16:41.460

恐怕你能做的很少。在 IMAP 中，将邮件标记为已删除非常快；这就是`expunge`凶手。

而且你不能在多处理中这样做，因为只允许一个线程锁定邮箱来进行物理删除。

如果您尝试运行多处理删除 - 在大多数服务器上，我相信您实际上*可以*- 您将大大加快一个已经非常快的过程。但是这样运行的单线程`expunge`就需要加锁很长时间；根据服务器的不同，您甚至可能无法在此“死区时间”期间登录。其他一些服务器（我认为 Icewarp 的 Merak）将允许在删除期间进行正常操作（在第一次删除完成之前，您根本不允许运行*第二次*删除）。

**更新**

我做了一些实验。我发现要通过不同`imaplib`的连接，登录本身必须移动到`Thread`.

所以我这样设置应用程序：

*   主应用程序登录并检索要删除的消息列表
*   将消息分成 N 个块
*   启动运行登录的 N 个线程
*   所有线程等待一小段时间让每个线程完成登录（以便所有连接的消息索引都相同）；我真的应该在这里使用同步
*   每个线程开始删除其分配的消息部分，然后注销
*   当所有线程都完成后，主应用程序继续并清除邮箱

我注意到 N=2 时性能有所提高，而 N=3 时性能有所提高。然后对于 N=4 没有增加，即，一组四个线程中的每个线程删除 25 条消息所用的时间比一组三个线程中的一个线程删除 33 条消息花费的时间相同。N 从 5 到 7 再次没有增加。在 N=8 时，性能开始下降；十点，服务器停止接受连接。

在我最好的情况下，我估计删除时间大约是标称值的 40%，运行三个线程；我不确定这是否证明了麻烦。

但是这些值很可能在很大程度上取决于服务器架构、硬件（多少处理器和内核、多少内存）以及允许的最大并发连接数。因此，您可能会从多线程方法中获得更多优势。

我还运行了一些测试服务器端。由于大多数 IMAP 服务器（[http://en.wikipedia.org/wiki/Comparison_of_mail_servers](http://en.wikipedia.org/wiki/Comparison_of_mail_servers)）以 Maildir 格式的变体存储它们的数据，一个文件用于消息，并且消息的时间戳嵌入在文件名中，我尝试了删除包含较旧时间戳的任何文件的程序。这种方法的缺点是需要用户下线，但速度非常快。

也有可能，而且我认为它不会真正干扰用户操作，将文件标记为“要删除”（在信息文件后缀中添加“T”），所以剩下的就是发出删除命令服务器物理地杀死文件并立即重新计算配额（如果有）。

如果可以获得对服务器的访问，定期运行这样的程序将更有效地完成消息过期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:08:39.393

删除需要一定的时间，如果一次删除一个，则需要很长时间。`for`与您等待服务器执行其操作所花费的时间相比，循环的开销是微不足道的。几个小时并不过分，我也不觉得特别有问题；你*有*几个小时，我敢肯定。如果你不这样做，那就早点开始吧。

尽管如此，如果这是一个问题，那么您在线程或多处理方面处于正确的轨道上。我不知道您所说的“给出错误”是什么意思；在放弃这种方法之前，再具体一点可能会很好。如果您的意思是您的服务器不允许多个同时登录，则可以在您的 IMAP 服务器上进行配置。（我使用 CommuniGate Pro 为我的域处理电子邮件，它允许这样做。）

另一种方法是每天运行一次删除脚本，甚至每小时运行一次，这样时间成本​​就会分摊到一个月内。您也可以尝试使用 POP3 而不是 IMAP，看看它对于这个应用程序是否更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T20:11:49.233

扔一大块对我有用，电子邮件服务器自己分解它。根据需要为非 Gmail IMAP 服务器量身定制：

```
#!/bin/python

import datetime
import imaplib

m = imaplib.IMAP4_SSL("imap.gmail.com")  # server to connect to
m.login('gmail@your_gmail.com', 'your_password')

print m.select('[Gmail]/All Mail')  
before_date = (datetime.date.today() - datetime.timedelta(365)).strftime("%d-%b-%Y")  # date string, 04-Jan-2013
typ, data = m.search(None, '(BEFORE {0})'.format(before_date))  

if data != ['']:  # messages exist
    no_msgs = data[0].split()[-1]  # last msg id in the list
    print "To be removed:\t", no_msgs, "messages found with date before", before_date
    m.store("1:{0}".format(no_msgs), '+X-GM-LABELS', '\\Trash')  # move to trash, can also set Delete Flag here instead
    print "Deleted {0} messages. Closing connection & logging out.".format(no_msgs)
else:
    print "Nothing to remove."

#This block empties trash, Gmail auto purges trash after 30 days anyways.
print("Emptying Trash & Expunge...")
m.select('[Gmail]/Trash')  # select all trash
m.store("1:*", '+FLAGS', '\\Deleted')  #Flag all Trash as Deleted
m.expunge()  # not need if auto-expunge enabled in Gmail

m.close()
m.logout() 
```

# php - 将变量值分配给常量

> ID：12556650
> 
> 赞同：2
> 
> 时间：2012-09-23T22:04:22.517
> 
> 标签：php, variables, constants

PHP 常量定义如下：

```
define('const_name','const_value'); 
```

像这样尝试：

```
define('const_name', $variable_name); 
```

为什么？因为我是初学者，我想这是否可行：

```
define('const_name', 50); 
```

我的版本也可以。它没有。它是否应该起作用，而不是因为我输入错误，或者我的尝试只是愚蠢的？

注意：我的变量内部是从 mysql 数据库中提取的 Google Analytics ID。就一个像UA-XXXXX-Y这样的字符串，仅此而已。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T22:06:31.110

从[文档](http://php.net/define)中：

> 常数的值；**只允许标量和空值。标量值是整数、浮点数、字符串或布尔值。**可以定义资源常量，但不建议这样做，并且可能会导致不可预知的行为。

您从数据库中检索的值可能不是字符串，而只是带有`__toString()`方法的对象。要保证常量值是字符串，请尝试[将变量显式转换为字符串](http://php.net/manual/en/language.types.type-juggling.php)：

```
define('const_name', (string)$varible_name); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T22:08:06.570

```
$myVariable="what up";
define('myConstant',"$myVariable");
echo myConstant; 
```

真的，为什么将变量定义为常量？这不是一个好习惯。

# gcc - gcc 上的预编译头文件没有加速（但 Visual Studio 的加速很大）

> ID：12556651
> 
> 赞同：6
> 
> 时间：2012-09-23T22:04:45.833
> 
> 标签：gcc, header, precompiled-headers, precompiled

我正在做一个必须在多个环境下构建的大型项目，主要是 linux/gcc 和 windows/msvc。为了加快构建速度，我们使用预编译的头文件。

Windows 实现非常高效：在我的四核超线程 i7 上，构建时间从 9 分钟下降到 1.5 分钟。然而，使用预编译的头文件似乎并没有提高性能：在这两种情况下，它在同一台计算机上的虚拟盒子下构建需要 22 分钟，或者在真实服务器上大约需要 40 分钟。

所以我在想很明显，我不知何故出了点问题，预编译的头文件没有启动。但是我找不到什么。

我们的 Makefile 是由 CMake 生成的，所以我可以复制粘贴用于编译头文件和使用它们的目标文件的代码。

创建标题：

```
/usr/bin/c++ -O3 -DNDEBUG --no-warnings "-I/mnt/code/server a/src/game"
"-I/mnt/code/server a/src/game/vmap" "-I/mnt/code/server a/dep/include/g3dlite"
"-I/mnt/code/server a/dep/include" "-I/mnt/code/server a/src/shared"
"-I/mnt/code/server a/src/framework" "-I/mnt/code/server a/buildlinux"
"-I/mnt/code/server a/buildlinux/src/shared" -I/usr/include/mysql
"-I/mnt/code/server a/dep/acelite" -DDO_MYSQL -DHAVE_CONFIG_H
-DVERSION=\"0.6.1\" -DSYSCONFDIR=\"../etc/\" -D_RELEASE -D_NDEBUG -x c++-header
-o "/mnt/code/server a/buildlinux/src/game/pchdef.h.gch" "/mnt/code/server
a/src/game/pchdef.h" 
```

编译目标文件：

```
/usr/bin/c++ $(CXX_DEFINES) $(CXX_FLAGS) "-I/mnt/code/server
a/buildlinux/src/game" -include pchdef.h -Winvalid-pch -o
CMakeFiles/game.dir/AccountMgr.cpp.o -c "/mnt/code/server
a/src/game/AccountMgr.cpp" 
```

见解是值得赞赏的，即使它们不是直接来自上面的片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:12:12.243

在 GCC 中使用预编译头文件时需要注意几件事。首先，必须使用与正在编译的 cpp 文件相同的参数创建预编译头文件。另外我假设您实际上已经在 AccountMgr.cpp 中包含了预编译的标头？

尝试使用`-H`标志编译，这将输出正在考虑的包含文件。检查是否提到了 pchdef 文件，并查看正在解析哪些其他包含文件。要让 gcc 抱怨无效的 PCH 文件，请考虑使用`-Winvalid-pch`.

# php - 如何为我正在制作的产品目录创建目录？

> ID：12556657
> 
> 赞同：0
> 
> 时间：2012-09-23T22:05:17.783
> 
> 标签：php, ajax

我正在创建一个产品目录，该目录将通过数据库查询进行浏览，结果显示在 div 中，无需通过 ajax 刷新页面。

类别示例为：

家庭健康娱乐

每个类别还有子类别，即：

HOME：园林家具水暖等

我想做一个小目录，可以准确显示它们的位置，例如：

首页 >>> 花园 >>> 草坪护理

将这些中的每一个都作为可点击的链接，将人们带回特定的查询级别。

我的代码是 1 个 .php 文档，涉及查询和输出查询的代码。如果单击输出，它会触发一个 ajax 脚本，该脚本指向并重新运行相同的查询/输出，但结果不同。

话虽这么说，我不知道如何创建一种存储和显示目录路径的方法。我上面提到的。

我正在考虑采用某种方法来获取单击的类别并将其通过 url 传递，以便 php 在重新加载时具有值。然后我将该变量放入可点击的目录链接中。但问题是我不确定如何为多个图层做到这一点。

即，如果有人只是点击“花园”，我可以通过花园变量并在导航中使用它，但是如果有人点击“草坪护理”，我将不确定如何保留“花园”变量，因为我带来的变量通过 url 现在将显示“草坪护理”。

我觉得它与动态添加和存储数组中的累积值有关，但我真的没有想法......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T22:19:19.210

根据您的描述，听起来您想要实现面包屑/类别而不是目录。

如果是这种情况，您基本上需要在数据库中创建一个 Categories 表，如下所示：

```
Categories
id | parent_id | name
1  | 0         | Home
2  | 1         | Garden
3  | 1         | Furniture
4  | 1         | Plumbing
5  | 2         | Lawn Care 
```

这将等同于如下的层次结构：

*   家
    *   花园
        *   草坪护理
    *   家具
    *   水暖

因此，如果我想进行产品展示，例如，在*Home > Garden > Lawn Care*中，我需要将产品链接到类别 #5（草坪护理）。然后我需要开发一个函数来做一些while循环，从那里找出父结构。它需要循环直到找不到父对象（或直到 parent_id = 0）。换句话说，它会：

```
I'm in Lawn Care. Does Lawn Care have a parent?
Yes -> Garden. Does Garden have a parent?
Yes -> Home. Does Home have a parent?
No -> End. 
```

有很多方法可以实现这一点，这就是我省略细节的原因。

或者，您可以只在保存产品或类别时进行此计算，以便它可以一次而不是每次都绘制层次结构（节省计算），但这将是一个非常简单的解决方案，适用于大量的产品。

这样做的好处是您还可以根据您所在的类别实施产品列表，从另一个角度来看，您可以创建每个类别的产品计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:11:24.573

您可以使用类似的 URL`\Home\Garden\LawnCare`并使用 .htaccess 和 mod_rewrite 重写它们。当用户单击 Garden 或 Home 时，您可以轻松返回请求的页面...这是解决问题的简单方法...

# xcode - 不同 SSE 版本的通用二进制文件

> ID：12556658
> 
> 赞同：5
> 
> 时间：2012-09-23T22:05:25.787
> 
> 标签：xcode, sse, universal-binary

我可以为 Mac OS X 创建一个通用二进制文件，其中包含我的应用程序的两个版本，一个是用 SSE4.2 编译的，一个是用 SSE3 编译的？

在这种情况下，我会为支持 SSE4.2 的 CPU 自动加载使用 SSE4.2 编译的版本。

如果不是，我想获得建议，以在不支持 SSE4.2 但在支持它的 CPU 上使用 SSE4.2 的旧 CPU 上运行我的应用程序。

请注意，我的目标是 Mac AppStore，如果有的话。我在 Xcode 4.5 中使用 Clang。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T00:08:28.130

Mac OS X 使用的 Mach-O 格式不支持这一点。该格式允许二进制文件用于不同的体系结构。有一个子类型字段，但只有为不同代处理器定义的值，而不是它们的能力。

有几种方法可以解决这个问题。一种方法是将 SSE4.2 和旧处理器的代码内置到相同的二进制文件中，使用不同的函数名称。您的代码将确定是否支持 SSE4.2，然后调用正确的函数。

另一种选择是构建两个库，一个使用 SSE4.2，一个不使用，并将它们都发送到您的应用程序包中，但不链接到它们。首次加载时，您的代码将确定是否支持 SSE4.2，然后加载正确的库。

使用第一种方法，您不必担心加载库和连接所有函数，但您总是会加载未执行的额外代码，并且您必须在每个函数调用之前检查一个变量. 使用第二种方法，您可以简单地调用函数，而无需每次都检查任何内容，但是加载库并连接所有函数比每次都简单地比较一个变量需要更多的工作。

# actionscript-3 - AS3 如何等待子组件加载？

> ID：12556666
> 
> 赞同：1
> 
> 时间：2012-09-23T22:06:36.550
> 
> 标签：actionscript-3, flash, components

我有一个movieclip，我们可以称之为“mc”。在我的“mc”上有一个名为“childta”的文本区域组件。我正在使用 stage.addchild 创建“mc”的实例。一切都很好，但是当我在之后添加一行代码来设置“childta”的文本时，由于代码在加载之前执行，它没有显示出来。

我知道我的代码是正确的，因为如果我单击按钮来设置“childta”的文本，它确实有效。那么我怎样才能等待 mc.childta 被加载呢？

```
 var mcPM:PMBox = new PMBox();
               pmwaiting = 1;
                mcPM.name = sendername;
                stage.addChild(mcPM);
                mcPM.x = 200;
                mcPM.y = 200;
                mcPM.addEventListener(Event.ADDED_TO_STAGE, pmloaded);
                           }
           while(pmwaiting == 1) {

           }
            MovieClip(stage.getChildByName(sendername)).pmsa.addText(dArray[3]);
            mcPM.removeEventListener(Event.ADDED_TO_STAGE, pmloaded);
       }
   } else {
        //Its chat text, add to window
        sa.addText(e.data);
   }
}
function pmloaded(Event):void {
    pmwaiting = 0;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:12:40.340

试听“ `ADDED_TO_STAGE`”

```
childta = new TextArea();
childta.addEventListener(Event.ADDED_TO_STAGE,childtaLoaded);

function childtaLoaded(e:Event):void {
    //ready to work with
}

addChild(childta); 
```

# java - java中由多个线程异步（不一致）访问的字段会发生什么？

> ID：12556669
> 
> 赞同：0
> 
> 时间：2012-09-23T22:07:47.283
> 
> 标签：java, multithreading, thread-safety

我认为我对使用关键字来防止java中线程之间的不一致有相当牢固的把握`synchronized`，但是我不完全理解如果不使用该关键字会发生什么。

例如，我有一个由两个线程访问/修改的字段：

```
private String sharedString = "";

class OneThread extends Thread {

  private Boolean mRunning = false;

  public OneThread() {}

  public synchronized setRunning(Boolean b) {
    mRunning = b;
  }

  @Override
  public void run() {
    while (mRunning) {
      // read or write to shared string
      sharedString = "text from thread 1";
      System.out.println("String seen from thread 1: " + sharedString);
      super.run();
    }
  }
}

class AnotherThread extends Thread {

  private Boolean mRunning = false;

  public AnotherThread() {}

  public synchronized setRunning(Boolean b) {
    mRunning = b;
  }

  @Override
  public void run() {
    while (mRunning) {
      // read or write to shared string
      sharedString = "text from thread 2";
      System.out.println("String seen from thread 2: " + sharedString);
      super.run();
    }
  }
} 
```

由于这两个线程都在`sharedString`不使用同步关键字的情况下访问和修改字段，因此我预计会出现不一致。我想知道的是实际上发生了什么。在调试时，我在这种情况下仔细检查了两个线程，并注意到即使一个线程暂停，它的状态也可能是“粘滞的”。

对于上面的示例，假设两个线程都在调试器中暂停。如果我单步执行其中一个线程并让另一个暂停，我希望它会像单线程应用程序一样运行。然而，很多次在修改字段之后，访问它的下一行检索到“错误”值（与刚刚修改的值不一致的值）。

我知道这段代码不好..但我问这个问题是因为我希望有人能提供一个答案，让我们深入了解当多线程应用程序实施不佳时虚拟机中实际发生的情况。字段修改尝试不成功的线程是否有任何影响？

如果在糟糕地实现多线程代码之后，我们只是处于“未定义”行为的领域，并且学习这种行为没有任何价值，我可以接受......只是一个试图理解我的多线程菜鸟在调试器中观察。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T22:30:20.683

这是由于 Java 中跨线程同步的另一个关键功能：防止数据陈旧。作为 Java 内存模型的一部分，Java 线程可以缓存共享数据的值。除非在同步块中访问共享的可变数据或将其标记为易失性，否则无法保证线程将看到另一个线程进行的更新。请参阅[此处](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html#synchronization)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T23:20:52.063

如果没有其他线程可以更改共享值（如果真的只有 2 个线程并且一个肯定被暂停，情况就是这样），打印输出真的没有办法是“错误的”。您能否提供“启动”这两个线程（即您的主线程）的代码？

# iphone - sqlite3_prepare 错误 #26

> ID：12556670
> 
> 赞同：0
> 
> 时间：2012-09-23T22:07:50.927
> 
> 标签：iphone, objective-c, ios, xcode, sqlite

我有以下代码（本[教程](http://klanguedoc.hubpages.com/hub/Tutorial-on-Creating-an-IOS-5-SQLite-Database-Application-IOS-5-SQLite)中的修改代码）：

```
 -(NSMutableArray *) getChampionDatabase
{
    NSMutableArray *championsArray = [[NSMutableArray alloc] init];

    @try {

    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSString *databasePath = [[NSBundle mainBundle]pathForResource: @"Champions Database" ofType:@"sqlite"];
    BOOL success = [fileManager fileExistsAtPath:databasePath];

    if (!success)
    {
        NSLog(@"cannot connect to Database! at filepath %@",databasePath);
    }

    if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
    {
    const char *sql = "SELECT CHAMPION_ID,CHAMPION_NAME,CHAMPION_IMG FROM CHAMPIONS";
    sqlite3_stmt *sqlStatement;

    if(sqlite3_prepare(database, sql, -1, &sqlStatement, NULL) == SQLITE_OK)
    {
        while (sqlite3_step(sqlStatement)==SQLITE_ROW) {
            championList *ChampionList = [[championList alloc]init];
            ChampionList.championId = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement,0)];
            ChampionList.championName = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement,1)];
            ChampionList.championImage = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 2)];
            [championsArray addObject:ChampionList];
    }
    }
        else
        {
            NSLog(@"problem with database prepare");
        }
    }
        else
        {
            NSLog(@"problem with database openning");
        }
    }

@catch (NSException *exception)
    {
    NSLog(@"An exception occured: %@", [exception reason]);
    }
@finally
    {
    return championsArray;
    }
} 
```

运行此代码后，我总是有输出：“数据库准备问题”

然后我尝试通过以下代码检查 sqlite3_prepare 的错误号：

```
int ret = sqlite3_prepare(database, sql, -1, &sqlStatement, NULL);
            if (ret != SQLITE_OK) {
                NSLog(@"Error calling sqlite3_prepare: %d", ret);
            } 
```

**输出**：“调用 sqlite3_prepare 时出错：26”

**错误 26** - /*打开的文件不是数据库文件 */

* * *

文件有 sqlite 3 版本

这怎么可能？文件扩展名是 .sqlite，我可以在 sqlite manager 中修改它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:19:36.013

确保您将数据库添加到`ressource bundle`项目中，并且不要在您的数据库名称中添加任何空格。例如，使用类似的名称`champion_db.sqlite`。

# python - Pygame - 第一人称射击游戏用鼠标“看”

> ID：12556674
> 
> 赞同：6
> 
> 时间：2012-09-23T22:08:35.957
> 
> 标签：python, mouse, pygame, pyopengl

我不是在写一个游戏，而是一个使用 Pygame 的科学渲染器。我希望这些控件能够像在第一人称射击游戏中一样工作，以便用户可以使用一组熟悉的控件进行导航。

我试图编写代码以使其具有与例如天际或半条命中的“外观”功能相同的属性，但鼠标不会移动光标 - 它可以让你环顾四周，无限循环。点击应该没有效果。

**控件的第一次尝试：**

（游戏循环内的代码）

```
delta_y, delta_x = pygame.mouse.get_rel()
rotation_direction.x = float(delta_x)
rotation_direction.y = float(delta_y) 
```

*（不要问我为什么，但是 y 和 x 需要像这样反转以获得预期的外观方向；一定与相机变换实现有关，这[不是我的](http://www.willmcgugan.com/blog/tech/2007/6/4/opengl-sample-code-for-pygame/)。）*

但是，这会导致光标位于窗口顶部，当光标到达屏幕边缘时，窗口停止旋转；即代码报告屏幕上的实际位置。

我试图在每个游戏循环中“重置”鼠标位置（顺便说一下，隐藏鼠标）：

```
pygame.mouse.set_pos([150, 150])
pygame.mouse.set_visible(False) 
```

但这会在下一个循环中生成一个对称的“回到起点”增量，这意味着您无法“查看”任何地方。

总而言之，我想：

*   检测从设备报告的实际鼠标运动
*   不移动/显示任何操作系统光标
*   不在“屏幕边缘”剪辑

使用 Pygame 或其他 Python hack 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T22:41:51.593

[http://www.pygame.org/docs/ref/mouse.html](http://www.pygame.org/docs/ref/mouse.html)：

如果鼠标光标被隐藏，**并且输入被抓取到当前显示器**，则鼠标将进入虚拟输入模式，其中鼠标的相对移动将永远不会被屏幕边框停止。查看功能`pygame.mouse.set_visible`- 隐藏或显示鼠标光标和`pygame.event.set_grab`（[文档](http://www.pygame.org/docs/ref/event.html#pygame.event.set_grab)） - 控制与其他应用程序共享输入设备以进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:40:51.320

尝试`pygame.mouse.get_rel()`在呼叫后立即再次`set_pos`呼叫以“丢弃”`set_pos`呼叫执行的任何相对移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T01:28:26.680

由于您使用的是 pyOpenGL，请尝试`gluLookAt()`示例：[如何正确使用 gluLookAt？](https://stackoverflow.com/questions/3380100/how-do-i-use-glulookat-properly)

# c# - 将构造函数参数传递给在 InitializeComponent 中创建的控件

> ID：12556675
> 
> 赞同：5
> 
> 时间：2012-09-23T22:08:38.460
> 
> 标签：c#, .net, winforms, initializecomponent

`InitializeComponent`在表单上设置组件，但是对于我创建的用户控件，它调用默认构造函数，但我想在用户控件上调用我自己的构造函数（带参数）。样板代码说不要编辑内容，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T22:19:08.797

您需要创建一个 TypeConverter 类，并用`TypeConverterAttribute(typeof(MyTypeConverter))`. 类型转换器将告诉 Visual Studio 如何创建类型 - 允许您控制放入 InitializeComponent 中的内容。您可以真正深入，并实际编写自定义 CodeDomSerializer，然后您可以在其中编写任何您想要的 C# 代码 - 我使用此技术强制 InitializeComponent 方法解析来自 Castle Windsor 的所有 Forms 控件！这真的很好用...

反正...

您会注意到 MS 已经将这种技术用于以下类型：

```
this.treeView1 = new System.Windows.Forms.TreeView();
this.treeView1.Location = new System.Drawing.Point(72, 104);
this.treeView1.Name = "treeView1";
this.treeView1.Nodes.AddRange(
new System.Windows.Forms.TreeNode[] {
  new System.Windows.Forms.TreeNode("Node0"),
  new System.Windows.Forms.TreeNode("Node1")}); 
```

基本上 - 在您的 TypeConverter 中，您覆盖“ConverterTo”方法，并返回一个新的 InstanceDescriptor，它将向 WinForms 设计器描述如何实例化您的类型（使用什么构造函数，以及传递什么参数）。

您可以在这里找到更多信息（包括基本实现）：http: [//msdn.microsoft.com/en-us/library/ms973818.aspx](http://msdn.microsoft.com/en-us/library/ms973818.aspx)

InitializeComponent 非常强大，一旦您了解所有可扩展性点。快乐编码！

# c# - 如何从偏移量开始并遍历整个列表？

> ID：12556676
> 
> 赞同：1
> 
> 时间：2012-09-23T22:08:37.567
> 
> 标签：c#, list, circular-buffer

所以这就是我的清单。

```
[0], [1], [2], [3], [4] 
```

我希望能够遍历这些 - 但这里的诀窍是我想从一个偏移量开始然后循环回到那个偏移量？

前任。

```
[0], [1], [2], [3], [4]
      o-->            
//Start at offset 1 then get 2, 3, 4 then loop back around to zero 
```

例 2。

```
[0], [1], [2], [3], [4]
                o-->            
//Start at offset 3 then get 4, then loop back around to zero, then 1, 2 
```

我考虑过使用常规`List<T>`并尝试将这个概念实现到 for 循环中，但我不确定是否要这样做，如果他们这样做的方式更简洁。

基本上不要从 0 开始并循环回到起点并通过元素回到偏移量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T22:17:48.043

您实际上是在描述环形缓冲区或循环缓冲区。

[http://en.wikipedia.org/wiki/Circular_buffer](http://en.wikipedia.org/wiki/Circular_buffer)

简单的实现是

```
int start; // Set your desired start offset

for (int i = start; i < myList.Length; i++)
{
    // do stuff
}

for (int j = 0; j < start; j++)
{
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T16:44:12.937

这是我的 C# 实现，它使用了（我认为）我的所有依赖项的扩展方法。

我知道这似乎需要为这么简单的事情发布很多代码，但它主要是验证代码，并且在我正在编写的应用程序中非常关键，它可以完美地使用定义明确的行为。很多很多其他方法都建立在这两个功能之上。

以这种方式迭代的性能似乎也相当不错，相对于应用于迭代值的操作而言，它从来都不是瓶颈。

## Span 和 SpanRange 扩展方法

```
using System;
using System.Collections.Generic;
using Common.FluentValidation;

namespace Common.Extensions
{
    public static partial class ExtensionMethods
    {
        /// <summary>
        /// Gets the index for an array relative to an anchor point, seamlessly crossing array boundaries in either direction.
        /// Returns calculated index value of an element within a collection as if the collection was a ring of contiguous elements (Ring Buffer).
        /// </summary>
        /// <param name="p_rollover">Index value after which the iterator should return back to zero.</param>
        /// <param name="p_anchor">A fixed or variable position to offset the iteration from.</param>
        /// <param name="p_offset">A fixed or variable position to offset from the anchor.</param>
        /// <returns>calculated index value of an element within a collection as if the collection was a ring of contiguous elements (Ring Buffer).</returns>
        public static int Span(this int p_rollover, int p_anchor, int p_offset)
        {
            // Prevent absolute value of `n` from being larger than count
            int n = (p_anchor + p_offset) % p_rollover;

            // If `n` is negative, then result is n less than rollover
            if (n < 0)
                n = n + p_rollover;

            return n;
        }

        /// <summary>
        /// Iterates over a collection from a specified start position to an inclusive end position. Iterator always increments
        /// from start to end, treating the original collection as a contiguous ring of items to be projected into a new form.
        /// Returns a projected collection of items that can contain all of the items from the original collection or a subset of the items.
        /// The first item in the projected collection will be the item from the original collection at index position p_first.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="p_collection">The collection to project into a new form.</param>
        /// <param name="p_first">Zero based index value of the first element in the projected sequence.</param>
        /// <param name="p_last">Zero based index value of the last element in the projected sequence.</param>
        /// <returns>a projected collection of items that can contain all of the items from the original collection or a subset of the items.
        /// The first item in the projected collection will be the item from the original collection at index position p_first.</returns>
        public static IEnumerable<T> SpanRange<T>(this IList<T> p_collection, int p_first, int p_last)
        {
            // Validate
            p_collection
                .CannotBeNullOrEmpty("p_collection");
            p_first
                .MustBeWithinRange(0, p_collection.Count - 1, "p_first");
            p_last
                .MustBeWithinRange(0, p_collection.Count - 1, "p_last");

            // Init
            int Rollover = p_collection.Count;
            int Count = (p_first <= p_last) ? p_last - p_first : (Rollover - p_first) + p_last;

            // Iterate
            for (int i = 0; i <= Count; i++)
            {
                var n = Rollover.Span(p_first, i);
                yield return p_collection[n];
            }
        }
    }
} 
```

## 不能为空或空的依赖

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace Common.FluentValidation
{
    public static partial class Validate
    {
        /// <summary>
        /// Validates the passed in parameter is not null or an empty collection, throwing a detailed exception message if the test fails.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="p_parameter">Parameter to validate.</param>
        /// <param name="p_name">Name of tested parameter to assist with debugging.</param>
        /// <exception cref="ArgumentNullException"></exception>
        /// <exception cref="ArgumentOutOfRangeException"></exception>
        public static void CannotBeNullOrEmpty<T>(this ICollection<T> p_parameter, string p_name)
        {
            if (p_parameter == null)
                throw
                    new
                        ArgumentNullException(string.Format(
                        "The collection \"{0}\" cannot be null.",
                        p_name), default(Exception));

            if (p_parameter.Count <= 0)
                throw
                    new
                        ArgumentOutOfRangeException(string.Format(
                        "The collection \"{0}\" cannot be empty.",
                        p_name), default(Exception));
        }

        /// <summary>
        /// Validates the passed in parameter is not null or an empty collection, throwing a detailed exception message if the test fails.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="p_parameter">Parameter to validate.</param>
        /// <param name="p_name">Name of tested parameter to assist with debugging.</param>
        /// <exception cref="ArgumentNullException"></exception>
        /// <exception cref="ArgumentOutOfRangeException"></exception>
        public static void CannotBeNullOrEmpty<T>(this IEnumerable<T> p_parameter, string p_name)
        {
            if (p_parameter == null)
                throw
                    new
                        ArgumentNullException(string.Format(
                        "The collection \"{0}\" cannot be null.",
                        p_name), default(Exception));

            if (p_parameter.Count() <= 0)
                throw
                    new
                        ArgumentOutOfRangeException(string.Format(
                        "The collection \"{0}\" cannot be empty.",
                        p_name), default(Exception));
        }

        /// <summary>
        /// Validates the passed in parameter is not null or empty, throwing a detailed exception message if the test fails.
        /// </summary>
        /// <param name="p_parameter">Parameter to validate.</param>
        /// <param name="p_name">Name of tested parameter to assist with debugging.</param>
        /// <exception cref="ArgumentException"></exception>
        public static void CannotBeNullOrEmpty(this string p_parameter, string p_name)
        {
            if (string.IsNullOrEmpty(p_parameter))
                throw
                    new
                        ArgumentException(string.Format(
                        "The string \"{0}\" cannot be null or empty.",
                        p_name), default(Exception));
        }
    }
} 
```

## MustBeWithinRange 依赖

```
using System;

namespace Common.FluentValidation
{
    public static partial class Validate
    {
        /// <summary>
        /// Validates the passed in parameter is within a specified range of values, throwing a detailed exception message if the test fails.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="p_parameter">Parameter to validate.</param>
        /// <param name="p_minInclusive">The minimum valid value of the parameter.</param>
        /// <param name="p_maxInclusive">The maximum valid value of the parameter.</param>
        /// <param name="p_name">Name of tested parameter to assist with debugging.</param>
        /// <exception cref="ArgumentOutOfRangeException"></exception>
        public static void MustBeWithinRange<T>(this IComparable<T> p_parameter, T p_minInclusive, T p_maxInclusive, string p_name)
            where T : struct
        {
            if (p_parameter.CompareTo(p_minInclusive) == -1)
                throw
                    new
                        ArgumentOutOfRangeException(string.Format(
                        "Parameter cannot be less than {0}, but \"{1}\" was {2}.",
                        p_minInclusive, p_name, p_parameter), default(Exception));

            if (p_parameter.CompareTo(p_maxInclusive) == 1)
                throw
                    new
                        ArgumentOutOfRangeException(string.Format(
                        "Parameter cannot be greater than {0}, but \"{1}\" was {2}.",
                        p_maxInclusive, p_name, p_parameter), default(Exception));
        }
    }
} 
```

注意：包含我的单元测试依赖项的代码太多了，所以如果你有自己的类似扩展方法，希望测试用例名称的冗长可以说明问题，或者只是注释掉像我的`Print()`声明这样的东西，它只是转储所有值以半智能方式到 StringBuilder。您将需要 NuGet 提供的 FluentValidation，或者只需将 ...Should().Be(...) 替换为您的标准 Assert(...) 方法。

## 单元测试跨度（NUnit 框架）

```
using System;
using System.Text;
using Common.Extensions;
using Common.FluentValidation;
using FluentAssertions;
using NUnit.Framework;

namespace UnitTests.CommonTests.Extensions
{
    [TestFixture, Timeout(1000)]
    public class Span_Tests
    {
        // Test Anchoring
        [Test]
        public void Span_10_anchored_at_0_with_no_offset_should_be_0_Tests()
        {
            10.Span(0, 0).Should().Be(0);
        }

        [Test]
        public void Span_10_anchored_at_1_with_no_offset_should_be_1_Tests()
        {
            10.Span(1, 0).Should().Be(1);
        }

        [Test]
        public void Span_10_anchored_at_negative_1_with_no_offset_should_be_9_Tests()
        {
            10.Span(-1, 0).Should().Be(9);
        }

        [Test]
        public void Span_10_anchored_at_negative_10_with_no_offset_should_be_0_Tests()
        {
            10.Span(-10, 0).Should().Be(0);
        }

        // Test Offset
        [Test]
        public void Span_10_anchored_at_0_with_offset_of_1_should_be_1_Tests()
        {
            10.Span(0, 1).Should().Be(1);
        }

        [Test]
        public void Span_10_anchored_at_0_with_offset_of_negative_1_should_be_9_Tests()
        {
            10.Span(0, -1).Should().Be(9);
        }

        [Test]
        public void Span_10_anchored_at_0_with_offset_of_negative_10_should_be_0_Tests()
        {
            10.Span(0, -10).Should().Be(0);
        }

        // Test Iterations
        [Test]
        public void Span_array_of_10_anchored_at_0_can_walk_forward_thru_elements_twice_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var SequentialData = new int[10];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());

                for (int i = 0; i < 20; i++)
                {
                    var n = SequentialData.Length.Span(0, i);

                    SequentialData[n].Should().Be(i % 10);
                }
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void Span_array_of_10_anchored_at_0_can_walk_backwards_thru_elements_twice_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var SequentialData = new int[10];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());

                for (int i = 0; i > -20; i--)
                {
                    var n = SequentialData.Length.Span(0, i);
                    var j = (i % 10);

                    switch (j)
                    {
                        case 0: SequentialData[n].Should().Be(0); break;
                        case -1: SequentialData[n].Should().Be(9); break;
                        case -2: SequentialData[n].Should().Be(8); break;
                        case -3: SequentialData[n].Should().Be(7); break;
                        case -4: SequentialData[n].Should().Be(6); break;
                        case -5: SequentialData[n].Should().Be(5); break;
                        case -6: SequentialData[n].Should().Be(4); break;
                        case -7: SequentialData[n].Should().Be(3); break;
                        case -8: SequentialData[n].Should().Be(2); break;
                        case -9: SequentialData[n].Should().Be(1); break;

                        default:
                            throw
                                j.ToString().CannotBeSwitchedToDefault("j");
                    }
                }
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }
    }
} 
```

## 单元测试 SpanRange（NUnit 框架）

```
using System;
using System.Collections.Generic;
using System.Text;
using Common.Extensions;
using FluentAssertions;
using NUnit.Framework;

namespace UnitTests.CommonTests.Extensions
{
    [TestFixture, Timeout(1000)]
    public class SpanRange_Tests
    {
        [Test]
        public void SpanRange_array_of_10_from_0_to_9_should_be_0_thru_9_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };

                var SequentialData = new int[10];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(0, 9));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_10_from_0_to_9_should_not_throw_ArgumentOutOfRangeException_Tests()
        {
            foreach (var item in new int[10].SpanRange(0, 9))
            { }
        }

        [Test, ExpectedException(typeof(ArgumentOutOfRangeException))]
        public void SpanRange_array_of_10_from_0_to_10_should_throw_ArgumentOutOfRangeException_Tests()
        {
            foreach (var item in new int[10].SpanRange(0, 10))
            { }
        }

        [Test, ExpectedException(typeof(ArgumentOutOfRangeException))]
        public void SpanRange_array_of_10_from_negative_1_to_9_should_throw_ArgumentOutOfRangeException_Tests()
        {
            foreach (var item in new int[10].SpanRange(-1, 9))
            { }
        }

        [Test]
        public void SpanRange_array_of_10_from_1_to_0_should_be_1_thru_9_then_0_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 1, 2, 3, 4, 5, 6, 7, 8, 9, 0 };

                var SequentialData = new int[10];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(1, 0));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_10_from_1_to_3_should_be_1_thru_3_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 1, 2, 3 };

                var SequentialData = new int[10];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(1, 3));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_10_from_9_to_1_should_be_9_0_and_1_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 9, 0, 1 };

                var SequentialData = new int[10];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(9, 1));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_5_from_1_to_4_should_be_1_thru_4_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 1, 2, 3, 4 };

                var SequentialData = new int[5];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(1, 4));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_5_from_0_to_0_should_be_0_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 0 };

                var SequentialData = new int[5];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(0, 0));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_5_from_1_to_1_should_be_1_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 1 };

                var SequentialData = new int[5];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(1, 1));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_5_from_4_to_0_should_be_4_then_0_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 4, 0 };

                var SequentialData = new int[5];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(4, 0));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }

        [Test]
        public void SpanRange_array_of_5_from_1_to_0_should_be_1_thru_4_then_0_Tests()
        {
            var sb = new StringBuilder();

            try
            {
                var Expected = new List<int>() { 1, 2, 3, 4, 0 };

                var SequentialData = new int[5];
                for (int i = 0; i < SequentialData.Length; i++)
                    SequentialData[i] = i;

                sb.AppendFormat("SequentialData:\r\n{0}", SequentialData.Print());
                sb.AppendLine();

                var Range = new List<int>(SequentialData.SpanRange(1, 0));

                sb.AppendFormat("Range:\r\n{0}", Range.Print());

                Range.ShouldBeEquivalentTo(Expected);
            }
            catch (Exception)
            {
                Console.WriteLine(sb.ToString());
                throw;
            }
        }
    }
} 
```

# data-structures - 来自中序和后序的二叉树

> ID：12556682
> 
> 赞同：2
> 
> 时间：2012-09-23T22:09:45.380
> 
> 标签：data-structures, binary-tree

我刚开始研究二叉树。给定中序和后序或中序和前序，是否有算法可以找出二叉树结构？我一直在尝试手动操作，但它永远不会正确。例如，这两个是给定树的有效 Inorder 和 Postorder 遍历：

订购：DBFEAGCLJHK 后订购：DFEBGLJKHCA

显然 A 是根，因为它是 Postorder 中的最后一个元素。现在按顺序看，左子树变为：{DBFE}，右子树变为：{GCLJHK}。右子树的根将是前序中的倒数第二个元素，即 C。我现在可以进一步划分右子树（以 C 为根），将 {G} 作为右子树，将 {LJHK} 作为左子树。因此我有这个结构：

```
 A
                                \
                                 C
                                /  
                               G 
```

但是，无论我应用什么算法，next 似乎对不同的树都有不同的工作方式。有人请解释一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:47:55.407

如果我理解您的要求，那么您尝试对给定二叉树搜索算法的底层结构进行逆向工程，因为它的原始数据处于前后状态。如果是这种情况，您可能会走上一条艰难的道路，因为尽管基本算法是相同的，但可能会有细微差别，具体取决于构建算法的开发人员，因为在实践中，开发人员通常不会构建纯粹的这些算法的实现。

如果您只是想更好地理解二叉树，这可能会更好地解释它：[http ://www.youtube.com/watch?v=ZkH3SSPwcwI](http://www.youtube.com/watch?v=ZkH3SSPwcwI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T19:24:13.990

让中序和前序遍历分别在数组 iorder 和 porder 中给出。

构建树的函数将由 buildTree(i,j,k) 表示，其中 i,j 指的是要查看的中序数组的范围，k 是前序数组中的位置。

初始调用将是 buildTree(0,n-1,0)

该算法有以下步骤：

1.  从头开始遍历。第一个节点是根，然后我们有左子树，然后是右子树。创建一个以此为元素的节点。

2.  在 iorder 数组中搜索节点。假设它在 x 处找到。递减 k。k 指的是我们当前所在的 porder 数组中的位置。k 必须通过引用传递。

3.  最后用递归调用的返回值填充左孩子和右孩子 left child = buildTree(i,x-1,k) right child = buildTree(x+1,j,k)

4.  最后返回节点

PS：得到上述算法接受的代码

[http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=24&page=show_problem&problem=477](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=24&page=show_problem&problem=477)

# c# - 如何使组框中的单选按钮选择出现在标签中？

> ID：12556684
> 
> 赞同：0
> 
> 时间：2012-09-23T22:09:55.177
> 
> 标签：c#, radio-button, label, groupbox

当用户从组框中的单选按钮中选择一个选项以显示在标签中时，有没有办法？

它将与 Quantity/Phone Type 紧随其后`numberPhoneTextBox.Text`。

共有 3 个单选按钮供用户选择。

```
private void displayButton_Click(object sender, EventArgs e)
{
    summaryLabel.Text = "Receipt Summary\n" +
        "--------------\n" +
        "Name: " + nameTextBox.Text +
        "\nAddress: " + streetTextBox.Text +
        "\nCity: " + cityTextBox.Text +
        "\nState: " + stateTextBox.Text +
        "\nZip Code: " + zipTextBox.Text +
        "\nPhone Number: " + phoneNumberTextBox.Text +
        "\nDate: " + dateMaskedBox.Text +
        "\n-------------------------" +
        "\nQuantity/Phone Type: " + numberPhoneTextBox.Text + "/";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:22:13.280

不幸的是，您必须手动完成。您可以定义一个方法或属性来为您执行任务以避免重复代码，如下所示：

```
String GetRadioButtonValue() {
         if( radioButton1.Checked ) return radioButton1.Text;
    else if( radioButton2.Checked ) return radioButton2.Text;
    else                            return radioButton3.Text;
} 
```

更新：

显然，OP 的分配“不允许用户使用 if/else 语句”——这很超现实，但您可以通过多种方式避开它，例如使用`?:`运算符：

```
String GetRadioButtonValue() {
    return radioButton1.Checked ? radioButton1.Text
         : radioButton2.Checked ? radioButton2.Text
                                : radioButton3.Text;
} 
```

另一种选择是使用事件：

```
private String _selectedRadioText;

public MyForm() { // your form's constructor
    InitializeComponent();
    radioButton1.CheckedChanged += RadioButtonCheckedChanged;
    radioButton2.CheckedChanged += RadioButtonCheckedChanged;
    radioButton3.CheckedChanged += RadioButtonCheckedChanged;
    // or even:
    // foreach(Control c in this.groupBox.Controls)
    //     if( c is RadioButton )
    //         ((RadioButton)c).CheckedChanged += RadioButtonCheckedChanged;

    // Initialize the field
    _selectedRadioText = radioButton1.Text;
}

private void RadioButtonCheckedChanged(Object sender, EventArgs e) {
    _selectedRadioText = ((RadioButton)sender).Text;
}

// then just concatenate the _selectedRadioText field into your string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T00:33:16.093

顺便说一句，您应该改掉使用字符串连接的习惯。这是非常低效的。相反，尝试这样的事情：

```
private void displayButton_Click(object sender, EventArgs e)
{
    summaryLabel.Text =
        string.Format(
            "Receipt Summary\n--------------\nName: {0}\nAddress: {1}\nCity: {2}\nState: {3}\nZip Code: {4}\nPhone Number: {5}\nDate: {6}\n-------------------------\nQuantity/Phone Type: {7}/",
            nameTextBox.Text,
            streetTextBox.Text,
            cityTextBox.Text,
            stateTextBox.Text,
            zipTextBox.Text,
            phoneNumberTextBox.Text,
            dateMaskedBox.Text,
            numberPhoneTextBox.Text);
} 
```

# javascript - 是否有类似于 MATLAB erfinv() 的逆误差函数的 JavaScript 实现？

> ID：12556685
> 
> 赞同：10
> 
> 时间：2012-09-23T22:10:21.720
> 
> 标签：javascript

是否有逆错误函数的 JavaScript 实现？这将实现高斯逆误差函数。近似值没问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T22:13:15.320

为什么是。有。

以下代码使用内置 JavaScript 函数并实现 Abramowitz 和 Stegun 的算法，如下[所述](http://en.wikipedia.org/wiki/Error_function#Inverse_functions)：

```
 function erfinv(x){
        var z;
        var a  = 0.147;                                                   
        var the_sign_of_x;
        if(0==x) {
            the_sign_of_x = 0;
        } else if(x>0){
            the_sign_of_x = 1;
        } else {
            the_sign_of_x = -1;
        }

        if(0 != x) {
            var ln_1minus_x_sqrd = Math.log(1-x*x);
            var ln_1minusxx_by_a = ln_1minus_x_sqrd / a;
            var ln_1minusxx_by_2 = ln_1minus_x_sqrd / 2;
            var ln_etc_by2_plus2 = ln_1minusxx_by_2 + (2/(Math.PI * a));
            var first_sqrt = Math.sqrt((ln_etc_by2_plus2*ln_etc_by2_plus2)-ln_1minusxx_by_a);
            var second_sqrt = Math.sqrt(first_sqrt - ln_etc_by2_plus2);
            z = second_sqrt * the_sign_of_x;
        } else { // x is zero
            z = 0;
        }
  return z;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-17T16:25:16.120

这篇文章前面提供的函数对我不起作用......在 33 米圆上的 NaN 结果，置信度 65% 表示为 65.0......我根据此处列出的公式编写了以下内容[https://en.wikipedia.org/ wiki/Error_function#Inverse_functions](https://en.wikipedia.org/wiki/Error_function#Inverse_functions)并且运行良好：

```
var _a = ((8*(Math.PI - 3)) / ((3*Math.PI)*(4 - Math.PI)));

function erfINV( inputX )
{
    var _x = parseFloat(inputX);
    var signX = ((_x < 0) ? -1.0 : 1.0 );

    var oneMinusXsquared = 1.0 - (_x * _x);
    var LNof1minusXsqrd  = Math.log( oneMinusXsquared );
    var PI_times_a       = Math.PI * _a ;

    var firstTerm  = Math.pow(((2.0 / PI_times_a) + (LNof1minusXsqrd / 2.0)), 2);
    var secondTerm = (LNof1minusXsqrd / _a);
    var thirdTerm  = ((2 / PI_times_a) + (LNof1minusXsqrd / 2.0));

    var primaryComp = Math.sqrt( Math.sqrt( firstTerm - secondTerm ) - thirdTerm );

    var scaled_R = signX * primaryComp ;
    return scaled_R ;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-09T20:21:20.277

这是 Abramowitz 和 Stegun 算法的另一种实现（相当于 ptmalcolm 的答案，但更简洁，速度是原来的两倍）：

```
function erfinv(x) {
  // maximum relative error = .00013
  const a  = 0.147  
  //if (0 == x) { return 0 }
  const b = 2/(Math.PI * a) + Math.log(1-x**2)/2
  const sqrt1 = Math.sqrt( b**2 - Math.log(1-x**2)/a )
  const sqrt2 = Math.sqrt( sqrt1 - b )
  return sqrt2 * Math.sign(x)
} 
```

[![逆误差函数的近似方程](../Images/37c0e068699eb6be67e82ee45656e70b.png)](https://i.stack.imgur.com/pc0aQ.png)

您可以使用以下方法测试速度`console.time("erfinv"); for (let i=0; i<1000000000; i++) {erfinv(i/1000000000)}; console.timeEnd("erfinv")`

语句优化被注释掉了，`if`因为它似乎没有什么不同——大概解释器认识到这只是一个等式。

如果您需要更准确的近似值，请查看[Wikipedia](https://en.wikipedia.org/wiki/Error_function#Numerical_approximations)。

# android - 从自行实现的 Android 应用程序访问 Google Drive

> ID：12556687
> 
> 赞同：2
> 
> 时间：2012-09-23T22:10:24.277
> 
> 标签：android, google-drive-api

我的问题是，**我想使用任何 SDK 或 API 从我的 android 手机访问我的 google drive，而无需在我的 android 手机上使用现有的 google drive 应用程序。**

我阅读了这方面的说明：[google drive sdk](https://developers.google.com/drive/) 代码示例仅适用于桌面应用程序，并且侧面的“与 Android 集成”主题没有提供任何示例，我如何从我的 android 应用程序访问我的 google 驱动器。

我已经[在这里阅读了 android-api-for-google-drive ，](https://stackoverflow.com/questions/10306456/android-api-for-google-drive)但这只会导致更多的链接和操作方法，这些链接和操作方法非常复杂和模糊。

有没有人有从 android 应用程序连接到 google-drive 的经验，并且可以帮助任何示例代码或“简洁明了”的教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T03:23:14.377

幸运的是，就在您提出这个问题之后，Google 发布了他们的 Play 服务（[请参阅此链接](https://developers.google.com/android/google-play-services/)），这使得使用 Drive SDK 和 Drive API 访问文件变得非常容易。请参阅我在 Google Plus 上的帖子，其中提供了有关如何将 Android 应用程序与 Google Drive 文档集成的分步演练和代码示例：https: [//plus.google.com/u/0/114042449736049687152/posts/CD3L8zcJg5Z](https://plus.google.com/u/0/114042449736049687152/posts/CD3L8zcJg5Z)

在本教程中，我引用了一个特定的 Google IO 2012 演讲（幻灯片位于[https://docs.google.com/presentation/d/1LrEKp2PqESsES3upS1xsSARz35KS-9QHnYFTKvS2yzM/preview#slide=id.p19](https://docs.google.com/presentation/d/1LrEKp2PqESsES3upS1xsSARz35KS-9QHnYFTKvS2yzM/preview#slide=id.p19)），但请阅读我的 G+ 帖子，因为我浏览本演示文稿中的各种缺陷、陷阱和遗漏的细节。

在开始编写任何代码之前，请先注册 Google API（[请参阅此链接](https://code.google.com/apis/console/)），进入 API 控制台，然后打开 Google Drive API 和 Drive SDK。

祝你好运，玩得开心！

# c# - 如何使用 C# 从 UI 中终止线程

> ID：12556688
> 
> 赞同：3
> 
> 时间：2012-09-23T22:10:23.820
> 
> 标签：c#

我启动了一个线程，我希望用户能够通过单击表单上的按钮来中断它。我找到了以下代码，它很好地展示了我想要的东西。

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;
using System.Threading;

namespace ExThread {

public partial class MainForm : Form {
    public int clock_seconds=0;

    [STAThread]
    public static void Main(string[] args) {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MainForm());
    }

    public MainForm() {
        InitializeComponent();

        Thread thread_clock = new Thread(new ThreadStart(Thread_Clock));
        thread_clock.IsBackground = true;
        thread_clock.Start();
    }

    delegate void StringParameterDelegate (string value);

    public void Update_Label_Seconds(string value) {
        if (InvokeRequired) {
            BeginInvoke(new StringParameterDelegate(Update_Label_Seconds), new object[]{value});
            return;
        }
        label_seconds.Text= value + " seconds";
    }       

    void Thread_Clock() {
        while(true) {
            clock_seconds +=1;
            Update_Label_Seconds(clock_seconds.ToString());
            Thread.Sleep(1000);
        }
    }

    private void btnStop_Click(object sender, EventArgs e)
    {

    }
}
} 
```

我添加了 btnStop 方法。需要添加什么代码来停止thread_clock线程。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T22:12:54.223

首先，线程需要能够识别它应该结束。改变

```
void Thread_Clock() {
    while(true) { 
```

至

```
bool endRequested = false;
void Thread_Clock() {
    while(!endRequested) { 
```

然后在您的按钮单击处理程序中将 endRequested 设置为 True。

```
private void btnStop_Click(object sender, EventArgs e)
{
    endRequested = true;
} 
```

请注意，对于这种特定情况，使用 Timer 可能更合适

[http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)

只需根据需要启动和停止计时器。您将从计时器的 Tick() 事件中更新时钟。

# python - 检查组合字符串中子字符串顺序的算法

> ID：12556691
> 
> 赞同：1
> 
> 时间：2012-09-23T22:10:45.660
> 
> 标签：python, string, algorithm

问题如下：如果有两个字符串`str1`和`str2`，以及另一个字符串`str3`，编写一个函数来检查是否`str3`包含`str1`' 字母 和`str2`' 字母，它们的序列是否与原始序列相同，尽管它们可能是交错的。因此，**adbfec为子字符串****adf**和**bec**返回 true 。我在 Python 中编写了以下函数：

```
def isinter(str1,str2,str3):
    p1,p2,p3 = 0,0,0
    while p3 < len(str3):
        if p1 < len(str1) and str3[p3] == str1[p1]:
            p1 += 1
        elif p2 < len(str2) and str3[p3] == str2[p2]:
            p2 += 1
        else:
            break
        p3 = p1+p2
    return p3 == len(str3) 
```

该程序还有另一个版本，位于[ardentart](http://www.ardendertat.com/2011/10/10/programming-interview-questions-6-combine-two-strings/)（最后一个解决方案）。现在哪个更好？我认为是我的，因为它可能在线性时间内完成。不管好不好，我的算法还有进一步优化的空间吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:40:00.753

不幸的是，您的版本无法正常工作。想象一下输入 `ab`, `ac`, `acab`. 您的算法返回`False`不正确。

`str1`问题是当看到的字母`str3`可以双向解释时，你总是走路；`str2`可能需要走路，但它不会与您的算法获得平等的机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:24:33.637

另一种方法是使用python的正则表达式模块re。您可以拆分 str1 的字符，并用 .* 包围每个字符以匹配它们之间的任意数量（或无）字符。这将为您提供匹配 str1 的模式。然后对 str2 执行相同的操作，然后只需运行 re.match(str1pattern, str3) 和 re.match(str2pattern, str3)。如果它们都返回对象（即除了 None 之外的任何东西），那么你对这两个字符串都有一个匹配项。

这可能会更好地扩展，因为它更容易添加更多要检查的字符串，如果您需要更好的性能来搜索各种其他字符串，那么您也可以编译模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:27:20.833

您可以拆分列表中的所有三个字符串：

```
list1 = list(str1) 
```

然后`list3`用你现在使用的相同算法行走，检查是否`list3[i]`等于`list1[0]`或`list2[0]`。如果是的话，您会`del`从相应的列表中获得该项目。

然后可以将过早的列表结束作为异常捕获。

该算法将完全相同，但实现应该更高性能。

**更新**：事实证明它实际上不是（大约两倍的时间）。哦，好吧，知道可能有用。

在对不同场景进行基准测试时，事实证明，除非指定三个字符串长度是“精确的”（即 len(p1)+len(p2) == len(p3) ），否则最有效的优化是*检查*第一件事。这会立即丢弃两个输入字符串由于字符串长度错误而*无法*匹配第三个的所有情况。

然后我遇到了一些情况，两个字符串中都有相同的字母，将它分配给 list1 或 list2 可能会导致其中一个字符串不再匹配。在这些情况下，算法会因误报而失败，这将需要递归。

```
def isinter(str1,str2,str3,check=True):
    # print "Checking %s %s and %s" % (str1, str2, str3)
    p1,p2,p3 = 0,0,0
    if check:
        if len(str1)+len(str2) != len(str3):
            return False
    while p3 < len(str3):
        if p1 < len(str1) and str3[p3] == str1[p1]:
            if p2 < len(str2) and str3[p3] == str2[p2]:
                # does str3[p3] belong to str1 or str2?
                if True == isinter(str1[p1+1:], str2[p2:], str3[p3+1:], False):
                   return True
                if True == isinter(str1[p1:], str2[p2+1:], str3[p3+1:], False):
                   return True
                return False
            p1 += 1
        elif p2 < len(str2) and str3[p3] == str2[p2]:
            p2 += 1
        else:
            return False
        p3 += 1
    return p1 == len(str1) and p2 == len(str2) and p3 == len(str3) 
```

然后我在随机字符串上运行了一些基准测试，这就是仪器（*注意它总是生成**有效**的随机播放，这可能会产生有偏差的结果*）：

```
for j in range(3, 50):
        str1 = ''
        str2 = ''
        for k in range(1, j):
                if random.choice([True, False]):
                        str1 += chr(random.randint(97, 122))
                if random.choice([True, False]):
                        str2 += chr(random.randint(97, 122))
        p1 = 0
        p2 = 0
        str3 = ''
        while len(str3) < len(str1)+len(str2):
                if p1 < len(str1) and random.choice([True, False]):
                        str3 += str1[p1]
                        p1 += 1
                if p2 < len(str2) and random.choice([True, False]):
                        str3 += str2[p2]
                        p2 += 1
        a = time.time()
        for i in range(1000000):
                isShuffle2(str1, str2, str3)
        a = (time.time() - a)
        b = time.time()
        for i in range(1000000):
                isinter(str1, str2, str3)
        b = (time.time() - b)

        print "(%s,%s = %s) in %f against %f us" % (str1, str2, str3, a, b) 
```

结果似乎表明缓存+DP算法对于**短**字符串的效率更高。当字符串变长（超过 3-4 个字符）时，缓存+DP 算法开始失势。在长度约为 10 时，上述算法的执行速度是完全递归的缓存版本的两倍。

如果字符串包含重复字符（我通过限制从 az 到 ai 的范围来做到这一点）并且重叠很小，则 DP 算法的性能更好，但仍然比上述算法差。例如，在这种情况下，DP 仅损失 2us：

```
(cfccha,ddehhg = cfcchaddehhg) in 68.139601 against 66.826320 us 
```

毫不奇怪，完全重叠（每个字符串依次一个字母）的差异更大，比率高达 364:178（略高于 2:1）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T08:57:45.397

首先，只是一个实现点：我认为您可能会摆脱对 str1 和 str2 长度的测试。在 C 中，字符串以 nul 字符结尾，所以这个特殊字符永远不会在 str3 中找到。所以只要`p1++`找到正确的字符就可以了。但是在 python 中，我不记得这个功能是否存在......对不起，我不是一个认真的 python 用户。如果 p1==len(p1)，str1[p1] 的输出是什么？

除此之外，正如 Jirka Hanika 所指出的，您的代码输出是错误的。我见过另一种失败的情况：如果一个字符在两个子字符串中都是通用的。例如：如果 str1="abc", str2="dbe"，则 str3="adbec" 包含 str1 和 str2，但您的算法在这种情况下失败。问题来自`elif`语句，而不是另一个 if。

Iserni 的代码输出在我看来是正确的。

# sql - 如何在结果集中均匀分布 3 个连接字段

> ID：12556692
> 
> 赞同：0
> 
> 时间：2012-09-23T22:10:59.983
> 
> 标签：sql, sql-server, tsql, concatenation

我将三个字段连接到一个字段中，但是当我运行查询时，结果集是正确的，但是它们在一个字段中的间距不均匀。我将如何将它们整齐而正确地分开。感谢您的帮助。

这是查询：

```
SELECT CONVERT(varchar(20),Book)+ Space(2) + '(' + CONVERT(varchar(30),Year)
+ ')' + Space(2) + '(' + CONVERT(varchar(30),Print) + ')' As  'Film Description', Genre,
Cost
FROM Film
Order By Year DESC, Book ASC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:13:03.690

使用`Convert(Char(`而不是`Convert(Varchar(` Varchars 将空格剥离..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:16:48.750

由于`VARCHAR`忽略尾随空格，您需要使用不同的数据类型（例如`CHAR`）。其他一些评论：

*   小心使用保留字，例如`year`和`print`作为列名
*   小心使用`'single quotes'`别名分隔符（`[square brackets]`更面向未来，更难与字符串文字混淆）
*   你应该使用模式前缀（例如`dbo.Film`）

```
DECLARE @Film TABLE(Book VARCHAR(255), [Year] INT, [Print] VARCHAR(255));

INSERT @Film 
SELECT 'a', 2012, 'hello there this is at least 30 characters, right?'
UNION ALL 
SELECT 'this must be at least 30 characters too, right?', 2011, 'b';

SELECT CONVERT(CHAR(20), Book)
 + SPACE(2) 
 + '(' + CONVERT(CHAR(4),[Year]) + ')' 
 + SPACE(2) 
 + '(' + CONVERT(CHAR(30), [Print]) + ')' 
 As [Film Description]
FROM @Film
Order By [Year] DESC, Book; 
```

# javascript - jQuery绑定点击立即触发

> ID：12556696
> 
> 赞同：3
> 
> 时间：2012-09-23T22:12:02.650
> 
> 标签：javascript, jquery

我有一个下拉菜单，单击该图标应将“打开”类添加到其父级，然后单击任何位置的菜单应将其关闭。但是当点击图标时，绑定内的函数会触发。效果是它添加了类 Open，然后立即将其删除。

这可能是一个简单的问题，但我似乎无法弄清楚为什么“点击”事件会立即触发！？

这个问题可能类似但还是不能解决：[jQuery bind event fire the event](https://stackoverflow.com/questions/1241276/jquery-bind-event-firing-the-event)

```
$(function () {

    $(".ui-dropdown-action").bind("click", function () {
        $(this).parent()
            .addClass("Open")
            .bind("click", function () {
                $(this).removeClass("Open");
            });
    });

}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T22:14:43.053

我认为您可能对在 DOM 树中冒泡的单击事件有问题。这就是为什么点击也会在父母身上被解雇。

如果您将事件对象作为第一个绑定的参数传入`event.stopPropagation()`并按如下方式调用

```
$(function () {

  $(".ui-dropdown-action").bind("click", function (event) {
    event.stopPropagation();
    $(this).parent()
        .addClass("Open")
        .bind("click", function () {
            $(this).removeClass("Open");
        });
  });

}); 
```

应该解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:14:54.597

您可以传递事件参数并停止事件的冒泡..试试这个

```
$(function () {

        $(".ui-dropdown-action").bind("click", function () {
            $(this).parent()
                .addClass("Open")
                .unbind().bind("click", function (e) {
                    $(this).removeClass("Open");
                    e.stopPropagation();
                });
        });

    }); 
```

这将确保单击图标时不会触发父事件。此外，每次单击图标时，父事件都会再次绑定，这将创建多个单击事件。需要确保取消绑定并绑定它们再次避免这种情况..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T22:16:08.557

它会立即触发，因为单击事件会冒泡到父级，然后触发该选择器。要解决此问题，您可以在第二次绑定周围使用 setTimeout()。

```
$(function () {
  $(".ui-dropdown-action").bind("click", function () {
    var parent = $(this).parent();
    parent.addClass("Open");
    setTimeout(function() {
      parent.bind("click", function () {
        $(this).removeClass("Open");
      });
    }, 0);
  });
}); 
```

另一种选择是在第一次绑定时对事件执行 stopPropagation()，但这会阻止任何其他处理程序触发该事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-10T17:43:29.697

就我而言，当我使用这样的东西时

```
$("#modal .button")[0].click(() => console.log('test')) 
```

它不起作用，似乎立即点击触发

我的解决方案是：

```
const button = $("#modal .button")[0];
$(button).click(() => console.log('test')); 
```

# c# - 谷歌地图 - 绘图标记仅适用于某些城市

> ID：12556711
> 
> 赞同：0
> 
> 时间：2012-09-23T22:13:17.113
> 
> 标签：c#, asp.net, maps

我正在用 ASP.NET / C# 构建一个旅行组织者应用程序。

目前，用户输入他们的目的地，我的应用程序将纬度和经度发送到 Google Places API，后者返回目的地城市的酒店列表。

然后，该应用程序会在 Google 地图 (v3) 上为酒店绘制标记，但奇怪的是仅针对某些（小）城市。如果我尝试一个主要城市，甚至是一个大城镇，地图根本不会出现。

如果为雷克雅未克的酒店返回 20 个结果，则酒店将显示没有问题。如果为都柏林、巴黎或格拉斯哥返回 20 个结果。（我想你明白了！），地图将不会显示。

我注意到这些小城市的酒店似乎都在一个相当集中的区域，所以我尝试缩小到大城市，但这仍然行不通。

有人知道为什么会这样吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T10:40:23.990

我找到了解决这个问题的方法。

问题是当我从 Yelp API 中读取酒店和酒吧名称时，我没有转义撇号字符。

一些城市显示而另一些城市没有显示的原因在于该特定区域使用的通用语言。与雷克雅未克或奥斯陆相比，都柏林和巴黎等地的名称中带有撇号的企业（例如，“O'Haras、O'Reillys、L'Entre Potes 等）的数量往往更多。导致地图脚本仅在某些城市崩溃。

对于像我这样不知道的人，您可以使用反斜杠来逃避撇号。

```
alert('O\'Neils Bar, Dublin'); 
```

# mysql - 数据库备份 SQL 查询

> ID：12556713
> 
> 赞同：1
> 
> 时间：2012-09-23T22:14:12.603
> 
> 标签：mysql, sql, database-backups

我需要以插入语句的形式从数据库中获取数据进行备份

我需要在 c# 中单击按钮来完成它。所以我认为一个 sql 查询或存储过程将适合这样做，而不是 mysqldump。

其次，我需要它们用于**所有表**。而不是写表名和列名。它们应该从 information_schema 中获取，因为查询不需要针对不同的 scema 进行更改

如果已经存在解决方案，请指导我。

**更新**：我已经准备了一个解决方案，它已发布，仍在寻找更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T20:26:10.370

### [获取整个数据库的数据 - SqlFiddle Demo](http://sqlfiddle.com/#!2/cd459/1)

 [### 只获取一张表的数据 - - SqlFiddle Demo](http://sqlfiddle.com/#!2/a3c38/1) 

我提出了一个复杂但可以接受的解决方案。**但需要改进**。

这是一个具有复杂编码的复杂过程，尤其是通过复杂连接将所有列的所有行提取到单个结果中的查询`group_concat`。

需要它简化、高效且适用于所有场景。

**我的解决方案的一些细节**：以下是重要部分，其他只是条件/循环（我对文档不方便，也需要时间和建议，有人可能会帮助我格式化和改进，抱歉给您带来不便，但我会很高兴得到你和我的任何帮助）

注意： group_concat(yourColumn separator ' --anySeparator-- ') 将列的所有行合并为一个，这样行由 --anySeparator-- 分隔

```
select group_concat(column_name separator '`,`') into @cns1 from
information_schema.columns where table_schema=dn and table_name=@tn; 
```

1 ：column_names 作为一个单独的值，由

```
`,` => @cs1 = id`,`ename`,`did

select group_concat(column_name separator '`,"\',\'",`') into @cns2
from information_schema.columns where table_schema=dn and table_name=@tn; 
```

2：column_names 是一个单独的值，由

```
`','` => @cn2  = id`','`ename`','`did

set @cns1=concat("`",@cns1,"`");    set @cns2=concat("`",@cns2,"`"); 
```

3：缺少的字母 (`) 放在列名的开头和结尾

```
set @res=concat(@res," insert into ",@tn,"(",@cns1,") values ('"); 
```

4：简单的让`res= " insert into emp(`` `,`id``ename``did`这里`,`就`) values("`可以看到我为什么要放分隔符了（MySql格式化实现了）

```
set @temp := '';
set @q := concat("select group_concat(concat(",@cns2,") separator \"'),('\")
 from ",dn,".",@tn, " into @temp"); 
```

**以上是最关键的语句**它从表中获取所有数据行作为单列的行，然后这些行被合并并由分隔`'),('`

5.1`concat(",@cns2,")`获取单个列中所有列的值。

5.2 在最外层 concat 现在 @q 是

```
 @q = "select group_concat(`id`','`ename`','`,did` separator '),(' from 
mydb.emp into @temp"; 
```

5.3 : group_concat 将该组合列的所有行合并为一个值。列值将通过@cns2 中存在的分隔符连接，行级连接将使用`'),('`

```
prepare s1 from @q;
execute s1;deallocate prepare s1;
set @res = concat(@res,@temp,");"); 
```

@q 被执行

```
set @res = concat(@res,@temp,");"); 
```

6：我们会得到如下结果

```
 res was = insert into emp(`id`,`ename`,`did`) values ('
@temp = 1','e1','4'),('2','e2','4'),
('3','e3','2'),('4','e4','4'),('5','e5','3 
```

在`@res = concat(@res,@temp,");");`我们得到之后

```
 insert into emp(`id`,`ename`,`did`) values ('1','e1','4'),('2','e2','4'),
('3','e3','2'),('4','e4','4'),('5','e5','3); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:23:36.773

```
select concat("insert into users (id,name,password) values ('",id,"'"), 
concat(",'",username,"'"),
concat(",'",password,"'),") INTO OUTFILE 'c:\\datas\\asd.txt' from users 
```

# java - 锅炉管启动器问题

> ID：12556714
> 
> 赞同：0
> 
> 时间：2012-09-23T22:14:21.137
> 
> 标签：java, exception, text-extraction, boilerpipe

我是锅炉管的新手。我试图运行他们网站上给出的示例代码：

```
 import java.net.URL;
  import de.l3s.boilerpipe.extractors.ArticleExtractor;
  import de.l3s.boilerpipe.extractors.DefaultExtractor;

    public class TESTURLBOILERPIPE {
        public static void main(String[] arges) throws Exception 

    {

         final URL url = new URL(
                    "http://www.l3s.de/web/page11g.do?sp=page11g&link=ln104g&stu1g.LanguageISOCtxParam=en");
         ArticleExtractor ae = new ArticleExtractor();
            System.out.println(ae.INSTANCE.getText(url));
    }
} 
```

我已将所有必需的 jar 文件添加到类路径中，但是出现异常：

```
Exception in thread "main" java.lang.IllegalArgumentException: usage: supply url to fetch
at org.jsoup.helper.Validate.isTrue(Validate.java:45)
at org.jsoup.examples.HtmlToPlainText.main(HtmlToPlainText.java:26) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:10:20.973

我不知道 Boilerpipe，但您确定您正在尝试运行正确的 Java 类吗？堆栈跟踪看起来像您正在尝试运行`HtmlToPlainText`（没有参数，因此异常），但是从您发布的代码中我认为您想运行您的`TESTURLBOILERPIPE`课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T16:59:39.270

尝试使用 python 包装器。它负责所有依赖项，尽管您可能必须手动安装 jpype（该源代码位于 sourceforge 上）。

[https://github.com/misja/python-boilerpipe](https://github.com/misja/python-boilerpipe)

# ruby-on-rails - 类方法上的未定义方法

> ID：12556715
> 
> 赞同：0
> 
> 时间：2012-09-23T22:14:32.413
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个用户发布的应用程序。我有一个过滤器，它将根据通过 params[] 哈希传递的值来排序和检索不同的帖子。我不断收到明显存在的类方法的无方法错误。这是我要运行的查询（**posts_controller.rb**）：

```
def room
    select_filter = params[:post_filter]
    course_id = params[:id].to_i

    @posts = Post.where_filter(select_filter, course_id).order_filter(select_filter).page(params[:page])    
end 
```

每当 'select_filter' 的值为 3 时，我都会收到此错误：

```
undefined method `order_filter' for #<Array:0x007fa012d6eef8> 
```

这是我的模型（**post.rb**，请记住，只要 'select_filter' 为 3，我就会收到错误消息）：

```
 def self.where_filter(select_filter, course_id_params)
      case select_filter.to_i
      when 1
        where('course_id = ?', course_id_params)
      when 2
        where('course_id = ?', course_id_params)
      when 3
        where('course_id = ? AND created_at > ?', course_id_params.to_i, 48.hours.ago.utc.to_s(:db))
        .reject! {|i| i.net_reputation <= 0 }
      else
        where('course_id = ?', course_id_params)
      end
    end

  def self.order_filter(select_filter)
      case select_filter.to_i
      when 1
        order('created_at DESC')
      when 2
        sort_by {|i| i.net_reputation}
      when 3
        sort_by {|i| i.net_reputation}
      else
        order('created_at DESC')
      end
  end 
```

奇怪的是，如果我在控制台中运行它，一切都很好。像这样：

```
Post.where('course_id = ? AND created_at > ?', 10, 48.hours.ago.utc.to_s(:db)).reject {|i| i.net_reputation <= 0 }.sort_by {|i| i.net_reputation} 
```

任何和所有输入表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:18:36.153

这是因为您的“where_filter”方法正在将其从活动记录关系对象更改为数组：

```
.reject! {|i| i.net_reputation <= 0 } 
```

一旦发生这种情况，您就不能再将其他查询方法链接到它上面。为什么不将“i.net_reputation <= 0”作为 where 查询的一部分？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T00:20:54.260

出于某种原因，当我将查询和排序折叠到一个类方法中时，它起作用了。但是，由于 Kiminari（我用于分页）默认情况下无法对数组进行分页，因此我必须使用该`Kaminari.pageinate_array()`方法。

我的posts_controller.rb：

```
def room
    @course = Course.find(params[:id])
    select_filter = params[:post_filter]
    course_id = params[:id].to_i

    query_posts = Post.select_input_filter(select_filter, course_id)
    @posts = Kaminari.paginate_array(query_posts).page(params[:page])
end 
```

我的帖子.rb：

```
def self.select_input_filter(select_filter, course_id_params)
    case select_filter.to_i
    when 1
      where('course_id = ?', course_id_params)
      .order('created_at DESC')
    when 2
      where('course_id = ?', course_id_params)
      .sort_by {|i| i.net_reputation}
      .reverse
    when 3
      where('course_id = ? AND created_at > ?', course_id_params.to_i, 48.hours.ago.utc.to_s(:db))
      .reject! {|i| i.net_reputation <= 0 }
      .sort_by {|i| i.net_reputation}
      .reverse
    else
      where('course_id = ?', course_id_params)
      .order('created_at DESC')
    end
end 
```

# c# - Unable to make a private void NAME(); in C#

> ID：12556730
> 
> 赞同：-1
> 
> 时间：2012-09-23T22:16:34.597
> 
> 标签：c#, void

So I have this code:

```
private void update();
{

} 
```

In visual studio, it shows up like this:

![enter image description here](../Images/c5ab514370e2b3db399fa5ddfb7c0455.png)

The errors are:

Type or namespace definition, or end-of-file expected Invalid token '{' in class, struct, or interface member declaration

Why does it do this? It's not in another void or anything.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T22:17:14.237

remove the `;` after `private void.`

```
private void update()
{

} 
```

# tornado - 将 GridFS 与 Tornado 模板一起使用

> ID：12556738
> 
> 赞同：0
> 
> 时间：2012-09-23T22:17:41.933
> 
> 标签：tornado, pymongo, gridfs

使用 GridFS 图片制作循环时遇到问题：

```
class VentesHandler(BaseHandler): 
    @tornado.web.authenticated 
    def get(self): 
        user = self.get_secure_cookie("mechtari") 
        info = tornado.escape.json_decode(user) 
        email = info["personnel"]["email"] 
        produits = self.db.users.find({"personnel.email":email},{"produit_up":1, "_id":0}).distinct("produit_up") 
        produit_pic_id = self.db.users.find({"personnel.email":email}).distinct("produit_up.avatar.photo") 
        orientation = self.db.users.find({"personnel.email":email}).distinct("produit_up.avatar.orientation") 
        renderer = self.fs 
        self.render("ventes.html", produits=produits, produit_pic_id=produit_pic_id, orientation=orientation, renderer=renderer) 
```

和模板：

```
{% for produit in produits %} 
{% for id in produit_pic_id %} 
<div class="produit"> 
{% import pymongo %} 
{% if orientation=="portrait" %} <!-- dumb technic to avoid image stretching ^_^ --> 
<span><img src="/{{renderer.get(pymongo.son_manipulator.ObjectId([id for id in produit_pic_id])).filename}}" height="200px" class="imag"> 
 {% else %} 
 <span><img src="/{{renderer.get(pymongo.son_manipulator.ObjectId(id)).filename}}" width="200px"class="imag"> 
 {% end %} 
 </div> 
 </div> 
{% end %} 
{% end %} 
{% end %} 
```

我得到的图片重复上传产品的时间！因此，如果我上传了 2 个产品（product_up），那么我将获得 4 个产品，并且可以切换产品图片！顺便说一句，注意要避免的黑客攻击（自我未定义......）以及导入呢？我做另一个变量吗

```
x = pymongo.son_manipulator 
```

避免模​​板加载整个模块并使用大量内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T09:33:49.533

解决了，循环中有一个循环。 [在 Google 群组上回答](https://groups.google.com/group/python-tornado/browse_thread/thread/6382bcfa028d547)

这是代码：

```
class VentesHandler(BaseHandler): 
    @tornado.web.authenticated 
    def get(self): 
        user = self.get_secure_cookie("mechtari") 
        info = tornado.escape.json_decode(user) 
        email = info["personnel"]["email"] 
        try: 
            produits = self.db.users.find({"personnel.email":email}, {"produit_up":1, "_id":0}).distinct("produit_up") 
            renderer = self.fs 
        except (errors.AutoReconnect, errors.ConnectionFailure): 
            self.redirect("/error") 
    self.render("ventes.html", produits=produits, renderer=renderer) 
```

模板：

```
{% for produit in produits %} 
<div class="produit"> 
{% from bson import ObjectId %} 
{% if produit["avatar"]["orientation"]=="portrait" %} 
<span><img src="/{{renderer.get(ObjectId(produit["avatar"] ["photo"])).filename}}" height="300px" class="imag"> 
{% else %} 
<span><img src="/{{renderer.get(ObjectId(produit["avatar"] ["photo"])).filename}}"width="300px"class="imag">
{% end %} 
</div> 
{% end %} 
```

# html - jQuery Mobile ScrollView 仅适用于垂直滚动

> ID：12556742
> 
> 赞同：3
> 
> 时间：2012-09-23T22:18:11.037
> 
> 标签：html, css, jquery-mobile, scrollview

乍一看，似乎有一些关于缺少垂直滚动的问题。我的问题恰恰相反，我有垂直滚动但没有水平滚动。这是有问题的页面：

[http://bgmobile.sytes.net/dogs/threegenpedigree/1](http://bgmobile.sytes.net/dogs/threegenpedigree/1)

我一定错过了一些基本的东西......但我的 JS/CSS-Fu 并不强大。

编辑：我刚刚在scrollview.js 中注意到它添加了值为'y' 的数据滚动属性。我已将其更改为“true”，但仍然无法解决。在检查默认值后，我还从 scrollview() 调用中删除了 opts 参数，但它仍然只能垂直滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:47:13.293

这是样式问题添加CSS如下

```
 .containerstyle{

      }
      .containerstyle > .ui-scrollview-view {
       width: 1300px;/*specify the width you want ,
       put a larger value than your screen resolution*/           
      } 
```

并更改 div 的代码如下

```
 <div data-scroll="true" class="containerstyle"></div> 
```

希望这有帮助。

# php - 如何在 HTML 页面中获取图像的文件类型？

> ID：12556744
> 
> 赞同：0
> 
> 时间：2012-09-23T22:18:16.200
> 
> 标签：php

我编写了一个简短的脚本来从 URL 上传图像，以免热链接到它们。如果图像扩展名不是 .jpeg，则上传的图像会损坏。我不知道如何保留文件扩展名或文件名，所以我不得不为它们添加时间戳和静态扩展名。

```
<?php

    ini_set('user_agent', 'TEST/1.0 +http://127.0.0.1');

    require_once('simple_html_dom.php');

    // Create DOM from URL
    $html = file_get_html('http://www.discogs.com/viewimages?release='.$_POST["album_id"]);

    // Grab the coverart
    $img = $html->find('.image_frame', 0);

    $url = $img->src;

    $file = file_get_contents($url);

    $image = 'discogs_'.time().'_image.jpeg';

    file_put_contents('/path/to/file/'.$image,$file);

    echo $image;

?> 
```

**在 Baba 的帮助下更新了代码**：http : [//codepad.org/3zH3B882](http://codepad.org/3zH3B882)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:29:30.553

您可以尝试使用`getimagesize`with`image_type_to_extension`

```
require_once('simple_html_dom.php');
$url = "http://www.discogs.com/viewimages?artist=Test+%282%29";
$html = file_get_html($url);
$img = $html->find('.image_frame', 0);
$info = getimagesize($img->src);
$extention = image_type_to_extension($info[2]);
$image = 'discogs_'.time().'_image' . $extention;
echo $image ; 
```

输出

```
discogs_1348438953_image.gif 
```

# objective-c - 将 XIB 文件用于自定义 Tableview 部分标题

> ID：12556750
> 
> 赞同：8
> 
> 时间：2012-09-23T22:18:48.027
> 
> 标签：objective-c, xcode, uitableview, storyboard, xib

我想使用 xib 文件来自定义 xcode（目标 C）中的 tableview 部分，这是我的文件：

SectionHeaderView.xib 是一个带有 UILabel 的 UIView

SectionHeaderView.m

```
#import "SectionHeaderView.h"

@implementation SectionHeaderView

@synthesize sectionHeader;

@end 
```

SectionHeaderView.h

```
#import <UIKit/UIKit.h>

@interface SectionHeaderView : UIView
{
IBOutlet UILabel *sectionHeader;
}

@property (nonatomic, strong) IBOutlet UILabel *sectionHeader;

@end 
```

在我的 MasterViewController.m

```
#import "SectionHeaderView.h"

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

SectionHeaderView  *header = [[[NSBundle mainBundle] loadNibNamed:@"SectionHeaderView" owner:self options:nil] objectAtIndex:0];

return header;

} 
```

到这里为止一切正常，但是一旦我将 XIB 文件所有者的自定义类设置为“SectionHeaderView”并将标签连接到“sectionHeader”，我将收到错误“NSUnknownKeyException”。我想连接这些，所以我可以在返回 haeder 之前通过以下代码更改 label.text：

```
header.sectionHeader.text = headerText; 
```

我正在为 MasterViewController 使用故事板（xcode 4.5）。将不胜感激任何帮助

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-09-16T12:40:10.170

您可以使用关联的 xib 创建 UITableViewCell 子类，并将其用作节标题。在此示例中，我将其命名为**CustomTableViewHeaderCell** .h/.m/.xib 并向您展示如何更改此单元格内标签的文本。

*   在您的 CustomTableViewHeaderCell.h 中创建一个 outlet 属性

    @property (weak, nonatomic) IBOutlet UILabel *sectionHeaderLabel;

*   将 UITableViewCell 添加到空的 CustomTableViewHeaderCell.xib 中，并 从 Identity Inspector将元素的类设置为**CustomTableViewHeaderCell 。**

*   还设置标识符（单元格的属性检查器），例如 *CustomIdentifier*。

*   将标签拖入内容视图并连接来自 **CustomTableViewHeaderCell**的出口 （不是文件所有者！）。

然后在每个 ViewController 中，您要使用表格视图部分标题单元格：

1）注册您的xib以重用标识符（可能在viewDidLoad中）：

```
[_yourTableView registerNib:[UINib nibWithNibName:@"CustomTableViewHeader" bundle:nil] forCellReuseIdentifier:@"CustomIdentifier"]; 
```

2) 覆盖 viewForHeaderInSection 以显示您的自定义单元格标题视图

```
-(UIView*)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section{
    CustomTableViewHeaderCell * customHeaderCell = [tableView dequeueReusableCellWithIdentifier:@"CustomIdentifier"];
    customHeaderCell.sectionHeaderLabel = @"What you want";
    return customHeaderCell;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-26T13:07:28.657

试试这个：我已经在我的应用程序中测试了它并且它的工作：

```
NSArray *viewArray =  [[NSBundle mainBundle] loadNibNamed:@"SectionHeaderview" owner:self options:nil];  
UIView *view = [viewArray objectAtIndex:0]; 
UILabel *lblTitle = [view viewWithTag:101]; 
lblTitle.text = @"Text you want to set"; 
return view; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-24T07:09:50.167

您可以通过以下方式之一解决此问题：

1）您从`UIView`. `UIViewController`而是派生这个类。这将解决您的问题。

2）而不是使用`IBOutlet`属性，在视图中设置标签`UILabel`（比如101）。

丢弃 SectionHeaderview 类。

保留 SectionHeaderView.XIB，仅删除 .m 和 .h 文件。

在 MasterViewController 类的 Viewforheader 方法中使用以下代码：

```
{
    UIViewController *vc=[[UIViewController alloc] initWithNibName:@"SectionHeaderview" bundle:nil]

    UILable *lblTitle =[vc.view viewWithTag:101];

    lblTitle.text =@"Text you want to set";

    return vc.view;
} 
```

# c# - 如何在条件正则表达式中添加空格

> ID：12556763
> 
> 赞同：0
> 
> 时间：2012-09-23T22:22:22.617
> 
> 标签：c#, asp.net, regex

我的一个属性有以下数据注释：

```
[RegularExpression(@"A|B|C|A and B", ErrorMessage = "You must select one.")] 
```

当我提交值“A 和 B”时，它不接受这一点，但如果我发布“A”、“B”或“C”，它就会通过。我将如何做到这一点，以便完整的字符串“A 和 B”将接受。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:33:25.550

将“A和B”放在括号中：

```
[RegularExpression(@"A|B|C|(A and B)", ErrorMessage = "You must select one.")] 
```

# iphone - MPMoviePlayerController 几秒钟后停止播放

> ID：12556764
> 
> 赞同：8
> 
> 时间：2012-09-23T22:22:26.180
> 
> 标签：iphone, objective-c, ios, xcode, mpmovieplayercontroller

`MPMoviePlayerController`几秒钟后停止播放，这是我正在使用的代码：

```
NSString *urlAddress = @"http://67.159.28.74:8730";
NSURL *url = [NSURL URLWithString:urlAddress];

MPMoviePlayerController *player = [[MPMoviePlayerController alloc]initWithContentURL:url];
player.movieSourceType = MPMovieSourceTypeStreaming;

player.view.hidden = NO;
[self.view addSubview:player.view];
[player prepareToPlay];

if(player){
    [player play];
} 
```

我进入控制台的错误是：

```
2012-09-23 18:07:56.618 Reader[696:c07] [MPAVController] Autoplay: Disabling autoplay for pause

2012-09-23 18:07:56.619 Reader[696:c07] [MPAVController] Autoplay: Disabling autoplay

2012-09-23 18:07:56.638 Reader[696:c07] [MPAVController] Autoplay: Disabling autoplay for pause

2012-09-23 18:07:56.638 Reader[696:c07] [MPAVController] Autoplay: Disabling autoplay

2012-09-23 18:07:56.643 Reader[696:c07] [MPAVController] Autoplay: Enabling autoplay

2012-09-23 18:07:56.645 Reader[696:c07] [MPAVController] Autoplay: Likely to keep up or full buffer: 0

2012-09-23 18:07:56.646 Reader[696:c07] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.

2012-09-23 18:07:56.648 Reader[696:c07] [MPAVController] Autoplay: Likely to keep up or full buffer: 0

2012-09-23 18:07:56.648 Reader[696:c07] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.

2012-09-23 18:07:56.650 Reader[696:c07] [MPAVController] Autoplay: Enabling autoplay

2012-09-23 18:07:56.652 Reader[696:c07] [MPCloudAssetDownloadController] Prioritization requested for media item ID: 0

2012-09-23 18:07:58.746 Reader[696:c07] [MPAVController] Autoplay: Likely to keep up or full buffer: 0

2012-09-23 18:07:58.746 Reader[696:c07] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.

2012-09-23 18:07:58.747 Reader[696:c07] [MPAVController] Autoplay: _streamLikelyToKeepUp: 0 -> 1

2012-09-23 18:07:58.748 Reader[696:c07] [MPAVController] Autoplay: Likely to keep up or full buffer: 1

2012-09-23 18:07:58.748 Reader[696:c07] [MPAVController] Autoplay: Enabling autoplay` 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-25T23:32:41.443

**解决了它：**

我把我的 MPMoviePlayerController 变成了一个属性：

//添加标题

```
@property (strong,nonatomic) MPMoviePlayerController *myPlayer; 
```

//添加到.m文件

```
- (IBAction)playStream:(id)sender {
    NSString *urlAddress = @"http://67.159.28.74:8730";
    NSURL *url = [NSURL URLWithString:urlAddress];

    MPMoviePlayerController *player = [[MPMoviePlayerController alloc]initWithContentURL:url];
    [player prepareToPlay];
    //Remember you have to add MediaPlayer.framework to your project
    /*[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlayBackDidFinish:)
                                             name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:player];*/

    player.movieSourceType = MPMovieSourceTypeStreaming;

    player.view.hidden = YES;

    self.myPlayer = player;

    [self.view addSubview:self.myPlayer.view];

    if(player){
      [self.myPlayer play];
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-09-26T15:00:54.590

你必须像这样设置一个类变量：

```
@property (nonatomic, retain) MPMoviePlayerController *moviePlayer; 
```

我的代码如下所示：

```
NSURL *theUrl = [[NSBundle mainBundle] URLForResource:@"test" withExtension:@"mp4"];
moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:theUrl];
[moviePlayer prepareToPlay];
[moviePlayer.view setFrame: self.view.bounds];
moviePlayer.movieSourceType = MPMovieSourceTypeFile;
[self.view addSubview: moviePlayer.view];
[moviePlayer play]; 
```

这对我来说很完美！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-24T18:13:19.420

在 xCode 4.6.1 上它运行良好。

但是我在使用 xCode 5 时遇到了这个问题！

但是这个解决方案非常有帮助：

“解决方案是播放器必须是视图控制器的实例变量或属性。即我们必须使用 MPMoviePlayerController 的实例

@property (nonatomic,strong) MPMoviePlayerController *myMovieController;"

非常感谢作者！

这是我的代码：

```
UIGraphicsBeginImageContext(CGSizeMake(1,1));

NSString *path = [[NSBundle mainBundle] pathForResource:@"video" ofType:@"mp4"];
NSURL *videoURL = [NSURL fileURLWithPath:path];
self.moviePlayerView = [[MPMoviePlayerController alloc] initWithContentURL:videoURL];
[self.moviePlayerView prepareToPlay];
[self.moviePlayerView.view setFrame:CGRectMake(0, 0, 320, self.view.frame.size.height/2)];
self.moviePlayerView.view.backgroundColor = [UIColor clearColor];
[self.moviePlayerView setContentURL:videoURL];

self.moviePlayerView.movieSourceType = MPMovieSourceTypeFile;
self.moviePlayerView.controlStyle = MPMovieControlStyleDefault;
[self.view addSubview:self.moviePlayerView.view];
self.moviePlayerView.shouldAutoplay = NO;
[self.moviePlayerView play];

UIGraphicsEndImageContext(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-24T06:44:52.553

您可以在实例化播放器后尝试执行此操作： `[player prepareToPlay]`

更多信息：[iOS 6 流媒体播放器 com.apple.coremedia.networkbuffering 错误](https://stackoverflow.com/questions/12414717/ios-6-streaming-player-com-apple-coremedia-networkbuffering-bug/12551702#12551702)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-28T07:42:20.093

试试这个，它在 ios6 中对我来说很好用

```
NSString *resourcePath = [[NSBundle mainBundle] pathForResource:@"ddd" ofType:@"mp4"];
NSLog(@"%@",resourcePath);
NSURL *url = [NSURL fileURLWithPath:resourcePath];
NSLog(@"%@",url);
MPMoviePlayerViewController *moviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:url];
moviePlayer.view.frame = self.view.frame;
moviePlayer.moviePlayer.shouldAutoplay=YES;
moviePlayer.moviePlayer.controlStyle = MPMovieControlStyleNone;
[moviePlayer.moviePlayer setFullscreen:YES animated:YES];
[self.view addSubview:moviePlayer.view];
[moviePlayer.moviePlayer play]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-10T06:58:38.093

这是您缺少的有趣的代码行。

根据苹果的文件

" 当您将电影播放器​​的视图添加到应用程序的视图层次结构中时，请确保正确调整框架大小，如下所示：http: [//tinyurl.com/9wgv9wc](http://tinyurl.com/9wgv9wc)

```
MPMoviePlayerController *player =

    [[MPMoviePlayerController alloc] initWithContentURL: myURL];

[player prepareToPlay];

[player.view setFrame: myView.bounds];  // player's frame must match parent's

[myView addSubview: player.view];

// ...

[player play]; 
```

[http://tinyurl.com/aeh9f84](http://tinyurl.com/aeh9f84)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-22T07:19:17.873

解决方案是播放器必须是视图控制器的实例变量或属性。即我们必须使用 MPMoviePlayerController 的实例

@property (nonatomic,strong) MPMoviePlayerController *myMovieController;

# c# - 如何获取当前行号？

> ID：12556767
> 
> 赞同：148
> 
> 时间：2012-09-23T22:23:03.803
> 
> 标签：c#, wpf, c#-4.0, line-numbers

这是我想做的一个例子：

```
MessageBox.Show("Error line number " + CurrentLineNumber); 
```

在上面的代码中`CurrentLineNumber`，应该是这段代码的源代码中的行号。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2013-01-02T13:17:18.017

在 .NET 4.5 / C# 5 中，您可以让编译器为您完成这项工作，方法是编写一个使用新调用者属性的实用程序方法：

```
using System.Runtime.CompilerServices;

static void SomeMethodSomewhere()
{
    ShowMessage("Boo");
}
...
static void ShowMessage(string message,
    [CallerLineNumber] int lineNumber = 0,
    [CallerMemberName] string caller = null)
{
     MessageBox.Show(message + " at line " + lineNumber + " (" + caller + ")");
} 
```

这将显示，例如：

> 第 39 行的嘘声（SomeMethodSomewhere）

还有`[CallerFilePath]`一个告诉你原始代码文件的路径。

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2012-09-23T22:26:40.823

使用[StackFrame.GetFileLineNumber](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe.getfilelinenumber%28v=vs.110%29.aspx)方法，例如：

```
private static void ReportError(string message)
{
     StackFrame callStack = new StackFrame(1, true);
     MessageBox.Show("Error: " + message + ", File: " + callStack.GetFileName() 
          + ", Line: " + callStack.GetFileLineNumber());
} 
```

有关更多信息，请参阅[Scott Hanselman 的博客条目](http://www.hanselman.com/blog/GettingTheLineNumberAndFileNameFromC.aspx)。

[编辑：添加以下内容]

对于使用 .Net 4.5 或更高版本的用户，请考虑 System.Runtime.CompilerServices 命名空间中的[CallerFilePath](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callerfilepathattribute.aspx)、[CallerMethodName](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callermembernameattribute.aspx)和[CallerLineNumber](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callerlinenumberattribute.aspx)属性。例如：

```
public void TraceMessage(string message,
        [CallerMemberName] string callingMethod = "",
        [CallerFilePath] string callingFilePath = "",
        [CallerLineNumber] int callingFileLineNumber = 0)
{
    // Write out message
} 
```

参数必须是`string`for`CallerMemberName`和`CallerFilePath`一个`int`for`CallerLineNumber`并且必须有一个默认值。在方法参数上指定这些属性会指示编译器在编译时在调用代码中插入适当的值，这意味着它通过混淆工作。有关详细信息，请参阅[来电者](http://msdn.microsoft.com/en-us/library/hh534540.aspx)信息。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-05-29T15:20:31.343

我更喜欢一个衬垫，所以：

```
int lineNumber = (new System.Diagnostics.StackFrame(0, true)).GetFileLineNumber(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-25T17:47:51.517

对于那些需要 .NET 4.0+ 方法解决方案的人：

```
using System;
using System.IO;
using System.Diagnostics;

public static void Log(string message) {
   StackFrame stackFrame = new System.Diagnostics.StackTrace(1).GetFrame(1);
   string fileName = stackFrame.GetFileName();
   string methodName = stackFrame.GetMethod().ToString();
   int lineNumber = stackFrame.GetFileLineNumber();

   Console.WriteLine("{0}({1}:{2})\n{3}", methodName, Path.GetFileName(fileName), lineNumber, message);
} 
```

如何调用：

```
void Test() {
   Log("Look here!");
} 
```

输出：

> 无效测试（）（文件名.cs：104）
> 
> 看这里！

随意更改 Console.WriteLine 格式！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-05-23T15:17:04.573

在 .NET 4.5 中，您可以通过创建函数来获取行号：

```
static int LineNumber([System.Runtime.CompilerServices.CallerLineNumber] int lineNumber = 0)
{
    return lineNumber; 
} 
```

然后每次你打电话`LineNumber()`你都会有当前的线路。与使用 StackTrace 的任何解决方案相比，它的优势在于它应该在调试和发布中都可以工作。

因此，采用原始请求所需的内容，它将变为：

```
MessageBox.Show("Error enter code here line number " + LineNumber()); 
```

这是建立在 Marc Gravell 的出色回答的基础上的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-23T22:28:39.827

如果它在 try catch 块中，请使用它。

```
try
{
    //Do something
}
catch (Exception ex)
{
    System.Diagnostics.StackTrace trace = new System.Diagnostics.StackTrace(ex, true);
    Console.WriteLine("Line: " + trace.GetFrame(0).GetFileLineNumber());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-11T16:00:09.263

您只询问了行号和可为空的项目类型，然后您需要使用类似这样的东西

```
internal class Utils
{
   public static int Line([CallerLineNumber] int? lineNumber =null)=>lineNumber;
} 
```

在您的代码中，如果您想获取行号，则只需致电

```
var line=Utils.Line(); 
```

如果您正在记录并且您想在记录中记录行号而不是调用这样的方法

```
public void MyMethod(int someValue)
{
    switch(someValue)
    { 
        case 1:
            if(abc<xyz)
            {
             logger.LogInformation("case value {someValue} this line {line} was true", someValue ,Utils.Line()-2);
            }
            break;

        case 2:
           logger.LogInformation("case value {someValue} this {line} was executed",someValue,Utils.Line());
           break;
        caste 3:
           logger.LogInformation("case value {someValue} this {line} was executed",someValue,Utils.Line());
           break;
    }
} 
```

您可以使用任何其他 [CallerXXX] 方法扩展此模式，而不是在任何地方使用它们，而不仅仅是在方法参数中。

在 Nuget Package [Walter](https://www.nuget.org/packages/Walter/)中，我使用了一个名为 ExceptionObject 的超酷类

如果您导入 NuGet 包，您将在 Exception 类上有一些不错的扩展方法，并且可以访问显示调用链的 CallStack，包括方法参数和所有调用方法的参数值。

这就像一堆异常，只有值显示了你是如何得到什么值的。

```
public void MyMethod()
{
    try
    {

      //get me all methods, signatures, parameters line numbers file names etc used as well as assembly info of all assemblies used for documentation of how the code got here
      var stack= new CallStack();
      foreach( var frame in StackedFrames)
      {
         logger.LogDebug(frame.ToString());
      }
    }
    catch(SqlException e)
    {
       var ex = new ExceptionObject(e);
       logger.LogException(e,"{this} exception due to {message} {server} {procedure} TSQL-line:{sqlline}\n{TSQL}"
                            ,e.GetType().Name
                            ,e.Message
                            ,ex.SqlServer
                            ,ex.SqlProcedureName
                            ,ex.SqlLineNumber
                            ,ex.Tsql
                            ,ex.CallStack); 
    }
    catch(Exception e)
    {
       var ex = new ExceptionObject(e);
       logger.LogException(e,"{this} exception due to {message} signature: signature}\nCallStack:", e.GetType().Name,e.Message,ex.Signature,ex.CallStack); 
    }
} 
```

# python - 通过接受集合和返回集合将几个函数重构为一个

> ID：12556773
> 
> 赞同：0
> 
> 时间：2012-09-23T22:24:18.847
> 
> 标签：python, refactoring, python-2.7, set

我有几个函数可以根据输入字典计算不同的统计数据，例如最大值、最小值、总和、平均值、中位数。

我想将所有这些功能组合成一个，而不是让它们以不同的方法使用。所以调用者可以执行以下操作：

```
(minValue, averageValue, maxValue) = myFunction(min, avg, max, data, key, ...) 
```

或者

```
(minValue, maxValue) = myFunction(min, max) 
```

我是 python 新手，我想了解如何使用集合来实现这一点！请不要提出其他解决此问题的方法，因为我也在尝试学习 python 和 python 语法。一个小例子会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:27:52.200

```
def myFunction(data,*args):
    return tuple( f(data) for f in args) ) 
```

例如：

```
myFunction(data, min, avg, max)
# returns (min(data), avg(data), max(data)), and you can get them by
minValue, averageValue, maxValue = myFunction(data, min, avg, max) 
```

如果你想包括`key`：

```
def myFunction2(data, *args, **kwargs):
    if 'key' not in kwargs:
        kwargs['key'] = lambda x: x # identity map (pass without a key)
    return tuple( f(data, key=kwargs['key']) for f in args ) 
```

例如：

```
myFunction2(['a','bc','f'], min, max)          # ('a', 'f')
myFunction2(['a','bc','f'], min, max, key=len) # ('a', 'bc') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:28:14.747

您不能使用集合来执行此操作，因为集合没有顺序；因此 Python 不知道哪个值是 the`minValue`和哪个`maxValue`，例如。

你*可以*返回一个元组：

```
return value1, value2, value3 
```

演示：

```
>>> def foo():
...     return 1, 2, 3
...
>>> retval1, retval2, retval3 = foo()
>>> retval3
3 
```

# ios - iOS 6 有没有办法确定为自己创建的图像？

> ID：12556775
> 
> 赞同：-2
> 
> 时间：2012-09-23T22:24:31.727
> 
> 标签：ios, uiimage, retina-display, iphone-5

通常，对于标准和 Retina 显示器，我们会创建两张图像`Image.png`，`Image@2x.png`iOS 会根据应用程序中的设备确定要使用哪一张。

**现在，有了 iPhone5，我们有了新的分辨率，那么有没有什么新方法可以使用相同的方法并专门为iPhone5**显示更高分辨率的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:28:55.347

只需选择您要使用的 iPhone 5 友好图像名称即可。例如，我使用这样的图像：**myiPhone5Image-568h.png**

# grails - 如何自定义默认 Grails 视图 - 即 create.gsp

> ID：12556777
> 
> 赞同：1
> 
> 时间：2012-09-23T22:25:12.047
> 
> 标签：grails, view, default, gsp

我创建了一个简单的 CRUD 应用程序，但是我的一个域类有 80 多个属性。默认输入表单是一团糟，因此我想将它组织成字段组，并将不同的字段组放置在不同的 jQuery 选项卡上。

谁能告诉我处理它的最佳方法是什么？最佳意味着对默认值的最小更改。

# google-places-api - Google 地方信息中的多个名称

> ID：12556784
> 
> 赞同：1
> 
> 时间：2012-09-23T22:26:02.280
> 
> 标签：google-places-api

基本上，我的问题与此处相同：[Google Places API：搜索包含空格的名称](https://stackoverflow.com/questions/10903363/google-places-api-searching-for-names-containing-spaces)

如果您使用 %20，它适用于包含它的一个名称，但忽略其余名称。

我需要找到附近的餐厅，但只有我有其他信息的餐厅，所以我有 10 家餐厅的列表，我想显示 10 家中最近的餐厅，看起来好像 google 地方可能不支持这个（餐厅名称中的空格），我应该看看另一个 API 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T15:34:00.023

您是否将这些餐厅存储在自己的数据库中？

如果是，则需要进行邻近搜索。MySql & Postgres 的 GIS 插件支持这个给定的纬度/经度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T15:08:53.373

Places API 不正式支持使用多个关键字或名称执行地点搜索请求，因此不能保证返回准确的结果。

[Google Places API：搜索包含空格的名称](https://stackoverflow.com/questions/10903363/google-places-api-searching-for-names-containing-spaces)

# javascript - 如何将数据添加到 jquery 创建的元素？

> ID：12556786
> 
> 赞同：0
> 
> 时间：2012-09-23T22:26:07.807
> 
> 标签：javascript, jquery, object

向新元素添加数据：

```
var ComBox = $('<div></div>').addClass('commentBox');
$.data(ComBox, 'ChannelID', 5);
$('body').append(ComBox); 
```

尝试获取数据时，结果未定义..

```
var cID = $('.commentBox').data('ChannelID');
console.log('cID : '+cID ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T22:27:52.493

替换这个：

```
$.data(ComBox, 'ChannelID', 5); 
```

有了这个：

```
ComBox.data('ChannelID', 5); 
```

它使用[这个功能](http://api.jquery.com/data/#data1)

最佳实践说明，您最好在 jQuery 对象前加上 $ 含义：
`ComBox`=>`$comBox`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:30:17.643

[`$.data`](http://api.jquery.com/jQuery.data/)需要一个*DOM*元素，而不是*jQuery*对象。要么使用：

```
$.data(ComBox[0], 'ChannelID', 5); 
```

或者@gdoron 建议的更方便的[.data()](http://api.jquery.com/data/)函数：

```
ComBox.data('ChannelID', 5); 
```

**[演示](http://jsfiddle.net/u5pdx/)**。

# android - 拨号时保持我的活动

> ID：12556790
> 
> 赞同：1
> 
> 时间：2012-09-23T22:26:41.820
> 
> 标签：android

我正在使用带有 ACTION_CALL 的意图在我的应用程序中拨打电话：

```
str="tel:0123456789";
Intent intent = new Intent(Intent.ACTION_CALL);
intent.setData(Uri.parse(str));
startActivity(intent); 
```

但它会弹出系统拨号屏幕。我知道这是内置在 ROM 中的，不能自定义。但是我可以隐藏这个屏幕并让用户留在我的活动中吗？

在这里做了一些谷歌搜索和研究。但目前还没有明确的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:44:25.347

看起来您无法自定义拨号屏幕，但您可以使用 PhoneStateListener 来获取有关电话呼叫的某些信息。请参阅[此链接](http://androidapps.org.ua/i_sect18_d1e18123.html)。

# c# - “system.invalidoperationexception 未处理” on

> ID：12556792
> 
> 赞同：1
> 
> 时间：2012-09-23T22:26:54.790
> 
> 标签：c#

我收到“未处理 InvalidOperationException”。con.Open(); 然后突出显示。

如果我在 .cs 文件中使用连接字符串，我的应用程序工作正常，但如果我将其放在 web.config 中，则会出现异常。尝试了谷歌上所有可用的东西，但没有运气。

**代码**

```
using System.Configuration;
using System.Web.Configuration;

public DataSet GetInvoice()
{
      SqlConnection con = new SqlConnection();
     con.ConnectionString =            WebConfigurationManager.ConnectionStrings["MyConnection"].ConnectionString; 

            DataSet ds = new DataSet();
            SqlDataAdapter da = new SqlDataAdapter("select * from invoice", con);
            **con.Open();**
            da.Fill(ds);
            con.Close();
            return ds;
        } 
```

**网页配置**

```
<connectionStrings>       
    <add name ="MyConnection" connectionString = "Data Source =.\\SQLEXPRESS; AttachDbFilename = C:\\USERS\\SALIL\\DOCUMENTS\\INVOICING.MDF ; Integrated Security = True" providerName="System.Data.SqlClient" />
  </connectionStrings> 
```

**堆栈跟踪：**

```
 at System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, SqlConnection owningObject)
   at System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject)
   at System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart)
   at System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at WebInvoicing.Invoice.GetInvoice() in C:\WebInvoicing\WebInvoicing\Invoice.cs:line 220
   at WebInvoicing.InvoiceApp.LoadGrid() in C:\WebInvoicing\WebInvoicing\InvoiceApp.aspx.cs:line 124
   at WebInvoicing.InvoiceApp.Page_Load(Object sender, EventArgs e) in C:\WebInvoicing\WebInvoicing\InvoiceApp.aspx.cs:line 13
   at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)
   at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:30:24.803

无需转义 web.config 文件中连接字符串中的斜杠。它应该是：

```
 <connectionStrings>       
    <add name ="MyConnection" 
       connectionString = "Data Source =.\SQLEXPRESS; AttachDbFilename = C:\USERS\SALIL\DOCUMENTS\INVOICING.MDF ; Integrated Security = True" 
       providerName="System.Data.SqlClient" />
  </connectionStrings> 
```

有关详细信息，请参阅[处理连接字符串中的反斜杠](https://stackoverflow.com/questions/5998058/handle-backslash-in-the-connection-string)。

# c++ - 使用 Char* 查找内存泄漏的原因

> ID：12556793
> 
> 赞同：0
> 
> 时间：2012-09-23T22:26:58.080
> 
> 标签：c++, pointers, memory-leaks

我一直在处理一些 char* 指针的项目中工作，并且使用 char* 而不是 std::string 是该类的必要条件，所以...

我有这个结构定义和这个队列：

```
typedef struct packetQueue
{
    char* buf;
    int length;

    packetQueue()
    {
        buf = new char[];
        length = 0;
    }

    } PACKET; 
```

并发::concurrent_queue IP_in_queue;

我有这个缓冲区：

```
char sendBuf[MSG_SIZE + sizeof (IP_PACKET_HEADER_T) + 1]; // String to be send 
```

和我的新缓冲区的结构：

```
PACKET ipQueue; 
```

然后我用这个填充我的缓冲区：

```
// Concatenates the header with sended message
memcpy(sendBuf, (void*)&sendHeader, sizeof(sendHeader));

memcpy(&sendBuf[sizeof(sendHeader)], readMessage, sendHeader.length);

ipQueue.buf = sendBuf;
ipQueue.length = packetSize; 
```

然后我将数据包推送到我的队列 IP_in_queue.push(ipQueue); // 将缓冲区推入 IP_in_queue

这是我的循环以防万一：

```
while ( 1 )
{
    // Get the user input
    cout << "> ";
    cin.getline (buf, BUFLEN);

    IP_PACKET_HEADER_T sendHeader; // Store the header to be send
    PACKET ipQueue;

    char* fakeIPAddressDst, *readMessage; 

    delay = atoi(strtok (buf," ")); // Takes the first delay value
    fakeIPAddressDst = strtok (NULL, " "); // Stores the IP Address
    readMessage = strtok (NULL, " "); // Stores the sended message

    Sleep(delay); // Sleep the miliseconds defined

    // Fills the header with the data neccesary data
    sendHeader.DIP = inet_addr(fakeIPAddressDst);
    sendHeader.SIP = inet_addr(initAddress.fakeIpAddress);
    sendHeader.length = getStringLength(readMessage) + 1;
    packetSize = sizeof( sendHeader ) + sendHeader.length; // Defines the size of the packet to be send

    // Concatenates the header with sended message
    memcpy(sendBuf, (void*)&sendHeader, sizeof(sendHeader));
    memcpy(&sendBuf[sizeof(sendHeader)], readMessage, sendHeader.length);

    ipQueue.buf = sendBuf;
    ipQueue.length = packetSize;

    numbytes = packetSize; // The number of bytes of sended buffer

    char sendedString[BUFLEN + 1]; // Variable for stores the data
    IP_PACKET_HEADER_T readHeader; // To store the header for showing the information

    // Print out the content of the packet
    // Copy from buf to the header
    memcpy( (void*)&readHeader, ipQueue.buf, sizeof( IP_PACKET_HEADER_T));
    // Copy message part
    memcpy( sendedString, &ipQueue.buf[sizeof(IP_PACKET_HEADER_T)], numbytes - sizeof(IP_PACKET_HEADER_T));
    // Append \0 to the end
    sendedString[numbytes - sizeof(IP_PACKET_HEADER_T)] = '\0';

    // Save the IP information of the packet in a struct for print on the screen
    struct in_addr fakeAddrHost;
    fakeAddrHost.s_addr = readHeader.SIP;

    // Print the neccesary data
    cout << "[IN] DST: " << fakeIPAddressDst << endl; // Fake IP address of the destination
    cout << "[IN] SRC: " << inet_ntoa(fakeAddrHost) << endl; // Fake IP address of the host
    cout << "[IN] MSG: " << sendedString << endl ; // Message to send

    IP_in_queue.push(ipQueue); // Push the buffer in the IP_in_queue
} 
```

我知道此过程中存在内存泄漏，但我不确定。当我推送我的数据包时，buf 指针一直指向我的 sendBuf，对吗？因为分配是这样做的，但是如果我在推送程序崩溃后删除了 ipQueue 中的指针。我不得不说，在我将该结构推入队列后，另一个线程尝试弹出该结构，显然如果我删除我的 ipQueue 指针，我将丢失我的缓冲区，那么我怎样才能避免这种内存泄漏呢？

谢谢

编辑：

使用 buf = nullptr 定义的内存泄漏

```
---------- Block 1 at 0x0068BB30: 264 bytes ----------
  Call Stack:
    d:\program files (x86)\microsoft visual studio 11.0\vc\include\concurrent_queue.h (402): Host.exe!Concurrency::concurrent_queue<packetQueue,std::allocator<packetQueue> >::_Allocate_page + 0xF bytes
    f:\dd\vctools\crt_bld\self_x86\crt\src\concurrent_queue.cpp (113): MSVCP110D.dll!Concurrency::details::_Micro_queue::_Push + 0xD bytes
    f:\dd\vctools\crt_bld\self_x86\crt\src\concurrent_queue.cpp (232): MSVCP110D.dll!Concurrency::details::_Concurrent_queue_base_v4::_Internal_push
    d:\program files (x86)\microsoft visual studio 11.0\vc\include\concurrent_queue.h (566): Host.exe!Concurrency::concurrent_queue<packetQueue,std::allocator<packetQueue> >::push + 0xF bytes
    d:\users\silex rpr\documents\visual studio 2012\projects\project2\project2\host.cpp (802): Host.exe!main
    f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (536): Host.exe!__tmainCRTStartup + 0x19 bytes
    f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (377): Host.exe!mainCRTStartup
    0x7662339A (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
    0x77179EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
    0x77179EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:30:51.493

首先；这不是 C，您使用的是 C++ 编译器。C 中的结构不能有方法和构造函数，`new`也不`delete`存在。

其次，您`buf`在构造函数中分配内存，但是...

```
ipQueue.buf = sendBuf; 
```

那是泄漏。您需要`delete`为每次调用`new`. 您使用 分配`buf`，`new`但从不调用`delete`它，因此内存泄漏。

我认为没有理由在这里分配`buf`。只需将其设置为空。

```
typedef struct packetQueue
{
    char* buf;
    int length;

    packetQueue()
        : buf(nullptr), length(0) { }
} PACKET; 
```

* * *

顺便说一句，这是 C 和 C++ 的非常糟糕的组合。这是你们老师教你们的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:31:23.903

你有一个类（结构），它有一个分配内存的构造函数，没有释放它的析构函数，所以你得到内存泄漏。

您还公开`buf`成员并分配给它；所以你的班级无法控制是否应该释放内存。但是您需要在`buf`第一次分配之前释放构造函数中分配的内存。

为了做到这一点，您需要将`buf`字段设为私有并添加一个析构函数、一个复制构造函数和一个赋值运算符（可能还有一个访问函数）。不过，您仍然不会异常安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T22:38:50.293

您遇到的问题是您没有查看复制构造和复制分配：当您将对象推入 a`std::vector<T>`时，它会被复制，而带有`std::vector<T>`get 的对象可能会使用分配移动。默认生成的复制构造函数和复制赋值只是复制或分配各自的成员，即，无论何时使用任何一个副本，您最终都会得到两个指向同一个`buf`. 第一个被销毁的将使用`delete[] buf;`，所有其他人将有一个不能再次删除的陈旧指针。也就是说，您想将三个方法添加到您的`packetQueue`:

```
struct packetQueue
{
    packetQueue(packetQueue const& other);             // copy constructor: copies the content
    packetQueue& operator= (packetQueue const& other); //copy assignment: updates the content
    ~packetQueue()                                     // destructor: release the memory
    void swap(packetQueue& other);                     // swap the content
    // other members
}; 
```

为了在复制分配中利用复制构造和销毁，我发现拥有一个成员很有用`swap()`，因为这很容易实现并且可以实现一个不错的、简单的复制分配：

```
void packetQueue::swap(packetQueue& other) {
    std::swap(this->buf, other.buf);
    std::Swap(this->size, other.size);
}
packetQueue& packetQueue::operator= (packetQueue const& other) {
    packetQueue(other).swap(*this);
    return *this;
} 
```

# java - Groovy & Processing——如何获取小程序的引用？

> ID：12556794
> 
> 赞同：0
> 
> 时间：2012-09-23T22:27:18.440
> 
> 标签：java, groovy, processing

我用 Java 编写了一个程序，它使用了 Processing 中的 PApplet 类。此类在后台实例化一个 PApplet 对象。我需要在其他一些类中引用这个对象，所以我使用了这个小技巧：

```
public class MyApplet extends PApplet {
  public static MyApplet myApplet;
  // plus other various fields...

  // initializing block
  {
    myApplet = this;
  }

  // stuff...
}

// Now in some other class
import static MyApplet.myApplet;
class OtherClass {
  // here I can use the reference to myapplet
  myApplet.whatever();
} 
```

一切都很好，很酷。但后来我想将所有这些代码翻译成 Groovy。问题是 Groovy 的闭包很早就在声明时对变量进行了“快照”——因此他们认为该`myapplet`字段没有被初始化。Groovy 很早就完成了它的工作，甚至早于初始化块。至少这是我对为什么`myapplet`在 Groovy 类中被视为 null 的解释。

我该如何规避这个？如何获取对在`PApplet`幕后构建的小程序对象的引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T11:39:28.320

我找到了一种方法：我用普通的 Java 创建了一个 Glue 类，它设置了对 myApplet 的静态引用。然后我在 Groovy 中扩展了这个 Glue：

```
// Java
class Glue extends PApplet {
  static Glue myApplet;
  // initialization block
  {
  myApplet = this;
  }
}

// Then Groovy
class MyApplet extends Glue {
  // ...
}

// And Groovy again
import static Glue.myApplet
class OtherClass {
  myApplet.whatever()
} 
```

它就像一个魅力！

我需要这样做，因为有数千个 OtherClass 实例，并且向它们发送数千个对同一个小程序对象（这是唯一的）的引用副本是不切实际的。

此解决方案在 Groovy 执行其操作之前设置对静态字段的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T05:49:06.607

`PApplet`为什么不直接将您的实例的引用传递给您的`OtherClass`实例？

```
public class MyApplet extends PApplet {
    void setup () {
        OtherClass otherClassInstance = new OtherClass(this);
    }
}

class OtherClass {
    public OtherClass (PApplet p) {
        //p.whatever();
    }
} 
```

如果您需要在 ' 的构造函数之后访问 PApplet 的字段/方法`OtherClass`，请将该引用存储在本地成员中：

```
class OtherClass {
    private PApplet p;
    public OtherClass (PApplet p) {
        this.p = p;
    }

    private void someMethod () {
        //p.whatever();
    }
} 
```

这是在 Java 中使用 Processing 的常用方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T00:05:51.573

[`@Lazy`注释](http://groovy.codehaus.org/Lazy+transformation)是否绕过它？IE：

```
public class MyApplet extends PApplet {
  @Lazy static MyApplet instance = { -> MyApplet._instance }()
  private static _instance 
  public MyApplet() {
    MyApplet._instance = this
  }
} 
```

然后打电话`MyApplet.instance`

我会说这种静态实例方法相当脆弱，您可能需要考虑将 Applet 实例显式传递给您的其他类，或者使用其他方法而不是采用静态全局实例路由。

# jailbreak - 编译 iPhone 调整时出错

> ID：12556803
> 
> 赞同：4
> 
> 时间：2012-09-23T22:28:21.493
> 
> 标签：jailbreak, dylib, tweak

我正在尝试编译我刚刚创建的 iPhone 调整，但我遇到了一些错误，我似乎无法找到解决方案，我们将不胜感激。

```
Undefined symbols for architecture armv6:
"_OBJC_CLASS_$_UIAlertView", referenced from:
objc-class-ref in Tweak.xm.o
ld: symbol(s) not found for architecture armv6
collect2: ld returned 1 exit status
make[2]: *** [obj/tweakTest.dylib] Error 1
make[1]: *** [internal-library-all_] Error 2
make: *** [tweakTest.all.tweak.variables] Error 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T00:11:01.043

您需要在项目中包含 UIKit 框架并添加`#import <UIKit/UIKit.h>`到 .xm 文件中。

# php - 如何从帖子中抓取数据到班级

> ID：12556805
> 
> 赞同：6
> 
> 时间：2012-09-23T22:28:35.797
> 
> 标签：php, post, get

如果我有这样的表格（不是所有的代码只有一个字段和我的输入）：

```
<div id="login_form">
<form id="registration" method="post" action="results.php">
<label for="first_name"> First Name: </label>
<input type="text" id="first_name" name="first_name" maxlength="100" tabindex="1" />

<input type="submit" id="login_submit" name="submit" value="Submit"/ align="right">

</form>
</div> 
```

是否可以从表单中获取数据，然后将该数据输出到另一个页面。我现在拥有它的方式只是将帖子从表单复制到页面：

```
<?php

$first_name = $_POST['first_name'];
$last_name = $_POST['last_name'];
$email_address = $_POST['email_address'];

echo 'Hello ';
echo "{$first_name} {$last_name}";
echo '<br/>';
echo '<br/>';
echo 'We have your email address as: "';

echo "{$email_address}"; 
echo '"';

 ?> 
```

我不知道如何开始，但我希望帖子中的数据先去上课。因此，如果我创建一个名为 registeredUser 的类，我将如何从表单中获取该数据？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T22:39:57.677

您好，我想您首先需要一些有关 OPP 的教程

YouTube

*   [http://www.youtube.com/watch?gl=NG&feature=related&hl=en-GB&v=_JEEQ-OPVAY](http://www.youtube.com/watch?gl=NG&feature=related&hl=en-GB&v=_JEEQ-OPVAY)

介绍

*   [http://www.slideshare.net/mgirouard/a-gentle-introduction-to-object-oriented-php](http://www.slideshare.net/mgirouard/a-gentle-introduction-to-object-oriented-php)

其他链接

*   [http://buildinternet.com/2009/07/an-introduction-to-object-oriented-php-part-1/](http://buildinternet.com/2009/07/an-introduction-to-object-oriented-php-part-1/)

*   [http://blog.teamtreehouse.com/getting-started-with-oop-php5](http://blog.teamtreehouse.com/getting-started-with-oop-php5)

你想要的例子

```
class RegisterUser {
    private $firstName;
    private $lastName;
    private $emailAddress;

    function __construct() {
        $this->firstName = isset($_POST['first_name']) ? $_POST['first_name'] : null;
        $this->lastName = isset($_POST['last_name']) ? $_POST['last_name'] : null;
        $this->emailAddress = isset($_POST['email_address']) ? $_POST['email_address'] : null;
    }

    function start() {
        if (empty($this->firstName) || empty($this->lastName) || empty($this->emailAddress)) {
            throw new Exception("Empty Post not allowed");
        }

        else
        {
            // Do some stuiff
            echo " Registration Done";
        }
    }
}

$register = new RegisterUser();
if(!empty($_POST))
{
    $register->start();
} 
```

# php - PHP/jQuery/Javascript - 在变量中只允许数字和一些字符

> ID：12556807
> 
> 赞同：0
> 
> 时间：2012-09-23T22:28:45.900
> 
> 标签：php, javascript, jquery, regex

我需要验证用户是否在输入字段中输入了所需的字符，如果没有，我需要像这样格式化输入：

**开始变量：** `+42 88 66 44 3, +42 (4) 87/654321; +42 3 123456`

**所需变量：** `+428866443, +42487654321, +423123456`

所以基本上我需要从变量中清除所有不是数字的字符，并且只允许像`+` `,` `;` `-`.

因为我使用的是 AJAX 请求，所以我会欣赏 PHP 和 Javascript 的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:35:03.270

要从字符串中删除无效字符，请使用 PHP 和 JAVASCRIPT 中的正则表达式。

**PHP**

```
$s = '+42 88 66 44 3, +42 (4) 87/654321; +42 3 123456';
$n = preg_replace('~[^\d\+,;-]~', '', $s);
print_r($n); 
```

**JAVASCRIPT**

```
var s = '+42 88 66 44 3, +42 (4) 87/654321; +42 3 123456';
var n = s.replace(/[^\d\+,;-]/g, "");
console.log(n); 
```

但更好的做法是，如果用户输入错误的格式，则显示错误。您将需要一些验证来完成...

# c# - 测试对象从字典实现接口

> ID：12556810
> 
> 赞同：1
> 
> 时间：2012-09-23T22:29:13.193
> 
> 标签：c#, system.reflection

我有一本注册类型的字典。

```
Dictionary<Type, Type> knownTypes = new Dictionary<Type, Type>() {
   { typeof(IAccountsPlugin), typeof(DbTypeA) },
   { typeof(IShortcodePlugin), typeof(DbTypeB) }
}; 
```

我需要测试一个对象是否将特定接口实现为键，如果是，则实例化对应的值。

```
public Plugin FindDbPlugin(object pluginOnDisk)
{
    Type found;
    Type current = type.GetType();

    // the below doesn't work - need a routine that matches against a graph of implemented interfaces
    knownTypes.TryGetValue(current, out found); /
    if (found != null)
    {
        return (Plugin)Activator.CreateInstance(found);
    }
} 
```

将创建的所有类型（在本例中为 DbTypeA、DbTypeB 等）只会从 type 派生`Plugin`。

传入的对象可能是通过几代继承从我们试图匹配的一种类型（即 IAccountsPlugin）继承而来的。这就是为什么我不能这样做`pluginOnDisk.GetType()`。

有没有办法测试一个对象是否实现了一个类型，然后创建该类型的新实例，使用字典查找而不是暴力强制和在长循环中测试 typeof？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:35:06.903

将此方法更改为通用方法，并指定您要查找的对象的类型：

```
public Plugin FindDbPlugin<TKey>(TKey pluginOnDisk)
{
    Type found;
    if (knownTypes.TryGetValue(typeof(TKey), out found) && found != null)
    {
        Plugin value = Activator.CreateInstance(found) as Plugin;
        if (value == null)
        {
            throw new InvalidOperationException("Type is not a Plugin.");
        }

        return value;
    }

    return null;
} 
```

**例子：**

```
IAccountsPlugin plugin = ...
Plugin locatedPlugin = FindDbPlugin(plugin); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:53:24.327

```
public Plugin FindDbPlugin(object pluginOnDisk) {        
    Type found = pluginOnDisk.GetType().GetInterfaces().FirstOrDefault(t => knownTypes.ContainsKey(t));
    if (found != null) {
        return (Plugin) Activator.CreateInstance(knownTypes[found]);
    }
    throw new InvalidOperationException("Type is not a Plugin.");
} 
```

# ruby-on-rails - 选择选项以在 Rails 2.3 中使用名称和值填充数据库

> ID：12556811
> 
> 赞同：0
> 
> 时间：2012-09-23T22:29:21.523
> 
> 标签：ruby-on-rails

在以下示例中，如何在数据库中同时保存名称和 id？如果我使用以下代码，将保存 id 但如果我还必须保存 p.name 怎么办？有任何想法吗？？？

```
<%= f.label :person_id, "Person ID" %><br />
<%=select :post, :person_id, Person.all.collect {|p| [ p.name, p.id ] }) %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:56:15.143

转到 post 控制器中的 index 方法并尝试添加以下行：

```
@posts.person_name = (Person.find(:first, :conditions => ['id=?', "%#{params[:person_id]}%"])).name 
```

# f# - 数据库连接和 F#

> ID：12556814
> 
> 赞同：6
> 
> 时间：2012-09-23T22:29:47.593
> 
> 标签：f#

我编写了以下代码以在 F# 中执行 SQLServer StoredProc

```
module SqlUtility =
  open System
  open System.Data
  open System.Data.SqlClient

  SqlUtility.GetSqlConnection "MyDB"
  |> Option.bind (fun con -> SqlUtility.GetSqlCommand "dbo.usp_MyStordProc" con) 
  |> Option.bind (fun cmd -> 
      let param1 = new SqlParameter("@User", SqlDbType.NVarChar, 50)
      param1.Value <- user
      cmd.Parameters.Add(param1) |> ignore
      let param2 = new SqlParameter("@PolicyName", SqlDbType.NVarChar, 10)
      param2.Value <- policyName
      cmd.Parameters.Add(param2) |> ignore
      Some(cmd)
    )
  |> Option.bind (fun cmd -> SqlUtility.ExecuteReader cmd)
  |> Option.bind (fun rdr -> ExtractValue rdr)         

  let GetSqlConnection (conName : string) =
    let conStr = ConfigHandler.GetConnectionString conName
    try 
      let con = new SqlConnection(conStr)
      con.Open()
      Some(con)
    with
     | :? System.Exception as ex -> printfn "Failed to connect to DB %s with Error %s "  conName ex.Message; None
     | _ -> printfn "Failed to connect to DB %s" conName; None

  let GetSqlCommand (spName : string) (con : SqlConnection) =    
    let cmd = new SqlCommand()
    cmd.Connection <- con
    cmd.CommandText <- spName
    cmd.CommandType <- CommandType.StoredProcedure
    Some(cmd)

  let AddParameters (cmd : SqlCommand) (paramList : SqlParameter list) =
    paramList |> List.iter (fun p -> cmd.Parameters.Add p |> ignore) 

  let ExecuteReader (cmd : SqlCommand ) = 
    try
      Some(cmd.ExecuteReader())
    with
    | :? System.Exception as ex -> printfn "Failed to execute reader with error %s" ex.Message; None 
```

这段代码有多个问题

1.  首先，重复使用 Option.bind 非常烦人......并且会增加噪音。我需要一种更清晰的方法来检查输出是否为 None，如果不是，则继续。

2.  最后应该有一个清理功能，我应该能够关闭+处置阅读器、命令和连接。但目前在管道的尽头，我所拥有的只是读者。

3.  添加参数的函数......看起来它正在修改命令参数的“状态”，因为返回类型仍然是发送它的相同命令......添加了一些状态。我想知道一个更有经验的函数式程序员会如何做到这一点。

4.  Visual Studio 在我进行异常处理的每个地方都会给我一个警告。有什么问题”它说

这种类型测试或向下转型将始终保持

我希望这段代码看起来是这样的

let x : MyRecord seq = GetConnection "con" |> GetCommand "cmd" |> AddParameter "@name" SqlDbType.NVarchar 50 |> AddParameter "@policyname" SqlDbType.NVarchar 50 |> ExecuteReader |> FunctionToReadAndGenerateSeq |> CleanEverything

您能否推荐我如何将我的代码提升到所需的水平以及任何其他改进？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T23:20:21.170

我认为使用选项来表示失败的计算更适合纯功能语言。在 F# 中，使用异常来表示计算失败是完全可以的。

您的代码只是将异常转换为`None`值，但它并没有真正处理这种情况 - 这留给代码的调用者（谁需要决定如何处理`None`）。你也可以让他们处理异常。如果您想向异常添加更多信息，您可以定义自己的异常类型并抛出它，而不是离开标准异常。

下面定义了一个新的异常类型和一个简单的函数来抛出它：

```
exception SqlUtilException of string

// This supports the 'printf' formatting style    
let raiseSql fmt = 
  Printf.kprintf (SqlUtilException >> raise) fmt 
```

使用简单的 .NET 样式并使用 F# 功能进行一些简化，代码看起来要简单得多：

```
// Using 'use' the 'Dispose' method is called automatically
let connName = ConfigHandler.GetConnectionString "MyDB"
use conn = new SqlConnection(connName)

// Handle exceptions that happen when opening  the connection
try conn.Open() 
with ex -> raiseSql "Failed to connect to DB %s with Error %s " connName ex.Message

// Using object initializer, we can nicely set the properties
use cmd = 
  new SqlCommand( Connection = conn, CommandText = "dbo.usp_MyStordProc",
                  CommandType = CommandType.StoredProcedure )

// Add parameters 
// (BTW: I do not think you need to set the type - this will be infered)
let param1 = new SqlParameter("@User", SqlDbType.NVarChar, 50, Value = user) 
let param2 = new SqlParameter("@PolicyName", SqlDbType.NVarChar, 10, Value = policyName) 
cmd.Parameters.AddRange [| param1; param2 |]

use reader = 
  try cmd.ExecuteReader()
  with ex -> raiseSql "Failed to execute reader with error %s" ex.Message

// Do more with the reader
() 
```

它看起来更像 .NET 代码，但这非常好。在 F# 中处理数据库将使用命令式样式并试图隐藏只会使代码混乱。现在，您可以使用许多其他简洁的 F# 功能 - 尤其是对动态运算符的支持`?`，这将为您提供如下内容：

```
let connName = ConfigHandler.GetConnectionString "MyDB"

// A wrapper that provides dynamic access to database
use db = new DynamicDatabase(connName)

// You can call stored procedures using method call syntax
// and pass SQL parameters as standard arguments
let rows = db.Query?usp_MyStordProc(user, policy)

// You can access columns using the '?' syntax again
[ for row in rows -> row?Column1, row?Column2 ] 
```

有关这方面的更多信息，请参阅以下 MSDN 系列：

*   [如何：动态调用存储过程](http://msdn.microsoft.com/en-us/library/hh304373%28v=vs.100%29.aspx)
*   [第 1 步：创建数据库并显示轮询选项](http://msdn.microsoft.com/en-us/library/hh304370%28v=vs.100%29.aspx)
*   [第 2 步：对选项实施投票](http://msdn.microsoft.com/en-us/library/hh304362(v=vs.100).aspx)

# c - 在 C 项目 (Eclipse) 中包含静态库

> ID：12556818
> 
> 赞同：2
> 
> 时间：2012-09-23T22:30:13.523
> 
> 标签：c, eclipse, mingw, static-libraries

我目前正在使用 SDL 开发应用程序。为了使用它，我已经在项目的设置中添加了库和头文件`C/C++ Build -> Settings -> Tool Settings -> Libraries/Includes`。但是，当我尝试构建一个测试程序时

```
#include <stdio.h>
#include <SDL/SDL.h>

int main(int argc, char *argv[])
{
    SDL_Init(SDL_INIT_EVERYTHING);
    SDL_Quit();

    return 0;
} 
```

我在链接过程中收到这条漂亮的错误消息：

> d:/programme/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a(main.o): 在函数`main': C:\MinGW\msys\1.0\src\mingwrt/../mingw/main.c:73: undefined reference to`WinMain@16'

这很奇怪，因为目录 C:\MinGW 甚至根本不存在。

用于链接的命令是这个： gcc "-LD:\Programme\SDL\lib" -o test.exe test.o -lsdl

经过两个小时试图让图书馆链接正常工作后，我很困惑，不知道我做错了什么。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-17T12:19:45.920

看起来您正在构建一个`Windows GUI`需要`WinMain`, 而您的代码仅提供`main`用于控制台应用程序的功能的应用程序。

因此，如果这应该是一个控制台应用程序，您必须相应地调整您的链接器设置，或者您必须声明一个`WinMain`.

# c# - 网格不记得动态添加的元素

> ID：12556823
> 
> 赞同：1
> 
> 时间：2012-09-23T22:30:41.413
> 
> 标签：c#, windows-phone-7, xaml, invalidoperationexception

我正在尝试在我的 MainPage 中使用添加在后面代码中的 Web 浏览器项填充网格。出于某种原因，我无法让网格记住已经添加了哪些元素。我不确定如何存储此信息，以便在从 MainPage 导航然后返回到时，网格知道先前添加了哪些值。为了更好地解释，我所拥有的如下：

主页.xaml

```
<Grid x:Name="BrowserHost" Grid.Row="1">
    //Items will be added in code behind
</Grid> 
```

MainPage.xaml.cs

```
private void ShowTab(int index) 
    {
        this.currentIndex = index;
        int count = Settings.BrowserList.Value.Count;

        if (count <= 0)
        {                
            MessageBox.Show("count <= 0");
        }
        if (currentIndex <= (count - 1))  //in correct range
        {
            // BrowserHost does not remember previously added children elements added previously when navigated back to this page and performing this check
            if(!BrowserHost.Children.Contains(Settings.BrowserList.Value[currentIndex].Browser))
                //Attempt to add browser if it was already added previously throws InvalidOperationException
                BrowserHost.Children.Add(Settings.BrowserList.Value[currentIndex].Browser);
        }

        if (currentIndex > (count - 1))
        {
            MessageBox.Show("currentIndex > (count - 1)");
        }

        for (int i = 0; i < Settings.BrowserList.Value.Count; i++)
        {
            if (Settings.BrowserList.Value.ElementAt(i) != null)
            {
                Settings.BrowserList.Value.ElementAt(i).Browser.Visibility = i == this.currentIndex ? Visibility.Visible : Visibility.Collapsed;
            }
        }
    } 
```

本质上，`ShowTab`每次加载 MainPage 时都会使用特定的索引值调用该方法。执行检查以查看`Settings.BrowserList.Value[currentIndex].Browser`（具有 Web 浏览器实例的集合）是否存在于列表中的 currentIndex（这些被添加到另一个页面中）。如果`BrowserHost`MainPage 上的网格已经包含具有特定索引的子元素（浏览器），那么它应该跳过检查并继续在屏幕上显示该浏览器实例。这应该基本上为我创建的自定义 Web 浏览器控件实现选项卡式浏览场景。我的问题是，我可以连续添加新的浏览器`BrowserHost`并将它们显示在屏幕上，但是当我尝试在我的集合中的某个索引处调用以前添加的网络浏览器时，我得到一个 InvalidOperationException。我将如何解决这个问题？我的调试表明，`ShowTab`当我检查是否已添加浏览器时，无论是否添加，它都会尝试将该浏览器添加到`BrowserHost`子元素。如果之前已经创建了浏览器，那就是 InvalidOperationException 发生的时候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:23:13.567

我不认为你在做什么是一个好主意。但是，问题似乎是该控件已经由不同的控件作为父级，因此您无法再次添加它。尝试执行以下操作：

```
var browser = Settings.BrowserList.Value[currentIndex].Browser;
if(!BrowserHost.Children.Contains(browser))
{

  var grid = (Grid)browser.Parent;
  if (grid != null)
  {
    grid.Children.Remove(browser);
  }
  BrowserHost.Children.Add(browser);
} 
```

您还需要确保浏览器以其他形式放置在 Grid 中（如果它不直接在 Grid 中，只需将其包装在一个中）。

这可能有效，但我**强烈**建议您找到一种不同的方法。

# python - 当用'..' Python 分隔时，将两个整数附加到列表中

> ID：12556825
> 
> 赞同：1
> 
> 时间：2012-09-23T22:30:54.553
> 
> 标签：python, string, list, integer, find

如果我有一个列表字符串：

```
first = []
last = []

my_list = ['  abc   1..23',' bcd    34..405','cda        407..4032'] 
```

我将如何将 .. 两侧的数字附加到相应的列表中？要得到：

```
first = [1,34,407]
last = [23,405,4032] 
```

我也不介意字符串，因为我可以稍后转换为 int

```
first = ['1','34','407']
last = ['23','405','4032'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:36:56.637

用于[`re.search`](http://docs.python.org/library/re.html#re.RegexObject.search)匹配数字`..`并将它们存储在两个不同的组中：

```
import re

first = []
last = []

for s in my_list:
  match = re.search(r'(\d+)\.\.(\d+)', s)
  first.append(match.group(1))
  last.append(match.group(2)) 
```

**[演示](http://ideone.com/IBcKu)**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T22:37:59.483

我会使用正则表达式：

```
import re
num_range = re.compile(r'(\d+)\.\.(\d+)')

first = []
last = []

my_list = ['  abc   1..23',' bcd    34..405','cda        407..4032']

for entry in my_list:
    match = num_range.search(entry)
    if match is not None:
        f, l = match.groups()
        first.append(int(f))
        last.append(int(l)) 
```

这输出整数：

```
>>> first
[1, 34, 407]
>>> last
[23, 405, 4032] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T22:39:43.547

另一种解决方案。

```
for string in my_list:
    numbers = string.split(" ")[-1]
    first_num, last_num = numbers.split("..")
    first.append(first_num)
    last.append(last_num) 
```

如果在 my_list 中有一个没有空格的字符串，或者在某些字符串的最后一个空格之后没有“..”（或者在字符串的最后一个空格之后有多个“..”，它将抛出 ValueError ）。

事实上，如果您想确保确实从所有字符串中获得了值，并且所有这些值都放在最后一个空格之后，这是一件好事。你甚至可以添加一个 try...catch 块来做一些事情，以防它试图处理的字符串是一种意外的格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T04:39:48.993

```
 first=[(i.split()[1]).split("..")[0] for i in my_list]
 second=[(i.split()[1]).split("..")[1] for i in my_list] 
```

# c++ - 远近不一致

> ID：12556835
> 
> 赞同：5
> 
> 时间：2012-09-23T22:34:08.317
> 
> 标签：c++, windows, variables, tags, c-preprocessor

我一直在检查并重构一些代码。我最终改变了一个功能：

```
void setPerspective(float nearP = 0.1f, float farP = 1000.0f); 
```

到

```
void setPerspective(float near = 0.1f, float far = 1000.0f); 
```

并开始出现很多奇怪`'missing ;'`和`'missing )'`错误。

似乎`near`和`far`都`#define`在`windef.h`. 很公平; 我会避免使用它们。

但后来我注意到另一个头文件：

```
void setPerspective(float fov, float aspect, float near, float far); 
```

然而我没有遇到任何麻烦。这两个头文件具有相同`#include`的...

知道为什么我在一个问题上遇到问题，而在另一个问题上却没有吗？它似乎不是默认参数。是否是 s 的某种任意顺序`#include`可能导致一个头文件而不是另一个头文件出现问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T22:58:10.927

令牌`near`和`far`可能被定义为 null 在这样的`#define`空

```
#define near
#define far 
```

所以预处理器会将它们替换为 null - 它们在编译器处理源之前消失。

第一个函数声明包括对参数的默认分配

```
void setPerspective(float nearP = 0.1f, float farP = 1000.0f); 
```

编译器将 nearP 和 farP 正确解释为参数名称和`float`类型。当您更改`nearP`为`near`和`farP`更改为`far`预处理器时，将它们替换为 null 并且您对`float`类型进行了分配......并且编译器抛出了一个合适的......这就是编译器看到的：

```
void setPerspective(float  = 0.1f, float  = 1000.0f); 
```

在第二个头文件中，函数原型中的参数没有默认赋值，编译器看到参数是浮动的，没有看到`near`，`far`因为它们是空的......所以而不是这个

```
void setPerspective(float fov, float aspect, float near, float far); 
```

编译器看到这个

```
void setPerspective(float fov, float aspect, float , float ); 
```

这是一个完全合法的函数原型（您不必给出参数名称）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T22:39:38.640

猜测一下，您正在 Windows 机器上进行编译。

很久以前，迷失在时间的迷雾中，有像 Intel 8086、80186 和 80286 这样的机器。在这些机器上，可用内存有限。他们大多使用 16 位指针。但随后程序增长了一点，因此添加了关键字`near`和`far`作为限定符来识别不同大小的指针。

你遇到的是那些黑暗的原始日子的遗留物。Sane 计算机（80386 以上）不需要`near`and`far`符号，但编译器继续支持它们以实现向后兼容性。

如果此诊断准确，请避免使用名称`near`和`far`; 将它们视为旧版本语言遗留下来的关键字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T22:39:00.513

看这篇文章：[Near and Far pointers](https://stackoverflow.com/questions/3869830/near-and-far-pointers)

它们似乎是用于访问不同类型内存的指针类型，但不再使用。

看起来他们被称为nearP和farP是有原因的。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T22:44:54.077

头文件不仅受到它们自己`#include`的 s 的影响，而且还受到在`#include`这些头文件之前出现在根源文件中的 s 的影响。

```
/* foo.cpp */
#include "bar.h"
#include "foo.h" // foo.h is influenced by whatever is brought in by bar.h 
```

标识符`far`和`near`（以及其他）是一些针对 8086/88 分段架构（运行 MS-DOS 和 Windows 3.x）的编译器中的扩展。Windows 头文件中可能有一些东西可以支持遗留代码，比如可能`#define far`（将其定义为空）。

另一方面，您通常应该使用`double`浮点数。该`float`类型用于在大型数组中保存存储（它可能小于也可能不小于`double`）。在具有 IEEE 754 浮点数的平台上，`float`通常是 32 位数字：它有 7 位指数和 24 位尾数，这很差。而`double`64 位类型，具有 11 位指数和 52 位尾数：明显更好的范围和精度。

# python - 有没有一种简单的方法可以让 unicode 在 python 中工作？

> ID：12556839
> 
> 赞同：12
> 
> 时间：2012-09-23T22:34:31.337
> 
> 标签：python, unicode, utf-8, python-2.7

我正在尝试处理 python 2.7.2 中的 unicode。我知道有这样的`.encode('utf-8')`东西，但是当我添加它时，有 1/2 的时间会出错，而当我不添加它的时候，有 1/2 的时间会出错。

有什么方法可以告诉 python - 我认为是一种最新和现代的语言，只使用 unicode 作为字符串，而不是让我不得不放屁`.encode('utf-8')`？

我知道... python 3.0 应该做到这一点，但我不能使用 3.0 和 2.7 反正不是那么旧...

例如：

```
url = "http://en.wikipedia.org//w/api.php?action=query&list=search&format=json&srlimit=" + str(items) + "&srsearch=" + urllib2.quote(title.encode('utf-8'))
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 19: ordinal not in range(128) 
```

**更新** 如果我`.encode`从我的所有代码中删除我的所有语句并添加`# -*- coding: utf-8 -*-`到我的文件顶部，`#!/usr/bin/python`那么我得到以下内容，就像我根本没有添加一样`# -*- coding: utf-8 -*-`。

```
/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib.py:1250: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
  return ''.join(map(quoter, s))
Traceback (most recent call last):
  File "classes.py", line 583, in <module>
    wiki.getPage(title)
  File "classes.py", line 146, in getPage
    url = "http://en.wikipedia.org/w/api.php?action=query&prop=revisions&format=json&rvprop=content&rvlimit=1&titles=" + urllib2.quote(title)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib.py", line 1250, in quote
    return ''.join(map(quoter, s))
KeyError: u'\xf1' 
```

我没有手动输入任何字符串，而是从网站解析 HTML 和 json。所以脚本/字节流/无论它们是什么，都是由python创建的。

**更新 2**我可以移动错误，但它只是不断出现在新的地方。我希望 python 会成为一个有用的脚本工具，但看起来在 3 天没有运气之后我会尝试另一种语言。很遗憾，python 预装在 osx 上。我已将修复我发布的错误的一个实例的答案标记为正确。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-10-29T09:40:59.820

这是一个非常古老的问题，但只想添加一个部分建议。虽然我同情 OP 的痛苦——我自己经历了很多——但这里有一个（部分）答案，可以让事情“更轻松”。把它放在任何 Python 2.7 脚本的顶部：

`from __future__ import unicode_literals`

这至少可以确保您自己的文字字符串默认为 unicode 而不是 str。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-23T23:52:19.887

除了在任何地方使用 unicode 字符串并立即解码您收到的任何编码字符串之外，没有办法让 unicode “正常工作”。问题是，无论您是在处理编码数据还是未编码数据，或者使用为您跟踪数据的工具，您都必须始终保持直截了当，否则您将度过一段糟糕的时光。

Python 2 做了一些有问题的事情：它使`str`“默认”而不是字符串文字之类的东西，当您添加两者时`unicode`它会默默地强制`str`转换，并且它允许您调用已经编码的字符串进行双重编码它。结果，有很多 python 编码器和 python 库不知道它们设计用于使用什么编码，但仍然设计用于处理*某些*特定编码，因为该类型旨在让程序员管理编码本身。每次使用这些库时都必须考虑编码，因为它们本身不支持该类型。`unicode``.encode()`*`str``unicode`*

 ** * *

在您的特定情况下，第一个错误告诉您正在处理编码的 UTF-8 数据并尝试对其进行双重编码，而第二个错误告诉您正在处理未编码的数据。*看起来*你可能两者都有。你真的应该找到并解决问题的根源（我怀疑它与我上面提到的无声强制有关），但这里有一个应该在短期内解决它的 hack：

```
encoded_title = title
if isinstance(encoded_title, unicode):
    encoded_title = title.encode('utf-8') 
```

* * *

[如果这实际上是一种无声强制咬你的情况，你应该能够使用优秀的unicode-nazi](http://pypi.python.org/pypi/unicode-nazi)工具轻松追踪问题：

```
python -Werror -municodenazi myprog.py 
```

这将在 unicode 泄漏到您的非 unicode 字符串时为您提供追溯，而不是尝试从实际问题开始排除这种异常。有关详细信息，请参阅我对这个[相关问题](https://stackoverflow.com/a/12557909/307705)的回答。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T23:07:03.447

是的，将您的 unicode 数据定义为 unicode 文字：

```
>>> u'Hi, this is unicode: üæ'
u'Hi, this is unicode: üæ' 
```

您通常希望使用 '\uxxxx` unicode 转义或设置源代码编码。例如，模块顶部的以下行将编码设置为 UTF-8：

```
# -*- coding: utf-8 -*- 
```

阅读[Python Unicode HOWTO](http://docs.python.org/howto/unicode.html)了解详细信息，例如默认编码等（例如，默认源代码编码是 ASCII）。

至于您的具体示例，您的标题不是 Unicode 文字而是 python 字节字符串，python 正在尝试为您将其解码*为*un​​icode，以便您可以再次对其进行编码。这失败了，因为这种自动编码的默认编解码器是 ASCII：

```
>>> 'å'.encode('utf-8')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 0: ordinal not in range(128) 
```

编码仅适用于实际的 unicode 字符串，因此需要*显式*解码字节字符串：

```
>>> 'å'.decode('utf-8').encode('utf-8')
'\xc3\xa5' 
```

如果您习惯了 Python 3，那么 Python 2 ( `u''`) 中的 unicode 文字是 Python 3 中新的默认字符串类型，而 Python 2 ( ) 中的常规（字节）字符串与 Python 3 ( ) 中的对象`''`相同。`bytes``b''`

如果您在使用和不使用编码调用时都有错误`title`，则您有混合数据。根据需要测试标题和编码：

```
if isinstance(title, unicode):
    title = title.encode('utf-8') 
```

您可能想找出产生混合 unicode / 字节字符串标题的原因，并更正该源以始终产生一个或另一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T23:12:27.950

确保 title.encode("utf-8") 中的标题是 unicode 类型，不要使用 str("İŞşĞğÖöÜü")

在你的字符串化器中使用 unicode("ĞğıIİiÖöŞşcçÇ")

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-28T21:34:33.387

实际上，让 Python 与 unicode 一起工作的**最简单方法是使用 Python 3，默认情况下所有内容都是 unicode。**

不幸的是，为 P3 编写的库并不多，在编码和关键字使用方面也存在一些基本差异。这就是我遇到的问题：我需要的库仅适用于 P 2.7，我不知道将它们转换为 P 3。:(*

# javascript - Javascript字符串到二维数组

> ID：12556842
> 
> 赞同：0
> 
> 时间：2012-09-23T22:35:16.433
> 
> 标签：javascript, arrays, string, multidimensional-array

好的，我一直在尝试许多不同的事情来让它发挥作用。

我需要一个用逗号分隔的字符串到一个二维数组中......例如：

```
string = "a,b,c,d,e,1,2,3,4,5";
array = [['a','1'],['b','2'],['c','3'],['d','4'],['e','5']]; 
```

这是我一直在调整的代码。

```
var temp = list.split(',');
questions = [[''],[''],[''],[''],['']];
five = 0;
one = 0;
for(var i = 0; i < temp.length; i++) {
    if(one == 5){five++; one = 0;}
    one++;
    questions[one][five] = temp[i];
} 
```

顺便说一句列表=“a，b，c，d，e，1,2,3,4,5”。

提前致谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:35:16.433

好的，所以我在问问题之前修复了它……但我做了很多工作，我还是会发布它。

这是我现在有效的代码：

```
 var temp = list.split(',');

questions = [[],[],[],[],[]];

for(var i = 0; i < temp.length; i++) {
    questions[i%5][Math.floor(i/5)] = temp[i];
    one++;
} 
```

谢谢巴尔玛！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:44:54.607

我建议采用稍微不同的方法，避免（在我看来过于）复杂的`for`循环内部：

```
var string = "a,b,c,d,e,1,2,3,4,5",
    temp = string.split(','),
    midpoint = Math.floor(temp.length/2),
    output = [];

for (var i=0, len=midpoint; i<len; i++){
    output.push([temp[i], temp[midpoint]]);
    midpoint++;
}

console.log(output); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/YknJH/2/)。

# objective-c - 目标 C 中的 If (BOOL)：未使用的变量

> ID：12556844
> 
> 赞同：2
> 
> 时间：2012-09-23T22:35:30.920
> 
> 标签：objective-c, if-statement, boolean, ios6, cgrect

在 CGRect 的实现中，我尝试这样做：

```
BOOL didStartPressing = NO;
if ( didStartPressing) {int nmax=5;}
else{int nmax=500;}

for (int n=1; n<nmax; n=n+1){ *... working code that draws some circles ....*     } 
```

这会在上面的第一部分中给出关于“未使用的变量 nmax”的黄色警告和关于“使用未声明的变量 nmax”的红色警告。对于 for 循环。但是，如果我只是将上面的前三行替换为

```
int nmax=500; 
```

我得到了一张我在 CGRect 中绘制的可爱图片。

非常感谢您的帮助，因为我完全没有学习曲线的硬墙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:39:26.167

您已将 的*范围*限制在和之后的`nmax`大括号内。因此，您有两个具有该名称的变量，这两个变量对循环都不可见。要解决此问题，请将声明移至外部作用域并简单地分配给/作用域中的变量：`if``else``for``if``else`

```
int nmax = 0;   // the = 0 is optional in this case because all code
                // paths assign a value to nmax
BOOL didStartPressing = NO;
if (didStartPressing) {
    nmax=5;
} else {
    nmax=500;
}

for (int n=1; n<nmax; n=n+1) {
    /*... working code that draws some circles ....*/
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:39:04.753

这是C语言的东西。在一对大括号内声明的变量的范围只是大括号内的部分。这意味着您有两个不同的变量，它们都被调用`nmax`并且每个都限制在 if/else 语句的部分。

你可以让它工作：

```
int nmax = 500;
if ( didStartPressing) {
    nmax=5;
} 
```

有关更多详细信息，请参阅有关 C 编程的书。

# cakephp - CakePHP 的 Foreach 逻辑问题

> ID：12556847
> 
> 赞同：0
> 
> 时间：2012-09-23T22:36:11.770
> 
> 标签：cakephp, loops, foreach

我有我的问题，我希望有人可以帮助我。我认为这段代码是正确的，但它不起作用。下面是我的代码，它是我的 CakePHP 2.2.2 站点的一个函数，代码的主要目的是从数据库结果中生成一个菜单系统。问题在于我的 foreach 循环，它不会循环。$Key 所做的只是返回值 2（此时表中的三个记录）。所以当我显示/echo/debug $Menu 时，我得到的唯一结果是存储在数据库中的最后一个结果。

我知道 SQL 命令是正确的，如果已调试/回显，则显示所有三个结果。这个循环的想法是让它计算结果，这样我就可以对选定的字段进行检查。我哪里错了？

```
function MenuSystem() {
 $this->loadModel('Menu');

 $MenuSQL = $this->Menu->find('all', array('conditions' => array('active' => true)));

 foreach ($MenuSQL as $Key=>$Value) {

    $MenuSystem = $MenuSQL[$Key];
    $this->Menu = $MenuSystem;

 }

 } 
```

非常感谢，格伦。

更新 ：：：

下面是我的函数，现在我的 foreach 循环现在可以工作了，不知道我做错了什么，但我知道它可以工作。您可以看到我用于测试的 print_r 命令，如果我使用它，那么我的数据库中的所有链接都会在屏幕上打印/回显，并且一切正常。但是，如果我尝试从另一个控制器调用 $this->Menu，那么只有最后一条记录会在屏幕上回显。我已经将 $this->Menu 移到了 foreach 循环之外，但它没有任何区别，无论是在循环内部还是外部，它仍然只回显最后一条记录，而不是全部三个。那么我做错了什么？

```
function MenuSystem() {
  $this->loadModel('Menu');
  $SiteBase = '/projects/cake/';
  $MenuSQL = $this->Menu->find('all', array('conditions' => array('active' => true)));

foreach ($MenuSQL as $key => $Value) {

    $MenuAccessLevel = $MenuSQL[$key]['Menu']['roles_id'];

    if ($MenuAccessLevel == 1) {
      $Path = $MenuSQL[$key]['Menu']['path'];
      $Title = $MenuSQL[$key]['Menu']['title'];
      $MenuSys = "<a href=\" " . $SiteBase . $Path . " \">" . $Title ."";
    } else {
       print ("Admin");
    }
    //print_r($MenuSys);
} //End of Foreach Loop 
   $this->Menu = $MenuSys;
} //End of function MenuSystem 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:42:53.613

> 所以当我显示/echo/debug $Menu 时，我得到的唯一结果是存储在数据库中的最后一个结果。

您在`$this->Menu`foreach 中设置 的值，因此当 foreach 完成时，它将采用最后一个迭代的值。

如果要查找匹配条件的记录数，请尝试：

```
$menuCount = $this->Menu->find('count', array(
    'conditions'=>array('active'=>true)
));
$this->set(compact('menuCount')); 
```

编辑：另外，通过设置`$this->Menu`foreach 中的值，您将覆盖 Menu 模型变量。这不是一个好主意。

Edit2：要获取按某个值分组的行数，请尝试：

```
$this->Menu->virtualFields = array('count' => 'count(*)');
$counts = $this->Menu->find('all', array(
    'group'=>'Role',
    'fields'=>array('Role', 'count'),
)); 
```

这会生成 SQL 以按`Role`列对结果进行分组。返回的字段是角色的名称，以及具有该值的行数。

如果您想使用 foreach 循环来代替，它可能如下所示：

```
$menus = $this->Menu->find('all', array('fields'=>array('id', 'Role')));
$counts = array('user'=>0, 'admin'=>0);
foreach ($menus as $menu) {
    $role = $menu['Menu']['Role'];
    $counts[$role] += 1;
} 
```

# c# - 如何为表编写自定义类

> ID：12556851
> 
> 赞同：1
> 
> 时间：2012-09-23T22:36:54.057
> 
> 标签：c#, c#-4.0

我的数据库中有动态表，我无法将动态表表示为自定义类。请看一下我创建的这个类：

```
public class Table
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int? ParentId { get; set; }
    public string Description { get; set; }
    public List<Row> Row { get; set; }
}

public class Row
{
    private List<Column> RowColumn { get; set; } 
}

public class Column
{
    public string ColumnName { get; set; }
    public string ColumnType { get; set; }
    public object ColumnValue { get; set; }
} 
```

有没有人看到更好的方法来做到这一点？这个问题与[https://stackoverflow.com/questions/12230400/which-dbms-allows-very-large-numbers-of-tables-and-columns-per-table有关](https://stackoverflow.com/questions/12230400/which-dbms-allows-very-large-numbers-of-tables-and-columns-per-table)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:49:00.047

如果您绝对需要动态表数据的容器，我会坚持使用[`DataTable`](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)该类而不是自己编写。

我在您的设计中看到的一个问题是，您在每个单元格中冗余地保存了列名和类型。根据这些表的大小，这可能会浪费大量内存。

最好不要重新发明轮子（除非它具有前所未有的功能，例如悬停能力或其他东西）。

# actionscript-3 - 从另一个函数内部调用一个函数

> ID：12556853
> 
> 赞同：0
> 
> 时间：2012-09-23T22:36:59.813
> 
> 标签：actionscript-3, flash, function, loops

我需要一点帮助。我正在尝试创建三个函数的循环。我创建了第一个循环，但在第三个循环完成后我无法进入第一个函数。我认为最好的解决方案是在第三个中调用第一个，但我不确定这是最好的方法。无论如何，这是我的代码：

```
function LOADALL(event:MouseEvent):void{
if (ConditionC == "NotPlaying"){
    ConditionC = "Playing";
    var urlRequest:URLRequest = new URLRequest(Sounds_Array[i]);
    var wav:URLLoader = new URLLoader();
    wav.dataFormat = 'binary';
    wav.load(urlRequest);
    wav.addEventListener(Event.COMPLETE, playWav);
    }
}

function playWav(e:Event):void{
    var tts:WavSound = new WavSound(e.target.data as ByteArray);
    var channel:WavSoundChannel = tts.play();
    channel.addEventListener(Event.SOUND_COMPLETE, completeHandler)
}

function completeHandler(e:Event):void{
    ConditionC = "NotPlaying";
trace ("hello");
LOADALL();
} 
```

错误在最后一行的第二个（ LOADALL(); ）

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:40:36.353

您试图在`LOADALL`没有任何参数的情况下调用该函数，而实际上它需要一个参数：`event`- 这可能就是您收到错误的原因。由于您没有使用`event`in `LOADALL`，因此只需 pass `null`，即：

```
LOADALL(null); 
```

# html - 两个浮动的 div 并排，高度相同

> ID：12556856
> 
> 赞同：1
> 
> 时间：2012-09-23T22:37:28.373
> 
> 标签：html, css

> **可能重复：**
> [较大的 div 中的 2 个 div 必须等于相同的高度……但是如何？](https://stackoverflow.com/questions/10222695/2-divs-in-a-larger-div-must-equal-the-same-height-but-how)

我无法将 containerLeft div（红色背景）的高度自动设置为与 containerRight div 相同的高度。我特别希望它保持流动网格。

jsfiddle在这里：http: [//jsfiddle.net/s7ufg/](http://jsfiddle.net/s7ufg/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T22:54:26.873

如果您知道两列中的一列总是比另一列高，那么您可以执行以下操作：

# [演示](http://jsfiddle.net/s7ufg/2/)

只需给`position: absolute`较短的列并使其从 延伸`top: 0`到`bottom: 0`。

**HTML**：

```
<div class='container'>
    <div class="containerLeft">
        <h2>1.</h2>
        <p>First, let's play a video.</p>
    </div>
    <div class="containerRight">
        <img src="http://tctechcrunch2011.files.wordpress.com/2012/09/michael-headshot-red.jpg?w=288" />
    </div>
</div>​ 
```

**CSS**：

```
.container { position: relative; }
.containerLeft { /* shorter column */
    position: absolute;
    top: 0; bottom: 0; left: 0;
    width: 38%;
    padding: 2%;
    background-color: crimson;
}
.containerRight { /* taller column */
    margin: 0 0 0 42%;
    width: 58%;
    background: dodgerblue;
}​ 
```

* * *

如果您不确定其中哪一个会更高，那么您可以通过在其父级上使用背景[渐变来](https://developer.mozilla.org/en-US/docs/CSS/linear-gradient)*模拟*它们相等的事实。`height`

# [演示](http://jsfiddle.net/s7ufg/3/)

HTML也是一样，**CSS**变成：

```
.container {
    overflow: hidden;
    background: -webkit-linear-gradient(left, crimson 42%, dodgerblue 42%);
    background: -moz-linear-gradient(left, crimson 42%, dodgerblue 42%);
    background: -o-linear-gradient(left, crimson 42%, dodgerblue 42%);
    background: linear-gradient(left, crimson 42%, dodgerblue 42%);
}
.containerLeft, .containerRight { float: left; }
.containerLeft {
    width:38%;
    padding: 2%;
}
.containerRight { width: 58%; }​ 
```

* * *

但是，[CSS 渐变在 IE9 及更早版本中不起作用](http://caniuse.com/#feat=css-gradients)，所以如果你想要 IE8+ 的解决方案，那么你可以试试这个

# [演示](http://jsfiddle.net/s7ufg/4/)

它使用[`:before`](https://developer.mozilla.org/en-US/docs/CSS/::before)和[伪元素](https://developer.mozilla.org/en-US/docs/CSS/Pseudo-elements)。[`:after`](https://developer.mozilla.org/en-US/docs/CSS/::after)

```
.container {
    overflow: hidden;
    position: relative;
}
.container:before,.container:after {
    position: absolute;
    z-index: -1;
    top: 0; bottom: 0;
    content: '';
}
.container:before {
    left: 0;
    width: 42%;
    background: crimson;
}
.container:after {
    right: 0;
    width: 58%;
    background: dodgerblue;
}
.containerLeft, .containerRight { float: left; }
.containerLeft {
    z-index: 2;
    width:38%;
    padding: 2%;
}
.containerRight { width: 58%; }​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T23:10:31.513

您可以从一列中剪掉底部：http: [//jsfiddle.net/gtGjY/](http://jsfiddle.net/gtGjY/)

我补充说：

```
.containerLeft {
    padding-bottom: 1005px;
    margin-bottom: -1000px;
}
.outer { overflow: hidden; } /* div around both columns */

.containerRight img {
    display: block;
}​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:44:53.007

浮动 div 的问题在于它们脱离了“正常流程”。这意味着 CSS 解释器不知道父级的大小，因此无法“自动”设置高度，您必须手动设置高度。

你的小提琴的这个更新应该让事情变得清楚：http: [//jsfiddle.net/s7ufg/1/](http://jsfiddle.net/s7ufg/1/)

# c# - 更改 Control Parent 会删除内容

> ID：12556859
> 
> 赞同：1
> 
> 时间：2012-09-23T22:38:05.320
> 
> 标签：c#, winforms, datagridview, parent, tabcontrol

在我的应用程序中，我有一个从一个选项卡控件移动到另一个选项卡控件的 DataGridView。

我通过改变它的父母来做到这一点。这在第一次从原始选项卡控件移动到新选项卡控件时没有问题，但是当将父级更改回原始选项卡时，DataGridView 显示（所有列都可见）但视图中没有数据。

我试图将数据重新加载到 DataGridView 中，并刷新/使控件无效以使其重绘，但它仍然显示为空。但是，当控件返回辅助父级时，数据又返回了。

我也在为另一个 DataGridView 使用这个确切的代码，它完全没有任何问题。

任何想法将不胜感激，并在此先感谢。

从原始到次要

```
gvwRFIs.Parent = tabProcessingRFI; //Working
gvwConsentInfoMemos.Parent = tabProcessingMemos; //Working 
```

从中学到原创

```
gvwRFIs.Parent = tabConsentInfoRFI; //Empty Data
gvwConsentInfoMemos.Parent = tabConsentInfoMemos; //Working 
```

RFI DataGridView 设计器代码

```
 // 
        // gvwRFIs
        // 
        this.gvwRFIs.AllowUserToAddRows = false;
        this.gvwRFIs.AllowUserToDeleteRows = false;
        this.gvwRFIs.AllowUserToResizeRows = false;
        this.gvwRFIs.AutoSizeRowsMode = System.Windows.Forms.DataGridViewAutoSizeRowsMode.AllCellsExceptHeaders;
        this.gvwRFIs.BackgroundColor = System.Drawing.Color.White;
        this.gvwRFIs.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
        this.gvwRFIs.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
        this.gvwID,
        this.gvwType,
        this.gvwSeq,
        this.gvwCreated,
        this.gvwProcessor,
        this.gvwLetter,
        this.gvwResponded,
        this.gvwS,
        this.gvwDetails});
        this.gvwRFIs.Dock = System.Windows.Forms.DockStyle.Fill;
        this.gvwRFIs.Location = new System.Drawing.Point(3, 3);
        this.gvwRFIs.MultiSelect = false;
        this.gvwRFIs.Name = "gvwRFIs";
        this.gvwRFIs.ReadOnly = true;
        this.gvwRFIs.RowHeadersVisible = false;
        this.gvwRFIs.RowHeadersWidth = 4;
        this.gvwRFIs.SelectionMode = System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect;
        this.gvwRFIs.Size = new System.Drawing.Size(1078, 422);
        this.gvwRFIs.TabIndex = 4;
        this.gvwRFIs.DoubleClick += new System.EventHandler(this.gvwRFIs_DoubleClick); 
```

同意选项卡控件设计器代码

```
 // 
        // tabConsentInfoRFI
        // 
        this.tabConsentInfoRFI.Controls.Add(this.gvwRFIs);
        this.tabConsentInfoRFI.Controls.Add(this.lvwConsentInfoRFI);
        this.tabConsentInfoRFI.Location = new System.Drawing.Point(4, 32);
        this.tabConsentInfoRFI.Name = "tabConsentInfoRFI";
        this.tabConsentInfoRFI.Padding = new System.Windows.Forms.Padding(3);
        this.tabConsentInfoRFI.Size = new System.Drawing.Size(1084, 428);
        this.tabConsentInfoRFI.TabIndex = 4;
        this.tabConsentInfoRFI.Text = "RFI\'s";
        this.tabConsentInfoRFI.UseVisualStyleBackColor = true; 
```

处理选项卡控件设计器代码

```
 // 
        // tabProcessingRFI
        // 
        this.tabProcessingRFI.Location = new System.Drawing.Point(4, 36);
        this.tabProcessingRFI.Name = "tabProcessingRFI";
        this.tabProcessingRFI.Padding = new System.Windows.Forms.Padding(3);
        this.tabProcessingRFI.Size = new System.Drawing.Size(868, 465);
        this.tabProcessingRFI.TabIndex = 1;
        this.tabProcessingRFI.Text = "RFI";
        this.tabProcessingRFI.UseVisualStyleBackColor = true; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T23:49:47.803

我发现了问题，同意设计器代码中的 ListView 是一个看起来相同但不再使用的旧控件。因此，当控件的父级返回到“原始”选项卡时，它位于该控件的背景中。一旦控件被移除（认为它已经被移除），代码就会完美运行。

感谢 LarsTech 让我朝着正确的方向前进。和 akhisp 那里的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T23:15:02.930

您应该从不再存在的选项卡的 Tab.Controls 列表中删除该对象。因此，请执行以下操作：

```
tabProcessingRFI.Controls.Remove(gvwRFIs);
gvwRFIs.Parent = tabConsentInfoRFI 
```

# ios - iOS遥控器

> ID：12556862
> 
> 赞同：0
> 
> 时间：2012-09-23T22:38:19.903
> 
> 标签：ios, ipad

我正在为 iPad 开发一个应用程序，它以这种方式工作：

我有 3 个设备，如果我点击其中一个设备上的按钮，其他设备可以实时处理此事件！

我尝试了 bonjour，但无法解决发送方设备向两个接收方发送数据的问题有

什么建议吗？

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:00:31.767

我的想法是你可以建立一个简单的网络服务来做到这一点，并让每个设备都连接到网络服务中。我建议研究像[Pusher](http://pusher.com/)这样的实时框架。你可以自己写（使用轮询），但是像 Pusher 这样的东西应该可以节省你的时间。他们提供了一个 iOS 库 ( [docs](http://pusher.com/docs/client_libraries) )，集成起来并不难。

# php - 从字符串中删除：字符

> ID：12556864
> 
> 赞同：1
> 
> 时间：2012-09-23T22:38:35.873
> 
> 标签：php

我爬网以获得标题

```
$title = strip_tags($link1->plaintext); 
```

但在结果中，有一个类似的结果`Data Mining&#58 Concepts and Techniques`

如何删除它`&#58`？谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:56:38.433

问题是这`&#58;`是冒号的[字符实体引用，但您的示例被错误地终止（缺少结束分号）。](http://en.wikipedia.org/wiki/Character_entity_reference)您可以使用以下（相当幼稚的）正则表达式修复未终止的引用：

```
$broken = "Data Mining&#58 Concepts and Techniques";
$fixed = preg_replace('/(&#x?[a-e0-9]+)\b/i', '$1;', $broken); 
```

然后您可以使用`html_entity_decode`：

```
echo html_entity_decode($fixed); // Data Mining: Concepts and Techniques 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:41:54.007

`$title = str_replace("&#58", "", strip_tags($link1->plaintext));`

# android - 活动风格的改变使按钮变形

> ID：12556867
> 
> 赞同：0
> 
> 时间：2012-09-23T22:38:53.237
> 
> 标签：android, button, styles, android-actionbar

我想更改我的操作栏的样式（更改颜色和文本字体），因此设置我的清单和样式 XML，如下所示：

清单：（申请）

```
android:theme="@style/ArbuckleAppTheme" 
```

样式表：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <style name="ArbuckleAppTheme" parent="@android:style/Theme.Holo.Light">
        <item name="android:actionBarStyle">@style/ActionBarStyle</item>
    </style>

    <style name="ActionBarStyle" parent="@android:style/Widget.Holo.Light.ActionBar">
        <item name="android:background">@color/handler_noorder_startcolor</item>
        <item name="android:textColor">@color/handle_noorder_textcolor</item>
    </style>

</resources> 
```

问题是我的一个按钮（在滑动抽屉内）变得更大。我尝试更改布局值等，但现在可用。

这是按钮周围的xml：

```
 <Button
                android:id="@+id/bCancel"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerVertical="true"
                android:layout_alignParentLeft="true"
                android:text="Cancel"
               android:background="@drawable/cancel_singleitem_background"
                android:textSize="12dp"
                android:padding="5dp" 
                android:layout_marginLeft="2dp"
                android:layout_marginRight="2dp"/> 
```

我的应用程序的主要部分有一个相同的按钮 - 它不会改变形状。我想弄清楚为什么这个按钮的形状完全搞砸了。如果需要，很高兴添加更多代码 - 我想我会先从即时代码开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T05:14:25.433

我想到了！

您可以从应用程序主题中删除父属性，这将删除整个应用程序中 holo.light 格式的强加。

所以现在的代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <style name="ArbuckleAppTheme" >
        <item name="android:actionBarStyle">@style/ActionBarStyle</item>
    </style>

    <style name="ActionBarStyle" parent="@android:style/Widget.Holo.Light.ActionBar">
        <item name="android:background">@color/handler_noorder_startcolor</item>
        <item name="android:textColor">@color/handle_noorder_textcolor</item>
    </style>

</resources> 
```

顺便说一句，我所说的强加（按钮变大）是因为谷歌试图对应用程序开发施加最低标准——其中包括最小的按钮。48 像素。

我从中学到了很多——希望这对你们中的一些人来说是个消息，这样我就可以回馈。

# php - 如何在 Zend 中为单个数据库项建模

> ID：12556877
> 
> 赞同：0
> 
> 时间：2012-09-23T22:40:21.980
> 
> 标签：php, zend-framework

如何将自定义方法附加到 Zend_Db_Table_Row 对象？

例如，如果我从 users 表中选择了一个用户行并将其放在 var $myUser 中，我将如何实现类似 $myUser->getUsername()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:49:35.677

您可以扩展默认值`Zend_Db_Table_Row`并告诉`Zend_Db_Table`实例使用您的特定实现。以下示例取自[手册](http://framework.zend.com/manual/1.12/en/zend.db.table.html#zend.db.table.extending.row-rowset)：

```
class My_Row extends Zend_Db_Table_Row_Abstract
{
    // ...
}

$table = new Zend_Db_Table('bug');
$table->setRowClass('My_Row');

// Returns a rowset containing an array of objects of type My_Row.
$where = $table->getAdapter()->quoteInto('bug_status = ?', 'NEW');
$rowsCustom = $table->fetchAll($where); 
```

# c# - 我的项目无法在发布目录中构建，只能在调试中？

> ID：12556879
> 
> 赞同：1
> 
> 时间：2012-09-23T22:40:28.460
> 
> 标签：c#, vb.net, visual-studio

正如我的标题所描述的，当我进入 Build>Build Solution 并在 Properties 部分将配置更改为 Release 后，我的 Release 文件夹保持为空。有什么提示吗？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:47:03.830

打开项目的属性并检查它设置为在哪里构建以进行`Release`配置。

1.  打开项目的属性窗口。
2.  选择构建选项卡。
3.  `Release`在配置下拉列表中选择。
4.  在输出部分，检查输出路径的内容。它应该说明`bin\Release`您是否希望它构建到通常的 Release 构建输出文件夹。

![](../Images/a40387acc1ea9bcb9309c782fe14ee86.png)

* * *

或者，检查项目是否设置为实际构建在发布配置中。

1.  转到菜单上的`Build`-> 。`Configuration Manager`
2.  `Release`在活动解决方案配置下拉列表中选择。
3.  确保为您的项目勾选了 Build 列中的复选框。

![](../Images/956c465c6aa3c929a73f4515071ce1dc.png)

# windows - PowerShell v3 安装错误

> ID：12556885
> 
> 赞同：2
> 
> 时间：2012-09-23T22:41:31.440
> 
> 标签：windows, powershell, windows-7

我想将我的 PowerShell 从 v2 更新到 v3，但是在安装时，我收到一条消息**“更新不适用于您的计算机”**。我尝试安装 Windows6.1-KB2506143-x64 Windows Management Framework 3.0 - RC，因为我正在练习脚本，但我无法使用我在 v2 中学习的脚本。

我没有虚拟机。

问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T03:11:20.443

确保满足 .net 4.0 的系统要求

> Windows Management Framework 3.0 需要 Microsoft .NET Framework 4.0"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T14:32:03.180

The full release of PowerShell and the Windows Management Framework 3.0 has been released, I would suggest using it instead of the release candidate version you mentioned. You can find download links here: [http://go.microsoft.com/fwlink/?LinkId=251995](http://go.microsoft.com/fwlink/?LinkId=251995)

The supported systems matrix is tighter than previous releases - you have to be running one of the following operating systems with the correct service pack level as well:

*   Windows 7 Service Pack 1 (32-bit & 64-bit)
*   Windows Server 2008 R2 Service Pack 1 (64-bit only, includes Server Core)
*   Windows Server 2008 Service Pack 2 (32-bit & 64-bit)

Also note, if you have any of the pre-release builds of v3 installed, you will have to remove them before installing the officially released version.

# iphone - 将 NSData 写入桌面文件

> ID：12556889
> 
> 赞同：1
> 
> 时间：2012-09-23T22:41:57.943
> 
> 标签：iphone, ios, nsdata, nsfilemanager

我正在尝试将 NSData 对象写入文件，我使用的代码如下。我遇到的问题是它从不创建文件。

// 创建文件 NSFileManager *filemgr; NSData *数据缓冲区；

```
filemgr = [NSFileManager defaultManager];

databuffer = [filemgr contentsAtPath: @"/Users/imac/Desktop/mydata.dat" ];

// write to file
databuffer = [filemgr contentsAtPath: @"/Users/imac/Desktop/mydata.dat" ];

[filemgr createFileAtPath: @"/Users/imac/Desktop/mydata.dat" contents:receivedData attributes: nil]; 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T01:27:27.517

事实证明你可以（我刚刚了解到）。

[这](https://stackoverflow.com/questions/5794422/iphone-save-uiimage-to-desktop-on-simulator)是一个类似的问题。（您提供的代码也应该可以工作）。

不要忘记在模拟器（而不是 iDevice）中运行它以使其工作。

# android - 如何在 android 和 iphone webviews 显示的 html 中制作可点击按钮（点击时图像发生变化）

> ID：12556890
> 
> 赞同：1
> 
> 时间：2012-09-23T22:42:02.337
> 
> 标签：android, image, button, webview, click

我有一个适用于 android 和 iphone 的 webapp，它使用 webview 来显示网页。该页面包含一个以这种方式实现的图形按钮：

```
<INPUT id="OkBorder" type="image" src="ok_off.png"  border="0"  onclick="OkClicked()"> 
```

我希望用户在将他们重定向到新页面之前看到点击效果（按钮上的图像更改为 ok_on.png，然后再次返回 ok_off.png）。

我尝试使用：

```
function OkClicked() 
{
   button = document.getElementById("OkBorder");
   button.src = "ok_on.png";
} 
```

但是当我单击它时，我没有看到图像发生变化...

有没有办法在 webview 中以这种方式显示按钮单击效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T08:20:12.810

我认为不`button.src`正确，因为`src`它不是 javasript 命令。这是您想要做的吗，如果不是，那么您可能想尝试 d [.](http://gwydir.demon.co.uk/jo/javascript/pix.htm) 其他网站似乎使用隐藏和可见的，您可能想尝试一下。

# xml-parsing - Google App 脚本：无法从论坛 HTML 页面中提取“标题”并粘贴到电子表格中（我的代码在里面）

> ID：12556891
> 
> 赞同：0
> 
> 时间：2012-09-23T22:42:04.667
> 
> 标签：xml-parsing, google-apps-script

我对此非常陌生，我一直在尝试获取`title`每个独特的论坛页面（或主题），这是我到目前为止的代码：

```
function GraalGet() {
//parses forums for ALL posts one by one, extract <title> from HTML webpage 
 var sheet = SpreadsheetApp.getActiveSheet();
 var i = 31
 var url = "http://www.graalians.com/forums/showthread.php?p="+i;

  //var params = {method : "post"}; can this be used at all?
  //The aim: loop this once you can get 1 result.

 var geturl = UrlFetchApp.fetch(url).getContentText(); //maybe .getContentText should be elsewhere? 
 var parseurl = Xml.parse(geturl, true);               //confirmed - this is true because it wont parse HTML if false
 var titleinfo = parseurl.getElement().getElement("html"); //.getElement('body');//.getElements("title");

 sheet.appendRow([titleinfo, i]);
} 
```

此外，脚本会在相邻单元格中记下主题编号。有很多关于提取 XML 数据的已回答问题，[这个示例](https://stackoverflow.com/questions/5711937/finding-elements-after-a-urlfetch)是关于解析 HTML，但我无法提取任何结果 - 老实说，我很难过，任何有关查找和提取标签的帮助将不胜感激。（如果您有时间，也请随时解释，但我会非常感谢您的帮助。）

作为参考，我使用了这些：

*   [谷歌的凯文培根脚本](https://developers.google.com/apps-script/articles/XML_tutorial)
*   [作者评论了脚本的错误和一些解释](http://productforums.google.com/forum/#!topic/apps-script/jlFsJIRcPhw)

对不起，如果我是迂腐的，这是我的第一篇文章，我不想激怒任何人，如果我违反了任何规则，请告诉我，我会尽力解决它们。我也留下了我为自己做的评论供您阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T01:34:52.193

您可以使用 Logger.log 打印出调试信息。我用你的函数做了这个，发现标题标签嵌入在标签中。所以你应该使用这样的东西。此外，getElement 返回一个 XmlElement 对象，您应该使用 getText() 将其转换为 String。

```
var titleinfo = parseurl.getElement().getElement('head').getElement('title'); 
sheet.appendRow([titleinfo.getText(), i]); 
```

# java - 如何从 blobstore 中检索字节数组？

> ID：12556892
> 
> 赞同：1
> 
> 时间：2012-09-23T22:42:08.240
> 
> 标签：java, google-app-engine, blobstore

我阅读了文档，搜索了一下，但仍然无法弄清楚如何将 blob 读取为字节数组。

我能够生成 PDF 文件并将它们存储在 blobstore 中。我还可以使用serve() 为这些blob 提供下载服务，没问题。所有这一切都很好。

现在我想检索其中一个 blob，并将其作为字节数组读取以将其传递给 Mail API，以作为 Mime 附件发送。据我了解，Mail API 仅接受字节数组作为附件数据。

我看到了 BufferedInputStream 的 read() 方法，但它建议获取 n 个字节。我需要立即阅读完整的 blob。在阅读之前我不知道它的长度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T23:24:07.123

像这样：

```
byte[] myFile = blobstoreService.fetchData(blobKey, index, index + batchSize); 
```

基本上你从 index=0 开始，然后循环遍历这个 blob，直到你得到一个比你的批处理大小短的数组。

# objective-c - 带有渐变叠加的 UIPageViewController？

> ID：12556894
> 
> 赞同：2
> 
> 时间：2012-09-23T22:42:19.783
> 
> 标签：objective-c, ios, uipageviewcontroller, cagradientlayer

我需要创建一个类似书本的应用程序并想使用 UIPageViewController。（iPad，具有两页的水平布局 (UIPageViewControllerSpineLocationMid)。

为了使屏幕更具吸引力，我希望控制器的视图覆盖有图像或 CAGradientLayer 使脊椎可见。

我尝试向 pageViewController 添加一个子视图，但是当动画过渡开始时它似乎被删除了。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T16:08:55.153

我通过将 CAGradientLayer 添加到 UIPageViewController 当前显示的子控制器的视图中解决了这个问题。我必须区分左右页面（对于双面横向模式）。为此，我创建了一个名为“rightPage”的 bool 属性并重载了 setter：

```
- (void) setRightPage:(BOOL)rightPage
{
    _rightPage = rightPage;
    if (!self.spineShadow) {
        self.spineShadow = [CAGradientLayer layer];
    }
    self.spineShadow.zPosition = 5000;
    self.spineShadow.colors = [NSArray arrayWithObjects:
                               (id)[UIColor clearColor].CGColor,
                               (id)[[[UIColor blackColor] colorWithAlphaComponent:0.3] CGColor],
                               nil];

    if (rightPage) {
        self.spineShadow.startPoint = CGPointMake(1.00f,0.5f);
        self.spineShadow.endPoint   = CGPointMake(0.00f,0.5f);
    } else {
        self.spineShadow.startPoint = CGPointMake(0.00f,0.5f);
        self.spineShadow.endPoint   = CGPointMake(1.00f,0.5f);
    }
} 
```

# ios - 从 Windows 机器访问 iOS Safari Web Inspector

> ID：12556895
> 
> 赞同：54
> 
> 时间：2012-09-23T22:42:26.900
> 
> 标签：ios, windows, safari, web-inspector

新的 iOS 6 Safari 带有 Web Inspector 功能，允许通过 USB 电缆从桌面 Safari 连接到它。然后，它允许您从桌面调试在 iOS Safari 中打开的页面。但据我所知，目前仅在 Mac Safari 上支持此功能，在 Windows 上不支持？我是对的，还是 Windows Safari 也有这种可能？或者它可能会在以后可用？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-22T11:58:23.163

它似乎需要 Safari 6，该版本尚未针对 Windows 发布。关于 Safari 6 在 Windows 上的不可用，Apple 表示“Safari 6 可用于 Mountain Lion 和 Lion。Safari 5 继续可用于 Windows。”

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-05-25T23:09:31.843

我经常使用`weinre`. 它基本上运行一个网络服务器，该服务器又充当检查器增强的代理来浏览网页和网站。可以通过向页面添加脚本或运行小书签来启动检查器。

> weinre 是一个网页调试器，例如 FireBug（用于 FireFox）和 Web Inspector（用于基于 WebKit 的浏览器），但它被设计为远程工作，特别是允许您在手机等移动设备上调试网页.

要安装它，您将需要 NodeJS 和 NPM（包含在 NodeJS 中）。您还需要在桌面/接收端（Safari、Google Chrome 或 Chromium）上使用基于 WebKit 的浏览器。它应该可以在 Windows、OSX 和 Linux 上运行。

*   官方页面：[https ://people.apache.org/~pmuellr/weinre/](https://people.apache.org/~pmuellr/weinre/)
*   文档和入门：[https ://people.apache.org/~pmuellr/weinre/docs/latest/](https://people.apache.org/~pmuellr/weinre/docs/latest/)
*   NPM 包：[https ://www.npmjs.com/package/weinre](https://www.npmjs.com/package/weinre)

如果你已经安装了 NodeJS 和 NPM，你可以安装并运行它：

```
npm i -g weinre
weinre
# Go to the URL that it outputs for instructions to use it 
```

![开发者工具和 ios 模拟器的屏幕截图，展示了 weinre 的运行情况](../Images/499318663dcfbab4047fe6563548b261.png)

### 更新：

@EvAlex 指出了另一个与 Weinre 非常相似的工具，称为[Vorlon.js](http://vorlonjs.com/)。它是可插拔的，支持同时在多个设备的检查器之间查看/切换。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-08-01T16:33:09.077

**在 Windows 上设置 Vorlon**

```
npm i -g vorlon
vorlon 
```

**验证 Vorlon 是否正在运行**

打开网络浏览器并导航到[http://localhost:1337](http://localhost:1337)

**设置 Ngrok**

*   下载 Ngrok：[https ://ngrok.com/download](https://ngrok.com/download)
*   解压
*   打开命令提示符：`Start -> Search -> cmd`
*   导航到 ngrok.exe：`cd <ngrok_path_where_ngrok.exe is stored>/`
*   运行它：`ngrok.exe http <port>`例如`ngrok.exe http 1337`

Ngrok 提供了一个网址，例如`https://0ad8c32f.ngrok.io -> localhost:1337`

将 ngrok url 复制并粘贴到您的网页中。

```
<script src="https://0ad8c32f.ngrok.io/vorlon.js"></script> 
```

在您的设备上导航到正在测试的页面：

```
http://thepageiwanttotest.com/testing123 
```

**参考**

*   Vorlon 参考：http: [//vorlonjs.com/#getting-started](http://vorlonjs.com/#getting-started)
*   Ngrok 参考：[https ://ngrok.com/download](https://ngrok.com/download)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-01T13:10:17.243

偶然发现了这个博客[，它展示了如何](http://blog.falafel.com/Blogs/josh-eastburn/2014/03/04/ios-web-inspector-on-windows-with-telerik-appbuilder "带有 Telerik AppBuilder 的 Windows 上的 iOS Web Inspector")使用 Telerik 的名为 AppBuilder 的独立应用程序在 Windows 上调试 iOS Web 应用程序。您应该在使用之前在他们的平台上创建一个帐户，并且它有 30 天的试用期。

我已经在带有 iOS 7.1 的 iPad 上的普通网络应用程序和 Phonegap 应用程序的 windows 7 64 位上使用了它，并且它可以工作。您可以获得与 Chrome 中的非常相似的 Web 开发工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-05T09:53:56.617

我发现了一个很棒的工具，叫做[GapDebug](https://www.genuitec.com/products/gapdebug/)

这对我来说是正确的解决方案:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-22T15:18:49.740

在尝试将 Weinre 安装在我的运行 IIS 和 localhost 客户端的 Windows 10 机器上并且永远无法让它工作之后，我寻找了一个替代解决方案。

原来 Safari for Windows 已被 Apple 停产，但在发现以下链接后，我能够很好地复制一份。哦，Safari 中的 Web Inspector 能够帮助我在安装应用程序后找到问题所在。

[https://apple.stackexchange.com/questions/68836/where-can-i-download-safari-for-windows](https://apple.stackexchange.com/a/94010/221180)

安装 Safari 后，我需要打开开发人员工具。这需要进入“首选项”>“高级”>选中“在菜单栏中显示开发菜单”>（单击 sprocket 图标旁边的页面图标，将鼠标悬停在“开发”上）开始在 JavaScript 中调试。从这里开始，它感觉非常像 Chrome ......:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-19T10:05:05.857

使用[iOS WebKit 调试代理](https://github.com/google/ios-webkit-debug-proxy#installation)

它允许您通过实时预览直接在 Chrome 中进行调试。

# ruby - 另一个与 "diff.*\n.*\n.*\n.*\n.*\n " 相同的正则表达式

> ID：12556897
> 
> 赞同：1
> 
> 时间：2012-09-23T22:42:36.493
> 
> 标签：ruby, regex, perl

我有这个正则表达式：

```
diff.\*\n.\*\n.\*\n.\*\n.\*\n 
```

我想匹配从单词“diff”到第五个新行的所有内容。有人可以为我简化吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T22:45:59.530

您需要分组：

```
 diff(?:.*\n){5} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T22:46:51.073

我想你在问这个：

```
/diff(.*\n){5}/ 
```

# bash - BASH - 在系统内部使用一列 awk

> ID：12556900
> 
> 赞同：2
> 
> 时间：2012-09-23T22:43:28.280
> 
> 标签：bash

在 Bash 中，我试图获得具有大多数 %CPU 的进程。一旦我得到它，我将使用 awk 来评估是否必须终止该进程或者只是改变它很好。一旦我得到了这个过程，这就是我想要做的：

```
awk -v awkmax="$CPU_MAX" '
{ 
  if( $3 > awkmax && $4 < 15 ) { 
    system("renice "$4"+5 -p "$1"")
  } 
  else if ( $3 > awkmax && $4 == 15 ) { 
    system("kill -9 "$1"")
    print "The process $1 has been killed.\n" 
  } 
}' 
```

哪里`$3`是 pcpu，`$4`是不错的值，`$1`是 pid。

我的问题在这里：

```
system("renice "$4"+5 -p "$1"") 
```

它不起作用，因为`"$4"+5`，这是该过程的实际好处加上 5。

我如何将该值传递给 renice？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:57:38.930

你有一些报价问题，第一个`system`电话应该是：

```
system("renice " $4 + 5 " -p " $1) 
```

第二个：

```
system("kill -9 " $1) 
```

空格是 中的字符串连接运算符`awk`。

关于`kill -9`：在诉诸之前最好从不太严重的信号开始`-9`，因为这不会让进程在它自己之后进行任何清理，IIRC，从 SIGHUP（`-1`）开始，然后是 SIGINT（`-2`），然后是 SIGTERM（`-15`），如果这些都不能使进程退出，则使用 SIGKILL ( `-9`)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T23:00:52.157

我可能会使用：

```
awk -v awkmax="$CPU_MAX" '
{ 
  if ($3 > awkmax && $4 < 15) {
    renice = $4 + 5 
    system("renice " renice " -p "$1"")
  } 
  else if ($3 > awkmax && $4 == 15) { 
    system("kill -9 " $1)
    print "The process $1 has been killed.\n" 
  } 
}' 
```

`awk`使用没有显式运算符的相邻值来指示连接是不寻常的。

# objective-c - 为什么谓词不是 NSFetchRequest 的属性？

> ID：12556905
> 
> 赞同：1
> 
> 时间：2012-09-23T22:43:51.133
> 
> 标签：objective-c, ios, cocoa-touch, design-patterns

NSFetchRequest 有方法`predicate`和`setPredicate`. 我想知道为什么 Apple 不将谓词作为 NSFetchRequest 的属性？那会让生活更轻松一些。

此外，似乎 NSFetchRequest 根本没有任何属性。这背后的基本原理是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T07:43:54.137

它没有属性有一个很好的理由：

*   NSFetchRequest 是在 Mac OS X 10.4 中与[Core Data一起引入的。](http://en.wikipedia.org/wiki/Core_Data)
*   属性是在 Mac OS X 10.5 中的[Objective-C 2.0中引入的。](http://en.wikipedia.org/wiki/Objective-C#Objective-C_2.0)

因此，该类早于 Objective-C 属性的发明，并且无论出于何种原因，从未被重新审视过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T07:37:06.593

你可以写

```
fetchRequest.predicate = predicate; 
```

即使`predicate`未声明为`NSFetchRequest`. 编译器将其翻译为

```
[fetchRequest setPredicate:predicate]; 
```

# objective-c - 2^n 指数计算真的比位移效率低吗？

> ID：12556906
> 
> 赞同：20
> 
> 时间：2012-09-23T22:43:55.390
> 
> 标签：objective-c, c

如果我做：

```
int x = 4;
pow(2, x); 
```

这真的比仅仅做效率低得多吗：

```
1 << 4 
```

?

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-24T01:23:40.280

是的。显示这一点的一种简单方法是编译以下两个执行相同操作的函数，然后查看反汇编。

```
#include <stdint.h>
#include <math.h>

uint32_t foo1(uint32_t shftAmt) {
    return pow(2, shftAmt);
}

uint32_t foo2(uint32_t shftAmt) {
    return (1 << shftAmt);
} 
```

`cc -arch armv7 -O3 -S -o - shift.c`（我碰巧发现 ARM asm 更容易阅读，但如果你想要 x86，只需删除 arch 标志）

```
 _foo1:
@ BB#0:
    push    {r7, lr}
    vmov    s0, r0
    mov r7, sp
    vcvt.f64.u32    d16, s0
    vmov    r0, r1, d16
    blx _exp2
    vmov    d16, r0, r1
    vcvt.u32.f64    s0, d16
    vmov    r0, s0
    pop {r7, pc}

_foo2:
@ BB#0:
    movs    r1, #1
    lsl.w   r0, r1, r0
    bx  lr 
```

您可以看到`foo2`只需要 2 条指令与`foo1`需要多条指令。它必须将数据移动到 FP HW 寄存器 ( `vmov`)，将整数转换为浮点数 ( `vcvt.f64.u32`) 调用该`exp`函数，然后将答案转换回 uint ( `vcvt.u32.f64`) 并将其从 FP HW 移回 GP 寄存器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T22:49:39.233

是的。虽然我不能说多少。确定这一点的最简单方法是对其进行基准测试。

该`pow`函数使用双精度......至少，如果它符合 C 标准。即使该函数在看到 的基数时使用了位移`2`，仍然会进行测试和分支以得出该结论，届时您的简单位移将完成。我们甚至还没有考虑函数调用的开销。

为了等效，我假设您打算使用`1 << x`而不是`1 << 4`.

也许编译器可以优化这两者，但优化对`pow`. 如果您需要最快的方法来计算 2 的幂，请使用移位来完成。

更新......因为我提到它很容易进行基准测试，所以我决定这样做。我碰巧有 Windows 和 Visual C++，所以我使用了它。结果会有所不同。我的程序：

```
#include <Windows.h>

#include <cstdio>
#include <cmath>
#include <ctime>

LARGE_INTEGER liFreq, liStart, liStop;

inline void StartTimer()
{
    QueryPerformanceCounter(&liStart);
}

inline double ReportTimer()
{
    QueryPerformanceCounter(&liStop);
    double milli = 1000.0 * double(liStop.QuadPart - liStart.QuadPart) / double(liFreq.QuadPart);
    printf( "%.3f ms\n", milli );
    return milli;
}

int main()
{    
    QueryPerformanceFrequency(&liFreq);

    const size_t nTests = 10000000;
    int x = 4;
    int sumPow = 0;
    int sumShift = 0;

    double powTime, shiftTime;

    // Make an array of random exponents to use in tests.
    const size_t nExp = 10000;
    int e[nExp];
    srand( (unsigned int)time(NULL) );
    for( int i = 0; i < nExp; i++ ) e[i] = rand() % 31;

    // Test power.
    StartTimer();
    for( size_t i = 0; i < nTests; i++ )
    {
        int y = (int)pow(2, (double)e[i%nExp]);
        sumPow += y;
    }
    powTime = ReportTimer();

    // Test shifting.
    StartTimer();
    for( size_t i = 0; i < nTests; i++ )
    {
        int y = 1 << e[i%nExp];
        sumShift += y;
    }
    shiftTime = ReportTimer();

    // The compiler shouldn't optimize out our loops if we need to display a result.
    printf( "Sum power: %d\n", sumPow );
    printf( "Sum shift: %d\n", sumShift );

    printf( "Time ratio of pow versus shift: %.2f\n", powTime / shiftTime );

    system("pause");
    return 0;
} 
```

我的输出：

```
379.466 ms
15.862 ms
Sum power: 157650768
Sum shift: 157650768
Time ratio of pow versus shift: 23.92 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T22:45:46.740

这取决于编译器，但一般来说（当编译器不是完全脑死时）是的，移位是一条 CPU 指令，另一条是函数调用，这涉及保存当前状态和设置堆栈帧，这需要很多指示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T22:48:51.967

通常是的，因为位移是处理器非常基本的操作。

另一方面，许多编译器对代码进行了优化，因此提升权力实际上只是有点转变。

# python - 在 Python 中不断提示用户输入

> ID：12556907
> 
> 赞同：0
> 
> 时间：2012-09-23T22:44:11.563
> 
> 标签：python, input

目标：*编写一个python程序，重复提示输入一个正数，直到数字的总和大于179。在你的解决方案中至少使用三个模块/函数。* 输入的最大数字不能超过 42。 * 当数字之和超过 179 时，打印数字之和、输入的最大数字和输入的最小数字。

我只需要一些指导，特别是“input_numbers”模块。必须有比为每个数字创建一个变量更简单的方法来做到这一点。代码不完整。我什至还没有开始学习其他两个模块。提前致谢。

```
def input_numbers():
    while True:
        num1 = raw_input("Enter a positive integer no greater than 42 ")
        if num1 <= 0:
            print "That is not a positive integer.  Try again "
        elif num1 > 42:
            print "The number cannot exceed 42\.  Try again "

        num2 = raw_input("Enter another positive integer ")
            if num2 <= 0:
                print "That is not a positive integer.  Try again "
        elif num2 > 42:
            print "The number cannot exceed 42\.  Try again " 

        num3 = raw_input("Enter another positive integer ")
        if num3 <= 0:
            print "That is not a positive integer.  Try again "
        elif num3 > 42:
            print "The number cannot exceed 42\.  Try again "

        num4 = raw_input("Enter another positive integer ")
        if num4 <= 0:
            print "That is not a positive integer.  Try again "
        elif num4 > 42:
            print "The number cannot exceed 42\.  Try again "

        num5 = raw_input("Enter another positive integer ")
        if num5 <= 0:
            print "That is not a positive integer.  Try again "
        elif num5 > 42:
            print "The number cannot exceed 42\.  Try again "
        elif sum(num1, num2, num3, num4, num5) > 179:
            print_numbers()

add_numbers()

def add_numbers():
print_numbers()

def print_numbers():

input_numbers() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T23:39:30.133

您可以通过封装程序的每个步骤来消除所有三个功能要求。我们将让 main 控制循环，而不是将循环放在函数内部，我们将通过将数据传入和传出函数调用来控制流程。

让我们稍微修改一下你的`input_numbers()`功能。

```
def get_input_number():
    num = int(raw_input("Enter a positive integer no greater than 42 "))
    if num <= 0 or num > 42:
        print "Invalid input.  Try again "
        get_input_number()
    else: 
        return num 
```

因此，不是让 input_numbers 控制循环以及输入处理和验证，而是让它做它的名字所暗示的那样：它要求输入，验证它，然后，如果它很好，它会将值返回给调用者，但如果它是坏的，它会写一条消息，并再次调用自己让用户可以输入好的输入。

我们将设置的下一个功能直接来自您的需求列表。从用户输入的所有数字中，我们需要找到最大的一个。仅从语言来看，我们可以确定我们正在查看一组数字，因此，这是一个分解列表的好地方。假设我们将所有用户输入存储在一个列表中，然后我们可以将该列表传递给一个函数并对其执行操作，就像这样。

```
def get_greatest_number(input_list):
    highest = input_list[0]
    for i in input_list:
        if i > highest:
            highest = i
    return highest 
```

我们将列表的第一个元素设置为一个变量`highest`，然后根据该初始值检查列表中的所有其他元素。如果我们找到一个更大的，然后我们将`highest`变量重新分配给更大的元素。一旦我们对列表中的每个元素执行此操作，highest 内的数字现在将是最高的数字，因此，我们会将其返回到主程序。

同样，我们可以做同样的事情来找到最小的。

```
def get_smallest_number(input_list):
    smallest = input_list[0]
    for i in input_list:
        if i < smallest:
            smallest = i
    return smallest 
```

最后，我们进入主循环。在这里，我们声明一个空列表，`number_list`用于存储所有数字。我们使用它的总和作为我们的循环条件。

```
if __name__ == '__main__':
    number_list = []
    while sum(number_list) < 179:
        number_list.append(get_input_number()) 
```

在循环体中，我们调用 get_input_number() 并将其结果附加到我们创建的列表中。一旦列表中的数字总和超过 179，while 循环将退出，我们最终可以向用户显示结果。

```
 print 
    print '-------------------------'
    print 'total of numbers entered: %d' % sum(number_list)
    print 'greatest number entered: %d' % get_greatest_number(number_list)
    print 'smallest number entered: %d' % get_smallest_number(number_list) 
```

在这里我们可以`get_greatest_number`和`get_smallest_number`我们做的，我们给他们数字列表作为参数。他们将遍历列表，然后将适当的值返回给打印语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T22:52:29.103

是的，当然有比为每个数字创建一个变量更好的方法。将它们存储在列表中。将它们存储在列表中还可以轻松找到它们的总和以及最高和最低值（为此有内置函数）。

作为进一步的提示，您将需要使用两个循环，一个在另一个循环中。外循环让用户输入数字，直到它们的总和超过 179。内循环让用户输入*单个*数字，直到它介于 1 和 42 之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T23:36:17.427

```
def get_int(prompt=''):
    while True:
        try:
            return int(raw_input(prompt))
        except ValueError:
            pass

def get_values():
    values = []
    total  = 0
    while total <= 179:
        val = get_int('Enter a positive integer <= 42: ')
        if 0 <= val <= 42:
            values.append(val)
            total += val
    return values

def print_info(values):
    print 'Sum is {}'.format(sum(values))
    print 'Largest value is {}'.format(max(values))
    print 'Smallest value is {}'.format(min(values))

def main():
    values = get_values()
    print_info(values)

if __name__=="__main__":
    main() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T09:34:54.070

感谢所有回答的人。我编写了以下代码，除了最后一个模块外，它几乎可以完美运行。如果您在第一次运行后退出程序（按 0），它将退出，但如果您第二次运行它，按 0 不会使其退出。它只会回到程序的开头。我不知道为什么。

注意：作业有各种要求，我必须将它们合并到我的代码中。因此不必要的模块、全局变量和注释。

```
maxNum = 42  # declares global variable maxNum
target = 179  # declares global variable target

def user_input():  # prompts user to input a number 42 or less until all add up to 179
    x = 0
    nums = []    
    while sum(nums) <= target:
        nums.append(int(raw_input("Enter a number: ")))
        if int(nums[x]) > int(maxNum):
            print "Number cannot exceed 42."
            user_input()
        else:
            x += 1
    print_nums(nums,x)

def print_nums(nums,x):  # prints the sum of the numbers, the smallest, and the largest 
    print "Sum of all numbers is", sum(nums)
    nums.sort()
    x -= 1
    print "Largest number entered is", nums[x]
    print "Smallest number entered is", nums[0]
    decide()

def decide():  # allows user to continue the program or exit 
    exit = raw_input("<9 to enter a new set of number.  0 to exit.> ")
    while True:
        if int(exit) == 0:
            return
        elif int(exit) == 9:
            user_input()

user_input() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T22:56:55.050

您可以在循环中重复轮询数字，并将输入添加到列表中，例如

```
def input_numbers():
    user_inputs = []  # a list of all user's inputs
    while True:
        num = raw_input("Enter a positive integer no greater than 42 ")
        try:
            num = int(num)  # convert input string to integer
            if num <= 0:
                print "That is not a positive integer.  Try again "
            elif num > 42:
                print "The number cannot exceed 42\.  Try again "
            user_inputs.append(num)
        except ValueError:  # conversion to integer may fail (e.g. int('string') ?)
            print 'Not a Number:', num

        if some_condition_regarding(user_inputs):
            break  # eventually break out of infinite while loop 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T22:57:23.547

这里有一些众所周知的技巧：

```
 def min_and_max(your_num_list)
        min=your_num_list[0]
        max=your_num_list[0]
        for num in your_num_list:
            if num < min:
                min=num
            if max > num
                max=num
        return min,max 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-23T23:05:48.963

当你编写一个独立的 Python 程序时，使用 main 函数是一个好习惯。它允许您轻松添加一些单元测试，使用来自其他模块的函数或类（如果您导入它们）等。

正如其他人已经说过的那样，每次用户输入有效数字时，创建一个列表并向其附加一个新元素是一个好主意（直到数字总和超过 179）。如果用户输入了不正确的值，则不要在列表中附加任何内容并跳到下一次迭代（因此将要求用户再次输入数字）。

所以基本上它可能看起来像这样：

```
def validate_entered_number(num):
    """
    Checks if the number is positive and is less or equal to 42.
    Returns True if the number matches these conditions,
    otherwise it returns False.
    """
    if num < 0:
        print "That is not a positive integer."
        return False

    if num > 42:
        print "The number cannot exceed 42."
        return False

    return True

def main():
    entered_numbers = []

    while True:
        try:
            num = int(raw_input("Enter a positive integer less or equal to 42: "))
        except ValueError:
            print "You should enter a number"
            continue
        if validate_entered_number(num):
            entered_numbers.append(num)
            if sum(entered_numbers) > 179:
                print "The sum of the numbers is %s" % sum(entered_numbers)
                print "The smallest number entered is %s" % min(entered_numbers)
                print "The largest number entered is %s" % max(entered_numbers)
                return

if __name__ == "__main__":
    main() 
```

事实上，我可以想象这样一种情况，您只想将数字之和、最小数字和最大数字存储在三个变量中，并在每次迭代中更新这些变量（将当前数字添加到总和中并将其与目前已知的最小和更大的数字，并在必要时更新相应的变量），但在这种情况下，您可能拥有的最长列表只有 180 个元素（如果所有数字都是 1 并且用户没有输入 0 或者您修改了程序拒绝输入 0)，这对于 Python 中的列表来说是非常少量的元素。但是，如果您必须处理大量数字，我建议您切换到这样的解决方案。

# sql - 在 SQL 中，如何找到匹配一个条件的行，从中获取一个值并将其与同一张表中的其他行匹配？

> ID：12556909
> 
> 赞同：0
> 
> 时间：2012-09-23T22:44:49.340
> 
> 标签：sql, postgresql, join

例如，如果您有一个表`books`，并且您想查找某个名称的所有书籍，那么获取这些书籍的作者并研究该`books`表以查找表中的所有条目。例如，如果您搜索标题“All About Pirates”，然后有 2 本书具有该标题，一本由“Jane Doe”撰写，另一本由“Joe Smith”撰写，则将再次在该表中搜索这些作者的所有标题。

```
select *
from books b
join books b2 on b.author = b2.author
where title = 'All About Pirates' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T22:52:10.557

使用这样的子查询：SELECT * FROM books WHERE author IN (SELECT author FROM books WHERE title='All About Pirates');

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T02:51:54.033

您的查询几乎是正确的。您需要在 where 子句中指定 title 的别名：

```
select b2.*
from books b join
     books b2
     on b.author = b2.author
where b.title = 'All About Pirates' 
```

原始查询不可解析，因为标题不明确。在此查询`b2`中是具有匹配作者的书籍列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:49:39.323

您可以将表连接到选择的结果。

例如，您会得到与这本书相匹配的作者，如下所示：

```
SELECT author FROM books WHERE title="All About Pirates" GROUP BY author; 
```

因此，您可以像这样将 books 表加入到这个作者表中：

```
SELECT books.*
FROM books
JOIN (SELECT author FROM books WHERE title="All About Pirates" GROUP BY author) AS r
ON books.author=r.author; 
```

# php - Codeigniter 未定义属性，或者我的控制器将如何停止担心并学会爱模型

> ID：12556913
> 
> 赞同：6
> 
> 时间：2012-09-23T22:44:54.160
> 
> 标签：php, oop, codeigniter

我正在关注[Codeigniter 网站上](http://codeigniter.com/user_guide/tutorial/news_section.html)关于制作新闻部分的教程。现在我在第 13 行收到一条未定义的属性消息。

这是我的模型。**应用程序/模型/articles_model**

```
<?php

class Articles_model extends CI_Model{

    public function __construct(){

        $this->load->database();
    }

    public function get_article($slug = False){

        if ($slug === FALSE){

             $query = $this->db->get('articles');
             return $query->result_array();
        }

        $query = $this->db->get('articles');
        return $query->result_array();
    }

    $query = $this->db->get_where('articles', array('slug' => $slug));
    return $query->row_array();
} 
```

这是控制器。**应用程序/控制器/articles.php**

```
<?php

class Articles extends CI_Controller{

    public function __contruct(){

        parent::__construct();
        $this->load->model('Articles_model');
    }

    public function index(){

        //Message: Undefined property Articles::Articles_model    
        $data['articles'] = $this->Articles_model->get_article();
        $data['title'] = "Archive";

        $this->load->view('templates/header', $data);
        $this->load->view('articles/index', $data);
        $this->load->view('templates/footer');
    }

    public function view($slug){

        $data['articles'] = $this->Articles_model->get_article($slug);

        if(empty($data['articles'])){

            show_404();
        }

        $data['title'] = $data['articles']['title'];

        $this->load->view('templates/header', $data);
        $this->load->view('articles/view', $data);
        $this->load->view('templates/footer');
    }
} 
```

这些是我设置的所有路线。**应用程序/config/routes.php**

```
$route['articles/(:any)'] = 'articles/view/$1';
$route['articles'] = 'articles';
$route['default_controller'] = 'pages/view';
$route['(:any)'] = 'pages/view/$1'; 
```

我的数据库看起来像这样

```
mysql> describe articles
+-------+--------------+------+-----+---------+----------------+
| Field | Type         | Null | Key | Default | Extra          |
+-------+--------------+------+-----+---------+----------------+
| id    | int(11)      | NO   | PRI | NULL    | auto_increment |
| title | varchar(128) | NO   |     | NULL    |                |
| slug  | varchar(128) | NO   | MUL | NULL    |                |
| text  | text         | NO   |     | NULL    |                |
+-------+--------------+------+-----+---------+----------------+ 
```

我尝试过使用首字母大写的属性`$this->Articles_model`，而不是，`$this->articles_model`。

我错过了什么愚蠢的东西吗？如果是这样，那是什么？
如果它不愚蠢，我该如何调试？

**编辑**

根据评论，print_r 的输出不包含“Articles_model”。第一层的事情在我头上，但 CTRL-F 不是。Apache日志也提到了这一点......

```
[Sun Sep 23 13:19:30 2012] [error] [client 127.0.0.1] PHP Fatal error:  Call to a member function get_article() on a non-object in /home/noel/dev/web/
ci/CodeIgniter_2.1.2/application/controllers/articles.php on line 13 
```

**编辑1**

我以为我修好了，但没有，请参阅我的*答案*的评论。由于某种原因`$this->article_model`不是一个对象。

为什么？我去过一个世界博览会，野餐和牛仔竞技表演，这是我听过的最愚蠢的事情。你确定你有今天的密码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T01:34:00.417

仔细一看，答案很简单：尝试更改此行：

```
public function __contruct(){ 
```

对此：

```
public function __construct(){ 
```

;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T01:12:33.757

首先，关于评论：`print_r($this);`这是一个非常糟糕的主意，因为它只会让你感到困惑。`$this`几乎不包含 ci 的东西。你正在寻找的是`print_r(get_instance());`

关于您的问题： ci 小写成员名称。将您的线路更改为此，您就可以开始了：

```
$this->articles_model->get_article(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T00:12:25.337

我发现了问题。它在 routes.php 中。这些线

```
$route['articles/(:any)'] = 'articles/view/$1';
$route['articles'] = 'articles'; 
```

我改成这个了...

```
$route['articles/(:any)'] = 'Articles/view/$1';
$route['articles'] = 'Articles'; 
```

现在我得到一个 404，因为我的数据库是空的，正如预期的那样。仍然不知道为什么这些规则...

```
$route['default_controller'] = 'pages/view';
$route['(:any)'] = 'pages/view/$1' 
```

从第一个教程开始，没有“页面”被大写。世界永远不会知道...

# vb.net - 实体框架中的 Linq

> ID：12556916
> 
> 赞同：0
> 
> 时间：2012-09-23T22:45:15.580
> 
> 标签：vb.net, linq, entity-framework

我在使用选择时遇到问题。

IDE 不喜欢 () 中选择用户 ID 的选择查询。如何在选择中完成选择？

```
Dim newctx As teckModel.teckEntities
        Dim pending = From c In newctx.my_aspnet_membership Where c.userId = (From c In newctx.my_aspnet_usersinroles Where c.roleId = 8 Select c.userId) Select c.Email, c.CreationDate, c.LastLoginDate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:52:38.183

equals 运算符假定一个值，但第二个 linq 语句返回一个 IEnumerable。您应该`.Contains()`在 IEnumerable 上使用或进一步细化子查询以仅返回单个实体。

```
var pending = from x in newctx.my_aspnet_membership where
    (from y in newctx.my_aspnet_usersinroles where y.roleId==8 select y.userId).Contains(x.userId)
    select new { x.Email, x.CreationDate, x.LastLoginDate }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T23:11:43.073

您可以执行`Contain`or`Any`或者您必须使用`FirstOrDefault`

```
Where (From c In newctx.my_aspnet_usersinroles Where c.roleId = 8 Select c.userId).Contains(c.userId) 
```

或者

```
c.userId == (From c In newctx.my_aspnet_usersinroles Where c.roleId = 8 Select c.userId).FirstOrDefault() 
```

# c - 并行下载

> ID：12556921
> 
> 赞同：1
> 
> 时间：2012-09-23T22:46:37.850
> 
> 标签：c, fork

嗨，我需要一些有关并行下载程序的帮助。

目前，它是并行下载同一个文件，而不是同时下载多个文件。

`fork`和有问题`fgets`，不知道如何修复它们。谢谢你。

```
#include <sys/wait.h>
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
FILE *file; /*declare the file pointer*/
#define LINE_MAX 1000
char line [LINE_MAX];
//Parent process
int main()
{
pid_t  pid;
file= fopen ("urls.txt", "rt"); /*open file and read it*/

if(!file)
{
    perror("fopen");
    exit(-1);
}

int numberOfChildren = 0;

while (!feof (file)) {

memset (line,'\0',1000);

char *urlPtr; 

while (!feof (file))
{
urlPtr= fgets (line,LINE_MAX, file);

if(urlPtr)
{

int lineLen = strlen(urlPtr);
urlPtr[lineLen-1] = '\0';
pid = fork();
++numberOfChildren;

    if (pid == 0) {  /* child process */
        execlp("/usr/bin/wget", "wget", urlPtr, NULL);
        }

    else if (pid < 0) { /* error occurred */
        fprintf(stderr, "Fork Failed");
        exit(-1);
        }
}
}
    while (numberOfChildren>0) { /* parent process */
    /* parent will wait for the child to complete */
        wait (NULL);
        --numberOfChildren;
        printf ("Child Complete");
        }

}   
fclose (file); /*close file command*/

return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T23:07:06.740

您在 URL 读取循环之外进行了 fork() 检查。你首先阅读了大量的 URL 并产生了很多孩子，然后进行 pid 检查。尝试

```
while (!feof (file))
{
    urlPtr= fgets (line,LINE_MAX, file);
    pid = fork();
    if (pid == 0) {  /* child process */
         execlp("/usr/bin/wget", "wget", urlPtr, NULL);
    }
    else if (pid < 0) { /* error occurred */
        fprintf(stderr, "Fork Failed");
        exit(-1);
    }
    ++numberOfChildren;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T01:26:41.820

您应该在 之后放置诊断打印并退出`execlp()`（但在 之后的子代码中`if`）。您可能还应该在执行之前关闭输入文件`wget`；该程序不需要它打开。这次没有造成太大的伤害，但保持整洁是件好事。您的父母可能不应该仅仅因为一个孩子失败而退出`fork()`；一般来说，您还有其他孩子，您应该等待。不过，您可能会在此时停止处理该文件。你绝对应该忘记`feof()`; 使用`while (fgets(line, sizeof(line), file) != 0)`，尽管这意味着您不需要`urlPtr`. `memset()`是多余的；`fgets()`正确初始化字符串。

### 修改有问题的代码

```
#include <sys/wait.h>
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

FILE *file; /*declare the file pointer*/
#define LINE_MAX 1000
char line [LINE_MAX];

//Parent process
int main(void)
{
    pid_t  pid;
    file = fopen("urls.txt", "rt"); /*open file and read it*/

    if (!file)
    {
        perror("fopen");
        exit(-1);
    }
    int numberOfChildren = 0;
    memset(line,'\0',1000);
    char *urlPtr; 

    while (!feof(file))
    {
        urlPtr= fgets(line, sizeof(line), file);
        if (urlPtr)
        {
            int lineLen = strlen(urlPtr);
            urlPtr[lineLen-1] = '\0';
            pid = fork();

            ++numberOfChildren;

            if (pid == 0)
            {   /* child process */
                execlp("/usr/bin/wget", "wget", urlPtr, NULL);
                fprintf(stderr, "%d: wget failed\n", (int)getpid());
                exit(1);
            }
            else if (pid < 0)
            {   /* error occurred */
                fprintf(stderr, "Fork Failed\n");
                exit(-1);
            }
            else
                printf("%d: %s\n", (int)pid, urlPtr);
        }
    }

    /* JL: Moved block of code */
    while (numberOfChildren>0)
    {   /* parent process */
        /* parent will wait for the child to complete */
        int status;
        int corpse = wait(&status);
        --numberOfChildren;
        printf("Child %d Complete (0x%04X)\n", corpse, status);
    }

    fclose(file); /*close file command*/

    return 0;
} 
```

请注意，一个`while (!feof(file))`循环已被删除，但还有更多不必要的代码可以去。给定数据文件

```
ftp://ftp.iana.org/tz/releases/tzcode2012f.tar.gz
ftp://ftp.iana.org/tz/releases/tzdata2012f.tar.gz 
```

上面的代码可以并行获取两个文件。

### 替代代码

我喜欢使用函数，即使是相对较短的一段只使用过一次的代码。因此在`be_childish()`下面添加了功能。写出错误报告有点乏味，但这不是不这样做的借口。

我简要介绍了一个基于我自己的精心制作的库进行错误报告的最小函数，但它只会在此代码中使用两次（用于文件打开错误和`execlp()`返回后，总是无条件地指示失败），但决定把它排除在外。我有诸如 、 和 之类的函数 `err_setarg0()`，使用`err_error()`这些函数会将每个错误报告减少到一行（以及一些更复杂的函数，可以被告知自动包含 PID 等）。对我来说，拥有这样一个库是值得的，因为它使错误检查变得更加简单，因此痛苦更少并且不太可能被忽略。`err_remark()``err_usage()`

```
#include <sys/wait.h>
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

static void be_childish(const char *urlPtr)
{
    const char *wget = "/usr/bin/wget";
    char *nl = strchr(urlPtr, '\n');
    if (nl != 0)
        *nl = '\0';
    printf("%d: %s\n", (int)getpid(), urlPtr);
    execlp(wget, "wget", urlPtr, NULL);
    fprintf(stderr, "%d: Failed to execute %s\n", (int)getpid(), wget);
    exit(EXIT_FAILURE);
}

int main(int argc, char **argv)
{
    FILE *file;
    char line [1024];
    pid_t  pid;
    const char *name = "urls.txt";
    int rc = EXIT_SUCCESS;

    if (argc == 2)
        name = argv[1];
    else if (argc > 2)
    {
        fprintf(stderr, "Usage: %s [filename]\n", argv[0]);
        exit(EXIT_FAILURE);
    }
    file = fopen(name, "rt");   /* Undefined behaviour per POSIX */
    int numberOfChildren = 0;

    if (file == 0)
    {
        fprintf(stderr, "Failed to open file %s\n", name);
        exit(EXIT_FAILURE);
    }

    while (fgets(line, sizeof(line), file) != 0)
    {
        if ((pid = fork()) == 0)
        {
            fclose(file);
            be_childish(line);
        }
        else if (pid < 0)
        {
            fprintf(stderr, "Fork Failed");
            rc = EXIT_FAILURE;
            break;
        }
        ++numberOfChildren;
    }
    fclose(file);

    /* Parent waits for the children to complete */
    while (numberOfChildren > 0)
    {
        int status;
        const char *result = "OK";
        pid = wait(&status);
        --numberOfChildren;
        if (status != 0)
        {
            result = "Failed";
            rc = EXIT_FAILURE;
        }
        printf("Child %d %s\n", pid, result);
    }

    return rc;
} 
```

请注意，代码在命令行上采用文件名，默认为您的“urls.txt”。`"rt"`开放模式不是 POSIX 或标准 C 模式；它可能会起作用，但`"r"`足以在所有系统上打开文本文件（`"rb"`打开二进制文件也适用于所有系统，并且符合 POSIX 和标准 C）。它报告哪个子进程正在处理列出的每个文件。它报告每个孩子的状态（成功或失败）；只有当所有孩子都成功时，它自己的退出状态才是成功。

您可能可以从命令行控制详细程度。您可能还希望记录哪个孩子正在处理每个文件，以便您可以报告成功下载的文件，而不是用户真正不关心的进程。这使处理变得复杂，因为您需要在阅读每个 URL 时对其进行复制。

请注意，在将字符串 (URL) 传递给`wget`.

* * *

这段代码现在经过测试（在添加换行修正之后），它产生了两个文件。屏幕显示有点乱；那是因为每个副本都`wget`认为它是唯一的用户：

```
80334: ftp://ftp.iana.org/tz/releases/tzcode2012f.tar.gz
80335: ftp://ftp.iana.org/tz/releases/tzdata2012f.tar.gz
--2012-09-23 19:19:44--  ftp://ftp.iana.org/tz/releases/tzcode2012f.tar.gz
           => “tzcode2012f.tar.gz”
Resolving ftp.iana.org... --2012-09-23 19:19:44--  ftp://ftp.iana.org/tz/releases/tzdata2012f.tar.gz
           => “tzdata2012f.tar.gz”
Resolving ftp.iana.org... 192.0.32.8192.0.32.8, , 2620:0:2d0:200::82620:0:2d0:200::8

Connecting to ftp.iana.org|192.0.32.8|:21... Connecting to ftp.iana.org|192.0.32.8|:21... connected.
Logging in as anonymous ... connected.
Logging in as anonymous ... Logged in!
==> SYST ... Logged in!
==> SYST ... done.    ==> PWD ... done.    ==> PWD ... done.
==> TYPE I ... done.
==> TYPE I ... done.  ==> CWD (1) /tz/releases ... done.  ==> CWD (1) /tz/releases ... done.
==> SIZE tzdata2012f.tar.gz ... done.
==> SIZE tzcode2012f.tar.gz ... 206404
==> PASV ... 135543
==> PASV ... done.    ==> RETR tzdata2012f.tar.gz ... done.    ==> RETR tzcode2012f.tar.gz ... done.
Length: 206404 (202K) (unauthoritative)

 0% [                                                                               ] 0           --.-K/s              done.
Length: 135543 (132K) (unauthoritative)

100%[==============================================================================>] 135,543     72.7K/s   in 1.8s    

100%[==============================================================================>] 206,404     81.4K/s   in 2.5s    

2012-09-23 19:19:48 (72.7 KB/s) - “tzcode2012f.tar.gz” saved [135543]

Child 80334 OK
2012-09-23 19:19:48 (81.4 KB/s) - “tzdata2012f.tar.gz” saved [206404]

Child 80335 OK 
```

# c# - WinRT 创建动画 GIF

> ID：12556929
> 
> 赞同：1
> 
> 时间：2012-09-23T22:47:28.620
> 
> 标签：c#, image-processing, windows-runtime

我正在努力在 WinRT 应用程序中创建一些动画 GIF。我已经在生成的图像中使用多个帧进行 gif 转换，但我无法弄清楚如何设置帧延迟和重复行为等内容。

GoToNextFrameAsync 接受的选项感觉像是指定此类内容的正确位置，但我不知道要传递什么，也找不到有关该主题的任何文档。

```
 public async static void AnimateImages(IEnumerable<StorageFile> files)
    {
        var outFile = await KnownFolders.PicturesLibrary.CreateFileAsync("test.gif", CreationCollisionOption.ReplaceExisting);
        var outStream = await outFile.OpenAsync(FileAccessMode.ReadWrite);

        var encoder = await BitmapEncoder.CreateAsync(BitmapEncoder.GifEncoderId, outStream);

        for (int i = 0; i < files.Count(); i++)
        {
            using (var str = await files.ElementAt(i).OpenAsync(FileAccessMode.Read))
            {
                var decoder = await BitmapDecoder.CreateAsync(str);
                var pixels = await decoder.GetPixelDataAsync();

                encoder.SetPixelData(decoder.BitmapPixelFormat, BitmapAlphaMode.Ignore,
                    decoder.OrientedPixelWidth, decoder.OrientedPixelHeight,
                    decoder.DpiX, decoder.DpiY,
                    pixels.DetachPixelData());

                if(i < files.Count() -1 )
                    await encoder.GoToNextFrameAsync();
            }
        }

        await encoder.FlushAsync();
        outStream.Dispose();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:43:12.530

我也遇到了这个问题。似乎虽然可以读取属性，但在框架上设置任何类型的属性都会导致异常。据我所知，[BitmapEncoders](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/63e0f635-7e5a-4eb7-87e7-76ae96d692f5)与 Windows Imaging Components 有关，并且正如[MSDN 上的 Native WIC Codecs](http://msdn.microsoft.com/en-us/library/windows/desktop/gg430027%28v=vs.85%29.aspx)页面 所述，没有 GIF 选项。不过看起来确实很奇怪。

# ios - 修改iOS中代码创建的标签文本

> ID：12556934
> 
> 赞同：0
> 
> 时间：2012-09-23T22:48:11.557
> 
> 标签：ios, label, iboutlet

如果我以编程方式创建标签，那么我如何创建出口来访问他的文本属性？谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T23:28:41.987

你不创建一个出口——那只是为了在 IB 中连接东西。相反，您创建一个属性，并使用它来引用您的标签。因此，在您创建标签的 .h 文件中，有如下内容：

```
@property (strong, nonatomic) UILabel *myLabel; 
```

创建标签时：

```
self.myLabel = [UILabel alloc] init ..... 
```

然后当你需要获取 text 属性时：

```
self.myLabel.text = @"New Text"; 
```

# javascript - JavaScript / Google v8 的持久性框架

> ID：12556935
> 
> 赞同：2
> 
> 时间：2012-09-23T22:48:20.143
> 
> 标签：javascript, persistence, v8, object-persistence

是否有任何类型的 JavaScript 和/或 Google v8 引擎的持久性框架？

我想存储（序列化）整个对象图（包括例如函数）并稍后重新加载它。JSON 是不够的，因为它不允许存储函数并且只允许树状结构（即没有两个对象引用同一个对象）。

我需要能够做到这一点（即在我编写嵌入 v8 的程序时不知道 JavaScript 代码），因为我希望我的程序的用户能够使用 JavaScript 自定义它，但我需要存储我的程序的状态（包括自定义的状态）并稍后重新加载。因此我需要存储 JavaScript 引擎的状态。

**编辑：**

例子：

假设我们有以下代码：

```
var obj = { a: 4, b: function (x) { return x + this.a; } }
// ...
if ( ... ) { obj.a = 5; }
// ...
if ( ... ) { var c = 1; obj.b = function (x) { return x + this.a + c; } }
// ...
// now I want to serialize obj 
```

那么（没有关于程序逻辑的任何元信息）是否可以序列化`obj`并稍后反序列化它，以便`obj.b (2)`在反序列化之后提供与序列化之前相同的结果？

**第二次编辑：**注意关闭。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T17:28:33.543

不幸的是，您现在尝试做的事情在 Javascript 中是不可能的。原因是闭包不仅仅是对象，它们是绑定到执行上下文的对象。

超越“这不能在 javascript 中完成”问题并进入答案的“如果为 V8 编写一个补丁以允许这个”阶段，这在概念上是困难的。本质上，对于您要序列化的每个闭包，您都必须序列化`Context`该闭包所在的对象。能够仅序列化 就好了`HandleScope`，但闭包的本质是您无法进入它们内部.

好的，假设您编写了一个函数，可以序列化存在闭包的 Context，甚至可以反序列化它。你用它做什么？

答案是“不多”。Javascript 一次只能在一个上下文中执行。您反序列化的闭包在您试图将其拉回的上下文中不存在。你不能真正在上下文之间传递数据，如果你的函数有数据绑定到自由变量，你是使用反序列化器调用上下文中存在的数据，还是用反序列化上下文覆盖它？从概念上讲，这是一场噩梦。

Ecmascript Harmony 曾考虑为我们提供近乎一流的延续，但它已从我在[这里](http://www.samlecuyer.com/2012/09/what-ecmascript-needs/)咆哮的讨论中推开，但这不会很快发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T10:07:18.997

我不认为持久化函数是一个好习惯。我可以建议你下面的方法。将您的 JSON 数据转换为诸如“MyData”之类的类。你可以从 JSON 中找到两个函数，toJSON 可以实现你想要的魔法。

```
var MyData = function(props){

    this.temp = "a";

    this.getTemp = function(){
        return this.temp;
    }

    this.fromJSON = function(props){
        if(props){
            this.temp = props.temp;
        }

    }
    this.toJSON = function(){
        var props = {};
        props.temp = this.temp;
        return props;
    }

    this.fromJSON(props);

}

var obj = new MyData({"temp" : "b"});
var state = obj.toJSON();
// persist state about the object as JSON string
LOCALSTORAGE.put(state); // You can write some HTML5 local storage stuff to persist

var persistedState = LOCALSTORAGE.get(); // You can use the above HTML5 local storage stuff to read the persisted stuff
var newBornObj = new MyData(persistedState); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T07:31:26.840

HTML5 本地存储允许通过 javascript 在客户端级别进行持久性。

我不确定它是否符合您的需求，至于能够存储一个功能，您需要在某种程度上给它一些标记，以便您在从存储中检索它时反序列化它（或者可能只是将它存储为纯文本并尝试在检索时对其进行评估）

[http://diveintohtml5.info/storage.html](http://diveintohtml5.info/storage.html)

# .net - 大约 2012/2013 年的 .NET（特别是 VB）中的游戏开发和性能与 C++

> ID：12556939
> 
> 赞同：4
> 
> 时间：2012-09-23T22:48:52.943
> 
> 标签：.net, vb.net, game-engine

因此，随着微软新版本的 Visual Studios 最近发布，它们似乎增加了一些性能提升。硬件的功能也在增加，我很好奇：

用 VB .NET 开发的游戏会运行得足够快，以至于用户不会注意到 C++ 开发的游戏之间的区别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:50:58.953

取决于游戏类型；例如，在一个简单的 2D 棋盘游戏中，渲染和计算并不复杂，用户不太可能看到任何差异。如果游戏需要实时渲染响应式 3D 图形，总会有区别的。或者对于复杂的人工智能（例如国际象棋）——大量数据肯定会减慢 VB 程序的速度，因为垃圾收集内存。不过，在您实际测量之前，您永远不会知道。

我最近读了一篇关于托管语言性能的文章，以及 JIT 有时如何比提前编译器优化更好，但我忘记了它在哪里。我想它可以用谷歌搜索；您可能想看一下它以及一般的 JIT 优化（请记住，VB 和 C# 都编译为 IL，然后对其进行解释）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T23:04:37.520

我一直在用 C# 开发第一人称射击游戏，使用[OpenTK](http://www.opentk.com/)进行 OpenGL/OpenAL 绑定，到目前为止进展顺利。有一些潜在的陷阱，JITted IL 和 C++ 之间总会有一些可测量的速度差异，但如果你小心，你可以将这种差异最小化到最终用户不会注意到的程度。

将尽可能多的工作卸载到 GPU 上。如果你不小心，顶点处理 CPU 端会降低你的帧率，尤其是动画和粒子效果。在 GPU 上工作的速度与 C++ 游戏相同（尽管方法调用可能会使它有点贵，所以尝试使用 VBO/VAO/等）

定期分析您的游戏。检查每帧分配了多少对象并尝试减少分配的数量，理想情况下，将所有分配偏移到初始化。此外，不要害怕在`unsafe`阻碍游戏的紧密数学循环中使用块。使用对象池来帮助您在运行游戏时减少分配。

如果您需要 3d 物理，我发现[Jitter Physics Engine](http://jitter-physics.com/wordpress/)非常擅长在运行时不生成大量垃圾，并且在必要时使用对象池。

# c++ - 模运算符如何工作？

> ID：12556946
> 
> 赞同：36
> 
> 时间：2012-09-23T22:50:34.427
> 
> 标签：c++, modulus

假设我需要格式化数组的输出以每行显示固定数量的元素。我该如何使用模数运算来做到这一点？

使用 C++，下面的代码适用于每行显示 6 个元素，但我不知道它是如何工作的以及为什么工作？

```
for ( count = 0 ; count < size ; count++)
{
    cout << somearray[count];
    if( count % 6 == 5) cout << endl;
} 
```

如果我想每行显示 5 个元素怎么办？我如何找到所需的确切表达式？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-09-23T22:58:31.267

在 C++ 中，表达式`a % b`返回 a 除以 b 的余数（如果它们是正数。对于负数，结果的符号由实现定义）。例如：

```
5 % 2 = 1
13 % 5 = 3 
```

有了这些知识，我们可以尝试理解您的代码。条件`count % 6 == 5`意味着当除以 6 的余数为 5 时将写入换行符。这种情况多久发生一次？正好相隔 6 行（练习：写下数字 1..30 并在满足此条件的数字下划线），从第 6 行开始（计数 = 5）。

要从您的代码中获得所需的行为，您应该将条件更改为`count % 5 == 4`，从第 5 行（计数 = 4）开始每 5 行换行一次。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-10-10T10:11:23.537

基本上，模数运算符为您提供简单的余数数学示例 11 除以 3 的余数/余数是多少？答案是 2

对于同样的事情 C++ 有 **模运算符 ('%')**

基本解释代码

```
#include <iostream>
using namespace std;

int main()
{
    int num = 11;
    cout << "remainder is " << (num % 3) << endl;

    return 0;
} 
```

哪个会显示

> 余数为 2

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T22:52:54.517

它为您提供除法的其余部分。

```
int c=11, d=5;
cout << (c/d) * d + c % d; // gives you the value of c 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-07-18T07:55:55.693

这个 JSFiddle 项目可以帮助您了解模数的工作原理：http: [//jsfiddle.net/elazar170/7hhnagrj](http://jsfiddle.net/elazar170/7hhnagrj)

模数函数的工作原理如下：

```
 function modulus(x,y){
       var m = Math.floor(x / y);
       var r = m * y;
       return x - r;
     } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-23T22:56:27.447

您可以将模运算符视为给您一个余数。count % 6 尽可能多地将 6 除以 count 并给出从 0 到 5 的余数（这些都是可能的余数，因为您已经尽可能多地除以 6）。数组的元素都在for循环中打印出来，但是每次余数为5（每第6个元素），就输出一个换行符。这为您提供每行 6 个元素。对于每行 5 个元素，使用

> 如果（计数 % 5 == 4）

# javascript - 强制 Google Maps API 仅使用 Lat/Long 值 - 修改预制 JS

> ID：12556950
> 
> 赞同：3
> 
> 时间：2012-09-23T22:51:35.163
> 
> 标签：javascript, api, google-maps

我正在为房地产网站使用 Wordpress 主题，该主题具有以下功能：添加列表时，主题将使用列表标题（街道地址）以及“城市”和“州”标签，以设置列表地图引脚。它也可以默认为 lat/long（您可以在创建新列表时手动添加它）

由于想要对列表使用描述性标题 - 而不是街道地址 - 我希望地图仅根据纬度/经度放置图钉。当我使用描述性标题时，列表地图不会加载 - 因此地图在未能对描述性标题进行地理编码后不会默认为纬度/经度。

映射代码如下（我不是专家，所以尝试了很多更改，所有这些都破坏了映射功能！）

```
var estateMapping = (function () {
var self = {},
    marker_list = [],
    open_info_window = null,
    x_center_offset = 0, // x,y offset in px when map gets built with marker bounds
    y_center_offset = -100,
    x_info_offset = 0, // x,y offset in px when map pans to marker -- to accomodate infoBubble
    y_info_offset = -100;

function build_marker(latlng, property) {
    var marker = new MarkerWithLabel({
        map: self.map, 
        draggable: false,
        flat: true,
        labelContent: property.price,
        labelAnchor: new google.maps.Point(22, 0),
        labelClass: "label", // the CSS class for the label
        labelStyle: {opacity: 1},
        icon: 'wp-content/themes/realestate_3/images/blank.png',   
        position: latlng
        });

        self.bounds.extend(latlng);
        self.map.fitBounds(self.bounds);
        self.map.setCenter(convert_offset(self.bounds.getCenter(), x_center_offset, y_center_offset));

        var infoBubble = new InfoBubble({
            maxWidth: 275,
            content: contentString,
            borderRadius: 3,
            disableAutoPan: true
        });

        var residentialString = '';
        if(property['commercial'] != 'commercial') {
            var residentialString='<p class="details">'+property.bed+' br, '+property.bath+' ba';
        }

        var contentString =
        '<div class="info-content">'+
        '<a href="'+property.permalink+'"><img class="left" src="'+property.thumb+'" /></a>'+
        '<div class="listing-details left">'+
        '<h3><a href="'+property.permalink+'">'+property.street+'</a></h3>'+
        '<p class="location">'+property.city+', '+property.state+'&nbsp;'+property.zip+'</p>'+
        '<p class="price"><strong>'+property.fullPrice+'</strong></p>'+residentialString+', '+property.size+'</p></div>'+
        '</div>';

        var tabContent =
        '<div class="info-content">'+
        '<img class="left" src="'+property.agentThumb+'" />'+
        '<div class="listing-details left">'+
        '<h3>'+property.agentName+'</h3>'+
        '<p class="tagline">'+property.agentTagline+'</p>'+
        '<p class="phone"><strong>Tel:</strong> '+property.agentPhone+'</p>'+
        '<p class="email"><a href="mailto:'+property.agentEmail+'">'+property.agentEmail+'</a></p>'+
        '</div>'+
        '</div>';

        infoBubble.addTab('Details', contentString);
        infoBubble.addTab('Contact Agent', tabContent);

        google.maps.event.addListener(marker, 'click', function() {
            if(open_info_window) open_info_window.close();

            if (!infoBubble.isOpen()) {
                infoBubble.open(self.map, marker);
                self.map.panTo(convert_offset(this.position, x_info_offset, y_info_offset));
                open_info_window = infoBubble;
            }
        });
}

function geocode_and_place_marker(property) {
   var geocoder = new google.maps.Geocoder();
   var address = property.street+', '+property.city+' '+property.state+', '+property.zip;

       //If latlong exists build the marker, otherwise geocode then build the marker
       if (property['latlong']) {
           var lat = parseFloat(property['latlong'].split(',')[0]),
                lng = parseFloat(property['latlong'].split(',')[1]);
            var latlng = new google.maps.LatLng(lat,lng);
            build_marker(latlng, property);

       } else {
           geocoder.geocode({ address : address }, function( results, status ) {
               if(status == google.maps.GeocoderStatus.OK) {
                    var latlng = results[0].geometry.location;
                    build_marker(latlng, property);
                }
            });
        }
}

function init_canvas_projection() {
    function CanvasProjectionOverlay() {}
    CanvasProjectionOverlay.prototype = new google.maps.OverlayView();
    CanvasProjectionOverlay.prototype.constructor = CanvasProjectionOverlay;
    CanvasProjectionOverlay.prototype.onAdd = function(){};
    CanvasProjectionOverlay.prototype.draw = function(){};
    CanvasProjectionOverlay.prototype.onRemove = function(){};

    self.canvasProjectionOverlay = new CanvasProjectionOverlay();
    self.canvasProjectionOverlay.setMap(self.map);
}

function convert_offset(latlng, x_offset, y_offset) {
    var proj = self.canvasProjectionOverlay.getProjection();
    var point = proj.fromLatLngToContainerPixel(latlng);
    point.x = point.x + x_offset;
    point.y = point.y + y_offset;
    return proj.fromContainerPixelToLatLng(point);
}

self.init_property_map = function (properties, defaultmapcenter) {
    var options = {
        zoom: 1,
        center: new google.maps.LatLng(defaultmapcenter.mapcenter),
        mapTypeId: google.maps.MapTypeId.ROADMAP, 
        disableDefaultUI: true,
        streetViewControl: false
    };

    self.map = new google.maps.Map( document.getElementById( 'map' ), options );
    self.bounds = new google.maps.LatLngBounds();
    init_canvas_projection();

    //wait for idle to give time to grab the projection (for calculating offset)
    var idle_listener = google.maps.event.addListener(self.map, 'idle', function() {
        for (i=0;i<properties.length;i++) {
            geocode_and_place_marker(properties[i]);
        }
        google.maps.event.removeListener(idle_listener);
    });

}

return self; 
```

}());

值得注意的是，上面的代码也适用于在主页地图上放置多个列表标记的函数。最好我希望地图总是从手动添加的纬度/经度（甚至是主页）中填充，但如果不破坏地图，我就无法实现它......

任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T04:47:08.463

如果您使用一些解释您找到的解决方案的代码发布您的问题的答案，以更充分地帮助其他有类似问题的人，那就太好了。我想我会分享我最近解决类似问题的方法。

我没有使用帖子标题来存储地址，而是在这些帖子上创建了一个自定义元框，请求街道地址、城市名称和州。我通过使用 Google Maps Geocode API 查找纬度和经度的函数连接到 save_post 操作：

```
$base_url = "http://maps.googleapis.com/maps/api/geocode/json?";
$address=urlencode($_POST['address']); // address was the name of the field in the meta box
$request_url = $base_url . "&address=" . urlencode($address).'&sensor=false';
$query = lookup($request_url); 
$results=json_decode($query, true);
$lat = $results["results"][0]["geometry"]["location"]["lat"];
$lng = $results["results"][0]["geometry"]["location"]["lng"];
    //now that we have the latitude and longitude, we can save them as post meta
update_post_meta($postid, 'lat', $lat);
update_post_meta($postid, 'long', $lng); 
```

请注意，这使用了一个名为 geocode 的函数来实际检索纬度和经度值。我找不到我最初学习如何制作这个函数的教程，但这里有一个（函数被称为'lookup'）：//lookup 是一个使用 curl 发送地理编码请求的函数，你可以找到这里有一个例子：[http ://www.andrew-kirkpatrick.com/2011/10/google-geocoding-api-with-php/](http://www.andrew-kirkpatrick.com/2011/10/google-geocoding-api-with-php/)

然后，在显示地图时，您可以在 javascript 中创建新的纬度和经度时检索这些值：

```
var latlng = new google.maps.LatLng(<?php get_post_meta($postid, 'lat'); ?>,<?php get_post_meta($postid, 'long'); ?>) 
```

# php - 如何根据条件进行更新或删除查询？

> ID：12556961
> 
> 赞同：0
> 
> 时间：2012-09-23T22:53:03.677
> 
> 标签：php, mysql, mysqli

因此，当用户在我的网站上在线时，如果他们处于非活动状态超过 15 分钟，我想将他们的状态设置为空闲，由我的数据库中“在线”表中的一列表示，如果他们处于非活动状态超过 30 分钟，我想要完全删除行而不是更新列。

有没有办法在一个查询中做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:49:35.247

在一个查询中执行此操作的唯一方法是在表上设置一个触发器，以便在更新时删除任何超过非活动删除阈值（30 分钟）的行。

但是，最终这只是两个查询 - 只是数据库在您执行一个之后执行一个。

不要害怕多个查询，它们非常快！

# android - 主菜单使用 GridView 占据整个屏幕

> ID：12556962
> 
> 赞同：0
> 
> 时间：2012-09-23T22:53:07.217
> 
> 标签：android, android-layout, android-gridview

我希望我的主菜单是图标的 GridView - 具体来说是 6 个图标。

当手机处于纵向布局时，我希望它们处于 2 列中，当它处于水平布局时 - 3 列 --- 已经将其排序。

我没有理清的是如何使它们仅占据整个屏幕。

适合屏幕宽度不是问题 -**适合屏幕高度让我绊倒**。

我希望它根据屏幕尺寸拉伸/缩小我的单元格。我曾尝试计算屏幕高度并将其除以 3 - 但存在某些问题，我认为这不是最优雅的解决方案。

所以基本上我如何用两列（3行）的gridview占据我的屏幕（比如纵向布局）？是否有任何 xml 属性可以帮助我？

这是我的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<GridView xmlns:android="http://schemas.android.com/apk/res/android" 
    android:id="@+id/gridview"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:verticalSpacing="10dp"
    android:horizontalSpacing="10dp"
    android:numColumns="auto_fit"
    android:stretchMode="columnWidth"    
    android:gravity="center"
/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:03:53.467

我建议首先在 xml 中创建两个布局，然后在该`onCreate`方法中您可以重新调整行和列的大小。

例如

```
if layout is portrait
    set column width = screen width / 2

else if layout is landscape
    set column width = screen width / 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T18:29:36.327

[Android Dashboard Pattern](https://stackoverflow.com/questions/2873568/android-dashboard-pattern)我的问题的答案就在那里。基本上我使用了嵌套`ListView`的 s

# sockets - 发送函数“SERVER/CLIENT”中的第一个参数

> ID：12556964
> 
> 赞同：0
> 
> 时间：2012-09-23T22:53:57.403
> 
> 标签：sockets

我正在编写一个 CLIENT/SERVER 程序，但客户端部分有问题。在客户端部分，我首先从服务器接收消息，但是当我想向服务器发送消息时，我遇到了一个问题 - 如何获取可以用作发送函数中的第一个参数的服务器套接字？

```
Function: int connect (int socket, struct sockaddr *addr, socklen_t length) 
```

这是客户端代码的一部分：

```
#if defined (WIN32)
#include <winsock2.h>
typedef int socklen_t;
#elif defined (linux)
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>
#define INVALID_SOCKET -1
#define SOCKET_ERROR -1
#define closesocket(s) close(s)
typedef int SOCKET;
typedef struct sockaddr_in SOCKADDR_IN;
typedef struct sockaddr SOCKADDR;
#endif

#include <stdio.h>
#include <stdlib.h>
#define PORT 23

int main(void)
{

#if defined (WIN32)
    WSADATA WSAData;
    int erreur = WSAStartup(MAKEWORD(2,2), &WSAData);
#else
    int erreur = 0;
#endif

SOCKET csock;
SOCKADDR_IN sin;
char buffer[32] = "";

if(!erreur)
{
    csock = socket(AF_INET, SOCK_STREAM, 0); 

    sin.sin_addr.s_addr = inet_addr("127.0.0.1");
    sin.sin_family = AF_INET;
    sin.sin_port = htons(PORT);

    if(connect(csock, (SOCKADDR*)&sin, sizeof(sin)) != SOCKET_ERROR)
    {

     // 
        if(recv(csock, buffer, 32, 0) != SOCKET_ERROR) 
            printf("Recu : %s\n", buffer);

         char buffer1[32] = "how are you  !";
         send( ?sock?, buffer1, 32, 0);  // here is my problem , so what is the first parameter(?sock?) in the "send" function that i need to send message to the server ?

.......
......
..... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:58:22.000

你已经有了它：它是你的**csock**变量。TCP 连接是双向建立的。当您连接到服务器时，您的**csock**获得了价值：您可以使用它来发送和接收数据。

# android - 从安卓用户那里获取崩溃日志、调试信息？

> ID：12556968
> 
> 赞同：2
> 
> 时间：2012-09-23T22:55:26.013
> 
> 标签：android, crash-reports

这是我的第一个安卓应用。

与板载传感器的采样率等硬件功能密切相关的代码。在大多数设备上，该应用程序都可以工作，在某些设备上，我可以捕捉到错误并显示一条消息，指出设备不兼容，但在某些设备上（可能是手机制造商的故障或驱动程序故障），设备只是崩溃了。我需要知道崩溃发生在哪里以及哪些设备。

是否存在使我能够从我在市场上发布的 Android 应用程序收集调试信息和崩溃日志的服务。例如，每次用户的应用程序崩溃时都会发送统计信息的东西会出现类似 Windows 错误报告的界面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T23:11:32.443

使用阿克拉。它会将您的详细日志发送到您的 google 文档

[http://code.google.com/p/acra/](http://code.google.com/p/acra/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T23:11:00.677

查看[https://www.crittercism.com](https://www.crittercism.com)，我们使用它，它运行良好。

还有一个开源项目：[http ://code.google.com/p/acra/](http://code.google.com/p/acra/)

# r - Ubuntu 上的 JRI 致命错误

> ID：12556969
> 
> 赞同：2
> 
> 时间：2012-09-23T22:55:44.653
> 
> 标签：r, ubuntu, netbeans, jri, rjava

我已经在 Windows 7 上成功安装了 JRI 和 rJava。我现在正试图让它在 64 位操作系统的 Ubuntu 上工作。我可以在 R 中进行 rJava 调用，但让 JRI 工作更加困难。我正在运行 NetBeans 7.1.2，并且在设置`R_HOME`和`java.library.path`启用要加载的所有类方面遵循了各种技巧。也就是说，我已经过去了诸如`"jri library not found"`和之类的错误消息`"R_HOME not set"`。

从我的java代码中，我可以看到`R_HOME = /usr/lib64/R`。

我现在得到的错误信息是

> 致命错误：您必须指定“--save”、“--no-save”或“--vanilla”

`Rengine`首次调用时会发生这种情况：

> Rengine r = new Rengine(args,false,null);

这似乎是来自 R 的错误消息；它似乎期待一个命令行参数。我没有看到任何带有此错误消息的帖子。有任何想法吗？谢谢，彼得

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T07:48:42.857

在此设置中使用 R 需要您在非交互模式下运行 R。要解决此问题，您需要选择错误消息中给出的选项。我会`--no-save`先试试。这可以防止 R 在运行结束时保存工作区。在 Java 代码中：

```
String args[] = {"--no-save"};
Rengine re = new Rengine(args, false, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T15:36:22.400

我会为任何试图复制这些步骤的人发布我的代码。代码是从多个网络资源拼凑而成的。对发生的重新格式化感到抱歉：我不知道如何将其显示为纯文本。

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package testjri;

/**
 *
 * @author root
 */
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Image;
import java.io.File;
import java.io.IOException;
import java.lang.reflect.Field;
import java.util.Arrays;
import javax.imageio.ImageIO;
import javax.swing.JFrame;
import javax.swing.JPanel;
import org.rosuda.JRI.Rengine;
import org.rosuda.JRI.*;
import org.rosuda.REngine.*;

public class TestJRI {

    /**
     * @param args the command line arguments
     */
public static void main(String[] args) throws IOException
{//in the folder /etc/ld.so.conf.d I created a file called libR.conf with the single line "/usr/lib64/R/lib/"  in it (without the quotes).
    //In the same folder I created a file called rJava.conf with the single line "/usr/lib/jvm/java-6-openjdk/jre/lib/amd64/server/" in it (without the quotes).
    //I then ran ldconfig to force these changes.

    //To get R_HOME set, I had to modify netbeans.conf adding the line "export R_HOME=/usr/lib64/R" 

    System.out.println("R_HOME: "+System.getenv("R_HOME"));
    try{//This next line is a trick to force a change to java.library.path at runtime
        addLibraryPath("/usr/lib64/R/site-library/rJava/jri/");
        // I copied libR.so to the jri folder so I am not sure if the next line does  anything
        addLibraryPath("/usr/lib64/R/lib/");
    }catch(Exception e){System.out.println(e.toString());}
    System.out.println("java.library.path: "+java.lang.System.getProperty("java.library.path"));
//Set some labels for the plot
String title = "R Plot in JFrame";
String xlab = "X Label";
String ylab = "Y Label";
//Start R
String newargs[] = {"--no-save"};

Rengine r = new Rengine(newargs, false, null);
//Do some calcs and plot the chart but save as a png in the working folder
r.eval("a<-c(1,2,3,4,5,6,7,8,9,10)");
r.eval("b<-c(1,3,2,4,5,6,7,8,9,10)");
r.eval("png(file=\"graph2.png\",width=1600,height=1600,res=400)");
r.eval("plot(a,b,type='o',col=\"Blue\",main=\"" + title + "\",xlab=\""
 + xlab + "\",ylab=\"" + ylab + "\")");
r.eval("dev.off()");
//It took me a search to find where R stuck the image. I found it in /proc/29285/cwd.
//I will have to learn how to control the working folder for R from java.
//get the image and create a new imagepanel
File file = new File("/proc/29285/cwd/graph2.png");
Image image = ImageIO.read(file);
imagePanel myPanel = new imagePanel(image);
//Create a new frame and add the imagepanel
JFrame aFrame = new JFrame();
aFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
aFrame.getContentPane().add(myPanel, BorderLayout.CENTER);
aFrame.pack();
aFrame.setVisible(true);
aFrame.setSize(new Dimension(600, 600));
}
     static class imagePanel extends JPanel
    {
        Image image = null;

        public imagePanel(Image image)
        {
            this.image = image;
        }

        @Override
        public void paintComponent(Graphics g)
        {
            super.paintComponent(g);
            //there is a picture: draw it
            if (image != null)
            {
                int height = this.getSize().height;
                int width = this.getSize().width;
                g.drawImage(image, 0, 0, width, height, this);
            }
        }
    }
     /**
 * Adds the specified path to the java library path
 *
 * @param path the new library path to add
 * @throws Exception
 */
public static void addLibraryPath(String path) throws Exception {
    String oldPath = System.getProperty("java.library.path");
    if (oldPath.length() >0)path = path+":"+oldPath;
    System.setProperty("java.library.path", path);

    //set sys_paths to null
        final Field sysPathsField = ClassLoader.class.getDeclaredField("sys_paths");
        sysPathsField.setAccessible(true);
        sysPathsField.set(null, null);
    }

    } 
```

# assembly - INT 10、13h 如何处理属性？

> ID：12556973
> 
> 赞同：4
> 
> 时间：2012-09-23T22:56:17.297
> 
> 标签：assembly, x86, bios, interrupt

嘿，我试图理解 INT 10h、13h (19) 写入带有 BIOS 中断 10 和 13h 的字符串的啊。我在下面找到了有关放入不同寄存器的不同标志的信息。我仍然不明白的一件事是 BL 中应该包含什么，如果我只是想用这个函数编写一个字符串，那么 BL 中应该包含什么作为属性？现在它会写出奇怪的闪烁符号，这些符号没有意义。谢谢，提前

```
Writes a string of characters with specified attributes to any display
page.

   On entry:      AH         13h
                  AL         Subservice (0-3)
                  BH         Display page number
                  BL         Attribute (Subservices 0 and 1)
                  CX         Length of string
                  DH         Row position where string is to be written
                  DL         Column position where string is to be written
                  ES:BP      Pointer to string to write

   Returns:       None

   Notes:         This service is available only for XTs dated 1/19/86
                  and later, ATs, EGAs, and PC Convertibles.

                  The service has four subservices, as follows:

                  AL=00h: Assign all characters the attribute in BL;
                  do not update cursor
                  AL=01h: Assign all characters the attribute in BL;
                  update cursor
                  AL=02h: Use attributes in string; do not update
                  cursor
                  AL=03h: Use attributes in string; update cursor

                  In Subservices 0 and 1, all characters in the string
                  are written to the screen with the same attribute--
                  the attribute specified in BL.

                  In Subservices 2 and 3, the attribute byte for each
                  character is found in the string itself. The string
                  itself consists of a character followed by its
                  attribute, another character followed by its
                  attribute, and so on. The string is copied directly
                  to the video buffer as is.

                  In Subservices 0 and 2, the cursor position is not
                  updated after the string is written.

                  In Subservices 1 and 3, the cursor is moved to the
                  first position following the last character in the
                  string.

                  Like Service 0Eh, Service 13h responds appropriately
                  to ASCII 07h (bell), 08h (backspace), 10h (line
                  feed), and 0Dh (carriage return). All other
                  characters are printed. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T23:05:02.723

使用`int 10h`，`BL`寄存器用于颜色属性。

除非您正在处理 CGA，其中`BL`值是调色板编号，否则该`BL`值是代表前景色（4 位 - 低部分）和背景颜色（4 位 - 高部分）的数字。

例如，如果您想要蓝色 (0x01) 背景和红色 (0x04) 文本颜色，则需要`0x14`将.`BL``00010100`

```
 0001             0100
|_ Background _| |_ Foreground _| 
```

颜色通常是：

```
 - Black            0x00
 - Blue             0x01
 - Green            0x02
 - Cyan             0x03
 - Red              0x04
 - Magenta          0x05
 - Brown            0x06
 - LightGray        0x07
 - DarkGray         0x08
 - LightBlue        0x09
 - LightGreen       0x0A
 - LightCyan        0x0B
 - LightRed         0x0C
 - LightMagenta     0x0D
 - LightBrown       0x0E
 - White            0x0F 
```

# python - Python中LD_LIBRARY_PATH和lib-dynload的关系

> ID：12556974
> 
> 赞同：3
> 
> 时间：2012-09-23T22:56:26.407
> 
> 标签：python

谁能解释 LD_LIBRARY_PATH 和 lib-dynload 目录在 Unix 机器上的 Python 中工作的关系。

我问的原因是因为在我的工作地点，我们有一个 Python 的网络安装，它可以在多台 unix 机器上运行（不要问为什么，它是一堆奇怪的政治怪癖。）它适用于大多数系统较旧，但在较新的系统上，当人们尝试使用 tkinter 框架时会遇到问题（因为这些机器安装了较新版本的底层库。）

我做了一些探索，在 lib-dynload 目录中有另一个库文件，它似乎只是指示 Python 将哪个库用于 tkinter 东西。

做了一些摆弄，我找到了一种绕过问题的方法（本质上，将库的新版本放在用户的 LD_LIBRARY_PATH 的前面似乎可以解决问题。我认为它可以工作，因为它在版本之前找到了这个版本的库在 lib-dynload 文件夹中，但如果您尝试在其中一台较旧的机器上这样做，它会中断），但这确实是一个不雅的解决方案。

# python - 在谷歌应用引擎上使用 webapp2 的 DomainRoute

> ID：12556977
> 
> 赞同：0
> 
> 时间：2012-09-23T22:56:35.753
> 
> 标签：python, google-app-engine, routing, subdomain, webapp2

我正在尝试使用 webapp2 的[DomainRoute](http://webapp-improved.appspot.com/api/webapp2_extras/routes.html#webapp2_extras.routes.DomainRoute)将请求路由到特定用户。路由的定义如下所示：

```
app = webapp2.WSGIApplication([
                                DomainRoute("<subdomain>." + os.environ["HTTP_HOST"], [
                                    webapp2.Route('/',ClientHandler)]),
                            ('/', MainHandler)],
                            debug=True) 
```

处理程序都存在，目前，我的 ClientHandler 应该只是吐出当前的子域，但是当我当前转到 nosub.localhost:8090 时，它甚至没有到达服务器。我需要编辑我的主机文件吗？如果是这样，添加像 *.localhost 这样的通配符是否有效，以便任何子域都可以使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:12:40.987

是的，您需要编辑主机文件 -`whatever.localhost`不会自动解析为`127.0.0.1`. 或者，节省一些时间并使用[xip.io](http://xip.io/)。

但是，您的代码有一个重大问题：您在`os.environ["HTTP_HOST"]`仅在第一个请求时运行的上下文中使用。这意味着您从应用程序的第一个请求中提取主机名，并将其用作它和所有后续请求的基本名称 - 这绝对不是您想要的。例如，如果您的应用实例的第一个用户来自`subdomain.myapp.com`，您将为`subdomain.subdomain.myapp.com`.

# java - 使用 toString 逐行打印到文本文件

> ID：12556982
> 
> 赞同：3
> 
> 时间：2012-09-23T22:56:54.330
> 
> 标签：java, file, io, newline

我可以使用 toString 逐行打印到控制台，但是当我将它放入文本文件时它为什么不一样？

```
public class NewClass
{

    @Override
    public String toString()
    {
        return ("John " + "\n" + "jumps " + "\n" + "fences");
    }
}

import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;

public class Sandbox
{
    public static void main(String[] args) throws IOException
    {
        NewClass object = new NewClass();            

        FileWriter file = new FileWriter("output.txt");
        PrintWriter output = new PrintWriter(file);
        output.println(object.toString());    
        output.close(); 
        System.out.println(object.toString());

    }
} 
```

**控制台输出：**

约翰

跳跃

栅栏

**输出.txt**

约翰跳过栅栏

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T23:04:29.187

由于您在 Windows 上，而不是`\n`使用`\r\n`（回车 + 换行）。

或者更好的是，用于[`System.getProperty("line.separator")`](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)获取*操作系统用于分隔文本文件中的行的序列*。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-23T23:04:26.243

Windows 文件需要 \r\n （回车和换行）。Unix 文件只需要 \n。为了使其与两者兼容，您可以使用 FileOutputStream：

```
try {
    FileOutputStream file = new FileOutputStream(new File("output.txt"));
    byte[] b = object.toString().getBytes();
    file.write(b);
} catch (Exception e) {
    //take care of IO Exception or do nothing here
} 
```

如图所示，您可能必须使用 try-catch 语句将其括起来。

# php - 使用 PHP 通过 YQL API (JSON) 进行交互

> ID：12556983
> 
> 赞同：0
> 
> 时间：2012-09-23T22:57:09.137
> 
> 标签：php, json, yql

我在遍历数组方面很糟糕，可以使用一些帮助。

我正在使用 YQL API（雅虎）

这是我要迭代的json：

[http://query.yahooapis.com/v1/public/yql?q=select%20](http://query.yahooapis.com/v1/public/yql?q=select%20) *%20from%20yahoo.finance.historicaldata%20where%20symbol%20%3D%20%22AAPL%22%20and%20startDate%20 %3D%20%222012-09-20%22%20and%20endDate%20%3D%20%222012-09-20%22&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys

试图获得“关闭”值。

试过这个但没有用：$json->query->results->Close

在此先感谢，菲尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:06:29.250

将其提取到数据中，

```
 data['query']['results']['quote']['Close'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T23:10:04.967

print_r($json->query->results->quote->Close) 做到了。这是一个愚蠢的问题——很抱歉浪费了大家的时间。

# jquery - IE不允许上传文件，如果不是键盘点击输入类型=文件

> ID：12556988
> 
> 赞同：1
> 
> 时间：2012-09-23T22:58:10.503
> 
> 标签：jquery, html, internet-explorer, xhtml, input-type-file

我有一个要求，我需要从另一个按钮触发 input[type=file] 并上传文件。这个 input[type=file] 是一个弹出窗口，用于浏览用户想要上传的文件。此窗口成功打开，但在上传文件时，它给了我`SCRIPT5: Access is Denied error`. 我无法用 input[type=file] 替换假按钮，有没有一种方法可以触发 input[type=file] 的点击，即使它不是来自键盘点击并仍然上传文件。根据我的研究，除非我们通过键盘单击触发 input-type=file，否则 IE 不允许上传文件。

```
var uploadConfig ={
    init: function(){
        $('input#fileUpld_input').livequery("click",function() {
        });
    },
    open: function() {
        $('input#fileUpld_input').trigger('click');
    },
    upload: function(){
        $('.start').click();
    } 
```

## 浏览器

```
<input type="file" id="fileUpld_input" name="fileUpld_input" class="fileUpld"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T06:21:28.497

使用对我有用的另一个答案中显示的代码： [working JSFiddle](http://jsfiddle.net/RASG/FkdCm/)

```
<input type="file" id="fileUpld_input" name="fileUpld_input" class="fileUpld"> 
```

我有同样的问题，但确定它是 IE 而不是代码。在花了太多时间试图解决我的代码中的错误之后；我启动了我的笔记本电脑，但无法复制它。最终重新启动并重新启动 IE 解决了该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T23:04:24.803

> 有没有一种方法可以触发输入 [type=file] 的点击，即使它不是来自键盘点击。

试试这个：http: [//jsfiddle.net/RASG/FkdCm/](http://jsfiddle.net/RASG/FkdCm/)

**HTML**

```
<input type="file" id="fileUpld_input" name="fileUpld_input" class="fileUpld">

<br>
<br>
<br>

<button id="theotherbutton">try me</button> 
```

**JS**

```
$('#theotherbutton').click(function() { $('#fileUpld_input').click() }) 
```

*用 IE 9 和 FF 16 测试*

# java - 如何在Android中将表格从网络传输到我的数据库

> ID：12556992
> 
> 赞同：0
> 
> 时间：2012-09-23T22:58:35.357
> 
> 标签：java, android, database, eclipse

我正在制作一个应用程序，在该应用程序中我连接到一个网站，以从我的 web 数据库中下载一个 json 字符串中的表，我已经完成，在我的应用程序中显示为 webArray。我创建了一个数据库帮助器类来在应用程序中创建和编辑我的数据库，我的问题是我无法将数据从我的 webArray 传输到我的数据库，这里有一些代码也许你可以帮助指出我正确的方向。

主要活动：

```
 //this is our download file asynctask
class DownloadFileAsync extends AsyncTask<String, String, String> {

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        showDialog(DIALOG_DOWNLOAD_PROGRESS2);
    }

    @Override
    protected String doInBackground(String... aurl) {

        try {
        String result = "";
                    try {
                        HttpClient httpclient = new DefaultHttpClient();
                        HttpPost httppost = new HttpPost("http://mywebsite");
                        // httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                        HttpResponse response = httpclient.execute(httppost);
                        HttpEntity entity = response.getEntity();
                        InputStream webs = entity.getContent();
                        // convert response to string
                        try {
                            BufferedReader reader = new BufferedReader(
                                    new InputStreamReader(webs, "iso-8859-1"), 8);
                            StringBuilder sb = new StringBuilder();
                            String line = null;
                            while ((line = reader.readLine()) != null) {
                                sb.append(line + "\n");
                            }
                            webs.close();

                            result = sb.toString();
                        } catch (Exception e) {
                            Log.e("log_tag", "Error converting result " + e.toString());
                            return "ERROR_IN_CODE";
                        }
                    } catch (Exception e) {
                        Log.e("log_tag", "Error in http connection " + e.toString());
                        return "ERROR_IN_CODE";
                    }

                    // parse json data
                    try {
                        JSONArray jArray = new JSONArray(result);
                        for (int i = 0; i < jArray.length(); i++) {
                            JSONObject json_data = jArray.getJSONObject(i);
                            webResultCuestionario resultRow3 = new webResultCuestionario();
                            resultRow3._id = json_data.getString("id");
                            resultRow3.pregunta = json_data.getString("Question");
                            resultRow3.respuesta = json_data.getString("Answer");
                            CuestionarioArray.add(resultRow3);
                        }
                    } catch (JSONException e) {
                        Log.e("log_tag", "Error parsing data " + e.toString());
                        return "ERROR_IN_CODE";
                    }
    } catch (Exception e) {
        // this is the line of code that sends a real error message to the
        // log
        Log.e("ERROR", "ERROR IN CODE: " + e.toString());
        // this is the line that prints out the location in
        // the code where the error occurred.
        e.printStackTrace();
        return "ERROR_IN_CODE";
    }
        return null;
    }

    protected void onProgressUpdate(String... progress) {
         Log.d(LOG_TAG,progress[0]);
         mProgressDialog2.setProgress(Integer.parseInt(progress[0]));
    }

    @Override
    protected void onPostExecute(String unused) {
        //dismiss the dialog after the file was downloaded
        dismissDialog(DIALOG_DOWNLOAD_PROGRESS2);
        if(unused != null && unused.equals("ERROR_IN_CODE")){
            errornote2();
        }else{
            tvCuestionario.setText("Cuestionario encontrado");
            addCuestionarioToDb();
        }
    }
}   

public void addCuestionarioToDb(){
for (webResultCuestionario currentItem: CuestionarioArray){
    int cis = Integer.parseInt(currentItem._id);
    db.insertCuestionario(CuestionarioArray.get(cis).pregunta, CuestionarioArray.get(cis).respuesta);
}
} 
```

在我的 CuestionarioHelper 类中：

```
public class CuestionarioHelper extends SQLiteOpenHelper {

private static final String DATABASE_NAME="cuestionario.db";
private static final int SCHEMA_VERSION=1;

public CuestionarioHelper(Context context) {
    super(context, DATABASE_NAME, null, SCHEMA_VERSION);
}   
@Override
public void onCreate(SQLiteDatabase db) {

    db.execSQL("CREATE TABLE Cuestionario (_id INTEGER PRIMARY KEY AUTOINCREMENT, pregunta TEXT, respuesta TEXT);");
    }
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

} 

    public void insertCuestionario(String pregunta, String respuesta) {
    ContentValues cv=new ContentValues();
    cv.put("pregunta", pregunta);
    cv.put("respuesta", respuesta);
    getWritableDatabase().insert("Cuestionario", null, cv);
} 
```

日志

```
09-23 16:23:02.977: E/AndroidRuntime(6496): FATAL EXCEPTION: main
09-23 16:23:02.977: E/AndroidRuntime(6496): java.lang.IndexOutOfBoundsException: Invalid  index 100, size is 100
09-23 16:23:02.977: E/AndroidRuntime(6496):     at   java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at    java.util.ArrayList.get(ArrayList.java:304)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at VerCuestionarioEspanol_copy.MainActivity.addCuestionarioToDb(MainActivity.java:580)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at  VerCuestionarioEspanol_copy.MainActivity$DownloadFile3Async.onPostExecute(MainActivity.java:46 2)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at  VerCuestionarioEspanol_copy.MainActivity$DownloadFile3Async.onPostExecute(MainActivity.java:1)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at android.os.AsyncTask.finish(AsyncTask.java:602)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at android.os.AsyncTask.access$600(AsyncTask.java:156)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at android.os.Looper.loop(Looper.java:154)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at android.app.ActivityThread.main(ActivityThread.java:4977)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at java.lang.reflect.Method.invokeNative(Native Method)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at java.lang.reflect.Method.invoke(Method.java:511)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-23 16:23:02.977: E/AndroidRuntime(6496):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T18:14:03.320

Luis 建议的我的解决方案是：

```
public void addCuestionarioToDb(){
  for (webResultCuestionario currentItem: CuestionarioArray){
    int cis = Integer.parseInt(currentItem._id)-1;   // just added the -1 here and runs perfect
    db.insertCuestionario(CuestionarioArray.get(cis).pregunta,  CuestionarioArray.get(cis).respuesta);
  }
} 
```

# c# - 在 C# 5 中将 WPF 事件处理程序声明为“异步”的意义

> ID：12556993
> 
> 赞同：20
> 
> 时间：2012-09-23T22:58:46.587
> 
> 标签：c#, .net, wpf, asynchronous, c#-5.0

想象一个 WPF 代码隐藏事件处理程序：

```
<Button Click="OnButtonClick" /> 
```

在 C# 4 中，您可以将处理程序声明为：

```
private void OnButtonClick(object sender, RoutedEventArgs e) { ... } 
```

在 C# 5 中，您可以声明一个`async`处理程序

```
private async void OnButtonClick(object sender, RoutedEventArgs e) { ... } 
```

那么 WPF 对此做了什么？几分钟的搜索并没有发现任何问题。

似乎可以在`await`语句之后执行 UI 更新。这是否意味着任务在 Dispatcher 线程上继续？

如果`Task`引发错误，将通过 WPF 引发错误，`Dispatcher`还是仅通过`TaskScheduler`?

是否还有其他有趣的方面可以很好理解？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-24T01:57:18.747

你可能会发现我的[async/await 介绍](http://blog.stephencleary.com/2012/02/async-and-await.html)很有帮助。

`async`编译器重写了一个方法来支持`await`操作符。每个`async`方法都开始同步（在这种情况下，在 UI 线程上），直到它`await`是某个操作（尚未完成）。

默认情况下，会保存上下文，当操作完成时，方法的其余部分会安排在该上下文中执行。这里的“上下文”是`SynchronizationContext.Current`除非它是`null`，在这种情况下它是`TaskScheduler.Current`。正如 Drew 指出的那样，WPF 提供了一个`DispatcherSynchronizationContext`与 WPF 相关联的`Dispatcher`。

关于错误处理：

当您`await`在`Task`WPF`async void`事件处理程序中时，错误处理如下所示：

*   完成时出现`Task`错误。`AggregateException`与所有`Task`错误一样，异常被包装在一个中。
*   `await`操作员看到完成但`Task`有错误。它解开原始异常并重新抛出它，保留原始堆栈跟踪。
*   方法构建器捕获从方法`async void`中转义的异常`async void`，并将其传递给方法开始执行`SynchronizationContext`时处于活动状态的异常`async void`（在本例中，相同的 WPF 上下文）。
*   `AggregateException`在`Dispatcher`. _

这是相当复杂的，但目的是让`async`事件处理程序引发的异常与常规事件处理程序引发的异常几乎相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-23T23:18:17.820

部分答案。来自[MSDN](http://msdn.microsoft.com/en-us/library/hh191443.aspx)：

> 无法等待具有 void 返回类型的异步方法，并且返回 void 的方法的调用者无法捕获该方法抛出的任何异常。

所以任何错误只能通过`TaskScheduler`.

此外，事件处理程序注册没有任何特定于 XAML 的内容。它可以在代码中完成：

```
this.button.Click += OnButtonClick; 
```

甚至作为异步 lambda：

```
this.button.Click += async (s,e) => { ... }; 
```

至于 之后的 UI 更新的安全性`await`，似乎延续是在[`SynchronisationContext.Current`](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.current.aspx)每个线程设置的内部执行的。在 WPF 中，这是一个[`DispatcherSynchronisationContext`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchersynchronizationcontext.aspx)与 WPF 耦合的，`Dispatcher`它首先泵送事件。