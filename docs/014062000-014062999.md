# StackOverflow 问答 14062000-14062999

# security - delphi exe的内部密码安全吗？

> ID：14062002
> 
> 赞同：5
> 
> 时间：2012-12-27T22:14:56.580
> 
> 标签：security, delphi

如果我需要用户输入密码来打开 Delphi 生成的 exe，我使用这样的代码，但不是这样的简单密码：

```
if password='1234' then begin
   form2.show
end; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T22:17:34.613

不，这几乎肯定会以明文形式存储在可执行文件中。

事实上，由于检查是在本地完成的，再多的努力也无法保证可执行文件的安全——攻击者只需编辑可执行文件以修改条件跳转，您的测试就会被绕过。通常保护这些东西的方法是将这种权力从攻击者手中*移开。*例如，将用户输入的密码发送到您控制的中央服务器，并在那里完成检查，只有在检查成功时才发回需要的东西（并且不能被替换服务器伪造）。

但是，这可能是很多不必要的努力。如果您想要做的只是将随意的破解者拒之门外，那么您可能只需稍加混淆即可做到这一点，例如使用关键字对密码进行异或运算，这样在可执行文件中就不会那么明显了。对用户输入的密码做同样的事情，然后比较它们，意味着明文密码将不可见。

像这样的计划不会阻止一个坚定的饼干，但它会让绝大多数人更难。安全（IT、家庭或任何其他类型）的概念并不总是让人无法被打败，只是让它变得足够难以至于不值得。

这真的取决于你想打败*谁——这将决定你的计划应该有多复杂。*

或者，您可能需要考虑 hvd 在评论中提出的选项。让可执行文件只是一个存根，它具有*实际*的可执行文件作为加密数据。这将使用用户输入的密钥解密并写入文件系统，检查有效性，然后运行。

因为密码不在存根内，所以不容易受到攻击。密码只存在于创建者（在制作存根时使用）和用户（希望只存在于他们的脑海中）。仅获得存根的人没有简单的方法来运行加密的可执行文件。

同样，有一些方法可以解决这个问题，但它们都涉及在*没有*可执行文件的情况下获取密码（暴力破解、社会工程等）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-27T22:55:39.190

只是为了演示它是多么不安全，请考虑这个小型控制台应用程序：

```
program Project1;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  System.SysUtils;

procedure StartProgram;
begin
  writeln('You entered the correct password. Welcome to this awesome program!');
end;

procedure EndProgram;
begin
  writeln('That is not the correct password. Goodbye.');
end;

var
  PW : string;

begin
  write('Enter password: ');
  readln(PW);

  if PW = 'SuperSecretPassword' //See if you can spot this in the image
    then StartProgram
    else EndProgram;

  readln;
end. 
```

编译它，然后在十六进制编辑器中打开 exe 文件。屏幕截图来自 XVI32，但我想任何十六进制编辑器看起来都有些相似：

![在此处输入图像描述](../Images/71ba8a347d74627476f1320ef4afa1da.png)

毕竟不是那么超级秘密。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-27T22:17:00.837

不，如果有人想要，他们可以对可执行文件进行逆向工程并获取密码。

# joomla - Joomla 1.5 不更新模板更改

> ID：14062003
> 
> 赞同：0
> 
> 时间：2012-12-27T22:15:05.290
> 
> 标签：joomla

我有一个组件，我在开发时正在动态编辑。突然之间，当我应用它们时，事情需要一段时间才能显示出变化。

从模板设置到我通过 FTP 上传的原始代码的所有内容。

当我应用更改时，大约需要 5 分钟才能显示出来。它发生在不同的浏览器上，所以我可以排除缓存问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T05:39:38.677

问题在于 Joomla 安装。重新安装了 Joomla，一切正常。我不知道出了什么问题。

# asp.net - ASP.NET GridView 同时编辑多个行

> ID：14062004
> 
> 赞同：0
> 
> 时间：2012-12-27T22:15:09.003
> 
> 标签：asp.net, gridview, edit, rowstate

在 ASP.NET 4.0 GridView 中，是否可以同时在编辑模式下拥有多行？

我在属性中使用编辑模式控制行：

```
Private Property Editing As List(Of Integer)
   Get
       If ViewState("Editing") Is Nothing Then ViewState("Editing") = New List(Of Integer)
       Return CType(ViewState("Editing"), List(Of Integer))
   End Get
   Set(value As List(Of Integer))
       ViewState("Editing") = value
   End Set
End Property 
```

当用户点击编辑按钮时填充它：

```
Protected Sub GridView1_RowCommand(sender As Object, e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles GridView1.RowCommand
    If e.CommandName = "Edit" Then
        Dim row = CType(CType(e.CommandSource, LinkButton).NamingContainer, GridViewRow)
        Editing.Add(row.RowIndex)
    End If
End Sub 
```

并在 RowDataBound 事件中手动更改 RowState 属性：

```
Protected Sub GridView1_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound
    If e.Row.RowType = DataControlRowType.DataRow Then
        If Editing.Contains(e.Row.RowIndex) Then
            Then e.Row.RowState = DataControlRowState.Edit
        End If
    End If
End Sub 
```

但它不起作用，行正在以正常状态呈现......任何想法？

* * *

编辑 2：财产

MultipleEditGridView.vb：

```
Namespace ClubeCheckIn.UI

        Public Class MultipleEditGridView
            Inherits GridView

            Protected Property IsRowInEditMode(rowIndex As Int32) As Boolean
                Get
                    If ViewState("GridRowEditIndices") Is Nothing Then
                        Return False
                    Else
                        Dim indices = DirectCast(ViewState("GridRowEditIndices"), List(Of Int32))
                        Return indices.Contains(rowIndex)
                    End If
                End Get
                Set(value As Boolean)
                    If ViewState("GridRowEditIndices") Is Nothing Then
                        ViewState("GridRowEditIndices") = New List(Of Int32)
                    End If
                    Dim indices = DirectCast(ViewState("GridRowEditIndices"), List(Of Int32))
                    indices.Remove(rowIndex)
                    indices.Add(rowIndex)
                End Set
            End Property

        End Class

    End Namespace 
```

网络配置：

```
<controls>
    <add tagPrefix="clube" namespace="ClubeCheckIn.UI" />
</controls> 
```

ASPX：

```
<clube:MultipleEditGridView ID="GridView1" runat="server">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:TextBox ID="txtEdit" runat="server" Visible="<%# IsRowInEditMode(Container.DataItemIndex) %>" />
            </ItemTemplate>
    </Columns>
</clube:MultipleEditGridView> 
```

错误：

错误：BC30451：未声明“IsRowInEditMode”。由于保护级别，它可能无法访问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:22:03.137

我很确定`GridView`在编辑模式下不支持多行。

作为一种解决方法，您可以将`ItemTemplate`用于两种状态（fe a`Label`和 a `TextBox`）。然后，您可以使用`EditMode`带有`RowIndex`as 参数的属性。您可以将行以编辑模式存储在`ViewState`.

（未测试）

```
Protected Property IsRowInEditMode(rowIndex As Int32) As Boolean
    Get
        If ViewState("GridRowEditIndices") Is Nothing Then
            Return False
        Else
            Dim indices = DirectCast(ViewState("GridRowEditIndices"), List(Of Int32))
            Return indices.Contains(rowIndex)
        End If
    End Get
    Set(value As Boolean)
        If ViewState("GridRowEditIndices") Is Nothing Then
            ViewState("GridRowEditIndices") = New List(Of Int32)
        End If
        Dim indices = DirectCast(ViewState("GridRowEditIndices"), List(Of Int32))
        indices.Remove(rowIndex)
        indices.Add(rowIndex)
    End Set
End Property 
```

您可以直接从标记中调用它， fe 用于编辑控件：

```
Visible='<%# IsRowInEditMode(Container.DataItemIndex) %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T08:01:34.627

你可以用这个对面糊有用...

```
 Get
        If ViewState("GridRowEditIndices") Is Nothing Then
            Return False
        Else
            Dim indices = DirectCast(ViewState("GridRowEditIndices"), List(Of Int32))
            Return indices.Contains(rowIndex)
        End If
    End Get
    Set(value As Boolean)
        If ViewState("GridRowEditIndices") Is Nothing Then
            ViewState("GridRowEditIndices") = New List(Of Int32)
        End If
        Dim indices = DirectCast(ViewState("GridRowEditIndices"), List(Of Int32))
        indices.Remove(rowIndex)
        indices.Add(rowIndex)
    End Set
End Property 
```

# javascript - Ember.js 路由和连接插座

> ID：14062009
> 
> 赞同：3
> 
> 时间：2012-12-27T22:15:49.667
> 
> 标签：javascript, ember.js

我正在尝试设置 Ember 路由器应用程序，但我无法使用 Controller 对象的 connectOulet 方法将视图连接到特定插座（具有名称的插座，即：）`{{outlet outletName}}`。我已经建立了一个 JSFiddle 示例，有人可以告诉我我做错了什么或如何实际去做吗？

JSFiddle：http: [//jsfiddle.net/TmKwd/](http://jsfiddle.net/TmKwd/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T09:27:57.697

嗯，我不能准确解释为什么，但是不能将ApplicationController定义为Ember.ObjectController，而只能定义为Ember.Controller。

**更新**

经过快速调试后，这是在 applicationController 上调用 connectOutlet 时，尤其是行`set(this, outletName, view);`
As `outletName`（在您的示例中，这是“一”和“二”）是 applicationController 中的未知属性，并且由于您将 applicationController 定义为 ObjectController （所以是包装内容属性的代理），Ember.js 尝试在内容上设置视图，这是未定义/空的。

结果，抛出此错误：

`Uncaught Error: assertion failed: Cannot delegate set('one', <App.ViewOneView:ember208>) to the 'content' property of object proxy <App.ApplicationController:ember209>: its 'content' is undefined.`

# database - 这是一个好的数据库设计吗？

> ID：14062011
> 
> 赞同：2
> 
> 时间：2012-12-27T22:16:14.417
> 
> 标签：database, database-design

我有四张桌子。制造商、生产工厂、生产线和机器。机器是用于制造某些产品的机器。

一个制造厂可以有很多工厂，一个工厂可以有很多生产线可以有很多机器。所以所有的关系都是1：N。

所以这些表有以下字段：

```
Manufactures      (IDManufacture,...)
ProductionPlant   (IDProductionPlant, IDManufacture,...)
ProductionLine    (IDProductionLine, IDPlant,...)
Machines          (IDMachine, IDProductionLine,...) 
```

然而，这使得机器必须始终安装在生产线上，但有时机器可以卸载，不使用，但仍然是制造商的财产。

在设计中，如果我将机器表中的 IDProductionLine 字段设置为空，那么我将无法知道拥有这台机器的制造商。

所以第一个解决方案是将其他字段添加到 Machines 表中，即 IDManufacture，这样我可以将 IDProductionLine 设置为空，但仍然可以知道所有者。

但我怀疑这是否是一个好的解决方案，因为这会在关系中创建一个循环，因为从机器中，我可以通过 IDMachine 或 LineProducion-->PlantProduction 了解制造。这是一个问题还是一个好的解决方案？

什么时候消除循环，什么时候允许有循环？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:31:50.727

我会将机器（特定产品线中的机器库存）与您的机器类型分离，以使其更加规范化 -

```
Manufacturer
 1:N
Prod Plant
 1:N
Prod Line
 1:N
Machine Inventory
 N:1
Machine Type 
```

机器类型表将存储公司使用的每种机器类型的 1 行，机器库存将包含特定产品线中使用的机器的每个实例的唯一信息。使用这种结构，您将能够从产品线中删除一台机器，并且仍然在您的数据库中维护有关该机器的详细信息。如果您使用同一机器的多个实例或在不同的产品线或工厂中使用相同类型的机器，这种结构的冗余也会减少，因为所有这些机器库存行都会指向机器类型。

# javascript - HTML5 Javascript 嵌套如果 Else 没有按预期工作

> ID：14062014
> 
> 赞同：-4
> 
> 时间：2012-12-27T22:16:25.800
> 
> 标签：javascript, html

问题：detectLocationtimersset() 逻辑似乎不起作用。我知道子例程已被解雇，但我猜如果其他错误是多重的？

detectLocationtimersset() 的原因是有一些逻辑来确保不设置多个计时器。

我创建了第一个 if / else 以首先根据 datatime 设置计时器，然后我编写了第二个 if / else 来进行意义检查。

detectLocation() 已经过测试并且可以独立工作。

```
var detectLocationtimerset = 0;
var datatime = 1;

function detectLocationtimersset() {    
    // Setup timer to check for new data start
    // check and see if set 
    if (detectLocationtimerset = 0 ) {
        detectLocationtimerset = 1;
        if (datatime == null) {
            datatime = 9;
            milliseconds = (datatime * 60000)
            setInterval(function () {
                detectLocation();
                console.log("detectLocation() timer set");
            }, milliseconds);   
        } else {
                    detectLocationtimerset = 1;
            milliseconds = (datatime * 60000)
            setInterval(function () {
                detectLocation();
                console.log("detectLocation() timer set");
            }, milliseconds);   
        }   
    }
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T22:18:41.033

我不知道问题是什么，但是

```
if (detectLocationtimerset = 0 ) 
```

应该是

```
if (detectLocationtimerset === 0) 
```

在其他说明中，

*   你的缩进应该是一致的
*   您在运算符周围的间距应该是一致的
*   在可能的情况下，您应该更喜欢[身份](https://stackoverflow.com/questions/359494/javascript-vs-does-it-matter-which-equal-operator-i-use)而不是平等
*   您应该将共享代码移出 if/else 块 - 将`milliseconds`分配和`setInterval`调用放在块*之后*`if (datatime == null)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T22:19:12.210

您的

```
if (detectLocationtimerset = 0 ) { 
```

应该

```
if (detectLocationtimerset === 0 ) { 
```

# eclipse - 打开括号后，将 Eclipse 格式更改为在换行符上仅缩进 4 个空格

> ID：14062017
> 
> 赞同：0
> 
> 时间：2012-12-27T22:16:54.737
> 
> 标签：eclipse

有没有办法在eclipse java中配置这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:21:20.043

我*认为*您正在寻找的是窗口 - 首选项 - Java - 代码样式 - 格式化程序 - 编辑... - 换行 - 换行的默认缩进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T17:22:03.003

我不认为这是可能的。我一直在寻找这个（但对于 C）。我希望代码看起来像这样的换行：

```
/*
 * Parameters
 */
class Example {
    void foo(int arg1, int arg2,
        int arg3, int arg4,
        int arg5, int arg6) {
    }
}; 
```

但是，Eclipse 只允许您指定要使用的制表符的数量，而不是使用制表符还是空格。我一直在寻找的地方是 C/C++ > Code Style > Formatter > Edit Format 按钮下的 Preferences。

**更新：**这是可行的，但是设置很麻烦，并且在屏幕上显示不正确。但是，**它将**正确写入文件。开始了：

*   单击上述首选项区域中的“编辑”按钮（将“C/C++”替换为您选择的语言）
*   在“缩进”部分，
    *   将“标签策略”设置为“混合”
    *   选中“仅将制表符用于前导缩进”复选框
    *   将“缩进大小”和“制表符大小”都设置为 4
*   在“换行”部分：
    *   将“换行的默认缩进”设置为 1

**警告：我不知道这会如何影响代码格式化程序首选项中其他地方的其他缩进设置。**

# mysql - MySQL 使用别名

> ID：14062019
> 
> 赞同：1
> 
> 时间：2012-12-27T22:17:02.157
> 
> 标签：mysql, subquery, alias

我有以下语法不正确的查询，别名为 in_Degree 和 out_degree：

```
insert into userData
select user_name, 
      (select COUNT(*) from tweets where rt_user_name = u.USER_NAME)in_degree,
      (select COUNT(*) from tweets where source_user_name = u.user_name)out_degree, 
      in_degree + out_degree(freq)
   from users u 
```

查询中的问题是选择列表中的第 4 项别名为 freq。我希望第 4 项的值为 in_degree + out_degree。蛮力极慢的解决方案是复制并通过两个子查询并添加它们。

1.  我怎样才能让它变得像 in_degree + out_degree 一样快速和简单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:25:04.897

您可以使用子查询：

```
 insert into userData
 select user_name,
   in_degree,
   out_degree,
   in_degree + out_degree
 from
 (
   select user_name, 
    (select COUNT(*) from tweets where rt_user_name = u.USER_NAME)in_degree,
    (select COUNT(*) from tweets where source_user_name = u.user_name)out_degree
   from users u
 ) src 
```

或者您可以使用：

```
insert into userData
select user_name,
  count(distinct in_t.*) in_degree,
  count(distinct out_t.*) out_degree,
  count(distinct in_t.*) + count(distinct out_t.*)
from users u
left join tweets in_t
  on u.USER_NAME = in_t.rt_user_name
left join tweets out_t
  on u.USER_NAME = out_t.source_user_name
 group by u.user_name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T22:39:52.217

正如您所发现的，除了在 HAVING 子句或 ORDER BY 子句中之外，您不能引用该选择列表中给出的别名。

一种选择是将您的查询用作“内联视图”，并围绕它编写一个包装查询。

*   从查询的选择列表中删除第 4 个（无效）表达式，
*   将您的查询包装在一组括号中
*   在结束括号后面加上别名 (eg) s
*   围绕它写一个查询，引用内联视图，就好像它是一个表一样
*   外部查询上的选择列表可以引用内联视图中定义的“别名”。

但是，如果您想让这个“快速”，您可能会考虑（作为一种选择）采取完全不同的策略。您可以获取所有用户的计数，而不是使用相关子查询来获取每个用户的计数，然后使用 LEFT JOIN 运算符，例如

```
SELECT u.user_name
     , IFNULL(i.cnt,0) AS in_degree
     , IFNULL(o.cnt,0) AS out_degree
     , IFNULL(i.cnt,0)+IFNULL(o.cnt,0) AS freq
  FROM users u
  LEFT
  JOIN (SELECT rt_user_name, COUNT(*) AS cnt FROM tweets 
        GROUP BY rt_user_name) i
    ON i.rt_user_name = u.user_name
  LEFT
  JOIN (SELECT source_user_name, COUNT(*) AS cnt FROM tweets 
        GROUP BY source_user_name) o
    ON o.source_user_name = u.user_name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:25:16.433

这应该有效：

```
insert into userData
  SELECT T.user_name,
       T.in_degree,
       T.out_degree,
       (T.in_degree + T.out_degree) as freq
   FROM (SELECT user_name, 
          (select COUNT(*) from tweets where rt_user_name = u.USER_NAME) as in_degree,
          (select COUNT(*) from tweets where source_user_name = u.user_name) as out_degree      
           FROM users u) T 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T22:26:04.110

以一种快速的方式，我会做类似的事情：

```
insert into userData
select 
    TMP.user_name,
    TMP.in_degree,
    TMP.out_degree,
    (TMP.in_degree + TMP.out_degree) degreeSum
from(
    select user_name, 
        (select COUNT(*) from tweets where rt_user_name = u.USER_NAME)in_degree,
        (select COUNT(*) from tweets where source_user_name = u.user_name)out_degree
    from users u
) TMP 
```

# c++ - 包括在 c++ 中引起问题。如何学会正确地做 c++

> ID：14062020
> 
> 赞同：2
> 
> 时间：2012-12-27T22:17:05.480
> 
> 标签：c++

所以我做了一个复杂的项目，现在我有太多的包含文件让我很头疼。我怎样才能最好地管理这些课程？有些类需要使用其他类。我还有一个 .h 文件，其中包含一堆 int 数组。这些在应用程序中保持不变，但是当编译器抱怨我正在重新定义数组时，我遇到了问题。

我应该做一个类库吗？命名空间？动态链接库？最佳做法是什么？我在哪里可以找到正确的做法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-27T22:21:58.797

*   在所有标题中使用[包含防护。](http://en.wikipedia.org/wiki/Include_guard)

> **文件.h**
> 
> ```
>  #ifndef FILE_H_INCLUDED
>    #define FILE_H_INCLUDED
> 
>    void foo();
> 
>    #endif 
> ```

*   尽可能避免使用全局变量。如果必须使用它们，请使用声明全局变量`extern`并将定义放在`.cpp`文件中。

> **文件.h**
> 
> ```
>  extern int var[20]; 
> ```
> 
> **文件.cpp**
> 
> ```
>  int var[20]; 
> ```

*   如果可能，请使用前向声明。只要您只使用一个类的引用或一个指针并且不取消引用该指针，就可以使用前向声明。

> **有用的.h**
> 
> ```
>  class Useful {}; 
> ```
> 
> **其他.h**
> 
> ```
>  // Forward-declare instead of #include
>    class Useful;
> 
>    class Other
>    {
>        Useful* helper;
>    }; 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T22:25:08.733

我不认为真的有最佳实践，这取决于情况。我可能会建议将类似对象分组到命名空间中，然后将所有定义放在一个 .h 文件中。如果实现很短，请将它们全部放在一个 cpp 文件中。在我的工作中，我们有一个像这样的数据库访问层。大约有几十个对象由存储的过程填充。该代码仍然是一个主要的痛苦，但它比拥有两个少于 500 行的 .h 和 cpp 文件要好。如果你这样做，将对象定义区分开来的注释变得非常重要。您可以轻松获得超过 10,000 行的文件，因此您需要一些东西来分解它们。

当然使用包括警卫，他们可能会解决重新定义的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:50:52.357

您需要知道定义和声明之间的区别，以及实体的哪些用途需要声明实体。然后你还需要学习“一个定义规则”（ODR），它告诉你什么时候不允许在程序中有多个定义（因此定义不能放在标题中）以及什么事情只要定义相同，就可以多次定义（因此定义可以放在标题中）。

例如，您要声明的那些数组；由于这些是全局可见的数组，程序只能包含一个定义，因此该定义不能放在标题中。需要访问它们的程序的每个部分只需要知道它们的声明。因此，不要将定义放在头文件中并违反 ODR，而应该有一个包含其定义的 C++ 文件和一个包含它们的声明的头文件。

像这样的代码：

```
int foo[100]; 
```

都声明并定义了数组`foo`。将这样的代码放入 C++ 文件中。要仅*声明*此数组，请执行以下操作：

```
extern int foo[100]; 
```

将这样的代码放在标题中。

类定义、内联函数和模板都是可以多次定义的，只要定义相同。您可以将这些定义放在头文件中，而常规函数和全局变量只能定义一次，因此您在头文件中声明它们，然后在实现文件中定义它们。

# linux - aptitude 如何确定要安装的软件包/应用程序的版本？

> ID：14062022
> 
> 赞同：0
> 
> 时间：2012-12-27T22:17:21.333
> 
> 标签：linux, apache2

所以我浪费了几天时间来处理 2012 年 2 月修复的一个蹩脚的 Apache2 错误。直到我发现我的 Apache2 版本是 2.2.x 版本，我才弄清楚为什么我仍然遇到这个错误，即使我认为我构建了整个服务器于 2012 年 11 月 30 日从头开始 Debian 6。出于某种原因 aptitude -install apache2 拉取了 2.2.x 而不是 2.4.x。

我希望我知道不要假设 aptitude 会推出最新的稳定版本。任何人都可以阐明如何管理存储库以及为什么 aptitude 会从维护的旧基础架构而不是 2.4.x 基础架构中提取？另外，我将如何专门获得拉 2.4.x 的能力，以及如何帮助自己避免将来出现此类问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:17:55.433

`aptitude`默认情况下，按照优先级顺序获取已配置存储库中可用的最新版本。

但为了说明这一点，Debian 6 默认为`apache-2.2`，而不是`apache-2.4`.

```
$ apt-cache showpkg apache
Package: apache
Versions: 

Reverse Depends: 
  apache2.2-common,apache 
```

# haskell - Haskell - 元组列表中的列表理解（a，[a]）

> ID：14062026
> 
> 赞同：5
> 
> 时间：2012-12-27T22:17:53.187
> 
> 标签：haskell, tuples, list-comprehension

所以，让我们进入正题：

```
f :: Eq a => a -> [(a,[a])] -> [(a,[a])]
f x list = [(a,[m]) | (a,[m]) <- list, x == a] 
```

所以：

```
 f 1 [(1,[1])] = [(1,[1])] 
```

但

```
 f 1 [(1,[1,1])] = [] 
```

这是为什么？？谢谢！

（我是新手，所以如果这是一个太愚蠢的问题，我很抱歉，但我真的找不到解释）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T22:23:08.333

那是因为`[1,1]`不匹配模式`[m]`。后者表示一个项目的列表（除非在应该使用类型名称的地方使用）。Haskell 已经知道该对的第二个元素是一个列表，（通过查看`list`参数的类型）并且不需要明确告知。

# asp.net-mvc - 如何使用 Ninject 拦截来拦截所有 ASP.NET WebApi 控制器操作方法调用以进行日志记录？

> ID：14062028
> 
> 赞同：20
> 
> 时间：2012-12-27T22:17:55.887
> 
> 标签：asp.net-mvc, logging, asp.net-web-api, ninject, ninject-interception

每次调用我们的 ASP.NET WebApi 控制器的一种操作方法时，我们公司都需要记录某些事情。由于我们现在将 Ninject 用于 DI，因此我们也希望将它用于此目的。这是我到目前为止所尝试的。

我通过 NuGet 安装了 Ninject、Ninject.Extensions.Interception 和 Ninject.Extensions.Interception.DynamicProxy，并且我有以下模块

```
public class InterceptAllModule : InterceptionModule
{
    public override void Load()
    {
        Kernel.Intercept(p => p.Request.Service.Name.EndsWith("Controller")).With(new TimingInterceptor());
    }
} 
```

TimingInterceptor 在哪里

```
public class TimingInterceptor : SimpleInterceptor
{
    readonly Stopwatch _stopwatch = new Stopwatch();
    protected override void BeforeInvoke(IInvocation invocation)
    {
        _stopwatch.Start();
    }

    protected override void AfterInvoke(IInvocation invocation)
    {
        _stopwatch.Stop();
        string message = string.Format("[Execution of {0} took {1}.]",invocation.Request.Method,_stopwatch.Elapsed);
        Log.Info(message + "\n");
        _stopwatch.Reset();
    }
} 
```

现在，当我尝试将模块与 ninject 内核连接并运行我的站点时

```
var kernel = new StandardKernel(new InterceptAllModule()); 
```

但是，每当有一个调用进入其中一个操作方法时，它都会抛出一个错误说

```
Cannot instantiate proxy of class: MyApiController. 
```

有经验的人可以指出我做错了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-28T20:28:53.023

**更新**

因此，使用您的代码和雷莫关于需要将动作方法设为虚拟并放入一个空的默认构造函数（只是为了安抚动态代理，**保持其他构造函数静止**）的优秀观点，我已经让动作过滤器和拦截方法都工作了。

我想说，就目前而言，您的代码将拦截 ApiController 上可能不需要的方法，因此您可能还需要放置一些代码来过滤掉这些方法，例如 ExecuteAsync 和 Dispose。

我唯一的另一点是性能。**巨大的免责声明**这些只是非常基本的测试（每次使用动作过滤器方法来记录统计数据），我邀请你自己做（！）......但使用 DynamicProxy 拦截器我得到的时间大约是 4 毫秒获取请求

```
[Execution of Get took 00:00:00.0046615.]
[Execution of Get took 00:00:00.0041988.]
[Execution of Get took 00:00:00.0039383.] 
```

注释掉拦截代码并使用动作过滤器，我得到了亚毫秒级的性能：

```
[Execution of Get took 00:00:00.0001146.]
[Execution of Get took 00:00:00.0001116.]
[Execution of Get took 00:00:00.0001364.] 
```

这是否真的是一个问题或担忧取决于您，但我想我会指出这一点。

**以前的回应**

您是否已经排除了使用 ActionFilters 的可能性？这是 AOP 在 MVC 操作上的自然扩展点。

如果您对控制器上的实际操作以外的方法感兴趣，那么我会理解，但我想我还是会发布一个建议。

灵感来自[ActionFilterAttributes 是否跨线程重用？这是如何运作的？](https://stackoverflow.com/questions/8937200/are-actionfilterattributes-reused-across-threads-how-does-that-work)和[测量调用 ASP.NET MVC 控制器操作的时间](https://stackoverflow.com/questions/11353155/measure-time-invoking-mvc-4-controller-actions)。

更新以显示在方法标记时排除计时器。来自核心 WebApi 框架的灵感，特别是[AllowAnonymousAttribute](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5d4159c85ff6#src/System.Web.Http/AllowAnonymousAttribute.cs)和[AuthorizeAttribute](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5d4159c85ff6#src/System.Web.Http/AuthorizeAttribute.cs)

全局注册这个，以便所有操作都被这个监控：

```
GlobalConfiguration.Configuration.Filters.Add(new TimingActionFilter()); 
```

然后：

```
public class TimingActionFilter : ActionFilterAttribute
{
    private const string Key = "__action_duration__";

    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        if (SkipLogging(actionContext))
        {
            return;
        }

        var stopWatch = new Stopwatch();
        actionContext.Request.Properties[Key] = stopWatch;
        stopWatch.Start();
    }

    public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
    {
        if (!actionExecutedContext.Request.Properties.ContainsKey(Key))
        {
            return;
        }

        var stopWatch = actionExecutedContext.Request.Properties[Key] as Stopwatch;
        if(stopWatch != null)
        {
            stopWatch.Stop();
            var actionName = actionExecutedContext.ActionContext.ActionDescriptor.ActionName;
            Debug.Print(string.Format("[Execution of {0} took {1}.]", actionName, stopWatch.Elapsed));
        }

    }

    private static bool SkipLogging(HttpActionContext actionContext)
    {
        return actionContext.ActionDescriptor.GetCustomAttributes<NoLogAttribute>().Any() ||
                actionContext.ControllerContext.ControllerDescriptor.GetCustomAttributes<NoLogAttribute>().Any();
    }
} 
```

和

```
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, Inherited = true)]
public class NoLogAttribute : Attribute
{

} 
```

现在您可以使用以下命令排除全局过滤器：

```
public class ExampleController : ApiController
{
    // GET api/example
    [NoLog]
    public Example Get()
    {
       //
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-06T22:08:11.097

对于仍然潜伏的任何人，我想使用 Ninject 的原因是我可以将记录器（或其他任何东西）注入拦截器，但我想拦截所有操作。

马克的答案是完美的，但不是使用全局注册

```
GlobalConfiguration.Configuration.Filters.Add(new TimingActionFilter()); 
```

使用 Ninject 绑定你的过滤器

```
Kernal.BindHttpFilter<TimingActionFilter>(FilterScope.Action). 
```

您需要在 TimingActionFilter 类中创建一个适当的构造函数。

# ruby-on-rails-3 - 在 Rails 3 中使用 has_and_belongs_to_many 关系时的排序记录？

> ID：14062029
> 
> 赞同：1
> 
> 时间：2012-12-27T22:17:56.603
> 
> 标签：ruby-on-rails-3, model, controller, relationship

我第一次尝试在我的 Rails 应用程序中使用 HABTM 关系。下图显示了模型及其相互之间的关系：

![架构](../Images/42208502d661ee811c99ddf8fecb017f.png)

目前，我正在显示一个区域内的所有成员，其中包含以下内容：

```
<% @region.members.each do |member| %>
  <%= link_to member.name, member %>
<% end %> 
```

我正在尝试按成员各自的级别对成员列表进行排序/排序。然后我想让成员按字母降序排列。

因此，members_controller 代码目前是默认的：

```
@members = Member.all 
```

我可以按字母顺序排列结果：

```
@members = Member.order("name DESC").all 
```

但我不知道如何使用相关模型的数据对成员记录进行排序。可能会有三个级别；慈善、基本和订阅。我计划在页面顶部设置一个仅显示订阅成员的块。订阅成员不应再次显示在页面上。

```
@subscribed_members = Member.where(:level == 1).order("name DESC").all 
```

但是，如您所见，我不知道如何逐级过滤该块。

谁能指出我正确的方向，或者可能指向这个教程？我已经阅读了有关 HABTM 关系的 Rails 指南，但它似乎只涵盖了模型。

**编辑**

在尝试了这个建议之后，我现在有以下内容：

```
@members = Member.all
@subscribedmembers = Member.include(:levels)
                         .where("levels.name == 'subscriber'") 
```

如何在区域视图中使用该方法？

```
<% @region.subscribedmembers.each do |member| %>
   <%= member.name %>
<% end %> 
```

那是行不通的，因为它正在寻找一个不存在的名为 subscrivedmembers 的相关模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:07:23.540

对于此类任务，我建议您查看使用`ActiveRecord`. 方法是`include`和`joins`。让我用一段代码演示一下：

```
@subscribed_members = Member.include(:levels)
                            .where("members.url == 'test_url'")
                            .order("levels.name DESC") 
```

如果在运行此查询后检查控制台，您可以看到`include`与两个表进行 SQL 连接。我在这里假设`member :has_many :levels`，因此您包含该表并在您的子句`:levels`中使用前缀列名。 一旦你有了这个想法，这并不难，所以我鼓励你在控制台上尝试这两种方法并检查结果。`order`

**编辑**

使用您的查询代码创建一个范围，然后在任何地方使用它。例子：

```
# On your model
scope :ultimate_level, include(:levels).where("name = 'test'").order("levels.name DESC")

# On your controller
@subscribed = Member.ultimate_level

# On your view
<% @subscribed.each do |s| %> 
```

您也可以创建不同的范围，每个范围都进行一次操作，然后在我们的控制器上重用，等等。 Obs.：检查语法，我自己没有测试代码。

# java - 消除宫缩

> ID：14062030
> 
> 赞同：2
> 
> 时间：2012-12-27T22:18:05.847
> 
> 标签：java, string, text-processing

我想从输入的英文散文字符串中删除所有撇号，但保留原始含义和大写，即

*   不是 --> 不是
*   我是——>我是
*   他们是——>他们是
*   不应该 --> 不应该
*   不能 --> 不能
*   John's --> Johns（足够好）

在java中实现这一目标的最佳/最简单的方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T22:19:37.707

有一个收缩字典`Map<String, String>`，将收缩映射到它们的拼写形式。因为撇号替换的内容没有单一的规则，所以这本字典接近了要走的路。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-27T22:24:37.780

更换宫缩有一些硬性规定。只需有一个在您的字符串上执行这些功能的方法。

```
public String removeContractions(String inputString) { 

    inputString = inputString.replaceAll("n't", " not");
    inputString = inputString.replaceAll("'re", " are");
    inputString = inputString.replaceAll("'m", " am");
    inputString = inputString.replaceAll("'ll", " will");
    inputString = inputString.replaceAll("'ve", " have");

    return inputString;
} 
```

这甚至会保留你的所有格。

当然，也有一些依赖于上下文的缩略语，例如`he'd`. 这可能是“他可以”、“他会”、“他有”等，因此超出了简单的替换算法，更多的是机器学习领域。

```
public String removeControversialContractions(String inputString) {

    inputString = inputString.replaceAll("'d", " would");
    inputString = inputString.replaceAll("'s", "s");

    return inputString;
} 
```

也许`'s`您可以检查包含它的单词是否以大写字母开头（表示名称）并有条件地将其替换为`s`or `is`。但是，这不会在句子开头捕捉到正常的收缩，所以......

如果你想要一个简单*而*完美的方法，我不确定你会得到一个。要完成这些更复杂的事情，您需要一个经常参考的大型字典文件或机器学习技术。

# ios - NSMutableArray 在 for 循环后不保存添加的项目

> ID：14062033
> 
> 赞同：1
> 
> 时间：2012-12-27T22:18:45.913
> 
> 标签：ios, facebook, facebook-graph-api, nsmutablearray, persistent

我尝试进行 Facebook Graph 调用并将一些项目添加到数组中。这些项目被添加到一个 for 循环中，并且数组看起来很好。但是在 for 循环之后，这些项目就消失了。

我将 xcode 4.5 与 Facebook SDK 3.1 一起使用。

我错过了什么？

## 表视图控制器.m

```
#import "TableViewController.h"

@interface TableViewController ()
@end

@implementation TableViewController {
    NSMutableArray *recipes;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    recipes = [NSMutableArray arrayWithObjects:@"Egg Benedict", nil];
    [recipes addObject:@"foobar"];
    NSLog(@"recipes before FBRquestConnection: %@", recipes);

    [FBRequestConnection
     startWithGraphPath:@"search?type=place&center=37.785834,-122.406417"
     completionHandler:^(FBRequestConnection *connection,
                         id result,
                         NSError *error) {
         if (!error) {
             for (id item in [result objectForKey:@"data"]) {
                [recipes addObject:[item objectForKey:@"name"]];
             }
         NSLog(@"recipes after for-loop: %@", recipes);
         NSLog(@"amount of recipes after for-loop: %u", [recipes count]);
         }
     }];
    NSLog(@"amount of recipes after FBRequestConnection: %u", [recipes count]);
} 
```

## 调试控制台输出

```
2012-12-27 23:09:44.056 barbar[3481:19a03] recipes before FBRquestConnection: (
    "Egg Benedict",
    foobar
)
2012-12-27 23:09:44.056 barbar[3481:19a03] amount of recipes after FBRequestConnection: 2
2012-12-27 23:09:44.516 barbar[3481:19a03] recipes after for-loop: (
    "Egg Benedict",
    foobar,
    "Union Square, San Francisco",
    "Benefit Cosmetics",
    "San Francisco | The Official Guide",
    "BareMinerals by Bare Escentuals",
    "Viator.com",
    "Bleacher Report",
    "Downtown San Francisco",
    "AMC Metreon 16",
    "Cheesecake Factory",
    SquareTrade,
    "Westfield San Francisco Centre",
    "Bloomingdale's San Francisco",
    "Macy's San Francisco Union Square",
    Xoom,
    "Parc 55 Hotel",
    "Pottery Barn",
    "AT&T Park",
    Bebo,
    Snapfish,
    "Hilton San Francisco Union Square",
    uTorrent,
    "The Westin St. Francis",
    TRUSTe,
    "Apple Retail Store - San Francisco"
)
2012-12-27 23:09:44.516 barbar[3481:19a03] amount of recipes after for-loop: 26 
```

干杯——杰里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:25:18.757

您的项目将添加到图形调用的完成块中。

当您进行 Api 调用时，它会转到服务器并且不会触发完成块，直到 Web 请求与您的结果一起返回。

因此，当您的最后一行命中时，仍在请求 api 调用并且尚未返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:54:48.450

您的完成块正在随机线程上触发。块背后的想法是设置它并忘记它。我的意思是，您不能保证知道该完成块何时会触发。可能是 2 秒后，也可能是 2 分钟。

为了说明这一点，设置两个断点：一个在 viewDidLoad 方法的顶部，另一个在完成块内，然后开始单步执行代码。您会看到块外的断点被命中。当您逐步进入完成块时，您不会在块内移动。相反，您直接越过它并进入您的最后一个`NSLog`语句，这就是为什么您认为您只得到原始的 2 个对象。继续执行您的程序，块内的断点将被触发。

这应该有助于表明完成块在之后的某个不确定时间被触发，并且您的数组实际上很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:42:31.343

`__block`如果你想让它在块对象中可变，我认为你需要在声明中添加（我曾经遇到过一些问题）。现在范围仅在块内被抑制。

另请查看此链接以获取有关块内变量范围的更多信息。

[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/Blocks/Articles/bxVariables.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/Blocks/Articles/bxVariables.html)

# c++ - 如何使用 Linux Mint 中的 Code::Blocks 使 Qt4 工作

> ID：14062034
> 
> 赞同：4
> 
> 时间：2012-12-27T22:18:54.773
> 
> 标签：c++, linux, qt4, codeblocks, linux-mint

我正在尝试使用 Code::Blocks IDE 来使用 Qt4。我正在运行 Linux Mint，但遇到了一些错误。我环顾四周，发现一些人和我有同样问题的人，但我似乎无法让他们的解决方案在我的电脑上运行。

我使用命令安装了 Qt4

```
sudo apt-get install qt4-dev-tools 
```

当我输入时`whereis qt4`，我得到`qt4: /usr/lib/qt4 /usr/include/qt4 /usr/share/qt4`

如果我在 Code::Blocks 中选择“创建新项目”并选择 Qt4 项目，它会询问 Qt 的位置，这是`$(#qt4)`默认情况下的。如果我单击下一步，它会显示 Code::Blocks 不知道“qt4”变量，并提示我设置基本位置、包含目录等。

因为我不知道我应该在那里放什么，因为没有任何作用（或者它说“在指定的目录中找不到 QTCore”，或者找不到“lib”目录等） .

我尝试了这个论坛上发布的内容：[http](http://crunchbang.org/forums/viewtopic.php?id=18210) ://crunchbang.org/forums/viewtopic.php?id=18210 ，但它没有解决我的问题，我得到了同样的错误。

在“/usr/share/qt4”目录中，有一个指向“include”目录的链接，但没有指向“lib”目录的链接。

我对 Linux 和所有这一切都很陌生，所以如果答案非常详细地解释了我做错了什么/我必须做什么，我会很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T17:19:18.780

*   ***安装 QtSDK***
    作为第一步，我建议您从***[这里](http://qt-project.org/downloads)***的项目站点直接下载 QtSDK 。

> 注意：你也可以为你的 Mint 版本使用预编译的版本，但以我个人的经验，在使用外部 SDK 时，你在开发中拥有更多的独立性，它还允许你同时使用多个 Qt 版本，而无需移动任何依赖您的操作系统。

您可以按照图形步骤安装SDK，我建议您选中“下载源”选项，稍后这将用于调试代码，如果有必要将允许重新编译某些类。

现在您的 QtSDK 已安装在文件夹中，例如*“/usr/local”*

因此，IDE 中的所有引用都应引用此位置。

*   ***安装 C::B***
    您可以使用“软件管理器”中可用的版本

*   ***配置 C::B***
    当我们开始一个新项目并询问我们的 SDK 的位置时，我们指出这个目录
    */usr/local/QtSDK/Desktop/Qt/4.8.1/gcc*
    现在项目已经准备好了！

> 注意：“/usr/local”和“4.8.1”是变量，取决于您安装的位置和版本。

* * *

很可能您的构建目录在
“设置->编译器和调试器->工具链...->编译器目录”中未正确分配
将是默认的*“usr”*，应替换为*“/usr/bin”*

[***现在，当使用标准项目“.pro”***](http://doc.qt.digia.com/qt/qmake-project-files.html)进行编译时，如果您的项目需要使用***[“moc”](http://doc.qt.digia.com/qt/moc.html)***工具策略，那么最简单的方法是使用定制的 Makefile，包括所有编译阶段。

要了解如何制作自定义的 makefile，您可以阅读此***[答案](https://stackoverflow.com/questions/14010922/qt-undefined-reference-to-vtable/14013231#14013231)***。

* * *

虽然我会再次建议：

*虽然 CB 是使用 wxWidgets 和一般 C/C++ 的最佳环境，但我个人认为，在使用 Qt 的情况下，QtCreator 提供了一个更加原生和优化的开发环境，可以与您的项目 QT 一起使用。*

# objective-c - 如何动态自动注册 C 函数，使其可以在整个项目中使用，而无需任何导入/标题/外部/.pch 文件？

> ID：14062042
> 
> 赞同：0
> 
> 时间：2012-12-27T22:19:23.907
> 
> 标签：objective-c, dynamic, runtime

在我的项目中，我有一个只有 C 函数的 doSomething.m 和 soSomething.h 文件：

```
void doSomething() {

} 
```

第**一个问题**：我应该怎么做才能让这个函数在我的代码中的任何地方都可以访问，而不需要导入任何头文件？

注意：*我猜想解决这个问题 doSomething.h 文件根本不需要，但它的存在/不存在不是限制。*

我有以下知识，但我无法全面了解所需内容：

*   我可以使用另一个带有**属性（（构造函数））**的函数，它将在编译运行时运行，它可以做一些操作来注册*doSomething*；
*   _class_addMethod_ 在“运行时”添加方法。但我不知道如何解决“全局命名空间的类”；
*   NSObject 的*+ 加载*方法，但在这里不相关。

第一个问题之上的**第二个棘手问题：当我对第一个问题有答案时，我怎样才能防止“函数'doSomething'的隐式声明在C99中无效”完全针对函数***doSomething*而不是针对所有其他问题?

更新：我忘了从考虑中排除以下选项：

1.  .pch 文件，全局标头
2.  我要使用*doSomething*方法的文件**不应包含**任何附加声明，例如*extern void doSomething()*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:29:50.863

好吧，您不能真正做到，因此您不必导入标头，但是您可以做的是将包含添加到您的预编译标头中

查看项目中的“支持文件”文件夹。

你会看到一个像thise这样的文件

```
<ProjectName>-prefix.pch 
```

在此文件的底部添加您的导入。然后每个文件都会在此处添加所有导入。

**笔记**

我使用 Xcode

我想如果你使用另一个 IDE，比如 GnuStep，你可能会有另一个类似的地方。我不知道其他 IDE 是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:29:23.177

在要使用它的文件中，将其导入：

```
extern void doSomething (void); 
```

# javascript - 主干：具有冲突方法的混合

> ID：14062047
> 
> 赞同：1
> 
> 时间：2012-12-27T22:19:49.897
> 
> 标签：javascript, backbone.js, underscore.js

我从这篇文章开始使用 mixins：[Proper way of doing view mixins in Backbone](https://stackoverflow.com/q/7853731/240993)

```
var MyMixin = {
  foo: "bar",
  sayFoo: function(){alert(this.foo);}
}

var MyView = Backbone.View.extend({
 // ...
});

_.extend(MyView.prototype, MyMixin);

myView = new MyView();
myView.sayFoo(); //=> "bar" 
```

除非它在混合中使用冲突方法，否则效果很好：`render()`mixin 和`render()`实际视图中的示例。

我怎样才能先触发 mixin 方法，然后才是实际的视图方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-18T14:03:28.550

我可能会推荐使用[Backbone.Cocktail](https://github.com/onsi/cocktail)，它提供了一种非常简洁的方式来指定 mixins（尊重继承）：

```
var Mixin = {
  initialize: function() {
    console.log("I'll be called as well as the class's constructor!");
  }
};

var View = Backbone.View.extend({
  mixins: [ MyMixin ]
}); 
```

我已经在这篇[博文](http://www.salsify.com/blog/using-cocktail-to-create-mixins-for-backbone-models-that-respect-inheritance/1283)中详细介绍了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:45:17.827

您为什么不简单地使用针对该问题提供的其他答案：[Backbone-Mixin Gist](https://gist.github.com/3652964)？

# c# - 如何在 ASP.NET MVC4 中为两个类编写 LINQ 连接

> ID：14062049
> 
> 赞同：1
> 
> 时间：2012-12-27T22:21:02.867
> 
> 标签：c#, linq, ef-code-first

我在使用 EF Code First 访问连接表中的属性时遇到问题。这是我在家庭控制器中的查询：

```
var pcs = from h in db.Hardwares
    join hwt in db.HardwareTypes 
    on h.HardwareTypeId equals hwt.Id
    where h.HardwareType.HType == "PC"
    select new { Hardware = h, HardwareType = hwt };   

ViewBag.Pcs = pcs.ToList(); 
```

这是我的 HardwareTypes 类：

```
public class HardwareType
    {
        public int Id { get; set; }
        //[Required]
        //[StringLength(128)]
        public string HType { get; set; }

    } 
```

这是我的硬件课：

```
public class Hardware
    {
        public int Id { get; set; }
        public int HardwareTypeId { get; set;}
        public virtual HardwareType HardwareType { get; set; } 

    } 
```

如何更改我的 LINQ 查询，所以`HType`在我的`ViewBag`？数据库似乎生成正确，只是我似乎无法访问`HType`. 我收到一个错误`'object' does not contain a definition for 'HType'`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:42:04.963

好的，是时候完全重置了。根据聊天记录，我希望您尝试以下操作：

1) 保留您原来的 LINQ 查询，但不要将其设为匿名类型。创建另一个对象类型，其中包含 Hardware 和 HardwareType 属性。这将使 Pcs（以及 ViewBag.Pcs）成为该特定类型的列表。

2) 将以下 foreach 循环放入您的视图代码中：

```
foreach (var item in ViewBag.Pcs as List<YourTypeName>)
{
   var htype = item.HardwareType.HType;
} 
```

如果您不想每次通过循环都进行一些延迟加载，您可以在控制器中执行以下操作以立即加载实体：

```
var hardwareTypes = pcs.Select(p => p.HardwareType).ToList(); 
```

让我知道这是否有效。

# c# - RavenDB 使用 JsonIgnore 属性存储属性

> ID：14062054
> 
> 赞同：8
> 
> 时间：2012-12-27T22:21:33.563
> 
> 标签：c#, json, ravendb

对乌鸦来说相当新。但是仅仅阅读一些忽略属性的文档似乎很简单。但是由于某种原因，我不想保存的财产正在被保存。不知道为什么。感谢您的任何帮助或指导。

这是在实体项目中创建的属性（Web 项目解决方案的一部分）

顺便说一句，我在类上没有属性

```
[JsonIgnore]
    public bool AllowedToEdit
     {
         get { return _allowedToEdit; }
         set { _allowedToEdit = value; }
     } 
```

不确定还要发布什么，但此属性正在保存中。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-28T02:13:20.077

如果您使用的是 RavenDB 1.0，这应该可以正常工作。

如果您使用的是 RavenDB 2.0，您需要确保导入 from`Raven.Imports.Newtonsoft.Json`而不是`Newtonsoft.Json`

# php - Composer 警告：缺少 openssl 扩展。如何在 WAMP 中启用

> ID：14062055
> 
> 赞同：136
> 
> 时间：2012-12-27T22:21:37.163
> 
> 标签：php, wampserver, composer-php

尝试通过安装程序在**Win7/64 + WampServer 2.2**上[安装](http://getcomposer.org/download/)[Composer](http://getcomposer.org/)依赖项管理工具，我收到以下消息：

 **> 缺少 openssl 扩展，会降低 Composer 的安全性和稳定性。如果可能，您应该启用它或使用 --with-openssl 重新编译 php

所以这就是我所做的......

1.  从托盘中的我的 Wamp 图标，单击`php > php extensions > php_openssl`
2.  这表明任务已通过在扩展名旁边放置**复选标记完成**
3.  然后我重新启动了 WampServer
4.  然后从托盘中的 Wamp 图标，我单击`php > php.ini`并搜索 openssl 以验证它没有被注释掉）。不是。
5.  然后我回到 Composer-Setup.exe 并再次尝试。**相同的警告消息**：“缺少 openssl 扩展”
6.  从未使用**过**OpenSSL，我不确定应该设置什么，所以我尝试使用 https 浏览到我的本地站点之一。它失败了。

我错过了什么？

请指教。

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2013-01-10T19:32:15.513

WAMP 在 CLI 和 Apache 中使用不同的 php.ini 文件。当您通过 WAMP UI 启用 php_openssl 时，您为 Apache 启用它，而不是为 CLI 启用它。您需要修改 C:\wamp\bin\php\php-5.4.3\php.ini 为 CLI 启用它。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-02-24T10:50:10.063

除了取消注释其他人都提到的`;extension=php_openssl.dll`行之外，您还必须确保该行也未注释。要取消注释，请删除前缀分号并保存。`php.ini``;extension_dir = "ext"`

该行可能已经在 WAMP 和 XAMPP 等软件包中未注释，但它不在 Windows 的普通 PHP 下载中，因此值得验证。此外，您必须`php.ini`通过复制其中一个示例来创建文件，例如复制`php.ini-development`到一个新文件，然后将其命名为`php.ini`. 然后在那里进行这些更改。

另外，将来要安装 PHP 和 Composer 等工具，我建议使用 Chocolatey 包管理器。然后就很简单了`choco install composer`。当然，在使用 choco 方法安装 Composer 之前，您仍然需要编辑 php.ini。在未来的 Windows 版本中，[像 Chocolatey 这样的包管理工具将被嵌入到 Windows](http://www.howtogeek.com/200334/windows-10-includes-a-linux-style-package-manager-named-oneget/)中，就像`apt-get`在 Ubuntu 中一样。开发人员的激动人心的时刻！

无论使用哪种方法，安装 Composer 后，不要忘记重新启动终端。无论您使用的是命令提示符、Bash（与 Git 一起安装）还是 Powershell，您都需要在更新的环境变量生效之前重新启动它。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-03-31T13:59:22.340

即使启用了openssl，我也遇到了同样的问题。问题是 Composer 安装程序正在查看此配置文件：

C:\wamp\bin\php\php5.4.3\php.ini

但是加载的配置文件实际上是在这里：

C:\wamp\bin\apache\apache2.2.22\bin\php.ini

所以我只需要在第一个 php.ini 文件中取消注释它就可以了。这就是默认情况下在我的机器上安装 WAMP 的方式。我没有去改变任何东西，所以这可能也会发生在其他人身上。这与上面奥吉加德纳的回答基本相同，但我只是想指出您可能有两个 php.ini 文件。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-05-19T09:42:51.380

`;extension=php_openssl.dll`在两者中取消注释

```
wamp\bin\php\php5.4.12\php.ini
wamp\bin\apache\Apache2.4.4\bin\php.ini 
```

它会起作用的

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-08-08T04:25:52.537

> *C:\laravel-master>composer create-project laravel/laravel 安装 laravel/laravel (v4.0.6) - 安装 laravel/laravel (v4.0.6) [RuntimeException] 您必须启用 openssl 扩展才能通过 https 下载文件*

我正在使用 EasyPhp（WAMP 类型）。在任务栏中的 EasyPHP 图标中，右键单击并选择配置，然后选择 PHP。我将在记事本中打开`PHP.ini`文件配置，在记事本中搜索查找或`CTRL`+查找`F` 单词`OPENSSL`，您会发现这`;extension=php_openssl.dll`只是删除 ; 并且`extension=php_openssl.dll`是活跃的。

> *C:\laravel-master>composer create-project laravel/laravel 安装 laravel/laravel (v4.0.6) - 安装 laravel/laravel (v4.0.6) 下载: 100% Created project in C:\laravel-master\laravel Loading composer包含包信息的存储库安装依赖项（包括 require-dev）*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-29T17:56:11.353

打开 wamp/bin/apache/apache2.4.4/bin/php config.. wamp/bin/php/php5.4.16/php conf 设置，php-ini 生产，php-ini 开发，phpForApache 找到**extension=php_openssl.dll** 并取消注释通过删除**；**

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-12-11T14:54:32.230

您需要编辑“c:\Program Files\wamp\bin\php\php5.3.13\php.ini”文件搜索：;extension=php_openssl.dll

去掉开头的分号

注意：如果保存文件不起作用，那么您需要以管理员身份对其进行编辑。（在win7上）转到开始菜单，搜索记事本，右键单击记事本，单击“以管理员身份运行”

在作曲家安装窗口中只需单击返回然后下一步（或关闭它并重新开始）它应该可以工作

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-27T15:24:55.593

简短而甜蜜，在`wamp/bin/php/php5.3.13`（或任何 php 版本）中取消注释此行：（
`;extension=php_openssl.dll` 删除`;`）
现在运行 Composer 的命令行安装。你不会有错误。
好走！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-05-26T12:56:39.567

您应该创建一个指向 php.ini 的符号链接。抱歉[俄罗斯链接](http://plutov.by/post/composer_openserver)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-09T11:48:24.767

是的，您必须打开 php.ini 并删除分号才能：

```
;extension=php_openssl.dll 
```

去除 ”;” 像这样，它会工作。

```
extension=php_openssl.dll 
```

快乐编码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-13T02:53:47.797

For installing Composer below steps worked me:(WAMP version 2.4 x64bit)

```
edit ->
**C:\wamp\bin\php\php5.4.12\php.ini**
;;uncomment below line or remove the semicolons ';'
extension=php_openssl.dll

**C:\wamp\bin\apache\Apache2.4.4\bin\php.ini**

extension=php_openssl.dll 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-03-31T14:42:08.410

所有这些答案都很好，但实际上，如果您想了解，如果您希望所有未注释的扩展都能正常工作，则扩展目录必须是正确的。可以写一个物理或相对路径，如

```
extension_dir = "C:/myStack/php/ext" 
```

或者

```
extension_dir = "../../php/ext" 
```

它相对于 httpd.exe Apache Web 服务器 (C:\myStack\apache\bin) 但如果您希望它与**Composer**或任何您需要的**物理路径**一起使用，因为 cli 模式不使用 Web 服务器！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-01-16T18:50:36.850

我面临着同样的问题。我将我的 php 文件夹从 php 重命名为`php7_winxxxx`php 并且效果很好。看起来作曲家正在检查 .php_openssl 模块的位置`c:/php/ext`。

您可能还需要添加`c:/php`到`PATH`in 环境变量**

# html - 单击链接时，如何使用 Rails 代码填充 div？

> ID：14062058
> 
> 赞同：2
> 
> 时间：2012-12-27T22:21:47.017
> 
> 标签：html, ruby-on-rails

我正在尝试`li`使用以下代码填充一些标签：

```
<% @events.each do |event| %>
  <li>
    <span class="eventname"><%= event.name %></span>
    <span class="eventlocation"><%= event.location %></span>
  </li>
<% end %> 
```

我有一些链接说“今天”、“明天”等，当我今天点击时，我希望今天的事件出现。如果我明天打我希望明天的出现。我通过 AJAX 教程和 javascript 教程到处查看，我完全不知道如何在 rails 中做到这一点。

我考虑的一种方法是让这个代码块成为部分代码，并为每个部分稍微更改它，以便出现我想要显示的特定事件。但是后来我仍然遇到同样的问题，我不确定如何根据点击链接来显示特定的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:54:01.377

我们将有一个局部渲染一组给定事件（任何类型）让我们称之为`_events.html.erb`

**_events.html.erb：**

```
<% events.each do |event| %>
  <li>
    <span class="eventname"><%= event.name %></span>
    <span class="eventlocation"><%= event.location %></span>
  </li>
<% end %> 
```

然后我们将创建一个名为`fetch_events`返回 js 响应的操作。

```
Class EventsController < ApplicationController
  def fetch_events
    @events = Event.where(type: params[:type])
    respond_to do |format|
      format.js
    end
  end
end 
```

当然在 routes.rb

`match 'fetch_events/:type' => 'events#fetch_events', as: :fetch_events`

现在我们构建出来`fetch_events.js.erb`，这个文件将把 id 为“events”的 div 的内容设置为渲染的部分。

**fetch_events.js.erb：**

```
$('#events').html(<%= escape_javascript(render :events, events: @events) %>) 
```

现在在您的页面视图中添加一个具有 id 'events' 的具有 div 将包含响应，而 ajax 可以使用调用`link_to`

```
<%= link_to 'today', fetch_events_path(type: :today),  :remote => true %>
<%= link_to 'tomorrow', fetch_events_path(type: :tomorrow),  :remote => true %> 
```

# c# - 使用 Web API 对 GET 请求进行模型绑定？

> ID：14062059
> 
> 赞同：3
> 
> 时间：2012-12-27T22:21:57.350
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

使用 ASP.NET MVC 4 Web API

```
public IEnumerable<Item> GetAll(GetItemRequest request) { 
```

这会引发错误，*对象引用未设置为对象的实例。*，其中`request`为空。

```
public IEnumerable<Item> GetAll(int itemId) { 
```

这工作得很好，哪里`itemId`是非空的。

`GetItemRequest`模型具有单一属性，`public int itemId { get; set; }`

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T22:25:32.323

尝试这个：

```
public IEnumerable<Item> GetAll([FromUri] GetItemRequest request) { 
```

# android - WIFI_SLEEP_POLICY_NEVER 如何在 API-17 中设置？

> ID：14062068
> 
> 赞同：9
> 
> 时间：2012-12-27T22:23:05.440
> 
> 标签：android

我正在使用以下代码，我的目标是 API-15

```
android.provider.Settings.System.putInt(cr, 
                        android.provider.Settings.System.WIFI_SLEEP_POLICY, 
                        android.provider.Settings.System.WIFI_SLEEP_POLICY_NEVER); 
```

当代码在平台 API-17 上运行时，我在 logcat 中收到警告，

设置 wifi_sleep_policy 已从 android.provider.Settings.System 移至 android.provider.Settings.Global，值不变。

所以在那之后我所做的就是将我的项目目标设置为 APi-17 并使用此代码

```
 if(Build.VERSION.SDK_INT < 17)
        {
            android.provider.Settings.System.putInt(cr, 
                        android.provider.Settings.System.WIFI_SLEEP_POLICY, 
                        android.provider.Settings.System.WIFI_SLEEP_POLICY_NEVER);
        }
        else            
        {               
            android.provider.Settings.Global.putInt(cr, 
                    android.provider.Settings.Global.WIFI_SLEEP_POLICY, 
                    android.provider.Settings.Global.WIFI_SLEEP_POLICY_NEVER);

        } 
```

结果，我开始在平台 Api-17 中关注 SecurityException

```
 java.lang.SecurityException: Permission denial: writing to secure settings requires android.permission.WRITE_SECURE_SETTINGS 
```

然后我检查了 WRITE_SECURE_SETTINGS 权限仅适用于系统应用程序，我无法用它编译我的代码，就好像这个权限只适用于系统应用程序一样。

所以我很困惑我之前得到的警告是错误的，或者我的代码有什么问题，我想让它与 API-17 兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-13T15:39:48.520

不幸的是，从 API-17 开始无法再更改此设置，因为它[已被弃用](http://developer.android.com/reference/android/provider/Settings.System.html#WIFI_SLEEP_POLICY)。

正如您所说，该`WRITE_SECURE_SETTINGS`权限仅授予系统应用程序，因此最好的选择是要求用户从 wifi 设置中手动设置此选项：

```
startActivity(new Intent(Settings.ACTION_WIFI_SETTINGS)); 
```

# java - 在运行时将休眠事件侦听器注册到带注释的实体

> ID：14062074
> 
> 赞同：2
> 
> 时间：2012-12-27T22:23:54.433
> 
> 标签：java, hibernate, hibernate-4.x, event-listener

我想将事件侦听器注册到我在运行时选择的一些实体。

我创建了一个名为 @LocalableEntity 的注释，并通过谷歌反射 api 获取注释实体，所以我想向它们添加事件侦听器。

我的代码在这里；

```
@Component
public class HibernateEventWiring {

@Autowired
private SessionFactory sessionFactory;

@Autowired
private LocalizationListener listener;

@PostConstruct
public void registerListeners() {

    Reflections reflections = new Reflections("my.project.prefix");
    EventListenerRegistry registry = ((SessionFactoryImpl) sessionFactory).
                                       getServiceRegistry().
                                       getService(EventListenerRegistry.class);

     Set<Class<?>> annotated =  reflections.
                                getTypesAnnotatedWith(LocalableEntity.class);

     for(Class<?> clazz : annotated) {

         // I want to add listener to these annotated classses

     }

    // this code line registering listener for all entities
    registry.getEventListenerGroup(EventType.PRE_LOAD).appendListener(listener);

    }  
} 
```

那么，我该怎么做呢？

# jquery - 将链接附加到新链接

> ID：14062076
> 
> 赞同：1
> 
> 时间：2012-12-27T22:24:04.287
> 
> 标签：jquery, href

我一直在将 onclick 函数用于指向外部站点的链接：

```
<a href="http://outsidelink.net" target="_blank" onclick="return confirm('You will now be transfered to a third party website');">External Link</a> 
```

但我后来使用 jQuery 创建了一个类似“灯箱”的版本，通知用户他们要去另一个第三方网站。我不想每次都手动将每个链接复制到新的灯箱中。我宁愿从页面上的链接中复制 href 并将其添加到我的灯箱中的“继续”按钮。

我将如何获取这样的链接：

```
<a class="outsidelink" href="http://outsidelink.net">External Link</a> 
```

并将其添加到我有“CopiedLink”的灯箱中：

```
<div id="container">
<div id="textbox">
<a id="nothanks" href="#">Close</a>
<p>You are about to leave the site and go to a third party website.</p>
<a id="newlinkontheblock" href="CopiedLink" target="_blank">Continue</a>
</div>
</div> 
```

我已经创建了创建灯箱的 .click 函数，我只是不知道如何从页面中获取链接并将其插入到新创建的灯箱中。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:30:45.873

像这样的事情应该这样做

```
$('a.outsidelink').click(function(e){
   // cancel default action of link so that it is not followed
   e.preventDefault();

   // open light box here

   // then
   $('#newlinkontheblock').attr('href', this.href);
}); 
```

# linux - 将公钥添加到服务器的 authorized_keys 文件后，我应该删除它吗？

> ID：14062078
> 
> 赞同：1
> 
> 时间：2012-12-27T22:24:11.197
> 
> 标签：linux, security, ssh, cryptography, openssh

我已经使用公钥/私钥对设置了 ssh 登录。我的目录中有我的`id_rsa`（私钥） ，并且同一个目录中`~/.ssh`还有`id_rsa.pub`（公钥）。我不是安全专家，但有人告诉我将两个密钥保存在同一个目录中不是一个好主意？

将公钥文件添加到服务器文件后删除它是一个好习惯`authorized_keys`吗？如果保留公钥没有害处，我应该将其移动到不同的目录吗？

我能想到的一个缺点是，如果我想通过 ssh 连接到不同的服务器，就必须重新生成公钥/私钥对。为不同的服务器生成新的公钥/私钥对是一种好习惯吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:40:13.200

您的密钥的“秘密”部分需要保持安全 - 在您的主目录中是通常的位置。公钥是要共享的，这就是它公开的全部意义。

因此，请确保您的 .ssh 目录始终受到安全保护。

公钥不是秘密的，因此虽然您可以根据需要删除它，但它并没有多大帮助，因为任何可以读取 authorized_keys 的人都可以得到它......它在全视图中。

显然，删除您的私钥意味着您必须制作一对新的私钥。但是只有拥有您私钥的人才能进入您的帐户 - 并且只有在该机器上的 authorized_keys 中[当然，可以从一个地方复制到另一个地方！]

总结：如果您想节省磁盘空间，请删除公钥。但这并不重要——它就在线路的另一端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T07:03:50.620

它可能不是这个问题的相关答案，但您可以通过使用 iptables 过滤特定客户端（如果它们的 IP 保持固定）来允许 SSH 访问。因此，如果密钥被盗，您的防火墙可以帮助您。

# c# - Visual Studio 查找代码路径/执行路径

> ID：14062081
> 
> 赞同：6
> 
> 时间：2012-12-27T22:24:33.933
> 
> 标签：c#, visual-studio

我正在寻找一个 Visual Studio 插件，它将使查找代码路径的任务更容易。基本上，我想要的东西可以找到所有参考资料的所有参考资料，所有参考资料......

例如，我有几十个表单和几十个 Web 服务。我想映射哪个表单会调用什么 Web 服务，而不是右键单击 Web 服务并通过多个层一遍又一遍地查找所有引用。

这个工具甚至存在吗？我知道会找到未使用的代码，但没有一个会显示执行路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:17:49.227

我最终选择了[NDepend](http://www.ndepend.com/)。它完全符合我的需要，生成依赖关系图，并有多种方式来导出它以及可视化依赖关系。此外，我发现 CQLinq 查询在减少噪音方面非常强大，只找到我感兴趣的依赖项并在必要时跳过不同的层。

# ios - 带有外部 GPS 的 CLLocationManager/MKMapView

> ID：14062083
> 
> 赞同：1
> 
> 时间：2012-12-27T22:24:40.707
> 
> 标签：ios, gps, mkmapview, external, cllocationmanager

我收到多个用户的报告，称他们的外部 GPS 装置（主要是 Bad Elf）无法与我的支持 GPS 的应用程序配合使用。我没有对 GPS 单元进行任何手动检测；该应用程序假定设备有一个单元，如果没有找到位置，只会显示错误。我的问题是：

是否需要进行任何其他设置以允许 CLLocationManager 和 MKMapView 与没有内部 GPS 单元的设备上的外部 GPS 交互？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:45:39.363

我认为你对此无能为力。这是 Apple 和 GPS 供应商的问题。您正在使用 API 访问内部 GPS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:57:52.783

正如 Till 在他的评论中指出的那样，这似乎是 iOS 6 的一个问题。您可以[在此处](http://www.hiltonsoftware.com/iOS6-GPSIssue.html)以及他提供的链接中阅读有关它的更多信息。

# php - PHP reCaptcha 不会验证

> ID：14062088
> 
> 赞同：0
> 
> 时间：2012-12-27T22:25:05.507
> 
> 标签：php, recaptcha

我正在尝试让 reCaptcha 使用我网站上的表单，但由于某种原因，我不断收到错误，提示输入了错误的验证码。有人看到我的代码有什么问题吗？

```
require_once('includes/recaptchalib.php');

$publickey = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
$privatekey = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";

if (isset($category)) {
    if ($edit == 'edit') {
    include "includes/updatelisting.php";
    } else {
    $response = recaptcha_check_answer($privatekey,
        $_SERVER["REMOTE_ADDR"],
        $_POST["recaptcha_challenge_field"],
        $_POST["recaptcha_response_field"]);

        if ($response->is_valid) {
                include "includes/insertlisting.php";
        } else {
        echo "Eh, That wasn't right. Try Again.";

        }
     }

} else { 
```

这是实际形式的代码..

```
// Display the reCaptcha form
    echo recaptcha_get_html($publickey, $error); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:05:35.447

我发现了这个问题。显然我的标签在标签内。一旦我将表单标签放在表格标签之外，一切都会完美无缺。很奇怪。这是我找到的答案的链接 [需要 reCAPTCHA 的帮助 - 不断收到不正确的验证码溶胶](https://stackoverflow.com/questions/1264703/need-help-with-recaptcha-keep-getting-incorrect-captcha-sol)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:50:46.800

当你打电话`echo recaptcha_get_html($publickey, $error);`时，你已经`$error`声明了吗？

您可能想先声明它（是的，将其设为一个带空格的字符串）：

```
$error = ' ';
echo recaptcha_get_html($publickey, $error); 
```

`$category`另外，在尝试验证之前检查是否真的设置了。

# java - 费马小定理的实现问题

> ID：14062089
> 
> 赞同：1
> 
> 时间：2012-12-27T22:25:07.197
> 
> 标签：java, primes

这是我对费马小定理的实现。有谁知道为什么它不工作？

以下是我遵循的规则：

*   设 n 为测试素数的数。
*   选择 2 到 n-1 之间的任何整数 a。
*   计算 a^n mod n。
*   检查是否 a^n = a mod n。

我的代码：

```
int low = 2;
int high = n -1;
Random rand = new Random();

//Pick any integer a between 2 and n-1.
Double a = (double) (rand.nextInt(high-low) + low);

//compute:a^n = a mod n
Double val = Math.pow(a,n) % n;

//check whether a^n = a mod n   
if(a.equals(val)){
return "True";
}else{
return "False";
} 
```

这是一个小于 100000 的素数列表。每当我输入这些数字中的任何一个时，我得到的不是“真”，而是“假”。

[前 100,008 个素数](http://primes.utm.edu/lists/small/100000.txt)

这就是我认为代码不起作用的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:00:31.837

在 java 中，双精度只有 15 到 17 位的有限精度。这意味着虽然您可以计算 的值`Math.pow(a,n)`，但对于非常大的数字，您无法保证一旦该值超过 15 位，您就会得到准确的结果。

对于较大的 a 或 n 值，您的计算将超过该限制。例如 `Math.pow(3, 67)`，将有一个值，`9.270946314789783e31`表示最后 3 之后的任何数字都将丢失。因此，在应用模运算后，您无法保证得到正确的结果（[示例](http://www.wolframalpha.com/input/?i=%283%5E67%29%20mod%2067)）。

这意味着您的代码实际上并没有测试您认为它所做的事情。这是浮点数工作方式所固有的，您必须更改保存值的方式才能解决此问题。您可以使用`long`，但随后您会遇到溢出问题（`2^64 - 1`如果您遇到另一个问题，long 不能再次保存大于此的值`3^67`。

一种解决方案是使用一个设计来保存任意大数字的类，例如[Java SE API](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)`BigInteger`的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:42:29.523

正如其他人所指出的，夺取权力会很快溢出。例如，如果您选择一个数字 n 来测试小到 30 的素数，而随机数 a 是 20，则 20^30 = 大约 10^39，即 >> 2^90。（我取了 10^39 的 ln）。

您想使用[BigInteger](http://docs.oracle.com/javase/6/docs/api/)，它甚至具有您想要的确切方法：

```
public BigInteger modPow(BigInteger exponent, BigInteger m) 
```

“返回一个 BigInteger，其值为 (this^exponent mod m)”

另外，我认为测试 2 到 n-1 之间的单个随机数不会“证明”任何事情。您必须遍历 2 和 n-1 之间的所有整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-19T03:53:19.463

@evthim 即使您使用了 BigInteger 类的 modPow 函数，您也无法获得正确选择的范围内的所有素数。为了进一步澄清问题，您将获得该范围内的所有质数，但您拥有的一些数字不是质数。如果您使用 BigInteger 类重新排列此代码。当您尝试所有 64 位数字时，一些非素数也会写入。这些数字如下；

341, 561, 645, 1105, 1387, 1729, 1905, 2047, 2465, 2701, 2821, 3277, 4033, 4369, 4371, 4681, 5461, 6601, 7957, 8321, 8481, 8911, 10261, 10585, 11305, 12801, 13741, 13747, 13981, 14491, 15709, 15841, 16705, 18705, 18721, 19951, 23001, 23377, 25761, 29341, ... [https://oeis.org/a001567](https://oeis.org/a001567)

161038, 215326, 2568226, 3020626, 7866046, 9115426, 49699666, 143742226, 161292286, 196116194, 209665666, 213388066, 293974066, 336408382, 376366, 666, 566, 566, 666 2001038066, 2138882626, 2952654706, 3220041826, ... [https: //oeis.org/a006935](https://oeis.org/a006935)

作为一种解决方案，通过从下面的链接获取这些数字的列表，确保您测试的数字不在此列表中。 [http://www.cecm.sfu.ca/Pseudoprimes/index-2-to-64.html](http://www.cecm.sfu.ca/Pseudoprimes/index-2-to-64.html)

C#的解决方案如下。

```
public static bool IsPrime(ulong number)
{
    return number == 2 
        ? true 
        : (BigInterger.ModPow(2, number, number) == 2 
            ? (number & 1 != 0 && BinarySearchInA001567(number) == false) 
            : false)
}

public static bool BinarySearchInA001567(ulong number)
{
    // Is number in list?
    // todo: Binary Search in A001567 (https://oeis.org/A001567) below 2 ^ 64
    // Only 2.35 Gigabytes as a text file http://www.cecm.sfu.ca/Pseudoprimes/index-2-to-64.html
} 
```

# php - 使用 PDO 时出现爆炸字符串数组的问题

> ID：14062094
> 
> 赞同：3
> 
> 时间：2012-12-27T22:25:18.637
> 
> 标签：php, pdo, implode

问题是，当我执行 a 时，`var_dump()`我收到了所需的结果，但是当 PDO 处理它时，它跳过了一个数组条目，似乎我没有收到所需的结果。

```
 $bd = $userObj->fetchPanel(array('category_id'=>$cdata['id']));
                //echo '<pre>'; var_dump($bd); echo '</pre>';die;
                $barr = array();
                if(count($bd) > 0){
                foreach($bd as $bval){
                    $barr[] = $bval['id'];              
                }}

               echo '<pre>'; var_dump(implode(',', $barr)); echo '</pre>'; 
```

`var_dump()`返回 - `string(7) "270,498"`- 这是想要的。

```
 $bragdataarr = $db->dbh->prepare("SELECT p.id,p.brag,p.brag_desc,p.brag_id,p.user_id, p.panel_id,p.domainurl,p.type,p.price FROM ".USERS_BRAG." as p left join ".USERS." as u on p.user_id=u.id WHERE u.status !=0 AND p.panel_id IN (:imp) AND p.status = :status ORDER BY p.id DESC LIMIT :lim, :page");

                echo '<pre>'; var_dump(implode(',', $barr)); echo '</pre>'; 
```

`var_dump()`返回 - `string(7) "270,498"`- 这是想要的。

```
 $imp = implode(',',$barr);

                echo '<pre>'; var_dump($imp); echo '</pre>'; 
```

`var_dump()`返回 - `string(7) "270,498"`- 这是想要的。

```
 $brgdataarr->bindValue(':imp',$imp ? $imp : "",PDO::PARAM_STR);

echo '<pre>'; var_dump($bragdataarr->bindValue(':imp',$imp ? $imp : "",PDO::PARAM_STR)); echo '</pre>'; 
```

`var_dump()`返回 - `bool(true)`- 这是想要的。但是，显示的只是字符串“270”而不是“270,498”。为什么会这样？

```
 $brgdataarr->bindValue(':status',1, PDO::PARAM_INT);                
                $brgdataarr->bindValue(':lim',$limit_start, PDO::PARAM_INT);
                $brgdataarr->bindValue(':page',$page_records, PDO::PARAM_INT);                  
                $brgdataarr->execute();                
                $brgdataarr = $brgdataarr->fetchAll(PDO::FETCH_ASSOC); 
```

从我的故障排除中，我发现只有在使用`bindValue()`implode 时才会发生这种情况。如果我在 SQL 语句中包含 implode，则 implode 可以正常工作，但是当 implode 遇到它时，我会收到空​​字符串错误。

例子：

```
 $brgdataarr = $db->dbh->prepare("SELECT p.id,p.brag,p.brag_desc,p.brag_id,p.user_id, p.panel_id,p.domainurl,p.type,p.price FROM ".USERS_BRAG." as p left join ".USERS." as u on p.user_id=u.id WHERE u.status !=0 AND p.panel_id IN (".implode(',',$barr).") AND p.status = :status ORDER BY p.id DESC LIMIT :lim, :page"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:07:08.107

我认为这是因为您对整数集的引用。此外，您的 LIMIT 语法可能有错字。让我们使用标准的 LIMIT :limit OFFSET :offset 语法，更具可读性并且与每个数据库兼容。

```
$imp = $imp? implode(',',array_map($imp,array(PDO,'quote'))):"'-1'";

$brgdataarr = $db->dbh->prepare("SELECT p.id,p.brag,p.brag_desc,p.brag_id,p.user_id, p.panel_id,p.domainurl,p.type,p.price FROM ".USERS_BRAG." as p left join ".USERS." as u on p.user_id=u.id WHERE u.status !=0 AND p.panel_id IN (".$imp.") AND p.status = :status ORDER BY p.id DESC LIMIT :lim OFFSET :page"); 
```

# c# - Typemock 假收集处理

> ID：14062097
> 
> 赞同：2
> 
> 时间：2012-12-27T22:25:40.473
> 
> 标签：c#, c#-4.0, typemock

```
foreach (BeamCluster cluster in executionContext.RevitModel.Beams
                                .Where(b => b.Walls.Values
                                                   .Contains(executionContext.Frame.Wall)))
        { 
```

鉴于上面的一段代码，我将如何使用 type mock 将信息输入 IEnumerable 以便我也可以使用假货来制作横梁、框架和墙壁？

Beams 是一本字典。

executionContext 的类型是 TooLongContext

```
TooLongContext context = Isolate.Fake.Instance<TooLongContext>(Members.ReturnRecursiveFakes);
Isolate.WhenCalled(() => context.RevitModel.Beams).ReturnRecursiveFake(); 
```

在此之后我很困惑（也许在此之前我很困惑:)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:28:28.583

您需要先自己创建一个 IEnumerable 梁和墙等。Typemock（和其他模拟框架）不会自动生成有用的数据。当您让它们返回递归伪造时，它所做的就是尝试确保没有任何内容返回 null（通常通过返回所有内容的默认值）。这只防止空引用异常，并且对于很多测试用例来说并不是那么有用。

所以你需要做的就是改变你的上下文返回的内容。

```
var myFakeBeams = new List<Beam>();
//Add a bunch of fake beams
Isolate.WhenCalled(() => context.RevitModel.Beams).WillReturn(myFakeBeams); 
```

其他类型依此类推。

# ruby-on-rails - 如何配置Ruby God监控> 1个进程？

> ID：14062098
> 
> 赞同：2
> 
> 时间：2012-12-27T22:25:41.277
> 
> 标签：ruby-on-rails, ruby, god

我正在使用 God gem 来监视我的进程，并且我已经在这样的文件（名为 config.god）中为 1 个进程设置了监视

```
rails_env = ENV['RAILS_ENV'] || "development"
rails_root = ENV['RAILS_ROOT'] || "/data/buzzsumo2/current"

God.watch do |w|

     w.dir      = "#{rails_root}"
     w.name     = "sidekiq"
     w.interval = 30.seconds
     w.env      = {"RAILS_ENV" => rails_env}
     w.interval = 30.seconds
     w.start = "bundle exec sidekiq -C #{rails_root}/config/sidekiq.yml"
     w.keepalive

     #more logic for transitioning states

end 
```

**我通过运行bundle exec god -c config.god**开始这个过程，并且可以通过运行**bundle exec god restart sidekiq 重新**启动它。

现在，如果我想再监视另一个名为“sidekiq2”的进程，如何将它添加到同一个上帝文件中？基本上，我希望能够使用上帝启动和重新启动 2 个进程。请注意，这两个进程可以同时运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T03:08:52.067

对于现有的运行上帝配置，您可以添加另一个进程`god load sidekiq2.god`，然后`god restart sidekiq2`使用 sidekiq2 进程的详细信息创建 sidekiq2.god。

# php - PHP RegEx 和 preg_match_all() 问题

> ID：14062099
> 
> 赞同：1
> 
> 时间：2012-12-27T22:25:52.713
> 
> 标签：php, regex

我有一个格式错误的文件：

```
 ================================================
    Header of file with date and time
    ================================================
    Loaded options from XML file: 'path/to/file/some_file.xml
    extendedPrintPDF started
    extendedPrintPDF: Error: Unsaved documents have no full name.; line: 332
    ================================================
    Header of file with date and time
    ================================================
    Error opening document: path/to/file/some_file1: Error: Either the file does not exist, you do not have permission, or the file may be in use by another application; line: 190
    Error opening document: path/to/file/some_file2: Error: Either the file does not exist, you do not have permission, or the file may be in use by another application; line: 190 
```

我在用

```
 preg_match_all('/Error: (.*)/m', $file_data, $erroenames,PREG_PATTERN_ORDER); 
```

获取数组中的所有错误。对于第一组中的错误，它似乎工作正常。但是，以“错误打开文档”开头的第二组错误似乎显示为数组的单个元素，因此，我只有 4 个数组元素而不是 9 个。但是，当我在[http上尝试相同的事情时://www.spaweditor.com/scripts/regex/index.php](http://www.spaweditor.com/scripts/regex/index.php)，所有错误都显示为数组的不同元素，我得到 9 个元素。有人可以告诉我我做错了什么吗？我尝试使用 | 并为“打开文档时出错”再创建一个正则表达式。但是，即使这样似乎也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T17:19:39.937

您可以尝试以下方法：

```
/error[^:]*: ([^:\n]+(?:line:\s*\d+)?)/i 
```

这将出现各种错误并在下一个 : 或行结束时停止，然后回溯将启动并为您提供行号（如果有）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:42:58.193

我怀疑第二组数据中行尾的 \r 和/或 \n 字符，因为，是的，这应该有效。尝试在十六进制编辑器中查看输出文件。

另一个想法是使用锚点和非贪婪 *.

```
'/Error: (.*?)$/m' 
```

# sql-server - 从 .bak 文件设置 AWS RDS MSSQL 实例

> ID：14062101
> 
> 赞同：1
> 
> 时间：2012-12-27T22:25:52.920
> 
> 标签：sql-server, amazon-web-services, amazon-rds

我正在尝试在 Amazon 的 RDS 系统上建立一个 MSSQL 数据库。我有一个数据库实例作为 S3（和本地文件系统）上的 .bak 文件。我不知道如何用这个 .bak 文件填充数据库。是否有易于访问的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:37:55.430

Amazon RDS for SQL Server 不允许您通过备份文件导入数据。

您的选择是：

*   生成和发布脚本向导
*   导入和导出向导
*   批量复制功能

Amazon RDS 用户指南很好地解释了如何使用所有三个选项执行此操作。[见这里](http://docs.amazonwebservices.com/AmazonRDS/latest/UserGuide/ImportData.SQLServer.Import.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-24T22:59:40.567

AWS 现在支持从 S3 中的 bak 恢复 MS SQL 数据。附上一个包含所有所需步骤的链接：

[https://trailheadtechnology.com/blog/restoreing-a-sql-server-backup-to-amazon-rds](https://trailheadtechnology.com/blog/restoring-a-sql-server-backup-to-amazon-rds)

这也是 AWS 的官方文档：

[http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/SQLServer.Procedural.Importing.html](http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/SQLServer.Procedural.Importing.html)

# hlsl - 如何在球体上应用柏林噪声？

> ID：14062107
> 
> 赞同：2
> 
> 时间：2012-12-27T22:26:25.680
> 
> 标签：hlsl, pixel-shader, perlin-noise

我正在尝试在*HLSL*中为*XNA*项目创建动画太阳。

我正在使用从[这个站点学到的](http://freespace.virgin.net/hugo.elias/models/m_perlin.htm)**Perlin Noise**算法在像素着色器中生成它的纹理。

这是我为像素着色器编写的 hlsl 代码：

```
sampler myTexture;

struct VS_Output{
   float4 Position : POSITION0;
   float4 Color : COLOR0;
   float2 TextCoord : TEXCOORD0;
};

float CosineInterpolation( float x, float y, float fractional ) {
   float ft = 3.141592f * fractional;
   float f = ( 1.0f - cos( ft ) ) * 0.5f;

   return x * ( 1.0f - f ) + y * f;
}

float Noise(float2 xy)
{
    float2 noise = (frac(sin(dot(xy ,float2(12.9898,78.233)*2.0)) * 43758.5453));
    return abs(noise.x + noise.y) * 0.5;
}

float SmoothNoise( float integer_x, float integer_y ) {
   float corners = ( Noise( float2(integer_x - 1, integer_y - 1) ) + Noise( float2(integer_x + 1, integer_y + 1 )) + Noise( float2(integer_x + 1, integer_y - 1 )) + Noise( float2(integer_x - 1, integer_y + 1 )) ) / 16.0f;
   float sides = ( Noise( float2(integer_x, integer_y - 1 )) + Noise( float2(integer_x, integer_y + 1 )) + Noise( float2(integer_x + 1, integer_y )) + Noise( float2(integer_x - 1, integer_y )) ) / 8.0f;
   float center = Noise( float2(integer_x, integer_y )) / 4.0f;

   return corners + sides + center;
}

float InterpolatedNoise( float x, float y ) {
   float integer_x = x - frac(x), fractional_x = frac(x);
   float integer_y = y - frac(y), fractional_y = frac(y);

   float p1 = SmoothNoise( integer_x, integer_y );
   float p2 = SmoothNoise( integer_x + 1, integer_y );
   float p3 = SmoothNoise( integer_x, integer_y + 1 );
   float p4 = SmoothNoise( integer_x + 1, integer_y + 1 );

   p1 = CosineInterpolation( p1, p2, fractional_x );
   p2 = CosineInterpolation( p3, p4, fractional_x );

   return CosineInterpolation( p1, p2, fractional_y );
}

float CreatePerlinNoise( float x, float y ) {
    float result = 0.0f, amplitude = 0.0f, frequency = 0.0f, persistance = 0.1f;

    for ( int i = 1; i <= 4; i++ ) {
       frequency += 2;
       amplitude += persistance;

       result += InterpolatedNoise( x * frequency, y * frequency ) * amplitude;
    }

    return result;
}

float4 ps_main(VS_Output Input) : COLOR0
{  
   float index = CreatePerlinNoise(Input.TextCoord.x*256.0f, Input.TextCoord.y*256.0f);
   return tex2D(myTexture, index);
} 
```

基本上，在这段代码中，通过将纹理坐标分量 ( `TextCoord`) 传递给`CreatePelinNoise`函数，它返回一个用作渐变纹理颜色索引的值 ( `myTexture` *1px x 256px* )：

![在此处输入图像描述](../Images/24708fab2439868288c89ca97c4aa8e1.png)

*AMD RenderMonkey*中的结果如下：

![在此处输入图像描述](../Images/502eaa09f2394a72a83abededfcc6d78.png)

但是在球体的两极有一个难看的不需要的效果，这使得生成的纹理不均匀：

![在此处输入图像描述](../Images/b8622224f37185a2c371458da9012d83.png)

如何解决这个问题并使生成的纹理均匀？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:08:26.990

发生这种情况是因为您将噪波函数视为 2D 纹理，如果投影到球体上，*它将被拉伸/扭曲。*您基本上是在像素着色器中实时生成 2D 纹理，然后将其应用于球体。

如果您真的了解 Perlin Noise 原则，那么您可以将您的代码推广到两个以上的维度。Ken Perlin 本人在发明噪声算法时也有同样的想法；[用他自己的话说](http://www.noisemachine.com/talk1/3.html)，“将对象浸入程序纹理（噪声）材料的汤中”。

只需使用像素坐标作为 3D 噪声函数（您的 float4 Position 变量）的输入，保持颜色映射代码不变。这应该会产生预期的效果。顺便说一句，如果您想让它动画化，请将其推广到 4D 并随时间改变第 4 个参数。如果做得好，它应该会产生一个很好的“熔岩星球”效果（查看 Perlin 的幻灯片以获取更多信息）。

哦，还有一个加速提示：不要使用余弦插值，而是使用著名的 3*t^2-2*t^3 插值曲线。在 0 和 1 之间，它看起来几乎与谐波相同，但计算成本更低。

# android - 第三方应用程序如何获得我的自定义服务权限来启动我的服务？

> ID：14062108
> 
> 赞同：0
> 
> 时间：2012-12-27T22:26:47.473
> 
> 标签：android, android-intent, android-manifest, android-service, android-permissions

这是我的清单文件和我的后台服务声明

```
......
    <service android:name="com.example.MyService" 
               android:process=":service" 
               android:permission="android.permission.BIND_VPN_SERVICE">

         <intent-filter>
            <action android:name="com.example.START_MY_SERVICE" />
         </intent-filter>
...... 
```

1.  有兴趣与我的服务绑定的第 3 方应用程序应在其清单中声明什么？
2.  另外，当第 3 方应用程序尝试绑定到我的服务时，权限（或自定义权限）的验证如何在我的应用程序中进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:32:22.083

> 这是我的清单文件和我的后台服务声明

首先，不要在没有充分理由的*情况下使用单独的进程。*

其次，不要为自己的目的重复使用 Android 标准权限，除非这些目的*与*Android 使用该权限保护的内容密切相关。您应该只要求`BIND_VPN_SERVICE`您的应用程序将执行与 VPN 相关的事情，例如代表调用者绑定 VPN。

> 有兴趣与我的服务绑定的第 3 方应用程序应在其清单中声明什么应在其清单中声明？

```
<uses-permission android:name="android.permission.BIND_VPN_SERVICE" /> 
```

> 另外，当第 3 方应用程序尝试绑定到我的服务时，我的应用程序中的权限验证是如何发生的？

当有人来电`startService()`或`bindService()`使用`Intent`标识您的服务时，Android 会自动为您处理。如果调用者不持有列出的权限`android:permission`，他们将获得一个`SecurityException`.

# vim - 是否可以在vim中格式化Ctrl-g的结果？

> ID：14062109
> 
> 赞同：3
> 
> 时间：2012-12-27T22:26:56.993
> 
> 标签：vim

是否可以更改进入`<c-g>`'s 输出的内容？具体来说，我想将电流添加`filetype`到输出中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T00:22:22.030

您可以通过使用映射重载命令来做到这一点。由于`:file`与 相同`<C-g>`，因此我们使用它；它为我们节省了`:normal`：

```
:nnoremap <silent> <C-g> :file<Bar>echon ' ' &filetype<CR> 
```

# php - 如何找到 php 数组的新附加键值？

> ID：14062110
> 
> 赞同：0
> 
> 时间：2012-12-27T22:27:00.247
> 
> 标签：php, arrays

我有一个存储照片信息的类。它有一堆公共的“getter”和“setter”来让我诚实。当像这样公开添加有关照片的评论时：

```
$photo->addComment('Blue'); 
```

该类将调用另一个函数，该函数会将评论添加到私有评论数组中，如下所示：

```
$comments[] = array('comment'=>$new_comment,'time'=>$new_time,'user'=>$new_user); 
```

`$key`确定刚刚创建的新版本以`echo $comments[$key]['comment'];`打印“蓝色”的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:29:36.403

试试这个：

```
$key = sizeof($comments) - 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T22:31:59.570

您可以使用该`end`功能（[http://php.net/manual/en/function.end.php](http://php.net/manual/en/function.end.php)）。

如果您的目标是打印出“蓝色”，这是您最直接的解决方案：

`echo end($comments)['comment']`

[注意：此示例使用 PHP 5.4 ( http://www.php.net/archive/2011.php#id2011-06-28-1](http://www.php.net/archive/2011.php#id2011-06-28-1) )中引入的数组取消引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T22:32:11.540

```
end($comments);
$key = key($comments); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T22:33:44.397

对于更准确的方法，这样的方法可能有效：

```
$keys = array_keys($comments); // get just the keys
$reverse = array_reverse($keys); // reverse order
$lastKey = $keys[0]; // get what is now the first key 
```

将允许索引中的空白

# c# - 关于跨多个服务器从 Code Behind 执行 SQL 作业代理的建议

> ID：14062115
> 
> 赞同：0
> 
> 时间：2012-12-27T22:28:06.437
> 
> 标签：c#, asp.net, sql, stored-procedures, sql-agent-job

所以我有一份在全国 7 个不同服务器上的 7 个不同数据库上运行的工作。该作业不是计划作业，因为我们无法预测每月或每隔一个月何时需要运行它，或者在哪个月的哪一天等。过去，客户端 VPN 连接到每个服务器，然后登录到每个数据库，然后手动启动作业。每个作业有 7 个步骤，每个步骤都将大量数据导出到 excel 文件中，以便稍后导入到仅接受 excel 数据的专有软件中。有点糟糕，但这就是它一直以来的做法。工作开始后我无法更改任何步骤，但我可以通过消除 7 个不同 VPN 连接和另外 7 个服务器登录等的一些初始压力来帮助使事情变得更容易。

我在 C#/.Net 中创建了一个简单的 Web 应用程序，它允许用户选择哪个服务器，然后点击开始按钮，然后这会以某种方式从后面的代码启动 sql 作业。由于我可以将此应用程序放在中央服务器上，因此不需要单独的 VPN 登录或数据库登录。用户所要做的就是登录到网络应用程序来触发一切。我找到了我尝试过的引用，这些引用让我触发了将登录到服务器并通过从 C# 直接访问来启动作业的代码。然而，在所有权限问题和其他错误之间，我觉得这是一个可怕的方向。我发现一些参考资料说我可以执行一些存储过程来触发每台服务器上的作业，这似乎是最简单的方向。

我正在寻找有关完成此任务的最佳方法的建议。我可以只编写一个 proc，然后将其放在每台服务器上，然后根据 web 应用程序下拉列表中选择的服务器，然后它会在该服务器上触发 proc 以开始工作吗？这似乎很容易，而且几乎可以解决一些权限问题。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T14:54:19.140

假设这是 SQL 服务器，您正在寻找的语法是：

> EXEC [msdb].[dbo].[sp_start_job] '要开始的作业的名称'

只要您对存储过程具有执行权限，就不需要其他任何东西。
您可以从您的 .net 代码运行它，或者您可以创建链接服务器并让一个程序为每个服务器触发它。在这种情况下，代码会稍作更改，以包含链接服务器名称：

> EXEC [链接服务器名称].[msdb].[dbo].[sp_start_job] '要启动的作业的名称'

# java - 在Java中通过引用传递数组

> ID：14062118
> 
> 赞同：19
> 
> 时间：2012-12-27T22:28:25.420
> 
> 标签：java, arrays, reference

在 Java 中将数组作为参数传递是否可以，例如`int[5] &result`？

我想传递对数组的引用，因为我想在调用函数中更改数组。语法是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-27T22:31:39.447

```
private void demo() {
    int[] array = new int[5];
    System.out.println(Arrays.toString(array)); // 0, 0, 0, 0, 0
    fillArray(array);
    System.out.println(Arrays.toString(array)); // 0, 1, 2, 3, 4
}

private void fillArray(int[] array) {
    for (int i = 0; i < array.length; i++) {
        array[i] = i;
    }
} 
```

数组是 Java 中的对象。并且对对象的引用是按值传递的。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-12-27T22:34:55.510

在 Java 中，数组是按值传递的，但值是对数组的引用。假设你有一个数组`arr`。传递的时候可以改变`arr`引用的数组，但是不能改变`arr`引用的数组；即在方法内部，您可以修改被引用的对象，但不能修改仍将是对同一对象的引用的传递变量。我将尝试用一个例子来说明：

```
public static void swap(StringBuffer a, StringBuffer b)
{
    StringBuffer t = a;
    a = b;
    b = t;
}

public static void change(StringBuffer a, StringBuffer b)
{
    a = a.append("1");
    b = b.append("2");
}

public static void main(String[] args)
{
    StringBuffer a = new StringBuffer("First");
    StringBuffer b = new StringBuffer("Second");
    swap(a, b);
    System.out.println(a + " " + b);
    change(a, b);
    System.out.println(a + " " + b);
} 
```

输出：

```
First Second
First1 Second2 
```

您可以从`First Second`输出中获得的示例中看到，而不是`Second First`. 这是因为在函数`swap`中使用了对 main 中的引用没有影响的副本。从而说明*您不能修改仍将是对同一对象的引用的传递变量*的事实。但是，该函数`change`会带来预期的效果，因为*您可以修改引用的对象*。

有关更多参考，请参阅：
[Java 是“按引用传递”吗？](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-27T22:30:47.837

Java 是按值传递的。此引用将按值传递，即复制。它仍将指向原始数组。

```
int[] arrayToPass 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-27T22:50:20.980

这可能是一种不受欢迎的思考方式，但我自己是 C/C++ 方面的，它让我更容易。

在 Java 中，**对象是[引用类型](http://en.wikipedia.org/wiki/Reference_type)**。这意味着实际的对象在某处的堆上，而您实际使用的只是对该对象的**引用。**因此，根据 C 指针（作为类比）来考虑它会更简单。

```
Classname object; 
```

在 C/C++ 中的行为类似于以下内容

```
Classname *object; 
```

同样，在函数的情况下，它们的行为就像函数的参数作为指针传递一样。类似于在 C 中模拟传递引用的方式：

```
void Function(Classname object) 
```

它更像是下面的 C 版本

```
void Function(Classname *object) 
```

只要您不更改指针本身的值（在 java 中通过使用新实例重新分配变量），您就可以使用它来访问和修改原始实例。

总而言之，除了原始类型（、、等）之外的*所有*类型都是引用类型（甚至像、、和数组这样的类型）。`int``double``boolean``Integer``Double``Boolean`

因此，正如其他人已经解释的那样，您**不需要添加`&`**它以使其行为符合您的预期（除了某些警告，例如使用新实例重新分配）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T22:45:49.547

可以更改您的函数参数以接受列表吗？

java.util.Arrays 中的静态方法 asList 应该返回一个使用数组作为存储的 List。

```
class Example
{
  public static void changeArray( List t )
  {
    //
  }
}

// a caller
int[] test = new int[5];
Example.changeArray( Arrays.asList( test ) ); //list backed with array 
```

我稍后会对此进行审查。

# c# - 使用 JSON 的 WCF 发布

> ID：14062120
> 
> 赞同：2
> 
> 时间：2012-12-27T22:29:07.463
> 
> 标签：c#, wcf, post

非常奇怪的情况发生在我身上

当我尝试将**某些**内容发布到 WCF 方法并且此**内容**具有 \r 作为两个单独的字符时，实际上我将“域\机器”发送到 WCF。

奇怪的是机器名称以 R 开头，所以我发送的字符串是“domain\r* *** ”，所以当 WCF 收到它时，它假定我想发送代表换行符的 \r，所以它用单个字符替换它. 任何提示如何避免这种情况？

这是函数签名

```
[OperationContract]
[WebInvoke(Method = "POST",
RequestFormat = WebMessageFormat.Json,
ResponseFormat = WebMessageFormat.Json,
BodyStyle = WebMessageBodyStyle.Bare,
UriTemplate = "json/listServer")]
Response ListShares(Request request); 
```

Request 是一个数据协定类，它只有一个数据成员 ServerName，它是字符串类型。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-27T22:37:22.350

出于某种未知原因，将 POST 方法中的 \ 发送到 WCF Web 方法，您需要将其作为 \\\\ 发送，因为 WCF 端的 JSON 解析器将尝试查找其后跟的任何转义字符！

# java - 从 Java 到 SQL 的邻接矩阵

> ID：14062127
> 
> 赞同：0
> 
> 时间：2012-12-27T22:29:40.777
> 
> 标签：java, sql, adjacency-matrix

我在 Java 中有一个字符串数据类型邻接矩阵：

```
String[][] A; 
```

我想将我的邻接矩阵 A 读入 MySQL 表。问题是我永远不知道我需要多少行/列（我也不想创建所有列）。我认为解决这个问题的诀窍是动态创建列。如何“即时”添加列？

一旦我可以动态添加列，我就可以逐行读取矩阵。

1.  我希望能够将数据视为矩阵。

非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:41:16.617

与其费力设置变量列，不如创建一个简单的数据库表 A：

```
row     integer
col     integer
content varchar 
```

这使您可以灵活地轻松避免空条目，并且每个数组项都有一个数据库表行。

你有两个选择：

1.  为数组的每个元素（包括空值）生成一个数据库行，或
2.  为每个不为空的元素生成一个数据库行。

对于选项 1，此代码将提供任何元素：

```
private String getElement(int row, int col) {
    String result = null;
    try {
        if(rs.absolute(row*colNumber+col+1))
            result=rs.getString("content");
    } catch (SQLException ex) {
        System.out.println(ex.getMessage());
    }
    return result;
} 
```

对于选项 2，在 row,col 处的请求元素的内容是这样找到的：

```
private String getElement(int row, int col) {
    String result = null;
    String query = "SELECT * from A where row=? and col=?";
    try {
        PreparedStatement preps = con.prepareStatement(query);
        preps.setInt(1, row);
        preps.setInt(2, col);
        preps.execute();
        rs = preps.getResultSet();
        if (rs.next()) {
            result = rs.getString("content");
        }
    } catch (SQLException ex) {
        System.out.println(ex.getMessage());
    }

    return result;
} 
```

很明显，选项 1 正在更快地访问元素。选项 2 节省数据库空间。

PS：如果你有一个不同长度的数组，选项 1 将不起作用。
**colNumber**是 String 数组的固定列数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:42:19.187

也许您可以在表格中添加列。假设您的表名为“MYTABLE”：在 SQL Server 中，您可以编写：

```
ALTER TABLE MYTABLE ADD COLUMN COLX varchar(255); 
```

其中 X 是您需要的列数。

此选项将允许您在表上添加列，但也许解决方案是创建一个新表，下拉前一个表：

```
DROP TABLE MYTABLE;
CREATE TABLE MYTABLE(COL1 varchar(255), COL2 varchar(255)...); 
```

让我知道这是否是你的问题。谢谢。

# php - 页脚中的 TCPDF QR 码？

> ID：14062131
> 
> 赞同：1
> 
> 时间：2012-12-27T22:30:06.683
> 
> 标签：php, pdf, tcpdf

我正在使用 PHP 脚本 TCPDF .. 有没有办法可以将 QR 码放在 PDF 文件的页脚中？

这就是我用它在页面上显示的方式（不是在页脚或页眉中）

```
$pdf->write2DBarcode('www.tcpdf.org', 'QRCODE,L', 20, 30, 50, 50, $style, 'N');
$pdf->Text(20, 25, 'QRCODE L'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:39:30.313

当然，这是完全可能的，它在示例中：

```
http://www.tcpdf.org/examples/example_050.pdf 
```

根据定义，PDF 文件中没有明确的“页脚”，它只是在特定位置呈现。所以把它放在你放“页脚”的花边上。

您的代码看起来不错（但前提是您的整个代码超过了我假设的这两行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T16:16:50.430

我的问题是，我从类中调用变量 - 这不起作用。我需要在课外创建常量。

```
define('NASLOV', $naslov_pdf_poln);
class MYPDF extends TCPDF {

//Page header
public function Header() {
    // Logo
    $image_file = K_PATH_IMAGES.'logo_mali.jpg';
    $this->Image($image_file, 10, 10, 15, '', 'JPG', '', 'T', false, 300, '',     false, false, 0, false, false, false);
    // Set font
    $this->SetFont('helvetica', 'B', 20);
    // Title
    $this->Cell(0, 15, 'Ultimate Basketball Stats', 0, false, 'C', 0, '', 0, false, 'M', 'M');
    $this->Cell(0,21, 'Ultimate Basketball Stats', 0, false, 'C', 0, '', 0, false, 'M', 'M');
}

// Page footer
public function Footer() {
    // Position at 15 mm from bottom
    $this->SetY(-15);
    // Set font

    $this->SetFont('helvetica', 'I', 8);
    $this->write2DBarcode(NASLOV,'DATAMATRIX', 100, 265, 25, 25, $style, 'N');

    // Page number
    $this->Cell(0, 10, NASLOV, 0, false, 'C', 0, '', 0, false, 'T', 'M');
}
}
$pdf = new MYPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-29T13:21:38.293

我知道这是一个老问题，但以防万一有人降落在这里。

您可以使用， `$pdf->setBarcode( 'abcdef' );`默认情况下，条形码将作为 1DBarcode 包含在 PDF 页脚中。在我的情况下，我更喜欢将条形码作为 QR 码放在徽标旁边的页眉中，并按如下方式自定义默认页眉和页脚：

```
class MYPDF extends TCPDF {
    /**
     * This method is used to render the page header.
     * It is automatically called by AddPage() and could be overwritten in your own inherited class.
     * @public
     */
    public function Header() {
        $barcode = $this->getBarcode();
        if ( $this->header_xobjid === false ) {
            // start a new XObject Template
            $this->header_xobjid = $this->startTemplate( $this->w, $this->tMargin );
            $headerfont          = $this->getHeaderFont();
            $headerdata          = $this->getHeaderData();
            $this->y             = $this->header_margin;
            if ( $this->rtl ) {
                $this->x = $this->w - $this->original_rMargin;
            } else {
                $this->x = $this->original_lMargin;
            }
            if ( ( $headerdata['logo'] ) AND ( $headerdata['logo'] != K_BLANK_IMAGE ) ) {
                $imgtype = TCPDF_IMAGES::getImageFileType( K_PATH_IMAGES . $headerdata['logo'] );
                if ( ( $imgtype == 'eps' ) OR ( $imgtype == 'ai' ) ) {
                    $this->ImageEps( K_PATH_IMAGES . $headerdata['logo'], '', '', $headerdata['logo_width'] );
                } elseif ( $imgtype == 'svg' ) {
                    $this->ImageSVG( K_PATH_IMAGES . $headerdata['logo'], '', '', $headerdata['logo_width'] );
                } else {
                    $this->Image( K_PATH_IMAGES . $headerdata['logo'], '', '', $headerdata['logo_width'] );
                }
                $imgy = $this->getImageRBY();
            } else {
                $imgy = $this->y;
            }
            $cell_height = $this->getCellHeight( $headerfont[2] / $this->k );
            // set starting margin for text data cell
            if ( $this->getRTL() ) {
                $header_x = $this->original_rMargin + ( $headerdata['logo_width'] * 1.1 );
            } else {
                $header_x = $this->original_lMargin + ( $headerdata['logo_width'] * 1.1 );
            }
            $cw = $this->w - $this->original_lMargin - $this->original_rMargin - ( $headerdata['logo_width'] * 1.1 );
            $this->SetTextColorArray( $this->header_text_color );

            if ( ! empty( $barcode ) ) {
                $this->write2DBarcode( $barcode, 'QRCODE,H', $headerdata['logo_width'] + 20, '', 12, 12, [], '' );
            }

            // header title
            $this->SetFont( $headerfont[0], 'B', $headerfont[2] + 1 );
            $this->SetX( $header_x );
            $this->Cell( $cw, $cell_height, $headerdata['title'], 0, 1, 'R', 0, '', 0 );
            // header string
            $this->SetFont( $headerfont[0], $headerfont[1], $headerfont[2] );
            $this->SetX( $header_x );
            $this->MultiCell( $cw, $cell_height, $headerdata['string'], 0, 'R', 0, 0, '', '', true, 0, false, true, 0, 'T', false );

            // print an ending header line
            $this->SetLineStyle( [
                'width' => 0.85 / $this->k,
                'cap'   => 'butt',
                'join'  => 'miter',
                'dash'  => 0,
                'color' => $headerdata['line_color']
            ] );
            $this->SetY( ( 2.835 / $this->k ) + max( $imgy, $this->y ) );
            if ( $this->rtl ) {
                $this->SetX( $this->original_rMargin );
            } else {
                $this->SetX( $this->original_lMargin );
            }
            $this->Cell( ( $this->w - $this->original_lMargin - $this->original_rMargin ), 0, '', 'T', 0, 'C' );
            $this->endTemplate();
        }
        // print header template
        $x = 0;
        $dx = 0;
        if ( ! $this->header_xobj_autoreset AND $this->booklet AND ( ( $this->page % 2 ) == 0 ) ) {
            // adjust margins for booklet mode
            $dx = ( $this->original_lMargin - $this->original_rMargin );
        }
        if ( $this->rtl ) {
            $x = $this->w + $dx;
        } else {
            $x = 0 + $dx;
        }
        $this->printTemplate( $this->header_xobjid, $x, 0, 0, 0, '', '', false );
        if ( $this->header_xobj_autoreset ) {
            // reset header xobject template at each page
            $this->header_xobjid = false;
        }
    }

    /**
     * This method is used to render the page footer.
     * It is automatically called by AddPage() and could be overwritten in your own inherited class.
     * @public
     */
    public function Footer() {
        $cur_y = $this->y;
        $this->SetTextColorArray( $this->footer_text_color );
        //set style for cell border
        $line_width = ( 0.85 / $this->k );
        $this->SetLineStyle( [
            'width' => $line_width,
            'cap'   => 'butt',
            'join'  => 'miter',
            'dash'  => 0,
            'color' => $this->footer_line_color
        ] );
        $w_page = isset( $this->l['w_page'] ) ? $this->l['w_page'] . ' ' : '';
        if ( empty( $this->pagegroups ) ) {
            $pagenumtxt = $w_page . $this->getAliasNumPage() . ' / ' . $this->getAliasNbPages();
        } else {
            $pagenumtxt = $w_page . $this->getPageNumGroupAlias() . ' / ' . $this->getPageGroupAlias();
        }
        $this->SetY( $cur_y );
        //Print page number
        if ( $this->getRTL() ) {
            $this->SetX( $this->original_rMargin );
            $this->Cell( 0, 0, $pagenumtxt, 'T', 0, 'L' );
        } else {
            $this->SetX( $this->original_lMargin );
            $this->Cell( 0, 0, $this->getAliasRightShift() . $pagenumtxt, 'T', 0, 'R' );
        }
    }

} 
```

为了使用自定义页眉和页脚，您需要执行以下操作：

```
$pdf = new MYPDF( PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false );
$pdf->setBarcode( 'abcdef );
//Keep on building the pdf as usual 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-07T17:56:18.843

距离 Gregor 消息很长一段时间...在您的 Footer() 函数中，您使用的 $style 可能已在您的主代码中设置。但它不能'在类的函数中看到。为了能够在 Footer() 函数中使用它，您必须将其声明为“全局”。所以：

```
 public function Footer()
      {
       global $style;

       // Position at 15 mm from bottom
        $this->SetY(-15); 
```

等等。

# python - 如何处理用户创建的文件的大小写错误

> ID：14062133
> 
> 赞同：1
> 
> 时间：2012-12-27T22:30:36.137
> 
> 标签：python

我正在从文件“data_file.txt”中获取一些信息，它是由最终用户创建的文件，但是如果用户使用不同的情况（如 Data_file.txt 或 data_FILE.txt 等）创建它......我该如何照顾适应这种大小写不匹配情况的脚本？

```
def getAU (aufilename):
    file = open(aufilename,'r')
    return file.read()

def main ():
    aufilename="data_file.txt"
    #ROOT_DIR - The reference android build used to make the builds
    AU=getAU(aufilename)
    ROOT_DIR= "/local/mnt/workspace/username/LA_CI/" + AU
    print ROOT_DIR

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T22:32:57.647

使用 获取预期位置中的文件列表`os.listdir()`，然后对于那里的每个文件，将文件名扁平化为小写并将其与`"data_file.txt"`. 但是请注意，在文件大小写很重要的系统上，您可能会同时找到 a`Data_file.txt`和 a `data_FILE.txt`，并且您需要认真考虑如何处理这种情况——打开两者中的任意一个，打开最近的一个二、还是报错？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T22:39:03.760

除非您的文件系统使用不区分大小写的文件名，否则您不能简单地打开文件而不考虑文件名的大小写。尝试类似：

```
import os
def case_insensitive_open(filename, mode='r'):
    dir = os.path.dirname(filename)
    for potential_match in os.listdir(dir):
        if potential_match.lower() == filename.lower():
             return open(os.path.join(dir, potential_match), mode)
    else:
        return open(potential_match, mode) 
```

这将引发一个`IOError`if 它到达`else`子句，除非您打开文件进行写入，就像常规`open()`调用一样。

# c# - 在多线程环境中使用 Interlocked.Decrement 以及 monitor.wait 和 monitor.pulse 时的错误行为

> ID：14062137
> 
> 赞同：3
> 
> 时间：2012-12-27T22:31:05.953
> 
> 标签：c#, locking, threadpool, monitor, interlocked

我正在尝试实现一个多线程库，该库将使用线程池运行同时任务。基本上，它会从它接收的集合参数中将任务添加到线程池，然后等待直到正在处理的最后一个任务发送脉冲信号。我在早期的测试中取得了成功，但是当我想测试那些处理时间很短的任务时遇到了一个奇怪的问题。不知何故，要么在主线程中执行等待命令之前发送脉冲信号，要么正在发生其他事情，无论我为同步所做的努力如何，我都无法简单地看到。

为了解决我的问题，我实施了另一个“不太理想”的解决方案，因为我正在权衡潜在的性能优势，目前效果很好，但想知道为什么我的第一种方法在这种情况下不起作用尽管在性能方面排名第一，但两者之间并没有太大区别。

为了说明，我在简化以下流程后添加了这两种解决方案。有人可以帮我指出出了什么问题吗？

提前致谢。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Diagnostics;

namespace TestcodeBenchmark
{
    class Program
    {
        static int remainingTasks = 10000000;
        static Stopwatch casioF91W = new Stopwatch();
        static Random rg = new Random();
        static readonly object waitObject = new object();

        static void Main(string[] args)
        {
            TestLoop(30, remainingTasks);
            Console.ReadKey();
        }

        private static void TestLoop(int loopCount, int remainingCountResetNumber)
        {
            for (int i = 0; i < loopCount; i++)
            {
                remainingTasks = remainingCountResetNumber;
                //When this method is called it eventualy stuck at Monitor.Wait line
                TestInterlocked();

                remainingTasks = remainingCountResetNumber;
                //When this method is called it processes stuff w/o any issues.
                TestManualLock();
                Console.WriteLine();
            }
        }

        private static void TestInterlocked()
        {
            casioF91W.Restart();
            //for (int i = 0; i < remainingTasks; i++)
            //{
            //    ThreadPool.QueueUserWorkItem(delegate { TestInterlockedDecrement(); });
            //}
            int toStart = remainingTasks;
            //for (int i = 0; i < remainingTasks; i++)
            for (int i = 0; i < toStart; i++)
            {
                if (!ThreadPool.QueueUserWorkItem(delegate { TestInterlockedDecrement(); }))
                    Console.WriteLine("Queue failed");
            }
            //lock waitObject to be able to call Monitor.Wait
            lock (waitObject)
            {
                //if waitObject is locked then no worker thread should be able to send a pulse signal
                //however, if pulse signal was sent before locking here remainingTasks should be
                //zero so don't wait if all tasks are processed already
                if (remainingTasks != 0)
                {
                    //release the lock on waitObject and wait pulse signal from the worker thread that 
                    //finishes last task
                    Monitor.Wait(waitObject);
                }
            }
            casioF91W.Stop();
            Console.Write("Interlocked:{0}ms ", casioF91W.ElapsedMilliseconds);
        }

        private static void TestInterlockedDecrement()
        {
            //process task
            //TestWork();
            //Once processing finishes decrement 1 from remainingTasks using Interlocked.Decrement
            //to make sure it is atomic and therefore thread safe. If resulting value is zero
            //send pulse signal to wake main thread.            
            if (Interlocked.Decrement(ref remainingTasks) == 0)
            {
                //Acquire a lock on waitObject to be able to send pulse signal to main thread. If main 
                //thread acquired the lock earlier, this will wait until main thread releases it
                lock (waitObject)
                {
                    //send a pulse signal to main thread to continue
                    Monitor.PulseAll(waitObject);
                }
            }
        }

        private static void TestManualLock()
        {
            casioF91W.Restart();

            //Acquire the lock on waitObject and don't release it until all items are added and
            //Wait method is called. This will ensure wait method is called in main thread
            //before any worker thread can send pulse signal by requiring worker threads to
            //lock waitObject to be able to modify remainingTasks            
            lock (waitObject)
            {
                for (int i = 0; i < remainingTasks; i++)
                {
                    ThreadPool.QueueUserWorkItem(delegate { TestManualDecrement(); });
                }
                Monitor.Wait(waitObject);
            }
            casioF91W.Stop();
            Console.Write("ManualLock:{0}ms ", casioF91W.ElapsedMilliseconds);
        }

        private static void TestManualDecrement()
        {
            //TestWork();
            //try to acquire lock on wait object.
            lock (waitObject)
            {
                //if lock is acquired, decrement remaining tasks by and then check
                //whether resulting value is zero.
                if (--remainingTasks == 0)
                {
                    //send a pulse signal to main thread to continue
                    Monitor.PulseAll(waitObject);
                }
            }
        }

        private static void TestWork()
        {
            //Uncomment following to simulate some work.
            //int i = rg.Next(100, 110);
            //for (int j = 0; j < i; j++)
            //{

            //}
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:57:52.630

当你开始你的任务时，你的循环就是开始`remainingTasks`任务。但是，当您接近 10000 时，一些任务已经完成并将此数字减少到小于 10000，因此您没有开始正确数量的任务。如果我修改您的循环以保存应启动的任务数，则代码将成功运行。（请注意，您还应该检查 的返回值`QueueUserWorkItem`。）

```
 int toStart = remainingTasks;
        for (int i = 0; i < toStart; i++)
        {
            if (!ThreadPool.QueueUserWorkItem(delegate { TestInterlockedDecrement(); }))
                Console.WriteLine("Queue failed");
        } 
```

# javascript - 对话框不是函数错误

> ID：14062139
> 
> 赞同：3
> 
> 时间：2012-12-27T22:31:45.843
> 
> 标签：javascript, jsf, jsf-2, primefaces

我有这个用于问题对话框的 JavaScript 代码：

```
// Question Dialog
function deletedialog(button, a){      
    $("<div />", {
        text: a
    }).dialog({        
        width: 600,
        buttons: {
            "Ok": function() { 
                $(button).closest("form").find("[id$=deleterow]").click();
                $(this).dialog("close");
                button.value = "Processing...";
                button.disabled = true;                  
            }, 
            "Cancel": function(event) { 
                $(this).dialog("close");
                event.preventDefault();
                button.value = "Delete";
                button.disabled = false;
            } 
        }
    });         
} 
```

但由于某种原因，我在 Firebug 中找不到这个错误：

```
TypeError: $(...).dialog is not a function 
```

并且这一行被突出显示

“取消”：函数（事件）{

当我在 JSF 头中添加这个以防止 JQuery 和 Primefaces 冲突时，会出现此问题：

```
<script type="text/javascript">
    $.noConflict();
</script> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T22:34:19.373

## 问题

问题是`$`符号已通过使用`$.noConflict()`函数删除。改为使用`jQuery`。

## 两种解决方案

这基本上意味着您应该编写函数调用，`jQuery(this).dialog("close");`而不是`$(this).dialog("close");`.

要为更大的代码实现更改，您可以这样做：

```
(function($){
    // ... old code using "$" instead of "jQuery"
})(jQuery); 
```

## 解决方案编号 1 - 多个替换 - 示例

`$(...)`将调用替换为的解决方案`jQuery(...)`可能如下所示：

```
// Question Dialog
function deletedialog(button, a){      
    jQuery("<div />", {
        text: a
    }).dialog({        
        width: 600,
        buttons: {
            "Ok": function() { 
                jQuery(button).closest("form").find("[id$=deleterow]").click();
                jQuery(this).dialog("close");
                button.value = "Processing...";
                button.disabled = true;                  
            }, 
            "Cancel": function(event) { 
                jQuery(this).dialog("close");
                event.preventDefault();
                button.value = "Delete";
                button.disabled = false;
            } 
        }
    });         
} 
```

## 解决方案编号 2 - 在匿名函数中包含代码 - 示例

这是基于您可以创建匿名函数并将其传递`jQuery`给它的事实，但将其分配给被调用的参数`$`- 这将导致`$`函数中的符号可用，就好像它会在`$.noConflict()`调用之前发生一样：

```
(function($){
    // Question Dialog
    function deletedialog(button, a){      
        $("<div />", {
            text: a
        }).dialog({        
            width: 600,
            buttons: {
                "Ok": function() { 
                    $(button).closest("form").find("[id$=deleterow]").click();
                    $(this).dialog("close");
                    button.value = "Processing...";
                    button.disabled = true;                  
                }, 
                "Cancel": function(event) { 
                    $(this).dialog("close");
                    event.preventDefault();
                    button.value = "Delete";
                    button.disabled = false;
                } 
            }
        });         
    }
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-27T22:51:47.750

之前`$.noConflict();`，`$`等于`jQuery`。

之后`$.noConflict();`，`$`等于`undefined`。

这删除了 ​​的`$`快捷方式`jQuery`，这就是它不再是函数的原因。您通常仅`$.noConflict();`在添加另一个使用`$`. 您的选择是：

1.  不要使用`$.noConflict();`.
2.  使用`$.noConflict();`和替换`$`每个`jQuery`。
3.  使用`$.noConflict();`和包装你的代码`(function($){ ... })(jQuery)`

如果你需要使用`$.noConflict();`，我建议使用第三个。它通过将 jQuery 作为参数传递来将 $ 重新映射到 jQuery。使用您发布的代码，它可能看起来像......

```
(function($){

    // Question Dialog
    function deletedialog(button, a){      
        $("<div />", {
            text: a
        }).dialog({        
            width: 600,
            buttons: {
                "Ok": function() { 
                    $(button).closest("form").find("[id$=deleterow]").click();
                    $(this).dialog("close");
                    button.value = "Processing...";
                    button.disabled = true;                  
                }, 
                "Cancel": function(event) { 
                    $(this).dialog("close");
                    event.preventDefault();
                    button.value = "Delete";
                    button.disabled = false;
                } 
            }
        });         
    }

})(jQuery) 
```

# android - Android使用自定义适配器将行添加到ListView

> ID：14062145
> 
> 赞同：0
> 
> 时间：2012-12-27T22:32:14.527
> 
> 标签：android, android-listview, android-adapter

安卓有点问题。这是怎么回事，我有一个带有自定义适配器的 ListView，我想做的是动态添加行，代码如下：

适配器：

```
public class ProductAdapter extends ArrayAdapter<Product>{

    Context context; 
    int layoutResourceId;    
    String data[] = null;

    public ProductAdapter(Context context, int layoutResourceId,String[] data) {
        super(context, layoutResourceId);
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data=data;

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        ProductHolder holder = null;

        if(row == null)
        {
            LayoutInflater inflater = ((Activity)context).getLayoutInflater();
            row = inflater.inflate(layoutResourceId, parent, false);

            holder = new ProductHolder();
            holder.nameText = (TextView)row.findViewById(R.id.product_name);
            holder.quantityText = (EditText)row.findViewById(R.id.quan_text);

            row.setTag(holder);
        }
        else
        {
            holder = (ProductHolder)row.getTag();
        }

        Product product = DBAdaptor.getProductByName(data[position]);
        holder.img=(ImageView)row.findViewById(R.id.imgIcon);
        holder.nameText.setText(product.getName());
        holder.quantityText.setText(" ");

        return row;
    }

    static class ProductHolder
    {
        ImageView img;
        TextView nameText;
        EditText quantityText;
    }
} 
```

这是我的主要活动：

```
public class Main extends Activity
{
    public ListView lstView;
    ProductAdapter productListAdapter;
    DBAdaptor mDb;
    @Override
    protected void onCreate(Bundle savedInstanceState)
        {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_screen);
        openDB();
        productListAdapter = new ProductAdapter(this,        R.layout.shoping_list_row,getAllProducts());
        Bundle b = this.getIntent().getExtras();
        if(b!=null)
        {
            Product p =(Product) b.getSerializable("Product");
            productListAdapter.add(p);
            productListAdapter.notifyDataSetChanged();
        }

    }

} 
```

没有出现错误，但没有任何内容添加到 listView

亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:36:18.717

ArrayAdapter 严重依赖于它自己的私有 Array。您应该传入`data`适当的超级构造函数：

```
super(context, layoutResourceId, data); 
```

然后你需要改变这一行：

```
Product product = DBAdaptor.getProductByName(data[position]); 
```

至：

```
Product product = DBAdaptor.getProductByName(getItem(position)); 
```

`notifyDataSetChanged()`（使用类似的方法时，您也不需要调用`ArrayAdapter#add()`。它`notifyDataSetChanged()`会为您调用。）

* * *

如果您希望您的适配器使用您的本地副本，`data`您将需要覆盖`getCount()`, `getItem()`,`add()`等以使用`data`...但是当您更正所有内容时，您将不再使用 ArrayAdapter 的大部分内容，您也可以扩展 BaseAdapter。

虽然看起来您想使用数据库 ( `openDB()`)。您应该使用 Cursors 和 CursorAdapters，因为它们比将表转换为数组更有效。

# ios - 子视图上的 UIButton 没有响应内部事件的修饰

> ID：14062151
> 
> 赞同：3
> 
> 时间：2012-12-27T22:32:47.873
> 
> 标签：ios

我已经检查以确保按钮在顶部并且连接了正确的插座。在要调用的 IBAction 方法中设置了一个断点，当我按下 UIButton 时它没有被调用。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T22:35:05.847

检查以确保该按钮所在的视图已启用用户交互。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T00:49:27.810

我的错误，我在子视图上做了一个 po，它在视图后面。这可以解释为什么它没有得到触摸事件。

# javascript - 使用 PHP 或 JavaScript 访问和打印 HTML 源代码

> ID：14062158
> 
> 赞同：0
> 
> 时间：2012-12-27T22:33:29.423
> 
> 标签：javascript, php, html

我正在尝试访问然后打印（或只是能够使用）使用 PHP 的任何网站的源代码。我不是很有经验，现在我想我可能需要使用 JS 来完成这个。到目前为止，下面的代码访问网页的源代码并显示网页......我想要它做的是显示源代码。本质上，也是最重要的，我希望能够将源代码存储在某种变量中，以便以后使用。并最终逐行阅读 - 但这可以稍后解决。

```
$url = 'http://www.google.com';
function get_data($url) 
{
    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    $data = curl_exec($ch);
    curl_close($ch);
    return $data;
}
echo get_data($url); //print and echo do the same thing in this scenario. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:38:31.667

~~考虑使用[`file_get_contents()`](http://php.net/manual/en/function.file-get-contents.php)而不是`curl`.~~ 然后，您可以通过将每个左括号 (<) 替换为`&lt;`然后将其输出到页面来在页面上显示代码。

```
<?php
$code = file_get_contents('http://www.google.com');
$code = str_replace('<', '&lt;', $code);
echo $code;
?> 
```

**编辑：**
看起来 curl 实际上比 FGC 快，所以忽略这个建议。我的帖子的其余部分仍然有效。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:49:36.807

我重写了你的函数。该函数可以带行或不带行返回源。

```
<?php 
function get_data($url, $Addlines = false){
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_BINARYTRANSFER, true);
    $content = curl_exec($ch);
    $content = htmlspecialchars($content); // Prevents the browser to parse the html

    curl_close($ch);

    if ($Addlines == true){
        $content = explode("\n", $content);
        $Count = 0;
        foreach ($content as $Line){
            $lines = $lines .= 'Line '.$Count.': '.$Line.'<br />';
            $Count++;
        }
        return $lines;
    } else {
        $content = nl2br($content);
        return $content;
    }
}

echo get_data('https://www.google.com/', true); // Source code with lines
echo get_data('https://www.google.com/'); // Source code without lines
?> 
```

希望它能让你上路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T22:50:05.850

您应该尝试在`<pre></pre>`标签之间打印结果；

```
echo '<pre>' . get_data($url) . '</pre>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-13T10:38:18.293

在 php 中使用[htmlspecialchars()](http://www.php.net/manual/en/function.htmlspecialchars.php)来打印源代码。

在您的代码中，使用

`return htmlspecialchars($data);`

代替

`return $data;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T23:21:22.523

添加标题 Content-Type: text/plain

```
header("Content-Type: plain/text"); 
```

# c# - 没有访客模式的动态调度

> ID：14062160
> 
> 赞同：11
> 
> 时间：2012-12-27T22:33:45.287
> 
> 标签：c#, mono, polymorphism, overloading, dynamic-dispatch

# 问题

我正在使用一个已经存在的库，我无权访问其源代码。这个库代表一个 AST。

我想复制此 AST 的一部分，但在此过程中重命名对变量的引用。由于可以有一个AssignCommand-Object，它包含一个Expression-object，我希望能够用它自己的函数复制每个对象，这样我就可以递归地调用它们。但是，由于我无权访问库的代码，因此无法添加诸如`CopyAndRename(string prefix)`.

`Rename`因此，我的方法是创建具有多个重载的单个函数。因此，我将有一个家庭功能如下：

```
public static Command Rename(Command cmd, string prefix)
public static AssignCommand Rename(AssignCommand cmd, string prefix)
public static AdditionExpressionRename(AdditionExpression expr, string prefix)
.... 
```

一个函数现在由一个 组成`List<Command>`，其中`AssignCommand`是 的一个子类`Command`。我假设我可以将 a 传递`Command`给`Rename`-function 并且运行时会找到最具体的那个。但是，情况并非如此，所有命令都传递给`Command Rename(Command cmd, string prefix)`. 为什么会这样？有没有办法在不使用丑陋的操作的情况下将调用委托给正确的函数`is`？

# 最小的例子

我已将此问题分解为以下 NUnit-Testcode

```
using NUnit.Framework;

public class TopClass{
    public int retVal;
}

public class SubClassA : TopClass{ }

[TestFixture]
public class ThrowawayTest {

    private TopClass Foo (TopClass x) {
        x.retVal = 1;
        return x;
    }

    private SubClassA Foo (SubClassA x) {
        x.retVal = 2;
        return x;
    }

    [Test]
    public void OverloadTest(){
        TopClass t = new TopClass();
        TopClass t1 = new SubClassA();
        SubClassA s1 = new SubClassA();

    t = Foo (t);
        t1 = Foo (t1);
        s1 = Foo (s1);

        Assert.AreEqual(1, t.retVal);
        Assert.AreEqual(2, s1.retVal);
        Assert.AreEqual(2, t1.retVal);
    }
} 
```

所以我的问题归结为：“如何以一种优雅的、多态的、面向对象的方式来修复上面的测试，而不使用`is`-checks？”

## 扩展方法

我也尝试过使用如下扩展方法。这并没有解决问题，因为它们只是上述方法的语法糖：

```
using NUnit.Framework;
using ExtensionMethods;

public class TopClass{
    public int retVal;
}

public class SubClassA : TopClass{ }

[TestFixture]
public class ThrowawayTest {

    private TopClass Foo (TopClass x) {
        x.retVal = 1;
        return x;
    }

    private SubClassA Foo (SubClassA x) {
        x.retVal = 2;
        return x;
    }

    [Test]
    public void OverloadTest(){
        TopClass t = new TopClass();
        TopClass t1 = new SubClassA();
        SubClassA s1 = new SubClassA();

        t.Foo(); s1.Foo(); t1.Foo();

        Assert.AreEqual(1, t.retVal);
        Assert.AreEqual(2, s1.retVal);
        Assert.AreEqual(2, t1.retVal);
    }
}

namespace ExtensionMethods{
    public static class Extensions {
        public static void Foo (this TopClass x) {
            x.retVal = 1;
        }

        public static void Foo (this SubClassA x) {
            x.retVal = 2;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T17:45:02.210

与凯文的回答类似，我会考虑利用`dynamic`关键字。我将仅提及另外两种方法。

现在，您实际上并不需要访问源代码，您只需要访问类型本身，即程序集。只要类型是`public`（不是`private`或`internal`）这些应该工作：

# 动态访客

这一个使用与传统[访问者](http://en.wikipedia.org/wiki/Visitor_pattern)模式类似的方法。

创建一个访问者对象，每个子类型（最终类型，不是中间类或基类，如`Command`）都有一个方法，接收外部对象作为参数。

然后在编译时不知道确切类型的特定对象上调用它，只需像这样执行访问者：

```
visitor.Visit((dynamic)target); 
```

对于具有要访问的子表达式的类型，您还可以在访问者本身内处理递归。

# 处理程序字典

现在，如果您只想处理几个类型，而不是所有类型，那么只创建一个`Dictionary`处理程序可能会更简单，索引为`Type`. 这样，您可以检查字典是否具有确切类型的处理程序，如果有，请调用它。通过标准调用可能会迫使您在处理程序中进行强制转换，或者通过 DLR 调用，这不会但会对性能产生一点影响）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T17:49:24.747

我不确定 Mono 是否支持它，但您可以通过非常具体地使用泛型和`dynamic`C# 4.0 中的关键字来完成您正在寻找的东西。您尝试做的是创建一个新的虚拟插槽，但语义略有不同（C# 虚拟函数不是协变的）。所做的是`dynamic`将函数重载解析推送到运行时，就像虚拟函数一样（尽管效率要低得多）。扩展方法和静态函数都具有编译时重载解决方案，因此变量的静态类型就是所使用的，这就是您要解决的问题。

```
public class FooBase
{
    public int RetVal { get; set; }
}

public class Bar : FooBase {} 
```

设置动态访问者。

```
public class RetValDynamicVisitor
{
    public const int FooVal = 1;
    public const int BarVal = 2;

    public T Visit<T>(T inputObj) where T : class
    {            
        // Force dynamic type of inputObj
        dynamic @dynamic = inputObj; 

        // SetRetVal is now bound at runtime, not at compile time
        return SetRetVal(@dynamic);
    }

    private FooBase SetRetVal(FooBase fooBase)
    {
        fooBase.RetVal = FooVal;
        return fooBase;
    }

    private Bar SetRetVal(Bar bar)
    {
        bar.RetVal = BarVal;
        return bar;
    }
} 
```

特别感兴趣的是`inputObj, @dynamic`in `Visit<T>`for的类型`Visit(new Bar())`。

```
public class RetValDynamicVisitorTests
{
    private readonly RetValDynamicVisitor _sut = new RetValDynamicVisitor();

    [Fact]
    public void VisitTest()
    {
        FooBase fooBase = _sut.Visit(new FooBase());
        FooBase barAsFooBase = _sut.Visit(new Bar() as FooBase);
        Bar bar = _sut.Visit(new Bar());

        Assert.Equal(RetValDynamicVisitor.FooVal, fooBase.RetVal);
        Assert.Equal(RetValDynamicVisitor.BarVal, barAsFooBase.RetVal);
        Assert.Equal(RetValDynamicVisitor.BarVal, bar.RetVal);
    }
} 
```

我希望这在 Mono 中是可行的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-06T20:56:04.550

这是没有动态的版本，动态版本太慢（第一次调用）：

```
public static class Visitor
{
    /// <summary>
    /// Create <see cref="IActionVisitor{TBase}"/>.
    /// </summary>
    /// <typeparam name="TBase">Base type.</typeparam>
    /// <returns>New instance of <see cref="IActionVisitor{TBase}"/>.</returns>
    public static IActionVisitor<TBase> For<TBase>()
        where TBase : class
    {
        return new ActionVisitor<TBase>();
    }

    private sealed class ActionVisitor<TBase> : IActionVisitor<TBase>
        where TBase : class
    {
        private readonly Dictionary<Type, Action<TBase>> _repository =
            new Dictionary<Type, Action<TBase>>();

        public void Register<T>(Action<T> action)
            where T : TBase
        {
            _repository[typeof(T)] = x => action((T)x);
        }

        public void Visit<T>(T value)
            where T : TBase

        {
            Action<TBase> action = _repository[value.GetType()];
            action(value);
        }
    }
} 
```

接口声明：

```
public interface IActionVisitor<in TBase>
    where TBase : class
{

    void Register<T>(Action<T> action)
        where T : TBase;    

    void Visit<T>(T value)
        where T : TBase;
} 
```

用法：

```
IActionVisitor<Letter> visitor = Visitor.For<Letter>();
visitor.Register<A>(x => Console.WriteLine(x.GetType().Name));
visitor.Register<B>(x => Console.WriteLine(x.GetType().Name));

Letter a = new A();
Letter b = new B();
visitor.Visit(a);
visitor.Visit(b); 
```

控制台输出：**A，B**，看看[更多细节](http://www.codeproject.com/Articles/563043/Dynamic-Visitor-Pattern)。

# .net - 在 VS2012 中找不到 Microsoft.Office.Interop 程序集

> ID：14062164
> 
> 赞同：4
> 
> 时间：2012-12-27T22:33:54.127
> 
> 标签：.net, visual-studio, assemblies, office-interop, .net-assembly

我在 VS2012 中找不到 Microsoft.Office.Interop 程序集。[我从这里](http://www.microsoft.com/en-us/download/details.aspx?id=3508#system-requirements)下载程序集，但安装后我没有找到程序集。然后我尝试为 Office 2007 安装互操作程序集，但出现错误“请安装 Office 2007...”。我使用 Windows 8。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-15T09:04:16.470

我需要 Microsoft.Office.Interop.Outlook.dll 并在此处找到所有 Office 互操作程序集：

C:\Program Files\Microsoft Visual Studio 11.0\Visual Studio Tools for Office\PIA\Office14

# c# - 如何在 C# 中隐藏父方法的所有覆盖

> ID：14062165
> 
> 赞同：0
> 
> 时间：2012-12-27T22:34:03.927
> 
> 标签：c#, polymorphism, overriding, method-hiding

我正在扩展一个库类，它有一个我不想从外部调用的公共方法。我知道我可以使用“new”关键字来隐藏它，但问题是它有很多不同的声明。像这样的东西：

```
class Parent() {
  public double method(double a, double b) { ... }
  public int method(int a, int b) { ... }
  public System.Int32 method(System.Int32 a, System.Int32 b) { ... }
} 
```

现在我可以这样做：

```
class Child() {  
  // Make method private.
  private new double method(double a, double b) { return base.method(a, b) }
  private new int method(int a, int b) { return base.method(a, b) }
  private new System.Int32 method(System.Int32 a, System.Int32 b) { return base.method(a, b) }

  /// Own Code.
} 
```

但我想知道是否没有更简单的方法可以将该函数的所有覆盖设为私有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:53:17.717

我认为第一个问题是您的后代类是否需要被转换为父类。

如果不是，那么最好的方法是使用外观模式，在这种模式中隐藏“父级”并且只允许通过您的方法访问它。

有一些像：

```
class Parent {
  public double method(double a, double b) { ... }
  public int method(int a, int b) { ... }
}

class YourStuff {
  private Parent _parent = new Parent();

  public int AddNumbers(int a, int b) {
     return _parent.method(a,b);
  }
} 
```

在这种情况下，父类是隐藏的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:18:48.517

这不是方法隐藏的工作方式。您的`private new`方法只隐藏了`Child`类中的原始方法（但它们调用了它们隐藏的方法，因此没有任何收获）。

在`Grandchild`派生自 的类中，由于方法不在范围内，因此`Child`不再隐藏任何内容，因此 的方法是完全可调用且“裸露的”。方法隐藏不会以任何方式移除隐藏的方法；这只是调用哪个相同方法的问题。`private new``public``Parent`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-09T08:56:13.243

如果您希望您的库类父方法名称 Method 不能从外部调用，您需要更改访问修饰符。您的类没有访问修饰符，因此默认情况下它是 Internal - 同一程序集中的任何代码都可以访问类型或成员，但不能从另一个程序集中访问该类型或成员。Method Method 具有相同的可访问性，因为它具有访问修饰符 public。如果您希望在类方法中实现的方法只能对派生类实例进行访问，您需要所有访问修饰符公共的重载方法变体更改为受保护，然后在子类中隐藏此方法重载方法。如果您希望从外部使用这些隐藏方法，您需要将它们的访问修饰符从私有更改为公共。此实现的示例：

```
namespace HideBaseClassMethod
{
    class Program
    {
        static void Main(string[] args)
        {
            Parent myParent = new Parent();
            //myParent. - no one of overloaded protected methods are accessible after dot operator
           Child myChild = new Child();
           myChild.Method(2.5, 4.3); //double 
           myChild.Method(2, 4);//int

           Parent myChildCreatedAsParent = new Child();
           //myChildCreatedAsParent.  - no one of overloaded protected methods are accessible after dot operator
        }
    }
    class Parent 
    {
        protected double Method(double a, double b)
        {
           Console.WriteLine($"I am a parent double method {a} + {b}");
           return a + b;
        }
        protected int Method(int a, int b)
       {
            Console.WriteLine($"I am a parent integer method {a} + {b}");
            return a + b;
       }
   }
   class Child:Parent
   {
        public new double Method(double a, double b)
        {
            Console.WriteLine($"I am a child double method {a} * {b}");
            return a * b;
        }
        public new int Method(int a, int b)
        {
            Console.WriteLine($"I am a child integer method {a} * {b}");
            return a + b;
        }
    }
} 
```

该程序执行的结果将是：

我是小孩双法2.5*4.3

我是一个孩子整数方法2 * 4

# entity-framework - 实体框架：用户类与域类一对一连接

> ID：14062166
> 
> 赞同：0
> 
> 时间：2012-12-27T22:34:11.877
> 
> 标签：entity-framework, asp.net-mvc-4

在这里撕头发。我正在尝试将实体类型（例如“客户”）链接到代码优先应用程序中的 UserProfile 表。我不想将我的域信息放入自动生成的 UserProfile 表中，我希望它在我的域表中。

我已经`public virtual UserProfile UserId { get; set; }`在我的域类的抽象基础中添加了一个，但是 update-database 一直在说`No pending code-based migrations.`

我仍处于早期开发阶段，我想保留的数据库中没有任何内容是否有“核选项”可以让迁移“忘记一切”并重新开始？`update-database -targetmigration:0`似乎对我没有多大作用。

编辑：我对数据库进行了核对并重新开始，并将字段从抽象类迁移到具体类，鲍勃是你的叔叔。我只是拥有这个糟糕的类型集合，其中包含大量复制字段和大量复制代码来处理两种“不同”类型（实际上是相同的）。

毫无疑问，这是我在 BAR NONE 技术方面遇到的最糟糕的经历。

我想我的问题是，在阅读了一周的文章、观看 Pluralsight 视频并反复用头撞砖墙之后，人们实际上是这样使用这项技术的吗？这太糟糕了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T17:44:26.840

如果这是您第一次尝试 ORM，那么无论您使用哪种框架，都会感到沮丧。ORM 可能很难缠住你的脑袋。您正在 OOP 和规范化数据库表之间移动。这需要一些练习。

实体框架的好处在于，它在大多数情况下为您省去了必须自己映射关系的麻烦。不确定您是否可以使用 NHibernate 做到这一点？

缺点是 EF 偶尔会出错，而且很难弄清楚到底发生了什么。它在很大程度上依赖于约定，如果你知道它们是什么，它们就很简单了。

就像当你第一次开始编码时，你就像“空指针异常到底是什么意思！” 需要一点时间来了解你的方位。一旦你对它进行了一些练习，它**确实**会加快你的开发时间。

尝试发布您的模型。我也许可以帮助您重回正轨。

# jquery - 使用 fittext.js 将绝对 div 定位为 100% 宽度

> ID：14062167
> 
> 赞同：1
> 
> 时间：2012-12-27T22:34:18.877
> 
> 标签：jquery

我有一个 headLine div 容器`<h1>`，`<h2>`它是绝对位置并且有 100% 的宽度，我需要 100% 的宽度才能让 fittext.js 正常工作，但是当我将 div 定位到这么多`em`s 时，它给了我一个水平滚动条。由于我的网站结构，我无法进行相对定位，但我可以，但这会让事情变得更加困难。好的，那么为什么我会得到这个水平宽度，如果它，我该如何摆脱它。

查看项目[http://jsfiddle.net/sLXZs/3/](http://jsfiddle.net/sLXZs/3/)

html /js

```
 <div id="headLine">
            <h1 class="fitText">Austin Kitson</h1>
            <h2 class="fitText">Marketing & Sales</h2>
        </div>

                <script>
                    jQuery(document).ready(function($) {
  $('.fitText').fitText(2.2, { minFontSize: '10px', maxFontSize: '80px' });

});
                </script> 
```

css

```
#headLine {
  position: absolute;
  top: 50%;
  left: 55%;
  width: 100%;
  background: red; } 
```

​</p>

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:42:46.313

似乎只需将 div 的大小而不是 100% 固定为 45% 并将 fittext 的`kompressor`参数设置为 1 即可使其正常工作。

CSS

```
#headLine {
  position: absolute;
  top: 50%;
  left: 55%;
  width: 45%;
  background: red; } 
```

脚本

```
jQuery(document).ready(function($) {
    $('.fitText').fitText(1, {
        minFontSize: '10px',
        maxFontSize: '80px'
    });
}); 
```

演示在[http://jsfiddle.net/sLXZs/4/](http://jsfiddle.net/sLXZs/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T22:45:54.577

设置正文溢出以避免滚动条：

```
body,html{overflow-x:hidden} 
```

演示：http: [//jsfiddle.net/sLXZs/5/](http://jsfiddle.net/sLXZs/5/)

`overflow-x`一些较旧的浏览器不支持。您可以尝试使用`overflow:hidden`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:49:25.630

假设您想保持 100% 宽度样式而不使用 45% 宽度，它仍然是可能的，并且可以即时计算：

```
$("#headLine").width(function () {
   return $(this).width() - $(this).css('left');
}); 
```

在行动：http: [//jsfiddle.net/sLXZs/6/](http://jsfiddle.net/sLXZs/6/)

# c++ - 使用 C 在文本中搜索单词，并显示该单词之后的信息

> ID：14062176
> 
> 赞同：4
> 
> 时间：2012-12-27T22:34:51.917
> 
> 标签：c++, c, printf, string-search, fgetc

假设我有一个这样的文本文件：

用户：约翰

设备：12345

日期：12/12/12

**编辑：**

我有我的代码可以成功搜索一个单词，并在该单词之后显示信息。但是，当我尝试编辑代码以搜索 2 个或 3 个单词并在它们之后显示信息而不是仅 1 个单词时，我无法让它工作。我尝试将代码添加到同一个 while 循环中，并为另一个词创建一个新的 while 循环，但两者都不起作用。一定有什么我做错/没有做的事情。

请指教，谢谢！

这是我的代码：

```
 #include <stdio.h>
 #include <string.h>
 #include <stdlib.h>
 int main() {

char file[100];
char c[100];

printf ("Enter file name and directory:");
scanf ("%s",file);

    FILE * fs = fopen (file, "r") ;
    if ( fs == NULL )
    {
           puts ( "Cannot open source file" ) ;
           exit( 1 ) ;
    }

    FILE * ft = fopen ( "book5.txt", "w" ) ;
    if ( ft == NULL )
    {
           puts ( "Cannot open target file" ) ;
           exit( 1 ) ;
    }

while(!feof(fs)) {
   char *Data;
   char *Device;
   char const * rc = fgets(c, 99, fs);

   if(rc==NULL) { break; }

   if((Data = strstr(rc, "Date:"))!= NULL)
   printf(Data+5);

   if((Data = strstr(rc, "Device:"))!=NULL)
   printf(Device+6);
   }

    fclose ( fs ) ;
    fclose ( ft ) ;

return 0;

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:46:43.307

`fgetc`返回一个整数值，即字符，提升为 int。我想你的意思`fgets`是读一整行，但你需要为它保留内存，例如：

```
#define BUF 100
...
char c[BUF];
fgets(c, BUF, fs); 
```

一些[有用的](http://www.cplusplus.com/reference/cstdio/fgets/) [链接](http://www.cplusplus.com/reference/cstdio/fgetc/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T22:54:08.727

您的代码中有几个问题：基本上它从未编译过。

这是一个带有小清理的版本 - 至少可以编译：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main() {
    char file[100];
    char c[100];

    printf ("Enter file name and directory:");
    scanf ("%s",file);

    FILE * fs = fopen (file, "r") ;
    if ( fs == NULL ) {
       puts( "Cannot open source file" ) ;
       exit(1 ) ;
    }

    while(!feof(fs)) {
       char *Data;
       char const * rc = fgets(c, 99, fs);
       if(rc==NULL) { break; }
       if((Data = strstr(rc, "Device"))!= NULL)
       printf("%s", Data);
    }

    fclose ( fs ) ;

    return 0;
 } 
```

我发现的问题：

*   缺少包括`exit()`
*   缺少参数`exit()`
*   缺少运行整个输入文件的 while 循环。
*   从未使用过输出文件。
*   缺少'main'的返回值
*   想要`Data[5]`
*   改为`fgetc()`_`fgets()`

我只做了很少的编辑——它一点也不完美......

恕我直言，我会选择 C++：那里的许多事情要简单得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:10:59.007

好的，希望我这次可以清除它。抱歉，如果我有时会感到困惑，但我的英语不是最好的。

我将在评论中解释实现：

```
#define BUFFSIZE 1024
int main()....

char buff[BUFFSIZE];
char delims[] = " ";  /*Where your strtok will split the string*/
char *result = NULL;
char *device; /*To save your device - in your example: 12345*/
char *date; /*To save the date*/
int stop = 0;

fp = fopen("yourFile", "r");

while( fgets(buff, BUFFSIZE,fp) != NULL )  /*This returns null when the file is over*/
{
 result = strtok( buff, delims );   /*You just need to do reference to buff here, after this, strtok uses delims to know where to do the next token*/

   while(result != NULL){   /*Strtok returns null when finishes reading the given string*/
      if(strcmp(result,"Device")==0){   /*strcmp returns 0 if the strings are equal*/
         result = strtok(NULL, delims); /*this one gets the 12345*/
         device = (char*)malloc((strlen(result)+1)*sizeof(char)); /*Alocate the right amount of memory for the variable device*/
         strcpy(device, result); /*Now, device is "12345"*/
      }
       /*Here you do the same but for the string 'Date'*/
       if(strcmp(result,"Date")==0){   /*strcmp returns 0 if the strings are equal*/
         result = strtok(NULL, delims); /*this one gets the 12345*/
         date = (char*)malloc((strlen(result)+1)*sizeof(char)); /*Alocate the right amount of memory for the variable device*/
         strcpy(date, result); /*Now, device is "12/12/12"*/
      }
      /*And you can repeat the if statement for every string you're looking for*/
      result = strtok(NULL,delims);  /*Get the next token*/
   }
}

/*No strtok necessary here */

... 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T23:12:14.860

我会用两个循环来做到这一点：一个从文件中获取一行，另一个从读取的行中生成标记。

就像是：

```
#define BUFFSIZE 1024
int main()....

char buff[BUFFSIZE];
char delims[] = " ";
char *result = NULL;
int stop = 0;

fp = fopen("yourFile", "r");

while( fgets(buff, BUFFSIZE,fp) != NULL )  /*This returns null when the file is over*/
{
 result = strtok( buff, delims );   /*You just need to do reference to buff here, after this, strtok uses delims to know where to do the next token*/

   while(result != NULL){   /*Strtok returns null when finishes reading the given string*/
      if(strcmp(result,"Device")==0){   /*strcmp returns 0 if the strings are equal*/
         stop = 1;  /*Update the flag*/
         break;     /*Is now possible to break the loop*/
      }
      result = strtok(NULL,delims);  /*Get the next token*/
   }
   if(stop == 1) break; /*This uses the inside flag to stop the outer loop*/
}

result = strtok(NULL, delims); /*Result, now, has the string you want: 12345 */

... 
```

这段代码不是很准确，我没有测试过，但这就是我尝试做的方式。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T22:45:53.907

我的建议是使用 fread 来读取所有文件。您可以逐个字符地读取它，但是恕我直言（这里是个人口味），获取包含所有字符的字符串然后对其进行操作更简单。

这是函数原型：

```
size_t fread ( void * ptr, size_t size, size_t count, FILE * stream ); 
```

它返回读取的元素数。

例如：

```
char buffer[100];
size_t n= fread(buffer, 1,100, fs); 
```

然后您可以操作字符串并将其划分为标记。

**编辑**

这里有一个很好的参考，还有一个如何将字符串划分为标记的示例：

[http://www.cplusplus.com/reference/cstring/strtok/](http://www.cplusplus.com/reference/cstring/strtok/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-27T23:04:54.680

如果`printf()`不是硬性/快速规则，并且输入要求真的很简单，我更喜欢状态机和常量内存输入：

```
int c, x = 0;                              // c is character, x is state
while(EOF!=(c=getchar())){                 // scanner entry point
  if(c == '\n') x=0;                       // newline resets scanner
  else if(x == -1) continue;               // -1 is invalid state
  else if (x < 7 && c=="Device:"[x])x++;   // advance state
  else if (x == 7 && isspace(c)) continue; // skip leading/trailing whitespace
  else if (x == 7) putchar(c);             // successful terminator (exits at \n)
  else x = -1;                             // otherwise move to invalid state
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-27T22:42:35.597

`c`并且`Data`是字符指针，指向（列表的开头）字符值的指针。

`fgetc`的原型`int fgetc ( FILE * stream );`意味着它返回（一个）整数值（整数可转换为单个 char 值）。

如果`fgetc`' 的原型本来是`int * fgetc ( FILE * stream );`警告就不会出现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-27T23:39:39.640

@Dave Wang 我的回答太大了，不能发表评论。所以这里是：

别客气。乐意效劳。

如果您创建一个新循环，则 fgets 将无法工作，因为您已经在文本文件中“关闭”。想象一下像一个指向文件的指针，每次你从一个文件指针'fget'，你推进那个指针。您具有重新加载文件或向上推该指针的功能，但效率不高，您已经通过了您想要的信息，必须有办法知道何时。

如果你使用我的实现，那是通过在循环中使用另一个字符串比较来完成的： if(strcmp(result,"date") == 0) 如果你输入这个 if，你知道结果标记中的下一个值strtok 是实际日期。由于您现在有两个条件要测试，因此您不能在同时拥有这两个条件之前打破外循环。这可以通过两种方式实现：

1-而不是标志，使用每次需要信息时递增的计数器。如果该计数器具有您想要的相同数量的信息，您可以打破外循环。

2-根本不要打破外循环！:)

但是在这两种情况下，由于有两个条件，请确保在 ifs 中处理它们，这样您就知道您处理的是正确的信息。

希望这可以帮助。有什么，随便问问。

# iphone - 如何从另一个类访问我的 ViewController 的属性变量？

> ID：14062180
> 
> 赞同：1
> 
> 时间：2012-12-27T22:35:21.377
> 
> 标签：iphone, ios, properties, automatic-ref-counting

好的，这确实困扰着我，我相信解决方案很简单......我无法从另一个类 (SeverConnect.m) 设置我的 ViewController 的属性变量，我已经在我的 ViewController 的 .h/ 中正确声明和合成了它。 m 文件：

**服务器连接.h：**

```
#import <Foundation/Foundation.h>
#import "ViewController.h"
#import "Contact.h"

@class ViewController;

@interface ServerConnect : NSObject
{
Contact *newContact;
NSString *codeRawContent;
NSMutableArray *contactListCopy;
...  //Other variables declared here, but not shown in order to save space 
```

**ServerConnect.m 内部：**

```
- (void)parserDidEndDocument:(NSXMLParser *)parser
{
NSLog(@"parserDidFinish");

newContact = [[Contact alloc] initWithCodeInfo:(NSString *)codeInfo
                                       contactName:(NSString *)completeName 
                                      contactImage:(UIImage *)profileImage
                                    contactWebSite:(NSString *)codeRawContent];
[contactListCopy insertObject:newContact atIndex:0];
[ViewController setContactList:contactListCopy];  //Automatic Reference Counting Error Occurs Here: "No known class method for selector 'setContactList:'"
} 
```

如上所述，我在 ViewController 的 .h/.m 文件中声明并合成了属性变量“contactList”（没有错误）：

```
@property (nonatomic, retain) NSMutableArray *contactList;  //In ViewController's .h file
@synthesize contactList;  //In ViewController's .m file 
```

有人可以告诉我我做错了什么吗？提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:41:58.207

您正在尝试访问类的实例属性：

```
[ViewController setContactList:contactListCopy]; 
```

您需要首先创建 ViewController 类的实例，然后设置其属性。像这样的东西：

```
ViewController *viewController = [[ViewController alloc] init];
[viewController setContactList:contactListCopy]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:41:45.320

在这行代码中：

`[ViewController setContactList:contactListCopy];`

你应该使用一个类型的变量`ViewController`。你使用它的方式，它应该是一个类方法，而不是一个属性。写一些类似的东西：

`ViewController *viewController = [[ViewController alloc] init];`

`[viewController setContactList:contactListCopy];`

# dll - 从 .sym 文件生成 .dll？

> ID：14062189
> 
> 赞同：2
> 
> 时间：2012-12-27T22:36:47.763
> 
> 标签：dll, msys, mingw-w64

我有一个使用 MinGW 从 C/C++ 代码编译的 .a 存档。我还在许多 .sym 文件中导出了符号。现在我需要从它们的组合中生成一个 .dll 文件。我已经安装了 MSYS/MinGW w64

# java - Internet Explorer 和 JSP 中的基本 URL

> ID：14062190
> 
> 赞同：0
> 
> 时间：2012-12-27T22:36:52.353
> 
> 标签：java, html, internet-explorer, jsp, servlets

Internet Explorer 不支持 HTML `<base> tag and even other browsers do, there are some problems when redirect takes place in`servlets `to some`.jsp`pages for example`请求调度。`

`${pageContext.request.contextPath}`添加每个 URL 也不可行`request.getServletPath()`

带有 servlet 转发的 CSS 和图像的 JSP 相对链接可能会改变很多。此链接：[当调用转发到 JSP 的 Servlet 时，浏览器无法访问/查找相关资源，如 CSS、图像和链接](https://stackoverflow.com/questions/3655316/browser-cant-access-find-relative-resources-like-css-images-and-links-when-cal)

**JSP / servlet 是否有更好的方法，或者它只是一个 IE 问题？
链接：[HTML <base> TAG 和 Internet Explorer 的本地文件夹路径](https://stackoverflow.com/questions/3926197/html-base-tag-and-local-folder-path-with-internet-explorer)**

**如果是 IE 问题：
1\. 如何解决 IE 问题，因为上述帖子无法给出有效答案？
2.如何用JSP/servlet解决？**

我的网站现在显示 CSS 和图像。
例如 HTML 输出是：

```
<base href="http://localhost:8080/Alpinema/" /> is not working for 
<link media="all" rel="stylesheet" type="text/css" href="css/all.css"> 
```

它适用于其他浏览器，如 Firefox 和 Chrome。

我的 JSP 代码部分：

```
<head>
    <base href="${fn:substring(url, 0, fn:length(url) - fn:length(uri))}${req.contextPath}/" />
    <meta charset="utf-8">
    <title>Alpinema.com</title>
    <link media="all" rel="stylesheet" type="text/css" href="css/all.css">
   /css?family=Merriweather|PT+Sans:700|Nobile:400italic' rel='stylesheet' type='text/css'>
</head> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T00:19:42.543

使用`<c:url>`来自 JSTL 的标签来引用我的 JSP 文件中的 CSS/JavaScript 资源。通过这样做，您可以确保**始终相对于应用程序上下文**（上下文路径）引用 CSS/JavaScript 资源。

* * *

## 例子

*index.jsp：*

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
  <title>Some Title</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link type="text/css" rel="stylesheet" href="<c:url value="/css/main.css" />" />
  <script type="text/javascript" src="<c:url value="/js/utils.js" />"></script>
  <script type="text/javascript" src="<c:url value="/js/jquery-1.8.3.js" />"></script>
</head>
<body>
...
</body>
</html> 
```

* * *

如需更多解决方案，请在此处查看我的答案：
[在 JSP 中添加外部资源（CSS/JavaScript/图像等）](https://stackoverflow.com/a/14571407/814702)。

# javascript - 使用 AJAX、Javascript/jQuery、DOM 和 Facebook Like 按钮进行无限滚动

> ID：14062191
> 
> 赞同：1
> 
> 时间：2012-12-27T22:37:03.210
> 
> 标签：javascript, jquery, ajax, facebook, dom

我正准备实现类似 Twitter 的无限滚动到我的产品页面。也就是说，当我跨越某些滚动阈值时，使用 AJAX 加载其他页面部分。但我不确定标题中的主题在加载后会受到怎样的影响。我的问题如下：

1.  对于每一批使用 AJAX 加载的新元素，DOM 会为这些新元素更新还是完全更新？旧的 DOM 会发生什么？

2.  我是否能够在这些新的 DOM 元素上使用 Javascript 和 jQuery，就像我在页面开始使用的 DOM 上一样？我想这与第一个问题有关。

3.  对于每次加载，我将加载 9 个新产品。每个产品都有一个使用 FB Open Graph API 的 FB Like 按钮。新产品的 Like 元素是否会经历与我开始使用的 DOM 元素相同的异步修改，以便可以进行适当的 Like 提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:50:02.493

让我们一一开始。

1.  在您的意图中，DOM 应该只更新，而不是更新。没有旧的 DOM，因为您所做的是在它们上插入新元素。

2.  是的，你将能够做到这一点。但要小心使用事件侦听器，因为如果您错误地启动它们，您将不得不再次将新的事件侦听器附加到这些新节点。例如：

    $('body').on('click','a.addToCart',function(){}) // 将匹配当前和未来的节点 $('a.addToCart').on('click',function( ){}); // 只会匹配当前节点

3.  是的，您需要再次对每个按钮执行相同的过程。

**额外提示**：如果您关心移动环境，则应通过删除不需要的节点来尽可能保持 DOM 干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:52:35.023

1.  只需使用 document.appendChild() 将新元素添加到 DOM。（http://www.w3schools.com/jsref/met_node_appendchild.asp）重建漏洞页面将是浪费时间；）

2.  应该没有问题。我已经做过很多次了，没有任何问题。如果您使用的是 jQuery Mobile，您可能必须刷新新元素。（看看你正在使用的 jQuery Mobile Widget 的方法，是否需要刷新）

3.  我对facebook api没有太多经验，但我会说“是”=）

编辑：我的回答中有一个指向德国网站的链接。我忘了这是一个英文网站；）

# c# - MonoDroid 和 MonoTouch 的共享库

> ID：14062194
> 
> 赞同：5
> 
> 时间：2012-12-27T22:37:50.107
> 
> 标签：c#, xamarin.ios, shared-libraries, xamarin.android, xamarin

所以我的公司完全来自一个 C# .Net 环境，所以我们自然而然地将 Mono 用于移动开发。我们有一个非常广泛的 Windows 平台库，我可以将其中的大部分移植为 Android 类库。这个想法是这个 Android 类库将成为我们的移动平台库，将来可以为 MonoTouch 重用（尚未测试，但只要没有 Android 特定代码，MonoTouch 项目就可以引用 Android 类库）。不过，在库中，有很多日志语句，对于 windows 环境，这些语句最终只是跟踪语句（包装在自定义帮助程序类中）。我们希望保留日志记录语句并基于当前环境（iOS 或 Android），只需将它们转换为原生日志记录。

我计划在移动平台库中使用部分声明进行日志记录，并让 Android 和 iOS 特定库包含这些部分日志记录方法的实现。但是当我意识到部分在程序集之间不起作用时，这种情况就崩溃了。

所以现在我不知道该怎么做。如果有两个独立的 iOS 和 Android 平台库并链接相同的文件，我唯一能想到的。（Xamarin 可能有一个日志类可以做到这一点，但我们仍然需要为未来的任何其他抽象提出一个模式）

任何建议表示赞赏。我们仍处于实验/计划阶段，因此我们可能会忽略某些东西，如果是这种情况，请告诉我们。

谢谢。

**编辑**
假设我有以下简单的静态类。

```
public static class TraceHelper
{
    public static void WriteLine(string message)
    {
        // Validation and preprocessing
        Trace.WriteLine(message);
    }
} 
```

我在移动平台库中有数百次调用此方法。现在假设我在我的 Android 应用程序中引用了这个库，有没有办法在不修改库本身的情况下覆盖 TraceHelper.WriteLine() 的实现？

**更新**
我们最终创建了实现缺失的 .NET 功能的 Android 和 iOS 库。只需将本机等效功能包装在相同的 .NET 命名空间和类中。前任：

```
using Android.Util;

namespace System.Diagnostics
{
    public static class Trace
    {
        #region Non-Public Data Members

        private const string Tag = "Trace";

        #endregion

        public static void WriteLine(string message)
        {
            Log.WriteLine(LogPriority.Verbose, Tag, message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T14:47:40.907

在 mvvmcross 中，我使用接口解决了这个问题。

我已经声明了一个通用的 IMvxTrace 接口，然后我添加了它的单例实现，例如：

[https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Platform/Diagnostics/MvxTrace.cs](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Platform/Diagnostics/MvxTrace.cs)

这个单例使用底层的 _realTrace 实现。

在机器人上，_realTrace 是：

[https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Android/Platform/MvxDebugTrace.cs](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Android/Platform/MvxDebugTrace.cs)

在触摸时，_realTrace 是：

[https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Touch/Platform/MvxDebugTrace.cs](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Touch/Platform/MvxDebugTrace.cs)

同样在 wpf、win8 和 wp 上有自定义实现

我已经使用文件链接（在主文件中）完成了这项工作，但最近使用了 PCL 和特定于平台的库的混合。我*个人*偏爱 PCL，因为我喜欢使用重构工具——与使用 #if 代码相比，这些对 PCL 的效果要好得多。此外，随着我​​的代码从 1 个平台增加到 6 个平台，我发现 6 组 #if 语句太复杂而无法维护。

请注意，上面的代码还使用了依赖注入和 IOC 技术。我发现这对跨平台代码共享非常有帮助。有几个可移植的 IOC 库可用，包括 tinyioc、xplatutils、opennetcf 和 mvvmcross 的简单 IOC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:33:44.023

解决此问题的最简单方法是设置一个 iOS 项目，您基本上可以在其中执行此操作：

```
public static class TraceHelper
{
    public static void WriteLine(string message)
    {
#if MONOTOUCH
        Console.WriteLine(message);//or something else
#else
        Trace.WriteLine(message);
#endif
    }
} 
```

您将创建一个 MonoTouch 类库项目并“链接”原始 Mono for Android 项目中的所有文件。然后，如果需要，您可以设置`MONOTOUCH`编译器标志以具有特定的 iOS 或 Android 代码。

我们一直采用这种方法，*有时*更喜欢它而不是使用 PCL（可移植类库），因为它具有灵活性。

# c++ - 当（一组单例的）实现直接从 C++ 中的编译单元在某个注册表中自注册时，它叫什么？

> ID：14062196
> 
> 赞同：0
> 
> 时间：2012-12-27T22:38:16.597
> 
> 标签：c++, design-patterns, singleton

假设我们有这样的方案：

qqqapi.h:

```
int register_qqq(Qqq* klass); 
```

qqqalpha.cpp:

```
QqqAlpha::QqqAlpha(...) : Qqq(...) { }

QqqAlpha instance;
int dummy = register_qqq(&instance); 
```

qqqbeta.cpp:

```
QqqBeta::QqqBeta(...) : Qqq(...) { }

QqqBeta instance;
int dummy = register_qqq(&instance); 
```

这样，您只需复制源文件和头文件，更改适当的标识符即可创建新的 qqq 类型。无需手动将任何东西添加到任何列表中。

这种模式怎么称呼？有没有关于正确实施这些事情的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:06:49.393

该方案的一个主要问题是 C++ 实现处理整个*翻译单元*。

考虑一个包含数百个翻译单元的静态库。据编译器和链接器所知，您的程序只使用一两个。他们几乎不知道，通过在注册表对象中自动注册，您的程序实际上使用了五个单元！

因此，链接器会删除库提供的所有翻译单元，除了您的代码*直接*使用的一两个翻译单元，例如通过调用函数或引用变量。

结果：神秘的运行时故障，单例注册表不知何故不包含它应该包含的内容。

这可能是为什么模式/成语/whatchammacallit 很少使用的原因。它适用于目标代码文件，因为您明确地告诉链接器要包含什么。它对静态库的效果不太好。

* * *

最佳实践是通过代码（但可能通过文档）确保翻译单元中的某些内容被调用或引用，例如通过`main`.

这可确保存在*可见*的依赖关系，从而不会删除翻译单元。

* * *

我不知道任何常用的名称。在过去，在另一种语言中，有一种称为*模块信封*的东西，您可以将其视为负责初始化和清理模块的静态对象的构造函数和析构函数的执行。但是 C++ 不支持这一点，而且我记得，近年来在谷歌上搜索这个词并没有提供任何相关的点击。好像所有的信息都消失了……

# django - 使用有效实例设置后，django 表单无效

> ID：14062197
> 
> 赞同：1
> 
> 时间：2012-12-27T22:38:21.980
> 
> 标签：django, django-forms

我真的很困惑为什么这个 form.is_valid() 返回 False：

这是我创建的 django 模型：

```
class aModel(models.Model):
    some_id = models.IntegerField() 
```

我将`Model`转换为`ModelForm`，并使用 的实例创建一个`ModelForm`实例`Model`。这个`ModelForm`实例不应该是有效的吗？

```
>>> class aModelForm(forms.ModelForm):
...     class Meta:
...             model = aModel
... 
>>> am = aModel.objects.get(id=1)
>>> for k,v in am.__dict__.items(): print k,v
... 
_state <django.db.models.base.ModelState object at 0x1020c8a50>
id 1
some_id 5
>>> form = aModelForm(instance=am)
>>> form.is_valid()
False
>>> am.save()
>>> am.some_id = 6
>>> am.save()
>>> 
```

为什么表格无效？我需要做什么才能使表格有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:06:27.747

看起来此表单未绑定到数据，因此无法验证。您可以通过打印`form.is_bound()`之前`form.is_valid()`进行验证来验证。

如果未绑定，我认为您无法验证。要绑定数据，您需要将数据作为字典添加到表单的第一个参数。

```
form = aModelForm({'some_id': am.some_id}, instance=am)
form.is_valid() 
```

有关更多详细信息，请参阅[Django - 表单 API](https://docs.djangoproject.com/en/dev/ref/forms/api/)。

# arrays - As3在函数外调用数组

> ID：14062198
> 
> 赞同：0
> 
> 时间：2012-12-27T22:38:27.020
> 
> 标签：arrays, actionscript-3, flash

我对 AS3 和编程本身有点陌生。

我有这个问题。我希望能够使用函数的**`Pl_array`**和**`En_array`**外部`AfterLoad`，但我总是得到未定义的值。我在时间线内编写代码而不是 .as 文件。有关系吗？

我试图从函数中返回它们，但由于它与侦听器有关，我只是不知道该怎么做，我也试图将它们公开。

这是第一帧的代码：

```
import flash.events.MouseEvent;
stop();
Btn_start.addEventListener(MouseEvent.CLICK, onStartClick);

function onStartClick(me:MouseEvent):void{
    gotoAndStop("Dictionary");
} 
```

这是第二个字典：

```
import flash.events.Event;
import flash.utils.Timer;
import flash.events.MouseEvent;

stop();

var myTextLoader:URLLoader = new URLLoader();
var Txt_array:Array=new Array(); //tablica wczytanych zwrotów
var Pl_array:Array=new  Array();
var En_array:Array=new Array();
var myTimer:Timer = new Timer(1000);

myTextLoader.addEventListener(Event.COMPLETE, onLoaded); //listener na koniec wczytywania pliku tekstowego

function onLoaded(e:Event):void { //funkcja wywoływana przez listener na koniec wczytywania pliku
    Txt_array = e.target.data.split(/\n/); //
    dispatchEvent(new Event("Load_END"));
}
myTextLoader.load(new URLRequest("Zwroty.txt"));

this.addEventListener("Load_END", AfterLoad); //kod wykonywano po wczytaniu pliku tekstowego 
function AfterLoad(e:Event):void{   
    for each (var s:String in Txt_array){// pętla która rozdziela tekst na polski i angielski
        var i:int=0;
      En_array[i]=s.substr(0, s.indexOf("-")-1);
      Pl_array[i]=s.substr(s.indexOf("-")+2, s.length);
      i++;
    } //koniec fora
}//koniec funkcji

Begin.addEventListener(MouseEvent.CLICK, test);

function test(e:Event):void{
    trace(En_array[1]);
}

//funkcja wyświetlająca string w txt_load
function ShowString (txt_show:String):void{
    load_txt.text = txt_show;
}

function ShowOpinion(txt_opinion:String):void{
    opinion_txt.text=txt_opinion;
}   

function HideOpinion():void{
    opinion_txt.text=" ";
}

//funkcja porównująca łańcuchy
function Compare(txt_a:String,txt_b:String):Boolean{
    if (txt_a==txt_b){ 
      return true;
    } 
    return false;
}

//up_btn.useHandCursor=true;
//up_btn.addEventListener(MouseEvent.MOUSE_OVER, switch_bg);

//function switch_bg(me:MouseEvent):void{
    //var newColor:ColorTransform = me.target.transform.colorTransform;
    //newColor.color = 0x1000C6;
    //me.target.transform.colorTransform = newColor;
//} 
```

在跟踪时`test`我总是得到的功能。`undefined`我试图在 Google 中找到解决方案，但找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:45:31.193

这段代码看起来应该可以工作，但是如果您尝试访问其中的第一个元素，则`En_array`需要记住索引从 0 开始，而不是 1。您可能还需要确保`En_array`在读取其任何值之前不为空。尝试这个：

```
if (En_array.length > 0)
    trace(En_array[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T13:59:06.623

你的代码很乱。让我们让它更简单：

```
import flash.events.Event;
import flash.utils.Timer;
import flash.events.MouseEvent;

stop();

var myTextLoader:URLLoader = new URLLoader();
var Txt_array:Array;
var Pl_array:Array;
var En_array:Array;
/* Good practice is to create object when you relay need it */
var myTimer:Timer = new Timer(1000);

myTextLoader.addEventListener(Event.COMPLETE, onLoaded); 

function onLoaded(e:Event):void {
   Txt_array = e.target.data.split(/\n/); // now we create new array
   afterLoad(Txt_array);
}

function afterLoad(array):void{ // it is good habit to start function names from small letter
    En_array = [];// create arrays
    Pl_array = [];

    for each (var s:String in array){
      En_array.push(s.substr(0, s.indexOf("-")-1));
      Pl_array.push(s.substr(s.indexOf("-")+2, s.length));
      // push let you add items more efficient and you don't need index
    }
}

myTextLoader.load(new URLRequest("Zwroty.txt")); 
```

现在一切都应该好了 :) 只要记住检查对象（在你的情况下是数组）是否有你想要使用的元素（等等 array.lenght>0 或 array=null）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T07:09:18.757

首先加载数据有时需要几秒钟。加载后从数组中读取数据。在时间轴中，加载不能与读取过程在同一帧，除非另有说明，在第一行代码中显式加载，然后进行读取。

# php - PHP 如何与 HTTP 服务器交互？（如 lighttpd）

> ID：14062201
> 
> 赞同：6
> 
> 时间：2012-12-27T22:38:32.230
> 
> 标签：php, lighttpd

> **可能重复：**
> [我从来没有真正理解：什么是 CGI？](https://stackoverflow.com/questions/2089271/i-never-really-understood-what-is-cgi)

在 lighttpd config 中，我们定义了两条路径（如下图），一条是 PHP 的二进制文件，一条是 socket 路径。我的问题是，lighttpd 会在哪一点获取 PHP 创建的最终 HTML 输出？二进制文件是否将输出作为响应提供给 lighttpd？或者它是否在另一个地方创建一个临时文件并且服务器获取它？

```
fastcgi.server = ( ".php" => ((
                     "bin-path" => "/usr/bin/php-cgi",
                     "socket" => "/tmp/php.socket"
                 ))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:42:57.567

据我了解，`bin-path`用于启动 FastCGI 服务器（如果尚未启动），而`socket`用于在启动后将请求代理到服务器。

`/tmp/php.socket`因此，最终的 HTML 是在请求​​处理完毕后提取的；它是一个命名管道，而不是网络套接字，但它们在任何其他方面都非常相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:22:39.283

PHP 可以作为 CGI 二进制文件或 Apache 模块运行。当用作 CGI 二进制文件时，HTTP 服务器将通过[管道](http://en.wikipedia.org/wiki/Pipeline_%28Unix%29)或[命名管道](http://en.wikipedia.org/wiki/Named_pipe)与 PHP 通信。这些可以利用[标准输出](http://en.wikipedia.org/wiki/Standard_streams)，这是一种不需要任何磁盘访问的进程间通信形式。如果作为 Apache 模块运行，PHP 实际上是 Apache 服务器的一部分。这比作为 CGI 执行要快得多，但有一些安全限制。

# webgl - Three.js 平面几何边框围绕纹理

> ID：14062212
> 
> 赞同：0
> 
> 时间：2012-12-27T22:40:01.810
> 
> 标签：webgl, three.js

我正在构建一个 3D 图像查看器，其中包含 Three.JS 平面几何图形作为占位符，图像作为纹理。

现在我想在图像周围添加一个黑色边框。我发现实现这一点的唯一方法是在要显示的图像后面添加一个新的黑色平面几何图形。但这需要对我的框架进行整体更改，而我想避免这种更改。

WebGL 的纹理加载函数 gl.texImage2D 有一个用于边框的参数。但是我无法通过 Three.js 在任何地方发现这一点，并且怀疑它是否以我认为的方式工作。

有没有更简单的方法在纹理周围添加边框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T12:02:08.483

您可以使用临时的常规 2D 画布来渲染图像并在其中应用任何类型的编辑/效果，例如绘制边框等。然后将该画布图像用作纹理。可能需要一些工作，但您将获得很大的灵活性来设计您的边框和其他内容。

我不在我的开发机器附近，也不会在几天内，所以我无法查找我自己的示例。此问题包含一些帮助您入门的代码：[https ://github.com/mrdoob/three.js/issues/868](https://github.com/mrdoob/three.js/issues/868)

# ruby-on-rails-3 - 什么时候需要在模型而不是控制器中定义方法？（来自 Rails 教程的第 10 章）

> ID：14062214
> 
> 赞同：1
> 
> 时间：2012-12-27T22:40:29.293
> 
> 标签：ruby-on-rails-3, railstutorial.org

我目前正在阅读 Hartl 的 Rails 教程，并且通过前 10 章左右已经习惯了将大部分动作/方法放在控制器中的约定。目前，由于本书正在为 Microposts[定义一个`feed`方法](http://ruby.railstutorial.org/chapters/user-microposts#sec-a_proto_feed)，该方法被放置在`User.rb` *模型*中。由于我对 Rails 世界（以及一般编程）相对较新，我想知道将这种方法（复制如下）放入模型中的基本原理或约定是什么？

模型中放置的方法`User.rb`：

```
 def feed
    # This is preliminary. See "Following users" for the full implementation.
    Micropost.where("user_id = ?", id)
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:18:27.793

实际上，关于将什么代码放在哪里存在相当多的争论，但总的来说，有一些简单的指导方针可以遵循。

该方法是否必须了解有关底层数据结构的一些细节？将其放入模型中。

确定这一点的一种简单方法是使用 ActiveRecord 方法，例如数据库中的 find、where 或特定列。通过将此逻辑保留在模型中，这意味着如果您需要更改底层数据存储，您只需更改模型。

该方法是否对如何呈现页面有发言权？将其放入控制器中。

一般来说，控制器应该很薄，将数据推送到视图并将表单数据保存回模型。

虽然（如果我没记错的话）Hartl 不考虑非 Rails 类，但不要害怕将“业务逻辑”放在 Rails 结构之外。您可以创建一个 app/lib 或 app/services 或 app/x 目录并将普通的旧 ruby​​ 对象放入其中，然后可以从您的控制器和模型中调用它们来处理它们擅长的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T03:02:17.133

旨在尽可能地将事物“推”到模型中，然后它们将被更少重复并可供更多人使用。不要只对 Active Record 数据库表使用模型。

您通常可以更轻松地对模型进行单元测试。

另一个放置共享内容的“下一个”地方是`/lib`

# matlab - 使用 libjpeg8d 构建 MATLAB jpeg 工具箱

> ID：14062215
> 
> 赞同：2
> 
> 时间：2012-12-27T22:40:32.130
> 
> 标签：matlab, mex, libjpeg

这个问题与我在这里提出的另一个问题有关：

[使用 Matlab 的 jpeg 工具箱中的 jpeg_read 读取图像时出错](https://stackoverflow.com/questions/13932561/error-reading-image-using-jpeg-read-from-matlabs-jpeg-toolbox)

我一直在尝试在 Windows 7 下编译 jpeg 工具箱（使用 Shai 在我发布的问题的答案中提供的命令），但出现以下错误：

```
jpeg_read.c(52) : fatal error C1083: Cannot open include file: 'jerror.h': No such file or directory 
```

我相信这是因为我还没有构建 libjpeg。我尝试像 jpegtoolbox 的 README 中所说的那样构建 libjpeg6b，但是我找不到关于如何使用 Visual Studio 2010 在 Windows 上执行此操作的明确指南（并且 libjpeg 的安装文档没有多大帮助），所以我结束了构建 libjpeg8d。

我的问题是是否有任何方法可以使用 libjpeg8d 来编译 jpeg 工具箱。我试过运行命令：

```
mex -I<IJGPATH> jpeg_read.c <LIBJPEG> 
```

IJGPATH 是我的 libjpeg8d 安装文件夹，LIBJPEG 是 jpeg.lib 文件的路径，在 IJGPATH/Release 中，但我仍然得到与以前相同的缺失 jerror.h 错误。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T01:39:42.070

Jpeg 工具箱包含用于处理 JPEG 文件的 Matlab 例程。虽然 Matlab 的内置 IMREAD 和 IMWRITE 函数提供 JPEG 文件和图像数组之间的基本转换，但它们不提供对 JPEG 图像细节的访问，例如 JPEG 系数或量化表。

这个包中的例程提供了从 Matlab 直接访问 JPEG 文件内容的附加功能，包括离散余弦变换 (DCT) 系数、量化表、霍夫曼编码表、色彩空间信息和注释标记。可以将工具箱添加到 Matlab 中使用这些功能。

首先检查您的系统中是否安装了以下内容。

1.Microsoft windows sdk7 2.Microsoft visual c++ 2010 express

如果未安装，请按指定顺序下载并安装它们。

注意：在安装windows sdk之前，请先卸载visual c++ 2010的所有redistributalbe包。否则windows sdk在安装过程中出现问题，安装失败。在安装过程中，不要忘记在 Windows 标头和库下检查 64 位操作系统的“x64 库”和 32 位操作系统的“x86 库”。这允许将编译器工具用于 64 位操作系统。一旦结束，安装visual c++。这些工具是免费的，可在微软网站上获得。在线和离线安装程序都可用。现在是真正的整合过程

第 1 步：下载 jpeg 工具箱并将其解压缩到单独的文件夹（例如 jpeg）

下载 jpeg 工具箱

第 2 步：下载 jpeg 源文件并将其解压缩到单独的文件夹（例如.jpegsrc）。在 jpegsrc 中的文件夹 jpeg-6b 中，将 jconfig.vc 重命名为 jconfig.h 并将 makefile.vc 重命名为 makefile

下载 jpegsrc 文件

第三步：从开始->所有程序->Microsoft windows sdk，打开命令提示符。这将打开“windows x64 调试环境”。导航到在步骤 2 中提取的 jpegsrc 文件夹内的 jpeg-6b 文件夹。运行不带引号的命令“nmake clean all”。这将在同一文件夹中创建 libjpeg.lib 文件。

第 4 步：现在打开 matlab 并选择第 1 步中创建的 jpeg 工作文件夹。

现在在命令窗口中运行以下命令， mex -I jpeg_read.c mex -I jpeg_write.c

替换为步骤 2 中创建的 IJG jpeg-6b 目录的路径，以及 IJG 代码库文件 (libjpeg.lib) 的完整路径。

要使用 jpeg_read 和 jpeg_write 函数，请将上面创建的 jpeg_read.mexw64 和 jpeg_write.mexw64 文件复制到您的工作目录。不要卸载 Visual C++ 编译器，否则它将无法工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T05:51:39.410

如果您尝试在 Windows 中工作，则需要将 jerror.vc 重命名为 jerror.h

此外，当您混合文件时，您需要编辑 jpeg_read.c 和 jpeg_write.c 从包含以包含“jerror.h”

# c# - 在表 'Models' 上引入 FOREIGN KEY 约束 'FK_dbo.Models_dbo.Makes_MakeId' 可能会导致循环或多个级联路径

> ID：14062216
> 
> 赞同：0
> 
> 时间：2012-12-27T22:40:37.740
> 
> 标签：c#, sql-server, asp.net-mvc, entity-framework

这是我探索 ASP.NET MVC 4 的第一天。具体来说，我使用的是 Web API，显然这个问题实际上是一个 MS SQL 问题。我正在运行 EF 迁移 PM> Update-Database 以获取此错误，但在第一次创建模型时已经看到它。我的模型是：

```
public class Car
{
    public int Id { get; set; }
    public string Name { get; set; }

    public int MakeId { get; set; }
    public virtual Make Make { get; set; }

    public int ModelId { get; set; }
    public virtual Model Model { get; set; }
}

public class Make
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Model> Models { get; set; }
}

public class Model
{
    public int Id { get; set; }
    public string Name { get; set; }

    public int MakeId { get; set; }
    public virtual Make Make { get; set; }
} 
```

数据库上下文是：

```
public class CarsContext : DbContext
    {
        public CarsContext() : base("name=CarsContext") { }
        public DbSet<Car> Cars { get; set; }
        public DbSet<Make> Makes { get; set; }
        public DbSet<Model> Models { get; set; }
    }
} 
```

将不胜感激任何帮助。我的背景是 PHP 和 MySQL 的 5/6，所以这是一个陡峭的学习曲线。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T12:48:09.320

卢克·麦格雷戈是正确的。除了您修复此问题的方式之外，您还可以覆盖实体框架为您提供的默认映射，以便它不会级联删除。在 CarsContext 类中，您可以覆盖 OnModelCreating() 方法并使用 fluent 指定您自己的映射。这会覆盖 EF 默认尝试执行的操作。所以你可以做这样的事情：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Car>()
            .HasOptional(x => x.Model)
            .WithMany(y => y.Cars) //Add this property to model to make mapping work
            .WillCascadeOnDelete(false);
} 
```

这仍然适用于自动迁移。

希望有帮助。

# php - PHP 内存使用量 - 1.5MB 很多吗？

> ID：14062220
> 
> 赞同：0
> 
> 时间：2012-12-27T22:41:00.750
> 
> 标签：php, memory, ram

我在 VPS 上运行一个站点，并且经常达到 93% 的内存使用率。我在其中一个较大的页面上使用了 PHP 中的 memory_get_usage() 函数，它说它使用了超过 1,500,000 的内存。很多吗？是否有健康网站的通用基准？

我的网站甚至没有那么复杂，尽管它是手动编码的，没有使用任何框架。

令人担忧的是，我将内存使用量的大幅提升追溯到代码行，其中包含一个文件（125kb），其中包含我所有的 PHP 函数（是的，我可能应该将函数分离到单独的库中，并根据需要包含它们） .

包含该文件后，该页面的内存使用量立即从 250k 跃升至 1.4MB。这是正常的吗？实际上还没有调用这些函数，它只是一个函数库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:58:59.120

1.5mb 对于 PHP 程序来说没什么好担心的。

20mb 我也不担心。

50mb 会更令人担忧，这取决于程序在做什么。

但是，当然，它确实在很大程度上取决于个别程序。

在您的情况下，向脚本添加一堆函数肯定会占用您所看到的那种顺序的大量内存。那里没有什么不寻常的地方。

但是1.5meg并不是很多。你的 VPS 有多少内存？有多少并发 PHP 脚本正在运行以耗尽整个 RAM 分配？

您的脚本速度可能存在问题——PHP 脚本应该在最短的时间内运行，因此 1.5mb 不应该长时间使用。但是，如果您的脚本需要花费太多时间，则可能会导致更多用户同时运行该脚本。此外，如果速度很慢，这些用户可以尝试多次刷新，这肯定会耗尽你的内存，因为单个用户将同时运行多个脚本副本。因此，寻找提高代码性能的方法；这可以帮助你。

另一个问题：你的页面是静态的吗？可以缓存吗？即，如果您的 PHP 页面在每次加载时都生成相同的 HTML 输出，您可以通过缓存输出为自己节省大量 RAM（并显着提高性能），这样 PHP 代码就不需要在每次页面时都运行被要求。像 Varnish 这样的缓存服务器将对此有所帮助。

我希望这有助于回答这个问题并为您提供更多思考方向。

# android - 尝试使用 onClick 更改相机的闪光率

> ID：14062221
> 
> 赞同：0
> 
> 时间：2012-12-27T22:41:10.587
> 
> 标签：android, onclick, android-camera

我希望当我按下按钮 btlento 时相机闪光灯会缓慢闪烁，因为我制作了这些变量：

```
int counter = 1;
int deloy = 2000;
int poriod = 2000;
int deloy1 = 1000;
int poriod1 = 2000; 
```

这是带有代码的按钮：

```
case R.id.btlento:

        do{
            cameraOn();
            Timer timer = new Timer();
            timer.scheduleAtFixedRate(new TimerTask() {

                @Override
                public void run() {
                    // TODO Auto-generated method stub
                    cameraOff();
                    counter = counter+1;
                }
            },deloy1,poriod1);

            Timer timer2 = new Timer();
            timer2.scheduleAtFixedRate(new TimerTask() {

                @Override
                public void run() {
                    // TODO Auto-generated method stub
                    cameraOn();
                }
            },deloy,poriod);

                }while(counter>=60);
        break; 
```

并且另一个按钮必须更快地闪烁，所以我制作了这些其他变量：

```
int j = 1;
int delay = 600;
int period = 600;
int delay1 = 300;
int period1 = 600; 
```

这些是带有方法的按钮：

```
case R.id.btrapid:

        do{
            cameraOn();
            Timer timer = new Timer();
            timer.scheduleAtFixedRate(new TimerTask() {

                @Override
                public void run() {
                    // TODO Auto-generated method stub
                    cameraOff();
                    j = j+1;
                }
            },delay1,period1);

            Timer timer2 = new Timer();
            timer2.scheduleAtFixedRate(new TimerTask() {

                @Override
                public void run() {
                    // TODO Auto-generated method stub
                    cameraOn();
                }
            },delay,period);

                }while(j>=5);

        break; 
```

现在他们在不停地眨眼，为什么？？？？方法 cameraOn 是：

```
private void cameraOn() {
            // TODO Auto-generated method stub
             camera = Camera.open();
             parameters = camera.getParameters();
             parameters.setFlashMode(Parameters.FLASH_MODE_TORCH);
             camera.setParameters(parameters);
        } 
```

cameraOff 是：

```
private void cameraOff() {
            // TODO Auto-generated method stub
             parameters.setFlashMode(Parameters.FLASH_MODE_OFF);
             camera.setParameters(parameters);
             camera.release();
             camera = null;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:55:27.540

假设`counter`并且`j`没有在其他地方修改，您永远不会进入 while 块，它可能应该是：

```
while(counter<=60) 
```

和：

```
while(j<60) 
```

# objective-c - 是否存在所有objective-c 类的层次结构图？

> ID：14062222
> 
> 赞同：1
> 
> 时间：2012-12-27T22:41:12.903
> 
> 标签：objective-c, class

我刚刚了解到类存在于层次结构中。每个类都有一个超类，它的父类，对整个层次结构的根类 NSObject 除外。所以 NSMutableArray 继承自 NSArray，NSArray 继承自 NSObject，NSString 继承自 NSObject 等等。

那么有人有所有遗产的照片吗？我知道有这么多，所以它会很大，也许不可能在一张图片中列出它们。但这将是一个有趣的参考。

像这样的东西可能没有必要，但看看会很有趣。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:02:00.243

这只是部分答案：

[“Foundation Framework Reference”中的Cocoa Objective-C Hierarchy for Foundation](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/ObjC_classic/Intro/IntroFoundation.html#//apple_ref/doc/uid/20000687-25735)显示了 Foundation 类的层次结构。

当然，还有更多的框架定义了派生自`NSObject`or的类`NSProxy`，但我不知道是否存在这些类似的图片。

# java - java新手，卡在第4章数组上

> ID：14062224
> 
> 赞同：1
> 
> 时间：2012-12-27T22:41:17.190
> 
> 标签：java

我是 Java 的初学者，我正在学习 Head First Java。在一个示例中，它给出了以下代码并询问可能的输出（给出为：14 1）。m4a[x].counter 做什么？我们从中得到什么价值？谢谢你。

```
public class Mix4{
  int counter = 0;
  public static void main(String args[]){
    int count = 0;
    Mix4 [] m4a = new Mix4[20];
    int x = 0;
    while (x < 9){
      m4a[x] = new Mix4();
      m4a[x].counter = m4a[x].counter+1;
      count = count + 1;
      count = count + m4a[x].maybeNew(x);
      x = x + 1;
    }
    System.out.println(count + " " + m4a[1].counter);
 }
 public int maybeNew(int index){
   if(index<5){
     Mix4 m4 = new Mix4();
     m4.counter = m4.counter + 1;
     return 1;
  }
  return 0;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:46:07.293

在我看来，`m4a[x].counter`除了`1`每次都设置为之外，它什么也没做。在数组中创建新对象时：

```
m4a[x] = new Mix4(); 
```

设置`counter`为 0。

```
int counter = 0; 
```

所以下面的行：

```
m4a[x].counter = m4a[x].counter+1; 
```

只是将其设置为值“0 + 1”。

该数组中的前 9 个元素的`counter`值为 1，其他 11 个元素尚未初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:46:50.220

看起来您有一个包含 20 个 Mix4 对象的数组，该数组称为“m4a”。m4a[x] 是数组“x”位置的 Mix4 对象，m4a[x].counter 正在寻址该对象的“counter”变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:48:06.833

`m4a`是一个类型的数组`Mix4`并且`x`是一个 int。，由 索引`m4a[x]`的特定项也是如此。`Mix4``x`

如果`x`为 0，则表示数组中`m4a[x]`的第零个。`Mix4`如果`x`为 1，则为之后的那个，依此类推。

现在 Mix4 类有一个名为的元素`counter`，可以通过`variablethatisaMix4.counter`

所以

`m4a[x].counter`或将其可视化： `(m4a[x]).counter`是`counter`属于`x`数组中第 th 项的字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T00:02:17.627

您是否正确复制并粘贴了代码？这不是学习数组的简单方法！

# flash - JSFL 如何设置我刚刚添加的文本字段的实例名称？

> ID：14062228
> 
> 赞同：1
> 
> 时间：2012-12-27T22:41:51.073
> 
> 标签：flash, textfield, jsfl

我刚刚开始在 Adob​​e Flash 中使用 JSFL，我正在尝试向新创建的图层添加一个文本字段，然后将其实例名称更改为“属性”。

这是我的代码：

```
fl.outputPanel.clear();

var document = fl.getDocumentDOM();

var timeline = document.getTimeline();

var layers = timeline.layers;

var propertiesLayer = null;

var propertiesTextBox = null;

var layerIndex = 0;

fl.trace("Searching For Properties Layer");

for (var index in layers)
{
    if(layers[index].name == "properties")
    {
        propertiesLayer = layers[index];
        layerIndex = index;
    }
}

if(!propertiesLayer)
{
    fl.trace("Creating Properties Layer");
    timeline.addNewLayer("properties");
    layerIndex = timeline.findLayerIndex("properties");

    fl.trace("Properties Layer Index is " + layerIndex);
    propertiesLayer = layers[layerIndex];

    timeline.setSelectedLayers(layerIndex * 1);

    fl.trace("Creating Properties Text Field");
    document.addNewText({left:0, top:-100, right:100, bottom:0});

    propertiesLayer.frames[0].elements[0].name = "properties";

    fl.trace("Setting Properties Text Field's Instance Name");
    //propertiesTextBox.name = "properties";

    fl.trace("Setting Properties Text Field");
    document.setTextString("test");
} 
```

我的输出窗口显示： Searching For Properties Layer Creating Properties Layer Properties Layer Index is 0 Creating Properties Text Field

在测试新的 Flash 文档 TypeError:propertiesLayer.frames[0].elements[0] has no properties 时出现以下错误

我很茫然，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:05:25.853

修改了您的代码，它可以工作。以下只是我修改代码的部分。不过还需要一些改进。

```
if(!propertiesLayer)
{
      timeline.addNewLayer("properties");
      layerIndex = timeline.findLayerIndex("properties");

      propertiesLayer = layers[layerIndex];

      timeline.setSelectedLayers(0);

      document.addNewText({left:0, top:-100, right:100, bottom:0});

      document.setTextString("test");

      var element = document.selection[0];

      document.selection[0].textType = "dynamic";
      element.name = "properties";   

 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T00:09:58.903

调用 addNewText() 时，创建的文本字段类型是最后创建的类型。因此，如果您创建了一个静态字段然后运行您的代码，它会如您所见的那样出错，因为静态文本字段不能有实例名称（使用“名称”属性设置）。这是您的问题的快速解决方案：

```
propertiesLayer.frames[0].elements[0].textType = "dynamic";
propertiesLayer.frames[0].elements[0].name = "properties"; 
```

希望有帮助！

# google-visualization - Google Chart API 是否会将您的图表数据发送给 google？

> ID：14062230
> 
> 赞同：2
> 
> 时间：2012-12-27T22:41:59.423
> 
> 标签：google-visualization

有谁知道[Google Chart API](https://developers.google.com/chart/interactive/docs/index)是否将用于生成图表和可视化的原始数据发送给 Google？
换句话说，是由 Google 的服务器生成的图表和可视化，或者它们是由 Chart API 的 Javascript 库在本地生成的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T23:25:49.557

如果您谈论的是从 url（图表 api）生成的图表，那么来自常见问题解答

[https://developers.google.com/chart/interactive/faq#chartapi](https://developers.google.com/chart/interactive/faq#chartapi)

> Google Chart API 和 Google Visualization API 有什么区别？
> 
> Chart API 提供了一种创建各种图像图表的简单方法，方法是将包含***数据和图表配置选项***的格式化 URL 发送到 Google 服务器。Chart API 包括一组带有各种选项的封闭图表。Chart API 数据集仅限于 URL 的大小（大约 2K）。

对于可视化 API，它取决于图表/可视化，请参阅数据策略，例如折线图

[https://developers.google.com/chart/interactive/docs/gallery/linechart#Data_Policy](https://developers.google.com/chart/interactive/docs/gallery/linechart#Data_Policy)

# unit-testing - 检索测试执行结果：单元测试

> ID：14062232
> 
> 赞同：0
> 
> 时间：2012-12-27T22:42:06.270
> 
> 标签：unit-testing, maven, testng

我是测试新手：我必须执行 selenium 测试，为此我正在使用 TestNG（因为我需要报告和日志文件），所以在执行后我将显示执行失败或成功的结果，那么如何我得到了测试的结果。

```
public class GoogleNavigationTest {
@Test
public  void testApp(){

    // Create a new instance of the Firefox driver
    // Notice that the remainder of the code relies on the interface, 
    // not the implementation.
    WebDriver driver = new FirefoxDriver();

    // And now use this to visit Google
    driver.get("http://www.google.com");
    // Alternatively the same thing can be done like this
    // driver.navigate().to("http://www.google.com");

    // Find the text input element by its name
    WebElement element = driver.findElement(By.name("q"));

    // Enter something to search for
    element.sendKeys("Cheese!");

    // Now submit the form. WebDriver will find the form for us from the element
    element.submit();

    // Check the title of the page
    System.out.println("Page title is: " + driver.getTitle());

    // Google's search is rendered dynamically with JavaScript.
    // Wait for the page to load, timeout after 10 seconds
    (new WebDriverWait(driver, 10)).until(new ExpectedCondition<Boolean>() {
        public Boolean apply(WebDriver d) {
            return d.getTitle().toLowerCase().startsWith("cheese!");
        }
    });

    // Should see: "cheese! - Google Search"
    System.out.println("Page title is: " + driver.getTitle());

    //Close the browser
    driver.quit();
}

} 
```

我正在使用 maven 通过`mvn test`命令行运行测试。

任何 hep 将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T09:57:34.597

如果您正在测试一个应用程序，您将验证一些预期的结果。为此，您需要向您的测试用例添加断言，以断言您所期望的就是您的应用程序的行为方式。TestNG 最近添加了[灵活](http://beust.com/weblog/2012/07/29/reinventing-assertions/) [断言](https://groups.google.com/forum/?fromgroups=#!topic/testng-users/Q5KGi30f0FE)的功能。

TestNG 自动生成的报告是您的输出文件夹中的 index.html，它可以为您提供执行详细信息和日志（如果您已记录任何日志）以及失败（如果有）。

# c# - 泛型函数错误

> ID：14062238
> 
> 赞同：1
> 
> 时间：2012-12-27T22:42:29.847
> 
> 标签：c#, generics

我正在尝试使用泛型编写简单的 C# 函数。例如数组解析器。

```
public static int parse_array <T> ( string str, ref T[] array ) 
    where T : IConvertible<T>
{
    string[] vals=str.Split(new char[]{'','\t',',',';'}, StringSplitOptions.RemoveEmptyEntries);

    if( vals==null || vals.Length==0 )
        return 0;

    array = new T[vals.Length];

    for( int i=0; i<vals.Length; i++ )
    {
        array[i] = Convert.ChangeType ( vals[i], T );
    }

    return vals.Length; 
} 
```

但我收到错误：非泛型类型“System.IConvertable”不能与类型参数一起使用。怎么了 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T22:53:00.377

您的特定编译器错误的问题在于`IConvertible`它不是通用接口，您的子句应该是：

```
where T : IConvertible 
```

不是

```
where T : IConvertible<T> 
```

实际上，编译器错误告诉您您正在尝试将类型参数（即`<T>`）放在非泛型类型（即 interface `IConvertible`）上。虽然某些接口是通用的或具有通用的并行性，`IConvertible`但不是其中之一。

然后，此外，您将希望在调用中使用`typeof(T)`而不是，因为它是类型名称，而不是克里斯提到的实例...`T``ChangeType``T``Type`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:11:27.330

我看到这已经被回答了，我想我有点慢。但是我添加了一个更简单的数组转换实现。

```
public static int parse_array<T>(string str, ref T[] array) where T : IConvertible
{
    string[] vals = str.Split(new char[] { '\t', ',', ';' }, StringSplitOptions.RemoveEmptyEntries);

    if (vals == null || vals.Length == 0)
        return 0;

    array = Array.ConvertAll<string, T>(vals, (o) => (T)Convert.ChangeType(o, typeof(T)));

    return vals.Length;
} 
```

# c# - 将两个 DataTable 合并到一个 DataGrid 中

> ID：14062243
> 
> 赞同：0
> 
> 时间：2012-12-27T22:42:56.720
> 
> 标签：c#, .net, datagrid, datatable, wpfdatagrid

我在 C# 的 DataSet 中有两个 DataTables（第一个 DataTable 包含一组唯一的标识符和一些关联数据，但第二个 DataTable 将包含每个外键标识符的多个记录），我想做的是使用一个 DataGrid，用于显示第一个 DataTable 中的所有数据，并在该 DataGrid 中有一个列，该列在下拉框中显示第二个 DataTable 中的数据。

这甚至可能吗？如果可以，您会如何建议这样做？

我看过做一个 JOIN 但它似乎违反了拥有唯一记录的约束。

# ruby - 是否可以在一个块内调用 yield ？

> ID：14062246
> 
> 赞同：4
> 
> 时间：2012-12-27T22:43:04.597
> 
> 标签：ruby

我对这是否可以完成以及语法是什么感兴趣。我在：

```
def say_it
  puts "before"
  yield("something here")
  puts "after"
end

say_it do |val|
  puts "here is " + val
  yield("other things") # ???
end 
```

认为可能没有，但也许如果块被转换为 Proc？

提前谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T23:28:27.027

A仅*在*采用块的方法中`yield`才有意义。

 *是的，它们可以筑巢。注意：

1.  遍历仍然沿着堆栈发生；和
2.  块（和`yield`）与方法严格相关。

例子：

```
def double(x)
    yield x * 2
end

def square_after_double(x)
    double(x) do |r|
       # Yields to the block given to the current method.
       # The location of the yield inside another block
       # does not change a thing.
       yield r * r
    end
end

square_after_double(3) do |r|
  puts "doubled and squared: " + r.to_s
end 
```*

# javascript - Facebook javascript支付对话框加载然后消失而不调用回调函数

> ID：14062247
> 
> 赞同：0
> 
> 时间：2012-12-27T22:43:25.090
> 
> 标签：javascript, facebook-javascript-sdk

我设法得到一个按钮来调用facebook支付对话框，一切都很花哨，它打开了正确的数据，并在正确的时间用正确的数据调用了购买回调页面。

现在虽然它在加载后没有显示（尽管我认为任何数据（甚至代码）都没有改变）。

当我单击按钮时，付款对话框打开并显示加载，并且在对话框打开时完成的购买回调页面完成的所有数据库更改都正确且完整地完成。接下来加载对话框消失，我的 javascript 回调函数没有被调用，也没有其他任何事情发生。

如果我更改数据，例如，价格是一个字符串而不是一个数字，那么我会打开支付对话框并显示正确的错误，而不仅仅是加载屏幕，并调用我的回调函数。

我不确定问题出在哪里，这是我调用支付 UI 的代码：

```
FB.ui({  
    method: 'pay',  
    order_info: {  
        pkgnum: d.id,  
        title: d.name,  
        description: d.desc,  
        price: d.cost,  
        image_url: 'images/coin.png',  
        product_url: 'images/coin.png',  
        userid: username  
    },  
    purchase_type: 'item'  
}, fbPurchaseCallback ); 
```

这是 UI 接收到的用于显示项目付款信息的数据：

```
{
    "content":[{
        "pkgnum":20,
        "title":"Lolname",
        "description":"Loldesc",
        "price":100,
        "image_url":"images/coin.png",
        "product_url":"images/coin.png",
        "userid":"254884",
        "item_id":"254884"
    }],
    "method":"payments_get_items"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T13:53:43.660

`images/coin.png`问题是由于某种原因无法找到 facebook 。现在解决了。

# c#-4.0 - 正式支持 MonoTouch 的 NoSQL 数据库

> ID：14062248
> 
> 赞同：11
> 
> 时间：2012-12-27T22:43:55.697
> 
> 标签：c#-4.0, xamarin.ios, nosql

我无法通过设备上的本地数据库找到正式支持 MonoTouch 的 NoSQL 数据库。如果他们是，有人可以在这里提供他们的名单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:43:26.177

根据[http://nosql-database.org/](http://nosql-database.org/)有[siaqodb](http://siaqodb.com/)。请注意，其他人可能支持 MonoTouch，但在该站点中未提及。

**编辑**：再点击几下显示[HSS 数据库](http://highspeed-solutions.net/hssdb)（来自同一个列表）也支持 MonoTouch。

您可能还想查看哪些支持iOS（例如使用Objective C）并查看绑定是否可用（或编写您自己的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-29T18:19:41.213

看看[Couchbase Lite](http://components.xamarin.com/view/couchbase-lite-net) xamarin 的组件

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T18:39:06.710

[RavenDB](http://www.ravendb.net)支持嵌入式模式，并且可以使用“Munin”存储引擎选项在 Mono 上运行。

不过，最近用户群中一直在讨论要放弃 Munin，并且通常不建议将其用于生产，因此它可能不是一个可行的选择。

我没有听说有人专门将它与 MonoTouch 一起使用，但是有些人在 Mono 上运行它。如果您尝试，请在此处更新您的发现的评论。谢谢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-30T11:16:41.307

有点晚了，但仍然相关：

我是 MarcelloDB 的作者，我刚刚在[nuget](https://www.nuget.org/packages/MarcelloDB/)上发布了 0.3.0 版本。

[MarcelloDB](https://github.com/markmeeus/MarcelloDB)是一个文档数据库，专为移动应用程序（轻量级、低内存使用）构建，支持 Xamarin Android 和 iOS 以及 windows 平台。

在达到 v1 之前，我还有一些想要添加的功能，但是文件格式和现有的 api 都已经相当稳定了。

# notepad++ - 如何在记事本++中添加自定义代码快捷方式

> ID：14062250
> 
> 赞同：3
> 
> 时间：2012-12-27T22:44:01.060
> 
> 标签：notepad++

notepad++ 中是否有一个功能或插件，我可以在其中键入自定义关键字并将其替换为自定义代码？

例如，我输入：

```
<html> 
```

它会变成：

```
<!DOCTYPE HTML>

<html>

<head></head>
<body></body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:25:06.217

您想要用于制作片段或类似内容的插件吗？在记事本++中？如果是这样的话，[Notepad++ 代码片段管理器](https://stackoverflow.com/questions/5147177/notepad-code-snippets-manager)已经存在这样的问题，或者[试试这个](http://sourceforge.net/projects/quicktext/)

# mongodb - Morphia 在性能方面 fetch 和 asList 有区别吗

> ID：14062251
> 
> 赞同：2
> 
> 时间：2012-12-27T22:44:03.070
> 
> 标签：mongodb, morphia, mongodb-query, mongo-java

我们正在使用 morphia 0.99 和 java driver 2.7.3 我想了解使用 asList 获取记录`fetch`和检索结果之间有什么区别（假设有足够的内存来检索记录`asList`）。

我们迭代了一个大集合，而`fetch`我在获取操作期间有时`cursor not found exception`在服务器上遇到使用，所以我需要执行另一个命令才能继续，这可能是什么原因？

```
1-)fetch the record 
2-)do some calculation on it 
3-)+save it back to database again 
4-)fetch another record and repeat the steps until there isn't any more records. 
```

那么哪一个会更快呢？使用 asList 逐一获取记录或检索大量结果，或者使用 morphia 实现它们之间没有任何区别？

感谢您的回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-08T10:13:58.503

据我了解实现，`fetch()`来自数据库的流结果同时`asList()`会将所有查询结果加载到内存中。因此，它们都将获取与查询匹配的每个对象，但`asList()`会将它们全部加载到内存中，而`fetch()`由您决定。

对于您的用例，它在 CPU 方面都不会更快，但`fetch()`应该使用更少的内存并且不会在您有很多数据库记录的情况下爆炸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:47:00.050

从源代码来看，为您[`asList()`](https://code.google.com/p/morphia/source/browse/trunk/morphia/src/main/java/com/google/code/morphia/query/QueryImpl.java#261)使用[`fetch()`](https://code.google.com/p/morphia/source/browse/trunk/morphia/src/main/java/com/google/code/morphia/query/QueryImpl.java#235)和汇总结果，因此我看不出两者之间有太大区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-14T02:44:48.740

一个非常有用的区别是，如果以下两个条件适用于您的场景：

1.  您在查询中使用`offset`and `limit`。
2.  您正在更改对象上的值，以使其不再在查询中返回。

假设您正在对 进行查询`awesome=true`，并且您正在使用`offset`and`limit`进行多个查询，一次返回 100 条记录，以确保您没有使用太多内存。如果在迭代循环中设置`awesome=false`对象并保存它，则会导致您错过更新某些记录。

在这种情况下，`fetch()`将是一个更好的方法。

# asp.net-mvc-3 - MVC 3 如何判断从哪个视图调用控制器操作-

> ID：14062257
> 
> 赞同：2
> 
> 时间：2012-12-27T22:45:17.910
> 
> 标签：asp.net-mvc-3, view, controller

有没有办法告诉从哪个视图调用控制器操作？例如，我想使用“ControllerContext.HttpContext.Request.PhysicalPath”，但它返回控制器操作本身所在的路径：

```
 public ActionResult HandleCreateCustomer()
    {
        // Set up the customer
        //..code here to setup the customer

        //Check to see of the calling view is the BillingShipping view
        if(ControllerContext.HttpContext.Request.PhysicalPath.Equals("~/Order/BillingShipping"))
        {
            //
            return RedirectToAction("OrderReview", "Order", new { id = customerId });
        }
        else
        {
            return RedirectToAction("Index", "Home", new { id = customerId });
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:50:29.563

如果您有固定数量的可以调用它的位置，则可以创建一个枚举，其中每个值都对应于可以调用它的位置。然后，您只需将此枚举值传递给 HandleCreateCustomer，并基于此执行您的条件语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-20T22:52:45.187

我找到了另一种方法。在控制器中，您想知道它是从哪个页面调用的。我在控制器中添加了以下内容

```
ViewBag.ReturnUrl = Request.UrlReferrer.AbsolutePath; 
```

然后在视图中我有一个“返回”按钮

```
@(Html.Kendo().Button().Name("ReturnButton")
            .Content("Back to List").Events(e => e.Click("onReturn"))
            .HtmlAttributes(new { type = "k-button" })
        ) 
```

然后是 onReturn 处理程序的 javascript

```
function onReturn(e) {
    var url = '@(ViewBag.ReturnUrl)';
    window.location.href = url;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-29T22:36:49.900

目前我正在使用类似的东西：

在视图中，我使用以下方法填充 TempData 变量：

```
@{TempData["ViewPath"] = @Html.ViewVirtualPath()} 
```

HtmlHelper 方法 ViewVirtualPath() 位于 System.Web.Mvc.Html 命名空间中（和往常一样），如下所示，并返回一个表示 View 虚拟路径的字符串：

```
public static string ViewVirtualPath(this HtmlHelper htmlHelper)
    {            
        try{
            return ((System.Web.WebPages.WebPageBase)(htmlHelper.ViewDataContainer)).VirtualPath;
        }catch(Exception){
            return "";
        }
    } 
```

然后，我显然会读取控制器中的 TempData 变量。

# asp.net-mvc - 实现显示模式

> ID：14062265
> 
> 赞同：2
> 
> 时间：2012-12-27T22:45:54.697
> 
> 标签：asp.net-mvc, asp.net-mvc-4, device-detection

我目前正在使用 mvc 4 并有兴趣实现 DisplayModes 功能，该功能可以嗅探访问该站点的浏览器并根据浏览器/设备呈现适当的视图。

例如，检查 iphone 并呈现适用视图的代码：

```
DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("iPhone")
{
    ContextCondition = (context => context.Request.UserAgent.IndexOf
        ("iPhone", StringComparison.OrdinalIgnoreCase) >= 0)
}); 
```

我已经阅读了它开箱即用的内容，它会嗅探移动设备，并将移动名称添加到视图中。

我想为平板电脑创建一个类似的位。有没有人实施过这个或如何做到这一点的说明？我可以去检查平板电脑的用户代理等，但是这个功能很受欢迎，所以想知道是否有人已经实现了这个功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T07:48:56.370

这是一个非常好的概述和 ASP.Net 上的示例，称为[ASP.NET MVC 4 Mobile Features](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)。几乎所有的 DisplayModes 都带有示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:56:11.030

HTTP 中没有*平板电脑这样的概念。*有用户代理。平板电脑使用不同的用户代理。这是[`a list`](http://mojosunite.com/tablet-user-agent-strings)其中的一些。因此，您所要做的就是调整您显示的代码，以将这些用户代理的子字符串与特定设备相匹配。

# python - Python while 循环

> ID：14062266
> 
> 赞同：8
> 
> 时间：2012-12-27T22:45:59.703
> 
> 标签：python

我在 python 3 中有这段代码，用于检查输入错误，但我需要确定输入是否为整数，如果不是则打印错误消息。

谁能帮我找出我的while循环中的代码。谢谢

```
price = 110;

ttt = 1;

while price < 0 or price > 100:

    price = input('Please enter your marks for Maths:');
    ttt =ttt +1;
    if ttt >= 2:
        print( 'This is an invalid entry, Please enter a number between 0 and 100') 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T22:51:25.660

使用该`int()`函数转换为整数。这将在无法进行转换时引发 ValueError ：

```
try:
    price = int(price)
except ValueError as e:
    print 'invalid entry:', e 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T23:22:25.350

你可能想要这样的东西，它会捕获价格是否为整数以及是否在 0 到 100 之间，如果满足这些条件，则中断循环。

```
while True:
    price = raw_input('Please enter your marks for Maths:')
    try:
        price = int(price)
        if price < 0 or price > 100:
            raise ValueError
        break
    except ValueError:
        print "Please enter a whole number from 0 to 100"

print "The mark entered was", price 
```

或者，由于您的可能值数量很少，您还可以执行以下操作：

```
valid_marks = [str(n) for n in range(101)]
price = None
while price is None:
    price = raw_input('Please enter your marks for Maths:')
    if not price in valid_marks:
       price = None
       print "Please enter a whole number from 0 to 100" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T22:50:54.787

首先，使用`raw_input`代替`input`.

此外，`ttt`在您的输入之前放置检查，以便正确显示错误：

```
price = 110;
ttt = 1;
while price < 0 or price > 100:
    if ttt >= 2:
        print 'This is an invalid entry, Please enter a number between 0 and 100';
    price = raw_input('Please enter your marks for Maths:');
    ttt = ttt +1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-20T11:52:47.583

我会说最简单的事情是做而不是做

```
price=int(price) 
```

做

```
price=int(110) 
```

# jquery - Twitter Bootstrap 和 Google Maps - 渲染问题

> ID：14062276
> 
> 赞同：0
> 
> 时间：2012-12-27T22:47:29.690
> 
> 标签：jquery, twitter, twitter-bootstrap, maps

我目前正在尝试在同一页面上同时使用 Google Maps 和 Twitter Bootstrap 来实现某些东西，并且在 Google Maps 正文上使用模式时遇到了问题。

这是我当前的开发快照： http: [//getmerch.scootaloo.at/snapshot-2012-12-27.php](http://getmerch.scootaloo.at/snapshot-2012-12-27.php)

通常，GMaps InfoWindows 中的“更多信息...”按钮应该打开一个引导模式，但它不会。如果不显示地图画布，则相同的按钮代码将起作用（删除地图画布就足够了 - 不需要删除实际的 Maps JScript 代码）。

InfoWindows 也呈现不正确。

你们知道我该如何解决这个问题吗？

提前致谢。

——肯尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:15:21.503

在您的地图 div 上尝试以下 css：

```
#map img {
  max-width: none;
} 
```

这解决了我的 bootstrap / gmaps 图像问题。

# html - 您如何编写介绍图片链接到主帖的 tumblr 页面？

> ID：14062278
> 
> 赞同：-1
> 
> 时间：2012-12-27T22:47:39.940
> 
> 标签：html, css, tumblr

一个例子是[这个网站](http://theoatmeal.com/)，其中图片链接到实际帖子（如存档页面）。我如何在 tumblr 上编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T15:59:43.603

你可以尝试这样做：

```
<a href="{Permalink}"><img src="you know what goes here"></a> 
```

确保这是**在**您的 {block:Photo}**和**{/block:Photo} 代码之间，否则它将无法工作。

如果这没有任何意义，我建议你在这里做一些阅读： [Basic Posts Markup Tumblr](http://buildthemes.tumblr.com/ch2/post-markup)

祝你好运！

# objective-c - 以编程方式编辑 NSTableView 的特定行和列

> ID：14062280
> 
> 赞同：0
> 
> 时间：2012-12-27T22:47:45.417
> 
> 标签：objective-c, macos, cocoa, nstableview

我想按下一个按钮，并在我的 NSTableView 中有一个特定的框将其值更改为其他值。那可能吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:54:59.803

改变模型。

也就是从你的数组控制器中获取你想要改变的对象，然后修改它的属性。

如果您使用绑定，表格将自动重新加载更改的单元格。如果您使用的是表格视图数据源方法，只需让表格视图重新加载更改后的单元格，使用`-reloadDataForRowIndexes:columnIndexes:`.

# java - Android单击时更改TextView中的文本大小

> ID：14062281
> 
> 赞同：0
> 
> 时间：2012-12-27T22:47:51.530
> 
> 标签：java, android, android-layout, textview

我有几个按钮只包含标签。它们是使用 2 个图像资源制作的（按下比未按下大一点）

```
button_image.png
button_image_pressed.png 
```

和xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:drawable="@drawable/button_image" android:state_pressed="false"/>
    <item android:drawable="@drawable/button_image_pressed" android:state_pressed="true"/>

</selector> 
```

我想使用这个的自定义 TextView。是否可以在用户触摸文本时更改 TextView textSize 并在文本用户释放屏幕时更改 textSize？

我尝试了不同的解决方案，但没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T22:59:37.487

您可以尝试使用`onTouchListener()`.

```
 textView.setOnTouchListener( new OnTouchListener() {

        @Override
        public boolean onTouch( View v, MotionEvent event ) {

            switch(event.getAction()) {
                case MotionEvent.ACTION_DOWN:
                    textView.setTextSize( ... );
                    break;
                case MotionEvent.ACTION_CANCEL:
                case MotionEvent.ACTION_UP:
                    textView.setTextSize( ... );
            }
            return false;
        }
    } ); 
```

# java - Java：为什么 WeakHashMap 实现了 Map，而 AbstractMap 已经实现了它？

> ID：14062286
> 
> 赞同：1
> 
> 时间：2012-12-27T22:48:36.757
> 
> 标签：java, collections, weakhashmap

> **可能重复：**
> [Java.util.HashMap — 为什么 HashMap 扩展 AbstractMap 并实现 Map？](https://stackoverflow.com/questions/2294519/java-util-hashmap-why-hashmap-extends-abstractmap-and-implement-map)
> [为什么父类和子类都实现相同的接口？](https://stackoverflow.com/questions/5668429/why-would-both-a-parent-and-child-class-implement-the-same-interface)

**WeakHashMap<K,V>**被声明为扩展**AbstractMap<K,V>**并实现**Map<K,V>**。

但是**AbstractMap<K,V>**已经实现了**Map<K,V>**。看起来`implements`声明是多余的。

它被宣布的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:52:39.250

除非有人能够指出`WeakHashMap`JDK 的作者在网上某处发布的原因，否则我们只能推测。推测是它改进了自动生成的文档。它对类公开的接口或您如何使用它没有影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T22:51:16.087

虽然它确实是多余的，但它确保了如果接口实现从父级中移除，子级仍然会被`Map`接口持有并产生必要的编译错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T23:00:54.540

这个“看起来”像是一个俯瞰。如果您扩展一个类，您将自动实现基类实现的所有接口（无论该基类是否`abstract`存在）。所以，给定：

```
public interface I {}

public class A implements I {} 
```

你声明：

```
public class B extends A {} 
```

上面的声明严格等同于

```
public class B extends A implements I {} 
```

确实是一个俯瞰。很好的发现;)

# python - 从mysql生成python中的名称列表

> ID：14062289
> 
> 赞同：1
> 
> 时间：2012-12-27T22:48:57.880
> 
> 标签：python, mysql, list, mysql-connector-python

我目前能够生成包含信息的文本文件，但由于某种原因，我无法将数据发送到列表中。我试过两种方法：

```
cnx = mysql.connector.connect(user='root', database='smor')
cursor = cnx.cursor()
sqlQuery = ("SELECT id,name,CAST(aa_seq as CHAR(65535)) aa_seq FROM smor.domain_tbl WHERE domain_type_id=5 AND domain_special IS NULL LIMIT 100000")
cursor.execute(sqlQuery)

print "Generating FASTA file: ", FASTA_File1
with open(FASTA_File1, "w") as FASTA1:
    for (aa_id, name, aa_seq) in cursor:
        FASTA1.write(">" + name + '\n' + aa_seq + '\n')
        print ">" + name + '\n' + aa_seq

ListOfNames =[]
for (aa_id, name, aa_seq) in cursor:
        ListOfNames.append(name)
cursor.close()
print "ListOfNames", ListOfNames 
```

这成功地将名称和氨基酸序列打印到文本文件中，但字符串为空。这是控制台中输出的最后几行：

```
>NC_018581.1_05_011_001_020 P
RVPGEMYERAEDGALIPTGVRARWVDAPGSRREIVGPIARHPRIDGRRVDLDVVEEALAAVTGVTAAAVVGLPTDDGVEVGACVVLDRDDLDVPGLRRELSQTLAAHCVPTMISIVESIPLGTDGRPDHGEV
ListOfNames [] 
```

如您所见，列表仍然为空。我想也许光标无法跳回顶部，所以我关闭了光标并完全按照上面的方式重新打开它，但在第二个实例中生成了列表。这导致脚本出错，我不知道为什么。

是不是数据不能直接读入列表？

从理论上讲，我可以将序列的名称从文本文件中拆分出来，但我很好奇为什么这种方法不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:58:53.117

正如您所怀疑的，游标的结果集可以被读取一次，之后它就被“使用”了。

只需先将结果放入列表中，然后遍历列表以将其内容写入文件。或者在一个循环中做这两个。

# android - Google Map Android V2 - 如何在 GroundOverlay 上使用在线图像？

> ID：14062291
> 
> 赞同：1
> 
> 时间：2012-12-27T22:49:11.353
> 
> 标签：android, maps, google-maps-android-api-2

我想使用[Google Maps Android API V2提供的](https://developers.google.com/maps/documentation/android/)[GroundOverlay](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/GroundOverlay)功能。我想显示为叠加的图像只能在线获得（因为它会定期更新）；我无法使用本地资源。谷歌提供的例子，只展示了如何使用本地资源：

```
mGroundOverlay = mMap.addGroundOverlay(new GroundOverlayOptions()
            .image(BitmapDescriptorFactory.fromResource(R.drawable.newark_nj_1922)).anchor(0, 1)
            .position(NEWARK, 8600f, 6500f)); 
```

如何通过 url 使用在线图片？什么是最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:54:11.047

我使用了 AsyncTask，在 doInBackground() 方法中我下载图像并在 onPostExecute() 中添加带有下载位图的 GroundOverlay

```
 URL url = new URL(strUrl);
        InputStream is = (InputStream) url.getContent();
        byte[] buffer = new byte[8192];
        int bytesRead;
        ByteArrayOutputStream output = new ByteArrayOutputStream();
        while ((bytesRead = is.read(buffer)) != -1) {
            output.write(buffer, 0, bytesRead);
        }

        downloadedBmp = BitmapFactory.decodeByteArray(output.toByteArray(), 0, output.toByteArray().length); 
```

# php - 引用变量的 Echo 语句中的 PHP 解析错误

> ID：14062293
> 
> 赞同：-3
> 
> 时间：2012-12-27T22:49:27.470
> 
> 标签：php

我正在使用下面的 php 来显示数组中的数据。我在代码的第 26 行（即以下行）收到一个解析错误：

```
 $delete = echo $field['id']; 
```

这是确切的错误消息：

> 解析错误：语法错误，第 26 行 \path\to\file.php 中的意外“回声”（T_ECHO）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:55:32.720

```
 $delete = echo $field['id']; 
```

不像`print`,`echo`不能用作表达式的右手边。如果你想同时`echo`分配，你需要这个：

```
echo $delete = $field['id']; 
```

不过，这些很可能是您之前调试的剩余部分，而您实际上只是这个意思：

```
$delete = $field['id']; 
```

另见：[手册`echo`](http://www.php.net/echo)

> **echo**（与其他一些语言结构不同）的行为不像函数，因此它不能总是在函数的上下文中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T22:51:50.923

你有

```
$delete = echo $field['id']; 
```

应该是

```
$delete = $field['id']; 
```

没有回声。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T22:51:57.630

`$delete = echo $field['id'];`应该是`$delete = $field['id']`；

回声返回值

`"No value is returned."`

[参考](http://php.net/manual/en/function.echo.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:12:35.293

我的建议是，只在表格外放一个表格，方法和动作，只隐藏一个输入，每行使用一个输入按钮（不提交），为每个 onclick="submit($delete);" 设置。

```
function submit(val){
  document.getElementById("yourHiddenInput").value = val;
  document.getElementById("yourForm").submit();
} 
```

# javascript - SVG、jQuery 和 Internet Explorer

> ID：14062294
> 
> 赞同：2
> 
> 时间：2012-12-27T22:49:32.663
> 
> 标签：javascript, jquery, svg, internet-explorer-9

我正在尝试在 Internet Explorer 9 上将 jQuery 与内联 SVG 一起使用。这是非常基本的东西，但我似乎无法让它工作。我想做的就是当我点击一个矩形时使用 jQuery 来“提醒”。下面是我尝试过的代码：

```
<svg xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink">

<script type="text/ecmascript" xlink:href="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" />
<script type="text/ecmascript"><![CDATA[
    $(document).ready(function(){
        $("#bot").click(function (){
            alert("clicked");
        });
    });
]]></script>

<rect x="10" y="10" height="300" width="300" style="fill: #000000" id="bot" />

</svg>

<!--
<script type="text/javascript" href="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" />
<script type="text/javascript"><![CDATA[
$(document).ready(function(){
    $("#bot").click(function (){
        alert("clicked");
    });
});
]]></script>
--> 
```

我可以在矩形上随意单击，但没有任何反应。有谁知道为什么以及如何在 Internet Explorer 9 中修复它（在 Firefox 中运行良好），只使用普通的 jQuery 而没有其他库？

如您所见，我尝试将 JS 部分放在 SVG 标记的内部和外部，看看是否有任何效果。它没有！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:10:15.343

而不是`<script/>`，使用`<script></script>`.

工作示例（在 IE9 和 Chrome 23 中测试）：

[http://jsfiddle.net/LrKbS/6/](http://jsfiddle.net/LrKbS/6/)

根据 SVG 规范，使用`<script/>`是正确的，但是 HTML5 规范中有[一个错误](https://www.w3.org/Bugs/Public/show_bug.cgi?id=17995)（最近修复），涉及外部内容处理和脚本结束标记处理。

# c++ - 定义前向输出迭代器的规范方法

> ID：14062297
> 
> 赞同：7
> 
> 时间：2012-12-27T22:49:54.353
> 
> 标签：c++, c++11, iterator-traits

如何以规范的方式在 C++11 中定义前向输出迭代器？

根据标准，forward_iterator 只是一个 input_iterator。所以对应的`forward_iterator_tag`只有extends `input_iterator_tag`。如果我们`std::iterator`用来定义我们的迭代器，我们使用什么标签来定义前向输出迭代器？

定义一个扩展两者的私有标签是否规范，`forward_iterator_tag`或者`output_iterator_tag`是否有更好的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T23:38:15.023

规范的做法是仅继承自`std::iterator<std::forward_iterator_tag, T>`。迭代器只有一个类别。

该标准对于同时也是前向迭代器的输出迭代器没有算法（或其他用途）。标准中输出迭代器的所有使用只需要单遍。

相反，该标准具有向前/双向/随机访问类别的可变与不可变迭代器的想法。所有需要通过迭代器写入的算法，并且需要比单遍更好的算法，也可以通过它们写入的相同迭代器来读取。这是`std::remove`和`std::sort`其他变异算法。

可变迭代器和不可变迭代器之间的区别不是由迭代器标签检测到的，它取决于赋值表达式是否格式正确。因此，例如，如果您将一个迭代器传递给`std::sort`它是不可变的，那么该算法无论如何都不会编译，因此通常不需要输入迭代器也被标记为`output_iterator_tag`. 所有需要的算法都`OutputIterator`将只使用一个可变的`ForwardIterator`，同样没有必要用它来标记`output_iterator_tag`。

如果您的需求与标准算法的需求不同，那么我无法立即想到您的提案不适用于您的迭代器的原因。但它不会检测到可变的标准迭代器。例如`std::deque<int>::iterator`和`int*`有迭代器类别`random_access_iterator_tag`，不是你的私人标签，也没有任何关系`output_iterator_tag`。因此，您最好定义自己的特征类，而不是希望调整现有的特征类`iterator_traits::iterator_category`以提供您想要的信息。

# c# - 防止或回滚 page_load 上的回发

> ID：14062298
> 
> 赞同：0
> 
> 时间：2012-12-27T22:49:54.583
> 
> 标签：c#, asp.net, webforms, postback

首先，我不能使用 Jquery、Ajax、UpdatePanel 等异步插件。

我有一个 ASP.NET 4 WEBFORM，在母版页中我验证会话是否丢失，在这种情况下显示一个模式来获取用户名/密码并再次登录用户。

但是我有两个问题，第一个是例如，如果我按下一个按钮并且我失去了会话，网页会向我显示模态但 clickevent 背后的代码仍然执行它并且我想阻止它（我不想要在 APP 的每个事件处理程序中验证会话的状态）。

第二个是在我成功登录用户之后，我想完成或继续用户在失去会话之前尝试的事件。

换句话说，我的问题是我需要在中间阻止回发，然后再做一次。：/

像这样的东西：

```
Page_Load(...)
{
If(Session["User"] == null)
{
  PostBack.Cancel(); //Like de e.PreventDefault() of Javascript.
  return;
}
.
.
}

AND

LoginOnSessionLost()
{
...
//After Login Success
Postback.Continue();
} 
```

有什么建议么？谢谢

# php - Magento 获取购物车中的所有产品，而不是最近的

> ID：14062310
> 
> 赞同：8
> 
> 时间：2012-12-27T22:50:38.003
> 
> 标签：php, magento, e-commerce, magento-1.7

我正在调整现代主题以创建要使用的新主题。

我需要展示顾客购物篮中的*所有*产品。我有这个代码，目前它最多只显示三个项目。我可以使用不同的命令来代替`getRecentItems()`显示篮子中的所有项目吗？我尝试使用`getAllItems()`，但这似乎没有做任何事情。

```
 <?php $items = $this->getRecentItems();?>
        <?php if(count($items)): ?>
            <ol id="cart-header" class="mini-products-list">
                <?php foreach($items as $item): ?>
                    <?php echo $this->getItemHtml($item) ?>
                <?php endforeach; ?>
            </ol>
        <?php else: ?>
            <?php echo $this->__('There are no items in your shopping Basket.') ?>
        <?php endif ?> 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-27T22:53:56.807

报到`System > Configuration > Checkout > Shopping Cart Side Bar`

有一个设置可以设置迷你购物车中可以看到的产品数量。

**默认情况下，最大显示最近添加的项目**为 3。将其增加到您想要的值，或者更确切地说是一个较高的数字，以始终显示购物车中的所有产品。

编辑：要根据您的评论覆盖默认的 magento 行为，您可以使用以下内容。

```
<?php
    $session= Mage::getSingleton('checkout/session');
    $items = $session->getQuote()->getAllItems();
?>
        <?php if(count($items)): ?>
            <ol id="cart-header" class="mini-products-list">
                <?php foreach($items as $item): ?>
                    <?php echo $this->getItemHtml($item) ?>
                <?php endforeach; ?>
            </ol>
        <?php else: ?>
            <?php echo $this->__('There are no items in your shopping Basket.') ?>
        <?php endif ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-29T10:05:41.820

Mage_Checkout_Block_Cart_Sidebar 方法 getRecentItems() 接受**计数**参数，只需以这种方式调用它即可检索完整的购物车项目。

```
<?php $items = $this->getRecentItems(10000);?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:57:51.633

我同意实用程序。并感谢您分享购物车侧栏部分。我有一个模块可以在结帐页面中列出购物车项目。这是我的代码供您参考。

```
$quoteObject = $this->getQuote();
foreach($quoteObject->getAllItems() as $item)
{
  //do what you want here.
} 
```

希望这可以帮助。

# python - 在 main 之外调用函数

> ID：14062318
> 
> 赞同：0
> 
> 时间：2012-12-27T22:51:18.067
> 
> 标签：python

我在 main 之外调用一个函数，如下所示，并遇到名称错误。有没有办法在不移动`getdata()`main 内部的函数调用的情况下解决这个错误？

```
filename="data_file.txt"
AU=getdata(filename)

def getdata(filename):
    file = open(filename,'r')
    return file.read()

def main():

NameError: name 'getdata' is not defined 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:52:19.690

您根本不需要使用`main()`函数；虽然发生这种情况，但在您的代码中，在`getdata()`函数调用之前尚未达到定义。

尝试以下操作：

```
def getdata(filename):
    file = open(filename,'r')
    return file.read()

filename="data_file.txt"
AU=getdata(filename) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T22:52:40.467

您只能在定义函数*后*调用它。定义*后*移动`AU`行：*`getdata()`*

 *```
def getdata(filename):
    file = open(filename,'r')
    return file.read()

AU = getdata(filename) 
```*

# php - 从 Magento 中的 sitemap.xml 中排除特定类别页面的 PHP 代码

> ID：14062323
> 
> 赞同：0
> 
> 时间：2012-12-27T22:51:46.237
> 
> 标签：php, magento, seo, sitemap

我想包含我的 Magento 网站`sitemap.xml`中不应被搜索引擎索引的那些页面。为此，我已将其复制`Catalog/Category.php Cms/Page.php`到相应的`app/code/local`目录中并正在对其进行修改。

我已`Page.php`成功修改，以从我的`sitemap.xml`. 我按照[这里给出的指示](https://stackoverflow.com/questions/12528883/exclude-specific-page-from-sitemap-xml-generation)

由于我不熟悉 PHP，因此我不知道要进行哪些更改以使此解决方案适用于`Category.php`文件。

这是我目前的`Category.php`文件，不排除我想要的任何特定类别页面`sitemap.xml`：

```
 <?php

class Mage_Sitemap_Model_Resource_Catalog_Category extends Mage_Core_Model_Resource_Db_Abstract
{
/**
 * Collection Zend Db select
 *
 * @var Zend_Db_Select
 */
protected $_select;

/**
 * Attribute cache
 *
 * @var array
 */
protected $_attributesCache    = array();

/**
 * Init resource model (catalog/category)
 *
 */
protected function _construct()
{
    $this->_init('catalog/category', 'entity_id');
}

/**
 * Get category collection array
 *
 * @param unknown_type $storeId
 * @return array
 */
public function getCollection($storeId)
{
    $categories = array();

    $store = Mage::app()->getStore($storeId);
    /* @var $store Mage_Core_Model_Store */

    if (!$store) {
        return false;
    }

    $this->_select = $this->_getWriteAdapter()->select()
        ->from($this->getMainTable())
        ->where($this->getIdFieldName() . '=?', $store->getRootCategoryId());
    $categoryRow = $this->_getWriteAdapter()->fetchRow($this->_select);

    if (!$categoryRow) {
        return false;
    }

    $urConditions = array(
        'e.entity_id=ur.category_id',
        $this->_getWriteAdapter()->quoteInto('ur.store_id=?', $store->getId()),
        'ur.product_id IS NULL',
        $this->_getWriteAdapter()->quoteInto('ur.is_system=?', 1),
    );
    $this->_select = $this->_getWriteAdapter()->select()
        ->from(array('e' => $this->getMainTable()), array($this->getIdFieldName()))
        ->joinLeft(
            array('ur' => $this->getTable('core/url_rewrite')),
            join(' AND ', $urConditions),
            array('url'=>'request_path')
        )

        ->where('e.path LIKE ?', $categoryRow['path'] . '/%');

    $this->_addFilter($storeId, 'is_active', 1);

    $query = $this->_getWriteAdapter()->query($this->_select);
    while ($row = $query->fetch()) {
        $category = $this->_prepareCategory($row);
        $categories[$category->getId()] = $category;
    }

    return $categories;
}

/**
 * Prepare category
 *
 * @param array $categoryRow
 * @return Varien_Object
 */
protected function _prepareCategory(array $categoryRow)
{
    $category = new Varien_Object();
    $category->setId($categoryRow[$this->getIdFieldName()]);
    $categoryUrl = !empty($categoryRow['url']) ? $categoryRow['url'] : 'catalog/category/view/id/' . $category->getId();
    $category->setUrl($categoryUrl);
    return $category;
}

/**
 * Add attribute to filter
 *
 * @param int $storeId
 * @param string $attributeCode
 * @param mixed $value
 * @param string $type
 * @return Zend_Db_Select
 */
protected function _addFilter($storeId, $attributeCode, $value, $type = '=')
{
    if (!isset($this->_attributesCache[$attributeCode])) {
        $attribute = Mage::getSingleton('catalog/category')->getResource()->getAttribute($attributeCode);

        $this->_attributesCache[$attributeCode] = array(
            'entity_type_id'    => $attribute->getEntityTypeId(),
            'attribute_id'      => $attribute->getId(),
            'table'             => $attribute->getBackend()->getTable(),
            'is_global'         => $attribute->getIsGlobal(),
            'backend_type'      => $attribute->getBackendType()
        );
    }

    $attribute = $this->_attributesCache[$attributeCode];

    if (!$this->_select instanceof Zend_Db_Select) {
        return false;
    }

    switch ($type) {
        case '=':
            $conditionRule = '=?';
            break;
        case 'in':
            $conditionRule = ' IN(?)';
            break;
        default:
            return false;
            break;
    }

    if ($attribute['backend_type'] == 'static') {
        $this->_select->where('e.' . $attributeCode . $conditionRule, $value);
    } else {
        $this->_select->join(
            array('t1_'.$attributeCode => $attribute['table']),
            'e.entity_id=t1_'.$attributeCode.'.entity_id AND t1_'.$attributeCode.'.store_id=0',
            array()
        )
        ->where('t1_'.$attributeCode.'.attribute_id=?', $attribute['attribute_id']);

        if ($attribute['is_global']) {
            $this->_select->where('t1_'.$attributeCode.'.value'.$conditionRule, $value);
        } else {
            $ifCase = $this->_select->getAdapter()->getCheckSql('t2_'.$attributeCode.'.value_id > 0', 't2_'.$attributeCode.'.value', 't1_'.$attributeCode.'.value');
            $this->_select->joinLeft(
                array('t2_'.$attributeCode => $attribute['table']),
                $this->_getWriteAdapter()->quoteInto('t1_'.$attributeCode.'.entity_id = t2_'.$attributeCode.'.entity_id AND t1_'.$attributeCode.'.attribute_id = t2_'.$attributeCode.'.attribute_id AND t2_'.$attributeCode.'.store_id=?', $storeId),
                array()
            )
            ->where('('.$ifCase.')'.$conditionRule, $value);
        }
    }

    return $this->_select;
} 
} 
```

**编辑**：非常感谢卢克在下面的评论中！这对我有用。我不得不稍微修改一下代码，因为 $category 直到 if 语句之后才定义。

```
while ($row = $query->fetch()) {

// Added to exclude specific categories
if(in_array($this->_prepareCategory($row)->getId(), $this->ignoreCategories))
{
    continue;
}

$category = $this->_prepareCategory($row);
$categories[$category->getId()] = $category;
} 
```

正如 Luke 所说，我为类别 ID 创建了类属性：

```
protected $ignoreCategories = array("2","3","16");//Replace the numbers with your category IDs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:21:46.293

要获得快速解决方案，请添加以下代码，更好的方法是将属性添加到类别 EAV，然后使用该属性检查它是否应包含在站点地图输出中。

为了快速破解，添加一个数组作为应该忽略的类别 ID 的类属性，

受保护的 $ignoreCategories = array("2","3","16");

然后在 getCollection() 函数的底部附近检查这些 ID，

而 ($row = $query->fetch()) {

```
// Added to exclude specific categories
if(in_array($category->getId(), $this->ignoreCategories)
{
    continue;
}

    $category = $this->_prepareCategory($row);
    $categories[$category->getId()] = $category; 
```

}

# sql - SQL - 识别表中主键不匹配的记录

> ID：14062328
> 
> 赞同：0
> 
> 时间：2012-12-27T22:52:13.560
> 
> 标签：sql, oracle

我在 Oracle 中有两个表

```
表 A（所有字段都是主键）
-----------------------------------------
西德 (INT)   
星期六 (CHAR)
日期时间（日期时间）

```

```
表 B（所有字段都是主键 - 与表 A 相同）
-------------------------------------------------- --------
SID
日
约会时间

```

我想在表 A 中查找记录

```
where A.SID = B.SID
AND A.SDAY = B.SDAY
AND A.DATETIME <> B.DATETIME 
```

（即 - 我想在表 A 中查找与表 B 中的对应列匹配的记录，但日期时间除外）

直接 INNER JOIN SQL 没有给我结果。有任何想法吗？

**这也不起作用**

```
SELECT A.* FROM TABLE_A A
WHERE  EXISTS (
SELECT 'X' FROM TABLE_B B
WHERE A.SID = B.SID
AND A.SDAY = B.SDAY 
AND A.DATETIME <> B.DATETIME) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:58:33.193

我可能会将其作为内部连接而不是存在，但我希望你的工作。

```
SELECT A.* 
FROM TABLE_A A
INNER JOIN TABLE_B B
ON  A.SID = B.SID
AND A.SDAY = B.SDAY 
AND A.DATETIME <> B.DATETIME 
```

如果您仍然没有得到结果，可以尝试发布一些示例数据供我们测试

* * *

您可以运行的完整测试以显示上述连接有效：

```
CREATE TABLE #Table_a
(
    [SID] INT, 
    SDAY CHAR,
    [DATETIME] DATETIME
)

CREATE TABLE #Table_b
(
    [SID] INT, 
    SDAY CHAR,
    [DATETIME] DATETIME
)

INSERT INTO #Table_a
        ( SID, SDAY, DATETIME )
VALUES  ( 0, -- SID - int
          'A', -- SDAY - char
          '2012-12-27 23:00:01'  -- DATETIME - datetime
          )
INSERT INTO #Table_a
        ( SID, SDAY, DATETIME )
VALUES  ( 2, -- SID - int
          'B', -- SDAY - char
          '2012-12-27 23:00:01'  -- DATETIME - datetime
          )
INSERT INTO #Table_a
        ( SID, SDAY, DATETIME )
VALUES  ( 3, -- SID - int
          'C', -- SDAY - char
          '2012-12-27 23:00:01'  -- DATETIME - datetime
          )

INSERT INTO #Table_B
        ( SID, SDAY, DATETIME )
VALUES  ( 0, -- SID - int
          'A', -- SDAY - char
          '2012-12-27 3:00:01'  -- DATETIME - datetime
          )
INSERT INTO #Table_B
        ( SID, SDAY, DATETIME )
VALUES  ( 2, -- SID - int
          'B', -- SDAY - char
          '2012-12-27 3:00:01'  -- DATETIME - datetime
          )
INSERT INTO #Table_B
        ( SID, SDAY, DATETIME )
VALUES  ( 3, -- SID - int
          'C', -- SDAY - char
          '2012-12-27 23:00:01'  -- DATETIME - datetime
          )

SELECT A.* 
FROM #TABLE_A A
INNER JOIN #TABLE_B B
ON  A.SID = B.SID
AND A.SDAY = B.SDAY 
AND A.DATETIME <> B.DATETIME

DROP TABLE #Table_a
DROP TABLE #Table_b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:03:30.937

如果您显示这样的表定义，您的问题可能会更容易阅读：

-- 我在 Oracle 中有两张表

```
CREATE TABLE TABLE_A -- BTW: why the caps?
  ( SID INTEGER NOT NULL
  , SDAY CHAR NOT NULL
  , ZDATETIME DATETIME NOT NULL -- note: using a typename as an identier
                                -- will break things.
  , PRIMARY KEY (SID,SDAY,ZDATETIME)
  );

CREATE TABLE TABLE_B -- all (1)fields are primary keys
   ( SID SDAY DATETIME NOT NULL PRIMARY KEY
   ); 
```

[也许这应该是评论，但评论没有格式化的可能性]

（即 - 我想在表 A 中查找与表 B 中相应列匹配的记录

```
EXISTS 
```

日期时间除外）

```
NOT EXISTS 
```

好的，现在解决方案：

```
SELECT A.* FROM TABLE_A A

WHERE  EXISTS (
    SELECT 1 FROM TABLE_B B
    WHERE A.SID = B.SID
    AND A.SDAY = B.SDAY 
    )
AND NOT  EXISTS (
    SELECT 2 FROM TABLE_B B
    WHERE A.SID = B.SID
    AND A.SDAY = B.SDAY 
    AND A.ZDATETIME = B.ZDATETIME
    )
    ; 
```

# jquery - jQuery：无法选择所有输入并在 keydown 上选择“this”并显示下一个元素

> ID：14062332
> 
> 赞同：2
> 
> 时间：2012-12-27T22:52:32.017
> 
> 标签：jquery, html, jquery-selectors

我正在尝试使用 jquery 来选择下面 HTML 文档中的所有输入，并在“keydown”事件中选择“this”，然后显示下一个元素。

我的 jQuery

```
$(document).ready(function(){
    $('.hint').hide();
});
    $('input').keydown(function(){
        $(this).show();
}); 
```

我的 HTML

```
<!DOCTYPE html>
<html>
<head>
<title>Title of my Page</title>
</head>
<body>

<p>
    <input type="text"><span class="hint">Something cool</span>
</p>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="app.js"></script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T22:54:10.223

目前尚不清楚您在问什么，但您的第二个函数在页面准备好后没有运行，因此请注意在脚本之前加载 DOM。

```
$(document).ready(function(){

    $('.hint').hide();

    $('input').keydown(function(){
        $(this).show();
    });

}); 
```

要显示下一个元素，请将行更改为：

```
 $(this).next().show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:56:30.070

也许您可以尝试在 jQuery 中使用 .next( [selector] ) 函数。（我假设你想显示 .hint 跨度）

```
$(document).ready(function() {
    $('.hint').hide();
});
$('input').keydown(function() {
    $(this).next('.hint').show();
});​ 
```

这是一个示例：http: [//jsfiddle.net/RQ3zw/](http://jsfiddle.net/RQ3zw/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:56:54.580

啊! 找到了！

只需要添加

```
 $(this).next().show(); 
```

代替

```
$(this).show(); 
```

所以完成这将是：

```
$(document).ready(function(){
    $('.hint').hide();
});
    $('input').keydown(function(){
        $(this).next().show();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T22:58:33.287

使用`.next()`选择器：

`$(this).next('.hint').show();`

[在这里拉小提琴。](http://jsfiddle.net/senoramor/jjPkJ/)

# hibernate - 带有约定插件 2.3.8 的 Struts2 2.3.8 不适用于休眠 3.2.5（netbeans fw 插件）

> ID：14062337
> 
> 赞同：1
> 
> 时间：2012-12-27T22:52:42.293
> 
> 标签：hibernate, plugins, struts2, conflict, convention

我想将Struts2约定插件（2.3.8）与hibernate（netbeans框架插件3.2.5）一起使用，但是在两个不同的asm.jar版本之前存在冲突。

Hibernate 与 struts2 fw 一起工作正常，但是当我添加约定插件时，我得到错误：

```
java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.<init>(Z)V 
```

*   Hibernate 3.2.5 需要**asm.jar**
*   Struts2约定插件需要**asm-3.3.jar**

恕我直言，约定插件需要类：ClassWriter，它位于 asm-3.3.jar 中，但在 asm.jar 中查找。

*   用maven测试（没有冲突，但没有运行）
*   在没有 Maven 的情况下测试（未运行）

当休眠 3.2.5 无法更改为更高版本时，有什么解决方案可以实现这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:55:04.030

一种技巧是更新休眠插件库 asm.jar 和 asm-3.3.jar。您需要使用 asm-3.3.jar 检查 Hiberate 是否存在特定问题。

如果那行不通，那么我能想到的东西很少

*   模块化（将hibernate相关类移动为子项目并将库限制为子项目）
*   如果上述方法不可行，那么在调用堆栈中找一个位置来操作类加载器缓存（丢弃加载的类并从特定的 jar 加载等等）。就个人而言，这将是痛苦的维护。

[相关帖子](https://stackoverflow.com/questions/11759414/java-how-to-load-different-versions-of-the-same-class)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T07:10:04.443

如果可以，尝试将 Hibernate 升级到使用与 Struts 2.3.8 相同版本的 asm 库的最新版本。您还可以尝试从 Hibernate 集中排除 asm 库 - 使用 Maven，您必须添加部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T12:44:17.180

恕我直言，问题不在于图书馆冲突。我只与一个库`Hibernate 3.2.5.ga`一起使用。我在项目中使用的库（仅关于and ）是：`Struts 2.3.7``asm``Hibernate``Struts`

```
 ├── hibernate
 │   ├── dom4j-1.6.1.jar
 │   ├── ehcache-1.2.3.jar
 │   ├── hibernate3.jar
 │   ├── hibernate-annotations.jar
 │   ├── hibernate-commons-annotations.jar
 │   ├── hibernate-entitymanager.jar
 │   ├── hibernate-tools.jar
 │   ├── javassist.jar
 │   ├── jdbc2_0-stdext.jar
 │   └── jta.jar
 ├── struts-2.3.7
     ├── antlr-2.7.2.jar
     ├── asm-3.3.jar
     ├── asm-commons-3.3.jar
     ├── cglib-nodep-2.2.2.jar
     ├── commons-beanutils-1.8.0.jar
     ├── commons-collections-3.1.jar
     ├── commons-digester-2.0.jar
     ├── commons-fileupload-1.2.2.jar
     ├── commons-io-2.0.1.jar
     ├── commons-lang-2.5.jar
     ├── commons-lang3-3.1.jar
     ├── commons-logging-1.1.1.jar
     ├── freemarker-2.3.19.jar
     ├── ognl-3.0.5.jar
     ├── struts2-convention-plugin-2.3.7.jar
     ├── struts2-core-2.3.7.jar
     ├── struts2-fullhibernatecore-plugin-2.2.2-GA.jar
     ├── struts2-json-plugin-2.3.7.jar
     └── xwork-core-2.3.7.jar 
```

# post - 通过 POST 请求检索数据

> ID：14062338
> 
> 赞同：0
> 
> 时间：2012-12-27T22:52:50.703
> 
> 标签：post, python-3.x, urllib

我无法以编程方式从特定网页获取数据。

[http://www.uschess.org/msa/thin2.php](http://www.uschess.org/msa/thin2.php)允许人们按名称和州搜索美国国际象棋等级。

提交 POST 请求，我可以访问相当于[http://www.uschess.org/msa/thin2.php?memln=nakamura&memfn=hikaru](http://www.uschess.org/msa/thin2.php?memln=nakamura&memfn=hikaru)但仍然需要单击“搜索”按钮才能获取有用的数据。访问该结果页面的最佳方式是什么？

```
import urllib.request
import urllib.parse
data = {'memfn':'hikaru', 'memln':'nakamura'}
url = r'http://www.uschess.org/msa/thin2.php'
s = urllib.parse.urlopen(url, bytes(urllib.parse.urlencode(data),'UTF-8'))
s.read() 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:08:48.540

这个有效：

```
#!/usr/bin/env python
import urllib

data = {'memfn':'hikaru', 'memln':'nakamura', 'mode':'Search'}
url = r'http://www.uschess.org/msa/thin2.php'
s = urllib.urlopen(url, bytes(urllib.urlencode(data)))
print s.read() 
```

基本上你需要提交`mode`带有值的隐藏参数`Search`来模仿按钮按下。

注意：我为 python 2.x 重写了它，对不起，但我手边没有 python3。

# python - Python，从字典数组中收集数据

> ID：14062339
> 
> 赞同：2
> 
> 时间：2012-12-27T22:52:52.323
> 
> 标签：python

我是 Python 新手，我从数据库中获得了这种结构

```
data=[
{'Value': '0.2', 'id': 1},
{'Value': '1.2', 'id': 1},
{'Value': '33.34', 'id': 2},
{'Value': '44.3', 'id': 3},
{'Value': '33.23', 'id': 3},
{'Value': '21.1', 'id': 4},
{'Value': '5.33', 'id': 4},
{'Value': '33.3', 'id': 5},
{'Value': '12.2', 'id': 5},
{'Value': '1.22', 'id': 5},
{'Value': '1.23', 'id': 6}
] 
```

我知道我可以通过以下方式获取记录的 ID：

```
data[i]['id'] 
```

但我需要在适当的数据结构中按 ID 收集，以获得每个 ID 的平均值。

什么是更好的选择？

我正在考虑为每个 ID 集构建一个新的字典，但是 ID 的数量会增加，我不知道如何解决这个问题。如果有人能给我一些想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:03:14.883

假设您的数据按 ID 排序，因为它出现在`data`变量中，您可以尝试使用`itertools.groupby`，可以指示按 分组`id`。然后，您可以创建一个新字典，其键等于`id`数字，值等于`means`：

```
In [1]: from itertools import groupby

In [2]: data=[
   ...: {'Value': '0.2', 'id': 1},
   ...: {'Value': '1.2', 'id': 1},
   ...: {'Value': '33.34', 'id': 2},
   ...: {'Value': '44.3', 'id': 3},
   ...: {'Value': '33.23', 'id': 3},
   ...: {'Value': '21.1', 'id': 4},
   ...: {'Value': '5.33', 'id': 4},
   ...: {'Value': '33.3', 'id': 5},
   ...: {'Value': '12.2', 'id': 5},
   ...: {'Value': '1.22', 'id': 5},
   ...: {'Value': '1.23', 'id': 6}
   ...: ]

In [3]: means = {}

In [4]: for k, g in groupby(data, key=lambda x: x['id']):
   ...:     g = list(g)
   ...:     means[k] = sum(float(x['Value']) for x in g) / len(g)
   ...:     
   ...:     

In [5]: means
Out[5]: 
{1: 0.69999999999999996,
 2: 33.340000000000003,
 3: 38.765000000000001,
 4: 13.215,
 5: 15.573333333333332,
 6: 1.23} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:08:01.810

（*更新：*在帝斯曼发表评论后。）

您可以像这样重塑数据：

```
from collections import defaultdict

data=[
{'Value': '0.2', 'id': 1},
{'Value': '1.2', 'id': 1},
{'Value': '33.34', 'id': 2},
{'Value': '44.3', 'id': 3},
{'Value': '33.23', 'id': 3},
{'Value': '21.1', 'id': 4},
{'Value': '5.33', 'id': 4},
{'Value': '33.3', 'id': 5},
{'Value': '12.2', 'id': 5},
{'Value': '1.22', 'id': 5},
{'Value': '1.23', 'id': 6}
]

newdata = defaultdict(list)
for r in data:
    newdata[r['id']].append(float(r['Value'])) 
```

这将产生：

```
In [2]: newdata
Out[2]: defaultdict(<type 'list'>, {1: [0.2, 1.2], 2: [33.34], 3: [44.3, 33.23], 4: [21.1, 5.33], 5: [33.3, 12.2, 1.22], 6: [1.23]}) 
```

（*更新*2）

现在通过字典理解计算均值很简单：

```
mean = {id: sum(values) / len(values) for id, values in newdata.viewitems()} 
```

这使：

```
In [4]: mean
Out[4]: {1: 0.7, 2: 33.34, 3: 38.765, 4: 13.215, 5: 15.573333333333332, 6: 1.23} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:54:49.813

如果你有`numpy`，你可以很容易地使用它：

```
import numpy
numpy.mean([x['id'] for x in data]) 
```

否则，它会很简单：

```
from __future__ import division # if python2.7
ids = [x['id'] for x in data]
print sum(ids)/len(ids) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T22:56:42.797

收集完所有 ID 后，您可以简单地创建一个 ID 列表：

```
id_list = [element['id'] for element in data] 
```

从那里你可以计算任何你想要的。

# regex - 正则表达式丢失最后一个字符

> ID：14062343
> 
> 赞同：0
> 
> 时间：2012-12-27T22:53:25.023
> 
> 标签：regex, python-3.x

我的正则表达式是`(?<![\u0410-\u042F])[.!?](?=(\s)?(\s)?[\u0410-\u042F]|[\u04E8]|["]|[\u201C]|![0-9])`

我想把一个段落分成句子。

我用 re.split() 做正则表达式并打印数组

这是我做的一个示例输入：

`Мамлекеттик айыптоочу Биринчи май райондук сотуна берген бул сунушун диний кастыкты ырбатпоо аракети менен негиздеди. Мусулмандарга акаарат келтирип жатат деген кайрылуу каттын негизинде УКМК Тезекбаевге каршы кылмыш ишин козгоп, сотко өткөргөн. Бул ишти бүгүн Биринчи май райондук соту карап бүттү жана өкүм эртең чыгарыларын маалымдады. Тараптар мунаса тапты; Ишти карап жаткан мамлекеттик айыптоочу Кудайберди Чаргынов Кубанычбек Тезекбаевдин диний кастыкты козутууга болгон аракети толугу менен далилденгенин билдирүүдө. Бирок мамлекеттик айыптоочу диний кастыкты ырбатпоо максатында Кыргызстандын Кылмыш кодексинин 65-беренесине ылайык, иш өз маанисин жоготконуна байланыштуу кылмыш ишин Т.У. кыскартып салууну сунуштады.`

除了最后一个字符（在这种情况下是句点，？或！）被删除之外，它打印得很好！

我在网上搜索，它说用前瞻标签包围标点符号，但它不起作用。

我正在使用 Python 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:55:42.090

在要在拆分中保留的字符周围放置一个捕获组：

```
(?<![\u0410-\u042F])([.!?])(?=(\s)?(\s)?[\u0410-\u042F]|[\u04E8]|["]|[\u201C]|![0-9]) 
```

句点将作为新元素添加到结果列表中。从[文档](http://docs.python.org/3/library/re.html#re.split)中：

> 如果在模式中使用捕获括号，则模式中所有组的文本也会作为结果列表的一部分返回。

如果您不希望这样做，则必须通过确保空格*前面*有其他标点符号的匹配句点（使用后视断言）来拆分空格本身。

# ruby - 如何将 XML 字符串添加到 Nokogiri Builder

> ID：14062345
> 
> 赞同：6
> 
> 时间：2012-12-27T22:53:45.983
> 
> 标签：ruby, xml, nokogiri

我有一个现有的 Nokogiri 构建器和来自不同来源的字符串中的一些 xml 节点。如何将此字符串添加到我的构建器？

```
str = "<options><cc>true</cc></options>"
xml = Nokogiri::XML::Builder.new do |q|
  q.query do |f|
    f.name "awesome"
    f.filter str
  end
end 
```

这会将 str 转义为：

```
xml.to_xml
=> "<?xml version=\"1.0\"?>\n<query>\n  <name>awesome</name>\n  <filter>&lt;options&gt;&lt;cc&gt;true&lt;/cc&gt;&lt;/options&gt;</filter>\n</query>\n" 
```

我发现了很多很多类似的东西，包括嵌套构建器和使用 << 运算符，但是将完整的 xml 节点树插入构建器块没有任何作用。我怎样才能把那个字符串变成真正的节点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-27T23:41:14.290

使用时发现了什么问题`<<`？这对我有用：

```
xml = Nokogiri::XML::Builder.new do |q|
  q.query do |f|
    f.name "awesome"
    f << str
  end
end 
```

并避免使用私有`insert`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:06:08.880

而且，像往常一样，我在发布后不久就找到了答案......

```
xml = Nokogiri::XML::Builder.new do |q|
  q.query do |f|
    f.name "awesome"
    f.__send__ :insert, Nokogiri::XML::DocumentFragment.parse( str )
  end
end.to_xml 
```

给你

```
=> "<?xml version=\"1.0\"?>\n<query>\n  <name>awesome</name>\n  <options>\n    <cc>true</cc>\n  </options>\n</query>\n" 
```

编辑：当 << 由于某种未知原因失败时，这种方式对我有用。但是，正如其他人指出的那样，它通过直接访问旨在受到保护的 :insert 方法来工作。将其视为“不好的做法”和最后的手段。

# sql-server - 为 SQL 创建带有两个行分隔符的格式文件

> ID：14062358
> 
> 赞同：0
> 
> 时间：2012-12-27T22:54:58.977
> 
> 标签：sql-server, bcp, openrowset

我似乎找不到这是否可能，我有一个完全平面的文件，我需要组织它以使用 OPENROWSET 导入 SQL 服务器。该文件的示例如下所示：

```
GRP 3 DTL abc DTL def DTL ghi GRP 2 DTL wxy DTL z 
```

我希望导入数据，这样每个 GRP 都是一条记录，每个 DTL 都是一条记录，如下所示：

```
GRP 3
DTL abc
DTL def
DTL ghi
GRP 2
DTL wxy
DTL z 
```

在创建格式文件时，我似乎只能将格式文件设置为将“GRP”或“DTL”作为行分隔符，但不能同时使用两者。是否可以设置两个行分隔符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:41:04.317

You can't set the row terminator value to a multiple values. However, you may be able to make this work without changing the row terminator. If you set the field terminator to the proper value and add two column definitions in your format file, you should be able to load the data in multiple rows.

# asp.net - 为什么在 MVC4 中使用下划线序列化公共属性？

> ID：14062364
> 
> 赞同：1
> 
> 时间：2012-12-27T22:55:26.420
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, asp.net-web-api

在下面的班级

```
using System;

namespace Beverati.Repository.ViewModel
{

[Serializable]
public class CollectionItem : EditableEntityBase
{

public CollectionItem() {}

private int? _quantity;
private string _retailValue;
private string _currencyName;

public int? quantity
{
  get { return this._quantity ?? NULL_INTEGER; }
  set { this._quantity = value; }
}

public string retailValue
{
  get { return this._retailValue ?? String.Empty; }
  set { this._retailValue = value; }
}

public string currencyName
{
  get { return this._currencyName ?? String.Empty; }
  set { this._currencyName = value; }
}

}
} 
```

在此控制器操作中返回

```
public IEnumerable<Repository.ViewModel.CollectionItem> GetAll() 
```

使用 MVC2 生成此 JSON 输出 JSON 输出如下

```
{
  quantity:2
  retailValue: 50.00
  currencyName: USD
} 
```

但是，当我安装 MVC4 时，返回的 JSON 看起来像这样

```
{
  _quantity:2
  _retailValue: 50.00
  _currencyName: USD
} 
```

所有属性名称都有一个下划线前缀。为什么要使用下划线以及如何在 JSON 中返回公共属性名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:02:39.603

[Serializable] 属性是做什么的-假设您不需要它用于其他目的-删除该属性，一切都应该很好。

# jquery - 2012 年推荐的 jQuery 模板？

> ID：14062368
> 
> 赞同：55
> 
> 时间：2012-12-27T22:55:39.913
> 
> 标签：jquery, html, json, templates

jQuery 模板已经被弃用了一段时间。

我有一些 JavaScript 对象形式的数据，我想将其格式化为 HTML 并附加到 DOM。这些天最好的方法是什么？

1.  我应该建立一个 HTML 字符串吗？
2.  我应该通过 jQuery 创建元素`$('<li>',{id:'my-'+Id}).append($('<span>').text(myText))`吗？
3.  jQuery 模板是否有替代品或成熟的替代品？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-12-27T23:01:31.747

这就是我在项目中的做法：

在 HTML 中定义模板：

```
<script type="text/template" id="cardTemplate">
<div>
    <a href="{0}">{1}</a>
</div>
</script> 
```

使用 string.format 替换变量：

```
var cardTemplate = $("#cardTemplate").html();
var template = cardTemplate.format("http://example.com", "Link Title");
$("#container").append(template); 
```

[字符串格式](https://stackoverflow.com/questions/610406/javascript-equivalent-to-printf-string-format)：

```
String.prototype.format = function() {
  var args = arguments;
  return this.replace(/{(\d+)}/g, function(match, number) { 
    return typeof args[number] != 'undefined'
      ? args[number]
      : match
    ;
  });
}; 
```

很简单，你甚至可以组合模板。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-27T22:58:25.423

您绝对应该尝试[Handlebars](http://handlebarsjs.com)和/或[Mustache](https://github.com/janl/mustache.js)

我倾向于使用 Handlebars，但语法非常相似。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-27T22:57:32.867

Mustache.js 非常适合做模板。

[https://github.com/janl/mustache.js](https://github.com/janl/mustache.js)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-28T05:24:13.903

一路模板，比尝试手动解析 JSON 容易得多。由于我为它做出了贡献，所以我偏爱 json2html，因为它不需要编译模板并且只使用 JSON 和 JavaScript。

[http://json2html.com](http://json2html.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T23:01:54.420

我真的不喜欢使用 javascript 构建 html 元素，所以我建议你使用一些模板。[您可以在此处](https://stackoverflow.com/questions/449780/recommended-javascript-html-template-library-for-jquery)
找到模板列表和相关问题。

我曾经使用过`jQuery Templates`，它很简单，但它不再主动了。

# sql - 如何在 SQL Server 中查找包含特定列的 MIN/MAX 值的所有（基于组的）行？

> ID：14062375
> 
> 赞同：1
> 
> 时间：2012-12-27T22:56:33.280
> 
> 标签：sql, sql-server

我有一个临时表（`@TempPackages`），它看起来像这样：

```
EntryId (PK)    PackageId    SubProductID    SubProductSequence
1               1111         17              3
2               1111         28              4
3               1111         33              1
4               1111         67              5
5               1111         122             2
6               2222         18              4
7               2222         29              5
8               2222         33              9
9               2222         103             7
10              2222         99              11
11              3333         256             5
12              3333         333             6
13              3333         789             3
14              3333         1023            2
15              3333         9845            1 
```

我需要一个查询，它将为我`SubProductSequence`提供每个 unique的最小/最大值的行`PackageId`。对于上表，查询将返回：

```
EntryId (PK)    PackageId    SubProductID    SubProductSequence
3               1111         33              1
4               1111         67              5
6               2222         18              4
10              2222         99              11
12              3333         333             6
15              3333         9845            1 
```

该`EntryId`列是我在尝试解决此问题时添加的内容，因为它为我提供了一个独特的列来连接同一个表（以确保我的连接表中仍然只有 15 行）。

我试过这个 - 只是为了得到`MIN()`：

```
SELECT
    *
FROM
    @TempPackages p1
INNER JOIN
    @TempPackages p2 ON p1.EntryId = p2.EntryId
    AND p1.SubProductSequence = (
        SELECT
            MIN(SubProductSequence)
        FROM
            @DeparturesToUpdate) 
```

显然这是错误的，因为`INNER JOIN`是多余的，并且该`SELECT MIN()`子句是错误的，因为它选择具有最小*总*序列号的行，而不是*每个*包的最小序列号。

关于最好的方法有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:24:40.343

一种方法是使用该**[`ROW_NUMBER()`](http://msdn.microsoft.com/en-us/library/ms189798.aspx)**功能：

```
SELECT
    EntryId 
  , PackageId 
  , SubProductID 
  , SubProductSequence
FROM
  ( SELECT
        EntryId 
      , PackageId 
      , SubProductID 
      , SubProductSequence
      , ROW_NUMBER() OVER (PARTITION BY PackageId
                           ORDER BY SubProductSequence ASC)
          AS rna
      , ROW_NUMBER() OVER (PARTITION BY PackageId
                           ORDER BY SubProductSequence DESC)
          AS rnd
    FROM
        @TempPackages
  ) AS tmp 
WHERE
      rna = 1
   OR rnd = 1 ; 
```

* * *

`ROW_NUMBER()`是与**[`OVER`](http://msdn.microsoft.com/en-us/library/ms189461.aspx)**子句一起使用的排名函数。在这种情况下，它的基本作用是将行分组`PackageId`（使用 完成`PARTITION BY PackageId`），然后按`SubProductSequence`（升序或降序）对它们进行排序并分配一个 row_number，从每个 packageId 的 1 开始。

因此，如果子查询单独运行，它将返回：

```
EntryId (PK)    PackageId    SubProductID    SubProductSequence  rna  rnd
3               1111         33              1                    1    5
5               1111         122             2                    2    4
1               1111         17              3                    3    3
2               1111         28              4                    4    2
4               1111         67              5                    5    1

6               2222         18              4                    1    5
7               2222         29              5                    2    4
9               2222         103             7                    3    3
8               2222         33              9                    4    2
10              2222         99              11                   5    1

15              3333         9845            1                    1    5
14              3333         1023            2                    2    4
13              3333         789             3                    3    3
11              3333         256             5                    4    2    
12              3333         333             6                    5    1 
```

在外部查询中添加的`WHERE`条件之后就很明显了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:28:56.207

改进波西米亚的想法——

```
;WITH MinMax AS
(SELECT  PackageId ,
    MIN(SubProductSequence) [Min],
    MAX(SubProductSequence) [Max]
FROM    @TempPackages
GROUP BY PackageId )

SELECT EntryId, SubProductSequence, TP.PackageId, SubProductID FROM @TempPkges TP
INNER JOIN MinMax MM ON TP.PackageId = MM.PackageId 
AND (SubProductSequence = MM.[Min] OR SubProductSequence = MM.[Max]) 
```

然后，您可以添加自己的 ORDER BY

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T05:22:35.907

```
 WITH  t1 AS
 (SELECT PackageId,MIN(SubProductSequence) minm,MAX(SubProductSequence) maxm  
 FROM    #@TempPackages
 GROUPBY  PackageId
 )
 SELECT  pk.EntryId, pk.PackageId,pk.SubProductID,  pk.SubProductSequence 
 FROM  #@TempPackages pk INNER JOIN t1 
 ON pk.PackageId = t1.PackageId
 WHERE pk.SubProductSequence = t1.minm  OR
       pk.SubProductSequence = t1.maxm 
```

# c# - 如何使用 HtmlAgilityPack 搜索节点？

> ID：14062376
> 
> 赞同：0
> 
> 时间：2012-12-27T22:56:33.840
> 
> 标签：c#, html-agility-pack

可以说我有这个html：

```
<table class="c1">
<tr>
<td>Dog</td>
<td><a href="http://en.wikipedia.org/wiki/Dog">Dog</a><td>
</tr>
<tr>
<td>Cat</td>
<td><a href="http://en.wikipedia.org/wiki/Cat">Cat</a><td>
</tr>
</table> 
```

我尝试了什么：

```
HtmlNode node = doc.DocumentNode.SelectSingleNode("//table[@class='c1']");
HtmlNodeCollection urls = node.SelectNodes("a"); 
```

有`node`表但`urls`为空。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:02:39.783

使用 `Descendants("a")`代替`SelectNodes("a");`

这应该工作....

```
var node = doc.DocumentNode.SelectSingleNode("//table[@class='c1']");
var  urls = node.Descendants("a").ToList(); 
```

# python - 从 Python 字典中获得唯一的首次出现的更有效方法

> ID：14062379
> 
> 赞同：3
> 
> 时间：2012-12-27T22:56:59.190
> 
> 标签：python, maps, unique, dictionary

我有一个非常大的文件，我正在解析并从该行获取键值。我只想要第一个键和值，只有一个值。也就是说，我正在删除重复的值

所以它看起来像：

```
{
A:1
B:2
C:3
D:2
E:2
F:3
G:1
} 
```

它会输出：

```
{E:2,F:3,G:1} 
```

这有点令人困惑，因为我真的不在乎密钥是什么。所以上面的E可以用B或D代替，F可以用C代替，G可以用A代替。

这是我发现的最好的方法，但是随着文件变大，它非常慢。

```
mapp = {}
value_holder = []

for i in mydict:
 if mydict[i] not in value_holder:
   mapp[i] = mydict[i]
   value_holder.append(mydict[i]) 
```

每次都必须查看 value_holder :( 有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T22:59:12.490

是的，一个微不足道的改变使它更快：

```
value_holder = set() 
```

（好吧，您还必须将 更改`append`为`add`。但仍然很简单。）

使用集合而不是列表意味着每次查找都是 O(1) 而不是 O(N)，因此整个操作是 O(N) 而不是 O(N^2)。换句话说，如果您有 10,000 行，那么您将进行 10,000 次哈希查找而不是 50,000,000 次比较。

这个解决方案的一个警告 - 以及所有其他发布的 - 是它要求值是可散列的。如果它们不是可散列的，但它们具有可比性，您仍然可以通过使用排序集（例如，来自[`blist`](http://pypi.python.org/pypi/blist/)库）获得 O(NlogN) 而不是 O(N^2)。如果它们既不可散列也不可排序……好吧，您可能想找到某种方法来生成可散列（或可排序）的东西以用作“第一次检查”，然后只对“第一次检查”匹配进行实际匹配，这将使您达到 O(NM)，其中 M 是哈希冲突的平均次数。

您可能想查看标准库文档中的[配方](http://docs.python.org/2/library/itertools.html#recipes)`unique_everseen`是如何实现的。[`itertools`](http://docs.python.org/2/library/itertools.html#recipes)

请注意，字典实际上没有顺序，因此无法选择“第一个”副本；你会得到一个任意的。在这种情况下，还有另一种方法可以做到这一点：

```
inverted = {v:k for k, v in d.iteritems()}
reverted = {v:k for k, v in inverted.iteritems()} 
```

（这实际上是一种没有任何处理的[decorate-process-undecorate习语的形式。）](http://wiki.python.org/moin/HowTo/Sorting#The_Old_Way_Using_Decorate-Sort-Undecorate)

但是，您可以通过在阅读时进行过滤来使事情变得更好（更简单、更快、更节省内存和保持顺序），而不是构建`dict`然后过滤它。基本上，`set`边走边`dict`看。例如，而不是这个：

```
mydict = {}
for line in f:
    k, v = line.split(None, 1)
    mydict[k] = v

mapp = {}
value_holder = set()

for i in mydict:
    if mydict[i] not in value_holder:
        mapp[i] = mydict[i]
        value_holder.add(mydict[i]) 
```

只需这样做：

```
mapp = {}
value_holder = set()
for line in f:
    k, v = line.split(None, 1)
    if v not in value_holder:
        mapp[k] = v
        value_holder.add(v) 
```

事实上，您可能需要考虑编写一个`one_to_one_dict`将其包装起来的代码（或搜索 PyPI 模块和 ActiveState 配方以查看是否有人已经为您编写了它），那么您可以编写：

```
mapp = one_to_one_dict()
for line in f:
    k, v = line.split(None, 1)
    mapp[k] = v 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:24:01.933

正如其他人所提到的，第一种加快速度的方法是使用 a`set`来记录看到的值，因为检查集合上的成员资格要快得多。

我们还可以使用[dict comprehension](http://www.youtube.com/watch?v=pShL9DCSIUw)来缩短它：

```
seen = set()
new_mapp = {k: v for k, v in mapp.items() if v not in seen or seen.add(i)} 
```

if 的情况需要一点解释：我们只在之前没有见过值的地方添加键/值对，但我们使用`or`了一些技巧来确保将任何未见过的值添加到集合中。作为`set.add()`回报`None`，它不会影响结果。

与往常一样，在 2.x 中，用户`dict.iteritems()`超过`dict.items()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T22:59:30.483

我并不完全清楚您在做什么，但这`set`是删除重复项的好方法。例如：

```
>>> k = [1,3,4,4,5,4,3,2,2,3,3,4,5]
>>> set(k)
set([1, 2, 3, 4, 5])
>>> list(set(k))
[1, 2, 3, 4, 5] 
```

虽然它有点取决于您正在加载的输入的结构，但可能有一种方法可以简单地使用`set`，这样您就不必每次都遍历整个对象来查看是否有任何匹配的键 - 而不是运行`set`一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T22:59:38.580

使用 a`set`而不是 a`list`会大大加快你的速度......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-27T23:44:39.943

您的部分问题是 dicts 在迭代时不保留任何类型的逻辑顺序。他们使用哈希表来索引项目（参见[这篇很棒的文章](http://www.laurentluce.com/posts/python-dictionary-implementation/)）。所以在这种数据结构中没有真正的“价值首次出现”的概念。这样做的正确方法可能是键值对列表。例如：

```
kv_pairs = [(k1,v1),(k2,v2),...] 
```

或者，因为文件太大，最好使用 python 提供的优秀文件迭代来检索 k/v 对：

```
def kv_iter(f):
    # f being the file descriptor
    for line in f:
        yield ... # (whatever logic you use to get k, v values from a line) 
```

Value_holder 是集合变量的绝佳候选者。您实际上只是在测试 value_holder. 因为值是唯一的，所以可以使用类似的散列方法更有效地对它们进行索引。所以它最终会有点像这样：

```
mapp = {}
value_holder = set()

for k,v in kv_iter(f):
    if v in value_holder:
       mapp[k] = v
       value_holder.add(v) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-27T22:59:54.007

您说您正在读取一个非常大的文件，并且只想保留第一次出现的键。我最初认为这意味着您关心键/值对在非常大的文件中出现的顺序。这段代码会做到这一点并且会很快。

```
values_seen = set()
mapp = {}
with open("large_file.txt") as f:
    for line in f:
        key, value = line.split()
        if value not in values_seen:
            values_seen.add(value)
            mapp[key] = value 
```

您正在使用 a`list`来跟踪您的代码看到的键。搜索 a`list`非常慢：列表越大，它就越慢。A`set`快得多，因为查找接近于恒定时间（不会变得更慢，或者可能根本更慢，列表越大）。（A`dict`也以 a 的方式`set`工作。）

# parameters - Crystal Reports：显示选定的参数

> ID：14062380
> 
> 赞同：0
> 
> 时间：2012-12-27T22:57:00.470
> 
> 标签：parameters, crystal-reports, crystal-reports-2008

我有一个使用 Crystal Reports 2008 制作的 Crystal Report，它的参数值允许从静态列表中进行多项选择。

有谁知道我如何在报告中显示从该参数列表中选择的值？

该列表为“数字”类型，每个条目都有相应的描述。我想显示描述（只有 4 个，所以如果我需要放入 switch 或 if 语句，我不会不高兴）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:36:59.810

多选参数是一个数组，当您深入了解它时。下面的代码在 Crystal XI 中进行了测试，基本上它遍历参数数组中的每个值并执行一个 select/case 语句来获取该值。据我所知，您不能使用代码中的描述，只能在参数选择期间在屏幕上使用。

我在每个描述 ( ) 之间放置了一个换行符回车`+ chr(13) + chr(10)`，您可能希望以不同的方式对待它们。

```
Local NumberVar i;
Local StringVar output := "";
Local StringVar paramDesc; //the current parameter's description

for i := 1 to UBound({?MyParameter}) do (
    paramDesc := "";
    select {?MyParameter}[i]
        case 1 : paramDesc := "Option 1" + chr(13) + chr(10)
        case 2 : paramDesc := "Option 2" + chr(13) + chr(10)
        case 3 : paramDesc := "Option 3" + chr(13) + chr(10)
        case 4 : paramDesc := "Option 4" + chr(13) + chr(10)
        default: paramDesc := "";
    output := output + paramDesc;
);

output 
```

# javascript - 将 DropDownList 选择限制为 GridView 中的该值之一

> ID：14062381
> 
> 赞同：0
> 
> 时间：2012-12-27T22:57:04.633
> 
> 标签：javascript, jquery, asp.net, gridview

在我的 ASP`GridView control`中，我有一个`column`带有`sort order dropdownlist`. 包含几个

. 每个(1,2,3,4) 中有四个值。 这个想法是，只有一行的排序顺序为 1，只有一行的排序顺序为 2，依此类推。`gridview``dozen rows`
`dropdownlist`
`grid`

如果一行已经在 中选择了排序顺序 1 `dropdownlist`，并且我在另一行中选择了值 1，我希望所有其他值为 1 的行重置为 中的第一个（空）`listitem`。`dropdown list`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:59:54.800

您应该更详细，至少让我们知道您使用的是什么代码。在 VB 中，我相信它看起来像这样：

```
Sub list1_changed(byval sender as object, byval e as eventargs) handles list1.selection_changed

dim i as integer
if list1.selectedvalue = 1 then
   if list2.selectedvalue = 1 then
     list2.selectedindex = 0
   end if
   if list3.selectedvalue = 1 then
     list2.selectedindex = 0
   end if
   if list3.selectedvalue = 1 then
     list2.selectedindex = 0
   end if 
end if

end sub 
```

我只是徒手做的，所以你当然必须仔细检查属性、拼写等。这实际上只是基本逻辑。当一个下拉列表更改时，循环遍历其余的并检查它们是否等于 1，如果是，则将它们切换到第一个索引项（空的项）。当然，您必须为每个下拉列表重复该子例程。祝你好运！

# java - 删除读取文件记录的 JTable 行

> ID：14062383
> 
> 赞同：-3
> 
> 时间：2012-12-27T22:57:18.743
> 
> 标签：java, swing, file, jtable

我是 java 新手，我有一个`JTable`可以从 txt 文件中读取记录并完美显示它们的工具。我想添加一本新书`JFrame`，当用户在表格上选择一行并单击“删除”按钮时，该行应该删除，并且已删除的行记录也必须从 txt 文件中删除。我的代码是这样的，但是它有错误并且没有看到`JTable`！：

```
public class CopyOfAllUserTable extends AbstractTableModel {
Vector data;
Vector column;
public static void main(String[] args){
    new CopyOfAllUserTable();
}
public CopyOfAllUserTable() {

        String line;
        data = new Vector();
        column = new Vector();
        try {
        FileInputStream fis = new FileInputStream("D:\\AllUserRecords.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(fis));
      StringTokenizer st1 = new StringTokenizer(br.readLine(), " ");
              while (st1.hasMoreTokens())
               column.addElement(st1.nextToken());
                while ((line = br.readLine()) != null) {
                       StringTokenizer st2 = new StringTokenizer(line, " ");
                        while (st2.hasMoreTokens())
                                data.addElement(st2.nextToken());
                }
                br.close();
        } catch (Exception e) {
                e.printStackTrace();
        }

    final JFrame frame1=new JFrame();
     JTable table=new JTable(data,column);
    JButton button1=new JButton("Delete");

    button1.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
           DefaultTableModel model=new DefaultTableModel(data, column);
           JTable table=new JTable(model);

        }
    });

    JPanel panel=new JPanel();
    panel.add(table);
    panel.add(button1);
    frame1.add(panel);
    frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame1.setBounds(200, 80, 600, 500);
    frame1.setVisible(true);
    frame1.setEnabled(true);

}

public int getRowCount() {
        return data.size() / getColumnCount();
}

public int getColumnCount() {
        return column.size();
}

public Object getValueAt(int rowIndex, int columnIndex) {
        return (String) data.elementAt((rowIndex * getColumnCount())
                        + columnIndex);
}

} 
```

我的问题出在删除行中，从文件到 jtable 的读取记录非常成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:09:35.667

首先，您没有将您`JTable`的内容添加到框架的内容中。

对于像：这样的容器`frame.getContentPane()`，`JPanel`您应该使用它们的`#add(...)`方法添加子组件。

例如：

```
 final JPanel panel=new JPanel(new BorderLayout());
 button1.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
       DefaultTableModel model=new DefaultTableModel(data, column);
       JTable table=new JTable(model);
       panel.add(new JScrollPane(table));
       panel.revalidate();
    }
}); 
```

请注意，`JPanel`默认布局是`FlowLayout`. 第二件事 - 如果你想在你的标题和滚动，`JTable`你需要用`JScrollPane`. 接下来 - 您应该在添加/删除/等后重新验证面板。

第二个问题是从`JTable`. 我通常会写一个方法来处理它：

```
protected void removeRows(final int[] rows) {
    int modelRows[] = new int[rows.length];
    for(int i = 0; i < rows.length; ++i) {
        modelRows[i] = table.convertRowIndexToModel(rows[i]);
    }
    Arrays.sort(modelRows);
    for(int i = modelRows.length - 1; i >= 0; --i) {
        int row = modelRows[i];
        model.removeRow(row);
    }
    model.fireTableDataChanged();
} 
```

该`convertRowIndexToModel`方法将`JTable#getSelectedRows()`or返回的索引`JTable#getSelectedRow()`（它们是可见索引）转换为模型索引。如果您`RowSorter`为您的设置`JTable`或您将其留给标准实现：

```
table.setAutoCreateRowSorter(true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T02:57:20.040

您正在将表格直接添加到面板中，而无需使用`JScrollPane`. 如果你这样做，你的表格标题将不可见，所以代替这个，

```
JPanel panel=new JPanel();
    panel.add(table); 
```

做这个，

```
JPanel panel=new JPanel();
panel.add(new JScrollPane(table)); 
```

为什么要使用`JScrollPane`？读[这个](https://stackoverflow.com/questions/13935934/java-jtable-column-headers-not-showing/13936925#13936925)。

当用户选择一行并单击删除时，然后获取所选行并将其从表列表中删除。当您使用`AbstractTableModel`时，您必须编写自定义`removeRow(..)`方法来执行此操作。

**例子：**

```
private boolean removeSelectedRow(int row) {
    // Remove the row from the list that the table is using.
    dataList.remove(row);
    // You need to call fireXXX method to refresh the table model.
    fireTableDataChanged();
    return true;
   // If fail return false;
} 
```

如果删除是操作，则首先获取选定的行，然后调用 removeSelectedRow(int)，如下所示，

```
private void deleteRow() {
  int selectedRow = table.getSelectedRow();
  boolean deleteStatus = removeSelectedRow(selectedRow);

  // Only if the deletion is success then delete from the file.
  if(deleteStatus) {
    // Delete it from the file too.
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T11:52:15.627

首先，您必须确保已选择某些内容：选择某些内容时，启用删除按钮。请查阅 JTable java 源代码@

[http://developer.classpath.org/doc/javax/swing/JTable-source.html](http://developer.classpath.org/doc/javax/swing/JTable-source.html)

和以下代码：

`1331: /**
1332: * Receives notification when the row selection changes and fires
1333: * appropriate property change events.
1334: *
1335: * @param event the list selection event
1336: */
1337: public void valueChanged(ListSelectionEvent event)
1338: {
1339: firePropertyChange(AccessibleContext.ACCESSIBLE_SELECTION_PROPERTY,
1340: Boolean.FALSE, Boolean.TRUE);
1341: int r = getSelectedRow();
1342: int c = getSelectedColumn();
1343: if (r != lastSelectedRow || c != lastSelectedColumn)
1344: {
1345: Accessible o = getAccessibleAt(lastSelectedRow,lastSelectedColumn);
1347: Accessible n = getAccessibleAt(r, c);
1348: firePropertyChange(AccessibleContext.ACCESSIBLE_ACTIVE_DESCENDANT_PROPERTY, o, n);
1350: lastSelectedRow = r;
1351: lastSelectedColumn = c;
1352: }
1353: }` 

 `您需要注册最后一个事件，以便在更改所选行时收到通知。添加您自己的侦听器以根据是否选择了行来启用删除按钮，正如您在事件本身中看到的那样。

请使用 DefaultTableModel 开始，因为它适用于 90% 的情况。

并且任何更改都会应用于 tabledatamodel，它将自动传播到 JTable 视图：通常您永远不会更改视图，因为所有选择和滚动信息都会丢失，这是您不想要的。

当删除按钮被触发时，方法很简单：选择了一行，否则无法单击它：从 defaultTableModel 中删除选定的行号，最后但并非最不重要的是，我将简单地编写数据模型的全部内容模型到指定的文件，因为表的模型包含实际显示在视图中的实际行。

所以请考虑模型模型和模型：视图仅实例化一次，打包滚动等，然后将它们保持原样。模型通常也不会更改：您可以通过添加或删除行来更改模型的内容。另一个提示：总是使用渲染器：在我看来，那些不使用的渲染器不了解如何使用 JTables。

是的，您可以省略第一部分来监听选择更改：确定并弹出警告以指示问题。并在稍后阶段添加侦听选择更改以启用和或禁用 JButton 删除行的功能。

希望这可以帮助。`

# linq-to-sql - 计算提交的查询

> ID：14062388
> 
> 赞同：0
> 
> 时间：2012-12-27T22:57:45.867
> 
> 标签：linq-to-sql, azure-sql-database, plinqo

所以我在一个大型项目中使用 PLINQO Linq2Sql。我想知道是否有任何方法可以计算通过使用 PLINQO 或 Linq2Sql 的代码提交到 SqlServer 的查询数量？

就像我写代码一样

```
var a = Tables.Users.FirstOrDefault(x=>x.Username == username);
var b = Tables.Apples.Where(x=>x.UID == a.UID).ToList();
var c = Tables.Pears.Where(x=>x.UID == a.UID); 
```

结果将是`2`因为第三个仍然只是一个`IQueryable`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T18:33:25.543

好吧，这不是您想在生产环境中做的事情。

我没有解决方案，但我想你可以从 log 属性开始

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.log.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.log.aspx)

并围绕它编写一些代码。

# mesh - 使用 vtk 从点和法线对曲面进行三角剖分

> ID：14062401
> 
> 赞同：3
> 
> 时间：2012-12-27T22:58:34.270
> 
> 标签：mesh, surface, vtk, triangulation, 3d-modelling

我有一组位于表面上的 3D 点，并且每个点都有法线。我想用这些信息生成一个表面三角剖分。此外，如果需要，我可以告诉算法使用边界上的哪些点。

所以，我有很多信息：*点*法线*边界

如何使用 vtk 使用此信息对曲面进行三角测量？

表面重建算法就像使用炸弹来解决这个问题，因为我拥有所有我想使用的信息。此信息来自模拟，因此我知道表面存在并且非常光滑。

我希望根据要使用的 vtk 函数以及使用此函数的示例（如果可用（那将是很棒的）示例）来给出答案。

非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T02:54:02.427

您可以使用[vtkSurfaceReconstruction](http://www.vtk.org/doc/nightly/html/classvtkSurfaceReconstructionFilter.html)过滤器从一组 3D 点创建表面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:04:18.550

你可以试试点云库

[点云库](http://www.pointclouds.org)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-28T10:18:43.287

仅 3D 点就足够了。由于您知道您的表面是平滑的，因此您可以对点执行 Delaunay 三角剖分 (vtkDelaunay3D) 并应用细分过滤器进行平滑处理 (vtkButterflySubdivisionFilter)。

[Delaunay3D三角剖分](http://www.vtk.org/Wiki/VTK/Examples/Cxx/Modelling/Delaunay3D)

# awk - awk：使用一个文件过滤另一个文件（out.tr）

> ID：14062402
> 
> 赞同：6
> 
> 时间：2012-12-27T22:58:36.287
> 
> 标签：awk

帮助 awk，使用一个文件过滤另一个我有一个主文件：

```
...
17,466971 0,095185 17,562156 id 676
17,466971 0,096694 17,563665 id 677
17,466971 0,09816 17,565131 id 678
17,466971 0,099625 17,566596 id 679
17,466971 0,101091 17,568062 id 680
17,466971 0,016175 17,483146 id 681
17,466971 0,101793 17,568764 id 682
17,466971 0,10253 17,569501 id 683
38,166772 0,08125 38,248022 id 1572
38,166772 0,082545 38,249317 id 1573
38,233772 0,005457 38,239229 id 1574
38,233772 0,082113 38,315885 id 1575
38,299771 0,081412 38,381183 id 1576
38,299771 0,006282 38,306053 id 1577
38,299771 0,083627 38,383398 id 1578
38,299771 0,085093 38,384864 id 1579
38,299771 0,008682 38,308453 id 1580
38,299771 0,085094 38,384865 id 1581
... 
```

我想根据这个其他文件，最后一列 (id) 抑制/删除一些行：

```
...
d 17.483146 1 0 udp 181 ------- 1 19.0 2.0 681
d 38.239229 1 0 udp 571 ------- 1 19.0 2.0 1574
d 38.306053 1 0 udp 1000 ------- 1 19.0 2.0 1577
d 38.308453 1 0 udp 1000 ------- 1 19.0 2.0 1580
d 38.372207 1 0 udp 546 ------- 1 19.0 2.0 1582
d 38.441845 1 0 udp 499 ------- 1 19.0 2.0 1585
d 38.505262 1 0 udp 616 ------- 1 19.0 2.0 1586
d 38.572324 1 0 udp 695 ------- 1 19.0 2.0 1588
d 38.639246 1 0 udp 597 ------- 1 19.0 2.0 1590
d 38.639758 1 0 udp 640 ------- 1 19.0 2.0 1591 
... 
```

对于上面的示例，结果将是：

```
17,466971 0,095185 17,562156 id 676
17,466971 0,096694 17,563665 id 677
17,466971 0,09816 17,565131 id 678
17,466971 0,099625 17,566596 id 679
17,466971 0,016175 17,483146 id 680
17,466971 0,101793 17,568764 id 682
17,466971 0,10253 17,569501 id 683
38,166772 0,08125 38,248022 id 1572
38,166772 0,082545 38,249317 id 1573
38,233772 0,082113 38,315885 id 1575
38,299771 0,081412 38,381183 id 1576
38,299771 0,083627 38,383398 id 1578
38,299771 0,085093 38,384864 id 1579
38,299771 0,085094 38,384865 id 1581 
```

删除的行是：

```
17,466971 0,101091 17,568062 id 681
38,233772 0,005457 38,239229 id 1574
38,299771 0,006282 38,306053 id 1577
38,299771 0,008682 38,308453 id 1580 
```

是否有使用 awk 的命令来自动执行此操作？

先感谢您

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-27T23:20:07.793

这是一种使用方法`awk`：

```
awk 'FNR==NR { a[$NF]; next } !($NF in a)' other main 
```

结果：

```
17,466971 0,095185 17,562156 id 676
17,466971 0,096694 17,563665 id 677
17,466971 0,09816 17,565131 id 678
17,466971 0,099625 17,566596 id 679
17,466971 0,101091 17,568062 id 680
17,466971 0,101793 17,568764 id 682
17,466971 0,10253 17,569501 id 683
38,166772 0,08125 38,248022 id 1572
38,166772 0,082545 38,249317 id 1573
38,233772 0,082113 38,315885 id 1575
38,299771 0,081412 38,381183 id 1576
38,299771 0,083627 38,383398 id 1578
38,299771 0,085093 38,384864 id 1579
38,299771 0,085094 38,384865 id 1581 
```

删除感叹号以显示“已删除”行：

```
awk 'FNR==NR { a[$NF]; next } $NF in a' other main 
```

结果：

```
17,466971 0,016175 17,483146 id 681
38,233772 0,005457 38,239229 id 1574
38,299771 0,006282 38,306053 id 1577
38,299771 0,008682 38,308453 id 1580 
```

* * *

或者，如果您想要两个文件，一个包含值“present”，另一个包含值“deleted”，请尝试：

```
awk 'FNR==NR { a[$NF]; next } { print > ($NF in a ? "deleted" : "present") }' other main 
```

* * *

*说明1：*

`FNR==NR { ... }`是一个常用的构造，它只对参数列表中的第一个文件返回 true。在这种情况下，`awk`将首先读取文件“其他”。在处理这个文件时，最后一列 ( `$NF`) 中的值被添加到一个数组中（我们称之为`a`）。`next`然后跳过处理我们的其余代码。读取第一个文件后，`FNR`将不再等于`NR`，因此`awk`将“允许”跳过该`FNR--NR { ... }`块并开始处理应用于参数列表中的第二个文件“main”中的代码的其余部分。例如，如果不在数组中`!($NF in a)`，则不会打印该行。`$NF`

*解释2：*

关于哪一列，您可能会发现这很有帮助：

```
$1         # the first column
$2         # the second column
$3         # the third column

$NF        # the last column
$(NF-1)    # the second last column
$(NF-2)    # the third last column 
```

# android - Parcelable 数组未在活动之间传递

> ID：14062403
> 
> 赞同：1
> 
> 时间：2012-12-27T22:58:42.590
> 
> 标签：android

所以，我在两个活动之间传递 Parcelable 数组时遇到了问题。出于某种原因，该应用程序甚至在加载我正在调用的活动之前就崩溃了。

这是我试图传递的对象。

```
import android.os.Parcel;
import android.os.Parcelable;

public class Inventory implements Parcelable{
public String inventory_id = "" ;
public String vin = "" ;
public String stock = "" ;
public String new_used = "" ;
public String certified = "" ;
public String mileage = "" ;

public Inventory() {}

@Override
public int describeContents() {
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    dest.writeString(inventory_id);
    dest.writeString(vin);
    dest.writeString(stock);
    dest.writeString(new_used);
    dest.writeString(certified);
    dest.writeString(mileage);
}

public Inventory(Parcel source){
    inventory_id = source.readString();
    vin = source.readString();
    stock = source.readString();
    new_used = source.readString();
    certified = source.readString();
    mileage = source.readString();
}

public static final Parcelable.Creator<Inventory> CREATOR = new  Parcelable.Creator<Inventory>() {

    public Inventory createFromParcel(Parcel source) {
        return new Inventory(source);
    }

    public Inventory[] newArray(int size) {
        return new Inventory[size];
    }
};    
} 
```

这是我通过的那条线

```
Intent intent = new Intent(this, Activity2.class);
intent.putParcelableArrayListExtra("invList", invList); //This is a list of inventory objects.
startActivity(intent); 
```

此代码从不加载 Activity2。我可以在 Activity 2 的 onCreate 方法中创建一个调试点，并且它永远不会被调用。如果我注释掉*intent.putParcelableArrayListExtra("invList", invList);* , Activity2 将加载，但是当我到达需要 invList 的行时当然会爆炸，这使我相信活动之间的 Parcelable 对象正在发生某些事情。我的 LogCat 中什么也没有。它只是重新加载 Activity1。

这里的任何帮助将不胜感激。

# php - PHP中内容生成站点的自定义文本编辑器的开发时间

> ID：14062409
> 
> 赞同：0
> 
> 时间：2012-12-27T22:59:18.673
> 
> 标签：php, drupal, text, editing

这是一个Web开发项目。我与另一位开发人员一起工作。我们需要高效地利用我们的时间。

我们正在研究我们网站中文本编辑器的选项。对于 beta，我们使用的是 wizywig 编辑器。我们担心外观和感觉与我们网站的质量不符。

我们正在寻找我们在 Drupal CMS 中使用 PHP 开发编辑器的策略的选项

1.  更改基本格式的选项 a) 粗体 b) 斜体 c) 字体大小 d) 下划线
2.  实时保存（类似于 Google Docs）

未来有哪些发展选择？我们应该从头开始开发还是从框架开始工作？开发时间有哪些注意事项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:14:55.177

您必须权衡您的团队在 PHP、（AJAX？）和 Drupal 方面的经验，以估计开发时间。这里真的只有3个选项。您可以从头开始开发，您可以使用现有系统并重写它以满足您的需求，或者您可以搜索现有扩展以​​与 Drupal 一起使用。在不判断您的团队技能的情况下，找到最接近您需求的协作编辑器（也具有适当的许可证）并开始将其安装到 Drupal 可能是最快的。然后修改其余部分以满足您的规格。然而，这只是一种意见。祝你的任务好运！

# iphone - 如何实现我在自己的编码中找到的这个答案？

> ID：14062410
> 
> 赞同：-4
> 
> 时间：2012-12-27T22:59:23.790
> 
> 标签：iphone, ios, xcode, google-maps, mapkit

我是一个业余程序员，最近才开始尝试 xcode。我在谷歌上搜索试图在我的应用程序中找到我当前问题的答案。（我稍后会谈到。）我在 Stackoverflow.com 上找到了一个很好的答案，尽管我不确定如何在我自己的编码中实现它。（链接：[在 Xcode 中打开原生谷歌地图](https://stackoverflow.com/questions/8282369/opening-native-google-maps-in-xcode)）

**编辑：**基本上：我正在使用一个选项卡应用程序，其中一个选项卡中有一个地图视图，您可以根据编码看到它我有诸如混合、卫星等之类的东西，以及一个显示位置的坐标的注释针，当您单击它时，您可以看到一个按钮。正是从这里我不知道该怎么做，因为我希望该按钮将您链接到您 iPhone 上的“地图”应用程序，为您提供从当前位置到该位置的路线。这个问题是在我写的链接中提出的。它收到了一个答案，尽管我不知道如何在我自己的编码中实现它。

这是我自己的代码：

视图控制器.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>
@interface SecondViewController : UIViewController{
MKMapView *mapview;
}

@property (nonatomic, retain) IBOutlet MKMapView *mapview;
-(IBAction)setMap:(id)sender;
-(IBAction)getlocation;

@end 
```

视图控制器.m

```
#import "SecondViewController.h"
#import "Annotation.h"

@implementation SecondViewController
@synthesize mapview;
-(IBAction)getlocation {
mapview.showsUserLocation = YES;
}
-(IBAction)setMap:(id)sender {
switch (((UISegmentedControl *) sender).selectedSegmentIndex) {
    case 0:
        mapview.mapType = MKMapTypeStandard;
        break;
    case 1:
        mapview.mapType = MKMapTypeSatellite;
        break;
    case 2:
        mapview.mapType = MKMapTypeHybrid;
        break;
    default:
        break;
}
}

-(void)viewDidLoad {

[super viewDidLoad];
[mapview setMapType:MKMapTypeStandard];
[mapview setZoomEnabled:YES];
[mapview setScrollEnabled:YES];
[mapview setDelegate:self];

MKCoordinateRegion bigBen = { {0.0, 0.0} , {0.0, 0.0} };
bigBen.center.latitude = 38.849977;
bigBen.center.longitude = -122.519531;
bigBen.span.longitudeDelta = 0.02f;
bigBen.span.latitudeDelta = 0.02f;
[mapview setRegion:bigBen animated:YES];

Annotation *ann1 = [[Annotation alloc] init];
ann1.title = @"Name";
ann1.subtitle = @"Street";
ann1.coordinate = bigBen.center;
[mapview addAnnotation: ann1];
}

-(MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation {
MKPinAnnotationView *MyPin=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"current"];

UIButton *advertButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
if ([[annotation title] isEqualToString:@"The Place"]) {
    [advertButton addTarget:self action:@selector(BigBenClicked:) forControlEvents:UIControlEventTouchUpInside];
}

MyPin.rightCalloutAccessoryView = advertButton;
MyPin.draggable = NO;
MyPin.highlighted = YES;
MyPin.animatesDrop=TRUE;
MyPin.canShowCallout = YES;

return MyPin;
}

-(void)button:(id)sender {

NSLog(@"Button action");

}

@end 
```

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:16:54.880

您已经设置了按下按钮时的选择器。只需实现该方法，它应该可以工作。

```
-(void)BigBenClicked:(id)sender {
    NSURL *url = [self getURL];
    [[UIApplication sharedApplication] openURL:url];
} 
```

# iphone - 核心图形 CGContextSetFillColorWithColor 没有填充我的形状

> ID：14062414
> 
> 赞同：0
> 
> 时间：2012-12-27T22:59:38.813
> 
> 标签：iphone, objective-c, ios, core-graphics

我有以下形状，需要用颜色或背景图像填充：

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSaveGState(context);

CGMutablePathRef pPath_0 = CGPathCreateMutable();
CGPathMoveToPoint(pPath_0, NULL, 72.61 / 2 + xCoordinates,20.21 / 2 + yCoordinates);
CGPathAddLineToPoint(pPath_0, NULL, 69.19 / 2 + xCoordinates,16.37 / 2 + yCoordinates);
CGPathAddLineToPoint(pPath_0, NULL, 26.02 / 2 + xCoordinates,16.37 / 2 + yCoordinates);
CGPathAddLineToPoint(pPath_0, NULL, 22.69 / 2 + xCoordinates,20.21 / 2 + yCoordinates);
CGPathAddCurveToPoint(pPath_0, NULL, 22.69 / 2 + xCoordinates,20.21 / 2 + yCoordinates,17.69 / 2 + xCoordinates,24.84 / 2 + yCoordinates,17.69 / 2 + xCoordinates,34.71 / 2 + yCoordinates);
CGPathAddLineToPoint(pPath_0, NULL, 17.69 / 2 + xCoordinates,194.87 / 2 + yCoordinates);
CGPathAddCurveToPoint(pPath_0, NULL, 17.69 / 2 + xCoordinates,194.87 / 2 + yCoordinates,20.87 / 2 + xCoordinates,206.37 / 2 + yCoordinates,47.69 / 2 + xCoordinates,206.37 / 2 + yCoordinates);
CGPathAddLineToPoint(pPath_0, NULL, 48.69 / 2 + xCoordinates,206.37 / 2 + yCoordinates);
CGPathAddCurveToPoint(pPath_0, NULL, 75.69 / 2 + xCoordinates,206.37 / 2 + yCoordinates,77.69 / 2 + xCoordinates,194.87 / 2 + yCoordinates,77.69 / 2 + xCoordinates,194.87 / 2 + yCoordinates);
CGPathAddLineToPoint(pPath_0, NULL, 77.69 / 2 + xCoordinates,34.71 / 2 + yCoordinates);
CGPathAddCurveToPoint(pPath_0, NULL, 77.69 / 2 + xCoordinates,24.84 / 2 + yCoordinates,72.61 / 2 + xCoordinates,20.21 / 2 + yCoordinates,72.61 / 2 + xCoordinates,20.21 / 2 + yCoordinates);
CGPathCloseSubpath(pPath_0);
CGContextSetRGBStrokeColor(context,0.0000,0.0000,0.0000,1.0000);
CGContextSetLineWidth(context, 1);
CGContextSetMiterLimit(context, 10.0000);

CGContextAddPath(context, pPath_0);
CGContextDrawPath(context, kCGPathStroke);
CGPathRelease(pPath_0);
CGContextRestoreGState(context); 
```

我正在尝试使用以下代码用红色填充形状，但它不起作用：

```
CGContextSetFillColorWithColor(context, [UIColor redColor].CGColor);
CGContextDrawPath(context, kCGPathFill);
CGContextFillPath(context); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:40:29.747

修复：

```
CGContextAddPath(context, pPath_0);

CGContextSetFillColorWithColor(context, [UIColor redColor].CGColor);
CGContextDrawPath(context, kCGPathFill);
CGContextFillPath(context);

CGContextDrawPath(context, kCGPathStroke);
CGPathRelease(pPath_0);
CGContextRestoreGState(context); 
```

# ios - 无法正确看到西班牙字符 ios

> ID：14062416
> 
> 赞同：0
> 
> 时间：2012-12-27T22:59:57.393
> 
> 标签：ios, xml-parsing

```
NSString *urlString = GET_EVENTLIST_URL_STRING;
    NSURL *url = [NSURL URLWithString:[urlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

    if (!url)
    {
        NSString *reason = [NSString stringWithFormat:@"Could not create URL from string %@", GET_EVENTLIST_URL_STRING];
        [self.delegate didGetEventListInCorrect:reason];
        return;
    }

    // Create a mutable request because we will append data to it.
    theRequest = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval: 30.0];

    // Set the HTTP method of the request to POST
    [theRequest setHTTPMethod:@"POST"];

    if (!theRequest)
    {
        NSString *reason = [NSString stringWithFormat:@"Could not create URL request from string %@", GET_EVENTLIST_URL_STRING];
        [self.delegate didGetEventListInCorrect:reason];
        return;
    }
    theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self]; 
```

===== 大家好，我有这个代码，这是我的字符串“Evento Público”，但我在输出中看到“Ãºblico”。我也使用了 NSUTF8StringEncoding，但我无法管理这个？知道吗？提前致谢。

# node.js - 与everyauth相关的困惑

> ID：14062418
> 
> 赞同：-1
> 
> 时间：2012-12-27T23:00:08.483
> 
> 标签：node.js, everyauth

我正在使用这个示例everyauth 应用程序。但是，我对此感到困惑。

**server.js 文件**

```
var express = require('express')
  , everyauth = require('../index')
  , conf = require('./conf')
  , everyauthRoot = __dirname + '/..';

everyauth.debug = true;

var usersById = {};
var nextUserId = 0;

function addUser (source, sourceUser) {
  var user;
  if (arguments.length === 1) { // password-based
    user = sourceUser = source;
    user.id = ++nextUserId;
    return usersById[nextUserId] = user;
  } else { // non-password-based
    user = usersById[++nextUserId] = {id: nextUserId};
    user[source] = sourceUser;
  }
  return user;
}

var usersByVimeoId = {};
var usersByJustintvId = {};
var usersBy37signalsId = {};
var usersByTumblrName = {};
var usersByDropboxId = {};
var usersByFbId = {};
var usersByTwitId = {};
var usersByGhId = {};
var usersByInstagramId = {};
var usersByFoursquareId = {};
var usersByGowallaId = {};
var usersByLinkedinId = {};
var usersByGoogleId = {};
var usersByAngelListId = {};
var usersByYahooId = {};
var usersByGoogleHybridId = {};
var usersByReadabilityId = {};
var usersByBoxId = {};
var usersByOpenId = {};
var usersByDwollaId = {};
var usersByVkId = {};
var usersBySkyrockId = {};
var usersByEvernoteId = {};
var usersByAzureAcs = {};
var usersByTripIt = {};
var usersBy500pxId = {};
var usersBySoundCloudId = {};
var usersByMailchimpId = {};
var usersMailruId = {};
var usersByMendeleyId = {};
var usersByLogin = {
  'brian@example.com': addUser({ login: 'brian@example.com', password: 'password'})
};

everyauth.everymodule
  .findUserById( function (id, callback) {
    callback(null, usersById[id]);
  });

everyauth.azureacs
  .identityProviderUrl('https://acssample1.accesscontrol.windows.net/v2/wsfederation/')
  .entryPath('/auth/azureacs')
  .callbackPath('/auth/azureacs/callback')
  .signingKey('d0julb9JNbCB8J2ACHzxU33SSiqbylQveQtuwOEvz24=')
  .realm('urn:nodeacslocal')
  .homeRealm('')
  .tokenFormat('swt')
  .findOrCreateUser( function (session, acsUser) {
     return usersByAzureAcs[acsUser.id] || (usersByAzureAcs[acsUser.id] = addUser('azureAcs', acsUser));
  })
  .redirectPath('/');

everyauth
  .openid
    .myHostname('http://local.host:3000')
    .findOrCreateUser( function (session, userMetadata) {
      return usersByOpenId[userMetadata.claimedIdentifier] ||
        (usersByOpenId[userMetadata.claimedIdentifier] = addUser('openid', userMetadata));
    })
    .redirectPath('/');

everyauth
  .facebook
    .appId(conf.fb.appId)
    .appSecret(conf.fb.appSecret)
    .findOrCreateUser( function (session, accessToken, accessTokenExtra, fbUserMetadata) {
      return usersByFbId[fbUserMetadata.id] ||
        (usersByFbId[fbUserMetadata.id] = addUser('facebook', fbUserMetadata));
    })
    .redirectPath('/');

everyauth
  .twitter
    .consumerKey(conf.twit.consumerKey)
    .consumerSecret(conf.twit.consumerSecret)
    .findOrCreateUser( function (sess, accessToken, accessSecret, twitUser) {
      return usersByTwitId[twitUser.id] || (usersByTwitId[twitUser.id] = addUser('twitter', twitUser));
    })
    .redirectPath('/');

everyauth
  .password
    .loginWith('email')
    .getLoginPath('/login')
    .postLoginPath('/login')
    .loginView('login.jade')
//    .loginLocals({
//      title: 'Login'
//    })
//    .loginLocals(function (req, res) {
//      return {
//        title: 'Login'
//      }
//    })
    .loginLocals( function (req, res, done) {
      setTimeout( function () {
        done(null, {
          title: 'Async login'
        });
      }, 200);
    })
    .authenticate( function (login, password) {
      var errors = [];
      if (!login) errors.push('Missing login');
      if (!password) errors.push('Missing password');
      if (errors.length) return errors;
      var user = usersByLogin[login];
      if (!user) return ['Login failed'];
      if (user.password !== password) return ['Login failed'];
      return user;
    })

    .getRegisterPath('/register')
    .postRegisterPath('/register')
    .registerView('register.jade')
//    .registerLocals({
//      title: 'Register'
//    })
//    .registerLocals(function (req, res) {
//      return {
//        title: 'Sync Register'
//      }
//    })
    .registerLocals( function (req, res, done) {
      setTimeout( function () {
        done(null, {
          title: 'Async Register'
        });
      }, 200);
    })
    .validateRegistration( function (newUserAttrs, errors) {
      var login = newUserAttrs.login;
      if (usersByLogin[login]) errors.push('Login already taken');
      return errors;
    })
    .registerUser( function (newUserAttrs) {
      var login = newUserAttrs[this.loginKey()];
      return usersByLogin[login] = addUser(newUserAttrs);
    })

    .loginSuccessRedirect('/')
    .registerSuccessRedirect('/');

everyauth.github
  .appId(conf.github.appId)
  .appSecret(conf.github.appSecret)
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, ghUser) {
      return usersByGhId[ghUser.id] || (usersByGhId[ghUser.id] = addUser('github', ghUser));
  })
  .redirectPath('/');

everyauth.instagram
  .appId(conf.instagram.clientId)
  .appSecret(conf.instagram.clientSecret)
  .scope('basic')
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, hipster) {
      return usersByInstagramId[hipster.id] || (usersByInstagramId[hipster.id] = addUser('instagram', hipster));
  })
  .redirectPath('/');

everyauth.foursquare
  .appId(conf.foursquare.clientId)
  .appSecret(conf.foursquare.clientSecret)
  .findOrCreateUser( function (sess, accessTok, accessTokExtra, addict) {
      return usersByFoursquareId[addict.id] || (usersByFoursquareId[addict.id] = addUser('foursquare', addict));
  })
  .redirectPath('/');

everyauth.gowalla
  .appId(conf.gowalla.apiKey)
  .appSecret(conf.gowalla.apiSecret)
  .moduleErrback( function(err) {
    console.log("moduleErrback for Gowalla", err);
  })
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, loser) {
    return usersByGowallaId[loser.url] || (usersByGowallaId[loser.url] = addUser('gowalla', loser));
  })
  .redirectPath('/');

everyauth.linkedin
  .consumerKey(conf.linkedin.apiKey)
  .consumerSecret(conf.linkedin.apiSecret)
  .findOrCreateUser( function (sess, accessToken, accessSecret, linkedinUser) {
    return usersByLinkedinId[linkedinUser.id] || (usersByLinkedinId[linkedinUser.id] = addUser('linkedin', linkedinUser));
  })
  .redirectPath('/');

everyauth.google
  .appId(conf.google.clientId)
  .appSecret(conf.google.clientSecret)
  .scope('https://www.googleapis.com/auth/userinfo.profile https://www.google.com/m8/feeds/')
  .findOrCreateUser( function (sess, accessToken, extra, googleUser) {
    googleUser.refreshToken = extra.refresh_token;
    googleUser.expiresIn = extra.expires_in;
    return usersByGoogleId[googleUser.id] || (usersByGoogleId[googleUser.id] = addUser('google', googleUser));
  })
  .redirectPath('/');

everyauth.angellist
  .appId(conf.angellist.clientId)
  .appSecret(conf.angellist.clientSecret)
  .findOrCreateUser( function (sess, accessToken, extra, angellistUser) {
    angellistUser.refreshToken = extra.refresh_token;
    angellistUser.expiresIn = extra.expires_in;
    return usersByAngelListId[angellistUser.id] || (usersByAngelListId[angellistUser.id] = addUser('angellist', angellistUser));
  })
  .redirectPath('/');

everyauth.yahoo
  .consumerKey(conf.yahoo.consumerKey)
  .consumerSecret(conf.yahoo.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessSecret, yahooUser) {
    return usersByYahooId[yahooUser.id] || (usersByYahooId[yahooUser.id] = addUser('yahoo', yahooUser));
  })
  .redirectPath('/');

everyauth.googlehybrid
  .myHostname('http://local.host:3000')
  .consumerKey(conf.googlehybrid.consumerKey)
  .consumerSecret(conf.googlehybrid.consumerSecret)
  .scope(['http://docs.google.com/feeds/','http://spreadsheets.google.com/feeds/'])
  .findOrCreateUser( function(session, userAttributes) {
    return usersByGoogleHybridId[userAttributes.claimedIdentifier] || (usersByGoogleHybridId[userAttributes.claimedIdentifier] = addUser('googlehybrid', userAttributes));
  })
  .redirectPath('/');

everyauth.readability
  .consumerKey(conf.readability.consumerKey)
  .consumerSecret(conf.readability.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessSecret, reader) {
      return usersByReadabilityId[reader.username] || (usersByReadabilityId[reader.username] = addUser('readability', reader));
  })
  .redirectPath('/');

everyauth
  .dropbox
    .consumerKey(conf.dropbox.consumerKey)
    .consumerSecret(conf.dropbox.consumerSecret)
    .findOrCreateUser( function (sess, accessToken, accessSecret, dropboxUserMetadata) {
      return usersByDropboxId[dropboxUserMetadata.uid] ||
        (usersByDropboxId[dropboxUserMetadata.uid] = addUser('dropbox', dropboxUserMetadata));
    })
    .redirectPath('/')

everyauth.vimeo
    .consumerKey(conf.vimeo.consumerKey)
    .consumerSecret(conf.vimeo.consumerSecret)
    .findOrCreateUser( function (sess, accessToken, accessSecret, vimeoUser) {
        return usersByVimeoId[vimeoUser.id] ||
            (usersByVimeoId[vimeoUser.id] = vimeoUser);
    })
    .redirectPath('/')

everyauth.justintv
  .consumerKey(conf.justintv.consumerKey)
  .consumerSecret(conf.justintv.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessSecret, justintvUser) {
    return usersByJustintvId[justintvUser.id] ||
      (usersByJustintvId[justintvUser.id] = addUser('justintv', justintvUser));
  })
  .redirectPath('/')

everyauth['37signals']
  .appId(conf['_37signals'].clientId)
  .appSecret(conf['_37signals'].clientSecret)
  .findOrCreateUser( function (sess, accessToken, accessSecret, _37signalsUser) {
    return usersBy37signalsId[_37signalsUser.id] ||
      (usersBy37signalsId[_37signalsUser.identity.id] = addUser('37signals', _37signalsUser));
  })
  .redirectPath('/')

everyauth.tumblr
  .consumerKey(conf.tumblr.consumerKey)
  .consumerSecret(conf.tumblr.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessSecret, tumblrUser) {
    return usersByTumblrName[tumblrUser.name] ||
      (usersByTumblrName[tumblrUser.name] = addUser('tumblr', tumblrUser));
  })
  .redirectPath('/');

everyauth.box
  .apiKey(conf.box.apiKey)
  .findOrCreateUser( function (sess, authToken, boxUser) {
    return usersByBoxId[boxUser.user_id] ||
      (usersByDropboxId[boxUser.user_id] = addUser('box', boxUser));
  })
  .redirectPath('/');

everyauth.dwolla
  .appId(conf.dwolla.clientId)
  .appSecret(conf.dwolla.clientSecret)
  .scope('accountinfofull')
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, dwollaUser) {
    return usersByDwollaId[dwollaUser.id] || (usersByDwollaId[dwollaUser.id] = addUser('dwolla', dwollaUser));
  })
  .redirectPath('/');

everyauth.vkontakte
  .appId(conf.vkontakte.appId)
  .appSecret(conf.vkontakte.appSecret)
  .findOrCreateUser( function (session, accessToken, accessTokenExtra, vkUserMetadata) {
    return usersByVkId[vkUserMetadata.uid] ||
      (usersByVkId[vkUserMetadata.uid] = addUser('vkontakte', vkUserMetadata));
  })
  .redirectPath('/');

everyauth.mailru
  .appId(conf.mailru.appId)
  .appSecret(conf.mailru.appSecret)
  .findOrCreateUser( function (session, accessToken, accessTokenExtra, mlUserMetadata) {
    return usersMailruId[mlUserMetadata.uid] ||
      (usersMailruId[mlUserMetadata.uid] = addUser('mailru', mlUserMetadata));
  })
  .redirectPath('/');

everyauth.skyrock
  .consumerKey(conf.skyrock.consumerKey)
  .consumerSecret(conf.skyrock.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, skyrockUser) {
    return usersBySkyrockId[skyrockUser.id_user] || (usersBySkyrockId[skyrockUser.id_user] = addUser('skyrock', skyrockUser));
  })
  .redirectPath('/');

everyauth.evernote
  .oauthHost(conf.evernote.oauthHost)
  .consumerKey(conf.evernote.consumerKey)
  .consumerSecret(conf.evernote.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, enUserMetadata) {
    return usersByEvernoteId[enUserMetadata.userId] || (usersByEvernoteId[enUserMetadata.userId] = addUser('evernote', enUserMetadata));
  })
  .redirectPath('/');

everyauth.tripit
  .consumerKey(conf.tripit.consumerKey)
  .consumerSecret(conf.tripit.consumerSecret)
  .findOrCreateUser( function (sess, accessToken, accessTokenExtra, tripitProfile) {
    var userId = tripitProfile['@attributes'].ref;
    return usersByTripIt[userId] || (usersByTripIt[userId] = addUser('tripit', tripitProfile));
  })
  .redirectPath('/');

everyauth['500px']
  .consumerKey(conf._500px.consumerKey)
  .consumerSecret(conf._500px.consumerSecret)
  .findOrCreateUser(function(sess, accessToken, accessSecret, user) {
    return usersBy500pxId[user.id] || (usersBy500pxId[user.id] = addUser('500px', user));
  })
  .redirectPath('/');

everyauth.mendeley
  .consumerKey(conf.mendeley.consumerKey)
  .consumerSecret(conf.mendeley.consumerSecret)
  .findOrCreateUser(function(sess, accessToken, accessSecret, user) {
    return usersByMendeleyId[user.main.profile_id] || (usersByMendeleyId[user.main.profile_id] = addUser('mendeley', user));
  })
  .redirectPath('/');

everyauth
  .soundcloud
    .appId(conf.soundcloud.appId)
    .appSecret(conf.soundcloud.appSecret)
    .findOrCreateUser( function (sess, accessToken, accessTokenExtra, soundcloudUser) {
      return usersBySoundCloudId[soundcloudUser.id] || (usersBySoundCloudId[soundcloudUser.id] = addUser('soundcloud', soundcloudUser));
    })
    .redirectPath('/');

everyauth
  .mixi
    .appId(conf.mixi.consumerKey)
    .appSecret(conf.mixi.consumerSecret)
    .scope(conf.mixi.scope)
    .display('pc')
    .findOrCreateUser( function (session, accessToken, accessTokenExtra, mixiUserMetadata) {
      return usersByFbId[mixiUserMetadata.id] ||
        (usersByFbId[mixiUserMetadata.id] = addUser('mixi', mixiUserMetadata));
    })
    .redirectPath('/');

everyauth
  .mailchimp
    .appId(conf.mailchimp.appId)
    .appSecret(conf.mailchimp.appSecret)
    .myHostname(process.env.HOSTNAME || "http://127.0.0.1:3000")//MC requires 127.0.0.1 for dev
    .findOrCreateUser( function (session, accessToken, accessTokenExtra, mailchimpUser){
      return usersByMailchimpId[mailchimpUser.id] ||
        (usersByMailchimpId[mailchimpUser.user_id] = addUser('mailchimp', mailchimpUser));
    })
    .redirectPath("/");

var app = express();
app.use(express.static(__dirname + '/public'))
  .use(express.favicon())
  .use(express.bodyParser())
  .use(express.cookieParser('htuayreve'))
  .use(express.session())
  .use(everyauth.middleware(app));

app.configure( function () {
  app.set('view engine', 'jade');
  app.set('views', everyauthRoot + '/example/views');
});

app.get('/', function (req, res) {
  res.render('home');
});

app.listen(3000);

console.log('Go to http://local.host:3000');

module.exports = app; 
```

**home.jade**文件

```
html
  head
    link(rel='stylesheet', href='style.css')
  title
    Clicker
  body(bgcolor="#a52e42")
    div(align="center")
      .main
        .banner
          img(style='float:left', src='temple_logo.png', width='120px')
          .header
            h2 Welcome to the clicker app
          div(style="clear:left")
        - if (!everyauth.loggedIn)
          #register.button(style='float:right')
            a(href='/register') Register
          #password-login.button(style='float:right')
            a(href='/login', style='border: 0px') Login
          #fb-login.button(style='float:right')
            a.fb_button_medium(href='/auth/facebook')
              span#fb_login_text.fb_button_text
                img(style='border: 0px', src='facebook.jpeg',width='150px', height='20px')
          #twitter-login.button(style='float:right')
            a(href='/auth/twitter', style='border: 0px')
              img(style='border: 0px', src='https://si0.twimg.com/images/dev/buttons/sign-in-with-twitter-l.png',width='150px',height='20px')
          div(style="clear:right")
          #content(align="left")

        - else
          - if (everyauth.facebook)
            h3 Facebook User Data
            p= JSON.stringify(everyauth.facebook.user)
          - if (everyauth.twitter)
            h3 Twitter User Data
            p= JSON.stringify(everyauth.twitter.user)
          h3
            a(href='/logout') Logout 
```

我的问题是我没有将everyauth 变量传递给jade 文件。那它怎么能访问它。我的意思是这段代码运行良好。但为什么会这样。我还没有将everyauth 变量传递给它。

我试图在不同的应用程序中做同样的事情，即集成everyauth。但它显示为everyauth 没有在jade 文件中定义。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:04:59.777

看起来 everyauth 中间件使用[dynamicHelpers](https://github.com/bnoguchi/everyauth/blob/master/index.js#L56)在每个请求中设置局部变量（[那里有](http://dailyjs.com/2011/01/03/node-tutorial-8/)关于它们的好文章）。但请注意，[快速迁移指南（从 2.x 到 3.x）](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)说你不应该再使用它们了。

visionmedia 例如提供了这个片段（discution [there](https://github.com/visionmedia/express/issues/1177)）：

```
app.use(require('connect-flash')());
// Expose the flash function to the view layer
app.use(function(req, res, next) {
    res.locals.flash = function() { return req.flash() };
    next();
}) 
```

# android - Android 解析 XML 以获取节点值

> ID：14062419
> 
> 赞同：1
> 
> 时间：2012-12-27T23:00:25.623
> 
> 标签：android, xml, gdata

所以，我写了一些小东西来解析 Youtube 用户的提要。

问题是当我调用`getNodeValue()`null 时返回。为什么是这样？任何想法或替代方法表示赞赏，谢谢。

这是我目前正在做的事情的一个片段：

```
try {

    Document d = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse("https://gdata.youtube.com/feeds/api/users/estudiosabiertostv/uploads");

    NodeList entries = d.getElementsByTagName("entry");

    for(int i = 0; i < entries.getLength(); i++) {

        NodeList children = entries.item(i).getChildNodes();
        YoutubeVideo video = new YoutubeVideo();

        for(int j = 0; j < children.getLength(); j++) {

            Node child = children.item(j);

            if(child.getNodeName().equals("title")) {

                video.title = child.getNodeValue();
                break;
            }
        }
        videos.add(video);
    }
}
catch (Exception e) {

    e.printStackTrace();
} 
```

这是我从中获取 XML 的 url：

```
https://gdata.youtube.com/feeds/api/users/estudiosabiertostv/uploads 
```

这是一个条目的片段，我正在尝试获取标题

```
<entry>
    <id>http://gdata.youtube.com/feeds/api/videos/oDbOmTY3gDw</id>
    <published>2012-12-17T08:14:12.000Z</published>
    <category scheme="http://schemas.google.com/g/2005#kind" term="http://gdata.youtube.com/schemas/2007#video"/>
    <title type="text">SEAS - Grupo San Valero - Crea tu propia Navidad (2012)</title>

    <content type="text">Felicitación de Navidad de SEAS, Estudios Abiertos del Grupo San Valero</content>
    <link rel="alternate" type="text/html" href="http://www.youtube.com/watch?v=oDbOmTY3gDw&feature=youtube_gdata"/>
    <author>
        <name>estudiosabiertostv</name>
        <uri>http://gdata.youtube.com/feeds/api/users/estudiosabiertostv</uri>
    </author>
</entry> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T07:28:11.877

标题节点又应该有一个子节点——一个文本节点，那个节点应该包含实际的文本。

另外，请注意碎片：那里可能有几个相邻的文本节点，如下所述：[http ://www.drillio.com/en/software-development/java/fragmented-xml-text-nodes/](http://www.drillio.com/en/software-development/java/fragmented-xml-text-nodes/)

# javascript - Google Charts - 如何将断轴标签分成两行？（多个 X 轴）

> ID：14062420
> 
> 赞同：12
> 
> 时间：2012-12-27T23:00:30.597
> 
> 标签：javascript, svg, line-breaks, google-visualization

我有我的谷歌折线图，看起来像这样：

```
10|                        .
  |            .....----''' ''--.
09| .-----'''''                  ''-
  |                                 '.
08|                                   \
  |                                    '.
07|                                      '.
  |________________________________________________________
   2012/12/27 12:01    2012/12/26 12:22    2012/12/25 11:33 
```

我希望它看起来像这样（注意 X 轴标签）：

```
10|                        .
  |            .....----''' ''-.
09| .-----'''''                 \
  |                              '.
08|                                \
  |                                 '.
07|                                   '.
  |_______________________________________________
   2012/12/27          2012/12/26       2012/12/25
   12:01               12:22            11:33 
```

我尝试添加`<br>`, `\n`，`\r`但没有运气。

我查看了文档，发现最接近的是，`hAxis.maxTextLines`但没有`minTextLines`选项，所以我不知道如何强制它。我怎样才能做到这一点？

* * *

**更新**

通过链接到谷歌创建图表时，这似乎是可能的。您只需要`chxt`使用额外的 x 值设置变量（但是您需要更多的 x 轴）`chxt=y,x,x`：. 然后对于每个 x 轴，您设置`chxl`变量的标签。`chxl=1:|2012/12/27|2012/12/26|2012/12/25|2:|12:01|12:22|11:33`

例如：

[**http://chart.apis.google.com/chart?chxl=1:|2012/12/27|2012/12/26|2012/12/25|2:|12:01|12:22|11: 33&chxr=0,7,10&chxt=y,x,x&chs=360x240&cht=bvg&chco=000000&chd=t1:9,10,7&cht=lc&chds=7,10**](http://chart.apis.google.com/chart?chxl=1:%7C2012/12/27%7C2012/12/26%7C2012/12/25%7C2:%7C12:01%7C12:22%7C11:33&chxr=0,7,10&chxt=y,x,x&chs=360x240&cht=bvg&chco=000000&chd=t1:9,10,7&cht=lc&chds=7,10)

但我创建图表的方式是通过 JavaScript。这边走：

```
google.setOnLoadCallback(function(){
  var data = new google.visualization.DataTable();
  data.addColumn('string', 'Date');
  data.addColumn('number', 'Count');

  //Populate data

  new google.visualization.LineChart(document.getElementById('chart')).
    draw(data, {curveType: 'function',
                chartArea: {left: 70, top: 50, width: '100%', height: '85%'},
                width: 950, height: 800,
                interpolateNulls: true,
                pointSize: 5,
                legend: {position: 'none'},
                vAxis: {title: 'Count', viewWindow: {min: 7, max: 10}},
                hAxis: {title: 'Date', viewWindow: {min: 0, max: 3}}
               });
}); 
```

所以我需要弄清楚如何使用这种格式/API来做到这一点。我怎么能这样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-03-06T20:03:06.067

我用了：

> hAxis: {格式:'MMM dd, yyy \nHH:mm'}

在我的选项数组中，Google API 将其格式化为

```
Mar 05, 2014
   16:00 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-31T20:41:32.940

## 最终更新

**工作示例： http:** [//jsbin.com/eokec/1/](http://jsbin.com/eyokec/1/)（[编辑版本](http://jsbin.com/eyokec/1/edit)）

好吧，像往常一样，一些挖掘产生了一些可能的解决方案。我只是成功地让一个人工作，但至少你知道在这一点上是可能的。来自[Insert Links into Google Charts api data的](https://stackoverflow.com/questions/12701772/insert-links-into-google-charts-api-data/12702920#12702920)[这个答案？](https://stackoverflow.com/a/12702920/1085891)提供了上面的工作解决方案。

```
 // Note: You will probably need to tweak these deltas
  // for your labels to position nicely.
  var xDelta = 35;
  var yDelta = 13;
  var years = ['2012/12/27|12:01','2012/12/26|12:22','2012/12/25|11:33','2012/12/24|11:33'];
  $('text').each(function(i, el) {
      if (years.indexOf(el.textContent) != -1) {
          var g = el.parentNode;
          var x = el.getAttribute('x');
          var y = el.getAttribute('y');
          var width = el.getAttribute('width') || 70;
          var height = el.getAttribute('height') || 35;

          // A "ForeignObject" tag is how you can inject HTML into an SVG document.
         var fo = document.createElementNS("http://www.w3.org/2000/svg", "foreignObject");
          fo.setAttribute('x', x - xDelta);
          fo.setAttribute('y', y - yDelta);
          fo.setAttribute('height', height);
          fo.setAttribute('width', width);

          var body = document.createElementNS("http://www.w3.org/1999/xhtml", "BODY");
          var p = document.createElement("P");

          p.setAttribute("style", "font-size:.8em; font-family:Arial;text-align:center;color:#555;");
          p.innerHTML = el.textContent.replace('|','<br />');

          body.appendChild(p);
          fo.appendChild(body);

          // Remove the original SVG text and replace it with the HTML.
          g.removeChild(el);
          g.appendChild(fo);
      }
  }); 
```

上面的代码可以工作，但可以理解的是，它远非理想。这只是您可以使用的概念证明。我看到了其他关于更新 SVG 文件的类似问题，但我无法让它们工作。上面的代码可能能够更新`<text>`依赖于`<tspan>`多线支持的 SVG 节点。我可能会尝试在某个时候让它发挥作用。

### 测试

*   铬 23.0.1271.97 米：通过
*   Firefox 17.0.1：通过（需要更高的高度）
*   IE9：失败（不知道为什么）

### 参考

*   [使用 ECMAScript (Javascript) 和 DOM 操作 SVG 文档](http://www.carto.net/svg/manipulating_svg_with_dom_ecmascript/)
*   [http://raphaeljs.com/](http://raphaeljs.com/)
*   jQuery SVG： http: [//keith-wood.name/svg.html](http://keith-wood.name/svg.html)

* * *

## 更新 0

此外，Google Image Charts API 现在似乎已被弃用。

> 重要提示：Google Chart Tools 的 Image Charts 部分已于2012 年 4 月 20 日[正式弃用](http://googledevelopers.blogspot.com/2012/04/changes-to-deprecation-policies-and-api.html)。它将根据我们的[弃用政策](https://developers.google.com/chart/terms)继续工作。

因此，尽管您可以创建图表作为您想要的示例，但功能可能没有被带到 Google 图表工具中。

也就是说，我确实找到了这个[图表向导](https://developers.google.com/chart/image/docs/chart_wizard)，它可以帮助创建必要的 JavaScript 以将图表嵌入可视化 API。

![谷歌图表图像示例](../Images/1ebc21aa5f0de1bbb2213c2107007751.png)

* * *

## 原来的

~~看来不可能。~~您可以使用[hAxis.minTextSpacing](https://developers.google.com/chart/interactive/docs/gallery/linechart?hl=en)强制它。它可以工作，但这肯定不是该配置选项的目的。[您也可以拉出标签并通过 HTML 处理它们](http://www.mail-archive.com/google-chart-api@googlegroups.com/msg01325.html)，但我知道这也不理想。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-14T20:14:12.020

`\n`在需要的地方放一个换行符，例如

```
var data = [
    ["Days", "Pressure"],
    ["Mon\n16", 20],
    ["Tue\n17", 16],
    ["Wen\n18", 10],
    ["Thr\n19", 16],
    ["Fri\n20", 17]
]; 
```

[结果示例](https://i.stack.imgur.com/I7IvM.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-19T03:36:05.100

尝试使用“\\n”而不是“\n”，它对我来说工作正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-13T16:20:13.470

在我们的例子中，它也是 PHP 单引号和双引号：

坏的`date( 'Y\nM' )`

更好的`date( "Y\nM" )`

# c#-4.0 - System.Security.SecurityException：尝试在 Silverlight 5 应用程序中使用 WCF 数据服务时出现安全错误

> ID：14062423
> 
> 赞同：1
> 
> 时间：2012-12-27T23:00:46.660
> 
> 标签：c#-4.0, .net-4.0, wcf-data-services, odata, silverlight-5.0

我正在尝试在 Silverlight 5 应用程序/.NET 4.0 应用程序中使用 WCF 数据服务。当我手动查询服务时，我可以在 Web 浏览器中看到作为 Atom 馈送的数据。

但是，当我尝试通过标准方法查询数据时，出现以下错误：

> {System.Security.SecurityException：安全错误。在 System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult) 在 System.Data.Services.Http.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult) 在 System.Data.Services.Client.QueryResult.AsyncEndGetResponse(IAsyncResult asyncResult)}

**内部异常为空。**所以目前还没有有意义的信息。

## 我的代码

```
public partial class ProjectWindow : ChildWindow
{
XYZEntitis.XYZEntitis db = new XYZEntitis.XYZEntitis(new Uri("http://google.com/wcfdataservice1.svc/"));

    DataServiceCollection<XYZEntitis.Label> dscCats = new DataServiceCollection<XYZEntitis.Label>();
    CollectionViewSource customerAddressViewSource;
    ObservableCollection<XYZEntitis.Label> labelsBindingCollection = new ObservableCollection<XYZEntitis.Label>();
public ProjectWindow()
    {
        InitializeComponent();
        btnBack.IsEnabled = false;
        //Load Project categories
        BindProjectCategories();
    }
public void BindProjectCategories()
        {
            #region Code
            //#############################################
            //Approach # 01 : Raises Security Exception
            //#############################################
            //DataServiceQuery<XYZEntitis.Label> query = db.Labels;
            //query.BeginExecute(
            //    s =>
            //    {
            //        var state = s.AsyncState as DataServiceQuery<XYZEntitis.Label>;
            //        var data = new ObservableCollection<XYZEntitis.Label>();
            //        foreach (var entity in state.EndExecute(s))
            //            data.Add(entity);
            //        cbCategoryName.ItemsSource = data;
            //    }, query);
            #endregion
            //#############################################
            //Approach No # 2 : 0 Records are returned
            //#############################################
            var cats = from cat in db.Labels select cat;
            //cats.ToList();
            dscCats.LoadCompleted += this.dscCats_LoadCompleted;
            dscCats.LoadAsync(cats);

            //#############################################
            //Approach # 3 : Security Exception
            //#############################################
            //var query = from cat in db.Labels select cat;
            //((DataServiceQuery<XYZEntitis.Label>)query).BeginExecute(OnCategoriesFecthComplete, query);
        }
private void OnCategoriesFecthComplete(IAsyncResult ar)
    {
        var query = ar.AsyncState as DataServiceQuery<XYZEntitis.Label>;

        // Get the response of the query.
        var response = query.EndExecute(ar);
        foreach (XYZEntitis.Label label in response)
        {
            labelsBindingCollection.Add(label);
        }
        cbCategoryName.ItemsSource = labelsBindingCollection;
    }
private void dscCats_LoadCompleted(object sender, LoadCompletedEventArgs e)
    {
        if (dscCats.Continuation != null)
        {
            dscCats.LoadNextPartialSetAsync();
        }
        else
        {

            cbCategoryName.ItemsSource = dscCats;
            #region code

            //var data = (DataServiceCollection<XYZEntitis.Label>)sender;
            //cbCategoryName.ItemsSource = data;
            //cbCategoryName.DisplayMemberPath = "Name";   

            //customerAddressViewSource =
            //       (CollectionViewSource)this.Resources["customerAddressViewSource"];
            //customerAddressViewSource.Source = dscCats;
            #endregion
        }

    } 
```

}

## 完整的堆栈跟踪（堆栈跟踪 1）：

> System.InvalidOperationException 未被用户代码处理 Message=处理此请求时发生错误。StackTrace：在 System.Data.Services.Client.BaseAsyncResult.EndExecute[T]（对象源，字符串方法，IAsyncResult asyncResult）在 System.Data.Services.Client.QueryResult.EndExecute[TElement]（对象源，IAsyncResult asyncResult）在System.Data.Services.Client.DataServiceRequest.EndExecute[TElement](Object source, DataServiceContext context, IAsyncResult asyncResult) at System.Data.Services.Client.DataServiceQuery`1.EndExecute(IAsyncResult asyncResult) at ThreatModeler.Silverlight.ProjectWindow.OnCategoriesFecthComplete (IAsyncResult ar) 在 System.Data.Services.Client.BaseAsyncResult.HandleCompleted() 在 System.Data.Services.Client.QueryResult。*DisplayClass1.b* _0(IAsyncResult asyncResult) 在 System.Net.Browser.ClientHttpWebRequest.<>c_ *DisplayClass1a.b*_18(Object state2) at System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(Object state) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem .ExecuteWorkItem() 在 System.Threading.ThreadPoolWorkQueue.Dispatch() 在 System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() InnerException: System.Security.SecurityException 消息=安全错误。StackTrace：在 System.Data.Services.Http.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult) 在 System.Data.Services.Client 的 System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)。

## 完整的堆栈跟踪（堆栈跟踪 #02）

> {System.InvalidOperationException：处理此请求时发生错误。---> System.Security.SecurityException：安全错误。在 System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult) 在 System.Data.Services.Http.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult) 在 System.Data.Services.Client.QueryResult.AsyncEndGetResponse(IAsyncResult asyncResult) --- 结束内部异常堆栈跟踪 --- 在 System.Data.Services.Client.QueryResult.EndExecute[TElement](Object source, String method, IAsyncResult asyncResult) at System.Data.Services.Client.QueryResult.EndExecute[T](Object源，IAsyncResult asyncResult）在 System.Data.Services.Client.DataServiceRequest.EndExecute[TElement]（对象源，DataServiceContext 上下文，*System.Data.Services.Client.QueryResult.AsyncEndGetResponse(IAsyncResult asyncResult) 在 System.Data.Services.Client.BaseAsyncResult 的 System.Data.Services.Client.BaseAsyncResult.HandleCompleted() 0(IAsyncResult s)。<>c* _DisplayClass1 .b_ *0(IAsyncResult asyncResult) 在 System.Net.Browser.ClientHttpWebRequest.<>c*_DisplayClass1a.b__18(Object state2) at System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(Object state) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.QueueUserWorkItemCallback.System.Threading .IThreadPoolWorkItem.ExecuteWorkItem() 在 System.Threading.ThreadPoolWorkQueue.Dispatch() 在 System.Threading._ThreadPoolWaitCallback.PerformWaitCallback()}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:18:05.473

这对我有用。在我的服务

1.  选择已安装模板下的数据，然后选择 XML 文件。将文件命名为 clientaccesspolicy.xml。
2.  为文件输入以下内容：

> ```
> <?xml version="1.0" encoding="utf-8"?>
> <access-policy>
>   <cross-domain-access>
>     <policy>
>       <allow-from http-request-headers="*">
>         <domain uri="http://*" />
>         <domain uri="https://*" />
>       </allow-from>
>       <grant-to>
>         <resource path="/" include-subpaths="true"/>
>       </grant-to>
>     </policy>
>   </cross-domain-access>
> </access-policy> 
> ```

# c# - WPF 部署问题

> ID：14062426
> 
> 赞同：0
> 
> 时间：2012-12-27T23:01:00.763
> 
> 标签：c#, wpf

我有一个使用 Windows 媒体元素播放音乐的应用程序。播放音乐的代码如下：

```
 public void PlaySound()
    {

        string solutionPath = Directory.GetParent(Assembly.GetExecutingAssembly().Location).Parent.Parent.Parent.FullName;
        string path = Path.Combine(solutionPath, "FolderNameWithinSolution", myMusic.wav);
        mediaElement.LoadedBehavior = MediaState.Manual;
        mediaElement.Stop();
        mediaElement.Source = new Uri(path, UriKind.RelativeOrAbsolute);
        mediaElement.Volume = 0.2;
        mediaElement.Play(); 

    } 
```

myMusic.wav 是保存在 FolderNameWithinSolution 中的文件。这设置为内容并始终复制。在我部署它之前一切正常，然后应用程序就不会播放音乐。

我检查了应用程序文件，文件夹中出现了音乐，但音乐显示为 myMusic.wav.deploy。

有人可以帮助我在哪里设置不正确。我也尝试重命名应用程序文件中的文件以删除 .deploy 但这仍然不起作用，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T19:48:25.073

`.Parent.Parent.Parent.FullName``project\bin\debug`意味着当您从目录运行程序时，您可能正在与 .SLN 文件相同的位置寻找 .WAV 文件。这不是 .WAV 文件在部署后所在的位置。此外，我认为`Copy Always`应该将 .WAV 文件复制到可执行文件所在的同一目录中。由于您使用可执行文件作为导航的起点来定位声音文件，因此您需要确保它位于在开发环境和部署之后，相对于可执行文件在完全相同的位置。

基本上，当您部署时，您的文件正在移动到其他地方。确保在构建配置和安装程序配置中都指定了它的位置。

# android - 如何获取外接显示器的本机屏幕分辨率

> ID：14062427
> 
> 赞同：4
> 
> 时间：2012-12-27T23:01:02.483
> 
> 标签：android, screen-resolution

我正在使用午夜流媒体盒（Android 4.0.4）和具有 1080p 分辨率的外接显示器测试我的 android 应用程序。当我请求渲染视频的屏幕宽度和高度时，我得到的只有 1280x720 而不是 1920x1080。这是我使用的代码。

```
DisplayMetrics dm = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(dm);
int screenWidth = dm.widthPixels;
int screenHeight = dm.heightPixels; 
```

顺便说一句，以下代码已添加到相应的活动中，以获得没有标题栏的全屏。

```
requestWindowFeature(Window.FEATURE_NO_TITLE);
getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                     WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

我很确定我的显示器的分辨率设置为 1080p。知道为什么 Android 只使用 720p 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T22:24:23.207

编辑 /system/build.props 文件后，我从午夜的 Android 流媒体盒中获得 1080p 分辨率。当然，我需要对文件系统具有 root 访问权限才能进行编辑。

将宽度和高度设置为 1920 和 1080，如下所示。

```
const.window.w=1920
const.window.h=1080 
```

然后注释掉以下行。

```
#ro.platform.has.1080scale=2 
```

请参阅以下帖子以获取更多详细信息。 [http://androidtvbox.us/topic/maximum-resolution-of-hdmi-output/#post-4253](http://androidtvbox.us/topic/maximum-resolution-of-hdmi-output/#post-4253)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:35:44.150

> 当我请求渲染视频的屏幕宽度和高度时，我得到的只有 1280x720 而不是 1920x1080。

那是因为您的手机（或任何“午夜流媒体盒”）将在外部显示器上显示 1280x720。

> 知道为什么 Android 只使用 720p 吗？

在 Android 3.0 和 Android 4.2 之间通过 HDMI 支持外部显示器的设备将执行以下两种操作之一：

1.  不提供任何方式让第三方应用程序投射到显示器上，或

2.  使用设备的原始分辨率，或接近它的东西

例如，将 WXGA800 平板电脑连接到支持 1080p 的显示器会产生 720p 的图像，因为 Android 会将系统栏的大小扩大到 80 像素，并将高于它的所有内容镜像到显示器。显示器的分辨率不是约束——设备的分辨率才是。

因此，720p 是完全合理的。

# php - 输入错误检查系统PHP的问题

> ID：14062433
> 
> 赞同：0
> 
> 时间：2012-12-27T23:01:33.770
> 
> 标签：php, object

我正在尝试使用 PHP 实现错误检查系统（字符太少、空白输入等......）。

现在，如果我留下空白标题，则会捕获错误，但不会显示消息。这是实际检查输入的第一部分（仅显示事件标题）

```
Class check_errors{

function create_event_errors($event_title){
    global $submit_error;
    if($event_title == ""){
        $field = "event_title";
        $submit_error->setError($field,"Title cannot be blank");
    }
    elseif(strlen($event_title) < 5){
        $field = "event_title";
        $submit_error->setError($field,"Title must be longer than 5 characters");
    }
    elseif(strlen($event_title) > 75){
        $field = "title";
        $submit_error->generalError($field,"Title must be less than 40 characters");
    }
} 
```

因此，在同一页面上，这是 display_errors 类

```
Class display_errors{
var $values = array();  //Holds submitted form field values
var $errors = array();  //Holds submitted form error messages

function setValue($field, $value){
     $this->values[$field] = $value;
  }

function setError($field, $errmsg){
    $this->errors[$field] = $errmsg; //if I echo this, the error message displays
    $this->num_errors = count($this->errors); //if I echo this, the # of errors displays
}

function value($field){
  if(array_key_exists($field,$this->values)){
     return htmlspecialchars(stripslashes($this->values[$field]));
  }else{
     return "";
  }
}   

 function error($field){    
     if(array_key_exists($field,$this->errors)){
        return $this->errors[$field];
     }else{
       return "";
     }
  }
} 
```

**现在讨论这个问题。当我尝试检查是否检测到错误时，它没有找到任何东西**

```
$check_errors->create_event_errors($event_title); //submit the input to be checked

echo $display_errors->num_errors; //this does not display the # of errors. It does when I echo from within the function in the class though

if($display_errors->num_errors == 0){
   //submit event
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:32:21.273

不要使用`var`，不要使用`global`和定义所有属性。还要考虑@harke 的指针以获得更好的代码设计。

```
class check_errors
{
    protected $errors;

    function __construct(display_errors $errors) {
        $this->errors = $errors;
    }

    function create_event_errors($event_title){
        if($event_title == ""){
            $field = "event_title";
            $this->errors->setError($field,"Title cannot be blank");
        }
        elseif(strlen($event_title) < 5){
            $field = "event_title";
            $this->errors->setError($field,"Title must be longer than 5 characters");
        }
        elseif(strlen($event_title) > 75){
            $field = "title";
            $this->errors->generalError($field,"Title must be less than 40 characters");
        }
    }
}

class display_errors
{
    protected $values = array();  //Holds submitted form field values
    protected $errors = array();  //Holds submitted form error messages
    public $num_errors = 0;

    function setValue($field, $value){
        $this->values[$field] = $value;
    }

    function setError($field, $errmsg){
        $this->errors[$field] = $errmsg; //if I echo this, the error message displays
        $this->num_errors = count($this->errors); //if I echo this, the # of errors displays
    }

    function value($field){
        if(array_key_exists($field,$this->values)){
            return htmlspecialchars(stripslashes($this->values[$field]));
        }else{
            return "";
        }
    }   

    function error($field){    
        if(array_key_exists($field,$this->errors)){
            return $this->errors[$field];
        }else{
            return "";
        }
    }
} 
```

运行代码

```
$display_errors = new display_errors();
$check_errors = new check_errors($display_errors);

$check_errors->create_event_errors($event_title); //submit the input to be checked

echo $display_errors->num_errors;

if($display_errors->num_errors == 0){
    //submit event
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:12:50.913

不知道这是否会给您带来任何麻烦：

```
$field == "title"; 
```

这个陈述和写作一样有用；

```
true or false; 
```

你的意思可能是：

```
$field = "title"; 
```

（单等号）

* * *

只是给你一些指示：

*   创建验证器类（参见：[*Interfaces ^(Docs)*](http://php.net/language.oop5.interfaces)）。
*   为错误集合创建一个类。
*   为验证和错误消息的复杂定义创建一个类。
*   允许堆叠多个最后一个，以便能够将许多验证的集合视为一个（参见：[*复合模式*](http://en.wikipedia.org/wiki/Composite_pattern)）。

完成后，您可以独立验证并决定如何处理结果。编写代码也更容易，因为你不能引入这么多的错误，即使你这样做了，这些也更容易修复。

还要保持具体的字段名独立于验证。

# android - Dalvik 字节码中的“抛出”和“异常注释”

> ID：14062434
> 
> 赞同：5
> 
> 时间：2012-12-27T23:01:36.287
> 
> 标签：android, dalvik, java-bytecode-asm, jvm-bytecode, jasmin

为什么生成字节码为

```
 .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/FileNotFoundException;
        }
 .end annotation 
```

而不是`.throws Ljava/io/FileNotFoundException`

如果一个方法`throws FileNotFoundException`在java代码的头文件中声明？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T00:02:34.440

简短的回答是 dex 格式中没有特定的“抛出”概念。当 java 类文件转换为 dex 格式时，会添加一个包含此信息的 Throws 注释。

稍微长一点的答案：

检查异常的概念只在编译时很重要，在运行时不重要。dalvik 虚拟机不知道也不关心你的方法会抛出什么异常。就它而言，一切都是未经检查的异常。是 java 编译器强制在 throws 子句中声明检查的异常。

因此，在 dex 文件中添加特定的“抛出”概念是没有意义的。相反，该信息是使用更通用的注释功能存储的。

听起来您正在使用 dex2jar 之类的东西将 dex 文件转换回一组类文件，然后在其上使用 jasmin。dex2jar 可能不会将 dex 文件中的 Throws 注释重新映射回类文件中的[Exception 属性](http://docs.oracle.com/javase/specs/jvms/se5.0/html/ClassFile.doc.html#3129)，尽管我没有专门检查是否是这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:20:38.063

> dalvik.annotation.Throws 出现在方法上
> 
> Throws 注释附加到每个声明为抛出一个或多个异常类型的方法。

在[这个页面](http://source.android.com/tech/dalvik/dex-format.html)的底部。

# nested - Mustache.php 中的嵌套标签

> ID：14062435
> 
> 赞同：0
> 
> 时间：2012-12-27T23:01:39.667
> 
> 标签：nested, mustache.php

我正在使用 Mustache for php 来呈现我的网页。我一直在[github](https://github.com/bobthecow/mustache.php/tree/dev)上的 dev-branch 中玩代码，发现了一些有趣的操作方法。例如，我知道可以通过为它们定义一个辅助函数来动态加载部分。然而，我似乎找不到的是一种像这样进行嵌套标签的方法：

```
{{article.{{page.name}}}} 
```

在某种辅助函数或高阶函数的帮助下，这是否可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:15:59.540

You can use Lambdas to achieve something similar. Quoting from [Mustache.php's wiki](https://github.com/bobthecow/mustache.php/wiki/Mustache-Tags):

> When the value is callable — such as an anonymous function — the callable will be invoked and passed the block of text.

So, in your mustache template, the following:

```
{{#article_field}}{{page.name}}{{/article_field}} 
```

With a View Class like this:

```
class View_Page {

    public $_article;

    public function article_field()
    {
        return function($string)
        {
            return $this->_article[$string];
        }
    }
} 
```

Will output the `article` field whose name resides in the `page.name` property's value.

Head over to [Mustache.php's official wiki](https://github.com/bobthecow/mustache.php/wiki/Mustache-Tags) to read more about Lambdas and callables.

# ios - #define 指令上的这个错误是什么？

> ID：14062441
> 
> 赞同：1
> 
> 时间：2012-12-27T23:02:03.090
> 
> 标签：ios, objective-c, c-preprocessor, directive

我在代码中有以下行：

```
#define INACTIVITYTIMEBEFOREBAITARROWDISPATCHED 60.0 
```

我在这条线上收到一个错误，上面写着，`Too many arguments to method call, expected 1, have 2`

我是否超过了最大长度？如果有，最大长度是多少？无论如何，实际的信息似乎很荒谬。

根据请求，这里是上下文：

```
#define VITALITYSECONDS 40.0
#define MINIMUMSCALEFACTOR 0.10
#define MINIMUMSPEED 2.0
#define INACTIVITYTIMEBEFOREBAITARROWDISPATCHED 60.0

#pragma mark - Angle and Distance Functions

-(float)normalizeAngle:(float)angle
{
   float answer;
   // Take an angle and return a value from -pi to pi
   // To do this, we first add pi, then divide by 2pi, then take fractional part, then multiply by 2pi then subtract pi.
   answer = angle + M_PI;
   answer = answer/(2*M_PI);
   answer = answer - floor(answer);
   answer = answer * 2 * M_PI;
   answer = answer - M_PI;
   return answer;
} 
```

为了完整起见，这是有问题的行：

```
[self helpText:@"Bait arrow dispatched due to %f seconds inactivity\n",INACTIVITYTIMEBEFOREBAITARROWDISPATCHED]; 
```

这是更正的版本：

```
[self helpText:[NSString stringWithFormat:@"Bait arrow dispatched due to %f seconds inactivity\n",INACTIVITYTIMEBEFOREBAITARROWDISPATCHED]]; 
```

这是该方法的声明：

```
-(void)helpText:(NSString *)text 
```

方法 helpText 只是在屏幕上显示内容以帮助测试人员的临时方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:14:52.307

*提示 1*：

在有问题的行上方，添加

```
#undef INACTIVITYTIMEBEFOREBAITARROWDISPATCHED 
```

这是以防万一您在其他地方以不同的方式定义该宏，现在由于双重定义而得到奇怪的结果。尽管我必须承认在这种情况下错误消息应该有所不同 - 我认为仍然值得一试。

*提示 2*：

如果不需要，不要对常量使用预编译器宏（定义）。在少数情况下，定义是有意义的，而给定的却不是其中之一。

用适当的静态常量标量替换所有这些定义；

例如

`static const double kInactivityTimeBeforeBaitArrowDispatched 60.0;`

这将带来类型安全、可读性好的代码和更少的头部划痕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:41:51.293

它不是定义的问题。这是方法的问题。

该方法是否包含 arg 列表？或者只是一个字符串。

因为看起来您正在尝试使用格式设置字符串。

试试这个

```
[self helpText:[NSString stringWithFormat:@"Bait arrow dispatched due to %f seconds inactivity\n",INACTIVITYTIMEBEFOREBAITARROWDISPATCHED]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:41:58.673

好吧，你传递了*2 个*参数`-helpText:`，我打赌它不是可变参数，所以它只需要一个参数。

看起来您正在尝试传递字符串格式和要放在格式说明符中的值。要从中生成字符串，您必须将参数传递给实际采用此类参数的方法，即`+[NSString stringWithFormat:]`：

```
NSString *text = [NSString stringWithFormat: @"Bait arrow dispatched due to %f seconds inactivity\n", INACTIVITYTIMEBEFOREBAITARROWDISPATCHED];
[self helpText: text]; 
```

# javascript - 将动态数据插入到 Javascript 数组中

> ID：14062444
> 
> 赞同：0
> 
> 时间：2012-12-27T23:02:26.610
> 
> 标签：javascript, jquery

当我设置 imArray 和 console.log() 时，控制台告诉我 members.[i1].friendId 的每个值都是值 0。我有大约 5 个值传递给 imArray。这是我第一次使用动态数组循环。因此，如果可以，请向我解释如何将这些数据正确输出到数组中。

```
$.getJSON("<?=base_url()?>index.php/regUserDash/chatBoxMembers", function(data) {
    var members = data.chatMembers;
    for(var i1 = 0; i1 < members.length; i1++) {
        var imArray = [members[i1].friendId];
        if(members[i1].activityStatus === 'Minimized') {
            function minimizedBox() {
                return '<span style="position: relative; left: 84px; font-family: Verdana; font-size: 8pt" class="clickForMessageBox">' + members[i1].firstname + ' ' + members[i1].lastname + '</span>&nbsp;&nbsp;&nbsp;';
            } $('#box1').append(minimizedBox());
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:10:54.917

在外面声明数组，然后你可以`push`在每个周期中输入数据：

```
var imArray = []; 

for(var i1 = 0; i1 < members.length; i1++) {
    //var imArray = [members[i1].friendId];
    imArray.push(members[i1].friendId);
    if(members[i1].activityStatus === 'Minimized') {
        function minimizedBox() {
            return '<span style="position: relative; left: 84px; font-family: Verdana; font-size: 8pt" class="clickForMessageBox">' + members[i1].firstname + ' ' + members[i1].lastname + '</span>&nbsp;&nbsp;&nbsp;';
        } $('#box1').append(minimizedBox());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:08:28.597

我认为您想将值附加到数组中：

```
var imArray = [];
for (var i1 = 0 ...
   imArray.append(members[i1].friendId]); 
```

使用您的代码，您`imArray`每次只需设置一个具有单个值的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:12:45.063

您的代码似乎将返回的数据放入屏幕上的可见数组中。如果这就是您正在做的事情，您可能希望使用[此链接](http://api.jquery.com/appendTo/)获取有关如何添加到 DOM 以使某些内容在屏幕上可见的更多信息。

这部分：

```
$('#box1').append(minimizedBox()); 
```

变成这样的东西：

```
$(minimizedBox()).appendTo('#box1'); 
```

它获取生成的 HTML 并将其放入框中。

# objective-c - 在 UITextView 中选择或标记文本而不使其成为第一响应者

> ID：14062447
> 
> 赞同：2
> 
> 时间：2012-12-27T23:02:47.157
> 
> 标签：objective-c, ios, ipad, uitextview, first-responder

这甚至可能吗？

我想在没有文本视图成为第一响应者的情况下选择/标记文本。我已经实现了搜索`UIPopoverController`，然后当它被`UIToolBar`“下一个”和“上一个”按钮关闭时，显示它允许我选择下一个或上一个结果，我看到正在选择文本，因为 UITextView 分别向下和向上滚动，但我没有看到任何选择颜色或实际选择的文本，只是白底黑字。

如果它是第一响应者，那么一切都正常，但这不是我想要实现的行为。

有什么提示吗？

寻求帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:27:44.493

如果你在 iOS 6 环境下工作，你可以使用`attributedText`if 属性`UITextView`。

如果您在 iOS 6 以下工作，请尝试使用[EGOTextView](https://github.com/enormego/EGOTextView)，它是富文本编辑的直接替代品，一年左右不支持它，所以我真的不知道它是否会工作。

您应该确定应用更改的范围

```
NSRange range = [textView.text rangeOfString:searchString]; 
```

然后创建属性字符串

```
NSMutableAttributedString *attrStr = [[NSMutableAttributedString alloc] initWithString:textView.text];
[attrStr addAttribute:NSBackgroundColorAttributeName value:[UIColor cyanColor] range:range];
textView.attributedText = attrStr; 
```

# php - AWS Elastic Beanstak 和自定义环境变量

> ID：14062452
> 
> 赞同：1
> 
> 时间：2012-12-27T23:03:29.683
> 
> 标签：php, amazon-web-services, environment-variables, fuelphp, amazon-elastic-beanstalk

我一直在寻找，但我不确定我是否找到了足够的答案。

我想为我的应用程序中的每个环境设置一个唯一的环境变量。

当我创建我的应用程序时，我将有两个环境：登台和生产。

在第一个中，我想设置一个名为 FUEL_ENV 的自定义环境变量（这是用于我使用的框架：FuelPHP），它将具有值“staging”。对于第二个环境，FUEL_ENV 将设置为“生产”。

从技术上讲，我可以使用如下配置文件创建自定义变量：

```
 option_settings:
  - option_name: FUEL_ENV
    value: staging 
```

除非有办法为每个环境设置变量，否则这并不能解决我的问题。

正确的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:54:00.943

这部分在文档中不是很清楚。option_settings 非常适合设置对您的应用程序通用但不特定于环境的东西。

两个想法：

*   我一直想知道
    选项设置中是否有机制。
    允许对每个环境进行**灵活**配置的文件（如果您使用的是命令行工具）。
*   它比我想象的要严格，但有可用的 PARAM1...5 参数是特定于环境的，可以通过基于 Web 的 EB 控制台或通过选项设置文件进行设置。

您可以使用我认为的第二个项目符号，因为您只需要将 1 个项目注入您的应用程序即可确定该 EB 环境中的 FUEL_ENV 将是什么。PARAM1, PARAM2 ... 值被注入到 PHP 的 $_SERVER 超级全局变量中，因此您的应用程序可以像这样在那里提取它们：

FUEL_ENV = $_SERVER['PARAM1'];

# c++ - 模板类的静态 const 成员

> ID：14062455
> 
> 赞同：7
> 
> 时间：2012-12-27T23:03:45.560
> 
> 标签：c++, templates

我有一个带有静态 const 成员的模板类：

```
template <class T>
class A
{
public:
    A(T val) : t(val) {}

    static const int VALUE = 5;

    T t;
}; 
```

假设在我的代码中某处，我使用 int、char 和 long 类型对其进行实例化。现在我想访问 VALUE：

```
int main()
{
    int i1 = A<int>::VALUE;
    int i2 = A<char>::VALUE;
    int i3 = A<long>::VALUE;

    return 0;
} 
```

上述所有访问同一事物的方法不都是相同的吗？在这种情况下，其他人只是选择随机类型吗？有什么办法可以避免指定类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T23:12:34.423

这些都是数字常量，共享相同的值，但属于不同的名称空间。所以你不能避免指定封闭类（通过实例化模板），即使它并不是真正需要的。

但是，您可以将`static const`定义移动到`A<T>`将继承自的类中：

```
class A_Consts
{
  static const int VALUE = 5;
  ...
}; 

template<typename T>
class A : public A_Consts
{
...
}; 
```

或者，将常量定义移到类之外，并将它们都包含在一个命名空间中。恕我直言，这似乎是更好的解决方案。

# uiscrollview - 如何在 iPad 中正确设置 UIPageControl 大小

> ID：14062456
> 
> 赞同：2
> 
> 时间：2012-12-27T23:03:54.850
> 
> 标签：uiscrollview, uipagecontrol

我的 iPad 应用程序中有一个 UIScrollView 和一个 UIPageControl。我已将它们放在 .xib 文件中。我的应用仅支持横向视图。

我尝试在代码中设置宽度和高度，但它看起来永远不会正确。我有一个非常简单的案例，每页 5 页设置为不同的颜色背景，以确保我的页面看起来正确，但它们从不这样做，无论我做什么，颜色都会重叠。

所以我的问题是：

1.  如何在代码中正确设置大小（viewDidLoad？）？
2.  我需要同时设置 UIScrollView 和 UIPageControl 的大小吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:48:14.133

当您使用 xib 时，为什么要使用代码设置宽度和高度。还有我认为由于自动调整大小而面临的问题，只需尝试修改这个希望它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T05:37:43.213

请检查下面的代码。在这里，我已经使用代码完成了所有工作。希望它可以帮助你。

```
int numberOfPages = 5 ;

UIScrollView *scrollQuestionList = [[UIScrollView alloc] initWithFrame:CGRectMake(0.0, 0.0, self.view.frame.size.width, self.view.frame.size.height - 70.0)];
scrollQuestionList.contentSize = CGSizeMake(numberOfPages*scrollQuestionList.frame.size.width, scrollQuestionList.frame.size.height);
[self.view addSubview:scrollQuestionList];
scrollQuestionList.backgroundColor = [UIColor clearColor];
scrollQuestionList.delegate = self;
scrollQuestionList.showsHorizontalScrollIndicator = NO;
scrollQuestionList.pagingEnabled = YES;

CGFloat x = 0.0;

tagForBtns = 0;

for (int i = 1; i <= numberOfPages; i++) 
{
    UIView *contentView = [[[UIView alloc] initWithFrame:CGRectMake(x, 0.0, scrollQuestionList.frame.size.width, scrollQuestionList.frame.size.height)] autorelease];

    if (i%2 == 0)
    {
        [contentView setBackgroundColor:[UIColor grayColor]];
    }
    else
    {
        [contentView setBackgroundColor:[UIColor cyanColor]];
    }

    [scrollQuestionList addSubview:contentView];
    x+= scrollQuestionList.frame.size.width;
}
UIPageControl *pageCntrl = [[UIPageControl alloc] initWithFrame:CGRectMake(0.0, self.view.frame.size.height - 70.0, self.view.frame.size.width, 25.0)];
pageCntrl.numberOfPages = numberOfPages;
pageCntrl.backgroundColor = [UIColor clearColor];
[pageCntrl addTarget:self action:@selector(clickedPageControl:) forControlEvents:UIControlEventValueChanged];
pageCntrl.currentPage = 0;    
[self.view addSubview:pageCntrl]; 
```

# objective-c - 如何在 Mac OS X 应用程序中实现终端？

> ID：14062462
> 
> 赞同：2
> 
> 时间：2012-12-27T23:04:31.760
> 
> 标签：objective-c, macos

所以我创建了一个应用程序（简单的 IDE），您可以在其中编写/编辑 ada 代码并将其保存到 temp.adb 文件中。要编译该文件，我应该打开终端并导航到 temp.adb 目录。并执行

```
gnatmake temp.adb 
```

如果 temp.adb 有错误，则错误将显示在终端中，否则 temp.adb 在终端中执行。但是我不希望用户单独使用终端和编写命令。我只希望用户单击“构建并运行”按钮，它必须编译文件并在应用程序中显示结果。

我的问题是是否可以直接在应用程序中显示编译错误？并直接在应用程序中执行 temp.adb ？我应该在哪里阅读更多关于此的信息？有小费吗？
这就是应用程序的外观。黑色视图代表控制台区域。 ![这就是应用程序的外观。 黑色视图是代表控制台区域的文本字段。](../Images/0cfb1e839cfff9474bd75208e29ecb01.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:11:05.877

用于[`NSTask`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSTask_Class/Reference/Reference.html)运行带有适当参数的 shell（在 OS X 上可能是 bash）来编译和/或运行您的代码。然后使用[`NSPipe`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSPipe_Class/Reference/Reference.html)将 stdout 和 stderr 重定向到您的输出文本视图。

我做了几乎相同的事情，但是对于 shell 脚本，它应该可以工作。

# iphone - 是否可以查看 iphone 应用程序源代码？

> ID：14062463
> 
> 赞同：9
> 
> 时间：2012-12-27T23:04:43.307
> 
> 标签：iphone

> **可能重复：**
> [反编译应用程序二进制文件以返回源代码](https://stackoverflow.com/questions/2661722/decompile-an-app-binary-to-get-back-to-source-code)
> [反编译 iOS Objective-C 二进制文件](https://stackoverflow.com/questions/5475875/decompiling-ios-objective-c-binaries)

几个月前，我开发了 iOS 应用程序。最近我发现了一个名为“ifunbox”的程序，通过它，我可以访问我的应用程序的 .nib 文件、图标等。我现在没有 Mac，所以我真的看不到我是否可以打开使用 XCode 文件并实际查看我的代码。那么是否有人可以通过“ifunbox”下载 .nib 文件并查看我的源代码，或者它们被编译所以不存在这样的问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T23:16:41.717

您的代码已编译。反编译器确实存在，但它们的输出并不是特别有用。如果我是你，我不会担心它。

其他想要深入了解您编译的应用程序包的人可以访问艺术资产和界面文件的某些方面，但您的代码与从 C 编译的任何其他封闭源可执行文件（或其变体，如 ObjC）一样安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T23:18:13.643

不，您的源代码不可检索，因为您发布的应用程序是通过将源代码编译为可执行文件（不再是源代码）而生成的，然后对可执行二进制文件进行加密。但是，一旦安装了应用程序，就可以从您的设备中提取图像等一些资源。

另请参阅[反编译 iOS Objective-C 二进制文件](https://stackoverflow.com/questions/5475875/decompiling-ios-objective-c-binaries)

# android - 在平板电脑上强制关闭和 android.view.InflateException

> ID：14062466
> 
> 赞同：1
> 
> 时间：2012-12-27T23:05:07.947
> 
> 标签：android, xml, eclipse, exception, inflate

出于某种原因，每当我尝试启动我的片段时，我都会收到以下错误：

```
12-27 16:54:52.345: D/OpenGLRenderer(4506): Enabling debug mode 0
12-27 16:54:53.775: D/AndroidRuntime(4506): Shutting down VM
12-27 16:54:53.775: W/dalvikvm(4506): threadid=1: thread exiting with uncaught exception (group=0x40be4930)
12-27 16:54:53.785: E/AndroidRuntime(4506): FATAL EXCEPTION: main
12-27 16:54:53.785: E/AndroidRuntime(4506): java.lang.RuntimeException: Unable to start activity ComponentInfo{info.twfs.thewholefnshow/info.twfs.thewholefnshow.ILikeWrestlingActivity}: android.view.InflateException: Binary XML file line #7: Error inflating class fragment
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.os.Looper.loop(Looper.java:137)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at java.lang.reflect.Method.invokeNative(Native Method)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at java.lang.reflect.Method.invoke(Method.java:511)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at dalvik.system.NativeStart.main(Native Method)
12-27 16:54:53.785: E/AndroidRuntime(4506): Caused by: android.view.InflateException: Binary XML file line #7: Error inflating class fragment
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:704)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.Activity.setContentView(Activity.java:1881)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at info.twfs.thewholefnshow.ILikeWrestlingActivity.onCreate(ILikeWrestlingActivity.java:16)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.Activity.performCreate(Activity.java:5104)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
12-27 16:54:53.785: E/AndroidRuntime(4506):     ... 11 more
12-27 16:54:53.785: E/AndroidRuntime(4506): Caused by: java.lang.NullPointerException: name == null
12-27 16:54:53.785: E/AndroidRuntime(4506):     at java.lang.VMClassLoader.findLoadedClass(Native Method)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at java.lang.ClassLoader.findLoadedClass(ClassLoader.java:354)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at java.lang.ClassLoader.loadClass(ClassLoader.java:491)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.support.v4.app.Fragment.instantiate(Fragment.java:391)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.support.v4.app.Fragment.instantiate(Fragment.java:369)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:272)
12-27 16:54:53.785: E/AndroidRuntime(4506):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:676)
12-27 16:54:53.785: E/AndroidRuntime(4506):     ... 21 more 
```

令我困惑的是，这只发生在我的平板电脑上运行应用程序时，而不是我的手机上。我试图完全替换 XML，并得到同样的错误。我检查了清单，名称或其他任何内容都没有错误。

关于什么可能导致此错误的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:15:58.813

在`ILikeWrestlingActivity`课堂上，您扩充了一个 xml 布局。此 xml 布局将放置在`res/layout-sw600 or something`您项目的文件夹中。

在这个文件的第 7 行中，您使用了一个没有`android:name`属性的片段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T07:07:05.400

事实证明，这只是 XML 文件的一些奇怪错误。我用不同的文件名制作了 XML 文件的副本，改为使用该文件进行扩展，现在它就像一个魅力。

我不太确定是什么修复了它，但我已经让它工作了。

# java - 从数据库中检索值并显示在文本字段中

> ID：14062467
> 
> 赞同：-1
> 
> 时间：2012-12-27T23:05:28.970
> 
> 标签：java, database, jdbc

```
 DBUtil util = new DBUtil();
        try {
            JOptionPane.showMessageDialog(null, "Connection Opened!");
            Connection con = util.getConnection();
            PreparedStatement stmt = con.prepareStatement("SELECT (SUM(box_no),SUM(weight),SUM(TP),SUM(TV)) FROM dbo.mut_det WHERE rm_id=?");
            stmt.setInt(1, Integer.parseInt(rm));// but how to get values from textfield dont know.
            //*and how to put these called values SUM(box_no),SUM(weight),SUM(TP),SUM(TV) in textfields dnt know.*//
            //my textfields are txtboxno, txtweight, txttp, txttv
            stmt.execute();
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(null, ex.getMessage());
            Logger.getLogger(Demo.class.getName()).log(Level.SEVERE, null, ex);
        } 
```

您看到无法获取并将值放回文本字段...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:50:46.603

这是肮脏的示例代码，可能有助于解决您的问题。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class TextDemo extends JFrame implements ActionListener {
    JTextField textData;
    JButton button = new JButton("Press Me");

    public TextDemo() {
        JPanel myPanel = new JPanel();
        add(myPanel);
        myPanel.setLayout(new GridLayout(3, 2));
        myPanel.add(button);
        button.addActionListener(this);
        textData = new JTextField();
        myPanel.add(textData);
    }

    public void actionPerformed(ActionEvent e) {
        if (e.getSource() == button) {
            String data = textData.getText(); // perform your DB operation
            textData.setText(data + " This is new text"); // Set your DB values.
        }
    }

    public static void main(String args[]) {
        TextDemo g = new TextDemo();
        g.setLocation(10, 10);
        g.setSize(300, 300);
        g.setVisible(true);
    }
} 
```

# ios - CLLocationManager 的 didExitRegion 从未被调用

> ID：14062468
> 
> 赞同：4
> 
> 时间：2012-12-27T23:05:34.543
> 
> 标签：ios, cocoa-touch, cllocationmanager, geofencing

我正在尝试设置一个小型地理围栏（100 米），以便在用户离开家时提醒他们。为此，我请求用户当前位置，如下所示：

```
- (void)requestUsersCurrentLocation
{
    if (self.locationManager == nil) self.locationManager = [[CLLocationManager alloc] init];

    self.locationManager.delegate = self;
    self.locationManager.desiredAccuracy = kCLLocationAccuracyBest;
    self.locationManager.distanceFilter = 100;
    [self.locationManager startUpdatingLocation];
} 
```

使用 CLLocationManager 的委托方法，我检查应用程序是否能够确定用户的当前位置。在我的测试中，这可以正常工作，并且应用程序继续调用我的`attemptToRegisterGeofenceAlertForLocation:`方法

```
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    CLLocation *location = [locations lastObject];
    NSDate *eventDate = location.timestamp;
    NSTimeInterval howRecent = [eventDate timeIntervalSinceNow];
    if (abs(howRecent) < 15.0)
    {
        [self.locationManager stopUpdatingLocation];

        if([self attemptToRegisterGeofenceAlertForLocation:location])
        {
            [[NSNotificationCenter defaultCenter] postNotificationName:kGeofenceSetupSuccess object:nil];
        }
        else
        {
            [[NSNotificationCenter defaultCenter] postNotificationName:kGeofenceSetupFailure object:nil];
        }
    }
} 
```

到目前为止，一切都很好。这是我的自定义函数，用于在用户当前位置周围注册一个相对较小的地理围栏：

```
- (BOOL)attemptToRegisterGeofenceAlertForLocation:(CLLocation *)location
{
    // Do not create regions if support is unavailable or disabled
    if (![CLLocationManager regionMonitoringAvailable]) return NO;

    // Check the authorization status
    if (([CLLocationManager authorizationStatus] != kCLAuthorizationStatusAuthorized) && ([CLLocationManager authorizationStatus] != kCLAuthorizationStatusNotDetermined)) return NO;

    // Clear out any old regions to prevent buildup.
    if ([self.locationManager.monitoredRegions count] > 0)
    {
        for (id obj in self.locationManager.monitoredRegions)
        {
            [self.locationManager stopMonitoringForRegion:obj];
        }
    }

    // If the overlay's radius is too large, registration fails automatically,
    // so clamp the radius to the max value.
    CLLocationDegrees radius = 100; // meters?
    if (radius > self.locationManager.maximumRegionMonitoringDistance)
    {
        radius = self.locationManager.maximumRegionMonitoringDistance;
    }

    // Create the region to be monitored.
    CLRegion *region = [[CLRegion alloc] initCircularRegionWithCenter:location.coordinate radius:radius identifier:kGeofenceIdentifier];
    [self.locationManager startMonitoringForRegion:region];

    return YES;
} 
```

当用户退出地理围栏区域时，我会这样回应：

```
- (void)locationManager:(CLLocationManager *)manager didExitRegion:(CLRegion *)region
{
    if([region.identifier isEqual:kGeofenceIdentifier])
    {
        if([[UIApplication sharedApplication] applicationState] == UIApplicationStateBackground)
        {
            // Fire a UILocationNotification
        }
        else
        {
            // Fire a UIAlertView
        }
    }
} 
```

我已经确定该应用程序能够获取用户位置并且地理围栏已正确注册，但是我无法在实际设备（支持 3G 的 iPhone）上触发它。我离开了地理围栏区域，走了几英里，却没有收到任何通知。通过彻底改变我的位置，我成功地在模拟器中接收到警报。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T20:44:31.363

It looks like your radius is set to just 100M (good). The distance filter is also set to 100M as well that might just be fighting against you. In the simulator, you get very precise updates because you have to pass them in. In real world testing, you are getting less than precise coordinates from Wifi approximation and cell-triangulation.

My experience is that if I use `kCLLocationAccuracyBest` for the distance filter, I get very good results. Since region monitoring is already low powered from the system, you aren't going to take a battery hit just by setting the filter to best.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-30T12:41:47.403

事实证明，这个问题的解决方案是确保 CLLocationManager 在主线程上初始化。根据 Apple 的文档：

> 位置管理器对象的配置必须始终发生在具有活动运行循环的线程上，例如应用程序的主线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-28T14:28:07.813

你已经得到了你的答案，但有时问题可能是因为没有出去太多，也没有在外面呆太久，或者有时你已经这样做了，但是因为你所在的地区就像设置了一些非常小的东西5 米（你永远不应该做的事情）然后你移动了 100 米

> 在 iOS 模拟器或设备上测试您的区域监控代码时，请意识到区域事件可能不会在跨越区域边界后立即发生。**为了防止虚假通知，iOS在满足某些阈值条件之前**不会发送区域通知。具体来说，用户的位置必须跨越区域边界，**离开边界最小距离**，并在通知报告之前**保持在该最小距离至少 20 秒。**
> 
> 具体的阈值距离由硬件和当前可用的定位技术决定。例如， **如果**禁用 Wi-Fi，则区域监控的准确性会大大降低。但是，出于测试目的，您可以假设 **最小距离约为 200 米**。
> 
> [来自[Apple 文档：区域监控](https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/LocationAwarenessPG/RegionMonitoring/RegionMonitoring.html)]

# c++ - 如何实现一个大型容器类？

> ID：14062471
> 
> 赞同：3
> 
> 时间：2012-12-27T23:05:55.627
> 
> 标签：c++, containers

我有一个名为“System”的大类（我想将“System”更改为“House”）。该系统包含不同类型的对象，例如窗户和门。不同类型的对象不能被视为具有相同的基类。为了构建系统，我需要将这些不同类型的对象一一添加。而其他方法，如删除一个，清除所有也需要管理系统。我正在比较两种方法来做到这一点。一是实现类System的接口中的所有方法。另一种是暴露对象的内部容器，让用户调用容器的方法来做。我认为第一个应该更好，但是如果我有很多不同的类型，我需要编写很多类似的代码吗？有什么更好的方法吗？谢谢。

```
class System
{
public:
    AddDoor(Door);
    DeleteDoor(Door);
    DeleteAllDoors();
    ...

    AddWindow(Window);
    DeleteWindow(Window);
    DeleteAllWindows();
    ...

    ......

private:
    vector<Door> m_doors;
    vector<Window> m_windows;
}

class System
{
public:
    vector<Door>& Doors();
    vector<Window>& Windows();
    ...

private:
    vector<Door> m_doors;
    vector<Window> m_windows;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:19:58.953

面向对象设计的一个关键原则是“隐藏实现细节”[当然，即使不使用面向对象设计，您也应该考虑这一点]。

在这种情况下，这意味着您不应将存储在向量中的内容暴露给调用代码。如果您认为“矢量不适用于这种类型的事情，我需要使用地图、列表、树或......这意味着至少要更改一些代码，对吗？如果你有很多代码，这不是一件好事。

所以，你的第一个想法是这里提出的两个更好的想法。

让我有点担心的一件事是这个类被称为“系统”。这通常意味着该类是一个[上帝对象](http://en.wikipedia.org/wiki/God_object)——它包含一切并且是一切。一般来说，一个类应该尽可能的小和简单。

我不确定您是否有“上帝对象”，但根据 Scott Meyers 的“有效 C++”一书，它被称为系统（或管理器）的标志是一个警告。

除了（非常好的）模板解决方案之外，还有一个用于存储和检索对象的接口类，然后让它们在其他地方有自己的独立生活——您甚至可以为它们提供单独的容器，但仍然只有一组代码添加/删除接口类型的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:14:21.620

您的实现将如下所示：

```
class System {
public:
    #if YOU_ARE_USING_C++11
    template<typename... Args>
    void Add(Args &&... args) {
     GetContainer<T>().emplace_back(std::forward<Args>(args)...);
    }
    #else
    template<typename T>
    void Add(T const & t) {
        GetContainer<T>().push_back(t);
    }
    #endif
    template<typename T>
    void Delete(T const & t) {
        std::vector<T>::iterator position = std::find(GetContainer<T>().begin(), GetContainer<T>().end(), t);
        GetContainer<T>().erase(position);
    }
private:
    template<typename T>
    std::vector<T> & GetContainer();
};

template<>
std::vector<Doors> & System::GetContainer() {
    return m_doors;
}
template<>
std::vector<Windows> & System::GetContainer() {
    return m_windows;
} 
```

你正在寻找这样的东西吗？如果不进一步了解您的问题，很难说出这里的“最佳”设计是什么。

话虽如此，有时将类作为公共成员可能是合适的，而不仅仅是函数。

# azure - 不记录自定义性能计数器

> ID：14062475
> 
> 赞同：0
> 
> 时间：2012-12-27T23:06:07.673
> 
> 标签：azure, performancecounter

性能计数器正在工作，但其数据未记录在 WADPerformanceCountersTable 中。

在 webrole.cs 我有

```
 public override bool OnStart()
    {
        var config = DiagnosticMonitor.GetDefaultInitialConfiguration();
        config.PerformanceCounters.DataSources.Add(
                 new PerformanceCounterConfiguration
                 {
                     CounterSpecifier = @"\Processor(_Total)\% Processor Time",
                     SampleRate = TimeSpan.FromSeconds(5)
                 });
        if (!PerformanceCounterCategory.Exists("MyCustomCounterCategory"))
        {
            CounterCreationDataCollection counterCollection = new CounterCreationDataCollection();

            // add a counter tracking user button1 clicks
            CounterCreationData operationTotal1 = new CounterCreationData();
            operationTotal1.CounterName = "MyButton1Counter";
            operationTotal1.CounterHelp = "My Custom Counter for Button1";
            operationTotal1.CounterType = PerformanceCounterType.NumberOfItems32;
            counterCollection.Add(operationTotal1);

            // add a counter tracking user button2 clicks
            CounterCreationData operationTotal2 = new CounterCreationData();
            operationTotal2.CounterName = "MyButton2Counter";
            operationTotal2.CounterHelp = "My Custom Counter for Button2";
            operationTotal2.CounterType = PerformanceCounterType.NumberOfItems32;
            counterCollection.Add(operationTotal2);

            PerformanceCounterCategory.Create(
              "MyCustomCounterCategory",
              "My Custom Counter Category",
              PerformanceCounterCategoryType.SingleInstance, counterCollection);

            Trace.WriteLine("Custom counter category created.");
        }
        else
        {
            Trace.WriteLine("Custom counter category already exists.");
        }

        config.PerformanceCounters.ScheduledTransferPeriod =
          TimeSpan.FromMinutes(2D);
        config.PerformanceCounters.BufferQuotaInMB = 512;
        TimeSpan perfSampleRate = TimeSpan.FromSeconds(30D);

        // Add configuration settings for custom performance counters.
        config.PerformanceCounters.DataSources.Add(
          new PerformanceCounterConfiguration()
          {
              CounterSpecifier = @"\MyCustomCounterCategory\MyButton1Counter",
              SampleRate = perfSampleRate
          });

        config.PerformanceCounters.DataSources.Add(
          new PerformanceCounterConfiguration()
          {
              CounterSpecifier = @"\MyCustomCounterCategory\MyButton2Counter",
              SampleRate = perfSampleRate
          });

        // Apply the updated configuration to the diagnostic monitor.    
        DiagnosticMonitor.Start("Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString", config);

        return base.OnStart();
    } 
```

在我的一个页面加载方法中，我添加了

```
 var button1Counter = new PerformanceCounter(
  "MyCustomCounterCategory",
  "MyButton1Counter",
  string.Empty,
  false);

        System.Diagnostics.Trace.WriteLine("Users accessed");
        button1Counter.Increment(); 
```

我可以在 WebLogsTable 中看到“访问的用户”日志，button1Counter.Increment 也有效（我可以看到它是使用日志计算的原始值）。

问题是我可以在 PerformanceCounters 表中看到的唯一性能计数器是 \Processor(_Total)\% Processor Time。如果我在 Azure 管理面板中打开详细监视模式，我会看到更多性能计数器被记录（但每五分钟只有一次，但不是自定义性能计数器）

为什么我创建的自定义性能计数器没有被记录？

这是 WAD 性能计数器表： ![在此处输入图像描述](../Images/bae816d838427a32b030448c6006d55b.png)

以下是日志： ![在此处输入图像描述](../Images/4d806a5c6a9aea13e227f9e3a8fc7b01.png)

这是 Windows 日志（每个日志重复 10 次，但我删除了“便携式设备枚举器服务服务进入停止状态。”和“应用程序体验服务进入停止状态”的重复项以及关于时间更改的内容。“所以你可以看到它们。为什么要创建 10 个相同的日志？）

![在此处输入图像描述](../Images/d30bde18f3f613500192bd9f7f428ad5.png)

那么如何让 AZURE 将自定义性能路由器放入 WADPerformanceCoutersTable 中？

我已经为此苦苦挣扎了两天。请帮忙！我使用 Azure，而不是模拟器

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:03:01.553

我设法使它工作。我不知道是什么东西（我什至删除了部署并再次发布 - 也许修复了它），但这里是有效的文件

Role.cs 文件

```
String wadConnectionString =
                       "Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString";

            CloudStorageAccount cloudStorageAccount =
                                    CloudStorageAccount.Parse(RoleEnvironment.GetConfigurationSettingValue
                                    (wadConnectionString));

            RoleInstanceDiagnosticManager roleInstanceDiagnosticManager =
                                   cloudStorageAccount.CreateRoleInstanceDiagnosticManager(
                                   RoleEnvironment.DeploymentId,
                                   RoleEnvironment.CurrentRoleInstance.Role.Name,
                                   RoleEnvironment.CurrentRoleInstance.Id);

            LocalResource localResource = RoleEnvironment.GetLocalResource("MyCustomLogs");
            DirectoryConfiguration dirConfig = new DirectoryConfiguration();
            dirConfig.Container = "wad-mycustomlogs-container";
            dirConfig.DirectoryQuotaInMB = localResource.MaximumSizeInMegabytes;
            dirConfig.Path = localResource.RootPath;

            if (!PerformanceCounterCategory.Exists("MyCustomCounterCategory"))
            {
                CounterCreationDataCollection counterCollection = new CounterCreationDataCollection();

                // add a counter tracking user button1 clicks
                CounterCreationData operationTotal1 = new CounterCreationData();
                operationTotal1.CounterName = "MyButton1Counter";
                operationTotal1.CounterHelp = "My Custom Counter for Button1";
                operationTotal1.CounterType = PerformanceCounterType.NumberOfItems32;
                counterCollection.Add(operationTotal1);

                // add a counter tracking user button2 clicks
                CounterCreationData operationTotal2 = new CounterCreationData();
                operationTotal2.CounterName = "MyButton2Counter";
                operationTotal2.CounterHelp = "My Custom Counter for Button2";
                operationTotal2.CounterType = PerformanceCounterType.NumberOfItems32;
                counterCollection.Add(operationTotal2);

                PerformanceCounterCategory.Create(
                  "MyCustomCounterCategory",
                  "My Custom Counter Category",
                  PerformanceCounterCategoryType.SingleInstance, counterCollection);

                Trace.WriteLine("Custom counter category created.");
            }
            else
            {
                Trace.WriteLine("Custom counter category already exists.");
            }
            Trace.WriteLine("Creating custom counters.");
            var config = DiagnosticMonitor.GetDefaultInitialConfiguration();
            config.WindowsEventLog.DataSources.Add("Application!*");
            config.WindowsEventLog.DataSources.Add("System!*");

            config.Directories.ScheduledTransferPeriod = TimeSpan.FromMinutes(2d);
            config.Directories.DataSources.Add(dirConfig);

            config.Logs.ScheduledTransferPeriod = TimeSpan.FromMinutes(2d);
            config.PerformanceCounters.ScheduledTransferPeriod =
              TimeSpan.FromMinutes(2D);
            config.PerformanceCounters.BufferQuotaInMB = 512;
            TimeSpan perfSampleRate = TimeSpan.FromSeconds(30D);

            // Add configuration settings for custom performance counters.
            config.PerformanceCounters.DataSources.Add(
              new PerformanceCounterConfiguration()
              {
                  CounterSpecifier = @"\MyCustomCounterCategory\MyButton1Counter",
                  SampleRate = perfSampleRate
              });

            config.PerformanceCounters.DataSources.Add(
                   new PerformanceCounterConfiguration
                   {
                       CounterSpecifier = @"\Processor(_Total)\% Processor Time",
                       SampleRate = perfSampleRate
                   });
            config.PerformanceCounters.DataSources.Add(
              new PerformanceCounterConfiguration()
              {
                  CounterSpecifier = @"\MyCustomCounterCategory\MyButton2Counter",
                  SampleRate = perfSampleRate
              });

            // Apply the updated configuration to the diagnostic monitor.    
            DiagnosticMonitor.Start("Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString", config);
            Trace.WriteLine("Started perf counters"); 
```

网络配置

```
 <trace enabled="true" requestLimit="40" localOnly="false" />

 <system.diagnostics>
    <trace>
      <listeners>
        <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, 
            Microsoft.WindowsAzure.Diagnostics, 
            Version=1.8.0.0, 
            Culture=neutral, 
            PublicKeyToken=31bf3856ad364e35"
           name="AzureDiagnostics">
          <filter type="" />
        </add>
      </listeners>
    </trace>
  </system.diagnostics> 
```

在服务定义.cs

```
 <Imports>
      <Import moduleName="Diagnostics" />
    </Imports>
    <LocalResources>
      <LocalStorage name="MyCustomLogs" sizeInMB="10" cleanOnRoleRecycle="false" />
    </LocalResources> 
```

在 ServiceConfiguration.Cloud

```
 <Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" 
           value="DefaultEndpointsProtocol=https;AccountName=acc name;
           AccountKey=r- --- -- - your key=" />
</ConfigurationSettings>
<Certificates>
  <Certificate name="mycretificate" thumbprint="XXXXX" thumbprintAlgorithm="sha1" />
</Certificates> 
```

# yii - Yii 和 XSS，数据逃到哪里去了？

> ID：14062477
> 
> 赞同：3
> 
> 时间：2012-12-27T23:06:11.437
> 
> 标签：yii, xss

Yii 中的用户输入在哪里转义？

1.  `CHtml::encode(strip_tags())`在将它们保存到数据库之前我应该​​打电话吗？或者我应该在视图中对它们进行编码，之前`echo`？

2.  有没有办法在验证中自动编码输入文本？[a-zA-Z0-9]* 验证是否是在验证中过滤注入的最佳方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:08:51.583

对于第一个，这是我的个人意见，但我会按照你说的做：`CHtml::encode(strip_tags())`在保存数据之前。之前这样做的主要优点是，如果您从不同的介质（网站、api 等）获取数据，您将确保检索到的数据是安全的。

对于第二点，我不知道是否有自动编码输入文本的特定方法，但您可以使用模型中的`beforeValidate()`和`beforeSave()`方法之一来做到这一点！

为了 yii 的安全性，我邀请您查看有关[编写安全 yii 应用程序的 wiki](http://www.yiiframework.com/wiki/275/how-to-write-secure-yii-applications)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-21T14:17:39.750

我用：

```
 $p = new CHtmlPurifier();
  $p->options = array(
    'URI.AllowedSchemes' => array(
      'http' => true,
      'https' => true,
  ));
  $search = CHtml::encode($p->purify($search)); 
```

将它放在一个函数中并随时调用它:)

# sql - SQL：用另一个表中定义的变量填充一个表

> ID：14062478
> 
> 赞同：0
> 
> 时间：2012-12-27T23:06:28.083
> 
> 标签：sql, sqlite

我有 Commissions_table 存储我在 Calls_table 中列出的变量的值。像这样

```
EmployeeID      MKM    TKM    LO    
Joe             5      10     15 
John            7      14     21 
```

我需要能够获得 Calls_table 中列的总和，但将变量替换为存储在 Commissions_table 中的金额

```
EmployeeID     CommissionType  TypeOfCall  Call#
Joe               MKM            DC          182
Joe               MKM            DC          182
john              TKM            DC          150
John              TKM            DC          160
john              LO             NC          180 
```

我需要查询返回每个员工的 CommissionType 总和，其中 TypeOfCall 为 DC，并根据 EmployeeID 将 CommissionType 列中列出的变量换成 Commission_table 中列出的值，因为每个 ID 的值不同。它还需要对 Call# 进行区分，因为通常会为同一个电话编写两张发票，但每次电话只向员工支付一笔佣金。

所以期望的结果是这样的，Calls.CommissionType 中的变量是 MKM，例如 joe on call 182，我想填充一个等于该员工佣金表中列出的任何值的单元格。MKM 中 joe 的值在佣金表中为 5，因此对于该示例，查询返回的总佣金将为 5，因为 Call# 将是 dinstinct，并且只会返回一个佣金金额，并且返回的金额为john 将是 28，因为在返回的查询中将添加两个数量，因为为 john 列出的第三个是 NC，并且只需要 DC。所以返回的查询看起来像：

```
EmployeeID     TotalCommission 
John           28
Joe            5 
```

我正在研究将主键（Calls.EmployeeID）与外键（Commissions.EmployeeID）联系起来，但仍然对如何替换调用表中的变量感到困惑。如果这是不可能的，有没有人有任何想法可以达到类似的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:11:09.497

好的，我在 SQL fiddle 中对此进行了研究，因此您可以在那里测试解决方案：

[http://sqlfiddle.com/#!3/3b815/12/0](http://sqlfiddle.com/#!3/3b815/12/0)

无论如何我得到这些结果：

乔 5 约翰 28

我忽略了大小写，所以约翰和约翰都是同一个人

缩进的子查询使用 case 语句来求和，具体取决于 Commission_type 是什么。然后我将总数相加，以便显示每个员工的总佣金。如果您运行子查询，您将看到它使用 distinct 子句来处理多个发票。

```
SELECT 
EmployeeID,
SUM(CommissionTotal) AS CommissionTotal
FROM 
    (SELECT DISTINCT
    Calls.Call#,
    Calls.EmployeeID,
    Calls.CommissionType,
    Calls.TypeOfCall,
    CASE 
    WHEN Calls.CommissionType = 'MKM' THEN SUM(Commissions.MKM)
    WHEN Calls.CommissionType = 'TKM' THEN SUM(Commissions.TKM) 
    WHEN Calls.CommissionType = 'LO' THEN SUM(Commissions.LO)
    END AS CommissionTotal
    FROM Calls
    LEFT JOIN Commissions 
    ON Calls.EmployeeID=Commissions.EmployeeID
    WHERE TypeOfCall = 'DC'
    GROUP BY Calls.Call#,
    Calls.EmployeeID, 
    Calls.CommissionType,
    Calls.TypeOfCall) a
GROUP BY 
EmployeeID 
```

# facebook - FQL 错误 803 突然出现

> ID：14062483
> 
> 赞同：0
> 
> 时间：2012-12-27T23:07:16.257
> 
> 标签：facebook, facebook-fql

我的代码中有一个 fql 查询，直到上周（或前后）都运行良好，然后突然停止工作。

我现在收到一个奇怪的 #803 错误以及消息“您请求的某些别名不存在：”这是很奇怪的（我相信这是一个完全的红鲱鱼），因为我现在已经尝试删除我以前的所有别名并用“名称”替换它们。

完全在我的绳索末端试图弄清楚Facebook在过去几周发生的变化会导致这种情况。如果有人有任何见解，我将非常感激听到它。

我在这里发布我的代码，但我并不期待任何关于代码本身的评论，因为它在几个月内完美运行，直到过去两周左右的某个时间点。

代码的具体目的是为用户获取一个身份验证令牌，然后检索 /me 请求中不可用的一些更详细的信息。

```
//I call this first to get the token

               function checkStatus() {     
            try{

                FB.getLoginStatus( function( loginResponse ){
                    if( loginResponse.status == "connected" ){
                        authToken = loginResponse.authResponse.accessToken;//this comes back as expected
                        expiresIn = loginResponse.authResponse.expiresIn;//this comes back as expected
                        getUserInfo();
                    } else {
                        registerApp();//this gets called if the user hasn't approved the app yet... this continues to work as expected
                    }
                } );

            }
            catch(e){
                alert("ERROR" + e);
            }
        }

//so the above method calls this

                function getUserInfo(){
            FB.api( "/me", function( meResponse ){   

                meResponse.authToken = authToken;
                meResponse.expiresIn = expiresIn;           
                console.log("meResponse = " + JSON.stringify(meResponse));
//this contains all the correct expected data

                FB.api(escape("/fql&q=SELECT name FROM user WHERE uid = '"+ meResponse.id +"'"),//here I've eliminated ALL extra aliases (though none of them were a problem before
                    function( response ){
                        console.log("RESP = " + JSON.stringify(response)); //this comes back with the following error:
//{"error":{"message":"(#803) Some of the aliases you requested do not exist: fql&q=SELECT name FROM user WHERE uid = 'xxxxxxxxx'","type":"OAuthException","code":803}}

                    }
                 )              
            } );

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:29:33.860

所以......看起来FB完全改变了如何调用fql的语法，而且我没有看到任何对我上面的旧方法的引用（完全有效）。

新方法是传入一个如下所示的 JSON 对象：

```
{method:'fql.query',                            query: "SELECT uid,name,email,first_name,last_name,birthday_date,pic_big FROM user WHERE uid = '"+ meResponse.id +"'"} 
```

并且响应不再作为一个名为*data*的数组返回，现在是返回对象顶层的原始未命名数组......所以在我上面的示例中，我现在只查看 response[0] 而不是响应数据[0]。

我在他们的任何文档中都没有提到任何这些更改......也许我只是失去了理智，但看起来他们只是完全启动并修改了他们的 API，没有任何警告。

也许我错过了一些东西（我通常是）。

以防万一其他人需要帮助...这是新工作代码的示例...

```
FB.api(
                    {method:'fql.query',   
                        query: "SELECT uid,name,email,first_name,last_name,birthday_date,pic_big FROM user WHERE uid = '"+ meResponse.id +"'"},
                function( response ){
                    console.log("RESP = " + JSON.stringify(response));
                    //all the data for this specific user is now in response[0], obviously if your search criteria contains more users, they'll be in the subsequent indexed items under the response array.                                            
                }
             ) 
```

# c# - WCF 通用字典和理解 WCF

> ID：14062486
> 
> 赞同：3
> 
> 时间：2012-12-27T23:07:48.953
> 
> 标签：c#, wcf, web-services, generics, iis

好的，我在解决特定问题时遇到了很大的困难。通过服务转移对象。从概念上讲，这是有道理的……我认为？根据我的阅读，除非已明确定义，否则无法序列化 Generic。

所以我想提供我的例子；我根本无法上班。意思是; 我相信还有其他人也遇到了一些困难。当您提供代码时提供帮助；这将起作用并解释它。这样我就可以完全理解这个问题。这将有助于我了解 Windows Communication Foundation。

目标是一个只有五个字段的客户端应用程序；它在其中“发布”到服务器。

*   名
*   姓
*   电子邮件地址
*   电话号码
*   网站地址

这并不太复杂。

这就是我所做的，在我学习 WCF 的过程中，我已经尽可能接近 OOP Principals，用于基于 SOA 的应用程序。这样，它提供了代码的可重用性。

模型/数据合同：

```
#region Using Reference...

using System.Runtime.Serialization;
using System.Collections.Generic;
using System.Threading.Tasks;
using System.Text;
using System.Linq;
using System;

#endregion

namespace _2Do.Model.Customer
{

    [DataContract(IsReference = true)]
    public class Person
    {

        #region Declared Variable.

        string first;
        string last;
        string email;
        string phone;
        string site;

        #endregion

        #region Constructor:

        Person()
        {

            // Empty Constructor.

        }

        #endregion

        #region Data Member Properties:

        [DataMember()]
        public string First
        {

            get { return first; }
            set { first = value; }

        }

        [DataMember()]
        public string Last
        {

            get { return last; }
            set { last = value; }

        }

        [DataMember()]
        public string Email
        {

            get { return email; }
            set { email = value; }

        }

        [DataMember()]
        public string Phone
        {

            get { return phone; }
            set { phone = value; }

        }

        [DataMember()]
        public string Site
        {

            get { return site; }
            set { site = value; }

        }

        #endregion

    }

} 
```

这就是应该通过元数据为客户端公开的对象；所以对于服务接口我尝试了这个：

```
#region Using Reference...

using System.Collections.Generic;
using System.Threading.Tasks;
using System.ServiceModel;
using _2Do.Model.Customer;
using System.Text;
using System.Linq;
using System;

#endregion

namespace _2Do.Contract.Customer
{

    [ServiceContract (Namespace = "https://_2Do") ]
    public interface IPerson
    {

        [OperationContract()]
        Person SetCustomer(Dictionary<Guid, Person> info);

    }

} 
```

所以以上就是目标；转移我的 Person 对象；存储到字典中。另一件事要注意；我是否认为通过引用传递值的实现将有助于序列化。我想一旦数据存储在内存中；它将包含一个明确的方法来处理。那是我的错吗？

这就是我的`DataContract`and `ServiceContract`。

此时的实现是这样的：

```
#region Using Reference...

using System.Collections.Generic;
using System.Threading.Tasks;
using _2Do.Contract.Customer;
using System.ServiceModel;
using _2Do.Model.Customer;
using System.Text;
using System.Linq;
using System;

#endregion

namespace _2Do.Service.Customer
{

    [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall)]
    public class PersonService : IPerson
    {

        #region Constructor:

        PersonService()
        {

            // Empty Constructor.

        }

        #endregion

        #region Implement Interface:

        Person SetCustomer(Dictionary<Guid, Person> info)
        {

            // Receive an error that indicates; best overload method.
            // Contains invalid arguments.

        }

        #endregion

    }

} 
```

然后我创建了一个单独的项目来托管应用程序；我创建了一个空文本文件并将其重命名为`PersonService.svc`.

然后我把：`<%@ ServiceHost Service = "_2Do.Service.Customer.PersonService" %>`。

哪个应该指向正确的命名空间；其中`PersonService`我有一个`web.config`文件，其中包含要在 Internet 信息系统中托管的最低配置。我认为这可以让我绕过定义我的地址、绑定和合同。因为 IIS 现在会为我做这一切。

然后我创建了一个`ClientProxy`类；其中几乎包含了一面镜子`DataContract`。然后我创建了实际的客户端应用程序来做：

```
PersonProxy p = new PersonProxy();
p.First = txtFirst.Text;
p.Last = txtLast.Text;
p.Email = txtEmail.Text;
p.Phone = txtPhone.Text;
p.Site = txtSite.Text;
Dictionary<Guid, Person> i = new Dictionary<Guid, Person>();
i.Add(Guid.NewGuid(), p); 
```

我有这些项目：

*   模型 --> 数据合同
*   合同 --> 服务合同
*   服务 --> 接口实现
*   主机 --> 存储服务/Svc
*   ClientProxy --> 接口实现
*   客户端 --> 链接到要继承的 ClientProxy 的实际值。

这就是我在客户端上使用它的方式。我不确定我在哪里搞砸了。我真的很想了解 WCF，因为我需要为工作项目学习它。但是我很沮丧，觉得自己很愚蠢，因为我似乎无法解决这个问题。

如果我按照教程进行操作，它会起作用。但是一旦我回到原来的实现，它就会失败。不知道我哪里出错了。一些手握将不胜感激；但如果你能一步一步地解释它，那将不胜感激。所以我可以从我的错误中吸取教训，从而真正提高。

我无法让它将变量存储在服务器上，传输，我现在不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T03:20:44.847

我仍然不确定为什么您的代码不起作用。也许我不了解 IIS 中的托管以及我应该了解的情况。但是，下面是我能想到的最简单的 Web 服务 + 客户端的完整工作示例。希望它能帮助您找到并解决问题。

首先，[项目结构](http://imgur.com/15MSF)：一个类库项目中的合同，控制台应用程序中的服务和主机，不同控制台应用程序中的客户端。

数据合约：

```
[DataContract]
public class Person
{
    [DataMember]
    public string Name { get; set; }
    [DataMember]
    public string Email { get; set; }
} 
```

服务合约：

```
[ServiceContract]
public interface IPerson
{
    [OperationContract]
    Person SetCustomer(Dictionary<Guid, Person> info);
} 
```

服务：

```
public class PersonService : IPerson
{
    public Person SetCustomer(Dictionary<Guid, Person> info)
    {
        foreach (var person in info.Values)
        {
            Console.WriteLine("Name: {0} | Email: {1}", person.Name, person.Email);
        }

        var p = new Person { Name = "John Doe", Email = "John@Doe.com" };
        return p;
    }
} 
```

服务主机（在宿主项目的 Program.cs 中）：

```
static void Main(string[] args)
{
    using (ServiceHost host = new ServiceHost(typeof(PersonService), new Uri("http://localhost:8080")))
    {
        host.Open();

        Console.WriteLine("Ready!");
        Console.ReadKey(true);

        host.Close();
    }
} 
```

最后，客户端（在它自己项目的 Program.cs 中）：

```
static void Main(string[] args)
{
    var binding = new BasicHttpBinding();
    var endpoint = new EndpointAddress("http://localhost:8080/");
    using (var factory = new ChannelFactory<IPerson>(binding, endpoint))
    {
        var request = new Dictionary<Guid, Person>();
        request[Guid.NewGuid()] = new Person { Name = "Bob", Email = "Bob@abc.com" };

        var client = factory.CreateChannel();
        var result = client.SetCustomer(request);

        Console.WriteLine("Name: {0} | Email: {1}", result.Name, result.Email);
        factory.Close();
    }
    Console.ReadKey(true);
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:16:42.363

您真的需要将字典作为服务合同的参数吗？保持简单 - 使用 List 代替。我的建议是：

1) 将 Guid 属性添加到 Person 数据合约

```
[DataContract(IsReference = true)]
public class Person
{
    #region Constructor:

    public Person()
    {
        // Empty Constructor.
    }

    #endregion

    #region Data Member Properties:

    [DataMember]
    public Guid Guid { get; set; }

    [DataMember]
    public string First { get; set; }

    [DataMember]
    public string Last { get; set; }

    [DataMember]
    public string Email { get; set; }

    [DataMember]
    public string Phone { get; set; }

    [DataMember]
    public string Site { get; set; }

    #endregion
} 
```

2）更改服务合同以使用列表：

```
[ServiceContract (Namespace = "https://_2Do") ]
public interface IPerson
{
    [OperationContract()]
    Person SetCustomer(List<Person> info);
} 
```

3）客户端代码是这样的：

```
PersonProxy p = new PersonProxy();
p.Guid = Guid.NewGuid();
p.First = txtFirst.Text;
p.Last = txtLast.Text;
p.Email = txtEmail.Text;
p.Phone = txtPhone.Text;
p.Site = txtSite.Text;

var list = new List<Person>();
list.Add(p); 
```

最后，如果您的服务代码中确实需要字典，您可以使用[ToDictionary方法轻松转换列表](http://www.dotnetperls.com/todictionary)

# ruby - 想要使用两个一对多关联来更新同一个模型 - Rails 3.2.9 - Ruby 1.9.3

> ID：14062497
> 
> 赞同：1
> 
> 时间：2012-12-27T23:08:57.900
> 
> 标签：ruby, ruby-on-rails-3.2, associations, model-associations

我已经阅读了提交的其他一些 Stack Overflow 问题，其中您有两个模型属于一个模型，但我找不到一个可以解决我的特定问题的问题。

我有一个用户模型、一个消息模型和一个响应模型。

用户模型 has_many 消息和 has_many 响应。两者都有相关的销毁选项。

消息模型 belongs_to user 和 has_many 响应。消息模型的 user_id 与 User 模型相关联。它具有响应的依赖破坏。

响应模型belongs_to 消息和belongs_to 用户。响应模型有 message_id 与消息模型相关联，而 user_id 我也想与用户模型相关联。

在不考虑用户模型的情况下，我知道响应模型，我可以执行类似 message.responses.build 的操作来创建一个新的响应，其中 message_id 从与其相关的消息中填充。但是，如果我认为我当前拥有的 user_id 不会自动填充。我也明白，如果我是消息 ID，我可以做出回应。消息以获取该行。

我希望能够自动删除对已删除消息或已删除用户的所有回复。我想做的是执行一个类似于 message.responses.build 的命令，它会知道在我的响应行上更新 message_id 和 user_id 。这可能吗？

# c++ - 在 C++ 中授予对类数据成员的回调函数访问权限

> ID：14062501
> 
> 赞同：0
> 
> 时间：2012-12-27T23:09:20.763
> 
> 标签：c++, opencv, callback

我在我的项目中使用 C++ 中的 opencv 库，但在使用 MouseCallback 时遇到问题。

我有一个 BoardCalibration 类，它有两个数据成员，我需要在回调函数中使用它们。你可以在下面看到这个类：

```
class BoardCalibration{
private:
    Rect _box;  <-- data members i need to upadte inside the callback function
    bool _drawingBox; <--

public:
    BoardCalibration();
    static void my_mouse_callback(int event, int x, int y, int flags, void* param);
    Rect calibrate(Mat& image);
    void drawBox(IplImage* img);
}; 
```

在 calibrate() 方法中，我调用了接收回调 my_mouse_callback 函数的函数。代码：

```
Rect BoardCalibration::calibrate(Mat& image){
    IplImage * img = new IplImage(image);

    namedWindow("Calibration");

    IplImage *temp = cvCloneImage(img);
    cvSetMouseCallback("Calibration", my_mouse_callback, (void *)img);

    while (1){

        imshow("Calibration", Mat(img));
        cvCopyImage(img,temp);

        if( _drawingBox ){
            drawBox(temp);
        }

        imshow("Calibration", Mat(temp));

        if (waitKey(1)>=0)
            break;
    }

    cout << "calibrated\n";

    delete img;
    return _box;
} 
```

在 my_mouse_callback 的实现是：

```
static void my_mouse_callback(int event, int x, int y, int flags, void* param){

    IplImage* image = (IplImage*) param;

    switch( event ) {
    case CV_EVENT_MOUSEMOVE: {
        if( _drawingBox ) {
            _box.width  = x-_box.x;
            _box.height = y-_box.y;
        }
                             }
                             break;
    case CV_EVENT_LBUTTONDOWN: {
        _drawingBox = true;
        _box = Rect( x, y, 0, 0 );
                               }
                               break;   
    case CV_EVENT_LBUTTONUP: {
        _drawingBox = false; 
        if( _box.width<0 ) { 
            _box.x+=_box.width;  
            _box.width *=-1; 
        }
        if( _box.height<0 ) { 
            _box.y+=_box.height; 
            _box.height*=-1; 
        }

        //drawBox(image, box);  // keep draw on screen
        // display rectangle coordinates
        cout << "TopLeft: (" << _box.x << "," << _box.y << "), BottomRight: (" 
            << _box.x+_box.width << "," << _box.y+_box.height << ")" << endl;
                             }
                             break;
    }
} 
```

如您所见，我正在尝试访问 _box 和 _drawingBox 成员，但因为它是静态方法，所以无法识别它们。我怎么解决这个问题？？我不能改变 my_mouse_callback 的原型，否则它不会被 cvSetMouseCallback 接受。我也不能在类之外定义那些数据成员，因为它给了我他们已经定义的错误。还有什么我可以尝试的吗？？？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T23:21:38.347

我对opencv一无所知，但是像这样的东西怎么样

```
struct Helper
{
    IplImage * pI;
    BoardCalibration * pObj;
};

Rect BoardCalibration::calibrate(Mat& image)
{
    .... stuff ....

    Helper * p = new Helper;
    p->pI = img;
    p->pObj = this;

    cvSetMouseCallback("Calibration", my_mouse_callback, (void *)p);

    .... stuff ...   

    delete p;
    delete img;
    return _box;

}

static void BoardCalibration::my_mouse_callback(int event, int x, int y, int flags, void* param)
{
    Helper * p = (Helper *)param;
    IplImage* image = p->pI;
    BoardCalibration * pBC = p->pObj;

    switch( event ) 
    {
        case CV_EVENT_MOUSEMOVE: 
        {
            if( pBC->_drawingBox )  // use the pBC pointer

            ... stuff ...

    }

    ... stuff ...

} 
```

我不知道您的代码流程以确定何时应该删除帮助对象。所以我在`delete Helper object`附近有代码，`delete img`因为如果该代码是正确的，那么这也可能是`delete`Helper 对象的正确位置。但是你需要检查一下。只有当您确定回调将在那时为该调用完成运行时，您才需要删除此对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T14:54:32.963

好，我知道了。你应该这样做。它已经成功了。

```
1) cvSetMouseCallback("Calibration", my_mouse_callback, (void *)this); // Callback function to give it a this pointer.
2) BoardCalibration* ptr = (BoardCalibration*) param; // ptr pointer to your class.
3) e.g ptr->  _box oder ptr-> _drawingBox //all the private parameters,that you need to use, do this: 
```

祝你好运。我希望它能帮助你解决问题。咬sehr。王秋月。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T13:38:54.777

我不知道细节是怎么做的，但我有一个想法，如果我们可以

```
cvSetMouseCallback("Calibration", my_mouse_callback, (void *)img); 
```

`param`(object) 是要传递给回调函数的用户定义参数。因此，如果我们可以代替`img`，使用`pointer`指向`class`，也许我们可以使用`this->`所有私有参数或`class`.all 公共函数。但我只是有这个想法，你应该尝试一下，也许会成功......

祝你好运。告诉我你是否成功了。王。

# java - FEST 测试挂在新的 FrameFixture() 上

> ID：14062503
> 
> 赞同：0
> 
> 时间：2012-12-27T23:09:47.290
> 
> 标签：java, swing, fest

我尝试使用 FEST 创建一个挥杆测试，只需单击一个按钮。不幸的是，测试在执行 new FrameFixture(...) 时挂起。我正在实例化一个控制器，它在内部创建一个从 JFrame 扩展的视图。getView() 方法为我提供了这个 JFrame。

```
@Override
protected void onSetUp() {
    drawingCalculator = new FrameFixture(createCalculator());
    drawingCalculator.show();
}

@RunsInEDT
private static MainWindow createCalculator() {
    return execute(new GuiQuery<MainWindow>() {
        protected MainWindow executeInEDT() {
            MainModel model = new MainModel();
            return new MainController(model).getView();
        }
    });
} 
```

我无法通过 new FrameFixture(...) 越界。我调试了测试，此时它挂在框架中：

基本机器人类

```
 private static Object acquireScreenLock() {
   Object screenLockOwner = new Object();
   ScreenLock.instance().acquire(screenLockOwner);
   return screenLockOwner;
 } 
```

这是一个框架错误还是我只是错误地使用了该库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T13:11:37.057

我使用了错误的构造函数。我应该是：

```
 drawingCalculator = new FrameFixture(robot(), createCalculator()); 
```

这将为这个测试用例创建一个新的机器人。

# git - 用于 git repo 创建的 httpd.conf 失败

> ID：14062507
> 
> 赞同：0
> 
> 时间：2012-12-27T23:10:23.757
> 
> 标签：git, apache2, redmine, ubuntu-12.04, httpd.conf

在按照本教程创建新的 redmine 项目时，我正在尝试设置自动 git repo 创建：[http ://www.dreu.info/blog/install-redmine-with-automated-git-on-centos-redhat/](http://www.dreu.info/blog/install-redmine-with-automated-git-on-centos-redhat/)

但是当我将 httpd.conf 添加到我的空 httpd.conf 中时，apache2 将无法启动。有人可以帮助我或验证配置是否正确吗？

```
PerlLoadModule Apache::Redmine

SetEnv GIT_PROJECT_ROOT /var/git/
SetEnv GIT_HTTP_EXPORT_ALL
ScriptAlias /git/ /usr/libexec/git-core/git-http-backend/
<Location /git>
        RedmineGitSmartHttp yes
        DAV on

        AuthType Basic
        Require valid-user
        AuthName "git"

        PerlAccessHandler Apache::Authn::Redmine::access_handler
        PerlAuthenHandler Apache::Authn::Redmine::authen_handler

        RedmineDSN "DBI:mysql:database=redmine_databse;host=localhost"
        RedmineDbUser "user"
        RedmineDbPass "password"

</Location>

Alias /git-private /var/git

<Location /git-private>

        Order deny,allow
        Deny from all

        <Limit GET PROPFIND OPTIONS REPORT>

                Options Indexes FollowSymLinks MultiViews
                Allow from 127.0.0.1
                Allow from localhost
        </Limit>
</Location> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T18:21:10.073

我解决了。git-http-backend 的路径不正确。为了找到正确的路径，我使用了“find / -name git-http-backend”并将路径更改为：/usr/lib/git-core/git-http-backend/。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-20T21:06:18.197

谢谢你的决定。

我自己也遇到过类似的问题。将 CentOS 升级到 5.10 后，'git packages' 是新的地方：

```
    ls -1 /usr/bin/git-*|head -5
    /usr/bin/git-add
    /usr/bin/git-add--交互式
    /usr/bin/git-am
    /usr/bin/git-annotate
    /usr/bin/git-apply

```

# wcf - 如何使用 Moq 模拟 WCF 客户端？

> ID：14062508
> 
> 赞同：4
> 
> 时间：2012-12-27T23:10:34.980
> 
> 标签：wcf, unit-testing, asynchronous, moq, system.reactive

在我的项目中，我使用的是：SL5+ MVVM+ Prism + WCF + Rx + Moq + Silverlight 单元测试框架。

我是单元测试的新手，最近开始研究 DI、模式 (MVVM) 等。因此，以下代码有很大的改进空间（如果你这么认为，请随意拒绝我采用的整个方法）。

为了访问我的 WCF 服务，我创建了一个如下所示的工厂类（同样，它可能存在缺陷，但请看一看）：

```
namespace SomeSolution
{
    public class ServiceClientFactory:IServiceClientFactory
    {
        public CourseServiceClient GetCourseServiceClient()
        {
            var client = new CourseServiceClient();
            client.ChannelFactory.Faulted += (s, e) => client.Abort();
            if(client.State== CommunicationState.Closed){client.InnerChannel.Open();}
            return client;
        }

        public ConfigServiceClient GetConfigServiceClient()
        {
            var client = new ConfigServiceClient();
            client.ChannelFactory.Faulted += (s, e) => client.Abort();
            if (client.State == CommunicationState.Closed) { client.InnerChannel.Open(); }
            return client;
        }

        public ContactServiceClient GetContactServiceClient()
        {
            var client = new ContactServiceClient();
            client.ChannelFactory.Faulted += (s, e) => client.Abort();
            if (client.State == CommunicationState.Closed) { client.InnerChannel.Open(); }
            return client;
        }
    }
} 
```

它实现了一个简单的接口，如下所示：

```
public interface IServiceClientFactory
{
    CourseServiceClient GetCourseServiceClient();
    ConfigServiceClient GetConfigServiceClient();
    ContactServiceClient GetContactServiceClient();
} 
```

在我的虚拟机中，我正在执行上述类的 DI 并使用 Rx 调用 WCF，如下所示：

```
var client = _serviceClientFactory.GetContactServiceClient();
try
{

    IObservable<IEvent<GetContactByIdCompletedEventArgs>> observable =
        Observable.FromEvent<GetContactByIdCompletedEventArgs>(client, "GetContactByIdCompleted").Take(1);

    observable.Subscribe(
        e =>
            {
                if (e.EventArgs.Error == null)
                {                                    
                    //some code here that needs to be unit-tested

                }
            },
        ex =>
        {
            _errorLogger.ProcessError(GetType().Name, MethodBase.GetCurrentMethod().Name, ErrorSource.Observable, "", -1, ex);
        }
        );
    client.GetContactByIdAsync(contactid, UserInformation.SecurityToken);
}
catch (Exception ex)
{
    _errorLogger.ProcessError(GetType().Name, MethodBase.GetCurrentMethod().Name, ErrorSource.Code, "", -1, ex);
} 
```

现在我想构建单元测试（是的，它不是 TDD）。但我不明白从哪里开始。使用 Moq 我无法模拟 BlahServiceClient。也没有 svcutil 生成的接口可以提供帮助，因为异步方法不是自动生成的 IBlahService 接口的一部分。我可能更喜欢扩展（通过部分类等）任何自动生成的类，但我不愿意选择手动构建 svcutil 可以生成的所有代码（坦率地说，考虑到时间和预算）。

有人可以帮忙吗？任何指向正确方向的指针都会对我有很大帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T15:55:39.213

在模拟您的服务客户端时，您实际上是在模拟它实现的接口之一。所以在你的情况下它可能是`IContactService`。

生成的代码同时实现`System.ServiceModel.ClientBase<IContactService>`和`IContactService`。您的依赖提供者（在您的情况下是工厂）正在返回`ContactServiceClient`- 将其更改`IContactService`为初学者。这将在现在和将来帮助您的 DI。

好的，您已经有了一个抽象工厂，现在它们返回您的服务接口`IContactService`。您现在才使用接口，所以模拟非常简单。

首先对您尝试使用的代码进行一些假设。代码片段提供了抽象工厂和服务客户​​端的消息。假设**此处需要进行单元测试的 //some code** 部分不会与任何其他**依赖**项交互，那么您希望模拟工厂和服务客户​​端，以便您的测试仅与方法隔离正文代码。

为了举例，我做了一个调整。您的界面：

```
public class Contact {
    public string Name { get; set; }
}

public interface IContactService {
    Contact GetContactById(int contactid);
}

public interface IContactServiceFactory {
    IContactService GetContactService();
} 
```

然后你的测试看起来像这样总结：

```
public void WhateverIsToBeTested_ActuallyDoesWhatItMustDo() {

    // Arrange
    var mockContactService = new Mock<IContactService>();
    mockContactService.Setup(cs => cs.GetContactById(It.IsAny<int>()))
        .Returns(new Contact { Name = "Frank Borland" });

    var fakeFactory = new Mock<IContactServiceFactory>();
    fakeFactory.Setup(f => f.GetContactService())
        .Returns(mockContactService.Object);

    /* i'm assuming here that you're injecting the dependency intoto your factory via the contructor - but 
     * assumptions had to be made as not all the code was provided
     */
    var yourObjectUnderTest = new MysteryClass(fakeFactory.Object);

    // Act
    yourObjectUnderTest.yourMysteryMethod();

    // Assert
    /* something mysterious, but expected, happened */            

} 
```

**编辑：模拟异步方法**

异步生成的方法不是您的服务方法的一部分，而是由 WCF 作为 Client 类的一部分创建的。要将它们模拟为接口，请执行以下操作：

1.  提取`ContactServiceClient`类的接口。在 VS 中，只需右键单击（在类名上）、重构、提取接口。并且只选择适用的方法。

2.  该类`ContactServiceClient`是部分的，因此创建一个**新的类文件**并重新定义 ContactServiceClient 类以实现`IContactServiceClient`您刚刚提取的新接口。

    ```
    public partial class ContactServiceClient : IContactServiceClient {
    } 
    ```

像这样，现在客户端类也使用选定的异步方法实现新接口。当刷新您的服务接口并重新生成服务类时 - 您不必重新提取接口，因为您已经使用接口引用创建了一个*单独的部分类。*

3.  新建工厂返回新界面

    ```
    public interface IContactServiceClientFactory {
        IContactServiceClient GetContactServiceClient();
    } 
    ```

4.  修改测试以使用该接口。

# javascript - 如果数字小于 1，则除法和乘法会引发错误

> ID：14062509
> 
> 赞同：-3
> 
> 时间：2012-12-27T23:10:51.767
> 
> 标签：javascript, jquery, math

```
// convert the number to it's standard value (kilogram)
standard  = parseFloat(unit / from);
// now convert it to the new measurement unit
converted = parseFloat(standard * eval(to)); 
```

[http://jsfiddle.net/zeByX/23/](http://jsfiddle.net/zeByX/23/)

如果您输入小于 1 的数字，例如“0.234234234”并尝试通过更改下拉列表转换为新单位。任何小于 1 的数字都会归零。

知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:36:22.887

以下是如何避免`eval`并使您的代码更清晰和更明显，希望这有助于理解为什么您的代码如此错误以及为什么 IMO 您应该回到基础并按照评论中的建议从那里开始。您可以从[MDN](https://developer.mozilla.org/en-US/docs/JavaScript)开始。

```
var units = {
    milligram: 1000000,
    carrat: 5000,
    gram: 1000,
    kilogram: 1,
    ounce: 35.27399072294044,
    pound: 2.2046244201837775,
    stone: 0.157473,
    ton: 0.001
};

var $input = $('#weight_value');    

$('#weight_unit').change(function() {

    var from = $input.data('unit'),
        to = $(this).val(),
        standard = $input.val() / units[ from ],
        converted = standard * units[ to ];

    $input.val( converted ).data('unit', to);

}); 
```

另请注意，我没有使用`parseFloat`or `parseInt`，我只是利用 JavaScript 的类型强制。

​演示 **：http:** [//jsfiddle.net/zeByX/30/](http://jsfiddle.net/zeByX/30/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:38:11.453

尽管错误是由于使用`parseInt()`where you should have used引起的`parseFloat()`，但您的代码还有很多*错误*。

*   `eval()`是邪恶的，并且您在甚至不需要它的地方使用它，或者可以轻松地用更好的解决方案替换它。
    *   `eval(to)`是不必要的，因为`to`已经是一个数字。
    *   在其他情况下，`eval`用于使用字符串来访问全局变量。这是一个*非常糟糕的主意*，将您的单位/值映射存储在对象文字中更为合适，例如`var units = { gram: 1000, kilogram: 1, ... }`，您可以通过简单地使用字符串作为索引来访问该值，例如`unit["milligram"]`.
*   当您已经有一个数字时，您不需要`parseFloat()`，例如 with`unit / from`或`standard * to)`
*   函数中的所有变量声明（ from 除外`from`）都是全局的，因为您缺少`var`前面的关键字。

这是一个有点[“固定”的小提琴](http://jsfiddle.net/MattiasBuelens/p2tPe/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:20:29.513

将更改代码放在 try 块中并捕获异常以查看问题所在。

您可以使用选择列表上的值选项来存储来自通用转换单位的转换单位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:20:49.027

实际上没有抛出错误..

* * *

您描述的具体问题发生是因为您这样做

```
unit = parseInt($('#weight_value').val()); 
```

因此，如果一个值介于 0 和 1 之间，它将变为 0。将其更改为

```
unit = parseFloat($('#weight_value').val()); 
```

* * *

除此之外，还有无效的 html（*如自闭合`select`标签和公开离开`label`*），您正在使用`eval`您确实不应该使用的 html（如*评论中解释/强调的那样*）

# ios - Map Annotation DidSelectAnnotationView w/ Popover 问题

> ID：14062513
> 
> 赞同：1
> 
> 时间：2012-12-27T23:11:11.683
> 
> 标签：ios, xcode, ios5, mapkit, uipopovercontroller

这是我的问题

我有一个带有 TableView 和 MapView 的 splitview 控制器。相当标准的设置。

在 tableview 选择中，我向 mapview 发送通知，以在我拥有的注释中找到我正在寻找的对象的确切 ID，然后选择它。

这是一个示例代码片段。

```
-(void)zoomToLocation:(NSNotification*)notification{
     NSLog(@"zoomToLocation:");
     NSNumber *storeID = [notification object];
     if (storeID ==nil || storeID.intValue == 0) {
         return;
     }
    //Find the store out of Core Data Here
    CLLocation *storeLocation = [[CLLocation alloc]initWithLatitude:zoomStore.latitude.doubleValue longitude:zoomStore.longitude.doubleValue];
    MKCoordinateRegion mapRegion = MKCoordinateRegionMake(storeLocation.coordinate, MKCoordinateSpanMake(0.01, 0.01));
    [self.cMapView setRegion:mapRegion animated: YES];
    for (CustomAnnotationPin *annot in self.cMapView.annotations) {
        if ([annot isKindOfClass:[RBMapAnnotationPin class]]) {
             if(zoomStore.storeID.intValue == annot.storeID.intValue){
                 [self.cMapView selectAnnotation:annot animated:YES];
            }
        }
    }
} 
```

这 100% 正确。我可以随意“缩放”到注释性图钉。真正的问题是我想在选择注释时以编程方式显示一个弹出框。

我正在使用委托函数 didSelectAnnotationView

```
-(void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view{
    if ([view.annotation isKindOfClass:[MKUserLocation class]]) {
        return;
    }
    NSLog(@"DidSelect");
    [self.cMapView deselectAnnotation:view.annotation animated:NO];
    selectedPin = view.annotation;
    if(!mapPop){
        UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:[NSBundle mainBundle]];
        MapCalloutViewController *mapCallout = [storyboard instantiateViewControllerWithIdentifier:@"mapCalloutVC"];
        //Find the store in Core Data with the proper ID from the selected pin ID and give it to the VC for data
        mapPop = [[UIPopoverController alloc]initWithContentViewController:mapCallout];
        [mapPop setDelegate:self];
        [mapPop setPopoverContentSize:CGSizeMake(370, 230)];
        [mapPop presentPopoverFromRect:view.bounds inView:view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
        if ([self.delegate respondsToSelector:@selector(mapStoreSelectionChanged:)]) {
            [self.delegate mapStoreSelectionChanged:mapCallout.store];
        }
    }
} 
```

所以这是一个问题。该代码在模拟器中运行得非常好。我缩放到该位置并调用 mapDelegate 并弹出注释。

在设备上，代码的功能不同。在设备上，我必须双击商店才能显示地图弹出框（我不知道为什么，所以这相当令人沮丧）。

# python - 两次调用 GetListFeed 失败 (gdata.spreadsheet.service.SpreadsheetsService())

> ID：14062516
> 
> 赞同：2
> 
> 时间：2012-12-27T23:11:25.507
> 
> 标签：python, google-docs, google-sheets, google-docs-api, google-spreadsheet-api

我正在使用 gdata-2.0.17.tar.gz。

为什么以下代码在第二个“ssc.GetListFeed 中的行”上失败？

```
#!/usr/bin/python
import gdata.spreadsheet.service

key = '1AjklhasdfLJK09j2f3nFLKnff9hf28fhGFAklnf8223'

ssc = gdata.spreadsheet.service.SpreadsheetsService()
ssc.email = 'something'
ssc.password = 'something'
ssc.ProgrammaticLogin()

for row in ssc.GetListFeed(key=key).entry:
    for key in row.custom:
        print str(key) + ':' + str(row.custom[key].text)
    print

for row in ssc.GetListFeed(key=key).entry:
    for key in row.custom:
        print str(key) + ':' + str(row.custom[key].text)
    print 
```

失败是

```
Traceback (most recent call last):
  File "./test.py", line 16, in <module>
    for row in ssc.GetListFeed(key=key).entry:
  File "/home/someone/something/gdata/spreadsheet/service.py", line 252, in GetListFeed
    converter=gdata.spreadsheet.SpreadsheetsListFeedFromString)
  File "/home/someone/something/gdata/service.py", line 1108, in Get
    'reason': server_response.reason, 'body': result_body}
gdata.service.RequestError: {'status': 400, 'body': 'The spreadsheet at this URL could not be found. Make sure that you have the right URL and that the owner of the spreadsheet hasn&#39;t deleted it.', 'reason': 'Bad Request'} 
```

SpreadsheetsService 对象是否需要在查询之间以某种方式重置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:32:47.623

我相信你的问题是变量`key`- 你在这里定义它：

```
key = '1AjklhasdfLJK09j2f3nFLKnff9hf28fhGFAklnf8223' 
```

但也在这里：

```
for key in row.custom: 
```

由于即使在循环退出后变量仍将保留其定义，请尝试将电子表格键变量名称更改为类似`sheet_key`（或更好的名称:)）并查看它是否按预期完成。您可以在下面的代码中看到行为：

```
In [1]: key = 'abcdef'

In [2]: for key in ['one', 'two', 'three']:
   ...:     pass
   ...: 

In [3]: key
Out[3]: 'three' 
```

# ember.js - 如何使用 ember-data 和 django-tastypie 制作 DS.belongsTo

> ID：14062524
> 
> 赞同：1
> 
> 时间：2012-12-27T23:12:17.543
> 
> 标签：ember.js, tastypie, ember-data

无法想象为什么我无法获得相关项目和模型项目。

我有一个模型

```
App.Staple = DS.Model.extend({
    description: DS.attr('string'),
    name: DS.attr('string'),
    album: DS.belongsTo('App.Album')
});

App.Album = DS.Model.extend({
    description: DS.attr('string'),
    name: DS.attr('string'),
    staples: DS.hasMany('App.Staple')
}); 
```

连接到 django-tastypie。数据样本：

获取 /api/v1/staple/1/

```
{"album_id": "/api/v1/album/1/", "created": "2012-12-27T11:14:38.320364", "description": "asdlfkjasldkfj", "id": 1, "lead_count": 0, "rank": 0, "resource_uri": "/api/v1/staple/1/", "slug": "slug", "status": "public"} 
```

获取 /api/v1/专辑/1/

```
{"album_staples": ["/api/v1/staple/1/"], "created": "2012-12-27T11:14:23.433934", "description": "", "followed_count": 0, "id": 1, "name": "Album Staple", "rank": 0, "resource_uri": "/api/v1/album/1/", "slug": "staple_album", "status": "public"} 
```

问题是

```
console.log(App.Staple.find(1).get('album')) 
```

给出空值。

霍维尔

```
App.Album.find(1).get('staples') 
```

退货还可以。

完整的 js 代码在这里：http: [//jsfiddle.net/zczyX/](http://jsfiddle.net/zczyX/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T10:43:57.797

这是 ember-data-tastypie-adapter 中的一个错误。现在已经修好了。

# wpf - 在 WPF 中设置 datagrid 单元格组合框背景

> ID：14062525
> 
> 赞同：0
> 
> 时间：2012-12-27T23:12:22.080
> 
> 标签：wpf, datagrid, wpfdatagrid

我有显示客户数据的数据网格。有些列有组合框。关于行验证错误，我想将组合框背景更改为红色。我该怎么做？我尝试在 ROW 加载事件上设置新的数据模板，但它不起作用。我也尝试修改现有模板，但我收到错误，它已密封且无法修改。

更新1：我也尝试在这里使用设置器 [http://www.telerik.com/community/forums/silverlight/gridview/rowloaded-event-to-change-font-style.aspx](http://www.telerik.com/community/forums/silverlight/gridview/rowloaded-event-to-change-font-style.aspx)

仍然没有结果。

Update2：我在后面的代码中设置数据模板。喜欢以下

```
 Private Sub SetDataTemplate(e As GridViewAutoGeneratingColumnEventArgs, currentCompPropdefinition As ComponentPropertyDefinition)
    Dim celltemplate = Nothing
    If currentCompPropdefinition.Type = GetType(Boolean) OrElse currentCompPropdefinition.ValidValues IsNot Nothing Then
        If currentCompPropdefinition.Type = GetType(Boolean) Then
            celltemplate = New FrameworkElementFactory(GetType(CheckBox))
            celltemplate.SetBinding(CheckBox.IsCheckedProperty, New Binding(e.Column.Header))
        ElseIf currentCompPropdefinition.ValidValues IsNot Nothing AndAlso currentCompPropdefinition.ValidValues.Count <> 0 Then
            celltemplate = New FrameworkElementFactory(GetType(Telerik.Windows.Controls.RadComboBox))
            celltemplate.SetBinding(ItemsControl.ItemsSourceProperty, New Binding() With {.Source = currentCompPropdefinition.ValidValues})
            celltemplate.SetBinding(ComboBox.SelectedValueProperty, New Binding(e.Column.Header))
            celltemplate.SetValue(ComboBox.BackgroundProperty, FindResource("LightBG")) '(ComboBox.BackgroundProperty, )
        End If
        Dim dataTemplate As New DataTemplate() With {.VisualTree = celltemplate}

        dataTemplate.Seal()
        e.Column.CellTemplate = dataTemplate
    End If
End Sub 
```

# javascript - javascript onload 不工作，但 onclick 工作 css 画线

> ID：14062530
> 
> 赞同：1
> 
> 时间：2012-12-27T23:12:34.583
> 
> 标签：javascript, jquery, css

> **可能重复：**
> [如何将 onload 事件添加到 div？](https://stackoverflow.com/questions/4057236/how-to-add-onload-event-to-a-div)

我正在尝试用 css 和 javascript 画一条线，如下面的示例所示：[example](http://www.gapjumper.com/research/lines.html%20)。我可以让它与原始内容一起正常工作，但是在尝试修改它然后让它从 html onload 工作 onload 等于它不工作，但它正在处理 onclick 事件。

这是我的CSS：

```
.line 
{
    position: absolute;
    height: 0px;
    border-width: 2px 0px 0px 0px;
    border-style: solid;
    border-color: #99aadd;
 } 
```

和javascript：

```
function createLine2(myline,x1,y1,x2,y2)
{
    if (x2 < x1)
    {
        var temp = x1;
        x1 = x2;
        x2 = temp;
        temp = y1;
        y1 = y2;
        y2 = temp;
    }
    var length = Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));
    myline.style.width = length+"px";
    var angle = Math.atan((y2-y1)/(x2-x1));
    myline.style.top = y1 + 0.5*length*Math.sin(angle) + "px";
    myline.style.left = x1 - 0.5*length*(1 - Math.cos(angle)) + "px";
    myline.style.MozTransform = myline.style.WebkitTransform = myline.style.OTransform="rotate("+angle+"rad)";
} 
```

最后是不起作用的html：

```
<div class="line" onload="createLine2(this,100,100,0,0)">test</div><br> 
```

和有效的html：

```
<div class="line" onclick="createLine2(this,100,100,0,0)">test</div><br> 
```

我如何让它与 onload 一起工作，我搞砸了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:21:15.463

div 标签上不允许 onload 事件。仅允许使用以下标签：

```
<body>, <frame>, <frameset>, <iframe>, <img>, <input type="image">, <link>, <script>, <style> 
```

[http://www.w3schools.com/jsref/event_onload.asp](http://www.w3schools.com/jsref/event_onload.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:17:46.613

如果您使用的是 jquery，我建议使用 jquery 就绪功能。

> .ready( handler ) handler 一个在 DOM 准备好后执行的函数。

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

如果您使用纯 JavaScript，请使用 window.onload

> window.onload = funcRef;

[https://developer.mozilla.org/en-US/docs/DOM/window.onload](https://developer.mozilla.org/en-US/docs/DOM/window.onload)

# git - Github API - 获取标签分支

> ID：14062533
> 
> 赞同：2
> 
> 时间：2012-12-27T23:12:46.547
> 
> 标签：git, github, github-api

我目前正在编写一个系统来自动归档我们维护的软件的稳定版本。源代码在 GitHub 中维护，我正在使用 v3 API 提取每个标签，检查它是否存在于我们的系统中，如果它没有存档。我遇到的问题是我想包含附加信息以及我为标签返回的信息。具体来说，我希望能够包含提交该标签的分支。

这可能使用 GitHub API 吗？如果是，有人可以指点我相关的文档。如果不是，一些关于为什么的信息对我很有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:45:17.007

不，这是不可能的。至于为什么：它创建的分支不是标签的属性。事实上，git 根本不知道标签是在哪个分支上创建的。Git 可以通过从所有分支头开始并查看从哪些分支头可以到达标签来猜测这一点。您可以通过运行在 git 中执行此操作：

```
git branch --contains mytag 
```

我猜 github 没有为此操作提供 api，因为它实际上可能需要一些时间，具体取决于 repo 大小。如果您想知道这一点，只需将 repo 克隆到您的服务器并运行上面的命令。

# map - 为什么 clojure 的地图在 println 中表现得那样？

> ID：14062541
> 
> 赞同：16
> 
> 时间：2012-12-27T23:14:25.187
> 
> 标签：map, clojure, println

你好我正在学习clojure，我想了解发生了什么，当我输入

```
(map println '(1 2 3 4)) 
```

我期待像

```
1
2
3
4 
```

但我得到了

```
(1
2
nil 3
nil 4
nil nil) 
```

这只是我编的一个例子。我只是想了解发生了什么。也许与懒惰有关？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-27T23:16:33.777

运行`(map println ...)`的结果是运行 println 的结果的集合，它是 nil。所以结果是`(nil nil nil nil)`REPL 打印的集合。当它打印这个时， println 调用也会在那里打印输出到 REPL，所以你会看到两者混合在一起。

如果您在不打印的情况下定义它：

```
user=> (def result (map println [1 2 3 4]))
#'user/result 
```

最初什么都没有发生，因为结果是懒惰的。如果我们在不使用打印的情况下实现它`dorun`

```
user=> (dorun result)
1
2
3
4
nil 
```

我们看到每个 println 的副作用，然后它的返回值为`dorun`nil。然后我们可以通过评估它来查看结果的内容

```
user=> result
(nil nil nil nil) 
```

并看到它返回一堆`nil`s

# mysql - MySQL 找不到我的文件

> ID：14062542
> 
> 赞同：0
> 
> 时间：2012-12-27T23:14:40.883
> 
> 标签：mysql

我正在尝试将数据从 .csv 文件导入到表中，但 mysql 很难找到它。当我把它放在我的 C 盘而不是文件夹中时，它发现它很好。当我将我想要的文件放在一个文件夹中，然后将文件路径放在我的查询中时，它不起作用。

我正在使用的查询是：

将数据本地 infile '/C:\file_path' 加载到以 ',' 结尾的表 table_name 字段中，由 '"' 括起来以 '\n' 结尾的行忽略 2 行；

我也试过删除“本地”无济于事

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:20:21.323

默认情况下（即除非[`NO_BACKSLASH_ESCAPES`](http://dev.mysql.com/doc/en/server-sql-mode.html#sqlmode_no_backslash_escapes)启用 SQL 模式），您必须在[string literals](http://dev.mysql.com/doc/en/string-literals.html)中转义反斜杠字符。

如[`LOAD DATA INFILE`语法](http://dev.mysql.com/doc/en/load-data.html)中所述：

> Windows 路径名使用正斜杠而不是反斜杠指定。如果确实使用了反斜杠，则必须将它们加倍。

因此，请使用：

```
LOAD DATA [LOCAL] INFILE 'C:\\file_path' ... 
```

或者：

```
LOAD DATA [LOCAL] INFILE 'C:/file_path' ... 
```

# c++ - 递归困境

> ID：14062548
> 
> 赞同：0
> 
> 时间：2012-12-27T23:15:57.277
> 
> 标签：c++, recursion

这两者有什么区别。

```
int find_set ( int v ) 
{
    if ( v == parent [ v ] )
        return v ;
    return parent [ v ] = find_set ( parent [ v ] ) ;
} 
```

和：

```
int find_set ( int v ) 
{
    if ( v == parent [ v ] )
        return v ;
    parent [ v ] = find_set ( parent [ v ] ) ;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:23:15.180

正如@Omri 所说，不同之处在于，如果 if 语句不执行，则第二个没有返回，从而（希望）为没有返回值的代码路径留下编译器错误。与 Ruby 等语言不同，C++ 方法或函数的最后一条语句并不是隐含的返回值。

# php - PHP APC 段错误

> ID：14062550
> 
> 赞同：0
> 
> 时间：2012-12-27T23:16:19.407
> 
> 标签：php, doctrine-orm, apc

> **可能重复：**
> [APC 与 PHP 5.4 兼容吗？](https://stackoverflow.com/questions/9611676/is-apc-compatible-with-php-5-4)

我正试图让 APC 稳定地在（将是）我的生产环境中工作。启用它并使用某些库时，我遇到了段错误。它似乎与教义有关。

在我使用的其他机器上一切都运行良好，这些机器使用的是新版本的 APC 测试版（3.1.13 和 3.1.11）。

我应该可以使用 3.1.13 beta，还是缺少可以解决段错误的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T08:01:02.670

对于 PHP 5.4，最高 3.1.12 的 apc 版本会产生段错误（个人经验）。据说 APC 3.1.13 工作得更好。就个人而言，在稳定的 APC 发布之前，我选择了 xcache。在任何情况下，在生产中使用 beta 系统都需要格外小心。

看看[APC 是否与 PHP 5.4 或 PHP 5.5 兼容？](https://stackoverflow.com/questions/9611676/is-apc-compatible-with-php-5-4) 始终保持最新

# actionscript-3 - 如何从一个类访问事件处理程序到另一个类 as3

> ID：14062551
> 
> 赞同：0
> 
> 时间：2012-12-27T23:16:31.017
> 
> 标签：actionscript-3, class, events

是否可以从一个类访问另一个类的事件处理程序，如果可以，如何访问？我想从对象中删除事件处理程序。我有两个对象说 objectA 和 objectB。在 objectA 内部，如何删除 objectB 的事件处理程序。这是我尝试过的，但它不起作用。

```
MovieClip(root).objectB.removeEventListener(MouseEvent.CLICK, ready); 
```

**细节：**

我有两个名为 Guest 和 Guest2 的课程。我想知道是否可以从 Guest2 类中删除 Guest 类中的事件监听器。下面是完整的代码。注意：两个类的代码完全相同

```
package 
        {
    import flash.display.MovieClip;
        import flash.events.Event;
        import flash.events.MouseEvent;
        import flash.filters.*;

        public class Guest extends MovieClip
        {
            var walkSpeed:Number = 5;
            var oldPosX;
            var oldPosY;

            var myGlow:GlowFilter = new GlowFilter();

            public function Guest()
            {   
                addEventListener(MouseEvent.MOUSE_OVER, addGlow);
            }

            function addGlow(event:MouseEvent):void
            {
                filters = [myGlow];
                addEventListener(MouseEvent.MOUSE_OUT, removeGlow);
                addEventListener(MouseEvent.CLICK, ready);

            }

            function removeGlow(event:MouseEvent):void
            {
                filters = [];
            }

            function ready(event:MouseEvent):void
            {
                filters = [myGlow];
                stage.addEventListener(MouseEvent.MOUSE_DOWN, walk);
                removeEventListener(MouseEvent.MOUSE_OUT, removeGlow);
                **MovieClip(root).Guest02.addEventListener(MouseEvent.CLICK, walkTo);**
            }

            function walk(event:MouseEvent):void
            {
                oldPosX = parent.mouseX;
                oldPosY = parent.mouseY;
                rotation = Math.atan2(oldPosY - y,oldPosX - x) / Math.PI * 180;
                filters = [];
                stage.removeEventListener(MouseEvent.MOUSE_DOWN, walk);
                stage.addEventListener(Event.ENTER_FRAME, loop);
            }

            function loop(event:Event):void
            {
                var dx:Number = oldPosX - x;
                var dy:Number = oldPosY - y;
                var distance:Number = Math.sqrt((dx*dx)+(dy*dy));
                if (distance<walkSpeed)
                {
                    // if you are near the target, snap to it
                    x = oldPosX;
                    y = oldPosY;
                    removeEventListener(Event.ENTER_FRAME, loop);

                }
                else
                {
                    x = x+Math.cos(rotation/180*Math.PI)*walkSpeed;
                    y = y+Math.sin(rotation/180*Math.PI)*walkSpeed;
                }

            }

            **function walkTo(event:MouseEvent):void
            {
                _Guest02.removeEventListener(MouseEvent.CLICK, ready);
            }**

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T04:57:23.510

**笔记**

> 没有两个类应该有完全相同的代码！

它完全没有达到类和对象的目的。

无论如何，如果代码确实不同，请努力在代码中实现继承。

* * *

**回答**

向类添加一个函数并调用它，以使其删除它自己的侦听器。就像是 ：

```
public function removeListeners () {

    this.removeEventListener(MouseEvent.CLICK, ready);
} 
```

并将其称为：

```
objectB.removeListeners(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:53:26.937

在 objectA 中，您应该能够编写：

```
objectB.removeEventListener(MouseEvent.CLICK, ready); 
```

您遇到的问题似乎是您无法获得对 objectB 的引用。我猜是因为您尝试使用“root”获取参考的方式。我建议在 objectA 的构造函数中传递对 objectB 的引用。

```
private var _objectB : ObjectB;

public class ObjectA( objectBRef : ObjectB )
{
    _objectB = objectBRef;
} 
```

然后在需要时执行：

```
_objectB.removeEventListener(MouseEvent.CLICK, ready); 
```

如果您仍然迷路，请发布更多代码。整个 objectA 和 objectB 类会很有帮助。

**编辑：**

在看到您的新细节后，我认为您需要重新考虑如何创建和管理客人的方法。拥有两个具有相同代码的类通常是个坏主意。在我看来，客人类之外的东西应该处理事件处理程序的添加和删除，创建客人的东西可能是一个很好的起点。

# java - 在 GAE 中获取用户昵称

> ID：14062554
> 
> 赞同：3
> 
> 时间：2012-12-27T23:16:53.527
> 
> 标签：java, google-app-engine

我正在使用具有 Google 帐户身份验证的 Google App Engine。我有一个 Google 电子邮件列表，这些电子邮件已用于在我的页面上进行身份验证。如何获取每封电子邮件的用户昵称/名称？我可以使用 User 对象为当前登录的用户获取它，但我没有在 Java 中为常规 Google 电子邮件找到此选项。

Python 实现具有以下功能：`users.User(email)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:37:39.610

看看[文档](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/users/User)。有一个构造函数用于从电子邮件地址和授权域创建用户对象，您可以从中获取昵称。

以下面的@Andrei 的回答为例（我实际上没有编写Java 代码:)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:40:10.317

```
User user = new User(userEmail, "gmail.com");
String nickName = user.getNickName(); 
```

# javascript - $(this).children() 不工作

> ID：14062555
> 
> 赞同：4
> 
> 时间：2012-12-27T23:16:53.743
> 
> 标签：javascript, jquery, html, css

我有以下代码：

```
<tr><td class="style3">test</td></tr> 
```

和

```
$("tr").hover(
  function () {
    $(this).css("background-color","#d9e8cd");
    $(this).css("font-weight","bold");
    $(this).children().css("color","#222222 !important");
  }, 
  function () {
    $(this).css("background-color","");
    $(this).css("font-weight","");
    $(this).children().css("color","#4b4a4a");
  }
); 
```

问题是文本颜色不会改变，我尝试指定 tr 但它不起作用，所以我认为定位 td 会使其工作，因为 style3 类指定了颜色。

当 tr 悬停在上面时，如何使文本的颜色发生变化？

**这是一个在线演示** [http://jsfiddle.net/B7dMd/](http://jsfiddle.net/B7dMd/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:25:34.007

jQuery CSS 不支持重要的语法。如果你真的需要添加“！important”，你可能想试试 CSS DOM cssText：

```
$(this).children().css('cssText', 'color:#222222 !important'); 
```

需要指出的是 - 在大多数情况下，您没有理由在内联样式中添加 !important ，因为内联样式具有高优先级，您只需覆盖另一个 !important 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:31:57.453

当您添加`tr`不在 a 内的 a`table`时，浏览器会在没有表格标签（`td`和`tr`）的情况下解释它，并且只允许文本。如果您在[此处](http://jsfiddle.net/NtE8N/)检查元素，您可以看到此行为。

要解决此问题，请将其添加到表格中。

```
<table>
    <tr>
        <td class="style3">test</td>
    </tr>
<table> 
```

[演示](http://jsfiddle.net/NtE8N/1/)

# c++ - 是否可以在没有 for 循环的情况下将本机结构数组编组为托管数组

> ID：14062563
> 
> 赞同：6
> 
> 时间：2012-12-27T23:17:53.680
> 
> 标签：c++, interop, c++-cli, pinvoke, marshalling

我正在使用本机 DLL。我不确定，但我认为我不能使用 PInvoke decl，因为它不导出任何函数并且没有清单。DLL 附带一个头文件，说明如何使用它。头文件定义了无数的结构、枚举和一个类，使用工厂方法构建，该工厂方法通过 Windows 函数访问`::GetProcAddress`（通过默默无闻的安全性）。此类包含我想在托管代码中使用的功能。

我已经成功地将这个类包装在一个 CLI ref 类中，并且可以在它上面调用一些简单的方法，也可以包装这些方法。

我正在经历将一些结构从头文件转换为托管结构的过程。例如，本机结构：

```
struct FooACL{
    int               action;                
    unsigned long     from,to;               
    char              comment[64]; 
    int               reserved[17];          
}; 
```

变成托管结构：

```
[StructLayout(LayoutKind::Sequential, CharSet = CharSet::Ansi)]
public value struct ManagedFooACL{
     int   action;                
     int   from,to;     
     [MarshalAs(UnmanagedType::ByValTStr, SizeConst = 64)]
     String^    comment;
     [MarshalAs(UnmanagedType::ByValArray, SizeConst = 17)]
     array<int>^ reserved;
}; 
```

据我所知，这应该使托管结构 blittable 吗？以及遵循类似模式或嵌套结构级别的任何其他结构。只要指定了一个布局并且没有一个 blittable 用 MarshalAs 装饰，那么整个结构会是 blittable 吗？

因此，我正在尝试查看是否有一种方法可以使用`Marshal::Copy`或`Marshal::PtrToStructure`将`FooACL*`数组转换为`array<ManagedFooACL>^`.

我从函数调用中获取 FooACL* 数组；我自己不分配。

```
int total;
FooACL* foos = unamagedClass->GetFooACLS(&total); 
```

`total`是获取返回数组大小的输入/输出。

到目前为止我设法做了什么，以及什么工作是：

```
ManagedFooACL first = static_cast<ManagedFooACL>(Marshal::PtrToStructure(IntPtr(&foos [0]), ManagedFooACL::typeid)); 
```

我无法理解的是为什么这不会：

```
array<ManagedFooACL>^ mfoos = gcnew array<ManagedFooACL>(total);
Marshal::PtrToStructure(IntPtr(&foos), mfoos); 
```

这会引发：

```
System.ArgumentException was unhandled
  Message=The specified structure must be blittable or have layout information.
Parameter name: structure
  Source=mscorlib
  ParamName=structure 
```

有没有办法在一次调用中复制数组数据，还是我真的需要做一个 for 循环？所有这些编组功能似乎有点愚蠢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T22:12:24.243

做了一些更多的研究后，答案似乎是否定的。没有循环就不可能自动编组一个`array`of s。`struct`

`struct`我认为编组工作的主要原因`PtrToStructure`是结构是静态/预定义的。编译器知道如何布局内存。由于您获得了动态大小`array`，因此无法提前指定内存布局。所以你必须循环s的动态数量`struct`。

或者，如果你知道你总是会得到一个长度为 X 的数组，你可以定义你自己的托管`struct`持有一个元素，即`ManagedFooACL`带有 a`ByValArray`和`SizeConst`X 值的数组，并将本机`array`转换为`struct`.

# vb.net - 以编程方式更改 App.config 中的端点地址

> ID：14062566
> 
> 赞同：1
> 
> 时间：2012-12-27T23:18:16.047
> 
> 标签：vb.net, uri, endpoint

我有一个用 VB (.net4) 编写的非常简单的 TimeClock 应用程序，我正在尝试添加它。添加将允许用户更改服务的来源。

简而言之，我希望能够以编程方式更改 App.Config 文件中的 。

以供参考：

```
<client>
        <endpoint address="net.tcp://localhost:8090/MyService/TimeClockService"
                  binding="netTcpBinding" 
                  contract="TimeClockService.ITimeClock" 
                  name="tcpBinding">
            <identity>
                <userPrincipalName value="susnick-PC\susnick" />
            </identity>
        </endpoint>
    </client> 
```

我真正想要改变的唯一部分是“地址”。

到目前为止，我在这个网站上看到了一些用 C# 处理这个问题的帮助，但我无法让它正常工作。这是我到目前为止所拥有的。“newIp.text”是一个文本框，允许用户更改 IP 地址。

```
Dim newAddress As String

    newAddress = "http://" & newIP.Text & "/"

Dim uri As Uri = New Uri(newAddress)
    Dim address = New EndpointAddress(uri) 
```

该代码将作为我输入的任何 IP 地址返回新的 uri。但是，它不会使用新设置更新 App.config 文件。任何帮助表示赞赏。

# php - 如果数组为空，则加载消息

> ID：14062567
> 
> 赞同：0
> 
> 时间：2012-12-27T23:18:25.417
> 
> 标签：php, arrays, string

我有以下代码，但我不确定为什么我的数组仍然是空的，因为我的想法是如果 foreach 是空的，它应该加载带有“No Open Homes”的 else 语句：

```
$openHomeTimes = array();

                    if(!empty($detail) && in_array('OpenHomes', $detail))
                    {
                        foreach ($detail['OpenHomes'] as $openHome) 
                        {   
                            $startO        = $openHome['Start'];
                            $finishO       = $openHome['End'];
                            $startConvert  = preg_replace('~\D~', '', $startO);
                            $start         = date('D j M g a',$startConvert / 1000);
                            $finishConvert = preg_replace('~\D~', '', $finishO);
                            $finish        = date('g:ia',$finishConvert / 1000);

                            $openHomeDetail = $start." - ". $finish;

                            $openHomeTimes[] = $openHomeDetail;

                        }
                    }else{
                        if(!empty($openHomeTimes))
                        {
                            $message = 'No Open Homes';

                            $openHomeTimes = $message;

                        }
                    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:27:20.630

如果我没有完全误解你，简单的逻辑修复可能就足够了。该 foreach 不是外部 if/else 构造的条件。

```
 $openHomeTimes = array();

                if(!empty($detail) && in_array('OpenHomes', $detail))
                {
                    foreach ($detail['OpenHomes'] as $openHome) 
                    {   
                        $startO        = $openHome['Start'];
                        $finishO       = $openHome['End'];
                        $startConvert  = preg_replace('~\D~', '', $startO);
                        $start         = date('D j M g a',$startConvert / 1000);
                        $finishConvert = preg_replace('~\D~', '', $finishO);
                        $finish        = date('g:ia',$finishConvert / 1000);

                        $openHomeDetail = $start." - ". $finish;

                        $openHomeTimes[] = $openHomeDetail;

                    }
                }

                //Always check for emptiness
                if(empty($openHomeTimes))
                {
                    $message = 'No Open Homes';

                    $openHomeTimes = $message;
                } 
```

# android - Android：在主屏幕更改应用名称

> ID：14062568
> 
> 赞同：9
> 
> 时间：2012-12-27T23:18:27.470
> 
> 标签：android

我的应用程序在主屏幕上显示其启动活动的名称。我试图通过`android:label`在清单中设置属性来更改名称，`<application>`但无济于事。实现此目的的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T23:29:21.870

使用 android:label 更改启动器活动的名称。似乎对我有用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-28T00:29:36.043

任何带有 android.intent.category.Launcher 的意图过滤器的活动都将显示在应用程序抽屉中。您必须为活动和应用程序设置标签，活动的标签（**android:label="@string/title_activity_main"**）将显示在应用程序抽屉中。

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:configChanges="orientation|keyboardHidden"
        android:label="@string/title_activity_main"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-27T23:49:17.393

为什么不更改清单中的名称，以便它代表您希望它阅读的内容。

在您的清单中，使用您定义 Activity 的元素来获得以下内容：

```
<activity android:name=".YourActivity" android:label="whatever you want"/> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-08T11:46:14.770

仅供参考，以上适用于手机上安装的新副本。如果复制旧副本，有时名称更改将不起作用。卸载以前的版本，如果名称没有更新，则使用以前的名称。

# c# - KeyPress 在整个表单上，而不仅仅是一个对象？

> ID：14062571
> 
> 赞同：1
> 
> 时间：2012-12-27T23:18:59.000
> 
> 标签：c#, .net, events, keypress

我正在用 C# 制作乒乓球，我遇到了一个问题。我有 KeyPreview，这是我的代码

```
private void Form1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == (char)Keys.Up || e.KeyChar == (char)Keys.W) {
        picPaddle.Top -= 10;
    }
    else if (e.KeyChar == (char)Keys.Down || e.KeyChar == (char)Keys.S) {
        picPaddle.Top += 10;
    }
} 
```

当我按下任何键时，什么都没有发生。按键唯一起作用的情况是它测试 (char)Keys.Enter 的条件。为什么是这样？如何使表单采用 KeyPress 键而不是输入键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:26:31.933

尝试改写 KeyDown 方法：

```
protected override void OnKeyDown(KeyEventArgs e) {
  if (e.KeyCode == Keys.Up || e.KeyCode == Keys.W) {
    picPaddle.Top -= 10;
  } else if (e.KeyCode == Keys.Down || e.KeyCode == Keys.S) {
    picPaddle.Top += 10;
  }

  base.OnKeyDown(e);
} 
```

另请参阅[.NET 中的 KeyDown 和 KeyPress 有什么区别？](https://stackoverflow.com/q/1367700/719186)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T23:54:52.923

KeyPress 事件在控件具有焦点时起作用。keydown 事件始终有效。=> 拦截 keydown 事件

# .htaccess - 在重写规则中重用子域

> ID：14062575
> 
> 赞同：0
> 
> 时间：2012-12-27T23:19:21.367
> 
> 标签：.htaccess, mod-rewrite

我有点坚持我的重定向规则。比长篇演讲更好的小例子，这里是大丑：

```
IndexIgnore *
ErrorDocument 404 http://www.example.com
RewriteEngine on
RewriteCond %{HTTP_HOST} !^www\.  [NC]
RewriteRule ^([^\.]+)\.example\.com$ http://example.com/private/$1/public/si.php  [L] 
```

我的目标是获取子域`([^\.]+)`并在重定向中使用它而不是`$1`. 例如，`test.example.com`应该重定向到`http://example.com/private/test/public/si.php`

感谢您的任何帮助。

问候，S。

最终工作的htaccess：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^www\.  [NC]
RewriteCond %{REQUEST_URI} !^/private/
RewriteCond %{HTTP_HOST} ([^\.]+).example.com [NC]
RewriteRule ^ /private/%1/public/$1  [R=301,L] 
```

重定向`anysub.example.com/anypage`到`anysub.example.com/private/anysub/public/anypage`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:42:41.743

用于匹配 a 模式的字符串`RewriteRule`永远*不会*包含主机名，只包含 URI 并且不包含任何查询字符串。如果您要忽略实际的 URI 是什么，那么您不需要在 中使用模式`RewriteRule`来匹配任何内容。您需要使用**%**符号来反向引用以前的分组`RewriteCond`

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} ^([^.]+)\.example\.com$ [NC]
RewriteRule ^ http://example.com/private/%1/public/si.php [L] 
```

您可以`R=301`在规则的方括号中添加一个标志以使重定向永久化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:41:19.217

尝试重写条件反向引用：

```
RewriteCond %{HTTP_HOST} ([^\.]+).example.com [NC]
RewriteRule ^.*$ http://example.com/private/%1/public/si.php [L] 
```

# c# - 实体框架计划查询

> ID：14062576
> 
> 赞同：0
> 
> 时间：2012-12-27T23:19:28.547
> 
> 标签：c#, entity-framework, scheduler

我知道 nhibernate 有一个调度程序，它会以特定的时间间隔执行一个函数。我希望 EF 具有相同的功能。

因此，我想在最初通知用户一周后向他们发送一封电子邮件。无论如何要在服务器上执行此操作，例如每天检查一次数据库并向符合条件的每个人发送电子邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T03:37:52.007

我使用了 fluent 包并使用 fluent 调度程序以特定的时间间隔运行查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:23:31.447

一种选择是创建一个控制台应用程序来满足您的需要，然后使用任务计划程序每天运行该应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T04:01:27.990

您可能还想查看[http://quartznet.sourceforge.net/](http://quartznet.sourceforge.net/)以了解任务调度

# objective-c - UIPickerView - 从委托中获取选择

> ID：14062580
> 
> 赞同：0
> 
> 时间：2012-12-27T23:20:10.040
> 
> 标签：objective-c, ios, cocoa

我正在学习 UIPickerView 对象的使用并以编程方式创建一个。鉴于如果进行了选择，它会使用委托进行调用；将该信息获取到实例化选择器的主视图控制器的标准做法是什么？

我在想我将使用选择器来允许委托将选定的行发送到视图控制器；有没有更好的办法？

经常使用这些对象的人的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:33:48.547

实现委托方法`- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component`，以便无论何时选择一行，它都会调用此方法。

你可以这样做：

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {

    NSLog(@"row %d selected in component %d", row, component);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:34:10.557

通常，您`UIViewController`实例化的`UIPickerView`也将充当其委托（和数据源）。在这种情况下，您可以将视图控制器分配为选取器的委托，例如

```
[myPickerView setDelegate:self]; 
```

然后，您将`- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component`在视图控制器中实现该方法。当您将一个对象指定为另一个对象的委托时，您是在说“嘿，这个对象知道当它收到这些委托消息时该做什么”。就您而言，您是在说：“我的主要控制器知道Picker发送DidSelectrow：Incomponent：Message时该怎么办”。

在这样做时，您不需要做任何使用选择器来允许委托发送选择的行到视图控制器的废话。这就是代表的全部意义所在！`UIPickerView`是将工作“委托”给其他对象（您的控制器），该对象知道如何处理选择器选定行中包含的信息。

# xpath - 可选子字符串字符

> ID：14062587
> 
> 赞同：0
> 
> 时间：2012-12-27T23:20:37.690
> 
> 标签：xpath

我正在使用 XSLT 1.0

我有一个节点，有时其中有一个 ~：

```
<node id="123~001"/> 
```

有时它不会：

```
<node id="123"/> 
```

我想知道 substring-before 命令是否允许可选字符？如果不是，检查 ~ 是否存在的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:31:49.947

只需添加一个 -，那么总会有一个：

```
substring-before(concat(@id, "-"), "-") 
```

# spring - JavaConfig：OpenEntityManagerInViewFilter 未找到 EntityManagerFactory

> ID：14062594
> 
> 赞同：1
> 
> 时间：2012-12-27T23:21:18.757
> 
> 标签：spring

我正在尝试使用 Spring JavaConfig 让我的 spring-application xml-free。

现在我在请求网页时遇到以下错误：

```
org.springframework.beans.factory.NoSuchBeanDefinitionException: No unique bean of type [javax.persistence.EntityManagerFactory] is defined: expected single bean but found 0
    at org.springframework.beans.factory.BeanFactoryUtils.beanOfType(BeanFactoryUtils.java:394)
    at org.springframework.orm.jpa.EntityManagerFactoryUtils.findEntityManagerFactory(EntityManagerFactoryUtils.java:111)
    at org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.lookupEntityManagerFactory(OpenEntityManagerInViewFilter.java:229)
    at org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.lookupEntityManagerFactory(OpenEntityManagerInViewFilter.java:205)
    at org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:152)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) 
```

我的持久性配置：

```
@Configuration
@EnableTransactionManagement
public class PersistenceConfig implements TransactionManagementConfigurer
{

  @Bean(name = "dataSource")
  public DataSource dataSource()
  {
    try
    {
      return (DataSource) new JndiTemplate().lookup("java:comp/env/jdbc/my-db");
    }
    catch (NamingException e)
    {
      throw new ApplicationConfigurationException("db-context not found", e);
    }
  }

  @Bean(name = "entityManagerFactory")
  public EntityManagerFactory entityManagerFactory()
  {
    LocalContainerEntityManagerFactoryBean lcemfb = new LocalContainerEntityManagerFactoryBean();
    lcemfb.setDataSource(dataSource());
    lcemfb.setJpaDialect(new HibernateJpaDialect());
    lcemfb.setJpaVendorAdapter(jpaVendorAdapter());
    lcemfb.setPersistenceUnitName("persistenceUnit");
    lcemfb.setPersistenceXmlLocation("classpath:META-INF/persistence.xml");
    lcemfb.afterPropertiesSet();
    return lcemfb.getObject();
  }

  @Bean(name = "jpaVendorAdapter")
  public JpaVendorAdapter jpaVendorAdapter()
  {
    HibernateJpaVendorAdapter jpaVendorAdapter = new HibernateJpaVendorAdapter();
    jpaVendorAdapter.setShowSql(true);
    jpaVendorAdapter.setDatabase(Database.ORACLE);
    jpaVendorAdapter.setDatabasePlatform(Oracle10gDialect.class.getName());
    jpaVendorAdapter.setGenerateDdl(false);
    return jpaVendorAdapter;
  }

  /**
   * @see org.springframework.transaction.annotation.TransactionManagementConfigurer#annotationDrivenTransactionManager()
   */
  @Bean(name = "transactionManager")
  public PlatformTransactionManager annotationDrivenTransactionManager()
  {
    JpaTransactionManager jpaTransactionManager = new JpaTransactionManager();
    jpaTransactionManager.setEntityManagerFactory(entityManagerFactory());
    return jpaTransactionManager;
  }
} 
```

到目前为止，应用程序中的数据库访问工作正常。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:26:16.190

您可能需要注册容器或进行扫描。看这里[（点我）](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-java)

# objective-c - iOS的无头浏览器？

> ID：14062600
> 
> 赞同：3
> 
> 时间：2012-12-27T23:21:49.680
> 
> 标签：objective-c, ios, headless-browser

基本上，我要做的是创建一个可以访问网站、登录并下载某些信息的应用程序。有人告诉我，最有效的方法是使用“无头 Web 浏览器”，即没有前端的 Web 界面，例如 HTMLUnit。但是，我无法为 Objective-c 找到这样的东西（它是一个 iOS 应用程序）。有谁知道我在哪里可以找到一个？

谢谢，

哈尔加瓦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:40:02.483

你有几个选择。如果它使用 OAuth 或 HTTP 身份验证，并且您只是在下载文件，那么您需要[`NSURLConnection`](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html).

但是，如果涉及到需要显示的 JavaScript 或网页，请查看[`UIWebView`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html).

# c++ - 挂钩函数的返回值

> ID：14062607
> 
> 赞同：1
> 
> 时间：2012-12-27T23:23:03.853
> 
> 标签：c++, hook, detours

我一直在挂钩一些功能以保护我的应用程序，我正在使用 Detours (CDetour)，我正在挂钩[CreateThread](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682453%28v=vs.85%29.aspx)，我的挂钩功能必须与原始功能完全相同。

```
HANDLE WINAPI CreateThreadHook( LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID
            lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId )
{
    //do hooking stuff here
} 
```

钩子工作正常，问题是根据msdn`If the function succeeds, the return value is a handle to the new thread.`但由于函数被钩子，返回值将是我返回的任何内容，将钩子函数更改为void或其他类型只会使调用没有返回值，主要导致崩溃。如何返回原始函数应返回的值？

# javascript - 将 D3 与多维数组/对象一起使用

> ID：14062609
> 
> 赞同：8
> 
> 时间：2012-12-27T23:23:26.120
> 
> 标签：javascript, json, d3.js

我有一个格式如下的 JSON 文件：

```
{
   "John":{
      "name":"John",
      "counts":[ 1, 5, 10, 6 ]
   },
   "Steve":{
      "name":"Steve",
      "counts": [ 6, 4, 50, 40 ]
   }
} 
```

我正在尝试做一个 D3 可视化，为这些计数制作一个简单的柱形图，左侧有一个名称标签。当我有一个数据系列和一个名称时，我可以这样做：

```
svg.selectAll("rect").data([ 1, 5, 10, 6 ]).enter().append("rect")
            .attr("x",function(d,i) { return i*columnWidth; })
            .attr("y",function(d) { return (rowHeight-scale(d));})
            .attr("width",columnWidth)
            .attr("height",function(d) { return snowScale(d); } );

svg.selectAll("text").data("John").enter().append("text")
        .text(function(d) { return d; })
        .attr("x",nameBuffer)
        .attr("y",function(d,i) { return rowHeight; })              
        .attr("font-size", "14px"); 
```

这适用于直接提供数据的单行，文本标签位于左侧，然后是每个数据点的一系列等宽列。但是我才刚开始使用 D3，我一生都无法弄清楚如何将循环通过每个对象并为每个对象创建一个新行的东西链接在一起，每次都增加垂直偏移量。

如何循环遍历，为文件中的每个对象创建一个，然后为每一行创建文本 + 列，同时保留不同的嵌套值和数组索引？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T23:50:34.437

实现您想要的关键是使用嵌套选择。这个想法是将整个数据对象传递到第一级并为元素创建一个 SVG 组。对于这些元素中的每一个，然后以与您现在所做的类似的方式添加实际的可视化。

看看[Mike 的关于嵌套选择的教程](http://bost.ocks.org/mike/nest/)。请记住用相应的元素替换您当前的硬编码数据调用，例如，`.data(d.counts)`而不是`.enter([1, 5, 10, 6])`.

# android - 在android中解析特定的RSS提要

> ID：14062616
> 
> 赞同：0
> 
> 时间：2012-12-27T23:24:44.497
> 
> 标签：android, parsing, rss, tags

我正在尝试在我的 android 应用程序中解析 rss 提要。我的提要包含很多带有“标签”标签的项目，看起来像

```
<item>
<title> title </title>
<link> link </link>
<pubDate> date </pubDate>
<description> description </description>

<tags>
<tag id="1">first</tag>
<tag id="2">second</tag>
<tag id="3">third</tag>
</tags>

</item> 
```

我的问题：我如何才能选择仅具有特定“标签”的项目，例如。标签=“第二”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:19:16.077

重写了我的 Xml Factory 课程，它应该会引导你走上正轨。

```
/**
 * 
 * @author hsigmond
 *
 */
public class RssXmlFactory {

    public static ArrayList<RSSItem> parseResult(final String rssDataContent,String tag_id) throws ParserConfigurationException,
            SAXException, IOException {

        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();

        public String mItemTagID=tag_id;//"2"

        RSSItemsHandler parser = new RSSItemsHandler();
         xr.setContentHandler(parser);
        StringReader sr = new StringReader(rssDataContent);
        InputSource is = new InputSource(sr);
        xr.parse(is);

        return parser.mItemList;

    }

}

class RSSItemsHandler extends DefaultHandler {

    private StringBuilder mSb = new StringBuilder();
    public ArrayList<RSSItem> mItemList = new ArrayList<RSSItem>();
    public RSSItem mCurrentRssItem = null;
    public String mItemTitle="";

    @Override
    public void startElement(final String namespaceURI, final String localName, final String qName,
            final Attributes atts) throws SAXException {
        mSb.setLength(0);

        if (localName.equals(XMLTag.TAG_RSS_ITEM_ROOT)) {
            /** Get the rss item title attribute value */
            mItemTitle=atts.getValue(XMLTag.TAG_RSS_ITEM_TITLE);
            //#TODO Log result
        }

        else if (localName.equals(XMLTag.TAG_RSS_ITEM_TAG_ROOT)) {
        //This is where you check if the TAG equals id=2, did not have the time to check if it works yet, it's late...
        if(atts.getValue(XMLTag.TAG_RSS_ITEM_TAG_ID).equalsIgnoreCase(mItemTagID)){//id="2"
             mCurrentRssItem = new RSSItem();
            /** Set item title attribute value */
            mCurrentRssItem.title=mItemTitle;
                //#TODO Log result
          }     
        }
    }

    @Override
    public void endElement(final String namespaceURI, final String localName, final String qName) throws SAXException {

        if (localName.equals(XMLTag.TAG_RSS_ITEM_ROOT)) {
            mItemList.add(mCurrentRssItem);

        } else if (localName.equals(XMLTag.TAG_RSS_ITEM_TAG_ROOT)) {
            mCurrentRssItem.tag = mSb.toString();         
        } 
    }

    @Override
    public void characters(final char[] ch, final int start, final int length) throws SAXException {
        super.characters(ch, start, length);
        mSb.append(ch, start, length);
    }
}
} 
```

有关如何在 Android 上处理 XML 的更多详细信息，请参见此处：[http ://www.ibm.com/developerworks/opensource/library/x-android/index.html](http://www.ibm.com/developerworks/opensource/library/x-android/index.html)

# python - 可视化 networkx 生成的 graphviz .dot 或 GML 文件的边缘数据

> ID：14062617
> 
> 赞同：1
> 
> 时间：2012-12-27T23:25:00.143
> 
> 标签：python, graphviz, networkx, graph-visualization

我已经用 networkx 生成了一个图形，并将其导出为一个 .dot 文件以进行可视化。

.dot 文件看起来不错，有我创建的节点和节点属性，还有边缘数据（`via`如下），一切就绪。

我的问题是如何在 linux 上可视化这些数据？我试过**gephi**，它看起来是其中最有能力的，但它没有检测到边缘属性（`via`）。

**我需要能够以交互方式探索数据。**

这是一个简化的点文件，它显示了相同的行为

```
strict digraph G {
"README.md";
"src/modules/books/email_bk_title.php" [created="[466]"];
"functions/mysql/tmp" [created="[23, 43]"];
"src/modules/login/login_check.php" [created="[198]"];
"src/post_process_loader.php" [created="[178]"];
"src/style.css";
"src/templates/default/js/bootstrap-tooltip.js" [created="[8]"];
"src/webroot/templates/default/js/bootstrap-modal.js" [created="[23]"];
"src/webroot/templates/default/js/bootstrap-transition.js" [created="[23]"];
"src/templates/default/js/bootstrap-collapse.js" [created="[8]"];
"src/modules/books/tmp";
"src/templates/default/css/bootstrap.css" [created="[8]"];
"LICENSE.txt" [created="[6]"];
"src/templates/default/js/bootstrap.js" [created="[8]"];
"docs/app_skel_design.md" [created="[39]"];
"src/webroot/templates/default/js/bootstrap-button.js" [created="[23]"];
"src/templates/default/js/google-code-prettify/prettify.css" [created="[8]"];
"src/templates/default/js/bootstrap-tab.js" [created="[8]"];
"src/modules/logout/logout_bl.php" [created="[280]"];
"functions/books/tmp" [created="[23, 43]"];
"src/modules/admin/tmp";
"src/modules/register/tmp" [created="[73, 94]"];
"docs/database/db_constraints_behavior.md" [created="[38]"];
"src/webroot/templates/default/js/bootstrap-scrollspy.js" [created="[23]"];
"uploads/tmp" [created="[237]"];
"src/modules/login/login.php" [created="[127]"];
"src/resources/books/books.php" [created="[306, 366, 518]"];
"src/resource_holder.php" [created="[221, 250, 304, 428]"];
"src/modules/session/session_start.php" [created="[177]"];
"src/webroot/templates/default/index.html" [created="[23]"];
".gitignore" [created="[170, 289]"];
"src/functions/mysql/tmp" [created="[44]"];
"src/webroot/templates/default/js/bootstrap.js" [created="[23]"];
"src/modules/user/user_bl.php" [created="[142, 169, 439]"];
"src/modules/logout/logout.php" [created="[156, 270]"];
"src/webroot/templates/default/js/bootstrap-tooltip.js" [created="[23]"];
"src/modules/base/functions.php" [created="[64, 158, 232, 233, 254]"];
"src/resources/base/functions.php";
"docs/roadmap/v0.2.0-v0.4.0.txt" [created="[209]"];
"src/templates/default/js/bootstrap-typeahead.js" [created="[8]"];
"docs/database/mylibrary.sql" [created="[29]"];
"src/resource_holder.php.php" [created="[216]"];
"src/webroot/templates/default/js/bootstrap-popover.js" [created="[23]"];
"src/modules/register/register.php" [created="[93, 110, 455, 457]"];
"src/webroot/style.css" [created="[41, 46, 63, 126]"];
"src/webroot/templates/default/js/jquery.js" [created="[23]"];
"docs/install on windows.md" [created="[500, 501, 502, 503]"];
"src/webroot/templates/default/js/google-code-prettify/prettify.css" [created="[23]"];
"src/templates/default/js/bootstrap-alert.js" [created="[8]"];
"src/modules/books/books_bl.php" [created="[125, 514]"];
"src/webroot/module_holder.php" [created="[51, 89]"];
"src/webroot/templates/default/js/bootstrap-dropdown.js" [created="[23]"];
"src/templates/default/js/README.md" [created="[8]"];
"src/webroot/templates/default/js/bootstrap-typeahead.js" [created="[23]"];
"src/resources/register/register_BL.php" [created="[243]"];
"src/webroot/index.php" [created="[41, 52, 113, 136, 181]"];
"docs/wireframe/my-library.ep" [created="[7]"];
"webroot/uploads/tmp";
"src/functions/base/functions.php" [created="[48]"];
"src/webroot/templates/default/js/bootstrap.min.js" [created="[23]"];
"src/functions/admin/tmp" [created="[44]"];
"src/templates/default/js/bootstrap-carousel.js" [created="[8]"];
"src/modules/recover/tmp" [created="[72, 535]"];
"src/modules/register/content.php" [created="[92, 111]"];
"docs/roadmap/roadmap.md";
"src/resources/authentication/authentication.php" [created="[255, 277, 382, 449, 460, 462]"];
"src/webroot/templates/default/css/bootstrap-responsive.css" [created="[23]"];
"src/resources/admin/admin.php" [created="[403, 414, 419, 484, 487]"];
"src/webroot/templates/default/js/bootstrap-carousel.js" [created="[23]"];
"src/webroot/templates/default/js/bootstrap-collapse.js" [created="[23]"];
"src/modules/books/books.php" [created="[117, 440]"];
"src/functions/user/tmp" [created="[44]"];
"functions/user/tmp" [created="[23, 43]"];
"src/templates/default/js/bootstrap-scrollspy.js" [created="[8]"];
"webroot/style.css";
"src/modules/admin/admin.php" [created="[296, 303, 383, 397, 412, 421, 473, 491]"];
"functions/admin/tmp" [created="[23, 43]"];
"src/webroot/templates/default/js/bootstrap-alert.js" [created="[23]"];
"src/webroot/templates/default/js/google-code-prettify/prettify.js" [created="[23]"];
"src/functions/books/tmp" [created="[44]"];
"src/templates/default/js/bootstrap.min.js" [created="[8]"];
"src/webroot/layout.php" [created="[41, 45, 84]"];
"src/modules/admin/admin_bl.php" [created="[297, 369, 398, 438, 493]"];
"src/webroot/templates/default/css/docs.css" [created="[23]"];
"src/modules/user/tmp";
"src/modules/mysql/tmp";
"src/modules/mysql/connect.php" [created="[91]"];
"src/resources/upload/upload.php" [created="[290, 389]"];
"src/dependency_loader.php" [created="[95]"];
"docs/structure.md" [created="[16, 49]"];
"src/templates/default/js/bootstrap-button.js" [created="[8]"];
"config/mysql_credentials.php-dist" [created="[170]"];
"src/webroot/templates/default/js/README.md" [created="[23]"];
"src/templates/default/js/bootstrap-modal.js" [created="[8]"];
"src/templates/default/index.html" [created="[8]"];
"src/templates/default/js/bootstrap-popover.js" [created="[8]"];
"docs/roadmap/roadmap_gantt.gan" [created="[18]"];
"src/resources/autologin/autologin.php" [created="[241]"];
"src/templates/default/js/bootstrap-transition.js" [created="[8]"];
"src/resources/mysql/mysql.php";
"src/modules/mysql/mysql.php" [created="[82]"];
"src/resources_loader.php" [created="[214]"];
"src/modules/home/home.php" [created="[64]"];
"webroot/index.php";
"src/modules/user/user.php" [created="[141, 164]"];
"README.MD" [created="[0, 1]"];
"src/templates/default/css/docs.css" [created="[8]"];
"docs/features.md" [created="[4]"];
"src/modules/upload/upload_bl.php" [created="[236]"];
"src/templates/default/css/bootstrap-responsive.css" [created="[8]"];
"src/webroot/templates/default/js/application.js" [created="[23]"];
"src/layout.php";
"src/templates/default/js/google-code-prettify/prettify.js" [created="[8]"];
"src/modules/login/login_BL.php" [created="[146]"];
"src/empty" [created="[5, 8]"];
"src/resources/user/user.php" [created="[426, 434, 522]"];
"src/resources/session/session_start.php";
"src/modules/register/validation_mail_content.php" [created="[480]"];
"src/resources/login/login_bl.php" [created="[242]"];
"src/modules/login/login_bl.php";
"src/modules/session/session_destroy.php" [created="[177, 186]"];
"src/pre_process_loader.php" [created="[179]"];
"src/router.php" [created="[78]"];
"src/resources/session/session_destroy.php";
"src/modules/login/tmp" [created="[71, 124]"];
"src/moduleBL_loader.php" [created="[112]"];
"src/webroot/templates/default/js/bootstrap-tab.js" [created="[23]"];
"src/modules/register/register_BL.php" [created="[121, 448]"];
"src/templates/default/js/bootstrap-dropdown.js" [created="[8]"];
"src/module_holder.php";
"src/webroot/templates/default/css/bootstrap.css" [created="[23]"];
"src/modules/upload/upload.php" [created="[235]"];
"src/templates/default/js/jquery.js" [created="[8]"];
"src/templates/default/js/application.js" [created="[8]"];
"todo.txt" [created="[31]"];
"src/style.css" -> "src/webroot/style.css"  [via=99];
"uploads/tmp" -> "webroot/uploads/tmp"  [via=394];
"src/modules/session/session_start.php" -> "src/resources/session/session_start.php"  [via=212];
"src/functions/mysql/tmp" -> "src/modules/mysql/tmp"  [via=64];
"src/modules/base/functions.php" -> "src/resources/base/functions.php"  [via=257];
"docs/roadmap/v0.2.0-v0.4.0.txt" -> "docs/roadmap/roadmap.md"  [via=227];
"src/webroot/style.css" -> "src/style.css"  [via=86];
"src/webroot/style.css" -> "webroot/style.css"  [via=172];
"src/webroot/module_holder.php" -> "src/module_holder.php"  [via=86];
"src/resources/register/register_BL.php" -> "src/modules/register/register_BL.php"  [via=256];
"src/webroot/index.php" -> "webroot/index.php"  [via=172];
"src/functions/admin/tmp" -> "src/modules/admin/tmp"  [via=64];
"src/functions/user/tmp" -> "src/modules/user/tmp"  [via=64];
"src/functions/books/tmp" -> "src/modules/books/tmp"  [via=64];
"src/webroot/layout.php" -> "src/layout.php"  [via=86];
"src/modules/mysql/mysql.php" -> "src/resources/mysql/mysql.php"  [via=211];
"README.MD" -> "README.md"  [via=3];
"src/modules/login/login_BL.php" -> "src/modules/login/login_bl.php"  [via=173];
"src/resources/login/login_bl.php" -> "src/modules/login/login_bl.php"  [via=256];
"src/modules/session/session_destroy.php" -> "src/resources/session/session_destroy.php"  [via=212];
} 
```

在networkx中，我像这样创建它

```
filegraph = nx.DiGraph()

for cid, commit in enumerate(raw.commits):
    raw_creations = [info['path'] for info in raw.commits[cid]['info'] if info['type'] & RawRepo.TYPE_NEW]
    for path in raw_creations:
        if path in filegraph:
            attrs = filegraph.node[path]
            if 'created' in attrs:
                attrs['created'].append(cid)
            else:
                print("not in created")
        else:
            print("created", path)
            attrs = {'created': [cid]}
        filegraph.add_node(path, attr_dict=attrs)
    raw_renames = {info['from']:info['to'] for info in raw.commits[cid]['info'] if info['type'] & RawRepo.TYPE_RENAME}
    for fr, to in raw_renames.items():
        print("rename",fr,"->",to)
        filegraph.add_edge(fr, to)
        filegraph.edge[fr][to]['via'] = cid
        #filegraph.add_edge(fr, to, attr_dict={'via':cid})

nx.drawing.nx_pydot.write_dot(filegraph, 'filenames.dot') 
```

我试过的另一个查看器**ZGRViewer**也没有显示该数据。

# 更新

使用 cytoscape 3.0.0-beta1 时，当导入使用 networkx 导出为

```
nx.readwrite.gml.write_gml(filegraph, 'filenames.gml') 
```

错误是

```
java.text.ParseException: Bad value associated with key modified
        at org.cytoscape.io.internal.read.gml.GMLParser.parseList(GMLParser.java:192)
        at org.cytoscape.io.internal.read.gml.GMLParser.parseValue(GMLParser.java:293)
        at org.cytoscape.io.internal.read.gml.GMLParser.parseList(GMLParser.java:189)
        at org.cytoscape.io.internal.read.gml.GMLParser.parseValue(GMLParser.java:293)
        at org.cytoscape.io.internal.read.gml.GMLParser.parseList(GMLParser.java:189)
        at org.cytoscape.io.internal.read.gml.GMLNetworkReader.run(GMLNetworkReader.java:190)
        at org.cytoscape.work.internal.task.JDialogTaskManager$TaskThread.run(JDialogTaskManager.java:241)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:679)
pool-11-thread-1 WARN [org.cytoscape.work.internal.task.JDialogTaskManager] - Caught exception executing task.
java.lang.RuntimeException: Bad value associated with key modified
        at org.cytoscape.io.internal.read.gml.GMLNetworkReader.run(GMLNetworkReader.java:193)
        at org.cytoscape.work.internal.task.JDialogTaskManager$TaskThread.run(JDialogTaskManager.java:241)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:679) 
```

cytoscape 2.8.3 中的错误如下所示：

![在此处输入图像描述](../Images/43887bda873592b9aae697a6720aa0f9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:19:27.370

对于交互式网络可视化、操作和分析，我强烈推荐[Cytoscape](http://www.cytoscape.org/)。它支持边缘属性，拥有出色的 UI 和活​​跃的开发社区。但是，它*不能*导入 .dot 文件，所以如果你想使用 Cytoscape，你需要回到 NetworkX 并导出为 GML，这很容易从 NetworkX 完成。

我还应该说，虽然我没有使用过 Gephi，但它不支持边缘属性对我来说听起来很奇怪，事实证明它确实支持边缘属性。你可以在这里得到一些基本的了解[。](http://forum.gephi.org/viewtopic.php?t=1792)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-01-31T09:58:50.693

我正在使用graphvis的“渲染”。

```
from graphviz import render 
```

使用下一个功能

```
nx.drawing.nx_pydot.write_dot(self, filename)
render(engine='dot', format=output_format, filepath=filename) 
```

（文件名是点文件，output_format 是 'svg' 或其他可以被常规应用程序解析的好格式）。我通常使用 firefox 打开生成的 svg 文件。

# d3.js - d3 中的可重用图表：创建和更新选择如何工作？

> ID：14062618
> 
> 赞同：6
> 
> 时间：2012-12-27T23:25:01.313
> 
> 标签：d3.js

一些[可重复使用的图表](http://bost.ocks.org/mike/chart/)示例，例如[histogram](http://bl.ocks.org/1933560)，包括以下内容：

```
// select the svg element, if it exists
var svg = d3.select(this).selectAll("svg").data([data]);

// append the svg element, if it doesn't exist
svg.enter().append("svg") ... 
```

...哪里`this`是当前的 DOM 元素，`data`是绑定到它的数据。据我了解，此习惯用法允许在第一次调用图表函数时创建图表，但如果您愿意，则不能在后续调用之后“重新创建”。但是，谁能详细解释这个成语？例如：

*   为什么`.selectAll("svg")`使用而不使用`.select("svg")`？
*   为什么不`.empty()`用于检查空选择？
*   可以将任何单元素数组传递给`.data()`吗？（我假设这个数组的目的只是返回输入选择。）

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T23:44:56.210

第一次调用时，没有 SVG，因此`.enter()`选择将包含传递给它的数据。在随后的调用中，`.enter()`选择将是空的，因此没有添加任何新内容。

关于具体问题：

*   `.selectAll()`返回一个数组，然后可以将其与传递给的数组匹配`.data()`。
*   `.empty()`可以使用，但没有必要 - 如果选择为空，则不会发生任何事情。检查`.empty()`将添加一个`if`语句并具有完全相同的效果。
*   是的。例如，查看[本教程](http://mbostock.github.com/d3/tutorial/circle.html)以获取有关选择的更多详细信息。

# parsing - 在 scala 中使用解析器组合器创建递归数据结构

> ID：14062619
> 
> 赞同：6
> 
> 时间：2012-12-27T23:25:13.700
> 
> 标签：parsing, scala, tree, parser-combinators

我是 scala 的初学者，在[S99](http://aperiodic.net/phil/scala/s-99/)上工作以尝试学习 scala。其中一个问题涉及从字符串转换为树数据结构。我可以“手动”完成它，我还想看看如何使用 Scala 的解析器组合器库来完成它。

树的数据结构是

```
sealed abstract class Tree[+T]
case class Node[+T](value: T, left: Tree[T], right: Tree[T]) extends Tree[T] {
  override def toString = "T(" + value.toString + " " + left.toString + " " + right.toString + ")"
}
case object End extends Tree[Nothing] {
  override def toString = "."
}
object Node {
  def apply[T](value: T): Node[T] = Node(value, End, End)
} 
```

输入应该是一个字符串，如下所示：`a(b(d,e),c(,f(g,)))`

我可以使用类似的东西解析字符串

```
trait Tree extends JavaTokenParsers{
  def leaf: Parser[Any] = ident
  def child: Parser[Any] = node | leaf | ""
  def node: Parser[Any] = ident~"("~child~","~child~")" | leaf 
} 
```

但是如何使用解析库来构建树呢？我知道我可以用它`^^`来将一些字符串转换为整数。我的困惑来自于在创建`Node`. 我该怎么做，或者这是否表明我想做一些不同的事情？

我最好采用解析器返回的东西（`(((((a~()~(((((b~()~d)~,)~e)~)))~,)~(((((c~()~)~,)~(((((f~()~g)~,)~)~)))~)))~))`对于上面的示例输入），并基于它构建树，而不是使用解析器运算符`^^`或`^^^`直接构建树？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T00:21:29.440

可以使用 干净地执行此操作`^^`，并且您非常接近：

```
object TreeParser extends JavaTokenParsers{
  def leaf: Parser[Node[String]] = ident ^^ (Node(_))
  def child: Parser[Tree[String]] = node | leaf | "" ^^ (_ => End)
  def node: Parser[Tree[String]] =
    ident ~ ("(" ~> child) ~ ("," ~> child <~ ")") ^^ {
      case v ~ l ~ r => Node(v, l, r)
    } | leaf
} 
```

现在：

```
scala> TreeParser.parseAll(TreeParser.node, "a(b(d,e),c(,f(g,)))").get
res0: Tree[String] = T(a T(b T(d . .) T(e . .)) T(c . T(f T(g . .) .))) 
```

在我看来，解决此类问题的最简单方法是使用您想要的结果键入解析器方法，然后添加适当的映射操作，`^^`直到编译器满意为止。

# import - 在 Intelij IDEA 中无法识别 Jar 库

> ID：14062625
> 
> 赞同：1
> 
> 时间：2012-12-27T23:25:56.277
> 
> 标签：import, jar, reflections

你好！我是 intelij IDEA 的新手，我无法让[谷歌反射库](http://code.google.com/p/reflections/)在 intelijIDEA 中工作。我已经尝试在许多站点中将其添加为推荐器，方法是转到模块配置，然后是依赖项，单击添加库图标并提供 jar 文件。它在编辑器中被识别（没有用红色下划线），但是当我尝试运行问题时它会抛出一个`java.lang.NoClassDefFoundError: com/google/common/base/Predicate` 所以我猜测导入不起作用。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T16:47:56.673

当然，您还需要添加 guava 库，可能还需要添加其他库。

[我会使用mvnrepository.com](http://mvnrepository.com/)搜索它，然后下载适当的二进制文件并将其添加为库。

如果您还没有使用 maven，请尝试一下，它会为您节省大量时间。否则，请查看 Reflections 库的[pom.xml](https://code.google.com/p/reflections/source/browse/trunk/reflections/pom.xml)，并确定在运行时可能需要哪些其他库。

# silverlight - 垂直方向的silverlight滑块流向

> ID：14062626
> 
> 赞同：0
> 
> 时间：2012-12-27T23:25:58.397
> 
> 标签：silverlight, xaml, slider, orientation

有没有办法改变垂直方向的滑块的流动方向？如果没有，有没有办法将背景颜色更改为没有那种奇怪的阴影效果的颜色？我希望滑块的亮色位于顶部，阴影部分位于底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:04:29.233

感谢所有伟大的回应，但我最终自己解决了这个问题。经过大量研究，我终于发现我应该编辑滑块的模板，并且可以在 Expression Blend 中轻松完成。[我在这里](http://www.windowsphonegeek.com/articles/Customizing-WP7-Slider-in-different-ways)找到了一个很好的模板编辑教程。开始编辑模板后，我转到垂直滑块的垂直填充部分并将透明度更改为 20%，并将垂直滑块的垂直轨道部分更改为 100%。这就是阴影效果的来源。然后，我刚刚切换了垂直填充和垂直轨道的 Fill 属性，这样顶部将由滑块的 Foreground 属性引用，而底部（现在阴影部分）将由滑块的 Background 属性引用。

# mysql - RIGHT JOIN 3 个表到 1 个左表，并将 2 个其他表的列连接到右侧

> ID：14062627
> 
> 赞同：3
> 
> 时间：2012-12-27T23:25:58.973
> 
> 标签：mysql

我正在创建一个社交网络，我有一个非常具体的案例，而且我几乎得到了正确的查询。我有 6 个表要合并到一个查询中。Table`recent`用于查找表`brostplain`、`egobrost`和上的确切行，当在and表`brostpublic`上查找匹配时会变得复杂，其中 members.username 将与列 id 匹配，而 egos.egoname 将与列匹配。所有这些都按 unix 时间戳排序，在 recent.realtime 列中。这是当前的查询：`members``egos``brostplain``brostpublic``egobrost``egoid`

```
 SELECT recent.id, 
          recent.brosttype, 
          recent.postid, 
          recent.realtime, 
          members.username,
          egos.egoname, 
          brostplain.id, 
          brostplain.postid, 
          brostplain.content, 
          brostplain.up, 
          brostplain.down, 
          brostplain.timedata, 
          brostplain.realtime, 
          brostplain.attached, 
          brostplain.replies, 
          brostplain.ext, 
          brostplain.onpage, 
          brostplain.touser, 
          brostplain.isego, 
          brostplain.category, 
          egobrost.egoid, 
          egobrost.postid, 
          egobrost.content, 
          egobrost.up, 
          egobrost.down, 
          egobrost.timedata, 
          egobrost.realtime, 
          egobrost.attached, 
          egobrost.replies, 
          egobrost.ext, 
          egobrost.onpage, 
          egobrost.touser, 
          egobrost.isego, 
          egobrost.category, 
          brostpublic.id, 
          brostpublic.postid, 
          brostpublic.content, 
          brostpublic.up, 
          brostpublic.down, 
          brostpublic.timedata, 
          brostpublic.realtime, 
          brostpublic.attached, 
          brostpublic.replies, 
          brostpublic.ext, 
          brostpublic.category, 
          brostpublic.isego 
     FROM recent 
LEFT JOIN brostplain ON recent.brosttype=brostplain.brosttype 
      AND recent.postid=brostplain.postid 
LEFT JOIN brostpublic ON recent.brosttype=brostpublic.brosttype 
      AND recent.postid=brostpublic.postid 
LEFT JOIN egobrost ON recent.brosttype=egobrost.brosttype 
      AND recent.postid=egobrost.postid 
LEFT JOIN egos ON egos.egoid=egobrost.egoid
     JOIN members ON brostplain.id=members.id OR brostpublic.id=members.id 
    WHERE recent.id='2' ORDER BY recent.realtime DESC 
```

现在这获取了所有相关行，但由于 egos 表的连接方式，它不会返回 egobrost 行的任何结果，我无法弄清楚在哪里放置连接或如何实现它。如果我在 egos 上省略 JOIN 并从我的 SELECT 中删除 egos.egoname，它将显示 egobrost 表上的行没问题，但我需要 egoname 作为我的输出。任何帮助将不胜感激。

编辑（已解决）：经过深思熟虑，我通过将 LEFT 添加到 JOIN 上解决了这个问题`members`。现在结果集就完成了。感谢那些做出贡献的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T10:57:38.723

通过将成员上的 JOIN 更改为 LEFT JOIN 来解决，这与 egos 上的 LEFT JOIN 一致。这是最终的查询：

```
SELECT recent.id, 
          recent.brosttype, 
          recent.postid, 
          recent.realtime, 
          members.username,
          egos.egoname, 
          brostplain.id, 
          brostplain.postid, 
          brostplain.content, 
          brostplain.up, 
          brostplain.down, 
          brostplain.timedata, 
          brostplain.realtime, 
          brostplain.attached, 
          brostplain.replies, 
          brostplain.ext, 
          brostplain.onpage, 
          brostplain.touser, 
          brostplain.isego, 
          brostplain.category, 
          egobrost.egoid, 
          egobrost.postid, 
          egobrost.content, 
          egobrost.up, 
          egobrost.down, 
          egobrost.timedata, 
          egobrost.realtime, 
          egobrost.attached, 
          egobrost.replies, 
          egobrost.ext, 
          egobrost.onpage, 
          egobrost.touser, 
          egobrost.isego, 
          egobrost.category, 
          brostpublic.id, 
          brostpublic.postid, 
          brostpublic.content, 
          brostpublic.up, 
          brostpublic.down, 
          brostpublic.timedata, 
          brostpublic.realtime, 
          brostpublic.attached, 
          brostpublic.replies, 
          brostpublic.ext, 
          brostpublic.category, 
          brostpublic.isego 
     FROM recent 
LEFT JOIN brostplain ON recent.brosttype=brostplain.brosttype 
      AND recent.postid=brostplain.postid 
LEFT JOIN brostpublic ON recent.brosttype=brostpublic.brosttype 
      AND recent.postid=brostpublic.postid 
LEFT JOIN egobrost ON recent.brosttype=egobrost.brosttype 
      AND recent.postid=egobrost.postid 
LEFT JOIN egos ON egos.egoid=egobrost.egoid
LEFT JOIN members ON brostplain.id=members.id OR brostpublic.id=members.id 
    WHERE recent.id='2' ORDER BY recent.realtime DESC 
```

# c++ - 如何让 Google Test 检测 Linux 上的线程数？

> ID：14062628
> 
> 赞同：13
> 
> 时间：2012-12-27T23:25:59.450
> 
> 标签：c++, linux, multithreading, thread-safety, googletest

运行使用 Google 测试框架编写的死亡测试时，会为每个测试生成以下警告：

```
[WARNING] .../gtest-death-test.cc:789:: Death tests use fork(), which is unsafe
particularly in a threaded context. For this test, Google Test couldn't detect
the number of threads. 
```

有没有办法让 Google Test 检测 Linux 上的线程数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-28T00:57:25.603

我查看了源代码，结果发现线程数的检测仅适用于 MacOS X 和 QNX，而不适用于 Linux 或其他平台。所以我通过计算`/proc/self/task`. 由于它可能对其他人有用，我将其发布在这里（我也将其发送到[Google 测试组](https://groups.google.com/group/googletestframework)）：

```
size_t GetThreadCount() {
  size_t thread_count = 0;
  if (DIR *dir = opendir("/proc/self/task")) {
    while (dirent *entry = readdir(dir)) {
      if (strcmp(entry->d_name, ".") != 0 && strcmp(entry->d_name, "..") != 0)
        ++thread_count;
    }
    closedir(dir);
  }
  return thread_count;
} 
```

截至 2015 年 8 月 25 日，Google Test[在 Linux 上](https://github.com/google/googletest/blob/1f87a0970dc0880c954ea4066fd7b72fad6fb089/googletest/src/gtest-port.cc#L104-L108)[实现`GetThreadCount`](https://github.com/google/googletest/blob/1f87a0970dc0880c954ea4066fd7b72fad6fb089/googletest/src/gtest-port.cc#L104-L108)：

```
size_t GetThreadCount() {
  const string filename =
      (Message() << "/proc/" << getpid() << "/stat").GetString();
  return ReadProcFileField<int>(filename, 19);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-20T23:36:20.980

如果您不太关心测试执行时间，一个方便的替代方法是使用：

```
::testing::FLAGS_gtest_death_test_style = "threadsafe"; 
```

更多细节[在这里](https://github.com/google/googletest/blob/master/googletest/docs/AdvancedGuide.md#death-tests-and-threads)。

# php - 为 PHP 构建正则表达式

> ID：14062629
> 
> 赞同：0
> 
> 时间：2012-12-27T23:26:14.413
> 
> 标签：php, regex

我一直在尝试创建一个允许字母、数字和以下字符的正则表达式：_ - ！? . ,

这是我到目前为止所拥有的：

```
/^[-\'a-zA-Z0-9_!\?,.\s]+$/      //not escaping the ? 
```

还有这个版本：

```
/^[-\'a-zA-Z0-9_!\?,.\s]+$/     //attempting to escape the ? 
```

这些似乎都无法匹配以下内容：

“哦，为什么，哦，为什么这个正则表达式不起作用！它变得非常令人沮丧？令人沮丧 - 至少可以这么说。嘿，看，下划线_我想知道这次它是否会匹配？”

有人可以指出我做错了什么吗？我必须指出，我的脚本接受用户输入（在这种情况下是引号中的段落）并去除所有空白，因此实际输入没有空白。

谢谢！

更新：感谢 Lix 的建议，这就是我目前所拥有的：

```
/^[-\'a-zA-Z0-9_!\?,\.\s]+$/ 
```

但是，它仍然无法正常工作？？

UPDATE2 好的，根据输入，这就是正在发生的事情。用户输入字符串，然后我通过以下函数运行字符串：

```
$comment = preg_replace('/\s+/', '',   
htmlspecialchars(strip_tags(trim($user_comment_orig)))); 
```

所以最后，用户输入只是一长串没有任何空格的字符。然后使用以下命令运行该字符串：

```
preg_match("@^[-_!?.,a-zA-Z0-9]+$@",$comment) 
```

什么可能在这里造成麻烦？

最后更新：

最终使用了这个正则表达式：

```
"@[-'A-Z0-9_?!,.]+@i" 
```

谢谢大家！大声笑，一旦你发现我的错误在哪里，你会杀了我的！

好的，所以我有这段代码：

```
if(!preg_match($pattern,$comment) || strlen($comment) < 2 || strlen($comment) > 60){ 
```

天啊！！！我从不费心去看代码的 strlen 部分。当然每次都会失败...我只允许 60 个字符！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:57:57.043

我得到以下代码按预期工作（运行 php5）：

```
<?php
    $pattern = "@[-'A-Z0-9_?!,.\s]+@i";
    $string = "Oh why, oh why is this regex not working! It's getting pretty frustrating? Frustrating - that is to say the least. Hey look, an underscore_ I wonder if it will match this time around?";

    $results = array();
    preg_match($pattern, $string, $results);

    echo '<pre>';
    print_r($results);
    echo '</pre>';
?> 
```

的输出`print_r($results)`如下：

```
Array
(
    [0] => Oh why, oh why is this regex not working! It's getting pretty frustrating? Frustrating - that is to say the least. Hey look, an underscore_ I wonder if it will match this time around?
) 
```

[在http://writecodeonline.com/php/](http://writecodeonline.com/php/)上测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:36:05.410

如有疑问，在类[中转义非字母数字字符](http://php.net/manual/en/regexp.reference.escape.php)以进行匹配总是安全的，因此可以使用以下方法：

`/^[\-\'a-zA-Z0-9\_\!\?\,\.\s]+$/`

当通过[正则表达式 tester](http://www.regextester.com/index2.html)运行时，这可以很好地找到与您的目标的匹配，所以我建议您在其他地方可能会遇到问题，如果这不能解决所有问题。

我假设您在实际尝试匹配时没有包括在目标周围使用的引号？由于您没有在...中构建双引号匹配

> 有人可以指出我做错了什么吗？我必须指出，我的脚本接受用户输入（在这种情况下是引号中的段落）并去除所有空白，因此实际输入没有空白。

在这种情况下，您不需要`\s`它是否正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:46:33.803

在字符类中唯一具有特殊含义的字符是：

*   破折号（因为它可以用作范围的分隔符），除非它在开头使用（因为在这种情况下它不是任何范围的一部分），
*   右括号，
*   反斜杠。

在“纯正则表达式”中，您的字符类可以写成：

```
[-_!?.,a-zA-Z0-9\s] 
```

现在，您需要根据您的语言和字符串的编写方式来转义任何需要转义的内容。鉴于这是 PHP，您可以按原样采用上述示例。请注意，它`\s` *也会*在字符类中进行解释，因此这将匹配字符类之外匹配的任何内容`\s`。

虽然一些手册建议使用转义符以确保安全，但了解字符类的一般正则表达式规则并应用它们会导致结果更短且更易于阅读；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:38:48.003

没有必要在`[]`. 但是，`\s`不会在表达式中执行您想要的操作。您有两个选择：手动展开 ( `/^[-\'a-zA-Z0-9_!?,. \t\n\r]+$/`) 或使用交替 ( `/^(?:[-\'a-zA-Z0-9_!?,.]|\s)+$/`)。

请注意，我在`\`之前留下了，`'`因为我假设您将它放在 PHP 字符串中，并且我不想建议语法错误。

# ruby-on-rails - 如何在 link_to 助手中添加标签？

> ID：14062632
> 
> 赞同：2
> 
> 时间：2012-12-27T23:26:55.083
> 
> 标签：ruby-on-rails

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T23:41:53.407

根据[文档](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)，您需要将（完整）链接文本放入块中，如下所示：

```
<%= link_to(root_path, :class => "btn btn-inverse btn-mini btn-ten")  do %>
   <i class="icon-pencil">Take the pledge</i>
<% end %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T23:52:40.647

```
<%= link_to(root_path, :class => "btn btn-inverse btn-mini btn-ten") do %>
  <i class="icon-pencil"></i>
  Take The Pledge
<% end %> 
```

# vim - Vim 中的文本扩展

> ID：14062634
> 
> 赞同：0
> 
> 时间：2012-12-27T23:26:58.457
> 
> 标签：vim, macros

在 Vim 中，我想输入...</p>

```
1x1<TAB> 
```

并将其扩展为……</p>

```
(r 1)(d 1)(l 1)(u 1) 
```

而对于……</p>

```
2x4<TAB> 
```

扩展到……</p>

```
(r 2)(d 4)(l 2)(u 4) 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T00:53:18.983

如果您只需要一小部分固定的这些，您可以简单地定义`:iabb`（尽管它们将扩展为`Space`，而不是`Tab`）。或者，有像[snipMate](http://www.vim.org/scripts/script.php?script_id=2540)这样的插件——它们甚至`Tab`默认使用扩展。

但是，如果您需要扩展任意数字，则固定方案将不起作用，您必须实现自定义映射，`<Tab>`以提取光标之前的关键字并将其替换为扩展，如下所示：

```
:inoremap <Tab> <Tab>$<Esc>:substitute/\<\(\d\+\)x\(\d\+\)\s*\%#/(r \1)(d \2)(l \1)(u \2)/e<CR>0f$s 
```

这会临时插入一个`$`占位符以恢复替换后的原始光标位置；`getpos()`你可以用/实现更好的东西`setpos()`。

# matlab - 为什么我的 boxcox 转换不会产生正常数据？

> ID：14062635
> 
> 赞同：1
> 
> 时间：2012-12-27T23:27:11.653
> 
> 标签：matlab, normalization, normal-distribution

我正在尝试对一组包含 10 年的每月水质数据进行去季节化处理。由于可能需要 Box-Cox 变换来纠正残差的异方差性和非正态性等异常，因此我在去季节化之前尝试了这种变换。我分别对每个月的数据集应用了转换（ MATLAB 中的[boxcox](http://www.mathworks.com/help/finance/boxcox.html)函数），并使用了 Kolmogorov-Smirnov 检验（MATLAB 中的 kstest 函数）来检查它是否遵循正态分布。但即使在转换之后 p 值非常小并且 kstest 的假设被拒绝！所以我的问题是：我做对了吗（分别在每个月应用转换和 kstest？为什么我在 boxcox 之后没有得到正常的数据集？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T10:50:24.617

Boxcox 转换数据以减少非正态性：

> boxcox 将非正态分布的数据转换为一组具有近似正态分布的数据。

然而，不幸的是，这与它可以获取任何数据集并将其转换为完全正常的数据集不同。

我的猜测是你的数据太乱了，所以即使在使用 boxcox 之后，它仍然无法通过 kolmogorov-smirnov 测试。

# xcode - 预期标识符或“{”标记之前的“(”

> ID：14062637
> 
> 赞同：2
> 
> 时间：2012-12-27T23:27:15.383
> 
> 标签：xcode

不知何故，我在 XCode 4.0.2 中遇到了这个错误，不知道出了什么问题。

文件：HomeViewController.h

```
#import <UIKit/UIKit.h>

@interface HomeViewController : UIViewController <UITabBarDelegate>
{

    UIButton *Button1, *Button2, *Button3;
}
@property (nonatomic, retain) IBOutlet UIButton *Button1;
@property (nonatomic, retain) IBOutlet UIButton *Button2;
@property (nonatomic, retain) IBOutlet UIButton *Button3;

.... other member functions...
....
@end 
```

文件：HomeViewController.m

```
......
#import "RemoteServiceManager.h"

@interface HomeViewController()
{    //This is where the error happens: Expected Identifier or "(" before "{" token 
    RemoteServiceManager* serviceManager;
}
@end

@implementation HomeViewController

@synthesize Button1, Button2, Button3;

.... other member functions
....

@end 
```

看起来它无法识别 RemoteServiceManager。无论我在哪里使用 serviceManager，它都会说 HomeViewController 没有名为 serviceManager 的成员。

有可能是XCode版本引起的吗？我在 Mac OS X 10.6.7 上使用 XCode 4.0.2。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:21:21.527

您可能找到了答案，但我在这里为遇到相同问题的人发布了答案：

正如 Daij 所说，问题出在编译器的版本上，因此要解决此问题，您需要更改编译器设置：

```
Build Setting > Build Options > Compiler for C/C++/ObjectiveC
Change value from "LLVM GCC 4.2" to "Apple LLVM compiler 4.2" 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:08:05.127

旧的 xcode 不能这样做，不。它确实知道类扩展，因为它附带了旧版本的 LLVM 编译器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:32:39.167

您不能将实例变量添加到私有类别。

而是将属性放在那里，并合成它们以获得一个变量以及一个内部 getter/setter

```
@interface HomeViewController 

@property (nonatomic, strong) NSString *privateProperty;

@end 

@implementation HomeViewController 

@synthesize privateProperty = _privateProperty;

@end 
```

或者您可以将实例变量添加到类本身。

```
@implementation HomeViewController
NSString *privateVariable;

@end 
```

也请记住。如果您在另一个文件中创建一个类别，那么您在该类别的主体中声明的任何变量在所有实例中都将是静态的。绝对值得关注。

回顾一下。您可以在主类的界面中创建一个变量。还是在执行主类。

并且私有类别是供您将原型添加到您的类中，这将使文件的其余部分知道它们“将/可用”。

# apache - IndexIgnore * 或 Options -Indexes

> ID：14062641
> 
> 赞同：20
> 
> 时间：2012-12-27T23:27:33.773
> 
> 标签：apache, .htaccess

我一直习惯于`Options -Indexes`通过 .htaccess 禁用目录列表。但是，我看到人们使用它`IndexIgnore *`。有什么不同？哪个比另一个更好？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-12-28T00:55:46.333

该[`IndexIgnore`指令](http://httpd.apache.org/docs/2.2/mod/mod_autoindex.html#indexignore)是一种模式，*如果已`Indexes` **打开***的目录中的文件与该模式匹配，则它们不会显示在自动索引中。

例如，我们有一个目录 , `foo`，并且在该目录中，我们有一个`.htaccess`文件和 3 个文件，`a`,`b`和`c`。

如果在 htaccess 文件中有`Options -Indexes`，那么通过`http://mysite.com/foo/`，我会得到 403 Forbidden 响应，因为没有索引文件（index.html、index.php 等）并且自动索引通过`-Indexes`.

如果在 htaccess 文件中有`IndexIgnore b`，那么通过转到`http://mysite.com/foo/`，我将获得列出文件的自动索引响应，`a`并且`c`. 该`b`文件将丢失，因为它已被忽略。如果我们`IndexIgnore *`在 htaccess 文件中，然后转到`http://mysite.com/foo/`，我们将得到一个空白的自动索引文件，因为所有文件都被忽略了。

至于哪个更好，就看你想要什么了。他们从根本上做两件不同的事情。你想要自动索引吗？如果没有，请将其关闭`Options -Indexes`。如果是这样，请保持打开状态。如果您不希望某些内容显示在自动索引中，请使用`IndexIgnore`.

# python - 使用奇怪的文件夹名称创建的目录名称

> ID：14062644
> 
> 赞同：0
> 
> 时间：2012-12-27T23:28:04.343
> 
> 标签：python, unix

我有以下代码，作为代码的一部分，如果它不存在，它会尝试创建一个文件夹，我看到使用目录名创建的文件夹为“AYH9P4~H”，应该创建文本文件“data_file.txt”中的任何内容”，即“AU_1.2.333”，关于为什么使用文件夹名称“AYH9P4~H”创建它的任何输入，顺便说一句，在 linux 机器上运行此脚本

```
import os

def getAU (aufilename):
    file = open(aufilename,'r')
    return file.read()

def main ():
    aufilename="data_file.txt"
    #ROOT_DIR - The reference android build used to make the builds
    AU=getAU(aufilename)
    if (os.path.isdir("/local/mnt/workspace/builds/" + AU)):
        print "Direcotry local/mnt/workspace/builds/" + AU + "exists"
    else:
        print "Directory doesnt exist,creating directory" + AU + "now"
        os.chdir("/local/mnt/workspace/builds")
        os.makedirs(AU)
    ROOT_DIR= "/local/mnt/workspace/builds/" + AU
    print "ROOT_DIR"
    print ROOT_DIR

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:34:26.513

我最好的猜测是，它`file.read()`实际上会返回所有内容，包括换行符和可能的其他字符。`file.read()`在任何情况下，您都需要清理输出。

其他想法是，如果您尝试在不支持多个扩展名的文件系统上创建这样的文件夹（名称中有多个点），它也会被破坏。

# android - 如何在小部件中使用 onAppWidgetOptionsChanged()？

> ID：14062651
> 
> 赞同：17
> 
> 时间：2012-12-27T23:29:19.107
> 
> 标签：android

我想在每次调整大小时更新我的​​小部件。我发现这是在：

`onAppWidgetOptionsChanged(Context context, AppWidgetManager appWidgetManager, int appWidgetId, Bundle newOptions)`

但我不知道如何更新其中的小部件。我试图通过调用我放入的所有内容来重绘小部件`onUpdate()`，但它不起作用。如何使用捆绑包？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-28T00:05:37.717

> 我想在每次调整大小时更新我的​​小部件。

凉爽的！

> 我发现这是在`onAppWidgetOptionsChanged()`

更准确地说，如果您`<intent-filter>`在 Android 4.1+ 设备上拥有正确的操作，您将通过`onAppWidgetOptionsChanged()`.

> 但我不知道如何更新其中的小部件。

您更新它的方式与更新它的方式相同`onUpdate()`。用适当`updateAppWidget()`的.`AppWidgetManager``RemoteViews`

> 我试图通过调用我放在 onUpdate() 中的所有内容来重绘小部件，但它不起作用。

“它不起作用”并不是对您的症状特别有效的描述。

> 如何使用捆绑包？

对于`Bundle`命名的`newOptions`，您可以通过以下方式找到您的新尺寸范围：

```
newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_WIDTH)
newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_WIDTH)
newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_HEIGHT)
newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_HEIGHT) 
```

例如，[这个示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/AppWidget/Resize)包含一个`AppWidgetProvider`简单地将这些值倒入一个字符串并使用它来更新一个`TextView`. 结果如下所示：

![调整小部件大小，在调整大小操作期间](../Images/1e2e5279fb60a0d83a5f98429097b89a.png)

# php - Steam-Condenser PHP 轮询日志条目

> ID：14062653
> 
> 赞同：1
> 
> 时间：2012-12-27T23:29:25.233
> 
> 标签：php, logging, steam-condenser

我正在寻找从正在进行的 tf2 游戏中积极构建日志文件。使用 logaddress_add rcon 命令，我可以让服务器在日志条目发生时发送它们，但是我在让冷凝器保持活动端口打开并在日志条目到达时检索日志条目方面有点过头了。这样的事情可行吗？

```
 $server = new SourceServer($ip);
 $File = "MyServer.log";
 $fh = fopen($File, 'w');
 while(!$stop)
 {
    set_time_limit(0);
    $reply = $server->Socket->getReply(); //????
    fwrite($fh, $reply);
    if(parseForEnd($reply) == MATCHEND) {
       $stop = True;
    }
 }
 fclose($fh); 
```

我正在考虑扩展 GameServer 或 SourceServer，但我不确定端口是否只要我需要就保持打开状态，或者我是否需要深入研究。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:42:05.633

Steam Condenser 目前不支持收集日志。

无法为传入的日志数据包打开侦听 UDP 套接字。我已经有了在即将发布的版本中添加此功能[的想法，但还没有任何代码。](https://github.com/koraktor/steam-condenser/issues/101)

如果您对 HLDS'/SrcDS 远程日志记录感到满意，请随意贡献。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-16T12:07:50.293

您应该看看 Ruby 中的[Steam HLDS Log Parser](https://github.com/tomav/steam_hlds_log_parser)，从服务器获取日志，解析并返回可用数据。

# javascript - ckeditor getData() 似乎无法正常工作

> ID：14062654
> 
> 赞同：4
> 
> 时间：2012-12-27T23:29:28.100
> 
> 标签：javascript, ckeditor

首先，我将首先说我是 javascript 新手，所以希望这不是一个完整的手掌问题。话虽这么说，以下代码应在用户单击编辑器时提醒编辑器的值。

```
<script type='text/javascript'>
function openEditor(){
html = "Hello World";
config = {
startupFocus : true
};
editor = CKEDITOR.appendTo( 'textBox', config, html );

 if (editor) {
    editor.on('blur', function(event) {
        var ckvalue = CKEDITOR.instances.editor.getData();
        alert(ckvalue);
    });
 }
}
</script>
<html>
<a href='#' onclick='openEditor()'>Open Editor</a><br />
<div id='textBox'></div>
</html> 
```

相反，谷歌浏览器控制台报告：

`"Uncaught TypeError: Cannot call method 'getData' of undefined "`

现在当我改变

```
var ckvalue = CKEDITOR.instances.editor.getData(); 
```

至

```
var ckvalue = CKEDITOR.instances.editor1.getData(); 
```

有用。这让我感到困惑，因为我从未声明 editor1 实例。我希望有更多经验的人可以向我解释为什么 editor1 工作而 editor 不工作。

这是我在谈论的一个工作示例：http: [//jsfiddle.net/s3aDC/6/](http://jsfiddle.net/s3aDC/6/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T09:04:23.237

`editor`是一个指向 的 JS 变量`CKEDITOR.instances.editor1`。看到那个`editor === CKEDITOR.instances.editor1 // true`。

此外，事件回调是在`editor`上下文中执行的，所以`this`指向`editor`：

```
editor.on('blur', function(event) {
    var ckvalue = this.getData();
    alert(ckvalue);
}); 
```

您可以在初始化编辑器时定义它：

```
var editor = CKEDITOR.appendTo( 'textBox', {
    on: {
        blur: function( event ) {
            console.log( this.getData() );
        }
    }
} ); 
```

而且您绝对应该[避免在代码中使用全局变量](http://bonsaiden.github.com/JavaScript-Garden/#function.scopes)！;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T09:03:19.417

CKEditor 从以下位置获取编辑器名称：

1.  如果编辑器未处于“附加到”模式，则 textarea/editable 元素的 id 或 name 属性：[https ://github.com/ckeditor/ckeditor-dev/blob/master/core/editor.js#L71](https://github.com/ckeditor/ckeditor-dev/blob/master/core/editor.js#L71)
2.  生成唯一编辑器名称的函数[https://github.com/ckeditor/ckeditor-dev/blob/master/core/editor.js#L97](https://github.com/ckeditor/ckeditor-dev/blob/master/core/editor.js#L97)

在您的情况下，编辑器是由`appendTo()`方法创建的，因此 CKEditor 会自动生成名称，即`editor1`, then`editor2`等`CKEDITOR.instances`对象包含其名称下的所有编辑器实例，这就是存在的原因`CKEDITOR.instances.editor1`。

您将编辑器实例分配给全局`editor`变量。但这与编辑器名称完全不同——您可以将编辑器实例分配给任意数量的变量。

顺便提一句。在使用变量之前，您应该使用`var`语句声明变量。

# java - 旧设备和 AndroidManifest configChanges "screenSize"

> ID：14062663
> 
> 赞同：1
> 
> 时间：2012-12-27T23:30:39.467
> 
> 标签：java, android, android-manifest, screen-size, android-configchanges

引用文档：

> 注意：从 Android 3.2（API 级别 13）开始，当设备在纵向和横向之间切换时，“屏幕尺寸”也会发生变化。因此，如果您想在为 API 级别 13 或更高级别（由 minSdkVersion 和 targetSdkVersion 属性声明）进行开发时防止由于方向更改而导致运行时重新启动，则除了“orientation”值之外，还必须包含“screenSize”值。也就是说，您必须声明 android:configChanges="orientation|screenSize"

我需要忽略`screenSize`配置更改。我的最低 SDK 级别是 8（Android 2.2），目标 SDK 级别是 13。因此，我需要在清单中引入它。

但是，Eclipse 无法识别它，因为它的 Android 设置设置为 2.2。所以我把它改成了合适的级别，现在它可以正常构建了。

但是，我担心在`screenSize`配置更改尚不可用的旧版本上会出现问题。（例如，当应用程序在 Android 2.2 设备上运行时。）也就是说，应用程序在读取清单时会崩溃，因为`screenSize`它是未知值。还是会在 3.2 之前的设备上简单地忽略它？

PS：我现在没有机会在真实设备上测试它，在如此关键的问题上我不会单独相信模拟器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T23:37:01.337

它会忽略它。分屏操作栏和其他类似的东西也是如此。与 java 不同，android 操作系统无法从它基本上忽略的清单中理解的任何东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-27T23:37:23.227

简短的回答：它被忽略了。

通常，清单中无法识别的值（例如 2.2 之前的设备上的 screenSize）正是由于这个原因而被忽略。否则，开发人员将无法使用新平台版本中添加的功能，而不会破坏旧设备的向后兼容性。

# android - Android TextView getTextSize() 是否包括下降器、上升器

> ID：14062665
> 
> 赞同：6
> 
> 时间：2012-12-27T23:31:18.657
> 
> 标签：android, fonts, textview, font-size

我找不到任何提到如何测量 Textview 中的 getTextSize() 的地方。从视觉测试来看，它似乎不包括下降器，但似乎包括上升器。它似乎也不完全从基线开始。

[http://en.wikipedia.org/wiki/Descender](http://en.wikipedia.org/wiki/Descender)

这是最接近它的提及，但来自 Google 的 Romain Guy 只是忽略了问题的那一部分。

[http://www.mail-archive.com/android-developers@googlegroups.com/msg08514.html](http://www.mail-archive.com/android-developers@googlegroups.com/msg08514.html)

因为我需要这个，因为我正在使用 Compound Drawables，并且我需要能够将 drawable 与不同设备上的文本对齐。

这是我用来在一个接触边缘的圆上测试一个复合可绘制对象的代码

```
tvData.setTextSize(TypedValue.COMPLEX_UNIT_PX, 100);
tvData.setText("agB5ãÂ");

int size = (int)tvData.getTextSize();
Drawable img = getResources().getDrawable(R.drawable.circle_white_full_72 ).mutate();
img.setBounds( 0 , 0 , size , size);
tvData.setCompoundDrawables( null, null, img, null ); 
```

这是结果 ![http://i.imgur.com/zUEzB.png](../Images/d6f1fd3121691e682e7e8b48a1718cfe.png)

如您所见，它似乎没有使用下降器和上升器。

这是可绘制的图像，如果其他人想测试 [http://i.imgur.com/Yhf8b.png](https://i.imgur.com/Yhf8b.png)

使用将图像更改为文本大小的 80% 时

```
int size = (int)tvData.getTextSize() *80/100; 
```

这是结果，图像转置在 100% 图像之上。也许 setCompoundrawables 正在做它自己的缩放

![在此处输入图像描述](../Images/7e1a9ff6f290566e9ae8fe5190200fba.png)

我尝试测量字体和可绘制的中点，但它已关闭。这是突出显示它的图像![在此处输入图像描述](../Images/d252fc1cecf8bff32f9f95746a795ce6.png)

最后，我将可绘制的 50 像素向左移动，然后测量输出，它是字体文本基线到基线高度的一半，因为 setTextSize 设置为 100 像素。

Android 必须使用其他布局来缩放和定位复合可绘制对象。也许我应该为此创建另一个问题。这是一个突出基线到基线的图像。 ![在此处输入图像描述](../Images/0c475864c943f8958b829ff454f7ab62.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:53:20.550

从一些简单的测试来看，它似乎是从上升到下降（文本大小 = 下降 - 上升）。使用 TextPaint 进行了一些调试来验证，更具体一点，我做了：

```
Paint.FontMetricsInt metrics;
for(int i = 1; i < 100; i++) {
    mTextPaint.setTextSize(i);
    metrics = mTextPaint.getFontMetricsInt();
    if((metrics.descent - metrics.ascent) != i) Log.v("type", "Not equal");
} 
```

对于每个值，它仍然是正确的。

# ios - 在 iOS 中以编程方式绘制多条线

> ID：14062667
> 
> 赞同：0
> 
> 时间：2012-12-27T23:31:35.317
> 
> 标签：ios, lines

> **可能重复：**
> [如何在触摸事件上画线？](https://stackoverflow.com/questions/4669490/how-to-draw-line-on-touch-event)

经过大量浏览，我还找不到相关的答案。我想在运行时以编程方式在 iOS UIView 上绘制多条线，即允许用户通过用手指在屏幕上拖动来绘制线。然而，问题是当我画第二条线时，第一条画线被删除了。我希望第一条线保持在其坐标中，用户可以通过在屏幕上拖动来绘制第二条直线。附上代码：

```
CGContextRef context    = UIGraphicsGetCurrentContext();                
CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);    
CGContextSetLineWidth(context, 2.0);        
CGContextMoveToPoint(context, touchPoint.x,touchPoint.y); 
CGContextAddLineToPoint(context, lastTouchPoint.x, lastTouchPoint.y);
CGContextStrokePath(context); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:41:12.913

在每次给`drawRect`您的调用中，都会传递一个`dirtyRect`定义了**您必须完全绘制的区域**的区域，该区域中的旧内容已消失。默认情况下，当您没有更好的逻辑时，您必须绘制视图中的所有内容——所有线条！

这不是更新调用，旧的东西不会被保留。

--

您可以按照它们发生的顺序将所有触摸添加到数组中，并在 drawRect 中绘制每一个。

# maven - 测试自动化 TestLink/Jenkins/Selenium：Maven 问题

> ID：14062669
> 
> 赞同：0
> 
> 时间：2012-12-27T23:31:56.883
> 
> 标签：maven, selenium, jenkins, testng

我使用 testng 从 jenkins 运行测试用例，并借助 TestLink 插件将结果导出到测试链接中。

我有一个小问题，从昨天开始我尝试使用 git 获取测试用例。我可以下载所有的 git repo，但是当我在 jenkins 中构建项目时，maven 尝试编译从 git repo 下载的所有文件（大约 4500 个文件），而我目前只有 5 个测试用例......

我的 Git 仓库看起来像

```
Folder 1 -> ...
Folder 2 -> ...
FolderTest->src->MyTestCasesAreHere.java 
```

有没有办法指定测试用例的路径，或者让 maven 只编译我想要的文件？

我用 Maven 目标“调用顶级 Maven 目标”：`test -DsuiteXmlFiles=suite.xml` 这是正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:34:52.310

如果您只是想构建一个子项目，请更改 Jenkins 作业配置的 Build 部分下的 Root POM 选项。这是假设您使用的是 Maven2/3 作业类型。

此外，如果这不起作用，请考虑将 -f 命令行选项传递给 Maven 以控制您的构建将使用哪个 POM：http: [//www.sonatype.com/books/mvnref-book/reference/running -sect-options.html](http://www.sonatype.com/books/mvnref-book/reference/running-sect-options.html)

# c++ - std::set 迭代器 const 限定符

> ID：14062674
> 
> 赞同：1
> 
> 时间：2012-12-27T23:32:25.643
> 
> 标签：c++

> **可能重复：**
> [C++ STL 集更新很乏味：我无法就地更改元素](https://stackoverflow.com/questions/2217878/c-stl-set-update-is-tedious-i-cant-change-an-element-in-place)

我很难过：

```
struct File {
    struct Handle {
         size_t count;
    }; 
    std::set<Handle>::iterator handle_;
    ~File() {
        File::close(*this);
    }
    static void close(File &f) {
        (*f.handle_).count--;
    }
}; 
```

使用ICC，错误是：

```
error #137: expression must be a modifiable lvalue
(*f.handle_).count++;
^ 
```

为什么 std::set::iterator 是常量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:35:00.450

`std::set::iterator`是一个常量迭代器，因为修改集合中元素的值可能会使元素的总排序和唯一性无效。要修改元素，您需要将其复制出来，擦除元素，修改副本，然后将其放回集合中。

```
Handle handle = *(f.handle_);
set.erase(f.handle_);
handle++;
set.insert(handle);

// or just set.insert(++handle) if you've overloaded prefix increment too 
```

# c# - MVC3 将字典值传递给下拉列表并将关联的键绑定到模型

> ID：14062675
> 
> 赞同：3
> 
> 时间：2012-12-27T23:32:36.177
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我正在尝试创建一个 mvc3 c# webapplication。我想要做的是创建一个 DropDownlist 并将字典传递给它。网络界面中的用户应该会看到字典的值，这很有效。但我不想将选定的值绑定到模型，而是想要关联的键。这有可能吗？

在示例中，您会看到我如何将所选值绑定到模型：

```
@Html.DropDownListFor(model => model.EditDate, new SelectList(Versions.Values), Model.EditDate) 
```

Versions.Values 是 DateTimes（字典的值）。在提交时，选定的值将绑定到 model.EditDate。但我想绑定所选值的关联键（值是 id）。

我怎样才能做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:45:26.683

您需要将 转换`Dictionary<T1,T2>`为`SelectList`，通常使用其中一个`Linq`扩展来完成。所以，如果你有：

```
Dictionary<Int32,DateTime> Versions = new Dictionary<Int32,DateTime> {
  { 1, new DateTime(2012, 12, 1) },
  { 2, new DateTime(2013, 1, 1) },
  { 3, new DateTime(2013, 2, 1) },
}; 
```

然后你可以使用：

```
@Html.DropDownListFor(model => model.EditDate,
  Versions.Select(x => new SelectListItem {
    Text = x.Value.ToShortDateString(),
    Value = x.Key.ToString(),
    Selected = x.Value == Model.EditDate
  })
) 
```

（假设`model.EditDate`是一个，`int`因为您现在正在制作`Keys`字典的`Value`下拉列表。）

# php - 在搜索栏中显示 mysql 查询

> ID：14062680
> 
> 赞同：0
> 
> 时间：2012-12-27T23:32:54.663
> 
> 标签：php, mysql

> **可能重复：**
> [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

如果我在搜索栏上运行下面的查询，为什么我的搜索查询不起作用，它没有返回任何结果，我有一个表格类别，我想从中选择`category_title and category_description`然后将其显示为我的结果，我有一个技术类别及其描述，但是当我运行下面的查询时显示没有结果

```
<?php
$k     = $_GET['k'];
$terms = explode(" ", $k);
echo $terms;

foreach ($terms as $each) {
    $i = "";
    $i++;
    $query = "";
    if ($i == 1)

        $query .= "keywords like '%$each%'";
    else
        $query .= "OR keywords like '%$each%'";
}

$connect = mysql_connect("localhost", "root", "limo");
if (!$connect) {
    die(mysql_error());
}
//Selecting database
$select_db = mysql_select_db("forumShh", $connect);
if (!$select_db) {
    die(mysql_error());
}
$query   = mysql_query($query);
$numrows = mysql_num_rows($query);

if ($numrows > 0) {
    while ($row = mysql_fetch_assoc($query)) {
        $id          = $row['id'];
        $title       = $row['category_title'];
        $description = $row['category_description'];
        echo "<a href='view_category.php?cid=" . $id . "' class='cat_links'>" . $title . " - <font size='-1'>" . $description . "</font></a>";
    }

} else
    echo "No results found for \"<b>$k</b>\"";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:42:21.927

如果您的表结构包含 a`title`和 a`description`那么为什么要`LIKE`在名为 的列上使用运算符`keywords`？

您应该有一个如下所示的最终 SQL 查询：

```
SELECT    *
    FROM  categories
    WHERE (`title` LIKE '%$keyword_1%' OR `description` LIKE '%$keyword_1%')
    OR    (`title` LIKE '%$keyword_2%' OR `description` LIKE '%$keyword_2%')
    OR    (`title` LIKE '%$keyword_3%' OR `description` LIKE '%$keyword_3%'); 
```

你的可能看起来像这样：

```
SELECT    *
    FROM  categories
    WHERE `keywords` LIKE '%$keyword_1%'
    OR    `keywords` LIKE '%$keyword_2%'
    OR    `keywords` LIKE '%$keyword_3%'; 
```

如果`keywords`您的表中没有指定列，则查询将失败并出现错误。

# ruby - 使用 mong-ruby-driver 将 BSON 直接传递给 MongoDB？

> ID：14062682
> 
> 赞同：1
> 
> 时间：2012-12-27T23:33:14.207
> 
> 标签：ruby, mongodb, sinatra

有没有办法将 BSON 对象直接传递到`.find()`mongo-ruby-driver 中？

目前我有一个基本的 sinatra 应用程序，它采用 URL 编码的 JSON 并将其解析为 .find() 但理想情况下我想直接给它 BSON：

```
require 'sinatra'
require 'mongo'
require 'json'

include Mongo
db = MongoClient.new().db('test')

get '/' do
  if request[:query]
    query = JSON.parse(CGI::unescape(request[:query]))
    db.collection('test_collection').find(query).to_a.to_json
  end
end 
```

所以基本上有一些类似的东西`BSON.parse(url-encoded-query)`并且能够将它传递给`.find()`返回结果。

示例 URL：`http://localhost:4567/?query=%7B%20%22name%22%20%3A%20%22john%20doe%22%20%7D`
当前查询：`{ "name" : "john doe" }`
BSON 查询：`{ name: /.*john.*/, interests: [ 'fishing', 'golf' ]}`我想工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:13:35.550

您的问题与解析 JSON 或 Ruby（Regexp）有关，而不是与 BSON 有关。您最初的问题直接跳到 BSON 会引起混淆。使用当前的 Ruby 驱动程序，BSON 不直接暴露给应用程序编写者，而是尽可能自然地映射到 Ruby 对象和映射到 Ruby 对象。

JSON 受到严格限制且解析安全。为 Regexp 添加解析超出了此范围。

你可以使用 Kernel#eval 不安全地做你想做的事。这将解析您的 Regexp，但它也会解析 exec、system、反引号等。对于具有任意用户输入的公共应用程序，您必须做一些更安全的事情。

另请注意，以下行之间的差异突出了 Ruby 和 MongoDB 的语义：

```
{ interests: [ 'fishing', 'golf' ] } 
```

如果它们完全是 ['fishing', 'golf']，则上述内容完全匹配兴趣。没有更多，没有更少，没有其他顺序。

```
{ interests: { '$in' => [ 'fishing', 'golf' ] } } 
```

如果兴趣有“钓鱼”或“高尔夫”、任何顺序、任何位置、任何额外内容，则上述匹配兴趣。请注意，字符串键 '$in' 需要原始 => 语法。

希望这有助于您的理解，请随时跟进澄清问题。

以下是一个工作示例。

我的应用程序.rb

```
require 'sinatra'
require 'mongo'
require 'json'

include Mongo
db = MongoClient.new().db('test')

get '/' do
  if request[:query]
    query = eval CGI::unescape(request[:query])
    docs = db.collection('test_collection').find(query).to_a.to_json
    "docs=#{docs}"
  end
end 
```

myapp_test.rb

```
require 'myapp'
require 'test/unit'
require 'rack/test'
require 'open-uri'
ENV['RACK_ENV'] = 'test'

class MyAppTest < Test::Unit::TestCase
  include Rack::Test::Methods

  def setup
    @db ||= Mongo::MongoClient.new['test']
    @coll ||= @db['test_collection']
    @coll.remove
    @coll.insert({name: 'john doe', interests: [ 'fishing', 'golf' ]})
  end

  def app
    Sinatra::Application
  end

  def query_test(query)
    uri = "http://localhost:4567/?query=#{URI::encode(query)}"
    puts "uri=#{uri}"
    get uri
    puts last_response.body
    assert_match(/^docs=/, last_response.body)
  end

  def test_john_doe
    query_test("{ name: 'john doe'}")
  end

  def test_regexp
    query_test("{ name: /.*john.*/, interests: [ 'fishing', 'golf' ]}")
  end
end 
```

红宝石-I。myapp_test.rb

```
Run options:

# Running tests:

uri=http://localhost:4567/?query=%7B%20name:%20/.*john.*/,%20interests:%20[%20'fishing',%20'golf'%20]%7D
docs=[{"_id":{"$oid": "50e9e60029daeb0be1000001"},"name":"john doe","interests":["fishing","golf"]}]
.uri=http://localhost:4567/?query=%7B%20name:%20'john%20doe'%7D
docs=[{"_id":{"$oid": "50e9e60129daeb0be1000002"},"name":"john doe","interests":["fishing","golf"]}]
.

Finished tests in 0.065822s, 30.3850 tests/s, 60.7700 assertions/s.

2 tests, 4 assertions, 0 failures, 0 errors, 0 skips 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:36:55.600

以下测试脚本演示了如何使用 $elemMatch 运算符作为投影。请注意，Collection#find 方法为 "selector" 形式参数和 "opts" :fields 选项获取任意文档。

MongoDB 文档映射到/来自 Ruby Hash 对象，这些文档可以完全包含 MongoDB 运算符。

elemmatch_projection.rb

```
#!/usr/bin/env ruby

# Ruby translation of example from http://docs.mongodb.org/manual/reference/projection/elemMatch/
require 'mongo'
coll = Mongo::MongoClient.new['test']['students']
coll.remove
coll.insert({
  zipcode: 63109,
  dependents: [
    { name: "john", school: 102, age: 10 },
    { name: "jess", school: 102, age: 11 },
    { name: "jeff", school: 108, age: 15 }
  ]
})
p coll.find( { zipcode: 63109 }, :fields => { dependents: { '$elemMatch' => { school: 102 } } } ).to_a 
```

ruby elemmatch_projection.rb

```
[{"_id"=>BSON::ObjectId('50eab29929daeb05ae000001'), "dependents"=>[{"name"=>"john", "school"=>102, "age"=>10}]}] 
```

这是另一个答案，因为 OP 已经明确澄清了这个问题。

希望这可以帮助您了解如何在 Ruby 中使用 MongoDB 文档和运算符。

# android - noclassdeffounderror net.fortuna.ical4j.data.CalendarBuilder

> ID：14062688
> 
> 赞同：0
> 
> 时间：2012-12-27T23:34:07.157
> 
> 标签：android, import, jar, icalendar

我正在使用 ical4j 读取 ical 文件。我正在使用带有 Eclipse 的 android adt。我从他们的网站下载了最新的二进制文件（.zipped）版本 1.0.4。它在 libs 文件夹中有所有依赖项（可执行的 jar 文件）。jar 文件已成功添加到类路径中，并且 eclipse 给出了建议和代码完成，我猜这表明导入成功。

但是，当我运行该项目时，我收到一个错误，即找不到类“ **net.fortuna.ical4j.data.CalendarBuilder** ”并且程序终止。我还没有调试过其他运行时错误（如果有的话），但我无法解决这个问题。我查找了当我提取下载的 zip 文件时得到的文件夹，并且 calendarbuilder 类似乎与 jar 文件打包在一起。为什么我会在 logcat 中收到此错误消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T06:59:18.750

我在这个论坛上看到有类似问题的人。我尝试为普通的 java 项目导入文件，它就像一个魅力。问题是作为 Android 系统核心的 Dalvik JVM 如果我们只是引用它，它就无法识别外部 jar 的导入。我在[这里](https://stackoverflow.com/questions/3642928/adding-a-library-jar-to-an-eclipse-android-project)找到了解决方案。

这非常有效，但是如果您使用的是 ical4j，我们不必将所有 jar 包都包含在 lib 文件夹中。我们只需要编译时依赖项，否则 Eclipse 工作区将冻结，并且您的设备或 AVD 不会显示应用程序并显示“超出 GC 开销限制”的日志错误。希望这可以帮助某人。

# memory-management - Fortran 动态对象

> ID：14062692
> 
> 赞同：1
> 
> 时间：2012-12-27T23:34:12.317
> 
> 标签：memory-management, fortran

我正在尝试创建一个将数据作为指针返回的子例程：

我想要这样的东西：

```
subroutine f(p)
     type(tra), pointer p
     type(tra), target :: instance

     p=>instance
     do_work(instance)
end subroutine 
```

严格来说，我想实现 C++“新”运算符的类似物。

然后我想使用如下这样的子程序：

```
subroutine other
    type(tra), pointer :: p1,p2
    call f(p1)
    call f(p2)
end subroutine 
```

上面的代码可能不起作用，因为我认为 f 中的“实例”在 f 退出后被销毁，并且 f 的下一次调用在内存中的同一位置再次创建“实例”。

特别是我发现 with`p1`并`p2`指向相同的对象，但我想这是依赖于编译器的。**是真的**吗？

我认为一个可能的解决方案是：

```
subroutine f(p)
     type(tra), pointer p
     type(tra), allocatable, target :: instance(:)

     p=>instance(1)
     do_work(instance(1))
end subroutine 
```

这是“官方”的做事方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:49:56.520

> 严格来说，我想实现 C++“新”运算符的类似物。

它是`ALLOCATE`。你想要做的事情应该是这样的：

```
subroutine f(p)
     type(tra), pointer :: p

     ! you can actually leak memory this way! caution required.
     if(associated(p)) then
         stop "possible memory leak - p was associated"
     end
     allocate(p)
     do_work(p)
end subroutine 
```

> 上面的代码可能不起作用，因为我认为 f 中的“实例”在 f 退出后被销毁，并且 f 的下一次调用在内存中的同一位置再次创建“实例”。

不，这不是真的。局部子程序变量通常被“分配”一次（甚至只初始化一次），参见例如 Fortran 90 规范，第 14 章，尤其是第 14.7 节。

# t4 - 查找属性是 POCO 模板 t4 生成器中的主键

> ID：14062694
> 
> 赞同：11
> 
> 时间：2012-12-27T23:34:22.487
> 
> 标签：t4

我正在使用 VS 2012 附带的 POCO t4 模板生成器。我做了一些更改以包含 Entity.Name，但我无法找出主键。

```
public string EntityClassOpening(EntityType entity)
{
    return string.Format(
        CultureInfo.InvariantCulture,
        "{0} {1}partial class {2}{3}<{4},{5}>{6}",
        Accessibility.ForType(entity),
        _code.SpaceAfter(_code.AbstractOption(entity)),
        _code.Escape(entity),
        ": EntityBase",
        entity.Name,
        entity.Name,
        _code.StringBefore(" ", _typeMapper.GetTypeName(entity.BaseType)));
} 
```

我找不到从 EntityType 对象层次结构中找到主键的方法。它公开属性，但该属性没有任何说明它是主键的信息。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-02-08T17:11:08.883

以防万一有人在迁移 RIA 服务时尝试这样做，我在 VS2013 中使用标准 dbcontext 模板，并在实体模板中添加了两件事。

首先你需要：

```
using System.ComponentModel.DataAnnotations; 
```

我把它放在靠近顶部的 //---- 块下面。

然后我修改了一些看起来像这样的代码。只需搜索名字。我的更改是 ef.IsKey... 并添加 Key() 属性。

```
 var simpleProperties = typeMapper.GetSimpleProperties(entity);
    if (simpleProperties.Any())
    {
        foreach (var edmProperty in simpleProperties)
        {
#>
 <#if (ef.IsKey(edmProperty))
   {#>      [Key()]
   <#}#>
    <#=codeStringGenerator.Property(edmProperty)#>
<#
        }
    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-15T21:05:55.380

使用[EntityType.KeyMembers](http://msdn.microsoft.com/en-us/library/system.data.metadata.edm.entitytypebase.keymembers.aspx)属性获取主键包含的属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-01-31T06:57:01.613

我将此添加到 TypeMapper 部分，对结果感到满意：

```
public IEnumerable<EdmProperty> GetPrimaryKeyProperties(EntityType type)
{
    return type.KeyMembers.Select(s => (EdmProperty)s);
} 
```

# c# - Sharepoint Web 服务查询忽略查询参数

> ID：14062697
> 
> 赞同：0
> 
> 时间：2012-12-27T23:35:05.110
> 
> 标签：c#, web-services, sharepoint, sharepoint-2010

我正在尝试使用 CalmQuery 通过 Web 服务查询 Sharepoint 2010。

我通过一个冷静查询构建器创建了冷静查询，所以我很确定查询是正确的，但是 GetListItems() 忽略了这个查询，只是获取列表中的每个项目：

这是我的代码：

```
 /* Query */
        XmlDocument calmDocument = new XmlDocument();
        XmlNode camlNode = calmDocument.CreateElement("Query");

        camlNode.InnerText = "<Where>" +
                            "<Eq>" +
                             "<FieldRef Name='Office_x0020_Staff' />" +
                             "<Value Type='Boolean'>Yes</Value>" +
                            "</Eq>" +
                            "</Where>";

        XmlNode Test = GetService().GetListItems("Staff", null, camlNode, null, null, null, null);

        for (int i = 0; i < Test.ChildNodes[1].ChildNodes.Count; i++)
        {
            if (Test.ChildNodes[1].ChildNodes[i].Attributes != null)
            {
                MessageBox.Show(Test.ChildNodes[1].ChildNodes[i].Attributes["ows_Title"].InnerText;                                            
            }

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:11:58.453

解决了。傻我：

```
 "<Value Type='Boolean'>1</Value>" + 
```

# delphi-xe2 - JEDI可视化组件库中的对接组件能否帮助编程10个滚动文本窗口

> ID：14062698
> 
> 赞同：1
> 
> 时间：2012-12-27T23:35:04.753
> 
> 标签：delphi-xe2, jedi, jvcl

我想向 Delphi XE2 应用程序添加 10 个可停靠窗口。每个窗口都将显示从外部传感器网络接收到的文本行，每个传感器都有一个不同的窗口。

这些页面和其他地方的信息表明 JEDI 视觉组件库可能有一些很好的组件来帮助解决这个问题。

具体来说，我找到了这个文档：

> 合资对接
> 
> Docking Server 和 DockingStyle 组件。停靠看起来与标准的 delphi 停靠相同（拖动时没有停靠指示器），只有停靠窗口的标题会根据样式进行更改。

JEDI 可视化组件库是否包含可以简化 10 个可停靠滚动文本窗口的编程工作的组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:47:35.993

`JvDocking`控件允许轻松停靠窗口；这些窗口可以包含您想要的任何内容，包括 Delphi 的标准`TScrollBox`. JVCL 也有一些可滚动的面板。

如果您对 JVCL 库中的内容有疑问，最好的办法是下载它并查看它包含的文件。如果您下载手动安装 (zip) 文件，则无需安装即可。

请注意，JEDI 库的主要问题是它们缺少大多数组件（或 JEDI 代码库中的函数）的文档，因此您需要善于阅读组件和（有限的）演示源文件。还包括*很多*组件，包括许多重复的功能；通常很难找到它们之间的细微差别，而且许多都没有文档或演示。

# java - 使用 return 语句重构代码

> ID：14062700
> 
> 赞同：4
> 
> 时间：2012-12-27T23:35:13.193
> 
> 标签：java, refactoring

带有 checkcustomers 的“if”块在该类的其他方法中完全使用，因此对于相同的检查有很多代码重复。但我也不能直接将此检查内容提取到一个方法中，因为它们具有返回值。

重构此代码的一些好主意？我刚刚修改了这段代码以简化这里，所以不要被这段代码中的小问题所困扰（如果有的话），基本上问题是如何将一段代码提取到一个方法中（因为它在其他方法上重复）有在当前方法中有很多回报。

```
public Details getCustomerDetails(){

   if(checkifcustomerhasnoboobs){    
    ..worry about it..
   return new Details("no");
  }

   if(checkifcustomerplaytenniswell){    
    ..do find a tennis teacher
    return new Details("no cantplay");
  }
  //...ok now if customer passed the test, now do the some real stuff
  //
  //
  CustomerDetails details= getCustomerDetailsFromSomewhere();

  return details;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:41:55.850

这个怎么样？

```
public Result checkSomethings() {
  if ( checksomething1 ) {
    return ResultCheckSomething1;
  }
  if ( checksomething2 ) {
    return ResultCheckSomething2;
  }
  return ResultCheckNone;
}

public Details getCustomerDetails(){
  Result result = checkSomethings();
  switch ( result ) {
    case ResultCheckSomething1:
      return new Details("message1");
    case ResultCheckSomething2:
      return new Details("message2");
    default:
      return getCustomerDetailsFromSomewhere();
  }
} 
```

代码将`Result...`在一个枚举中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:44:21.023

也许是这样的？

```
 public Details getCustomerDetails(){
       boolean isError = checksomething1() || checksomething2();
       String message = checksomething1() ? "message1" : "message2";
       return isError ? new Details(message) : getCustomerDetailsFromSomewhere();
} 
```

如果您尝试避免两次调用检查功能，请保留结果

```
public Details getCustomerDetails(){
   boolean check1 = checksomething1();
   boolean check2 = checksomething2();
   String message = check1 ? "message1" : "message2";
   return (check1 || check2) ? new Details(message) : getCustomerDetailsFromSomewhere(); 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T23:46:04.347

将返回值替换为对结果变量的赋值，该变量在第一次赋值之前保持为空。如果更改结果的条件为假，则每个块都可以被一个返回 null 的函数替换。

正如赫尔曼在评论中指出的那样，这仅在 null 不是其中一个调用的可能结果时才有效。

```
public Details getCustomerDetails(){
   Details result = null;

   if(checksomething1){    
    ..error
     result = new Details("message1");
  }

  if(result == null) {
    if(checksomething2){    
    ..error
    result = new Details("message2");
  } 

  if(result == null){

    result = getCustomerDetailsFromSomewhere();
  }

  return result;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-27T11:17:25.410

使用 Java 8，您可以重构为返回`Optional<...>`值的方法。像这样的语句`return x;`将被替换为`return Optional.of(x)`（假设 x 不能为空）。最后的默认返回语句是`return Optional.empty()`.

然后，您可以用于`return optional.orElseGet(() -> ...))`计算未达到任何原始 return 语句的情况的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-18T20:05:36.260

我会这样做：

```
public Details getCustomerDetails(){  

  Details invalidDetails = checkForInvalidCustomer();
  if (invalidDetails !=null) {
     return (invalidDetails);
  }

  //...ok now if customer passed the test, now do the some real stuff
  //
  //
  CustomerDetails details= getCustomerDetailsFromSomewhere();
  return details;
}

public Details checkForInvalidCustomer() {
   if(checkifcustomerhasnoboobs){    
    ..worry about it..
    return new Details("no");
   }
   if(checkifcustomerplaytenniswell){    
    ..do find a tennis teacher
    return new Details("no cantplay");
  }
  // nulls means valid customer
  return (null);
} 
```

基本上，对于您的具体示例，我使用 null 以便我可以区分没有条件匹配的情况与任一条件匹配的情况。这样我就可以使用一个 if 语句。现在，如果您想返回 null，则需要稍微修改此解决方案，也许使用一些常量来标记案例而不是使用 null。

# java - 如何在 Java 中将子字符串与普通空格进行比较

> ID：14062701
> 
> 赞同：1
> 
> 时间：2012-12-27T23:35:20.613
> 
> 标签：java, string, compare, substring, whitespace

抱歉，这似乎是一个愚蠢的问题，但我无法弄清楚如何将 Java 中用户输入的子字符串与空白进行比较。在我的程序中，我使用

```
 Input.getString() 
```

这不常见，但 Input.class 用于接收用户的输入。这是我的程序：

```
public class Project1
{
static String E [] = { "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", " " };
static String M [] = { ".-", "-...", "-.-.", "-..", ".", "..-.", "--.", "....", "..", ".---", "-.-", ".-..", "--", "-.", "---", ".--.", "--.-", ".-.", "...", "-", "..-", "...-", ".--", "-..-", "-.--", "--..", ".----", "..---", "...--", "....-", ".....", "-....", "--...", "---..", "----.", "-----", "|" };

public String input[];
public String output[];
static String TranslationType;
static boolean Bool;
static String TextToTranslate;
static int i;
static int SectionOfString;
static StringBuffer emcStringBuffer = new StringBuffer();
static StringBuffer mceStringBuffer = new StringBuffer();
static String emc = "English-MorseCode";
static String mce = "MorseCode-English";
static StringBuffer MorseCodeLetter = new StringBuffer();
static String emcString;
static String mceString;
static String space = " ";

public static void main( String [] args )
{
    if ( E.length != M.length )
    {
        System.out.println( "Error" );
    }
    TranslationType = Input.getString( "Please choose a method of translation (\"English-MorseCode\" or \"MorseCode-English\") " );
    if ( TranslationType.equals( "English-MorseCode" ) )
    {
        Bool = true;
        System.out.println( TranslationType );
    }
    else if( TranslationType.equals( "MorseCode-English" ) )
    {
        Bool = false;
        System.out.println( TranslationType );
    }

    while ( !TranslationType.equals( emc ) && !TranslationType.equals( mce ) )
    {
        System.out.println( "Error: \"" + TranslationType + "\" is not a valid response.");
        TranslationType = Input.getString( "Please choose a method of translation (\"English-MorseCode\" or \"MorseCode-English\") " );
        if ( TranslationType.equals( "English-MorseCode" ) )
        {
            Bool = true;
            System.out.println( TranslationType );
        }
        else if( TranslationType.equals( "MorseCode-English" ) )
        {
            Bool = false;
            System.out.println( TranslationType );
        }
    }
    TextToTranslate = Input.getString( "What would you like to translate?" );
    TextToTranslate = TextToTranslate.toUpperCase();
    System.out.println( TextToTranslate );
    if ( Bool == true )
    {
        for ( SectionOfString = 0; SectionOfString < TextToTranslate.length(); SectionOfString++ )
        {
            for ( i = 0; i < E.length; i++ )
            {
                if ( TextToTranslate.substring( SectionOfString, SectionOfString + 1 ).equals( E[i] ) )
                {
                    emcStringBuffer.append( M[i] + " " );
                }
            }
        }
        emcString = emcStringBuffer.toString();
        System.out.println( emcString );
    }
    else if ( Bool == false )
    {
        for ( SectionOfString = 0; SectionOfString < TextToTranslate.length(); SectionOfString++ )
        {
            if ( TextToTranslate.substring( SectionOfString, SectionOfString + 1 ).equals( space ) )
            {
                for ( i = 0; i < M.length; i++ )
                {
                    if ( MorseCodeLetter.equals( M[i] ) )
                    {
                        mceStringBuffer.append( E[i] );
                        System.out.println( MorseCodeLetter + ";" + mceStringBuffer );
                    }
                }
            }
            else
            {
                if ( TextToTranslate.substring( SectionOfString, SectionOfString + 1 ).equals( M[36] ) )
                {
                    mceStringBuffer.append( E[36] );
                }
                else
                {
                    MorseCodeLetter.append( TextToTranslate.substring( SectionOfString, SectionOfString + 1 ) );
                }
            }
        }
        mceString = mceStringBuffer.toString();
        System.out.println( mceString );
    }
    System.out.println( "Done" );
}
} 
```

问题似乎是这部分代码在将摩尔斯电码翻译成英文时从未使用过：

```
if ( TextToTranslate.substring( SectionOfString, SectionOfString + 1 ).equals( space ) )
            {
                for ( i = 0; i < M.length; i++ )
                {
                    if ( MorseCodeLetter.equals( M[i] ) )
                    {
                        mceStringBuffer.append( E[i] );
                        System.out.println( MorseCodeLetter + ";" + mceStringBuffer );
                    }
                }
            } 
```

这导致莫尔斯电码字母不被分开。例如，如果 TextToTranslate 的输入是

```
. .-. | .-. . 
```

那么程序会认为..-..-. 是一个词。我不确定这是否是翻译结果未打印到终端（或 windows 上的命令提示符）的原因。

另外，我之前尝试让空间成为静态字符，我只是尝试将空间作为最终字符，在 if 构造中使用以下内容，我遇到了同样的问题：

```
TextToTranslate.charAt( SectionOfString ) == space 
```

我不确定为什么会出现这个问题，我试图找到一个类似的问题但无法找到，所以如果有人知道如何解决这个问题，我将不胜感激。

注意：我在 Java 编程论坛上问了同样的问题（用户：Indybones33）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:58:10.197

> 这导致莫尔斯电码字母不被分开。例如，如果 TextToTranslate 的输入是
> 
> . .-. | .-. . 那么程序会认为..-..-. 是一个词。我不确定这是否是翻译结果未打印到终端（或 windows 上的命令提示符）的原因。

你知道吗？还是你假设它？我认为你大错特错。

我认为真正的问题是这样的：

```
if ( MorseCodeLetter.equals( M[i] ) 
```

这应该总是返回`false`，因为`MorseCodeLetter`is 属于 type`StringBuffer`并且`M[i]`属于 type `String`。

您只需执行以下操作即可解决此问题：

```
if ( MorseCodeLetter.toString().equals( M[i] ) ) 
```

作为旁注，使用 a`StringBuffer`不必要地过于复杂。您可以简单地使用字符串连接 ( `String MorseCodeLetter = ""; MorseCodeLetter += letter;`)。此外，通常`StringBuffer`用于多线程程序并且`StringBuilder`是首选。

旁注 2：您所有的符号和命名约定都不是标准的 Java 约定。这意味着其他 Java 程序员很难轻松阅读您的代码。只有`class`名称应该是 UpperCamelCase。变量名（如`MorseCodeLetter`您的代码中）应为小写形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:57:19.370

我没有通过代码示例的复杂性，但这里是一个简单的空间比较，以防万一这有帮助。

```
String str = "x y";
String strSpace = " ";

if (strSpace.equals(str.substring(1,2))) {
    System.out.println("Bingo");
} 
```

# javascript - jQuery 延迟对象

> ID：14062702
> 
> 赞同：1
> 
> 时间：2012-12-27T23:35:32.490
> 
> 标签：javascript, jquery, deferred

我很难将我的头脑围绕在 jQuery 中的延迟对象上。

例如，

我以为我可以使用以下语法，但这实际上是在成功发生时同时运行成功和失败。我认为只有在 ajax 调用失败时才会运行失败？

```
checkFoo(widget)
.success(step1, step2)
.fail(alert("failed")); 
```

checkFoo 是这样的 AJAX 调用

```
function checkFoo(widget){
   return $.ajax({
          url: "foo.php",
          data: widget,
          format: json
   });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:38:34.803

这很糟糕：

```
.success( step1(), step2() ) 
```

这将传递执行结果`step1()`和`step2()`as 参数。

但是这里很好！

```
.success( step1, step2 ) 
```

它会将函数本身传递给稍后执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:39:35.443

您以错误的方式使用它们..

`.success()`并将`.fail()`回调函数作为参数..

所以试试

```
checkFoo(widget)
.success( function(){
    step1(); 
    step2();
})
.fail( function(){
    alert("checkfoo failed");
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T23:40:21.243

你的代码

```
checkFoo(widget)
.success( step1(), step2() )
.fail( alert("checkfoo failed") ); 
```

***立即***调用**`step1`and `step2`，并将它们的返回值传递给or方法。完全一样`alert` *`success``fail`***

 ***```
foo(bar()); 
```

...调用`bar`并将其返回值传递给`foo`.

如果你想告诉 jQuery在成功时调用`step1`and并在失败时执行，你传入函数引用：`step2``alert`

```
checkFoo(widget)
.success( step1, step2 )      // <== No parens, `step1` refers to a *function*
.fail( function() {           // <== Wrap a function around the alert
    alert("checkfoo failed");
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:40:03.887

我认为您可能希望将 fhnction 表达式传递给`fail`：

```
.fail(function() {

}); 
```***

# python - 如何使用一些分隔符为文本的特定部分着色

> ID：14062705
> 
> 赞同：0
> 
> 时间：2012-12-27T23:35:44.787
> 
> 标签：python, pyobjc

我正在尝试为文本的某些特定部分着色，我试图说：

```
if word.strip().startswith(":"):
    self.setAttributesForRange(NSColor.greenColor(), None, highlightOffset, len(word)) 
```

当有人键入标志时**：**它会变成绿色。这很好，但它会像这样继续为单词着色：

**:Hello Hello :Hello** *<----*这一切都变成绿色，但我想要这样的东西：

**:Hello** Hello **:Hello** *<----*除了中间的 "hello" 以外的所有东西都被着色了，因为它不是以符号开头的**:**，请帮帮我

```
from Foundation import *
from AppKit import *

import objc

class PyObjC_HighlightAppDelegate(NSObject):

    # The connection to our NSTextView in the UI
    highlightedText = objc.IBOutlet()

    # Default font size to use when highlighting
    fontSize = 12

    def applicationDidFinishLaunching_(self, sender):
        NSLog("Application did finish launching.")

    def textDidChange_(self, notification):

        """
        Delegate method called by the NSTextView whenever the contents of the
        text view have changed. This is called after the text has changed and
        been committed to the view. See the Cocoa reference documents:

        http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSText_Class/Reference/Reference.html
        http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextView_Class/Reference/Reference.html

        Specifically the sections on Delegate Methods for information on additional
        delegate methods relating to text control is NSTextView objects.
        """

        # Retrieve the current contents of the document and start highlighting

        content = self.highlightedText.string()
        self.highlightText(content)

    def setAttributesForRange(self, color, font, rangeStart, rangeLength):
        """
        Set the visual attributes for a range of characters in the NSTextView. If
        values for the color and font are None, defaults will be used.

        The rangeStart is an index into the contents of the NSTextView, and
        rangeLength is used in combination with this index to create an NSRange
        structure, which is passed to the NSTextView methods for setting
        text attributes. If either of these values are None, defaults will
        be provided.

        The "font" parameter is used as an key for the "fontMap", which contains
        the associated NSFont objects for each font style.
        """
        fontMap = {
                    "normal" : NSFont.systemFontOfSize_(self.fontSize),
                    "bold" : NSFont.boldSystemFontOfSize_(self.fontSize)
                    }

        # Setup sane defaults for the color, font and range if no values
        # are provided
        if color is None:
            color = NSColor.blackColor()
        if font is None:
            font = "normal"        

        if font not in fontMap:
            font = "normal"

        displayFont = fontMap[font]

        if rangeStart is None:
            rangeStart = 0

        if rangeLength is None:
            rangeLength = len(self.highlightedText.string()) - rangeStart

        # Set the attributes for the specified character range
        range = NSRange(rangeStart, rangeLength)
        self.highlightedText.setTextColor_range_(color, range)
        self.highlightedText.setFont_range_(displayFont, range)

    def highlightText(self, content):
        """
        Apply our customized highlighting to the provided content. It is assumed that
        this content was extracted from the NSTextView.
        """

        # Calling the setAttributesForRange with no values creates
        # a default that "resets" the formatting on all of the content
        self.setAttributesForRange(None, None, None, None)

        # We'll highlight the content by breaking it down into lines, and
        # processing each line one by one. By storing how many characters
        # have been processed we can maintain an "offset" into the overall
        # content that we use to specify the range of text that is currently
        # being highlighted.
        contentLines = content.split("\n")
        highlightOffset = 0

        for line in contentLines:

            if line.strip().startswith("#"):
                # Comment - we want to highlight the whole comment line
                self.setAttributesForRange(NSColor.greenColor(), None, highlightOffset, len(line))

            elif line.find(":") > -1:
                # Tag - we only want to highlight the tag, not the colon or the remainder of the line
                startOfLine = line[0: line.find(":")]
                yamlTag = startOfLine.strip("\t ")
                yamlTagStart = line.find(yamlTag)
                self.setAttributesForRange(NSColor.blueColor(), "bold", highlightOffset + yamlTagStart, len(yamlTag))

            elif line.strip().startswith("-"):
                # List item - we only want to highlight the dash
                listIndex = line.find("-")
                self.setAttributesForRange(NSColor.redColor(), None, highlightOffset + listIndex, 1)

            # Add the processed line to our offset, as well as the newline that terminated the line
            highlightOffset += len(line) + 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:49:21.950

这一切都取决于是什么 `word`。

```
In [6]: word = ':Hello Hello :Hello'

In [7]: word.strip().startswith(':')
Out[7]: True

In [8]: len(word)
Out[8]: 19 
```

相比：

```
In [1]: line = ':Hello Hello :Hello'.split()

In [2]: line
Out[2]: [':Hello', 'Hello', ':Hello']

In [3]: for word in line:
    print word.strip().startswith(':')
    print len(word)
   ...:     
True
6
False
5
True
6 
```

请注意 中的差异`len(word)`，我怀疑这是导致您的问题的原因。

# lua - 是否可以防止物体在 Corona SDK 中旋转？

> ID：14062708
> 
> 赞同：2
> 
> 时间：2012-12-27T23:36:42.507
> 
> 标签：lua, coronasdk, game-physics

我想它非常自我解释，我需要知道在启用物理引擎时是否可以禁用/防止对象旋转。物体大部分时间都会下落，因此会受到重力的影响。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T12:44:20.853

它是，只需使用：

```
object.isFixedRotation = true 
```

要“暂停”旋转，请使用：

```
object.angularVelocity = 0 
```

在任何给定点。

# php - Symfony2 Transformer 没有收到价值

> ID：14062726
> 
> 赞同：1
> 
> 时间：2012-12-27T23:39:24.840
> 
> 标签：php, regex, forms, symfony

我创建了一个自定义表单类型和一个与之配套的转换器。我数据库中的数据保存在 1 个文本字段中。" `<EN>English text</EN><FR>Frenc text</FR>`"

所以我创建了一个表单类型，为每个输入添加单独的文本，并且转换器应该将正确的值放在输入内的标签之间。

问题是我回显了应该在转换函数中传递的值，但它是空的，我不知道为什么。

这是我的多语言类型

```
class MultiLangType extends AbstractType
{
    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'type' => 'text',
            'compound' => 'true'
        ));
    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $langs = array('EN', 'FR', 'DE');
        $transformer = new StringToMultiTransformer($langs);
        $builder->prependClientTransformer($transformer);
        //$builder->addModelTransformer(new StringToMultiTransformer($langs));
        foreach($langs as $l)
        {
            $builder->add($l, 'text', $options);
        }

    }

    public function getParent()
    {
        return 'field';
    }

    public function getName()
    {
        return 'multilang';
    }
} 
```

现在我的变压器

```
class StringToMultiTransformer implements DataTransformerInterface
{
    private $langs;

    public function __construct(array $langs)
    {
        $this->langs = $langs;
    }

    public function transform($value)
    {
        // var_dump($value); exit;
        $result = array();

        foreach ($this->langs as $l) {
            $ret = preg_match("/<$l>(.*?)<\/$l>/", $value);
            $result[$l] = $ret[1];
        }
        return $result;
    }

    public function reverseTransform($array)
    {
        if (!is_array($array)) {
            throw new UnexpectedTypeException($array, 'array');
        }

        $result = "";
        $emptyKeys = array();

        foreach ($this->langs as $l) {
            $val = $array[$l];
            $result .= "<$l>$val</$l>";
        }

        return $result;
    } 
```

提前感谢您的任何建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:48:46.720

您的变压器被多次调用。因此，我认为您应该通过检查传递的 $value 是否为空来使用提前返回。

`transform()`在方法逻辑的顶部添加，

```
if (!$value) {
    return null;
} 
```

你也应该在你的方法中做同样的事情，`reverseTransform()`以避免考虑空值和空值。

# php - 如果一行不是唯一的 - 忽略它 - php

> ID：14062729
> 
> 赞同：1
> 
> 时间：2012-12-27T23:39:35.913
> 
> 标签：php, arrays, loops, select, fetch

我正在处理以下代码：

```
function form_Subcat_Picker() {
    $mysqli = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
    if (!$mysqli) {
        die('There was a problem connecting to the database.');
    }       
    $catPicker = "SELECT Subcatid, Subcatname, Parentid
            FROM ProductSubCats
            ORDER BY Subcatid";
    if ($Result = $mysqli->query($catPicker)){
        if (!$Result) {
            echo 'Could not run query: ' . mysql_error();
            exit;
        }
        while ($row = $Result->fetch_assoc()) { 
            echo '<div class="parentid'.$row['Parentid'].'">';
            echo '<select name="Subcatid">';
            echo '<option value="'.$row["Subcatid"].'">'.$row["Subcatname"]."</option>";
            echo '</select>';
            echo '</div>';
        }
    }
    $mysqli->close();
} 
```

我想做的事情是：

```
while ($row = $Result->fetch_assoc()) { 
            echo '<div class="parentid'.$row['Parentid'].'">'; 
```

如果 $row['Parentid'] 部分与上一次迭代相同，我想忽略该特定行（添加 div 类）

因此，如果例如在第一次运行中 $row['Parentid'] 为 1，并且在下一个循环中再次为 1，我不想创建一个新的 div，只是回显其他所有内容，从而将其保留在同一个 div 中.

这可能吗？或者，如果它们共享一个共同的父 ID（有多个父 ID），我如何使多个子类别 ID 和名称出现在一个 div 中 对于该行：

```
echo '<option value="'.$row["Subcatid"].'">'.$row["Subcatname"]."</option>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:47:37.267

也许这会起作用：

```
$last_id = 0;
while ($row = $Result->fetch_assoc()) {
    if ($last_id != $row['Parentid']) {
        echo '<div class="parentid'.$row['Parentid'].'">';
        echo '<select name="Subcatid">';
        echo '<option value="'.$row["Subcatid"].'">'.$row["Subcatname"]."</option>";
        echo '</select>';
        echo '</div>';
        $last_id = $row['Parentid'];
    }
} 
```

但是，我认为最好的解决方案是在 SQL 语句中过滤掉它们，也许是`GROUP BY`子句，但我不是 100% 确定该怎么做:)。

问候，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:48:33.447

这只是循环的基本内容。让我们看看你当前的循环：

```
 while ($row = $Result->fetch_assoc()) { 
     ...
 } 
```

由于您想跳过特定条件，所以我们只介绍这种跳过（首先不要太在意条件）：

```
 while ($row = $Result->fetch_assoc()) { 
     if ($condition) continue;
     ...
 } 
```

现在让我们制定条件。当我们要查看最后一个`$row`时，我们需要保留一份副本：

```
 $last = null;
 while ($row = $Result->fetch_assoc()) { 
     if ($condition) continue;
     ...
     $last = $row;
 } 
```

现在我们已经获得了创建条件所需的数据，`$last`可以包含最后一行（如果有的话），因此可以进行比较：

```
 $last = null;
 while ($row = $Result->fetch_assoc()) { 
     $condition = $last && $row['Parentid'] === $last['Parentid'];
     if ($condition) continue;
     ...
     $last = $row;
 } 
```

基本上就是这样。根据逻辑，您可能希望切换到`for`循环：

```
 for ($last = null; $row = $Result->fetch_assoc(); $last = $row) { 
     $condition = $last && $row['Parentid'] === $last['Parentid'];
     if ($condition) continue;
     ...         
 } 
```

例如，这确实确保对于每次迭代（甚至是跳过的迭代），在循环结束时将`$last`设置为。`$row`

而不是`continue`你可以自然地做不同的事情，比如不输出`<div>`或类似的。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T23:48:39.747

这就是我写它的方式。

```
// add a variable to hold the previous value
$previous_parent_id = "";

while ($row = $Result->fetch_assoc()) { 

  // then add an if statement to see if it's the previous statement
  if ($row['parent_id'] != $previous_parent_id){
    echo '<div class="parent_id'.$row['parent_id'].'">';
    $previous_parent_id = $row['parent_id'];
  }
} 
```

所以在这些记录上循环

```
ID ParentID
1  0
2  0
3  1
4  1
4  2
4  2 
```

输出将是：

```
<div class="parent_id0">
<div class="parent_id1">
<div class="parent_id2"> 
```

# mysql - 更新/插入记录 - ON DUPLICATE KEY UPDATE - 不更新记录

> ID：14062731
> 
> 赞同：0
> 
> 时间：2012-12-27T23:39:54.933
> 
> 标签：mysql

我正在尝试根据记录在表中的存在来创建插入或更新记录的语句。如果“drug_name_pl”字段中的记录存在，它会将其“vote_sum”值增加 1。问题是该语句在尝试更新已经存在的字段时创建每一次记录。

这是表结构：

```
 Field            Type       Null Key Default Extra
                id              int(11)    NO   PRI NULL    auto_increment
                drug_name_pl    varchar(11)NO   MUL NULL      
                vote_sum        int(11)    NO       NULL 
```

和查询：

```
$query = "INSERT INTO lek_podstawowe(drug_name_pl) VALUES ('$drug_name_pl') 
ON DUPLICATE KEY UPDATE vote_sum=vote_sum+1"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:42:08.227

您需要在 drug_name_pl 上添加唯一键

就像是：

```
CREATE UNIQUE INDEX drug_name_pl_unique ON table_name (drug_name_pl) 
```

不要忘记更改`table_name`为您的表的真实名称。还请确保您正确转义 $drug_name_pl 以保护申请表 sql 注入

# geotools - 如何使用 GeoTools 连接到 ArcSDE？

> ID：14062736
> 
> 赞同：1
> 
> 时间：2012-12-27T23:40:21.487
> 
> 标签：geotools, arcgis-server

我正在运行 Oracle ArcSDE 9.2 并使用 GeoTools 8.5，但按照他们在 GeoTools 文档中所说的操作似乎不起作用。我有

```
Map<String, Object> params = new HashMap<String, Object>();
params.put( "dbtype", "arcsde" );
params.put( "server", "164.64.146.42" );
params.put( "port", "5151" );
params.put( "instance", "sde" );
params.put( "user", "sde_admin" );
params.put( "password", "whatever" );

DataStore dataStore;
String typeName;

try
{
    dataStore = DataStoreFinder.getDataStore(params);
    typeName = dataStore.getTypeNames()[0];
} catch (IOException e)
{
    e.printStackTrace();
}

FeatureSource source = dataStore(typeName); 
```

但是，在 dataStore = dataStoreFinder.getDataStore(params) 之后，dataStore 始终为 null，表示它没有连接。除非我尝试使用为空的 dataStore 对象，否则我不会遇到异常。而且我不希望它起作用，因为它不要求我提供模式。当您使用 GeoServer 成功连接到同一个 SDE 地理数据库时，它坚持使用模式参数，在我的例子中是“envq.nmenv.state.nm.us”。我会将其添加到某处的服务器名称中吗？或者我错过了什么不连接？我现在只是尝试以只读方式连接，但最终我想使用 GeoTools 将数据放入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:02:33.913

使用使用 GeoTools 库的软件 uDig 已经回答了我的问题。当通过 uDig 从 ArcSDE DataStore 加载时，uDig 提示知道以下 jar 的位置： jsde92_sdk.jar jpe92_sdk.jar icu4j_3_2.jar 通过在 Eclipse 中将 gt-arcsde 添加到 pom.xml 中，它们不会通过 Maven 自动加载，但是在文件名[geoserver-2.2.2-arcsde-plugin.zip](http://sourceforge.net/projects/geoserver/files/GeoServer%20Extensions/2.2.2/geoserver-2.2.2-arcsde-plugin.zip)中的 ArcSDE 数据存储扩展下与[GeoServer](http://geoserver.org/display/GEOS/Stable)一起分发 将它们的位置添加到您的 CLASSPATH 或在 Eclipse 中转到 Project->Properties->Java Build Path 并添加外部 JAR.. . 并选择所有三个。届时，上述代码将保持不变。

# qt - QGraphicsProxyWidget 在 QGraphicsScene 中剪切了上下文菜单

> ID：14062737
> 
> 赞同：3
> 
> 时间：2012-12-27T23:40:23.103
> 
> 标签：qt, opengl, qgraphicsscene, qt5

以下代码基于 Graphics View Framework 的文档。我在 QGraphicsScene 中嵌入了 QLineEdit 并运行程序。当我右键单击场景中的行编辑时，我得到一个剪辑的上下文菜单。QGraphicsProxyWidget 的上下文菜单由场景绘制为子 QGraphicsProxyWidget，因此如果窗口太小，它会被剪裁。我希望所有嵌入式小部件都将它们的上下文菜单显示为顶级窗口，就像它们没有嵌入 QGraphicsScene 时一样。我以两种方式尝试了 BypassGraphicsProxyWidget 标志，但它没有按我的意愿工作。在 Linux 和 Windows 上的 Qt 4.8 / 5.0 上测试。所有平台上的相同问题。

如何使嵌入式小部件显示具有本机外观的普通顶级上下文菜单？重载 QGraphicsView 的 contextMenuEvent 会提供一个原生的顶级上下文菜单 - 我可以做某种委托并让 QGraphicsView 在场景中显示嵌入式小部件的上下文菜单吗？

```
#include <QApplication>
#include <QLineEdit>
#include <QGraphicsScene>
#include <QGraphicsProxyWidget>
#include <QGraphicsView>

int main(int argc, char **argv)
{
    QApplication app(argc, argv);

    QGraphicsScene scene;
    QGraphicsProxyWidget *proxy = scene.addWidget(new QLineEdit(), Qt::BypassGraphicsProxyWidget);

    QGraphicsView view(&scene);
    view.setWindowFlags(Qt::BypassGraphicsProxyWidget);
    view.show();

    return app.exec();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:29:52.017

您可以通过添加一个设置了 Qt::BypassGraphicsProxyWidget 的 QWidget 来获得本机上下文菜单。孩子们会将其上下文菜单呈现为弹出式原生样式。

```
#ifndef QGLPARENT_H
#define QGLPARENT_H

#include <QGLWidget>
#include <QGraphicsScene>
#include <QGraphicsProxyWidget>
#include <QGraphicsView>

class QGLParent : public QGraphicsView
{
private:
    QGraphicsProxyWidget *child;
public:
    QGLParent(QWidget *parent, QWidget *child) : QGraphicsView(parent)
    {
        setFrameShape(QFrame::NoFrame);
        QGLFormat format(QGL::SampleBuffers);
        format.setSwapInterval(1);

        setScene(new QGraphicsScene());
                setViewport(new QGLWidget(format));
                //setViewportUpdateMode(QGraphicsView::FullViewportUpdate);

        child->setWindowFlags(Qt::BypassGraphicsProxyWidget);
        this->child = scene()->addWidget(child);
    }
protected:
    void resizeEvent(QResizeEvent *event)
    {
        scene()->setSceneRect(QRect(QPoint(0, 0), event->size()));
        child->resize(event->size().width(), event->size().height());
        QGraphicsView::resizeEvent(event);
    }
};

#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:44:21.183

不幸的是，这是一个已知的错误[QTBUG-10683](https://bugreports.qt-project.org/browse/QTBUG-10683 "QTBUG-10683")。错误报告的最后一条评论中建议了一种解决方法。

# ios - 在新代码之前等待 GCD 异步停止

> ID：14062740
> 
> 赞同：2
> 
> 时间：2012-12-27T23:40:33.437
> 
> 标签：ios, grand-central-dispatch

我有一个`GCD`背景。我有一个按钮，按下时我希望它在 GCD 完成时加载加载等待屏幕，然后在该按钮上执行其余代码。附上样品。

我的不工作，我基本上想说，等待完成GCD，同时加载等待消息，完成后继续代码。

谢谢

```
- (IBAction)btnTapped:(id)sender
{
    shouldCancel=NO;
    dispatch_queue_t existingQueque = dispatch_get_main_queue();//finds the current GCD, the one I created in a different method
    dispatch_group_t group =dispatch_group_create();

    dispatch_group_async(group, existingQueque, ^
    {
        dispatch_group_wait(group, DISPATCH_TIME_FOREVER);//does not work, I guess group can't be created here.
        [self performSelectorOnMainThread:@selector(showWaitViewWithMessage:) withObject:@"Loading" waitUntilDone:YES];//load this until GCD queque done

        [self performSelector:@selector(performSearch) withObject:nil afterDelay:0];
    });    
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T05:19:16.540

几个想法：

1.  您建议`dispatch_get_main_queue()`“找到当前的 GCD，即我以不同方法创建的 GCD”。不，这只是获取主队列（如果您使用它，将阻止您的用户界面），而不是您通过`dispatch_create_queue`. 只是获取主`dispatch_get_main_queue()`队列，当您进行搜索时，您的用户界面将被阻止（例如`UIActivityIndicatorView`，不会旋转，无论如何）。

2.  如果您已将一大堆任务分派到后台队列，如果您想等待所有任务完成，那就是您使用`dispatch_group_t`or的时候`dispatch_barrier`，但鉴于您所显示的内容并不需要（您只有一个调度操作），你只是不需要去那里。顺便说一句，如果您使用全局队列，则不建议使用屏障。

3.  单个 GCD 后台任务的典型模式比您的问题建议的更简单。您 (a) 更新您的 UI 以显示“正在加载”并显示 a`UIActivityIndicatorView`或类似的内容，以便用户拥有更丰富的 UX，向他们显示应用正在处理某事；(b) 在后台调度搜索；(c) 完成后，将 UI 更新分派回主队列。因此，典型的模式是：

    ```
    - (IBAction)btnTapped:(id)sender
    {
        dispatch_queue_t backgroundQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);

        // or, if you've already created you own background queue just use that here, 
        // or just create one here. But don't use dispatch_get_main_queue, as that 
        // won't use a background queue.
        //
        // dispatch_queue_t backgroundQueue = dispatch_queue_create("org.yourdomain.yourapp.search", NULL);

        [self showWaitViewWithMessage:@"Loading"];

        dispatch_async(backgroundQueue, ^{
            [self performSearch];             // do this in the background
            dispatch_async(dispatch_get_main_queue(), ^{
                [self updateUiAfterSearch];   // when done, dispatch UI update back to main queue
            });
        });

        // if you created a queue, remember to release it
        //
        // dispatch_release(backgroundQueue); 
    } 
    ```

4.  顺便说一句，在你的 中`performSelectorOnMainThread`，我认为没有理由`waitUntilDone`。除非有令人信服的理由，否则不要等待。正如你在上面看到的，这个结构根本不需要，只是一个 FYI。

5.  顺便说一句，重要的是要知道许多服务器会限制给定客户端一次可以发出多少并发请求。如果您有可能发起多个请求（例如，用户点击按钮而服务器响应缓慢），这允许它们同时运行。在这种场景下，值得追求`NSOperationQueue`，在哪里可以设置`maxConcurrentOperationCount`。如果您使用`NSOperationQueue`方法的块版本（例如`addOperationWithBlock`，而不是 GCD 的`dispatch_async`），代码可以以相同的方式构造，但它让您限制后台操作的数量。

    此外，`NSOperationQueue`还提供了在操作之间轻松建立依赖关系的能力（例如`NSOperation`，依赖于所有其他完成的完成）。我可以概述这一点，但是您发布的代码并不需要这样做，所以除非您让我知道您想看看那会是什么样子，否则我会饶恕您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:48:10.603

您必须保存您创建的队列，不要每次都创建它，如果您一次只需要一个，请使用串行队列

* * *

```
 @implementation DDAppDelegate {
     dispatch_queue_t queue;
 }

 - (void)applicationDidFinishLaunching:(NSNotification *)aNotification
 {
     [self do];
     [self performSelector:@selector(do) withObject:nil afterDelay:1];
 }

 - (void)do {
     if(!queue)
         queue = dispatch_queue_create("com.example.MyQueue", NULL);

     dispatch_async(queue, ^{
         //serialized
         NSLog(@"1");
         sleep(10);
     });
 }
 @end 
```

**如果您想要一个并发队列，请使用全局队列和 dispatch_barrier_async**

```
@implementation DDAppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    [self do];
    [self performSelector:@selector(do) withObject:nil afterDelay:1];
}

- (void)do {
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0);

    dispatch_barrier_async(queue, ^{
        //serialized
        NSLog(@"1");
        sleep(10);
    });
} 
```

# jquery - 无法响应对 express.js node.js 的 JQuery Ajax 发布请求

> ID：14062741
> 
> 赞同：0
> 
> 时间：2012-12-27T23:40:52.777
> 
> 标签：jquery, ajax, node.js, post, express

这是 express.js 服务器代码：

```
var express = require('express')
var app = express();
app.listen(8001);

app.configure(function(){

   app.use(express.bodyParser());
   app.set('views',__dirname + '/views');
   app.set('view engine', 'ejs');
   app.use(express.static(__dirname + '/public'));
   app.use(express.cookieParser());
   app.use(app.router);

});

app.get('/', function (req, res){

   res.render('ajax.ejs');

});

app.post('/ajax', function (req, res){

   console.log(req.body);
   res.contentType('json');
   console.log(JSON.stringify({response:'json'}));
   res.write(JSON.stringify({response:'json'}));
   res.end();

 }); 
```

这是来自的代码`ajax.ejs`：

```
<html>
<head>

  <script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>    

</head>
<body>

 <form>
   <input type="button" id="enter" value="Enter">
 </form>
<script type="text/javascript">
   $('#enter').click(function(){  
    $.ajax({ 
               url: '/ajax'
             , type: 'POST'
             , cache: false
             , data: { field1: 1, field2: 2 }
             , complete: function() {
             //called when complete
                 console.log('process complete');
             },

             success: function(data) {
                 alert(data);
                 console.log('process sucess');
              },

             error: function() {
                console.log('process error');
              },
           });
         });            

  </script>
</body> 
</html> 
```

我正在尝试响应 AJAX 发布请求，但是当`ajax.ejs`向我显示服务器发送的警报中的数据时，结果是 this `[object Object]`。这里的问题在哪里？

提前谢谢！

# objective-c - UINavigationController 上未出现后退按钮 - 无法调试

> ID：14062742
> 
> 赞同：1
> 
> 时间：2012-12-27T23:40:54.023
> 
> 标签：objective-c, uinavigationcontroller, back-button, uinavigationitem

导航控制器上的后退按钮有时不会出现。请注意，有时确实如此，因此其他地方的 som 代码中可能还发生了其他事情，但是我尝试以我能想到的各种方式对其进行调试，但似乎没有任何效果。

推送视图控制器的代码如下（相当标准）：

```
CommentsTableViewController *vc = [[[CommentsTableViewController alloc] init] autorelease];
vc.puzzleID = self.puzzleModel.puzzleID;
[self.navigationController pushViewController:vc animated:YES]; 
```

为了调试这个问题，我在 viewWillAppear 和 viewDidAppear 的 CommentsTableViewController 中放了以下代码（除了我只注册为观察者一次）：

```
self.navigationItem.hidesBackButton = NO;

[self.navigationItem addObserver:self forKeyPath:@"backBarButtonItem" options:(NSKeyValueObservingOptionNew | NSKeyValueObservingOptionInitial) context:nil];

self.navigationItem.backBarButtonItem.title = @"Tactic";
NSArray *viewControllerArray = [self.navigationController viewControllers];
int parentViewControllerIndex = [viewControllerArray count] - 2;
[[viewControllerArray objectAtIndex:parentViewControllerIndex] setTitle:@"Tactic"]; 
```

这些似乎都没有帮助。设置断点后，层次结构中我上方的视图控制器似乎有一个标题（@“Tactic”），并且 hidesBackButton 已经是 NO。backBarButtonItem 属性为 nil 并且始终为 nil，尽管我认为这是预期的行为，即使您确实有 backBarButtonItem？

编辑：在父控制器中，我首先将 hidesBackBackButton 设置为 YES，然后（在我按下下一个控制器之前），将其设置回 NO。当我删除这些行时，新的视图控制器有一个后退按钮。为什么一个视图控制器的导航项会影响下一个视图控制器的导航项？

欢迎任何建议或想法。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:22:56.230

也许您可以更好地解决问题，调试它。您假设引导您返回的按钮是这样的：

```
self.navigationItem.backBarButtonItem.title = @"Tactic"; 
```

但这为零，如果您想在导航控制器的导航栏中找到该按钮：

```
NSLog(@"%@",self.navigationController.navigationBar.topItem); 
```

我看不出您的代码无法正常工作的原因，您也不需要这样做：

```
self.navigationItem.hidesBackButton = NO; 
```

试试这个：

```
self.navigationController.navigationBar.topItem.hidesBackButton = NO; 
```

无论如何，即使我没有将其设置为 NO，这对我也有效。

如果这不能解决问题，它至少应该有助于调试它，并且如果您仍然在评论中发布该问题，并说出 NSLog() 打印什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T04:41:41.017

行。我已经解决了。我不知道为什么这会有所不同，但确实如此。

在我调用 hidesBackButton 的同一个运行循环中，我还调用了：

```
[self.view addSubview:self.chessBoardViewController.view]; 
```

这似乎是以某种方式搞砸了导航栏的那条线。如果我删除这条线，它会完美运行。所以我找到的解决方案是将这一行替换为：

```
[self.view performSelector:@selector(addSubview:) withObject:self.chessBoardViewController.view afterDelay:0]; 
```

我不知道为什么会这样，所以如果有人对可能发生的事情有任何见解，请发表评论。

# jquery - Jquery针对具有共享类的不同元素

> ID：14062744
> 
> 赞同：0
> 
> 时间：2012-12-27T23:41:01.910
> 
> 标签：jquery, html

基本上我试图仅在`db_update`触发模糊的输入字段的父 div 类中定位元素，但是它针对具有匹配名称的任何类，这不是我想要的。忽略 AJAX 部分，因为它现在无关紧要。

我认为问题在于它针对模糊上的输入元素，并且它无法成功链接到父元素。

**基本上，无论我点击哪个 URL 输入框都是它应该填写的字段，而不是两者。**

[http://jsfiddle.net/SXWXu/6/](http://jsfiddle.net/SXWXu/6/)

## HTML

```
<div class="db_update">
<p style="font-size: 12px;"><span style="font-weight: normal;">SLIDE URL: <input type="text" class="slide_URL"  /></span></p>
<div class="status_message"> </div>
<p style="font-size: 12px;"><span style="font-weight: normal;">Slide #: <input type="text" class="slide_num" readonly/></span></p>
<p style="font-size: 12px;"><span style="font-weight: normal;">Document #: <input type="text" class="doc_num" readonly/></span></p>
<p style="font-size: 12px;"><span style="font-weight: normal;">Filter(F): <input type="text" class="filter_num" readonly/></span></p>
</div>

<br/>
<div class="db_update">
<p style="font-size: 12px;"><span style="font-weight: normal;">SLIDE URL: <input type="text" class="slide_URL"  /></span></p>
<div class="status_message"> </div>
<p style="font-size: 12px;"><span style="font-weight: normal;">Slide #: <input type="text" class="slide_num" readonly/></span></p>
<p style="font-size: 12px;"><span style="font-weight: normal;">Document #: <input type="text" class="doc_num" readonly/></span></p>
<p style="font-size: 12px;"><span style="font-weight: normal;">Filter(F): <input type="text" class="filter_num" readonly/></span></p>
</div> 
```

## jQuery

```
$(document).ready(function() {

$('input[class=slide_URL]').on({

   blur: function(){
    var status_message = $('.status_message');
    var query_string = encodeURIComponent($(this).val()); 
    var dataString = 'query_string='+ query_string;

     $.ajax({
      type : 'GET',
      url: '',
      dataType : 'json',

      data:  dataString ,
      error : function(XMLHttpRequest, textStatus, errorThrown) {

          $(this).parent().find('.slide_num').val(140);
            $('.doc_num').val(140);
        $('.filter_num').val(140);

      status_message.removeClass().addClass('failure').text('Request was not sent.').show(200);},

      success : function(data) {

       if (data.error === true)
       {

     status_message.show().removeClass('success').addClass('failure').text(data.msg).stop().fadeOut(3000);

     }
    else {
     status_message.show().removeClass('failure').addClass('success').text(data.msg).stop().fadeOut(3000);

         }
     } 
       });    
 return false; 

   }
 });
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:46:09.777

要仅针对同一`.db_update`div 中的元素，从一个`input`元素上的事件开始，您可以执行以下操作：

```
var status_message = $(this).closest(".db_update").find(".status_message"); 
```

那是做什么的：

1.  在一个`input`元素的事件处理程序中，jQuery 设置`this`为对 DOM`input`元素的引用。

2.  [`$(this)`](http://api.jquery.com/jQuery/#jQuery1)围绕该元素创建一个 jQuery 包装器。

3.  [`.closest(".db_update")`](http://api.jquery.com/closest)查找与选择器匹配的最近的父元素。

4.  [`.find(".status_message")`](http://api.jquery.com/find)查找与选择器匹配的该元素的所有后代元素。

因此，将其分解为各个部分，并假设`this`是`input`（它将在您的事件处理程序中）：

*   `$(this)`- jQuery 包装器`input`
*   `$(this).closest(".db_update")`-`.db_session`包含那个`input`
*   `$(this).closest(".db_update").find(".status_message")`- 其中的`.status_message`元素`div`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:46:32.680

用于[`.closest()`](http://api.jquery.com/closest/)获取`.db_update`模糊元素的祖先，然后[`.find()`](http://api.jquery.com/find/)找到所需的`status_message`.

```
var status_message = $(this).closest('.db_update').find('.status_message'); 
```

# jsf - 如何在鼠标悬停时显示输入字段

> ID：14062746
> 
> 赞同：0
> 
> 时间：2012-12-27T23:41:09.420
> 
> 标签：jsf, jsf-2

我有这个 JSF 表，我用它来显示数据和编辑数据：

```
<table>
    <ui:repeat var="ud" value="#{DCProfileTabGeneralController.dcData}">

        <tr>
            <td>Datacenter Type</td>
            <td>
                <h:outputText value="#{ud.type}" 
                              rendered="#{not DCProfileTabGeneralController.editable}" />
                <h:inputText value="#{ud.type}" rendered="#{DCProfileTabGeneralController.editable}" />
            </td>                                    
        </tr>
        <tr>
            <td>Date Added</td>
            <td>
                <h:outputText value="#{ud.dateAdded}" 
                              rendered="#{not DCProfileTabGeneralController.editable}" />
                <h:inputText styleClass="datepicker" value="#{ud.dateAdded}" rendered="#{DCProfileTabGeneralController.editable}" />
            </td>                                    
        </tr>
        <tr>
            <td>Hour Added</td>
            <td>
                <h:outputText value="#{ud.hourAdded}" 
                              rendered="#{not DCProfileTabGeneralController.editable}" />
                <h:inputText value="#{ud.hourAdded}" rendered="#{DCProfileTabGeneralController.editable}" />
            </td>                                    
        </tr>
        <tr>
            <td>Date Deployed</td>
            <td>
                <h:outputText value="#{ud.dateDeployed}" 
                              rendered="#{not DCProfileTabGeneralController.editable}" />
                <h:inputText styleClass="datepicker" value="#{ud.dateDeployed}" rendered="#{DCProfileTabGeneralController.editable}" />
            </td>                                    
        </tr>
        <tr>
            <td>Hour Deployed</td>
            <td>
                <h:outputText value="#{ud.hourDeployed}" 
                              rendered="#{not DCProfileTabGeneralController.editable}" />
                <h:inputText value="#{ud.hourDeployed}" rendered="#{DCProfileTabGeneralController.editable}" />
            </td>                                    
        </tr>

    </ui:repeat>
</table> 
```

该解决方案工作正常，但我想以这种方式扩展它：我想单击将编辑标志设置为 true 的按钮。当我将鼠标移到表的值上时，outputText 会更改为 inputText。

还有一个更简单的问题。如何在全球范围内为所有字段添加底部填充？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T05:20:18.207

我建议您使用`Richfaces`库并使用`<rich:inplaceInput>`如下组件。

```
<rich:inplaceInput value="hhhh" editEvent="onmouseover"/> 
```

但是，如果您仍然喜欢坚持`javascript`这是一个概念。

```
<h:form id="myForm">
  <h:outputText value="aaa" id="outText"/><br/>
  <h:inputText value="aaa" style="display:none;" id="inText" />
</h:form> 
```

这是`javascript`代码

```
<script>
    window.onload = function() {
        var outputText = document.getElementById("myForm:outText");
        var inputText = document.getElementById("myForm:inText");
        outputText.onmouseover = function() {
            outputText.style.display = 'none';
            inputText.style.display = '';
        }
        inputText.onblur = function() {
            outputText.style.display = '';
            inputText.style.display = 'none';
        }
    };
</script> 
```

由于您使用的是`ui:repeat`，因此您应该相应地更改`javascript`代码。

# c++ - 需要二进制流序列化库，C++

> ID：14062755
> 
> 赞同：1
> 
> 时间：2012-12-27T23:42:11.167
> 
> 标签：c++, serialization, deserialization

我正在寻找的是类似于 RakNet 中内置的序列化库（我不能在我当前的项目中使用）。我需要能够在本地将二进制流保存/加载为自定义格式，并通过网络发送它们。网络部分已解决，但我真的不想编写自己的方法将所有不同类型的数据序列化为二进制文件，特别是因为如果没有任何压缩方法，效率会很低。

这是一些类似于 RakNet 比特流工作方式的伪代码，这与我正在寻找的内容一致：

```
class Foo
{
public:
    void Foo::save(BitStream& out)
    {
        out->write(m_someInt);
        out->write(m_someBool);
        m_someBar.save(out);

        // Alternative syntax
        out->write<int>(m_someInt);

        // Also, you can define custom serialization for custom types so you can do this...
        out->write<Bar>(m_someBar);

        // Or this...
        out->write(m_someBar);     
    }

    void Foo::load(BitStream& in)
    {
        in->read(m_someInt);
        in->read(m_someBool);
        in->read(m_someBar);
    }

private:
    int m_someInt;
    bool m_someBool;
    Bar m_someBar;
}; 
```

是否有任何免费的 C++ 库允许这样的事情？我基本上只是想要一些东西将我的数据打包成二进制文件，并将其压缩以进行序列化，然后将其解压缩回二进制文件，我可以将其反馈回我的数据中。

**编辑，添加更多信息：**
不幸的是，Google Protocol Buffers 或 Boost Serialization 都不能满足我的需要。两者都希望序列化对象成员，我需要简单地序列化数据。例如，假设我有一个`std::vector<Person>`，并且该类`Person`有一个`std::string`for 名称，以及其中的其他数据，但我只想序列化和反序列化它们的名称。使用 Google 协议缓冲区，它希望我将 Person 对象作为一个整体提供给它以进行序列化。但是，我可以通过 Boost 序列化来实现，但是如果我有另一个需要整个`Person`要序列化，没有办法做到这一点，您要么必须序列化所有序列，要么不序列化。基本上我需要相当多的灵活性来制作二进制流，但是我认为合适，我只想要一个库来帮助我管理从流中读取和写入二进制数据，以及压缩/解压缩它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:45:53.153

1.  [Google 协议缓冲区](http://code.google.com/p/protobuf/)
2.  [提升序列化](http://www.boost.org/doc/libs/1_52_0/libs/serialization/doc/index.html)

**更新**

查看更新的问题，我认为编写一个完全符合要求的小型自定义库可能是最简单的。我有一个类似的，它只有几百行代码（没有压缩）。为这种代码编写单元测试非常容易，因此从一开始就可靠。

为了序列化自定义类型，我有一个 Persistent 基类，它具有保存和加载方法：

```
class Storage {
public:
  void writeInt( int i );
  void writeString( string s );
  int readInt();
  string readString();
};

class Persistent {
public:
  virtual void save( Storage & storage ) = 0;
  virtual void load( Storage & storage ) = 0;
};

class Person : public Persistent {
private:
  int height;
  string name;
public:
  void save( Storage & storage ) {
    storage.writeInt( height );
    storage.writeString( name );
  }

  void load( Storage & storage ) {
    storage.readInt( height );
    storage.readString( name );
  }
}; 
```

然后有一个简单的层，它在保存时存储一些类型信息，并在加载时使用工厂创建新对象。

这可以通过使用 C++ 的流（我不太喜欢，因此使用 Storage 类）来进一步简化。或者复制 Boost 使用 & 运算符将加载和保存合并到一个方法中的方法。

# php - 将回声和字符串同时从PHP函数传递到文档？

> ID：14062760
> 
> 赞同：0
> 
> 时间：2012-12-27T23:43:09.857
> 
> 标签：php

我有一个类似的功能。该功能 mysqls 并打印新闻。现在，根据 mysql 结果，此函数可能会打印或不打印某些内容。

```
function print_div_boxes($mysql)
{
echo 'Print (large sum of) data & divs....';

$printed_already = 1;
} 
```

我希望实现的PHP

```
<?

print_div_boxes($mysql);

if(!$printed_already)
{
print_div_boxes($another_mysql);
}
?> 
```

我只是想`$print_already`从那个函数传递给一个文档，把它当作`global`什么东西来抓取……有什么建议吗？可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:54:45.713

编辑问题后，您根本不需要 return 并对代码进行一些明确的修改，如下所示：

```
<?php
$printed_already = false;
function print_div_boxes()
{
global $printed_already;
echo 'Print (large sum of) data & divs....';

$printed_already = true;
}
?>

<?php
if(!$printed_already)
{
echo '<div>'; print_div_boxes(); echo '</div>';
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:02:03.880

这非常简单，您只需要：

确保某个变量（通常是布尔值）指示执行某个函数的结果。这是非常通用的方法。

因此，在程序代码中，它看起来像这样：

```
<?php

//initial state;
$already_printed = false;

/**
 * instead of using a global keyword, use reference
 * it makes code a bit "clean" 
 */
function print_div_boxes(&$already_printed) //<-- we are passing a reference, not a copy
{
  echo 'Print (large sum of) data & divs....';

  //A couple of thing to note:

  //1) Function Return value SHOULD NOT BE RESULT OF ASSIGNMENT!!!
  //2) No 'return' keyword actually required here, its VOID
  //3) You expect a logic, so use boolean instead of int. It's more appropriate

   $already_printed = true; 
}

//Then use it like:

if ( $already_printed === false ){

   print_div_boxes(&$already_printed);

} 
```

# java - Java 铸造对象

> ID：14062761
> 
> 赞同：1
> 
> 时间：2012-12-27T23:43:25.707
> 
> 标签：java, class, variables, reference, casting

我有两个班级：`Teacher`和`Coordinator`。`Coordinator`延伸`Teacher`。

基本上我想创建一个可以接受`Teacher`实例或`Coordinator`实例的实例变量。

我知道这很容易通过编写`Teacher exp = new Teacher()`or来实现`Teacher exp = new Coordinator()`，但是当我这样做时，我只能在应用或访问正常的引用变量时访问`Teacher`方法和属性。我的问题是，有没有另一种方法，我只使用一个可以分配给教师或协调员对象的实例变量，并使用这个变量来调用分配给对象引用变量的对象的任何属性/方法？`new Coordinator()``new Teacher()`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-27T23:47:34.473

您可以检查 exp 是否为`Coordinator`then 强制转换并相应地调用其函数：

```
if(exp instanceof Coordinator) {
    ((Coordinator)exp).foo();
} 
```

如果你有几件事想做，你可以在本地范围内创建一个变量并重复使用它：

```
if(exp instanceof Coordinator) {
    Coordinator expCoord = (Coordinator)exp;
    expCoord.foo();
    expCoord.bar();
    expCoord.baz();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:48:26.610

除非您要调用的所有方法都存在于父类中，否则无法做到这一点。

您可以将 Teacher 变量中的内容转换为 Coordinator，但如果 Teacher 变量中的内容不是真正的 Coordinator 对象实例，它将失败。

```
((Coordinator)exp).coordinate(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:43:56.927

是的，你是对的，

这里同样的概念实现为父子关系因为子类的实例可以访问子类和父类的属性，但是父类的实例只能访问子类的属性......

这就是为什么它正在发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:47:42.810

每当您想调用 的方法时`Coordinator`，都必须将对象转换为`Coordinator`第一个。

```
((Coordinator)myTeacher).coordinatorMethod(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T23:47:54.260

不，因为类型安全。但你总是可以这样做：

```
Teacher exp = new Coordinator()
((Coordinator)exp).someCoordinatorMethodOrProperty() 
```

# php - 从另一个类访问 PDO 实例

> ID：14062764
> 
> 赞同：0
> 
> 时间：2012-12-27T23:44:07.353
> 
> 标签：php, class, pdo

这是我的 db 类，用于使用 pdo ext 连接数据库。

```
class db
{
    private $host;
    private $dbname;
    private $username;
    private $password;

    public function __construct($host,$db,$name,$pass)
    {
         $this->host=$host;
         $this->dbname=$db;
         $this->username=$name;
         $this->password=$pass;
         $dsn = 'mysql:'.$this->dbname.';'.$this->host;
         try 
         {
            $conn = new PDO($dsn, $this->username, $this->password);

            $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
         } 
         catch(PDOException $e) 
         {
              echo 'ERROR: ' . $e->getMessage();
         }
 }
} 
```

我像这样在登录类中调用 db 类...

```
$host='localhost';
        $db='techy_issue_tracker';
        $name='root';
        $pass='';
        $base= new db($host,$db,$name,$pass); 
```

这是问题，如果我使用这样的一行，要在登录类（扩展 db 类）中进行 pdo 查询...

```
$stmnt = $conn->prepare('SELECT id FROM users WHERE name :name OR email = :email'); 
```

它产生两个错误，说.. **注意：未定义的变量：conn ...和致命错误：调用非对象上的成员函数prepare（）...**

我可以通过简单地将所有 pdo 内容放在登录类中来解决这个问题，但我仍然很好奇......你们如何从另一个类调用对象（这是 pdo 类的实例？）。

[带有 PDO 的基于 PHP 类的用户系统 - 在非对象上调用成员函数 prepare()](https://stackoverflow.com/questions/13368129/php-class-based-user-system-with-pdo-call-to-a-member-function-prepare-on-a)这个问题很有趣，但不太了解：/

没有太多练习OOP，所以一些好的解释将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:47:18.030

您需要初始化`$conn`为`db`类的公共属性。

在您的`db`类中的私有属性之后，添加以下内容：

```
public $conn; 
```

然后，在您的 try catch 中，更改`$conn`为`$this->conn`：

```
$this->conn = new PDO($dsn, $this->username, $this->password);
$this->conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

然后，假设您已正确扩展`db`该类，您可以通过`conn`以下方式访问：

`$stmt = $db->conn->prepare('SELECT id FROM users WHERE name :name OR email = :email');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-06T14:01:03.480

您的 WHERE 子句中有一个错误：

```
WHERE name :name 
```

你错过了一个等号：

```
WHERE name = :name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:55:49.257

为什么不向 db 类添加一个方法，该方法接收一个 sql 字符串并返回一个对象数组。只需在该方法中执行所有声明即可。然后登录类可以调用这个方法来做任何查询。它不需要知道数据库连接是如何实现的。这样，如果您将来想更改底层实现。它只影响 db 类。由于所有数据库访问都通过 db 类，因此无需对登录类进行太多更改。

# jquery - jquery自动完成自动填充字段，第一个值和highligh添加部分

> ID：14062765
> 
> 赞同：10
> 
> 时间：2012-12-27T23:44:10.067
> 
> 标签：jquery, jquery-ui, jquery-autocomplete

我使用带有以下代码的 jqueryui 自动完成插件

```
$(this).autocomplete({
                source: function(request, response) {
                    $.ajax({ url: 'clinic/auto',
                    data: { 'term': this.term,'name': this.element.attr('complete')},
                    dataType: "json",
                    type: "POST",
                    success: function(data){
                        response(data);
                    }
                });
            },
            minLength: 2
        }); 
```

这会在下拉列表中显示所有结果的列表。

我的问题是如何让它为你自动完成工作并突出显示添加的部分以便于使用？

我必须编码吗？或者有一个已经存在的选项？如果我手动做它怎么做？示例图片： ![在此处输入图像描述](../Images/2bc3c31cb9db95122b695bd4305702e6.png)

**到目前为止的解决方案：**

我发现这个[链接](http://jsbin.com/ezifi/4) [，这](http://jsfiddle.net/rdworth/AgpaN/)对编辑样式非常有用（猴子补丁 jquery-autocomplete），但仍然不是我想要的..

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-06-18T04:22:51.430

不幸的是，它没有现有的选项。幸运的是，使用 JQuery Autocomplete 提供的事件有一种非常简单的方法。看看这个 JSFiddle：http: [//jsfiddle.net/RyTuV/133/](http://jsfiddle.net/RyTuV/133/)

您会注意到，您要添加的相关代码使用[JQuery Autocomplete Open 事件](http://api.jqueryui.com/autocomplete/?rdfrom=http%3A%2F%2Fdocs.jquery.com%2Fmw%2Findex.php%3Ftitle%3DUI%2FAutocomplete%26redirect%3Dno#event-open)：

> 当建议菜单打开或更新时触发。

使用此事件，您可以将列表中第一项的文本添加到已输入到输入字段中的内容中，然后从输入文本之后突出显示到添加文本的末尾：

```
$(this).autocomplete({
    source: function(request, response) {
                $.ajax({ url: 'clinic/auto',
                data: { 'term': this.term,'name': this.element.attr('complete')},
                dataType: "json",
                type: "POST",
                success: function(data){
                    response(data);
                }
            });
    },
    minLength: 2,
    open: function( event, ui ) {
        var firstElement = $(this).data("autocomplete").menu.element[0].children[0]
           , inpt = $('#autocomplete')
           , original = inpt.val()
           , firstElementText = $(firstElement).text();

        /*
           here we want to make sure that we're not matching something that doesn't start
           with what was typed in 
        */
        if(firstElementText.toLowerCase().indexOf(original.toLowerCase()) === 0){
            inpt.val(firstElementText);//change the input to the first match

            inpt[0].selectionStart = original.length; //highlight from end of input
            inpt[0].selectionEnd = firstElementText.length;//highlight to the end
        }
    }
}); 
```

使用它作为模板，您可以遍历菜单中的项目以找到以输入文本开头的第一个匹配项，并使用它来填充和突出显示，而不是仅使用第一项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T00:05:01.320

您需要自己编写代码或查看是否有其他自动完成插件可以执行此操作。

要自己编写代码，您需要引用[`response`](http://api.jqueryui.com/autocomplete/#event-response)事件以获取第一个匹配的结果文本并将其放入输入框中。要操作选定的文本，请参阅这篇文章：[使用 jQuery 在输入框中选择部分字符串](https://stackoverflow.com/questions/3085446/selecting-part-of-string-inside-an-input-box-with-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-03T15:04:02.040

找到上面的答案，但它有来自 jqueryUI 的下拉列表，所以我开始编写自己的脚本。并决定在这里发布。工作jsfiddle：[https ://jsfiddle.net/wb3kpxaj/](https://jsfiddle.net/wb3kpxaj/)

代码：

```
/* Need jquery to be extended with code snippet for selectrange i found somewhere, but forgot where...: */
$.fn.selectRange = function(start, end) {
  var e = document.getElementById($(this).attr('id')); // I don't know why... but $(this) don't want to work today :-/
  if (!e) return;
  else if (e.setSelectionRange) { e.focus(); e.setSelectionRange(start, end); } /* WebKit */ 
  else if (e.createTextRange) { var range = e.createTextRange(); range.collapse(true); range.moveEnd('character', end); range.moveStart('character', start); range.select(); } /* IE */
  else if (e.selectionStart) { e.selectionStart = start; e.selectionEnd = end; }
  return $(e); };

autofill=['Banana', 'Banonas', 'Appel', 'Appelpie', 'Other', 'OtherMoreSpecific', 'OtherMoreDifferent'];

$('#autofill').on('keyup', function(e) {
   unvalidInputKeys=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145];
  if($(this).val().length>0&&!unvalidInputKeys.includes(e.keyCode)) {
    for(i=0;i<autofill.length;i++) {
      if(autofill[i].startsWith($(this).val())) {
        userTypedLength=$(this).val().length;
        $(this).val(autofill[i]);
        $(this).selectRange(userTypedLength, autofill[i].length);
        return;
        }
      }
    }
  }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-20T19:24:54.480

Works great! On mobile devices: not so much though. The first item from the menu gets selected automatically after it shows up for the first time.

To avoid this, I came up with this **solution for mobile devices**:

```
 close: function( event, ui ) {
        let firstElement =  $(this).data("uiAutocomplete").menu.element[0].children[0]
           , inpt = $(this)
           , original = inpt.val()
           , firstElementText = $(firstElement).text();

        /*
           here we want to make sure that we're not matching something that doesn't start
           with what was typed in 
        */
        if(firstElementText.toLowerCase().indexOf(original.toLowerCase()) === 0){
            inpt.val(firstElementText);//change the input to the first match

            inpt[0].selectionStart = original.length; //highlight from end of input
            inpt[0].selectionEnd = firstElementText.length; //highlight to the end
            $("#zoominmap").click(); // trigger click on mobile
        }
    }, 
```

`close` instead `open` - and a click event on a button (`#zoominmap`) after the highlighting.

I have the whole code wrapped in this media query btw:

```
if (window.matchMedia('only screen
 and (min-device-width:120px)
 and (max-device-width:767px)').matches) {
/*
mobile
*/
} else {
/*
desktop
*/
} 
```

# c - 在C中搜索多个单词，并在它们之后显示以逗号分隔的信息

> ID：14062771
> 
> 赞同：0
> 
> 时间：2012-12-27T23:45:14.103
> 
> 标签：c, printf, fgets, string-search

假设我有一个 txt 文件：

日期：11/11/11

设备：Boxster

状态：好

我正在尝试让我的代码搜索一个单词（Say Device:），并在该单词之后显示信息（Boxster）。到目前为止，我的代码只能搜索一个单词。如何修复代码以便它可以搜索 2 或 3 个单词，并在它们之后显示信息？

如果我可以按以下格式显示信息会更有帮助：

Boxster，2011 年 11 月 11 日，很好。

这是我的代码，提前谢谢！

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
int main() {

    char file[100];
    char c[100];

    printf ("Enter file name and directory:");
    scanf ("%s",file);

    FILE * fs = fopen (file, "r") ;
    if ( fs == NULL )
    {
        puts ( "Cannot open source file" ) ;
        exit( 1 ) ;
    }

    FILE * ft = fopen ( "book5.txt", "w" ) ;
    if ( ft == NULL )
    {
        puts ( "Cannot open target file" ) ;
        exit( 1 ) ;
    }

    while(!feof(fs)) {
        char *Data;
        char *Device;
        char const * rc = fgets(c, 99, fs);

        if(rc==NULL) { break; }

        if((Data = strstr(rc, "Date:"))!= NULL)
            printf(Data+7);

        if((Data = strstr(rc, "Device:"))!=NULL)
            printf(Device+6);
    }

    fclose ( fs ) ;
    fclose ( ft ) ;

    return 0;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:45:05.663

注意 printf 和 fgets 的一些更改 您可以使用逻辑或`||` 对子字符串进行多次检查。

尝试：

```
char rc[120]={0x0};
while(fgets(rc, sizeof(rc), fs)!=NULL) {
        char *Data;
        char *Device;

        if((Data = strstr(rc, "Date:"))!= NULL)
            printf("%s\n", &Data[7]);

        if((Device = strstr(rc, "Device:"))!=NULL ||
            (Device = strstr(rc, "String:"))!=NULL ||
            (Device = strstr(rc, "foo:"))!=NULL )
            printf("%s\n", &Device[6]);
    } 
```

随着您了解有关搜索的更多信息，如果您的系统在 C 中支持正则表达式，您可能能够实现搜索的正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:17:56.253

@DaveWang

这是我认为可以很好地满足您的要求的东西：[https ://www.dropbox.com/sh/108lz7k6z50kq7v/kmj6NYsuMT](https://www.dropbox.com/sh/108lz7k6z50kq7v/kmj6NYsuMT)

让我知道它是否有帮助

# javascript - document.getElementById('textbox').value 停止工作

> ID：14062782
> 
> 赞同：0
> 
> 时间：2012-12-27T23:46:16.017
> 
> 标签：javascript, html, getelementbyid

我的代码很简单。我希望用户能够输入餐厅名称并让我的函数告诉他们该餐厅是否供应可口可乐或百事可乐产品。一个小时前它工作正常，但停止工作。现在，无论您输入什么，它都会显示作品“Pepsi”。我的猜测是 if 语句有问题。

```
<html>

<noscript><b><center><font size="16">This app requires JavaScript to be enabled. Enable JavaScript on your browswer to make it work.</font></center></b></noscript>

<center>
<form onsubmit="popproducts()">

<br><br><br><br><br><br><br><br><br>
<input id="textbox" type="text" style="height: 100px; width: 500px" value=""></input>
</br></br></br></br></br></br></br></br></br>

</form>
</center>

<script type="text/javascript">

function popproducts()
{
 if(document.getElementById('textbox').value == "Cougars" || "Kane County Cougars" || "Cougars Baseball")
 {
  document.write('<center><br><font color="#0000FF" size=20></b>Pepsi</b></font></br></center>');
  document.write('<br><br><center><form><input type="button" style="height: 100px; width: 100px" value="Back" onClick="history.go(-1);return true;"></form></center></br></br>');
 }
 if(document.getElementById('textbox').value == "Burge" || "Iowa" || "University of Iowa")
 {
  document.write('<center><br><font color="#FF0000" size=20><b>Coke</b></font></br></center>');
  document.write('<br><br><center><form><input type="button" style="height: 100px; width: 100px" value="Back" onClick="history.go(-1);return true;"></form></center></br></br>');
 }
}

</script>

</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:50:48.950

这是行：

```
if(document.getElementById('textbox').value == "Cougars" || "Kane County Cougars" || "Cougars Baseball") 
```

它*应该*是：

```
if(document.getElementById('textbox').value == "Cougars" || document.getElementById('textbox').value == "Kane County Cougars" || document.getElementById('textbox').value == "Cougars Baseball") 
```

第一部分评估为`true`或`false`取决于您键入的内容，但第二部分和第三部分将始终评估为`true`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:51:45.107

这是你的问题：

```
if(document.getElementById('textbox').value == "Cougars" || "Kane County Cougars" || "Cougars Baseball") 
```

当您有一个带有*or*运算符的`if`语句时，praser 将其解释为：*`||`*

 *```
if(doc....value == "Cougars || "Kane Country Cougars" != false...) 
```

换句话说，if 语句始终为*真*，因为字符串`"Kane Country Cougars"`不为假。要修复它，您应该这样做：

```
var val = document.getElementById('textbox').value;
if(val == "Cougars" || val == "Kane County Cougars" || val == "Cougars Baseball") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T23:56:33.953

所有其他答案都很好，但这是我通常的做法：

```
var value = document.getElementById('textbox').value;

if ( /^Cougars|Kane County Cougars|Cougars Baseball$/.test( value ) ) {
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:51:22.463

您`||`错误地使用了运算符。如果你想检查一个值是否等于多个值之一，你必须明确地传达它。例如：

```
if ( a == b || a == c || a == d ) 
```

以其他方式执行此操作会导致您遇到意外行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T08:00:18.257

尝试这个，

```
var value = document.getElementById('textbox').value;
if (value == 'Cougars' || value == 'Kane County Cougars' || value == 'Cougars Baseball') 
```*

# python - 一次又一次地重复输出

> ID：14062784
> 
> 赞同：-1
> 
> 时间：2012-12-27T23:46:21.413
> 
> 标签：python

我正在尝试制作一个计算气门间隙的程序。这是我制作的第一个程序，所以我一直在摸索。现在，这就是我到目前为止所得到的。如果我输入一个超出范围的许可，它会打印“Right Intake is OUT OF RANGE”，就像它应该的那样。但是如果它在范围内，那么它会一遍又一遍地用“正确的进气口在范围内”填充我的屏幕，直到我杀死它。我错过了什么？

```
#Clearance calculator
#clearances are in clearances.txt

targets = open("clearances.txt", "r")
lines = targets.readlines()   #get target clearances from file

in_min_target = float(lines[2])     #minimum intake clearance
in_max_target = float(lines[4])     #maximum intake clearance

ex_min_target = float(lines[8])    #miminum exhaust clearances
ex_max_target = float(lines[10])   #maximum exhaust clearances
targets.close

target_intake = (in_min_target + in_max_target) / 2     #find the ideal intake
target_exhaust = (ex_min_target + ex_max_target) / 2    #find the ideal exhaust

print "Intake Min: ", in_min_target
print "Intake Max: ", in_max_target
print "Exhaust Min: ", ex_min_target
print "Exhaust Max: ", ex_max_target
print """Target intake: %r
Target Exhaust: %r""" % (target_intake, target_exhaust)

print""
print "Enter current RIGHT side Intake clearance"
cur_r_in = float(raw_input(">"))
print ""
print "Enter current RIGHT side Exhaust clearance"
cur_r_ex = float(raw_input(">"))
print ""
print "Enter current LEFT side Intake clearance"
cur_l_in = float(raw_input(">"))
print ""
print "Enter current LEFT side Exhaust clearance"
cur_l_ex = float(raw_input(">"))

target=5

def in_range(min, max, cur, valve, target):
    while min <= cur <= max:
        print "%r is in range." % valve
    target=1
else:
    print "%r is OUT OF RANGE." %valve
    target=0
return target

def ex_range(min, max, cur, valve, target):
if min <= cur <= max:
    print "%r is in range." % valve
    target=1
else:
    print "%r is OUT OF RANGE." %valve
    target=0

valve = "Right Intake"
print in_range(in_min_target, in_max_target, cur_r_in, valve, target)

print ""

valve = "Right Exhaust"
print ex_range(ex_min_target, ex_max_target, cur_r_ex, valve, target)

print ""

valve = "Left Intake"
print in_range(in_min_target, in_max_target, cur_l_in, valve, target)

print ""

valve = "Left Exhaust"
print ex_range(ex_min_target, ex_max_target, cur_l_ex, valve, target) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:48:07.877

你告诉它在范围内时继续循环和打印：

```
while min <= cur <= max:
    print "%r is in range." % valve 
```

我怀疑你想要一个`if`声明：

```
if min <= cur <= max:
    print "%r is in range." % valve 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:48:20.393

您必须更改条件中的值，以便它可以停止。

```
def in_range(min, max, cur, valve, target):
    while min <= cur <= max:
        print "%r is in range." % valve 
```

这意味着，您必须更改其中一个值`min`、`cur`或`max`，或多个值，以打破无限循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:50:18.690

这一行：

```
while min <= cur <= max: 
```

是你的问题，我相信。While 将重复评估附加到它的主体，直到条件失败。但是你的身体没有做任何事情来改变这种情况，所以它只会永远持续下去。我猜你的意思是/需要使用`if`而不是`while`那里......

# c++ - 字符串实现的排列问题

> ID：14062789
> 
> 赞同：1
> 
> 时间：2012-12-27T23:47:00.267
> 
> 标签：c++, stl, runtime-error

我正在研究字符串问题的所有排列。目前，我正在使用一个 char 列表来表示一个字符串。字符列表的列表将代表所有可能的排列。

算法非常简单。对于每个长度为 n 的字符串，您会想要切掉第一个字母并找到 nl 字符串的所有排列。然后，您将在较小字符串的每个位置插入第一个字母。插入第一个字母导致我运行时异常，我似乎无法弄清楚在哪里。

主文件

```
#include <vector>
#include <list>

using namespace std;

int main (void){

    list<char> s;

    s.push_back('f');
    s.push_back('c');
    s.push_back('g');

    list<list<char> > mylist;
    list<char>::iterator vit;
    list<char> myvector;
    mylist = perm(s,mylist);

    for(list<list<char> >::iterator it = mylist.begin(); it != mylist.end(); ++it){
        myvector = *it;
        for(vit = myvector.begin(); vit != myvector.end(); ++vit){
            cout << *vit << " ";
        }
        cout << "\n" << endl;
    }

    getchar();
    return 0;   
} 
```

执行：

```
list<list <char> > perm(list<char> s, list<list<char> > mylist){
    int n = s.size();

    if(n == 1){
        mylist.push_back(s);
        return mylist;

    }

    else{
        list<char>::iterator vit = s.begin();
        char first = *vit;
        s.erase(vit);        

        list<list<char> > listB = perm(s,mylist);

        for(list<list<char> >::iterator it = listB.begin(); it != listB.end(); ++it){
            list<char> myvector = *it;
            for(list<char>::iterator vit2 = myvector.begin(); vit != myvector.end(); ++vit){
                cout << *vit2 << endl;
                vit2 = myvector.insert(vit2,first);
                cout << *vit2 << endl;
                mylist.push_back(myvector);
                myvector.erase(vit2);
            }
        }

        return mylist;
    }

} 
```

输出：

```
 g
                c
                c
                f
                f 
```

然后是运行时异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T23:48:27.983

tl;博士

只需使用`std::next_permutation`.

# r - 具有不同 data.frames 的两个 geom_bar 的不同图例

> ID：14062792
> 
> 赞同：1
> 
> 时间：2012-12-27T23:47:25.330
> 
> 标签：r, ggplot2

这让我困惑了好一阵子……

我想用不同的data.frames为两个不同的geoms（geom_bar）显示两个不同的图例。

第一个图例应该有标题“边框”（由 df.1 的边框填充），第二个应该有标题“产品”（由 df.2 的产品填充）。两个 data.frames 都有共同的 column=category 。

你能解释一下吗？

这是示例

```
#library(ggplot2)

df.1 <- data.frame(category=c("A","A","A","B","B","B"),
border=c("I","II","III","I","II","III"),
value=c(1,2,1,2,1,2)
)

df.2 <- data.frame(category=c("A","A","A","B","B","B"),
product=c("P1","P2","P3","P1","P2","P3"),
value=c(1,2,3,3,1,2)
)

ggplot()+
geom_bar(aes(x=category, y=value, fill=border), data=df.1, width=.3)+
geom_bar(aes(x=category, y=value, fill=product), data=df.2, position="dodge", width=.25) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:54:48.280

一种美学 -> 一种传说是 ggplot 中的一种基本设计原则。你可以（有点）绕过它，但这很困难。要尝试的一件事，看起来还不错，是这样的：

```
ggplot()+
    geom_bar(aes(x=category, y=value, fill=border), data=df.1, width=.3)+
    geom_bar(aes(x=category, y=value, colour=product), data=df.2, position="dodge", width=.25,alpha = 0.5) 
```

![在此处输入图像描述](../Images/2224835db6bdc45164d65bbba9a40676.png)

# php - 简化目录列表

> ID：14062797
> 
> 赞同：2
> 
> 时间：2012-12-27T23:47:44.573
> 
> 标签：php, algorithm

假设用户是否能够选择一些目录进行搜索。他勾选了以下目录：

```
http://google.com/apple
http://google.com/apple/red
http://google.com/apple/green
http://google.com/apple/yellow
http://google.com/orange
http://google.com/orange/1 
```

当准备好将这些数据插入到数据库中时。有没有办法让我可以通过 PHP 简化列表，以便显示如下内容：

```
http://google.com/apple
http://google.com/orange 
```

谢谢赛勒斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:12:01.620

这应该可以解决问题：

```
sort( $paths );

$previous = $paths[0];
$simplified = array( $previous );

foreach ( $paths as $path ) {
    if ( $previous != substr( $path, 0, strlen( $previous ) ) ) {
        $simplified[] = $previous = $path;
    }
} 
```

此代码依赖于字符串在其自身的任何扩展之前排序的事实。请注意，它不会以任何特殊方式处理斜杠，因此它认为，比如说，它`"quux/foo"`是一个有效的前缀`"quux/foobar"`（这并不像我最初想象的那样容易正确修复）。如果您不希望这样，请确保您的路径在适当的地方有斜杠。

# python - 小写应用程序路由

> ID：14062799
> 
> 赞同：0
> 
> 时间：2012-12-27T23:47:48.483
> 
> 标签：python, routing, flask

```
@app.route("/<requested_username>/<requested_team>", methods=['GET', 'POST']) 
```

^我如何做到这一点，以便无论输入什么 - 它仍然会转到正确的 url

例如：

```
/jose/SWaGGer   #should work
/jOse/swagger   #should work
/josE/Swagger   #should work
etc. 
```

哦，顺便说一句，我正在使用 Python/Flask - 不，我没有在文档中找到对此的解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:50:12.933

在使用它们之前，在您的视图方法中调用`lower()`您的字符串。如果这样做，它们将始终以小写形式存储和使用。

例如：

```
@app.route('/user/<requested_username>/<requested_team>')
def thing(requested_username, requested_team):
    requested_team = requested_team.lower()
    requested_username = requested_username.lower()

    ... then continue with the view 
```

然后，您应该始终将字符串以小写形式存储在数据库中，因此请`lower`在保存之前调用。

# android - 为什么 eglMakeCurrent() 因 EGL_BAD_MATCH 而失败？

> ID：14062803
> 
> 赞同：20
> 
> 时间：2012-12-27T23:48:08.833
> 
> 标签：android, c++, opengl-es

我正在使用 opengl/egl 为 Android 开发。我的应用程序需要第二个上下文来从第二个线程加载纹理。

我的代码在 android 2.3 上运行良好，但是当我在 4.0.3 android 设备或模拟器上尝试代码时，eglMakeCurrent() 失败并显示 EGL_BAD_MATCH。

第二个上下文的初始化和它的像素缓冲区也都工作正常，所以我不确定从哪里开始寻找这个错误。

这是初始化代码：

```
ANativeWindow *window = (ANativeWindow*)displaySurface;

EGLint dummy, format;

display = eglGetDisplay(EGL_DEFAULT_DISPLAY);

eglInitialize(display, 0, 0);

EGLint contextAttribs[] =
{
    EGL_CONTEXT_CLIENT_VERSION, 2, EGL_NONE
};

const EGLint configAttribs[] =
{
    EGL_SURFACE_TYPE, EGL_WINDOW_BIT,
    EGL_RENDERABLE_TYPE, EGL_OPENGL_ES2_BIT,
    EGL_BLUE_SIZE, 8,
    EGL_GREEN_SIZE, 8,
    EGL_RED_SIZE, 8,
    EGL_ALPHA_SIZE, 8,
    EGL_BUFFER_SIZE, 32,
    EGL_DEPTH_SIZE, 24,
    EGL_NONE
};

EGLint numConfigs;
EGLConfig config;

eglChooseConfig(display, configAttribs, &config, 1, &numConfigs);
eglGetConfigAttrib(display, config, EGL_NATIVE_VISUAL_ID, &format);
ANativeWindow_setBuffersGeometry(window, 0, 0, format);

surface = eglCreateWindowSurface(display, config, window, NULL);
if(surface == NULL)
    Trace("error creating window surface: " + GetEglError());

context = eglCreateContext(display, config, EGL_NO_CONTEXT, contextAttribs);
if(context == NULL)
    Trace("error creating main context: " + GetEglError());

const EGLint auxConfigAttribs[] =
{
    EGL_SURFACE_TYPE, EGL_PBUFFER_BIT,
    EGL_BLUE_SIZE, 8,
    EGL_GREEN_SIZE, 8,
    EGL_RED_SIZE, 8,
    EGL_ALPHA_SIZE, 8,
    EGL_DEPTH_SIZE, 0,
    EGL_STENCIL_SIZE, 0,
    EGL_NONE
};

EGLint pbufferAttribs[] =
{
    EGL_WIDTH, 1,
    EGL_HEIGHT, 1,
    EGL_TEXTURE_TARGET, EGL_NO_TEXTURE,
    EGL_TEXTURE_FORMAT, EGL_NO_TEXTURE,
    EGL_NONE
};

EGLint auxNumConfigs;
EGLConfig auxConfig;

eglChooseConfig(display, auxConfigAttribs, &auxConfig, 1, &auxNumConfigs);

auxSurface = eglCreatePbufferSurface(display, auxConfig, pbufferAttribs);
if(auxSurface == NULL)
    Trace("error creating pbuffer surface: " + GetEglError());

auxContext = eglCreateContext(display, auxConfig, context, contextAttribs);
if(auxSurface == NULL)
    Trace("error creating auxilliary context: " + GetEglError());

if(!eglMakeCurrent(display, surface, surface, context))
    Trace("could not make main context current: " + GetEglError()); 
```

在我的 Android 2.3 设备（HTC Desire）上，上面的初始化代码完美运行，我可以使 auxContext 成为当前的，并且加载纹理就好了。

但是，在我的 android 4.0.3 设备（Samsung Nexus S）和我的 Android 4.1 设备（Galaxy Note 2）上，eglMakeCurrent() 在成功初始化后失败并出现 EGL_BAD_MATCH。

有谁知道为什么我可能会收到此错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-28T00:04:41.100

啊，我实际上知道一些事情。;) [花费了 5 年中最好的部分来研究各种 EGL 实施]。

我很确定您`surface`的格式与实际显示表面的格式不同。我不确定到底有什么区别，或者你需要改变什么。EGL_DEPTH_SIZE 也许？您可以尝试枚举可用的模式，看看是否有“可能”。我知道，这有点痛苦，但我过去曾做过几次——不同之处在于我通常可以查看 EGL 源代码并找出我做错了什么...... ;)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-28T08:25:06.807

如果您收到此错误但未处理此表面或纹理内容，请运行并键入 .android 转到 AVD 和您当前的模拟器通常在 .img 文件上删除用户日期文件，重新启动模拟器然后测试。这对我有用，如果它在您的设备上进行测试时发生，请清除数据并重新启动您的应用程序。为那些觉得这很有帮助的人干杯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-18T16:11:55.457

确保您已在传递给调用的属性中设置`EGL_PBUFFER_BIT`了。这对我有用`EGL_SURFACE_TYPE``eglChooseConfig()`

# cocoa - Cocoa Objective-C 中的简单动画

> ID：14062809
> 
> 赞同：0
> 
> 时间：2012-12-27T23:48:33.943
> 
> 标签：cocoa, animation

我为 iOS 游戏编写了一个简单的动画，我正在尝试将其转换为 Mac OS。

这是我的 iOS 代码

```
NSMutableArray *imgArr = [[[NSMutableArray alloc] init] autorelease];

    for(int i = 1; i < 6 + 1; i++) {
        [imgArr addObject: [UIImage imageNamed:[NSString stringWithFormat:@"%@%d.png", filePrefix, i]]];
    }

    UIImageView * animation = [[UIImageView alloc] initWithFrame:rect];
    animation.animationImages = imgArr;

    animation.animationRepeatCount = 1;
    [animation startAnimating];

    [self.view addSubview:animation]; 
```

至于可可，这部分给出了错误。我该如何解决这个问题？

```
//animation.animationImages = imgArr;

//animation.animationRepeatCount = 1;
//[animation startAnimating]; 
```

带计时器的新代码

```
for(int i = 0; i < 6; i++)
    [NSTimer scheduledTimerWithTimeInterval:1
                                     target:self
                                   selector:@selector(anim)
                                   userInfo:nil
                                    repeats:NO];

- (void)anim {
    ++num;

    NSImageView *animation = [[NSImageView alloc] initWithFrame:NSMakeRect(shipPosition.x, shipPosition.y, shipSize.width, shipSize.height)];

    [animation setImage: [NSImage imageNamed:[NSString stringWithFormat:@"explosprite%d.png", num]] ];
    [objectView addSubview:animation];

    [animation release];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:20:10.580

UIImageView 在 Cocoa 中根本不存在。Cocoa 并没有像您在这里尝试做的那样真正支持精灵动画。AFAIK 最常见的方法是设置一个 NSTimer 并在计时器触发时适当地更新图像。

您还可以创建一个处理动画图像的自定义 CALayer 子类。我不确定这是否一定更容易，但这是一种选择。

# jquery - 结果得到反对的命令

> ID：14062812
> 
> 赞同：-1
> 
> 时间：2012-12-27T23:48:51.530
> 
> 标签：jquery, arrays, click, each

检查此代码：

```
var test = new Array();

//I need each() to get the data from every row
$(".quiz_list_row").each(function(index){

    // Gets the data necessary from HTML5 tag data
    $quiz_list_id = $(this).data("quizlistId");
    $quiz_level_reached = $(this).data("quizlevelReached");

    test [0] = new Array($quiz_list_id,$quiz_level_reached);

    $(this).click(function(){
    alert("test: "+test.toString());
    });
)}; 
```

div是这样的（这是正确的）：

```
<div class="quiz_list_row" data-quizlist-id="1" data-quizlevel-reached="5">
     <div class="inline" id="quiz_list_cell_id1">Quiz 1</div>
     <div class="inline" id="quiz_list_cell_id2">Current level: 5</div>
</div>
<div class="quiz_list_row" data-quizlist-id="2" data-quizlevel-reached="7">
     <div class="inline" id="quiz_list_cell_id1">Quiz 2</div>
     <div class="inline" id="quiz_list_cell_id2">Current level: 7</div>
</div> 
```

因此，当我单击第一个 div 时，应该在第一个警报上显示“1,5”，在第二个警报上显示“2,7”，我得到相反的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:56:42.320

你`test[0]`在循环的每一次都写完了

尝试替换`test[0]=`为：

```
test.push([$quiz_list_id,$quiz_level_reached]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T08:33:40.040

以下是我所做的更改：

```
var test = new Array();

$(".quiz_list_row").each(function(index){
        // Gets the data necessary to show game chosen
        $quiz_list_id = $(this).data("quizlistId");
        $quiz_level_reached = $(this).data("quizlevelReached");

            test.push($quiz_list_id,$quiz_level_reached);

        $(this).click(function(){
            alert("test: "+test);
        });

}); 
```

div：

```
<div class="quiz_list_row" data-quizlist-id="1" data-quizlevel-reached="5">
    <div class="inline quiz_list_cell" id="quiz_list_cell_row0_id1">Quiz 1</div>
    <div class="inline quiz_list_cell" id="quiz_list_cell_row0_id2">Current level: 5</div>
</div>
<div class="quiz_list_row" data-quizlist-id="2" data-quizlevel-reached="7">
    <div class="inline quiz_list_cell" id="quiz_list_cell_row1_id1">Quiz 2</div>
    <div class="inline quiz_list_cell" id="quiz_list_cell_row1_id2">Current level: 7</div>
</div> 
```

学分在评论中，好吗？

# java - Java Applet 和 ServiceLoader

> ID：14062813
> 
> 赞同：0
> 
> 时间：2012-12-27T23:49:03.467
> 
> 标签：java, jar, applet, noclassdeffounderror, serviceloader

默认情况下，Java Applet 不会从 someJar.jar!/META-INF/services/ 加载服务类，这会导致 NoClassDefFoundError 异常。

如何让它发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:52:31.697

也许通过使用小程序的 codebase_lookup 属性？

[http://docs.oracle.com/javase/6/docs/technotes/guides/plugin/developer_guide/special_attributes.html](http://docs.oracle.com/javase/6/docs/technotes/guides/plugin/developer_guide/special_attributes.html)

以上还暗示您的服务或者捆绑在您的小程序 jar 中，或者您还指定了“代码库”

# windows-8 - 需要时显示虚拟键盘

> ID：14062816
> 
> 赞同：0
> 
> 时间：2012-12-27T23:49:35.477
> 
> 标签：windows-8, microsoft-metro

有一个名为的选项`SearchPane.ShowOnKeyboardInput`显示`Search Charm`用户开始输入的时间。

我的问题是，如果用户在`Surface`平板电脑上运行我的应用程序，并且没有连接键盘，那么用户就没有键盘可以“开始输入”。

我尝试`Search Charm`在一开始就显示，但这有时会导致意想不到的结果。**窗口有时会**显示虚拟（屏幕键盘）。

克服这个问题的最佳方法是什么？

# android - 如何在 Android 中拥有最新的 UI 组件？

> ID：14062822
> 
> 赞同：0
> 
> 时间：2012-12-27T23:50:30.343
> 
> 标签：android, android-layout

我注意到，随着 Android 平台的每一次迭代，按钮和 UI 组件看起来越来越流畅。除了 API 更改之外，我希望能够在使用我的应用程序的所有版本的 Android 中采用最新的按钮（例如右下角作为箭头的微调器）或果冻豆图标。这通常是如何实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:53:56.853

> 我希望能够在使用我的应用程序的所有 Android 版本中采用最新的按钮。

[Holo Everywhere](https://github.com/ChristopheVersieux/HoloEverywhere#readme)库是执行此操作的热门选择。

# c# - 模块 System.Windows.dll 中缺少类型 System.Windows.Automation.Peers.FrameworkElementAutomationPeer

> ID：14062824
> 
> 赞同：0
> 
> 时间：2012-12-27T23:50:38.907
> 
> 标签：c#, xaml, windows-8

在模块 System.Windows.dll 中找不到类型 System.Windows.Automation.Peers.FrameworkElementAutomationPeer。

如何解决此错误？我缺少什么命名空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:02:41.053

根据 MSDN，`System.Windows.Automation.Peers`命名空间位于`PresentationFramework.dll`

您的应用程序中是否引用了 PresentationFramework.dll？

MSDN： http: [//msdn.microsoft.com/en-us/library/system.windows.automation.peers.frameworkelementautomationpeer (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.windows.automation.peers.frameworkelementautomationpeer(v=vs.110).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:18:19.517

从参考中删除了 Microsoft.Phone.Controls.Maps.dll。

# c# - 如何使用反射和抽象对象来动态加载类？

> ID：14062827
> 
> 赞同：4
> 
> 时间：2012-12-27T23:50:51.513
> 
> 标签：c#, oop, dynamic, reflection

我正在构建一个协议处理程序。该协议可能支持一组未知的请求类型，我将有一个实现每种请求类型的类。这些请求处理程序类将扩展一个基本处理程序类。我正在尝试构建系统，以便为了支持新的请求类型，我需要做的就是为此添加一个类并重新编译/部署/重新启动服务。

所以我有这样的事情：

```
foreach (Type classType in protocolAssembly.GetTypes())
{
    if (classType.BaseType == typeof(ProtocolRequestHandler))
    {
        if (supportedRequestsMap.Contains(classType.Method))
        {
            // error: that method is already implemented!
        }

        supportedRequestsMap.Add(classType.Method, typeof(classType));
    }
} 
```

*只要声明了它处理的请求方法，就会*在服务重新启动时添加一个新类。

 *如何在编译时通过基类**ProtocolRequestHandler**强制实现属性**Method**？我不想将方法类型用作“Null”或“Unknown”，或者抛出异常，也不想在扩展类的名称中固有地指定支持的协议请求类型（我想调用我喜欢的课程）。

有什么方法可以强制一个属性在继承类中设置它的值？

有没有一种更简洁的方法可以进行这种动态加载？我应该使用属性来确定继承类的支持方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T23:56:09.073

您应该依赖接口作为插件应该实现哪些方法的合同。
一个（有点旧，但仍然非常相关）很好的教程可以在[这里找到](http://www.codeproject.com/Articles/4691/Plugin-Architecture-using-C)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T23:59:04.190

如果您使用的是基类，为什么不将所需的方法创建为抽象方法（或虚拟方法，并尽可能指定默认实现）。这将确保该方法存在于您继承的类中。我相信如果您正在反思并编写自己的协议处理程序，您可能已经知道这一点，但不确定是否有更好的方法来获得您想要的东西。*

# php - 将 javascript 变量传递给 php

> ID：14062832
> 
> 赞同：-2
> 
> 时间：2012-12-27T23:51:57.630
> 
> 标签：php, javascript

新手问题，如果有一个明显的答案，请原谅（我已经尝试了我能想到的一切）。

我有一个像这样的javascript变量设置：

```
var imageURL = <?php echo json_encode($imageRows[0]['URL_Path']); ?>; 
```

其中 $imageRows[0] 可以是从 0 到任何值的整数。

我还有另一个像这样的变量：

```
var count = 15 
```

我需要将计数传递给 imageURL 变量...可以这样做吗？

我猜想是这样的：

```
 var imageURL = <?php echo json_encode($imageRows['count']['URL_Path']); ?>;

 var imageURL = <?php echo json_encode($imageRows[(count)]['URL_Path']); ?>; 
```

等，但没有任何工作。

谢谢

编辑：由迈克布兰特回答。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:54:22.537

我现在更好地理解了你的问题。看起来您正试图让 PHP 响应 Javascript 中的变量并回显输出。您可以将计数放入查询字符串（`http://server/yourpage.php?count=15`）中，然后将`count`变量放入您的 php 中，如下所示：`$_GET['count']`

编辑：从您的评论看来，您实际上确实将此计数作为 PHP 变量（从 MYSQL 返回）。您的困难可能来自 PHP 对字符串插值的解释。它将`[]`after`$imageRows`视为 PHP 表达式的一部分，您似乎想将 count 作为 javascript 变量传递。`$imageRows[$count]`如果你已经有一个`$count`PHP 变量，你可以这样做。如果您必须将其作为 javascript 变量，您可以执行`var count = <?php echo $count?>;`然后回显 all 的 JSON `{$imageRows}`，在 javascript 中使用`count`.

（以前：为什么你不能只使用`$count`？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:55:28.697

不是您考虑的方式，但您始终可以在页面加载时执行 AJAX 请求，这将允许您将两个变量作为标准请求参数传递给 PHP（或任何 Web 服务器）。

以jQuery [#ajax](http://api.jquery.com/jQuery.ajax/)为例。

```
$.ajax({
  url: 'example.php',
  data: {
    count: count
  },
  success: function(data) {
    // Do something with the data
  }
}); 
```

然而，上面是一个非常粗略的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T00:02:23.350

你为什么不只是`json_encode()`整个`$imageRows`变量。然后你可以在 javascript 中免费访问它。像这样：

```
var image_urls = <?php echo json_encode($imageRows); ?>;
var count = 15;
var the_url_you_want = image_urls[count]['URL_PATH']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T23:54:32.317

（编辑是因为您更改了问题以便我更好地理解它）

PHP 将无法在浏览器端读取 JavaScript 变量的值，您必须将其作为 POST 变量或 cookie 传递给页面。

# php - MySQLi 程序查询，怎么了？

> ID：14062834
> 
> 赞同：0
> 
> 时间：2012-12-27T23:52:10.123
> 
> 标签：php, mysql, mysqli

```
//Successful connection to $db

function insert_users($db, $username, $password, $email)
{
    echo "FUNCTION CALLED"; //This is outputted successfully

    $query = "INSERT INTO `users` (`id`, `username`, `password`, `email`) VALUES ('', ?, ?, ?)";
    $stmt = mysqli_stmt_init($db);

    if(mysqli_stmt_prepare($stmt, $query))
    {
        echo "QUERY PREPARED"; // rest of code was snipped (will put up upon request)
    } else {
        echo "QUERY DENIED"; //This is outputted successfully
    }
}

//The $user $pass and $mail are defined and then the function is called

insert_users($db, $user, $pass, $mail); 
```

数据库结构：

```
testdb (database)
    -> users (table)
        -> id            //Primary key, unique key
        -> username      //unique key
        -> password
        -> email 
```

为什么查询不通过它的操作？它回显“查询被拒绝”而不是“查询准备”。我相信该查询无效。如果需要更多信息，很乐意编辑此问题

**编辑**

我添加了

`mysqli_stmt_error($stmt);`什么都没有发生之后`echo "QUERY DENIED";` ……

**编辑 2**

```
$server = 'localhost';
$user = 'root';
$password = '';
$databse = 'testdb';

$db = @mysqli_connect($server, $user, $password, $database) or die("Could not connect to Database server. Please inform an administrator"); 
```

这是我的数据库设置。我是否将变量放在引号中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:57:37.120

如果`id`是 auto_increment 列，则可以将其从插入中删除

```
INSERT INTO `users` (`username`, `password`, `email`) VALUES (?, ?, ?) 
```

你有一个错字`$databse = 'testdb';`。将其重命名为`$database`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:58:06.033

我想这是因为你总是试图输入一个空字符串作为你的主键（`id`）。如果该字段是自动递增字段，则您甚至都不应该尝试为其设置值。

```
$query = "INSERT INTO `users` (`username`, `password`, `email`) VALUES (?, ?, ?)"; 
```

# python - 用 BeautifulSoup 解析 HTML

> ID：14062836
> 
> 赞同：2
> 
> 时间：2012-12-27T23:52:31.443
> 
> 标签：python, beautifulsoup

![在此处输入图像描述](../Images/51224e7a84b848d2e97a45191b0cca2b.png)

（图片很小，这里是另一个链接：http: [//i.imgur.com/OJC0A.png](https://i.imgur.com/OJC0A.png)）

我正在尝试在底部提取评论的文本。我试过这个：

```
y = soup.find_all("div", style = "margin-left:0.5em;")
review = y[0].text 
```

问题是未展开的`div`标签中有不需要的文本，从评论内容中删除变得乏味。对于我的生活，我无法弄清楚这一点。有人可以帮我吗？

编辑：HTML是：

```
div style="margin-left:0.5em;">
    <div style="margin-bottom:0.5em;"> 9 of 35 people found the following review helpful </div>
    <div style="margin-bottom:0.5em;">
    <div style="margin-bottom:0.5em;">
    <div class="tiny" style="margin-bottom:0.5em;">
        <b>
    </div>
    That is true. I tried it myself this morning. There's a little note on the Audible site that says "a few titles will require two credits" or something like that. A Dance with Dragons is one of those few. 
```

文本上方的div标签如下：

```
<div class="tiny" style="margin-bottom:0.5em;">
    <b>
        <span class="h3color tiny">This review is from: </span>
        <a href="https://rads.stackoverflow.com/amzn/click/com/B005C7QVUE" rel="nofollow noreferrer">A Dance with Dragons: A Song of Ice and Fire: Book 5 (Audible Audio Edition)</a>
    </b>
</div>
That is true. I tried it myself this morning. There's a little note on the Audible site that says "a few titles will require two credits" or something like that. A Dance with Dragons is one of those few. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:08:40.337

要获取尾部的文本`div.tiny`：

```
review = soup.find("div", "tiny").findNextSibling(text=True) 
```

完整示例：

```
#!/usr/bin/env python
from bs4 import BeautifulSoup

html = """<div style="margin-left:0.5em;">
<div style="margin-bottom:0.5em;">
   9 of 35 people found the following review helpful </div>
<div style="margin-bottom:0.5em;">
<div style="margin-bottom:0.5em;">
<div class="tiny" style="margin-bottom:0.5em;">
<b>
    <span class="h3color tiny">This review is from: </span>
    <a href="http://rads.stackoverflow.com/amzn/click/B005C7QVUE">
     A Dance with Dragons: A Song of Ice and Fire: Book 5 (Audible Audio Edition)</a>
</b>
</div>
That is true. I tried it myself this morning. There's a little note on the Audible site that says "a few titles will require two credits" or something like that. A Dance with Dragons is one of those few."""

soup = BeautifulSoup(html)
review = soup.find("div", "tiny").findNextSibling(text=True)
print(review) 
```

### 输出

```
那是真实的。今天早上我自己试过了。Audible 网站上有一个小注释，上面写着“一些标题需要两个学分”或类似的东西。《魔龙狂舞》就是其中之一。

```

`lxml`这是产生相同输出的等效代码：

```
import lxml.html

doc = lxml.html.fromstring(html)
print doc.find(".//div[@class='tiny']").tail 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T00:06:15.793

[http://www.crummy.com/software/BeautifulSoup/bs4/doc/#strings-and-stripped-strings](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#strings-and-stripped-strings)建议 .strings 方法是您想要的 - 它返回对象中每个字符串的迭代器。因此，如果您将该迭代器转换为列表并获取最后一项，您应该得到您想要的。例如：

```
$ python
>>> import bs4
>>> text = '<div style="mine"><div>unwanted</div>wanted</div>'
>>> soup = bs4.BeautifulSoup(text)
>>> soup.find_all("div", style="mine")[0].text
u'unwantedwanted'
>>> list(soup.find_all("div", style="mine")[0].strings)[-1]
u'wanted' 
```

# php - PHP MYSQL Query AS 更大的问题

> ID：14062838
> 
> 赞同：0
> 
> 时间：2012-12-27T23:52:36.940
> 
> 标签：php, mysql

我需要 AS 查询，但示例：

rat ='10' 或 rat >='10' 对于这个查询；

```
$minimalEntry = mysql_query("SELECT author,count(id) AS rat 
                               FROM sds_posts 
                           GROUP BY author 
                           ORDER BY rat ASC 
                              LIMIT 0,20"); 
```

谢谢你..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:14:42.120

你需要`HAVING`子句：

```
SELECT author, COUNT(id) AS rat 
FROM sds_posts 
GROUP BY author 
HAVING COUNT(id) >= 10
ORDER BY rat ASC 
  LIMIT 0,20 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T23:55:34.423

只需添加一个 WHERE 条件。

```
$minimalEntry = mysql_query("SELECT author,count(id) AS rat 
                             FROM sds_posts 
                             WHERE count(id)  >= 10 
                             GROUP BY author 
                             ORDER BY rat ASC 
                             LIMIT 0,20"
                           ); 
```

编辑：这是错误的。您需要在此查询中使用 HAVING 子句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T00:08:47.700

我会使用内部选择来避免计数聚合加倍：

```
SELECT author, rat
FROM
(
    SELECT author, count(id) AS rat
    FROM sds_posts
) 
WHERE rat >= 10
ORDER BY rat
LIMIT 0,20 
```

# xml - 在使用派生元素替换时保留单个根节点定义

> ID：14062840
> 
> 赞同：1
> 
> 时间：2012-12-27T23:52:40.033
> 
> 标签：xml, xsd, root-node

在 XSD 模式中，您不能将元素声明为文档[的唯一有效根节点。](https://stackoverflow.com/a/1937951/11683)
这是一个 PITA，但我知道。

多年来，我只会做链接答案中建议的事情——只定义`<simpleType>`s 和`<complexType>`s，唯一`<element>`在全局级别定义的是我想要的根节点。

但是，我目前正在对我的 XSD/XSLT 代码库进行很好的重构。我想做的一件事是将某个元素限制为仅从所需类型派生的元素，前提是这些派生可以具有不同的节点名称：

```
<xs:complexType name="parentType">
  <xs:sequence>
    <xs:element ref="AChild" minOccurs="1" maxOccurs="unbounded" />
  </xs:sequence>
</xs:complexType> 
```

where`AChild`是一个抽象基类型，其他类型将使用它派生`substitutionGroup`：

```
<xs:complexType name="child_base" abstract="true">
  ...
</xs:complexType>

<xs:element name="AChild" type="child_base" abstract="true" /> 
```

```
<xs:element name="AConcreteChild" substitutionGroup="AChild" >
  <xs:complexType>
    <xs:complexContent>
      <xs:extension base="child_base">
         ...
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
</xs:element>

<xs:element name="AnotherPossibleConcreteChild" substitutionGroup="AChild" >
  <xs:complexType>
    <xs:complexContent>
      <xs:extension base="child_base">
         ...
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
</xs:element> 
```

这里的问题是这个`substitutionGroup`东西只适用于在全局级别声明的元素。所以现在我有一堆以前的 internal `type`s 声明为 global level `element`s，虽然这完全限制了 s 的可能子节点`parentType`，但这也意味着如果任何现在全局子节点作为根元素提供，验证将成功，我不想要。

我考虑过的选项包括：

*   放弃`substitutionGroup`继承，将所有可能的子项移动到单独的命名空间，然后使用`<xsd:any namespace="that namespace" />`. 感觉还可以，但我不喜欢额外的命名空间和定义更差的约束。
*   忽略 XSD 级别的问题，检查使用 XSD 模板的代码中的根节点名称和命名空间。我不喜欢这里打破关注点分离，因为在我的设计中，XSD 文件是调用代码的黑盒，我宁愿不引入对节点 QName 的硬编码依赖。
*   引入一个原则，根据该原则，总会有两个“主要”XSD 模式。一个将以通常的方式验证节点（我目前拥有的验证），另一个将仅包含最宽松形式的顶级节点的定义：

    ```
    <xs:complexType name="parentType">
      <xs:sequence>
        <xs:any namespace="##any" processContents="skip" />
      </xs:sequence>
      <xs:anyAttribute namespace="##any" processContents="skip" />
    </xs:complexType>

    <xs:element name="TheRootNode" type="parentType" /> 
    ```

    然后当且仅当两个模式都验证时，我的文档才是正确的。
    我不喜欢这里的是我不确定这对最佳实践的违反程度。

*   退出重构并保留我之前的内容（以及在我手动列出所有可能的子项之前`<xs:choice>`）。

我的问题是，有没有其他方法可以在不声明多个 global-level`<element>`的情况下使 any-derived-element 约束工作（以便 only-root-node 约束再次工作）？如果您认为我最好选择列出的选项之一，也请留下答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T05:18:49.567

使用顶级组。

这就像您的最后一个要点，但您可以在`<xs:group ref=..."/>`每次需要时引用它，而不是重复选择（或者您可能是这个意思）。

```
<xs:complexType name="parentType">
  <xs:group ref="AChild" minOccurs="1" maxOccurs="unbounded" />
</xs:complexType>

<xs:group name="AChild">
  <xs:choice>
    <xs:element name="AConcreteChild" type="AConcreteChild_type" />
    <xs:element name="AnotherPossibleConcreteChild" type="AnotherPossibleConcreteChild_type" />
  </xs:choice>
</xs:group> 
```

顺便说一句：我也觉得这更清楚，因为选项在 xsd 中组合在一起，因此您不必扫描具有相同替换组的元素声明。

# oop - 在 Groovy 中，如果类没有被调用，为什么会出现实例化异常？

> ID：14062841
> 
> 赞同：1
> 
> 时间：2012-12-27T23:52:46.723
> 
> 标签：oop, groovy

[当我在http://groovyconsole.appspot.com/](http://groovyconsole.appspot.com/)执行以下实验代码子集时

```
class FileHandler {
    def rootDir

    FileHandler(String batchName) {
        rootDir = '.\\Results\\'+batchName+'\\'
    }
}

//def fileHandler = new FileHandler('Result-2012-12-15-10-48-55') 
```

异常结果：

```
java.lang.NoSuchMethodException: FileHandler.<init>() 
```

当我取消注释实例化类的最后一行时，错误就消失了。

有人可以解释这是为什么吗？我基本上是在尝试将类的定义和实例化为 2 个文件，分别进行评估。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T04:05:03.693

我不确定[http://groovyconsole.appspot.com/](http://groovyconsole.appspot.com/)背后的确切实现细节（从那里链接到的源指向 Gaelyk，我没有看过）。我敢打赌它正在为您提供的类寻找一个无参数的构造函数，以努力找到可运行的东西。（请注意，如果您提供它，它仍然无法工作，因为它需要一个`main()`：/）

在 groovyConsole 中本地运行会更快死掉，并显示以下错误消息：

```
groovy.lang.GroovyRuntimeException: This script or class could not be run. It should either:
- have a main method,
- be a JUnit test or extend GroovyTestCase,
- implement the Runnable interface,
- or be compatible with a registered script runner. 
```

这可能更具描述性和重点。如果您想将一些 Groovy 作为一个简单的脚本运行，您需要提供一个跳转点。最简单的方法是在你的 groovy 文件中的可执行语句，在任何类定义之外（例如，取消注释你的实例化语句）。或者，具有`main`方法的类应该这样做。（见[这里](http://groovy.codehaus.org/Scripts+and+Classes#ScriptsandClasses-Scripts)）。

如果您想将 2 个文件分解，您可以将类文件 def 保存在一个 groovy 文件中（例如， ），并仅使用可执行语句`First.groovy`创建第二个文件（例如， ）。`Second.groovy`（我相信第一个会在你运行时自动在类路径中`groovy Second`，如果两者都在同一个目录中）

# sql - 如何为不返回行的查询设置默认值？

> ID：14062853
> 
> 赞同：0
> 
> 时间：2012-12-27T23:54:25.347
> 
> 标签：sql, oracle, triggers, default, rows

我已经创建了一个带有 select 语句的触发器，我想说如果这个 select 语句不返回任何行，那么在变量“辅助”中放置一个 0。我尝试使用 NVL(auxiliar,0) 但它不起作用。我怎样才能做到这一点？

`SELECT NVL(salary,0) INTO auxiliar FROM BILL WHERE code=:NEW.code;`

[更新]我的触发代码：

```
IF preCondicio THEN
        KMpendents:=coalesce(SELECT rev_pendent_km
            INTO KMpendents
            FROM REV_PENDENT
            WHERE rev_pendent_vehicle_codi=:NEW.lloguer_vehicle_codi,0);
        IF KMtotals+KMpendents>=15000 THEN
            SELECT venedor_codi 
            INTO venedorCodi 
            FROM venedor 
            WHERE venedor_alta=(
                SELECT MAX(venedor_alta) 
                FROM venedor 
                WHERE venedor_delegacio_codi=(
                    SELECT venedor_delegacio_codi
                    FROM venedor
                    WHERE venedor_codi=:NEW.lloguer_venedor_codi));
            INSERT INTO REVISIONS VALUES(:NEW.lloguer_vehicle_codi,:NEW.lloguer_dataf,KMtotals+KMpendents,venedorCodi);
            IF KMpendents!=0 THEN
                DELETE FROM REV_PENDENT 
                WHERE rev_pendent_vehicle_codi=:NEW.lloguer_vehicle_codi;
            END IF;
        ELSE
            IF KMpendents!=0 THEN
                UPDATE REV_PENDENT SET rev_pendent_km=KMtotals+KMpendents WHERE rev_pendent_vehicle_codi=:NEW.lloguer_vehicle_codi;
            ELSE INSERT INTO REV_PENDENT VALUES(:NEW.lloguer_vehicle_codi,KMtotals,:NEW.lloguer_dataf);
            END IF;
        END IF;
    END IF; 
```

变量***KMpendents***相当于我在更新之前告诉的变量*auxiliar 。*但是 Oracle 向我显示了这些错误：

> PLS-00103：在预期以下情况之一时遇到符号“，”：。( * @ % & - + ; / at for mod 余数 rem 和或有相交的组减去顺序 start union where connect || indicator multiset

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:14:22.970

```
BEGIN
 SELECT NVL(salary,0) INTO auxiliar FROM BILL WHERE code=:NEW.code;
EXCEPTION
  WHEN NOTFOUND THEN
      auxiliar := 0;
END; 
```

或者您可以使用`SQL%NOTFOUND`too 检查语句是否返回`no rows`。

```
CREATE or REPLACE TRIGGER trigger_name
BEFORE INSERT
   ON table_name
   [ FOR EACH ROW ]

DECLARE
   -- variable declarations

BEGIN
    ....
    ....
    BEGIN
     SELECT NVL(salary,0) INTO auxiliar FROM BILL WHERE code=:NEW.code;
    EXCEPTION
      WHEN NOTFOUND THEN
          auxiliar := 0;
    END;
    --Yes, this is possible and valid.

EXCEPTION
   WHEN ...
   -- exception handling

END; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T11:35:20.893

如果 select 子句只包含聚合函数，那么总会返回至少一行。

```
SELECT coalesce(sum(salary),0)
INTO   auxiliar
FROM   BILL
WHERE  code=:NEW.code; 
```

# c++ - 为什么 C++11 允许 GC？

> ID：14062856
> 
> 赞同：4
> 
> 时间：2012-12-27T23:54:34.003
> 
> 标签：c++, c++11, garbage-collection

C++11 允许其实现执行（一些）垃圾收集实用程序。为什么标准会允许这样做？我一直认为，在 C++ 中，不用为不用的东西付费。对我来说，（隐式）GC 感觉就像它破坏了这种意识形态。此外，通过智能指针在 C++ 中编写和使用显式垃圾收集实用程序并不难。

其次，GC 会使一些原本有效的程序失效。示例包括指针屏蔽和相关的低级指针“hacks”。

```
int * nums = new int[10];
nums += 2;
*nums = 777; // nothing points to the new'ed int[10] at this point
// oh no! nums could have gotten collected!!! (so lets assume it was)
*nums = 666; // crash (or memory corruption (or something else that's bad)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T09:08:17.127

C++11 标准并不要求 GC 存在，但它可能会出现在未来的版本中。

它不会对你强制执行——它只有在你请求时才会出现。它不会收集您的普通指针，也不会收集当前的智能指针。所以，它仍然是“不要使用——不要付费”。它仅适用于您明确要求它的指针，因此您的示例仍将像现在一样工作。

请参阅[Sutter's Mill：垃圾收集概要和 C++](http://herbsutter.com/2011/10/25/garbage-collection-synopsis-and-c/)

> 引用计数（#1）通常是最好的，它是 C++ 的默认 GC 形式。但是也有理由（而不是）希望 C++ 中的惰性标记扫描（#2）垃圾收集来处理引用计数无法处理的事情，包括当潜在的循环不可避免时（在某些情况下，某些对象可能自然而然地共享，但随后可能相互引用）和无锁 ABA 问题。

通过“引用计数”，萨特指的是`std::shared_ptr`和类似的东西。

# c++ - c++：交换向量和指针失效？

> ID：14062858
> 
> 赞同：3
> 
> 时间：2012-12-27T23:54:42.567
> 
> 标签：c++, pointers, swap, invalidation

我似乎在交换两个向量的元素时遇到了问题。我有两个向量，`x`它们`y`包含类型的对象`myclass`。只有`myclass`一名公众成员`w`。我创建了一个指向成员的指针向量`w`，`x`然后交换向量`x`和`y`. 我希望指针向量仍然指向`w`成员，`x`但情况似乎并非如此。

这是一个重现我的问题的简单示例。

```
#include <iostream>
#include <vector>

using namespace std;

struct myclass
{
    double w;
};

int main()
{
    vector<myclass> x(10);
    for(int i=0; i!=10; i++) x[i].w = i;
    for(auto el : x) std::cout << el.w << std::endl; /* prints i */
    std::cout << std::endl;

    vector<double *> px(10);
    for(int i=0; i!=10; i++) px[i] = &x[i].w;
    for(auto el : px) std::cout << *el << std::endl; /* prints i */
    std::cout << std::endl;

    vector<myclass> y(10);
    for(int i=0; i!=10; i++) y[i].w = 2*i;
    for(auto el : y) std::cout << el.w << std::endl; /* prints 2*i */
    std::cout << std::endl;

    y.swap(x);

    for(auto &el : x) std::cout << &el.w << " " << el.w << std::endl; /* prints 2*i as it should */
    std::cout << std::endl;

    for(auto &el : px) std::cout << el << " " << *el << std::endl; /* should print 2*i, but prints i */
    std::cout << std::endl;
} 
```

请注意，`x`and`y`已经交换了元素，但`px`仍然指向旧元素。我读到 using`swap`不应该使指针/迭代器无效。这是正确的还是我错过了什么？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T00:06:45.500

指针和迭代器不会失效，但它们会跟随容器的内容。

的内容`x`被交换到`y`中，但是指向这些值的迭代器和指针将继续指向它们（即使它们现在在 中`y`）。

想一想，它怎么能以其他方式工作？如果交换两个长度不等的容器，那么指向较长容器末端附近的元素的指针会指向较短容器中的什么？`swap()`如果每个容器的元素都必须在`O(1)`内存中移动以确保指针保持有效，那么如何实现呢？

# java - String.toCharArray() 的运行时间是多少？

> ID：14062867
> 
> 赞同：6
> 
> 时间：2012-12-27T23:55:27.137
> 
> 标签：java, string, copy, runtime, system

`String.toCharArray()`java的运行时间是多少？源代码是

```
 public char[] toCharArray() {
    // Cannot use Arrays.copyOf because of class initialization order issues
    char result[] = new char[value.length];
    System.arraycopy(value, 0, result, 0, value.length);
    return result;
} 
```

有吗`System.arrayCopy`？运行时间为 O(n)？源代码并没有真正说明它是如何实现的。它会遍历每个元素并复制它吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T12:40:02.040

`System.arraycopy()`通常是内在的并且非常快。也就是说，它仍然需要查看（并复制）数组的每个元素，因此它的渐近复杂度在数组的长度上是线性的，即`O(n)`.

因此，复杂度`toCharArray()`是`O(n)`，其中`n`是字符串的长度。

# php - PHP 或 wamp 邮件程序错误

> ID：14062874
> 
> 赞同：0
> 
> 时间：2012-12-27T23:56:04.140
> 
> 标签：php, wamp

我正在尝试使用 wamp 服务器发送电子邮件，但出现此错误

> 警告：mail() [function.mail]：无法在“localhost”端口 25 连接到邮件服务器，请验证 php.ini 中的“SMTP”和“smtp_port”设置或在 .. 中使用 ini_set()

有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:00:43.003

消息是正确的。

您使用邮件功能，这指向`localhost`您的 php.ini。但我认为您没有在本地机器上运行电子邮件服务器。

如果您需要本地机器上的电子邮件，您应该安装一个像[hMailServer](http://www.hmailserver.com/)这样的邮件服务器并配置邮件服务器，以便他捕获来自本地主机的所有电子邮件。网站上有一些信息和介绍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:00:09.063

使用[PHPMAILER](http://phpmailer.worxware.com)类。这比使用 PHP 自己的邮件功能要容易得多。它允许您为您的电子邮件服务器指定所需的 smtp 登录信息。目前您没有连接到 SMTP 服务器，更不用说设置用户名和密码了。对于新手来说，PHPMAILER 是一种更实用的前进方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:07:23.050

是的，这是因为您没有运行供 PHP 使用的 SMTP 服务器。这意味着您必须在 php.ini 文件中进行一些编辑和/或在本地运行邮件服务器，或者您可以安装此工具： [测试邮件服务器工具](http://www.toolheap.com/test-mail-server-tool/)来测试本地发送电子邮件。

这应该开箱即用。

`NOTICE`这不适用于生产环境！

`NOTE 2`我不能真正相信这个答案，请参阅： [这个问题](https://stackoverflow.com/questions/5773288/configure-wamp-server-to-send-email)

# ios - iOS 在像素级别上最快的 png 图片处理

> ID：14062880
> 
> 赞同：0
> 
> 时间：2012-12-27T23:56:31.727
> 
> 标签：ios, drawing, png

如何快速操作 png 像素值，以便以 30 帧/秒的速度显示图片

我喜欢创建类似这个 Javascript html 画布示例的东西。 [http://www.kaotik.si/randomWalk.html](http://www.kaotik.si/randomWalk.html)

例如，但我在 iPad 上的 Objective-c (iOS) 中需要它我正在使用 ARC。我喜欢最简单的可能解决方案。

# android - 警报对话框和片段活动的问题

> ID：14062884
> 
> 赞同：0
> 
> 时间：2012-12-27T23:57:12.053
> 
> 标签：android, dialog, android-alertdialog

我知道之前已经发布过类似的问题，但我认为这是一个不同的场景。由于无法获取 getSupportFragmentManager()，因此我遇到了 show 功能问题。我无法在 MainActivity 中扩展 FragmentActivity，因为我已经扩展了 MapActivity（它是一个基于地图的应用程序）。

主页上的一个按钮会弹出此警报对话框，我不断收到

```
The method show(FragmentManager, String) in the type DialogFragment is not 
applicable for        
the arguments (FragmentManager, String) 
```

我能得到什么解决方法？我遵循了谷歌的开发者指南，他们扩展了 FragmentActivity。我想我在这里遗漏了一些东西。

如果有人可以帮助我，那就太好了。

更新：我尝试了一个简单的示例并扩展了 FragmentActivity 并且它有效。显然，需要扩展 FragmentActivity 才能使其正常工作（除非有人可以提供解决方法）。有没有办法扩展 FragmentActivity 和 MapActivity ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:02:47.657

这一点：

> DialogFragment 类型中的方法 show(FragmentManager, String) 不适用于参数 (FragmentManager, String)

在我看来，就像 Honeycomb 的“本机”片段支持和 support-v4 库中的“兼容性”片段支持之间的冲突。检查您的导入，您可能将 a 传递给[`android.support.v4.app.FragmentManager`](http://developer.android.com/reference/android/support/v4/app/FragmentManager.html)采用 a 的方法，[`android.app.FragmentManager`](http://developer.android.com/reference/android/app/FragmentManager.html)反之亦然。

# android - Android pre-honeycomb 位图管理

> ID：14062887
> 
> 赞同：1
> 
> 时间：2012-12-27T23:57:28.150
> 
> 标签：android, memory, bitmap

对于我的应用程序，我需要加载一个有时可能非常大的位图。即使在 Galaxy S2 等设备上，我也会遇到 OutOfMemory 错误。我四处寻找，发现我需要回收位图。

以前我使用 BitmapFactory 加载位图，创建一个新的缩放位图，并在一行中创建一个 bitmapdrawable。通过这样做，我是否将两个位图加载到内存中？我应该创建初始位图，然后在创建缩放位图后回收它吗？

如果活动将频繁启动，我应该将位图一次加载到静态字段还是应该每次回收并重新创建？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:18:29.850

将流程拆分为多个步骤。如果您正在根据可用屏幕空间测量位图，然后加载缩放的位图，则可以执行第一步，而无需使用 BitmapFactory.Options.inJustDecodeBounds 将位图加载到内存中。这将为您提供一个没有像素数据但具有宽度和高度属性的位图对象。然后使用它使用 BitmapFactory.Options.inSampleSize 解码您的缩放位图。

谷歌这些术语，你会发现大量的示例代码就是这样做的。是的，不要忘记在完成位图后进行回收。

[https://www.google.com/#q=BitmapFactory+Options+inJustDecodeBounds+inSampleSize](https://www.google.com/#q=BitmapFactory+Options+inJustDecodeBounds+inSampleSize)

# c# - 从后面的 ascx 代码打印 - 找不到合适的方法来覆盖

> ID：14062890
> 
> 赞同：1
> 
> 时间：2012-12-27T23:57:52.880
> 
> 标签：c#, asp.net, user-controls

我有一个我正在尝试的网络部件，我正在尝试打印一个网格视图。我有一个 ascx.cs，后面有一个公共类用于代码。我在这里创建了一种打印网格的方法：

```
 protected void print_grid_2_Click(object sender, EventArgs e)
        {
            fill_grid_search();
            grd_search.AllowPaging = false;
            grd_search.DataBind();
            StringWriter sw = new StringWriter();
            HtmlTextWriter hw = new HtmlTextWriter(sw);
            grd_search.RenderControl(hw);
            string gridHTML = sw.ToString().Replace("\"", "'")
                .Replace(System.Environment.NewLine, "");
            StringBuilder sb = new StringBuilder();
            sb.Append("<script type = 'text/javascript'>");
            sb.Append("window.onload = new function(){");
            sb.Append("var printWin = window.open('', '', 'left=0");
            sb.Append(",top=0,width=1000,height=600,status=0');");
            sb.Append("printWin.document.write(\"");
            sb.Append(gridHTML);
            sb.Append("\");");
            sb.Append("printWin.document.close();");
            sb.Append("printWin.focus();");
            sb.Append("printWin.print();");
            sb.Append("printWin.close();};");
            sb.Append("</script>");
            Page.ClientScript.RegisterStartupScript(this.GetType(), "GridPrint", sb.ToString());
            fill_grid_search();
            grd_search.AllowPaging = true;

            grd_search.DataBind();
        } 
```

然后我使用这段代码来检查表单标签：

```
 public override void VerifyRenderingInServerForm(Control control)
        {
            return; /*Verifies that the control is rendered */
        } 
```

然后我从调试器中得到“没有找到合适的方法来覆盖。”。有没有一种方法可以做到这一点，而无需仅为这个单键事件创建部分类？

# macos - 获取 Quicktime 视频信息

> ID：14062891
> 
> 赞同：5
> 
> 时间：2012-12-27T23:57:53.593
> 
> 标签：macos, video, ffmpeg, quicktime

有没有办法获取 QuickTime 视频信息？（在谷歌搜索中，我发现 QT 的一个 cl 选项已损坏。）

我正在寻找 pasp、长度、音频通道、音频分配、拍手和其他各种属性，这些属性通常使用“Dumpster”程序找到。大多数信息无法使用 ffmpeg 获得。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-28T22:49:19.677

使用[Apple 网站上](http://support.apple.com/kb/ht1425)的 QuickTime 示例，我什至可以得到很好的 JSON 格式的输出：

```
ffprobe -v quiet -print_format json -show_format sample_iTunes.mov 
{
    "format": {
        "filename": "sample_iTunes.mov",
        "nb_streams": 2,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "85.500000",
        "size": "3284257",
        "bit_rate": "307298",
        "tags": {
            "major_brand": "qt  ",
            "minor_version": "537199360",
            "compatible_brands": "qt  ",
            "creation_time": "2005-10-17 22:54:32"
        }
    }
} 
```

我用的是 ffprobe 版本 1.0.7

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T02:58:05.920

Mediainfo 是一个不错的实用程序，[http](http://mediainfo.sourceforge.net/en) ://mediainfo.sourceforge.net/en 。它将提供您需要的一些信息。另请查看 ffprobe，它需要 -show_streams 和 -show_frames 等选项来获取更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:13:38.890

这是一种选择： http: [//omino.com/sw/qt_tools/](http://omino.com/sw/qt_tools/)

尽管程序本身已损坏，但如果您运行 $`pieces/bin/qt_info <.mov file>`它将为您提供一些很好的信息。

# opengl - 3d 顶点 LWJGL/OpenGL

> ID：14062892
> 
> 赞同：1
> 
> 时间：2012-12-27T23:57:56.763
> 
> 标签：opengl, lwjgl

我正在尝试 LWJGL 库，但我有点困惑。当我尝试使用 2d 顶点渲染四边形时： glVertex2f(0, 0); glVertex2f(0, 1000); glVertex2f(1000, 1000); glVertex2f(1000, 0);，然后一切看起来都很好，但是当我使用下面的代码时，我只看到一个黑屏。我使用了错误的坐标，所以它没有显示在屏幕上，还是有其他问题？

```
import org.lwjgl.LWJGLException;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;
import static org.lwjgl.util.glu.GLU.*;
import static org.lwjgl.opengl.GL11.*;

public class main {

    public void start() throws LWJGLException {
        int height = 600;
        int width = 800;
        DisplayMode standard = new DisplayMode(width, height);
        Display.setDisplayMode(standard);
        Display.create();

        // init OpenGL here
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        glOrtho(0, width, height, 0, 0, -1);
        glMatrixMode(GL_MODELVIEW);

        while (!Display.isCloseRequested()) {
            // clear the screen and depth buffer
            glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

            // set the color of the quad (R,G,B,A)
            glColor3f(0.5f, 0.5f, 1.0f);

            // draw quad
            glBegin(GL_QUADS);
            glVertex3f(0, 0, 10);
            glVertex3f(0, 1000, 10);
            glVertex3f(1000, 1000, 10);
            glVertex3f(1000, 0, 10);
            glEnd();

            Display.update();
        }

        Display.destroy();
    }

    public static void main(String[] argv) throws LWJGLException {
        main displayExample = new main();
        displayExample.start();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:26:09.747

我可能对视图做错了什么。我设法制作了一个功能正常的 3d 立方体。键 Q,W,E 分别在眼点的 x、y 和 z 坐标上添加数字（我没有考虑 FPS，所以你可能会调整**eye* += 0.1**）和 A、S 和 D 分散注意力x,y,z 中的数字。

```
import java.nio.FloatBuffer;

import org.lwjgl.BufferUtils;
import org.lwjgl.LWJGLException;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;
import static org.lwjgl.util.glu.GLU.*;
import static org.lwjgl.opengl.GL11.*;

import org.lwjgl.input.Keyboard;
import org.lwjgl.input.Mouse;

public class main {
    float eyex, eyey, eyez;

    public void start() throws LWJGLException {
        int height = 600;
        int width = 800;
        eyex = 0;
        eyey = 0;
        eyez = 0;
        DisplayMode standard = new DisplayMode(width, height);
        Display.setDisplayMode(standard);
        Display.create();

        glEnable(GL_DEPTH_TEST);
        glDepthFunc(GL_LESS);
        glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
        glMatrixMode(GL_PROJECTION);
        gluPerspective(90f, (float) width / (float) height, 1f, 10000f);
        glMatrixMode(GL_MODELVIEW);

        while (!Display.isCloseRequested()) {
            glLoadIdentity();
            gluLookAt(eyex, eyey, eyez, 50f, 50f, 50f, 0f, 0f, 1f);
            glClear(GL_COLOR_BUFFER_BIT);
            glClear(GL_DEPTH_BUFFER_BIT);

            glBegin(GL_QUADS);
            glColor3f(1,0,0);
            glVertex3f(0,0,0);
            glVertex3f( 100,0,0);
            glVertex3f( 100, 100,0);
            glVertex3f(0, 100,0);
            glColor3f(0,100,0);
            glVertex3f(0,0,0);
            glVertex3f(0,0, 100);
            glVertex3f(0, 100, 100);
            glVertex3f(0, 100,0);
            glColor3f(0,0,100);
            glVertex3f( 100,0, 100);
            glVertex3f( 100,0,0);
            glVertex3f( 100, 100,0);
            glVertex3f( 100, 100, 100);
            glColor3f(1,1,0);
            glVertex3f(0,0,0);
            glVertex3f( 100,0,0);
            glVertex3f( 100,0, 100);
            glVertex3f(0,0, 100);
            glColor3f(0,1,1);
            glVertex3f(0,0, 100);
            glVertex3f( 100,0, 100);
            glVertex3f( 100, 100, 100);
            glVertex3f(0, 100, 100);
            glColor3f(1,1,1);
            glVertex3f(0, 100, 100);
            glVertex3f(0, 100,0);
            glVertex3f( 100, 100,0);
            glVertex3f( 100, 100, 100);
            glEnd();
            pollInput();
            Display.update();
        }

        Display.destroy();
    }

    void pollInput() {
        if (Mouse.isButtonDown(0)) {
            int x = Mouse.getX();
            int y = Mouse.getY();

            System.out.println("MOUSE DOWN @ X: " + x + " Y: " + y);
        }

        if (Keyboard.isKeyDown(Keyboard.KEY_SPACE)) {
            System.out.println("SPACE KEY IS DOWN");
        }

        if (Keyboard.isKeyDown(Keyboard.KEY_Q)) {
            eyex += 0.1;
        }
        if (Keyboard.isKeyDown(Keyboard.KEY_W)) {
            eyey += 0.1;
        }
        if (Keyboard.isKeyDown(Keyboard.KEY_E)) {
            eyez += 0.1;
        }
        if (Keyboard.isKeyDown(Keyboard.KEY_A)) {
            eyex -= 0.1;
        }
        if (Keyboard.isKeyDown(Keyboard.KEY_S)) {
            eyey -= 0.1;
        }
        if (Keyboard.isKeyDown(Keyboard.KEY_D)) {
            eyez -= 0.1;
        }
        if (Keyboard.isKeyDown(Keyboard.KEY_R)) {
            eyex = 0;
            eyey = 0;
            eyez = 0;
        }

    }

    public static void main(String[] argv) throws LWJGLException {
        main displayExample = new main();
        displayExample.start();
    }
} 
```

# bash - $@ 中 args 的 bash 参数案例

> ID：14062895
> 
> 赞同：23
> 
> 时间：2012-12-27T23:58:02.813
> 
> 标签：bash, shell

我有一个包含一长串可选参数的脚本。有些有相关的价值。

如：

```
.script --first 2012-12-25 --last 2012-12-26 --copy --remove
.script --first 2012-12-25 
```

因此下面的案例陈述：

```
for arg in "$@"
do
    case $arg in
        "--first" )
           START_DATE=$arg;;
        "--last" )
           END_DATE=$arg;;
        "--copy" )
           COPY=true;;
        "--remove" )
           REMOVE=true;;

# ... and so on
   esac
done 
```

### 我的问题：

这需要一个增量`$arg+1`类型语句来获取以下 arg（在某些情况下）。

这怎么可能？

我也很乐意做这样的子字符串`.script --first2012-12-25 --last2012-12-26`

并且不知道如何在那里进行。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-28T01:36:39.877

您可以允许 --a=arg 或 -a arg 选项做更多的工作：

```
START_DATE="$(date '+%Y-%m-%d')";
LAST_DATE="$(date '+%Y-%m-%d')";
while [[ $# -gt 0 ]] && [[ "$1" == "--"* ]] ;
do
    opt="$1";
    shift;              #expose next argument
    case "$opt" in
        "--" ) break 2;;
        "--first" )
           START_DATE="$1"; shift;;
        "--first="* )     # alternate format: --first=date
           START_DATE="${opt#*=}";;
        "--last" )
           LAST_DATE="$1"; shift;;
        "--last="* )
           LAST_DATE="${opt#*=}";;
        "--copy" )
           COPY=true;;
        "--remove" )
           REMOVE=true;;
        "--optional" )
           OPTIONAL="$optional_default";;     #set to some default value
        "--optional=*" )
           OPTIONAL="${opt#*=}";;             #take argument
        *) echo >&2 "Invalid option: $@"; exit 1;;
   esac
done 
```

请注意，如果不使用“=”，则 --optional 参数使用默认值，否则它会以正常方式设置值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T00:02:15.613

`shift`在每个`case`语句的末尾使用。

引用`bash`手册：

> 班次 [n]
> 
> 从 n+1 ... 开始的位置参数被重命名为 $1 ...。由数字 $# 到 $#-n+1 表示的参数未设置。n 必须是小于或等于 $# 的非负数。如果 n 为 0，则不更改任何参数。如果 n 未给出，则假定为 1。如果 n 大于 $#，则位置参数不变。如果 n 大于 $# 或小于零，则返回状态大于零；否则为 0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T06:31:44.693

`$@`是一个数组，而不是一个简单的变量。

您可以将其捕获为局部变量`x=("$@")`& 然后使用带有索引的数组 x 作为`0 to ($# - 1)`。

要访问单个元素，请使用`${x[$i]}`. 但是，您不能直接使用`${@[$i]}`。

因此`for arg in "$@"`，您将拥有循环而不是`i=0; while [ $i -lt $# ]; do`循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T00:24:41.293

getopts 似乎不能有可选参数。否则很棒。

我的解决方案

循环`$@`并设置一个变量等于`x=$arg` 对该变量（而不是arg）进行案例切换

对于类型的参数效果很好`--startdate 2012-12-25 --enddate 2012-12-29`

但没有工作`--remove`，没有以下论点。

因此将东西（不太可能的论点）附加到 arg 字符串上。

留下以下

```
argc="$@ jabberwhocky" 
echo $argc
x=0
# x=0 for unset variable
for arg in $argc
do
   case $x in
        "--start" )
          STARTDATE=$arg ;;
        "--end" )
          ENDDATE=$arg ;;
        "--copy" )
          COPY=true;;
        "--remove" )
          REMOVE=true;; 
```

... 等等....

```
 esac
    x=$arg
done 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-28T02:26:00.940

如果您有多个选项，尤其是带有值的选项与不带值的选项混合，请让[getopts](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/getopts.html)为您完成工作。

# jquery - 通过单击列表项的独立 div 的 jQuery 切换

> ID：14062899
> 
> 赞同：0
> 
> 时间：2012-12-27T23:58:34.987
> 
> 标签：jquery, html-lists, toggle, show-hide

我想呈现一个水平的项目列表，每个项目都通过一个“id”连接到一个独立的 div。我希望连接到项目的 div 切换淡入淡出。默认是隐藏所有 div。然后当用户点击另一个项目时，之前打开的 div 将关闭。

这是html：

```
<div id="menu">
        <ul>
            <li><a class="menuitem" href="#smPlates">Small Plates</a></li>
            <li><a class="menuitem" href="#salads">Salads</a></li>
            <li><a class="menuitem" href="#burgers">Burgers</a></li>
            <li><a class="menuitem" href="#desserts">Desserts</a></li>
        </ul>

        <!-- Small Plates menu -->
        <div class="menubox" id="smPlates">
            <p>Content of smPlates</p>
        </div>

        <!-- Salads menu -->
        <div class="menubox" id="salads">
               <p>Content of salads</p>
        </div>

        <!-- Burgers menu -->
        <div class="menubox" id="burgers">
               <p>Content of burgers</p>
        </div>

        <!-- Desserts menu -->
        <div class="menubox" id="desserts">
                <p>Content of desserts</p>
        </div>
</div> 
```

我有以下 jQuery 代码可以有效地切换 div，但所有这些，我尝试使用 attr('id') 获取每个列表项的相应 div，但它没有工作：

```
$(document).ready(function() {
    $(".menubox").hide();

    $(".menuitem").click(function(event) {
        event.preventDefault();
        var menubox = $(".menubox");
        $(".menubox").not(menubox).hide()
        menubox.fadeToggle("slow","linear"); 
    });
}); 
```

我对 jQuery 的熟练程度不高，任何帮助或指导将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:02:56.847

**工作解决方案：http: [//jsfiddle.net/9Cxx2/](http://jsfiddle.net/9Cxx2/)**

```
$(document).ready(function() {
    $(".menubox").hide();

    $(".menuitem").click(function(event) {
        event.preventDefault();

        $('.menubox').hide();

        $($(this).attr('href')).fadeToggle("slow","linear");;

    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:04:49.480

```
$(document).ready(function() {

    // Hide all menuboxes initially
    $(".menubox").hide();

    $(".menuitem").click(function(event) {
        event.preventDefault();

        // Hide the menubox that is allready opened
        $(".menubox").hide();

        // Get the new menubox from the href attribute of menuitem
        var relatedDivID = $(this).attr('href');

        // Fade new menubox
        $(relatedDivID).fadeToggle("slow","linear"); 
    });
}); 
```

工作[小提琴](http://jsfiddle.net/7f6Fb/1/)。

# android - WebView 使用 loadDataWithBaseUrl 跳转到锚点

> ID：14062901
> 
> 赞同：8
> 
> 时间：2012-12-27T23:59:05.173
> 
> 标签：android, webview, scroll, anchor

我的 Android 应用程序使用 WebView 来显示一堆我“即时”生成的 HTML 代码。使用以下代码加载 HTML 代码：

```
 StringBuilder builder = new StringBuilder();

    // HTML
    builder.append("<html><head><link rel=\"stylesheet\" href=\"file:///android_asset/style.css\" type=\"text/css\">");
    builder.append("</link></head><body>");
    builder.append(getThreadBody());
    builder.append("</body></html>");

    webview.loadDataWithBaseURL("file:///android_asset/", builder.toString(), "text/html", "utf-8", null); 
```

这一切都很好。请注意，我没有加载实际的 HTML 文件，我只是创建了一个代表一些（希望是有效的）HTML 的字符串并将其加载到 WebView 中。

无论如何，我生成的 HTML（'getThreadBody' 方法中的部分）包含命名的锚点，例如这样；

```
<div>
    <a name="949823">Anchor 1</a>
    <div>All kinds of stuff</div>

    <a name="895984">Anchor 2</a>
    <div>...</div>
</div> 
```

现在，在某些情况下，我希望 WebView 在加载 HTML 后立即导航到其中一个锚点。据我了解，WebView 支持导航（在本例中为滚动）到命名锚点，但问题是没有人点击这些锚点的任何超链接，我希望 WebView 在加载时滚动（如果有是加载 HTML 和滚动之间的短暂延迟，我的观点是它不应该需要用户交互）。

我相信可以通过使用 WebView 的 loadUrl 方法并提供带有锚点的 URL 来实现该行为，例如

```
webview.loadUrl("file:///android_asset/page.html#895984", ...) 
```

但是，由于我没有将 HTML 保存到任何文件中，因此我无法使用此方法……当然，将 HTML 保存到临时文件可能是一种解决方案，但我想将其保留为最后的手段，必须有一个更简单的方法？

我怎样才能做到这一点？谢谢！

* * *

**已解决** 这是有效的代码。我发现在执行 javascript 之前让页面加载需要一个短暂的延迟，否则无论它是否有效，它都是 50/50...

```
 StringBuilder builder = new StringBuilder();

    // HTML
    builder.append("<html><head><link rel=\"stylesheet\" href=\"file:///android_asset/style.css\" type=\"text/css\">");
    builder.append("</link>");
    builder.append("<script>");
    builder.append("function scrollAnchor(id) {");
    builder.append("window.location.hash = id;}");
    builder.append("</script>");
    builder.append("</head><body>");
    builder.append(getThreadBody());
    builder.append("</body></html>");

    webContents.loadDataWithBaseURL("file:///android_asset/", builder.toString(), "text/html", "utf-8", null);

    Timer timer = new Timer();
    timer.schedule(new TimerTask() {
        @Override
        public void run() {
            String id = "895884";
            webContents.loadUrl("javascript:scrollAnchor(" + id + ");");
        }
        }
    }, 250); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T02:54:12.893

用 JavaScript 控制它怎么样？我没有尝试过，但也许这是一个线索。

```
builder.append(getThreadBody());
builder.append("<script>window.location.hash="949823";</script>");
builder.append("</body></html>"); 
```

请记住为 WebView 启用 javascript。

----补充答案----

我看到您使用 TimerTask 来加载 javascript，这很有效，但我认为还有另一种更好的方法。WebView 有一个名为 onPageFinished 的回调，它将在 WebView 完成加载网页时触发。你可以在那里注入你的JS。

```
webContents.setWebViewClient(new WebViewClient(){

    @Override
    public void onPageFinished(WebView view, String url) {
          String id = "895884";
          webContents.loadUrl("javascript:scrollAnchor(" + id + ");");
    }

}); 
```

希望这是有用的！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-04T10:42:27.280

首先，您不需要使用 javascript。如果您使用

```
webContents.loadDataWithBaseURL("some://dummy/url",...); 
```

你可以简单地滚动到锚点

```
webContents.loadUrl("some://dummy/url#anchor"); 
```

其次，在没有额外控制的情况下在 onPageFinished 上执行此操作会导致永无止境的循环！当 loadUrl 完成时，onPageFinished 会一次又一次地调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-06T16:14:11.693

如果您的布局中有嵌套滚动视图内的 web 视图，则嵌套将阻止滚动事件正常工作。一旦你把它拿出来，它就可以工作而无需重新加载或添加 javascript。

此外，如果您想保留 nestedScrollView 并且不关心用户是否无法滚动该部分，您可以添加`fillViewPort=true`到 nestedScrollView 和`android:layout_height="wrap_content"`webview。

它看起来像：

```
<androidx.coordinatorlayout.widget.CoordinatorLayout>

  <com.google.android.material.appbar.AppBarLayout>
  ...
  </com.google.android.material.appbar.AppBarLayout>

  <androidx.core.widget.NestedScrollView
   android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:fillViewPort=true
   app:layout_behavior="@string/appbar_scrolling_view_behavior">

     <WebView
      android:layout_width="match_parent"
      android:layout_height="wrap_content"/> 

  </androidx.core.widget.NestedScrollView>

</androidx.coordinatorlayout.widget.CoordinatorLayout> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-17T10:24:16.813

如果您有外部操作（例如：）`onclick event`，请尝试此代码

```
 public static void scrollToAnchor(String id) {
        sWebView.loadUrl("javascript:document.getElementById(\"" + id + "\").scrollIntoView()");
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-17T20:35:04.153

如果您从以下位置加载 html `assets`：

```
 webView.loadUrl("file:///android_asset/htmls/mypage.html#anchor"); 
```

您可以移动到网页内的锚点：

```
webView.loadUrl("http://www.stackoverflow.com/mypage.html#anchor"); 
```

# ios - Xcode Bundle标识符问题

> ID：14062902
> 
> 赞同：4
> 
> 时间：2012-12-27T23:59:07.363
> 
> 标签：ios, xcode, bundle, identifier

我正在尝试将我在 Xcode 中制作的 2 个应用程序安装到设备上，并且只能成功构建一个。

在成功构建捆绑标识符的`123456789A.com.company.appnameProject`那个上，“Project”是灰色不可编辑文本中的项目名称。

对于捆绑标识符失败的那个，其中没有任何不可编辑的文本，我不明白为什么一个有不可编辑的灰色文本而另一个没有。

这是错误描述`The identity '...' does not match any valiad non-expired certificate/private key pair in your keychains`

我尝试了以下捆绑标识符但没有成功。

```
123456789A.*

123456789A.com.company.appname

123456789A.com.company.appnameProject (project is in editable text) 
```

注意：我尝试删除并重新安装配置文件和钥匙串。自从成功构建了一个应用程序以来，如果我的钥匙串或配置文件有任何问题，我会感到惊讶。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:30:59.180

灰色文本不可编辑，因为它使用 rfc1034identifier 版本的捆绑项目名称

如果您查看目标信息，您将看到捆绑标识符如下所示。

```
com.company.${PRODUCT_NAME:rfc1034identifier} 
```

项目名称是项目属性编辑器“目标”部分中图标旁边的值。

您可以通过在已选择目标名称时单击一次来更改目标的名称。或选择它并按回车键。

更改目标的名称将更改您的 Bundle 标识符中的灰色值。

有时，您的配置文件不包括它应该包含的所有 UDID。

您可以尝试确保在 iTunes 连接门户中选择它们。然后下载新副本。

您也可以尝试将 ios 设备连接到 xcode 并在“Organizer”中进行设置以供开发

如果那不起作用。您可能希望从 xcode 和存储它们的硬盘中删除所有配置文件，然后从 xcode 重新下载它们。

偶尔也有气质

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:36:05.770

尝试以这种方式完成您的 Bundle 标识符：

在您的组织者/供应配置文件中，您可以找到应用标识符

12344545.com.name.*

在您的 Bundle 标识符中，仅在数字（点）之后使用，而不是（*）您的应用程序名称，应该是这样的：

com.name.AppName

这样，The identity '...' does not match any valiad non-expired certificate/private key pair in your keychains 错误应该消失，至少对我来说是这样。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T03:12:39.193

我发现出了什么问题。我在调试阶段的代码签名身份是错误的证书。这是一个非常简单而令人尴尬的错误。

也感谢那些回答的人！

# java - 在 Java 中将双精度值转换为字节数组的最佳和有效方法

> ID：14062904
> 
> 赞同：5
> 
> 时间：2012-12-27T23:59:14.970
> 
> 标签：java, performance

我正在开发一个低延迟系统，需要一种解决方案来将双精度数转换为字节数组，但对十进制数具有精度。我需要考虑在解决方案中创建的对象应该更少。另外，我的价值是双倍的。

我目前的实现有点像

```
int offset = 0;
double d = 1211.11;
long integerPart = (long) d;
byte[] b = new byte[16];

offset += addToByteArray(integerPart, b, offset); 
//implementation to add each digit to byte array, returns new offset

int lengthDecimal = 16 - offset;
if(lengthDecimal > 0)
b[offset++] = '.';
long tmp = 1;

for(int i=0; i<lengthDecimal; i++){
 tmp = tmp * 10;
 int digit = (int)(((long) (d * tmp)) % 10);
 b[offset++] = (byte) ('0' + digit);
} 
```

然后操纵字节数组以修剪后面的零和“。” 如果需要。

问题是如果我检查字节数组，我找不到确切的数字。因为，我使用的是双精度，所以在工作时会丢失小数点的精度。

我已经搜索并发现到处都可以使用 BigDecimal。BigDecimal 的使用似乎可以正常工作，但我担心这部分代码经常受到影响而创建的对象的性能和数量。

我也尝试过像这样使用 String

```
String doubleNumber = Double.toString(d);
long fractionalPart = 0;

offset += addToByteArray(integerPart, b, offset); 
if(doubleNumber.substring(doubleNumber.indexOf(".")).length() > 0) {
  fractionalPart = Long.valueOf(doubleNumber.substring(doubleNumber.indexOf(".") + 1));
  b[offset++] = '.';
  offset += addToByteArray(fractionalPart, b, offset);
} 
```

请建议我为此目的的最佳方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T00:03:19.243

```
byte[] bytes = new byte[8];
java.nio.ByteBuffer.wrap(bytes).putDouble(yourDouble); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T00:22:13.337

如果您真的想要低延迟，那么重要的是避免堆内存分配（这会导致 GC 在稍后的某个未指定的时间点暂停）。

所以我假设：

*   您已经提前分配了字节数组
*   你想在你的字节数组中放一个双精度而不做任何中间分配

诀窍是使用`doubleToLongBits`：

```
long v = Double.doubleToLongBits(myDouble); 
```

然后将 写入`long`字节数组中的正确位置（大概使用 8 个连续字节）。您不妨以蛮力方式执行此操作：

```
data[pos+7] = (byte)(v);
data[pos+6] = (byte)(v>>>8);
data[pos+5] = (byte)(v>>>16);
data[pos+4] = (byte)(v>>>24);
data[pos+3] = (byte)(v>>>32);
data[pos+2] = (byte)(v>>>40);
data[pos+1] = (byte)(v>>>48);
data[pos]   = (byte)(v>>>56); 
```

请注意，我们在每一点都使用原语，因此在整个过程中没有内存分配。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-28T00:28:15.537

如果您想要将双重格式设置为 ASCII（字符）字符串，那么 String.format 可能是让您控制格式的最简单方法：

```
String result = String.formatter("%5.3f", theDoubleValue); 
```

# google-chrome - 在 Chrome 中以绿色背景显示的 Web 套接字消息有什么特别之处？

> ID：14062905
> 
> 赞同：11
> 
> 时间：2012-12-27T23:59:21.117
> 
> 标签：google-chrome, websocket

查看 Stack Exchange 上的 Web 套接字，我注意到一些消息在 Chrome 中以绿色背景显示：

![开发者工具的网络选项卡截图，在普通的白底消息中显示出绿底消息](../Images/1cfd6f7b76bd0e00c8c05ee5c38962a8.png)

这些信息有什么特别之处？这些是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-02T17:27:42.497

绿色背景是发送到服务器的帧（消息）。白色背景是从服务器接收到的。

> 消息根据其类型进行颜色编码：
> 
> *   传出的短信是浅绿色的。
> *   收到的短信是白色的。
> *   WebSocket 操作码是浅黄色的。
> *   错误为浅红色。

[来源](https://developers.google.com/web/tools/chrome-devtools/network-performance/reference#frames)

# asp.net - 尝试将水晶报告 if-else 转换为 c# if-else

> ID：14062907
> 
> 赞同：1
> 
> 时间：2012-12-27T23:59:33.513
> 
> 标签：asp.net

我正在尝试将以下语句重写为 ac# 语句，以便我可以在我的程序中使用 if。我对水晶报告公式的理解不足以将其重写。

If Not IsNull({RET_USER_INFORMATION.TX_PHONE_WORK}) And Length (ToText({RET_USER_INFORMATION.TX_PHONE_WORK},0,"")) > 1 Then "(" & Mid (ToText({RET_USER_INFORMATION.TX_PHONE_WORK},0,""), 1, 3) & ") " & Mid (ToText({RET_USER_INFORMATION.TX_PHONE_WORK},0,""), 4, 3) &" - "& Mid (ToText({RET_USER_INFORMATION.TX_PHONE_WORK},0,""), 7, 4) 否则 "";

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:43:31.480

```
 string _foo = RET_USER_INFORMATION !=null && !String.IsNullOrEmpty(RET_USER_INFORMATION.TX_PHONE_WORK) ?  RET_USER_INFORMATION.TX_PHONE_WORK.ToString() : String.Empty;

 if(!String.IsNullOrEmpty(_foo))
 {
   return  String.Format("({0}){1}-{2}", _foo.Substring(0,3), _foo.Substring(3,3), _foo.Substring(6,4));
 }
 else
 {
   return String.Empty;
 } 
```

# javascript - 添加跳过按钮以快速转发 .fadeIn / .fadeOut？

> ID：14062908
> 
> 赞同：2
> 
> 时间：2012-12-28T00:00:07.753
> 
> 标签：javascript, jquery, html, fadein, fadeout

澄清一下，当您加载我的网站时，我有一些淡入（引用）的文本，然后淡出。之后，一段新的文字（我的品牌名称）逐渐消失。

因为我希望人们有足够的时间阅读第一个文本（引用），所以淡入淡出有点长，但是我不希望人们在第 5 次访问该网站并不得不等待之后变得不耐烦每次。

因此，我正在考虑一个“类似跳过”的按钮或文本（IE：SKIP），以便他们可以快进到品牌名称消失的地方。

任何帮助，将不胜感激！！！这是我目前拥有的一个例子！

[http://jsfiddle.net/K6SpB/](http://jsfiddle.net/K6SpB/)

## HTML

```
<script src="http://code.jquery.com/jquery-1.4.4.min.js" type="text/javascript"></script>   
<center>
   <div id="mytext" align="center">
      <table width="100%" height="100%" cellpadding="0" cellspacing="0" border="0">
         <tr>
            <td valign="middle" align="center">
               <table cellpadding="0" cellspacing="0" border="0">
                  <tr>
                     <td height="200">
                        <center>
                           <font size="4px" id="quote" color="black">THIS IS A QUOTE.</font>
                           <br>
                           <font size="12px" id="brandname" color="black">BRAND NAME.</font>
                        </center>
                     </td>                
                  </tr>    
               </table>
            </td>
         </tr>
      </table>
   </div>
</center> 
```

## JAVASCRIPT

```
$(document).ready(function() {
    $('#quote').hide().delay(1000).fadeIn(5000).delay(3000).fadeOut(2000);
    $('#brandname').hide().delay(11500).fadeIn(2000);
});​ 
```

## CSS

```
<style type="text/css">
   #quote, #brandname {
      position:relative;
      display: none;
      float:center;
   }
   #mytext {

   }
</style>​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:16:23.103

你可能想要 jQuery .stop() (http://api.jquery.com/stop/)

因此，如果您添加跳过链接：

```
<a href="#" id="skip">Skip</a> 
```

代码如下所示：

```
$('#skip').click(function(e) {
    e.preventDefault();
    $('#quote, #brandname').stop(true, true);
}); 
```

第一个“true”告诉 jQuery 从动画队列中删除所有待处理的动画，第二个“true”告诉它直接跳到动画的末尾。

# c - 在 C 中读取和打印 .txt 文件行的最清晰方法

> ID：14062910
> 
> 赞同：7
> 
> 时间：2012-12-28T00:00:33.037
> 
> 标签：c, file-io, scanf, printf, file-read

有很多方法描述了如何使用各种方法在这个站点上打印出文本文件的行：

*   [Posix 风格](https://stackoverflow.com/questions/1861007/reading-a-file-line-by-line-in-c?rq=1)，
*   [读取 IP 地址](https://stackoverflow.com/questions/1842393/how-to-read-a-file-line-by-line-in-c?rq=1)，
*   [固定线长](https://stackoverflow.com/questions/8467031/read-from-txt-c?rq=1)。

它们似乎都是针对特定示例量身定制的。

最好有最**清晰**、**最简洁**和**最简单**的方法：***将任何文本文件的每一行打印到屏幕上。***最好详细说明每行的作用。

简洁明了的要点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T00:09:38.917

```
#include <stdio.h>

static void cat(FILE *fp)
{
    char   buffer[4096];
    size_t nbytes;
    while ((nbytes = fread(buffer, sizeof(char), sizeof(buffer), fp)) != 0)
         fwrite(buffer, sizeof(char), nbytes, stdout);
}

int main(int argc, char **argv)
{
    FILE *fp;
    const char *file;
    while ((file = *++argv) != 0)
    {
        if ((fp = fopen(file, "r")) != 0)
        {
            cat(fp);
            fclose(fp);
        }
    }
    return(0);
} 
```

该`cat()`功能不是绝对必要的，但我宁愿使用它。主程序逐步执行每个命令行参数并打开命名文件。如果成功，它会调用该`cat()`函数来打印其内容。由于调用`fopen()`未指定`"rb"`，因此将其作为文本文件打开。如果文件未打开，此代码会静默忽略该问题。如果未指定文件，则根本不打印任何内容。

该`cat()`函数一次只读取最多 4096 字节的文本块，并将它们写入标准输出（“屏幕”）。当没有更多的阅读内容时它会停止。

如果要在未指定文件时扩展代码以读取标准输入，则可以使用：

```
if (argc == 1)
    cat(stdin);
else
{
    ...while loop as now...
} 
```

`cat()`这是编写如图所示的函数的原因之一。

此代码不直接关注换行符——或任何类型的行。如果你想一次正式地处理一行，那么你可以做几件事：

```
static void cat(FILE *fp)
{
    char buffer[4096];
    while (fgets(buffer, sizeof(buffer), fp) != 0)
         fputs(buffer, stdout);
} 
```

这将一次读取和写入一行。如果任何一行超过 4095 字节，它将在两次或更多操作中读取该行，并以相同数量的操作写入。请注意，这假定文本文件以版本使用`fread()`和`fwrite()`不使用的方式。在 POSIX 系统上，带有`fread()`and的版本`fwrite()`将处理数据中带有空字节 ( ) 的任意二进制文件`'\0'`，但使用`fgets()`and的版本`fputs()`不会。到目前为止，这两个版本都是严格的标准 C（标准的任何版本），因为它们不使用任何特定于平台的扩展；它们与代码一样可移植。

或者，如果你有 POSIX 2008[`getline()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html)函数，你可以使用它，但你也需要`#include <stdlib.h>`（因为你最终不得不释放它分配的内存）：

```
static void cat(FILE *fp)
{
    char *buffer = 0;
    size_t buflen = 0;
    while (getline(&buffer, &buflen, fp) != -1)
         fputs(buffer, stdout);
    free(buffer);
} 
```

此版本也不会处理二进制数据（即其中包含空字节的数据）。当然，它可以升级到这样做：

```
static void cat(FILE *fp)
{
    char *buffer = 0;
    size_t buflen = 0;
    ssize_t nbytes;
    while ((nbytes = getline(&buffer, &buflen, fp)) != -1)
         fwrite(buffer, sizeof(char), nbytes, stdout);
    free(buffer);
} 
```

该`getline()`函数报告它读取了多少字节（之后有一个空字节），但该`fwrite()`函数是唯一一个接受任意字节流并将它们全部写入给定流的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T23:53:14.280

好吧，这是我最终提出的一个非常简短的解决方案。我想它有一些根本性的错误，否则会被建议，但我想我会把它贴在这里并希望有人把它撕开：

```
#include <stdio.h>
main()
{
    FILE *MyFile;
    int c;
    MyFile=fopen("C:\YourFile.txt","r");
    c = fgetc(MyFile);
    while (c!=EOF)
    {
        printf("%c",c);
        c = fgetc(MyFile);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:04:03.983

@Dlinet，您正在尝试学习一些有关如何组织程序的有用课程。我不会发布代码，因为已经有一个非常好的答案；我不可能改进它。但我想向你推荐一本书。

这本书被称为*Pascal 中的软件工具*。语言是 Pascal，而不是 C，但是对于阅读这本书来说，这不会造成严重的困难。他们开始实现简单的工具，例如本例中的工具（在 UNIX 上称为`cat`），然后转向更高级的东西。他们不仅教授了有关如何组织此类程序的重要课程，而且还涵盖了语言设计问题。（Pascal 中确实存在让他们烦恼的问题，如果您了解 C，您将意识到 C 没有这些问题。）

这本书现在已经绝版，但我在学习编写代码时发现它非常有价值。直到今天，所谓的“左角设计”方法都很好地为我服务。

我鼓励你在亚马逊或其他任何地方找到一份用过的副本。亚马逊使用的副本起价为 0.02 美元，外加 4 美元的运费。

[http://www.amazon.com/Software-Tools-Pascal-Brian-Kernighan/dp/0201103427](https://rads.stackoverflow.com/amzn/click/com/0201103427)

学习本书中的程序并在 C 中实现它们将是一个教育练习。任何 Linux 系统都已经拥有这些程序的更强大和完全调试的版本，但是完成这些工作不会浪费你的时间书并学习如何写这些东西。

或者，您可以在您的计算机上安装 FreePascal 并使用它来运行书中的程序。

祝你好运，愿你永远喜欢软件开发！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T00:08:07.077

如果你想要一些预烘焙的东西，`cat`POSIX 系统上有。

如果你想自己写，这里是基本布局：

1.  检查以确保文件名、权限和路径有效
2.  在循环中读取直到换行符分隔符（在 Unix 上为 \n，在 Windows/DOS 上为 \r\n）
3.  检查错误。如果是这样，打印错误并中止。
4.  将行打印到屏幕。
5.  重复

关键是，实际上并没有具体的方法来做到这一点。只需阅读，然后写，然后重复。通过一些错误检查，你又得到了 cat 。

# php - 仅使用 javascript 生成和保存/下载文件

> ID：14062914
> 
> 赞同：3
> 
> 时间：2012-12-28T00:01:21.920
> 
> 标签：php, javascript, jquery, html

我为我的游戏制作了一个地图编辑器，代码生成到一个 id 为“code”的 div。我想知道如何使用此代码生成 javascript 文件。显然我必须得到代码 div 的文本。`var code = $("#code").text();`将工作。但现在我想用这段代码生成和下载 javascript 文件。是否可以仅使用 javascript 生成/下载文件，还是必须使用 php？

我想手动选择文件夹和名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:11:19.890

JavaScript 无权提示文件保存。您最好的选择是将其转储到一个新窗口并将其显示给用户，如果他们选择（文件->保存），他们可以在其中保存它。否则，您需要找到一种方法将必要的信息传递给 PHP 调用，然后 PHP 可以提供它，`Content-Disposition: attachment`并且可以提示客户端下载文件。

此外，正如 machineghost 刚刚击败我的那样，您可以使用像 flash 这样的插件来保持它的客户端，但它仍然不是纯 JavaScript。但[Downloadify](https://github.com/dcneiner/Downloadify)确实具有该功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:11:31.873

您的问题的简短回答是否定的。出于安全原因，浏览器非常小心，不允许 Javascript 对文件系统做任何事情。

然而，Flash 没有这样的限制；查看：[https](https://github.com/dcneiner/Downloadify) ://github.com/dcneiner/Downloadify 。当然，Flash 有其自身的问题，例如移动浏览器往往不支持它（但由于您的用例是下载文件，而移动用户可能不会这样做，这可能不是问题你）。

除了 Downloadify（或类似的基于 Flash 的解决方案）之外，您唯一的选择是 Java 小程序（您不想走那条路）、浏览器插件或某种服务器参与（例如 @Brad Christie描述）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T01:54:59.737

尽管您对建议文件名和文件扩展名的控制能力较差，但您可以做到这一点。

我不会将它用于生产网站，但它似乎有效。

```
function promptSave(data) {
    /*@cc_on @*/
    /*@if (@_jscript_version >= 4)
        //ie code here
        var iframe = document.createElement("iframe");
        document.body.appendChild(iframe);
        var doc = iframe.contentWindow.document;
        doc.write(data);
        doc.execCommand('SaveAs', '', 'somefilename.txt');//only certain file extensions allowed
        document.body.removeChild(iframe);
        @else @*/
        // non ie code
        window.location = 'data:application/octet-stream;base64,' + window.btoa(data);
    /*@end @*/
}
var data = 'var jsFoo = {k:55};';
promptSave(data); 
```

## **[演示](http://jsfiddle.net/3eQEX/)**

Firefox 坚持将其保存为`.part`文件。

# c# - 两个相似的 LINQ 查询，生成的 SQL 完全不同

> ID：14062915
> 
> 赞同：5
> 
> 时间：2012-12-28T00:01:25.330
> 
> 标签：c#, sql-server, linq, entity-framework

我遇到了以下伪查询的问题：

```
var daily = from p in db.table1
            group p by new
            {
                key1,
                key2
            } into g
            join d in db.table2
            on new { p.key1, p.key2 } equals { d.key1, d.key2 }
            select new
            {
                col1 = g.Key.key1
                col2 = g.Sum(a => a.column2)
                col3 = d.column3
            }; 
```

它运行，但生成的 LINQ 发送到 SQL Server 的 SQL 语句是**荒谬**的。实际实现遵循与上面类似的设置，有 7 个左右的列，每个列都有一个 .Sum() 计算。生成的 SQL 大约有 10-11 个嵌套的 SELECT 语句，没有 INNER JOIN，当然，运行需要很长时间。

我测试了查询的另一个实现：

```
var daily = from p in
                (from p in db.table1
                 group p by new
                 {
                     key1,
                     key2
                 } into g
                 select new
                 {
                     col1 = g.Key.key1,
                     col2 = g.Sum(a => a.column2)
                 })
            join d in db.table2
            on new { p.key1, p.key2 } equals new { d.key1, d.key2 }
            select new
            {
                col1 = p.col1,
                col2 = p.col2,
                col3 = d.column3
            }; 
```

这个版本使用单个 SUB-SELECT 和一个 INNER JOIN 语句生成更合理的 SQL（它也几乎立即运行）。我讨厌的一点是，恕我直言，第一个 LINQ 查询更加直接和简洁，而第二个查询似乎相当多余，因为我最终不得不从 table1 定义我想要的所有列两次。

为什么这两个相似的查询在服务器上执行如此不同，为什么查询 2 的效率要高得多，尽管它的代码表达力要差得多？

有没有办法可以将第一个查询重写为与第二个查询一样高效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T00:16:58.423

LINQ 2 SQL 存在以下模式的问题：

```
from t in table
group t by key into g
from t in g //"ungroup" the grouping - this is causing a problem
select ... 
```

我认为您的加入触发了这一点，因为它“取消了”分组。请注意，LINQ 连接是一种`GroupJoin`在 SQL 中无法表示的连接。想一想：你会如何翻译我的示例查询？您必须加入导致疯狂冗余`table`的分组版本。`table`

我已经多次看到这个问题。您找到了正确的解决方法：强制投影以防止出现这种模式。

有一个稍微不那么尴尬的版本：

```
var daily = from p in db.table1
            group p by new
            {
                key1,
                key2
            } into g
            select new
            {
                col1 = g.Key.key1,
                col2 = g.Sum(a => a.column2)
            } into p
            join d in db.table2 on new { p.key1, p.key2 } equals new { d.key1, d.key2 }
            select new
            {
                col1 = p.col1,
                col2 = p.col2,
                col3 = d.column3
            }; 
```

嵌套被鲜为人知的`select x into y`语法删除。

# python - 使用python的文件权限

> ID：14062917
> 
> 赞同：2
> 
> 时间：2012-12-28T00:01:32.150
> 
> 标签：python, permissions, operating-system

我在尝试读写的 Windows 网络驱动器上有一个 xml 文件。我拥有正常编辑文件的完全权限（在 gedit 或任何东西中），但是当我尝试在 python 中解析 xml 文件时，出现权限错误。有任何想法吗？

这是我正在尝试做的一个例子：

```
from xml.etree import ElementTree as ET
file = "/directory/to/xml/file"
nfo = ET.parse(file) 
```

然后我从文件中读取信息并写入文件。尝试写入文件时挂起（即使我使用 gedit，我也可以正常写入文件）

我得到的错误是：

```
Traceback (most recent call last):
  File "parser.py", line 277, in <module>
    nfo.write(file)
  File "/usr/lib/python2.7/xml/etree/ElementTree.py", line 803, in write
    file = open(file_or_filename, "wb")
IOError: [Errno 13] Permission denied: '/directory/to/xml/file' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T18:25:16.577

1.  如果您是文件所有者，您确定 gedit 不会忽略缺少写权限吗？vim 可以做到这一点，也许 gedit 也可以？我会从简单的开始`ls -l /directory/to/xml/file`。

2.  你总是可以这样做`strace -f /path/to/your_program.py`，这应该会给你更多关于 python 运行时实际尝试的信息。

# python - 将python脚本+模块捆绑/执行到远程机器

> ID：14062918
> 
> 赞同：2
> 
> 时间：2012-12-28T00:01:34.353
> 
> 标签：python

我研究了其他 python 模块分发问题。我的需求有点不同（我想！，我是python新手+）

我有一堆需要在远程机器上执行的 python 脚本。这是目标环境的样子；

*   这些机器将安装基本 python 运行时
*   我将拥有一个 SSH 帐户；我可以使用 ssh 远程登录或执行命令
*   我可以将文件（scp）复制到我的主目录中
*   我不允许在机器上安装任何东西；这些机器甚至可能无法访问互联网
*   我的脚本可能会使用一些“异国情调”的 python 模块——它们很可能不会出现在目标机器中
*   审核后，我的主目录将从机器上删除（不留痕迹）

所以我喜欢做的是：

*   将 python 脚本 + 模块的目录结构复制到远程计算机（例如在 /home/audituser/scripts 中）。并且模块可以复制到/home/audituser/scripts/pythhon_lib)
*   然后执行一个脚本（比如 /home/audituser/scripts/myscript.py）。该脚本需要解析“python_lib”子目录中使用的所有模块。

这可能吗？或者有更好的方法吗？我想我正在寻找的是将第 3 方模块“重新定位”到脚本目录中。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:11:24.707

远程机器是否彼此相同？而且，如果是这样，您能否设置一台与远程机器实际上相同的开发机器？

如果是这样，[`virtualenv`](http://pypi.python.org/pypi/virtualenv)这几乎是微不足道的。在您的开发机器上创建一个`virtualenv`，使用 的`virtualenv`副本`pip`将任何第三方模块安装到其中，在其中构建您的脚本，然后将整个环境复制到每台远程机器。

有三件事使它可能变得不平凡：

*   如果远程机器没有（也不能）`virtualenv`安装，您需要执行以下操作之一：
    *   在许多情况下，仅仅复制一个`--relocatable`环境就可以了。请参阅“使环境可重定位”的文档部分。
    *   您始终可以在每台机器上捆绑`virtualenv`自己，并且`pip install --user virtualenv`（如果他们甚至没有`pip`，那么在此之前的几步）。这将使用户帐户处于永久更改状态。（但幸运的是，您的用户帐户将被核爆，所以谁在乎呢？）
    *   您可以编写自己的手动引导。请参阅“创建您自己的引导脚本”部分。
    *   默认情况下，你会得到比你需要的更多的东西——Python 可执行文件、标准库等。
    *   如果机器不相同，这可能不起作用，或者至少可能效率不高。
    *   即使它们是，您仍然经常使您的捆绑数量级更大。
    *   请参阅有关在没有 bin/python、--system-site-packages 和可能的引导的情况下使用 Virtualenv 的文档部分。
*   如果您正在安装的任何 Python 模块还需要 C 库（例如`libxml2`for `lxml`），`virtualenv`则无济于事。事实上，您需要 C 库几乎完全相同（相同的路径，兼容的版本）。

其他三种选择：

*   如果您的需求足够简单（或者最简单的部分涉及无用的事情`virtualenv`，例如安装`libxml2`），那么将 .egg/.tgz/whatever 文件捆绑到第三方模块并编写一个脚本，`pip install --user`为每个脚本执行一个等等，然后你就完成了。
*   仅仅因为你*不需要*一个完整的应用分发系统并不意味着你不能使用一个。`py2app`, `py2exe`,`cx_freeze`等并不是*那么*复杂，尤其是在简单的情况下，并且拥有一个点击即可复制的可执行文件比拥有一个显式环境更容易。
*   `zc.buildout`是一个非常灵活且易于管理的工具，可以做与这三种替代方法中的任何一种等效的工具。主要的缺点是学习曲线要​​陡峭得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T00:06:11.070

您可以使用[virtualenv](http://www.virtualenv.org/en/latest/)为您的项目创建一个独立的环境。这可以容纳您自己的脚本以及任何依赖库。然后您可以使 env 可重定位 ( `--relocatable`)，并将其同步到目标机器，激活它并运行您的脚本。

如果这些机器确实可以访问网络（不是互联网，而只是本地网络），您还可以将 virtualenv 放在共享位置并从那里激活。

它看起来像这样：

```
virtualenv --no-site-packages portable_proj
cd portable_proj/
source bin/activate
# install some deps
pip install xyz
virtualenv --relocatable . 
```

现在`portable_proj`可以dist到其他机器上。

# rpm - CentOS 上的 rpmbuild 问题 - /home/me/rpmbuild/tmp/rpm-tmp.58942 的退出状态错误

> ID：14062919
> 
> 赞同：10
> 
> 时间：2012-12-28T00:01:37.713
> 
> 标签：rpm, rpmbuild

我正在尝试创建一个仅更新系统上文件的包，但是在运行 rpmbuild 时我不断收到错误消息。该错误表明文件丢失。

我已经在 CentOS 5 和 6 上尝试过，结果相同。

我用来`rpmdev-setuptree`设置文件系统，它也设置`~/.rpmmacros`文件。然后我用来`rpmdev-newspec`初始化规范文件。

我以非 root 用户身份运行。

我有规范文件`~/rpmbuild/SPECS/test.spec`，我的来源是：`~/rpmbuild/SOURCES/test-1.tar.gz`. 提取此文件会创建一个目录`test-1`，其中包含 2 个文件。我已经确认它确实会`~/rpmbuild/BUILD/test-1`在我尝试构建包时被提取。

我跑：`rpmbuild -ba ~/rpmbuild/SPECS/test.spec`

然后我得到这个错误：

> *   ./configure --build=x86_64-redhat-linux-gnu --host=x86_64-redhat-linux-gnu --target=x86_64-redhat-linux-gnu --program-prefix= --prefix=/usr -- exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --sysconfdir=/etc --datadir=/usr/share --includedir=/usr/include --libdir=/usr /lib64 --libexecdir=/usr/libexec --localstatedir=/var --sharedstatedir=/usr/com --mandir=/usr/share/man --infodir=/usr/share/info /home/me/rpmbuild /tmp/rpm-tmp.58942: line 37: ./configure: No such file or directory error: Bad exit status from /home/me/rpmbuild/tmp/rpm-tmp.58942 (%build)
> 
> RPM 构建错误：来自 /home/me/rpmbuild/tmp/rpm-tmp.58942 (%build) 的错误退出状态

这是我的规格文件：

```
Name:           test
Version:        1
Release:        1%{?dist}
Summary:        Test

Group:          Test
License:        GPL
URL:            http://example.com 
Source0:        test-1.tar.gz 
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

#BuildRequires:  
#Requires:       

%description
This is a test to push files.

%prep
%setup -q

%build
#%configure
#make %{?_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT
#make install DESTDIR=$RPM_BUILD_ROOT
install -m 0755 -d $RPM_BUILD_ROOT/opt/test

%clean
rm -rf $RPM_BUILD_ROOT

%files
%dir /opt/test
%defattr(-,root,root,-)
%doc 
```

关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T02:49:36.603

看起来默认的 GNU " `./configure`" 脚本不存在，因此您不能`%setup`在规范文件中使用默认宏，并且需要一个自定义`%prep`部分... [（一个来源）](http://www.rpm.org/max-rpm/s1-rpm-inside-scripts.html) [（镜像）](http://ftp.rpm.org/max-rpm/s1-rpm-inside-scripts.html)

# excel - 基于非统一数据范围在 2 张工作表之间链接数据

> ID：14062926
> 
> 赞同：1
> 
> 时间：2012-12-28T00:02:45.053
> 
> 标签：excel, vba, hyperlink, copy

我试图在一张纸上获取非统一范围的数据并将其链接（单元格将具有“=Sheet1！A1”，而不是硬编码值）到同一工作簿中的另一个工作表。

我不能只使用 .UsedRange 因为我的选择中有很多空单元格，我不想链接到另一个工作表

到目前为止，这是我的代码，但我收到一条错误消息，提示您不能将 .copy 与这种选择一起使用。有人可以建议解决这个问题。谢谢你。

```
Sub test()
Application.ScreenUpdating = False

ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants).Copy
With Sheets("Sheet2")
    .Activate
    .Range("A1").Select
    ActiveSheet.Paste Link:=True
End With

Application.CutCopyMode = False
Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:28:54.990

您可以逐个单元格地遍历`SpecialCells`范围，并根据源单元格地址编写链接，如下所示

```
Sub test()
    Dim cl As Range
    Dim sh As Worksheet
    Dim ShName As String
    Dim OldCalc As XlCalculation

    Application.ScreenUpdating = False
    OldCalc = Application.Calculation
    Application.Calculation = xlCalculationManual

    Set sh = Worksheets("Sheet2")
    sh.Cells.Clear '<-- Optional
    ShName = "='" & ActiveSheet.Name & "'!"
    For Each cl In ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants)
        sh.Range(cl.Address).Formula = ShName & cl.Address
    Next

    Application.ScreenUpdating = True
    Application.Calculation = OldCalc
End Sub 
```

虽然在一个范围内循环并不理想（由于速度），但在这种情况下可能就足够了。

如果活动工作表为空，这`Sub`将出错：您可能需要为这种情况添加错误处理程序

# iphone - 在 iOS 6 中捕获全景的库

> ID：14062932
> 
> 赞同：13
> 
> 时间：2012-12-28T00:03:29.527
> 
> 标签：iphone, ios, ios6, panoramas

在 iOS 中有很多方法和库可以显示全景图片，虽然内置相机中有全景功能，但无法在应用程序中使用它。

有没有我可以用来捕捉全景图像的库？

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-28T04:59:29.577

[这些人](http://www.cs.bath.ac.uk/brown/autostitch/autostitch.html#licensing)可能会向您出售 C++ 库的许可证。他们的代码进入了 App Store 中出色的 Autostich 应用程序。

Autostitch 基于 SIFT 图像特征检测。[openCv c++ 库](http://openCv.org)中提供了 SIFT 和许多其他技术。该站点提供了一个预构建的 iOS 框架。

**更新**

OpenCV 有一个`Stitcher`包含大量文档的类...

[OpenCV 拼接管道](http://docs.opencv.org/modules/stitching/doc/high_level.html#stitcher)

[OpenCV 缝合器类](http://docs.opencv.org/modules/stitching/doc/high_level.html#stitcher)

> “高级图像拼接器。可以在不了解整个拼接流水线的情况下使用该类。但是，为了能够获得更高的拼接稳定性和最终图像的质量，至少建议熟悉该理论（参见[Stitching pipline](http://docs.opencv.org/modules/stitching/doc/high_level.html#stitcher) )。”

**更新 2**

如果您以前没有使用过 openCV，第一个障碍是编译该库并将其安装到您的项目中。[可能很棘手，请在此处](https://stackoverflow.com/questions/13905471/opencv-2-4-3-ios-framework-compiler-trouble-recognising-some-c-headers)查看我的问题和答案（安装并运行 openCV）和[此处](https://stackoverflow.com/questions/13958321/iosretrieve-rectangle-shaped-image-from-the-background-image/14123682#14123682)（如何将 c++ 代码与 Objective-c 分开的示例，以及示例 github 项目）。

当您使用 openCV 时，这应该是开始查询的最快方法：

```
Stitcher::stitch(InputArray images, OutputArray pano) 
```

参数：
images - 输入图像。
pano – 最后的全景。

然后加快速度 - 如果你有它们 - 提供感兴趣的区域 rects（指示照片重叠​​的位置）

```
Stitcher::stitch(InputArray images, const std::vector<std::vector<Rect>>& rois, OutputArray pano) 
```

您可以深入研究拼接管道以优化该过程的许多细节，但这应该足以让您入门。

如果您查看 openCV 发行版的 samples/cpp 文件夹，您将看到几个拼接示例，[`stitching.cpp`](https://github.com/Itseez/opencv/blob/master/samples/cpp/stitching.cpp) 以及[`stitching_detailed.cpp`](https://github.com/Itseez/opencv/blob/master/samples/cpp/stitching_detailed.cpp).

为了提供输入图像，您需要连接相机并设计一个体面的用户界面来帮助用户拍摄正确类型的照片（例如，具有良好的重叠）。

如果您想查看使用 openCV 的现有项目，[这里有一个](https://code.google.com/p/android-opencv-panorama/)声称可以做您所追求的 android 的项目 - 不同的平台，但原理是相同的（使用 java 接口进入相同的库）。尤其看一下[PanoActivity.java](https://code.google.com/p/android-opencv-panorama/source/browse/android/pano/src/net/pandorica/opencv/pano/PanoActivity.java)。

**更新 3**
我已将[一个非常基本的示例上传到 github](https://github.com/foundry/OpenCVStitch)。我对它的出色工作印象深刻，没有任何优化或调整。它在我的 github 项目中缝合示例照片，几乎与 Autostitch 应用程序一样。

***一段时间后***更新 4** ......我已经[更新了一个新的示例项目，以便与 Swift 和 Cocoapods 一起使用](https://github.com/foundry/OpenCVSwiftStitch)**

# java - Java较短的加密

> ID：14062933
> 
> 赞同：2
> 
> 时间：2012-12-28T00:03:36.140
> 
> 标签：java, string, encryption, classpath, obfuscation

我正在尝试将Java中的长字符串（长度为200-500个字符）加密为加密/混淆（任何一个都对我有用）字符串，我稍后可以将其解密回原始的200-500个字符串。问题是我需要加密字符串不超过 32 个字符（我希望加密字符串很好地适合控制台行）。任何人都可以帮我解决这个问题..？如果有的话？我搜索了一段时间，只能找到像 base64 或 AES 这样的输出字符串太长的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T00:07:03.907

没有办法对 32 个字符中的每个可能的 200 个字符串进行无损压缩。这简直是​​不可能的。

理解这一点的示例：假设我们只有 ASCII：

200 个字符，这意味着 127^200 个可能的 200 个字符单词

只有 127^32 个可能的长度为 32 的单词。因此，不存在将每个 200 个字符的单词翻译成另一个 32 个字符的单词的方法，如果您希望能够将它包转换为 200 个字符的单词，这将是必要的（没有错误）

数学说，你要求的东西是不可能的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T00:14:24.033

有 256^200 个可能的长度为 200 的字符串（假设您使用 8 位扩展 ASCII 字符 0-255）。有 256^32 个可能的大小为 32 的字符串。

这意味着任何将任何 200 个字符的字符串转换为 32 个字符的函数的任何函数，最终都将不可避免地将多个输入字符串转换为相同的输出字符串——因为可能的输出字符串太少了（参见[鸽洞原理](http://en.wikipedia.org/wiki/Pigeonhole_principle)）。

您可以很容易地想出一个将输入字符串映射到 32 个字符的输出的散列函数，但是由于多个字符串可能映射到相同的输出，因此不可能反转该过程以在给定输出的情况下获取输入字符串。

# jquery - SlideDown divs 直到找到另一个类的 div

> ID：14062942
> 
> 赞同：4
> 
> 时间：2012-12-28T00:05:11.160
> 
> 标签：jquery, html, accordion, hidden, slide

我有这样的代码：

```
<div class="clickme">some text</div>
<div class="slide">slide</div>
<div class="slide">slide</div>
<div class="slide">slide</div>
<div class="clickme">some text</div>
<div class="slide">slide</div> 
```

带有类幻灯片的 div 是隐藏的，我想要做的是，如果用户单击 div clickme，则只有接下来的三个（或任意数量）的 div 会向下滑动以显示内容，如果用户单击第二个 clickme div。

我无法更改 html，所以我认为 jQuery 可能是我的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:09:21.773

你需要[`.nextUntil()`](http://api.jquery.com/nextUntil/)-[**演示**](http://jsfiddle.net/eQLj8/)

```
$(".clickme").on("click", function() {
    $(this).nextUntil(".clickme").slideToggle();
})​; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:12:24.270

在这个小提琴中使用[`slideToggle`](http://api.jquery.com/slideToggle/)和喜欢：http: [//jsfiddle.net/Cvx9s/](http://jsfiddle.net/Cvx9s/)[`next`](http://api.jquery.com/next/)

*html*

```
<div class="clickme">some text</div>
<div class="slide">slide</div>
<div class="slide">slide</div>
<div class="slide">slide</div>
<div class="clickme">some text</div>
<div class="slide">slide</div>​ 
```

*js*

```
$('.slide').hide();
$('.clickme').click(function(){
 var tar = $(this).next();
 while(tar.hasClass('slide')){
  tar.slideToggle();
  tar = tar.next();       
 }
}); 
```

​</p>

# mysql - 从mysql表中匹配不同的列sport和dport

> ID：14062947
> 
> 赞同：2
> 
> 时间：2012-12-28T00:05:51.303
> 
> 标签：mysql, security, packets

我有一个包含 UDP 数据包的表，正在存储以供分析。我想搜索不是由我的服务器请求的数据包。
例如，如果我从源端口 106 和 dst 端口 32767 收到一个 UDP 数据包，但我从未从我的 IP 地址发送数据包

这是表结构。

```
mysql>show columns from packets;
+--------+------------------+------+-----+---------+-------+
| Field  | Type             | Null | Key | Default | Extra |
+--------+------------------+------+-----+---------+-------+
| stime  | datetime         | YES  |     | NULL    |       | 
| sip    | int(10) unsigned | YES  |     | NULL    |       | 
| dip    | int(10) unsigned | YES  |     | NULL    |       | 
| sport  | smallint(6)      | YES  |     | NULL    |       | 
| dport  | smallint(6)      | YES  |     | NULL    |       | 
| in_out | tinyint(4)       | YES  |     | NULL    |       | 
| id     | smallint(6)      | YES  |     | NULL    |       | 
+--------+------------------+------+-----+---------+-------+
7 rows in set (0.00 sec)

mysql> select * from packets limit 5;
+---------------------+------------+------------+-------+-------+--------+-------+
| stime               | sip        | dip        | sport | dport | in_out | id    |
+---------------------+------------+------------+-------+-------+--------+-------+
| 2012-12-03 20:59:45 |  167837953 | 3406507329 |  1029 |    53 |      0 | 32767 | 
| 2012-12-03 20:59:45 | 3406507329 |  167837953 |    53 |  1029 |      1 | 32767 | 
| 2012-12-03 20:59:46 | 3406507329 |  167837953 |    53 |  1029 |      1 | 32767 | 
| 2012-12-03 20:59:46 | 2399874369 |  167837953 |    53 | 32321 |      1 |  3000 | 
| 2012-12-03 21:00:02 | 2064330049 |  167837953 |    53 |  3349 |      1 |  1207 | 
+---------------------+------------+------------+-------+-------+--------+-------+
5 rows in set (0.00 sec) 
```

在上面的示例中，最后两个数据包是我应该能够通过查询找到的未经请求的数据包。基本上，如果我得到一个与元组不匹配的数据包`(source,dest,sourceport,dstport,id)`- 我需要在 Mysql 表中列出所有这些行。

谢谢维杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:35:02.270

这应该这样做：

```
SELECT *
FROM packets
LEFT JOIN packets_2 ON (
    packets.sip = packets_2.dip
    AND packets.dip = packets_2.sip
    AND packets.sport = packets_2.dport
    AND packets.dport = packets_2.sport
    AND packets.id = packets_2.id
    AND packets.stime <= packets_2.stime -- I think this makes sense
)
WHERE packets_2.id IS NULL 
```

# java - 十字路口的线程同步

> ID：14062948
> 
> 赞同：3
> 
> 时间：2012-12-28T00:06:06.043
> 
> 标签：java, multithreading, synchronization

所以，我有这个项目，马上就要到期了，恐怕我还不太了解线程同步的概念。实际上，我似乎根本无法理解，所以如果我的问题很愚蠢 - 我提前道歉。

这个想法很简单——我有多个线程代表动物（Antilope、Lion 等扩展了 Animal 实现 Runnable），以及一个 Tile 对象的 2D 数组。动物需要在没有碰撞的情况下移动 - 如果一个人想移动到另一个人站立的瓷砖，它应该与它交互（），然后 - 如果另一个人没有死 - 等到它离开。

因此，当动物移动时，显然需要在目标图块上同步，这样没有两只动物可以同时进入一个图块。然而，当它移动时，它显然需要在它站立的瓷砖上调用 notify()，以便其他想要移动到那里的动物可以醒来。

我尝试锁定两者，但结果是动物无缘无故地死在了它们的轨道上。这是一段代码，为了澄清一点：

```
void move(dir direction)
{
    Integer tarX = ((direction==dir.east?(x+1):(direction==dir.west?(x-1):x))); // east->x+1/west->x-1/NS->x
    Integer tarY = ((direction==dir.north?(y-1):(direction==dir.south?(y+1):y))); //see above
    Animal an;
    synchronized(TileManager.getInstance().playField[tarX][tarY])
    {

            an = AnimalManager.getInstance().searchByXY(tarX, tarY);   
            while (an != null)
            {                    
                interact(an); //assume it's empty - if it isn't, it results in a death of target animal anyway                
                an = AnimalManager.getInstance().searchByXY(tarX, tarY); //possibly redundant?
                if (an != null) {
                    try {
                        TileManager.getInstance().playField[tarX][tarY].wait();
                    } catch (InterruptedException ex) {
                    }
                }
                an = AnimalManager.getInstance().searchByXY(tarX, tarY, dir.none);
            }
        synchronized(TileManager.getInstance().playField[x][y])
        {
                int prevX = x;
                int prevY = y;
                x = tarX;
                y = tarY;
                TileManager.getInstance().playField[prevX][prevY].notify();
                TileManager.getInstance().playField[x][y].notify();
        }
    }
} 
```

是的，这是一团糟，我知道，而且效果也不太好。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:19:54.370

您将不得不查看此解决方案的性能是否正常，但您可以引入某种必须锁定的“仲裁器”对象，以便同步访问任何 PlayField。

模式将是：

```
private static final Object arbiter = new Object( );

void move(dir direction)
{
  ...
  TileManager tileManager = TileManager.getInstance( );

  synchronized( arbiter )
  {
    PlayField tarXtarYField = tileManager.playField[tarX][tarY];

    synchronized( tarXtarYField )
    {
      ...

      PlayField xyField = tileManager.playField[x][y];
      synchronized( xyField )
      {
        ...
        tileManager.playField[prevX][prevY].notify();
        xyField.notify();
      }
    }
  }
} 
```

这种模式将帮助您避免死锁，但代价是游戏移动速度较慢，因为本质上对游戏区域的访问是通过`arbiter`对象序列化的，因此一次只能移动 1 个线程。

如果场地不太大，动物数量少，表现还算可以接受。如果不是，那么你真的必须从头开始重写这个程序。

# python - 如何引用models.py之外的信号

> ID：14062951
> 
> 赞同：5
> 
> 时间：2012-12-28T00:06:19.213
> 
> 标签：python, django

在 的文档中`Django`，它指定这是为信号（ 、等）`models.py`定位回调函数的好地方。`post_save``pre_save`

> 这段代码应该放在哪里？
> 
> 您可以将信号处理和注册代码放在您喜欢的任何地方。但是，您需要确保尽早导入它所在的模块，以便在需要发送任何信号之前注册信号处理。这使您的应用程序的 models.py 成为注册信号处理程序的好地方。
> 
> 来源：[https ://docs.djangoproject.com/en/dev/topics/signals/](https://docs.djangoproject.com/en/dev/topics/signals/)

但是，我有大量依赖于信号的业务逻辑，并且在与我的所有模型相同的文件中查看它们变得具有挑战性。

我想将它们移动到另一个文件，但我不知道如何或在哪里可以引用它们。

那么，给定以下文件结构，您能否提供一个示例，说明如何引用包含适当信号的二级（或三级等）文件？

```
# models.py located in /myapp/some_installed_app/
from django import needed.modules
... # some reference to signals.py?

class SomeModel()
    pass

# signals.py located in /myapp/some_installed_app/
from django import needed.things
...

def somefun(sender,**kwargs)
    pass

post_save.connect(somefun, sender=SomeModel) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T22:27:14.517

如何在models.py中“连接”信号，同时在signals.py中保留函数？

* * *

一个例子：

```
# models
from myapp import signals
class MyModel(models.Model)
    pass
post_save.connect(signals.do_some_stuff_with_mymodel, sender = MyModel)

# signals
def do_some_stuff_with_mymodel(**kwargs):
    pass 
```

这样你根本不必`models`导入`signals`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:56:02.320

另一种选择是在您的`__init__.py`文件中导入信号。

这将确保尽早注册并避免循环进口。

# javascript - 在 Google Visualization API 中使用 Group By Aggregation 保留格式

> ID：14062952
> 
> 赞同：10
> 
> 时间：2012-12-28T00:06:22.033
> 
> 标签：javascript, google-data-api, google-visualization, google-datatable

使用 Google 的 Visualization API，我使用 google.visualization.data.group 根据我的原始数据创建子表。我的原始数据使用 {v:"US", f:"United States"} 的技巧来显示除值之外的其他内容，但是当我使用聚合函数时，格式被消除，只剩下“US”部分。

有什么方法可以保留原始格式，或者有一种简单的方法可以将它重新添加到使用组聚合创建的 DataTables 上？

样本数据：

```
[2010, {v:"MA", f:"Morocco"}, {v:"002", f:"Africa"}, {v:"002", f:"Northern Africa"}, 21.12724],
[2010, {v:"AW", f:"Aruba"}, {v:"019", f:"Americas  "}, {v:"019", f:"Caribbean"}, 0.98],
[2010, {v:"AF", f:"Afghanistan"}, {v:"142", f:"Asia"}, {v:"142", f:"Southern Asia"}, 0.9861],
[2010, {v:"AO", f:"Angola"}, {v:"002", f:"Africa"}, {v:"002", f:"Middle Africa"}, 5.11774], 
```

聚合功能：

```
var countryData = google.visualization.data.group(
  rawData, 
  [0, 1], 
  [{'column': 4, 'aggregation': google.visualization.data.sum, 'type': 'number'}]
); 
```

编辑：

进一步考虑，可能不可能用格式分组，因为不能保证每个值的格式都是一致的。考虑到这一点，编写一个将格式添加到我的数据的每一列的函数可能会更好（或唯一可能）。所以问题变成了，“我到底是怎么做到的？”

我真的不想将我的原始数据单独创建为未格式化的值，然后使用其他表格来查找每个值的格式。这将需要额外的 2 个表（一个用于 28 行的区域，一个用于超过 240 行的国家），然后创建两个函数来查看分组表中的每个值（这将具有 30 多年的数据，意味着数千行）添加值。

这似乎是一个非常复杂的解决方案。

有没有办法用修饰函数做到这一点？我可以编写一个函数以将表中的每个值作为 {v: "US", f: "United States"} 格式的对象返回吗？或者有没有一种简单的方法来编写一个列格式化程序，它将在我的原始表中查找适当的值并采用该格式？对于我（谁必须编写它）和用户（谁必须加载它）来说，哪个最不让人头疼？

编辑2：

看起来我应该能够使用以下内容为新表创建格式化程序：

```
function (dt, row) {
    return {
        v: (dt.getValue(row, 1) / 1000000),
        f: (dt.getValue(row, 1) / 1000000) + 'M'
    }
} 
```

但是问题变成了，因为我不处理数字格式，所以我必须创建某种查找表来获取值，在查找表中查找它，然后返回适当的格式。看起来我可能必须逐行遍历整个表，即数千行。

我无法想象如果没有一些蛮力循环和分配值，就没有一种简单的方法可以做到这一点。

编辑 3：

所以我尝试了一些棘手的事情。我没有将每一行设置为值/格式，而是将值/格式部分创建为字符串，然后在分组后使用 eval() 来评估对象。这很好用。这是数据：

```
[2010, "{v: 'MA', f: 'Morocco'}", 21.13],
[2010, "{v: 'AW', f: 'Aruba'}", 0.98],
[2010, "{v: 'AF', f: 'Afghanistan'}", 0.99],
[2010, "{v: 'AO', f: 'Angola'}", 5.12], 
```

这是新代码：

```
 var countryCount = countryData.getColumnRange(0).count;

  for (var i = 0; i <= countryCount; i++) {
    countryData.setValue(i, 1, eval('(' + countryData.getValue(i,1) + ')'));
  }; 
```

问题是，当我将其输出到 Google DataTable 时，它​​显示 {v: 'AE', f: 'United Arab Emirates'} 尽管使用 eval 正确检查结果给了我：

```
>>> eval('(' + countryData.getValue(i,1) + ')')
Object v="AE" f="United Arab Emirates" 
```

那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T02:14:20.390

好的，我想出了这个（它是多么令人讨厌的复杂）。

我尝试了一种新方法。我重新格式化了我的数据，然后创建了一个函数来根据该字符串中的分隔符返回一个值/格式。所以我的数据现在看起来像这样：

```
[2010, "'MA'|'Morocco'", 21.13],
[2010, "'AW'|'Aruba'", 0.98],
[2010, "'AF'|'Afghanistan'", 0.99],
[2010, "'AO'|'Angola'", 5.12], 
```

然后我用它来获取第 1 列的分隔符位置：

```
var countryCount = countryData.getNumberOfRows();

for (var i = 0; i <= countryCount; i++) {
  var stringToSplit = countryData.getValue(i,1);
  var dividerLocation = stringToSplit.indexOf("|");
  alert("Divider: " + dividerLocation + ", String: " + stringToSplit);
  countryData.setValue(i, 1, splitFormat(dividerLocation, stringToSplit));
}; 
```

然后我使用这个函数来分割字符串：

```
 function splitFormat(dividerLocation, stringToSplit) {
    // alert("entered splitFormat Function");
    var stringValue = "";
    var formatValue = "";
    stringValue = stringToSplit.substring(0, dividerLocation);
    formatValue = stringToSplit.substring(dividerLocation + 1)
    alert("v: " + stringValue + ", f: " + formatValue);
    return {
      v: stringValue,
      f: formatValue
    }
      } 
```

问题是我将数据的第 1 列定义为“字符串”，但萤火虫告诉我从 splitFormat() 函数返回的对象是一个对象（因为我想它是一个数组）。即使我使用 av: 和 f: 组件设置原始数据表，它也不想接受返回的数组对象值，因为 FireBug 给了我以下非常有用的建议：

```
"Error: Type mismatch. Value [object Object] does not match type string in column index 1 (table.I.js,137)" 
```

问题是虽然您可以使用 {v: , f:} 语法定义 DataTable，但您无法将该语法返回到表中，因为该列的值设置为字符串。相反，我使用 DataTable 的“setFormattedValue”属性来解决问题：

```
 function drawVisualization() {
    var countryTable = new google.visualization.Table(document.getElementById('table'));

    var countryCount = countryData.getNumberOfRows() - 1;

    for (var i = 0; i <= countryCount; i++) {
      var stringToSplit = countryData.getValue(i,1);
      var dividerLocation = stringToSplit.indexOf("|");
      var stringValue = stringToSplit.substring(0, dividerLocation);
      var stringFormat = stringToSplit.substring(dividerLocation + 1);
      countryData.setValue(i, 1, stringValue);
      countryData.setFormattedValue(i, 1, stringFormat);
    }; 
```

这正确地为我提供了两者的适当值，即使它对于大型数据集来说有点密集。如果有人知道更简单的方法来做到这一点，那么我会很高兴听到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-11T16:49:06.820

我自己也遇到了这个问题。我决定使用修饰符将值更改为使用原始数据表的格式化值以查找格式化值。这不是非常有效，但它可以工作并且计算机速度很快。

首先创建一个查找函数：

```
function getFormatForValue(dataTable, column, value) {

    // we need to spin through column in the dataTable looking
    // for the matching value and then return the formatted value
    var rowcount = dataTable.getNumberOfRows();
    for (var i=0; i<rowcount; i++) {
        if (dataTable.getValue(i, column) === value) {

            // we found it, this will look much better
            return dataTable.getFormattedValue(i, column);    
        }
    }

    // better than nothing
    return value;
} 
```

然后在修饰符中调用它，改变你原来的群呼：

```
var countryData = google.visualization.data.group(
    rawData, 
    [
     {
      'column': 0,
      'modifier': function(value) { return getFormatForValue(rawData, 0, value); },
      'type': 'string'
     },
     {
      'column': 1,
      'modifier': function(value) { return getFormatForValue(rawData, 1, value); },
      'type': 'string'
     }
    ], 
    [{'column': 4, 'aggregation': google.visualization.data.sum, 'type': 'number'}]
); 
```

更新：您似乎需要保留值和格式化值。在我显示饼图的情况下，我不在乎保留原始值。我想这对你不起作用，但我会把这个答案留给其他可能像我这样更简单的情况的人。

我在这上面又花了几分钟，这里有一个替代方法，它可以复制格式化的值，同时保留原始的单元格值。

创建一个使用查找函数的复制函数：

```
function copyFormattedValues(oldDataTable, oldColumn, newDataTable, newColumn) {

    var rowcount = newDataTable.getNumberOfRows();
    for (var i=0; i<rowcount; i++) {
        var value = newDataTable.getValue(i, newColumn);
        var formatted = getFormatForValue(oldDataTable, oldColumn, value);
        newDataTable.setFormattedValue(i, newColumn, formatted);
    }

 } 
```

然后在您的情况下，为您要复制的每一列调用一次。

```
copyFormattedValues(rawData, 0, countryData, 0);
copyFormattedValues(rawData, 1, countryData, 1); 
```

您的源列和目标列是相同的，但在某些情况下它们可能不同。

当然，理想情况下，所有这些都会自动发生。

# android - 从 Android Emulator 向 localhost 发送文件 - 来自 localhost / PHP 文件问题的 301 错误响应

> ID：14062955
> 
> 赞同：0
> 
> 时间：2012-12-28T00:07:01.867
> 
> 标签：android, android-emulator, xampp, localhost, http-status-code-301

我正在尝试将 android 模拟器连接到我的本地主机（xampp）并将文件发送到文件夹。

我正在使用来自 slott 的代码 -[将代码包装在异步任务中以避免线程错误](https://stackoverflow.com/questions/4126625/how-to-send-a-file-in-android-from-mobile-to-server-using-http)

并通过以下方式调用它：

```
new AsyncHttpPostTask("http://10.0.2.2/android").execute(new File(myFile)); 
```

myFile 是包含一些文本的有效文件

文件夹“android”直接存在于 C 盘上的“xampp/htdocs”文件夹下

我在清单中添加了互联网权限

我删除了我的 AVD 并创建了一个新的

XAMPP 正在运行，如果我在浏览器中打开它，路径是有效的，例如`http://localhost/android`

执行代码后，我从 localhost 服务器收到**“301 Moved Permanently”响应**

关于我做错了什么或如何进一步调查的任何想法？

==编辑

我错过了路径上的 php 文件。我正在使用以下 PHP

```
<?php
if (is_uploaded_file($_FILES['userfile']['tmp_name'])) {
  echo "File ". $_FILES['userfile']['name'] ." uploaded successfully.\n";
  move_uploaded_file ($_FILES['userfile'] ['tmp_name'], $_FILES['userfile'] ['name']);
} else {
  echo "Possible file upload attack: ";
  echo "filename '". $_FILES['userfile']['tmp_name'] . "'.";
  print_r($_FILES);
}
?> 
```

我之前没有使用过 PHP，但是我现在可以连接，但在响应中出现以下错误：

**server.php 文件中未定义的索引**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:18:39.677

您需要发布**数据**，但您还需要编写一个脚本（可能是 php，因为您使用的是 XAMPP）来接受发布数据并将其保存到该位置。

编辑：

我建议编写一个表单来与您的 php 脚本进行交互，以测试问题是否与您的服务器接受文件有关。

```
<form enctype="multipart/form-data" action="http://localhost/android/server.php"; method="POST">
<input type="hidden" name="MAX_FILE_SIZE" value="100000" /> 
Choose a file to upload: <input name="uploadedfile" type="file" /><br /> 
<input type="submit" value="Upload File" /> 
</form> 
```

制作该页面以测试从您的计算机上传文件。也可以在您的 AVDs 浏览器中尝试。

我认为您的问题是您使用的是本地主机。您可能需要使用您的服务器的公共 IP 地址。看看这个：[https ://stackoverflow.com/a/5224558/1629749](https://stackoverflow.com/a/5224558/1629749)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T16:01:17.220

我修改了我的 PHP 代码以使用[MultipartEntity](https://stackoverflow.com/questions/1067655/how-to-upload-a-file-using-java-httpclient-library-working-with-php-strange-pr)

模拟器在 PHP 更改后崩溃，但通过删除我的 AVD 并创建一个新的来解决这个问题。另外我重新启动了我的本地主机服务器

# jquery - 无法停止深度嵌套的 youtube 视频

> ID：14062959
> 
> 赞同：0
> 
> 时间：2012-12-28T00:07:24.953
> 
> 标签：jquery, iframe, youtube

当模式关闭时，我似乎无法让 YouTube 视频停止播放。视频消失，但音频继续播放。

我已经尝试了许多其他问题的解决方案，但似乎没有任何效果。我认为这可能是因为我的视频嵌套很深，我无法定位它。和/或因为 iframe 具有相同名称的元素 ID。（不要让我开始。）

下面是对 DOM 的简化视图：

```
html
  head
  body
    <div id="popoverview">
      <div id="popoveritem">
        <iframe id="popoverframe">   <!-- this is our modal -->
          #document
            html
              head
              body
                <div id="popovercontainer">
                  <div id="popover_upc_video">
                    <div id="current_video">
                      <div id="player">
                        <iframe id="popoverframe">
                          #document  <!-- this is from youtube -->
                            html
                              head
                              body
                                <div id="player">
                                  <div id="playercontainer">
                                    <embed id="video-player-flash">  <!-- the video --> 
```

这是将 youtube 视频（包括 ?enablejsapi=1）插入模态的 javascript 中的一些内容：

```
document.getElementById('player').innerHTML = '<iframe id="youtubevideo" width="620" height="376" src="http://www.youtube.com/embed/'+youtube_id+'?enablejsapi=1?hl=en&rel=0&fs=1&modestbranding=1" frameborder="0" allowfullscreen>Error?</iframe>'; 
```

这是关闭模式的功能。问题是音频一直在播放。错误消息是 Uncaught TypeError: Object [object Object] has no method 'stopVideo'。

```
var myPlayer = $('#player > #video-player-flash');
myPlayer.stopVideo(); 
```

我已经尝试了很多定位方法，但没有任何效果。

谢谢您的帮助。查理马吉

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-28T00:12:30.960

您将 jQuery 对象设置为 myPlayer 而不是 DOM 节点。

```
var myPlayer = $('#player > #video-player-flash')[0];
myPlayer.stopVideo(); 
```

请参阅这篇文章：[如何在 Youtube 中停止使用 Javascript 的视频？](https://stackoverflow.com/questions/1094397/how-can-i-stop-a-video-with-javascript-in-youtube)

# javascript - 用javascript计算数组形式的总和

> ID：14062970
> 
> 赞同：2
> 
> 时间：2012-12-28T00:09:28.450
> 
> 标签：javascript, jquery, html, calculator, dynamic-forms

我想以数组形式显示值的个数。我有很多表格，只有一个名称是“价格 []”，并且表格上有每个值。我想计算“价格 []”表格的总值。我仍然是 javascript 的初学者。我想用javascript来计算它。我所做的以下编码。

```
<html>
    <body>
        <form id="hitung" name="hitung">
            price 1 <input type="text" name="price[]" class="price" value="1000"/><br>
            price 2 <input type="text" name="price[]" class="price" value="3000"/><br>
            price 3 <input type="text" name="price[]" class="price" value="2000"/><br>
            price 4 <input type="text" name="price[]" class="price" value="1000"/><br>
            price 5 <input type="text" name="price[]" class="price" value="3000"/><br><br>
            total <input type="text" name="total" class="total"/>
        </form>
    </body>
</html> 
```

还有我想再问一下，如果外面有新的输入，那么总也直接改了。怎么做。请帮帮我。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:27:44.220

这是一个例子：http: [//jsfiddle.net/c4UyA/1/](http://jsfiddle.net/c4UyA/1/)

```
var sum = 0;
$("form > input[name='price[]']").each(function() {
    $this = $(this);
    sum += parseInt($this.attr("value"));
});
$("form > input[name='total']").attr("value", sum); 
```

# iphone - 为什么我可以从 NSUserDefaults 返回 NSMutableArray 而不是 NSMutableDictionary

> ID：14062971
> 
> 赞同：0
> 
> 时间：2012-12-28T00:09:29.450
> 
> 标签：iphone, ios, ipad, nsmutablearray, nsuserdefaults

我在 iOS 6 的 NSUserDefaults 中保存了几个项目。过去我一直使用包含 NSMutableDictionaries 的 NSMutableArray 来保存一些信息。但是现在我决定使用包含 NSMutableDictionaries 的 NSMutableDictionary 会更有效。我希望能够从主 NSMutableDictionary 中删除字典并修改存储在子字典中的值。

我一直将我的主要 NSMutableArray 存储为：

```
-(NSMutableArray *)listArray
{
    return [[NSUserDefaults standardUserDefaults] mutableArrayValueForKey:@"list_array"];
}

-(void) setDeviceListArray:(NSMutableArray *)listArray
{

    [[NSUserDefaults standardUserDefaults] setObject:listArray forKey:@"list_array"];
} 
```

我会对 NSMutableDictionary 做同样的事情，但不存在像“mutableDictionaryValueForKey”这样的 getter 函数。谁能告诉我这是为什么？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:18:31.397

只是因为：D

像这样复制字典

```
NSMutableDictionary *d = [[NSUserDefaults standardUserDefaults] dictionaryForKey:@"bla"].mutableCopy; 
```

# python-2.7 - Tkinter 小部件未出现

> ID：14062978
> 
> 赞同：0
> 
> 时间：2012-12-28T00:10:24.453
> 
> 标签：python-2.7, widget, tkinter

我正在测试我正在编写的应用程序，但我只是得到一个空白窗口并且没有小部件。

```
from Tkinter import*
class App(Frame):

def _init_(self, master):

    frame = Frame(master)
    frane.pack()

    self.instruction = Label(frame, text = 'Password:')
    self.instruction.pack()

    self.button = Button(frame, text = 'Enter', command = self.reveal)
    self.button.pack()

root = Tk()
root.title('Password')
root.geometry('350x250')
App(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:39:54.967

你有几个错别字。第一个是在构造方法的名称中：

```
def _init_(self, master): 
```

应该读：

```
def __init__(self, master): 
```

请注意双下划线 - 请参阅[Python 对象的文档](http://docs.python.org/2/reference/datamodel.html?highlight=class%20__init__#object.__init__)。

第二个在您的构造函数中：

```
frane.pack() 
```

您还缺少 App 类中名为“reveal”的方法的声明：

```
self.button = Button(frame, text="Enter", command=self.reveal) 
```

工作示例如下：

```
from Tkinter import *

class App(Frame):

    def __init__(self, master):
        Frame.__init__(self, master)
        self.pack()

        frame = Frame()
        frame.pack()

        self.instruction = Label(frame, text="Password:")
        self.instruction.pack()

        self.button = Button(frame, text="Enter", command=self.reveal)
        self.button.pack()

    def reveal(self):
        # Do something.
        pass

root = Tk()
root.title("Password")
root.geometry("350x250")
App(root)
root.mainloop() 
```

另请参阅：[Tkinter 文档](http://docs.python.org/2/library/tkinter.html#a-simple-hello-world-program)。

# image-processing - 在 Xbox Kinect 和 Kinect for Windows SDK 上使用面部识别的增强现实面具

> ID：14062979
> 
> 赞同：0
> 
> 时间：2012-12-28T00:10:58.557
> 
> 标签：image-processing, kinect, face-recognition, 3ds

我正在使用带有 Kinect for Windows SDK 的 Xbox Kinect。我想制作一个应用程序，将 3D 蒙版（在 3DS Max 中制作的蒙版的 3D 模型）增强到使用该应用程序的任何人的脸上。该应用程序将在本地展览中使用。我没有尝试太多，因为我不知道从哪里开始。所以我想知道的是，目前是否可以使用最新的 Kinect for Windows SDK 中的面部识别和骨骼跟踪功能将 3DS Max 模型增强到实时视频流中，如果可以，我应该如何/从哪里开始尝试做/实施这个？朝着正确方向的任何一点都会很棒。谢谢！PS 是的，我已经阅读了 UI 指南和面部文档。我的问题是不知道从哪里开始编程，而不是不了解基本概念。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T13:47:43.133

如果您认真考虑为 Kinect 进行开发，我建议您购买这本书： [http ://www.amazon.com/Programming-Kinect-Windows-Software-Development/dp/0735666814](https://rads.stackoverflow.com/amzn/click/com/0735666814)

这需要从头开始使用 Kinect for Windows SDK 进行开发。有一个面部跟踪和一个增强现实示例，所以我很确定您将能够很容易地实现您的目标。

书中的所有代码都在这里：http: [//kinecttoolbox.codeplex.com/](http://kinecttoolbox.codeplex.com/)

* * *

或者，这里有一个几乎是您想要实现的示例：http: [//www.codeproject.com/Articles/213034/Kinect-Getting-Started-Become-The-Incredible-Hulk](http://www.codeproject.com/Articles/213034/Kinect-Getting-Started-Become-The-Incredible-Hulk)

它是使用 SDK 的 Beta 版本开发的，但适用相同的原则。

* * *

您还可以在此处查看快速入门视频：

[http://channel9.msdn.com/Series/KinectQuickstart](http://channel9.msdn.com/Series/KinectQuickstart)

* * *

总之，根据我自己的经验，我会花一些时间阅读视频或书中的初学者示例（我觉得这本书非常好），只是为了熟悉如何设置一个简单的 Kinect 项目以及不同的SDK 的部分工作。

当您使用 Kinect 开发了一些一次性应用程序时，我会尝试处理您的项目（尽管上面的 Incredible Hulk 项目应该让您获得最大的成功！）

祝你的项目好运

# windows-phone-7 - 通过单击模拟器按钮显示 PageOrientation.LandscapeRight 的差异图像

> ID：14062987
> 
> 赞同：0
> 
> 时间：2012-12-28T00:12:07.870
> 
> 标签：windows-phone-7

该页面以“Partrait”开头，我有代码来捕捉方向变化以调整用户控件。我不知道为什么通过更改按模拟器上的按钮来旋转屏幕的顺序来显示相同​​代码的差异。以下是我捕获方向更改事件的代码。

```
 if (previousOrientation == PageOrientation.PortraitUp && e.Orientation == PageOrientation.LandscapeLeft)
        {
            this.LayoutRoot.Width = 730;
            lst.lst.Height = 220;
            lst.lst.Width = 730;
            this.LayoutRoot.Margin = new Thickness(0, 0, 0, 0);
            this.TitlePanel.Margin = new Thickness(0, 0, 65, 0);

        }
        if (e.Orientation.ToString().Contains("Portrait"))
        {
            this.LayoutRoot.Width = 480;
            this.LayoutRoot.Margin = new Thickness(0, 0, 0, 0);
            lst.lst.Height = 400;
            lst.lst.Width = 450;
            this.TitlePanel.Margin = new Thickness(12, 0, 40, 0);
            this.TitlePanel.Margin = new Thickness(12, 17, 2, 0);

        } 
```

当我在模拟器上的第一个按钮上第二次按下旋转屏幕时， ( `previousOrientation == PageOrientation.PortraitUp && e.Orientation == PageOrientation.LandscapeRight`) 被触发。它显示大应用程序栏的背景黄色。

如果我第一次按下模拟器上的第二个按钮以旋转屏幕，`previousOrientation == PageOrientation.PortraitUp && e.Orientation == PageOrientation.LandscapeRight`则会触发同一行“( )”。它显示了我想要的狭窄应用程序栏的背景黄色。

由于我是新用户，无法上传图片。如果您对我的问题感兴趣，我可以将图像发送给您。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T16:53:48.030

我搜索了论坛@以下网站。看来这是错误。

[旋转后应用程序栏调整大小](http://social.msdn.microsoft.com/forums/en-us/wpdevelop/thread/1145e5be-2d4c-4517-9948-5ce88cb15ed8)

# php - 蓬勃发展的 PHP 库 - 密码学安全

> ID：14062988
> 
> 赞同：0
> 
> 时间：2012-12-28T00:12:11.743
> 
> 标签：php, flourishlib

我正在考虑切换到[Flourish](http://flourishlib.com)，但我担心它目前的发展状态。它处于测试阶段，但他们说它“通常可以被认为是生产就绪”。我正在查看文档，不确定框架的[密码学](http://flourishlib.com/docs/fCryptography)部分是否足够安全以供日常使用。

有没有人使用过 Flourish，特别是密码学 API，并且可以选择它的可行性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:26:23.910

哦，是的，它非常安全。非常好的图书馆。相信我！

# ios - 如何循环动画几次或几秒钟？

> ID：14062989
> 
> 赞同：1
> 
> 时间：2012-12-28T00:12:11.513
> 
> 标签：ios, animation, loops, time

我发现了一些相关的问题，例如[this](https://stackoverflow.com/questions/5034327/moving-an-object-randomly-around-the-screen)，但在这里我仍然需要一点帮助。我想要的是一个按钮，一旦点击，就会以以下两种方式随机飞行： 1，它飞过五个随机位置并飞回原来的位置。或者2，它随机飞行2秒，然后回到原来的位置。

这是我的代码，但仍然缺少停止控件：

```
 //if the button clicked
    [self animationLoop:@"Wrong!" finished:1 context:nil];
    -(void)animationLoop:(NSString *)animationID finished:(int)finished context:(void *)context {
   [UIView beginAnimations:nil context:nil];
   [UIView setAnimationDuration:1];
   [UIView setAnimationRepeatCount:finished];

   CGFloat x = (CGFloat) (arc4random() % (int) self.view.bounds.size.width);
   CGFloat y = (CGFloat) (arc4random() % (int) self.view.bounds.size.height);
   CGPoint squarePostion = CGPointMake(x, y);
   theWrongButton.center = squarePostion;

   [UIView setAnimationDelegate:self];
   [UIView setAnimationDidStopSelector:@selector(animationLoop:finished:context:)];

  [UIView commitAnimations];
  } 
```

我想我的问题有点像如何循环动画几次或几秒钟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:21:16.583

您要问的正是 context 参数的用途。它使您可以传入以后可以使用的任何对象。例如，您可能正在寻找像这样的一些：

```
 [self animationLoop:@"Wrong!" finished:1 context:[NSNumber numberWithInt:0]];
-(void)animationLoop:(NSString *)animationID finished:(int)finished context:(void *)context {

    NSNumber *count = (NSNumber *)context;
    if ([count intValue]) >= 5) {
        return;
    }
    [UIView beginAnimations:nil context:[NSNumber numberWithInt:[count intValue]+1]];
    [UIView setAnimationDuration:1];
    [UIView setAnimationRepeatCount:finished];

    CGFloat x = (CGFloat) (arc4random() % (int) self.view.bounds.size.width);
    CGFloat y = (CGFloat) (arc4random() % (int) self.view.bounds.size.height);
    CGPoint squarePostion = CGPointMake(x, y);
    theWrongButton.center = squarePostion;

    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector:@selector(animationLoop:finished:context:)];

   [UIView commitAnimations];
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:21:53.497

试试这个

```
 [UIView animateWithDuration:<#(NSTimeInterval)#> 
                     animations:<#^(void)animations#> 
                     completion:<#^(BOOL finished)completion#>]; 
```

这个动画命令带有一个完成块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:49:04.047

我终于用了这个：

```
 //in the animation loop
       if (animationLoopCounter > 3) {
        return;
        }

   [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:)];

   - (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag {
   animationLoopCounter++;
   [self animationLoop:@"Wrong!" finished:1 context:nil];
   } 
```

# css - 在 html 标头标签内居中 div 元素

> ID：14062991
> 
> 赞同：2
> 
> 时间：2012-12-28T00:12:28.017
> 
> 标签：css, html, centering

我试图将我的 div 元素与类名居中`toolbar`，并且我尝试在 div 元素和标题标签上使用该`inline-block`属性，但没有成功。`text-align: center`

这是html

```
<header>
   <div class="toolbar">
   </div>
<header> 
```

和相应的css样式

```
 header{
    width: 100%;
    height: 51px !important;
    position: fixed;
    background-color: white;
    margin: 0 auto;
    box-shadow: 0 1px 3px rgba(0,0,0,0.25);
    -moz-box-shadow: 0 1px 3px rgba(0,0,0,0.25);
    -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.25);
    z-index:100;
    top: 0;
    text-align: center;
}

.toolbar {
    background: #fff;
    position: fixed;
    z-index: 1000;
    top: 0;
    width: 910px;
    margin: 0 auto;
    padding: 10px 25px;
    display: inline-block;
} 
```

没有运气使内部 div 元素居中，使用当前设置将其一直向右移动，如果我删除 div 上的显示，它会将其带到左侧

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T00:44:50.273

删除`position: fixed`，`top: 0`因为它不需要....

并`display:block`从**.toolbar**类更改为。

这是一个快速示例：

[http://jsfiddle.net/Riskbreaker/QePqL/](http://jsfiddle.net/Riskbreaker/QePqL/)

如果您不想删除，`position: fixed`则：

[http://jsfiddle.net/QePqL/1/](http://jsfiddle.net/QePqL/1/)

# javascript - input type=image - onclick(), 会触发它的事件，但是在 jquery 中的函数作用不好

> ID：14062993
> 
> 赞同：3
> 
> 时间：2012-12-28T00:12:43.140
> 
> 标签：javascript, jquery, asp.net, html

（我认为这可能是两个帖子 - 2个问题..所以如果您对此发表评论......我会将它们分开）

主要问题是：

**如何为按钮设置图像背景...简单且正确？**

我认为现在我可以确定以下事实：

因为我在将图像设置为按钮背景时遇到了一个“小”问题，......我想，好吧，如果很难`<input type='button'>`用图像背景设置，为什么不***改为***，只需`onclick`在 a 上设置事件`<input type='image'>`！

我是对的（......几乎），因为是的，在 `image`类型上设置点击事件很容易，而且，设置`src`..而不是`background-image`按钮......至少对我来说是这样。

问题是，在当前项目中），使用 jQuery-UI `dialog - ok, cancel`，

似乎问题在于图像类型，回帖（？！），所以对话框消失了

并且按钮不会导致这个缺陷。

我尝试在vs2010中使用断点对其进行调试，并且单击事件都可以，因为它们都到达了“函数入口”的位置……所以对于图像类型……我只能注释为我可以看到`<- Back button`, 切换`disabled`为可点击，所以这意味着它确实回发了。

并且按钮不会发生这种情况，因为您将鼠标悬停在按钮上没有任何事情发生，并且使用图像您可以在状态栏中看到一个链接。

所以按钮-“转换”为图像之间存在**差异**（真实的），而不是图像变成“按钮”（附加`Click()`事件），

所以我想知道的是：（只有这次我被允许**将**这篇文章用于两个答案，因为它们确实相关）

**为什么图像回传？**我可以禁用此操作吗？...它不是服务器控件。这是你应该知道的事情，并且***假设***会发生吗？

再次，如果它是题外话，我会移动这个问题，我确实需要一种正确的方法来设置按钮的背景图像，除非它的行为有解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:39:49.257

我不确定为什么图像类型输入元素的行为与按钮类型不同，但如果我是你，我会一起避免。如果您正在寻找自定义按钮（看起来就是），我建议您使用 div 并通过 jquery/javascript 控制用户交互。

演示：http: [//jsfiddle.net/jrb9249/BvTD5/](http://jsfiddle.net/jrb9249/BvTD5/)

HTML：

```
<body>
    <div class="div_button">
        <p>Click Me!</p>
    </div>
</body> 
```

Javascript：

```
$('.div_button').click(function(){
    alert('Run a postback via JS');
}); 
```

CSS：

```
.div_button
{
    border: solid 1px gray;
    width:80px;
    height:25px;
    background:#A3A3A3;
    text-align:center;
    margin:0 auto;
    margin-top:50px;
}

.div_button:hover
{
    border: solid 1px blue;
    background:#A1A1A1;
    cursor:pointer;
} 
```

[要添加一些收尾工作以完成按钮外观，只需使用此处](http://jquery.malsup.com/corner/)找到的 jquery 圆角插件添加一些圆角。如果您需要使用此控件进行回发（它看起来不像 asp.net 控件，所以我认为这不是您正在做的事情），您可以使用[此处](https://stackoverflow.com/questions/1305954/asp-net-postback-with-javascript)描述的 __Postback 技术。

我希望这会有所帮助，祝你的网站好运。

* * *

**更新：** 自从这篇文章以来，我已经开始将我的 div 标签包含在一个`<a>`标签中，以在 div 之外创建一个超链接。然后，您可以将自定义单击事件应用于`<a>`元素，并对您创建的按钮进行更好的控制。

# xml-serialization - 从对象生成 XML 文档时出错

> ID：14062994
> 
> 赞同：0
> 
> 时间：2012-12-28T00:12:52.900
> 
> 标签：xml-serialization

我希望序列化一个复杂的对象以从 Web 服务请求返回。这是我的假设。在返回到调用客户端之前，我需要在 XML 文档（而不是字符串）中有序列化（放气）对象。我“相信”我反序列化很好，只需将其加载到 XMLDocument 中即可。但是我可能错了，反序列化可能是错误的，因此 XmlDocument 爆炸了。这是代码：

我的复杂对象：

```
namespace ABCTest
{
    [XmlRoot("TapRoot")]
    public class UserDetails
    {
        [XmlElement]
        public String AccountName { get; set; }
    }
} 
```

我的序列化代码：

```
FYi: UsrDtls == List<UserDetails>

XmlSerializer Obj2XML = new XmlSerializer(UsrDtls.GetType());
Stream strWriter = Stream.Null;
XmlWriter XWriter = new XmlTextWriter(strWriter, Encoding.Unicode);
XmlDocument XDoc = new XmlDocument();

Obj2XML.Serialize(XWriter, lst_Exercises);
string abc = Obj2XML.ToString(); //debugging line to attempt to browse the obj2xml object
XDoc.LoadXml(abc);

return XDoc; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:30:24.740

我不知道您从哪里了解到 .NET 中的 Web 服务。只需返回对象。Web 服务基础架构将处理它。

您没有说您使用的是 WCF 服务还是旧版 ASMX 服务。ASMX 服务不应该用于新的开发。

如果您在“退货”时仍然遇到问题，请发布您收到的任何异常的详细信息。

# html - html4 中等效的范围样式

> ID：14062997
> 
> 赞同：0
> 
> 时间：2012-12-28T00:13:14.257
> 
> 标签：html, css

我有一段 HTML 需要修改，并且我需要保持最小的更改（在 CSS 之外）。我需要做的就是隐藏一个表格单元格，直到发生某些事情。所以我继续添加样式标签，如下所示：

```
<td style="display:none;"> 
```

但是，这会导致样式类重置，例如，以前垂直居中对齐的单元格现在是上对齐的，依此类推。我的理解是，这是因为样式属性覆盖了默认的 CSS 内容。那是对的吗？如果是，我该如何预防？我只需要添加显示属性，而不是重置其余的样式属性。

我花了一些时间在网上搜索，发现 HTML5 引入了一种叫做 scoped style 的东西。是否有一个 HTML4 易于实现的等价物？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:18:30.887

这可能是因为`display:none`从 DOM 显示计算中删除了节点。您的表格中不再有该单元格的占位符。您可以尝试`visibility:hidden`，这将使 DOM 元素在文档呈现中保持其位置，但只是不可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:18:01.097

尝试`visibility:hidden;`代替`display:none;`

让我知道这是否有用。

# javascript - 为什么重命名 HTML 元素会删除其事件？

> ID：14062998
> 
> 赞同：0
> 
> 时间：2012-12-28T00:13:15.067
> 
> 标签：javascript, jquery, javascript-events

我注意到，当我通过 javascript 更改表单元素的 ID 或名称时，与其关联的 jquery 事件不再存在。我已经在 Firefox 17 和 IE 10 上试过了。这是设计使然吗？如果是这样，有什么办法可以防止它？

**更新：**例如，请查看[http://jsfiddle.net/qHH7P/2/](http://jsfiddle.net/qHH7P/2/)。

我正在添加按钮以通过 jquery 删除行。当我删除第一行时，我给第二行中的元素一个新的名称和 ID。然后该剩余行的删除按钮不再触发该事件。我需要重命名元素，因为 ASP.NET MVC 需要在绑定时为对象集合使用特定的命名约定。这就是为什么我需要用“0”而不是“1”重命名它们。我正在重命名

```
var regexpattern = new RegExp("WorkspaceQuestionSets\\[.+\\]", "g");
$(this).html($(this).html().replace(regexpattern, "WorkspaceQuestionSets[" + index + "]"));
var regexpattern = new RegExp("WorkspaceQuestionSets_.+__", "g");
$(this).html($(this).html().replace(regexpattern, "WorkspaceQuestionSets_" + index + "__")); 
```

我刚刚意识到我什至没有重命名按钮。因此，事件消失的意义就更小了。但是，如果我注释掉重命名元素的代码，事件仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T11:33:01.113

您正在重写 HTML。`.html()`返回一个**string**，然后您对其进行修改并再次设置。浏览器将解析该 HTML 字符串并从中创建新的 DOM 元素。在这个过程中，您破坏了 DOM 元素，从而失去了之前绑定到它们的事件处理程序。

> 我刚刚意识到我什至没有重命名按钮。因此，事件消失的意义就更小了。

`this`无论您是否修改了它的 HTML 表示，您都在销毁和重新创建内部的每个元素（我假设的每一行）。

* * *

你必须解决这个问题：

1.  使用事件委托：不是将事件处理程序直接绑定到元素，而是将它们绑定到始终存在的祖先。[`.on`在* ^([docs])](http://api.jquery.com/on/)文档的*Direct and delegated events*部分阅读有关事件委托的更多信息。

2.  不要重写 HTML。`name`选择要修改其属性的元素并对其进行修改。例如：

    ```
    var name_exp1 = /WorkspaceQuestionSets\[.+\]/g;
    var name_exp2 = /WorkspaceQuestionSets_.+__/g;

    sourceEle.closest(".table").find(".row.set").each(function(index) {
        // Edit the name attribute of all `select` and `input` elements
        $(this).find('select, input').prop('name', function(i, name) {
            if (name_exp1.test(name)) {
                return name.replace(
                    name_exp1, 
                    "WorkspaceQuestionSets[" + index + "]"
                );
            }
            else if (name_exp2.test(name)) {
                return name.replace(
                    name_exp1, 
                    "WorkspaceQuestionSets_" + index + "__"
                );
            }
            return name;
        });
    }); 
    ```

在 JavaScript 中，忘记 HTML 并使用 DOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:21:45.507

Chrome 24 中的纯 JavaScript 不会发生这种情况。

这是我在 JS 控制台中输入的内容：

```
document.write("<button id='bb'/>")
//undefined
var bb=document.getElementById('bb')
//undefined
bb
//<button id=​"bb">​&lt;/button>​
bb.addEventListener('click',function(){alert('hi');});
//undefined
bb
//<button id=​"bb">​&lt;/button>​
bb.id
//"bb"
bb.id="qq"
//"qq"
bb
//<button id=​"qq">​&lt;/button>​
document.getElementById("bb")
//null
document.getElementById("qq")
//<button id=​"qq">​&lt;/button>​ 
```

重要的是，单击按钮会在分配给`bb.id`.

同样在 Firefox 17 中，我并没有完全看到纯 JavaScript 会发生这种情况。我在页面上：[http ://start.ubuntu.com/12.04/Google/?sourceid=hp](http://start.ubuntu.com/12.04/Google/?sourceid=hp)

在控制台中，这是我发布的内容：

```
[19:29:41.261] var bb=document.getElementById('sbtn')
[19:29:41.267] undefined
[19:29:45.501] bb.addEventListener('click',function(){alert('hi')});
[19:29:45.507] undefined
[19:29:48.292] bb.id
[19:29:48.298] "sbtn"
[19:29:59.613] bb.id="sbttttttn"
[19:29:59.619] "sbttttttn" 
```

更改后警报仍然发生`id`。

这必须特定于我无法尝试的 IE，或者 jQuery 设置事件或处理 ID 更改的方式（可能是无形地破坏对象？）。

# javascript - 用钢笔工具在画布上平滑地画一条线，而不必重画所有其他线

> ID：14062999
> 
> 赞同：7
> 
> 时间：2012-12-28T00:13:32.707
> 
> 标签：javascript, html, html5-canvas

有没有办法避免重绘画布上的所有元素（所以我不必跟踪所有内容），同时仍然对当前绘制的线条有流畅的绘图体验？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T00:31:18.930

这**是**一个很好的问题，但措辞含糊。以后的措辞问题请多加注意。

通常在绘制平滑线时，您需要从头开始重新绘制*线*。

不过，您不需要从头开始重新绘制*所有内容*，因为您应该遵循以下操作：

1.  将当前画布保存到内存中的画布
2.  开始画一条新线
3.  当你画画时，你不断地：
    *   清理画布
    *   从内存画布绘制到主画布上
    *   画线 - 到目前为止
4.  当行结束时，将新画布保存到内存画布并重复此过程

您需要跟踪的唯一行（就点而言）是“当前”行。所有旧行都通过内存画布保存到位图中。

这是我很久以前做的一个例子，专门处理平滑线。代码组织很奇怪，因为我从别人的代码开始，但它应该给你基本的想法：

[http://jsfiddle.net/NWBV4/10/](http://jsfiddle.net/NWBV4/10/)

上面描述的绘图部分在mousemove中可以看到：

```
this.mousemove = function(ev) {
    if (tool.started) {
        context.clearRect(0, 0, 300, 300);
        // put back the saved content
        context.drawImage(memCanvas, 0, 0);
        tool.points.push({
            x: ev._x,
            y: ev._y
        });
        drawPoints(context, tool.points);
    }
}; 
```