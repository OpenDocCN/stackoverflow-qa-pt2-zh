# StackOverflow 问答 15233000-15233999

# postgresql - 在结果集 PostgreSQL 中创建自动增量列

> ID：15233004
> 
> 赞同：6
> 
> 时间：2013-03-05T20:00:32.177
> 
> 标签：postgresql

`path`此查询的结果仅在 order from是preserver时才有意义。但是，在我的左内连接时，结果被打乱了。我在想我可以在结果集中创建一个新列，就像结果的索引一样，然后作为整个 sql 的最后一个子句添加一个`ORDER BY idx`.

这是我的查询，但未尝试保留最终订单：

```
SELECT path.*, network_link.v0prt
    FROM (SELECT *                              // Need order preserved from this one
        FROM shortest_path_shooting_star(
        'SELECT gid as id, source::integer,
        target::integer, distance::double precision as cost,
        x1, y1, x2, y2, rule, to_cost FROM
            network_link as net ORDER BY net.gid', 9, 1, false, false)) as path
    LEFT OUTER JOIN 
    (SELECT DISTINCT gid, v0prt FROM network_link) as network_link 
    ON (network_link.gid=path.edge_id); 
```

任何见解都会很棒。

谢谢。我尝试添加索引值和 ORDER BY （不起作用）。

```
SELECT path.*, network_link.v0prt
    FROM (SELECT incr(0) as idx, * 
        FROM shortest_path_shooting_star(
        'SELECT gid as id, source::integer,
        target::integer, distance::double precision as cost,
        x1, y1, x2, y2, rule, to_cost FROM
            network_link as net ORDER BY net.gid', 9, 1, false, false)) as path
    LEFT OUTER JOIN 
    (SELECT DISTINCT gid, v0prt FROM network_link) as network_link 
    ON (network_link.gid=path.edge_id)
ORDER BY idx; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T22:05:29.127

要保留返回的订单`shortest_path_shooting_star`（如果没有其他方法），您可以使用窗口函数`row_number`来跟踪原始订单`ORDER BY`及其结果：

```
SELECT path.*, network_link.v0prt
    FROM (SELECT row_number() OVER() AS row_number, *
        FROM shortest_path_shooting_star(
        'SELECT gid as id, source::integer,
        target::integer, distance::double precision as cost,
        x1, y1, x2, y2, rule, to_cost FROM
            network_link as net ORDER BY net.gid', 9, 1, false, false)) as path
    LEFT OUTER JOIN 
    (SELECT DISTINCT gid, v0prt FROM network_link) as network_link 
    ON (network_link.gid=path.edge_id)
ORDER BY path.row_number; 
```

**更新：**

从 PostgreSQL 版本 9.4 和更高版本开始，更好的方法是使用[`WITH ORDINALITY`](http://www.postgresql.org/docs/current/static/queries-table-expressions.html#QUERIES-TABLEFUNCTIONS)：

```
SELECT path.*, network_link.v0prt
FROM shortest_path_shooting_star(
        'SELECT gid as id, source::integer,
        target::integer, distance::double precision as cost,
        x1, y1, x2, y2, rule, to_cost FROM
            network_link as net ORDER BY net.gid', 9, 1, false, false)
) WITH ORDINALITY AS path
LEFT OUTER JOIN 
    (SELECT DISTINCT gid, v0prt FROM network_link) as network_link 
    ON (network_link.gid=path.edge_id)
ORDER BY path.ordinality; 
```

# python - 在文件中写入列

> ID：15233010
> 
> 赞同：0
> 
> 时间：2013-03-05T20:00:52.010
> 
> 标签：python, mysql

我试图将 SQL 中的行写入文本文件。

我的代码：

```
result = 'C:/Users/Desktop/SWN_all_result.txt'
result_file = open(result, 'w')
sql_select2 = "select * from test01"
c.execute(sql_select2)
rows2 = c.fetchall()
for detail2 in rows2:
    Sentence = detail2[1]
    SWN_Note = detail2[4]
    print Sentence, '\t', SWN_Note, '\n'
    result_file.write(Sentence + '\t' + SWN_Note + '\n')
result_file.close()
db.close() 
```

结果表明：

```
abc
    neutral 

cdf
    positive 
```

我怎样才能使它们与我在代码中提到的相同？

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:04:26.860

您的数据中似乎必须有换行符。在打印和写入文件之前剥离它们：

```
Sentence = detail2[1].rstrip('\n') 
```

# forms - PHP，带有表单元素的电子邮件附件不起作用

> ID：15233013
> 
> 赞同：0
> 
> 时间：2013-03-05T20:01:03.540
> 
> 标签：forms, php

我知道这已经被覆盖了 100 次，但我似乎仍然无法找到正确的方法来让它发挥作用。有时此代码会起作用并发送带有附件的电子邮件，有时附件会通过，有时根本不会发送。我试过 PHPMailer() 并且当我附加一些身体不会发送的东西时，附件也不会通过。尝试过 swiftmailer，附件无法正常工作。也许是我的服务器 IPage？不确定我是否需要更改 php.ini 文件中的某些内容。但这是我所拥有的，也许我错过了什么

```
 if($category == 'music' || $category == 'sports'){
  $to[1] = 'post@tweetymail.com';
  $to[2] = '1234567890@tumblr.com';
  $to[3] = 'website.1234567890@blogger.com';
}

  $soc_post = substr($post,0,139);

  $subject[1] = $title;
  $subject[2] = 'Website - ' . $title;
  $subject[3] = 'Site - ' . $title;

       $message[1] = '';
  $message[2] = $url_field . ' ' . str_replace("rnrn"," ",$soc_post);
  $message[3] = '<a href="'.$url_field.'">'.$new_url. '</a> ' . str_replace("rnrn"," ",$soc_post);

for($i=1; $i<=3; $i++){

    $fileatt = $_FILES['blog_pic']['tmp_name'];
    $fileatt_type = $$_FILES['blog_pic']['type'];
    $fileatt_name = $_FILES['blog_pic']['name'];

         $email_message = $message[$i];
         $headers = "From: Website Blog <blog@website.com>";

         $file=fopen($fileatt,'rb');
         $data=fread($file,filesize($fileatt));
         fclose($file);

         $semi_rand=md5(time());
         $mime_boundary ="==Multipart_Boundary_x{$semi_rand}x";

         $headers .= "\nMIME-Version: 1.0\n" .
         "Content-Type: multipart/mixed;\n" .
         " boundary=\"{$mime_boundary}\"";

         $email_message="This is a multi-part message in MIME format.\n\n" .
              "--{$mime_boundary}\n" .
              "Content-Type:text/html; chartset=\"iso-8859-1\"\n" .
              "Content-Transfer-Encoding: 7bit\n\n" .
        $email_message .= "\n\n";

        $data=chunk_split(base64_encode($data));

        $email_message .= "--{$mime_boundary}\n" .
        "Content-Type:{$fileatt_type};\n" .
        " name=\"{$fileatt_name }\"\n" .
                    //"Content-Disposition: attachment;\n" . 
                    //" filename=\"{$fileatt_name}\"\n" .
        "Content-Transfer-Encoding: base64\n\n" .
        $data .= "\n\n" .
        "--{$mime_boundary}--\n";   

    mail($to[$i], $subject[$i], $email_message, $headers); 
```

# iphone - 在 iOS 上获取视图的尺寸

> ID：15233019
> 
> 赞同：0
> 
> 时间：2013-03-05T20:01:24.790
> 
> 标签：iphone, ios, view, storyboard, width

我需要在适合大小的视图中初始化 UIPicker。它应该填充视图，并且该视图来自情节提要。

```
picker = [[UIPickerView alloc] initWithFrame:CGRectMake(0, 0, view.frame.size.width, view.frame.size.height)]; 
```

它仅适用于 iPhone Retina 4 英寸设备。对于其他分辨率，选择器大于视图并且未完整显示。

请问有谁知道问题出在哪里？我没有使用自动布局，只有故事板。

# c# - mvc4下拉列表插入NULL

> ID：15233025
> 
> 赞同：0
> 
> 时间：2013-03-05T20:01:46.160
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我在这里搜索了很多，找到了这样的东西来制作下拉列表
，这是我的模型：

```
public class Profits
    {
        [Key]
        public int Id { get; set; }
        public double Value { get; set; }
        public string Description{ get; set; }
       [DataType(DataType.Date)]
        public DateTime DateInput { get; set; }
        public UserProfile User { get; set; }
        public Categories CategoryName { get; set; }//foreign key
          public   int CategoryID { get; set; }
    }

 public class Categories
    {
        [Key]
        public int Id { get; set; }
        [Required]
        public string  Name { get; set; }
        public UserProfile User { get; set; }

    } 
```

这是我的控制器：这会将我的数据传递给 dropDownList...

```
public ActionResult Create()
{
    var dba = new WHFMDBContext();
    var query = dba.Categories.Select(c => new { c.Id, c.Name });
    ViewBag.Id = new SelectList(query.AsEnumerable(), "Id", "Name", 3);
    return View();
}

[HttpPost]
        [InitializeSimpleMembership]
        public ActionResult Create(Profits profits)
        {
            var user = db.UserProfiles.FirstOrDefault(x => x.UserId == WebSecurity.CurrentUserId);
            var profit = new Profits
            {
               Value= profits.Value,
               Description = profits.Description,
               DateInput =profits.DateInput,
               CategoryName =profits.CategoryName,// ???
                User = user,

            };
            db.Profits.Add(profit);
            db.SaveChanges();
            return RedirectToAction("Index");
        } 
```

我的观点 ：

```
@model WebHFM.Models.Profits

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Profits</legend>

    <div class="editor-field">
     @Html.LabelFor(model => model.CategoryName)
        </div>
    <div class="editor-field">
         @Html.DropDownList("Id", (SelectList) ViewBag.Id, "--Select One--") 
        @Html.ValidationMessageFor(model => model.CategoryName)
    </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Value)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Value)
            @Html.ValidationMessageFor(model => model.Value)
        </div>... 
```

这将数据插入数据库，但我错过了什么`CategoryName_Id`？这是利润中类别的外 `NULL`键`CategoryName = profits.CategoryName``public Categories CategoryName { get; set; }`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:34:30.200

修改您的利润等级，添加以下内容：

```
Profits
{
  int CategoryID {get;set;}
} 
```

修改你的cshtml。改变

```
@Html.DropDownList("Id", (SelectList) ViewBag.Id, "--Select One--") 
```

到

```
@Html.DropDownList("CategoryID", (SelectList) ViewBag.Id, "--Select One--") 
```

改变你的控制器：

```
public ActionResult Create(Profits profits)
        {
            var user = db.UserProfiles.FirstOrDefault(x => x.UserId == WebSecurity.CurrentUserId);
            var category = db.Categories.FirstOrDefault(o => o.CategoryId == profits.CategoryID);
            var profit = new Profits
            {
               Value= profits.Value,
               Description = profits.Description,
               DateInput =profits.DateInput,
               CategoryName = category,
               User = user
            };
            db.Profits.Add(profit);
            db.SaveChanges();
            return RedirectToAction("Index");
        } 
```

这将更改您的下拉列表以返回选定的 CategoryID。标记将如下所示：

```
<select name="CategoryID" /> 
```

在您的回发中，这将绑定到您的新 Profits.CategoryID。然后，您使用它进行数据库查询以获取选定的类别对象，然后将其分配给 Profits.CategoryName。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:09:58.103

您的 Create() 操作返回`return View();`而不将模型传递给视图方法参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:04:16.943

这是我不看你的模型的建议。PopulateCategoriesDropDownList 与您的创建操作位于同一控制器中

```
private void PopulateCategoriesDropDownList(object selectedCategories = null)
    {
        var categoriesQuery = from d in _dataSource.Categories
                         orderby d.Name
                         select d;
        ViewBag.CategoryId= new SelectList(categoriesQuery, "CategoryId", "Name", selectedCategories);
    } 
```

**然后你的行为是这样的。**

```
 [HttpGet]
    public ActionResult Create()
    {
      PopulateCategoriesDropDownList();
    return View();
   }

    [HttpPost]
    [InitializeSimpleMembership]
    public ActionResult Create(Profits profits)
    {
         var user = db.UserProfiles.FirstOrDefault(x => x.UserId ==       WebSecurity.CurrentUserId);
        var profit = new Profits
        {
           Value= profits.Value,
           Description = profits.Description,
           DateInput =profits.DateInput,
           CategoryName =profits.CategoryName,// ???
            User = user,

        };
        db.Profits.Add(profit);
        db.SaveChanges();
        PopulateCategoriesDropDownList(profit.CategoryId);
       return View(profit);
    } 
```

**在您看来：**

```
<div class="editor-label">
            @Html.LabelFor(model => model.CategoryId, "Pick Category")
    </div>
    <div class="editor-field">
        @Html.DropDownList("CategoryId", String.Empty)
        @Html.ValidationMessageFor(model => model.CategoryId)
    </div><br/> 
```

# mysql - 从多个类别中获取有限（但不同）数量的文章的最快查询是什么？

> ID：15233028
> 
> 赞同：0
> 
> 时间：2013-03-05T20:01:49.597
> 
> 标签：mysql, performance

对于新闻门户的主页（由 PHP 和 MySQL 提供支持），我需要获取一个类别的 9 篇文章、另一个类别的 9 篇文章和任何类别的 28 篇最新文章。哪种方法最快？

我发现一些解决方案可以处理在单个查询中从多个类别中获取指定数量的文章，但是它们都为每个类别返回相同数量的文章，这不适合我的问题。他们还使用 IF 语句，我觉得这不是最好的速度（？）

我应该只做3个查询吗？还是使用 UNION ALL 将其全部放在一个查询中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:05:56.223

`UNION`我认为您无法在（非或子选择）查询中实现您想要做的事情。

就多个查询与 UNION 或子选择而言，它取决于查询的速度。多个小查询可能会在查询/获取响应时产生重复的开销。在并发性和与其他查询的良好配合方面，更小的查询通常在与其他查询竞争方面对数据库更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:06:08.553

当您使用`union`or进行一次查询时`union all`，它会比三个单独的查询更快，因为您节省了通信开销。

还要考虑`union`代替`union all`，因为`union all`保留重复的行。

# python - Pygame GUI - 未加载

> ID：15233032
> 
> 赞同：0
> 
> 时间：2013-03-05T20:02:15.150
> 
> 标签：python, user-interface, tkinter, pygame

基本上我已经为我的游戏创建了一个 pygame 菜单，当我点击它们时它会加载所有其他 pygame 窗口，但是对于添加用户等某些方面，
我是在 Tkinter GUI 中创建的。当我单击将它们加载到我的 pygame 上时，它不会加载 Tkinter GUI，有谁知道我该如何解决这个问题，或者是否需要添加一些东西才能使其工作。

它好像要加载一些东西但没有加载，第一个名为“mathsvaders”的加载很好，因为它是一个 pygame 程序，但高分在 tkinter 中并且不加载：

```
...
pos = 1
while True:
    #events
    for e in pygame.event.get():
        if e.type == pygame.QUIT:
            pygame.quit()
            sys.exit()
        elif e.type == pygame.KEYDOWN:
            if e.key == pygame.K_DOWN:
               pos += 1
               if pos > 5:
                   pos = 1
            elif e.key == pygame.K_UP:
               pos -= 1
               if pos < 1:
                   pos = 5
            elif e.key == pygame.K_RETURN:
               if pos == 1:
                   import MathsvadersReal
            elif e.key == pygame.K_RETURN:
               if pos == 2:
                    import Highscore
            elif pos == 5:
                 pygame.quit()
                 sys.exit() 
```

表单代码如下：

```
import Tkinter import Databaseconnector

class simpleapp_tk(Tkinter.Tk):
    def __init__(self,parent):
        Tkinter.Tk.__init__(self,parent)
        self.parent = parent
        self.initialize()

    def initialize(self):
        def create_widgets(self):
            # create welcome label
            label1 = Tkinter.Label(self, text = "Hello world")
            label1.grid(row = 0, column = 2, columnspan = 4, sticky = 'E')

if __name__ == "__main__":
    app = simpleapp_tk(None)
    app.title('my application')
    app.geometry("250x200")
    app.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:08:50.570

当你`import`第二个模块时，你没有做这`if __name__ == "__main__":`部分。（这就是这个习惯用法的全部意义——提供在您是顶级脚本时运行的代码，而不是在您被`import`编辑时运行的代码。）因此，您永远不会创建 Tk 应用程序和主事件循环，这意味着没有 Tk 代码可以做任何事情，并且您的 GUI 永远不会显示出来。

但是在你尝试通过将代码移动到一个函数中并调用它来解决这个问题之前，你不能只`tkinter`从一个函数中调用主事件循环`pygame`，因为这样`pygame`循环将被阻塞，直到`tkinter`应用程序退出。

我认为您在这里的困惑是您将模块、脚本和进程以及一堆其他东西混合在一起，并将它们都称为“程序”。有关差异的入门知识，请参见下文。

如果你真的想这样做，有几种可能：

*   `pygame`只要您正确连接，就可以使用您想要的任何事件循环。这意味着您可以创建一个顶级`tkinter`应用程序并在其下运行`pygame`代码。
*   您可以保留现有`pygame`循环，并`tkinter`在另一个线程中运行循环。
*   [改为在其中一个GUI 工具包](http://pygame.org/wiki/gui)中重新编码你的`tkinter`东西。[`pygame`](http://pygame.org/wiki/gui)
*   如果您真的想将每个模块视为“运行程序”，正如您在描述中所说的那样，请实际这样做：使用[`subprocess`](http://docs.python.org/2/library/subprocess.html)以启动`sys.executable`另一个脚本作为其第一个参数。

* * *

相同的 Python 文件`highscore.py`可以作为脚本运行，也可以作为模块导入。这些在某些方面是相似的，在其他方面是不同的。

您可以将它作为脚本运行，例如，`python highscore.py`在您的 DOS/bash/whatever shell 中键入（或使用`subprocess.Popen(sys.executable, 'highscore.py')`其他程序中的类似内容）。这将启动一个新进程，运行 Python 解释器，该解释器从 执行代码`highscore.py`，然后退出。这不会影响任何其他进程，因为您的操作系统知道如何同时运行单独的进程。在`highscore.py`执行代码时，`__name__`设置为`"__main__"`.

`import highscore`您可以通过在正在运行的 Python 程序中执行 from 将其作为模块导入。这不会*启动*一个新进程，它只是从`highscore.py`现有 Python 程序的中间执行代码，然后继续下一行。在`highscore.py`执行代码时，`__name__`设置为`"highscore"`.

无论哪种方式，所有顶级模块代码都将被执行，包括定义类和函数，以及您编写的任何其他语句。`if __name__ == "__main__":`当您的文件作为脚本运行时，您可以使用检查来执行额外的代码，而不是在作为模块导入时执行。

* * *

也值得指出一些事情。你的代码中有这个：

```
 elif e.key == pygame.K_RETURN:
    if pos == 1:
         import MathsvadersReal
    elif e.key == pygame.K_RETURN:
     if pos == 2:
        import Highscore
    elif pos == 5:
     pygame.quit()
     sys.exit() 
```

如果这是你真正的缩进，那`elif e.key == pygame.K_RETURN`将永远是True，所以它是不必要的，而且你没有办法到达`elif pos == 5:`，所以没有办法退出。

# java - 在 Windows azure 模拟器中启动角色实例时出现无限循环：[WaWorkerHost.exe] 退出并出现错误代码 1

> ID：15233037
> 
> 赞同：0
> 
> 时间：2013-03-05T20:02:24.990
> 
> 标签：java, eclipse, azure, cloud

我正在尝试使用 Java 在 Windows Azure 上开发我的第一个应用程序。我按照这里的教程：

[http://msdn.microsoft.com/en-us/library/windowsazure/hh690944.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh690944.aspx)

但是，当我在 Windows Azure 模拟器中运行项目时（如教程中所述），模拟器卡在无限循环中。这是模拟器控制台的输出：

```
[fabric] Role Instance: deployment18(8).WindowsAzureDeploymentProject.WorkerRole1.0
[fabric] Role state Started
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[WaWorkerHost.exe] java.exe is running...
[WaWorkerHost.exe] java.exe stopped running - exiting...
[WaWorkerHost.exe] 
[WaWorkerHost.exe] 
[WaWorkerHost.exe] Exited with error code 1.
[runtime] Role entrypoint . COMPLETED Run() ==> ROLE RECYCLING INITIATED
[runtime] Role instance recycling is starting
[fabric] Role state Stopping
[runtime] Role entrypoint . CALLING   OnStop()
[runtime] Role entrypoint . COMPLETED OnStop()
[fabric] Role state Busy
[fabric] Role state Unhealthy
[fabric] Role state Started
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[WaWorkerHost.exe] java.exe is running...
[WaWorkerHost.exe] java.exe stopped running - exiting...
[WaWorkerHost.exe] 
[WaWorkerHost.exe] 
[WaWorkerHost.exe] Exited with error code 1.
[runtime] Role entrypoint . COMPLETED Run() ==> ROLE RECYCLING INITIATED
[runtime] Role instance recycling is starting
[runtime] Role entrypoint . CALLING   OnStop()
[runtime] Role entrypoint . COMPLETED OnStop()
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[WaWorkerHost.exe] java.exe is running...
[WaWorkerHost.exe] java.exe stopped running - exiting...
[WaWorkerHost.exe] 
[WaWorkerHost.exe] 
[WaWorkerHost.exe] Exited with error code 1.
[runtime] Role entrypoint . COMPLETED Run() ==> ROLE RECYCLING INITIATED
[runtime] Role instance recycling is starting
[runtime] Role entrypoint . CALLING   OnStop()
[runtime] Role entrypoint . COMPLETED OnStop()
[fabric] Role state Stopping
[fabric] Role state Busy
[fabric] Role state Started
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[WaWorkerHost.exe] java.exe is running...
[fabric] Role state Stopping
[WaWorkerHost.exe] java.exe stopped running - exiting...
[WaWorkerHost.exe] 
[WaWorkerHost.exe] 
[WaWorkerHost.exe] Exited with error code 1.
[runtime] Role entrypoint . COMPLETED Run() ==> ROLE RECYCLING INITIATED
[runtime] Role instance recycling is starting
[runtime] Role entrypoint . CALLING   OnStop()
[runtime] Role entrypoint . COMPLETED OnStop()
[fabric] Role state Busy
[fabric] Role state Started
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[WaWorkerHost.exe] java.exe is running...
[WaWorkerHost.exe] java.exe stopped running - exiting...
[WaWorkerHost.exe] 
[WaWorkerHost.exe] 
[WaWorkerHost.exe] Exited with error code 1.
[runtime] Role entrypoint . COMPLETED Run() ==> ROLE RECYCLING INITIATED
[runtime] Role instance recycling is starting
[fabric] Role state Stopping
[runtime] Role entrypoint . CALLING   OnStop()
[runtime] Role entrypoint . COMPLETED OnStop()
[fabric] Role state Busy
[fabric] Role state Started
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[WaWorkerHost.exe] java.exe is running...
[WaWorkerHost.exe] java.exe stopped running - exiting...
[WaWorkerHost.exe] 
[WaWorkerHost.exe] 
[WaWorkerHost.exe] Exited with error code 1.
[runtime] Role entrypoint . COMPLETED Run() ==> ROLE RECYCLING INITIATED
[runtime] Role instance recycling is starting
[fabric] Role state Stopping 
```

我在 Windows 8（32 位）、JDK 7 和 Tomcat 7 上使用 Eclipse for Java EE (Juno)。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T00:11:17.297

根据您遇到的错误，您的 Tomcat 部署似乎有问题。以下错误尤其明显： [WaWorkerHost.exe] java.exe is running... [WaWorkerHost.exe] java.exe 停止运行 - 正在退出...

这表明 Tomcat 确实设法运行了几秒钟，但随后由于某种原因退出，这导致重新启动（无限期，因为每当启动失败时，Azure 都会继续尝试重新启动）。

如果你已经确定你已经正确地遵循了这些步骤，那么你会想到的另一件事是，Tomcat 可能正试图绑定到你的 PC 上的某个东西已经占用的端口。默认情况下，Tomcat 会尝试绑定到 8080，因此如果您没有更改它，那么需要检查的一件事是您的 PC 上是否还有其他东西已经绑定到 8080。（模拟器不会为您的部署。您在机器上运行的其他东西可能会破坏模拟器中的东西）

但这只是一种预感。如果您还可以查看 Tomcat 报告的错误，那就太好了。您应该 - 如果只是短暂地 - 看到 Tomcat 弹出一个控制台窗口 - 其中报告了 Tomcat 的错误。如果您可以在此处提供更多信息，那可能会有所帮助。

# mysql - 在一个sql中返回父母3级深度

> ID：15233040
> 
> 赞同：0
> 
> 时间：2013-03-05T20:02:37.913
> 
> 标签：mysql

在此处查看[演示：](http://sqlfiddle.com/#!2/1c9cd/1) 缺少的地方：“体育»橄榄球联盟»结果”和其他一些。

问题是由 WHERE 中的最后一个 IF 语句引起的。添加它是为了确保页面/父级只会深入 3 级，当您删除它时，我们最终会得到“足球»结果»冠军”，它不参考顶级。

一切都指向顶部 page_id = 1。

```
SELECT
    p1.page_id,
    IF( p1.parent_page_id >1,
    (    SELECT
        IF( p2.parent_page_id >1,
        (    SELECT
            CONCAT( pd3.page_description_name,
            ' » ',
            pd2.page_description_name,
            ' » ',
            pd1.page_description_name )  
        FROM
            pages p3  
        LEFT JOIN
            page_descriptions pd3 
                ON pd3.page_id = p3.page_id  
                AND pd3.language_id = '1'  
        WHERE
            p3.page_id = p2.parent_page_id  LIMIT 1 ) ,
        CONCAT( pd2.page_description_name,
        ' » ',
        pd1.page_description_name ) )  
    FROM
        pages p2  
    LEFT JOIN
        page_descriptions pd2 
            ON pd2.page_id = p2.page_id  
            AND pd2.language_id = '1'  
    WHERE
        p2.page_id = p1.parent_page_id  LIMIT 1  ), pd1.page_description_name  ) AS path  
FROM
    pages p1  
LEFT JOIN
    page_descriptions pd1 
        ON pd1.page_id = p1.page_id  
        AND pd1.language_id = '1'  
WHERE
    IF( p1.parent_page_id >1, (    SELECT
        IF( p3.parent_page_id  IN ( 1,
        0 ) ,
        1,
        0 )  
    FROM
        pages p3  
    WHERE
        p3.page_id = p1.parent_page_id  LIMIT 1 ) , 1  )  
    AND p1.page_id !=1  
ORDER BY
    path 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:29:30.443

有点大规模的连接，正如 Mike Brant 在评论中指出的那样，如果它是一个经常运行的查询，你可能最好查看另一个结构，但据我了解要求，这应该适用于你当前的数据放;

```
SELECT a.page_id,CONCAT_WS(' » ',c.page_description_name,
                                 b.page_description_name,
                                 a.page_description_name) path
FROM page_descriptions a
LEFT JOIN pages a1 
  ON a.page_id = a1.page_id AND a1.parent_page_id <>1
LEFT JOIN page_descriptions b
  ON b.page_id = a1.parent_page_id
LEFT JOIN pages b1 
  ON b.page_id = b1.page_id AND b1.parent_page_id <>1
LEFT JOIN page_descriptions c
  ON c.page_id = b1.parent_page_id
LEFT JOIN pages c1 
  ON c.page_id = c1.page_id  AND c1.parent_page_id <>1
WHERE (c1.parent_page_id IS NULL OR c1.parent_page_id=0)
  AND a.page_description_id <> 1 
```

[一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!2/9a21f/3)。

# python - Python - 窗口标题和键盘记录器

> ID：15233044
> 
> 赞同：0
> 
> 时间：2013-03-05T20:02:53.913
> 
> 标签：python, keylogger

这是 python 键盘记录器和窗口标题抓取器的代码，但我无法同时抓取它们。

```
import pythoncom, pyHook ,time

def OnKeyboardEvent(event):
            keylog= chr(event.Ascii)

            print keylog
            key =  event.WindowName
            print key
            time.sleep(0.1)
            if(key==event.WindowName):
                pass
            else:
                key = event.WindowName
                print key

hm = pyHook.HookManager()
hm.KeyDown = OnKeyboardEvent
hm.HookKeyboard()
pythoncom.PumpMessages() 
```

输出就像

a 开始菜单 b 开始菜单 c 开始菜单 d cmd.exe

我需要它

开始菜单 abc

cmd.exe

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:21:05.803

您的代码实际上没有任何意义。让我们逐步了解它的作用：

```
 keylog= chr(event.Ascii)

        print keylog 
```

这将打印按下的键。

```
 key =  event.WindowName
        print key 
```

这将打印窗口名称。我不确定你为什么要把它放在一个`key`不是键时调用的变量中，但这并不会改变它的作用。

```
 time.sleep(0.1) 
```

这会暂停，大概是为了确保在用户输入速度过快时会丢失按键？

```
 if(key==event.WindowName):
            pass 
```

这总是正确的，因为您设置`key = event.WindowName`得更早，并且`event`对象不会即时更改。

```
 else:
            key = event.WindowName
            print key 
```

如上所述，这永远不会发生。但是，如果确实如此，它将设置`key`为它已经拥有的值（窗口名称）并再次打印它。

我的猜测是，您在这里*尝试*做的是仅在窗口名称与上次不同时打印窗口名称，或者类似的东西？一种快速而肮脏的方法是使用全局变量：

```
lastWindow = None

def OnKeyboardEvent(event):
    global lastWindow

    window = event.WindowName
    key = chr(event.Ascii)

    if window != lastWindow:
        print window
        lastWindow = window

    print key 
```

所以，在你的测试用例中，而不是这个：

```
a Start menu b Start menu c Start menu d cmd.exe 
```

你应该得到这个：

```
Start menu a b c cmd.exe d 
```

（尽管实际上，您将把它们放在单独的行上，而不是用空格分隔，因为您的代码只是做`print keylog`and `print key`，而我也做了同样的事情。如果您希望它们都在一行上，请在每行的末尾加一个逗号`print`陈述。）

# java - 使用正则表达式验证密码（包含字母、数字和特殊字符）。{8,}

> ID：15233054
> 
> 赞同：1
> 
> 时间：2013-03-05T20:03:21.520
> 
> 标签：java, regex

我需要知道以下情况的正则表达式：

*   至少 8 个字符`( ... ).{8,}`
*   有字母`(?=.*[a-z|A-Z])`
*   有数字`(?=.*\d)`
*   有特殊字符`(?=.*[~'!@#$%?\\\/&*\]|\[=()}"{+_:;,.><'-])`

我在其他正则表达式中得到了以下内容：

```
((?=.*\d)(?=.*[a-z|A-Z])(?=.*[~'!@#$%?\\\/&*\]|\[=()}"{+_:;,.><'-])).{8,} 
```

但它失败了：

```
qwer!234 
```

有小费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:26:01.780

在 Java 正则表达式中，由于字符串转义规则，您需要将反斜杠加倍：

```
Pattern regex = Pattern.compile("^(?=.*\\d)(?=.*[a-zA-Z])(?!\\w*$).{8,}"); 
```

应该管用。

**解释：**

```
^              # Start of string
(?=.*\d)       # Assert presence of at least one digit
(?=.*[a-zA-Z]) # Assert presence of at least one ASCII letter
(?!\w*$)       # Assert that the entire string doesn't contain only alnums
.{8,}          # Match 8 or more characters 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:20:14.120

对于所有这些特殊字符，您很可能没有正确地转义所有内容。

你说Java对吗？这打印`true`：

```
String regex = "((?=.*\\d)(?=.*[a-zA-Z])(?=.*[~'!@#$%?\\\\/&*\\]|\\[=()}\"{+_:;,.><'-])).{8,}";
System.out.println("qwer!234".matches(regex)); 
```

但这要简单得多：

```
String regex = "(?=.*?\\d)(?=.*?[a-zA-Z])(?=.*?[^\\w]).{8,}"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:25:27.887

为什么要把这一切都放在一个正则表达式中？只需为每个检查创建单独的函数，您的代码就会更容易理解和维护。

```
if len(password) > 8 &&
   has_alpha(password) &&
   has_digit(password) &&
    ... 
```

您的业​​务逻辑是立即可以理解的。另外，当您想添加一些其他条件时，您不必修改棘手的正则表达式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T05:43:46.350

```
Pattern letter = Pattern.compile("[a-zA-z]");  
Pattern digit = Pattern.compile("[0-9]");  
Pattern special = Pattern.compile ("[!@#$%&*()_+=|<>?{}\\[\\]~-]");  
Pattern eight = Pattern.compile (".{8}");  
...  
public final boolean ok(String password) {  
   Matcher hasLetter = letter.matcher(password);  
   Matcher hasDigit = digit.matcher(password);  
   Matcher hasSpecial = special.matcher(password);  
   Matcher hasEight = eight.matcher(password);  
   return hasLetter.find() && hasDigit.find() && hasSpecial.find()  
      && hasEight.matches();  
} 
```

它会起作用。

# c# - 如何在 Outlook 加载项中重置事件

> ID：15233056
> 
> 赞同：0
> 
> 时间：2013-03-05T20:03:27.877
> 
> 标签：c#, delegates, outlook, add-in

使用 Outlook 加载项，到目前为止一切都按预期工作： - 加载项 - 创建组合框和更改事件处理程序 - 为用户单击新电子邮件时创建事件处理程序

加载项取决于用户在组合框中选择的内容，将加载 HTML 模板或白色模板（只是为了返回原始状态）。

在两个模板之间来回进行几次测试后，不再捕获更改事件。正如您在下面的代码中看到的那样，我使用它来处理更改事件：

```
cmboBxKeyWord.Change += new CommandBarComboBoxEvents_ChangeEventHandler(cmboBxKeyWord_Change); 
```

这是其余的代码：

```
 public partial class ThisAddIn
{
    private string templateName = "";
    private string subject="";
    private int messageType;
    private string customerId;
    private CommandBar menuBar;
    private Outlook.Inspectors inspectors;

    StringBuilder sb = new StringBuilder();

    private void ThisAddIn_Startup(object sender, System.EventArgs e)
    {
        CreateControl();

        inspectors = this.Application.Inspectors;
        inspectors.NewInspector += new Microsoft.Office.Interop.Outlook.InspectorsEvents_NewInspectorEventHandler(Inspectors_NewInspector);
    }

    private void CreateControl(){
             menuBar = this.Application.ActiveExplorer().CommandBars.ActiveMenuBar;
            CommandBarComboBox cmboBxKeyWord = (Office.CommandBarComboBox)menuBar.Controls.Add(Office.MsoControlType.msoControlComboBox, missing, missing, 1, true);
            cmboBxKeyWord.AddItem("Template Email");
            cmboBxKeyWord.AddItem("Regular Email");
            cmboBxKeyWord.Change += new _CommandBarComboBoxEvents_ChangeEventHandler(cmboBxKeyWord_Change);
    }

    private void cmboBxKeyWord_Change(CommandBarComboBox Ctrl)
    {

       this.messageType = Ctrl.ListIndex - 1;
       if (this.messageType == 1)
       {
           this.templateName = @"c:\templates\Blank Email.txt";
       }
       else
       {
           this.templateName = @"c:\templates\Template Email.txt";
           this.customerId = Microsoft.VisualBasic.Interaction.InputBox("Enter Customer ID of the customer to which you want to send this email", "Customer ID");

           if (this.customerId == null || this.customerId.Length == 0)
               this.messageType = 1;
       }
    }

    private void Inspectors_NewInspector(Microsoft.Office.Interop.Outlook.Inspector Inspector)
    {
        Outlook.MailItem mailItem = Inspector.CurrentItem as Outlook.MailItem;

        if (mailItem != null)
        {
            if (mailItem.EntryID == null)
            {
                if (this.messageType == 0) //HTML template email not the blank email...
                {

                    mailItem.HTMLBody = getBody(); // the get body is a func that returns string, after fetching data from DB and processing it...nothing magic
                    mailItem.Subject = getSubject();
                }
                else
                {
                    mailItem.HTMLBody = "";
                    mailItem.Subject = "";
                }
            }
        }
    }
} 
```

我怀疑事件处理程序，我的想法是代码继续运行并且事件处理程序总是被添加（+=）从不删除（-=）我只是假设这是因为我对委托/事件处理程序的经验很少。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:39:24.620

```
CommandBarComboBox cmboBxKeyWord = (Office.CommandBarComboBox)menuBar.Controls.Add(Office.MsoControlType.msoControlComboBox, missing, missing, 1, true); 
```

组合框需要在类外部声明，当过程完成时它超出范围，然后被 GC 收集......

# javascript - jQuery如何加载图像的一部分

> ID：15233057
> 
> 赞同：3
> 
> 时间：2013-03-05T20:03:27.927
> 
> 标签：javascript, jquery, slider

我有一个小问题。我需要创建圆形滑块，我没有找到任何可以帮助我的库，所以似乎我需要自己编写它。
这是我的问题：
![在此处输入图像描述](../Images/9cdcb0a09887a40239f425e2a63493d7.png)

我想创建类似上图的东西，但我找不到加载部分渐变的方法，例如：

![在此处输入图像描述](../Images/2f8377be3975a1f767d74b8785be9240.png)

甚至可以在js中加载部分图像吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:12:50.847

如果您不需要动态替换图像，我建议您在 Photoshop 等图像工具中进行准备。

如果您要替换的图像很少，我会在 Photoshop 中准备它们并通过 javascript 和 css 解决方案更改它们

否则我不知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T13:40:20.633

没有办法在纯 JavaScript 中加载图像的一部分。相反，您可以使用精灵图像并使用背景位置：

```
function getBgPos(pct) {
  if (pct < 12.5) { return '0 0'; }
  else if (pct < 25) { return '-100px 0'; }
  else if (pct < 37.5) { return '-200px 0'; }
  else if (pct < 50) { return '-300px 0'; }
  else if (pct < 62.5) { return '-400px 0'; }
  else if (pct < 75) { return '-500px 0'; }
  else if (pct < 87.5) { return '-600px 0'; }
  else if (pct < 100) { return '-700px 0'; }
  else { return '-800px 0'; }
};

i = 0;
setInterval(function () {
  jQuery('#loader').css('background-position', getBgPos(i));
  i += 12.5; if (i > 100) i = 0;
}, 500);
```

```
#loader {
  display: block;
  width: 100px;
  height: 100px;
  background: yellow url(https://i.stack.imgur.com/Xsf4k.png) no-repeat 0 0;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<img id="loader" src="https://i.stack.imgur.com/ArcTX.png" />
```

![](../Images/a638ef999ab58233dde929acf9c9750b.png) ![](../Images/324fa4350cb2b81683d5e9bb49618fa9.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:22:19.207

由于您要向后兼容，因此我将根据 Bertrand 的建议进行构建。. . 您可以轻松地制作一个“精灵”图像，其中包含滑块的所有各种“阶段”（即完成 20%、完成 40% 等），并在不同的 CSS 类中引用它的每个阶段。

这样，所有阶段都将在页面加载时作为一个图像加载，并且您可以使用 JavaScript 更新显示滑块的元素的类，从而更新滑块的进度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T20:18:14.527

我同意画布选项。另外-根据您要尝试做的事情，我会推荐[-http://anthonyterrien.com/knob/](http://anthonyterrien.com/knob/)

我用图像自定义了表盘本身，您可以设置显示部分的颜色。它可能不是您的完整解决方案 - 但理想情况下会为您指明正确的方向。

# php - 跨域，但服务器数据不是 JSON 格式

> ID：15233060
> 
> 赞同：-4
> 
> 时间：2013-03-05T20:03:44.927
> 
> 标签：php, json, ajax, get, cross-domain

Hej，我想从远程服务器访问 Web 服务，但存在跨域问题。我尝试了 JSON，因为它在另一个脚本中工作，但这次它生成了“SyntaxError”，然后我发现服务上的数据不是 JSON 格式。

所以现在我在考虑两种方法。首先，将格式更改为JSON；其次，我读过一些建议[PHP Web Proxy](http://developer.yahoo.com/javascript/howto-proxy.html)的文章。但是似乎两种方式都需要服务端的一些代码，任何方法只涉及客户端的编码？对于第一种方式，如何将内容格式化为 JSON？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:06:48.367

首先，您需要一台服务器来获得服务。有两种通用的请求和响应格式：XML 或 JSON 格式。因此，每当您需要服务时，您都会向服务器发送请求。如果服务器有可用的请求服务，那么服务器将响应您。为此，我更喜欢 JSONP。

因此，对于使用 JSONP 进行跨域通信，您可以遵循：[http ://www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

要以 JSON 格式响应，您可能需要返回：

```
$myReturnData = array("its"=>"an array","its"=>"an array");
  print $_GET['jsoncallback']. '('.json_encode($myReturnData, JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP | JSON_UNESCAPED_UNICODE).')'; 
```

# powershell - 监控多个 VM 的单个 CPU 内核

> ID：15233061
> 
> 赞同：0
> 
> 时间：2013-03-05T20:03:46.303
> 
> 标签：powershell, monitoring, vsphere, cpu-cores

我有很多具有多个内核的虚拟机。在某些虚拟机中运行的一些应用程序并未针对多个内核进行优化，并且很多时候一个 CPU 内核将以高百分比运行，而另一个 CPU 内核几乎没有被使用。我正在寻找一种方法来监控这些服务器上的单个 CPU 核心使用情况，并将我找到的数据输出到某种文件（.txt 或电子表格）。我知道可以直接从 vSphere 中查看服务器上的 CPU 核心使用情况，但是我有太多虚拟机需要坐下来监控。

有没有办法用 Powershell 做到这一点？我希望能够创建一个通过任务调度程序自动运行并收集我想要的信息的脚本，这样我就可以决定是否对某些虚拟机进行更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:45:09.717

如果我对[这篇文章](http://www.lucd.info/2010/01/24/powercli-vsphere-statistics-part-4-grouping/)的理解正确，[`Get-Stat`](http://www.vmware.com/support/developer/PowerCLI/PowerCLI41/html/Get-Stat.html)应该会给你每个核心的统计数据。

# vba - 如何从字符串中获取单元格？

> ID：15233062
> 
> 赞同：1
> 
> 时间：2013-03-05T20:03:57.910
> 
> 标签：vba, excel

我正在尝试创建一个函数，该函数从单元格中获取公式字符串作为参数，并将其包含的所有单元格作为字符串数组返回。

```
Function GetCells(str As String) As String
    Dim stringArray() As String

    GetCells = stringArray
End Function 
```

我想在一个递归函数中使用它，该函数遍历单元格中的所有链接单元格，并用一些字符串替换单元格名称。这是一段概念代码：

```
Dim result As String
Dim cell As Range
Dim stringArray() As String
Dim arraySize As Integer

Set stringArray = GetCells("A1 + A2")
arraySize = UBound(stringArray)

For n = 0 To arraySize Step 1
   Set cell = Range(stringArray(n))
   result = Replace(result, stringArray(n), "Some text")
Next 
```

我唯一的解决方案是创建一个状态机并查找字符和整数对，然后根据结果构建数组。有没有更简单的方法可以通过某些功能做到这一点？如果是怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T05:55:55.400

另一种选择是通过“Microsoft VBScript Regular Expressions 5.5”库提供的正则表达式匹配功能。

以下基于正则表达式的函数将字符串公式作为参数，并返回公式中单元格引用的数组。如果没有找到有效的单元格引用，则返回 -1。

```
 Function GetCellRefs(formulaStr As String) As Variant

      Dim regEx As New VBScript_RegExp_55.RegExp
      Dim matches As Variant, match As Variant
      Dim resArr()
      Dim i As Long

      regEx.pattern = "(\$?[a-z]+\$?\d+\:\$?[a-z]+\$?\d+|\$?[a-z]+\$?\d+)"
      regEx.IgnoreCase = True
      regEx.Global = True

      If regEx.Test(formulaStr) Then
          Set matches = regEx.Execute(formulaStr)
          ReDim resArr(0 To matches.Count - 1)
          i = 0
          For Each match In matches
              resArr(i) = match.Value
              i = i + 1
          Next match
          GetCellRefs = resArr
      Else
          GetCellRefs = Array(-1)
      End If

  End Function 
```

为了使用此功能，您需要通过从 VBA 编辑器中选择工具/参考并在可用参考列表中选中其标题来添加对库的参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T00:40:05.387

我认为您正在寻找的是：

`Range("A1").Precedents.Address`

( [Range.Precedents 属性](http://msdn.microsoft.com/en-us/library/office/ff196936.aspx))

所以，如果 A1 有公式：

`=B1+C2-D3`

然后`Range("A1").Precedents.Address`会返回：

`$B$1,$C$2,$D$3`

如果公式是：

`=INDEX($D$1:$D$17,1,1)`

然后`$D$1:$D$17`被退回。

你怎么能用这个？只需将 Range 对象传递给您要评估的范围的函数，然后获取返回的地址列表，将*其*放入另一个范围对象并评估每个单元格。

这是一个示例（例如单元格 A1 和 A2 中有公式）：

```
Option Explicit

Public Function getCells(ByRef r As Excel.Range) As String
    Dim s As String

    getCells = r.Precedents.Address
End Function

Public Sub test()
    Dim rangeString As String
    Dim r As Excel.Range
    Dim cell As Excel.Range

    rangeString = getCells(Sheet1.Range("A1:A2"))
    Set r = Range(rangeString)

    For Each cell In r
        ' do stuff
        Debug.Print "hello: " & cell.Address(0, 0)
    Next cell
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T16:37:27.677

在尝试使您在答案中发布的解决方案失败后，我创建了自己的解决方案。
正如我认为创建一个状态机将解决问题，它完美适用于 1x1 单元，这就是我想要的：

## 源代码

```
Function isChar(char As String) As Boolean
    Select Case char
        Case "A" To "Z"
            isChar = True
        Case Else
            isChar = False
    End Select
End Function

Function isNumber(char As String, isZero As Boolean) As Boolean
    Select Case char
        Case "0"
            If isZero = True Then
                isNumber = True
            Else
                isNumber = False
            End If
        Case "1" To "9"
            isNumber = True
        Case Else
            isNumber = False
    End Select
End Function

Function GetCells(str As String) As String
    Dim stringArray() As String
    Dim stringSize As Integer 'size of stringArray
    Dim c As Integer 'character number
    Dim chr As String 'current character
    Dim tempcell As String 'suspected cell's temporaly result
    Dim state As Integer 'state machine's state:
    '0 - nothing
    '1 - 1 character eg. A from A1
    '2 - 2 character eg. AG from AG156
    '3 - 3 character eg. AGH from AGH516516
    '4 - characters with number(s) eg. AH15 from AH1569
    '5 - first dollar sing eg. $ from $A$1
    '6 - second sollar sing eg. $A$ from $A$1

    Dim testresult As String

    state = 0
    stringSize = 0

    For c = 0 To Len(str) Step 1
        chr = Mid(str, c + 1, 1)
        Select Case state
            Case 0
                If isChar(chr) Then
                    state = 1
                    tempcell = tempcell & chr
                ElseIf chr = "$" Then
                    state = 5
                    tempcell = tempcell & chr
                Else
                    state = 0
                    tempcell = ""
                End If
            Case 1
                If isNumber(chr, False) Then
                    state = 4
                    tempcell = tempcell & chr
                ElseIf isChar(chr) Then
                    state = 2
                    tempcell = tempcell & chr
                ElseIf chr = "$" Then
                    state = 6
                    tempcell = tempcell & chr
                Else
                    state = 0
                    tempcell = ""
                End If
            Case 2
                If isNumber(chr, False) Then
                    state = 4
                    tempcell = tempcell + chr
                ElseIf isChar(chr) Then
                    state = 3
                    tempcell = tempcell + chr
                ElseIf chr = "$" Then
                    state = 6
                    tempcell = tempcell + chr
                Else
                    state = 0
                    tempcell = ""
                End If
            Case 3
                If isNumber(chr, False) Then
                    state = 4
                    tempcell = tempcell + chr
                ElseIf chr = "$" Then
                    state = 6
                    tempcell = tempcell + chr
                Else
                    state = 0
                    tempcell = ""
                End If
            Case 4
                If isNumber(chr, True) Then
                    state = 4
                    tempcell = tempcell + chr
                Else
                    state = 0
                    stringSize = stringSize + 1
                    ReDim Preserve stringArray(stringSize)
                    stringArray(stringSize - 1) = tempcell
                    tempcell = ""
                End If
            Case 5
                If isChar(chr) Then
                    state = 1
                    tempcell = tempcell + chr
                Else
                    state = 0
                    tempcell = ""
                End If
            Case 6
                If isNumber(chr, False) Then
                    state = 4
                    tempcell = tempcell + chr
                Else
                    state = 0
                    tempcell = ""
                End If
            Case Else
                state = 0
                tempcell = ""
        End Select
    Next c
    'GetCells = stringArray
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    'This part is only for easily print the string array
    For c = 0 To stringSize Step 1
        testresult = testresult + " | " + stringArray(c)
    Next
    GetCells = testresult
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
End Function

Sub Main()
Dim s As String
s = "A1+B1+$A1-$B$65"
MsgBox (GetCells(s))

s = "(A5*2+HJ$15)-((F5+F1)-$F11+$PP$659)"
MsgBox (GetCells(s))

'also some crazy input
s = "A$61+$HK2+'p0thecakeisalie/0p'+DDD5+D1-$B$12-LCK$5065"
MsgBox (GetCells(s))

End Sub 
```

## 测试

我创建了一些测试，以便您可以看到它的实际效果。前两个是模拟日常使用，而第三个是一些疯狂的输入，但算法仍然适用。

### 情况1

*   输入：`A1+B1+$A1-$B$65`
*   输出：`| A1 | B1 | $A1 | $B$65 |`

### 案例2

*   输入：`(A5*2+HJ$15)-((F5+F1)-$F11+$PP$659)`
*   输出：`| A5 | HJ$15 | F5 | F1 | $F11 | $PP$659 |`

### 案例3

*   输入：`A$61+$HK2+'p0thecakeisalie/0p'+DDD5+D1-$B$12-LCK$5065`
*   输出：`| A$61 | $HK2 | DDD5 | D1 | $B$12 | LCK$5065 |`

# r - 如何从包含我的数据框中的 NULL 值的因素的列中剔除观察值

> ID：15233071
> 
> 赞同：-2
> 
> 时间：2013-03-05T20:04:41.417
> 
> 标签：r, dataframe

我在 R 中有一个数据框，它有 74 列。其中 60 列是因子，其余列包含连续数据。在作为因子的列中，其中一些包含 NULL 作为级别之一。我想删除所有可能包含 NULL 值的观察结果。每个观察都有一个 ID 列，其中包含一个唯一的标识号。我一直在使用以下代码片段：

```
x <- mydata[which(mydata$column2 == "NULL"), ]
mydata <- mydata[!mydata$ID %in% x$ID, ] 
```

但是，当我以下列方式反复使用它时：

```
x <- mydata[which(mydata$column3 == "NULL"), ]
mydata <- mydata[!mydata$ID %in% x$ID, ] 
```

我开始在我的数据框中获取 NA。我究竟做错了什么？感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:16:38.390

您获得 NA 是因为您指的是不再位于`mydata`. 但是在任何情况下，您反复削减数据的想法都不是一个好主意，性能和代码清晰度都是明智的。试试这个：

```
mydata<-mydata[!apply(mydata,1,function(x) any(x=="NULL")),] 
```

在这里，您检查哪些行至少包含一次 value `"NULL"`，然后删除这些行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:29:12.310

我可能会做这样的事情：

```
# identify the factor columns
factor.cols <- sapply(mydata, is.factor)

# for each row, count how many factor columns contain "NULL"
null.count <- rowSums(mydata[factor.cols]=="NULL")

# keep only those rows with no "NULL" factor values,
# along with rows where all factor values are NA
mydata[is.na(null.count) | null.count==0,] 
```

（如果特定行在`NA`所有因子列中都有 s，则进行编辑以做正确的事情。）

# xaml - WindowsPhone：RelativeSource 模式=FindAncestor，AncestorType：无法解析 SymbolAncestorType

> ID：15233072
> 
> 赞同：2
> 
> 时间：2013-03-05T20:04:41.887
> 
> 标签：xaml, binding, windows-phone

我正在模板化一个列表框。我喜欢仅在选择项目时显示路径。

数据模板：

```
<DataTemplate x:Key="itplPlayerOfTheDay">
    <Grid>
        ...
        <Grid Width="50" Height="50" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,5,0">
            <Path Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor , AncestorType={ListBoxItem}}, Path=IsSelected, Converter={StaticResource BooleanToVisibilityConverter}}"  Data="M32.5569,7.54591 C32.3883,13.1553 31.3485,16.9274z" Stretch="Uniform" Stroke="Black" >
            </Path>
        </Grid>
        ...
    </Grid>
</DataTemplate> 
```

显然我的 XAML 有问题。在设计器中是状态：无法解析符号祖先类型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T13:22:04.827

Windows Phone 不支持 AncestorType。

```
<DataTemplate x:Key="itplPlayerOfTheDay">
    <Grid>
        ...
        <Grid Width="50" Height="50" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,5,0">
            <Path Visibility="{Binding ElementName=yourListBoxName, Path=SelectedItem, Converter={StaticResource BooleanToVisibilityConverter}}"  Data="M32.5569,7.54591 C32.3883,13.1553 31.3485,16.9274z" Stretch="Uniform" Stroke="Black" >
            </Path>
        </Grid>
        ...
    </Grid>
</DataTemplate> 
```

在您的 BooleanToVisibilityConverter 中进行一些更改并完成！

# css - 防止在触摸屏上缩放时调整固定元素的大小

> ID：15233076
> 
> 赞同：34
> 
> 时间：2013-03-05T20:04:48.500
> 
> 标签：css, touch

在 HTML 网站上，您有一个固定元素，如下所示：

```
<div id="fixed">
  <p>Some content</p>
</div> 
```

它有这个 CSS：

```
#fixed { height:150px; position:fixed; top:0; left:0; z-index:10000; } 
```

当您在移动设备（或任何支持触摸屏的设备）上查看此页面并捏住屏幕进行放大时，固定元素会与所有其他内容一起放大（它会变大）。当你放大到足够远时，它会变得如此之大，以至于它几乎完全覆盖了它下面的所有内容。

一个实际的用例是一个 UI，比如顶部的固定导航栏，或者屏幕角落的浮动按钮。

如何防止单个元素在浏览器中调整大小，并使其始终保持相同大小？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-05-15T16:09:59.373

[我根据这个答案编写的](https://github.com/salsita/jquery-ui-scalebreaker)[这个答案对话框小部件库的演示](http://mystrd.at/projects/rescaler/)。
**[对话框小部件的演示](http://mystrd.at/testing/jq-scalebreaker/demo/)**在移动设备上试用，放大并点击链接。

虽然手势事件似乎包含一些关于*某些东西*的比例因子的元数据，但我们可能会更好地控制并手动找到它。由于我们希望在用户实时移动时保持效果，因此我们需要在每个滚动事件期间重新计算。

```
window.addEventListener('scroll', function(e){ /* coming next */ }) 
```

我们计算缩放因子并将其作为 CSS3 变换应用于重新缩放的元素：

```
el.style["transform"] = "scale(" + window.innerWidth/document.documentElement.clientWidth + ")"; 
```

这会将元素重新缩放回相对于当前视口缩放比例为 1 的缩放比例，但它可能仍然错误地放置在页面上。这意味着我们必须为其位置获取新值。屏幕上实际发生的情况取决于元素的 CSS 位置值，其`fixed`行为与移动 Safari 不同`absolute`，特别是在移动 Safari 上，`fixed`位置在页面缩放时会增加平滑效果，这会因此产生一些不便的问题 - 我建议将 100% 内容高度元素作为`relative`预期缩放元素的父元素，然后在脚本中，将元素`absolute`放置在父元素内部。以下值适用于此示例演示：

```
overlay.style.left = window.pageXOffset + 'px';
overlay.style.bottom = document.documentElement.clientHeight - (window.pageYOffset + window.innerHeight) + 'px'; 
```

您可能还需要注意使用`transform-origin`CSS 属性，具体取决于您希望缩放从哪个锚点生效 - 这对对齐有直接影响。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-11-17T13:34:45.310

我希望做与@bobsoap 尝试做的事情相同的事情，但我的解决方案如下：

# 1.禁用放大视口标签：

```
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1" /> 
```

# 2\. 使用类似的插件：TouchSwipe.js：

[https://github.com/mattbryson/TouchSwipe-Jquery-Plugin](https://github.com/mattbryson/TouchSwipe-Jquery-Plugin)

并且只放大您想要并适合您需要的 div 或 div。

我在一个页面上有 2 个 div（左和右） 左边的 div 有一个固定的滚动菜单，右边有小文本和图像。我想捏/缩放并且只有正确的 div 缩放，以便用户可以在必要时更好地阅读文本。我没有使整个视口可缩放并禁用左侧 div 的缩放，而是完全相反：通过 TouchSwipe 插件仅使我的右侧 div 可缩放。

如果有人对我如何实现 TouchSwipe 插件感兴趣，我会在完成后分享我的代码。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-03-05T20:37:04.793

您缺少宽度属性，您可以使用诸如 max-width 和 max-height 之类的东西来帮助将框保持在您想要的大小。但是，缩放允许用户对页面进行非常精细的处理，因此他们总是有可能遇到这个问题。

```
#fixed { height:150px; width: 200px; max-width: 200px; max-height: 150px; position:fixed; top:0; left:0; z-index:10000; } 
```

# python - 在 web2py 控制器中导入 py4j 模块时出现 TypeError

> ID：15233078
> 
> 赞同：1
> 
> 时间：2013-03-05T20:05:02.607
> 
> 标签：python, import, module, web2py, py4j

我目前在尝试在 web2py 上使用 py4j 时遇到问题。这就是我试图在我的 web2py 控制器文件中导入它的方式：

```
from py4j.java_gateway import JavaGateway 
```

加载页面时，这是我得到的错误：

```
<type 'exceptions.TypeError'> Item in ``from list'' not a string 
```

但是，在终端上运行 Python 时，不会出现该问题。运行上面的导入行可以完美运行，并且与我的 Java 应用程序的通信也很完美。

有任何想法吗？

附加信息：

*   在 Mac OS X 10.6.8 上运行
*   Python 版本 2.7.2
*   web2py 版本 2.3.2
*   web2py 和我的终端窗口都使用相同的 Python 版本。
*   sys.path 对两者都是相等的。
*   使用 line`import py4j`而不是`from py4j.java_gateway import JavaGateway`不会给我任何错误，但我无法以这种方式使用 py4j（至少我不知道如何）

让我知道是否需要任何其他信息。非常感谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:01:24.060

我得到了它的工作，即使我还不太明白为什么的细节，所以任何进一步的解释将不胜感激。

问题出在我用来访问该页面的 URL 中。我正在使用`http://localhost:8000/MyApplicationName/controller`. 当我切换到`http://localhost:8000/myapplicationname/controller`（应用程序名称完全小写）时，一切正常。

同样，非常感谢有关导入模块的解释与 web2py 上的 url 相关。

# android - Android 相机在 Android 4.2.2（API 级别 17）上失败

> ID：15233079
> 
> 赞同：0
> 
> 时间：2013-03-05T20:05:10.697
> 
> 标签：android, android-layout, android-intent, android-emulator, webcam

我正在尝试使用相机，但它无法启动。hw.camera.back: Webcam() hw.camera.front: webcam() 不确定还要添加什么，因为我无法剪切和粘贴详细信息。

我得到的错误是不幸的，相机已停止。

我的代码如下，但它不是我的代码。当我尝试在不使用任何编程的情况下使用相机时，我得到了同样的错误。

```
Intent takePictureIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        startActivityForResult(takePictureIntent, actionCode); 
```

在 LogCat 我有以下内容。我在 LogCat 中看到的一个我不理解的错误与我没有使用的电子邮件有关，我什至不知道如何打开或关闭它。D/交换服务（617）：！！！未找到电子邮件应用程序；停止自我

```
03-05 19:39:12.716: I/Choreographer(409): Skipped 90 frames!  The application may be doing too much work on its main thread.
03-05 19:39:12.736: D/dalvikvm(818): GC_FOR_ALLOC freed 20K, 7% free 3675K/3936K, paused 59ms, total 66ms
03-05 19:39:12.875: D/dalvikvm(818): GC_FOR_ALLOC freed 5K, 7% free 4013K/4276K, paused 61ms, total 64ms
03-05 19:39:13.056: D/Camera(818): app passed NULL surface
03-05 19:39:13.076: V/EmulatedCamera_Camera(40): getCameraInfo
03-05 19:39:13.076: V/EmulatedCamera_BaseCamera(40): getCameraInfo
03-05 19:39:13.203: D/dalvikvm(818): GC_CONCURRENT freed 73K, 5% free 4429K/4656K, paused 12ms+55ms, total 197ms
03-05 19:39:13.203: V/camera(818): Preview size is 640x480
03-05 19:39:13.243: V/EmulatedCamera_Camera(40): setParameters
03-05 19:39:13.263: V/camera(818): startPreview
03-05 19:39:13.263: V/EmulatedCamera_Preview(40): setPreviewWindow: current: 0x0 -> new: 0x0
03-05 19:39:13.263: V/EmulatedCamera_Camera(40): doStartPreview
03-05 19:39:13.263: V/EmulatedCamera_Preview(40): startPreview
03-05 19:39:13.263: D/EmulatedCamera_Camera(40): Starting camera: 640x480 -> NV21(yuv420sp)
03-05 19:39:13.263: V/EmulatedCamera_QemuDevice(40): startDevice
03-05 19:39:13.276: V/EmulatedCamera_Device(40): commonStartDevice: Allocated 0x41c42008 460800 bytes for 307200 pixels in NV21[640x480] frame
03-05 19:39:15.273: D/dalvikvm(818): GC_FOR_ALLOC freed 49K, 4% free 4605K/4776K, paused 44ms, total 46ms
03-05 19:39:15.293: I/dalvikvm-heap(818): Grow heap (frag case) to 5.684MB for 1127536-byte allocation
03-05 19:39:15.293: E/EmulatedCamera_QemuClient(40): queryStart: Query failed: Cannot start the camera
03-05 19:39:15.313: E/EmulatedCamera_QemuDevice(40): startDevice: Unable to start device 'AndroidEmulatorVC0' for NV21[640x480] frames
03-05 19:39:15.313: V/EmulatedCamera_Preview(40): stopPreview
03-05 19:39:15.378: D/dalvikvm(818): GC_FOR_ALLOC freed 1K, 3% free 5704K/5880K, paused 85ms, total 85ms
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40): disableMessage: msg_type = 0x10
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_PREVIEW_FRAME
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40): **** Currently enabled messages:
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_ERROR
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_FOCUS
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_ZOOM
03-05 19:39:15.383: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_PREVIEW_METADATA
03-05 19:39:15.393: V/EmulatedCamera_Camera(40): doStopPreview
03-05 19:39:15.393: V/EmulatedCamera_CallbackNotifier(40): disableMessage: msg_type = 0x10
03-05 19:39:15.393: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_PREVIEW_FRAME
03-05 19:39:15.393: V/EmulatedCamera_CallbackNotifier(40): **** Currently enabled messages:
03-05 19:39:15.393: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_ERROR
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_FOCUS
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_ZOOM
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_PREVIEW_METADATA
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40): disableMessage: msg_type = 0xffff
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_ERROR
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_SHUTTER
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_FOCUS
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_ZOOM
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_PREVIEW_FRAME
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_VIDEO_FRAME
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_POSTVIEW_FRAME
03-05 19:39:15.403: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_RAW_IMAGE
03-05 19:39:15.413: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_COMPRESSED_IMAGE
03-05 19:39:15.413: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_RAW_IMAGE_NOTIFY
03-05 19:39:15.413: V/EmulatedCamera_CallbackNotifier(40):     CAMERA_MSG_PREVIEW_METADATA
03-05 19:39:15.413: V/EmulatedCamera_CallbackNotifier(40): **** Currently enabled messages:
03-05 19:39:15.413: V/EmulatedCamera_Camera(40): doStopPreview
03-05 19:39:15.413: V/EmulatedCamera_Camera(40): cancelPicture
03-05 19:39:15.413: V/EmulatedCamera_Camera(40): releaseCamera
03-05 19:39:15.413: V/EmulatedCamera_Camera(40): doStopPreview
03-05 19:39:15.423: V/EmulatedCamera_QemuDevice(40): disconnectDevice
03-05 19:39:15.423: V/EmulatedCamera_QemuDevice(40): disconnectDevice: Disonnected from device 'AndroidEmulatorVC0'
03-05 19:39:15.423: I/CameraClient(40): Destroying camera 0
03-05 19:39:15.423: V/EmulatedCamera_Camera(40): closeCamera
03-05 19:39:15.423: V/EmulatedCamera_Camera(40): doStopPreview
03-05 19:39:15.443: W/dalvikvm(818): threadid=11: thread exiting with uncaught exception (group=0x40a71930)
03-05 19:39:15.483: E/AndroidRuntime(818): FATAL EXCEPTION: Thread-67
03-05 19:39:15.483: E/AndroidRuntime(818): java.lang.RuntimeException: startPreview failed
03-05 19:39:15.483: E/AndroidRuntime(818):  at com.android.camera.Camera.startPreview(Camera.java:1867)
03-05 19:39:15.483: E/AndroidRuntime(818):  at com.android.camera.Camera.access$3100(Camera.java:87)
03-05 19:39:15.483: E/AndroidRuntime(818):  at com.android.camera.Camera$5.run(Camera.java:1112)
03-05 19:39:15.483: E/AndroidRuntime(818):  at java.lang.Thread.run(Thread.java:856)
03-05 19:39:15.483: E/AndroidRuntime(818): Caused by: java.lang.RuntimeException: startPreview failed
03-05 19:39:15.483: E/AndroidRuntime(818):  at android.hardware.Camera.startPreview(Native Method)
03-05 19:39:15.483: E/AndroidRuntime(818):  at com.android.camera.Camera.startPreview(Camera.java:1864)
03-05 19:39:15.483: E/AndroidRuntime(818):  ... 3 more
03-05 19:39:15.513: W/AudioFlinger(40): session id 7 not found for pid 40
03-05 19:39:15.523: W/AudioFlinger(40): session id 8 not found for pid 40
03-05 19:39:15.553: W/ActivityManager(291):   Force finishing activity com.android.camera/.Camera
03-05 19:39:15.772: D/dalvikvm(818): GC_CONCURRENT freed 25K, 3% free 5706K/5880K, paused 67ms+25ms, total 398ms
03-05 19:39:16.013: D/dalvikvm(291): GC_FOR_ALLOC freed 1373K, 27% free 8210K/11196K, paused 132ms, total 140ms
03-05 19:39:16.363: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
03-05 19:39:16.610: W/ActivityManager(291): Activity pause timeout for ActivityRecord{410f2198 u0 com.android.camera/.Camera}
03-05 19:39:16.813: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
03-05 19:39:16.873: W/EGL_emulation(409): eglSurfaceAttrib not implemented
03-05 19:39:29.058: W/ActivityManager(291): Activity destroy timeout for ActivityRecord{410f2198 u0 com.android.camera/.Camera}
03-05 19:39:54.407: D/ExchangeService(617): Received deviceId from Email app: null
03-05 19:39:54.407: D/ExchangeService(617): !!! deviceId unknown; stopping self and retrying
03-05 19:39:59.483: D/ExchangeService(617): !!! EAS ExchangeService, onCreate
03-05 19:39:59.483: D/ExchangeService(617): !!! EAS ExchangeService, onStartCommand, startingUp = false, running = false
03-05 19:39:59.543: D/ExchangeService(617): !!! EAS ExchangeService, onStartCommand, startingUp = true, running = false
03-05 19:39:59.593: W/ActivityManager(291): Unable to start service Intent { act=com.android.email.ACCOUNT_INTENT } U=0: not found
03-05 19:39:59.593: D/ExchangeService(617): !!! Email application not found; stopping self
03-05 19:39:59.643: W/ActivityManager(291): Unable to start service Intent { act=com.android.email.ACCOUNT_INTENT } U=0: not found
03-05 19:39:59.663: E/ActivityThread(617): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d43240 that was originally bound here
03-05 19:39:59.663: E/ActivityThread(617): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d43240 that was originally bound here
03-05 19:39:59.663: E/ActivityThread(617):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
03-05 19:39:59.663: E/ActivityThread(617):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
03-05 19:39:59.663: E/ActivityThread(617):  at android.app.ContextImpl.bindService(ContextImpl.java:1418) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:56:23.127

我刚刚在我的身体上对此进行了测试，`Samsung Galaxy Nexus running 4.2.2`并且运行良好。（最初我以为我只有 4.2，但我测试了 4.2.2）

我还测试了在 macbook pro 上完美运行的模拟器上运行。我正在使用模拟器目标：`"Google APIs (Google Inc) - API Level 17 (4.2.2)"`。

您必须确保您在 AndroidManifest.xml 中具有以下权限。

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-feature android:name="android.hardware.camera" />
<uses-feature android:name="android.hardware.camera.autofocus" /> 
```

这将授予使用相机、自动对焦和写入存储的权限

这是启动相机的代码

```
Intent takePictureIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
startActivityForResult(takePictureIntent); 
```

“111”可以替换为您用来识别结果回调函数中的活动的任何常量。

1）如果您已经拥有权限，我建议您进入并从头开始`Android Virtual Device Manager`创建一个新的。`AVD`

*   设备 = Galaxy Nexus
*   目标 = Google API (Google Inc) - API 级别 17 (4.2.2)
*   硬件键盘存在
*   前置摄像头 - 网络摄像头
*   后置摄像头 - 网络摄像头

SD 卡大小 = 200 MB。并尝试使用和不使用主机 GPU。

2）接下来是检查您的网络摄像头。您确定您使用的机器具有网络摄像头及其功能吗？当然，如果网络摄像头不工作或未安装，这会破坏一切。此外，您机器上的驱动程序可能与 AVD 存在问题。否则，您可以尝试对两者都使用“模拟”选项，它基本上只显示测试/移动图像。

如果这一切仍然有问题，那么它一定是你的代码有问题`intent startActivity`。您应该尝试开始一个新的干净项目，将代码放在那里以开始活动，修改`AndroidManifest.xml as`我展示的内容并从那里开始。您也可以尝试在另一台机器上运行，因为可能是您机器上的网络摄像头（如果有，驱动程序冲突）。我在 macbook pro 上测试过 100%

我希望这可以帮助你

# php - 在 Drupal 6 中更改字段布局

> ID：15233083
> 
> 赞同：0
> 
> 时间：2013-03-05T20:05:35.160
> 
> 标签：php, drupal

我有一个名为 field_event_location 的字段，该字段对于一个位置可能有 5 个不同的值。这些被设置为复选框（小部件）。

当管理员选择位置时，这些位置都附加在一起（连接），没有空格或逗号，使阅读变得困难。

字段类型是术语引用。

我正在尝试查看是否有任何其他方法可以保持这种状态（它只需要较小的样式）。

有什么建议么？我需要自定义模块吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:18:37.843

*这是Pro Drupal 开发*书中的一个示例：

```
$options = array(
    'poison' => t('Sprays deadly poison'),
    'metal'  => t('Can bite/claw through metal'),
    'deadly' => t('Killed previous owner')
);

$form['danger'] = array(
    '#title' => t('Special conditions'),
    '#type'  => 'checkboxes',
    '#description' => (t('Please note if any of these conditions apply to your pet')),
    '#options' => $options,
    '#weight' => 25
); 
```

这应该呈现一个带有标题、*垂直堆叠*的选项和下面的描述的字段集。

# linux - 如何为处理的每一行将参数传递给 AWK 中的命令

> ID：15233088
> 
> 赞同：0
> 
> 时间：2013-03-05T20:05:56.847
> 
> 标签：linux, parameters, awk, command, gawk

我想将参数 $8（文件名）传递给函数“testfunc”。该函数应该在该文件中 grep 一个 key_word 并返回一个年份。问题是 Linux 命令“grep”在 fileN 中看不到任何内容。如果我直接通过 $8，它仍然什么也看不到。

```
awk '
   function testfunc(fileN, my_year)
     { "grep 'key_word' fileN"  | getline my_year
       return(my_year)
       close("grep 'key_word' fileN")
     }
   BEGIN {OFS="\t"}
         {printf "%s\t%s\t%s\t", $8, testfunc($8), $9}' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:20:39.723

试试这个：

```
function testfunc(fileN)
     { 
       cmd="grep 'key_word' " fileN 
       cmd | getline my_year
       return(sprintf("%s",my_year))
     } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T00:10:56.700

这是您正在寻找的语法：

```
awk '
   function testfunc(fileN,       my_year, cmd)
     { cmd = "grep \"key_word\" " fileN
       cmd | getline my_year
       close(cmd)
       return(my_year)
     }
   BEGIN {OFS="\t"}
         {printf "%s\t%s\t%s\t", $8, testfunc($8), $9}' 
```

但正如我在评论中提到的 - 不要这样做，无论你试图做什么，这都是错误的方法。

请注意，您不能在单引号分隔的脚本中使用单引号。

编辑：让我试着澄清我关于使用不同方法的观点。您似乎有一个文件，我们称它为“file1”，它的第 8 个字段中有另一个文件名，而您关心的第 9 个字段中有一些其他值。在第 8 个字段中命名的所有文件每个都包含一个包含文本“key_word”的行，您要打印的是 file1 中的第 8 个字段，然后是选项卡，然后是命名文件中的关键字行，然后是第 9 个字段从文件 1。

这可以写成（只是一种可能的解决方案）：

```
gawk -v OFS='\t' '
ARGIND < ARGC { if (/key_word/) my_year[FILENAME] = $0; nextfile }
{ print $8, my_year[$8], $9 }
' $(awk '{print $8}' file1 | sort -u) file1 
```

即在“file1”上调用一次 awk 以获取包含所需日期信息的文件列表，然后将该文件列表在“file1”之前再次传递给 awk，以便最终处理 file1 时所需的所有信息都存储在大批。

上面使用 GNU awk 的“nextfile”来提高效率，但这不是必需的，GNU awks ARGIND 是为了清楚起见，但您可以在非 gawk 解决方案中将 ARGIND < ARGC 替换为 FILENAME!=ARGV[ARGC] 。

有许多替代解决方案，这完全取决于您真正想要做什么......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T16:06:19.827

感谢 Ed 和 Zsolt 的帮助。最后，我决定改用 shell 脚本，因为除了`grep`命令之外，我还需要一个`sed`命令，因为它需要特殊的字符，所以会出现各种问题。所以我的最终解决方案如下：

```
fileList=`ls -1 *.xml`
for f in ${fileList} ; do
   my_year=`grep -e "key_word"  ${f} | sed -n '{s/^.*>\([0-9][0-9]*\)<.*$/\1/p}'`
   line=`ls -ltr ${f}`
   line="${line} ${my-year} sthElseHere"
   echo ${line}
done | \

awk ' BEGIN {print "File Name              \tcol02 \tcol03 "
             print "===================    \t====== \t============"}
            {printf "%s\t%s\t%s\n", $8, $4, $9  }' 
```

# html - 我可以重新设计所有 Bootstrap 元素的巨大“资产页面”吗？

> ID：15233089
> 
> 赞同：51
> 
> 时间：2013-03-05T20:05:58.313
> 
> 标签：html, css, web-applications, twitter-bootstrap, frontend

[http://twitter.github.com/bootstrap/base-css.html](http://twitter.github.com/bootstrap/base-css.html)

查看所有示例元素，例如`h1`, `h2`, `h3`,`inputs`等？

我正在寻找一个简单的网页，其中包含每个 Bootstrap `inputs/forms/elements/etc`，仅此而已。

然后我可以让我们的设计师用他自己的样式修改基础 CSS 文件，并且可以刷新资产页面以查看他的所有更改以及整个样式指南是如何形成的。

这对我们的团队来说非常有帮助，对我们的客户也很有帮助，这样他就可以在一个合并的页面上看到我们的整个“外观和感觉”。

这样的页面是否存在于任何地方？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-08-05T07:56:45.877

[在撰写本文时，这对于 BS3 http://bootply.com/render/71500](http://bootply.com/render/71500)来说是一个不错的选择

2013 年 12 月更新：Bootswatch 有一个定期更新的页面 [http://bootswatch.com/default/](http://bootswatch.com/default/)

2018 年 3 月更新：Bootswatch 已针对 BS4 进行了更新。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-01-10T14:19:57.340

**Bootstrap TLDR**在一页中包含所有组件： [https ://anvoz.github.io/bootstrap-tldr/](https://anvoz.github.io/bootstrap-tldr/)

它也在 Github 上： [https ://github.com/anvoz/bootstrap-tldr](https://github.com/anvoz/bootstrap-tldr)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-19T20:47:39.113

我一直在寻找类似的东西。我发现的最好的是这个网站，它还允许你在上面编辑 css。

[http://pikock.github.io/bootstrap-magic/app/index.html#!/editor](http://pikock.github.io/bootstrap-magic/app/index.html#!/editor)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-25T20:38:51.547

我有完全相同的需求，bootstrap 已经为你准备好了：

1) 访问[http://twitter.github.io/bootstrap/getting-started.html](http://twitter.github.io/bootstrap/getting-started.html)并下载 Bootstrap 源码

2）解压缩并导航到“less\tests”

3）在那里你会发现，正如 bootstrap 所说的那样“一站式快速调试和 CSS 边缘案例测试”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-01T22:42:43.667

我找不到一个，所以我创建了自己的。我基本上结合了文档的所有示例页面，并剥离了所有描述和代码。我还删除了一些重复项。

基于 Bootstrap v4.0.0-alpha.6

[https://github.com/gavsiu/bootstrap-demo](https://github.com/gavsiu/bootstrap-demo)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-16T16:47:17.727

您可以做的是自定义引导文档站点以使用您的样式表。它包含在（在 github 上的[https://github.com/twitter/bootstrap/blob/master/docs/index.html](https://github.com/twitter/bootstrap/blob/master/docs/index.html)上）的引导存储库中。

要使用不同的样式表，您需要更新 [https://github.com/twitter/bootstrap/blob/master/docs/templates/layout.mustache](https://github.com/twitter/bootstrap/blob/master/docs/templates/layout.mustache)以指向您的样式表：

```
<!-- Le styles -->
<link href="assets/css/bootstrap.css" rel="stylesheet">
<link href="assets/css/bootstrap-responsive.css" rel="stylesheet">
<link href="assets/css/docs.css" rel="stylesheet">
<link href="assets/js/google-code-prettify/prettify.css" rel="stylesheet">
<!-- add your stylesheet here to override --> 
```

然后使用：

```
$ node docs/build production 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-14T10:16:55.027

看看这里，完整的 CSS 和组件列表，以及一些解释和代码片段：

[http://codepen.io/letanure/full/WxwaZP/](http://codepen.io/letanure/full/WxwaZP/)

*几天前我需要同样的东西，没有找到我需要的东西，所以我创建了这个。*

*随机一段代码，因为如果发布到codepen的链接，stackoverflow需要*

```
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Bootstrap all elements</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.10/clipboard.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

</head>

<body> 
```

# continuous-integration - 表达式引擎持续集成 BDD

> ID：15233093
> 
> 赞同：2
> 
> 时间：2013-03-05T20:06:16.487
> 
> 标签：continuous-integration, bdd, expressionengine

我很好奇是否有人设置了 BDD、表达式引擎和持续集成并且可以分享他们的设置/方法？我听说有人将黄瓜与 ee 一起使用，但在实践中没有看到任何关于此的信息。

# python - 如何访问和更新嵌套字典？

> ID：15233094
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:06:16.847
> 
> 标签：python, list, nested, tuples, dictionary

如何访问嵌套字典中的这些键值？

```
word = {('o', 'm'): {'e': 3,'a': 1}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:09:15.250

你可以自己回答：

```
>>> # you don't have key and values in lists, that's why you should use a dict.
>>> word = {('o', 'm'): ['e': 3,'a': 1]}
SyntaxError: invalid syntax
>>> word = {('o', 'm'): {'e': 3,'a': 1}} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:08:37.200

这个：

```
['e': 3,'a': 1] 
```

不是有效的`list`or `dict`，如所写。如果您出于某种原因想要一个 dicts 列表，您必须编写：

```
[{'e': 3},{'a': 1}] 
```

但这些不如简单地使用字典，就像你的第二个例子一样。

* * *

> 如何访问嵌套字典列表中的这些键值？

现在，您将在访问第一个 dict 后得到另一个 dict，所以从

```
word = {('o', 'm'): {'e': 3,'a': 1}}
print word['o','m'].keys()
#['a', 'e']
print word['o','m']['e']
#3 
```

# jsf - 查看两个不同 portlet 之间的导航？

> ID：15233096
> 
> 赞同：2
> 
> 时间：2013-03-05T20:06:22.773
> 
> 标签：jsf, portlet, jsf-1.2, websphere-portal, jsr286

我正在WebSphere Portal 7 上使用JSF 1.2 开发JSR 286 portlet。我一直在尝试找到一种方法来在同一页面上的两个portlet 之间进行导航。本质上：

1.  单击 Portlet A 上的按钮。
2.  Portlet B 导航到不同的视图（基于来自 Portlet A 的信息），而 Portlet A 保持与之前相同的视图。

他们使用相同的源，所以我认为我可以通过使用 PhaseListener 和 portlet 命名空间 id 来完成此任务——我已经完成了一些工作，但我不禁认为必须有更好的方法来做这个。

在我继续沿着这条路线走之前，有谁知道我在两个 portlet 之间进行导航的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:32:10.263

我为使 portlet 进行通信所做的一项常见事情是使用事件。在您的情况下，您将设置 Portlet A 来发布您的 buttonClick 事件并设置 Portlet B 来处理 buttonClick 事件。在 Portlet B 中，您将设置一些渲染参数，然后在 doView 中使用它来根据需要更新 UI。您还需要在两个 portlet 之间创建一条连接线。

这是 IBM 关于 portlet 通信的文档的链接。那里可能有更多的想法更适合或给你更多的继续。

[http://www-10.lotus.com/ldd/portalwiki.nsf/xpDocViewer.xsp?lookupName=IBM+WebSphere+Portal+7+Product+Documentation#action=openDocument&res_title=Portlet_communication_wp7&content=pdcontent](http://www-10.lotus.com/ldd/portalwiki.nsf/xpDocViewer.xsp?lookupName=IBM+WebSphere+Portal+7+Product+Documentation#action=openDocument&res_title=Portlet_communication_wp7&content=pdcontent)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:29:50.737

查看[Liferay Faces Portlet Bridge 演示](http://www.liferay.com/community/liferay-projects/liferay-faces/demos)。

“JSF2 IPC（事件） - 客户”演示可能就是您正在寻找的。为什么你还在使用 JSF 1.2？即使在 WAS 7 上的 WebSphere Portal 7 上，您也可以使用 JSF 2.0。只需使用 Mojorra 库和 PARENT_LAST 类加载。

# tags - Soundcloud api：地理标签搜索不起作用

> ID：15233098
> 
> 赞同：5
> 
> 时间：2013-03-05T20:06:27.467
> 
> 标签：tags, soundcloud, geo

地理搜索标签似乎不起作用。我有一个应用程序已经运行了几个月没有任何变化。它最近坏了，在故障排除后，我发现地理标签搜索，无论是特定的还是带有通配符的，都没有返回任何结果。

```
$(document).ready(function() 
    { SC.initialize({  client_id: 'my id here'}); 
    SC.get("/tracks", {limit: 200, tags: 'geo:lon=-118.*'}, SearchTracks);

    });
var SearchTracks=function Search (tracks){
    for (var key in tracks)  
        {console.log(tracks[key].title+"   "+tracks[key].tag_list);
        }      
}; 
```

当我使用 geo:lat 和 geo:lon 的任何其他组合时，也会发生同样的情况。Soundcloud 的人可以发表评论吗？

# windows - 访问 24 位位图的像素，而不使用 GetPixel()？

> ID：15233099
> 
> 赞同：0
> 
> 时间：2013-03-05T20:06:39.407
> 
> 标签：windows, winapi, colors, bitmap, gdi

我目前正在寻找一种方法来访问和测试从目标窗口复制的位图的各个像素，而不使用非常慢的`GetPixel()`方法。鉴于`memDC`在调用时包含位图的副本`BitBlt()`，是否有更快的方法来遍历单个像素并测试它们的值？

```
HWND target = (HWND)0x0002051A; // this is just for debugging; when i get to the release version it will detect the intended window automatically
HBITMAP hBitmap;
RECT winRect;
HDC winDC, memDC;
winDC = GetDC(target);
GetClientRect(target, &winRect);
memDC = CreateCompatibleDC(winDC);
hBitmap = CreateCompatibleBitmap(winDC, winRect.right-winRect.left, winRect.bottom-winRect.top);
SelectObject(memDC, hBitmap);
BitBlt(memDC, 0, 0, winRect.right-winRect.left, winRect.bottom-winRect.top, winDC, 0, 0, SRCCOPY);
// Perform other tasks based on the color values of pixels...
ReleaseDC(memDC);
ReleaseDC(winDC);
DeleteObject(hBitmap); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:19:12.343

如果您使用创建目标位图，`CreateDIBSection`则可以访问原始像素，而不必通过`GetPixel`.

例如，如果`BITMAPINFO`您传递指定 32-bpp 图像（最简单的解释格式），您可以使用类似`*( ((LPDWORD)pBits) + ( y * width ) + x)`.

有关如何在内存中布置不同位深度格式的详细信息，请参阅文档`BITMAPINFOHEADER`，并记住 a) 位图行始终是 DWORD 对齐的，并且 b) 您需要传递负高度来创建自上而下的位图。

如果您不使用或无法使用`CreateDIBSection`，您可以使用[`GetDIBits`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144879%28v=vs.85%29.aspx)以您想要的 DIB 格式获取位图的内存副本。（确保在调用之前从任何 DC 中选择位图`GetDIBits`。）

# java - 在线音频播放器的搜索栏错误

> ID：15233100
> 
> 赞同：0
> 
> 时间：2013-03-05T20:06:39.557
> 
> 标签：java, android, audio

此代码不起作用，它显示应用程序没有响应。此代码在从远程服务器播放音频时工作正常，但是当我尝试在其上实现搜索栏时，它显示没有响应消息。

```
songProgressBar = (SeekBar) findViewById(R.id.songProgressBar);
    t1x = (TextView) findViewById(R.id.textView1);
    songTotalDurationLabel = (TextView) findViewById(R.id.textView2);
    utils = new Utilities();

    mediaPlayer = new MediaPlayer();
    mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
    try {
        mediaPlayer
                .setDataSource("http://url2.bollywoodmp3.se/murder3/%5BSongs.PK%5D%20Murder%203%20-%2001%20-%20Teri%20Jhuki%20Nazar.mp3");
        mediaPlayer.setOnPreparedListener(this);

        mediaPlayer.prepareAsync();

    } catch (IllegalArgumentException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (SecurityException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalStateException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    songProgressBar.setOnSeekBarChangeListener(this); // Important
    songProgressBar.setProgress(0);
    songProgressBar.setMax(100);
    mediaPlayer.setOnCompletionListener(this); // Important
    updateProgressBar();

    // this.setVolumeControlStream(AudioManager.STREAM_MUSIC);

}

@Override
public void onPrepared(MediaPlayer mp) {
    // TODO Auto-generated method stub

    mediaPlayer.start();
}

@Override
protected void onRestart() {
    super.onRestart();
    mediaPlayer.start();
} 
```

# java - 如何将数据保存到哈希表中 - java

> ID：15233102
> 
> 赞同：0
> 
> 时间：2013-03-05T20:06:55.813
> 
> 标签：java, hashtable

我有一个 Socket 服务器等待客户端以 json 格式发送消息。我不需要将数据存储到数据库中，但现在，我想将它们保存在哈希表中。因此，当客户端发送消息时，服务器会将其添加到哈希表中，而不会丢失之前的消息。

这是我的哈希表的声明：

```
private static Hashtable<Integer,String> table = new Hashtable<Integer,String>(); 
```

以下是称为消息到达服务器的方法：

```
 private void HashTable(String string){
    //JsonArray questions =  new JsonArray();
    //questions = string;
    //for(int i = 0; i < questions.length(); i++) {
        //JsonObject question = questions.getJsonObject(i);
        JSONObject jsonObj;
        try {
            jsonObj = new JSONObject(string);
            int id = jsonObj.optInt("DeviceID", -1);
            String name = jsonObj.toString();
            table.put(id, name);
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    //}
} 
```

上面的代码没有保留以前消息中的数据。有人可以给个提示吗？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:10:50.583

`int id = 1;`- 你永远不会改变它，所以你所做的只是每次都替换 ID 1 的条目。您需要一个唯一的 ID 生成器，或者只是在`id`每次添加条目时递增。

编辑：正如评论者正确指出的那样，你应该使用`HashMap`not `HashTable`，你*真的*不应该调用你的方法`Hashtable`......

编辑 2：好吧，您更改了代码示例，因此这不再准确，但现在发生的事情要么`DeviceID`不存在，要么`-1`您得到相同的设备 ID。当然，您说您想存储来自同一设备的多条消息，因此单独使用设备 ID 并不是您想要做的。您可能应该有某种消息 ID，最有可能在设备上生成，并以某种方式合并设备 ID 以帮助确保它是唯一的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:22:38.717

那是因为，当 Json 中的“DeviceId”为空时，您最终将始终使用相同的键“1”进行存储。因此它替换了旧值。

**解决方案**

```
private static AtomicInteger count = new AtomicInteger ; 
```

在您插入哈希表的地方适应

```
int id = jsonObj.optInt("DeviceID", count.addAndGet(1) ); 
```

# symfony - Symfony2 安装 FOSUserBundle 后，DoctrineFixturesBundle 寻找 User.orm.yml - 放入什么？

> ID：15233104
> 
> 赞同：0
> 
> 时间：2013-03-05T20:06:58.840
> 
> 标签：symfony, fosuserbundle

在我的 Symfony2 应用程序中，我使用了以下（以及其他）捆绑包：

应用程序/AppKernel.php

```
new FOS\UserBundle\FOSUserBundle(),
new Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle(), 
```

FOSUserBundle 工作正常，直到我添加了一些固定装置。现在，DoctrineFixturesBundle 正在寻找我的 User.php 的扩展

错误：MappingException：找不到名为“MyBundle/Resources/config/doctrine/User.orm.yml”的映射文件

我根据 FOSUserBundle 说明定义了用户类 -

User_class: 'MyBundle\Entity\User' 但只是剪切并粘贴了说明中的默认值——此时我不需要其他数据。

问题 - 我应该在哪里放什么，才能让这个项目重新开始工作？我尝试了一个空的 MyBundle/Resources/config/doctrine/User.orm.yml，我尝试了一个虚拟文件，我只是迷路了。

谢谢！

# - UFT

> ID：15233108
> 
> 赞同：0
> 
> 时间：2013-03-05T20:07:09.307
> 
> 标签：

统一功能测试 (UFT) 是 Micro Focus 的商业软件测试自动化工具。

# c# - .NET 智能卡 - 序列化/反序列化远程对象。输入流不是有效格式

> ID：15233119
> 
> 赞同：1
> 
> 时间：2013-03-05T20:07:51.443
> 
> 标签：c#, .net, serialization, smartcard, gemalto

我正在使用 .NET 智能卡，它具有与 .NET 远程处理相同的概念。

所以我的智能卡（作为服务器）有这个服务：

```
public class MyService : MarshalByRefObject
{
     string a = "abC";

    public byte[] MySampleMethod()
    {
        MyService obj = new MyService();
        return help.ObjectToByteArray( obj);
    }}} 
```

这是 ObjectToByteArray(obj)

```
public static byte[] ObjectToByteArray(MyService obj)
    {
        if (obj == null)
            return null;
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream ms = new MemoryStream(0);
        bf.Serialize(ms, obj);
        return ms.ToArray();
    } 
```

至于客户：

```
 public static void Main()
    {
        // create and register communication channel
        APDUClientChannel channel = new APDUClientChannel();
        ChannelServices.RegisterChannel(channel);

        // get the referenc to remote object
        MyService service = (MyService)Activator.GetObject(typeof(MyService), URL);

        // invoke the remote method
        byte[] result = service.MySampleMethod();

        MyService obj = ByteArrayToObject(result);

        Console.WriteLine(result[0]);
        Console.ReadLine();
        // unregister the communication channel
        ChannelServices.UnregisterChannel(channel);
    } 
```

字节数组对象

```
 public static MyService ByteArrayToObject(byte[] arrBytes)
    {
        MemoryStream memStream = new MemoryStream(0);
        BinaryFormatter binForm = new BinaryFormatter();
        memStream.Write(arrBytes, 0, arrBytes.Length);

        memStream.Seek(0, SeekOrigin.Begin);
        //memStream.Position = 0;
        MyService obj = (MyService)binForm.Deserialize(memStream);
        return obj;
    } 
```

问题是当我想反序列化对象时。

我测试这个字符串 "ABCDE" ，在卡片中序列化它，结果十六进制是：

> 1C-5D-D2-00-27-11-02-00-00-00-05-00-00-00-05-00-00-00-01-41-00-42-00-43-00- 44-00‌​-45-00

当我在我的电脑上序列化它时的结果是：

> 00-01-00-00-00-FF-FF-FF-FF-01-00-00-00-00-00-00-00-06-01-00-00-00-05-41-42- 43-44‌​-45-0B。

所以在我的 PC 应用程序上，反序列化第二个效果很好，但是当我反序列化第一个字符串（来自智能卡）时，我得到：

> “输入流不是有效的二进制格式。起始内容（以字节为单位）为：1C-5D-D2-00-27-11-02-00-00-00-05-00-00-00-05- 00-00 ...”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T08:00:03.610

Gemalto.NET 智能卡仅支持按引用编组，因此您在服务器中拥有的任何原始类型和结构类型都可以在客户端中访问，而无需序列化，因为您已经通过远程调用获得了对对象的引用：

所以首先注册你的服务：

```
public class MyServer
    {
        /// <summary>
        /// specify the exposed remote object URI.
        /// </summary>
        private const string REMOTE_OBJECT_URI = "MyService.uri";

        /// <summary>
        /// Register the server onto the card.
        /// </summary>
        /// <returns></returns>
        public static int Main()
        {
            // Register the channel the server will be listening to.
            ChannelServices.RegisterChannel(new APDUServerChannel());

            // Register this application as a server            
            RemotingConfiguration.RegisterWellKnownServiceType(typeof(MyService), REMOTE_OBJECT_URI, WellKnownObjectMode.Singleton);

            return 0;
        }
    } 
```

然后定义服务类，您可以为 gemalto 文档返回原始类型和结构：

> 可以编组的类型包括基本值类型（byte、short、char、int、long、string 等）、结构、基本类型的数组和 MemoryStreams

```
public class MyService : MarshalByRefObject
    {
        public struct Person
        {
            public string name;
            public int id;

            public Person(int id, string name)
            {
                this.name = name;
                this.id = id;
            }

            public string getName()
            {
                return this.name;
            }

            public int getId()
            {
                return this.id;
            }
        }

        public string MySampleMethod()
        {
            return "This is return String";
        }

        public Person getPerson()
        {
            Person person = new Person(15, "Wajdy");
            return person;
        }
    } 
```

现在在客户端应用程序中，您将拥有对服务对象的引用，并且您可以正常调用方法：

```
public class MyClient
    {
        private const string URL = "apdu://selfdiscover/MyService.uri";

        public static void Main()
        {
            // create and register communication channel
            APDUClientChannel channel = new APDUClientChannel();
            ChannelServices.RegisterChannel(channel);

            // get the referenc to remote object
            MyService service = (MyService)Activator.GetObject(typeof(MyService), URL);
            Console.WriteLine(service.MySampleMethod());

            MyService.Person person = service.getPerson();
            Console.WriteLine(person.getName());
            Console.WriteLine(person.getId());

            Console.ReadLine();

            // unregister the communication channel
            ChannelServices.UnregisterChannel(channel);
        }
    } 
```

# algorithm - 在 O(1) 中计算汉明权重

> ID：15233121
> 
> 赞同：24
> 
> 时间：2013-03-05T20:08:00.370
> 
> 标签：algorithm, bit-manipulation

在二进制表示中，汉明权重是 1 的个数。我在网上找到了一个 O(1) 的答案：

```
v = v - ((v>>1) & 0x55555555);
v = (v & 0x33333333) + ((v>>2) & 0x33333333);
int count = ((v + (v>>4) & 0xF0F0F0F) * 0x1010101) >> 24; 
```

但是我不太了解该算法，也无法在任何地方找到它的描述。有人可以稍微解释一下，尤其是最后一行（*0x1010101 然后 >> 24 到底是什么意思）？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-05T20:34:51.447

这是用于计数位的分而治之策略的一部分，称为“人口”功能。在 Reingold 和 Nievergelt，1977 中可以找到对这种策略的学术处理。

这个想法是首先对位求和，然后是 4 位，然后是 8 位，依此类推。例如，如果你有 bits `1011`，那么第一对`10`变成`01`因为有一个位，第二对变成`10`因为`10 = 2`在二进制中并且有两个位`11`。这里的基本事实是：

```
population(x) = x - (x/2) - (x/4) - (x/8) - (x/16) - ... etc. 
```

您拥有的确切算法是所谓的“HAKMEM”算法的变体（参见 Beeler、Gosper 和 Schroppel，1972 年）。该算法`1`并行计算 4 位字段中的 '，然后将这些和转换为 8 位和。最后一步是通过乘以将这 4 个字节相加的操作`0x01010101`。掩码通过`0x0F0F0F0F`屏蔽非总和信息来获得 4 位字节总和。例如，假设 8 位字段是`10110110`，那么有 5 位等于`0101`，因此我们将有`10110101`。只有最后四位是有效的，所以我们屏蔽了前四位，即：

```
10110101 & 0x0F = 00000101 
```

您可以在亨利·沃伦 (Henry Warren) 所著的《黑客的喜悦》(Hacker's Delight) 一书中找到有关计数细节的一整章。

# android - 添加新表后更新 ormlite_config.txt

> ID：15233125
> 
> 赞同：0
> 
> 时间：2013-03-05T20:08:10.843
> 
> 标签：android, ormlite

我需要通过添加新表来升级已发布应用程序的架构。我正在使用表配置文件（`ormlite_config.txt`）。

*   `ormlite_config.txt`将新表添加到架构后，有没有办法更新文件？我必须更新它吗？
*   或者也许可以实例化`OrmLiteSqliteOpenHelper`传递配置文件的更新版本 - 新表的描述尚不存在，但将在`onUpgrade()`调用中添加？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:14:42.740

不确定我是否理解这个问题。如果添加新表（或更改现有表的架构），则需要重新生成`ormlite_config.txt`文件。它不会自动发生。

如果配置文件中的架构发生更改，您将需要将代码添加到您的`onUpgrade()`方法中以调整任何正在运行的数据库。您还需要增加您的数据库版本，以便`onUpgrade()`完全调用。

有关更多信息，请参阅 Android 升级架构文档：

> [http://ormlite.com/docs/upgrade-schema](http://ormlite.com/docs/upgrade-schema)

# javascript - JavaScript 如何在内部表示 DateTime 值？

> ID：15233140
> 
> 赞同：4
> 
> 时间：2013-03-05T20:09:30.053
> 
> 标签：javascript

我正在开发一个使用 JavaScript 编写脚本的程序。像大多数脚本系统一样，有一个脚本可以调用的预定义本机函数库，我刚刚添加了一个新函数。

新函数接受一个 DateTime（它在 Delphi 中，其中 DateTime 在内部由一个 Double 表示）、一个字符串和一个布尔值。最后两个参数通过就好了，但似乎在系统的某个地方，时间值被破坏了。我得到的不是可识别的 DateTime，`1362394800000`根据 Delphi 的时间戳方案，这没有任何意义。

我在哪里可以找到有关 JavaScript 如何表示 DateTime 值的信息，以便弄清楚如何将其转换为我的 Delphi 代码可以使用的东西？（这是使用 Windows 7 标配的 Microsoft 的 JScript 系统，以防实现方式发生变化。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T20:12:15.263

JavaScript 将 Date 对象表示为自 Epoch 以来的*毫秒数。*这很重要，因为大多数其他系统和语言只使用整数秒。

所以假设 Delphi 是这样的第二个用户，你应该能够将这个数字除以 1000 并传递它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:12:47.237

它存储为自 1/1/1970 00:00:00.000 以来的毫秒数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:14:42.757

JavaScript[`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)值在内部表示为自[unix epoch](http://en.wikipedia.org/wiki/Unix_time)以来的毫秒数；这就是您通过使用`.getTime()`将对象转换为数字而获得的值。

# php - 尝试创建友好的 URL 但失败了？

> ID：15233141
> 
> 赞同：0
> 
> 时间：2013-03-05T20:09:41.117
> 
> 标签：php, .htaccess, mod-rewrite, friendly-url, seo

我能够创建一个唯一的 URL`[http://site.com/pod.php?id=20](http://site.com/pod.php?id=20)`

通过 php 和 htaccess 尝试不同的方法来重写 URL 时，我遇到了 404 错误。

我在数据库中有不同的字段，我想使用这些字段来构建 URL 并使其对 SEO 友好。这些字段将是名称、位置和类别。URL应该是这样的`[http://site.com/name/location](http://site.com/name/location)`

我真正要问的是我该如何做到这一点？例子会很棒。

我在下面使用的文件：

content.php 的一部分

```
 while($row = mysql_fetch_array($retval, MYSQL_ASSOC))
{
echo "<div class=\"pods\">";
echo "<a href=\"/pod.php?id={$row['id']}\">";
echo "<div class=\"podHeading\">";  
echo "{$row['heading']}</a> <br> ";
echo "</div>";
echo "<div class=\"podImage\">";    
echo "<img src=\"images/{$row['imageName']}\">";
echo "</div>";

$string = "{$row['text']}";
if(strlen(htmlspecialchars_decode($string)) > 100) {
echo substr(htmlspecialchars_decode($string), 0, 100).'...'.$hyperlink;}
else {
echo htmlspecialchars_decode($string);
} 
```

豆荚.php：

```
<?php
$connect = mysql_connect('x', 'x', 'x');
$select_db = mysql_select_db('x');

$id = mysql_real_escape_string($_GET['id']);
$query = 'SELECT * FROM podContent WHERE id = '.$id.' LIMIT 1';
$result = mysql_query($query);
$row = mysql_fetch_array($result);

// Echo page content
echo "<div class=\"podPageContainer\">";
echo "<div class=\"podPageContent\">";
echo "<div class=\"podPageHeading\">";
echo $row['heading'];
echo "</div>\n";
echo "<br/>";
echo $row['text'];
echo "</div>\n"; 
echo "</div>\n";
echo "<div class=\"pageSidebar\">";
include('ads/sidebarAds.php');
echo "</div>\n";
?> 
```

.htaccess

```
RewriteCond %{THE_REQUEST} ^.*/index.php
RewriteRule ^(.*)index.php$ http://www.site.com/$1 [R=301,L]  

Options +FollowSymlinks
RewriteEngine On 
```

非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:29:18.403

你需要的是对你的htaccess

将您的 rewriteRule 更改为此

^[a-zA-Z0-9-_]/[a-zA-Z0-9-_]$ [http://www.site.com/index.php?name=](http://www.site.com/index.php?name=) $1&location=$2

因此您可以通过 $_Get 方法获取名称和位置

# ruby - Rally：父（递归）通知

> ID：15233142
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:09:44.277
> 
> 标签：ruby, notifications, rally

在 Rally 中，我们使用父链来跟踪“史诗”和“主题”故事下的用户故事工作项。（并不少见，我敢肯定）。Rally 的内置通知系统虽然灵活，但不够灵活。如果用户更改了一个故事，当 Rally 在其父层次结构中传播该更改时，我们会收到邮件轰炸。

所以，我想创建自己的通知流程，只通知用户直接修改的项目。据我目前所知，Rally 没有将传播更新与直接（用户在 Rally Web 客户端键入）更新区分开来。

有谁知道是否有一种程序化的方式来检测这个？

（注意，如果可以解决这个问题，我最终会使用 Rally 的 Ruby 框架来编写代码）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:14:40.460

您当然可以使用 rally_api Ruby 工具包编写一个应用程序来查询 LastUpdateDate 满足特定标准（可能由您的集成运行的时间间隔决定）的所有故事。您还可以应用自己的各种查询过滤器来缩小通知结果列表的范围 - 包括检查 DirectChildrenCount 和 Parent 字段以查看项目所在的层次结构中的位置。

您可以从那里向收件人列表发送通知电子邮件。

我仍然鼓励您探索微调您现有的通知过滤器，因为构建和维护这样的连接器可能很麻烦，特别是如果有许多用户希望应用不同的通知规则。

# php - 使用 PHP 将基于另一个值的值插入 MYSQL

> ID：15233145
> 
> 赞同：0
> 
> 时间：2013-03-05T20:09:50.333
> 
> 标签：php, mysql

在棘手的情况下，我需要一些帮助。

目前我有一个看起来像这样的数组

```
Array
(
[0] => Array
    (
        [Task_ID] => 59
        [email] => m@m.com
    )

[1] => Array
    (
        [Task_ID] => 59
        [email] => m@m.com
    )

[2] => Array
    (
        [Task_ID] => 59
        [email] => z@z.com
    )

[3] => Array
    (
        [Task_ID] => 60
        [email] => m@m.com
    )

[4] => Array
    (
        [Task_ID] => 60
        [email] => z@z.com
    )

[5] => Array
    (
        [Task_ID] => 61
        [email] => z@z.com
    )

) 
```

这是我当前的插入语句。

```
 if(is_array($myArr)){
        $valuesArr = array();
        foreach($myArr as $row){

            $sql = "INSERT INTO user_data (Task_ID, email, url) values ";
            $TaskID = (int) $row['Task_ID'];
            $email = mysql_real_escape_string( $row['email'] );

            $valuesArr[] = "('$TaskID', '$email')";
            $sql .= "('$TaskID', '$email')";
            mysql_query($sql) or exit(mysql_error());
        }
    } 
```

我想做的是插入一个不在数组中的新值，即 URL 值。

对于 URL，我想为每封唯一的电子邮件增加一个数字，其中相同的电子邮件将获得相同的 URL 值。

SQL 语法应该是什么样子的示例。

```
INSERT INTO user_data (TaskID, email, url) values ('60', 'm@m.com','1')
INSERT INTO user_data (TaskID, email, url) values ('80', 'm@m.com','1')
INSERT INTO user_data (TaskID, email, url) values ('82', 'z@z.com','2')
INSERT INTO user_data (TaskID, email, url) values ('62', 'z@z.com','2')
INSERT INTO user_data (TaskID, email, url) values ('42', 'z@z.com','2')
INSERT INTO user_data (TaskID, email, url) values ('61', 'a@a.com','3')
INSERT INTO user_data (TaskID, email, url) values ('81', 'a@a.com','3')
INSERT INTO user_data (TaskID, email, url) values ('92', 't@t.com','4')
INSERT INTO user_data (TaskID, email, url) values ('32', 't@t.com','4')
INSERT INTO user_data (TaskID, email, url) values ('72', 't@t.com','4') 
```

请注意，每更改一次电子邮件，URL 就会增加 1。请注意，TaskID 不是 PK 并且电子邮件不按顺序排列。

感谢您的阅读，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:14:27.587

试试看

```
if (is_array($myArr)) {
    $valuesArr = array();
    $addedEmails = array();

    $cnt = 0;
    foreach($myArr as $row){

        $sql = "INSERT INTO user_data (Task_ID, email, url) values ";
        $TaskID = (int) $row['Task_ID'];
        $email = mysql_real_escape_string( $row['email'] );

        if (!in_array($email, $addedEmails)) {
            $cnt++;
            $addedEmails[] = $email;
        }

        $valuesArr[] = "('$TaskID', '$email', '$cnt')";
        $sql .= "('$TaskID', '$email', '$cnt')";
        mysql_query($sql) or exit(mysql_error());
    }
} 
```

# ios - 使用 UIRefreshControl 在 TableView 中替换标题

> ID：15233147
> 
> 赞同：29
> 
> 时间：2013-03-05T20:09:51.323
> 
> 标签：ios, objective-c, uitableview, uirefreshcontrol

我的 UIRefreshController 正在做一些奇怪的事情。当我下拉刷新时，tableView 标题被替换。

如果我下拉它看起来不错，但如果我在刷新器仍在工作时向下滚动表格，则标题会被刷新控件的高度偏移，而 UITableCells 很好并滚动到标题后面。

![http://oi49.tinypic.com/2a8hqti.jpg](../Images/53d32186b7f5347d9330c58b32bea533.png)

![http://oi46.tinypic.com/acssrb.jpg](../Images/a8c77be068058b0f29f6802c2deafd88.png)

我想避免创建 tableViewController，所以我在 viewDidLoad 中执行以下操作：

```
_refreshControl = [[UIRefreshControl alloc] init];
[_refreshControl addTarget:self action:@selector(refresh) forControlEvents:UIControlEventValueChanged];
[_tableView addSubview:_refreshControl]; 
```

我在需要此功能的不同视图控制器中有很多表。有什么办法可以避免为每个人制作一个 UITableViewController 吗？

万分感谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-05T21:40:22.763

这可能是一个问题，因为您添加`_refreshControl`的是不应该完成的子视图。但是，您可以创建一个`UITableViewController`对象，将其添加为当前视图控制器类的子视图控制器。

例如：-

```
UITableViewController *tableViewController = [[UITableViewController alloc] initWithStyle:UITableViewStylePlain];
[self addChildViewController:tableViewController];

tableViewController.refreshControl = [[UIRefreshControl alloc] init];
[tableViewController.refreshControl addTarget:self action:@selector(refresh:) forControlEvents:UIControlEventValueChanged];
tableViewController.tableView.frame = CGRectMake(...);//set the frame here
[self.view addSubview:tableViewController.tableView]; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-09-25T08:24:12.507

一个快速的解决方法是像这样

## Objective-C

```
//header
@property UITableViewController *tableController;

//.m (right at the beginning of viewDidLoad for example)
self.tableController = [[UITableViewController alloc] init];
[self addChildViewController:self.tableController];
self.tableController.tableView = self.tableView;

...

//then create the refresh control and assign it to the UITableViewController
self.tableController.refreshControl = refreshControl; 
```

## 斯威夫特 2.1

```
//Create an instance of a UITableViewController. This will host your UITableView.
private let tableController = UITableViewController()

//Add tableController as a childViewController and set its tableView property to your UITableView.
self.addChildViewController(self.tableController)
self.tableController.tableView = self.tableView
self.refreshControl.addTarget(self, action: "refreshData:", forControlEvents: .ValueChanged)
self.tableController.refreshControl = self.refreshControl 
```

如果您将表连接到 IBOutlet 并且将其他内容链接到您不想弄乱的情节提要中，这将有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:53:44.587

`UIRefreshControl`'s 并不意味着是子视图，它们意味着（字面上）是表的刷新控件。 `UITableViewController`有一个专门为他们提供的插座（同样，字面意思是[refreshControl](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewController/refreshControl)），您应该使用它。作为表格的子视图，您可能会导致表格假定它是一个单元格，而不仅仅是一个子视图，这会强制围绕它重新计算。在某些情况下，您确实很幸运，并且控件可能会将自己设置在正确的位置，但这又是未定义行为的结果。

UITableViewController 并不意味着是一个限制类，它当然不应该阻止您实现“多个表视图”（这听起来足够特定于上下文，以至于无论如何都需要一个新的视图控制器）。如果您担心必须为每个类编写样板，请为您要实现的每个表视图编写一个抽象超类控制器，并根据需要对其进行子类化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-05T12:57:29.993

@available(iOS 10.0, *)

tableView.refreshControl = refreshControl

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-25T05:14:02.350

尝试这种方式来添加推送视图控制器。

创建一个表视图控制器并将其添加为现有视图控制器的子视图。然后将您的表视图和刷新控制器分配给表视图控制器的属性。

```
UITableViewController *newTableViewController = [[UITableViewController alloc] init];
newTableViewControler.tableView = <yourTableView>;

<yourRefreshController> = [[UIRefreshControl alloc] init];
[<yourRefreshController> addTarget:self
                            action:@selector(refreshTableView:)
                  forControlEvents:UIControlEventValueChanged];

newTableViewController.refreshControl = _chatListRefreshControl;
[self addChildViewController:newTableViewController]; 
```

# c - MinGW 中的 crypt()

> ID：15233153
> 
> 赞同：2
> 
> 时间：2013-03-05T20:10:12.450
> 
> 标签：c, mingw

如何在使用 MinGW 编译的 Windows 上使用 crypt()？我看到它有 lib，但它不识别函数和 crypt.h 标头，如果我使用 windows.h，我会遇到一堆错误，如“未知类型名称 BOOL”、“未知类型名称 DWORD”等。

# php - 在 Highcharts 中添加系列时，Javascript 循环未通过 sqlite_fetch_array() 设置 PHP 值

> ID：15233163
> 
> 赞同：0
> 
> 时间：2013-03-05T20:10:59.710
> 
> 标签：php, javascript, sqlite, highcharts, linechart

我有一个 SQLite 数据库，正在尝试使用 Highcharts、PHP 和 Javascript 在折线图上绘制数据。我正在为每个用户绘制一个系列（一个用户是每个元组的文本值），但是在通过 PHP 循环检索后续用户时遇到了麻烦。

```
$dbhandle = sqlite_open('db/test.db', 0666, $error);

if (!$dbhandle) die ($error);
$query5 = "SELECT DISTINCT User FROM Events";

$ok0 = sqlite_query($dbhandle, $query5, $error_msg);

if (!$ok0) 
{
    die("dead" . $error_msg);
}
$rows = sqlite_num_rows($ok0);

echo 
"for(var i=2; i<$rows; i++) // start of JS loop. 
                           //$rows is 4; I am graphing 2 series here
{";

  $array = sqlite_fetch_array($ok0, SQLITE_ASSOC); // $ok0 is the unique list
// of users. After graphing one series, I want to grab the next user to graph

        echo "chart.addSeries({
                name: '{$array["User"]}',
                data: [";
          for($i=0; $i<$diff+1; $i++)
          {
            $target = date("D, j M", (strtotime($_GET["start"]) + $i * 24 * 3600));
            $query6 = "SELECT * FROM Events WHERE User = '{$array["User"]}' AND Start LIKE '%{$target}%'";
            $result6 = sqlite_query($dbhandle, $query6);
            if (!$result6) die("Cannot execute query.");
            $num = sqlite_num_rows($result6);            
            if($i==($diff))
            {
              echo $num;
            }              
            else
              echo $num . ", ";
          }?>],

                pointStart: 

                 <?php
$date = DateTime::createFromFormat('D M d Y', urldecode($_GET["start"])); 
echo $date->getTimestamp()*1000;?>,
            pointInterval: 24 * 3600 * 1000 // one day

              });
      <?php echo "}";?> // end of JS loop 
```

结果确实绘制了另外两个系列，但它们都是来自同一用户的相同数据。它看起来不像带有 sqlite_fetch_array() 的循环正确返回下一个用户。任何人都可以在这里看到问题吗？也许与我将 Javascript 与 PHP 集成的方式有关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:03:17.397

这行代码每次调用时总是做同样的事情：

```
$query6 = "SELECT * FROM Events WHERE User = '{$array["User"]}' AND Start LIKE '%{$target}%'"; 
```

`$array`据说有一个不同用户的列表，但您没有显示`$ok0`. 您正在此循环中进行用户查找`for($i=0; $i<$diff+1; $i++)`，但在确定要获取哪个用户时没有使用这些变量。

我想发布从 中查找下一个用户的正确方法`$array`，但我不知道结构是什么。如果您不知道如何使您`$query6`对每个用户都独一无二，您将不得不发布更多信息，例如`var_dump`of`$array`或查询文本`$ok0`。

也许你只需要`$array = sqlite_fetch_array($ok0, SQLITE_ASSOC);`在你的`for`循环中移动这条线，但是你会冒着`$i`不`$diff+1`同意结果中可用的行数的风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:01:47.050

我已经想通了。我相信由于 PHP 在服务器端执行，当浏览器执行 Javascript 时，回显的 Javascript 循环中的代码块会产生相同的值。服务器简单地回显代表 js 循环的字符串，然后运行代码块。当所有内容都发送到浏览器时，Javascript 将正常循环并简单地将代码块的结果输出两次。我刚刚通过 PHP 放弃了 JS 循环，并将其替换为 PHP 循环。

# google-app-engine - 为什么没有指定父级时 db.Model.get_by_id() 返回 None ？

> ID：15233166
> 
> 赞同：1
> 
> 时间：2013-03-05T20:11:06.137
> 
> 标签：google-app-engine, google-cloud-datastore

我在 GAE 交互式控制台 (/_ah/admin/interactive) 中运行以下代码，我不明白为什么 get_by_id() 在未指定父级时返回 None。文档没有明确说明这个限制，我想不出强制执行它的理由。

```
import my_model
print my_model.all().fetch(1)[0].key().id()  # Returns 33006, used later
print my_model.get_by_id(33006)
print my_model.get_by_id(my_model.all().fetch(1)[0].key().id())

parent = my_model.all().fetch(1)[0].parent()
print my_model.get_by_id(33006, parent=parent) 
```

输出：

```
33006
None
None
<my_model object at 0x109a6a690> 
```

db.Model 定义和代码显示使用祖先创建对象：

```
class my_model(db.Model):
    user_id = db.StringProperty(indexed=True)
    email = db.StringProperty(indexed=True, default=None)

    def create(parent):
        obj = my_model(user_id='x', email='y', parent=parent)
        obj.put() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:28:02.987

您的问题的答案是：因为相同的 ID 可能在另一个实体中但具有不同的父级。

对于同一个父级或所有没有父级的实体，ID 将完全不同，但如果有祖先，那么您的数字 ID 不是唯一的。

# macos - 从 9.1.4 更新 Postgres

> ID：15233169
> 
> 赞同：0
> 
> 时间：2013-03-05T20:11:37.807
> 
> 标签：macos, postgresql

我尝试运行 Postgres 的 homebrew install ，看起来它安装的 9.1.4 与我的新 Mac 10.8 系统相同。在我运行命令 brew install postgresql 并运行 initdb /usr/local/var/postgres -E utf8

我检查了版本。

```
psql --version
psql (PostgreSQL) 9.1.4

which psql
/usr/local/bin/psql 
```

这在我看来就像它安装的版本与最初在 /usr/bin/ 中的版本相同

我试图让它运行看起来像 9.2.2 的最新版本我在这里缺少什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T05:45:27.017

您可能需要签入`/Library/PostgreSQL/`并查看此目录是否存在。据我了解，Homebrew 通常会将 PostgreSQL 安装到该路径中。如果是这种情况，您的 PostgreSQL 版本可能比您想象的要新，设置`PATH`envar 将解决问题。

如果是这种情况，您将希望将系统设置为仅启动其中一个数据库，或者如果它同时启动，则将它们设置在不同的端口上。

# javascript - node.js 最大调用堆栈超出错误

> ID：15233171
> 
> 赞同：0
> 
> 时间：2013-03-05T20:11:46.573
> 
> 标签：javascript, node.js

## 我正在学习节点，这是一个简单的发出递归

```
var events = require('events'),timers = require('timers');
var EventEmitter = require('events').EventEmitter,
       util = require('util');
//class initi
var myt = function() 
{
}
util.inherits(myt, EventEmitter);

myt.prototype.fnc = function(c) 
{
  console.log(c + ":send custom");this.emit('tick recv',c); 
 }

var Ticker = new myt();
Ticker.on('tick recv',function(c)  
{
  console.log(c + ':got custom');
})

Ticker.tick = function(c) 
{
Ticker.fnc(c);
timers.setTimeout(Ticker.tick(c+1), 100);
 }

 Ticker.tick(0); 
```

* * *

我收到“RangeError：超出最大调用堆栈大小”错误（而且超时似乎不起作用”）。似乎有一些基本错误。有人能发现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:14:57.270

你在`Ticker.tick()`里面无条件地打电话`Ticker.tick()`。我想你的意思是：

```
Ticker.tick = function(c) 
{
  Ticker.fnc(c);
  timers.setTimeout(function() { Ticker.tick(c+1); }, 100);
} 
```

第一个参数`setTimeout()`应该是一个函数；在您的代码中，您传递了调用函数的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:19:20.693

您应该将函数`setTimeout`传递给并将函数的参数作为 的第三个、第四个等参数传递`setTimeout`，如下所示：

```
Ticker.tick = function(c) {
  Ticker.fnc(c);
  timers.setTimeout(Ticker.tick, 100, c+1);
} 
```

# c# - 查询记录+前后6行？

> ID：15233172
> 
> 赞同：1
> 
> 时间：2013-03-05T20:11:46.933
> 
> 标签：c#, winforms, linq-to-sql

我希望能够查询一个包含正确记录的子集，然后查询前后 6 个，总共 13 行，并将它们显示在 DGV 中。拉取正确行的查询如下：

```
private void textBox6_Leave(object sender, EventArgs e)
    {
        DataClasses3DataContext db = new DataClasses3DataContext();

        var matchedAdd = (from c in db.GetTable<prop>()
                          where c.HOUSE_NO.Contains(textBox1.Text) && c.Direction.Contains(textBox2.Text) && c.street.Contains(textBox3.Text) && c.SUFF.Contains(textBox4.Text)
                          select c).SingleOrDefault();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:45:56.207

如果 PARCEL 号码在增加，则使用您的查询来检索包裹号码。

然后：

```
var before = (from c in db.GetTable<prop>()
                      where c.PARCEL < retrievedParcelNumber orderby c.PARCEL descending 
                      select c).Take(6);

var after = (from c in db.GetTable<prop>()
                      where c.PARCEL > retrievedParcelNumber orderby c.PARCEL
                      select c).Take(6); 
```

# search - 使用 JSON 参数的搜索字段值

> ID：15233173
> 
> 赞同：0
> 
> 时间：2013-03-05T20:11:53.970
> 
> 标签：search, input, field

我正在尝试使用我的搜索框“地址”的值作为此代码中的“标签”参数：

```
var args = {tags: document.getElementById('address').value, tagmode: "any", format:   "json"};

$.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?", args,
function flikr(data ) {
  $.each(data.items, function(i,item){
    $("<img/>").attr("src", item.media.m).appendTo("#test");
    if ( i == 3 ) return false;
  });
}); 
```

但是，无论标签如何，flikr 都会返回照片。

在控制台中，

```
args 
```

返回：

```
Object {tags: "", tagmode: "any", format: "json"} 
```

和，

```
args =  { tags: document.getElementById('address').value, tagmode: "any", format: "json"} 
```

返回：

```
Object {tags: "london", tagmode: "any", format: "json"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:15:11.647

```
 var search = document.getElementById('#address').value; 
```

“磅”符号用于使用 jQuery 选择 id。删除它即可获胜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:17:04.543

如果您的问题是“为什么它不起作用”，那可能是因为您的 JavaScript 错误。第 3 行应该是

```
var search = document.getElementById('address').value; 
```

如果你真的想使用英镑：

```
var search = document.querySelector('#address').value; 
```

# shell - ksh：如何在脚本之间传递包含空格的参数？

> ID：15233177
> 
> 赞同：1
> 
> 时间：2013-03-05T20:12:16.680
> 
> 标签：shell, ksh

我有两个脚本（一个 ksh 和另一个 Perl），一个调用另一个。当有人不小心在文件名中输入空格并将其报告为错误时（仅当文件不存在时），我必须处理这种情况。看起来用于`$*`将所有参数传递/转发给 p.pl 的 p.sh 没有按应有的方式处理带引号的参数？任何想法如何解决这一问题？假设一个人也可以在文件名中输入多个空格。

**p.sh：**

```
#!/usr/bin/env ksh
/tmp/p.pl $* 1>/tmp/chk.out 2>&1
print "Script exited with value $?"
print "P.PL OUTPUT:"
cat /tmp/chk.out
exit 0 
```

**p.pl：**

```
#!/usr/bin/perl -w
use Getopt::Std; 

getopts ("i:", \ %options);

if ($options{i} && -e $options{i}) {
  print "File $options{i} Exists!\n";
} 
else {
  print "File $options{i} DOES NOT exist!\n";
} 
```

测试用例（当系统上有一个实际文件'/tmp/a b.txt'（其中有一个空格）时）：

```
[test] /tmp $ p.pl -i /tmp/a b.txt
File /tmp/a DOES NOT exist!
[test] /tmp $ p.pl -i "/tmp/a b.txt"
File /tmp/a b.txt Exists!
[test] /tmp $ ./p.sh -i "/tmp/a b.txt"
Script exited with value 0
P.PL Check OUTPUT:
File /tmp/a DOES NOT exist!
[test] /tmp $ ./p.sh -i "/tmp/ a b.txt"
Script exited with value 0
P.PL Check OUTPUT:
File /tmp/ Exists! 
```

这是我试图修复的最后两个场景。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:14:14.010

要保留传递到脚本中的空格，请使用以下`$@`参数：

```
/tmp/p.pl "$@" 1>/tmp/chk.out 2>&1 
```

引号是必要的，以确保引用的空格被`p.pl`.

# ios - 带有粘性标题的 UICollectionView

> ID：15233180
> 
> 赞同：35
> 
> 时间：2013-03-05T20:12:35.287
> 
> 标签：ios, objective-c, uicollectionview, uicollectionviewlayout

[我找到了一个关于如何制作粘性标题的博客](http://blog.radi.ws/post/32905838158/sticky-headers-for-uicollectionview-using#notes)，它的效果很好。唯一的问题是我认为它没有考虑到 sectionInserts。

这是它的预期外观：

![在此处输入图像描述](../Images/af1648189ddeb7f987c4ca022f0bd66a.png)

我有我的插入：

```
collectionViewFlowLayout.sectionInset = UIEdgeInsetsMake(16, 16, 16, 16); 
```

使用粘性标题，它向下移动了 16 个像素：

![在此处输入图像描述](../Images/c091712f235550055701f4e52bc2aa01.png)

我尝试修改原始代码，我认为问题出在最后一部分：

```
layoutAttributes.frame = (CGRect){
    .origin = CGPointMake(origin.x, origin.y),
    .size = layoutAttributes.frame.size 
```

如果我将其更改为`origin.y - 16`，标题将从正确的位置开始，但是当向上推时，头部的 16 个像素会离开屏幕：

![在此处输入图像描述](../Images/f7bc29dbfe4b23189a810b8b17876953.png)

我不知道如何让它考虑到sectionInsects。有人可以帮忙吗？

以下是博客中的完整代码：

```
- (NSArray *) layoutAttributesForElementsInRect:(CGRect)rect {

    NSMutableArray *answer = [[super layoutAttributesForElementsInRect:rect] mutableCopy];
    UICollectionView * const cv = self.collectionView;
    CGPoint const contentOffset = cv.contentOffset;

    NSMutableIndexSet *missingSections = [NSMutableIndexSet indexSet];
    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {
        if (layoutAttributes.representedElementCategory == UICollectionElementCategoryCell) {
            [missingSections addIndex:layoutAttributes.indexPath.section];
        }
    }
    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {
        if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {
            [missingSections removeIndex:layoutAttributes.indexPath.section];
        }
    }

    [missingSections enumerateIndexesUsingBlock:^(NSUInteger idx, BOOL *stop) {

        NSIndexPath *indexPath = [NSIndexPath indexPathForItem:0 inSection:idx];

        UICollectionViewLayoutAttributes *layoutAttributes = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader atIndexPath:indexPath];

        [answer addObject:layoutAttributes];
    }];

    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {

        if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {

            NSInteger section = layoutAttributes.indexPath.section;
            NSInteger numberOfItemsInSection = [cv numberOfItemsInSection:section];

            NSIndexPath *firstCellIndexPath = [NSIndexPath indexPathForItem:0 inSection:section];
            NSIndexPath *lastCellIndexPath = [NSIndexPath indexPathForItem:MAX(0, (numberOfItemsInSection - 1)) inSection:section];

            UICollectionViewLayoutAttributes *firstCellAttrs = [self layoutAttributesForItemAtIndexPath:firstCellIndexPath];
            UICollectionViewLayoutAttributes *lastCellAttrs = [self layoutAttributesForItemAtIndexPath:lastCellIndexPath];

            CGFloat headerHeight = CGRectGetHeight(layoutAttributes.frame);
            CGPoint origin = layoutAttributes.frame.origin;
            origin.y = MIN(
                MAX(
                    contentOffset.y,
                    (CGRectGetMinY(firstCellAttrs.frame) - headerHeight)
                ),
                (CGRectGetMaxY(lastCellAttrs.frame) - headerHeight)
            );

            layoutAttributes.zIndex = 1024;
            layoutAttributes.frame = (CGRect){
                .origin = origin,
                .size = layoutAttributes.frame.size
            };
        }
    }

    return answer;
} 
```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2016-08-23T08:48:51.557

iOS 9 + 最简单的解决方案，因为它不需要编写 UICollectionViewFlowLayout 的子类。

在带有 collectionView 的 viewController 的 viewDidLoad 中，使用以下代码：

```
let layout = collectionView.collectionViewLayout as? UICollectionViewFlowLayout // casting is required because UICollectionViewLayout doesn't offer header pin. Its feature of UICollectionViewFlowLayout
layout?.sectionHeadersPinToVisibleBounds = true 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-03-28T18:53:57.200

由 Todd Laney 修复以处理水平和垂直滚动并考虑 sectionInsets：

[https://gist.github.com/evadne/4544569](https://gist.github.com/evadne/4544569)

```
@implementation StickyHeaderFlowLayout

- (NSArray *) layoutAttributesForElementsInRect:(CGRect)rect {

    NSMutableArray *answer = [[super layoutAttributesForElementsInRect:rect] mutableCopy];

    NSMutableIndexSet *missingSections = [NSMutableIndexSet indexSet];
    for (NSUInteger idx=0; idx<[answer count]; idx++) {
        UICollectionViewLayoutAttributes *layoutAttributes = answer[idx];

        if (layoutAttributes.representedElementCategory == UICollectionElementCategoryCell) {
            [missingSections addIndex:layoutAttributes.indexPath.section];  // remember that we need to layout header for this section
        }
        if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {
            [answer removeObjectAtIndex:idx];  // remove layout of header done by our super, we will do it right later
            idx--;
        }
    }

    // layout all headers needed for the rect using self code
    [missingSections enumerateIndexesUsingBlock:^(NSUInteger idx, BOOL *stop) {
        NSIndexPath *indexPath = [NSIndexPath indexPathForItem:0 inSection:idx];
        UICollectionViewLayoutAttributes *layoutAttributes = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader atIndexPath:indexPath];
        if (layoutAttributes != nil) {
            [answer addObject:layoutAttributes];
        }
    }];

    return answer;
}

- (UICollectionViewLayoutAttributes *)layoutAttributesForSupplementaryViewOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewLayoutAttributes *attributes = [super layoutAttributesForSupplementaryViewOfKind:kind atIndexPath:indexPath];
    if ([kind isEqualToString:UICollectionElementKindSectionHeader]) {
        UICollectionView * const cv = self.collectionView;
        CGPoint const contentOffset = cv.contentOffset;
        CGPoint nextHeaderOrigin = CGPointMake(INFINITY, INFINITY);

        if (indexPath.section+1 < [cv numberOfSections]) {
            UICollectionViewLayoutAttributes *nextHeaderAttributes = [super layoutAttributesForSupplementaryViewOfKind:kind atIndexPath:[NSIndexPath indexPathForItem:0 inSection:indexPath.section+1]];
            nextHeaderOrigin = nextHeaderAttributes.frame.origin;
        }

        CGRect frame = attributes.frame;
        if (self.scrollDirection == UICollectionViewScrollDirectionVertical) {
            frame.origin.y = MIN(MAX(contentOffset.y, frame.origin.y), nextHeaderOrigin.y - CGRectGetHeight(frame));
        }
        else { // UICollectionViewScrollDirectionHorizontal
            frame.origin.x = MIN(MAX(contentOffset.x, frame.origin.x), nextHeaderOrigin.x - CGRectGetWidth(frame));
        }
        attributes.zIndex = 1024;
        attributes.frame = frame;
    }
    return attributes;
}

- (UICollectionViewLayoutAttributes *)initialLayoutAttributesForAppearingSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewLayoutAttributes *attributes = [self layoutAttributesForSupplementaryViewOfKind:kind atIndexPath:indexPath];
    return attributes;
}
- (UICollectionViewLayoutAttributes *)finalLayoutAttributesForDisappearingSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewLayoutAttributes *attributes = [self layoutAttributesForSupplementaryViewOfKind:kind atIndexPath:indexPath];
    return attributes;
}

- (BOOL) shouldInvalidateLayoutForBoundsChange:(CGRect)newBound {
    return YES;
}

@end 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-20T12:31:13.103

这确实是一个很好的解决方案，并且效果很好。但是，由于我们必须从 shouldINvalidateLayoutForBoundsChange 中返回 YES，所以这基本上会在每次视图滚动时调用 prepareLayout。现在，**如果**您的 prepareLayout 负责创建布局属性，这很常见，这将极大地影响滚动性能。

一种对我有用的解决方案是不在 prepareLayout 中创建布局属性，而是在调用 invalidateLayout 之前显式调用的单独方法中进行。UICollectionView 在需要了解布局时调用 prepareLayout，因此该解决方案也将处理这些情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-03-15T13:04:51.077

您只需要使用以下代码创建一个新的 UICollectionViewFlowLayout：

```
class StickyHeaderLayout: UICollectionViewFlowLayout {

    override init() {
        super.init()
        self.sectionFootersPinToVisibleBounds = true
        self.sectionHeadersPinToVisibleBounds = true
    }

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        self.sectionFootersPinToVisibleBounds = true
        self.sectionHeadersPinToVisibleBounds = true
    }

    override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
        guard let attributes = super.layoutAttributesForElements(in: rect) else { return nil }

        for attribute in attributes {
            adjustAttributesIfNeeded(attribute)
        }
        return attributes
    }

    override func layoutAttributesForSupplementaryView(ofKind elementKind: String, at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
        guard let attributes = super.layoutAttributesForSupplementaryView(ofKind: elementKind, at: indexPath) else { return nil }
        adjustAttributesIfNeeded(attributes)
        return attributes
    }

    func adjustAttributesIfNeeded(_ attributes: UICollectionViewLayoutAttributes) {
        switch attributes.representedElementKind {
        case UICollectionElementKindSectionHeader?:
            adjustHeaderAttributesIfNeeded(attributes)
        case UICollectionElementKindSectionFooter?:
            adjustFooterAttributesIfNeeded(attributes)
        default:
            break
        }
    }

    private func adjustHeaderAttributesIfNeeded(_ attributes: UICollectionViewLayoutAttributes) {
        guard let collectionView = collectionView else { return }
        guard attributes.indexPath.section == 0 else { return }

        if collectionView.contentOffset.y < 0 {
            attributes.frame.origin.y = collectionView.contentOffset.y
        }
    }

    private func adjustFooterAttributesIfNeeded(_ attributes: UICollectionViewLayoutAttributes) {
        guard let collectionView = collectionView else { return }
        guard attributes.indexPath.section == collectionView.numberOfSections - 1 else { return }

        if collectionView.contentOffset.y + collectionView.bounds.size.height > collectionView.contentSize.height {
            attributes.frame.origin.y = collectionView.contentOffset.y + collectionView.bounds.size.height - attributes.frame.size.height
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-19T04:27:01.087

这段代码对我有用

```
 -(NSArray *)layoutAttributesForElementsInRect:(CGRect)rect {
        NSMutableArray *answer = [[super layoutAttributesForElementsInRect:rect] mutableCopy];
        UICollectionView * const cv = self.collectionView;
        //CLS_LOG(@"Number of sections = %d", [cv numberOfSections]);
        CGPoint const contentOffset = cv.contentOffset;

    //CLS_LOG(@"Adding missing sections");
    NSMutableIndexSet *missingSections = [NSMutableIndexSet indexSet];
    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {
        if (layoutAttributes.representedElementCategory == UICollectionElementCategoryCell) {
            [missingSections addIndex:layoutAttributes.indexPath.section];
        }
    }
    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {
        if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {
            [missingSections removeIndex:layoutAttributes.indexPath.section];
        }
    }

    [missingSections enumerateIndexesUsingBlock:^(NSUInteger idx, BOOL *stop) {

        NSIndexPath *indexPath = [NSIndexPath indexPathForItem:0 inSection:idx];

        UICollectionViewLayoutAttributes *layoutAttributes = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader atIndexPath:indexPath];

        [answer addObject:layoutAttributes];

    }];

    NSInteger numberOfSections = [cv numberOfSections];

    //CLS_LOG(@"For loop");
    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {

        if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {

            NSInteger section = layoutAttributes.indexPath.section;
            //CLS_LOG(@"Customizing layout attribute for header in section %d with number of items = %d", section, [cv numberOfItemsInSection:section]);

            if (section < numberOfSections) {
                NSInteger numberOfItemsInSection = [cv numberOfItemsInSection:section];

                NSIndexPath *firstObjectIndexPath = [NSIndexPath indexPathForItem:0 inSection:section];
                NSIndexPath *lastObjectIndexPath = [NSIndexPath indexPathForItem:MAX(0, (numberOfItemsInSection - 1)) inSection:section];

                BOOL cellsExist;
                UICollectionViewLayoutAttributes *firstObjectAttrs;
                UICollectionViewLayoutAttributes *lastObjectAttrs;

                if (numberOfItemsInSection > 0) { // use cell data if items exist
                    cellsExist = YES;
                    firstObjectAttrs = [self layoutAttributesForItemAtIndexPath:firstObjectIndexPath];
                    lastObjectAttrs = [self layoutAttributesForItemAtIndexPath:lastObjectIndexPath];
                } else { // else use the header and footer
                    cellsExist = NO;
                    firstObjectAttrs = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader
                                                                            atIndexPath:firstObjectIndexPath];
                    lastObjectAttrs = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionFooter
                                                                           atIndexPath:lastObjectIndexPath];

                }

                CGFloat topHeaderHeight = (cellsExist) ? CGRectGetHeight(layoutAttributes.frame) : 0;
                CGFloat bottomHeaderHeight = CGRectGetHeight(layoutAttributes.frame);
                CGRect frameWithEdgeInsets = UIEdgeInsetsInsetRect(layoutAttributes.frame,
                                                                   cv.contentInset);

                CGPoint origin = frameWithEdgeInsets.origin;

                origin.y = MIN(
                               MAX(
                                   contentOffset.y + cv.contentInset.top,
                                   (CGRectGetMinY(firstObjectAttrs.frame) - topHeaderHeight)
                                   ),
                               (CGRectGetMaxY(lastObjectAttrs.frame) - bottomHeaderHeight)
                               );

                layoutAttributes.zIndex = 1024;
                layoutAttributes.frame = (CGRect){
                    .origin = origin,
                    .size = layoutAttributes.frame.size
                };
            }
        }

    }

    return answer;

}

- (BOOL) shouldInvalidateLayoutForBoundsChange:(CGRect)newBound {
    return YES;
} 
```

试试这个家伙...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-17T18:16:19.963

以上都不适合我。我一直在寻找一个干净的布局，照顾我的插图，给我一个 Photo.app 风格的滚动集合。

我调整了[这里](http://blog.radi.ws/post/32905838158/sticky-headers-for-uicollectionview-using#notes)提出的解决方案来处理 edgeInsets 设置。为清楚起见，我在此处附上完整的解决方案。但是，您可以从以下要点获得完整的解决方案：[#3e1955a4492a897e677f](https://gist.github.com/valvoline/3e1955a4492a897e677f)。

```
@implementation SpringboardLayout

- (id)init
{
    if (self = [super init])
    {
        self.headerReferenceSize = CGSizeMake(0, 50);
        self.footerReferenceSize = CGSizeMake(0, 0);
        self.sectionInset = UIEdgeInsetsMake(10, 10, 80, 10);
        self.scrollDirection = UICollectionViewScrollDirectionVertical;
        self.minimumInteritemSpacing = 10;
        self.minimumLineSpacing = 10;
        if(IS_IPHONE_6 || IS_IPHONE_6PLUS) {
            self.itemSize = CGSizeMake(100, 128);
        } else {
            self.itemSize = CGSizeMake(80, 108);
        }
    }
    return self;
}

- (BOOL) shouldInvalidateLayoutForBoundsChange:(CGRect)newBound {
    return YES;
}

- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect {

    NSMutableArray *answer = [[super layoutAttributesForElementsInRect:rect] mutableCopy];
    UICollectionView * const cv = self.collectionView;
    CGPoint const contentOffset = cv.contentOffset;

    NSMutableIndexSet *missingSections = [NSMutableIndexSet indexSet];

    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {
        if (layoutAttributes.representedElementCategory == UICollectionElementCategoryCell) {
            [missingSections addIndex:layoutAttributes.indexPath.section];
        } else if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {
            [missingSections removeIndex:layoutAttributes.indexPath.section];
        }
    }

    [missingSections enumerateIndexesUsingBlock:^(NSUInteger idx, BOOL *stop) {

        NSIndexPath *indexPath = [NSIndexPath indexPathForItem:0 inSection:idx];

        UICollectionViewLayoutAttributes *layoutAttributes = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader atIndexPath:indexPath];

        [answer addObject:layoutAttributes];

    }];

    for (UICollectionViewLayoutAttributes *layoutAttributes in answer) {

        if ([layoutAttributes.representedElementKind isEqualToString:UICollectionElementKindSectionHeader]) {

            NSInteger section = layoutAttributes.indexPath.section;
            NSInteger numberOfItemsInSection = [cv numberOfItemsInSection:section];

            NSIndexPath *firstObjectIndexPath = [NSIndexPath indexPathForItem:0 inSection:section];
            NSIndexPath *lastObjectIndexPath = [NSIndexPath indexPathForItem:MAX(0, (numberOfItemsInSection - 1)) inSection:section];

            BOOL cellsExist;
            UICollectionViewLayoutAttributes *firstObjectAttrs;
            UICollectionViewLayoutAttributes *lastObjectAttrs;

            if (numberOfItemsInSection > 0) { // use cell data if items exist
                cellsExist = YES;
                firstObjectAttrs = [self layoutAttributesForItemAtIndexPath:firstObjectIndexPath];
                lastObjectAttrs = [self layoutAttributesForItemAtIndexPath:lastObjectIndexPath];
            } else { // else use the header and footer
                cellsExist = NO;
                firstObjectAttrs = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader
                                                                        atIndexPath:firstObjectIndexPath];
                lastObjectAttrs = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionFooter
                                                                       atIndexPath:lastObjectIndexPath];

            }

            CGFloat topHeaderHeight = (cellsExist) ? CGRectGetHeight(layoutAttributes.frame) : 0;
            CGFloat bottomHeaderHeight = CGRectGetHeight(layoutAttributes.frame);
            CGRect frameWithEdgeInsets = UIEdgeInsetsInsetRect(layoutAttributes.frame,
                                                               cv.contentInset);

            CGPoint origin = frameWithEdgeInsets.origin;

            origin.y = MIN(MAX(contentOffset.y + cv.contentInset.top,
                               (CGRectGetMinY(firstObjectAttrs.frame) - topHeaderHeight - self.sectionInset.top))
                           ,(CGRectGetMaxY(lastObjectAttrs.frame) - bottomHeaderHeight + self.sectionInset.bottom));
            layoutAttributes.zIndex = 1024;
            layoutAttributes.frame = (CGRect){
                .origin = origin,
                .size = layoutAttributes.frame.size
            };
        }
    }
    return answer;
}

@end 
```

# webdriver - watir webdriver：如何切换到另一个用目标打开的窗口

> ID：15233183
> 
> 赞同：5
> 
> 时间：2013-03-05T20:12:42.710
> 
> 标签：webdriver, watir, watir-webdriver

我正在使用 watir-webdriver，当单击带有 target="_blank" 的链接时，它会打开一个新窗口，我无法控制该窗口，但仍需要验证是否打开了 404 页面以外的内容，以及标题是否为该新窗口包含一些关键字。我不知道该窗口的标题是什么（它一直不一样），所以[这个解决方案](https://groups.google.com/forum/?fromgroups=#!topic/watir-general/GfjseZiJDB8)没有帮助。

是否有任何已知的方法可以通过 watir-webdriver 处理那些 target="_blank" 窗口？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-05T21:01:59.970

由于您知道新窗口的标题应该具有某些形式，因此您应该能够使用正则表达式（用“/”表示的正则表达式）通过其标题来定位它。

```
browser.window(:title => /known part of title/).use do
  #Whatever you want to do with the popup
end 
```

或者，如果您真的对弹出窗口一无所知，您可以创建最后一个窗口：

```
browser.windows.last.use do
  #Whatever you want to do with the popup
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-05T20:58:36.490

[http://watirwebdriver.com/browser-popups/](http://watirwebdriver.com/browser-popups/)上有 watir-webdriver[窗口切换规范](https://github.com/watir/watirspec/blob/master/window_switching_spec.rb)的链接。您应该能够通过、或找到窗口。规范中的示例：`:title``:url``:index`

```
browser.window(:index => 1).use
browser.window(:url => /closeable\.html/).use
browser.window(:title => "closeable window").use 
```

# php - 带条件的表格中显示数组（PHP）

> ID：15233185
> 
> 赞同：0
> 
> 时间：2013-03-05T20:12:43.710
> 
> 标签：php, arrays

我有这个数组：

```
Array ( [2-3] => player1 [1-3] => player2 [2-0] => player1 [5-1] => player1 [2-4] => player2 [4-1] => player2 ) 
```

我想要的是这样的：`if array value is "player1" show all its keys in a table`

player1 的结果在表格中应该是这样的：

*   2-3
*   2-0
*   5-1

我会让他们在不同的桌子上为 player2 做同样的事情。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:14:37.633

您可以使用一个简单的循环来执行此操作：

```
$target = 'player1';
$result = array();
foreach ($array as $values => $player) {
    if ($player === $target) {
        $result[] = $values;
    }
} 
```

您可以`$target`为其他玩家更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T05:22:40.180

尝试这个 ：

```
$array   = Array ( "2-3" => "player1", "1-3" => "player2", "2-0" => "player1", "5-1" => "player1", "2-4" => "player2", "4-1" => "player2" );

$res     = array();
for($i=0;$i<count($array);$i++){
   $key     = array_search("player1",$array);
   if($key){
       $res[]   = $key;
       $array[$key]  = "";
   }
}
echo "<pre>";
print_r($res); 
```

输出 ：

```
Array
(
    [0] => 2-3
    [1] => 2-0
    [2] => 5-1
) 
```

# c++ - 如何使用 auto 获得 const_iterator？

> ID：15233188
> 
> 赞同：67
> 
> 时间：2013-03-05T20:12:49.043
> 
> 标签：c++, c++11, auto

第一个问题：是否可以“强制”`const_iterator`使用汽车？例如：

```
map<int> usa;
//...init usa
auto city_it = usa.find("New York"); 
```

我只想查询，而不是更改 指向的任何内容`city_it`，所以我想必须`city_it`是`map<int>::const_iterator`. 但是通过使用 auto，`city_it`与 的返回类型相同`map::find()`，即`map<int>::iterator`. 有什么建议吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-03-05T20:20:25.800

抱歉，但我只是认为最好的建议是**根本不**使用`auto`，因为您想执行（隐式有效）**类型转换**。`auto`用于推断*确切的类型*，这不是您想要的。

只需这样写：

```
std::map<std::string, int>::const_iterator city_it = usa.find("New York"); 
```

正如 MooingDuck 正确指出的那样，使用类型别名可以提高代码的可读性和可维护性：

```
typedef std::map<std::string, int> my_map;
my_map::const_iterator city_it = usa.find("New York"); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2017-07-12T12:21:27.853

从 C++17 开始，您可以[`std::as_const`](http://en.cppreference.com/w/cpp/utility/as_const)像这样使用：

```
#include <utility>

// ...

auto city_it = std::as_const(usa).find("New York"); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-03-14T09:45:58.493

一个干净的解决方案是使用对其他可修改映射的*const*引用：

```
const auto &const_usa = usa;
auto city_it = const_usa.find("New York"); 
```

这将确保您无法修改`const_usa`，并将使用 const 迭代器。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-03-05T21:07:12.127

与@Jollymorphic 的答案相比，这并没有完全不同的转换`const`，但我认为拥有这样的实用单行函数很方便：

```
template<class T> T const& constant(T& v){ return v; } 
```

这使得转换更吸引眼球：

```
auto it = constant(usa).find("New York");
// other solutions for direct lengths comparision
std::map<std::string, int>::const_iterator city_it = usa.find("New York");
auto city_it = const_cast<const std::map<std::string, int>&>(usa).find("New York"); 
```

好吧，我想说，更大并不总是更好。您当然可以根据自己的喜好选择函数的名称 -`as_const`或者只是`const_`可能的替代方案。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-03-12T16:57:36.867

另一个使用 auto 的变体（同时保留一个 mutable usa 和一个 const usa）：

```
map<std::string, int> usa;
//...init usa
const auto &const_usa = usa;
auto city_it = const_usa.find("New York"); 
```

如果您在初始化后根本不需要地图是可变的，还有其他一些选项。

您可以将 usa 定义为 const 并使用函数调用对其进行初始化：

```
const map<std::string, int> usa = init_usa();
auto city_it = usa.find("New York"); 
```

或使用 lambda 初始化 const 映射：

```
const auto usa = [&]()->const map<std::string, int> 
   {
   map<std::string, int> usa;
   //...init usa
   return usa;
   }();
auto city_it = usa.find("New York"); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-10-17T22:44:25.260

在 C++11 中，您可以这样做：

```
decltype(usa)::const_iterator city_it = usa.find("New York"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-05T20:15:45.717

我现在无法对此进行测试，但我认为它可以解决问题：

```
auto city_it = const_cast< const map<int> & >(usa).find("New York"); 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-09-11T01:33:57.557

您可以使用 auto 来“跟踪”一个类型或“推断”一个类型： `// deduce auto city_it = usa.find("New York");`

`// track auto city_it = std::map<int>::const_iterator( usa.find("New York"));`

此外，watch 是 Herb Sutter 的现代 c++ 风格讲座，涵盖了大多数此类推导指南。 [https://youtu.be/xnqTKD8uD64](https://youtu.be/xnqTKD8uD64)

# ruby - 在 Chef 中，为什么没有挽救引发的异常？

> ID：15233191
> 
> 赞同：4
> 
> 时间：2013-03-05T20:13:02.937
> 
> 标签：ruby, mongodb, chef-infra

在 Chef 中，为什么这段代码没有捕捉到 bash 资源中抛出的异常？如果我运行这段代码，即使抛出异常，我也永远无法访问 python 资源。该错误是预期的，这就是为什么我要抓住它，然后转到 pymongo 并以这种方式修复它。

```
begin
    bash "mongo fix" do
        code "mongo --verbose #{filename}"
        action :run

    end
rescue
    python 'pymongo reconfig'  do
        code "Pymongo does a catch and reconfig"
    end

end 
```

这是异常输出

```
[2013-03-05T20:03:55+00:00] FATAL: Mixlib::ShellOut::ShellCommandFailed: bash[mongo fix (noudata::mongo line 77) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '253'
---- Begin output of "bash"  "/tmp/chef-script20130305-3916-14xxhn5-0" ----
STDOUT: MongoDB shell version: 2.2.3
Tue Mar  5 20:03:55 versionCmpTest passed
Tue Mar  5 20:03:55 versionArrayTest passed
connecting to: test
Tue Mar  5 20:03:55 creating new connection to:127.0.0.1:27017
Tue Mar  5 20:03:55 BackgroundJob starting: ConnectBG
Tue Mar  5 20:03:55 connected connection!
true
{
"errmsg" : "replSetReconfig command must be sent to the current replica set primary.",
"ok" : 0
}
Tue Mar  5 20:03:55 uncaught exception: [object bson_object]
failed to load: /tmp/test.js
STDERR:
---- End output of "bash"  "/tmp/chef-script20130305-3916-14xxhn5-0" ----
Ran "bash"  "/tmp/chef-script20130305-3916-14xxhn5-0" returned 253 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:22:32.630

块中的代码`begin`创建资源实例`Chef::Resource::Bash`，分配资源`code`和`action`属性，并将资源添加到`run_context.resource_collection`. 该资源在任何意义上都不是“运行”的。创建资源实例不会引发任何异常，因此`rescue`块中的代码不会运行。

稍后，一旦您的所有配方代码运行完毕，Chef 将循环访问`run_context.resource_collection`. 对于每个资源，Chef 将运行资源的操作。在`bash`资源的情况下，这意味着运行资源`code`属性中给出的字符串。请注意，这发生在您的配方和所有其他配方完成运行之后，因此这发生在您的`begin`块之外。此资源在运行其操作时引发的任何异常都不会传播到您的`begin`块，因为这些操作不是从您的`begin`块内调用的，而是从它之后调用的。

你可以尝试这样的事情：

```
bash "mongo fix" do
  code "mongo --verbose #{filename} || python pymongo reconfig"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T10:02:16.533

将您的代码放入定义中并从配方中调用定义。

# php - CakePHP 日期数组

> ID：15233192
> 
> 赞同：1
> 
> 时间：2013-03-05T20:13:03.617
> 
> 标签：php, html, cakephp

```
 $dts = new DateTime(AppController::getSetting('event_start'));
        $dtf = new DateTime(AppController::getSetting('event_finish'));        

        //CONTROLLER
...
        $weekdays = array(0,1,2,3,4,5,6);

        $dates = array();
        $today = strtotime(date("Y-m-d", $dts->getTimestamp()));
        $end_date = strtotime(date("Y-m-d", $dtf->getTimestamp()));
        while($today <= $end_date) 
        {
            $weekday = date("w", $today);
            if (in_array($weekday, $weekdays)) 
            {
                array_push($dates, date("Y-m-d", $today));
            }
            $today += 86400;
        }

        $this->set('dates', $dates);
...

//VIEW
...
    echo $this->Form->input('date', array('options'=> $dates));
... 
```

dts 和 dtf 是我从数据库中获取的开始和结束日期...

当我从视图中的下拉框中选择一个日期时，它可以提交，但我在数据库中得到的只是 0000-00-00？

我在这里做错了什么？

编辑

我的数组输出

```
Debugger::dump($dates);

    array(
(int) 0 => '2013-04-01',
(int) 1 => '2013-04-02',
(int) 2 => '2013-04-03',
(int) 3 => '2013-04-04',
(int) 4 => '2013-04-05',
(int) 5 => '2013-04-06',
(int) 6 => '2013-04-07'
) 
```

编辑这就是我的查询的样子

INSERT INTO cake.tickets (first_name, last_name, email, phone, date, quantity) VALUES ('brbt', 'trbb', 'ver@fvef.com', 765657, //THIS IS THE DATE//2, 2) .

好像只能输入key？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:53:12.343

使您的键和值相同。关键是保存的内容，价值是用户看到的内容。

```
$dates = array();
$today = strtotime(date("Y-m-d", $dts->getTimestamp()));
$end_date = strtotime(date("Y-m-d", $dtf->getTimestamp()));
while($today <= $end_date) 
{
    $weekday = date("w", $today);
    if (in_array($weekday, $weekdays)) 
    {
        $dates[date("Y-m-d", $today)] = date("Y-m-d", $today);
    }
    $today += 86400;
}
$this->set('dates', $dates); 
```

您的日期数组现在应该如下所示：

```
array(
 '2013-04-01' => '2013-04-01',
 '2013-04-02' => '2013-04-02',
 '2013-04-03' => '2013-04-03',
 '2013-04-04' => '2013-04-04',
 '2013-04-05' => '2013-04-05',
 '2013-04-06' => '2013-04-06',
 '2013-04-07'=> '2013-04-07'
) 
```

这将生成正确的选择选项。

# java - JSF 转换器：验证错误：值无效

> ID：15233193
> 
> 赞同：0
> 
> 时间：2013-03-05T20:13:10.613
> 
> 标签：java, jsf-2, primefaces

全部，

我一直在阅读和搜索，虽然上面有几个项目，但似乎我错过了一些东西。我的表单在转换 selectOneListBox 时一直失败

我已经阅读并搜索过，但到目前为止我还没有找到导致此问题的原因。据我阅读和发现的可能原因如下：

1.  Object.equals() 不正确
2.  菜单列表为空。

内联是我基于用户类的转换器：

```
@FacesConverter("misc.util.UserConverter")
public class UserConverter implements Converter {
    private static HashMap<String, Users> map = new HashMap<String, Users>();
    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String value) {
        Users user = map.get(value);
        Logger.getGlobal().log(Level.INFO, "UserConverter - getAsObject " + user.getEmail());
        Logger.getGlobal().log(Level.INFO, "UserConverter - getAsObject value " + value);
        return user;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component, Object value) {
        Users user = (Users)value;
        map.put(user.getEmail().toString(), user);
        Logger.getGlobal().log(Level.INFO, "UserConverter - getAsString");
        return user.getEmail().toString();
    }
} 
```

失败的代码：

ticketUpdateController.lovResearchers - 类型 List - 从 JpaController 获得的列表。ticketUpdateController.researcher - 类型用户

我还尝试添加 inputHidden，因为此页面有一个 viewParam，我需要保持此值才能刷新。尽管没有它，它也会发生同样的情况。

```
 <p:dialog id="assignResearcherDialog" header="Assign Researcher" widgetVar="assignResearcher" resizable="false">
        <h:form id="assignResearcherForm">
            <p:panel>
                <p:selectOneListbox id="selRec" value="#{ticketUpdateController.researcher}">
                    <f:selectItems value="#{ticketUpdateController.lovResearchers}" var="r" itemLabel="#{r.email}" itemValue="#{r}"></f:selectItems>
                    <f:converter converterId="misc.util.UserConverter"></f:converter>
                    <h:inputHidden value="#{ticketUpdateController.ticketNumber}"></h:inputHidden>
                </p:selectOneListbox>
                <p:commandButton value="Assign" actionListener="#{ticketUpdateController.setResearcher}" oncomplete="handleSubmitRequest(xhr, status, args, 'assignResearcherDialog','assignResearcherForm');" update=":ticketUpdateForm :message">
                    <h:inputHidden value="#{ticketUpdateController.ticketNumber}"></h:inputHidden>
                    <f:param id="tnr" value="#{ticketUpdateController.ticketNumber}"></f:param>
                </p:commandButton>
            </p:panel>
        </h:form>
    </p:dialog> 
```

我的故障排除：

*   我已经检查了 Users 类，并且根本没有调用 equals 。（通过将记录器放在那里进行检查）
*   将日志记录在转换器类中以查看何时调用它。到目前为止，它似乎在需要时被调用。JSF 页面加载，当我按下某个按钮时。
*   在 TicketUpdateController bean 的 init 中添加了 logger，以便我可以查看这些值是否仍在内存中。

```
警告：类 gui.controller.TicketUpdateController 正在启动...
警告：类 gui.controller.TicketUpdateController 设置值...
信息：UserConverter - getAsString 信息：UserConverter - getAsString
信息：UserConverter - getAsString 信息：UserConverter - getAsString
警告：类 gui.controller.TicketUpdateController 正在启动...
警告：类 gui.controller.TicketUpdateController 设置值...
信息：UserConverter - getAsString 信息：UserConverter - getAsString
信息：UserConverter - getAsString 信息：UserConverter - getAsString
信息：UserConverter - getAsObject Researcher@localhost.com
INFO:UserConverter - getAsObject 值 Researcher@localhost.com
警告：类 gui.controller.TicketUpdateController 正在启动...

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T12:36:19.833

发现了什么问题。

所以基本上我使用了错误的课程。
我的页面 bean 是 TicketUpdateController，但我的转换器是供用户使用的。

所以我将他selectedItems中的字段从TicketUpdateController更改为UsersController。

毕竟我应该从 UsersController 而不是 TicketUpdatecontroller 获取我的所有用户。

# box-api - Box.com API 无需用户交互

> ID：15233198
> 
> 赞同：1
> 
> 时间：2013-03-05T20:13:21.657
> 
> 标签：box-api

我正在开发一个谷歌连接器（用于谷歌搜索设备），我需要对 box.com 进行身份验证，但无需登录并允许页面。也许是重复的：[Box API 登录问题](https://stackoverflow.com/questions/11672589/box-api-login-issue/12392831)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T16:54:25.497

有一种方法可以实现这一点。您必须第一次使用 OAuth2 流程检索您的令牌。然后，您需要将访问令牌连同它的刷新令牌一起存储在数据库中。访问令牌将在 1 小时后过期。刷新令牌将在 14 天后过期。每次需要绕过用户身份验证流程发出请求时，您都可以使用刷新令牌获取新的访问令牌。您只需确保在 14 天内使用您的刷新令牌。您最好设置一个刷新令牌的 cron。

我已经在我的应用程序中构建了它，所以只需构建它，您的应用程序就会运行良好。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:47:14.923

Box API 目前只能在通过[OAuth 2对用户进行身份验证后才能访问](http://developers.box.com/oauth)

# html - 等距画布/SVG HTML 5 图像

> ID：15233199
> 
> 赞同：0
> 
> 时间：2013-03-05T20:13:23.070
> 
> 标签：html, canvas, svg

我正在寻找一些教程，我如何为 RTS 游戏目的在等距地图中制作画布或 SVG（不确定是哪个）图像。图像只能在可见部分上单击，否则用户应该单击背景图像。它可以通过自动检测 PNG 的透明区域或颜色叠加来完成。我不知道哪个是最好的。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:15:18.800

如果您不改变场景的视角，那么我会使用 SVG，因为它们是 DOM 元素（开箱即用可点击），您可以将点击区域限制为元素的非透明部分. 一个非常好的 SVG 库是 RaphaelJS。

画布是另一种动物。您在画布上绘制的矢量/栅格不会“保留”，这意味着与 SVG 不同，您无法指示刚刚在画布上绘制的框移动。相反，您负责在您想要的位置重新绘制该框。在画布上绘制完所有内容后，它基本上就变成了一个大位图。如果您的场景的视角会发生变化，您可能需要画布最擅长的：速度和灵活性。使用矩阵变换，您可以进行 2D 移动、旋转、缩放和倾斜。由于您负责变换矩阵，因此您还可以模拟 3D 运动。如果您的用户有非 IE 浏览器，那么您也有 WebGL，它是一个完整的 3D 成像系统。这种能力带来了复杂性，因此您可能会查看许多可用于画布的游戏开发平台。

使用这两个元素，您可以使用 websockets 来执行 RTS（当然，对于不支持 websockets 的浏览器来说，这会降级为长轮询）。

# javascript - 在 RenderPartial 视图中从 Ajax.BeginForm 创建的 Ajax.ActionLink

> ID：15233200
> 
> 赞同：0
> 
> 时间：2013-03-05T20:13:27.540
> 
> 标签：javascript, ajax, asp.net-mvc, razor, unobtrusive-javascript

我想确认这个限制是设计使然还是我做错了什么：

我有两个 RenderPartials 的视图：

```
@model Heelp.ViewModels.CompanyIndexViewModel

@{ Html.RenderPartial(MVC.Company.Views.IndexSearch, Model.SearchViewModel); }
@{ Html.RenderPartial(MVC.Company.Views.IndexMap, Model.MapViewModel); } 
```

在第一个部分视图中，我有一个 Ajax.BeginForm：

```
@model Heelp.ViewModels.CompanyIndexSearchViewModel

@using (Ajax.BeginForm(MVC.Company.CategoryGetAllBySearch(), new AjaxOptions { UpdateTargetId = "searchCompanyResults", InsertionMode = InsertionMode.Replace }, new { @id = "searchBoxWrap" }))
{
  @Html.AntiForgeryToken()

  @Html.HiddenFor(m => m.IsCenterFromUser)
  @Html.HiddenFor(m => m.CenterLat)
  @Html.HiddenFor(m => m.CenterLng)
  @Html.HiddenFor(m => m.Zoom)
  @Html.HiddenFor(m => m.SearchRadius)

  @Html.TextBoxFor(m => m.Search, new { @placeholder = @HeelpResources.CompanyIndexViewSearchPlaceholder })
  <input type="button" value="«" id="clearKeywords"/>
  @Html.TextBoxFor(m => m.Location, new { @placeholder =   @HeelpResources.CompanyIndexViewLocationPlaceholder })
  <input type="button" value="«" id="clearLocation"/>
  <input type="button" value="X" id="hereButton"/>
  <input type="submit" value="@HeelpResources.CompanyIndexViewSearchButtonLabel"/>
}
<div id="searchCompanyResults" class="clearfix" style="z-index: 10; position: absolute; width: 400px;"></div> 
```

Ajax.BeginForm 在 searchCompanyResults div 中生成一个带有 Ajax.ActionLink 列表的 PartialView：

```
 @model Heelp.ViewModels.CategoryGetAllBySearchListViewModel

<p class="float-left margin-top align-left"><span>Encontrámos <em><a href="#">@Model.TotalSearchCount</a></em> resultados nas categorias:</span></p>
<div class="clear-both">
    <div id="searchResultsList" class="float-left">
        <ul>
            @foreach (var item in Model.CategoryGetAllBySearch)
            {
                <li>
                    @Ajax.ActionLink(
                        String.Format("{0} {1} ver »", item.SearchCount, item.Name), 
                        MVC.Company.GetAllByCategory(item.Id, Model.Search, Model.Location, Model.IsCenterFromUser, Model.CenterLat, Model.CenterLng, Model.SearchRadius), 
                        new AjaxOptions { OnBegin = "CompanyGetAllByCategoryOnBegin(" + item.Id + ")", OnSuccess = "CompanyGetAllByCategoryOnSuccess" })
                </li>
            }        
        </ul>
    </div>
</div> 
```

这里的问题是，如果我在 PartialView 中不包含指向“< script src="~/Scripts/jquery.unobtrusive-ajax.min.js" >”的链接，Action.Link 将返回 Json 文本。

**编辑：**我检测到的是，当我单击 Action.Link 时，第一次提交 2 次，第二次提交 4 次，并且不断增长，为什么？我必须这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:05:25.160

如果你想使用`Ajax.BeginForm`，你的`Ajax.ActionLink`其他人`Ajax`应该在你的布局中包含 jquery.unobtrusive-ajax.js 文件。它包含拦截点击链接并通过取消操作提交表单并通过 AJAX 提交的代码。

您不需要将该文件包含在部分视图中两次。

# java - LWJGL 基础：深度绘制四边形

> ID：15233207
> 
> 赞同：2
> 
> 时间：2013-03-05T20:13:52.403
> 
> 标签：java, opengl, lwjgl

我有这个我现在理解的代码：

```
import org.lwjgl.LWJGLException;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;
import org.lwjgl.opengl.GL11;

public class Main {

    public void start() {
        try {
        Display.setDisplayMode(new DisplayMode(800,600));
        Display.create();
    } catch (LWJGLException e) {
        e.printStackTrace();
        System.exit(0);
    }

    // init OpenGL
    GL11.glMatrixMode(GL11.GL_PROJECTION);
    GL11.glLoadIdentity();
    GL11.glOrtho(0, 800, 0, 600, 0, 800);
    GL11.glMatrixMode(GL11.GL_MODELVIEW);

    while (!Display.isCloseRequested()) {
        // Clear the screen and depth buffer
        GL11.glClear(GL11.GL_COLOR_BUFFER_BIT | GL11.GL_DEPTH_BUFFER_BIT);  

        // set the color of the quad (R,G,B,A)
        GL11.glColor3f(1.0f,1.0f,1.0f);

        // draw quad
        GL11.glBegin(GL11.GL_QUADS);
        GL11.glVertex2f(100,100);
        GL11.glVertex2f(100+200,100);
        GL11.glVertex2f(100+200,100+200);
        GL11.glVertex2f(100,100+200);
        GL11.glEnd();

        Display.update();
    }

    Display.destroy();
    }

    public static void main(String[] argv) {
        Main quadExample = new Main();
        quadExample.start();
    }
} 
```

我想知道如何绘制方框，使其不在屏幕上绘制，而是稍微退缩了一点，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:28:16.173

```
GL11.glBegin(GL11.GL_QUADS);
GL11.glVertex3f(100,100,-100);
GL11.glVertex3f(100+200,100,-100);
GL11.glVertex3f(100+200,100+200,-100);
GL11.glVertex3f(100,100+200,-100);
GL11.glEnd(); 
```

虽然这不会与正交中的单个四边形产生任何视觉差异。您必须切换到透视投影矩阵才能让它看起来像“移回”。

# solr - 使用 Jetty 运行 Solr

> ID：15233210
> 
> 赞同：11
> 
> 时间：2013-03-05T20:13:57.953
> 
> 标签：solr, jetty

我在理解 Solr 如何与 Jetty 配合时遇到了一些麻烦，以及为什么我似乎无法让分发包中的 start.jar 工作。

我可以通过`java -jar start.jar`. 但是，当我尝试运行类似以下内容时 -

```
java -Dsolr.solr.home=/Users/jwwest/solr -jar $(brew --prefix solr)/libexec/example/start.jar 
```

-- 出现以下错误：

```
java.io.FileNotFoundException: No XML configuration files specified in start.config or command line.
    at org.eclipse.jetty.start.Main.start(Main.java:506)
    at org.eclipse.jetty.start.Main.main(Main.java:95) 
```

我打开了 start.jar 文件，在 jar 里面有一个 start.config 文件，我假设它应该为我处理这个配置。我不明白为什么从分发示例目录内部运行它会起作用，而不是在它外部运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-22T04:36:45.067

您还需要定义`jetty.home`属性。尝试：

```
java -Dsolr.solr.home=/Users/jwwest/solr -jar $(brew --prefix solr)/libexec/example/start.jar -Djetty.home=$(brew --prefix solr)/libexec/example 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-26T11:48:42.363

您可以看到使用 --dry-run 命令行标志生成的有效命令行 start.jar。

> java -jar start.jar --dry-run

这将输出具有完整路径名的所有内容，以便您可以从目录外部运行它。

资料来源： http: [//www.eclipse.org/jetty/documentation/9.0.0.M3/advanced-jetty-start.html](http://www.eclipse.org/jetty/documentation/9.0.0.M3/advanced-jetty-start.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T22:47:41.290

start.jar 是一个特定于 Jetty 的机制，用于构建启动 Jetty 的所有类路径要求。一般只在码头分布范围内使用。将 start.jar 从配置中拉出并将其放置在其他位置会使 start.config 的默认配置变得毫无意义。

我对 Solr 的理解是，它将自己与 jetty 的分发捆绑在一起，将运行所需的内容放入分发中并将其重新打包为自己的。他们可能有一个自定义的 start.config 文件，该文件进一步添加了自己的类路径资源等位置，或者没有。

您看到的异常源于 start.config 文件，该文件需要一个 etc/ 目录，其中包含用于配置 jetty 进程的 jetty.xml 格式的 xml 文件。

Jetty 经常以嵌入式格式使用与这个问题几乎没有关系，它只是一个常见的用例，因为 Jetty 非常容易嵌入到应用程序中。jetty 的嵌入式实例很少（如果有的话）利用 start.jar ......相反，它取决于嵌入应用程序来管理自己的类路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-13T01:34:29.537

首先，您需要更改您所在的文件夹`start.jar`，然后执行相同的命令。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T20:31:41.260

Jetty 经常被用作嵌入式容器。如果您想使用码头，那么一个好的开始是复制示例目录并将其重命名为您想要的名称。solr 目录是基本配置的目录。

否则建议使用 tomcat 和 solr.war 文件。

# java - Spring Webflow 2.3 测试：如何模拟流变量的@Autowired 字段

> ID：15233214
> 
> 赞同：1
> 
> 时间：2013-03-05T20:14:13.887
> 
> 标签：java, unit-testing, spring-mvc, spring-webflow

在 Spring Webflow 流中模拟 Spring Beans 有明确的指导方针。默认情况下，流可以从流中隐式引用 Spring Bean，并且 AbstractXmlFlowExecutionTests 基测试类有一个方法可以覆盖以模拟这些 bean。

我找不到类似的方法来模拟被测流中流变量的@Autowired 字段。请参阅以下基本设置以了解我的意思。

**被测流量：**

```
<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd"
      parent="commons">

    <var name="consumerBean" class="com.mycompany.ConsumerBean" />

        <!-- etc.. --> 
```

**带有 @Autowired 字段的 Bean：**

```
public class ConsumerBean implements Serializable {

    @Autowired
    transient CustomerService userService;

    //Etc.. 
```

所以我的问题是，如何向“consumerBean”流变量提供/配置“userService”的模拟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:43:29.813

流变量的 @Autowired 字段是 Spring Bean，因此应该在流访问的 Spring Bean 将被配置和模拟的相同位置进行配置。

```
 // Setup mocks
    @Override
    protected void configureFlowBuilderContext(MockFlowBuilderContext builderContext) {

    builderContext.registerBean("consumerBean", mock(ConsumerBean.class));

    builderContext.registerBean("userService", mock(CustomerService.class));
    } 
```

# java - WebServices中通过SOAPHandler传递参数

> ID：15233216
> 
> 赞同：2
> 
> 时间：2013-03-05T20:14:19.580
> 
> 标签：java, web-services, soap, jax-ws, soaphandler

我有一个部署了 Web 服务的 JBoss AS。对该 Web 服务的调用会产生对另一个 JBoss AS 中另一个 Web 服务的调用。我有兴趣在 SOAP 消息的标头中传递一些参数，因此当 SOAP 消息到达第一个 JBoss AS 时，我会读取标头参数，对它们执行一些操作，并将它们放入定向到的消息的标头第二个 JBoss AS。我正在使用两个 SOAPHandler，并在我使用的第一个 AS 中将参数传递给 Web 服务：

```
public boolean handleMessage(SOAPMessageContext context) { 
... 
//get the parameter from the header
...
context.put("parameter", parameter);
context.setScope("parameter", MessageContext.Scope.APPLICATION);
} 
```

这样我就可以在 Web 服务中执行以下操作：

```
parameter = wsContext.getMessageContext().get("parameter").toString();
...
((BindingProvider) service).getRequestContext().put("parameter", parameter); 
```

在第二个 SOAPHandler 中，管理定向到第二个 AS 的消息：

```
public boolean handleMessage(SOAPMessageContext context) { 
...
parameter = (String) context.get("parameter");
...
//put the parameter in the header
} 
```

这行得通，但是如果新消息到达第一个 AS 时没有参数，则之前的消息仍保留在上下文中，而我将旧参数发送到第二个 AS。也许这与：`MessageContext.Scope.APPLICATION`？

# wpf - WPF 边框 IsMouseOver 触发器不起作用

> ID：15233225
> 
> 赞同：10
> 
> 时间：2013-03-05T20:14:48.663
> 
> 标签：wpf, xaml

我在 app.xaml 中定义了这种风格：

```
 <Style x:Key="RedCloseButton" TargetType="Border">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Border.Background" Value="Yellow" />
                </Trigger>
                <Trigger Property="IsMouseOver" Value="False">
                    <Setter Property="Border.Background" Value="Black" />
                </Trigger>
            </Style.Triggers>
    </Style> 
```

我正在尝试在另一个 xaml 文件中使用它，如下所示：

```
 <Border Style="{StaticResource RedCloseButton}" Name="ClearValue" BorderThickness="2" BorderBrush="black" CornerRadius="0,4,4,0" Margin="110,90,0,80" Background="#FF801F1F">                
            <Rectangle Margin="10,11,6,10" Fill="White" RadiusX="2" RadiusY="2" IsHitTestVisible="False"></Rectangle>
    </Border> 
```

但是当我将鼠标悬停在边框上时什么也没有发生。这里有什么问题吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-05T20:27:15.263

这是因为您在 中设置了`Background`，`Border`这将覆盖`Style`

您必须`Background="#FF801F1F"`从 中删除，`Border` `xaml`以便`Style`可以设置`Background`

```
<Border Style="{StaticResource RedCloseButton}" Name="ClearValue" BorderThickness="2" BorderBrush="black" CornerRadius="0,4,4,0" Margin="110,90,0,80">                
        <Rectangle Margin="10,11,6,10" Fill="White" RadiusX="2" RadiusY="2" IsHitTestVisible="False"></Rectangle>
</Border> 
```

# php - Wordpress get_categories() 按“term_order”排序？

> ID：15233226
> 
> 赞同：5
> 
> 时间：2013-03-05T20:14:48.570
> 
> 标签：php, wordpress

根据[WordPress codex](http://codex.wordpress.org/Function_Reference/get_categories)， get_categories() 方法接受以下参数作为其 orderby 属性：

```
**orderby** (string) Sort categories alphabetically or by unique category ID. The default is sort by Category ID. Valid values:

id
name - default
slug
count
term_group 
```

但是，查看“wp_term_relationships”表，有一个看似未使用的字段，称为“term_order”，对于我创建的每个类别，它都设置为 0。

是否可以使用 term_order 字段作为类别的索引排序顺序？

我已经为我的类别在此字段中放置了增量值，并且我尝试使用以下代码将订单传递给函数但无济于事：

```
 $cat_args=array(

        'hierarchical' => 0,

        'orderby' => 'term_order',

        );

        $categories = get_categories($cat_args); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-08-30T10:21:20.857

许多年后，

您可以在您的 functions.php 中添加此代码：

```
function wpcf_filter_terms_order( $orderby, $query_vars, $taxonomies ) {
    return $query_vars['orderby'] == 'term_order' ? 'term_order' : $orderby;
}

add_filter( 'get_terms_orderby', 'wpcf_filter_terms_order', 10, 3 ); 
```

此代码强制 WP在您的术语查询中使用*orderby => term_order参数。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-05T11:41:33.090

@cédric-dagherir-dahive 的答案建议使用`get_terms_orderby`过滤器是一种按照添加到对象（帖子）的顺序显示术语的好方法。但是，它不适用于所有术语查询，并且会生成以下错误：

> 'order 子句' 中的未知列 'term_order'。

因为简单来说，某些术语查询只是从 ( `wp_terms`& `wp_term_taxonomy`) 数据库表中获取数据，而没有任何带有字段的`INNER JOIN`with ( `wp_term_relationships`) 表`term_order`。因此出现错误消息。

`order by term_order`仅当查询涉及分类和对象之间的多对多关系时才应添加该子句（例如`get_the_terms`）。

`term_order`因此，我更新了代码，在添加到 order 子句 之前首先检查 term 查询是否涉及对象：

```
function wpcf_filter_terms_order( $orderby, $query_vars, $taxonomies ) {
        return ( ! is_null($query_vars["object_ids"]) ) ? 'term_order' : $orderby;
}

add_filter( 'get_terms_orderby', 'wpcf_filter_terms_order', 10, 3 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-09T08:56:12.273

我搜索了所有的 wordpress 函数，唯一可以使用的`'term_order'`是[wp_get_object_terms ，你可以](http://codex.wordpress.org/Function_Reference/wp_get_object_terms)[在这里](http://core.trac.wordpress.org/browser/tags/3.6.1/wp-includes/taxonomy.php#L2170)看到它的函数。

从这一点开始，即使 wordpress 不使用它来过滤`get_categories()`您或其他主题/插件开发人员中的类别，也可以使用上述函数来获取 object_terms 并按 term_order 对其进行排序/过滤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-13T15:11:18.373

几年后，我找到了这个解决方案：

该任务可以通过过滤器和适应的分类法来解决。

[https://core.trac.wordpress.org/ticket/5857#comment:4](https://core.trac.wordpress.org/ticket/5857#comment:4)

# javascript - 数组中的 Javascript 函数

> ID：15233232
> 
> 赞同：1
> 
> 时间：2013-03-05T20:15:02.157
> 
> 标签：javascript, arrays, function

我有一个定义类名的字符串数组。我想使用字符串名称来实例化这些类。我曾尝试使用窗口，但我无法做到。

结构是

```
var objects = ['string1', 'string2']; 
```

所以窗口看起来像

```
window [
    objects [
        'string1',
        'string2'    
    ]
] 
```

我努力了：

```
new window['objects'][0]; 
```

但是抛出字符串不是函数错误。

有人知道怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:16:12.203

`window.objects[0]`是一个字符串。
您想获得`window`由该字符串命名的属性：

```
window[window.objects[0]] 
```

# javascript - context.strokeText 使用 for

> ID：15233233
> 
> 赞同：0
> 
> 时间：2013-03-05T20:15:06.080
> 
> 标签：javascript, typescript

我试图在我的画布上获得大量数字。我的代码正在我的计时器上使用事件处理程序重复。

每经过 5 秒，我想在画布上添加另一个数字。它用于我的图表下方的流动时间线。

forloop 本身工作正常，但每次运行时，它都会覆盖当前的描边文本。这是for；

```
 pos = (time * (360 / 60) - 360); // calculate position in graph
            var t = new Array(); // array of numbers
            var x = new Array(); // array of xPos
            var y = new Array(); // array of yPos
            // new time number, position + distance to next number for each 5 seconds + compensation(60), yPos
            for (var i = 0 ; i < add / 5; i++) { // add / 5 is the count of numbers to add
                t[i] = add + 35;
                x[i] = -pos + (30 * (add / 5) + 60); // positions the number 30px next to the number before it.
                y[i] = 330;
            }
            for (var i = 0; i < t.length; i++) {
                ctx.strokeText(t[i], x[i], y[i]);  // draws the number
            }
            //this line here gives back the exact same result as the code above.
            //ctx.strokeText((add + 35).toString(), -pos + (30 * (add / 5) + 60), 330); 
```

我不能在 ctx 上调用 new ......这只是覆盖了旧笔画.. 它目前在这里住： [http](http://worms.azurewebsites.net/#) ://worms.azurewebsites.net/# 如果你按下播放按钮，你会看到蓝色酒吧移动到 30，从这里开始，数字应该向左移动。这有点工作（令人震惊的开始），但如果您等待几秒钟，您会看到新数字出现和消失。

我只是想不出一种在画布上添加额外数字的方法..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:24:54.153

`x[i] = -pos + (30 * (add / 5) + 60); // positions the number 30px next to the number before`

这个计算不可能是正确的——它根本不依赖`i`（或任何其他在循环过程中发生变化的变量），所以你只是在同一个地方`add / 5`多次绘制相同的东西。与`t[i]`上面的行相同。也许你的意思是这样的？

```
t[i] = add + 35 + 30 * i; // Just guessing here on how i and t relate...
x[i] = -pos + (30 * i + 60); 
```

# gtk - 使用构建器内容构造 Vala Gtk 对象

> ID：15233238
> 
> 赞同：5
> 
> 时间：2013-03-05T20:15:13.510
> 
> 标签：gtk, vala

能够创建一个使用 builder 加载其内容的新小部件将是理想的，例如。

```
public class MyDialog : Dialog
  {
    public MyDialog
      {
        Gtk.Builder builder = new Gtk.Builder ();
        builder.add_from_file ("dialog.ui");
        this = builder.get_object ("my_dialog") as Gtk.Widget;
      }
    } 
```

显然这是行不通的，因为这`this =`是一个无效的分配，但我想知道是否有一种方法可以使用从构建器加载的内容来设置小部件的内容。

与此同时，我已经`this = ...`用

```
var content = get_content_area ();
var dialog = builder.get_object ("my_dialog") as Gtk.Widget;
var _content = (dialog as Dialog).get_content_area ();
_content.reparent (content); 
```

这确实有效，但对我来说能够直接加载仍然有意义。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-16T10:13:26.507

万一将来有人偶然发现这个问题，Vala 0.22 提供了*复合小部件模板*，这是解决上述问题的一个更简单的方法。复合模板允许您在 Glade 中定义一个小部件，并使用属性告诉 Vala 您的类的哪些位引用小部件的哪些元素，并连接回调，而完全无需`Gtk.Builder`手动使用。

详细信息可以在[http://blogs.gnome.org/tvb/2013/05/29/composite-templates-lands-in-vala/找到](http://blogs.gnome.org/tvb/2013/05/29/composite-templates-lands-in-vala/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T01:15:40.937

我们在 Geary 中广泛执行此操作。我使用最多的技巧根本不是在 Glade 中构建包含对象（即 Gtk.Dialog），而只是构建它的内容。然后你可以在 Vala 中编写对话框/窗口本身。

在 Glade 3.15 出现之前，这样做有点痛苦，因为它没有明确支持 Box、Grid 和其他组件作为顶层。如果你还没有升级，我推荐它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:03:27.490

不，不可能。C++ 绑定`Gtk.Builder` [具有 this](https://developer.gnome.org/gtkmm/3.6/classGtk_1_1Builder.html#a943a0ee93a933e4b538d544461922ae9)，但不幸的是它依赖于 C++ 模板并且尚未在任何其他绑定中实现。

# xcode - UIImagePickerController 在启动时崩溃

> ID：15233239
> 
> 赞同：1
> 
> 时间：2013-03-05T20:15:32.077
> 
> 标签：xcode, uiimagepickercontroller, video-capture, ios6.1

我向用户展示了一个视图控制器，其中的视图显示了一个 UIButton 来录制视频。当用户按下按钮时，我的应用程序崩溃并出现以下错误：

由于未捕获的异常“UIApplicationInvalidInterfaceOrientation”而终止应用程序，原因：“preferredInterfaceOrientationForPresentation 必须返回受支持的界面方向！”

我的应用程序仅支持纵向，并且 info.plist 文件反映正确。我在 Ray Wenderlich 的网站上找到的另一个应用程序中使用了相同的代码，并且效果很好。.h 和 .m 文件的代码如下。任何帮助，将不胜感激。

**。H**

```
#import <MediaPlayer/MediaPlayer.h>
#import <MobileCoreServices/UTCoreTypes.h>
#import <AssetsLibrary/AssetsLibrary.h>

@interface RecordSwingViewController: UIViewController

-(BOOL)startCameraControllerFromViewController:(UIViewController*)controller
                                 usingDelegate:(id )delegate;
-(void)video:(NSString *)videoPath didFinishSavingWithError:(NSError *)error contextInfo:(void*)contextInfo;

@property (weak, nonatomic) IBOutlet UIButton *record;
- (IBAction)recordSwing:(id)sender;

@end 
```

**.m**

```
#import "RecordSwingViewController.h"

@interface RecordSwingViewController ()

@end

@implementation RecordSwingViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)recordSwing:(id)sender {
    [self startCameraControllerFromViewController:self usingDelegate:self];

}
-(BOOL)shouldAutorotate
{
    return NO;
}

-(BOOL)startCameraControllerFromViewController:(UIViewController*)controller
                                 usingDelegate:(id )delegate {
    // 1 - Validattions
    if (([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera] == NO)
        || (delegate == nil)
        || (controller == nil)) {
        return NO;
    }
    // 2 - Get image picker
    UIImagePickerController *cameraUI = [[UIImagePickerController alloc] init];
    cameraUI.sourceType = UIImagePickerControllerSourceTypeCamera;
    // Displays a control that allows the user to choose movie capture
    cameraUI.mediaTypes = [[NSArray alloc] initWithObjects:(NSString *)kUTTypeMovie, nil];
    // Hides the controls for moving & scaling pictures, or for
    // trimming movies. To instead show the controls, use YES.
    cameraUI.allowsEditing = NO;
    cameraUI.delegate = delegate;
    // 3 - Display image picker
    [controller presentViewController: cameraUI animated: YES completion:nil];
    return YES;
}
-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
    NSString *mediaType = [info objectForKey: UIImagePickerControllerMediaType];
    [self dismissViewControllerAnimated:NO completion:nil];
    // Handle a movie capture
    if (CFStringCompare ((__bridge_retained CFStringRef) mediaType, kUTTypeMovie, 0) == kCFCompareEqualTo) {
        NSString *moviePath = [[info objectForKey:UIImagePickerControllerMediaURL] path];
        if (UIVideoAtPathIsCompatibleWithSavedPhotosAlbum(moviePath)) {
            UISaveVideoAtPathToSavedPhotosAlbum(moviePath, self,
                                                @selector(video:didFinishSavingWithError:contextInfo:), nil);
        }
    }
}

-(void)video:(NSString*)videoPath didFinishSavingWithError:(NSError*)error contextInfo:(void*)contextInfo {
    if (error) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Video Saving Failed"
                                                       delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
    } else {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Video Saved" message:@"Saved To Photo Album"
                                                       delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
    }
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T17:39:04.207

好的，答案终于来了。
[https://stackoverflow.com/a/12570501/2133494](https://stackoverflow.com/a/12570501/2133494) 基本上我需要向我的 UIImagePickerController 添加一个类别。我尝试了很多其他修复，但这有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:55:44.397

您已经实现了 bool 进行自动旋转，但没有指定它是否不自动旋转它还应该做什么。在自动旋转方法之后尝试以下操作。

```
 -(NSUInteger)supportedInterfaceOrientations
 {
 return UIInterfaceOrientationMaskLandscapeRight | UIInterfaceOrientationMaskLandscapeLeft   | UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown;
 } 
```

请从上述方法中删除您不需要的任何面具，看看这是否适合您。

# javascript - 对于新的动态创建的元素，单击事件不会持续存在

> ID：15233240
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:15:33.600
> 
> 标签：javascript, jquery

我有一些附加到类的单击事件的代码：

```
$(".filter-link").click(function (e) {
    $("#filter").dialog("option", "position",
                    { my: "left top", at: "left bottom", of: e });
    $("#filter").dialog("open");
}); 
```

我使用它的元素经常动态重新创建：

```
function addTopLinks() {
    $('#calendar .fc-view thead th.fc-resourceName')
        .removeClass('top-calendar-cell');
    $('#calendar .fc-view thead th.fc-resourceName')
        .addClass('top-calendar-cell');
    $('#calendar .fc-view thead th.fc-resourceName')
        .html('<a class="filter-link" href="#">Filter Resources</a>');
}; 
```

有什么方法可以让点击持续存在，还是每次重新创建元素时我都会被迫重新分配点击？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:23:03.610

使用[`.on()`](http://api.jquery.com/on/)：

```
$(document).on("click", ".filter-link", function (e) {
     $("#filter").dialog("option", "position",
            { my: "left top", at: "left bottom", of: e });
     $("#filter").dialog("open");
}); 
```

# php - 用php比较2个多维数组

> ID：15233242
> 
> 赞同：0
> 
> 时间：2013-03-05T20:15:39.750
> 
> 标签：php, multidimensional-array

我的目标是从 Google 电子表格中获取 2 个数组，其中 1 个来自 Google 日历。除了 Calendar 数组有一个 ID 字段之外，这两个数组的格式都相同。

我的多维 Google 电子表格数组包含许多数组，如下所示：

```
array (
'startDate' => '2013-03-29',
'endDate' => '2013-03-29',
'startTime' => '08:00',
'endTime' => '20:00',
'title' => 'Ext2 Joe',
 ) 
```

我的多维 Google 日历数组包含许多数组，如下所示：

```
 array (
 'startDate' => '2013-03-29',
 'endDate' => '2013-03-29',
 'startTime' => '08:00',
 'endTime' => '20:00',
 'title' => 'Ext2 Joe',
 'id' => 'enmjke5qpjs41q93vi8tibp85k',
  ) 
```

这是我正在使用的代码。它错过了两者中存在的许多事件。我一直在努力解决这个问题，并以不同的方式重新格式化它，似乎无法让它删除重复项，只留下一个`$final_array`包含剩余内容的数组。因此，我可以将这些部分添加到 Google 日历中，因为它们尚不存在。

```
 $k=0;
 $match=0;
 $remove_events=array_values($all_events);
 $add_final_array=$final_array;
 foreach($final_array as $array_final)
 {

$h=0;

foreach ($all_events as $loop_all_events)
{   
        if ($array_final["startDate"]==$loop_all_events["startDate"]){
            if ($array_final["endDate"]==$loop_all_events["endDate"]) {
                if ($array_final["title"]==$loop_all_events["title"]) {
                    if($array_final["startTime"]==$loop_all_events["startTime"]) 
 {

                unset($add_final_array[$k]);
                unset($remove_events[$h]);
                $remove_events=array_values($remove_events);                    
                $match++;
            } } } } 

$h++;           
}

$k++;                      

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:25:37.543

```
<?php
$array1 = array (
'startDate' => '2013-03-29',
'endDate' => '2013-03-29',
'startTime' => '08:00',
'endTime' => '20:00',
'title' => 'Ext2 Joe',
 );

 $array2 = array (
 'startDate' => '2013-03-29',
 'endDate' => '2013-03-29',
 'startTime' => '08:00',
 'endTime' => '20:00',
 'title' => 'Ext2 Joe',
 'id' => 'enmjke5qpjs41q93vi8tibp85k',
  );

  $diff = my_array_diff($array1, $array2);
  echo '<pre>';
  print_r($diff);

  function my_array_diff($array1, $array2){
     $diff1 = array_diff_assoc($array1, $array2);
     $diff2 = array_diff_assoc($array2, $array1);
     $diff = array_merge($diff1, $diff2);

     return $diff;

  }
?> 
```

输出：

```
Array
(
    [id] => enmjke5qpjs41q93vi8tibp85k
) 
```

# python - Python 中的 MySQL 连接器不允许 LOAD DATA INFILE 语法

> ID：15233244
> 
> 赞同：3
> 
> 时间：2013-03-05T20:15:45.927
> 
> 标签：python, mysql-python

我正在尝试将文本文件发送到 MySQL 数据库。我正在尝试使用 python 3.2 中的 mysql 连接器来执行此操作。问题在于 LOAD DATA INFILE 语法。你可以在上面找到我的代码。我的第一个问题是无论如何都可以解决这个问题。请注意，我尝试了 local-infile =1 选项，而 Python 不允许此选项。其次，有没有其他方法可以将这些数据作为一个块发送到 mysql 数据库中？

```
from __future__ import print_function
import os
import mysql.connector
from mysql.connector import errorcode
config = {
    'user':'root',
    'password':'3778',
##  'host':'localhost',
#   'database':'microstructure',
#    'local-infile':'1',
    }

DB_NAME = 'EURUSD'
TABLES ={}
TABLES['microstructure']=(
    "CREATE TABLE `microstructure` ("
   # "  `p_id` int NOT NULL AUTO_INCREMENT,"
    "  `ticker` varchar(255),"
    "  `time` date,"
    "  `last_price` decimal(6,3)"
    ") ENGINE=InnoDB")

TABLES['cumulative']=(
    "CREATE TABLE `cumulative` ("
    "  `p_id` int NOT NULL AUTO_INCREMENT,"
    "  `ticker` varchar(255),"
    "  `time` date,"
    "  `last_price` decimal(6,3),"
    "  PRIMARY KEY(`p_id`)"
    ") ENGINE=InnoDB")

cnx = mysql.connector.connect(**config)
cursor = cnx.cursor()
path_txt = 'C:/Users/ibrahim/Desktop/testfile.txt'

def create_database(cursor):
    try:
        cursor.execute(
            "CREATE DATABASE IF NOT EXISTS {} DEFAULT CHARACTER SET 'utf8'".format(DB_NAME))
    except mysql.connector.Error as err:
            print("Failed creating database: {}".format(err))
            exit(1)
try:
    cnx.database = DB_NAME
except mysql.connector.Error as err:
    if err.errno == errorcode.ER_BAD_DB_ERROR:
        create_database(cursor)
        cnx.database=DB_NAME
    else:
        print(err)
        exit(1)

for name, ddl in TABLES.items():
    try:
        print("Creating table {}: ".format(name), end ='')
        cursor.execute(ddl)
    except mysql.connector.Error as err:
        if err.errno == errorcode.ER_TABLE_EXISTS_ERROR:
            print("Already exists")
        else:
            print(err)

    else:
        print("OK")

cursor.execute("SET @@global.local_infile = 1")

cursor.execute("LOAD DATA LOCAL INFILE 'testfile.txt' into table microstructure")

os.system("start")

cursor.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-03-20T10:31:19.040

我刚看到这篇旧帖子，但这些答案都没有解决我的问题。

我在[这里](https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html)看到有一个专用于 LOCAL DATA INFILE 的参数： `allow_local_infile=True`

所以可以这样做：

```
mysql.connector.connect(user='[username]', password='[pass]', host='[host]', allow_local_infile=True) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-04T04:19:33.477

在 MySQLdb 中，我使用它来启用`LOAD DATA LOCAL INFILE`功能：

```
MySQLdb.connect(..., local_infile=True) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-24T14:19:47.320

我也有类似的问题。我是 python 和 mysqldb 的新手。我添加了一个 conn.commit 并且它有效。似乎它通过要求提交来保护数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-05T14:38:41.927

您使用的是什么版本的 mysql.connector？我在 1.0.11 上，我得到了这个功能。我所做的是用三行（1、2、3）创建 data.txt，cd 到其中，启动 python 3.3.1，然后运行：

```
import mysql.connector
conn = mysql.connector.connect(database='test', user='test', password='xx')
curs = conn.cursor()
curs.execute('''CREATE TABLE foo (id text)''')
curs.execute('''LOAD DATA INFILE '/<full path to>/data.txt' INTO TABLE foo''')
curs.execute('''SELECT * FROM FOO''')
print(curs.fetchall())
curs.execute('''DROP TABLE foo''') 
```

我的输出：

> [('1',), ('2',), ('3',)]

请注意，您需要将 FILE 权限授予“测试”用户，例如，

```
GRANT FILE ON *.* TO 'test'@'localhost'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-25T23:31:46.670

我在这里回答了同样的问题：[https ://stackoverflow.com/a/25495823/2364773](https://stackoverflow.com/a/25495823/2364773)

简而言之，您需要使用 client_flags 参数在连接中添加客户端标志

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-07-20T07:23:30.663

我正在使用：
MySQL 服务器 8.0.25
mysql-connector-python 8.0.25
Python 3.8.10

[@Maaz](https://stackoverflow.com/users/2437141/maaz)对这个问题的回答对我有用。我无法发表评论，所以我想我会发布一个答案以在此页面上显示活动。

在添加此参数会产生影响这一事实之后，我也挖掘了一点，尽管它不应该因为默认值应该`allow_local_infile=True`根据[@abu](https://stackoverflow.com/users/710788/abu)和提供的[链接](https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html)。

在快速深入了解 的构造函数后`mysql.connector.connect`，我发现默认值最终追溯到`[python packages]\mysql\connector\constants.py`，其中列出了许多参数的默认值，其中一个是`'allow_local_infile': False`.

我希望这可以帮助任何人在未来发现这个问题！:D

# c++ - 如何在使用 Oracle OCCI 库迭代结果时计算列数？

> ID：15233245
> 
> 赞同：1
> 
> 时间：2013-03-05T20:15:51.377
> 
> 标签：c++, oracle, occi

帮帮我，我想创建一个通用函数来获取任何查询字符串的结果并将所有行放入另一个变量中。遍历一行时，我如何知道可用的列数？

```
Environment *env = Environment::createEnvironment();
Connection *conn = env->createConnection("user","pass");
quantLinhas = 0;
if( conn != NULL ) {
    Statement *stmt = conn->createStatement(query);
    ResultSet *rs = stmt->executeQuery();
    resultadoSQL->linhas.clear();
    while (rs->next()) {
        aux.campos.clear();
        numbers_colums = rs->whatever_method() //WHAT DO I DO HERE??
        for(i = 0; i < numbers_colums ; i++) {  
            aux.campos.push_back( rs->getString(i) );
            quantLinhas++;
        }
        resultadoSQL->linhas.push_back( aux );
    }
    stmt->closeResultSet(rs);
    conn->terminateStatement(stmt);
    env->terminateConnection(conn);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:26:35.750

根据[文档](http://docs.oracle.com/cd/E11882_01/appdev.112/e10764/reference027.htm#i1082585)，您可以使用`getColumnListMetaData`函数。返回向量中的元素数量可能是您想要的。您可以检查每个元素是否为[PTYPE_COL](http://docs.oracle.com/cd/E11882_01/appdev.112/e10764/reference020.htm#LNCPP1014)以确保它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-02T13:40:14.530

尝试这个

```
 vector<MetaData> columnList = rs->getColumnListMetaData();
  numbers_colums = columnList.size();
  columnList.clear(); 
```

它对我有用。 [源链接](https://docs.oracle.com/cd/B13789_01/appdev.101/b10778/metadata.htm)

# c# - Sort() 和 CompareTo() 方法的内部工作

> ID：15233246
> 
> 赞同：3
> 
> 时间：2013-03-05T20:15:51.843
> 
> 标签：c#, sorting, compareto, icomparable

我一直试图弄清楚该`CompareTo()`方法在内部是如何工作的，但我失败了。我搜索了这个站点并阅读了一些帖子，我想我已经在 MSDN 中看到了关于这个主题的所有内容，但我似乎不明白。一个 MSDN 示例：

```
public int CompareTo(object obj)
{
    if (obj == null)
    {
        return 1;
    }

    Temperature otherTemperature = obj as Temperature;
    if (otherTemperature != null)
    {
        return this.temperatureC.CompareTo(otherTemperature.temperatureC);
    }
    else
    {
        throw new ArgumentException("the object is not a temperature");
    }
} 
```

这是该`CompareTo()`方法实现的 MSDN 示例。我理解这一点，我理解`IComparable`接口是如何工作的，如果我理解正确，当我使用该`ArrayList.Sort()`方法时会调用它。

我不明白的是：程序何时传递`CompareTo(object obj)`方法的参数？或者换句话说，该`Sort()`方法是如何工作的？我的意思是，这段代码将一个温度实例与另一个温度实例进行比较，但是程序何时或如何获取第二个温度实例以进行比较？我希望我的问题是有道理的。

我已经尝试将过程打印到屏幕上，`CompareTo()`所以也许我可以对输出进行逆向工程，但我更加困惑自己。

**编辑**：也许如果我一步一步来，我可以更好地解释自己。假设我有 3 个温度对象： 34、45、21 在一个`ArrayList`. 当我打电话时`ArrayList.Sort()`，该`CompareTo()`方法被称为喜欢`34.CompareTo(45)`吗？然后`45.CompareTo(21)`呢？返回的整数在第一次比较中为 1，在第二次比较中为 -1？如果我仅`CompareTo()`在 obj（参数）为 null 时才定义返回 1 的方法，那么这些整数是如何返回的？我没有定义任何返回 -1 或 0 的东西。就好像我正在实现一个已经实现的方法。`CompareTo()`在已经定义返回 -1、0 和 1的方法时定义它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T23:03:11.793

让我们从基本思想开始。

### CompareTo 的目的是什么？

> 42 到 1337 是多少。 42... 是否*大于*、*小于*或*等于*1337？

这个问题及其答案是由和接口`CompareTo`中的方法建模的。对于，该方法可以返回：`IComparable<T>``IComparable``A.CompareTo(B)`

*   A*大于*B：大于0的整数值。
*   A*小于*B：小于 0 的整数值。
*   A*等于*B：等于 0 的整数值。

当然，`IComparable`不限于整数。您可以实现`IComparable`比较您认为应该具有可比性的任何两个对象。例如，字符串：

> 什么是“犰狳”到“十二生肖”：“犰狳”...*大于*、*小于*或*等于*“十二生肖”吗？

答案取决于您对大于、小于和等于的定义。对于字符串，通常的顺序是字典中*稍后*出现的单词*大于*较早出现的单词。

### CompareTo 如何帮助排序？

好的，现在您知道如何比较任意两个对象了。这对许多算法很有用，但主要是排序和排序算法。以一个非常简单的排序算法为例：*愚蠢的排序*。这个想法是：

> 查看数组中的两个相邻元素 A 和 B。
> 当 A <= B 时：前进到下一对。
> 当 A > B 时：交换 A 和 B，并回到前一对。
> 当我们到达终点时，我们就完成了。

您会看到，要进行排序，必须有一种方法来确定两个元素中的哪一个更大。这就是`IComparable<T>`发挥作用的地方。

```
public static void StupidSort<T>(T[] array)
            where T : IComparable<T>
{
    int index = 0;
    while (index < array.Length)
    {
        if (index == 0 ||
            array[index - 1].CompareTo(array[index]) <= 0)
        {
            index++;
        }
        else
        {
            Swap(array, index - 1, index);
            index--;
        }
    }
} 
```

### 当 CompareTo 总是返回 1 时会发生什么？

你当然可以编程`CompareTo`来返回你想要的任何东西。但是如果你搞砸了，那么你的方法就不再回答这个问题*是**什么？`this``obj`*总是返回 1 意味着对于任何 A 和 B，A 总是大于 B。这就像说：20 大于 10*和*10 大于 20。这没有意义，结果是任何排序你do 也没有任何意义。垃圾进垃圾出。

对于三个给定的对象 A、B 和 C，游戏规则是：

*   `A.CompareTo(A)`必须返回 0（*A 等于 A*）。
*   如果`A.CompareTo(B)`返回 0，则`B.CompareTo(A)`返回 0（*如果 A 等于 B，则 B 等于 A*）。
*   如果`A.CompareTo(B)`返回 0 ，则返回`B.CompareTo(C)`0，则`A.CompareTo(C)`返回 0（*如果 A 等于 B，B 等于 C，则 A 等于 C*）。
*   如果`A.CompareTo(B)`返回大于 0 的值，则`B.CompareTo(A)`返回小于 0 的值（*如果 A 大于 B，则 B 小于 A*）。
*   如果`A.CompareTo(B)`返回小于 0 的值，则`B.CompareTo(A)`返回大于 0 的值（*如果 A 小于 B，则 B 大于 A*）。
*   如果`A.CompareTo(B)`返回大于0的值，并且`B.CompareTo(C)`返回大于0的值，则`A.CompareTo(C)`返回大于0的值（*如果A大于B，B大于C，则A大于C*）。
*   如果`A.CompareTo(B)`返回一个小于 0 的值，并且`B.CompareTo(C)`返回一个小于 0 的值，则`A.CompareTo(C)`返回一个小于 0 的值（*如果 A 小于 B，并且 B 小于 C，则 A 小于 C*）。
*   `null`总是小于任何非空对象。

如果您的实现不遵守这些（简单和合乎逻辑的）原则，那么排序算法实际上可以做任何事情，并且可能不会给出您期望的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:48:10.587

有不同的排序算法。然而，不管有什么点，算法必须决定哪个元素更大，什么时候`CompareTo`被调用。

```
a.CompareTo(b) < 0; 
```

如果 a 和 b 是`Integers`（或伪代码），您还可以使用：

```
a < b 
```

我想你会`a < b`在很多伪代码或整数排序算法示例中找到这个符号。`CompareTo`方法`IComparable<T>`是一种面向对象的实现——或表示法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:23:45.783

当你想与 比较`a`时`b`，你说：

```
int result=a.CompareTo(b); 
```

即，第一个比较操作数是`this`，第二个是传递给函数的参数。

然后，当您对数组进行排序时，无论使用哪种算法，您都必须将元素一起比较，将它们发送为`this`和发送`obj`到`object.CompareTo`（或此函数的可行重载）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T20:30:49.057

排序方法与`CompareTo`方法无关。我不确定使用的是什么排序算法，但我猜它类似于快速排序（obv 不是冒泡排序）。如果您对这些算法感兴趣，维基百科会详细记录它们。

该`CompareTo`方法只是一种比较相同类型对象的方法。它是为许多常见的 .NET 类型定义的，并且可以被覆盖以在自定义对象（您创建的东西）之间进行比较。基本上，您从 A 类型的对象调用它，并传递给它 A 类型的第二个对象，返回值指示两者是否相等或一个是否大于另一个。

最好将其`CompareTo`视为效用函数。它存在，因此您可以使用常见的 .NET 数据结构提供的排序方法进行自定义比较。如果没有类似的东西，您必须自己编写排序算法才能比较您创建的类型。它的目的只是使排序方法可重用/可扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T20:25:22.380

简而言之，Sort 获取 ArrayList 的两个元素，并为第一个元素调用 CompareTo，并将第二个元素作为参数传递，如下所示：

```
element1.CompareTo(element2) 
```

如果 element1 小于 element2，CompareTo 返回负值，如果相等则返回 0，否则返回正值。Sort 使用这个返回值，嗯，做一些排序。然后它对接下来的两个元素重复这个过程，再做一些排序，依此类推，直到 ArrayList 被排序。搜索“排序算法”以获取有关此过程的更多信息。

# c++ - 定义一个宏，如果之前未定义，则取消定义它

> ID：15233248
> 
> 赞同：0
> 
> 时间：2013-03-05T20:15:55.367
> 
> 标签：c++, c-preprocessor

我包括需要某些 pro-processor`#define`存在的头文件，但是我不希望这污染我的其余代码，例如：

```
// FOO may or may not already be defined here
#define FOO
#include "Bar.h"
#undef FOO
// FOO should be defined or not, as per the starting state 
```

我的思路是这样的：

```
#ifdef FOO
#define FOO_DEFINED
#endif

#define FOO
#include "Bar.h"

#ifndef FOO_DEFINED
#undef FOO
#else
#undef FOO_DEFINED
#endif 
```

问题：

1.  上述工作是否可以将所有宏定义（或缺少）恢复到它们之前的状态？

2.  是否有更简单的解决方案？

3.  我是否已经定义了 FOO 是否重要`#define`？我应该添加另一个`#ifndef`来防止这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:23:24.573

在您的示例中， Bar.h 似乎只关心是否定义了 FOO，而不关心绑定到它的实际表达式。此外，如果其他人（我假设您的代码示例本身在头文件中）定义 FOO 并关心绑定到它的表达式，您不想犯用空表达式重新定义 FOO 的错误。如果是这样，您可能需要简化：

```
#ifndef FOO
#define FOO
#define UNDEF_FOO
#endif

#include "Bar.h"

#ifdef UNDEF_FOO
#undef FOO
#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:24:29.660

1.  是的，它应该工作。
2.  我有 #pragma push_macro/pop_macro("macro_name") 的想法，但它可能只适用于 gcc 和 MS VC++
3.  是的，这很重要，如果再次使用不同的值定义它，您会收到警告。正如您所说，您可以使用#ifndef 屏蔽它。

# java - 如何使用“this”作为另一个对象的参数？

> ID：15233256
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:16:17.560
> 
> 标签：java, reference, parameter-passing, this

首先我知道这一定很简单，我一直在尝试在 Stackoverflow.com 和 Google 上阅读类似的问题，但我仍然无法让我的程序正常工作。

我很快就编写了我的程序正在尝试做的事情的摘要：

```
 public class One{

    public One(){
        Two t = new Two(this);
    }

    public void doSomething(){
        sout("HERE");
    }

    public static void main(String[] args){
        One o = new One()
        Two t = new Two(o);
    }

}

    public class Two{

        public Two(One o){
            One o = o;
            o.doSomething();
        }
    } 
```

当我运行程序时，我从方法调用 o.doSomething() 中得到一个 NullPointerException。我一直在尝试修复它，但我很难过。如果有人能快速告诉我修复它将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T20:20:40.867

```
One o = o; 
```

我不知道这是什么意思，但它不会工作。这应该是成员变量（`this.o`）吗？为此，请将其放入类而不是函数中：

```
public class Two{
    private One o;

    public Two(One o){
        this.o = o;
        o.doSomething();
    }
} 
```

如果您不需要它，或者完全删除它：

```
public class Two{
    public Two(One o){
        o.doSomething();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:22:54.177

我已经修改了你的课程请检查我认为它应该可以工作

公开课一{

```
public One(){
    Two t = new Two(this);
}

public void doSomething(){
    System.out.println("HERE");
}

public static void main(String[] args){
    One o = new One();
    Two t = new Two(o);
} 
```

}

```
public class Two{

    public Two(One one){
        One o = one; //just changed the parameter name to one
        o.doSomething();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:31:03.527

当你想引用当前对象时使用“this”这个词；此外，当您想访问当前对象的变量“something”时，可以使用“this.something”。

例如，您可以将其插入代码中以区分“this.o”（对象的属性）和“o”（输入参数）：

```
import java.io.*;

public class One{
    public One(){
        Two t = new Two(this);
    }

    public void doSomething(){
        System.out.println("HERE");
    }

    public static void main(String[] args){
        One o = new One();
        Two t = new Two(o);
    }
}

public class Two{
    One o;

    public Two(One o){
        this.o = o;
        this.o.doSomething();
    }
} 
```

这将编译并产生一个输出：

这里
这里

那是你要的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T20:18:59.910

该方法`sout("HERE")`不存在。如果您尝试将某些内容打印到控制台，则应使用`System.out.println("HERE")`.

# eclipse - Eclipse每次运行项目都会修改server.xml（Run-->Run on Server）

> ID：15233263
> 
> 赞同：16
> 
> 时间：2013-03-05T20:16:58.077
> 
> 标签：eclipse, settings, tomcat7, eclipse-juno

我在 Eclipse Juno 上使用 Tomcat 7。我使用工作区元数据作为服务器位置（请参阅下面的我的 tomcat 配置）。

![Tomcat 配置](../Images/5ad8b66d7c0e9bd5dd8300eff37d81b4.png)

此外，我在 Eclipse 中获得了一个**服务器项目**[请参见下图]，其中包含单独的 server.xml 和其他配置文件。

![服务器项目](../Images/034cab3a0fccb195d6316f087405bae3.png)

通常它工作正常。在我更改了 SSL 配置的 server.xml（在 eclipse 项目中）之后，这个问题就出现了。

配置工作正常。但是每次我运行项目（运行-->在服务器上运行）时，server.xml 都会被修改为默认版本。我的自定义 SSL 更改丢失。

我还尝试在 tomcat 安装位置 (C:\apache-tomcat-7.0.35\conf) 中更改 server.xml，但它没有从 eclipse 中选择。

谁能帮我解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-01-11T14:59:59.927

在**{workspace}/Servers**中，您将找到每个 Tomcat 配置的文件夹，其中包含多个配置文件，包括**server.xml**。然后您可以**在那里直接编辑文件**。

要考虑到更改，请**重新启动 Eclipse**。这比一直删除和添加配置要好。使用 Eclipse **Mars**和**Tomcat 7**进行了测试。

（解决方法来自：[Eclipse with tomcat - eclipse modifies server.xml](https://stackoverflow.com/questions/5485760/eclipse-with-tomcat-eclipse-modifies-server-xml)）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-05T21:43:00.283

我找到了一个适用的解决方案，但不是一个完美的解决方案。

我所做的是；

1.更改安装位置的 server.xml 文件（在我的情况下为 C:\apache-tomcat-7.0.35\conf）

2.从eclipse服务器面板中删除tomcat服务器（请看下图）

3.在eclipse服务器面板中新建一个服务器。

4.然后服务器项目将使用我的自定义更改生成新的 server.xml。

5.诀窍是，当在面板中创建新服务器时，最初 eclipse 从安装位置选择 server.xml。

谢谢

![eclipse 服务器面板](../Images/f4061e21c8fd6bb6c27b77cdddb7b70a.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-29T14:11:42.800

确保您正在编辑 Tomcat 服务器文件夹下的文件，而不是 config 文件夹下的文件。检查随附的屏幕截图以获取我所指的文件。

[![在此处输入图像描述](../Images/9d1dc67a96fc457a3ba8112196d90b3c.png)](https://i.stack.imgur.com/7ROYg.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-07T15:36:27.730

我也遇到了这个问题，并且解决方案有效（我没有足够的声誉点来投票支持答案）。

同样，我必须对端口号进行配置更改，这还需要我从 STS（spring 工具套件）中删除并重新添加我的 tomcat 实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-16T14:58:36.553

在 Eclipse 上，双击 Server 以查看属性。
选中“发布模块上下文以分隔 XML 文件”，然后保存。运行 Tomcat 服务器。Eclipse 将在不触及 server.xml 的情况下创建 conf/[enginename]/[hostname]/[appname].xml

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-24T19:27:43.367

确保 server.xml 中的路径与 Web 项目设置中的路径相同。

要查看 Web 项目设置：右键单击项目 >> 属性 >> Web 项目设置。

总是在这里给出项目路径。server.xml 中的路径会自动更新。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-10-16T13:39:36.470

清理 Tomcat 工作目录并重新发布项目。

[![在此处输入图像描述](../Images/7ff5ccc49babea3b6ae0407f3a23e113.png)](https://i.stack.imgur.com/Ov99d.png)

# c - C - 整数输入验证码

> ID：15233268
> 
> 赞同：0
> 
> 时间：2013-03-05T20:17:24.973
> 
> 标签：c, validation, input, integer

我在 C 中有以下代码：

```
#include "stdafx.h"
#include <stdlib.h>
#include <cstring>
#include <ctype.h>

int main()
{
    char buffer[20];
    int num;
    bool valid = true;

    printf("Please enter a number\n");
    fgets(buffer, sizeof(buffer), stdin);
    printf("\n\n");

    if(!isdigit(buffer[0])) //Checking if the first character is -
    {
        if(buffer[0] != '-')
        {
            valid = false;
        }

        else
        {
            if(!isdigit(buffer[1]))
            {
                valid = false;
            }
        }
    }

    char *pend = strrchr(buffer, '\n'); //Replacing the newline character with '\0'

    if (pend != NULL)
    {
        *pend = '\0';
    }

    for (int i = 1; i < strlen(buffer); i++) //Checking that each character of the string is numeric
    {
        if (!isdigit(buffer[i]))
        {
            valid = false;
            break;
        }
    }

    if(valid == false)
    {
        printf("Invalid input!");
    }

    else
    {
        num = atoi(buffer);
        printf("The number entered is %d", num);
    }
    getchar();
} 
```

基本上，代码确保用户输入是正整数或负整数。不允许使用字母、浮点数等。

该代码运行良好并且工作良好。

但是，代码太长，我必须在许多程序中实现它。有没有一种简单的方法可以在 C 中执行上述所有操作？也许是一个较短的替代方案，可确保输入是：

i) 不是字母 ii) 正整数或负整数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:23:08.903

```
bool valid = false;
char *c = buffer;
if(*c == '-'){
   ++c;
}
do {
   valid = true;
   if(!isdigit(*c)){
      valid = false;
      break;
   }
   ++c;
} while(*c != '\0' && *c != '\n'); 
```

注意：这不会处理十六进制值，但会传递八进制（从 0 开始的整数）

我还必须同意这应该放在一个公共库中并作为一个函数调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T00:27:13.413

尽管有人指出 strtol 可能不会给您所需的错误，但这是一种非常常见的事情，因此它确实存在于标准库中：

[http://www.cplusplus.com/reference/cstdio/sscanf/](http://www.cplusplus.com/reference/cstdio/sscanf/)

```
#include <stdio.h>

// ....

valid = sscanf (buffer,"%d",&num); 
```

另一条评论是，您不应该害怕编写复杂而有用的代码并将其模块化。为您认为有用的输入解析例程创建一个库！

# haskell - 试图用 Happstack 将 HSP 和 Acid-state 以一种形式结合在一起

> ID：15233269
> 
> 赞同：0
> 
> 时间：2013-03-05T20:17:37.980
> 
> 标签：haskell, happstack, acid-state

我遵循了 Happstack Crash Course，现在我正在尝试将不同的东西放在一起：

从“使用改革的类型安全表单处理”（[http://happstack.com/docs/crashcourse/Reform.html#reform](http://happstack.com/docs/crashcourse/Reform.html#reform)）我已经编写了这个注册表单：

```
register :: AcidState UserBase -> ServerPart Response
register acid = unXMLGenT $
  appTemplate "register" () $
        reform (form "/register") "register" (insertAndRenderUser acid) Nothing registerForm

insertAndRenderUser :: (Monad m) => AcidState UserBase -> User -> AppT m XML
insertAndRenderUser acid user = 
    <dl>
      <dt>lastname:</dt>    <dd><% lastName user    %></dd>
      <dt>firstname:</dt>   <dd><% firstName user   %></dd>
      <dt>email:</dt> <dd><% email user %></dd>
      <dt>birthday:</dt> <dd><% show (birthday user) %></dd>
    </dl>

registerForm :: SimpleForm User
registerForm =
    User (UserId 0)
     <$> (errorList ++> label "Last name:"  ++>  (inputText "" `transformEither` required) <++ br)
     <*> (errorList ++> label "First name:" ++> (inputText "" `transformEither` required) <++ br)
     <*> (errorList ++> label "E-mail:"     ++> (inputText "" `transformEither` required) <++ br)
     <*> (errorList ++> label "Birthday:"   ++> (inputText "" `transformEither` requireDate) <++ br)
     <*  inputSubmit "Register" 
```

现在我想在表单成功时添加注册用户。我在酸状态（[http://happstack.com/docs/crashcourse/AcidState.html#ixset](http://happstack.com/docs/crashcourse/AcidState.html#ixset)）的帮助下编写了这个 UserBase

```
insertUser :: MonadIO m => AcidState (EventState InsertUserIntern) -> User -> m (EventResult InsertUserIntern)  
insertUser acid user = do
  update' acid (InsertUserIntern user) 
```

这些片段单独工作，但我可以`insertUser acid user`在哪里插入`insertAndRenderUser`？

我希望你能帮助 我
谢谢弗洛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:35:57.183

我自己得到了

```
insertAndRenderUser acid user = do
  insertUser acid user 
  appTemplate "Your Registration" () $
    <dl>
      <dt>lastname:</dt>    <dd><% lastName user    %></dd>
      <dt>firstname:</dt>   <dd><% firstName user   %></dd>
      <dt>email:</dt> <dd><% email user %></dd>
      <dt>birthday:</dt> <dd><% show (birthday user) %></dd>
    </dl> 
```

# c++ - C++ 翻译成 Objective-C

> ID：15233273
> 
> 赞同：1
> 
> 时间：2013-03-05T20:17:48.430
> 
> 标签：c++, objective-c, xcode, constants, translation

我正在考虑将一些代码从 C++ 转换为 Objective C，我遇到了一个实例，该实例包含一个末尾带有 const 表示法的函数。我对 C++ 很生疏，我不记得这代表什么（尽管我一直在谷歌搜索）。我想知道如何将它强制到Objective-C。目前，这就是我所拥有的：

C++ 代码：

```
 float RenderingEngine1::RotationDirection() const
    {
        float delta = m_desiredAngle - m_currentAngle;
        if (delta == 0)
            return 0;

        bool counterclockwise = ((delta > 0 && delta <= 180) || (delta < -180));
        return counterclockwise ? +1 : -1;
    } 
```

目标-C：

```
-(float)getRotationDirection{
    float delta = desiredAngle - currentAngle;
    if (delta == 0) {
        return 0;
    }

    bool counterclockwise = ((delta > 0 && delta <= 180) || (delta < -180));

    float test = counterclockwise ? +1 : -1;
    NSLog(@"%f",test );
    return counterclockwise ? +1 : -1; //problem

} 
```

编辑：发现我的方式的错误，这只是程序中其他地方的一个附加问题（'我喜欢简单的'）。话虽如此，我确实想确保 const 声明不会干扰任何进一步的问题，并想检查以确保是否应该有任何我需要进行的声明（例如单例方法等）。谢谢你们的答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:27:04.193

c++ 中的 const 意味着这个方法不会改变对象的状态，因此它可以只使用 const 方法，并且它不能改变类变量，除非它们被声明为可变的。

如果您的类是不可变的，您可以放心地假设您声明的每个方法都等效于 const 方法。

但是，由于您没有更改任何 ivar，因此您正在正确“翻译”代码（从逻辑上讲），因为您没有更改任何 ivar。

我没有看到您的代码有任何特殊问题，不应该有语法（既不是语义）错误。

PS：这不是你应该如何比较浮点数，[看这里](http://www.cygnus-software.com/papers/comparingfloats/Comparing%20floating%20point%20numbers.htm)。

# java - 数据访问对象 (DAO) 中的方法应该抛出还是捕获其异常？

> ID：15233276
> 
> 赞同：10
> 
> 时间：2013-03-05T20:17:50.240
> 
> 标签：java, spring, jakarta-ee, architecture, dao

我在数据访问对象中有一个 Java 方法。这个非常简单的方法将两个整数值插入数据库。

```
public void saveHourMin(int hour, int min) throws SQLException{
psInsert.setInt(1, hour);
psInsert.setInt(2, min);
psInsert.executeUpdate();
} 
```

这个方法，或者一般来说，任何 DAO 方法，应该在抛出 SQLException 时抛出异常，还是应该捕获并记录异常，然后通过返回码通知用户？哪个是使用 Spring 的应用程序的正确方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:30:50.227

您不能指望调用者始终检查返回码，最好抛出异常。

如果你抛出 SQLException 那么这将是一团糟，你可能最终会得到更高的层，或者在每个方法上添加“抛出异常”，或者只是吃异常。这些选择中的任何一个都不好。

Spring 的做法是提供一个异常转换器，接收原始 SQLException 并抛出 RuntimeException 的子类，该子类包括原始 SQLException 作为原因，并尝试提供尽可能多的有关错误的信息，包括使用供应商错误代码决定抛出哪个特定的子类。如果您使用 Spring 的任何 jdbcTemplates，那么您将获得异常转换功能，因此您不需要在数据访问对象中包含任何异常捕获或抛出。

如果不想使用 Spring，可以在 DAO 中捕获 SQLException 并抛出 RuntimeException，包括原始 SQLException 作为原因。对于大多数 SQLException，您无能为力，您只想快速失败并记录异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:21:09.290

我会说不。捕获 SQLException，然后抛出 RuntimeException 或一个 if 后代。您不想让数据访问异常污染您的应用程序。例如，您不应该在 GUI 层中捕获 SQLExceptions。我也不会基于返回码构建应用程序。

通过抛出 RuntimeException 您也不会强迫调用者捕捉它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:35:59.713

我将创建一个名为 DAOException 的新异常，它不是 RuntimeException，并强制该方法的用户处理此类异常，并可能将枚举作为描述异常的 DAOException 的成员（可能在内部添加实际异常作为内部异常）。

所以抛出的异常可能如下所示：

```
new DAOException(DAOException.TYPE.SQLE, e) 
```

并且方法 saveHourMin 抛出 DAOException。

这样，如果你遇到各种问题，都属于同一种异常，你不必处理不同的异常。

我建议使用一般异常而不是运行时的原因是因为我不希望它是可选的来处理异常。调用此方法的人必须意识到可能会发生此类问题并提供相关处理（即使这意味着抛出新的 RuntimeException，上帝保佑，但现在由他们决定，这是他们的决定）。作为一般的经验法则，我会避免使用 RuntimeExceptions，因为它们使执行路径不清楚（“有人可能会在执行路径的某个地方捕捉到它，否则它会杀死应用程序，所以可以放手”听起来不对我好）。

# python - 带有 kivy 语言和自定义小部件的 Kivy 滚动视图

> ID：15233277
> 
> 赞同：0
> 
> 时间：2013-03-05T20:17:55.967
> 
> 标签：python, scrollview, kivy

我正在使用 Kivy，一个 Python 库，我无法让滚动视图正常工作，并将其组织到 .kv 文件中。

我有一个很大的系统，它被分解成许多 .py 和 .kv 文件。

我也在用kivy的屏幕管理器

ui_manager.py

```
#ui_manager.py
class UIManager():
    _ScreenManager = None

    def __init__(self, inScreenManager):
        self.ScreenManager = inScreenManager # The main app constructs the manager, sends to me, then returns it as the root widget. 
```

主文件

```
#main.py
class MyApp(App):
    def build(self):
        screenManager = ScreenManager()
        uiManager = ui_manager.UIManager(screenManager)
        return screenManager 
```

显然我省略了一些代码，但这几乎就是发生的事情。

其中一个屏幕需要滚动。它将有一个长图形和许多按钮。像往常一样，Kivy 文档只告诉我如何通过代码进行操作，而不是通过 kivy 语言（.kv 文件） [http://kivy.org/docs/api-kivy.uix.scrollview.html](http://kivy.org/docs/api-kivy.uix.scrollview.html)

我想要一个类 OrangeWidget 来保存滚动小部件，以便我以后可以使用它的数据。这是我让有组织的滚动视图工作的最佳尝试

橙色小部件.py

```
#orange_widget.py

class OrangeWidget(Screen):
    pass

class OrangeGraphic(Widget):
    pass 
```

橙色.kv

```
<OrangeLineWidget>
    ScrollView:
        size_hint: (None, None)
        size: (400, 1200)

        OrangeLineGraphic:
            pos: root.pos

<OrangeGraphic>
    canvas:
        Color:
            rgba: 1, .5, 0, 1       
        Rectangle:
            pos: self.center_x - 15, 0
            size: 30, self.height * 2
    Label:
        text: "Hello" 
```

我知道它很多，而且看起来组织得不太好，但我只是想弄清楚如何让这该死的东西正常工作。

这是当前结果：它不会滚动，并且无论出于何种原因，它都被“装箱”到右侧，而不是占据整个屏幕 ![在此处输入图像描述](../Images/018414c7745e9e10c58045be5f9938a5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T13:19:01.037

正如在 ML 上回答的那样，在这里您没有定义 Label pos，您的 OrangeGraphic 是一个简单的小部件，而不是布局，您需要这样做：

```
<OrangeGraphic>
    canvas:
        Color:
            rgba: 1, .5, 0, 1       
        Rectangle:
            pos: self.center_x - 15, 0
            size: 30, self.height * 2
   Label:
        text: "Hello"
        pos: root.pos
        size: root.size 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T17:56:09.210

对于这个特殊的“滑动”屏幕，看起来诀窍是使用“相对布局” [https://groups.google.com/forum/#!topic/kivy-users/RwuI8QGm3fw](https://groups.google.com/forum/#!topic/kivy-users/RwuI8QGm3fw)

这是更新的代码：orange_widget.py

```
class OrangeWidget(Screen):

    def __init__(self, **kwargs):
        super(OrangeWidget, self).__init__(**kwargs)

        scrollView = ScrollView(size_hint=(1, 1))

        # add custom widget into that layout
        customWidget = OrangeGraphicWidget(height=1200, size_hint_y=None)
        #layout.bind(minimum_height=layout.setter('height'))

        scrollView.add_widget(customWidget)

        self.add_widget(scrollView)

class OrangeGraphicWidget(RelativeLayout):
    pass 
```

OrangeWidget.kv

```
<OrangeWidget>

<OrangeGraphicWidget>
    canvas:
        Color: 
            rgba: 1, .5, 0, 1           
        Rectangle:
            pos: self.center_x - 15, 20
            size: 30, self.height - (self.height / 10)

    Button:
        text: "Button 1"
        pos: root.pos
        size_hint: (None, None)

    Button:
        text: "Button 2"
        pos_hint: {'center_x': .5, 'center_y': .95}
        size_hint: (None, None) 
```

# c# - 绑定实际何时发生

> ID：15233278
> 
> 赞同：2
> 
> 时间：2013-03-05T20:17:59.950
> 
> 标签：c#, .net, wpf

在弹出窗口上，我`checkbox.IsChecked`绑定了一个模型，但我想在显示窗口时从后面的 xaml 代码中检查它的状态。当在 windows 加载事件后面的代码中按名称检查复选框时，它尚未设置。我需要做一些特定于 UI 的事情，这就是为什么我需要知道窗口打开时复选框的值是什么，而我无法从 checkbox.IsChecked 绑定到的模型中执行此操作。

模型上的属性在弹出窗口打开之前很久就设置好了，所以这不是绑定不存在的问题。我认为一旦 Loaded 事件触发，窗口就会准备好使用绑定和所有内容，但情况似乎并非如此。

xml:

```
<RefinedRibbonControls:RefinedRibbonGroup Header="Show Graphs">
                    <StackPanel x:Name="panelVisibilities">
                        <CheckBox Content="Show/hide" x:Name="myCheckBox"                                 
                                  IsChecked="{Binding Path=Processor.Model.IsItemVisible}"
                                  Click="GraphVisibilityClickEvent"
                                  HorizontalAlignment="Left"/>
...etc 
```

模型属性：

```
public bool IsItemVisible
        {
            get { return _isItemVisible ; }
            set
            {
                if (_isItemVisible != value)
                {
                    _isItemVisible = value;
                    _propertyChanger.FirePropertyChanged(this, m => m.IsItemVisible);
                }
            }
        } 
```

Xaml 代码隐藏中的事件：

```
private void WindowLoadedEvent(object sender, RoutedEventArgs e)
        {
            if(myCheckBox.IsChecked.Value)
            {
                // Do UI Related Stuff
            }
         } 
```

绑定工作正常，显示窗口时显示值，问题是我无法在窗口加载事件中获取绑定的值。

编辑：我找到了可能的解决方案，但我不确定它是否是最好的方法。我从后面的 xaml 代码的构造函数中调用了以下方法。

```
private void SetupInitialVisibility()
        {
            //Fire after everything is loaded.
            Dispatcher.BeginInvoke(DispatcherPriority.ContextIdle, new Action(() =>
            {
                IEnumerable<CheckBox> elements = this.panelVisibilities.Children.OfType<CheckBox>().ToList();
                foreach (CheckBox checkBox in elements)
                {
                    if (checkBox.IsChecked != null && checkBox.IsChecked.Value == false)
                    {
                        //Do work
                    }
                }

            }));
        } 
```

发现于：[https ://stackoverflow.com/a/1746975/1253746](https://stackoverflow.com/a/1746975/1253746)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:06:28.953

数据绑定不是同步完成的，而是延迟的。检查[此 msdn 页面](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherpriority.aspx)上的调度程序优先级。它以低于普通窗口消息的优先级完成，但在渲染之前完成。

您可以调用自己的方法，其优先级低于为数据绑定定义的优先级，在此方法中您应该能够安全地读取数据绑定值。

我仍然会觉得这很难看。我宁愿直接订阅`PropertyChanged`并检查此属性，或者更好的是，将您的“UI 相关代码”重写为数据绑定。

PS 如果您开始消费事件，请务必取消订阅，否则您可能会出现内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:17:22.087

我认为 DataBinding 应该在 Loaded 事件之前。

何时以及如何设置 DataContext？你肯定 viewmodel 属性已经设置了吗？

以下工作，如果可能，请尝试将您的代码与此对齐。

xml:

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1"
        Title="MainWindow" Height="350" Width="525">

    <Window.DataContext>
        <local:ViewModel />
    </Window.DataContext>
    <Grid>
        <CheckBox x:Name="myCheckBox" IsChecked="{Binding IsItemVisible}" />
    </Grid>
</Window> 
```

代码背后：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        this.Loaded += MainWindow_Loaded;
    }

    void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        if (myCheckBox.IsChecked.Value)
        {
            //...
        }
    }
} 
```

视图模型：

```
public class ViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private bool isItemVisible;
    public bool IsItemVisible { get { return isItemVisible; } set { isItemVisible = value; OnPropertyChanged("IsItemVisible"); } }

    public ViewModel()
    {
        this.IsItemVisible = true;
    }

    private void OnPropertyChanged(string propertyName)
    {
        if (this.PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

![在此处输入图像描述](../Images/2c09c6b22c05e06344578acb2bcd1ca9.png)

# quickblox - 通过 ID 检索用户，iOS 聊天 SDK

> ID：15233281
> 
> 赞同：1
> 
> 时间：2013-03-05T20:18:11.127
> 
> 标签：quickblox

我正在尝试将 Quickblox 集成到我的应用程序中，我的用户 ID 与 Quickblox 用户 ID 匹配，所以当我在某个用户的页面上时，我知道他的 ID，我需要从 Quickblox 数据库中检索该用户，将他设置为对手并初始化与该对手的聊天。不幸的是，我无法通过 QBUsers userWithID 调用来检索它（在委托中接收错误）。请您提供一个通过 ID 检索用户并将他设置为对手的简单示例。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T08:24:52.980

这是一个解决方案：

1) 将您的用户连接到 QuickBlox 用户。QuickBlox 用户有**externalUserID**字段，因此请将您的系统用户 ID 设置为该字段

```
QBUUser *user = [QBUUser user];
user.login = @"iostest3355";
user.password = @"iostest3355";
user.externalUserID = 46732; // you system user id

[QBUsers signUp:user delegate:self]; 
```

2）接下来，你有你的系统用户ID，你需要检索QuickBlox用户

```
[QBUsers userWithExternalID:46732 delegate:self];

 - (void)completedWithResult:(Result *)result{
     if(result.success && [result isKindOfClass:QBUUserResult.class]){
          QBUUserResult *res = (QBUUserResult *)result;
          int qbUserID = res.user.ID;
     }
} 
```

3）使用**qbUserID**聊天

# java - 将事件直接添加到日历

> ID：15233288
> 
> 赞同：1
> 
> 时间：2013-03-05T20:18:38.747
> 
> 标签：java, android, calendar

我正在尝试使用此代码直接添加事件：

```
// Construct event details
long startMillis = 0;
long endMillis = 0;
Calendar beginTime = Calendar.getInstance();
beginTime.set(2013, 3, 14, 7, 30);
startMillis = beginTime.getTimeInMillis();
Calendar endTime = Calendar.getInstance();
endTime.set(2013, 3, 14, 8, 45);
endMillis = endTime.getTimeInMillis();

// Insert Event
ContentResolver cr = getContentResolver();
ContentValues values = new ContentValues();
values.put(CalendarContract.Events.DTSTART, startMillis);
values.put(CalendarContract.Events.DTEND, endMillis);
values.put(CalendarContract.Events.TITLE, "Walk The Dog");
values.put(CalendarContract.Events.DESCRIPTION, "My dog is bored, so we're going on a really long walk!");
values.put(CalendarContract.Events.CALENDAR_ID, 3);
values.put("eventTimezone", "Europe/London");
Uri uri = cr.insert(CalendarContract.Events.CONTENT_URI, values);
// Retrieve ID for new event
String eventID = uri.getLastPathSegment(); 
```

此代码在语法上是正确的，但不会将事件添加到日历中。问题是什么？Eclipse 这么说

```
String eventID = uri.getLastPathSegment(); 
```

未使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:27:27.117

检查您是否`WRITE_CALENDAR`有权以这种方式创建事件。

此外，在您的示例中，`eventID`确实没有使用该变量->您什么也不做。

# c# - ToString("X") 产生一位十六进制数

> ID：15233290
> 
> 赞同：28
> 
> 时间：2013-03-05T20:18:47.323
> 
> 标签：c#, hex

我们编写了一个粗略的数据范围。

（我们发现的免费终端程序跟不上蓝牙速度）

结果没问题，我们正在将它们写入逗号分隔的文件以用于电子表格。最好在 RichTextBox 中的漂亮列中看到十六进制值排列，而不是现在的样子（附加屏幕帽）。

这是将数字（例如，从`0`到的数字`FF`）添加到 RichTextBox 中的文本的例程。

```
 public void Write(byte[] b)
         {
             if (writting)
             {
                 for (int i = 0; i < b.Length; i++)
                 {
                     storage[sPlace++] = b[i];

                     pass += b[i].ToString("X") + " ";  //// <<<--- Here is the problem

                     if (sPlace % numericUpDown1.Value == 0)
                     {
                         pass += "\r\n";
                     }
                 }
             }
         } 
```

我想要一种方法让指令在to`pass += b[i].ToString("X") + " ";`的值上产生前导零`00h``0Fh`

或者，将字节中的值`b`转换为两个字母字符的其他`00`方式`FF`

![在此处输入图像描述](../Images/56a57304283ae0afc33b416f6262dd4b.png)

左边的数字，`FF 40 0 5`排列整齐，因为它们是相同的。一旦我们遇到数据中的任何差异，列就会消失，并且人类观察数据变得非常难以阅读。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-05T20:20:42.047

使用[复合](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)格式字符串：

```
pass += b[i].ToString("X2") + " "; 
```

MSDN 上的文档，[Standard Numeric Format Strings](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)有示例。

# jquery - 让 DIV 慢慢移出屏幕

> ID：15233296
> 
> 赞同：3
> 
> 时间：2013-03-05T20:19:17.727
> 
> 标签：jquery, css, jquery-animate

我想创建一个记分牌，列出最近的获奖者。当宣布新的获胜者时，我希望三个当前的获胜者向右滑动，新的获胜者从左边滑到适当的位置，最老的获胜者（最右边）滑出屏幕。

使用下面的代码，除了右侧之外，我一切正常。现在，它就消失了（我希望它优雅地滑出右侧）。

**HTML**

```
<div id="results-wrapper">
    <div class="contest-results" id="recent-winners">Recent winners:</div>
    <div class="contest-results" id="winner-wrapper">
        <div class="winner">John</div>
        <div class="winner">Katie</div>
        <div class="winner">Peter</div>
    </div>
</div> 
```

**CSS**

```
#results-wrapper {
    display:inline-block;
    padding: 6px 3px 4px 3px;
    font-size: 16px;
}
.contest-results {
    float:left;
}
#recent-winners {
    width: 120px;
    text-align: left;
}
#winner-wrapper {
    width: 444px;
    height: 20px;
    white-space: nowrap;
    overflow: hidden;
}
.winner {
    text-align: center;
    width: 148px;
    float:left;
    position: relative;
    display: inline;
} 
```

**JS**

```
$("#winner-wrapper").on("click", ".winner", function() {
    $('.winner:first').before('<div style="display: none;" class="winner">justin</div>');
    $('.winner').css({"display" : "inline", "left" : "-148px"});
    $('.winner').animate({"left" : "0px"}, {duration : 600, easing : "swing"});
    $('.winner:last').remove();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:26:26.827

```
<!DOCTYPE html>
<html>
<head>
  <style>
div {
  position:absolute;
  background-color:#abc;
  left:50px;
  width:90px;
  height:90px;
  margin:5px;
}
</style>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
  <button id="left">&laquo;</button> <button id="right">&raquo;</button>
<div class="block"></div>

<script>
$("#right").click(function(){
  $(".block").animate({"left": "+=50px"}, "slow");
});

$("#left").click(function(){
  $(".block").animate({"left": "-=50px"}, "slow");
});

</script>

</body>
</html> 
```

[直接从http://api.jquery.com/animate/](http://api.jquery.com/animate/)复制

50px 是要移动的距离 slow 是速度（慢、中、快或者你可以输入毫秒数）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:37:13.560

这里的主要问题是 using`float: left`基本上否定了`white-space: nowrap`.

[`float`](https://developer.mozilla.org/en-US/docs/CSS/float)如来自 MDN的条目中所述：

> 由于`float`隐含地暗示使用块布局，它`display`在某些情况下会修改值的计算值

要执行您想要的功能，首先将 CSS 属性更改为`winner`remove`float`和 have `display: inline-block`。

```
.winner {
    text-align: center;
    width: 148px;
    position: relative;
    display: inline-block;
} 
```

`inline-block`然后修改 JavaScript 以在滑动动画完成后也处理和删除最后的获胜者。

```
$("#winner-wrapper").on("click", ".winner", function () {
    var first = $(".winner").first();
    var last = $(".winner").last();
    first.before('<div style="display: none;" class="winner">justin</div>');
    $('.winner').css({
        "display": "inline-block",
        "left": "-148px"
    });
    $('.winner').animate({
        "left": "0px"
    }, {
        duration: 600,
        easing: "swing",
        complete: function () {
            last.remove();
        }
    });
}); 
```

[**演示**](http://jsfiddle.net/Ryn2S/)

[**替代演示**](http://jsfiddle.net/9ALEy/)（带有其他行为）

# remote-access - 如何从另一个网络授予对 mysql 数据库的远程访问权限？

> ID：15233301
> 
> 赞同：0
> 
> 时间：2013-03-05T20:19:38.000
> 
> 标签：remote-access

我在 Mac 上使用 MAMP。我已使用以下方式授予对所有 IP 地址的访问权限：GRANT ALL PRIVILEGES ON database.* to '%' IDENTIFIED BY 'somepassword'; 同花顺特权；我的团队成员需要在家中访问此数据库，这意味着他们与我不在同一个网络上。我研究了如何使用 msql 工作台建立测试连接，但这意味着他们也必须在他们的计算机上安装它，不是吗？另外，如果我的数据库路径明显在**我的**计算机上，那么主机信息在他们的新连接设置上会是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:41:49.737

我假设您的 Mac 坐在您家中的路由器后面。您应该做的第一件事是打开/转发访问路由器中的 mysql 所需的端口。默认值应为 3306。因此，通过此端口发送到路由器的任何请求都会发送到您的 Mac。请查看您的路由器手册。然后您的同事需要您当前的 IP ( [http://whatismyipaddress.com/](http://whatismyipaddress.com/) )。

使用 IP 和端口，他们应该能够在您的 Mac 上创建与 mysql 服务器的连接。

完成这项工作后，您可以查看“动态 dns”主题，以说明您的家庭 IP 地址的更改。

# asp.net - wcf nettcpbinding 一个现有的连接被远程主机强行关闭

> ID：15233302
> 
> 赞同：0
> 
> 时间：2013-03-05T20:19:41.417
> 
> 标签：asp.net, wcf, iis, nettcpbinding, was

**开发环境：**

服务托管在 IIS/WAS 下

我在本地开发中开发了四项服务。当我从 asp.net 应用程序访问它们时，它们都工作正常。我正在使用 net.tcp 协议进行连接。我已将 net.tcp 指定为站点级别和虚拟目录级别的允许协议。与 tcp 相关的三个服务全部启动。

在我能够连接到服务的应用程序 web.config 中，我正在使用模拟

但是当我尝试通过在 wcftestclient 的添加服务项目中指定 net.tcp url 来连接服务时。我无法连接。对另外两个服务使用相同的配置，我可以连接到另外两个服务。

**测试服务器：** 我什至部署在测试服务器上。即使在那里我也面临同样的问题。我可以使用 net.tcp url 连接到相同的两个服务。但其他两个给出错误。下面列出了其中一个配置。在服务器上，我什至删除了允许用户部分以使其对所有用户运行。

我得到的错误如下。

错误：无法从 net.tcp://localhost/servicesdev/SalesPersonService.svc 获取元数据 如果这是您有权访问的 Windows (R) Communication Foundation 服务，请检查您是否已在指定地址启用元数据发布。有关启用元数据发布的帮助，请参阅位于[http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata的 MSDN 文档](http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata)Exchange 错误 URI：net.tcp://localhost/servicesdev/SalesPersonService.svc 元数据包含无法解析的引用：“net.tcp://localhost/servicesdev/SalesPersonService.svc”。套接字连接被中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或者是潜在的网络资源问题造成的。本地套接字超时为“00:05:00”。现有连接被远程主机强行关闭

以下是配置部分。

```
 <services>
   <service behaviorConfiguration="ServiceBehavior" name="WCFServiceLibrary.SalesPersonService">
        <endpoint address="" binding="wsHttpBinding" contract="WCFServiceLibrary.ISalesPersonService" />
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
        <endpoint address="basic" binding="basicHttpBinding" contract="WCFServiceLibrary.ISalesPersonService" />
        <endpoint address="net.tcp://localhost/servicesdev/SalesPersonService.svc" binding="netTcpBinding" contract="WCFServiceLibrary.ISalesPersonService" listenUriMode="Explicit" />
      </service>
  </services>

<behaviors>
       <serviceBehaviors>
          <behavior name="ServiceBehavior">
           <serviceMetadata httpGetEnabled="true" />
           <serviceDebug includeExceptionDetailInFaults="false" />
          </behavior>
      </serviceBehaviors>
  </behaviors>

<system.web>
    <compilation targetFramework="4.0" debug="true" />
    <pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID" />
        <identity impersonate="true" />
        <authorization>
            <allow users="myuser" />
        </authorization>
  </system.web> 
```

谢谢， BMP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:53:54.023

您正在为 mex 指定相对地址，但没有给出基地址。尝试给出一个基地址，如下面的示例所示。mex 的相对地址应该可以工作

```
 <host>
              <baseAddresses>
               <add baseAddress="net.tcp://localhost/servicesdev/SalesPersonService.svc"/>
              </baseAddresses>
            </host>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
            <endpoint address="" binding="wsHttpBinding" contract="WcfServiceLibrary1.ISalesPersonService" />
            <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
            <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
            <endpoint address="basic" binding="basicHttpBinding" contract="WcfServiceLibrary1.ISalesPersonService" />
            <endpoint address="" binding="netTcpBinding" contract="WcfServiceLibrary1.ISalesPersonService" /> 
```

# c++ - 为什么信号处理器不输出任何东西？

> ID：15233305
> 
> 赞同：2
> 
> 时间：2013-03-05T20:20:05.693
> 
> 标签：c++, linux, signals

```
#include <iostream>
#include <signal.h>
#include <unistd.h>

using namespace std;

void sighandler(int sig) {
    cout << "signal received" << endl;
}

int main() {

    int pid= getpid();
    cout << pid << endl;

    signal( SIGUSR1, sighandler );

    sigset_t accept;
    sigaddset( &accept, SIGUSR1 );
    int s;

    sigwait(&accept, &s);

    cout << s << endl;

    return 0;
} 
```

当我运行这个程序并通过“kill -s SIGUSR1 $pid”向它发送一个 SIGUSR1 信号时，它只输出信号的编号（10）而不是 sighandler 中的文本。我不明白为什么。这是在 Linux 系统上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:31:03.660

从[`sigwait - wait for queued signals`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/sigwait.html)

> **描述**
> 
> sigwait() 函数从集合中选择一个未决信号，**从系统的未决信号集中原子地清除它**，并在 sig 引用的位置返回该信号编号。

所以，通过使用`sigwait()`，信号已经被你的程序传递和处理了。

当您移除`sigwait`呼叫并进行睡眠或忙碌等待时，`SIGUSR1`信号将被传递到您的信号处理程序，并且将打印“收到信号”消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T20:32:53.447

你得到这种行为是因为当你调用`sigwait()`你的线程进入睡眠状态并且控制权被传递给操作系统时。当您发送`SIGUSR1`信号时，它由操作系统处理，然后操作系统唤醒您的线程并将控制权传回。即使您已经注册了一个信号处理程序，您的处理程序也不会被调用，因为在您的线程被重新唤醒时已经处理了信号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:31:11.900

我试图找到一个明确的参考，但似乎信号处理程序和`sigwait`是互斥的。如果您使用 同步处理信号，`sigwait`则永远不会调用处理程序。

有关讨论，请参阅[关于 sigwait() 的模棱两可的描述](https://stackoverflow.com/questions/6326290/about-the-ambiguous-description-of-sigwait)

# javascript - 阻止 AngularJs 创建新的控制器/$scope 缓存并使用缓存的

> ID：15233307
> 
> 赞同：3
> 
> 时间：2013-03-05T20:20:15.840
> 
> 标签：javascript, angularjs

每次用户单击链接时使用 $routeProvider ，都会生成一个新的 $scope 。这意味着所有数据都丢失了。如何让 Angular 使用相同的控制器/$scope？

解释：

[http://jsfiddle.net/mpKBh/1/](http://jsfiddle.net/mpKBh/1/) （点击链接）

```
<a href='#'>First controller</a>
<a href='#/view'>Second controller</a>

$routeProvider.
  when('/', { template:"{{$id}}",controller: ContentListCtrl}).
  when('/view', {template:"{{$id}}",controller: ContentDetailCtrl}). 
```

Ps 是否可以知道当前哪个控制器处于活动状态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:33:55.843

在 AngularJS 中，`$scope`并不意味着保存在您的应用程序中持久存在的数据*。*为此，您希望使用注入到两个控制器中的服务。如果您提供有关跨路线缺少哪些数据的更多详细信息，我很乐意修改此答案以包含一些更具可操作性的内容。

在您的 PS 中：您可以注入`$route`服务以获取有关当前路线的信息；该`$route.current.controller`属性将为您提供当前路线的构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-17T16:44:38.980

对于那些研究如何在 AngularJS 中“解除绑定”的人，他提供了一些信息（与上面 OP 的最后一条评论有关）

当一个视图被销毁时，它基本上**被标记**为垃圾回收——但它仍然存在。这就是为什么当滚动发生时您会收到多个请求 - 因为它仍在侦听事件。

因此，处理这个问题的最简单方法（我发现了，虽然我想了解其他方法）是监听 $destroy 事件并对其做出反应。

您可以通过保留对 $on 方法返回的内容的引用来“取消绑定/取消监听”事件。这是从控制器中获取的示例：

```
$scope.systemListener = $rootScope.$on("someEventYouListenTo", function (event, data) {
  console.log('Event received by ' + $scope.name);
});

$scope.$on('$destroy', function () {
    // Remove the listener
    $scope.systemListener();
}); 
```

现在那些旧的范围/视图将不再对事件做出反应。

希望对某人有所帮助！

# math - Fortran 中的 HTML 和 XML 解析

> ID：15233310
> 
> 赞同：0
> 
> 时间：2013-03-05T20:20:25.893
> 
> 标签：math, fortran, ascii, fortran95

我正在学习数学计算，我完全被这个任务困住了！我什至不知道如何开始它！

**用 Fortran 编写一个程序，它可以*解析*单行格式良好的 HTML 或 XML 标记，以便在单行上输入（保证总共不超过 80 个字符），例如

-很多可爱的文字在哪里

*   标签可以是 1 到 37 个 ASCII 字符，并且不包含空格
*   text 可以包含空格并且长度为 1 到 73 个字符，以便程序输出两行之一：

    1.  tag ：如果在 <...> 中出现两次标记匹配，则为文本，并且
    2.  如果输入任何其他内容，则语法错误。

非常感谢任何帮助！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T17:12:09.890

有许多用于处理字符串的内在函数可能会有所帮助。

*   `result = index(string, substring)`- 返回字符串子字符串第一次出现的位置作为字符串中的子字符串，从一个开始计数。(Fortran 77)

*   `result = scan(string, set)`- 扫描字符串以查找一组字符中的任何字符。(Fortran 95)

*   `result = verify(string, set)`- 验证字符串中的所有字符是否存在于集合中。(Fortran 95)

Fortran Wiki 上有一些用户提供的[字符串标记化函数](http://fortranwiki.org/fortran/show/String+tokenization)可能会有所帮助： `delim`、`strtok`和`find_field`. 此外，[FLIBS](http://flibs.sourceforge.net/)包括一些字符串操作和标记化例程，这些例程可能很有用。

最后，有许多用 Fortran 编写的现有开源 XML 解析器：[xmlf90](http://fisica.ehu.es/ag/xml/)和[xml-fortran](http://xml-fortran.sourceforge.net/)。查看这些库的源代码应该会有所帮助。

# html - html 布局在缩放时变得混乱

> ID：15233311
> 
> 赞同：0
> 
> 时间：2013-03-05T20:20:27.877
> 
> 标签：html, css

我目前正在为电子商务网站定制一个主题，它适用于所有浏览器。但是，当放大（25% 到 90%）或缩小（仅 150%）时，页面右侧的类别列表似乎缩进了。我这很可能是 CSS 问题，我尝试修复此问题我自己，但没有好处。

你可以在这里看到它：[http ://www.autumnmeadow.com/jar-candles](http://www.autumnmeadow.com/jar-candles)

无论您使用哪种浏览器，都应该能够在开发人员工具上看到该代码。在 IE9 上似乎没有任何问题，但在 Chrome 或 FireFox 上无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:29:14.297

您始终可以`transform: scale(...)`根据缩放级别使用 css 并向上/向下缩放大小，从而否定缩放级别。

用于检测缩放级别的 Github 项目，[here](https://github.com/tombigel/detect-zoom)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:25:16.003

尝试将宽度和高度设为 % 而不是 px。假设你想让它填满屏幕的一半，让它占 50%。

```
<div width="50%" height="100%"></div> 
```

# filepicker.io - 将filepicker.io上传的图片保存到mysql数据库

> ID：15233327
> 
> 赞同：0
> 
> 时间：2013-03-05T20:21:10.710
> 
> 标签：filepicker.io

我正在尝试使用 filepicker.io 小部件。我想将 event.fbfile.url 保存在 mysql 数据库中。我会使用带有 jquery 的 .get 来保存图像 url 吗？代码示例会很有帮助。感谢您的帮助。下面是代码小部件。

```
<input name="img" data-fp-class="form-simple-action-btn filepicker_launcher" data-fp-button-text="Choose Image" data-fp-services="COMPUTER,FACEBOOK,FLICKR,INSTAGRAM,PICASA" data-fp-container="modal" data-fp-mimetypes="image/*" type="filepicker" data-fp-apikey="AmKDQg1vZRBatEqkUY6Qxz" data-onchange="console.log(event.fpfile.url)" id='campaign-img-input'"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:30:38.770

您需要一些服务器端代码来写入数据库。

如果这是 html 表单的一部分，则 url 将在提交时出现在表单中，您可以像表单的任何其他部分一样将其保存到您的数据库中。

如果这不是表单的一部分，您可能可以设置一个简单的服务器端端点，您可以向该端点执行 ajax 发布，并且当您将数据发布到端点时，它会将数据保存到您的 mysql.xml 中。

如果您提供有关如何设置系统以及当前如何写入数据库的更多详细信息，我可能会更有帮助。

# c# - 当我尝试写入列表时，其中的上一个文本会被覆盖

> ID：15233329
> 
> 赞同：0
> 
> 时间：2013-03-05T20:21:17.500
> 
> 标签：c#, linq

（Books 类是在此代码之外定义的。）因此，当我尝试从此文件中阅读一本书时，我只得到这本书。每次我添加一个新的，旧的都会被覆盖。所以我无法将新书添加到我的 myLibraryBooks 列表中，因为它会自动被覆盖。

```
Books book = new Books();

Console.Write("Enter Author Name:");
book.Author = Console.ReadLine();

Console.Write("Enter Book Title:");
book.Title = Console.ReadLine();

Console.Write("Enter Book ISBN:");
book.ISBN = Console.ReadLine();

Console.Write("Enter the Publish Date:");
book.Publish_Date = Console.ReadLine();

myLibraryBooks.Add(new Books() { Author = book.Author.ToUpper(), Title = book.Title.ToUpper(), ISBN = book.ISBN, Publish_Date = book.Publish_Date.ToUpper() });
Console.WriteLine("Book added Successfully");
sw.Write(book.Author, FILE_PATH);
sw.Write("\r\n", FILE_PATH);
sw.Write(book.Title.ToUpper(), FILE_PATH);
sw.Write("\r\n", FILE_PATH);
sw.Write(book.ISBN.ToUpper(), FILE_PATH);
sw.Write("\r\n", FILE_PATH);
sw.Write(book.Publish_Date.ToUpper(), FILE_PATH);
sw.Write("\r\n", FILE_PATH);
sw.WriteLine(book.Author, FILE_PATH);
sw.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:26:14.193

我在这里假设了很多，但我想尝试给出一个答案。

如果`sw`是 StreamWriter （我看不到声明的位置）那么你应该用它打开它

```
using(StreamWriter sw = new StreamWriter("yourFile", true)) 
```

强制 StreamWriter 附加到当前数据而不是覆盖它

[请参阅 MSDN StreamWriter 构造函数](http://msdn.microsoft.com/en-us/library/36b035cb.aspx)

`sw.Write`呼叫也是错误的。您正在使用采用格式字符串和要插入格式字符串的对象的重载。相反，您只是在编写 Books 的属性。

你应该使用

```
sw.WriteLine(book.Author); 
```

将每个属性放在单独的一行上，而不是放在一行中。

# javascript - 当尖括号位于“将要”编码值中时，为什么使用 encodeURIComponent 会锁定我的网页？

> ID：15233332
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:21:28.440
> 
> 标签：javascript, http, url, encoding

我开始了解如何以及何时进行编码以减轻 XSS 和正确显示字符。

然而，我有一些客户端脚本（JavaScript）正在将一些 html 写入页面，特别是写入查询字符串。

为此，我使用了 javascript 的“encodeURIComponent”函数来帮助处理存储在外部 json 文件中的用户输入。

我注意到，无论我如何尝试对这些值进行编码，当尖括号位于任何值中时，它实际上每次都会锁定页面，但是当 json 值中没有尖括号时可以完美地工作。

我首先尝试了 html 编码，然后使用“encodeURIComponent”并反过来尝试。由于 javascript 没有天生的 html 编码器，我自己编写了一个简单的编码器。是这里：

```
function htmlEncode (input)
{

    while(input.indexOf("&") > -1)
    {
        input = input.replace("&", "&amp;")
    }
    while(input.indexOf("<") > -1)
    {
        input = input.replace("<", "&lt;")
    }
    while(input.indexOf(">") > - 1)
    {
        input = input.replace(">", "&gt;")
    }
    while(input.indexOf("\"") > -1)
    {
        input = input.replace("\"", "&#x22;")
    }
    while(input.indexOf("'") > -1)
    {
        input = input.replace("'", "&#x27;")
    }
    while(input.indexOf("/") > -1)
    {
        input = input.replace("/", "&#x2F;")
    }

    return input
} 
```

这是将值写入页面的代码的 javascript 片段（没有 html 编码器）：

```
stringCompiler = "/Event htms/Event.cshtml?title=" + encodeURIComponent(jsonObj.events[i].title) +
                        "&explanation=" + encodeURIComponent(jsonObj.events[i].explanation) + "&dateString=" +
                        encodeURIComponent(jsonObj.events[i].dateMonth) + "-" + encodeURIComponent(jsonObj.events[i].dateNumber) + "-" + encodeURIComponent(jsonObj.events[i].dateYear); 
```

不幸的是，我无法提供更多信息，因为当它锁定时，它会很难锁定，并且无法运行任何诊断工具（甚至无法右键单击或滚动）。

我认为编码两次是愚蠢的，但是当尖括号单独使用“encodeURIComponent”锁定浏览器时，我想我也会尝试 html 编码，但它仍然会锁定任何一种方式。

有什么我可以做的，还是应该在保存到 json 文件时防止尖括号？

------------------------这就是我在下面的函数中看到的-----

![你的功能](../Images/6a80de603fade77b785600f3ed571a7b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:30:18.117

你可以做得**比**这更好。我给你带来了我的好朋友，字母“g”：

```
function htmlEncode (input) {
  return input.replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/\//g, '&#x2F;')
    .replace(/'/g, '&#x27;')
    .replace(/"/g, '&#x22;');
} 
```

由于“&”，您的代码有问题。你的代码说：

1.  这个字符串中有和号吗？
2.  如果是，则将第一个替换为`&amp;`
3.  转到步骤 1。

看到问题了吗？您将**始终**在字符串中使用＆符号。通过`.replace()`在正则表达式上使用“全局”限定符，您可以在一次调用中替换**所有这些。**

还有另一种方法可以做到这一点，一种*可能*更快的方法，只涉及一次调用`.replace()`和一个函数参数，但我认为它不必要地复杂。

`encodeURIComponent()`不会在任何输入**上**“挂起”，因为您可以在键入时看到自己

```
encodeURIComponent("<>&"); 
```

进入浏览器的控制台。

# c++ - 提升线程错误

> ID：15233334
> 
> 赞同：1
> 
> 时间：2013-03-05T20:21:55.660
> 
> 标签：c++, multithreading, boost

我正在做一个优化项目，并决定尝试使用线程来提高我的代码速度。代码的格式是：

主要.cpp：

```
int main(int argc, char **argv) {
    B *b = new B(argv[1]);
    b->foo();
    delete b;
    return EXIT_SUCCESS;
} 
```

B.cpp：

```
#include B.hpp

B::B(const char *filename) { .... }

B::task1(){ /*nop*/ }

void B::foo() const { 
    boost::thread td(task1);
    td.join();
} 
```

B.hpp：

```
#include <boost/thread.hpp>

class B{
    public:
    void task1();
    void foo();
} 
```

但是，当我尝试编译此代码时，出现错误`boost::thread td(task1)`，说：

`error: no matching function for call to 'boost::thread::thread(<unresolved overloaded function type>)'`

不完全确定问题出在哪里，我尝试破解但没有成功。任何帮助表示赞赏！

编辑：新错误

```
B.o: In function 'B::b() const':
B.cpp:(.text+0x7eb): undefined reference to 'vtable for boost::detail::thread_data_base'
B.cpp:(.text+0x998): undefined reference to 'boost::thread::start_thread()'
B.cpp:(.text+0x9a2): undefined reference to 'boost::thread::join()'
B.cpp:(.text+0xa0b): undefined reference to 'boost::thread::~thread()'
B.cpp:(.text+0xb32): undefined reference to 'boost::thread::~thread()'
B.o: In function 'boost::detail::thread_data<boost::_bi::bind_t<void, boost::_mfi::cmf0<void, B>, boost::_bi::list1<boost::_bi::value<B const*> > > >::~thread_data()':
B.cpp:(.text._ZN5boost6detail11thread_dataINS_3_bi6bind_tIvNS_4_mfi4cmf0Iv4BEENS2_5list1INS2_5valueIPKS6_EEEEEEED2Ev[_ZN5boost6detail11thread_dataINS_3_bi6bind_tIvNS_4_mfi4cmf0Iv4BEENS2_5list1INS2_5valueIPKS6_EEEEEEED5Ev]+0x8): undefined reference to 'boost::detail::thread_data_base::~thread_data_base()' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:23:53.770

`B::task()`是一个成员函数，所以它需要一个隐式类型的第一个参数`B*`。因此，您需要将实例传递给它才能在`boost::thread`.

```
void B::foo() const { 
  boost::thread td(&B::task1, this); // this is a const B*: requires task1() to be const.
  td.join();
} 
```

但既然`B::foo()`是一种`const`方法，你也必须制作`B::task1()`一个`const`方法：

```
class B {
  void task1() const:
} 
```

# tags - 我不明白 YAML 标签是什么

> ID：15233335
> 
> 赞同：58
> 
> 时间：2013-03-05T20:21:56.127
> 
> 标签：tags, yaml, specifications, pyyaml

我在某种程度上得到了它，但我还没有看到一个没有提出比答案更多的问题的例子。

[http://rhnh.net/2011/01/31/yaml-tutorial](http://rhnh.net/2011/01/31/yaml-tutorial)

```
# Set.new([1,2]).to_yaml
--- !ruby/object:Set 
hash: 
  1: true
  2: true 
```

我知道我们正在声明一个 Set 标签。我不明白后续的哈希映射与它有什么关系。我们是在声明一个模式吗？有人可以给我看一个带有多个标签声明的例子吗？

我已经阅读了规范：http: [//yaml.org/spec/1.2/spec.html#id2761292](http://yaml.org/spec/1.2/spec.html#id2761292)

```
%TAG ! tag:clarkevans.com,2002: 
```

这是声明模式吗？为了成功解析文件，解析器还需要做些什么吗？某种类型的模式文件？

[http://www.yaml.org/refcard.html](http://www.yaml.org/refcard.html)

```
Tag property: # Usually unspecified.
    none    : Unspecified tag (automatically resolved by application).
    '!'     : Non-specific tag (by default, "!!map"/"!!seq"/"!!str").
    '!foo'  : Primary (by convention, means a local "!foo" tag).
    '!!foo' : Secondary (by convention, means "tag:yaml.org,2002:foo").
    '!h!foo': Requires "%TAG !h! <prefix>" (and then means "<prefix>foo").
    '!<foo>': Verbatim tag (always means "foo"). 
```

为什么有一个主要和次要标签是相关的，为什么次要标签是指一个 URI？有了这些解决了什么问题？

我似乎看到了很多“它们是什么”，而不是“它们为什么在那里”或“它们用于什么”。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-06-19T13:15:53.500

我对 YAML 不太了解，但我会试一试：

标签用于表示类型。`!`正如您从那里的“参考卡”中看到的那样，声明一个标签。该`%TAG`指令有点像声明标签的快捷方式。

我将使用 PyYaml 进行演示。PyYaml 可以将二级标签解析`!!python/object:`为实际的 python 对象。双感叹号本身就是一个替换，是 的缩写`!tag:yaml.org,2002:`，它将整个表达式变成`!tag:yaml.org,2002:python/object:`。每次我们想创建一个对象时都要输入这个表达式有点笨拙，所以我们使用`%TAG`指令给它一个别名：

```
%TAG !py! tag:yaml.org,2002:python/object:            # declares the tag alias
---
- !py!__main__.MyClass                                # creates an instance of MyClass

- !!python/object:__main__.MyClass                    # equivalent with no alias

- !<tag:yaml.org,2002:python/object:__main__.MyClass> # equivalent using primary tag 
```

如果您没有标签注释，则节点将按其默认类型进行解析。以下是等价的：

```
- 1: Alex
- !!int "1": !!str "Alex" 
```

这是一个使用 PyYaml 演示标签用法的完整 Python 程序：

```
import yaml

class Entity:
    def __init__(self, idNum, components):
        self.id = idNum
        self.components = components
    def __repr__(self):
         return "%s(id=%r, components=%r)" % (
             self.__class__.__name__, self.id, self.components)

class Component:
    def __init__(self, name):
        self.name = name
    def __repr__(self):
        return "%s(name=%r)" % (
            self.__class__.__name__, self.name)

text = """
%TAG !py! tag:yaml.org,2002:python/object:__main__.
---
- !py!Component &transform
  name: Transform

- !!python/object:__main__.Component &render
  name: Render

- !<tag:yaml.org,2002:python/object:__main__.Entity>
  id: 123
  components: [*transform, *render]

- !<tag:yaml.org,2002:int> "3"
"""

result = yaml.load(text) 
```

[规范](http://www.yaml.org/spec/1.2/spec.html#id2782090)中提供了更多信息

# android - 在 AsyncTask 启动时使 TextView 可见

> ID：15233337
> 
> 赞同：0
> 
> 时间：2013-03-05T20:21:59.653
> 
> 标签：android, asynchronous, textview, task, show

我希望我的`AsyncTask`班级从我的布局中更改 a 的可见性，但`TextView`我遇到了一个致命错误。如果我想获取 的文本值`TextView`，它可以正常工作，但是在尝试设置可见性时它只会崩溃。

```
// Main Activity (MainActivity.java)
Context MainContext= getApplicationContext();
new MyAsyncTask((TextView)findViewById(R.id.my_text_view)).execute();

// My Async Task (MyAsyncTask.java)
public class MyAsyncTask extends AsyncTask <String, Void, String> {
    private Context context;
private TextView my_text_view;

public MyAsyncTask (TextView my_text_view){
        this.context = MainActivity.MainContext;
    this.txt_loading = my_text_view;
}

@Override
protected String doInBackground(String... params) {
    // TODO Auto-generated method stub
    my_text_view.setVisibility(View.VISIBLE); // crashes
    Log.i("Value: ", String.valueOf(this.my_text_view.getText())); // O.K.!
    return null;
}

@Override
    protected void onPostExecute(String result) {

    }

    @Override
    protected void onPreExecute() {

    }

    @Override
    protected void onProgressUpdate(Void... values) {

    }

} 
```

我怎样才能让它工作？另外，我可以`TextView`从上下文中获取吗？我不想将它作为参数发送给构造函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T20:23:52.747

它崩溃是因为您`UI`在**后台 Thread**进行操作。这是不允许的，你不能这样做。

```
my_text_view.setVisibility(View.VISIBLE); 
```

**用户界面**只能从原始/主/UI 更新/更改`Thread`。AsyncTask 提供了一些实际在 UI 上运行的方法`Thread`。

这些方法专门用于实现您的目标：*执行任何 UI 更新*。

当您想从 更新`UI`时`AsyncTask`，您可以使用：

*   **onPreExecute()**
*   **onProgressUpdate()**
*   **onPostExecute()**

# sharepoint - 信息路径和级联下拉菜单

> ID：15233338
> 
> 赞同：0
> 
> 时间：2013-03-05T20:22:01.580
> 
> 标签：sharepoint, infopath, infopath2010, cascadingdropdown

我有一个问题要问你们聪明的灵魂。我有一个用于 Sharepoint 列表的 Infopath 表单（这意味着这被认为是一个 Infopath 列表表单），我希望它具有某些行为......而且我不太确定如何实现它。

要点是，我在表单上有两个下拉菜单，我希望第二个下拉菜单根据第一个下拉菜单选择更改其值。

两者都指向同一个列表。该列表如下所示：

```
ID, ModuleName, SystemName, PayCode, LineOfBusoness
1, Mod1, Sys1, O, LOB1 
2, Mod2, Sys2, O, LOB2
3, Mod3, Sys3, C, LOB3
4, Mod3, Sys4, O, LOB3 
```

第一个下拉列表只包含支付代码，所以基本上是“O”和“C”。

现在第二个下拉菜单变得棘手。

第二个下拉菜单是根据在上一个下拉菜单中选择的 PayCode 显示该列表中的所有业务线 (LOB)。如果他们选择“O”，则只显示所有支付代码为“O”的 LOB。

但是......如果他们选择“C”......那么在他们已经选择系统和模块的表单上还有下拉菜单......所以它会采用那些被选择的值并选择列表中的值有他们选择的系统、他们选择的模块和他们选择的支付码。

我怎样才能做到这一点？我的第一个想法是好的，只需使用代码......但事实证明 Infopath 不允许在“列表表单”上使用自定义代码，这是...... wtf？因此，下一个选项是使用“级联下拉”方法，您也可以使用规则和过滤器来尝试实现此行为。

可以这样做吗？你对如何解决这个问题有什么想法？

提前致谢，如果您需要更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:51:42.130

一种方法是在后面的代码中。

取第一个下拉菜单，找到与之关联的字段，右键单击并创建一个“已更改”事件。

在事件背后的代码中，将为该字段创建一个 Changed 事件。在那里，您可以获取第一个下拉列表中当前选定项目的值。根据该值，您可以修改第二个下拉菜单的内容。

通过抓取原始列表并运行 SPQuery 来选择具有“O”或“C”或任何选定值的所有项目来执行此操作。您还可以对列表的所有项目运行 linq 或 foreach 语句，无论您喜欢哪个：)

注意：确保下拉列表控件属性在属性的“浏览器表单”选项卡中选择了“始终”（右键单击下拉列表以访问这些属性）

希望这可以帮助！

# python - 使用 .readlines() 时摆脱 \n

> ID：15233340
> 
> 赞同：317
> 
> 时间：2013-03-05T20:22:19.567
> 
> 标签：python, python-2.7, readline

我有一个 .txt 文件，其中包含值。

这些值如下所示：

```
Value1
Value2
Value3
Value4 
```

我的目标是将值放入列表中。当我这样做时，列表如下所示：

`['Value1\n', 'Value2\n', ...]`

`\n`不需要。

这是我的代码：

```
t = open('filename.txt', 'r+w')
contents = t.readline()

alist = []

for i in contents:
    alist.append(i) 
```

* * *

## 回答 #1

> 赞同：430
> 
> 时间：2013-12-24T06:44:21.770

这应该做你想要的（列表中的文件内容，按行，不带 \n）

```
with open(filename) as f:
    mylist = f.read().splitlines() 
```

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2013-03-05T20:44:30.157

我会这样做：

```
alist = [line.rstrip() for line in open('filename.txt')] 
```

或者：

```
with open('filename.txt') as f:
    alist = [line.rstrip() for line in f] 
```

* * *

## 回答 #3

> 赞同：127
> 
> 时间：2013-03-05T20:25:12.597

您可以使用[`.rstrip('\n')`](https://docs.python.org/3/library/stdtypes.html#str.rstrip)仅从*字符串*末尾删除换行符：

```
for i in contents:
    alist.append(i.rstrip('\n')) 
```

这使所有其他空白保持不变。如果您不关心行首和行尾的空格，则称为大重锤[`.strip()`](https://docs.python.org/3/library/stdtypes.html#str.strip)。

但是，由于您正在从文件中读取并将所有内容都拉入内存*，*因此最好使用该[`str.splitlines()`方法](https://docs.python.org/3/library/stdtypes.html#str.splitlines)；这会在行分隔符上拆分一个字符串并返回没有这些分隔符的行列表；在`file.read()`结果上使用它并且根本不使用`file.readlines()`：

```
alist = t.read().splitlines() 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2017-01-18T17:16:50.043

打开文件后，列表推导可以在一行中完成：

```
fh=open('filename')
newlist = [line.rstrip() for line in fh.readlines()]
fh.close() 
```

请记住之后关闭您的文件。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2017-07-06T15:26:43.460

我使用 strip 函数来摆脱换行符，因为拆分行在 4 gb 文件上引发内存错误。

示例代码：

```
with open('C:\\aapl.csv','r') as apple:
    for apps in apple.readlines():
        print(apps.strip()) 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-03-05T20:23:39.527

对于列表中的每个字符串，使用`.strip()`它从字符串的开头或结尾删除空格：

```
for i in contents:
    alist.append(i.strip()) 
```

但是根据您的用例，您最好使用类似的东西，`numpy.loadtxt`或者即使`numpy.genfromtxt`您需要一个很好的从文件中读取的数据数组。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-03-05T22:53:45.893

```
from string import rstrip

with open('bvc.txt') as f:
    alist = map(rstrip, f) 
```

Nota Bene: `rstrip()` removes the whitespaces, that is to say : `\f` , `\n` , `\r` , `\t` , `\v` , `\x` and blank `,
but I suppose you're only interested to keep the significant characters in the lines. Then, mere `map(strip, f)` will fit better, removing the heading whitespaces too.`

 `* * *

If you really want to eliminate only the NL `\n` and RF `\r` symbols, do:

```
with open('bvc.txt') as f:
    alist = f.read().splitlines() 
```

splitlines() without argument passed doesn't keep the NL and RF symbols (Windows records the files with NLRF at the end of lines, at least on my machine) but keeps the other whitespaces, notably the blanks and tabs.

.

```
with open('bvc.txt') as f:
    alist = f.read().splitlines(True) 
```

has the same effect as

```
with open('bvc.txt') as f:
    alist = f.readlines() 
```

that is to say the NL and RF are kept

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-09-27T19:46:19.587

我遇到了同样的问题，我发现以下解决方案非常有效。我希望它会帮助你或其他想要做同样事情的人。

首先，我将从“with”语句开始，因为它确保文件的正确打开/关闭。

它应该看起来像这样：

```
with open("filename.txt", "r+") as f:
    contents = [x.strip() for x in f.readlines()] 
```

如果您想将这些字符串（内容列表中的每个项目都是一个字符串）转换为整数或浮点数，您可以执行以下操作：

```
contents = [float(contents[i]) for i in range(len(contents))] 
```

如果要转换为整数，请使用`int`而不是。`float`

这是我在 SO 中的第一个答案，如果格式不正确，很抱歉。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-25T20:49:26.713

我最近用它来读取文件中的所有行：

```
alist = open('maze.txt').read().split() 
```

或者您可以使用它来增加一点额外的安全性：

```
with f as open('maze.txt'):
    alist = f.read().split() 
```

它不适用于单行文本之间的空格，但看起来您的示例文件可能没有空格分隔值。这是一个简单的解决方案，它返回一个准确的值列表，并且不添加空字符串：`''`对于每个空行，例如文件末尾的换行符。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-28T15:20:58.203

```
with open('D:\\file.txt', 'r') as f1:
    lines = f1.readlines()
lines = [s[:-1] for s in lines] 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-06-16T17:17:54.837

最简单的方法是编写`file.readline()[0:-1]` This 将读取除最后一个字符（即换行符）之外的所有内容。`

# php - 外部php文件中的函数

> ID：15233341
> 
> 赞同：0
> 
> 时间：2013-03-05T20:22:23.527
> 
> 标签：php, html

我遇到了一个问题，我想在 hmtl 中调用 php 和一个函数。这是html（index.php）：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
</head>
<body>
<div id=test>Test</div>
</body>
</html> 
```

我有一个例程来检查浏览器是否是移动的：

```
<?php
if(preg_match('/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|iemobile|hiptop|ip(hone|od)|iris|kindle|lge |maemo|meego.+mobile|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i',$useragent)||preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i',substr($useragent,0,4)))
?> 
```

我想在浏览器是否移动时显示/隐藏 id=test 的 div。因为我想检查它是否有**多个**div 和空间管理，我想将上述函数包含在外部 php 文件中，包含在 index.php 中并像这样使用它

```
if(browser_check()==true){
echo '<div id=test>test</div>';
else{
//do something else 
```

}

我对此没有任何运气，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:24:03.880

在构建页面时，您需要进行测试，如下所示：

```
<?php
require_once "path_to_browser_check.php";
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
</head>
<body>
<?php if browser_check() { ?>
    <div id="test">Test</div>
<?php } ?>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:31:37.050

您最好不要在整个代码中多次调用这样的函数（并在每次调用时执行所需的正则表达式函数）。这会很浪费。在代码开头执行一次并使用该值设置一个常量或会话变量可能会好得多。所以是这样的：

```
if(preg_match('[REGEX HERE]',substr($useragent,0,4))) {
    define('MOBILE_BROWSER', true);
} else {
    define('MOBILE_BROWSER', false);
} 
```

然后通过您的显示代码使用它，如下所示：

```
if (true === MOBILE_BROWSER) {
?>
<div id="test">Test</div>
<?php
} 
```

这样，您只需执行一次正则表达式，您不需要创建函数只是为了调用此正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:32:31.303

我的建议是使用 css @media： [http ://www.w3schools.com/css/css_mediatypes.asp](http://www.w3schools.com/css/css_mediatypes.asp)

但如果你真的想实现你想要的：functions.php

```
function browser_check(){
    if(preg_match('/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|iemobile|hiptop|ip(hone|od)|iris|kindle|lge |maemo|meego.+mobile|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i',$useragent)||preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i',substr($useragent,0,4)))
    return true;
} 
```

然后在html文件中：index.php

```
<?php
require_once('/path/to/functions.php');
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
</head>
<body>
<?php
if(browser_check()==true){
echo '<div id=test>test</div>';
else{
//do something else
}
?>
</body>
</html> 
```

但老实说看看 html5 或 bootstrap 或 css bootstrap 的 @media 声明[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/) html5 [http://html5doctor.com/](http://html5doctor.com/) @media [http://www.w3schools.com/ css/css_mediatypes.asp](http://www.w3schools.com/css/css_mediatypes.asp)

# c# - 从xml读取数据到数据表

> ID：15233351
> 
> 赞同：1
> 
> 时间：2013-03-05T20:23:16.517
> 
> 标签：c#, asp.net, xml, datatable

我的 xml

* * *

```
<?xml version="1.0" encoding="utf-8" ?>
<Category>
  <Youth>

  </Youth>
  <GeneralStores>

  </GeneralStores>
  <Schools>

  </Schools>
  <Colleges>

  </Colleges>
  <GovernmentOffices>

  </GovernmentOffices>
  <Restaurants>

  </Restaurants>
  <MovieTheatres>

  </MovieTheatres>

</Category> 
```

我需要像这样的数据表

```
_______________________

Category
__________
Youth
GeneralStores
Schools
Colleges
GovernmentOffices
Restaurants
MovieTheatres 
```

我将此数据表绑定到需要数据源事件的 telrik rad 网格

这是我的 .cs 代码

```
protected void CategoriesRadGrid_NeedDataSource(object source, Telerik.Web.UI.GridNeedDataSourceEventArgs e)
{
    try
    {
        //create the DataTable that will hold the data
        DataTable CategoryDT = new DataTable("MainCategory");
        CategoryDT.Columns.Add("Category", System.Type.GetType("System.String"));
      CategoryDT.ReadXml(@"C:\Users\MyID\Documents\Visual Studio 2010\Projects\SomeName\InfoXML\XMLCategory.xml");
    }
    catch (Exception ex)
    {

    }
} 
```

1.  代码执行良好，数据表中没有数据。
2.  还告诉我当文件在服务器上时如何给出文件位置？目前我正在使用文件所在的本地机器路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:51:09.130

使用 XmlDocument 读取您的 XML

```
XmlDocument doc= new XmlDocument();
doc.Load("physical path to file.xml");
// doc.LoadXml(stringXml);

DataTable dt = new DataTable();

if(doc.ChildNodes[1]!=null)
   dt.Columns.Add(doc.ChildNodes[1].Name); //Assuming you want the rood node to be the only column of the datatable

 //iterate through all the childnodes of your root i.e. Category
foreach(XmlNode node in doc.ChildNodes [1].ChildNodes )
{
  dt.Rows.Add(node.Name);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:53:53.310

尝试以下操作：

```
private static DataTable BuildDataTable(XElement x)
        {
            DataTable dt = new DataTable();

            dt.Columns.Add(new DataColumn(x.Name.ToString()));
            foreach (var d in x.Descendants())
            {
                DataRow drow = dt.NewRow();
                drow[0] = d.Value;
                dt.Rows.Add(drow);
            }

            return dt;
        } 
```

该方法将遍历 xml 并创建 dataTable。[`Xelement`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.aspx)是 linq 的一部分，需要 .Net 框架 4。它代表一个 XML 元素。

调用方法：

```
//this answers your second question, 
//use Server.MapPath to find your file.
XElement x = XElement.Load(Server.MapPath(".") + @"\test.xml");

DataTable dt = BuildDataTable(x); 
```

# ruby-on-rails - Rails 多态关联错误

> ID：15233353
> 
> 赞同：0
> 
> 时间：2013-03-05T20:23:18.710
> 
> 标签：ruby-on-rails, ruby-on-rails-3, polymorphic-associations, polymorphism

我遇到了多态关联的问题。

关于我的项目的快速解释。你可以在这里看到它：majorfinder.com 在我的应用程序上会有专业、学校和职业。我希望能够为每个添加评论。由于我刚刚开始，我刚开始为专业添加评论，但创建了协会，这样当我进入职业和学校时，评论协会会迅速发展。

以下是我的联想：

模型/review.rb

```
belongs_to :user
belongs_to :reviewable, polymorophic: true 
```

模型/用户.rb

```
has_many :reviews 
```

模型/major.rb

```
has_many :reviews, as: :reviewable 
```

我的评论数据库架构如下所示：

```
create_table "reviews", :force => true do |t|
    t.text     "review"
    t.datetime "created_at",      :null => false
    t.datetime "updated_at",      :null => false
    t.integer  "user_id"
    t.integer  "reviewable_id"
    t.string   "reviewable_type"
  end 
```

在我的专业控制器中，我遵循[了这个 railscast](http://railscasts.com/episodes/63-model-name-in-url-revised)以创建一个看起来像 www.majorfinder.com/majors/major-name 的 URL。所以我的专业控制器的一部分看起来像这样：

```
def show
    @major = Major.find_by_slug(params[:id]).includes(:reviews => :user)
end 
```

在我的专业展示页面中，我有：

```
<% @reviews.each do |review| %>
    <div>
      <h3><%= link_to review.review,
        :controller => "reviews", :action => "show", :id => review.id %></h3>
      <small>Posted on <%= review.created_at %> by
        <a href="#"><%= review.user.profile_name %></a></small>
    </div>
  <% end %> 
```

最后，这是我的路线：

```
resources :majors, has_many: :reviews 
```

我收到以下错误：

```
NoMethodError in MajorsController#show

undefined method `includes' for #<Major:0x007f9466e001a8> 
```

这是来自控制台：

```
Started GET "/majors/statistics" for 127.0.0.1 at 2013-03-05 07:45:01 -0700
Processing by MajorsController#show as HTML
  Parameters: {"has_many"=>:reviews, "id"=>"statistics"}
  Major Load (24.2ms)  SELECT "majors".* FROM "majors" WHERE "majors"."slug" = 'statistics' LIMIT 1
  CACHE (0.0ms)  SELECT "majors".* FROM "majors" WHERE "majors"."slug" = 'statistics' LIMIT 1
Completed 500 Internal Server Error in 28ms

NoMethodError (undefined method `includes' for #<Major:0x007f8ad51fdd00>):
  app/controllers/majors_controller.rb:16:in `show' 
```

majors_controller.rb 文件中的第 16 行是这一行：

```
@major = Major.find_by_slug(params[:id]).includes(:reviews => :user) 
```

你能看到我缺少什么或我应该改变什么吗？似乎解决方案很简单，但我不确定它是什么。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:19:12.027

`:reviews`我相信当你找到少校时，你要做的是急切地加载。你很接近，但你的订单是倒退的。它需要是

```
@major = Major.includes(:reviews => :user).find_by_slug(params[:id]) 
```

有关预加载结帐的更多信息，请查看此[RailsGuides](http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations)文章。

# c++ - C++ - 如何从指向类的指针访问成员变量/函数

> ID：15233359
> 
> 赞同：1
> 
> 时间：2013-03-05T20:23:43.393
> 
> 标签：c++, pointers

我的老师为链表上的作业设置了一些框架代码。

在标题中，定义了两个类： `string_node`和`string`

在字符串定义中，有一个私有变量`mutable string_node* cursor;`

现在在实际实现中，我尝试使用游标作为对我创建并要修改的节点的引用。IE：

```
for (cursor_index = 0; cursor_index < many_nodes; cursor_index++){
        cursor = new string_node(str[cursor_index]); 
```

我不确定这是否正确，所以首先，如果这是错误的，谁能告诉我我应该怎么做？

我认为它是错误的，因为我无法访问节点的数据并通过光标链接到其他节点，因为它是一个指针（我希望能够只做 cursor.data 甚至设置 get 和 set 方法，尽管我不是确定我为什么需要，如果有人想向我解释）。

所以主要问题是能够在实现中设置节点的数据/链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:32:13.243

有两种方法可以从指针中获取信息。

首先是取消引用它：

```
string_node &mynode = *cursor;
mynode.whatever; 
```

第二种（更好的方法）是使用解引用运算符（它的作用相同但更优雅）：

```
cursor->whatever; 
```

继续您的方法：也许我对相关问题的回答会帮助您：[如何将动态数组中的数组指向某物？](https://stackoverflow.com/questions/15193928/how-to-point-an-array-inside-a-dynamic-array-to-something/15194849#15194849)

您还可以从 Wikipedia 的伪代码中获得一些帮助：[http ://en.wikipedia.org/wiki/Linked_list#Linked_list_operations](http://en.wikipedia.org/wiki/Linked_list#Linked_list_operations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:31:58.427

要回答您最初的问题：您需要“->”运算符。它相当于“。” 指向对象的指针的运算符。

# uitableview - UIScrollView 中的 UIView 中的 UITableView。滚动表格视图时也不要滚动滚动视图

> ID：15233368
> 
> 赞同：3
> 
> 时间：2013-03-05T20:24:19.530
> 
> 标签：uitableview, uiview, ios6, uiscrollview

我在 UIScrollView 内的 UIView 内有一个 UITableView。问题：当我滚动/拖动表格视图时，滚动视图也会滚动。
我需要的是表格视图不要将滚动传递给滚动视图。当我直接滚动它时，我还需要能够使用滚动视图。我怎样才能做到这一点？干杯

![在此处输入图像描述](../Images/bf3933d3c315673b306c75ccb1665676.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T14:32:05.083

我在 tableview 上使用“hitTest”修复了它。

```
 - (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event 
```

如果事件起源于 tableview，我禁用父的滚动视图滚动。而且，当 tableview 的滚动结束（scrollViewDidEndDragging）时，我重新启用父级的滚动视图滚动。

这看起来工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:32:58.067

为您的表格视图的滚动视图设置一个委托（即您的视图控制器）

```
tableView.scrollView.delegate = self; 
```

然后使用这两个电话

```
– scrollViewDidScroll:
– scrollViewDidEndDragging:willDecelerate: 
```

禁用和重新启用外部滚动视图的 scrollEnabled 属性

# mysql - Mysql 在非空字段上插入或更新为空值时不会出错

> ID：15233371
> 
> 赞同：4
> 
> 时间：2013-03-05T20:24:44.893
> 
> 标签：mysql, null, innodb, insert-update, notnull

我有一张桌子

```
CREATE TABLE `devicelist` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `ip` varchar(15) COLLATE utf8_unicode_ci DEFAULT NULL,
  `serial` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `networkname` varchar(200) COLLATE utf8_unicode_ci DEFAULT NULL,
  `login` varchar(130) COLLATE utf8_unicode_ci DEFAULT NULL,
  `password` varchar(130) COLLATE utf8_unicode_ci DEFAULT NULL,
  `peopleid` int(10) unsigned NOT NULL,
  `deviceid` int(10) unsigned NOT NULL,
  `placeid` int(10) unsigned NOT NULL,
  `stationid` int(10) unsigned NOT NULL,
  `place` text COLLATE utf8_unicode_ci,
  `date` date NOT NULL,
  `active` tinyint(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`),
  KEY `placeid` (`placeid`),
  KEY `stationid` (`stationid`),
  KEY `peopleid` (`peopleid`),
  KEY `deviceid` (`deviceid`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

如您所见，**序列**设置为**NOT NULL**，
但是当我运行查询时

```
UPDATE DeviceList SET serial = NULL WHERE id = 1 
```

它输出

```
1 row affected. ( Query took 0.0079 sec ) 
```

为什么将 null 插入非 null 字段？
我希望发生错误：D

///****************************** 编辑

好吧，我找到了答案
，问题出在 sql_mode
[https://dev.mysql.com/doc/refman/5.6/en/sql-mode.html#sql-mode-strict](https://dev.mysql.com/doc/refman/5.6/en/sql-mode.html#sql-mode-strict)
我的 sql_mode 默认为空，我
将其更改为 STRICT_ALL_TABLES通过

```
SET GLOBAL sql_mode='STRICT_ALL_TABLES' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-10-20T05:13:39.493

*由于这个原因，MySQL 今天把我的一天搞得一团糟，所以我只是分享我从中学到的东西。*

MySQL 5.6 默认为`NO_ENGINE_SUBSTITUTION`.

MySQL 5.7 默认为`ONLY_FULL_GROUP_BY`, `STRICT_TRANS_TABLES`, `NO_ZERO_IN_DATE`, `NO_ZERO_DATE`, `ERROR_FOR_DIVISION_BY_ZERO`, `NO_AUTO_CREATE_USER`, `NO_ENGINE_SUBSTITUTION`.

如MySQL 参考手册中的[本页所述，](https://dev.mysql.com/doc/refman/5.7/en/sql-mode.html#sql-mode-setting)

> MySQL 安装程序可能会在安装过程中配置 SQL 模式。例如，**mysql_install_db**在基本安装目录中创建一个名为*my.cnf的默认选项文件。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:34:21.773

它应该并且确实会引发错误。我猜`create table`您在问题中发布的内容与实际的表定义不符（考虑到您有语法错误 - 额外的逗号）。

# django - 防止项目的创建者成为项目的成员

> ID：15233373
> 
> 赞同：0
> 
> 时间：2013-03-05T20:24:48.157
> 
> 标签：django, django-models, django-forms, django-views

当您在我正在开发的应用程序中创建项目时，可以选择哪些用户应该成为该项目的成员。但是，我不希望项目的创建者（成为管理员）出现在您可以选择成为成员的用户列表中。

您要么是管理员，要么是会员，而不是两者兼而有之。当然，不添加一个自己作为成员是可能的，但我什至不希望它成为可能。

怎么可能做到这一点？

**看法：**

```
def project_add(request):
if request.method == "POST":
    form = ProjectForm(request.POST)
    if form.is_valid():
        form.instance.date_added = datetime.date.today()
        form.instance.date_updated = datetime.date.today()
        form.instance.added_by_user = request.user
        form.save()
        return redirect(project_list)
else:
    form = ProjectForm()

return render(request, 'projects/add.html', {"form" : form}) 
```

**项目型号：**

```
class Project(models.Model):
...rest of the fields...
added_by_user = models.ForeignKey(User)
users = models.ManyToManyField(User, related_name='projects')

def __unicode__(self):
    return self.name

def owned_by_user(self, user):
    return self.added_by_user == user 
```

**表格：**

```
class ProjectForm(ModelForm):
class Meta:
    model = Project
    exclude = ('date_added', 'date_updated', 'added_by_user') 
```

...

为了更清楚，我在下面提供了一张图片。我不希望“Nisse”可以在下面的“用户：”下选择（这是项目的成员），因为 Nisse 是创建项目的用户。

![](../Images/796909add66f1509b62bfa52efa88ebf.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:56:01.900

尝试这个：

```
class ProjectForm(ModelForm): 
    ...
    users = forms.ModelMultipleChoiceField(queryset=User.objects.all())

    # change the queryset for the modelform `users` field to exclude `instance.added_by_user`
    def __init__(self, *args, **kwargs):
        super(ProjectForm, self).__init__(self, *args, **kwargs)
        if self.instance:
            self.fields['users'].queryset = self.fields['users'].queryset.exclude(self.instance.added_by_user)

    # custom clean method to not allow the `added_by_user`
    def clean(self):
        cleaned_data = super(ProjectForm, self).clean()
        if self.instance.added_by_user in cleaned_data.get('users'):
            raise ValidationError("OH NOES")
        return cleaned_data 
```

你可能需要稍微按摩一下。它未经测试，但你明白了

[https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#overriding-the-clean-method](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#overriding-the-clean-method)

# java - 带有数组的android语音识别

> ID：15233376
> 
> 赞同：0
> 
> 时间：2013-03-05T20:25:06.603
> 
> 标签：java, android, voice-recognition

我正在尝试制作一个Android应用程序

*   用户说一句话
*   这个词将被保存到变量中`what_you_say`
*   如果它与我已经存储在数组中的内容匹配，用户会说第二个短语

... 等等。问题是，我创建了一个数组并将我希望程序用来比较用户所说的单词的单词存储在其中，但它不起作用！它一直给我虚假，我不知道为什么。这是我的代码：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
// TODO Auto-generated method stub
if (requestCode ==check && resultCode == RESULT_OK){                       // voice to text 

TextView display2=(TextView)findViewById (R.id.TOF);

String[] words = { "zero", "one", "two" };  
for (int w=0;w<3;w++)
{
    ArrayList<String> results = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
     for(int j=0;j<results.size();j++) {

        String what_you_say = results.get(j);  
         if (what_you_say.equalsIgnoreCase(words[w]))
             display2.setText("true, continue dear");
             //System.out.println("true, continue");
         else
         {
             display2.setText("False, repeat again");
           //System.out.println("False, repeat again");
         }
     }
} 
}//end of for
super.onActivityResult(requestCode, resultCode, data);

}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:37:03.893

索引从**0**而不是**1**开始。你得到一个*ArrayIndexOutOfBoundsException*。

将其更改为：

```
String[] words = { "zero", "one", "two" };  
for (int w=0;w<3;w++)
{
     for(int j=0;j<results.size();j++) {
         what_you_say = results.get(j);  
         if (what_you_say.equalsIgnoreCase(words[w]))
            System.out.println("true, continue");
         else
         {
           System.out.println("False, repeat again");
         }
     }
} 
```

另请注意，如果您不在`what_you_say`循环内询问，并说它等于`zero`，您的输出将是：

> 真的，继续
> 
> 错了，再重复一遍
> 
> 错了，再重复一遍

我认为您的意思是`what_you_say`在循环的每次迭代中都要求。（**代码已编辑**）

# php - 为什么它不按照表中的公式计算？

> ID：15233382
> 
> 赞同：1
> 
> 时间：2013-03-05T20:25:20.250
> 
> 标签：php, mysql

我正在输入用户的 3 个值。我想根据表格列中的公式计算。我打印了公式，但我希望根据公式进行计算。我正在使用 php 和 mysql。请帮助我并指导我如何以这种方式实现它？

html代码：

```
<form action="testcalc1.php" method="post">
Size 1: <input type="text" name="size1" /><br><br>
Size 2: <input type="text" name="size2" /><br><br>
Quantity: <input type="text" name="quanity" /><br><br>
<input type="submit" />
</form> 
```

php代码：

```
$s1 = $_POST['size1'];
    $s2 = $_POST['size2'];
    $s3 = $_POST['size2'];

    $rec= mysql_query("SELECT unit_cost FROM mat WHERE mat_name='ball'") or die(mysql_error());

    $s5 = mysql_fetch_assoc($rec);
    $s4 = $s5['unit_cost'];

    echo $s4; 
```

垫桌：

**垫名 || 单位成本**

球|| $s1*$s2*$s3

输出我现在得到的是 :: $s1*$s2*$s3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:35:41.197

它应该是

```
eval('$s4='.$s5['unit_cost'].';'); 
```

或者

```
$s4=eval('return '.$s5['unit_cost'].';'); 
```

但是，您不应该使用`mysql_*`函数（使用`mysqli_*`or ），如果您不检查它们是否真的是数字，那么使用变量是`PDO`不安全的。`$_POST``eval()`

# sql - SQL 查询给出的结果太多

> ID：15233386
> 
> 赞同：2
> 
> 时间：2013-03-05T20:25:28.667
> 
> 标签：sql, postgresql

我正在尝试为该问题编写一个 PostgreSQL 查询：

2011年购买了多少产品？（2011 年购买意味着订单描述为 2011 年“已完成”）。 ![图表](../Images/eff9bc16a6babaae9e65e24e18927841.png)

到目前为止，我有这个查询：

```
 SELECT
      COUNT(product.id)
    FROM
      product
    JOIN orderitem ON 
      productid = product.id
    JOIN "order" ON 
      "order".id = orderitem.orderid AND
      EXTRACT(year FROM orderplaced) = 2011
    JOIN orderstatus ON 
      orderstatus.orderid = "order".id
    JOIN orderstatusdescription ON 
      orderstatusdescription.id = orderstatusdescriptionid AND
      orderstatusdescription.description = 'Completed'; 
```

但这会导致 231410 个产品，而数据库仅包含 1000`DISTINCT(product.id)`个。逻辑上使用会导致计数为 1000。

我不知道我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:16:01.163

来自 Andres Olarte 的稍微修改的查询：

```
SELECT
  COUNT(orderitem.productid)
FROM
  orderitem
JOIN "order" ON 
  "order".id = orderitem.orderid
JOIN orderstatus ON 
  orderstatus.orderid = "order".id
JOIN orderstatusdescription ON 
  orderstatusdescription.id = orderstatusdescriptionid 
WHERE 
  EXTRACT(year FROM orderplaced) = 2011
AND  orderstatusdescription.description = 'Completed'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:17:19.577

您获得的数字更大，因为您有多个记录与您的一个或多个连接条件匹配。

例如，当您将`product`表加入时，`orderitem`您可能有多个`orderitem`匹配的记录。所以你`product.id`不止一次地在你的结果集中得到它。

试试`COUNT(distinct product.id)`——这应该会给你购买的不同产品的数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:18:26.397

这将告诉您哪些产品是在 2011 年购买的（未经测试 - 不是在带有 PG 的计算机上）：

```
 select distinct OI.productid, P.description
     from orderitem OI inner join products P on OI.productid=P.id
     inner join
     (   
     select order.id as orderid from order
     inner join orderstatusdescription OSD
     on order.orderstatusdescriptionid = OSD.id and OSD.description = 'COMPLETED'
     where extract(year from order.orderplaced)=2011  
     ) as Orders2011
     on Orders2011.orderid = OI.orderid 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:03:38.873

尝试这样的事情：

```
SELECT
  COUNT(product.id)
FROM
  product
JOIN orderitem ON 
  productid = product.id
JOIN "order" ON 
  "order".id = orderitem.orderid
JOIN orderstatus ON 
  orderstatus.orderid = "order".id
JOIN orderstatusdescription ON 
  orderstatusdescription.id = orderstatusdescriptionid 
WHERE 
  EXTRACT(year FROM orderplaced) = 2011
AND  orderstatusdescription.description = 'Completed'; 
```

# c# - 在远程服务器上部署 web 服务

> ID：15233388
> 
> 赞同：0
> 
> 时间：2013-03-05T20:25:29.620
> 
> 标签：c#, .net, web-services, rest

我在 .net 上创建了一个 REST Web 服务。现在我想将它部署在服务器上。怎么做。服务器也没有视觉工作室，但我认为这不会是一个问题，对吗？？基本上我想通过互联网访问网络服务。

PS：这是我的第一个 Web 服务创建。我读了很多文章，有点困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:29:43.740

你看过[WebDeploy](http://www.iis.net/downloads/microsoft/web-deploy)吗？

根据服务类型，您可能有[更多选择](http://forums.iis.net/t/1187686.aspx/1)！

# c# - .NET Image 类错误地加载图像

> ID：15233392
> 
> 赞同：1
> 
> 时间：2013-03-05T20:25:40.467
> 
> 标签：c#, .net, exif

**背景**

我正在使用 Image.FromFile 将 jpeg 加载到应用程序中。该图像在资源管理器、Windows 图像查看器、Photoshop 和其他所有内容中都是纵向的。当我用 Image.FromFile 加载它时，C# 告诉我它处于横向模式（高度和宽度是错误的），所以当我现在尝试操作然后稍后保存图像时，图像的方向错误并且现在被旋转和扭曲，这是不应该的。

**问题** 有人知道 Image.FromFile 是否注意到 Exif 数据中的方向吗？或者有人知道可能导致这种情况的任何错误或“功能”吗？

**PS** 我只`m_img = Image.FromFile(file);`在加载后直接在visual studio中使用和检查高度和宽度，并在使用克隆将图像转换为位图后将图像保存回来`m_out.Save(g_target + "\\" + m_file, m_enc, m_enc_params);`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:29:34.187

这听起来像资源管理器、Windows 照片查看器和 Photoshop 等程序都尊重相机方向 EXIF 属性，但 GDI 显然没有。

所以实际上，Explorer、WPV 和 Photoshop 实际上是错误的，因为它们没有在存储图像时显示图像，而是在加载图像后执行图像旋转。

如果建议您使用 EXIF 库来查找旋转属性并在图像加载期间应用合适的转换。

# coldfusion - 变量 ID 未定义

> ID：15233393
> 
> 赞同：0
> 
> 时间：2013-03-05T20:25:42.490
> 
> 标签：coldfusion, coldfusion-9, cfml

谁能查看此代码并告诉我为什么我收到变量 ID 未定义错误？

```
<cffunction name="login" access="public" returntype="void">
  <cfargument name="rc" type="struct" required="true">
  <cfset user = getUserService().login(arguments.rc.Username,arguments.rc.password)>
  <cfif isDefined('User')>
    <cfset session.auth = structNew()>
    <cfset session.auth.isLoggedin = "yes"/>
    <cfset session.auth.user = user />
    <cfset session.auth.id = id>  
    <cfset session.auth.username = UserName />
    <cfset session.auth.password = password />
  <cfelse>
    <cfset rc.message = createMessage('error','','entered password is wrong')>
    <cfset variables.fw.redirect('login.default','message')>
  </cfif>
  <cfset variables.fw.redirect('')>
</cffunction> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:19:17.683

通过确定变量的范围，您将为自己（和其他未来的开发人员）省去很多麻烦。

```
<cfset session.auth.id = User.id> 
```

如果 User 是查询或结构，那么您还可以使用点符号引用您的记录

```
<cfset session.auth.id = User.id[1]> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T13:43:49.407

您需要正确确定变量的范围（正如我在评论中所述）。更改`= id`为`= user.id`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:50:37.413

我没有看到你在哪里定义 ID。如果您在尝试访问它之前没有定义它，您将收到错误消息。

```
<cfset session.auth.id = id> 
```

# typescript - 什么是 HTMLInputElement 类型中缺少属性“setSelectionRange”的意思

> ID：15233397
> 
> 赞同：1
> 
> 时间：2013-03-05T20:26:04.297
> 
> 标签：typescript

我正在尝试使用以下代码将有关输入的信息（包括输入 DOM 对象本身）存储在一个数组中。

```
export class SelectionOtherInputDescriptor {
    constructor(public selectionName: string, public otherKey: any, public otherInputElement: HTMLInputElement) { }
}
export class SelectionOtherInputHelper {
    selectionsWithOther: { [selectionKey: string]: SelectionOtherInputDescriptor; } = {};
    getAllSelectionOthers() {
        var things = $("[" + ATT_SELECTION_OTHER_FOR + "]");           
        for (var i = 0; i < things.length; i++) {         
            var selectionName = $(things[i]).attr(ATT_SELECTION_OTHER_FOR);
            var desc = new SelectionOtherInputDescriptor(selectionName, 0, $(things[i]));
            this.selectionsWithOther[selectionName] = desc;
        };
    };
} 
```

在线上

```
var desc = new SelectionOtherInputDescriptor(selectionName, 0, $(things[i])); 
```

我得到编译错误：

> 类型“JQuery”缺少`setSelectionRange`“HTMLInputElement”类型的属性

为什么我自己的`SelectionOtherInputDescriptor`对象要求`HTMLInputElement`参数需要一个`setSelectionRange`属性，而我只想将它存储在数组中的对象中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:36:08.133

`$(things[i])`返回一个 JQuery 对象，但您的类需要一个 HTML 元素。观察：

```
<input id="foo">
   ....
var x = $('#foo');
console.log(x); // 'JQuery'
console.log(x.get(0)); '<input id="foo"> 
```

您需要`get`如图所示调用。由于这只是一个 HTMLInputElement，因此您还需要对结果进行类型断言：`<HTMLInputElement>($(things[i]).get(0))`

# python - 处理 CSV 文件并使用 python 组合值

> ID：15233398
> 
> 赞同：0
> 
> 时间：2013-03-05T20:26:05.263
> 
> 标签：python, csv, import-from-csv

我有一个 CSV 文件，其中包含以下方式的数据

```
"/file/Puppies";"$2,166.74";"2,502";"5.55%";"$48.10";"152,844";"45,044"
"/file/Kittens";"$1,498.59";"1,618";"3.54%";"$32.75";"157,560";"45,764"
"/file/Puppies/pup";"$1,174.92";"1,451";"3.72%";"$30.10";"116,268";"39,038" 
```

如果第一列相似，我想合并第二列，其余的值无关紧要。

因此，在示例中，第 2 列中的`/file/Puppies`和`/file/Puppies/pup`值将在最终输出中相加。

相似是指例如`/file/Puppies/`, `/file/Puppies/1`,`/file/Puppies/ru`都是相似的。但 /file/Kittens 不会。

关于如何开始的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:36:32.003

构造一个字典来保存值，然后将每一行添加到每个字典值

```
Values = {}
from csv import reader
with open('CSVFile.csv', 'r') as filehandle :
    reader = reader(filehandle,delimiter=';')
    for row in reader :
        Class = row[0].split('/')[2]
        Value = float(row[1].strip('$').replace(',', ''))
        if Class in Values :
            Values[Class] = Values[Class] + Value
        else :
            Values[Class] = Value
print Values 
```

在这里，我对“相似”的含义做了一些简化的假设——也就是说，我假设你的意思是 '/file/' 之后的第一件事，并一直持续到该字段的末尾或下一个 '/' . 这就是我所说的`Class`。

然后，我通过从您的数据中取出第二列、去掉“$”、删除逗号并转换为浮点数来找到值。

然后，因为我们正在构建字典，所以我们必须测试我们是否已经看过 Puppy，或者其他什么。如果是这样，只需添加到以前的值；如果没有，请设置值。

# java - 从服务器编码 RMI 客户端回调时遇到问题 - UnmarshalException ClassNotFoundException

> ID：15233401
> 
> 赞同：0
> 
> 时间：2013-03-05T20:26:22.527
> 
> 标签：java, callback, client-server, rmi

我会尽量保持这篇文章尽可能小，所以如果需要，我会添加更多信息和代码。

场景：我正在编写一个服务器/客户端应用程序来跟踪我们在公司的一些流程，因此用户将根据工作流程创建从一个用户屏幕到另一个用户屏幕的小标签（用 Swing 编写的客户端）。

我正在运行本地 Glasfish 3.1 服务器（在 Eclipse 中）和 MySql。在服务器上，我正在运行 Spring MVC 和 Spring Data + Hibernate。

属性文件保存此信息以便于更改：

```
rmi.serverPort = 1971
rmi.clientPort = 2010 
```

在服务器启动期间，有一个 bean 设置 RMI 环境，如下所示：

```
 @Autowired
  private RmiData rmiData;
  @Autowired
  private DataRequestHandler dataRequestHandler;
  @Autowired
  private ConnectionRequestHandler connectionRequestHandler;
  .
  .
  .

  LocateRegistry.createRegistry(rmiData.getServerPort());
  String rmiUrl = "rmi://" + rmiData.getHost() + ":" + rmiData.getServerPort() + "/";
  Naming.rebind(rmiUrl + "ConnectionRequestHandler", connectionRequestHandler);
  Naming.rebind(rmiUrl + "DataRequestHandler", dataRequestHandler); 
```

**服务器包含两个处理程序的接口和实现，而客户端只有接口。**

这是在没有 SecurityManager 和 Policy 文件的情况下工作的。尽管我必须将 Hibernate jar 包含到客户端中以解决其他异常（在 SO 上找到的解决方案）。

在使客户端连接到服务器并请求数据工作之后，我开始编写对客户端的回调（服务器也必须将数据推送到客户端）。所以这就是我现在卡住的地方。

这是我进行回调的方式（客户端就像服务器一样）：

```
 private ClientCallbackHandler clientCallbackHandler = new ClientCallbackHandlerImpl();
  .
  .
  .

  LocateRegistry.createRegistry(rmiData.getClientPort());
  String rmiUrl = "rmi://localhost:" + rmiData.getClientPort() + "/";
  Naming.rebind(rmiUrl + "ClientCallbackHandler", clientCallbackHandler); 
```

**服务器只包含客户端接口，客户端同时拥有处理程序的接口和实现。**

所以当服务器执行

```
 String rmiUrl = "rmi://" + clientHost + ":" + clientPort + "/";
  clientCallbackHandler = (ClientCallbackHandler)Naming.lookup(rmiUrl + "ClientCallbackHandler"); 
```

**我在服务器**上收到以下异常：

 **```
 SEVERE: java.rmi.UnmarshalException: error unmarshalling return; nested exception is: 
java.lang.ClassNotFoundException: br.com.affair.socontrol.rmi.ClientCallbackHandlerImpl (no security manager: RMI class loader disabled) 
```

我正在避免安装 SecurityManager 和 Policy 文件（也尝试过但没有成功），我被困在这里。

我不明白为什么服务器只需要接口就抱怨实现类。任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T15:02:24.827

经过几个小时的努力，我终于找到了问题所在。

ClientCallbackHandlerImpl 类**没有扩展** *UnicastRemoteObject*。之后代码运行顺利。谢谢你阅读了这篇文章并思考了一些事情。

PS：我知道这看起来像是菜鸟的错，但我避免进行代码复制/粘贴。**

# jquery-mobile - 带有玉的JQuery手机不起作用

> ID：15233402
> 
> 赞同：1
> 
> 时间：2013-03-05T20:26:25.613
> 
> 标签：jquery-mobile, express, pug

我正在尝试将jquery mobile 与jade & express 一起使用。我对玉有点陌生，很高兴能帮助我弄清楚这里出了什么问题。我正在使用 zip 下载中包含的标准 Jquery mobile 1.3 文件`pre`

我有两个文件的布局：

```
doctype 5
html
  head
    title= title
    meta(charset='utf-8')
    meta(name='viewport',content='width=device-width, initial-scale=1')
    meta(name='apple-mobile-web-app-capable',content='yes')
    meta(name='apple-mobile-web-app-status-bar-style',content='black')
    link(rel='stylesheet', href='/pre/jquery.mobile-1.3.0.min.css')
    link(rel='stylesheet', href='/pre/jquery.mobile.structure-1.3.0.min.css')
    link(rel='stylesheet', href='/pre/jquery.mobile.theme-1.3.0.min.css')
    script(src='/pre/jquery-1.9.1.min.js')
    script(src='/pre/jquery.mobile-1.3.0.min.js')

  body
    block content 
```

还有我的内容：

```
extends layout
block content
  div#page1(data-role='page')
  div(data-theme='a',data-role='header')
    h3
      | Header
  div(data-role='content')
    a(data-role='button',href='#page1')
      | Button
    a(data-role='button',href='#page1')
      | Button
    a(data-role='button',href='#page1')
      | Button
  div(data-theme='a',data-role='footer',data-position='fixed')
    h3
      | Footer 
```

我得到的问题：

![在此处输入图像描述](../Images/92415e00a4b48175228d1214e611d23b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T07:29:07.473

你的缩进`content.jade`是错误的。缩进下面的所有内容`div#page1(data-role='page')`，它工作得很好

```
extends layout
block content
  div#page1(data-role='page')
    div(data-theme='a',data-role='header')
      h3 Header
    div(data-role='content')
      a(data-role='button',href='#page1') Button
      a(data-role='button',href='#page1') Button
      a(data-role='button',href='#page1') Button
    div(data-theme='a',data-role='footer',data-position='fixed')
      h3 Footer 
```

如您所见，您甚至可以通过不使用管道来简化代码`|`

# mysql - 如何显示一条记录是否在 MySQL 中的两个表中具有两个字段匹配？

> ID：15233406
> 
> 赞同：0
> 
> 时间：2013-03-05T20:26:28.793
> 
> 标签：mysql, left-join, match

我正在使用`MySQL 5.1`并且我正坐在一个查询上，我无法显示我需要的内容。

我有两张桌子。

```
#table 1 - auth tokens
sellerId 
zip
token

#table 2 - authenticated attempts
sellerId
buyerId
buyer_zip
buyer_submitted_token 
```

第二个表包括所有身份验证尝试（成功与否）。

我现在想显示表 1 中的所有记录（提交的 zip 和令牌）以及有关使用此组合的身份验证是否成功的信息（成功为`zip matches buyer_zip`和`token matches buyer_submitted_token`）。

问题是我无法让它工作。

这是我正在做的事情：

```
SELECT z.buyer_id,
   z.seller_id
   z.buyer_submitted_token
   z.buyer_zip
   k.token,
   k.zip

 FROM table_1 AS z

 LEFT JOIN table_2 AS k
    ON k.buyer_id= "12345"
    AND k.zip = z.buyer_zip
    AND k.token = z.buyer_submitted_token

 WHERE z.seller_id =  "12345"
 LIMIT 0, 50 
```

这将返回 table_1 中卖家的所有记录，这没问题。我要补充的是可用的组合是否已成功使用=`z.buyer_zip`并`z.buyer_submitted_token`匹配表2中的记录。

**问题：**
如果字段值为 A 和 B 的记录在另一个表中有匹配的记录，我如何检查 MySQL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:32:42.317

您可能在这里遇到问题：

```
ON k.buyer_id= "12345" 
```

在我的理解中应该将字段链接在一起

```
ON k.sellerId = z. sellerId 
```

# java - 如何在服务器/客户端/数据库应用程序中实现 MVC

> ID：15233409
> 
> 赞同：0
> 
> 时间：2013-03-05T20:26:38.327
> 
> 标签：java, model-view-controller, client-server

我正在编写一个由 gui 界面、客户端、服务器和数据库组成的应用程序。

然而，经过无数小时后，我仍然没有弄清楚如何组织这一切。

GUI 是由几个相当不同的挥杆组件构成的，所以我考虑为每个组件建立一个单独的模型。

目前的信息流是这样的：

1.  用户在 GUI 中插入一些信息。
2.  GUI 通过给控制器一个事件来告诉控制器发生了什么事。
3.  控制器将事件发送到服务器
4.  服务器评估事件并将适当的查询发送到数据库。
5.  然后将来自数据库的结果附加到事件中，并发送回客户端。
6.  控制器获取事件并使用新信息更新适当的模型
7.  然后模型更新相应的视图。

一种可能的情况是用户通过 GUI 搜索条目并返回结果。

这种架构听起来很正常吗？

所有不同的视图都应该有自己的模型吗？如果是，他们是否也应该有自己的控制器？如果没有，那是什么？

我考虑将整个模型发送到服务器，让服务器处理模型中的信息，然后将其发送回客户端。当客户端接收到它时，控制器确保新模型信息被附加到视图中。此解决方案消除了对单独事件类的需要，但这样做似乎不正确。

我想我要问的是按照 MVC 模式组织服务器/客户端/数据库应用程序的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:25:10.437

最好的方法是将客户端、服务器和数据库分开。

我的意思是，第一步是要知道客户端需要做什么，服务器需要做什么，数据库需要做什么：

数据库：

数据库实际上就是一个数据库，所以它无能为力

服务器：

在服务器中，您应该执行服务器上可能发生的所有事情：访问数据库、访问文件、...

客户：

客户将完成其余的工作。这里需要区分“显示数据”；那将是“视图”和管理数据；那将是控制器。为了提供具有您使用“控制器”的功能的 gui，因此最后 MVC 模型仍保留在客户端中

因此，我认为您的想法并没有您想的那么糟糕。我正在做一个这样的项目。我们正在按照我描述的方式工作，我可以确保一切看起来都很好。一切都是分开的。可以替换服务器和客户端，而无需更改其他内容。如果我们更改数据库，只有服务器会注意到它，如果我们更改 gui 库（swt、awt、swing...），只有客户端会注意到它。服务器和客户端都可以在不同的环境中运行，并且没有人注意到它。

所以如果我是你，我会按照你说的去做。试一试，你会发现它工作得很好。正如我所说，我或多或少遵循相同的工作流程，我只能说出好东西。

# javascript - 如何检查用户是否正在查看当前选项卡/窗口？

> ID：15233410
> 
> 赞同：2
> 
> 时间：2013-03-05T20:26:41.663
> 
> 标签：javascript, jquery, html

这是我唯一能想到的：

```
$(document).ready(function () {
  $([window, document]).focusin(function(){
    alert('hi');
  }).focusout(function(){
    alert('see you');
  }); 
```

但它不起作用。它应该在不查看页面时显示警报，并在查看页面时显示另一个警报。当然，这不是我的最终应用程序，但它应该以这种方式工作。有什么建议吗？

jQuery 已加载，内部的其他操作`$(document).ready()`正在运行，没有显示错误...

# javascript - 扩展列表不移动容器/页脚

> ID：15233411
> 
> 赞同：0
> 
> 时间：2013-03-05T20:26:43.417
> 
> 标签：javascript, css, html, html-lists

我有一个网站，您可以在[这里](http://drue.co.uk/1site/index.html)找到，当展开其中一个列表项时，我无法弄清楚为什么页面的整个高度没有被修改（页脚不会随着列表展开而移动）。有任何想法吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:29:38.603

`#inside`div 有一个`height`属性集。如果你删除它，你会得到你想要的行为。

**编辑**

看来您是`height`通过 javascript 设置属性以便为 div 设置动画`height`。

在这种情况下，动画完成后，您可以将 设置`height`为`auto`，因此`#inside`div 将尊重其子级`height`并正确扩展。

```
$pageWrap.animate({
    高度：baseHeight + $mainContent.height() + "px"
}, {
    完成：函数（）{
        $(this).css('height', 'auto');
    }
});

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:30:12.023

您的一个 div 上有一个手动样式：

```
<div id="inside" style="height: 367px;"> 
```

删除/禁用它，您的页面容器会相应地调整大小:)

# ruby-on-rails - 如何从另一个应用程序向 Ruby on Rails 发送 http 请求？

> ID：15233417
> 
> 赞同：2
> 
> 时间：2013-03-05T20:27:13.017
> 
> 标签：ruby-on-rails, ruby, http, lua, coronasdk

目前我正在使用 Corona SDK 在 Lua 中构建一个应用程序，基本上它所做的就是连接到 Ruby on Rails 应用程序中的数据库。

我想知道该怎么做，因为我似乎无法按照以下方式做一些事情：

**/posts/?name=test&title=test&content=test**

```
postData = "name=test&title=bla&content=none"

local params = {}
params.body = postData

network.request( "http://0.0.0.0:3000/posts/", "POST", networkListener, params) 
```

除了发送的参数外，这是有效的。

Ruby on Rails 应用程序正在使用基本的脚手架，但是我不确定如何能够在 RoR 应用程序中获取参数（名称、标题和内容）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:39:58.180

我发现你需要通过 Lua 中的关联数组和 json 编码来做到这一点：

```
local headers = {}
headers["Content-Type"] = "application/json"
headers["Accept-Language"] = "en-US"

local posts = {}
posts.name = "test"
posts.title ="bla"
posts.content = "ble"

postData = json.encode(posts)

local params = {}

params.headers = headers
params.body = postData

network.request( "http://0.0.0.0:3000/posts/", "POST", networkListener, params) 
```

# apache-camel - 阿帕奇骆驼 jcr 长耳兔

> ID：15233420
> 
> 赞同：3
> 
> 时间：2013-03-05T20:27:17.513
> 
> 标签：apache-camel, jackrabbit, jcr

我是骆驼世界的新手，在与 jcr 组件建立连接时遇到问题。看看我的测试代码：

```
import org.apache.camel.builder.RouteBuilder;
import org.apache.camel.component.jcr.JcrConstants;
import org.apache.camel.test.junit4.CamelTestSupport;
import org.junit.Test;

public class ObjectToJCRRouteTest extends CamelTestSupport {

    @Override
    protected RouteBuilder createRouteBuilder() throws Exception {
        return new RouteBuilder() {
            @Override
            public void configure() throws Exception {
                from("direct:a")
                        .setProperty(JcrConstants.JCR_NODE_NAME,
                                constant("node"))
                        .setProperty("my.contents.property", body())
                        .to("jcr://admin:admin@localhost:8080/home/test");
            }
        };
    }

    @Test
    public void putJCRNode() throws Exception {
        template.sendBodyAndHeader("direct:a", null, null, null);
        Thread.sleep(1000);
    }
} 
```

我试过 jcr://admin:admin@localhost/home/test", "jcr://admin:admin@localhost:8080/home/test" , "jcr://admin:admin@localhost:8080/repository /家/测试”

[我使用 rmi 使用存储库浏览器（ http://www.subshel](http://www.subshell.com/en/toromiro/index.html) ​​l.com/en/toromiro/index.html ）测试了jackrabbit，并且连接成功

提前感谢任何帮助！

**我的jackrabit服务器是：**

jmartinez@jmartinez:~/software/jackrabbit$ java -jar jackrabbit-standalone-2.4.3.jar

欢迎来到 Apache Jackrabbit！

使用存储库目录jackrabbit

将日志消息写入jackrabbit/log

启动服务器...

Apache Jackrabbit 现在运行在`http://localhost:8080/`

**pom配置**

```
 <dependency>
        <groupId>org.apache.camel</groupId>
        <artifactId>camel-jcr</artifactId>
        <version>2.10.4</version>
      </dependency> 
```

**异常代码是**

```
org.apache.camel.FailedToCreateRouteException: Failed to create route route1 at: >>> To[jcr://admin:admin@localhost:8080/rmi/home/test] <<< in route: Route[[From[direct:a]] -> [SetProperty[CamelJcrNodeName, {no... **because of Failed to resolve endpoint: jcr://admin:admin@localhost:8080/rmi/home/test due to: No JCR repository defined under 'localhost'**
    at org.apache.camel.model.RouteDefinition.addRoutes(RouteDefinition.java:879)
    at org.apache.camel.model.RouteDefinition.addRoutes(RouteDefinition.java:172)
    at org.apache.camel.impl.DefaultCamelContext.startRoute(DefaultCamelContext.java:722)
    at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:1789)
    at org.apache.camel.impl.DefaultCamelContext.doStartCamel(DefaultCamelContext.java:1575)
    at org.apache.camel.impl.DefaultCamelContext.doStart(DefaultCamelContext.java:1444)
    at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:60)
    at org.apache.camel.impl.DefaultCamelContext.start(DefaultCamelContext.java:1412)
    at org.apache.camel.test.junit4.CamelTestSupport.startCamelContext(CamelTestSupport.java:184)
    at org.apache.camel.test.junit4.CamelTestSupport.setUp(CamelTestSupport.java:115)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.apache.camel.ResolveEndpointFailedException: Failed to resolve endpoint: jcr://admin:admin@localhost:8080/rmi/home/test due to: No JCR repository defined under 'localhost'
    at org.apache.camel.impl.DefaultCamelContext.getEndpoint(DefaultCamelContext.java:479)
    at org.apache.camel.util.CamelContextHelper.getMandatoryEndpoint(CamelContextHelper.java:50)
    at org.apache.camel.model.RouteDefinition.resolveEndpoint(RouteDefinition.java:187)
    at org.apache.camel.impl.DefaultRouteContext.resolveEndpoint(DefaultRouteContext.java:108)
    at org.apache.camel.impl.DefaultRouteContext.resolveEndpoint(DefaultRouteContext.java:114)
    at org.apache.camel.model.SendDefinition.resolveEndpoint(SendDefinition.java:61)
    at org.apache.camel.model.SendDefinition.createProcessor(SendDefinition.java:55)
    at org.apache.camel.model.ProcessorDefinition.makeProcessor(ProcessorDefinition.java:461)
    at org.apache.camel.model.ProcessorDefinition.addRoutes(ProcessorDefinition.java:179)
    at org.apache.camel.model.RouteDefinition.addRoutes(RouteDefinition.java:876)
    ... 32 more
Caused by: org.apache.camel.RuntimeCamelException: No JCR repository defined under 'localhost'
    at org.apache.camel.component.jcr.JcrEndpoint.<init>(JcrEndpoint.java:65)
    at org.apache.camel.component.jcr.JcrComponent.createEndpoint(JcrComponent.java:31)
    at org.apache.camel.impl.DefaultComponent.createEndpoint(DefaultComponent.java:91)
    at org.apache.camel.impl.DefaultCamelContext.getEndpoint(DefaultCamelContext.java:461)
    ... 41 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T07:58:37.843

Camel url 的主机部分`jcr:`不应引用实际的网络主机，而应引用`javax.jcr.Repository`在 Camel 注册表中定义的对象实例。大多数情况下，这意味着它将被定义为 Spring 或 Blueprint XML 文件中的 bean。

要在单元测试中做同样的事情，您可以重写`createRegistry`将 bean 添加到 Camel 注册表的方法。在下面的代码示例中，将 JackRabbit`URLRemoteRegistry`添加到 Camel 注册表，名称为`MyJCR`。

路由本身正在使用 URL `jcr://admin:admin@MyJCR/default/home/test`。请注意，`/default`添加了部分 URL 以指向要添加节点的 JCR 存储库工作区。

```
public class ObjectToJCRRouteTest extends CamelTestSupport {

  @Override
  protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder() {
      @Override
      public void configure() throws Exception {
        from("direct:a")
              .setProperty(JcrConstants.JCR_NODE_NAME,
                           constant("node"))
              .setProperty("my.contents.property", body())
              .to("jcr://admin:admin@MyJCR/default/home/test");
      }
    };
  }

  @Override
  protected JndiRegistry createRegistry() throws Exception {
    JndiRegistry registry = super.createRegistry();
    registry.bind("MyJCR", new URLRemoteRepository("http://localhost:8080/rmi"));
    return registry;
  }

  @Test
  public void putJCRNode() throws Exception {
    template.sendBody("direct:a", "Some contents");
    Thread.sleep(1000);
  }
} 
```

# c++ - memcpy 变成一个向量 从原始内存位置

> ID：15233421
> 
> 赞同：4
> 
> 时间：2013-03-05T20:27:18.953
> 
> 标签：c++, c++11, stdvector, memcpy, wstring

我正在使用一个 API，它在内存中提供感兴趣的字符串的内存地址和长度。我想将这些字符串读入更友好的对象，如 wstring。

对于较小的字符串，静态大小的缓冲区可以使用以下代码正常工作：

```
// This code works (but may have other issues)
// _stringLengthOffset and _bufferOffset are provided earlier by the API
// stringOID is the memory location of the string (and in terms of the API, the ObjectID)
DWORD stringLength;
memcpy(&stringLength, ((const void *)(stringOID + _stringLengthOffset)), sizeof(DWORD));
wchar_t argString[DEFAULT_ARGVALUE_BUFFER_SIZE];
memcpy(argString, ((const void *)(stringOID + _bufferOffset)), (stringLength) * sizeof(wchar_t));
argString[stringLength] = L'\0';  // Strings are not null terminated in memory
wstring argumentValue = argString; 
```

我认为创建一个非常非常大的静态大小的缓冲区不是一个好主意（这些字符串可能有 20,000 个或更多字符。）我尝试了几种不同的方法，这段代码看起来很接近但不起作用。

```
// This code does NOT work. 
vector<wchar_t> buffer;
buffer.reserve( stringLength + 1 );
memcpy( &buffer[0], (const void *)(stringOID + _bufferOffset), (stringLength) * sizeof(wchar_t) );
buffer.push_back( L'\0' );
buffer.shrink_to_fit();
wstring argumentValue( buffer.begin(), buffer.end() ); 
```

**问题：如果目标是创建一个 wstring，如何正确地从原始内存（由这个特定的 API 提供）复制到一个动态大小的缓冲区，然后创建一个 wstring？** （*如果之前已经回答过这个问题，我们深表歉意，因为我之前的某个人似乎会问一些问题，但经过几个小时的搜索，我无法找到合适的问题/答案。*）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:36:33.567

有很多方法。

1）使用调整大小而不是保留并执行memcpy。也摆脱了收缩配合。

2）直接赋值给字符串：

```
const wchar_t* pstr = reinterpret_cast<const wchar_t*>(stringOID + _bufferOffset);
wstring s(pstr, pstr + stringLength);
// or:
wstring s(pstr, stringLength); 
```

选项 2) 避免复制和另外初始化调整大小的向量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:31:53.360

```
std::wstring foo (somebuffer, charactercount); 
```

保留不会使向量 x wchar_t 很长。它只是预先分配。向量仍然认为它里面有 0 个项目。当您调用 push_back 时，向量现在包含 1 个字符。shrink_to_fit 将其保留为 1 个字符。memcpy 无法告诉向量在复制后需要多长时间。我建议使用上面的答案，但如果你一心想要使用矢量，它会调整大小，而不是保留。不要做+1。这将在 push_back 中处理。

# c# - 如何在 MSBuild 中处理类似插件的依赖项？

> ID：15233424
> 
> 赞同：1
> 
> 时间：2013-03-05T20:27:30.480
> 
> 标签：c#, plugins, visual-studio-2012, msbuild

我有一个带有插件模型的项目。它还附带了几个默认插件。我想告诉 Visual Studio（以及 Team Build 服务器上的 MSBuild），在构建主应用程序时，它需要将“DefaultPlugin.dll”从“DefaultPluginProject”复制`$(OutDir)`到它自己的`$(OutDir)Plugins`.

我明确不想将主项目中的项目引用添加到插件项目中；如果主项目依赖于插件，这将使编译成为可能，这是不可取的。项目依赖系统的“CopyLocal”`$(OutDir)`在任何情况下都只能直接复制到，而不是`$(OutDir)Plugins`.

有没有办法`$(OutDir)`从 MSBuild 中的 ProjectReference 项中检索？

作为参考，我尝试了以下两种解决方案：

*   运行复制文件的 Post-Build-Step。这在构建服务器上失败了，因为 的值`$(OutDir)`在那里完全不同。
*   将插件项目的输出目录设置为“..\MainProject\x86\Debug\Plugins”。这是不可取的，因为它使找出哪个项目导致哪些文件被复制变得困难。

# javascript - Chrome在具有边框半径的缩放元素内弄乱了图像

> ID：15233426
> 
> 赞同：6
> 
> 时间：2013-03-05T20:27:31.280
> 
> 标签：javascript, css, google-chrome, transform, scale

## 用例

我正在尝试构建一个“幻灯片放映”类型的应用程序。每张幻灯片都有一个固定的纵横比，但我希望内容以其正常的宽度/高度呈现 - 所以我试图在幻灯片的内容上使用 CSS3“transform:scale”，使用视口宽度/高度我计算理想的比例/边距以使幻灯片适合视口。在一张特定的幻灯片上，我展示了一些人的“信息卡”和每个人的“继任者”列表

## 问题

Chrome 在图像上显示出一些非常奇怪的行为。如果您调整窗口大小，图像会到处移动。如果您强制图像以某种方式重新绘制，图像似乎会自行修复（即向下滚动页面并向上滚动）

**编辑这似乎与边框半径框内的图像特别相关！**

## 问题

这是 Chrome 中的错误吗？是否有任何解决方法可以解决此问题？

## 活生生的例子

[现场小提琴](http://jsfiddle.net/aaR86/1/)

在这个实时示例中 - 您可以调整结果窗格的大小以缩放图像。至少在我的 chrome 版本中，图像变得混乱。

## 发布编辑

我将代码缩小到重现问题所需的最低限度。我只使用了 webkit 供应商前缀。

我还更新了问题描述，因为在整理代码之后，我意识到它一定与包含图像的元素的边框半径有关！

[原始小提琴](http://jsfiddle.net/aaR86)

## HTML

```
<div class="container">
    <div class="inner">
        <div class="box">
            <img src="https://en.gravatar.com/userimage/22632911/5cc74047e143f8c15493eff910fc3a51.jpeg"/>
        </div>
    </div>
</div> 
```

## CSS

```
body {
    background-color: black;
}

.inner {
    background-color: white;
    width: 800px;
    height: 600px;
    -webkit-transform-origin: 0 0;
}

.box {
    overflow: hidden;
    -webkit-border-radius: 10px;
    width: 80px;
    height: 80px;
    margin: 10px;
} 
```

## JAVASCRIPT

```
(function ($) {
    var $inner = $('.inner');
    var $window = $(window);
    var iWidth = parseInt($inner.css('width'));
    var iHeight = parseInt($inner.css('height'));
    var iRatio = iWidth / iHeight;

    function adjustScale() {
        var vWidth = $window.width();
        var vHeight = $window.height();
        if (vWidth / vHeight > iRatio) {
            width = vHeight * iRatio;
        } else {
            width = vWidth;
        }
        var scale = width / iWidth;
        $inner[0].style.WebkitTransform = 'scale(' + scale + ')';
    }

    adjustScale();
    $window.resize(adjustScale);
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T13:46:02.643

发生这种情况是因为您在这里执行除法

```
var scale = width / iWidth; 
```

那是给你一个有很多小数的数字；

使用这个数字`CSS3 Transform - Scale()`会强制引擎执行一些冗长的计算，这显然不是由`Chrome`;

然后 +1，您可能发现了一个 CSS 引擎缺陷`Chrome`。

* * *

对于记录： 显然，Chrome 从**两个**十进制数字开始出现问题：

```
// Bad
var scale = (width / iWidth).toFixed(2); 
```

> （不）工作演示：http: [//jsfiddle.net/VPZqA/1/](http://jsfiddle.net/VPZqA/1/)

随意打开错误报告`@ Google`。

* * *

# 解决方案：

为了防止这种情况，您可以简单地将值四舍五入为**一个**十进制数，如下所示：

```
// Right
var scale = (width / iWidth).toFixed(1); 
```

> 工作演示：http: [//jsfiddle.net/VPZqA/](http://jsfiddle.net/VPZqA/)

这样你的数学就会不那么精确，但在某种程度上可能并不明显。

希望有帮助

# android - 从主要活动切换到新活动时应用程序崩溃

> ID：15233429
> 
> 赞同：1
> 
> 时间：2013-03-05T20:27:46.060
> 
> 标签：android, android-intent, android-activity, buttonclick

当我使用菜单按钮切换到新页面并调用新 Activity 时，我的应用程序崩溃了。我遵循了来自 android 开发者网站的教程，该教程展示了如何将按钮单击链接到新活动，但是当我单击按钮对象时，应用程序崩溃而不更改为新活动。

我有六种不同的活动与主要活动相关联。

我的日志猫如下：

```
03-05 20:12:10.185: W/ActivityManager(288): Activity pause timeout for ActivityRecord{40d31ab0 u0 com.example.g00290342bvarley/.MainActivity}
03-05 20:12:10.394: E/SurfaceFlinger(36): ro.sf.lcd_density must be defined as a build property
03-05 20:12:10.954: E/SurfaceFlinger(36): ro.sf.lcd_density must be defined as a build property
03-05 20:12:11.065: W/EGL_emulation(863): eglSurfaceAttrib not implemented
03-05 20:12:11.474: I/QSB.SuggestionsProviderImpl(863): chars:0,corpora:[web, apps, com.android.contacts/.activities.PeopleActivity]
03-05 20:12:11.604: E/SurfaceFlinger(36): ro.sf.lcd_density must be defined as a build property
03-05 20:12:11.744: W/EGL_emulation(449): eglSurfaceAttrib not implemented
03-05 20:12:12.815: I/Choreographer(288): Skipped 32 frames!  The application may be doing too much work on its main thread.
03-05 20:12:13.114: D/dalvikvm(863): GC_CONCURRENT freed 398K, 13% free 3825K/4348K, paused 11ms+154ms, total 867ms
03-05 20:12:15.115: I/Process(1467): Sending signal. PID: 1467 SIG: 9
03-05 20:12:15.285: I/WindowState(288): WIN DEATH: Window{40dbdb70 u0 com.example.g00290342bvarley/com.example.g00290342bvarley.MainActivity}
03-05 20:12:15.297: I/ActivityManager(288): Process com.example.g00290342bvarley (pid 1467) has died.
03-05 20:12:15.455: W/InputMethodManagerService(288): Got RemoteException sending setActive(false) notification to pid 1467 uid 10048
03-05 20:12:36.119: D/ExchangeService(688): Received deviceId from Email app: null
03-05 20:12:36.119: D/ExchangeService(688): !!! deviceId unknown; stopping self and retrying
03-05 20:12:41.254: D/ExchangeService(688): !!! EAS ExchangeService, onCreate
03-05 20:12:41.264: D/ExchangeService(688): !!! EAS ExchangeService, onStartCommand, startingUp = false, running = false
03-05 20:12:41.284: W/ActivityManager(288): Unable to start service Intent { act=com.android.email.ACCOUNT_INTENT } U=0: not found
03-05 20:12:41.294: D/ExchangeService(688): !!! Email application not found; stopping self
03-05 20:12:41.304: D/ExchangeService(688): !!! EAS ExchangeService, onStartCommand, startingUp = true, running = false
03-05 20:12:41.334: W/ActivityManager(288): Unable to start service Intent { act=com.android.email.ACCOUNT_INTENT } U=0: not found
03-05 20:12:41.354: E/ActivityThread(688): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d06b20 that was originally bound here 
```

`MainActivity`按钮方法所在的位置：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.EditText;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    //methods for button clicks

    public void aboutMeth(View view) {
        // Do something in response to button
        Intent intent = new Intent(this, AboutGmit.class);
        EditText editText = (EditText) findViewById(R.id.about);
        startActivity(intent);

    }

    public void mapMeth(View view) {
        // Do something in response to button
        Intent intent = new Intent(this, MapGmit.class);
        EditText editText = (EditText) findViewById(R.id.map);
        startActivity(intent);
    }

    public void courseMeth(View view) {
        // Do something in response to button
        Intent intent = new Intent(this, CourseInfo.class);
        EditText editText = (EditText) findViewById(R.id.courseInfo);
        startActivity(intent);
    }

    public void lifeMeth(View view) {
        // Do something in response to button
        Intent intent = new Intent(this, StudentLife.class);
        EditText editText = (EditText) findViewById(R.id.studLife);
        startActivity(intent);
    }

    public void portalMeth(View view) {
        // Do something in response to button
        Intent intent = new Intent(this, StudentPortal.class);
        EditText editText = (EditText) findViewById(R.id.studPortal);
        startActivity(intent);
    }

    public void contactMeth(View view) {
        // Do something in response to button
        Intent intent = new Intent(this, ContactInfo.class);
        EditText editText = (EditText) findViewById(R.id.contact);
        startActivity(intent);
    }

} 
```

新活动名为`ContactInfo.java`

```
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class ContactInfo extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_contact_info);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.contact_info, menu);
        return true;
    }

} 
```

我在其中添加了活动元素的清单文件。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.g00290342bvarley"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.g00290342bvarley.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.example.g00290342bvarley.AboutGmit"
            android:label="@string/title_activity_about_gmit" 
             android:parentActivityName="com.example.g00290342bvarley.MainActivity"
            >
        </activity>
        <activity
            android:name="com.example.g00290342bvarley.MapGmit"
            android:label="@string/title_activity_map_gmit"
             android:parentActivityName="com.example.g00290342bvarley.MainActivity"
            >
        </activity>
        <activity
            android:name="com.example.g00290342bvarley.CourseInfo"
            android:label="@string/title_activity_course_info" 
             android:parentActivityName="com.example.g00290342bvarley.MainActivity"
            >
        </activity>
        <activity
            android:name="com.example.g00290342bvarley.StudentLife"
            android:label="@string/title_activity_student_life" 
             android:parentActivityName="com.example.g00290342bvarley.MainActivity"
            >
        </activity>
        <activity
            android:name="com.example.g00290342bvarley.StudentPortal"
            android:label="@string/title_activity_student_portal" 
            android:parentActivityName="com.example.g00290342bvarley.MainActivity"
            >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.example.g00290342bvarley.MainActivity" />
        </activity>
        <activity
            android:name="com.example.g00290342bvarley.ContactInfo"
            android:label="@string/title_activity_contact_info" 
             android:parentActivityName="com.example.g00290342bvarley.MainActivity"
            >
        </activity>
    </application>

</manifest> 
```

activity_main.xml 中的按钮布局

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout2"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".MainActivity" >

    <Button
        android:id="@+id/about"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:onClick="aboutMeth"
        android:hint="Details about GMIT"
        android:text="@string/about" />

    <Button
        android:id="@+id/map"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="95dp"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:onClick="mapMeth"
        android:hint="Location of GMIT on google maps"
        android:text="@string/map" />

    <Button
        android:id="@+id/courseInfo"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:onClick="courseMeth"
        android:hint="Info about courses offered by GMIT"
        android:text="@string/courseInfo" />

    <Button
        android:id="@+id/studLife"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="98dp"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:hint="Gallery"
        android:onClick="lifeMeth"
        android:text="@string/studLife" />

    <Button
        android:id="@+id/studPortal"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="93dp"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:onClick="portalMeth"
        android:hint="The Student Portal!"
        android:text="@string/studPortal" />

    <Button
        android:id="@+id/contact"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:onClick="contactMeth"
        android:hint="GMIT contact info"
        android:text="@string/contact" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T00:45:43.463

我可能会遗漏一些东西，但我试一试。在每个 onClick 方法中，您都试图获得一个 editText。

```
EditText editText = (EditText) findViewById(R.id.contact); 
```

但是你的布局中没有声明editText，所以它变成了NullPointerException。尝试删除此行。希望它会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:31:10.120

该`<activity>`元素属于您的`AndroidManifest.xml`文件，而不是您的布局文件。

您需要将所有 6 个活动添加到您的`AndroidManifest.xml`文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:34:34.787

这个

```
 <activity
    android:name="com.example.g00290342bvarley.ContactInfo"
    android:label="@string/title_activity_contact_info"
    android:parentActivityName="com.example.g00290342bvarley.MainActivity" >
    <meta-data
        android:name="android.support.PARENT_ACTIVITY"
        android:value="com.example.g00290342bvarley.MainActivity" />
</activity> 
```

在**Manifest**中，而不是在您活动的 XML 中！

# regex - sed 和正则表达式问题

> ID：15233432
> 
> 赞同：2
> 
> 时间：2013-03-05T20:27:51.730
> 
> 标签：regex, sed

我需要帮助对文件执行 sed 语句，但我似乎无法弄清楚为什么我所拥有的东西不起作用。我进行了彻底的搜索，每个结果都有类似的结果，但是我只是不明白为什么我的结果没有我期望的结果。

我有一个包含几个列表的文件，例如

```
192.168.10.23:7020
192.168.10.23:4520
192.168.10.23:3320 
```

等等，基本上我需要用 192.168.10.23:XX21 替换 192.168.10.23:XX20。

其中，我尝试过：

```
sed 's/\:\([0-9]\)\{2\}20/\:&21/g' $file 
```

结果如下：

```
192.168.10.23:702021
192.168.10.23:452021
192.168.10.23:332021 
```

并且：

```
sed 's/\:\([0-9]\)\{2\}/\:&21/g' 
```

结果如下：

```
192.168.10.23:702120
192.168.10.23:452120
192.168.10.23:332120 
```

其他尝试要么根本没有改变，要么有截然不同的结果。我觉得我很近，却又很远。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:31:18.360

为什么你不能只是

```
sed 's/20$/21/' 
```

但也有可能，本着您原始解决方案的精神：

```
sed 's/\(:[0-9]*\)20/\121/' 
```

`&`它使用代替`\1`，它只重复括号匹配的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:38:33.080

这应该有效：

`sed 's/:\([0-9]\{0,3\}\)20/:\121/g' $file`

另外，我假设您的端口号将是从 2 位到 5 位的端口号。

示例： [http ://regexr.com?340vk](http://regexr.com?340vk)

# mysql - 获取特定列中具有唯一值的行 - MySQL

> ID：15233433
> 
> 赞同：0
> 
> 时间：2013-03-05T20:27:52.947
> 
> 标签：mysql, group-by, unique

我有以下mysql查询-：

我有一张桌子->

```
feed_id | by_id | sharer 
```

它具有以下值->

```
 (1 , 1 , NULL)  , (2, 1, iop_23) , (3, 1, iop_23) 
```

我运行这个查询 `SELECT * FROM feed WHERE by_id = 1 GROUP BY sharer ORDER BY feed_id DESC LIMIT 10`

使用此查询，我试图获取具有 sharer = NULL 或如果不是 NULL 则为唯一值的行。

它应该返回->`(1 , 1 , NULL) , (3, 1, iop_23)`

但它正在返回->`(1 , 1 , NULL) , (2, 1, iop_23)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:34:02.060

它返回错误值的原因是因为您的列`select`不在其中`group by`并且没有聚合函数。结果是不确定的。

如果您想要具有最大 id 的那个：

```
select s.*
from sharer s left outer join
     (select sharer, max(feed_id) as maxf
      from feed
      group by sharer
     ) sf
     on s.feed_id = maxf
where s.sharer is null or sf.sharer is not null 
```

您需要左外连接来获取所有 NULL 值。该`where`子句一方面是在 NULL 值之间进行选择，另一方面是在最大 id 行之间进行选择。

看起来您想要`id`每个最大`sharer`的行加上所有具有 NULL 值的行。也许我误解了这个问题，但这是我的解释。

这通过首先找到每个共享者的最大 id，然后将其连接回原始数据来找到这些行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:33:23.170

这是 a 的正确结果`GROUP BY`。要获取为组返回的最后一条记录，您需要先进行内部查询进行排序，然后在外部查询中进行分组：

```
SELECT * FROM (
    SELECT * FROM feed WHERE by_id = 1 ORDER BY feed_id DESC
) AS `a` GROUP BY sharer LIMIT 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:40:46.077

尝试这个

```
 SELECT max(feed_id) as feed_id ,by_id ,sharer FROM feed 
   WHERE by_id = 1 
   GROUP BY sharer 
   ORDER BY feed_id DESC LIMIT 10 
```

[**在这里演示**](http://sqlfiddle.com/#!2/07856/2)

# php - Quercus PHP Grails 字符编码问题

> ID：15233439
> 
> 赞同：0
> 
> 时间：2013-03-05T20:28:45.857
> 
> 标签：php, grails, resin, quercus

我成功地使用了最新的树脂罐（来自[http://www.caucho.com/download/](http://www.caucho.com/download/)），让我可以在我的 Grails Web 应用程序中使用遗留的 PHP 代码。除了非 ASCII 字符集之外，一切都很好。

> 这些字符显示为问号，看起来像这样： **???? ?? ？？？**.

我尝试了许多解决方案：

从将 php.ini 设置为**utf8**，到确保`extension=php_mbstring.dll`包含在 php.ini 中。我还确保 MySQL 数据库配置为执行 utf-8。存储在数据库中的字符在 phpMyAdmin 中正确显示。
另外，我可以做一个`die("BLAH")`，其中*BLAH*是非 ASCII 文本，它会正确输出到浏览器。我的浏览器在所有页面上显示内容标题 utf-8。

另一个关键是我能够在 Grails 中运行 PHP 代码库，并在**同一台机器上的***WAMP*服务器中运行它，连接到**同一台 MySQL**数据库，它可以很好地输出非 ASCII 字符。

 ****我的感觉是，这是从 MySQL 到在 Grails 中运行的 PHP 的数据传输问题（请记住，它可以从 MySQL 到在 WAMP 中运行的同一 PHP）。在这两种情况下，我什至`mysql_query("SET NAMES 'utf8'")`在运行查询之前都在执行。

我也尝试过获取 WAMP php.ini 文件并在 Grails 中使用它，而 Grails PHP 仍然无法正常运行……我的一部分认为 Grails 中的 PHP 没有读取 php.ini 文件，并且正在依赖一些默认的 php.ini （我不知道）。
例如，如果我将 Grails php.ini 文件设为空文件，Grails 仍然可以正常启动，并且可以渲染 php 页面。但是如果我将 php.ini 设置为像“asdfasdf”这样的垃圾文本，Grails 将无法启动......所以这让我相信它正在看到 php.ini......

*附加信息：*

*   MySQL 版本：**5.0.22**
*   Grails 中的 PHP 版本（树脂**/Quercus）：5.3.2**
*   WAMP 中的 PHP 版本：**5.1.4**
*   Grails **2.2版**

我已经尝试了我在网上找到的所有东西，但没有运气......感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T00:49:00.720

Quercus 的下一个版本 (4.0.36) 修复了长期存在的 MySQL 编码问题。看：

[http://forum.caucho.com/showthread.php?p=36255#post36255](http://forum.caucho.com/showthread.php?p=36255#post36255)****

# c++ - Winsock 监听和接受函数 (C++)

> ID：15233441
> 
> 赞同：1
> 
> 时间：2013-03-05T20:28:53.327
> 
> 标签：c++, winsock, listen

如果我在无限循环中有一个监听套接字，在我运行接受函数之前，有什么方法可以让我知道是否已经与它建立了连接？我希望能够在执行之前执行一些操作：

```
sock_connection[0] = accept(sock_listen, (SOCKADDR*)&Address, &AddressSize) 
```

具体来说，如您所见，我的 sock_connection[0] 变量是一个数组。现在，在我真正接受连接之前，我希望能够遍历这个数组，而不是它现在拥有的 0，它应该返回数组中的一个可用点。

那么，有没有办法在运行接受之前检测连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:38:38.557

使用动态容器不是更容易吗？

就像是：

```
vector<int> socket_pool;
int connection = accept(sock_listen, (SOCKADDR*)&Address, &AddressSize);

if (connection > 0)
     socket_pool.push_back(connection); 
```

# mercurial - 在 mercurial 中创建新头像

> ID：15233442
> 
> 赞同：1
> 
> 时间：2013-03-05T20:28:54.407
> 
> 标签：mercurial, branch

在我当前的工作流程中，每当我需要一个分支时，我都会使用书签，但是为了从当前修订版创建一个新的头，我必须提交一些虚拟更改并返回一个修订版，然后提交，否则将提交到同一个头像，不管我有多少书签。

例如，假设我在第 40 版：

```
hg bookmark main
hg ci somefile -m 'dummy commit' # on rev 41 now
hg up -r 40
# make some changes
hg ci -A -m 'changes in bookmark' # created new head
hg bookmark test 
```

这是常见的还是有一些捷径可以强制创建一个新的头部？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:16:02.013

我想你想练习 nvie 的工作流程，所以你想用 --no-ff 与上游合并。

据我所知， hg 不支持与同一分支中的上游合并。正如这篇[文章](http://jhw.dreamwidth.org/1868.html)所说，hg 的头/书签是 git't 分支，而 hg 的分支是血统。

因此，解决方案是在分叉点，您更改书签和分支，然后您可以合并分支，因为它们是不同的沿袭。

在我的示例中，您可以轻松地`hg branch -f dev`重新打开分支，即使它们没有连接。

所以你可以有这样的分支：

*   默认
*   稳定的
*   特征
*   修补程序

那么书签的前缀应该是：

*   特征-*
*   修补程序-*

并且它们应该从相应的分支分支出来。

然后他们可以

![我的示例的 Graphlog](../Images/0067d8cb03ccca905b7e5d127c84a341.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:23:37.757

在您的示例中无需创建第二个头，也不应强制创建它。

您的工作流程的优点是您可以停止功能工作`test`以对主分支进行更紧急的更改，如下所示：

```
> hg bookmark main
> hg bookmark test         # Start work on feature test

 ... do some code ...

> hg commit -m "Working on feature test"
> hg update main           # Stop working on test, start working on main

 ... do an urgent fix ...

> hg commit -m "Urgent fix"
> hg update test           # Back to work on feature test

 ... do some more code ...

> hg update main           # Finished the work so back to main
> hg merge test            # Merge the work into main
> hg commit -m "Merge in feature test" 
```

完成后，您将完成新功能并将其合并回主开发分支。

`main`如果您在完成功能处理后未对分支进行任何更改，`test`那么您无法合并更改，因为您无法将变更集合并到祖先中，因此您需要将`main`书签移动到`test`书签如下：

```
> hg update test
> hg bookmark main -f 
```

（我相信这被称为快进合并，如果你愿意，你可以强制合并，但据我所知`git`没有等价物）`mercurial`

# java - Java Await 语句 - 并发编程

> ID：15233444
> 
> 赞同：0
> 
> 时间：2013-03-05T20:29:02.387
> 
> 标签：java, concurrency, semaphore, async-await

我有一个问题是我们的讲师提出的。它是指等待上环岛的汽车，以免环岛堵塞。据说他给了我们一种使用“await(BS)”语句来解决这个问题的方法，并要求我们将其转换为使用信号量，但是他给出的代码不能计算大声笑。我不知道他在玩什么，但这在 Java 中没有意义……谁能帮我翻译一下……

```
package roundabout;
public class roundabout01
{
Process main;
{
/* declare and initialize global variables */
int NUMBER_OF_CARS = 20;
int numberOnRoundabout = 0;
/* slots on the roundabout */
String slots [] = {"[.....]", "[.....]", "[.....]", "[.....]", "[.....]", "[.....]"};
/* create and set the cars moving */
for (int count = 1; NUMBER_OF_CARS < 6; count++);
{
int entry = 3;
int exit = 3;
carProcess(entry, exit);
// end for; /*end main process*/
}
Process carProcess (int s, int t);
{
<await((numberOnRoundabout<=6), numberOnRoundabout++)>; /* Wait if roundabout crowded*/
/* wait for clearance before moving on to the roundabout */
<await(slots[2..s]=="[.....]"); AND (slots[2..s + 7] mod 8 == "[.....]");
slots[2..s]="["+entry+"-->"+exit+"]";
int currentPosition = 2*s;
int nextPosition = 2*s+1; /* move around to exit position (which is 2t) */
}
do
{
<await(slots[nextPosition]="[.....]");
slots[nextPosition]=slots[currentPosition];
slots[currentPosition]="[.....]">
currentPosition != nextPosition;
nextPosition = (nextPosition + 1) mod 8;
}
while (currentPosition != 2*t);
{
slots[currentPosition]="[.....]";
numberOnRoundabout -- ; /* move off the roundabout */
End carProcess;
}
}
} 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:10:04.200

他最终告诉我们的是，他给我们的问题是多年前的问题。问题中的代码是冗余的 Java。对于其他任何有老师的人来说，当这种代码格式出现“await((numberOnRoundabout<=6), numberOnRoundabout++)”时，它就是旧的 Java。翻译过来的将是一系列使用其中设置的条件创建的线程对象。

例如

```
public synchronized void myStop() {
      this.runningFlag=false;
      t.interrupt();
      } // end myStart 
```

我希望没有人需要这些信息！曾经！

# arrays - 将数据存储在数据结构中而不是将它们嵌入到 if/switch 语句中的优点/缺点

> ID：15233445
> 
> 赞同：0
> 
> 时间：2013-03-05T20:29:05.413
> 
> 标签：arrays, assembly, compiler-construction, switch-statement, compiler-optimization

例如，假设我想枚举一个字符串列表 {“ALPHA”、“BETA”、“GAMMA”、“OMEGA”}。我能想到的两种方法：

```
--- Method 1 ---
string getType(int a)
{
   switch(a)
   {
      case 0: return "ALPHA"; 
      case 1: return "BETA";
      case 2: return "GAMMA";
      case 3: return "OMEGA";
   }
} 
```

或者我可以创建一个字符串数组并使用它来返回相应的字符串元素：

```
--- Method 2 ---
string data[] = { "ALPHA", "BETA", "GAMMA", "OMEGA" };
string getType(int a)
{
     return data[a];
} 
```

（假设一个非常大的数据集）编译器如何处理这两种方法？最终的汇编代码是什么样的？一种方法在检索元素方面是否比另一种方法更快？一个人会占用更多的内存空间吗？或者它们是否被翻译成相同的机器代码？

我最好的猜测是方法 2 工作得更快，但也占用了更多的内存空间，因为它需要数组的空间；而方法 1 每次调用 getType(..) 时都需要更多时间，但需要更少的内存，因为变量只存储在汇编命令中。但我仍然不知道 C++ 或其他语言编译器将如何处理代码，可能会产生完全不同的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:34:24.750

只需使用数组。对于大量的字符串，它显然更有效，而对于少量的字符串，在 switch 语句上使用数组的开销无论如何都是微不足道的。你学会不做疯狂的事情的好处是值得额外的开销。:-)

如果您真的想分析差异，我认为您会发现它可能取决于您运行它的机器的资源，因为一种方法显然更占用内存，而另一种方法更多 CPU。

# php - PHP 将 Memory_limit 锁定为 256M 且无法更改

> ID：15233449
> 
> 赞同：0
> 
> 时间：2013-03-05T20:29:15.200
> 
> 标签：php, ubuntu-12.04, virtualhost, memory-limit, php-ini

我一直在搜索，找不到与我的问题相关的任何内容。无论我更改 memory_limit = VALUE 多少次，php 信息页面都会显示 256MB。它发生在我的虚拟主机上。（这是我使用它的地方）。

我正在运行 Ubuntu 12.04，这就是我到目前为止所做的。

运行 php -i （给了我完整的列表和设置显示；）

```
memory_limit => -1 => -1 
```

运行 php -i | grep php.ini

```
Configuration File (php.ini) Path => /etc/php5/cli
Loaded Configuration File => /etc/php5/cli/php.ini 
```

我检查了服务器上的所有 php.ini，因为我的配置允许每个目录使用单独的 php.ini，而其他所有目录都有 128MB。

因为我的 php 信息页面显示了我在 php.ini 上为虚拟主机的根目录设置的所有值，所以我认为这是一个上限并且不能提高？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-12T20:41:25.697

全局 php.ini 可能不会“渗透”到本地“帐户”。

我有一个 CentOS cPanel 服务器就是这种情况。我设置了全局 php.ini，它对其中一个帐户中的网站没有影响，即使本地 php.ini 或本地 .htaccess 文件中没有“memory_limit”。

默认值为 128M，这就是我打开 phpinfo() 时显示的内容。我通过将“memory_limit=4096M”添加到 web 目录中的本地 php.ini 文件来更改它。

但是对于命令行脚本，全局 php.ini 文件决定了它们的 memory_limit。

# java - 不需要通过浏览器进行页面身份验证，但需要通过 HtmlUnit

> ID：15233450
> 
> 赞同：0
> 
> 时间：2013-03-05T20:29:18.067
> 
> 标签：java, htmlunit

我正在尝试访问来自 HtmlUnit 的页面[https://www-banner.aub.edu.lb/pls/weba/bwckschd.p_disp_dyn_sched](https://www-banner.aub.edu.lb/pls/weba/bwckschd.p_disp_dyn_sched)。当您从任何浏览器访问该页面时，该页面不需要任何身份验证，但是，当您通过代码访问它时，它会将我重定向到登录页面！有什么解释和解决办法吗？

这是我的代码：

```
 final WebClient webClient = new WebClient();

    // Get the first page
    final HtmlPage page1 = webClient.getPage("http://www-banner.aub.edu.lb/pls/weba/bwckschd.p_disp_dyn_sched");

    // Get the form that we are dealing with and within that form, 
    // find the submit button and the field that we want to change.

    final HtmlForm form=page1.getFirstByXPath("//form[@action='/pls/weba/bwckgens.p_proc_term_date']");

    final HtmlSubmitInput button = form.getInputByValue("Submit");
    final HtmlHiddenInput field = form.getInputByName("p_calling_proc");

    // Change the value of the text field
    field.setValueAttribute("201350");

    // Now submit the form by clicking the button and get back the second page.
    final HtmlPage page2 = button.click(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T04:26:23.737

可能是服务器不完全信任您的虚拟浏览器（webclient），因为 webclient 可能不提供所有标头信息。

如果您还没有这样做，您可能想看看[这个其他相关的问题。](https://stackoverflow.com/questions/5336280/why-doesnt-htmlunit-work-on-this-https-webpage)特别是，尝试启用不安全的 SSL。设置会话 cookie 可能是另一种可能的解决方案

# linux - 为什么当我注销时我的守护进程没有终止？

> ID：15233452
> 
> 赞同：1
> 
> 时间：2013-03-05T20:29:18.653
> 
> 标签：linux, posix, fork, daemon, setsid

我正在阅读有关 Linux 进程组和会话的信息。从[这个网站](http://www.informit.com/articles/article.aspx?p=397655&seqNum=6%20%22this%20site%22)我看到：

> 当用户退出系统时，内核需要终止用户运行的所有进程……为了简化这个任务，进程被组织成会话集。会话的 ID 与通过 setsid() 系统调用创建会话的进程的 pid 相同。该进程称为该会话组的会话负责人。然后，该进程的所有后代都是该会话的成员，除非他们专门从该会话中删除自己。setsid() 函数不接受任何参数并返回新的会话 ID。

这篇文章没有说的是操作系统何时决定终止用户的会话。我最初的假设是，当有人登录 TTY 时，TTY 是会话领导者，并且在该会话中调用的所有进程都属于它，除非他们调用`setsid()`. 然而，正如最简单的例子所证实的那样，这显然是错误的。考虑一下这个“守护进程”......（我知道它不是真正的守护进程，但它确实分叉）......

```
#include 
#include 
#include 
#include 

int main(void) {

  pid_t pid = fork();

  if(pid < 0) {
    perror("fork");
    exit(EXIT_FAILURE);
  }

  if(pid == 0) {
    FILE * heartbeat_file = fopen("daemon.out", "w");
    int hb = 0;
    while(1) {
      fprintf(heartbeat_file, "%d\n", hb);
      fflush(heartbeat_file);
      hb++;
      sleep(1);
    }
  } 
  exit(EXIT_SUCCESS);
} 
```

从代码中，我们看到子进程不断地写入文件，而父进程退出。请注意，我从不打电话给`setsid()`.

如果我登录，运行守护程序，然后注销，然后登录，守护程序仍在运行！我可以删除对的调用，`fork()`并且正如预期的那样，当我注销时该过程终止。谁能解释为什么 fork 导致我注销时应用程序不退出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:34:57.797

当你在让父进程退出的同时分叉时，你创建了一个孤儿进程（[http://en.wikipedia.org/wiki/Orphan_process](http://en.wikipedia.org/wiki/Orphan_process)）。这样的孤儿被重新设置为*init*进程。我会根据您观察到的情况假设重新育儿会修改会话的 ID。

测试这个假设的一个简单方法是让父母等待孩子（对不起，我现在不在我的 linux 机器上，不能这样做）。

# c# - 如何处理大型 WCF 响应？

> ID：15233453
> 
> 赞同：2
> 
> 时间：2013-03-05T20:29:24.067
> 
> 标签：c#, .net, wcf, c#-4.0

我们已经构建了 WCF 服务，设置为 SOAP 服务。它从数据库中读取数据，组装响应并将其返回给客户端。因为它从数据库中查询它需要的所有数据，在内存中组装整个响应并将其返回给客户端，所以如果数据量很大，可能会有很大的内存需求。

基本上，客户端从数据库中请求一条特定的记录，其中包含一个 blob，我们无法控制它的大小。我们预计数据的大小可能在 10k 到 3mb 左右。如果我们可以将数据从数据库中流式传输到 WCF 响应中，我们可以采用哪些技术，这样我们就不必一次将全部 3mb 加载到内存中？

**编辑：**
最初，我认为这可能是 [如何通过 WCF 处理大文件上传的副本？](https://stackoverflow.com/questions/1935040/how-to-handle-large-file-uploads-via-wcf)，但该解决方案需要使用 Stream 作为 OperationContract 中的参数。在我的情况下，虽然我需要我的请求参数是一个复杂的对象，这将反映在服务的结果 WSDL 中。

```
[ServiceContract]
public interface IFileUpload
{
    [OperationContract]
    bool UploadFile(Stream stream);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:43:16.537

Streaming Transfer Mode is the best way for Handling bigger Data with WCF. Look at this sample example in msdn to get started [WCF Stream Transfer mode](http://msdn.microsoft.com/en-us/library/ms789010.aspx)

Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:33:25.140

它必须同步吗？

我想你也看过这篇[文章](http://msdn.microsoft.com/en-us/library/ms733742.aspx)，如果没有？

我知道 WCF 对缓冲区大小很挑剔，所以你必须特别注意这一点

# c# - FileHelpers 在解析大型 csv 文件时抛出 OutOfMemoryException

> ID：15233454
> 
> 赞同：7
> 
> 时间：2013-03-05T20:29:29.667
> 
> 标签：c#, csv, filehelpers

我正在尝试使用 FileHelpers ( [http://www.filehelpers.net/](http://www.filehelpers.net/) ) 解析一个非常大的 csv 文件。该文件是 1GB 的压缩文件和大约 20GB 的解压缩文件。

```
 string fileName = @"c:\myfile.csv.gz";
        using (var fileStream = File.OpenRead(fileName))
        {
            using (GZipStream gzipStream = new GZipStream(fileStream, CompressionMode.Decompress, false))
            {
                using (TextReader textReader = new StreamReader(gzipStream))
                {
                    var engine = new FileHelperEngine<CSVItem>();
                    CSVItem[] items = engine.ReadStream(textReader);                        
                }
            }
        } 
```

FileHelpers 然后抛出 OutOfMemoryException。

> 测试失败：引发了“System.OutOfMemoryException”类型的异常。System.OutOfMemoryException：引发了“System.OutOfMemoryException”类型的异常。在 System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount) 在 System.Text.StringBuilder.Append(Char value, Int32 repeatCount) 在 System.Text.StringBuilder.Append(Char value) 在 FileHelpers.StringHelper.ExtractQuotedString(LineInfo line, Char quoteChar, Boolean allowMultiline) at FileHelpers.DelimitedField.ExtractFieldString(LineInfo line) at FileHelpers.FieldBase.ExtractValue(LineInfo line) at FileHelpers.RecordInfo.StringToRecord(LineInfo line) at FileHelpers.FileHelperEngine `1.ReadStream(TextReader reader, Int32 maxRecords, DataTable dt) at FileHelpers.FileHelperEngine`1.ReadStream(TextReader reader)

是否可以使用 FileHelpers 解析这么大的文件？如果没有，任何人都可以推荐一种解析这么大文件的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-05T21:52:00.610

您必须以这种方式逐条记录：

```
 string fileName = @"c:\myfile.csv.gz";
  using (var fileStream = File.OpenRead(fileName))
  {
      using (GZipStream gzipStream = new GZipStream(fileStream, CompressionMode.Decompress, false))
      {
          using (TextReader textReader = new StreamReader(gzipStream))
          {
            var engine = new FileHelperAsyncEngine<CSVItem>();
            using(engine.BeginReadStream(textReader))
            {
                foreach(var record in engine)
                {
                   // Work with each item
                }
            }
          }
      }
  } 
```

如果您使用这种异步方法，您一次只会使用内存记录一次，而且速度会更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:45:12.677

这不是一个完整的答案，但如果您有一个 20GB 的 csv 文件，则需要 20GB+ 才能一次将整个内容存储在内存中，除非您的阅读器将所有内容都压缩在内存中（不太可能）。您需要分块读取文件，如果您没有大量内存，您使用的将所有内容放入数组的解决方案将不起作用。

你需要一个更像这样的循环：

```
CsvReader reader = new CsvReader(filePath)
CSVItem item = reader.ReadNextItem();
while(item != null){
  DoWhatINeedWithCsvRow(item);
  item = reader.ReadNextItem();
} 
```

C# 的内存管理将足够智能，可以在您浏览旧的 CSVItems 时将其处理掉，前提是您不保留对它们的引用。

更好的版本会从 CSV 读取一个块（例如 10,000 行），处理所有这些，然后获取另一个块，或者如果您不关心处理顺序，则为 DoWhatINeedWithCsvRow 创建一个任务。

# c++ - stof() 和 stod() 精度

> ID：15233460
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:29:43.367
> 
> 标签：c++, floating-point

我正在解析一个带有一些数字的文件。我正在尝试将数字从字符串更改为浮点数或双精度数，但我发现 stof 和 stod 存在精度问题，它们在 VS C++ 中略有偏差。例如

```
string str1="3.14", str2="45.106";
double number1, number2;
number1=stod(str1);
number2=stof(str2); 
```

当我测试（number1==3.14）时，它返回“false”。当我查看调试器时，number1 实际上是 3.139999999 或类似的东西！number2 可能是 45.1060000002 或类似的东西。有什么解释或解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:34:09.950

你不妨看看这个例子：

[浮点数是如何存储的？什么时候重要？](https://stackoverflow.com/questions/56947/how-is-floating-point-stored-when-does-it-matter)

从中学到的是，在两个浮点数之间进行直接比较几乎从来都不是解决方案。您在浮点数中只有一定的精度，因此您可以期望的精度是有限的，这很好地放在了 Zeta 评论中的链接中。

# c# - 如何检查内存映射文件是否存在？

> ID：15233462
> 
> 赞同：9
> 
> 时间：2013-03-05T20:29:45.430
> 
> 标签：c#, .net, visual-studio-2010, ipc, memory-mapped-files

我需要一种方法来检查某个 MMF（内存映射文件）是否存在，然后再以托管方式访问它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T20:34:21.647

您可以使用：[MemoryMappedFile.OpenExisting](http://msdn.microsoft.com/en-us/library/vstudio/dd267590%28v=vs.100%29.aspx)方法。如果指定的文件不存在，它会引发[FileNotFoundException 。](http://msdn.microsoft.com/en-us/library/vstudio/system.io.filenotfoundexception%28v=vs.100%29.aspx)

# android - 如何在其他活动中使用数据库功能

> ID：15233463
> 
> 赞同：0
> 
> 时间：2013-03-05T20:29:53.880
> 
> 标签：android, database, function, android-activity

我正在尝试删除数据库中的行。在这里，我使用了一个我已经声明 DatabaseOpenHelper 的函数：

```
 public void deleteall(){
    SQLiteDatabase db = this.getWritableDatabase();
    String delete = "TRUNCATE FROM tweets";
    db.delete(SCORE_TABLE,null,null);
      } 
```

现在我正在使用“菜单”开始一项必须清除我的桌子的新活动。我正在尝试调用该功能，但它不起作用。这是使用的代码：

```
 public class ResetDatabase {

     public void main(String[] args) {
       DatabaseConnector db = new DatabaseConnector(this);
       db.deleteall();
     }

} 
```

但它给出了错误。他们建议我将 DatabaseConnector(Conetext) 更改为 DatabaseConnector(ResetDatabase) 但是我的其他函数会出错。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:34:11.200

您的数据库连接器在构造函数中使用 Context。您正在传递一个 ResetDatabase 对象，它不是一个上下文。所以你传递了错误的东西。而是传入一个 Context（例如您的 Activity 对象）。

# java - 多个复选框选项存储到数据库的单个字段中

> ID：15233466
> 
> 赞同：2
> 
> 时间：2013-03-05T20:30:08.330
> 
> 标签：java, html, mysql

我在 .jsp 中使用 HTML，在 servlet 中使用 Java 来处理 jsp。

我有一个技能表格，有 12 个复选框选项可供选择。显然可以选择多个，我希望将这些然后发送到数据库。（例如，Adam 可以拥有 Java 和 C++，而 Bob 只有 Java）。

我希望我的数据库中只有一个字段包含所有复选框的信息。目前，我将技能作为一个字符串`" "`将它们分开，但是当我尝试检索信息时，我没有得到正确的信息。例如，如果我使用“Java”搜索任何员工，我会返回 Bob 的详细信息，但不会返回 Adam 的详细信息，因为它是字符串“Java C++”的一部分，而不是单独的。

您对如何将多个复选框选项存储到数据库中的单个字段中，但可以分开以便于检索有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:12:34.867

正如 Jrod 指出的那样，使用[LIKE](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html#operator_like)关键字可能会满足您的需求。

但是，从长远来看，还有其他方法可能会更好。

**1-N 关系**

如果您将技能放在单独的表中，则可以将它们以一对多关系连接，这意味着您可以按技能查询，然后将相关人员加入查询。这将使您能够进行更复杂的查询，例如能够搜索多个匹配技能或条件匹配技能，但不能搜索其他技能。

**位标志**

正如您所说，它们是复选框，我假设您的技能受到限制（受复选框数量的限制），另一种方法是使用整数和使用位标志 - 例如：

*   爪哇 = 1
*   C++ = 2
*   Lisp` = 4
*   哈斯克尔 = 8
*   蟒蛇 = 16

将所有复选框的累积值相加并将其存储为整数将允许您使用[按位](http://dev.mysql.com/doc/refman/5.0/en/bit-functions.html)与 (&)查询数据库

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:55:24.553

尝试在准备好的语句中 使用`LIKE`运算符而不是`=`

```
PreparedStatement statement = con.prepareStatement ("SELECT * FROM servlet WHERE skill LIKE '%" + Skills + "%'AND year ='"+ Years+"'"); 
```

要基于两种技能进行选择，您可以链接类似的语句：

```
PreparedStatement statement = con.prepareStatement ("SELECT * FROM servlet WHERE skill LIKE '%" + Skill1 + "%'AND skill LIKE '%" + Skill2 + "%'AND year ='"+ Years+"'"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:24:25.703

你可以使用

```
 StringBuffer sql = new StringBuffer();
String skills[]=req.getParameterValues("skills");
sql.append("select * from skillRelation where ");

for(int i=0;i<skills.length;){
  sql.append(" skill like '%").append(skills[i]).append("%'");
  if(++i < skills.length) {
    sql.append(" and ");
  }
} 
```

# java - Java：查找 OutOfMemoryError 的原因

> ID：15233468
> 
> 赞同：3
> 
> 时间：2013-03-05T20:30:14.290
> 
> 标签：java, maven, out-of-memory, .bash-profile

我正在尝试在我的终端中构建一个 Java 应用程序（我正在使用 Eclipse，但终端只是为了查看它是否有效），并且我一直卡在这个消息中：

```
Exception: java.lang.OutOfMemoryError thrown from the UncaughtExceptionHandler in thread     "main" 
```

建议我将这行代码添加到我的 .profile 中（我有一个 .bash_profile，但没有 .profile），所以我做了：

```
MAVEN_OPTS="-XX:MaxPermSize=512m" 
```

但我仍然收到错误消息。这是我的 .bash_profile 文件的样子：

```
if [ -f ~/.bashrc ]; then
source ~/.bashrc
fi

MAVEN_OPTS="-XX:MaxPermSize=512m"

export JAVA_HOME=/usr/lib/jvm/java-7-oracle

export PATH=$PATH:/usr/local/mysql/bin

##
# Your previous /Users/tom.maxwell/.bash_profile file was backed up as   /Users/tom.maxwell/.bash_profile.macports-saved_2013-03-04_at_15:51:37
##

# MacPorts Installer addition on 2013-03-04_at_15:51:37: adding an appropriate PATH        variable for use with MacPorts.
export PATH=/opt/local/bin:/opt/local/sbin:$PATH
# Finished adapting your PATH environment variable for use with MacPorts.

##
@                                                                               
".bash_profile" 46L, 1730C 
```

我应该怎么办？我要运行的应用程序很大，而且我对 Java 不熟悉（我主要是 JS/CSS 人）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:56:02.557

你正在改变包含类和东西的 permgen 大小。

相反，您想更改最大内存，添加 `MAVEN_OPTS="-Xms512M -Xmx2048M"`

应该解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-12T05:15:12.107

我正在使用 Ubuntu 14.04，我遇到了类似的问题。对我有用的是将此行添加到 .bashrc

```
export MAVEN_OPTS="-Xmx756m -XX:MaxPermSize=2048m" 
```

之后，只需重新启动系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-06T07:38:20.810

将此参数作为参数添加到您的服务器参数中

-Xmx1024m -XX:MaxPermSize=512m -Xms512m

![在此处输入图像描述](../Images/682593ad6cb85493bbc2035b1487c666.png)

# java - 基于堆栈的数组上的 Java 垃圾收集

> ID：15233471
> 
> 赞同：11
> 
> 时间：2013-03-05T20:30:18.407
> 
> 标签：java, garbage-collection

假设我有以下代码：

```
public void process() {
    byte[] data = new byte[size]; 
    ... // code that uses the above data
    longProcess(); // a very long running process that does not use the data.
} 
```

假设程序中的其他任何地方都没有引用数据，那么 JVM 是否足够智能以允许在长进程仍在运行时对数据进行垃圾收集？

如果没有，将添加

```
data = null; 
```

在漫长的过程允许这种情况发生之前？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:40:13.427

这取决于JVM。我尝试过的 Oracle JVM 版本（1.6.0_41 和 1.7.0_09）默认情况下不执行此优化。但是，1.7.0_09 会在开启积极优化时执行它。

这是我进行的测试：

```
public class Main {
    public static int g() {
        int n = 100000;
        int arr[][] = new int[n][];
        for (int i = 0; i < n; ++i) {
            try {
                arr[i] = new int[100000];
            } catch (OutOfMemoryError ex) {
                return i;
            }
        }
        return -1;
    }
    public static void f1() {
        int arr[] = new int[1000000];
        System.out.println(g());
    }
    public static void f2() {
        int arr[] = new int[1000000];
        arr = null;
        System.out.println(g());
    }
    public static void main(String[] argv) {
        for (int j = 0; j < 2; ++j) {
            for (int i = 0; i < 10; ++i) {
                f1();
            }
            System.out.println("-----");
            for (int i = 0; i < 10; ++i) {
                f2();
            }
            System.out.println("-----");
        }
    }
} 
```

使用具有默认设置的 JVM 1.7，`f1()`在 3195 次迭代后始终耗尽内存，而`f2()`始终管理 3205 次迭代。

如果代码使用 Java 1.7.0_09 运行，图片会发生变化`-XX:+AggressiveOpts -XX:CompileThreshold=1`：两个版本都可以进行 3205 次迭代，表明 HotSpot 在这种情况下确实执行了这种优化。Java 1.6.0_41 似乎没有这样做。

在我的测试中，限制数组的范围与设置引用的效果相同`null`，如果您觉得应该帮助 JVM 尽快收集数组，这可能是首选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:39:21.743

鉴于编写的代码，数组肯定不会在 longprocess() 执行期间被垃圾收集，因为堆栈上仍然存在对数组的范围引用。一旦声明了该数组，在删除所有对它的引用之前，它将无法进行垃圾回收。你的线

```
data = null; 
```

将删除对它的一个引用，尽管根据您的处理代码，它可能不是唯一的引用。如果所有引用都已删除，那么垃圾收集器可能会在 longprocess() 返回时很好地收集该数组的内存，尽管这不能保证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:35:03.370

如果没有对数据的引用，那么 GC 将完成这项工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T20:48:03.080

只有在处理方法完成后，数据数组才会被释放内存。因此，如果您希望编译器释放内存，则必须在代码中显式添加 data = null。

垃圾收集器只释放没有有效引用的内存，并且没有其他方法可以再次指向该内存。

# database - codeigniter /数据库页面未加载

> ID：15233472
> 
> 赞同：0
> 
> 时间：2013-03-05T20:30:20.797
> 
> 标签：database, codeigniter, loading, pyrocms

我有一个数据库请求问题：网页根本没有加载。

```
 public function get_mylist($user_id){
        $this->db->select('*');
        $this->db->from($this->_table);
        $this->db->where('my', '1');
        $this->db->where('user1', $user_id);
        $this->db->or_where('user2', $user_id);
        $query = $this->db->get()->result_array();
        if($query!=NULL)
        {
            foreach($query as $row)
            {
            echo $row['user1'];
                if($row['user2'] != $user_id)
                {
                    $data[] = $row['user2'];
                }
                else if($row['user1'] != $user_id)
                {
                    $data[] = $row['user1'];
                }
            }
            return $data;
        }
        else return 0;
} 
```

你有什么主意吗 ？

编辑：在我的日志中我有致命错误：允许的内存大小字节用尽

所以我的循环一定是错误的：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T02:13:38.270

您需要考虑数据库表中有多少行以及每行有多少字节。

您的表中是否有足够的数据来达到 PHP 配置的内存限制？

此外，请检查您的 SQL 构造中的逻辑。

具体来说：

```
 $this->db->where('my', '1');
 $this->db->where('user1', $user_id);
 $this->db->or_where('user2', $user_id); 
```

该`where`条款被解释为：

```
WHERE (`my` = 1 AND `user1` = $user_id) OR (`user2` = $user_id) 
```

这是您想要的，还是您需要的：

```
WHERE `my` = 1 AND (`user1` = $user_id OR `user2` = $user_id) 
```

在 MySQL 中，`OR`优先于`AND`.

最后，作为测试，取出解析`$data`数组并返回`$row`数组并打印出来的代码，`print_r($row)`并确保您的查询提取出您期望的数据。

希望这些想法能帮助您诊断问题。祝你好运！

**注意：**要在 SQL 中实现替代逻辑，您可以执行以下操作：

```
 $this->db->where('my', '1');
 $this->db->where("(`user1` = $user_id OR `user2` = $user_id)"); 
```

注意双引号内部的左/右括号。

# android - Android 如何制作应用储物柜

> ID：15233473
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:30:26.100
> 
> 标签：android, passwords, password-protection

我是 Android 新手，所以如果这个问题被重复，请不要杀了我，但相信我，我搜索了很多，但找不到任何有用的答案。我的问题是如何为设备上安装的所有应用程序实现应用程序储物柜。我可以通过代码在我的应用程序上设置应用程序锁定，但也可以在其他已安装的应用程序上实现它。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:33:41.507

你不能。

不允许 Android 应用通过公共 SDK 控制或限制对其他应用的访问。

您可以半实现此目的的唯一方法是编写自己的自定义启动器，该启动器允许在应用程序上设置锁，这样您就可以在用户从应用程序列表启动应用程序时拦截并运行代码。但是，这种方法不会阻止用户通过使用最近的应用程序或安装另一个启动器绕过您的锁。

# vba - 以编程方式回复 Outlook 中的电子邮件

> ID：15233475
> 
> 赞同：0
> 
> 时间：2013-03-05T20:30:28.207
> 
> 标签：vba, outlook, outlook-2010

我正在编写一个脚本来回复每封收到的电子邮件。

我制定了一条规则，对运行脚本、设置类别并标记为已读的所有传入消息运行。该规则设置类别并标记为已读，但不运行脚本。下面是我的代码：

```
Sub reply(Item As Outlook.MailItem)

    MsgBox "Hey this script is running!"

    On Error GoTo ErrorTrap

    Dim MsgReply As Outlook.MailItem
    Set MsgReply = Item.reply
    With MsgReply
        .Subject = "Welcome to IT Business Builder"
        .HTMLBody = "This is just a test"
        .Body = "This is just a test"
        .Send
    End With
    Set MsgReply = Nothing
ErrorTrap:
    MsgBox Err.Number & " " & Err.Description & " message not sent because of error"

End Sub 
```

运行规则后，不弹出消息框，不发送电子邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-17T02:28:14.217

如果您的电子邮件每次都没有更改。您可以使用 Outlooks 内置的自动回复功能。它将给定的电子邮件发送给所有向您的电子邮件 ID 发送电子邮件的人。

[点击这里查看如何设置](http://www.extendoffice.com/documents/outlook/498-outlook-auto-reply.html)

快速总结...

1.  使用您要作为自动回复发送的主题和正文创建一条新消息。
2.  单击文件（在 Outlook 2007 中，单击 Office 按钮）> 另存为。
3.  在“另存为”对话框中，在“保存类型”下拉列表中选择“Outlook 模板”，然后单击“保存”按钮。
4.  直接关闭消息。如果您使用的是 Outlook 2010、2013 和 2016，请单击主页 > 规则 > 管理规则和警报。

对于 Outlook 2007，从 Outlook 窗口的菜单中单击工具 > 规则和警报...。看截图：

5.  在规则和警报对话框中，单击新建规则...
6.  在“规则向导”对话框中，选择“对我在 Outlook 2010 和 2013 中收到的邮件应用规则”。在 Outlook 2007 中，选择“从空白规则开始”选项和“收到邮件时检查邮件”选项，然后单击“下一步”按钮。
7.  在以下规则向导对话框中，选择 Outlook 2010 和 2013 中的仅发送给我，或在 Outlook 2007 的收件人框中选择我的姓名所在位置，然后单击下一步按钮。
8.  在 Select action(s) 下使用特定模板检查回复，然后在 Edit the rule description 框中单击特定模板。看截图：
9.  在“选择回复模板”对话框中，在“查找范围”下拉列表中选择“文件系统中的用户模板”，选择之前创建的模板，然后单击“打开”按钮。当它返回到上一个规则向导对话框时，单击下一步按钮。
10.  在下一个规则和向导对话框中，单击下一步按钮而不检查任何异常。
11.  在“为此规则指定名称”框中键入自动回复规则的名称，然后单击“完成”按钮。

如果您想对所有电子邮件帐户使用此规则，请选中在所有帐户上创建此规则框。

12.  现在它返回到规则和警报对话框，请单击确定按钮。现在自动回复规则已创建。

# ruby-on-rails - Rails：从不同的视图查询模型

> ID：15233476
> 
> 赞同：0
> 
> 时间：2013-03-05T20:30:41.067
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有 Post 和 SubCategory 模型，它们分别具有 belongs_to 和 has_many 关系。

在 Post 的 Show 视图中，除了显示单个 Post 之外，我还需要运行 SubCategory 控制器的 index 操作以在左侧 Nav 区域中显示当前 SubCategory 及其所有 Post。

解决这个问题的最佳方法是什么？

编辑我已经在使用应用程序控制器，所以我认为这是最好的方法，特别是如果我想在其他视图中做同样的事情。

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  before_filter :load_application_wide_varibales

  def load_application_wide_varibales

  def get_subcategory_and_post
    @sub_category = SubCategory.all
  end
end

class PostController < ActionController::Base
  before_filter :get_subcategory_and_post, only: [:show]

  def show
    @post = Post.find(params[:id])
    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @post }
  end
end

class SubCategoryController < ActionController::Base
    before_filter :get_subcategory_and_post
end

def current_user
  @current_user ||= User.find(session[:user_id]) if session[:user_id]
end
  helper_method :current_user
  end
end 
```

帖子显示视图

```
<% @sub_category.each do |subcat| %>
<div class="leftnav">
<h1 class="name"><%= subcat.name %></h1>
<% subcat.posts.each do |post| %>
<ul>
<li><%= link_to (post.name), post %></li>
</ul><% end %> 
</div>  

<% end %>
<div class="rightContent">
<p id="notice">
  <%= notice %>
</p>

<p>
  <b>Name:</b>
  <%= post.name %>
</p>

<p>
  <b>Content:</b>
  <%= post.content %>
</p>

</div> 
```

岗位型号：

```
class Post < ActiveRecord::Base
  belongs_to :sub_category
  belongs_to :users
  validates :name, :content, :sub_category_id, :presence => true
  attr_accessible :content, :name, :sub_category_id
  after_save    :expire_post_all_cache
  after_destroy :expire_post_all_cache

def self.to_csv(options = {})
  CSV.generate(options) do |csv|
    csv << column_names
    all.each do |post|
      csv << post.attributes.values_at(*column_names)
    end
  end
end

def self.all_cached
  Rails.cache.fetch('Post.all') { all }
end

def expire_post_all_cache
  Rails.cache.delete('Post.all')
 end
end 
```

子类别模型：

```
class SubCategory < ActiveRecord::Base
  attr_accessible :name
  belongs_to :category
  has_many :posts
  validates :name, :category_id, :presence => true
end 
```

工作岗位显示视图：

```
<div class="leftnav">
<h1 class="name"><%= @post.sub_category.name %></h1>
<% @post.sub_category.posts.each do |post|%> 
<ul> 
<li><%= link_to (post.name), post %></li> 
    </ul><% end %>  
    </div> 

<div class="rightContent"> 
<p id="notice"><%= notice %></p> 

<p>
  <b>Name:</b>  
  <%= @post.name %>
</p>

<p>  
  <b>Content:</b>
  <%= @post.content %>
</p> 
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:14:09.207

我会制作一个部分（类似于_subcategory_list），它采用子类别集合并呈现它们。然后您的 Post 视图可以调用`render(partial: 'subcategory/subcategory_list', locals: { subcategories: @post.subcategories })`并且您的 SubCategory 列表视图可以执行相同的操作，只是传入其 @subcategories 值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:16:07.920

```
redirect_to your_controller_action_url and return 
```

这将呈现另一个控制器动作。但是，这与控制器中逻辑的分离方式相反，通常被认为是一种不好的做法。

您最好的选择是将 SubCategory 控制器中的逻辑抽象为`ApplicationController`，然后 post 和 sub-category 控制器都可以使用它。

这是一个使用假方法的示例：

```
class ApplicationController < ActionController::Base
  def get_subcategory_and_post
    # Logic here
  end
end

class PostController < ActionController::Base
  before_filter :get_subcategory_and_post, only: [:show]

  def show
    # Logic here
  end
end

class SubCategoryController < ActionController::Base
  before_filter :get_subcategory_and_post
end 
```

# .net - ClickOnce 安装生成错误：System.Runtime.InteropServices.COMException，无法加载运行时，来自 HRESULT 的异常：0x80131700

> ID：15233477
> 
> 赞同：2
> 
> 时间：2013-03-05T20:30:47.143
> 
> 标签：.net, wpf, clickonce, failed-installation, comexception

尝试通过 ClickOnce部署[WPF项目时发生此错误：](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)

> [...file path...].application 的激活导致异常。检测到以下失败消息：无法加载运行时。（来自 HRESULT 的异常：0x80131700）

和

> System.Runtime.InteropServices.COMException - 加载运行时失败。（来自 HRESULT 的异常：0x80131700）-来源：System.Deployment。

直到最近，该项目以 32 位 .NET Framework 4 [Client Profile](http://msdn.microsoft.com/en-us/library/cc656912%28v=vs.110%29.aspx)为目标，并顺利安装在所有机器上。然后我们不得不切换到 .NET Framework 4 完整配置文件，因为我们开始包含[Crystal Reports](http://en.wikipedia.org/wiki/Crystal_Reports)，这不仅仅与客户端配置文件有关。

我们开始在客户端计算机上应用的 .NET Framework 4 完整配置文件安装程序针对 32 位和 64 位操作系统。但是，WPF 项目是专门为 32 位编译的，出于某种原因，我目前不记得了。部署应用程序的计算机运行 Windows 7 64 位企业版和 Service Pack 1。为了部署针对 .NET Framework 完整配置文件的新版本，我们首先在客户端计算机中安装了 Crystal Reports，还安装了 .NET Framework 4 完整配置文件那些只有客户端配置文件的机器，然后更新了 ClickOnce 安装程序供用户下载新应用程序。

首先要强调的是，WPF 应用程序的[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)更新在某些机器上运行顺利，而对于其他机器，它在下载安装文件之后和安装之前就中断了。我们无法确定是什么造成了差异。

关于异常 0x80131700，有几个论坛出版物和博客提到安装 .NET Framework 3.5 Service Pack 1。但是，显然，安装中断的机器和更新正常的机器都安装了它。此外，我们无法获得带有 SP1 安装程序的 .NET Framework 3.5 版本：引导程序只是挂起，而完整的包在解压缩安装文件时会引发“文件损坏”异常！还值得注意的是，WPF 应用程序还需要 Microsoft .NET Framework 4 平台更新 1 - 运行时更新 (KB2478063)，但自几个月前的第一个版本以来就是这种情况，我们对此没有问题前。

我们浏览了许多关于“System.Runtime.InteropServices.COMException”异常以及“加载运行时失败（HRESULT 异常：0x80131700）”异常的论坛和博客文章。但是到目前为止，我们还不能确定是什么让我们的应用程序的最新版本可以完美地安装在某些机器上，而我们在其他机器上得到上述行为，在一个显然所有机器都属于的环境中公司网络，共享几乎相同的配置。

而且我们也无法解决问题。

我现在将发布在尝试将我们的 WPF 应用程序安装在无法工作的机器上时生成的完整错误日志（它是西班牙语，抱歉）：

```
INFORMACIÓN DE VERSIÓN DE LA PLATAFORMA
  Windows                : 6.1.7601.65536 (Win32NT)
  Common Language Runtime: 4.0.30319.296
  System.Deployment.dll  : 4.0.30319.1 (RTMRel.030319-0100)
  clr.dll                : 4.0.30319.296 (RTMGDR.030319-2900)
  dfdll.dll              : 4.0.30319.1 (RTMRel.030319-0100)
  dfshim.dll             : 4.0.31106.0 (Main.031106-0000)

ORÍGENES
  Dirección URL de la implementación: file:///C:/Users/cacortes/Desktop/IntegraSF.appref-ms%7C
  Dirección URL del proveedor de la implementación:
    file://consarteam/IntegraSF_Produccion/IntegraSF_Aplicaci%C3%B3nCliente.application
  Dirección URL de la aplicación:
    file://consarteam/IntegraSF_Produccion/Application%20Files/IntegraSF_Aplicaci%C3%B3nCliente_1_0_0_34/IntegraSF_Aplicaci%C3%B3nCliente.exe.manifest

IDENTIDADES
  Identidad de la aplicación: IntegraSF_AplicaciónCliente.exe, Version=1.0.0.34, Culture=neutral,
    PublicKeyToken=4e797c2fd9dcb050, processorArchitecture=x86, type=win32

RESUMEN DEL ERROR
  Abajo se muestra un resumen de los errores; los detalles de estos errores se incluyen en el registro.
  * La activación de C:\Users\cacortes\Desktop\IntegraSF.appref-ms| dio como resultado una excepción. Se detectaron los siguientes mensajes de error:
      + Error al cargar el tiempo de ejecución. (Excepción de HRESULT: 0x80131700)

RESUMEN DE ERRORES DE TRANSACCIÓN DEL ALMACÉN DE COMPONENTES
  No se detectó ningún error de transacción.

ADVERTENCIAS
  No se generó ninguna advertencia durante esta operación.

ESTADO DE PROGRESO DE LA OPERACIÓN
  * [04/03/2013 02:04:57 p.m.]: Se ha iniciado la activación de C:\Users\cacortes\Desktop\IntegraSF.appref-ms|.
  * [04/03/2013 02:04:57 p.m.]: Realizando la comprobación de actualización necesaria según las especificaciones de la implementación.
  * [04/03/2013 02:04:57 p.m.]: Consumiendo nueva actualización.
  * [04/03/2013 02:05:00 p.m.]: Se ha iniciado la instalación de la aplicación.
  * [04/03/2013 02:05:00 p.m.]: Ha finalizado correctamente el procesamiento del manifiesto de la aplicación.
  * [04/03/2013 02:05:00 p.m.]: Se ha encontrado una versión del motor en tiempo de ejecución compatible 4.0.30319.
  * [04/03/2013 02:05:00 p.m.]: Detectando ensamblado independiente CrystalDecisions.ReportAppServer.CommonObjectModel,
Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
  processorArchitecture=msil utilizando
  CrystalDecisions.ReportAppServer.CommonObjectModel,
  Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304,
  processorArchitecture=msil.

* [04/03/2013 02:05:00 p.m.] : Detectando ensamblado independiente stdole, Version=7.0.3300.0, Culture=neutral,
    PublicKeyToken=B03F5F7F11D50A3A utilizando stdole, Version=7.0.3300.0,
    Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a.

* [04/03/2013 02:05:00 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.DataDefModel,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.DataDefModel, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:00 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.ObjectFactory,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.ObjectFactory, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:00 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.ReportDefModel,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.ReportDefModel, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:00 p.m.] : Detectando ensamblado independiente CrystalDecisions.Shared, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando CrystalDecisions.Shared,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.CubeDefModel,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.CubeDefModel, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente SAPBusinessObjects.WPF.ViewerShared,
    Version=13.0.3500.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    SAPBusinessObjects.WPF.ViewerShared, Version=13.0.3500.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.CommLayer,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.CommLayer, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.ClientDoc,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.ClientDoc, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente FlashControlV71, Version=1.0.3187.32366,
    Culture=neutral, PublicKeyToken=692FBEA5521E1304 utilizando
    FlashControlV71, Version=1.0.3187.32366, Culture=neutral,
    PublicKeyToken=692fbea5521e1304.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente SAPBusinessObjects.WPF.Viewer, Version=13.0.3500.0,
    Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando SAPBusinessObjects.WPF.Viewer,
    Version=13.0.3500.0, Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.Prompting,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.Prompting, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.XmlSerialize,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.XmlSerialize, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.CommonControls,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.CommonControls, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente log4net, Version=1.2.10.0, Culture=neutral,
    PublicKeyToken=692FBEA5521E1304, processorArchitecture=x86 utilizando
    log4net, Version=1.2.10.0, Culture=neutral,
    PublicKeyToken=692fbea5521e1304, processorArchitecture=x86.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportSource, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando CrystalDecisions.ReportSource,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.Controllers,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.Controllers, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.ReportAppServer.DataSetConversion,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.ReportAppServer.DataSetConversion,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:01 p.m.] : Detectando ensamblado independiente CrystalDecisions.CrystalReports.Engine,
    Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304,
    processorArchitecture=msil utilizando
    CrystalDecisions.CrystalReports.Engine, Version=13.0.2000.0,
    Culture=neutral, PublicKeyToken=692fbea5521e1304,
    processorArchitecture=msil.

* [04/03/2013 02:05:02 p.m.] : Detectando ensamblado independiente ShockwaveFlashObjects, Version=1.0.0.0, Culture=neutral,
    PublicKeyToken=692FBEA5521E1304 utilizando ShockwaveFlashObjects,
    Version=1.0.0.0, Culture=neutral, PublicKeyToken=692fbea5521e1304.

                * [04/03/2013 02:05:02 p.m.] : Ha finalizado la solicitud de confianza y detección de plataforma.
                * [04/03/2013 02:05:05 p.m.] : Finalizó la descarga de las dependencias de la suscripción.
                * [04/03/2013 02:05:05 p.m.] : Se ha iniciado la confirmación de la aplicación descargada.

DETALLES DEL ERROR
  Se detectaron los siguientes errores durante esta operación.
  * [04/03/2013 02:05:06 p.m.] System.Runtime.InteropServices.COMException
                 - Error al cargar el tiempo de ejecución. (Excepción de HRESULT: 0x80131700)
                 - Origen: System.Deployment
                 - Seguimiento de la pila:
       en System.Deployment.Application.NativeMethods.GetRequestedRuntimeInfo(String
         pExe, String pwszVersion, String pConfigurationFile, UInt32
         startupFlags, UInt32 runtimeInfoFlags, StringBuilder pDirectory,
         UInt32 dwDirectory, UInt32& dwDirectoryLength, StringBuilder pVersion,
         UInt32 cchBuffer, UInt32& dwLength)

en System.Deployment.Application.Win32InterOp.SystemUtils.CheckSupportedImageAndCLRVersions(String path)
en System.Deployment.Application.SubscriptionStore.CheckApplicationPayload(CommitApplicationParams commitParams)
en System.Deployment.Application.SubscriptionStore.CommitApplication(SubscriptionState&subState, CommitApplicationParams commitParams)
en System.Deployment.Application.ApplicationActivator.InstallApplication(SubscriptionState&subState, ActivationDescription actDesc)
en System.Deployment.Application.ApplicationActivator.ConsumeUpdatedDeployment(SubscriptionState&subState, ActivationDescription actDesc)
en System.Deployment.Application.ApplicationActivator.PerformDeploymentUpdate(SubscriptionState&subState, String& errorPageUrl)
en System.Deployment.Application.ApplicationActivator.ProcessOrFollowShortcut(String shortcutFile, String& errorPageUrl, TempFile& deployFile)
en System.Deployment.Application.ApplicationActivator.PerformDeploymentActivation(UriactivationUri, Boolean isShortcut, String textualSubId, String deploymentProviderUrlFromExtension, BrowserSettings browserSettings, String& errorPageUrl)
en System.Deployment.Application.ApplicationActivator.ActivateDeploymentWorker(Object state)

DETALLES DE TRANSACCIÓN DEL ALMACÉN DE COMPONENTES
  No hay información disponible sobre la transacción. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:58:50.583

我们已经解决了这个问题，在我们拥有的时间框架内满足了我们的需求。对于有兴趣了解我们所做工作的任何人：在为 .NET 32 位安装 Crystal Reports 运行时后，我们最终卸载了 .NET 4 框架：客户端和完整配置文件；以相同的顺序重新安装它们，然后重新安装 KB2478063。重新安装 .NET 框架后，我们还安装了 Microsoft 推荐的适用更新。这对我们有用。但是，我也收到了来自 Microsoft MVP 的回复，我与您分享：[链接](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/9c3b67db-8ba5-43bd-8bf3-e7e152fed85c/?prof=required)。

# ruby - 如何创建多行正则表达式？

> ID：15233480
> 
> 赞同：2
> 
> 时间：2013-03-05T20:30:49.340
> 
> 标签：ruby, regex

我正在尝试匹配块中的所有文本：

```
group :development do
  gem 'test'
end 
```

在上面的上下文中，我想返回`"gem 'test'"`. 我正在使用的是：

```
/(?<=group :development do)(.*)(?=end)/m 
```

为什么它不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:38:26.170

我不完全确定为什么，但更改`.*`为`.*?`允许它匹配。

rubular：[http ://www.rubular.com/r/GaQj6cM0rk](http://www.rubular.com/r/GaQj6cM0rk)

看起来它也应该匹配`.*`得很好，但由于某种原因，它似乎没有回溯。

以下是使用 Rubular 时`.*`：[http ://www.rubular.com/r/jKf0bDZi7T](http://www.rubular.com/r/jKf0bDZi7T)

请注意，无论这种行为的原因是什么，您都应该使用`.*?`，否则您只会找到从第一个块的开头到最后一个块的结尾的单个匹配项（如果字符串中有多个块）。

# javascript - 是否有 JavaScript Image 对象的规范？

> ID：15233483
> 
> 赞同：13
> 
> 时间：2013-03-05T20:30:57.860
> 
> 标签：javascript

我仍在学习 JavaScript 的技巧，有人`Image`向我指出了这个对象。从来没有听说过它，我很想查看它应该做什么的规格。这让我意识到我不知道在哪里可以找到 JavaScript 的规范！

谁能指出我接受的 JavaScript 规范是什么？它只是[http://www.ecma-international.org/publications/standards/Ecma-262.htm](http://www.ecma-international.org/publications/standards/Ecma-262.htm)上的 ECMA 标准吗？如果是这样，我在那里搜索了“图像”这个词，但没有找到任何有用的东西。

# git - 将 TeamCity 与适用于 Windows 的 GitHub 结合使用

> ID：15233486
> 
> 赞同：1
> 
> 时间：2013-03-05T20:31:02.107
> 
> 标签：git, github, build-automation, teamcity-7.0

我正在使用 TeamCity 7.1，在我的 Windows 开发机器上运行它。我有一个团队使用 GitHub for Windows。我正在做一个持续集成的演示。我想教其他人如何设置 TeamCity 以使用 GitHub 帐户。他们必须做的配置越少越好。

TeamCity 要求提供 git 可执行文件的路径和 ssh 密钥。我在我的 Ubuntu 机器上做了很多次，没问题，但从来没有在 Windows 机器上。如果我可以仅出于演示目的重用 GitHub for Windows 命令行及其私钥存储，那就太好了。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T09:44:45.847

“GithHub for Windows”的 git.exe 位于：

```
C:\Users\<user>\AppData\Local\GitHub\PortableGit_{hash}\bin\git.exe 
```

似乎路径中的**哈希**在不同的系统上是不同的。

默认情况下，Github for Windows 通过 HTTPS 克隆 github 存储库。仅出于演示目的，在Teamcity 构建的**VCS 根设置中，您可以使用 Github 存储库的 https url 并在“****身份验证设置**”部分中选择“**密码**”作为“**身份验证方法**” 。

 **如果您使用“代理端结帐”，则仅当您拥有**Teamcity 7.1.2+**和**git 版本 1.7.3+**时才支持使用“密码”作为身份验证方法。请参阅[Git VCS 设置 Teamcity](http://confluence.jetbrains.com/display/TCD7/Git+%28JetBrains%29)和 Teamcity 问题[TW-18711](http://youtrack.jetbrains.com/issue/TW-18711)。**

# mysql - Sakila db SQL 查找租借>10部恐怖片的客户

> ID：15233489
> 
> 赞同：0
> 
> 时间：2013-03-05T20:31:05.637
> 
> 标签：mysql

我完全被我的家庭作业困住了。我正在使用 Sakila 示例数据库。我应该写一个查询，它会给我一个所有租借了超过 10 部恐怖电影的客户的列表。这是我到目前为止所拥有的：

```
select CONCAT(c.first_name, " ", c.last_name) AS "Customer name", 
FROM customer AS c

INNER JOIN rental AS r
ON c.customer_id = r.customer_id

inner join  inventory as i
on i.inventory_id = r.inventory_id

inner join  film_category as fc
on i.film_id = fc.film_id
 inner join 
(select * from category as ca
where ca.name = 'horror') as h
 on h.category_id = fc.category_id 
 ; 
```

我可以让它返回**所有**（846）个租了恐怖电影的客户，但是我如何只获得那些租了 10 多部恐怖电影的客户呢？我知道我需要 COUNT 函数，但是当我把它放进去时，它给了我 1 个人，计数为 846，这是人数，而不是租借的恐怖电影。在这一点上，我的逻辑只是让我失望。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:54:36.830

不幸的是，我不知道有问题的示例数据库，但是我觉得答案不会影响我的回答。

如果您想使用 COUNT，您还需要使用[GROUP BY](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)来实现聚合计数。

您还可以查看带有[HAVING](http://www.google.co.uk/url?sa=t&rct=j&q=mysql%20having&source=web&cd=1&cad=rja&ved=0CC8QFjAA&url=http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html&ei=VVs2UeraL8KYPceJgZgF&usg=AFQjCNFA7IECBXCwroBX9IcLvCxeD76e-A)子句的[GOUP BY 。](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-05T20:26:12.197

如果有人需要便餐：

```
SELECT R.customer_id, COUNT(*) AS cnt 
FROM sakila.rental R LEFT JOIN sakila.inventory I ON R.inventory_id = I.inventory_id 
LEFT JOIN sakila.film F ON I.film_id = F.film_id 
LEFT JOIN sakila.film_category FC on F.film_id = FC.film_id 
LEFT JOIN sakila.category C ON FC.category_id = C.category_id 
WHERE C.name = "Horror" 
GROUP BY R.customer_id HAVING cnt > 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-26T11:23:24.380

您也可以编写没有左连接/内连接的查询。请注意，没有任何客户拥有超过 10 次恐怖租赁，因此空白结果不应让您感到困惑（尝试 2 并且它有效！）

```
SELECT cu.first_name, cu.last_name, COUNT(r.rental_id) as horror_film_count
FROM customer AS cu, rental AS r, inventory as i, film as f, category as ca, 
film_category as fc
WHERE cu.customer_id = r.customer_id 
AND r.inventory_id = i.inventory_id
AND i.film_id = f.film_id
AND f.film_id = fc.film_id
AND fc.category_id = ca.category_id
AND ca.category_id = 11
GROUP BY cu.customer_id
HAVING horror_film_count > 10 
```

# javascript - Javascript：如何从文本框中创建选择列表选项？

> ID：15233494
> 
> 赞同：0
> 
> 时间：2013-03-05T20:31:14.227
> 
> 标签：javascript, html, textbox

如何让我的选择列表填充来自用户输入的新选项？

到目前为止，这是我的 JS：

```
<script type="text/javascript">
function show_prompt() {
    var name = prompt('Please enter new origin');
    if (name != null && name != "") {
      var select = document.getElementById("OriginSelect");
      select.options[select.options.length] = new Option('Text 1', 'Value1');
    }
} 
```

这是正文下方的 HTML\Coldfusion：

```
<p class="_30NP" align="right">
                                <label>Origin&nbsp;</label>
                            </p>

                            <p class="_20NP">
                              <cfselect  name="OriginSelect" id="OriginSelect" query="Origin" display="description" value="code"  required="yes">
                              <option id="new" value="new" onClick="show_prompt()">New Origin</option>
                              </cfselect>
                            </p>

                            <a href="#" onClick="show_prompt()">New Origin</a> 
```

所以基本上，列表是从数据库中填充的，但是当没有合适的 Origin 可用时，用户可以单击 href 并出现一个带有文本字段的提示框（这很好用）。然后用户可以输入他喜欢的任何内容，然后 JS 脚本将新元素添加到标签中。

但是，在用户输入文本并执行“确定”时点击“确定”后，它不会执行任何操作。Chrome 中的 javascript 调试器也没有显示任何有用的信息，也没有标记任何错误或任何内容。

它是一个 cfselect 的事实是一个问题吗？我自己手动添加了一个选项（id="new"），它显示得很好。

编辑：好的，这不是 cfselect 的错。我把它变成了一个普通的选择框，它仍然不起作用..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:49:58.357

使用`appendChild`功能

```
function show_prompt() {
    var name = prompt('Please enter new origin');
    if (name != null && name != "") {
      var select = document.getElementById("OriginSelect");
      var option = new Option(name);
      select.appendChild(option);
    }
} 
```

# jboss7.x - java 在 JBoss 7 上为 fedlet 过滤 IllegalStateException 或无限循环

> ID：15233499
> 
> 赞同：1
> 
> 时间：2013-03-05T20:31:32.570
> 
> 标签：jboss7.x, single-sign-on, servlet-filters, illegalstateexception

我被困在一个 servlet 过滤器问题上，希望有人能帮助我。我拥有的是我在 JBoss 7.1.1 上运行的 servlet 过滤器（它是一个 SSO Fedlet）

这是一个简单的“Hello World”应用程序，我只是想在点击仅包含“Hello World”的 index.jsp 之前测试它以使 SSO 工作。

在我的 doFilter 方法中，我进入了一个 handleSSO 调用，然后在返回时，它调用了 chain.doFilter(req,res);

```
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)    throws IOException, ServletException {

    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;

    handleSSO(request, response); //logs in user etc..
     chain.doFilter(req, res);

}
private void handleSSO(HttpServletRequest request, HttpServletResponse response) {
    //login code here where the initiateAuthnRequest occurs for the IdP
    //if successful then do this:
    response.sendRedirect(getRedirectURL(request)); //this is /HelloWorld/
} 
```

所以发生的事情是在调用 sendRedirect 之后，它返回到 doFilter 并调用 chain.doFilter。
然后我得到一个 IllegalStateException。闲逛我读到你不能同时执行 sendRedirect 和 chain.doFilter。因此，我在 chain.doFilter 周围放置了一些逻辑，并且仅在未发生重定向时才调用它。但是，当这种情况发生时，我会在 doFilter 中得到一个无限循环。好像它在一遍又一遍地重新验证......

所以我认为我的 web.xml 需要 tweeking。这是它的样子：

```
<filter>
<filter-name>SamlFilter</filter-name>
     <filter-class>com.gsk.servlet.filters.SAMLFilter</filter-class>
</filter>
<filter-mapping>
<filter-name>SamlFilter</filter-name>
     <url-pattern>/*</url-pattern>
 </filter-mapping> 
```

所以我的想法是，因为 url 模式是 /* 它将继续尝试进行身份验证。为了测试这一点，我将 url 模式更改为 /HelloWorld/。但是，当我这样做时，我永远不会进入过滤器代码并且 index.jsp 页面会显示。

我不知道解决方案可能是什么。
如果有人有任何想法，那就太好了。FWIW，所有这些代码在 Jboss 5 上运行良好，所以我不知道这是否是 JBoss 问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-05T06:56:43.143

您应该重定向或调用过滤器链：

```
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {

    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;

    if(needsRedirect(request)){
        handleSSO(request, response); //logs in user etc..
    }else{
        chain.doFilter(req, res);
    }
} 
```

# javascript - 从 href 调用 java 脚本方法

> ID：15233502
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:31:46.137
> 
> 标签：javascript

我在我的一个javascript函数中声明了这个变量file_link，我想从这个变量中调用get_links方法，请帮助我正确的语法。

```
var filelink = "<a href='javascript:get_links(" + source_id + ")'>" + name + "</a>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:41:49.807

如果要运行函数 get_links 并将结果放入 filelink 变量中：

```
var filelink = get_links(source_id); 
```

如果不是这种情况，请尝试提供有关您要做什么的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:20:07.287

评论太长了。但是您应该使用 DOM 方法构建链接。我还添加了一个事件监听器的快速示例（不确定这是否是您所追求的，至少您可能不想扩展使用的选择器）。

```
(function() {
  document.addEventListener('click', function(e) {
    if (e.target.tagName !== 'A') return;

    e.preventDefault();
    e.stopPropagation();

    alert(e.target.getAttribute('data-source-id'));
  });

  var name = 'somename',
      source_id = '1';

  var filelink = document.createElement('a');
  filelink.setAttribute('href', '#');
  filelink.setAttribute('data-source-id', source_id);
  filelink.appendChild(document.createTextNode(name));

  document.getElementsByTagName('body')[0].appendChild(filelink);
}()); 
```

演示：[http ://codepen.io/anon/pen/smvBG](http://codepen.io/anon/pen/smvBG)

# java - 使用 iText 2.1.7 检查时间戳

> ID：15233508
> 
> 赞同：1
> 
> 时间：2013-03-05T20:32:17.490
> 
> 标签：java, itext, digital-signature, trusted-timestamp

我正在尝试检查 PDF 文件的给定签名是否存在时间戳。到目前为止，我来到了这段代码：

```
RandomAccessFileOrArray random = 
    new RandomAccessFileOrArray(new File("temp.pdf").getAbsolutePath());

PdfReader reader = new PdfReader(random, null);
AcroFields af = reader.getAcroFields();
ArrayList<?> names = af.getSignatureNames();

//this are the signatures?
for (Object o : names){

    AcroFields.Item item = (Item) af.getFields().get((String)o);

    //this is the class for verifying the signature, 
    //how do I get it from the item?
    PdfPKCS7 pdfPKCS7 = null; //XYZ ??? 

    Calendar signingDate = pdfPKCS7.getTimeStampDate();
} 
```

我显然可以访问签名，但我应该使用 PdfPKCS7 类来验证签名。有谁知道我怎样才能到达那里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T11:18:05.800

您应该使用返回对象的`AcroFields`方法来继续验证。`verifySignature(String name)``PdfPKCS7`

该方法的 JavaDocs 显示了它的使用示例：

```
KeyStore kall = PdfPKCS7.loadCacertsKeyStore();
PdfReader reader = new PdfReader("my_signed_doc.pdf");
AcroFields af = reader.getAcroFields();
ArrayList names = af.getSignatureNames();
for (int k = 0; k < names.size(); ++k) {
    String name = (String)names.get(k);
    System.out.println("Signature name: " + name);
    System.out.println("Signature covers whole document: " + af.signatureCoversWholeDocument(name));
    PdfPKCS7 pk = af.verifySignature(name);
    Calendar cal = pk.getSignDate();
    Certificate pkc[] = pk.getCertificates();
    System.out.println("Subject: " + PdfPKCS7.getSubjectFields(pk.getSigningCertificate()));
    System.out.println("Document modified: " + !pk.verify());
    Object fails[] = PdfPKCS7.verifyCertificates(pkc, kall, null, cal);
    if (fails == null)
        System.out.println("Certificates verified against the KeyStore");
    else
        System.out.println("Certificate failed: " + fails[1]);
} 
```

`PdfPKCS7`在这里，您可以使用实例轻松添加其他代码。

Ceterum censeo... 除非您绑定到那个古老的 iText 版本（例如由于兼容性或许可问题），否则您应该考虑更新到当前版本。

# perl - 使用 sphinx 的 Perl 文档

> ID：15233510
> 
> 赞同：4
> 
> 时间：2013-03-05T20:32:28.873
> 
> 标签：perl, python-sphinx

如何使用 sphinx（它非常适合自动记录 python 代码）来记录 perl 代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:34:50.443

Perl 代码应该用[POD](http://perldoc.perl.org/perlpod.html)记录，这是自然的方式，并且在这个环境中得到支持。它简单而强大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:35:51.647

尝试[使用 Sphinx 记录您的项目](http://pythonhosted.org/an_example_pypi_project/sphinx.html)

或者

[You Tube](http://www.youtube.com/watch?v=LQ6pFgQXQ0Q)上的一段视频

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-17T09:12:41.370

Sphinx 是非常特定于 Python 的 AFAIK，但是有人正在努力实现 Javascript 集成：[https](https://github.com/erikrose/sphinx-js) ://github.com/erikrose/sphinx-js - 这意味着它对于 Perl 是可行的，但可能并不容易。

评估 Perl 的子程序签名可能会很有趣，请查看 brian d foy 的博客文章：[https ://www.effectiveperlprogramming.com/2015/04/use-v5-20-subroutine-signatures/](https://www.effectiveperlprogramming.com/2015/04/use-v5-20-subroutine-signatures/)

# php - 我应该使用 MongoId 对象来识别子文档吗？

> ID：15233520
> 
> 赞同：1
> 
> 时间：2013-03-05T20:33:01.383
> 
> 标签：php, mongodb

我有这样的架构设置：

```
{
 "_id": ObjectId("5130ea935b51eafc13000032"),
 "items": [
           {
             "id": ???,
             "title": "yes"
           },
           {
             "id": ???,
             "title": "no"
           }
          ]
 } 
```

在整个集合中为所有子文档分配唯一 ID 的最佳方法是什么？

我应该使用**MongoId()**对象吗？PHP 的**uniqid()**函数？一个简单的**增量**？... 为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:57:34.760

嗯，这是一个常见的问题，但仍然是一个关于 ID 的棘手问题。

首先，如果您有嵌入的文档列表，请检查您的主题区域。这些对象是否具有自然 ID（例如书籍具有 ISBN 编号等）？如果是 - 您可以轻松地将其标记为 ID，这对您在代码中会更有帮助。将更容易看到数据——应用程序绑定。

如果子对象没有自然 id，您最好使用 MongoId 对象 - 它已经实现，您不必考虑生成新的唯一 id（即使它是增量）和手动将该 id 设置为新对象。

希望有帮助。祝你好运。

# lisp - Lisp 参数指针

> ID：15233522
> 
> 赞同：4
> 
> 时间：2013-03-05T20:33:07.093
> 
> 标签：lisp, common-lisp

我正在学习 lisp，我必须从 Lisp 中的函数返回修改后的输入参数。

**考虑这个简单的例子：**

```
(defun swap (l1 l2)
  (let ((temp))
    (setf temp l1)
    (setf l1 l2)
    (setf l2 temp)))

(setf a (list 1 2 3))
(setf b (list 7 8 9))
(swap a b)
(print a)
(print b) 
```

它不起作用，因为我不知道如何将对变量的引用传递给函数。这在lisp中甚至可能吗？**这个功能怎么解决？**

* * *

**更新**

```
;;; doesn't change original
(defun foo1 (x)
  (setf x (list 0 0 0)))

;;; but this does
(defun foo4 (x)
  (setf (car x) 0)
  (setf (cdr x) (list 0 0))) 
```

我想通过引用传递变量以便能够更改它的原因是，当我有带有 3 个输入参数的函数并且该函数应该更改所有参数时，我认为通过引用更改它们更优雅，然后返回三个变量的列表，然后用它们覆盖原始变量：

```
;;; more elegant function
(defun foo (x y z)
  ;;... some work ...

  ;; Lets PRETEND this does work
  (setf x new-x)
  (setf y new-y)
  (setf z new-z))

; after this, a,b,c will have new values
(foo a b c)

;;; less elegant function
(defun foo (x y z)
  ;; ... some work ...
  (list new-x new-y new-z))

; after this, I still will have to manually set a,b,c
(setf temp (foo a b c))
(setf a (nth 0 tmp))
(setf b (nth 1 tmp))
(setf c (nth 2 tmp)) 
```

为了解释我为什么要做到这一点，我得到了河内塔的作业。我正在考虑使用三个列表作为`stacks`并在它们上使用`pop`和`push`函数来插入和删除“光盘”。我定义`(move n source target temp)`了函数，它通过`n-1`变化递归地调用自己。问题是，当我`pop`或`push`堆栈在递归函数中时，它不会影响外部堆栈。如果我希望我的`move`函数在移动后返回堆栈`n`，我真的应该返回新堆栈列表（那个*不太优雅的函数*）而不是通过引用编辑它们（那个*更优雅的函数*）

*函数式语言*的正确方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T22:49:20.570

首先，如果您正在学习函数式编程或一般的 Lisp，而不仅仅是 Common Lisp，**请不要这样做**。不要尝试编写修改状态的函数——这不是函数式编程的工作方式。如果您需要交换 2 个值的函数，只需编写以相反顺序返回它们的函数。

如果您仍然对交换 2 个值感兴趣，请参阅这个[类似的问题](https://stackoverflow.com/questions/1249991/variable-references-in-lisp)以获得一些非常好的建议。最重要的是宏和手动引用（实际值的包装器）。

但是，这些答案不包括一个重要概念，仅在 Common Lisp 中可用，而在大多数其他 Lisp 方言中不可用**-places**。但首先让我们回顾一下将变量传递给函数的两种方法。考虑以下 C++ 示例：

```
void f(int x) {
    ...
}
int a = 5;
f(a); 
```

这被称为“按值传递”策略： 的值`a`被*复制*到参数`x`。而且由于`x`只是一个副本，如果您在 内部修改它`f()`，原始变量不会发生任何事情`a`。

但是，在 C++ 中，您还可以执行以下操作：

```
void f(int& x) {    
    ...
}
int a = 5; 
f(a); 
```

这种策略称为“按引用传递” - 在这里您将指针传递到*内存*中`a`所在的位置。因此`x`和`a`指向同一块内存，如果你修改`x`，`a`也会改变。

包括 Common Lisp 在内的函数式语言不允许您通过引用将变量传递给函数。那么如何`setf`运作呢？事实证明，CL 具有定义内存中位置的位置概念[**（**](http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_p.htm#place)有时也称为“位置”）。`setf`（扩展为`set`特殊形式的宏）*直接与 places*而*不是 values*一起使用。

总结一下：

1.  Common Lisp 和大多数 Lisp 一样，只允许**通过 value****传递**变量来运行。
***   Lisp 有地点的**概念**——内存中的位置。*   `setf`直接与地点一起工作，可用于变异变量。宏可用于克服功能的限制。**

 **请注意，CL 中的一些内置函数可以*返回位置*，例如`car`, `cdr`，`aref`以及所有对象访问器。有关一些示例，请参阅[此](http://www.n-a-n-o.com/lisp/cmucl-tutorials/LISP-tutorial-16.html)页面。

**更新**

您的新问题是在哪里修改值 - 在函数内部通过引用或在外部没有引用。但是，这些在函数式编程中都不正确。这里的正确答案是：**不要修改任何东西**。在 FP 中，您通常有一些状态变量，但不是在原地修改它，而是*创建修改后的副本*并进一步传递它，这样原始变量就不会改变。考虑用于计算阶乘的递归函数示例：

```
(defun factorial-ex (x accum)
   (if (<= x 1) 
      accum
      (factorial-ex (- x 1) (* x accum))))

(defun factorial (x)
   (factorial-ex x 1)) 
```

`factorial-ex`是一个辅助函数，它需要一个额外的参数 - 累加器来保存当前的计算状态。在每次递归调用中，我们减`x`1 并乘以`accum`的当前值`x`。但是，我们*不会更改*`x`and的值`accum`- 我们将*新值*传递给对函数的递归调用。`x`从物理上讲， and有很多副本`accum`——每个函数调用一个——而且它们都没有改变。

（请注意，某些具有特定选项的 CL 实现可能会使用所谓的[尾调用优化](http://c2.com/cgi/wiki?TailCallOptimization)，它会破坏有关上述内存中不同位置的语句，但目前您不必担心。）

在你的任务中，你可以做同样的事情。而不是修改你的 3 个变量 - 无论是内部还是外部函数 - 制作修改后的副本并将它们传递给递归调用。在命令式编程中，您使用变量和循环，而在函数式编程中，您应该更喜欢不可变值和递归。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T20:50:26.357

内置宏`rotatef`实现了这个功能：

```
(setf x 1)
(setf y 3)
;x = 1, y = 3
(rotatef x y)
;x = 3, y = 1 
```

为了编写自己的函数来执行此操作，我建议创建一个[宏](http://www.apl.jhu.edu/~hall/Lisp-Notes/Macros.html)：

```
(defmacro my-swap (a b)
     `(let ((temp ,a))
          (setf ,a ,b)
          (setf ,b temp))) 
```

但是，正如 Clayton 指出的那样，如果将这个宏应用于名为“temp”的变量，它将失败。因此，我们可以使用`gensym`创建一个新的变量名称（保证不被使用）并将其传递给实际切换值的辅助宏：

```
(defmacro my-swap-impl (a b sym) ;;implementation of my-swap
          `(let ((,sym ,b)) ;evaluate the symbol and use it as a variable name
             (setf ,b ,a)
             (setf ,a ,sym))) 
```

这是先前交换宏的一个版本，它接受第三个参数作为临时变量名。这是从一个简单的宏调用的：

```
(defmacro my-swap (a b) ;;simply passes a variable name for use in my-swap-impl
          `(my-swap-impl ,a ,b ,(gensym))) 
```

此设置可以与前一个完全一样使用，只是它不受[变量捕获](http://www.csee.umbc.edu/courses/331/resources/lisp/onLisp/09variableCapture.pdf)的影响。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-06T08:28:06.610

首先，您必须确保正确理解您的任务。返回修改后的输入并不等同于修改输入。

返回修改后的输入是微不足道的。考虑这个简单的例子：

```
(defun foo (bar)
  (1+ bar)) 
```

此函数将返回`bar`通过添加 1 修改的输入。您可以考虑一个更通用的函数，它接受输入和修改例程并将其应用于输入（或输入）。这样的功能称为`apply`：

```
CL-USER> (apply '1+ '(1))
2 
```

现在，如果要修改传递给函数的变量的值，确实不可能直截了当，因为 Lisp 使用传递值而不是传递引用或传递名称来进行函数应用。所以这样的任务通常是通过特殊或通用的修改宏来完成的，比如`setf`使用名称调用。

然而，这里还有另一种解决方法，它可能在某些有限的情况下有用 - 您不能修改变量的值，但您可以修改存储在某些数据结构中的值（因为数据结构是通过价值，而不是通过副本）。因此，如果将数据结构传递给函数，则可以更改其中的值。例如，

```
(defun swap (v1 v2)
  (psetf (elt v1 0) (elt v2 0)
         (elt v2 0) (elt v1 0)))
CL-USER> (defvar *v1* #(0))
CL-USER> (defvar *v2* #(1))
CL-USER> (swap *v1* *v2*)
CL-USER> (format t "~A ~A" *v1* *v2*)
#(1) #(0) 
```

但我应该重复一遍，这种方法可能只适用于有限数量的场景，当你真的知道它是你需要的时候。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-20T12:42:18.210

这只是一个评论，而不是一个答案。

“手动设置 a,b,c”部分可能对解构绑定有所帮助。

要以“修改状态”的方式制作河内塔，我会调用 move 函数`(move n stacks 0 2)`，它将 n 个磁盘从堆栈移动`(elt stacks 0)`到另一个堆栈`(elt stacks 2)`，从而避免“参考”问题。

如果你想在`(move n source target)`不把它写成宏的情况下调用它，源和目标应该是你从 Lisp 列表中实现的某种封装的类似堆栈的对象，也许它们有数据槽和它们自己的推送/弹出方法，这将使它们的插槽指向新的内存位置，但不会更改堆栈对象本身的内存位置。类似于从 C 空终止字符串中实现一些封装的 String 类，以便 String 类的用户不需要求助于“双重引用关系”技巧，如双指针（在 C 中）或双重引用关系：“名称堆栈指的是一个列表，而列表又具有一个引用列表的槽......”（在`(move n stacks 0 2)`）。

一种实现堆栈的方法（仅在 Emacs Lisp 上测试过）：

```
(defun make-hanoi-stack (&rest items)
  (cons items "unused slot"))
(defun hanoi-stack-push (item hanoi-stack)
  (push item (car hanoi-stack)))
(defun hanoi-stack-pop (hanoi-stack)
  (pop (car hanoi-stack)))
(defun hanoi-stack-contents (hanoi-stack)
  (car hanoi-stack)) 
```

使用堆栈：

```
(defun move-one-item (from-hanoi-stack to-hanoi-stack)
  (hanoi-stack-push (hanoi-stack-pop from-hanoi-stack)
                    to-hanoi-stack))

(let ((stack1 (make-hanoi-stack 1 2 3))
      (stack2 (make-hanoi-stack 4)))
  (move-one-item stack1 stack2)
  (print (hanoi-stack-contents stack1))
  (print (hanoi-stack-contents stack2))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-27T22:27:46.967

^(*（确保您了解[什么是`setf`特别](http://www.gigamonkeys.com/book/variables.html#assignment)的）。*)假设您要编写一个函数来更改作为输入给出的变量的内容。它通常被称为破坏性的或就地的。例如，你有一个 list`(setq xs (list 1 2 3))`，你调用 list 上的一个函数`(f xs)`，突然你的 list 等于`(4 5 6)`现在。

```
(defun f (xs) (setf xs (list 4 5 6))) ; this won't work
(defun f (xs) (setf (car xs) 4) (setf (cdr xs) (list 5 6))) ; but this will
(defun f (xs) (setf (elt xs 0) 4)) ; this will change xs to (4 2 3) 
```

在 Common Lisp 中，更改函数内部的局部（词法）变量的值只会使这个局部变量绑定到另一个值。`(setf xs '(1 2 3))`只是扩展为`(setq xs '(1 2 3))`. 但是，当您更改绑定指向的内部结构时，此更改将对指向它的每个绑定可见。因此，如果您使用 更改列表的*位置*`setf`，它将*破坏性地修改*输入变量。

Common Lisp 中的一般约定是尽可能少地使用破坏性更新，通常是在新创建的局部变量上，其最终值尚未被其余代码看到。函数式编程不鼓励破坏性更新，因此您只能拥有不触及其输入而仅返回新值的函数。因此，如果您想出复杂的就地修改数据的方法，那么您做错了什么，请尝试编写一个*返回*新数据的函数。**

# microsoft-translator - 在 JavaScript 中访问 Microsoft 翻译 API

> ID：15233525
> 
> 赞同：1
> 
> 时间：2013-03-05T20:33:17.357
> 
> 标签：microsoft-translator

我正在尝试为我的项目使用 Microsoft 翻译 API。问题是我无法获得用于翻译的访问令牌。我正在使用 POST 方法从 JavaScript 发出以下请求。

```
"**https://datamarket.accesscontrol.windows.net/v2/OAuth2-13?client_id='ID'&client_secret='secretKey'&scope='http://api.microsofttranslator.com'&grant_type='client_credentials'**" 
```

我收到以下错误：

```
"{"readyState":4,"responseText":"{\"error\":\"invalid_request\",\"error_description\":\"ACS90007: Request method not allowed.\\r\\nTrace ID: bd12508b-1d2b-420c-a4e0-360ca666c97b\\r\\nTimestamp: 2013-03-05 20:39:39Z\"}","status":400,"statusText":"Bad Request"}" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T03:49:22.417

当您获取需要发布的页面时，通常会发生“不允许请求方法”错误。我看到您说您正在发布，所以您可以发布更多代码吗？

话虽如此，不建议在浏览器中获取 JS 中的访问令牌...最好使用 PHP/ASP.NET/Node 中的服务器端应用程序来获取令牌并将其返回给您的 JS。

更多信息：http: [//social.msdn.microsoft.com/Forums/en-US/microsofttranslator/thread/cbb136e4-d67a-4902-acc0-986606c9c726/](http://social.msdn.microsoft.com/Forums/en-US/microsofttranslator/thread/cbb136e4-d67a-4902-acc0-986606c9c726/)

# java - java swing中带有阴影和圆角边缘的图像

> ID：15233526
> 
> 赞同：3
> 
> 时间：2013-03-05T20:33:19.010
> 
> 标签：java, image, swing, jpanel, paintcomponent

我正在尝试将带有圆角和阴影的图像添加[到此 RoundedPane中。](https://stackoverflow.com/a/13369038/1989579)但我无法得到它。

我做了面板从这个类扩展

```
public class JPanelConFondo extends JPanel {

    private Image imagen;

    public JPanelConFondo() {
    }

    public JPanelConFondo(String nombreImagen) {
        if (nombreImagen != null) {
            imagen = new ImageIcon(getClass().getResource(nombreImagen)).getImage();
        }
    }

    public JPanelConFondo(Image imagenInicial) {
        if (imagenInicial != null) {
            imagen = imagenInicial;
        }
    }

    public void setImagen(String nombreImagen) {
        if (nombreImagen != null) {
            imagen = new ImageIcon(getClass().getResource(nombreImagen)).getImage();
        } else {
            imagen = null;
        }    
        repaint();
    }

    public void setImagen(Image nuevaImagen) {
        imagen = nuevaImagen;    
        repaint();
    }

    @Override
    public void paint(Graphics g) {
        if (imagen != null) {
            g.drawImage(imagen, 0, 0,null, this);    
            setOpaque(false);
        } else {
            setOpaque(true);
        }    
        super.paint(g);
    }
} 
```

但是添加图像不能保留圆角和阴影重绘。

并且还尝试将带有图像的 JLabel 添加到面板中，但没有达到预期的效果。

我将不胜感激任何帮助。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T21:00:18.700

在您提供的链接中调整[我的答案](https://stackoverflow.com/a/13368321/1133011)，我能够实现这一点（借助[How to make a rounded corner image in Java](https://stackoverflow.com/questions/7603400/how-to-make-a-rounded-corner-image-in-java) +1 to the author）：

![在此处输入图像描述](../Images/84d71939e702c013da0bc976cacedf04.png)

```
import java.awt.AlphaComposite;
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.RenderingHints;
import java.awt.geom.RoundRectangle2D;
import java.awt.image.BufferedImage;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class ShadowTest {

    private JFrame frame;

    public ShadowTest() {
        initComponents();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new ShadowTest();
            }
        });
    }

    private void initComponents() {
        frame = new JFrame();
        frame.setTitle("Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//app exited when frame closes
        frame.setResizable(false);
        frame.setLayout(new GridBagLayout());
        GridBagConstraints gc = new GridBagConstraints();
        gc.fill = GridBagConstraints.HORIZONTAL;
        gc.insets = new Insets(10, 10, 10, 10);
        frame.add(new RoundedPanel(), gc);

        //pack frame (size components to preferred size)
        frame.pack();
        frame.setVisible(true);//make frame visible
    }
}

class RoundedPanel extends JPanel {

    /**
     * Stroke size. it is recommended to set it to 1 for better view
     */
    protected int strokeSize = 1;
    /**
     * Color of shadow
     */
    protected Color shadowColor = Color.black;
    /**
     * Sets if it drops shadow
     */
    protected boolean shady = true;
    /**
     * Sets if it has an High Quality view
     */
    protected boolean highQuality = true;
    /**
     * Double values for Horizontal and Vertical radius of corner arcs
     */
    //protected Dimension arcs = new Dimension(0, 0);
    protected Dimension arcs = new Dimension(20, 20);//creates curved borders and panel
    /**
     * Distance between shadow border and opaque panel border
     */
    protected int shadowGap = 10;
    /**
     * The offset of shadow.
     */
    protected int shadowOffset = 4;
    /**
     * The transparency value of shadow. ( 0 - 255)
     */
    protected int shadowAlpha = 150;
    int width = 300, height = 300;
    BufferedImage image;
    BufferedImage roundedImage;

    public RoundedPanel() {
        super();
        setOpaque(false);
        try {
            image = ImageIO.read(new URL("http://www.wallpaperpimper.com/wallpaper/Anime_&_Manga/Naruto/Naruto-Vs-Sasuke-1-D6UGW3NLAZ-800x600.jpg"));

        } catch (Exception ex) {
            ex.printStackTrace();
        }
        roundedImage = makeRoundedCorner(image, 20);//make image round

        width = roundedImage.getWidth()+arcs.width/2;//set width and height of panel accordingly
        height = roundedImage.getHeight()+arcs.height/2;
    }

    public static BufferedImage makeRoundedCorner(BufferedImage image, int cornerRadius) {
        int w = image.getWidth();
        int h = image.getHeight();
        BufferedImage output = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);

        Graphics2D g2 = output.createGraphics();

        // This is what we want, but it only does hard-clipping, i.e. aliasing
        // g2.setClip(new RoundRectangle2D ...)

        // so instead fake soft-clipping by first drawing the desired clip shape
        // in fully opaque white with antialiasing enabled...
        g2.setComposite(AlphaComposite.Src);
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setColor(Color.WHITE);
        g2.fill(new RoundRectangle2D.Float(0, 0, w, h, cornerRadius, cornerRadius));

        // ... then compositing the image on top,
        // using the white shape from above as alpha source
        g2.setComposite(AlphaComposite.SrcAtop);
        g2.drawImage(image, 0, 0, null);

        g2.dispose();

        return output;
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Color shadowColorA = new Color(shadowColor.getRed(),
                shadowColor.getGreen(), shadowColor.getBlue(), shadowAlpha);
        Graphics2D graphics = (Graphics2D) g;

        //Sets antialiasing if HQ.
        if (highQuality) {
            graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON);
        }

        //Draws shadow borders if any.
        if (shady) {
            graphics.setColor(shadowColorA);
            graphics.fillRoundRect(
                    shadowOffset,// X position
                    shadowOffset,// Y position
                    width - strokeSize - shadowOffset, // width
                    height - strokeSize - shadowOffset, // height
                    arcs.width, arcs.height);// arc Dimension
        } else {
            shadowGap = 1;
        }

        //Draws the rounded opaque panel with borders.
        graphics.setColor(getBackground());
        graphics.fillRoundRect(0, 0, width - shadowGap,
                height - shadowGap, arcs.width, arcs.height);
        graphics.setColor(getForeground());
        graphics.setStroke(new BasicStroke(strokeSize));
        graphics.drawRoundRect(0, 0, width - shadowGap,
                height - shadowGap, arcs.width, arcs.height);

        graphics.drawImage(roundedImage, 0, 0, this);//draw the rounded image

        //Sets strokes to default, is better.
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(width, height);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:11:15.237

实际答案将取决于您对阴影的定义是什么......

查看

*   [Java：在图像上创建阴影效果](https://stackoverflow.com/questions/14655643/java-create-shadow-effect-on-image/14656403#14656403)
*   [JPanel 投影](https://stackoverflow.com/questions/13368103/jpanel-drop-shadow/13369038#13369038)

举些例子。他们都使用类似的遮罩技术为非矩形形状生成阴影，这应该有助于

# java - 如何实现 OOP 以从一个类调用实例方法以存储在不同类中另一个实例方法的数组中？

> ID：15233527
> 
> 赞同：0
> 
> 时间：2013-03-05T20:33:19.593
> 
> 标签：java, oop, instance-method

为了进一步了解我的问题：

我在 Java 教科书中遇到了一个问题，它要求我编写一个名为*GroceryList*的类，它代表从市场上购买的商品列表，还有另一个名为*GroceryItemOrder*的类，它代表购买特定商品的请求给定数量（例如：***四个单位的橙子***）。根据进一步的指示，我将开发一个客户端来测试并打印所有已实现方法的结果。

**免责声明：**我没有要求**任何**人为我解决这个问题。我只是想请一位导师澄清我如何根据我的客户*GroceryListClient的指示将我的**GroceryItemOrder*类中的实例方法实现到我的*GroceryList*类中。

 ***我的*GroceryList*类中的代码：**

```
public class GroceryList_test {
    public GroceryList_test() {
        GroceryItemOrder_test[] GroceryList = new GroceryItemOrder_test[10];
    }

    public void add(GroceryItemOrder_test item) {
        GroceryItemOrder_test[] GroceryList = new GroceryItemOrder_test[10];
        GroceryList[1] = item;
        System.out.println(GroceryList[1]);
    }

    /*public double getTotalCost(GroceryItemOrder_test item) {
    }*/
} 
```

在实例方法**add(GroceryItemOrder_test item)**下：

*   如果列表中的项目少于 10 个，则将给定的项目顺序（按照*GroceryListClient*访问*GroceryItemOrder类时的指示）添加到此列表（**不要担心此元素；我可以使用**if 语句和空异常***来执行此操作）。

*每次我在GroceryListClient*客户端中指示它这样做时，我希望此方法将商品订单从**GroceryItemOrder_test (String name, int quantity, double priceperunit)**动态加载到数组中，稍后将访问该客户端以计算总成本下面的*TotalCost()*实例方法。

 ****我的*GroceryItemOrder*类中的代码：**

```
public class GroceryItemOrder_test {
    String itemID;
    int NumberofItems;
    double priceperunit;

    public GroceryItemOrder_test(String name, int quantity, double pricePerUnit) {
        this.itemID = name;
        System.out.println("Item: " + itemID);
        this.NumberofItems = quantity;
        System.out.println("Quantity: " + NumberofItems);
        this.priceperunit = pricePerUnit;
        System.out.println("Price per unit: $" + priceperunit);
    }

    public double getCost() {
        return ((NumberofItems * priceperunit) * 100.0) / 100.0;
    }
    public void setQuantity(int quantity) {
    }
 } 
```

在公共类**public GroceryItemOrder_test(String name, int quantity, double pricePerUnit) 下**：

*   构造一个项目订单，以给定名称以给定数量购买项目，每单位成本为给定价格。

我希望将此方法加载到*GroceryList*类的实例方法 add(GroceryItemOrder_test item) 中的数组中。

**我的*GroceryListClient*客户端的代码：**

```
public class GroceryListClient {
    public static void main(String[] args) {
        GroceryList_test addorder = new GroceryList_test();
        GroceryItemOrder(addorder);
    }
    public static void GroceryItemOrder(GroceryList_test addorder) {
        GroceryItemOrder_test Oranges = new GroceryItemOrder_test("oranges", 3, 2.46);
        System.out.println("Total cost of " + Oranges.itemID + " = $" + Oranges.getCost());
        addorder.add(Oranges);
        System.out.println();
        GroceryItemOrder_test Grapes = new GroceryItemOrder_test("grapes", 15, 0.55);
        System.out.println("Total cost of " + Grapes.itemID + " = $" + Grapes.getCost());
        addorder.add(Grapes);
    }
 } 
```

在**GroceryItemOrder(GroceryList_test addorder)**方法下：

```
GroceryItemOrder_test Oranges = new GroceryItemOrder_test("oranges", 3, 2.46);
System.out.println("Total cost of " + Oranges.itemID + " = $" + Oranges.getCost());
addorder.add(Oranges); 
```

特别是语句**addorder.add(Oranges);** ：

这应该将项目作为“项目”指定的“对象”添加到**add(GroceryItemOrder_test item)**方法下的数组中。

这些是我无法弄清楚如何执行的条件。如果可能，请提供任何帮助。

不要建议使用**ArrayList**，因为我还没有做到这一点，并且在进一步的研究中，我认为它不会很容易地用于此目的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:05:00.410

如果我理解您的意思，您希望`GroceryList`存储不同的`GroceryItemOrder`对象。

您即将在代码中找到解决方案。但是，请看这里：

```
public void add(GroceryItemOrder_test item) {
    GroceryItemOrder_test[] GroceryList = new GroceryItemOrder_test[10];
    GroceryList[1] = item;
    System.out.println(GroceryList[1]);
} 
```

如果你跟踪它是如何工作的，那么每次你输入这个`add()`方法时，都会创建一个包含十个空元素的新数组。当方法退出时，您将立即丢失对此的所有引用，因为它将[超出范围](http://en.wikipedia.org/wiki/Scope_%28computer_science%29#Block_scope_within_a_function)并最终被垃圾收集。

为了解决这个问题，您需要使用一个保持在范围内的变量。`GroceryList`我为您的类推荐一个实例变量，如下所示：

```
public class GroceryList {

    private GroceryItemOrder[] list = null;

    public GroceryList() {
        list = new GroceryItemOrder[10];
    }

    public void add(GroceryItemOrder item) {
        for(int i=0; i<list.length; i++) {
            if(list[i] == null) {
                list[i] = item;
                System.out.println(item);
                break;
            }
        }
    }
} 
```

现在在这种`add()`方法中，我们只查看已经存在和持续存在的`list`变量，而不是创建一个新变量。我们循环遍历它以找到一个可用的插槽（如果有的话），然后执行其余的处理。该`break`语句是必要的，以便列表中的每个项目都不会设置为您要添加的一个项目。

然后你的类可以随心所欲`GroceryClient`地创建对象并使用（因为它是）中的方法。`GroceryItemOrder``add()``GroceryList``public`

`ArrayList`请注意，与您在帖子结束评论中所说的相反，使用 确实会容易得多。***

# php - 约束区间之间的比例

> ID：15233528
> 
> 赞同：1
> 
> 时间：2013-03-05T20:33:22.583
> 
> 标签：php, rating

我正在尝试在 php 中创建一个用于集成评级系统的小类，但我遇到了一个可能很简单的问题。我想显示 0 到 5 之间的评分，但投票可以在任何区间内，例如 1 到 10 或 1 到 12。例如，如果投票区间为 1-12，总分/总票数为 6，我想实际上显示 2.5 我目前正在使用这个

```
$rating = number_format(round(($total_score/$total_votes)*2)/2,1); 
```

那么我怎样才能让它只显示 0-5 区间的值呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:42:39.610

```
$fromminrate = 1;
$frommaxrate = 12;
$tominrate = 0;
$tomaxrate = 5;
$rating = $tominrate + (
     ((($total_score/$total_votes)-$fromminrate)
     / ($frommaxrate-$fromminrate))
     * ($tomaxrate-$tominrate)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:51:01.737

使用这样的简单百分比计算：

```
<?php

$number_of_votes = 10; // real votes
$max_number_of_votes = 12; // vote range
$max_display_votes = 5; // display range

$perc = $max_display_votes * $number_of_votes / $max_number_of_votes;
$display = intval(round($perc)); // optional, round and convert to int

echo $display; 
```

由于投票范围 - 就其性质而言 - 从零开始，您不必担心下边界并且可以简化您的计算。;)

* * *

解释：

$number_of_votes(10) 与 $max_number_of_votes(12) 相关，因为所讨论的值 ($display) 与 $max_display_votes (5) 相关。在数学中：

```
$number_of_votes / $max_number_of_votes == $display / $max_display_votes; 
```

或在示例中：

```
10 / 12 = $display / 5; 
```

您可以通过乘以 5 来转换此项：

```
10 * 5 / 12 = $display; 
```

这就是我的“公式”；）

# javascript - 是否可以在将路由传递给另一个模板之前对其进行评估？

> ID：15233531
> 
> 赞同：1
> 
> 时间：2013-03-05T20:33:28.800
> 
> 标签：javascript, playframework, playframework-2.0

我有一个模板，它从后端读取`jQuery`一个 json 数组，并填充一个 select html 元素。

我以前有过这样的（省略了不必要的代码）：

```
....   
<select class="mySelect"></select>  
<script type="text/javascript">
   $.ajax({
     url: "@routes.Users.list",
     success: function(data) {
        // Populate the select from 'data' array
     }
   });
<script> 
.... 
```

现在，我已将此部分重写为单独的模板，我需要提供相同的模板`route url`：

```
@_customSelect(..., "@routes.Users.list"...) 
```

但是，无论有无`@`（是的，行首有一个“魔法人物”），都不会评估路线。我收到 HTTP 错误 404（找不到地址，显然`http://localhost:9000/@routes.Users.list`不存在）。

这种机制可能吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:49:32.080

你只需要第一个`@`“魔法人物”。模板引擎足够聪明，可以找出语句的结尾。

```
@_customSelect(..., routes.Users.list, ...) 
```

是的`routes.Users.list`一个实例`play.api.mvc.Call`。如果您需要它作为 a`String`或某物（由于类型安全性），那么我认为您可以在最后添加`.url`or `.toString`。

```
@_customSelect(..., routes.Users.list.url, ...) 
```

# regex - 用于 URL 的 Perl 正则表达式替换

> ID：15233535
> 
> 赞同：4
> 
> 时间：2013-03-05T20:33:42.537
> 
> 标签：regex, perl, url

我正在尝试使用复杂的正则表达式来匹配正文中的 URL。目的是在文本中分隔 URL。

我想做类似下面的事情

```
perl -pe 's/regex/left $1 right/g;' inputfile 
```

这将用单词包围的匹配值替换所有出现的正则表达式，`left`这`right`只是一个简化的例子来说明这一点 - 真实场景有很多`-e`表达式，我希望为这个特定的匹配目的添加另一个。

正则表达式与 URL 匹配。我意识到匹配 URL 非常困难，并且可能无法识别所有可能性，但合理的近似值就可以了。我在[http://daringfireball.net/2010/07/improved_regex_for_matching_urls](http://daringfireball.net/2010/07/improved_regex_for_matching_urls)找到了一个这样的近似值。

但是，我不能使该正则表达式在像上面这样的 perl 构造中工作。我尝试过使用不同的分隔符`/`，`~`但没有成功。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:23:06.033

[RFC 2396](http://search.cpan.org/perldoc?URI%3A%3AFind)的附录 B给出了解析 URI 的正则表达式。

> ## B. 使用正则表达式解析 URI 引用
> 
> 如第 4.3 节所述，通用 URI 语法不足以消除某些形式的 URI 的组件的歧义。由于该部分中描述的“贪婪算法”与 POSIX 正则表达式使用的消歧方法相同，因此使用正则表达式来解析 URI 引用的潜在四个组件和片段标识符是很自然且司空见惯的。
> 
> 以下行是将 URI 引用分解为其组件的正则表达式。
> 
> ```
> ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?
>  12            3  4          5       6  7        8 9 
> ```
> 
> 上面第二行中的数字只是为了便于阅读；它们指示每个子表达式的参考点（*即*，每个成对的括号）。*我们将与子表达式n*匹配的值称为`$<n>`。例如，将上面的表达式匹配到
> 
> ```
> http://www.ics.uci.edu/pub/ietf/uri/#Related 
> ```
> 
> 导致以下子表达式匹配：
> 
> ```
> $1 = http:
> $2 = http
> $3 = //www.ics.uci.edu
> $4 = www.ics.uci.edu
> $5 = /pub/ietf/uri/
> $6 = <undefined>
> $7 = <undefined>
> $8 = #Related
> $9 = Related 
> ```
> 
> where`<undefined>`表示该组件不存在，如上例中查询组件的情况。因此，我们可以将四个组件和片段的值确定为
> 
> ```
> scheme    = $2
> authority = $4
> path      = $5
> query     = $7
> fragment  = $9 
> ```
> 
> 并且，在相反的方向上，我们可以使用第 5.2 节的步骤 7 中的算法从其组件重新创建 URI 引用。

正则表达式可直接在 Perl 中使用，如

```
if ($uri =~ m!^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?!) {
    my($host,$path) = ($4,$5);
    print "$host => $path\n";
} 
```

正则表达式量词中的贪婪可能会使这种模式难以使用，`s///`因为它会消耗尽可能多的文本，可能会超出未标记的 URI 边界。

更直接适用的是CPAN 上可用的[URI::Find模块。](https://www.ietf.org/rfc/rfc2396.txt)限制 LEFT 和 RIGHT 就像

```
#! /usr/bin/env perl

use strict;
use warnings;

use URI::Find;

my $finder = URI::Find->new(sub {
    my(undef,$found) = @_;
    "LEFT $found RIGHT";
});

while (<>) {
    $finder->find(\$_);
    print;
} 
```

输出：

```
$猫输入
这是一个纯文本输入，适用于
http://stackoverflow.com 上问题的答案

特别是，该问题可在
http://stackoverflow.com/q/15233535/123109 和答案
在 http://stackoverflow.com/a/15234378/123109

$ ./mark-uris 输入
这是一个纯文本输入，适用于
LEFT http://stackoverflow.com RIGHT 上问题的答案

特别是，该问题可在
左 http://stackoverflow.com/q/15233535/123109 右和答案
在左边 http://stackoverflow.com/a/15234378/123109 右边
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:47:44.313

[感谢另一个问题Using regex to extract URLs from plain text with Perl](https://stackoverflow.com/questions/1053349/using-regex-to-extract-urls-from-plain-text-with-perl)，我找到了这个问题的答案。该 URL 比我之前尝试的要简单得多，但在我测试过的简单情况下似乎可以工作。

```
perl -i -pe 's,(http.*?://([^\s)\"](?!ttp:))+),left $& right,g;' myfile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:29:59.677

匹配 URL 的正则表达式很容易变得难以管理：

```
my @urls;
while ($body =~ m{
    (
        (ftp|https?):\/\/
        ([a-z0-9\-_]+(:[^@]+)?\@)?
        (
            ([a-z0-9\.\-]+)\.([a-z\.]{2,6})
            |
            ([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})
        )
        (:[0-9]{2,5})?
        (
            [a-z0-9\.\-_/\+\%&;\:,\=\!@\(\)\[\]~\'\"]*
            [a-z0-9\.\-_/\+\%&;\:,\=\!@\(\)\[\]~]+
        )
        (\?[a-z0-9\.\-_/\+\%&;\:,\=\!@\(\)\[\]~]*)?
        (\#[a-z0-9\.\-_/\+\%&;\:,\=\!@\(\)\[\]~]*)?
    )
}gisx) {
    push @urls => $1;
} 
```

输入[Regexp::Common](https://metacpan.org/module/Regexp%3a%3aCommon%3a%3aURI)：

```
use Regexp::Common qw(URI);
my @urls;

while ($body =~ m{($RE{URI}{HTTP})}gos) {
    push @urls => $1;
} 
```

因此，要解决您的具体情况：

```
perl -MRegexp::Common=URI -pe 's/($RE{URI}{HTTP})/left $1 right/gos' inputfile 
```

# php - 如果我删除所有特殊字符，Sql 注入的机会？

> ID：15233536
> 
> 赞同：3
> 
> 时间：2013-03-05T20:33:47.347
> 
> 标签：php, mysql, sql, sql-injection

如果我从字符串中删除所有特殊字符，那么是否有可能进行 sql 注入？？（我的输入中不需要任何特殊字符）

我正在使用以下代码删除所有特殊字符

```
 $unsafe = $_GET["tag"];
$safe = preg_replace('/[^a-zA-Z0-9 ]/s', '', $unsafe);
$safe = mysql_real_escape_string($safe); 
```

还有没有可能进行sql注入？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:35:16.603

如果您使用`mysql_real_escape_string`，则没有理由删除“不安全字符”，因为它会使它们全部安全。

但是，`mysql_*`不推荐使用这些功能，因为它们很难正确使用。PHP 开发人员现在建议使用[PDO](http://www.php.net/manual/en/ref.pdo-mysql.php)或[`mysqli_*`函数](http://www.php.net/manual/en/book.mysqli.php)。有关如何将参数化查询与 PDO 或 mysqli 一起使用，请参阅[此答案。](https://stackoverflow.com/a/60496/212555)

# ios - 在 iPhone 应用程序中将数据发布到 WCF 服务？

> ID：15233538
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:33:49.273
> 
> 标签：ios, json, web-services, post

我对 IOS 开发相当陌生，我需要使用本机方法将数据发布到服务。

我想我需要做这样的事情吗？

```
NSString *content = @"field1=42&field2=Hello";

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.mywebsite.co.uk/SendEmail.svc/request"]];
[request setHTTPMethod:@"POST"];
[request setHTTPBody:[content dataUsingEncoding:NSISOLatin1StringEncoding]];

// generates an autoreleased NSURLConnection
[NSURLConnection connectionWithRequest:request delegate:self]; 
```

我不确定我是否正确？我可以通过手动构建 url 或在 fiddler 中发布 json 来成功发布到服务。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:41:37.897

你可以这样做：

*   在您的 WCF 服务中创建这样的 Web 服务方法（类似接口或具体服务实现）：

    ```
    [OperationContract]
    [WebInvoke(UriTemplate = "GetJourneys", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    JourneyListResult GetJourneys(string sessionID); 
    ```

Request / Reponse 对象可以是任何 DataContract 对象（将通过 .NET 进行序列化`DataContractJsonSerializer`）

*   创建一个有效负载字典以在您的请求中使用：

    ```
    NSDictionary *payloadDict = [NSDictionary dictionaryWithObjectsAndKeys:self.sessionID,@"sessionID", nil];
    NSString *operationName = "GetJourneys"; 
    ```

*   创建这样的请求：

    ```
    NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc] init];
    urlRequest.URL = [NSURL URLWithString:[@"http://url/of/your/Service.svc/" stringByAppendingString:operationName];
    [urlRequest setHTTPMethod:@"POST"];
    [urlRequest addValue:@"application/json; charset=utf-8" forHTTPHeaderField:@"Content-type"];

    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:payloadDict options:0 error:NULL];
    [urlRequest setHTTPBody:jsonData];

    ITLog(@"Issuing request: %@ %@", self.operationName, [self payloadDict]); 
    ```

*   发送您的请求（backgroundQueue 是先前创建的 NSOperationQueue。请务必分派到主队列（/线程）以进行 UI 处理）：

    ```
    [NSURLConnection sendAsynchronousRequest:urlRequest queue:backgroundQueue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
            if (!error && data.length > 0) {
                NSError *jsonError = nil;
                id jsonObj = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingAllowFragments error:&jsonError];
                if (!jsonError && [jsonObj isKindOfClass:[NSDictionary class]]) {
                    // process result here
                } else {
                    // error handling
                }
            } else {
                // error handling
            }
        }]; 
    ```

*   解码/使用结果

    ```
    if ([jsonObject isKindOfClass:[NSArray class]]) {
        NSArray *dictarr=(NSArray*)jsonObject;
        NSMutableArray *resultarr=[[NSMutableArray alloc] init];
        for (NSDictionary *dict in dictarr) {
            ITJourney *journey =[[ITJourney alloc]initWithDictionary:dict];
            [resultarr addObject:journey];
        }
        // use resultarr from here...
    } 
    ```

你可以在我为大学创建的一个小示例项目中看到它：

[应用程序链接](http://cl.ly/0T170O2U0f3E)和[WCF 服务链接](http://cl.ly/3o3Z393C243r)
它还具有用于上传图像的会话处理和二进制流（非常基础）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-25T14:10:39.237

感谢 Martin 的那篇文章，它非常有帮助。我很难让我的连接，经过多次摸索，我发现我的 svc 不接受 json 内容类型。我的解决方法是将 Factory="System.ServiceModel.Activation.WebServiceHostFactory" 属性添加到 .SVC 文件中，因此：

```
<%@ ServiceHost Language="C#" Debug="true" Service="YourService" CodeBehind="YourService.svc.cs" Factory="System.ServiceModel.Activation.WebServiceHostFactory" %> 
```

希望这可以帮助某人...

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-05T20:39:51.023

我不知道你所说的本地方法是什么意思，但如果你要做很多这样的事情，特别是如果你打算对请求进行排队，你可能想看看第三方库，比如 AFNetworking。

也就是说，如果您能够成功发布到服务，那么问题是什么？

# mysql - 查询执行时间和解释输出不一致

> ID：15233545
> 
> 赞同：1
> 
> 时间：2013-03-05T20:34:00.650
> 
> 标签：mysql, optimization

我有以下查询

```
SELECT STRAIGHT_JOIN a.*
  FROM b
  INNER JOIN a ON a.b_id = b.b_id
  INNER JOIN c ON dd.a_id = a.id
  WHERE a.a_type_id = 164
    AND a.status = 1
    AND NOT EXISTS (
      SELECT a2.*
      FROM a a2
      INNER JOIN c c2 ON c2.a_id = a2.id
      INNER JOIN d d.a_id = a2.id
      WHERE a.w_id = 567
        AND c.ds_id = c2.ds_id
    )
  order by b.id
  LIMIT 1; 
```

解释给出以下结果

```
*************************** 1\. row ***************************
             id: 1
    select_type: PRIMARY
          table: b
           type: index
  possible_keys: index_b_on_b_id
            key: PRIMARY
        key_len: 4
            ref: NULL
           rows: 1
          Extra: 
  *************************** 2\. row ***************************
             id: 1
    select_type: PRIMARY
          table: a
           type: ref
  possible_keys: PRIMARY,index_a_on_a_type_id,index_a_on_status,index_a_on_b_id,index_a_on_a_type_id_and_status
            key: index_a_on_b_id
        key_len: 4
            ref: b.b_id
           rows: 1
          Extra: Using where
  *************************** 3\. row ***************************
             id: 1
    select_type: PRIMARY
          table: c
           type: ref
  possible_keys: index_c_on_a_id
            key: index_c_on_a_id
        key_len: 4
            ref: a.id
           rows: 1
          Extra: Using where
  *************************** 4\. row ***************************
             id: 2
    select_type: DEPENDENT SUBQUERY
          table: c2
           type: ref
  possible_keys: index_c_on_ds_id,index_c_on_a_id
            key: index_c_on_ds_id
        key_len: 4
            ref: c.ds_id
           rows: 1
          Extra: 
  *************************** 5\. row ***************************
             id: 2
    select_type: DEPENDENT SUBQUERY
          table: d
           type: ref
  possible_keys: index_d_on_a_id,index_d_on_w_id
            key: index_d_on_a_id
        key_len: 5
            ref: c2.a_id
           rows: 1
          Extra: Using where
  *************************** 6\. row ***************************
             id: 2
    select_type: DEPENDENT SUBQUERY
          table: a2
           type: eq_ref
  possible_keys: PRIMARY
            key: PRIMARY
        key_len: 4
            ref: d.a_id
           rows: 1
          Extra: Using where; Using index 
```

从解释结果来看，要扫描的行只有一个，但实际执行时间超过一秒。我知道解释只是一个估计，实际执行可能会有所不同，但这里有什么可以优化的（添加新索引、重写查询等）？

表中的行数如下：

*   一个 => 2585530

*   b => 10000

*   c => 2585525

*   d => 3350381

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T08:45:11.470

在不了解所有信息（架构、数据和最终目标）的情况下很难回答这样的问题，但我会尝试以通用的方式提供一些输入。

您正在评估查询中的 20,373 行，并且只返回其中之一，这在表面上看起来像是很多丢弃的数据，因此可能值得研究。阅读您的查询几乎不可能准确地确定您正在尝试做什么（没有我已经注意到的所有其他信息） - 但是我可以对这里发生的事情有一个合理的了解。

我建议您尝试重构查询的“NOT EXISTS (...)”元素，而是首先使用具有适当索引的条件语句选择有效数据，然后将其余数据加入到第一个查询中。

这对于您的数据结构可能并不完全可行，但从所提供的内容来看，这是我真正可以推荐的。如果这不合适，您是否可以使用更多信息或示例结构（包括完整架构、示例数据以及最终查询应输出的内容）来编辑您的答案。

# jquery - javascript 问题可能的冲突

> ID：15233550
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:34:12.053
> 
> 标签：jquery, google-maps-api-3, conflict

我有一个小问题。我正在使用带有 Jquery 插件 JPList 的谷歌地图，该插件对某些结果进行了一些过滤和排序。

如果我为 jplist 插件删除了一些 jquery，则 onclick 方法适用于谷歌地图，但只要我将 jplist 代码放回地图中，点击就会停止工作。

我没有收到任何 JS 错误，而且我真的很难找到它的底部。

诊断此问题的最佳方法是什么？知道如何解决这个问题将非常有用。

任何帮助将不胜感激。

谢谢

```
var infowindow = new google.maps.InfoWindow();
        var myOptions = {
           zoom: 4,
           center: new google.maps.LatLng(-40.900557, 174.885971),
           mapTypeId: google.maps.MapTypeId.ROADMAP,
           disableDefaultUI: true
        };
        var icon = "img/marker.png";
        var icons = {
            'dflt': "img/marker.png",
            'selected': "img/white-marker.png"
        };
        var seletedMarker = null;
        $(function() {
            var map = new google.maps.Map(document.getElementById("map"), myOptions);
            // grab data attributes from html
            $('.row').each(function( index ){
                var rLat = $(this).data("coordinates").lat;
                var rLng = $(this).data("coordinates").lng;
                var rTitle = $(this).find('.itemtitle a').html();
                var rTel = $(this).find('.tel').html();
                var rAdd = $(this).find('.add').html();
                var contentString = '<div style="text-align:left"><h4 style="color:#0068a6;font-size:16px;margin:0px 0px 10px 0px;">' + rTitle + '</h4><strong>' + rTel + '</strong><br /><br />' + rAdd + '</div>';
                var myLatLng = new google.maps.LatLng( rLat, rLng );
                var otherMarkers = new google.maps.Marker({
                    position: myLatLng,
                    map: map,
                    icon: icons.dflt,
                    title: rTitle
                });
                // click actions
                google.maps.event.addListener(otherMarkers, 'click', (function(otherMarkers, index) {
                    return function() {
                        if (seletedMarker) {
                            seletedMarker.setIcon(icons.dflt); //revert seletedMarker's icon to .dflt
                        }
                        infowindow.setContent( contentString );
                        otherMarkers.setIcon(icons.selected); //Set marker's icon to .seleted
                        infowindow.open( map, otherMarkers );
                        seletedMarker = otherMarkers; //Remember the currently selected marker so it can be reverted to default next time round.
                    }
                })(otherMarkers, index));
                **/* this is what doesnt work */**
                $(this).click(function(){
                    google.maps.event.trigger( otherMarkers ,'click')
                });     
            });
**/* this is what stops it working */**
                $('#dynamiclist').jplist({
                    items_box: '.results',
                    item_path: '.row',
                    panel_path: '.panel',
                    items_per_page: '4000',
                    //checkbox filters
                    control_types: {
                        'cb_filters': {
                            class_name: 'control_checkbox_filters'
                            ,options: {}
                        },
                        'reset': {
                            class_name: 'control_reset'
                            ,options: {}
                        }
                    }
                });
            }); 
```

理查德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:00:16.000

你不能只为这个脚本禁用 jQuery 吗？任何地方都不需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:38:45.853

我经常看到的一种模式是一个变量被您的脚本覆盖。

例如，如果您加载 jQuery，则设置 $

您可以将插件添加到 jQuery，然后您将看到 jqURI 插件的 $.jqURI。

但是如果你加载一个已经有 jQuery 插件的 jQuery 脚本，它可能会完全重置 $ 变量或嵌套的属性和方法。

我将在 DOM 选项卡中检查 Firebug，以查看您拥有的所有脚本组合中存在哪些属性（因此，如果您有脚本 A 和 B，我将单独检查 A，单独检查 B，然后检查 A+B）。

在涉及 jQuery 的情况下，请查看 jQuery 文档中的 jQuery.noConflict。

# c# - 想用 C# 制作一周的日历

> ID：15233555
> 
> 赞同：0
> 
> 时间：2013-03-05T20:34:22.683
> 
> 标签：c#, calendar

我希望模仿 Microsoft Outlook 中的用户界面，用户如何一次查看一周的日程安排。

我试图避免使用 ASP .NET 并使其成为网页，而是使其成为本地 .exe（再次类似于 Outlook）。

对于那些不熟悉 Outlook 的人，这就是我所追求的：

[http://josh.st/blog/wp-content/2007/03/outlook-2007-week-calendar.jpg](http://josh.st/blog/wp-content/2007/03/outlook-2007-week-calendar.jpg)

我真的很喜欢 UI 而不是功能齐全的日历。如果我也可以限制一周中显示的天数，那就太好了。

所以我想我要问的是是否有人知道任何体面的工具来完成这个 UI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:40:32.583

嗯......如果你正在寻找一个可以修改的开箱即用的体面的，试试telerik的日历：[http ://www.sitefinity.com/developer-network/marketplace/publishers/coding-staff/codingstaff-日历为站点有限-](http://www.sitefinity.com/developer-network/marketplace/publishers/coding-staff/codingstaff-calendar-for-sitefinity-)

我很幸运能收到对此的反馈，如果您想要一个看起来与 Outlook 完全一样的版本，您可以知道...总是自己编写代码。鉴于目前的版权状况，我怀疑是否有任何东西可以公开获得。

# c++ - 不能 phoenix::bind qi::_val 与 boost 1.53（回归？）

> ID：15233565
> 
> 赞同：3
> 
> 时间：2013-03-05T20:34:44.807
> 
> 标签：c++, boost, boost-spirit, boost-phoenix

下面的代码，使用 boost::spirit，用于使用 boost 1.44 和 boost 1.49：

```
qi::string("a_token")
[
    boost::phoenix::bind(&node_t::some_func, *qi::_val, true)
] 
```

我将 boost 更新到 1.53 版，但现在这段代码不再编译了。g++ 抱怨

```
error: pointer to member type 'void (node_t::)(bool)' incompatible with object type 'boost::error_cant_deduce_type' 
```

我不知道如何解决它。以下代码编译：

```
qi::string("a_token")
[
    boost::phoenix::bind(&node_t::some_func, (node_t*)0, true)
] 
```

所以我想问题出在 qi::val_... boost::spirit 的 API 是否改变了，还是我缺少包含文件？

我正在使用 g++4.7，带有--std=c++0x。

在这里，我尝试了一个小测试用例来重现问题。错误消息不一样（但它仍然很大！），但再次引用运算符似乎是问题所在。

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/spirit/include/phoenix_bind.hpp>
#include <boost/shared_ptr.hpp>

struct node_t
{
    void foo(bool){}
};

int main()
{
    namespace qi = boost::spirit::qi;

    boost::spirit::qi::rule
    <
        std::string::const_iterator,
        boost::shared_ptr<node_t>(),
        boost::spirit::ascii::space_type
    > rule;

    rule = qi::string("true")
        [boost::phoenix::bind(&node_t::foo, *qi::_val, true)];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:13:58.767

这是从上面有用的评论中得出的答案（感谢 llonesmiz）。

所做的更改`boost::shared_ptr`会影响旧版本`boost::pheonix`在尝试使用取消引用运算符 * 而不是`boost::shared_ptr`.

在包含 之前`boost::spirit`，`#define BOOST_SPIRIT_USE_PHOENIX_V3 1`可以将其添加到源中。

此外，一些包含`#include <boost/spirit/home/phoenix/ ... >`将被删除，因为它会与`spirit v3`. 相反，包括文件，例如`#include <boost/spirit/include/phoenix.hpp>`.

# algorithm - 屏幕上的 3d 实体阵列绘图

> ID：15233571
> 
> 赞同：1
> 
> 时间：2013-03-05T20:34:52.770
> 
> 标签：algorithm, 3d, screen, render

我正在制作一个3D游戏。在游戏中，我有一个在空间中有位置的实体列表。

仅绘制屏幕上或相机半径内的实体的最佳方法是什么？

例如，如果我有 100,000 个实体，那么其中可能有 10 个将在给定时间出现在屏幕上。遍历整个数组并拥有一个：

```
if(entity.position.x > (camera.x-radius) || entity.position.x < (camera.x+radius)|| ..y..z)
   draw(); // or update 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:44:18.480

也许你应该用八叉树划分你的空间。您必须分配/维护八叉树单元格中的对象。通过这样的结构，您可以快速找到必须渲染哪些八叉树单元格，然后在这些单元格中渲染实体。

这可能并不明显实现，但您可能会获得更好的性能！如果对象可能移动，这就更难了：您必须保持八叉树是最新的，而不需要遍历所有实体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:01:39.153

这称为*View Frustum Culling*。[这是一篇带有源代码](http://www.flipcode.com/archives/Frustum_Culling.shtml)的深入文章，

我还找到了另[一篇类似的文章](http://www.lighthouse3d.com/tutorials/view-frustum-culling/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:08:56.143

这取决于您使用的相机类型和视图。有几种可能性：

### 2D 视图或自上而下的地形

您可以使用视图矩形并测试对象的边界矩形是否与视图矩形相交。

### 3D 视图或透视图

您可以使用视锥体（锥形体积）并测试每个对象的边界框是否与视锥体相交。

# objective-c - NSMenu 阻塞定时器 / 全局事件监视器 / 等等

> ID：15233576
> 
> 赞同：2
> 
> 时间：2013-03-05T20:35:06.873
> 
> 标签：objective-c, cocoa, nstimer, nsmenu, nsevent

单击按钮时，我正在显示一个弹出菜单。问题是，当该菜单打开时，计时器不再工作：

要显示菜单：

```
[_menu popUpMenuPositioningItem:nil atLocation:point inView:nil]; 
```

单击按钮后，我的计时器（在弹出窗口之前调用）不再发送消息。

```
[NSTimer scheduledTimerWithTimeInterval:0.50
                                 target:self
                               selector:@selector(myMethod:)
                               userInfo:nil
                                repeats:YES]; 
```

还尝试过 [NSEvent addGlobalMonitorForEventsMatchingMask..] 甚至 CGEventTapCreate。什么都没有被调用。

如何使弹出窗口不阻塞/模态？我知道这是可能的，我已经看到另一个应用程序做到了。感谢您的任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:03:40.403

问题可能是 NSTimer 没有在正确的模式下运行。尝试通过创建一个 NSRunLoop 对象来获取当前的运行循环。然后使用方法 addTimer:forMode: （在您刚刚创建的运行循环对象中）将您的计时器添加到 NSModalPanelRunLoopMode。您可以在此处的 Apple Docs 中阅读有关它的更多信息：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSRunLoop_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSRunLoop_Class/Reference/Reference.html)

# c# - 确保 T 属于指定的 N 类中的任何一个的泛型

> ID：15233577
> 
> 赞同：2
> 
> 时间：2013-03-05T20:35:08.497
> 
> 标签：c#, .net, generics

我正在尝试创建一个列表类来处理和引发`PropertyChanged`任何属性更改时的事件。

我的主类包含 3 个列表，它们都包含 3 种不同类型的项目

我希望能够做类似的事情

```
public class MainClass : INotifyPropertyChanged
{
    public CustomList<TextRecord> texts{get; set;};
    public CustomList<BinaryRecord> binaries{get; set;};
    public CustomList<MP3Record> Mp3s{get; set;};

    //implement INotifyPropertyChanged

}

    public class CustomList<T> where T:(TextRecord, BinaryRecord, MP3Record)
    {

    //code goes here

    } 
```

请问我该如何将这个限制放在我的 CustomList 类上？提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T20:37:36.757

您不能对约束中的泛型类型参数使用“OR”语义，但您可以创建一个特殊接口，让您的目标类型实现它，并将您的泛型实例化限制为实现该特殊接口的类：

```
public interface ICustomListable {
    // You can put some common properties in here
}
class TextRecord : ICustomListable {
    ...
}
class BinaryRecord : ICustomListable {
    ...
}
class MP3Record : ICustomListable {
    ...
} 
```

所以现在你可以这样做：

```
public class CustomList<T> where T: ICustomListable {
    ...
} 
```

# java - 使用 HTML 自定义格式的 Log4j.properties 进行日志记录

> ID：15233582
> 
> 赞同：2
> 
> 时间：2013-03-05T20:35:44.473
> 
> 标签：java, logging, log4j

我需要帮助编辑 Apache Log4j 文件的输出。我正在使用 html 布局来保存创建的日志。这是我的 log4j.properties 代码：

```
log4j.rootLogger = DEBUG, FILEALL, FILEMAIN

log4j.appender.FILEMAIN=org.apache.log4j.FileAppender
log4j.appender.FILEMAIN.File=${logfileall.name}
log4j.appender.FILEMAIN.layout=org.apache.log4j.HTMLLayout
log4j.appender.FILEMAIN.Threshold=DEBUG

log4j.appender.FILEALL=org.apache.log4j.FileAppender
log4j.appender.FILEALL.File=${logfilemain.name}
log4j.appender.FILEALL.layout=org.apache.log4j.HTMLLayout
log4j.appender.FILEALL.Threshold=WARN 
```

这会创建一个像这样的日志文件 ![在此处输入图像描述](../Images/f6dadc1b31b2828f84b1c209770fc812.png)

我对如何更改输出格式感到困惑。

我希望时间列以 HH:mm:ss.S 格式显示时间戳，我不希望线程列，

另外，如果可能的话，我想将类别重命名为类路径之类的名称。

请帮忙，我应该如何修改我的 Log4j.properties 文件以完成上述工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:47:29.527

您只能更改以下选项[`org.apache.log4j.HTMLLayout`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/HTMLLayout.html)：

```
log4j.appender.FILE.layout.Title=HTML Layout Demo
log4j.appender.FILE.layout.LocationInfo=true 
```

顺便说一句，您可以扩展此类[并](http://grepcode.com/file/repository.springsource.com/org.apache.log4j/com.springsource.org.apache.log4j/1.2.15/org/apache/log4j/HTMLLayout.java)覆盖方法

```
public String format(LoggingEvent)
public String getHeader() 
```

第一种方法获取每个事件的 HTML 代码（例如表中的新行）。第二种方法获取*标题*的 HTML （从`DOCTYPE`声明到表标题行，例如`<thead>...</thead><tbody>`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:48:38.387

您需要使用指定您首选布局的自定义模式将您的 HTML 布局替换为模式布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T10:30:24.550

就像 Paul Vargas 建议的那样，您需要构建一个自定义布局来扩展`org.apache.log4j.HTMLLayout`.

查看[HTMLLayout 的代码](http://grepcode.com/file/repo1.maven.org/maven2/log4j/log4j/1.2.17/org/apache/log4j/HTMLLayout.java#HTMLLayout)，您会在`format`方法内部看到 time 列不允许任何格式设置：

```
 ...
 sbuf.append("<td>");
 sbuf.append(event.timeStamp - LoggingEvent.getStartTime());
 sbuf.append("</td>" + Layout.LINE_SEP); 
```

线程的格式化是这样完成的：

```
 ...
 String escapedThread = Transform.escapeTags(event.getThreadName());
 sbuf.append("<td title=\"" + escapedThread + " thread\">");
 sbuf.append(escapedThread);
 sbuf.append("</td>" + Layout.LINE_SEP);
 ... 
```

# c# - 显示不在数据库中的日期，仅显示一周中的特定日期

> ID：15233585
> 
> 赞同：0
> 
> 时间：2013-03-05T20:35:53.530
> 
> 标签：c#, asp.net

我有一个 sql 数据库，其中填充了每周培训的特定日期。我们只在周二和周三进行每周培训。它目前的输出如下：

```
Training Schedule

Mar 4 - Training Title
Mar 5 - Training Title
Mar 12 - Training Title
Mar 19 - Training Title 
```

好吧，现在我被要求显示数据库中没有的日期，但只有星期二和星期三。所以基本上它现在必须看起来像这样。

```
Training Schedule

Mar 4 - Training Title
Mar 5 - Training Title
Mar 12 - Training Title
Mar 13 - No Training
Mar 19 - Training Title
Mar 20 - No Training 
```

在不进入数据库并将所有“无培训”日期添加到数据库的情况下执行此操作的最佳方法是什么（因为这将永远持续下去）。现在我只是使用以下代码输出数据库结果：

```
var now = DateTime.Now;
var tableSql = "select * from Training where Date >= " + "'" + now + "'" + " order by Date";
pcm.CommandText = tableSql;
prs = pcm.ExecuteReader();
var rowcount = 0;
while (prs.Read())
   {
     rowcount++;
          %>
 <%=Convert.ToDateTime(prs["Date"].ToString()).ToString("MMM d").ToUpper()%> - <%=prs["Title"].ToString().ToUpper() %> <% } %>
        <%
            prs.Close();
            pcn.Close();
        %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:54:54.980

遍历 SQL 查询返回的数据集并将结果添加到集合 ( `List<string>`)。然后获取您已知的日期范围并遍历这些日期，如果星期几是星期二或星期四，请检查您的收藏以查看该日期是否有值。如果是，则显示该字符串，如果不是，则显示“No Training”消息。

# emacs - 在 Emacs 中自动刷新（不仅仅是拖尾）文件

> ID：15233586
> 
> 赞同：4
> 
> 时间：2013-03-05T20:35:57.947
> 
> 标签：emacs

我有一个将文本输出到文件的过程`output.log`。有时，此过程会删除文件并重新开始。

我想在 Emacs 中自动跟踪这个文件的内容。我以前使用`auto-revert-tail-mode`过，但这**会将**新输出附加到缓冲区，显示文件中可能不再存在的内容（例如，因为进程删除了前一个文件并创建了一个新文件）。

似乎可以完成这项工作的唯一命令是`C-x C-v RET`（调用`find-alternate-file`原始文件名），但我必须手动输入。

Emacs 是否提供任何内置机制来跟踪文件的内容？或者也许有一种方法可以`auto-revert-tail-mode`添加一些标记来指示文件何时被删除并从头开始重新创建？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:40:13.203

`M-x auto-revert-mode`应该做你正在寻找的东西。它更新文件的内容。

此外，当您觉得必须手动操作时，可以使用 emacs 宏（Mx kmacro-start-macro）并将其绑定到某个键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T17:07:52.690

这也`M-x global-auto-revert-mode`适用`auto-revert-mode`于所有新缓冲区，以防您忘记它。您可以将其设置`.emacs`为`(global-auto-revert-mode 1)`

# asp.net-mvc - Html.EditorFor MVC4 中的子对象？

> ID：15233590
> 
> 赞同：2
> 
> 时间：2013-03-05T20:36:09.743
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, asp.net-mvc-4

在我看来，我有以下代码：

```
@foreach (var parent in Model.Parents)
        {      
            @foreach (var child in parent.Children)
                { 

                 @Html.TextAreaFor(c => child.name)

                }                   
        } 
```

表单中的其他文本区域保存得很好，但是当提交表单时，我的控制器中的 POST 方法会获取一个带有 null 父字段的 viewModel。知道为什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:46:41.073

`foreach`如果要绑定集合，则不能使用循环。你必须使用`for`循环：

```
@for (int i = 0; i < Model.Parents.Count; i++) {
    @for (int j = 0; j < Model.Parents[i].Children.Count; j++) {
        @Html.TextAreaFor(x => x.Parents[i].Children[j].name)
    }
} 
```

或者，您可以为父母使用编辑器模板（甚至为儿童使用另一个编辑器模板）。这需要您为 Parent 模型设置模板并将其放入 EditorTemplates 文件夹，然后像这样调用它：

```
@Html.EditorFor(x => x.Parents) 
```

MVC 将负责枚举和绑定。然后可以对儿童列表执行相同的操作。

这是关于使用它们的 mvc 教程（我找不到 mvc4 版本）： [http ://coding-in.net/asp-net-mvc-3-how-to-use-editortemplates/](http://coding-in.net/asp-net-mvc-3-how-to-use-editortemplates/)

# database - 如何在表中的用户和他的联系人之间建立不同的关系

> ID：15233591
> 
> 赞同：0
> 
> 时间：2013-03-05T20:36:14.140
> 
> 标签：database, oracle, database-design, foreign-keys, primary-key

请帮我解决这个问题

我正在尝试在 sql 中创建一个关系表，但我面临的挑战是

如果user_table中有3个用户，u1，u2，u3

```
create table user_tab
(user_id varchar2(10) not null,
 user_name varchar2(20),
 user_friend_id varchar2(10),
 constraint u_pk primary key (user_id),
 constraint fk_user_snap
 foreign key (u_s_id)
 references pic_table(user_id));

insert into user_tab values(U1,user1)
insert into user_tab values(U2,user2,U1)
insert into user_tab values(U3,user3,U1) 
```

u1 将 u2, u3 添加到他的好友列表中，然后 u2 和 u3 会有一个friend_id 为 u1

```
Select * from user_tab;

User_id User_Name User_Friend_id
U1          User1       
U2          User2       U1
U3          User3       U1 
```

但是如果 U2 将 U1 和 U3 添加为好友，那么 u3 行中的friend_id 列将如何将 u1 和 u2 作为外键保存？我想要实现的是，如果 U1 将 U2 添加为好友，则可以通过添加另一列并将 U1 存储为好友 ID 来保存关系，但如果 U2 未将 U1 添加为好友，则在生成 U2 好友列表时应存储 U3 ,U4,依此类推，U2添加的user_ids

我该如何解决这个问题？**我是否创建一个单独的表来保存关系**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:41:55.723

作为一般规则，您希望创建一个单独的表来显示关系。

第 1 期（Friendster）

```
create table user_tab
(user_id varchar2(10) not null,
 user_name varchar2(20),
 constraint u_pk primary key (user_id)
 );

create table friend
(user_id varchar2(10) not null,
 user_id_friend varchar2(10) not null,
 constraint u_f_pk primary key (user_id, user_id_friend),
 constraint friend_uid_fk_user_tab foreign key (user_id)
    references user_tab(user_id),
 constraint friend_uidf_fk_user_tab foreign key (user_id_friend)
    references user_tab(user_id)
);

insert into user_tab(user_id) values ('u1');
insert into user_tab(user_id) values ('u2');
insert into user_tab(user_id) values ('u3');

insert into friend(user_id, user_id_friend)
  values ('u1','u2');
insert into friend(user_id, user_id_friend)
  values('u1','u3');
insert into friend(user_id, user_id_friend)
  values('u2','u1');
insert into friend(user_id, user_id_friend)
  values('u2','u3'); 
```

表友是 user_tab 中两个条目之间的关系表。

对于问题 2 (flickr)

```
create table pic_table
(pic_id number not null,
 user_id_uploader varchar2(10) not null,
 pic_snap bfile,
 constraint snp_pk primary key (pic_id),
 constraint pic_table_uidu_fk_user_tab foreign key (user_id_uploader)
   references user_tab(user_id)
);

create table pic_rating (
  pic_id number not null,
  user_id_rater varchar2(10) not null,
  rating number,
  constraint pic_rating_pk primary key(pic_id,user_id_rater),
  constraint pic_rating_pid_fk_pic_table foreign key (pic_id)
     references pic_table(pic_id),
  constraint pic_rating_uidr_fk_user_tab foreign key (user_id_rater)
    references user_tab(user_id)  
);

insert into pic_table(pic_id, user_id_uploader) values
  (1, 'u1');

insert into pic_rating(pic_id, user_id_rater, rating) values
  (1, 'u2', 2);
insert into pic_rating(pic_id, user_id_rater, rating) values
  (1, 'u3', 3); 
```

表 pic_rating 是 pic_table 和 user_tab 之间的关系表。

尝试制定一些添加、更新和删除关系的用例场景，你会明白为什么这是标准的数据库设计实践。

# html - 带渐变的动画画布线

> ID：15233592
> 
> 赞同：0
> 
> 时间：2013-03-05T20:36:21.757
> 
> 标签：html, html5-canvas

一位朋友问我是否可以将动画 gif 更改为画布 - 他说在手机上通过 3G 观看时 gif 被压缩，导致渐变变得“线条”。

这是目标[http://patgaunt.co.uk/logo.gif](http://patgaunt.co.uk/logo.gif)

这是我到目前为止的地方[http://patgaunt.co.uk/logo.html](http://patgaunt.co.uk/logo.html)

如您所见，我的形状非常正确，但是渐变需要跟随线条而不是画布上的一般渐变。它还需要一些不透明度，以便它在顶部循环，可以看到重叠。最后，该行需要像示例中一样进行动画处理，但我还是不知道该怎么做。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:58:47.267

由于它具有 3 个透明度级别，因此您至少需要描边 3 次。我们像这样使渐变透明：`tGrad.addColorStop(0, "transparent");`.

很抱歉让你这样离开，但我已经为你的项目制作了一个结构。它应该可以帮助您实现目标。这是我的结构的样子：http: [//jsfiddle.net/sadaf2605/JzbG2/](http://jsfiddle.net/sadaf2605/JzbG2/)

助手代码：

```
 var canvas = document.getElementById('myCanvas');
        var context = canvas.getContext('2d');
        var context2 = canvas.getContext('2d');
        var centerX = canvas.width / 2;
        var centerY = canvas.height / 2;
        var radius = 70;

//gradient for circle
        var grad = context.createLinearGradient(50, 50, 150, 150);
        grad.addColorStop(0, "#315164");
        grad.addColorStop(1, "#55a1ce");
        context.strokeStyle = grad;
        context.lineCap = "round";

//drawing circle
        context.beginPath();
        context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
        context.lineWidth = 22;
        context.stroke();
//circle ends

//gradient for straight line1
        context.beginPath();
        var t1Grad=context.createLinearGradient(50, 50, 150, 150);
        t1Grad.addColorStop(0.3, "transparent");
        t1Grad.addColorStop(1, "#55a1ce");
         context.strokeStyle=t1Grad;

//drawing straight line1
        context.moveTo(170, 35);
        context.lineTo(170, 50);
        context.stroke();

 //gradient for straight line1
        context.beginPath();
        var t2Grad=context.createLinearGradient(50, 50, 150, 150);
        t2Grad.addColorStop(0.3, "transparent");
        t2Grad.addColorStop(1, "#55a1ce");
         context.strokeStyle=t2Grad;

//drawing straight line1
        context.moveTo(170, 35);
        context.lineTo(170, 165);
        context.stroke(); 
```

# css - 我想复制一个网页的布局，但我不明白这段代码

> ID：15233593
> 
> 赞同：-4
> 
> 时间：2013-03-05T20:36:23.523
> 
> 标签：css

这是我关于 Stack Overflow 的第一个问题。我想复制这个网页糟糕的 [**编辑**真棒：我的键盘出错] 水平布局： [http](http://www.google.com/nexus/10) ://www.google.com/nexus/10 所以我使用 Firebug 来了解代码是如何制作的。他们使用 CSS 属性使一些图像保持水平，即使您缩小到文本不再可读（例如：称为“环聊”的部分）。这是我感兴趣的部分的代码（直接来自 Firebug）：

```
.nexus-10 .hangouts {
background: url("/nexus/images/n10-hangouts-bg-blur.jpg") no-repeat scroll center center, url("/nexus/images/n10-hangouts-bg-tile.jpg") repeat scroll 0 0 #F2DAC0;}
div, a, li {
border-color: #EFEFEF;
border-style: solid;
border-width: 0;
}
body {
color: #555555;
font: 300 15px "Roboto",arial,sans-serif;
} 
```

有人有任何想法吗？请帮帮我

**编辑** 好吧，我不清楚，但我不知道怎么说：我想知道“不重复滚动”是什么意思，以及如何在我的网页中使用它。不用说我不擅长 HTML 编程，也不知道 CSS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:14:05.087

这可能会对你有所帮助 - [CSS 背景](http://www.w3schools.com/css/css_background.asp)

不重复意味着它不会重复背景图像

Scroll 属性设置背景图像是固定的还是滚动的 - [Scroll](http://www.w3schools.com/cssref/pr_background-attachment.asp)

# python - facebook用户我python

> ID：15233601
> 
> 赞同：-2
> 
> 时间：2013-03-05T20:36:45.250
> 
> 标签：python, django, facebook

我正在使用 Facebook python sdk 来获取用户的电子邮件

```
import facebook as facebooksd
cookie = facebooksd.get_user_from_cookie(self.request.cookies, 
    FACEBOOK_APP_ID, FACEBOOK_APP_SECRET)
graph = facebooksd.GraphAPI(cookie["access_token"])
current_user = graph.get_object("me") 
```

不幸的是，上面的代码出现以下错误：

```
global name 'self' is not defined 
```

如何从 Facebook 获取 cookie 以插入上面的 facebooksd.get_user_from_cookie 函数？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:49:46.263

当然，如果没有实际的回溯和可运行的样本，就很难确定。但是你的问题几乎肯定会在你进入任何 Facebook 代码之前发生，在你的第二行中间：

```
import facebook as facebooksd
cookie = facebooksd.get_user_from_cookie(self.request.cookies, 
    FACEBOOK_APP_ID, FACEBOOK_APP_SECRET) 
```

您可以将第二行分成几部分：

```
import facebook as facebooksd
cookies = self.request.cookies
cookie = facebooksd.get_user_from_cookie(cookies, 
    FACEBOOK_APP_ID, FACEBOOK_APP_SECRET) 
```

甚至将第二行移到顶部：

```
cookies = self.request.cookies
import facebook as facebooksd
cookie = facebooksd.get_user_from_cookie(cookies, 
    FACEBOOK_APP_ID, FACEBOOK_APP_SECRET) 
```

并删除其他所有内容：

```
cookies = self.request.cookies 
```

瞧，同样的错误，没有任何 Facebook 代码。

您正在尝试访问名为 的全局变量`self`，但没有这样的变量。正如错误消息所说的那样。

那么，你如何解决这个问题？嗯，这取决于。你*期望* `self.request.cookies`成为什么？它应该来自哪里？如果您从其他代码中复制并粘贴了它（可能它是某个对象上的方法的一部分，其中`self`引用该对象），您必须执行该代码所做的任何事情来获取 cookie。

# javascript - 跟踪我的用户点击进入数据库的简单方法

> ID：15233604
> 
> 赞同：1
> 
> 时间：2013-03-05T20:37:03.727
> 
> 标签：javascript, google-analytics

我有一个会员网站，我想跟踪每个用户在这样的表格中点击的内容：

```
Table UserClicks:
ID int PRIMARY KEY AUTO_INCREMENT
user_id int
clicked_on varchar(255)
createdAt timestamp 
```

不是每次用户单击时都运行大量 ajax 调用，有没有更好的方法来做到这一点？

我在谷歌分析中使用 ga.js。有没有办法将用户 ID 发送到谷歌分析？

也许这更适合 node.js？没有把握。寻找反馈。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:41:19.363

这里有几个不同的问题。我将尝试解决第一个问题。

如果您只是想减少 ajax 调用的数量，您可以在客户端保留鼠标点击的运行日志，并且仅在 a) 某个时间间隔已经过去或 b)`window.onbeforeunload`事件时将它们传输到服务器被提出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T14:31:48.973

因此，在阅读了大量文档后，我发现将 _trackEvent 函数与 ga.js 一起使用，可以使用 opt_value 函数参数将整数传递给谷歌分析。opt_value 是一个整数。

所以我要做的是从会话中获取用户 ID 并将其放入页面上的隐藏输入中。

然后，我将在 ga.js 文件中获取隐藏输入的值，并将其作为 opt_value 参数发送到谷歌分析。

# sql - SQL 计算行数

> ID：15233611
> 
> 赞同：0
> 
> 时间：2013-03-05T20:37:18.747
> 
> 标签：sql, postgresql, count

我有以下内容：

```
SELECT nominees.personname, awards.name as awards, nominees.filmname 
FROM nominees, awards WHERE nominees.aid = awards.aid and nominees.personname is not 
NULL GROUP BY nominees.personname, awards.name, nominees.filmname 
ORDER BY nominees.personname; 
```

这将产生下表：

```
"personname"    "awards"        "filmname"

"Ang Lee"       "director"      "Life of Pi"
"Anglelina J."  "actress"       "The Tourist"
"Ann Dowd"   "supporting actress"   "Compliance"
"Anne Hathaway" "actress"      "Love and Other Drugs"
"Anne Hathaway" "supporting actress"  "Les Misrables"
"Annette Bening"    "actress"   "The Kids Are All Right"
"Another Year"  "screenplay"    "Mike Leigh"
"A.R. Rahman"     "score"       "127 Hours"
"AR Rahman"       "score"       "127 Hours"
"Barbara Hershey"   "supporting actress"    "Black Swan"
"Ben Affleck"   "actor"         "Argo"
"Ben Affleck"   "director"      "Argo" 
```

我试图获得只包含同一部电影获得两个单独奖项提名的人的集合。在这张只有“本·阿弗莱克”的特殊桌子上。

结果应该是

```
 "personname"    "awards"        "filmname"

    "Ben Affleck"   "actor"         "Argo"
    "Ben Affleck"   "director"      "Argo" 
```

但我似乎无法理解，我尝试使用 HAVING 和某种计数方法，但无法使其正常工作。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:39:38.663

这是简单的聚合查询。要让这个人做：

```
select personname, filmname
from (SELECT nominees.personname, awards.name as awards, nominees.filmname 
      FROM nominees, awards WHERE nominees.aid = awards.aid and nominees.personname is not NULL
      GROUP BY nominees.personname, awards.name, nominees.filmname 
     ) t
 group by personname, filmname
 having count(*) > 1 
```

您可以根据原始数据来表达这一点，并在一行中获取列表：

```
SELECT nominees.personname, nominees.filmname, array_agg(awards.name) as listOfaward
FROM nominees join
     awards
     on nominees.aid = awards.aid
where nominees.personname is not NULL
GROUP BY nominees.personname, nominees.filmname 
having COUNT(distinct  awards.name) > 1 
```

要为每个奖项获取单独的行，您可以连接回原始数据：

```
select personname, filmname, a.name
from (SELECT nominees.personname, nominees.filmname, array_agg(awards.name) as listOfaward
      FROM nominees join
           awards
           on nominees.aid = awards.aid
      where nominees.personname is not NULL
      GROUP BY nominees.personname, nominees.filmname 
      having COUNT(distinct  awards.name) > 1
     ) l join
     nominees n
     on n.personname = l.personname and n.filmname = l.filmname join
     awards a
     on n.aid = a.aid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:42:48.353

我认为它应该像这样工作：

```
SELECT nominees.personname, awards.name as awards, nominees.filmname, count(distinct  awards.name) as number_awards
FROM nominees, awards WHERE nominees.aid = awards.aid and nominees.personname is not 
NULL 
GROUP BY nominees.personname, awards.name, nominees.filmname 
HAVING number_awards > 1
ORDER BY nominees.personname; 
```

# ruby-on-rails - 在模块中使用 require —— Rails

> ID：15233612
> 
> 赞同：0
> 
> 时间：2013-03-05T20:37:35.410
> 
> 标签：ruby-on-rails, ruby-on-rails-3, module, require

这似乎相当微不足道，但让我非常悲伤！

我在 lib 文件夹中有一个模块。

```
require 'net/http'
module Weather

  def get_response
    NET::HTTP.get_response(URI.parse 'someURL').body
  end

end 
```

控制器。

```
class SunController < ApplicationController
include Weather

  def show  
    logger.debug get_response
  end
end 
```

配置/应用程序.rb

```
config.autoload_paths += %W(#{config.root}/lib) 
```

我得到这个错误

```
uninitialized constant Weather::NET 
```

我知道模块已正确加载。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:40:36.643

类`Net::HTTP`不是`NET::HTTP`。

# prolog - Prolog中的“非”运算符或否定

> ID：15233616
> 
> 赞同：1
> 
> 时间：2013-03-05T20:37:49.480
> 
> 标签：prolog, negation

## 背景

我需要编写一个关系 power(P) 来查看一个列表并确定 P 的一个元素是否都为零。

这是我所拥有的：

```
%I have a relation called zero(P) which decides if every element is zero.

power([H|T]) :- H is not zero,  %The current element is non zero, the tail is all zero.
                zero(T).         
power([0|T]) :- power(T).       %The current element is zero, 
                                %but the tail has a non zero element in it. 
```

一些资源建议使用剪切运算符 (!)，它控制回溯，我认为这不是我想要的。

我还遇到了不可证明的运算符 (\+)，它似乎交换了结果（不可证明返回是），我认为这也不是我想要的。

我确实找到了[Prolog Dictionary](http://www.cse.unsw.edu.au/~billw/prologdict.html#negation)，但我无法弄清楚“not”是什么意思或如何使用它（正如您可以想象的那样，Ctrl+F 会找到许多“not”的实例）。

## 问题

我怎么能在序言中说“H不为零”？

**编辑**该列表是整数列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:03:57.747

假设您的参数是一个数字列表，您可以简单地使用[算术运算符](http://www.swi-prolog.org/pldoc/doc_for?object=section%283,%274.27.2%27,swi%28%27/doc/Manual/arith.html%27%29%29)：

```
power([H|T]):- H =\= 0, zero(T).
power([H|T]):- H =:= 0, power(T). 
```

* * *

一般来说，你也可以写`\+ (H=0)`. 也就是说，`H`不能统一`0`。

问题是，如果使用不是数字列表的列表调用此谓词，您希望发生什么。上面的代码会导致错误。如果您希望它在这种情况下失败，那么它可以定义为

```
power([H|T]):- \+(H=0), zero(T).
power([H|T]):- H=0, power(T). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:13:26.707

使用“不可证明”运算符的工作解决方案：

```
 zero([]).
  zero([0|T]) :- zero(T).

  power([H|T]) :- \+ zero(H), zero(T).         
  power([0|T]) :- power(T). 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T07:42:03.007

zero/1 似乎是一个相当专业的谓词。如果您想了解更多惯用（高级？）Prolog，请考虑基于库（[应用](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.2%27,swi%28%27/doc/Manual/apply.html%27%29%29)）的“单线”定义：

```
power(L) :- include(=\=(0), L, [_]). 
```

测试：

```
?- power([0,99,0,0]).
true.

?- power([0,99,0,1]).
false. 
```

当然，我无法想象你为什么将这样的谓词命名为“权力”……

# php - PHP/SQLite 安全性

> ID：15233618
> 
> 赞同：0
> 
> 时间：2013-03-05T20:38:00.790
> 
> 标签：php, sqlite

我对整个 PHP/SQLite 安全游戏非常陌生；我不知道如何防范注入攻击、基于 PHP_SELF 的威胁等。有人可以查看我的 55 行登录页面并指出我可能存在的任何安全漏洞吗？我真的很感激。

```
<?php
// Begin Redirector ******************************************************************************************
if (isset($_COOKIE["session"])) { header("location:http://pagesnap.tk/"); }
// End Redirector ******************************************************************************************

else
{
?>
    <html>
        <head>
            <title>Sign In - PageSnap</title>
        </head>
        <body>
            <h1>PageSnap</h1>
            <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
                <input name="username" type="text" placeholder="Username "/>
                <br />
                <input name="password" type="password" placeholder="Password" />
                <br />
                <br />
                <input name="signin" type="submit" value="Sign In" />
            </form>
        </body>
    </html>
<?php
    if ($_POST["signin"]) // If Form Is Submitted
    {
        // Variables
        $username = $_POST["username"];
        $password = $_POST["password"];
        $password = hash("sha512", $password);

        // Database Connection
        $database = new PDO("sqlite:database.sqlite");

        // Entry Finder
        $result = $database -> query("SELECT COUNT (*) FROM accounts WHERE username = '$username' AND password = '$password'");

        // Success
        if ($result -> fetchColumn() > 0)
        {
            $id = $database -> query("SELECT id FROM accounts WHERE username = '$username' AND password = '$password'");
            $id = $id -> fetchColumn();
            setcookie("session", "$id", time()+3600);
            header("location:http://pagesnap.tk/");
        }

        // Failure (Entry Not Found)
        else
        {
            echo "You have entered your username or password incorrectly.";
        }
    }
}
?> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-05T20:45:29.513

1.  您应该使用 ctype_* 或 filter_var 函数过滤所有输入：

    ```
     if( ctype_alnum( $_POST["username"]  )  ) {

          $username = $_POST["username"];

     } else {

         //error

     } 
    ```

    为所有其他输入做

2.  你应该使用准备好的语句

3.  你应该使用绑定参数

4.  在这种情况下，您应该转义所有输出：

    ```
     setcookie("session", htmlentities( $id ), time()+3600); 
    ```

# vb.net - 在 Visual Basic Windows 窗体中加载 pdf 文件？

> ID：15233619
> 
> 赞同：0
> 
> 时间：2013-03-05T20:38:04.110
> 
> 标签：vb.net, pdf

我已经看过有关如何将 pdf 文件打开到 windows 窗体的教程，但它们显示了如何通过创建一个从目录中找到它的按钮来打开它。一旦用户加载该窗口表单，我希望已经显示 pdf 文件。我已经在组件工具箱中安装了Adobe pdf阅读器，并将以下代码与表单的加载功能一起放入：Public ClassAdding_Worksheet

```
 Private Sub Adding_Worksheet_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        Call AxAcroPDF1.LoadFile(0, "D:\Mixed_Addition_1.pdf")

    End Sub
End Class 
```

当我添加一个 swf 文件时，我已经对此进行了调整，该文件在加载时没有问题。我知道上面的零是不正确的，但我不确定在那里写什么。我为 swf 文件添加的代码是`AxShockwaveFlash1.Play()`. 我需要做类似的事情`AxAcroPDF1.Load()`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:42:43.247

If all you want to do is display a PDF and nothing else, why not use a System.Windows.Forms.WebBrowser control, and make the URL "D:\Mixed_Addition_1.pdf" ?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-18T21:48:15.393

也许他不想使用网络浏览器打开PDF文件，右键单击工具箱中的项目，当设计器处于活动状态时，选择选择项目，选择COM组件并选择Adobe。然后将代码添加到新表单。打印机将处于活动状态，您可以在属性选项卡中禁用“工具栏”

导入 AxAcroPDFLib 导入 AcroPDFLib 公共类 TripSheet

```
'
'AxAcroPDF1
'

Public Sub New()

    ' This call is required by the designer.
    InitializeComponent()
    AxAcroPDF1.Location.Equals(AxAcroPDF1.LoadFile("C:\path\file.pdf"))
    AxAcroPDF1.LoadFile("C:\path\file.pdf")
    ' Add any initialization after the InitializeComponent() call.

End Sub 
```

# hadoop - 大数据分析技术选择

> ID：15233621
> 
> 赞同：0
> 
> 时间：2013-03-05T20:38:06.793
> 
> 标签：hadoop, cassandra, hive, apache-pig

我被要求评估我们可能需要用于解决下述问题的技术。可能的选项是 Hadoop、Hive 和 Pig。我对其中任何一个都没有太多经验。如果你能指出一个很好的阅读来源。我在谷歌上找到了大量的参考资料，但很难找到一步一步的解释或比较。

这是我需要解决的任务。

用户将句子输入系统。句子按单词分解并存储在 Cassandra 列族中。每行是一个单词（键），列名是输入此记录的时间戳，没有列值。

我需要能够查询数据库并从以下细分中提取 N 个单词：

a_1% 必须是从现在到过去的时间段 T1 的热门单词 a_2% 必须是从现在到过去的时间段 T2 的热门单词 a_3% 必须是从现在到过去的时间段 T3 的热门单词

a_n% 必须是从现在到过去的时间段 T_n 的顶部单词

a_1+a_2+...a_n = 100%

T1、T2 等是任意时间间隔。

任何关于我应该用于这项任务的技术选择的建议将不胜感激。我们正在使用 Cassandra，我们对它非常熟悉。现在我们需要决定在其之上放置哪种分析工具。

链接或细节将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:39:57.067

如果您在 HIVE 中对数据进行了分区（按时间间隔），则可以通过 HIVE 中的一个查询来找到这样的“热门词组合”句子。此外，HIVEQL sytnax 将来可能会帮助进行其他分析，尤其是对于了解 SQL 的人。问题是如何将 Cassandra 与 Hadoop 集成。我希望有人能说点什么。GL！
**编辑：关于整合**[Cassandra 和 HIVE](http://my.safaribooksonline.com/book/databases/hadoop/9781449326944/17dot-storage-handlers-and-nosql/cassandrastoragehandler_html)有很好的章节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-05T06:38:06.770

**对于大多数技术人员来说，大数据**这个词并不是很陌生，尽管每个人都对它有些困惑。如果我们从外行的角度来解释这个术语，那么它意味着大量的结构化和非结构化数据。现在知道了大数据这个词的定义后，我们脑海中会出现一个非常常见的问题，我们如何才能获得这么多的数据？作为对这个问题的回答，我们可以说，我们通常在与朋友交流、进行一些数字交易或上网购物时产生数据。

[大数据提供的哪些解决方案在几年前似乎是不可能的？](https://askopinion.com/what-is-big-data-a-super-easy-intro-for-everyone)

我们已经知道，信息、照片、文字、语音、视频等数据是大数据的基础，而大数据现在已经参与到很多帮助人类的项目中。

# bytecode - Java 字节码库

> ID：15233626
> 
> 赞同：0
> 
> 时间：2013-03-05T20:38:37.917
> 
> 标签：bytecode, cglib

有人可以解释什么是字节码库吗？例如，一些 Hibernate 3.5 的书告诉我 Hibernate 使用 javaassit 或 CGLib 字节码库。这个库是为了什么而存在的？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T19:08:06.603

当您编写 Java 应用程序时，您必须先使用编译器（例如`javac`）进行编译。生成了一些类文件 (*.class)。有字节码。类文件是一个可以被 Java 虚拟机执行的二进制文件。

您可能想要读取一个类文件、修改一个类文件（例如用于检测）或创建（生成）一个全新的类文件。如果你想这样做，一个好的库可以让它变得更容易。您不必关心确切的结构和许多常量（例如操作码）。

[CGLib 主页](http://cglib.sourceforge.net/)说 Hibernate“使用 cglib 为持久类生成代理”。

# full-text-search - 如何全文搜索响应文档并让父级显示在视图/数据表中

> ID：15233628
> 
> 赞同：1
> 
> 时间：2013-03-05T20:38:39.323
> 
> 标签：full-text-search, xpages, lotus-domino

我有点陷入僵局。我正在使用 xPages 在 Domino 中工作，并且我试图允许通过包含响应文档的视图进行全文搜索，但包括与视图或数据表中的查询匹配的任何响应的父文档。目前我只是在视图数据源中使用搜索词，然后在视图控件中使用该数据源，但欢迎任何可行的解决方案。父文档上可能有其他搜索条件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:20:01.857

Richard，您不能直接将视图用作数据源，因此您不会使用视图控件。您可以使用数据表或（可能更好，因为它为您提供完整的布局控制）重复控制。

对代码中的视图运行搜索：

```
 var v = database.getView("yourView")
   //var result = database.FTSearch(...)
   var result = v.FTSearchSorted(...) // or FTSearch
   var datasource = [];
   var parent;
   for (var doc in result) {
        addResult(doc, datasource);            
        if (doc.isResponseDoc()) {
            parent = doc.getParentDocument();
            addResult(parent, datasource);
            // Careful here - if the parent is part of the resultset on its own
            parent.recycle(); 
        }
        doc.recycle();
   }
   try {
      result.recycle();
      v.recycle();
   } catch (e) {
     // We suffer silently
   }
   return datasource;

   function addResult(doc, datasource) {
        var oneResult = {};
        //Adjust that to your needs
        oneResult.subject = doc.getItemValueString("Subject");
        oneResult.unid = doc.getUniversalId();
        datasource.push(oneResult);
   } 
```

请参阅[FTSearchSorted](http://www-10.lotus.com/ldd/ddwiki.nsf/dx/FTSearchSorted-Java_API)文档。我在脑海中输入了代码，所以可能会有一些语法混乱，但你明白了不要将文档或 Notes 对象返回到 XPage 并明智地使用 recycle()。

# sql - 查询时的 Oracle 子错误

> ID：15233629
> 
> 赞同：0
> 
> 时间：2013-03-05T20:38:45.080
> 
> 标签：sql, oracle

以下代码我添加到 SQL Server 查询中，现在必须在 Oracle 中执行相同的操作。我需要在视图中而不是在 C# 中进行分组。我收到此错误消息：

> ORA-01747 无效的 user.table.column 或列规范。

我必须如何编码才能在 Oracle 中工作？

```
SELECT CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS, COUNT(*) AS [COUNT]
  FROM CTE
  GROUP BY CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS; 
```

在查询开始时，我在这里有完整的代码：

```
 CREATE OR REPLACE VIEW DBD_V_CDL_CHANGES AS 
WITH CTE AS
(
SELECT TR.FACILITY_KEY
       , MV.VALUE_CODE
       , CAST(COUNT(*) AS NUMERIC(9, 0)) COUNT
    FROM OPTC.THS_T_TRANSACTIONS1 TR
    JOIN OPTC.THS_M_MENU2 M
      ON M.MENU_ID = TR.MENU_ID
    JOIN OPTC.THS_M_VALUES MV
      ON MV.MENU_ID = TR.MENU_ID_VALUE
    JOIN OPTC.THS_M_VALUES MV2
      ON MV2.MENU_ID = TR.PREVIOUS_MENU_ID_VALUE
    JOIN OGEN.GEN_M_PATIENT_MAST PM
      ON PM.PAT_NUMBER = TR.PAT_NUMBER
   WHERE TR.TR_DATETIME BETWEEN TRUNC(SYSDATE)
                            AND TRUNC(SYSDATE) + 86399 / 86400
     AND TR.EDIT_NO < 0
     AND MV.VALUE_TYPE IS NULL
     AND MV2.VALUE_TYPE IS NULL
     AND MV.VALUE_CODE >= 0
     AND MV2.VALUE_CODE >= 0
     AND M.SUB_SYS_EXT = 'G1'
     AND ABS(MV.VALUE_CODE - MV2.VALUE_CODE) > 1
     AND (PM.DISCHARGE_DATE IS NULL OR PM.DISCHARGE_DATE < SYSDATE)
   GROUP BY TR.FACILITY_KEY, MV.VALUE_CODE)

   SELECT CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS, COUNT(*) AS [COUNT] FROM CTE
  GROUP BY CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:56:36.253

我发现您的代码有一些问题。

首先，您选择以下三列`FACILITY_KEY`，`VALUE_CODE`以及 中的计数`CTE`：

```
SELECT TR.FACILITY_KEY , 
    MV.VALUE_CODE , 
    COUNT(*) as Count -- note there is no need to CAST(COUNT(*) AS NUMERIC(9, 0)) this
FROM OPTC.THS_T_TRANSACTIONS1 TR 
```

但是，当您从中选择时，`CTE`您正在选择未在 CTE 中返回的列：

```
with cte as
( 
  -- your query here does not return DATE or PATIENT_STATUS
) 
SELECT CTE.FACILITY_KEY, 
    CTE.DATE, 
    CTE.PATIENT_STATUS, 
    COUNT(*) AS COUNT 
FROM CTE 
GROUP BY CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS; 
```

既然你没有将它们包括在你的 中`PATIENT_STATUS`，从哪里来？因此，当您尝试选择它们时，它们不存在。`Date``CTE`

我通过在列表中包含 CTE 查询中未选择的列来复制您的错误。

第二个问题是`CTE.DATE`专栏。`DATE`是保留字，地方就是双引号`CTE."DATE"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:49:56.800

...AS [COUNT], ...AS NUMERIC(9, 0)) 不是 Oracle 语法，永远不会工作。只需删除 [ ] 并使用 NUMBER 而不是 NUMERIC。无需 CAST Count()。Count() 函数将始终返回数字，例如 0 零或某个数字。

这是 Oracle 中的有效语法：

```
SELECT deptno, count(*) total_count_by_dept -- no need to cast or AS --
  FROM scott.emp
GROUP BY deptno
/ 
```

尽量不要使用保留字作为别名的 COUNT：

```
SELECT CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS, COUNT(*) AS total_cnt -- 'AS' is for clarity only, not required
  FROM CTE
 GROUP BY CTE.FACILITY_KEY, CTE.DATE, CTE.PATIENT_STATUS
/ 
```

# scikit-learn - sklearn.base 中的 BaseEstimator (Python)

> ID：15233632
> 
> 赞同：25
> 
> 时间：2013-03-05T20:38:56.033
> 
> 标签：scikit-learn, classification

我一直在自己学习和练习 sklearn 库。当我参加 Kaggle 比赛时，我注意到提供的示例代码`BaseEstimator`来自`sklearn.base`. 我不太明白如何/为什么`BaseEstimator`使用。

```
from sklearn.base import BaseEstimator
class FeatureMapper:
    def __init__(self, features):
        self.features = features        #features contains feature_name, column_name, and extractor( which is CountVectorizer) 

    def fit(self, X, y=None):
        for feature_name, column_name, extractor in self.features:
            extractor.fit(X[column_name], y) #my question is: is X features? if yes, where is it assigned? or else how can X call column_name by X[column_name]. 

... 
```

这是我通常在 sklearn 的教程页面上看到的内容：

```
from sklearn import SomeClassifier
X = [[0, 0], [1, 1],[2, 2],[3, 3]]
Y = [0, 1, 2, 3]
clf = SomeClassifier()
clf = clf.fit(X, Y) 
```

我在 sklearn 的官方页面上找不到一个很好的例子或任何文档。虽然我`sklearn.base`在 github 上找到了代码，但我想要一些例子和解释它是如何使用的。

**更新**

以下是示例代码的链接： [https](https://github.com/benhamner/JobSalaryPrediction/blob/master/features.py) ://github.com/benhamner/JobSalaryPrediction/blob/master/features.py 更正：我刚刚意识到`BaseEstimator`用于类`SimpleTransform`。我想我的第一个问题是为什么需要它？（因为它没有在计算中的任何地方使用），另一个问题是何时定义拟合，X 是什么，以及如何分配？因为通常我会看到：

```
def mymethod(self, X, y=None):
     X=self.features
     # then do something to X[Column_name] 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-06T08:15:11.377

`BaseEstimator``get_params`为和方法提供了一个默认实现`set_params`，参见[[源代码]](https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/base.py#L175)。这对于使模型网格可以搜索以`GridSearchCV`进行自动参数调整以及在`Pipeline`.

# c++ - 冒泡排序算法实现

> ID：15233633
> 
> 赞同：1
> 
> 时间：2013-03-05T20:38:58.247
> 
> 标签：c++, arrays, sorting

## 问题描述

刚才我正在学习 C++ 编程语言，我决定通过编写代码来做到这一点。我尝试编写一个算法，它将数组中的项目从`min`值开始排序为`max`值，我得到一个像这样的整数数组

```
 int arrayToSort[] = {3,5,3,1,8,7,2,4}; 
```

并尝试编写一个对该数组进行排序的算法。下面你可以看到源代码

### 算法一

```
int arrayToSort[] = {3,5,3,1,8,7,2,4};
int arrayToSortSize = sizeof(arrayToSort)/sizeof(int);

for(int i=1; i<arrayToSortSize; ++i) {
    int* first = arrayToSort;
    int* end = arrayToSort + arrayToSortSize;

    for(first; first!=end-i; ++first) {
        if (*first > *(first+1)) {
            int temp = *first;
            *first = *(first+1);
            *(first+1) = temp;
        }   
    }
} 
```

该算法工作正确，并对数组中的所有元素进行正确排序，`1, 2, 3, 3, 4, 5, 7, 8`但我想知道***该算法是否正确进行此类排序，我的意思是在这种情况下，这是对所有元素进行排序的最短方法吗？***

### 算法二

这里我实现了相同的算法，但这次我使用数组而不是指针，你可以在下面看到源代码：

```
int arrayToSortSize = sizeof(arrayToSort)/sizeof(int);

for(int i=1; i<arrayToSortSize; ++i) {
    int* first = arrayToSort;
    int* end = arrayToSort + arrayToSortSize;

    for(int j=0; j<arrayToSortSize-i; j++) {
        if (arrayToSort[j] > arrayToSort[j+1]) {
            int temp = arrayToSort[j];
            arrayToSort[j] = arrayToSort[j+1];
            arrayToSort[j+1] = temp;
        }   
    }
} 
```

这个算法也很好用。它对所有项目进行了正确排序，但我想知道***哪种算法更好用，可能是哪一种更快（如果其中一种是）？***

## 问题

*   哪种算法更好用？
*   哪个算法更快？或者他们以相同的速度工作？
*   ***算法 I***或***算法 II***能以更好的方式实现吗？
*   这个算法怎么叫？

![排序示例图像](../Images/8667f7a409d8629cf95aef56d36dc29d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:46:13.583

您的两个“算法”是称为*Bubble sort*的同一算法的两个实现。

这是最简单的排序算法，但性能很差（二次复杂度）。

如果你想更深入地研究排序算法，这里有很多很棒的书，我特别喜欢[这本](https://rads.stackoverflow.com/amzn/click/com/020172684X)。

如果您只想查看性能更快的算法，请查看`quicksort`or `mergesort`。它们都有优点和缺点，但您通常可以根据您的应用程序和数据大小选择其中之一。

更一般地说，`std::sort`在相关和可能的情况下，根据数据的大小，更喜欢哪个在定制所需的特定算法方面做得很好。只有当您发现自己有性能问题（或出于学习目的）时，您才能考虑实现自己的`sort`. 但是你真的必须知道你在做什么，因为很容易编写性能不佳的排序实现（即使是一个好的算法）。

**编辑（精度）**：在现实生活中，当数组足够小（比如，少于 20 个项目）时，使用`insertion sort`. 否则，`quicksort`如果您对数据没有更多假设，请继续。这个截止的原因是递归调用的成本可能会在少量数据上占太多开销，而不仅仅是使用快速`insertion sort`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:46:20.793

两者都不。

在大多数情况下，使用数组和指针之间的差异可以忽略不计。

算法 I 和 II 都是所谓的冒泡排序。在某些情况下，它是一种有效的排序，但很少是最快的排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:47:06.107

两种算法都找到更大的值，然后是第二个等等......所以如果你有 N 个元素，循环的第一次运行将比较 N-1 个元素，循环中的第二行将匹配 N-2 等等。

它称为冒泡排序。它采用 (N-1)N / 2 比较操作的近似值。如果您使用二进制搜索的快速排序（例如），您将需要 O(N log N) 操作，这对于大量 N 至关重要。 [来自 wiki的快速排序](http://en.wikipedia.org/wiki/Quicksort)

# oauth - DotNetOpenAuth LinkedIn 使用 Asp.Net MVC 发布共享错误

> ID：15233635
> 
> 赞同：1
> 
> 时间：2013-03-05T20:39:00.367
> 
> 标签：oauth, oauth-2.0, linkedin, dotnetopenauth

**DotNetOpenAuth**是一个了不起的包。但是，我不断遇到一些障碍。到现在大部分都解决了，现在我遇到了一个问题，这占用了我很多时间。

**问题**：我想使用 DotNetOpenAuth 在linkedin 上分享一篇文章。前段时间我可以分享一些帖子，但突然之间事情已经坏了，我不能再发布分享了。我不记得对我的代码进行了太多更改。有人可以看看我的诊断，代码，看看我是否搞砸了？

**诊断**：我在通过我的代码和 LinkedIn 的[Rest Console](https://developer.linkedin.com/rest-console)发出请求时运行了 fiddler 。以下是两种场景的 Fiddler 输出：

通过 Linkedin 提供的 Rest Console 发出的请求的 Fiddler 输出

```
POST /v1/people/~/shares HTTP/1.1
Authorization: OAuth oauth_consumer_key="{consumer_key}",oauth_signature_method="HMAC-SHA1",oauth_timestamp="1362258084",oauth_nonce="-141812272",oauth_version="1.0",oauth_token="{access_token}",oauth_signature="HBMUfvHYJAxz%2BszxStVJ%2BhfQPEQ%3D"
Host: api.linkedin.com
Content-Length: 645
X-Target-URI: http://api.linkedin.com
Content-Type: application/xml
Connection: Keep-Alive

<?xml version="1.0" encoding="UTF-8"?>
<share>
    <comment>test comment</comment>
    <content>
        <title>test title</title>
        <submitted-url>{my_test_url}</submitted-url>
        <submitted-image-url>{my_image_url}</submitted-image-url>
    </content>
    <visibility>
        <code>anyone</code>
    </visibility>
</share> 
```

通过我的代码发出的请求的提琴手输出（使用 DNOA）：

```
POST http://api.linkedin.com/v1/people/~/shares HTTP/1.1
Authorization: OAuth oauth_token="{access_token}",oauth_consumer_key="{my_consumer_key}",oauth_nonce="ECYFLc0l",oauth_signature_method="HMAC-SHA1",oauth_signature="FobR745YkMlmBpOqoTDr8CwGZIQ%3D",oauth_version="1.0",oauth_timestamp="1362263560"
Content-Type: application/xml
Host: api.linkedin.com
Content-Length: 510
Connection: Keep-Alive

<?xml version="1.0" encoding="UTF-8"?>
  <share>
    <comment>test comment</comment>
    <content>
      <title>test title</title>
      <description>test description</description>
      <submitted-url>{my_test_url}</submitted-url>
      <submitted-image-url>{my_image_url}</submitted-image-url>
    </content>
    <visibility>
      <code>anyone</code>
    </visibility>
  </share> 
```

**更多细节：**

我知道在执行 oauth 身份验证时我需要通过范围，所以已经有了这个。当用户授权我的应用程序时，我还会收到正确的权限提示，显示为“网络更新以您的身份检索并发布更新到 LinkedIn”

请注意，我确实获得了访问令牌，并且我能够执行一些读取操作，例如使用此令牌获取用户详细信息，但是，我无法使用该令牌在 LinkedIn 上共享帖子。目前实施使用的是LinkedIn oAuth 1.0a。

这也是我的代码块：

```
public bool PostToLinkedIn(WebConsumer consumer, string sShareMessageXml, string accessToken = null)
{
    var payload = Encoding.ASCII.GetBytes(sShareMessageXml);

    AuthorizedTokenResponse token = null;
    bool bIsAccessTokenSupplied = !string.IsNullOrEmpty(accessToken);
    if (!bIsAccessTokenSupplied)
    {
        token = consumer.ProcessUserAuthorization();
    }
    if (token != null || bIsAccessTokenSupplied)
    {
        this.AccessToken = bIsAccessTokenSupplied ? accessToken : token.AccessToken;

        var resourceEndpoint = new MessageReceivingEndpoint("http://api.linkedin.com/v1/people/~/shares", HttpDeliveryMethods.PostRequest | HttpDeliveryMethods.AuthorizationHeaderRequest);
        HttpWebRequest request = consumer.PrepareAuthorizedRequest(resourceEndpoint, AccessToken);
        request.ServicePoint.Expect100Continue = false;
        request.Method = "POST";
        request.ContentLength = payload.Length;
        request.ContentType = "application/xml";

        using (Stream requestStream = request.GetRequestStream())
        {
            requestStream.Write(payload, 0, payload.Length);
        }

        var response = consumer.Channel.WebRequestHandler.GetResponse(request);

        var responseData = response.GetResponseReader().ReadToEnd();

        var xmlData = XDocument.Parse(responseData);

        if (xmlData.Elements(XName.Get("update")).Any())
        {
            return true;
        }
    }
    return false;
} 
```

如果您需要更多详细信息，请告诉我。任何帮助都会很棒。

我也在 DNOA 的 google 组上发布了相同问题的简短[版本](https://groups.google.com/forum/#!topic/dotnetopenid/Kj7FyMHnVcI)。希望有人遇到过这个问题并有解决方案。

# c# - 创建不基于主键的流畅关系

> ID：15233639
> 
> 赞同：0
> 
> 时间：2013-03-05T20:39:15.953
> 
> 标签：c#, .net, entity-framework, ef-code-first

我有一个简单的 SQL 查询，我试图将它与 Fluent API 和 Entity Framework 一起使用，但我对它进行了粗略的处理。这是查询：

```
 SELECT     
  tbl1.Column,      
  tbl2.Column,  
  tbl3.Column,
  tbl4.Column
 FROM dbo.Table1 tbl1  
 INNER JOIN dbo.Table2 tbl2 ON tbl1.[Table 2 ID FK] = tbl2.ID
 LEFT JOIN dbo.Table3 tbl3  ON tbl3.[NonKeyColumn] = tbl2.[NonKeyColumn]
 LEFT JOIN dbo.Table4 tbl4 ON tbl4.[Table1FK] = tbl1.ID 
```

我的问题是 Table2 和 Table3 的连接；这些列不是任一表的主键，并且在两个表中的命名完全不同。我的表之间的关系是这样的：

表 1 << M:1 > 表 2

表 3 << M:1 > 表 2

表 4 << M:M >> 表 2

如何在 Table2 上编写将在两个给定列上加入 Table3 的关系？

我认为这是朝着正确方向迈出的一步（在表 1 中定义）：

```
 this.HasMany(e => e.Table2)
     .WithOptional(e => e.Table1)
     .HasForeignKey(tlb2 => tbl2.Column) 
```

但是我遇到了死胡同，因为我无法将 Table1 中的列与 Table2 中的列相关联。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T11:22:42.033

你不能写这样的关系。这需要`NonKeyColumn`是唯一键，`Table2`但 EF 还不支持唯一键 => EF 不支持基于非主键的关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T14:33:06.023

正如 Ladislav 指出的那样，您无法建立基于非键列的关系，但这种情况在 EF 中不一定不可能完成......它只是非常混乱。为了实现我想要仅使用 LINQ 和 EF 执行的操作，查询最终基本上具有与此类似的结构：

```
 var values = context.Table1.Select()
                        .GroupJoin(
                                    context.Table2.Select(),
                                    detail => detail.ID,
                                    entry => entry.ID,
                                    (detail, entry) =>
                                        new { //select columns })
                                     .DefaultIfEmpty()
                                     .GroupJoin(
                                            context.Table3.Select(),
                                            entry => entry.Id,
                                            check => check.NonKeyColumn,
                                            (entry, check) => new {//select additional columns})
                                     .DefaultIfEmpty()
                                     .GroupJoin(
                                            context.Table4.Select(),
                                            entry => entry.ID,
                                            transactions => transactions.ID,
                                            (entry, transactions) => new {//select additional columns})
                                     .DefaultIfEmpty(); 
```

使用 GroupJoins，我能够获得我需要的 LEFT JOIN 行为（.Join 执行 INNER JOIN）并得到我期望的数据集。话虽如此，我最终放弃了这种方法，只是提出了一个观点，将我的呼吁减少为：

```
 context.ViewTable.Select... 
```

这只是向您表明，仅仅因为您可以做某事并不一定意味着您应该这样做。;]

# jquery - 使用 Node.JS express 和 AJAX 进行 JQuery 自动完成

> ID：15233643
> 
> 赞同：1
> 
> 时间：2013-03-05T20:39:37.450
> 
> 标签：jquery, ajax, node.js, express, mongoose

这是 HTML：

```
<!DOCTYPE html>
<html>
<head>

<link rel="shortcut icon" href="/favbar.png" />

<!-- JavaScript -->
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
<script type="text/javascript">
$(function () {

    $("#search").autocomplete({

        source: function( request, response ) {
          $.ajax({
              url: "/search",
              dataType: "jsonp",
              data: {
                 featureClass: "P",
                 style: "full",
                 maxRows: 12,
                 term: request.term
              },
              success: function( data ) {
                  response( $.map( data.results, function( item ) {
                       return {
                          label: item,
                          value: item
                       }
                  }));
             }
          });
       }

    });

  });
</script>
<script src="/stylesheets/bootstrap/js/bootstrap.min.js"></script>
<!-- CSS -->
<link href="/stylesheets/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="/stylesheets/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="/stylesheets/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
<link type="text/css" href="/stylesheets/bootstrapui/css/custom-theme/jquery-ui-1.10.0.custom.css" rel="stylesheet" />

</head>
<body>

   <input type="text" id="search" class="search-query" placeholder="Search..." />

</head>
</body>
</html> 
```

这是 node.js 代码：

```
app.post('/search', function (req, res){

   var regex = new RegExp(req.body.term);

   usermodel.aggregate({$match: { user: regex }}, function (err, users){

      if (err) throw err;

      var names = [];

      for (var nam in users) {

          names.push(users[nam].user);

      }

      var result = { results: names }

      res.json(result);

    });

}); 
```

此代码不起作用。我得到了完美的 AJAX 请求，问题是 Node.js 响应。我不知道是响应的类型，还是我发送它的方式。`names`在一个包含所有结果的数组中，我像这样发送它`{ result: names }`。也许我应该只发送`res.json(result)`. 在某些示例中使用 GET 请求，而我使用 POST，我应该更改它吗？我使用 mongodb 和 mongoose 作为数据库。

我怎样才能做到这一点？谢谢提前！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T20:45:30.993

对于自动完成表格，我会推荐`twitter typeahead`. 非常简单，易于使用且功能强大。

一些例子：http: [//twitter.github.com/typeahead.js/examples/](http://twitter.github.com/typeahead.js/examples/)

文档和代码在：http: [//twitter.github.com/typeahead.js](http://twitter.github.com/typeahead.js)

# c# - Linq to SQL 上的 Stackoverflow 异常

> ID：15233645
> 
> 赞同：0
> 
> 时间：2013-03-05T20:39:40.957
> 
> 标签：c#, linq

我正在使用 Linq to SQL 访问我的 SQL Ce 数据库。

```
var Logcontext = new LogContext(GCUtility.LconnectionPool.Connection);
{           
 var _ApplicationsK = (from u in Logcontext.Applications select u.PK_Key).ToList<int>();
} 
```

在上面的代码中，PK_Key 是数据库中一个自动递增的整数变量。它抛出一个异常“System.Data.SqlServerCe.dll 中发生'System.StackOverflowException'类型的未处理异常”。我尝试在 Visual Studio 上清理、重建、重新启动等。我正在使用 Linq 运行时版本 v4.0.30319。我的代码有什么问题？

表结构如下所示。

```
PK_Key (Type = int, PrimaryKey = true, Identity = True, Identity increment = 1, seed =1 )

Username (Type = varchar, AllowNulls = True) 
```

Linq SqlMetal.exe 为列 PK_Key 生成了以下代码

```
 [global::System.Data.Linq.Mapping.ColumnAttribute(Storage = "_PK_Key", AutoSync = AutoSync.OnInsert, DbType = "Int NOT NULL IDENTITY", IsPrimaryKey = true, IsDbGenerated = true)]
    public int PK_Key
    {
        get
        {
            return this._PK_Key;
        }
        set
        {
            if ((this._PK_Key != value))
            {
                this.OnPK_KeyChanging(value);
                this.SendPropertyChanging();
                this._PK_Key = value;
                this.SendPropertyChanged("PK_Key");
                this.OnPK_KeyChanged();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:14:07.597

我发现了实际问题，我有另一个继承了这个类的子类。上面的代码在父类的构造函数中。我在父类中实例化了继承的子类，导致无限循环。愚蠢的我。

# c# - Ninject WebAPI.SelfHost 负载下的性能问题（每隔几秒钟就会出现几秒钟）

> ID：15233648
> 
> 赞同：4
> 
> 时间：2013-03-05T20:40:01.663
> 
> 标签：c#, performance, asp.net-web-api, ninject, self-hosting

我在我的 WebAPI 自托管应用程序上进行了一些负载测试，发现 Ninject 的缓存修剪会使应用程序停顿几秒钟（在屏幕截图中进行负载分析）。

如何避免缓存修剪停止请求？

我所做的只是设置 HttpSelfHostConfiguration.DependencyResolver = new NinjectDependencyResolver(new StandardKernel()) （省略配置）

有没有办法在请求结束时删除对象？

**更新：**

从这里[https://github.com/ninject/ninject/issues/37](https://github.com/ninject/ninject/issues/37)，似乎只能期望 Ninject.Web 和 Ninject.Web.MVC 在请求结束时删除对象

**更新/注意：**

我一直在使用 nuget 包 Ninject.Web.WebApi-RC 以及 AttributeRouting.WebApi.Hosted。

![在此处输入图像描述](../Images/2e465d976e9f93bd1807eea9b9a88998.png)

**更新**

我更新了范围和解析器定义，现在我发现我遇到了麻烦......我现在只是针对返回字符串常量的操作进行测试。

![在此处输入图像描述](../Images/4eabf1ab0ce3210e3473ead7ace00891.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:24:39.250

使用[https://nuget.org/packages/Ninject.Web.WebApi.Selfhost](https://nuget.org/packages/Ninject.Web.WebApi.Selfhost)

这是一个如何使用它的示例： [https ://github.com/ninject/Ninject.Web.WebApi/tree/master/src/Ninject.Web.WebApi.Selfhost](https://github.com/ninject/Ninject.Web.WebApi/tree/master/src/Ninject.Web.WebApi.Selfhost)

它在请求结束时处理对象 InRequestScope。

# javascript - jQuery将表行移动到下一个并分配了类

> ID：15233650
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:40:06.983
> 
> 标签：javascript, jquery

我有一个任务表，如下所示：

```
<table>
<tr class="open">
<td>Some task 1</td>
</tr>
<tr class="open">
<td>Some task 2</td>
</tr>
<tr class="open">
<td>Some task 3</td>
</tr>
<tr class="closed">
<td>Some task 4</td>
</tr>
<tr class="closed>
<td>Some task 5</td>
</tr>
</table> 
```

任务按打开然后关闭列出。当我将任务标记为已关闭时，我想将该行移至第一个已关闭任务的上方。例如，如果我将“某些任务 1”设置为已关闭，我想将该行移动到“某些任务 4”上方，其他打开的任务下方。

最好的方法是什么？

我试过使用 .closest() 但这似乎不适用于类选择器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:43:28.557

如果`$tr`要移动您的行：

```
$('tr.open').last().after($tr); 
```

或作为包括类更新的一行：

```
$tr.insertAfter('tr.open:last').removeClass('open').addClass('closed'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:45:19.307

如果可能没有关闭：

```
function onClosed($newlyClosedElement){
    if ($('.closed').length){
         $newlyClosedElement.insertBefore($('.closed').first());
    }
    else{
         $newlyClosedElement.insertAfter($('.open').last());
    }

    $newlyClosedElement.removeClass('open').addClass('closed');
} 
```

# ruby-on-rails - Rails 中的局部条件渲染

> ID：15233652
> 
> 赞同：2
> 
> 时间：2013-03-05T20:40:08.210
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有控制器：

```
class PagesController < ApplicationController
  protect_from_forgery
  layout "pages"

  def index
  end

  def products
  end

  def company
    @enable_sub_menu = true
  end

  def support
  end

  def login
  end
end 
```

路线文件：

```
App::Application.routes.draw do

  root :to => 'pages#index'

  ##Product / Search Routing
  match "products" => "pages#products"
  match "products/search" => 'pages#products/search'
  match "products/search/pricing" => 'pages#products/search/pricing'
  match "products/business/pricing" => 'pages#products/business/pricing'
  match "products/business" => 'pages#products/business'

  ##Company Pages Routing
  match "company/team" => 'pages#company/team'
  match "company/contact" => 'pages#company/contact'
  match "company" => 'pages#company'
  match "company/friends" => 'pages#company/friends'

  ##Support Routes
  match "support" => 'pages#suppprt'

  ##Login Routes
  match "login" => 'pages#login'
end 
```

我想要做的是在任何页面上，`/company`我想渲染一个部分但没有其他人这样做我正在使用这个

```
<%= render :partial => "pages/partials/sub_nav"  if @enable_sub_menu %> 
```

它查看控制器方法并检查它是否应该加载 sub_nav 部分

它适用于`/company`但不适用于子页面，`/company`例如`/company/team`

如何启用它以加载控制器中方法公司的所有子页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:52:52.520

您的视图中有一个辅助方法，称为**controller_name** [ActionController::Metal](http://apidock.com/rails/v3.2.8/ActionController/Metal/controller_name/class)

这可能允许您根据您所在的控制器触发部分。

```
<%= render :partial => "pages/partials/sub_nav"  if controller_name == "company" %> 
```

请注意，还有一个名为**action_name**的助手，它也允许您检查当前操作。所以你可以把它们结合起来。

```
<%= render :partial => "pages/partials/sub_nav"  if controller_name == "company" || action_name == "company %> 
```

当然，您可能希望将此 if 语句滚动到 ApplicationHelper 中的辅助方法中以**干燥**您的视图

# java - 来自 jsonobject 的错误值 - java

> ID：15233653
> 
> 赞同：0
> 
> 时间：2013-03-05T20:40:11.327
> 
> 标签：java, hashtable

这是我最后一个问题的延续： [如何将数据保存到哈希表中 - java](https://stackoverflow.com/questions/15233102/how-to-keep-data-stored-into-a-hashtable-java/15233343#15233343)

这是json：

```
{"DeviceID":"35181805087546548","TotalCount":"0","Timestamp":"2013-03-05 14:30:15"} 
```

这是我的哈希表的声明：

```
 private static Hashtable<Integer,String> table = new Hashtable<Integer,String>();
    private static AtomicInteger count = new AtomicInteger() ; 
```

这是解析 jsonobject 的代码：

```
 JSONObject jsonObj;
        try {
            jsonObj = new JSONObject(string);
            int id = jsonObj.optInt("DeviceID", count.addAndGet(1) );
            String name = jsonObj.toString();
            table.put(id, name);
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

即使 json 中的“DeviceID”发生变化，使用我的 id 下面的代码始终是“2147483647”。有什么提示吗？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:42:58.060

Your value is too large for an int. The largest allowable value is 2,147,483,647\. See [What is the maximum value for an int32?](https://stackoverflow.com/questions/94591/what-is-the-maximum-value-for-a-int32). You will need to parse the value as a long.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:43:33.863

The [maximum value of an integer](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html) in Java is 2,147,483,647, so your device ID doesn't fit. You will probably need to store it as a `long` (maximum value 9,223,372,036,854,775,807).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:43:57.700

The number you are getting is the maximum value of a signed integer, you need to use long, or your result is limited to Integer.MAX_VALUE.

# node.js - 在node.js中，这种情况下如何进行异步回调

> ID：15233656
> 
> 赞同：0
> 
> 时间：2013-03-05T20:40:14.607
> 
> 标签：node.js, callback, mongoose

首先，我在 json 中有一个数据数组，例如 var a = [{'name':'jack','age':15},{'name':'tom','age':30}] ;

更重要的是，我有一个基于 mongodb 的数据库，它是在 mongoose 中实现的。在数据库内部，有一个用户集合，存储用户的其他信息。

所以现在，我想查询上面显示的人员列表中的信息。

```
for(var i=0;i<a.length;i++){
    console.log('time schedule '+"   "+a[i].name+"   "+a[i].age);                               
    model.findOther(a[i].name,function(err,data){ 
        // I can get the data from mongodb  
          console.log("time schedule data:"+"   "+data.otherinfo+"  ");
       --------------------------------------------------------------------------------
       //however the problem arises that I can not get the a[i].age inside the callback
          console.log(a[i].age );

    });                                             
} 
```

我知道获取正确的数据是错误的，所以任何人都可以帮助我如何以异步方式编写代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T08:50:20.873

您必须将函数放入闭包并将相关变量作为参数推入其中：

```
for(var i=0;i<a.length;i++){
    console.log('time schedule '+"   "+a[i].name+"   "+ai].age);
    (function(item){
        model.findOther(item.name,function(err,data){ // <-- here you could use 'a[i]' instead of 'item' also
            console.log("time schedule data:"+"   "+data.otherinfo+"  ");
            console.log(item.age );  // <-- here you must use 'item'
        });
    }(a[i])); // <-- this is the parameter of the closure
} 
```

# php - Tumblr - Facebook 帖子状态统计

> ID：15233662
> 
> 赞同：0
> 
> 时间：2013-03-05T20:40:29.980
> 
> 标签：php, facebook-graph-api, tumblr

我想实现以下功能。

我想从我的服务器上编写一个脚本来验证用户的 tumblr 和 facebook 帐户并提取

> 像统计比较数据

从相应的帖子。

有人有想法么。

我厌倦了使用 tumblr API 提取信息，但没有得到任何有用的信息来满足要求

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T17:29:58.193

Tumblr*喜欢*被归类为**post notes**。

从[API 文档](http://www.tumblr.com/docs/en/api/v2#posts)中，您可以获得如下的帖子注释信息：

[http://api.tumblr.com/v2/blog/BLOGNAME.tumblr.com/posts?id=XXXX¬es_info=true](http://api.tumblr.com/v2/blog/BLOGNAME.tumblr.com/posts?id=XXXX&notes_info=true)

添加参数`notes_info=true`将返回note / like count。

# php - 通知的空列表

> ID：15233663
> 
> 赞同：0
> 
> 时间：2013-03-05T20:40:30.847
> 
> 标签：php, button, mysqli

我正在用 php 和 mysqli 构建一个自定义社交网络。我有一个名为 notification.php 的页面，它显示用户站点通知以及好友请求！简单地说，我想做的就是允许用户通过单击一个按钮来清除他的通知列表！

在我的html中我有这个......

```
<p><span id="purgeList"><?php echo $purgeList; ?></span></p>
<h2>Notifications</h2><?php echo $notification_list; ?></div> 
```

到目前为止，我所拥有的按钮就是这个....

```
<?php
$purgeList = '<button disabled>Purge your List</button>';
if ($notification_list == true){
    $purgeList = '';
}
?> 
```

通知本身使用这个脚本被拉进来！

```
$notification_list = "";
$sql = "SELECT * FROM notifications WHERE username LIKE BINARY '$log_username' ORDER BY date_time DESC LIMIT 5";
$query = mysqli_query($db_conx, $sql);
$numrows = mysqli_num_rows($query);
if($numrows < 1){
    $notification_list = "You do not have any notifications";
} else {
    while ($row = mysqli_fetch_array($query, MYSQLI_ASSOC)) {
        $noteid = $row["id"];
        $initiator = $row["initiator"];
        $app = $row["app"];
        $note = $row["note"];
        $date_time = $row["date_time"];
        $date_time = strftime("%b %d, %Y", strtotime($date_time));
        $notification_list .= "<p><a href='user.php?u=$initiator'>$initiator</a> | $app<br />$note</p>";
    }
}
mysqli_query($db_conx, "UPDATE users SET notescheck=now() WHERE username='$log_username' LIMIT 1"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:23:55.103

如果您正在寻找一种即时删除通知的方法，则需要执行 XHR 请求（也称为 AJAX）

有关这方面的文档，您可以访问[jQuery API](http://api.jquery.com/jQuery.ajax/)以获取更多信息。

您可以让他们重新加载页面以删除他们的通知，然后使用`header`重定向将他们发送回他们的“新闻提要”

在我看来，我会使用 ajax，因为它不会导致页面重新加载并且它可以动态发生。

希望这会有所帮助=)

# android - 制作一个带有可点击对象的 2D 可滚动表格

> ID：15233665
> 
> 赞同：1
> 
> 时间：2013-03-05T20:40:33.270
> 
> 标签：android, click, android-gridview, android-tablelayout, android-scroll

我正在尝试制作一个充满项目的表格/网格。到目前为止，我已经实现了[Fuzzical Logic](https://stackoverflow.com/a/7733408/1685143)`GridView`提出的a 。这是[结果的图像](http://www.hostingpics.net/viewer.php?id=480094Screenshot20130305212101.jpg)。我可以双向滚动。

我的问题是，通过`OnTouchListener`为我设置一个新的`GridView`（它可以在两个方向上滚动），我的项目不再是可点击的。我曾尝试`OnItemClickListener`从 my 的 onTouch 方法调用`GridView`，但我认为它太复杂了。

所以我现在问你，显示**可双向滚动的可点击项目表**的最佳方法是什么。此外，项目的数量可以变化很大，列的数量也是如此。可能有“空”单元格。

我真的很喜欢 GridView，因为它易于管理，但缺少 2D 滚动。任何想法 ？

戈尔达克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:46:47.463

我通过以下方式实现了一个可点击的表格：

```
 TableLayout table = (TableLayout) findViewById(R.id.tableReportsList);
    table.setStretchAllColumns(true);  
    table.setShrinkAllColumns(true);  
    final String tag = "tag";

    for (Report tempReport : reportsRepository)
    {
        TableRow row = new TableRow(this);
        TableLayout.LayoutParams tableRowParams=new TableLayout.LayoutParams(TableLayout.LayoutParams.WRAP_CONTENT,TableLayout.LayoutParams.WRAP_CONTENT);
        tableRowParams.setMargins(0, 10, 0, 10);
        row.setLayoutParams(tableRowParams);
        row.setClickable(true);
        TextView tvName = new TextView(this);
        tvName.setBackgroundDrawable(getResources().getDrawable(R.drawable.table_row_shape));
        tvName.setText(tempReport.getName());
        tvName.setGravity(Gravity.CENTER_HORIZONTAL);
        tvName.setTextColor(getResources().getColor(R.color.my_black));  
        tvName.setTag(tag);
        row.addView(tvName);
        TextView tvPath = new TextView(this);
        tvPath.setBackgroundDrawable(getResources().getDrawable(R.drawable.table_row_shape));
        tvPath.setText(tempReport.getPath());
        tvPath.setGravity(Gravity.CENTER_HORIZONTAL);
        tvPath.setTextColor(getResources().getColor(R.color.my_black));
        row.addView(tvPath);
        map.put(tempReport.getName(), tempReport);
        row.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) 
            {   
                TextView tvName = (TextView) v.findViewWithTag(tag);
                Log.d(TAG, "looking for report with name: " + tvName.getText());
                Report report = (Report)map.get(tvName.getText());
                Log.d(TAG, "The report found: " + report.toString());
                Map<String, String> valuesmap = new HashMap<String, String>();  
                valuesmap.put(GetParametersAsyncTask.REPORTID_PARAM, report.getId());
                Log.d(TAG, "passed the following id to the asynctask: "+ report.getId());
                GetParametersAsyncTask asyncTask = new GetParametersAsyncTask(ReportsTableActivity.this, ((SGRaportManagerAppObj)getApplication()).getCurrentUrl());
                asyncTask.execute(valuesmap);
            }
        });
        table.addView(row);   
    } 
```

而 xml 文件看起来像这样：

```
<FrameLayout>
  <ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginBottom="10dp"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="10dp"
    android:layout_marginTop="55dp" >

    <TableLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/tableReportsList"
        android:layout_width="match_parent"
        android:layout_height="match_parent" 
        android:shrinkColumns="*"  
        android:stretchColumns="*" >

        <TableRow
            android:layout_height="wrap_content"
            android:background="@color/light_gray"
            android:textStyle="bold" >

            <TextView
                android:id="@+id/nameLabel"
                android:layout_height="wrap_content"
                android:background="@drawable/table_row_shape"
                android:gravity="center_horizontal"
                android:text="@string/report_name"
                android:textColor="@color/my_black"
                android:paddingTop="5dp"
                android:paddingBottom="5dp"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/pathLabel"
                android:layout_height="wrap_content"
                android:background="@drawable/table_row_shape"
                android:gravity="center_horizontal"
                android:paddingTop="5dp"
                android:paddingBottom="5dp"
                android:text="@string/report_path"
                android:textColor="@color/my_black"
                android:textStyle="bold" />
        </TableRow>
    </TableLayout>
</ScrollView> 
```

看看你是否觉得它有帮助。

# laravel - laravel 4 分页集合

> ID：15233667
> 
> 赞同：3
> 
> 时间：2013-03-05T20:40:39.503
> 
> 标签：laravel, laravel-4

我无法使用 laravel 4 创建适当的分页系统。我有以下模型和函数返回集合：

示范餐厅：

```
public function fooditem()
{
    return $this->hasMany('Fooditem','rest_id');
}
public function get_rest_foods($id){
    return Restaurant::find($id)->fooditem->toArray();
} 
```

第二个函数将某个餐厅的所有食品作为数组返回。我也在 API 调用中使用它。

在我的控制器中，我有这个：

```
 $food = $food->get_rest_foods($id);
 $paginator = Paginator::make($food, 10, 5); 
```

我将分页器传递给视图，它显示链接正常，但也显示了食物数组中的所有项目。

我尝试使用

```
public function get_rest_foods($id){
        return Restaurant::find($id)->fooditem->paginate(5);
    } 
```

但我得到一个错误：

> FatalErrorException：错误：调用未定义的方法 Illuminate\Database\Eloquent\Collection::paginate()

我搜索了这个网站和许多其他网站，但无法理解如何对集合进行分页。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-13T20:23:39.247

分页器必须获取通常从带有偏移/限制语句的数据库查询中获取的项目。因此，当您拥有包含所有项目的集合时，您应该自己进行偏移/限制。

```
 $food = $food->get_rest_foods($id);

    $page = 1;
    if( !empty(Input::get['page']) ) {
        $page = Input::get['page'];
    }

    $perPage = 15;
    $offset = (($page - 1) * $perPage);

    $food = Paginator::make($food->slice($offset,$perPage, true)->all(), $food->count(), $perPage); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-09T06:30:50.623

我创建了 Collection 的子类并实现了自己的分页方法

```
public function paginate($perPage) {
    $pagination = App::make('paginator');
    $count = $this->count();
    $page = $pagination->getCurrentPage($count);
    $items = $this->slice(($page - 1) * $perPage, $perPage)->all();
    $pagination = $pagination->make($items, $count, $perPage);
    return $pagination;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-14T05:56:06.820

Laravel 分页器不会为你做任何拼接。通常，分页器应与 Eloquent/Fluent 一起使用。在您的第二个示例中，您应该这样做。

```
return Restaurant::find($id)->fooditem()->paginate(5); 
```

如果不调用实际方法，您将只获得结果集合，而不是查询构建器实例。

如果要手动使用分页器，则需要传入拼接数组（当前页面的正确项）。这通常涉及确定当前页、总结果和总页数。这就是为什么在可能的情况下，最好将它与 Eloquent 或 Fluent 一起使用。

# iphone - 围绕其左上角旋转矩形

> ID：15233668
> 
> 赞同：0
> 
> 时间：2013-03-05T20:40:44.420
> 
> 标签：iphone, ios, cocoa-touch, geometry, cgaffinetransform

只需尝试围绕它的原点或左上角旋转一个矩形，如下所示：

![在此处输入图像描述](../Images/e0b1012f76f4270ae273ce5f6d31927b.png)

我正在使用以下内容：

```
panGestureRecognizer.view.transform = CGAffineTransformRotate(panGestureRecognizer.view.transform, (M_PI * angle) / 180); 
```

但是矩形有点像在一个大循环中旋转。我需要做一些翻译才能让它工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T02:35:33.573

您只需要设置锚点：[https ://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/anchorPoint](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/anchorPoint)

```
panGestureRecognizer.view.layer.anchorPoint = CGPointMake(0.0, 0.0); 
```

**进一步阅读：**对于更高级的东西，您可以尝试这里详细介绍的矩阵转换的一些技巧：[https ://stackoverflow.com/a/8536553/563381](https://stackoverflow.com/a/8536553/563381)

# xcode - 卡在 git 循环中

> ID：15233673
> 
> 赞同：3
> 
> 时间：2013-03-05T20:40:49.370
> 
> 标签：xcode, git, github

我遇到了一个问题，我不小心将一个目录复制到了它自己的子目录中，从而创建了数千个 git 事务。在尝试清理它失败后，我决定创建一个新项目并从旧项目复制文件。不知何故，我认为我搞砸了，但我不确定问题出在哪里。这是我目前的症状。

我以为我正确初始化了 git 存储库。但是，github 上不存在任何文件。

[https://github.com/victorengel/matchismo2](https://github.com/victorengel/matchismo2)

...除了我在那里创造的东西。

该项目本身是一个 iOS 单视图应用程序，我在启用 git 的情况下创建。我将我需要的所有文件从旧项目复制到新项目区域，确认它运行，然后尝试提交。提交似乎有效，但推送没有。

如果我尝试推送，我会收到一条消息，指出工作副本已过时，我应该进行拉取。如果我尝试拉，它说有未提交的更改，我应该放弃它们或提交它们。经过一番摸索，我发现触发此事件的更改是用户数据更改，应该在 .gitignore 中忽略。

我终于按照需要的方式设置了 .gitignore。我认为存储库是在 github.com 上设置的，但我仍然遇到错误。

我可以提交但不能推动。如果我尝试推送，我会收到消息“工作副本已过期。尝试从远程拉取最新更改，然后再次推送。”

如果我尝试拉动，我会收到消息“matchismo2/master”不是要从中拉出的有效远程分支。请选择不同的远程分支。

环顾github.com，只有一个分支，victorengel/matchismo2下的master。对我来说，看起来一切都设置正确，但显然我错过了一些东西。它是什么？

在 Xcode 的管理器中，如果我单击分支，则会列出一项：master。如果我单击 Remotes，则有一项，matchismo2，如果我展开它，则会列出 master。

我一直假设这个 matchismo2 和下面的 master 应该与错误消息中的“matchismo2/master”相匹配。对我来说看起来很匹配，为什么它不起作用？

编辑：如果我尝试从 GitHub 应用程序中提取，我会收到一条错误消息“服务器上还没有任何远程分支。” 如果我尝试从 GitHub 发布，我会得到以下信息：

```
git: 'credential-osxkeychain' is not a git command. See 'git --help'.
2013-03-05 16:32:43.680 GitHub for Mac Login[68518:707] AskPass with arguments: (
    "/Users/brillig/Downloads/GitHub.app/Contents/MacOS/GitHub for Mac Login",
    "Password for 'https://victorengel@github.com': "
)
2013-03-05 16:32:43.763 GitHub for Mac Login[68518:707] Error reading attributes: OSStatus -2033889429
2013-03-05 16:32:43.764 GitHub for Mac Login[68518:707] Error reading attributes: OSStatus -2033889429
2013-03-05 16:32:43.919 GitHub for Mac Login[68518:707] Error reading attributes for password: OSStatus 840183217
git: 'credential-osxkeychain' is not a git command. See 'git --help'.
To https://victorengel@github.com/victorengel/matchismo2.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'https://victorengel@github.com/victorengel/matchismo2.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Merge the remote changes (e.g. 'git pull')
hint: before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
 (256) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-18T18:22:10.810

如何确保所有文件都井井有条，重命名分支并推送到新的（重命名的分支）？然后，一旦您确定所需的一切实际上都在那里并且您的新代码有效，您就可以强制更新 master。这不是一个理想的方法，但它可能对你有用。

# java - Findbugs 在 Jenkins 中使用排名而不是优先级

> ID：15233676
> 
> 赞同：2
> 
> 时间：2013-03-05T20:40:59.953
> 
> 标签：java, testing, jenkins, jenkins-plugins, findbugs

我正在使用 Sonar 设置 Jenkins 服务器，用于代码分析和 FindBugs、Cobertura 和 PMD 的覆盖。

然后我被要求在其中配置一个运行项目测试的作业，如果 Findbugs 发现一些可怕或最严重的问题，那么构建会导致失败。

经过一番谷歌搜索后，我想到了[它](https://wiki.jenkins-ci.org/display/JENKINS/FindBugs+Plugin)说的地方

> 4.26 版
> 
> 添加了在映射插件警告优先级时使用 FindBugs 错误优先级或排名的选项

我认为有了这个我可以在这张图片中看到的阈值中设置等级

![配置任务：发布 Findbugs 分析](../Images/5fc9e993174d28dfdfbcc34cb904366e.png)

所以，我想知道是否有可能做我被要求做的事情，如果可以，怎么做。如果我弄错了，“使用排名作为优先级”代表什么？

# ruby-on-rails - 带有祖先的红宝石地图

> ID：15233678
> 
> 赞同：0
> 
> 时间：2013-03-05T20:41:05.877
> 
> 标签：ruby-on-rails

我正在关注这个关于使用祖先的 railscast 剧集： [http ://railscasts.com/episodes/262-trees-with-ancestry](http://railscasts.com/episodes/262-trees-with-ancestry)

我不了解地图方法。有人可以解释“sub_messages”是如何工作的吗？

```
def nested_messages(messages)
  messages.map do |message, **sub_messages**|
    render(message) + content_tag(:div, nested_messages(sub_messages), :class => "nested_messages")
  end.join.html_safe
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:43:51.473

When you call `map` on a hash, it iterates through the hash and (in your example), assigns the key to `message` and the value to `sub_messages`.

# ios - 您在 iOS 上的地图上的图钉数据加载策略是什么？

> ID：15233682
> 
> 赞同：0
> 
> 时间：2013-03-05T20:41:20.897
> 
> 标签：ios, map, fetching-strategy

我开发了一个带有原生地图的 iOS 应用程序，在地图上显示自定义图钉？图钉后面的数据根据​​地图周围的移动按需加载。我正在根据当前位置设置半径，如果地图超出该区域，它将发送数据更新。起初，新引脚加载顺畅，但有时我感觉它们滞后，尤其是快速滑动。那么在这种情况下你使用什么策略呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:21:01.240

我使用的具有地图的应用程序我通常使用边界框而不是半径，因为它与屏幕（即矩形）完美匹配。

至于在用户移动时加载新的 pois，我会等到他们停止滚动地图。如果您的用户正在快速滑动，您总是可以检测到地图已经移动并取消任何正在执行的现有请求，直到用户再次停止移动。

# vb.net - 程序的WriteLine不显示

> ID：15233683
> 
> 赞同：1
> 
> 时间：2013-03-05T20:41:21.667
> 
> 标签：vb.net, console, average

我正在尝试创建一个程序，该程序接受三个数字的输入，对它们进行平均，然后打印平均值。我到目前为止的代码：

```
Sub Main()
    Dim Average As Double

    Console.WriteLine("Please input first number:")
    Dim Num1 As String
    Num1 = Console.ReadLine()

    Console.WriteLine("Please input second number:")
    Dim Num2 As String
    Num1 = Console.ReadLine()

    Console.WriteLine("Please input third number:")
    Dim Num3 As String
    Num3 = Console.ReadLine()

    Average = (Num1 + Num2 + Num3) / 3
    Console.WriteLine("Your average is: ", Average)
    Console.WriteLine("Press any key to exit")
    Console.ReadLine()
End Sub 
```

我输入三个数字，然后我的程序显示文本，“你的平均值是” 但是那里没有值；文本后只是空白。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:44:50.840

尝试使用字符串连接

```
Console.WriteLine("Your average is: " + Average.ToString) 
```

或使用复合格式字符串

```
Console.WriteLine("Your average is: {0}", Average) 
```

[请参阅 Console.WriteLine(string, object[]) 上的 MSDN](http://msdn.microsoft.com/en-us/library/828t9b9h.aspx)

**编辑：**在尝试对其执行加法和除法之前，您需要将该字符串输入转换为正确的数字

```
Dim Num1 as Integer
While(Int32.TryParse(Console.ReadLine(), Num1)
     Console.WriteLine("Please enter a integer number")

' and so on for the other inputs ' 
```

而且，请帮自己一个忙，[`Option Strict On`](http://msdn.microsoft.com/en-US/library/zcd4xwzs%28v=VS.80%29.aspx)为您的项目做好准备。这种自动转换是邪恶的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:46:23.317

我认为由此：

```
Console.WriteLine("Your average is: ", Average) 
```

你实际上是这个意思：

```
Console.WriteLine(String.Format("Your average is: {0}", Average)) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-09-30T03:53:48.410

```
Console.WriteLine("Please input first number:")
Dim Num1 As String
Num1 = Console.ReadLine()

Console.WriteLine("Please input second number:")
Dim Num2 As String
Num1 = Console.ReadLine() ------ Use Num2 instead of Num1

Console.WriteLine("Please input third number:")
Dim Num3 As String
Num3 = Console.ReadLine()

Average = (Num1 + Num2 + Num3) / 3
Console.WriteLine("Your average is: ", Average) and use concat "&" here.
Console.WriteLine("Press any key to exit")
Console.ReadLine() 
```

# javascript - 使用 jquery/js 同时调整两个元素的大小

> ID：15233684
> 
> 赞同：0
> 
> 时间：2013-03-05T20:41:23.107
> 
> 标签：javascript, jquery, resize

我一直在尝试同时调整两个窗口的大小，但由于某种原因它不起作用。我试图捕捉错误，但什么也没有。

注意：我不想使用 jquery resize，因为它没有快速的 inteval 来检查调整大小

JAVASCRIPT：

```
function _u(e){
    try {
        e.parent('.boss').find('.first').width( e.width() ); //tried with parent('.boss').next('.first') or directy with prev('.first')
    } catch(err){alert(err);}
}

$(document).ready(function(){
    $(".data").each(function(){
        var resizerint;
        $(this).mousedown(function(){
            try {
                var eee = $(this);
                var resizerint = setInterval(function(){
                        try {
                            _u( eee );
                        } catch(err){alert(err);}
                    },10); // i need it 10ms
            } catch(err){alert(err);}

            $('.test').html('<font style="position:absolute;top:0;right:0;color:red;"> mouse DOWN </font>');
        }).mouseup(function(){
            try{
                clearInterval(resizerint);
                } catch(err){alert(err);}

            $('.test').html('<font style="position:absolute;top:0;right:0;color:green;"> mouse UP </font>');
        });
    });
}); 
```

和 HTML：

```
<div class="boss">
    <div class="first">
        <table>
            <tr>
                <td>
                    <div class="title">ONEEEEE</div>
                </td>
            </tr>
        </table>
    </div>
    <div class="second">
        <textarea class="data" > ONEEE TEXTY TESTY NJAMMM! </textarea>
    </div>
</div>

<div class="boss">
    <div class="first">
        <table>
            <tr>
                <td>
                    <div class="title">TWOOOOOO</div>
                </td>
            </tr>
        </table>
    </div>
    <div class="second">
        <textarea class="data" > TWOOO TEXTY TESTY NJAMMM! </textarea>
    </div>
</div>

<div class="text"></div> 
```

提前感谢您提供的任何帮助。

JSFIDDLE（如果你看到，在 TEXTAREA 鼠标按下时蓝色不会调整大小） [http://jsfiddle.net/2sfFW/](http://jsfiddle.net/2sfFW/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:04:46.227

我的第一个答案是缺少“$”，但它并没有解决问题。

它在某种程度上可以工作，但是您必须先单击文本字段才能初始化。我用你的蓝色版本作为可视化工具。

正确的jquery遍历是

```
 e.parent().parent('.boss').find('.first') 
```

或者

```
 e.parents('.boss').find('.first') 
```

您必须使用复数版本，因为它上面有两个父 div。使用 parent().parent() 更具体，但在这种情况下可能没有必要。

[http://jsfiddle.net/aQKVD/1/](http://jsfiddle.net/aQKVD/1/)

如果您删除 mouseup/mousedown 处理程序，它将在 document.ready 初始化，我认为这可能是您想要的。除非您有其他需要，否则您不一定需要清除变量，因为 .each() 会创建与相关特定 div 相关联的函数的单独实例。这是一个这样的版本：

[http://jsfiddle.net/aQKVD/2/](http://jsfiddle.net/aQKVD/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:03:01.367

没有在 JSfiddle 中修复它，但对于初学者来说，你已经省略了“$”。我已经建立了一个 JSfiddle 链接，以便其他人可以尝试。[http://jsfiddle.net/aQKVD/](http://jsfiddle.net/aQKVD/)

```
function _u(e){
try {
    e.parent('.boss').find('.first').width( e.width() ); //tried with parent('.boss').next('.first') or directly with prev('.first')
    } catch(err){alert(err);}
}

$(document).ready(function(){
   (".data").each(function(){ 
```

最后一行应该是

```
 $(".data").each(function(){ 
```

# ajax - asyncfileupload 完成上传后页面更新

> ID：15233686
> 
> 赞同：1
> 
> 时间：2013-03-05T20:41:31.330
> 
> 标签：ajax, updatepanel, postback, asyncfileupload

我经常看到这个问题被问到，并且我已经做了广泛的实验来尝试让它发挥作用。然而，到目前为止，其他所有人的例子和答案都让我失望了。我很困惑。情况如下：

*   AsyncFileUpload 不在 UpdatePanel 中
*   要更新的图像和标签在 UpdatePanel 中
*   上传完成后应进行更新

上传确实按预期保存文件。我的问题是在发生这种情况后让页面更新。上传的文件是一张图片，我希望更新该图片。我知道如果您重用文件名，图像在客户端上不会更新的一些问题，但我也将它打印到标签上以确保。我确定我所针对的 UpdatePanel 没有更新。

我尝试了以下方法：

*   使用服务器端方法手动更新有条件的 UpdatePanel - 这会失败，因为文件上传是在框架中完成的。嗅探返回的 HTML 表明正确的 HTML 实际上是在发布后发回的，但当然是发送到错误的帧。
*   使用客户端方法触发 javascript 回发到我的 UpdatePanel。这不起作用，我不知道为什么。
*   使用客户端方法触发更新面板内的 javascript 按钮单击。同样，什么也没发生，我不知道为什么。
*   设置 UpdatePanel 的触发器，使其直接指向 AsyncFileUpload。没有喜悦，但我知道那将是一个很长的镜头，记住隐藏的框架。
*   将 AsyncFileUpload 移动到 UpdatePanel 并尝试上述各种方法。当我这样做时，我失去了发布到服务器的文件的所有句柄，并且我一开始就无法保存文件。

通常，当我遇到这种错误时，所有教程似乎都是错误的，事实证明我的错误是因为我没有在某处的控件上设置 ID 并且它在某种程度上很重要。在这种情况下，我什至看不到这一点。这是一些代码。

```
<fieldset class="pj_Pics">
    <ul>
        <li>
            <label>Picture 1</label>
            <asp:UpdatePanel ID="ajax_Pic1" runat="server" UpdateMode="Always">
                <ContentTemplate>
                    <asp:Image ID="img_Pic1" runat="server" />
                    <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
                    <asp:Button ID="Button1" runat="server" Text="Button" />
                </ContentTemplate>
            </asp:UpdatePanel>
            <div style="position:relative;">
                <div class="photoChooser">
                    <ajaxToolkit:AsyncFileUpload ID="fu_Pic1" runat="server" CssClass="pj_PicChoose" Width="84px" OnClientUploadComplete="picPost1" OnUploadedComplete="fu_PictureFile_UploadedComplete" ThrobberID="throb1" />
                    <span><asp:Literal runat="server" Text="click to change"></asp:Literal></span>
                    <asp:Image ID="throb1" runat="server" ImageUrl="~/images/throbber.gif" AlternateText="uploading image" />
                </div>
            </div>
        </li>
    </ul>
</fieldset>

protected void fu_PictureFile_UploadedComplete(object sender, AjaxControlToolkit.AsyncFileUploadEventArgs e)
{
    bla bla bla;
    // and update the image
        img.ImageUrl = "~/" + webfolder + imageFileName;
        thing.Text = img.ImageUrl;
}

function picPost1(sender, args) {
    document.getElementById('<%# Button1.ClientID %>').click();
} 
```

非常感谢任何帮助。页面上显然有一个 ScriptManager，我展示的代码只是我尝试的最后一件事。让我知道您是否还有其他需要查看的内容。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-25T23:20:22.283

我今天碰巧遇到了同样的情况，这就是我解决它的方法。

根据此[LINK](https://stackoverflow.com/q/11138547/2399070)，自异步 FileUpload 以来没有发生回发，甚至没有发生 ViewState。

因此，在 OnUploadedComplete 中，我在代码隐藏中执行 SaveAs() 之前测试文件类型和大小，然后在 OnClientUploadComplete 中测试相同的内容以显示消息并进行其余工作，例如设置图像 URL。希望这可以帮助。

# javascript - 在 javascript 中打开一个 .sqlite3 文件

> ID：15233691
> 
> 赞同：0
> 
> 时间：2013-03-05T20:41:48.703
> 
> 标签：javascript, sql, sqlite

是否有任何 javascript 库可以`somefile.sqlite3`在 javascript 中打开文件，然后对其执行一组可预测的 SQL 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:49:46.417

我不知道任何可以打开的库，更不用说从浏览器查询 sqlite3 文件了。浏览器中的二进制数据支持乏善可陈，即使您完全跳过了打开文件的必要环节。

# windows-phone-7 - 如何安装 Windows Phone SDK 7

> ID：15233696
> 
> 赞同：0
> 
> 时间：2013-03-05T20:41:58.870
> 
> 标签：windows-phone-7, installation

我正在尝试在具有 Windows 7 Home Premium 操作系统的 PC 上安装 Windows Phone 7 SDK。我尝试安装该软件，但出现错误，提示我没有 Visual Studio 2010 Service Pack 1。我安装了 Service Pack，但仍然无法安装 Windows Phone SDK。这是否与我的操作系统是“家庭高级”这一事实有关？还是有任何其他原因应该有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:06:35.423

转到此处并下载适用于 Windows Phone 的 Visual Studio Express 2010。这应该是您需要的完整软件包

你不能只下载没有 Visual Studio 的 SDK

[http://www.microsoft.com/visualstudio/eng/downloads](http://www.microsoft.com/visualstudio/eng/downloads)

# javascript - Javascript 文本框值

> ID：15233701
> 
> 赞同：0
> 
> 时间：2013-03-05T20:42:21.443
> 
> 标签：javascript

我有一个颜色选择器：

HTML：

```
<input type="button" id="msg" name="msg" value="msg">
<label for="background-color">Choose a calor for background : </label>
<input id="background-color" type="color" value="#ff0000" onchange="javascript:document.getElementById('chosen-color').value = document.getElementById('background-color').value;"/>

<label for="chosen-color">You have chosen : </label>
<input id="chosen-color" type="text" value="#ff0000"/> 
```

Javascript：

```
document.getElementById('msg').addEventListener('click', function() {
          alert (colorPicker);
          }, false);

    //Color Picker    
    var colorPicker = (document.getElementById('chosen-color').value); 
```

当我单击消息框按钮时，消息框仅显示默认值 FF0000，即使它显示不同的值。如何让它显示实际值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:45:03.423

你永远不会真正更新`colorPicker`价值。

```
document.getElementById('msg').addEventListener('click', function() {
  alert (document.getElementById('chosen-color').value);
}, false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:47:20.400

试试这个：

```
document.getElementById('msg').addEventListener('click', function() {
          alert (colorPicker.value);
          }, false);

    //Color Picker    
    var colorPicker = (document.getElementById('chosen-color')); 
```

问题是您在 colorpicker 更改后没有更新它的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:04:08.820

`colorPicker`没有得到更新。您还应该考虑不使用`onchange=""`另一个事件侦听器并将其带入 javascript。

```
var colorPicker = document.getElementById('chosen-color');

document.getElementById('msg').addEventListener('click', function() {
            alert (colorPicker.value);
        }, false);

document.getElementById('background-color').addEventListener('change', function() {
            colorPicker.value = this.value;
        }, false); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-05T20:44:41.303

试试这个：

document.getElementById('#msg').addEventListener('click', function() { alert (colorPicker); }, false);

```
//Color Picker    
var colorPicker = (document.getElementById('#chosen-color').value); 
```

# mysql - Mysql query error sql syntax pdo

> ID：15233702
> 
> 赞同：0
> 
> 时间：2013-03-05T20:42:23.783
> 
> 标签：mysql, sql, syntax, pdo

This is mysql code im trying to run:

```
SELECT i.id, i.courseid, i.title, i.info, i.lasteditedby, u.id, u.forename, u.surname
FROM courseinformation as i JOIN users AS u ON (i.lasteditedby = u.id)
WHERE i.courseid = :courseid
ORDER BY i.id desc LIMIT 2; 
```

Im getting this error :

```
/* SQL Error (1064): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':courseid ORDER BY i.id desc LIMIT 2' at line 1 */ 
```

My aim is to get id, courseid, title, info, lasteditedby from CourseInformation table, and then Id, forename and surname from user table. Where the userid is the same as lasteditedby.

I really can't see what sql syntax is wrong as i've used

```
:courseid 
```

in other pdo sql querys that ive run

* * *

for reference, this is my php code with that sql in

```
 $courseid = 'G11111';
        $sql = "SELECT i.id, i.courseid, i.title, i.info, i.lasteditedby, u.id, u.forename, u.surname FROM courseinformation as i JOIN users AS u ON (i.lasteditedby = u.id) WHERE i.courseid = :courseid ORDER BY i.id desc LIMIT 2";
        $sql->bindParam(":courseid", $courseid);
                    $sql->execute();

        foreach ($db->query($sql) as $row) {
            echo '<div class="announceTitle">';
            echo $row['title'].'<br />';
            echo $row['forename'].' '.$row['surname'].'<br />';
            echo '</div>
                <div class="announceText">';
            echo $row['info'];
            echo '</div>
                <br />
                <br />';
        } 
```

Could anyone please point me in the direction as to what is wrong? Thanks for reading

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:49:56.540

您还没有创建语句句柄，而是创建了一个字符串。

本[教程](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)建议这样做：

```
$sth = $db->prepare("SELECT i.id, i.courseid, i.title, i.info, i.lasteditedby, u.id, u.forename, u.surname FROM courseinformation as i JOIN users AS u ON (i.lasteditedby = u.id) WHERE i.courseid = :courseid ORDER BY i.id desc LIMIT 2");
$sth->bindParam(":courseid", $courseid); 
```

稍后您执行此字符串时`$db->query`会出现错误，这表明您可能需要更好的示例来工作，因为这似乎是同时应用了一些相互矛盾的技术。

# search - Lucene 分析器的名字

> ID：15233703
> 
> 赞同：3
> 
> 时间：2013-03-05T20:42:27.583
> 
> 标签：search, solr, lucene, elasticsearch

是否有一个 Lucene 分析器可以用它们的短名称等价物（例如 Mike 和 Michael、Rich 和 Richard、Suzie 和 Susan）等来标记名称部分？

Levenshtein 距离的模糊匹配是我知道的一个解决方案，一些实现者似乎将模糊匹配与 soundex 算法配对。肯定有人轻描淡写地在某处简单地列出所有这些短名称？

编辑：这个问题最难的部分是从哪里获取同义词数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T23:03:28.980

我不知道那里有任何特定的昵称过滤器。

但是，如果您有数据源， [SynonymFilter](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/synonym/SynonymFilter.html)将使其相当容易生成。这似乎是昵称数据的一个很好的来源：

[https://code.google.com/p/nickname-and-diminutive-names-lookup/](https://code.google.com/p/nickname-and-diminutive-names-lookup/)

您需要生成`SynonymMap`传递给 ctor 的`SynonymFilter`ctor，它应该看起来像这样（我认为）：

```
SynonymMap.Builder builder = new SynonymMap.Builder(true);
builder.add(new CharsRef("Mike"), new CharsRef("Michael"), false);
builder.add(new CharsRef("Rich"), new CharsRef("Richard"), false);
builder.add(new CharsRef("Suzie"), new CharsRef("Susan"), false);
SynonymMap map = builder.build(); 
```

# login - Active Directory Check With Login

> ID：15233711
> 
> 赞同：0
> 
> 时间：2013-03-05T20:42:43.347
> 
> 标签：login, active-directory, joomla2.5

I've created a login control for my company's site and want it to check the user names against the already created active directory on my server(some 700 names) I have the LDAP connection string but for the life of me I can't figure out how I should be using it(noobie problem I'm sure). Looking for a point in the right direction before I start bashing holes in the wall. Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:28:58.467

看看这里： http: [//ourlife01.blogspot.de/2012/03/connect-to-ad-using-joomla-25.html](http://ourlife01.blogspot.de/2012/03/connect-to-ad-using-joomla-25.html)

这是你想要的？

# enumerable - How do you put multiple values into one variable or field without using a list and then parsing?

> ID：15233715
> 
> 赞同：0
> 
> 时间：2013-03-05T20:43:02.590
> 
> 标签：enumerable, multivalue

Sometimes there is a need to have multiple values in one variable or database field, even though that violates relational normalization principles. In python and other languages that support lists, that's easy. In others it is not. See [insert multiple values in single attribute](https://stackoverflow.com/questions/11822321/insert-multiple-values-in-single-attribute)

One common technique is to concatenate values into a comma delimited string: "1,2,3" or "English,French,Spanish" and then extracting values by parsing.

When the valid values come from an enumerated list, is there another way that does not require parsing?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:43:02.590

Yes. Use prime numbers, multiply them together, then factor them out.

1.  The field type to use is integer or large integer

2.  Use code values that are prime numbers
    *   3 == English
    *   5 == French
    *   7 == Spanish
    *   11 == Italian

3.  Store the product of all that apply into the field.
    *   21 == English and Spanish
    *   385 == French, Spanish and Italian

4.  Use modulo functions to determine which values are in the field

    ```
    if ( field % 3 == 0 ) {  english() ;}
    if ! (field % 5) { french() ;}
    =IF(NOT(MOD(A203,5)),"French","") 
    ```

5.  The same value can appear multiple times
    *   9 == English, English

I first used this technique to store dimensions.

*   3 == time
*   5 == length
*   7 == mass
*   11 == charge
*   13 == temperature
*   17 == moles

For example, a "first moment" lever-arm would have a dimension value of 35 == mass * length. To store fractional dimensions in an integer, I multiplied fractional dimensions by the product of all of them and dealt with it in processing.

*   255255 == 3*5*7*11*13*17
*   force == mass * length / (second^2)
*   force == ( 7 * 5 / ( 3 * 3 ) ) * 255255 * 255255
*   force == 253381002875

The reason I used integers was to avoid dealing with invalid equality comparisons due to rounding errors.

Please do not ask for the code to extract the fractional dimensions. All this was 40 years ago in APL/360.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:59:44.280

如果您不需要允许相同值的倍数，那么您可以使用位图。根据是否有多达 8、16、32、64 或 128 个允许值，它们可以适合 1、2、4、8 或 16 字节整数。

# asp.net-mvc - MVC 4 application render time with Visual Studio 2012

> ID：15233726
> 
> 赞同：0
> 
> 时间：2013-03-05T20:43:41.943
> 
> 标签：asp.net-mvc, visual-studio-2012

When I run my mvc application using Visual Studio 2012 on Chrome, my page takes 36s to render - saw this using mini-profiler. When I host the project on a remote server and hit the server for the page, then it takes 36s on the first hit. But on subsequent hits, it dramatically reduces to 1s or less. Any thoughts on why this might be? On the remote server, when we restart the application pool, we are seeing it take 36s.

So question is, is it taking that long because of IIS allocating resources to the site or is there something else wrong with our setup? Our development time is really taking a hit with the amount of time that it takes each time we have to debug our project. Build and then takes 36s each time to render the page we are debugging.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:18:18.180

当您说“运行”时，我假设您的意思是调试。Debug 重新构建项目，然后一旦加载浏览器，每次都必须完成第一次加载的所有标准初始化。与服务器上的应用程序池启动所需的时间相同（36 秒）这一事实似乎证明了这一点。

FWIW，您只需*在*每个 Visual Studio 会话中调试您的项目一次，即可启动 IIS Express。之后，您可以简单地重新构建项目并在之后直接刷新浏览器（无需在 Visual Studio 中使用调试）来测试您的更改。而且，仅当您对任何 *.cs 文件进行了更改时才需要重新构建。Razor 视图、web.config 等将在下一页加载时反映它们的更改，而无需重建。这样做你唯一失去的就是调试能力，很明显。您只会得到一个标准的死亡黄页，而不是自动跳转到 Visual Studio 中的违规代码。但是，我发现除非我真的需要调试，否则这种方法的开发速度要快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:51:49.413

想到了几种可能性：

**查看汇编**

默认情况下，当您在 Visual Studio 中处理项目时，视图是按需编译的。虽然 36 秒似乎需要*很*长的时间来编译第一页的视图，但这可能是一个促成因素。如果您的页面发生更改，则必须重新编译。要在执行测量时消除此因素，您可以使用文本编辑器编辑 .csproj 文件并更改行

```
<MvcBuildViews>false</MvcBuildViews> 
```

至

```
<MvcBuildViews>true</MvcBuildViews> 
```

（这通常也是一个有用的设置）。

**其他初始化开销**

如果您在应用程序启动时进行大量初始化（可能从文件或数据库中预加载一些数据），则每次 Web 服务器启动或应用程序域回收时都必须进行初始化。在 Visual Studio 中，我发现 Web 服务器可以在令人惊讶的（对我而言）时间重新启动。添加一些日志以查看您是否在特定基准运行期间运行启动代码，并查看有多少开销。

**实体框架**

出于某种原因，Entity Framework在调试时运行速度要慢得多*。*如果您通过 EF 进行大量数据访问，这可能会造成一些差异。

# php - 将一个查询的结果用作 WHERE 子句

> ID：15233733
> 
> 赞同：-1
> 
> 时间：2013-03-05T20:44:10.897
> 
> 标签：php, json, phpmyadmin

我正在尝试使用一个查询获取邮政编码，并将其用于另一个查询的 where 子句。

```
<?php
$mobile = '07790807055';
//$mobile = $_POST['mobile'];

mysql_connect("", "", "") or die(mysql_error());
mysql_select_db("") or die(mysql_error());

$query =("SELECT POSTCODE FROM appregistration WHERE MOBILE_NUMBER = '$mobile'");
$result = mysql_query ($query) or die ("Unable to connect. " . mysql_error());
$row = mysql_fetch_array($result);
$postcode = $row['POSTCODE'];
/// gets postcode from appregistration table 

$sql=mysql_query("SELECT INCIDENT_ID, INVESTIGATION,TYPE_OF_INCIDENT,DESCRIPTION FROM appreports WHERE POSTCODE = '$postcode'");
//uses postcode from ppregistration table  to find info from appreports table 

while($row=mysql_fetch_assoc($sql)) $output[]=$row;

print(json_encode($output));

mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:50:01.927

为什么不使用`JOIN`而不是运行两个查询：

```
SELECT `INCIDENT_ID`, `INVESTIGATION`, `TYPE_OF_INCIDENT`, `DESCRIPTION`
FROM `appreports`
INNER JOIN `appregistration` ON `appreports`.`POSTCODE` = `appregistration`.`POSTCODE`
WHERE `appregistration`.`MOBILE_NUMBER` = '$mobile' 
```

例如：

```
<?php
$mobile = '07790807055';

mysql_connect("", "", "") or die(mysql_error());
mysql_select_db("") or die(mysql_error());

$sql = mysql_query("SELECT `INCIDENT_ID`, `INVESTIGATION`, `TYPE_OF_INCIDENT`, `DESCRIPTION`
                    FROM `appreports`
                    INNER JOIN `appregistration` 
                    ON `appreports`.`POSTCODE` = `appregistration`.`POSTCODE`
                    WHERE `appregistration`.`MOBILE_NUMBER` = '$mobile'");

while($row=mysql_fetch_assoc($sql))
{
    $output[] = $row;
}

print(json_encode($output));

mysql_close();
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:54:17.133

撇开明显的 SQL 注入漏洞、代码中可疑的注释（多余的标点符号）、不推荐使用的 API 和对 mysql_fetch_array() 调用中默认参数的依赖、不必要的拆分查询以及其他一些应该注意的事情不谈在任何代码审查中都被选中，但实际上并不会影响功能……您实际上并没有说出运行代码时会发生什么。

第一个查询是否返回结果？

当您通过 mysql CLI 或 phpmyadmin 运行查询时会发生什么？

**更新**

> 如果我使用 join "Parse error: syntax error, unexpected '`' on line 20，这就是我遇到的错误

好的，这*是*导致问题的 SQL 注入错误 - 我假设这是第 20 行：

```
$sql=mysql_query("SELECT INCIDENT_ID, INVESTIGATION,TYPE_OF_INCIDENT
      ,DESCRIPTION FROM appreports WHERE POSTCODE = '$postcode'"); 
```

$postcode 包含一个或多个单引号。逃脱它：

```
 $sql=mysql_query("SELECT INCIDENT_ID, INVESTIGATION,TYPE_OF_INCIDENT
      ,DESCRIPTION FROM appreports WHERE POSTCODE = '".
      mysql_real_escape_string($postcode) . "'"); 
```

# javascript - PostgreSQL 字符串比较

> ID：15233735
> 
> 赞同：5
> 
> 时间：2013-03-05T20:44:18.060
> 
> 标签：javascript, python, postgresql, string-comparison

我想做一个查询来获取所有带有字符串“id”>指定id的项目。

查询`select * from machine_thread where id > 'znRb1c_3TPytk-JoPX19Qw'`返回一个带有 id 的项目`zT4GabH3Qy2W6YIGh8Ku-w`

在我使用的其他语言（python、javascript）中，字符串比较将显示 `'znRb1c_3TPytk-JoPX19Qw'` 大于`'zT4GabH3Qy2W6YIGh8Ku-w'`. postgresql 有什么不同，无论如何我可以在所有环境中使用相同的比较来比较字符串 ID？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T20:56:42.790

这是因为`COLLATE`使用的是 PostgreSQL。

执行`SHOW LC_COLLATE`以查看您使用的排序规则。

您想要的排序规则（python 和 javascript 正在使用的那个）是`"C"`.

例子[`here`](http://sqlfiddle.com/#!12/d41d8/554)

细节[`here`](http://www.postgresql.org/docs/current/static/collation.html)

# c# - Redefine properties with arguments

> ID：15233737
> 
> 赞同：0
> 
> 时间：2013-03-05T20:44:24.803
> 
> 标签：c#, properties

I define a class property algorithm as follows:

```
public InputParametersProperty InputParameters { get; set; }

public class InputParametersProperty
{
    private Dictionary<string, object> inputParameters = new Dictionary<string, object>();
    public object this[string name]
    {
        get { return inputParameters[name]; }
        set
        {
            if (inputParameters == null)
                inputParameters = new Dictionary<string, object>();
            else
                inputParameters.Add(name, value);
        }
    }
} 
```

From another class I want to use the property of the form:

```
algorithm.InputParameters["populationSize"] = 100; 
```

But I get the error: `Object reference not set to an instance of an object`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:49:01.067

您永远不会将 InputParameters 属性实例化为任何东西。这就是你开始的原因`NullReferenceException`。

改变：

```
public InputParametersProperty InputParameters { get; set; } 
```

至：

```
private InputParametersProperty _inputParameters;
public InputParametersProperty InputParameters
{
    get
    {
        return _inputparameters ?? (_inputparameters = new InputParametersProperty()); 
    }
} 
```

# python - `import _preamble` 在 Python 中有什么作用？

> ID：15233740
> 
> 赞同：4
> 
> 时间：2013-03-05T20:44:32.793
> 
> 标签：python, import, twisted, twistd

`twistd.py`我注意到 Twisted脚本顶部的以下内容：

```
import os, sys

try:
    import _preamble
except ImportError:
    sys.exc_clear()

sys.path.insert(0, os.path.abspath(os.getcwd())) 
```

做什么`import _preamble`？我似乎在 google-mage 上找不到任何对它的引用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:49:20.540

`_preamble`是一个和其他任何模块一样的模块。在 twisted 的情况下，这只是设置[的模块](http://twistedmatrix.com/trac/browser/trunk/bin/_preamble.py)，[`sys.path`](http://docs.python.org/3/library/sys.html#sys.path)以便您可以在开发设置中运行 twisted。

# ios - Xcode - 从服务器（如 time.is）获取当前日期和时间并将其转换为 NSDate

> ID：15233742
> 
> 赞同：0
> 
> 时间：2013-03-05T20:44:43.690
> 
> 标签：ios, time

我不想从用户设备获取当前日期，因为用户可以编辑日期。

我想从 time.apple.com 或 time.is 等服务器获取当前日期和时间，然后将其转换为 NSDate。如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:00:01.967

您可以首先通过点击 url 以字符串的形式获取日期（如果 web 服务将其作为字符串提供）。然后使用日期格式化程序，您可以将字符串转换为`NSDate`.

例如：

```
NSURL *url = [NSURL URLWithString:@"http://yourtimeurl"];
NSString *str = [[NSString alloc] initWithContentsOfURL:url usedEncoding:Nil error:Nil]; 
```

假设您以 dd-MM-yyyy 格式获取日期，那么

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
dateFormatter.dateFormat =@"dd-MM-yyyy";
NSDate *date = [dateFormatter dateFromString:str]; 
```

但很可能当你点击你的 url 时，你可能会得到一些数据结构，比如你必须解析的 json。并且很可能不会以上述格式返回日期。但现在你知道如何前进了。进行适当的更改。

也是`initWithContentsOfURL:`同步调用。建议您`NSURLConnection`为此使用 a 并对您的 Web 服务进行异步调用。

这可能有用： [http](http://www.earthtools.org/webservices.htm#timezone) ://www.earthtools.org/webservices.htm#timezone --xmlresponse
[http://www.timeapi.org/utc/now](http://www.timeapi.org/utc/now) --string

# java - throwable 不会编译

> ID：15233750
> 
> 赞同：0
> 
> 时间：2013-03-05T20:45:10.743
> 
> 标签：java

首先我必须说我阅读了以下内容： http: [//docs.oracle.com/javase/tutorial/essential/exceptions/index.html](http://docs.oracle.com/javase/tutorial/essential/exceptions/index.html)！

我尝试编译时得到的错误如下：

```
TestException.java:14: error: incompatible types

static void doRisky(String test) throws ScaryException
                                                ^
required: Throwable
found:    ScaryException

TestException.java:19: error: incompatible types
                        throw new ScaryException();
                                      ^
required: Throwable
found:    ScaryException

TestException.java:34: error: incompatible types
                catch ( ScaryException  se)
                        ^
  required: Throwable
  found:    ScaryException

3 errors 
```

我假设错误消息给了我某种类型的提示，但我只是不明白它是什么。

```
import java.lang.*;
/** add this as to get it to compile */
class ScaryException extends Exception
{
/** how come I can't put code here? */
}

public class  TestException {

    static void doRisky(String test) throws ScaryException{
        System.out.println ("start risky");    
        if ("yes".equals(test)) {
            throw new ScaryException();
        }
        System.out.println("end risky");
    }

    public static void main(String [] args){
        String test = "no";
        try{
            System.out.println("start try");
            doRisky(test);
            doRisky("yes");
            System.out.println("end try");
        }
        catch ( ScaryException  se){
            System.out.println("Got What " + se);
        }
        finally{
            System. out. println( "finally") ;
        }

        System.out.println("end of main");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:47:10.180

Java 异常必须扩展`Throwable`（直接扩展，或者最好通过扩展`Exception`或其子类之一间接扩展）。显然你的`ScaryException`班级没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:47:24.157

要编译，`ScaryException`必须是扩展的类`Throwable`或其子类之一。要么`ScaryException`根本不存在，要么不扩展任何`Throwable`' 子级。

# jquery - pinterest jquery ajax

> ID：15233753
> 
> 赞同：0
> 
> 时间：2013-03-05T20:45:20.727
> 
> 标签：jquery, ajax, pinterest

我一直在尝试 Pinterest 风格的布局，并通过之前的 StackOverflow 讨论找到了这个网站： [http ://benholland.me/javascript/how-to-build-a-site-that-works-like-pinterest/。](http://benholland.me/javascript/how-to-build-a-site-that-works-like-pinterest/)

当在 HTML 中创建 .block 类时，让它工作没有问题，但我现在正试图让块在 ajax 调用的成功函数中创建 .block 类时显示。

我实际上有一些工作，但真的不确定这是否是这样做的方法。

我在 document.ready 上触发 ajax 调用，然后像这样在 window.load 上准备块（Ben Hollands 代码）......

```
$(document).ready(function() {
start();

function start() {
    url="path/to/json/data";
    $.ajax({
        type: "POST",
        url: url,
        dataType: "json",
        cache: false,
        success: function(response){
            var result='';
            $.each(response, function(k, v){                
                result += '<div class="block">' + v.text + '</div>';
            });

            $(".blocks").html(result);
        }
    });
}
}); 
```

接着...

```
$(window).load(function() {
var colCount = 0;
var colWidth = 0;
var margin = 10;
var spaceLeft = 0;
var windowWidth = 0;
var blocks = [];
setupBlocks();

function setupBlocks() {
    windowWidth = $(window).width();
    blocks = [];

    colWidth = $('.block').outerWidth();

    // Calculate the margin so the blocks are evenly spaced within the window
    colCount = Math.floor(windowWidth/(colWidth+margin*2));
    spaceLeft = (windowWidth - ((colWidth*colCount)+(margin*(colCount-1)))) / 2;

    for(var i=0;i<colCount;i++){
        blocks.push(margin);
    }
    positionBlocks();
}

function positionBlocks() {
    $('.block').each(function(i){
        var min = Math.min.apply(Math, blocks);
        var index = $.inArray(min, blocks);
        var leftPos = margin+(index*(colWidth+margin));
        $(this).css({
            'left':(leftPos+spaceLeft)+'px',
            'top':min+'px'
        });
        blocks[index] = min+$(this).outerHeight()+margin;
    }); 
}   
}); 
```

你觉得呢？

# javascript - 启用文本框并使其可编辑

> ID：15233756
> 
> 赞同：0
> 
> 时间：2013-03-05T20:45:22.723
> 
> 标签：javascript, html, css, jsp, dojo

我的 jsp 文件中显示了一个文本框字段，它看起来总是被禁用且不可编辑。我想在一个条件下启用和编辑它。

因此，当满足上述条件时，我会将保存该字段的页面保存在数据库中。我只想启用文本框并且该字段可编辑。我的代码如下，

```
 <li class="Textbox"><input type="text"
                                            dojoType="dijit.form.NumberTextBox" name="field name"
                                                id="EDIT21" style="width: 45px;" size="4" maxlength="3"
                                            value="${value of an expression}"
                                            onchange="Config1.updateStatus();" required="true"
                                            constraints="{min:1,max:999}" 
                                            rangeMessage="<spring:message code='validation.' arguments='1,999' />" />
                                    </li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:54:39.293

该代码中没有任何内容会导致文本框的行为如此。听起来您要么有一些 javascript 禁用了文本框，要么有一些 CSS 使它看起来好像被禁用了，即使它不是。如果是 Javascript，请查找设置 disabled 属性的行，例如

```
document.getElementById('EDIT21').disabled = true; 
```

或者

```
document.getElementbyId('EDIT21').contentEditable = false; 
```

# tcp - tcp 连接哪个更快？

> ID：15233762
> 
> 赞同：0
> 
> 时间：2013-03-05T20:45:33.597
> 
> 标签：tcp, boost-asio

一个快速的问题：

我正在使用 boost:asio (tcp) 通过网络发送数据。哪个会更快：使用流缓冲区，还是手动将数据作为数据包分割和发送？

特别是，如果要传输的数据大小通常超过 100mb 怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T08:55:46.953

“更快”可能意味着 2 个不同的东西：

1.  最小延迟。这意味着最小化客户端生成和接收数据包数据之间的时间。在这种情况下，它“更快”地在具有 TCP_NODELAY 选项的套接字上手动制作数据包。

2.  最大化带宽速度。这意味着您希望以最大 Mb/s 速度传输数据（例如文件）。在这种情况下，最好禁用 TCP_NODELAY 并发送数据[sendfile(2)](http://linux.die.net/man/2/sendfile)。

现在关于 boost::asio。这也是为了最小化延迟，您也设置了 TCP_NODELAY 选项（[示例](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio/reference/ip__tcp/no_delay.html)）。为了获得最大的总传输速度，最好关闭此选项并使用流缓冲区，或者通过**native_handle()**获取本机句柄并在其上使用 sendfile（在这种情况下，需要做更多工作以使其“好”异步）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T03:02:06.510

你想得越多，你就越会妨碍 TCP 的工作，它的性能也会越差。只需使用尽可能大的缓冲区来流式传输数据。

# java - Spring bean定义的优先级是什么？

> ID：15233766
> 
> 赞同：23
> 
> 时间：2013-03-05T20:45:46.643
> 
> 标签：java, spring

当定义了几个同名的 Spring bean 时，哪个会隐藏其他的？

假设我`@Component("bean")`在包 org.example 中有几个用注释的类，以及一个 applicationContext.xml，其中包含：

```
<context:component-scan base-package="org.example"/>
<alias name="aliasedBean" alias="bean"/>
<bean id="aliasedBean" class="org.example.AliasedBean"/>
<bean id="bean" class="org.example.XmlBean"/>
<import resource="otherApplicationContext.xml"/> 
```

当我执行 ? 时将检索哪个 bean `applicationContext.getBean("bean")`？

根据[Spring 文档](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/beans.html#beans-beanname)：

> 每个 bean 都有一个或多个标识符。这些标识符在承载 bean 的容器中必须是唯一的。

但是，我知道（因为我测试过）当这完成时 Spring 不会抱怨。一个定义将隐藏其他定义。但我找不到规则是什么。

我想这样做是为了测试。我使用基于注释的配置来定义真正的（生产）bean。然后我想使用特定于测试的 XML 配置文件来覆盖这些定义并注入模拟 bean。

编辑：由于您有几个要求日志，我花了一些时间创建一些。他们是这样的：

```
 0 INFO  org.springframework.context.support.ClassPathXmlApplicationContext - Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@3934f69a: startup date [Wed Mar 06 23:04:35 CET 2013]; root of context hierarchy
 45 INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [applicationContext.xml]
223 INFO  org.springframework.beans.factory.support.DefaultListableBeanFactory - Overriding bean definition for bean 'bean': replacing [Generic bean: class [org.example.AnnotatedBean]; scope=singleton; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in file [/Users/etienne/Documents/Développement/Registre/workspace/SpringPrecedence/target/classes/org/example/AnnotatedBean.class]] with [Generic bean: class [org.example.XmlBean]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [applicationContext.xml]]
223 INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [otherApplicationContext.xml]
246 INFO  org.springframework.beans.factory.support.DefaultListableBeanFactory - Overriding bean definition for bean 'bean': replacing [Generic bean: class [org.example.XmlBean]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [applicationContext.xml]] with [Generic bean: class [org.example.ImportedXmlBean]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [otherApplicationContext.xml]]
290 INFO  org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@6aba4211: defining beans [bean,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,aliasedBean,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy
290 INFO  org.example.AliasedBean - Construction of AliasedBean.
302 INFO  org.example.Main - Application context loaded.
302 INFO  org.springframework.context.support.ClassPathXmlApplicationContext - Closing org.springframework.context.support.ClassPathXmlApplicationContext@3934f69a: startup date [Wed Mar 06 23:04:35 CET 2013]; root of context hierarchy
302 INFO  org.springframework.beans.factory.support.DefaultListableBeanFactory - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@6aba4211: defining beans [bean,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,aliasedBean,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy 
```

经过一些测试，我发现在创建上下文时会出现异常，如果：

*   我有两个`@Component("bean")` *或*
*   我在*同一个*XML 文件中有两个`<bean id="bean"/>`元素。

 ** * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-05T23:49:00.307

*   bean 按照在 xml 定义文件中找到的顺序注册。

*   扫描的 bean 在找到 xml 标记时注册，但扫描的 bean 不能覆盖以前注册的 bean 定义。

*   `DefaultListableBeanFactory.allowBeanDefinitionOverriding`如果为 true（默认情况下），XML bean 定义可以覆盖任何以前的 bean 定义。

所以 XML 获胜。

如果您首先放置组件扫描标记，xml bean 将覆盖扫描的那些。如果你把它放在最后，扫描的 bean 将被忽略。

**编辑**

如果在 bean 定义中的 name 属性中声明或使用别名标记声明，则别名具有不同的行为。

*   使用 alias 标记声明的 aliases 隐藏了任何以后具有相同名称的 bean 定义。
*   在 name 属性中声明的别名通过抛出`BeanDefinitionParsingException`.

例如：

```
 <bean id="foo" name="bar" class="Foo" />
 <bean id="bar" class="Bar" />   -- throw Exception (name bar is in use) 
```

但

```
<bean id="foo" class="Foo" />
<alias name="foo" alias="bar" />
<bean id="bar" class="Bar" /> -- Hidden by alias no exception thrown 
```

不同之处在于，`BeanDefinitionParserDelegate`在 bean 元素嵌套的同一 bean 级别保存名称和别名列表，并在解析 bean 定义时检查名称的唯一性。

别名标记由直接处理`DefaultBeanDefinitionDocumentReader.processAliasRegistration()`，解析器委托不知道此名称。

I don't know if it's a bug or intentional but [reference](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-beanname-alias) does not say anything about and seem to be expected that the internal and external declarations of aliases have the same behavior.*

# python - 如何获取列表中的列表索引？

> ID：15233767
> 
> 赞同：3
> 
> 时间：2013-03-05T20:45:46.593
> 
> 标签：python

```
list = ["word1", "word2", "word3"]
print list.index("word1") 
```

这很好用！

但我如何获得这个索引：

```
list = [["word1", "word2", "word3"],["word4", "word5", "word6"]]
print list.index("word4") 
```

好吧，那不起作用，错误：

```
ValueError: "word4" is not in list 
```

我期待一个像`1,0`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:52:53.280

尝试这样的事情：

```
def deep_index(lst, w):
    return [(i, sub.index(w)) for (i, sub) in enumerate(lst) if w in sub]

my_list = [["word1", "word2", "word3"],["word4", "word5", "word6"]]
print deep_index(my_list, "word4")
>>> [(1, 0)] 
```

这将返回一个元组列表，其中第一个元素指向外部列表中的索引，第二个元素指向该子列表中单词的索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:01:36.747

对于多维索引，假设您的数据可以表示为 NxM（而不是一般的列表列表），numpy 非常有用（而且速度很快）。

```
import numpy as np
list = [["word1", "word2", "word3"],["word4", "word5", "word6"]]
arr = np.array(list)
(arr == "word4").nonzero()
# output: (array([1]), array([0]))
zip(*((arr == "word4").nonzero()))
# output: [(1, 0)] -- this gives you a list of all the indexes which hold "word4" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:49:19.010

我认为您必须手动找到它-

```
def index_in_list_of_lists(list_of_lists, value):
   for i, lst in enumerate(list_of_lists):
      if value in lst:
         break
   else:
      raise ValueError, "%s not in list_of_lists" %value

   return (i, lst.index(value))

list_of_lists = [["word1", "word2", "word3"],["word4", "word5", "word6"]]
print index_in_list_of_lists(list_of_lists, 'word4') #(1, 0) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T20:54:50.450

```
def get_index(my_list, value):
    for i, element in enumerate(my_list):
        if value in element:
            return (i, element.index(value))
    return None

my_list= [["word1", "word2", "word3"], ["word4", "word5", "word6"]]
print get_index(my_list, "word4") 
```

打印 (1, 0)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-05T21:01:34.133

将来，尽量避免命名你的变量`list`，因为它会覆盖 Python 的内置`list`.

```
lst = [["word1", "word2", "word3"],["word4", "word5", "word6"]]

def find_index_of(lst, value):
   for index, word in enumerate(lst):
      try:
        inner_index = word.index(value)
        return (index, inner_index)
      except ValueError:
        pass
   return () 
```

这循环遍历 的每个元素，`lst`它将：

*   尝试获取`index`. `value`如果我们找到了元素，那么让我们返回索引。
*   但是，如果 Python 抛出 a `ValueError`（因为该元素不在列表中），那么让我们继续下一个列表。
*   如果没有找到，则返回一个空元组。

输出：

```
find_index_of(lst, 'word4') # (1, 0)
find_index_of(lst, 'word6') # (1, 2)
find_index_of(lst, 'word2') # (0, 1)
find_index_of(lst, 'word78') # () 
```

# javascript - 使用 jquery 从列表中添加和删除类

> ID：15233772
> 
> 赞同：3
> 
> 时间：2013-03-05T20:46:03.320
> 
> 标签：javascript, jquery

我有一个无序的 HTML 列表，例如：

```
<ul>
    <li class="current"></li>
    <li></li>
    <li></li>
</ul> 
```

使用 jquery，我想自动从第一个 li 元素中删除当前类并将其添加到第二个类中。不久之后，我想从第二个 li 元素中删除该类并将其添加到第三个元素中。我也想重复一遍。

到目前为止我有这个，但这根本不是我需要的：

```
 $("ul li:first-child").addClass('current').delay(1000).queue(function(next){
    $(this).removeClass('current');
    $(this).next().addClass('current')
    next();
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:48:24.333

如果您希望能够停止和启动它：

```
var myInterval;
var myFunc = function() {
        var cur = $('ul li.current');
        if(cur.index() == $('ul li').length - 1) {
            cur.removeClass('current');
            $('ul li:first').addClass('current');
        } else {
            cur.removeClass('current').next().addClass('current');
        }
    };
//Start Interval
myInterval = setInterval(myFunc, 1000); 
```

然后，停止/启动：

```
clearInterval(myInterval);
myInterval = setInterval(myFunc, 1000); 
```

[jsFiddle](http://jsfiddle.net/nJgzG/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:52:07.043

```
var $li = $('ul li'), i = 0;

setInterval(function(){
    i++;
    if( $li.length === i ) i = 0;
    $li.removeClass('current').eq(i).addClass('current')
}, 1000); 
```

[http://jsfiddle.net/mr7J6/](http://jsfiddle.net/mr7J6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:50:37.730

试试这个：

```
var idx = 1;
setInterval(function () {
    $('ul li').removeClass('current').eq(idx).addClass('current');
    idx++;
    if (idx == $('ul li').length) idx = 0;
}, 1000); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/QH9gb/2/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T20:55:56.147

```
$(function(){ 
   move();
 });

function move(){
    $("ul li.current").delay(1000).queue(function(next){
        $(this).removeClass('current');
        if($(this).next().addClass('current').length){
           move();
         } 

     });
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T20:55:57.457

如果您需要它环绕，您可以使用模数运算符来完成，如下所示：

```
$(document).ready(function() {
    var targets = $('ul li');
    var len = targets.length;
    var i = 0;
    setInterval(function() {
        // remove from current
        $('li.highlight').removeClass('highlight');
        i = (i + 1) % len;
        targets.eq(i).addClass('highlight');
    }, 1000);
}); 
```

[**演示**](http://jsfiddle.net/wYJ28/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-05T12:42:53.093

使用 jQuery click 事件添加和删除类无序列表当前类。**

> 工作示例

**

```
$(document).on('ready', function() {

      $('.list-1 li').each(function(){
			var t = $(this);
			t.find('a').click(function(){
				$('li.current').removeClass('current');
				t.addClass('current');
			});

		});

    });
```

```
 .list-1 li a{text-decoration:none; color:#444; background:#ddd; padding:5px 15px 10px;}
	.list-1 li.current a{background:tomato; color:#fff;}
  .list-1{display:flex; flex-wrap:wrap;min-width:140px}
   .list-1 li{padding:5px;margin:0 0 15px;display:block;}
```

```
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <ul class="list-inline list-1">
		<li class="current"><a href="#">Exapmle 1</a></li>
		<li><a href="#">Exapmle 2</a></li>
		<li><a href="#">Exapmle 3</a></li>
		<li><a href="#">Exapmle 4</a></li>
		<li><a href="#">Exapmle 5</a></li>
		<li><a href="#">Exapmle 6</a></li>
		<li><a href="#">Exapmle 7</a></li>
		<li><a href="#">Exapmle 8</a></li>
		<li><a href="#">Exapmle 9</a></li>
	</ul>
```

# php - 使用 PHP 解析表单 JSON 输出

> ID：15233774
> 
> 赞同：0
> 
> 时间：2013-03-05T20:46:11.690
> 
> 标签：php, json

如何在 PHP 中解析下面的 json 请求以提取特定值（在 value 中），如下所示：studentName、studentemail 和 courseName？每个请求只有一个条目，我不需要其余的值。我需要将这些存储为要写入 MYSQL 的 PHP 变量。解析是我遇到麻烦的地方

见下面的 json

```
 {"count":7,"data":[{"name":"Timestamp","ordinal":0,"value":"3/5/2013 2:45:31 PM"},{"name":"studentName","ordinal":1,"value":"mikejones"},{"name":"studentEmail","ordinal":2,"value":"mikejones%40gmail.com"},{"name":"courseName","ordinal":3,"value":"Grade%20Test"},{"name":"cpQuizInfoPassFail","ordinal":4,"value":"Fail"},{"name":"cpInfoPercentage","ordinal":5,"value":"75"},{"name":"institutionCode","ordinal":6,"value":"1212"}]}{"count":0}{"subject":"Course Transcript","footer":"Thank you for your participation!","footerURL":"https://sites.google.com/site/test393223837/googleformsdemotranscript/footerLogo.jpg","correctURL":"http//abc.com,"enabled":true,"correctResponseText":"Correct Response","showCorrectAnswers":true,"description":"Please keep this for your records as proof of course completion and certification.","incorrectURL":"https://sites.google.com/site/test3232393837/_/rsrc/1342229575450/googleformsdemotranscript/redX.png","fromName":"The Training Team","replyTo":"","headerURL":"https://sites.google.com/site/test3938232337/googleformsdemotranscript/CaptivateDev.jpg","isHTML":true,"title":"Course Transcript","to":"joe@gmail.com","userResponseText":"Your Response"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:49:27.090

您可以使用 json_decode 函数，将 json 代码解析为 php 对象和数组。有关更多信息，请参阅文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:51:08.890

一个问题是您的 json 无效。检查：

[http://jsonlint.com/](http://jsonlint.com/) 或
[http://jsonformatter.curiousconcept.com/](http://jsonformatter.curiousconcept.com/)

# meteor - Meteor 中如何进行日期分隔查询？

> ID：15233776
> 
> 赞同：1
> 
> 时间：2013-03-05T20:46:19.917
> 
> 标签：meteor

在 Meteor 0.5.5 之前，我能够做到这一点。

```
var query = {};
var ts = new Date();
query.start_date = { $lte: ts };
query.end_date = { $gte: ts };
var result = Collection.find(query); 
```

它用于返回记录。现在它没有。

当我做 a时，查询和and上`console.log(query)`有一个。`__proto__``start_date``end_date`

那么，我现在如何在 Meteor 中进行日期分隔查询呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:41:02.073

在meteor.js 0.5.7上，我用它来按日期分隔查询，结果很好：

```
userLive.find({readedAt: {$gte: startDay, $lt: endDay}}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:11:04.920

我求助于使用 moment.js。这行得通。

```
var ts = moment().format(); 
```

# c# - build poll system with Repeater control in asp.net

> ID：15233779
> 
> 赞同：0
> 
> 时间：2013-03-05T20:46:32.667
> 
> 标签：c#, asp.net, linq, repeater

I want to build a poll system in asp.net with Repeater control, in DB has 2 table (Polls, PollItems). and use this code for select poll:

```
var lstPoll = (from P in Conn.Polls.ToList()
                            orderby P.PollOrder
                            select new { P.Question, P.PollID, P.PollItems }).ToList();

RepeaterPoll.DataSource = lstPoll.ToList();
RepeaterPoll.DataBind(); 
```

PollItems table (P.PollItems) has *PollItemID*, *PollAnswer* parametr.

```
<asp:Repeater ID="RepeaterPoll" runat="server">
    <ItemTemplate>
    <%# Eval("Question")%>
    <br />
    <asp:RadioButtonList ID="rblItemPoll" runat="server" DataValueField='<%# Eval("PollItemID")%>' DataTextField='<%# Eval("PollAnswer")%>'></asp:RadioButtonList>
    <br /><br />
    </ItemTemplate>
    </asp:Repeater> 
```

but not Eval PollAnswer and PollItemID to rblItemPoll.

plase help me for build poll system.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:11:29.010

Try this:

**1 - Define your `Repeater` with the `RadioButtonList` control and specifying an `OnItemDataBound` event handler:**

```
<asp:Repeater ID="RepeaterPoll" runat="server" OnItemDataBound="RepeaterPoll_OnItemDataBound">
    <ItemTemplate>
        <%# Eval("Question")%>
        <br />
        <asp:RadioButtonList ID="rblItemPoll" runat="server" />
        <br /><br />
    </ItemTemplate>
</asp:Repeater> 
```

**2- Implement your logic of DataBinding the `RadioButtonList` on the `OnItemDataBound` event:**

```
protected void RepeaterPoll_OnItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        dynamic item = e.Item.DataItem;
        RadioButtonList list = (RadioButtonList)e.Item.FindControl("rblItemPoll");
        list.DataValueField = "PollItemId";
        list.DataTextField = "PollItemDescription";
        list.DataSource = item.PollItems;
        list.DataBind();
    }
} 
```

You can define both `DataValueField` and `DataTextField` properties directly on the `RadioButtonList` tag tho.

Additionally, i retrieved the `DataItem` as `dynamic` because you are creating an anonymous type for your LINQ query result.

# c# - 从枚举中获取 DescriptionAttribute

> ID：15233780
> 
> 赞同：3
> 
> 时间：2013-03-05T20:46:36.503
> 
> 标签：c#, enums

我有一个枚举，用于查找协调字符串值。其中一个枚举中有一个空格，因此我试图使用 description 属性来查找该值。在找到 DescriptionAttribute 后，我无法转换回公共类。

```
public class Address
{
   ...blah...more class datatypes here...

    public AddressType Type { get; set; }

    ...blah.... 
```

}

```
public enum AddressType
{
    FRA = 0,
    JAP = 1,
    MEX = 2,
    CAN = 3,
    [Description("United States")]
    UnitedStates = 4, 

}

 if (Address.Type.ToString() == "UnitedStates")
            {
               Adddress.Type = GetDescription(Address.Type);
            }

private static AddressType GetDescription(AddressType addrType)
    {
        FieldInfo fi = addrType.GetType().GetField(addrType.ToString());
        DescriptionAttribute[] attributes =
        (DescriptionAttribute[])fi.GetCustomAttributes(
        typeof(DescriptionAttribute), false);
        return (attributes.Length > 0) ? attributes[0].Description : addrType.ToString();            
    } 
```

在 GetDescription 方法中，我如何将它转换回它的公共类数据类型“AddressType”它失败了，因为这里它是一个字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:05:54.690

恐怕我不能 100% 确定您要的是什么，但以下方法会返回`string`提供的描述或名称`AddressType`。

```
private static string GetDescription(AddressType addrType)
{
    FieldInfo fi = addrType.GetType().GetField(addrType.ToString());
    DescriptionAttribute[] attributes = 
        (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);
    return (attributes.Length > 0) ? attributes[0].Description : addrType.ToString();            
} 
```

注意返回类型`string`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:51:17.303

您将无法直接将字符串转换为枚举。您将需要编写一个转换器方法，该方法接受一个字符串并返回枚举。

简单示例，但您可以使用字典并使其成为自己的类。

```
//string values are case sensitive
    private AddressType StringToEnum(string enumString)
            {
                AddressType returnValue;
                switch (enumString)
                {
                    case "United States":
                        returnValue = AddressType.UnitedStates;
                        break;
                    case "France":
                        returnValue = AddressType.FRA;
                        break;
                    case "Japan":
                        returnValue = AddressType.JAP;
                        break;
                    case "Mexico":
                        returnValue = AddressType.MEX;
                        break;
                    case "Canada":
                        returnValue = AddressType.CAN;
                        break;
                    default:
                        returnValue = AddressType.UnitedStates;
                        break;

                }
                return returnValue;
            } 
```

如果您希望将字符串转换为枚举，则需要执行类似的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:34:19.000

您可以使用辅助方法从刺痛中删除空格并找到正确的枚举

例子：

```
public T EnumFromString<T>(string value) where T : struct
{
    string noSpace = value.Replace(" ", "");
    if (Enum.GetNames(typeof(T)).Any(x => x.ToString().Equals(noSpace)))
    {
        return (T)Enum.Parse(typeof(T), noSpace);
    }
    return default(T);
} 
```

用法：

```
 public enum Test
    {
        UnitedStates,
        NewZealand
    }

    Test MyEnum = EnumFromString<Test>("New Zealand"); // Returns 'NewZealand' 
```

# youtube - 获取属于 YouTube 内容所有者的频道 ID 列表

> ID：15233795
> 
> 赞同：1
> 
> 时间：2013-03-05T20:47:13.893
> 
> 标签：youtube, youtube-api

给定内容所有者 ID，有没有一种方法可以检索该父级中的频道列表，然后我可以通过任何 API 在“频道”过滤器中提供这些频道列表？

例如，使用内容 ID，您可以检索网络上的所有视图，如下所示：

```
https://www.googleapis.com/youtube/analytics/v1/reports?start-date=2013-03-01&end-date=2013-03-02&ids=contentOwner=={CONTENT_OWNER_ID}&metrics=views&filters=uploaderType==self&key=etc... 
```

但是我想获取可能在频道过滤器（&filters=channel==long_channel_string_here）中使用的频道 ID 列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T18:26:31.470

您可以在拨打电话`managedByMe`时使用该参数`youtube.channels.list()`，如[https://developers.google.com/youtube/v3/docs/channels/list#managedByMe中所述](https://developers.google.com/youtube/v3/docs/channels/list#managedByMe)

# servlets - CQ5 以编程方式运行工作流

> ID：15233798
> 
> 赞同：13
> 
> 时间：2013-03-05T20:47:24.537
> 
> 标签：servlets, workflow, aem

我在 CQ 中创建了一个需要通过 XHR 以编程方式运行的工作流。

你们中的许多人可能都知道，CQ 文档并不是最好的（至少在这一点上）。如何以编程方式运行它？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-06T23:03:01.333

在闲逛了一段时间后，我编写了一个运行工作流模型的 servlet。

这是带有注释的代码：

```
@Component
@Service
@Properties({
    @Property(name = "sling.servlet.paths", value = "/bin/runmodel"),
    @Property(name = "sling.servlet.methods", value = "GET")
})
public class RunWorkflowModel extends SlingSafeMethodsServlet {

    static private final Logger log = LoggerFactory.getLogger(RunWorkflowModel.class);

    @Reference
    private WorkflowService workflowService;

    @Override
    protected void doGet(SlingHttpServletRequest request, SlingHttpServletResponse response) throws IOException {
        ResourceResolver resourceResolver = request.getResourceResolver();
        Session session = resourceResolver.adaptTo(Session.class);

        /* Get Parameters
         * @param path = path you want to run the workflow on
         * @param model = workflow model name you want to run.  Typically found in /etc/workflow/models
         */
        RequestParameterMap params = request.getRequestParameterMap();
        String path = params.getValue("path").getString();
        String model = params.getValue("model").getString();

        // Create a workflow session 
        WorkflowSession wfSession = workflowService.getWorkflowSession(session);
        try {
            // Get the workflow model
            WorkflowModel wfModel = wfSession.getModel(model);                
            // Get the workflow data
            // The first param in the newWorkflowData method is the payloadType.  Just a fancy name to let it know what type of workflow it is working with.
            WorkflowData wfData = wfSession.newWorkflowData("JCR_PATH", path);
            // Run the Workflow.
            wfSession.startWorkflow(wfModel, wfData);
        } catch (WorkflowException ex) {
            response.getWriter().write("failed");
            log.error("Error starting workflow.", ex);
        }

        response.getWriter().write("success");
    }
} 
```

这是 Ajax 调用

```
CQ.Ext.Ajax.request({
    url: "/bin/runmodel",
    method: "GET",
    params : { 
        "path"  : "/content/path to item you want the workflow run on",
        "model" : "/etc/workflow/models/name of model/jcr:content/model"
    },
    success: function() {
        console.log("success");
    },
    failure: function(response) {
        CQ.Notification.notifyFromResponse(response);
    }
}); 
```

# jquery - JQuery 异步执行

> ID：15233799
> 
> 赞同：0
> 
> 时间：2013-03-05T20:47:29.180
> 
> 标签：jquery, html, each

我有 Jquery 循环通过我的 XML 文件：

```
 $(xml).find("category").each(function()
    {
        var title = $(this).find("title").text();
        var i = 0;
        console.log("j:" + j);
        if (j > 0) {
            fillNav("","",i,"final");
        }
        $(this).find('items > item').each(function() {
            var text = $(this).find("text").text();
            console.log("i:" + i);
            fillNav(title,text,i,"text");
            i++
        });

        j++;
    }); 
```

它填充 div 的位置：

```
 function fillNav(title,text,i,final){
    console.log("i:" + i);

        if ((i == 0)&&(final != "final")){
            console.log("title:" + title + "div><p><ul>");
            $("#accordionSub").append("<h3>"  + title + "</h3><br /><div><p><ul>");
            //$("#output").append("<div><p><ul>");
        }
        if (final != "final"){
            console.log("<li" + "text:" + "/li>");
            $("#accordionSub").append("<li>"  + text + "</li>");
        }
        if ((i == 0) && (final == "final")){
        console.log("final:" + "/ul>/p>/div>");
        $("#accordionSub").append("</ul></p></div>");
        }
} 
```

结果html：

```
<h3>Accessories</h3><br><div><p></p><ul></ul></div><li>Adaptors,  Bushings,   and Pressure Snubbers</li><li>Cables and Accessories   for pH Instruments</li><p></p> 
```

**为什么 UL 标签不在 LI 标签周围？**

更新：

```
 output += "<h3>"  + title + "</h3><br />";
        output += " <div><p><ul> " ;
        $(this).find('items > item').each(function() {
            var text = $(this).find("text").text();
            var slink = $(this).find("link").text();
            //console.log("i:" + i);
            output += "<li class='subLink' src='"+ slink +"'>"  + text + "</a></li>";
        });
        output += "</ul></p></div>"; 
```

产生：

<-div><-p></-/p><-ul><-li></-/li></-/ul><-p></-/p>

**我必须让 P 标签包围 UL 标签**

***更新******** 感谢所有帮助：只需发布我的最终代码以帮助将来的其他人：

```
$(xml).find("category").each(function()
    {   

        var output += '<h3>' +$(this).find("title").text() + '</h3>' ;
        var div = '<div>';
        output += '<ul>';   

        $(this).find('items > item').each(function() {
            var text = $(this).find("text").text();
            var slink = $(this).find("link").text();

            output += "<li class='subLink' src='"+ slink +"'>"  + text + "</a></li>";
        });

        output += '</ul>';      

    });
    //console.log(output);

    var icons = {
  header: "ui-icon-circle-arrow-e",
  activeHeader: "ui-icon-circle-arrow-s"
};
$('<div>')
.attr('id','accordionSub')
.html(output)       
.appendTo('#accordionSubB').delay(1).queue(function(){
    $( "#accordionSub" ).accordion({
                heightStyle: "content",
                collapsible: true,
                icons: icons
            });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:56:40.890

我以前也有类似的问题。最好将所有生成的 HTML 存储在一个变量中，而不是追加。例子：

```
var output = '<ul>';

for(var i = 0; i < 10; i++){
    output += '<li></li>';
}

output += '</ul>';

$(elem).append(output); 
```

此外，这种方法将花费您更少的 CPU 使用率。在您的解决方案中，您总是在每个 cicle 中操作 DOM。这是一种非常低效的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:55:45.960

Append 和内部 html 是两个不同的东西 - append 接受一个 dom 元素并将其插入到父元素中。

你可以做这样的事情......

```
var ul = $('<ul/>');
$('<li/>').html("Some Text").appendTo(ul);
$('<li/>').html("More Text").appendTo(ul); 
```

然后当你准备好

```
$(some container).append(ul); 
```

# c# - 允许具有多个句点的 Route ID

> ID：15233802
> 
> 赞同：1
> 
> 时间：2013-03-05T20:47:34.560
> 
> 标签：c#, asp.net-mvc-4

如何在 URL 中允许多个句点？

示例网址：

`http://mylocalhost:6968/MyHome/Edit/ABCD.Applications.ClinicalData%257cCache_Timeout`

我试过了：

**各种网址编码：**

```
 @{
            //string encodedItem = Url.Encode(item.Key);
            //string encodedItem = HttpUtility.UrlEncode(item.Key);                
            string encodedItem = Server.UrlEncode(item.Key);
        } 
```

**[添加](https://stackoverflow.com/questions/332757/asp-net-mvc-how-to-route-search-term-with-period-at-the-end)路由处理程序：**

```
<add name="UrlRoutingHandler" type="System.Web.Routing.UrlRoutingHandler, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" path="Remote.mvc/*" verb="GET"/> 
```

**[修改](http://haacked.com/archive/2010/04/29/allowing-reserved-filenames-in-URLs.aspx)web.config`system.web`**

```
<httpRuntime relaxedUrlToFileSystemMapping="true" /> 
```

这些事情都没有更正示例 URL。

**相关代码**

```
@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Key)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Value)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsActive)
        </td>
        <td>
            @{
                //string encodedItem = Url.Encode(item.Key);
                //string encodedItem = HttpUtility.UrlEncode(item.Key);                
                string encodedItem = Server.UrlEncode(item.Key);                
            }
            @Html.ActionLink("Edit", "Edit", new {  id = encodedItem }) |
            @Html.ActionLink("Details", "Details", new {  id = encodedItem }) |
            @Html.ActionLink("Delete", "Delete", new {  id = encodedItem })
        </td>
    </tr>
} 
```

我正在单击编辑链接。

我也试过

`@Html.ActionLink("Edit", "Edit", new { id = item.Key })`

其 html 输出为：

`a href=/MyHome/Edit/ABCD.Applications.ClinicalData%7CCache_Timeout`

单击此链接会导致错误：

`HTTP Error 404.0`

我在`Controller.Edit`. 断点永远不会被击中。任何时候我有一个形式的网址：

`http://mylocalhost:6968/MyHome/Edit/ABCD.X`

如果 X 是 a 之后的任何内容，`.`则会发生此错误。如果我删除 X，断点就会被命中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T21:52:49.927

HTTP GET 被证明是不可能的。我决定重新设计解决方案。现在我执行**HTTP POST**以避免通过 URL 传递数据。

理想情况下，我的 URL 将是可[破解](http://2002-2012.mattwilcox.net/archive/entry/id/990/)的。但它是一个内部应用程序，它是客户想要的......嘿孩子，小心碎玻璃

# algorithm - 算法的算法分析（big-O）

> ID：15233803
> 
> 赞同：0
> 
> 时间：2013-03-05T20:47:35.657
> 
> 标签：algorithm, big-o, notation, asymptotic-complexity

我试图帮助一位朋友分析他的算法的复杂性，但我对 Big-O 表示法的理解非常有限。

代码如下：

```
int SAMPLES = 2000;
int K_SAMPLES = 5000;

int i = 0; // initial index position    
while (i < SAMPLES)
{
    enumerate();                       // Complexity: O(SAMPLES)
    int neighbors = find_neighbors(i); // Complexity: O(1) 

    // Worst case scenario, neighbors is the same number of SAMPLES
    int f = 0;
    while (f < neighbors) // This loop is probably O(SAMPLES) as well.
    {
        int k = 0; // counter variable
        while (k < K_SAMPLES) // Not sure how to express the complexity of this loop.
        {                     // Worst case scenario K_SAMPLES might be bigger than SAMPLES. 

            // do something!

            k++;
        }
        f++;
    }

    i++;
} 
```

代码中有 2 个函数，但我能够识别它们的复杂性，因为它们很简单。然而，我无法表达内部`while`循环的复杂性，但即使在测量之后，我仍然需要帮助将所有这些复杂性组装成一个表示算法计算复杂度的公式。

在这件事上我非常需要帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T06:39:11.897

从最内层循环到最外层的最坏情况分析（[轻度滥用“=”符号](http://en.wikipedia.org/wiki/Big_O_notation#Equals_sign)）：

```
->  O(K_SAMPLES)                    -- complexity of just the k-loop

->  neighbors * O(K_SAMPLES)         -- complexity of f-loop accounted for
 =  SAMPLES * O(K_SAMPLES)          -- since neighbors = SAMPLES in worst case
 =  O(SAMPLES * K_SAMPLES)

->  O(SAMPLES) + O(SAMPLES * K_SAMPLES)  -- adding complexity of enumerate()
 =  O(SAMPLES + SAMPLES * K_SAMPLES)
 =  O(SAMPLES * K_SAMPLES) 
```

由于渐近增长更快，该`SAMPLES`术语被删除。`SAMPLES * K_SAMPLES`更正式地说，

```
When C >= 2, SAMPLES >= 1, K_SAMPLES >= 1 then

SAMPLES + SAMPLES * K_SAMPLES  <=  C(SAMPLES * K_SAMPLES)
SAMPLES * (K_SAMPLES + 1)  <=  SAMPLES * C * K_SAMPLES
K_SAMPLES + 1  <=  C * K_SAMPLES 
```

有关具有多个变量的 big-O 的更多信息，请参见[此处](http://en.wikipedia.org/wiki/Big_O_notation#Multiple_variables)。继续我们的最后一个循环：

```
->  SAMPLES * O(SAMPLES * K_SAMPLES)    -- complexity of i-loop accounted for
 =  O(SAMPLES^2 * K_SAMPLES) 
```

请注意，根据 返回的平均数`find_neighbors(i)`，它可以使平均 big-O 不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:52:10.673

O（邻居* K_SAMPLES）

如果邻居 << K 那么这在 K_SAMPLES 中更接近线性

如果邻居按 K_SAMPLES 顺序排列，则在 K_SAMPLES 中是二次的

# python - Twisted 中激活的多个事件

> ID：15233806
> 
> 赞同：2
> 
> 时间：2013-03-05T20:47:49.137
> 
> 标签：python, twisted

我刚刚了解到 Twisted 使用单个线程来处理事件。因此，您必须设计非阻塞事件处理程序，理想情况下它们必须在触发另一个事件之前完成。要求使用延迟对象实现阻塞例程。

现在，假设您正在处理一个事件，并且另一个事件被激活。

对这种情况的合理反应是将新事件排队并等到正在运行的处理程序完成。

这是 Twisted 引擎内部发生的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:00:29.587

您误解了操作系统如何将事件传递给 Twisted。在大多数 API 中，您必须主动将事件从某种队列中拉出，当它们发生时您不会立即收到警报。在通知确实立即发生的情况下（来自信号或来自另一个线程），Twisted 将它们排入主线程中。

因此，从您作为使用 Twisted 的程序员的角度来看，您的问题的答案只是“是”，但 Stack Overflow 让我投入了更多的话，以便将其视为有效答案:)。

# c# - 我可以在没有 Visual Studio .net 的情况下在 C# 中创建 Web 服务吗

> ID：15233811
> 
> 赞同：2
> 
> 时间：2013-03-05T20:48:12.983
> 
> 标签：c#, web-services, visual-studio

我想创建一个网络服务。我的机器上没有安装 Visual Studio。我仍然可以使用其他一些免费软件创建 Web 服务，还是应该使用其他语言（如 java 或 php）创建它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:49:35.517

如果您更喜欢使用 C#，有几个免费的替代品，包括[Visual Studio Express](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-products)和[Sharp Develop](http://www.icsharpcode.net/opensource/sd/)。甚至还有[Mono Develop](http://monodevelop.com/)。

而且您甚至不需要 IDE。您可以使用 Notepad++ 之类的文本编辑器，[请参见此处](http://dotnet.dzone.com/articles/notepad-c-compiler-you-can-do)，并使用 .NET 运行时附带的命令行编译器 CSC。

# git - 不能再将我的提交推送到 GitHub

> ID：15233812
> 
> 赞同：0
> 
> 时间：2013-03-05T20:48:17.903
> 
> 标签：git, version-control, tortoisegit

我使用[GitHub](https://github.com)作为我的 GIT 存储库。最近我提交了一个巨大的图像文件夹，现在当我做 a 时`push`，该过程在大约 10 分钟后失败。

我已经吸取了教训，不要同时提交大文件，但现在我有点被锁定了。我浏览了图像并使用[TortoiseGIT](https://code.google.com/p/tortoisegit/)，我选择了“删除（保留本地）”选项，但是当我执行 a 时`push`，该过程需要很长时间，我仍然可以看到正在计算的相同数量的对象，并且该过程再次失败。

是否可以从队列中删除图像？如果有解决方案，我也可以使用命令行。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:42:15.817

如果您所做的更改仅在您的本地存储库中，您可以删除您的本地存储库并从 github 再次克隆它。这是一种简单的方法：您只需克隆一个新的工作副本，然后忘记不必要的撤消操作

如果您不想这样做，您可以随时撤消已经完成的提交。只需找到您要备份的提交（您可以使用其他工具找到它`gitk --all`）并执行此命令

```
git reset --hard <sha1_commit> 
```

# java - 在一条路径中同时解析符号链接和“..”

> ID：15233816
> 
> 赞同：2
> 
> 时间：2013-03-05T20:48:31.617
> 
> 标签：java, linux, file, file-io, symlink

这是问题所在。我有一个指向其他目录的符号链接：

```
$ls -l /foo/bar
lrwxrwxrwx  /foo/bar  ->  /target/bar 
```

在`foo`目录中有一个文件`x`

```
$ls -l /foo
lrwxrwxrwx   me me  314   x 
```

现在，我想`x`通过以下路径访问`/foo/bar/../x`

```
$ls -l /foo/bar/../x : No such file or directory 
```

这在 Bash 中不起作用，但是有什么方法可以使用[File](http://docs.oracle.com/javase/7/docs/api/java/io/File.html) api 从 Java 中工作？目录结构可以是任意的，因此可能会有类似的情况`/foo/bar/1/2/3/4/5/../../../../../../x`，等等。

换句话说，我正在寻找`magic()`检查文件是否存在的方法的内容（假设前面提到的目录结构）：

```
magic("/foo/x") ... true
magic("/foo/bar/../x") ... true
magic("/foo/bar/1//../../x") ... true
magic("/foo/bar/1/2/3/4/5/../../../../../../x") ... true
magic("/foo/bar//1/../2/../../x") ... true
magic("/foo/bar/1/2/../3/../../../x") ... true
magic("/foo/bar/1/2/./../3/../4//../../../x") ... true

magic("/foo/bar/x") ... false
magic("/foo/bar/1/../x") ... false
magic("/foo/bar/1/2/3/4/../../../../../../x") ... false
magic("/foo/bar//1/../2/../x") ... false 
```

**注意 1：** getCanonicalPath() 对我不起作用，因为它首先解析符号链接，然后解析所有 *“..”*或*“.”* 在路径中。我需要反之亦然。

**注意 2：**路径中可能还有其他符号链接，它应该在相同的意义上工作（dir`2`可能是符号链接）。

**注 3：**该文件**仅**`x`位于.**`/foo`**

 **到目前为止，看起来我需要一个用于上下文无关语法的解析器，这个问题没有更简单的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:01:49.627

如果我理解正确，该[`Path.normalize()`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html#normalize%28%29)方法应该完全符合您的要求吗？

它消除了`..`（除其他外），它的文档说

> 该方法不访问文件系统；该路径可能找不到存在的文件。从路径中删除“..”和前面的名称可能会导致该路径定位的文件与原始路径不同。当前面的名称是符号链接时，可能会出现这种情况。

您不需要解析路径上的其他符号链接，当您最终尝试访问文件时，操作系统会解析它们。如果您仍然想解析符号链接，请[`Path.toRealPath()`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html#toRealPath%28java.nio.file.LinkOption...%29)稍后调用（*不*`NOFOLLOW_LINKS`作为参数给出）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T13:41:37.870

Path 是一个 Java7 API。如果您坚持使用 Java6，我认为以下内容也适合您：http: [//commons.apache.org/proper/commons-io/javadocs/api-1.4/org/apache/commons/io/FilenameUtils .html#normalize%28java.lang.String%29](http://commons.apache.org/proper/commons-io/javadocs/api-1.4/org/apache/commons/io/FilenameUtils.html#normalize%28java.lang.String%29)**

# javascript - 后台页面未正确检测 URL 中的字符串

> ID：15233818
> 
> 赞同：0
> 
> 时间：2013-03-05T20:48:33.533
> 
> 标签：javascript, html, google-chrome, google-chrome-extension, local-storage

我正在尝试在我的后台页面中设置一个侦听器，当标签在其 URL 中使用“nytimes.com”更新时会增加一个计数器（最终我希望它在使用“NYTimes.com”更新标签时增加在它的标题中，但首先是第一件事）。我的代码如下：

```
// storage for counts
if (localStorage.getItem('nyt') == undefined || localStorage.getItem('nyt') == NaN)
{
    localStorage.setItem('nyt', 0);
}

// turn the value from localStorage into an incrementable int
var nytCount = parseInt(localStorage.getItem('nyt'));

// listen for changed tabs and check URL
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
    debugger;
    var url = changeInfo.url;
    if (changeInfo.status == 'complete' && url && url.indexOf("nytimes.com") !== -1) {
        localStorage.setItem('nyt', ++nytCount);
    }
}); 
```

后台页面在 manifest.json 中声明如下：

```
...
"background": {
    "scripts": ["eventPage.js"],
    "persistent": false
},
... 
```

我也尝试过将“持久”声明为真的，但这似乎并没有奏效。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T00:31:42.807

我最近完成了我的第一个扩展，所以我不知道我是否有最好的方法，但我能够使用`chrome.webRequest.onBeforeRequest.addListener()`.

我必须在文件中添加`"webRequest"`to ，当有匹配时，它会触发一个回调，然后可以根据需要做出反应。在我的情况下，我重定向了浏览器，但在你的情况下可以增加你的计数器。 `permissions``manifest`

我写了[这篇关于我如何创建我的 chrome 扩展](http://jdstraughan.com/2013/02/07/nonews-part-2-the-source/)的博文，希望它可以帮助你。

# java - 如何对字符串中的 XML 运行 XQuery？

> ID：15233826
> 
> 赞同：5
> 
> 时间：2013-03-05T20:49:09.630
> 
> 标签：java, xml, xquery, saxon

我有一些 XML 的字符串表示，我想在内存中对其运行 XQuery。我一直在玩撒克逊人并想出了一个解决方案，但为了让它发挥作用，我做了一件丑陋的、丑陋的事情。我有一种感觉，这是因为我对撒克逊人缺乏经验。这是一些有效的代码：

```
import javax.xml.transform.URIResolver;
import net.sf.saxon.Configuration;
import net.sf.saxon.s9api.*;

public class XmlTest {
  public static void main(String[] args) {
    try {
      final String tableXml = 
        "<table>" + 
        "  <columns>" + 
        "    <column>Foo</column><column>Bar</column>" + 
        "  </columns>" + 
        "  <rows>" + 
        "    <row><cell>Foo1</cell><cell>Bar1</cell></row>" + 
        "    <row><cell>Foo2</cell><cell>Bar2</cell></row>" + 
        "  </rows>" + 
        "</table>";

      Configuration saxonConfig = new Configuration();
      Processor processor = new Processor(saxonConfig);

      XQueryCompiler xqueryCompiler = processor.newXQueryCompiler();
      XQueryExecutable xqueryExec = xqueryCompiler
              .compile("<result>{"
                       + "doc('')/table/rows/row/cell/text()='Foo2'"
                       + "}</result>");

      XQueryEvaluator xqueryEval = xqueryExec.load();
      xqueryEval.setSource(new SAXSource(new InputSource(
          new StringReader(tableXml))));

      XdmDestination destination = new XdmDestination();

      xqueryEval.setDestination(destination);

      // Avert your eyes!
      xqueryEval.setURIResolver(new URIResolver() {
        @Override
        public Source resolve(String href, String base) throws TransformerException {
            return new StreamSource(new StringReader(tableXml));
        }
      });

      xqueryEval.run();

      System.out.println(destination.getXdmNode());

    } catch (Exception e) {
      e.printStackTrace();
    }
  }
} 
```

我遇到的问题是 XML 文档的基本 URI。由于它在内存中，因此没有可参考的基础文档。我知道 XML 将始终是自包含的，因此我决定重写`URIResolver`以仅将包装在`Source`类型对象中的 XML 传回。我知道这是错误的，但它有效。如果我不这样做，我会收到`Content not allowed in prolog`错误消息。从错误消息的其余部分看来，它正在尝试将当前目录作为 XML 文件读取。那部分对我来说有点神秘，但我愿意学习！有没有正确的方法来做我想做的事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T10:02:40.297

如果您想使用 doc('') 访问源文档，那么这就是执行此操作的方法。但是，如果您编写查询以访问源文档作为上下文项的值，则要简单得多。因此，您将查询更改为

```
"<result>{/table/rows/row/cell='Foo2'}</result>" 
```

您已经使用 setSource() 提供了上下文项，即使您没有使用它，所以这是您需要进行的唯一更改。

（我还从查询中删除了“/text()”，因为直接测试元素的值要好得多 - 这意味着如果源文档包含注释，您的查询仍然有效）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T15:08:02.580

你能做到这一点而不包括封闭并将xquery输出放入最终字符串吗？

# javascript - JavaScript 图像对象

> ID：15233829
> 
> 赞同：-2
> 
> 时间：2013-03-05T20:49:19.473
> 
> 标签：javascript, html, image, object

我想要一种将对象相对定位到 div 左上角的方法。或者一种使用 JavaScript 创建某种图像视图（不使用 HTML img 标签）的方法，该视图将相对于 div 显示在屏幕上。会有多个这些图像，我希望它们能够重叠。我正在尝试重新制作我在 Xcode 上制作的游戏，其中涉及与网格对齐移动的块（将在 1000x700px 的窗口中）

我是 javascript 的初学者

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:51:39.893

关于第一个选项（定位图像），您可以仅使用 CSS 来完成（或使用 JavaScript 操作相同的 CSS 属性）。您只需要：

1.  一个带有`position: relative`.
2.  里面的元素`position: absolute`。然后操作它们的`top`、`left`和`right`属性`bottom`（将与容器相关）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:44:33.920

好吧，如果没有完整的上下文，很难推荐任何东西，但是您可以使用一些基本的 CSS 来做到这一点。

由于您不想使用图像标签，您可以在包含的 div 上添加背景图像。然后将该图像放置在您需要的位置。

示例：http: [//jsfiddle.net/ufomammut66/wctJc/1/](http://jsfiddle.net/ufomammut66/wctJc/1/)

我们使用 a`background-position`来定义显示图像的位置。您可以使用关系（上、中、下、右、左）或实际像素位置（XY 表示法 IE：100px 5px）来告诉定义它应该显示的位置。

根据您将要做的事情（因为它是一个游戏），将项目分成主容器的不同子项可能更有意义。因此，您将拥有 1 个元素`position:relative`和一系列其他元素`position:absolute`。绝对定位的元素可以像背景一样放置 - 以像素 ( `top:100px;left:5px`) 为单位设置 XY 位置。此外，您可以为它们设置动画以四处移动并与事物交互。在下面的示例中，我使用 jQuery 为元素设置动画，主要是因为 jQuery 使动画变得超级简单。

示例：http: [//jsfiddle.net/ufomammut66/QxGhD/2/](http://jsfiddle.net/ufomammut66/QxGhD/2/)

# c# - 为什么调用空事件处理程序不会引发异常？

> ID：15233835
> 
> 赞同：4
> 
> 时间：2013-03-05T20:49:37.323
> 
> 标签：c#, event-handling, thread-safety

阅读[此问题](https://stackoverflow.com/questions/786383/c-sharp-events-and-thread-safety)后，似乎以下代码应该失败：

```
private void Form1_Load(object sender, EventArgs e)
{
   EventHandler myHandler = null;
   myHandler(this, null);
} 
```

但是当我运行它时，它工作得很好（并且什么都不做）。该代码的行为与以下代码有何不同？

```
private void Form1_Load(object sender, EventArgs e)
{
   EventHandler myHandler = null;
   EventHandler myCopy = myHandler;
   if (myCopy != null)
   {
      myHandler(this, null);
   }
} 
```

编辑：根据 Lasse V. Karlsen 的回答，以这种方式捕捉异常是有效的：

```
private void Form1_Load(object sender, EventArgs e)
{
   try
   {
      EventHandler myHandler = null;
      myHandler(this, null);
   }
   catch (Exception ex)
   {
      this.Text = "Exception!";
   }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T20:56:49.420

这里的问题是 Load 事件正在吞噬您的异常。

这里还有其他关于这个的问题和网上关于它的其他帖子：

*   [为什么表单加载无法捕获异常？](https://stackoverflow.com/questions/3209706/why-the-form-load-cant-catch-exception)
*   [Paul Betts的个人网站/博客/what-have-you OnLoad异常消失案例——x64中的用户态回调异常](http://blog.paulbetts.org/index.php/2010/07/20/the-case-of-the-disappearing-onload-exception-user-mode-callback-exceptions-in-x64/)

简而言之，在某些情况下（最常引用的原因是在 64 位 Windows 上运行的 32 位 .NET 程序）WinForms 表单的 Load 事件中的任何异常都将被吞没。

您可以将 Form Load 事件包装在 try/catch 块中以捕获它，并确定如何对其做出反应。

**简而言之 2：代码确实如您预期的那样导致空引用异常，您只是没有看到它**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:53:14.610

您如何确定此代码运行良好？这段代码很可能在后台抛出异常，然后被 Windows 窗体运行时代码吞噬。调试器/运行时可以静默处理这种异常吞咽有几个原因

我会尝试调试这个或代码或禁止在委托调用下放置`Messagebox.Show`一行，看看它是否执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:57:15.847

你确定代码*什么都不做*吗？

当我尝试这个时，我*确实*得到了一个：`NullReferenceException`

```
class Program
{
    static void Main(string[] args)
    {
        EventHandler myhandler = null;
        myhandler(null, null);
    }
} 
```

也许你的代码永远不会被执行（例如你的`Form1_Load`事件处理程序没有被调用），或者你的异常被吞没了（例如被不同的线程）？

# python - python中的len函数是否可能出现故障？

> ID：15233836
> 
> 赞同：0
> 
> 时间：2013-03-05T20:49:46.047
> 
> 标签：python, function

这是一个非常奇怪的错误，我不知道发生了什么。基本上我的代码是最重要的，它还没有完全完成，但无论如何。对于那些玩过顶级王牌的人，我的代码模拟了两只手之间的牌传递。但是，如果您查看`if len(Your_Hand)== 0:`我使用 len() 打印这些手的长度的第 129 行 ()，它们不会相加。即 len() 表示读取列表时显然不正确的长度？

谢谢，如果您能看一下并尝试帮助我了解正在发生的事情，那将是很棒的！

这是我的代码：

```
#top trumps stuff
import random
import time

pack = [("harry Potter",2,3,4,5),
         ("Hermione Granger", 5,6,7,8),
         ("Ron Weasley", 12, 13,4,5),
         ("Neville Longbottom", 1,1,1,1),
         ("Ginny Weasley",2,3,4,5),
         ("Draco Malfoy",3,6,7,8) ]

pile_1 = []
pile_2 = []
clash_pile = []
Your_Hand = 0
Opponent_Hand = 0
end_loop=0
catagory_exchange = {"brains":0,
                     "knowledge": 1 ,
                      "cunning": 2, 
                      "evil":3}

choice = 0
acceptable_answers = catagory_exchange.keys()
proceed = 0
clash = 0 
end_game = 0

#Shuffles the pack
random.shuffle(pack)

# Deals the cards
Dealer_count =0
while Dealer_count <len(pack):
    pile_1.append(pack[0])
    pack.remove(pack[0])
    pile_2.append(pack[0])
    pack.remove(pack[0])

#Asks Which pile they'd like
Which_Pile = raw_input(">> Which Pile would you like 1 or 2?")

while end_loop  != 1:
    if Which_Pile == "1":
        Your_Hand = pile_1
        Opponent_Hand = pile_2
        print "Lets now start!"
        end_loop = 1

    elif Which_Pile == "2":
        Your_Hand = pile_2
        Opponent_Hand = pile_1
        print "Lets now start!"
        end_loop = 1
    else:
        Which_Pile =  raw_input("You didn't pick 1 or 2! Pick again!!")

while end_game != 1:

    print len(Your_Hand)
    print Your_Hand

    print len(Opponent_Hand)
    print Opponent_Hand

    print Your_Hand[0]
    choice = raw_input(">> choose a catagory, brains, knowledge, cunning, evil - ")

    if choice in acceptable_answers:
        proceed = 1
    else:
        print "Thats not an catagory"

    if proceed == 1:

        if Your_Hand[0][catagory_exchange[choice]] > Opponent_Hand[0][catagory_exchange[choice]]:
            if clash == 1:
                print "You won the cards from previous rounds aswell!!"
                clash = 0
                clash_pile[:] = []

            else:
                print "You won the card you received %s" % Opponent_Hand[0][0]
            Your_Hand.append(Opponent_Hand[0])
            Your_Hand.append(clash_pile)
            Opponent_Hand.remove(Opponent_Hand[0])
            Your_Hand.append(Your_Hand[0])
            Your_Hand.remove(Your_Hand[0])

        elif Your_Hand[0][catagory_exchange[choice]] < Opponent_Hand[0][catagory_exchange[choice]]:
            if clash ==1:
                print "You lost the cards from previous rounds aswell"
                clash = 0
                clash_pile[:] = []

            else:
                print "You lost the card"
            Opponent_Hand.append(Your_Hand[0])
            Your_Hand.append(clash_pile)
            Your_Hand.remove(Your_Hand[0])
            Opponent_Hand.append(Opponent_Hand[0])
            Opponent_Hand.remove(Opponent_Hand[0])

        if Your_Hand[0][catagory_exchange[choice]] == Opponent_Hand[0][catagory_exchange[choice]]:
            clash =1
            print "They both have the same value"
            print "They have been added to a pile which you will win when you win the next round"
            clash_pile.append(Your_Hand[0])
            clash_pile.append(Opponent_Hand[0])
            Opponent_Hand.remove(Opponent_Hand[0])
            Your_Hand.remove(Your_Hand[0])

if len(Your_Hand)== 0:
    print "Oh no! You have run out of cards! You lose!!"

if len(Opponent_Hand)==0:
    print "Well done! Your opponent has run out of cards! You win!!" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:16:57.157

几轮之后，我的手牌长度为 3，由一张罗恩韦斯莱牌和两张空单组成：`[('Ron Weasley', 12, 13, 4, 5), [], []]`。我猜你不想在那里有那些空列表。

罪魁祸首似乎是这一行：

```
Your_Hand.append(clash_pile) 
```

这总是会在您的手上添加一个空列表。

你可能想要`extend`而不是`append`. 此外，您应该在将冲突堆重置为*之前*将冲突堆添加到获胜者的手上`[]`。

其他观察结果可能与您的原始问题无关：

*   `if`可能`if Your_Hand[0][catagory_exchange[choice]] == Opponent_Hand[0][catagory_exchange[choice]]:`应该是`elif`
*   无论谁实际上赢得了冲突，您都会在冲突堆中获得牌
*   当我拿走对手的最后一张牌时，游戏并没有结束
*   如果每张牌都进入冲突，玩家就没有什么可打的了（尽管这可能是顶级王牌固有的问题）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:52:55.917

我重写了你的程序，它现在对我有用。我发现了几件事：

最大的问题是@Kevin 在他的回答中指出的问题：您使用`list.append()`而不是`list.extend()`从`clash_pile`.

此外，`category_exchange`包含偏离 1 的值。每张卡片中的第 0 项是一个字符串，选择`brains`会导致卡片名称之间的字符串比较。（当我不断地和 Neville Longbottom 赢牌时，我很困惑！）

我重写了移动卡片的代码。我不是先调用`.append()`然后调用`.remove()`，而是调用`.pop()`删除值并返回它，然后在内部进行`.append()`。当这一切都在一行时，您不太可能看到有人只更改两行代码之一的错误。

此外，我不是在找到可接受的输入时标记变量来发出信号，而是使用无限循环并在找到可接受的输入时简单地中断。

此外，我没有使用标志变量来表示“冲突堆中有卡片”之类的东西，或者检查卡片列表上的长度为 0，而是将其更改为直接检查列表值。

另外，由于我很懒，我让程序接受一个类别的数字。而不是打字`knowledge`，你可以只打字`2`，它就可以工作。

如果您有任何问题，请告诉我。

```
#top trumps stuff
import random
import time

pack = [
    ("Harry Potter",2,3,4,5),
    ("Hermione Granger", 5,6,7,8),
    ("Ron Weasley", 12, 13,4,5),
    ("Neville Longbottom", 1,1,1,1),
    ("Ginny Weasley",2,3,4,5),
    ("Draco Malfoy",3,6,7,8)
]

pile_1 = []
pile_2 = []
clash_pile = []
category_exchange = {
    "brains" : 1,
    "knowledge" : 2 ,
    "cunning" : 3, 
    "evil" : 4,
}

#Shuffles the pack
random.shuffle(pack)

# Deals the cards
while pack:
    pile_1.append(pack.pop(0))
    pile_2.append(pack.pop(0))

#Asks Which pile they'd like

while True:
    Which_Pile = raw_input(">> Which Pile would you like 1 or 2?")
    if Which_Pile.strip() == "1":
        Your_Hand = pile_1
        Opponent_Hand = pile_2
        print "Lets now start!"
        break
    elif Which_Pile.strip() == "2":
        Your_Hand = pile_2
        Opponent_Hand = pile_1
        print "Lets now start!"
        break
    else:
        print "You didn't pick 1 or 2! Pick again!!"

while True:
    if not Your_Hand:
        print "Oh no! You have run out of cards! You lose!!"
        break

    if not Opponent_Hand:
        print "Well done! Your opponent has run out of cards! You win!!"
        break

    print "\n"

    print "DEBUG: Opponent: len: %d  top_card: %s" % (len(Opponent_Hand), str(Opponent_Hand[0]))
    print "DEBUG: You: len: %d  top_card: %s" % (len(Your_Hand), str(Your_Hand[0]))

    print "Here is your top card: '%s'" % str(Your_Hand[0])

    while True:
        choice = raw_input(">> choose a category, brains, knowledge, cunning, evil: ")

        if choice in category_exchange:
            i = category_exchange[choice]
            break
        else:
            try:
                i = int(choice)
            except ValueError:
                pass
            if i in category_exchange.values():
                break
        print "That's not a category"

    print "Opponent had: %s" % str(Opponent_Hand[0])

    if Your_Hand[0][i] > Opponent_Hand[0][i]:
        if clash_pile:
            print "You won the cards from previous rounds as well!!"
        else:
            print "You won the card!"

        Your_Hand.append(Opponent_Hand.pop(0))
        Your_Hand.extend(clash_pile)
        clash_pile = []
        Your_Hand.append(Your_Hand.pop(0))

    elif Your_Hand[0][i] < Opponent_Hand[0][i]:
        if clash_pile:
            print "You lost the cards from previous rounds as well"
        else:
            print "You lost the card!"

        Opponent_Hand.append(Your_Hand.pop(0))
        Opponent_Hand.extend(clash_pile)
        clash_pile = []
        Opponent_Hand.append(Opponent_Hand.pop(0))

    else:
        assert Your_Hand[0][i] == Opponent_Hand[0][i]
        print "Both cards have the same value."
        print "They have been added to a pile which will go to the next winner."
        clash_pile.append(Your_Hand.pop(0))
        clash_pile.append(Opponent_Hand.pop(0)) 
```

# python - 文件中的 .readlines() 列表不索引值

> ID：15233839
> 
> 赞同：0
> 
> 时间：2013-03-05T20:49:48.760
> 
> 标签：python, list, python-2.7

我有一个 txt 文件，其中包含如下列表形式的内容：

```
[1,2,3,4]
[5,6,7,8] 
```

我使用以下代码将这些列表放入列表中：

```
t = open('filename.txt', 'r+w')
contents = t.readlines()

alist = []

for i in contents:
    alist.append(i) 
```

当我跑

```
alist[0] 
```

我明白了

```
[1,2,3,4] 
```

但是当我跑步时

```
for a in alist:
    print a[0] 
```

我明白了

```
[ 
```

而不是列表中的第一个值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T20:50:52.080

`.readlines()`将行读取为字符串。该字符串的第一个字符是`[`.

如果要读取文本文件并将其“反序列化”为数据结构，最简单的方法是使用 Python 的内置`eval()`函数。更安全的方法是使用`ast.literal_eval()`.

[http://docs.python.org/2/library/ast.html?highlight=literal#ast.literal_eval](http://docs.python.org/2/library/ast.html?highlight=literal#ast.literal_eval)

建议代码：

```
import ast

with open("filename.txt") as f:
    alist = [ast.literal_eval(line) for line in f]

print(type(alist[0]))  # prints: <type 'list'>
print(alist[0]) # prints: [1,2,3,4] 
```

我们几乎从不想打电话`.readlines()`；它会占用文件中的所有行，因此如果文件非常大，则会导致程序的内存使用量大幅增加。一个打开的文件句柄对象（在我的示例中，`f`）可以用作迭代器，每次迭代它都会从文件中产生一行。因此，`for`循环或列表推导将从文件中一次拉出一行。因此，这个示例程序不会将整个文件保存在内存中；在构建列表时，它一次只保留一行。如果这个程序调用`.readlines()`它会保留所有的行和列表，所以峰值内存使用会更高。（当然，对于像这个例子这样小的输入文件来说，这并不重要。但是用内存高效的方式做事情很容易，为什么不呢？）

`with`使用打开文件始终是一种好习惯。然后你知道文件将在你完成后正确关闭。

我们使用列表推导来构建 的结果列表，`ast.literal_eval()`对于给定的输入文件，它每行返回一个列表，因此`alist`将是一个列表列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T21:14:06.417

如果您只是继承或下载了这些文件并且无法对格式做任何事情，并且您知道它们应该被视为 Python`list`的行，`ast.literal_eval`那么这是最好的答案，正如 steveha 解释的那样：

```
t = open('filename.txt', 'r')
alist = []    
for i in contents:
    alist.append(ast.literal_eval(i)) 
```

* * *

如果您继承或下载了这些文件，并且只是猜测格式，那么它们实际上可能打算被读取为 JSON 行，因为它们绝对是有效的 JSON，就像它们是有效的 Python 文字一样。在这种情况下：

```
t = open('filename.txt', 'r')
alist = []    
for i in contents:
    alist.append(json.loads(i)) 
```

* * *

但是，如果您是首先创建这些文件的人，那么您应该以专为序列化设计的方式创建它们。

例如，而不是这个：

```
t = open('filename.txt', 'w')
for i in alist:
    print >>t, i 
```

做这样的事情：

```
t = open('filename.txt', 'w')
json.dump(alist, t) 
```

然后你可以这样写你的阅读代码：

```
t = open('filename.txt', 'r')
alist = json.load(t) 
```

JSON、YAML 或 Pickle 等序列化格式的全部意义在于，它们是专门设计的，以便您可以写入一个值，然后再读回相同的值。

`print`,`str`等函数*不是*为此而设计的；它们的设计使您可以以最好的人类可读形式显示一个值，即使以后很难或不可能读回。

该功能`repr`介于两者之间。它的设计目的是让玩交互式提示的人可读，因此如果可能的话，它会为您提供一个字符串，您可以在提示中键入该字符串以获取相同的值。这意味着，在某些情况下，`ast.literal_eval`是 的倒数`repr`，就像`json.load`的倒数一样`json.dump`。但是你不应该依赖这个，即使在处理它工作的类型时也是如此。

* * *

关于您的代码的一些附注：

```
t = open('filename.txt', 'r+w') 
```

如果您只是要读取文件，请不要尝试打开它进行写入。此外，如果您*确实*想同时打开读取和写入，则正确的模式字符串是`r+`，而不是`r+w`。（你这样做的方式在技术上是一个错误，但大多数 Python 版本都会忽略`w`，所以你可以侥幸逃脱。）

如果模式是`r`，则根本不需要指定它，因为这是默认设置。

同时，你永远不会`close`文件。最简单的方法是使用`with`语句。

```
contents = t.readlines() 
```

几乎从来没有一个很好的理由打电话`readlines()`。这为您提供了一系列行 - 但文件本身*已经*是一系列行。你所做的只是制作一个额外的副本。

```
alist = []

for i in contents:
    alist.append(i) 
```

这种模式——创建一个空列表，然后在循环中附加到它——是如此普遍，以至于 Python 有一个快捷方式，称为列表推导。与显式循环相比，理解更简洁、更易读、更难出错、速度更快，因此大部分时间都值得使用它们。

最后，最好给变量起有意义的名称。特别是如果您希望其他人（或您自己，六个月后）能够调试您的代码。如果它工作得很好，我们可以通过它们的作用来判断变量的含义——但如果不是，我们就无法修复它，除非我们能猜出它们*应该*是什么意思，而名称是表明这一点的最佳方式。

所以，把它们放在一起，你的原始代码可以写成：

```
with open('filename.txt') as textfile:
    alist = [line for line in textfile] 
```

各种固定版本是：

```
with open('filename.txt') as textfile:
    alist = [ast.literal_eval(line) for line in textfile]

with open('filename.txt') as textfile:
    alist = [json.loads(line) for line in textfile]

with open('filename.txt') as textfile:
    alist = json.load(textfile) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:58:19.577

你所拥有的是一个字符串列表。一个带有括号和逗号的字符串并不是一个神奇的列表，它只是一个带有括号和逗号的字符串。

`alist`是列表。在您的循环中，`a`是该列表中的一个项目：首先，它是`alist[0]`，然后`alist[1]`依此类推。因此，`a[0]`要求`alist[0][0]`,`alist[1][0]`等：每行的第一个字符。这就是你得到的。

如果要将其转换为实际的 Python 列表，请使用`ast.literal_eval()`.

# blackberry - 黑莓 BrowserField2Demo 重定向

> ID：15233844
> 
> 赞同：0
> 
> 时间：2013-03-05T20:50:04.090
> 
> 标签：blackberry, browserfield

我正在 BrowserField2Demo 中使用 JDE 7.1，想知道如何拦截“预加载”事件。“OLD” BrowserFieldDemo 具有诸如“Event.EVENT_URL_REQUESTED”之类的事件，这些事件将允许 URL 预加载操作。“BrowserField2”在哪里发生这些事件？

示例：如果请求的 URL 是“ [http://www.bing.com/](http://www.bing.com/) ”并且我希望将其重新定向到“ [http://www.google.com/](http://www.google.com/) ”这个“预加载”事件在哪里发生?

这是我在尝试失败后的代码，但它不起作用：

* * *

```
private BrowserField _browserField;    
private boolean _documentLoaded = false;
private BrowserFieldRequest _request;

/**
 * Creates a new BrowserFieldScreen object
 * @param request The URI of the content to display in this BrowserFieldScreen
 * @param enableScriptMenu True if a context menu is to be created for this BrowserFieldScreen instance, false otherwise
 */
public BrowserFieldScreen(BrowserFieldRequest request, boolean enableScriptMenu)
{    
    super(Screen.HORIZONTAL_SCROLL);

    BrowserFieldConfig config = new BrowserFieldConfig();  
    config.setProperty(BrowserFieldConfig.ALLOW_CS_XHR, Boolean.TRUE);
    config.setProperty(BrowserFieldConfig.JAVASCRIPT_ENABLED, Boolean.TRUE);
    config.setProperty(BrowserFieldConfig.NAVIGATION_MODE,BrowserFieldConfig.NAVIGATION_MODE_POINTER);
    config.setProperty(BrowserFieldConfig.CONTROLLER, controller);
    _browserField = new BrowserField(config);
    add(_browserField);
    _request = request;        
}    

ProtocolController controller = new ProtocolController(_browserField)    
{    
    public void handleNavigationRequest(BrowserFieldRequest request) throws Exception    
    {    
        InputConnection inputConnection = handleResourceRequest(request);    
        _browserField.displayContent(inputConnection, request.getURL());    
    }    
}; 
```

* * *

我看到的是，第一次`handleNavigationRequest`被调用的是它崩溃并显示错误消息

> google.com 错误消息的错误请求内容 null

带有**关闭**按钮。然后什么也没有发生。

# ipad - 覆盖 scrollViewWillEndDragging 时，UICollectionView 并不总是动画减速

> ID：15233845
> 
> 赞同：4
> 
> 时间：2013-03-05T20:50:06.307
> 
> 标签：ipad, uiscrollview, paging, uicollectionview, custompaging

我正在为我的 UICollectionView 创建自定义分页。我希望底部的一些单元格悬挂在屏幕边缘，但是，通过常规分页，滚动到下一页意味着如果页面底部的一半单元格正在显示，它只会显示另一半在下一页。我想让单元格挂在末端，但停止分页，以便悬挂在屏幕上的单元格清晰可见。

所以，为此我覆盖了函数 - (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset

如果我拖动一两秒钟，它会按预期工作，但是，我正在尝试模拟启用分页时效果很好的“轻弹”。当我轻弹 UICollectionView 时，它会跳转到 targetContentOffset，而不是对其进行动画处理。

我该如何防止这种情况？

这是我的代码：

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset {

    if(targetContentOffset->y < 400) {
        targetContentOffset->y = 0;
        return;
    }

    int baseCheck = 400;

    while(baseCheck <= 10000) {
        if(targetContentOffset->y > baseCheck && targetContentOffset->y < baseCheck + 800) {
            targetContentOffset->y = (baseCheck + 340);
            return;
        }
        baseCheck += 800;
    }

    targetContentOffset->y = 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-19T21:24:35.337

我遇到了同样的问题并设法解决它。就我而言，我正在模拟一个分页滚动视图（实际上是一个 UICollectionView），其中页面大小小于 collectionView 本身的大小。我注意到滚动的“跳跃”发生在一定的条件下：

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset {
    CGFloat pageWidth; // defined somewhere else
    NSInteger numberOfPages; // depends on your dataSource
    CGFloat proposedOffset = targetContentOffset->x;
    NSInteger currentPage = roundf(self.collectionView.contentOffset.x / pageWidth);
    NSInteger proposedPage = roundf(proposedOffset / pageWidth);
    // what follows is a fix for a weird case where the scroll 'jumps' into place with no animation
    if(currentPage == proposedPage) {
        if((currentPage == 0 && velocity.x > 0) ||
           (currentPage == (numberOfPages - 1) && velocity.x < 0) ||
           (currentPage > 0 && currentPage < (numberOfPages - 1) && fabs(velocity.x) > 0)
           ) {
            // this forces the scrolling animation to stop in its current place
            [self.collectionView setContentOffset:self.collectionView.contentOffset animated:NO];
            [UIView animateWithDuration:.3
                                  delay:0.
                                options:UIViewAnimationOptionCurveEaseOut
                             animations:^{
                                 [self.collectionView setContentOffset:CGPointMake(currentPage * pageWidth, 0)];
                             }
                             completion:NULL];
        }
    }
    targetContentOffset->x = (pageWidth * proposedPage);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T14:53:28.040

它直接“跳转”到 targetContentOffset，因为它使用给定的速度。轻弹具有非常高的速度。你应该检查速度的值，如果高于某个速率（我认为大约 2，但你可以调整），那么你自己做动画（用一个简单的`[scrollView setContentOffset:contentOffset animated:YES];`

# java - 从一维数组构建图像

> ID：15233847
> 
> 赞同：2
> 
> 时间：2013-03-05T20:50:11.843
> 
> 标签：java, image, image-processing, bufferedimage, grayscale

我有一个一维数组像素，其中包含 512x512 灰度图像的像素值。我想把它写成一个png文件。我编写了以下代码，但它只是创建了一个空白图像。

```
 public void write(int width ,int height, int[] pixel) {

       try {
// retrieve image
BufferedImage writeImage = new BufferedImage(512,512,BufferedImage.TYPE_BYTE_GRAY);
File outputfile = new File("saved.png");
WritableRaster raster = (WritableRaster) writeImage.getData();
raster.setPixels(0,0,width,height,pixel);

ImageIO.write(writeImage, "png", outputfile);

} catch (IOException e) {

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:19:26.853

> 返回的 Raster 是图像数据的副本，如果图像发生更改，则不会更新。

尝试将新的光栅对象设置回图像。

```
WritableRaster raster = (WritableRaster)writeImage.getData();
raster.setPixels(0, 0, width, height, pixel);
writeImage.setData(raster); 
```

# string - 插件（WoW，Lua）导致严重错误

> ID：15233851
> 
> 赞同：1
> 
> 时间：2013-03-05T20:50:36.307
> 
> 标签：string, lua, access-violation, gsub, lua-patterns

我正在搜索聊天中的某些单词，然后将它们发送到指定的聊天框它可以工作但随机导致错误并导致游戏崩溃的插件

```
此应用程序遇到严重错误：
错误 #132 (0x85100084) 致命异常
程序：C:\WoW\Wow.exe
例外：0023:00416DB0 处的 0xC0000005 (ACCESS_VIOLATION)

“0x00416DB0”处的指令引用了“0x1F97FFFE”处的内存。
无法“读取”内存。

```

崩溃后我打开作弊引擎浏览该区域，看看那里有什么

```
1F97FFFE：http://i.imgur.com/D7XKi2D.jpg
00416DB0：http://i.imgur.com/duTM315.jpg
```

和插件代码：

```
--事件 CHAT_MSG_CHANNEL
如果事件 == "CHAT_MSG_CHANNEL" 那么
    如果 TriggerEnabled 然后
        本地 arg1 = string.lower(arg1)
        本地找到，转储 = 假，假

        对于 k,v 成对（lsus.Triggers）做
            如果没有找到那么
                对于 k,v 成对 (lsus.NegTriggers) 做
                    如果 (string.find(arg1, v)) 那么
                        转储=真
                    结尾
                结尾

                if (string.find(arg1, v)) 并且不转储 then
                    本地输出 = " [\124Hplayer:" .. arg2 .. ":1:WHISPER\124h" .. arg2 .. "\124h\124r]: " .. arg1:gsub(v, "\124c0000FF00\124h" . . string.upper(v) .. "\124h\124r")
                    打印（输出，0.41，0.80，0.94）
                    找到=真
                结尾
            结尾
        结尾
    结尾
结尾

--打印功能
功能打印（味精，r，g，b）
    如果不是 r 那么
        ChatFrame1：添加消息（消息）
    别的
        ChatFrame1:AddMessage(msg, r, g, b)
    结尾
结尾

```

谁能帮我解释为什么这会导致游戏崩溃？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:17:41.233

可能不是您的情况，但请尝试使用`string.find(arg1, v, 1, true)`而不是`string.find(arg1, v)`避免由于模式中的魔术字符导致的意外行为。

```
-- Example:
local str = 'string.find hangs on this string'
string.find(str, '.*.*.*.*.*.*.*.*.*.*.*#') 
```

# ruby - 构建乘客 apache2 模块：没有要加载的文件——rubygems builder

> ID：15233856
> 
> 赞同：2
> 
> 时间：2013-03-05T20:50:38.820
> 
> 标签：ruby, rubygems, apache2, passenger

我想在 debian 挤压服务器上构建乘客 3.0.19 apache2 模块。以 root 身份调用乘客安装 apache2-module 后，我收到以下错误消息：

```
Compiling and installing Apache 2 module...
cd /usr/lib/ruby/gems/1.8/gems/passenger-3.0.19
/usr/bin/ruby1.8 /usr/bin/rake apache2:clean apache2 RELEASE=yes
# /usr/bin/ruby1.8 /usr/bin/rake apache2:clean apache2 RELEASE=yes
rake aborted!
no such file to load -- rubygems/builder 
```

哪里有问题？我怎样才能解决这个问题？使用passenger-install-apache2-module --trace 不起作用（对于完整的堆栈跟踪）。

![没有要加载的文件——rubygems/builder](../Images/60f1dddf2171a54037911551f7557e13.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T22:33:52.407

我使用了来自 git 存储库的最新乘客版本（实际上是 4.0.0.rc4）并创建了一个 gem。使用这个宝石效果很好。

```
git clone https://github.com/FooBarWidget/passenger.git
cd passenger
gem build passenger.gemspec
gem install passenger-*.gem 
```

之后，您可以使用passenger-install-apache2-module 构建apache2 插件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-03T15:55:04.523

我有一个类似的环境（乘客 3.0.9，Ruby 1.8.7），我通过降级 ruby​​gems 解决了这个问题。

最新的稳定 RVM 将安装 ruby​​gems v(2+)。我降级到 ruby​​gems v(1.6.2)，重新安装了乘客 gem，问题就消失了。

在 RVM 环境中，命令是`gem update --system 1.6.2`

rubygems 的 1.8.x 版本也可以使用，但它会在您所做的所有事情上抛出过多的弃用警告。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T20:56:17.413

几分钟前我在这里回答了一个类似的问题：[Passenger: cannot load such file ruby​​gems/builder](https://stackoverflow.com/questions/15232856/passenger-cannot-load-such-file-rubygems-builder)

本质上是 Ruby 2.0 的一个问题。我在那里提供了一个可能的解决方案（摘自 github 评论）。

如果您没有使用 Ruby 2.0，那么您可能需要这样做：`gem install builder`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-19T06:52:45.687

如果您正在运行 Ruby 2

编辑文件 config/rubber/ **rubber-passenger.yml**和

换行

```
passenger_version: 3.0.19 
```

到

```
passenger_version: 4.0.35 # works fine with 4.0.35 but you can try a newer version 
```

记得检查 config/rubber/ **rubber-ruby.yml中的 Ruby 版本**

```
ruby_version: 2.0.0-p247 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-09T19:05:05.850

确保你有 zlibc。

sudo apt-get install zlibc zlib1g zlib1g-dev

然后重新安装或重新编译 ruby​​。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-28T16:11:37.867

有完全相同的问题。在 Amazon Linux 上，以下工作正常：

```
gem install passenger && passenger-install-apache2-module 
```

运行“宝石安装乘客”将最新版本添加到系统中。也删除了旧的：

```
#gem list passenger

*** LOCAL GEMS ***
passenger (4.0.10, 3.0.19)

#gem uninstall passenger

Select gem to uninstall:
 1\. passenger-3.0.19
 2\. passenger-4.0.10
 3\. All versions
> 1
Successfully uninstalled passenger-3.0.19 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-05T16:56:18.190

我遇到过同样的问题。为了解决这个问题，我不得不降级 ruby​​gems 包。我的配置是`passenger 3.0.2`和`rubygems 1.3.7`。

# java - 如何更改单条java fx的颜色

> ID：15233858
> 
> 赞同：5
> 
> 时间：2013-03-05T20:50:41.240
> 
> 标签：java, javafx, bar-chart

这是我的代码，它生成从 0 到 10 的 10 个值的条形图。我想改变条的颜色如下

如果 i>5 颜色==红色 如果 i>8 颜色==蓝色

所以最终出局将是 0-5（默认黄色条） 6-8（红色条） 9（蓝色条）

请帮助我..谢谢

```
public class BarChartSample extends Application {

    @Override
    public void start(Stage stage) {
        stage.setTitle("Bar Chart Sample");
        final CategoryAxis xAxis = new CategoryAxis();
        final NumberAxis yAxis = new NumberAxis();
        final BarChart < String, Number > bc = new BarChart < String, Number > (xAxis, yAxis);

        bc.setTitle("Country Summary");
        xAxis.setLabel("bars");
        yAxis.setLabel("Value");
        XYChart.Series series1 = new XYChart.Series();
        series1.setName("...");

        for (int i = 0; i < 10; i++) {
            //here i want to change color of bar if value of i is >5 than red if i>8 than blue
            series1.getData().add(new XYChart.Data("Value", i));
        }
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T22:31:37.580

我创建了一个[示例解决方案](https://gist.github.com/jewelsea/5094893)。

该解决方案通过`-fx-bar-fill`根据条形数据的值将条形的颜色设置为不同的颜色来工作。

```
final XYChart.Data<String, Number> data = new XYChart.Data("Value " + i , i);
data.nodeProperty().addListener(new ChangeListener<Node>() {
  @Override public void changed(ObservableValue<? extends Node> ov, Node oldNode, Node newNode) {
    if (newNode != null) {
      if (data.getYValue().intValue() > 8 ) {
        newNode.setStyle("-fx-bar-fill: navy;");
      } else if (data.getYValue().intValue() > 5 ) {
        newNode.setStyle("-fx-bar-fill: firebrick;");
      }  
    }
  }
}); 
```

![彩色条形图](../Images/6c5fa38a86ff64c3eb6f24a67ec2f7bb.png)

# ruby - Ruby 风格提示：避免使用 eval，保持事情清晰有序

> ID：15233865
> 
> 赞同：1
> 
> 时间：2013-03-05T20:51:00.447
> 
> 标签：ruby, arrays, eval

我对此感到困惑。我有几个可行的解决方案，但我不喜欢其中任何一个。手头的问题是我试图在 Rails 应用程序中生成 CSV。具体来说，在我的应用程序中，我有很多值，大约 30。我想显示的许多值也在关联上，因此使行更长......它们看起来像这样（不要费心阅读，只是想让你知道我在说什么）：

`[piece.client.organization, piece.client.category, piece.client.name , piece.campaign.name, piece.name, piece_url(piece.id), piece.campaign.election_date, piece.campaign.win_loss, piece.final_date, piece.local_photos, piece.killed, piece.format_list, piece.artist_list, piece.partner_list, piece.account_executive_list, piece.out_of_stock, piece.total_intake, piece.campaign.candidate_tags, piece.client.spec_list, piece.campaign.mail_poll]`

除了它们更长，更笨重。他们工作，但他们让我内心感觉很糟糕。这是当我想到将它们放入二维数组时，它立即使数据看起来更具可读性：

```
[["Client",       piece.client.organization], 
["Category",      piece.client.category], 
["Client Name",   piece.client.name] , 
...
["Campaign Name", piece.campaign.name], 
["Piece Name",    piece.name]] 
```

太好了，现在我可以遍历它来创建我的 CSV 行......但是，它会根据我需要定义它的位置而爆炸，因为我的“片段”是未定义的。那么，我想......如果我只是将第二个参数用引号括起来，然后在我需要它们时对它们调用 eval 怎么办？然后我查了一下，人们似乎说使用 eval 只是为了挽救生命......

谁能想到一种更简单的方法来保持我的所有数据与列名配对，但可能不使用 eval？或者也许建议这将是 eval 的一个很好的用例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:57:47.843

您通常可以`eval`通过使用块来避免。例如，根据方法调用重新定义您的结构：

```
columns = [
  [ "Client", lambda { |piece| piece.client.organization } ],
  [ "Category", lambda { |piece| piece.client.category } ],
  # ...
] 
```

然后在遍历您的块时，执行以下操作：

```
pieces.each do |piece|
  spec.each do |label, proc|
    value = proc.call(piece)

    # ... Do whatever you need here
  end
end 
```

定义块（内部 Proc）可以帮助定义做事的方法，同时将变量绑定推迟到将来的某个时间点。

`eval`以危险着称，因为它可以执行任何操作。除非真的没有其他办法，否则最好避免它。

# java - SQLite - WHERE 子句中 IS 和 =（等于）之间的区别。（使用 JDBC PreparedStatement）

> ID：15233870
> 
> 赞同：2
> 
> 时间：2013-03-05T20:51:18.850
> 
> 标签：java, sqlite, comparison, equals, where

编辑：与 a_horse_with_no_name 交谈我发现 SQLite 中的“IS”有点不同，允许使用“IS”比较 NULL*和*值：[stackoverflow.com/a/9102445/1470058](https://stackoverflow.com/a/9102445/1470058)。这为我消除了很多困惑。谢谢：

> IS 和 IS NOT 运算符的工作方式与 = 和 != 类似，除非其中一个或两个操作数为 NULL。在这种情况下，如果两个操作数都为 NULL，则 IS 运算符的计算结果为 1（真），而 IS NOT 运算符的计算结果为 0（假）。如果一个操作数为 NULL 而另一个不是，则 IS 运算符的计算结果为 0（假）并且 IS NOT 运算符为 1（真）。IS 或 IS NOT 表达式不可能计算为 NULL。运算符 IS 和 IS NOT 与 = 具有相同的优先级。

* * *

我对 SQLite 中的关键字“IS”感到困惑。

我正在做一个需要我使用 Java 准备好的语句的项目。我遇到了两种类型的 WHERE 子句：

```
SELECT * FROM table WHERE column = ? 
```

和

```
SELECT * FROM table WHERE column IS NULL 
```

我的问题是等号“=”或“IS”这个词之间有什么区别吗？Google 搜索显示，大多数人使用 = 进行值比较，使用 IS 与 null 进行比较。但是我尝试了一些我自己的 SQLite 查询。

*   “IS”将按预期返回“ *column IS NULL* ”和“ *column IS value* ”的结果。
*   “=”将按预期返回“ *column = value* ”的结果，但**不会**返回“ *column = NULL* ”的结果。

我的问题是我可以在这两种情况下都使用“IS”而不会产生意外结果吗？我想为单个查询制作一个准备好的语句，该查询对列的约束可能为空，也可能不为空。我希望我是有道理的。

为了简化我所说的一切，我是否可以使用以下 Java 代码而不会因使用“IS”而产生意外影响：

```
private static final String queryProjectSql = "SELECT * FROM fields WHERE project IS ?";
// later in a method
sqlStatement = connection.prepareStatement(queryProjectSql);
sqlStatement.setString(1, project); //Project may be a String or null 
```

谢谢你

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2016-07-05T02:52:49.583

上面的答案是错误的。他们说在所有情况下都必须使用“=”，而空值必须使用“IS”。这不是文档所说的。

文档说这两个运算符是等效的，唯一的区别在于它们如何评估 null。= 两边的 NULL 将评估为 false。IS 将评估 NULL 条件的真实性。

这个 NULL = NULL 将由操作员的设计为假，而 NULL is NULL 将是真的。

在某些情况下，您可能不关心列是否具有空值或合法的与您的查询不匹配。在这种情况下，您将使用 = ... 并且在某些情况下您确实关心 null 在这种情况下您将使用 'is' 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:53:18.283

在 SQL 中，使用逻辑运算符（例如 =、!=、< 等）将空值与任何其他值（包括另一个空值）a 进行比较将导致空值，出于 a 的目的，这被视为假where 子句。原因是 null 表示“未知”，因此与 null 进行任何比较的结果也是“未知”。因此，使用 my_column = null 不会对行产生任何影响。

SQL 提供了特殊的语法来测试列是否为空，通过是否为空和不为空，这是测试空（或非空）的特殊条件。

```
 x is null checks whether x is a null value.
 x = null is checking whether x equals NULL, which will never be true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T20:53:39.800

在 SQL 语言中，“IS”仅在与 NULL（IS NULL 或 IS NOT NULL）比较时使用，因为 x = NULL 总是会失败（NULL 不等于任何东西）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:39:43.730

我不确定您是否可以使用“Is”而不是“=”，但 null 除外，但我可以说您不能使用“=”符号将列与 null 进行比较。您应该使用“Is null”或“Is not null”。原因是在 SQL 中，一个 null 不等于另一个 null。这意味着如果您编写类似 null = null 的内容，它将返回 false。因此，请考虑这样一种情况，您的列不包含任何在数据库中意味着它为空的内容，并且您尝试使用“=”将此空值与另一个空值进行比较，这将永远不会让您恢复真实。

请参阅 Codd 规则 3：空值的系统处理。它说一个空值不等于关系数据库中的另一个空值。

我从 wiki 分享这个：[http://en.wikipedia.org/wiki/Null_(SQL)](http://en.wikipedia.org/wiki/Null_(SQL))

对于不是数据库专家的人来说，记住 null 意味着什么的一个好方法是记住，就信息而言，“缺少值”与“零值”不同。同样，“缺乏答案”与“否定答案”不同。例如，考虑“胡安拥有多少本书？”这个问题。答案可能是“零”（我们知道他没有拥有）或“空”（我们不知道他拥有多少，或者不拥有）。在数据库表中，报告此答案的字段将以 null 值开始，并且在我们确定 Juan 没有书籍之前，它不会被更新为“零”。同样，当问题是“胡安妮塔有车吗？”时，答案“我们不知道”与“

希望这会有所帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T20:53:14.423

如果列值为null，则=运算符在与null比较时永远不会返回true，因此NULL！= NULL，因此需要使用IS NULL进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T20:56:04.360

“IS”关键字严格与 NULL 值一起使用。（例如，IS NULL 或 IS NOT NULL）。

如果您正在寻找匹配项，则需要使用 =。

如果您担心处理空列值，那么您应该使用 isnull() 函数包装关注的列。

```
SELECT Col1
   , Col2
   , isnull(Col3,'') AS Col3
FROM myTable
Where col1 = 'somevalue' 
```

# windows - 有没有办法安排 Photoshop 批处理

> ID：15233874
> 
> 赞同：0
> 
> 时间：2013-03-05T20:51:34.673
> 
> 标签：windows, automation, photoshop

我有一个 Photoshop 批处理，需要在大约 70 多个文件夹上运行，至少每天一次。

现在，我们手动打开 Photoshop，加载批处理，选择一个 in 和 out 文件夹，然后运行它。

如果可能的话，我希望这会自动发生，因为手动完成它大约需要一分钟，每天的工时超过一个小时。

我试过用谷歌搜索它，但这对谷歌来说并不是最简单的事情，因为我希望自动化一个自动化过程:)。

目前我们正在使用 CS5.5，但不久将升级到 CS6，在 Windows 上运行。

如果有人对如何执行此操作有任何经验或想法，我将不胜感激。

亚伦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T11:47:34.487

导入/导出路径多久更改一次？不了解整个过程的性质，很难评估其难度。你能不能为每个进程创建一系列液滴（从a导入->进程->放入b，从a导入->进程->放入c等）听起来你需要一个脚本来控制整个过程，用户界面在开始时提供各种选项，这将加快速度。

# actionscript-3 - 如何从 SWC 在 Flash Builder 项目中添加 SimpleButton？

> ID：15233881
> 
> 赞同：0
> 
> 时间：2013-03-05T20:51:54.650
> 
> 标签：actionscript-3, flash-builder, flash-cs3, swc, simplebutton

我从 Flash CS3 导出了一个 SWC，并且资产可以正常工作，除了按钮，它们看起来像另一个库项目。

编码：

```
package {
    // ...
    import flash.display.Sprite;
    import flash.display.SimpleButton;
    import res.botoes.Pause;
    // ...

    public class Cena extends Sprite {
        // ...
        private var botao:SimpleButton;
        // ...

        public function Cena() {
            // ...
            botao = new Pause() as SimpleButton;
            addChild(botao);
            // ...
        }
        // ...
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T08:15:48.797

试试这个;
首先创建 SimpleButton 和 Pause 实例，然后将 Pause 转换为 SimpleButton，确定语法，否则检查您的自定义类

```
// ...
         private var _pause:Pause();
         private var botao:SimpleButton;
// ...
         public function Cena() {
            // ...
            _pause = new Pause();
            _botao = new SimpleButton();
            botao = _pause as SimpleButton;
            addChild(botao);
            // ...
         }
// ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:14:03.773

解决了。

我的新解决方案：为按钮的每个状态制作一个 MovieClip，然后以这种方式构造按钮：

```
var pause:SimpleButton = new SimpleButton(
        new PauseU().
        new PauseO(),
        new PauseD(),
        new Mascara()
    ); 
```

# php - 在所有请求之前运行 php 代码

> ID：15233884
> 
> 赞同：0
> 
> 时间：2013-03-05T20:52:00.840
> 
> 标签：php, nginx

我有一大块 php 代码，我想在我的服务器上的每个请求上执行/包含，**而**不必更改我的代码库中的每个 php 文件。在 CentOs 6 上使用 NGINX 和 php 5.3 时有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T20:53:34.923

使用`auto_prepend_file`配置指令。

# scala - 如何根据不同的优先级条件找到元素？

> ID：15233885
> 
> 赞同：1
> 
> 时间：2013-03-05T20:52:01.327
> 
> 标签：scala

一个优雅的 Scala 解决方案如何找到一个匹配任何一组条件的元素，但每个条件都有不同的优先级？

```
case class A(p1:Int, p2:Int)

List(A(2,3), A(4,4), A(3,5)) 
```

假设我要查询：找到一个项目`p1 == p2`，如果你没有找到它，给我一个项目，如果你`p2 > p1`没有找到它，给我`p1 = square(p2)`等等。总是`=> Bool`

我的第一个猜测是递归查找函数，它在每个循环中尝试一个条件，但我想知道是否有更好/更简单的方法来做到这一点。

理想情况下，如果项目符合更多条件，则应选择它，但仍尊重条件优先级。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:01:08.413

```
l.find{x => x.p1 == x.p2}.getOrElse(l.maxBy(_.p2)) 
```

**更新**：在您更新的问题中，您说“给我 p2 最大的项目，如果找不到，请给我最低 p1 等等”。但是根据定义，总是有一个最大值（除非列表为空，但我认为列表不能为空）。所以这实际上只是“给我最大 p2 的项目”（因此上述解决方案）。

**更新 2**：所以问题又变了，现在是“找到 p1 == p2 的项目，如果找不到，请给我 p2 > p1 的项目，如果找不到，请给 p1 =方（p2）等等”。我想你毕竟真的需要一个通用的解决方案。所以这是我的看法：

```
// The list of predicates, in order of priority 
// (you can add/remove predicates as you see fit)
val predicates = List[A => Boolean]( 
  x => x.p1 == x.p2, 
  x => x.p2 > x.p1, 
  x => x.p1 ==  x.p2*x.p2
)

val indexedPredicates = predicates.reverse.zipWithIndex
def score( x: A ): Option[Int] = indexedPredicates.find(_._1(x)).map(_._2)
def priorityFind( l: List[A] ): A = l.maxBy(score) 
```

这个想法是你为每个元素赋予一个分数：如果元素不匹配任何谓词，则为 None，如果它匹配最后一个谓词，则 Some(0)，如果它匹配最后一个但一个谓词，则 Some(1)，依此类推。然后你只取得分最高的那个（`None`比任何`Some`实例都“小”，所以这与我们想要的一致）。

如果你想正确处理没有元素匹配任何谓词的情况，你可以这样改变`priorityFind`：

```
def priorityFind( l: List[A] ): Option[A] = {
  val filtered = l.view.flatMap{x => score(x).map(x -> _) }
  if ( filtered.isEmpty ) None
  else Some( filtered.maxBy(_._2)._1 )
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:57:06.643

```
list.find(i => i.p1 == i.p2).getOrElse(list.sortBy(-_.p2).head) 
```

**更新**，应该符合您的新要求。

```
 list.find(i => i.p1 == i.p2).getOrElse(
  list.find(i => i.p2 > i.p1).getOrElse(
  list.find(i => i.p1 == i.p2 * i.p2))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:29:22.513

好的，我想出了这个：

```
case class A(p1:Int, p2:Int)
val list = List(A(3,2), A(4,4), A(10,2), A(4,2))
val filter:PartialFunction[A,A] = {
  case a@A(p1,p2) if p1==p2 => a
  case a@A(p1,p2) if p2>p1 => a
  case a@A(p1,p2) if p1==p2*p2 => a
}

list.collect(filter).foreach(println) 
```

现在，如果你需要最合适的，我会做一个排名函数，而不是映射 A => Int 然后按它排序。您可以通过先过滤然后再根据您的排名进行排序来节省一些工作。（收集需要 list.size 时间，而排序平均需要 list.size * log(list.size)）

# java - Rectangle.getX() 返回上角还是中心？

> ID：15233890
> 
> 赞同：1
> 
> 时间：2013-03-05T20:52:17.120
> 
> 标签：java, awt, rectangles, coordinate

假设我有一个`java.awt.Rectangle`设置：

```
x - - - - - - -
| - - - - - - - |
| - - - - - - - |
| - - - - - - - |
| - - - y - - - |
| - - - - - - - |
| - - - - - - - |
- - - - - - - - - 
```

是否返回or`getX()`的 x 坐标？`x``y`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:29:05.197

`getX()`返回**左上角的**x 坐标。

消息来源说明了一切：

**查看`Rectangle(x, y, width, height)`构造函数：**

```
public Rectangle(int x, int y, int width, int height) {
   this.x = x;
   ...
} 
```

**上述[文档](http://docs.oracle.com/javase/7/docs/api/java/awt/Rectangle.html)说：**

> 构造一个左上角指定为 (x,y) 的新 Rectangle

**看着`getX()`：**

```
public double getX() {
   return x;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:01:47.270

getX() 将返回上角。Java 中 Rectangle 的信息是 x,y,width,height，所以这些是您可以在本地设置和检索的值。

# visual-studio-2010 - SSIS 包部署到远程 SQL Server 2012

> ID：15233891
> 
> 赞同：1
> 
> 时间：2013-03-05T20:52:35.637
> 
> 标签：visual-studio-2010, deployment, ssis, package

我已经创建了 SSIS 包

VS 2010 外壳

我能够成功地将我的包部署到`SSISDB/Folder/Projects/PackageName`（本地服务器）

但我无法将其部署到远程 SQL Server 2012。

我怎样才能做到这一点？

我在 VS 2010 Shell 中的文件系统/MS SQL Server 包部署在哪里？

我试过这个：将包（ispac）FTP到远程数据库服务器并从那里运行它。当我尝试时，我收到以下错误

```
Warning: Failed to decrypt an encrypted XML node. Verify that the project was created by the same user. Project load will attempt to continue without the encrypted information.

Warning: Failed to decrypt sensitive data in project with a user key. You may not be the user who encrypted this project, or you are not using the same machine that was used to save the project. If the sensitive data is a parameter value, the value may be required to run the package on the Integration Services server. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T00:32:08.833

所以......你的问题有很多要解开。

在 SQL Server 2012 中，Microsoft 引入了一种新的默认部署模型，即项目部署模型。您无需部署单独的 .DTSX 包文件，而是“构建”一个项目部署文件（您的 .ISPAC）并将其部署*到*服务器上。

这就是为什么您看不到文件系统/包部署模型的原因。如果您想将项目的部署模型更改为包部署模型，则可以。只需右键单击项目并选择“转换为包部署模型”，然后您就可以像以前一样继续将包单独部署到文件系统或 MSDB 存储。

（顺便不推荐这个，项目部署挺甜的。）

所以一个问题是，当您为您的 SSIS 项目完成 VS2010 的部署过程并选择远程服务器作为您的部署目标时，您会看到什么错误？

对于您的加密问题，请阅读[有关 SSIS 包中的访问和安全控制的链接](http://msdn.microsoft.com/en-us/library/ms141747.aspx)，并特别注意底部标题为**“基于包生命周期的保护级别设置”**的部分，其中包含迁移时修改包加密级别的一些最佳实践从开发环境打包到生产环境。

# jquery - addClass 基于变量值

> ID：15233897
> 
> 赞同：0
> 
> 时间：2013-03-05T20:53:00.727
> 
> 标签：jquery, html, input, filter

我想在有人输入输入表单后添加一个类。这有效并突出显示了我页面中的“咨询”一词：

```
var value = "Advisory"; 

$("a:contains("+ value +")").addClass("highlight"); 
```

这有效，并给我一个警报，显示用户输入的内容：

```
$(document).ready(function() {

$("#filterinput").change(function(){
var value = $(this).val();

alert(value);

});
}); 
```

但这不起作用（我尝试了各种引号组合等）：

```
$(document).ready(function() {

$("#filterinput").change(function(){
var value = $(this).val();

$("a:contains('"+ value +"')").addClass("highlight").load();

   });
}); 
```

有人可以帮忙吗？

已编辑。我的代码真的很长，但这是我想搜索的 html 示例。第一个正在运行的示例突出显示“历史保护咨询委员会”的整个文本，因为那是锚标记之间的内容。

```
<ul class="treebranch">
  <li class="govdocs"> <a href="http://www.archives.gov/federal-register/acfr/">Administrative Committee of the Federal Register</a></li>
  <li class="govdocs"> <a href="http://www.achp.gov/index.html">Advisory Council on Historic Preservation</a></li>
  <li class="govdocs"> <a href="http://www.abmc.gov/home.php">American Battle Monuments Commission</a></li>
  <li class="govdocs"> <a href="http://www.arc.gov/">Appalachian Regional Commission</a></li>
  <li class="govdocs"> <a href="http://www.access-board.gov/">Architectural and Transportation Barriers Compliance Board (Access Board)</a></li>
  <li class="govdocs"> <a href="http://www.arctic.gov/">Arctic Research Commission</a></li>
  <li class="govdocs"> <a href="http://www.afrh.gov/">Armed Forces Retirement     Home</a></li> 
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:15:41.377

我建议使用`grep`它而不是复杂的 CSS 选择器。

JsFiddle 展示了它是如何工作的：http: [//jsfiddle.net/GZHA4/1/](http://jsfiddle.net/GZHA4/1/)

这将使您更好地控制它的匹配方式。例如，如果您想要不区分大小写，您可以将`value`and都大写或小写`$(element).text()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:54:03.197

为什么`load()`在将类添加到所选元素后调用？jQuery 有两种`load()`方法，一种是 AJAX 方法，用于从服务器加载数据并将其插入到所选元素中。另一种是将事件处理程序添加到要在 DOM 中加载后执行的元素。这两种方法似乎都不合适，你想做什么？

您发布的最后一个片段[确实有效](http://jsbin.com/ecelik/1/edit)，但是，在将类名应用于目标元素之前，您需要通过制表符或单击远离它来模糊文本输入。我在 JSBin 示例中`a`从过滤器中删除了选择器，并改用了简单的。`:contains``<p>`

您最好在输入上使用 keyup 事件而不是 change 事件，然后在键入键后应用该类：

```
<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<meta charset=utf-8 />
<title>JS Bin</title>
<style>
  .highlight { color:red; }
</style>
</head>
<body>
  <p>woo</p>
  <input id="filterinput"/>

  <script>
      $(document).ready(function () {

          $("#filterinput").keyup(function () {
              var value = $(this).val(),
                  target = $(":contains('" + value + "')");

              if (!target.hasClass("highlight")) {
                target.addClass("highlight");
              }
          });
      });
  </script>
</body>
</html> 
```

# mysql - MySQL | 使用不同的 WHERE 子句从 SUM 中减去 COUNT

> ID：15233898
> 
> 赞同：1
> 
> 时间：2013-03-05T20:53:09.250
> 
> 标签：mysql

这是一个示例表：

```
quizzes

id    user_id    quiz_id    has_passed    attempts
1     101        201        0             5          
2     101        202        1             1
3     102        201        1             3
4     103        203        1             2 
```

我有两个查询，我想将它们组合起来以获得失败的测验尝试次数。

第一个查询获取每个测验的所有尝试的总和：

```
SELECT quiz_id, SUM(attempts) as sum
FROM quizzes
GROUP BY quiz_id 
```

第二个查询计算测验通过的次数：

```
SELECT quiz_id, COUNT(*) as count
FROM quizzes
WHERE has_passed =1
GROUP BY quiz_id 
```

我想从总尝试中减去通过尝试的次数，以获得按 quiz_id 分组的失败尝试次数。

什么查询会给我一个看起来像这样的输出？

```
quiz_id    failed_attempts    
201        7
202        0
203        1 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T20:58:14.323

```
SELECT quiz_id, SUM(attempts - has_passed) failed_attempts
FROM quizzes
GROUP BY quiz_id 
```

输出

```
| QUIZ_ID | FAILED_ATTEMPTS |
-----------------------------
|     201 |               7 |
|     202 |               0 |
|     203 |               1 | 
```

**[sqlfiddle](http://sqlfiddle.com/#!2/8ca565/2)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:59:16.933

你可以写：

```
SELECT quiz_id,
       SUM(attempts) - COUNT(CASE WHEN has_passed = 1 THEN 1 END)
         AS failed_attempts
  FROM quizzes
 GROUP
    BY quiz_id
; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:00:23.513

我想你正在寻找：

```
SELECT quiz_id, SUM(attempts) AS attempts, SUM(attempts-has_passed) AS failed_attempts
FROM quizzes
GROUP BY quiz_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:00:52.377

试试下面

选择 quiz_id, (sum(attempts) - count(*)) 作为测验中的失败尝试 Group by quiz_id

# jquery - 如何使用 jQuery 让我的底部导航上下滑动？

> ID：15233899
> 
> 赞同：0
> 
> 时间：2013-03-05T20:53:11.637
> 
> 标签：jquery, slidetoggle

我试图将导航保留在页面底部，同时能够显示和隐藏它。出于某种原因，我一生都无法弄清楚为什么这不起作用。

任何帮助，将不胜感激！

编辑：切换是固定的，但现在我遇到了流动性问题。当我使用切换时，这些框的速度不同。

代码：http: [//jsfiddle.net/Hg2ax/2/](http://jsfiddle.net/Hg2ax/2/)

```
$(document).ready(function() {
    $('.toggle-footer').click(function() {        
       $('#footer-content').slideToggle('slow');
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:57:17.940

看起来你可以从你的页脚 css 中去掉高度。

```
footer {
width: 100%;
position: absolute;
bottom: 0;
} 
```

[http://jsfiddle.net/Hg2ax/5/](http://jsfiddle.net/Hg2ax/5/)

# python - Python Tweepy：Twitter Api 说 /users/lookup 不存在

> ID：15233905
> 
> 赞同：3
> 
> 时间：2013-03-05T20:53:20.550
> 
> 标签：python, twitter, tweepy

我正在制作一个研究应用程序，研究具有高权限的 Twitter 用户之间的交互。其中一部分是提取有关用户的信息。我使用 Tweepy for Python 构建了一个应用程序，过去两天我一直在提取用户信息，没有任何问题。突然有这样的请求：

```
https://api.twitter.com/1.1/users/lookup.json?user_id=14063469%2C175965206%2C116959518%2C19814396%2C59871521%2C15879224%2C53116337%2C60620244%2C22667202%2C56455965%2C40655442%2C6532392%2C24316973%2C21831390%2C19028429%2C28954030%2C31137878%2C16907284%2C16583745%2C9940452%2C19589935%2C935591%2C14602269%2C20546508%2C19773867%2C16082041%2C18320759%2C14084545%2C8731882%2C14795384%2C15664019%2C7417012%2C14634678%2C9269402%2C2348251%2C14573469%2C14441717%2C14451994%2C14412513%2C4084791%2C11922062%2C7080762%2C11916972%2C14449235%2C252192024%2C9067522%2C4084791%2C252192024%2C258597311%2C252192024%2C31920384%2C206028892%2C18495777%2C22663733%2C27221188%2C289510168%2C446444558%2C14540077%2C25195065%2C1705881%2C4084791%2C8937822%2C252192024%2C252192024%2C252192024%2C112627470%2C252192024%2C41906537%2C14822470%2C230684649%2C35758042%2C268838947%2C252192024%2C252192024%2C43303458%2C164029686%2C116950595%2C109449411%2C226911474%2C73931555%2C170619878%2C153925191%2C113826502%2C60094002%2C51161658%2C68858451%2C23453566%2C120360129%2C98659794%2C42160791%2C125832535%2C119379318%2C118153517%2C18596842%2C65443306%2C74994114%2C49875356%2C50401629%2C115960551%2C101979193 
```

我回来

```
[{u'message': u'Sorry, that page does not exist', u'code': 34}]. 
```

有谁知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-05-18T07:58:03.770

```
users_list = api.lookup_users(user_ids=id_list)
for user in users_list:
   print user.screen_name 
```

你可以试试这个，这`id_list`是一个用户 ID 列表。也可以参考[tweepy how to get a username from id](https://stackoverflow.com/questions/24100377/tweepy-how-to-get-a-username-from-id)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T03:41:37.687

以下是如何使用 Tweepy lookup_users 方法：

```
>>> api = tweepy.API(auth)
>>> test = api.lookup_users(user_ids=['1123728482,5539932'])
>>> test
[<tweepy.models.User object at 0x103995090>, <tweepy.models.User object at 0x1039950d0>] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-02T15:21:08.080

您的代码可能正在运行，当人们关闭或更改帐户时出现 34 错误很常见，您需要将代码包装在 try/except 中以处理该问题。除此之外，来自 RG 的代码应该可以解决问题。

# php - 无法确定是否安装了 JSON

> ID：15233910
> 
> 赞同：2
> 
> 时间：2013-03-05T20:53:40.670
> 
> 标签：php, javascript, mysql, json

我有一个 php 文件，我相信这一行

```
 sendResponse(200, json_encode($result)); 
```

失败是因为我选择的值（来自程序中的早期）没有传递回我的应用程序（我检查了连接和用户，它都是正确的）。

我使用的是 php 版本 5.3.10，它在配置中没有说明 JSON，我将我的 phpinfo 与可以运行的在线服务器进行了比较，在 phpinfo() 中我看到 JSON 支持 = 启用，JSON 版本 = 1.2.1。这让我想到如果安装了 JSOn，这可能会起作用。但是有人告诉我 JSON 会自动附带 php 版本 5+。我想知道这是否属实，或者这是否可能因为我的本地主机服务器上未启用 JSON 而失败。谢谢你

```
JSONParser parser = new JSONParser("http://www.myhost.co.nf/firearm/", this);

        parser.setPostData(requestParams.toString().getBytes());
        parser.setRequestType(true);
        parser.start();
    }

    public void onResponse(String data, int code) {
        // TODO Auto-generated method stub
        final Vector firearmInfo = jasonParser.parseFirearmResponse(data);
        if(firearmInfo.size() > 0 ){
            UiApplication.getUiApplication().invokeLater(new Runnable() {
                public void run() {
                    // TODO Auto-generated method stub
                    removeLoader();
                    UiApplication.getUiApplication().pushScreen(new FirearmSearchResultScreen(firearmInfo));
                }
            });
        }else{
            UiApplication.getUiApplication().invokeLater(new Runnable() {
                public void run() {
                    // TODO Auto-generated method stub
                    removeLoader();
                    Dialog.alert("No Results found.");
                }
            });
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:00:23.547

> 从 PHP 5.2.0 开始，JSON 扩展默认捆绑并编译到 PHP 中。

引用自：[http ://www.php.net/manual/en/json.installation.php](http://www.php.net/manual/en/json.installation.php)

因此，无需检查现代 PHP 版本的 JSON 兼容性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-26T11:00:01.477

尽管您的问题与提出的问题不同，并且您在其中一条评论中指出了它，但您并没有更改问题。

这个答案解决了你的问题。我昨天也发生了同样的事情：

从 MySQL 收集 JSON 数据到 PHP 的查询在本地服务器上工作，但是当移植到生产服务器时，在线数组返回空。原来生产服务器的MySQL版本是5.6xx，本地服务器是5.7xx。这种差异就是答案。MySQL 在 5.7 中根据[SitePoint 文章](https://www.sitepoint.com/use-json-data-fields-mysql-databases/)开始支持 JSON 数据。

回答：

*   将您的 MySQL 更新到 5.7+（问题已解决）

**或者**

*   以文本形式检索 JSON 数据（MySQL 5.6）并使用[PHP json_decode() 获取对象或数组](http://php.net/manual/en/function.json-decode.php)

# php - 如何使用 Amazon PHP SDK 2 获取 EC2 实例列表？

> ID：15233913
> 
> 赞同：16
> 
> 时间：2013-03-05T20:53:45.333
> 
> 标签：php, amazon-ec2

如何使用[AWS SDK for PHP 2](http://aws.amazon.com/sdkforphp/)获取与某些过滤器匹配的 Amazon EC2 实例列表？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-05T20:53:45.333

为此使用[DescribeInstances](http://docs.aws.amazon.com/aws-sdk-php-2/latest/class-Aws.Ec2.Ec2Client.html#_describeInstances)方法。让我们用更多细节来介绍这一点。

您需要先获取 Ec2Client 实例。初始化客户端的最简单方法：

```
$config = array();
$config['key'] = 'key';
$config['secret'] = 'secret';
$config['region'] = 'us-east-1';
$config['version'] = 'latest'; // Or Specified
$ec2Client = \Aws\Ec2\Ec2Client::factory($config); 
```

然后只需调用`DescribeInstances`方法。

```
$result = $ec2Client->DescribeInstances(array(
        'Filters' => array(
                array('Name' => 'instance-type', 'Values' => array('m1.small')),
        )
)); 
```

[您可以在 Amazon DescribeInstances](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ApiReference-query-DescribeInstances.html) API 方法页面上获取可用过滤器列表。

但是等等，这里可能有什么困难？

*   注意参数名称`Filters`。在 API 中，它被称为`Filter`
*   参数`Values`调用与 API 不同，它是一个数组

是的，这一切都在文档中进行了描述。但是，如果您查看一些[旧 API 使用示例](https://stackoverflow.com/questions/10198612/how-to-programmatically-get-public-dns-of-an-instance)，您会发现语法已经改变，这可能很难注意到这些示例中必须更新哪些内容才能使事情正常工作。

为了完成这个例子，让我展示一些简单的结果输出。

```
$reservations = $result['Reservations'];
foreach ($reservations as $reservation) {
    $instances = $reservation['Instances'];
    foreach ($instances as $instance) {

        $instanceName = '';
        foreach ($instance['Tags'] as $tag) {
            if ($tag['Key'] == 'Name') {
                $instanceName = $tag['Value'];
            }
        }

        echo 'Instance Name: ' . $instanceName . PHP_EOL;
        echo '---> State: ' . $instance['State']['Name'] . PHP_EOL;
        echo '---> Instance ID: ' . $instance['InstanceId'] . PHP_EOL;
        echo '---> Image ID: ' . $instance['ImageId'] . PHP_EOL;
        echo '---> Private Dns Name: ' . $instance['PrivateDnsName'] . PHP_EOL;
        echo '---> Instance Type: ' . $instance['InstanceType'] . PHP_EOL;
        echo '---> Security Group: ' . $instance['SecurityGroups'][0]['GroupName'] . PHP_EOL;
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T00:17:38.197

维克多的回答很好，但它对我不起作用，因为我错过了一行：

```
$reservations=$result->toArray(); 
```

Amazon PHP SDK 2 为许多事情（包括这个）返回 Guzzle 模型对象，并且需要将它们转换为数组，然后 foreach 才能工作。更多信息在这里：

[http://guzzlephp.org/api/class-Guzzle.Service.Resource.Model.html](http://guzzlephp.org/api/class-Guzzle.Service.Resource.Model.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-18T09:26:14.410

这对维克多很有帮助，嘿 voidstin，在我的情况下不需要 [$reservations=$result->toArray();]

```
require "aws.phar";

use Aws\Ec2\Ec2Client;
use Aws\Common\Enum\Region; 

$aws = Ec2Client::factory(array(
'key' => 'XXXXXX',  //Your key and secret key are found at https://portal.aws.amazon.com/gp/aws/securityCredentials
'secret' => 'XXXXXX',
'region' => 'XXXXXX'  //This is the server cluster we are connecting to.  US_EAST_1 is Northern Virginia.  US_WEST_1 is Northern California.  US_WEST_2 is Oregon
));

$result = $aws->DescribeInstances();

$reservations = $result['Reservations'];
foreach ($reservations as $reservation) {
$instances = $reservation['Instances'];
foreach ($instances as $instance) {
$instanceName = '';
foreach ($instance['Tags'] as $tag) {
if ($tag['Key'] == 'Name') {
$instanceName = $tag['Value'];
}
}
echo 'Instance Name: ' . $instanceName . PHP_EOL;
echo '<br>';
echo '---> State: ' . $instance['State']['Name'] . PHP_EOL;
echo '<br>';
echo '---> Instance ID: ' . $instance['InstanceId'] . PHP_EOL;
echo '<br>';
echo '---> Image ID: ' . $instance['ImageId'] . PHP_EOL;
echo '<br>';
echo '---> Private Dns Name: ' . $instance['PrivateDnsName'] . PHP_EOL;
echo '<br>';
echo '---> Instance Type: ' . $instance['InstanceType'] . PHP_EOL;
echo '<br>';
echo '---> Security Group: ' . $instance['SecurityGroups'][0]['GroupName'] . PHP_EOL;
echo '<br>';
echo '-----------------------------------------------------------------------------------------------------';
echo '<br>';
echo '<br>';
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-19T09:38:26.623

为了获取您的列表，`PublicDnsName`您可以使用以下代码：

```
use Aws\Ec2\Ec2Client;

$ec2 = Ec2Client::factory($config);
$args = [
    'Filters' => [
        ['Name' => 'tag:Name', 'Values' => ['*{{your-tag}}*']],
    ]
];
$data = $ec2->DescribeInstances($args)->toArray();
$instances = [];
array_walk_recursive($data, function ($value, $key) use (&$instances) {
    if ($key === 'PublicDnsName') {
        $instances[$value] = true;
    }
});
var_export($instances); 
```

您将收到如下信息：

```
array (
  'ec2-*-*-*-*.eu-west-1.compute.amazonaws.com' => true,
  'ec2-*-*-*-*.eu-west-1.compute.amazonaws.com' => true,
  'ec2-*-*-*-*.eu-west-1.compute.amazonaws.com' => true,
  'ec2-*-*-*-*.eu-west-1.compute.amazonaws.com' => true,
  'ec2-*-*-*-*.eu-west-1.compute.amazonaws.com' => true,
  'ec2-*-*-*-*.eu-west-1.compute.amazonaws.com' => true,
) 
```

# html - 如何将 nth-child() 规则合二为一？

> ID：15233920
> 
> 赞同：7
> 
> 时间：2013-03-05T20:54:08.797
> 
> 标签：html, css

我目前有这个很长的规则

```
#content #wrapper table td:nth-child(3), 
#content #wrapper table td:nth-child(4), 
#content #wrapper table td:nth-child(5) {
     width: 30px;
} 
```

是否可以将第 n 个孩子组合成更短的东西，`nth-child(3,4,5)`而不是 3 条单独的线？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T20:59:14.990

这应该可以解决问题：

```
#content #wrapper table td:nth-child(n+3):nth-child(-n+5) {
    width: 30px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:58:34.253

不直接基于您的代码，但这应该给您一个想法。

```
ul li:nth-child(n+3):nth-child(-n+7){ } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-16T10:54:13.253

```
a:nth-child(4),+:nth-child(5){color:red} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T20:58:34.947

你可以试试

```
#content #wrapper table td:nth-child(n+3) 
```

这将选择除前 2 个之外的所有内容。

来自：http : [//css-tricks.com/useful-nth-child-recipies/](http://css-tricks.com/useful-nth-child-recipies/)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-03-05T20:57:35.093

并不是说我知道我害怕。如果您正在寻找更少的代码以使其更易于维护，您可以尝试类似 SASS 的东西。

# python - 在 Django 中设计 CBV

> ID：15233928
> 
> 赞同：5
> 
> 时间：2013-03-05T20:54:44.417
> 
> 标签：python, django

我目前正在尝试使用 Django 1.5 进入“基于类的视图”。

从设计的角度来看，我想知道将处理来自**简单 FormView 表单的**数据的逻辑放在哪里。

我知道所有表单验证代码都包含在方法`form_valid()`中。但是将处理表单数据的东西放在哪里。我读到在`form_valid()`方法中加入太多逻辑有点不合适。

有`get()`, `post()`, `get_context_data()`, `head()`, 等方法......在这种情况下我应该使用哪个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:15:46.747

这个问题的任何答案都可以讨论。也就是说，视图只是 Python 类，因此您*可以*覆盖任何方法来相应地自定义事物。

在您的类上创建一个额外的方法来处理数据处理也是完全合法的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T04:23:10.137

1.  表单验证、数据清理等与 clean 方法中的表单类一起使用

2.  有效表单的处理应采用被覆盖的`form_valid`方法

就是这样！如果您的用例更复杂，您可以从`form_valid`...调用其他创建方法

# asp.net-mvc-3 - Html.DropDownListFor() 设置默认选择值 MVC3

> ID：15233930
> 
> 赞同：0
> 
> 时间：2013-03-05T20:54:54.430
> 
> 标签：asp.net-mvc-3, html-helper, html.dropdownlistfor

我想在创建元素时在 DropDownListFor 中设置默认选择值

数据模型：

```
public class CascadingDropDownModel
{
    public int? PreviousFirstListId { get; set; }
    public int? SelectedFirstListId { get; set; }
    public int? SelectedSecondListId { get; set; }

    public string FirstTextHint { get; set; }
    public string SecondTextHint { get; set; }

    public IList<DropDownElement> FirstDropDownData { get; set; }
    public IList<DropDownElement> SecondDropDownData { get; set; }

    public CascadingDropDownModel()
    {
        FirstDropDownData = new List<DropDownElement>();
        SecondDropDownData = new List<DropDownElement>();
    }
} 
```

部分视图（不起作用）：

```
 @Html.DropDownListFor(
                m => m.SelectedFirstListId,
                new SelectList(Model.FirstDropDownData, "Id", "Name", Model.SelectedFirstListId),
                Model.FirstTextHint) 
```

部分观点（作品）：

```
 @Html.DropDownListFor(
                m => m.SelectedFirstListId,
                new SelectList(Model.FirstDropDownData, "Id", "Name", 5),
                Model.FirstTextHint) 
```

请告诉我是什么问题？

# c# - C# LINQ 三元运算符作为 foreach 中的 switchcase

> ID：15233934
> 
> 赞同：2
> 
> 时间：2013-03-05T20:55:10.950
> 
> 标签：c#, linq, switch-statement, ternary-operator

我正在使用 LINQ 和 HtmlAgilitypack 从 HTML 创建数据表。以下获取 html 表头并构造数据表列：

```
var nodes = htmlDoc.DocumentNode.SelectNodes("//table[@class='ps-sellers-table crts']/tr");
             nodes[0].Elements("th")
            .Skip(0)
            .Select(th => th.InnerText
            .Trim())
            .ToList()
            .ForEach(header => dt.Columns.Add(header)); 
```

到目前为止，它工作得很好，除了我需要一些定制。

1.  选择要添加的列。
2.  并指定列类型。

此 select 语句将执行上述两件事：

```
switch (header)
            {
                case ("id") : dt.Columns.Add(header,typeof(int)); break;
                case ("name") : dt.Columns.Add(header,typeof(string)); break;
                case ("price") : dt.Columns.Add(header,typeof(decimal)); break;
                case ("shipping") : dt.Columns.Add(header,typeof(decimal)); break;
                default : //skip the column and dont add it
            } 
```

但是我对 LINQ 和 C# 真的很陌生，我想在第一个片段的 foreach 中实现上面的 switch case，我知道我应该使用`ternary operator`，但我不确定语法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:05:13.397

我会将开关包装到一个方法中，然后从您的 select 语句中调用该方法。

我的版本看起来像：

```
var nodes = htmlDoc.DocumentNode.SelectNodes("//table[@class='ps-sellers-table crts']/tr");
         nodes[0].Elements("th")
        .Select(th => th.InnerText.Trim());

foreach(var node in nodes)
    AddColumnToDataTable(node, dt); 
```

请注意，无需`Skip(0)`, 调用`ToList()`只是为了使用`List<T>.ForEach`会降低可读性并增加开销。我个人更喜欢只使用普通的`foreach`.

话虽如此，您的方法可以重构为使用 a`Dictionary<string, Type>`代替。如果您将此添加到您的课程中：

```
Dictionary<string, Type> typeLookup;
// In your constructor:

public YourClass()
{
    typeLookup.Add("id", typeof(int));
    typeLookup.Add("name", typeof(string));
    typeLookup.Add("price", typeof(decimal));
    typeLookup.Add("shipping", typeof(decimal));
} 
```

然后，您可以将方法编写为：

```
void AddColumnToDataTable(string columnName, DataTable table)
{
    table.Columns.Add(columnName, typeLookup[columnName]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:06:23.987

您可以将开关添加到 foreach，不知道为什么必须使用三元运算符

```
.ToList().ForEach(header =>
{
    switch (header)
    {
       case ("id"): dt.Columns.Add(header, typeof(int)); break;
       case ("name"): dt.Columns.Add(header, typeof(string)); break;
       case ("price"): dt.Columns.Add(header, typeof(decimal)); break;
       case ("shipping"): dt.Columns.Add(header, typeof(decimal)); break;
       default: break; //skip the column and dont add it
    }
}); 
```

# git - 如何使用 BitBucket+Git+Maven 发布

> ID：15233935
> 
> 赞同：16
> 
> 时间：2013-03-05T20:55:17.520
> 
> 标签：git, maven, bitbucket, maven-release-plugin

我在我的 pom.xml 中指定了以下 SCM 标签。但是，当我做一个 Maven 时`release:prepare`，创建的标签的版本是 1.0-SNAPSHOT 而不是 1.0

有任何想法吗？

```
 <scm>
    <connection>scm:git:https://<username>@bitbucket.org/<username>/<repo>.git</connection>
    <developerConnection>scm:git:https://<username>@bitbucket.org/<username>/<repo>.git</developerConnection>
    <url>https://bitbucket.org/<username>/<project></url>
</scm> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-10T23:44:41.843

理想情况下，您将在发布时使用 SSH 进行身份验证。在这种情况下，您将使用以下配置：

```
<scm>
    <connection>scm:git:ssh://git@bitbucket.org/<username>/<repo>.git</connection>
    <developerConnection>scm:git:ssh://git@bitbucket.org/<username>/<repo>.git</developerConnection>
    <url>https://bitbucket.org/<username>/<repo>.git</url>
</scm> 
```

你也可以看看这个[例子](https://bitbucket.org/atlassian/stash-auto-unapprove-plugin/src/29d64c8077f0495be7fb5c19c8afdc3a6f6f005c/pom.xml?at=master)。

# jquery - Twitter Bootstrap 下拉列表

> ID：15233936
> 
> 赞同：0
> 
> 时间：2013-03-05T20:55:24.430
> 
> 标签：jquery, html, twitter-bootstrap

假设您有一个这样的通用表：

```
<table>
     <tr>
         <td class="box">ABC</td>
         <td class="box">DEF</td>
     </tr>
     <tr>
         <td class="box">GHI</td>
         <td class="box">JKL</td>
     </tr>
</table>

<ul id="menu" class="dropdown-menu">
    <li>One</li>
    <li>Two</li>
</ul> 
```

是否可以使用引导程序在单击时打开 .box 上方的下拉菜单。（我假设最简单的方法是使用 bootstrap [.dropdown()](http://twitter.github.com/bootstrap/javascript.html#dropdowns)方法。）

```
$('.box').click ->
    ... make dropdown appear over $(this) 
```

当前使用的库：

*   引导程序 v2.1.1
*   jQuery v1.8.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:21:16.420

我找到了一个足够的 jQuery 插件，它可以完全实现我想要实现的目标。

[http://labs.abeautifulsite.net/jquery-dropdown/](http://labs.abeautifulsite.net/jquery-dropdown/)

# c++ - 按索引对数组进行分区

> ID：15233939
> 
> 赞同：0
> 
> 时间：2013-03-05T20:55:42.077
> 
> 标签：c++, arrays, partitioning

我对 C++ 相当陌生，并且正在努力解决一个似乎有可靠解决方案但我似乎无法找到它的问题。我有一个从零开始的连续整数数组：

```
int i[6] = { 0, 1, 2, 3, 4, 5 }; // this is actually from an iterator 
```

我想将数组分成三组。设计是有两个方法`j`和`k`，这样给定一个`i`它们将返回来自同一组的三个元素的其他两个元素。例如：

```
 ij(i) k(i) 
0 1 2  
1 0 2  
2 0 1  
3 4 5  
4 3 5  
5 3 4  

```

解决方案似乎涉及将`i`与它的值 mod 3 和加或减 1 相加，但我似乎不太能弄清楚逻辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:12:01.833

这应该这样做：

```
int j(int i)
{
  int div = i / 3;
  if (i%3 != 0)
    return 3*div;
  else
    return 3*div+1;
}

int k(int i)
{
  int div = i / 3;
  if (i%3 != 2)
    return 3*div+2;
  else
    return 3*div+1;
} 
```

[测试](http://ideone.com/oCKODC)。

如果您想要更短的功能：

```
int j(int i)
{
  return i/3*3 + (i%3 ? 0 : 1);
}

int k(int i)
{
  return i/3*3 + (i%3-2 ? 2 : 1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:15:04.297

这应该有效：

```
int d = i % 3;
int j = i - d + ( d == 0 );
int k = i - d + 2 - ( d == 2 ); 
```

或以下 k 语句可能更具可读性：

```
int k = i - d + ( d == 2 ? 1 : 2 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:11:42.293

嗯，首先，请注意

```
j(i) == j(3+i) == j(6+i) == j(9+i) == ...
k(i) == k(3+i) == k(6+i) == k(9+i) == ... 
```

换句话说，你只需要找到一个公式

```
j(i), i = 0, 1, 2
k(i), i = 0, 1, 2 
```

然后在其余情况下只需插入即可`i mod 3`。

从那里开始，您将很难找到一个简单的公式，因为您的“轮换”不是标准的。代替

```
i       j(i)    k(i)
0       1       2
1       2       0
2       0       1 
```

公式将是

```
j(i) = (i + 1) % 3
k(i) = (i + 2) % 3 
```

你有

```
i       j(i)    k(i)
0       1       2
1       0       1
2       0       2 
```

目前我能想到的唯一公式是

```
j(i) = (i == 0 ? 1 : 0)
k(i) = (i == 1 ? 1 : 2) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:23:19.693

如果您的数组的值（我们称之为它`arr`，不是`i`为了避免与索引混淆`i`）与它们各自的索引不一致，您必须先执行反向查找以找出它们的索引。我建议使用一个`std::map<int,size_t>`或一个`std::unordered_map<int,size_t>`。

该结构反映了的倒数，您可以使用其[下标](http://en.cppreference.com/w/cpp/container/map/operator_at)运算符或成员函数`arr`为特定值添加索引。从那时起，您可以纯粹对索引进行操作，并按照其他答案中的建议使用模 ( ) 访问上一个和下一个元素。[`at`](http://en.cppreference.com/w/cpp/container/map/at)`%`

# android - 在try and catch异常中使用时如何设置对话框的关闭时间？

> ID：15233940
> 
> 赞同：1
> 
> 时间：2013-03-05T20:55:44.290
> 
> 标签：android

我想为此对话框设置关闭时间，我想在 2 秒后关闭此“已保存”对话框，但不知道如何，我是 android 的初学者 ..帮助我，提前致谢

```
try{
}catch(Exception e){
diditwork = false;  
}finally{
if (diditwork){
Dialog d = new Dialog(MainActivity.this);
d.setTitle("Saved");
d.show();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-02T22:47:19.693

我知道它已经有一段时间了，但是对于阅读本文的任何人，如果您想使用对话框，您可以在一段时间后使用 Timer 类将其关闭：

```
new Timer().schedule(new TimerTask() {
        @Override
        public void run() {
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    //put code to execute here:
                    d.dismiss();
                }
            });
        }
    }, 2000); 
```

# javascript - 掌握 Meteor 中的外部脚本加载顺序（谷歌地图）

> ID：15233942
> 
> 赞同：5
> 
> 时间：2013-03-05T20:55:49.170
> 
> 标签：javascript, google-maps, meteor

我尝试将谷歌地图（外部加载的脚本）添加到流星应用程序但未成功，我注意到有两种问题：

1.  如果我做简单的事情并将主要的 API 脚本添加到我的`<head></head>`中，那么它会在**最后**呈现。
2.  发生这种情况时，我必须在我的模板中再次插入任何**依赖**`<head>`于 API 的脚本 - 在主 API 脚本之后。（否则脚本会抱怨他们看不到 API blabla ..）
3.  然后是实际调用函数的时候了——现在把它放在里面`<head>`是行不通的。您需要使用 Template.MyTemplate.rendered。

基本上我的问题是：

*   处理这些事情的最干净的方法是什么？
*   我可以使用其他一些变量/方法来确保在我的 HTML 中首先调用我的 Google 主 API 文件吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T05:46:04.607

我刚刚发布了一个关于大气的包（[https://atmosphere.meteor.com](https://atmosphere.meteor.com)），这可能会有所帮助。它被称为 session-extras，它定义了几个我用来帮助集成外部脚本的函数。代码在这里：[https ://github.com/belisarius222/meteor-session-extras](https://github.com/belisarius222/meteor-session-extras)

基本思路是异步加载一个脚本，然后在脚本加载完成的回调中，设置一个Session变量。我使用 session-extras 包中的函数来尝试使这个过程更顺畅一些。我有一些函数有 3 或 4 个不同的依赖项（脚本和订阅），所以它开始变得毛茸茸......

我想我应该补充一点，您可以根据是否存在所有依赖项有条件地呈现模板。因此，如果您有一个 facebook 按钮，例如，带有检查 Session 变量的助手，您可以给它一个“已禁用”的 css 类并显示“正在加载 facebook...”，直到所有必要的脚本都已加载。

**编辑 2013 年 3 月 14 日**

还有一种完全不同的方法适用于许多情况：创建自己的包。这目前可以通过 Meteorite [(instructions)](https://atmosphere.meteor.com/wtf/package)实现，并且该功能应该很快在 Meteor 本身中可用。这种方法的一些例子是：

*   jquery-rate-it：[https ://github.com/dandv/meteor-jquery-rateit](https://github.com/dandv/meteor-jquery-rateit)
*   流星混合面板：[https ://github.com/belisarius222/meteor-mixpanel](https://github.com/belisarius222/meteor-mixpanel)

如果您将 js 文件放入包中，它会在您的应用程序代码之前加载，这通常是包含库的好方法。制作包的另一个优点是包可以相互声明依赖关系，因此如果有问题的脚本是，例如，jQuery 插件，您可以在包的`package.js`文件中指定包依赖 jQuery，这将确保正确的加载顺序。

有时它会变得更有趣（在中国诅咒意义上），因为许多外部服务，包括 mixpanel 和 filepicker.io，有一个 2 部分加载过程：1）在正文末尾包含一个 JS 片段，和 2) 由该片段从 CDN 异步加载的更大脚本。js 片段通常（但并非总是如此！）在更大的脚本加载之前使一些方法可用，这样您就可以调用其函数而无需设置更多逻辑来确定其加载状态。Mixpanel 会这样做，尽管重要的是要记住，来自外部服务的一些 JS 片段希望您在片段末尾设置 API 密钥，保证在更大的脚本加载之前；在某些情况下，如果脚本在设置 API 密钥之前加载，库将无法正常运行。

可以简单地自己从 CDN 下载更大的 js 文件并将其粘贴到您的应用程序中；但是，有充分的理由不这样做：1）托管代码可能会更改，除非您认真检查，否则您的代码可能会过时并开始使用旧版本的 API 2）这些库通常已经优化以快速加载代码段，不会显着增加页面加载时间。如果您在应用程序中包含较大的 JS 文件，那么您的服务器必须提供它，而不是 CDN，它将在初始页面加载时提供它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T23:55:41.497

听起来您正在通过将 Javascript 文件与模板中的 HTML 链接来加载它。还有一种更 Meteor 的方式来做到这一点：

来自[流星文档](http://docs.meteor.com/)：

> Meteor 会收集树中的所有 JavaScript 文件，但客户端的服务器和公共子目录除外。它会缩小这个捆绑包并将其提供给每个新客户。您可以自由地为整个应用程序使用单个 JavaScript 文件，或创建单独文件的嵌套树，或介于两者之间的任何内容。

所以考虑到这一点，不要将 gmaps.js 链接到 head 中，只需下载未缩小版本的 gmaps 并将其放入应用程序的树中。

同样来自 Meteor Docs：

> 最好以对文件加载顺序不敏感的方式编写应用程序，例如使用 Meteor.startup 或将加载顺序敏感代码移动到智能包中，这样可以显式控制加载它们的内容顺序和相对于其他包的加载顺序。然而，有时应用程序中的加载顺序依赖性是不可避免的。应用程序中的 JavaScript 和 CSS 文件根据以下规则加载：
> 
> **首先加载应用程序根目录下的 lib 目录中的文件。** *[重点补充]*

如果序列仍然存在问题，请将 js 文件放入`client/lib`其中，它将在您编写的所有 Javascript 之前加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-27T00:19:50.777

我使用了meteor-external-file-loader 和一些异步循环来加载一些脚本，这些脚本将按照您指定的顺序加载javascript（或样式表）。

确保有陨石并添加上面的包>> mrt add external-file-loader

这是我为使用这个包而编写的函数：

```
var loadFiles = function(files, callback) {
  if (!callback) callback = function() {};

  (function step(files, timeout, callback) {
    if (!files.length) return callback();

    var loader;
    var file = files.shift();
    var extension = file.split(".").pop();
    if (extension === "js")
      loader = Meteor.Loader.loadJs(file, function() {}, timeout);
    else if (extension === "css") {
      Meteor.Loader.loadCss(file);
      loader = $.Deferred().resolve();
    }
    else {
      return step(files, timeout, callback);
    }

    loader.done(function() {
      console.log("Loaded: " + file);
      step(files, timeout, callback);
    }).fail(function() {
      console.error("Failed to load: " + file);
      step(files, timeout, callback);
    });
  })(files, 5000, callback);
} 
```

然后使用它，添加到您为模板创建的方法之一，如下所示：

```
Template.yourpage.created = function() {
  var files = [
    "//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js",
    "javascripts/bootstrap.min.js"
  ];

  loadFiles(files, function() {
    console.log("Scripts loaded!");
  });
} 
```

快速编辑：发现将 .created 方法中的功能放在 Meteor.startup() 的 /lib 文件夹中是个好主意；

```
Meteor.startup(function() {
  if (Meteor.isClient) {
    // Load files here.
  }
}); 
```

警告：很多 javascript 文件 = 加载时间真的很长....不确定正常的流星 javascript 文件以及那里的加载顺序会如何影响它。我只是确保在用户在网站上采取行动之前没有冲突（或者如果有，他们首先被加载）。

# swig - 如何使用 SWIG 处理带有指针到指针 argout 参数的 JAVA 到 C++ 调用？

> ID：15233944
> 
> 赞同：0
> 
> 时间：2013-03-05T20:55:51.040
> 
> 标签：swig

问题涉及对 C 函数 (API) 的 JAVA 调用，该函数返回一个指向指针的指针作为 argout 参数。我试图从 JAVA 调用 C API，但我无法修改 API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:24:54.807

[Swig] Java：使用 C 辅助函数传递指针到指针

1.  问题涉及对 C 函数 (API) 的 JAVA 调用，该函数返回一个指向指针的指针作为 argout 参数。我试图从 JAVA 调用 C API，但我无法修改 API。

API.h 头文件包含：

```
extern int ReadMessage(HEADER **hdr); 
```

原始的 C 调用如下所示：

```
HEADER *hdr;
int status;
status = ReadMessage(&hdr); 
```

API 的功能是将数据存储在指针指定的内存位置。

1.  我尝试使用 SWIG 创建适当的接口文件。SWIG.i 从 API.h 创建了文件 SWIGTYPE_p_p_header.java。问题是 SWIGTYPE_p_p_header 构造函数将 swigCPtr 初始化为 0。

JAVA 调用看起来像：

```
SWIGTYPE_p_p_header hdr = new SWIGTYPE_p_p_header();
status = SWIG.ReadMessage(hdr); 
```

但是当我从 JAVA 调用 API 时，ptr 始终为 0。

1.  我终于放弃了将指针作为输入参数传递。相反，我在 SWIG.i 中定义了另一个 C 函数，以在返回值中返回指向指针的指针。我以为这是一个 Kludge ......但它奏效了！

你可能想试试这个：

SWIG.i 看起来像：

```
// return pointer-to-pointer
%inline %{
   HEADER *ReadMessageHelper() {
   HEADER *hdr;
   int returnValue;
   returnValue = ReadMessage(&hdr);
   if (returnValue!= 1) hdr = NULL;
   return hdr;
}%} 
```

1.  上面的内联函数可能会泄漏内存，因为 Java 不会获得 ReadMessageHelper 创建的内存的所有权，因为 HEADER 实例是在堆上创建的。

内存泄漏的修复方法是将 ReadMessageHelper 定义为一个新对象，以便 Java 控制内存。

```
%newobject ReadMessageHelper(); 
```

JAVA 调用现在看起来像：

```
HEADER hdr;
hdr = SWIG.ReadMessageHelper(); 
```

1.  如果你像我一样幸运的话，你可能有另一个 API 可用于释放消息缓冲区。在这种情况下，您不必执行上一步。

2.  SWIG 大师威廉·富尔顿 (William Fulton) 对上述方法有这样的看法：

“我不认为辅助函数是一个杂物，更像是解决棘手问题的最简单解决方案。考虑 ReadMessage() 的等效纯 100% Java 代码。我不认为 Java 类是通过引用传递的等价物，并且不存在对引用的引用或指向 Java 中指针的指针之类的东西。在您拥有的 C 函数中，一个 HEADER 实例由 ReadMessage 创建并传递回调用者。如果不提供一些围绕 HEADER 的包装类并将包装器传递给 ReadMessage 函数，我看不出如何在 Java 中做同样的事情。归根结底，ReadMessage 返回一个新创建的 HEADER，而 Java 返回新创建对象的方式是在返回值中返回它，而不是通过参数。”</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T17:26:02.097

使用 SWIG 类型映射传递指针到指针：

这是使用类型映射的另一种方法。它针对的是 Perl，而不是 Java，但概念是相同的。我终于设法使用类型映射而不使用辅助函数来让它工作：

对于此功能：

```
typedef void *    MyType;
int getblock( int a, int b, MyType *block ); 
```

我有 2 个类型图：

```
%typemap(perl5, in, numinputs=0) void ** data( void * scrap )
{
    $1 = &scrap;
}

%typemap(perl5, argout) void ** data
{
    SV* tempsv = sv_newmortal();
    if ( argvi >= items ) EXTEND(sp,1);
    SWIG_MakePtr( tempsv, (void *)*$1, $descriptor(void *), 0);
    $result = tempsv;
    argvi++;
} 
```

函数定义为：

```
int getblock( int a, int b, void ** data ); 
```

在我的 swig .i 文件中。现在，这会在 argout 类型映射中传回一个不透明的指针，因为这对这种特殊情况很有用，但是，如果您愿意，您可以将 SWIG_MakePtr 行替换为实际处理指针中的数据的内容。此外，当我想将指针传递给函数时，我有一个如下所示的类型映射：

```
%typemap(perl5, in) void * data
{
    if ( !(SvROK($input)) croak( "Not a reference...\n" );

    if ( SWIG_ConvertPtr($input, (void **) &$1, $1_descriptor, 0 ) == -1 )
        croak( "Couldn't convert $1 to $1_descriptor\n");
} 
```

函数定义为：

```
int useblock( void * data ); 
```

在我的 swig .i 文件中。

显然，这都是 perl，但就类型映射架构而言，应该直接映射到 Java。希望能帮助到你...

# c# - 将其转换为 C# 中的 HTTP POST

> ID：15233945
> 
> 赞同：0
> 
> 时间：2013-03-05T20:55:52.950
> 
> 标签：c#, oauth, http-post, yahoo-api

我目前正在试验 HTTP 请求。我已经成功地完成了`get`请求，并且我已经阅读了使用 HTTP 请求进行发布请求的内容。现在我正在尝试使用 yahoo API 并且为了使用 Yahoo api 它声明[在](http://developer.yahoo.com/messenger/guide/ch01s08.html#)

> 消息管理 API 可用于向另一个 Yahoo! 发送消息。信使联系。API 使用起来非常简单，如此处所示。请注意，消息发送到的联系人是 URI 的一部分，使用以下格式：`<server>/v1/message/<network>/<contactID>`

```
POST /v1/message/yahoo/targetYahooId?sid=msgrsessionid  
Host: rcore1.messenger.yahooapis.com  
Authorization: < Standard OAuth credentials >  
Content-Type: application/json;charset=utf-8  
Content-Length: 25  
{  
    "message" : "Hey there"  
} 
```

现在我有一个使用 HttpWebRequest 对象从 get 中获得的 OAuth 字符串。字符串是这样的

```
oauth_token=A%3Dvh....aRg--&oauth_token_secret=bd46a....c9239&oauth_expires_in=3600&oauth_session_handle=ALtT.....3J1N4Zg--&oauth_authorization_expires_in=784964948&xoauth_yahoo_guid=TUSKED5...NCIA 
```

**更新**

现在我的问题如下：

1-如果我在 C# 中使用 WebRequest 对象，我的 URI 会是什么样子

2- 我知道它需要一个 JSON 类型的对象。我怎么知道 OAuth 参数是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:00:12.227

您需要更改的一件事是内容类型：

```
request.ContentType = "application/json;charset=utf-8"; 
```

当然，还有网址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:59:50.007

您需要更改其中包含 url 的行上的 url

您需要更改内容类型行

您需要将有效负载转换为 json 字符串，然后将其转换为字节数组（示例中为 byteArray）

要么手工组装 json "{ foo:'bar'}" 等，要么使用 json.net

并设置内容长度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:04:11.853

看起来它期待请求正文的 JSON 对象。根据您使用的 .NET 版本，您可以使用此处所示的 Javascript 序列化程序 ( [https://stackoverflow.com/a/7003815/939080](https://stackoverflow.com/a/7003815/939080) ) 或 JSON.NET ( [http://james.newtonking. com/projects/json-net.aspx](http://james.newtonking.com/projects/json-net.aspx)）将您的表单集合转换为 JSON 输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:04:42.323

您问的是一个开放式问题，如果您想要一个具体而完整的答案，则需要人们为您编写一堆代码。正如其他人指出的那样，您需要处理几个问题：

*   JSON 有效负载，这很简单，通过代码示例中使用的 byteArray 将 JSON 字符串放入请求正文中。
*   内容类型，您需要按照 jrummell 的说明进行更改。
*   OAuth 凭据，这是您需要阅读、理解和获取库的一大堆鱼。这是开始寻找图书馆的[好地方。](http://oauth.net/code/)

# php - PHP：用逗号分割字符串，但不是在大括号或引号之间？

> ID：15233953
> 
> 赞同：7
> 
> 时间：2013-03-05T20:56:20.820
> 
> 标签：php, regex, split, preg-match-all

在 PHP 中，我有以下字符串：

```
$str = "AAA, BBB, (CCC,DDD), 'EEE', 'FFF,GGG', ('HHH','III'), (('JJJ','KKK'), LLL, (MMM,NNN)) , OOO"; 
```

我需要将此字符串拆分为以下部分：

```
AAA
BBB
(CCC,DDD)
'EEE'
'FFF,GGG'
('HHH','III')
(('JJJ','KKK'),LLL, (MMM,NNN))
OOO 
```

我尝试了几个正则表达式，但找不到解决方案。有任何想法吗？

**更新**

在处理格式错误的数据、转义引号等时，我已经决定使用正则表达式并不是最好的解决方案。

感谢这里提出的建议，我找到了一个使用解析的函数，我重写了它以满足我的需要。它可以处理不同类型的括号，分隔符和引号也是参数。

```
 function explode_brackets($str, $separator=",", $leftbracket="(", $rightbracket=")", $quote="'", $ignore_escaped_quotes=true ) {

    $buffer = '';
    $stack = array();
    $depth = 0;
    $betweenquotes = false;
    $len = strlen($str);
    for ($i=0; $i<$len; $i++) {
      $previouschar = $char;
      $char = $str[$i];
      switch ($char) {
        case $separator:
          if (!$betweenquotes) {
            if (!$depth) {
              if ($buffer !== '') {
                $stack[] = $buffer;
                $buffer = '';
              }
              continue 2;
            }
          }
          break;
        case $quote:
          if ($ignore_escaped_quotes) {
            if ($previouschar!="\\") {
              $betweenquotes = !$betweenquotes;
            }
          } else {
            $betweenquotes = !$betweenquotes;
          }
          break;
        case $leftbracket:
          if (!$betweenquotes) {
            $depth++;
          }
          break;
        case $rightbracket:
          if (!$betweenquotes) {
            if ($depth) {
              $depth--;
            } else {
              $stack[] = $buffer.$char;
              $buffer = '';
              continue 2;
            }
          }
          break;
        }
        $buffer .= $char;
    }
    if ($buffer !== '') {
      $stack[] = $buffer;
    }

    return $stack;
  } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T21:11:21.967

代替 a `preg_split`，做 a `preg_match_all`：

```
$str = "AAA, BBB, (CCC,DDD), 'EEE', 'FFF,GGG', ('HHH','III'), (('JJJ','KKK'), LLL, (MMM,NNN)) , OOO"; 

preg_match_all("/\((?:[^()]|(?R))+\)|'[^']*'|[^(),\s]+/", $str, $matches);

print_r($matches); 
```

将打印：

```
大批
(
    [0] => 数组
        (
            [0] => AAA
            [1] => BBB
            [2] => (CCC,DDD)
            [3] => 'EEE'
            [4] => 'FFF,GGG'
            [5] => ('HHH','III')
            [6] => (('JJJ','KKK'), LLL, (MMM,NNN))
            [7] => 噢噢噢
        )

)
```

正则表达式`\((?:[^()]|(?R))+\)|'[^']*'|[^(),\s]+`可以分为三个部分：

1.  `\((?:[^()]|(?R))+\)`, 匹配平衡的括号对
2.  `'[^']*'`匹配带引号的字符串
3.  `[^(),\s]+`匹配任何不包含`'('`、`')'`或`','`空白字符的字符序列

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T22:46:32.727

### 疯狂的解决方案

一个简单的正则表达式，它标记化并**验证**它提取的所有标记：

```
\G\s*+((\((?:\s*+(?2)\s*+(?(?!\)),)|\s*+[^()',\s]++\s*+(?(?!\)),)|\s*+'[^'\r\n]*+'\s*+(?(?!\)),))++\))|[^()',\s]++|'[^'\r\n]*+')\s*+(?:,|$) 
```

[**正则表达式101**](http://www.regex101.com/r/zQ4pE8)

把它放在字符串文字中，带分隔符：

```
'/\G\s*+((\((?:\s*+(?2)\s*+(?(?!\)),)|\s*+[^()\',\s]++\s*+(?(?!\)),)|\s*+\'[^\'\r\n]*+\'\s*+(?(?!\)),))++\))|[^()\',\s]++|\'[^\'\r\n]*+\')\s*+(?:,|$)/' 
```

[**ideone**](http://ideone.com/vNHBKQ)

结果是在捕获组 1。在 ideone 的示例中，我指定了`PREG_OFFSET_CAPTURE`标志，以便您可以检查组 0（整个匹配）中的*最后一个匹配*是否整个源字符串已被消耗。

### 假设

*   未引用的文本可能不包含任何空格字符，如`\s`. 因此，它可能不会跨越多行。
*   非引用文本不得包含`(`,`)`或.`'``,`
*   非引用文本必须至少包含 1 个字符。
*   单引号文本不能跨越多行。
*   单引号文本可能不包含引号。因此，无法指定`'`.
*   单引号文本可能为空。
*   括号标记包含以下一项或多项作为子标记：非引号文本标记、单引号文本标记或另一个括号标记。
*   在括号令牌中，相邻的 2 个子令牌之间正好相隔一个`,`
*   括号标记以 . 开头`(`和结尾`)`。
*   因此，括号令牌必须具有平衡的括号，并且`()`不允许使用空括号。
*   输入将包含以下一项或多项：非引号文本、单引号文本或括号标记。输入中的标记用逗号分隔`,`。单个尾随逗号`,`被认为是有效的。
*   在括号标记的标记、逗号分隔标记和括号之间任意允许空白字符（由 定义，`\s`包括换行符）。`,``(``)`

### 分解

```
\G\s**
(
  (
    \(
    （？：
        \s**
        (?2)
        \s**
        (?(?!\)),)
      |
        \s**
        [^()',\s]++
        \s**
        (?(?!\)),)
      |
        \s**
        '[^'\r\n]*+'
        \s**
        (?(?!\)),)
    )++
    \)
  )
  |
  [^()',\s]++
  |
  '[^'\r\n]*+'
)
\s*+(?:,|$)

```

# java - 使用Java替换终端中的两行

> ID：15233956
> 
> 赞同：2
> 
> 时间：2013-03-05T20:56:36.333
> 
> 标签：java, io

我知道如何使用 Java 通过替换前一行将终端中的输出包含在一行中。例如：

```
System.out.print("old line");
Thread.sleep(3000);
System.out.print("\rnew line"); 
```

但是如果我有两行输出并且我想都被替换怎么办

```
/* array must have length divisible by 2 */
public void doPrinting(String[] array) {
    for(int i = 0; i < array.length / 2; i++) {
        System.out.println(array[i*2]);
        System.out.println(array[i*2+1]);
        Thread.sleep(3000);
        //I imagine some fancy ascii crypticness shall go here?
    } 
```

所以，如果我打电话`doPrinting(new String[]{"Old1", "Old2", "New1", "New2"})`，这应该看起来像，在 Mac 终端：

```
MyName$ java MyClass
Old1
Old2 
```

然后暂停3秒，然后看起来像

```
MyName$ java MyClass
New1
New2 
```

我怎样才能做到这一点？我在 Mac OS 上，正在通过终端运行我的 Java 主方法。理想的答案是添加代码来修改上述`doPrinting`方法。

* * *

更新：在下面的一个答案之后，我尝试了这个：

```
String ANSI_CSI = "\\x1b[";
String[] array = {"old1","old2","new1","new2"};
System.out.print("\n\n");
for(int i = 0; i < array.length / 2; i++) {
    System.out.print(ANSI_CSI + "2A"); // Up 2
    System.out.print(ANSI_CSI + "K");  // Clear
    System.out.println(array[i*2]);
    System.out.print(ANSI_CSI + "K");  // Clear
    System.out.println(array[i*2+1]);
    Thread.sleep(3000);
 } 
```

但这只是在终端中给了我这个输出

```
MyName$ MyClass

\x1b[2A\x1b[Kold1
\x1b[Kold2
\x1b[2A\x1b[Knew1
\x1b[Knew2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:01:12.400

您将要使用[ANSI Escape Codes](http://en.wikipedia.org/wiki/ANSI_escape_code)。

在这里，您可能会对“上移光标”（`CSI-A`）和“擦除行”（`CSI-K`）感兴趣。

```
// outside code
public static final String ANSI_CSI = "\x1b[";
// inside code
System.out.println("First line of text");
System.out.println("[  5/365]");
System.out.print(ANSI_CSI + "2A"); // up 2 lines
System.out.println("Different first line of text");
System.out.println("[ 11/365)");
System.out.print(ANSI_CSI + "A"); // up line
System.out.print(ANSI_CSI + "2K"); // erase all of line
System.out.print(ANSI_CSI + "A"); // up line
System.out.print(ANSI_CSI + "K"); // erase after cursor
System.out.println("Line one");
System.out.println("[240/365]"); 
```

如果您想在循环中执行此操作（`System.out`为简洁起见已省略）：

```
// Init to safe state
print("\n\n");
for (loop conditions here) {
  print(ANSI_CSI + "2A"); // Up 2
  print(ANSI_CSI + "K");  // Clear
  println(text_a);        // Print + newline
  print(ANSI_CSI + "K");  // Clear
  println(text_b);        // Print + newline
  Thread.sleep(3000);     // Wait
} 
```

请注意，您将需要使用支持这些的终端。查看维基百科文章以获取更多信息。如果它说某个代码在“ANSI.SYS”下具有不同的行为，那么这适用于默认的 Windows 命令提示符。

我对 Mac 没有任何经验，因此您的体验可能因终端不同而有所不同。

大多数备用和 UNIX 终端（gnome-terminal、PuTTY）更全面地支持这些代码（请参阅有关`xterm`的完整 RGB 支持的注释）。

# apache - org.apache.http, org.apache.xerces

> ID：15233957
> 
> 赞同：0
> 
> 时间：2013-03-05T20:56:39.463
> 
> 标签：apache, http, import, classnotfound

所以我试图导入

```
import org.apache.http.HttpEntity
import org.apache.http.HttpResponse
import org.apache.http.client.HttpClient
import org.apache.http.client.methods.HttpPost
import org.apache.http.entity.StringEntity
import org.apache.http.impl.client.DefaultHttpClient
import org.apache.http.message.BasicHttpResponse
import org.apache.http.params.HttpParams
import org.apache.http.params.HttpConnectionParams
import org.apache.http.util.EntityUtils

import org.apache.xerces.impl.XMLEntityManager.Entity 
```

没有找到这些。我有一个不同的项目正在导入完全相同的东西并且它有效。但不在这个项目上。关于为什么会发生这种情况的任何想法？

```
---------------------------------------------------
tomcat              2.1.0            --  Apache Tomcat plugin for Grails
webxml              1.4.1            --  WebXmlConfig 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-22T16:08:33.247

一个常见的问题通常是库（xerces）没有被导入，你可以从[这里下载。](http://archive.apache.org/dist/xml/xerces-j/Xerces-J-bin.1.4.4.tar.gz)

[官网](http://xerces.apache.org/xerces2-j/api.html)

干杯。

# c# - 间歇性 System.ServiceModel.CommunicationException

> ID：15233962
> 
> 赞同：0
> 
> 时间：2013-03-05T20:56:45.910
> 
> 标签：c#, wcf, c#-4.0, wcf-binding

我有一个控制台应用程序，它调用 WCF 服务来授权给定商店 ID 的预定信用卡付款。昨晚它调用了这个服务超过 100 次，其中一个调用，它得到了这个错误：

> System.ServiceModel.CommunicationException：接收到 [service url] 的 HTTP 响应时发生错误这可能是由于服务端点绑定未使用 HTTP 协议。这也可能是由于服务器中止了 HTTP 请求上下文（可能是由于服务关闭）。有关更多详细信息，请参阅服务器日志。---> System.Net.WebException：底层连接已关闭：接收时发生意外错误。---> System.IO.IOException: Unable to read data from the transport connection: 一个现有的连接被远程主机强行关闭。---> System.Net.Sockets.SocketException: 现有连接被远程主机强行关闭

引起我们注意的是，这家商店的前 100 笔交易已获得授权，但 43 笔交易未获得授权（未尝试）。服务方法简单地抓取所有 143 并对它们执行一个 foreach 循环，一次授权它们 1 个。该方法返回一个包含在自定义对象中的布尔结果，该对象还可以在必要时返回错误信息，但该对象应该很小，并且不会根据处理的事务量改变大小。我提到这一点是因为我读过一个案例，其中这个异常发生在一定大小的响应中。但就我而言，似乎在它试图返回之前发生了一些事情。服务在循环过程中停止处理，此时客户端收到此异常。有任何想法吗？

# java - 使用 Runtime.exec 时出现读取错误

> ID：15233970
> 
> 赞同：0
> 
> 时间：2013-03-05T20:57:12.897
> 
> 标签：java, ioexception

这个问题[之前在 Stack Overflow 上被问过一次](https://stackoverflow.com/questions/5684250/ioexception-read-error)，但是堆栈跟踪与我的不同，我认为它不是由同一件事引起的。

这是我的堆栈跟踪：

```
java.io.IOException: Read error
at java.io.FileInputStream.readBytes(Native Method)
at java.io.FileInputStream.read(Unknown Source)
at sun.nio.cs.StreamDecoder.readBytes(Unknown Source)
at sun.nio.cs.StreamDecoder.implRead(Unknown Source)
at sun.nio.cs.StreamDecoder.read(Unknown Source)
at java.io.InputStreamReader.read(Unknown Source)
at java.io.BufferedReader.fill(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at General.App.cmdString(App.java:393)
at General.App.cpauString(App.java:422)
at Functionality.RegistryScanThread.USBDScan(RegistryScanThread.java:109)
at Functionality.RegistryScanThread.doInBackground(RegistryScanThread.java:51)
at Functionality.RegistryScanThread.doInBackground(RegistryScanThread.java:1)
at javax.swing.SwingWorker$1.call(Unknown Source)
at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
at java.util.concurrent.FutureTask.run(Unknown Source)
at javax.swing.SwingWorker.run(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

这是我编写的更复杂程序的简化版本：

```
import java.util.*;
import java.io.*;
public class Test {

//global vars

public Test(){
    // initializeing stuffs
}
public static void main(String[] args){
    ArrayList<String> str = cmdString("reg query hklm");
    for(String s : str){
        System.out.println(s);
    }
}

public static ArrayList<String> cmdString(String command){
    boolean success = false;
    ArrayList<String> result = new ArrayList<String>();
    String line = "";
    try{ 
        Process p = Runtime.getRuntime().exec(command);
        BufferedReader input = new BufferedReader(new InputStreamReader(p.getInputStream()));
            while ((line = input.readLine()) != null) {result.add(new String(line));}
        BufferedReader input2 = new BufferedReader(new InputStreamReader(p.getErrorStream()));
            while ((line = input2.readLine()) != null) {result.add(new String(line));}
        int exitvalue = p.waitFor();
        if (exitvalue != 0){
            System.out.println("error!!");
            success = false;

        }
        else{
            success = true;
        }
        for(String s : result){
            System.out.println(s);
        }
        input.close();
        input2.close();
        return result;
    } catch(Exception e) {
        e.printStackTrace(System.err);
        System.out.println("error!!!");
        return result;
    }
}
} 
```

基本上。在上面的示例中，错误并不真正可见。**但是在我的程序中，它在我第一次运行时**正确执行了所有内容。

然后......当我第二次或第三次运行它时，就会发生错误。另外......似乎当我等待一段时间后再运行它时，似乎没有发生错误。

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T13:56:01.560

这就是我认为的答案，很抱歉，仅根据我提供的代码无法回答我的问题。

基本上发生的事情是这样的。

1.  我的程序中的 cmdString() 方法正在启动一个进程并尝试从其输出流和错误流中读取。
2.  碰巧我的程序启动的进程是我设计的一个 C++ 应用程序，它使用自定义管道来重定向输入和输出。
3.  这个 C++ 应用程序有一个标准输出管道，但我碰巧没有为标准错误创建一个管道。
4.  因为我没有创建标准错误管道，所以我的 cmdString() 方法试图从我没有创建的管道中读取。因此，我在与错误流相对应的“line = input2.readLine())”行上得到了错误。
5.  所以总而言之，错误是由于试图从没有产生错误流的进程中读取错误流造成的。

我相信这就是发生的事情。

当我看到触发错误的确切行时，我发现了错误。我能够看到正常流没有产生错误，但错误流产生了。我觉得这很奇怪，我立刻想起我的 C++ 应用程序没有错误流。

让我知道这个答案是否有意义！

# javascript - 没有返回值的函数

> ID：15233977
> 
> 赞同：0
> 
> 时间：2013-03-05T20:57:57.517
> 
> 标签：javascript, function, return, return-value

在javascript中，为什么这段代码有效？

```
var myVar=setInterval(
   function(){
      myTimer()
   },1000
);

function myTimer()
{
   var d=new Date();
   var t=d.toLocaleTimeString();
   document.getElementById("demo").innerHTML=t; //displays time
   dpcument.getElementById("demo2").innerHTML = myVar; //displays 1
} 
```

即使我没有从函数返回任何内容，为什么还要`myVar`保留该值？`1`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T20:59:12.890

`setInterval`返回一个值，而不是您的函数。它返回一个`intervalID`，因此您可以使用 清除它`clearTimeout`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T20:58:48.410

`myVar``setInterval`无论您是否声明了匿名函数，都保存调用的返回值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:59:13.470

`myVar`将调用 to 的返回值`setInterval`，而不是您传递的匿名函数的返回值，也不是 from `myTimer`。

下面是它的工作原理：

1.  您调用`setInterval`，它返回一个计时器 id。您将一个对匿名函数的引用传递给它。
2.  当间隔到期时，匿名函数被调用（内部）。它返回 undefined （但没关系，因为它是在内部调用的，并且从不使用该返回值）。
3.  每次调用匿名函数时，它都会调用`myTimer`，它也返回 undefined。永远不会在您的匿名函数中使用它。

# c++ - 构建 libsigc++ 失败（std::basic_ostream 显式实例化）

> ID：15233978
> 
> 赞同：1
> 
> 时间：2013-03-05T20:58:04.757
> 
> 标签：c++, macos, compiler-errors, g++, libsigc++

我正在尝试根据此页面在 mac os 10.8 (Mountain Lion) 上安装 ardor ( [http://ardour.org](http://ardour.org) ) 依赖项：http: [//ardour.org/building_osx_native.html](http://ardour.org/building_osx_native.html)。

ardor 开发人员制作了两个脚本来执行此操作：

*   build-gtk-stack (gtk+, glib, pango, cairo...)
*   build-ardour-stack (boost, rapto, libvorbis...)

它们可以在 subversion.ardour.org/svn/ardour2/branches/2.0-ongoing/tools/ 中找到。

我在使用 build-ardour-stack 脚本时遇到了麻烦，尤其是在构建 libsigc++ 时。

我有这个痕迹：

```
[...]
libtool: compile:  g++ -DHAVE_CONFIG_H -I.. -I.. -Wall -g -O2 -MT adaptors/lambda/lambda.lo -MD -MP -MF adaptors/lambda/.deps/lambda.Tpo -c adaptors/lambda/lambda.cc  -fno-common -DPIC -o adaptors/lambda/.libs/lambda.o
/bin/sh ../libtool  --tag=CXX   --mode=link g++ -Wall -g -O2 -no-undefined -version-info 0:0:0 -headerpad_max_install_names -o libsigc-2.0.la -rpath /Users/maxime/a3/inst/lib signal.lo signal_base.lo trackable.lo connection.lo functors/slot.lo functors/slot_base.lo adaptors/lambda/lambda.lo
libtool: link: g++ -dynamiclib  -o .libs/libsigc-2.0.0.dylib  .libs/signal.o .libs/signal_base.o .libs/trackable.o .libs/connection.o functors/.libs/slot.o functors/.libs/slot_base.o adaptors/lambda/.libs/lambda.o    -O2   -install_name  /Users/maxime/a3/inst/lib/libsigc-2.0.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module
libtool: link: (cd ".libs" && rm -f "libsigc-2.0.dylib" && ln -s "libsigc-2.0.0.dylib" "libsigc-2.0.dylib")
libtool: link: ( cd ".libs" && rm -f "libsigc-2.0.la" && ln -s "../libsigc-2.0.la" "libsigc-2.0.la" )
Making all in tests
make[2]: Nothing to be done for `all'.
Making all in examples
g++ -DHAVE_CONFIG_H   -I.. -I..  -Wall -g -O2 -MT hello_world.o -MD -MP -MF .deps/hello_world.Tpo -c -o hello_world.o hello_world.cc
g++ -DHAVE_CONFIG_H   -I.. -I..  -Wall -g -O2 -MT member_method.o -MD -MP -MF .deps/member_method.Tpo -c -o member_method.o member_method.cc
hello_world.cc: In instantiation of ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’:
hello_world.cc:18:   instantiated from here
hello_world.cc:18: error: explicit instantiation of ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’ but no definition available
hello_world.cc: In instantiation of ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’:
hello_world.cc:18:   instantiated from here
hello_world.cc:18: error: explicit instantiation of ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’ but no definition available
hello_world.cc: In instantiation of ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’:
hello_world.cc:18:   instantiated from here
hello_world.cc:18: error: explicit instantiation of ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’ but no definition available
make[2]: *** [hello_world.o] Error 1
make[2]: *** Waiting for unfinished jobs....
mv -f .deps/member_method.Tpo .deps/member_method.Po
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2
libsigcpp build failed 
```

hello_world.cc：

```
#include <iostream>
#include <string>
#include <sigc++/sigc++.h>

SIGC_USING_STD(cout)
SIGC_USING_STD(endl)
SIGC_USING_STD(string)

void on_print(const std::string& str)
{
  std::cout << str;
}

int main()
{
  sigc::signal<void, const std::string&> signal_print;
  signal_print.connect( sigc::ptr_fun(&on_print) );
  signal_print.emit("hello world\n");
  return 0;
} 
```

我的 gcc 是：

```
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00). 
```

你怎么看？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T21:40:30.863

我使用他们的邮件列表询问了 libsigc++ 开发人员。我在这里发布他们要求我尝试的解决方案。就我而言，他们都没有解决问题：

*   删除 SIGC_USING_STD 宏
*   -std=c++0x 编译器标志
*   在 makefile 中注释掉 hello_world.cc

我还尝试将以下选项添加到编译器：-mmacosx-version-min=10.8。

我听说其他一些人在编译我尝试的内容方面取得了成功。它在同一版本的mac os（10.8）下。所以看来问题来自我的部分......

# javascript - 我可以从网络服务值填充谷歌电子表格单元格吗？

> ID：15233979
> 
> 赞同：4
> 
> 时间：2013-03-05T20:58:06.187
> 
> 标签：javascript, gwt, google-apps-script, google-api

在我们公司，我们使用包含我们所有产品价格的谷歌电子表格。此价格以美元和欧元提供。

现在，问题是每天一个人必须查找当天的欧元兑换，然后在一个单元格上更改它，所以我想知道我们是否可以调用一个网络服务来检索当天的货币兑换并自动更新牢房里没有一个人这样做，说实话，就像荷马辛普森喝鸟一样，做那份工作毫无意义，

在此先感谢，祝您有美好的一天！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T03:30:35.250

这看起来像是 Google App Script [https://developers.google.com/apps-script/的案例](https://developers.google.com/apps-script/)

> 自动化重复的流程和工作流程。创建脚本以自动化费用审批、时间表跟踪、工单管理、订单履行等。
> 
> 将 Google 产品与第三方服务相关联。脚本可以将自定义电子邮件和日历邀请发送到 MySQL 数据库中的列表。
> 
> 创建自定义电子表格函数。应用自定义格式或对 Google 电子表格中的数据进行复杂分析。

这里可能没有用 GWT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T03:31:53.100

看看[Google 电子表格 API](https://developers.google.com/google-apps/spreadsheets/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-19T22:09:16.800

该`ImportXML`公式可以查询 XML Web 服务并使用 XPath 对其进行处理。我想这就是你要找的。

[https://www.distilled.net/blog/distilled/guide-to-google-docs-importxml/](https://www.distilled.net/blog/distilled/guide-to-google-docs-importxml/)

# delphi - 如何在firemonkey中创建画笔资源

> ID：15233983
> 
> 赞同：0
> 
> 时间：2013-03-05T20:58:21.027
> 
> 标签：delphi, firemonkey, delphi-xe3

我是 firemonkey 的新手，但一年以来一直在使用 dxscene。在 dxscene 中，可以毫不费力地在资源对象中添加画笔资源（firemonkey 中的样式书）。但是 firemonkey 让我大吃一惊，embaracadero 的 docwiki 建议手动将其添加到我不知道如何的样式书中。

有人可以帮我在样式书中添加画笔资源以便查找它们吗？最好是一种涉及 GUI 的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:53:36.027

样式书只能包含 TFMXObject 的后代，而 TBrush 直接来自 TPersistent，所以不能添加。FMX.types 单元包含一个合适的 TBrushObject，但它似乎没有在任何地方注册，因此它在工具面板中不可用。

我建议创建一个注册它的包，因此可以选择坐。您需要在包中添加一个单元，例如：

```
unit RegisterBrushObject;
interface
uses FMX.Types;

procedure Register;

implementation
uses Classes;

procedure Register;
begin
  RegisterComponents('Custom', [TBrushObject]);
end;

initialization
  RegisterFMXClasses([TBrushObject]);
end; 
```

将其添加到包后，右键单击项目管理器中的包（右上角）并选择安装。

# regex - 从 tcpdump 中提取客户端 IP 地址（在 OpenBSD 上）

> ID：15233984
> 
> 赞同：2
> 
> 时间：2013-03-05T20:58:24.110
> 
> 标签：regex, sed, awk, grep

我正在尝试使用命令 tcpdump 提取和收集一些客户端 IP 地址，但无法弄清楚如何让 grep/sed/awk 只给我输出的第一个 IP 地址。如果我运行以下

```
# tcpdump -t -i vlan4 -n  ip dst host 192.168.2
tcpdump: listening on vlan4, link-type EN10MB

tcpdump: WARNING: compensating for unaligned libpcap packets

10.28.6.1.29447 > 192.168.2.62.22: P 3758838950:3758839034..

10.28.6.1.29447 > 192.168.2.62.22: P 84:136(52) ack 117..

10.28.6.1.29447 > 192.168.2.62.22: P 136:188(52) ack 233..

10.28.6.1.29447 > 192.168.2.62.22: . ack 349 win 251 (DF).. 
```

我只想在没有端口号的情况下获取每行的第一个 ip。所以从上面的输出我想得到......

```
10.28.6.1

10.28.6.1

10.28.6.1

10.28.6.1 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:01:36.880

试试这条切割线：

```
cut -f1-4 -d "." 
```

用你的数据测试：

```
kent$ echo "10.28.6.1.29447 > 192.168.2.62.22: P 3758838950:3758839034..

10.28.6.1.29447 > 192.168.2.62.22: P 84:136(52) ack 117..

10.28.6.1.29447 > 192.168.2.62.22: P 136:188(52) ack 233..

10.28.6.1.29447 > 192.168.2.62.22: . ack 349 win 251 (DF).."|cut -f1-4 -d "."
10.28.6.1

10.28.6.1

10.28.6.1

10.28.6.1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T02:19:27.777

```
perl -lane '$F[0]=~s/(.*)\..*/$1/g;print $F[0]' your_file 
```

# ruby-on-rails - Rails：非 ActiveRecord 模型需要包含 ActiveModel::Serializers，还是只响应 #as_json？

> ID：15233990
> 
> 赞同：0
> 
> 时间：2013-03-05T20:58:40.107
> 
> 标签：ruby-on-rails, json, active-model-serializers

使用 Rails 3.2，我正在开发一个 API 支持的模型（不是 ActiveRecord）。我希望能够`to_json`在 Rails 控制器中调用这个模型。在阅读了一堆 ActiveModel 文档后，我仍然不清楚一件事：

给定这样的模型：

```
class MyModel
  attr_accessor :id, :name
  def initialize(data)
    @id = data[:id]
    @name = data[:name]
  end

  def as_json
    {id: @id, name: @name}
  end
end 
```

这应该按预期工作，还是我还需要包括`ActiveModel::Serializers::JSON`？我很难弄清楚`as_json`/`to_json`方法通常在哪里定义，以及 Rails 何时在不同情况下自动调用哪些方法......

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:48:44.367

是的，这确实有效，但不要像你写的那样引用。

当您使用在控制器中渲染 json 时

```
def action
  render :json => @my_model
end 
```

然后 Rails 会自动调用`to_json`你的对象，只要你定义`to_json`了它就会按预期工作。

如果您的控制器使用 Rails 3 内容协商恶作剧，即。

```
class Controller < ApplicationController
  respond_to :json, :html

  def action
    respond_with(@my_model)
  end 
```

然后你需要覆盖`as_json`你的类，但是方法签名需要一个可选的选项散列才能与 ActiveSupport 兼容，所以在这种情况下你想要

```
def as_json(options={})
  ...
end 
```

或者，如果您包含`ActiveModel::Serializers::JSON`在您的类中并且您的类支持`attributes`返回 attrs 及其值的哈希的方法 - 那么您将`as_json`免费获得 - 但如果您只是手动覆盖该方法，则无法控制您拥有的结果结构.

希望这可以帮助。

# php - 从内部服务器到图像文件的 PHP 外部链接

> ID：15233992
> 
> 赞同：0
> 
> 时间：2013-03-05T20:59:03.517
> 
> 标签：php, image, postgresql, hyperlink

我被困住了，我希望这里有人可以帮助我。

我想在 php 脚本中创建一个文件的链接（该文件实际上是一个图像，一个 .tif 图像）。我无情地用谷歌搜索，但无济于事。

防火墙阻止了外部连接，但我在模拟内部连接的机器上运行此查询。我目前使用这台机器允许外部用户运行访问内部数据库的查询，所以我知道这是可行的……</p>

例如这部分工作得很好：

```
$result = pg_query($conn, $query); 
while($row=pg_fetch_assoc($result)) 
{ 
echo "<p>image details:<br />image: <u>" . $row['field'] . "</u>&nbsp;image date: <u>" . $row['field'] . "</u>&nbsp;image path: <u>" . $row['filename'] . "</u></p>"; 
```

我想变成链接的查询部分是 $row['filename']，它返回为

```
//host\path\path\path\path\path\path\path.TIF 
```

…但现在我想访问与这些查询相关的某些文件。我想将此文件名转换为 url，当放入链接时，会转到此文件并打开它：

```
$imageURL = $row['filename'];
echo  "<p>Using imageURL: <a href='$imageURL' border='0' target='_blank'>Click Here</a></p>"; 
```

也许这是不可能的。我似乎无法弄清楚如何获取图像。

我没有 imagemagick 或 imagick，我不想走那条路。提前感谢您的帮助。

编辑我正在运行查询的机器是[http://webapps.example.com](http://webapps.example.com)
我正在查询的机器（图像所在的位置）不是 - 我试图返回的图像路径（作为链接）是 //hostipaddress \path\path\path\path\path\path\filename.TIF

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:20:10.097

您可以使用可以正常链接到的代理页面来完成渲染图像的工作。

让我们将代理页面**称为 readimage.php**，它将文件名或路径作为参数。

您的链接将如下所示：

```
<?php 
$imageURL = $row['filename'];
echo  "<p>Using imageURL: <a href='readimage.php?image=$imageURL' border='0' target='_blank'>Click Here</a></p>";
?> 
```

## 读取图像.php

```
<?php

$img = isset( $_GET['image'] ) ? $_GET['image'] : null;

if ( !$img )
    return;

// Build internal file path
//$filepath = dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'myimages' . DIRECTORY_SEPARATOR . $img;
$filepath = $img;

//==========================
// VERY IMPORTANT TO WHITELIST THE PATH OR RESULT to make sure you're not showing unintended data
//==========================

if ( file_exists( $filepath ) ) {
    // Find mime type 

    $mime = '';

    // Try using the fileinfo functions. Requires PHP >= 5.3 and PECL 1.0
    if ( function_exists( 'finfo' ) ) {
        $finfo = new finfo( FILEINFO_MIME ); // return mime type ala mimetype extension

        /* get mime-type for a specific file */
        $mime = $finfo->file( $filepath );
    } 

    // No mime yet? Try to use the deprecated mime_content_type() function 
    if ( !$mime && function_exists( 'mime_content_type' ) ) {
        $mime = mime_content_type( $filepath );
    }

    // Not yet? Fallback to extensions :(
    if ( !$mime ) {
        $ext = pathinfo( $filepath, PATHINFO_EXTENSION );

        switch ( $ext ) {
            case "jpg" :
            case "jpeg" :
            case "jpe" :
                $mime = "image/jpg";
            break;
            case "png" :
            case "gif" :
            case "bmp" :
            case "tiff" :
                $mime = "image/" . strtolower( $ext );
            break;
        }
    }

    if ( $mime ) {
        header( 'Content-type: ' . $mime );

        readfile( $filepath );
    }
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:02:25.073

如果您可以拥有一个允许您向外部发送请求的代理地址，您可以使用 curl 来完成。

** 更新 2

来自 curl [的图像 使用 curl PHP 从 url 保存图像](https://stackoverflow.com/questions/6476212/save-image-from-url-with-curl-php)

在代理后面卷曲：

```
curl_setopt($ch, CURLOPT_PROXY, "http://to.the.proxy.address"); 
curl_setopt($ch, CURLOPT_PROXYPORT, 8080); 
curl_setopt ($ch, CURLOPT_PROXYUSERPWD, "your password"); 
```