# StackOverflow 问答 15012000-15012999

# cross-platform - 文件名中包含 $ 有什么问题？

> ID：15012000
> 
> 赞同：1
> 
> 时间：2013-02-21T20:53:04.957
> 
> 标签：cross-platform, special-characters, compatibility, filenames

我试图说服其他开发人员不要包含`$`在文件名中，但除了某些 Perl 脚本可能需要更新之外，我无法提出任何参数。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T20:56:31.303

快速浏览一下 Wikipedia 的[文件名](http://en.wikipedia.org/wiki/Filename#Comparison_of_filename_limitations)页面就会发现，只有 zOS 和 Commodore DOS 不允许用户`$`出现在某些文件名中。我明白为什么你很难找到不使用它们的理由。

# c - 'strings' 比较静态字符数组和通过套接字发送的另一个字符数组

> ID：15012005
> 
> 赞同：0
> 
> 时间：2013-02-21T20:53:19.917
> 
> 标签：c, linux, arrays, sockets, char

我正在尝试通过套接字 tcp 验证 2 个字符串，但我不知道我做错了什么，所以我尝试使用 strcmp 比较的字符串是：

标题：

```
struct message{
    char n[32];
    int flag;
}; 
```

在服务器中：

```
char names[3][32];
strcpy(passs[0], "111");

int z;
printf("checking data\n");
for(z=0 ; z<3; z++){
    if (strcmp(&m.n, names[z]) == 0){
        printf("name found\n");
    }
} 
```

在客户端：

```
struct message m;
fgets(m.n, 32, stdin);
send(cSock, &m, sizeof(m),0); 
```

ps：我试图只给出基本的代码行，因为该程序是一个带有线程的客户端/服务器 tcp 示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T19:29:06.013

如果`fgets(m.n, 32, stdin);`从标准输入读取少于 32 个字符，则换行符将出现在末尾，并将通过套接字发送。从中读取的任何内容`fgets(m.n, 32, stdin);`都不会匹配“111”，因为它的长度为 3 并且不以换行符结尾。

解决方案：在您执行`fgets`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T19:12:46.980

您需要初始化 : 的所有元素，`char names[3][32]`如果不这样做，则从中读取的是未定义的行为，并且任何事情都可能发生：

```
for (i = 0; i < 3; i++)
    names[i][0] = 0;  // Initialize to the empty string 
```

# asp.net - 在 asp.net 中使用报告服务和 DB 值打印带有条形码的“标签”

> ID：15012006
> 
> 赞同：0
> 
> 时间：2013-02-21T20:53:23.223
> 
> 标签：asp.net, sql, printing, reporting-services, barcode

编辑7：我终于成功了！贴出答案。

编辑 6：我废弃了 CSS 和 div 并使用了报告服务。查看帖子下方的编辑以了解我现在的位置。

我现在完全迷路了。
抱歉，如果我的问题不够清楚，我可以根据需要对其进行编辑以添加信息。我会尽量提供尽可能多的信息。
我已经在谷歌上搜索了几个小时，但没有找到任何可以帮助我的东西。

我正在尝试使用我在数据库中的用户信息创建多个“标签”，并将它们放在页面上以打印它们。另外，我每页只需要 1 个标签。
我得到了一个存储过程，它返回给我用户名、姓名和姓氏以及我用来在特定事件中为每个用户生成条形码的 ID。

```
CREATE PROCEDURE Schema.GetAllTags
@IdEvent int
AS
BEGIN
    SELECT  Mem.Nom, Mem.Prenom, Mem.Pseudo, Use.IdUser
FROM    Schema.User Use
JOIN    Schema.Member Mem ON Use.IdMember = Mem.IdMember
WHERE   Use.IdEvent = @IdEvent
END 
```

条形码是通过调用一个 asp 页面并给它我从页面参数中存储的过程中收到的 ID 生成的。asp 页面是我用来在其他页面中显示我的条形码的图像。

我尝试使用 div、CSS、asp 内容和所有这些东西制作标签，并且它工作......除了打印部分。标签一直在调整大小，即使我尽一切努力使其成为 25.4 毫米（1 英寸），页边距也不是一英寸，并且在它上面，页面的 url 始终显示在预览打印中。客户只需取消选中显示网址并在选项中自己设置边距即可解决所有这些问题。但我不想强迫客户做这些来解决问题。我希望它是 3 x 2 英寸，边距为 1 且没有 url，而无需更改打印选项。

有人告诉我，使用报告服务可以解决我的打印问题。但是我不知道如何从报告服务中获得我需要的东西（我知道报告服务是什么）......更不用说如何让我的条形码在那里了。

在这里，标签在打印页面上最终应该是什么样子。3 英寸 x 2 英寸，打印时顶部和左侧边距为 1 英寸。

![标签应该是什么样子](../Images/3c3457ee144f812d2291a23b5f6908dd.png)

这是我用来尝试打印标签的 CSS：

```
<style type="text/css">
    @page
    {
        margin: 25.4mm 25.4mm 25.4mm 25.4mm;  
    }

    @media print 
    {
        body *  
        {
            visibility:hidden;
        }
        #tagPrint, #tagPrint * 
        {
            visibility:visible;
        }
        #tagPrint
        {
            position:fixed;
            top: 0px;
            left: 0px;
        }
        #NOPRINT
        {
            display:none;
        }
    } 
```

这里是asp（这是我的页面，只显示1个标签）：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" >
    <ContentTemplate>
        <div id="tag" class="formRow">
            <div id="tagPrint" style="border:1px solid;width:76.2mm;height:50.8mm">
                <p style="text-align:center" />
                <br />
                <asp:Label ID="lblUserTag" runat="server" style="font-weight:bold;font-size:18px" />
                <br />
                <asp:Label ID="lblFullNameTag" runat="server" style="font-weight:bold;font-size:16px" />
                <br />
                <br />
                <asp:Image ID="imgBarcodeTag" runat="server" />
                <br />
                <asp:Label ID="lblIdTag" runat="server" style="font-weight:bold;font-size:16px" />
            </div>
        </div>
        </ContentTemplate>
    </asp:UpdatePanel> 
```

目前在我的页面上使用转发器生成我的标签以生成多个标签并将 dataset.tables[0].Rows 绑定到转发器。允许我创建这些标签。

有什么方法可以在不使用仅使用 javascript 和 CSS 的报告服务的情况下做到这一点？报告服务是否可行（在报告服务中使用 asp 页面制作条形码）？由于我的条形码来自字体，有没有其他方法可以在计算机上添加字体以便在报告服务中使用它？（我不希望客户端必须安装字体）制作标签的 pdf 会更容易/更好吗？

编辑：开始使用报告服务。现在我得到了用 4 个参数制作的报告。（用户名、全名、条形码 url 和 ID）我会更新接下来会发生什么。

编辑2：所以......在设法制作报告服务并将其显示在页面中之后。我似乎无法让我的图像显示在报告上。即使我这样做了。我不知道如何在报告上制作多页或如何打印。我决定尝试以 PDF 格式制作我的 Div Tag 并尝试以这种方式打印。明天有机会尝试更新。

编辑 3：除了想把我的头砸在墙上几次之外，我尝试用 PDF 做它，但它不起作用。发现它可能可以在 Flash 中完成，但我不想在 Flash 中完成。所以我回到了报告服务。我使用网格创建了一个报告服务，我将数据集发送到网格并将数据放在每个字段中。我安装了字体以便能够在报告中使用它。现在我似乎无法将我的数据集绑定到报告。我尝试了 SqlDataSource 和 ObjectDataSource，但似乎没有任何效果。我在一个新项目中开始了另一份报告，以尝试从废品中提取。也许我当前项目中的某些东西正在与我作对。我快要放弃了。-_-

编辑4：我终于让它开始工作了。让我的页面上的报告工作得很好。

![报告服务](../Images/c90fff15cbe87d7ae448719722c990d1.png)

![结果](../Images/3888998be561046a1608e5639510a510.png)

现在我唯一要做的就是设法让报告有多个页面。

编辑 5：重读我的编辑，我意识到在编辑 2 之后我忘了说，我放弃了参数的东西，而是使用了一个数据集。此外，我放弃了有关 CSS 和 div 的所有内容，以使用报告服务来保存标签的 PDF 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:59:58.610

所以让我先用一些关于 SSRS 的解释作为开头：你做错了。

我的意思是，如果您只是想在 SSRS 中嵌入 ASP 代码和输出以实现图形保真度，那是不会发生的。

向您推荐 SSRS 的原因是因为它可以获取一组数据并以各种报告样式、格式和输出方法以高图形保真度再现它。

但是你必须从头开始构建它。没有 HTML，没有 CSS，没有 ASP，没有 .Net（嗯.. 有点。对你来说，是的，不需要 .Net。）

哇，哇，哇，你要去哪里？我保证，这并不难。

所以......首先，让我们为您在 SSRS 中执行此操作设置一个任务列表。在我们做这件事之前，让我们构建一个向导驱动的报告，这样我们就可以将您的 ID 标签数据集放入报告中。它将让您基本了解 SSRS 如何使用数据并将其转换为报告。

1.  创建一个全新的 Reporting Services 项目。
2.  向该项目添加新报告。在解决方案资源管理器中，右键单击“报告”文件夹并“添加新报告”。
3.  第一步是选择数据源。使用您正在运行的存储过程将其连接到您的数据库，测试您的连接，然后继续。
4.  下一步是设计查询——但你已经用你的 Sproc 完成了，所以只需将它粘贴进去——现在，为你的 IdEvent 添加一个硬编码的值。我们稍后会解决这个问题。
5.  现在选择您的报告类型 - 我们现在只做表格。Matrix 更适合大量行/列动态，而您只是在寻找一个简单的可打印报告，所以表格适合您。
6.  现在在设计表格时，只需将所有输出列添加到 Detils 组。
7.  选择任何旧的表格样式，你最终都会把这一切都扔掉。
8.  将您的报告命名为有用的名称并完成。

现在您已经有了一个 RDL，它有一个数据源、一个数据集和设计器区域中的一些代码。您可以通过单击设计器区域中的“预览”选项卡来预览到目前为止所做的工作。非常棒，您的所有数据都在表格的小行中。怎么办？

现在是任务列表。开始谷歌搜索，您可以学习所有这些，不会花费太长时间，当您完成后，您将准备好一组格式良好的 ID 标签供打印机使用。如果您遇到特定问题 - 好吧，这就是该网站的用途，对吗？

1.  创建一个参数以将您的 IDEvent 传递给您的存储过程。
2.  将动态外部图像插入从 ASP 页面检索条形码的行中。（提示：阅读在 SSRS 中使用“表达式”。）
3.  弄清楚如何使用 SSRS 中的分页符选项，每页只打印 1 个标签。
4.  使用属性窗口来格式化表格的每一“行”，使其看起来像您的标签。
5.  确定是将报告导出为 PDF，还是仅使用提供的 MHTML 版本。

您可能还想学习如何在 .Net 应用程序中嵌入 SSRS 报告（无论如何，您的客户是如何打印标签的？）当然，SSRS 的许多小方法、属性和方面都超出了此特定任务的范围，但至少值得在以后的项目中查看。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:20:30.110

最后！我做到了！

这就是我所做的。

1.  做了一个SSRS。
2.  做了一个报表查看器和 ObjectDataBinder
3.  使用我的存储过程为 SSRS 创建一个数据集。
4.  将报表查看器绑定到 SSRS。
5.  在 SSRS 周围玩耍以放置需要放置的字段。
6.  将 SSRS 中的页边距设置为 1 英寸。将报告设置为 3x2 英寸。
7.  将报告大小设置为 5x4 英寸。
8.  测试并享受我在这些小时的挫折中取得的胜利。

注意：我花了很多时间，因为 Visual Studio 对我进行了窃听，我不得不完全删除并重做我的 SSRS。

结果 ：

![结果](../Images/1cd2241b60458c5b4ba022a7bad21060.png)

一个漂亮的 PDF 文件，大小完美，边距完美，带有代码栏。胜利！

# c++ - Arduino 编译器抛出“invalid type argument of unary *”

> ID：15012007
> 
> 赞同：0
> 
> 时间：2013-02-21T20:53:24.363
> 
> 标签：c++, arduino, nonblocking

我正在尝试对非阻塞 LED 闪烁进行编程。

因此我编写了一个小课：

```
03: class timer {
04: private:  
05:   int startMillis;
06:   int delayMillis;  
07: public:  
08:  timer ( int pDelay ) {
09:    reset ( pDelay );
10:  }  
11:  void start () {
12:    startMillis = millis();
13:   }  
14:   void reset ( int pDelay ) {
15:     delayMillis = pDelay;    
16:   }  
17:   boolean checkTimer () {
18:     if ( (millis() - startMillis) >= delayMillis ) {
19:       return true;
20:     } else {
21:       return false;
22:     }
23:   }
24: }; 
```

然后我想在循环（）中做这样的事情：

```
42: void switchLed (int *pPin, timer *pTimer) {
43:   if ( (*pTimer->checkTimer()) == true ) {
44:     if ( bitRead(PORTD, *pPin) == HIGH ) {
45:       digitalWrite(*pPin, LOW);
46:     } else {      
47:       digitalWrite(*pPin, HIGH);
48:     }
49:     *pTimer->start();
50:   }
51: } 
```

我在 loop() 中使用参数“(&led[0], &ledTimer01)”调用 switchLed() 函数。我认为它应该可以工作，但我的编译器说

```
nonblockingblink:5: error: 'timer' has not been declared
nonblockingblink.ino: In function 'void switchLed(int*, timer*)':
nonblockingblink:43: error: invalid type argument of 'unary *'
nonblockingblink:49: error: void value not ignored as it ought to be 
```

问题出在哪里？感谢帮助 ：）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T20:57:17.883

`pTimer->checkTimer()`有类型`boolean`

所以这：

```
*pTimer->checkTimer() 
```

无效，因为`boolean`它不是指针类型。

其他功能也一样，为什么要使用`*`运算符？这是不正确的：

```
*pTimer->start(); 
```

这是对的：

```
pTimer->start(); 
```

或者

```
(*pTimer).start();  // equivalent to above, prefer the above form 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T20:58:07.453

您使用两种类型的指针取消引用。首先你使用`->`访问`pTimer`结构成员，然后你`*`再次使用非指针类型（`boolean`返回的`checkTimer`）。删除星号，它应该可以工作。

# android - 从通用代码库创建多个库

> ID：15012008
> 
> 赞同：0
> 
> 时间：2013-02-21T20:53:28.100
> 
> 标签：android, libraries

是否可以从一个通用代码库创建多个具有不同功能的库？我想在一个 Android 库项目中创建多个 .jar 文件。目标是一些用户只能访问功能的子集，而更多特权用户可以访问整个库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:15:05.947

一种方法是使用[Apache Antenna](http://antenna.sourceforge.net/wtkpreprocess.php)对文件进行预处理并进行条件编译。如果你走这条路，你将需要使用 Apache Ant 来构建。请参阅这些资源：

*   [安卓蚂蚁教程](http://www.vogella.com/articles/AndroidBuildAnt/article.html)
*   [从命令行管理项目](http://developer.android.com/tools/projects/projects-cmdline.html)
*   [从命令行构建](http://developer.android.com/tools/building/building-cmdline.html)

另一种方法是使用 Git 分支，主分支包含基本功能，子分支包含额外功能。然后，当您想要构建一个或另一个时，您只需切换分支。[Git SCM 这本书](http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging)有一些关于如何使用你的子分支的好信息。

# python - python如何将多个参数传递给类而不使它们成为必需

> ID：15012011
> 
> 赞同：0
> 
> 时间：2013-02-21T20:53:38.523
> 
> 标签：python

好的，所以我对 python 很陌生，我正在旧金山的一个社区中心上免费课程，所以是的，这是“家庭作业”，但它不适合学校，所以请明确。

好的，所以我们正在进行运算符重载，但我有一个与类中的参数相关的问题，这让我很困惑。我可能完全偏离了我的想法，所以任何帮助都会很棒。

到目前为止，这是我的课程代码

```
class CoinPurse(object):

    def __init__(self, quarters=0, dimes=0, nickels=0, pennies=0):
        self.purse ={'quarters': 0, 'dimes': 0, 'nickels': 0, 'pennies': 0}

    def __setitem__(self, quarters, dimes, nickels, pennies):
        self.purse ={'quarters': quarters, 'dimes': dimes, 'nickels': nickels, 'pennies': pennies}

    def amount(self):
        """ Return the amount of money as a floating point value """
        self.purseamount = 0
        self.purseamount = self.purseamount + ((self.purse['quarters']) * 25)
        self.purseamount = self.purseamount + ((self.purse['dimes']) * 10)
        self.purseamount = self.purseamount + ((self.purse['nickels']) * 5)
        self.purseamount = self.purseamount + self.purse['pennies']
        self.purseamount = float(self.purseamount) / 100

        return float(self.purseamount)

    def quarters(self):
        """ Returns the number of quarters as an integer """

        return int(self.purse['quarters'])

    def dimes(self):
        """ Returns the number of quarters as an integer """

        return int(self.purse['dimes'])

    def nickels(self):
         """ Returns the number of quarters as an integer """

        return int(self.purse['nickels'])

    def pennies(self):
        """ Returns the number of quarters as an integer """

        return int(self.purse['pennies']) 
```

好的，这是一个使用该类的测试，稍后我必须对它做更多的事情，但现在我只想确保基础工作正常

```
x = CoinPurse(quarters=5, pennies=100)
print x.amount()
print x.quarters()
print x.pennies() 
```

现在我的问题是这样的，我知道我没有正确使用**setitem**我将如何传递参数（四分之一 = 5，便士 = 100）以便可以将它们添加到字典对象中。我需要同时传递键和值（四分之一是键，5 是值）......我迷失了这一点，在我弄清楚之前无法继续。

顺便说一句，我无法更改必须以这种方式使用的 x = CoinPurse(quarters=5, pennies=100)。

**根据建议编辑代码

```
class CoinPurse(object):

    def __init__(self, **kwargs):
        self.pquarters = kwargs.get('quarters', 0)
        self.pdimes = kwargs.get('dimes', 0)
        self.pnickels = kwargs.get('nickels', 0)
        self.ppennies = kwargs.get('pennies', 0)

    def amount(self):
        """ Return the amount of money as a floating point value """
        self.purseamount = 0
        self.purseamount = self.purseamount + (self.pquarters * 25)
        self.purseamount = self.purseamount + (self.pdimes * 10)
        self.purseamount = self.purseamount + (self.pnickels * 5)
        self.purseamount = self.purseamount + self.ppennies
        self.purseamount = float(self.purseamount) / 100

        return float(self.purseamount)

    def quarters(self):
        """ Returns the number of quarters as an integer """

        return int(self.pquarters)

    def dimes(self):
        """ Returns the number of quarters as an integer """

        return int(self.pdimes)

    def nickels(self):
        """ Returns the number of quarters as an integer """

        return int(self.pnickels)

    def pennies(self):
        """ Returns the number of quarters as an integer """

        return int(self.ppennies) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:01:59.840

如果您只是将参数设为所有关键字，那会更简单。然后，您可以将单个硬币数量设置为默认值（如果未给出）：

```
def __init__(self, **kwargs):
    quarters = kwargs.get('quarters', 0)
    # etc. for other coins 
```

您可能还应该验证除了允许的硬币之外没有给出任何关键字。

# javascript - 使用按钮循环浏览 html 文件列表

> ID：15012013
> 
> 赞同：-3
> 
> 时间：2013-02-21T20:53:41.660
> 
> 标签：javascript, html, cycle

我有一个产品清单说：

```
laptops/prod1.html
laptops/prod2.html
laptops/prod3.html
monitors/prod1.html
monitors/prod2.html
monitors/prod3.html 
```

我想在我的页面上有一个“循环”可用项目的按钮。

不知道该怎么做。这可以用javascript吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T23:56:05.890

设置一个主页，这不应该是静态 html 页面，而是您选择的服务器端语言。

使用脚本标签将 jquery 包含到主页中（您可以从[http://jquery.com/](http://jquery.com/)获取 jquery ）。

您的 html 可能如下所示：

```
<div id='content'></div>
<div>
   <a href='javascript:void(0)' id='prev' class='btn'>Previous</a>
   <a href='javascript:void(0)' id='next' class='btn'>Next</a>
</div> 
```

在你的 js 文件中，你会有这样的东西：

```
var currPage = 0;
var pageList = ["laptops/prod1.html","laptops/prod2.html", "laptops/prod3.html"];
var totalPages = pageList.length;
$(".btn").on("click",function(){
   //if we are at the last page set currpage = 0 else increment currPage.
   currPage = currPage < (totalPages - 1) ? ++currPage : 0;
   var page = pageList[currPage];
   $('#content').load(currPage);
}); 
```

需要考虑的几点：

1.  您将需要决定是在主页加载还是在单击时加载第一页
2.  您需要设置一个 js 变量来跟踪当前加载的页面
3.  您将需要添加一些方法来存储所有可能的页面（想想一个数组）。这可以在页面加载时打印到页面上的脚本标签。
4.  你需要决定当你到达行尾时会发生什么。您可以循环或灰显相应的链接。

[jquery 上的](http://api.jquery.com/on/) [jquery 加载](http://api.jquery.com/load/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:19:07.930

```
function nextProduct(incr) {
  var href = window.location.href
    , offset = (typeof(incr)==='undefined' ? 1 : incr);
  window.location = href.replace(/(\d+)\.html/, function(m, g1) {
    return (Number(g1) + offset) + '.html'
  });
} 
```

然后您可以执行以下操作：

```
var button;
button = document.getElementByID('next-button');
button.addEventListener('click', function() { nextProduct(1); });
button = document.getElementByID('prev-button');
button.addEventListener('click', function() { nextProduct(-1); }); 
```

# vb.net - VB.net 使用 UserPrincipalEx 创建新的 AD 用户帐户？

> ID：15012014
> 
> 赞同：1
> 
> 时间：2013-02-21T20:53:45.507
> 
> 标签：vb.net, active-directory, directoryservices

我正在尝试添加部门和标题等字段。

我正在使用它来创建一个用户帐户：

```
Dim ctx As New PrincipalContext(ContextType.Domain, "domain.name.pvt",  "OU=Users,DC=global,DC=pvt")

Dim usr As UserPrincipal = New UserPrincipal(ctx) 
```

我创建帐户没有问题，但无法添加简单的东西，例如`Department`和`Title`。我阅读了有关使用扩展的信息，但它是在 C++ 中的，并且不知道如何去做。

任何帮助都会很棒！！！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:27:52.733

如果您使用的是 .NET 3.5 及更高版本，则应查看`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

要扩展这个`UserPrincipal`类，你不需要太多——这样的东西就足够了（*我最初是用 C# 编写的，只是在网上将它转换为 VB.NET——我希望 VB.NET 代码没有问题！*）

```
Imports System.DirectoryServices.AccountManagement

Namespace ADExtended
    <DirectoryRdnPrefix("CN")> _
    <DirectoryObjectClass("Person")> _
    Public Class UserPrincipalEx
        Inherits UserPrincipal
        ' Inplement the constructor using the base class constructor. 
        Public Sub New(context As PrincipalContext)
            MyBase.New(context)
        End Sub

        ' Implement the constructor with initialization parameters.    
        Public Sub New(context As PrincipalContext, samAccountName As String, password As String, enabled As Boolean)
            MyBase.New(context, samAccountName, password, enabled)
        End Sub

        ' Create the "Department" property.    
        <DirectoryProperty("department")> _
        Public Property Department() As String
            Get
                If ExtensionGet("department").Length <> 1 Then
                    Return String.Empty
                End If

                Return DirectCast(ExtensionGet("department")(0), String)
            End Get
            Set
                ExtensionSet("department", value)
            End Set
        End Property

        ' Create the "Title" property.    
        <DirectoryProperty("title")> _
        Public Property Title() As String
            Get
                If ExtensionGet("title").Length <> 1 Then
                    Return String.Empty
                End If

                Return DirectCast(ExtensionGet("title")(0), String)
            End Get
            Set
                ExtensionSet("title", value)
            End Set
        End Property

        ' Implement the overloaded search method FindByIdentity.
        Public Shared Shadows Function FindByIdentity(context As PrincipalContext, identityValue As String) As UserPrincipalEx
            Return DirectCast(FindByIdentityWithType(context, GetType(UserPrincipalEx), identityValue), UserPrincipalEx)
        End Function

        ' Implement the overloaded search method FindByIdentity. 
        Public Shared Shadows Function FindByIdentity(context As PrincipalContext, identityType As IdentityType, identityValue As String) As UserPrincipalEx
            Return DirectCast(FindByIdentityWithType(context, GetType(UserPrincipalEx), identityType, identityValue), UserPrincipalEx)
        End Function
    End Class
End Namespace 
```

现在，您只需使用`UserPrincipalEx`该类：

```
Dim ctx As New PrincipalContext(ContextType.Domain, "domain.name.pvt",  "OU=Users,DC=global,DC=pvt")

Dim usr As UserPrincipalEx = New UserPrincipalEx(ctx) 
usr.Title = "......."
usr.Department = "......." 
```

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！

# php - 将 php var 设置为 *（全部）

> ID：15012021
> 
> 赞同：0
> 
> 时间：2013-02-21T20:54:05.853
> 
> 标签：php, zip

我使用下面的代码从文件夹根目录中的所有文件中创建和下载一个 zip 文件。我有这条线

```
$files_to_zip = array(
      'room1.jpg', 'room2.jpg'
    ); 
```

它使您可以选择将哪些文件放入 zip 文件中 - 但我的文件是 cron 作业的结果，因此每天都会生成一个新文件。我如何编写一个变量来表示除“”之外的所有文件，然后在 zipfolder 中列出我不想要的文件，即。index.php 等

到目前为止，我尝试编写`$files_to_zip = *;`（显然不会排除任何文件），但这只会引发**Parse 错误：语法错误**

这是下面的完整代码：

```
 <?php
    /* creates a compressed zip file */
    function create_zip($files = array(),$destination = '',$overwrite = true) {
      //if the zip file already exists and overwrite is false, return false
      if(file_exists($destination) && !$overwrite) { return false; }
      //vars
      $valid_files = array();
      //if files were passed in...
      if(is_array($files)) {
        //cycle through each file
        foreach($files as $file) {
          //make sure the file exists
          if(file_exists($file)) {
            $valid_files[] = $file;
          }
        }
      }
      //if we have good files...
      if(count($valid_files)) {
        //create the archive
        $zip = new ZipArchive();
        if($zip->open($destination,$overwrite ? ZIPARCHIVE::OVERWRITE : ZIPARCHIVE::CREATE) !== true) {
          return false;
        }
        //add the files
        foreach($valid_files as $file) {
          $zip->addFile($file,$file);
        }
        //debug
        //echo 'The zip archive contains ',$zip->numFiles,' files with a status of ',$zip->status;

        //close the zip -- done!
        $zip->close();

        //check to make sure the file exists
        return file_exists($destination);
      }
      else
      {
        return false;
      }
    }

    $files_to_zip = array(
      'room1.jpg', 'room2.jpg'
    );
    //if true, good; if false, zip creation failed
    $zip_name = 'my-archive.zip';
    $result = create_zip($files_to_zip,$zip_name);

    if($result){
    header('Content-Type: application/zip');
    header('Content-disposition: attachment; filename=filename.zip');
    header('Content-Length: ' . filesize($zip_name));
    readfile($zip_name);
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T20:59:28.510

对文件系统进行通配符匹配的函数是`glob()`.

```
$files_to_zip = glob("*"); 
```

# javascript - 在 EXT.JS 中使用 AJAX 下载文件

> ID：15012024
> 
> 赞同：0
> 
> 时间：2013-02-21T20:54:13.733
> 
> 标签：javascript, jquery, extjs

我有以下 ajax 调用：

```
var blind = Ext.create('MyApp.view.blind.Progress', {});
         blind.show();
         Ext.Ajax.request({
            url: config.url,
            params: {
               nodeId: config.data[0].value,
               fileName: config.data[1].value,
               startDateTime: config.data[2].value,
               endDateTime: config.data[3].value,
               reportFormat: config.data[4].value
            },
            success: function (response) {
               console.log(response);
               blind.close();
            }
         }); 
```

我想显示一个带有加载图形的百叶窗，并在完成后关闭它。有没有办法使用这个 ajax 回调从响应中下载文件？我在正确的轨道上吗？如果可能，我想避免使用 iframe 或打开新标签。如果它更容易，我愿意使用其他库，如 jquery。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:49:30.930

不要认为用文件来响应 ajax 请求是可能的。一个简单的表单提交应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T17:31:22.910

好吧，我不喜欢被告知我不能做什么，所以我一直在研究并找到了这个 jquery 插件。它的工作原理是在文件交付时轮询服务器制作的 cookie，以及用于下载文件的典型 iframe 方法。没有臃肿，没有闪光，正是我想要的：

[jQuery 文件下载](http://jqueryfiledownload.apphb.com/)

下载插件，将其链接到您网站的某个位置，然后将此 cookie 生成代码添加到您的文件请求的任何位置（链接中有更多示例，我使用的是 ASP.NET）：

`HttpContext.Current.Response.SetCookie(new HttpCookie("fileDownload", "true") { Path = "/" });`

我的应用程序中的示例代码，使用插件的成功和失败回调来控制我的 extjs 盲：

```
$.fileDownload(config.url, {
     successCallback: function (url) {
        //Show a message here or perform some task
        blind.close();
     },
     failCallback: function (html, url) {
        blind.close();
        alert("The report generation failed.");
     },
     httpMethod: "POST",
     data: {
        nodeId: config.data[0].value,
        fileName: config.data[1].value,
        startDateTime: config.data[2].value,
        endDateTime: config.data[3].value,
        reportFormat: config.data[4].value
     }
  }); 
```

# c# - 在 byte[] 中显示 +255 字节

> ID：15012025
> 
> 赞同：0
> 
> 时间：2013-02-21T20:54:17.930
> 
> 标签：c#, bytearray, byte

我真的希望有人能帮助我。

我有一个`byte[]`必须显示`byte[]`要遵循的 die 中的字节数的单曲。现在我的值在 255 以上。有没有办法显示/输入一个大数字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:03:13.977

一个字节包含一个从 0 到 255 的值。要表示 299，您要么必须使用 2 个字节，要么使用一种方案（接收方也必须使用），其中字节中的值被解释为大于其标称值值以扩大可能的值范围。例如，该值可以是长度 / 2。这将允许 0 - 510 的长度，但只允许偶数长度（奇数长度的数组需要一个填充字节）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T20:57:52.700

您可以使用两个（或更多）字节来表示大于 255 的数字。这是您想要的吗？

```
short value = 2451;
byte[] data = BitConverter.GetBytes(value); 
```

如果为了与某些外部系统交换数据需要这样做，请记住阅读有关[Endianness](http://en.wikipedia.org/wiki/Endianness)的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:03:21.473

这取决于您认为什么是好的方法。您可以执行某种形式的编码以允许存储大于 2 个字节的数据。即，也许将第一个字节设置为 0xFF 意味着您会将下一个字节视为其数据的一部分。 `[0x01,0x0A,0xFF,0x0A]` 将被解释为 3 个值`[1,10,265]`

# php - 多维导航阵列

> ID：15012026
> 
> 赞同：0
> 
> 时间：2013-02-21T20:54:19.167
> 
> 标签：php, css, html

尝试使用多维数组和递归构造导航。我有以下代码：

首先，我`<?php $title = 'pagename'; ?>`在 doctype 下的每个单独页面上运行（用于活动类检测）

**大批：**

```
<?php

$nav_array = array ('Home' => 'index.php',
                   'About' => array ( 'about.php', array (
                        'Michael' => array( 'michael.php', array (
                            'Blog' => 'blog.php',
                            'Portfolio' => 'portfolio.php')), 
                        'Aaron' => 'aaron.php' , 
                        'Kenny' => 'kenny.php', 
                        'David'=> 'david.php')),

                   'Services' => array ( 'services.php', array (
                        'Get Noticed' => 'getnoticed.php', 
                        'Hosting' => 'hosting.php')),

                   'Clients' => 'clients.php',
                   'Contact Us' => 'contact.php'
    );

    $base = basename($_SERVER['PHP_SELF']);
?> 
```

**FOREACH：（**生成导航）

```
<ul>
<?php

foreach ($nav_array as $k => $v) {
    echo buildLinks ($k, $v, $base);    
}
?>
</ul> 
```

**构建链接：**

```
<?php // Building the links

function buildLinks ($label_name, $file_name, $active_class) {
    if ($label_name == $title) {
        $theLink = "<li><a class=\"selected\" href=\"$file_name\">$label_name</a></li>\n";
    } else {
        $theLink = "<li><a href=\"$file_name\">$label_name</a></li>\n";
    }

    return $theLink;
}

?> 
```

**结果： http:** [//khill.mhostiuckproductions.com/siteLSSBoilerPlate/arraytest.php](http://khill.mhostiuckproductions.com/siteLSSBoilerPlate/arraytest.php)

子菜单将出现在使用 CSS 的父元素悬停上。我需要能够在不修改数组之外的任何内容的情况下通过多个子级别。

如何使我的 foreach 递归地遍历数组的其余部分？

（注意：我必须能够将一类活动应用于当前页面，并将一类箭头应用于具有子菜单的父元素。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:54:03.500

无论您使用什么数据结构来构建导航，都需要使函数递归，这是一种快速而肮脏的方法：

```
echo "<ul>";
foreach ($nav_array as $nav_title => $nav_data) {
  echo buildLinks($nav_title, $nav_data, $base, $title);
}
echo "</ul>";

/* NOTE that we pass $title to the function */
function buildLinks ($label_name, $file_name, $active_class, $title) {

  $theLink = '';
  /* this is dirty code, you should reconsider your data structure */
  $navigation_list = false;
  if (is_array($file_name)) {
    $navigation_list = $file_name[1];
    $file_name = $file_name[0];
  }

  if ($active_class == $title) {
    $theLink = "<li><a class=\"selected\" href=\"$file_name\">$label_name</a></li>\n";
  } else {
    $theLink = "<li><a href=\"$file_name\">$label_name</a></li>\n";
  }

  if ($navigation_list) {
    $theLink .= "<ul>";
    foreach ($navigation_list as $nav_title => $nav_data) {
      $theLink .= buildLinks($nav_title, $nav_data, $active_class, $title);
    }
    $theLink .= "</ul>";
  }

  return $theLink;
} 
```

无论如何，这不是一个干净的解决方案，如果我是你，我会将数据结构更改为更容易处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:00:28.210

我认为这是一个非常糟糕的方式。我建议将您的菜单元素保存为 XML 或 JSON 并使用解析器。它将方便您的工作。

# php - 使用 php 根据 2 个值从 excel 工作表中获取数据

> ID：15012033
> 
> 赞同：1
> 
> 时间：2013-02-21T20:54:56.253
> 
> 标签：php, excel

我有一个看起来像这样的 excel 表：

```
 vr600    vr700    vr800   vr900    -------length
vr600   65           68       70    73
vr700   68           70       72    76
vr800   71           74       76    80
vr900   73           76       80    81
vr1000  76           79       81    84
vr1100  80           82       85    87
vr1200  82           85       87    91
vr1300  83           86       91    97
vr1400  87           90       97    102
vr1500  90           93       102   108
height 
```

现在我有一个带有 2 个组合框的网站，（现在它只是将 2 个值相乘） [http://robabny94.ninetyfour.axc.nl/pechhulp/testprogramma.php](http://robabny94.ninetyfour.axc.nl/pechhulp/testprogramma.php) 当组合框中的长度和高度被填满时，我想返回正确的值。如果我能找出某种公式来获得数字，我会调查它，但它似乎相当随机

只是想不出办法让这个工作。

在此先感谢您的帮助！

编辑：如果将数据放入mysql左右有帮助，那也是可能的

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T06:42:14.750

我对 PHP 一点也不熟悉，但如果您可以通过 Excel 从 Excel 读取/写入 - 以下公式将根据高度和长度输入为您提供所需的结果（假设您的初始输入中的结构）：

`=INDEX($B$2:$F$11,MATCH(H2,$A$2:$A$11,0),MATCH(I2,$B$1:$F$1,0))`

第一个`MATCH`是高度，第二个是长度。

示例图片：

![样本](../Images/66d933069a152be6a8f9698cc4b8c28b.png)

示例文件：[https ://www.dropbox.com/s/ed16km08ikhh68f/LengthHeightMatch.xlsx](https://www.dropbox.com/s/ed16km08ikhh68f/LengthHeightMatch.xlsx)

# css - 并排对齐 div 标签

> ID：15012038
> 
> 赞同：0
> 
> 时间：2013-02-21T20:55:22.537
> 
> 标签：css

所以，这是一个愚蠢的问题，但我一辈子都无法让它发挥作用。

我有一个 div 标签，其中有一个 div 类，里面有一个设定的大小，并希望将它全部保持在一条水平线上。现在，第一张图片出现在内部 div 标签和第二张图片的上方。我试过添加 float: left; 这似乎使整个页面变得混乱。

**CSS**

```
#arrows {
    align: middle;
    width: auto;
    float: inherit;
    display: inline-block;
    height: 500px;
    overflow: hidden;
    white-space: nowrap;
}
.portfolio {
    align: middle;
    width: 750px;
    float: inherit;
    display: inline-block;
} 
```

**html**

```
<div id="arrows">
    <p>
        <img src="../images/left.jpg" width="64" height="105" align="middle" />
        <div class="portfolio">
            <img src="../images/portfolio/borderpatrollogo.jpg" alt="U.S.   Border Patrol Brand Identity" width="564" height="475" align="middle" />
        </div>
        <img src="../images/right.jpg" alt="next" width="64" height="105" align="middle" />
    </p>
</div> 
```

# xcode - xcode 读取/写入 dxf 和 dwg 文件

> ID：15012040
> 
> 赞同：1
> 
> 时间：2013-02-21T20:55:29.833
> 
> 标签：xcode, dwg, dxf

谁能给我一些关于如何读写 DWG/DXF 文件的指导。

我想要实现的是我想使用 Quaztcore 创建一个绘图。（我可以做到）。但我想通过邮件编辑器以可以在 auto cad 中打开的格式发送此绘图。

任何文档、书籍、网站、代码示例或任何建议都非常受欢迎。

简而言之，以编程方式将绘图文件转换为 auto cad 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T01:12:29.940

[这](http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=12272454&linkID=10809853)是官方 AutoCAD DXF 参考的链接。我建议查看 R14 品种，因为它更简单。

# javascript - 用于循环数组参数的Javascript

> ID：15012047
> 
> 赞同：0
> 
> 时间：2013-02-21T20:55:40.223
> 
> 标签：javascript, loops, for-loop

我正在尝试遍历数组参数并返回传递数组的前 n 个元素，而不使用标准的 javascript 函数，例如 slice、concat、push、pop 等。

```
var n = 0;
var anyArray = Array;
var SR = {};
SR.first = function(anyArray,n){
var isArray = (Object.prototype.toString.apply(anyArray) === '[object Array]');
var specification = (typeof n === "number");
if(isArray && specification){
        for(i = 0; i < n; i++){
                return Array(anyArray[i]); 
            }
        }
    else if (isArray || !specification){
        return anyArray[0];
    }
} 
```

我不想使用 += 来构建返回数组“anyArray”。那么，当 "SR.first([1,2,3,4,5,6,7], 4);" 时，我将如何继续让它返回类似 [1,2,3,4] 的东西 叫做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:13:09.880

```
var newArr = Array.apply(null, anyArray); // new Array using original content

newArr.length = n; // truncate the length of the new Array

return newArr;     // return it 
```

一个小的边缘情况将是`anyArray`只有一个成员，这是一个数字。你需要提防这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:12:18.900

首先 - 全局变量这是非常糟糕的做法！您不需要声明 anyArray 和 n，因为它是一个函数参数，并且它在函数调用时声明。第二个问题 - 您可以放置​​大于数组长度的元素数量 - 您必须检查这种情况。

```
var SR = {};
SR.first = function(anyArray,n){
    var isArray = (anyArray instanceof Array),
        specification = (typeof n === 'number'),
        tmp = new Array;
    console.log(isArray, specification);
    if(isArray && specification){
        for(i = 0, l = anyArray.length; i < n && i < l; i++){
            tmp[i] = anyArray[i];
        }
        return tmp;
    } else if (isArray || !specification){
        return anyArray[0];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:09:55.540

我不明白您为什么不想使用and之`Array`类的操作，但这会起作用：`push``slice`

```
if ( isArray && specification ) {
  var result = [];
  for ( var i = 0; i < n; i++ ) {
    result[i] = anyArray[i]; 
  }
  return result;
}
else ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T21:10:01.217

如果由于某种原因你真的不想使用原生 javascript 函数，你可以将每个元素一个一个地分配给你的返回数组。

```
var returnArray = [];

if(isArray && specification) {
    for(i = 0; i < n; i++) {
        returnArray[i] = anyArray[i];
    }
}

return returnArray; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T21:10:27.247

```
SR.first = function(anyArray,n){ 

  var newArray = [];
  for(i = 0; i < n; i++){
      newArray[newArray.length] = anyArray[i]; 
  }
  return newArray;

} 
```

# java - 为什么 rs.next() 不能正常工作？

> ID：15012048
> 
> 赞同：0
> 
> 时间：2013-02-21T20:55:42.817
> 
> 标签：java, mysql, oop

编辑：解决了！多谢你们！:D

即使我使用正确的凭据键入，我仍然会收到错误 showMessageDialog.. 我相信 rs.next() 将返回一个高于 0 的值，然后它必须确认用户的凭据是否与 users_table 中的凭据匹配，但我'总是收到错误消息，就好像凭据不匹配一样。

```
import java.sql.*;
import javax.swing.*;

public class System extends javax.swing.JFrame {

    // variables needed for db connection
    Connection conn;
    Statement stmt;
    ResultSet rs;
    String sql;
    String user;
    char[] pass;
    //for table row count
    int ctr = 0;
    //temporary variables needed in retrieving and inserting records  in our db
    int user_id;
    String username;
    String password;

    public System() {
        initComponents();
        setLocationRelativeTo(null);
        dbConnect();
    }

    public void dbConnect() {
        conn = null;
        String url = "jdbc:mysql://localhost:3306/item_db";
        String driver = "com.mysql.jdbc.Driver";
        String userName = "root";
        String password = "";
        try {
            Class.forName(driver).newInstance();
            conn = DriverManager.getConnection(url, userName, password);

            stmt = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);
            sql = "Select * from users_table";
            rs = stmt.executeQuery(sql);//rs - will hold the records from the databa sql = "Select * from item_table";se

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage());
        }
    }

    private void login() {

        try {
            if (user != null && pass != null) {
                sql = "Select * from users_table Where username='" + user + "' and password='" + pass + "'";
                rs = stmt.executeQuery(sql);

                rs.next();
                if ((user.equals(username)) && (pass.equals(password))) {
                    JOptionPane.showMessageDialog(null, "You are now logon!");
                } 
                else {
                    JOptionPane.showMessageDialog(null, "damn!", "alert", JOptionPane.ERROR_MESSAGE); 
                }
            }
        } catch (SQLException err) {
            JOptionPane.showMessageDialog(this, err.getMessage());
        }

    }

    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jPasswordField1 = new javax.swing.JPasswordField();
        jLabel3 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel1.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        jLabel1.setText("Username:");

        jLabel2.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        jLabel2.setText("Password:");

        jButton1.setText("Login");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Cancel");

        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/login.png"))); // NOI18N

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(46, 46, 46)
                        .addComponent(jLabel3))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(82, 82, 82)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel2)
                                    .addComponent(jLabel1))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(jTextField1)
                                    .addComponent(jPasswordField1, javax.swing.GroupLayout.PREFERRED_SIZE, 134, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(layout.createSequentialGroup()
                                .addGap(51, 51, 51)
                                .addComponent(jButton1)
                                .addGap(28, 28, 28)
                                .addComponent(jButton2)))))
                .addContainerGap(52, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, 100, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(jPasswordField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton1)
                    .addComponent(jButton2))
                .addGap(29, 29, 29))
        );

        pack();
    }// </editor-fold>                        

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        // TODO add your handling code here:

        //str = JOptionPane.showInputDialog(this, "Enter id number: ");
        user = jTextField1.getText();
        pass = jPasswordField1.getPassword();
        login();
    }                                        

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(System.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(System.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(System.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(System.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new System().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify                     
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPasswordField jPasswordField1;
    private javax.swing.JTextField jTextField1;
    // End of variables declaration                   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T20:59:18.617

您没有检查 rs.next() 的返回值

尝试：

```
 if (rs.next()) {
                JOptionPane.showMessageDialog(null, "You are now logon!");
            } else {
                JOptionPane.showMessageDialog(null, "damn!", "alert", JOptionPane.ERROR_MESSAGE); 
            } 
```

请参阅： [http ://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html#next%28%29](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html#next%28%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:36:04.630

您定义但从不将值分配给：

```
String username;
String password; 
```

让这个检查工作。

```
 if ((user.equals(username)) && (pass.equals(password))) { 
```

您应该在设置值之前`username`和`password`

```
 this.username = rs.getString("username");
 this.password = rs.getString("password"); 
```

无论如何，它是不需要的。由于这两个值都在 you`WHERE`子句中，如果您得到任何结果，则意味着您受到了打击，因此您可以`if`将

```
 if (rs.next()) { 
```

注意：您必须删除前一个`rs.next()`（您将只获得一行用于查询）。

也就是说，有几个提示：

1) 不要存储未加密的密码。存储散列版本（MD-5、SHA-1）。如果很重要，请使用盐。这样，可以读取表格的人将无法猜出密码。首先，您可以使用未加密的表进行测试，当它工作时添加加密。

2）正如其他人所说，您最好使用`PreparedStatement`.

3) 除非您经常使用它，否则不要将连接设为实例变量。使其成为使用它的方法的局部变量。而且`close()`它正确。这样你就不会占用你的服务器资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T20:58:11.733

您在真空中调用 rs.next 。您不测试结果或使用结果集数据。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-21T21:00:19.133

我认为你的代码应该是这样的，

```
rs.next();
            if ((user.equals(rs.getString("username"))) && (pass.equals(rs.getString("password")))) {
                JOptionPane.showMessageDialog(null, "You are now logon!");
            } 
```

# c# - 如何获取无扩展名文件类型

> ID：15012049
> 
> 赞同：-4
> 
> 时间：2013-02-21T20:55:46.780
> 
> 标签：c#, asp.net

我想获取文件类型，但我的文件在 C#、Asp.net 中注明扩展名。

我想从下载的文件中获取文件类型`webClient.DownloadFile`。

可以跟踪文件吗？

可以理解下载的文件是pdf还是不是？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T20:59:01.500

没有绝对的方法可以获取没有扩展名的文件的文件类型。

某些文件类型（例如 EXE）具有您可以检查的标题。其他文件（例如文本文件）可能正在使用某种仅查找文本字符的启发式方法进行检测。但仍有其他文件无法识别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:10:11.567

只要您事先知道扩展名是可能的，否则您必须熟悉文件的结构。如果您正在做的只是下载没有 .pdf 扩展名的 pdf，请在下载时重命名您的文件 [something].pdf，这样您就可以将其作为常规 pdf 访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:15:07.407

有一些链接提出了同样的问题。我希望它有帮助

[https://superuser.com/questions/435224/how-do-i-find-out-the-file-type-without-an-extension](https://superuser.com/questions/435224/how-do-i-find-out-the-file-type-without-an-extension)

[http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/16c34850-8799-4a8b-8702-2f59d96e79c1](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/16c34850-8799-4a8b-8702-2f59d96e79c1)

[http://www.troublefixers.com/open-files-without-any-valid-file-extension/](http://www.troublefixers.com/open-files-without-any-valid-file-extension/)

[http://bytes.com/topic/c-sharp/answers/812692-open-file-without-knowing-extension](http://bytes.com/topic/c-sharp/answers/812692-open-file-without-knowing-extension)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T22:01:34.600

```
 FileStream fs = new FileStream(@"c:\a.pdf", FileMode.Open, FileAccess.Read);
    StreamReader r = new StreamReader(fs);
    string pdfText = r.ReadToEnd();
    Regex rx1 = new Regex(@"/Type\s*/Page[^s]");
    MatchCollection matches = rx1.Matches(pdfText);
    MessageBox.Show("The PDF file has " + matches.Count.ToString() + " page(s)."; 
```

# ruby-on-rails - 链接到、视图、控制器

> ID：15012050
> 
> 赞同：0
> 
> 时间：2013-02-21T20:55:48.040
> 
> 标签：ruby-on-rails, view, link-to

我实现了这个链接：

看法：

```
<li><%= link_to "Trainer-Sportler", :controller => "trainerones", :action => "trspmatch" %></li> 
```

控制器：

```
def trspmatch
   render :trspmatch
end 
```

和一个视图 trspmatch.html.erb

导轨 说：

```
Unknown action

The action 'show' could not be found for TraineronesController 
```

当我实现 def show end 并创建一个 show.html.erb 时。Rails 打开的是 show.html.erb 而不是 trspmatch.html.erb？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T22:13:12.763

您可能希望像这样定义您的 trainerones 资源：

```
resources :trainerones do
   collection do
     get 'trspmatch'
   end
end 
```

这将公开一个映射到 TraineronesController#trspmatch 的 url /trainerones/trspmatch。看来查看[此链接](http://edgeguides.rubyonrails.org/routing.html)将帮助您更好地了解路线。

在任何情况下，您都将从在控制台中运行中受益匪浅`rake routes`，它将显示您的所有路由以及它们如何映射到您的控制器方法。按照我上面的解释，在重写你的 trainerones 资源之前和之后尝试，你会看到不同之处。祝你好运！

# python - python从对象列表中获取特定属性

> ID：15012051
> 
> 赞同：0
> 
> 时间：2013-02-21T20:55:51.317
> 
> 标签：python

我有一个 python 对象数组

```
class ball(self, size, color, name):
  self.size = size
  self.color = color
  self.name = name 
```

然后用户将通过命令行输入名称和属性。例如，用户可以输入“name1”，然后输入“color”或“weirdName”，然后输入“size”......然后我想根据名称查找对象并打印获取颜色对象或大小对象。我可以这样做还是需要使用开关盒？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:04:01.777

如果你知道只有一个匹配，你可以这样做：

```
the_ball = next(b for b in list_of_balls if b.name == ???) 
```

如果有多个，那么您可以获得一个列表：

```
the_balls = [b for b in list_of_balls if b.name == ???] 
```

如果您主要是按名称查找球，则应将它们保存在字典而不是列表中

要按名称检索属性，请使用`getattr`

```
getattr(the_ball, "size") 
```

这样做可能是个坏主意

```
getattr(the_ball, user_input) 
```

如果 user_input 是`"__class__"`或其他你没想到的东西怎么办？

如果您只有几种可能性，最好是明确的

```
if user_input == "size":
    val = the_ball.size
elif user_input in ("colour", "color"):
    val = the_ball.color
else:
    #error 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:09:24.887

我认为你在这里尝试做两件不同的事情。

首先，您想按名称获取特定的球。为此，gnibbler 已经给了你答案。

然后，您想按名称获取球的属性之一。为此，请使用[`getattr`](http://docs.python.org/2/library/functions.html#getattr)：

```
the_ball = next(b for b in list_of_balls if b.name == sys.argv[1])
the_value = getattr(the_ball, sys.argv[2])
print('ball {}.{} == {}'.format(sys.argv[1], sys.argv[2], the_value) 
```

另外，你的`class`定义是错误的：

```
class ball(self, size, color, name):
  self.size = size
  self.color = color
  self.name = name 
```

您可能希望这是类中的`__init__`方法`ball`，而不是`class`定义本身：

```
class ball(object):
  def __init__(self, size, color, name):
    self.size = size
    self.color = color
    self.name = name 
```

但是，您可能需要重新考虑您的设计。如果您通过名称动态访问属性比直接访问属性更频繁，通常最好只存储一个`dict`. 例如：

```
class Ball(object):
    def __init__(self, size, color, name):
        self.name = name
        self.ball_props = {'size': size, 'color': color}

list_of_balls = [Ball(10, 'red', 'Fred'), Ball(20, 'blue', 'Frank')]

the_ball = next(b for b in list_of_balls if b.name == sys.argv[1])
the_value = the_ball.ball_props[sys.argv[2]] 
```

或者你甚至可能想继承`dict`or`collections.MutableMapping`或其他什么，所以你可以这样做：

```
the_value = the_ball[sys.argv[2]] 
```

此外，您可能需要考虑使用`dict`按名称键入的球，而不是列表：

```
dict_of_balls = {'Fred': Ball(10, 'red', 'Fred'), …}
# ...

the_ball = dict_of_balls[sys.argv[1]] 
```

如果您已经构建了，则可以很容易地`list`从中构建：`dict`

```
dict_of_balls = {ball.name: ball for ball in list_of_balls} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:17:22.390

如果我理解正确，您需要根据属性值从球列表中获取特定球。一个解决方案是：

```
attribute_value = sys.argv[1]
attribute_name = sys.argv[2]
matching_balls = [ball_item for ball_item in list_balls if \
     getattr(ball_item, attribute_name) == attribute_value] 
```

# iphone - 如何更改 UITableView 拖动控件和行为？

> ID：15012053
> 
> 赞同：0
> 
> 时间：2013-02-21T20:56:14.850
> 
> 标签：iphone, uitableview

我正在尝试使用 UITableView 在编辑模式下提供的拖动功能来重新排列 cell.contentView 中的一些自定义视图。长按单元格后，我成功打开了编辑模式，并在重新排序后关闭了。

这是我如何设置的图片： http: [//cl.ly/image/081k3G0A3f2I](http://cl.ly/image/081k3G0A3f2I)

我遇到的问题是：

1.  无论我将 ShouldIndentWhileEditing 设置为什么，contentView 都会缩进。
2.  我想摆脱删除控件和拖动控件。
3.  整个 contentView 应该是拖动区域，而不仅仅是小拖动控制区域。

对此的帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T00:22:45.050

是的，您可以自定义拖动控件的外观。尝试覆盖`layoutSubviews`. 在该方法中，检查编辑状态并相应地绘制/定位您的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:41:54.227

如果您启用了行重新排序，则无法摆脱拖动控制。API 不允许对行重新排序进行任何自定义。唯一的解决方案是您自己的自定义表格类型视图。

您可以摆脱删除控件。只需`UITableViewCellEditingStyleNone`从`tableView:editingStyleForRowAtIndexPath:`委托方法返回。

# c++ - 使用 OpenMP 创建 FFTW 计划

> ID：15012054
> 
> 赞同：7
> 
> 时间：2013-02-21T20:56:17.217
> 
> 标签：c++, openmp, parallax, fftw

我正在尝试并行执行几个 FFT。我正在使用 FFTW 和 OpenMP。每个 FFT 都不同，所以我不依赖 FFTW 的内置多线程（我知道它使用 OpenMP）。

```
int m;

// assume:
// int numberOfColumns = 100;
// int numberOfRows = 100;

#pragma omp parallel for default(none) private(m) shared(numberOfColumns, numberOfRows)//  num_threads(4)
    for(m = 0; m < 36; m++){

        // create pointers
        double          *inputTest;
        fftw_complex    *outputTest;
        fftw_plan       testPlan;

        // preallocate vectors for FFTW
         outputTest = (fftw_complex*)fftw_malloc(sizeof(fftw_complex)*numberOfRows*numberOfColumns);
         inputTest  = (double *)fftw_malloc(sizeof(double)*numberOfRows*numberOfColumns);

         // confirm that preallocation worked
         if (inputTest == NULL || outputTest == NULL){
             logger_.log_error("\t\t FFTW memory not allocated on m = %i", m);
         }

         // EDIT: insert data into inputTest
         inputTest = someDataSpecificToThisIteration(m); // same size for all m

        // create FFTW plan
        #pragma omp critical (make_plan)
        {
            testPlan = fftw_plan_dft_r2c_2d(numberOfRows, numberOfColumns, inputTest, outputTest, FFTW_ESTIMATE);
        }

         // confirm that plan was created correctly
         if (testPlan == NULL){
             logger_.log_error("\t\t failed to create plan on m = %i", m);
         }

        // execute plan
         fftw_execute(testPlan);

        // clean up
         fftw_free(inputTest);
         fftw_free(outputTest);
         fftw_destroy_plan(testPlan);

    }// end parallelized for loop 
```

这一切都很好。但是，如果我从计划创建（fftw_plan_dft_r2c_2d）周围删除关键构造，我的代码将失败。有人可以解释为什么吗？fftw_plan_dft_r2c_2d 并不是真正的“孤儿”，对吧？是因为两个线程可能都尝试同时访问*numberOfRows*或*numberOfColumns*内存位置吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T22:24:01.203

这几乎都写在 FFTW 文档中关于[线程安全](http://www.fftw.org/doc/Thread-safety.html)的内容：

> ...但是必须小心，因为计划程序例程在呼叫和计划之间共享数据（例如智慧表和三角表）。
> 
> 结果是 FFTW 中唯一的线程安全（可重入）例程是`fftw_execute`（及其新数组变体）。所有其他例程（例如规划器）一次只能从一个线程调用。因此，例如，您可以在对规划器的任何调用周围包裹一个信号量锁；更简单地说，您可以从一个线程创建所有计划。我们认为这不应该是一个重要的限制（FFTW 是为唯一对性能敏感的代码是实际执行转换的情况而设计的），并且计划之间共享数据的好处是巨大的。

在 FFT 的典型应用中，很少构建计划，因此是否必须同步它们的创建并不重要。在您的情况下，您不需要在每次迭代时创建新计划，除非数据的维度发生变化。您宁愿执行以下操作：

```
#pragma omp parallel default(none) private(m) shared(numberOfColumns, numberOfRows)
{
   // create pointers
   double          *inputTest;
   fftw_complex    *outputTest;
   fftw_plan       testPlan;

   // preallocate vectors for FFTW
   outputTest = (fftw_complex*)fftw_malloc(sizeof(fftw_complex)*numberOfRows*numberOfColumns);
   inputTest  = (double *)fftw_malloc(sizeof(double)*numberOfRows*numberOfColumns);

   // confirm that preallocation worked
   if (inputTest == NULL || outputTest == NULL){
      logger_.log_error("\t\t FFTW memory not allocated on m = %i", m);
   }

   // create FFTW plan
   #pragma omp critical (make_plan)
   testPlan = fftw_plan_dft_r2c_2d(numberOfRows, numberOfColumns, inputTest, outputTest, FFTW_ESTIMATE);

   #pragma omp for
   for (m = 0; m < 36; m++) {
      // execute plan
      fftw_execute(testPlan);
   }

   // clean up
   fftw_free(inputTest);
   fftw_free(outputTest);
   fftw_destroy_plan(testPlan);
} 
```

现在计划在每个线程中只创建一次，并且每次执行`fftw_execute()`. 如果在 NUMA 系统上运行（例如，多插槽 AMD64 或 Intel (post-)Nehalem 系统），那么您应该启用线程绑定以获得最大性能。

# php - .htaccess 代替用户名密码保护

> ID：15012057
> 
> 赞同：0
> 
> 时间：2013-02-21T20:56:32.423
> 
> 标签：php, apache, .htaccess, security

我只是在编写一个带有管理面板的小网站。由于我将是唯一一个将访问该面板的人，因此我正在考虑而不是进行传统的用户名-密码匹配，只需将简单的 .htaccess 文件添加到 admin 文件夹

```
 <Limit GET POST>
 order deny,allow
 deny from all
 allow from myip
 allow from 127.0.01
</Limit> 
```

所以问题是因为我的ip是静态的。这种保护将是安全的，还是我必须通过用户名密码匹配来做到这一点？

此外，如果这个想法是合乎逻辑的，但 .htaccess 需要更多的补充，它们会是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:12:38.133

通过 IP 限制是使用密码保护的一种完全有效的替代方法，但访问的灵活性较低。

如果您使用 SSL，那么您可以实现[SSLRequire](http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslrequire)以使事情更加灵活，同时仍然“无密码”（注意线程 MPM 的问题）。

[但是，对于使用HTTP 身份验证](http://httpd.apache.org/docs/2.2/howto/auth.html)实现密码保护所需的少量工作，我认为您应该尽可能安全。即使是个人网站，仍然可以被劫持并用于发送垃圾邮件等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:00:05.767

语法是这样的：

```
<Limit GET POST>
 order deny,allow
 deny from all
 allow from 1.2.3.4
 allow from 127.0.01
</Limit> 
```

它应该是安全的，但请记住，如果来自同一服务器的某个人试图访问您的网页，那么使用 127.0.0.1 IP 它不再保护您的网页。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:00:36.693

订单呢？

```
order deny,allow
deny from all
allow from 127.0.0.1 
```

# java - 在 Java 小程序启动期间，“运行 JVM args 匹配安全子集”是什么意思？

> ID：15012064
> 
> 赞同：2
> 
> 时间：2013-02-21T20:56:54.117
> 
> 标签：java, security, applet, jnlp, args

我正在尝试在 Java 小程序上运行远程调试，但无法让小程序连接到调试器 (Eclipse)，也不会挂起。在启动期间，我得到以下信息：

```
...
    Match: digesting vmargs: -Djava.compiler=NONE -Xdebug -Xrunjdwp:transport=dt_socket,address=8088,server=y,suspend=y
    Match: digested vmargs: [JVMParameters: isSecure: false, args: -Xdebug -Xrunjdwp:transport=dt_socket,address=8088,server=y,suspend=y -Djava.compiler=NONE]
    Match: JVM args after accumulation: [JVMParameters: isSecure: false, args: -Xdebug -Xrunjdwp:transport=dt_socket,address=8088,server=y,suspend=y -Djava.compiler=NONE]
    Match: digest LaunchDesc: null
    Match: digest properties: [-Dsun.java2d.noddraw=true]
    Match: JVM args: [JVMParameters: isSecure: false, args: -Xdebug -Xrunjdwp:transport=dt_socket,address=8088,server=y,suspend=y -Djava.compiler=NONE -Dsun.java2d.noddraw=true]
    Match: endTraversal ..
    Match: JVM args final: -Xmx1g -Xdebug -Xrunjdwp:transport=dt_socket,address=8088,server=y,suspend=y -Xms512m -Djava.compiler=NONE -Dsun.java2d.noddraw=true
    Match: Running JREInfo Version    match: 1.7.0.15 == 1.7.0.15
     Match: Running JVM args match the secure subset: have:<-Xmx1g -Xdebug -Xms512m -Dsun.java2d.noddraw=true>  satisfy want:<-Xmx1g -Xdebug -Xrunjdwp:transport=dt_socket,address=8088,server=y,suspend=y -Xms512m -Djava.compiler=NONE -Dsun.java2d.noddraw=true>
... 
```

我假设最后一行是小程序无法正确调试的原因，但我找不到有关此行含义的文档（或如何使我的 -Xrunjdwp 命令“安全”）。有谁知道在哪里可以找到这方面的文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:17:13.560

负责输出的类的[源代码](http://javasourcecode.org/html/open-source/jdk/jdk-6u23/com/sun/deploy/util/JVMParameters.java.html)中的注释表明**这不是**`-Xrunjdwp`问题：

 **```
// 2\. Trusted command-line arguments. These come from
//    deployment.properties and are specified by the end user via the
//    Java Control Panel. It is important that such command-line
//    arguments do not affect the "secure" state of the target JVM.
//    For example, the user needs to be able to specify -Xdebug
//    -Xrunjdwp[...] via the Java Control Panel to enable debugging
//    of applets on the client machine without affecting the ability
//    of the target JVM to run unsigned applets. We consider trusted
//    command-line arguments in the satisfies() computation. 
```

因此，尽管来源应该是一个很好的“文档”，但从快速浏览来看，我不明白为什么这不起作用。**

# php - 创建一个在 div 的 id 之间搜索的搜索框

> ID：15012071
> 
> 赞同：0
> 
> 时间：2013-02-21T20:57:34.917
> 
> 标签：php, javascript

好吧，我对网络编程有点陌生，我确信我违反了一些规则，但我真的需要帮助。好吧，我的想法是我用我从数据库带来的信息创建了一个滑块，所以我正在使用 php，我正在用 php 中的一段代码填充滑块的所有 li 和 div，并且我将 id 提供给包含所有详细信息的 div 数据库用户的名称，所以我必须有一个搜索字段来查看我拥有的所有 div，并且在搜索之后它仅显示您在搜索字段中查找的用户的名称。所以这是我在页面中的 php 代码，我尝试使用 ajax 但是当信息来自 php 文件时，它不尊重 div 的大小并打印所有信息，我不获取滑块。

```
<div class="slider" id="slider">   

<?php
    $cont = 0;
    $bandera=0;
    $tamano = 0;
    $nombreUsuario = "";
    $arrayIDs = array();
    $i = 0;
    $query_Total = "SELECT u.FOTO_HIJO_USUARIOS, u.ID_USUARIOS, u.NOMBRE_USUARIOS, u.NOMBRE_HIJO_USUARIOS, u.FB_ID_USUARIOS, m.ID_MOMENTOS_MAGICOS, m.TEXTO_MOMENTOS_MAGICOS FROM MOMENTOS_MAGICOS AS m, USUARIOS AS u WHERE u.ID_USUARIOS = m.ID_USUARIOS AND u.ESTADO_USUARIOS =  '1'";
    $todas_Total = mysql_query($query_Total, $MM_db) or die(mysql_error());
    echo "<ul>";
    while(($row = mysql_fetch_array($todas_Total, MYSQL_ASSOC))){
        $nombreUsuario = $row['NOMBRE_USUARIOS'];
        $arrayIDs[$i] = $nombreUsuario;
        $i++;
        $bandera++;
        if($cont++%3==0){
            echo '<li>';
        }

            echo '<div class="participantes" id="'.$nombreUsuario.'" style="float:left; padding-left:10px;width:145px;margin-right:25px;margin-left:15px; margin-top:15px">';
                echo '<div class="face_foto"><img src="https://graph.facebook.com/'.$row['FB_ID_USUARIOS'].'/picture" width="52" height="52" /></div>';
                echo '<h1 align="right">'.$nombreUsuario.'</h1>';
                echo '<img class="bebe_participante" src="uploads/'.$row['FOTO_HIJO_USUARIOS'].'" width="153" height="89" />';
                echo '<h2 align="center">'.$row['NOMBRE_HIJO_USUARIOS'].'</h2>';
                echo '<div id="botMas"> <a href="momMagPag.php?id='.$row['ID_USUARIOS'].'"><img class="img_votos" src="images/bt_ver_mas.png" width="89" height="35"/></a> </div>';
                $query_Votos = "SELECT COUNT( * ) AS VOTOS FROM VOTOS WHERE ID_MOMENTOS_MAGICOS =  '".$row['ID_MOMENTOS_MAGICOS']."'";
                $todos_Votos = mysql_query($query_Votos, $MM_db) or die(mysql_error());
                while(($row = mysql_fetch_array($todos_Votos, MYSQL_ASSOC))){
                     echo '<div class="votos">'.$row['VOTOS'].' VOTOS </div>';
                }                                    
            echo '</div>';
            $tamano++;
    }
    if($cont%3==0 || $cont==$bandera ){
        echo '</li>';
    }                            
    echo "</ul>";
?>
</div> 
```

所以我正在考虑使用 javascript 或 jquery 进行搜索，但经过一些尝试，我无法做到。所以我真的希望你们能帮助我。感谢您的时间 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:15:43.903

为此使用[http://ivaynberg.github.com/select2/ 。](http://ivaynberg.github.com/select2/)

参见：[Many-to-Many Ajax Forms (Symfony2 Forms)](https://stackoverflow.com/questions/11462839/many-to-many-ajax-forms-symfony2-forms/13384784#13384784)的实现（忽略它被标记为 symfony2 的事实，它也与 php 相关）

# c++ - OpenCV Draw绘制2个最大物体的轮廓

> ID：15012073
> 
> 赞同：2
> 
> 时间：2013-02-21T20:57:35.717
> 
> 标签：c++, opencv, image-processing

我正在做一个检测拳击手套的 OpenCV 软件，因此我只想检测并绘制 2 个最大的轮廓（每个拳击手套一个）。

我的软件为所有东西绘制轮廓，有些东西只是我不想要的噪音

我绘制轮廓的代码：

```
 vector<vector<Point> > contours;
    vector<Vec4i> hierarchy;
    findContours(mBlur, contours, hierarchy, CV_RETR_EXTERNAL,  CV_CHAIN_APPROX_SIMPLE, Point(0, 0) );
    //----------------------------------------------------------------------------->

    vector<vector<Point> > contours_poly(contours.size());
    vector<Rect> boundRect (contours.size());
    vector<Point2f> boundingBoxArea(boundRect.size());

    //----------------------------------------------------------------------------->

    for( int i = 0; i < contours.size(); i++ )
     { 
       approxPolyDP( Mat(contours[i]), contours_poly[i], 3, true );
       boundRect[i] = boundingRect( Mat(contours_poly[i]) );

     }

    /// Draw polygonal contour + bonding rects
   Mat drawing = Mat::zeros( range_out.size(), CV_8UC3 );

    for( int i = 0; i< contours.size(); i++ )
        {

           Scalar color = Scalar(0,0,255);
           drawContours( drawing, contours_poly, i, color, 1, 8, vector<Vec4i>(), 0, Point() );
           fillPoly(drawing, contours, Scalar(255,0,0));

       } 
```

这是一个图像示例：

![在此处输入图像描述](../Images/6a6a20a551f8bb0cad1971eb373bb080.png)

我的程序已经按颜色对手套进行了分割，问题是有时由于噪声而在随机位置绘制小轮廓。现在当然手套轮廓占主导地位，这就是为什么我只想保留这些轮廓。希望这能让我的问题更清楚

有人可以建议一个解决方案吗？我在 C++ 环境中编码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-14T11:55:26.063

查看两个最大轮廓的最简单方法是简单地查看轮廓大小。这样的事情应该可以解决问题：

```
int largestIndex = 0;
int largestContour = 0;
int secondLargestIndex = 0;
int secondLargestContour = 0;
for( int i = 0; i< contours.size(); i++ )
{
    if(contours[i].size() > largestContour){
        secondLargestContour = largestContour;
        secondLargestIndex = largestIndex;
        largestContour = contours[i].size();
        largestIndex = i;
    }else if(contours[i].size() > secondLargestContour){
        secondLargestContour = contours[i].size();
        secondLargestIndex = i;
    }
}
Scalar color = Scalar(0,0,255);
drawContours( drawing, contours, largestIndex, color, CV_FILLED, 8);
drawContours( drawing, contours, secondLargestIndex, color, CV_FILLED, 8); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T00:07:15.300

似乎`vector<vector<Point> > contours`存储了你所有的轮廓。您需要做的是迭代此向量并对其元素进行一些算术运算，以便能够检测到向量中的 2 个最大轮廓。

[在这个答案](https://stackoverflow.com/a/13532779/176769)中，我共享了检测 a 中最大轮廓的代码`vector<vector<Point> >`，所以你已经完成了一半。

# android - 在android中拒绝来电

> ID：15012082
> 
> 赞同：15
> 
> 时间：2013-02-21T20:58:06.757
> 
> 标签：android, telephony, callblocking, incoming-call

我想拒绝 android 中的传入，我从这些链接中看到了很多代码。

1.  [Android：完全控制手机（kiosk模式），有可能吗？如何？](https://stackoverflow.com/questions/7121508/android-taking-complete-control-of-phone-is-it-possible-how/7121586#7121586)

2.  [如何在android中以编程方式拒绝呼叫](https://stackoverflow.com/questions/7347871/how-to-reject-a-call-programatically-in-android)

3.  [http://androidsourcecode.blogspot.in/2010/10/blocking-incoming-call-android.html](http://androidsourcecode.blogspot.in/2010/10/blocking-incoming-call-android.html)

4.  [http://androidbridge.blogspot.com/2011/05/how-to-answer-incoming-call-in-android.html?showComment=1361478035090#c5468022990217431781](http://androidbridge.blogspot.com/2011/05/how-to-answer-incoming-call-in-android.html?showComment=1361478035090#c5468022990217431781)

但是我还是做不到，谁能告诉我简单的步骤怎么做？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-22T20:38:24.243

为了拦截您的电话，您只需：
1\. 制作一个名为的包。com.android.internal.telephony；
2\. 在这个包中创建一个名为 ITelephony 的接口文件。
并将此代码写入该接口文件中。

```
boolean endCall();
void answerRingingCall();
void silenceRinger(); 
```

现在在您要拦截调用的类中将该类扩展为`BroadcastReceiver`并在`onReceive()`函数中编写以下代码。

```
TelephonyManager tm = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);
   try {
     Class c = Class.forName(tm.getClass().getName());
     Method m = c.getDeclaredMethod("getITelephony");
     m.setAccessible(true);
     telephonyService = (ITelephony) m.invoke(tm);
     Bundle bundle = intent.getExtras();
     String phoneNumber = bundle.getString("incoming_number");
     Log.d("INCOMING", phoneNumber);
     if ((phoneNumber != null)) { 
        telephonyService.endCall();
        Log.d("HANG UP", phoneNumber);
     }

   } catch (Exception e) {
     e.printStackTrace();
   } 
```

而已。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-12T05:56:03.143

提供适当的权限并添加`ITelephony.java`文件

```
private void declinePhone(Context context) throws Exception {

        try {

            String serviceManagerName = "android.os.ServiceManager";
            String serviceManagerNativeName = "android.os.ServiceManagerNative";
            String telephonyName = "com.android.internal.telephony.ITelephony";
            Class<?> telephonyClass;
            Class<?> telephonyStubClass;
            Class<?> serviceManagerClass;
            Class<?> serviceManagerNativeClass;
            Method telephonyEndCall;
            Object telephonyObject;
            Object serviceManagerObject;
            telephonyClass = Class.forName(telephonyName);
            telephonyStubClass = telephonyClass.getClasses()[0];
            serviceManagerClass = Class.forName(serviceManagerName);
            serviceManagerNativeClass = Class.forName(serviceManagerNativeName);
            Method getService = // getDefaults[29];
            serviceManagerClass.getMethod("getService", String.class);
            Method tempInterfaceMethod = serviceManagerNativeClass.getMethod("asInterface", IBinder.class);
            Binder tmpBinder = new Binder();
            tmpBinder.attachInterface(null, "fake");
            serviceManagerObject = tempInterfaceMethod.invoke(null, tmpBinder);
            IBinder retbinder = (IBinder) getService.invoke(serviceManagerObject, "phone");
            Method serviceMethod = telephonyStubClass.getMethod("asInterface", IBinder.class);
            telephonyObject = serviceMethod.invoke(null, retbinder);
            telephonyEndCall = telephonyClass.getMethod("endCall");
            telephonyEndCall.invoke(telephonyObject);

        } catch (Exception e) {
            e.printStackTrace();
            Log.d("unable", "msg cant dissconect call....");

        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T21:09:40.253

您将需要一个带有意图过滤器的广播接收器，我认为 ACTION_ANSWER

更多细节在这里：http: [//developer.android.com/reference/android/content/Intent.html#ACTION_ANSWER](http://developer.android.com/reference/android/content/Intent.html#ACTION_ANSWER)

您可以使用清单文件或方法 registerReceiver 注册它

更多信息在这里： http: [//developer.android.com/reference/android/content/Context.html#registerReceiver](http://developer.android.com/reference/android/content/Context.html#registerReceiver(android.content.BroadcastReceiver) (android.content.BroadcastReceiver, android.content.IntentFilter)

您还需要在清单文件中指定适当的权限。

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.MODIFY_PHONE_STATE" />
<uses-permission android:name="android.permission.CALL_PHONE" />
<uses-permission android:name="android.permission.PROCESS_INCOMING_CALLS" /> 
```

您提供的链接非常好。你只需要更多的耐心:)

快乐编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-26T14:11:41.483

这是阻止所有来电的最佳教程，您可以对其进行自定义以阻止仅选定号码的来电。

[Android 来电拦截](http://droidcodesnippets.blogspot.com/2012/08/block-all-calls.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-08T06:09:46.050

在其中创建一个接口`com.android.internal.telephony` 并命名为

```
interface ITelephony {
    /**
     * Demonstrates some basic types that you can use as parameters
     * and return values in AIDL.
     */
    void basicTypes(int anInt, long aLong, boolean aBoolean, float aFloat,
            double aDouble, String aString);
    boolean endCall();
    void silenceRinger();strong text
    void answerRingingCall();
}

//   then catch the incoming call intent and call below method

  if (intent.getStringExtra(TelephonyManager.EXTRA_INCOMING_NUMBER) != null) {
                        number = intent.getStringExtra(TelephonyManager.EXTRA_INCOMING_NUMBER);
                        Toast.makeText(context, "INCOMING call catched: ", Toast.LENGTH_SHORT).show();
disconnectPhoneItelephony(mContext)
                    }

    private void disconnectPhoneItelephony(Context context) {
            ITelephony telephonyService;
            TelephonyManager telephony = (TelephonyManager)
                    context.getSystemService(Context.TELEPHONY_SERVICE);
            try {
                Class c = Class.forName(telephony.getClass().getName());
                Method m = c.getDeclaredMethod("getITelephony");
                m.setAccessible(true);
                SessionManager.getInstance(context).setBlockStatusAllow("BLOCKED");
                telephonyService = (ITelephony) m.invoke(telephony);
                telephonyService.silenceRinger();
                telephonyService.endCall();
            } catch (Exception e) {
                e.printStackTrace();
            }
        } 
```

在清单中添加必要的权限

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-16T07:45:00.350

如果您要构建一个自助服务终端应用程序，那么我建议您获取通知设置并将设备设置为“请勿打扰”模式。

```
var mNotificationManager = getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager

mNotificationManager.setInterruptionFilter(NotificationManager.INTERRUPTION_FILTER_NONE) 
```

# exception - maven 存储库：方法中的缺失代码属性

> ID：15012092
> 
> 赞同：2
> 
> 时间：2013-02-21T20:58:32.030
> 
> 标签：exception, maven, repository

我一直在开发一个 spring/hibernate 项目，我正在尝试迁移到 maven。我在运行时遇到了一个令人讨厌的测试问题`build`。

正如您所要求的，我当前的 pom.xml[在 github 上可用](https://github.com/tkoomzaaskz/lyricsBase/blob/da762c90b4b58f1924cd6118642ea24aa778fb2f/pom.xml)，异常跟踪如下所示：

```
java.lang.IllegalStateException: Failed to load ApplicationContext
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:157)
    at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:103)
    at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:73)
    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:313)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:211)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:288)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:284)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:88)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [hibernate.xml]: Invocation of init method failed; nested exception is java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/transaction/SystemException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1486)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:608)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:932)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:106)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:57)
    at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:100)
    at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:248)
    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)
    ... 32 more
Caused by: java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/transaction/SystemException
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:73)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:212)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:266)
    at org.jboss.logging.Logger.getMessageLogger(Logger.java:2248)
    at org.jboss.logging.Logger.getMessageLogger(Logger.java:2214)
    at org.hibernate.cfg.Configuration.<clinit>(Configuration.java:176)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:277)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    ... 47 more 
```

我尝试添加我在 google 上找到的几个依赖项，但它们导致了另一个奇怪的异常。我在[mkyong.com](http://www.mkyong.com/hibernate/java-lang-classformaterror-absent-code-attribute-in-method-that-is-not-native-or-abstract-in-class-file/)上读到这可能是因为 java 文件不包含方法体，但我检查了 javaee-api 包，它实现了 javax.transaction.SystemException 类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T09:19:33.610

原来 javaee-web-api 缺少一些方法体，这就是为什么下面的 pom.xml 依赖：

```
<dependency>
    <artifactId>javaee-web-api</artifactId>
    <groupId>javax</groupId>
    <version>6.0</version>
    <scope>provided</scope>
</dependency> 
```

应替换为：

```
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>2.5</version>
    <scope>provided</scope>
</dependency> 
```

它工作正常。

# c# - 控制台应用程序崩溃 C#

> ID：15012094
> 
> 赞同：-2
> 
> 时间：2013-02-21T20:58:38.710
> 
> 标签：c#, windows, console

所以我正在尝试制作一个计算每年利率的控制台应用程序。但是当我指定存款年份时，它不知何故崩溃了。

源代码如下：

```
using System;
namespace week0502
{
   class Interest
   {
      static void Main(string[] args)
      {
         decimal p = 0; // principle
         decimal r = 1; // interest rate
         decimal t = 2; // time/years entered
         decimal i = 3; // interest
         decimal a = 4; // new amount
         // prompt for values
         Console.Write("Enter original deposit amount: ");
         p = Convert.ToDecimal(Console.ReadLine());
         Console.Write("Enter annual interest rate (10% as 10): ");
         r = Convert.ToDecimal(Console.ReadLine());
         Console.Write("Enter years to save this deposit amount: ");
         t = Convert.ToDecimal(Console.ReadLine());
         Console.WriteLine();
         // display headers
         Console.WriteLine("Year Rate Amount  Interest  New Amount");
         // calculate new amount on deposit after t amount of years
         for (int n = 1; n <= t; n++)
         {
               // calculations
               i = p * r;
               a = i + p;
               // display contents
               Console.WriteLine("{0, 4}{1, 4}{2, 10:C}{3, 5}{4, 10:C}", n, r, p, i, a);
            } // end for
      } // end main
   } // end class
} // end name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:04:37.630

如果您的意思是它在显示结果后关闭，如果您忘记添加，那是正常的`Console.ReadLine()`（等待用户在关闭应用程序之前按 Enter）

```
using System;
namespace week0502
{
   class Interest
   {
      static void Main(string[] args)
      {
         decimal p = 0; // principle
         decimal r = 1; // interest rate
         decimal t = 2; // time/years entered
         decimal i = 3; // interest
         decimal a = 4; // new amount
         // prompt for values
         Console.Write("Enter original deposit amount: ");
         p = Convert.ToDecimal(Console.ReadLine());
         Console.Write("Enter annual interest rate (10% as 10): ");
         r = Convert.ToDecimal(Console.ReadLine());
         Console.Write("Enter years to save this deposit amount: ");
         t = Convert.ToDecimal(Console.ReadLine());
         Console.WriteLine();
         // display headers
         Console.WriteLine("Year Rate Amount  Interest  New Amount");
         // calculate new amount on deposit after t amount of years
         for (int n = 1; n <= t; n++)
         {
               // calculations
               i = p * r;
               a = i + p;
               // display contents
               Console.WriteLine("{0, 4}{1, 4}{2, 10:C}{3, 5}{4, 10:C}", n, r, p, i, a);
            } // end for
         Console.ReadLine(); //Add this to prevent application from closing
      } // end main
   } // end class
} 
```

# postgresql - 基于外键在 PostgreSQL 中增加一个序列

> ID：15012097
> 
> 赞同：6
> 
> 时间：2013-02-21T20:58:53.797
> 
> 标签：postgresql

我想使用序列为我的数据库中的某些对象创建友好的 ID。我的问题是我不希望序列对表来说是全局的，而是我想根据外键增加值。

例如，我的表定义为：

```
CREATE TABLE foo (id numeric PRIMARY KEY, friendly_id SERIAL, bar_id numeric NOT NULL) 
```

我想`friendly_id`分别增加每个`bar_id`这样的语句：

```
INSERT INTO foo (123, DEFAULT, 345)
INSERT INTO foo (124, DEFAULT, 345)
INSERT INTO foo (125, DEFAULT, 346)
INSERT INTO foo (126, DEFAULT, 345) 
```

将导致（期望的行为）：

```
id         | friendly_id      | bar_id
-----------+------------------+-----------------
123        | 1                | 345
124        | 2                | 345
125        | 1                | 346
126        | 3                | 345 
```

而不是（当前行为）：

```
id         | friendly_id      | bar_id
-----------+------------------+-----------------
123        | 1                | 345
124        | 2                | 345
125        | 3                | 346
126        | 4                | 345 
```

这可能使用序列还是有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T00:10:44.940

```
create table foo (
    id serial primary key,
    friendly_id integer not null,
    bar_id integer not null,
    unique(friendly_id, bar_id)
); 
```

在应用程序中，如果引发重复键异常，则将插入包装在异常捕获循环中以重试

```
insert into foo (friendly_id, bar_id)
select
    coalesce(max(friendly_id), 0) + 1,
    346
from foo
where bar_id = 346 
```

# python - 无法安装 CherryPy

> ID：15012098
> 
> 赞同：1
> 
> 时间：2013-02-21T20:58:56.760
> 
> 标签：python, cherrypy

我知道这是一个非常愚蠢的问题，但我无法安装 CherryPy。在文档中写道：

> 要安装，请切换到 setup.py 所在的目录并键入（需要 python-2.3 或更高版本）：
> 
> ```
> python setup.py install 
> ```

这就是我所做的，我在 Python Shell 中输入它，它给了我错误`Invalid syntax`，但我认为我没有任何语法错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:37:34.827

您不会在 Python shell 中安装程序。导航到您下载源代码的位置并运行`python setup.py install`.

或者，您可以使用 pip：

```
pip install cherrypy 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T21:02:13.640

在 Ubuntu 中使用终端的 Cherrypy、Mako、Python 的最佳安装是：

```
sudo apt-get install subversion python-mako python-simplejson python-cherrypy3 graphviz 
```

之后`sudo apt-get update`又之后`sudo apt-get upgrade`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:06:52.727

“我在 Python Shell 中输入这个”...

不要在 Python shell 中键入它。

```
>>> python setup.py install
  File "<stdin>", line 1
    python setup.py install
               ^
SyntaxError: invalid syntax 
```

在命令行中键入它。

```
$ python setup.py install 
```

或者，如果您使用的是 Windows：

```
C:\>python setup.py install 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-17T07:45:57.193

我已经找到了通过命令提示符安装的步骤，请参阅下面的附件。对我来说，“python setup.py install”不起作用，但在我将它正确指向目录后，它可以找到“setup.py install”>

希望我的实验有所帮助： [Step1](https://i.stack.imgur.com/A0LlF.jpg) [Step2](https://i.stack.imgur.com/sFspL.jpg)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-25T17:51:18.660

如果你在 Mac 上安装并说你使用的是 python 3，你会想要使用：

```
sudo python3.3 setup.py build 
```

然后构建完成后。

```
sudo python3.3 setup.py install 
```

# java - 在其中心旋转图像

> ID：15012102
> 
> 赞同：0
> 
> 时间：2013-02-21T20:59:04.157
> 
> 标签：java, android, android-animation

我尝试了[https://stackoverflow.com/a/8996581/1389581](https://stackoverflow.com/a/8996581/1389581)上的方法，但没有一个对我有用。

```
Animation animation = AnimationUtils.loadAnimation(this, R.anim.rotate_arround_center);

        try {
            radarView.startAnimation(animation);
        }
        catch(Exception ex) {
            Log.i(ProcessActivity.str_logCaptionName_ProcessActivity, "radar animation ex : " + ex.getMessage());
        } 
```

-

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:shareInterpolator="false" >

    <rotate
 xmlns:android="http://schemas.android.com/apk/res/android"
  android:fromDegrees="45"
  android:toDegrees="45"
  android:pivotX="50%"
  android:pivotY="50%"
  android:duration="1000"
  android:startOffset="0"/>

</set> 
```

给出空异常。当我使用矩阵方法时，应用程序会出现致命错误并崩溃。

我不想更改位图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:06:20.883

看看这个：[我如何使用 RotateAnimation 来旋转一个圆圈？](https://stackoverflow.com/questions/3045832/how-can-i-use-rotateanimation-to-rotate-a-circle/14297097#14297097)

不确定它是否在寻找什么，但它有效。

# vb.net - 是否有通用的方法来引用当前项目？

> ID：15012105
> 
> 赞同：2
> 
> 时间：2013-02-21T20:59:17.180
> 
> 标签：vb.net

我需要将表格传递给子。如果我的项目名为 Project1 并包含名为 Form1 的表单，我将按如下方式执行此操作：

```
Public Sub ProcessForm(ByRef myForm As Project1.Form1)
etc etc 
```

是否有一种通用的方式来引用当前项目 - Project1 - 以便我可以将代码复制到其他项目，而无需更改对项目的引用？

我正在考虑类似的东西`My.Project`，以便我可以参考`My.Project.Form1`，但看不到如何做到这一点。

我正在使用 VS 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:05:08.260

正如其他人所说，你不能完全按照要求做，所以这个例子的最佳选择是：

```
Public Sub ProcessForm(ByRef myForm As Form1) 
```

让默认命名空间指定`Form1`您的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:16:10.710

你可以这样做

```
Namespace.Class 
```

即，如果您的项目命名空间是 MyProjectName 并且类是 form1。你需要

```
MyProjectName.form1 
```

# java - 为什么 Java 不允许降低父方法的可见性，但允许增加它们？

> ID：15012109
> 
> 赞同：0
> 
> 时间：2013-02-21T20:59:35.077
> 
> 标签：java, inheritance

例子：

```
class Parent {
    public void func(){
        System.err.println("parnet");
    }
}

class Child extends Parent {
    @Override
    protected void func(){
        System.err.println("child");
    }
} 
```

是非法的，但如果我们切换可见性，它是合法的。如此设计的原因是什么？我无法理解它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:04:01.130

这是因为有人可能使用“父”对象来引用“子”对象的实例，而降低可见性会破坏继承“契约”。

想象一下，如果你有一个类 'Cat' 扩展 'Animal'，它有公共方法`breathe()`和`eat()`.

现在，如果您的“Cat”类`breathe()`设为私有，那么拥有引用您的猫的 Animal 的人将无法调用`breathe()`该猫（并且我们不能在 Java 中拥有不快乐的猫！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:03:14.947

如果您获得了父类的实例，您应该能够访问它的所有公共方法。这是合同的一部分。

Child 类与 parent 相比具有“is a”属性，因此它至少可以做 Parent 可以做的事情。

例如：

```
List<Parent> parents=new List<Parent>();
parents.add(new Child());
...
parents.get(0).func(); // you should always be able to call it , since it's a Parent instance . 
```

# iphone - MKStoreKit 恢复非消耗品购买

> ID：15012111
> 
> 赞同：0
> 
> 时间：2013-02-21T20:59:41.880
> 
> 标签：iphone, xcode, mkstorekit

在我的新应用程序中，我使用*MKStoreKit*来删除广告。它的购买方面有效，但就恢复功能而言，什么都行不通！我已经正确实现了所有的框架和*MKStoreKit*文件，但我得到了错误：

```
No visible @interface for 'MKStoreManager' declares the selector 'restorePreviousTransactions' 
```

我在恢复 IBAction 中使用的代码是：

```
[[MKStoreManager sharedManager] restorePreviousTransactions]; 
```

但它只是给了我这个错误！我正在使用通过 Github 提供的最新版本的*MKStoreKit 。*可能有人有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T23:28:42.950

你可以试试这个。

```
 [[MKStoreManager sharedManager] restorePreviousTransactionsOnComplete:^{
        NSLog(@"Restored");

    } onError:^(NSError *error) {
        NSLog(@"Reseting purchases failed because of error: %@", [error description]);

    }]; 
```

# c# - 增加一个无限二进制计数器

> ID：15012113
> 
> 赞同：0
> 
> 时间：2013-02-21T20:59:49.627
> 
> 标签：c#, binary, bit-manipulation

摘自编码面试：

您将如何实现具有`increment`O(1) 时间复杂度的无限二进制计数器？

我想计算最右边的第一个和第二个位置`0`，但我不确定如何实现这个。

“无限计数器”意味着您可以增加无限次（大于 MAX_INT）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T21:02:57.960

**对于二进制计数器...**

如果您想将计数器保持在“正常”位模式，从根本上讲，您不能 - 至少不是*总是*O(1) 而不是*摊销*O(1)。

如果它是一个无限计数器，它可以有任意多的位。这意味着您可以拥有多个 N 位，所有位均为 1。递增该计数器意味着将所有这些位设置为 0，可以合理地假设为 O(N) 操作。

我们可以认为在“正常”计算中增量为 O(1) 的唯一原因是通常处理固定大小的类型，我们可以说（例如）“最多 32 位需要更改 - 这是一个常数，因此可以想象这是一个 O(1) 操作。”

**只是一个柜台...**

另一方面，如果您*只想*能够在 O(1) 时间内递增，那么您拥有无限的内存，并且您不在乎恢复值需要多长时间，您*可以*做到这一点，只需有效地使用一个链表，其长度是计数器大小。

例如，在 C# 中：

```
public DodgySolution
{
    public static DodgySolution Zero = new DodgySolution(null);

    private DodgySolution tail;

    private DodgySolution(DodgySolution tail)
    {
        this.tail = tail;
    }

    // This bit is O(1)
    public DodgySolution Increment()
    {
        return new DodgySolution(this);
    }

    // This bit isn't...
    public BigInteger ToBigInteger()
    {
        return tail == null ? BigInteger.Zero
                            : BigInteger.One + tail.ToBigInteger();
    }
} 
```

即使这样也假设引用分配是 O(1) - 这可能会因为无限数量的对象而变得棘手......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T21:08:05.570

*   使用某种具有加倍策略的阵列存储。这意味着分配是摊销的 O(1)
    链表也应该可以工作。
*   使用微不足道的教科书添加。对于更高的位，进位呈指数级罕见。携带的平均成本是 1+0.5+0.25+... = 2 其中 O(1)

所以一个直接的实现已经摊销了 O(1) 的性能。唯一的问题是您需要可变存储。

在查看 number 的单个增量操作时`n`，平均时间是 O(1)，但最坏的情况是 O(log(n))。内存使用量为 O(log(n))。

```
var counter=new List<bool>{false};

void Inc()
{
  while(counter[i])
  {
      counter[i]=false;
      i++;
  }
  if(i==counter.Length)
    counter.Add(true);
  else
    counter[i]=true;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T21:13:24.277

如果问题*只是*要求增加 O(1) 计数器而没有任何其他限制，则您的计数器可以实现为数字的链接列表，并且项目的总和是您的计数器的值。

如果之前的值大于 (Max-1)，则递增将等同于在最后一项中添加 1 或添加新项 = 1。

由于您总是最多检查列表中的 2 个项目，因此递增将是 O(1)

只是不要尝试用你闪亮的新计数器做其他算术：D

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-21T21:41:39.980

我的尝试：

我们在连续的`1`or上保持聚合`0`。

意思是 111000111 是 <1,0> <3,1> <3,0> <3,1>

我可以用以下 DS 来表示这一点：

节点列表 { digit : bool, counter: long}

1) 如果第一个批量是 1。它变成大量的 0 并将下一个 0 变成 1。

我们现在检查是否可以聚合大量的 1。

2) 如果第一个块是 0，我们将第一个数字设为 1。看看我们是否可以聚合 1。

示例 A：

意思是 111000111 是 <1,0> <3,1> <3,0> <3,1>

读数：`1`三位数，`0`三位数，`1`三位数，一位`0`数

增量（）

<1,0> <3,1> <2,0> <1,1> <3,0>

示例 B：

<1,0> <3,1> <1,0> <3,1>

增量（）

<1,0> <3,1> <1,1> <3,0>

聚合：

<1,0> <4,1> <3,0>

总会有 const 的更改次数（直到最右边的 0 位）

并且转动大部分`1`s 只是切换布尔成员。这是恒定的

# java - 从 DistributedCache 读取 Hadoop 作业的分片输出

> ID：15012116
> 
> 赞同：1
> 
> 时间：2013-02-21T21:00:03.087
> 
> 标签：java, hadoop, distributed-computing, distributed-cache

（标题应该被分**片**以反映 Hadoop将其输出分**片**到多个文件中）

我将多个 Hadoop 作业链接在一起。早期工作之一产生的输出比其他工作小几个数量级，因此我想将其放入 DistributedCache。这是一个困难的部分。这是我为此编写的代码：

```
FileSystem fs = FileSystem.get(conf);
Path pathPattern = new Path(distCache, "part-r-[0-9]*");
FileStatus [] list = fs.globStatus(pathPattern);
for (FileStatus status : list) {
    DistributedCache.addCacheFile(status.getPath().toUri(), conf);
} 
```

这在我的本地机器和我设置的虚拟集群上运行良好。**然而，与[这个问题](https://stackoverflow.com/questions/3210222/distributed-cache)不同的是，它在 AWS 上失败了，理由是 的返回值`DistributedCache.getCacheFiles()`是一个空列表。**

本质上，我需要以编程方式从一个 MR 作业中读取分片输出并将其放入 DistributedCache。我不能指定硬文件名，因为每次运行程序时减速器的数量都会改变。我没有完全掌握 S3 和 HDFS 如何协同工作，因此很难与 FileSystem 交互以读取分片输出。如何以适用于 AWS 的方式执行此操作？

作为参考，我使用的是 Hadoop 1.0.x：1.0.4（四个 Ubuntu 12.10 虚拟机）和 1.0.3 (AWS) 的组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:15:10.030

事实证明，让事情在 AWS 上运行是一个简单的修复：

```
FileSystem fs = distCache.getFileSystem(conf); 
```

然后 AWS 可以看到该目录下的分片，并且执行得很好。当我的问题中的前一个代码在标准集群上运行良好时，我仍然不知道为什么这对于 AWS 工作是必要的，但是你有它。

# java - 在java中计算标准差区间

> ID：15012119
> 
> 赞同：0
> 
> 时间：2013-02-21T21:00:12.597
> 
> 标签：java, statistics

我有一个表示钟形分布的 int 数组，因此如果我要使用索引作为 x 轴和值作为 y 值来绘制数据，我将获得如下图：

```
index   value 
0   46
1   659
2   541
3   519
4   431
5   480
6   441
7   448
8   530
9   557
10  625
11  670
12  818
13  994
14  953
15  1139
16  1221
17  1226
18  1394
19  1772
20  2006
21  2351
22  2590
23  2785
24  3164
25  3639
26  4304
27  4860
28  5539
29  6340
30  7799
31  9364
32  10912
33  13017
34  15571
35  18633
36  22181
37  26567
38  31027
39  36643
40  42486
41  49997
42  57444
43  65501
44  74261
45  83820
46  93841
47  104361
48  114911
49  125867
50  136503
51  148606
52  158489
53  168585
54  177544
55  185554
56  192791
57  200219
58  203626
59  206432
60  208801
61  207941
62  207363
63  205734
64  201727
65  197152
66  190431
67  182139
68  174938
69  165990
70  155895
71  146229
72  136247
73  126603
74  116665
75  106734
76  97147
77  87350
78  78454
79  70097
80  62644
81  55134
82  48509
83  42327
84  36758
85  32089
86  27850
87  23787
88  20226
89  17071
90  14624
91  12542
92  10511
93  8669
94  7150
95  6054
96  5069
97  4178
98  3390
99  2894
100 2291
101 1963
102 1711
103 1394
104 1191
105 969
106 924
107 802
108 711
109 604
110 562
111 608
112 613
113 633
114 639
115 591
116 662
117 594
118 580
119 626
120 610
121 633
122 605
123 617
124 608
125 558
126 564
127 573
128 521
129 474
130 487
131 475
132 477
133 459
134 439
135 428
136 391
137 355
138 345
139 342
140 353
141 347
142 304
143 302
144 291
145 247
146 234
147 217
148 219
149 187
150 178
151 166
152 147
153 115
154 139
155 118
156 125
157 131
158 108
159 103
160 86
161 99
162 85
163 77
164 68
165 66
166 70
167 57
168 35
169 42
170 45
171 41
172 37
173 37
174 32
175 46
176 37
177 34
178 23
179 40
180 27
181 30
182 33
183 39
184 41
185 51
186 50
187 36
188 31
189 32
190 31
191 24
192 33
193 24
194 30
195 34
196 35
197 32
198 39
199 46
200 6821 
```

![在此处输入图像描述](../Images/07cbdcabbd665b5516b0fbe81f020558.png)

在上图中，绿线显示具有最大值的索引，绿色块表示与最大值的标准偏差（SD）（我不确定 SD 是否是正确的名称，我听说有人称它为 sigma 值）。我想编写一个 java 函数，它采用这个 int 数组并在给定所需 SD 和最大值的情况下输出最低和最高边界。到目前为止我所拥有的并不多：

```
public static void getIntervalMinMax(int [] input){
   int max = 0;
   for(int i=0; i<input.length; i++){
      if(input[i]>max){
         max = input[i];
      }
   }

   int deviation = ??;      

   System.out.println("MIN: "+(max-deviation));
   System.out.println("MAX: "+(max+deviation));
} 
```

我已经检查了这篇[文章](https://stackoverflow.com/questions/1735870/simple-statistics-java-packages-for-calculating-mean-standard-deviation-etc)，但我无法在这个库中找到分发 SD 的函数。你能帮我弄清楚如何计算偏差吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:10:12.843

标准偏差由希腊字母 sigma 表示，因此 sigma 值对于同一事物来说是另一个相同的值。标准偏差是方差的平方根（也称为 sigma squared）。方差由分布的平均值定义：

```
variance = sum( data | x ^ 2 ) / n - average( data ) ^ 2 
```

我会像这样创建一个名为 Distribution 的类：

```
public class Distribution {
    private Double[] data;
    private double max = Double.NaN;
    private double min = Double.NaN;
    private double variance = Double.NaN;
    private double average = Double.NaN;        

    public getMax() {
        if( max == Double.NaN ) {
            calculateStats();
        }
        return max;
    }

    // each method getMin, getAverage, getVariance, etc would be written the same way as getMax().

    private void calculateStats() {
        min = Double.MAX_VALUE;
        max = Double.MIN_VALUE;
        average = 0;
        variance = 0;
        for( int i = 0; i < data.length; i++ ) {
            double sample = data[i];
            if( sample > max ) max = sample;
            if( sample < min ) min = sample;
            average += sample;
            variance += sample * sample;
        }

        average = average / data.length;
        variance = variance / data.length - average * average;
    }

    public double getStandardDeviation() {
        if( variance == Double.NaN ) {
            calculateStats();
        }
        return Math.sqrt( variance );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:09:36.780

您可以根据经验样本方差计算平方根的 SD，即：

```
s² = 1/(n-1) * sum_{i=1}^n (y_i - mean(y))^2 
```

编辑：如果你指的是高斯分布，这个密度实际上不是钟形的！

# xpages - 在视图导出中获取摘要计数？

> ID：15012120
> 
> 赞同：0
> 
> 时间：2013-02-21T21:00:18.057
> 
> 标签：xpages

我需要将视图导出到 Excel。我已经在某处找到了一些代码，它在 xpages 中运行良好。现在用户想要添加总计的摘要。我会解释。

我有一个包含用户名、项目 ID 和设备 ID 的文档。我需要做的是导出具有特定项目 ID 的所有文档，在导出中显示用户名和设备 ID，但在导出视图后，显示类似设备 ID 的汇总总计。

像这样的东西：

```
 User              Selected Equipment
       Jonh Smith        C1
       Salley Johnson    C2
       Fred Days         C1

       Summary
       C1   2
       C2   1 
```

我想做的是首先在项目 ID 上使用分类视图，然后在设备 ID 上使用总和列，从 NotesViewEntryCollection 执行 getAllDocumentsByKey 以获取所选项目的所有文档，然后利用类别行获取我需要的总数。但是当我只得到一份 getAllDocumentsByKey 文件时。如果我删除“设备”列并仅按项目 ID 进行分类，那么我将获得所有预期的文档。

我的另一个想法是拥有一个可以存储在 sessionscope 变量中的对象，然后使用 getalldocumentsbykey 再次对项目 ID 进行排序。该对象将有一个设备 ID 变量和一个总数。当我在视图中工作时，我会更新当前设备 ID 的总数。然后在视图的导出结束时导出这个 sessionscope 表。但由于我是 javascript 新手，我真的不知道从哪里开始。这是正确的方向吗？如果是这样，有人可以让我开始吗？

还有其他想法吗？

PS 用户宁愿不必使用 Excel 的小计功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T02:25:34.283

Bruce，让您的生活更轻松，并使用 ViewNavigator。ViewNavigator 具有类别条目，当您设置要汇总的值时，该值位于视图导航器中。它还具有从类别跳转到类别的方法，因此您要读取的数据更少。例如，我使用此函数从分类视图（一个或两个级别）中获取摘要数据：

```
function getCategoryData(viewName, dataColumn, getChildren) {
    var v = database.getView(viewName);
    var nav = v.createViewNav();
    var ve = nav.getFirst();
    var isFirst = true;
    var result = "[";
        while (ve) {
    if (!ve.isTotal()) {
        var curData = ve.getColumnValues();
        if (!isFirst) {
            result += ",";
        }
        result += "{label : \"";
        result += curData[0];
        result += "\", value : ";
        result += curData[dataColumn];
        /* for 2 level categories we fetch additional data */
        if (getChildren) {
            var childve = nav.getChild();
            var firstChild = true;
            result += ", children : [";
            while (childve) {
                var childData = childve.getColumnValues();
                if (!firstChild) {
                    result += ",";
                }
                result += "{label : \"";
                result += childData[1];
                result += "\", value : ";
                result += childData[dataColumn];
                result += "}";          
                firstChild = false;
                childve = nav.getNextSibling(childve);
            }
            result += "]"
        }
        result += "}";          
        isFirst = false;
    }       
    ve = nav.getNextSibling(ve);
}
result += "]";
return result;
 } 
```

注意：它返回一个 JSON 字符串，而不是一个 JSON 对象。我需要字符串，所以你可能想改变它。您可以轻松地修改函数以首先选择基于类别的子集：

```
function getCumulativeCategoryData(viewName, key, dataColumn, fetchChildren) {
var v = database.getView(viewName);

var nav = v.createViewNavFromCategory(key);
var ve = nav.getFirst();
    ...
 } 
```

其中键是字符串或向量。您需要注意数据类型。如果视图中的类别是数字，请确保您使用`Number()`您的密钥，否则它将不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T01:15:47.010

您在最后一段中处于正确的轨道上，但您不需要将值存储在会话范围内。一个标准的 javascript 对象就可以了。假设您通过遍历视图中的文档来生成报告，我认为最快和最简单的解决方案是在您遍历文档并将计数存储在对象中时计算每个设备 ID：

装备Id[equipId1] 装备Id[equipId2] 。. 装备Id[装备Idx]

然后，在您循环浏览所有文档后，循环浏览您的设备 ID 对象值，就像您在上面的示例报告中一样。

循环遍历 javascript 对象： [如何循环遍历或枚举 JavaScript 对象？](https://stackoverflow.com/questions/684672/loop-through-javascript-object)

对 javascript 对象 [进行排序：按属性值对 JavaScript 对象进行排序](https://stackoverflow.com/questions/1069666/sorting-javascript-object-by-property-value)

# c# - 更改日历中选定的日期背景（或文本）

> ID：15012125
> 
> 赞同：2
> 
> 时间：2013-02-21T21:00:29.130
> 
> 标签：c#, .net, wpf, xaml, user-interface

我正在学习 WPF 和 XAML。但我是新手，有一个问题。

我的目的 - 更改日历中选定日期的文本。现在，它有蓝色背景。但我想要两个括号：（...）：

![图片](../Images/df8d665d897f599c61e121964d50f6ab.png)

我看到了这个问题的两种解决方案。

第一的。更改控制模板。我[在 MSDN 网站上找到了完整的模板代码](http://msdn.microsoft.com/en-us/library/ff468218.aspx)。但是代码太多，我找不到任何方法将背景颜色替换为括号，因为我找不到“文本”属性。如果我找到它，我只需将其替换为水平 StackPanel 并在日期前后添加两个带有“（”和“）”的文本框。但我不能。如果可以的话，我真的应该复制所有这些代码吗？

第二。据我所知，日历中的所有日子都是 CalendarDayButton 类型。此类型具有“上下文”属性。也许，如果我改变它，那么文本就会改变。我不知道。但我没有直接访问这种类型。我应该获取日历的所有子项并在其中搜索选定的日期。我想这太复杂了。

如果您知道这个问题的更优雅的解决方案 - 我将非常感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T23:11:59.940

对，所以你用第一个观察回答了你的问题。因此，如果我们查看给出的 MSDN 示例中的代码并专注于您的`CalendarButton` `Style`模板，您可以从上到下分解它是如何工作的。请参阅下面复制示例中的注释。

```
 <!-- **********
            Ok, so we know this is the bugger we want to deal with.
            -->
            <Style TargetType="CalendarButton"
                   x:Key="CalendarButtonStyle">
              <Setter Property="MinWidth"
                      Value="40" />
              <Setter Property="MinHeight"
                      Value="42" />
              <Setter Property="FontSize"
                      Value="10" />
              <Setter Property="HorizontalContentAlignment"
                      Value="Center" />
              <Setter Property="VerticalContentAlignment"
                      Value="Center" />
              <Setter Property="Template">
                <Setter.Value>
                  <ControlTemplate TargetType="CalendarButton">
                    <Grid>
            <!-- *************
            What we want to change is the stuff that happens
        for a State, in this case the Selected State. So we just
        go look at what exactly it is doing for that Selected State.
            -->
                      <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup Name="CommonStates">
                          <VisualStateGroup.Transitions>
                            <VisualTransition GeneratedDuration="0:0:0.1" />
                          </VisualStateGroup.Transitions>
                          <VisualState Name="Normal" />
                          <VisualState Name="MouseOver">
                            <Storyboard>
                              <DoubleAnimation Storyboard.TargetName="Background"
                                               Storyboard.TargetProperty="Opacity"
                                               To=".5"
                                               Duration="0" />
                            </Storyboard>
                          </VisualState>
                          <VisualState Name="Pressed">
                            <Storyboard>
                              <DoubleAnimation Storyboard.TargetName="Background"
                                               Storyboard.TargetProperty="Opacity"
                                               To=".5"
                                               Duration="0" />
                            </Storyboard>
                          </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup Name="SelectionStates">
                          <VisualStateGroup.Transitions>
                            <VisualTransition GeneratedDuration="0" />
                          </VisualStateGroup.Transitions>
                          <VisualState Name="Unselected" />
            <!-- ************
        Hey, look at that. So this guy's telling something called "SelectedBackground" 
        with some opacity to show up and be seen. Now we know we need to go check out 
        this SelectedBackground object he's talking to.
            -->
                          <VisualState Name="Selected">
                            <Storyboard>
                              <DoubleAnimation Storyboard.TargetName="SelectedBackground"
                                               Storyboard.TargetProperty="Opacity"
                                               To=".75"
                                               Duration="0" />
                            </Storyboard>
                          </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup Name="ActiveStates">
                          <VisualStateGroup.Transitions>
                            <VisualTransition GeneratedDuration="0" />
                          </VisualStateGroup.Transitions>
                          <VisualState Name="Active" />
                          <VisualState Name="Inactive">
                            <Storyboard>
                              <ColorAnimation Duration="0"
                                              Storyboard.TargetName="NormalText"
                                              Storyboard.TargetProperty="(TextElement.Foreground).
                                  (SolidColorBrush.Color)"
                                              To="#FF777777" />
                            </Storyboard>
                          </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup Name="CalendarButtonFocusStates">
                          <VisualStateGroup.Transitions>
                            <VisualTransition GeneratedDuration="0" />
                          </VisualStateGroup.Transitions>
                          <VisualState Name="CalendarButtonFocused">
                            <Storyboard>
                              <ObjectAnimationUsingKeyFrames Duration="0"
                                                             Storyboard.TargetName="CalendarButtonFocusVisual"
                                                             Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0">
                                  <DiscreteObjectKeyFrame.Value>
                                    <Visibility>Visible</Visibility>
                                  </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                              </ObjectAnimationUsingKeyFrames>
                            </Storyboard>
                          </VisualState>
                          <VisualState Name="CalendarButtonUnfocused" />
                        </VisualStateGroup>
                      </VisualStateManager.VisualStateGroups>
            <!-- ***************
            Sneaky bugger... looks like there is something called SelectedBackground
 (Rectangle) sitting here with a 0 opacity 
waiting to be told to show himself. 
    Imagine that.
            -->
                      <Rectangle x:Name="SelectedBackground"
                                 RadiusX="1"
                                 RadiusY="1"
                                 Opacity="0">
                        <Rectangle.Fill>
                          <SolidColorBrush Color="{DynamicResource SelectedBackgroundColor}" />
                        </Rectangle.Fill>
                      </Rectangle>
                      <Rectangle x:Name="Background"
                                 RadiusX="1"
                                 RadiusY="1"
                                 Opacity="0">
                        <Rectangle.Fill>
                          <SolidColorBrush Color="{DynamicResource SelectedBackgroundColor}" />
                        </Rectangle.Fill>
                      </Rectangle>
                      <ContentPresenter x:Name="NormalText"
                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                        Margin="1,0,1,1">
                        <TextElement.Foreground>
                          <SolidColorBrush Color="#FF333333" />
                        </TextElement.Foreground>
                      </ContentPresenter>
                      <Rectangle x:Name="CalendarButtonFocusVisual"
                                 Visibility="Collapsed"
                                 IsHitTestVisible="false"
                                 RadiusX="1"
                                 RadiusY="1">
                        <Rectangle.Stroke>
                          <SolidColorBrush Color="{DynamicResource SelectedBackgroundColor}" />
                        </Rectangle.Stroke>
                      </Rectangle>
                    </Grid>
                  </ControlTemplate>
                </Setter.Value>
              </Setter>
              <Setter Property="Background">
                <Setter.Value>
                  <SolidColorBrush Color="{DynamicResource ControlMediumColor}" />
                </Setter.Value>
              </Setter>
            </Style> 
```

所以你找到了最初的罪魁祸首。您可以删除`Rectangle`或只是制作它`Transparent`或其他东西。然后回到你指出的`SelectedState`声明中。`VisualStateManager`编辑：我们将采用不同的方法并显示另一个元素。

```
<VisualState Name="Selected">
   <Storyboard>
      <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SelectedText"
                                     Storyboard.TargetProperty="Visibility">
             <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}"/>
      </ObjectAnimationUsingKeyFrames>
      <ObjectAnimationUsingKeyFrames Storyboard.TargetName="NormalText"
                                     Storyboard.TargetProperty="Visibility">
             <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}"/>
      </ObjectAnimationUsingKeyFrames>
   </Storyboard>
</VisualState> 
```

编辑：

```
<!--
<ContentPresenter x:Name="NormalText"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  Margin="1,0,1,1">
                    <TextElement.Foreground>
                      <SolidColorBrush Color="#FF333333" />
                    </TextElement.Foreground>
                  </ContentPresenter>
-->
<TextBlock x:Name="NormalText"
           Text="{TemplateBinding Content}"
           HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
           VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
           Margin="1,0,1,1"/>
<TextBlock x:Name="SelectedText" Visibility="Collapsed"
           Text="{TemplateBinding Content, StringFormat='(\{\0})'}"
           HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
           VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
           Margin="1,0,1,1"/> 
```

现在，当按钮在其中时，`SelectedState`它应该显示`TextBlock`'( )` 并隐藏没有它的那个。

无论如何，这应该给你一个相当不错的方向，希望它有所帮助。

# vb.net - 在 Visual Studio 中一次只有一个解决方案

> ID：15012129
> 
> 赞同：1
> 
> 时间：2013-02-21T21:00:39.900
> 
> 标签：vb.net, visual-studio-2010

这里有一个简单的问题：当我在 Visual Studio 2010 Ultimate 中打开一个新项目时，它会关闭我当前的项目并打开新项目。一开始我觉得这很奇怪，但我并不介意。现在我正在为我的程序进行测试，这很烦人。在寻找我的问题的答案时，我了解到这不是 IDE 的默认行为，但我不记得为此更改任何设置。

总之，我的解决方案资源管理器中不能有多个解决方案/项目？我在这里做错了什么？

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:02:53.127

Visual Studio 仅支持一次打开一个解决方案。但是，您可以通过以下方式将多个项目添加到单个解决方案中`File > Add > Existing Project...`

# math - 添加浮点数，为什么会是这个结果？

> ID：15012136
> 
> 赞同：0
> 
> 时间：2013-02-21T21:01:02.287
> 
> 标签：math, floating-point

假设我们想要添加 IEEE 754 浮点数：

1.00101 • 2 ²和 -1.00111 • 2 ³

我们首先调整第一个数字以匹配指数：1.00101 • 2 ² = 0.100101 • 2 ³

我们将它们加在一起得到 -101.001，我们可以将其转换为浮点近似值。

有人可以解释我们如何加在一起以获得结果 -101.001，我很难理解这个数字是如何获得的，并且非常感谢这里的一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:11:00.023

切换符号只是为了让它更容易（我们将在最后切换回来），遵循以下逻辑：

```
a + -b = c --> -(a + -b) = -c --> -a + b = -c 
```

然后添加它们：（这确实是减法）

```
 1.001110
- 0.100101
----------
  0.101001 
```

那么你有`-0.101001`• 2 ³ = `-101.001`。

# jquery - jQuery同时向左滚动和淡入

> ID：15012139
> 
> 赞同：2
> 
> 时间：2013-02-21T21:01:13.913
> 
> 标签：jquery, css, jquery-ui

我有以下代码，它可以很好地向左滚动我的 div。但是我需要它们向左滚动并在向左滚动时淡入。

我怎样才能做到这一点？

```
$('div#line1').delay(1000).show("slide", { direction: "right" }, 1500);
$('div#line2').delay(2000).show("slide", { direction: "right" }, 1500);
$('div#line3').delay(3000).show("slide", { direction: "right" }, 1500); 
```

这些的 CSS 设置为 display:none

```
#line1,
#line2,
#line3{
display: none;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:31:50.740

您可以采用这种方法，扩展 Brad M 的答案：

[http://jsfiddle.net/mori57/Gqttc/](http://jsfiddle.net/mori57/Gqttc/)

鉴于此 HTML：

```
<div id="clickme">Click here</div>
<div id="lines">
    <div id="line1">
        <img src="http://placehold.it/350x40" alt="" />
    </div>
    <div id="line2">
        <img src="http://placehold.it/350x40" alt="" />
    </div>
    <div id="line3">
        <img src="http://placehold.it/350x40" alt="" />
    </div>
</div> 
```

这个CSS：

```
#lines div {
    opacity:0;
    margin-left:-400px
} 
```

您可以使用 jQuery 采用这种方法：

```
// get your lines into an array
var lines = $("#lines div");
// set a counter
var currAnim = 0;

// this method will animate a line
var fadeMoveIn = function (line) {
    $(line).animate({
        opacity: 1,
        marginLeft: 10
    }, {
        queue: true,
        duration: 1000,
        complete: function () {
            // when this line's animation is done
            // trigger the next in the queue
            startQueue();
        }
    });
};

// this function will fire off your animations one by one
var startQueue = function () {
    // increment the queue and send that line to be animated
    fadeMoveIn(lines[currAnim++]);
};

$("#clickme").click(function () {
    startQueue();
}); 
```

希望能给你一些关于如何管理它的想法！Brad 的方法是一个好的开始，但它会同时为所有 div 设置动画，这不是我认为您正在寻找的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:04:37.200

尝试使用 .animate() 方法。类似于以下内容

```
$(divs).animate({
     width: 100,
     opacity: 100
}); 
```

确保 div 最初的不透明度为 0%，并且您需要尝试使用正确的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:43:01.903

试试这个：

```
$("#div1").click(function() {
     $('#div1').animate({"left": -200, "opacity": "toggle" }, "slow");
}); 
```

例如，我将它绑定到点击事件，但您可以根据需要获取该功能并使用。此外，如果你给所有的 div 一个公共类，你可以一次移动它们：

```
 $('.moveMe').animate({"left": -200, "opacity": "toggle" }, "slow"); 
```

这是一个 JSFiddle[示例](http://jsfiddle.net/BCeeC/19/)

编辑：您还可以`toggle`根据宽度将 div 向左滑动：

```
$('#div1').animate({"width": toggle, "opacity": "toggle" }, "slow"); 
```

# c++ - 不明白为什么 XCode 链接器看不到某些方法

> ID：15012141
> 
> 赞同：0
> 
> 时间：2013-02-21T21:01:15.733
> 
> 标签：c++, linker-errors

经过多年的努力，我刚刚学会了 C++。现在我正在尝试实现一个简单的矩阵类，以便从其他类中使用。在[GManNickG 的带领](https://stackoverflow.com/a/2076670/182048)下，这是我的`SimpleMatrix`（在“SimpleMatrix.h”中声明）：

```
#pragma once
#include <vector>

template <typename T>
class SimpleMatrix {    
    unsigned int numCols, numRows;    
public:    
    std::vector<T> data;

    SimpleMatrix(unsigned int cols, unsigned int rows) :
    numCols(cols),
    numRows(rows),
    data(numCols * numRows)
    {};

    T getElement(unsigned int column, unsigned int row);
    void setShape(unsigned int column, unsigned int row, const T& initValue);    
}; 
```

并实现为（在“SimpleMatrix.cpp”中）：

```
#include "SimpleMatrix.h"

template <class T>
T SimpleMatrix<T>::getElement(unsigned int column, unsigned int row) {   
    return data[row * numCols - 1];    
}

template <class T>
void SimpleMatrix<T>::setShape(unsigned int columns, unsigned int rows, const T& initValue) {
    numCols = columns;
    numRows = rows;
    data.assign(columns * rows, initValue);
} 
```

现在，当我使用`SimpleMatrix`from时`main`，它可以编译、链接并正常工作。当我尝试从`Container`声明为（在“Container.h”中）的对象中使用它时：

```
#include "SimpleMatrix.h"

class Container {
public:    
    SimpleMatrix<int> matrix;    
    Container();    
    void doStuff();
}; 
```

并实现为（在“Container.cpp”中）：

```
#include "Container.h"
#include "SimpleMatrix.h"

void Container::doStuff() {    
    this->matrix.setShape(2, 2, 0);
    this->matrix.getElement(1, 1);
} 
```

Xcode 抱怨说

> 架构 x86_64 的未定义符号：
> 
> ```
> "SimpleMatrix<int>::getElement(unsigned int, unsigned int)", referenced from:
> Container::doStuff() in Container.o   
> 
> "SimpleMatrix<int>::setShape(unsigned int, unsigned int, int const&)", referenced from:
> Container::doStuff() in Container.o 
> ```
> 
> ld：未找到架构 x86_64 的符号 clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

我检查了“构建阶段/编译源”设置，所有三个文件都在那里（main.cpp、SimpleMatrix.cpp 和 Container.cpp）。

此代码可能存在许多问题。突然想到的是缺少默认构造函数`SimpleMatrix`，但这并不是我真正关心的问题。我只是无法理解这两种情况之间的根本区别是什么。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:03:17.283

模板的实现必须在头文件中。

# mongodb - MongoDb：在不同情况下的范围内搜索值

> ID：15012144
> 
> 赞同：5
> 
> 时间：2013-02-21T21:01:21.980
> 
> 标签：mongodb

第一的。

我们在数据库中有以下记录

```
{ _id:1, values: [ 1 ,5 ,6 ,8]},
{ _id:2, values: [5 ,7 ,8,10 ,40 ,1]},
{ _id:3, values: [50 ,60 ,5 ,1 ]} 
```

我需要查询包含 8 - 10 范围内的“值”的所有记录。结果必须是`{_id:1},{_id:2}`

`query ({values:{'$gte':8,'$lte':10}})`返回所有记录，结果不正确，因为 'values' 是数组！！

第二。

我们在数据库中有以下记录

```
{_id:1, from: 1, to:100},
{_id:2, from: 101, to:200},
{_id:3, from: 201, to:300},
{_id:4, from: 301, to:400} ... 
```

我需要找到元素 205 在 from-to 范围内的记录。结果 {_id:3}

```
query({from:{'$lte':205},to:{'$gte':205}) 
```

非常慢，根本不使用任何索引`{from:1,to:1}`；

我有点困惑。有人可以帮忙吗，拜托。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T23:07:39.420

## 案例 1：对数组值的范围查询

编辑：我使用错误的值进行了测试。

正如[文档所解释](http://docs.mongodb.org/manual/reference/operators/#array)的，对数组值使用条件运算符（AND 隐式运算符）只需要匹配一个条件即可返回文档。

所以，

*   _id:1 匹配 $lte 和 $gte 子句：**OK**
*   _id:2 匹配 $lte 和 $gte 子句：**OK**
*   _id:3 仅匹配 $lte (5 < 10 and 1 < 10) 子句：**不可以**，但按文档说明的方式工作。

如果您需要使用此范围查询对数组值进行过滤，则必须使用对象包装这些值，如下所示：

```
db.test_col2.insert({values:[{v:1} ,{v:5 },{v:6} ,{v:8}]})
db.test_col2.insert({values:[{v:5 },{v:7} ,{v:8},{v:10 },{v:40} ,{v:1}]})
db.test_col2.insert({values: [{v:50} ,{v:60} ,{v:5} ,{v:1} ]})
db.test_col2.find({values: {$elemMatch:{v:{$lte:10, $gte:8}}} })

{"_id":ObjectId("51273098140d09d9105739b5"),"values":[{"v":1},{"v":5},{"v":6},{"v":8}]}
{"_id":ObjectId("51273098140d09d9105739b6"),"values":[{"v":5},{"v":7},{"v":8},{"v":10},{"v":40},{"v":1}]} 
```

如果要为此查询使用索引，可以按如下方式进行：

```
db.test_col2.ensureIndex({"values.v":1})
db.test_col2.find({values: {$elemMatch:{v:{$lte:10, $gte:8}}} }).explain()
{
  "cursor": "BtreeCursor values.v_1",
  "isMultiKey": true,
...
} 
```

## 案例 2：使用开放范围命中索引

如您所见，此查询按预期命中索引。

```
for(var i=0 ; i<120000 ; i++) {
... db.test_col.insert({from: (Math.random()*100)%100, to: (Math.random()*100)%100});
... }
> db.test_col.ensureIndex({from:1, to:1})
> db.test_col.count()
120002
> db.test_col.find({from:{$gte:3}, to:{$lt:60}}).explain()
{
    "cursor" : "BtreeCursor from_1_to_1",
    "isMultiKey" : false,
    "n" : 69741,
    "nscannedObjects" : 69902,
    "nscanned" : 116563,
    "scanAndOrder" : false,
    "indexOnly" : false,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "millis" : 340,
    "indexBounds" : {
        "from" : [
            [
                3,
                1.7976931348623157e+308
            ]
        ],
        "to" : [
            [
                -1.7976931348623157e+308,
                60
            ]
        ]
    },
    "server" : "new-host-2.home:27017"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T07:44:48.213

在案例 1 中：

```
MongoDB shell version: 2.2.0
connecting to: xxx:9900/test
mongos> db.col2.insert({values:[1,2,3]})
mongos> db.col2.insert({values:[0,5,6]})
mongos> db.col2.find({values:{$lte:3, $gte:1}})
{ "_id" : ObjectId("51272120d96837944b3a2097"), "values" : [ 1, 2, 3 ] }
{ "_id" : ObjectId("5127212bd96837944b3a2098"), "values" : [ 0, 5, 6 ] } 
```

对我来说，它是不正确的。0 5 6 不在 1-3 范围内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-08T22:32:04.750

我知道这很晚，但建议不需要更改架构，因为这可能会帮助像我这样后来遇到的人：

**案例 1：对数组值的范围查询**

```
db.getCollection('your collection').find({values :{$elemMatch :{$gte: 8, $lt: 10}}}, {_id:1}) 
```

基本上在这里，我们使用 $elemMatch 将两个条件包装在相同的数组字段**值**上，而 .find 的第二个过滤器/条件是一个投影，它表示输出应该只包含**_id**。

感谢他人的回答/帮助..

# sql - 如果存在不工作

> ID：15012147
> 
> 赞同：2
> 
> 时间：2013-02-21T21:01:31.757
> 
> 标签：sql, sql-server-2005

我正在尝试创建一个可重新运行的脚本

```
IF EXISTS ((SELECT * from information_schema.columns where TABLE_SCHEMA=N'MySchema' and TABLE_NAME=N'Table1' AND COLUMN_NAME=N'Column1'))
BEGIN
   PRINT 'Updating'

   UPDATE [Table2] 
   SET Column = 0
   WHERE Id IN (SELECT t2.Id 
                FROM [Table2] t2 
                JOIN [MySchema].[Table1] t1 ON t2.UserId = t1.UserId 
                WHERE t1.Column1 = 0)

   ALTER TABLE [MySchema].[Table1] DROP COLUMN Column1
END 
```

它第一次工作，但第二次我得到错误

> *列名“Column1”无效。*

任何帮助，将不胜感激。我之前使用`sys.columns`过检查该列是否存在。它适用于 SQL Server 2005。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T22:08:32.673

T-SQL 不是批处理脚本，解析器在执行之前会检查整个语句。因此，如果子选择中的列不存在，则在开始执行之前检查将失败。

要使您的代码正常工作，您需要将 UPDATE 和 ALTER 语句作为字符串传递给`EXECUTE`or `EXEC sp_executesql`。

另见[Q2586737](https://stackoverflow.com/questions/2586737/update-statement-wrapped-in-an-if-exists-block?rq=1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:43:54.563

如果您可以将脚本分成批次，您可以使用该`SET NOEXEC`命令。

当列不存在时将其设置为 ON。将 UPDATE 和 ALTER TABLE 放入单独的批处理中，即用 . 将其与条件分开`GO`。如果您的脚本中还有其他不依赖条件的语句需要执行，请放置另一个`GO`并添加。`SET NOEXEC OFF`

举个例子，这就是我的意思：

```
IF NOT EXISTS (
  SELECT *
  from information_schema.columns
  where TABLE_SCHEMA=N'MySchema'
    and TABLE_NAME=N'Table1'
    AND COLUMN_NAME=N'Column1'
)
  SET NOEXEC ON
GO

PRINT 'Updating'

UPDATE [Table2] 
SET Column = 0
WHERE Id IN (SELECT t2.Id 
             FROM [Table2] t2 
             JOIN [MySchema].[Table1] t1 ON t2.UserId = t1.UserId 
             WHERE t1.Column1 = 0)

ALTER TABLE [MySchema].[Table1] DROP COLUMN Column1
GO
SET NOEXEC OFF
... -- the rest of the script, if any 
```

# asp.net-mvc - 多种环境的 Web.config 转换

> ID：15012157
> 
> 赞同：1
> 
> 时间：2013-02-21T21:02:03.963
> 
> 标签：asp.net-mvc, web-config

我有一个场景，需要根据应用程序当前所在的位置在我的应用程序的 web.config 文件中更改数据库/连接字符串。也就是说，我的 Dev Web 服务器应该连接到我的 Dev 数据库。这同样适用于我的测试和生产环境。通过一些研究，似乎[web.config 转换](http://msdn.microsoft.com/en-us/library/dd465326.aspx)正是我正在寻找的，但有一个潜在的问题。

我工作的公司使用自制方法来部署生产应用程序。它所做的是将文件（用户选择或计算的差异）从测试环境复制到生产环境。使用 web.config 转换仍然有效吗？

如果我要部署到 Test，然后使用我们的工具“部署”到 Prod，web.config 文件的测试版本会被复制过来，对吗？这是假设在构建期间应用了转换。

我想可以将 Prod 版本部署到 Test，然后在 Prod 部署后将其替换为正确的版本，但这似乎很混乱。我对转换的工作方式有误解吗？什么是解决这个奇怪问题的聪明方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:03:49.273

> 使用 web.config 转换仍然有效吗？

不，当您在 Visual Studio 或 MSBuild 中使用发布功能时，会执行转换。在给定环境中部署应用程序的预编译版本后（假设您使用了发布功能），其他转换将丢失并且不会部署到此环境。因此，如果您使用一些自制工具从 TEST 复制到 LIVE，您将无法利用这些转换。为此，您需要使用 LIVE 环境重新发布您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T15:38:57.107

@Jeff - 我一直在处理同样的情况，我们的问题是我们不想每次从一个环境迁移到另一个环境时都重新编译应用程序。这是 Web 转换的一个问题（重新编译代码！）。

我们在 MSI 中打包了基础 web.config 以及转换文件。所以我们打包了 web.config、web.config.DEV、web.config.Prod 等。然后在安装 MSI 之后，我更新了我们古老的部署脚本以调用一个 MSBUILD 脚本，该脚本在 PROD 服务器上进行转换。

我的 powershell 脚本首先会找到所有以当前环境名称（.DEV、.PROD 等）结尾的配置文件。然后它会找到默认文件，如果是 web.config.dev 它将尝试找到 web.config。在此之后，它会将这些参数传递给 MSBUILD 并进行转换。转换后，输出将保存在默认位置，稍后将复制回原始位置。

```
<UsingTask TaskName="TransformXml"
           AssemblyFile="Microsoft.Web.Publishing.Tasks.dll"/>

<PropertyGroup>
    <FilePath></FilePath>
    <ConfigFileName></ConfigFileName>
    <TransformFileName></TransformFileName>
    <OutputFileName></OutputFileName>
    <StackTraceEnabled>False</StackTraceEnabled>
</PropertyGroup>

<Target Name="Transform">

  <Message Text="FilePath = $(FilePath)" />
  <Message Text="ConfigFileName = $(ConfigFileName)" />
  <Message Text="TransformFileName = $(TransformFileName)" />
  <Message Text="OutputFileName = $(OutputFileName)" />

    <TransformXml Source="$(FilePath)$(ConfigFileName)"
                  Transform="$(FilePath)$(TransformFileName)"
                  Destination="$(OutputFileName)"
                  StackTrace="$(StackTraceEnabled)" />
</Target> 
```

# redirect - 2结帐如何使用直接退货

> ID：15012158
> 
> 赞同：1
> 
> 时间：2013-02-21T21:02:10.217
> 
> 标签：redirect, 2checkout

嗨，我在 2checkout 使用模拟账户，我在账户详细信息中添加了批准的 URL。使用 Header Redirect 时，Everythign 工作正常，因为我通过 $_REQUEST[] 接收数据以将这些数据插入数据库，但不知道如何使用直接返回接收数据而不通过 url 传递数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T21:42:48.533

直接退货回传方法通过在我们的服务器获取并显示给买家的同时将退货参数发布到您批准的 URL 来工作。该 URL 将对买家隐藏，似乎仍位于 2Checkout.com 域中。只要每个页面向浏览器输出超过 255 个字符的内容，此方法就可以与重定向一起使用。如果 Direct Return 遇到页面重定向但不输出内容，则流程将失败，买家将被发送到我们的标准订单处理页面。如果您在使用此退货方式时遇到问题，请确保您的页面至少输出 255 个字符，然后再重定向买家。我们也可以帮助您解决遇到的任何问题。只需联系 techsupport@2co.com 并提供您的帐号，我们将很乐意为您提供帮助。

# file - 如何将字符串连接到现有文件？

> ID：15012160
> 
> 赞同：6
> 
> 时间：2013-02-21T21:02:25.887
> 
> 标签：file, append, dart

我有一个文本文件（其中有内容），我想在其中附加文本。这是我的代码：

```
File outputFile=new File('hello.out');
      outputFile.createSync();
      List<String> readLines=files[i].readAsLinesSync(Encoding.UTF_8);
      for(int j=0;j<readLines.length;j++)
      {

        outputFile.writeAsStringSync(readLines[j], FileMode.APPEND); } 
```

出于某种原因，Dart 在“FileMode.APPEND”下放了一条黄线，它说这是一个“额外参数”。但是，此链接[http://api.dartlang.org/docs/releases/latest/dart_io/File.html](http://api.dartlang.org/docs/releases/latest/dart_io/File.html)声称它是可选的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T23:03:23.250

FileMode 是一个可选的命名参数，因此您必须在调用它时指定其名称（'mode'）。要解决您的问题，请更改以下内容：

```
outputFile.writeAsStringSync(readLines[j], FileMode.append); 
```

对此：

```
outputFile.writeAsStringSync(readLines[j], mode: FileMode.append); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T00:24:54.567

这段代码真的是你所需要的：

```
import 'dart:io';

main() {
  new File('test.txt').writeAsStringSync('append some more content', mode: FileMode.APPEND);
} 
```

请注意，文件模式是一个*命名参数*，因此您需要将其指定为`mode:`.

和往常一样，使用异步版本，除非它无关紧要（cli 工具、启动期间的一次性初始化等）

# python - 具有二进制输入的 Hadoop 流作业？

> ID：15012162
> 
> 赞同：1
> 
> 时间：2013-02-21T21:02:29.430
> 
> 标签：python, hadoop, hadoop-streaming

我希望将一种格式的二进制文件转换为 SequenceFile。

我有一个 Python 脚本，它在标准输入上采用这种格式，可以输出我想要的任何内容。

输入格式不是基于行的。各个记录本身是二进制的，因此输出格式不能用 \t 分隔或用 \n 分成几行。

我可以使用 Hadoop Streaming 接口来使用二进制格式吗？如何生成二进制输出格式？

我假设答案是“不”，除非我听到其他情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T00:44:45.377

您可以考虑使用 NullWritable 作为输出，并直接在您的 python 脚本中生成 SequenceFile。您可以在 github 中查找 hadoop-python 项目以查看候选代码：尽管它确实有点大/重，但它确实处理了序列文件的生成。

# function - 如何仅返回特定像素

> ID：15012163
> 
> 赞同：-1
> 
> 时间：2013-02-21T21:02:33.140
> 
> 标签：function, matlab, call

我编写了这个函数，它将具有隶属度=`matlab`的像素的值设置为如下：`x``y``1``1`

```
 function c = core(x, y)
            for i=1:length(y)
            for j=1:length(y)
                if y(i,j) == 1
                x(i,j) = 1;
                end
            end
            end
            c=x
       end 
```

如您所见，整个修改后的图像被返回。但是，我感兴趣的只是那些被修改为`1`. 为了只取回那些像素，我应该对函数进行哪些修改？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:27:26.960

您只需要[find](http://www.mathworks.com/help/matlab/ref/find.html)命令。您可以获得线性索引或 [row,col] 索引。

```
ind = find(y == 1);
[row,col]= find(y == 1); 
```

# android - android布局片段和普通布局

> ID：15012164
> 
> 赞同：1
> 
> 时间：2013-02-21T21:02:36.167
> 
> 标签：android, google-maps, android-linearlayout, fragment

你好，这个想法是编写一个活动，将 google map api v2 显示为片段，并在底部有两个按钮用于处理服务并在地图上生成标记。

现在的问题是是否可以将地图片段放入定义和处理按钮的正常布局中，还是我必须将按钮放在另一个片段中？

目前地图覆盖了整个屏幕，即使我通过 android:height 限制大小

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/DarkGrey">

<fragment 
android:id="@+id/map"
android:layout_width="match_parent"
android:layout_height="410dp"
class="com.google.android.gms.maps.SupportMapFragment" />

        <LinearLayout 
            android:orientation="horizontal"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="bottom">
            <Button 
                android:id="@+id/buttonStopTracking"
                android:text="@string/btn_stop_tracking"
                android:layout_width="160dp"
                android:layout_height="60dp"
                android:textSize="20sp" 
                android:textStyle="bold" 
                />
            <Button
                android:id="@+id/buttonCreatePoI"
                android:text="@string/btn_create_PoI"
                android:layout_width="160dp"
                android:layout_height="60dp"    
                android:textSize="20sp"
                android:textStyle="bold" 
                />
        </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T10:08:41.733

我希望我的布局 xml 会对您有所帮助。

就我而言，所有按钮和文本视图都位于**谷**歌地图上。我正在使用新的 Google Maps API v2，我的 MainActivity 扩展了“android.support.v4.app.FragmentActivity”。

**这是我的完整xml；**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/RelativeLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <fragment 
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

    <LinearLayout
        android:id="@+id/LinearLayout1"
        android:layout_width="match_parent"
        android:layout_height="40sp"
        android:layout_alignParentTop="true" >

    <Button
        android:id="@+id/provider_fine"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/button_inactive"
        android:minWidth="160sp"
        android:onClick="useFineProvider"
        android:text="@string/use_fine_provider" />

    <Button
        android:id="@+id/provider_both"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/button_inactive"
        android:minWidth="160sp"
        android:onClick="useCoarseFineProviders"
        android:text="@string/use_both_providers" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/LinearLayout3"
        android:layout_width="match_parent"
        android:layout_height="40sp"
        android:layout_below="@+id/LinearLayout1" >

    <Button
        android:id="@+id/reset_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/button_inactive"
        android:minWidth="160sp"
        android:onClick="resetButton"
        android:text="@string/reset_button" />

    <Button
        android:id="@+id/calc_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/button_inactive"
        android:minWidth="160sp"
        android:onClick="calcButton"
        android:text="@string/calc_button" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/LinearLayout2"
        android:layout_width="match_parent"
        android:layout_height="95sp"
        android:orientation="vertical"
        android:layout_alignParentBottom="true" >

    <TextView
        android:id="@+id/label_latlng"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/latlng"
        android:textSize="10sp" />

    <TextView
        android:id="@+id/latlng"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="10sp" />

    <TextView
        android:id="@+id/label_address"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/address"
        android:textSize="10sp" />

    <TextView
        android:id="@+id/address"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="10sp" />

    <TextView
        android:id="@+id/secondText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="10sp" />

    <TextView
        android:id="@+id/distanceText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="10sp" />

    </LinearLayout>

</RelativeLayout> 
```

**结果屏幕**如下；由于我的隐私，我删除了图片上的一些文字。

![在此处输入图像描述](../Images/4ac15ddfa2cca4de45eca301eeb2ef47.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:05:49.977

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="@color/DarkGrey">
        <LinearLayout 
            android:orientation="horizontal"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1">

            <fragment 
                android:id="@+id/map"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                class="com.google.android.gms.maps.SupportMapFragment" />
        </LinearLayout>

        <LinearLayout 
            android:orientation="horizontal"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="bottom">
            <Button 
                android:id="@+id/buttonStopTracking"
                android:text="@string/btn_stop_tracking"
                android:layout_width="160dp"
                android:layout_height="60dp"
                android:textSize="20sp" 
                android:textStyle="bold" 
                />
            <Button
                android:id="@+id/buttonCreatePoI"
                android:text="@string/btn_create_PoI"
                android:layout_width="160dp"
                android:layout_height="60dp"    
                android:textSize="20sp"
                android:textStyle="bold" 
                />
        </LinearLayout>
</LinearLayout> 
```

应该做我猜的伎俩。

使用 layout_weight 是诀窍。

第一个布局的方向也是垂直的。

# c# - 参数和资源字典

> ID：15012167
> 
> 赞同：-1
> 
> 时间：2013-02-21T21:02:41.387
> 
> 标签：c#, wpf, xaml, controltemplate

我创建了一个 ResourceDictionary 以便`ControlTemplate`为`Button`.

**这是我的 XAML 代码**

```
<ControlTemplate TargetType="{x:Type Button}" x:Key="BoutonRessources">
<Button Width="32" Margin="0,0,7,0" Name="tbrClear" ToolTip="Clear" VerticalAlignment="Center" BorderThickness="0" HorizontalAlignment="Center" Background="Transparent" HorizontalContentAlignment="Center">
    <Button.Content>
        <Border>
            <Image Source="xRtDiva_XWPF_TBR_PREMIER.PNG_IMAGES.png" Height="18"/>
            <Border.Style>
                <Style TargetType="{x:Type Border}">
                    <Setter Property="Background" Value="Transparent" />
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background">
                                <Setter.Value>
                                    <ImageBrush ImageSource="BoutonToolbarSelected.png"/>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Height"  Value="22"/>
                            <Setter Property="Width"  Value="32"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
        </Border>
    </Button.Content>
    <Button.Style>
        <Style TargetType="{x:Type Button}" >
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}" >
                        <ContentPresenter />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Button.Style>
</Button>
</ControlTemplate> 
```

**当我在我的 XAML 代码上使用 y 模板时：**

```
<Button Template="{StaticResource BoutonRessources}"> 
```

我想给出一个参数，以便为这个模板“BoutonRessources”设置图片。

**我试图像这样修改我的代码：**

```
<Button Template="{StaticResource BoutonRessources}">
   <Button.Content>
       <Border>
           <Image Source="myNewPicture.png" Height="18"/>
       </Border>
   </Button.Content>
</Button> 
```

请问如何个性化我的按钮模板的图片？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:14:50.023

在您的按钮模板中，您已将按钮的内容设置为固定值，因此在按钮本身上分配内容将无济于事。在模板的某处，您需要添加一个`ContentPresenter`. 如果您这样做，`ContentPresenter`将被您分配的按钮内容所取代。

你想达到什么目的？你想让按钮有 2 个图像还是 1 个图像？也许看看这个关于创建模板的教程（或其他许多模板之一），看看它是否有帮助： http: [//mark-dot-net.blogspot.com/2007/07/creating-custom-wpf-button-模板-in.html](http://mark-dot-net.blogspot.com/2007/07/creating-custom-wpf-button-template-in.html)

举个简单的例子，对模板的这个小修改会将您添加到内容中的图像添加到您在模板中手动分配的图像旁边。请注意我是如何添加 StackPanel 并将 a 放置`ContentPresenter`在模板中的。这将替换为您分配给按钮的内容，并将显示在您在模板中设置的“xRtDiva...”图像的右侧：

```
<ControlTemplate TargetType="{x:Type Button}" x:Key="BoutonRessources">
        <Button Width="50" Margin="126.5,126,115.5,126" Name="tbrClear" ToolTip="Clear" VerticalAlignment="Center" BorderThickness="0" HorizontalAlignment="Center" Background="Transparent" HorizontalContentAlignment="Center">
            <StackPanel Orientation="Horizontal">
                <Border>
                    <Image Source="xRtDiva_XWPF_TBR_PREMIER.PNG_IMAGES.png" Height="18"/>
                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="Background" Value="Transparent" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background">
                                        <Setter.Value>
                                            <ImageBrush ImageSource="BoutonToolbarSelected.png"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Height"  Value="22"/>
                                    <Setter Property="Width"  Value="32"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                </Border>
                <Border>
                    <ContentPresenter/>
                </Border>
            </StackPanel>

            <Button.Style>
                <Style TargetType="{x:Type Button}" >
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Button}" >
                                <ContentPresenter />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Button.Style>

        </Button>
    </ControlTemplate> 
```

但是，我对`Button.Style`您在按钮内分配的内容感到非常困惑。这样做的目的是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:57:59.917

为什么你不能只做以下事情？

```
<Button>
    <Image Source="firstImage.png" />
</Button>

<Button>
    <Image Source="secondImage.png" />
</Button>

<Button>
    <Image Source="thirdImage.png" />
</Button> 
```

在这种情况下，如果您想更改按钮模板，只需将 ContentPresenter 元素放在您希望图像所在的位置。

# jasper-reports - 缺少有关生成的 jasperreports-highcharts 的 HTML5 的文档

> ID：15012170
> 
> 赞同：3
> 
> 时间：2013-02-21T21:02:53.930
> 
> 标签：jasper-reports, highcharts

我们的应用程序中嵌入了“jasperreports-pro-5.0”和“jasperreports-highcharts-5.0”。当我们使用 JR API 生成 HTML5 格式的 Highchart 报告时，浏览器无法显示报告。

快速调查发现 HTML5 缺少对依赖 javascripts 的引用。

我们使用 iReport 生成报告，HTML5 包含 3 个 javascript 源：jquery-ui、default.service、highcharts。

有没有人遇到过类似的问题 - highchart html 缺少 javascript 引用？我们缺少 JR 的设置吗？

所以我现在的问题是这在哪里记录？有没有人看到关于设置哪些属性才能使用 Highcharts 的描述？

[编辑]

我正在改变问题，因为我找到了上述问题的解决方案。解决方案如下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-05T03:32:08.153

解决方法是添加相关的 JasperReport 属性，后缀为“$url”，例如：

```
com.jaspersoft.jasperreports.highcharts.jquery.ui.js$url=/script/highcharts/jquery-ui.custom.min.js
com.jaspersoft.jasperreports.highcharts.highcharts.js$url=/script/highcharts/highcharts.original.src.js 
```

我通过反编译和调试 highcharts 的 PropertiesResourceLocationResolver 发现了这一点。

# javascript - 在 JavaScript 中初始化全局变量

> ID：15012171
> 
> 赞同：3
> 
> 时间：2013-02-21T21:02:55.350
> 
> 标签：javascript, null, global-variables, undefined

如果我的`.js`文件顶部有以下行，当我调用一个使用`clickButton`它的函数时怎么会说它是`null`？

**在 HTML 中**

```
<input type="text" onkeydown="toggle()" id="txt1" />
<input name="aButton" id="aButton" type="button" value="ButtonVal" /> 
```

**在 JS**

```
//global variables
var clickButton = document.getElementById("aButton")
var state = false

function toggle()
{
  if(!state)
      /*here it says clickButton is null but if I put var clickButton = 
      document.getElementById("aButton") in this scope it works*/
      clickButton.disabled = true
  else
    clickButton.disabled = false
} 
```

null 和 undefined 之间有什么*区别*（不是我如何检查）？是否已声明 null 但未分配值，而 undefined 甚至尚未声明？

我的意思是[这个问题](https://stackoverflow.com/questions/461966/why-is-there-a-null-value-in-javascript)说“程序员没有分配任何东西的属性将是未定义的，但是为了使属性变为空，必须显式地将空分配给它。” 但我可以向你保证，我从来没有明确地将 null 分配给任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:05:50.867

这意味着`document.getElementById("aButton")`返回 null。具有指定 id 的元素在 dom 中不可用，或者您的 dom 尚未准备好 - 请参阅[https://developer.mozilla.org/en-US/docs/DOM/document.getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)。

对于 null 与未定义 - 请参阅[mouseover 和 mouseenter 事件之间的区别是什么？](https://stackoverflow.com/q/1104344/1048572)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:17:49.103

### 第一个问题

*   确保您的 html 文件中有这样的标记：

    ```
     <input name="aButton" id="aButton" type="button" value="ButtonVal" /> 
    ```

*   确保在 DOM 准备好后调用该函数。因此，将 js 的链接放在 html 页面的底部。或者在这个里面：

    ```
     if (document.readyState === "complete") { //codehere } 
    ```

### 第二个问题

在 JavaScript中，`undefined`变量是从未声明过或从未赋值过的变量。`var a`例如，假设您声明a will be `undefined`，因为它从未被分配任何值。

但是，如果您随后分配`a = null`then`a`现在将为空。在 JavaScript 中 null 是一个对象（`typeof null`如果您不相信我，请在 JavaScript 控制台中尝试），这意味着它`null`是一个值（实际上甚至`undefined`是一个值）。

您可以使用这些运算符来检查未定义的空值。例如：

```
null === null            # => true
undefined === undefined  # => true
undefined === null       # => false
undefined == null        # => true 
```

更多的？[JavaScript 中的 null 和 undefined 有什么区别？](https://stackoverflow.com/questions/5076944/what-is-the-difference-between-null-and-undefined-in-javascript)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-21T21:12:49.853

undefined 和 null 确实是两种不同的类型。null 是一个对象，它指的是一个已声明但提供了 null 值的变量，而在未声明的变量中未定义，并且它本身不是一个对象。

我的猜测是您还没有等待 DOM 准备好，因此您的 clickButton 变量正试图过早地抓取一个元素并为空。尝试将它包装在 document.ready 或 window.onload 中，以便它在 DOM 完成加载时执行:-)。

```
window.onload(function() {
    var clickButton = document.getElementById("aButton");
}); 
```

# tortoisesvn - SVN从trunk到branch切换过程中的混乱

> ID：15012182
> 
> 赞同：0
> 
> 时间：2013-02-21T21:03:21.650
> 
> 标签：tortoisesvn

我在从主干切换到分支时感到困惑。这是我的观点 - 1-假设我在主干中进行了一些更改并从主干提交了代码。我的一位同事的工作副本是主干，他切换到分支。他会在他的分支中获得我提交的代码吗？2-假设我的工作副本是主干，我对代码进行了一些更改但没有提交。之后我切换到分支我未提交的代码会发生什么，它会反映在我的分支副本中。请分别说明每种情况`enter code here`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:21:38.873

当您在 SVN 中创建一个分支时，该代码将与主干（以及您可能拥有的任何其他分支）分开。这意味着如果您对主干代码进行更改并提交它，它只会影响主干，如果您在分支中进行更改并提交它，它只会影响分支。

如果其他人正在使用主干，那么当您提交主干并且他们更新时，他们会看到您的更改。如果他们正在使用分支，并且您提交到主干，他们将不会在更新时获得您的更改。

# r - R plot - 具有颜色渐变的正态曲线

> ID：15012188
> 
> 赞同：9
> 
> 时间：2013-02-21T21:03:42.203
> 
> 标签：r

如何在 R 中制作具有颜色渐变的曲线。看看这个![在此处输入图像描述](../Images/8a3990eef06d2f27a9452bf9c0dc17c3.png)火焰。

它应该是这样的。我试着画一条法线，然后再画一条法线，但从技术上讲，你不能用一堆法线画出这样的图形，因为它们不会下降并在两边的正确位置相交。我怎样才能在R中制作这样的数字？有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-21T21:47:57.183

The best I've been able to do so far is:

```
 par(bg="black")
 plot(seq(0.15,0.85,by=0.01), 
      5*dbeta(seq(0.15,0.85,by=0.01),10,10 ), 
      type="l" , ylim=c(0,700) )  # this just sets up the plotting framework.

 for( i in 1:200 ) { lines(x= seq(0.15,0.85,by=0.01), 
                           y= i*dbeta(seq(0.15,0.85,by=0.01),10,10 ), 
                     col= colorRampPalette(c("yellow", "orange", "red", "hotpink", 
                             "violet", "blue", "lightblue", "lightgreen", "darkgreen",
                             "black"))(200)[i], 
                      lwd=13) }
 par(bg="white") 
```

I did discover that putting a "black" color at the beginning of that series add an extra "glow" to the overall result, but I'm not posting that result.

![enter image description here](../Images/e28ef9a34d3631d2fc190cdb295f1621.png)

# -----------------

This is what I started with and then there are successive approximation and tweaks appearing below:

```
plot(seq(0.15,0.85,by=0.01), 5*dbeta(seq(0.15,0.85,by=0.01),10,10 ), 
            type="l" , ylim=c(0,100))
for( i in seq(0.2, 5) ) { lines(seq(0.15,0.85,by=0.01), 
                     i*5*dbeta(seq(0.15,0.85,by=0.01),10,10 ) ) } 
```

![enter image description here](../Images/07c1d4768a6e46e0032d5b2b8b1bfc18.png)

For colors:

```
plot(seq(0.15,0.85,by=0.01), 5*dbeta(seq(0.15,0.85,by=0.01),10,10 ), type="l" ,
          ylim=c(0,130))
for( i in 1:35 ) {lines(seq(0.15,0.85,by=0.01), i*dbeta(seq(0.15,0.85,by=0.01), 10,10 ), 
                           col=colorRampPalette(c("yellow", "orange", "red", "violet", 
                                        "blue", "lightblue", "lightgreen"))(35)[i],
                   lwd=3) } 
```

![enter image description here](../Images/612a3781930789f205aa27593e53f09c.png)

For black background and denser colors and a fade to black at top:

```
 par(bg = 'black')
 plot(seq(0.15,0.85,by=0.01), 5*dbeta(seq(0.15,0.85,by=0.01),10,10 ), type="l", 
          ylim=c(0,130) )
 for( i in 1:35 ) { lines(seq(0.15,0.85,by=0.01), i*dbeta(seq(0.15,0.85,by=0.01),10,10), 
                          col=colorRampPalette(c("yellow", "orange", "red", "violet", 
                                "blue", "lightblue", "lightgreen", "darkgreen", 
                                 "black")) (35)[i], 
                           lwd=13) } 
```

![enter image description here](../Images/0784d4e30bebd6575a69f3196fbfc59c.png)

I noticed that the fading to black aspect also controlled the line width at the sides. I hadn't been expecting that but it seems to be a desirable feature. The other aspect not addressed here is the possibility of adding transparency. There is an alpha argument in the R RGB functions.

One useful trick for finding colors byname:

```
grep("purple", colors(), value=TRUE)
 [1] "mediumpurple"  "mediumpurple1" "mediumpurple2" "mediumpurple3" "mediumpurple4"
 [6] "purple"        "purple1"       "purple2"       "purple3"       "purple4" 
```

If you are playing with the iteration to make the gradient smoother then you will need also adjust the ylim argument: choose 0.5^9*0.5^9/beta(10,10)*[iterations] , since that will be the maximum at x=0.5.

# android - 完成活动的 MediaPlayer 异常

> ID：15012200
> 
> 赞同：5
> 
> 时间：2013-02-21T21:04:22.803
> 
> 标签：android, exception, media-player

当我尝试完成媒体播放器活动时（仅在我播放时），我遇到了异常。编码：

完成按钮：

```
ImageView imageAllBack = (ImageView)this.findViewById(R.id.imageAllBack);
        imageAllBack.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {                   

                //mediaPlayer.stop();
                if(mediaPlayer != null)
                {
                    mediaPlayer.stop();
                    mediaPlayer.release();
                }

                 finish();

            }
          }); 
```

媒体播放器事件：

```
@Override
  protected void onStop() {
    super.onStop();     
    mediaPlayer.stop();
    mediaPlayer.release();
  }

  @Override
  public boolean onTouchEvent(MotionEvent event) {
    mediaController.show();
    return false;
  }

  //--MediaPlayerControl methods----------------------------------------------------
  public void start() {

    mediaPlayer.start();
  }

  public void pause() {
    mediaPlayer.pause();
  }

  public int getDuration() {
    return mediaPlayer.getDuration();
  }

  public int getCurrentPosition() {

          return mediaPlayer.getCurrentPosition();

  }

  public void seekTo(int i) {
    mediaPlayer.seekTo(i);
  }

  public boolean isPlaying() {
    return mediaPlayer.isPlaying();
  }

  public int getBufferPercentage() {
    return 0;
  }

  public boolean canPause() {
    return true;
  }

  public boolean canSeekBackward() {
    return true;
  }

  public boolean canSeekForward() {
    return true;
  }
  //--------------------------------------------------------------------------------

  public void onPrepared(MediaPlayer mediaPlayer) {
    mediaController.setMediaPlayer(this);
    mediaController.setAnchorView(findViewById(R.id.main_audio_view));

    handler.post(new Runnable() {
      public void run() {
        mediaController.setEnabled(true);
        mediaController.show();
      }
    });
  }

  public class MyMediaController extends MediaController {

      public MyMediaController(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
    }

    @Override
          public void hide() {
              // Do Nothing to keep the show the controller all times

          }

      } 
```

例外：

```
02-21 21:03:33.829: E/AndroidRuntime(8889): FATAL EXCEPTION: main
02-21 21:03:33.829: E/AndroidRuntime(8889): java.lang.IllegalStateException
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.media.MediaPlayer.isPlaying(Native Method)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at rce.android.naturalocal.NaturaPlayer.isPlaying(NaturaPlayer.java:126)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at rce.android.naturalocal.NaturaPlayer.getCurrentPosition(NaturaPlayer.java:115)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.widget.MediaController.setProgress(MediaController.java:436)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.widget.MediaController.access$500(MediaController.java:74)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.widget.MediaController$3.handleMessage(MediaController.java:407)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.os.Looper.loop(Looper.java:137)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at android.app.ActivityThread.main(ActivityThread.java:4441)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at java.lang.reflect.Method.invokeNative(Native Method)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at java.lang.reflect.Method.invoke(Method.java:511)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-21 21:03:33.829: E/AndroidRuntime(8889):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:12:11.460

在调用 stop 之前，您必须检查 mediaPlayer 是否实际正在运行，否则您将得到**IllegalStateException**。此外，在对已发布的 MediaPlayer 对象执行任何操作时，您也会得到它。你的代码应该是：

```
onClick(View view) {
  if(mediaPlayer != null) {
    if mediaPlayer.isPlaying()) {
            mediaPlayer.stop();
        }
        mediaPlayer.release();
        mediaPlayer = null;
    }
}   

protected void onStop() {
    super.onStop();
    if(mediaPlayer != null) {
        if (mediaPlayer.isPlaying()) {
            mediaPlayer.stop();
        }
        mediaPlayer.release();
        mediaPlayer = null;
    }
} 
```

另请查看 MediaPlayer 文档：[Doc](http://developer.android.com/reference/android/media/MediaPlayer.html)

# mule - 对 Web 服务查询的文件处理响应异常

> ID：15012202
> 
> 赞同：0
> 
> 时间：2013-02-21T21:04:24.443
> 
> 标签：mule, mule-studio

我正在使用下面指定的 mule 流来发出 Web 服务的简单请求。请求成功发出，使用wireshark我看到了正确的响应。

在我包含一个输出文件端点（为了捕获对文件的响应）之前，我没有看到任何异常。即使有这个例外（包括在底部），当我查看生成的输出文件时，我也会看到我的数据，尽管在许多情况下它只是数据的一部分。

是什么导致了这个异常？

这是流程：

```
<flow name="TestAuditorClient_CheckerFlow1" doc:name="TestAuditorClient_CheckerFlow1">
    <quartz:inbound-endpoint jobName="gen" repeatInterval="10000" responseTimeout="10000" 
        doc:name="Quartz"> <quartz:event-generator-job /> </quartz:inbound-endpoint>
    <component class="wsdl.Payload" doc:name="Java"/>
    <cxf:jaxws-client operation="listTest"
        clientClass="server.TestService_Service" port="TestServicePort"
        wsdlLocation="http://192.168.66.7:8080/TestAuditorWebApp/TestService?wsdl"
        enableMuleSoapHeaders="true" doc:name="SOAPY" />
    <outbound-endpoint
        address="http://192.168.66.7:8080/TestAuditorWebApp/TestService"
        doc:name="HTTP"  mimeType="text/xml" />
    <logger message="Received HTTP Response #[payload]" level="INFO"
        doc:name="Logger" />
    <file:outbound-endpoint path="C:\tmp" outputPattern="#[function:datestamp:dd-MM-yy]_#[function:systime].txt" 
        responseTimeout="10000" doc:name="Output File" /> 
</flow> 
```

这是一个例外：

```
INFO  2013-02-21 15:38:09,753 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02]    org.mule.api.processor.LoggerMessageProcessor: soap payload:      org.mule.module.cxf.transport.MuleUniversalConduit$1@69d7ef58
INFO  2013-02-21 15:38:09,769 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.transport.service.DefaultTransportServiceDescriptor: Loading default outbound transformer: org.mule.transport.http.transformers.ObjectToHttpClientMethodRequest
INFO  2013-02-21 15:38:09,769 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.transport.service.DefaultTransportServiceDescriptor: Loading default response transformer: org.mule.transport.http.transformers.MuleMessageToHttpResponse
INFO  2013-02-21 15:38:09,769 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.transport.service.DefaultTransportServiceDescriptor: Loading default outbound transformer: org.mule.transport.http.transformers.ObjectToHttpClientMethodRequest
INFO  2013-02-21 15:38:09,769 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.lifecycle.AbstractLifecycleManager: Initialising: 'HTTP_HTTPS.dispatcher.479670620'. Object is: HttpClientMessageDispatcher
INFO  2013-02-21 15:38:09,784 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.lifecycle.AbstractLifecycleManager: Starting: 'HTTP_HTTPS.dispatcher.479670620'. Object is: HttpClientMessageDispatcher
INFO  2013-02-21 15:38:09,878 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.api.processor.LoggerMessageProcessor: Received HTTP Response org.mule.transport.http.ReleasingInputStream@5e8aa5e1
INFO  2013-02-21 15:38:09,878 [[test_auditor_client4].connector.file.mule.default.dispatcher.01] org.mule.lifecycle.AbstractLifecycleManager: Initialising: 'connector.file.mule.default.dispatcher.784931034'. Object is: FileMessageDispatcher
INFO  2013-02-21 15:38:09,878 [[test_auditor_client4].connector.file.mule.default.dispatcher.01] org.mule.lifecycle.AbstractLifecycleManager: Starting: 'connector.file.mule.default.dispatcher.784931034'. Object is: FileMessageDispatcher
INFO  2013-02-21 15:38:09,894 [[test_auditor_client4].connector.file.mule.default.dispatcher.01] org.mule.transport.file.FileConnector: Writing file to: C:\tmp\21-02-13_1361479089894.txt
WARN  2013-02-21 15:38:09,894 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.apache.cxf.phase.PhaseInterceptorChain: Interceptor for {http://server/}TestService#{http://server/}listTest has thrown exception, unwinding now
java.lang.RuntimeException: Couldn't parse stream.
    at org.apache.cxf.staxutils.StaxUtils.createXMLStreamReader(StaxUtils.java:1181)
    at org.apache.cxf.interceptor.StaxInInterceptor.handleMessage(StaxInInterceptor.java:104)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)
    at org.apache.cxf.endpoint.ClientImpl.onMessage(ClientImpl.java:799)
    at org.mule.module.cxf.transport.MuleUniversalConduit.dispatchMuleMessage(MuleUniversalConduit.java:280)
    at org.mule.module.cxf.transport.MuleUniversalConduit$2.handleMessage(MuleUniversalConduit.java:194)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)
    at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:533)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:463)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:366)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:319)
    at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:88)
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:134)
    at $Proxy33.listTest(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.mule.module.cxf.CxfOutboundMessageProcessor.doSendWithProxy(CxfOutboundMessageProcessor.java:187)
    at org.mule.module.cxf.CxfOutboundMessageProcessor.process(CxfOutboundMessageProcessor.java:129)
    at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)
    at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:43)
    at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:43)
    at org.mule.processor.chain.DefaultMessageProcessorChain.doProcess(DefaultMessageProcessorChain.java:93)
    at org.mule.processor.chain.AbstractMessageProcessorChain.process(AbstractMessageProcessorChain.java:66)
    at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)
    at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:43)
    at org.mule.processor.AbstractInterceptingMessageProcessorBase.processNext(AbstractInterceptingMessageProcessorBase.java:105)
    at org.mule.interceptor.AbstractEnvelopeInterceptor.process(AbstractEnvelopeInterceptor.java:55)
    at org.mule.processor.AsyncInterceptingMessageProcessor.processNextTimed(AsyncInterceptingMessageProcessor.java:118)
    at org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker$1.process(AsyncInterceptingMessageProcessor.java:186)
    at org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker$1.process(AsyncInterceptingMessageProcessor.java:179)
    at org.mule.execution.ExecuteCallbackInterceptor.execute(ExecuteCallbackInterceptor.java:20)
    at org.mule.execution.HandleExceptionInterceptor.execute(HandleExceptionInterceptor.java:34)
    at org.mule.execution.HandleExceptionInterceptor.execute(HandleExceptionInterceptor.java:18)
    at org.mule.execution.BeginAndResolveTransactionInterceptor.execute(BeginAndResolveTransactionInterceptor.java:58)
    at org.mule.execution.ResolvePreviousTransactionInterceptor.execute(ResolvePreviousTransactionInterceptor.java:48)
    at org.mule.execution.SuspendXaTransactionInterceptor.execute(SuspendXaTransactionInterceptor.java:54)
    at org.mule.execution.ValidateTransactionalStateInterceptor.execute(ValidateTransactionalStateInterceptor.java:44)
    at org.mule.execution.IsolateCurrentTransactionInterceptor.execute(IsolateCurrentTransactionInterceptor.java:44)
    at org.mule.execution.ExternalTransactionInterceptor.execute(ExternalTransactionInterceptor.java:52)
    at org.mule.execution.RethrowExceptionInterceptor.execute(RethrowExceptionInterceptor.java:32)
    at org.mule.execution.RethrowExceptionInterceptor.execute(RethrowExceptionInterceptor.java:17)
    at org.mule.execution.TransactionalErrorHandlingExecutionTemplate.execute(TransactionalErrorHandlingExecutionTemplate.java:113)
    at org.mule.execution.TransactionalErrorHandlingExecutionTemplate.execute(TransactionalErrorHandlingExecutionTemplate.java:34)
    at org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker.doRun(AsyncInterceptingMessageProcessor.java:178)
    at org.mule.work.AbstractMuleEventWork.run(AbstractMuleEventWork.java:43)
    at org.mule.work.WorkerContext.run(WorkerContext.java:311)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: com.ctc.wstx.exc.WstxIOException: Attempted read on closed stream.
    at com.ctc.wstx.stax.WstxInputFactory.doCreateSR(WstxInputFactory.java:536)
    at com.ctc.wstx.stax.WstxInputFactory.createSR(WstxInputFactory.java:585)
    at com.ctc.wstx.stax.WstxInputFactory.createSR(WstxInputFactory.java:610)
    at com.ctc.wstx.stax.WstxInputFactory.createXMLStreamReader(WstxInputFactory.java:316)
    at org.apache.cxf.staxutils.StaxUtils.createXMLStreamReader(StaxUtils.java:1179)
    ... 50 more
Caused by: java.io.IOException: Attempted read on closed stream.
    at org.apache.commons.httpclient.AutoCloseInputStream.isReadAllowed(AutoCloseInputStream.java:183)
    at org.apache.commons.httpclient.AutoCloseInputStream.read(AutoCloseInputStream.java:107)
    at org.mule.model.streaming.DelegatingInputStream.read(DelegatingInputStream.java:63)
    at java.io.FilterInputStream.read(Unknown Source)
    at java.io.PushbackInputStream.read(Unknown Source)
    at com.ctc.wstx.io.BaseReader.readBytes(BaseReader.java:155)
    at com.ctc.wstx.io.UTF8Reader.loadMore(UTF8Reader.java:368)
    at com.ctc.wstx.io.UTF8Reader.read(UTF8Reader.java:111)
    at com.ctc.wstx.io.ReaderBootstrapper.initialLoad(ReaderBootstrapper.java:250)
    at com.ctc.wstx.io.ReaderBootstrapper.bootstrapInput(ReaderBootstrapper.java:133)
    at com.ctc.wstx.stax.WstxInputFactory.doCreateSR(WstxInputFactory.java:531)
    ... 54 more
ERROR 2013-02-21 15:38:09,972 [[test_auditor_client4].TestAuditorClient_CheckerFlow1.stage1.02] org.mule.exception.DefaultMessagingExceptionStrategy: 
********************************************************************************
Message               : Attempted read on closed stream.. Failed to route event via endpoint: org.mule.module.cxf.CxfOutboundMessageProcessor. Message payload is of type: PostMethod
Code                  : MULE_ERROR--2
--------------------------------------------------------------------------------
Exception stack is:
1\. Attempted read on closed stream. (java.io.IOException)
  org.apache.commons.httpclient.AutoCloseInputStream:183 (null)
2\. Attempted read on closed stream. (com.ctc.wstx.exc.WstxIOException)
  com.ctc.wstx.stax.WstxInputFactory:536 (null)
3\. Couldn't parse stream. (java.lang.RuntimeException)
  org.apache.cxf.staxutils.StaxUtils:1181 (null)
4\. Couldn't parse stream. (javax.xml.ws.soap.SOAPFaultException)
  org.apache.cxf.jaxws.JaxWsClientProxy:156 (http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/xml/ws/soap/SOAPFaultException.html)
5\. Attempted read on closed stream.. Failed to route event via endpoint: org.mule.module.cxf.CxfOutboundMessageProcessor. Message payload is of type: PostMethod (org.mule.api.transport.DispatchException)
  org.mule.module.cxf.CxfOutboundMessageProcessor:148 (http://www.mulesoft.org/docs/site/current3/apidocs/org/mule/api/transport/DispatchException.html)
--------------------------------------------------------------------------------
Root Exception stack trace:
java.io.IOException: Attempted read on closed stream.
    at org.apache.commons.httpclient.AutoCloseInputStream.isReadAllowed(AutoCloseInputStream.java:183)
    at org.apache.commons.httpclient.AutoCloseInputStream.read(AutoCloseInputStream.java:107)
    at org.mule.model.streaming.DelegatingInputStream.read(DelegatingInputStream.java:63)
    + 3 more (set debug level logging or '-Dmule.verbose.exceptions=true' for everything)
******************************************************************************** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:55:03.127

发生的情况是，HTTP 出站交互的结果首先由出站端点之后的内容处理，然后再传递回 CXF 客户端。此时，流式有效载荷已被消耗，CXF 无法再处理它了。

您可以尝试以下方法：

```
<flow name="TestAuditorClient_CheckerFlow1" doc:name="TestAuditorClient_CheckerFlow1">
    <quartz:inbound-endpoint jobName="gen" repeatInterval="10000" responseTimeout="10000" 
        doc:name="Quartz"> <quartz:event-generator-job /> </quartz:inbound-endpoint>
    <component class="wsdl.Payload" doc:name="Java"/>
    <http:outbound-endpoint
        address="http://192.168.66.7:8080/TestAuditorWebApp/TestService"
        doc:name="HTTP"  mimeType="text/xml">
        <cxf:jaxws-client operation="listTest"
            clientClass="server.TestService_Service" port="TestServicePort"
            wsdlLocation="http://192.168.66.7:8080/TestAuditorWebApp/TestService?wsdl"
            enableMuleSoapHeaders="true" doc:name="SOAPY" />
    </http:outbound-endpoint>
    <logger message="Received HTTP Response #[payload]" level="INFO"
        doc:name="Logger" />
    <file:outbound-endpoint path="C:\tmp"
        outputPattern="#[function:datestamp:dd-MM-yy]_#[function:systime].txt" 
        responseTimeout="10000" doc:name="Output File" /> 
</flow> 
```

这个想法是将 CXF 交互本地化到 HTTP 端点。

请注意，我已将通用出站端点更改为 HTTP 端点，这不是强制性的，但至少您将获得对可用属性的更好支持。

另请注意，CXF 交互后流中的消息负载将是响应对象，而不是 SOAP 消息。您必须决定序列化策略（如 JAXB）以将其保存在文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:10:47.687

既然大卫已经花时间引导我朝着正确的方向前进，我将发布答案以供将来尝试此操作的人受益：

工作流程是：

```
<flow name="TestAuditorClient_CheckerFlow1" doc:name="TestAuditorClient_CheckerFlow1">
    <quartz:inbound-endpoint jobName="gen"
        repeatInterval="10000" responseTimeout="10000" doc:name="Quartz">
        <quartz:event-generator-job />
    </quartz:inbound-endpoint>
    <component class="wsdl.Payload" doc:name="Java" />
    <http:outbound-endpoint
        address="http://192.168.66.7:8080/TestAuditorWebApp/TestService"
        doc:name="HTTP" mimeType="text/xml">
        <cxf:jaxws-client operation="listTest"
            clientClass="server.TestService_Service" port="TestServicePort"
            wsdlLocation="http://192.168.66.7:8080/TestAuditorWebApp/TestService?wsdl"
            enableMuleSoapHeaders="true" doc:name="SOAPY" />
    </http:outbound-endpoint>
    <logger message="Received HTTP Response #[payload]" level="INFO"
        doc:name="Logger" />
    <component class="wsdl.Payload" doc:name="Java"/>
    <file:outbound-endpoint path="C:\tmp"
        outputPattern="#[function:datestamp:dd-MM-yy]_#[function:systime].txt"
        responseTimeout="10000" doc:name="Output File" />
</flow> 
```

请注意，我在 HTTP 请求之前和请求之后都使用了 wsdl.Payload 类。这个单一的类用于生成请求和处理响应。

这是那个类：

```
package wsdl;

import server.ListTest;
import server.ListTestResponse;

public class Payload {

    public ListTest request() {
    System.out.println("request response");
    return new ListTest();
}

public String response(ListTestResponse listTestResponse) {
    System.out.println("process response");
    StringBuilder sb = new StringBuilder();

    List<Test> testList = listTestResponse.getReturn();
    Iterator<Test> testIt = testList.iterator();
    while(testIt.hasNext()) {
        Test test = testIt.next();
        sb.append(test.getName()).append(" ").append(test.getDescription()).append(", ");
    }
    return sb.toString();
}
} 
```

瞧，现在骡子流程完全按照我的预期工作。

# jquery - 一种将 facebook“提要”弹出在 jquery 对话框中的方法？

> ID：15012203
> 
> 赞同：0
> 
> 时间：2013-02-21T21:04:31.277
> 
> 标签：jquery, facebook

有没有办法将 facebook 提要弹出（发布到你的墙上）放在 jquery 对话框中？这是我拥有的代码，它将使对话框和提要以不同的弹出窗口出现：

```
<script>
$(function() {
  $( "#dialog-modal" ).dialog({autoOpen: false, resizable: false, draggable: false, height: 250, width: 500, modal: true, dialogCLass: 'main-dialog-class'});

  $( "#opener" ).click(function() {
                       $( "#dialog-modal" ).dialog( "open" );

                       $.getJSON(
                                 "/like_artist.php", // The server URL
                                 { artist_id : $(this).data('artist_id') }, // Data you want to pass to the server.
                                 function(json) {

                                    var text = '';
                                    text = 'You want ' +  json[1] + ' to play a show in your town!  Increase the chances that ' + json[1] + ' comes through your area on tour by alerting your friends!';
                                    $('#dialog-modal').text(text);

                                       FB.ui({
                                       method: 'feed'
                                       });

                                    alert(json[1]);
                                 }// The function to call on completion.
                                 );

        });

  });
</script> 
```

建议赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:16:50.257

如果您在 jQuery 对话框的 iframe 中打开它，您可以通过在“假弹出窗口”中按 URL 调用它来使用[Feed 对话框。](https://developers.facebook.com/docs/reference/dialogs/feed/)

（在你的网站上给它一个 URL `return_uri`，它将在 iframe 的父窗口中执行一段 JavaScript 代码，这将再次关闭对话框或其他东西。）

虽然，这仅在用户已经登录到 Facebook 时才有效（您可能希望事先使用[FB.getLoginStatus](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)来确定）——因为如果没有，Facebook 将重定向到 Auth 对话框，并且无法显示在任何一种框架，它必须在顶层窗口中打开。

# javascript - 移动 Safari 上的流星模板不会显示我的返回

> ID：15012207
> 
> 赞同：0
> 
> 时间：2013-02-21T21:04:37.570
> 
> 标签：javascript, mobile-safari, meteor

我试图在移动 Safari 的屏幕上显示我从模板函数返回的结果。我可以看到我的设备支持 devicemotion 我可以看到我的 vartiltFB 的控制台日志和数据

我看不到或无法工作的是它在我的移动 safari 上的 html 屏幕上显示。

```
Template.tapapp.showAngle = function() {

var tiltFB;

if (window.DeviceMotionEvent) {
  window.addEventListener('devicemotion', deviceMotionHandler, false);
  console.log("Devicemotion IS supported on your device.");
} else {

  console.log("Devicemotion Not supported on your device.");
  return "Devicemotion Not supported on your device.";
}

function deviceMotionHandler(eventData) {

  var acceleration = eventData.accelerationIncludingGravity;
  var rawAcceleration = "[" +  Math.round(acceleration.x) + ", " +     Math.round(acceleration.y) + ", " + Math.round(acceleration.z) + "]";

  var facingUp = -1;
  if (acceleration.z > 0) {
    facingUp = +1;
  }

  tiltFB = Math.round(((acceleration.y + 9.81) / 9.81) * 90 * facingUp);

  console.log(tiltFB);

  //Meteor.defer(function () {
  //     $('#angel').html(tiltFB);
  //     return tiltFB;
  });
  return tiltFB;
}

}; 
```

这是我的html：

```
<template name="tapapp">
  <div class="container">
  <h3 class="angel-class" id="angle">{{showAngle}}</h3>
</template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:02:59.957

`showAngle`试试这个，你需要在你的助手中返回一个值，并通过 Session.set/get 反应性地连接它

客户端js

```
function deviceMotionHandler(eventData) {

  var acceleration = eventData.accelerationIncludingGravity;
  var rawAcceleration = "[" +  Math.round(acceleration.x) + ", " +     Math.round(acceleration.y) + ", " + Math.round(acceleration.z) + "]";

  var facingUp = -1;
  if (acceleration.z > 0) {
    facingUp = +1;
  }

  tiltFB = Math.round(((acceleration.y + 9.81) / 9.81) * 90 * facingUp);

  console.log(tiltFB);

  //Meteor.defer(function () {
  //     $('#angel').html(tiltFB);
  //     return tiltFB;
  //});
  Session.set("tiltFB", tiltFB);
}

Template.tapapp.showAngle = function() {
    return Session.get("tiltFB");
}

Meteor.startup(function() {
    if (window.DeviceMotionEvent) {
        window.addEventListener('devicemotion', deviceMotionHandler, false);
        console.log("Devicemotion IS supported on your device.");
    } else {
        console.log("Devicemotion Not supported on your device.");
    }
}); 
```

# c# - 在 asp.net 中显示 nhiberbate 组件

> ID：15012209
> 
> 赞同：0
> 
> 时间：2013-02-21T21:04:40.650
> 
> 标签：c#, asp.net, fluent-nhibernate, fluent-nhibernate-mapping

我正在开发一个 ASP.NET/C#/fluent nHibernate 项目，最近发现了`Component`我想要实现的映射功能。我相信我的类定义和映射文件是正确的，但是我很难使用我的服务和/或存储库层检索组件信息以将其显示在 a`DetailsView`或`FormView`.

当我使用 an`ObjectDataSource`来检索信息时，在相应视图中生成的 aspx 代码将整个组件放在 a 中`TextBox`：

```
<asp:TextBox ID="extraTextBox" runat="server" Text='<%# Bind("extra") %>' /> 
```

我在网上找到了大量关于如何进行映射本身的资源，但无法找到更多关于正确显示组件的指导。任何指导将不胜感激！

```
// Stripped down classes
public partial class ProjectExtra
{
    private int _test1;
    private int _test2;

    public ProjectExtra() {}

    public virtual int test1 { get { return this._test1; } set { this._test1 = value; } }
    public virtual int test2 { get { return this._test2; } set { this._test2 = value; } }
}

public partial class Project
{
    private int _pkProjectID;
    private ProjectExtra _extra;

    public Project() {}

    public virtual ProjectExtra extra
    {
        get
        {
            return this._extra;
        }
        set
        {
            this._extra = value;
        }
    }
    public virtual int pkProjectID
    {
        get
        {
            return this._pkProjectID;
        }
        set
        {
            this._pkProjectID = value;
        }
    }
}

// stripped down mapping
public class ProjectMap : ClassMap<Project>
{
    public ProjectMap()
    {
        Table(@"Project");
        LazyLoad();
        Id(x => x.pkProjectID)
          .Column("pkProjectID")
          .Access.Property()
          .Not.Nullable()
          .GeneratedBy.Identity();

        Component<ProjectExtra>(x => x.extra, m =>
        {
            // JobsCreatedActual and JobsCreatedEstimate are two integer columns
            // in the Project database table
            m.Map(x => x.test1).Column("JobsCreatedActual");
            m.Map(x => x.test2).Column("JobsCreatedEstimate");
            Not.LazyLoad();
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T22:05:43.460

为此，我最终使用了以下格式：

```
<asp:TextBox ID="extraTextBox" runat="server" 
Text='<%# Eval("extra.test1") %>' /> 
```

我已经看到使用完整 DataBinder 的其他资源，但结果似乎相同：

```
<asp:TextBox ID="extraTextBox" runat="server" 
Text='<%# DataBinder.Eval(Container.DataItem, "test1"))%>' /> 
```

不幸的是，`Bind`它不适用于子类，因此它们仍然需要使用 TextBox 值等在代码隐藏中构建。

# c# - 错误已经使用相同的参数类型定义了一个名为“Index”的成员

> ID：15012213
> 
> 赞同：0
> 
> 时间：2013-02-21T21:04:58.787
> 
> 标签：c#, asp.net-mvc-3

在我的控制器中，我有以下两种方法；

```
[ActionName("index")]
public ActionResult Index()
{
    return View();
}

and

 public ActionResult Index()
 {
    var m =MyMod();

    return View(m);

 } 
```

即使我使用过，但`[ActionName("index")]`我得到一个错误说`Error 1 Type 'MyProject.Controllers.MyController' already defines a member called 'Index' with the same parameter types`

我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:06:17.727

不，这是不可能的，你不能在同一个控制器上使用相同的 HTTP 动词有 2 个同名的动作。同样从 C# 的角度来看，您不能在同一个类上有两个具有相同名称和相同参数的方法。编译器不会让你这样做。

您可以使用不同的 HTTP 动词来访问这 2 个操作之一。当您有 2 个具有相同名称的操作时，这通常是惯例。第一个用于渲染视图，第二个用`[HttpPost]`属性修饰并用于处理来自视图的表单提交。post 操作还将视图模型作为包含表单提交字段的参数。所以这两种方法有不同的签名，它会让编译器高兴。这是推荐的方法：

```
public ActionResult Index()
{     
    MyViewModel model = ...
    return View(model);
}

[HttpPost]
public ActionResult Index(MyViewModel model)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:07:17.853

从编译器的角度来看，这两种方法是相同的。它们具有相同的名称、返回类型和参数（在这种情况下没有）。这就是您收到错误的原因。

您的意思是为带参数的索引创建重载吗？

# php - mkdir() 说没有这样的目录并且失败了？

> ID：15012214
> 
> 赞同：50
> 
> 时间：2013-02-21T21:05:00.683
> 
> 标签：php, upload, mkdir

我可能会做一些非常简单的错误，但是当我尝试创建一个目录（使用刚刚作为最后一个文件夹名称执行的插入变量）时，我得到了错误：

> 警告：mkdir() [function.mkdir]：/home/blah/blah 中没有这样的文件或目录

使用代码：

```
if (!is_dir("images/listing-images/rent/'.$insertID.")) {
        //make new directory with unique id
   mkdir("images/listing-images/rent/'.$insertID."); 
} 
```

当然该目录不存在..我现在正在尝试制作它？使困惑！

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-02-21T21:08:10.323

发生这种情况是因为您的文件系统中没有`images/listing-images/rent`路径。

如果您想创建整个路径 - 只需将第三个参数作为`true`：

```
mkdir('images/listing-images/rent/'.$insertID, 0777, true); 
```

您当前也有可能位于错误的目录中。如果是这种情况 - 您需要更改当前目录`chdir()`或指定完整路径。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-21T21:09:36.057

假设您使用 PHP > 5.0.0，请尝试`mkdir("path", 0777, true);`启用递归创建目录（请参见此处： http: [//php.net/manual/en/function.mkdir.php](http://php.net/manual/en/function.mkdir.php)）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-21T21:06:03.077

您的字符串中有错误：

```
mkdir("images/listing-images/rent/'.$insertID."); 
```

应该：

```
mkdir("images/listing-images/rent/$insertID"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-15T04:49:10.723

*   recursive 允许创建在路径名中指定的嵌套目录。
*   但对我不起作用！！因为这就是我想出的！
*   它工作得非常完美！！

> $upPath = "../uploads/RS/2014/BOI/002"; // 完整路径
> $tags = explode('/' ,$upPath); // 分解完整路径
> $mkDir = "";
> 
> ```
> foreach($tags as $folder) {          
>     $mkDir = $mkDir . $folder ."/";   // make one directory join one other for the nest directory to make
>     echo '"'.$mkDir.'"<br/>';         // this will show the directory created each time
>     if(!is_dir($mkDir)) {             // check if directory exist or not
>       mkdir($mkDir, 0777);            // if not exist then make the directory
>     }
> } 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-08T02:47:52.473

在我的情况下 $insertID 是通过连接从一些数据作为字符串生成的

```
$insertID=$year.$otherId; 
```

我像这样简单地重写了代码，错误消失了：

```
$insertID=(int)($year.$otherId); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-18T08:17:03.827

可能真正的错误是他忘记了一个额外的顶点。

这：

```
mkdir("images/listing-images/rent/'.$insertID."); 
```

里面：

```
/'.$insertID." 
```

正确版本：

```
/".$insertID 
```

扩展正确版本：

```
mkdir("images/listing-images/rent/".$insertID); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-03T17:38:16.060

```
$path = 'd:\path\to\my\file';
mkdir($path, null, true); 
```

这是从 php 手册中复制的。最后一个参数“true”允许创建子文件夹

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-02-21T21:11:47.783

你不应该使用 is_dir() 来检查是否存在，你也需要 file_exists() 。尝试：

```
if (file_exists("images/listing-images/rent/$insertID") {
    mkdir("images/listing-images/rent/$insertID.");
} 
```

已采取'。out，因为它看起来像一个语法错误，但你可能有正当理由保留它。

如果 mkdir 仍然失败，则可能是 images/listing-images/rent 不存在，如果存在，您必须单独创建它。

# sml - SML - 错误：子句的右侧与函数结果类型不符 [循环性]

> ID：15012226
> 
> 赞同：1
> 
> 时间：2013-02-21T21:06:08.887
> 
> 标签：sml, smlnj

考虑以下代码：

```
fun g(a) =
let     fun h(b)=g(a) 
in  h end; 
```

当我在 SML 中运行它时，我得到：

```
- fun g(a) =
= let   fun h(b)=g(a)
= in    h end;
stdIn:55.5-57.10 Error: right-hand-side of clause doesn't agree with function re
sult type [circularity]
  expression:  'Z -> 'Y
  result type:  'Y
  in declaration:
    g = (fn a => let val <binding> in h end) 
```

我无法理解这里的问题：`g(a)`return `h`，但我在声明中没有看到任何特定的返回值`fun g(a)`（即没有什么类似 `fun g(a):int`的），那么为什么会出现错误？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T22:07:47.630

因为`g`只有一个参数，所以它有 type `'X -> 'Y`。

`h(b) = g(a)`意味着`h`和`g`必须有相同的结果类型`'Y`，
并且`h`有类型`'Z -> 'Y`。

因此，`g(x)`对于任何类型的 x `'X`，必须具有类型`'Y`。但是is
的返回值，它有 type 。 这意味着必须与 相同，这是不可能的。`g(x)``h``'Z -> 'Y`
`'Y``'Z -> 'Y`

正如 SML 所说，`'Z -> 'Y`（的类型`h`）不同意`'Y`（的类型`g(a)`）。

如果您尝试手动解决，您会发现

```
g 1 
```

将是一个函数`h`，使得

```
h 3 
```

是的价值

```
g 1 
```

这是一个功能`h`......

等等，无限期地。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:09:23.197

ML 类型推理系统首先将您的函数 g 识别为一个表达式，该表达式接受一个 'Z 并返回 'Y。但随后它看到 g 的结果类型只是 'Y 并且也是早期绑定 h 的结果类型。可以预期会看到 Z -> Z->Y 类型的绑定。但是，您的函数闭包有一个自身的环境。所以就像这样绑定 g 。

```
fun g a= g 
```

如果您的闭包具有本身也是环境的环境，则 ML 类型推断无法猜测类型。

您可以按如下方式声明这些函数。

```
fun g(a) =
    let     
    fun h(b)=g(a) 
    in  
    h(a)
    end; 
```

它像是

```
fun g a = g a 
```

这一次你的闭包只有一个主体。但这没有任何意义......只是一个为什么你会得到循环错误的例子。

# php - 尝试学习mysqli，我的语句实际上都没有返回结果

> ID：15012227
> 
> 赞同：1
> 
> 时间：2013-02-21T21:06:11.413
> 
> 标签：php, mysql, mysqli

听起来确实如此，我的检索语句都没有按应有的方式检索数据。这很奇怪，好像我复制了确切的查询并将其放入 phpMyAdmin 并在那里运行它，它会返回应有的结果。

插入语句和类似的工作，例如：

```
 // On first connect to database, create a user to hold data for users not logged in
    $result = $db->query("SELECT id FROM users WHERE id = 1");
    if ($result->num_rows == 0) {
        $db->query("INSERT INTO users (id, username, email, password) VALUES (1, 'anonymous', 'anonymous', '" . password_hash("...", PASSWORD_BCRYPT) . "')");
    } 
```

并且用户按预期输入。

但是，如果我运行这样的语句：

```
 $result = $db->query("SELECT id, username, password FROM users WHERE email = $email");
    $row = $result->fetch(); 
```

我收到以下错误：“**致命错误：**调用非对象上的成员函数 fetch()”

在 phpMyAdmin 中运行完全相同的语句会按预期返回该行。

但是，它仅适用于一个领域：

```
 if ($result = $db->query("SELECT username, wins, losses FROM users ORDER BY wins DESC LIMIT 10")) {
                while ($row = $result->fetch_assoc()) {
                    echo "<tr><td>" . $row["username"] . "</td> <td>" . $row["wins"] . "</td> <td>" . $row["losses"] . "</td></tr>\n";
                }
            } 
```

它返回预期的结果。不过，我不知道为什么。

我不确定我的文件结构是否重要，我有一个需要的 config.php 文件，它包含连接信息。其余的在我的 index.php 文件中。

这是config.php：

```
<?php
    $db_host = $_SERVER["SERVER_NAME"];
    $db_user = "...";
    $db_pass = "...";
    $db_database = "hangman";

    $db = new mysqli($db_host, $db_user, $db_pass, $db_database);

    if ($db->connect_error) {
        echo "Could not connect to database.";
        exit;
    }
    // On first connect to database, create a user to hold data for users not logged in
    $result = $db->query("SELECT id FROM users WHERE id = 1");
    if ($result->num_rows == 0) {
        $db->query("INSERT INTO users (id, username, email, password) VALUES (1, 'anonymous', 'anonymous', '" . password_hash("...", PASSWORD_BCRYPT) . "')");
    }
?> 
```

我可以包含更多我的 PHP，请说什么，这让我发疯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T19:57:53.670

> 我不确定错误到底是什么。

难怪。你没有要求这个。
运行查询时必须**始终**检查错误

```
$sql = "SELECT wins, losses FROM users WHERE id = 1";
$res = $db->query($sql) or trigger_error($db->error." [$sql]");
$row = $res->fetch_assoc(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:20:36.080

首先，虽然您的输入来自数据库，但您仍然不应该相信任何不是您自己输入的数据。

```
$result = $db->query("SELECT id, username, password FROM users WHERE email = $email");
$row = $result->fetch(); 
```

这有一个语法错误：`$email`需要引号，因为它是一个字符串。

你真的确定你正在连接`$_SERVER["SERVER_NAME"]`吗？
您应该真正连接到`localhost`...

测试查询的一个技巧是将其包装在`if`块中，因为如果失败，`FALSE`则返回而不是对象。你不能打电话`false->fetch()`。

```
if ($result = $db->query($sql)) {
    //do stuff, fetch data, etc.
} else {
    if (DEBUG) { // define('DEBUG', 1);
        trigger_error("Query Failed; Fix it: " . htmlspecialchars($sql));
    } else {
        header("Location: /oops.php");
    }
} 
```

另外，[`prepare`](http://php.net/manual/en/mysqli.prepare.php)为此使用 a 。实际上，对插入数据或包含用户输入的所有内容都使用 prepare 句点。并在任何循环**之前**定义它。

```
if ($x = $db->prepare("SELECT id, username, password FROM users WHERE email = ?")) {
    $x->bind_param("s", $email);
    $x->execute();
    $x->bind_result($id, $user, $pass);
    $x->fetch();
} 
```

Fetch 并不能完全按照您的习惯进行。它在执行查询后获取数据。`fetch_assoc`将从结果对象中获取关联数组。

此外，`users.id = 1`每次有人加载页面时都查询您的数据库并不是一个好主意。将其粘贴在设置脚本中。并让匿名用户拥有一个不可能的密码（也就是代替`$2y$13$<hash>`它会是`Nope, not happenin'`什么）。

此外，您还直接从数据库回显到 HTML。如果你不清理，我可以创建一个类似的用户名`<script src=""></script>`，并通过最新的漏洞获得很多乐趣。消毒~

**更新**：阅读您的代码后，我发现了您的问题。

```
$stmt1 = $db->prepare("SELECT wins FROM users WHERE id = ?");
$stmt2 = $db->prepare("SELECT losses FROM users WHERE id = ?");
$stmt1->bind_param($_SESSION["id"]);
$stmt2->bind_param($_SESSION["id"]);
$stmt1->execute();
$stmt2->execute();
$row1 = $stmt1->fetch();
$row2 = $stmt2->fetch(); 
```

这里有三个问题¹。

第一个问题是***您一次只能在给定连接上进行一个准备调用***。我相当肯定这是因为它是一个阻塞 API 调用。如我错了请纠正我。

第二个是***您没有为`bind_param`调用***指定类型。您必须将类型分配给您在此处指定的任何内容。`s`= 字符串，`i`= 整数。

第三是***你根本不在这里绑定任何结果变量***。使用准备好的查询时**必须**绑定变量。这是针对此实例的修复：

```
if ($query = $db->prepare("SELECT wins, losses FROM users WHERE id = ?")) {
    $query->bind_param("s", $_SESSION["id"]);
    $query->execute();
    $query->bind_result($wins, $losses);
    if (!$query->fetch()) { // fetch one row from database.
        logout(); // or equiv.
    }
} else {
    if (DEBUG) {
        echo "Malformed SQL or In-use thread. SQL: <sql here>";
    } else {
        header("Location: /oops.php");
    }
} 
```

^(1\. 或 4，如果您计算使用多个查询来执行此操作。)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:10:10.627

您的查询存在语法错误，这将导致查询失败，这意味着 $result 将不是结果对象。第一个查询将失败，因为您没有在电子邮件周围加上引号：

```
SELECT id, username, password FROM users WHERE email = $email 
```

应该：

```
SELECT id, username, password FROM users WHERE email = '$email' 
```

查询后，您应该输入如下内容：

```
if ($result->errno!=0){
    echo $result->error;
    exit(0)
}
$row=$result->fetch_assoc();
//etc. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T01:13:14.660

@hiroto 是正确的。如果没有结果，那么就没有对象，这就是为什么在非对象上调用方法时会出现致命错误。正如他所提到的，SQL 查询存在问题，并且电子邮件需要引用，因为它是一个字符串。否则 MySQL 将失败并出现错误。

另外，mysqli结果对象没有fetch()方法，所以他建议使用fetch_assoc()；

要获得结果，您需要引用电子邮件以便获得结果对象，并在访问数据时执行循环：

```
$result = $db->query("SELECT id, username, password FROM users WHERE email = '$email'");
while($row = $result->fetch_assoc())
{
    print_r($row);
} 
```

或者直接按键拉取数据：

```
$result = $db->query("SELECT id, username, password FROM users WHERE email = '$email'");
$row = $result->fetch_assoc();
echo $row['username']; 
```

# python - 在 Python 字符串中的最后一个分隔符上拆分？

> ID：15012228
> 
> 赞同：320
> 
> 时间：2013-02-21T21:06:15.630
> 
> 标签：python, string, list, parsing, split

*在字符串中最后一次*出现分隔符时拆分字符串的推荐 Python 习惯用法是什么？例子：

```
# instead of regular split
>> s = "a,b,c,d"
>> s.split(",")
>> ['a', 'b', 'c', 'd']

# ..split only on last occurrence of ',' in string:
>>> s.mysplit(s, -1)
>>> ['a,b,c', 'd'] 
```

`mysplit`接受第二个参数，即要拆分的分隔符的出现。就像在常规列表索引中一样，`-1`表示最后一个。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：547
> 
> 时间：2013-02-21T21:06:55.483

使用[`.rsplit()`](http://docs.python.org/library/stdtypes.html#str.rsplit) or[`.rpartition()`](http://docs.python.org/library/stdtypes.html#str.rpartition)代替：

```
s.rsplit(',', 1)
s.rpartition(',') 
```

`str.rsplit()`允许您指定拆分多少次，虽然`str.rpartition()`只拆分一次但始终返回固定数量的元素（前缀、分隔符和后缀），并且对于单个拆分情况更快。

演示：

```
>>> s = "a,b,c,d"
>>> s.rsplit(',', 1)
['a,b,c', 'd']
>>> s.rsplit(',', 2)
['a,b', 'c', 'd']
>>> s.rpartition(',')
('a,b,c', ',', 'd') 
```

两种方法都从字符串的右侧开始拆分；通过`str.rsplit()`将最大值作为第二个参数，您可以仅拆分最右侧的出现。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2018-03-15T16:40:10.320

您可以使用 rsplit

```
string.rsplit('delimeter',1)[1] 
```

从反向获取字符串。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-11-24T14:31:56.410

我只是为了好玩

```
 >>> s = 'a,b,c,d'
    >>> [item[::-1] for item in s[::-1].split(',', 1)][::-1]
    ['a,b,c', 'd'] 
```

**注意**：请参阅下面的第一条评论，该答案可能会出错。

# opencv - 如何释放用于在opencv 2.4.3中存储轮廓的seq使用的内存

> ID：15012231
> 
> 赞同：0
> 
> 时间：2013-02-21T21:06:31.280
> 
> 标签：opencv

此代码用于从 cam 捕获，然后在每一帧上将其转换为 HSV 图像，然后对其应用颜色分割以找到红色、绿色和蓝色对象，然后找到每个对象的轮廓并将其存储在 CVSeq 中。

代码运行良好，但问题是 10 分钟后它会引发运行时异常，因为尽管我`cvClearMemStorage()`用来释放内存，但没有内存可以分配给新轮廓。

```
#include <cv.h>
#include <highgui.h>

CvSeq *contours;
IplImage* frame=0;
CvMemStorage* g_storage;

//This function threshold the HSV image and create a binary image
IplImage* GetThresholdedRedImage(IplImage* imgHSV)
{
       IplImage* imgThresh = cvCreateImage(cvGetSize(imgHSV),IPL_DEPTH_8U, 1);
       cvInRangeS(imgHSV, cvScalar(160,160,60), cvScalar(180,256,256), imgThresh);

       //CvMemStorage* g_storage = cvCreateMemStorage(0);
       cvFindContours( cvCloneImage(imgThresh), g_storage, &contours );
       if( contours )
       {
           cvDrawContours(frame, contours, cvScalar(0, 255, 0), cvScalarAll(255), 100);
           cvClearSeq(contours);

       }

       cvClearMemStorage(g_storage);

       return imgThresh;
}

IplImage* GetThresholdedGreenImage(IplImage* imgHSV)
{
       IplImage* imgThresh=cvCreateImage(cvGetSize(imgHSV),IPL_DEPTH_8U, 1);
       cvInRangeS(imgHSV, cvScalar(38,160,60), cvScalar(75,256,256), imgThresh);

       //CvMemStorage* g_storage = cvCreateMemStorage(0);
       cvFindContours( cvCloneImage(imgThresh), g_storage, &contours );
       if( contours )
       {
           cvDrawContours(frame, contours, cvScalar(0, 255, 255), cvScalarAll(255), 100);
           cvClearSeq(contours);
       }

       cvClearMemStorage(g_storage);

       return imgThresh;
}

IplImage* GetThresholdedBlueImage(IplImage* imgHSV)
{
       IplImage* imgThresh=cvCreateImage(cvGetSize(imgHSV),IPL_DEPTH_8U, 1);
       cvInRangeS(imgHSV, cvScalar(75,160,60), cvScalar(130,256,256), imgThresh);

       //CvMemStorage* g_storage = cvCreateMemStorage(0);
       cvFindContours( cvCloneImage(imgThresh), g_storage, &contours );
       if( contours )
       {
           cvDrawContours(frame, contours, cvScalarAll(255), cvScalarAll(255), 100);
           cvClearSeq(contours);
       }

       cvClearMemStorage(g_storage);

       return imgThresh;
}

int main()
{
      CvCapture* capture =0;

      capture = cvCaptureFromCAM(0);
      if(!capture)
      {
        printf("Capture failure\n");
        return -1;
      }

      //IplImage* frame=0;

      cvNamedWindow("Video");
      cvNamedWindow("Red");
      //cvNamedWindow("Yellow");
      //cvNamedWindow("Orange");
      cvNamedWindow("Green");
      cvNamedWindow("Blue");
      //cvNamedWindow("Violet");
      g_storage = cvCreateMemStorage(0);

      //iterate through each frames of the video
      while(true)
      {

            frame = cvQueryFrame(capture);
            if(!frame) break;

            frame = cvCloneImage(frame);
            cvSmooth(frame, frame, CV_GAUSSIAN,3,3); //smooth the original image using Gaussian kernel

            IplImage* imgHSV = cvCreateImage(cvGetSize(frame), IPL_DEPTH_8U, 3);
            cvCvtColor(frame, imgHSV, CV_BGR2HSV); //Change the color format from BGR to HSV

            IplImage* redImgThresh = GetThresholdedRedImage(imgHSV);
            IplImage* blueImgThresh = GetThresholdedBlueImage(imgHSV);
            IplImage* greenImgThresh = GetThresholdedGreenImage(imgHSV);

            //cvClearSeq(contours);

            cvSmooth(redImgThresh, redImgThresh, CV_GAUSSIAN,3,3); //smooth the binary image using Gaussian kernel
            cvSmooth(blueImgThresh, blueImgThresh, CV_GAUSSIAN,3,3);
            cvSmooth(greenImgThresh, greenImgThresh, CV_GAUSSIAN,3,3);

            cvShowImage("Red", redImgThresh);
            cvShowImage("blue", blueImgThresh);
            cvShowImage("green", greenImgThresh);
            cvShowImage("Video", frame);

            //Clean up used images
            cvReleaseImage(&imgHSV);
            cvReleaseImage(&redImgThresh);
            cvReleaseImage(&blueImgThresh);
            cvReleaseImage(&greenImgThresh);
            cvReleaseImage(&frame);

            //Wait 50mS
            int c = cvWaitKey(10);
            //If 'ESC' is pressed, break the loop
            if((char)c==27 ) break;
      }

      cvDestroyAllWindows() ;
      cvReleaseCapture(&capture);

      return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:19:06.447

我不喜欢的代码的一部分是：

```
frame = cvCloneImage(frame);
...
cvReleaseImage(&frame); 
```

由于，从`highgui.h`

```
 /* Just a combination of cvGrabFrame and cvRetrieveFrame
 !!!DO NOT RELEASE or MODIFY the retrieved frame!!!      */
 CVAPI(IplImage*) cvQueryFrame( CvCapture* capture ); 
```

我建议使用不同的指针来检索图像并将其克隆到这个。

```
IplImage* tempFrame = cvCloneImage(frame);
frame = cvCloneImage(tempFrame);
...
cvReleaseImage(&frame); 
```

另请阅读：[OpenCV 简介](http://www.cs.iit.edu/~agam/cs512/lect-notes/opencv-intro/opencv-intro.html)

请参阅**使用视频序列**部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T04:29:46.367

## ***如果您使用 MSVC 编译此...***

`main()`在包含您的入口点的同一文件中包含以下代码行：

```
#if _DEBUG
#   define _CRTDBG_MAP_ALLOC
#   include <stdlib.h>
#   include <crtdbg.h>
#endif 
```

然后，在`main()`函数的最顶部，包括以下内容：

```
_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF); 
```

这将告诉 VC 运行时动态监视应用程序中的资源泄漏。
编译并运行您的应用程序，然后在几秒钟左右后退出它。

如果您查看输出窗口，您应该会看到一些类似于以下内容的行：

```
Detected memory leaks!
Dumping objects ->
{18} normal block at 0x00780E80, 64 bytes long.
 Data: <                > CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD
Object dump complete. 
```

这里的兴趣点是`{18} normal block`，它是内存分配数和[块类型](http://msdn.microsoft.com/en-us/library/htdyz80k%28v=vs.80%29.aspx)。查看列表中的第一个分配编号，并将其复制下来。

现在，就在您在函数中编写`_CrtSetDbgFlag()`的位置下方`main()`，粘贴以下内容：

```
_CrtSetBreakAlloc(18); // Where `18` is the memory allocation number 
```

如果您再次编译并运行，您的项目应该在分配该内存块的位置中断。如果它在代码的未知部分中中断，您可以检查“调用堆栈”窗口以将其追溯到您编写的代码。

您应该使用此信息来了解哪些对象需要被释放，并让您大致了解在哪里这样做。只需重复此过程，直到不再检测到泄漏。

所有这些信息以及更多信息都可以通过MSDN 中的[Memory Leak Detection and Isolation找到。](http://msdn.microsoft.com/en-us/library/x98tx3cf%28v=vs.80%29.aspx)

## ***如果您正在为 UNIX 编译...***

检查[此线程](https://stackoverflow.com/questions/5195220/tools-to-determine-memory-leak-in-a-c-c-code)以获取更多信息。

## ***现在，就如何解除分配而言...***

好吧，这实际上取决于分配的*内容*（以及确切的分配方式）。
在 的情况下`CvSeq`，您通常根本不需要释放它，因为它（似乎）由 OpenCV 管理，直到`cvReleaseMemStorage`被调用。由于我在您发布的代码中的任何地方都没有看到对此方法的调用，因此这可能会导致您的资源泄漏......

因此，我敦促您按照上述步骤自行确定代码是否在`cvCreateMemStorage`. 如果是这样，请确保在`cvReleaseMemStorage`完成使用后包含对的调用。

另一方面，`cvClearMemStorage`描述如下： “该函数[将](http://opencv.willowgarage.com/documentation/dynamic_structures.html)
*存储的顶部（可用空间边界）重置为最开始。**此函数不会释放任何内存。**如果存储有父存储，则该函数将所有块返回到父母。”*

您是否可能混淆了这两个功能？

# django - 将 Django auth UserAdmin 用于自定义用户模型

> ID：15012235
> 
> 赞同：88
> 
> 时间：2013-02-21T21:06:39.857
> 
> 标签：django, django-models, django-admin, django-authentication, django-custom-user

来自[Django.Contrib.Auth 文档](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#extending-django-s-default-user)：

> **扩展 Django 的默认用户** 如果您对 Django 的用户模型非常满意并且只想添加一些额外的配置文件信息，您可以简单地继承`django.contrib.auth.models.AbstractUser`并添加您的自定义配置文件字段。此类提供默认用户的完整实现作为抽象模型。

说了又做了。我创建了一个新模型，如下所示：

```
class MyUser(AbstractUser):
  some_extra_data = models.CharField(max_length=100, blank=True) 
```

这几乎像 Django 的标准一样显示在 admin 中`User`。但是，admin 中最重要的区别是密码（重新）设置字段不存在，而是显示了一个普通的 CharField。我真的必须覆盖 admin-config 中的内容才能使其正常工作吗？如果是这样，我怎么能以某种干燥的方式做到这一点（即不从 Django 源代码复制东西...... eww......）？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2013-02-21T22:55:33.977

在研究了 Django 源代码一段时间后，我发现了一个工作灵魂。我对这个解决方案并不完全满意，但它似乎有效。随时提出更好的解决方案！

* * *

Django 用于`UserAdmin`为`User`模型呈现漂亮的管理员外观。通过在我们的`admin.py`-file 中使用它，我们可以获得相同的模型外观。

```
from django.contrib.auth.admin import UserAdmin
admin.site.register(MyUser, UserAdmin) 
```

但是，仅此一项可能不是一个好的解决方案，因为 Django Admin 不会显示您的任何特殊字段。有两个原因：

*   `UserAdmin`用作修改对象时使用`UserChangeForm`的形式，而对象又`User`用作其模型。
*   `UserAdmin`定义了一个`formsets`-property，稍后由 使用`UserChangeForm`，它不包括您的特殊字段。

因此，我创建了一个特殊的变更表单，它重载了 Meta 内部类，以便变更表单使用正确的模型。我还不得不重载`UserAdmin`将我的特殊字段添加到字段集中，这是我有点不喜欢的解决方案的一部分，因为它看起来有点难看。随时提出改进建议！

```
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.forms import UserChangeForm

class MyUserChangeForm(UserChangeForm):
    class Meta(UserChangeForm.Meta):
        model = MyUser

class MyUserAdmin(UserAdmin):
    form = MyUserChangeForm

    fieldsets = UserAdmin.fieldsets + (
            (None, {'fields': ('some_extra_data',)}),
    )

admin.site.register(MyUser, MyUserAdmin) 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2014-04-14T15:08:28.137

一个更简单的解决方案，**admin.py：**

```
from django.contrib.auth.admin import UserAdmin
from main.models import MyUser

class MyUserAdmin(UserAdmin):
    model = MyUser

    fieldsets = UserAdmin.fieldsets + (
            (None, {'fields': ('some_extra_data',)}),
    )

admin.site.register(MyUser, MyUserAdmin) 
```

Django 将正确引用 MyUser 模型进行创建和修改。我正在使用 Django 1.6.2。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2013-07-05T21:04:50.920

nico 的回答非常有帮助，但我发现 Django 在创建新用户时仍然引用 User 模型。

票证[#19353](https://code.djangoproject.com/ticket/19353)引用了这个问题。

为了修复它，我不得不再添加一些`admin.py`

**管理员.py：**

```
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.forms import UserChangeForm, UserCreationForm
from main.models import MyUser
from django import forms

class MyUserChangeForm(UserChangeForm):
    class Meta(UserChangeForm.Meta):
        model = MyUser

class MyUserCreationForm(UserCreationForm):
    class Meta(UserCreationForm.Meta):
        model = MyUser

    def clean_username(self):
        username = self.cleaned_data['username']
        try:
            MyUser.objects.get(username=username)
        except MyUser.DoesNotExist:
            return username
        raise forms.ValidationError(self.error_messages['duplicate_username'])

class MyUserAdmin(UserAdmin):
    form = MyUserChangeForm
    add_form = MyUserCreationForm
    fieldsets = UserAdmin.fieldsets + (
        (None, {'fields': ('extra_field1', 'extra_field2',)}),
    )

admin.site.register(MyUser, MyUserAdmin) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-08-15T20:38:56.720

当我尝试将自定义字段添加到创建表单时，cesc 的答案对我不起作用。也许它自 1.6.2 以来发生了变化？无论哪种方式，我发现将字段添加到 fieldset 和 add_fieldsets 就可以了。

```
ADDITIONAL_USER_FIELDS = (
    (None, {'fields': ('some_additional_field',)}),
)

class MyUserAdmin(UserAdmin):
    model = MyUser

    add_fieldsets = UserAdmin.add_fieldsets + ADDITIONAL_USER_FIELDS
    fieldsets = UserAdmin.fieldsets + ADDITIONAL_USER_FIELDS

admin.site.register(MyUser, MyUserAdmin) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-08-04T19:52:19.093

另一个类似的解决方案（[取自此处](http://web.archive.org/web/20180625181014/https://dyve.net/post/django-custom-user-model-admin/)）：

```
from __future__ import unicode_literals

from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.models import AbstractUser
from django.utils.translation import ugettext_lazy as _

from .models import User

class UserAdminWithExtraFields(UserAdmin):

    def __init__(self, *args, **kwargs):
        super(UserAdminWithExtraFields, self).__init__(*args, **kwargs)

        abstract_fields = [field.name for field in AbstractUser._meta.fields]
        user_fields = [field.name for field in self.model._meta.fields]

        self.fieldsets += (
            (_('Extra fields'), {
                'fields': [
                    f for f in user_fields if (
                        f not in abstract_fields and
                        f != self.model._meta.pk.name
                    )
                ],
            }),
        )

admin.site.register(User, UserAdminWithExtraFields) 
```

# java - 具有 pojos 的 Freemarker HashMap 循环

> ID：15012238
> 
> 赞同：1
> 
> 时间：2013-02-21T21:06:55.747
> 
> 标签：java, freemarker

我有 HashMap 汽车，而 pojo Car 包含属性“engines”，它又是 HashMap。

```
public class Car implements Serializable{
       private Long id;
       private String name;
       private Map<Long,Engine> engines = new HashMap<>();
       ..
       ..
}
public class Engine implements Serializable{
       private Long id;
       private String name;
} 
```

自由标记模型

```
final StringWriter sw = new StringWriter();
Map model = new HashMap();
model.put("cars",theCarsMap);
Template tmpl = t.cfg.getTemplate("text.ftl");
tmpl.process(model, sw); 
```

自由标记配置

```
 cfg = new Configuration();
    cfg.setCacheStorage(new freemarker.cache.MruCacheStorage(20, 250));
    cfg.setClassForTemplateLoading(getClass(), ".");
    cfg.setObjectWrapper(new DefaultObjectWrapper()); 
```

模板代码：

```
 <#assign rKeys = cars?keys>
 <#list rKeys as rKey>
 Car Details:${cars[rKey].getName()}\n
  --------------------------------------------------\n
 <#assign engines = cars[rKey].getEngines()>
 <#assign tKeys = engines?keys>
 <#list tKeys as tKey>
 ------------------Engine Details-----------------\n
 Name: ${engines[tKey].getName()}\n
 </#list>
 </#list> 
```

我收到以下错误：

有问题的指令：

```
${cars[rKey].getName()} [on line 3, column 18 in text.ftl] 
```

是否有任何与包含 pojos 和另一个 Map 的 HashMap 相关的特殊处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:52:23.803

它不适用于以 POJO 作为值的 Map，我必须更改为 List .... 并且原始类型的 java 对象包装器也不起作用，更改为原始定义。即长--->长

```
<#list cars as c>
 ${c.id!'Unknown'} - ${c.name!'Unknown'}

 <#list c.engineList as t>
    ${t.id!'Unknown'} - ${t.name!'Unknown'}
 </#list>
 </#list> 
```

# sql - 编写一个 sql 查询以返回具有两个评分的电影？

> ID：15012239
> 
> 赞同：1
> 
> 时间：2013-02-21T21:06:56.887
> 
> 标签：sql, sqlite

我有一张这样的桌子

列名

> 中等，评级
> 
> M1 R1
> 
> M1 R2
> 
> M2 R3
> 
> M3 R4

我想准确返回两个评分的电影（这是我正在解决的问题的一个小问题）

预期结果是中等和它的评级。

> 从电影中选择 *
> 
> 其中 2 = (select count(*) from movie b group by b.mid and b.mid=mid )

这没有按预期工作，我什至不知道它在做什么。谁能向我解释我该怎么做才能获得预期的结果。

> **我不能使用，我必须将“子查询的结果”与 2 进行比较。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:08:18.353

试试这个：

```
SELECT mid
FROM YourTable
GROUP BY mid
HAVING COUNT(*) = 2 
```

**更新**

好吧，如果你不能使用`HAVING`（为什么？），那么你可以试试`JOIN`：

```
SELECT A.* 
FROM movie A
INNER JOIN (SELECT mid, COUNT(*) ratings
            FROM movie
            GROUP BY mid) B
    ON A.mid = B.mid
WHERE 2 = B.ratings 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:15:35.317

如果你不能使用`HAVING`，那么你可以使用这样的东西：

```
select *
from movie m1
where 2 = (select count(*)
           from movie m2
           where m1.mid = m2.mid) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!5/e6628/3)

如果要返回具有不同评分计数的那些，则可以使用：

```
select *
from movie m1
where 2 = (select count(distinct rating)
           from movie m2
           where m1.mid = m2.mid) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!5/e6628/5)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:25:02.710

使用您的原始查询：

```
select * from 
mid a where 
(
    (select count(*) 
       from mid b 
      where b.mid = a.mid 
      group by b.mid) = 2
); 
```

刚刚为外部表添加了一个别名，并为与 2 的子查询比较添加了括号。

```
Results:
mid     rating
m1      r1
m1      r2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T21:09:19.570

你可以这样做：

```
SELECT `mid`, count(rating) AS `rating_count`
FROM table
WHERE `rating_count` = 2
GROUP BY `mid` 
```

在这里，您只需计算`rating`每组的出现次数`mid`。然后您过滤该值（存储在`rating_count`此处）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T21:17:18.287

如果您想显示实际收视率，请遵循这些原则

```
SELECT mid, rating FROM movie m
JOIN (SELECT mid, COUNT(*) FROM movie GROUP BY mid HAVING COUNT(*)=2) c 
ON (m.mid = c.mid) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-21T21:45:01.390

`HAVING`可以而且应该使用；我用 SQLite 2.8.17 和 3.6.22 进行了测试。

要获得具有两个评分的电影：

```
SELECT mid
FROM movie
GROUP BY mid
HAVING COUNT(*) = 2; 
```

然后你可以在一个`IN`：

```
SELECT *
FROM movie
WHERE mid in (
    SELECT mid
    FROM movie
    GROUP BY mid
    HAVING COUNT(*) = 2
); 
```

或加入它：

```
SELECT movie.*
FROM movie
    JOIN (
        SELECT mid
        FROM movie
        GROUP BY mid
        HAVING COUNT(*) = 2
    ) those_with_two
        ON movie.mid = those_with_two.mid; 
```

完整的测试用例设置，供参考：

```
$ sqlite3 so-movie

create table movie (
    mid varchar(10),
    rating varchar(10)
);

insert into movie values('M1','R1');
insert into movie values('M1','R2');
insert into movie values('M2','R3');
insert into movie values('M3','R4'); 
```

我说`HAVING`应该使用有几个原因：

1.  如果您想要多个子句，它会更灵活，例如具有两个评级或 mid='M3' 的电影
2.  它会比 Lamak 的第二个解决方案执行得更好（解释计划显示打了三个表）
3.  更容易阅读和理解

# android - 使用 XMLConfiguration 解析原始文件夹中的 XML 文件

> ID：15012246
> 
> 赞同：0
> 
> 时间：2013-02-21T21:07:26.793
> 
> 标签：android, xml-parsing, apache-commons

我正在尝试使用 XMLConfigurable apache 通用 XML 解析器来解析我附加到 android 中原始文件夹的 XML 文件，但我找不到实际获取 xml 路径的方法。

我已经尝试过[了，](https://stackoverflow.com/questions/7966085/raw-folder-url-path)但它不起作用，XMLConfiguration 会抛出找不到文件的错误。有没有办法真正获得完整的路径？

我也试过用这个：

```
context.getResources().openRawResource(R.raw.kmlsample); 
```

但也想不出一种使用 XMLConfiguration 来获取 InputStream 的方法，它所需要的只是文件或 URL 或字符串（作为文件名/路径）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T23:00:31.753

我认为您需要使用方法：[load(InputStream in)](http://commons.apache.org/configuration/apidocs/org/apache/commons/configuration/XMLConfiguration.html#load%28java.io.InputStream%29)

```
XMLConfiguration config = new XMLConfiguration();
try {
    config.load( context.getResources().openRawResource(R.raw.kmlsample));

} catch (ConfigurationException e) {
    e.printStackTrace();
} catch (NotFoundException e) {
    e.printStackTrace();
} 
```

# sql - Oracle SQL 中的 For 循环

> ID：15012247
> 
> 赞同：15
> 
> 时间：2013-02-21T21:07:33.543
> 
> 标签：sql, oracle

我是 Oracle 新手，我不知道在 Oracle SQL（不是 PL/SQL）中使用 for 循环。

我需要在查询中将数字增加 +1 并执行语句；是否可以在 SQL 中使用 for 循环？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-21T21:29:12.710

你很困惑我的朋友。SQL 中没有循环，只有 PL/SQL 中。下面是一些基于现有 Oracle 表的示例 - 复制/粘贴以查看结果：

```
-- Numeric FOR loop --
set serveroutput on -->> do not use in TOAD --
DECLARE
  k NUMBER:= 0;
BEGIN
  FOR i IN 1..10 LOOP
    k:= k+1;
    dbms_output.put_line(i||' '||k);
 END LOOP;
END;
/

-- Cursor FOR loop --
set serveroutput on
DECLARE
   CURSOR c1 IS SELECT * FROM scott.emp;
   i NUMBER:= 0;
BEGIN
  FOR e_rec IN c1 LOOP
  i:= i+1;
    dbms_output.put_line(i||chr(9)||e_rec.empno||chr(9)||e_rec.ename);
  END LOOP;
END;
/

-- SQL example to generate 10 rows --
SELECT 1 + LEVEL-1 idx
  FROM dual
CONNECT BY LEVEL <= 10
/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T21:35:50.973

您当然可以使用*WITH 子句*或使用Oracle SQL 中可用的*分析函数来做到这一点。*

通过一些努力，您将能够像在普通过程语言中一样从周期中得到任何东西。与普通 SQL 相比，这两种方法都非常强大。

[http://www.dba-oracle.com/t_with_clause.htm](http://www.dba-oracle.com/t_with_clause.htm)

[http://www.orafaq.com/node/55](http://www.orafaq.com/node/55)

不过，这需要一些努力。不要害怕发布一个具体的例子。

使用简单的伪表 DUAL 也有帮助。

# loops - 如何实现serialEvent和loop同时不中断？

> ID：15012248
> 
> 赞同：2
> 
> 时间：2013-02-21T21:07:34.283
> 
> 标签：loops, serial-port, arduino

我一直在研究传感器读取器/齿轮遥控汽车机器人，但我卡在了一些东西上。我介绍了一个 void loop() 和一个 void serialEvent() 范围。serialEvent 获取值、累加并调用其他函数，例如 turnRight()、turnLeft() 或 reverseGear()。但是今天我尝试为汽车做一个速度显示。但是我发现串行事件中断了连续显示的动画。换句话说，我想在 serialEvent 上连续接收数据，同时在 void 循环上成功完成其他连续事件。我附上了我认为可能是问题的代码部分。我使用 Arduino Mega 1280。任何答案将不胜感激。谢谢。

注意：请注意，serialEvent 应连续接收数据（有 1 秒延迟），用于调整灵敏度的电机。

串行事件就像..

```
void serialEvent(){
  if ( Serial.available() > 0 ){ 
      int val = Serial.read() - '0'; 
      if(val == 0){ ....................... 
```

循环范围就像..

```
void loop() 
{ 
  displayModule.setDisplayToDecNumber(15, 0, false);
  for(int k =0; k<=7; k++){
    displayModule.setLED(TM1638_COLOR_GREEN, k);
    delay(100);
    ............................ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:05:40.623

Arduino 论坛的座右铭始终适用：如果您发布整个草图，而不仅仅是您认为问题所在的片段，则更容易提供帮助。

也就是说，我认为这里有一个严重的问题：

> ```
> for(int k =0; k<=7; k++){
>     displayModule.setLED(TM1638_COLOR_GREEN, k);
>     delay(100); 
> ```

这个 for 循环基本上会暂停你的草图至少 800 毫秒。

如果你想让你的草图成为“多任务”，你必须停止使用延迟（），并将你的思维方式从顺序编程转换为基于状态（或事件）的编程。通常的建议是研究“立即闪烁”示例。

第二个说明，我不明白你的意思

> 我介绍了一个 void loop()

如果您不编写循环函数，则草图将不会首先编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:18:18.253

我不知道这是否会有所帮助。这是我制作的一个串行代码示例，它根据传入的串行数据绘制 2 个条形图。这是一个处理文件，但它应该类似于 Arduino 草图。至少在serialEvent 的意义上。如果您之前没有使用过处理，则 draw 方法类似于循环方法。也许这段代码中有一些东西可以帮助你。

```
import processing.serial.*;

Serial myPort;
float[] floatArray;
float f1; float f2;

void setup() {
  size(400, 400);
  // Prints lists of serial ports
  println(Serial.list());
  // Usually arduino is port [0], but if not then change it here
  myPort = new Serial(this, Serial.list()[0], 9600);
  // Don't call serialEvent until new line character received
  myPort.bufferUntil('\n');
  // Creates and array of floating decimal numbers and initializes its length to 2
  floatArray = new float[2];
}

void draw() {
  // Draws 2 bars to represent incoming data in patriotic fashion
  background(0, 0, 255);
  fill(255, 0, 0);
  rect(0, f1, 100, height);
  fill(255);
  rect(100, f2, 100, height); 
}

void serialEvent(Serial myPort) {
  // Reads input until it receives a new line character
  String inString = myPort.readStringUntil('\n');
  if (inString != null) {
    // Removes whitespace before and after string
    inString = trim(inString);
    // Parses the data on spaces, converts to floats, and puts each number into the array
    floatArray = float(split(inString, " "));
    // Make sure the array is at least 2 strings long.   
    if (floatArray.length >= 2) {
      // Assign the two numbers to variables so they can be drawn
      f1 = floatArray[0];
      f2 = floatArray[1];
      println(f2);
      // You could do the drawing down here in the serialEvent, but it would be choppy
    }
  } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T16:18:57.813

我相信您需要设置串行接收中断来实现您的目标。

我会在以下位置使用 Peter Fluery 的 AVR 串行库：

[http://homepage.hispeed.ch/peterfleury/avr-software.html](http://homepage.hispeed.ch/peterfleury/avr-software.html)

它使用循环环形缓冲区实现串行中断。

# node.js - 处理 Mongoose 验证错误——在哪里以及如何处理？

> ID：15012250
> 
> 赞同：58
> 
> 时间：2013-02-21T21:07:39.570
> 
> 标签：node.js, validation, mongodb, mongoose

我正在尝试决定如何处理 Mongoose 中的验证错误。

## 使用节点验证器的自定义错误消息

[我已经使用node-validator](https://github.com/chriso/node-validator)定义了自己的验证规则，例如：

```
UserSchema.path('username')
  .validate(function (username) {
    return validator.check(username).notEmpty()
  }, 'Username cannot be blank') 
```

这将生成如下所示的错误：

```
 username: 
   { message: 'Validator "Username cannot be blank" failed for path username',
     name: 'ValidatorError',
     path: 'username',
     type: 'Username cannot be blank' }, 
```

## 使用猫鼬验证器

但是，node-validator 提供了自己的错误消息。如果我使用[mongoose-validator](https://github.com/leepowellcouk/mongoose-validator) Node 模块将 node-validator 直接插入到我的架构中，那么我可以直接使用这些错误消息：

```
var UserSchema = new Schema({
  name: { type: String, validate: [validate('notEmpty')] }
}); 
```

这将生成如下所示的错误消息：

```
 name: 
   { message: 'Validator "String is empty" failed for path name',
     name: 'ValidatorError',
     path: 'name',
     type: 'String is empty' } } 
```

我也可以在这里提供自定义错误消息：

```
var UserSchema = new Schema({
  name: { type: String, validate: [validate({message: 'Name cannot be blank' }, 'notEmpty')] }
}); 
```

## 猫鼬`required`旗

Mongoose 允许您根据需要定义一个字段：

```
var UserSchema = new Schema({
  name: { type: String, required: true }
}); 
```

这将生成如下所示的错误消息：

```
 name: 
   { message: 'Validator "required" failed for path name',
     name: 'ValidatorError',
     path: 'name',
     type: 'required' } } 
```

## 问题

感觉好像这些验证器**希望**您使用它们的内置错误消息。例如，我想声明一个`required`如上所示的字段，但我找不到自定义错误消息的方法。而且 mongoose-validator 模块直到最近才支持自定义消息，这让我认为它们是模型级别的反模式。

实现这些验证器的最佳方式是什么？我应该让他们产生自己的错误，然后以某种方式解释它们吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-06-10T12:43:33.273

在这一点上，相信猫鼬如何处理错误似乎是合乎逻辑的。

您不希望您的模型处理错误消息。表示层（控制器？）应该依赖于`type`决定哪个是最好的用户友好消息显示（考虑 i18n）。

还有一种情况是[使用中间件](http://mongoosejs.com/docs/middleware.html)进行验证。在这种情况下，将出现在您的控制器上的错误消息是您传递给`next()`回调的任何内容。

因此，对于中间件，虽然没有记录，但为了在您的模型中保持一致的验证 API，您应该直接使用 Mongoose 的 Error 构造函数：

```
var mongoose = require('mongoose');
var ValidationError = mongoose.Error.ValidationError;
var ValidatorError  = mongoose.Error.ValidatorError;

schema.pre('save', function (next) {
  if (/someregex/i.test(this.email)) {
    var error = new ValidationError(this);
    error.errors.email = new ValidatorError('email', 'Email is not valid', 'notvalid', this.email);
    return next(error);
  }

  next();
}); 
```

这样，即使验证错误源自中间件，也可以保证一致的验证错误处理。

为了正确地将错误消息与类型匹配，我将创建一个*枚举*，它将充当所有可能类型的静态映射：

```
// my controller.js

var ValidationErrors = {
  REQUIRED: 'required',
  NOTVALID: 'notvalid',
  /* ... */
};

app.post('/register', function(req, res){
  var user = new userModel.Model(req.body);

  user.save(function(err){
    if (err) {
      var errMessage = '';

      // go through all the errors...
      for (var errName in err.errors) {
        switch(err.errors[errName].type) {
          case ValidationErrors.REQUIRED:
            errMessage = i18n('Field is required');
            break;
          case ValidationErrors.NOTVALID:
            errMessage = i18n('Field is not valid');
            break;
        }
      }
      res.send(errMessage);

    }
  });
}); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2017-01-31T10:23:56.257

我知道验证器插件可能很有帮助，但我认为猫鼬验证的东西比它真正的复杂更令人生畏。从外面看它肯定看起来很复杂，但一旦你开始撕开它，它并没有那么糟糕。

如果您查看下面的代码，您将看到如何使用内置验证器返回自定义错误消息的示例。

您所要做的就是在设置字段时使用您自己的自定义错误消息设置第二个参数。

查看下面的`required`和`minlength`和`maxlength`字段以查看我如何设置自定义错误消息，然后查看以下方法以了解如何访问错误对象或将其发送到前端：

```
// Grab dependencies:
var mongoose = require('mongoose');

// Setup a schema:
var UserSchema = new mongoose.Schema (
    {
        username: {
            type: String,
            minlength: [2, 'Username must be at least 2 characters.'],
            maxlength: [20, 'Username must be less than 20 characters.'],
            required: [true, 'Your username cannot be blank.'],
            trim: true,
            unique: true,
            dropDups: true,
        }, // end username field
    },
    {
        timestamps: true,
    },
);

// Export the schema:
module.exports = mongoose.model('User', UserSchema); 
```

以上设置我们的字段以具有自定义错误消息。但是我们如何访问它们或将它们发送到我们的前端？我们可以在我们的服务器控制器中设置以下方法，其响应数据被发送回 Angular：

```
var myControllerMethods = {
    register : function(req, res) {
        // Create a user based on the schema we created:
        User.create(req.body)
            .then(function(newUser) {
                console.log('New User Created!', newUser);
                res.json(newUser);
            })
            .catch(function(err) {
                if (err.name == 'ValidationError') {
                    console.error('Error Validating!', err);
                    res.status(422).json(err);
                } else {
                    console.error(err);
                    res.status(500).json(err);
                }
            })
    },
}; 
```

如果你运行上面的代码，并且我们的任何 mongoose 验证器没有通过，error( `err`) 对象将被 Promise`.catch()`中的 抓取。如果您在控制台记录此错误，您将在该对象中看到我们的自定义消息，具体取决于标记的错误。

注意：上面的例子只是为了向 Mongoose 拥有的已经内置的验证添加自定义验证消息（如`required`、`minlength`等`maxlength`）。

如果您想创建更高级的验证，例如根据正则表达式模式验证字段等，那么您必须创建自定义`validator`函数。

请参阅此链接中的“自定义验证器”部分，了解如何在您的字段中添加验证器的一个很好的示例：http: [//mongoosejs.com/docs/validation.html](http://mongoosejs.com/docs/validation.html)。

注意：您也可以使用“预保存挂钩”和“实例方法”，但这超出了本问题的范围，内置验证器和“自定义验证器”（上述链接）是更简单的路线。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-07T13:36:14.210

来自猫鼬：[https ://github.com/leepowellcouk/mongoose-validator](https://github.com/leepowellcouk/mongoose-validator)

错误消息自定义错误消息现在回到 0.2.1 并且可以通过选项对象设置：

`validate({message: "String should be between 3 and 50 characters"}, 'len', 3, 50)`

* * *

我是如何实现的：

```
var emailValidator = [validate({message: "Email Address should be between 5 and 64 characters"},'len', 5, 64), validate({message: "Email Address is not correct"},'isEmail')];

var XXXX = new Schema({
email : {type: String, required: true, validate: emailValidator} }); 
```

我的前端处理的是必需的，所以我从没想过猫鼬的“必需”错误会出现在用户面前，更像是后端的安全防护。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-07T20:54:17.963

您需要问自己的问题是，谁首先对导致错误负责？

如果这种情况发生在您的系统中，您可以控制，只需像往常一样让错误发生在您身上，并在您进行过程中清除错误，但我怀疑您正在做一个面向现实世界用户的应用程序和你想清理他们的输入。

我建议客户端在将输入发送到服务器之前检查输入是否正确，并显示很好的帮助消息，例如“您的用户名必须介于 x 和 y 字符之间”。

然后在服务器端，您希望在 99% 的情况下输入将直接来自您的清理客户端，因此您仍然使用您已经建议的技术对其进行验证，但如果出现错误，您只需返回一般错误消息到用户界面 - 因为您相信您的用户界面会显示帮助消息，所以验证错误必须是由错误或黑客攻击引起的。

请记住记录所有服务器端验证错误，因为它们可能是严重的错误或正在寻找漏洞的人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-04T10:57:00.627

警告：从 Mongoose 4.1.3 开始，函数 ValidatorError 的签名已经完全改变，以下信息不再适用：

从 Mongoose 3.8.12 开始，函数 ValidatorError 的签名是：

```
function ValidatorError (path, msg, type, val) 
```

其中 type 可以是“notvalid”或“required”

例如，如果您的“电子邮件”字段验证引发验证错误，您可以简单地执行以下操作：

```
var error = new ValidationError(this);
error.errors.email = 
      new ValidatorError('email', "Your err message.", 'notvalid', this.email); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-12-16T06:33:57.163

请参阅[hmv](https://www.npmjs.com/package/hmve)包，它可以帮助您自定义 mongoose 错误消息模板，包括唯一索引错误：

```
template : {PATH_NAME} must be at least {MIN_LENGTH} characters long
schema   : { fullname : { type : String, min : 3, $name : 'Full name' } }
message  : Full name must be at least 3 characters long

template : {PATH_NAME} {VALUE} have been used, please choose another
schema   : { username : { type : String, unique : true } }
message  : username MrBean have been used, please choose another 
```

并且特别支持本地化，例如越南语：

```
template : {PATH_NAME} dài ít nhất {MIN_LENGTH} kí tự
schema   : { fullname : { type : String, min : 3, $name : 'tên tài khoản' } }
message  : Tên tài khoản dài ít nhất 5 kí tự 
```

好处是您只需要自定义一次消息模板，而不是像以前的方法那样自定义每个模式的每个字段。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-06-18T00:17:57.300

从 mongoose 4.5.0 开始，Document#invalidate 返回一个 ValidationError。看到这个 [https://github.com/Automattic/mongoose/issues/3964](https://github.com/Automattic/mongoose/issues/3964)

此外，当尝试使 findOneAndUpdate 查询挂钩无效时，您可以执行以下操作：

```
// pass null because there is no document instance
let err = new ValidationError(null)
err.errors[path] = new ValidatorError({
    path: 'postalCode',
    message: 'postalCode not supported on zones',
    type: 'notvalid',
    value,
})
throw(err) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-09-17T11:37:20.300

你也可以[在这里](https://www.npmjs.com/package/joi)使用 joi 。对于验证节点应用程序中的模式，它实际上是非常有用的包。

例如：

```
const Joi = require("joi");

const validateUser = user => {

 const Schema = {
  email: Joi.string().email().required(),
  name: Joi.string().min(3).max(20).required(),
  password: Joi.string().min(8).max(25).required()
 }

 return Joi.validate(user, Schema);

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-14T23:28:20.680

// 我的 controller.js 或任何你的路由处理程序文件
// 这在 1 行中处理多个模式级别验证

```
// user object created from model
let user = new Users({
firstName: req.body.firstName,
lastName: req.body.lastName 
... 
```

});

```
 // Since the Error response are in <Model Name>:<Schema Name>:<Error Message>, ... 
  var err = user.validateSync();
  if (err && err.message) return res.send(err.message.split(':')[2].split(',')[0]); 
```

# java - 是我的清单 AsyncTask 理解正确吗？

> ID：15012253
> 
> 赞同：0
> 
> 时间：2013-02-21T21:07:46.170
> 
> 标签：java, android, list, android-asynctask

我以前通过简单地添加 int 或字符串以标准形式使用 List 数组，但我现在正在使用 List 方法查看集合。

我目前正在查看的代码实现了以下类：

```
public class GeoNamesAsyncTask extends AsyncTask<String, Void, List<GeoName>> {

private Context ctx = null;

public GeoNamesAsyncTask(Context ctx) {
    this.ctx = ctx;
}

@Override
protected List<GeoName> doInBackground(String... arg0) {
    return new GeoNamesService().searchPostalCode(arg0[0]);
}

@Override
protected void onPostExecute(List<GeoName> result) {
    this.populateActivity(result);
} 
```

此方法所在的类扩展了 AsyncTask 超类，并具有标准构造函数，可从调用它的类设置上下文。到目前为止，我理解它。

现在，当“doInBackGround”方法的 AsyncTask 类的重写方法时，我有点迷失了。

我了解该代码正在返回从 GeoNameService 类的“searchPostalCode”方法运行的地名列表（在此代码的情况下）。传递的字符串是用户输入的邮政编码。有人能告诉我为什么三个点是用字符串传递的吗？我会认为它只是'string arg0'而不是'string ... arg0'？

一旦 doInBackGround 方法返回，我是否认为“onPostExecute”方法总是在此之后直接调用？

我也读过用“doInBackGround”方法调用方法是不好的做法。

在我运行此代码并尝试输入字母和数字的组合（即“E4”）时，我在 doInBackGround 方法中遇到错误，但整数（例如“24501”）很好，如图所示。

```
02-21 20:05:18.461: E/AndroidRuntime(352): FATAL EXCEPTION: AsyncTask #1
02-21 20:05:18.461: E/AndroidRuntime(352): java.lang.RuntimeException: An error occured while executing doInBackground()
02-21 20:05:18.461: E/AndroidRuntime(352):  at android.os.AsyncTask$3.done(AsyncTask.java:200)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.lang.Thread.run(Thread.java:1096)
02-21 20:05:18.461: E/AndroidRuntime(352): Caused by: com.google.gson.JsonSyntaxException: java.lang.NumberFormatException: E4 6AA
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.TypeAdapters$7.read(TypeAdapters.java:232)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.TypeAdapters$7.read(TypeAdapters.java:222)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:93)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:172)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.read(TypeAdapterRuntimeTypeWrapper.java:40)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.CollectionTypeAdapterFactory$Adapter.read(CollectionTypeAdapterFactory.java:81)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.CollectionTypeAdapterFactory$Adapter.read(CollectionTypeAdapterFactory.java:60)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:93)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:172)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.Gson.fromJson(Gson.java:795)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.Gson.fromJson(Gson.java:761)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.Gson.fromJson(Gson.java:710)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.Gson.fromJson(Gson.java:682)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.example.restfulweb.GeoNamesService$DataWrapper.fromJson(GeoNamesService.java:85)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.example.restfulweb.GeoNamesService.searchPostalCode(GeoNamesService.java:41)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.example.restfulweb.GeoNamesAsyncTask.doInBackground(GeoNamesAsyncTask.java:21)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.example.restfulweb.GeoNamesAsyncTask.doInBackground(GeoNamesAsyncTask.java:1)
02-21 20:05:18.461: E/AndroidRuntime(352):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
02-21 20:05:18.461: E/AndroidRuntime(352):  ... 4 more
02-21 20:05:18.461: E/AndroidRuntime(352): Caused by: java.lang.NumberFormatException: E4 6AA
02-21 20:05:18.461: E/AndroidRuntime(352):  at org.apache.harmony.luni.util.FloatingPointParser.initialParse(FloatingPointParser.java:130)
02-21 20:05:18.461: E/AndroidRuntime(352):  at org.apache.harmony.luni.util.FloatingPointParser.parseDouble(FloatingPointParser.java:281)
02-21 20:05:18.461: E/AndroidRuntime(352):  at java.lang.Double.parseDouble(Double.java:287)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.stream.JsonReader.nextInt(JsonReader.java:599)
02-21 20:05:18.461: E/AndroidRuntime(352):  at com.google.gson.internal.bind.TypeAdapters$7.read(TypeAdapters.java:230) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:17:30.413

1.  3 个点 ( `...`) 用于变量参数，也称为`varargs`. 更多这里[Java，参数中的 3 个点](https://stackoverflow.com/questions/3158730/java-3-dots-in-parameters)

2.  `onPostExecute()``doInBackground()`在完成执行后调用。

3.  你可以调用任何方法`doInBackground()`，只是注意**不要**触摸GUI。

4.  在`searchPostalCode()`你的某个地方试图将*E4*解析为一个数字，这就是你得到异常的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:12:16.943

是的，您对 AsyncTask 所做的事情看起来是正确的。

只有 UI 线程应该修改 UI，并且 doInBackground 方法不在 UI 线程中运行。onPostExecute 是。

好吧，堆栈跟踪是不言自明的，JSON 试图将您的“E4”解析为一个数字，但未能这样做。看起来你应该只提供可解析的数字:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:13:35.253

> 传递的字符串是用户输入的邮政编码。有人能告诉我为什么三个点是用字符串传递的吗？我会认为它只是'string arg0'而不是'string ... arg0'？

它们被称为[可变的arity arguments](https://stackoverflow.com/questions/14739831/what-is-a-variable-arity-parameter)，并被提供以便 AsyncTask 在参数方面可以更加灵活。`arg0[0]`只要有 1 个或多个参数，通过访问是访问提供的参数的正确方法。

但如果你有不止一个，你可以遍历它们：

例如：

```
for (String s: arg0)
{
  System.out.println (s);
} 
```

> 一旦 doInBackGround 方法返回，我是否认为“onPostExecute”方法总是在此之后直接调用？

是的，请参阅[文档](http://developer.android.com/reference/android/os/AsyncTask.html)：

> onPostExecute(Result)，在后台计算完成后在 UI 线程上调用。后台计算的结果作为参数传递给该步骤。

> 我也读过用“doInBackGround”方法调用方法是不好的做法。

如果该方法修改了[UI 线程](https://stackoverflow.com/questions/3652560/what-is-the-android-uithread-ui-thread)，是的，那就不好了。

> 在我运行此代码并尝试输入字母和数字的组合（即“E4”）时，我在 doInBackGround 方法中遇到错误，但整数（例如“24501”）很好，如图所示。

```
02-21 20:05:18.461: E/AndroidRuntime(352): Caused by: java.lang.NumberFormatException: E4 6AA 
```

基于堆栈跟踪，使用不适用于字母`JsonReader.nextInt()`的底层方法。`Double.parseDouble()`

# ios - uiscrollview in viewcontroller in modal segue

> ID：15012266
> 
> 赞同：1
> 
> 时间：2013-02-21T21:08:32.803
> 
> 标签：ios, uiscrollview, uitableview, uistoryboard, uistoryboardsegue

I'm using Xcode 4.6 to build an iOS 6.x tabbar application and using Storyboard's. Inside each tabbed view, there is no problem adding a UIScrollView and interacting with any of the elements that are placed therein.

However... when I tap a button to transition to a new view in my storyboard using a Modal Segue, the scroll view doesn't work in the modal view.

**Example:**

Both TestViewController.h and TRViewController.h contain code similar to this:

```
@property (strong, nonatomic) IBOutlet UIScrollView *scroller; 
```

In the viewDidLoad method on in both TestViewController.m and TRViewController.m:

```
[_scroller setScrollEnabled:YES];
[_scroller setContentSize:CGSizeMake(320, 1000)]; 
```

Then in IB, the outlet is hooked up properly to the view:

![enter image description here](../Images/08e74959223e270d0eafa496ac2fb8c5.png)

So my code is replicated / the same across IB, .h, and .m for each of the views. Works in one area, but not the other. Beyond that, the only other block of what I think might be relevant to my problem might be from the segue:

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"trSegue"]) {        
    TRViewController *_trVC = segue.destinationViewController;
    _trVC.delegate = self;
    }
} 
```

Am I just missing something so totally obvious? I'm thinking it's going to be a palm to forward moment once I see the solution...

Thoughts / comments?

Thanks in advance! - Drew

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T20:41:02.947

我想到了。你必须把你的 UIScrollView 放在另一个空的 UIView 中。您的层次结构在界面构建器中将如下所示：

![在此处输入图像描述](../Images/3942a305efb39eb8b2128efc0da65194.png)

原因在于模态转场显示您的内容的方式。当你执行 push segue 时，它​​实际上将 ViewController 推送到导航堆栈的最顶层，而使用模态 segue 它会更改屏幕上显示的内容。我不确定这是否会导致苹果拒绝您的应用程序，但它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T02:12:59.353

好吧...我发现如果我只是将 segue 从 Modal 更改为 Push ...它可以很好地工作而无需任何额外的调整/调整。我想我会走这条路，而不是再胡思乱想。

也就是说，我仍然很想找到一种方法来做到这一点（如果可能的话）。

# toggle - 如何使用多个 div 切换 div 内容？

> ID：15012267
> 
> 赞同：0
> 
> 时间：2013-02-21T21:08:34.013
> 
> 标签：toggle, jquery

我想使用两个不同的 div**切换我的内容。**如果我单击带有“打开”类的 div，这个打开的内容并关闭内容，我单击带有“关闭”类的单独 div。

```
<div class="open"></div>
<div class="close"></div>

<div id="contents"></div> 
```

我怎样才能做到这一点？

这是我的脚本：

```
$('.open').toggle(function(){
    $('#contents').hide();
    $('.wrapper').animate({'width':'200px'}).end().find('.content').animate({ 'right': '30px' }) 
}, 
function() {
    $('#contents').show();      
    $('.wrapper').animate({'width':'40px'}).end().find('.content').animate({ 'right': '0' })    
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:13:12.680

您可以将单击事件处理程序绑定到单独的元素

```
$('div.open').click(function(){
   // your open code here
});
$('div.close').click(function(){
   // your close code here
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:14:44.257

用 2 次点击功能将它们分开

```
$('.close').click(function(){
    $('#contents').hide();
    $('.wrapper').animate({'width':'200px'}).end().find('.content').animate({ 'right': '30px' }) 
});
$('.open').click(function() {
    $('#contents').show();      
    $('.wrapper').animate({'width':'40px'}).end().find('.content').animate({ 'right': '0' })    
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:14:08.430

```
$(".open").click(function() {
    $("#contents").show();
});

$(".close").click(function() {
    $("#contents").hide();
}); 
```

# primefaces - Multiple single selection datatable primefaces

> ID：15012268
> 
> 赞同：1
> 
> 时间：2013-02-21T21:08:40.757
> 
> 标签：primefaces, datatable, selection

I have a datatable with 2 single selectionmode columns, what i want to do is select a pair of element of my table like this:

![enter image description here](../Images/605256dfa0eacaebb2dc0b901b6d9656.png)

So how can I get the 2 selected values from my table?

And if it is possible and u know how to not let the user select the 2 radio buttons in the same row whould be excelent!

Thx to all!

# android - 处理 OOME android 的最佳方法

> ID：15012269
> 
> 赞同：0
> 
> 时间：2013-02-21T21:08:42.133
> 
> 标签：android, android-alertdialog

我正在尝试在带有可绘制对象的自定义对话框中将图像设置为图像视图。我有以下方法

```
@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
        this.setCancelable(false);
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        LayoutInflater inflater = getActivity().getLayoutInflater();
        ViewGroup vg = (ViewGroup)inflater.inflate(R.layout.popup, null);
        image= (ImageView) vg.findViewById(R.id.image);
        Uri uri = Uri.parse("android.resource://"+this.getActivity().getPackageName()+"/drawable/p1");
        image.setImageURI(uri);
.
.
return builder.create();
} 
```

它大部分时间运行良好，但会导致 xxxx 字节分配内存不足。

我知道是因为这个

```
image.setImageURI(uri); 
```

摆脱这个问题的最佳方法是什么？

更新：：

```
I tried to recycle the bitmap by using this 

Bitmap bitmap = ((BitmapDrawable)image.getDrawable()).getBitmap();
        if(!bitmap.isRecycled()){
        bitmap.recycle();
        bitmap =null;
        } 
```

现在，如果我连续获得具有相同图像的拨号，则会出现此错误：

```
Canvas trying to use a recycled bitmap Runtime Exception. 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:17:23.550

最好的方法是查看应用程序正在使用多少内存以及它在哪里使用它。你可能在某处泄漏。如果没有，请弄清楚如何减少整体内存使用量。Eclipse 可以为您获取堆使用情况转储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T23:38:50.073

Eclipse 内存分析器 ( [http://www.eclipse.org/mat/](http://www.eclipse.org/mat/) ) 可以与 DDMS 和堆分析器一起帮助您找到泄漏。

要开始堆更新，您可以从 Eclipse 中切换到 DDMS 视图，并在其中选择与您的应用程序对应的进程，然后选择“显示堆更新”按钮。然后，每次单击“Cause GC”按钮时，您都会看到堆上对象的更新。

要使用 Eclipse 进行分析，您可以单击“转储 HPROF 文件”以使用 Eclipse 内存分析器加载它，这将为您提供更多关于可能泄漏的提示。

Android 开发者博客上的这篇博文更详细地介绍了：[http ://android-developers.blogspot.ca/2011/03/memory-analysis-for-android.html](http://android-developers.blogspot.ca/2011/03/memory-analysis-for-android.html)

# javascript - 如何将变量作为字符串注入？

> ID：15012270
> 
> 赞同：1
> 
> 时间：2013-02-21T21:08:42.270
> 
> 标签：javascript

我正在循环中使用动态创建的函数。

```
for (var i = 0; i < 4; i++) {
        window["functiontest" + i] = function () { alert(i); }
} 
```

它可以工作，但不是我想让它工作的方式。因为当我这样做时，这意味着`functiontest0`它将在运行时发出警报“3”，因为它实际上是`var i`在循环完成添加到`i`.

我想要的是以某种方式“硬编码”电流`i`，因此它实际上会警告“0”而不是“3”。我的意思是这样的：

```
window["functiontest" + i] = function () {
  // I need just the current state for `i` here and
  // not just the variable `i` - so for exampe I need
  // it as `i` literally put 0
} 
```

有什么办法可以强制它将结果写入“字符串”或其他内容？

THX 寻求帮助。很抱歉重复搜索时找不到任何东西。主要是因为我不能很好地解释它:-)

但我最终得到了这样的结果：

```
 for (var genfunc = 0; genfunc < 4; genfunc++) {

   if (genfunc == 0) { //left
       window["keyDown" + sys_curcontrols[genfunc]] = (function (unique) {
           return function () { window["sys_keyLeft" + unique] = -1; }
       })(nid);
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:10:30.250

一个完美的例子，说明您需要在哪里使用函数来创建范围。

```
for (var i = 0; i < 4; i++) {
    window["functiontest" + i] = (function(index) {
        return function () { alert(index); }
    })(i);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:11:01.360

您通过引用传递变量。使用匿名函数隐藏变量以传递值：

```
(function(i) {
    window['functiontest' + i] = function() {
        alert(i);
    };
})(i); 
```

另外，不要像这样制作全局变量。使用一个对象：

```
var functiontest = {};

(function(i) {
    functiontest[i] = function() {
        alert(i);
    };
})(i); 
```

# version-control - SQL Anywhere Versioning and Change Management

> ID：15012272
> 
> 赞同：3
> 
> 时间：2013-02-21T21:08:53.940
> 
> 标签：version-control, versioning, sqlanywhere

Are there any good versioning and change management tools for Sybase SQL Anywhere (specifically SQL Anywhere 10)?

Looking for something similar to RoundHouse for SQL Server.

We currently use TFS.

Thanks!

# sql - 计算SQL中分组的行数

> ID：15012274
> 
> 赞同：0
> 
> 时间：2013-02-21T21:08:58.383
> 
> 标签：sql, sql-server-2008, tsql, count, group-by

我有 2 个表，请求和响应

要求：

```
RequestId  UserId  InsertDate
1           1       5/4/2013
2           2       6/4/2012
.           .          .
.           .          . 
```

回应：

```
Responseid  Requestid(FK)  ResponseCode  
    1           1              A   
    2           1              V
    3           1              M   
    4           2              A
    5           2              S   
    6           2              D
    .           .              .
    .           .              . 
```

如果收到响应代码 A 和 D，则请求被视为“通过”（如我的示例中 id 为 2 的请求）。我想编写一个 sql 查询，它将返回 3 件事：

*   “通过”请求的数量
*   通过的请求的 RequestID
*   未通过的请求的 RequestID

我写了一些东西，但我不喜欢它，我想还有更好的方法。我的查询是：

```
SELECT COUNT(*) 
FROM
(
  SELECT count(*) as c, req.RequestID
  FROM Responses res inner join Requests req 
  on req.RequestID = res.RequestID
  where 
      res.ResponseCode = 'A' or
      res.ResponseCode = 'D' 

  group by req.RequestID
)cc

where c = 2 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:20:18.953

要返回同时具有响应代码 A 和 D 的请求 ID，一种方法是使用`HAVING`and `COUNT`：

```
SELECT res.requestId
FROM Responses res inner join Requests req 
  on req.RequestID = res.requestid
WHERE res.ResponseCode IN ('A','D')
GROUP BY res.requestId
HAVING COUNT(DISTINCT res.ResponseCode) = 2 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/b3a3a/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:19:24.013

我想不出另一种完全不同的方法（即没有等效的子查询或CTE）。但是，我将分别显式测试“A”和“D”值：

```
SELECT COUNT(*) as c, req.RequestID
FROM Responses res inner join
     Requests req 
     on req.RequestID = res.EquifaxIDCompareRequestID
where res.ResponseCode in ('A', 'D')
group by EquifaxIDCompareRequestID
having SUM(case when res.ResponseCode = 'D' then 1 else 0 end) > 0 and
       SUM(case when res.ResponseCode = 'A' then 1 else 0 end) 
```

该`having`子句类似于您的外部`where`子句，除了它检查“A”和“D”是否都在结果集中。

还有另一种方法使用连接或子查询。像这样的东西：

```
select EquifaxIDCompareRequestID
from Requests req
where EquifaxIDCompareRequestID in (select RequestID from responses where ResponseCode = 'A') and
      EquifaxIDCompareRequestID in (select RequestID from responses where ResponseCode = 'D') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:36:29.473

经过

```
SELECT r1.RequestID
FROM Responses R1
JOIN Responses R2
  on R2.RequestID = R1.RequestID
 and R1.ResponseCode = 'A' 
 and R2.ResponseCode = 'D'
compute count(r1.RequestID) 
```

（对计算语法不肯定）

没有通过

```
SELECT distinct (r1.RequestID)
FROM Responses R1
FULL OUTTER JOIN Responses R2
  on R2.RequestID = R1.RequestID
 and R1.ResponseCode = 'A' 
 and R2.ResponseCode = 'D'
WHERE R2.RequestID is null 
   OR R1.RequestID is null 
```

经过

```
SELECT r1.RequestID
FROM  Responses R1
WHERE R1.ResponseCode = 'A' 
INTERSECT 
SELECT r1.RequestID
FROM  Responses R1
WHERE R1.ResponseCode = 'D' 
```

没有通过

```
SELECT r1.RequestID
FROM  Responses R1
EXCEPT
SELECT r1.RequestID
FROM  Responses R1
WHERE R1.ResponseCode = 'D'
   OR R1.ResponseCode = 'A' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T22:52:28.143

下面给出了，对于每个 requestId，它是否通过以及它所在组中的总数（通过或失败）（即，如果通过，则通过的请求总数；如果失败，则总数失败的请求）。

```
with myCTE as
(
    select rq.requestId, case when rA.responseCode='A' and rD.responseCode='D' then 1 else 0 end as passed
    from dbo.Requests as rq
    outer apply
    (
        select top (1) re.responseCode
        from dbo.Responses as re
        where re.requestId=rq.requestId
            and re.responseCode='A'
    ) as rA
    outer apply
    (
        select top (1) re.responseCode
        from dbo.Responses as re
        where re.requestId=rq.requestId
            and re.responseCode='D'
    ) as rD
)
select *, count(*) over (partition by m.passed) as totalNumInGroup
from myCTE as m 
```

# visual-studio-2012 - 在 VS2012 中打开解决方案时使用 fAdded == 1 调用 OnAfterOpenProject

> ID：15012275
> 
> 赞同：2
> 
> 时间：2013-02-21T21:08:58.430
> 
> 标签：visual-studio-2012, visual-studio-extensions

我目前正在将 VS2010 扩展移植到 VS2012，并且我已经看到在加载我的解决方案时`IVsSolutionEvents.OnAfterOpenProject(IVsHierarchy pHierarchy, int fAdded)`调用了回调。`fAdded == 1`我相信这一定是由于VS2012中项目的异步加载。VS2010 不会发生这种情况。

我的问题是我怎么知道`OnAfterOpenProject`它是从异步项目加载过程中调用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T15:56:57.340

请查看 Microsoft VSX 论坛的以下链接：http: [//social.msdn.microsoft.com/Forums/br/vsx/thread/2d38f312-e566-4f65-bf2a-92041c51d7cc](http://social.msdn.microsoft.com/Forums/br/vsx/thread/2d38f312-e566-4f65-bf2a-92041c51d7cc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-03T15:58:57.637

（虽然迟到了）从[这里](https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivssolutionevents.onafteropenproject.aspx)`IVsSolutionEvents.OnAfterOpenProject`的 MSDN参考资料来看，行为似乎是正确的，文档解释说（至少到现在为止）：

> f添加
> 
> 类型：System.Int32
> 
> [在]如果在打开解决方案后将项目添加到解决方案中，则为**true 。**如果在打开解决方案时将项目添加到解决方案，则返回**false 。**

从您的报告来看，似乎**false**（解决方案仍在加载）映射到**1**，所以我猜**true**将映射到**0**。这在某种程度上与中的定义一致`VSConstants`：

```
public const int S_FALSE = 1;
public const int S_OK = 0; 
```

最后，在您的`OnAfterOpenProject`实现中，您可以根据该`fAdded`输入的值过滤调用：如果使用**1**调用，则意味着解决方案仍在（异步）加载，否则意味着新项目已添加到（已加载）解决方案.

# ruby-on-rails - act_as_votable 大拇指向上/向下按钮

> ID：15012276
> 
> 赞同：2
> 
> 时间：2013-02-21T21:08:59.380
> 
> 标签：ruby-on-rails, voting, social-media-like

我安装了acts_as_votable gem，它可以在控制台中正常工作（就像它在文档中所说的那样）。所以我的问题是如何为 upvote 和 downvote 按钮设置表单？或者它们可以只是链接吗？

这是文档：github.com/ryanto/acts_as_votable/blob/master/README.markdown

我有一个用户和一个图片模型；用户应该能够喜欢该图片。图片视图中的代码，按钮应该在哪里：

```
<% for picture in @pictures %> 
<p> 
<%= image_tag picture.image_url(:thumb).to_s %> 
</p> 
<%= picture.created_at.strftime("%a, %d %b. %Y") %>, by 
<%= link_to picture.user.name, picture.user %> 
<h2> <%= link_to picture.name, picture %></h2> 

[buttons here] 

<%= picture.votes.size %> <% end %> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T15:36:55.500

一种方法是为赞成和反对票添加您自己的控制器操作。我假设您`current_user`的控制器中有可用的方法。

```
# pictures_controller.rb
def upvote
  @picture = Picture.find(params[:id])
  @picture.liked_by current_user
  redirect_to @picture
end

def downvote
  @picture = Picture.find(params[:id])
  @picture.downvote_from current_user
  redirect_to @picture
end

# config/routes.rb

resources :pictures do
  member do
    put "like", to: "pictures#upvote"
    put "dislike", to: "pictures#downvote"
  end
end

# some view

<%= link_to "Upvote", like_picture_path(@picture), method: :put %>
<%= link_to "Downvote", dislike_picture_path(@picture), method: :put %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T00:19:36.373

这也是我最终使用acts_as_commentable gem 的方式。所以我认为这应该适用于您有评论的任何对象。

在我的 _comment.html.erb 视图中

```
<%= link_to "Upvote", {:controller =>"comments", :action => "upvote", :id => comment.id}, :class => 'btn', method: :put %>
<%= link_to "Downvote", {:controller =>"comments", :action => "downvote", :id => comment.id}, :class => 'btn', method: :put %> 
```

在我的 routes.rb 文件中

```
put '/comments/:id/:action' => 'comments#upvote'
put '/comments/:id/:action' => 'comments#downvote' 
```

然后在我的评论控制器中

```
class CommentsController < ApplicationController
  before_filter :load_commentable
  before_filter :find_comment, :only => [:upvote, :downvote]

  def upvote
    current_user.upvotes @comment
    redirect_to(@comment.commentable)
  end

  def downvote
    @comment.downvote_from current_user
    redirect_to(@comment.commentable)
  end

private

  def load_commentable
    resource, id = request.path.split('/')[1, 2]
    @commentable = resource.singularize.classify.constantize.find(id)
  end

  def find_comment
    @comment = Comment.find(@commentable.id)
  end

end 
```

before 过滤器允许更多功能，因此我可以将其添加到任何可注释的对象中。我碰巧是节日，但你可以做照片或任何事情。查看acts_as_commentable 文档和多态railscast 以获得更多信息。这是我的第一篇文章，所以如果这是糟糕的代码，请告诉我。

# ios - iOS 库或 DIY Etsy 之类的类别控制？

> ID：15012279
> 
> 赞同：1
> 
> 时间：2013-02-21T21:09:18.717
> 
> 标签：ios, xcode, github, libraries

我正在尝试为 Etsy 在其 iPhone 应用程序中的滑动类别视图找到一个库或示例项目。

![在此处输入图像描述](../Images/1f1527543f418ded73daef8bad954d33.png)

我说的是在应用程序的主视图顶部重新创建“精选、历史和季节性”类别滑动效果。

如果有人知道 Github 上的一个，或者可能知道如何做这样的事情，那就太棒了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T22:00:08.513

如果您只想要类别而不是整个 TableView，那么您不需要 3rd 方控件。你只需要一个 UIScrollView。

这个想法是您创建一个启用分页的滚动视图，并将其设置为不剪辑内容并将其置于屏幕中心。现在因为我们需要能够捕获超出滚动视图左边缘的触摸（当用户已经滚动时），所以我们需要一个技巧来捕获触摸。这是通过使用一个全屏宽度的 UIView 来完成的，它会将截获的触摸传递给我们的滚动视图。

有了这个设置，下面是代码：首先是捕获触摸的视图（我将其命名为 ExtendedScrollViewCaptureView）：

```
#import <UIKit/UIKit.h>

@interface ExtendedScrollViewCaptureView : UIView {

}

@property (nonatomic,strong)UIScrollView *scrollView;

@end 
```

这是实现文件：

```
#import "ExtendedScrollViewCaptureView.h"

@implementation ExtendedScrollViewCaptureView

@synthesize scrollView;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

- (UIView *) hitTest:(CGPoint) point withEvent:(UIEvent *)event {
    if ([self pointInside:point withEvent:event]) {
        return scrollView;
    }
    return nil;
}

@end 
```

现在让我们来看看主要的事情。在 viewController 头文件中创建一个 UIScrollView iVar：

```
@property(nonatomic,strong)UIScrollView *scrollView; 
```

还添加 2 个整数变量来监控可用的最大标题并跟踪所选选项卡：

```
@interface MyViewController : UIViewController<UIScrollViewDelegate>
{
    int selectedIndex;
    int maxIndex;
} 
```

并在您的实现文件中：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    ExtendedScrollViewCaptureView *extendedView = [[ExtendedScrollViewCaptureView alloc] initWithFrame:self.navigationBar.bounds];
    extendedView.backgroundColor = [UIColor clearColor];
    extendedView.clipsToBounds = YES;

    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(labelTapped:)];
    [extendedView addGestureRecognizer:tap];

    self.scrollView = [[UIScrollView alloc] init];
    self.scrollView.frame = CGRectMake(0,0,320,36);
    self.scrollView.pagingEnabled = YES;
    self.scrollView.showsVerticalScrollIndicator = NO;
    self.scrollView.showsHorizontalScrollIndicator = NO;
    self.scrollView.bounces = YES;
    self.scrollView.alwaysBounceHorizontal = YES;
    self.scrollView.alwaysBounceVertical = NO;
    self.scrollView.backgroundColor = [UIColor clearColor];
    self.scrollView.delegate = self;
    self.scrollView.scrollsToTop = NO;
    //add the scrollView inside the extendedView
    [extendedView addSubview:self.scrollView];

    //get the pointer reference
    extendedView.scrollView = self.scrollView;

    //add the arrow inside the extendedView
    UIImageView *arrow = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"arrow.png"]];
    arrow.frame = CGRectMake(154, 36, 11, 6);
    [extendedView addSubview:arrow];

     //add the extendedSubView to the view
     [self.view addSubview:extendedView];

     //init the scrollView with some entries:
     [self setUpScrollView:[NSArray arrayWithObjects:@"LABEL 1",@"LABEL 2",@"LABEL 3",@"LABEL 4",@"LABEL 5",nil]];
} 
```

现在创建函数以使用标题标签（标签作为 NSArray 传递）初始化您的 ScrollView

```
- (void)setUpScrollView:(NSArray *)titleLabels {

    int scrollSize = 320;
    int i = 0;
    int offsetX = 0;
    int scrollViewWidth = 0;
    maxIndex = titleLabels.count;

    //if our scrollview has already the labels stop here
    if ([self.scrollView subviews].count>0) {
        self.scrollView.contentOffset = CGPointZero;
        return;
    }
    //get the max width of the labels, which will define our label width
    for (NSString *titleLabel in titleLabels) {
        CGSize expectedLabelSize = [[titleLabel capitalizedString] sizeWithFont:[UIFont fontWithName:kFontFamily1 size:kFontFamily1Correction+13] constrainedToSize:CGSizeMake(320, 22)];
        scrollViewWidth = MAX(scrollViewWidth,expectedLabelSize.width);
    }

    //restrict max width for title items to 106 pixels (to fit 3 labels in the screen)
    //this is optional and can adjusted or removed, but I suggest to make labels equal width

    scrollViewWidth = MIN(scrollViewWidth, 106);

    //now draw the labels
    for (NSString *titleLabel in titleLabels) {

        UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(offsetX, 5, scrollViewWidth, 34)];

        label.text = [titleLabel capitalizedString];
        label.adjustsFontSizeToFitWidth = NO;
        label.numberOfLines = 2;
        label.backgroundColor = [UIColor clearColor];
        label.font = [UIFont fontWithName:@"ArialMT" size:13];

        if (i==selectedItem) {
            label.textColor = [UIColor redColor];
        }
        else {
            label.textColor = [UIColor whiteColor];
        }

        label.textAlignment = UITextAlignmentCenter;
        label.tag = 23000+i;

        [self.scrollView addSubview:label];

        offsetX+=scrollViewWidth;

        i++;
    }

    self.scrollView.frame = CGRectMake((320-scrollViewWidth)/2, 0, scrollViewWidth, 36);
    self.scrollView.clipsToBounds = NO;        
    self.scrollView.contentSize = CGSizeMake(MAX(scrollSize,offsetX), 36);
    self.scrollView.contentOffset = CGPointMake(scrollViewWidth*selectedItem, 0);
} 
```

现在从委托中捕获 UIScrollView 滚动事件：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {

    //get the index of the label we scrolled into!
    int visiblePageIndex = round(scrollView.contentOffset.x/scrollView.bounds.size.width);
    //set page number..
    if (selectedIndex!=visiblePageIndex) {

        //get the label and set it to red
        UILabel *label = (UILabel*)[self.scrollView viewWithTag:23000+visiblePageIndex];
        label.textColor = [UIColor redColor];

        //get the previous Label and set it back to White
        UILabel *oldLabel = (UILabel*)[self.scrollView viewWithTag:23000+selectedIndex];
        oldLabel.textColor = [UIColor whiteColor];

        //set the new index to the index holder
        selectedIndex = visiblePageIndex;
    }

} 
```

最后我们需要捕获标题点击事件的函数：

```
- (void)labelTapped:(UITapGestureRecognizer*)gestureRecognizer {
    CGPoint pressPoint = [gestureRecognizer locationInView:gestureRecognizer.view];

    if (pressPoint.x>(self.scrollView.frame.size.width+self.view.frame.size.width)/2) {
        //move to next page if one is available...
        if (selectedIndex+1<maxIndex) {
            float currentOffset = self.scrollView.contentOffset.x+self.scrollView.frame.size.width;
            [self.scrollView setContentOffset:CGPointMake(currentOffset, 0) animated:YES];
        }        
    }
    else if (pressPoint.x<(self.view.frame.size.width-self.scrollView.frame.size.width)/2) {
        //move to previous page if one is available
        if (selectedIndex>0) {
            float currentOffset = self.scrollView.contentOffset.x-self.scrollView.frame.size.width;
            [self.scrollView setContentOffset:CGPointMake(currentOffset, 0) animated:YES];
        }
    }
} 
```

而已！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:18:03.253

[在https://github.com/rs/SDSegmentedControl](https://github.com/rs/SDSegmentedControl)的 github 上有一个类似的控件。他们使用 UISegmentedControl 子类来创建效果。Cocoacontrols.com 是您的朋友。:)

# perl - Perl fork and kill - kill(0, $pid) always returns 1, and can't kill the child

> ID：15012289
> 
> 赞同：4
> 
> 时间：2013-02-21T21:10:01.757
> 
> 标签：perl

I am running a perl script on a Linux host. I'm trying to write a script that forks, where the child starts a program that takes forever and the parent times out after 5 seconds, killing the child. Here is what I have:

```
my $start = time();
my $timeOut = 5;

my $childPid = fork();
if ($childPid) {
    # I am the parent, and $childPid is my child
    while (kill(0, $childPid)) {
        if (time() > $start + $timeOut) {
            $numKilled = kill(SIGTERM, $childPid);
            printf("numKilled: %s\n", $numKilled);
        }
        sleep 1;
    }
}
else {
    # I am the child - do something that blocks forever
    `adb -s 410bf6c1 logcat`;
    exit;
} 
```

Output:

```
aschirma@graphics9-lnx:~$ perl perl-fork-test.pl 
numKilled: 1
numKilled: 1
numKilled: 1
numKilled: 1
numKilled: 1
... 
```

The behavior I expect is that I see "numKilled: 1" exactly once, and the child process (and any of its children) is killed after roughly 5 seconds. But I see from experiment that neither the child nor its children are getting killed. The `kill(SIGTERM, $childPid)` appears to do nothing.

How can I actually kill the child?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T22:13:43.027

Should be something like this. This isn't following best practices, but it should help you with your problem...

```
#!/usr/bin/perl

use warnings;
use strict;
use POSIX qw(:sys_wait_h);

my $timeOut = 5;
$SIG{ALRM} = \&timeout;
$SIG{CHLD} = 'IGNORE',
alarm($timeOut);

my $childPid = fork();
if ($childPid) {
    while(1) {
        print "[$$]: parent...\n"; 
        sleep(2); 
    }
}else {
    # I am the child - do something that blocks forever
    while(1){
        print "[$$]: child...\n";
        sleep(2);
    }
    exit;
}

sub timeout {
    print "killing $childPid\n";
    print "###\n" . `ps -ef | grep -v grep | grep perl` . "###\n";
    if ( ! (waitpid($childPid, WNOHANG)) ) {
        print "killing $childPid...\n";
        kill 9, $childPid;
        die "[$$]: exiting\n";
    }
} 
```

OUTPUT:

```
$ forktest.pl
[24118]: parent...
[24119]: child...
[24118]: parent...
[24119]: child...
[24118]: parent...
[24119]: child...
killing 24119
###
cblack   24118 12548  0 14:12 pts/8    00:00:00 /usr/bin/perl ./forktest.pl
cblack   24119 24118  0 14:12 pts/8    00:00:00 /usr/bin/perl ./forktest.pl
###
killing 24119...
[24118]: exiting 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-21T21:58:07.377

From [perldoc fork](http://perldoc.perl.org/functions/fork.html "perldoc fork"):

> If you fork without ever waiting on your children, you will accumulate zombies. On some systems, you can avoid this by setting $SIG{CHLD} to "IGNORE" .

I was able to get the desired behavior when adding `$SIG{CHLD} = 'IGNORE';` to the top of your code.

```
[ben@imac ~]$ perl test.pl
numKilled: 1
[ben@imac ~]$ 
```

Alternatively, adding `waitpid($childPid, 0);` after `kill` did the trick as well.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:28:39.837

Chances are that you are `use`ing neither `strict` nor `POSIX` in your script, so `SIGTERM` is being interpreted as the bareword `"SIGTERM"`, which isn't behaving in a useful way.

`use strict` to make this accidental bareword into an error, then `use POSIX` to pull in the `SIGTERM` constant.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T21:46:23.487

I am also seeing this behaviour, that kill 0 returns true even after the process was gone; I suspected you might be missing a call to waitpid (often done in a SIGCHLD handler) which would result in this, but even after adding it, the kill 0 continues to return true.

I suggest you use non-blocking waitpid instead of kill (and verify that the process actually does die on a SIGTERM signal - some may not, at least immediately). You may also want to try SIGINT after a while if SIGTERM didn't work, and in the last resort SIGKILL.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T01:05:07.527

Try killing the process group (use -$pid):

```
kill TERM => -$pid; 
```

See perlipc.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-27T07:37:39.570

I think the problem is with the '0' you are passing as first argument of 'kill'. When I read the docs, they say that '0' will just check to see whether you can send a signal to the process, without sending it. In your case, you want to send the 'KILL' signal to the child process, so do this:

```
kill( 'KILL', $childPid ); 
```

# regex - 无法匹配正则表达式

> ID：15012293
> 
> 赞同：0
> 
> 时间：2013-02-21T21:10:12.467
> 
> 标签：regex

我有一个包含很多这样的重复块的文件

```
<li>
<span>תמונה מאירוע</span>
<a href="images/gallerys/events/big/109.jpg"
title="תמונה מאירוע"><img
src="images/gallerys/events/thumbnails/109.jpg" alt="cars" />
</a>
</li> 
```

我想查找图像 url 和拇指 url 的文本对我的模式是：

```
href='(.*)'(.*)title(.*)src='(.*?)' 
```

问题是从第一个href到最后一个src的文本返回给我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:24:17.653

你的例子中没有`'`。在这种情况下，title 属性位于新行中，因此您将永远无法正确匹配它。这些只是几个例子，但还有更多需要处理，而且使用纯正则表达式是不可能做到的。

无论您使用哪种语言（可能除了 bash/sed/awk... 系列），它都支持将 HTML 解析为 DOM 树，这样您就可以轻松找到所需的节点。

*注意：正如其他人指出的那样，问题之一`.*`是贪婪，这意味着它会尽可能多地吃掉我们的角色。如果你真的很顽固，你可以使用非贪婪版本`.*?`或字符集匹配来解决这个问题，例如`[^"']*`.*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:42:02.290

Javascript 实现

```
var m,
    pairs = [],
    rex = /<li>[\s\S]*?<a href="([^"]+)"[\s\S]+?<img\s+src="([^"]+)"/g,
    str = '<li>\n' +
          '<span>תמונה מאירוע</span>\n' +
          '<a href="images/gallerys/events/big/109.jpg"\n' +
          'title="תמונה מאירוע"><img\n' +
          'src="images/gallerys/events/thumbnails/109.jpg" alt="cars" />\n' +
          '</a>\n' +
          '</li>';

while ( m = rex.exec( str ) ) {
    pairs.push( [ m[1], m[2] ] );
}

console.log( pairs ); 
```

假设 url 中没有引号。

使用适当的 HTML 解析器会更可靠。

# java - 用户逻辑而不是硬编码逻辑（如 Excel 条件格式）

> ID：15012297
> 
> 赞同：0
> 
> 时间：2013-02-21T21:10:26.403
> 
> 标签：java, algorithm, data-structures

简而言之，我想知道用于编码用户定义标准（例如 Excel 的条件格式）的标准方法是什么

例如，假设我有一个佣金系统，代码如下：

```
if (sales < 100 && empCategory = "junior") {
   commRate = 0.50;
} else if (sales < 100 && empCategory = "senior") { 
   commRate = 0.60;
} else if (sales >= 100 && sales <1000) { 
   commRate = 0.70;
} else {
   commRate = 0.80;
} 
```

因此，在此示例中，确定佣金率的逻辑是硬编码的。但是，我想将此逻辑从硬编码代码中取出，并允许用户使用布尔和比较运算符对数据库中的字段添加、修改和删除这些条件（再次，就像 Excel 条件格式一样）

注意我以变量的设置为例。相反，我可以根据标准调用另一个程序吗？

另外，请注意上面的例子非常简单。现实生活中的计算将涉及一个更复杂的公式，该公式将大多数布尔/比较运算符与嵌套语句一起使用。如果不满足任何条件，几乎总会出现“其他”情况。最后，这将应用于每一行都是一个相当大的记录集。

为此设计 GUI 不是问题，但我不确定：

1.  在哪里存储用户的条件（在 db 表中、在 XML 中等...）？

2.  如果布尔/比较运算符以及布尔语句（即嵌套语句）的结构没有硬编码，如何设置 commRate 变量

如果我实际上没有在我的实际代码中使用布尔/比较运算符，我很难做到这一点，但我知道这是可能的。我知道您可以使用二叉树数据结构来处理数学公式，但我不确定我是否走在正确的轨道上。

我会很感激任何建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:17:43.273

假设您有以下形式的规则，取自 GUI 或您的数据库或文件（等）：

```
condition1 = sales < 100 && empCategory == "Junior"
outcome1 = 0.50 
```

然后，您可以在运行时使用[ScriptEngine](http://docs.oracle.com/javase/7/docs/api/javax/script/ScriptEngine.html)评估它们：

```
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;

public class Test {

    public static void main(String[] args) throws Exception {
        ScriptEngineManager factory = new ScriptEngineManager();
        ScriptEngine engine = factory.getEngineByName("JavaScript");

        //actual value of the parameter
        double sales = 90;
        String empCategory = "Junior";

        //pass the actual values to the engine
        engine.eval("sales = " + sales);
        engine.eval("empCategory = " + empCategory);

        //get the rules from the DB / GUI
        String condition1Str = "sales < 100 && empCategory == \"Junior\"";
        double outcome1 = 0.50;

        //check the actual value vs. the rules
        Boolean condition1 = (Boolean) engine.eval(condition1Str);

        //rest of your logic here
        if (condition1) commRate = outcome1;
    }
} 
```

这是一个人为的示例，但可以让您了解它是如何工作的。如果您有许多不同的规则，则临时库可能更适合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:18:26.677

从技术上讲，java 没有将函数或部分函数作为参数的方法。如果你知道如何使用 scala，你可以将 scala 结合到 java 中。它可能比购买一些规则引擎等便宜得多。顺便说一句，scala 是由构建 java 的同一个人构建的；所以你真的应该调查一下。

# cuda - 在 CUDA 中动态确定最大线程数？

> ID：15012299
> 
> 赞同：0
> 
> 时间：2013-02-21T21:10:27.233
> 
> 标签：cuda

是否可以动态确定每个块的最大线程数？即向GPU询问值并将其存储在变量中的函数。谢谢你的帮助。

* * *

谢谢，我使用以下代码确定了最大线程数：

```
int dev = 0;
cudaDeviceProp deviceProp;
cudaGetDeviceProperties(&deviceProp, dev);

unsigned int maxThreads = deviceProp.maxThreadsPerBlock; 
```

并使用这个数字，我用以下几行计算内核的块和线程：

```
unsigned int blocksNum = 1+((mSize-1)/maxThreads); // mSize is the size of array
unsigned int threadsNum = 1+((mSize-1)/blocksNum);
dim3 dimGrid(blocksNum, 1, 1);
dim3 dimBlock(threadsNum, 1, 1);
...
kernel<<<dimGrid,dimBlock>>>(); 
```

这种形式调用内核是否正确？

谢谢你的帮助。

* * *

好的，我使用的是 Nvidia 的 6 号求和内核，并使用了示例代码，它使用下一个代码确定线程和块：

```
unsigned int threadsNum = (mSize < maxThreads*2) ? nextPow2((mSize + 1)/ 2) : maxThreads;
unsigned int blocksNum = (mSize + (threadsNum * 2 - 1)) / (threadsNum * 2); 
```

此代码适用于我的数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T22:19:34.527

您可以使用 Driver API 来访问特定内核的属性（在 Driver API 术语中称为 Function）。

使用 API 调用[cuFuncGetAttribute](http://docs.nvidia.com/cuda/cuda-driver-api/index.html#group__CUDA__EXEC_1g5e92a1b0d8d1b82cb00dcfb2de15961b)，其[CUfunction_attribute](http://docs.nvidia.com/cuda/cuda-driver-api/index.html#group__CUDA__TYPES_1g9d955dde0904a9b43ca4d875ac1551bc)值等于 CU_FUNC_ATTRIBUTE_MAX_THREADS_PER_BLOCK。

这给了你：

> 每个块的最大线程数，超过这个数，函数的启动将失败。这个数字取决于函数和当前加载函数的设备。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:21:14.390

查询设备属性，查看[maxThreadsPerBlock](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html#structcudaDeviceProp)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:20:32.260

是的，值 ( maxThreadsPerBlock ) 是 cudaGetDeviceProperties 返回的[属性](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html#structcudaDeviceProp_118f38f08c66c8812b1ddeb16e4bf51a4)[之一](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html#group__CUDART__DEVICE_1g929dcd9a191e17b7498e7ccaa3d16350)。有关完整的示例，请查看[deviceQuery 示例](http://docs.nvidia.com/cuda/cuda-samples/index.html#device-query)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-20T14:20:12.910

如果您使用 CUDA 运行时 API 或 cuFuncGetAttribute 和 CU_FUNC_ATTRIBUTE_MAX_THREADS_PER_BLOCK，您需要的是 cudaFuncGetAttributes，如果您使用的是 CUDA 驱动程序 API，RoBiK 在他的回答中指出。这两个函数都记录在各自 API 文档的执行控制部分。

# android - Android旋转拨号器ontouch

> ID：15012302
> 
> 赞同：0
> 
> 时间：2013-02-21T21:10:51.927
> 
> 标签：android, image, bitmap, android-animation

我正在阅读有关旋转图像的教程（在我的情况下是轮子）

我需要角度，但每次我再次触摸轮子时，它都从 0 开始，但它必须从最后一个角度开始。

任何人都可以解释并告诉我如何做到这一点吗？

这是我的代码：

```
public class MainActivity extends Activity {

private static Bitmap imageOriginal, imageScaled;
private static Matrix matrix;
private ImageView dialer;
private int dialerHeight, dialerWidth;
private GestureDetector detector;
private boolean[] quadrantTouched;
private boolean allowRotating;
private double startAngle, currentAngle, current_Angle;
MotionEvent e;
boolean isClicked = false;
private SensorManager mSensorManager;
private ShakeEventListener mSensorListener;

@Override
public void onCreate(Bundle b) {
    super.onCreate(b);
    setContentView(R.layout.activity_soundboard);   
    this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

    /*
     * Dit regelt het roteren van het wiel.
     */
    if (imageOriginal == null) {
        imageOriginal = BitmapFactory.decodeResource(getResources(), R.drawable.wheelcircle);
    }
    // initialize the matrix only once
    if (matrix == null) {
        matrix = new Matrix();
    } else {
        // not needed, you can also post the matrix immediately to restore the old state
        matrix.reset();
    }
    detector = new GestureDetector(this, new MyGestureDetector());
    quadrantTouched = new boolean[] { false, false, false, false, false };
    allowRotating = true;
    dialer = (ImageView) findViewById(R.id.imageView);
    dialer.setOnTouchListener(new MyOnTouchListener());
    dialer.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
        @Override
        public void onGlobalLayout() {
            // method called more than once, but the values only need to be initialized one time
            if (dialerHeight == 0 || dialerWidth == 0) {
                dialerHeight = dialer.getHeight();
                dialerWidth = dialer.getWidth();
                // resize
                Matrix resize = new Matrix();
                resize.postScale((float)Math.min(dialerWidth, dialerHeight) /    (float)imageOriginal.getWidth(), (float)Math.min(dialerWidth, dialerHeight) / (float)imageOriginal.getHeight());
                imageScaled = Bitmap.createBitmap(imageOriginal, 0, 0, imageOriginal.getWidth(), imageOriginal.getHeight(), resize, false);
                // translate to the image view's center
                float translateX = dialerWidth / 2 - imageScaled.getWidth() / 2;
                float translateY = dialerHeight / 2 - imageScaled.getHeight() / 2;
                matrix.postTranslate(translateX, translateY);
                dialer.setImageBitmap(imageScaled);
                dialer.setImageMatrix(matrix);
            }
        }
    }); 
}

private class MyOnTouchListener implements View.OnTouchListener {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
        switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                for (int i = 0; i < quadrantTouched.length; i++) {
                    quadrantTouched[i] = false;
                }
                allowRotating = false;
                startAngle = getAngle(event.getX(), event.getY());
                break;
            case MotionEvent.ACTION_MOVE:
                currentAngle = getAngle(event.getX(), event.getY());
                rotateDialer((float) (startAngle - currentAngle));
                startAngle = currentAngle;
                break;
            case MotionEvent.ACTION_UP:
                break;
        }
        quadrantTouched[getQuadrant(event.getX() - (dialerWidth / 2), dialerHeight - event.getY() - (dialerHeight / 2))] = true;
        detector.onTouchEvent(event);
        Log.e("Angle", currentAngle + "");
        return true;
    }
}

private class MyGestureDetector extends SimpleOnGestureListener {
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        // get the quadrant of the start and the end of the fling
        int q1 = getQuadrant(e1.getX() - (dialerWidth / 2), dialerHeight - e1.getY() - (dialerHeight / 2));
        int q2 = getQuadrant(e2.getX() - (dialerWidth / 2), dialerHeight - e2.getY() - (dialerHeight / 2));
        // the inversed rotations
        if ((q1 == 2 && q2 == 2 && Math.abs(velocityX) < Math.abs(velocityY))
                || (q1 == 3 && q2 == 3)
                || (q1 == 1 && q2 == 3)
                || (q1 == 4 && q2 == 4 && Math.abs(velocityX) > Math.abs(velocityY))
                || ((q1 == 2 && q2 == 3) || (q1 == 3 && q2 == 2))
                || ((q1 == 3 && q2 == 4) || (q1 == 4 && q2 == 3))
                || (q1 == 2 && q2 == 4 && quadrantTouched[3])
                || (q1 == 4 && q2 == 2 && quadrantTouched[3])) {
            dialer.post(new FlingRunnable(-1 * (velocityX + velocityY)));
        } else {
            // the normal rotation
            dialer.post(new FlingRunnable(velocityX + velocityY));
        }
        return true;
    }
}

private class FlingRunnable implements Runnable {
    private float velocity;
    public FlingRunnable(float velocity) {
        this.velocity = velocity;
    }
    @Override
    public void run() {
        if (Math.abs(velocity) > 5 && allowRotating) {
            rotateDialer(velocity / 75);
            velocity /= 1.0666F;
            // post this instance again
            dialer.post(this);
        }
    }
}

private double getAngle(double xTouch, double yTouch) {
    double x = xTouch - (dialerWidth / 2d);
    double y = dialerHeight - yTouch - (dialerHeight / 2d);
    switch (getQuadrant(x, y)) {
        case 1:
            return Math.asin(y / Math.hypot(x, y)) * 180 / Math.PI;
        case 2:
            return 180 - Math.asin(y / Math.hypot(x, y)) * 180 / Math.PI;
        case 3:
            return 180 + (-1 * Math.asin(y / Math.hypot(x, y)) * 180 / Math.PI);
        case 4:
            return 360 + Math.asin(y / Math.hypot(x, y)) * 180 / Math.PI;
        default:
            return 0;
    }
}
/**
 * @return The selected quadrant.
 */
private static int getQuadrant(double x, double y) {
    if (x >= 0) {
        return y >= 0 ? 1 : 4;
    } else {
        return y >= 0 ? 2 : 3;
    }
}

private void rotateDialer(float degrees) {
    matrix.postRotate(degrees, dialerWidth / 2, dialerHeight / 2);
    dialer.setImageMatrix(matrix);
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:28:49.363

也许使用保存前一个角度的全局变量？

```
case MotionEvent.ACTION_DOWN:
                for (int i = 0; i < quadrantTouched.length; i++) {
                    quadrantTouched[i] = false;
                }
                allowRotating = false;
                startAngle = previousAngle;
                break;
            case MotionEvent.ACTION_MOVE:
                currentAngle = getAngle(event.getX(), event.getY());
                rotateDialer((float) (startAngle - currentAngle));                    
                startAngle = currentAngle;
                break;
            case MotionEvent.ACTION_UP:
                previousAngle = currentAngle;
                break; 
```

这可能不会像这样工作，但你明白了......

# c# - 如何使用 Mysql 和 EF C# 创建用于安装和拆卸的数据库

> ID：15012304
> 
> 赞同：1
> 
> 时间：2013-02-21T21:10:57.537
> 
> 标签：c#, mysql, entity-framework

在我目前的情况下，我正在尝试测试我的 linq to MySQL 查询的覆盖率（过去几周我遇到了一些令人尴尬的错误。）

在我的情况下，我已经从一个非常旧的 MySQL 数据库中自动生成了我的 .edmx 文件。我有这样的查询：

```
return (from f in dbname.footable
        join b in dbname.bartable on b.key == f.key
        where b.something == x && f.other == y
        select b.value).Sum().GetValueOrDefault(0); 
```

我不想在网络上的实际共享服务器上进行设置/拆卸，看起来 .edmx 文件应该包含所有架构信息来重新创建数据库。

基本上，我正在寻找一种方式来表达，“使用这个 edmx 并在本地重新创建它，这样我就可以开始在那里干扰测试数据。” 我也会接受告诉我我做错了的答案，你应该像 X 一样测试你的查询。

# php - 为什么我的 PHP QueryPath 2.1.2 WAMP 抓取脚本只返回 5 篇文章而不是 43 篇？超时？

> ID：15012307
> 
> 赞同：0
> 
> 时间：2013-02-21T21:11:06.997
> 
> 标签：php, scrape, querypath

我试图从我的博客中抓取 43 篇博客文章并将它们存储在数组中，但是当我 print_r 数组时它只返回前 5 个 [其余为空] 而不是全部 43 个。为什么？我怎样才能得到所有 43 个？我从 WAMP 上的 cmd.exe [命令行] 运行此脚本。

```
 <?php

require 'src/QueryPath/QueryPath.php';

$qp1 = htmlqp('http://myblog.com/blog');
$qp2 = htmlqp('http://myblog.com/blog/Page-2.html');
$qp3 = htmlqp('http://myblog.com/blog/Page-3.html');
$qp4 = htmlqp('http://myblog.com/blog/Page-4.html');

foreach ($qp1->find('ol>li a[href],.jbReadon') as $item) {
    $links[] = $item->attr('href');
}

foreach ($qp2->find('ol>li a[href],.jbReadon') as $item) {
    $links[] = $item->attr('href');
}

foreach ($qp3->find('ol>li a[href],.jbReadon') as $item) {
    $links[] = $item->attr('href');
}

foreach ($qp4->find('ol>li a[href],.jbReadon') as $item) {
    $links[] = $item->attr('href');
}

print_r($links);

foreach ($links as $link) {
    $url = "http://myblog.com".$link;

    $content[] = htmlqp($url)->find('.jbIntroText p')->text();
}
print_r($content);

?> 
```

在数组的第 5 个键之后，所有值都是空的。[我无法从笔记本电脑或网络上传图像，因此这里是 cmd.exe 屏幕截图的链接] [http://img546.imageshack.us/img546/6092/cmdafter5arrayisempty.jpg](http://img546.imageshack.us/img546/6092/cmdafter5arrayisempty.jpg)

我显然是一个初学者，所以任何建议如何使这段代码更简洁或如何更好地完成我的抓取原型将不胜感激。也欢迎所有建设性的批评:-P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T17:05:16.513

您可能希望将一些打印语句添加到这些 FOR 循环中的至少一个。这里可能会发生几件事。最有可能的两个是：

*   过滤器可能只匹配五个项目。
*   HTML 解析器可能会因某些标记而窒息。在这种情况下，它将尝试加载尽可能多的 HTML DOM。

通过添加一些打印语句，您可能能够看到它迭代了多少次。

顺便说一句，如果您想获取博客上的文章列表，阅读 RSS 或 Atom 提要可能会更容易（尽管我想它可能没有您需要的所有信息）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:07:46.507

我已经解决了我的问题！！显然，我需要的只是每次查询/抓取之间的时间延迟，因为我的博客正在保护自己免受大量抓取或其他任何事情。我所要做的就是像这样重写代码的第二部分：

```
foreach ($links as $link) {
    $url = "http://myblog.com".$link;
    $count = count($links);
    $interval = 2; // Every three times...
    $wait = 2; // Wait two seconds.
        for ($i = 0; $i < $count; ++$i) {
        $content[] = htmlqp($url)->find('.jbIntroText p')->text();
        print_r($content);
            if ($i > 0 && $i % $interval == 0) {
            sleep($wait);
            }

        }
} 
```

感谢 Technosophos 提供的想法 在[目标 Web 服务器上使用 Php/Querypath 爬虫的已知或预期影响是什么，如何将其保持在最低限度？](https://stackoverflow.com/questions/9901021/what-are-the-known-or-expected-impact-of-using-php-querypath-crawler-on-a-target)

还要感谢我应该将博客即时消息转换为 RSS/Atom 提要的想法，因为很多时候博客没有生成自己的 RSS 提要

# python - 从 Eclipse 运行时关闭 matplotlib 中预先存在的图形

> ID：15012309
> 
> 赞同：72
> 
> 时间：2013-02-21T21:11:10.180
> 
> 标签：python, numpy, matplotlib, pydev

我的问题很简单：我有一个使用 matplotlib 生成数字的 python 脚本。每次我运行它时，它都会生成带有数字的新窗口。如何让脚本关闭上次运行时打开的窗口？

matlab 中的类似命令是将“全部关闭”放在 matlab 脚本的开头。

我已经看到了一些建议来做类似的事情

```
import matplotlib.pyplot as plt
plt.close("all") 
```

如果您从 python shell 运行脚本，则此解决方案有效，例如使用

```
>>>> execfile("myScript.py") 
```

但是，我发现如果我使用 Eclipse/PyDev 运行脚本，这将不起作用。我怎样才能让它在 Eclipse 中工作？

例子：

```
from numpy import *
from matplotlib.pyplot import *
from scipy import *

close("all") 
    #close any previously open plots - this doesn't work when running via Eclipse

t = linspace(0, 0.1,1000)
w = 60*2*pi

figure()
plot(t,cos(w*t))
plot(t,cos(w*t-2*pi/3))
plot(t,cos(w*t-4*pi/3))
show() 
```

这应该为一个不错的三相电源绘制理想的波形。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-02-21T21:39:02.657

You can close a figure by calling `matplotlib.pyplot.close`, for example:

```
from numpy import *
import matplotlib.pyplot as plt
from scipy import *

t = linspace(0, 0.1,1000)
w = 60*2*pi

fig = plt.figure()
plt.plot(t,cos(w*t))
plt.plot(t,cos(w*t-2*pi/3))
plt.plot(t,cos(w*t-4*pi/3))
plt.show()
plt.close(fig) 
```

You can also close all open figures by calling `matplotlib.pyplot.close("all")`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-03T18:41:30.870

请参阅 Bi Rico 对一般 Eclipse 案例的回答。

对于任何人 - 像我一样 - 因为你有很多窗户并且你正在努力关闭它们而降落在这里，根据你的情况，仅仅杀死 python 可能是有效的。它几乎可以在任何情况下工作 - 包括 Eclipse。

我刚刚从 emacs 生成了 60 个图（我更喜欢 eclipse），然后我认为我的脚本已经退出。在我的 ipython 窗口中运行`close('all')`对我不起作用，因为这些图不是来自 ipython，所以我求助于寻找正在运行的 python 进程。

当我杀死运行脚本的解释器时，所有 60 个地块都关闭了 - 例如，

```
$ ps aux | grep python
rsage    11665  0.1  0.6 649904 109692 ?       SNl  10:54   0:03 /usr/bin/python3 /usr/bin/update-manager --no-update --no-focus-on-map
rsage    12111  0.9  0.5 390956 88212 pts/30   Sl+  11:08   0:17 /usr/bin/python /usr/bin/ipython -pylab
rsage    12410 31.8  2.4 576640 406304 pts/33  Sl+  11:38   0:06 python3 ../plot_motor_data.py
rsage    12431  0.0  0.0   8860   648 pts/32   S+   11:38   0:00 grep python

$ kill 12410 
```

请注意，我没有杀死我的 ipython/pylab，也没有杀死更新管理器（杀死更新管理器可能是个坏主意）...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-02T17:02:21.083

它不仅会杀死所有绘图窗口，还会杀死所有称为 python3 的进程，除了您运行的当前脚本。它适用于python3。因此，如果您正在运行任何其他 python3 脚本，它将被终止。由于我一次只运行一个脚本，它为我完成了这项工作。

```
import os
import subprocess
subprocess.call(["bash","-c",'pyIDs=($(pgrep python3));for x in "${pyIDs[@]}"; do if [ "$x" -ne '+str(os.getpid())+' ];then  kill -9 "$x"; fi done']) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-10-29T10:43:01.653

使用上面的脚本在我的情况下没有任何效果，但我可以通过单击**Terminate ALL**（两个红色嵌套正方形图标）从 Eclipse 控制台栏中关闭这些数字。

# java - 使用 Java 将 android 手机连接到服务器套接字

> ID：15012310
> 
> 赞同：0
> 
> 时间：2013-02-21T21:11:10.640
> 
> 标签：java, android, sockets, connect, serversocket

我在 Eclipse 中编写 Java 代码来创建一个 Android 浏览器，当按下浏览器的 Go 按钮时，该浏览器通过套接字与服务器通信。我看过几个例子，但仍然不知道我的代码有什么问题。我有正确的 IP 地址，并且在代码的服务器端和客户端使用相同的端口号。这是客户端代码减去导入语句：

```
public class MainActivity3 extends Activity {

    EditText URLText;

    Button GoButton;
    WebView Browser;
    int SERVERPORT = 33333;
    String servernum = "10.215.23.109";
    private boolean connected = true;

    private class MyWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_activity3);

        URLText = (EditText) findViewById(R.id.URL);
        GoButton = (Button) findViewById(R.id.Go);
        Browser = (WebView) findViewById(R.id.WebEngine);
        Browser.loadUrl("http://www.google.co.in/");

        GoButton.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {

                Browser.setWebViewClient(new MyWebViewClient());

                Thread cThread = new Thread(new ClientThread());
                cThread.start();

                Browser.loadUrl("http://" + URLText.getText().toString());

            }
        });
    }

    public class ClientThread implements Runnable {
        @Override
        public void run() {

            try {

                Log.d("ClientActivity", "C: Connecting...");
                Socket socket = new Socket(servernum, SERVERPORT);
            } catch (UnknownHostException e) {
                System.err.println(e);
            } catch (IOException e) {
                System.err.println(e);
            }
        }

        public boolean onCreateOptionsMenu(Menu menu) {
            getMenuInflater().inflate(R.menu.activity_main_activity3, menu);
            return true;
        }
    }
} 
```

这是服务器代码：

```
public static void main(String[] args) throws IOException {
    int port = 33334;
    ServerSocket serverSocket = new ServerSocket(port);
    System.out.println("Server socket created at port # "+ port );
    Socket socket = serverSocket.accept();
    System.out.println("Socket accepted");
    System.out.println("Output created");

    socket.close();
    serverSocket.close();  
} 
```

这基本上是一个测试代码，以确保手机将连接到服务器。当我在我的Linux终端上运行它时，它只输出“在端口＃33334创建的服务器套接字”并等待手机连接到永远不会发生的端口，即使我在浏览器上反复按go，这让我相信我的代码的客户端有问题。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:15:26.553

这看起来与[这篇文章](https://stackoverflow.com/questions/14947470/execute-a-http-request-within-an-app/14947523)非常相似。

您可以使用 DefaultHttpClient 直接与您的服务器通信，而不是创建 WebView：

```
try{
    DefaultHttpClient client = new DefaultHttpClient();
    HttpGet request = new HttpGet("http://10.215.23.109:33333");
    HttpResponse response = client.execute(request);
}catch(Exception e){
    // Handle the exception
    e.printStackTrace();
} 
```

# c# - 如何防止 MVC4 ApiController 序列化实体框架导航属性？

> ID：15012311
> 
> 赞同：1
> 
> 时间：2013-02-21T21:11:23.083
> 
> 标签：c#, asp.net-mvc, entity-framework, serialization, asp.net-mvc-4

我有一个适用于实体框架对象的 ApiController。我试图在 GET 请求中返回的特定对象有近十几个导航属性。

当我返回 EF 对象列表时，它会序列化**所有导航属性**，这会导致序列化对象花费大量时间，

```
 public IEnumerable<EFObject> Get()
    {
        IEnumerable<EFObject> EFObjects=
            db.EFObject;

        return EFObject;

    } 
```

如何防止 MVC 序列化这些导航属性？

我已经尝试过[了](https://stackoverflow.com/questions/10475571/exclude-property-from-json-serialization-in-apicontroller)，但它没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:15:27.177

> 如何防止 MVC 序列化这些导航属性？

当然是通过使用视图模型，然后让您的控制器操作返回此视图模型而不是您的域模型。视图模型将被专门定义为仅包含您想要的属性。您可能还会发现[`AutoMapper`](http://automapper.org/)在域模型和视图模型之间进行映射很有用。

最佳实践是始终从您的方法中公开视图模型，并且永远不要让您的域实体在这些方法之外可见。您将从这种方法中获得的另一个好处是，您的 API 将能够适应您的域模型中的更改，并且这可以在不破坏现有客户端的情况下完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T23:14:11.627

你可以试试这个[`[XmlIgnore]`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlignoreattribute.aspx)属性。

很大程度上取决于技术堆栈的其余部分等。我正在使用 WebApi 并将此代码放在 WebApiConfig.cs 文件中，并且导航属性被忽略。我总是返回 xml，而不是 json。

```
var xml = GlobalConfiguration.Configuration.Formatters.XmlFormatter;
xml.UseXmlSerializer = true; 
```

# java - 尝试编写一个使用特定规则模拟掷骰子的程序

> ID：15012313
> 
> 赞同：0
> 
> 时间：2013-02-21T21:11:32.390
> 
> 标签：java

这是问题：

在掷骰子游戏中，及格线下注过程如下：掷出两个六面骰子；掷骰子的第一轮骰子称为“出局”。7 或 11 的出局自动获胜，2,3 或 12 的出局自动失败。如果 4、5、6、8、9 或 10 在出局掷骰上掷出，则该数字成为“点数”。玩家不断掷骰子，直到掷出 7 点或点数。如果点数先滚动，则玩家赢得赌注。如果先掷出 7，则玩家输

编写一个程序，在没有人工输入的情况下使用这些规则模拟掷骰子。程序应该计算玩家是赢还是输，而不是要求下注。程序应该模拟掷两个骰子并计算总和。添加一个循环，以便程序播放几次。添加计数器来计算玩家赢了多少次，以及玩家输了多少次。在玩几次游戏结束时，计算获胜概率（wins/sins+losses））并输出值

这就是我到目前为止所做的

```
 import java.util.Scanner;

    public class partb1
 {

    public static void main(String[] args)
 {

int side1=1, side2=1 , roll=1, lose=0, win=0, point=0, answer;
     Double winprob, loseprob;

side1= 1+(int)(Math.random() *6);

     side2= 1+(int)(Math.random() *6);

     Scanner kb = new Scanner(System.in);

     do
     {
     roll = side1+side2;

     if ( roll == 7 || roll == 11)
     {
       System.out.println(" Come out wins");
     winprob = win + 1;

     }
     else if ( roll ==2 || roll ==3 || roll ==12)
     {
       System.out.println(" Come out loses ");
      loseprob = lose +1;

     }

     else
     {
          side1= 1+(int)(Math.random() *6);
     side2= 1+(int)(Math.random() *6);
     point = roll;
   roll = side1+side2;

       System.out.println("The point");
       System.out.println("You won the bet");
       winprob = win + 1;
   while(roll != point || roll!= 7);
        side1= 1+(int)(Math.random() *6);
     side2= 1+(int)(Math.random() *6);
    roll = side1+side2;

     }

     if( roll ==7)

     {
       System.out.println("You lost the bet");
     answer = kb.nextInt();
     } 
     else if (roll == point) {
        System.out.println(win);
    }

  while(true)
       {
    System.out.println(" Do you want to play again? 0 for No, any number for Yes ");

                     if (answer ==0)
                     {
                       break;
                     }

                     winprob = (40/(40+60));
                     System.out.println(" The probability of wining is " + winprob);

                     loseprob = (40/(40-60));
                     System.out.println(" The probability of losing is " + loseprob);

        }
      }
      }
       } 
```

我不断收到此错误

```
 1 error found:
    File: H:\assignment 3\partb1.java  [line: 84]
    Error: Syntax error, insert "while ( Expression ) ;" to complete DoStatement 
```

我不确定我是错过了什么还是做错了什么？有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:18:32.537

作为一个干净的编程问题，我建议不要创建类似的东西

```
public static void main(String[] args) {
    // do everything here
} 
```

将封装的概念应用到您的编程中，并将您的代码分解为可重用的块。您会发现调试代码要容易得多，其他程序员也会因此而爱上您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:14:27.250

`answer`is an `ìnt`not a`boolean`所以不能单独出现在`while`语句表达式中，但是由于您明确`break`退出循环，您可以执行以下操作：

```
while (true) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:33:41.867

您的代码中有多个错误，虽然我们很乐意帮助您完成作业；）如果您首先在适当的 IDE 中正确对齐代码，这样您就可以看到所有容易出现的错误，例如在哪里花括号不匹配或丢失。

我可以建议下载 IntelliJ IDEA（或同等产品），加载你的 java 程序，然后点击 CRTL-ALT-L 来“重新格式化”代码。这将使它更具可读性，并且更容易修复。

此外，IDE 还可以帮助您追踪错误（寻找“红色”墨水！）

例如这里多了一个分号，重新格式化代码就很明显了：

```
 } else if (roll == point) ;
        System.out.println(win); 
```

也许应该是

```
 } else if (roll == point) {
            System.out.println(win);
        } 
```

一旦你弄清楚了语法，为什么不在你的类中使用一些方法和字段呢？例如，您可以拥有合适的方法`win()`和`lose()`字段。

祝你好运！

# php - PHP/MySQL/jQuery 悲观锁定记录

> ID：15012314
> 
> 赞同：4
> 
> 时间：2013-02-21T21:11:38.753
> 
> 标签：php, jquery, ajax, optimistic-locking, pessimistic-locking

我一直在考虑为我参与的应用程序开发一些简单的记录锁定。有一些用户需要花费数小时才能完成对记录的编辑。当其他人想要更改记录时，这会导致问题。目前不涉及锁定。

我不确定乐观锁定在我的情况下是否可靠，因为记录是通过 AJAX 请求保存的。我正在考虑应用某种悲观锁定；使用两个字段，例如**locking_user_id**和**locking_timestamp**，我可以跟踪谁打开了记录以及上次打开它的时间。

但是，由于用户可能一次打开它几个小时，我怎么知道用户是放弃它还是只是在努力工作呢？我不想强迫他们每 5 分钟更新一次 ~ 但这可能是可能的（AJAX 每 5 分钟保存一次）。

也许一个 jQuery 进程可以在用户工作时计数，并且每 5 分钟触发一个 AJAX 请求 (getJSON) 以更新locking_timestamp。这样我就可以维护谁在记录中工作。在时间戳变“旧”之后，我可以假设用户不再使用 reocrd。有没有人有过这种锁定的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:23:36.393

使用 AJAX 请求更新locking_timestamp 是一个很好的策略，并且效果很好。

但是，通话之间的 5 分钟间隔对我来说似乎有点长。除非您的流量非常高，否则从用户的角度来看，30 秒之类的时间会更好。想象一下有人不得不等待 5 分钟，因为另一个用户打开了记录，然后关闭了他的浏览器......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:34:18.830

也许我很傻，但是让 jQuery 监视页面上的鼠标和键盘事件怎么样。

PHP 将锁放在文件系统中的某处或数据库条目上的某个标志，因此下一个用户将无法编辑而只能查看信息。该文件将在条目中包含用户信息，因此在发送更改时仅接受他的更改

当第一个用户在页面上有活动时，没有任何反应。用户在 3 分钟内没有做任何事情，系统将提示他确认他仍在处理它，或者他将在 3 分钟内放弃他当前的更改。如果他确认没有任何事情发生，但如果他不确认，Ajax 将解除锁定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:46:45.423

如果您说用户可能需要几个小时才能提交记录，那么简单的 5 分钟锁定或其他任何方法都不够。

相反，您为什么不实现一种签入/签出功能，该功能将在编辑记录时激活（签出）并定期“保持活动状态”，并在记录时停用（签入）已保存/会话过期/浏览器关闭/等。

# aem - CQ5 - 无法搜索资产子字符串

> ID：15012317
> 
> 赞同：0
> 
> 时间：2013-02-21T21:11:53.153
> 
> 标签：aem

我注意到如果我要搜索部分子字符串，CQ5 找不到某些资产。例如：

资产库：black_ball_500x200.jpg white_ball_500x200.jpg black_white_ball_500x200.jpg

如果我要搜索“白色”，CQ5 返回以下内容：white_ball_500x200.jpg black_white_ball_500x200.jpg

如果我要搜索“500x200”，CQ5 返回以下内容： black_ball_500x200.jpg white_ball_500x200.jpg black_white_ball_500x200.jpg

但是，如果我要搜索子字符串的一部分，例如 '500' 或 'whit' 或 'lack'，CQ5 将不会返回任何内容。

似乎 CQ5 在文件名中使用下划线来为每个文件创建单独的可搜索词。这对我来说成了一个问题，特别是如果我只想寻找 500px 宽的 asstes 而 CQ5 什么也不返回。不幸的是，更改我所有资产的命名结构不是一种选择。我想知道是否有解决此问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T04:38:45.500

尝试使用“*”作为搜索字符串的一部分

# php - 带有 WooCommerce add_actions 的 Wordpress 无法正常工作

> ID：15012319
> 
> 赞同：3
> 
> 时间：2013-02-21T21:11:56.217
> 
> 标签：php, wordpress, hook, woocommerce

在我使用插件 woocomerce 的 Wordpress 中完成付款后，我正在尝试添加一个功能（挂钩）。

woocommere的[文档](http://wcdocs.woothemes.com/codex/extending/hooks/)说有一个名为“woocommerce_payment_complete”的操作和一个名为“woocommerce_payment_complete_order_status”的过滤器

当我尝试使用它们时，什么都没有发生

```
add_action('woocommerce_payment_complete', 'do_something_foo');

function do_something_foo() {
    wp_die("foo!");

} 
```

为什么它不起作用？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T18:12:34.413

根据我在 woocommerce 方面的经验，我总是在挂钩订单状态操作方面取得了更大的成功，也许这是您解决方案的可行替代方案？

```
add_action( 'woocommerce_order_status_completed', 'do_something_foo' );

   function do_something_foo() {
   wp_die("foo!");

} 
```

# php - 在 Cakephp 中将数据从视图传递到不同的视图控制器

> ID：15012324
> 
> 赞同：1
> 
> 时间：2013-02-21T21:12:18.720
> 
> 标签：php, cakephp

我显示了一个表单，用于编辑已保存到数据库中的值。其中一个值是图像（以相对文件路径的形式）。我想在表单中创建一个链接，以便在单击时在单独的视图中显示图像。

我的问题是将这个视图的（编辑视图）图像字段数据传递给将独立显示图像的视图控制器的最佳方法是什么？

我宁愿不通过 url 来做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T22:24:14.893

传递您正在编辑的记录的 ID。然后在你的控制器中，你会有一个类似 view_image($id) 的函数，它根据传入的 $id 字段从数据库中获取图像的相对路径。

然后，您可以在 view_image.ctp 视图文件中显示所需的图像。

更新：

首先，问题是您为什么不想在 URL 中包含 ID？有时人们对公开出示身份证感到不安全，但在大多数情况下，这完全没有问题。

无论如何，假设您有合法的不需要在 URL 中包含 ID，另一种方法是通过 POST 传递 id（或图像路径），而不是在 URL (GET) 中. 你知道区别吗？GET 将参数包含在 URL 中，而 POST 将它们包装在请求本身中，因此它们不在 URL 中。

如果你想要一个这样做的例子，CakePHP 在它的默认删除函数和由 Bake 控制台生成的链接的情况下会这样做。

在删除记录的情况下，以下是视图中 POST 链接的示例：

```
echo $this->Form->postLink(__('Delete'), array('action' => 'delete', $product['Product']['id']),array('class'=>'delete'), __('Are you sure you want to delete %s?', $product['Product']['list_title'])); 
```

示例控制器方法如下所示：

```
public function admin_delete($id = null) {
    if (!$this->request->is('post')) {
        throw new MethodNotAllowedException();
    }
    $this->Product->id = $id;
    if (!$this->Product->exists()) {
        throw new NotFoundException(__('Invalid product'));
    }
    if ($this->Product->delete()) {
        $this->Session->setFlash(__('Product deleted'));
        $this->redirect(array('action' => 'index'));
    }
    $this->Session->setFlash(__('Product was not deleted'));
    $this->redirect(array('action' => 'index'));
} 
```

因此，您不应该发现将其用于您自己的目的太难了。

# controls - 可以在没有控件的情况下自动播放视频，但仍然可以开始/停止

> ID：15012326
> 
> 赞同：0
> 
> 时间：2013-02-21T21:12:26.473
> 
> 标签：controls, autoplay

当您将视频设置为自动播放并且没有控件时，观看者无法停止/重新启动视频...

是否有一个选项可以使控件不可见，但观众仍然可以单击视频以停止并重新启动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T05:30:24.283

您可以在视频上覆盖一个可以播放和停止视频的叠加层。

# sql - Oracle SQL - 是否有一个标准的 HAVING EVERY 解决方法？

> ID：15012329
> 
> 赞同：5
> 
> 时间：2013-02-21T21:13:03.227
> 
> 标签：sql, oracle, sqlplus, having-clause

我在想办法解决 Oracle 对 HAVING EVERY 子句缺乏支持的问题时遇到了麻烦。

我有两个表，Production 和 Movie，具有以下架构：

```
Production (pid, mid)
Movie(mid, director) 
```

其中“pid”是表示发行商 ID 的整数，“mid”是表示电影 ID 的整数，director 是电影导演的姓名。

我的目标是获取仅出版过由彼得·杰克逊或本·阿弗莱克导演的电影的出版商列表（按 ID）。

为了实现这一点，我编写了以下查询：

```
SELECT *
    FROM Production P, Movie M
    WHERE P.mid = M.mid;
    GROUP BY P.pid
    HAVING EVERY ( M.director IN ('Ben Affleck', 'Peter Jackson') ); 
```

但由于 Oracle 不支持 HAVING EVERY，我得到的只是以下错误：

```
 HAVING EVERY ( M.director IN ('ben affleck', 'PJ') )
                          *
ERROR at line 5:
ORA-00907: missing right parenthesis 
```

因为导演职位必须适用于出版商制作的每一部电影，所以我不认为可以将条件移至 WHERE 子句。

有没有办法绕过这个障碍？任何被认为是“标准”的东西？另外（也许更重要的是）为什么 Oracle 选择不实施 HAVING EVERY？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:48:28.123

试试这个：

```
SELECT P.pid
FROM (select distinct Pi.pid, M.Director
      from Production Pi INNER JOIN 
    Movie M ON Pi.mid = M.mid) P
GROUP BY P.pid
HAVING sum(case when P.Director in ('Ben Affleck', 'Peter Jackson') 
           then 1 else 99 end) = 2 
```

[这是一个 sqlfiddle 演示](http://www.sqlfiddle.com/#!4/cc18b/4)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T22:58:51.307

在考虑了一段时间之后，我想出了一些可能比 ABCade 想出的更具可读性的东西：

```
select distinct P.pid
    from Production P
    where P.pid not in (
        -- Get publishers that have produced a movie directed by someone else
        select P1.pid
        from Production P1 INNER JOIN Movie M ON P1.mid = M.mid
        where M.director not in ('Ben Affleck', 'Peter Jackson')
    ) 
```

[SQLFiddle 演示](http://www.sqlfiddle.com/#!4/cc18b/6)

不同之处在于，我们不是只寻找具有所需导演的制片人，而是识别与其他导演相关的所有制片人，然后将其省略。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T23:07:31.183

基于[Dan 自己的回答](https://stackoverflow.com/a/15013858/1030)，但我已经删除了相关子查询，因为它在大型数据集上的性能可能会很差：

```
SELECT DISTINCT P.pid
FROM Production P
LEFT JOIN (
    SELECT P1.pid
    FROM Production P1
    INNER JOIN Movie M ON (P1.mid = M.mid)
    WHERE M.director NOT IN ('Ben Affleck', 'Peter Jackson')
) V ON (P.pid = V.pid)
WHERE v.pid IS NULL; 
```

[SQL Fiddle 演示](http://www.sqlfiddle.com/#!4/cc18b/24/0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-11T15:08:55.047

为了避免[神奇的数字 99](https://stackoverflow.com/questions/15012329/oracle-sql-is-there-a-standard-having-every-workaround/15012875#15012875)：

```
SELECT 
    P.pid
FROM 
(
    SELECT DISTINCT 
        Pi.pid, M.Director
    FROM Production Pi 
    JOIN Movie M ON Pi.mid = M.mid
) P
GROUP BY 
    P.pid
HAVING 
    COUNT(p.Director) = 2 -- The directors should be exactly 2
    AND MIN(CASE WHEN p.Director in ('Ben Affleck', 'Peter Jackson') 
            THEN 1 ELSE 0 END) = 1 
```

其他方法：[http ://www.anicehumble.com/2019/04/not-every-rdbms-has-every.html](http://www.anicehumble.com/2019/04/not-every-rdbms-has-every.html)

请注意，`not in`不能使用双重方法。因为它仍然会报告只有一位与本·阿弗莱克或彼得·杰克逊相匹配的导演的出版商。

```
with production as
(
   select *
   from (values 
      ('DC', 'Batman', 'Ben Affleck'),
      ('DC', 'Robin', 'Peter Jackson'),
      ('Not DC', 'Not Batman', 'Not Ben Affleck'),
      ('Not DC', 'Not Robin', 'Not Peter Jackson'),         
      ('Marvel', 'Avengers', 'Joe Russo'),
      ('WingNut', 'King Kong', 'Peter Jackson'),
      ('Century Fox', 'Deadpool', 'Ben Affleck'),
      ('Century Fox', 'Fantastic 4', 'Peter Jackson'),
      ('Century Fox', 'X-Men', 'Peter Jackson'),
      ('Millenium Fox', 'Scorpion', 'Ben Affleck'),
      ('Millenium Fox', 'Sub-Zero', 'Peter Jackson'),
      ('Millenium Fox', 'Liu Kang', 'Ed Boon')          
   ) as x(publisher, movie, director)
)
select distinct P.publisher
from production P
where P.publisher not in (
      -- Get publishers that have produced a movie directed by someone else
      select P1.publisher
      from production P1
      where P1.director not in ('Ben Affleck', 'Peter Jackson')
    )
; 
```

错误的输出。WingNut 不应该被包括在内，因为它没有 Ben Affleck 和 Peter Jackson 作为导演。

```
| publisher   |
| ----------- |
| WingNut     |
| Century Fox |
| DC          | 
```

这是正确的查询，每个都是使用模拟的`min(when true then 1 else 0) = 1`

```
with production as
(
   select *
   from (values 
      ('DC', 'Batman', 'Ben Affleck'),
      ('DC', 'Robin', 'Peter Jackson'),
      ('Not DC', 'Not Batman', 'Not Ben Affleck'),
      ('Not DC', 'Not Robin', 'Not Peter Jackson'),         
      ('Marvel', 'Avengers', 'Joe Russo'),
      ('WingNut', 'King Kong', 'Peter Jackson'),
      ('Century Fox', 'Deadpool', 'Ben Affleck'),
      ('Century Fox', 'Fantastic 4', 'Peter Jackson'),
      ('Century Fox', 'X-Men', 'Peter Jackson'),
      ('Millenium Fox', 'Scorpion', 'Ben Affleck'),
      ('Millenium Fox', 'Sub-Zero', 'Peter Jackson'),
      ('Millenium Fox', 'Liu Kang', 'Ed Boon')          
   ) as x(publisher, movie, director)
)
select P.publisher
from (select distinct publisher, director from production) P
group by
    P.publisher
having
     count(p.Director) = 2 -- The directors should be exactly 2

     and min(case when p.Director in ('Ben Affleck', 'Peter Jackson') 
             then 1 else 0 end) = 1
; 
```

正确的输出，应该只显示 DC 和 Century Fox。因为他们是唯一同时雇佣本·阿弗莱克和彼得·杰克逊的出版商。

```
| publisher   |
| ----------- |
| Century Fox |
| DC          | 
```

现场测试：[https ://www.db-fiddle.com/f/aDDw4Pd1DJzs6J5HgbKbdh/4](https://www.db-fiddle.com/f/aDDw4Pd1DJzs6J5HgbKbdh/4)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-04T20:07:36.463

使用条件聚合`COUNT`：

```
SELECT Pi.pid
FROM Production Pi
JOIN Movie M ON Pi.mid = M.mid
GROUP BY Pi.pid
HAVING COUNT(DISTINCT CASE WHEN M.Director IN ('Ben Affleck','Peter Jackson') 
                           THEN M.Director END) = 2; 
```

# ruby - 如何在延迟作业中从 .powenv 访问环境变量

> ID：15012330
> 
> 赞同：0
> 
> 时间：2013-02-21T21:13:06.557
> 
> 标签：ruby, delayed-job, rack-pow

我在 .powenv 中定义了一些环境变量。

```
export FOO=bar 
```

通过delayed_job异步运行的方法需要访问这个环境变量：

```
class A < ActiveRecord::Base
  def my_method
    B.new
  end
end
handle_asynchronously :my_method

class B
  def initialize
   puts ENV['FOO']
  end
end

a = A.find(1)
a.my_method 
```

延迟调用 my_method 时 ENV['FOO'] 是否可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T09:23:11.420

我想到了。赶紧跑：

```
. .powenv
script/console delayed_job start 
```

这个答案让我走上了正确的道路： [Rails 控制台和 Pow 中的环境变量](https://stackoverflow.com/questions/10527372/environment-variable-in-rails-console-and-pow)

如果您想知道点命令的用途： [https ://superuser.com/questions/46139/what-does-source-do](https://superuser.com/questions/46139/what-does-source-do)

# javascript - Require.js 默认方案，例如 /lib/module/module.js

> ID：15012332
> 
> 赞同：1
> 
> 时间：2013-02-21T21:13:08.080
> 
> 标签：javascript, requirejs

是否可以在 require.js 中设置一些选项以允许默认方案包含带有模块名称的子目录？

我想写...

```
require(["underscore","jquery"],function(_,$){
    // do something here
}) 
```

我希望它在这个文件夹结构中找到 jquery 和下划线......

```
/
/lib/
    /jquery/
           /jquery.js
    /underscore/
           /underscore.js 
```

目前，我必须写...

```
require(["/lib/underscore/underscore","/lib/jquery/jquery"],function(_,$){
    // do something here
}) 
```

或者一些疯狂的包装...

```
function req(arr,cb){
  require(arr.join().replace(/(\w+)/g,function(mod){ return "/lib/"+mod+"/"+mod }).split(","),cb)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:22:41.637

是的，这应该与`requirejs.config`- 函数中的说明一起使用，如下所示：

```
requirejs.config({
    //By default load any module IDs from js/lib
    baseUrl: 'js/lib',

    //except, if the module ID starts with "app",
    //load it from the js/app directory. paths
    //config is relative to the baseUrl, and
    //never includes a ".js" extension since
    //the paths config could be for a directory.
    paths: {
        app: '../app'
    }
}); 
```

[取自 Require.js API-docs](http://requirejs.org/docs/api.html#jsfiles)，因此在`paths`- 属性中，您可以指定要使用的库的所有路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:25:47.893

您可以使用[路径配置选项](http://requirejs.org/docs/api.html#config-paths)以您想要的方式添加路径。

```
var libPaths = (function() {
  var libs = ["jquery", "underscore"];

  var lib, paths = {};
  for(var i=0; i < libs.length; i++) {
    lib = libs[i];
    paths[lib] = "/lib/" + lib + "/" + lib;
  }
  return paths;
})();

requirejs.config({
  paths: libPaths
}); 
```

要添加更多覆盖，只需添加到`libs`数组中。

# vb.net - 通过选择 datagridview 组合框项，生成 txtboxcolumn 值..如何？在 vb.net

> ID：15012338
> 
> 赞同：0
> 
> 时间：2013-02-21T21:13:32.967
> 
> 标签：vb.net, datagrid

![在此处输入图像描述](../Images/bba7a6ae6bbdbb24318e9a761eeca640.png)

您好，我想在网格视图上执行如下操作，如图所示。通过从 Item 组合框中选择项目，Unitprice 将在 Unit price txt 字段中生成。Product 表绑定的item组合框的数据。Item 组合框的 value 成员是 Product 字段的 Unitprice。PLZ帮帮我。提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T02:59:24.970

您要`CellValueChanged`处理`DataGridView`.

```
Private Sub CellValueChanged(ByVal sender As Object, _
    ByVal e As DataGridViewCellEventArgs) _
    Handles DataGridView1.CellValueChanged

    ' Update the unit price column whenever the value of the item cell changes.
    If DataGridView1.Item(e.ColumnIndex, e.RowIndex) == DataGridView1.Item("Item", e.RowIndex) Then
        DataGridView1.Item("Unit Price", e.RowIndex).Value = DataGridView1.Item(e.ColumnIndex, e.RowIndex).Value
End Sub 
```

另请参阅 MSDN 上的`DataGridView.CellValueChanged` [事件参考和 MSDN上](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellvaluechanged.aspx)`DataGridViewComboBoxCell` [类参考](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcell.aspx)的“备注”部分。

# python - 如何避免在 Python 文件输入库中缓冲

> ID：15012340
> 
> 赞同：6
> 
> 时间：2013-02-21T21:13:48.743
> 
> 标签：python, readline, buffering, file-io, readlines

我在这里看到过这个问题，但给出的答案在我的情况下不起作用，并且被标记为重复。

*   [`python -u`不适用于`stdin`Python 3。](https://stackoverflow.com/a/6033936/1440740)
*   `sys.stdin = sys.stdin.detach()`抛出一个`ValueError: underlying buffer has been detached`.
*   这些都不适用于非`stdin`输入和其他用作流的文件。
*   [添加钩子不起作用：`FileInput(openhook=hook_nobuf)`并`open(buffering=0)`在钩子中使用。](https://stackoverflow.com/a/6033885/1440740)

我挖掘了源代码 ( [`/usr/lib/python3.2/fileinput.py`](http://hg.python.org/cpython/file/3.2/Lib/fileinput.py)) 并看到它`readlines(bufsize)`在内部用于加载缓冲区。没有外壳或其他管道恶作剧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:13:48.743

对我有用的只是设置`FileInput(bufsize=1)`。该`file.readlines()`文档确实声明“可选大小参数（如果给出）是返回的行中字节总数的近似界限。” 在实践中，我每次都会得到一个新行，而不必填充缓冲区。

```
with fileinput.input(bufsize=1) as f:
    for line in f:
        print("One line in, one line out!") 
```

# windows - 打开.bat文件脚本后如何保持cmd运行

> ID：15012344
> 
> 赞同：19
> 
> 时间：2013-02-21T21:14:05.497
> 
> 标签：windows, batch-file, cmd, directory

基本上我已经在记事本中编写了一个“脚本”并将其保存为`.bat`文件。它所做的只是更改目录。像这样写：

```
cd C:\Users\Hello\Documents\Stuff 
```

它确实改变了目录，但我想在那之后写更多，在`cmd`. 前任。选择要运行的程序。这似乎很简单，但我无法弄清楚。我读到了`pause`，但它只是等待一个键然后关闭。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-02-22T09:10:24.303

放在`cmd /k`脚本的最后一行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-19T00:58:46.653

尝试以下操作：

```
@echo off
Cmd /k 
```

`cmd /k`启动一个新`cmd`实例，`/k`在命令完成后停止终止控制台窗口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-21T21:20:01.657

`@pause`以单独的行结束您的 bat 文件

# c - 将 PSTR 转换为 PWSTR 并转义某些字符

> ID：15012346
> 
> 赞同：0
> 
> 时间：2013-02-21T21:14:12.030
> 
> 标签：c, string, unicode, converter

我正在尝试组合一个函数来将 PSTR 转换为 PWSTR，同时转义某些字符。我无法控制 PSTR 包含的输入。它可以是任何网页上的内容。

我已经有以下代码，但我想知道是否有更好/更有效的方法，或者我所拥有的是否可以工作。

```
__inline PCWSTR ToEscape(CHAR c)
{
    switch (c)
    {
    case '"':  return L"\"";
    case '\\': return L"\\";
    case '\b': return L"\b";
    case '\f': return L"\f";
    case '\n': return L"\n";
    case '\r': return L"\r";
    case '\t': return L"\t";
    default:   return NULL;
    }
}

// Helper for mbstowcs_s that does not return NULL terminator included in size
__inline DWORD CharToWChar(__out_ecount_opt(cchBuffer) WCHAR* pszBuffer, __in DWORD cchBuffer, __in_ecount(valueLen) PCSTR value, __in DWORD valueLen)
{
    if (valueLen == 0) return 0;

    size_t dwSize = 0;
    mbstowcs_s(&dwSize, pszBuffer, cchBuffer, value, valueLen);
    return dwSize - 1;
}

// Writes the input value to pszBuffer, or if pszBuffer is NULL, returns the length necessary to write value
__inline DWORD WriteJsonValue(__out_ecount_opt(cchBuffer) WCHAR* pszBuffer, __in DWORD cchBuffer, __in PCSTR value)
{
    if (pszBuffer == NULL)
    {
        DWORD offset = 2;

        PCSTR start = value;
        DWORD index = 0;
        while (value[index] != '\0')
        {
            PCWSTR Escape = ToEscape(value[index]);
            if (Escape)
            {
                offset += CharToWChar(NULL, 0, start, (value + index) - start);
                start = value + index + 1;
                offset += 2;
            }
            index++;
        }

        // Any more left to write?
        offset += CharToWChar(NULL, 0, start, (value + index) - start);

        return offset;
    }
    else
    {
        DWORD offset = 0;
        if (cchBuffer < 1) return 0;
        pszBuffer[offset++] = L'"';

        PCSTR start = value;
        DWORD index = 0;
        while (value[index] != '\0')
        {
            PCWSTR Escape = ToEscape(value[index]);
            if (Escape)
            {
                DWORD dwLen = (value + index) - start;
                offset += CharToWChar(pszBuffer+offset, cchBuffer-offset, start, dwLen);
                start = value + index + 1;

                if (cchBuffer < offset + 2) return offset;
                pszBuffer[offset++] = Escape[0];
                pszBuffer[offset++] = Escape[1];
            }
            index++;
        }

        // Any more left to write?
        DWORD dwLen = (value + index) - start;
        offset += CharToWChar(pszBuffer+offset, cchBuffer-offset, start, dwLen);

        if (cchBuffer < offset + 1) return offset;
        pszBuffer[offset++] = L'"';

        return offset;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T19:43:09.020

```
__inline PCWSTR ToEscape(WCHAR c)
{
    switch (c)
    {
    case L'"':  return L"\"";
    case L'\\': return L"\\";
    case L'\b': return L"\b";
    case L'\f': return L"\f";
    case L'\n': return L"\n";
    case L'\r': return L"\r";
    case L'\t': return L"\t";
    default:   return NULL;
    }
}

__inline DWORD WriteEscapedCharacter(__out_ecount(cchBuffer) WCHAR* pszBuffer, __in DWORD cchBuffer, __in WCHAR value)
{
    PCWSTR Escape = ToEscape(value);
    if (Escape)
    {
        if (cchBuffer < 2) return 0;
        pszBuffer[0] = Escape[0];
        pszBuffer[1] = Escape[1];
        return 2;
    }
    else
    {
        if (cchBuffer < 1) return 0;
        pszBuffer[0] = value;
        return 1;
    }
}

// Writes the input value to pszBuffer, or if pszBuffer is NULL, returns the length necessary to write value
__inline DWORD WriteJsonValue(__out_ecount_opt(cchBuffer) WCHAR* pszBuffer, __in DWORD cchBuffer, __in PCSTR value)
{
    size_t valueLen = _mbstrlen(value);

    if (pszBuffer == NULL)
    {
        DWORD offset = 2;

        WCHAR ch = 0;
        DWORD index = 0;
        while (index < valueLen)
        {
            DWORD chLen = mblen(value + index, valueLen - index);
            if (chLen < 1) break;
            mbtowc(&ch, value + index, chLen);
            offset += ToEscape(ch) ? 2 : 1;
            index += chLen;
        }

        return offset;
    }
    else
    {
        DWORD offset = 0;
        if (cchBuffer < 1) return 0;
        pszBuffer[offset++] = L'"';

        WCHAR ch = 0;
        DWORD index = 0;
        while (value[index] != '\0')
        {
            DWORD chLen = mblen(value + index, valueLen - index);
            if (chLen < 1) break;
            mbtowc(&ch, value + index, chLen);
            offset += WriteEscapedCharacter(pszBuffer + offset, cchBuffer - offset, value[index]);
            index += chLen;
        }

        if (cchBuffer < offset + 1) return offset;
        pszBuffer[offset++] = L'"';

        return offset;
    }
} 
```

# c# - 序列数组

> ID：15012347
> 
> 赞同：3
> 
> 时间：2013-02-21T21:14:18.273
> 
> 标签：c#, arrays

假设我有一个整数序列，从 0（总是从 0 开始）到 3。现在，我有一个整数数组，它将保持这些序列一个接一个地循环，从某个点开始。例如：

一个 10 个元素的数组，序列是 0 到 3，从 2 开始，应该产生 2、3、0、1、2、3、0、1、2、3。

一个包含 5 个元素的数组，从 0 到 5 的序列，从 5 开始，应该产生 5、0、1、2、3。

一个由 5 个元素组成的数组，序列从 0 到 10，从 3 开始，应该产生 3、4、5、6、7。

我正在遭受大脑冻结！如果您知道数组大小、序列中的最大数量和起始值，那么创建此数组的最佳方法是什么？

* * *

我最好的尝试是：

```
private static int[] CreateIndexers(int index, int size, int players) 
{
  var indexers = new int[size];
  for (int i = 0; i < size; i++)
  { 
    var division = i / players; 
    var newInt = division + i >= players ? ((division + i) - players) : division + i;
    indexers[i] = newInt; 
  } 

  return indexers; 
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T21:20:43.070

```
public static IEnumerable<int> Foo(int count, int start, int max)
{
    return Enumerable.Range(0, count)
        .Select(n => (n + start) % (max + 1));
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T21:19:02.970

```
public int[] Cycle(int max, int start, int count)
{
    int cycles = count / max + 1;
    return Enumerable.Repeat(Enumerable.Range(0, max+1), cycles)
        .SelectMany(seq => seq)
        .Skip(start)
        .Take(count)
        .ToArray();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-21T21:26:56.903

使用 LINQ：

```
public static IEnumerable<int> Foo(int length, int start, int end)
{
    return Enumerable.Range(start, length).Select(n => n % (end + 1));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T21:15:54.940

这是解决方案的“LINQy”版本较少：

```
 public static IEnumerable<int> GetSequence(int start, int end, int count)
    {
        var fullSequence = new List<int>();
        var baseRange = Enumerable.Range(0, end + 1);
        fullSequence.AddRange(baseRange.Skip(start));

        while (fullSequence.Count < count)
        {
            fullSequence.AddRange(baseRange);
        }

        return fullSequence.Take(count);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T21:22:37.423

```
int numberOfElements = 10;
int sequenceStartElement = 0;
int sequenceCount = 4;
int firstElement = 2;

IEnumerable<int> sequence = Enumerable.Range(sequenceStartElement, sequenceCount)
int[] array = sequence
     //you could figure out a lesser number to Repeat... but it's deferred, doesn't matter.
  .Repeat(numberOfElements) 
  .SkipWhile(x => x != firstElement)
  .Take(numberOfElements)
  .ToArray(); 
```

* * *

> 如果您知道数组大小、序列中的最大数量和起始值，那么创建此数组的最佳方法是什么？

我看到列出了三个输入，而不是之前考虑的四个。以下是如何使用您的方法来做到这一点。

```
private static int[] CreateIndexers(int firstElement, int numberOfElements, int sequenceMax) 
{
  int sequenceCount = sequenceMax + 1
  var indexers = new int[numberOfElements];
  for (int i = 0; i < numberOfElements; i++)
  { 
    indexers[i] = (i + firstElement) % sequenceCount;
  } 
  return indexers; 
} 
```

# visual-studio - 私人 Nuget 服务器为我返回 503 错误，但没有其他人

> ID：15012360
> 
> 赞同：4
> 
> 时间：2013-02-21T21:14:51.477
> 
> 标签：visual-studio, nuget, nuget-server

好吧，还有一个奇怪的...

我已经为我们公司安装并设置了一个内部 nuget 服务器 - 它在 nuget (2.2.31210.9045) 上运行最新版本。我可以在浏览器 (http://{server}) 和 (http://{server}/nuget) 和 (http://{server}/nuget/packages) 中点击 url 并获得所有预期的响应。

但是，在 Visual Studio 2012 中，我添加了 http://{server}/nuget/ 作为自定义提要，当我加载包管理器时，我得到“远程服务器返回错误：（503）服务器不可用。”

我在其他几个同事的机器上试过这个，他们能够浏览服务器上的包，似乎只有我一个人。

我找不到有关此的任何信息，或如何调试它。我试图弄清楚是否有办法重置它，或者看看我是否可以采取一些故障排除步骤来弄清楚可能发生了什么。

注意：我之前在网络连接和安装 vs2012 时遇到过问题（[此处](https://stackoverflow.com/questions/12806979/visual-studio-2012-crashes-after-installing-ie9-faulting-module-ntdll-dll)已解决）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T20:35:01.673

在尝试了我能想到的一切但没有成功之后，我遇到了这个：

[http://wangz.itysc.com/2012/08/nuget-install-package-remote-server.html](http://wangz.itysc.com/2012/08/nuget-install-package-remote-server.html)

托尼说他在 VS2010 上遇到了类似的问题（我确实安装了 2010）所以，出于绝望，我安装了该[服务包](http://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=38654)（似乎不相关），它神奇地在 VS2012 中修复了它！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-06T11:26:23.343

尝试以下 2 个命令

```
netsh http 删除 urlacl url=http://+:80/  
netsh http 删除 urlacl url=http://+:443/

```

然后重新启动visual studio并检查。请[参考这里](https://stackoverflow.com/questions/11153187/what-is-phrase-url-reservation-in-http-sys-means)

祝你好运。

# iphone - 有没有办法去除 iTunes 中的圆角？并使图标透明？

> ID：15012366
> 
> 赞同：-2
> 
> 时间：2013-02-21T21:15:17.510
> 
> 标签：iphone, ios, ipad, icons, itunes

我已将我的应用程序图标标记为预渲染，安装后，图标看起来应该是这样，但 iTunes 图标仍然看起来很奇怪。首先，背景是黑色而不是透明的。其次，增加了圆角，看起来很糟糕。

你有什么建议吗？ [https://itunes.apple.com/us/app/das-gro-e-film-quiz-deutsch/id604179483?l=de&ls=1&mt=8](https://itunes.apple.com/us/app/das-gro-e-film-quiz-deutsch/id604179483?l=de&ls=1&mt=8)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T23:20:23.087

不，你不能让它透明或只有圆角，它基本上是苹果的商标。有人可以让它透明或没有圆角的唯一方法是用户设备是否越狱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:18:16.883

不，对于提交到 AppStore 的应用程序，没有办法这样做。将图标标记为预渲染只会删除默认添加的光泽效果。

（越狱设备用户可以自定义UI）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T21:18:35.667

App Store 图标没有透明度，总是有圆角。预渲染仅意味着 iTunes 不会将发光效果放在其上。

只需为您的图标添加彩色背景（可能带有渐变），使其看起来更漂亮。

# wmic - WMIC 错误：描述 = 搜索修补程序时发生异常

> ID：15012368
> 
> 赞同：0
> 
> 时间：2013-02-21T21:15:19.083
> 
> 标签：wmic

我有一个要运行的 wmic 命令，如果安装了修补程序，它将查询机器列表并返回 csv 文件。在我的情况下，修补程序 ID 是 2617858。它开始处理，然后在大约 20 秒后出现：错误：描述 = 发生异常。当文件中有几台机器时它可以工作，但我需要在 40 台计算机上运行它。

有什么建议么 ？谢谢

代码：

```
 wmic /failfast:on /node:@"C:\users\username\desktop\servers.txt" qfe | find "2617858" > \\computername\C$\users\username\desktop\hotfix.csv 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T14:41:05.017

对于它的价值，要求`wmic`过滤而不是`wmic`通过管道可能更容易`find`。像这样的东西：

```
wmic /node:@"C:\users\username\desktop\servers.txt" qfe where hotfixid="KB983590" get csname /format:list >>hotfix.txt 
```

或者，如果问题是`wmic`无法处理 servers.txt 中的那么多服务器，请尝试使用批处理`for`循环遍历列表。

```
@echo off
setlocal
for /f "usebackq delims=" %%I in ("C:\users\username\desktop\servers.txt") do (
    set /P "=Checking %%I... "
    wmic /node:%%I qfe where hotfixid="KB983590" get csname /format:list >>hotfix.txt 2>>failures.txt
    echo Done.
)
echo Unable to query the following computers:
type failures.txt 
```

作为替代方案，您可以使用 PowerShell 执行相同的操作。

```
powershell -command "$pcs = Get-Content C:\users\username\desktop\servers.txt; foreach ($pc in $pcs) { Get-WmiObject -Computername $pc Win32_QuickFixEngineering | where-object {$_.hotfixid -eq 'KB980232'} | select-object csname }" >>hotfix.txt 
```

...虽然如果 wmi 在服务器上对 wmic 没有响应，那么使用 powershell 可能不会有更好的运气。

# google-analytics - 在谷歌分析中查看今天的流量

> ID：15012370
> 
> 赞同：11
> 
> 时间：2013-02-21T21:15:22.413
> 
> 标签：google-analytics

是否可以查看网站从今天到现在的流量？我只看到最后一天的统计数据，我想查看从这一天到那个小时的统计数据，所以这可能吗？我找不到它

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-01-28T21:58:31.377

因此，为了使所有内容都保持在 SO 上并保持最新状态，流程如下：

1.  登录
    ![登录图片](../Images/4d356a072eccb85b4d703f9e3f59132e.png)
2.  选择相关站点
    ![看，这是我的网站！](../Images/ada75fb8a21e562ef426b4946f90c7e6.png)
3.  单击日期选择器
    ![选择器](../Images/b259433e967d026d4859e103c31c5cc2.png)
    它可能如下所示：
    ![在此处输入图像描述](../Images/e9dbea7ed969955c03e7096c5eee1bf8.png)
4.  选择今天的日期（并且仅选择今天的日期）。
    ![选择今天](../Images/c658b7a363b772cd8cb68efed41b99bb.png)
5.  点击“申请”
6.  利润！！！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-18T20:58:06.367

这很简单。登录到您的站点并检查站点视图的右上角并将日期更改为一天。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:26:49.197

我认为这是不可能的，您只有实时菜单，但这不是您问题的答案

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T21:28:49.660

如果您在用户界面中设置从今天到今天的日期，则会为您提供今天到上次收集数据的时间点的数据。它可能不是完全实时的，但足以给你一个想法。

# python - 如何在选定的 Gmail 邮箱中通过 python 归档电子邮件

> ID：15012374
> 
> 赞同：1
> 
> 时间：2013-02-21T21:15:41.083
> 
> 标签：python, gmail-imap

我正在寻找一种`archive`使用 Python 在我的 gmail 邮箱中选择电子邮件的方法。关于我如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:17:08.427

python中最好的工具是[getmail](http://pyropus.ca/software/getmail/)（据我所知），检查一下。也许它会解决你的问题。它像 fetchmail 一样工作。如果你通过`archive`手段下载到你自己的机器上进行存储。如果您通过`archive`gmail存档，那么我不知道。

# c# - 使用 dot42 触发事件

> ID：15012377
> 
> 赞同：2
> 
> 时间：2013-02-21T21:15:50.027
> 
> 标签：c#, android, mobile, dot42

我尝试使用 dot42 迈出第一步。

我定义了一个这样的按钮：

```
 <Button android:id="@+string/button_send"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Senden"
        android:onClick="sendMessage"/> 
```

我想我现在可以在 MainActivity 类中定义一个方法，如下所示：

```
 [Activity]
public class MainActivity : Activity
{
    protected override void OnCreate(Bundle savedInstance)
    {
        base.OnCreate(savedInstance);
        SetContentView(R.Layouts.MainLayout);
    }

    public void sendMessage(View view)
    {

    }
} 
```

但不幸的是，单击该按钮时我得到一个例外..

[您可以在此处](http://www.dot42.com)找到有关 dot42的信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T08:45:18.773

我收到了 dot42 support 的回答：

您可以通过将 [EventHandler] 属性（来自 Dot42.EventHandlerAttribute）添加到 sendMessage 方法来解决此问题，如下所示：

```
[EventHandler]
public void sendMessage(View view)
{
    Toast.MakeText(this, "Button pressed", Toast.LENGTH_LONG).Show();
} 
```

这可确保 sendMessage 方法不会被重命名并包含在 APK 中。默认情况下，dot42 将尝试删除尽可能多的代码，并且由于未引用 sendMessage （从代码中），它将删除它。添加属性可以防止这种情况。

# hibernate - JPA - MapKeyColumn 为空，即使数据在数据库中

> ID：15012381
> 
> 赞同：0
> 
> 时间：2013-02-21T21:15:56.010
> 
> 标签：hibernate, jpa

我试图本地化我的 jpa 应用程序。为此，我在课堂上使用了 @MapKeyColumn 属性。所以我以这种方式定义了这个类：

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
@Table(name = "BIENTOO_SPORT")
public class Sport implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "sportId")
    private Long id;

    @Column(name = "code")
    private String code;

    @OneToMany(fetch = FetchType.LAZY, orphanRemoval = true, mappedBy = "sport")
    @MapKeyColumn(name = "SPORT_LANGUAGE_KEY")
    private Map<String,SportLocalizedString> sportLocalizedString;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getCode() {
        return code;
    }

    public void setCode(String code) {
        this.code = code;
    }

    public Map<String, SportLocalizedString> getSportLocalizedString() {
        return sportLocalizedString;
    }

    public void setSportLocalizedString(Map<String, SportLocalizedString> sportLocalizedString) {
        this.sportLocalizedString = sportLocalizedString;
    }

    public SportLocalizedString newSportLocalizedString(){
        return new SportLocalizedString();
    }

    @Entity
    @Table(name = "BIENTOO_SPORT_LOCALIZED_STRING")
    public class SportLocalizedString implements Serializable {

        @Id
        @GeneratedValue(generator = "bientooSportLocalizedString", strategy = GenerationType.TABLE)
        @TableGenerator(name = "bientooSportLocalizedString", table = "SEQUENCE_GENERATOR", pkColumnName = "ID_NAME", valueColumnName = "ID_VAL", pkColumnValue = "sportLocalizedString", allocationSize = 50)
        @Column(name = "SPORT_LOCALIZED_ID")
        private Long id;

        @Column(name = "SPORT_LANGUAGE_KEY")
        private String language;

        @Column(name = "SPORT_LANGUAGE_NAME")
        private String name;

        @ManyToOne
        private Sport sport;

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }

        public String getLanguage() {
            return language;
        }

        public void setLanguage(String language) {
            this.language = language;
        }

        public Sport getSport() {
            return sport;
        }

        public void setSport(Sport sport) {
            this.sport = sport;
        }
    }

} 
```

正如您在 Sport 中看到的那样，我与内部阶层有 OneToMany 关系。当我启动应用程序时，一切正常。但是当我检索 Sport 对象时，Map sportLocalizedString 为空。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T10:26:09.523

尝试替换`@MapKeyColumn(name = "SPORT_LANGUAGE_KEY")`为`@MapKey(name = "language")`

# asp.net - 在 ASP.NET MVC4 应用程序中拥有一个区域但禁用到该区域的路由的最佳方法

> ID：15012383
> 
> 赞同：0
> 
> 时间：2013-02-21T21:16:18.180
> 
> 标签：asp.net, asp.net-mvc-4

我的 ASP.NET MVC4 应用程序中有一个区域。但该地区仍在建设中。当我发布应用程序时，我希望禁用到该区域的任何路由。防止默认约定获取请求并重定向到该区域的最佳方法是什么。

例如，假设区域名称是“NewFeature”，我不希望对 /someuri/NewFeature 的任何请求得到尊重。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:19:06.520

如果没有通往该区域的路线，客户将永远无法调用/使用它。那么运送它有什么意义呢？但是如果你想这样做，你总是可以在相应的 AreaRegistration 文件中注释路由定义。

# angularjs - 父子控制器数据设计

> ID：15012385
> 
> 赞同：5
> 
> 时间：2013-02-21T21:16:20.097
> 
> 标签：angularjs

好的，让我们设置一个场景。

**场景：** 您有一个内容控制器。此内容可能是照片、博客文章等。现在，在此内容的 html 中，您有一个 Comment 控制器。CommentController 的工作是加载评论、允许评论提交等。然而，这个控制器的功能取决于它的父级。毕竟，如果没有父母，你在评论什么？

**问题：** 话虽如此，让我们引入一个问题。ContentController 需要从服务器请求信息来填充自己，其中一部分是唯一 ID。现在，还有其他方法可以解决这个问题，例如使用 url-state 作为唯一 ID，但这是我能想出的解释这个问题的最佳方法。

唯一 id 从服务器加载到 ContentController。然后它用这个 ID 和真实的内容填充它的 $scope。另一方面，CommentController 想要加载它自己的资源，但它的资源加载完全依赖于父 ContentController 加载的数据。由于两个控制器同时加载，我们需要一种方法来通知或延迟子 CommentController 的执行。否则，它将尝试从服务器请求有关不存在的唯一内容 ID 的评论。

**问题：** 这是一个非常基本的问题，有很多显而易见的答案。然而，我的问题是，像这样的角度是如何完成的？最适合“角度方式”的解决方案是什么。

最明显的方法是简单地拥有一个事件创建者/消费者。Angular 有多种方法来处理这个问题。例如服务、a `$scope.promise = promise`、resolve promise`$scope.$broadcast`等。不过，对我来说，这些事件设计感觉......笨拙......它也感觉紧密耦合。我希望我的 ContentController 不会被其中可能包含或可能不包含的内容所困扰。

另一种方法是`$watch`您想要的变量的范围，例如`$scope.$watch('content.uid', function(newValue) {})`. 与上述解决方案相比，这感觉更好，并且耦合度更低。虽然仍然不完美..至少对我来说。

我觉得最好的解决方案是我不知道如何实现的解决方案。我希望控制器能够..延迟子控制器，如果它*（父）*正在做一些异步的事情。我觉得这比一个事件要好，因为它*隐含*的简单。它本质上仍然是一个事件广播，但希望语法是干净的，因为只有一个“事件”。它要么不完整，要么完整。不过，我不确定如果不使用上述事件方法之一，这样的事情是否可能实现。无论如何，有没有办法实现这一点？

无论如何，自从我几周前开始学习 Angular 以来，这个问题就一直在我脑海中盘旋。任何有关该主题的见解将不胜感激。

谢谢阅读！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T21:59:32.777

Angular 很容易避免事件设计，或者`$watch`出于您所描述的目的而使用变量，特别是因为 Angular 使很多东西变得如此干净，但这并不意味着您永远不应该使用它们。

也就是说，我使用 Angular 的次数越多，我就越发现自己将数据操作从控制器中拉出，并进入公开“API”供控制器使用的服务和工厂。

例如，假设您有经典的列表视图/详细视图场景，您从列表中选择一个项目，然后在详细视图中显示其信息。

我可能有一个`$resource`支持列表的工厂和一个仅用于管理所选项目的服务：

```
app.factory('Thing', function($resource) {
  return $resource('/things/:id')
});

app.service('Selected', function() {
  this.thing = null;

  this.select = function(thing) { this.thing = thing; }
  this.clear = function(thing) { this.thing = null; }
}); 
```

通过这种方式分解，控制器只负责协调和响应视图。是的，我必须去服务，但这样`$watch`的`Selected`事情或多或少是不可避免的。但是，它确实使您无需直接在数据上查看某些内容，例如`uid`：

```
app.controller('List', function($scope, Thing, Selected) {
  $scope.things = Thing.query();

  // assuming something like 'ng-click="select(thing)"' in the view
  $scope.select = function(thing) {
    Selected.select(thing);
  };
});

app.controller('Detail', function($scope, Selected) {
  $scope.Selected = Selected;

  $scope.$watch('Selected.thing', function(thing) {
    $scope.thing = thing;
  });
}); 
```

然后，假设您需要为选定的“事物”加载评论，您只需`Thing`使用该功能增强您的工厂：

```
app.factory('Thing', function($resource) {
  var Thing = $resource('/things/:id');

  Thing.prototype.CommentResource = $resource('/things/:thingId/comments/:id');

  return Thing.
}); 
```

然后从您的控制器中使用该功能。

```
app.controller('Detail', function($scope, Selected) {
  $scope.Selected = Selected;

  $scope.$watch('Selected.thing', function(thing) {
    $scope.thing = thing;
    $scope.comments = thing.CommentResource.query({id: thing.id});
  });
}); 
```

## 概括

我知道在使用 Angular 时做“恢复到旧方式”的感觉时会感到恶心。

我认为诀窍是从控制器中提取除协调之外的所有内容，然后即使您必须使用一些事件或分配一堆`$watches`，您仍然以松散耦合的方式这样做。

这只是我的两分钱，希望它有用。

# ember.js - ember.js containerview 视图控制器绑定不起作用

> ID：15012389
> 
> 赞同：0
> 
> 时间：2013-02-21T21:16:28.030
> 
> 标签：ember.js

我的 Ember 代码没有将孩子的视图绑定到 ContainerView 控制器下的控制器

我有一个模板“指标”，MetricsView 没有从其控制器中提取标题属性值。这是容器视图下的子视图，与容器视图下的所有其他视图相同。

这是我正在使用的代码片段：

这就是我的容器视图的样子

```
// Container View
App.DashboardContainerView = Ember.ContainerView.create({
    childViews: [],
    view1: App.MetricsView,
    view2: App.ResultsView,
}); 
```

这就是我的子视图的样子： App.MetricsView = Ember.View.create({ template: Ember.TEMPLATES["metrics"] });

这就是我的子视图容器的样子： // 子视图的控制器，它没有与子视图绑定，// 想要从这个控制器呈现标题到模板

```
App.MetricsController = Ember.ObjectController.extend({
    title: 'Metrics Page', // To Be deleted later
    content : []
    metrics : [],

    view: Ember.View.create({
      templateName: 'metrics'
    }),

    show : function(petId, onDone, onFail) {
        _get('/fetch_one', onDone, onFail);
    },
}); 
```

子模板 // 这里 {{title}} 不在 UI 上打印，而是“-- Summary”打印

```
<script type="text/x-handlebars" data-template-name="metrics">
    <div class='well well-large'>
        <div class="container">
            <div class="row">
                <div class="span9">
                    <h4>{{title}}</h4>
                    <h4> -- Summary</h4>
                </div>
                <div class="span1">
                    <button {{action "toggle" }} class="close">&times;</button>
                </div>
            </div>
        </div>
    </div>
</script> 
```

其他一些支持的代码：

```
var App = Ember.Application.create({
    appName: 'Portal',
    debug: true,
    demomode: 1,
    version: '0.0.1'
});

App.Router.map (function () {
    this.resource('pets');
    this.resource('pet', {path: ':pet_id'}, function(){
        this.resource('dashboard');
        this.resource('list', function() {
            this.route('summary');
            this.route('results');
        });
    });
});

//ApplicationRoute
App.ApplicationRoute = Ember.Route.extend({
    setupController: function(){
    },
});

App.IndexRoute = Ember.Route.extend({
    redirect : function() {
        this.transitionTo('pets');
    }
});

App.PetsRoute = Ember.Route.extend({
    model: function() {
        return App.Pet.find();
    },
    renderTemplate: function () {
        this.render({ outlet: 'rightpane' });
    }
});

App.PetsController = Ember.ArrayController.extend({
    sortProperties : [ 'first_name' ],
    sortAscending : true
});

App.DashboardRoute = Ember.Route.extend({
    setupController: function(){
        var menuItems;
        if (App.DashboardContainerView.get('childViews')) {
            App.DashboardContainerView.get('childViews').pushObject(App.DashboardContainerView.view1);
            App.DashboardContainerView.get('childViews').pushObject(App.DashboardContainerView.view2);

            menuItems = this.controllerFor('petDashboardMenu').get('model');
            $(menuItems).each(function(index, menuItem) {
                if (menuItem.id == 1 || menuItem.id == 2) {
                    alert(menuItem);
                }
            }); //TODO: Make the menu buttons active for which view is added.
        }

        //this.controllerFor('pets').set('model', App.Preference.find({ name: "Dennis" }));
        this.controllerFor('petDashboardMenu').set('model', App.PetMenuItem.find());
    },
    renderTemplate: function () {
        this.render({ outlet: 'rightpane' });
    }
});

App.DashboardController = Ember.ObjectController.extend({
    name: 'Dashboard'
});

App.PetDashboardMenuController = Ember.ArrayController.extend({
    toggleMenuItem: function(menuItem) {
        var link = $(event.srcElement);
        var childViews = App.DashboardContainerView.get('childViews');
        if (link.hasClass('active')) {
            link.removeClass('active');
            var present = false;
            switch (link.text()) {
                case 'Summary':
                    present = App.DashboardContainerView.get('childViews').indexOf(App.DashboardContainerView.view1);
                    break;
                case 'Results':
                    present = App.DashboardContainerView.get('childViews').indexOf(App.DashboardContainerView.view2);
                    break;
                default:
                    present = App.DashboardContainerView.get('childViews').indexOf(App.DashboardContainerView.view1);
            }
            if(present >= 0) {
                // ToDo : For All Menu Items
                switch (link.text()) {
                    case 'Summary':
                        App.DashboardContainerView.get('childViews').removeObject(App.DashboardContainerView.view1);
                        break;
                    case 'Results':
                        App.DashboardContainerView.get('childViews').removeObject(App.DashboardContainerView.view2);
                        break;
                    default:
                        App.DashboardContainerView.get('childViews').removeObject(App.DashboardContainerView.view1);
                }
                App.log('Removed Summary : Removed : View Count : ' + App.DashboardContainerView.get('childViews').length);
            } else {
                App.log('Removed Summary : Already Not Present : View Count : ' + App.DashboardContainerView.get('childViews').length);
            }
        } else {
            link.addClass('active');
            var present = null;
            App.log('Link Text : "' + link.text() + '"');
            switch (link.text()) {
                case 'Summary':
                    present = App.DashboardContainerView.get('childViews').indexOf(App.DashboardContainerView.view1);
                    break;
                case 'Results':
                    present = App.DashboardContainerView.get('childViews').indexOf(App.DashboardContainerView.view2);
                    break;
                default:
                    present = App.DashboardContainerView.get('childViews').indexOf(App.DashboardContainerView.view1);
            }

            if(present >= 0) {
                App.log('Adding Summary : Already Present : View Count : ' + App.DashboardContainerView.get('childViews').length);
            } else {
                // ToDo : For All Menu Items
                switch (link.text()) {
                    case 'Summary':
                        App.DashboardContainerView.get('childViews').pushObject(App.DashboardContainerView.view1);
                        break;
                    case 'Results':
                        App.DashboardContainerView.get('childViews').pushObject(App.DashboardContainerView.view2);
                        break;
                    default:
                        App.DashboardContainerView.get('childViews').pushObject(App.DashboardContainerView.view1);
                }
                App.log('Added Summary : View Count : ' + App.DashboardContainerView.get('childViews').length);
            }
        }
    }
});

App.log = function(message) {
    if(App.debug) {
        console.log(message);
    }
}; 
```

任何指针将不胜感激？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T21:55:09.220

当我发现该功能已被弃用时，我很难解决这个确切的问题。我收到以下警告：

> 通过其 childViews 属性操作 Ember.ContainerView 已被弃用。请使用 ContainerView 实例本身作为 Ember.MutableArray。

您需要按照[文档](http://emberjs.com/api/classes/Ember.ContainerView.html)所述使用 pushObject 。

# .net - 成员资格并将用户链接到自定义表

> ID：15012395
> 
> 赞同：0
> 
> 时间：2013-02-21T21:16:51.753
> 
> 标签：.net, asp.net-mvc, asp.net-membership

基本上我想使用默认的.Net成员资格，因为我不需要任何特殊的用户作为一个整体，但我需要将用户连接到一种日志/历史表，它是否像制作一样简单该表中用户ID的外键？还是有更复杂的技巧？

我还想创建一个视图模型，其中包含一些用户数据`ID`，例如`UserName`等（类似于`RegisterModel`），但我将用于应用程序内的日志/历史记录。在我看来，这是可能的，但有些东西让我烦恼......

那么，可能与否？

**更新**

```
UserModel                             LogModel
public Guid ID {get; set;}            public int ID {get; set;}
public string UserName {get; set;}    public string ActionTaken {get; set;}
public string Email {get; set;}       public Guid UserID {get; set;}
                                      public virtual UserModel User {get; set;} 
```

需要注意的是，我先做数据库，然后使用`DbContext`EF 工具开始代码生成，然后我添加我认为必要的内容。

我的第一个意见是我缺少一些映射或类似的东西......

# ios - 有没有办法从 FB 登录对话框中排除“创建新帐户”按钮？

> ID：15012396
> 
> 赞同：1
> 
> 时间：2013-02-21T21:16:56.577
> 
> 标签：ios, facebook

我正在为孩子们更新一个 iOS 应用程序，该应用程序使用 FB 连接 API 将创作发布到他们的墙上。最近，“创建新帐户”按钮出现在 Web 视图中显示的登录对话框中。有没有一种简单的方法可以在不创建自定义 UI 和重写整个 FB 功能的情况下排除这种情况？

谢谢

# android - 是否可以在android上访问原始音频？

> ID：15012397
> 
> 赞同：0
> 
> 时间：2013-02-21T21:17:07.090
> 
> 标签：android, audio

我在互联网上查看了该答案，但在我看来，我们只能访问均衡器类，而不能访问原始音频本身。

我想制作一个应用程序，在播放声音（来自任何应用程序）之前对其进行一些转换。

有根设备是实现这一目标的方法吗？

如果是的话，你能给我一些思考吗？

# ocaml - OCaml 编译器是否支持真正的模块别名？

> ID：15012401
> 
> 赞同：4
> 
> 时间：2013-02-21T21:17:13.900
> 
> 标签：ocaml

我创建了一个新模块，它只是名称很长的模块的较短别名：

```
module M = ModuleWithLongName 
```

我处于最终可执行文件的大小很重要的情况。上面的构造是由编译器合理处理的（即`M`实际上只是一个别名），还是复制了`ModuleWithLongName`模块内部`M`定义的全部内容？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T22:16:42.930

不，OCaml 语言不支持“真正的模块别名”。

但是，在您尝试相当高级的仿函数和抽象类型组合之前，您可能不会注意到。特别是，您只能在类型系统中观察到这个问题，而不是在程序的运行时行为中观察到：模块有时会被复制，但可变状态会在副本之间被别名（在您的示例中，如果`ModuleWithLongName.foo`是可变引用，那么`M.foo`是相同的参考）。

如果您使用一流的模块，或者在深度嵌套的函数中定义本地模块，您可能会观察到模块复制操作是整个计算中不可忽略的成本。推理一流模块性能的正确心智模型是，在类型检查和模块检查之后，它们就是记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-28T09:30:14.150

从 4.02 版本开始，OCaml 支持[真正的模块别名](https://blogs.janestreet.com/better-namespaces-through-module-aliases/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T23:00:12.423

我认为是 module_path 的别名。

模块 moduleName = module_expr

和 module_expr ::= module_path | ...

请参阅[module_expr 生产语法](http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual019.html#module-expr)

# iphone - 从数组的 plist 添加数据

> ID：15012403
> 
> 赞同：0
> 
> 时间：2013-02-21T21:17:21.070
> 
> 标签：iphone, xcode, arrays, nsmutablearray, plist

所以我是编程新手，并且已经坚持了好几天......我有一个数组，如图所示

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com    /DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
    <dict>
    <key>question</key>
    <string>2 + 2 = ?</string>
    <key>A</key>
    <string>2</string>
    <key>B</key>
    <string>7</string>
    <key>C</key>
    <string>3</string>
</dict>
<dict>
    <key>question</key>
    <string>2 + 3 = ?</string>
    <key>A</key>
    <string>5</string>
    <key>B</key>
    <string>2</string>
    <key>C</key>
    <string>6</string>
</dict>
</array>
</plist> 
```

然后我想为每个存储一个数组。然后，我在故事板中为每个标签设置了一个标签，并希望将每个键分配给不同的标签，但我似乎做错了。这是我的代码

```
- (void)showNextQuestion
{
    NSArray *rootArray = [NSArray arrayWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"question" ofType:@"plist"]];
    int numItems = [rootArray count];
    currentQuestion = -1;
    currentQuestion++;

    NSMutableArray *question = [NSMutableArray arrayWithCapacity:numItems];
    NSMutableArray *A = [NSMutableArray arrayWithCapacity:numItems];
    NSMutableArray *B = [NSMutableArray arrayWithCapacity:numItems];
    NSMutableArray *C = [NSMutableArray arrayWithCapacity:numItems];

    for (NSDictionary *itemData in rootArray) {
        [question addObject:[itemData objectForKey:@"question"]];
        [A addObject:[itemData objectForKey:@"A"]];
        [B addObject:[itemData objectForKey:@"B"]];
        [C addObject:[itemData objectForKey:@"C"]];

        self.questionasked.text =question;
        self.answer1.text = A;
        self.answer2.text = B;
        self.answer3.text = C;
    }
} 
```

4个标签是问题，answer1，answer2，answer3......我如何正确分配它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:31:38.813

至少，您应该从 for 循环中删除分配并重写为：

```
 self.questionasked.text =question[currentQuestion];
    self.answer1.text = A[currentQuestion];
    self.answer2.text = B[currentQuestion];
    self.answer3.text = C[currentQuestion]; 
```

我还建议您只加载一次文件（而不是在每个 showNextQuestion 调用上）

此外，您的设置`currentQuestion=-1`只会向您显示第一个问题，无论您调用多少次。将此语句移动到构造函数或仅执行一次的地方。

# javascript - 如何区分AngularJS中注入模块的命名空间？

> ID：15012406
> 
> 赞同：5
> 
> 时间：2013-02-21T21:17:27.597
> 
> 标签：javascript, namespaces, angularjs

假设我有一个控制器，它依赖于两个模块，它们都包含同名的指令或服务。我可以指定到底应该使用哪一个吗？

```
angular.module('myApp', ['secondModule', 'thirdModule'])
    .controller('Ctrl1', ['$scope', 'myService', function(scope, myService){
        scope.user = myService.getUser();   
        console.log(myService); 
}]); 
```

在这种情况下，**secondModule**和**thirdModule**都有一个名为**myService**的服务。但是在这个例子中只使用了来自**thirdModule的那个。**我尝试将 secondModule.myService 之类的东西**作为****Ctrl1**的依赖项，但它不起作用。AngularJS 中有某种命名空间吗？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:31:05.797

目前，不，没有基于模块的命名空间。你必须自己避免碰撞。

我相信有一些关于这个的讨论，但我现在找不到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T00:35:15.287

我使用以下约定：[https ://github.com/roytruelove/angular-grunt-coffeescript#modules-and-angular-items](https://github.com/roytruelove/angular-grunt-coffeescript#modules-and-angular-items)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-26T15:39:45.223

如何命名服务（以及控制器）？

```
angular.module('secondModule', [])
    .factory('secondModule.myService', function($http) {
        return {
            getUser: function() { /* some code here */ }
        };
    });

angular.module('thirdModule', [])
    .factory('thirdModule.myService', function($http) {
        return {
            getGroup: function() { /* some code here */ }
        };
    });

angular.module('myApp', ['secondModule', 'thirdModule'])
    .controller('myApp.Ctrl1',
        ['$scope', 'secondModule.myService', function(scope, myService){
            scope.user = myService.getUser();   
            console.log(myService); 
        }]
    ); 
```**

# java - 使用注释分配 spring bean

> ID：15012413
> 
> 赞同：0
> 
> 时间：2013-02-21T21:17:48.803
> 
> 标签：java, spring, jsf, annotations, javabeans

我是注释新手，我正在尝试 jsf(2.0) spring (3.1) 集成，我可以集成这两个框架，但我在 JSF 中没有 viewScope，因为它不可用。我想使用注解在jsf managedBean中自动注入spring bean，但我不能，因为Spring只支持会话和请求范围bean。

我使用检索 bean 的 Util 类。“SprigUtil.getBean('bean')”。并在需要时手动检索弹簧豆。

我想做一些这样的事情

```
@CustomAnnotation('beanTest')
private Bean bean; 
```

因此，bean 属性将使用 beanTest bean 进行设置。

我的目标（撇开春天）是知道如何做这样的事情

```
@assign('House')
private String place; 
```

当我调用`getMethod`获取“房子”时。instance.getPlace()，返回“房子”

注意：我知道 @Autowired 但我不能使用它，因为 ViewScope 在 spring-jsf 集成中不可用。

我阅读了有关手动实现视图范围的信息，但想尝试不同的解决方案。

编辑：

我的 Faces 配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-facesconfig_2_1.xsd"
    version="2.1">
    <application>
        <el-resolver>             org.springframework.web.jsf.el.SpringBeanFacesELResolver
        </el-resolver>
    </application>
</faces-config> 
```

还有我的 appContext

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:component-scan base-package="*" />

</beans> 
```

我的春豆

```
@Component
public class ProductService{

} 
```

我的托管 Bean

```
@Component
@Scope("request")//I need to use @Scope("view") but it doesn't exist
public ProductBean implements Serializable{
@Autowired
ProductService productoService;

} 
```

如果我使用 jsf 注释 @ManagedBean 和 @ViewScoped productService 未注入（为空）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T10:17:06.520

[您可以使用@ManagedProperty](http://docs.oracle.com/cd/E17802_01/j2ee/javaee/javaserverfaces/2.0/docs/managed-bean-api/javax/faces/bean/ManagedProperty.html)将 spring bean 注入视图范围的托管 bean

对于名为 B 的弹簧组件

```
@ManagedProperty("#{B}")
private B b;

public void setB(B b) {
this.b = b;
} 
```

应该管用。

至于您发布的代码，Component 是一个 Spring 注释，要使用 ViewScoped，您必须使用 ManagedBean 注释来注释您的类：

```
@ManagedBean
@ViewScoped
public ProductBean implements Serializable {
@ManagedProperty("#{productService}")
private ProductService productService;

public void setProductService(ProductService productService) {
    this.productService = productService;
  }
 } 
```

您可能想查看以下链接以更好地理解 JSF 2.0 中的作用域 JSF 2.0[中的通信](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ManagedBeanScopes)

# php - PHP & MySQL：第二个中的表条目列表

> ID：15012414
> 
> 赞同：0
> 
> 时间：2013-02-21T21:17:52.707
> 
> 标签：php, mysql, arrays

我正在开发一个带有 MySQL 数据库的网站，其中包含 2 个表，一个包含用户信息，另一个包含礼物信息。我想存储谁支付了部分不同礼物的信息，以及给他以后更改礼物的可能性。

我会在礼物表中添加一个条目，其中包含捐赠的用户数组和金额。如果以后有人想更改，我更改金额或删除条目并更新显示的礼物剩余金额。

但我认为从可变长度数组开始并不是最佳选择。也许在数据库中创建一个带有捐赠用户和每个礼物金额的新表会更好，但编码和管理也会更复杂（我希望只有两个表）。

有人对我的困境有什么建议吗？

编辑：根据@Lighthart 的建议，我找到了解决方案。我将为每个礼物创建一个包含一个字段的表格。如果用户捐赠礼物，我会为用户创建一个新条目并为相关礼物字段设置金额。如果用户更改金额，我会更新条目。我可以通过添加一份礼物的所有条目来轻松计算剩余金额。如果您还有改进我的解决方案的想法，请不要犹豫！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:20:50.793

如果您反对可变长度数组，则需要使用多对多表来解决此问题。这将是多对多（称为关联类）的特殊情况，除了外键之外，您还有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:27:39.710

我同意 Lighthart 的观点——这确实是一个三桌解决方案：用户桌、礼物桌和捐赠桌：

```
USER(userID [PK], firstName, lastName, email, passwordHash)
GIFT(giftID [PK], title, description, totalCost, dateAdded, owner [FK])
DONATION(donationID [PK], donatingUser [FK], giftDonatedTo [FK], amount, date) 
```

[PK] = 主键，[FK] = 外键

这样，如果有人想稍后更改他们的捐赠金额，您将对特定的donationID 记录执行 SQL UPDATE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:24:17.500

为此，您可能需要许多表。在我的脑海中，我能想到：

```
users -> people in system (gist donors and recipients)
gifts -> list of gifts that can be given.
users_gifts -> table relating gifts that have been (or are being) given to the user who will be receiving them
users_gifts_donors -> table relating items in users_gifts to donors (users) and also storing information about the amount of donation towards to gift 
```

# qt - 当焦点丢失时，QT QSystemTrayIcon 上下文菜单保持活动状态

> ID：15012417
> 
> 赞同：1
> 
> 时间：2013-02-21T21:18:14.343
> 
> 标签：qt

我在 Qt 中使用上下文菜单实现了 QSystemTrayIcon。右键单击任务栏中的图标时上下文菜单会自动显示，并且在失去焦点时也会适当地消失。

但是，我还将 QSystemTrayIcon 的激活信号连接到将显示上下文菜单的函数。这在 Ubuntu 中运行良好，但在 Windows 7 上显示上下文菜单，但在失去焦点时不会消失。我尝试了以下显示方式：

托盘图标菜单->执行（QCursor::pos()）；// 显示在正确的位置，但不会消失 trayIconMenu->popup(QCursor::pos()); // 与 exec() 相同 trayIconMenu->show(); // 显示在错误的位置，也不会消失。

有谁知道我该如何解决这个问题？

谢谢，

格里

# php - domdocument removeChild 结果不一致

> ID：15012419
> 
> 赞同：0
> 
> 时间：2013-02-21T21:18:17.597
> 
> 标签：php, xml, domdocument

domdocument 在任何地方（包括 SO）都没有很好的记录，所以我想我会在这里问这个问题。我有一个 PHP/XML 博客，并希望让博主能够一次删除多个博客文章。以下代码在两个帖子 ID 无序或不相互跟随时有效。

example - when post id 1 and post id 4 are selected, they both delete. 但是当post 1和post 2被选中时，只有2被删除。每次的行为都是一致的。有没有人遇到过这种情况，或者在我的代码中看到会导致这种情况的东西？

伪 XML：
`<root>`
`<blog id=1><copy>Some copy</copy></blog>`
`<blog id=2><copy>Another block of copy</copy></blog>`
`<blog id=3><copy>Last chance copy</copy></blog>`
`</root>`

删除博客文章的 PHP 代码（较大类的片段）：

```
 /**
     * method usage: $objVar->deletePost($param)
     * delete client selected xml[blog] entries
     * @param array, $params : assign $_POST array as argument
     * @return string, XML
     */
    public function deletePost($params) {

    foreach ($params as $value){ // assign $param['delete[n]'] to array
        $pid=$value;   // array[n][id]
    }

    $xml = new DOMDocument(); // instance of current xml
    $xml->load($this->fp);    // path to file
    $xml->preserveWhiteSpace = false;

    //define xpath object, called with query() line 273
    $xpath = new DOMXpath($xml);

    //create temporary DOM xml
    $tempxml = $xml->documentElement;

    $pnode = $xml->getElementsByTagName('blog');
     foreach($pnode as $key){       //outter loop thru parent nodes
      foreach($pid as $v){          //inner loop thru pid array
      if ($key->getAttribute('id')==$v){    //if pid matches blog[id=n]
        $path = "//root/blog[@id=".$v."]";
        $nodelist = $xpath->query($path);
        $removenode = $nodelist->item(0);

        //remove the parent/children for matching ids
        $oldxml = $tempxml->removeChild($removenode);
      }
     }
    }
    echo $xml->saveXML();

  } 
```

一如既往，提前感谢

# node.js - Nodejs检查是否已经过了XX时间

> ID：15012428
> 
> 赞同：0
> 
> 时间：2013-02-21T21:18:45.207
> 
> 标签：node.js

在 PHP 中，我使用以下命令查看是否已过 30 分钟：

```
if(strtotime($rowFromMysql['last_visit']) < (time() -(30*60))) {
        $database->query("UPDATE `visit_count` SET visitCount = visitCount + 1, cookieId = '$sid', last_visit='$idag' WHERE cookieId = '$sid' AND ipaddress = '$ip' AND user_id = '$ssid'");

    } 
```

我将如何在 Nodejs 中进行相同的检查？

我从 MySQL 中选择相同的数据，但使用 nodejs 而不是 PHP，但不知道如何查看 30 分钟是否已经过去。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T23:22:38.013

[`Date`您可以使用objects](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)执行类似于您的代码的操作：

```
var lastVisit = new Date(getLastVisit());

var thirtyMinutes = 30 * 60000; // 60000 being the number of milliseconds in a minute
var now = new Date();
var thirtyMinutesAgo = new Date(now - thirtyMinutes);

if (lastVisit < thirtyMinutesAgo) {
  updateVisitCount();
} 
```

`getLastVisit()`应该查询您的数据库并返回您的上次访问日期：

*   value：整数值，表示自 1970 年 1 月 1 日 00:00:00 UTC（Unix 纪元）以来的毫秒数。
*   dateString：表示日期的字符串值。该字符串应采用解析方法可识别的格式（符合 IETF 的 RFC 2822 时间戳）。

# boolean - 布尔代数和德摩根定律

> ID：15012439
> 
> 赞同：-3
> 
> 时间：2013-02-21T21:19:26.470
> 
> 标签：boolean, boolean-logic

我试图找到一个函数的补码：`X(Y+Z!W+!VS)`利用德摩根定律。

我还需要将结果表示为产品总和。

我认为补充应该是：`!X + (Y!(Z+!W)(V!S))`但我不确定......

然后，即使我不确定如何将其转换为产品总和形式。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:41:45.287

```
 ![X(Y+Z!W+!VS)]
= ![XY + XZ!W + X!VS]                                  distributive law
= !(XY)!(XZ!W)!(X!VS)                                  De Morgan's law
= (!X+!Y)(!X+!Z+W)(!X+V+!S)                            De Morgan's law
= (!X!X+!X!Z+!X!W+!Y!X+!Y!Z+!YW)(!X+V+!S)              distributive law
= (!X+!Y!Z+!YW)(!X+V+!S)                               x OR (x AND y) = x
= !X!X+!XV+!X!S+!Y!Z!X+!Y!ZV+!Y!Z!S+!YW!X+!YWV+!YW!S   distributive law
= !X+!Y!ZV+!Y!Z!S+!YWV+!YW!S                           x OR (x AND y) = x 
```

这是乘积之和的形式。再进一步...

```
= !X+!Y(!Z+W)(V+!S)                                    distributive law 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:46:11.350

要实现 DeMorgans，通常最容易将事情分解成小部分

```
result=!(XA),    (A= Y+Z!W+!VS) Simplify!
!X + !A                   DeMorgans
A = Y+B      (B= Z!W+!VS) Simplify!
!A = !Y!B                 DeMorgans
B= C+D     (C= Z!W     D= !VS) Simplify!
!B = !C!D                  DeMorgans
!C = !Z+W                 DeMorgans
!D = V+!S                 DeMorgans
!B = (!Z+W)(V+!S)         Put it back together!
!A = !Y(!Z+W)(V+!S)
result = !X+!Y(!Z+W)(V+!S) 
```

要将其纳入[产品总和](http://en.wikipedia.org/wiki/Canonical_form_%28Boolean_algebra%29)，需要更多的代数。

```
 !X already ok
 + !Y(!Z+W)(V+!S)             not ok, let's call it !Y!B again.
 !B= (!Z+W)(V+!S)             remember this?
 !B= !ZV+!Z!S+WV+W!S          distribute!
 -> !X + !Y(!ZV+!Z!S+WV+W!S)  put it back together... still not quite right
 !X + !Y!ZV + !Y!Z!S + !YWV + !YW!S    distribute again! 
```

现在我们有一个产品总和： !X + !Y!ZV + !Y!Z!S + !YWV + !YW!S

# google-apps-script - 在一天中的特定时间通过电子邮件发送电子表格中的数据

> ID：15012446
> 
> 赞同：1
> 
> 时间：2013-02-21T21:19:50.527
> 
> 标签：google-apps-script, google-sheets

我是 Google Scripts 的新手，我需要找到一种方法，将 Google 电子表格中收集的数据通过电子邮件发送到 Gmail 帐户。

我设置了一个 Google 表单，用于记录全天的客户服务统计信息。响应被收集到电子表格中。每天都会清理电子表格，以便为第二天的回复做好准备。我需要找到一种方法，让所有收集到的回复在每天结束时通过电子邮件发送到报告中。

从我到目前为止所做的搜索来看，我认为 getRange 和 getValues 是必需的，但我不知道如何编写代码来检索工作表上的所有数据。电子表格总是有 4 个集合列，但生成的行数取决于每天收集的统计数据的数量。我发现 getLastRow 可以解决这个问题，但是如何将它与 getRange 和 getValues 一起使用？

我尝试编写一个非常基本的脚本来完成这项工作，但它所做的只是通过电子邮件发送 A1 单元格中的值。我需要所有的数据。我使用时间触发器来控制它何时运行。我究竟做错了什么？

```
function emailStats() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();
  var dataRange = sheet.getActiveRange().getValues();
  var subject = "Daily Report of Customer Service Statistics";
  MailApp.sendEmail("pnnmeetingroom@gmail.com", subject, dataRange);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-27T23:22:10.843

变化：

*   [`getDataRange()`](https://developers.google.com/apps-script/reference/spreadsheet/sheet?hl=en#getDataRange%28%29)
*   从检索到的数组生成 HTML 表`.getValues()`。请参阅[从 2D JavaScript 数组生成 HTML 表](https://stackoverflow.com/a/15164796/1677912)。

代码：

```
function emailStats() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();
  var data = sheet.getDataRange().getValues();
  var subject = "Daily Report of Customer Service Statistics";
  MailApp.sendEmail("pnnmeetingroom@gmail.com", subject, createTable(data));
} 
```

# d3.js - 使用 D3 库时，有什么方法可以强制转换立即发生

> ID：15012447
> 
> 赞同：2
> 
> 时间：2013-02-21T21:20:01.100
> 
> 标签：d3.js

因此，如前所述，我想强制转换在 for 循环中发生，而不是等待循环结束。我希望这样做的原因是因为我试图调用 d3 数据数组的索引。我的最终目标是让 3 个节点遵循 GPS 坐标路径，json 的布局如下 { ID: 1 [[ lat , lon , time],[lat2, lon, time2]], ID: 2...}因此，我试图检查转换中的时间跳跃，并且只收到最后一个条目。我正在使用它并用多边形地图覆盖它这是我正在处理的代码块

```
for(var i = 1; i < layers.length -1; i++){
        var t = layers[i].transition().duration(3000);
        var l = 0
        var j = 0
        var help = map.extent()[0].lon;
        var help2 = map.extent()[1].lon;
        var scale = (templon1 - templon2) / (help - help2); 

        t.selectAll(".t1")
        .attr("transform",function(d){
            x = map.locationPoint({lon: d[0][1], lat: d[0][0]});
            d = map.locationPoint({lon: d[5000][1], lat: d[5000][0]});
            l = d.x - x.x
            j = d.y - x.y
            return ("translate(" + l / scale + "," + j / scale + ")"); 

        });
        t.selectAll(".t2")
        .attr("transform",function(d){
            x = map.locationPoint({lon: d[0][1], lat: d[0][0]});
            d = map.locationPoint({lon: d[5000][1], lat: d[5000][0]});
            l = d.x - x.x
            j = d.y - x.y
            return ("translate(" + l / scale + "," + j / scale + ")"); 
        });
    } 
```

# javascript - 如何以编程方式在 iPad 上滚动窗口？

> ID：15012449
> 
> 赞同：11
> 
> 时间：2013-02-21T21:20:03.410
> 
> 标签：javascript, ipad, safari, scroll

我的应用程序包含几个以编程方式滚动到页面上特定元素的功能。不幸的是，它不适用于 Safari/iPad。我尝试了以下滚动方法：

```
window.scroll(0, y);

window.scrollTo(0, y);

$(window).scrollTop(y);

$('html, body').animate({
    scrollTop: y
}); 
```

是否根本不可能以编程方式在 Safari/iPad 上滚动窗口，或者我只是做错了？所有这些方法都适用于我在 PC 上测试的所有浏览器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-08-03T15:04:24.907

我还没有找到在 iPad 上以编程方式滚动窗口的方法。一种可能的解决方法是将页面内容包装在一个固定的 div 容器中，并通过更改 div 的`scrollTop`属性来滚动它。[**您可以在此 codepen**](https://codepen.io/ConnorsFan/pen/KvgNKz)中看到该方法。我在 iPad 上使用 Safari 和 Chrome 以及在 Windows 上使用 Firefox、Chrome 和 IE11 成功测试了它。

**HTML**

```
<div id="container">
    <div class="div1"></div>
    <div class="div2"></div>
    <div class="div3"></div>
    ...
</div> 
```

**CSS**

```
div#container {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow-y: auto;
}
div {
    height: 100px;
}
.div1 {
    background-color: red;
}
.div2 {
    background-color: green;
}
.div3 {
    background-color: yellow;
} 
```

**Javascript**

```
var container = document.getElementById("container");
setInterval(function() {
    container.scrollTop += 1;
}, 20); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-02T15:24:27.913

您是否尝试过任何库？ [http://iscrolljs.com/](http://iscrolljs.com/)看起来很有希望，但我无法测试（没有 iOS 设备）。

*   对滚动位置的精细控制，即使在动量期间也是如此。您始终可以获取和设置滚动条的 x,y 坐标。
*   开箱即用的多平台支持。从旧的 Android 设备到最新的 iPhone，从 Chrome 到 Internet Explorer。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-08T07:17:42.293

它在 Safari 和 iPad 上对我来说工作正常：

```
$('html, body').animate({
        scrollTop: 0
 }, 1000); 
```

不确定，但您可以通过以毫秒为单位提供一些滚动动画时间来尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-09T13:33:36.683

我使用 GreenSock ScrollTo 插件，它可以创造奇迹。你可以从[他们的网站上获取](https://greensock.com/ScrollToPlugin)

优点是它具有宽松的选项并适用于任何平台等

```
$("button").each(function(index, element){
  $(this).click(function(){
    TweenLite.to(window, 1, {scrollTo:{y:"#section" + (index+1),   offsetY:70}});
  })
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-09T07:35:45.017

我正在使用以下 jquery 代码，它适用于每个浏览器（我不使用 IE :)）

```
 $("html,body").animate({
    scrollTop: 0
}, "slow"); 
```

**跨浏览器滚动到顶部：**

```
 if($('body').scrollTop()>0){
        $('body').scrollTop(0);         //Chrome,Safari
    }else{
        if($('html').scrollTop()>0){    //IE, FF
            $('html').scrollTop(0);
        }
    } 
```

**跨浏览器使用 id = test_id 的 div：**

```
 if($('body').scrollTop()>$('#test_id').offset().top){
        $('body').scrollTop($('#test_id').offset().top);         //Chrome,Safari
    }else{
        if($('html').scrollTop()>$('#test_id').offset().top){    //IE, FF
            $('html').scrollTop($('#test_id').offset().top);
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-14T04:01:05.693

似乎 safari 根本不喜欢“html”，而其他人不喜欢“body”。并且 ('html, body') 也不会削减它。所以一个简单的解决方案可能是；

```
function example() {
if($.browser.safari) scrollentity = $("body"); 
else scrollentity = $("html");
scrollentity .animate({scrollTop: $("#target").offset().top}, 1500, 'swing')
} 
```

# postgresql - 如何配置 pgAdmin III 以在启动时打开默认数据库并选择表节点？

> ID：15012452
> 
> 赞同：10
> 
> 时间：2013-02-21T21:20:21.833
> 
> 标签：postgresql, pgadmin

当我启动 pgAdmin III 时，99% 的时间都需要查看一个特定数据库的表。每次点击树都非常烦人。当我打开 pgAdmin 时，我希望它自动连接到我的最后一个数据库并展开左侧的树并选择“表”节点。

那可能吗？

同样令人讨厌的是，当我重命名一列时，树节点选择丢失，我必须再次打开整个树。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T11:25:42.813

有一个相关选项：**恢复 env**。默认*开启*。

打开（关闭的）连接的上下文菜单并转到“高级”选项卡。我在这里引用[pgAdmin 1.16 的手册](http://pgadmin.org/docs/1.16/connect.html)：

> “恢复环境？” 选项确定当您重新连接到此服务器时 pgAdmin 是否会尝试恢复浏览器环境。如果您经常在同一台服务器上使用不同的数据库，您可能需要关闭此选项。

它不会永远限制一个特定的状态，而是在你离开的地方重新打开。因为你 99% 的时间都在同一个地方，所以这对你来说应该很好。

据我所知，您的第二个问题（DDL 更改后浏览器失去焦点）是当前版本的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-10T18:01:59.720

当前版本的更新：

在 pgAdmin 4 中，如果您断开与服务器的连接并转到高级选项卡，您可以在“DB Restriction”字段中输入数据库的名称。这将在未来连接时仅使用那些数据库填充导航列表。

# ruby-on-rails - 使用单元测试、Rspec、Cucumber 和 Capybara 有什么意义吗？

> ID：15012453
> 
> 赞同：0
> 
> 时间：2013-02-21T21:20:26.427
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing, tdd

我从 Ruby 开始，我阅读了不同的测试方法/框架：单元测试（MiniTest::unit 现在使用最新的 Ruby 版本）、Rspec、Cucumber 和 Capybara。但是我并没有完全掌握它们每个的主要“价值”是什么，与其他的区别开来，我是否可以/应该混合使用它们来确保我们的应用程序经过良好测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:27:24.237

我个人`RSpec`用于功能测试和`capybara`/`cucumber`用于集成测试。 `RSpec`非常适合编写测试以确保我的课程按预期执行。 `Cucumber`非常棒（与 Ca​​pybara 或 webrat 一起）可以确保我的视图按照我期望的方式执行。

测试对于编写 Rails 应用程序来说是一笔巨大的财富。令人惊讶的是，我多久会更改一次，而我的测试发现这种更改会产生意想不到的副作用。它还可以通过在测试中复制它们并通过测试来帮助您解决错误，从而解决错误。

所以：（`rspec`和`FactoryGirl`）确保我的课程做他们应该做的，并`cucumber`确保我的用户以我想要的方式与网站交互。

# c++ - 如何将所有抛出转换为中止条件以进行调试？

> ID：15012457
> 
> 赞同：1
> 
> 时间：2013-02-21T21:20:38.323
> 
> 标签：c++, exception, gdb, g++, abort

在一个重要的程序中，可能有任意数量的异常被抛出和捕获。虽然这是为了防止崩溃，但它使调试变得更加困难（我用 调试`gdb`），因为我看不到在调试二进制文件时抛出异常的点（及其回溯），除非我识别出该行并引入一个中断观点。

`g++`因此，为了便于分析，告诉（或`gdb`？）将所有s 视为严重错误会很有用`throw`，类似于断言失败。如果不破解代码，这是否可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:23:07.030

这是微不足道的。命令是`catch throw`。开始`gdb`将其指向您的可执行文件。发出`catch throw`命令，然后发出`run`命令。

# javascript - 在同一空间添加和调整 DIV 的大小

> ID：15012458
> 
> 赞同：2
> 
> 时间：2013-02-21T21:20:40.127
> 
> 标签：javascript, jquery, html, resize

我想制作一个可以添加多个子 DIV 的栏（例如：http: [//i.imgur.com/vTM7P9v.jpg](http://i.imgur.com/vTM7P9v.jpg)）。我正在使用 jQuery、jQuery UI 和 Bootstrap。加上一些插件。div（或 span）系统可能如下所示：

```
<div class="parent">
    <div class="child" id="1"></div>
    <div class="child" id="2"></div>
    <div class="child" id="3"></div>
</div> 
```

“添加 div”可能如下所示：

```
$('parent').append('<div class="child" id="4"></div>'); 
```

而且我不知道其余的 jQuery / javascript 会是什么样子。我遇到的最大问题之一是，这里的其他威胁无法解决，我希望它也能在移动设备上运行。也许使用 Hammer.js

找了好久了，如果已经发了，请见谅

**更新：**如果我说得不够清楚，你必须拖动 div。就像您可以使用此插件[http://dev.iceburg.net/jquery/jqDnR/](http://dev.iceburg.net/jquery/jqDnR/)一样，但总宽度应保持不变（未调整大小的 DIV 必须变小）

示例：您在 600 像素上有一个条形图。有 3 个子 DIV，每个为 200px。然后你调整其中一个的大小，所以它是 300px。然后其他的是每个150px

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:49:22.897

像这样的东西？

HTML：

```
<input type="button" id="addChild" value="Add Child"/>
<div id="parent" class="parentClass">

</div> 
```

jQuery：

```
var idGen = 0;
$("#addChild").on("click",function(){
    $("#parent").append("<div id='" + idGen++ + "' class='childClass'>Child Div</div>");
}); 
```

CSS：

```
.childClass
{
    background-color:#b0c4de;
    float:left;
    border:1px solid;
    padding:4px;
}
.parentClass
{
    background-color:green;
    width:500px;
} 
```

JSFiddle：http: [//jsfiddle.net/Rrdyw/](http://jsfiddle.net/Rrdyw/)

我还没有测试过，但我相信这也适用于移动设备。

# regex - 替换和查找正则表达式（新手）

> ID：15012459
> 
> 赞同：-2
> 
> 时间：2013-02-21T21:20:41.013
> 
> 标签：regex, replace, find

嗨，我需要正则表达式的两项任务帮助我是新手，看了各种教程，但找不到答案。

1.  你如何重复逗号后面的单词？

    例如，我想找到每次出现的替换，并将其替换为它后面的单词

    例如：猫和狗 --> 猫和狗

2.  你如何替换以“i”或“t”开头的单词，除了单词 I

    比如我要替换这个 --> 我要（新词）替换（新词）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:30:42.693

1.  替换`, ((\w)+)`为`, \1 \1`。

    `\w`表示单词字符（通常`[A-Za-z0-9_]`）

    `(\w)+`表示一个或多个单词字符

    `\1`表示第一个表达式中括号中出现的第一件事（`(\w)+`在这种情况下），并且重复两次，因为`\1 \1`

2.  替换`(\s|^)((i|I)\w+|(t|T))`为`\1NEWWORD`。

    `(a|b)`意味着`a`或`b`

    `^`表示行的开始

    `\s`表示空格

    所以`(\s|^)`意味着空格或行首

    `(i|I)`表示小写或大写`i`

    `(i|I)\w+`表示字母`i`后跟一个或多个字符

    `(t|T)`表示小写或大写`t`

    `((i|I)\w+|(t|T))`表示字母`i`后跟一个或多个字符或该字母`t`

    `NEWWORD`是您要替换的单词

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:27:41.783

第一个正则表达式是：

```
,\s*(\w+) 
```

您将使用 $1 或 \1 反向引用，具体取决于您的语言。

第二个正则表达式是：

```
[iITt]\w+ 
```

而且您不需要任何反向引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:30:39.027

尝试：

```
preg_replace("/,\s*([^\s]++)/", ", $1 $1", $string); 
```

这称为分组和反向引用。除了 $1，您还可以使用 \\1。

更全面的指南：[http ://www.regular-expressions.info/brackets.html](http://www.regular-expressions.info/brackets.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T21:30:47.683

这是 Autoit 代码。也许有助于理解

```
$var = 'This is the test, HelloWorld yeah!'

ConsoleWrite(StringRegExpReplace($var, ',(\s*[a-zA-Z]+)', '$1$1') & @CRLF) 
```

# sql-server - 在sql中将位类型的天字符串转换为当天的首字母字符串

> ID：15012460
> 
> 赞同：0
> 
> 时间：2013-02-21T21:20:42.843
> 
> 标签：sql-server, string, date

我有一个 Days 列，其中有一串 0 和 1 代表一周中的有效天数，为了清楚起见，我需要将其格式化或翻译成一串字母（取决于语言），例如“MTWtFSs”（英语）或“LMmJVSD” （西班牙语）。

此代码有效，但似乎太长了。还有其他想法吗？

```
DECLARE @i INT = 0
       ,@DaysBits VARCHAR(7) = '110010'
       ,@DaysLetters VARCHAR(7) = ''
       ,@DaysMask VARCHAR(7) = 'MTWtFSs'
WHILE @i < 7 
      BEGIN
            SET @i = @i + 1
            IF ( SUBSTRING(@DaysBits, @i, 1) = 1 ) 
               SET @DaysLetters = @DaysLetters + SUBSTRING(@DaysMask, @i, 1)
            ELSE 
               SET @DaysLetters = @DaysLetters + '_' 
      END
SELECT  @DaysBits AS 'Days Bits'
       ,@DaysLetters AS 'Days Letters' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T08:37:28.877

你用一个`case`

```
select case substring(@DaysBits, 1, 1) when 1 then substring(@DaysMask, 1, 1) else '_' end+
       case substring(@DaysBits, 2, 1) when 1 then substring(@DaysMask, 2, 1) else '_' end+
       case substring(@DaysBits, 3, 1) when 1 then substring(@DaysMask, 3, 1) else '_' end+
       case substring(@DaysBits, 4, 1) when 1 then substring(@DaysMask, 4, 1) else '_' end+
       case substring(@DaysBits, 5, 1) when 1 then substring(@DaysMask, 5, 1) else '_' end+
       case substring(@DaysBits, 6, 1) when 1 then substring(@DaysMask, 6, 1) else '_' end+
       case substring(@DaysBits, 7, 1) when 1 then substring(@DaysMask, 7, 1) else '_' end; 
```

如果这对您来说有点太多代码，您可以使用数字表 1-7 并`for xml path`连接这些值。

```
select
  (
  select case substring(@DaysBits, N, 1) when 1 then substring(@DaysMask, N, 1) else '_' end
  from (values(1),(2),(3),(4),(5),(6),(7)) as T(N)
  order by N
  for xml path('')
  ); 
```

[SQL小提琴](http://sqlfiddle.com/#!3/d41d8/9526)

# python - 如何在不开始流式传输视频的情况下检索 Youtube 页面？

> ID：15012461
> 
> 赞同：0
> 
> 时间：2013-02-21T21:20:42.900
> 
> 标签：python, youtube

我实际上不确定它是否会尝试流式传输视频，解析 YouTube 页面只需要比正常时间多几秒钟。

我正在寻找解析一个随机的 Youtube 视频页面以查看它是否已被删除，并且我正在寻找确保除了视频本身之外的所有内容都已加载。我有以下代码有效，只是它需要一段时间才能完成（我假设视频开始加载会减慢它的速度，但尚未测试确认）

```
import requests, bs4

url = 'https://www.youtube.com/watch?v=XYZ'
parameters = {'magic_var' : 'no_load'}
r = requests.get(url, params=parameters)
soup = bs4.BeautifulSoup(r.content) 
```

我的问题是我是否可以设置某种参数来确保视频不会在页面请求时立即开始加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:27:16.747

在加载页面（以及页面引用的 Flash 播放器）之后，您的*浏览器将在单独的请求中流式传输视频。*视频不是页面数据本身的一部分。样式、脚本和图像也不是。它们都只是编码在 HTML 页面中供浏览器解释的引用。

仅请求页面本身并不会启动正在流式传输的视频，不。

换句话说，所有`requests.get()`将加载的是您的浏览器也加载的基本 HTML 标记。除非您随后解释该 HTML 标记并开始加载页面中引用的资源，否则您不会自动开始加载其他任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:28:14.770

如何使用网络分析仪并查看视频的来源？到目前为止，我了解所有视频都来自一个主机名：例如：

```
s.ytimg.com/yt/swfbin/watch_as3.swf?video_id=YOUR_VIDEO_ID&autoplay=1 
```

并且`autoplay`将是 1 - 开始播放或 0。

如果`video_id`不再存在，您将`Invalid parameters`在屏幕上看到类似的内容。

# html - Kendo UI Mobile - 分组列表视图中固定标题的 data-* 属性？

> ID：15012464
> 
> 赞同：0
> 
> 时间：2013-02-21T21:20:56.703
> 
> 标签：html, listview, kendo-ui

我想在我的组列表视图中有固定的标题...我知道如何使用 javascript 来做到这一点，但想知道是否可以纯粹使用 kendo 的 data-* 属性来实现？

类似于以下内容：

```
<ul data-role="listview" data-type="group" data-headers="fixed">
    <li> ... </li>
</ul> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T00:42:06.773

数据属性是连字符和小写的，它们在 kendo mobile 中的驼峰式对应物的声明性初始化属性。

```
$("ul[data-role=listview]").kendoMobileListView({
        template: $("#listviewTemplate").html(),
        headerTemplate: $("#listviewHeaderTemplate").html(),
        type: "group",
        fixedHeaders: true
    });

<ul data-role="listview" data-template="listviewTemplate" data-header-template="listviewHeaderTemplate" data-type="group" data-fixed-headers="true">
    <li> ... </li>
</ul> 
```

框架版本 2012.3.1315 显然有一个错误，即固定标题无法正确呈现，并且始终显示列表视图中的第一个或最后一个标题。

# bash - 用于 nohup 目录中每个文件的 Shell 脚本

> ID：15012469
> 
> 赞同：0
> 
> 时间：2013-02-21T21:21:17.707
> 
> 标签：bash, shell

这是对此处发布的问题的跟进[Shell script to execute nohup against an input filename](https://stackoverflow.com/q/14202947/1516064)。

我只是想设法修改下面的 no_hup 脚本以针对整个 SQL 脚本目录执行，而不仅仅是单个文件。因此，我试图找到一种修改以下脚本以针对整个文件目录执行的好方法：

> 如何编写一个 shell 脚本，以便可以针对包含文件 foo1.sql、foo2.sql、foo3.sql 的名为 test 的目录运行
> 
> ./nohup_sh 测试
> 
> 这将产生输出
> 
> nohup psql -d db -f test/foo1.sql >& test/foo1.out &
> 
> nohup psql -d db -f test/foo2.sql >& test/foo2.out &
> 
> nohup psql -d db -f test/foo3.sql >& test/foo3.out &

这是我在上一个名为 nohup_sh 的答案中使用的代码

```
#!/bin/bash

outputFile="$(echo $1 | cut -d\. -f 1).out"

nohup psql -d db -f "$1" >& "$outputFile" & 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:26:23.787

```
#!/bin/bash

for file; do
    nohup psql -d db -f "$file" >& "${file%.*}.out" &
done 
```

`${file%.*}`是[bash 参数扩展](http://wiki.bash-hackers.org/syntax/pe)以执行与您的`cut` 命令相同但使用`bash builtin`

`for file`是的简写`for file in "$@"`

用法 ：

```
./script.bash sql_dir/*.sql 
```

或者

```
./script.bash *.sql 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:29:31.723

以下脚本搜索`*.sql`作为参数传递的目录中的任何文件并执行所需的 nohup 命令。找到的文件名由空字节分隔以避免文件名中的空格或通配符问题。

```
#!/bin/bash
if [[ -d "$1" ]]; then
    find "$1/" -type f -name "*.sql" -print0 | while read -rd $'\0' file; do
        nohup psql -d db -f "$file" >& "${file%.*}.out" &
    done
else
    echo "$1 is no directory"
    exit 1
fi
exit 0 
```

称它为`script.sh somedir`.

# c# - 异步 jQuery 数据库循环 - 帮助实现进度条

> ID：15012472
> 
> 赞同：0
> 
> 时间：2013-02-21T21:21:30.030
> 
> 标签：c#, javascript, jquery, asp.net-mvc-3, asynchronous

因此，我试图在一个非常慢且长的查询中添加一个异步进度条，该查询将一堆行插入数据库。我的实现基于这个例子：[http ://blog.janjonas.net/2012-01-02/asp_net-mvc_3-async-jquery-progress-indicator-long-running-tasks](http://blog.janjonas.net/2012-01-02/asp_net-mvc_3-async-jquery-progress-indicator-long-running-tasks)

这是进度条的javascript代码

```
function updateMonitor(taskId, status) {
        $("#monitors").html("Task [" + taskId + "]: " + status);
    }
//other code
if (doSend == true) {
            $.post("/SendBatch/HandleBatchRequest", {
                //other code
            },
            function (taskId) {

                // Init monitors
                //breakpoint here only stops it once the "/SendBatch/HandleBatchRequest" is done. PROBLEM.
                $("#monitors").append($("<p id='" + taskId + "'/>"));
                updateMonitor(taskId, "Started");

                // Periodically update monitors
                var intervalId = setInterval(function () {
                    $.post("SendBatch/Progress", { id: taskId }, function (progress) {
                    if (progress >= 100) {
                        updateMonitor(taskId, "Completed");
                        clearInterval(intervalId);
                    } else {
                        updateMonitor(taskId, progress + "%");
                    }
                });
            }, 100);
        }       
        ,"html"); 
```

然后是网站显示部分的DIV

```
<div id="monitors"></div> 
```

这是控制器的外观

```
public SendBatchController
    //some code
private static IDictionary<Guid, int> tasks = new Dictionary<Guid, int>();

public ActionResult HandleBatchRequest(
        //some code
    )
    {
        var taskId = Guid.NewGuid();
        tasks.Add(taskId, 0);

        var batchId = Guid.NewGuid().ToString("N");
        var costd = cost.ToDecimal();

        IEnumerable<BatchListModel> customers;

        try
        {
            customers = new CustomerService(_customerRepository.Session).GetCustomers(
                //some code
                );
        }
        catch (Exception err)
        {
            return Json(err.Message);
        }
        if (doSend)
        {
            var sent = 0;

            foreach (var c in customers)
            {
                try
                {
                    var usr = _customerRepository.LoadByID(c.ID);

                    var message = new ComLog
                                      {
                                          //insertions to log
                                      };

                    _comLogRepository.Save(message);
                    sent++;

                    //progress bar part inside here that is important comes here:
                    tasks[taskId] = sent;

                }
                catch (Exception e)
                {
                    Log.WriteLine("ERR:" + e);
                }

                tasks.Remove(taskId);

            }
            return Json(taskId);

        }

        return Json(customers.Count() + " customers");
    }

    public ActionResult Progress(Guid id)
    {
        return Json(tasks.Keys.Contains(id) ? tasks[id] : 100);
    } 
```

这不起作用。该过程在后台运行。查询完成后，DIV 会显示“完成”消息。它在查询期间不显示。我不确定异步的东西是如何工作的，所以这里可能存在一些逻辑错误。例如，它甚至知道总共有多少客户吗？代码的另一个关键部分是“tasks[taskId] = sent;” 我不确定是否正确完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:56:11.443

`HandleBatchRequest`在 javascript 方面，开始进度检查的函数在请求成功完成后才会触发。第三个参数`$.post()`是请求成功后触发的内容。

您要么需要让您的 C# 控制器立即返回任务 ID，然后将数据库插入传送到另一个线程/后台工作程序中（更多内容请参见下文）。或者让 Javascript 随机生成 taskId 并传递给 C# 控制器。

从那里开始，正如 Brad 所提到的，您不想在其中使用 ajax 请求执行 setInterval。由于 AJAX 是异步的，因此您可能需要等待一段时间才能让服务器返回响应。为了防止同时发生多个请求并在后端服务器上造成撤消压力，您需要执行以下操作：

```
var taskId = 0;
$.post('/SendBatch/HandleBatchRequest', {}, function(r) {
    taskId = r;  // set task id from 
    $("#monitors").append($("<p id='" + taskId + "'/>"));
    CheckProgress();
}, 'html');

function CheckProgress() {
    $.post("SendBatch/Progress", { id: taskId }, function (progress) {
    if (progress >= 100) {
        updateMonitor(taskId, "Completed");
    } else {
        updateMonitor(taskId, progress + "%");
        setTimeout(function() {
            CheckProgress()
        }, 1000);
    }
} 
```

在 C# 方面，控制器在每个 web 请求上都会被实例化，所以当你去检查进度时，控制器是`tasks`空的。您需要将实际记录卸载到某种后台工作程序/线程中，该工作程序/线程执行从控制器插入记录的实际工作。如果您经常这样做，您可能希望查看安装在服务器本身上的某种后台服务，该服务会持续运行以优化事物并为您提供最佳的灵活性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T19:58:28.743

为什么不向您的网站添加加载 gif（您可以在此处下载它们 - [http://www.ajaxload.info/](http://www.ajaxload.info/)）然后将此加载 gif 放置在页面上的 div 中 - 无论您希望它显示在哪里。

类似下面的东西

```
<div><img class="hidden " id="LoadingGif" src='../Content/Styles/images/loading.gif' height="100" /></div> 
```

然后在您的 js 文件中，simplay 删除 LoadingGif id 上隐藏的类，并可能将隐藏的类添加到您的监视器 div。

隐藏类应如下所示在您的 site.css

```
.hidden  {visibility:hidden; display:none;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:27:16.993

我强烈建议不要在 setInterval 函数中使用 ajax。相反，在 $.post() 的成功/完成回调函数中使用 setTimeout。这将保证请求是按顺序生成的。

如果您每 100 毫秒触发一次 ajax 请求，它们将很快失去同步，无疑会导致问题。

# java - 带有唯一链接的网页的网页

> ID：15012474
> 
> 赞同：0
> 
> 时间：2013-02-21T21:21:34.137
> 
> 标签：java, html, url, iframe, web

我们的一个网页中有一个巨大的 iframe，允许用户在我们的网站上查看其中的另一个网站。当用户点击 iframes 网站并在其中导航，找到他们以后想要参考的地方时，url 保持不变，因为 iframes url 不是托管在我们的网站上。

我想知道的是，是否可以显示 iframe URL 并可能有指向它的链接，它是 java 还是复制到您的剪贴板，是否有另一种方法可以将外部网页“安装”到我们的网页上，如果iframe 标签的局限性不够强大。

我想要什么，我希望每次用户点击外部网页或“iframe”时我们的 url 都会改变，允许用户复制 URL 并链接回我们的网站，显示他们所在的页面，在外部页面。

我的资源快用完了。下一步是去托管外部页面的公司，让我给他们代码，让他们的网页看起来像我们的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:27:35.043

要获取`iframe`网址，请执行以下操作：

```
$('#myiframe').bind('click', function(e) {
    var url = $("#myiframe").get(0).contentWindow.location;
}); 
```

如需更多信息，请在您的问题中添加一些代码。

# c++ - 国外操作系统上的英文C++程序

> ID：15012477
> 
> 赞同：0
> 
> 时间：2013-02-21T21:21:41.790
> 
> 标签：c++, sockets, chat, translation

我有一个非常适合英语操作系统的聊天系统。它使用多字节字符集，驱动它的服务器也是如此。

我有使用该程序的中国客户。收到消息时，会发生以下两种情况之一：如果消息是用中文输入的，则不会显示空格。如果它是用英语写的，那么零碎的东西就会显示为外来字符。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:27:14.487

由于您将 Windows 7 用于客户端，将 Windows Server 2008 R2 用于服务器，我不认为您的问题是由于“字节顺序”的变化造成的。您提到您使用“多字节”字符集。因此，我假设您的数据不使用标准 Unicode 编码之一，例如 UTF-8/UTF-16/UTF-32，而是使用预 Unicode 样式代码页对数据进行编码。如果在客户将文本输入聊天时使用了一个代码页，并且在接收者的 PC 上显示为不同的代码页，则文本可能无法正确显示。

# javascript - 为什么我在尝试使用从我的 ajax 调用返回的承诺时没有得到任何数据

> ID：15012478
> 
> 赞同：1
> 
> 时间：2013-02-21T21:21:53.680
> 
> 标签：javascript, jquery

我已经尝试了这个论坛和其他人的几种解决方案，但似乎没有任何效果。我不确定这是否是一个逻辑问题，根本无法按照我想要的方式完成，或者我只是没有以正确的方式访问返回。

我想要做的是列出一组链接（代码在外部文件 Main.js 中），当点击链接时获取 id 并使用它进行第二次 ajax 调用并打开也会打开第二个窗口（代码在外部文件 Cites.js 中）包含有关单击的链接的更多信息。

问题是我无法从 Main.js 中的第二个 ajax 调用中获取要在我的 Cites.js 文件中使用的 id。我正在尝试返回第二个 ajax 调用，然后使用 .done() 来获取返回的数据或尝试获取全局变量 projectId。

这是我的 Main.js 中的代码

```
var projectId = '';
var promise = $.ajax({
    type: 'GET',
    url: 'https://www.sciencebase.gov/catalog/items?parentId=504108e5e4b07a90c5ec62d4&max=60&offset=0&format=jsonp',
    jsonpCallback: 'getSBJSON',
    contentType: "application/json",
    dataType: 'jsonp'
    }).then(function(json) {
                 var linkBase = "http://www.sciencebase.gov/catalog/item/";
                 var link = "";                     
                 var itemId = "";                    
                 var urlId = "";
                 var itemLinkLength = "";

                 $.each(json.items, function(i,item) {
                     link = linkBase + this.id;

                     $('#sbItems').append('<li><b><a href="' + link + '" id="idNum' + i + ' ">' + this.title + '</a> - </b>' + this.summary + '</li>');                     
                 });                     

                 $('#sbItems a').on('click', function (e) {
                     e.preventDefault();                         

                     var str = $(this).attr('id');                         

                     if (str.length == 7) {                      
                          itemId = str.slice(5,6);
                     } else if (str.length == 8) {
                          itemId = str.slice(5,7);
                     }

                     urlId = json.items[itemId].id;
                     //alert(urlId);

                     return $.ajax({
                                    type: 'GET',
                                    url: 'https://www.sciencebase.gov/catalog/itemLink/' + urlId + '?format=jsonp',
                                    jsonpCallback: 'getSBJSON',
                                    contentType: "application/json",
                                   dataType: 'jsonp',
                                   success: function(json) {
                                            if (json.length > 0) {
                                                projectId = json.id;
                                                window.open('Citations.html', '_self');
                                            } else {
                                                var page = linkBase + urlId;
                                                window.open(page);
                                            }

                                   },
                                   error: function(e) {
                                       console.log(e.message);
                                   }                     
                     }); // END 2nd ajax
                }); // END Click event
}); // END promise 
```

这就是我在 Cites.js 中的称呼方式

```
promise.done(function () {
    alert(projectId);
}); 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:31:42.850

你这样做`promise = $.ajax(…).then(function(){…})`了——但该`then`方法确实为匿名函数的结果创建了一个新的承诺（在旧版本的 jQuery 中，这是`pipe`）——另请参阅[pipe() 和 then() 文档与 jQuery 1.8 中的现实](https://stackoverflow.com/q/12011925/1048572)。

但是，由于您没有从 anon 函数返回任何内容，因此您不会在`promise.done()`.

如果你想做一个链 ajax->click->ajax->done，你需要手动为 click 处理程序构建一个 Promise。

# sql - 如何在显示 XML 节点的所有项目的情况下运行查询？

> ID：15012482
> 
> 赞同：0
> 
> 时间：2013-02-21T21:22:11.807
> 
> 标签：sql, xml, tsql, xpath, xquery

```
<DataItem name="xxxxx" value="2" />
<Roles>
  <Role id="Role1" />
  <Role id="Role2" />
  <Role id="Role3" />
  <Role id="Role4" />
</Roles> 
```

此 XML 位于表 A 的 Z 列中。

我将如何编写查询以查看此 XML 中的所有角色？

例子：

```
SELECT Z FROM A 
```

结果：

```
Role1
Role2
Role3   
Role4 
```

我还需要考虑到角色是动态的……我永远不知道那里会有多少人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:41:10.887

```
select T.N.value('@id', 'varchar(10)')
from A
  cross apply Z.nodes('/Roles/Role') as T(N) 
```

[xml 数据类型方法](http://msdn.microsoft.com/en-us/library/ms190798.aspx)

# php - 如何在我的应用程序中保存第三方应用程序的密码以与 api 一起使用？

> ID：15012485
> 
> 赞同：1
> 
> 时间：2013-02-21T21:22:22.163
> 
> 标签：php, codeigniter

我需要在我的 PHP 应用程序中保存第三方应用程序密码，以便在后台进程中连接到 API。我需要将密码存储在数据库中，密码适用于应用程序的每个用户。但我不知道保存它以供以后检索的正确方法是什么。

我不想在没有加密的情况下保存密码，但我不知道哪种方法是最好的方法（也很容易）

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:30:00.977

除非有某种可用于 API 的 OAuth 机制，否则您最好将其存储为纯文本。一旦攻击者可以访问加密形式的密码，那么他们很可能可以访问解密它的代码。

我的首选方法是：

inc.credentials.php

```
<?php
$app_creds = array(
  'username' => 'sammitch',
  'password' => 'isgreat'
); 
```

实际代码.php

```
<?php
require('inc.credentials.php');
app_login($app_creds['username'], $app_creds['password']);
unset($app_creds); 
```

1.  始终使用通过 PHP 解释器运行的文件扩展名，以便文件不会以纯文本形式提供。
2.  始终不要关闭关闭，`?>`以免意外输出任何内容。[最有可能的空白]
3.  `unset()`主要是偏执狂，但只是在代码注入的情况下。

# php - 在 Winkel Triplel 投影上将纬度/经度转换为笛卡尔坐标

> ID：15012486
> 
> 赞同：1
> 
> 时间：2013-02-21T21:22:24.283
> 
> 标签：php, graph, maps, cartesian, map-projections

我有一张 Winkel Tripel 地图，需要在上面放置标记。我给出了纬度/经度中标记的位置。所以我需要一种方法将其转换为 X,Y。

我找到了一些代码（如下），但是当我尝试它时，45º 对角线的图有一个适中的 s 曲线。所以这显然是不正确的。

任何帮助都会很棒。我在 PHP 中这样做，但我应该能够转换任何语言。

```
private function sinc($x){
    if($x == 0) return 1;
    return sin($x) / $x;
}

private function winkelTripelToCartesian($lat, $lng){
    $lat = deg2rad($lat);
    $lng = deg2rad($lng);

    $alpha = acos(cos($lat) * cos($lng / 2));

    $x = ($lng * M_2_PI + (2 * cos($lat) * sin($lng / 2)) / $this->sinc($alpha)) / 2;
    $y = ($lat + (sin($lat) / $this->sinc($alpha))) / 2;

    return array('x'=> strval($x), 'y' => strval($y));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-11T13:47:45.413

该地图投影试图将球体显示为 2D 对象，这会导致它改变形状的外观。这可能导致您的线路弯曲。

如果您仍然不满意，这是我使用 Javascript 在带有 winkel III 投影的地图上绘制标记的脚本：

```
 // latitudes/longitudes to radians
  var latRadian = (latitudes[i] * Math.PI) / 180;
  var lngRadian = (longitudes[e] * Math.PI) / 180;
  console.log("Radian Coordinates = " + latRadian + ", " + lngRadian);

  //Radians to xy cartesian coordinates
  var alpha = Math.acos( Math.cos(latRadian) * Math.cos( lngRadian / 2 ) );
  var phi_1 = Math.acos( 2 / Math.PI );
  function sinc(x) {
      if (x == 0) {
          return 1;
      } else {
          return (Math.sin(x)/x);
      }
  }
  var x = (svgHeight/Math.PI) * ( lngRadian * Math.cos(phi_1) + 2 * ( Math.cos(latRadian) * Math.sin(lngRadian/2) / sinc(alpha) ) ) / 2;
  var y = (svgHeight/Math.PI) * ( latRadian + ( Math.sin(latRadian) / sinc(alpha) )) / 2; 
```

你可以在这里找到完整的例子：[http ://codepen.io/StinoM/pen/PZjYqw?editors=001](http://codepen.io/StinoM/pen/PZjYqw?editors=001)

这是我发现的一些使用 Ruby 的代码：[https ://gist.github.com/duncanbeevers/195554](https://gist.github.com/duncanbeevers/195554)

# jquery - jQuery - 在模态窗口中加载远程 html 表单并在同一个模态窗口中提交

> ID：15012487
> 
> 赞同：0
> 
> 时间：2013-02-21T21:22:27.690
> 
> 标签：jquery, window, modal-dialog

我需要在模态窗口中加载包含表单的 html 页面。当模式窗口打开并按下提交按钮时，我需要在同一个远程 html 页面中提交数据，然后关闭模式窗口。这是我的代码： **我正在使用此代码（page.html）打开模式窗口：**

```
 $(".genbutton-options, .ajax-edit").click(function(){                                                                                                                                                                
    var id = $(this).attr("id").replace('edit-', '');                                                                                                                                                                
    var xtraParam = "";                                                                                                                                                                                              
    if( $(this).attr("rel") == "profile" ){                                                                                                                                                                          
        var xtraParam = "&r=sm";                                                                                                                                                                                     
    }                                                                                                                                                                                                                
    if( $(this).attr("rel") == "set" ){                                                                                                                                                                              
        var xtraParam = "&r=s";                                                                                                                                                                                      
    }                                                                                                                                                                                                                
    if( $(this).attr("rel") == "stream" ){                                                                                                                                                                           
        var xtraParam = "&r=stream";                                                                                                                                                                                 
    }                                                                                                                                                                                                                
    var dialogOpts = {                                                                                                                                                                                               
        modal: true,                                                                                                                                                                                                 
        bgiframe: true,                                                                                                                                                                                              
        autoOpen: false,                                                                                                                                                                                             
        width: 716,                                                                                                                                                                                                  
        buttons: {                                                                                                                                                                                                   
            "Save": function() {                                                                                                                                                                                     
                $("#content-dialog").hide();                                                                                                                                                                         
                $(this).append("<div class=\"preloader-ajax\">Hold on...</div>");                                                                                                                                    
                $(".ui-button").addClass("ui-state-disabled");                                                                                                                                                       
                $("form[name='edit-ajax-form']").submit();                                                                                                                                                           
            },                                                                                                                                                                                                       
            "Cancel": function() {$(this).dialog("close");}                                                                                                                                                          
        },                                                                                                                                                                                                           
        open: function() {                                                                                                                                                                                           
            $("#ed-"+id+"").load("edit.php?media="+id+""+xtraParam+"");                                                                                                                                    
            $("#edit-loader-"+id+"").show();                                                                                                                                                                         
        }                                                                                                                                                                                                            
    };                                                                                                                                                                                                               
    $("#ed-"+id+"").dialog(dialogOpts);                                                                                                                                                                              
    $("#ed-"+id+"").dialog("open");                                                                                                                                                                                  
    return false;                                                                                                                                                                                                    
}); 
```

**这是在模式窗口 (edit.php) 中打开的页面：**

```
 <div id="content-dialog">
    <form action="<?php echo $PHP_SELF;?>" enctype="multipart/form-data" method="post">
    <div class="dialog-td1">Title</div>
    <div class="dialog-td2">
        <input type="text" name="title" value="Suitcase Chair?" class="dialog-inputtext" id="inputPicTitle" />
        <p class="dialog-help" style="visibility:hidden">Some cool, sexy or funny title is required. Min 3 chars.</p>
    </div>
    <input type="submit" name="save" id="buttonSignup" class="dialog-button right" value="Save" />
    <div class="preloader-signup right">Hold On</div>
    <a href="javascript:history.back(1)" class="dialog-button-grey right" id="buttonCancel">Cancel</a>
    </form>
</div>
<?php
if(isset($_POST)){
   //do something
   echo "data submitted";
} 
```

?>

问题是当我点击提交按钮时，数据被保存但浏览器被重定向到edit.php（在模式窗口中打开的同一页面）。我想做的是，当我点击提交按钮时，要保存数据，然后关闭模式窗口，而不需要任何浏览器重定向或刷新。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:32:17.420

您必须稍微更改一下代码：

```
 $("form[name='edit-ajax-form']").submit(); 
```

至：

```
 $.ajax(
        {type:'POST', 
         url: $("form[name='edit-ajax-form']").attr('action'),
         data:$("form[name='edit-ajax-form']").serialize(),
         success: function(response) {
               alert(response);
         })
      }); 
```

这确实将您的请求作为 ajax 发送并获得响应。你可以多处理一点。如果响应成功，则仅关闭模式窗口。

编辑：

类似的东西：

```
"Save": function() {

            $("#content-dialog").hide();                                                                                                                                                                         
            var preloader = $(this).append("<div class=\"preloader-ajax\">Hold on...</div>");  
            $(".ui-button").addClass("ui-state-disabled");  
            var dialog = $(this);
            $.ajax(
                    {type:'POST', 
                     url: $("form[name='edit-ajax-form']").attr('action'),
                     data:$("form[name='edit-ajax-form']").serialize(),
                     success: function(response) {
                           $(preloader).remove();
                            dialog.close();
                     },
                    error: function() {
                        $(preloader).remove();
                        alert('something bad happend pls fill out again');
                        $(".ui-button").addClass("ui-state-enabled");  
                    }
                  });                                                                                                                                  

        }, 
```

# vb.net - 找不到对 Microsoft.VisualStudio.TestTools.UnitTesting 的引用

> ID：15012488
> 
> 赞同：0
> 
> 时间：2013-02-21T21:22:29.057
> 
> 标签：vb.net, visual-studio-2010, testing

这个问题几乎在标题中。我找不到对 Microsoft.VisualStudio.TestTools.UnitTesting 库的任何引用。

我正在使用 Visual Studio 2010 Ultimate

这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:37:01.010

抱歉知道了...我搜索的时间不够长。成名工程更名为 Microsoft.VisualStudio.TestTools.UnitTestFramework

*我认为从 Visual Studio 2010 开始。

# windows-phone-8 - WinPhone8 网络浏览器

> ID：15012489
> 
> 赞同：0
> 
> 时间：2013-02-21T21:22:28.983
> 
> 标签：windows-phone-8

我在应用程序中使用 WebBrowser 组件在应用程序的页面上显示一些生成的 HTML。当我从页面导航回来时，当浏览器控件从页面上消失，然后大约 1/2 秒后页面的其余部分消失时，会出现明显的延迟。

在其上运行应用程序分析后，每次发生这种情况时，应用程序的响应能力都会下降到零，并且似乎正在执行 GC 收集。

关闭页面时有没有办法避免这种滞后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T12:15:40.177

看看`Latency Modes`： http `Garbage Collector`: [//msdn.microsoft.com/en-us/library/bb384202.aspx](http://msdn.microsoft.com/en-us/library/bb384202.aspx)

希望能帮助到你 ：）

# wolfram-mathematica - 如何在“案例”Mathematica 函数中使用“>”和“<”？

> ID：15012494
> 
> 赞同：3
> 
> 时间：2013-02-21T21:22:50.510
> 
> 标签：wolfram-mathematica, pattern-matching

如何在“案例”Mathematica 函数中使用“>”和“<”？

例如，对于以下嵌套列表，我想要以大于 2 结尾的情况：

```
 lst = { {1, 0, 0}, {1, 1, 1}, {1,1,4} } 
```

我想做类似的事情

```
 Cases[lst, {_, _,>2} ] 
```

上面的“>2”的正确表达方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T22:20:12.513

对您的方法最直接的解决方法可能是

```
Cases[lst, {_, _, x_ /; x > 2}] 
```

请参阅`/;`或的文档`Condition`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T09:25:00.663

或者，

```
Cases[lst, {_, _, _?(# > 2 &)}] 
```

# c# - LINQ to entity 无法识别该方法

> ID：15012495
> 
> 赞同：1
> 
> 时间：2013-02-21T21:22:52.977
> 
> 标签：c#, entity-framework, iqueryable

我理解为什么会出现以下错误，但是我不确定如何才能提供可以绕过它的解决方案。

```
{System.NotSupportedException: LINQ to Entities does not recognize the method 'Boolean IsStatus(CDAX.DataModel.ProcessStatusEnum)' method, and this method cannot be translated into a store expression. 
```

我不想只返回 IEnumerable，因为我想将过滤器转换为底层 SQL 语句，这样我就不会查询这么多行等

```
 public override IQueryable<Session> GetQuery()
    {
        Func<Session, bool> activeSessions = (session) => !session.IsStatus(ProcessStatusEnum.Deleted);

        // these functions are causing issues.  I'm not sure how to change them to
        // work with IQueryable??   
        return base.GetQuery().Where(p => activeSessions(p) && _queryFilter.FilterOn(p.Customer));
    } 
```

_queryFilter 类是一个接口，例如：

```
public interface IDataQueryFilter
{
    bool FilterOn(Customer obj);
} 
```

客户只是我数据库中的一个实体对象，具有 Id、CustomerNumber 等属性

Session 是我数据库中的另一个 Entity 对象，IsStatus 方法是这样的：

```
 public bool IsStatus(ProcessStatusEnum status)
    {
        return SessionStatus == (byte)status;
    } 
```

我使用的条件通常非常简单，因此我相信它们应该能够转换为 SQL。我想这只是因为它们在他们不能的函数内。我可以使用其他东西作为返回类型来让这些工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:28:23.820

您的`IsStatus`方法调用无法转换为 SQL。我建议您在不调用方法的情况下手动进行状态验证。

```
(session) => session.Status != ProcessStatusEnum.Deleted 
```

另一种选择是将所有实体带入内存（通过执行`ToList()`），但这会很慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:28:52.967

LINQ to Entities 正在尝试将您的 LINQ 查询转换为 SQL 语句。它现在无法直接在数据库上执行您的自定义 Func，因此它会引发此错误。

您可以简单地将您的`IsStatus`方法更改为`session.Status == ProcessStatusEnum.Deleted`，但您可能会收到有关第二个功能的错误。

“解决”这个问题的最简单方法是`.ToList()`在要在数据库上执行的部分和要在内存中执行的部分之间放置一个。显然，数据库上的内容越多越好。

对于您的过滤器，您可能会考虑将 FilterOn 更改为返回表达式树的方法：

```
public interface IDataQueryFilter
{
    Expression<Func<Customer, bool>> FilterOn();
} 
```

然后例如，如果您希望伦敦的所有客户都通过 LondonCustomFilter 的实例：

```
public class LondonCustomFilter : IDataQueryFilter {
    Expression<Func<Customer, Bool>> FilterOn() {
        return (customer) => customer.City == "London";
    }
} 
```

# ruby - Ruby / Resque / Redis：如何在不同的机器上设置工人？

> ID：15012496
> 
> 赞同：4
> 
> 时间：2013-02-21T21:22:55.720
> 
> 标签：ruby, redis, sinatra, resque

我一直在研究分布式后台作业的 resque。我设法通过演示应用程序让一切都在一台机器上运行。但我不知道如何设置所有东西，以便工人在不同的机器上运行。我读到工作人员只需要与redis服务器建立连接。但我仍然不知道从哪里开始。某处有分步说明吗？我没有找到任何关于此的文档。

或者有人可以向我解释一下吗？

顺便说一句，我不使用rails，我使用的是Sinatra。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T04:38:16.947

是的，你是对的

为此，您需要将工作人员连接到redis（我假设所有工作人员都可以使用）

现在在 Resque 中连接到远程 redis，它所要做的就是这样

`Resque.redis = "redis://[your host]:[your port]"`

您也可以在[这里看到它提到的相同内容](https://github.com/defunkt/resque/blob/master/lib/resque.rb#L37-L39)

也许在你的定义它`config/application.rb`

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T23:48:04.997

Redis 安全指南建议将您的 Redis 服务器暴露在公共互联网上是不安全的。因此，您最安全的选择可能是创建从每台工作机器到 Redis 服务器的 SSH 隧道。您可以在此处找到说明：

[https://briandamaged.org/blog/?p=1675](https://briandamaged.org/blog/?p=1675)

保护 Redis 服务器并建立 SSH 隧道后，您的工作人员可以通过访问 localhost 上的端口连接到服务器。例如：

```
# Port 2000 is a tunnel to the Redis server
Resque.redis = "redis://localhost:2000" 
```

# excel - 在 Excel 中生成随机 -1 和 +1 值

> ID：15012497
> 
> 赞同：7
> 
> 时间：2013-02-21T21:22:55.963
> 
> 标签：excel, random

该`Rand()`函数将生成一个介于 0 和 1 之间的实数。它`Randbetween(-1,1)`会生成 -1、0 或 1。我想要的只是 -1 或 1。那么 -1 和 1 之间的实数呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T21:24:54.597

简单的：

```
=IF(兰德()<0.5,-1,1)

```

要获得实数，请使用

```
=兰德()*2-1

```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T21:26:53.537

这是一个解决方案：

```
=Randbetween(0,1)*2-1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T21:27:14.473

您可以使用`RANDBETWEEN`0 或 1 生成两个值，并将 -1 替换为 0。

```
=IF(RANDBETWEEN(0,1) = 0, -1, 1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T21:25:24.970

做rand，如果大于0.5，返回1，如果小于，返回-1

```
=IF(RAND()>0.5,1,-1) 
```

# facebook-c#-sdk - 为什么我下次使用我的应用程序时不需要登录？

> ID：15012499
> 
> 赞同：0
> 
> 时间：2013-02-21T21:23:16.967
> 
> 标签：facebook-c#-sdk

我正在为用户需要登录的 windows phone 8 开发一个应用程序，然后该应用程序将发布到用户的墙上。

我基本上已经弄清楚了，但是在第一次登录后，我不必再次登录。我尝试删除手机上的浏览器数据，检查我的运行时目录，并尝试使用 FacebookClient.GetLogoutUrl 注销并导航到它，但它仍然认为我已登录。

我的登录信息是如何存储的？

一旦我弄清楚了，有没有一种在运行时确定这一点的好方法，以便我的应用程序可以相应地进行自我配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T07:03:16.700

这是因为一旦生成，访问令牌的有效期为 2 个月。即使用户注销，您仍然可以向 API 发出请求，直到访问令牌有效。

`And once I figure that out, is there a good way to determine this at runtime so that my app can configure itself accordingly?`

是的，您可以（在运行时）通过查找访问令牌来检查访问令牌是否有效或过期`FacebookOAuthException`

这是一个很好的教程：[http ://www.thepcwizard.in/2013/02/working-with-facebook-c--sharp-sdk.html](http://www.thepcwizard.in/2013/02/working-with-facebook-c--sharp-sdk.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:02:12.377

您必须向`GetLogoutURL`用户提供该功能`access_token`。

试试这个方法来获取**LogoutURL**并导航到它：

```
public static string GetLogoutURL(string AccessToken)
{
    var fb = new FacebookClient();
    var logoutUrl = fb.GetLogoutUrl(new { access_token = AccessToken, next = "https://www.facebook.com/connect/login_success.html" });
    return logoutUrl.ToString();
} 
```

使用任何隐藏的 WebBrowser 进行此导航：

```
AnyWebBrowserControl.Navigate(GetLogoutURL(AccessToken)); 
```

# javascript - 传递 createObjectURL

> ID：15012500
> 
> 赞同：1
> 
> 时间：2013-02-21T21:23:36.563
> 
> 标签：javascript, url, audio, fileapi

我想将创建的地址传递`window.URL.createObjectURL(file)`给 dancer.js 但我得到了`GET blob:http%3A//localhost/b847c5cd-aaa7-4ce0-8ff8-c13c6fc3505a.mp3 404 (Not Found)`.

我设法使用通过文件输入选择的文件创建音频元素，但 dancer.js 根本找不到文件......有什么想法吗？（下面我如何传递 ObjectURL）

```
 $(document).ready(function(){
    $("#submit").click(function(){
        var file = document.getElementById("file").files[0];
        $('body').append('<audio id="audio" controls="controls"></audio>');
        $('#audio').append('<source src='+window.URL.createObjectURL(file)+' type=audio/mpeg />')
        $('body').append('<a href='+window.URL.createObjectURL(file)+'>link</a>')
        dancer(window.URL.createObjectURL(file));
    })
}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T22:13:40.377

查看[dancer.js 自述文件](https://github.com/jsantell/dancer.js/blob/master/README.md)，看起来该`load`方法将采用对`<audio>`元素的引用或指定源的配置对象：`{scr: varHoldingFileURL}`. 由于您已经`<audio>`为您的文件创建了一个元素，我只需将其传递给舞者：

```
$(document).ready(function() {
    var dancer = new Dancer(),
        fileURL;

    $("#submit").click(function(){
            var audioElement,
                file = document.getElementById("file").files[0];

            fileURL = window.URL.createObjectURL(file);

            // remove any preexisting instances of the audio tag
            $('#audio').remove();

            // Revoke any previously used file URL so it doesn't
            // take up memory anymore.
            window.URL.revokeObjectURL(fileURL);

            $('body').append('<audio id="audio" controls="controls"></audio>');
            $('#audio').append('<source src='+ fileURL +' type=audio/mpeg />')
            $('body').append('<a href=' + fileURL +'>link</a>')

            // get a reference to the audio element we created
            audioElement = $('#audio')[0];

            dancer.load(audioElement);
    })
}); 
```

# geocoding - 必应地图地理编码器的结果不一致

> ID：15012502
> 
> 赞同：2
> 
> 时间：2013-02-21T21:23:39.543
> 
> 标签：geocoding, geospatial, bing-maps

我编写了一个应用程序，它解析 CSV 文件、提取地址并使用 Bing Maps REST API 对其进行地理编码。我遇到的问题是，如果我多次运行同一个文件，我会得到不同的结果。在第一次试验中，第 2 行和第 6 行可能不会返回任何匹配项。在接下来的试验中，第 2 行和第 6 行将返回匹配项，而第 4 行可能不会。我使用 Fiddler 检查了 HTTP 流量。我的请求格式正确，每个响应都返回 HTTP 状态代码 200 和有效的 JSON，只有一些地址产生结果，而另一些则没有，并且特定地址的成功或失败因试验而异。任何人都可以提供任何见解吗？

**更新**

* * *

样品要求：

```
GET http://dev.virtualearth.net/REST/v1/Locations?o=json&adminDistrict=MI&locality=Shelby&postalCode=49455-1299&addressLine=72+South+State+Street&key={MyApiKey} HTTP/1.1
Host: dev.virtualearth.net 
```

示例响应：

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Transfer-Encoding: chunked
Content-Type: application/json
Server: Microsoft-IIS/8.0
X-BM-TraceID: 9b6cfaa0abdb47b7b7e2790900bcddce
X-BM-Srv: BL2M001304, BL2MSNVM001275, BL2MSNVM001299
X-MS-BM-WS-INFO: 0
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Fri, 22 Feb 2013 15:14:30 GMT

247
{
    "authenticationResultCode":"ValidCredentials",
    "brandLogoUri":"http:\/\/dev.virtualearth.net\/Branding\/logo_powered_by.png",
    "copyright":"Copyright © 2013 Microsoft and its suppliers. All rights reserved. This API cannot be accessed and the content and any results may not be used, reproduced or transmitted in any manner without express written permission from Microsoft Corporation.",
    "resourceSets":
    [
        {
            "estimatedTotal":0,
            "resources":[]
        }
    ],
    "statusCode":200,
    "statusDescription":"OK",
    "traceId":"9b6cfaa0abdb47b7b7e2790900bcddce|BL2M001304|02.00.83.1900|BL2MSNVM001275, BL2MSNVM001299"
}
0 
```

我在 MSDN 论坛上的帖子：http: [//social.msdn.microsoft.com/Forums/en-US/bingmapsservices/thread/c7fea1b2-f87e-40c2-a3a6-496989a338b2#b885ca9a-018a-491f-9caa-a00a515cf9a8](http://social.msdn.microsoft.com/Forums/en-US/bingmapsservices/thread/c7fea1b2-f87e-40c2-a3a6-496989a338b2#b885ca9a-018a-491f-9caa-a00a515cf9a8)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:57:28.340

**必应地图密钥和速率限制信息**

我确定您使用的是 Bing Maps 密钥，该密钥将是试用版或基本密钥。由于明显的原因（在 24 小时内和请求之间的时间间隔），这种类型的密钥受到速率限制，这就是为什么您得到一个空白响应而没有任何关于它未能进行地理编码的事实的信息的原因。

请参阅有关限制和其他限制的使用条款（压力测试和锤击是其中的一部分）： http: [//www.microsoft.com/maps/product/terms.html](http://www.microsoft.com/maps/product/terms.html)

因此，为了解决您的问题，您应该：

*   检查您正在使用的密钥类型以及您在特定时间段内拨打的电话次数
*   检查响应的标头，它应该包含一个特定的标头值：`X-MS-BM-WS-INFO`设置为 1

有关错误处理，请参阅 MSDN：http: [//msdn.microsoft.com/en-us/library/ff701703.aspx](http://msdn.microsoft.com/en-us/library/ff701703.aspx)

如果您不是这种情况（如果您有企业帐户），请联系技术支持，以便他们可以正式回复您并检查密钥。

**附加信息：**

由于您使用的是使用 CSV 的地理编码器，我强烈建议使用 Bing 地图空间数据服务来执行批量地理编码，请参阅 MSDN 上的完整信息：http: [//msdn.microsoft.com/en-us/图书馆/ff701733.aspx](http://msdn.microsoft.com/en-us/library/ff701733.aspx)

它将减少您将进行的事务数量（每个地理编码数据流作业计为 1 个事务，并且每个文件可以包含超过 200 000 个实体）。

# php - Eregi 到 preg_match 的转换

> ID：15012503
> 
> 赞同：0
> 
> 时间：2013-02-21T21:23:44.100
> 
> 标签：php, preg-match, eregi

所以，我有一个网站，我直接从另一个相关网站收集数据，以显示信息。为此，我正在获取网站（使用 file_get_contents）并使用 eregi 删除任何不相关的内容。我的问题是，即使我已经对如何将此eregi 转换为未弃用的preg_match 进行了深入研究，但我似乎找不到解决方案。

有足够聪明的人理解 preg_match 的复杂性吗？

这是我当前的代码：

```
$content = file_get_contents("http://www.vattenfall.se/sv/teckna-   elavtal.htm/papp/mac:24432/ma-vf_se-orderflow/ProductSelection.action?orderMode=true&submitPostalCode=&orderFlow.personal.postalCode=87140&submitPostalCode=Visa+priser");

eregi('<td style="width: 120px;" class="valuePresentation">(.*)</td>', $content, $data);

foreach($data as $split)
{
    $split = explode("</td>", $split);
} 
```

这很好用 - 但正如我所说，该功能已被弃用，我很想替换它，只要我知道怎么做！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:35:07.447

```
eregi('some expression', $input, $matches); 
```

黑暗魔法，吟唱，诡异的东西……

```
preg_match('/some expression/i', $input, $matches); 
```

不过，您可能想要`preg_match_all()`。

# javascript - jsfiddle 无法显示 EXTJS 4 的正确 GUI

> ID：15012507
> 
> 赞同：2
> 
> 时间：2013-02-21T21:23:58.027
> 
> 标签：javascript, ajax, extjs, extjs4, jsfiddle

```
var loginForm = new Ext.form.FormPanel({
           frame: true,
           border: false,
           labelWidth: 75,
           items: [{
             xtype: 'textfield',
             width: 190,
             id: 'username',
             fieldLabel: 'User name'
           },{
             xtype: 'textfield',
             width: 190,
             id: 'password',
             fieldLabel: 'Password',
             inputType: 'password',
             submitValue: false
           },{
             xtype: 'hidden',
             id: 'challenge',
             value: "<?php echo $challenge; ?>",
             submitValue: false
           }]
         });

         var loginWindow = new Ext.Window({
           title: 'Login',
           layout: 'fit',
           closable: false,
           resizable: false,
           draggable: false,
           border: false,
           height: 125,
           width: 300,
           items: [loginForm]
         });
         loginWindow.show(); 
```

为什么我的登录表单无法在[http://jsfiddle.net/WM9DD/83/](http://jsfiddle.net/WM9DD/83/)上显示正确的 GUI ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:41:30.250

您忘记将`CSS`文件包含在托管资源或 html 部分中：我为您更新了小提琴：http: [//jsfiddle.net/dbrin/WM9DD/84/](http://jsfiddle.net/dbrin/WM9DD/84/)

# ruby-on-rails - 为什么 ActiveRecord 的自动保存对我的关联不起作用？

> ID：15012508
> 
> 赞同：11
> 
> 时间：2013-02-21T21:24:02.337
> 
> 标签：ruby-on-rails, ruby, callback, rails-activerecord

我有一个看起来像这样的 ActiveRecord 类。

```
class Foo
  belongs_to :bar, autosave: true
  before_save :modify_bar
  ...
end 
```

如果我做一些记录，我会看到`bar`正在修改，但它的更改没有保存。怎么了？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-21T21:24:02.337

这里的问题是`autosave: true`简单地设置一个正常的`before_save`回调，并且`before_save`回调按照它们被创建的顺序运行。**

因此，它尝试保存`bar`没有更改的 ，**然后**调用`modify_bar`。

解决方案是确保`modify_bar`回调在自动保存之前运行。

一种方法是使用`prepend`选项。

```
class Foo
  belongs_to :bar, autosave: true
  before_save :modify_bar, prepend: true
  ...
end 
```

另一种方法是将`before_save`声明放在`belongs_to`.

另一种方法是`bar`在方法结束时显式保存`modify_bar`并且根本不使用该`autosave`选项。

感谢 Danny Burkes 的[有用博客文章](http://pivotallabs.com/activerecord-callbacks-autosave-before-this-and-that-etc)。

** 此外，它们在所有`after_validation`回调之后和任何`before_create`回调之前运行 -[请参阅文档](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)。

* * *

## 更新

这是检查此类回调顺序的一种方法。

```
 describe "sequence of callbacks" do

    let(:sequence_checker) { SequenceChecker.new }

    before :each do
      foo.stub(:bar).and_return(sequence_checker)
    end

    it "modifies bar before saving it" do
      # Run the before_save callbacks and halt before actually saving
      foo.run_callbacks(:save) { false }
      # Test one of the following
      #
      # If only these methods should have been called
      expect(sequence_checker.called_methods).to eq(%w[modify save])
      # If there may be other methods called in between
      expect(sequence_checker.received_in_order?('modify', 'save')).to be_true
    end

  end 
```

使用这个支持类：

```
class SequenceChecker
  attr_accessor :called_methods

  def initialize
    self.called_methods = []
  end

  def method_missing(method_name, *args)
    called_methods << method_name.to_s
  end

  def received_in_order?(*expected_methods)
    expected_methods.map!(&:to_s)
    called_methods & expected_methods == expected_methods
  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-02T12:44:51.267

上述答案（显然）是您的解决方案。然而：

我很好用`:autosave`，但我不认为改变外部关联是回调的工作。我说的是你的`:modify_bar`。正如[这篇文章中精彩解释的那样，](http://samuelmullen.com/2013/05/the-problem-with-rails-callbacks) *我更喜欢使用另一个对象*一次保存多个模型。当事情变得更复杂时，它确实简化了您的生活，并使测试变得更加容易。

在这种情况下，这可以在控制器中或从服务对象中完成。

# sql - 在 where 语句中使用子查询

> ID：15012510
> 
> 赞同：0
> 
> 时间：2013-02-21T21:24:10.870
> 
> 标签：sql, sql-server

我的存储过程有问题。

总体思路是能够选择一个4个参数（可以选择也可以不选择）并返回正确的结果。因为我真的不能让它与 2 个参数一起工作（校园 ID 是强制性的），所以我没有费心去做其他的。

问题在于我的 where 子句

```
 WHERE ac.AC_Campus_ID = @CampusID AND
          (

                ac.AC_College_ID IN (CASE @CollegeID
                WHEN 0 THEN (select distinct AC_College_ID from AC_Academic_Choice)
                ELSE @CollegeID
                END)) 
```

这是一个例子。我选择了 1 的校园 id 并选择了 1 的大学 id。查询将返回这 2 个参数的结果。

当我选择 1 的校园 id 和 0 的大学 id 时，我得到“子查询返回超过 1 个值。当子查询遵循 =、!=、<、<=、>、>= 或当子查询用作表达式。”

当我进行第二次输入时，我想要系统中每个大学 ID 的所有结果。

关于如何让它发挥作用的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:33:00.173

这是重写它以获得所需结果的一种方法：

```
...
WHERE ac.AC_College_ID IN (
  SELECT DISTINCT AC_College_ID 
  FROM AC_Academic_Choice
  WHERE AC_College_ID = 
    CASE @CollegeID
      WHEN 0
      THEN AC_College_ID 
      ELSE @CollegeID 
    END
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:32:27.867

尝试：

```
 WHERE ac.AC_Campus_ID = @CampusID AND
      (SELECT 1 WHERE ac.AC_College_ID IN 
            (CASE @CollegeID
            WHEN 0 THEN (select distinct AC_College_ID from AC_Academic_Choice)
            ELSE @CollegeID
            END
            )
      ) 
```

# java - 如何在另一个类中调用 ActionListener 中的 Java 类

> ID：15012513
> 
> 赞同：0
> 
> 时间：2013-02-21T21:24:17.857
> 
> 标签：java, swing, class, actionlistener

因此，我正在尝试完成一个程序，该程序创建一个可以将汇编语言转换为机器代码的 GUI。该程序需要 7 个类，但我遇到问题的部分是当按下“Assemble”按钮时，让程序 Assemble816 在 ASMEditor 的 actionlistener 中运行。每当我尝试不同的事情时，我都会遇到一百个不同的错误。几乎卡住了。

ASM 编辑器：

```
 public class ASMEditor extends JPanel {
        private JTextArea editArea;
        private JButton assembleButton;
        private JButton clearButton;
        private Assemble816 asm;
        private InstructionMemory iMem;

    public ASMEditor() {
        super( new BorderLayout() );
        setBackground( Color.white );
        Border blackLine = BorderFactory.createLineBorder(Color.black);
        setBorder(
            BorderFactory.createTitledBorder(blackLine, "Assembler"));

        editArea = new JTextArea();
        assembleButton = new JButton( "Assemble" );
        assembleButton.setBackground( getBackground() );
        assembleButton.addActionListener( new ActionListener() {
            public void actionPerformed( ActionEvent evt ) {
                System.out.println( editArea.getText() );
                try{
                    Assemble816 asm = new Assemble816();
                    //this is all I have

                }
                catch(Exception ex)
                {
                    JOptionPane.showMessageDialog(null, ex.getMessage());
                }

            }
        });
        clearButton = new JButton( "Clear" );
        clearButton.setBackground( getBackground() );
        clearButton.addActionListener( new ActionListener() {
            public void actionPerformed( ActionEvent evt ) {
                editArea.setText("");
            }
        });

        JPanel buttons = new JPanel( new FlowLayout(FlowLayout.LEFT, 5, 5 )); 
        buttons.setBackground( Color.white );
        buttons.add( assembleButton );
        buttons.add( clearButton );
        add( buttons, BorderLayout.NORTH );

        Border blueLine = BorderFactory.createLineBorder(Color.blue);
        editArea.setBorder( blueLine );
        editArea.setBackground( new Color( 205, 255, 255) );
        editArea.setFont(new Font("monospaced", Font.PLAIN, 14 ));
        add( editArea, BorderLayout.CENTER );
    }

   } 
```

和组装816：

```
 public class Assemble816 {
    private InstructionMemory im;

    private static String[] twoOperand = {
        "add", "adc", "sub", "xor", "and", "or", "lshift", "ashift"
    };

    private static int lookupTwoOp( String op ) {
        int opcode = 0;
        for( String o : twoOperand ) {
            if ( o.equals( op ) ) {
                return opcode;
            }
            opcode++;
        }
        return -1;
    }

    private static String[] oneOperand = {
        "inc", "dec", "asr", "lsl"
    };

    private static int lookupOneOp( String op ) {
        int opcode = 0;
        for( String o : oneOperand ) {
            if ( o.equals( op ) ) {
                return opcode;
            }
            opcode++;
        }
        return -1;
    }

    private static String[] skip = {
        "skipeq", "skipne", "skipge", "skiplt"
    };

    private static int lookupSkip( String op ) {
        int opcode = 0;
        for( String o : skip ) {
            if ( o.equals( op ) ) {
                return opcode;
            }
            opcode++;
        }
        return -1;
    }

    private static String[] wordConstant = {
        "ldc", "ldd", "std"
    };

    private static int lookupConstant( String op ) {
        int opcode = 0;
        for( String o : wordConstant ) {
            if ( o.equals( op ) ) {
                return opcode;
            }
            opcode++;
        }
        return -1;
    }

    public Assemble816( final InstructionMemory im ){
        this.im = im;
    }

    private static void parseTwoArgs( Scanner sc, String [] words  )
    throws SyntaxError
    {
        String rest = sc.nextLine();
        String[] ws = rest.split(",");
        if ( ws.length != 2 ) {
            throw new SyntaxError("Missing words");
        }
        words[0] = ws[0].trim();
        words[1] = ws[1].trim();
    }

    private static int parseRegister( String reg ) throws SyntaxError {
        if ( reg.equals("r0") ) {
            return 0;
        }
        else if ( reg.equals("r1") ) {
            return 1;
        }
        else if ( reg.equals("r2") ) {
            return 2;
        }
        else if ( reg.equals("r3") ) {
            return 3;
        }
        else {
            throw new SyntaxError("Not a register: " + reg );
        }
    }

    private static int parseInteger( String i ) throws SyntaxError {
        String ii = i;
        try {
            int sign = 1;
            if ( i.charAt(0) == '-' ) {
                i = i.substring(1);
                sign = -1;
            }
            int radix = 10;
            if ( i.startsWith("0x") ) {
                radix = 16;
                i = i.substring(2);
            }
            else if ( i.charAt(0) == '0' ) {
                radix = 8;
            }
            return Integer.parseInt(i, radix ) * sign;
        }
        catch( NumberFormatException ex ) {
            throw new SyntaxError("Not a number: " + ii );
        }
    }

    private static String stripComments( String line ) {
        int split = line.indexOf(';');
        if ( split == -1 ) {
            return line;
        }
        else {
            return line.substring(0, split );
        }
    }

    private void printIM( int address, int length ) {
        int dataPerLine = 0;
        for (int a = address; a < (address+length); a++ ) {
            if ( dataPerLine == 0 ) {
                System.out.printf("%04x", a&0xffff );
                dataPerLine = 16;
            }
            System.out.printf(" %02x", im.fetch(a) & 0xff );
            dataPerLine--;
            if ( dataPerLine == 0 ) {
                System.out.println();
            }
        }
        if ( dataPerLine != 0 ) {
            System.out.println();
        }
    }

    // added for project, not part of assignment
    public void assemble( File f ) throws IOException, SyntaxError {
        byte[] buf = new byte[(int) f.length()];
        FileInputStream fis = new FileInputStream( f );
        fis.read( buf );
        fis.close();
        assemble( new String( buf ) );
    }

    /**
     * Assemble the file, f.
     */
    public void assemble( String str) throws SyntaxError {
        int currentPC = 0;
        int opcode = 0;
        String[] args = new String[2];

        Scanner sc = new Scanner( str );
        while( sc.hasNextLine() ) {
            Scanner parse = new Scanner(stripComments(sc.nextLine()) );
            if ( !parse.hasNext() ) continue; // skip empty line
            String cmd = parse.next();
            if ( cmd.equals(".org") ) {
                if ( !parse.hasNext() ) {
                    throw new SyntaxError(".org excepting integer");
                }
                currentPC = parseInteger( parse.next() );
            }
            else if ( cmd.equals(".dump") ) {
                parseTwoArgs( parse, args );
                int start = parseInteger( args[0] );
                int length = parseInteger( args[1] );
                printIM( start, length );
            }
            else if ( (opcode=lookupConstant(cmd)) != -1 ) {
                parseTwoArgs( parse, args );
                int reg = parseRegister( args[0] );
                int k = parseInteger( args[1] );
                im.set( currentPC, (opcode<<2) | reg );
                currentPC++;
                im.set( currentPC, (k >> 8) & 0xff );
                currentPC++;
                im.set( currentPC, (k >> 0) & 0xff );
                currentPC++;
            }
            else if ( (opcode=lookupTwoOp(cmd)) != -1) {
                parseTwoArgs( parse, args );
                int dst = parseRegister( args[0] );
                int src = parseRegister( args[1] );
                im.set( currentPC, 0x80 | (opcode<<4) | dst << 2 | src );
                currentPC++;
            }
            else if ( cmd.equals( "br" ) ) {
                if ( !parse.hasNext() ) {
                    throw new SyntaxError("br excepting integer");
                }
                int branch = parseInteger( parse.next() );
                im.set( currentPC, 0x40 | (branch & 0x3f) );
                currentPC++;
            }
            else if ( (opcode=lookupOneOp(cmd)) != -1) {
                if ( !parse.hasNext() ) {
                    throw new SyntaxError(cmd + " excepting register");
                }
                int ds = parseRegister( parse.next() );
                im.set( currentPC, 0x20 | (opcode<<2) | ds );
                currentPC++;
            }
            else if ( (opcode=lookupSkip(cmd)) != -1) {
                if ( !parse.hasNext() ) {
                    throw new SyntaxError(cmd + " excepting register");
                }
                int ds = parseRegister( parse.next() );
                im.set( currentPC, 0x30 | (opcode<<2) | ds );
                currentPC++;
            }
            else if ( cmd.equals( "ld" ) ) {
                parseTwoArgs( parse, args );
                int index = parseRegister( args[0] );
                if ( index != 0 && index != 1 ) {
                    throw new SyntaxError("index register must be r0 or r1");
                }
                int ds = parseRegister( args[1] );
                im.set( currentPC, 0x10 | (0<<3) | (index<<2) | ds );
                currentPC++;
            }
            else if ( cmd.equals( "st" ) ) {
                parseTwoArgs( parse, args );
                int index = parseRegister( args[0] );
                if ( index != 0 && index != 1 ) {
                    throw new SyntaxError("index register must be r0 or r1");
                }
                int ds = parseRegister( args[1] );
                im.set( currentPC, 0x10 | (1<<3) | (index<<2) | ds );
                currentPC++;
            }
            else if ( cmd.equals( "jl" ) ) {
                if ( !parse.hasNext() ) {
                    throw new SyntaxError("jl excepting register");
                }
                int link = parseRegister( parse.next() );
                im.set( currentPC, 0x0c | link );
                currentPC++;
            }
            else {
                throw new SyntaxError("unknown instruction: " + cmd );
            }
        }
        sc.close();
    }

    /**
     * main - accepts the name of the file to assemble on the command line.
     */
    public static void main( String[] args ) {
        if ( args.length != 1 ) {
             System.out.println("usage: java Assemble816 file");
             return;
        }
        try {
            InstructionMemory im = new InstructionMemory();
            Assemble816 asm = new Assemble816( im );
            asm.assemble( new File( args[0] ) );
        }
        catch( IOException ex ) {
            System.out.println("io: " + ex.getMessage() );
        }
        catch( SyntaxError ex ) {
            System.out.println("syntax: " + ex.getMessage() );
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T23:01:46.580

`Assemble816`只有一个构造函数，它需要一个参数`InstructionMemory`

```
assembleButton.addActionListener( new ActionListener() {
    public void actionPerformed( ActionEvent evt ) {
        System.out.println( editArea.getText() );
        try{
            InstructionMemory im = new InstructionMemory();
            Assemble816 asm = new Assemble816(im);
            asm.assemble(editArea.getText());
        } catch(Exception ex) {
            // I'd probably dump the stack trace here as well,
            // seen as you're not logging it anywhere
            JOptionPane.showMessageDialog(null, ex.getMessage());
        }

    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:31:41.570

这是在 10,00 英尺处，但不是 try/catch 阻塞语句吗？我认为最好的方法是创建一个线程 Runnable 并在非阻塞线程上运行 Assemble816。否则，ASMEditor 将在 Assemble816 运行时挂起。

此外，仅初始化程序不会自动触发 main ..因此线程可能有助于从超级编辑器类中调用您的 assemble 方法..

[线程](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html "Java 线程")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:39:02.607

您制作了两个 Assemble816 实例，只需要一个。

在 main() 中，您创建了一个带有参数的实例。

您必须将此实例作为参数传递给您的类 ASMEditor，修改构造函数。

```
public class ASMEditor extends JPanel {
    private JTextArea editArea;
    private JButton assembleButton;
    private JButton clearButton;
    private Assemble816 asm;
    private InstructionMemory iMem;

    public ASMEditor( Assemble816 a ) {
       super( new BorderLayout() );
       asm = a;
       ... 
```

不需要实例化两次，所以事件驱动的代码变成：

```
assembleButton.addActionListener( new ActionListener() {
   public void actionPerformed( ActionEvent evt ) {
      try{
         asm.assemble(editArea.getText());
         ... 
```

# php - 用户登录被重定向到 index.php

> ID：15012515
> 
> 赞同：2
> 
> 时间：2013-02-21T21:24:23.023
> 
> 标签：php, mysql, redirect, login

注意：首先我使用 PHP、HTML、CSS、MySQL（数据库），还使用 ​​Dreamweaver 6 来编辑我的所有代码。

好的，所以对于我最后一年的项目，我正在创建一个电子考勤跟踪和监控系统。我在为多个用户创建登录名时遇到了很大的困难。该系统的三个用户是 STAFF、PARENTS 和 STUDENTS。为此，我专注于 STAFF

好的，所以我有...

1.  staff_register.php
2.  staff_verify.php
3.  staff_login.php
4.  staff_home.php

因此，当员工想要注册时，他们必须先注册。所以我有一个表单，它在提交时可以完美地写入数据库。student_register.php 发布到 student_verify.php，其中向用户发送一封激活电子邮件，要求他们验证自己（单击链接）。一旦用户验证，他们就会成为活跃用户。然后他们进入登录页面。当用户输入他们的详细信息时，我会被重定向回 index.php，在我的代码中我特别声明要重定向到 staff_home.php 下面我将提供一些代码：

这是staff_login.php：

```
 <?php include_once("scripts/global.php");
              $message = '';
               ` `if(isset($_POST['email'])){
           $email = $_POST['email'];
    $pass = $_POST['pass'];
    $remember = $_POST['remember'];  `

//error handeling
if( (!$email) || (!$pass) ){
    $message = 'please insert both fields'; 
}else{
    //secure the data
    $email = mysql_real_escape_string($email);
    $pass = sha1($pass);
    $query = mysql_query("SELECT * FROM staff WHERE email='$email'
          AND   password='$pass' LIMIT 1") or die("Could not check member");    
    $count_query = mysql_num_rows($query);
    if($count_query == 0){
        $message = 'The infomation you entered was incorrect';  
    }else{
        //start the sessions
        $_SESSION['pass'] = $pass;
        while($row = mysql_fetch_array($query)){
            $username = $row['username'];
            $id = $row['id'];   
        }
        $_SESSION['username'] = $username;
        $_SESSION['id'] = $id;

        if($remember == "yes"){
            //create the cookies 
            setcookie("id_cookie", $id, time()+60*60*24*100, "/");
            setcookie("pass_cookie", $pass, time()+60*60*24*100, "/");
        }

        header("Location: staff_home.php");

    }

} 
```

index.php 的 PHP 脚本是

```
 <?php include_once("scripts/global.php");
    if ($logged == 1) {
      header("Location: staff_home.php");
      exit; 
    }
 ?> 
```

我将 staff_home.php 放在索引中，因为当我不断被重定向到 index.php 时，我将代码放在顶部，希望它只是将我重定向到 Staff_home.php

staff_home.php 的 PHP 脚本是

```
 <?php include_once("scripts/global.php");
    if ($logged == 0) {
      header("Location:staff_home.php");
      exit();
    }
 ?> 
```

我怀疑也许我必须分配用户角色，但我没有这样做。

所以我想要的是员工登录并重定向到staff_home.php，学生登录并重定向到student_home，父母登录并重定向到parent_home。

几个月来我一直在尝试练习 PHP，但最小的错误真的让我很烦恼，哈哈。我祈祷有人能帮助我！这可能看起来像一个小错误，但我会永远感激任何关于如何改进我的代码并让它发挥作用的提示和建议。我会回来看看是否有人回复，我的电子邮件是 jmudhar90@hotmail.co.uk。

问候人们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:48:02.383

I don't see `session_start()` in your code at any point. You need to call `session_start()` before you can use sessions in a page.

# c# - 是否可以用管道分隔形式编码值而不是逗号？

> ID：15012516
> 
> 赞同：7
> 
> 时间：2013-02-21T21:24:29.073
> 
> 标签：c#, asp.net, .net

目前，我有一组使用相同`name`属性动态创建的文本框：

```
<input type="text" name="SameName" value="Value1" />
<input type="text" name="SameName" value="Value2" /> 
```

在服务器端，我收到提交的表单（POST）并访问`Request.Form["SameName"]`，值为`Value1,Value2`.

我的问题是，是否可以以某种方式将分隔符从逗号更改为管道（或其他字符）？

我不能只用管道替换逗号，因为我需要分隔不同的字段：

```
<input type="text" name="SameName" value="Val,ue1" />
<input type="text" name="SameName" value="Value2" /> 
```

将会：

> 价值，ue1，价值2

建议我有 3 个文本字段而不是两个。所以简单`Replace(',','|')`是没有帮助的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-21T21:44:07.233

In reality, the POST sends the values of the two inputs individually. You're seeing the concatenated version because of how you're accessing it from Request.Form (which is a NameValueCollection).

To be able to differentiate between the different POSTed values, you can use [`GetValues()`](http://msdn.microsoft.com/en-us/library/4ba5htte.aspx)

```
string[] values = Request.Form.GetValues("SameName"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:28:06.543

如果它是一个字符串，你可以使用 string.replace 方法并告诉它你想要替换的字符，以及你想要用什么来替换它。

```
string sr = "Value1,Value2";
sr.Replace(",","|"); 
```

编辑

我认为您可以将 request.form 的返回分配给一个数组，然后遍历该数组以单独获取值并使用它们执行您想要的操作。这将解决结果中有逗号的问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-21T21:57:02.640

这是您尝试做的一个很好的例子：

```
public function MyAction(FormCollection form) as String
    dim sb = new Text.StringBuilder
    for each value as string in form.Getvalues("SameName")
        sb.Append(Server.UrlEncode(value) & ",")

    next
    'Remove trailing comma if you want
    If Right(sb.ToString, 1) = "," Then
        retVal.Remove(sb.Length - 1, 1)
    End If

'Do other fun stuff here if you want

    return sb.ToString

End Function 
```

参考资料：[ASP.NET MVC：检索同名表单字段](https://stackoverflow.com/questions/984717/asp-net-mvc-retrieving-form-fields-with-the-same-name)- C# 中的多个同名字段

[http://msdn.microsoft.com/en-us/library/zttxte6w.aspx](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx) - URL 编码功能

# c# - 通过代码更改自定义控件文本块值

> ID：15012519
> 
> 赞同：1
> 
> 时间：2013-02-21T21:24:43.507
> 
> 标签：c#, xaml, windows-store-apps, controltemplate

我正在学习如何编写 Windows 8 应用程序，但我找不到任何问题的答案。

我创建了一个自定义控件，通过单击按钮添加：

```
onclick() {
    card currentcard = new card();
    ...
    ...
    hand.Children.add(currentCard);
} 
```

在 page.cs

当前的卡控件具有如下所示的 Generic.xaml 信息，其中包含`TextBlock`

```
<Style TargetType="local:tile">
  <Setter Property="VerticalAlignment" Value="Center"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="local:tile">
        <Border
             Background="{TemplateBinding Background}"
             BorderBrush="{TemplateBinding BorderBrush}"
             BorderThickness="{TemplateBinding BorderThickness}">
          <TextBlock x:Name="Label"/> // <----------------------- this textblock
        </Border>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

我可以在 page.cs 或 card.cs 中做什么来获取/设置`TextBlock`命名标签的值？

抱歉，如果这是基本的或以前在某个地方回答过的问题，我进行了搜索，但没有找到答案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:29:49.870

因为有`TextBlock`问题的是称为 Tile 的自定义类型的 a 的一部分，所以`ControlTemplate`最好的办法是将 a 添加`DependencyProperty`到您的 Tile 类型并使用将 的属性`TemplateBinding`绑定到 this new 的值。`Text``TextBlock``DependencyProperty`

您不能轻易地`ControlTemplate`从外部进入 a 来修改该模板的一部分的值。

[这个答案](https://stackoverflow.com/questions/1088906/adding-a-custom-dependency-property-to-a-control-template-in-xaml)提供了一个使用 a`DependencyProperty`并将其绑定到 a 的示例`ControlTemplate`，快速搜索可能会产生许多其他示例。

# matlab - cusp::io::write_matrix_market_file() 给出访问冲突异常

> ID：15012529
> 
> 赞同：1
> 
> 时间：2013-02-21T21:25:35.303
> 
> 标签：matlab, matrix, cuda, cusp-library

我正在尝试使用 CUSP 将 272 x 544 双矩阵从 Matlab 读取到 ELLPACK 格式的稀疏矩阵中。到目前为止，我能找到的唯一方法是将数据读入 mxArray，将 mxArray 读入 double* 数组（使用 mxGetPr()），然后将值复制到 cusp::array2d 中。在那里，我需要将 array2d 写入 .mtx 文件，然后将文件读入 coo_matrix，最后将其转换为 ell_matrix。对我来说这听起来很傻，但鉴于 CUSP 的文档很少，这是我能想到的最好的。如果有人推荐一种更好的方法，我将非常感激。

无论如何，我现在面临的问题是，在我读取 array2d 中的数据并尝试使用 cusp::write_matrix_market_file() 将其写入 .mtx 文件后，我收到“未处理的异常：写入位置的访问冲突”错误消息. 在尝试将它们写入文件之前，我尝试从 array2d 打印一些值，只是为了确保一切都到位并且这些值似乎存储在 array2d 中。我也尝试将类型更改为浮动，但错误仍然存​​在。这是我执行此任务的代码：

```
 #include <thrust/version.h>
     #include <cusp/version.h>
     #include <cusp/ell_matrix.h>
     #include <cusp/print.h>
     #include <cusp/io/matrix_market.h>
     #include <cusp/array2d.h>
     #include <cusp/coo_matrix.h>

     int main(int argc, char** argv)
     {
      const mxArray* mx_g_tra;
      //Reading data from Matlab   
       mx_g_tra = openMatFile2("C:\\out.mat", ndir, "out.tra");
   double* g_tra = mxGetPr(mx_g_tra);
   sizeG_tra=(int)mxGetNumberOfElements(mx_g_tra);
   const mwSize* traDims= mxGetDimensions(mx_g_tra);

      //get matrix dimensions
       tra_W= traDims[0];
   tra_H= traDims[1];
   printf("\nAcquired %d TRA elements as %d x %d from Maltab.\n", sizeG_tra, tra_W, tra_H);
       cusp::array2d<float, cusp::host_memory> TRA(traDims[0], traDims[1]);
       if(g_tra != NULL)
       {
       for(int i=0; i< traDims[0]; i++)
        {
         for(int j=0; j<traDims[1]; j++) 
          {TRA(i,j) = (float)g_tra[i*traDims[1]+j];
           if(TRA(i,j) != 0) printf("\nTRA(%d, %d) = %g", i, j, TRA(i,j));}
        }
       }

 cusp::io::write_matrix_market_file(TRA, "C:\\TRA.mtx"); 
```

在我得到异常时，调用堆栈指向： cusp::io::detail::write_value >,float>(std::basic_ofstream > & output={...}, const float & value=) 行116 + 0x5 字节 C++

编辑：快速更新：我通过修改文件“matrix_market.inl”摆脱了异常，他们有一个奇怪的嵌套循环，通过遍历矩阵 cols 然后再次 cols 将值写入文件（从未考虑过 num_rows）显然因为我的矩阵是不是方形的，代码试图访问不存在的位置。这是修改后的代码：

```
 for(size_t j = 0; j < mtx.num_cols; j++)
       {
    // Modified below: mtx.num_cols --> mtx.num_rows
         for(size_t i = 0; i < mtx.num_rows; i++)
         {
         write_value(output, mtx(i,j));
         output << "\n";
          }
         } 
```

我不确定从这个 .mtx 文件读取时这会如何影响不同的格式构造函数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:16:58.130

This code worked for me, demonstrating how to go directly from array2d to coo or ell:

**EDIT:** updated code sample to show usage of `cusp::is_valid_matrix()`

```
 #include <stdio.h>
 #include <cusp/verify.h>
 #include <cusp/ell_matrix.h>
 #include <cusp/io/matrix_market.h>
 #include <cusp/array2d.h>
 #include <cusp/coo_matrix.h>

 int main(int argc, char** argv)
 {
  // initial matrix
   cusp::array2d<float, cusp::host_memory> E(4, 3);
   E(0,0) =  1.000e+00; E(0,1) =  0.000e+00; E(0,2) =  0.000e+00;
   E(1,0) =  0.000e+00; E(1,1) =  1.050e+01; E(1,2) =  0.000e+00;
   E(2,0) =  0.000e+00; E(2,1) =  0.000e+00; E(2,2) =  2.500e-01;
   E(3,0) =  0.000e+00; E(3,1) =  2.505e+02; E(3,2) =  0.000e+00;

   cusp::coo_matrix<int, float, cusp::host_memory> coo(E);
   cusp::ell_matrix<int, float, cusp::host_memory> ell(E);
   if (!cusp::is_valid_matrix(coo)) {printf("Invalid COO\n"); return 1;}
   if (!cusp::is_valid_matrix(ell)) {printf("Invalid ELL\n"); return 1;}

   cusp::io::write_matrix_market_file(coo, "COO.mtx");
   cusp::io::write_matrix_market_file(ell, "ELL.mtx");
   return 0;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T04:38:01.737

只要行数大于列数，没有异常，代码没有问题。我遇到的问题是因为行数是列数的一半。因此，当文件“matrix_market.inl”中的 write_value 假设我的矩阵是方阵并且在两个循环中只考虑 num_cols 时，我得到了错误。实际上，抛出异常时 i 的值是 273（我的 272 x 544 矩阵中不存在的第一行）。我通过在“matrix_market.inl”代码中编辑 write_matrix_market_stream 来修复它，如下所示：

```
 template <typename Matrix, typename Stream>
       void write_matrix_market_stream(const Matrix& mtx, Stream& output, cusp::array2d_format)
       {
        typedef typename Matrix::value_type ValueType;

        bool is_complex = thrust::detail::is_same<ValueType, cusp::complex<typename                   norm_type<ValueType>::type> >::value;

        if (is_complex)
        output << "%%MatrixMarket matrix array complex general\n";
        else
        output << "%%MatrixMarket matrix array real general\n";

        output << "\t" << mtx.num_rows << "\t" << mtx.num_cols << "\n";

        for(size_t j = 0; j < mtx.num_cols; j++)
        {
         // EDIT needed here
     // Modified below: mtx.num_cols --> mtx.num_rows
        for(size_t i = 0; i < mtx.num_rows; i++)
          {
             write_value(output, mtx(i,j));
            output << "\n";
          }
        }
        } 
```

# objective-c - 根据输入改变背景

> ID：15012530
> 
> 赞同：0
> 
> 时间：2013-02-21T21:25:37.967
> 
> 标签：objective-c, xcode4.5

我创建了一个标签式温度转换器。一个选项卡提供转换器，另一个选项卡是`UIWebView`使用谷歌查找当地天气温度。现在我想通过在第一个选项卡中制作我的背景来使它变得更好，该选项卡是根据用户在`UITextField`. 例如，如果输入的字符串小于 0，我想要一张我将导入的雪景图片。所以我使用以下 if 和 else 语句。Xcode 没有给我错误，但代码不起作用。有人可以帮我完成我的项目吗？提前致谢！这是我的 if 和 else 代码：

```
-(UITextField *)startingTemperatureTextField {
if (startingTemperatureTextField.text < 0)
    self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"Snowy Background.png"]];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T02:36:36.080

try like this..

```
-(UITextField *)startingTemperatureTextField {
     if (![startingTemperatureTextField.text length] > 0 ){
          [self.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"Snowy Background.png"]]];
     }
} 
```

## EDIT

I've completely misunderstood you question! Sorry!

So... you want to change the background if the user inputs a value into your "startingTemperatureTextField" that is less than 0, so i guess that somewhere in your code you have used this method :

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField
{
[textField resignFirstResponder];
return YES;
} 
```

just change this method like this :

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField{
       if( textField == self.startingTemperatureTextField ){

            if ([self.startingTemperatureTextField.text intValue] < 0 ){
                 [self.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"Snowy Background.png"]]];
        }
    }
    textField resignFirstResponder];
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:00:53.590

您正在将字符串与 int 进行比较。使用 intValue 获取字符串的 int 值。

```
 -(UITextField *)startingTemperatureTextField {
        if ([startingTemperatureTextField.text intValue] < 0){
            self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage       imageNamed:@"Snowy Background.png"]];
        }
    } 
```

# iphone - 如何使打开和关闭开关转移到另一个视图控制器？

> ID：15012531
> 
> 赞同：0
> 
> 时间：2013-02-21T21:25:40.883
> 
> 标签：iphone, ios, objective-c, xcode

```
- (void)controlsEnabled:(BOOL)enabled
{
    self.onSwitch.enabled = enabled; 
    if (enabled)
    {
        NSLog(@"ON");
    }
    else
    {
        NSLog(@"OFF");
    }
} 
```

基本上我需要实现这个功能，它会影响另一个视图控制器。如果开关打开，它将在另一个视图控制器中执行某种方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:38:11.480

您需要一个指向`SecondViewController`具有变量的视图控制器的指针`onSwitch`。

如果你有那个参考，你需要做的就是这样的事情。

```
- (void)methodOnTheSecondViewController
{
    if (self.pointerToFirstViewController.onSwitch.enabled) {
        //Do something if ON
    else {
        //Do something if OFF
    }
} 
```

# php - 使用 PHP 从 2 个相同的元标记后面读取

> ID：15012532
> 
> 赞同：1
> 
> 时间：2013-02-21T21:25:43.257
> 
> 标签：php, dom, find

我只想从外部来源读取 2 个价格，最低价格和最高价格。

这是外部来源：

```
<p class="mb_05 magnify_price_stores"><span>
<span class="txt_price_gray">429,11  RON</span> - <span class="txt_price_gray">678,50 RON</span>
</span> <span><span  class="gray">(de la <b>50</b> magazine)</span></span></p> 
```

我正在使用这段代码：

```
 function emag() {
 $dom1 = file_get_html("http://www.shopmania.ro/telefoane-mobile/p-samsung-galaxy-y-duos-s6102-25140344");
     foreach ($dom1->find('span [class=txt_price_gray]') as $node)
   {
   $result = $node->innertext;
   $price = explode("RON", $result);
   $prices[] = $price[0];
   echo "$prices[0]";
   }}

   emag() 
```

我得到了这个：`429,11 429,11`on `$prices[0]`and `678,50`on $prices[1] `$prices[0]`是双倍的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:30:07.287

迭代时将值保存到数组中。更换

```
echo "$price[0]"; 
```

和

```
$prices[] = $price[0]; 
```

然后可以使用 $prices[0] 和 $prices[1] 访问这两个价格

# python - 使用 pytest.raises 捕获预期的自定义错误

> ID：15012539
> 
> 赞同：20
> 
> 时间：2013-02-21T21:26:24.223
> 
> 标签：python, pytest

我是新手`pytest`，正在尝试将一些功能测试脚本转换为与`pytest`. 我的模块具有自定义错误类型，我正在尝试使用该`with pytest.raises() as excinfo`方法。这是一个科学/数值包，我需要测试某些方法在调用时是否一致，所以我不能只深入到较低级别的东西。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-03-01T06:58:32.833

是什么阻止您导入特定异常并在`with` [pytest.raises](http://pytest.org/latest/assert.html#assertraises)语句中使用它？为什么这不起作用？如果您可以提供有关您所面临问题的更多详细信息，那将会更有帮助。

```
# your code

class CustomError(Exception):
    pass

def foo():
    raise ValueError('everything is broken')

def bar():
    raise CustomError('still broken')    

#############    
# your test

import pytest
# import your module, or functions from it, incl. exception class    

def test_fooErrorHandling():
    with pytest.raises(ValueError) as excinfo:
        foo()
    assert excinfo.value.message == 'everything is broken'

def test_barSimpleErrorHandling():
    # don't care about the specific message
    with pytest.raises(CustomError):
        bar()

def test_barSpecificErrorHandling():
    # check the specific error message
    with pytest.raises(MyErr) as excinfo:
        bar()
    assert excinfo.value.message == 'oh no!'

def test_barWithoutImportingExceptionClass():
    # if for some reason you can't import the specific exception class,
    # catch it as generic and verify it's in the str(excinfo)
    with pytest.raises(Exception) as excinfo:
        bar()
    assert 'MyErr:' in str(excinfo) 
```

# sql - 连接两个行数不匹配的表

> ID：15012541
> 
> 赞同：0
> 
> 时间：2013-02-21T21:26:27.623
> 
> 标签：sql, sql-server, join

我有两张桌子：

旧表（OT）

```
 Record_id |  Name  |  Sequence_num
------------------------------------
    78     | Austin |  0
    78     | Mike   |  1
    78     | Joe    |  2 
```

和

新表 (NT)

```
 Record_id |  Name  |  Sequence_num
------------------------------------
    78     | Mike   |  0
    78     | Joe    |  1
    78     | Austin |  2
    78     | Fred   |  3
    78     | Ben    |  4 
```

我正在寻找的是输出表，如下所示：

```
 Record_id |  OT_Name  |  NT_Name  |  Sequence_num
---------------------------------------------------
    78     |  Austin   |  Mike     |  0
    78     |  Mike     |  Joe      |  1
    78     |  Joe      |  Austin   |  2
    78     |  NULL     |  Fred     |  3
    78     |  NULL     |  Ben      |  4 
```

问题是我不确定每个表中有多少行。OT 可以有 10 行，NT 可以有 3 行，或者 NT 可以多于 OT，或者它们可以有相同的数量。在对面表中没有匹配 Sequence_num 的任何行都需要在相应列中具有 NULL 值。在这种情况下，如果没有为每个表创建一个函数，那么一个 select 语句怎么能做到这一点呢？我无法为我的一生想出一个解决方案。

编辑：

使用 MS Sql 服务器 2008

管理工作室 10.0.1600.22

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:30:56.650

如果您使用的是支持`FULL OUTER JOIN`语法的数据库，那么您可以使用：

```
select 
  coalesce(ot.record_id, nt.record_id) record_id,
  ot.name OT_Name,
  nt.name NT_name,
  coalesce(ot.sequence_num, nt.sequence_num) Sequence_num
from old_table ot
full outer join new_table nt
  on ot.record_id = nt.record_id
  and ot.sequence_num =  nt.sequence_num 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/485a0/5)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:37:40.333

以下内容适用于任何数据库。它不依赖于`full outer join`：

```
select record_id,
       MAX(case when which = 'ot' then name end) as ot_name,
       MAX(case when which = 'nt' then name end) as nt_name,
       sequence_num
from ((select record_id, name, sequence_num, 'ot' as which
       from ot
      ) union all
      (select record_id, name, sequence_num, 'nt' as which
       from nt
      )
     ) t
group by record_id, sequence_num 
```

# ios - 如何从 NSMutableArray 打印对象变量？

> ID：15012543
> 
> 赞同：0
> 
> 时间：2013-02-21T21:26:44.963
> 
> 标签：ios, objective-c

从我读过的内容中`NSMutableArray`添加了对象。

如何`Student`从给定位置打印对象变量而不将对象转换为`Student`.

我正在寻找类似`ArrayList<Student>`Java 的东西，所以我可以轻松地打印`ArrayList.get(i).getName`, `ArrayList.get(i).getPrice`.

```
 StudentRepository* myStudentRepo = [[StudentRepository alloc]init];

    Student* myStudent = [[Student alloc]init];

    myStudent.name = @"John";

    // add a Student to the NSMutableArray
    [myStudentRepo.studentRepository addObject:myStudent];

    NSLog(@"Value: %@", myStudentRepo.studentRepository);

    for(Student* myStudentItem in myStudentRepo.studentRepository)
    {
        NSLog(@"Value: %@", myStudentItem.name);
    }

    // print the Student from a given position
    NSLog(@"Value: %@", [(Student*)[myStudentRepo.studentRepository objectAtIndex:0] name]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:31:27.903

您发布的代码按原样很好。Objective-C / Cocoa 中没有与 Java 的类型化集合等效的东西。您需要转换结果。

实际上，您可以做一个小技巧：

```
NSLog(@"Value: %@", [myStudentRepo.studentRepository[0] valueForKey:@"name"]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:32:48.420

您可以使用 KVC（键值编码）来访问对象的属性而无需强制转换：

```
[[myStudentRepo.studentRepository objectAtIndex:0] valueForKey:@"name"]; 
```

请参阅：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/BasicPrinciples.html#//apple_ref/doc/uid/20002170-BAJEAIEE](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/BasicPrinciples.html#//apple_ref/doc/uid/20002170-BAJEAIEE)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:38:16.523

您可以覆盖`description`或`debugDescription`在您的`Student`班级中：

由于我不是您的学生的组成，请允许以下直截了当的示例：

```
// could also be -(NSString*)debugDescription    
- (NSString *)description {
      return [NSString stringWithFormat:@"Prop1: %@ \nIntVal1: %d\nfloatVal1 = %3.2f", self.prop1, self.intVal1, self.floatval1];
} 
```

但是，对于大型复杂的对象，这会变得乏味。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T21:44:19.813

你可以使用这样的东西

```
[(Student*)myStudentRepo.studentRepository[0] name]; 
```

或者您可以像这样覆盖 Student 的描述：在 Student.m 中添加：

```
-(NSString *)description{
        return [NSString stringWithFormat:@"Student Name:%@", self.name];
     } 
```

每当您需要打印学生时，只需键入：

```
NSLog(%@, student); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-21T21:56:09.020

如果您希望确保您的集合实际上只包含`Student`对象，相当于 Java 的参数集合，您可以这样做。有关字典的解决方案，请参阅[此问题](https://stackoverflow.com/questions/5197446/nsmutablearray-force-the-array-to-hold-specific-object-type-only)，数组解决方案将是类似的。您可以将该问题的公认解决方案与键入的 getter 和 setter 结合起来，以避免任何强制转换。

或者，如果您实际上并不关心确保只能`Student`添加​​对象，您可以编写一个扩展或类别来添加类型化的 getter 或 setter - 这只是调用标准 setter 或 getter 根据需要添加强制转换。您也会在上述问题的答案中看到这种方法。

*（这里没有代码，因为你会在另一个问题中找到你需要的一切。）*

# delphi - 从模式窗口打开的帮助文件无响应

> ID：15012547
> 
> 赞同：8
> 
> 时间：2013-02-21T21:26:56.127
> 
> 标签：delphi, delphi-xe2, helpfile

使用德尔福 XE2、Win64。

所以我有一个包含许多表单的大型应用程序，如果我从主表单打开帮助文件并打开一个模态窗口，然后按 F1 在模态窗口上触发上下文相关帮助，帮助文件窗口会显示正确的信息，但是在我关闭模式窗口之前，无法关闭帮助文件。如果我在模式窗口关闭之前返回应用程序，我什至无法让帮助文件再次获得焦点。

从与新版本（使用 Delphi XE2 构建）位于同一文件夹中的旧版本应用程序（使用 Delphi 6 构建）调用这个*完全相同*的帮助文件，当从模式窗口中按下 F1 键时，帮助文件会显示并且是反应灵敏，可以像我期望的那样关闭。

帮助文件是 .chm 类型的文件。

总结一下。

启动应用程序 通过 F1 打开帮助文件 跳转到应用程序并在应用程序中打开模式窗口 通过按 F1 从模式窗口启动帮助 帮助文件窗口无法关闭，直到我跳回我的应用程序并关闭模式窗口。

有人知道为什么会这样吗？

我搜索了互联网，没有发现任何类似的问题。

我们很难过。

干杯 TJ

- - 编辑 - -

以下是同样表现出此行为的示例两表单应用程序的一些代码。

```
program Project1;

uses
  Vcl.Forms,
  HTMLHelpViewer,
  Unit1 in 'Unit1.pas' {Form1},
  Unit2 in 'Unit2.pas' {Form2};

{$R *.res}

begin
  Application.Initialize;
  Application.HelpFile := 'C:\helpfile.chm';
  Application.MainFormOnTaskbar := True;
  Application.CreateForm(TForm1, Form1);
  Application.Run;
end. 
```

这是Form1代码：

```
unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

uses Unit2;

procedure TForm1.Button1Click(Sender: TObject);
begin
  Form2 := TForm2.Create(Application);
  try
    Form2.ShowModal;
  finally
    Form2.Free;
  end;
end;

end. 
```

我将两个表单上的 helpcontext 属性设置为我的帮助文件中的两个有效上下文。

运行应用程序 - F1 打开帮助文件 点击按钮以便创建 Form2 并显示 F1 以调用帮助文件 在我关闭 Form2 之前无法关闭帮助文件。

希望这可以帮助。- TJ

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T22:05:06.723

这是一个严重的设计缺陷`HtmlHelpViewer`。并且很容易重现您描述的行为。做得很好，可以如此清楚地说明问题。该问题同样影响 32 位和 64 位程序。

我个人不使用`HtmlHelpViewer`，因为它不起作用。我为`TApplication.OnHelp`. 它看起来像这样：

```
class function THelpWindowManager.ApplicationHelp(Command: Word; 
  Data: THelpEventData; var CallHelp: Boolean): Boolean;
begin
  CallHelp := False;
  Result := True;
  //argh, WinHelp commands
  case Command of
  HELP_CONTEXT,HELP_CONTEXTPOPUP:
    HtmlHelp(GetDesktopWindow, Application.HelpFile, HH_HELP_CONTEXT, Data);
  end;
end; 
```

把它放在一个类中并`Application.OnHelp`在启动时分配它：

```
Application.OnHelp := THelpWindowManager.ApplicationHelp; 
```

我刚刚在简单的两个表单应用程序上对其进行了测试，它运行良好。在实际代码中，您可能希望对此进行修饰。例如，我的实际代码更复杂。它在用户设置中存储帮助窗口关闭时的位置和窗口状态。然后当再次显示时，该位置和窗口状态被恢复。这样帮助窗口就可以记住它上次在屏幕上的位置。

* * *

感谢@Sertac 在下面的评论中挖掘出细节。总之，这里是`HtmlHelpViewer`代码出错的地方：

1.  它[`HH_INITIALIZE`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms670090.aspx)在帮助系统启动时发送命令。
2.  如[文档](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms670090.aspx)中所述，这*会将 HTML 帮助配置为在与调用应用程序相同的线程上运行，而不是在辅助线程上运行*。
3.  当您调用`ShowModal`该调用时`DisableTaskWindows`，它将禁用调用线程中的窗口。
4.  因为帮助查看器窗口是由您的应用程序的主线程创建的（由于该`HH_INITIALIZE`命令），所以它被禁用。

这就是为什么在 Delphi 模态表单处于活动状态时无法与预先存在的帮助窗口进行交互的原因。

# c# - 通过 tcp 或套接字发送类型化的对象

> ID：15012549
> 
> 赞同：15
> 
> 时间：2013-02-21T21:27:00.793
> 
> 标签：c#, sockets, tcpclient

我在为我在 Xna 中制作的一个非常简单的游戏创建网络接口时遇到了麻烦。我只需要通过 TCP 客户端/套接字发送对象。例如：我有一个名为“Player”的类。在每个 Player 中，都有一个名为“Info”的字段，类型为“PlayerInfo”。在客户端/服务器中，我需要将每个玩家的信息发送给每个客户端，除了发送它的那个（显然）。这是一个简单的例子，但我需要大约 5 到 10 个对象，加上发送玩家更新（位置、动作……）。注意：我将我在 C# 和编程方面的知识评为 6/10，因此如果您有解决方案，则无需解释所有内容（例如：变量和字段之间的区别是什么）。我也知道接口、库等等……在此先感谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-02-21T22:21:48.903

我有一种我会推荐的方法和两种较小的方法，它们依赖于许多事情。

第一个意味着您已经知道如何使用 Socket 类，但是有很多类需要通过它发送。

从传输的角度来看，您应该只创建/考虑一个非常简单的类。让我们称这个类为 MyMessage：

```
public class MyMessage {
  public byte[] Data { get; set; }
} 
```

好的。从 TCP 的角度来看，您需要做的就是确保您能够传递此类的实例（从客户端到服务器并返回）。我不会深入探讨这样做的细节，但我会指出，如果你设法做到这一点，你就会将 TCP/IP 连接的性质从“字节流”转变为“消息流”。这意味着通常情况下，TCP/IP 不保证您通过连接发送的数据块以相同的形式到达目的地（它们可能会连接在一起或分开）。它唯一保证的是所有块的字节最终将以相同的顺序到达连接的另一端（总是）。

现在您已经启动并运行了一个消息流，您可以使用 .NET 良好的旧序列化将任何类实例封装在 Data 属性中。这样做是将对象图序列化为字节，反之亦然。

您这样做的方式（最常见）是使用标准库类：System.Runtime.Serialization.Formatters.Binary.BinaryFormatter，可以在 mscorlib.dll 中找到，如下所示：

```
public static class Foo {

  public static Message Serialize(object anySerializableObject) {
    using (var memoryStream = new MemoryStream()) {
      (new BinaryFormatter()).Serialize(memoryStream, anySerializableObject);
      return new Message { Data = memoryStream.ToArray() };
    }
  }

  public static object Deserialize(Message message) {
    using (var memoryStream = new MemoryStream(message.Data))
      return (new BinaryFormatter()).Deserialize(memoryStream);
  }

} 
```

BinaryFormatter 类能够从作为 Serialize (Stream, object) 方法的第二个参数提供的根/哨兵开始遍历对象的树/图，并将所有原始值加上类型信息和相对位置信息写入提供的溪流。只要提供的流的位置与前一个对象图序列化的位置相对应，它也能够进行精确的逆向和反序列化整个对象图。

不过这里有一些问题：您需要使用 [SerializableAttribute] 注释所有类。如果您的类包含您编写的其他类的字段，并且您说它们有：

```
[SerializableAttribute]
public class Player {
  public PlayerInfo Info; 
  //... etc 
```

那么你也需要用 [SerializableAttribute] 注释那些：

```
[SerializableAttribute]
public class PlayerInfo { //... etc 
```

如果您的类包含由其他人（例如 Microsoft）编写的类型的字段，那么这些字段最好已经用该属性进行注释。大多数可以序列化的已经是。原始类型自然是可序列化的。不应该序列化的东西是：FileStreams、Threads、Sockets等。

在确保你有可序列化的类之后，你需要做的就是序列化它们的实例，发送它们，接收它们并反序列化它们：

```
class Client {

  public static void SendMovement(Movement movement) {
    Message message = Foo.Serialize(movement);

    socketHelper.SendMessage(message);
  }
  public static void SendPlayer(Player player) {
    Message message = Foo.Serialize(player);

    socketHelper.SendMessage(message);
  }
  // .. etc

  public static void OnMessageReceivedFromServer(Message message) {
    object obj = Foo.Deserialize(message);
    if (obj is Movement)
      Client.ProcessOtherPlayersMovement(obj as Movement);
    else if (obj is Player)
      Client.ProcessOtherPlayersStatusUpdates(obj as Player);
    // .. etc
  }

  public static void ProcessOtherPlayersMovement(Movement movement) {
    //...
  }
  // .. etc

} 
```

在服务器端：

```
class Server {

  public static void OnMessageReceived(Message message, SocketHelper from, SocketHelper[] all) {
    object obj = Foo.Deserialize( message );
    if (obj is Movement)
      Server.ProcessMovement( obj as Movement );
    else if (obj is Player)
      Server.ProcessPlayer( obj as Player );
    // .. etc

    foreach (var socketHelper in all)
      if (socketHelper != from)
        socketHelper.SendMessage( message );
  }
} 
```

您将需要一个通用的程序集项目（类库）供两个可执行项目（客户端和服务器）引用。

您需要传递的所有类都必须编写在该程序集中，以便服务器和客户端都知道如何在这个非常详细的级别上相互理解。

如果服务器不需要了解客户端之间所说的内容并且只传递消息（将一条消息广播到其他 N-1 个客户端），那么忘记我所说的关于通用程序集的内容。在这种特殊情况下，服务器只看到字节，而客户端对来回发送的实际消息有更深入的了解。

我说我有三种方法。

第二个涉及 .NET Remoting，它可以减轻你的大量工作，但如果你不完全理解它，就很难忍受。你可以在 MSDN 上阅读它，这里：http: [//msdn.microsoft.com/en-us/library/kwdt6w2k (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/kwdt6w2k(v=vs.100).aspx)

仅当（现在或将来）XNA 指的是 Windows Phone 或不支持 BinaryFormatter 类的 XNA 的另一个实现（带有 MonoTouch 的 ExEn 或其他）时，第三个会更好。在这种情况下，如果您需要您的服务器（一个成熟的老式 .NET 应用程序）来引用我谈到的通用程序集并且还有游戏项目（这不是一个好的老式 . NET 应用程序，但具有相当奇特的性质）引用完全相同的程序集。

在这种情况下，我们需要使用序列化和反序列化对象的替代形式。您还需要在两个世界（.NET 和 WP7 或 WP8）中相同地实现两组类。您可以使用某种形式的 XML 序列化程序，您需要将其显式映射到您的类（不如 BinaryFormatter 类强大，但在托管您的类的运行时的性质方面更通用）。

您可以在此处阅读 MSDN 上的 XmlSerializer 类：http: [//msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-21T22:38:58.317

我个人使用 JSON.NET 的快速干净的解决方案：

```
class JMessage
{
    public Type Type { get; set; }
    public JToken Value { get; set; }

    public static JMessage FromValue<T>(T value)
    {
        return new JMessage { Type = typeof(T), Value = JToken.FromObject(value) };
    }

    public static string Serialize(JMessage message)
    {
        return JToken.FromObject(message).ToString();
    }

    public static JMessage Deserialize(string data)
    {
        return JToken.Parse(data).ToObject<JMessage>();
    }
} 
```

现在您可以像这样序列化您的对象：

```
Player player = ...;
Enemy enemy = ...;
string data1 = JMessage.Serialize(JMessage.FromValue(player));
string data2 = JMessage.Serialize(JMessage.FromValue(enemy)); 
```

通过网络发送该数据，然后在另一端您可以执行以下操作：

```
string data = ...;
JMessage message = JMessage.Deserialize(data);
if (message.Type == typeof(Player))
{
    Player player = message.Value.ToObject<Player>();
}
else if (message.Type == typeof(Enemy))
{
    Enemy enemy = message.Value.ToObject<Enemy>();
}
//etc... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-21T22:04:11.383

您可以使用 .net 框架中提供的各种类来创建自己的解决方案。您可能想要检查 WCF 或 Sockets 名称空间，特别是 TcpClient 和 TcpListener 类，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/sb27wehh.aspx)。如果您进行与使用这些相关的搜索，将会有很多很棒的教程。您还需要考虑如何将类型化对象转换为字节数组，类似于这个[问题](https://stackoverflow.com/questions/10390356/c-sharp-serializing-deserializing-with-memory-stream)。

另一种方法是使用网络库。有低级库和高级库。鉴于您的编程经验水平和特定的最终目标，我建议您使用高级库。这种网络库的一个例子是[lidgren](http://code.google.com/p/lidgren-network-gen3/)。我是另一个网络库[networkComms.net](http://www.networkcomms.net)的开发人员，下面是如何使用此库发送类型化对象的快速示例：

Shared Base（定义 Player 对象）：

```
[ProtoContract]
class Player
{
    [ProtoMember(1)]
    public string Name { get; private set; }
    [ProtoMember(2)]
    public int Ammo { get; private set; }
    [ProtoMember(3)]
    public string Position { get; private set; }

    private Player() { }

    public Player(string name, int ammo, string position)
    {
        this.Name = name;
        this.Ammo = ammo;
        this.Position = position;
    }
} 
```

客户端（发送单个 Player 对象）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

using NetworkCommsDotNet;
using ProtoBuf;

namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            Player player = new Player("MarcF", 100, "09.09N,21.12W");

            //Could also use UDPConnection.GetConnection...
            TCPConnection.GetConnection(new ConnectionInfo("127.0.0.1", 10000)).SendObject("PlayerData", player);

            Console.WriteLine("Send completed. Press any key to exit client.");
            Console.ReadKey(true);
            NetworkComms.Shutdown();
        }
    }
} 
```

服务器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

using NetworkCommsDotNet;
using ProtoBuf;

namespace Server
{
    class Program
    {
        static void Main(string[] args)
        {
            // Convert incoming data to a <Player> object and run this method when an incoming packet is received.
            NetworkComms.AppendGlobalIncomingPacketHandler<Player>("PlayerData", (packetHeader, connection, incomingPlayer) =>
            {
                Console.WriteLine("Received player data. Player name was " + incomingPlayer.Name);
                //Do anything else with the player object here
                //e.g. UpdatePlayerPosition(incomingPlayer);
            });

            //Listen for incoming connections
            TCPConnection.StartListening(true);

            Console.WriteLine("Server ready. Press any key to shutdown server.");
            Console.ReadKey(true);
            NetworkComms.Shutdown();
        }
    }
} 
```

以上是本[教程](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)的修改版。您显然需要从网站下载 NetworkCommsDotNet DLL，以便可以将其添加到“使用 NetworkCommsDotNet”参考中。另请参阅客户端示例中的服务器 IP 地址当前为“127.0.0.1”，如果您在同一台机器上同时运行服务器和客户端，这应该可以工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-11T12:58:08.060

两年多后，我找到了解决这个问题的新方法，我认为分享它可能对某人有用。请注意，接受的答案仍然有效。

我能找到的序列化类型对象的最简单方法是使用 Json.NET 中的 json 转换器。有一个设置对象允许您将 json 中的类型存储为名为`$type`. 以下是如何执行此操作以及生成的 json：

```
JsonSerializerSettings settings = new JsonSerializerSettings
{
    TypeNameHandling = TypeNameHandling.All
};

JsonConvert.SerializeObject(myObject, settings); 
```

json结果：

```
{
    "$type" : "Testing.MyType, Testing",
    "ExampleProperty" : "Hello world!"
} 
```

反序列化时，如果使用相同的设置，则会反序列化正确类型的对象。正是我需要的！希望这可以帮助。

# javascript - 将工具提示/热点添加到 360 度图像查看器

> ID：15012556
> 
> 赞同：1
> 
> 时间：2013-02-21T21:27:25.717
> 
> 标签：javascript, jquery, ios

我有一个在我的站点中使用的图像旋转器，但现在我需要能够将热点添加到某些角度。这是我使用的插件。
[http://blog.stableflow.com/jquery-plugins/360-degrees-product-view/#comments](http://blog.stableflow.com/jquery-plugins/360-degrees-product-view/#comments)
有没有人用过这个并且能够调整它来添加热点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T23:19:23.943

我查看了插件代码，它不支持使用图像映射，所以我提取了您需要的基本代码，并在第三张图像上添加了一个大黄点，您可以将鼠标悬停在上面 -[这是一个演示](http://jsfiddle.net/Mottie/g2Shg/)。

HTML

```
<div id="product" style="width: 640px; height: 480px; overflow: hidden;">
    ...
    <img src="03.jpg" usemap="#img03" />
    <map name="img03" width="640" height="480">
        <area shape="circle" coords="366,154,65" href="#" title="Yellow Dot!" />
    </map>
    ...
</div> 
```

CSS

```
.notseen {
    position: absolute;
    left: 0;
    top: 0;
    visibility: hidden;
} 
```

脚本

```
// original: http://blog.stableflow.com/jquery-plugins/360-degrees-product-view/
// No need to include the plugin, this is a simplified version of it

jQuery(document).ready(function ($) {
    var $product = $('#product'),
        $imgs = $product.find('img'),
        imageTotal = $imgs.length - 1,
        clicked = false,
        widthStep = 4,
        currPos,
        currImg = 0,
        lastImg = 0;
    $imgs.bind('mousedown', function (e) {
        e.preventDefault(); // prevent dragging images
    })
        .filter(':gt(0)').addClass('notseen');

    $product.bind('mousedown touchstart', function (e) {
        if (e.type == "touchstart") {
            currPos = window.event.touches[0].pageX;
        } else {
            currPos = e.pageX;
        }
        clicked = true;
        return false;
    });
    $(document)
        .bind('mouseup touchend', function () {
        clicked = false;
    })
        .bind('mousemove touchmove', function (e) {
        if (clicked) {
            var pageX;
            if (e.type == "touchmove") {
                pageX = window.event.targetTouches[0].pageX;
            } else {
                pageX = e.pageX;
            }
            widthStep = 4;
            if (Math.abs(currPos - pageX) >= widthStep) {
                if (currPos - pageX >= widthStep) {
                    currImg++;
                    if (currImg > imageTotal) {
                        currImg = 1;
                    }
                } else {
                    currImg--;
                    if (currImg < 1) {
                        currImg = imageTotal;
                    }
                }
                currPos = pageX;
                $imgs.eq(lastImg).addClass('notseen');
                $imgs.eq(currImg).removeClass('notseen');
                lastImg = currImg;
                // $obj.html('<img src="' + aImages[options.currImg] + '" />');
            }
        }
    });
}); 
```

# java - 无法在 Mac OS 中使用 eclipse 获得 Java3D

> ID：15012557
> 
> 赞同：0
> 
> 时间：2013-02-21T21:27:25.780
> 
> 标签：java, eclipse, macos, java-3d

我实际上已经搜索过，但在任何网站上都没有找到解决方案。我正在尝试在 MacOS 中使用 Java3D 编写 Java 程序，并且我正在尝试在 Eclipse 中使用 Java3D。我正在尝试运行一个简单的 HelloUniverse 代码，但出现以下异常：

```
线程“AWT-EventQueue-0”java.lang.UnsatisfiedLinkError 中的异常：java.library.path 中没有 J3D
    在 java.lang.ClassLoader.loadLibrary(ClassLoader.java:1860)
    在 java.lang.Runtime.loadLibrary0(Runtime.java:845)
    在 java.lang.System.loadLibrary(System.java:1084)
    在 javax.media.j3d.MasterControl$22.run(MasterControl.java:891)
    在 java.security.AccessController.doPrivileged（本机方法）
    在 javax.media.j3d.MasterControl.loadLibraries(MasterControl.java:888)
    在 javax.media.j3d.VirtualUniverse.(VirtualUniverse.java:233)
    在 HelloUniverse.createUniverse(HelloUniverse.java:100)
    在 HelloUniverse.(HelloUniverse.java:126)
    在 HelloUniverse$1.run(HelloUniverse.java:161)
    在 java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    在 java.awt.EventQueue.dispatchEventImpl(EventQueue.java:701)
    在 java.awt.EventQueue.access$000(EventQueue.java:102)
    在 java.awt.EventQueue$3.run(EventQueue.java:662)
    在 java.awt.EventQueue$3.run(EventQueue.java:660)
    在 java.security.AccessController.doPrivileged（本机方法）
    在 java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    在 java.awt.EventQueue.dispatchEvent(EventQueue.java:671)
    在 java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    在 java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    在 java.awt.EventDispatchThread.pumpEventsForHierarchy（EventDispatchThread.java:151）
    在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    在 java.awt.EventDispatchThread.run(EventDispatchThread.java:97)

```

我已经将 j3dcore.jar vecmath.jar 和 j3dutils.jar 以及一堆其他库添加到我的构建路径中，但它似乎不起作用。

任何人都可以帮助我在 Mac 的 eclipse 中使用 Java3D 吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:07:01.527

`java.lang.UnsatisfiedLinkError`表示您缺少必需的本机库。Java3D 由 JAR 和本地库组成。在您的 Java 构建路径中，找到您的 Java3D JAR，单击箭头图标以打开每个 JAR 的选项，然后选择“Native Library Location”并编辑。将它指向 jnilib 文件所在的位置（可能是 /System/Library/Java/Extensions/）。

# git - 仅使用本地和实时服务器的 git 一人工作流

> ID：15012558
> 
> 赞同：0
> 
> 时间：2013-02-21T21:27:25.657
> 
> 标签：git, drupal, vps

我一直在发展自由网页设计业务，主要使用 Drupal。我现在需要更加认真并开始版本控制。当我运行升级时，我需要知道一切是否仍然正常工作。

我想使用 git。这是我目前的情况：一个有大约 30 个不同网站的 VPS 服务器。

到目前为止，我一直在使用子域直接在线构建网站。这让我可以向客户展示。

我一直在研究 Git 工作流程，对于什么是对我来说最好的第一步/下一步有点困惑......

第一个问题：远程/实时服务器上的主存储库和我机器上的本地存储库是否足够好？大多数人都在谈论像 github 这样的第三个服务器？如果我能绕过它，那就太好了！

第二个问题：如果我理解正确，我需要为每个 Web 项目创建一个存储库，对吗？

第三个问题：我该如何开始？首先创建哪个存储库？还是我只是在网站根文件夹之一中运行 git init ？

任何帮助/建议将不胜感激！我可以回答你可能有的任何问题...

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:37:16.667

> 远程/实时服务器上的主存储库和我机器上的本地存储库是否足够好？大多数人都在谈论像 github 这样的第三个服务器？

3 个存储库更好...您应该拥有一个类似于主存储库的主存储库，它本质上是所有其他存储库的远程来源。然后你从那个 repo 克隆到你的本地机器和子域或其他任何东西。您在本地进行更改，然后推送到该远程，然后在子域上提取更改。一种替代方法是简单地从主存储库部署到子域，这意味着会发生一些部署过程并且子域代码本身不会是 git 存储库。

> 我需要为每个 Web 项目创建一个存储库，对吗？

是的，那将是最好的。

> 我该如何开始？

我通常先创建远程“主仓库”，然后克隆它。

# email - Automator：将附件添加到前端消息错误

> ID：15012563
> 
> 赞同：0
> 
> 时间：2013-02-21T21:27:46.547
> 
> 标签：email, workflow, automator

我有这个自动化服务，它从查找器中获取文件并执行将附件添加到前端消息工作流。

所以我在 mail.app 中对同事的电子邮件点击“答复”，输入我的电子邮件，然后直接转到查找器并在选定的文档上执行服务。不幸的是，工作流失败，结果是：没有传出消息。

我是否正确使用了这个工作流程？是否将附件添加到前面的消息做我认为它做的事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T23:28:06.697

是的，我也试过了，自动操作“将附件添加到前面的消息”有问题。我确实有一个作为服务运行的applescript，但它以相反的方式运行。

您右键单击任何文件，然后单击“带附件的新电子邮件”服务，它的作用是创建一个带有附件的新电子邮件。然后，您可以编写已附加的电子邮件。好像可以这样，不是吗？

# python - 为什么总是需要这种“get”方法？

> ID：15012570
> 
> 赞同：0
> 
> 时间：2013-02-21T21:28:02.847
> 
> 标签：python, class

```
class teste(object):
    def __init__(self,a):
        self.a=a

    def getA(self):
        return self.a

new=teste("lucas")
print new.getA()  #########  LINE 1
print new.a       #########  LINE 2 
```

为什么在类中我们总是需要这种“get”方法？我的意思是，“LINE 1”和“LINE 2”有什么区别？他们输出相同的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:32:36.173

你不在 Python 中。

请注意，getter 和 setter 经常被认为是“un [pythonic](http://blog.startifact.com/posts/older/what-is-pythonic.html) ”（相关：） `python -c 'import this'`。

[吸气](http://en.wikipedia.org/wiki/Getter)剂只是一种风格。有时您可能想使用吸气剂，但[并不总是必要](https://softwareengineering.stackexchange.com/questions/21802/when-are-getters-and-setters-justified)的。了解[为什么使用 getter 和 setter](https://stackoverflow.com/questions/1568091/why-use-getters-and-setters)来进行关于 getter 和 setter 的一般性讨论。

对于 Python 的更多相关性，请考虑：
[一个意见片](http://unclezeiv.kerid.org/2009/08/about-getters-and-setters-in-python)， [另一个意见片](http://eli.thegreenplace.net/2009/02/06/getters-and-setters-in-python/)，[一些示例代码](http://www.moosechips.com/2011/02/python-getters-and-setters/)或[一些其他示例代码](http://davesmisc.wordpress.com/2011/02/07/python-getters-and-setters/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T21:29:39.300

在 python 中，您不需要 get 方法。这是编码风格的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:55:40.253

其他答案已经说您在 Python 中永远不需要 getter，这只是风格问题。

但这里的关键是有一种 Pythonic 风格，不必要的 getter 与这种风格背道而驰。当有经验的 Python 开发人员阅读您的代码时，使用不必要的 getter 会引发危险信号。（这里需要多少秒才能得到三个评论说“有人使用 Java 太多了”的变体？）

如果您阅读 PEP 8 样式指南，在[Designing for继承](http://www.python.org/dev/peps/pep-0008/#designing-for-inheritance)下，它说：

> 对于简单的公共数据属性，最好只公开属性名称，而不需要复杂的访问器/修改器方法。请记住，如果您发现简单的数据属性需要增加功能行为，Python 提供了一条通往未来增强的简单途径。在这种情况下，使用属性将功能实现隐藏在简单的数据属性访问语法后面。

PEP 8 仅用作标准库的样式指南，但它仍然被普遍认为是对 Python 惯用的外观的良好描述（“TOOWTDI”意味着任何描述性指南都隐含地是规范性指南，至少在理论上），并且有不错的测试人员和修复程序，可让您根据 PEP 8 指南测试自己的代码。

* * *

当我在这里时，William 的答案与[为什么使用 getters 和 setters](https://stackoverflow.com/questions/1568091/why-use-getters-and-setters)相关联，这是一个与语言无关的问题，其中接受的答案是访问器有时是个好主意的原因列表。它们几乎都与 Python 无关。大多数可以用一个词来回答：（`@property`或者，在最后一种情况下，`attrgetter`）。对于其余的：

*   控制生命周期和内存管理…… *Python 已经管理了内存。*
*   提供调试截取点...*解释型语言可以在调试时轻松放置观察点。*
*   改进了与库的互操作性…… *Python 的`mock`、`pickle`等旨在使用属性进行操作。*
*   允许继承者更改属性行为方式的语义，并通过覆盖 getter/setter 方法来公开。*这仅与具有静态类型的语言相关，但虚函数除外，例如 C++ 或 Java。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T21:31:53.710

您不需要使用“get”方法，您的示例中唯一的区别是，如果您使用`new.a`，您可以为其分配一个新值。

因此，如果您打算拥有一个只读属性，那么 get 方法是合适的。（请注意，如果该方法返回一个可变对象，您可以修改该对象，因此在技术上不是只读的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T21:52:40.520

通常在 Python 中，我们只使用普通的属性访问。如果您决定稍后需要“getters”和“setters”，您可以轻松地将它们转换为[properties](http://docs.python.org/2/library/functions.html#property)。你不需要“以防万一”把你的代码弄得乱七八糟

对我来说重要的一点是，当你这样做时，你[不需要更改任何*使用*该类的](https://stackoverflow.com/a/6618176/174728)代码。

# php - 在 PHP 数组中使用 Jquery 隐藏

> ID：15012572
> 
> 赞同：0
> 
> 时间：2013-02-21T21:28:10.713
> 
> 标签：php, javascript, jquery

我正在尝试使用一个函数在我的 php 数组中显示附加信息。我正在回显显示我的类信息的表，我无法让 Jquery 在 PHP 中工作。我在 Jquery 或 PHP 方面不是最有经验的，所以我一定是完全错误的。

编辑：我知道我的 PHP 查询不安全，我最终开始转换这些查询。这是我的代码

```
<link rel="stylesheet" type="text/css" href="css/bigcalendar.css">

<!DOCTYPE html>
<html>

<head>
    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />

    <title>Webbook | View Schedule</title>

    <link rel='stylesheet' type='text/css' href='css/style.css' />

    <!--[if IE]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
    <script type='text/javascript' src='js/jquery.ba-hashchange.min.js'></script>
    <script type='text/javascript' src='js/dynamicpage.js'></script>
    <script>
$(document).ready(function(){
  $("button").click(function(){
    $("#hidetest").toggle(1000);
  });
});
</script>
</head>

<body>

    <div id="page-wrap">

        <header>
                 <?php include "navbar.php";?>

        </header>

        <section id="main-content">
        <div id="guts">

          <h2>View Schedule</h2>

<?php
//get database settings
include("dbinfo.php");

?>

<div align="center">
<?php
$sqlschedule = mysql_query("SELECT * FROM schedule WHERE student='Austin' ORDER BY `hour`  ASC");
$num_rows = mysql_num_rows($sqlschedule);
//Table starting tag and header cells
while($row = mysql_fetch_array($sqlschedule)){
   //Display the results in different cells
   $hour = $row['hour'];
   $class = $row['class'];
   $teacher = $row['teacher'];
   $classid = $row['classid'];

$sqlclassid = mysql_query("SELECT * FROM classes WHERE classid=$classid");
while($row2 = mysql_fetch_array($sqlclassid)){
$hour2 = $row2['hour'];
$class2 = $row2['class'];
$teacher2 = $row2['teacher'];
}
if($class == ""){
$class = $class2;
}
if($teacher == ""){
$teacher = $teacher2;
}

$sqlhourinfo = mysql_query("SELECT * FROM hours WHERE hour='$hour'");
while($row3 = mysql_fetch_array($sqlhourinfo)){
$starttime = strftime("%l:%M %P", strtotime($row3['starttime']));
$endtime = strftime("%l:%M %P", strtotime($row3['endtime']));
}
/*
$from = mysql_query("SELECT * from members WHERE username='$fromuser'");
$num_rows = mysql_num_rows($from);
//Table starting tag and header cells
while($row = mysql_fetch_array($from)){
   //Display the results in different cells
   $otherid = $row['id'];
   $theusername = $row['username'];
}
*/

echo '<p>This is a paragraph with little content.</p>
<p style="display:none" id="hidetest">This is another small paragraph.</p>
<button>Toggle</button>
';
   echo '     
<table id="background-image" width="50%" border="0" cellspacing="5" cellpadding="10">
  <tr>
    <th width="10%" rowspan="2" class="scheduleform" scope="col">'.$hour.'</th>
    <td align="left" scope="col">'.$class.'</td>
  </tr>
  <tr>
    <td align="left">'.$teacher.'</td>
  </tr>
  <tr>
    <td colspan="2"><p>Starts: '.$starttime.'<br>
      Ends: '.$endtime.'
    </p></td>
    </tr>
<tr>
<td>
<a href="#" id="opener">
<img border="0" src="/webbook/images/256.png" alt="Add Assignment" width="32" height="32"></a>
</td>
<td>
<a href="#">
<img border="0" src="/webbook/images/256 (1).png" alt="Edit Assignment" width="32" height="32"></a>
</td>

</tr>
</table>

      </p>

';

}

?>

      </div>

</div>
</div>

        </div>
        </section>

    </div>

    <footer>
      &copy;2013 iHeff Webbook
    </footer>
    <?php   /* 
include('../footer.php'); 
*/ ?>
</body>

</html> 
```

所以我想要实现的是有一个带有“添加分配”的图像的链接。我希望能够单击它，然后显示一个隐藏的表单，您可以切换它。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:34:49.290

您的链接的 id 是“opener”，但您正在使用`('button').click(`...等。

改为使用`$('#opener').click`。这应该将点击功能与链接联系起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:37:17.447

您可以简单地设置`display:none`到您的表单容器并注册一个点击监听器并使用 jquery .show() 来弹出表单。这是一个例子：

```
<a href="#" id="addassgn">Add Assignment</a>
<div id="assgnform" style="display:none">
    <h1>Assignment Form</h1>
    Name: <input type="text"/><br/>
    Class: <input type="text"/><br/>
    File: <input type="text"/><br/>
    <input type="submit"/>
</div>

$('#addassgn').click(function() {
    $('#assgnform').show();
}); 
```

[http://jsfiddle.net/vZreC/](http://jsfiddle.net/vZreC/)

# javascript - 修改 prettyDate() 以使用具有另一种日期时间格式的字符串

> ID：15012578
> 
> 赞同：0
> 
> 时间：2013-02-21T21:28:53.140
> 
> 标签：javascript, jquery

我正在使用 John Resig prettyDate 函数，以使其与具有这种格式的字符串一起工作：

`'2013-01-04 20:02:28'`

但到目前为止我还没有成功......这个函数只适用于 iso datetimes..

```
function prettyDate(time){
    var date = new Date((time || "").replace(/-/g,"/").replace(/[TZ]/g," ")),
        diff = (((new Date()).getTime() - date.getTime()) / 1000),
        day_diff = Math.floor(diff / 86400);

    if ( isNaN(day_diff) || day_diff < 0 || day_diff >= 31 )
        return;

    return day_diff == 0 && (
            diff < 60 && "just now" ||
            diff < 120 && "1 minute ago" ||
            diff < 3600 && Math.floor( diff / 60 ) + " minutes ago" ||
            diff < 7200 && "1 hour ago" ||
            diff < 86400 && Math.floor( diff / 3600 ) + " hours ago") ||
        day_diff == 1 && "Yesterday" ||
        day_diff < 7 && day_diff + " days ago" ||
        day_diff < 31 && Math.ceil( day_diff / 7 ) + " weeks ago";
} 
```

默认情况下，我的字符串的结果是：

```
>prettyDate('2013-01-04 20:02:28')
>undefined 
```

拜托，有人可以帮我修改它以适应我的格式吗？谢谢。

PD：[http ://ejohn.org/blog/javascript-pretty-date/](http://ejohn.org/blog/javascript-pretty-date/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:42:50.067

不是格式不起作用，而是函数`return`s when `day_diff >= 31`。截至目前`day_diff`，当函数运行时将是 47。

`day_diff`从条件中去掉对勾，在大于31时处理的返回部分添加条件：

```
function prettyDate(time){
    var date = new Date((time || "").replace(/-/g,"/").replace(/[TZ]/g," ")),
        diff = (((new Date()).getTime() - date.getTime()) / 1000),
        day_diff = Math.floor(diff / 86400);

    if ( isNaN(day_diff) || day_diff < 0 )
        return;

    return day_diff == 0 && (
            diff < 60 && "just now" ||
            diff < 120 && "1 minute ago" ||
            diff < 3600 && Math.floor( diff / 60 ) + " minutes ago" ||
            diff < 7200 && "1 hour ago" ||
            diff < 86400 && Math.floor( diff / 3600 ) + " hours ago") ||
        day_diff == 1 && "Yesterday" ||
        day_diff < 7 && day_diff + " days ago" ||
        day_diff < 31 && Math.ceil( day_diff / 7 ) + " weeks ago" ||
        day_diff + " days ago";
} 
```

# jetty - 使用 jruby 的码头嵌入式应用程序

> ID：15012586
> 
> 赞同：0
> 
> 时间：2013-02-21T21:29:23.630
> 
> 标签：jetty, jruby

我正在尝试按照 Eclipse wiki 上的教程创建我的第一个 Jetty 嵌入式模式应用程序。我想在 JRuby 而不是 Java 中做到这一点。

这是Java代码：

```
public class ManyConnectors
{
public static void main(String[] args) throws Exception
{
    Server server = new Server();

    SelectChannelConnector connector0 = new SelectChannelConnector();
    connector0.setPort(8080);
    connector0.setMaxIdleTime(30000);
    connector0.setRequestHeaderSize(8192);

    SelectChannelConnector connector1 = new SelectChannelConnector();
    connector1.setHost("127.0.0.1");
    connector1.setPort(8888);
    connector1.setThreadPool(new QueuedThreadPool(20));
    connector1.setName("admin");

    SslSelectChannelConnector ssl_connector = new SslSelectChannelConnector();
    String jetty_home = 
      System.getProperty("jetty.home","../jetty-distribution/target/distribution");
    System.setProperty("jetty.home",jetty_home);
    ssl_connector.setPort(8443);
    SslContextFactory cf = ssl_connector.getSslContextFactory();
    cf.setKeyStore(jetty_home + "/etc/keystore");
    cf.setKeyStorePassword("OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4");
    cf.setKeyManagerPassword("OBF:1u2u1wml1z7s1z7a1wnl1u2g");

    server.setConnectors(new Connector[]{ connector0, connector1, ssl_connector });

    server.setHandler(new HelloHandler());

    server.start();
    server.join();
}
} 
```

我在将这一行转换为等效的 JRuby 时遇到问题：

```
server.setConnectors(new Connector[]{ connector0, connector1, ssl_connector }); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T06:12:55.737

尝试使用普通的旧数组：

```
server.set_connectors([connector0, connector1, ssl_connector ]) 
```

编辑 - 这是一个工作示例：

```
require 'pp'
require 'java'
require 'jetty-6.1.3.jar'  # in local dir
require 'jetty-util-6.1.3.jar' # in local dir
require 'servlet-api-2.5-6.1.3.jar' # in local dir

class MyHandler
  include org.mortbay.jetty.Handler
  def destroy;end
  def start;end
  def getServer;end
  def handle(target, request, response, dispatch)
    pp target
    pp request
  end
  def setServer(server);end
end
server = Java::OrgMortbayJetty::Server.new

connector0 = org.mortbay.jetty.nio.SelectChannelConnector.new
connector0.set_port(8080)
connector0.set_max_idle_time(30000)
# connector0.set_request_header_size(8192)  # could not find this method

server.set_connectors([connector0])
server.set_handlers([MyHandler.new])
server.start
server.join 
```

# constructor - UML 序列图中的构造函数

> ID：15012587
> 
> 赞同：4
> 
> 时间：2013-02-21T21:29:27.497
> 
> 标签：constructor, uml, sequence-diagram

下面的序列图和构造函数（表示为创建对象）的含义是什么？

![在此处输入图像描述](../Images/0fda940947d00a5fcc932ecab4495d0b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T13:13:40.850

消息名称“Class B()”是错误的：它应该是“create”。
这让你感到困惑吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T21:31:26.907

这意味着`ClassA`实例化`ClassB`. 箭头表示的构造函数`ClassB`被调用`ClassA`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-29T14:26:49.070

克里斯，希望你现在已经明白了。请接受 Cratylus 的回答，因为它是正确的。

这是Java中的示例：

**主.java**

```
package com.example.umlquestion;

// (e.g. your application that makes and uses an instance of ClassA)
public class Main {
    public Main() {
        // this calls ClassA's constructor, which will then call ClassB's constructor
        private ClassA instanceA = new ClassA(); 
        // ...
    }
} 
```

**ClassA.java**

```
package com.example.umlquestion;

public class ClassA  {
    private ClassB instanceB;
    public ClassA() {
        instanceB = new ClassB();
        // ...
    }
    // ...
} 
```

**ClassB.java**

```
package com.example.umlquestion;

public class ClassB  {
    public ClassB() {
        // ...
    }
    // ...
} 
```

# c# - 显示来自数据库的数据

> ID：15012596
> 
> 赞同：1
> 
> 时间：2013-02-21T21:30:27.773
> 
> 标签：c#, asp.net, webforms

我有一个数据库，目前有生成非常基本的论坛（论坛、帖子、主题和用户）所需的表

我现在的问题是显示此信息。我查看了 Visual Studio ( ) 中的内置功能，`GridView`但它们不适合论坛（外观）。所以我希望能够设计自己的外观和感觉，但我遇到了障碍。我不知道如何实现我想要的网站外观。

这是我到目前为止在我的`C#`文件中所做的代码。它基本上将 ForumName 添加到 Label1。

```
cmd.CommandText = "SELECT * FROM forum";
cmd.CommandType = CommandType.Text;
cmd.Connection = sqlConnection1;

sqlConnection1.Open();

reader = cmd.ExecuteReader();
// Data is accessible through the DataReader object here.
while (reader.Read())
 {

  Label1.Text+=reader.GetString(1);
 }

sqlConnection1.Close(); 
```

对于初学者，我只想生成一些简单的东西。像这样：http: [//i45.tinypic.com/1zd55og.jpg](http://i45.tinypic.com/1zd55og.jpg)

一个列表，其大小增加等于在表中找到的论坛名称的数量。最好我希望这些 ForumNames 是超链接。

如果有人可以在正确的方向上轻推我，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:45:37.017

对于简单且完全可控的事情，这`Repeater`通常是一个不错的选择。它是您可以拥有的最灵活的控件，用于迭代某种集合并相应地呈现项目。它不会向浏览器生成任何输出，因为它允许您指定正在构建的特定列表的每个部分。

```
<asp:Repeater ID="rptDummy" runat="server">
    <HeaderTemplate>
        <%--Forum Header here--%>
    </HeaderTemplate>
    <ItemTemplate>
        <%--Forum Item here--%>
    </ItemTemplate>
    <FooterTemplate>
        <%--Forum Footer here--%>
    </FooterTemplate>
</asp:Repeater> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T22:34:50.980

您可以使用[GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)、[Repeater](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.aspx)和[Listview](http://msdn.microsoft.com/en-us/library/system.windows.controls.listview.aspx)。
如果您喜欢自定义布局，例如`forums`and `blogs`，`repeater`并且`listview`可能是最佳选择。
请参阅this以区分它们。

[Repeater、ListView、DataList、DataGrid、GridView……选哪个？](https://stackoverflow.com/questions/139207/repeater-listview-datalist-datagrid-gridview-which-to-choose)

另请参阅[比较 ListView 与 GridView、DataList 和 Repeater](http://weblogs.asp.net/anasghanem/archive/2008/09/06/comparing-listview-with-gridview-datalist-and-repeater.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:36:10.590

对于这样简单的事情， A`GridView`可能是您想要的。您可以通过 CSS、嵌套 HTML 等更改 gridview 的外观。

用于`<asp:TemplateField ...`提供您自己的自定义布局。

# html - Html NewsLetter中图像的绝对定位

> ID：15012597
> 
> 赞同：1
> 
> 时间：2013-02-21T21:30:30.343
> 
> 标签：html, css, absolute, newsletter

我的 html 新闻信函有一个主图像，我试图在某些位置的主图像顶部放置 5 个图像（图像按钮）。如果我将它们放在绝对位置，它在 Web 浏览器中显示时会呈现良好，只要我将 html 页面嵌入到电子邮件（outlook）中，图像就会被扔到一边。

当涉及到 html News Letters 时，最好的方法是什么？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:24:09.190

@user1475479 您可以使用[VML](http://emailbg.net/)创建背景图像，然后使用标准表格布局将图像按钮放在顶部，如下例所示。

另一种选择是使用一个大图像并使用[图像映射](http://www.w3schools.com/tags/tag_map.asp)，但这在电子邮件中是不好的做法，因为许多订阅者不打开图像，在这种情况下，您的电子邮件将是空白的，他们不会看到您的按钮。

最好和最常见的解决方案是将大图像分解成较小的图像，然后将其放在桌子上。这样，您可以为每个图像分配一个 alt 标签，因此如果订阅者不加载图像，它仍然保持其结构，人们仍然知道什么是什么以及在哪里点击。注意 - 添加 display:block; 非常重要；任何时候只要它们单独在表格单元格中，就可以添加到您的图像中。

@lukeocom - 您的示例存在一些问题，我没有编辑您的回复，而是在下面重建了它。您的图像都需要拥有`style="display:block;"`，并且以像素为单位设置宽度和高度可能会更好。此外，您需要将所有颜色声明为 6 位十六进制代码，并且在 html 声明中您不需要包含 px（仅在 css 中需要）。

```
<table width="600" border="0" cellpadding="0" cellspacing="0" bgcolor="#959595">
<tr>
    <td colspan="3" width="600" bgcolor="#757575">
        <a href=""><img src="yourHeader.png" alt="Header" style="margin: 0; border: 0; padding: 0; display: block;" height="100"  width="600"></a>
    </td>
</tr>
<tr>
    <td width="50" style="vertical-align: top;background-color:#555555;">
        <a href=""><img src="sideBars.png" style="margin: 0; border: 0; padding: 0; display: block;" alt="" height="200" width="50"></a>
    </td>
    <td width="500" valign="top" style="padding:20px;">
      <font style="font-family: Century Gothic, Avant Garde, sans-serif; font-size: 14px; color: #000000;">
        PUT YOUR CONTENT HERE
      </font>
    </td>
    <td width="50" style="vertical-align: top;background-color:#555555;">
        <a href=""><img src="sideBars.png" style="margin: 0; border: 0; padding: 0; display: block;" alt="" height="200" width="50"></a>
    </td>
</tr>
<tr>
    <td colspan="3">
        <a href=""><img src="yourFooter.png" alt="Footer" style="margin: 0; border: 0; padding: 0; display: block;" height="100" width="600"></a>
    </td>
</tr> 
```

如果你想让整个东西居中浮动，把它包起来：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title></title>
  <style type="text/css">           
    /* Client-specific Styles */
    #outlook a {padding:0;}
    body{width:100% !important; -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%; margin:0; padding:0;} /* force default font sizes */
    .ExternalClass {width:100%;} .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {line-height: 100%;} /* Hotmail */
    #backgroundTable {margin:0; padding:0; width:100% !important; line-height: 100% !important;}
    table td {border-collapse: collapse;}
  </style>
</head>
<body style="margin: 0px; padding: 0px; background-color: #FFFFFF;" bgcolor="#FFFFFF"><table bgcolor="#252525" width="100%" border="0" align="center" cellpadding="0" cellspacing="0"><tr><td><table width="600" border="0" align="center" cellpadding="0" cellspacing="0"><tr><td valign="top" style="padding:30px;">

PUT THE ABOVE TABLE IN HERE

</td></tr></table></td></tr></table></body></html> 
```

我使用 html strict 而不是 xhtml，但工作原理相同减去自关闭 img 标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T01:08:47.853

过去一周我刚刚在一封电子邮件上度过了，真是太痛苦了！我发现 html 电子邮件的最佳方法是使用表格布局。有很多标签不适用于电子邮件。每个电子邮件客户端都有很多不同的呈现方式。Outlook是我最讨厌的！

如果您使用的图像上没有任何链接，则使用 Photoshop 创建页眉和页脚横幅，然后使用您的表格布局显示它们。也使用内联样式，因为有时不支持 id 或类名。最好是安全...

按行排列的示例表格布局为：

```
|header image|
|side bar image(optional) | content (can use another table here) | side bar image|(optional)
|footer image| 
```

这是一个温度..

```
<table style="font-size:10pt;background-color: #fff; width:600px;max-width:600px;overflow:hidden; margin: 0px auto; padding: 0px;border-collapse:collapse;border:0;">
    <tr>
        <td colspan="3" width="600px">
            <img src="yourHeader.png" alt="" style="vertical-align:bottom;" height="100%"
            width="100%" />
        </td>
    </tr>
    <tr>
        <td width="50px" style="vertical-align: top;background-color:#fff;">
            <img src="sideBars.png" alt="" height="100%" width="100%" />
        </td>
        <td width="500px" style="background-color:#fff;padding-left:20px;padding-right:20px;">PUT YOUR CONTENT HERE</td>
        <td width="50px" style="vertical-align: top;background-color:#333399;">
            <img src="sideBars.png" alt="right image" height="100%" width="100%" />
        </td>
    </tr>
    <tr>
        <td colspan="3">
            <img src="yourFooter.png" alt="Bottom banner image" style="vertical-align:top;"
            height="100%" width="100%" />
        </td>
    </tr>
</table> 
```

一些进一步的阅读...

Outlook CSS 和标签支持 - [http://msdn.microsoft.com/en-us/library/aa338201.aspx](http://msdn.microsoft.com/en-us/library/aa338201.aspx)

一般 html 电子邮件提示 - [http://www.verticalresponse.com/sites/www.verticalresponse.com/files/html_tips_for_email_guide.pdf](http://www.verticalresponse.com/sites/www.verticalresponse.com/files/html_tips_for_email_guide.pdf)

希望这可以帮助..

# css - 覆盖 CSS 的正确方法

> ID：15012598
> 
> 赞同：5
> 
> 时间：2013-02-21T21:30:30.913
> 
> 标签：css, twitter-bootstrap

我目前正在使用 Bootstrap，对于我的网站，我想覆盖它附带的某些默认设置。许多 Bootstrap 规则嵌套得非常深，因此通常优先于我可能定义的任何内容。

在我的覆盖 css 文件中，我有比拍打更好的选择吗

```
!important 
```

在每条规则上，还是现在每个人都是这样处理的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T22:15:49.633

FWIW, this works for me.

*   If you aren't already using LESS, take some time to figure it out, it will save you heaps of time and makes it easy to keep everything organised [http://lesscss.org](http://lesscss.org). You will be well rewarded ;)

*   Instead of editing the original Bootstrap LESS files and losing everything on the next Bootstrap update, create a new theme-css.less file and perhaps a theme.variables.less file and save them in the same directory as your Bootstrap LESS files

*   Edit bootstrap.less so that your new files are compiled correctly,

    ..

    // CSS Reset @import "reset.less";
    // Core variables and mixins

    @import "variables.less"; // Modify this for custom colors, font-sizes, etc
    @import "mixins.less";

    @import "theme-variables.less"; // <==== Your custom CSS variables

    // Grid system and page structure
    @import "scaffolding.less";
    @import "grid.less";
    @import "layouts.less";

    // Base CSS
    @import "type.less";
    @import "code.less";
    @import "forms.less";
    @import "tables.less";

    @import "theme-css.less"; // <==== Your custom CSS

    ..

*   Use the [Bootstrap customise page](http://twitter.github.com/bootstrap/customize.html#variables) to located the names of the variables that govern much of the the CSS which you may wish to customise. Change these as req'd and add to your theme.variables.less file

*   Use the LESS nested rules as per [http://lesscss.org/](http://lesscss.org/) . <== this is important. It hugely simplifies what would otherwise be complex CSS

If you are new to LESS I realise that this isn't a simple 5 minute fix, but once you get it setup and start using the nested rules your CSS will be beautifully simple and easy to maintain.

**UPDATE Jun 2015**
The above technique is a bit dated now. Still works but [Jake](https://stackoverflow.com/users/315105/jake) suggested a change which I like and it simplifies long-term maintenance.

Instead of editing the main bootstrap.less file:

*   create a new theme.less file

*   import bootrap.less and your custom changes, e.g.:

    @import "path-to/bootstrap.less;
    @import "path-to/custom.less;

*   compile theme.less

Doing it this way means there's less chance that your custom changes could be lost if you update your bootstrap.less file

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-21T21:32:49.167

`!important`是最后的手段，理想情况下不应该使用。如果你想覆盖 CSS，那么尊重 CSS 级联规则：更“具体”的规则总是胜过不太“具体”的规则。例如

```
<div id="someid">Howdy</div>

div { 
    color: red;
}

div#someid {
    color: blue;
} 
```

使文本变为蓝色，即使两者都指向同一个元素，因为 #someid 使第二条规则更加具体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T22:02:46.967

这就是 CSS 评分对选择器的作用。

内联样式胜过 CSS 中的所有内容。例如。`<p style="margin:0;">`将覆盖您的 CSS 文件中的所有内容。

ID计1000分：#sub-head、#page-wrapper类计100分Z：.sub-head、.page-wrapper 元素计10分：a、p、div、ul、li 伪选择器计1 : :hover, :first-child, :last-child

哪个选择器具有最高的样式点数将在页面上呈现。

!important 是另一张王牌，应该很少使用。例如，我喜欢用它来为特殊文本或边距着色。

这是一个很好的链接，可以更详细地解释它。它非常简单。

[关联](http://www.agileapproach.com/blog-entry/css-specificity-scoring)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-11T03:53:36.877

我对此的回答。我在引导样式表之后添加了一个自定义样式表，然后一切正常。

（具有自定义引导主题的 wordpress 站点） - 在这种情况下，在引导样式表之后将样式表排入队列后问题已修复

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-28T12:52:39.460

我认为最好的方法是基于html 文档头部的链接 css 文件***的顺序***。很好的解释在这里：[https ://bootstrapbay.com/blog/customize-bootstrap/](https://bootstrapbay.com/blog/customize-bootstrap/)

* * *

**其中有趣的部分**

我也在用 !important 写它的时候我一直在想这是什么奇怪的方式：D

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-07T18:14:51.873

您应该做的最简单也是第一件事是检查 html 文件头部中样式表链接的顺序。

首先链接到引导 CSS，然后在下一行链接到您的 style.css（或类似）文件。

如果您颠倒了这个顺序，您可能无法覆盖某些样式元素。

# java - 从 DAO 中的 create 方法返回对象

> ID：15012599
> 
> 赞同：1
> 
> 时间：2013-02-21T21:30:31.177
> 
> 标签：java

我有以下情况。我想将设置创建日期的责任委托给 DAO 对象。

```
 Class Product{
     //other fields
     Date creationDate;
    }

    Class ProductDAO{
      private GenericDAO dao;
      public void create(Product p){
         p.setCreationDate(new Date());
         dao.create(p);
      }
    }

    Class Main{
      private ProductDAO productDAO; 
      public void createProduct(){
         Product p = new Product();
         productDAO.create(p);
         LOG.debug(p.getCreationDate());
      } 
    } 
```

1.  现在的问题是，当我通过模拟 productDAO 测试主类的 createProduct 方法时，如何定义模拟对象“productDAO”的行为，以便它设置创建日期并且日志语句不会抛出 NullPointerException？
2.  上述方法似乎正确吗？我应该从 ProductDAO 类的 create 方法返回更新的 Product 对象而不是依赖副作用吗？

    ```
     Product create(Product p){
           p.setCreationDate(new Date());
           dao.create(p);
           return p;
      } 
    ```

3.  或者在主类中，我应该在创建后从数据库中读取对象，而不是依赖于返回对象或 createProduct 方法的副作用？在这种情况下，唯一的事情是它会增加额外调用的开销。

    ```
     public void createProduct(){
         Product p = new Product();
         productDAO.create(p);
         p = productDAO.read(p.getId());
         LOG.debug(p.getCreationDate());
      } 
    ```

对不起，很长的问题。我希望我能够解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:45:04.357

测试日期是否已设置的一种方法是使用[argThat](http://mockito.googlecode.com/svn/branches/1.5/javadoc/org/mockito/Matchers.html#argThat%28org.hamcrest.Matcher%29)。你需要做类似的事情

```
@Test
public void shouldSetCreationDateAtProductWhenCreatingIt() {
     // given
     Product product = mock(Product.class);

     // when
     dao.create(product);

     // then
     verify(product).setCreationDate(argThat(is(not(nullValue(Date.class)))));
} 
```

所以，我只做了一个简单的验证，`Product#setCreationDate(Date)`它使用非空值调用`Date`。您可以创建自定义匹配器以查看`Date`对象是否是您期望的对象。这是只测试类`ProductDao`。

如果您想以`Main`需要模拟 getCreationDate 的返回的方式进行单元测试，您可以向您的 中添加一个返回`ProductDao#create`，使其返回持久对象。

```
 public class ProductDao {
     public Product create(Product p){
        p.setCreationDate(new Date());
        dao.create(p);
        return p;
     }
 } 
```

然后你可以在你的 Main 类中模拟 productDao 的返回

```
 @Test
  public void shouldUseReturnedProductFromDaoToLog() {
       // given
       Product product = mock(Product.class);
       Date creationDate = new Date();

       given(product.getCreationDate()).willReturn(creationDate);
       given(dao.create(any(Product.class)).willReturn(product);

       // when      
       Product createdProduct = main.createProduct();

       // then
       assertThat(createdProduct, is(equalTo(product)));
  } 
```

我在 createProduct 中添加了一个返回，因为我想测试它是否与 DAO 返回的相同。然后，我们将单元测试从（创建产品并将其持久化到 Dao）中分离出来，看看是否`ProductDao`符合预期（设置创建日期）`Main`

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:39:48.657

1.  I think a perfectly valid approach would be to make an instance of Product which has a creationDate "set" and have your mockProductDao return that.

    ```
    Date timeStamp = new Date();
    Product productWithCreationDate = new Product();
    productWithCreationDate.setCreationDate(timeStamp);
    when(mockProductDao.create(anyObject()).thenReturn(productWithCreationDate); 
    ```

2.  I don't think you need to return p from your ProductDAO, since any place you call productDAO.create(p), then you have access to `p` (with creationDate) on the very next line - right?

3.  You only need to read `p` back from the DAO if you don't trust the DAO layer :) So, given that you are confident the DAO layer will throw the correct exception if `create()` method fails, I don't think you need to re-read `p` again.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:42:26.893

为什么需要`Date`通过 setter 分配创建？只需分配`Date`in 构造函数：

```
Product p = new Product();  //here you set creation date
productDAO.create(p); 
```

# javascript - 访问表单的最后一个输入元素

> ID：15012613
> 
> 赞同：2
> 
> 时间：2013-02-21T21:31:33.753
> 
> 标签：javascript, dom

在 HTML 文档中，我有一个表单，并且表单中有几个输入元素（不是固定编号）。我想得到最后一个输入元素。

我试过：

```
imputs=document.getElementsByTagName('input');
lastIndex=imputs.length;
imputs[lastIndex] - here I get undefined 
```

我不明白为什么以下代码有效而前一个无效：

```
lastIndex=10;
imputs[lastIndex] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:33:49.590

```
imputs = document.getElementsByTagName('input');
lastIndex = imputs.length;
imputs[lastIndex - 1] 
```

数组*（[upd.] 和 NodeList 等）*在 JavaScript 中是 0。

另外：*i* *n* *puts*。;)

* * *

另一种方法是[document.querySelector('...')](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelector)和[":last-of-type"](https://developer.mozilla.org/en-US/docs/CSS/%3alast-of-type)：

```
document.querySelector('input:last-of-type').value = '42'; 
```

[http://jsfiddle.net/zUVg5/](http://jsfiddle.net/zUVg5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:34:35.627

该`getElementsByTagName()`函数返回一个`NodeList`包含所有具有指定标签名称的元素。通过指定索引，可以使用方括号表示法访问这些元素。

但是，列表中的元素索引从 0 到 N，其中 N 比列表的长度小一。为了获得最后一个元素，您实际上想要`imputs[imputs.length - 1];`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:34:21.973

数组是从零开始的。长度会给你一个未定义的项目，因为它在数组的末尾。你应该使用

```
imputs[lastIndex - 1] 
```

# xml - 使用 XSL 按 RFC-822 日期格式对 XML 进行排序

> ID：15012616
> 
> 赞同：3
> 
> 时间：2013-02-21T21:31:40.263
> 
> 标签：xml, xslt, rfc822

有谁知道在 XSL 中进行这种排序的方法？

这是我到目前为止所拥有的，但它只按天排序，而忽略了日期的其余部分。

```
 <xsl:apply-templates select="item">
          <xsl:sort select="pubDate" data-type="text" order="descending"/>
      </xsl:apply-templates> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T17:08:00.163

感谢你们的快速回复。让我朝着正确的方向前进。设法解决它！找到了一个有用的链接[http://blog.mastykarz.nl/how-to-do-it-rss-aggregation-merging-multiple-xml-files-using-xslt/](http://blog.mastykarz.nl/how-to-do-it-rss-aggregation-merging-multiple-xml-files-using-xslt/)

我使用的是 XSLT 2.0 版。只是一个使用变量替换 MMM 月份并将日期细分的案例。

解决方案

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>
<xsl:variable name="Months" select="'Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec'"/>

<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
</xsl:template>

<xsl:template match="channel">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()[not(preceding-sibling::item) and not(self::item)]"/>
        <xsl:apply-templates select="item">
            <!-- year -->
        <xsl:sort select="substring(pubDate, 13, 4)" order="descending" data-type="number"/>
        <!-- month -->
        <xsl:sort select="string-length(substring-before($Months, substring(pubDate, 9, 3)))" order="descending" data-type="number"/>
        <!-- day -->
        <xsl:sort select="substring(pubDate, 6, 2)" order="descending" data-type="number"/>
        <!-- hour -->
        <xsl:sort select="substring(pubDate, 18, 2)" order="descending" data-type="number"/>

        </xsl:apply-templates>
        <xsl:apply-templates select="@*|node()[not(following-sibling::item) and not(self::item)]"/>
</xsl:copy>
</xsl:template> 
```

# android - 没有可用的联系人图像时显示图像

> ID：15012619
> 
> 赞同：2
> 
> 时间：2013-02-21T21:31:47.477
> 
> 标签：android, contact

我编写了一个应用程序，它只是向我显示手机上所有可用的联系人。该应用程序运行良好。它可以检索联系人图像和显示名称。但是，在滚动列表时，应用程序有些滞后。我想知道如何消除这种滞后。同时，我想在没有可用的联系人图像时显示图像。我试图创建一个布尔标志，告诉我联系人图像光标是否为空，如果是，那么我将标志 (image_found) 设置为 false，然后尝试使用 setImageResource 设置图像，但它不起作用。好吧，然后我认为当没有图像时，blob 对象可能会得到一个空值，但它也很有效。这是我的 mail_activity 代码。

```
package legacy_systems.aggregatedcontactlist;

import java.util.ArrayList;
import java.util.List;

import android.os.Bundle;
import android.provider.ContactsContract;
import android.support.v4.widget.CursorAdapter;
import android.support.v4.widget.SimpleCursorAdapter;
import android.app.ListActivity;
import android.content.Intent;
import android.database.Cursor;
import android.view.Menu;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.Toast;

public class MainActivity extends ListActivity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Cursor c = getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, 
                                              null, 
                                              null, 
                                              null, 
                                              ContactsContract.Contacts.DISPLAY_NAME+" ASC");

        ArrayList<String> con_ids = new ArrayList<String>();
        if(c!=null)
        {
            for(c.moveToFirst();!c.isAfterLast();c.moveToNext()){
                con_ids.add(c.getString(c.getColumnIndex(ContactsContract.Contacts._ID)));
            }
        }

        ListView ls = getListView();

        MyAdapter ada = new MyAdapter(this, R.layout.listview, con_ids);

        ls.setAdapter(ada);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

这是 MyAdapter 的代码

```
package legacy_systems.aggregatedcontactlist;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

import android.content.ContentUris;
import android.content.Context;
import android.content.pm.PackageManager.NameNotFoundException;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.net.Uri;
import android.provider.ContactsContract;
import android.provider.ContactsContract.Contacts;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

public class MyAdapter extends ArrayAdapter<String>{
    Context cont;
    boolean image_found = true;
    ArrayList<String> ids;

    public MyAdapter(Context context, int resource,
            ArrayList<String> objects) {
        super(context, resource, objects);
        cont = context;
        ids = objects;
        // TODO Auto-generated constructor stub
    }

    public View getView(int position, View ConvertView, ViewGroup parent){
        //For Contact Photo
        Bitmap photo=null;
        //Inflator Work
        LayoutInflater infl = (LayoutInflater)cont.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View row = infl.inflate(R.layout.list_view, parent, false);

        //Retreiving photo and Setting Photo
        photo = BitmapFactory.decodeStream(retrievePhoto(ids.get(position)));
        ImageView iv = (ImageView)row.findViewById(R.id.listicon);
        iv.setImageBitmap(photo);

        if(!image_found)
        {
            iv.setImageResource(R.drawable.person);
        }

        //Retrieving ContactName
        TextView tv  =(TextView)row.findViewById(R.id.listtext);
        tv.setText(retrieveName(ids.get(position)));

        return row;
    }

    private InputStream retrievePhoto(String Id)
    {
        Uri ContactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, Long.valueOf(Id));
        Uri PhotoUri = Uri.withAppendedPath(ContactUri, Contacts.Photo.CONTENT_DIRECTORY);

        Cursor c = cont.getContentResolver().query(PhotoUri, new String[]{Contacts.Photo.PHOTO}, null,null,null);

        try
        {
            if(c.moveToFirst())
            {
                byte[] data = c.getBlob(0);
                if(data!=null)
                {
                    return new ByteArrayInputStream(data);
                }
                else
                {
                    image_found = false;
                }
            }
        }
        finally
        {
            c.close();
        }
        return null;
    }

    private String retrieveName(String Id)
    {
        Uri ContactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, Long.valueOf(Id));
        Cursor c = cont.getContentResolver()
                        .query(ContactUri, 
                                new String[]{ContactsContract.Contacts.DISPLAY_NAME}, 
                                null, 
                                null, 
                                null);
        if(c==null)
            return null;
        try
        {
            if(c.moveToFirst())
            {
                String name = c.getString(0);
                return name;
            }
        }
        finally
        {
            c.close();
        }
        return null;
    }

} 
```

我真的很高兴我能走到这一步。请帮助我继续我的冒险。

[编辑] 我已经实施了建议的事情，现在我无法检索单个联系人图像。我不知道问题是什么。我只在 MyAdapter.java 中进行了更改，并且我正在发布它的代码。

```
package legacy_systems.aggregatedcontactlist;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.List;

import android.content.ContentUris;
import android.content.Context;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.res.Resources;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.net.Uri;
import android.os.AsyncTask;
import android.provider.ContactsContract;
import android.provider.ContactsContract.Contacts;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

public class MyAdapter extends ArrayAdapter<String>{
    Context cont;
    boolean image_found = true;
    ArrayList<String> ids;

    public MyAdapter(Context context, int resource,
            ArrayList<String> objects) {
        super(context, resource, objects);
        cont = context;
        ids = objects;
        // TODO Auto-generated constructor stub
    }

    public View getView(int position, View ConvertView, ViewGroup parent){

        View row = ConvertView;
        //For Contact Photo
        Bitmap photo=null;
        //Inflator Work
        if(row==null)
        {
            LayoutInflater infl = (LayoutInflater)cont.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            row = infl.inflate(R.layout.list_view, parent, false);
        }

        //Retreiving photo and Setting Photo
        ImageView iv = (ImageView)row.findViewById(R.id.listicon);

        synchronized (iv) {
            Uri contactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, Long.valueOf(ids.get(position)));
            PhotoLoader loader = new PhotoLoader(iv, contactUri);
            loader.execute();

        }

        //Retrieving ContactName
        TextView tv  =(TextView)row.findViewById(R.id.listtext);
        tv.setText(retrieveName(ids.get(position)));

        return row;
    }

    private String retrieveName(String Id)
    {
        Uri ContactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, Long.valueOf(Id));
        Cursor c = cont.getContentResolver()
                        .query(ContactUri, 
                                new String[]{ContactsContract.Contacts.DISPLAY_NAME}, 
                                null, 
                                null, 
                                null);
        if(c==null)
            return null;
        try
        {
            if(c.moveToFirst())
            {
                String name = c.getString(0);
                return name;
            }
        }
        finally
        {
            c.close();
        }
        return null;
    }

    class PhotoLoader extends AsyncTask<Void, Void, Bitmap>
    {
        final WeakReference<ImageView> mView;
        final Uri mUri;

        public PhotoLoader(ImageView view, Uri uri) {

            if(view == null)
            {
                throw new IllegalArgumentException("View Cannot be null");
            }
            if(uri == null)
            {
                throw new IllegalArgumentException("Uri cant be null");
            }
            mView = new WeakReference<ImageView>(view);
            mUri = uri;
        }

        protected Bitmap doInBackground(Void...args){
            Bitmap bitmap;
            InputStream in = ContactsContract.Contacts.openContactPhotoInputStream(cont.getContentResolver(), mUri);
            bitmap = BitmapFactory.decodeStream(in);

            if(bitmap == null)
            {   Resources mResources = cont.getResources();
                bitmap = BitmapFactory.decodeResource(mResources, R.drawable.person);
            }
            return bitmap;
        }
    }

} 
```

我还没有实现缓存。当这个问题解决后，我会尝试实现缓存和Holder。在此之前，请解决问题，

[重新编辑] 这次。图像都乱了。

```
package legacy_systems.aggregatedcontactlist;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.List;

import android.content.ContentUris;
import android.content.Context;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.res.Resources;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.net.Uri;
import android.os.AsyncTask;
import android.provider.ContactsContract;
import android.provider.ContactsContract.Contacts;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

public class MyAdapter extends ArrayAdapter<String>{
    Context cont;
    boolean image_found = true;
    ArrayList<String> ids;
    ImageView iv;

    public MyAdapter(Context context, int resource,
            ArrayList<String> objects) {
        super(context, resource, objects);
        cont = context;
        ids = objects;
        // TODO Auto-generated constructor stub
    }

    public View getView(int position, View ConvertView, ViewGroup parent){

        View row = ConvertView;
        //For Contact Photo

        //Inflator Work

        if(row==null)
        {
            LayoutInflater infl = (LayoutInflater)cont.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            row = infl.inflate(R.layout.list_view, parent, false);
        }

        //Retreiving photo and Setting Photo
        iv = (ImageView)row.findViewById(R.id.listicon);

        synchronized (this) {
            Uri contactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, Long.valueOf(ids.get(position)));
            PhotoLoader loader = new PhotoLoader(iv, contactUri);
            loader.execute();

        }

        //Retrieving ContactName
        TextView tv  =(TextView)row.findViewById(R.id.listtext);
        tv.setText(retrieveName(ids.get(position)));

        return row;
    }

    private String retrieveName(String Id)
    {
        Uri ContactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, Long.valueOf(Id));
        Cursor c = cont.getContentResolver()
                        .query(ContactUri, 
                                new String[]{ContactsContract.Contacts.DISPLAY_NAME}, 
                                null, 
                                null, 
                                null);
        if(c==null)
            return null;
        try
        {
            if(c.moveToFirst())
            {
                String name = c.getString(0);
                return name;
            }
        }
        finally
        {
            c.close();
        }
        return null;
    }

    class PhotoLoader extends AsyncTask<Void, Void, Bitmap>
    {
        final WeakReference<ImageView> mView;
        final Uri mUri;

        public PhotoLoader(ImageView view, Uri uri) {

            if(view == null)
            {
                throw new IllegalArgumentException("View Cannot be null");
            }
            if(uri == null)
            {
                throw new IllegalArgumentException("Uri cant be null");
            }
            mView = new WeakReference<ImageView>(view);
            mUri = uri;
        }

        protected Bitmap doInBackground(Void...args){
            Bitmap bitmap;
            InputStream in = ContactsContract.Contacts.openContactPhotoInputStream(cont.getContentResolver(), mUri);
            bitmap = BitmapFactory.decodeStream(in);

            return bitmap;
        }

        protected void onPostExecute(Bitmap bitmap)
        {
            if(bitmap == null)
            {   Resources mResources = cont.getResources();
                bitmap = BitmapFactory.decodeResource(mResources, R.drawable.person);
                iv.setImageBitmap(bitmap);
                return;
            }
            iv.setImageBitmap(bitmap);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T19:39:19.453

我终于解决了我所有的问题。我突然想到，应用程序最好不要使用自定义适配器，因此，使用已经提供的适配器总是好的。我的情况是，我决定使用 SimpleCursorAdapter。为了解决在没有联系人图像时显示图像的问题，一个简单的需要定义一个预定义的图像作为布局文件中联系人图像位置的来源。如果联系人没有图像，则位图包含 null，因此，当联系人图像不存在时，技巧是不要更改图像。

这是我的 MyAdapter 代码，它简单地扩展了 SimpleCursorAdapter。

```
package com.example.contact;

import java.io.InputStream;
import java.util.ArrayList;

import android.content.ContentUris;
import android.content.Context;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.os.AsyncTask;
import android.provider.ContactsContract;
import android.provider.ContactsContract.Contacts;
import android.support.v4.util.LruCache;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.View;
import android.widget.ImageView;

public class MyAdapter extends SimpleCursorAdapter{

    private Cursor cursor;  
    private static int con_id_index;
    private static Drawable person;
    private Context context;
    private static LruCache<Long, Bitmap> cache;
    long con_id;
    private ArrayList<Long> id_list = new ArrayList<Long>();

    public MyAdapter(Context context, int layout, Cursor c, String[] from,
            int[] to, int flags) {
        super(context, layout, c, from, to, flags);
        this.cursor = c;        
        con_id_index = cursor.getColumnIndex(ContactsContract.Contacts._ID);
        person = context.getResources().getDrawable(R.drawable.person);
        this.context = context;

        final int maxMem = (int)Runtime.getRuntime().maxMemory()/1024;
        final int cacheSize = maxMem/8;

        cache = new LruCache<Long, Bitmap>(cacheSize);
        id_list.clear();
    }   

    @Override
    public void bindView(View view, Context context, Cursor cursor) {
        Object tag;
        // TODO Auto-generated method stub
        super.bindView(view, context, cursor);

        con_id = cursor.getLong(con_id_index);
        if(!id_list.contains(Long.valueOf(con_id)))
        {
            id_list.add(con_id);
        }
        Uri contactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, con_id);

        ImageView con_image = (ImageView) view.findViewById(R.id.contact_iamge);
        tag = con_id;
        con_image.setImageDrawable(person);
        con_image.setTag(tag);
        if(getBitmapFromCache(con_id)!=null)
        {
            con_image.setImageBitmap(getBitmapFromCache(con_id));
        }
        else
        {
            ImageLoader loader = new ImageLoader(con_image, contactUri, con_id);
            loader.execute();
        }

    }

    class ImageLoader extends AsyncTask<Void, Void, Bitmap>
    {
        private ImageView mView;
        private Uri mUri;       
        private Object tag;
        private long position;

        public ImageLoader(ImageView view, Uri uri, long position) {

            if(view == null)
            {
                throw new IllegalArgumentException("View Cannot be null");
            }
            if(uri == null)
            {
                throw new IllegalArgumentException("Uri cant be null");
            }
            mView = view;
            tag = mView.getTag();
            this.position = position;
            mUri = uri;         
        }

        protected Bitmap doInBackground(Void...args){
            Bitmap bitmap;

            //Load image from the Content Provider
            InputStream in = ContactsContract.Contacts.openContactPhotoInputStream(context.getContentResolver(), mUri);
            bitmap = BitmapFactory.decodeStream(in);

            return bitmap;
        }

        protected void onPostExecute(Bitmap bitmap)
        {
            //If is in somewhere else, do not temper
            if(!mView.getTag().equals(tag))
                return;
            //If no image was there and do not put it to cache
            if(bitmap!= null)
            {   

                mView.setImageBitmap(bitmap);
                addBitmapToCache(position, bitmap);
                return;
            }
            //Otherwise, welcome to cache           
            return;
        }
    }
    /**Add image to cache*/
    private void addBitmapToCache(Long key, Bitmap bitmap)
    {
        if(getBitmapFromCache(key)==null)
        {
            cache.put(key, bitmap);
        }
    }
    /**Retrive image from cache*/
    private Bitmap getBitmapFromCache(Long key)
    {
        return cache.get(key);
    }

    public ArrayList<Long> getIDList()
    {
        return id_list;
    }

} 
```

因为，加载的游标不包含图像，并且内容提供程序不允许我们一次查询多个表。因此，最好在后台线程中检索图像。那就是我使用 ASyncTask 的地方。

MyAdpter 不会覆盖 getView()，而是覆盖 bindView()，它允许向正在膨胀的视图添加/绑定附加信息。适配器利用内存缓存，并使用联系人 ID 作为键来检索和存储缓存中的图像。

希望它可以帮助别人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T22:08:52.657

除了 Gabe Sechan 所说的每次都夸大了视图之外，你应该改变一些事情。不要使用内容提供者来获取照片，而是使用`openContachPhotoInputStream`Contacts 类中的方法，您可以在[此处](http://developer.android.com/reference/android/provider/ContactsContract.Contacts.html#openContactPhotoInputStream%28android.content.ContentResolver,%20android.net.Uri%29)找到该方法。您还应该使用 AsyncTask 将位图的打开和加载移动到后台线程。最后，尝试使用 a`LruCache`来缓存已经打开的位图以提高效率，如此处[所述](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)。我最近不得不做一些类似的事情，所以我分享了一段代码来帮助你。我用它来加载背景上的图像。

```
class PhotoLoader extends AsyncTask<Void, Void, Bitmap> {

    final WeakReference<ImageView> mView;
    final Uri mUri;

    PhotoLoader(ImageView view, Uri uri) {
        if (view == null) {
            throw new IllegalArgumentException("View cannot be null!");
        }

        if (uri == null) {
            throw new IllegalArgumentException("Uri cannot be null!");
        }

        mView = new WeakReference<ImageView>(view);
        mUri = uri;
    }

    @Override
    protected Bitmap doInBackground(Void... args) {
                    // use the uri passed to the constructor
        InputStream is = Contacts.openContactPhotoInputStream(mResolver,
                mUri);
        Bitmap bm = BitmapFactory.decodeStream(is);

                    // load custom resource image if contact has no photo
        if (bm == null) {
            bm = BitmapFactory.decodeResource(mResources,
                    R.drawable.ic_contact);
        }

        return bm;
    }

    @Override
    protected void onPostExecute(Bitmap result) {
                    // use a transition drawable for nice fade effect
        Drawable[] layers = new Drawable[2];
        layers[0] = mResources.getDrawable(android.R.color.transparent);

        layers[1] = new BitmapDrawable(mResources, result);
        TransitionDrawable t = new TransitionDrawable(layers);
        t.setCrossFadeEnabled(true);

        ImageView view = mView.get();

        if(view != null) {
            view.setImageDrawable(t);
            t.startTransition(mShortAnimation);
        }
        synchronized (mPhotoCache) {
                            // store bitmap in LruCache for later use...
            mPhotoCache.put(mUri.toString(), result);
        }
    }
} 
```

我在适配器中这样使用它：

```
synchronized (mPhotoCache) {
    Bitmap b = mPhotoCache.get(key);

    if (b != null) {
    imageView.setImageBitmap(b);
    } else {
    imageView.setImageResource(android.R.color.transparent);
    PhotoLoader loader = new PhotoLoader(imageView, uri);
    loader.execute();
    }
} 
```

编辑：为了澄清，我使用字符串格式的联系人 uri 作为缓存键。在检查缓存之前的某个适配器中，我有以下行： `String key = uri.toString();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T21:36:33.673

您的 getView 每次通话都会增加一个新行。它应该只在传入的视图为空时才这样做，否则它应该覆盖传入的视图。这将加快很多滞后

# c# - SQLite 数据库查询异常处理

> ID：15012620
> 
> 赞同：1
> 
> 时间：2013-02-21T21:31:49.073
> 
> 标签：c#, database, exception

我正在从 SQLite 数据库表中检索一些数据并使用以下代码：-

```
try
{
  for (double i = 10; i < 100; i++)
  {
    // Read in value
    cmd.CommandText = "SELECT Value FROM Data WHERE Value like '" + i + "'";
    Digit_Value = Convert.ToDouble(cmd.ExecuteScalar());
  }
catch (Exception)
{
  throw;
} 
```

一切都按要求工作，直到它`Null`在数据库表中命中 a，然后引发异常。

当抛出异常时，我需要将 0.00 的值分配给变量 Digit_Value 并且例程应该继续到下一条记录。许多谷歌搜索都没有发现任何有用的东西 - 任何指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:43:30.823

If the ExecuteScalar() method is returning Null (or DbNull?) then you need to detect that before trying to assign it to Digit_Value:

```
cmd.CommandText = "SELECT Value FROM Data WHERE Value like '" + i + "'";
object o = cmd.ExecuteScalar();
if(o == Null) {
  throw new Exception("Got null");
} else {
  Digit_Value = Convert.ToDouble(o);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:45:27.090

`ExecuteScalar`返回查询中第一行的第一个单元格（[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)）。

鉴于此，只需将您的查询修改为：

```
SELECT Value FROM Data WHERE Value like '@value' UNION select 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:58:53.827

如果您不将通配符与 LIKE 一起使用，请`=`改用。

```
try
{
  cmd.Parameters.Add("@val", SqlDbType.Int32);
  cmd.CommandText = "SELECT Value FROM Data WHERE Value = @val";

  for (double i = 10; i < 100; i++)
  {
    // Read in value
    cmd.Parameters["@val"].Value = i;
    object res = cmd.ExecuteScalar();
    double? Digit_Value = DBNull.Value.Equals(res) ? null : Convert.ToDouble(res);
  }
catch (Exception)
{
  throw;
} 
```

# c# - 如何从 ChangeTracker 获取原始实体

> ID：15012621
> 
> 赞同：11
> 
> 时间：2013-02-21T21:31:49.153
> 
> 标签：c#, .net, entity-framework, entity-framework-6

有没有办法从`ChangeTracker`（而不仅仅是原始值）获取原始实体本身？

如果`State`是`Modified`，那么我想我可以这样做：

```
// Get the DbEntityEntry from the DbContext.ChangeTracker...

// Store the current values
var currentValues = entry.CurrentValues.Clone();

// Set to the original values
entry.CurrentValues.SetValues(entry.OriginalValues.Clone());

// Now we have the original entity
Foo entity = (Foo)entry.Entity;

// Do something with it...

// Restore the current values
entry.CurrentValues.SetValues(currentValues); 
```

但这似乎不太好，而且我确定它存在我不知道的问题......有没有更好的方法？

我正在使用实体框架 6。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-21T21:34:14.570

覆盖`SaveChanges`DbContext 或仅从`ChangeTracker`上下文访问：

```
foreach (var entry in context.ChangeTracker.Entries<Foo>())
{
    if (entry.State == System.Data.EntityState.Modified)
    {
        // use entry.OriginalValues
        Foo originalFoo = CreateWithValues<Foo>(entry.OriginalValues);
    }
} 
```

* * *

这是一种方法，它将使用原始值创建一个新实体。因此，所有实体都应该有一个无参数的公共构造函数，您可以简单地构造一个实例`new`：

```
private T CreateWithValues<T>(DbPropertyValues values)
    where T : new()
{
    T entity = new T();
    Type type = typeof(T);

    foreach (var name in values.PropertyNames)
    {
        var property = type.GetProperty(name);
        property.SetValue(entity, values.GetValue<object>(name));
    }

    return entity;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-14T11:32:01.110

好的。这是一个稍微修改过的版本，可以处理复杂的属性：

```
public static TEntity GetOriginal<TEntity>(this DbContext ctx, TEntity updatedEntity) where TEntity : class
    {
        Func<DbPropertyValues, Type, object> getOriginal = null;
        getOriginal = (originalValues, type) =>
             {
                 object original = Activator.CreateInstance(type, true);
                 foreach (var ptyName in originalValues.PropertyNames)
                 {
                     var property = type.GetProperty(ptyName);
                     object value = originalValues[ptyName];
                     if (value is DbPropertyValues) //nested complex object
                     {
                         property.SetValue(original, getOriginal(value as DbPropertyValues, property.PropertyType));
                     }
                     else
                     {
                         property.SetValue(original, value);
                     }
                 }
                 return original;
             };
        return (TEntity)getOriginal(ctx.Entry(updatedEntity).OriginalValues, typeof(TEntity));
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T11:52:11.193

我建议在物化上克隆实体并将它们附加到第二个上下文以保留整个原始对象图（当然，如果你需要它）。您可以通过修改 T4 模板使它们都 ICloneable。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-30T15:08:18.487

在使用 EF 6 时，我使用以下代码从代理类型获取底层 POCO 实体类型，

```
var entityType = ObjectContext.GetObjectType(dbEntitymodifiedEntry.Entity.GetType()); 
```

`ObjectContext.GetObjectType`: 从代理对象返回 POCO

# css - LESS - 在嵌套的 Mixin 上使用 Guard

> ID：15012625
> 
> 赞同：2
> 
> 时间：2013-02-21T21:31:56.360
> 
> 标签：css, less

我正在使用 LESS 处理一组按钮，但我遇到了一种似乎找不到解决方案的情况。基本上，我有一个 mixin，我将其应用于`.button`具有正常状态和在 mixin 本身中声明的悬停状态的类。

现在，问题是我想添加一个条件，这样我就不会被迫`&:hover`在 mixin 中应用声明，所以我尝试为`@check`变量设置默认值并`when (@check)`在`:hover`状态下使用，但这会产生错误。

我已经把它从我原来的块中简化了一点，但基本上这代表了我想要做的，但似乎找不到合适的方法来实现。

```
._mixin (@color: red, @check: true) {
    background: @color;

    &:hover() when (@check) { // tried &:hover(@check) when (@check) as well
       background: darken(@color, 10%);
    }
}

.button {

    ._mixin(#333);

    &.disabled {
        ._mixin(#333, false);
    }    

} 
```

如何设置 mixin 以`:hover`按需排除状态，例如，当`.button.disabled`应用于元素时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T22:14:56.050

您需要做的是两次声明 mixin，一次用于所有应该应用的样式，一次用于所有需要保护的样式：

```
//these styles are always applied when ._mixin is used
._mixin (@color: red, ...) {
    background: @color;
}
//these styles are applied only when the second parameter is true
._mixin (@color: red, true) {
    &:hover {
        background: darken(@color, 10%);
    }
}

.button {
    ._mixin(#333);

    &.disabled {
        ._mixin(#333, false);
    }    
} 
```

或者，您可以创建一个内部 mixin，它上面有一个保护：

```
._mixin (@color: red, @guard: true) {
    background: @color;
    //catchall for when the guard doesn't match
    .inner() {}
    //set your styles that you want to match in a guarded inner mixin
    .inner() when (@guard) {
      &:hover {
        background: darken(@color, 10%);
      }
    }
    //apply the inner mixin to the current mixin
    .inner;
} 
```

# linux - ubuntu /bash 下递归重命名文件和目录

> ID：15012631
> 
> 赞同：63
> 
> 时间：2013-02-21T21:32:17.060
> 
> 标签：linux, bash, ubuntu, find

我想将所有包含“特殊”一词的文件和目录重命名为“常规”。它应该保持区分大小写，因此“特殊”不会变成“常规”。

我怎样才能在bash中递归地做到这一点？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-02-21T21:42:39.627

使用的解决方案`find`：

仅重命名*文件*：

```
find /your/target/path/ -type f -exec rename 's/special/regular/' '{}' \; 
```

仅重命名*目录*：

```
find /your/target/path/ -type d -execdir rename 's/special/regular/' '{}' \+ 
```

要重命名*文件和目录*：

```
find /your/target/path/ -execdir rename 's/special/regular/' '{}' \+ 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2013-02-21T21:34:49.363

尝试这样做（要求`bash --version`> = 4）：

```
shopt -s globstar
rename -n 's/special/regular/' ** 
```

当您的测试正常时移除`-n`开关

![警告](../Images/111a8282241ae0eca22335550f6796f9.png) **还有其他同名的工具可能会也可能不会这样做，所以要小心。**

如果您运行以下命令 ( `GNU`)

```
$ file "$(readlink -f "$(type -p rename)")" 
```

你有一个像

```
.../rename: Perl script, ASCII text executable 
```

并且不包含：

```
ELF 
```

那么这似乎是正确的工具=）

如果不是，则使其成为默认值（通常已经如此）`Debian`和衍生，例如`Ubuntu`：

```
$ sudo update-alternatives --set rename /path/to/rename 
```

（替换`/path/to/rename`为您的`perl's rename`命令的路径。

* * *

如果您没有此命令，请搜索您的包管理器进行安装或[手动执行](https://metacpan.org/module/RMBARKER/File-Rename-0.20/rename.PL)

* * *

最后但同样重要的是，这个工具最初是由 Perl 的父亲 Larry Wall 编写的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-05-07T09:33:53.033

如果您不介意安装另一个工具，那么您可以使用[rnm](https://github.com/neurobin/rnm)：

```
rnm -rs '/special/regular/g' -dp -1 * 
```

它将遍历所有目录/子目录（因为）并在其名称中用*常规*`-dp -1`替换*特殊。*

 ** * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-05-13T17:08:22.157

[@speakr 的回答](https://stackoverflow.com/a/15012788/1541330)是我的线索。

如果使用 -execdir 来转换文件和目录，您还需要`-type f`从所示示例中删除。要拼写出来，请使用：

`find /your/target/path/ -execdir rename 's/special/regular/' '{}' \+`

`g`此外，如果要替换给定文件名中**所有**出现的`special`with`regular`而不仅仅是第一次出现，请考虑向正则表达式添加（全局）标志。例如：

`find /your/target/path/ -execdir rename 's/special/regular/g' '{}' \+`

将转变`special-special.jpg`为`regular-regular.jpg`. 没有全局标志，你最终会得到`regular-special.jpg`.

仅供参考：默认情况下，Mac OSX 上未安装 GNU Rename。如果您使用的是[Homebrew 包管理器](https://brew.sh/)，`brew install rename`将对此进行补救。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-07T20:43:53.963

正如 Rui Seixas Monteiro 所提到的，最好将 -iregex 模式选项与 Find 命令一起使用。我发现了以下作品，并在 U007D 提到的正则表达式中包含了全局标志：

文件：

```
查找 /path/ -type f -iregex '.*special.*' -execdir rename 's/special/regular/g' '{}' \+;
```

目录：

```
查找 /path/ -type d -iregex '.*special.*' -execdir rename 's/special/regular/g' '{}' \+;
```

文件和目录

```
查找 /path/ -iregex '.*special.*' -execdir rename 's/special/regular/g' '{}' \+;
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-12-11T23:54:40.083

这是另一种更便携**且不**依赖于`rename`命令的方法（因为它可能需要不同的参数，具体取决于发行版）。

它递归地重命名文件和目录：

```
find . -depth -name "*special*" | \
while IFS= read -r ent; do mv $ent ${ent%special*}regular${ent##*special}; done 
```

**它能做什么**

*   使用带有`-depth`参数的 find 通过执行*深度优先遍历*来重新排序结果（即目录中的所有条目都显示在目录本身之前）。
*   进行模式替换以仅修改路径中最后一次出现的*正则。*

这样，文件首先被修改，然后是每个父目录。

**例子**

给出以下树：

```
├── aa-special-aa
│   └── bb-special
│       ├── special-cc
│       ├── special-dd
│       └── Special-ee
└── special-00 
```

它按特定顺序生成这些`mv`命令：

```
mv ./aa-special-aa/bb-special/special-cc ./aa-special-aa/bb-special/regular-cc
mv ./aa-special-aa/bb-special/special-dd ./aa-special-aa/bb-special/regular-dd
mv ./aa-special-aa/bb-special ./aa-special-aa/bb-regular
mv ./aa-special-aa ./aa-regular-aa
mv ./special-00 ./regular-00 
```

获取以下树：

```
├── aa-regular-aa
│   └── bb-regular
│       ├── regular-cc
│       ├── regular-dd
│       └── Special-ee
└── regular-00 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-11T04:31:15.033

对于那些只想重命名目录的人，您可以使用以下命令：

```
find /your/target/path/ -type d -execdir rename 's/special/regular/' '{}' \; 
```

Note 类型现在`d`用于目录，并使用`-execdir`.

不过，我还没有弄清楚如何一次性重命名文件和目录。

早些时候有人评论说，一旦它重命名了根文件夹，它就不能再遍历文件树了。有一个可用的`-d`开关可以从下到上进行深度遍历，所以我相信根会最后重命名：

```
find -d /your/target/path/ -type d -execdir rename 's/special/regular/' '{}' \; 
```

从手册页（`man find`）：

```
 -d      Cause find to perform a depth-first traversal, i.e., directories are visited in post-order and all entries in a directory will be
         acted on before the directory itself.  By default, find visits directories in pre-order, i.e., before their contents.  Note, the
         default is not a breadth-first traversal. 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-12-03T15:09:37.800

对于`rename`版本`rename from util-linux 2.23.2`，以下命令对我有用：

`find . -type f -exec rename mariadb mariadb-proxy '{}' \;`*

# javascript - Highcharts - 在 legendItemClick 上显示和隐藏绘图线和带的问题

> ID：15012633
> 
> 赞同：0
> 
> 时间：2013-02-21T21:32:19.180
> 
> 标签：javascript, jquery, highcharts

我有一个图表，上面有几个 x 轴 plotLines 和 plotBands。我有一个函数，在 legendItemClick 上，将显示/隐藏 plotLines 和 Bands。（这是一个叠加了正态曲线并标记了标准差水平的直方图）

图表和代码可以在这里看到：http: [//jsfiddle.net/jlbriggs/FnhRV/](http://jsfiddle.net/jlbriggs/FnhRV/)

```
function toggleBands(chart) {
  $.each(chart.xAxis[0].plotLinesAndBands, function(index,el){
    if(el.svgElem != undefined) {
      el.svgElem[ el.visible ? 'show' : 'hide' ]();
      el.visible = !el.visible;
    }
  });
} 
```

问题：当显示或隐藏其他系列时，并且 x 轴相应地缩放，如果任何情节线或带从比例尺上掉下来，行为就会开始变得古怪。

在发布的示例中，如果隐藏法线曲线系列，最外面的绘图线将超出 x 轴的范围。一旦发生这种情况，每次隐藏它们时这两行都会重新出现，并且单击各种图例项将导致各种不应该的隐藏/可见状态。

如果该系列的轴始终保持足够宽以容纳情节线，则不会发生此错误，并且显示和隐藏将按预期愉快地发生。

谁能告诉我为什么会这样，和/或提供解决方案？提前致谢

杰米

{{edit：设置最小值和最大值以匹配曲线值在这种情况下无济于事，因为所需的可用性是用户可以隐藏曲线并查看缩放到直方图数据的图表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-17T13:19:43.580

`PlotLines`并且`plotBands`回来了，因为当轴再次显示回来时，它还应该渲染所有 plotLines 和 plotBands。那么你就不能简单地控制 plotLines 和 plotBands。如何解决？不要隐藏/显示 SVG 元素，而是删除 plotLines/plotBands 或根据需要添加它们。这是您的解决方案：http: [//jsfiddle.net/FnhrV/19/](http://jsfiddle.net/FnhRV/19/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:33:33.150

我建议设置最小/最大值。

[http://jsfiddle.net/jlbriggs/FnhrV/](http://jsfiddle.net/jlbriggs/FnhRV/)

```
 min:-3,
    max:3,
    showEmpty: true, 
```

# css - 图像悬停未出现在 CSS 中，但出现在 HEAD 中

> ID：15012641
> 
> 赞同：0
> 
> 时间：2013-02-21T21:33:10.177
> 
> 标签：css, hover, hyperlink

```
 .cssnav  {
                        position:relative;
                        font-family: arial, helvetica, sans-serif;
                        background-image:  url(img/twitter.jpg)no-       repeat center center;
                        background-repeat: no-repeat;
                        white-space: nowrap;
                        display: block;
                        width: 211px;
                        height: 44px;
                        margin: 0;
                        padding: 0;
            }
            .cssnav a {
                        display: block;
                        color: #000000;
                        font-size: 11px;
                        width: 211px;
                        height: 44px;
                        display: block;
                        float: left;
                        color: black;
                        text-decoration: none;
            }

            .cssnav img {width: 211px; height: 44px; border: 0; }
            * html a:hover {visibility:visible}
            .cssnav a:hover img{visibility:hidden}

            .cssnav span {
                        position: absolute;
                        left: 30px;
                        top: 15px;
                        margin: 0px;
                        padding: 0px;
                        cursor: pointer;
                        width: 149px;
                        height: 14px;
                        text-align: center;
            }
            /* END OF NAVIGATION */

  }

<html>

    <head>
        <title>The history of aeronautics</title>

        <meta charset="utf-8" />
        <meta name="description" content="A parallax scrolling experiment using          jQuery" />

        <link rel="stylesheet" media="all" href="css/test.css" />

    </head>

    <body>

                <!--MAIN NAVIGATION START-->

                <div class="cssnav"><a href="http://www.search-this.com/" title="Search Engine Submission"><img src="img/twitter.png" alt="Search Engine Submission" /><span>Search
                  Engine Submission</span></a></div>
                <div class="cssnav"><a href="http://www.search-this.com/website-design/" title="Website Design"><img src="img/twitter.jpg" alt="Website Design" /><span>Website
                  Design</span></a></div>

    </body>

</html> 
```

我已经包含了我的 CSS 和 HTML。我已经有一段时间试图弄清楚它为什么不起作用......我正在使用这里的三连胜翻转按钮代码：[http ://www.webcredible.co.uk/user-friendly-resources/css /rollover-buttons.shtml](http://www.webcredible.co.uk/user-friendly-resources/css/rollover-buttons.shtml)

当我将代码放在我的 HTML 区域时它可以工作，但当我把它放在 CSS 中时它不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:43:05.370

好的，首先，正如 Mat 所说，您需要一个链接样式表，方法是添加：

```
<link href="/fileName.css" rel="stylesheet" type="text/css" media="screen" /> 
```

在头部标签中。或者您可以添加这样的样式标签（也在 head 标签内）：

```
<style>
    body
    {
        background-color: #f00;
    }
</style> 
```

除此之外，如果您仍然遇到问题，我会看这里：

[http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

对于 CSS 的特殊性规则，但是作为一般经验法则（我已经使用过），在我似乎无法准确指出为什么我指定渲染的内容没有在外部 css 文件中渲染的情况下，我将使用它内联，像这样：

```
<p style="background-color: #f00;">Paragraph contents...</p> 
```

这是因为内联 CSS 比外部文件的 CSS 具有更高的特异性（固有地）。

# javascript - 函数事件取决于附加的带有类的 div

> ID：15012643
> 
> 赞同：1
> 
> 时间：2013-02-21T21:33:12.943
> 
> 标签：javascript, jquery, html

我有以下问题。我正在为 javascript 自定义滚动条附加一个带有“滚动”类的 div，并且我正在动态附加 div。之后，我设置了滚动条。

问题是它不适用于附加的 div。当我尝试使用硬编码到文档中的 div 时，一切正常。

```
function appenddiv() {
    $('#container').append('<div id="test" class="scrolling"> Lorem Ipsum ...... </div>');

    $('.scrolling').scrollbar();
} 
```

我也试过

```
function appenddiv() {
    $('#container').append('<div id="test"> Lorem Impsum .....</div>');
    $('#test').addClass('scrolling');

    $('.scrolling').scrollbar();
} 
```

我只用一个按钮就试过了

```
<a href="#" onClick="appenddiv">Click here</a> 
```

唯一有效的是：

```
<body>
   <div id="test" class="scrolling"> Lorem Ipsum ..... </div>

   <script type="text/javascript">
     $(document).ready(function() {
         $('.scrolling').scrollbar(); //this is not fired in the examples above!
        }); 
```

正如我所说，它仅在带有类滚动条的 div 测试已经在正文中时才有效。函数滚动条是一个jquery自定义的滚动条脚本，位于[这里](https://github.com/thomd/jquery-scroll/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:36:35.060

问题是`onClick`按钮中的处理程序实际上并没有调用该方法，它只是引用它。您必须使用括号来调用它。并返回 false 以阻止默认链接操作。所以试试这个：

```
<a href="#" onClick="appenddiv(); return false;">Click here</a> 
```

此外，您必须确保在调用它时定义了您的函数。由于您使用的是 jQuery，因此最好的方法是根本不使用`onclick`，而是将所有内容放在文档就绪回调中，并使用点击处理程序。因此，您的 html 链接将是这样的：

```
<a href="#" id="scrollbar-link">Click here</a> 
```

你的javascript是这样的：

```
$(document).ready(function() {
    function appenddiv() {
        var $scrolling = $('<div id="test" class="scrolling"> Lorem Ipsum ...... </div>');
        $scrolling.appendTo($('#container')).scrollbar();
    }

    $('#scrollbar-link').on('click', function(ev) {
        ev.preventDefault(); // This stops the browser from following the link
        appenddiv();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:37:07.353

这些都有 CSS 选择器错误。

在第一种情况下，您尝试为 class 匹配一个 jQuery 选择器`.scrolling`，但是`.scrollbar`当您将其附加到文档时，该类是 - 所以选择器将不匹配。

在第二种情况下，第二行的 jQuery 选择器用于 class `.test`，但您附加了一个带有*id* `#test`的元素。同样，这不会匹配文档中的任何元素。

除了这些错误之外，乍一看您的代码应该可以正常工作。修复这些错误并再试一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:38:34.987

在你的第一个例子中`$('.scrolling').scrollbar();`

应该`$('.scrollbar').scrollbar();`

在你的第二个例子中，`$('.test').addClass('scrolling');`

应该`$('#test').addClass('scrolling');`

`#`指的是一个id，而`.`指的是一个类。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-21T21:44:30.017

在第一个片段中，您尝试使用 class = "scrollbar" 添加 div，但使用 "scrolling" 类选择器 ($('.scrolling').scrollbar();)。尝试使用相同的名称。

在第二个片段中，您使用 id =“test”添加 div，但之后您尝试使用 class =“test”将类添加到元素。尝试使用

```
$('#test').addClass('scrolling'); 
```

或者

```
$('#test').scrollbar(); 
```

# sql - SQL Server 查询以按天报告给定时间范围内每小时的登录次数

> ID：15012644
> 
> 赞同：1
> 
> 时间：2013-02-21T21:33:15.923
> 
> 标签：sql, sql-server-2005

我正在尝试为我正在处理的报告（SQL Server 2005）生成一些 SQL。基本上我试图报告一个时间段内每小时的登录次数。当没有记录时，我需要为小时部分返回零，并且与一天相同，如果给定日期没有记录，则在当天的 24 小时间隔内返回零。

到目前为止，我有 SQL 查询来返回特定日期的 24 小时间隔结果。我现在只是想扩展它以在多天（例如 1 周）内完成。希望我提供了足够的信息：P

我当前的代码是：

```
--Create the temp table to store the 24hr
Declare @Hours Table (Hour int);
Declare @i as int;
Set @i = 0
While @i < 24
Begin
   Insert into @Hours
   Values(@i);

   Set @i = @i + 1;
End;

Select  
   [Hour of Day],
   count([Login]) as [total]

From
(
   SELECT       
      DATEPART(hh, [date] )  AS [Hour of Day]
      ,activity_log.date as [Login]
   FROM activity_log
   where 
   category = 'Login' 
   and description like '%logged in%'
   and[date] between '2012/06/01' and '2012/06/02'
   Union ALL

   SELECT Hour, NULL

   From @Hours

 ) as Data

 GROUP BY [Hour of Day]

 ORDER BY [Hour of Day] 
```

我已经包含了我想要实现的示例结果的附件。

[样本结果](http://i.imgur.com/NaHZdSn.png)

# android - 如何从后台服务更新在后台运行的活动 UI？

> ID：15012645
> 
> 赞同：0
> 
> 时间：2013-02-21T21:33:16.083
> 
> 标签：android, service, background

当 Activity 位于前景时，我可以在地图上添加位置标记，但是当 Activity 移动到背景时（即用户按下主页按钮），如何继续在地图上放置标记。我仍然想通过将位置标记添加到映射 Activity 来更新 UI，即使它不可见，所以当用户返回 Activity 时，即使 Activity 在后台，位置标记也会显示用户所在的位置。

我看到了从后台服务更新前台 Activity 的示例，但没有看到从后台服务更新后台 Activity 的示例。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:37:07.080

由于后台的活动无论如何都不会显示，所以您需要做的就是跟踪`markers`并在活动中`onResume`获取更新的标记列表，并在活动进入`foreground`状态时将它们显示在地图上。

# datetime - 将时间函数从 oracle 更改为 postgresql

> ID：15012663
> 
> 赞同：0
> 
> 时间：2013-02-21T21:35:33.650
> 
> 标签：datetime, postgresql-9.2

我在将 2 数据函数从 oracle 传输到 postgresql 时遇到问题，您能帮帮我吗？

数据：

间隔 = 数字（10,0）

START_DATE = 没有时区的时间戳

重复 = 数字（10,0）

我从案例状态复制了这个表达式。我必须在 postgresql 中编写等效的逻辑操作。

```
 case when (extract(DAY FROM (START_DATE + TRUNC(INTERVALL*(REPETITIONS-1) * 7)))
   - extract(DAY FROM CURRENT_TIMESTAMP)) >= 0 then 'OK' 
```

第二：

```
case when (extract(DAY FROM add_months(START_DATE, TRUNC(INTERVALL*
  REPETITIONS-1) * 12))) - extract(DAY FROM CURRENT_TIMESTAMP)) <= 0 then 'ok' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:47:11.517

```
case when (
    extract(DAY FROM (START_DATE + INTERVALL * (REPETITIONS - 1) * interval '1 week'))
    >=
    extract(DAY FROM CURRENT_TIMESTAMP))
then 'OK'

case when (
    extract(DAY FROM (START_DATE + INTERVALL * (REPETITIONS - 1) * interval '1 year')))
    <= extract(DAY FROM CURRENT_TIMESTAMP))
then 'ok' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:53:06.273

与 ORACLE 相比， PostgreSQL 对[日期、时间和间隔类型的支持要好得多。](http://www.postgresql.org/docs/current/interactive/datatype-datetime.html)

我猜（对不起，但你没有描述这个），你需要比较`timestamp`column 和`current_timestamp`基于区间的，这是从 columns`INTERVALL`和`REPETITIONS`. 我还认为，在第一种情况下，您与周间隔有关，而在第二个片段中则与月有关。（我不完全理解`TRUNC(…)`部分代码背后的逻辑。

我推荐以下内容：

1.  rename `start_date`，删除`_date`后缀，因为列的类型`timestamp`实际上具有误导性；
2.  直接转换`intervall`为`text`并存储区间类型，如`month`or `week`；
3.  保持`repetitions`原样，默认`1`为`NULL`值；
4.  PostgreSQL 原生支持`boolean`类型，所以你并不真的需要`CASE … END`这里的构造，不过取决于应用程序。

因此，以下查询可以做到（也在[SQL Fiddle](http://sqlfiddle.com/#!12/3cbeb/5)上）：

```
SELECT start_dt, intervall, repetition,
       start_dt + (repetition||intervall)::interval
         >= current_timestamp AS is_it_ok
  FROM tab; 
```

# ruby - 在 Ruby 中使用模数 % 运算符时出现逻辑错误

> ID：15012665
> 
> 赞同：1
> 
> 时间：2013-02-21T21:35:47.680
> 
> 标签：ruby

我一直在学习Ruby。我写了一个小程序。我面临一个逻辑错误，到目前为止我无法修复。这是代码。

```
 1:  puts 'Please enter the starting Year'  
 2:  startingYear = gets.chomp  
 3:  puts 'Please enter the ending Year'  
 4:  endingYear = gets.chomp  
 5:  while(startingYear.to_i <= endingYear.to_i)  
 6:     if(startingYear%4 == 0)
 7:            if((startingYear%400 == 0) or (startingYear%100 != 0))
 8:                   puts startingYear
 9:            end
10:     end
11:     startingYear = startingYear.to_i + 1
12:  end 
```

这是这个程序的作用。
它要求开始年份和结束年份，然后在它们之间“放置”所有闰年（如果它们也是闰年，则包括它们）。闰年是能被四整除的年份（如 1984 年和 2004 年）。但是，可以被 100 整除的年份不是闰年（例如 1800 和 1900），除非它们可以被 400 整除（例如 1600 和 2000，它们实际上是闰年）。

我也使用了 Ruby 调试器。当我执行程序时，它只是在第一次迭代时跳过第 6 行。之后它工作得很好。
例如：当我使用输入 1600 作为起始年份和 2000 作为结束年份时。然后输出从：

1604、1608、1612、…… . . . . 1696、1704、1708、…… . . . . . 1992, 1996, 2000
我的意思是逻辑上它也应该显示 1600 但程序只是跳过它。我知道这只是一条发际线之类的错误。但我就是想不通。

PS我是新手，所以请忽略任何愚蠢的错误。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:43:17.553

在开始时将字符串转换为整数：

```
startingYear = gets.chomp.to_i 
endingYear = gets.chomp.to_i 
```

然后，您不必`to_i`在代码中的其他任何地方使用。

您的程序在第一次迭代时跳过了第 6 行，因为您`startingYear`是第一次通过循环的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:49:01.793

The problem is that you are passing a string `"1600"` initially, to which the string formatting method `%` applies, and returns `self`. which is not `0`, so it does not satisfy the condition. From the second iteration, it is converted to an integer, so it works as you intended. You should convert the string once directly after the input:

```
startingYear = gets.to_i
endingYear = gets.to_i 
```

Also, note some redundancy in your logic. For example, if a year is divisible by 400, then it follows that it is divisible by 4, so nesting the test for the former inside the test for the latter is redundant. A cleaner logic would be like this:

```
(startingYear..endingYear).each do |year|  
  if    (year % 400).zero? then puts year
  elsif (year % 100).zero?
  elsif (year %   4).zero? then puts year
  end
end 
```

# objective-c - Objective-c：快速模糊搜索匹配

> ID：15012673
> 
> 赞同：7
> 
> 时间：2013-02-21T21:36:12.190
> 
> 标签：objective-c, cocoa, search, levenshtein-distance, fuzzy-search

有谁知道Objective-c模糊搜索匹配的快速实现？（levenshtein-距离算法）。

我发现了这个：[https](https://github.com/thetron/StringScore/blob/master/NSString%2BScore.m) ://github.com/thetron/StringScore/blob/master/NSString%2BScore.m - 但不幸的是它很慢。我需要将其与大约 200 个字符串进行比较，并且它是连续的——每次键入新的击键。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T23:48:33.060

如果 NSString+Score 可以满足您的要求，但速度太慢，您可以从加快速度开始。第 23 到 28 行`-scoreAgainst:fuzziness:options:`是设置代码，只需要执行一次，而不是每次 200 次比较。因此，将该代码提取到设置方法中并再次测量。

编辑：

作为一个练习，我[分叉了 StringScore](https://github.com/w-m/StringScore)，提取了设置代码并进行了最小的更改以获得一些性能改进，然后对其进行了测量。我使用了 1000 个随机单词，将它们分成三组（例如“打断点饮酒”）。对于这些组中的每一个，我都进行了设置（如原始答案中所述），然后将字符串与所有 1000 个组进行比较。这在我的 Core 2 Duo 上大约需要 11 秒。

因此，将一个单词与 1000 个单词进行比较大约需要 11 毫秒。现在您只需要 1 到 200 个，因此它可能会远低于 10 毫秒。那应该对你有用吗？

（顺便说一句，近一半的时间仍然花在 rangeOfString 上：查找单个字符；这可能会做得更快，但我不想了解算法的细节。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T22:57:22.970

我不知道您指的是在 Objective-C 中实现的算法

您是否有理由不将 NSPredicate 的内置功能与 CoreData 一起使用。我发现搜索 200 多个字符串的速度非常快。

例如，给定一个 NSString *searchText 和一个 fetchedResultsController

```
NSPredicate * predicate = [NSPredicate predicateWithFormat:@"name CONTAINS[cd] %@", searchText];

self.filteredListContents = [[[self fetchedResultsController] fetchedObjects] filteredArrayUsingPredicate:predicate]; 
```

您还可以在 NSArray 上使用 NSPredicate，我假设您已经尝试过并发现它太慢了。

来自苹果文档

```
NSMutableArray *array =
[NSMutableArray arrayWithObjects:@"Nick", @"Ben", @"Adam", @"Melissa", nil];

NSPredicate *bPredicate = [NSPredicate predicateWithFormat:@"SELF beginswith[c] 'a'"];

NSArray *beginWithB = [array filteredArrayUsingPredicate:bPredicate];
// beginWithB contains { @"Adam" }.

NSPredicate *sPredicate = [NSPredicate predicateWithFormat:@"SELF contains[c] 'e'"];

[array filterUsingPredicate:sPredicate];
// array now contains { @"Nick", @"Ben", @"Melissa" } 
```

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html)

# php - 用一个ajax函数改变两个html id

> ID：15012675
> 
> 赞同：0
> 
> 时间：2013-02-21T21:36:17.917
> 
> 标签：php, javascript, html, ajax, json

我需要在我的 ajax 请求中添加一些东西，以显示它从`<span id="total_vote_down_<?php echo $mes_id2; ?>">`现在减去 1 我的 ajax 只是将 1 添加到值，`<span id="total_vote_up_<?php echo $mes_id1; ?>">`我需要它从`<span id="total_vote_up_<?php echo $mes_id1; ?>">`同一个函数中减去 1。我知道我的代码很草率......请耐心等待......

顺便说一句，我知道 ajax 实际上并没有添加和减去任何东西，它只是为客户演示它，只是不知道有什么更好的方式来表达我的问题

通用.js

```
$(".vote").click(function() 
{

var id = $(this).attr("id");
var name = $(this).attr("name");
var eData = $(this).attr("data-options");
var dataString = 'id='+ id + '&' + eData ;
var parent = $(this);

if(name=='up')
{

$(this).fadeIn(200).html('');
$.ajax({
type: "POST",
url: "up.php",
data: dataString,
cache: false,

success: function(data) { $('#total_' + parent.attr("id")).text(data); }
});

}
else
{

$(this).fadeIn(200).html('');
$.ajax({
type: "POST",
url: "down.php",
data: dataString,
cache: false,

success: function(data) { $('#total_' + parent.attr("id")).text(data); }

});

}

}); 
```

索引.php

```
<div id="main">
<div id="left">
<span class='up'><a title="vote_down_" id="vote_up_<?php echo $mes_id1; ?>" class="vote" name="up" data-options="key1=<?php echo $mes_id1;?>&key2=<?php echo $mes_id2;?>&key3=<?php echo $totalvotes1;?>&key4=<?php echo $totalvotes2;?>"> <img src="up.png" alt="Down" /></a></span><br />
<span id="total_vote_up_<?php echo $mes_id1; ?>"><?php echo $totalvotes1; ?></span><br />
</div>
<div id="message">
    <?php echo $message1; ?>
</div>
<div class="clearfix"></div>
</div>
<div id="main">
<div id="right">
<br />
<span id="total_vote_down_<?php echo $mes_id2; ?>"><?php echo $totalvotes2; ?></span><br />
<span class='down'><a id="vote_down_<?php echo $mes_id2; ?>" class="vote" name="down" data-options="key1=<?php echo $mes_id1;?>&key2=<?php echo $mes_id2;?>"><img src="down.png" alt="Down" /></a></span>
</div>
<div id="message">
    <?php echo $message2; ?>
</div>
<div class="clearfix"></div>
</div> 
```

这是 up.php

```
<?php

session_start();
include("config.php");

$ip=$_SERVER['REMOTE_ADDR']; 

$mes_id1 = $_POST['key1'];
$mes_id2 = $_POST['key2'];
$totalvotes1 = $_POST['key3'];
$totalvotes2 = $_POST['key4'];
$new_totalvotes1 = $totalvotes1 + 1;
$new_totalvotes2 = $totalvotes2 - 1;

$ip_sql=mysql_query("select ip_add from Voting_IP where mes_id_fk='$mes_id1' and ip_add='$ip'");
$count=mysql_num_rows($ip_sql);

$ip_sql2=mysql_query("select ip_add from Voting_IP where mes_id_fk='$mes_id2' and ip_add='$ip'");
$count2=mysql_num_rows($ip_sql2);

// if the user has already voted, execute script
if($count==0 && $count2!=0)
{
$sql = "update Messages set totalvotes=totalvotes+1  where mes_id='$mes_id1'";
mysql_query( $sql);

$sql_in = "insert into Voting_IP (mes_id_fk,ip_add) values ('$mes_id1','$ip')";
mysql_query( $sql_in);

$sql = "update Messages set totalvotes=totalvotes-1  where mes_id='$mes_id2'";
mysql_query( $sql);

$sql_in = "DELETE FROM Voting_IP WHERE mes_id_fk='$mes_id2'";
mysql_query( $sql_in);

echo $new_totalvotes1;

// if the user has not voted, execute script
}
else if($count==0 && count2==0)
{
$sql = "update Messages set totalvotes=totalvotes+1  where mes_id='$mes_id1'";
mysql_query( $sql);

$sql_in = "insert into Voting_IP (mes_id_fk,ip_add) values ('$mes_id1','$ip')";
mysql_query( $sql_in);

echo $new_totalvotes1;

}
?> 
```

down.php 与 up 相同，只是具有相反的值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:46:43.313

如果您在 PHP 中创建关联数组，您可以使用`json_encode`它来将其转换为 JSON。像这样的东西：

```
// obviously this will be constructed dynamically from your database
$d = array('Will' => 10, 'Henry' => 12);
// echo as json
echo json_encode($d); 
```

然后在你的 JavaScript 中：

```
$.ajax({
    type: "POST",
    url: "down.php",
    data: dataString,
    cache: false,
    dataType: "json",

    success: function(data) { 
        // here data will look like { "Will":10, "Henry": 20 };
        // I'm going to assume `total_will` is the total votes for william
        var candidate;
        for (candidate in data) {
            $("#total_" + candidate).text(data[candidate]);
        }
        // now #total_Will has the text 10
        // and #total_Henry has the text 20
    }
}); 
```

# css - Wordpress - 在插件中使用 CSS

> ID：15012679
> 
> 赞同：1
> 
> 时间：2013-02-21T21:36:35.567
> 
> 标签：css, wordpress

我为 TinyMCE 编写了一个 CSS 插件，为编辑器的菜单栏添加一个新按钮。我单击按钮并打开一个弹出窗口，内容 - 用 JS 编写 - 如下所示：

```
var form = jQuery('<div id="a2ml-form">\ <div
class="a2ml-form-selector">Landingpage Quiz</div>\ <div
class="a2ml-form-selector">AR Quiz</div>\ </div>'); 
```

我想使用 class="a2ml-form-selector" - 但是我使用此代码应用的 CSS：

```
function add_to_head() {
    $url = trim(get_bloginfo('url'), "/");
?>
    <link rel="stylesheet" type="text/css" href="<?=$url?>/wp-content/plugins/a2m_landingpages/a2m_landingpages.css">
<?
}

add_action('wp_head', 'add_to_head'); 
```

未加载到 wp-admin 面板中 - 它已加载到主站点。如何在管理面板中使用 CSS 样式？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T23:17:26.527

你真的不应该像那样写出你自己的`link`标签。你应该使用`admin_enqueue_scripts`钩子：

```
function load_custom_wp_admin_style() {
    wp_register_style( 'a2m_landingpages_css', plugin_dir_path( $plugin_filename ) . '/a2m_landingpages/a2m_landingpages.css', false, '1.0.0' );
    wp_enqueue_style( 'a2m_landingpages_css' );
}
add_action( 'admin_enqueue_scripts', 'load_custom_wp_admin_style' ); 
```

[http://codex.wordpress.org/Plugin_API/Action_Reference/admin_enqueue_scripts](http://codex.wordpress.org/Plugin_API/Action_Reference/admin_enqueue_scripts)

你也许可以逃脱：

```
add_action('admin_enqueue_scripts', 'add_to_head'); 
```

但这不是最好的方法。

# c# - SQLite .NET 插入 ExecuteNonQuery 返回 1

> ID：15012682
> 
> 赞同：5
> 
> 时间：2013-02-21T21:36:40.660
> 
> 标签：c#, .net, sql, sqlite, system.data.sqlite

SQL：

```
CREATE TABLE main.LogRecord (
Id INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL ,
TimeStamp DATETIME NOT NULL ,
Type TEXT NOT NULL ,
Severity TEXT NOT NULL ,
Message TEXT NOT NULL ,
Origin TEXT NOT NULL)

INSERT INTO LogRecord
(TimeStamp, Type, Severity, Message, Origins) VALUES
(@timestamp, @type, @severity, @message, @origin) 
```

C# 伪代码：

```
SQLiteCommand command = new SQLiteCommand(INSERT_COMMAND_TEXT);
command.Parameters.AddWithValue("@paramName", object.value);
command.Connect = connectVar;
command.ExecuteNonQuery(); 
```

`ExecuteNonQuery()`运行时，`1`返回值，根据 SqliteOrg 表示：

> *SQL 错误或缺少数据库*

除了，没有抛出异常并且数据被正确插入。

有没有办法得到`LAST_ERROR_MESSAGE`使用`System.Data.SQLite`？我只遇到过获取非 .net API 的最后一条错误消息的方法。

当我错误地插入到不存在的列时，会返回相同的错误代码 (1)，但这次会抛出最后一条错误消息的异常。

那么如果插入工作正常，为什么会返回 1 呢？任何帮助是极大的赞赏。

编辑：我也尝试不发送`TimeStamp DateTime`，以防它是日期格式问题，但发生同样的情况。

编辑：原来 1 是受影响的行数，它都在文档[http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executenonquery%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executenonquery%28v=vs.80%29.aspx)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-21T21:42:53.277

重新阅读您的文档。我相信 ExecuteNonQuery 返回受影响的行数或错误时返回*-1 。*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T21:43:45.163

你确定返回值吗？

[http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executenonquery.aspx](http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executenonquery.aspx)

对于 UPDATE、INSERT 和 DELETE 语句，返回值是受命令影响的行数。对于所有其他类型的语句，返回值为 -1。

# php - Restler 3 - 设置配置

> ID：15012683
> 
> 赞同：1
> 
> 时间：2013-02-21T21:36:52.143
> 
> 标签：php, xampp, restler

我正在使用具有 PHP 5.3.1 的 XAMPP，在 htdocs 文件夹中具有 restler 结构

在我的 htdocs 文件夹中，我有 index.php

```
<?php
require_once 'vendor/restler.php';
use Luracast\Restler\Restler;

$r = new Restler();
$r->addAPIClass('Say'); // repeat for more
$r->handle(); //serve the response 
```

并说.php

```
<?php
class Say {

    /*
    * @url GET /
    */
    function hello($to='world') {
        return "Hello $to!";
    }

    function hi($to) {
        return  "Hi $to!";
    }
} 
```

在浏览器中，我把

> localhost/index.php/说

或者

> localhost/index.php/说/你好

它给了我以下信息

> 致命错误：在第 143 行的 /Applications/XAMPP/xamppfiles/htdocs/Luracast/Restler/AutoLoader.php 中调用未定义函数 Luracast\Restler\stream_resolve_include_path()

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T11:57:13.563

问题出在 PHP 版本上。从 XAMPP 更改为支持 PHP 5.4 的 AMPSS 并且现在可以使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:12:11.407

不知道它是否有帮助，但你有没有试过用小写写 Say？

`localhost/index.php/say`

你的代码对我来说看起来不错......

铜英格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T12:00:19.743

Restler 3 是 PHP 5.3，该函数`stream_resolve_include_path`将使用 5.3.2 及更高版本定义。

# ios - 单击主页按钮后返回应用程序时用户界面混乱

> ID：15012684
> 
> 赞同：0
> 
> 时间：2013-02-21T21:36:52.423
> 
> 标签：ios, objective-c, user-interface

我有一个 iPad 应用程序。当应用程序运行时，我点击主页按钮。当我再次打开应用程序时，用户界面变得混乱。我有一个方法可以处理我的 UI 并安排我的所有目标。当我按下主页按钮后打开我的应用程序时，是否有任何地方可以调用此方法？我可以使用这种方法吗？

```
- (void)applicationDidBecomeActive:(UIApplication *)application 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:44:42.323

That method is there for this.

According to doc,

> you could also use it to refresh your application’s user interface.

In addition, you can also register for `UIApplicationDidBecomeActiveNotification` notification. This is called after the previous method.

If you provide some other details, we can help you.

Cheers.

# sql-server-2008 - SQL Server 连接对话框位置

> ID：15012685
> 
> 赞同：0
> 
> 时间：2013-02-21T21:36:56.113
> 
> 标签：sql-server-2008

在 SQL Server 2008 中，我的连接对话框不知何故移到了一个不方便的位置。我有一个纵向监视器和一个横向监视器。我不再在横向监视器中打开 SQL Server，因为连接对话框会在屏幕外打开。

我已经尝试了我能想到的一切：

1.  将对话框拖动到中心屏幕，然后打开连接，然后关闭并重新打开 SQL Server
2.  拖动对话框然后取消连接
3.  以上两者都与 SQL Server 最大化以及恢复。] [1](https://i.stack.imgur.com/4haII.png)

在某些配置文件中的某处必须有一个设置说“始终在此位置打开连接对话框”。那个设置在哪里？或者还有其他方法可以解决这个问题吗？

它看起来像这样：

![问题](../Images/860570c73c6b5c5a1ee48dbd1147cdd0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:43:10.047

我找到了这个线程；

[http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/b2668b56-f021-4680-9997-4413620c1474/](http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/b2668b56-f021-4680-9997-4413620c1474/)

这表明以下内容；

> 当窗口在屏幕外打开时，您可以执行此操作将其取回。

1.  右键单击任务栏中的窗口 -> 选择移动 点击任意箭头键一次。
2.  移动你的鼠标... 窗口现在应该被你的鼠标捕获，你可以将它移动到屏幕上的任何位置。
3.  单击以设置其新位置。

显然是一个已知问题，这只是一种解决方法......但它可能会有所帮助！

# mybatis - mybatis动态sql里面注解

> ID：15012691
> 
> 赞同：2
> 
> 时间：2013-02-21T21:37:20.397
> 
> 标签：mybatis

我正在使用mybatis 3。我正在使用@select注解在mapper iterface中编写选择查询。

例子：

```
@Select("select * from EMPLOYEE where ID>55")
public List<Employee> getEmployees(); 
```

有没有办法可以动态构造查询并将其传递给注释。我找到了以 xml 方式执行此操作的示例，但没有使用注释。是否可以使用注释编写动态查询？如果是，那么该怎么做。

为了澄清这个问题，我问的不是传递一个 ID，而是构建一个动态的 where 语句。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T06:38:02.940

AFAIK @Select 注释不支持动态 SQL。我认为这是由于 Java Annotations 的一些限制。

在 myBatis 的文档中，您可以阅读：

> 注释对于简单的语句要干净得多，但是，Java 注释对于更复杂的语句来说既有限又混乱。因此，如果您必须做任何复杂的事情，最好使用 XML 映射语句

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-09T12:57:54.257

使用 MyBatis 3，您现在可以在注解中使用动态 SQL（请参阅[此注释](http://mybatis.github.io/mybatis-3/dynamic-sql.html#Pluggable_Scripting_Languages_For_Dynamic_SQL "MyBatis - 动态 SQL - 用于动态 SQL 的可插入脚本语言")）。

# cancan - 导轨：CanCan，模型

> ID：15012692
> 
> 赞同：0
> 
> 时间：2013-02-21T21:37:23.833
> 
> 标签：cancan

我安装了 devise、cancan 和 rolify。

登录的用户创建了城市。

我希望 cancan 仅显示每个用户的城市。

为此：

**我不明白用户和城市之间的关系？**没有外键。

我发现了这个： [https ://github.com/ryanb/cancan/wiki/defining-abilities](https://github.com/ryanb/cancan/wiki/defining-abilities)

可以 :read, City, :active => true, :user_id => user.id

# java - 如何将jsp文件热部署到tomcat？

> ID：15012693
> 
> 赞同：2
> 
> 时间：2013-02-21T21:37:28.740
> 
> 标签：java, jsp, tomcat

我不想每次在 JSP 文件中进行一点编辑时都构建一个 war 文件。我希望事情能像 PHP 一样工作。如何热部署到 tomcat 服务器？热部署是java标准吗？

这种热部署可以在我的软件的发布版本中使用吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T21:54:28.190

由于链接的问题并没有真正深入细节......

在`$CATALINA_BASE/conf/server.xm`l 中，您需要配置本地服务器以解包 WAR。这是我的开发服务器的示例：

```
 <Host appBase="webapps" autoDeploy="true" deployOnStartup="true" 
       deployXML="true" name="localhost" unpackWARs="true"> 
```

默认情况下，Tomcat 将检查对 JSP 文件的更改。事实上，您必须为生产进行更改，如此[处](http://tomcat.apache.org/tomcat-6.0-doc/jasper-howto.html#Production%20Configuration)所述。

进行这些更改后，您将在其中找到您的网络应用程序`$CATALINA_BASE/work/Catalina/localhost`（再次假设默认安装；如果您正在配置服务器名称，则不会是`localhost`）。就地编辑文件，下次加载页面时将显示更改。

> 这种热部署是否可以在我的软件的发布版本中使用

如果您想避免难以追踪的错误，则不是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-11T14:10:25.070

我今天遇到了同样的问题，使用爆炸的 .war 并没有为我解决问题。

我的解决方案是在 Tomcat ( ) 中也使用以下 context.xml 文件`$CATALINA_BASE\conf\context.xml`：

```
<Context reloadable="true"> 
    <Resources cachingAllowed="false" cacheMaxSize="0" />

    <WatchedResource>WEB-INF/web.xml</WatchedResource>
    <WatchedResource>${catalina.base}/conf/web.xml</WatchedResource>

    <Manager pathname="" />
</Context> 
```

我还在我的 Jsp 中将以下内容用于客户端缓存：

```
<%
response.setHeader("Cache-Control","no-cache"); //HTTP 1.1
response.setHeader("Pragma","no-cache"); //HTTP 1.0
response.setDateHeader ("Expires", 0);
%> 
```

在tomcat重新启动后，可以将Jsp复制到`$CATALINA_BASE\webapps\<context>\WEB-INF\...`

并在我的浏览器中快速重新加载 (F5) 以查看更改。

奖励：当我现在将 .class 或 .jar 文件复制到 /WEB-INF 时，Tomcat 也会重新加载其所有资源 :)

# python - 在 python 中打开一个 USB 设备 - winXP 中的路径是什么？

> ID：15012694
> 
> 赞同：0
> 
> 时间：2013-02-21T21:37:34.480
> 
> 标签：python, usb

我正在尝试通过 python 访问 USB 设备，但我不确定如何找到它的路径。我要使用的示例是： **pipe = open('/dev/input/js0','r')** 在这种情况下，这是一个 mac 或 linux 路径。我不知道如何找到 Windows 的路径。

有人可以引导我朝着正确的方向前进吗？我已经筛选了论坛，但找不到我的答案。

谢谢，-马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:49:22.333

Windows 上的默认 USB 路径是`D:\`. 因此，如果我们有一个名为 的文本文档`mydoc.txt`，它位于文件夹`myData`中，则适当的路径是`D:\myData\mydoc.txt`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:32:21.217

“一切都是文件”是Unix的核心思想之一。Windows 不同意这种理念，据我所知，它不提供等效的界面。你将不得不找到不同的方法。

第一种方法是继续在低级别处理所有内容并让您的代码在 Windows 下使用不同的代码路径。这样做的唯一真正原因是，如果您的目标是了解低级别的 USB 编程。

另一种方法是找到一个已经抽象出平台之间差异的库。PySDL 立即浮现在脑海中（紧随其后的是 PyGame，它是一个更高级别的包装器），但是，由于这是一个游戏/多媒体库，它可能对你正在做的事情有点矫枉过正。谷歌告诉我 PyUSB 存在并且似乎只专注于处理 USB 设备。PySDL/PyGame 已经存在了一段时间并且可能更成熟，所以除非你对它们有特别的反感，否则我可能会坚持使用它们。

# unit-testing - 不同阶段的 Maven 测试

> ID：15012698
> 
> 赞同：0
> 
> 时间：2013-02-21T21:37:42.353
> 
> 标签：unit-testing, maven

目前我有一些非常繁重的测试，我只想在安装 Maven 包之前运行它们。我无法将其传达给我的 pom，到目前为止包括：

```
 <plugin>
   <groupId>org.apache.maven.plugins</groupId>
   <artifactId>maven-surefire-plugin</artifactId>
   <version>2.13</version>
   <executions>
     <execution>
       <id>dummied-test</id>
       <phase>test</phase>
       <goals>
         <goal>test</goal>
       </goals>
       <configuration>
         <skip>true</skip>
       </configuration>
     </execution>
     <execution>
       <id>test-in-verify-phase</id>
       <phase>verify</phase>
       <goals>
         <goal>test</goal>
       </goals>
     </execution>
   </executions>
 </plugin> 
```

你可以猜到我 1) 首先尝试将其绑定到`verify`阶段，2) 尝试将其显式添加到`test`没有目标的阶段，3) 将其添加到设置为 true的`test`阶段...`skip`

如何告诉 Maven 在测试阶段不要运行测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:42:19.557

需要在`configuration`标签之外添加`executions`标签。为什么？我不完全理解这一点，但我想我只是添加了另一个跳过测试的执行。根据此资源： [http ://docs.codehaus.org/pages/viewpage.action?pageId=62120](http://docs.codehaus.org/pages/viewpage.action?pageId=62120)

# svg - Internet Explorer 9“点击”技巧不起作用

> ID：15012699
> 
> 赞同：2
> 
> 时间：2013-02-21T21:37:51.250
> 
> 标签：svg, internet-explorer-9, click-through

我一直在寻找一种方法来启用 Internet Explorer 9 上的图层点击，[这](https://stackoverflow.com/questions/9385213/how-to-make-internet-explorer-emulate-pointer-eventsnone/10968016)是迄今为止我找到的最佳答案之一。这显然不适用于我在[这里](http://jsfiddle.net/qmUwf/)制作的小 jsfiddle 。请注意，我在兼容模式下使用的是真正的 Internet Explorer 9，而不是 Internet Explorer 10（顺便说一句）。有没有办法让它工作？

HTML：

```
<svg width="100px" height="100px" style="position:relative;background:#aaaaaa;z-index:100;pointer-events:none;"></svg>
<div onclick="alert('it worked!');" style="position:absolute;top:10px">Click me</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T13:52:43.823

我注意到您的实施存在 2 个问题。首先，你必须用 svg 包裹你想要点击的元素。您只需将要单击的 div 放在 svg 之后而不是 INSIDE 中。其次，您的 div 没有大小，因此几乎无法单击，因此我为其添加了宽度和高度

`<div onclick="itworked();" style="position:absolute; top:0; left:0; width:100%; height:100%">Click me</div>`

我对你的小提琴实施了这个修改，它至少对我来说是有效的，[在这里](http://jsfiddle.net/qmUwf/8/)

# mysql - 如何在 MySQL 中加入和透视表

> ID：15012701
> 
> 赞同：2
> 
> 时间：2013-02-21T21:38:06.347
> 
> 标签：mysql, join, pivot

我有 3 张桌子。我需要加入其中的 2 个并让联接枢轴连接表以返回行中的值。请阅读以下内容进行说明。

```
Table 1:
t1ID   Title
01     Title 1
01_01  Title 1a
01_02  Title 1b
01_03  Title 1c
02     Title 2
02_01  Title 2a
02_02  Title 2b 
```

... 等等

```
Table 2 (not used in my join, but shown to see relationship between 3 tables -- contains a fixed number of rows which is 10):
t2ID  Description
01    Desc A
02    Desc B
03    Desc C
...
10    Desc J

Table 3:
t1ID   t2ID  Value
01     01    A
01     02    B
...
01     10    C
01_01  01    D
01_01  02    E
...
02_01  10    F
02_02  01    G
02_02  02    H 
```

...等等

我想加入表 1 和表 3，`t1ID`其中表 1 是主要或主表，表 3 提供了详细值。我需要订购表 3`t2ID`以保持顺序，以便正确处理输出。

我希望查询结果如下所示：

```
row[0]    row[1]  row[2] ... row[10]
Title 1   A       B          C
Title 1a  D       E 
```

所以我需要每一行将输出数组中的第一项作为标题，然后输出数组的第 2 到第 11 项来自连接表 3。

希望这是有道理的。

感谢您在这方面帮助我。

**已修改（越来越近，或者至少我不再有派生别名错误消息）：**

```
SELECT t1.t1ID, t1.Title, GROUP_CONCAT(t3.Value) AS value
FROM Table1 AS t1
JOIN Table3 AS t3 ON t3.t1ID = t1.t1ID
GROUP BY t3.t1ID
ORDER BY t1.t1ID 
```

我现在需要做的就是在 t2ID ORDER 中对表 3 进行排序

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:41:18.373

`group_concat()`您可以按如下方式对输出进行排序：

```
SELECT
    t1.t1ID,
    t1.Title,
    GROUP_CONCAT(t3.Value order by t2ID) AS value
FROM Table1 AS t1
JOIN Table3 AS t3 ON t3.t1ID = t1.t1ID
GROUP BY t3.t1ID
ORDER BY t1.t1ID 
```

注意通话`order by` *中*的。`group_concat()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:19:28.633

你不能用 MySQL 轻松地做到这一点，但这个`GROUP_CONCAT`功能可能对你有用。查询将如下所示：

```
SELECT Title, GROUP_CONCAT(Value) AS values
FROM Table1 AS t1
    JOIN (
        SELECT t1ID, Value FROM Table3 ORDER BY t2ID ASC
    ) AS t2 USING(t1ID)
GROUP BY t1ID 
```

此查询的结果将类似于

```
Title    | values
---------|-------
Title 1  | A,B,C
Title 1a | D,E 
```

然后，您应该能够将值字符串分解为数组。如果您绝对必须实际旋转数据，[这个问题](https://stackoverflow.com/questions/4078983/is-there-a-way-to-pivot-rows-to-columns-in-mysql-without-using-case)有更多有用的信息。

编辑： Bohemian 是正确的，他的方法比我的好，因为它使用 a`JOIN`而不是子查询。

# html - -webkit-touch-callout 等效于 IE

> ID：15012702
> 
> 赞同：10
> 
> 时间：2013-02-21T21:38:09.613
> 
> 标签：html, css, internet-explorer, touch

使用 Surface，您可以将手指放在链接上并选择复制它。这对我来说是不受欢迎的行为。这可以在 iOS 中通过以下方式禁用：

```
-webkit-touch-callout: none; 
```

有谁知道如何为 IE 禁用它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T22:06:45.557

其他所有内容的名称略有不同。

```
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T06:52:58.337

您可能正在寻找：

```
-ms-touch-select:   none;
-ms-touch-action:   none; 
```

连同上述内容，我还在 body{} 上使用它来自动隐藏 IE 10 中的滚动条：

```
-ms-overflow-style: -ms-autohiding-scrollbar; 
```

这里还有更多：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh996923.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh996923.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-13T18:25:22.703

您还可以通过将事件回调绑定到 contextmenu 事件来取消默认响应。这在 IE 中适用于触摸，就像在所有鼠标浏览器中一样：

```
window.addEventListener("contextmenu", function(e) { e.preventDefault(); }) 
```

# php - 在 PHP 中更改时区不起作用

> ID：15012707
> 
> 赞同：0
> 
> 时间：2013-02-21T21:38:44.313
> 
> 标签：php, mysql, timestamp

这是我的脚本，它在表格中输入了一个条目`orders`。但是，目前插入表格的时间并未显示为我的当地时间！

```
//Retrieve variables
$tableNum = $_POST['tableNum'];
$coverNum = $_POST['coverNum'];

//GET DATE & SET TIME ZONE
date_default_timezone_set(Europe/Dublin);

$date = date("Y-m-d H:i:s", time());

//construct query & execute
$sql = "INSERT INTO orders (covers, `table`, placed) VALUES ('$coverNum', '$tableNum', '$date') ";
$result = mysql_query($sql) or die(mysql_error());
$numrows = mysql_affected_rows(); 
```

谁能建议我可以修复我的代码以在欧洲/都柏林显示的方法？我表中的列是`TIMESTAMP`.

使用上面的代码，我的输出是这样的：

**21/02/2013 - 14:30**

应该是这样的：

**21/02/2013 - 21:30**

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:40:05.473

我认为您需要在欧洲/都柏林添加报价

```
date_default_timezone_set('Europe/Dublin'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:41:16.427

更改时区时，您需要提供这样的字符串

```
date_default_timezone_set("Europe/Dublin"); 
```

更多[在这里](http://php.net/manual/en/function.date-default-timezone-set.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:41:23.630

这是另一种方法：

```
$datetime = new DateTime(null, new DateTimeZone('Europe/Dublin'))
$datetime->format("Y-m-d H:i:s"); 
```

我喜欢使用 DateTime，因为它使处理时区变得简单。

# php - 在 Laravel 刀片模板中截断字符串

> ID：15012712
> 
> 赞同：107
> 
> 时间：2013-02-21T21:38:54.793
> 
> 标签：php, laravel, laravel-blade, template-engine, texttrimming

Laravel 中的刀片模板是否有截断修饰符，很像 Smarty？

我知道我可以在模板中写出实际的 php，但我正在寻找更好的东西来编写（让我们不要进入整个 PHP 是模板引擎的辩论）。

所以例如我正在寻找类似的东西：

```
{{ $myVariable|truncate:"10":"..." }} 
```

我知道我可以通过作曲家使用 Twig 之类的东西，但我希望 Laravel 本身具有内置功能。

如果没有，是否可以创建自己的可重用修饰符，如 Smarty 提供的。我喜欢 Blade 不会过度使用所有语法这一事实，但我认为 truncate 是一个真正方便的功能。

我正在使用 Laravel 4。

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2014-07-23T05:41:42.107

在 Laravel 4 和 5（最高 5.7）中，您可以使用`str_limit`，它限制字符串中的字符数。

在 Laravel 5.8 以上，你可以使用`Str::limit`helper。

```
//For Laravel 4 to Laravel 5.5
{{ str_limit($string, $limit = 150, $end = '...') }}
//For Laravel 5.5 upwards
{{ \Illuminate\Support\Str::limit($string, 150, $end='...') }} 
```

更多 Laravel 辅助函数[http://laravel.com/docs/helpers#strings](http://laravel.com/docs/helpers#strings)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-08-28T17:24:46.997

Laravel 4`Str::limit`可以截断到确切的字符数，也`Str::words`可以截断单词边界。

查看：

*   [http://laravel.com/api/4.2/Illuminate/Support/Str.html#method_limit](http://laravel.com/api/4.2/Illuminate/Support/Str.html#method_limit)

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-02-22T06:26:18.100

**编辑：这个答案是在 Laravel 4 beta 期间发布的，当时 Str 类不存在。现在在 Laravel 4 中有更好的方法来做到这一点——这是达斯汀在下面的回答。由于 SO 规则，我无法删除此答案（它不会让我这样做）**

Blade 本身没有该功能。

在 Laravel 3 中有 Str 类 - 你可以这样做：

```
{{ Str::limit($myVariable, 10) }} 
```

在这个阶段，我不相信 Str 类在 Laravel 4 中 -[但这是它的一个端口，您可以将其包含在 composer](https://github.com/meido/str)中以添加到您自己的项目中

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2019-07-01T11:25:29.237

> **Laravel 7.* 的更新**：[Fluent Strings](https://laravel.com/docs/7.x/helpers#fluent-strings)即一个更流畅的、面向对象的接口，用于处理字符串值，与传统的字符串操作相比，允许您使用更易读的语法将多个字符串操作链接在一起。

[限制](https://laravel.com/docs/7.x/helpers#method-fluent-str-limit)示例：

```
$truncated = Str::of('The quick brown fox jumps over the lazy dog')->limit(20); 
```

**输出**

```
The quick brown fox... 
```

[单词](https://laravel.com/docs/7.x/helpers#method-fluent-str-words)示例：

```
$string = Str::of('Perfectly balanced, as all things should be.')->words(3, ' >>>'); 
```

**输出**

```
Perfectly balanced, as >>> 
```

> **Laravel 6.* 更新**：你需要这个包才能工作所有 laravel 助手`composer require laravel/helpers`

对于在控制器中使用助手，不要忘记包含/使用类

```
use Illuminate\Support\Str; 
```

> **Laravel 5.8 更新**

这是用于处理**字符串中的字符**：

```
{!! Str::limit('Lorem ipsum dolor', 10, ' ...') !!} 
```

**输出**

```
Lorem ipsu ... 
```

这是用于处理**字符串中的单词**：

```
{!! Str::words('Lorem ipsum dolor', 2, ' ...') !!} 
```

**输出**

```
Lorem ipsum ... 
```

这是处理字符串[Laravel Helpers的最新帮助文档](https://laravel.com/docs/6.x/helpers#available-methods)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-04-19T13:59:39.293

为了保持你的代码 DRY，如果你的内容来自你的模型，你应该采用稍微不同的方法。像这样编辑您的模型（在 L5.8 中测试）：

```
<?php

namespace App;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Support\Str;

class Comment extends Model
{
    public function getShortDescriptionAttribute()
    {
        return Str::words($this->description, 10, '...');
    }
}
?> 
```

然后在你看来：

```
{{ $comment->short_description }} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-07-04T09:11:50.227

您可以设置命名空间，如：

```
{!! \Illuminate\Support\Str::words($item->description, 10,'....')  !!} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-09-14T21:56:15.233

对于像这样简单的事情，我更愿意做一个助手 - 例如：

`helpers.php`在您的文件中创建一个`/app/helpers.php`包含以下内容的文件：

```
<?php
if (! function_exists('short_string')) {
    function short_string($str) {
            $rest = substr($str, 0, 10);
            return $rest;
    }
} 
```

注册`helper.php`at autoload 在您的`composer.json`

```
 "autoload": {
        "files": [
            "app/helpers.php"
        ],
        "psr-4": {
            "App\\": "app/"
        },
        "classmap": [
            "database/seeds",
            "database/factories"
        ]
    } 
```

之后，您可以在刀片文件中使用，例如：

```
{{ short_string($whatever_as_text) }} 
```

然后，您可以在您的应用程序中全局使用这个简单的功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-25T22:32:21.717

这适用于 Laravel 5：

```
{!!strlen($post->content) > 200 ? substr($post->content,0,200) : $post->content!!} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-02-26T06:40:54.597

您可以设置字符串限制，如下例所示：

```
<td>{{str_limit($biodata ->description, $limit = 20, $end = '...')}}</td> 
```

它将仅显示 20 个字母，包括空格并以 ... 结尾。

示例图片[![它显示了字符串限制的示例](../Images/7d403fbb492a58bf50dc6e7e8ed7bb76.png)](https://i.stack.imgur.com/3f05O.png)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-05-12T09:10:05.283

在 Laravel 4 和 5（最高 5.7）中，您可以使用 str_limit，它限制字符串中的字符数。

在 Laravel 7 中，你可以使用 Str::limit 助手。

```
//For Laravel  to Laravel 7

{{ Illuminate\Support\Str::limit($post->title, 20, $end='...') }} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-12-12T06:04:38.450

您可以使用 sub_str：

```
{{substr($myVariable,10)}} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-12-20T09:46:12.113

Laravel 6 更新：

```
@php
$value = 'Artificial Intelligence';
$var = Str::limit($value, $limit = 15, $end = '');
print_r($var);
@endphp

<p class="card-text">{{ Illuminate\Support\Str::limit($value, 7) }}</p>
<h2 class="main-head">{!! Str::limit($value, 5) !!}</h2> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-03T18:33:04.043

下面的示例使用 laravel 8。

`{!! Str::words("$post->content", 8, ' ...') !!}`

`{!! Str::limit("$post->content", 15, ' ...') !!}`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-12-20T13:06:26.827

Str::words 方法限制字符串中的单词数。可以通过其第三个参数将附加字符串传递给此方法，以指定应将哪个字符串附加到截断字符串的末尾：

```
use Illuminate\Support\Str;

return Str::words('Perfectly balanced, as all things should be.', 3, ' >>>');

// Perfectly balanced, as >>> 
```

您可以将第三个参数传递给该方法以更改将附加到截断字符串末尾的字符串：

```
use Illuminate\Support\Str;

$truncated = Str::limit('The quick brown fox jumps over the lazy dog', 20, ' (...)');

// The quick brown fox (...) 
```

# continuous-integration - 持续集成——需要吗？

> ID：15012713
> 
> 赞同：2
> 
> 时间：2013-02-21T21:38:58.617
> 
> 标签：continuous-integration

我有这个问题来验证我对持续集成的了解。由于我的理解：持续集成将帮助我们尽快检查构建是否有任何错误或错误[红灯]。

我假设我们所有的开发人员都知道 TDD，他们会在将某些东西推送到服务器之前一直进行测试。这意味着必须在推送之前传递推送的代码，所以我们不再需要 ci 服务器，因为我们总是有绿灯。

所以我的问题是，如果我们有一个优秀的团队，在开发中始终遵循 TDD 规则，我们是否需要 ci 服务器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T22:03:23.393

这取决于您的 CI 服务器在做什么。您可以让每个开发人员在提交到中央源代码存储库之前在本地运行所有单元测试，但是开发人员如何知道要运行哪些单元测试？他们必须运行所有这些测试，以及所有集成测试、UI 测试等。这可能需要很长时间才能进行大量测试。

通常，CI 服务器将被配置为在夜间运行较长的集成测试，以查看是否引入了任何重大更改。

此外，您忽略的 CI 服务器的另一个重要特性是源代码的实际构建。当您提交对源代码存储库的更改时，引入构建错误是很常见的，因为您要么忘记提交新文件，要么假设您的源代码正在对其构建的开发环境做出假设。

例如，您可能正在引用已安装到您的程序文件目录的第三方库。这在每台开发人员机器上都可以正常构建，因为他们安装了第三方库，但是在构建服务器上，您会检测到错误的引用，因为构建会失败。

此外，让 CI 服务器在提交时运行构建和测试不仅会更快地突出集成问题，而且还可以在提交后立即通知团队中的所有开发人员，以便立即发现问题的根源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T06:12:37.710

所有团队都应该进行持续集成，但这并不意味着您需要有 CI 服务。詹姆斯·肖尔（James Shore）对此发表了一篇经典文章：

[持续集成是一种态度，而不是工具](http://www.jamesshore.com/Blog/Continuous-Integration-is-an-Attitude.html "持续集成是一种态度，而不是工具")

因此，如果您有这种态度，即使没有服务器，您也可以获得 CI 的巨大好处。也就是说，CI 服务器可以提供帮助的原因有很多：

1.  人类是容易犯错的，即使有最好的意图，他们也不总是把事情做对。服务器是自动化的和可预测的。
2.  该服务器在比典型开发人员工作站更清洁的环境中运行构建。这可以突出在部署/发布之前不会被注意到的问题。
3.  如果您支持多个平台，一个好的 CI 服务器可以轻松地为您测试所有平台。
4.  如果您有很多集成测试，这些测试可能比单元测试慢，那么要求所有开发人员都在预先签入时运行它们可能会很麻烦。相反，他们可以运行快速的单元 + 冒烟测试来捕获 99% 的问题，并让 CI 服务器运行整个套件。
5.  服务器可以维护构建历史，显示一段时间内的趋势。例如，这对于漂移分析（检查性能趋势）非常有用。
6.  CI 服务器提供了许多附加功能，从服务器到服务器，您可能会感兴趣（例如，支持发布构建、灵活调度、通知、并行构建）。

总而言之：您不需要服务器即可获得 CI 的主要优势。但是您可以从正确的服务器软件中获得很多相关的好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T22:00:34.397

首先，我怀疑所有项目都能负担得起 TDD，因为它很昂贵，而且开发人员通常更喜欢直接编写功能代码而忘记测试，即使对于更简单的单元测试也是如此。当真正应用时，TDD 将检测功能上的问题，但不一定在包含许多集成在一起的不同组件的大型项目的全面范围内。一个简单的例子是将许多部分组合在一起，每个部分都可以工作，但未能使用与相同 api 对齐的部分（我使用了错误版本的库......）。拥有完整的产品构建有助于发现与集成相关的问题。以连续的方式使用它有助于在引入问题时发现问题，单元测试可能无法检测到这些问题，因为单元测试分别关注每个特性或子特性。

# html - 为什么内容浮动在 DIV 旁边？

> ID：15012714
> 
> 赞同：0
> 
> 时间：2013-02-21T21:38:58.670
> 
> 标签：html, css, css-float

我正在尝试使用浮动 div 构建表单，而不是使用表格的正常方法。我已经到达提交按钮并试图将其居中。通常，作为块元素的 DIV 会自动用完一整行并在它之后有一个换行符，不是吗？但我的没有，我不知道为什么。我尝试将它的宽度明确设置为 100%，但它仍然不会使用全宽。更让我困惑的是，div 的样式是 clear:both; 我认为应该防止任何内容漂浮在它旁边。我还尝试将其以下文本放在自己的 div 中，但没有任何改变。为什么文本浮动在提交 div 旁边？

```
<style type="text/css">
    #rlpContactForm
    {
        width:275px;
    }
    #rlpContactForm label
    {
        display:block;
        float:left;
        width:112px;
        text-align:right;
        font-weight:bold;
    }
    #rlpContactForm input
    {
        float:left;
        margin:0 0 5px 5px;
    }
    #rlpContactForm input[type="text"]
    {
        border: 1px solid #999999;
    }
    #rlpContactForm input[type="text"]
    {
        width: 146px;   /*175 available - total width of label (including margins/borders/10pxwiggle room)*/
        padding: 1px 0px 1px 0px;   /* Otherwise IE adds 1px right and left padding automatically */
    }
    #rlpContactForm input[type="text"].age
    {
        width: 44px;    /* Sized for 3 boxes to fit 1 line */
        margin: 0 0 5px 5px;
        text-align:center;
    }

    #rlpContactForm .submit
    {
        float:none;
        clear:both;
        width:100%;
        text-align:center;
    }
</style>

...

<div id="rlpContactForm">
        <label>First Name:</label>
        <asp:TextBox ID="txtFName" runat="server" />
        <label>Last Name:</label>
        <asp:TextBox ID="txtLName" runat="server" />
        <label>E-mail:</label>
        <asp:TextBox ID="txtEmail" runat="server" />
        <label>Phone:</label>
        <asp:TextBox ID="txtPhone" runat="server" />
        <label>Children's Ages:</label>
        <asp:TextBox ID="txtAge1" runat="server" CssClass="age"/>
        <asp:TextBox ID="txtAge2" runat="server" CssClass="age"/>
        <asp:TextBox ID="txtAge3" runat="server" CssClass="age"/>

        <div class="submit"><asp:Button ID="btnSubmit" runat="server" Text="Submit"/></div>
        Thank you for your interest. A team member will contact you shortly.
    </div> 
```

IE 和 Firefox 显示喜欢

```
|Submit|Thank you for your interest. A
        team member will contact you
shortly. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:40:57.180

如果您不希望发生这种情况，也可以浮动文本：

```
<div class="float:left">Thank you for your interest. A team member will contact you shortly.</div> 
```

**编辑**

我现在明白你的意思了，即使上面的答案对你有用，这是一个更好的方法：

```
.submit
    {
        float:none;
        clear:both;
        width:100%;
        text-align:center;
        overflow:hidden;
    } 
```

因为`.submit`div 内的输入元素有一个浮点数，所以`.submit`div 失去了它的高度。为了防止这种情况，您添加`overflow:hidden`.

我从来不知道到底发生了什么以及正确的条款是什么，所以你必须查一下。我只知道它是这样工作的：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:36:38.407

停止。等待。不，答案真的比这一切容易得多。

问题是您的 .submit 容器已清除，是的，但它不/包含/您放入其中的按钮。该按钮仍然浮动。

尝试这样的事情：

```
#rlpContactForm .submit input {
    float:none;
} 
```

# c# - 在 C# 图表中选择性地隐藏系列

> ID：15012718
> 
> 赞同：10
> 
> 时间：2013-02-21T21:39:10.783
> 
> 标签：c#, charts, customization, mschart

假设我有一张图表，上面有 2 个系列。然后对于每个系列，我都有一个复选框来说明我是否想看它们。假设我最初绘制了两者，然后想隐藏它们中的任何一个。做这个的最好方式是什么？

我知道我可以`Clear()`这样做，然后`AddXY()`他们又回来了，但是有没有更快的方法呢？

我尝试的想法：

1\. 根据复选框将可见性属性设置为真/假。
没有可见性属性

2\. 将点集合复制到变量，清除，然后放回。
`Series[].Points`是只读的

3\. 将系列复制到变量，清除点，然后放回。
显然它将系列存储为参考当我尝试这个时，我找不到复制命令。

所以我显然是以错误的方式解决这个问题。您将如何动态地允许图表隐藏不同的系列？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-21T21:42:07.950

要在 MSChart 中隐藏系列，请以`Enabled`这种方式使用该属性：

```
msChart.Series["Series"].Enabled = false; 
```

并再次展示它：

```
msChart.Series["Series"].Enabled = true; 
```

所以你不需要删除点并重新添加它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-17T04:44:02.520

还有另一种方法可以在不隐藏图例的情况下做到这一点。

简单地说：

```
Chart.Series[0].Color = Color.FromArgb(0, 0, 0, 0); //sets color to transparent 
```

您可以稍后重置为 Color.Empty 以恢复默认颜色。

这里唯一的缺点是除非系列中的最后一项被隐藏，否则其他行将重新着色

# javascript - 未捕获的 ReferenceError：未定义 url

> ID：15012721
> 
> 赞同：4
> 
> 时间：2013-02-21T21:39:23.447
> 
> 标签：javascript, ajax, jquery

`'url'`在此代码块中 引用时，我不断收到此错误。

> 未捕获的 ReferenceError：未定义 url。

虽然 URL 是在 ajax 上面的一个变量中明确定义的。我究竟做错了什么？

```
$.ajax({
url: url,
dataType: 'jsonp',
cache: true,
jsonpCallback: 'wCallback_1'
}); 
```

这是完整的代码

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>

<script type="text/javascript" language="javascript">

$(function () {
// Specify the location code and units (f or c)
var location = 'SPXX0550';
var u = 'c';

// Run the query (pull data from rss feed)
var query = 'SELECT * FROM rss WHERE url="http://xml.weather.yahoo.com/forecastrss/' + location + '_' + u + '.xml"';
var cacheBuster = Math.floor((new Date().getTime()) / 1200 / 1000);
var url = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(query) + '&format=json&_nocache=' + cacheBuster;
});

window['wCallback_1'] = function(data) {
    var info = data.query.results.item.forecast[0];
    $('#wIcon').append('<img src="http://l.yimg.com/a/i/us/we/52/' + info.code + '.gif" width="34" height="34" title="' + info.text + '" />');
    $('#wTemp').html(info.temp + '&deg;' + (u.toUpperCase()));
    $('#wText').html(info.text);
};

$.ajax({
    url: url,
    dataType: 'jsonp',
    cache: true,
    jsonpCallback: 'wCallback_1'
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T21:41:41.993

因为您定义并填充`url`了由 包围的代码块，`$(function() { })`该代码块在加载文档时运行。

但是，它后面的代码（您尝试使用的地方`url`）会立即运行（在文档加载之前）。

只需将所有代码放入`$(function() { })`块中，它就可以正常工作......

```
$(function () {
    // Specify the location code and units (f or c)
    var location = 'SPXX0550';
    var u = 'c';

    // Run the query (pull data from rss feed)
    var query = 'SELECT * FROM rss WHERE url="http://xml.weather.yahoo.com/forecastrss/' + location + '_' + u + '.xml"';
    var cacheBuster = Math.floor((new Date().getTime()) / 1200 / 1000);
    var url = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(query) + '&format=json&_nocache=' + cacheBuster;

    window['wCallback_1'] = function(data) {
        var info = data.query.results.item.forecast[0];
        $('#wIcon').append('<img src="http://l.yimg.com/a/i/us/we/52/' + info.code + '.gif" width="34" height="34" title="' + info.text + '" />');
        $('#wTemp').html(info.temp + '&deg;' + (u.toUpperCase()));
        $('#wText').html(info.text);
    };

    $.ajax({
        url: url,
        dataType: 'jsonp',
        cache: true,
        jsonpCallback: 'wCallback_1'
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:40:52.410

您`url`不在您的`$.ajax`通话范围内。您需要将其移动到就绪处理程序中，或将 url 作为全局可用

```
$(function () {
    // Specify the location code and units (f or c)
    var location = 'SPXX0550';
    var u = 'c';

    // Run the query (pull data from rss feed)
    var query = 'SELECT * FROM rss WHERE url="http://xml.weather.yahoo.com/forecastrss/' + location + '_' + u + '.xml"';
    var cacheBuster = Math.floor((new Date().getTime()) / 1200 / 1000);
    var url = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(query) + '&format=json&_nocache=' + cacheBuster;

    $.ajax({
        url: url,
        dataType: 'jsonp',
        cache: true,
        jsonpCallback: 'wCallback_1'
    });    
});

window['wCallback_1'] = function(data) {
    var info = data.query.results.item.forecast[0];
    $('#wIcon').append('<img src="http://l.yimg.com/a/i/us/we/52/' + info.code + '.gif" width="34" height="34" title="' + info.text + '" />');
    $('#wTemp').html(info.temp + '&deg;' + (u.toUpperCase()));
    $('#wText').html(info.text);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:41:40.140

您`url`在函数内部定义，因此它绑定到该执行上下文（范围）。您需要`$.ajax`调用位于相同的执行上下文中。如果将其移至函数中，则它将起作用。

# css - IE img doesn't stretch li

> ID：15012723
> 
> 赞同：0
> 
> 时间：2013-02-21T21:39:32.510
> 
> 标签：css, internet-explorer, html-lists, image, expand

I have [this code here](http://jsfiddle.net/Jonur/mTKKM/2/). If you open it a browser other than IE, then you would be able to see that the 3rd and 5th `li` of the `ul.submenu` have also an `img` inside. In IE unfortunately it's not displayed on the 3rd `li`, and it's going underneath like in a different line as if it lacks floats. Normally, the `img` should just expand the `li` as in the rest browsers.

I have tried changing the `display` property of both `li` and `img`, as well as various `margin` and `padding` combinations of the `img` but with no luck.

Anyone knows why this happens and what should I do to reach the proper result? Any help will be very much appreciated! :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:51:11.103

**样式列表的第一条规则**：`display:block`在`A`-tag 上使用并将所有样式放在那里（除了用于定位/隐藏/显示列表的东西）。

看我的教程：[我喜欢列表](http://preview.moveable.com/jm/ilovelists/)。

# php - Very weird PHP file_exists issue

> ID：15012725
> 
> 赞同：0
> 
> 时间：2013-02-21T21:39:41.767
> 
> 标签：php, cgi, file-exists

I run into a very weird situation with file_exists function. The hosting company said their php was configured in CGI mode instead of PHP mode. below is the code. It checks the existence of the file called test.txt in data folder on the fly during 50 seconds or so when loading the page containing the code. If file found, display "File exists" and exits the while loop. If no file found in 50 seconds, display "File does not exist" and breaks the loop too finishing loading the page.

Strange thing 1: it was not working as expected, can find the file only first time loading the page when file is there. It continues displaying "File exists" even after test.txt got removed when I refresh the page. If test.txt is not in the data folder at all, it displays "file not exists" even after I move back test.txt in the folder.

Strange thing 2: If I put a bigger file say over 170K in size, it looks working well, small files not though, especially under 40 bytes. I have tried many different ways to check file existence including absolute path, still no luck.

Thanks for any clue!

loading page...

```
$counter= 1;

while ($counter++) {

    sleep(5);

    if (file_exists("data/test.txt")) {
    echo "File exists";
    break;
    }

    if ($counter>10){
    echo "File does not exist";
    break;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:47:02.203

PHP caches the results. Use [clearstatcache();](http://php.net/manual/en/function.clearstatcache.php) before you use file_exists().

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:52:46.917

由于您在循环中多次检查此文件的存在，因此您可能需要在此处考虑缓存问题。

取自- [_](http://php.net/manual/en/function.file-exists.php) _`file_Exists()`

> 注意：此函数的结果被缓存。有关详细信息，请参阅[clearstatcache()](http://www.php.net/manual/en/function.clearstatcache.php)。

也许你应该尝试将你的脚本修改成这样 -

```
while ($counter++) {
  sleep(5);
  clearstatcache(); 
  if (file_exists("data/test.txt")) {
    echo "File exists";
    break;
  }
  ...
} 
```

# forms - Coffeescript dropdown value

> ID：15012727
> 
> 赞同：2
> 
> 时间：2013-02-21T21:39:49.923
> 
> 标签：forms, coffeescript

I'm trying to show province/state field if country dropdown equals "Canada" or "United States" through Coffeescript.

So far I have (but looks over complex)

```
canada = "Canada"
usa = "United States"
$('#order_shipping_address_attributes_country').change ->
  selected = $('#order_shipping_address_attributes_country :value').text()
  $('#shipping_province').show() if selected is canada 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T04:14:22.603

以下作品：

```
$('#order_shipping_address_attributes_country').change ->
  selected = $('#order_shipping_address_attributes_country option').filter(':selected').text()
  if selected is "Canada" or selected is "United States"
    $('#shipping_province').show()
  else
    $('#shipping_province').hide() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-21T22:13:15.900

你可以做

```
selected = $('#order_shipping_address_attributes_country option:selected').text() 
```

但是，根据[http://api.jquery.com/selected-selector/](http://api.jquery.com/selected-selector/)，事情会表现得更好

```
selected = $('#order_shipping_address_attributes_country option')
           .filter(':selected').text() 
```

# functional-programming - Any simpler way to implement non-in-place selection sort in OCaml?

> ID：15012728
> 
> 赞同：0
> 
> 时间：2013-02-21T21:39:52.843
> 
> 标签：functional-programming, ocaml

I implemented a `non-in-place` version of selection sort in OCaml.

* * *

```
let sort compare_fun l = 
    let rec find_min l' min_l origin_l =
      match l' with
    | [] -> 
      if min_l = [] then (min_l, l')
      else 
        let min = List.hd min_l 
        in 
        (min_l, List.filter (fun x -> if x != min then true else false)  origin_l)
    | x::tl -> 
      if min_l = [] then
        find_min tl [x] origin_l
      else 
        let c = compare_fun (List.hd min_l) x
        in 
        if c = 1 then 
          find_min tl [x] origin_l
        else if c = 0 then
          find_min tl (min_l @ [x]) origin_l
        else 
          find_min tl min_l origin_l
    in 
    let rec insert_min l' new_l =
      match l' with
    | [] -> new_l
    | _ -> 
      let (min_l, rest) = find_min l' [] l'
      in 
      insert_min rest (new_l @ min_l)
    in 
    insert_min l [];; 
```

* * *

My idea is that in a list, every time I find the list of minimum items (in case of duplicate values) and add this `min list` to the result list, then redo the finding_min in the rest of the list.

I use `List.filter` to filter out the `min_list`, so the resulting list will be the list for next `find_min`.

I find my implementation is quite complicated, and far more complicated than the Java in-place version of selection sort.

Any suggestions to improve it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:26:46.413

编辑：这是一个更好的实现：[http ://rosettacode.org/wiki/Sorting_algorithms/Selection_sort#OCaml](http://rosettacode.org/wiki/Sorting_algorithms/Selection_sort#OCaml)

这是我自己的更糟糕的实现

```
(* partial function - bad habit, don't do this. *)
let smallest (x::xs) = List.fold_right (fun e acc -> min e acc) xs x

let remove l y =
  let rec loop acc = function
    | [] -> raise Not_found
    | x::xs -> if y = x then (List.rev acc) @ xs else loop (x::acc) xs
  in loop [] l

let selection_sort = 
  let rec loop acc = function
    | [] -> List.rev acc
    | xs -> 
        let small = smallest xs in
        let rest = remove xs small in
        loop (small::acc) rest
  in loop [] 
```

# regex - SQLite3 正则表达式和模式约束

> ID：15012731
> 
> 赞同：3
> 
> 时间：2013-02-21T21:40:00.970
> 
> 标签：regex, database, sqlite

在 SQLite3 CREATE TABLE 语句中，我可以使用正则表达式来强制执行特定的约束吗？具体来说，我试图要求输入的 URL 有效。我知道除了使用正则表达式之外还有其他方法可以做到这一点，但是由于我的项目结构，这是我需要的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T08:49:50.063

只有在安装了用户定义的函数后才能使用正则表达式`REGEXP`；SQLite 默认没有。

但如果你有它，你也可以`REGEXP`在`CHECK`约束中使用。

# java - Beginner Android: R file in Fragment example on Developer page generates unexpected results

> ID：15012732
> 
> 赞同：0
> 
> 时间：2013-02-21T21:40:01.527
> 
> 标签：java, android, android-fragments

I am very new to java and android programming. I was working through the developer page trying to figure out the goings on and the example found at this address: [http://developer.android.com/training/basics/fragments/creating.html](http://developer.android.com/training/basics/fragments/creating.html) produced results that I could not explain. Specifically, the R file generates a couple of variables in the ID subpart that I could not find in any of the resource files. I don't know if I am looking in the wrong place or perhaps it pre generated not from the provided xmls? I am just trying to understand the dynamics of R file generation and interaction with the resource files and am having trouble reconciling that example.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:57:55.417

R文件中生成的ID是查不到的，是通过算法生成的，你得把它们想象成hashcode，是唯一生成的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:07:18.227

在 android 项目中，R 类会在您每次构建项目时自动更新或生成。默认情况下，当您保存更改或按 ctrl + s 时，eclipse 会自动构建或编译您的代码。因此，您的资源 R 中的任何更改都会更新。当您指定新的 id、布局、drawable、菜单、字符串、样式等时，android 在您的 R 类中添加一个引用静态整数。

例子：

```
public static final class id {
    public static final int image=0x7f070001;
    public static final int input=0x7f070000;
    public static final int menu_settings=0x7f070002;
} 
```

当您添加 @+id/myname R 将更新为...

```
public static final class id {
    public static final int image=0x7f070001;
    public static final int input=0x7f070000;
    public static final int menu_settings=0x7f070002;
    public static final int myname=0x<something>;
} 
```

当您想要查找、设置或获取时，R 类也用于访问或作为参考。

```
 setContentView(R.layout.activity_main); //this will set the layout in the activity where R class points out to the integer reference in the R class which somehow used by the system to get the xml layout activity_main

 someView.setBackgroundResource(R.drawable.picture) //R points to the integer reference of image which then the system interprets the someView's background is set by the image file picture under drawable resource. 
```

我希望这会有所帮助并欢迎使用 android :)

# asp.net-mvc - Is there an equivalent of Rails ActiveRecord::Callbacks in ASP MVC?

> ID：15012733
> 
> 赞同：0
> 
> 时间：2013-02-21T21:40:01.630
> 
> 标签：asp.net-mvc, entity-framework

Is there an equivalent of Rails ActiveRecord::Callbacks in ASP MVC?

[http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)

I'm in a situation where we are not using identities for our primary key. We do this for reasons specific to our DB sharding design. Because of this we have a lookup table to find the next ID for a specific table. I'd like to automatically get this value and set it in an abstract class whenever a model is created/updated and before it is saved. I also need to update the lookup table with an incremented 'nextID' after the save is successful.

I'm open to other solutions on how to do this without callbacks as well.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:01:48.670

所以你需要回调来增加查找表中的 ID 吗？AFAIK 在 ASP.NET 中没有等效项，您可以尝试使用异步控制器（[http://msdn.microsoft.com/en-us/library/ee728598%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/ee728598%28v=vs.100%29.aspx)）并等待成功保存后的状态更改，但我更喜欢使用专门为此服务的服务，例如 Snowflake ( [https://github.com/twitter/snowflake/](https://github.com/twitter/snowflake/) )。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T17:04:26.763

我找到了一个使用覆盖而不是回调的解决方案。我希望 ASP mvc 随着框架的不断成熟增加对回调的支持，因为回调通过允许 OnSave 事件存在于事件所关注的模型中而不是集中式 DbContext 类（分离担忧）。

**解决方案：**

SaveChanges 方法可以在 Context 类中被覆盖（[Entity Framework Power Tools](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d)创建 Context 类是 'Models' 目录）。

```
 public override int SaveChanges()
    {
        // create a cache for id values in case their are multiple added entries in the dbcontext for the same entitytype
        Dictionary<string, UniqueID> idCache = new Dictionary<string, UniqueID>();
        IEnumerable<DbEntityEntry> changes = this.ChangeTracker.Entries();
        foreach (var entry in changes)
        {
            //check if this is a new row (do nothing if its only a row update because there is no id change)
            if (entry.State == System.Data.EntityState.Added)
            {
                //determine the table name and ID field (by convention)
                string tableName = entry.Entity.GetType().Name;
                string idField = entry.Entity.GetType().Name + "ID";
                UniqueID id = null;
                //if we've already looked this up, then use the cache
                if (idCache.ContainsKey(tableName))
                {
                    id = idCache[tableName];
                }
                //if we havn't looked this up before get it and add it to the cache
                else
                {
                    id = this.UniqueIDs.Find(tableName, idField);
                    //if it doesn't already exist in the lookup table create a new row
                    if (id == null)
                    {
                        id = new UniqueID(tableName, idField, 1);
                        // since this is a new entry add it
                        this.UniqueIDs.Add(id);
                    }
                    else
                    {
                        // set the state to modified
                        this.Entry(id).State = System.Data.EntityState.Modified;
                    }
                }
                entry.CurrentValues[tableName + "ID"] = id.NextID;
                id.NextID = id.NextID + 1;
            }

        }
        return base.SaveChanges();
    } 
```

# c# - AjaxControlToolkit PieChart 未正确呈现

> ID：15012741
> 
> 赞同：2
> 
> 时间：2013-02-21T21:40:21.747
> 
> 标签：c#, asp.net, ajaxcontroltoolkit, pie-chart

AjaxControlToolkit 的 PieChart 是否存在错误，或者我忘记了什么。使用图书馆示例站点提供的示例饼图，我使用以下结构：

```
<ajaxToolkit:PieChart ID="piePassFail" runat="server" ChartHeight="300" ChartWidth="450"
                      ChartTitle="Widget Production in the world %" ChartTitleColor="#0E426C">
        <PieChartValues>
            <ajaxToolkit:PieChartValue Category="India" Data="70"
                         PieChartValueColor="#D08AD9" />
            <ajaxToolkit:PieChartValue Category="United States" Data="30"
                         PieChartValueColor="#0E426C" />
        </PieChartValues>
</ajaxToolkit:PieChart> 
```

但是，只有两个值并不能正确呈现图表。我已经在 IE9 和 FF11 中验证了它。如果我添加第三个值并将数据调整为总计 100，我就是金。根据[AjaxToolkit 库的示例站点](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/PieChart/PieChart.aspx)，我认为 PieChart 应该支持 1 个或多个数据元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:39:56.637

在没有收到 SO 社区的回复后，我在[ASP.Net 论坛上](http://forums.asp.net/post/5323917.aspx)发帖。一位用户回复说这确实是一个错误，昨天[Codeplex的另一位用户偶然报告了这个错误。](http://ajaxcontroltoolkit.codeplex.com/workitem/27373)

到目前为止，它已经在 IE9、IE10 和 FF11 中进行了复制。

# matlab - Matlab 计数器在某个值处停止计数器

> ID：15012745
> 
> 赞同：-1
> 
> 时间：2013-02-21T21:40:52.573
> 
> 标签：matlab, counter

我正在使用 Matlab，并且我已经实现了一个阈值函数来勾选一个计数器来做我需要它做的事情。**我想知道是否有一种方法可以让计数器在达到某个值（最大值或最小值）后停止计数**，也就是说……我的计数器已经达到 40，现在我不想再超过阈值了被计算在内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:55:10.600

也许是这样的：

```
counter = 0;    
for i = 1:100
    if(condition)
        doSomething();
        counter = counter + 1;
    end
    if(counter == 40)
         break;
    end
end 
```

或者

```
counter = 0;    
for i = 1:100
    if(condition)
        doSomething();
        if(counter < 40)
            counter = counter + 1;
        end
    end
end 
```

?

取决于你的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T23:25:44.803

另一个（更简单）的选择是使用`while`循环：

```
counter=0;
    while counter<=40
         if condition==true
             counter=counter+1
             DoSomething ()
         end
    end 
```

# silverlight - Silverlight RTL Support

> ID：15012748
> 
> 赞同：1
> 
> 时间：2013-02-21T21:40:57.360
> 
> 标签：silverlight, localization, right-to-left

I know Silverlight 4 added support for RTL languages through the FlowDirection property.

Being new to RTL I just want to make sure I understand what should happen when I set the FlowDirection property. I noticed that the text alignment for the TextBoxes are now right aligned and the whole UI basically mirrors itself by switching everything that was on the left over to the right. So this all seems to be working fine. However, when entering text in a Textbox, surely the text should complete from right to left now as well. So I if enter the word 'run' in a TextBox with FlowDirection set to RTL, then surely it should read 'nur' and not 'run'? Is my understanding correct, but currently the TextBox still displays it as 'run' even thought it is right-aligned in the control itself.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T04:13:39.367

文本的 RTL-ness 将自动由 unicode 文本本身决定。因此，如果您将一些阿拉伯语文本放入 TextBox，无论是否设置了 FlowDirection，它都会处于正确的方向 (RTL)。FlowDirection 仅用于镜像 UI，而不是更改文本。[显然，冒号](https://stackoverflow.com/questions/5325317/strage-effect-in-silverlight-with-checkbox-and-flow-direction)也有一些巧妙的特殊处理。

所以基本上：是的，这是正确的，按预期工作。

# android - Android YouTube api v3 - 方向

> ID：15012754
> 
> 赞同：10
> 
> 时间：2013-02-21T21:41:12.463
> 
> 标签：android, api, youtube, orientation

使用 YouTubeBaseActivity、YouTubePlayerView 和 YouTubePlayer 启动并运行示例活动非常简单。我在定位方面遇到了问题，找不到任何文档或示例代码。当我在播放视频时切换屏幕是空白的。

在 onCreate()、onPause()、onSaveInstanceState() 和 onRestoreInstanceState() 中，为了让视频继续播放，正确的做法是什么？

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-05-09T05:09:57.860

变量

```
@SuppressLint("InlinedApi")
private static final int PORTRAIT_ORIENTATION = Build.VERSION.SDK_INT < 9
        ? ActivityInfo.SCREEN_ORIENTATION_PORTRAIT
        : ActivityInfo.SCREEN_ORIENTATION_SENSOR_PORTRAIT;

@SuppressLint("InlinedApi")
private static final int LANDSCAPE_ORIENTATION = Build.VERSION.SDK_INT < 9
        ? ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE
        : ActivityInfo.SCREEN_ORIENTATION_SENSOR_LANDSCAPE;

private YouTubePlayer mPlayer = null;
private boolean mAutoRotation = false; 
```

创建时

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mAutoRotation = Settings.System.getInt(getContentResolver(),
            Settings.System.ACCELEROMETER_ROTATION, 0) == 1;
} 
```

实现 OnInitializedListener

```
@Override
public void onInitializationSuccess(YouTubePlayer.Provider provider, YouTubePlayer player,
        boolean wasRestored) {
    mPlayer = player;
    player.setOnFullscreenListener(this);

    if (mAutoRotation) {
        player.addFullscreenControlFlag(YouTubePlayer.FULLSCREEN_FLAG_CONTROL_ORIENTATION
                | YouTubePlayer.FULLSCREEN_FLAG_CONTROL_SYSTEM_UI
                | YouTubePlayer.FULLSCREEN_FLAG_ALWAYS_FULLSCREEN_IN_LANDSCAPE
                | YouTubePlayer.FULLSCREEN_FLAG_CUSTOM_LAYOUT);
    } else {
        player.addFullscreenControlFlag(YouTubePlayer.FULLSCREEN_FLAG_CONTROL_ORIENTATION
                | YouTubePlayer.FULLSCREEN_FLAG_CONTROL_SYSTEM_UI
                | YouTubePlayer.FULLSCREEN_FLAG_CUSTOM_LAYOUT);
    }
} 
```

实现 onConfigurationChanged

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        if (mPlayer != null)
            mPlayer.setFullscreen(true);
    } 
    if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        if (mPlayer != null)
            mPlayer.setFullscreen(false);
    }
}

@Override
public void onFullscreen(boolean fullsize) {
    if (fullsize) {
        setRequestedOrientation(LANDSCAPE_ORIENTATION);
    } else {
        setRequestedOrientation(PORTRAIT_ORIENTATION);
    }
} 
```

清单

```
 <activity
    android:name="com.sample.android.YouTubePlayerActivity"
    android:configChanges="keyboardHidden|orientation|screenSize"
    android:screenOrientation="sensor"
    android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" >
</activity> 
```

我制作了使用最新 youtube api 的示例活动。

此源处理“**方向问题**”、“**媒体量问题**”、“ **Youtube 网址解析问题**”

1.  这是示例应用程序的 git 项目

    [https://github.com/TheFinestArtist/YouTubePlayerActivity](https://github.com/TheFinestArtist/YouTubePlayerActivity)

2.  我还制作了示例应用程序，您可以下载

    [https://play.google.com/store/apps/details?id=com.thefinestartist.ytpa.sample](https://play.google.com/store/apps/details?id=com.thefinestartist.ytpa.sample)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-03T14:03:14.437

把这个留给其他人。最好的艺术家的回答也对我有用，但由于我在片段中使用视频播放器并且还必须支持 AppCompatLibrary，这就是我能够得到的工作：

**YouTubePlayerActivityFragment.java**

```
public class YouTubePlayerActivityFragment extends YouTubePlayerSupportFragment implements
    YouTubePlayer.OnFullscreenListener {

@SuppressLint("InlinedApi")
private static final int PORTRAIT_ORIENTATION = Build.VERSION.SDK_INT < 9
        ? ActivityInfo.SCREEN_ORIENTATION_PORTRAIT
        : ActivityInfo.SCREEN_ORIENTATION_SENSOR_PORTRAIT;

@SuppressLint("InlinedApi")
private static final int LANDSCAPE_ORIENTATION = Build.VERSION.SDK_INT < 9
        ? ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE
        : ActivityInfo.SCREEN_ORIENTATION_SENSOR_LANDSCAPE;

private YouTubePlayer.OnFullscreenListener fullScreenListener = null;
private YouTubePlayer yPlayer = null;
private boolean mAutoRotation = false;

public static YouTubePlayerActivityFragment newInstance(String videoID, String apiKey) {
    YouTubePlayerActivityFragment fragment = new YouTubePlayerActivityFragment();
    Bundle bundle = new Bundle();
    bundle.putString("video_id", videoID);
    bundle.putString("api_key", apiKey);
    fragment.setArguments(bundle);
    fragment.init();
    return fragment;
}

public YouTubePlayerActivityFragment() {

}

@Override
public void onCreate(Bundle var1) {
    super.onCreate(var1);
    mAutoRotation = Settings.System.getInt(getActivity().getContentResolver(), Settings.System.ACCELEROMETER_ROTATION, 0) == 1;
    fullScreenListener = this;
}

private void init() {
    initialize(getArguments().getString("api_key"), new YouTubePlayer.OnInitializedListener() {
        @Override
        public void onInitializationSuccess(YouTubePlayer.Provider provider, YouTubePlayer youTubePlayer, boolean wasRestored) {
            yPlayer = youTubePlayer;
            youTubePlayer.setOnFullscreenListener(fullScreenListener);
            if (mAutoRotation) {
                youTubePlayer.addFullscreenControlFlag(YouTubePlayer.FULLSCREEN_FLAG_CONTROL_ORIENTATION
                        | YouTubePlayer.FULLSCREEN_FLAG_CONTROL_SYSTEM_UI
                        | YouTubePlayer.FULLSCREEN_FLAG_ALWAYS_FULLSCREEN_IN_LANDSCAPE
                        | YouTubePlayer.FULLSCREEN_FLAG_CUSTOM_LAYOUT);
            } else {
                youTubePlayer.addFullscreenControlFlag(YouTubePlayer.FULLSCREEN_FLAG_CONTROL_ORIENTATION
                        | YouTubePlayer.FULLSCREEN_FLAG_CONTROL_SYSTEM_UI
                        | YouTubePlayer.FULLSCREEN_FLAG_CUSTOM_LAYOUT);
            }

            if (!wasRestored) {
                yPlayer.loadVideo(getArguments().getString("video_id"));
            }
        }

        @Override
        public void onInitializationFailure(YouTubePlayer.Provider provider, YouTubeInitializationResult youTubeInitializationResult) {

        }
    });
}

@Override
public void onFullscreen(boolean isFullSize) {
    if (isFullSize) {
        getActivity().setRequestedOrientation(LANDSCAPE_ORIENTATION);
    } else {
        getActivity().setRequestedOrientation(PORTRAIT_ORIENTATION);
    }
} 
```

# jquery - 使用 jquery 由 ajax 收取的动态选定元素中的单击事件

> ID：15012757
> 
> 赞同：0
> 
> 时间：2013-02-21T21:41:19.723
> 
> 标签：jquery, ajax, events, css-selectors

我需要在表格中捕获带有 ajax 的元素的点击事件。

获取动态内容后，我可以看到带有元素总数的警报结果： alert($(".link").length);

我选择的所有元素都有“链接”类，我需要知道点击了哪些元素。

我试过 -> $(".link").click(function()... 但我发现只捕获了已经存在的元素。所有由 ajax 收费的元素都被忽略了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:47:33.757

Could use some code to be 100% sure, but this works and with fiddle.

HTML:

```
<table>
    <tr class="list"><td>One</td></tr>
    <tr class="list"><td>Two</td></tr>
    <tr class="list"><td>Three</td></tr>
</table> 
```

JS:

```
$("table").delegate('.list', 'click', function() {  
    var whichOne = $(this).text();
    alert("Handler for .click() called for " + whichOne);
}); 
```

[http://jsfiddle.net/ADg2P/2/](http://jsfiddle.net/ADg2P/2/)

UPDATE: Use delegate instead, missed the ajax part.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:45:23.493

看看`on`jQuery提供的方法；或者`live`如果您使用的是旧版本的 jQuery。参考[这里](http://api.jquery.com/on/)。

绑定步骤如下所示：

```
$('.link').on('click', function() {
   // your code here
}); 
```

这会将现有元素以及 AJAX 提供的新元素绑定到您指定的单击事件。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:46:17.020

`on`如果您使用的是 jQuery 1.7+，请使用该方法。

阅读这篇出色的文章 - [http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html](http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html)

# mysql - 来自右表的 MySQL Left Join 和 NULL 列

> ID：15012769
> 
> 赞同：3
> 
> 时间：2013-02-21T21:41:49.013
> 
> 标签：mysql, null, left-join

我有以下两个需要加入的 MySQL 表：

```
CREATE TABLE `tbl_L` (
  `datetime` datetime NOT NULL,
  `value` decimal(14,8) DEFAULT NULL,
  `series_id` int(11) NOT NULL,
  PRIMARY KEY (`series_id`,`datetime`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

CREATE TABLE `tbl_R` (
  `datetime` datetime NOT NULL,
  `value` decimal(14,8) DEFAULT NULL,
  `series_id` int(11) NOT NULL,
  PRIMARY KEY (`series_id`,`datetime`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

我需要从 tbl_L 中选择所有日期和值，还需要选择 tbl_R 中与 tbl_L 中的条目具有相同日期时间的值。一个简单的连接，如下所示：

```
SELECT tbl_L.datetime AS datetime, tbl_L.value AS val_L, tbl_R.value AS val_R 
FROM tbl_L 
    LEFT JOIN tbl_R 
        ON tbl_L.datetime = tbl_R.datetime
WHERE 
   tbl_L.series_id = 1 AND tbl_R.series_id = 2 ORDER BY tbl_L.datetime ASC 
```

不起作用，因为它只会返回 tbl_L 和 tbl_R 中的日期时间（因为 WHERE 子句中提到了正确的表）。

将查询修改为如下所示：

```
SELECT tbl_L.datetime AS datetime, tbl_L.value AS val_L, tbl_R.value AS val_R 
FROM tbl_L 
    LEFT JOIN tbl_R 
        ON tbl_L.datetime = tbl_R.datetime 
           AND tbl_R.series_id = 2 
           AND tbl_L.series_id = 1
ORDER BY tbl_L.datetime ASC; 
```

显着减慢它（从几毫秒到几长秒）。

**编辑**：并且实际上也不起作用。我将澄清我需要实现的目标：

假设表中有以下数据：

```
mysql> SELECT * FROM tbl_R;
+---------------------+------------+-----------+
| datetime            | value      | series_id |
+---------------------+------------+-----------+
| 2013-02-20 19:21:00 | 5.87000000 |         2 |
| 2013-02-20 19:22:00 | 5.90000000 |         2 |
| 2013-02-20 19:23:00 | 5.80000000 |         2 |
| 2013-02-20 19:25:00 | 5.65000000 |         2 |
+---------------------+------------+-----------+
4 rows in set (0.00 sec)

mysql> SELECT * FROM tbl_L;
+---------------------+-------------+-----------+
| datetime            | value       | series_id |
+---------------------+-------------+-----------+
| 2013-02-20 19:21:00 | 13.16000000 |         1 |
| 2013-02-20 19:23:00 | 13.22000000 |         1 |
| 2013-02-20 19:24:00 | 13.14000000 |         1 |
| 2013-02-20 19:25:00 | 13.04000000 |         1 |
+---------------------+-------------+-----------+
4 rows in set (0.00 sec) 
```

同样，我需要将 tbl_L 中的所有条目与**tbl_R**中在日期时间方面匹配的条目连接起来**，**否则为 NULL。

我的输出应该是这样的：

```
+---------------------+-------------+-------------+
| datetime            | val_L       | val_R       |
+---------------------+-------------+-------------+
| 2013-02-20 19:21:00 | 13.16000000 | 5.870000000 |
| 2013-02-20 19:23:00 | 13.22000000 | 5.800000000 |
| 2013-02-20 19:24:00 | 13.14000000 | NULL        |
| 2013-02-20 19:25:00 | 13.04000000 | 5.650000000 |
+---------------------+-------------+-------------+ 
```

再次感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T22:34:31.610

您可以通过仅将条件移动`tbl_R`到联接`ON`子句中来获取所需的数据，如下所示：

```
SELECT tbl_L.datetime AS datetime, tbl_L.value AS val_L, tbl_R.value AS val_R 
FROM tbl_L 
LEFT JOIN tbl_R 
    ON tbl_L.datetime = tbl_R.datetime
        AND tbl_R.series_id = 2
WHERE 
tbl_L.series_id = 1 ORDER BY tbl_L.datetime ASC 
```

此外，没有用于查询的索引 on `tbl_L`。添加索引`tbl_L.series_id`将有助于查询的性能。

# jquery-mobile - 如何在 Jquery Mobile 中禁用选定的按钮

> ID：15012772
> 
> 赞同：0
> 
> 时间：2013-02-21T21:41:54.913
> 
> 标签：jquery-mobile

我有 2 个导航栏，一个页眉和一个页脚。当我在标题上选择一个按钮时，它突出显示。但是当我在页脚上选择另一个按钮时，页脚上的一个新按钮也会突出显示。选择此新按钮时如何取消选择标题导航栏上的按钮，反之亦然？

```
<div data-role="navbar" data-id="mynavbar" id="myheader">
<>...buttons<>

<div data-role="navbar" data-id="mynavbar" id="myfooter">
<>... buttons<> 
```

# jquery - 使用jQuery监听点击事件的最语义正确的方法是什么

> ID：15012776
> 
> 赞同：0
> 
> 时间：2013-02-21T21:42:07.097
> 
> 标签：jquery, coding-style, click

伙计们，您能否给我一些关于使用 jQuery 监听点击事件的正确方法以及每种方法的优缺点的见解：

```
.click(function() { ... }); 
```

或者

```
.on('click', function () { ... }); 
```

我想确保我的代码是一致的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:54:12.427

来自 jQuery`click` [文档](http://api.jquery.com/click/)：

> 这个方法是一个捷径`.on('click', handler)`

所以使用`.click`and`.on`那种简单的形式基本上没有区别。但是，通过使用，`on`您可以获得其他选项。例如，您可以传入其他参数，例如 a`selector`或`data`。例如：`.on( events [, selector ] [, data ], handler(eventObject) )`通过传入一个`selector`例子，你可以创建一个委托事件，这样即使在 DOM 中添加了新项目，该事件仍然会被触发。仅出于这个原因，我倾向于几乎总是使用`.on`. 但同样，使用`.click(function() {`or`.on('click', function () {`是功能等效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:54:35.233

我想有人可能会说这`.on('click')`是微不足道的“更好”，因为它读起来更像英语而不是`.click()`，并且它没有另一个函数调用的额外（微小）开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T22:00:07.690

所有的评论似乎都耗尽了两者的想法

```
.click(function() { 
```

和

```
.on('click', function () { 
```

是等效的（参见[http://api.jquery.com/click/](http://api.jquery.com/click/)）。

虽然编码风格本身可能是主观的，但一致性可能更容易解决。使用`.on('click', function() {`版本有机会更加一致，因为您可以通过`on()`方法传递各种事件。它有更多用例的事实增加了它的可用性并可能增加一致性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T22:46:14.810

在元素本身上使用 .click() 或 .on('click') 完全相同，只是一种简写方法。

如果您需要一种一致的方式来绑定单击事件，那么我认为您应该始终使用 .on()..... 因为它也可以用于委托事件。这样，您可以使用此 .on() 进行所有事件侦听，而不必在使用 .click()、.submit()、.delegate()、.live() 等之间切换。

不仅如此，还有可读性。.('on', 'click'.....比其他委托方法更具可读性。

# ruby - Veewee 安装错误

> ID：15012782
> 
> 赞同：1
> 
> 时间：2013-02-21T21:42:21.667
> 
> 标签：ruby, virtualization, virtualbox, vagrant, veewee

我正在尝试为 vagrant 安装 veewee，以便我可以利用它用来创建基本框的自动化。我可能做错了什么，但我不这么认为...

这是我正在运行的内容：

```
gem install veewee
ERROR:  While executing gem ... (Gem::DependencyError)
    Unable to resolve dependencies: vagrant requires json (~> 1.5.1) 
```

我还尝试了以下方法：

```
sudo gem install veewee
ERROR:  While executing gem ... (Gem::DependencyError)
    Unable to resolve dependencies: cucumber requires json (>= 1.4.6); gherkin requires json (>= 1.7.6); vagrant requires json (~> 1.5.1) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T03:10:10.887

这是因为 vagrant 需要旧版本的 json（开发人员说是为了与 windows 兼容），而 gherkin 最近开始需要一些新版本。要解决它，您应该：

1.  确保删除任何以前安装的 json gem：

    `gem uninstall json`

2.  首先安装 vagrant，以便它下载旧的 json：

    `gem install vagrant`

3.  安装一个旧的 gherkin gem：

    `gem install gherkin --version '2.11.5'`

4.  现在您可以安装 veewee：

    `gem install veewee`

我今天经历了这个问题，这是对我有用的顺序。参考： [https ://github.com/jedi4ever/veewee/issues/518](https://github.com/jedi4ever/veewee/issues/518)

我希望它对你有帮助。

最好的祝福，

里卡多。

# actionscript-3 - AS3 AIR URLLoader POST

> ID：15012786
> 
> 赞同：3
> 
> 时间：2013-02-21T21:42:27.593
> 
> 标签：actionscript-3, actionscript, air

我正在开发我的第一个 AIR 应用程序（从 PHP/Javascript 转移），并且正处于我想将一些数据从应用程序发送回我服务器上的 PHP 脚本的阶段。我有以下内容：

```
var url:String = "PHP URL HERE";
var request:URLRequest = new URLRequest(url);

var requestVars:URLVariables = new URLVariables();
requestVars.test = "1234";

request.data = requestVars;
request.method = URLRequestMethod.POST;
request.contentType = "application/xml;charset=utf-8";

var urlLoader:URLLoader = new URLLoader();
urlLoader.dataFormat = URLLoaderDataFormat.TEXT;
urlLoader.addEventListener(Event.COMPLETE, processSERPS, false, 0, true);
urlLoader.load(request); 
```

我最初在服务器端 PHP 脚本中确实有其他内容，但为了调试，我只是将其更改为转储 REQUEST 数组。

使用上面的代码，它只会返回任何内容：

```
Array
(
) 
```

但是，如果我将请求方法更改为 Get：

```
request.method = URLRequestMethod.GET; 
```

我收到：

```
Array
(
    [test] => 1234
) 
```

这告诉我代码是正确的，只是由于某种原因没有发送帖子参数。

我只想更改代码以使用 GET 变量，但不幸的是我需要发送的数据太大，因此需要 POST。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T23:34:55.647

对于[URLRequest.contentType](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html#contentType)：

> 如果 data 属性的值是 URLVariables 对象，则 contentType 的值必须是 application/x-www-form-urlencoded。

这是默认值，因此只需删除您的分配即可。

# wpf - 自动生成的 DataGridCheckBoxColumn 的 IsEnabled 绑定

> ID：15012787
> 
> 赞同：2
> 
> 时间：2013-02-21T21:42:35.027
> 
> 标签：wpf, binding, autogeneratecolumn, isenabled

我在视图模型中有一个 DataTable，DataGrid 绑定到该 DataTable，选项`AutoGenerateColumns="True"`和`AutoGeneratingColumn`事件在视图代码隐藏中实现。在这种情况下，我决定显示或不显示某些特定列，并为自动生成的列配置一些附加属性。在运行时，所有这些列似乎都绑定到适当的 DataTable 列。问题是 - 我如何为`IsEnabled`新添加的复选框的属性设置额外的绑定`DataGridCheckBoxColumn`？

# java - Java jList NullPointerException 错误

> ID：15012790
> 
> 赞同：0
> 
> 时间：2013-02-21T21:42:50.047
> 
> 标签：java, swing, runtime-error, jlist

**错误：**

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at test.factory.MainWindow.setFuncList(MainWindow.java:160)
    at test.factory.MainWindow.<init>(MainWindow.java:22)
    at test.factory.MainWindow$2.run(MainWindow.java:151)
    at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:721)
    at java.awt.EventQueue.access$200(EventQueue.java:103)
    at java.awt.EventQueue$3.run(EventQueue.java:682)
    at java.awt.EventQueue$3.run(EventQueue.java:680)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:691)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

**代码：**

```
TestFactory tf = new TestFactory();
ArrayList<Function> fList = tf.getFunctions();
DefaultListModel<Function> dFuncList = new DefaultListModel();
fListPane.setModel(dFuncList);
for(Function f : fList) {
    dFuncList.addElement(f);
} 
```

* * *

**问题：**

现在，如果你发现错误很好，但我的问题是。如何解析错误文本以查找错误的来源？我已经习惯了`missing ';' at line 24 of C:\filename`

**更新：** fList 有两个元素，所以不为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:48:37.163

错误转储是一个堆栈跟踪，所以我倾向于发现最好从顶部开始并向下工作。在这种情况下，您在 MainWindow.java 的第 160 行的 setFuncList 似乎正在尝试使用为空的对象（可能尚未初始化？）。

更新：有效的代码示例

```
class Function {

    int i;

    public Function(int myI) {
        this.i = myI;
    }

    @Override
    public String toString() {
        return "i=" + this.i;
    }
} 
```

用于：

```
ArrayList<Function> fList = new ArrayList<>();
fList.add(new Function(1));
fList.add(new Function(2));

DefaultListModel<Function> dFuncList = new DefaultListModel();
jList2.setModel(dFuncList);
for(Function f : fList) {
    dFuncList.addElement(f);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:08:28.037

所以基本上从顶部查看堆栈跟踪，它将列出导致您收到错误的已发生调用。仔细查看代码中列出的行。如果您看不到任何明显的错误，您可以根据错误添加一些额外的测试。即在导致错误的行之前检查某些对象是否为空，我发现打印输出是一种简单的方法。您也可以使用调试器，我使用**jswat**但仅在我真正需要时才将其断开。

希望那是你所追求的

@orangegoat 很好地分解了如何解释堆栈跟踪，如果这是你想要的

还有一个链接到 jswat [http://code.google.com/p/jswat/](http://code.google.com/p/jswat/)

# c++ - 引用变量调用析构函数

> ID：15012794
> 
> 赞同：0
> 
> 时间：2013-02-21T21:42:59.753
> 
> 标签：c++, variables, reference, singleton, destructor

考虑以下代码：

```
#include <iostream>

class Singleton
{
public:
    // GetInstance returns an instance to an existing Singleton object
    static Singleton& GetInstance()
    {
        static Singleton instance;
        return instance;
    }

    // Destructor
    ~Singleton()
    {
        std::cout << "Singleton destructor" << std::endl;
    }
private:
    // Private constructor
    Singleton()
    {
        std::cout << "Singleton constructor" << std::endl;
    }
};

int main()
{
    Singleton mySingleton = Singleton::GetInstance();

    return 0;
} 
```

这个的输出是：

```
Singleton constructor
Singleton destructor
Singleton destructor 
```

似乎`mySingleton`正在清理引用变量，因此调用了析构函数两次。有什么办法可以避免这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:44:41.937

您正在这里制作实例的副本：

```
Singleton mySingleton = Singleton::GetInstance(); 
```

您也希望将复制构造函数和赋值运算符设为私有，这将迫使您进行引用：

```
Singleton& mySingleton = Singleton::GetInstance(); 
```

# php - PHP（或 jQuery，如果需要）：将其他表中的相关 MySQL 记录作为 JSON 输出？

> ID：15012799
> 
> 赞同：0
> 
> 时间：2013-02-21T21:43:10.603
> 
> 标签：php, mysql, json

我有两张桌子：

表格1：

```
Make       Model 1 ID      Model 2 ID      Model 3 ID
----       ----------      ----------      ----------
Ford       1               4               7
Chevrolet  2               3               5
Dodge      6               8               9 
```

表 2：

```
ID         Model            Engine
----       -----            ------
1          F-150            Triton V8
2          Silverado        Vortec V8
3          Corvette         LS9 V8
4          Fusion           Duratec I4
5          Camaro           LSA V8
6          Ram              Hemi V8
7          Mustang          Modular V8
8          Grand Caravan    Pentastar V6
9          Challenger       Hemi V8 
```

我希望将链接数据输出（你是这么说的吗？我对编程术语有点陌生。对不起。）作为 JSON 使用 PHP，所以输出看起来像这样（或者如果我的输出看起来非常相似） JSON 语法错误）：

```
 {
  [
   {
    "make": "Ford",  
    "models": 
     [ 
      { 
      "ID": "1",
      "info": 
         {
         "model": "F-150",
         "engine": "Triton V8", 
         }
      },
      { 
      "ID": "4",
      "info": 
         {
         "model": "Fusion",
         "engine": "Duratec I4", 
         }
      },
      { 
      "ID": "7",
      "info": 
         {
         "model": "Mustang",
         "engine": "Triton V8", 
         }
      },
     ] 
   },
   {
    "make": "Chevrolet",  
    "models": 
     [ 
      { 
      "ID": "2",
      "info": 
         {
         "model": "Silverado",
         "engine": "Vortec V8", 
         }
      },
      { 
      "ID": "3",
      "info": 
         {
         "model": "Corvette",
         "engine": "LS9 V8", 
         }
      },
      { 
      "ID": "5",
      "info": 
         {
         "model": "Camaro",
         "engine": "", 
         }
      },
     ] 
   },   {
    "make": "Dodge",  
    "models": 
     [ 
      { 
      "ID": "6",
      "info": 
         {
         "model": "Ram",
         "engine": "Hemi V8", 
         }
      },
      { 
      "ID": "8",
      "info": 
         {
         "model": "Grand Caravan",
         "engine": "Pentastar V6", 
         }
      },
      { 
      "ID": "9",
      "info": 
         {
         "model": "Challenger",
         "engine": "Hemi V8", 
         }
      },
     ] 
   }
  ]
} 
```

问题是，你如何使用 PHP 做到这一点？感谢您花时间阅读这篇相当长的文章，并提前感谢您尝试提出解决方案。

如果您想建议使用 jQuery 的解决方案，那也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:51:25.983

你的数据库是错误的。试试这个结构：

```
MakeID Make
------ ----
1      Ford
2      Chevrolet
3      Dodge

ModelID MakeID Model          Engine
------- ------ -------------- ------
1       1      F-150          Triton V8
2       2      Silverado      Vortec V8
3       2      Corvette       LS9 V8
4       1      Fusion         Duratec I4
5       2      Camaro         LSA V8
6       3      Ram            Hemi V8
7       1      Mustang        Modular V8
8       3      Grand Caravan  Pentastar V6
9       3      Challenger     Hemi V8 
```

现在您可以执行以下操作：

```
$sql = mysql_query("select * from `table1` join `table2` using (`MakeID`)");
$out = Array();
while($car = mysql_fetch_assoc($sql)) {
    if( !isset($out[$car['MakeID']])) {
        $out[$car['MakeID']] = Array("make"=>$car['Make'],"models"=>Array());
    }
    $out[$car['MakeID']]['models'][] = Array(
        "ID"=>$car['ModelID'],
        "info":Array(
            "model"=>$car['Model'],
            "engine"=>$car['Engine']
        )
    );
}
$out = array_values($out);
echo json_encode($out); 
```

# git - Git Archive ZIP Specified Files/Folders

> ID：15012801
> 
> 赞同：0
> 
> 时间：2013-02-21T21:43:18.177
> 
> 标签：git, git-archive

I am trying to use `git archive` to archive only the files I specify and I am getting `fatal: Not a valid object name` error. Could someone provide an example?

My current code:

`git archive -o ./archive/archive.zip ./folder1 ./folder2`

The result should be an archive.zip file with folder1 and folder2 as the sub directories.

Thanks for the help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:47:43.210

You need to specify a commit or tree to archive, e.g.:

```
git archive -o ./archive/archive.zip master folder1 folder2 
```

or:

```
git archive -o ./archive/archive.zip HEAD folder1 folder2 
```

# ssas - How should one define a second date hierarchy in SSAS?

> ID：15012807
> 
> 赞同：1
> 
> 时间：2013-02-21T21:44:08.183
> 
> 标签：ssas, relationship, cube

I have a time table and a sales fact table with multiple dates (order received date, ship date).

I want to define a hierarchy on the order received date and another hierarchy on the ship date.

The cube editor in visual studio allows me to define multiple relationships on these table, but I don't see a way in the hierachy editor to define which relationship to use for the hierarchy.

Am I missing something, or am I supposed to insert the time table into the model twice, which single relationships on each?

Thanks, --sw

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:26:25.523

这不是你使用角色扮演维度的地方吗？因此，您拥有了包含所有层次结构的日期维度，然后您再次将其加入到发货日期的事实表中，现在您有了一个包含所有日期维度层次结构的“日期（发货日期）”维度。

[http://www.msbiguide.com/2012/05/role-playing-dimensions-in-ssas/](http://www.msbiguide.com/2012/05/role-playing-dimensions-in-ssas/)

[http://msdn.microsoft.com/en-us/library/ms174487(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms174487(v=sql.90).aspx)

[http://kimballgroup.forumotion.net/t1165-role-playing-dimensions](http://kimballgroup.forumotion.net/t1165-role-playing-dimensions)

顺便说一句，您只需创建一次 Date 维度，它每次角色扮演时都会在多维数据集中获得一个新别名。

# java - 为什么堆大小增加时使用的堆数量会减少？

> ID：15012810
> 
> 赞同：1
> 
> 时间：2013-02-21T21:44:27.190
> 
> 标签：java

我正在将一个大文本文件读入一个 ArrayDeque，

```
 BufferedReader br = new BufferedReader(new FileReader(fname));
    String line=null;
    //allocate an ArrayDeque with enough room for 50M lines.
    ArrayDeque<String[]> inMemory = new ArrayDeque<String[]>(50000000);
    while((line=br.readLine())!=null){
        String[] lineArr = line.split("\t");
        inMemory.add(lineArr);
    }
    br.close(); 
```

我运行它

```
java -server -Xmx128g -cp target/stackoverflowquestion-1.0-SNAPSHOT-jar-with-dependencies.jar com.stackoverflow.Question 
```

当我运行代码时，我打开了[visualvm](http://visualvm.java.net/)并观察内存是如何被用完的：

![视觉虚拟机](../Images/965eb5b00d92183db0b21c384d427a9f.png)

为什么使用的堆数量会周期性减少？

**编辑：**我将字符串 [] 更改为字符串。现在它没有发生。lineArrs 不会在每次循环迭代中消失。

```
BufferedReader br = new BufferedReader(new FileReader(fname));
String line=null;
//allocate an ArrayDeque with enough room for 50M lines.
ArrayDeque<String> inMemory = new ArrayDeque<String>(50000000);
while((line=br.readLine())!=null){
    inMemory.add(line);
}
br.close(); 
```

![在此处输入图像描述](../Images/e7e0bb54a53ae84bc80b05e1cf87ee76.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:49:50.233

BufferedReader 是一个与 FileReader 对象一起工作的抽象层。为了提高效率，它很可能会在您滚动输入时复制或缓冲 FileReader 数据的某些部分。

我们希望库为我们提供一个高效的 BufferedReader，一旦它被认为不相关，它可能会丢弃这些数据。垃圾收集器会定期清除这些不相关的数据。

这是我能想到的周期性堆大小减小的最合理的原因。

# wcf - IIS 如何知道二进制文件在 BIN 目录中？这是在哪里定义的？

> ID：15012817
> 
> 赞同：0
> 
> 时间：2013-02-21T21:44:57.753
> 
> 标签：wcf, iis, configuration

IIS WCF Web 服务引用 BIN 文件夹中的 .dll。什么配置了这个位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:04:03.360

虽然我从来没有理由自己更改它，但我相信可以从配置文件的 system.web 部分（CodeSubDirectories 属性）中完成：

[http://msdn.microsoft.com/en-us/library/system.web.configuration.compilationsection.aspx](http://msdn.microsoft.com/en-us/library/system.web.configuration.compilationsection.aspx)

# c++ - 多个字符串存储在不同的变量 C++

> ID：15012820
> 
> 赞同：1
> 
> 时间：2013-02-21T21:45:06.430
> 
> 标签：c++

这是我第一次在这里发帖，所以我会尽量明确我的问题。所以我需要在变量中存储带有空格的不同字符串。我正在使用 eclipse，但我遇到了问题。

***这是代码***

```
using namespace std;
string p_theme;   
string p_titre;
int p_anneeEdition;
string p_pays;
string p_auteur;
string p_editeur;
string p_isbn;

cout << "Veuillez saisir le thème:" << endl;
getline(cin, p_theme, '\n');

cout << "Veuillez saisir le titre:" << endl;
getline(cin, p_titre, '\n');

.... 
```

***这就是控制台向我显示的内容***

```
Veuillez saisir le thème:
Veuillez saisir le titre: 
```

问题是我没有时间在第二个 cout 之前输入字符串“Theme”。我尝试了不同的方式，使用 char 缓冲区它不起作用我进入一个循环。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:49:05.700

A `getline` which does nothing can have many reasons

*   A failbit was set (because reading of an `int` or similar has failed) in which case all calls to read from cin get ignored.
*   You have unread chars remaining on the input buffer. For example "\n" (which can be if you read a `std::string` with `operator>>`).

To handle both cases, insert

```
cin.clear();
cin.ignore(numeric_limits<streamsize>::max(), '\n'); 
```

before each call of getline (and add `#include <limits>` at the top of your file).

This is surely an overkill and if you are careful, this can be reduced.

*   Check each input if it succeeds (like `int i; if (std::cin >> i) { /* ok */ }`)
*   Don't read a `std::string` without `getline` (for example `operator>>`), unless you later call `cin.ignore(...)`.

If you do all this, the code should work as you already have it.

# php - 如何获取现有表名并将其与新创建的表名（PHP5）进行比较？

> ID：15012822
> 
> 赞同：0
> 
> 时间：2013-02-21T21:45:13.717
> 
> 标签：php, mysql

我写了一个简单的代码，它应该检查输入字段是否为空，如果不为空，则在该字段中输入的内容应该是新创建的数据库表的名称。但是我遇到了代码需要检查具有该名称的表是否已经存在的部分的问题。这是我到目前为止所拥有的：

```
include 'conn.php';

$entry_name = $_POST['entry_name'];

// Check if the field is empty

if(empty($_POST['entry_name'])) {
    echo "Please, fill the name field!";  
}

// If the field is full
else {
    // Check for the duplicated table names 

    $result = mysql_query(**???**);
    if($result == $entry_name) {
        die("Entry with that name already exists, choose a different name!");
    }

    // If there are no tables with entered name, create the new table
    else {
        $entry_name = mysql_real_escape_string($_POST['entry_name']);
        mysql_query("CREATE TABLE `" . $entry_name . "` ( first VARCHAR(30), second VARCHAR(30))");

        echo "$entry_name created successfully!";
    }

} 
```

带问号的部分是我不知道该怎么做的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:30:45.187

最好的方法是查询[信息模式](http://dev.mysql.com/doc/refman/5.0/en/schemata-table.html)数据库。它包含有关现有数据库和表的所有信息。但只有mysql 5。

```
SELECT * 
FROM  `TABLES` 
WHERE  `TABLE_SCHEMA` =  'your_database_name'
AND  `TABLE_NAME` =  'your_table_name' 
```

改变你`$result = mysql_query(**???**);`的

```
$result = mysql_query('SELECT * FROM  `TABLES` WHERE  `TABLE_SCHEMA` =  "your_database_name" AND  `TABLE_NAME` =  "'. $entry_name .'"); 
```

然后

```
if (mysql_numrows($result) !== 0) 
```

不要忘记更改`your_database_name`您**的**数据库名称
哦，不要忘记清理您的 $entry_name。[mysql_escape_string](http://www.php.net/manual/en/function.mysql-escape-string.php)

# c# - 透明选项卡控件显示为白色

> ID：15012827
> 
> 赞同：2
> 
> 时间：2013-02-21T21:45:29.587
> 
> 标签：c#, winforms

无论如何，我在标签控制方面有点困难。当我将一个新的选项卡控件拖到表单上时，它显示为白色，而不是我期望的灰色（系统颜色）。

当我查看属性时，它的颜色设置为网络透明。好的，所以它应该是透明的（它不会让它背后的任何东西显示出来）。手动将选项卡控件的背景颜色设置回系统灰色类型的作品，但顶部的选项卡仍显示为白色。我假设我也可以以某种方式改变它们的颜色，但是我很快就进入了从默认值更改这么多值的领域，我显然错过了一些类型的领域。我已经尽我所能搜索了各种“透明选项卡控件绘制为白色”，尽管我发现与 Windows 配置文件有关，但这似乎主要限于使用您在访问中访问的 vb 访问 2003。

我正在寻找任何解释：

*   我需要做什么才能正确使用选项卡控件的透明度
*   我误解为选项卡控件中透明度的目的
*   如何轻松地将选项卡控件适当部分的所有颜色更改为不透明。

我正在查看 MCTS 的 windows 窗体，所以请不要给出“你应该使用 X 代替”类型的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T02:27:01.250

不，变白当然是正常的。启用视觉样式时，TabControl 和 TabPage 使用主题颜色呈现。因此，这会使具有标准 Windows 主题的机器上的标签页变为白色。

是的，透明的默认背景颜色非常不寻常。除非您将 TabControl 的背景视为透明度，否则您肯定永远不会获得实际的透明度。逻辑非常复杂，与其试图解释它，我将仅粘贴 MSDN 解释：

> BackColor 属性的默认值是 Control.DefaultBackColor 属性的值，除非 UseVisualStyleBackColor 和 Application.RenderWithVisualStyles 属性值都为 true，并且父 TabControl 的 Appearance 属性的值为 Normal，在这种情况下，默认值为BackColor 属性是透明的。默认情况下，放置在 TabPage 上的子控件继承 BackColor 值，因此此行为会导致子控件的背景以当前视觉样式呈现。
> 
> 更改 BackColor 属性的值会自动将 UseVisualStyleBackColor 属性设置为 false。如果希望 TabPage 背景使用视觉样式呈现，但希望子控件继承您指定的 BackColor 值，请在设置 BackColor 属性后设置 UseVisualStyleBackColor 属性。

# jsf-2 - Prettyfaces和转换器不工作

> ID：15012830
> 
> 赞同：1
> 
> 时间：2013-02-21T21:45:38.520
> 
> 标签：jsf-2, converter, prettyfaces

在我的 Web 应用程序中，我有一个转换器，可以从 String 转换为 java.util.LinkedHashMap（反之亦然）。当我尝试使用 Prettyfaces 时，我收到 404 resource not found 错误。这是我的设置：

首先根据这篇[文章](https://stackoverflow.com/questions/12842275/prettyfaces-issue-when-using-with-viewparam-converter)，我尝试用

```
@FacesConverter(forClass = LinkedHashMap.class) 
```

我也尝试添加

```
<converter>
  <converter-for-class>java.util.LinkedHashMap</converter-for-class>
  <converter-class>util.UrlConverter</converter-class>
</converter> 
```

到我的面孔配置，xml。

现在我的 pretty-config.xml 的相关代码是：

```
<url-mapping id="details">
<pattern value="/dataset/#{id}" />
<view-id value="/faces/details.xhtml" />
</url-mapping> 
```

URL 重写本身有效，所以我最终在 URL：[http](http://server.com/appname/dataset//someID) ://server.com/appname/dataset//someID “/dataset”总是有两个“/”。如果这是我的问题的原因，那么我该如何重写这些斜杠呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T06:14:03.827

我认为`/`性格确实是你问题的根源。默认情况下 PrettyFaces 使用正则表达式`[^/]+`来匹配路径参数。`/`因此，如果您的路径参数包含字符，则映射将不匹配。

您应该对路径参数使用自定义正则表达式，如下所述：

[http://ocpsoft.org/docs/prettyfaces/3.3.3/en-US/html/Configuration.html#config.pathparams.regex](http://ocpsoft.org/docs/prettyfaces/3.3.3/en-US/html/Configuration.html#config.pathparams.regex)

这意味着这样的事情应该可以工作：

```
<url-mapping id="details">
  <pattern value="/dataset/#{ /.+/ id }" />
  <view-id value="/faces/details.xhtml" />
</url-mapping> 
```

另一种选择是将`/`字符替换为转换器中的其他内容。

# rest - CF10 中的 REST 与通过 ajax 调用远程方法的优势？

> ID：15012833
> 
> 赞同：0
> 
> 时间：2013-02-21T21:45:43.363
> 
> 标签：rest, coldfusion, coldfusion-10

有人在 CF10 中使用 REST 进行生产吗？

这比 ajax 调用远程方法更好，例如`foo.cfc?method=blah`？

你能让你的 RESTful API 成为纯无状态的吗？你还依赖会话cookie吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T06:05:43.200

REST 和对方法的远程调用是两个完全不同的选项，它们都不一定“更好”。CF 中的 REST 服务默认是无状态的。如果您想参与会话或任何其他状态，这完全取决于您。我建议阅读更多关于 REST 的内容，看看它是否是您想要构建的那种 API。祝你好运！

# f# - 如何将通用类型的漂亮打印机添加到 fsi？

> ID：15012836
> 
> 赞同：7
> 
> 时间：2013-02-21T21:45:53.573
> 
> 标签：f#, fsi

在 F# Interactive (fsi) 中，您可以使用`AddPrinter`或`AddPrinterTransformer`为交互式会话中的类型提供漂亮的打印。如何为泛型类型添加这样的打印机？对类型使用通配符`_`不起作用：

```
> fsi.AddPrinter(fun (A : MyList<_>) -> A.ToString());; 
```

只是没有使用打印机。

放入类型参数也会发出警告：

```
> fsi.AddPrinter(fun (A : MyList<'T>) -> A.ToString());;

  fsi.AddPrinter(fun (A : MyList<'T>) -> A.ToString());;
  -------------------------------^^

d:\projects\stdin(70,51): warning FS0064: This construct causes code
to be less generic than indicated by the type annotations. The type
variable 'T been constrained to be type 'obj'. 
```

这也不是我想要的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T22:22:35.247

这不适用于一般情况，但由于看起来您正在使用自己的类型（至少在您的示例中），并且假设您不想影响`ToString`，您可以执行以下操作：

```
type ITransformable =
  abstract member BoxedValue : obj

type MyList<'T>(values: seq<'T>) =
  interface ITransformable with
    member x.BoxedValue = box values

fsi.AddPrintTransformer(fun (x:obj) ->
  match x with
  | :? ITransformable as t -> t.BoxedValue
  | _ -> null) 
```

输出：

```
> MyList([1;2;3])
val it : MyList<int> = [1; 2; 3] 
```

对于第三方泛型类型，您可以使用`AddPrintTransformer`和反射来获取要显示的值。如果您有源代码，界面会更容易。

# php - 在 PHP 中使用 SELECT WHERE 对相似值进行分组的更好方法

> ID：15012837
> 
> 赞同：1
> 
> 时间：2013-02-21T21:45:56.507
> 
> 标签：php, mysql, select, gps, where

我试图在一个 15 码的正方形内对相似的值进行分组（因此是特定的值）。

这是通过获取纬度/经度值，减去或添加另一个值来完成的，如果此条件大于/小于该值，则分组

我已经通过使用以下代码从我的 mySQL DB 中选择数据来尝试使用 PHP：

```
$summarisedData = mysql_query("SELECT P_ID,COUNT(*) 
FROM road_awareness 
WHERE 
(
  (
     (
     LAT - '$value[LAT]' < (0.006858/69) 
     AND 
     LAT - '$value[LAT]' > (-0.006858/69)
     ) 
  OR 
     (
     LAT + '$value[LAT]' < (0.006858/69) 
     AND 
     LAT + '$value[LAT]' > (-0.006858/69) 
     )
   ) 
AND
 (
    (
    LON - '$value[LON]' < 0.006858/(cos($lat*M_PI/180)*69) 
    AND 
    LON - '$value[LON]' > -0.006858/(cos($lat*M_PI/180)*69)
    )
  OR 
    (
    LON + $value[LON]' < 0.006858/(cos($lat*M_PI/180)*69) 
    AND 
    LON + '$value[LON]' > -0.006858/(cos($lat*M_PI/180)*69)
    )
  )
)
GROUP BY LAT, LON"); 
```

这段代码非常hacky，有很多重复的代码，我不确定它是否正确。将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:23:57.677

可能最好在每条记录中预先计算一些“扇区”值（每个 15 平方码），`road_awareness`而不是在查询确定哪个扇区落在您的 $value[LAT]/$value[LON] 并按扇区选择之前。

# c# - 自定义 dll 的导入模块失败

> ID：15012838
> 
> 赞同：0
> 
> 时间：2013-02-21T21:45:56.753
> 
> 标签：c#, powershell

[我按照这里](http://blogs.msdn.com/b/saveenr/archive/2010/03/08/how-to-create-a-powershell-2-0-module-and-cmdlet-with-visual-studio-2010-screencast-included.aspx)的演示创建了一个自定义的 powershell cmdlet。当我尝试导入模块时，出现以下错误：

```
C:\PS> Import-Module DemoPS.dll
Import-Module : The specified module 'DemoPS.dll' was not loaded because no valid module file was found in any module directory. 
```

如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T21:52:54.513

显示错误是因为它找不到您的 dll 文件。您需要为您的模块 DLL 文件（例如`Import-Module c:\users\mj\desktop\DemoPS.dll`）指定完整路径。

作为替代解决方案，您可以将其保存在“模块”文件夹中。这是一个名为“Modules”的文件夹，您必须在配置文件目录中创建它。可以使用 找到您的个人资料目录`$profile`。它通常在`C:\Users\<username>\Documents\WindowsPowerShell\`. 因此，要使用它，请将您的 dll 放在以下路径中：

```
C:\Users\<username>\Documents\WindowsPowerShell\Modules\DemoPS\DemoPS.dll 
```

# scala - 如何防止 Intellij 将 Scala 警告视为错误？

> ID：15012841
> 
> 赞同：8
> 
> 时间：2013-02-21T21:46:12.030
> 
> 标签：scala, intellij-idea

我正在一个混合 Java/Scala 项目上试用 Intellij。构建失败并出现如下错误：

> 错误：scala：/home/kevin/ij/backend/srctest/com/example/package/DoStuffTest.java:35：警告：[deprecation] com.example.package 中的 OldStuffList 已被弃用

我找不到任何与将警告视为错误相关的设置。我希望将这些报告为警告（因为它们确实是警告），但不会阻止构建完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-03-24T15:46:11.880

在 scala 编译器设置中，检查是否没有`-Xfatal-warnings` 此选项使 scalac 将警告视为错误。

请注意，在一位同事在`build.sbt`sbt 项目中添加此选项后，我遇到了这个问题。Intellij 然后将其添加到其 scala 编译器设置中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:40:55.430

如果您在突出显示的错误上按 alt-enter，它至少应该为您提供一个名为“禁用检查”的下拉选项，它应该可以让您针对该实例或所有已弃用的错误关闭它。这并不能真正解决你的问题，但它至少可以让你克服它。

# javascript - 使用 jquery 隐藏和显示错误

> ID：15012844
> 
> 赞同：1
> 
> 时间：2013-02-21T21:46:23.760
> 
> 标签：javascript, jquery, html

当我选择第一个选项时，我有 3 个选择，其中两个隐藏，一个可见，当您按下一个选项时，另一个选项显示第二个选项。所有这些都在一个表中，并使用 jquery 在 manipulacion.js 文件中创建一个新的行按钮一个计数器，我已将它添加到每个选择的 id 中，而不仅仅是调用。错误是当我创建一个新行而不更改我时，我打开控制台并且不检查任何错误。在这里，我在 html 中附加了我的代码和。js可以复制给他们发现我错了。

代码html

```
<html>
<head>
</head>
<body>
<script type="text/javascript" src="jss/jquery-1.9.0.min.js"></script>
    <script type="text/javascript" src="manipulacion.js"></script>
<script>    
    $(document).ready(function () {
        $("#estado").change(function () {
            if ($("#estado").val() == 2) {
                $("#sino").show();
                $("#sexo").hide();            
            }
            if ($("#estado").val() == 3) {
                $("#sino").hide();
                $("#sexo").show();
            }
            });
            });
    </script>
    <table>
    <tr>
    <td>
    <select id="estado">
    <option value="1">Seleccione 1 opcion</option>
    <option value="2">Laboratorio</option>
    <option value="3">Datos Generales</option>
    </select>
    </td>
    <td>
    <!-- //laboratorio -->
    <select name="sino" id="sino"style="display:none">
    <option value="1">Si </option>
    <option value="2">No</option>
    </select>
    </td>
    <td>
    <!-- //datos generales -->
    <select name="sexo" id="sexo"  style="display:none">
    <option value="1">Masculino </option>
    <option value="2">Femenino</option>
    </select>
    </td>
    <td><input type="button" value="+" class="clsAgregarFila"></td>
    </tr>
    </table>
    </body>
    </html> 
```

代码 manipulacion.js

```
//manipulacion 
var contLin=1
    $(document).ready(function () {
        $("#estado"+contLin).change(function () {      
            if ($("#estado"+contLin).val() == 2) {
                $("#sino"+contLin).show();
                $("#sexo"+contLin).hide();       
            }
            if ($("#estado"+contLin).val() == 3) {
                $("#sino"+contLin).hide();
                $("#sexo"+contLin).show();
            }
}           );

});

$(document).ready(function(){
    //evento que se dispara al hacer clic en el boton para agregar una nueva fila
    $(document).on('click','.clsAgregarFila',function(){
        //almacenamos en una variable todo el contenido de la nueva fila que deseamos
        //agregar. pueden incluirse id's, nombres y cualquier tag... sigue siendo html

        var strNueva_Fila='<tr>'+
'<td><select id="estado'+contLin+'"><option value="1">Seleccione 1 opcion</option><option value="2">Laboratorio</option><option value="3">Datos Generales</option></select></td>' +
'<td><select name="sino'+contLin+'" id="sino"style="display:none"><option value="1">Si </option><option value="2">No</option></select></td>'+
'<td> <select name="sexo'+contLin+'" id="sexo"  style="display:none"><option value="1">Masculino </option><option value="2">Femenino</option></select><td>'+
'<td><input type="button" value="+" class="clsAgregarFila"><input type="button" value="-" class="clsEliminarFila"></td>'+
'</tr>';

contLin++;

        var objTabla=$(this).parents().get(3);

        $(objTabla).find('tbody').append(strNueva_Fila);

        if(!$(objTabla).find('tbody').is(':visible')){

            $(objTabla).find('caption').click();
        }
    });

    $(document).on('click','.clsEliminarFila',function(){

        var objCuerpo=$(this).parents().get(2);
            if($(objCuerpo).find('tr').length==1){
                if(!confirm('Esta es el única fila de la lista ¿Desea eliminarla?')){
                    return;
                }
            }

        var objFila=$(this).parents().get(1);

            $(objFila).remove();
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T00:27:53.020

导致的问题是因为`$("#estado"+contLin).change(function () {`将函数绑定到元素`#estado1`（从`contLin=1`最初开始），但是当文档准备好并且该元素`#estado1`不存在时执行 JavaScript。

解决此问题的一种快速方法是将更改事件函数移动到`$(document).on('click','.clsAgregarFila',function(){`正文中，以便`#estadoX`在追加表行时将新的更改函数绑定到新函数。但是，这是*非常*低效的，我建议您使用事件委托，您实际上已经将其用于 和 上的点击处理程序`.clsAgregarFila`函数`.clsEliminarFila`。

事件委托通过将处理函数绑定到*已经存在*的父或祖先 DOM 元素来工作。然后在该元素上处理该事件并向下委托（通过您指定的 CSS 选择器）到目标元素。

例如`$(document).on('click','.clsAgregarFila',function(){`，当事件直接发生在绑定元素 ( `document`) 上时，不会调用处理程序，而只会调用匹配选择器的后代（内部元素）（所有带有 的元素`class="clsAgregarFila"`） - 请参阅[`.on()`](http://api.jquery.com/on/)

因此，您*可以*`<select>`只使用以下内容，它使用 CSS 属性选择器来匹配所有**以** `id="estado"`. 但是有一个小问题 - 它不会像这样工作......

```
$(document).on('change', 'select[id^=estado]', function () {
    if ($("#estado"+contLin).val() == 2) {
        $("#sino"+contLin).show();
        $("#sexo"+contLin).hide();       
    }
    if ($("#estado"+contLin).val() == 3) {
        $("#sino"+contLin).hide();
        $("#sexo"+contLin).show();
    }
}); 
```

…因为`contLin == 2`它是一个全局变量！我们真正想要的是找到*当前行*`<select>`上的 s 。因此，以下修改后的功能应该可以工作，甚至可以更好地替换您的*两个*功能，消除代码重复:-)

 **```
 $(document).on('change', 'select[id^=estado]', function () {
      var estadoValue = parseInt(this.value);
      var rowSelects = $(this).closest('tr').find('select').slice(1);

      $(rowSelects[0]).toggle(estadoValue === 2);
      $(rowSelects[1]).toggle(estadoValue === 3);
}); 
```

但是，进一步采用这种方法，您的代码可以像[**这个演示**](http://jsfiddle.net/2RprF/)一样重写。我已经删除了 HTML 字符串并用于[`.clone()`](http://api.jquery.com/clone/)添加一行，简化了删除一行，链接了事件处理并删除了元素计数器 - 改为替换为类。

**JavaScript**

```
$(function(){
  var $tbody = $('tbody');
  var strNueva_Fila = $tbody.find('tr:first');

  $('tbody').on('change', 'select.estado', function() {
      var estadoValue = parseInt(this.value);
      var rowSelects = $(this).closest('tr').find('select').slice(1);

      $(rowSelects[0]).toggle(estadoValue === 2);
      $(rowSelects[1]).toggle(estadoValue === 3);
  }).on('click', 'input', function() {
      if (this.className === 'clsAgregarFila') {
        $tbody.append(strNueva_Fila.clone());
      } else if (this.className === 'clsEliminarFila') {
        $(this).closest('tr').remove();
      }

      buttonsToggle();
  });

  function buttonsToggle() {
    var $addButtons = $tbody.find('.clsAgregarFila');
    var $removeButtons = $tbody.find('.clsEliminarFila');

    // hide all
    $addButtons.hide();
    $removeButtons.hide();

    // show "-" button on all but first row
    $removeButtons.slice(0).show();

    // but hide "-" if there is only 1 row
    if ($removeButtons.length === 1) {
      $removeButtons.hide();
    }

    // show "+" button on last row only
    $addButtons.slice(-1).show();
  }
}); 
```

***HTML***（注意：我添加了“-”`<input>`和`<thead>`and`<tbody>`元素）。

```
<table>
  <thead></thead>
  <tbody>
      <tr>
      <td>
      <select id="estado" class="estado">
      <option value="1">Seleccione 1 opcion</option>
      <option value="2">Laboratorio</option>
      <option value="3">Datos Generales</option>
      </select>
      </td>
      <td>
      <!-- //laboratorio -->
      <select name="sino" class="sino" id="sino" style="display:none">
      <option value="1">Si </option>
      <option value="2">No</option>
      </select>
      </td>
      <td>
      <!-- //datos generales -->
      <select name="sexo" id="sexo" class="sexo" style="display:none">
      <option value="1">Masculino </option>
      <option value="2">Femenino</option>
      </select>
      </td>
      <td><input type="button" value="+" class="clsAgregarFila"/><input type="button" value="-" class="clsEliminarFila" style="display:none"/></td>
      </tr>
  </tbody> 
```

希望这可以帮助 ：-）**

# php - 什么情况下可能不继承父字段？

> ID：15012847
> 
> 赞同：10
> 
> 时间：2013-02-21T21:46:29.837
> 
> 标签：php, inheritance

我今天有一个奇怪的错误（困扰我）。涉及三个继承级别：

**爷爷**：

```
abstract class Zend_Db_Table_Row_Abstract implements ArrayAccess, 
                                                     IteratorAggregate
{
    protected $_data = array();

    /* snip */
} 
```

**妈妈**：

```
namespace Survey\Db\Table\Row;

class AbstractRow extends \Zend_Db_Table_Row_Abstract
{
    /* snip */
} 
```

**孩子**：

```
namespace Survey\Db\Table\Row;

class SurveyItem extends AbstractRow implements ISkippable
{
    /* snip */
} 
```

**例外**：

```
Type:     ErrorException  
Value:    Undefined property: Survey\Db\Table\Row\SurveyItem::$_data  
Location: [...]/Zend/Db/Table/Row/Abstract.php in handleError , line 177 
```

第 177 行似乎无关紧要，但我添加它只是为了让您相信我；）

```
if (!array_key_exists($columnName, $this->_data)) { 
```

> PHP 5.4.11，PHP 5.4.8 不存在问题

当我看到[Bug #63462 Magic methods called two for unset protected properties](https://bugs.php.net/bug.php?id=63462)的[修复程序](https://github.com/smalyshev/php-src/commit/d1da4c6fe71d18966f07f48aaa62c7bc06c2babe)时，我想，这会解决问题，因为这个错误会导致我看到的奇怪的意外结果。

但事实证明，**更新到 PHP 5.4.12 后问题依然存在**。PHP 中存在另一个类似错误的可能性似乎很高。

**问题：**

我得到的信息是爷爷中定义的受保护字段在孩子中未定义。什么情况会导致这样的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T23:05:25.623

以下代码段在 PHP 5.4.9 上完美运行：

```
class A
{
    protected $foo = 'hello';
    public function bar()
    {
        echo $this->foo;
    }
}

class B extends A {}

class C extends B {}

$c = new C();
$c->bar(); 
```

请逐步最小化您的代码，以查看是否/何时出现问题（我想知道您为什么还没有这样做）

如果您确定这适用于 PHP 5.4.8 而不适用于 PHP 5.4.11，那么您在 PHP 中发现了一个错误，应该在 php.net 上报告它

答案可能会有所不同（也许只是在此过程中“未设置”）。最小化你的代码，你就会知道。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-24T14:08:06.347

如果您不希望父字段通过对象在子类中继承，则将父字段声明为“静态”。

# java - JSTL：for Each 循环遍历集合

> ID：15012848
> 
> 赞同：2
> 
> 时间：2013-02-21T21:46:30.753
> 
> 标签：java, spring, jsp, jstl

以下是我的片段，在我从 spring 2 迁移到 spring 3 和 Jstl 1.1 到 jstl 1.2 之前，它运行良好。现在，它不起作用并继续给出错误 `fEvents cannot found on object location`

```
 <c:forEach items="${location.fEvents}" var="item" varStatus="loop">
    <tr><td><form:input path="fEvents[${loop.index}].hostName" size="30" maxlength="200"/></td>
    <td><form:input path="fEvents[${loop.index}].directory" size="30" maxlength="200"/></td>
    <td><form:input path="fEvents[${loop.index}].userName" size="20" maxlength="20"/></td>
    <td><form:input path="fEvents[${loop.index}].password" size="20" maxlength="20"/></td>
    </tr>
 </c:forEach> 
```

需要迭代 ftpEvents 并在 jsp 上显示它们 任何建议表示赞赏！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:57:54.627

看起来名为“位置”的对象没有 fEvents 属性。它实际上称为 ftpEvents 吗？您只需要更改变量名称吗？

尽管如此，你可能还想做更多这样的事情：

```
 <c:forEach items="${location.ftpEvents}" var="item">
    <tr><td><form:input path="item.hostName" size="30" maxlength="200"/></td>
    <td><form:input path="item.directory" size="30" maxlength="200"/></td>
    <td><form:input path="item.userName" size="20" maxlength="20"/></td>
    <td><form:input path="item.password" size="20" maxlength="20"/></td>
    </tr>
 </c:forEach> 
```

...如果我正确解释了您的代码，您甚至根本不需要使用 loop.index 。

# c# - What is a good way to rename multiple parameters that share the same purpose?

> ID：15012854
> 
> 赞同：2
> 
> 时间：2013-02-21T21:46:59.040
> 
> 标签：c#, parameters, naming-conventions, naming

What is the common way of naming parameters in a method like the following?

```
void MyMethod(int[] series1, int[] series2) { ... } 
```

The two arrays there have the same purpose, maybe the method takes two arrays of names, or two series, or something similar. What is a common way to name such parameters? Would you use `parameter1, parameter2, ...` or `firstParameter, secondParameter, ...` or something else?

I would appreciate if you could give me an example of such a method in the .NET Framework itself.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:52:52.567

这里有一些例子：

*   [Tuple.Create<T1, T2> 方法 (T1, T2)](http://msdn.microsoft.com/en-us/library/dd387181.aspx)

    ```
    public static Tuple<T1, T2> Create<T1, T2>(T1 item1, T2 item2) 
    ```

*   [String.Compare 方法（字符串，字符串）](http://msdn.microsoft.com/en-us/library/84787k22.aspx)

    ```
    public static int Compare(string strA, string strB) 
    ```

*   [字符串等式运算符](http://msdn.microsoft.com/en-us/library/system.string.op_equality.aspx)

    ```
    public static bool operator ==(string a, string b) 
    ```

*   [Object.ReferenceEquals 方法](http://msdn.microsoft.com/en-us/library/system.object.referenceequals.aspx)

    ```
    public static bool ReferenceEquals(Object objA, Object objB) 
    ```

*   [XNode.DeepEquals 方法](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.deepequals.aspx)

    ```
    public static bool DeepEquals(XNode n1, XNode n2) 
    ```

*   [Expression.Equal 方法（表达式，表达式）](http://msdn.microsoft.com/en-us/library/bb352749.aspx)

    ```
    public static BinaryExpression Equal(Expression left, Expression right) 
    ```

*   [TimeSpan.Compare 方法](http://msdn.microsoft.com/en-us/library/system.timespan.compare.aspx)

    ```
    public static int Compare(TimeSpan t1, TimeSpan t2) 
    ```

*   [String.Concat 方法（字符串，字符串）](http://msdn.microsoft.com/en-us/library/a6d350wd.aspx)

    ```
    public static string Concat(string str0, string str1) 
    ```

我不认为有一个在整个 .NET 框架中始终如一地使用的约定。
方法名称清楚地说明了参数的含义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:49:20.717

The way you have done it is common.

However, if the method reflects a documented algorithm, then using names that match that algorithm is better.

# ruby-on-rails - Rake routes 'match' mapping to the wrong action

> ID：15012855
> 
> 赞同：1
> 
> 时间：2013-02-21T21:47:00.630
> 
> 标签：ruby-on-rails, ruby, rails-routing

My question has to do with mapping to controllers/actions using named routes. I am trying to map '/profile' to 'customers#show'. My routes file looks like this:

```
 root :to => 'pages#home'

  ## named routes
  match "profile" => "customers#show", :as => 'profile'
  match 'signin' => 'sessions#new', :as => 'signin'
  match 'signout' => 'sessions#destroy', :as => 'signout'

  resources :customers do
    member do 
      get 'add_card'
      post 'submit_card'
    end
  end

  resources :payments, :only => [:show, :new]
    delete  'payments/delete_recurring_payment'
    post    'payments/submit_non_recurring'
    post    'payments/submit_recurring'

  resources :sessions, :only => [:create, :destroy, :new] 
```

Running 'rake routes' gives me this:

```
 root        /                                            pages#home
                      profile        /profile(.:format)                           customers#show
                       signin        /signin(.:format)                            sessions#new
                      signout        /signout(.:format)                           sessions#destroy
            add_card_customer GET    /customers/:id/add_card(.:format)            customers#add_card
         submit_card_customer POST   /customers/:id/submit_card(.:format)         customers#submit_card
                    customers GET    /customers(.:format)                         customers#index
                              POST   /customers(.:format)                         customers#create
                 new_customer GET    /customers/new(.:format)                     customers#new
                edit_customer GET    /customers/:id/edit(.:format)                customers#edit
                     customer GET    /customers/:id(.:format)                     customers#show
                              PUT    /customers/:id(.:format)                     customers#update
                              DELETE /customers/:id(.:format)                     customers#destroy
                  new_payment GET    /payments/new(.:format)                      payments#new
                      payment GET    /payments/:id(.:format)                      payments#show 
```

Here is where I'm stumped. When I go to localhost:3000/profile I get a routing error saying this:

```
No route matches {:action=>"edit", :controller=>"customers"} 
```

This seems odd because there is indeed a route to 'customers#edit' due to my declaring customers as a resource.

However, when I go to 'localhost:3000/signin' I get routed to 'customers#show' which is where I want '/profile' to route to.

It seems like my routes are 'one off' in my routes file but I have no idea why. Any help would be much appreciated.

Thanks

UPDATE 1: Adding my Customers Controller

```
 class CustomersController < ApplicationController
  layout "payments_layout"

  def show
    @customer = current_user
    get_account_info(@customer)
    get_payment_history(@customer, 10)
  end

  def new
     @title = 'Create an account'
     @customer = Customer.new
  end

  def edit
    @customer = current_user
    get_account_info(@customer)
  end

  def update
    @customer = current_user
    if @customer.update(params[:customer])
      redirect_to @customer
    else
      @card_message = "Use this form to add a credit card to your account.  You must have a credit card associated with your account in
                      in order to make payments on our system."
      get_account_info(@customer)
      render 'edit'
    end
  end

  def create
   @customer = Customer.new(params[:customer])
   if @customer.save_and_get_stripe_id
     sign_in(@customer)
     redirect_to @customer   
   else
     @title = 'Create an account'
     render 'new'
   end
  end

  def add_card
    @customer = current_user
    get_account_info(@customer)
    @card_message = "Use this form to add a credit card to your account.  You must have a credit card associated with your account in
                    in order to make payments on our system."
  end

  def submit_card
    @customer = current_user
    res = @customer.add_or_update_card(params)
    if res
      redirect_to @customer
    else
      @error = res
      customer.get_account_info(@customer)
      render 'add_card'
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T00:53:56.690

检查您的意见。

您有编辑用户资料的链接吗？

看起来您实际上路由到了正确的控制器和操作，但是有一些 rake 无法路由的链接，例如，您没有将 ID 传递给您的 edit_customer_path 链接。

# ruby-on-rails - attribute values are changing while trying to insert into tables in rails

> ID：15012857
> 
> 赞同：0
> 
> 时间：2013-02-21T21:47:16.827
> 
> 标签：ruby-on-rails, ruby, routing, controllers

I am working on a project where there are users and users have profiles. I am using the devise gem for the user authentication purposes.I have changed a path for an action in a controller which is resulting in unexplained behavior.

```
Test::Application.routes.draw do
  match '/:username' => 'profile#show' , :as => :username

  get "profile/update"

  get "static_pages/index"

  devise_for :users 
```

The server logs show the following.

```
Started POST "/users" for 127.0.0.1 at 2013-02-22 03:07:48 +0530
Processing by ProfileController#show as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Tr90BvI6sztk7gxlPm6KF3td3xIe91SpCZDGsIniv60=", "user"=>{"username"=>"example", "email"=>"example@email.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "commit"=>"Sign up", "username"=>"users"}
  Rendered profile/show.html.erb within layouts/application (0.1ms)
Completed 200 OK in 12ms (Views: 11.5ms | ActiveRecord: 0.0ms) 
```

The data is not being inserted into the database and the username parameter is getting changed, and when i change the route to the default route i.e

```
match '/:username' => 'profile#show' , :as => :username 
```

changed to

```
get "profile/show" 
```

everything is back to normal. the data is being inserted and everything works fine.I dont understand why and action from profile controller is being called when it is a user registration.`rake routes` gives the following output

```
 username        /:username(.:format)           profile#show
          profile_update GET    /profile/update(.:format)      profile#update
      static_pages_index GET    /static_pages/index(.:format)  static_pages#index
        new_user_session GET    /users/sign_in(.:format)       devise/sessions#new
            user_session POST   /users/sign_in(.:format)       devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy
           user_password POST   /users/password(.:format)      devise/passwords#create
       new_user_password GET    /users/password/new(.:format)  devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit
                         PUT    /users/password(.:format)      devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)        devise/registrations#cancel
       user_registration POST   /users(.:format)               devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)       devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)          devise/registrations#edit
                         PUT    /users(.:format)               devise/registrations#update
                         DELETE /users(.:format)               devise/registrations#destroy
                    root        /                              static_pages#inde 
```

Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:55:53.143

您的路线将按照定义的顺序进行匹配。由于`/:username`在您的路由文件的顶部定义并且具有较低的特异性，因此它似乎是在屏蔽之后定义的路由。我建议将该路径移动到文件底部和/或应用一些约束，如正则表达式，以使其不那么“贪婪”。

# python - GAE Python how to check file type on upload

> ID：15012858
> 
> 赞同：1
> 
> 时间：2013-02-21T21:47:17.727
> 
> 标签：python, google-app-engine, parsing, upload

So, i'm trying to create an google app engine (python) app that allows people to share files. I have file uploads working well, but my concern is about checking the file extension and making sure, primarily, that the files are read only, and secondly, that they are of the filetype that is specified. These will not be image files, as a know they are a lot of image resources already. Specifically, .stl mesh files, but i'd like to be able to do this more generally.

I know there are modules that can do this, python-magic seems to be able to do this for example, but i can't seem to find any that i'm able to import without LoadModuleRestricted. I'm considering writing my own parser, but that would be a lot of work for such a common (i'm assuming) issue.

Anyway, i'm totally stumped so this is my first stackoverflow question, so hope i'm doing well etiquette wise. Let me know, and thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T03:46:51.147

听起来您想读取上传文件的前几个字节以验证其签名是否与声称的 mime 类型匹配。假设您正在上传到 blobstore（即，通过从 获取的 url `blobstore.get_upload_url()`，那么一旦您被重定向到您提供的路径的上传处理程序`get_upload_url`，您可以使用[BlobReader](https://developers.google.com/appengine/docs/python/blobstore/blobreaderclass)打开 blob ，然后读取并验证签名。

[Blobstore 示例应用程序](https://developers.google.com/appengine/docs/python/blobstore/overview#Complete_Sample_App)对框架进行了布局。`UploadHandler`一旦拥有`blob_info`（`blob_info.key()`用于打开 blob），您将在代码中粘贴。

# php - 如何在移动服务器上处理 PHP 时区？

> ID：15012860
> 
> 赞同：0
> 
> 时间：2013-02-21T21:47:35.483
> 
> 标签：php, timezone

我一直收到使用 strtotime 而不设置默认时区的常见 PHP 警告：

> PHP 警告：date_default_timezone_get()：依赖系统的时区设置是不安全的。您*需要*使用 date.timezone 设置或 date_default_timezone_set() 函数。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。我们为 'CST/-6.0/no DST' 选择了 'America/Chicago'

我阅读了很多关于需要做的事情，基本上似乎没有办法设置默认时区（在 php.ini 中作为 date.timezone = "America/Chicago"，或者在 PHP 中使用 date_default_timezone_set （'CST6CDT'）或类似的）。

我的问题是我们有一个移动的服务器，它经常在不同的时区进行演示，所以我不能只设置一个固定的时区，无论我们走到哪里都可以正常工作......

或者我可以吗？当然，我也有可能完全误解了整个时区的概念；-) 坦率地说，我读的越多，我就越困惑……我也不确定服务器的系统时间是如何受到影响的将其插入不同时区的网络 - 我不知道或不了解的内容太多（对不起......）。

我希望停止这些错误消息的主要原因是我必须大量筛选错误日志，因为这也是我的开发服务器，并且必须过滤掉所有这些行只是一个主要的痛苦......

最重要的是，服务器上的应用程序不仅使用本地时间，而且还与我们的静态服务器同步一些数据，所以我痛苦地意识到我还必须调整很多主服务器代码，为此，我可以轻松地强制使用我们的实际时区或 UTC。

那么这里最好的选择是什么？

我是否应该简单地将 UTC 硬编码为默认时区，然后在我的数据库和用户界面中创建一个设置，我们可以使用它来切换时区并更新我的所有代码以使用所有这些，还是有更好和更简单的方法?

还是我应该忽略整个问题并将@ 添加到我使用的每个 strtotime 中？（*为一场小骚乱做好准备……*）;-)

期待任何建议...谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:31:01.473

安迪琼斯是正确的。您最好的选择是完全为您的服务器设置基线。我的意思是将所有编码（bash、mysql）设置为 UTF-8，将时区设置为 UTC。如果你从一开始就这样做，你会在以后省去很多麻烦。

关于您提出的问题，如果您将数据库中的所有时间戳存储为 UTC，那么您只需要根据最终用户的时区进行转换。这避免了必须确定存储在数据库中的时区是 PST 还是 EST 然后转换为用户的时区。此外，它还允许您在时区之间移动服务器。例如，如果您在多个时区使用 VPS，每个时区都输入同一个数据库，则可以确保所有时区条目是一致的。

# iphone - iPhone ignoring CSS Stylesheet

> ID：15012863
> 
> 赞同：0
> 
> 时间：2013-02-21T21:47:53.673
> 
> 标签：iphone, css

I'm working on my very first (very lame) website, so apologies for the n00b question.

In Chrome/FF/Safari, my site renders the CSS fine. But on my iPhone or iPad (Chrome or Safari), my site renders as if there were no CSS styles at all. What's the cause?

Link to [site](http://www.tvsonsale.co.uk)

Thanks in advance!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:50:28.990

您正在为样式表引用 localhost

```
<link rel="stylesheet" href="http://localhost:8888/kirbydev/assets/styles/styles.css" /> 
```

需要是

```
<link rel="stylesheet" href="http://www.tvsonsale.co.uk/kirbydev/assets/styles/styles.css" /> 
```

或相对路径，因此它适用于本地开发和生产：

```
<link rel="stylesheet" href="/kirbydev/assets/styles/styles.css" /> 
```

# c# - How do I work with the AST in Irony now?

> ID：15012865
> 
> 赞同：8
> 
> 时间：2013-02-21T21:47:58.340
> 
> 标签：c#, compiler-construction, abstract-syntax-tree, irony

I have a grammar that works and parses in the Irony console just fine, but I don't get anything in the AST treeview. I was following along with the BASIC->Javascript article found here: [http://www.codeproject.com/Articles/25069/JSBasic-A-BASIC-to-JavaScript-Compiler](http://www.codeproject.com/Articles/25069/JSBasic-A-BASIC-to-JavaScript-Compiler), but it seems that the Ast stuff has all been moved/removed. I found the Irony.Interpreter .dll, which has some Ast stuff in it, but it seems all tied up in the Expression sample implementation.

What am I missing here? I want to walk my tree and generate source code, and I'm not sure where to start.

I've seen some mention of using the visitor pattern, which I'm fine with, but I don't know how to implement it and run it in a way that Irony likes.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-22T05:47:26.393

查看恰当命名的[Sarcasm](https://github.com/akfish/Sarcasm)项目，了解基于 Irony 构建的语法、解析器和 AST 的参考实现。我发现作者的这篇[博客文章](http://catx.me/2014/02/28/the-making-of-sarcasm-2-ast-generators-and-fun-with-visualization/)有助于构建 AST。

以下是启动和运行 AST 的通用指南。

1.  定义你的语法（[例子](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Parser/SarcasmGrammar.cs#L9)）
2.  创建一个`MyBaseNode`派生自`AstNode`( [example](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Ast/SarcasmNode.cs#L38) ) 的抽象基类 ( )。复制/粘贴示例中的方法
3.  为每个终端和非终端创建一个派生自`MyBaseNode`和的新类

    1.  覆盖`Accept`方法（[示例](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Ast/SarcasmNode.cs#L135)）：

    `public override void Accept(IMyNodeVisitor visitor) { visitor.Visit(this); }`

    2.  酌情覆盖[`Init`](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Ast/SarcasmNode.cs#L363)（主要在终端上）或[`InitChildren`](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Ast/SarcasmNode.cs#L344)（非终端上）。**这就是 AST 魔法发生的地方。**
4.  为上一步中定义的每个类添加一个接口`IMyNodeVisitor`并添加一个`Visit`方法（[示例](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Ast/SarcasmNode.cs#L10)）：

    `void Visit(MyDerivedNode1 node);`

5.  `ASTNodeType`从步骤 1 开始，为语法中的每个终端和非终端设置。

    1.  对于终端 - （[示例](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Parser/SarcasmGrammar.cs#L40)）

        `MyTerminal1.AstConfig.NodeType = typeof(MyDerivedNode1);`

    2.  对于非终端 - （[示例](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Parser/SarcasmGrammar.cs#L102)）

        `var MyNonTerminal2 = new NonTerminal("MyNonTerminal2", typeof(MyDerivedNode2));`

6.  在语法中启用 AST 创建：（[示例](https://github.com/akfish/Sarcasm/blob/38f1555b756c30cd66a2bbda523e51db3c6b9033/Sarcasm/Parser/SarcasmGrammar.cs#L16)）

    `LanguageFlags = LanguageFlags.CreateAst;`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-18T10:08:49.623

在 Irony 中，解析分两个阶段完成。首先它创建一个解析树，然后它创建你的 AST 树。

你只看到了第一步。为了使 Irony 创建 AST，您可以：

1.  告诉它如何将您的 NonTerminals 映射到 AST 节点：

    例如，查看 Irony 示例语法 ExpressionEvaluatorGrammar 我们看到：

    ```
    var BinExpr = new NonTerminal("BinExpr", typeof(BinaryOperationNode));` 
    ```

    在这里，我们告诉 Irony 将 BinExpr NonTerminal 映射到 BinaryOperationNode，这是我们的 AST 节点。

2.  使其在解析时生成 AST：

    当您设置此标志时，将在您解析时生成 AST 树。

    ```
    this.LanguageFlags = LanguageFlags.CreateAst; 
    ```

您的 AST 树的根将是：

```
parseTree.Root.AstNode 
```

我发现[这个](http://www.codeproject.com/Articles/22650/Irony-NET-Compiler-Construction-Kit)来源是一个很好的起点。

# perl - Perl program parameters

> ID：15012866
> 
> 赞同：0
> 
> 时间：2013-02-21T20:38:57.103
> 
> 标签：perl

I am a beginner in programming with perl and csh. I am facing some difficulty understanding code like:

```
/some_perl_algorithm.pl -n 166 \ 
    -p "/some_xml.list." \
    -s "" \
    /some_other.list

exit $status 
```

1.  what do these `-n` `-p` `-s` switches mean?
2.  what do these backslashes at the end of the lines (`\`) mean?
3.  Is that `/some_perl_algorithm.pl` the same as `perl some_perl_algorithm.pl`?
4.  what does this code try to do?

Can anyone help? Or point me some good tutorials?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T20:47:53.820

Calling `/some_perl_algorithm.pl` is most likely the same as `perl /some_perl_algorith.pl`. This depends on the first line in that file. See "shebang", i.e. on [http://en.wikipedia.org/wiki/Shebang_(Unix)](http://en.wikipedia.org/wiki/Shebang_(Unix))

The other questions can't be answered without kowing what `some_perl_algorithm.pl` ìs. The arguments are passed to the Perl script.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T07:26:32.937

perldoc 是你的朋友。perldoc perlintro 从

另外： http: [//perldoc.perl.org/perlrun.html#Command-Switches](http://perldoc.perl.org/perlrun.html#Command-Switches)

*   -p 表示在作为参数提供的所有行中循环脚本。
*   -n 类似，但在这种情况下被 -p 覆盖。
*   -s 将 166 作为参数放入文件中。

# java - get value from textfield html into java variable

> ID：15012868
> 
> 赞同：0
> 
> 时间：2013-02-21T21:48:00.427
> 
> 标签：java, html, jsp

I am tring to run function that get 2 variables one of them should get the value from textfield.

any advice?

```
<%@page import="root.SQLQuery"%>
<%@ page language="java" contentType="text/html; charset=windows-1255"
pageEncoding="windows-1255"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"     "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<%@ page import="root.SQLQuery"%>
<% 
String emp_email = session.getAttribute("email").toString();
SQLQuery sql = new SQLQuery();
String link="";

%>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1255">
<title>Insert title here</title>
</head>
<body>
<center>
<table width="900" height="900">
<iframe src="http://www.aol.com/av" width="900" height="900"></iframe>
<center>
<font color=red>your email is:<%=emp_email%>></font>
Copy the link here: <input type="text" name="videoLink" id="link">
<input type="submit" value="submit" onclick="<%sql.meetingUpdateVideoLink(emp_email,        request.getParameter("videoLink").toString()); %>>">
</center>

</table>
</center> 
```

I am tring to insert the fanction meetingUpdateVideoLink() two variables:

1.  email - that easy I get from session.

2.  Link - that is the tricky one I need to get it from the textfield name="videoLink"

Thanks, Cfir

# python - 在终端干净地处理用户输入而不会崩溃

> ID：15012869
> 
> 赞同：1
> 
> 时间：2013-02-21T21:48:01.823
> 
> 标签：python, python-3.x

我有这个简单的项目要做。这是我到目前为止的代码，它工作得很好。但是，如果有人输入字母或未知符号，程序就会崩溃。如果输入了错误的内容，我怎样才能证明错误并显示或打印消息？

```
def excercise5():

    print("Programming Excercise 5")
    print("This program calculates the cost of an order.")
    pound = eval(input("Enter the weight in pounds: "))
    shippingCost = (0.86 * pound) + 1.50
    coffee = (10.50 * pound) + shippingCost
    if pound == 1:
        print(pound,"pound of coffee costs $", coffee)
    else:
        print(pound,"pounds of coffee costs $", coffee)
    print()

excercise5() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T21:52:01.303

我建议不要使用`eval`. 从安全的角度来看，这并不好。只需对所需类型进行显式转换：

```
pound = float(input("Enter the weight in pounds: ")) 
```

处理无效输入：

```
try:
    pound = float(input("Enter the weight in pounds: "))
except ValueError:
    print('Invalid input.')
    return
# the rest of the code 
```

或者：

```
try:
    pound = float(input("Enter the weight in pounds: "))
except ValueError:
    print('Invalid input.')
else:
    # the rest of the code 
```

您还可以将输入包装在一个无限循环中，该循环将在成功转换时终止：

```
while True:
    try:
        pound = float(input("Enter the weight in pounds: "))
    except ValueError:
        print('Invalid input. Try again.')
    else:
        break
# do the rest with `pound` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:52:55.413

使用[异常处理](http://docs.python.org/3/tutorial/errors.html)。

当有人为您提供无效输入时，Python 不会崩溃，而是会引发异常。您可以捕获此类异常并处理它们，而不是让 python 退出程序。

在这种情况下，由于您只需要一个*浮点数，*因此您真的不应该使用`eval()`; 这将需要很多不同的输入，并会引发很多不同的异常。

请改用该函数，如果您输入不正确`float()`，它只会抛出 a 。`ValueError`然后抓住它并显示一条错误消息：

```
try:
    pound = float(input("Enter the weight in pounds: "))
except ValueError:
    print('Not a valid number!')
    return 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:54:00.593

用 try/except 包围语句

```
def excercise5():
    print("Programming Excercise 5")
    print("This program calculates the cost of an order.")
    pound = eval(input("Enter the weight in pounds: "))
    try:
        shippingCost = (0.86 * pound) + 1.50
        coffee = (10.50 * pound) + shippingCost
        if pound == 1:
            print(pound,"pound of coffee costs $", coffee)
        else:
            print(pound,"pounds of coffee costs $", coffee)
    except ValueError:
        print("Please Enter a valid number")
    print() 
```

我应该注意：没有办法“防错”某些东西，就像防弹是不可能的，足够大的子弹会穿透任何东西，编码也是如此。你所能做的就是写出好的代码。编码中没有什么是绝对的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-15T18:41:03.863

你能不使用ascii吗？例如，将字符串转换为数值，然后忽略不在数值窗口中的结果，例如'if (c <= 47 and c >= 57):'。这应该会阻止它崩溃。我认为：P

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-26T10:53:32.433

异常是在非平凡程序中轻松路由和处理错误的方法。但是一个清晰的概念有助于在程序增长时不要随意破解。（例如，在很远的地方
捕捉内置函数或ing / continue 会很快变得毛茸茸。）`ValueError``return`

引起的错误之间的主要区别是

*   通过无效/奇怪的用户输入
*   通过错误
*   受动态系统/环境限制。

分离、路由和处理这些错误的合理方法是：

*   (A) 在可能发生的点附近很早就发现或比较用户输入错误。立即做出反应以进行简单的恢复/重复。否则（用于中断）**转换为丰富的异常**，该异常可以在调用堆栈的底部或底部（或默认处理程序`sys.excepthook`）进一步捕获和区分

*   (B) 让 bug 异常崩溃到调用堆栈的底部——未处理；或者可能启动舒适的错误演示和反馈操作。

*   (C) 对于系统环境错误，在 (A) 和 (B) 之间选择一种方法，具体取决于您希望在当前开发阶段出现多少上下文、详细信息和舒适信息。

这样，这可以成为您示例中面向用户的错误处理的可扩展模式：

```
# Shows scalable user oriented error handling

import sys, traceback

DEBUG = 0

class UserInputError(Exception):
    pass

def excercise5():

    print("Programming Excercise 5")
    print("This program calculates the cost of an order.")

    # NOTE: eval() and input() was dangerous
    s = input("Enter the weight in pounds: ")
    try:        
        pound = float(s) 
    except ValueError as ev:
        raise UserInputError("Number required for weight, not %r" % s, ev)
    if pound < 0:
        raise UserInputError("Positive weight required, not %r" % pound)

    shippingCost = (0.86 * pound) + 1.50
    coffee = (10.50 * pound) + shippingCost
    if pound == 1:
        print(pound,"pound of coffee costs $", coffee)
    else:
        print(pound,"pounds of coffee costs $", coffee)
    print()

if __name__ == '__main__':
    try:
        excercise5()
    except UserInputError as ev:
        print("User input error (please retry):")
        print(" ", ev.args[0])
        if DEBUG and len(ev.args) > 1:
            print("  EXC:", ev.args[1], file=sys.stderr)
    except (EnvironmentError, KeyboardInterrupt) as ev:
        print("Execution error happend:")
        print(" ", traceback.format_exception_only(ev.__class__, ev)[0])
    except Exception:
        print("Please report this bug:")
        traceback.print_exc() 
```

# php - 使用 post_meta 搜索

> ID：15012871
> 
> 赞同：0
> 
> 时间：2013-02-21T21:48:03.253
> 
> 标签：php, sql, wordpress

我将自己的查询写入 wordpress 数据库，但我被卡住了。我有许多 (5) 自定义字段，例如：

```
town
price
size
... etc 
```

在 search.php 我有：

```
$querystr = "
SELECT wposts.* 
FROM $wpdb->posts wposts, $wpdb->postmeta wpostmeta
WHERE wposts.ID = wpostmeta.post_id ";

$town = addslashes($_GET['town']);
if($town!=''){
    $querystr .= " AND wpostmeta.meta_key = 'town' AND wpostmeta.meta_value = '".$town."'";
}

$mo = addslashes($_GET['mo']);
if($mo!='' && preg_match("/^\d+$/", $mo)){
    $querystr .= " AND wpostmeta.meta_key = 'price' AND wpostmeta.meta_value > '".$mo."'";
}

$md = addslashes($_GET['md']);
if($md!='' && preg_match("/^\d+$/", $md)){
    $querystr .= " AND wpostmeta.meta_key = 'price' AND wpostmeta.meta_value < '".$md."'";
}

$querystr .= " AND wposts.post_status = 'publish' AND wposts.post_type = 'post'";

$pageposts = $wpdb->get_results($querystr, OBJECT); 
```

但这不起作用。如果我只使用一个条件：

```
$querystr = "SELECT wposts.* FROM $wpdb->posts wposts, $wpdb->postmeta wpostmeta WHERE wposts.ID = wpostmeta.post_id ";

$town = addslashes($_GET['town']);
if($town!=''){
    $querystr .= " AND wpostmeta.meta_key = 'town' AND wpostmeta.meta_value = '".$town."'";
}

$querystr .= " AND wposts.post_status = 'publish' AND wposts.post_type = 'post'";
$pageposts = $wpdb->get_results($querystr, OBJECT); 
```

那么它将起作用。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:45:18.520

select 表达式作为一个整体没有意义，因为你有矛盾的 where 条件。对于关系数据库的工作方式，它也没有任何意义。[您想在一个查询中匹配两个共享相同列名的唯一行，如果不使用子查询](https://dev.mysql.com/doc/refman/5.0/en/subqueries.html)之类的技术，这是不可能的。

考虑到所有表达式部分都必须为真，并且您得到如下内容：

```
SELECT wposts.*
FROM wp_posts wposts, wp_postmeta wpostmeta
WHERE wposts.ID = wpostmeta.post_id
AND wpostmeta.meta_key = 'town' AND wpostmeta.meta_value = 'My town' 
AND wpostmeta.meta_key = 'price' AND wpostmeta.meta_value > 500 
```

在这里，您说`meta_key`等于“城镇”并且`meta_value`等于“我的城镇”。这是有道理的，但是当您还说`meta_key` **也**等于“价格”`meta_value`并且**也**大于 500 时。表达式永远不会为真，无论解析器也无法将两个不同的条件集组合在一起。

## WP_Query

如果可能，我建议您使用[WP_Query](https://codex.wordpress.org/Class_Reference/WP_Query)类而不是直接查询数据库。这个包装器极大地简化了您的代码并使其更易于维护。请注意，代码需要 WordPress >=3.1，因为它使用了该`meta_query`选项。

您的查询可以这样写：

```
<?php

// The arguments that defines the query
$args = array(
    'post_status' => 'publish',
    'post_type' => 'post'
);

// We define the meta/custom field conditions

$meta_query = array();

// PS: No need to slash the values, WordPress will do that for us
$town = $_GET['town'];
$mo = (int) $_GET['mo']; // Simple sanitizment, implement your own as see fit
$md = (int) $_GET['md']; // Simple sanitizment, implement your own as see fit

if ( $town ) {
    $meta_query[] = array(
        'key' => 'town',
        'value' => $town
    );
}

if ( $mo ) {
    $meta_query[] = array(
        'key' => 'price',
        'value' => $mo,
        'type' => 'NUMERIC',
        'compare' => '>'
    );
}

if ( $md ) {
    $meta_query[] = array(
        'key' => 'price',
        'value' => $md,
        'type' => 'NUMERIC',
        'compare' => '<'
    );
}

if ( $meta_query ) {
    // Add the meta_query conditions to the arguments array

    $meta_query['relation'] = 'AND';

    $args['meta_query'] = $meta_query;
}

// Create WP_Query object with the arguments
$query = new WP_Query( $args );

// Fetch the posts
$posts = $query->get_posts();

// Voila!

?> 
```

# java - How to extends JViewport correctly?

> ID：15012872
> 
> 赞同：-1
> 
> 时间：2013-02-21T21:48:07.133
> 
> 标签：java, swing, jscrollpane, jviewport

I am trying to design a class of endless coordinate board with a grid. I have extended a `JViewport` and it draws at initial position ok (inside `JScrollPane`). How to tell scroll pane that there are some space to scroll in any direction?

The following does not help

```
 JCoordinateViewport coordinate = new JCoordinateViewport();
            coordinate.setBackground(Color.WHITE);
            //coordinate.setPreferredSize(new Dimension(10000, 10000));

            JScrollPane scroll = new JScrollPane();
            //scroll.setViewportView(coordinate);
            scroll.setViewport(coordinate);
            scroll.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
            scroll.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
            scroll.getVerticalScrollBar().setMinimum(-10000);
            scroll.getVerticalScrollBar().setMaximum(+10000);
            scroll.getHorizontalScrollBar().setMinimum(-10000);
            scroll.getHorizontalScrollBar().setMaximum(+10000); 
```

**UPDATE**

Does anybody knows how JScrollPane determines scroll ranges from it's viewport?

**UPDATE2**

I found, that scrollbars appear t work if maximums and minimums are set after `setVisible` called.

But unfortunately, `paintConponent` does not called upon scroll.

Why?

**UPDATE3**

Although scroll bars work, they don't change viewport position.

Why?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T02:53:40.577

如此处所示[，](https://stackoverflow.com/a/3518047/230513)在 a 上绘画`JViewport`似乎“粘”在视口上，而在底层可滚动组件上绘画则滑到下方。尺寸是 的整数倍`TILE`：出于演示目的，视口的首选尺寸小于底层面板；在实践中，最好覆盖[`getPreferredSize()`](https://stackoverflow.com/q/7229226/230513). 另请参阅 [`ScrollAction`](https://stackoverflow.com/a/7203419/230513)，当鼠标悬停在任何边框附近时，它会自动滚动。

![图片](../Images/0f7ea21b9aaa428b226962dabc010232.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T21:59:42.517

```
CoordinateViewport coordinate = new JCoordinateViewport(); coordinate.setBackground(Color.WHITE); //coordinate.setPreferredSize(new Dimension(10000, 10000));

JScrollPane scroll = new JScrollPane(); //scroll.setViewportView(coordinate);
scroll.setViewport(coordinate); 
scroll.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS); 
scroll.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS); 
scroll.getVerticalScrollBar().setMinimum(-10000); 
scroll.getVerticalScrollBar().setMaximum(+10000); 
scroll.getHorizontalScrollBar().setMinimum(-10000); 
scroll.getHorizontalScrollBar().setMaximum(+10000); 
```

.

> 以下没有帮助

*   那么问题应该只在有名字的类中`CoordinateViewport`

*   为了获得更好的帮助，请尽快发布[SSCCE](http://sscce.org/)，简短，可运行，可编译，差不多`JFrame`，`JScrollPane`和`JViewport`

*   为了减少闪烁，`JViewport`需要设置

    1.  自己的`RepaintManager`

    2.  并通过使用/使用内置方法`JViewport`

    JViewport.setScrollMode(JViewport.BLIT_SCROLL_MODE); JViewport.setScrollMode(JViewport.BACKINGSTORE_SCROLL_MODE); JViewport.setScrollMode(JViewport.SIMPLE_SCROLL_MODE);

*   请参阅[传递当前日期](https://stackoverflow.com/questions/8614972/passing-current-date)和[JTable 如何将背景颜色更改为](https://stackoverflow.com/questions/8197261/jtable-how-to-change-background-color)[SSCCE](http://sscce.org/)的潜在来源

# jquery - backbone model is only returning and object, or JSON {readyState : 1}

> ID：15012878
> 
> 赞同：0
> 
> 时间：2013-02-21T21:48:39.180
> 
> 标签：jquery, json, backbone.js

I am still learning backbone and building my first app at the same time, so any help to get the ball rolling again would be awesome.

First, all i am trying to do it is get the proper response from the backbone. I am 100% sure that the server is sending me pure JSON, as I can check it in the browser via a URL. Same url as the `urlRoot` in my code, its just saved in a var.

I had this *kind of* working before but i was getting a JSON response through a collection(it look okay), which i later found was not the best, and I would rather get data through models. But I can not seem to get the same return from the server using models.

Here is my code: Model:

```
 var CalendarDay = Backbone.Model.extend({ 
  urlRoot: daysURL      
});

var calendarItem = new CalendarDay(); 
```

Shouldn't I just be able to do this `console.log(calendarItem.fetch())` and get the correct JSON response?

This is what my console shows: ![](../Images/09d19bf45176238ec582fe80e321cc0e.png)

What i want is the "responseText" potion only...

This also means that using `calendarItem.get(*****)` doesnt work.

Any ideas ladies/gents?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:51:24.087

您在屏幕截图中看到的是由`fetch`. 此对象表示异步 ajax 调用而不是响应文本。

responseText 是一个列表而不是单个对象。所以`calendarItem`将包含列表而不是项目属性。试穿`console.log`（`calendarItem.attributes`等待`fetch`完成后。）

如果您只想获取项目，则可以使用函数作为模型的 url 属性 - 然后您可以将 ID 传递给模型并`.url()`返回该日历项目的资源位置。

# iphone - No Known class method for selector 'myTimer'

> ID：15012883
> 
> 赞同：0
> 
> 时间：2013-02-21T21:49:03.050
> 
> 标签：iphone, objective-c, cocoa-touch, ios6

Have basically two view controllers oneviewcontroller and mainviewcontroller. In oneviewcontroller defined myTimer. In mainviewcontroller i m trying to pause and resume myTimer using UIButton. But getting message **No Known class method for selector 'myTimer'**

In OneViewController defined NSTimer as myTimer

```
@property (nonatomic, retain) NSTimer *myTimer;

@synthesize myTimer;

- (void)viewDidLoad {

[self myTimerMethod];

[super viewDidLoad];

}

- (void)myTimerMethod{

 NSLog(@"myTimerMethod is Called");

myTimer = [NSTimer scheduledTimerWithTimeInterval:2.4
                                           target:self
                                         selector:@selector(updateView:)
                                         userInfo:nil
                                          repeats:YES];

}

- (void)updateView:(NSTimer *)theTimer
 {
 if  (index < [textArray count])
 {

  self.textView.text = [self.textArray objectAtIndex:index];
  self.imageView.image = [self.imagesArray objectAtIndex:index];
  index++;
  }else{

  index = 0;

  } 
```

I m trying to pause and resume myTimer from mainviewcontroller

In mainviewcontroller.h

```
 @class OneViewController;

   @property (strong, nonatomic) OneViewController *oneviewcontroller;
   @synthesize oneviewcontroller = _oneviewcontroller;

  -(void)playpauseAction:(id)sender {

   if([audioPlayer isPlaying])
    {
    [sender setImage:[UIImage imageNamed:@"music.png"] forState:UIControlStateNormal];

    [audioPlayer pause];

    [[OneViewController myTimer] invalidate];    **\\No Known class method for selector 'myTimer'**

    }else{

    [sender setImage:[UIImage imageNamed:@"audiostop.png"] forState:UIControlStateNormal];

    [audioPlayer play];

    [[OneViewController myTimer] fire];  **\\No Known class method for selector 'myTimer'**

    if(isFirstTime == YES)
    {
        self.timer = [NSTimer scheduledTimerWithTimeInterval:06.0
                                                      target:self
                                                    selector:@selector(displayviewsAction:)
                                                    userInfo:nil
                                                     repeats:NO];
        isFirstTime  = NO; } } } 
```

how can i fix this error.

Thanks for help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:58:59.987

而不是 `[[OneViewController myTimer] invalidate];`使用`[self.oneviewcontroller.myTimer invalidate];`

此外，在 OneViewController 实现中，而不是`myTimer = [NSTimer scheduledTimerWithTimeInterval:.....`使用`self.myTimer = [NSTimer scheduledTimerWithTimeInterval:.....`

# android - 为什么 SKIA 不使用自定义 FilterInputStream？

> ID：15012884
> 
> 赞同：0
> 
> 时间：2013-02-21T21:49:03.720
> 
> 标签：android, bitmap, inputstream, skia

我正在尝试从扩展的 FilterInputStream 解码位图。我必须对图像数据执行动态字节操作，以向 SKIA 提供可解码的图像，但是 SKIA 似乎忽略了我的自定义 InputStream 并初始化了它自己的一个......

当我运行我的测试应用程序时，尝试加载 2mb 大的 JPEG 会导致`ObfuscatedInputStream.read([])`仅从`BitmapFactory.decodeStream()`

似乎一旦从我检索到的前 16kb 数据确定文件类型，`ObfuscatedInputStream`它就会初始化自己的本机流并从中读取，有效地渲染我对输入流应该如何工作所做的所有更改无用......

这是我扩展的 FilterInputStream 类中的缓冲读取函数。函数顶部的 Log.d 只执行一次。

```
@Override
public int read(byte b[], int off, int len) throws IOException 
{
    Log.d(TAG, "called read[] with aval + " + super.available() + " len " + len);
    int numBytesRead = -1;

    if (pos == 0)
    {
        numBytesRead = fill(b);
        if (numBytesRead < len)
        {
            int j;
            numBytesRead += ((j = super.read(b, numBytesRead, len - numBytesRead)) == -1) ? 0 : j ;
        }
    }
    else
        numBytesRead = super.read(b, 0, len);

    if (numBytesRead > -1)
        pos += numBytesRead;
    Log.d(TAG, "actually read " + numBytesRead);
    return numBytesRead;
} 
```

有没有人遇到过这个问题？似乎获得我想要的行为的唯一方法是重写部分 SKIA 库......我真的很想知道 InputStream 参数的意义是什么，如果本机实现初始化它自己的流......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:39:43.863

事实证明，它无法从它接收的前 1024 个字节中检测到它是一个实际图像。如果它没有检测到该文件是一个实际图像，它将不会打扰解码其余部分，因此只调用了 read[]一次。

# sql - 如何在 SQL Server 中回滚或提交事务

> ID：15012886
> 
> 赞同：69
> 
> 时间：2013-02-21T21:49:09.720
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005

在我的存储过程中，我有三个插入语句。

在重复键值插入前两个查询生成错误

> *违反 PRIMARY KEY 约束*

第三个查询照常运行。

现在我希望如果任何查询产生任何异常，一切都应该回滚。

如果任何查询都没有产生任何异常，它应该被提交。

```
declare @QuantitySelected as char
    set @QuantitySelected = 2

    declare @sqlHeader as varchar(1000)
    declare @sqlTotals as varchar(1000)
    declare @sqlLine as varchar(1000)

    select @sqlHeader = 'Insert into tblKP_EstimateHeader '
    select @sqlHeader = @sqlHeader + '(CompanyID,CompanyName,ProjectName,EstimateID,EstimateHeader,QuoteDate,ValidUntil,RFQNum,Revision,Contact,Status,NumConfigurations) '
    select @sqlHeader = @sqlHeader + ' select CompanyID,CompanyName,ProjectName,EstimateID,EstimateHeader,QuoteDate,ValidUntil,RFQNum,Revision,Contact,Status,NumConfigurations '
    select @sqlHeader = @sqlHeader +  'from V_EW_Estimate_Header where EstimateID = 2203'

    select @sqlTotals = 'Insert into tblKP_Estimate_Configuration_Totals '
    select @sqlTotals = @sqlTotals + '(ConfigRecId,RecId,SellQty,ConfigNum,ConfigDesc,SortOrder,OptionsInMainPrice,MarkupPctQty,'
    select @sqlTotals = @sqlTotals + ' SellPriceQty,RubberStamp,OptPriceQty,StatusRecid,LastUpdate_Date,LastUpdate_User,TotalCost,QuantityBracketSelected)'
    select @sqlTotals = @sqlTotals + ' select ConfigRecId,RecId,SellQty' + @QuantitySelected + ',ConfigNum,ConfigDesc,SortOrder,OptionsInMainPrice'
    select @sqlTotals = @sqlTotals + ' ,MarkupPctQty' + @QuantitySelected + ',SellPriceQty' + @QuantitySelected + ',RubberStamp,OptPriceQty' + @QuantitySelected + ',StatusRecid,LastUpdate_Date,LastUpdate_User,TotalCost' + @QuantitySelected + ',' + @QuantitySelected
    select @sqlTotals = @sqlTotals + ' from v_EW_Estimate_Configuration_Totals where ConfigRecId = -3'

    select @sqlLine = 'Insert into tblKP_Estimate_Configuration_Lines'
    select @sqlLine = @sqlLine + '(MstrRfqRecId,RfqRecId,RfqLineRecId,CompanyId,VendorQuoteNum,LineGrp,LineNum,StatusRecId,'
    select @sqlLine = @sqlLine + ' LineDesc,LineSize,LineMatl,LineDeco,LineFinish,CopyFromRecId,PerPieceCost,IsOptional,'
    select @sqlLine = @sqlLine + ' CopyToNewRev,RecId,UnitPrice,LineQty,LinePrice,CustOrVend,SellQty1,RfqNum,ConfigLineIsOptional,ConfigLinePerPieceCost,ConfigLineRecid,SellPrice,SaleQty)'
    select @sqlLine = @sqlLine + ' select distinct MstrRfqRecId,RfqRecId,RfqLineRecId,CompanyId,VendorQuoteNum,LineGrp,LineNum,'
    select @sqlLine = @sqlLine + ' StatusRecId,LineDesc,LineSize,LineMatl,LineDeco,LineFinish,CopyFromRecId,PerPieceCost,IsOptional,'
    select @sqlLine = @sqlLine + ' CopyToNewRev,RecId,UnitPrice' + @QuantitySelected + ',LineQty' + @QuantitySelected + ', isnull(LinePrice' + @QuantitySelected + ', 0.0000),CustOrVend,SellQty' + @QuantitySelected + ',RfqNum,ConfigLineIsOptional,ConfigLinePerPieceCost,ConfigLineRecid,SellPrice' + @QuantitySelected + ',SaleQty' + @QuantitySelected
    select @sqlLine = @sqlLine + ' from v_EW_EstimateLine  where rfqlinerecid in (select RfqLineRecID from kp_tblVendorRfqConfigLine where ConfigRecID = -3) '

    exec( @sqlHeader)
    exec(@sqlTotals)
    exec(@sqlLine) 
```

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2013-02-21T21:57:25.517

好消息是 SQL Server 中的事务可以跨越多个批次（每个批次都`exec`被视为单独的批次。）

您可以将`EXEC`语句包装在 a 中`BEGIN TRANSACTION`，`COMMIT`但如果发生任何错误，您需要更进一步并回滚。

理想情况下，您会想要这样的东西：

```
BEGIN TRY
    BEGIN TRANSACTION 
        exec( @sqlHeader)
        exec(@sqlTotals)
        exec(@sqlLine)
    COMMIT
END TRY
BEGIN CATCH

    IF @@TRANCOUNT > 0
        ROLLBACK
END CATCH 
```

而我相信你已经很熟悉了`BEGIN TRANSACTION`。`COMMIT`和块基本上是用来捕捉和处理发生的任何错误的`BEGIN TRY`。`BEGIN CATCH`如果您的任何`EXEC`语句引发错误，代码执行将跳转到该`CATCH`块。

您现有的 SQL 构建代码应该在事务之外（上图），因为您总是希望使事务尽可能短。

# python - Django/Jinja2：通过模板语法生成（数据）CSV

> ID：15012887
> 
> 赞同：0
> 
> 时间：2013-02-21T21:49:17.323
> 
> 标签：python, django, csv, jinja2

我想使用类似模板的语法为 CSV 文件（或任何合理的导出格式）生成数据，以访问我的 django 对象的字段。例如，输出字段的规范可能是：

```
employee.id
employee.manager.first_name
employee.user.last_login
employee.contact.phone_number 
```

使用与我在 Django 或 Jinja2 模板中使用的相同语法指定字段的位置。

我也希望能够像在 django/jinja 模板中一样使用过滤器：

```
employee.user.last_login|date:"c" 
```

鉴于此规范和对象列表，我想从我的对象中生成数据行。然后我可以从这些数据中生成 CSV、XML 等。

我开始写一些东西来做这件事，但它很快就变得复杂了，我想我可能可以使用一些现有的 Django/Jinja2 模板引擎。

有什么东西可以让我通过 Django/Jinja2 语法访问我的对象吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T04:00:25.117

首先，使用除模块之外的任何技术生成 CSV 数据`csv`不会为您赢得很多朋友；这是完成这项工作的正确工具。

使用该模块生成输出的最*方便*[`writer.writerows()`](http://docs.python.org/2/library/csv.html#csv.csvwriter.writerows)的方法是 with ，它采用嵌套列表（或者更确切地说，是序列的迭代器）。生成器是一种很好的表达方式：

```
def csv_spec(queryset):
    for employee in queryset:
        yield (
            employee.id,
            employee.manager.first_name,
            employee.user.last_login,
            employee.contact.phone_number)

w = csv.writer(outfile)
w.writerows(csv_spec(something)) 
```

* * *

编辑：所以你说你想要一个模板之类的东西，原因与我们使用模板的原因相同，但它产生的是 CSV 而不是文本。您可以要求 jinja 解析和处理它在占位符中的各种表达式，而无需完整的模板。

假设我们有一些数据：

```
>>> from collections import namedtuple
>>> from datetime import datetime
>>> Employee = namedtuple('Employee', 'id manager user contact')
>>> Person = namedtuple('Person', 'first_name last_name')
>>> Account = namedtuple('Account', 'username password last_login')
>>> Contact = namedtuple('Contact', 'phone_number email')
>>> data = [
...     Employee(0, Person('Alice', 'Brown'),
...              Account('abrown', 'secret', datetime(2013, 3, 3)),
...              Contact('5551234', 'abrown@example.com')),
...     Employee(1, Person('Bob', 'Jones'),
...              Account('bjones', 'safe', datetime(2013, 3, 3)),
...              Contact('5555678', 'bjones@example.com')),
...     Employee(2, Person('Carol', 'Smith'),
...              Account('csmith', 'hidden', datetime(2013, 3, 3)),
...              Contact('5559012', 'csmith@example.com'))] 
```

和一个模板（你可以很容易地从文件中读取它）

```
>>> import StringIO
>>> template = StringIO.StringIO('''employee.id
... employee.manager.first_name
... employee.user.last_login
... employee.contact.phone_number''') 
```

要使用表达式编译器，您需要一个环境；无需指定选项：

```
>>> import jinja2
>>> env = jinja2.Environment()
>>> template_filter = map(env.compile_expression, template) 
```

正如我提到的，使用 csv 模块：

```
>>> import csv
>>> import sys
>>> writer = csv.writer(sys.stdout) 
```

最后，使用编译后的表达式，我们可以一次运行一个“行”数据，并且对于每一行，应用每个表达式

```
>>> writer.writerows([[field(employee=row) for field in template_filter]
...                   for row in data])
0,Alice,2013-03-03 00:00:00,5551234
1,Bob,2013-03-03 00:00:00,5555678
2,Carol,2013-03-03 00:00:00,5559012 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T01:51:34.183

Django Docs 是一个很好的资源 - [http://docs.python.org/2/library/csv.html](http://docs.python.org/2/library/csv.html)

您只需要知道 python 中用于访问对象属性的点表示法。

# html - 如何在 HTML5 中居中和换行文本

> ID：15012891
> 
> 赞同：1
> 
> 时间：2013-02-21T21:49:27.333
> 
> 标签：html

我正在尝试构建一个简单的 HTML5 页面，该页面在页面中心显示一个 URL。我在这里找到了一些很好的答案：

[CSS：水平和垂直居中文本？](https://stackoverflow.com/questions/8187275/css-center-text-both-horizontal-and-vertical)

我一直在使用詹姆斯约翰逊的答案，效果很好。

问题是我正在编写此页面以显示在小屏幕上，即使没有换行符，我也需要正确换行 URL。添加 word-wrap:break-word; 选项似乎没有帮助 - 文本在屏幕上被截断了一半。

有谁知道我怎样才能让我的居中文本正确换行？

根据要求，这是我的确切代码。边框没有换行，而是增加了超过 200 像素宽：

```
<!DOCTYPE HTML>
<html>

<style type="text/css"> 
#container {     
    display:table;     
    border-collapse:collapse;   
    height:200px;   
    width:200px; 
    border:1px solid #000; 
}          
#layout {     
    display:table-row;    
}            
#content {     
    display:table-cell;   
    text-align:center;  
    vertical-align:middle;   
word-wrap:break-word; 
}            
</style>      
<div id="container">     
    <div id="layout">     
        <div id="content">     
wefweflwjfijapowefjiaiwfejawi3af3ijwiiwajefajioaiwejcajjcap8uc83yw75078n377777777777777777777777777u9fjhfwjifwe7f902352698hiogn;lkegrierg90q3itoijaw4aw[igpjaw84h0q92jrjgauw-8rua 
        </div>      
    </div>    
</div> 

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-11T15:02:49.367

对于跨浏览器 CSS 方法，请尝试[此解决方案](https://stackoverflow.com/a/1638824/4746087)

```
.wordwrap { 
   white-space: pre-wrap;      /* CSS3 */   
   white-space: -moz-pre-wrap; /* Firefox */    
   white-space: -pre-wrap;     /* Opera <7 */   
   white-space: -o-pre-wrap;   /* Opera 7 */    
   word-wrap: break-word;      /* IE */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:59:36.453

您可以尝试使用媒体查询在低分辨率链接中添加中断：

```
.yourselector br { display: none; }

@media (max-width: 320px) {
.yourselector br { display: block; }
} 
```

# asp.net - IIS url 重写 | 如何删除目录和扩展名？

> ID：15012893
> 
> 赞同：6
> 
> 时间：2013-02-21T21:49:29.807
> 
> 标签：asp.net, iis, url-rewriting, web-config, iis-8

我已经为以下问题苦苦挣扎了一段时间：

默认网址：

```
examplesite.com/folder/about.cshtml 
```

所需网址：

```
examplesite.com/about 
```

基本上我想完成两件事：

*   1 使用非常紧凑的代码删除文件扩展名。
*   2 删除包含关于页面的文件夹。

我发现了一些不常见的规则来实现上述所有目标，但它们大多包含大量冗余代码，当我使用 IIS 8.0 测试它时会导致我的网站崩溃。

所以我希望有人可以分享一个紧凑且适合我需要的规则。或具有相同结果的单独规则。

非常感谢每一个贡献:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T23:13:00.607

我不确定我是否完全理解您的需求，但这里有一些至少很接近的东西。它去掉了第一个文件夹和文件扩展名（因此`examplesite.com/folder/about.cshtml`变成`examplesite.com/about`和`examplesite.com/folder/help/about.cshtml`变成`examplesite.com/help/about`）。如果您想删除**所有**文件夹，则只需删除`?`.

```
<rule name="Remove Directory and Extension">
    <match url="^(.*?)/(.*)\.cshtml$" />
    <action type="Rewrite" url="{R:2}" />
</rule> 
```

**更新：**

好的，我认为您想要的是两个规则的组合：

```
<rules>
  <rule name="Redirect requests to friendly URLs">
    <match url="^(.*?)/(.*)\.cshtml$" />
    <action type="Redirect" url="{R:2}" />
  </rule>
  <rule name="Rewrite friendly URLs to phsyical paths">
    <match url="^(.*)$" />
    <action type="Rewrite" url="folder/{R:0}.cshtml" />
  </rule>
</rules> 
```

第一条规则确保所有请求都发送到友好的 URL。第二个获取友好 URL 并将其重写为您的物理路径，其中物理路径为`folder/[FRIENDLY_PATH].cshtml`.

# c++ - C++ 模板优化

> ID：15012896
> 
> 赞同：0
> 
> 时间：2013-02-21T21:49:35.040
> 
> 标签：c++, templates, optimization, sizeof, unsigned-integer

编译器何时会/可以**优化模板方法的部分？**它会**删除无法访问的代码**，**解开不必要的循环**吗？*（位使用**无符号整数**块，整数使用**无符号长**整数）*

另外，是否有 c++ 数据类型表示“我是您的处理器注册表大小的整数”？

```
template<size_t bits> class IntegerFactoryImpl : public IntegerFactory<Integer<bits>>{
private:
    template<int sizeOfLong, int sizeOfInt> Integer<bits> getOne(const Bits& b) const{

        Integer<bits> integer = this->getOne();
        size_t roof = (b.blocks() > integer.size()*(sizeOfLong/sizeOfInt))? integer.size()*(sizeOfLong/sizeOfInt) : b.blocks();
        for(size_t i = 0; i < roof; ++i){
            integer.at(i/(sizeOfLong/sizeOfInt)) = 0;
            for(size_t j = 0; j < (sizeOfLong/sizeOfInt); ++j){
                if(i % (sizeOfLong/sizeOfInt) == j){
                    integer.at(i/(sizeOfLong/sizeOfInt)) |= ((unsigned long)b.block(b.blocks()-i-1)) << (sizeOfInt*j);
                    break;
                }
            }
        }
        for(size_t i = roof; i < integer.size()*(sizeOfLong/sizeOfInt); ++i){
            if(i % (sizeOfLong/sizeOfInt) == 0){
                integer.at(i/(sizeOfLong/sizeOfInt)) = 0;
            }
        }
        return integer;
    }

public:

    virtual ~IntegerFactoryImpl() throw(){}

    virtual Integer<bits> getOne() const{
        return Integer<bits>();
    }

    virtual Integer<bits> getOne(const Bits& b) const{
        return this->getOne<sizeof(unsigned long)*8, sizeof(unsigned int)*8>(b);
    }
}; 
```

这段代码会不会有区别（没有模板方法）：

```
template<size_t bits> class IntegerFactoryImpl : public IntegerFactory<Integer<bits>>{

public:

    virtual ~IntegerFactoryImpl() throw(){}

    virtual Integer<bits> getOne() const{
        return Integer<bits>();
    }

    virtual Integer<bits> getOne(const Bits& b) const{

        Integer<bits> integer = this->getOne();
        size_t roof = (b.blocks() > integer.size()*((sizeof(unsigned long)/sizeof(unsigned int)))? integer.size()*((sizeof(unsigned long)/sizeof(unsigned int)) : b.blocks();
        for(size_t i = 0; i < roof; ++i){
            integer.at(i/((sizeof(unsigned long)/sizeof(unsigned int))) = 0;
            for(size_t j = 0; j < ((sizeof(unsigned long)/sizeof(unsigned int)); ++j){
                if(i % ((sizeof(unsigned long)/sizeof(unsigned int)) == j){
                    integer.at(i/((sizeof(unsigned long)/sizeof(unsigned int))) |= ((unsigned long)b.block(b.blocks()-i-1)) << ((sizeof(unsigned int)*8)*j);
                    break;
                }
            }
        }
        for(size_t i = roof; i < integer.size()*((sizeof(unsigned long)/sizeof(unsigned int)); ++i){
            if(i % ((sizeof(unsigned long)/sizeof(unsigned int)) == 0){
                integer.at(i/((sizeof(unsigned long)/sizeof(unsigned int))) = 0;
            }
        }
        return integer;
    }
}; 
```

（编辑：我刚刚发现代码不能正常工作（我修复了它）但原来的问题仍然适用..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:12:29.437

是的，编译器会优化掉它可以在编译时计算的东西，如果你有一个只迭代一次的循环（例如`for(i = 0; i < 1; i++)`，它会完全删除循环。

至于整数大小，它真的取决于你想要达到的目标，如果它更好地使用`long`or `int`。例如，在 x86-64 中，一个 64 位操作会占用一个额外的字节来指示后面的指令是 64 位指令而不是 32 位指令。如果编译器做了`int`64 位长，代码会变得（一点点）更大，因此不太适合缓存等。16 位、32 位或 64 位操作之间没有速度优势 [对于 99%运算，乘法和除法是一些明显的例外 - 数字越大，除法或相乘所需的时间越长（（实际上，数字中 SET 的位数会影响乘法时间，我相信除法也是如此） ) ] 在 x86-64 中。当然，例如，如果您正在使用这些值来执行位掩码操作等，那么 using`long`将为您提供 64 位操作，这需要一半的操作来执行相同的操作。这显然是一个优势。因此在这种情况下使用它是“正确的” `long`，即使它为每条指令添加了一个额外的字节。

还要记住，通常`int`用于“较小的数字”，因此对于很多事情，额外的大小`int`只会被浪费，并占用额外的数据缓存空间等。所以`int`仍然是 32 位将大整数数组等的大小保持在合理的大小。

# iphone - 如何以编程方式在位置上触发 UILongPressGestureRecognizer

> ID：15012900
> 
> 赞同：-1
> 
> 时间：2013-02-21T21:50:22.693
> 
> 标签：iphone, ios, objective-c

我需要在 UIWebView 的特定位置发送 UILongPressGestureRecognizer 而无需用户交互。我正在处理的项目旨在上传到 AppStore，因此给定的解决方案必须是“合法的”。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T18:04:57.050

当网页上满足条件时，让网页上的点击向应用程序发送一个 URL。对 URL 方案进行谷歌搜索（有很多示例）并在您的应用程序中设置处理程序。使用您的网页 html/javascript 代码检测长按，并在发生时发送 URL 方案。例如，就像您发送“mailto:” url 以向您的电子邮件应用程序发送信号一样，您使用“myFoobarapp:” url 来向您的应用程序触发信号。该应用程序检测 URL 方案并执行您想要的操作。使用 URL 方案是从网页到您的应用程序通信的认可方法。确保您查看现有的 url 方案，以便您选择的方案（即 myFoobarapp）尚未被采用。

# c++ - 哪个 C++ IDE 支持快速 TDD 工作流程和 Google 或 Boost Test 框架？

> ID：15012910
> 
> 赞同：1
> 
> 时间：2013-02-21T21:50:40.603
> 
> 标签：c++, ide, tdd

到目前为止，这就是我所做的（我使用 Visual Studio）：

1.  创建测试项目
2.  添加一些测试
3.  添加代码。编译并运行
4.  当测试失败时，编写代码使其通过
5.  重复前面的 3 个步骤，直到我有我想要的代码。
6.  创建一个使用测试代码的主项目。
7.  在功能/错误修复中使用经过测试的代码。
8.  在某个地方，存在一个需要更改测试代码的问题。
9.  我现在需要转到测试项目并重复步骤 2 到 5。
10.  然后回到主项目并编译并运行以验证功能/错误修复。

我想消除的是对两个不同项目的需求，并减少我在构建之间等待的时间和所需的上下文切换。本质上，我想收紧测试代码测试循环。

假设有一个 IDE，其中测试是主项目本身的一部分。我们还假设 IDE 可以识别测试通过和失败。最后，假设编译和运行测试发生在后台，我只需要在代码未构建或测试失败时处理错误。

我的工作流程现在只涉及一个项目：

1.  创建项目
2.  在项目中添加一些测试
3.  添加代码。节省。
4.  当测试失败时，编写代码使其通过
5.  重复步骤 2 到 5，直到获得所需的代码。
6.  添加使用测试代码实现功能或错误修复的逻辑。
7.  如果需要更改测试代码，请返回步骤 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T23:07:11.247

除了琐碎的项目外，每次保存时都编译 C++ 代码通常非常耗时。也就是说，[Eclipse CDT](http://www.eclipse.org/cdt/)可以选择在构建之前保存更改。因此，您可以让构建命令触发保存，而不是保存命令触发构建，这在概念上是不同的，但具有相同的效果。要减少后续构建的构建时间，您可以使用[ccache 之](http://ccache.samba.org/)类的东西。

至于运行测试，您可以在 Eclipse 中通过添加一个运行单元测试的目标来执行此操作，该目标也可以由构建触发。当然，您可以在一个项目中拥有测试和代码。

# c# - 从方法写入 JSON 文字

> ID：15012911
> 
> 赞同：0
> 
> 时间：2013-02-21T21:50:41.673
> 
> 标签：c#, json, razor

我想在cshtml页面（剃刀）中打印一个json文字，我想在javascript中填充一个json对象并在页面加载时准备好，而不是等到页面加载然后进行ajax调用。

我想要做的是

```
/*Some view*/

@{
    ViewBag.Title = "Some title";         

}
<script>
    _SERVER_["someVar"] ="@SomeClass.Models.MovimientosMotivosModel.getMyarray()";
</script> 
```

问题是当我尝试序列化 json 时，所有双引号都被替换为 html 编码，而我的 json 变得一团糟......怎么能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:55:13.740

使用`Json.Encode`方法：

```
<script>
    _SERVER_["someVar"] = @Html.Raw(Json.Encode(SomeClass.Models.MovimientosMotivosModel.getMyarray()));
</script> 
```

这将确保服务器端值被正确编码为您可以在客户端上访问的 javascript 对象。`@Html.Raw`另一方面，该方法不会像标准`@`Razor 函数那样对其进行 HTML 编码。

# php - 提交表单后，我的页脚更改位置 PHP MYSQL

> ID：15012914
> 
> 赞同：0
> 
> 时间：2013-02-21T21:50:46.203
> 
> 标签：php, html, mysql, css

我遇到了一个非常烦人的“错误”……我的页面有页眉、左侧边栏和页脚。在我提交表格后，一切都很好，除了现在页脚在页面中间！我尝试了我所知道的一切并进行了搜索，但我仍然无法解决这个问题。

提交前，页脚位于正确位置：http: [//i48.tinypic.com/ly1dl.jpg](http://i48.tinypic.com/ly1dl.jpg)
提交后，页脚位于页面中间：http: [//i47.tinypic.com/168a3uq.jpg](http://i47.tinypic.com/168a3uq.jpg)

这是代码：

标题：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="stylesheets/stylesheet.css" type="text/css" rel="stylesheet" />
<title>Wilson Electric & Alarm Company</title>
</head>
<body>
<div id="header">
<h1 id="toptitle"> Wilson Electric & Alarm Company </h1>
</div>
<div id="navigation_top">
</div>
<div id="column_left">
 <ul id="left_menu">
 <li> <a href="testing2.php"> Insert Page </a> </li>
 <li> <a href="search.php"> Search Page </a> </li>
 <li> <a href=""> Menu 4 </a> </li>
 <li> <a href=""> Menu 5 </a> </li>
 <li> <a href=""> Menu 6 </a> </li>
 <li> <a href="user.php"> User  </a> </li>
 <li> <a href="admin.php"> Admin  </a> </li>
 <li> <a href="login.php"> Login </a> </li>
 <li> <a href="create_username.php"> Create Username </a> </li>
 </ul>
 </div>
 <div id="content"> 
```

页脚：

```
</div>
<div id="footer">
This is a Footer.
</div>
</body>
</html> 
```

样式表：（在#container 之前我的样式表中还有一个默认重置）

```
#container {
width:100%;
height:100%;
}   
#header {
width: 100%;
height:120px;   
}
#column_left {  
float:left;
width:15%;
height:100%;
border-right: 3px solid #06F;
border-left: 3px solid #06F;    
}
#content {
width:100%;
height:100%;
}

#footer {

width:100%;
height: 30px;
border-top:3px solid #06F;
}
#navigation_top {
width:100%;
height:15px;
border-bottom:3PX solid #06F;
}
#toptitle {
padding:30px;
font-size:300%;
font-weight:700;
}
.formtitle {
font-weight:800;
font-size:150%;
}
#form {
margin-left:230px;
padding-top:30px;
}
table,th, td {
border: 1px solid black;
}
table {
width:1024px;
}
th {
font-weight:800;
background-color:#0FF;
} 
```

这是给我这些问题的页面代码！

```
<?php require_once("includes/connection.php"); ?>
<?php require_once("includes/functions.php"); ?>
<?php   

if (isset($_POST['search'])) {

$date1 = mysql_prep($_POST['date1']);
$date2 = mysql_prep($_POST['date2']);
$latte = mysql_prep($_POST['latte']);
$coffee = mysql_prep($_POST['paid']);

$query = "SELECT * 
          FROM payroll  
          WHERE (day BETWEEN '{$date1}' AND '{$date2}')
          AND (company = '{$latte}')  
          AND (paid = '{$coffee}')  
          ORDER BY day ASC ";

$result = mysql_query($query, $connection);     

$woof = "SELECT SUM(p.hours) AS sum_hours 
 , COUNT(DISTINCT p.day) AS cnt_days 
 FROM PAYROLL p 
 WHERE p.day BETWEEN '{$date1}' AND '{$date2}'  
 AND company = '{$latte}'  
 AND paid = '{$coffee}' ";

$raw = mysql_query($woof, $connection);
if(!$raw) { die(mysql_error());}
$meow = mysql_result($raw, 0, 0);
$days = mysql_result($raw, 0, 1);

if(!$result) {
    echo "FAIL"; 
     } else { 

     $message = "<table>
<tr>
<th> Date </th>
<th> Hours </th>    
<th> Job Title </th>
<th> Job Description </th>
<th> For </th>
<th> Paid </th>
</tr>";

while($row = mysql_fetch_array($result)) {

$company = $row['company']; 

if($company == 0) {
$company = "Wilson Electric";
} if($company == 1) {
    $company = "Wilson Rental";
    } if ($company == 2) {
        $company = "Church of Christ";
        }

$paid = $row['paid'];
    if($paid == 0) {
        $paid = "Yes";
        } else {
            $paid = "<form action=\"update.php\" method=\"post\" ><input type=\"checkbox\" name=\"paid\" value=\"0\"> NO ";
            }

$message .= "<tr>";
$message .=  "<td class=\"center\">" . $row['day'] . "</td>";
$message .=  "<td class=\"center\">" . $row['hours'] . "</td>";
$message .= "<td style=\"padding:5px;\">" . $row['job_title'] . "</td>";
$message .=  "<td style=\"padding:5px;\">" . $row['job_description'] . "</td>";
$message .=  "<td style=\"padding:5px;\">" . $company . "</td>";
$message .=  "<td class=\"center\">" . $paid . "</td>"; 

$message .=  "</tr>";
}
$message .=  "<tr>";
$message .=  "<td class=\"center\"> Total Days:  " . $days . "</td>";
$message .=  "<td class=\"center\"> Total Hours: " . $meow . "</td>";
$message .=  "<td class=\"center\"> &nbsp; </td>";
$message .=  "<td class=\"center\"> &nbsp; </td>";
$message .=  "<td class=\"center\"> &nbsp; </td>";
$message .=  "<td class=\"center\"> <input type=\"submit\" name=\"gamind\" value=\"Update\"> </form> </td>";
$message .=  "</tr>";
}
}

?>  
<?php include("includes/header.php"); ?>
<form action="" method="post" id="form">
<h1 class="formtitle"> Search </h1>
<br />

<table id="table1">
<th> From </th>
<th> To   </th>
<th> For </th>
<th> Paid </th>
<tr>
<td>
<input type="date" name="date1" value="" > 
</td>   
<td>
<input type="date" name="date2" value="" > 
</td>
<td>
<select name="latte" >
<option value="0"> Wilson Electric </option> 
<option value="1"> Wilson Rental </option> 
<option value="2"> Church of Christ</option> 
</select>
</td>
<td>
<input type="radio" name="paid" value="0"> Yes <br />
<input type="radio" name="paid" value="1"> No <br />
</tr>
<tr>
<td colspan="4" align="right"> <input type="submit" name="search" value="Search">
</td>
</tr>
</table>

<br />
<br />
<p>
<?php
    if(!empty($message)) {
        echo "<h1 class=\"formtitle\"> Payroll Result </h1>";
        echo $message;
        }
    ?>
</p>
</form>
<?php include("includes/footer.php"); ?>
    <?php mysql_close($connection); ?> 
```

很抱歉这个loooong帖子！我希望有人知道我的问题的解决方案！

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:07:11.470

这里有很多代码需要吸收，但我**认为**你的 $message 构建了 <tr>s，但是当你回显 $message 时，你不在 table 元素内..？

# xml - 转换从我的肥皂响应中收到的字段，以匹配 JSON 对象中的字段

> ID：15012916
> 
> 赞同：0
> 
> 时间：2013-02-21T21:50:52.123
> 
> 标签：xml, json, soap

我有一个关于我应该如何从肥皂调用中获取响应并将其传递给 JSON 对象的问题。

先说一下情况：

首先，我将基于 xml 的请求发送到基于肥皂的 Web 服务。我收到了 xml 格式的响应，我希望能够将此响应传递给 JSON 对象，并在转换从我的 soap 响应中收到的字段的过程中，以匹配 JSON 对象中的字段。

例如，我可能有

```
<FirstName>Bob<FirstName> 
```

作为我的肥皂响应中的一个字段，但我需要将其转换为适合我的 JSON 对象中名为“First”的变量。

对此问题的任何帮助将不胜感激，我对所有这些技术都是新手，并且大部分时间都在使用基本教程并将它们扩展到我目前需要的内容，但在这一点上已经陷入困境。如果需要更多澄清，我可以这样做！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T16:15:30.717

有一些从 XML 转换为 JSON 的标准方法（[Parker 约定](http://code.google.com/p/xml2json-xslt/wiki/TransformingRules)、[Badgerfish](http://www.sklar.com/badgerfish/)或使用[JsonML](http://en.wikipedia.org/wiki/JsonML)等），但是当您在 XML 和 JSON 之间有 1:1 的对应关系并且您不介意暴露一些看起来很奇怪的 JSON 时，它们会很好地工作客户（尊重所选标准）。

根据您提供的详细信息，我假设您已经有一个自然的 JSON 表示，并且您没有 1:1 的对应关系，因为`FirstName`XML 元素映射到`First`JSON。

您的应用程序位于 JSON 客户端和 SOAP 外部存储之间，因此在这种情况下，最可控的方式是使用应用程序中的对象并为对象提供两种表示形式：JSON 和 XML。

您的客户端发送一个 JSON 请求，您将其解组为请求对象，将对象编组为 XML，将其发送到 SOAP 存储，您将结果作为 XML 解组为响应对象，您现在将其编组为您的 JSON 响应最后发回给客户。通过使用中间的对象，您可以将[JAXB](http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding)用于 XML 表示，以及[杰克逊](http://wiki.fasterxml.com/JacksonJAXBAnnotations)对 JSON 的 JAXB 注释的支持。

无论是手动还是使用现有库，您都必须从 XML 映射到 JSON。

# c++ - 架构 x86_64 Xcode Mac 的未定义符号

> ID：15012917
> 
> 赞同：0
> 
> 时间：2013-02-21T21:50:55.880
> 
> 标签：c++, undefined, symbols

我需要一些帮助。最近尝试学习一些编程，遇到了一些问题，但都已经解决了。除了这个。我知道它已经被回答了很多次，但我从来没有为我的具体案例找到解决方案。我正在使用 Xcode V. 4.5.2 这是程序：

```
int add(int x, int y);

int main()

    using namespace std;
    cout << "3 + 4 + 5 = " << add(3, 4) << endl;
    return 0;
}

int add(int x, int y, int z)

    return x + y + z;
} 
```

它给了我这个错误：

> 架构 x86_64 的未定义符号：“add(int, int)”，引用自：main.o 中的 _main（也许您的意思是：__Z3addiii）ld：未找到架构 x86_64 的符号 clang：错误：链接器命令失败并退出代码 1（使用 -v 查看调用）

我不知道该怎么做。

我一直在关注本教程：

[http://www.learncpp.com/cpp-tutorial/17-forward-declarations/](http://www.learncpp.com/cpp-tutorial/17-forward-declarations/)

测验下的第五个程序就是这个。

谢谢柠檬汁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:53:35.383

您的前向声明是`int add(int x, int y);`，但您的定义是`int add(int x, int y, int z)`。第一个没有`int z`，但第二个有。他们需要 100% 匹配。定义大概应该是：

```
int add(int x, int y) {
    return x + y;
} 
```

该链接器错误告诉您“我不知道任何`add(int, int)`函数”，这是适当的，因为没有任何类型的`add(int, int)`函数的定义。只有一个`add(int, int, int)`功能，显然是不同的。

# javascript - 是否可以仅对图像指定 user-scalable="yes" ？

> ID：15012921
> 
> 赞同：4
> 
> 时间：2013-02-21T21:51:33.980
> 
> 标签：javascript, jquery, css, mobile, mobile-safari

我正在为移动设备开发课程讲座，并且禁用了缩放功能。我想对页面上除图像以外的所有内容保持这种方式。

当用户单击在页面内打开弹出窗口的链接时，通过 jquery 将 meta user-scalable="no" 替换为 "yes"，我已经接近了我之前的目标，允许用户在弹出窗口打开时放大，其中许多弹出窗口包含我想要启用缩放的图像。

但是，并非我希望用户能够放大的所有图像都在弹出窗口内，我也没有规定哪些内容应该放在哪里。我只控制 gui（css、脚本文件等）

有没有办法只对图像应用可扩展=“是”，同时保持其余的 gui 可扩展=“否”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T04:21:19.247

缩放页面的一部分（图像）而不是其余部分并没有真正的意义。我认为您可能会对浏览器中图像的默认行为感到满意。`user-scalable="no"`像往常一样为网站设置，因为图像具有在新窗口中打开它们的链接 ( `target="_blank"`)，这将打开一个新的浏览器选项卡并允许用户缩放，直到他们决定返回页面。

由于浏览器只需要显示图像的性能优势，与灯箱之类的方法相比，这种方法在移动设备上通常要优越得多。

我还要补充一点，当禁用用户缩放（包括我自己）时，许多用户会感到恼火。您可能需要考虑设置最小比例并允许用户根据需要进行缩放。

# perl - 无法使用 Selenium 远程驱动程序启动浏览器

> ID：15012923
> 
> 赞同：-1
> 
> 时间：2013-02-21T21:51:44.260
> 
> 标签：perl, selenium

我不知道为什么，但我无法使用以下代码启动浏览器。我在 Eclipse 上使用 EPIC。我为此安装了所需的硒模块。

当我运行下面提到的代码时出现此错误：“Could not connect to SeleniumWebDriver at C:/ProgramFiles/Perl/site/lib/Selenium/Remote/Driver.pm line 220”

任何帮助表示赞赏。

这是我的代码：

`use Selenium::Remote::Driver;`

 ````
my $driver = new Selenium::Remote::Driver(browser_name => 'firefox', port => 5555,
                                          platform => 'WINDOWS');
$driver->get('http://www.google.com');
print $driver->get_title();
$driver->quit(); 
````  `* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:04:27.813

它可能会在您注意到之前关闭页面？另外，我认为默认情况下 selenium 监听的端口号是`4444`.

尝试这个：

```
use Selenium::Remote::Driver;

my $driver = new Selenium::Remote::Driver(browser_name => 'firefox', port => 4444,
                                          platform => 'ANY',);
$driver->get('http://www.google.com');
sleep(200);
print $driver->get_title(),"\n";
$driver->quit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T20:54:03.170

我将 Selenium 版本更改为 2.31，它工作正常。以前我使用的是与 FF 19 不兼容的 2.28

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:36:47.653

查尔斯，我的电脑更新了新的 Java 版本，所以我的服务器启动文件无法启动服务器。我用正确的 java 路径更正了启动文件，它启动了浏览器。

但我不知道为什么它应该打开 google.com 时会出现空白页

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-19T13:04:07.407

在运行代码之前，您应该启动远程服务器。输入如下路径，您的 chrome 驱动程序和 jar 文件在系统中退出，然后

转到命令提示符并运行以下命令 - 请

java -Dwebdriver.chrome.driver="\输入文件夹路径\chromedriver.exe" -jar \输入文件夹路径\selenium-server-standalone-2.53.0.jar

如果您使用的是 Firefox，请编写以下代码。我的 $driver = Selenium::Remote::Driver->new();

对于 chrome 用户，我的 $driver = Selenium::Remote::Driver->new(browser_name => 'chrome');`

# extjs - 当更新发生匹配某些条件时，自动将子节点添加到 ExtJS TreePanel 的最佳方法？

> ID：15012924
> 
> 赞同：1
> 
> 时间：2013-02-21T21:51:47.373
> 
> 标签：extjs, extjs4.1

我正在使用 ExtJS 4.1.1 中的 TreePanel/TreeStore，启用了 autoSync 并通过 Ajax 代理定义了对服务器端点的 API 调用。

当使用某些属性集创建节点时，我让服务器在 autoSync 调用创建 API 端点期间自动添加 2 个子节点，服务器响应文本如下所示：

```
{
  "success" : true,
  "errorMsg" : null,
  "children" : {
    "id" : "toolbox-42",
    "parentId" : null,
    "itemName" : "My Toolbox",
    "nodeType" : "toolbox",
    "children" : [{
        "id" : "tool-91",
        "parentId" : "toolbox-42",
        "itemName" : "Default Tool 1",
        "nodeType" : "tool",
        "leaf" : true,
      }, {
        "id" : "tool-92",
        "parentId" : "toolbox-42",
        "itemName" : "Default Tool 2",
        "nodeType" : "tool",
        "leaf" : true
      }
    ]
  }
} 
```

`"children"`通过根级别的键设置节点的属性就可以了。该`"id"`属性设置在插入的节点上就好了。

我的问题是服务器添加的子节点没有出现在树中。如何将这些添加到树视图中？

以下是我考虑过的一些解决方案：

*   在服务器响应中，将根级`"children"`对象放入一个数组中，并将新节点附加到数组的末尾（而不是将它们嵌套在其父节点下）。[Ext.data.reader.Reader (source here](http://docs.sencha.com/ext-js/4-1/source/Reader2.html#Ext-data-reader-Reader) )中的 extractData 方法指示将提取所有返回的记录。*但是，* Ext.data.Operation ([这里](http://docs.sencha.com/ext-js/4-1/source/Operation.html#Ext-data-Operation)) 中的 commitRecords 方法只更新请求中包含的 clientRecords 的数量，这显然不包括服务器响应中的任何新记录。
*   在服务器响应后，使用服务器响应中的节点手动将记录添加到树存储客户端`"children"`。*但是，*似乎没有简单的方法可以将这些记录标记为“已同步”。
*   根本不要在服务器上添加记录；相反，在同步操作发生之前手动将它们添加到客户端（因此，同步操作将为服务器提供 3 个插入操作）。*但是，*创建请求中的子节点不会设置 parentId，因为服务器尚未添加父节点并返回 id 作为响应。
*   附加一个事件处理程序，该处理程序将在服务器添加父节点后触发一次，然后在客户端上以编程方式添加子节点（然后将自动同步到服务器）。*但是，*这需要 2 次服务器往返。此外，我知道的唯一候选事件是`'write'`在 Ext.data.TreeStore 中，并且没有相应的`'failwrite'`事件可用于在写入操作失败的情况下删除侦听器。我可以添加一个抽象层来提供它……但如果 Sencha 已经构建了更好的方法，我宁愿不这样做。

还有其他建议吗？我将接受有效的建议或描述 Sencha 建议如何解决此问题的任何声明/链接。

谢谢。

更新：我的商店、代理和阅读器配置如下：

```
 var store = Ext.create('Ext.data.TreeStore', {
    model :    'App.models.Task',
    autoLoad : true,
    autoSync : true,
    proxy : {
      type : 'ajax',
      api : {
        create :  appUrl + 'Data/InsertTreeData',
        read :    appUrl + 'Data/GetTreeData',
        update :  appUrl + 'Data/UpdateTreeData',
        destroy : appUrl + 'Data/DeleteTreeData'
      },
      reader : {
        type : 'json',
        messageProperty : 'errorMsg'
      }
    }
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T00:44:21.523

当我在服务器端向树中添加一个节点时，我所做的是获取父对象 id（它可以是根，这很好），然后运行如下所示的 refreshParent 例程：

```
var node = this.store.getNodeById(id);
if (node){
        this.store.load({node:node});
} 
```

这里的上下文是树面板。此例程重新加载树的特定分支。

# php - 基于 PHP SESSION 的购物车

> ID：15012926
> 
> 赞同：0
> 
> 时间：2013-02-21T21:51:57.073
> 
> 标签：php, session, shopping-cart, shopping

我正在使用`SESSION['cart']`购物车：

```
if(isset($_GET['product_id'])){

    echo 'Good request!';

    $product_id = $_GET['product_id'];
    if(!isset($_SESSION['cart'])){
        $_SESSION['cart'] = array();
        echo 'There is no cart!';
    }
    $cart_row = array(
        'product_id'=>$product_id
    );

    $_SESSION['cart'][] = $cart_row;
} 
```

当我使用以下方式添加项目时：

```
addToCart.php?product_id=12345 
```

不添加第一项，但添加后续项。

不知道为什么第一个项目没有进入数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:10:59.313

如果 $__GET['product_id'] 是值（比如 1、2 或 3），那么为什么不直接执行以下操作

```
 $_SESSION[‘cart’][]=$product_id;
 print_r($_SESSION); 
```

将输出： Array ( [cart] => Array ( [0] => 1 [1] => 2 [2] => 3 ) )

# android - 在 ListView 上显示最后几项

> ID：15012930
> 
> 赞同：1
> 
> 时间：2013-02-21T21:52:17.080
> 
> 标签：android, android-listview

我怎样才能将最后几项保留在`ListView`显示中？目前，我正在使用以下行来实现这一点。

```
lv.smoothScrollToPosition(lv.getCount()); 
```

但是，`smoothScroll()`这很烦人，因为它必须滚动所有`ListView`元素才能到达末尾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:56:01.703

`ListView.setSelection()`与您的首选位置一起使用。

# google-analytics - 缩短谷歌分析代码

> ID：15012932
> 
> 赞同：0
> 
> 时间：2013-02-21T21:52:21.847
> 
> 标签：google-analytics

可以在谷歌分析代码中的以下行：

```
ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js'; 
```

缩短为

```
ga.src = '//stats.g.doubleclick.net/dc.js'; 
```

?

完整的脚本如下所示：

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXXX-X']);
  _gaq.push(['_setDomainName', 'example.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T05:10:52.690

它被称为 a`Protocol Relative URL`并且使用一个来缩短 Google Analytics 代码可能会导致 IE6 出现一些问题。

来自 Paul Irish @Google 关于使用[协议相对 URL 的](http://paulirish.com/2010/the-protocol-relative-url/)内容：

> 在非“ssl”子域的某些安全设置下，IE6 中存在一个导致对话框爆炸的边缘错误。因此，如果您不关心 IE6，请随意从您的 GA 代码段中删除 40 个字节。否则您将需要那个三元运算符。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T23:45:16.977

如果你这样做，如果你使用协议加载这个文件来测试你的服务器，它将不起作用`file:`。除了那个小问题，它应该可以正常工作。

# java - 在 Java 中在运行时删除复杂对象

> ID：15012933
> 
> 赞同：2
> 
> 时间：2013-02-21T21:52:22.783
> 
> 标签：java, null, garbage-collection

在 Java 中，在代码中的某个时刻，我想释放一个巨大`HashMap<Integer, ArrayList<Integer>>`对象占用的内存。是否足以将其指向`null`如下：

```
Map<Integer, ArrayList<Integer>> complexObject = new HashMap<Integer, ArrayList<Integer>>(1000000);
...
complexObject = null; 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:54:56.477

您不能显式取消分配 Java 对象。但您可以执行以下操作：

1.  删除对不再需要的项目的所有引用。您可以通过将对象的唯一引用设置为`null`.
2.  调用`System.gc()`“建议”到 JVM 以运行垃圾收集器，这会释放不再使用的对象，但不能保证调用此方法会实际运行垃圾收集器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:54:46.180

如果在任何地方确实没有对所述对象的引用，则将其引用设置为 null 将在下次决定运行时将其标记为可用于垃圾收集器。然而，当 GC 决定运行时，并不是一成不变的。

这是Java与C不同的一个重要点，但不要担心。99.9% 的时间您可以相信 GC 会为您提供支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:55:21.283

不能保证释放内存。GC 将运行并拾取空值，所以这就是你所能做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T22:05:52.673

我刚读[了这篇文章](http://www.ibm.com/developerworks/java/library/j-jtp01274/index.html)，里面也有关于释放内存的内容。看看吧，归零并不总是对你有帮助。

# qt4 - 你如何保持主窗口的最小尺寸，但保持一个小部件的大小*除非*用户正在调整主窗口的大小？

> ID：15012949
> 
> 赞同：0
> 
> 时间：2013-02-21T21:52:55.467
> 
> 标签：qt4, pyqt4

我为有史以来最令人困惑的主题行道歉，但我认为我从根本上误解了有关布局和尺寸提示的一些东西。

我有一个主窗口，其中包含一个“主要”小部件和另一组可由用户显示或隐藏的组框。还有一些 QLabels 显示大小不同的状态信息，具体取决于正在发生的事情。主要小部件应尽可能大，但它可以是任意大小。

我想要的行为是主要小部件应该是恒定大小，并且每当其他小部件显示/隐藏或更改大小时主窗口应该增长或缩小。但是，当用户调整主窗口的大小时，主窗口小部件的大小应更改为占用其他窗口小部件未占用的所有可用空间。

如果我将主要小部件的最小尺寸设置为其当前尺寸，并在用户隐藏/显示组框时将主窗口的尺寸调整为最小尺寸，我将拥有我想要的大部分行为，除了小部件不能缩小。如果我让主要小部件的 sizepolicy 成为首选并改为调整 sizehint，将主窗口调整为最小尺寸总是将主要小部件调整为其最小尺寸。到目前为止，我尽最大努力尝试在对其他小部件进行任何更改之前设置最小尺寸，进行更改，将窗口调整为最小尺寸，然后在事情“平静下来”后恢复“真实”最小尺寸。我不是 100% 确定如何确保事情已经平静下来，发送已发布的事件，然后在处理程序中恢复零时间 QTimer 的最小大小似乎有点小故障，并且容易出现我不太了解的比赛。（有时窗口在隐藏某些东西后仍然很大，有时它似乎最小化了主要小部件，尽管我努力保护它。）

我有一种感觉，我只是错过了一些基本的东西，这应该比我做的要简单得多。任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T22:42:43.177

```
from PySide import QtGui

class MainWindow(QtGui.QMainWindow):
  def __init__(self):
    super(MainWindow, self).__init__()

    self.setCentralWidget(QtGui.QLCDNumber())

    toolbar = QtGui.QToolBar("MyToolbar", self)
    button = QtGui.QPushButton("Hide Me")
    button.clicked.connect(toolbar.hide)

    toolbar.addWidget(button)
    self.addToolBar(toolbar)

if __name__=='__main__':
  import sys

  app = QtGui.QApplication(sys.argv)

  w = MainWindow()
  w.show()

  sys.exit(app.exec_()) 
```

这有帮助吗？它是一个工具栏，但可能传播相同的原理？编辑：出于如此简单的目的，PySide 和 PyQt4 应该可以互换。

# c - gcc 调用后 GNU Make “Abort trap: 6” 但是调用在单独执行时有效

> ID：15012950
> 
> 赞同：8
> 
> 时间：2013-02-21T21:52:55.243
> 
> 标签：c, makefile, gnu-make

我正在使用 GNU Make 构建一个很多人都会使用的 C/C++ 项目。makefile 试图通用，因为该项目中有许多可选文件，每个用户通过 MATLAB 界面选择这些文件，然后通过命令行参数（make target OPTS='XYZ' 等）提供给 makefile。

当我使用 makefile 时，它​​会正确识别正确的对象依赖关系，然后继续查找这些对象的源先决条件并构建它们。但是，每次它尝试执行对象规则时，我都会在 gcc 调用之后立即收到一条错误消息“Abort trap: 6”。

Makefile如下

```
vpath %.c $(PATH) $(OBJ_DIR)
# Pick compilers
CC1=g++
CC2=gcc
LNK=g++
# Assign variables for c/cpp implicit rules
CXXFLAGS= $(CCFLAGS) $(DEFINES) $(INCLUDES)
CFLAGS = $(CCFLAGS) $(DEFINES) $(INCLUDES)

# Assign various user-defined values
OUTPUT = -o $(USER_LIB)
C_OBJECTS = $(patsubst %.c,$(OBJ_DIR)/%.o,$(C_SOURCES))
CPP_OBJECTS = $(patsubst %.cpp,$(OBJ_DIR)/%.o,$(CPP_SOURCES))
OBJECTS = $(C_OBJECTS) $(CPP_OBJECTS) $(SIM_OBJECTS)

# User Library Dependencies and Compilation Rules
$(USER_LIB): $(OBJECTS)
    $(LNK) $(LINKERFLAGS) $(CCFLAGS) $(DEFINES) $(INCLUDES) $(OUTPUT) $(OBJECTS)

$(OBJ_DIR)/%.o: %.c 
    $(CC2) $(CFLAGS) -c -o $@ $< 
```

我得到的一个例子是：

```
gcc -g -D(the defines)  -I(all the includes) -c -o obj1/xyz.o ../common/xyz.c
make: *** [obj1/xyz.o] Abort trap: 6 
```

但是，如果我采用完全相同的 gcc 调用并在命令行上运行它（只需复制和粘贴），则文件已正确编译，并且目标文件放置在 obj1 文件夹中。

我试图查看“make -d”，看看是否能找到任何东西。由于该输出很长，因此其要点如下：

```
... output truncated for brevity ...
gcc -g -D(the defines)  -I(all the includes) -c -o obj1/xyz.o ../common/xyz.c
Putting child 0x104f13cc0 (obj1/xyz.o) PID 24557 on the chain.
Live child 0x104f13cc0 (obj1/xyz.o) PID 24557 
Reaping losing child 0x104f13cc0 PID 24557 
make: *** [obj1/xyz.o] Abort trap: 6
Removing child 0x104f13cc0 PID 24557 from chain. 
```

此时输出结束。我还尝试运行 make -k 以查看第一个错误后会发生什么。每个单独的源文件都会产生相同的结果。同样，每个源文件都可以使用 make 独立完成时使用的确切调用进行编译。

在这一点上，我完全迷失了这一点，关于“中止陷阱：6”在这种情况下的含义的信息很少。

我正在运行通过 Xcode 安装 gcc-4.2 的 Mac OSX 10.7。

我意识到目前没有 .cpp 文件的规则，我目前没有要编译的任何 .cpp 源文件，尽管将来可能会有，这就是为什么到目前为止有支持结构的原因。

提前感谢任何可以帮助我的人。

编辑：从“make -d”输出中添加了一行。编辑：添加解决方案（移至答案）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:34:06.443

在帮助下，回答了我自己的问题。已解决：首先查看@MadScientist 对“中止陷阱：6”的评论。

鉴于这个线索，我意识到我使用了一个可能与系统变量 $(PATH) 混淆的变量。看来 Make 并没有按照我的预期解释以下行：

```
vpath %.c $(PATH) $(OBJ_DIR)                        <------ Bad 
```

系统变量 $(PATH) 似乎存在一些干扰，这可能会导致问题。只需将 vpath 变量更改为 $(SRC_PATH) 即可消除与系统变量的冲突和任何潜在的干扰，从而解决问题。

```
vpath %.c $(SRC_PATH) $(OBJ_DIR)                    <------ Good 
```

经验教训：注意变量名称并了解您的环境变量是什么。

感谢@MadScientist 指出“中止陷阱：6”的含义并提出环境问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-02T17:53:29.530

如果您的代码中有一个 assert 方法，您会收到该错误（中止陷阱：6）。

例如：

```
assert(numberOfItems >= 0); 
```

如果

```
numberOfItems < 0 
```

调用makefile时会出现这样的错误

# php - 使用 codeigniter 创建登录表单的问题

> ID：15012952
> 
> 赞同：0
> 
> 时间：2013-02-21T21:53:04.940
> 
> 标签：php, codeigniter

我首先在纸上画出了这个功能的逻辑，所以我在哪里做这个是有道理的。我创建了表单，表单在提交时调用控件类中的方法，然后发送到模型进行检查。

我相信我的控制器中的逻辑是正确的，所以我认为问题在于模型类中的方法。

```
function validate()
{
    $this->db->where('username', $this->input->post('username'));
    $this->db->where('password', $this->input->post('password'));
    $query = $this->db->get('membership');

    return $query;  
} 
```

我希望 $query 返回真或假，就像布尔值一样。相反，无论输入的数据是否与数据库中的数据匹配或完全错误，无论其输出是否正确。下面是控制器类中的方法；

```
function validate_credentials()
{       
    $this->form_validation->set_rules('username', 'username', 'required');
    $this->form_validation->set_rules('password', 'password', 'required');

    if ($this->form_validation->run() == FALSE)
    {
        $this->createAdminForm();
    }
    else
    {
        $this->load->model('admin_Model');

        $query = $this->admin_Model->validate();

        if($query)
        {
            redirect('pages');
        }
        else // incorrect username or password
        {
            $this->createAdminForm();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T08:46:42.467

我使用不同的方式，我认为更清楚：

```
public function login(){

        if($this->input->post('login')){

            $this->form_validation->set_rules('username', 'Username', 'required|callback_valid_login');
            $this->form_validation->set_rules('password', 'Password', 'required|callback_valid_password');

            if($this->form_validation->run($this)){
                $user = $this->user_model->get_by_field('username', $this->input->post('username'));

                $this->session->set_userdata($user);

                redirect("pages");
            } else {
                $this->load->view('login_failed');
            }
        } else
            $this->load->view('login');
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:09:15.617

找到我自己的答案，将 validate() 方法更改为此

```
function validate()
{
    $this->db->where('username', $this->input->post('username'));
    $this->db->where('password', $this->input->post('password'));
    $query = $this->db->get('membership');

    if($query->num_rows != 0)
    {
        $validate=true;
        return $validate;
    }
} 
```

# wpf - 实体框架和 WPF 最佳实践

> ID：15012953
> 
> 赞同：13
> 
> 时间：2013-02-21T21:53:10.007
> 
> 标签：wpf, entity-framework

直接使用上下文是一个好主意吗？例如，假设我有一个客户数据库，用户可以按名称搜索他们，显示一个列表，选择一个，然后编辑该客户的属性。

看来我应该使用上下文来获取客户列表（映射到 POCO 或`CustomerViewModels`），然后立即关闭上下文。然后，当用户选择`CustomerViewModels`列表中的一个时，UI 的客户属性部分将填充。

接下来，他们可以更改名称、类型、网站地址、公司规模等。点击保存按钮后，我打开一个新上下文，使用 ID`CustomerViewModel`检索该客户记录，并更新其每个属性。最后，我调用`SaveChanges()`并关闭上下文。这是很多工作。

我的问题是为什么不直接使用上下文使其始终保持打开状态？我读过使用具有长生命周期范围的相同上下文非常糟糕，并且不可避免地会导致问题。我的假设是，如果该应用程序只能由一个人使用，我可以让上下文保持打开状态并做所有事情。但是，如果有很多用户，我想维护一个简洁的工作单元，从而根据每个请求打开和关闭上下文。

有什么建议么？谢谢。

* * *

@PGallagher - 感谢您的彻底回答。
@Brice - 您的意见也很有帮助

但是，@Manos D.“冗余代码的缩影”评论让我有点担心。让我通过一个例子。假设我将客户存储在数据库中，而我的客户属性之一是 CommunicationMethod。

```
[Flags]
public enum CommunicationMethod
{
    None = 0,
    Print = 1,
    Email = 2,
    Fax = 4
} 
```

WPF 中我的管理客户页面的 UI 将在客户通信方式（打印、电子邮件、传真）下包含三个复选框。我无法将每个复选框绑定到该枚举，这没有意义。另外，如果用户点击了那个客户，起床去吃午饭怎么办……上下文在那里呆了几个小时，这很糟糕。相反，这是我的思考过程。

最终用户从列表中选择一个客户。我新建了一个上下文，找到该客户并返回一个 CustomerViewModel，然后关闭该上下文（为简单起见，我在这里留下了存储库）。

```
using(MyContext ctx = new MyContext())
{
    CurrentCustomerVM = new CustomerViewModel(ctx.Customers.Find(customerId));
} 
```

现在用户可以选中/取消选中 Print、Email、Fax 按钮，因为它们绑定到 CustomerViewModel 中的三个 bool 属性，它也有一个 Save() 方法。开始。

```
public class CustomerViewModel : ViewModelBase
{
    Customer _customer;

    public CustomerViewModel(Customer customer)
    {
        _customer = customer;
    }

    public bool CommunicateViaEmail
    {
        get { return _customer.CommunicationMethod.HasFlag(CommunicationMethod.Email); }
        set
        {
            if (value == _customer.CommunicationMethod.HasFlag(CommunicationMethod.Email)) return;

            if (value)
                _customer.CommunicationMethod |= CommunicationMethod.Email;
            else
                _customer.CommunicationMethod &= ~CommunicationMethod.Email;
        }
    }
    public bool CommunicateViaFax
    {
        get { return _customer.CommunicationMethod.HasFlag(CommunicationMethod.Fax); }
        set
        {
            if (value == _customer.CommunicationMethod.HasFlag(CommunicationMethod.Fax)) return;

            if (value)
                _customer.CommunicationMethod |= CommunicationMethod.Fax;
            else
                _customer.CommunicationMethod &= ~CommunicationMethod.Fax;
        }
    }
    public bool CommunicateViaPrint
    {
        get { return _customer.CommunicateViaPrint.HasFlag(CommunicationMethod.Print); }
        set
        {
            if (value == _customer.CommunicateViaPrint.HasFlag(CommunicationMethod.Print)) return;

            if (value)
                _customer.CommunicateViaPrint |= CommunicationMethod.Print;
            else
                _customer.CommunicateViaPrint &= ~CommunicationMethod.Print;
        }
    }

    public void Save()
    {
        using (MyContext ctx = new MyContext())
        {
            var toUpdate = ctx.Customers.Find(_customer.Id);
            toUpdate.CommunicateViaEmail = _customer.CommunicateViaEmail;
            toUpdate.CommunicateViaFax = _customer.CommunicateViaFax;
            toUpdate.CommunicateViaPrint = _customer.CommunicateViaPrint;

            ctx.SaveChanges();
        }
    }
} 
```

你觉得这有什么问题吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-21T23:45:38.947

可以使用长时间运行的上下文；您只需要了解其中的含义。

上下文代表一个工作单元。每当您调用 SaveChanges 时，对正在跟踪的实体的所有未决更改都将保存到数据库中。因此，您需要将每个上下文的范围限定在有意义的范围内。例如，如果您有一个用于管理客户的选项卡和另一个用于管理产品的选项卡，您可以为每个选项卡使用一个上下文，这样当用户在客户选项卡上单击保存时，他们对产品所做的所有更改都不会被保存。

上下文跟踪大量实体也会减慢 DetectChanges。减轻这种情况的一种方法是使用更改跟踪代理。

由于加载实体和保存实体之间的时间可能很长，因此遇到乐观并发异常的机会比短期上下文大。当实体在加载和保存之间发生外部更改时，会发生这些异常。[处理这些异常](http://msdn.microsoft.com/en-us/data/jj592904)非常简单，但仍然需要注意。

您可以在 WPF 中使用长寿命上下文做的一件很酷的事情是绑定到 DbSet.Local 属性（例如 context.Customers.Local）。这是一个 ObservableCollection，其中包含所有未标记为删除的跟踪实体。

希望这可以为您提供更多信息，以帮助您决定使用哪种方法来提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T00:06:01.347

**微软参考：**

[http://msdn.microsoft.com/en-gb/library/cc853327.aspx](http://msdn.microsoft.com/en-gb/library/cc853327.aspx)

他们说;

> 限制 ObjectContext 的范围
> 
> 在大多数情况下，您应该在 using 语句中创建一个 ObjectContext 实例（Visual Basic 中的 Using...End Using）。
> 
> 这可以通过确保在代码退出语句块时自动释放与对象上下文关联的资源来提高性能。
> 
> 但是，当控件绑定到由对象上下文管理的对象时，只要需要绑定并手动处理，就应该维护 ObjectContext 实例。
> 
> 有关详细信息，请参阅管理对象服务中的资源（实体框架）。[http://msdn.microsoft.com/en-gb/library/bb896325.aspx](http://msdn.microsoft.com/en-gb/library/bb896325.aspx)

其中说；

> 在长时间运行的对象上下文中，您必须确保在不再需要上下文时将其释放。

* * *

**StackOverflow 参考：**

这个 StackOverflow 问题也有一些有用的答案......

[业务逻辑中的实体框架最佳实践？](https://stackoverflow.com/questions/3957485/entity-framework-best-practices-in-business-logic)

有些人建议您将上下文提升到更高级别并从此处引用它，从而仅保留一个上下文。

* * *

**我的十便士值：**

将上下文包装在 Using 语句中，允许垃圾收集器清理资源，并防止内存泄漏。

显然，在简单的应用程序中，这不是什么大问题，但是，如果您有多个屏幕，都使用大量数据，那么您最终可能会遇到麻烦，除非您确定正确处置您的上下文。

因此，我采用了与您提到的方法类似的方法，我在`AddOrUpdate`每个存储库中添加了一个方法，在其中我传入了我的新实体或修改后的实体，并根据它是否存在来更新或添加它。

* * *

**更新实体属性：**

然而，关于更新属性，我使用了一个简单的函数，它使用反射将所有属性从一个实体复制到另一个实体；

```
Public Shared Function CopyProperties(Of sourceType As {Class, New}, targetType As {Class, New})(ByVal source As sourceType, ByVal target As targetType) As targetType
    Dim sourceProperties() As PropertyInfo = source.GetType().GetProperties()
    Dim targetProperties() As PropertyInfo = GetType(targetType).GetProperties()

    For Each sourceProp As PropertyInfo In sourceProperties
        For Each targetProp As PropertyInfo In targetProperties
            If sourceProp.Name <> targetProp.Name Then Continue For

            ' Only try to set property when able to read the source and write the target
            '
            ' *** Note: We are checking for Entity Types by Checking for the PropertyType to Start with either a Collection or a Member of the Context Namespace!
            '
            If sourceProp.CanRead And _
                  targetProp.CanWrite Then
                ' We want to leave System types alone
                If sourceProp.PropertyType.FullName.StartsWith("System.Collections") Or (sourceProp.PropertyType.IsClass And _
                       sourceProp.PropertyType.FullName.StartsWith("System.Collections")) Or sourceProp.PropertyType.FullName.StartsWith("MyContextNameSpace.") Then
                    '
                    ' Do Not Store
                    '
                Else

                    Try

                        targetProp.SetValue(target, sourceProp.GetValue(source, Nothing), Nothing)

                    Catch ex As Exception

                    End Try

                End If
            End If

            Exit For
        Next
    Next

    Return target
End Function 
```

我在哪里做类似的事情；

```
dbColour = Classes.clsHelpers.CopyProperties(Of Colour, Colour)(RecordToSave, dbColour) 
```

这当然减少了我需要为每个存储库编写的代码量！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T23:50:21.500

上下文不是永久连接到数据库的。它本质上是您从磁盘加载的记录的内存缓存。只有当您请求以前未加载的记录、强制刷新或将更改保存回磁盘时，它才会从数据库请求记录。

打开上下文，获取记录，关闭上下文，然后将修改的属性从全新的上下文复制到对象是冗余代码的缩影。您应该不理会原始上下文并使用它来执行 SaveChanges()。

如果您正在寻找处理并发问题，您应该为您的实体框架版本进行有关“处理并发”的谷歌搜索。

作为一个例子，我发现[了这个](http://www.dotnetrangers.net/2011/10/17/code-first-with-entity-framework-4-1-part5-concurrency-management/)。

**编辑以回应评论：**

因此，据我了解，您需要用新值覆盖记录的一部分列，而其余部分不受影响？如果是这样，是的，您需要手动更新“新”对象上的这几列。

我的印象是您在谈论一种反映客户对象所有字段的表单，旨在提供对整个客户记录的编辑访问权限。在这种情况下，使用新的上下文并煞费苦心地逐个复制所有属性是没有意义的，因为最终结果（所有数据都被表单值覆盖，无论年龄大小）将是相同的。

# sql - SQL 查询组合来自两个表的数据

> ID：15012954
> 
> 赞同：2
> 
> 时间：2013-02-21T21:53:20.790
> 
> 标签：sql, sql-server-2008

`Students`我有以下查询，它从 2 个表（和`Subjects`）中收集一些信息

```
SELECT 
    'StudentName' As Student,
    'Class'   As Class,
    'Subject' As Subject
    DATEDIFF( HOUR, hoursSpent.ClassStartTime, hoursSpent.ClassEndTime ) As HoursSpent
  FROM (
        SELECT stu.StudentName from Students s

        INNER JOIN Subjects  sub
        WHERE stu.StudentId = sub.StudentId
       ) hoursSpent 
```

`Students`我有另一个与布局中的表完全相同的表，称为`OldStudents`.

我的问题是我想将两者的数据结合起来`Students`并`OldStudents`显示为一个，但不知道如何做到这一点。

我试过了，但这不起作用：

```
SELECT 
    'StudentName' As Student,
    'Class'   As Class,
    'Subject' As Subject
    DATEDIFF( HOUR, hoursSpent.ClassStartTime, hoursSpent.ClassEndTime ) As HoursSpent
  SELECT(
            FROM (
                SELECT stu.StudentName from Students s
                INNER JOIN Subjects  sub
                WHERE stu.StudentId = sub.StudentId
               ) hoursSpent,
          FROM (
                SELECT stu.StudentName from Students s
                INNER JOIN Subjects  sub
                WHERE stu.StudentId = sub.StudentId
               ) hoursSpent ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T22:00:35.627

本质上，您需要有两个相同的查询，每个表一个并使用[`UNION`](http://msdn.microsoft.com/en-gb/library/ms180026.aspx)（或`UNION ALL`连接它们：

```
SELECT 
    'StudentName' As Student,
    'Class'   As Class,
    'Subject' As Subject
    DATEDIFF( HOUR, hoursSpent.ClassStartTime, hoursSpent.ClassEndTime ) As HoursSpent
  FROM (
        SELECT stu.StudentName from Students s

        INNER JOIN Subjects  sub
        WHERE stu.StudentId = sub.StudentId
       ) hoursSpent
UNION ALL
SELECT 
    'StudentName' As Student,
    'Class'   As Class,
    'Subject' As Subject
    DATEDIFF( HOUR, hoursSpent.ClassStartTime, hoursSpent.ClassEndTime ) As HoursSpent
  FROM (
        SELECT stu.StudentName from OldStudents s

        INNER JOIN Subjects  sub
        WHERE stu.StudentId = sub.StudentId
       ) hoursSpent 
```

`UNION`会使结果不同，`UNION ALL`不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T22:02:44.870

您可以尝试组合（联合）`Students`，`OldStudents`然后将结果加入查询的其余部分：

```
WITH AllStudents
AS (
  SELECT * FROM Students
  UNION
  SELECT * FROM OldStudents
)
SELECT 
    'StudentName' As Student,
    'Class'   As Class,
    'Subject' As Subject
    DATEDIFF( HOUR, hoursSpent.ClassStartTime, hoursSpent.ClassEndTime ) As HoursSpent
  FROM (
        SELECT stu.StudentName from AllStudents stu
        INNER JOIN Subjects  sub
        WHERE stu.StudentId = sub.StudentId
       ) hoursSpent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T21:57:42.760

如果您只想将一组数据添加到另一组，请使用 UNION 运算符：

```
SELECT * FROM TableA
UNION
SELECT * FROM TableB 
```

每个 SELECT 语句必须具有相同的列数

# java - OpenGL ES 中的 GLM 库

> ID：15012956
> 
> 赞同：0
> 
> 时间：2013-02-21T21:53:25.423
> 
> 标签：java, android, glm-math

我已经 3 年没有用 Java 编程了，因此我对它有点笨拙。

问题是我必须使用 OpenGL ES 开发一个 Android 应用程序。现在我想知道我应该如何做我的 3D 数学。在我的 C++ 游戏中，我总是使用 glm ( [glm.g-truc.net](http://glm.g-truc.net) )，但这是一个 C 库。

我看过一些关于这个话题的帖子，上面说 glm 在 OpenGL ES 中使用也很好。但这就是重点。我可能听起来很笨，但我不知道如何在用 JAVA 实现的 OpenGL ES 应用程序中使用 glm。我必须使用 JNI 才能使用该库吗？

# powershell - 针对文件系统更改的 Powershell 监控

> ID：15012957
> 
> 赞同：0
> 
> 时间：2013-02-21T21:53:28.800
> 
> 标签：powershell, automation, powershell-2.0

当一堆文件夹发生变化时（比如发送电子邮件），我想做一些事情。它或多或少地工作。问题是我收到太多通知。我知道我可以破解它并跟踪并忽略重复，但似乎应该有一种方法让它正常工作。

代码：

```
$watcher = New-Object System.IO.FileSystemWatcher
$watcher.Path = "s:\Reporting\Report Output Files\"
$watcher.IncludeSubdirectories = $true
$watcher.EnableRaisingEvents = $true

$changed = Register-ObjectEvent $watcher "Changed" -Action {
write-host "Changed: $($eventArgs.FullPath)"
}
$created = Register-ObjectEvent $watcher "Created" -Action {
write-host "Created: $($eventArgs.FullPath)"
}

while($true) {
start-sleep -s 2
} 
```

创建文件时的结果：

```
Created: s:\Reporting\Report Output Files\IT\Scheduled_IO.log
Changed: s:\Reporting\Report Output Files\IT\Scheduled_IO.log
Changed: s:\Reporting\Report Output Files\IT\Scheduled_IO.log
Changed: s:\Reporting\Report Output Files\IT\Scheduled_IO.log
Changed: s:\Reporting\Report Output Files\IT 
```

我不确定为什么要进行 3 次更改（我可以看到为什么要更改目录级别），而实际上它只是一个正在创建的文件。当我更改文件时，我也会得到 dup 更改。

# php - 在 Postgres 上安装 silverstripe 2.4.10 在数据库连接上不断失败

> ID：15012961
> 
> 赞同：0
> 
> 时间：2013-02-21T21:53:39.720
> 
> 标签：php, postgresql, installation, redhat, silverstripe

我正在尝试使用 Postgres 在 Red Hat 上安装 Silverstripe 2.4.10。

所以我下载了 v2.4.10，我在我的 httpd.conf 中添加了一个新的 vHost：

```
<VirtualHost *:80> 
ServerName silverstripe.localhost 
ServerAlias silverstripe.localhost 
ServerAdmin root@silverstripe.localhost 
DocumentRoot /var/www/html/SilverStripe-cms-v2.4.10 
ErrorLog /var/www/html/silverstripe/silverstripe.com-error_log 
CustomLog /var/www/html/silverstripe/silverstripe.com-access_log common 
<Directory "/var/www/html/silverstripe/SilverStripe-cms-v2.4.10"> 
Options Indexes FollowSymLinks 
AllowOverride All 
Order allow,deny 
Allow from all 
</Directory> 
</VirtualHost> 
```

我下载了 postgres 包并将其解压到 /var/www/html/silverstripe/SilverStripe-cms-v2.4.10 中。

我导航到 SilverStripe 的子域 URL： [http://silverstripe.localhost/](http://silverstripe.localhost/)

我需要安装.php，我添加了我的 Postgres 数据库凭据，但 Silverstripe 不断告诉我它无法连接到数据库。

我通过创建一个小的 PHP 脚本验证了我的数据库凭据：

```
<?php 
$db = pg_connect("host=127.0.0.1 port=5432 dbname=SS_mysite user=silverstripe password="); 
$result = pg_query($db, "SELECT * FROM test_table_pgtest");

while ($row = pg_fetch_row($result)) { 
echo "Id: $row[0] Name: $row[1]"; 
echo "<br />\n"; 
} 
?> 
```

该脚本执行良好，但 silverstripe 不接受相同的数据库凭据。错误是：我在“127.0.0.1:5432”上找不到数据库服务器：PostgreSQL 需要有效的用户名和密码才能确定服务器是否存在。

这真的很烦人。

Postgres 模块给出了运行指令：dev/build

不幸的是，这也只会导致 404 错误。[http://silverstripe.localhost/dev/build](http://silverstripe.localhost/dev/build)只会返回 404 错误。我还能做些什么或检查以改进它？

当然，数据库确实存在并且用户确实可以工作（请参阅我的运行良好的测试脚本）。

此外，这个开发/构建的东西根本不起作用，从文档中不清楚这是否打算在您运行安装程序*之前*起作用。原因如果是这样...... Postgres 模块告诉用户预先运行该脚本安装有点奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T00:12:38.743

mysite/_config.php 中的以下配置应该可以工作（这绕过了安装程序中遵循的过程），并假设 postgresql 常量 SS_PGSQL_DATABASE_SERVER、SS_PGSQL_DATABASE_USERNAME 和 SS_PGSQL_DATABASE_PASSWORD 已在 _ss_environment.php 中定义：

```
global $database;
$database = 'SS_mysite';
require_once('conf/ConfigureFromEnv.php');
global $databaseConfig;
$databaseConfig['type'] = 'PostgreSQLDatabase';
$databaseConfig['server'] = SS_PGSQL_DATABASE_SERVER;
$databaseConfig['username'] = SS_PGSQL_DATABASE_USERNAME;
$databaseConfig['password'] = SS_PGSQL_DATABASE_PASSWORD; 
```

# dependencies - 创建 NuGet 包时不要包含 packages.config 文件中的依赖项

> ID：15012963
> 
> 赞同：57
> 
> 时间：2013-02-21T21:53:50.240
> 
> 标签：dependencies, package, nuget, nuget-package, nuspec

我正在使用 Nuget 创建包。我想创建一个包，它不包含`.nuspec`任何其他 NuGet 包的任何依赖项（在 ）文件中。我的项目确实在其`packages.config`文件中定义了 NuGet 包依赖项。

首先我创建`.nuspec`文件...

```
C:\code\MySolution>.nuget\nuget.exe spec MyProject\MyProject.csproj 
```

我将生成的`.nuspec`文件编辑为最小，没有依赖关系。

```
<?xml version="1.0"?>
<package >
  <metadata>
    <id>MyProject</id>
    <version>1.2.3</version>
    <title>MyProject</title>
    <authors>Example</authors>
    <owners>Example</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <description>Example</description>
    <copyright>Copyright 2013 Example</copyright>
    <tags>example</tags>
    <dependencies />
  </metadata>
</package> 
```

然后我构建解决方案并创建一个 NuGet 包......

```
C:\code\MySolution>.nuget\nuget.exe pack MyProject\MyProject.csproj -Verbosity detailed 
```

这是该命令的输出...

```
Attempting to build package from 'MyProject.csproj'.
Packing files from 'C:\code\MySolution\MyProject\bin\Debug'.
Using 'MyProject.nuspec' for metadata.
Found packages.config. Using packages listed as dependencies

Id: MyProject
Version: 1.2.3
Authors: Example
Description: Example
Tags: example
Dependencies: Google.ProtocolBuffers (= 2.4.1.473)

Added file 'lib\net40\MyProject.dll'.

Successfully created package 'C:\code\MySolution\MyProject.1.2.3.nupkg'. 
```

创建的`.nupkg`包中包含一个`.nuspec`文件，但它包含一个我在原始文件中没有的依赖项部分`.nuspec`......

```
<dependencies>
  <dependency id="Google.ProtocolBuffers" version="2.4.1.473" />
</dependencies> 
```

I believe this is happening because of this... (from the output above)

```
Found packages.config. Using packages listed as dependencies 
```

How can I make NuGet **not** automatically resolve dependencies and insert them into the `.nuspec` file which is generated from the `pack` command?

I am using NuGet 2.2 currently. Also, I don't think that this behaviour happened in older version of NuGet; is this a new "feature"? I couldn't find any documentation describing this "feature" or when it was implemented.

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-09-05T23:13:41.447

In version 2.7 there is an option called developmentDependency that can be set into package.config to avoid including dependency.

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
    <package id="jQuery" version="1.5.2" />
    <package id="netfx-Guard" version="1.3.3.2" developmentDependency="true" />
    <package id="microsoft-web-helpers" version="1.15" />
</packages> 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-06-14T05:29:18.563

## Prevent your package from being dependent on other packages

As of [NuGet 2.7 there is a new developmentDependency attribute](http://docs.nuget.org/docs/release-notes/nuget-2.7#Development-Only_Dependencies) that can be [added to a `package` node in your project's `packages.config` file](http://docs.nuget.org/docs/reference/command-line-reference#Excluding_development_dependencies_when_creating_packages). So if your project includes a NuGet package that you don't want your NuGet package to include as a dependency, you can use this attribute like so:

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CreateNewNuGetPackageFromProjectAfterEachBuild" version="1.8.1-Prerelease1" targetFramework="net45" developmentDependency="true" />
</packages> 
```

The important bit that you need to add here is `developmentDependency="true"`.

## Prevent your development package from being depended on by other packages

If you are creating a development NuGet package for others to consume, that you know they will not want to have as a dependency in their packages, then you can avoid users having to manually add that attribute to their packages.config file by using the [NuGet 2.8 `developmentDependency` attribute in the metadata section of your .nuspec file](http://docs.nuget.org/docs/release-notes/nuget-2.8#Development_Dependencies). This will automatically add the developmentDependency attribute to the packages.config file when the your package is installed by others. The catch here is that it requires the user to have at least NuGet 2.8 installed. Luckily, we can make use of the [NuGet 2.5 minClientVersion attribute](http://docs.nuget.org/docs/release-notes/nuget-2.5#Improved_project_reference_support_for_NuGet.exe_Pack) to ensure that users have at least v2.8 installed; otherwise they will be notified that they need to update their NuGet client before they can install the package.

I have a development NuGet package that this was perfect for. Here is what my .nuspec file looks like, showing how to use the minClientVersion and developmentDependency attributes (lines 3 and 20 respectively):

```
<?xml version="1.0" encoding="utf-8"?>
<package xmlns="http://schemas.microsoft.com/packaging/2011/08/nuspec.xsd">
  <metadata minClientVersion="2.8">
    <id>CreateNewNuGetPackageFromProjectAfterEachBuild</id>
    <version>1.8.1-Prerelease1</version>
    <title>Create New NuGet Package From Project After Each Build</title>
    <authors>Daniel Schroeder,iQmetrix</authors>
    <owners>Daniel Schroeder,iQmetrix</owners>
    <licenseUrl>https://newnugetpackage.codeplex.com/license</licenseUrl>
    <projectUrl>https://newnugetpackage.codeplex.com/wikipage?title=NuGet%20Package%20To%20Create%20A%20NuGet%20Package%20From%20Your%20Project%20After%20Every%20Build</projectUrl>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <description>Automatically creates a NuGet package from your project each time it builds. The NuGet package is placed in the project's output directory.
    If you want to use a .nuspec file, place it in the same directory as the project's project file (e.g. .csproj, .vbproj, .fsproj).
    This adds a PostBuildScripts folder to your project to house the PowerShell script that is called from the project's Post-Build event to create the NuGet package.
    If it does not seem to be working, check the Output window for any errors that may have occurred.</description>
    <summary>Automatically creates a NuGet package from your project each time it builds.</summary>
    <releaseNotes>- Changed to use new NuGet built-in method of marking this package as a developmentDependency (now requires NuGet client 2.8 or higher to download this package).</releaseNotes>
    <copyright>Daniel Schroeder 2013</copyright>
    <tags>Auto Automatic Automatically Build Pack Create New NuGet Package From Project After Each Build On PowerShell Power Shell .nupkg new nuget package NewNuGetPackage New-NuGetPackage</tags>
    <developmentDependency>true</developmentDependency>
  </metadata>
  <files>
    <file src="..\New-NuGetPackage.ps1" target="content\PostBuildScripts\New-NuGetPackage.ps1" />
    <file src="Content\NuGet.exe" target="content\PostBuildScripts\NuGet.exe" />
    <file src="Content\BuildNewPackage-RanAutomatically.ps1" target="content\PostBuildScripts\BuildNewPackage-RanAutomatically.ps1" />
    <file src="Content\UploadPackage-RunManually.ps1" target="content\PostBuildScripts\UploadPackage-RunManually.ps1" />
    <file src="Content\UploadPackage-RunManually.bat" target="content\PostBuildScripts\UploadPackage-RunManually.bat" />
    <file src="tools\Install.ps1" target="tools\Install.ps1" />
    <file src="tools\Uninstall.ps1" target="tools\Uninstall.ps1" />
  </files>
</package> 
```

If you don't want to force your users to have at least NuGet v2.8 installed before they can use your package, then you can [use the solution I came up with and blogged about](http://blog.danskingdom.com/have-your-nuget-package-install-itself-as-a-development-dependency/) before the NuGet 2.8 developmentDependency attribute existed.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-07-06T07:06:16.103

If you are using the `PackageReference` element instead of `package.config` file, here is the solution:

```
<PackageReference Include="Nerdbank.GitVersioning" Version="1.5.28-rc" PrivateAssets="All" /> 
```

or

```
<PackageReference Include="Nerdbank.GitVersioning" Version="1.5.28-rc">
   <PrivateAssets>all</PrivateAssets>
</PackageReference> 
```

[Related GitHub discussion](https://github.com/NuGet/Home/issues/4125)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-21T22:14:02.297

You can explicitly specify which files to include then run the pack command on the nuspec file itself.

```
<?xml version="1.0"?>
<package >
  <metadata>
    <id>MyProject</id>
    <version>1.2.3</version>
    <title>MyProject</title>
    <authors>Example</authors>
    <owners>Example</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <description>Example</description>
    <copyright>Copyright 2013 Example</copyright>
    <tags>example</tags>
    <dependencies />
  </metadata>

  <files>
    <file src="bin\Release\MyProject.dll" target="lib" />
  </files>

</package> 
```

You should set the src attribute with the path that is relative to the nuspec file here. Then you can run the pack command.

```
nuget.exe pack MyProject\MyProject.nuspec 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-13T13:59:01.330

According to issue #1956 ([https://nuget.codeplex.com/workitem/1956](https://nuget.codeplex.com/workitem/1956)) and pull request 3998 ([https://nuget.codeplex.com/SourceControl/network/forks/adamralph/nuget/contribution/3998](https://nuget.codeplex.com/SourceControl/network/forks/adamralph/nuget/contribution/3998)) this feature has been included in the ~~2.4 release~~ 2.7 release.

However I'm not able to find documentation about the feature, and I still haven't figured how to use it. Please update this answer if anyone knows.

**Update: Issue #1956 has been updated by the developer. The feature was not included in the 2.4 release, but delayed to the upcoming 2.7 release. That's why it's not documented yet.**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-21T22:08:41.767

I'm not sure why you would want to ignore the dependencies that your NuGet package requires to run, but have you thought about using the [NuGet Package Explorer](http://nuget.codeplex.com/releases/view/59864) tool instead to create your package?

# jakarta-ee - spring DIC读取maven结构内的属性文件

> ID：15012971
> 
> 赞同：0
> 
> 时间：2013-02-21T21:54:20.133
> 
> 标签：jakarta-ee, maven, filenotfoundexception

我有一个 spring XML 文件，其中包含为休眠创建数据源的 bean：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location">
        <value>properties/database.properties</value>
    </property>
</bean>

<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${jdbc.driverClassName}"/>
    <property name="url" value="${jdbc.url}"/>
    <property name="username" value="${jdbc.username}"/>
    <property name="password" value="${jdbc.password}"/>
</bean> 
```

这是这个文件在使用 Maven 之前的样子。现在我已将此文件放在 src/main/resources/properties/database.properties 中，我得到了`java.io.FileNotFoundException`- 找不到属性文件。我改`<value>properties/database.properties</value>`了`<value>/properties/database.properties</value>`，还是不行。属性文件位于 中`/target/classes/properties/database.properties`，所以我想它应该可以从 properties/database.properties 中读取，因为 src/main/resources 包含在类路径中。我应该在配置 XML 中更正什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T09:17:13.537

答案是添加`classpath:`到属性值，如下图：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location">
        <value>classpath:properties/database.properties</value>
    </property>
</bean> 
```

# objective-c - 在所有符合协议的类上实现一个类别

> ID：15012976
> 
> 赞同：3
> 
> 时间：2013-02-21T21:54:37.757
> 
> 标签：objective-c, protocols, scenekit

我在 SCNRenderer 上写了一个类别，添加了一些相机实用程序方法。这些相同的方法对 SCNView 和 SCNLayer 同样有用。与此类别相关的所有三个类都符合 SCNSceneRenderer。是否可以编写一个不适用于特定类但适用于所有符合特定协议的类的类别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T23:59:18.813

最简单的方法是编写一些采用 SCNSceneRenderer 对象的实用函数：

```
void ABCDoSomethingUseful(id<SCNSceneRenderer> renderer)
{
   //...
}

void ABCDoSomethingElseUseful(id<SCNSceneRenderer> renderer)
{
   //...
} 
```

如果您想使用方法调用语法，或者希望能够覆盖子类中的实现，另一种选择是将方法实现为 NSObject 上的类别：

```
// This goes in a source file:

@interface NSObject (SCNSceneRendererConformance) <SCNSceneRenderer>
// Surpress compiler warnings about NSObject not responding to 
// SCNSceneRenderer's messages
@end

@implementation NSObject (MyCategory)

- (void)abc_doSomethingUseful
{
    //...
}

- (void)abc_doSomethingElseUseful
{
    //...
}

@end 
```

然后在协议中公开它们：

```
// This goes in a header file:

@protocol MyProtocol <NSObject>
- (void)abc_doSomethingElseUseful;
- (void)abc_doSomethingUseful;
@end 
```

并为每个符合 SCNSceneRenderer 的类添加一个仅接口类别，声明它也符合您的协议：

```
// This also goes in a header file:

@interface SCNLayer (MyProtocolConformance) <MyProtocol>
@end

@interface SCNView (MyProtocolConformance) <MyProtocol>
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:27:27.940

我认为您不能在协议上添加类别，因为协议只定义接口而不是实现。而在类别中，我们也需要实施。

# linux - 远程 plink ssh 程序提前结束

> ID：15012993
> 
> 赞同：0
> 
> 时间：2013-02-21T21:55:29.943
> 
> 标签：linux, ssh, putty, plink

我有一个程序，可以使用 Windows 命令提示符在另一台 PC 上通过远程 plink ssh 运行

```
plink [username]@[ip address] -pw [password] ./program 
```

或者：

```
plink -ssh -l [username] -pw [password] [ip address] ./program 
```

但不知何故，程序会过早结束。程序运行，但在程序运行之前终止。不过，我的所有程序都不会发生这种情况。

为了清除，我可以使用以下命令行运行我的程序

```
plink [username]@[ip address] -pw [password] 
```

它将我登录到远程系统，从那里我可以`./program`完整运行。

但如果我尝试`plink [username]@[ip address] -pw [password] ./program`一行，它会在中间退出。

我想知道是否有人以前遇到过同样的问题？你如何解决它？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T11:40:13.533

plink [用户名]@[ip 地址] -pw [密码] -m program.txt

从本地文件执行远程命令。您可以创建一个包含 Unix 命令的本地命令文件，然后远程自动运行它。示例 -- cmds.txt 中的“find /usr/local -name pmapp -print”可以运行：

所以使用 -m 选项来帮助你执行远程命令

干杯。

# objective-c - 通过鼠标事件绘制到 NSView

> ID：15012994
> 
> 赞同：3
> 
> 时间：2013-02-21T21:55:31.703
> 
> 标签：objective-c, macos, mouseevent, nsview

我是编程、objective-c（和stackoverflow）的新手。我正在学习并非常缓慢地前进；）但后来我遇到了一个谷歌无法解决的问题。我有一个窗口和一个 NSview，然后添加了一个鼠标事件，应该将坐标绘制到我的视图中，但它没有。有趣的是：它是在鼠标移到我的应用程序窗口的窗口按钮上时绘制的......

```
- (void)drawRect:(NSRect)dirtyRect {
   NSPoint imagePos = NSMakePoint(0, 0);
   NSImage *aImage = [NSImage imageNamed:@"mw_bg01.png"];
   [aImage dissolveToPoint:imagePos fraction:1.0];
}
- (void)mouseDown:(NSEvent*)theEvent;{
   mouseLoc = [NSEvent mouseLocation];
   mousePosX = mouseLoc.x;mousePosY = mouseLoc.y;
   NSString* mouseString = [NSString stringWithFormat:@"%d", mousePosX];
   NSPoint textPoint = NSMakePoint(5, 5);
   NSMutableDictionary *textAttrib = [[NSMutableDictionary alloc] init];
   [textAttrib setObject:[NSFont fontWithName:@"Helvetica Light" size:10]
               forKey:NSFontAttributeName];
   [textAttrib setObject:[NSColor grayColor] forKey:NSForegroundColorAttributeName];
   [mouseString drawAtPoint:textPoint withAttributes:textAttrib];
} 
```

我不知道怎么继续，有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T22:37:39.563

您不应该在该`-mouseDown:`方法中进行绘图。相反，您必须在`-drawRect:`（或您调用的方法`-drawRect:`）中完成所有绘图。尝试这样的事情：

```
@interface MyView ()
    @property NSPoint lastMousePoint;
@end

@implementation MyView

- (void)drawLastMousePoint
{
    NSString *mouseString = NSStringFromPoint(self.lastMousePoint);
    NSPoint textPoint = NSMakePoint(5, 5);
    NSMutableDictionary *textAttrib = [[NSMutableDictionary alloc] init];
    [textAttrib setObject:[NSFont fontWithName:@"Helvetica Light" size:10]
                forKey:NSFontAttributeName];
    [textAttrib setObject:[NSColor grayColor] forKey:NSForegroundColorAttributeName];
    [mouseString drawAtPoint:textPoint withAttributes:textAttrib];
}

- (void)drawRect:(NSRect)dirtyRect 
{
    NSPoint imagePos = NSMakePoint(0, 0);
    NSImage *aImage = [NSImage imageNamed:@"mw_bg01.png"];
    [aImage dissolveToPoint:imagePos fraction:1.0];

    [self drawLastMousePoint];
}

- (void)mouseDown:(NSEvent*)theEvent;
{
    self.lastMousePoint = [theEvent locationInWindow];
    [self setNeedsDisplay:YES];
}

@end 
```

当您收到鼠标按下事件时，您只需存储鼠标按下的位置。绘图是在`-drawLastMousePoint`您调用`-drawRect:`方法时完成的。由于您知道在单击鼠标时需要重绘，因此您调用`-setNeedsDisplay:`通知视图它需要重绘。请注意，重绘不会立即发生，而是会在下一次通过运行循环时发生。换句话说，您是在说“嘿，发生了一些变化，我需要重新绘制视图的内容。请`-drawRect:`尽快再次调用！”

另一个注意事项：`+[NSEvent mouseLocation]`实际上是为在事件流*之外获取当前鼠标位置而设计的。*通常，在`-mouseDown:`方法中，您调用作为参数`-locationInWindow`传递`NSEvent`的方法。如果您需要转换为本地/视图坐标，您应该调用`[self convertPoint:[theEvent locationInWindow] fromView:nil];`.

# php - 调用未定义的方法 DB::escape_string()

> ID：15012997
> 
> 赞同：0
> 
> 时间：2013-02-21T21:55:48.483
> 
> 标签：php, mysql, sql, mysqli

这是我的代码的简化版本：

```
$db = new mysqli('localhost', 'user', 'pass', 'database') or die(mysqli_error());    

$gender = $db->escape_string($_GET['gender']);
$city = $db->escape_string($_GET['city']); 
```

这是我得到的错误：

```
Call to undefined method DB::escape_string() in /blablabla/bla/file.php on line 2 
```

为什么我会收到错误消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:58:14.160

我想你要找的是[`mysqli::real_escape_string()`](http://www.php.net/manual/en/mysqli.real-escape-string.php)

```
$gender = $db->real_escape_string($_GET['gender']);
$city = $db->real_escape_string($_GET['city']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T21:59:18.560

`escape_string`是 的别名`real_escape_string`，所以它们是相同的。

这是文档的链接：

[http://php.net/manual/en/mysqli.real-escape-string.php](http://php.net/manual/en/mysqli.real-escape-string.php)

试试这个

```
 $city = $mysqli->real_escape_string($_GET['city']); 
```

# php - 在 Drupal 中添加节点时如何显示所有分类术语字段

> ID：15012999
> 
> 赞同：1
> 
> 时间：2013-02-21T21:55:53.793
> 
> 标签：php, drupal, drupal-taxonomy

我正在尝试制作在报纸上发布广告的表格，并希望让用户选择未来帖子的样式并展示它的打印方式。所以我创建了分类词汇。带有名称、示例图像和最大值的“样式”。此类型的字符。接下来我在广告内容类型中创建字段分类术语关系。

现在我需要在添加表单中显示，不仅是收音机或选择标题，还有标题、示例图像和分类学中的其他字段。

我想我需要使用`hook_form_alter`，所以我使用`mymodule_form_ad_node_form_alter(&$form, &$form_state, $form_id)`但我不明白的是如何以 drupal 方式获得其他分类领域？数组中`$form`只有 tids 和标题。

是否可以不再查询数据库，而是设置现有查询来检索我需要的所有字段？
另外，我如何将附加信息插入表单？`#suffix` `#prefix`除了收音机还有其他方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T21:41:00.963

如果这是 Drupal 7，那么您可以将[实体引用](http://drupal.org/project/entityreference)字段与[实体引用视图小部件](http://drupal.org/project/entityreference_view_widget)一起使用，而不是术语引用字段。这将允许您指定用于填充字段选项的视图，并且您可以创建一个实体参考视图来显示您要显示的其他分类术语字段。